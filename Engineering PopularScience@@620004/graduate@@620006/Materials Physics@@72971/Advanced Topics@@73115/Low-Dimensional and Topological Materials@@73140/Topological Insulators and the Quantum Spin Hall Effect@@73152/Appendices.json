{"hands_on_practices": [{"introduction": "The abstract nature of topological invariants can often be simplified by leveraging a system's symmetries. This practice explores one of the most powerful diagnostic tools for time-reversal symmetric topological insulators: the Fu-Kane parity criterion. You will apply this criterion to a model that possesses inversion symmetry, allowing for a direct calculation of the $\\mathbb{Z}_2$ invariant by inspecting the parity of occupied states at a few high-symmetry points in the Brillouin zone. This exercise [@problem_id:2867293] provides a concrete link between the abstract topological classification and the readily computable symmetry eigenvalues of the band structure.", "problem": "Consider a two-dimensional centrosymmetric and time-reversal-invariant tight-binding model on a square lattice with one even-parity orbital and one odd-parity orbital per site, and spin-$\\frac{1}{2}$. Work in the Bloch basis $\\{ |e,\\uparrow\\rangle, |o,\\uparrow\\rangle, |e,\\downarrow\\rangle, |o,\\downarrow\\rangle \\}$, where $|e\\rangle$ has even parity and $|o\\rangle$ has odd parity under spatial inversion about a lattice site. The Bloch Hamiltonian is\n$$\nH(\\mathbf{k}) \\;=\\; A \\sin k_x \\, \\tau_x \\otimes s_0 \\;+\\; A \\sin k_y \\, \\tau_y \\otimes s_0 \\;+\\; d_z(\\mathbf{k}) \\, \\tau_z \\otimes s_0,\n$$\nwith\n$$\nd_z(\\mathbf{k}) \\;=\\; M \\;-\\; 2 B \\;+\\; B \\left( \\cos k_x + \\cos k_y \\right),\n$$\nwhere $\\tau_{x,y,z}$ act in the even/odd orbital subspace, $s_0$ is the identity in spin space, and $A$, $B$, $M$ are real parameters. Time reversal is implemented by $\\Theta \\,=\\, \\mathrm{i} \\, s_y \\, \\mathcal{K}$, where $\\mathcal{K}$ denotes complex conjugation. Spatial inversion is implemented by $P \\,=\\, \\tau_z \\otimes s_0$.\n\nAssume the system is insulating and fully gapped. Focus on the four time-reversal invariant momenta (TRIM) in the Brillouin zone of the square lattice, $\\Gamma_1=(0,0)$, $\\Gamma_2=(\\pi,0)$, $\\Gamma_3=(0,\\pi)$, $\\Gamma_4=(\\pi,\\pi)$.\n\nUsing only the symmetry representations specified above and first principles of band diagonalization at the TRIM, do the following for the parameter values $A=1.0$, $B=0.5$, $M=1.2$ (in dimensionless lattice units):\n\n1) Compute the inversion eigenvalue of the occupied Kramers pair at each of the four $\\Gamma_i$ points.\n\n2) From the products of these inversion eigenvalues over the occupied Kramers pairs at the four $\\Gamma_i$, determine the binary topological invariant (the $\\mathbb{Z}_2$ index) $\\nu$ of the insulating phase.\n\nExpress the final $\\mathbb{Z}_2$ index $\\nu$ as an integer $0$ or $1$. No units are required.", "solution": "The problem requires the calculation of the $\\mathbb{Z}_2$ topological invariant, denoted by $\\nu$, for a given 2D tight-binding model that possesses both time-reversal and spatial inversion symmetry. The system is assumed to be insulating. For such centrosymmetric topological insulators, the invariant $\\nu$ can be determined from the parity eigenvalues of the occupied energy bands at the time-reversal invariant momenta (TRIM).\n\nThe formula, established by Fu and Kane, is given by\n$$(-1)^{\\nu} = \\prod_{i=1}^{4} \\delta_i$$\nwhere the product runs over the four TRIMs in the 2D Brillouin zone, $\\Gamma_1 = (0,0)$, $\\Gamma_2 = (\\pi,0)$, $\\Gamma_3 = (0,\\pi)$, and $\\Gamma_4 = (\\pi,\\pi)$. The term $\\delta_i$ is the product of the inversion eigenvalues for all occupied Kramers pairs at the TRIM $\\Gamma_i$.\n$$\\delta_i = \\prod_{m} \\xi_{2m}(\\Gamma_i)$$\nwhere $\\xi_{2m}(\\Gamma_i)$ is the inversion eigenvalue of the $m$-th occupied Kramers pair. In the provided model, there are four bands in total. As the system is an insulator, it has two occupied bands (valence bands) and two unoccupied bands (conduction bands). These two occupied bands form a single Kramers pair. Therefore, $\\delta_i$ simplifies to the inversion eigenvalue of this one occupied Kramers pair. Since both states in a Kramers pair share the same inversion eigenvalue in a centrosymmetric system, $\\delta_i$ is simply the inversion eigenvalue of either of the occupied states at $\\Gamma_i$.\n\nThe first step is to analyze the Hamiltonian at the TRIMs. The Bloch Hamiltonian is\n$$H(\\mathbf{k}) \\;=\\; A \\sin k_x \\, \\tau_x \\otimes s_0 \\;+\\; A \\sin k_y \\, \\tau_y \\otimes s_0 \\;+\\; d_z(\\mathbf{k}) \\, \\tau_z \\otimes s_0$$\nwith $d_z(\\mathbf{k}) = M - 2B + B(\\cos k_x + \\cos k_y)$. At any TRIM $\\Gamma_i$, the momenta $(k_x, k_y)$ consist of integer multiples of $\\pi$. Consequently, $\\sin k_x = 0$ and $\\sin k_y = 0$. The Hamiltonian simplifies to\n$$H(\\Gamma_i) = d_z(\\Gamma_i) \\, \\tau_z \\otimes s_0$$\nThis Hamiltonian is diagonal in the specified basis $\\{ |e,\\uparrow\\rangle, |o,\\uparrow\\rangle, |e,\\downarrow\\rangle, |o,\\downarrow\\rangle \\}$. The Pauli matrix $\\tau_z$ has eigenvalues $+1$ for the even-parity orbital $|e\\rangle$ and $-1$ for the odd-parity orbital $|o\\rangle$. The energy eigenvalues at $\\Gamma_i$ are therefore $E = +d_z(\\Gamma_i)$ for the $|e\\rangle$ orbital states and $E = -d_z(\\Gamma_i)$ for the $|o\\rangle$ orbital states. Each of these is doubly degenerate due to the spin degree of freedom.\n\nThe occupied states are those with negative energy (assuming the Fermi level is at $E=0$). Their character, and hence their inversion eigenvalue, depends on the sign of $d_z(\\Gamma_i)$.\nThe inversion operator is $P = \\tau_z \\otimes s_0$. Its action on the orbital basis states is\n$P|e\\rangle = +1 |e\\rangle$ (inversion eigenvalue $\\xi = +1$)\n$P|o\\rangle = -1 |o\\rangle$ (inversion eigenvalue $\\xi = -1$)\n\nThe logic proceeds as follows:\nIf $d_z(\\Gamma_i) > 0$, the energy of the $|o\\rangle$ states is $-d_z(\\Gamma_i) < 0$, making them the occupied states. The inversion eigenvalue of the occupied pair is $\\xi_i = -1$.\nIf $d_z(\\Gamma_i) < 0$, the energy of the $|e\\rangle$ states is $+d_z(\\Gamma_i) < 0$, making them the occupied states. The inversion eigenvalue of the occupied pair is $\\xi_i = +1$.\n\nWe now compute $d_z(\\Gamma_i)$ at each TRIM using the given parameters $M=1.2$ and $B=0.5$.\n\n1) At $\\Gamma_1 = (0,0)$:\n$\\cos(0)=1$.\n$d_z(\\Gamma_1) = M - 2B + B(1+1) = M = 1.2$.\nSince $d_z(\\Gamma_1) > 0$, the occupied states are odd-parity. The inversion eigenvalue $\\xi_1 = -1$.\n\n2) At $\\Gamma_2 = (\\pi,0)$:\n$\\cos(\\pi)=-1, \\cos(0)=1$.\n$d_z(\\Gamma_2) = M - 2B + B(-1+1) = M - 2B = 1.2 - 2(0.5) = 1.2 - 1.0 = 0.2$.\nSince $d_z(\\Gamma_2) > 0$, the occupied states are odd-parity. The inversion eigenvalue $\\xi_2 = -1$.\n\n3) At $\\Gamma_3 = (0,\\pi)$:\n$\\cos(0)=1, \\cos(\\pi)=-1$.\n$d_z(\\Gamma_3) = M - 2B + B(1-1) = M - 2B = 0.2$.\nSince $d_z(\\Gamma_3) > 0$, the occupied states are odd-parity. The inversion eigenvalue $\\xi_3 = -1$.\n\n4) At $\\Gamma_4 = (\\pi,\\pi)$:\n$\\cos(\\pi)=-1$.\n$d_z(\\Gamma_4) = M - 2B + B(-1-1) = M - 4B = 1.2 - 4(0.5) = 1.2 - 2.0 = -0.8$.\nSince $d_z(\\Gamma_4) < 0$, the occupied states are even-parity. The inversion eigenvalue $\\xi_4 = +1$.\n\nThe inversion eigenvalues of the occupied Kramers pair at the four TRIMs are $\\{-1, -1, -1, +1\\}$.\n\nFinally, we compute the $\\mathbb{Z}_2$ invariant $\\nu$. As established, $\\delta_i = \\xi_i$ for this model.\n$$(-1)^{\\nu} = \\prod_{i=1}^{4} \\xi_i = \\xi_1 \\cdot \\xi_2 \\cdot \\xi_3 \\cdot \\xi_4$$\n$$(-1)^{\\nu} = (-1) \\cdot (-1) \\cdot (-1) \\cdot (+1) = -1$$\nFor this equality to hold, the index $\\nu$ must be an odd integer. By convention, the $\\mathbb{Z}_2$ invariant is taken to be $\\nu=1$ for the non-trivial case and $\\nu=0$ for the trivial case. Therefore, $\\nu=1$.", "answer": "$$\\boxed{1}$$", "id": "2867293"}, {"introduction": "To truly grasp the \"topology\" in topological insulators, one must understand its origin in the geometry of the Bloch wavefunctions. This exercise delves into the foundational Haldane model, the first theoretical realization of an insulator with a non-trivial topological invariant—the Chern number $C$. By calculating the Chern number directly from its definition as an integral of the Berry curvature over the Brillouin zone, you will see precisely how global topological properties emerge from the local electronic structure. This practice [@problem_id:2867338] is fundamental to understanding not only the Quantum Anomalous Hall effect but also the conceptual underpinnings of all band topology.", "problem": "Consider the Haldane model on the honeycomb lattice with sublattices labeled by $A$ and $B$, real nearest-neighbor hopping amplitude $t_{1}>0$, complex next-nearest-neighbor hopping amplitude $t_{2}\\exp(i\\nu_{ij}\\phi)$ where $\\nu_{ij}=\\pm 1$ encodes the circulation around a hexagon, and a sublattice-staggered on-site potential $M$ that adds $+M$ on sublattice $A$ and $-M$ on sublattice $B$. In the sublattice basis $(A,B)$, the Bloch Hamiltonian can be written as $H(\\mathbf{k})=d_{0}(\\mathbf{k})\\mathbb{I}+ \\mathbf{d}(\\mathbf{k})\\cdot \\boldsymbol{\\sigma}$ with Pauli matrices $\\boldsymbol{\\sigma}=(\\sigma_{x},\\sigma_{y},\\sigma_{z})$, where $d_{0}(\\mathbf{k})$ is even under time reversal and does not affect Berry curvature, $d_{x}(\\mathbf{k})+i d_{y}(\\mathbf{k})=t_{1}\\sum_{j=1}^{3}\\exp(i\\mathbf{k}\\cdot \\boldsymbol{\\delta}_{j})$ for nearest-neighbor vectors $\\boldsymbol{\\delta}_{j}$, and $d_{z}(\\mathbf{k})=M-2t_{2}\\sin\\phi \\sum_{\\ell=1}^{3}\\sin(\\mathbf{k}\\cdot \\mathbf{b}_{\\ell})$ for next-nearest-neighbor vectors $\\mathbf{b}_{\\ell}$. The two inequivalent Dirac points are at momenta $\\mathbf{K}$ and $\\mathbf{K'}$ in the first Brillouin zone (BZ).\n\nStarting from the definition of the Chern number of the occupied band,\n$$\nC=\\frac{1}{2\\pi}\\int_{\\mathrm{BZ}} d^{2}k\\, \\Omega(\\mathbf{k}),\n$$\nwhere $\\Omega(\\mathbf{k})$ is the Berry curvature of the lower band, and using only low-energy expansions around $\\mathbf{K}$ and $\\mathbf{K'}$ consistent with the above lattice model, derive the closed-form analytic expression for the Chern number $C$ as a function of $M$, $t_{2}$, and $\\phi$. Identify, from your derivation, the topological phase boundaries where the bulk gap closes as conditions relating $M$, $t_{2}$, and $\\phi$. Your final answer must be a single closed-form expression for $C(M,t_{2},\\phi)$ written using standard mathematical functions. No numerical substitution is required, and no units are involved. Do not provide intermediate inequalities or separate cases in your final answer. Express the final result using the sign function $\\mathrm{sgn}(\\cdot)$ where appropriate.", "solution": "The problem as stated is valid. It is a canonical problem in the study of topological phases of matter, specifically the Haldane model, which represents the first theoretical realization of a Chern insulator. The data provided are sufficient and consistent. We proceed with the derivation.\n\nThe system is described by a $2 \\times 2$ Bloch Hamiltonian of the form $H(\\mathbf{k}) = d_{0}(\\mathbf{k})\\mathbb{I} + \\mathbf{d}(\\mathbf{k})\\cdot \\boldsymbol{\\sigma}$, where $\\boldsymbol{\\sigma}$ is the vector of Pauli matrices. The energy eigenvalues are $E_{\\pm}(\\mathbf{k}) = d_{0}(\\mathbf{k}) \\pm |\\mathbf{d}(\\mathbf{k})|$, with $|\\mathbf{d}(\\mathbf{k})|=\\sqrt{d_{x}^{2}(\\mathbf{k})+d_{y}^{2}(\\mathbf{k})+d_{z}^{2}(\\mathbf{k})}$. The term $d_{0}(\\mathbf{k})$ merely shifts the energy levels and does not affect the topology of the bands; thus, we may disregard it.\n\nThe Chern number for the occupied (lower) band is given by the integral of the Berry curvature $\\Omega(\\mathbf{k})$ over the first Brillouin zone (BZ):\n$$\nC = \\frac{1}{2\\pi} \\int_{\\mathrm{BZ}} d^{2}k \\, \\Omega(\\mathbf{k})\n$$\nFor a two-band model described by the vector $\\mathbf{d}(\\mathbf{k})$, the Berry curvature of the lower band is given by:\n$$\n\\Omega(\\mathbf{k}) = -\\frac{1}{2} \\frac{\\mathbf{d}(\\mathbf{k})}{{|\\mathbf{d}(\\mathbf{k})|}^{3}} \\cdot \\left( \\frac{\\partial \\mathbf{d}(\\mathbf{k})}{\\partial k_{x}} \\times \\frac{\\partial \\mathbf{d}(\\mathbf{k})}{\\partial k_{y}} \\right)\n$$\nThe Berry curvature is most significant in regions of the BZ where the band gap, $2|\\mathbf{d}(\\mathbf{k})|$, is small. For the Haldane model, this occurs at the two inequivalent Dirac points, $\\mathbf{K}$ and $\\mathbf{K'}$. Therefore, we can approximate the integral over the entire BZ by summing the contributions from the vicinities of these two points. We linearize the Hamiltonian around each Dirac point. Let $\\mathbf{k} = \\mathbf{K} + \\mathbf{q}$ or $\\mathbf{k} = \\mathbf{K'} + \\mathbf{q}$, where $\\mathbf{q}$ is a small momentum deviation.\n\nThe components of $\\mathbf{d}(\\mathbf{k})$ are given. The off-diagonal terms $d_{x}(\\mathbf{k})+id_{y}(\\mathbf{k})=t_{1}\\sum_{j=1}^{3}\\exp(i\\mathbf{k}\\cdot \\boldsymbol{\\delta}_{j})$ vanish at $\\mathbf{K}$ and $\\mathbf{K'}$. Their low-energy expansion is standard for the honeycomb lattice. By choosing appropriate coordinate axes for $\\mathbf{q}=(q_{x},q_{y})$, the expansion yields a chiral Dirac Hamiltonian. Let $\\xi = \\pm 1$ be the valley index for $\\mathbf{K}$ and $\\mathbf{K'}$ respectively. The low-energy expansion gives:\n$$\nd_{x}(\\mathbf{q}) \\approx v_{F} q_{x}, \\quad d_{y}(\\mathbf{q}) \\approx \\xi v_{F} q_{y}\n$$\nwhere $v_{F}$ is the Fermi velocity, proportional to $t_{1}a$ where $a$ is the lattice constant. The value of $v_F$ will not enter the final topological result.\n\nThe diagonal term is $d_{z}(\\mathbf{k}) = M-2t_{2}\\sin\\phi \\sum_{\\ell=1}^{3}\\sin(\\mathbf{k}\\cdot \\mathbf{b}_{\\ell})$. We evaluate this term at the Dirac points, as it varies slowly with $\\mathbf{q}$ at first order. The sum over the next-nearest-neighbor sine terms has the property:\n$$\n\\sum_{\\ell=1}^{3}\\sin(\\mathbf{K}\\cdot \\mathbf{b}_{\\ell}) = \\frac{3\\sqrt{3}}{2}, \\quad \\sum_{\\ell=1}^{3}\\sin(\\mathbf{K'}\\cdot \\mathbf{b}_{\\ell}) = -\\frac{3\\sqrt{3}}{2}\n$$\nThis gives rise to distinct effective masses at the two valleys. For $\\mathbf{k} \\approx \\mathbf{K}$, the mass is:\n$$\nm_{K} = d_{z}(\\mathbf{K}) = M - 2t_{2}\\sin\\phi \\left(\\frac{3\\sqrt{3}}{2}\\right) = M - 3\\sqrt{3}t_{2}\\sin\\phi\n$$\nFor $\\mathbf{k} \\approx \\mathbf{K'}$, the mass is:\n$$\nm_{K'} = d_{z}(\\mathbf{K'}) = M - 2t_{2}\\sin\\phi \\left(-\\frac{3\\sqrt{3}}{2}\\right) = M + 3\\sqrt{3}t_{2}\\sin\\phi\n$$\nThe effective low-energy Hamiltonian for valley $\\xi$ is thus a massive Dirac Hamiltonian:\n$$\nH_{\\xi}(\\mathbf{q}) = v_{F} q_{x} \\sigma_{x} + \\xi v_{F} q_{y} \\sigma_{y} + m_{\\xi} \\sigma_{z}\n$$\nwhere $m_{+1} \\equiv m_{K}$ and $m_{-1} \\equiv m_{K'}$. The vector $\\mathbf{d}_{\\xi}(\\mathbf{q})$ for this Hamiltonian is $(v_{F}q_{x}, \\xi v_{F}q_{y}, m_{\\xi})$.\n\nWe now calculate the contribution to the Chern number from one such valley. The partial derivatives of $\\mathbf{d}_{\\xi}(\\mathbf{q})$ are $\\partial_{q_{x}}\\mathbf{d}_{\\xi} = (v_{F}, 0, 0)$ and $\\partial_{q_{y}}\\mathbf{d}_{\\xi} = (0, \\xi v_{F}, 0)$. The cross product is $\\partial_{q_{x}}\\mathbf{d}_{\\xi} \\times \\partial_{q_{y}}\\mathbf{d}_{\\xi} = (0, 0, \\xi v_{F}^{2})$.\nThe Berry curvature for the lower band is:\n$$\n\\Omega_{\\xi}(\\mathbf{q}) = -\\frac{1}{2} \\frac{\\mathbf{d}_{\\xi} \\cdot (\\partial_{q_{x}}\\mathbf{d}_{\\xi} \\times \\partial_{q_{y}}\\mathbf{d}_{\\xi})}{|\\mathbf{d}_{\\xi}|^{3}} = -\\frac{1}{2} \\frac{m_{\\xi} (\\xi v_{F}^{2})}{ (v_{F}^{2}(q_{x}^{2}+q_{y}^{2}) + m_{\\xi}^{2})^{3/2} }\n$$\nThe contribution to the Chern number from valley $\\xi$, $C_{\\xi}$, is obtained by integrating $\\Omega_{\\xi}(\\mathbf{q})$ over the 2D plane (as the integral is convergent and localized around $\\mathbf{q}=0$):\n$$\nC_{\\xi} = \\frac{1}{2\\pi} \\int d^{2}q \\, \\Omega_{\\xi}(\\mathbf{q}) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi}d\\theta \\int_{0}^{\\infty} q dq \\left( -\\frac{\\xi m_{\\xi} v_{F}^{2}}{2(v_{F}^{2}q^{2} + m_{\\xi}^{2})^{3/2}} \\right)\n$$\nPerforming the integration:\n$$\nC_{\\xi} = \\int_{0}^{\\infty} \\left( -\\frac{\\xi m_{\\xi} v_{F}^{2}}{2(v_{F}^{2}q^{2} + m_{\\xi}^{2})^{3/2}} \\right) q dq = -\\frac{\\xi m_{\\xi} v_{F}^{2}}{2} \\int_{0}^{\\infty} \\frac{q dq}{(v_{F}^{2}q^{2} + m_{\\xi}^{2})^{3/2}}\n$$\nLet $u = v_{F}^{2}q^{2} + m_{\\xi}^{2}$, so $du = 2v_{F}^{2}q dq$.\n$$\nC_{\\xi} = -\\frac{\\xi m_{\\xi} v_{F}^{2}}{2} \\int_{m_{\\xi}^{2}}^{\\infty} \\frac{du/(2v_{F}^{2})}{u^{3/2}} = -\\frac{\\xi m_{\\xi}}{4} \\left[ -2u^{-1/2} \\right]_{m_{\\xi}^{2}}^{\\infty} = \\frac{\\xi m_{\\xi}}{2} \\left( 0 - \\frac{1}{\\sqrt{m_{\\xi}^{2}}} \\right) = -\\frac{\\xi m_{\\xi}}{2|m_{\\xi}|} = -\\frac{\\xi}{2} \\mathrm{sgn}(m_{\\xi})\n$$\nThe total Chern number is the sum of contributions from both valleys, $C = C_{K} + C_{K'}$. With $\\xi=+1$ for $\\mathbf{K}$ and $\\xi=-1$ for $\\mathbf{K'}$, we have $C_K = -\\frac{1}{2}\\mathrm{sgn}(m_K)$ and $C_{K'} = +\\frac{1}{2}\\mathrm{sgn}(m_{K'})$. Summing these gives:\n$$\nC = \\frac{1}{2} \\left[ \\mathrm{sgn}(m_{K'}) - \\mathrm{sgn}(m_{K}) \\right]\n$$\nSubstituting the expressions for $m_{K}$ and $m_{K'}$:\n$$\nC = \\frac{1}{2} \\left[ \\mathrm{sgn}(M + 3\\sqrt{3}t_{2}\\sin\\phi) - \\mathrm{sgn}(M - 3\\sqrt{3}t_{2}\\sin\\phi) \\right]\n$$\nThis is the final closed-form expression for the Chern number.\n\nThe topological phase transitions occur when the bulk energy gap closes. This happens when the effective mass at either Dirac point vanishes, i.e., $m_{K}=0$ or $m_{K'}=0$. These conditions define the phase boundaries:\n$$\nM - 3\\sqrt{3}t_{2}\\sin\\phi = 0 \\quad \\text{or} \\quad M + 3\\sqrt{3}t_{2}\\sin\\phi = 0\n$$\nThus, the phase boundaries are given by the lines $M = \\pm 3\\sqrt{3}t_{2}\\sin\\phi$ in the parameter space.\nWithin the region $|M| < |3\\sqrt{3}t_{2}\\sin\\phi|$, the signs of $m_{K}$ and $m_{K'}$ are opposite, leading to a non-zero Chern number $C = \\pm 1$. Outside this region, the signs are the same, and the system is in a topologically trivial phase with $C=0$. The value of $C$ changes by an integer only when the gap closes, consistent with the theory of topological invariants.", "answer": "$$\n\\boxed{\\frac{1}{2}\\left[\\mathrm{sgn}\\left(M + 3\\sqrt{3}t_{2}\\sin\\phi\\right) - \\mathrm{sgn}\\left(M - 3\\sqrt{3}t_{2}\\sin\\phi\\right)\\right]}\n$$", "id": "2867338"}, {"introduction": "Bridging the gap between analytical theory and real-world research often requires computational methods. This hands-on programming exercise guides you through the numerical computation of the $\\mathbb{Z}_2$ invariant for the celebrated Bernevig-Hughes-Zhang (BHZ) model, a cornerstone of the quantum spin Hall effect. You will implement the robust Fukui-Hatsugai-Suzuki algorithm, which computes the Chern number on a discretized Brillouin zone using gauge-invariant link variables. This practice [@problem_id:2867350] not only reinforces theoretical concepts but also equips you with a practical skill used in modern computational materials discovery to classify and predict new topological materials.", "problem": "You are asked to write a complete, runnable program that computes the topological $\\mathbb{Z}_2$ invariant of a two-dimensional time-reversal-symmetric insulating tight-binding model on a discretized Brillouin zone, using link variables constructed to respect time-reversal symmetry via a spin-block decomposition, and to study the convergence with respect to mesh refinement.\n\nThe computation must start from fundamental definitions. Assume a two-dimensional crystalline insulator with time-reversal symmetry represented by an antiunitary operator $\\Theta$ satisfying $\\Theta^2 = -\\mathbb{I}$, implying Kramers degeneracy at the time-reversal invariant momenta. Consider a tight-binding model that, in the absence of spin-mixing terms, block-diagonalizes into two spin sectors that are time-reversed partners. In this spin-conserving case, the topological $\\mathbb{Z}_2$ invariant equals the spin Chern number modulo two, which reduces to the Chern number of a single spin block modulo two due to $C_{\\uparrow} = - C_{\\downarrow}$ by time-reversal symmetry. Your derivation must rest on the following well-tested facts:\n\n- The Chern number $C$ of an isolated band over the Brillouin zone equals the integral of the Berry curvature divided by $2\\pi$, which is an integer for a smooth, gapped bundle.\n\n- On a discrete mesh, the Berry curvature can be approximated in a gauge-invariant manner using link variables $U_{\\mu}(\\mathbf{k})$ built from overlaps of neighboring Bloch states, following the Fukui-Hatsugai-Suzuki construction. For a single nondegenerate band with normalized Bloch eigenvector $|u(\\mathbf{k})\\rangle$, the link variables are\n  $$U_{1}(\\mathbf{k}) = \\frac{\\langle u(\\mathbf{k}) | u(\\mathbf{k}+\\Delta k_x\\,\\hat{x}) \\rangle}{|\\langle u(\\mathbf{k}) | u(\\mathbf{k}+\\Delta k_x\\,\\hat{x}) \\rangle|}, \\quad U_{2}(\\mathbf{k}) = \\frac{\\langle u(\\mathbf{k}) | u(\\mathbf{k}+\\Delta k_y\\,\\hat{y}) \\rangle}{|\\langle u(\\mathbf{k}) | u(\\mathbf{k}+\\Delta k_y\\,\\hat{y}) \\rangle|},$$\n  and the lattice field strength on the plaquette anchored at $\\mathbf{k}$ is\n  $$F_{12}(\\mathbf{k}) = \\mathrm{Arg}\\left[ U_{1}(\\mathbf{k})\\, U_{2}(\\mathbf{k}+\\Delta k_x\\,\\hat{x})\\, U_{1}(\\mathbf{k}+\\Delta k_y\\,\\hat{y})^{-1}\\, U_{2}(\\mathbf{k})^{-1} \\right],$$\n  where $\\mathrm{Arg}$ returns the principal value in $(-\\pi,\\pi]$ and $\\hat{x},\\hat{y}$ are unit vectors in reciprocal space.\n\n- If spin $S_z$ is conserved, the $\\mathbb{Z}_2$ invariant $\\nu$ satisfies $\\nu \\equiv C_{\\uparrow} \\bmod 2$, where $C_{\\uparrow}$ is the Chern number of the spin-up block. This uses time-reversal symmetry to form time-reversal-symmetric link variables by working within one spin block and recognizing that the partner block is related by $\\Theta$.\n\nUse as the concrete model the Bernevig-Hughes-Zhang (BHZ) lattice model (spin-conserving limit) defined in momentum space by a $2\\times 2$ block Hamiltonian in the spin-up sector\n$$H_{\\uparrow}(\\mathbf{k}) = d_1(\\mathbf{k})\\,\\sigma_x + d_2(\\mathbf{k})\\,\\sigma_y + d_3(\\mathbf{k})\\,\\sigma_z,$$\nwith Pauli matrices $\\sigma_x,\\sigma_y,\\sigma_z$, where\n$$d_1(\\mathbf{k}) = A \\sin k_x,\\quad d_2(\\mathbf{k}) = A \\sin k_y,\\quad d_3(\\mathbf{k}) = M - 2B\\left[2 - \\cos k_x - \\cos k_y\\right].$$\nTime-reversal symmetry ensures the full $4\\times 4$ Hamiltonian is block diagonal with the spin-down block related by $\\Theta$ and has identical spectrum. At half filling, the occupied subspace consists of the lower band of each spin block. The direct energy gap is $2\\,\\left\\|\\mathbf{d}(\\mathbf{k})\\right\\|$ at momentum $\\mathbf{k}$, where $\\left\\|\\mathbf{d}\\right\\| = \\sqrt{d_1^2 + d_2^2 + d_3^2}$.\n\nYour program must:\n\n- Discretize the Brillouin zone $\\mathbb{T}^2$ as a uniform mesh of $N_x \\times N_y$ points with periodic boundary conditions, with $k_x \\in [-\\pi,\\pi)$ and $k_y \\in [-\\pi,\\pi)$. Take $\\Delta k_x = 2\\pi/N_x$ and $\\Delta k_y = 2\\pi/N_y$.\n\n- For the spin-up block, compute the normalized occupied eigenvector $|u_{\\uparrow}(\\mathbf{k})\\rangle$ of $H_{\\uparrow}(\\mathbf{k})$ for each mesh point. Using the link-variable formula above, compute the lattice field strength $F_{12}(\\mathbf{k})$ and sum over all plaquettes to obtain the discretized Chern number estimate:\n  $$C_{\\uparrow}^{\\mathrm{(mesh)}} = \\frac{1}{2\\pi}\\sum_{\\mathbf{k}} F_{12}(\\mathbf{k}).$$\n\n- Estimate the minimal direct gap over the mesh using the exact expression $2\\,\\min_{\\mathbf{k}} \\left\\|\\mathbf{d}(\\mathbf{k})\\right\\|$. If the minimal gap is less than a tolerance $\\varepsilon = 10^{-6}$, treat the system as gapless and output a special floating-point value for the $\\mathbb{Z}_2$ index as specified below, instead of computing it.\n\n- Otherwise, compute the $\\mathbb{Z}_2$ invariant as\n  $$\\nu = \\left( C_{\\uparrow}^{\\mathrm{(mesh)}} \\right) \\bmod 2,$$\n  where the modulo is taken after rounding $C_{\\uparrow}^{\\mathrm{(mesh)}}$ to the nearest integer.\n\n- Discuss, in your solution, why the discretized $C_{\\uparrow}^{\\mathrm{(mesh)}}$ approaches an integer as $N_x,N_y \\to \\infty$ and why the parity stabilizes rapidly, connecting this to the smoothness of the Berry connection over the gapped Brillouin zone.\n\nUse the following test suite of parameter sets $(A,B,M,N_x,N_y)$ to exercise different regimes (topological, trivial, gapless) and mesh refinements:\n\n- $(A,B,M,N_x,N_y) = (1,1,1,15,15)$,\n- $(A,B,M,N_x,N_y) = (1,1,1,31,31)$,\n- $(A,B,M,N_x,N_y) = (1,1,1,61,61)$,\n- $(A,B,M,N_x,N_y) = (1,1,5,31,31)$,\n- $(A,B,M,N_x,N_y) = (1,1,0,31,31)$.\n\nFor each case, your program must output a single number: the $\\mathbb{Z}_2$ invariant $\\nu$ as an integer $0$ or $1$ if the minimal gap is greater than the tolerance $\\varepsilon$, and the floating-point Not-a-Number (NaN) if the minimal gap is less than or equal to $\\varepsilon$ (indicating that the index is undefined at a gap closing). Angles are in radians; there are no physical units to report.\n\nFinal output format: Your program should produce a single line of output containing the results for the five test cases as a comma-separated list enclosed in square brackets, in the order listed above, for example, $[1,1,1,0,nan]$.", "solution": "We begin from time-reversal symmetry represented by an antiunitary operator $\\Theta$ satisfying $\\Theta^2 = -\\mathbb{I}$ for half-integer spin systems. This implies Kramers degeneracy at time-reversal invariant momenta. For a two-dimensional insulator preserving $S_z$ (spin along $z$) and time-reversal symmetry, the Bloch Hamiltonian block-diagonalizes into two $2\\times 2$ sectors for spin-up and spin-down, which are mapped into each other by $\\Theta$ and share the same spectrum. Let $H_{\\uparrow}(\\mathbf{k})$ denote the spin-up block, with $\\mathbf{k} = (k_x,k_y)$.\n\nFor the Bernevig-Hughes-Zhang (BHZ) model in lattice form, the spin-up block is\n$$H_{\\uparrow}(\\mathbf{k}) = d_1(\\mathbf{k})\\,\\sigma_x + d_2(\\mathbf{k})\\,\\sigma_y + d_3(\\mathbf{k})\\,\\sigma_z,$$\nwith\n$$d_1(\\mathbf{k}) = A \\sin k_x,\\quad d_2(\\mathbf{k}) = A \\sin k_y,\\quad d_3(\\mathbf{k}) = M - 2B\\left[2 - \\cos k_x - \\cos k_y\\right].$$\nThe eigenvalues are $\\pm \\|\\mathbf{d}(\\mathbf{k})\\|$, where $\\|\\mathbf{d}\\| = \\sqrt{d_1^2 + d_2^2 + d_3^2}$, so the direct gap is $2\\|\\mathbf{d}(\\mathbf{k})\\|$. The system is insulating if $\\min_{\\mathbf{k}} 2\\|\\mathbf{d}(\\mathbf{k})\\| > 0$. In the spin-down sector (decoupled in the $S_z$-conserving limit), the Hamiltonian is the time-reversal partner and the spectrum is identical. The occupied subspace at half filling is the lower band in each spin block.\n\nThe topological $\\mathbb{Z}_2$ invariant $\\nu$ for a two-dimensional time-reversal invariant insulator can be characterized, in the $S_z$-conserving limit, by the parity of the spin Chern number, which reduces to a single spin-block Chern number modulo two:\n$$\\nu \\equiv \\frac{C_{\\uparrow} - C_{\\downarrow}}{2} \\pmod 2 \\equiv C_{\\uparrow} \\pmod 2,$$\nbecause time-reversal symmetry enforces $C_{\\uparrow} = - C_{\\downarrow}$. This is a well-known consequence of decoupled Chern insulators forming a Quantum Spin Hall phase when the up/down Chern numbers are opposite.\n\nWe do not rely on continuous Berry connections directly, but use the well-tested Fukui-Hatsugai-Suzuki lattice method to compute the Chern number from gauge-invariant link variables on a discrete mesh. Discretize the Brillouin zone $\\mathbb{T}^2$ with $N_x \\times N_y$ points:\n$$k_x(i) = -\\pi + \\frac{2\\pi i}{N_x},\\quad i\\in \\{0,1,\\dots,N_x-1\\},\\qquad k_y(j) = -\\pi + \\frac{2\\pi j}{N_y},\\quad j\\in \\{0,1,\\dots,N_y-1\\},$$\nwith periodic boundary conditions. For each $\\mathbf{k}$, compute the normalized occupied eigenvector $|u_{\\uparrow}(\\mathbf{k})\\rangle$ (the eigenvector of $H_{\\uparrow}(\\mathbf{k})$ with eigenvalue $-\\|\\mathbf{d}(\\mathbf{k})\\|$). Define the link variables\n$$U_{1}(\\mathbf{k}) = \\frac{\\langle u_{\\uparrow}(\\mathbf{k}) | u_{\\uparrow}(\\mathbf{k}+\\Delta k_x\\,\\hat{x}) \\rangle}{|\\langle u_{\\uparrow}(\\mathbf{k}) | u_{\\uparrow}(\\mathbf{k}+\\Delta k_x\\,\\hat{x}) \\rangle|}, \\quad U_{2}(\\mathbf{k}) = \\frac{\\langle u_{\\uparrow}(\\mathbf{k}) | u_{\\uparrow}(\\mathbf{k}+\\Delta k_y\\,\\hat{y}) \\rangle}{|\\langle u_{\\uparrow}(\\mathbf{k}) | u_{\\uparrow}(\\mathbf{k}+\\Delta k_y\\,\\hat{y}) \\rangle|},$$\nwhere $\\Delta k_x = 2\\pi/N_x$ and $\\Delta k_y = 2\\pi/N_y$. These link variables are manifestly $U(1)$ gauge invariant because arbitrary local phase choices in $|u_{\\uparrow}(\\mathbf{k})\\rangle$ cancel in the products below. The lattice field strength on a plaquette anchored at $\\mathbf{k}$ is\n$$F_{12}(\\mathbf{k}) = \\mathrm{Arg}\\left[ U_{1}(\\mathbf{k})\\, U_{2}(\\mathbf{k}+\\Delta k_x\\,\\hat{x})\\, U_{1}(\\mathbf{k}+\\Delta k_y\\,\\hat{y})^{-1}\\, U_{2}(\\mathbf{k})^{-1} \\right],$$\nwith $\\mathrm{Arg} \\in (-\\pi,\\pi]$. The discretized Chern number is the sum over all plaquettes divided by $2\\pi$:\n$$C_{\\uparrow}^{\\mathrm{(mesh)}} = \\frac{1}{2\\pi} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} F_{12}\\big(k_x(i),k_y(j)\\big).$$\n\nBecause the Berry curvature is smooth on a gapped Brillouin zone and the lattice field strength $F_{12}$ is a convergent approximation to the continuum curvature, $C_{\\uparrow}^{\\mathrm{(mesh)}}$ converges to the integer Chern number as $N_x$ and $N_y$ increase. The convergence is typically second order in the mesh spacing for smooth fields, due to the trapezoidal-like error in the lattice approximation, and the rounding to the nearest integer stabilizes rapidly as long as the mesh resolves the curvature without encountering the branch cut ambiguities of $\\mathrm{Arg}$. Time-reversal symmetry is enforced at the level of the topological invariant by using only one spin block and taking the parity, which is equivalent to forming time-reversal-symmetric link variables across the two blocks in the $S_z$-conserving case.\n\nThe minimal direct gap is computed as\n$$\\Delta_{\\min} = 2 \\min_{\\mathbf{k}} \\|\\mathbf{d}(\\mathbf{k})\\|.$$\nIf $\\Delta_{\\min} \\le \\varepsilon$ with $\\varepsilon = 10^{-6}$, we deem the system gapless and the $\\mathbb{Z}_2$ invariant undefined; the program returns a floating-point Not-a-Number to indicate this special case. Otherwise, we compute\n$$\\nu = \\left(\\mathrm{round}\\left(C_{\\uparrow}^{\\mathrm{(mesh)}}\\right)\\right) \\pmod 2,$$\nwhere $\\mathrm{round}$ maps to the nearest integer.\n\nAlgorithmic steps:\n- For each test case $(A,B,M,N_x,N_y)$, construct the $N_x \\times N_y$ mesh.\n- For each $\\mathbf{k}$, compute $d_1,d_2,d_3$ and the $2\\times 2$ Hamiltonian $H_{\\uparrow}(\\mathbf{k})$, diagonalize to get the occupied eigenvector $|u_{\\uparrow}(\\mathbf{k})\\rangle$.\n- Compute link variables $U_{1}(\\mathbf{k})$ and $U_{2}(\\mathbf{k})$ and the plaquette field strength $F_{12}(\\mathbf{k})$ with periodic boundary conditions.\n- Sum $F_{12}$, divide by $2\\pi$, and round to get $C_{\\uparrow}$.\n- Compute $\\Delta_{\\min}$ from $2\\|\\mathbf{d}(\\mathbf{k})\\|$ over the mesh. If $\\Delta_{\\min} \\le \\varepsilon$, output NaN; else output $\\nu = C_{\\uparrow} \\bmod 2$.\n- Aggregate outputs in the required order and format.\n\nFinite-mesh convergence discussion:\n- For the BHZ model with $(A,B,M) = (1,1,1)$, the continuum phase is topological with $\\nu = 1$ because $0 < M/B < 4$ leads to band inversion at the $\\Gamma$ point and a nontrivial spin Chern parity. The computed $C_{\\uparrow}^{\\mathrm{(mesh)}}$ approaches $1$ as $(N_x,N_y)$ increase from $(15,15)$ to $(31,31)$ to $(61,61)$; the parity is already correct on coarse meshes.\n- For $(A,B,M) = (1,1,5)$, the system is trivial since $M/B > 4$, and $C_{\\uparrow}^{\\mathrm{(mesh)}} \\to 0$, giving $\\nu = 0$.\n- For $(A,B,M) = (1,1,0)$, the gap closes at $\\mathbf{k} = (0,0)$; the invariant is undefined, and the minimal gap detection correctly yields a NaN output.\n- These behaviors reflect that discretization errors in $C_{\\uparrow}^{\\mathrm{(mesh)}}$ diminish with finer meshes and that the parity is robust in the gapped regime.\n\nThe program implements these steps and prints a single line containing the five results in the specified order, as a bracketed comma-separated list.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef bhz_d_components(kx, ky, A, B, M):\n    \"\"\"\n    Compute the d-vector components for the lattice BHZ model.\n    \"\"\"\n    d1 = A * np.sin(kx)\n    d2 = A * np.sin(ky)\n    d3 = M - 2.0 * B * (2.0 - np.cos(kx) - np.cos(ky))\n    return d1, d2, d3\n\ndef bhz_spinup_hamiltonian(kx, ky, A, B, M):\n    \"\"\"\n    Construct the 2x2 spin-up block Hamiltonian H_up = d1 σx + d2 σy + d3 σz.\n    \"\"\"\n    d1, d2, d3 = bhz_d_components(kx, ky, A, B, M)\n    # Pauli matrices\n    # σx = [[0,1],[1,0]], σy = [[0,-i],[i,0]], σz = [[1,0],[0,-1]]\n    H = np.array([[d3, d1 - 1j * d2],\n                  [d1 + 1j * d2, -d3]], dtype=np.complex128)\n    return H\n\ndef occupied_eigenvector_spinup(kx, ky, A, B, M):\n    \"\"\"\n    Return the normalized eigenvector corresponding to the lower (occupied) band\n    of the spin-up 2x2 Hamiltonian at (kx, ky).\n    \"\"\"\n    H = bhz_spinup_hamiltonian(kx, ky, A, B, M)\n    evals, evecs = np.linalg.eigh(H)\n    # np.linalg.eigh returns eigenvalues in ascending order; the first is the lower band\n    vec_occ = evecs[:, 0]\n    # Normalize to ensure robustness\n    norm = np.linalg.norm(vec_occ)\n    if norm == 0:\n        return vec_occ\n    return vec_occ / norm\n\ndef compute_min_direct_gap(A, B, M, Nx, Ny):\n    \"\"\"\n    Compute the minimal direct gap 2*||d(k)|| across the Brillouin zone mesh.\n    \"\"\"\n    kxs = -np.pi + (2.0 * np.pi / Nx) * np.arange(Nx)\n    kys = -np.pi + (2.0 * np.pi / Ny) * np.arange(Ny)\n    min_norm_d = np.inf\n    for kx in kxs:\n        for ky in kys:\n            d1, d2, d3 = bhz_d_components(kx, ky, A, B, M)\n            norm_d = np.sqrt(d1 * d1 + d2 * d2 + d3 * d3)\n            if norm_d < min_norm_d:\n                min_norm_d = norm_d\n    return 2.0 * min_norm_d\n\ndef compute_spinup_chern_number(A, B, M, Nx, Ny):\n    \"\"\"\n    Compute the discretized Chern number for the occupied spin-up band using\n    the Fukui-Hatsugai-Suzuki link-variable method on an Nx x Ny mesh.\n    Returns a float which should be close to an integer if the system is gapped.\n    \"\"\"\n    # Mesh\n    kxs = -np.pi + (2.0 * np.pi / Nx) * np.arange(Nx)\n    kys = -np.pi + (2.0 * np.pi / Ny) * np.arange(Ny)\n\n    # Precompute occupied eigenvectors on the grid\n    occ_vecs = np.empty((Nx, Ny, 2), dtype=np.complex128)\n    for ix, kx in enumerate(kxs):\n        for iy, ky in enumerate(kys):\n            occ_vecs[ix, iy, :] = occupied_eigenvector_spinup(kx, ky, A, B, M)\n\n    # Compute link variables and lattice field strength\n    total_F = 0.0\n    for ix in range(Nx):\n        ixp = (ix + 1) % Nx\n        for iy in range(Ny):\n            iyp = (iy + 1) % Ny\n            u = occ_vecs[ix, iy, :]\n            ux = occ_vecs[ixp, iy, :]\n            uy = occ_vecs[ix, iyp, :]\n            uxy = occ_vecs[ixp, iyp, :]\n\n            # Link variables with normalization to unit magnitude\n            U1 = np.vdot(u, ux)\n            U2 = np.vdot(u, uy)\n            U1y = np.vdot(uy, uxy)  # U1 evaluated at (ix, iy+1): <u(k+ey)|u(k+ex+ey)>\n            U2x = np.vdot(ux, uxy)  # U2 evaluated at (ix+1, iy): <u(k+ex)|u(k+ex+ey)>\n\n            # Normalize to unit magnitude; add small epsilon to avoid division by zero\n            eps = 1e-300\n            U1 /= (np.abs(U1) + eps)\n            U2 /= (np.abs(U2) + eps)\n            U1y /= (np.abs(U1y) + eps)\n            U2x /= (np.abs(U2x) + eps)\n\n            # Plaquette field strength: Arg(U1 * U2x * conj(U1y) * conj(U2))\n            z = U1 * U2x * np.conj(U1y) * np.conj(U2)\n            F = np.angle(z)  # principal value in (-pi, pi]\n            total_F += F\n\n    chern = total_F / (2.0 * np.pi)\n    return chern\n\ndef z2_invariant_via_spin_chern(A, B, M, Nx, Ny, gap_tol=1e-6):\n    \"\"\"\n    Compute the Z2 invariant as the parity of the spin-up Chern number modulo 2,\n    when the minimal direct gap exceeds gap_tol. If the gap is <= gap_tol, return NaN.\n    \"\"\"\n    min_gap = compute_min_direct_gap(A, B, M, Nx, Ny)\n    if min_gap <= gap_tol:\n        return float('nan')\n    chern_up = compute_spinup_chern_number(A, B, M, Nx, Ny)\n    chern_up_rounded = int(np.rint(chern_up))\n    z2 = chern_up_rounded % 2\n    return int(z2)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is (A, B, M, Nx, Ny)\n    test_cases = [\n        (1.0, 1.0, 1.0, 15, 15),\n        (1.0, 1.0, 1.0, 31, 31),\n        (1.0, 1.0, 1.0, 61, 61),\n        (1.0, 1.0, 5.0, 31, 31),\n        (1.0, 1.0, 0.0, 31, 31),\n    ]\n\n    results = []\n    for A, B, M, Nx, Ny in test_cases:\n        z2 = z2_invariant_via_spin_chern(A, B, M, Nx, Ny, gap_tol=1e-6)\n        results.append(z2)\n\n    # Final print statement in the exact required format.\n    # Ensure 'nan' appears lowercase if present (Python's str(float('nan')) -> 'nan').\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2867350"}]}