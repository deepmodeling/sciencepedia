{"hands_on_practices": [{"introduction": "The cornerstone of the finite element method for structural analysis is the systematic construction of the global stiffness matrix, $\\mathbf{K}$. This exercise guides you through this fundamental process from first principles, starting with the stiffness of a single truss element and transforming it into the global coordinate system. By assembling the individual matrices by superposition, you will gain hands-on experience in building the governing system of equations for a complete truss structure [@problem_id:2608503].", "problem": "Consider a planar pin-jointed truss modeled with the Finite Element Method (FEM). There are four nodes with two translational degrees of freedom per node. Let the global degree-of-freedom ordering be\n$$[\\,u_{1x},\\,u_{1y},\\,u_{2x},\\,u_{2y},\\,u_{3x},\\,u_{3y},\\,u_{4x},\\,u_{4y}\\,]^{\\mathsf{T}}.$$\nThe nodal coordinates are\n- Node $1$: $(0,\\,0)$,\n- Node $2$: $(L,\\,0)$,\n- Node $3$: $(0,\\,L)$,\n- Node $4$: $(L,\\,L)$,\nwhere $L>0$ is a given length scale. All truss members have the same Young’s modulus $E>0$ and cross-sectional area $A>0$.\n\nThe structure consists of three two-node truss elements:\n- Element $1$: between nodes $(1,\\,2)$,\n- Element $2$: between nodes $(2,\\,4)$,\n- Element $3$: between nodes $(1,\\,4)$.\n\nStarting from first principles (axial bar kinematics, linear elasticity, and the principle of virtual work), derive the element stiffness in local coordinates and its transformation into global Cartesian coordinates via direction cosines, then assemble the global stiffness matrix for the given degree-of-freedom ordering by superposition of element contributions. You must construct the assembled $8\\times 8$ global stiffness matrix explicitly.\n\nFinally, compute the trace of the assembled global stiffness matrix and express your final result as a single simplified analytic expression in terms of $E$, $A$, and $L$. Do not substitute numerical values. Do not include units. No rounding is required.", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, objective, and self-contained. There are no contradictions, ambiguities, or missing data. The task is a standard exercise in the Finite Element Method for structural analysis. We may therefore proceed with the solution.\n\nThe derivation of the global stiffness matrix for a truss structure proceeds in three stages: first, the derivation of the stiffness matrix for a single element in its own local coordinate system; second, the transformation of this matrix into the global coordinate system; and third, the assembly of the element matrices into the global system matrix.\n\n**1. Element Stiffness Matrix in Local Coordinates**\n\nConsider a single truss element of length $L_e$, Young's modulus $E$, and cross-sectional area $A$. Let a local coordinate axis $\\bar{x}$ be aligned with the element, running from node $1$ at $\\bar{x}=0$ to node $2$ at $\\bar{x}=L_e$. The axial displacements at the nodes are $\\bar{d}_1$ and $\\bar{d}_2$. The displacement field $\\bar{u}(\\bar{x})$ along the element is approximated using linear shape functions:\n$$\n\\bar{u}(\\bar{x}) = N_1(\\bar{x})\\bar{d}_1 + N_2(\\bar{x})\\bar{d}_2\n$$\nwhere $N_1(\\bar{x}) = 1 - \\frac{\\bar{x}}{L_e}$ and $N_2(\\bar{x}) = \\frac{\\bar{x}}{L_e}$. In matrix form, this is $\\bar{u}(\\bar{x}) = \\mathbf{N}(\\bar{x})\\bar{\\mathbf{d}}$, where $\\mathbf{N} = \\begin{pmatrix} N_1 & N_2 \\end{pmatrix}$ and $\\bar{\\mathbf{d}} = \\begin{pmatrix} \\bar{d}_1 & \\bar{d}_2 \\end{pmatrix}^{\\mathsf{T}}$.\n\nThe axial strain, $\\epsilon_{\\bar{x}}$, is the derivative of the displacement field with respect to $\\bar{x}$:\n$$\n\\epsilon_{\\bar{x}} = \\frac{d\\bar{u}}{d\\bar{x}} = \\frac{d\\mathbf{N}}{d\\bar{x}}\\bar{\\mathbf{d}} = \\begin{pmatrix} -\\frac{1}{L_e} & \\frac{1}{L_e} \\end{pmatrix} \\bar{\\mathbf{d}} = \\mathbf{B}\\bar{\\mathbf{d}}\n$$\nwhere $\\mathbf{B}$ is the strain-displacement matrix.\n\nAssuming linear elasticity, the axial stress $\\sigma_{\\bar{x}}$ is related to the strain by Hooke's Law: $\\sigma_{\\bar{x}} = E \\epsilon_{\\bar{x}} = E\\mathbf{B}\\bar{\\mathbf{d}}$.\n\nThe element stiffness matrix $\\bar{\\mathbf{k}}$ is derived using the principle of virtual work, which equates the internal virtual work to the external virtual work. The internal virtual work $\\delta W_{\\text{int}}$ is:\n$$\n\\delta W_{\\text{int}} = \\int_{V} \\delta\\epsilon_{\\bar{x}}^{\\mathsf{T}} \\sigma_{\\bar{x}} dV = \\int_{0}^{L_e} (\\mathbf{B}\\delta\\bar{\\mathbf{d}})^{\\mathsf{T}} (E\\mathbf{B}\\bar{\\mathbf{d}}) A d\\bar{x} = \\delta\\bar{\\mathbf{d}}^{\\mathsf{T}} \\left( \\int_{0}^{L_e} \\mathbf{B}^{\\mathsf{T}} E \\mathbf{B} A d\\bar{x} \\right) \\bar{\\mathbf{d}}\n$$\nThe external virtual work is $\\delta W_{\\text{ext}} = \\delta\\bar{\\mathbf{d}}^{\\mathsf{T}}\\bar{\\mathbf{f}}$, where $\\bar{\\mathbf{f}}$ are the nodal forces. From $\\delta W_{\\text{int}} = \\delta W_{\\text{ext}}$, we identify the element stiffness matrix $\\bar{\\mathbf{k}}$ as:\n$$\n\\bar{\\mathbf{k}} = \\int_{0}^{L_e} A E \\mathbf{B}^{\\mathsf{T}} \\mathbf{B} d\\bar{x}\n$$\nSubstituting $\\mathbf{B}$, we get:\n$$\n\\mathbf{B}^{\\mathsf{T}} \\mathbf{B} = \\begin{pmatrix} -1/L_e \\\\ 1/L_e \\end{pmatrix} \\begin{pmatrix} -1/L_e & 1/L_e \\end{pmatrix} = \\frac{1}{L_e^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nSince $A$, $E$, and $\\mathbf{B}$ are constant over the element, the integral becomes a simple multiplication by $L_e$:\n$$\n\\bar{\\mathbf{k}} = A E L_e \\left( \\frac{1}{L_e^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\right) = \\frac{AE}{L_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nThis is the $2 \\times 2$ stiffness matrix for a truss element in its local 1D coordinate system.\n\n**2. Transformation to Global Coordinates**\n\nFor a 2D truss, each node has two global degrees of freedom, $(u_x, u_y)$. An element connecting nodes $i$ and $j$ has a $4 \\times 4$ stiffness matrix $\\mathbf{k}_e$ in the global system. Let the element axis form an angle $\\theta$ with the global $x$-axis. The direction cosines are $c = \\cos\\theta = (x_j - x_i)/L_e$ and $s = \\sin\\theta = (y_j - y_i)/L_e$. The local axial displacements $(\\bar{d}_i, \\bar{d}_j)$ are projections of the global displacements $(u_{ix}, u_{iy}, u_{jx}, u_{jy})$:\n$$\n\\begin{pmatrix} \\bar{d}_i \\\\ \\bar{d}_j \\end{pmatrix} = \\begin{pmatrix} c & s & 0 & 0 \\\\ 0 & 0 & c & s \\end{pmatrix} \\begin{pmatrix} u_{ix} \\\\ u_{iy} \\\\ u_{jx} \\\\ u_{jy} \\end{pmatrix} \\quad \\text{or} \\quad \\bar{\\mathbf{d}} = \\mathbf{L}\\mathbf{d}\n$$\nThe global stiffness matrix $\\mathbf{k}_e$ is obtained via the transformation $\\mathbf{k}_e = \\mathbf{L}^{\\mathsf{T}} \\bar{\\mathbf{k}} \\mathbf{L}$:\n$$\n\\mathbf{k}_e = \\mathbf{L}^{\\mathsf{T}} \\left( \\frac{AE}{L_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\right) \\mathbf{L} = \\frac{AE}{L_e} \\begin{pmatrix} c & 0 \\\\ s & 0 \\\\ 0 & c \\\\ 0 & s \\end{pmatrix} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} c & s & 0 & 0 \\\\ 0 & 0 & c & s \\end{pmatrix}\n$$\nPerforming the matrix multiplications yields:\n$$\n\\mathbf{k}_e = \\frac{AE}{L_e} \\begin{pmatrix} c^2 & cs & -c^2 & -cs \\\\ cs & s^2 & -cs & -s^2 \\\\ -c^2 & -cs & c^2 & cs \\\\ -cs & -s^2 & cs & s^2 \\end{pmatrix}\n$$\n\n**3. Element Stiffness Matrices for the Given Structure**\n\nWe now compute this matrix for each of the three elements. Let $C = \\frac{AE}{L}$.\n- **Element 1 (Nodes 1 to 2):** Connects $(0,0)$ to $(L,0)$.\n  $L_e^{(1)} = L$. Direction cosines: $c = \\frac{L-0}{L} = 1$, $s = \\frac{0-0}{L} = 0$.\n  $$ \\mathbf{k}^{(1)} = \\frac{AE}{L} \\begin{pmatrix} 1 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ -1 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\n\n- **Element 2 (Nodes 2 to 4):** Connects $(L,0)$ to $(L,L)$.\n  $L_e^{(2)} = L$. Direction cosines: $c = \\frac{L-L}{L} = 0$, $s = \\frac{L-0}{L} = 1$.\n  $$ \\mathbf{k}^{(2)} = \\frac{AE}{L} \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & -1 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & -1 & 0 & 1 \\end{pmatrix} $$\n\n- **Element 3 (Nodes 1 to 4):** Connects $(0,0)$ to $(L,L)$.\n  $L_e^{(3)} = \\sqrt{L^2+L^2} = L\\sqrt{2}$. Direction cosines: $c = \\frac{L}{L\\sqrt{2}} = \\frac{1}{\\sqrt{2}}$, $s = \\frac{L}{L\\sqrt{2}} = \\frac{1}{\\sqrt{2}}$.\n  $c^2 = \\frac{1}{2}$, $s^2 = \\frac{1}{2}$, $cs = \\frac{1}{2}$.\n  $$ \\mathbf{k}^{(3)} = \\frac{AE}{L\\sqrt{2}} \\begin{pmatrix} 1/2 & 1/2 & -1/2 & -1/2 \\\\ 1/2 & 1/2 & -1/2 & -1/2 \\\\ -1/2 & -1/2 & 1/2 & 1/2 \\\\ -1/2 & -1/2 & 1/2 & 1/2 \\end{pmatrix} = \\frac{AE}{2L\\sqrt{2}} \\begin{pmatrix} 1 & 1 & -1 & -1 \\\\ 1 & 1 & -1 & -1 \\\\ -1 & -1 & 1 & 1 \\\\ -1 & -1 & 1 & 1 \\end{pmatrix} $$\n\n**4. Assembly of the Global Stiffness Matrix**\n\nThe global stiffness matrix $\\mathbf{K}$ is an $8 \\times 8$ matrix corresponding to the DOFs $[u_{1x}, u_{1y}, u_{2x}, u_{2y}, u_{3x}, u_{3y}, u_{4x}, u_{4y}]^{\\mathsf{T}}$. The element matrices are assembled by superposition. The DOF indices for the nodes are: Node $1 \\to (1,2)$, Node $2 \\to (3,4)$, Node $3 \\to (5,6)$, Node $4 \\to (7,8)$. Node $3$ is not connected to any elements, so rows and columns $5$ and $6$ of $\\mathbf{K}$ will be zero.\nLet $\\alpha = \\frac{1}{2\\sqrt{2}}$. The assembled global stiffness matrix $\\mathbf{K}$ is:\n$$\n\\mathbf{K} = \\frac{AE}{L} \\begin{pmatrix}\n1+\\alpha & \\alpha & -1 & 0 & 0 & 0 & -\\alpha & -\\alpha \\\\\n\\alpha & \\alpha & 0 & 0 & 0 & 0 & -\\alpha & -\\alpha \\\\\n-1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 0 & 0 & -1 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n-\\alpha & -\\alpha & 0 & 0 & 0 & 0 & \\alpha & \\alpha \\\\\n-\\alpha & -\\alpha & 0 & -1 & 0 & 0 & \\alpha & 1+\\alpha\n\\end{pmatrix}\n$$\n\n**5. Trace of the Global Stiffness Matrix**\n\nThe trace of a matrix is the sum of its diagonal elements, $\\text{Tr}(\\mathbf{K}) = \\sum_{i=1}^{8} K_{ii}$.\nFrom the assembled matrix $\\mathbf{K}$:\n$$\n\\text{Tr}(\\mathbf{K}) = K_{11} + K_{22} + K_{33} + K_{44} + K_{55} + K_{66} + K_{77} + K_{88}\n$$\nThe diagonal elements are:\n$K_{11} = \\frac{AE}{L}(1+\\alpha) = \\frac{AE}{L}(1+\\frac{1}{2\\sqrt{2}})$\n$K_{22} = \\frac{AE}{L}(\\alpha) = \\frac{AE}{L}(\\frac{1}{2\\sqrt{2}})$\n$K_{33} = \\frac{AE}{L}(1)$\n$K_{44} = \\frac{AE}{L}(1)$\n$K_{55} = 0$\n$K_{66} = 0$\n$K_{77} = \\frac{AE}{L}(\\alpha) = \\frac{AE}{L}(\\frac{1}{2\\sqrt{2}})$\n$K_{88} = \\frac{AE}{L}(1+\\alpha) = \\frac{AE}{L}(1+\\frac{1}{2\\sqrt{2}})$\n\nSumming these values:\n$$\n\\text{Tr}(\\mathbf{K}) = \\frac{AE}{L} \\left[ \\left(1+\\frac{1}{2\\sqrt{2}}\\right) + \\frac{1}{2\\sqrt{2}} + 1 + 1 + 0 + 0 + \\frac{1}{2\\sqrt{2}} + \\left(1+\\frac{1}{2\\sqrt{2}}\\right) \\right]\n$$\n$$\n\\text{Tr}(\\mathbf{K}) = \\frac{AE}{L} \\left[ (1+1+1+1) + 4\\left(\\frac{1}{2\\sqrt{2}}\\right) \\right]\n$$\n$$\n\\text{Tr}(\\mathbf{K}) = \\frac{AE}{L} \\left[ 4 + \\frac{2}{\\sqrt{2}} \\right]\n$$\nSince $\\frac{2}{\\sqrt{2}} = \\sqrt{2}$, the expression simplifies to:\n$$\n\\text{Tr}(\\mathbf{K}) = \\frac{AE}{L} (4 + \\sqrt{2})\n$$\nThis result can be verified by noting that the trace of the global stiffness matrix is the sum of the traces of the element stiffness matrices, where $\\text{Tr}(\\mathbf{k}_e) = \\frac{2AE}{L_e}$.\n$\\text{Tr}(\\mathbf{K}) = \\frac{2AE}{L_e^{(1)}} + \\frac{2AE}{L_e^{(2)}} + \\frac{2AE}{L_e^{(3)}} = \\frac{2AE}{L} + \\frac{2AE}{L} + \\frac{2AE}{L\\sqrt{2}} = \\frac{AE}{L}(4 + \\frac{2}{\\sqrt{2}}) = \\frac{AE}{L}(4 + \\sqrt{2})$. The result is consistent.", "answer": "$$\n\\boxed{\\frac{AE}{L}(4 + \\sqrt{2})}\n$$", "id": "2608503"}, {"introduction": "Once the global stiffness matrix is assembled, we can proceed with a full structural analysis to determine the structure's response to external loads. This practice demonstrates the complete workflow: applying boundary conditions, solving the reduced system of linear equations for unknown nodal displacements, and subsequently calculating the reaction forces at the supports. This exercise culminates in verifying global static equilibrium, bridging the abstract numerical solution back to the foundational principles of mechanics [@problem_id:2608597].", "problem": "A planar pin-jointed truss is to be analyzed using the Finite Element Method (FEM) under the assumptions of linear elasticity, small displacements, and axial-force-only members. There are three nodes at coordinates $N_{1}:(0,0)\\,\\mathrm{m}$, $N_{2}:(2,0)\\,\\mathrm{m}$, and $N_{3}:(2,2)\\,\\mathrm{m}$. Three straight truss members connect node pairs $(1,2)$, $(2,3)$, and $(1,3)$. All members share the same Young’s modulus $E = 200\\,\\mathrm{GPa}$ and cross-sectional area $A = 5.0\\times 10^{-6}\\,\\mathrm{m}^{2}$. The support conditions are $u_{1x}=0$, $u_{1y}=0$, and $u_{2y}=0$; all other nodal displacement components are unknown. The external nodal loads are $F_{3x} = +10\\,\\mathrm{kN}$ and $F_{3y} = -20\\,\\mathrm{kN}$ applied at node $3$; all other applied nodal loads are zero.\n\nStarting from the strain energy of an axial bar and the principle of virtual work, construct each element’s stiffness in global Cartesian coordinates using direction cosines, assemble the global stiffness matrix, impose the essential boundary conditions, and solve for the unknown nodal displacements. Then, using the fully assembled global system, compute the reaction forces at the supports and verify global equilibrium by checking the sums of forces in $x$ and $y$ and the moment about node $1$.\n\nWhat is the vertical reaction at node $2$ expressed in $\\mathrm{kN}$? Round your answer to four significant figures and report a single real number in $\\mathrm{kN}$.", "solution": "The problem presented is a standard exercise in the Finite Element Method as applied to structural mechanics. First, the validity of the problem statement is established.\n\nThe givens are:\nNodes: $N_{1}:(0,0)\\,\\mathrm{m}$, $N_{2}:(2,0)\\,\\mathrm{m}$, and $N_{3}:(2,2)\\,\\mathrm{m}$.\nElements: $(1,2)$, $(2,3)$, $(1,3)$.\nProperties: Young’s modulus $E = 200\\,\\mathrm{GPa} = 2 \\times 10^{11}\\,\\mathrm{Pa}$, cross-sectional area $A = 5.0\\times 10^{-6}\\,\\mathrm{m}^{2}$.\nThis gives a constant axial rigidity of $EA = (2 \\times 10^{11}\\,\\mathrm{Pa}) \\cdot (5.0\\times 10^{-6}\\,\\mathrm{m}^{2}) = 10^{6}\\,\\mathrm{N}$.\nBoundary Conditions (Displacements): $u_{1x}=0$, $u_{1y}=0$, $u_{2y}=0$.\nExternal Loads: $F_{3x} = +10\\,\\mathrm{kN} = 10^{4}\\,\\mathrm{N}$, $F_{3y} = -20\\,\\mathrm{kN} = -2 \\times 10^{4}\\,\\mathrm{N}$.\n\nThe problem is scientifically grounded, well-posed, and objective. It provides a complete and consistent set of data for a linear elastic analysis. It does not violate any physical laws or mathematical principles. Therefore, the problem is valid, and we proceed with the solution.\n\nThe solution follows from the principle of virtual work, which equates the internal virtual work (change in strain energy, $\\delta U$) to the external virtual work ($\\delta W_{ext}$). For a discretized system, this leads to the matrix equation $\\mathbf{K}\\mathbf{u} = \\mathbf{F}$, where $\\mathbf{K}$ is the global stiffness matrix, $\\mathbf{u}$ is the vector of nodal displacements, and $\\mathbf{F}$ is the vector of nodal forces.\n\nThe element stiffness matrix $\\mathbf{k}^{(e)}$ in global coordinates is derived from the strain energy $U$ of a bar element. In local coordinates (along the bar's axis), the strain energy is $U = \\frac{1}{2} \\frac{E^{(e)}A^{(e)}}{L^{(e)}} (\\Delta L)^2$, where $\\Delta L$ is the axial elongation. Expressing this in terms of nodal displacements and transforming from local to global coordinates using direction cosines yields the standard $4 \\times 4$ element stiffness matrix for a 2D truss element connecting nodes $i$ and $j$:\n$$ \\mathbf{k}^{(e)} = \\frac{E^{(e)}A^{(e)}}{L^{(e)}} \\begin{pmatrix} c_x^2 & c_x c_y & -c_x^2 & -c_x c_y \\\\ c_x c_y & c_y^2 & -c_x c_y & -c_y^2 \\\\ -c_x^2 & -c_x c_y & c_x^2 & c_x c_y \\\\ -c_x c_y & -c_y^2 & c_x c_y & c_y^2 \\end{pmatrix} $$\nwhere $c_x = \\frac{x_j - x_i}{L^{(e)}}$ and $c_y = \\frac{y_j - y_i}{L^{(e)}}$ are the direction cosines and $L^{(e)}$ is the element length.\n\nWe compute the properties and stiffness matrices for each of the three elements.\n\nElement 1 (Nodes 1-2):\n$L^{(1)} = \\sqrt{(2-0)^2 + (0-0)^2} = 2\\,\\mathrm{m}$.\n$c_x = \\frac{2-0}{2} = 1$, $c_y = \\frac{0-0}{2} = 0$.\n$\\frac{EA}{L^{(1)}} = \\frac{10^{6}\\,\\mathrm{N}}{2\\,\\mathrm{m}} = 5 \\times 10^{5}\\,\\mathrm{N/m}$.\n$$ \\mathbf{k}^{(1)} = (5 \\times 10^{5}) \\begin{pmatrix} 1 & 0 & -1 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ -1 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\n\nElement 2 (Nodes 2-3):\n$L^{(2)} = \\sqrt{(2-2)^2 + (2-0)^2} = 2\\,\\mathrm{m}$.\n$c_x = \\frac{2-2}{2} = 0$, $c_y = \\frac{2-0}{2} = 1$.\n$\\frac{EA}{L^{(2)}} = \\frac{10^{6}\\,\\mathrm{N}}{2\\,\\mathrm{m}} = 5 \\times 10^{5}\\,\\mathrm{N/m}$.\n$$ \\mathbf{k}^{(2)} = (5 \\times 10^{5}) \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & -1 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & -1 & 0 & 1 \\end{pmatrix} $$\n\nElement 3 (Nodes 1-3):\n$L^{(3)} = \\sqrt{(2-0)^2 + (2-0)^2} = \\sqrt{8} = 2\\sqrt{2}\\,\\mathrm{m}$.\n$c_x = \\frac{2-0}{2\\sqrt{2}} = \\frac{1}{\\sqrt{2}}$, $c_y = \\frac{2-0}{2\\sqrt{2}} = \\frac{1}{\\sqrt{2}}$.\n$\\frac{EA}{L^{(3)}} = \\frac{10^{6}\\,\\mathrm{N}}{2\\sqrt{2}\\,\\mathrm{m}} = \\frac{5 \\times 10^{5}}{\\sqrt{2}}\\,\\mathrm{N/m}$.\nFor this element, $c_x^2=c_y^2=c_x c_y = 1/2$.\n$$ \\mathbf{k}^{(3)} = \\frac{5 \\times 10^{5}}{\\sqrt{2}} \\begin{pmatrix} 1/2 & 1/2 & -1/2 & -1/2 \\\\ 1/2 & 1/2 & -1/2 & -1/2 \\\\ -1/2 & -1/2 & 1/2 & 1/2 \\\\ -1/2 & -1/2 & 1/2 & 1/2 \\end{pmatrix} = \\frac{2.5 \\times 10^{5}}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 & -1 & -1 \\\\ 1 & 1 & -1 & -1 \\\\ -1 & -1 & 1 & 1 \\\\ -1 & -1 & 1 & 1 \\end{pmatrix} $$\n\nThe global degrees of freedom (DOF) are $(u_{1x}, u_{1y}, u_{2x}, u_{2y}, u_{3x}, u_{3y})$, numbered $1$ through $6$. We assemble the $6 \\times 6$ global stiffness matrix $\\mathbf{K}$ by summing the contributions from each element stiffness matrix. Let $C = 10^{5}\\,\\mathrm{N/m}$ and $\\beta = \\frac{2.5}{\\sqrt{2}}$.\n$$ \\mathbf{K} = C \\begin{pmatrix}\n5+\\beta & \\beta & -5 & 0 & -\\beta & -\\beta \\\\\n\\beta & \\beta & 0 & 0 & -\\beta & -\\beta \\\\\n-5 & 0 & 5 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 5 & 0 & -5 \\\\\n-\\beta & -\\beta & 0 & 0 & \\beta & \\beta \\\\\n-\\beta & -\\beta & 0 & -5 & \\beta & 5+\\beta\n\\end{pmatrix} $$\n\nThe global system is $\\mathbf{K}\\mathbf{u} = \\mathbf{F}$. The specified boundary conditions are $u_1=u_{1x}=0$, $u_2=u_{1y}=0$, and $u_4=u_{2y}=0$. The unknown displacements are $u_3=u_{2x}$, $u_5=u_{3x}$, and $u_6=u_{3y}$. The applied forces corresponding to these unknown displacements are $F_3=0$, $F_5=10^{4}\\,\\mathrm{N}$, and $F_6=-2 \\times 10^{4}\\,\\mathrm{N}$. We extract the sub-system of equations for the unknown DOFs (rows $3, 5, 6$):\n$$ \\begin{pmatrix} K_{33} & K_{35} & K_{36} \\\\ K_{53} & K_{55} & K_{56} \\\\ K_{63} & K_{65} & K_{66} \\end{pmatrix} \\begin{pmatrix} u_3 \\\\ u_5 \\\\ u_6 \\end{pmatrix} = \\begin{pmatrix} F_3 \\\\ F_5 \\\\ F_6 \\end{pmatrix} $$\nSubstituting the values from $\\mathbf{K}$:\n$$ C \\begin{pmatrix} 5 & 0 & 0 \\\\ 0 & \\beta & \\beta \\\\ 0 & \\beta & 5+\\beta \\end{pmatrix} \\begin{pmatrix} u_{2x} \\\\ u_{3x} \\\\ u_{3y} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 10^{4} \\\\ -2 \\times 10^{4} \\end{pmatrix} $$\n\nSolving this system of equations:\nFrom the first equation: $5C u_{2x} = 0 \\implies u_{2x} = 0\\,\\mathrm{m}$.\nThe second and third equations are:\n$C\\beta(u_{3x} + u_{3y}) = 10^{4}$\n$C(\\beta u_{3x} + (5+\\beta)u_{3y}) = -2 \\times 10^{4}$\nSubtracting the first of these two from the second yields:\n$C(5u_{3y}) = -3 \\times 10^{4} \\implies u_{3y} = \\frac{-3 \\times 10^{4}}{5C} = \\frac{-3 \\times 10^{4}}{5 \\times 10^{5}} = -0.06\\,\\mathrm{m}$.\nSubstituting $u_{3y}$ back: $C\\beta(u_{3x} - 0.06) = 10^4 \\implies u_{3x} = 0.06 + \\frac{10^4}{C\\beta} = 0.06 + \\frac{10^4}{10^5 \\cdot (2.5/\\sqrt{2})} = 0.06 + 0.04\\sqrt{2}\\,\\mathrm{m}$.\n\nThe problem requires the vertical reaction at node $2$, which is $R_{2y} = F_4$. The reaction forces are found from the rows of $\\mathbf{K}\\mathbf{u}$ corresponding to the constrained DOFs.\n$R_{2y} = K_{41}u_1 + K_{42}u_2 + K_{43}u_3 + K_{44}u_4 + K_{45}u_5 + K_{46}u_6$.\nWith $u_1=u_2=u_4=0$ and $u_3=0$, this simplifies to:\n$R_{2y} = K_{45}u_5 + K_{46}u_6 = K_{45}u_{3x} + K_{46}u_{3y}$.\nFrom the global matrix $\\mathbf{K}$, $K_{45}=0$ and $K_{46}=-5C = -5 \\times 10^{5}\\,\\mathrm{N/m}$.\nTherefore:\n$R_{2y} = (0)u_{3x} + (-5 \\times 10^{5}\\,\\mathrm{N/m})(u_{3y}) = (-5 \\times 10^{5})(-0.06) = 30000\\,\\mathrm{N} = 30\\,\\mathrm{kN}$.\n\nTo verify this result, we check global equilibrium. We compute the other reactions, $R_{1x}$ and $R_{1y}$.\n$R_{1x} = K_{15}u_{3x} + K_{16}u_{3y} = -\\beta C(u_{3x} + u_{3y}) = -\\beta C(0.06 + 0.04\\sqrt{2} - 0.06) = -\\beta C(0.04\\sqrt{2})$.\n$R_{1x} = -(\\frac{2.5 \\times 10^5}{\\sqrt{2}})(0.04\\sqrt{2}) = -(2.5 \\times 10^5)(0.04) = -10000\\,\\mathrm{N} = -10\\,\\mathrm{kN}$.\n$R_{1y} = K_{25}u_{3x} + K_{26}u_{3y} = -\\beta C(u_{3x} + u_{3y}) = -10\\,\\mathrm{kN}$.\n\nEquilibrium verification:\nSum of forces in x-direction: $\\sum F_x = R_{1x} + F_{3x} = -10\\,\\mathrm{kN} + 10\\,\\mathrm{kN} = 0$. This is correct.\nSum of forces in y-direction: $\\sum F_y = R_{1y} + R_{2y} + F_{3y} = -10\\,\\mathrm{kN} + 30\\,\\mathrm{kN} + (-20\\,\\mathrm{kN}) = 0$. This is correct.\nSum of moments about node $1$: $\\sum M_{N1} = (F_{3y} \\cdot x_3 - F_{3x} \\cdot y_3) + (R_{2y} \\cdot x_2) = ((-20\\,\\mathrm{kN})\\cdot(2\\,\\mathrm{m}) - (10\\,\\mathrm{kN})\\cdot(2\\,\\mathrm{m})) + ((30\\,\\mathrm{kN})\\cdot(2\\,\\mathrm{m})) = (-40 - 20) + 60 = 0\\,\\mathrm{kN \\cdot m}$. This is correct.\n\nThe calculations are consistent and verified by statics. The vertical reaction at node $2$ is $30\\,\\mathrm{kN}$. The problem asks for this value to be rounded to four significant figures.", "answer": "$$ \\boxed{30.00} $$", "id": "2608597"}, {"introduction": "In practical engineering, theoretical models are implemented in software where user input errors, particularly with units, can lead to catastrophic failures. This exercise explores the critical interface between theory and application by quantifying the dramatic effect of inconsistent units on a finite element calculation. By analyzing how errors in physical parameters propagate through the stiffness formulation, you will understand the importance of dimensional homogeneity and learn to formulate robust unit-checking procedures for reliable analysis [@problem_id:2608550].", "problem": "A two-node truss element in three-dimensional space connects node $1$ at coordinates $(0,0,0)$ to node $2$ at $(L,0,0)$ and carries an axial load $F$ applied at node $2$ along the element axis, with node $1$ fully fixed. The physical (true) properties are: Young’s modulus $E_{\\mathrm{true}}=210\\,\\mathrm{GPa}$, cross-sectional area $A_{\\mathrm{true}}=1250\\,\\mathrm{mm}^{2}$, and length $L_{\\mathrm{true}}=2.5\\,\\mathrm{m}$. All nodal forces are consistently entered in $\\mathrm{N}$.\n\nA finite element solver expects inputs in the International System of Units (SI): $E$ in $\\mathrm{Pa}$, $A$ in $\\mathrm{m}^{2}$, coordinates in $\\mathrm{m}$, and forces in $\\mathrm{N}$. A user, however, inadvertently supplies the following inconsistent inputs while the solver still interprets them as SI:\n- $E_{\\mathrm{in}}=210$ (thinking this means $210\\,\\mathrm{GPa}$, but the solver reads $210\\,\\mathrm{Pa}$),\n- $A_{\\mathrm{in}}=1250$ (thinking this means $1250\\,\\mathrm{mm}^{2}$, but the solver reads $1250\\,\\mathrm{m}^{2}$),\n- coordinates for node $2$ as $(2500,0,0)$ (thinking this means $2500\\,\\mathrm{mm}$, but the solver reads $2500\\,\\mathrm{m}$),\n- the axial force $F$ is correctly entered in $\\mathrm{N}$.\n\nStarting from first principles (strain energy, Hooke’s law, and the definition of axial strain), derive the axial stiffness of a truss element, justify its physical units, and use this to quantify the effect of the above unit inconsistencies on the computed axial displacement at node $2$. Define the multiplicative error factor $S_{u}$ by $u_{\\mathrm{wrong}}=S_{u}\\,u_{\\mathrm{true}}$, where $u_{\\mathrm{true}}$ is the physically correct displacement under consistent SI inputs and $u_{\\mathrm{wrong}}$ is the displacement produced by the inconsistent inputs listed above. Then, based on your derivation, articulate a principled unit-checking procedure that would have detected the inconsistency before running the analysis.\n\nWhat is the numerical value of $S_{u}$? Express your answer in scientific notation with three significant figures. Do not include units in your answer.", "solution": "The problem statement is subjected to validation before any attempt at a solution.\n\nStep 1: Extract Givens\nThe following data are provided:\n- Node 1 location: $(0,0,0)$.\n- Node 2 location (true): $(L,0,0)$.\n- Node 1 boundary condition: fully fixed.\n- Load: axial load $F$ applied at node $2$.\n- True Young’s modulus: $E_{\\mathrm{true}}=210\\,\\mathrm{GPa}$.\n- True cross-sectional area: $A_{\\mathrm{true}}=1250\\,\\mathrm{mm}^{2}$.\n- True length: $L_{\\mathrm{true}}=2.5\\,\\mathrm{m}$.\n- Inconsistent user input for Young's modulus: $E_{\\mathrm{in}}=210$. Solver interprets as $210\\,\\mathrm{Pa}$.\n- Inconsistent user input for area: $A_{\\mathrm{in}}=1250$. Solver interprets as $1250\\,\\mathrm{m}^{2}$.\n- Inconsistent user input for node 2 coordinates: $(2500,0,0)$. Solver interprets as $(2500\\,\\mathrm{m}, 0\\,\\mathrm{m}, 0\\,\\mathrm{m})$.\n- Axial force $F$ is correctly entered in $\\mathrm{N}$.\n- The error factor is defined as $S_{u} = \\frac{u_{\\mathrm{wrong}}}{u_{\\mathrm{true}}}$, where $u_{\\mathrm{true}}$ is the correct displacement and $u_{\\mathrm{wrong}}$ is the displacement computed with inconsistent inputs.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the principles of solid mechanics and the finite element method. It presents a realistic scenario where user error in unit handling leads to incorrect computational results. The problem is self-contained, with all necessary data provided to calculate the requested error factor. The definitions are clear, and there are no internal contradictions. The task is well-posed, leading to a unique solution for the error factor $S_u$. The problem is not trivial, as it requires a systematic analysis of how multiple simultaneous errors in a physical formula propagate into the final result.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be formulated.\n\nThe first task is to derive the axial stiffness of a truss element from first principles. The strain energy $U$ stored in a deformable body is given by the integral of the strain energy density over its volume $V$:\n$$U = \\int_V \\frac{1}{2} \\sigma \\epsilon \\, dV$$\nwhere $\\sigma$ is the stress and $\\epsilon$ is the strain. For a simple truss element of length $L$ and uniform cross-sectional area $A$ under a uniform axial load, the stress and strain are constant throughout the volume. Thus, the integral simplifies to:\n$$U = \\frac{1}{2} \\sigma \\epsilon (AL)$$\nAccording to Hooke's law for linear elastic materials, stress is proportional to strain: $\\sigma = E \\epsilon$, where $E$ is the Young's modulus. Substituting this into the energy expression gives:\n$$U = \\frac{1}{2} (E \\epsilon) \\epsilon (AL) = \\frac{1}{2} E A L \\epsilon^2$$\nThe axial strain $\\epsilon$ is defined as the change in length, which is the axial displacement $u$ of the free end, divided by the original length $L$: $\\epsilon = \\frac{u}{L}$. Substituting this into the strain energy expression yields:\n$$U = \\frac{1}{2} E A L \\left(\\frac{u}{L}\\right)^2 = \\frac{1}{2} \\frac{EA}{L} u^2$$\nThe work done by the external axial force $F$ that causes the displacement $u$ is $W = \\frac{1}{2}F u$. By the principle of conservation of energy, the work done on the system is stored as strain energy, so $W=U$:\n$$\\frac{1}{2} F u = \\frac{1}{2} \\frac{EA}{L} u^2$$\nFor a non-zero displacement $u$, we can divide by $\\frac{1}{2}u$ to obtain the force-displacement relationship:\n$$F = \\left(\\frac{EA}{L}\\right) u$$\nThis is of the form $F = k u$, where $k$ is the axial stiffness of the element. Therefore, the axial stiffness is:\n$$k = \\frac{EA}{L}$$\nThe physical units of stiffness are derived from this expression. In the International System of Units (SI), $[E] = \\mathrm{Pa} = \\mathrm{N}/\\mathrm{m}^2$, $[A] = \\mathrm{m}^2$, and $[L] = \\mathrm{m}$. Thus, the units of $k$ are:\n$$[k] = \\frac{[\\mathrm{N}/\\mathrm{m}^2][\\mathrm{m}^2]}{[\\mathrm{m}]} = \\frac{\\mathrm{N}}{\\mathrm{m}}$$\nThis represents force per unit displacement, which is physically correct.\n\nNext, we quantify the effect of the unit inconsistencies. The axial displacement $u$ is found by rearranging the stiffness relation: $u = \\frac{F}{k} = \\frac{FL}{EA}$.\n\nFirst, we calculate the physically correct displacement, $u_{\\mathrm{true}}$, using consistent SI units for all quantities.\nThe true properties are:\n$E_{\\mathrm{true}} = 210\\,\\mathrm{GPa} = 210 \\times 10^9\\,\\mathrm{Pa}$\n$A_{\\mathrm{true}} = 1250\\,\\mathrm{mm}^2 = 1250 \\times (10^{-3}\\,\\mathrm{m})^2 = 1250 \\times 10^{-6}\\,\\mathrm{m}^2 = 1.25 \\times 10^{-3}\\,\\mathrm{m}^2$\n$L_{\\mathrm{true}} = 2.5\\,\\mathrm{m}$\nThe correct displacement is:\n$$u_{\\mathrm{true}} = \\frac{F L_{\\mathrm{true}}}{E_{\\mathrm{true}} A_{\\mathrm{true}}}$$\n\nNext, we calculate the displacement computed by the solver, $u_{\\mathrm{wrong}}$, based on the user's erroneous inputs, which the solver interprets as being in base SI units.\nThe input properties as read by the solver are:\n$E_{\\mathrm{in}} = 210\\,\\mathrm{Pa}$\n$A_{\\mathrm{in}} = 1250\\,\\mathrm{m}^2$\nThe length $L_{\\mathrm{in}}$ is calculated from the input coordinates of node $1$ at $(0,0,0)$ and node $2$ at $(2500,0,0)$:\n$L_{\\mathrm{in}} = \\sqrt{(2500-0)^2 + (0-0)^2 + (0-0)^2} = 2500\\,\\mathrm{m}$\nThe incorrect displacement is:\n$$u_{\\mathrm{wrong}} = \\frac{F L_{\\mathrm{in}}}{E_{\\mathrm{in}} A_{\\mathrm{in}}}$$\n\nThe multiplicative error factor $S_u$ is the ratio of the wrong displacement to the true displacement:\n$$S_u = \\frac{u_{\\mathrm{wrong}}}{u_{\\mathrm{true}}} = \\frac{\\frac{F L_{\\mathrm{in}}}{E_{\\mathrm{in}} A_{\\mathrm{in}}}}{\\frac{F L_{\\mathrm{true}}}{E_{\\mathrm{true}} A_{\\mathrm{true}}}}$$\nThe force $F$ cancels, leaving:\n$$S_u = \\left(\\frac{L_{\\mathrm{in}}}{L_{\\mathrm{true}}}\\right) \\left(\\frac{E_{\\mathrm{true}}}{E_{\\mathrm{in}}}\\right) \\left(\\frac{A_{\\mathrm{true}}}{A_{\\mathrm{in}}}\\right)$$\nWe now substitute the numerical values for each ratio:\nThe ratio of lengths is:\n$$\\frac{L_{\\mathrm{in}}}{L_{\\mathrm{true}}} = \\frac{2500\\,\\mathrm{m}}{2.5\\,\\mathrm{m}} = 1000 = 10^3$$\nThe ratio of Young's moduli is:\n$$\\frac{E_{\\mathrm{true}}}{E_{\\mathrm{in}}} = \\frac{210 \\times 10^9\\,\\mathrm{Pa}}{210\\,\\mathrm{Pa}} = 10^9$$\nThe ratio of cross-sectional areas is:\n$$\\frac{A_{\\mathrm{true}}}{A_{\\mathrm{in}}} = \\frac{1.25 \\times 10^{-3}\\,\\mathrm{m}^2}{1250\\,\\mathrm{m}^2} = \\frac{1.25 \\times 10^{-3}}{1.25 \\times 10^3} = 10^{-6}$$\nMultiplying these factors gives the total error factor:\n$$S_u = (10^3) \\times (10^9) \\times (10^{-6}) = 10^{3+9-6} = 10^6$$\nIn scientific notation with three significant figures, this is $1.00 \\times 10^6$.\n\nFinally, a principled unit-checking procedure must be articulated. Such a procedure must prevent the solver from performing calculations with physically nonsensical data resulting from unit confusion. A robust system would be based on two main principles: explicit unit handling and automated plausibility checks.\n1.  **Explicit Unit Specification**: The fundamental flaw is the solver's assumption about the units of unit-less numerical inputs. A principled system must eliminate this ambiguity. The user interface must compel the user to explicitly associate a unit with every dimensional quantity entered. For instance, an input field for Young's modulus would consist of a numerical value field and an adjacent drop-down menu for selecting the unit (e.g., $\\mathrm{Pa}$, $\\mathrm{kPa}$, $\\mathrm{MPa}$, $\\mathrm{GPa}$).\n2.  **Internal Unit Consistency**: Upon receiving the user's input (e.g., $E = 210\\,\\mathrm{GPa}$), the software must immediately convert this value into its internal, consistent base unit system (e.g., SI). In this example, $210\\,\\mathrm{GPa}$ would be converted to and stored as $2.1 \\times 10^{11}\\,\\mathrm{Pa}$. All subsequent calculations are performed strictly within this consistent system.\n3.  **Plausibility Validation (Sanity Check)**: Before proceeding to the computationally expensive analysis, the solver should perform automated plausibility checks on the converted base-unit values. This involves comparing key input parameters against a database of typical value ranges for the specified context (e.g., material type, engineering application).\n    -   **Material Properties**: For a structural analysis using a material like steel, the Young's modulus is expected to be in the range of $190-215\\,\\mathrm{GPa}$. The user's input of $E_{\\mathrm{in}}=210$ (interpreted as $210\\,\\mathrm{Pa}$) would be flagged by the system as it falls dramatically outside this expected range. A warning should be issued, for example: \"Warning: Input Young's Modulus ($210\\,\\mathrm{Pa}$) is extremely low for a structural material. Did you mean $210\\,\\mathrm{GPa}$?\"\n    -   **Geometric Properties**: The dimensions of the model should also be checked. An element length of $2500\\,\\mathrm{m}$ and a cross-sectional area of $1250\\,\\mathrm{m}^2$ are characteristic of a megastructure, not a typical mechanical component. The system should flag such extreme dimensions and prompt the user to verify their units, e.g., \"Warning: Model dimensions are unusually large. Please confirm that input units are meters.\"\n\nThis combination of enforced explicit unit entry, automated internal conversion, and subsequent plausibility checks constitutes a principled and robust procedure for preventing the class of error described in this problem.", "answer": "$$\\boxed{1.00 \\times 10^{6}}$$", "id": "2608550"}]}