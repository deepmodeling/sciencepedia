{"hands_on_practices": [{"introduction": "The engine of any gradient-based optimization algorithm is the ability to efficiently compute the sensitivity of the objective function with respect to the design variables. This foundational exercise guides you through the calculation of these sensitivities for a thermal compliance problem using the powerful adjoint method. Mastering this technique [@problem_id:2604234] is crucial for understanding how large-scale topology optimization problems are solved in practice.", "problem": "A one-dimensional steady-state heat conduction problem is posed on a bar of length $L$ and uniform cross-sectional area $A$, discretized by the Finite Element Method (FEM) using two linear elements (nodes $1$–$3$). The thermal conductivity in element $e$ is interpolated by the Solid Isotropic Material with Penalization (SIMP) model,\n$$\nk(\\rho_e) \\;=\\; k_{\\min} \\;+\\; \\rho_e^{\\,p}\\,\\big(k_0 - k_{\\min}\\big),\n$$\nwhere $\\rho_e \\in [0,1]$ is the element density, $k_0$ is the conductivity of solid material, $k_{\\min}$ is the small conductivity assigned to void-like material, and $p$ is the penalization exponent. The governing strong form is $-\\frac{d}{dx}\\!\\left(k(\\rho)\\,\\frac{dT}{dx}\\right)=0$ with boundary conditions $T(0)=0$ on the left end and a prescribed outward normal heat flux $\\bar{q}$ on the right end. The Galerkin weak form is\n$$\n\\int_{0}^{L} k(\\rho)\\,\\frac{dT}{dx}\\,\\frac{dv}{dx}\\,dx \\;=\\; \\int_{\\Gamma_N} \\bar{q}\\,v\\,d\\Gamma,\n$$\nleading after discretization to the global system\n$$\n\\mathbf{K}(\\boldsymbol{\\rho})\\,\\mathbf{T}\\;=\\;\\mathbf{Q},\n$$\nwhere $\\mathbf{K}$ is the symmetric positive definite conductivity matrix for the free degrees of freedom, $\\mathbf{T}$ is the vector of nodal temperatures, and $\\mathbf{Q}$ is the nodal heat load vector.\n\nConsider the specific data:\n- $L = 2$, $A=1$,\n- $k_0 = 2$, $k_{\\min}=0.2$, $p=3$,\n- element densities $\\rho_1=0.5$, $\\rho_2=1$,\n- boundary conditions $T(0)=0$ at the left end and a uniform outward heat flux $\\bar{q}=1$ applied at the right end, so that the equivalent nodal load at the rightmost node is $Q_3 = \\bar{q}\\,A = 1$ while other nodal loads vanish.\n\nLet the thermal compliance be defined by\n$$\n\\mathcal{C}(\\mathbf{T},\\boldsymbol{\\rho}) \\;=\\; \\mathbf{Q}^{\\mathsf{T}}\\,\\mathbf{T},\n$$\nwith $\\mathbf{Q}$ independent of $\\boldsymbol{\\rho}$. Using the thermal adjoint method, compute the sensitivity $\\frac{d\\mathcal{C}}{d\\rho_1}$ at the given design point. You must explicitly form the adjoint problem from first principles and then evaluate the resulting sensitivity expression. Express the final sensitivity in $\\mathrm{W\\cdot K}$, and round your answer to four significant figures.", "solution": "The problem requires the computation of the sensitivity of the thermal compliance with respect to an element design variable, $\\frac{d\\mathcal{C}}{d\\rho_1}$, using the adjoint method. The structure of the solution is as follows: first, we establish the finite element model of the system; second, we solve the primal heat conduction problem to find the nodal temperatures; third, we formulate and solve the adjoint problem; and finally, we compute the required sensitivity.\n\n**1. Finite Element Discretization**\n\nThe domain, a bar of length $L=2$, is discretized into two linear finite elements of equal length.\n- Element 1 connects node 1 ($x=0$) and node 2 ($x=1$). Its length is $l_1=1$ and its density is $\\rho_1=0.5$.\n- Element 2 connects node 2 ($x=1$) and node 3 ($x=2$). Its length is $l_2=1$ and its density is $\\rho_2=1.0$.\n\nThe element thermal conductivity, $k_e$, is given by the Solid Isotropic Material with Penalization (SIMP) model:\n$$k(\\rho_e) = k_{\\min} + \\rho_e^p (k_0 - k_{\\min})$$\nUsing the provided data $k_0 = 2$, $k_{\\min} = 0.2$, and $p = 3$:\nFor element 1 ($\\rho_1=0.5$):\n$$k_1 = 0.2 + (0.5)^3 (2 - 0.2) = 0.2 + 0.125 \\times 1.8 = 0.2 + 0.225 = 0.425$$\nFor element 2 ($\\rho_2=1.0$):\n$$k_2 = 0.2 + (1.0)^3 (2 - 0.2) = 0.2 + 1.8 = 2.0$$\n\nThe element conductivity matrix for a 1D linear element is given by:\n$$\\mathbf{k}^e = \\frac{k_e A_e}{l_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\nGiven $A=1$ and $l_1=l_2=1$, the element matrices are:\n$$\\mathbf{k}^1 = k_1 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = 0.425 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n$$\\mathbf{k}^2 = k_2 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = 2.0 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n\nAssembling these into a global $3 \\times 3$ conductivity matrix for nodes 1, 2, and 3:\n$$\\mathbf{K}_{global} = \\begin{pmatrix} k_1 & -k_1 & 0 \\\\ -k_1 & k_1+k_2 & -k_2 \\\\ 0 & -k_2 & k_2 \\end{pmatrix} = \\begin{pmatrix} 0.425 & -0.425 & 0 \\\\ -0.425 & 2.425 & -2.0 \\\\ 0 & -2.0 & 2.0 \\end{pmatrix}$$\n\nThe boundary condition $T(0)=0$ implies $T_1=0$. We partition the system for the free degrees of freedom, which are the temperatures at node 2 and node 3, $T_2$ and $T_3$. The reduced conductivity matrix $\\mathbf{K}$ and temperature vector $\\mathbf{T}$ are:\n$$\\mathbf{K} = \\begin{pmatrix} k_1+k_2 & -k_2 \\\\ -k_2 & k_2 \\end{pmatrix} = \\begin{pmatrix} 2.425 & -2.0 \\\\ -2.0 & 2.0 \\end{pmatrix}$$\n$$\\mathbf{T} = \\begin{pmatrix} T_2 \\\\ T_3 \\end{pmatrix}$$\nThe external heat load is an outward flux $\\bar{q}=1$ at the right end ($x=L=2$), corresponding to node 3. The equivalent nodal load is $Q_3 = \\bar{q} A = 1 \\times 1 = 1$. There is no heat source at node 2, so $Q_2=0$. The load vector for the free DOFs is:\n$$\\mathbf{Q} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n\n**2. Primal Analysis: Solution of the State Equation**\n\nThe governing system of equations for the unknown temperatures is $\\mathbf{K}\\mathbf{T} = \\mathbf{Q}$:\n$$\\begin{pmatrix} 2.425 & -2.0 \\\\ -2.0 & 2.0 \\end{pmatrix} \\begin{pmatrix} T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\nFrom the second equation:\n$$-2.0 T_2 + 2.0 T_3 = 1 \\implies T_3 = T_2 + 0.5$$\nSubstituting this into the first equation:\n$$2.425 T_2 - 2.0 (T_2 + 0.5) = 0 \\implies 2.425 T_2 - 2.0 T_2 - 1.0 = 0$$\n$$0.425 T_2 = 1.0 \\implies T_2 = \\frac{1}{0.425} = \\frac{1}{17/40} = \\frac{40}{17}$$\nNow we find $T_3$:\n$$T_3 = \\frac{40}{17} + 0.5 = \\frac{40}{17} + \\frac{1}{2} = \\frac{80+17}{34} = \\frac{97}{34}$$\nThe temperature vector is $\\mathbf{T} = \\begin{pmatrix} 40/17 \\\\ 97/34 \\end{pmatrix}$.\n\n**3. Adjoint Sensitivity Analysis**\n\nThe objective function to be minimized is the thermal compliance, $\\mathcal{C} = \\mathbf{Q}^{\\mathsf{T}}\\mathbf{T}$. We seek its derivative with respect to the design variable $\\rho_1$. Following the mandate to derive the adjoint problem from first principles, we define an augmented objective functional $\\hat{\\mathcal{C}}$ using a vector of Lagrange multipliers $\\boldsymbol{\\lambda}$ (the adjoint variables) to enforce the state equation $\\mathbf{K}\\mathbf{T} = \\mathbf{Q}$:\n$$\\hat{\\mathcal{C}}(\\mathbf{T}, \\boldsymbol{\\rho}, \\boldsymbol{\\lambda}) = \\mathcal{C}(\\mathbf{T}) + \\boldsymbol{\\lambda}^{\\mathsf{T}} (\\mathbf{Q} - \\mathbf{K}(\\boldsymbol{\\rho})\\mathbf{T})$$\nThe total derivative of $\\mathcal{C}$ with respect to $\\rho_1$ is equal to the total derivative of $\\hat{\\mathcal{C}}$ since the constraint term is zero.\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = \\frac{d\\hat{\\mathcal{C}}}{d\\rho_1} = \\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\rho_1} + \\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\mathbf{T}} \\frac{d\\mathbf{T}}{d\\rho_1}$$\nWe choose $\\boldsymbol{\\lambda}$ such that the term containing the unknown sensitivity of the state variables, $\\frac{d\\mathbf{T}}{d\\rho_1}$, vanishes. We set its coefficient to zero:\n$$\\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\mathbf{T}} = \\frac{\\partial}{\\partial\\mathbf{T}} (\\mathbf{Q}^{\\mathsf{T}}\\mathbf{T} + \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{Q} - \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{K}\\mathbf{T}) = \\mathbf{Q}^{\\mathsf{T}} - \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{K} = \\mathbf{0}$$\nThis yields the adjoint equation:\n$$\\mathbf{K}^{\\mathsf{T}}\\boldsymbol{\\lambda} = \\mathbf{Q}$$\nSince the conductivity matrix $\\mathbf{K}$ is symmetric ($\\mathbf{K}^{\\mathsf{T}}=\\mathbf{K}$), the adjoint equation is $\\mathbf{K}\\boldsymbol{\\lambda} = \\mathbf{Q}$. This equation is identical in form to the primal state equation $\\mathbf{K}\\mathbf{T} = \\mathbf{Q}$. Therefore, the problem is self-adjoint, and the solution to the adjoint problem is the same as the solution to the primal problem:\n$$\\boldsymbol{\\lambda} = \\mathbf{T} = \\begin{pmatrix} 40/17 \\\\ 97/34 \\end{pmatrix}$$\nWith this choice of $\\boldsymbol{\\lambda}$, the sensitivity calculation simplifies to the partial derivative of $\\hat{\\mathcal{C}}$ with respect to $\\rho_1$:\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = \\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\rho_1} = \\frac{\\partial}{\\partial\\rho_1} (\\mathbf{Q}^{\\mathsf{T}}\\mathbf{T} + \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{Q} - \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{K}\\mathbf{T}) = -\\boldsymbol{\\lambda}^{\\mathsf{T}} \\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} \\mathbf{T}$$\n\n**4. Calculation of the Sensitivity**\n\nWe must find the derivative of the conductivity matrix $\\mathbf{K}$ with respect to $\\rho_1$:\n$$\\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} = \\frac{\\partial}{\\partial\\rho_1} \\begin{pmatrix} k_1+k_2 & -k_2 \\\\ -k_2 & k_2 \\end{pmatrix}$$\nOnly $k_1$ is a function of $\\rho_1$. Thus:\n$$\\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} = \\begin{pmatrix} \\frac{dk_1}{d\\rho_1} & 0 \\\\ 0 & 0 \\end{pmatrix}$$\nThe derivative $\\frac{dk_1}{d\\rho_1}$ is found from the SIMP law:\n$$\\frac{dk_1}{d\\rho_1} = \\frac{d}{d\\rho_1} \\left(k_{\\min} + \\rho_1^p(k_0 - k_{\\min})\\right) = p \\rho_1^{p-1} (k_0 - k_{\\min})$$\nSubstituting the given values $p=3$, $\\rho_1=0.5$, $k_0=2$, and $k_{\\min}=0.2$:\n$$\\frac{dk_1}{d\\rho_1} = 3 \\times (0.5)^{3-1} \\times (2 - 0.2) = 3 \\times (0.5)^2 \\times 1.8 = 3 \\times 0.25 \\times 1.8 = 0.75 \\times 1.8 = 1.35$$\nSo, the derivative of the stiffness matrix is:\n$$\\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} = \\begin{pmatrix} 1.35 & 0 \\\\ 0 & 0 \\end{pmatrix}$$\nNow we substitute all parts into the sensitivity expression. Since $\\boldsymbol{\\lambda} = \\mathbf{T}$:\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = -\\mathbf{T}^{\\mathsf{T}} \\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} \\mathbf{T} = - \\begin{pmatrix} T_2 & T_3 \\end{pmatrix} \\begin{pmatrix} 1.35 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} T_2 \\\\ T_3 \\end{pmatrix}$$\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = -1.35 \\times T_2^2$$\nSubstituting the value of $T_2 = \\frac{40}{17}$:\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = -1.35 \\times \\left(\\frac{40}{17}\\right)^2 = -1.35 \\times \\frac{1600}{289} \\approx -7.47404844...$$\nThe problem requests the result rounded to four significant figures.\n$$\\frac{d\\mathcal{C}}{d\\rho_1} \\approx -7.474$$\nThe units of compliance $\\mathcal{C}$ are units of heat load (Power, W) times temperature (K), so W·K. The design variable $\\rho_1$ is dimensionless. Therefore, the sensitivity $\\frac{d\\mathcal{C}}{d\\rho_1}$ has units of W·K, as requested.", "answer": "$$\\boxed{-7.474}$$", "id": "2604234"}, {"introduction": "With sensitivities in hand, the next step is to update the design to improve performance. This practical exercise [@problem_id:2604194] simulates a single iterative step of the classic Optimality Criteria (OC) method. You will tackle the core task of finding the correct Lagrange multiplier $\\lambda$ that enforces the material volume constraint, providing direct insight into the numerical machinery that drives automated structural design.", "problem": "In minimum-compliance topology optimization under the Solid Isotropic Material with Penalization (SIMP) model, the design variables are the element densities $\\rho_i \\in [\\rho_{\\min}, 1]$, and the compliance $C(\\boldsymbol{\\rho})$ is minimized subject to a global volume constraint. Consider one Optimality Criteria (OC) update with move limits for a design consisting of $4$ finite elements of unit volume. The current design is $\\rho_1^{k} = 0.5$, $\\rho_2^{k} = 0.7$, $\\rho_3^{k} = 0.3$, $\\rho_4^{k} = 0.9$. The filtered compliance sensitivities evaluated at $\\boldsymbol{\\rho}^{k}$ are $\\frac{\\partial C}{\\partial \\rho_1} = -1.6$, $\\frac{\\partial C}{\\partial \\rho_2} = -0.2$, $\\frac{\\partial C}{\\partial \\rho_3} = -1.0$, $\\frac{\\partial C}{\\partial \\rho_4} = -0.05$. The move limit is $m = 0.1$, the lower bound is $\\rho_{\\min} = 0.001$, and the OC damping exponent is $\\eta = \\frac{1}{2}$. The target allowable volume is $V^{\\star} = 2.35$ (dimensionless), with each element having unit volume.\n\nStarting from the Karush–Kuhn–Tucker (KKT) optimality conditions for the volume-constrained minimum-compliance problem and the definition of the standard Optimality Criteria (OC) step with damping exponent $\\eta = \\frac{1}{2}$, first derive the one-parameter monotone map $\\rho_i^{\\text{new}}(\\lambda)$ produced by the OC update with the given move limits and bound constraints. Then, using that monotonicity, compute the Lagrange multiplier $\\lambda$ by a bisection search so that the updated design satisfies the equality constraint $\\sum_{i=1}^{4} \\rho_i^{\\text{new}}(\\lambda) = V^{\\star}$. Express the final $\\lambda$ as a dimensionless number. The final answer must be a single real number.", "solution": "The Optimality Criteria (OC) update rule is derived from the Karush–Kuhn–Tucker (KKT) conditions for the volume-constrained compliance minimization problem. The heuristic update for the density of element $i$ at iteration $k+1$ is given by:\n$$\n\\rho_i^{k+1} = \\rho_i^k (B_i)^{\\eta}\n$$\nwhere $B_i$ is the ratio of the element's sensitivity to a global Lagrange multiplier $\\lambda$, and $\\eta$ is a damping exponent. The quantity $B_i$ is defined as:\n$$\nB_i = \\frac{-\\frac{1}{V_i}\\frac{\\partial C}{\\partial \\rho_i}}{\\lambda}\n$$\nGiven that each element has unit volume, $V_i=1$, and the sensitivities $\\frac{\\partial C}{\\partial \\rho_i}$ are provided, we define the sensitivity numbers $S_i = -\\frac{\\partial C}{\\partial \\rho_i}$. With the damping exponent $\\eta = \\frac{1}{2}$, the raw OC update becomes:\n$$\n\\tilde{\\rho}_i^{k+1}(\\lambda) = \\rho_i^k \\sqrt{\\frac{S_i}{\\lambda}}\n$$\nThis update must be constrained by the lower bound $\\rho_{\\min}$, upper bound $1$, and the move limit $m$. The allowable interval for each density $\\rho_i^{k+1}$ is $[\\rho_i^{\\text{lower}}, \\rho_i^{\\text{upper}}]$, where:\n$$\n\\rho_i^{\\text{lower}} = \\max(\\rho_{\\min}, \\rho_i^k - m)\n$$\n$$\n\\rho_i^{\\text{upper}} = \\min(1, \\rho_i^k + m)\n$$\nThe problem specifies $\\rho_{\\min} = 0.001$ and $m=0.1$. We calculate these bounds for each element:\n- For element $1$: $\\rho_1^k = 0.5$. $\\rho_1^{\\text{lower}} = \\max(0.001, 0.5 - 0.1) = 0.4$. $\\rho_1^{\\text{upper}} = \\min(1, 0.5 + 0.1) = 0.6$.\n- For element $2$: $\\rho_2^k = 0.7$. $\\rho_2^{\\text{lower}} = \\max(0.001, 0.7 - 0.1) = 0.6$. $\\rho_2^{\\text{upper}} = \\min(1, 0.7 + 0.1) = 0.8$.\n- For element $3$: $\\rho_3^k = 0.3$. $\\rho_3^{\\text{lower}} = \\max(0.001, 0.3 - 0.1) = 0.2$. $\\rho_3^{\\text{upper}} = \\min(1, 0.3 + 0.1) = 0.4$.\n- For element $4$: $\\rho_4^k = 0.9$. $\\rho_4^{\\text{lower}} = \\max(0.001, 0.9 - 0.1) = 0.8$. $\\rho_4^{\\text{upper}} = \\min(1, 0.9 + 0.1) = 1.0$.\n\nThe updated density, which we denote $\\rho_i^{\\text{new}}(\\lambda)$, is the projection of the raw update onto its allowable interval:\n$$\n\\rho_i^{\\text{new}}(\\lambda) = \\max \\left( \\rho_i^{\\text{lower}}, \\min \\left( \\tilde{\\rho}_i^{k+1}(\\lambda), \\rho_i^{\\text{upper}} \\right) \\right)\n$$\nThis defines the one-parameter map $\\boldsymbol{\\rho}^{\\text{new}}(\\lambda)$. Since $\\tilde{\\rho}_i^{k+1}(\\lambda)$ is a strictly decreasing function of $\\lambda$ (for $\\lambda > 0$), and projection onto an interval preserves monotonicity, each $\\rho_i^{\\text{new}}(\\lambda)$ is a non-increasing function of $\\lambda$. Consequently, the total volume $V(\\lambda) = \\sum_{i=1}^4 \\rho_i^{\\text{new}}(\\lambda)$ is also a non-increasing function of $\\lambda$. This monotonicity allows us to find a unique $\\lambda$ that satisfies the volume constraint.\n\nWe must find $\\lambda$ such that $\\sum_{i=1}^4 \\rho_i^{\\text{new}}(\\lambda) = V^{\\star} = 2.35$.\nLet us define $K_i = \\rho_i^k \\sqrt{S_i}$ where $S_i = -\\frac{\\partial C}{\\partial \\rho_i}$.\n- $S_1 = 1.6$, $K_1 = 0.5 \\sqrt{1.6} = \\sqrt{0.25 \\times 1.6} = \\sqrt{0.4}$.\n- $S_2 = 0.2$, $K_2 = 0.7 \\sqrt{0.2} = \\sqrt{0.49 \\times 0.2} = \\sqrt{0.098}$.\n- $S_3 = 1.0$, $K_3 = 0.3 \\sqrt{1.0} = 0.3 = \\sqrt{0.09}$.\n- $S_4 = 0.05$, $K_4 = 0.9 \\sqrt{0.05} = \\sqrt{0.81 \\times 0.05} = \\sqrt{0.0405}$.\n\nAn element $i$ is 'active' (not at its bounds) when $\\rho_i^{\\text{lower}} < \\frac{K_i}{\\sqrt{\\lambda}} < \\rho_i^{\\text{upper}}$. This is equivalent to $\\lambda$ being in the interval $(\\lambda_{i,U}, \\lambda_{i,L})$, where:\n$$\n\\lambda_{i,U} = \\left(\\frac{K_i}{\\rho_i^{\\text{upper}}}\\right)^2 \\quad \\text{and} \\quad \\lambda_{i,L} = \\left(\\frac{K_i}{\\rho_i^{\\text{lower}}}\\right)^2\n$$\n- Element $1$: $\\lambda_{1,U} = \\frac{0.4}{(0.6)^2} = \\frac{0.4}{0.36} = \\frac{10}{9}$. $\\lambda_{1,L} = \\frac{0.4}{(0.4)^2} = \\frac{0.4}{0.16} = 2.5$. Active for $\\lambda \\in (10/9, 2.5)$.\n- Element $2$: $\\lambda_{2,U} = \\frac{0.098}{(0.8)^2} = \\frac{0.098}{0.64} = \\frac{49}{320} \\approx 0.1531$. $\\lambda_{2,L} = \\frac{0.098}{(0.6)^2} = \\frac{0.098}{0.36} = \\frac{49}{180} \\approx 0.2722$. Active for $\\lambda \\in (49/320, 49/180)$.\n- Element $3$: $\\lambda_{3,U} = \\frac{0.09}{(0.4)^2} = \\frac{0.09}{0.16} = \\frac{9}{16} = 0.5625$. $\\lambda_{3,L} = \\frac{0.09}{(0.2)^2} = \\frac{0.09}{0.04} = \\frac{9}{4} = 2.25$. Active for $\\lambda \\in (9/16, 9/4)$.\n- Element $4$: $\\lambda_{4,U} = \\frac{0.0405}{(1.0)^2} = 0.0405$. $\\lambda_{4,L} = \\frac{0.0405}{(0.8)^2} = \\frac{0.0405}{0.64} = \\frac{81}{1280} \\approx 0.0633$. Active for $\\lambda \\in (0.0405, 81/1280)$.\n\nWe seek a root for $V(\\lambda) - 2.35 = 0$. By evaluating $V(\\lambda)$ at the critical $\\lambda$ points, we can determine the state of each element and find the interval containing the solution. Let's analyze the total volume function $V(\\lambda) = \\sum \\rho_i^{\\text{new}}(\\lambda)$.\n- For $\\lambda \\le \\lambda_{3,U} = 9/16 = 0.5625$: $\\rho_3$ is at its upper bound, $\\rho_3^{\\text{new}}=0.4$. Also, for $\\lambda \\in (49/180, 9/16)$, $\\rho_2$ is at its lower bound, $\\rho_2^{\\text{new}}=0.6$. In this range, $V(\\lambda) = 0.6 + 0.6 + 0.4 + 0.8 = 2.4$. The volume is constant here.\nSince $V(\\lambda)=2.4 > V^{\\star}=2.35$ for $\\lambda \\le 0.5625$, the solution must occur at $\\lambda > 0.5625$.\n\nConsider the interval $\\lambda \\in (9/16, 9/4) = (0.5625, 2.25)$.\n- For element $1$: $\\lambda < 10/9 \\approx 1.111$, so $\\rho_1^{\\text{new}} = \\rho_1^{\\text{upper}} = 0.6$.\n- For element $2$: $\\lambda > 49/180 \\approx 0.2722$, so $\\rho_2^{\\text{new}} = \\rho_2^{\\text{lower}} = 0.6$.\n- For element $3$: $\\lambda$ is in its active range, so $\\rho_3^{\\text{new}} = \\frac{K_3}{\\sqrt{\\lambda}} = \\frac{0.3}{\\sqrt{\\lambda}}$.\n- For element $4$: $\\lambda > 81/1280 \\approx 0.0633$, so $\\rho_4^{\\text{new}} = \\rho_4^{\\text{lower}} = 0.8$.\n\nThe total volume in this interval is:\n$$\nV(\\lambda) = 0.6 + 0.6 + \\frac{0.3}{\\sqrt{\\lambda}} + 0.8 = 2.0 + \\frac{0.3}{\\sqrt{\\lambda}}\n$$\nWe set this equal to the target volume $V^{\\star}$:\n$$\n2.0 + \\frac{0.3}{\\sqrt{\\lambda}} = 2.35\n$$\n$$\n\\frac{0.3}{\\sqrt{\\lambda}} = 0.35\n$$\n$$\n\\sqrt{\\lambda} = \\frac{0.3}{0.35} = \\frac{30}{35} = \\frac{6}{7}\n$$\n$$\n\\lambda = \\left(\\frac{6}{7}\\right)^2 = \\frac{36}{49}\n$$\nWe must verify that this value of $\\lambda$ lies within the assumed active interval for element $3$.\n$\\lambda = 36/49 \\approx 0.7347$. The interval is $(9/16, 9/4) = (0.5625, 2.25)$.\nSince $0.5625 < 0.7347 < 2.25$, our assumption was consistent. The calculated Lagrange multiplier is correct.\n\nAt $\\lambda = 36/49$, the new densities are:\n$\\rho_1^{\\text{new}} = 0.6$ (at upper move limit)\n$\\rho_2^{\\text{new}} = 0.6$ (at lower move limit)\n$\\rho_3^{\\text{new}} = \\frac{0.3}{\\sqrt{36/49}} = \\frac{0.3}{6/7} = 0.3 \\times \\frac{7}{6} = 0.35$ (active)\n$\\rho_4^{\\text{new}} = 0.8$ (at lower move limit)\nThe total volume is $\\sum \\rho_i^{\\text{new}} = 0.6 + 0.6 + 0.35 + 0.8 = 2.35$, which correctly matches $V^{\\star}$.", "answer": "$$\\boxed{\\frac{36}{49}}$$", "id": "2604194"}, {"introduction": "Beyond simply resizing material, topology optimization's great power lies in its ability to create new holes. This exercise delves into the topological derivative, a powerful mathematical concept that quantifies the effect of nucleating an infinitesimal void at any point in the structure. By connecting this derivative to the local strain energy density $W(\\mathbf{x})$, you will uncover the fundamental principle that guides algorithms in deciding *where* to remove material, leading to the emergence of efficient and often surprising structural forms [@problem_id:2604256].", "problem": "Consider a linear elastic body occupying a bounded domain $\\Omega \\subset \\mathbb{R}^d$ with $d \\in \\{2,3\\}$, subject to prescribed displacements on $\\Gamma_D$ and prescribed tractions $\\mathbf{t}$ on $\\Gamma_N$, with $\\partial \\Omega = \\Gamma_D \\cup \\Gamma_N$, $\\Gamma_D \\cap \\Gamma_N = \\emptyset$. Let $\\mathbf{u}$ denote the displacement field satisfying equilibrium, small strain kinematics, and linear elastic constitutive behavior with a positive-definite fourth-order elasticity tensor $\\mathbf{C}$. The compliance objective is defined by $J(\\Omega) = \\int_{\\Gamma_N} \\mathbf{t} \\cdot \\mathbf{u} \\, \\mathrm{d}\\Gamma$. The strain energy density is $W(\\mathbf{x}) = \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}(\\mathbf{u}):\\mathbf{C}:\\boldsymbol{\\varepsilon}(\\mathbf{u})$, where $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\big(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^\\top\\big)$. Assume that the displacement field $\\mathbf{u}$ is computed by a conforming displacement-based Finite Element Method (FEM) discretization and that $W(\\mathbf{x})$ is well-defined and bounded in $\\Omega$.\n\nFor a point $\\mathbf{x}_0 \\in \\Omega$, define the topological derivative of the compliance with respect to the nucleation of an infinitesimal spherical (in $d=3$) or circular (in $d=2$) cavity as\n$$\nD_T J(\\mathbf{x}_0) \\;=\\; \\lim_{\\varepsilon \\to 0^+} \\frac{J\\!\\left(\\Omega \\setminus B_\\varepsilon(\\mathbf{x}_0)\\right) - J(\\Omega)}{|B_\\varepsilon(\\mathbf{x}_0)|},\n$$\nwhere $B_\\varepsilon(\\mathbf{x}_0)$ is a ball of radius $\\varepsilon$ centered at $\\mathbf{x}_0$ and $|B_\\varepsilon(\\mathbf{x}_0)|$ is its volume (area in $d=2$). Model material removal by replacing the solid in $B_\\varepsilon(\\mathbf{x}_0)$ with a phase whose elastic tensor is $\\eta\\,\\mathbf{C}$ with $\\eta \\to 0^+$ (void limit), while keeping all external loads and boundary conditions fixed.\n\nBased on first principles of linear elasticity and energy arguments, evaluate the sign and relative magnitude of $D_T J(\\mathbf{x}_0)$ at points where $W(\\mathbf{x}_0)$ is high versus where $W(\\mathbf{x}_0)$ is low, and interpret the implication for material removal decisions when minimizing compliance under a volume constraint.\n\nWhich statement is most accurate?\n\nA. For compliance minimization with void nucleation, $D_T J(\\mathbf{x}_0)$ is negative at points of high $W(\\mathbf{x}_0)$, indicating that removing material there reduces compliance; moreover, the magnitude of $D_T J(\\mathbf{x}_0)$ decreases as $W(\\mathbf{x}_0)$ increases.\n\nB. For compliance minimization with void nucleation, $D_T J(\\mathbf{x}_0)$ is positive and larger at points of high $W(\\mathbf{x}_0)$; removing material there increases compliance the most, so optimal designs avoid removal in high $W$ regions and favor removal where $W(\\mathbf{x}_0)$ is small.\n\nC. For compliance minimization with void nucleation, $D_T J(\\mathbf{x}_0)$ vanishes wherever $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u})=\\mathbf{0}$ holds, hence it does not correlate with $W(\\mathbf{x}_0)$.\n\nD. For compliance minimization with void nucleation, the sign of $D_T J(\\mathbf{x}_0)$ is indefinite and determined solely by the Poisson ratio, independent of the local mechanical state, so it cannot guide material removal.", "solution": "### Derivation\nThe objective is to minimize compliance, which is a measure of the global flexibility of the structure. The problem requires an evaluation of the sign and magnitude of the topological derivative, $D_T J(\\mathbf{x}_0)$, which quantifies the sensitivity of compliance to the introduction of an infinitesimal hole at a point $\\mathbf{x}_0$.\n\nFirst, we establish the relationship between compliance and total strain energy. For a linear elastic body under equilibrium with fixed external loads, Clapeyron's theorem holds. Assuming zero body forces and zero prescribed displacements on $\\Gamma_D$ (a standard assumption for this type of problem, though the result holds more generally), the work done by the external tractions is equal to twice the total strain energy stored in the body.\nThe total strain energy $U(\\Omega)$ is given by:\n$$\nU(\\Omega) = \\int_\\Omega W(\\mathbf{x}) \\, \\mathrm{d}V = \\int_\\Omega \\frac{1}{2} \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\, \\mathrm{d}V\n$$\nThe compliance is defined as $J(\\Omega) = \\int_{\\Gamma_N} \\mathbf{t} \\cdot \\mathbf{u} \\, \\mathrm{d}\\Gamma$. From the principle of virtual work and the constitutive relation, it follows that:\n$$\nJ(\\Omega) = \\int_\\Omega \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\, \\mathrm{d}V = 2 U(\\Omega)\n$$\nThus, minimizing compliance is equivalent to minimizing the total strain energy.\n\nNext, we analyze the effect of creating a small void $B_\\varepsilon(\\mathbf{x}_0)$ within the domain $\\Omega$. The new domain is $\\Omega_\\varepsilon = \\Omega \\setminus B_\\varepsilon(\\mathbf{x}_0)$. Let the solution on the new domain be $\\mathbf{u}_\\varepsilon$. The new compliance is $J(\\Omega_\\varepsilon) = \\int_{\\Gamma_N} \\mathbf{t} \\cdot \\mathbf{u}_\\varepsilon \\, \\mathrm{d}\\Gamma$.\n\nAccording to the principle of minimum potential energy, the structure will deform in a way that minimizes its total potential energy. Removing material from a structure can never increase its stiffness. A less stiff structure will deform more under the same applied loads. Therefore, the integrated displacement in the direction of the applied tractions will increase or, in the limit, remain the same. This means:\n$$\nJ(\\Omega_\\varepsilon) \\ge J(\\Omega)\n$$\nThe change in compliance, $\\Delta J = J(\\Omega_\\varepsilon) - J(\\Omega)$, is therefore non-negative. It follows directly that the topological derivative, being the limit of the ratio of this non-negative change to a positive volume, must also be non-negative:\n$$\nD_T J(\\mathbf{x}_0) = \\lim_{\\varepsilon \\to 0^+} \\frac{J(\\Omega_\\varepsilon) - J(\\Omega)}{|B_\\varepsilon(\\mathbf{x}_0)|} \\ge 0\n$$\nThe derivative $D_T J(\\mathbf{x}_0)$ can only be zero if the material at $\\mathbf{x}_0$ carries no stress, i.e., $W(\\mathbf{x}_0) = 0$. Otherwise, $D_T J(\\mathbf{x}_0)$ is strictly positive.\n\nNow, we must relate the magnitude of $D_T J(\\mathbf{x}_0)$ to the local strain energy density, $W(\\mathbf{x}_0)$. The quantity $D_T J(\\mathbf{x}_0)$ represents the price, in terms of increased compliance, for removing a unit volume of material at $\\mathbf{x}_0$. The material at a point $\\mathbf{x}_0$ contributes to the overall stiffness of the structure. This contribution is directly related to the load carried by the material at that point, which is quantified by the stress $\\boldsymbol{\\sigma}(\\mathbf{x}_0)$ and strain $\\boldsymbol{\\varepsilon}(\\mathbf{x}_0)$, and thus by the strain energy density $W(\\mathbf{x}_0) = \\frac{1}{2} \\boldsymbol{\\sigma}(\\mathbf{x}_0) : \\boldsymbol{\\varepsilon}(\\mathbf{x}_0)$.\n\nIf material is removed from a region of high strain energy density (high stress), the load paths must be significantly re-routed through surrounding material. This causes a substantial increase in the overall deformation and thus a large increase in compliance. Conversely, if material is removed from a region of low strain energy density (low stress), it was contributing little to the structure's stiffness, so its removal has a minor impact on overall deformation and compliance.\nTherefore, the magnitude of the increase in compliance, and thus the magnitude of $D_T J(\\mathbf{x}_0)$, is a monotonically increasing function of the local strain energy density $W(\\mathbf{x}_0)$. A higher $W(\\mathbf{x}_0)$ implies a larger, positive $D_T J(\\mathbf{x}_0)$.\n\nThe implication for material removal in an optimization context aiming to minimize compliance under a volume constraint is as follows: to achieve an optimal design, one must remove material from locations where the penalty (the increase in compliance) is smallest. This corresponds to regions where $D_T J(\\mathbf{x}_0)$ is minimal. Since $D_T J(\\mathbf{x}_0)$ is smallest where $W(\\mathbf{x}_0)$ is lowest, optimal material removal strategies favor removing material from low-stress regions while preserving material in high-stress regions.\n\n### Option-by-Option Analysis\n\n**A. For compliance minimization with void nucleation, $D_T J(\\mathbf{x}_0)$ is negative at points of high $W(\\mathbf{x}_0)$, indicating that removing material there reduces compliance; moreover, the magnitude of $D_T J(\\mathbf{x}_0)$ decreases as $W(\\mathbf{x}_0)$ increases.**\n-   The statement that $D_T J(\\mathbf{x}_0)$ is negative is **Incorrect**. Removing load-bearing material increases flexibility and thus increases compliance, so $D_T J(\\mathbf{x}_0) \\ge 0$.\n-   The statement that the magnitude decreases as $W(\\mathbf{x}_0)$ increases is **Incorrect**. The sensitivity of compliance to material removal is greatest in highly stressed regions.\n-   Verdict: **Incorrect**.\n\n**B. For compliance minimization with void nucleation, $D_T J(\\mathbf{x}_0)$ is positive and larger at points of high $W(\\mathbf{x}_0)$; removing material there increases compliance the most, so optimal designs avoid removal in high $W$ regions and favor removal where $W(\\mathbf{x}_0)$ is small.**\n-   The statement that $D_T J(\\mathbf{x}_0)$ is positive is **Correct**.\n-   The statement that it is larger at points of high $W(\\mathbf{x}_0)$ is **Correct**.\n-   The interpretation that removing material in high $W$ regions increases compliance the most is **Correct**.\n-   The conclusion that optimal designs favor removal where $W(\\mathbf{x}_0)$ is small is **Correct**. This is the fundamental principle of many topology optimization methods.\n-   Verdict: **Correct**.\n\n**C. For compliance minimization with void nucleation, $D_T J(\\mathbf{x}_0)$ vanishes wherever $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u})=\\mathbf{0}$ holds, hence it does not correlate with $W(\\mathbf{x}_0)$.**\n-   The equation $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u})=\\mathbf{0}$ represents local static equilibrium (assuming no body forces) and holds throughout the material domain. If $D_T J$ vanished wherever this holds, it would vanish everywhere, which is physically absurd. The topological derivative depends on the local values of stress and strain, not their spatial derivatives.\n-   The conclusion that it does not correlate with $W(\\mathbf{x}_0)$ is therefore based on a false premise and is **Incorrect**.\n-   Verdict: **Incorrect**.\n\n**D. For compliance minimization with void nucleation, the sign of $D_T J(\\mathbf{x}_0)$ is indefinite and determined solely by the Poisson ratio, independent of the local mechanical state, so it cannot guide material removal.**\n-   The sign is not indefinite; it is non-negative, as derived from first principles. This statement is **Incorrect**.\n-   The value of $D_T J(\\mathbf{x}_0)$ is fundamentally dependent on the local mechanical state (stress and strain). It is zero in an unstressed region and large in a highly stressed one. The dependence is not solely on the Poisson ratio. This statement is **Incorrect**.\n-   The conclusion that it cannot guide material removal is **Incorrect**. It is precisely the quantity used for this purpose in topological optimization.\n-   Verdict: **Incorrect**.", "answer": "$$\\boxed{B}$$", "id": "2604256"}]}