{"hands_on_practices": [{"introduction": "Before we can combine solutions from different subdomains, we must first correctly formulate the problem on each individual piece. This foundational exercise guides you through the process of deriving and calculating local stiffness matrices for a simple one-dimensional problem that has been \"torn\" into two subdomains. Understanding how to define these local systems and, critically, how to identify the interface degrees of freedom is the essential first step in constructing any domain decomposition method, from classical Schwarz to advanced FETI and BDDC techniques. [@problem_id:2552503]", "problem": "Consider the scalar diffusion model problem on the open interval $\\Omega=(0,1)$, with homogeneous Dirichlet boundary conditions at $x=0$ and $x=1$, and bilinear form $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,dx$. Split $\\Omega$ into two non-overlapping subdomains $\\Omega_1=(0,\\tfrac{1}{2})$ and $\\Omega_2=(\\tfrac{1}{2},1)$, as in Finite Element Tearing and Interconnecting (FETI) and Balancing Domain Decomposition by Constraints (BDDC) methods. On each subdomain, use a single $P_1$ (continuous, piecewise-linear) finite element defined on the subdomain’s two-node mesh, with the standard nodal basis functions associated with the subdomain endpoints. Number local nodes on $\\Omega_1$ in increasing $x$-order as $1 \\mapsto x=0$, $2 \\mapsto x=\\tfrac{1}{2}$, and on $\\Omega_2$ as $1 \\mapsto x=\\tfrac{1}{2}$, $2 \\mapsto x=1$.\n\nStarting from the weak form definition of the finite element stiffness contributions and the affine mapping from a reference element to a physical element, derive the $2\\times 2$ local stiffness matrix on a generic one-dimensional $P_1$ element of length $h$ by integrating products of basis function derivatives. Specialize your result to each subdomain to obtain the explicit local stiffness matrices $K^{(1)}$ on $\\Omega_1$ and $K^{(2)}$ on $\\Omega_2$. Identify, in the local numbering of each subdomain, which local degree of freedom lies on the interface at $x=\\tfrac{1}{2}$.\n\nExpress your final answer as a single row matrix that lists, in order: the four entries of $K^{(1)}$ in row-major order, then the four entries of $K^{(2)}$ in row-major order, followed by the local interface degree-of-freedom indices on $\\Omega_1$ and $\\Omega_2$. Do not round; use exact values. No units are required.", "solution": "The problem statement is analyzed and found to be valid. It is a standard, well-posed problem in the finite element method and serves as a foundational step for domain decomposition techniques such as FETI and BDDC. We shall proceed with the derivation.\n\nThe local stiffness matrix $K^{(e)}$ for a finite element $e$ is defined by its entries $K_{ij}^{(e)} = a(\\phi_j, \\phi_i)$, where the bilinear form $a(\\cdot, \\cdot)$ is restricted to the element domain $\\Omega_e$, and $\\phi_i, \\phi_j$ are the local basis functions. For the given problem, $a(u,v) = \\int_{\\Omega} u'(x)v'(x)dx$, so the entries of the local stiffness matrix for an element of length $h$ spanning the interval $[x_1, x_2]$ are given by:\n$$ K_{ij}^{(e)} = \\int_{x_1}^{x_2} \\phi_i'(x)\\phi_j'(x)dx $$\nWe will derive this matrix for a generic one-dimensional $P_1$ element and then specialize the result for subdomains $\\Omega_1$ and $\\Omega_2$.\n\nFirst, consider the standard reference element, an interval $\\hat{\\Omega} = [0, 1]$ with local coordinate $\\xi$. The $P_1$ basis functions (hat functions) on this reference element are linear polynomials defined by their nodal values:\n$$ \\hat{\\phi}_1(\\xi) = 1 - \\xi $$\n$$ \\hat{\\phi}_2(\\xi) = \\xi $$\nTheir derivatives with respect to the reference coordinate $\\xi$ are constant:\n$$ \\frac{d\\hat{\\phi}_1}{d\\xi} = -1 $$\n$$ \\frac{d\\hat{\\phi}_2}{d\\xi} = 1 $$\n\nNext, we establish the affine mapping from the reference coordinate $\\xi \\in [0, 1]$ to the physical coordinate $x$ in a generic element $[x_1, x_2]$ of length $h = x_2 - x_1$:\n$$ x(\\xi) = x_1 + (x_2 - x_1)\\xi = x_1 + h\\xi $$\nThe Jacobian of this transformation is $J = \\frac{dx}{d\\xi} = h$. Its inverse is $\\frac{d\\xi}{dx} = \\frac{1}{h}$.\n\nThe physical basis functions $\\phi_i(x)$ are related to the reference basis functions $\\hat{\\phi}_i(\\xi)$ by composition with the inverse mapping: $\\phi_i(x) = \\hat{\\phi}_i(\\xi(x))$. We use the chain rule to find their derivatives with respect to the physical coordinate $x$:\n$$ \\frac{d\\phi_i}{dx} = \\frac{d\\hat{\\phi}_i}{d\\xi} \\frac{d\\xi}{dx} = \\frac{1}{h} \\frac{d\\hat{\\phi}_i}{d\\xi} $$\nSpecifically:\n$$ \\phi_1'(x) = \\frac{1}{h}(-1) = -\\frac{1}{h} $$\n$$ \\phi_2'(x) = \\frac{1}{h}(1) = \\frac{1}{h} $$\nThese derivatives are constant over the element.\n\nNow we can compute the entries of the generic $2 \\times 2$ local stiffness matrix $K^{(e)}$. The integral in the physical domain is transformed to an integral over the reference domain $[0, 1]$ using $dx = J d\\xi = h d\\xi$:\n$$ K_{ij}^{(e)} = \\int_{x_1}^{x_2} \\phi_i'(x)\\phi_j'(x)dx = \\int_{0}^{1} \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_i}{d\\xi}\\right) \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_j}{d\\xi}\\right) (h d\\xi) = \\frac{1}{h} \\int_{0}^{1} \\frac{d\\hat{\\phi}_i}{d\\xi}\\frac{d\\hat{\\phi}_j}{d\\xi}d\\xi $$\nWe compute each of the four entries:\n$$ K_{11}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (-1)(-1) d\\xi = \\frac{1}{h} \\int_{0}^{1} 1 \\, d\\xi = \\frac{1}{h} [\\xi]_0^1 = \\frac{1}{h} $$\n$$ K_{12}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (-1)(1) d\\xi = \\frac{1}{h} \\int_{0}^{1} -1 \\, d\\xi = -\\frac{1}{h} [\\xi]_0^1 = -\\frac{1}{h} $$\n$$ K_{21}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (1)(-1) d\\xi = \\frac{1}{h} \\int_{0}^{1} -1 \\, d\\xi = -\\frac{1}{h} [\\xi]_0^1 = -\\frac{1}{h} $$\n$$ K_{22}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (1)(1) d\\xi = \\frac{1}{h} \\int_{0}^{1} 1 \\, d\\xi = \\frac{1}{h} [\\xi]_0^1 = \\frac{1}{h} $$\nThus, the generic local stiffness matrix for a 1D $P_1$ element of length $h$ is:\n$$ K^{(e)} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n\nNow, we specialize this result to the two subdomains $\\Omega_1$ and $\\Omega_2$.\n\nFor subdomain $\\Omega_1 = (0, \\frac{1}{2})$, we have a single element with nodes at $x=0$ and $x=\\frac{1}{2}$. The length of this element is $h_1 = \\frac{1}{2} - 0 = \\frac{1}{2}$. The local stiffness matrix $K^{(1)}$ is:\n$$ K^{(1)} = \\frac{1}{1/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = 2 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2 & -2 \\\\ -2 & 2 \\end{pmatrix} $$\nThe entries in row-major order are $2, -2, -2, 2$.\n\nFor subdomain $\\Omega_2 = (\\frac{1}{2}, 1)$, we have a single element with nodes at $x=\\frac{1}{2}$ and $x=1$. The length of this element is $h_2 = 1 - \\frac{1}{2} = \\frac{1}{2}$. The local stiffness matrix $K^{(2)}$ is:\n$$ K^{(2)} = \\frac{1}{1/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = 2 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2 & -2 \\\\ -2 & 2 \\end{pmatrix} $$\nThe entries in row-major order are $2, -2, -2, 2$.\n\nFinally, we must identify the local degree of freedom (DoF) on the interface at $x=\\frac{1}{2}$ for each subdomain. A DoF's index corresponds to its local node number.\nOn subdomain $\\Omega_1$, the local nodes are numbered as $1 \\mapsto x=0$ and $2 \\mapsto x=\\frac{1}{2}$. The interface is at $x=\\frac{1}{2}$, which corresponds to local node index $2$.\nOn subdomain $\\Omega_2$, the local nodes are numbered as $1 \\mapsto x=\\frac{1}{2}$ and $2 \\mapsto x=1$. The interface is at $x=\\frac{1}{2}$, which corresponds to local node index $1$.\n\nWe assemble these results into a single row matrix as requested. The components are:\n1.  Entries of $K^{(1)}$ (row-major): $2, -2, -2, 2$.\n2.  Entries of $K^{(2)}$ (row-major): $2, -2, -2, 2$.\n3.  Interface DoF index on $\\Omega_1$: $2$.\n4.  Interface DoF index on $\\Omega_2$: $1$.\nThe combined list of values is $(2, -2, -2, 2, 2, -2, -2, 2, 2, 1)$.", "answer": "$$ \\boxed{ \\begin{pmatrix} 2 & -2 & -2 & 2 & 2 & -2 & -2 & 2 & 2 & 1 \\end{pmatrix} } $$", "id": "2552503"}, {"introduction": "The additive Schwarz method is a cornerstone of domain decomposition, offering an intuitive approach based on overlapping subdomains. In this practice, we explore its behavior by performing a single iteration on a discretized 1D problem and comparing the result directly to that of the classic Jacobi iteration. This comparison provides valuable insight into how Schwarz methods act as preconditioners, accelerating convergence by solving local problems and adding the corrections, in contrast to simpler point-wise updates. [@problem_id:2552509]", "problem": "Consider the scalar diffusion problem $-u''=f$ on the interval $[0,6]$ with homogeneous Dirichlet boundary conditions $u(0)=u(6)=0$. Discretize by continuous piecewise-linear finite elements on a uniform mesh with spacing $h=1$, so that the assembled symmetric positive definite (SPD) stiffness matrix $A\\in\\mathbb{R}^{5\\times 5}$ on the $5$ interior nodes $\\{1,2,3,4,5\\}$ is the standard tridiagonal matrix with $2$ on the diagonal and $-1$ on the first sub- and super-diagonals. Let the right-hand side be the vector $b=e_{3}\\in\\mathbb{R}^{5}$, where $e_{3}$ is the unit vector with a $1$ at node $3$ and zeros elsewhere, and start from the initial guess $u^{0}=0$.\n\nDefine an overlapping three-subdomain decomposition with subdomain index sets\n- $\\Omega_{1}=\\{1,2,3\\}$,\n- $\\Omega_{2}=\\{3,4,5\\}$,\n- $\\Omega_{3}=\\{2,3,4\\}$.\n\nFor each subdomain $\\Omega_{i}$, let $R_{i}\\in\\mathbb{R}^{3\\times 5}$ be the Boolean restriction operator that extracts the components on $\\Omega_{i}$ in the natural order, and let the local operator be $A_{i}=R_{i}AR_{i}^{\\top}\\in\\mathbb{R}^{3\\times 3}$. Consider the classical one-level additive Schwarz stationary iteration (with simple injection, no partition-of-unity weighting),\n$$\nu^{k+1}=u^{k}+\\sum_{i=1}^{3}R_{i}^{\\top}A_{i}^{-1}R_{i}\\,\\bigl(b-Au^{k}\\bigr),\n$$\nand the Jacobi iteration on the global system,\n$$\nu^{k+1}=u^{k}+D^{-1}\\bigl(b-Au^{k}\\bigr),\n$$\nwhere $D=\\operatorname{diag}(A)$ is the diagonal of $A$. Using $u^{0}=0$, perform one iteration of each method to obtain $u_{\\mathrm{AS}}^{1}$ and $u_{\\mathrm{J}}^{1}$, and compute the ratio of Euclidean norms of the corresponding residuals,\n$$\n\\frac{\\|b-Au_{\\mathrm{AS}}^{1}\\|_{2}}{\\|b-Au_{\\mathrm{J}}^{1}\\|_{2}}.\n$$\n\nProvide your answer as a single exact expression (no rounding, no decimals).", "solution": "The problem statement is a well-posed exercise in numerical linear algebra, specifically concerning iterative methods for linear systems arising from the finite element discretization of a differential equation. It is scientifically grounded, formally defined, and contains all necessary information to proceed with a solution. No inconsistencies or invalid premises are present. We shall proceed with the calculation.\n\nThe global stiffness matrix $A \\in \\mathbb{R}^{5\\times 5}$ and the right-hand side vector $b \\in \\mathbb{R}^{5}$ are given as:\n$$\nA = \\begin{pmatrix} 2 & -1 & 0 & 0 & 0 \\\\ -1 & 2 & -1 & 0 & 0 \\\\ 0 & -1 & 2 & -1 & 0 \\\\ 0 & 0 & -1 & 2 & -1 \\\\ 0 & 0 & 0 & -1 & 2 \\end{pmatrix}, \\quad b = e_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe initial guess is $u^{0} = 0 \\in \\mathbb{R}^{5}$.\n\nFirst, we compute one iteration of the Jacobi method. The Jacobi iteration is defined as $u^{k+1} = u^{k} + D^{-1}(b - Au^{k})$, where $D = \\operatorname{diag}(A)$.\nFor the first iteration, with $k=0$ and $u^{0} = 0$, we have:\n$$\nu_{\\mathrm{J}}^{1} = u^{0} + D^{-1}(b - Au^{0}) = D^{-1}b\n$$\nThe diagonal of $A$ is $D = \\operatorname{diag}(2, 2, 2, 2, 2) = 2I$, where $I$ is the $5 \\times 5$ identity matrix. Thus, its inverse is $D^{-1} = \\frac{1}{2}I$.\nThe first Jacobi iterate is:\n$$\nu_{\\mathrm{J}}^{1} = \\frac{1}{2}I b = \\frac{1}{2}b = \\frac{1}{2}e_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe corresponding residual is $r_{\\mathrm{J}}^{1} = b - Au_{\\mathrm{J}}^{1}$. We first compute $Au_{\\mathrm{J}}^{1}$:\n$$\nA u_{\\mathrm{J}}^{1} = A \\left(\\frac{1}{2}e_{3}\\right) = \\frac{1}{2} (A e_{3}) = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ -1 \\\\ 2 \\\\ -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\nThe residual is then:\n$$\nr_{\\mathrm{J}}^{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\nThe Euclidean norm of the Jacobi residual is:\n$$\n\\|r_{\\mathrm{J}}^{1}\\|_{2} = \\left\\| \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix} \\right\\|_{2} = \\sqrt{0^{2} + \\left(\\frac{1}{2}\\right)^{2} + 0^{2} + \\left(\\frac{1}{2}\\right)^{2} + 0^{2}} = \\sqrt{\\frac{1}{4} + \\frac{1}{4}} = \\sqrt{\\frac{1}{2}}\n$$\n\nNext, we compute one iteration of the one-level additive Schwarz method. The iteration is $u^{k+1} = u^{k} + \\sum_{i=1}^{3} R_{i}^{\\top}A_{i}^{-1}R_{i}\\,(b - Au^{k})$.\nFor the first iteration, with $k=0$ and $u^{0}=0$, we have:\n$$\nu_{\\mathrm{AS}}^{1} = \\sum_{i=1}^{3} R_{i}^{\\top}A_{i}^{-1}R_{i}b\n$$\nWe analyze each subdomain contribution. The local matrices are $A_{i} = R_{i}AR_{i}^{\\top}$. For the subdomains $\\Omega_{1} = \\{1,2,3\\}$, $\\Omega_{2} = \\{3,4,5\\}$, and $\\Omega_{3} = \\{2,3,4\\}$, the corresponding local stiffness matrices are the principal submatrices of $A$:\n$$\nA_{1} = A_{2} = A_{3} = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}\n$$\nThe inverse of this matrix is required. The determinant is $\\det(A_{1}) = 2(2 \\cdot 2 - (-1)(-1)) - (-1)(-1 \\cdot 2 - 0) = 2(3) - 2 = 4$. The inverse is:\n$$\nA_{1}^{-1} = A_{2}^{-1} = A_{3}^{-1} = \\frac{1}{4} \\begin{pmatrix} 3 & 2 & 1 \\\\ 2 & 4 & 2 \\\\ 1 & 2 & 3 \\end{pmatrix}\n$$\nNow we compute the local solves. The right-hand side $b=e_{3}$ is restricted to each subdomain, yielding local vectors $b_{i} = R_{i}b$:\n$$\nb_{1} = R_{1}b = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad b_{2} = R_{2}b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad b_{3} = R_{3}b = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\nThe local solutions are $w_{i} = A_{i}^{-1}b_{i}$:\n$$\nw_{1} = A_{1}^{-1}b_{1} = \\frac{1}{4} \\begin{pmatrix} 3 & 2 & 1 \\\\ 2 & 4 & 2 \\\\ 1 & 2 & 3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n$$\nw_{2} = A_{2}^{-1}b_{2} = \\frac{1}{4} \\begin{pmatrix} 3 & 2 & 1 \\\\ 2 & 4 & 2 \\\\ 1 & 2 & 3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 3 \\\\ 2 \\\\ 1 \\end{pmatrix}\n$$\n$$\nw_{3} = A_{3}^{-1}b_{3} = \\frac{1}{4} \\begin{pmatrix} 3 & 2 & 1 \\\\ 2 & 4 & 2 \\\\ 1 & 2 & 3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\nThese local solutions are extended back to the global vector space using $R_{i}^{\\top}$ and summed to obtain the first additive Schwarz iterate:\n$$\nu_{\\mathrm{AS}}^{1} = R_{1}^{\\top}w_{1} + R_{2}^{\\top}w_{2} + R_{3}^{\\top}w_{3} = \\frac{1}{4}\\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{4}\\begin{pmatrix} 0 \\\\ 0 \\\\ 3 \\\\ 2 \\\\ 1 \\end{pmatrix} + \\frac{1}{4}\\begin{pmatrix} 0 \\\\ 2 \\\\ 4 \\\\ 2 \\\\ 0 \\end{pmatrix} = \\frac{1}{4}\\begin{pmatrix} 1 \\\\ 4 \\\\ 10 \\\\ 4 \\\\ 1 \\end{pmatrix}\n$$\nThe corresponding residual is $r_{\\mathrm{AS}}^{1} = b - Au_{\\mathrm{AS}}^{1}$. We first compute $Au_{\\mathrm{AS}}^{1}$:\n$$\nAu_{\\mathrm{AS}}^{1} = \\frac{1}{4} \\begin{pmatrix} 2 & -1 & 0 & 0 & 0 \\\\ -1 & 2 & -1 & 0 & 0 \\\\ 0 & -1 & 2 & -1 & 0 \\\\ 0 & 0 & -1 & 2 & -1 \\\\ 0 & 0 & 0 & -1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 4 \\\\ 10 \\\\ 4 \\\\ 1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2-4 \\\\ -1+8-10 \\\\ -4+20-4 \\\\ -10+8-1 \\\\ -4+2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} -2 \\\\ -3 \\\\ 12 \\\\ -3 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ -3/4 \\\\ 3 \\\\ -3/4 \\\\ -1/2 \\end{pmatrix}\n$$\nThe residual is then:\n$$\nr_{\\mathrm{AS}}^{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} -1/2 \\\\ -3/4 \\\\ 3 \\\\ -3/4 \\\\ -1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 3/4 \\\\ -2 \\\\ 3/4 \\\\ 1/2 \\end{pmatrix}\n$$\nThe Euclidean norm of the additive Schwarz residual is:\n$$\n\\|r_{\\mathrm{AS}}^{1}\\|_{2} = \\sqrt{\\left(\\frac{1}{2}\\right)^{2} + \\left(\\frac{3}{4}\\right)^{2} + (-2)^{2} + \\left(\\frac{3}{4}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2}} = \\sqrt{\\frac{1}{4} + \\frac{9}{16} + 4 + \\frac{9}{16} + \\frac{1}{4}}\n$$\n$$\n\\|r_{\\mathrm{AS}}^{1}\\|_{2} = \\sqrt{2\\left(\\frac{1}{4}\\right) + 2\\left(\\frac{9}{16}\\right) + 4} = \\sqrt{\\frac{1}{2} + \\frac{9}{8} + 4} = \\sqrt{\\frac{4}{8} + \\frac{9}{8} + \\frac{32}{8}} = \\sqrt{\\frac{45}{8}} = \\frac{3\\sqrt{5}}{2\\sqrt{2}} = \\frac{3\\sqrt{10}}{4}\n$$\nFinally, we compute the required ratio of the norms of the residuals:\n$$\n\\frac{\\|b-Au_{\\mathrm{AS}}^{1}\\|_{2}}{\\|b-Au_{\\mathrm{J}}^{1}\\|_{2}} = \\frac{\\|r_{\\mathrm{AS}}^{1}\\|_{2}}{\\|r_{\\mathrm{J}}^{1}\\|_{2}} = \\frac{\\frac{3\\sqrt{10}}{4}}{\\sqrt{\\frac{1}{2}}} = \\frac{3\\sqrt{10}}{4} \\cdot \\sqrt{2} = \\frac{3\\sqrt{20}}{4} = \\frac{3 \\cdot 2\\sqrt{5}}{4} = \\frac{6\\sqrt{5}}{4} = \\frac{3\\sqrt{5}}{2}\n$$", "answer": "$$\n\\boxed{\\frac{3\\sqrt{5}}{2}}\n$$", "id": "2552509"}, {"introduction": "Moving beyond overlapping methods, we now explore the non-overlapping Finite Element Tearing and Interconnecting (FETI) framework, a powerful technique for parallel computing. This exercise demystifies the core mechanism of FETI by reducing it to its simplest form: two subdomains connected by a single interface point. You will derive the \"dual\" problem, where interface continuity is enforced via a Lagrange multiplier, and solve it using the conjugate gradient method, revealing how complex global problems can be transformed into smaller, more manageable interface systems. [@problem_id:2552477]", "problem": "Consider a one-dimensional bar decomposed into two non-overlapping subdomains that meet at a single interface point. Each subdomain is discretized by a single linear finite element. The outer ends of the bar are constrained by prescribed displacements, so the only algebraic unknowns within each subdomain are the interface displacements, which are duplicated across the subdomains as $u_1$ and $u_2$. The interface continuity constraint is $u_1 - u_2 = 0$. Let the subdomain reduced stiffnesses be $k_1 = EA/\\ell$ for the left subdomain and $k_2 = EA/\\ell$ for the right subdomain, with the numerical values $k_1 = 2$ and $k_2 = 6$. Equivalent nodal forces on the interface degrees of freedom (arising from body forces and tractions after static condensation of the outer Dirichlet nodes) are $f_1 = 4$ on the left subdomain’s interface node and $f_2 = 3$ on the right subdomain’s interface node. The Finite Element Tearing and Interconnecting (FETI) formulation enforces continuity with a single Lagrange multiplier $\\lambda$ through the subdomain equilibrium equations and the interface continuity constraint.\n\nUsing the subdomain equilibrium $K_i u_i + B_i^{\\top} \\lambda = f_i$ with $K_i = [k_i]$ and the jump operator blocks $B_1 = [1]$, $B_2 = [-1]$, proceed as follows:\n\n1) Starting from the subdomain equilibrium equations and the continuity constraint $B_1 u_1 + B_2 u_2 = 0$, eliminate $u_1$ and $u_2$ to assemble the reduced FETI scalar equation $F \\lambda = d$. Express $F$ and $d$ symbolically in terms of $k_1$, $k_2$, $f_1$, and $f_2$, and then evaluate $F$ and $d$ for the given numerical data $k_1 = 2$, $k_2 = 6$, $f_1 = 4$, $f_2 = 3$.\n\n2) With the identity preconditioner for Preconditioned Conjugate Gradients (PCG), i.e., $M = 1$, and the initial guess $\\lambda_0 = 0$, perform one step of PCG on the scalar reduced system $F \\lambda = d$. Use the standard PCG step definitions for the residual $r_0 = d - F \\lambda_0$, the preconditioned residual $z_0 = M r_0$, the search direction $p_0 = z_0$, the step size $\\alpha_0 = (r_0^{\\top} z_0)/(p_0^{\\top} F p_0)$, and the updated multiplier $\\lambda_1 = \\lambda_0 + \\alpha_0 p_0$. Compute the exact value of $\\lambda_1$.\n\nGive your final answer for $\\lambda_1$ as an exact number with no units. No rounding is required.", "solution": "The problem statement is validated and found to be scientifically sound, well-posed, objective, and self-contained. It represents a standard exercise in the application of the Finite Element Tearing and Interconnecting (FETI) method for a simple one-dimensional problem. We shall proceed with the solution.\n\nThe problem is divided into two parts. First, we derive the reduced FETI system, and second, we perform one iteration of the Preconditioned Conjugate Gradients (PCG) method.\n\n**Part 1: Derivation of the FETI System $F \\lambda = d$**\n\nThe subdomain equilibrium equations are provided for each subdomain $i \\in \\{1, 2\\}$ as:\n$$K_i u_i + B_i^{\\top} \\lambda = f_i$$\nIn this problem, the unknowns $u_i$ are the scalar interface displacements for each subdomain. The stiffness matrices $K_i$ and jump operator blocks $B_i$ are therefore scalars (or $1 \\times 1$ matrices).\n\nFor subdomain $1$, with $K_1 = [k_1]$ and $B_1 = [1]$, the equilibrium equation is:\n$$k_1 u_1 + \\lambda = f_1$$\nFor subdomain $2$, with $K_2 = [k_2]$ and $B_2 = [-1]$, the equilibrium equation is:\n$$k_2 u_2 - \\lambda = f_2$$\n\nThe subdomain stiffnesses $k_1$ and $k_2$ are given as non-zero positive constants, which means the subdomain problems are invertible. We can express the interface displacements $u_1$ and $u_2$ in terms of the Lagrange multiplier $\\lambda$ and the nodal forces $f_1$ and $f_2$:\n$$u_1 = k_1^{-1} (f_1 - \\lambda) = \\frac{f_1 - \\lambda}{k_1}$$\n$$u_2 = k_2^{-1} (f_2 + \\lambda) = \\frac{f_2 + \\lambda}{k_2}$$\n\nThe interface continuity constraint is given in the form $B_1 u_1 + B_2 u_2 = 0$, which simplifies to:\n$$[1] u_1 + [-1] u_2 = 0 \\implies u_1 - u_2 = 0$$\nSubstituting the expressions for $u_1$ and $u_2$ into this continuity constraint gives the equation for $\\lambda$:\n$$\\frac{f_1 - \\lambda}{k_1} - \\frac{f_2 + \\lambda}{k_2} = 0$$\nWe must rearrange this equation to isolate the unknown $\\lambda$, grouping terms with $\\lambda$ on one side and the remaining terms on the other.\n$$\\frac{f_1}{k_1} - \\frac{\\lambda}{k_1} - \\frac{f_2}{k_2} - \\frac{\\lambda}{k_2} = 0$$\n$$\\lambda \\left(\\frac{1}{k_1} + \\frac{1}{k_2}\\right) = \\frac{f_1}{k_1} - \\frac{f_2}{k_2}$$\nThis is the reduced FETI scalar equation $F \\lambda = d$, where the FETI operator $F$ and the right-hand side vector $d$ are symbolically given by:\n$$F = \\frac{1}{k_1} + \\frac{1}{k_2}$$\n$$d = \\frac{f_1}{k_1} - \\frac{f_2}{k_2}$$\n\nNow we substitute the given numerical values: $k_1 = 2$, $k_2 = 6$, $f_1 = 4$, and $f_2 = 3$.\n$$F = \\frac{1}{2} + \\frac{1}{6} = \\frac{3}{6} + \\frac{1}{6} = \\frac{4}{6} = \\frac{2}{3}$$\n$$d = \\frac{4}{2} - \\frac{3}{6} = 2 - \\frac{1}{2} = \\frac{4}{2} - \\frac{1}{2} = \\frac{3}{2}$$\nThe resulting scalar system to be solved is:\n$$\\frac{2}{3} \\lambda = \\frac{3}{2}$$\n\n**Part 2: One Step of the PCG Method**\n\nWe are tasked to perform one iteration of the Preconditioned Conjugate Gradients algorithm with an identity preconditioner, $M = 1$, and an initial guess $\\lambda_0 = 0$.\n\nThe PCG algorithm steps are as follows:\n1.  Calculate the initial residual $r_0$:\n    $$r_0 = d - F \\lambda_0$$\n    With $\\lambda_0 = 0$, the residual is simply the right-hand side:\n    $$r_0 = d = \\frac{3}{2}$$\n\n2.  Apply the preconditioner. The problem gives the formula $z_0 = M r_0$. With the identity preconditioner $M=1$:\n    $$z_0 = 1 \\cdot r_0 = \\frac{3}{2}$$\n\n3.  Set the initial search direction $p_0$:\n    $$p_0 = z_0 = \\frac{3}{2}$$\n\n4.  Calculate the step size $\\alpha_0$. Since all quantities are scalars, the transpose operation $^\\top$ is the identity.\n    $$\\alpha_0 = \\frac{r_0^{\\top} z_0}{p_0^{\\top} F p_0} = \\frac{r_0 z_0}{p_0 F p_0}$$\n    Substituting the values $r_0 = \\frac{3}{2}$, $z_0 = \\frac{3}{2}$, $p_0 = \\frac{3}{2}$, and $F = \\frac{2}{3}$:\n    The numerator is:\n    $$r_0 z_0 = \\left(\\frac{3}{2}\\right) \\left(\\frac{3}{2}\\right) = \\frac{9}{4}$$\n    The denominator is:\n    $$p_0 F p_0 = \\left(\\frac{3}{2}\\right) \\left(\\frac{2}{3}\\right) \\left(\\frac{3}{2}\\right) = 1 \\cdot \\frac{3}{2} = \\frac{3}{2}$$\n    The step size is therefore:\n    $$\\alpha_0 = \\frac{9/4}{3/2} = \\frac{9}{4} \\cdot \\frac{2}{3} = \\frac{18}{12} = \\frac{3}{2}$$\n\n5.  Update the solution to obtain $\\lambda_1$:\n    $$\\lambda_1 = \\lambda_0 + \\alpha_0 p_0$$\n    Substituting the values:\n    $$\\lambda_1 = 0 + \\left(\\frac{3}{2}\\right) \\left(\\frac{3}{2}\\right) = \\frac{9}{4}$$\n\nThis is the result after one step of the PCG algorithm. It is fundamental that for a scalar equation, which is a $1 \\times 1$ system, the Conjugate Gradient method converges to the exact solution in a single iteration. The exact solution of $\\frac{2}{3} \\lambda = \\frac{3}{2}$ is $\\lambda = \\frac{3}{2} / \\frac{2}{3} = \\frac{3}{2} \\cdot \\frac{3}{2} = \\frac{9}{4}$, which confirms our result.\nThe final answer is $\\lambda_1 = 9/4$.", "answer": "$$\\boxed{\\frac{9}{4}}$$", "id": "2552477"}]}