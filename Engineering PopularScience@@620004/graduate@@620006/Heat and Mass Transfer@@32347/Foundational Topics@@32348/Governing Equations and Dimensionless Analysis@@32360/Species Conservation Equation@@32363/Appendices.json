{"hands_on_practices": [{"introduction": "Understanding the species conservation equation begins with its fundamental formulation. This practice guides you through its derivation from first principles, tackling the crucial conversion between molar and mass-based quantities. Mastering this skill is essential for correctly analyzing reacting flows, where chemical kinetics are often expressed in molar terms while transport equations are typically solved using mass fractions.", "problem": "Consider an isothermal, multicomponent, compressible gas mixture undergoing the irreversible, elementary reaction $A + B \\to C$ in a continuum setting. The intrinsic reaction rate per unit volume is given in molar units by $R = k\\, c_{A}\\, c_{B}$, where $k$ is the rate constant and $c_{i}$ denotes the molar concentration of species $i$. Let $\\rho$ be the mixture mass density, $Y_{i}$ the mass fraction of species $i$, $M_{i}$ the molecular weight of species $i$, $\\mathbf{v}$ the mass-averaged mixture velocity, $\\mathbf{N}_{i}$ the molar flux of species $i$, $\\mathbf{J}_{i}$ the molar diffusive flux of species $i$ relative to $\\mathbf{v}$, and $\\mathbf{j}_{i}$ the mass diffusive flux of species $i$ relative to $\\mathbf{v}$.\n\nStarting from the integral statement of species conservation and the Reynolds Transport Theorem (RTT), first derive the local molar species conservation equation for a general species $i \\in \\{A,B,C\\}$, explicitly identifying the reaction source term in terms of the stoichiometric coefficients for the reaction $A + B \\to C$ and the rate $R$. Then, by using only fundamental definitions that relate molar quantities to mass-based quantities in a mixture (including $c_{i}$, $Y_{i}$, $\\rho$, and $M_{i}$), convert the molar species conservation equations to their mass-fraction form. Your derivation should remain general with respect to constitutive closure for diffusive fluxes; do not assume any specific diffusion model.\n\nFinally, from your mass-fraction formulation, determine the explicit closed-form expression for the mass production rate of species $C$, denoted $\\dot{\\omega}_{C}$, written solely in terms of $k$, $\\rho$, $Y_{A}$, $Y_{B}$, $M_{A}$, $M_{B}$, and $M_{C}$. Express your final answer as a single analytic expression containing only these symbols. Do not include units in your final answer. If you perform any intermediate numerical manipulation, do not round; the final answer must be exact and symbolic.", "solution": "The problem statement is scientifically sound, well-posed, and contains sufficient information for a rigorous derivation. It is therefore deemed valid. We proceed with the solution.\n\nThe derivation consists of three main parts as requested: first, the derivation of the local molar species conservation equation; second, its conversion to the mass-fraction form; and finally, the determination of the mass production rate for species $C$.\n\nFirst, we derive the local molar species conservation equation. The integral balance for the number of moles of species $i$ in an arbitrary, fixed control volume $V$ bounded by a surface $A$ is given by:\n$$ \\frac{d}{dt} \\int_V c_i \\, dV = - \\oint_A \\mathbf{N}_i \\cdot \\mathbf{n} \\, dA + \\int_V \\dot{R}_i \\, dV $$\nHere, $c_i$ is the molar concentration of species $i$, $\\mathbf{N}_i$ is the absolute molar flux, $\\mathbf{n}$ is the outward-pointing unit normal vector on the surface $A$, and $\\dot{R}_i$ is the net molar rate of production of species $i$ per unit volume due to chemical reaction.\n\nFor a fixed control volume, the time derivative can be moved inside the integral. Applying the Gauss divergence theorem to the surface integral transforms it into a volume integral:\n$$ \\oint_A \\mathbf{N}_i \\cdot \\mathbf{n} \\, dA = \\int_V \\nabla \\cdot \\mathbf{N}_i \\, dV $$\nSubstituting these into the integral balance gives:\n$$ \\int_V \\frac{\\partial c_i}{\\partial t} \\, dV = - \\int_V \\nabla \\cdot \\mathbf{N}_i \\, dV + \\int_V \\dot{R}_i \\, dV $$\nThis can be rearranged into a single volume integral:\n$$ \\int_V \\left( \\frac{\\partial c_i}{\\partial t} + \\nabla \\cdot \\mathbf{N}_i - \\dot{R}_i \\right) \\, dV = 0 $$\nSince this equation must hold for any arbitrary control volume $V$, the integrand itself must be zero. This yields the local, differential form of the molar species conservation equation:\n$$ \\frac{\\partial c_i}{\\partial t} + \\nabla \\cdot \\mathbf{N}_i = \\dot{R}_i $$\nThe absolute molar flux $\\mathbf{N}_i$ is the sum of the convective flux due to the bulk motion and the diffusive flux relative to that motion. The problem specifies the mass-averaged velocity $\\mathbf{v}$ as the reference for bulk motion. Thus, the absolute molar flux is decomposed as:\n$$ \\mathbf{N}_i = c_i \\mathbf{v} + \\mathbf{J}_i $$\nwhere $c_i \\mathbf{v}$ is the molar convective flux and $\\mathbf{J}_i$ is the molar diffusive flux of species $i$ relative to $\\mathbf{v}$. Substituting this decomposition into the conservation equation gives:\n$$ \\frac{\\partial c_i}{\\partial t} + \\nabla \\cdot (c_i \\mathbf{v} + \\mathbf{J}_i) = \\dot{R}_i $$\nThis expands to:\n$$ \\frac{\\partial c_i}{\\partial t} + \\nabla \\cdot (c_i \\mathbf{v}) + \\nabla \\cdot \\mathbf{J}_i = \\dot{R}_i $$\nThis is the general local molar species conservation equation.\n\nNext, we identify the reaction source term $\\dot{R}_i$. For a general elementary reaction, the molar production rate of species $i$ is $\\dot{R}_i = \\nu_i R$, where $\\nu_i$ is the net stoichiometric coefficient of species $i$ ($\\nu_i = \\nu_i'' - \\nu_i'$, where $\\nu_i'$ and $\\nu_i''$ are the stoichiometric coefficients of reactants and products, respectively) and $R$ is the reaction rate.\nFor the reaction $A + B \\to C$, which is $1A + 1B \\to 1C$, the stoichiometric coefficients are $\\nu_A = -1$, $\\nu_B = -1$, and $\\nu_C = 1$. The problem states the intrinsic reaction rate is $R = k c_A c_B$. Therefore, the source terms for each species are:\n$$ \\dot{R}_A = (-1) R = -k c_A c_B $$\n$$ \\dot{R}_B = (-1) R = -k c_A c_B $$\n$$ \\dot{R}_C = (1) R = k c_A c_B $$\n\nNow, we convert the molar conservation equation to its mass-fraction form. The key definitions are:\nMolar concentration: $c_i = \\rho Y_i / M_i$\nMass diffusive flux: $\\mathbf{j}_i = M_i \\mathbf{J}_i$\nMass production rate: $\\dot{\\omega}_i = M_i \\dot{R}_i$\nwhere $\\rho$ is the mixture density, $Y_i$ is the mass fraction of species $i$, and $M_i$ is its molecular weight.\n\nWe start with the molar conservation equation and multiply it by $M_i$:\n$$ M_i \\frac{\\partial c_i}{\\partial t} + M_i \\nabla \\cdot (c_i \\mathbf{v}) + M_i \\nabla \\cdot \\mathbf{J}_i = M_i \\dot{R}_i $$\nSubstituting $c_i = \\rho Y_i / M_i$ and recognizing that $M_i$ is a constant:\n$$ M_i \\frac{\\partial}{\\partial t} \\left(\\frac{\\rho Y_i}{M_i}\\right) + M_i \\nabla \\cdot \\left(\\frac{\\rho Y_i}{M_i} \\mathbf{v}\\right) + \\nabla \\cdot (M_i \\mathbf{J}_i) = M_i \\dot{R}_i $$\n$$ \\frac{\\partial (\\rho Y_i)}{\\partial t} + \\nabla \\cdot (\\rho Y_i \\mathbf{v}) + \\nabla \\cdot \\mathbf{j}_i = \\dot{\\omega}_i $$\nThis is the species conservation equation in terms of mass fraction $Y_i$. This form is often called the \"conservation form\". An alternative form using the material derivative can be found by expanding the first two terms and using the total mass continuity equation ($\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}) = 0$), which yields $\\rho \\frac{D Y_i}{Dt} + \\nabla \\cdot \\mathbf{j}_i = \\dot{\\omega}_i$. For the present purpose, the conservation form is sufficient.\n\nFinally, we determine the expression for the mass production rate of species $C$, denoted $\\dot{\\omega}_C$. From the definition, we have:\n$$ \\dot{\\omega}_C = M_C \\dot{R}_C $$\nFrom our earlier analysis of the reaction source term, we found:\n$$ \\dot{R}_C = k c_A c_B $$\nTherefore:\n$$ \\dot{\\omega}_C = M_C (k c_A c_B) $$\nTo express $\\dot{\\omega}_C$ in terms of the required variables ($k$, $\\rho$, $Y_{A}$, $Y_{B}$, $M_{A}$, $M_{B}$, $M_{C}$), we replace the molar concentrations $c_A$ and $c_B$ with their definitions in terms of mass fractions:\n$$ c_A = \\frac{\\rho Y_A}{M_A} $$\n$$ c_B = \\frac{\\rho Y_B}{M_B} $$\nSubstituting these into the expression for $\\dot{\\omega}_C$:\n$$ \\dot{\\omega}_C = M_C k \\left( \\frac{\\rho Y_A}{M_A} \\right) \\left( \\frac{\\rho Y_B}{M_B} \\right) $$\nRearranging the terms gives the final closed-form expression:\n$$ \\dot{\\omega}_C = k M_C \\frac{\\rho^2 Y_A Y_B}{M_A M_B} $$\nThis expression depends only on the variables specified in the problem statement.", "answer": "$$\\boxed{k M_{C} \\frac{\\rho^{2} Y_{A} Y_{B}}{M_{A} M_{B}}}$$", "id": "2523788"}, {"introduction": "Chemical source terms often make the species conservation equations highly nonlinear and challenging to solve analytically. This exercise introduces the powerful conserved scalar method, a technique to bypass this complexity by formulating a variable whose transport is independent of the chemical reaction. Through the classic Burke–Schumann flame model, you will see how this approach simplifies a reacting flow problem into a linear one, enabling an elegant solution for the flame's location [@problem_id:2523783].", "problem": "A steady, one-dimensional diffusion flame forms between two parallel, isothermal, impermeable plates separated by a distance $L$ along the coordinate $x \\in [0,L]$. The left plate at $x=0$ is exposed to a binary gas mixture composed of a fuel species $F$ and an inert, with fuel mass fraction $Y_{F,0}$ and zero oxidizer; the right plate at $x=L$ is exposed to a binary gas mixture composed of an oxidizer species $O$ and an inert, with oxidizer mass fraction $Y_{O,L}$ and zero fuel. There is no bulk flow in the $x$-direction and the density and binary diffusivity are constant and equal for all species, with $\\rho=\\text{const}$ and $D=\\text{const}$. The overall, single-step, irreversible reaction is\n$$\n\\nu_F F + \\nu_O O \\rightarrow \\text{Products},\n$$\nwith molar masses $W_F$ and $W_O$, and the chemistry is infinitely fast so that fuel and oxidizer do not coexist at any point. Neglect thermal diffusion (Soret effect), pressure diffusion, and body forces.\n\nStarting from the general species conservation equation and the constitutive relation for diffusive fluxes, perform the following:\n\n1) Derive a scalar field that is free of chemical source terms and identify it as the conserved scalar under the stated assumptions. Use only fundamental principles and definitions; do not invoke any pre-derived combustion scalars.\n\n2) Normalize this conserved scalar to define a mixture fraction $Z(x)$ that is unity at $x=0$ and zero at $x=L$, and show that it satisfies a homogeneous diffusion equation with the boundary conditions $Z(0)=1$ and $Z(L)=0$.\n\n3) Using the infinitely fast chemistry (Burke–Schumann) limit, determine the stoichiometric mixture fraction $Z_{\\text{st}}$ in terms of the stoichiometric mass ratio $s = \\dfrac{\\nu_O W_O}{\\nu_F W_F}$ and the boundary compositions $Y_{F,0}$ and $Y_{O,L}$ by enforcing the local stoichiometric proportionality of reactants in the pre-reaction mixture.\n\n4) Hence, obtain a closed-form expression for the flame-sheet location $x_f$ and report it non-dimensionalized as $x_f/L$.\n\nEvaluate your final expression for the following parameter values:\n- $W_F = 16$, $W_O = 32$, $\\nu_F = 1$, $\\nu_O = 2$,\n- $Y_{F,0} = 0.35$, $Y_{O,L} = 0.28$.\n\nRound your final numerical answer for $x_f/L$ to four significant figures. The final answer must be a single real number without units.", "solution": "The problem as stated is a classic formulation of the Burke-Schumann diffusion flame, which is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. The assumptions, while idealizations, are standard for an analytical treatment of non-premixed combustion. The problem is therefore deemed valid and a solution will be provided.\n\nThe analysis begins with the general species conservation equation for a species $i$:\n$$\n\\frac{\\partial(\\rho Y_i)}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v} Y_i) = -\\nabla \\cdot \\mathbf{j}_i + \\dot{\\omega}_i\n$$\nwhere $\\rho$ is the density, $Y_i$ is the mass fraction of species $i$, $\\mathbf{v}$ is the velocity vector, $\\mathbf{j}_i$ is the diffusive mass flux vector of species $i$, and $\\dot{\\omega}_i$ is the mass production rate of species $i$ per unit volume by chemical reaction.\n\nThe problem specifies the following conditions:\n1.  Steady state: $\\frac{\\partial}{\\partial t} = 0$.\n2.  One-dimensional system along the coordinate $x$: $\\nabla \\cdot (\\cdot) \\rightarrow \\frac{d}{dx}(\\cdot)$.\n3.  No bulk flow: $\\mathbf{v} = 0$.\n4.  No thermal diffusion, pressure diffusion, or body forces. The diffusive flux is given by Fick's law: $\\mathbf{j}_i = -\\rho D_i \\nabla Y_i$.\n\nApplying these simplifications, the species conservation equation reduces to:\n$$\n0 = -\\frac{d j_i}{dx} + \\dot{\\omega}_i\n$$\nSubstituting Fick's law in one dimension, $j_i = -\\rho D_i \\frac{dY_i}{dx}$, we obtain:\n$$\n\\frac{d}{dx} \\left(\\rho D_i \\frac{dY_i}{dx}\\right) + \\dot{\\omega}_i = 0\n$$\nThe problem states that density $\\rho$ and binary diffusivity $D$ are constant and equal for all species. Thus, $D_i = D = \\text{const}$. The equation becomes:\n$$\n\\rho D \\frac{d^2 Y_i}{dx^2} + \\dot{\\omega}_i = 0\n$$\nThis ordinary differential equation governs the mass fraction profiles of the fuel ($F$) and oxidizer ($O$):\n$$\n\\rho D \\frac{d^2 Y_F}{dx^2} + \\dot{\\omega}_F = 0 \\quad (1)\n$$\n$$\n\\rho D \\frac{d^2 Y_O}{dx^2} + \\dot{\\omega}_O = 0 \\quad (2)\n$$\nThe reaction is given as $\\nu_F F + \\nu_O O \\rightarrow \\text{Products}$. The mass rates of consumption of fuel and oxidizer are related by their stoichiometric coefficients ($\\nu_i$) and molar masses ($W_i$). Since they are reactants, their production rates are negative. Their consumption rates are proportional:\n$$\n\\frac{-\\dot{\\omega}_F}{\\nu_F W_F} = \\frac{-\\dot{\\omega}_O}{\\nu_O W_O}\n$$\nThis implies a linear relationship between the source terms: $\\dot{\\omega}_O = \\left(\\frac{\\nu_O W_O}{\\nu_F W_F}\\right) \\dot{\\omega}_F$. We define the stoichiometric mass ratio $s$ as:\n$$\ns = \\frac{\\nu_O W_O}{\\nu_F W_F}\n$$\nTherefore, $\\dot{\\omega}_O = s \\dot{\\omega}_F$.\n\n**1) Derivation of the conserved scalar**\n\nTo find a scalar field free of chemical source terms, we seek a linear combination of equations $(1)$ and $(2)$ that eliminates $\\dot{\\omega}_F$ and $\\dot{\\omega}_O$. Let us divide equation $(2)$ by $s$ and subtract it from equation $(1)$:\n$$\n\\left(\\rho D \\frac{d^2 Y_F}{dx^2} + \\dot{\\omega}_F\\right) - \\frac{1}{s}\\left(\\rho D \\frac{d^2 Y_O}{dx^2} + \\dot{\\omega}_O\\right) = 0 - 0 = 0\n$$\nRearranging and using the constant property assumptions:\n$$\n\\rho D \\left(\\frac{d^2 Y_F}{dx^2} - \\frac{1}{s}\\frac{d^2 Y_O}{dx^2}\\right) + \\left(\\dot{\\omega}_F - \\frac{\\dot{\\omega}_O}{s}\\right) = 0\n$$\n$$\n\\rho D \\frac{d^2}{dx^2} \\left(Y_F - \\frac{Y_O}{s}\\right) + \\left(\\dot{\\omega}_F - \\frac{s \\dot{\\omega}_F}{s}\\right) = 0\n$$\n$$\n\\rho D \\frac{d^2}{dx^2} \\left(Y_F - \\frac{Y_O}{s}\\right) + 0 = 0\n$$\nThis leads to the equation:\n$$\n\\frac{d^2}{dx^2} \\left(Y_F - \\frac{Y_O}{s}\\right) = 0\n$$\nThe scalar field $\\beta(x) = Y_F(x) - \\frac{Y_O(x)}{s}$ is therefore the conserved scalar, as its governing equation contains no chemical source term.\n\n**2) Normalization to define the mixture fraction $Z(x)$**\n\nThe mixture fraction $Z(x)$ is defined as a normalized form of the conserved scalar $\\beta(x)$ such that it satisfies the boundary conditions $Z(0) = 1$ and $Z(L) = 0$. A linear transformation of the form $Z(x) = a \\beta(x) + b$ will satisfy a homogeneous diffusion equation if $\\beta(x)$ does. Since $\\frac{d^2\\beta}{dx^2}=0$, it immediately follows that $\\frac{d^2Z}{dx^2} = a \\frac{d^2\\beta}{dx^2} = 0$. The equation for $Z(x)$ is thus:\n$$\n\\frac{d^2 Z}{dx^2} = 0\n$$\nThis is a homogeneous diffusion equation. Its general solution is $Z(x) = C_1 x + C_2$. The constants $C_1$ and $C_2$ are found from the boundary conditions for $Z(x)$:\nAt $x=0$: $Z(0) = C_1(0) + C_2 = C_2 = 1$.\nAt $x=L$: $Z(L) = C_1 L + C_2 = C_1 L + 1 = 0$, which gives $C_1 = -\\frac{1}{L}$.\nThe profile for the mixture fraction is therefore:\n$$\nZ(x) = 1 - \\frac{x}{L}\n$$\n\n**3) Determination of the stoichiometric mixture fraction $Z_{\\text{st}}$**\n\nThe mixture fraction $Z$ physically represents the mass fraction of material at a point $x$ that originated from the fuel stream at $x=0$. The remaining mass fraction, $1-Z$, originated from the oxidizer stream at $x=L$.\nConsider a sample mass $m$ at some location $x$. Before any reaction, the mass of fuel available in this sample would be $m_F^{\\text{unreacted}} = Y_{F,0} \\cdot (m Z)$, and the mass of oxidizer would be $m_O^{\\text{unreacted}} = Y_{O,L} \\cdot (m (1-Z))$.\nThe flame is located where these unreacted masses are in stoichiometric proportion. The stoichiometric mixture fraction $Z_{\\text{st}}$ is the value of $Z$ at this location. By definition of the stoichiometric mass ratio $s$, this condition is:\n$$\n\\frac{m_O^{\\text{unreacted}}}{m_F^{\\text{unreacted}}} = s\n$$\n$$\n\\frac{Y_{O,L} m(1-Z_{\\text{st}})}{Y_{F,0} m Z_{\\text{st}}} = s\n$$\nSolving for $Z_{\\text{st}}$:\n$$\nY_{O,L}(1-Z_{\\text{st}}) = s Y_{F,0} Z_{\\text{st}}\n$$\n$$\nY_{O,L} = s Y_{F,0} Z_{\\text{st}} + Y_{O,L} Z_{\\text{st}} = (s Y_{F,0} + Y_{O,L}) Z_{\\text{st}}\n$$\n$$\nZ_{\\text{st}} = \\frac{Y_{O,L}}{s Y_{F,0} + Y_{O,L}}\n$$\n\n**4) Expression for the flame-sheet location $x_f/L$ and its evaluation**\n\nThe infinitely fast chemistry assumption implies that fuel and oxidizer cannot coexist. The flame is an infinitesimally thin sheet at a location $x_f$ where both $Y_F(x_f) = 0$ and $Y_O(x_f) = 0$. At this location, the mixture fraction has the stoichiometric value, so $Z(x_f) = Z_{\\text{st}}$.\nUsing the derived expression for $Z(x)$:\n$$\nZ(x_f) = 1 - \\frac{x_f}{L}\n$$\nEquating this with the expression for $Z_{\\text{st}}$:\n$$\n1 - \\frac{x_f}{L} = \\frac{Y_{O,L}}{s Y_{F,0} + Y_{O,L}}\n$$\nNow, we solve for the non-dimensional flame location $x_f/L$:\n$$\n\\frac{x_f}{L} = 1 - \\frac{Y_{O,L}}{s Y_{F,0} + Y_{O,L}} = \\frac{(s Y_{F,0} + Y_{O,L}) - Y_{O,L}}{s Y_{F,0} + Y_{O,L}}\n$$\n$$\n\\frac{x_f}{L} = \\frac{s Y_{F,0}}{s Y_{F,0} + Y_{O,L}}\n$$\nThis is the closed-form expression for the flame-sheet location.\n\nFinally, we evaluate this expression for the given parameter values:\n- $W_F = 16$, $W_O = 32$, $\\nu_F = 1$, $\\nu_O = 2$.\n- $Y_{F,0} = 0.35$, $Y_{O,L} = 0.28$.\n\nFirst, calculate the stoichiometric mass ratio $s$:\n$$\ns = \\frac{\\nu_O W_O}{\\nu_F W_F} = \\frac{2 \\cdot 32}{1 \\cdot 16} = \\frac{64}{16} = 4\n$$\nNow, substitute the values into the expression for $x_f/L$:\n$$\n\\frac{x_f}{L} = \\frac{4 \\cdot (0.35)}{4 \\cdot (0.35) + 0.28} = \\frac{1.4}{1.4 + 0.28} = \\frac{1.4}{1.68}\n$$\nThe numerical value is:\n$$\n\\frac{x_f}{L} = \\frac{140}{168} = \\frac{5}{6} = 0.833333...\n$$\nRounding to four significant figures, the result is $0.8333$.", "answer": "$$\\boxed{0.8333}$$", "id": "2523783"}, {"introduction": "While analytical solutions are invaluable, most real-world problems require numerical methods, which come with their own set of challenges. This practice explores a critical pitfall in computational transport phenomena: the potential for numerical schemes to produce unphysical results, such as negative concentrations. By analyzing a simple diffusion problem, you will diagnose the cause of this instability and derive the mathematical condition required to ensure your simulation remains physically meaningful [@problem_id:2523742].", "problem": "A one-dimensional species transport problem is posed on the interval $x \\in [0,L]$ with molecular diffusion only. The species concentration $c(x,t)$ obeys local conservation of mass and the Fickian constitutive relation for the diffusive flux. Initially, the concentration is nonnegative everywhere, with a sharp step near the left boundary: $c(x,0) \\ge 0$, $c(0,t)=c_{0}>0$, and $c(L,t)=0$. Consider a uniform grid of spacing $\\Delta x$ and an explicit-in-time, centered-in-space finite-volume update for $c$ at interior nodes. Let the diffusivity be $D>0$ constant. You are told that, at early times when the gradient near $x=0$ is very steep, the explicit computation yields $c<0$ at some interior nodes, even though all initial and boundary values are nonnegative.\n\nUsing only (i) the differential species balance $\\partial c/\\partial t + \\nabla \\cdot \\boldsymbol{J} = 0$ applied to a one-dimensional control volume and (ii) Fick’s law $\\boldsymbol{J}_{d} = -D \\nabla c$ with constant $D$, reason from first principles why such negative values can arise in an explicit scheme under steep gradients. In your reasoning, identify the non-dimensional grouping formed by $(D,\\Delta t,\\Delta x)$ that controls whether the explicit update is a convex combination of neighboring values. For the specific values $L=1\\,\\mathrm{mm}$, $\\Delta x=20\\,\\mu\\mathrm{m}$, $D=1\\times 10^{-9}\\,\\mathrm{m^{2}/s}$, and a chosen time step $\\Delta t=0.5\\,\\mathrm{s}$, evaluate this non-dimensional number and state whether the update is a convex combination. Then, select the option that best explains the appearance of negative concentrations and correctly suggests a boundedness-preserving alternative.\n\nOptions:\nA. Negative concentrations arise because, for sufficiently large $\\frac{D\\Delta t}{\\Delta x^{2}}$, the explicit update ceases to be a convex combination of nonnegative neighbor values; with steep gradients the discrete Laplacian is large, and the forward Euler step overshoots below zero. A boundedness-preserving alternative is to either enforce $\\frac{D\\Delta t}{\\Delta x^{2}} \\le 1/2$ so that the explicit weights remain nonnegative, or to use a fully implicit backward-Euler diffusion step whose coefficient matrix is an $M$-matrix satisfying a discrete maximum principle for any $\\Delta t$.\nB. Negative concentrations indicate that Fick’s law fails at high gradients and violates the second law; replacing it with a nonlinear constitutive relation $J=-D(c)\\,\\partial c/\\partial x$ with $D(c)$ increasing in $c$ unconditionally restores positivity for explicit schemes at any $\\Delta t$.\nC. The observed negativity is due solely to floating-point round-off; using double precision arithmetic eliminates it without changing the discretization or time step.\nD. Central differencing in space combined with a leapfrog time integrator for diffusion is unconditionally non-oscillatory and preserves nonnegativity for any $\\Delta t$; thus switching to leapfrog time stepping resolves the issue without changing $\\Delta t$ or the spatial stencil.", "solution": "The problem statement will be validated before a solution is attempted.\n\n**Step 1: Extract Givens**\n- **Domain:** One dimension, $x \\in [0,L]$.\n- **Physical Process:** Molecular diffusion only.\n- **Governing Equation:** Differential species balance, $\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\boldsymbol{J} = 0$.\n- **Constitutive Relation:** Fick's law, $\\boldsymbol{J}_{d} = -D \\nabla c$.\n- **Diffusivity:** $D>0$, constant.\n- **Initial Condition:** $c(x,0) \\ge 0$.\n- **Boundary Conditions:** $c(0,t)=c_{0}>0$, $c(L,t)=0$.\n- **Discretization:** Uniform grid with spacing $\\Delta x$. Explicit-in-time, centered-in-space finite-volume update for interior nodes.\n- **Observation:** For steep gradients, the computation yields $c<0$ at some interior nodes.\n- **Given Values:** $L=1\\,\\mathrm{mm}$, $\\Delta x=20\\,\\mu\\mathrm{m}$, $D=1\\times 10^{-9}\\,\\mathrm{m^{2}/s}$, $\\Delta t=0.5\\,\\mathrm{s}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem describes the one-dimensional diffusion equation and its numerical solution using the Forward-Time Centered-Space (FTCS) finite difference/volume method. The appearance of non-physical negative concentrations is a well-known phenomenon resulting from the conditional stability of this explicit scheme. The problem asks for a first-principles explanation of this numerical instability, the identification of the controlling non-dimensional parameter, and an evaluation based on given data.\n\n- **Scientific Grounding:** The problem is firmly grounded in the fields of heat and mass transfer and numerical analysis of partial differential equations. The diffusion equation, Fick's law, and the FTCS scheme are all standard, well-established concepts. The issue of numerical stability is a cornerstone of computational physics and engineering.\n- **Well-Posedness:** The underlying physical problem is a well-posed parabolic PDE. The numerical question is also well-posed, asking for the derivation of a known stability condition. A unique and meaningful answer exists.\n- **Objectivity:** The problem is stated using precise, objective, and technical language, free from ambiguity or subjective claims.\n\nThe problem statement has no scientific or factual unsoundness, is formalizable, self-contained, and poses a verifiable question. The provided data are physically consistent. Therefore, the problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Derivation from First Principles**\n\nThe species conservation equation in one dimension is:\n$$ \\frac{\\partial c}{\\partial t} + \\frac{\\partial J}{\\partial x} = 0 $$\nwhere $c(x,t)$ is the species concentration and $J(x,t)$ is the species flux. With Fick's law for diffusion, $J = -D \\frac{\\partial c}{\\partial x}$, and a constant diffusivity $D$, the conservation equation becomes the standard diffusion equation:\n$$ \\frac{\\partial c}{\\partial t} = D \\frac{\\partial^2 c}{\\partial x^2} $$\nWe now discretize this equation using a finite-volume approach on a uniform grid with spacing $\\Delta x$. Consider a control volume of width $\\Delta x$ centered at node $i$. Integrating the conservation law over this control volume, from $x_{i-1/2}$ to $x_{i+1/2}$:\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial c}{\\partial t} \\,dx = - \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial J}{\\partial x} \\,dx $$\nApproximating the integral on the left and applying the fundamental theorem of calculus on the right gives:\n$$ \\frac{d c_i}{dt} \\Delta x \\approx -[J(x_{i+1/2}) - J(x_{i-1/2})] = J_{i-1/2} - J_{i+1/2} $$\nwhere $c_i$ is the average concentration in the control volume around node $i$. The fluxes at the control volume faces are approximated using a centered difference scheme:\n$$ J_{i+1/2} \\approx -D \\frac{c_{i+1} - c_i}{\\Delta x} $$\n$$ J_{i-1/2} \\approx -D \\frac{c_i - c_{i-1}}{\\Delta x} $$\nSubstituting these fluxes into the semi-discretized equation yields:\n$$ \\frac{d c_i}{dt} \\Delta x = \\left(-D \\frac{c_i - c_{i-1}}{\\Delta x}\\right) - \\left(-D \\frac{c_{i+1} - c_i}{\\Delta x}\\right) = \\frac{D}{\\Delta x} (c_{i+1} - 2c_i + c_{i-1}) $$\n$$ \\frac{d c_i}{dt} = \\frac{D}{(\\Delta x)^2} (c_{i+1} - 2c_i + c_{i-1}) $$\nNow, we apply an explicit-in-time (Forward Euler) discretization to the time derivative, where the superscript $n$ denotes the time level $t=n\\Delta t$:\n$$ \\frac{c_i^{n+1} - c_i^n}{\\Delta t} = \\frac{D}{(\\Delta x)^2} (c_{i+1}^n - 2c_i^n + c_{i-1}^n) $$\nSolving for the concentration at the next time step, $c_i^{n+1}$:\n$$ c_i^{n+1} = c_i^n + \\frac{D \\Delta t}{(\\Delta x)^2} (c_{i+1}^n - 2c_i^n + c_{i-1}^n) $$\nLet us define the non-dimensional grouping $\\alpha = \\frac{D \\Delta t}{(\\Delta x)^2}$. This parameter is the grid Fourier number, or diffusion number. The update equation can be rewritten by grouping terms at the time level $n$:\n$$ c_i^{n+1} = \\alpha c_{i-1}^n + (1 - 2\\alpha) c_i^n + \\alpha c_{i+1}^n $$\nFor the updated value $c_i^{n+1}$ to be guaranteed non-negative when all values at the previous time step ($c_{j}^n$) are non-negative, the update must be a convex combination of its neighbors. This means the coefficients of $c_{j}^n$ in the expression for $c_i^{n+1}$ must be non-negative and sum to $1$. The sum of the coefficients is $\\alpha + (1-2\\alpha) + \\alpha = 1$. The non-negativity condition requires:\n$1.$ $\\alpha \\ge 0$. Since $D>0$, $\\Delta t > 0$, and $(\\Delta x)^2 > 0$, this is always true.\n$2.$ $1 - 2\\alpha \\ge 0$, which implies $2\\alpha \\le 1$, or $\\alpha \\le \\frac{1}{2}$.\n\nTherefore, the non-dimensional grouping that controls whether the update is a convex combination is $\\alpha = \\frac{D \\Delta t}{(\\Delta x)^2}$, and the condition is $\\frac{D \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}$.\n\nIf this condition is violated (i.e., $\\alpha > 1/2$), the coefficient $(1-2\\alpha)$ becomes negative. In a region of steep gradients, it is possible for a node $i$ to have a high concentration $c_i^n > 0$ while its neighbors are near zero, $c_{i-1}^n \\approx 0$ and $c_{i+1}^n \\approx 0$. In this scenario, the update becomes $c_i^{n+1} \\approx (1-2\\alpha)c_i^n$. Since $c_i^n > 0$ and $(1-2\\alpha)  0$, the result $c_i^{n+1}$ will be negative. This numerical \"overshoot\" below zero is a direct consequence of the instability of the explicit scheme when the time step is too large for the given grid spacing and diffusivity.\n\n**Evaluation of the Non-dimensional Number**\nUsing the given values:\n$D = 1 \\times 10^{-9}\\,\\mathrm{m^2/s}$\n$\\Delta t = 0.5\\,\\mathrm{s}$\n$\\Delta x = 20\\,\\mu\\mathrm{m} = 20 \\times 10^{-6}\\,\\mathrm{m} = 2 \\times 10^{-5}\\,\\mathrm{m}$\n\nThe non-dimensional number is calculated as:\n$$ \\alpha = \\frac{D \\Delta t}{(\\Delta x)^2} = \\frac{(1 \\times 10^{-9}\\,\\mathrm{m^2/s}) \\times (0.5\\,\\mathrm{s})}{(2 \\times 10^{-5}\\,\\mathrm{m})^2} = \\frac{0.5 \\times 10^{-9}}{4 \\times 10^{-10}} = \\frac{5 \\times 10^{-10}}{4 \\times 10^{-10}} = \\frac{5}{4} = 1.25 $$\nThe condition for the update to be a convex combination is $\\alpha \\le 1/2$, which is $1.25 \\le 0.5$. This inequality is false. Thus, with the chosen parameters, the update is **not** a convex combination.\n\n**Option-by-Option Analysis**\n\n**A. Negative concentrations arise because, for sufficiently large $\\frac{D\\Delta t}{\\Delta x^{2}}$, the explicit update ceases to be a convex combination of nonnegative neighbor values; with steep gradients the discrete Laplacian is large, and the forward Euler step overshoots below zero. A boundedness-preserving alternative is to either enforce $\\frac{D\\Delta t}{\\Delta x^{2}} \\le 1/2$ so that the explicit weights remain nonnegative, or to use a fully implicit backward-Euler diffusion step whose coefficient matrix is an $M$-matrix satisfying a discrete maximum principle for any $\\Delta t$.**\nThis option correctly identifies the non-dimensional group $\\frac{D \\Delta t}{(\\Delta x)^2}$ and the critical value of $1/2$ for maintaining the convex combination property. It correctly explains the mechanism of overshoot. It also correctly proposes two standard remedies: reducing the time step to satisfy the stability condition for the explicit scheme, or switching to a fully implicit scheme, which is unconditionally stable and positivity-preserving for any $\\Delta t > 0$ due to its M-matrix property. The reasoning is entirely sound.\n**Verdict: Correct**\n\n**B. Negative concentrations indicate that Fick’s law fails at high gradients and violates the second law; replacing it with a nonlinear constitutive relation $J=-D(c)\\,\\partial c/\\partial x$ with $D(c)$ increasing in $c$ unconditionally restores positivity for explicit schemes at any $\\Delta t$.**\nThis option incorrectly blames the physical model (Fick's law) for a numerical artifact. The diffusion PDE itself guarantees non-negativity. The proposed \"solution\" of using a nonlinear diffusivity does not remove the conditional stability of an explicit time-stepping scheme. The claim that this change \"unconditionally restores positivity... at any $\\Delta t$\" is false.\n**Verdict: Incorrect**\n\n**C. The observed negativity is due solely to floating-point round-off; using double precision arithmetic eliminates it without changing the discretization or time step.**\nThis option confuses stability error with round-off error. The negative values arise from the amplification of errors inherent to the unstable numerical scheme, resulting in values that can be orders of magnitude different from zero. This is a truncation error issue, not a precision issue. Switching from single to double precision will not stabilize a fundamentally unstable scheme.\n**Verdict: Incorrect**\n\n**D. Central differencing in space combined with a leapfrog time integrator for diffusion is unconditionally non-oscillatory and preserves non-negativity for any $\\Delta t$; thus switching to leapfrog time stepping resolves the issue without changing $\\Delta t$ or the spatial stencil.**\nThis option suggests using the leapfrog scheme for time integration. The leapfrog scheme ($\\frac{c^{n+1}-c^{n-1}}{2\\Delta t} = \\dots$) is known to be unconditionally unstable when applied to the diffusion equation. It is suitable for hyperbolic equations (like the wave equation) but not for parabolic equations. The claim that it is \"unconditionally non-oscillatory\" for diffusion is the opposite of the truth.\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "2523742"}]}