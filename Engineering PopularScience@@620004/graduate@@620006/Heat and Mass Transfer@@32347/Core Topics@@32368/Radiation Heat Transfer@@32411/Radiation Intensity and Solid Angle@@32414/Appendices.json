{"hands_on_practices": [{"introduction": "Mastering the concept of solid angle begins with its fundamental geometric definition. This first practice problem challenges you to derive the solid angle subtended by a simple circular disk from first principles. By calculating both the exact value through integration and the common far-field approximation, you will develop a concrete understanding of when and why simple models are valid, and how to quantify their error ([@problem_id:2517646]).", "problem": "A circular disk of radius $a$ lies in the plane $z=0$ with its center at the origin. A point detector is located on the symmetry axis at $(0,0,z)$ with $z>0$. Using only the fundamental definition of solid angle as projected area on the unit sphere, namely that an elemental solid angle is $d\\omega = dA_{n}/r^{2}$ where $dA_{n}$ is the projection of the elemental area $dA$ normal to the line of sight and $r$ is the distance from the detector to the elemental area, derive by direct integration over the disk the exact total solid angle $\\Omega_{\\text{exact}}(a,z)$ subtended by the disk at the detector. Then obtain the far-field approximation $\\Omega_{\\text{ff}}(a,z)$ by assuming the disk is optically small as seen from the detector (large $z$ relative to $a$) and applying the same fundamental definition consistently under this approximation. Finally, define the relative error as $\\varepsilon(a/z) = \\left(\\Omega_{\\text{ff}} - \\Omega_{\\text{exact}}\\right)/\\Omega_{\\text{exact}}$ and determine its leading nonzero term as an explicit asymptotic expression in powers of the small parameter $a/z$.\n\nExpress all solid angles in steradians (radians for angles). Report your final answer as a row matrix containing, in order, $\\Omega_{\\text{exact}}(a,z)$, $\\Omega_{\\text{ff}}(a,z)$, and the leading-order asymptotic expression for $\\varepsilon(a/z)$ as $a/z \\to 0$.", "solution": "The problem as stated is well-defined, scientifically grounded, and admits a unique, stable solution. We will proceed with the derivation by direct integration as per the instructions.\n\nThe problem requires the calculation of the solid angle $\\Omega$ subtended by a circular disk of radius $a$ at an axial point detector located at a distance $z$. The disk lies in the plane $z=0$, centered at the origin $(0,0,0)$. The detector is at $(0,0,z)$ where $z>0$. The derivation must start from the fundamental definition of an elemental solid angle $d\\omega$:\n$$d\\omega = \\frac{dA_n}{r^2}$$\nwhere $dA_n$ is the projection of an elemental area $dA$ of the surface normal to the line of sight, and $r$ is the distance from the detector to $dA$.\n\nWe establish a cylindrical coordinate system $(\\rho, \\phi, z)$. A point on the disk is described by coordinates $(\\rho \\cos\\phi, \\rho \\sin\\phi, 0)$ where $0 \\le \\rho \\le a$ and $0 \\le \\phi < 2\\pi$. The elemental area on the disk is $dA = \\rho \\, d\\rho \\, d\\phi$.\n\nThe vector from the detector at $(0,0,z)$ to the elemental area $dA$ at $(\\rho \\cos\\phi, \\rho \\sin\\phi, 0)$ is:\n$$\\vec{s} = (\\rho \\cos\\phi, \\rho \\sin\\phi, -z)$$\nThe distance $r$ is the magnitude of this vector:\n$$r = |\\vec{s}| = \\sqrt{(\\rho \\cos\\phi)^2 + (\\rho \\sin\\phi)^2 + (-z)^2} = \\sqrt{\\rho^2 + z^2}$$\nThe projected area $dA_n$ is given by $dA_n = dA \\cos\\psi$, where $\\psi$ is the angle between the normal to the surface element $dA$ and the line-of-sight vector $\\vec{s}$. The normal vector to the disk, which lies in the $z=0$ plane, is $\\vec{n} = \\hat{k} = (0,0,1)$. The angle $\\psi$ is found from the dot product:\n$$\\cos\\psi = \\frac{|\\vec{s} \\cdot \\vec{n}|}{|\\vec{s}| |\\vec{n}|} = \\frac{|(\\rho \\cos\\phi, \\rho \\sin\\phi, -z) \\cdot (0,0,1)|}{\\sqrt{\\rho^2 + z^2} \\cdot 1} = \\frac{|-z|}{\\sqrt{\\rho^2 + z^2}} = \\frac{z}{\\sqrt{\\rho^2 + z^2}}$$\nsince $z>0$.\n\nThe elemental solid angle is therefore:\n$$d\\omega = \\frac{dA_n}{r^2} = \\frac{(dA) \\cos\\psi}{r^2} = \\frac{(\\rho \\, d\\rho \\, d\\phi) \\left(\\frac{z}{\\sqrt{\\rho^2+z^2}}\\right)}{(\\sqrt{\\rho^2+z^2})^2} = \\frac{z \\rho}{(\\rho^2+z^2)^{3/2}} \\, d\\rho \\, d\\phi$$\n\n**1. Exact Solid Angle $\\Omega_{\\text{exact}}(a,z)$**\n\nTo find the total solid angle $\\Omega_{\\text{exact}}$, we integrate $d\\omega$ over the entire area of the disk. The limits of integration are $\\rho$ from $0$ to $a$ and $\\phi$ from $0$ to $2\\pi$.\n$$\\Omega_{\\text{exact}} = \\int_{0}^{2\\pi} \\int_{0}^{a} \\frac{z \\rho}{(\\rho^2+z^2)^{3/2}} \\, d\\rho \\, d\\phi$$\nSince the integrand is independent of $\\phi$, the integration with respect to $\\phi$ yields a factor of $2\\pi$:\n$$\\Omega_{\\text{exact}} = 2\\pi z \\int_{0}^{a} \\frac{\\rho}{(\\rho^2+z^2)^{3/2}} \\, d\\rho$$\nTo evaluate the remaining integral, we use the substitution $u = \\rho^2+z^2$, so $du = 2\\rho \\, d\\rho$. The integral becomes:\n$$\\int \\frac{\\rho}{(\\rho^2+z^2)^{3/2}} \\, d\\rho = \\frac{1}{2} \\int u^{-3/2} \\, du = \\frac{1}{2} \\frac{u^{-1/2}}{-1/2} = -u^{-1/2} = -\\frac{1}{\\sqrt{\\rho^2+z^2}}$$\nEvaluating the definite integral from $\\rho=0$ to $\\rho=a$:\n$$\\int_{0}^{a} \\frac{\\rho}{(\\rho^2+z^2)^{3/2}} \\, d\\rho = \\left[ -\\frac{1}{\\sqrt{\\rho^2+z^2}} \\right]_{0}^{a} = \\left(-\\frac{1}{\\sqrt{a^2+z^2}}\\right) - \\left(-\\frac{1}{\\sqrt{0^2+z^2}}\\right) = \\frac{1}{z} - \\frac{1}{\\sqrt{a^2+z^2}}$$\nSubstituting this result back into the expression for $\\Omega_{\\text{exact}}$:\n$$\\Omega_{\\text{exact}}(a,z) = 2\\pi z \\left(\\frac{1}{z} - \\frac{1}{\\sqrt{a^2+z^2}}\\right) = 2\\pi \\left(1 - \\frac{z}{\\sqrt{a^2+z^2}}\\right)$$\n\n**2. Far-Field Approximation $\\Omega_{\\text{ff}}(a,z)$**\n\nIn the far-field limit, the detector is far from the disk, so $z \\gg a$. This implies that for any point on the disk, $\\rho \\le a \\ll z$. Under this approximation:\n\\begin{itemize}\n    \\item The distance $r = \\sqrt{\\rho^2+z^2}$ is approximately constant and equal to $z$.\n    \\item The projection factor $\\cos\\psi = \\frac{z}{\\sqrt{\\rho^2+z^2}}$ is approximately $\\frac{z}{\\sqrt{0+z^2}} = 1$.\n\\end{itemize}\nApplying these approximations to the fundamental definition $\\Omega = \\int \\frac{dA \\cos\\psi}{r^2}$:\n$$\\Omega_{\\text{ff}} \\approx \\int_{\\text{disk}} \\frac{dA \\cdot 1}{z^2} = \\frac{1}{z^2} \\int_{\\text{disk}} dA$$\nThe integral of $dA$ over the disk is its total area, $A = \\pi a^2$. Therefore, the far-field approximation is:\n$$\\Omega_{\\text{ff}}(a,z) = \\frac{\\pi a^2}{z^2}$$\n\n**3. Relative Error $\\varepsilon(a/z)$**\n\nThe relative error is defined as $\\varepsilon(a/z) = \\frac{\\Omega_{\\text{ff}} - \\Omega_{\\text{exact}}}{\\Omega_{\\text{exact}}}$. We seek the leading non-zero term of this expression for the small parameter $x = a/z \\to 0$.\n\nFirst, we rewrite $\\Omega_{\\text{exact}}$ in terms of $x$:\n$$\\Omega_{\\text{exact}} = 2\\pi \\left(1 - \\frac{z}{\\sqrt{a^2+z^2}}\\right) = 2\\pi \\left(1 - \\frac{1}{\\sqrt{(a/z)^2+1}}\\right) = 2\\pi \\left(1 - (1+x^2)^{-1/2}\\right)$$\nWe use the binomial series expansion for $(1+u)^{\\alpha}$ where $u=x^2$ and $\\alpha=-1/2$:\n$$(1+x^2)^{-1/2} = 1 - \\frac{1}{2}x^2 + \\frac{(-1/2)(-3/2)}{2!}(x^2)^2 + O((x^2)^3) = 1 - \\frac{1}{2}x^2 + \\frac{3}{8}x^4 + O(x^6)$$\nSubstituting this into the expression for $\\Omega_{\\text{exact}}$:\n$$\\Omega_{\\text{exact}} = 2\\pi \\left(1 - \\left[1 - \\frac{1}{2}x^2 + \\frac{3}{8}x^4 - \\dots\\right]\\right) = 2\\pi \\left(\\frac{1}{2}x^2 - \\frac{3}{8}x^4 + \\dots\\right) = \\pi x^2 - \\frac{3\\pi}{4}x^4 + O(x^6)$$\nThe far-field expression is $\\Omega_{\\text{ff}} = \\pi (a/z)^2 = \\pi x^2$.\n\nNow, we compute the relative error:\n$$\\varepsilon(x) = \\frac{\\Omega_{\\text{ff}}}{\\Omega_{\\text{exact}}} - 1 = \\frac{\\pi x^2}{\\pi x^2 - \\frac{3\\pi}{4}x^4 + \\dots} - 1 = \\frac{1}{1 - \\frac{3}{4}x^2 + \\dots} - 1$$\nUsing the geometric series expansion $(1-v)^{-1} = 1 + v + v^2 + \\dots$ with $v = \\frac{3}{4}x^2$:\n$$\\varepsilon(x) = \\left(1 + \\frac{3}{4}x^2 + O(x^4)\\right) - 1 = \\frac{3}{4}x^2 + O(x^4)$$\nThe leading nonzero term of the relative error is $\\frac{3}{4}x^2$. Replacing $x$ with $a/z$, we obtain the asymptotic expression:\n$$\\varepsilon(a/z) \\sim \\frac{3}{4}\\left(\\frac{a}{z}\\right)^2 \\quad \\text{as } a/z \\to 0$$\n\nThe three required quantities are thus determined.", "answer": "$$ \\boxed{ \\begin{pmatrix} 2\\pi \\left( 1 - \\frac{z}{\\sqrt{a^2+z^2}} \\right) & \\frac{\\pi a^2}{z^2} & \\frac{3}{4} \\left(\\frac{a}{z}\\right)^2 \\end{pmatrix} } $$", "id": "2517646"}, {"introduction": "Real-world surfaces often exhibit directional radiation properties that deviate from the ideal Lambertian model. This exercise moves from pure geometry to physical radiometry, exploring the consequences of such behavior ([@problem_id:2517648]). You will analyze a surface with a specified non-Lambertian emissivity to understand how directional effects can lead to different errors when evaluating integrated hemispherical properties versus targeted, on-axis measurements, a crucial distinction in experimental design and data interpretation.", "problem": "An opaque, isothermal, grey surface patch of area $A_{s}$ emits thermal radiation into vacuum. Its microstructure results in a small, axisymmetric, specular-like angular departure from ideal Lambertian behavior that can be modeled by a perturbation of the bidirectional reflectance distribution function (BRDF). By Kirchhoff’s law of thermal radiation, the bidirectional emissivity equals the bidirectional absorptivity for this isothermal surface in equilibrium, so the angular emissivity can be written as\n$$\\varepsilon(\\theta)=\\varepsilon_{L}\\left[1+\\eta \\cos^{2}\\theta\\right],$$\nwhere $\\varepsilon_{L}\\in(0,1)$ is the Lambertian baseline emissivity, $\\eta$ is a dimensionless perturbation amplitude with $|\\eta|<1$ describing a moderately specular enhancement toward the surface normal, and $\\theta\\in[0,\\pi/2]$ is the emission zenith angle (in radians) measured from the surface normal.\n\nLet $L_{b}(T)$ denote the blackbody radiance of the surface at temperature $T$ integrated over all wavelengths (a constant with respect to direction), so that the directional emitted radiance of the surface is $L_{o}(\\theta)=\\varepsilon(\\theta)\\,L_{b}(T)$. A common engineering approximation replaces the actual $\\varepsilon(\\theta)$ with the Lambertian constant $\\varepsilon_{L}$.\n\nDefine the hemispherical emissive power of the patch,\n$$E=\\int_{\\Omega^{+}} L_{o}(\\theta)\\,\\cos\\theta\\,\\mathrm{d}\\omega,$$\nwhere $\\Omega^{+}$ is the outward hemisphere and $\\mathrm{d}\\omega$ is the differential solid angle. Let $E_{L}$ denote the value obtained under the Lambertian approximation $\\varepsilon(\\theta)\\equiv\\varepsilon_{L}$, and let $\\Delta_{E}=\\left(E-E_{L}\\right)/E_{L}$ be the relative deviation in $E$ due to the non-Lambertian perturbation.\n\nNow, place a small planar detector, of negligible aperture compared to the source’s apparent size, on the surface normal axis at a distance $R=10.0\\,\\mathrm{m}$ from the patch, with its normal aligned to point directly at the patch. Assume the patch area is $A_{s}=1.00\\times 10^{-4}\\,\\mathrm{m}^{2}$, and the far-field, small-angle conditions apply so that the patch subtends a solid angle $\\Omega_{s}\\approx A_{s}/R^{2}$ at the detector and the incoming rays are effectively normal to the detector. The irradiance at the detector is\n$$G=\\int_{\\Omega_{s}} L_{o}(\\theta)\\,\\cos\\theta_{d}\\,\\mathrm{d}\\omega,$$\nwhere $\\theta_{d}$ is the incidence angle relative to the detector normal (in radians). Under the same far-field, on-axis conditions, use radiance invariance and appropriate small-angle approximations to express $G$ in terms of the on-axis emitted radiance. Let $G_{L}$ be the value computed under the Lambertian approximation, and define the relative deviation $\\Delta_{G}=\\left(G-G_{L}\\right)/G_{L}$.\n\nFor the numerical parameters $\\varepsilon_{L}=0.85$, $\\eta=0.20$, $A_{s}=1.00\\times 10^{-4}\\,\\mathrm{m}^{2}$, and $R=10.0\\,\\mathrm{m}$, compute the single dimensionless quantity\n$$\\kappa=\\frac{\\Delta_{G}}{\\Delta_{E}}.$$\nYou must start from fundamental definitions of radiance, solid angle, and hemispherical integration. Do not assume any result that presupposes Lambertian behavior. Round your final answer for $\\kappa$ to four significant figures. Express the answer as a pure number with no units, and take all angles in radians.", "solution": "The problem requires the calculation of the a dimensionless quantity $\\kappa$, defined as the ratio of two relative deviations, $\\Delta_{G}$ and $\\Delta_{E}$. We will first calculate the relative deviation in hemispherical emissive power, $\\Delta_{E}$, and then the relative deviation in detector irradiance, $\\Delta_{G}$.\n\nFirst, we determine the hemispherical emissive power $E$. By definition, it is the integral of the directional emitted radiance $L_{o}(\\theta)$ multiplied by the cosine of the emission angle $\\theta$, over the outward hemisphere $\\Omega^{+}$:\n$$E = \\int_{\\Omega^{+}} L_{o}(\\theta)\\,\\cos\\theta\\,\\mathrm{d}\\omega$$\nThe directional emitted radiance is given as $L_{o}(\\theta) = \\varepsilon(\\theta)L_{b}(T)$, with the directional emissivity $\\varepsilon(\\theta) = \\varepsilon_{L}[1+\\eta \\cos^{2}\\theta]$. The term $L_{b}(T)$ is the blackbody radiance, a constant with respect to direction. The differential solid angle in spherical coordinates is $\\mathrm{d}\\omega = \\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$, where $\\theta$ is the zenith angle from $0$ to $\\pi/2$ and $\\phi$ is the azimuthal angle from $0$ to $2\\pi$.\n\nSubstituting these expressions into the integral for $E$:\n$$E = \\int_{0}^{2\\pi} \\int_{0}^{\\pi/2} \\left( \\varepsilon_{L}[1+\\eta \\cos^{2}\\theta] L_{b}(T) \\right) \\cos\\theta \\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$$\nThe integrand is independent of $\\phi$, so the integration over $\\phi$ yields a factor of $2\\pi$. The constants $\\varepsilon_{L}$ and $L_{b}(T)$ can be factored out:\n$$E = 2\\pi \\varepsilon_{L} L_{b}(T) \\int_{0}^{\\pi/2} (1+\\eta \\cos^{2}\\theta) \\cos\\theta \\sin\\theta\\,\\mathrm{d}\\theta$$\nTo evaluate the integral over $\\theta$, we perform a change of variables. Let $u = \\cos\\theta$, which implies $\\mathrm{d}u = -\\sin\\theta\\,\\mathrm{d}\\theta$. The limits of integration change from $\\theta=0$ to $u=1$ and from $\\theta=\\pi/2$ to $u=0$.\n$$E = 2\\pi \\varepsilon_{L} L_{b}(T) \\int_{1}^{0} (1+\\eta u^{2}) u (-\\mathrm{d}u) = 2\\pi \\varepsilon_{L} L_{b}(T) \\int_{0}^{1} (u + \\eta u^{3})\\,\\mathrm{d}u$$\nPerforming the integration with respect to $u$:\n$$E = 2\\pi \\varepsilon_{L} L_{b}(T) \\left[ \\frac{u^{2}}{2} + \\frac{\\eta u^{4}}{4} \\right]_{0}^{1} = 2\\pi \\varepsilon_{L} L_{b}(T) \\left( \\frac{1}{2} + \\frac{\\eta}{4} \\right)$$\n$$E = \\pi \\varepsilon_{L} L_{b}(T) \\left( 1 + \\frac{\\eta}{2} \\right)$$\nThe hemispherical emissive power under the Lambertian approximation, $E_{L}$, corresponds to using $\\varepsilon(\\theta) \\equiv \\varepsilon_{L}$, which is equivalent to setting the perturbation amplitude $\\eta=0$ in our derived expression for $E$.\n$$E_{L} = \\pi \\varepsilon_{L} L_{b}(T) \\left( 1 + \\frac{0}{2} \\right) = \\pi \\varepsilon_{L} L_{b}(T)$$\nNow, we can compute the relative deviation $\\Delta_{E}$:\n$$\\Delta_{E} = \\frac{E-E_{L}}{E_{L}} = \\frac{\\pi \\varepsilon_{L} L_{b}(T) (1 + \\eta/2) - \\pi \\varepsilon_{L} L_{b}(T)}{\\pi \\varepsilon_{L} L_{b}(T)} = \\frac{1 + \\eta/2 - 1}{1} = \\frac{\\eta}{2}$$\n\nNext, we evaluate the irradiance $G$ at the detector. The detector is located on the surface normal axis at a large distance $R$, and the source area $A_{s}$ is small. These are the far-field, small-angle conditions. The irradiance is given by:\n$$G = \\int_{\\Omega_{s}} L_{o}(\\theta)\\,\\cos\\theta_{d}\\,\\mathrm{d}\\omega$$\nwhere $\\Omega_{s}$ is the small solid angle subtended by the source at the detector, and $\\theta_{d}$ is the incidence angle at the detector. Due to the on-axis and parallel-plane geometry, the emission angle $\\theta$ for a ray is equal to its incidence angle $\\theta_{d}$. Thus, $\\cos\\theta_d = \\cos\\theta$.\n\nThe problem specifies to use small-angle approximations and to express $G$ in terms of the on-axis emitted radiance. For all rays reaching the detector from the small patch, the angle $\\theta$ is very close to $0$. This justifies two approximations:\n1. The directional emitted radiance $L_{o}(\\theta)$ can be approximated as constant over the small solid angle $\\Omega_{s}$ and equal to its on-axis value, $L_{o}(0)$.\n2. The term $\\cos\\theta_{d}$ can be approximated as $\\cos(0) = 1$, as also suggested by the statement that \"incoming rays are effectively normal to the detector\".\n\nApplying these approximations, the integral for $G$ simplifies:\n$$G \\approx \\int_{\\Omega_{s}} L_{o}(0) \\cdot 1 \\cdot \\mathrm{d}\\omega = L_{o}(0) \\int_{\\Omega_{s}} \\mathrm{d}\\omega = L_{o}(0)\\Omega_{s}$$\nThe on-axis radiance $L_{o}(0)$ is found by setting $\\theta=0$ in the expression for $L_{o}(\\theta)$:\n$$L_{o}(0) = \\varepsilon(0) L_{b}(T) = \\varepsilon_{L}[1+\\eta \\cos^{2}(0)] L_{b}(T) = \\varepsilon_{L}(1+\\eta) L_{b}(T)$$\nThe solid angle is given as $\\Omega_{s} \\approx A_{s}/R^{2}$. Therefore, the irradiance is:\n$$G \\approx \\varepsilon_{L}(1+\\eta) L_{b}(T) \\frac{A_{s}}{R^{2}}$$\nThe irradiance under the Lambertian approximation, $G_{L}$, is found by setting $\\eta=0$:\n$$G_{L} \\approx \\varepsilon_{L}(1+0) L_{b}(T) \\frac{A_{s}}{R^{2}} = \\varepsilon_{L} L_{b}(T) \\frac{A_{s}}{R^{2}}$$\nThe relative deviation $\\Delta_{G}$ is then:\n$$\\Delta_{G} = \\frac{G-G_{L}}{G_{L}} \\approx \\frac{\\varepsilon_{L}(1+\\eta) L_{b}(T) (A_{s}/R^{2}) - \\varepsilon_{L} L_{b}(T) (A_{s}/R^{2})}{\\varepsilon_{L} L_{b}(T) (A_{s}/R^{2})} = \\frac{1+\\eta-1}{1} = \\eta$$\nThe result $\\Delta_G = \\eta$ represents the local, on-axis effect of the emissivity perturbation, while $\\Delta_E = \\eta/2$ represents its hemispherical average.\n\nFinally, we compute the desired quantity $\\kappa$ as the ratio of $\\Delta_{G}$ to $\\Delta_{E}$:\n$$\\kappa = \\frac{\\Delta_{G}}{\\Delta_{E}} = \\frac{\\eta}{\\eta/2} = 2$$\nThis result is a constant, independent of the numerical values provided for $\\varepsilon_{L}$, $\\eta$, $A_{s}$, and $R$. The problem asks for the answer to be rounded to four significant figures.\n\n$$\\kappa = 2.000$$", "answer": "$$\\boxed{2.000}$$", "id": "2517648"}, {"introduction": "While analytical solutions are invaluable for building intuition, many realistic radiation problems require powerful numerical methods. This final practice introduces the Monte Carlo method, a cornerstone of modern computational radiative transfer ([@problem_id:2517698]). You will not only construct a basic estimator but also design an advanced importance sampling scheme, deriving the theoretical variance reduction to see how intelligently guiding the simulation can lead to dramatic gains in efficiency.", "problem": "A planar, black, differential receiver with surface normal along the polar axis is irradiated by a source whose spectral-averaged radiation intensity has the angular dependence $I(\\theta)=I_{0}\\cos^{k}\\theta$ for $\\theta\\in[0,\\pi/2]$ over the upper hemisphere and is zero otherwise, where $\\theta$ is the polar angle from the surface normal and $k>-1$ is a known real parameter. All angles are in radians. The hemispherical radiative heat flux to the receiver is defined from first principles by\n$$\nq=\\int_{\\Omega^{+}} I(\\theta)\\,\\cos\\theta\\,d\\omega,\n$$\nwhere $d\\omega=\\sin\\theta\\,d\\theta\\,d\\varphi$ is the differential solid angle and the integration is over the upper hemisphere $\\Omega^{+}$ ($\\theta\\in[0,\\pi/2]$, $\\varphi\\in[0,2\\pi)$). Consider estimating $q$ using a Monte Carlo (MC) estimator based on random directions $(\\theta,\\varphi)$ drawn from a probability density function over solid angle.\n\n- Define the integrand $h(\\theta,\\varphi)=I(\\theta)\\cos\\theta$ and construct two unbiased MC estimators for $q$:\n  1. Uniform-solid-angle sampling: sample $(\\theta,\\varphi)$ uniformly over the hemisphere.\n  2. An importance sampling scheme that samples directions with a probability density function proportional to the known angular shape of the intensity, i.e., $p(\\theta,\\varphi)\\propto I(\\theta)$ on $\\Omega^{+}$.\n\nFor the importance sampling scheme, derive the normalized sampling density $p(\\theta,\\varphi)$, its marginal in $\\theta$, and an explicit inverse-transform rule to generate $\\theta$ from a uniform random variate on $[0,1]$. For each scheme, derive the per-sample variance of the corresponding unbiased estimator in closed form as a function of $k$ and $I_{0}$. Finally, quantify the variance reduction of the importance sampling scheme relative to uniform-solid-angle sampling by giving the exact ratio of the per-sample variances (uniform divided by importance), simplified to a single analytic expression depending only on $k$. Express the final variance-reduction factor as a closed-form function of $k$ with no units. If you decide to compute any intermediate numerical values, round them only if necessary; the final answer must be an exact expression and not a numerical approximation.", "solution": "The problem concerns the estimation of the hemispherical radiative heat flux $q$ using Monte Carlo integration. The integral is given by\n$$\nq = \\int_{\\Omega^{+}} I(\\theta)\\cos\\theta\\,d\\omega = \\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi/2} (I_0 \\cos^k\\theta) \\cos\\theta \\sin\\theta\\,d\\theta\n$$\nLet us first compute the exact value of $q$. The integrand is independent of $\\varphi$, so the integration over $\\varphi$ yields a factor of $2\\pi$.\n$$\nq = 2\\pi I_0 \\int_{0}^{\\pi/2} \\cos^{k+1}\\theta \\sin\\theta\\,d\\theta\n$$\nWe use the substitution $u = \\cos\\theta$, which implies $du = -\\sin\\theta\\,d\\theta$. The limits of integration change from $\\theta=0 \\to u=1$ and $\\theta=\\pi/2 \\to u=0$.\n$$\nq = 2\\pi I_0 \\int_{1}^{0} u^{k+1} (-du) = 2\\pi I_0 \\int_{0}^{1} u^{k+1}\\,du = 2\\pi I_0 \\left[ \\frac{u^{k+2}}{k+2} \\right]_0^1 = \\frac{2\\pi I_0}{k+2}\n$$\nThis integral is convergent for $k+2 > 0$, i.e., $k > -2$. The problem condition $k>-1$ is stricter and ensures this is well-defined.\n\nThe integrand for the Monte Carlo estimation is $h(\\theta, \\varphi) = I(\\theta)\\cos\\theta = I_0\\cos^{k+1}\\theta$.\nThe general form of an unbiased MC estimator for $q$ using $N$ samples drawn from a probability density function (PDF) $p(\\theta, \\varphi)$ over the solid angle $\\Omega^{+}$ is $\\hat{q}_N = \\frac{1}{N} \\sum_{j=1}^N \\frac{h(\\theta_j, \\varphi_j)}{p(\\theta_j, \\varphi_j)}$. The per-sample variance of this estimator is given by $\\sigma^2 = \\text{Var}\\left[\\frac{h}{p}\\right] = E\\left[\\left(\\frac{h}{p}\\right)^2\\right] - \\left(E\\left[\\frac{h}{p}\\right]\\right)^2$. Since the estimator is unbiased, $E[h/p]=q$, so the variance simplifies to:\n$$\n\\sigma^2 = \\int_{\\Omega^{+}} \\frac{h(\\theta, \\varphi)^2}{p(\\theta, \\varphi)} \\, d\\omega - q^2\n$$\n\n**1. Uniform-Solid-Angle Sampling**\nFor uniform sampling over the hemisphere, the PDF is constant. The total solid angle of the hemisphere is $\\int_{\\Omega^{+}} d\\omega = \\int_0^{2\\pi}d\\varphi \\int_0^{\\pi/2}\\sin\\theta d\\theta = 2\\pi [-\\cos\\theta]_0^{\\pi/2} = 2\\pi$ steradians.\nThe uniform PDF is therefore $p_u(\\theta, \\varphi) = 1/(2\\pi)$.\nThe per-sample estimator is $Y_u = \\frac{h(\\theta, \\varphi)}{p_u(\\theta, \\varphi)} = \\frac{I_0 \\cos^{k+1}\\theta}{1/(2\\pi)} = 2\\pi I_0 \\cos^{k+1}\\theta$.\nThe variance $\\sigma_u^2$ is calculated as $\\sigma_u^2 = E[Y_u^2] - q^2$.\n$$\nE[Y_u^2] = \\int_{\\Omega^{+}} Y_u^2 p_u(\\theta, \\varphi) \\, d\\omega = \\int_{\\Omega^{+}} \\frac{h(\\theta, \\varphi)^2}{p_u(\\theta, \\varphi)} \\, d\\omega\n$$\n$$\nE[Y_u^2] = \\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi/2} \\frac{(I_0 \\cos^{k+1}\\theta)^2}{1/(2\\pi)} \\sin\\theta\\,d\\theta = 2\\pi I_0^2 \\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi/2} \\cos^{2(k+1)}\\theta \\sin\\theta\\,d\\theta\n$$\n$$\nE[Y_u^2] = 4\\pi^2 I_0^2 \\int_{0}^{\\pi/2} \\cos^{2k+2}\\theta \\sin\\theta\\,d\\theta\n$$\nUsing the substitution $u=\\cos\\theta$, we get:\n$$\nE[Y_u^2] = 4\\pi^2 I_0^2 \\int_0^1 u^{2k+2}\\,du = 4\\pi^2 I_0^2 \\left[ \\frac{u^{2k+3}}{2k+3} \\right]_0^1 = \\frac{4\\pi^2 I_0^2}{2k+3}\n$$\nThis requires $2k+3>0$, or $k>-3/2$. The problem condition $k>-1$ satisfies this.\nThe variance is:\n$$\n\\sigma_u^2 = E[Y_u^2] - q^2 = \\frac{4\\pi^2 I_0^2}{2k+3} - \\left(\\frac{2\\pi I_0}{k+2}\\right)^2 = 4\\pi^2 I_0^2 \\left( \\frac{1}{2k+3} - \\frac{1}{(k+2)^2} \\right)\n$$\n$$\n\\sigma_u^2 = 4\\pi^2 I_0^2 \\left( \\frac{(k+2)^2 - (2k+3)}{(2k+3)(k+2)^2} \\right) = 4\\pi^2 I_0^2 \\left( \\frac{k^2+4k+4 - 2k-3}{(2k+3)(k+2)^2} \\right)\n$$\n$$\n\\sigma_u^2 = 4\\pi^2 I_0^2 \\frac{k^2+2k+1}{(2k+3)(k+2)^2} = \\frac{4\\pi^2 I_0^2 (k+1)^2}{(2k+3)(k+2)^2}\n$$\n\n**2. Importance Sampling**\nThe sampling PDF is proportional to the intensity, $p_i(\\theta, \\varphi) \\propto I(\\theta) = I_0 \\cos^k\\theta$.\nLet $p_i(\\theta, \\varphi) = C \\cos^k\\theta$. We find the normalization constant $C$ by requiring $\\int_{\\Omega^{+}} p_i(\\theta, \\varphi) \\,d\\omega = 1$.\n$$\n\\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi/2} C \\cos^k\\theta \\sin\\theta\\,d\\theta = 2\\pi C \\int_{0}^{\\pi/2} \\cos^k\\theta \\sin\\theta\\,d\\theta = 1\n$$\nUsing $u=\\cos\\theta$:\n$$\n2\\pi C \\int_0^1 u^k\\,du = 2\\pi C \\left[ \\frac{u^{k+1}}{k+1} \\right]_0^1 = \\frac{2\\pi C}{k+1} = 1\n$$\nThis requires $k+1>0$, or $k>-1$, which is given. Thus, $C = \\frac{k+1}{2\\pi}$.\nThe normalized PDF is $p_i(\\theta, \\varphi) = \\frac{k+1}{2\\pi} \\cos^k\\theta$.\n\nTo find the marginal PDF for the random variable $\\theta$, we first establish the joint PDF $f(\\theta, \\varphi)$ for the coordinates $(\\theta, \\varphi)$ from the PDF over solid angle $p_i(\\theta, \\varphi)$ via the relation $f(\\theta, \\varphi)\\,d\\theta\\,d\\varphi = p_i(\\theta, \\varphi)\\,d\\omega = p_i(\\theta, \\varphi)\\sin\\theta\\,d\\theta\\,d\\varphi$.\nSo, $f(\\theta, \\varphi) = p_i(\\theta, \\varphi)\\sin\\theta = \\frac{k+1}{2\\pi}\\cos^k\\theta\\sin\\theta$.\nThe marginal PDF for $\\theta$, denoted $f_\\theta(\\theta)$, is obtained by integrating $f(\\theta, \\varphi)$ over $\\varphi$:\n$$\nf_\\theta(\\theta) = \\int_0^{2\\pi} f(\\theta, \\varphi)\\,d\\varphi = \\int_0^{2\\pi} \\frac{k+1}{2\\pi}\\cos^k\\theta\\sin\\theta\\,d\\varphi = (k+1)\\cos^k\\theta\\sin\\theta\n$$\nfor $\\theta \\in [0, \\pi/2]$.\n\nFor inverse-transform sampling, we first compute the cumulative distribution function (CDF) $F_\\theta(\\theta)$:\n$$\nF_\\theta(\\theta) = \\int_0^\\theta f_\\theta(t)\\,dt = \\int_0^\\theta (k+1)\\cos^k t \\sin t\\,dt\n$$\nUsing the substitution $u=\\cos t$, $du=-\\sin t\\,dt$:\n$$\nF_\\theta(\\theta) = (k+1)\\int_{\\cos 0}^{\\cos \\theta} u^k(-du) = (k+1)\\int_{\\cos\\theta}^1 u^k\\,du = (k+1)\\left[\\frac{u^{k+1}}{k+1}\\right]_{\\cos\\theta}^1 = 1 - \\cos^{k+1}\\theta\n$$\nTo generate a random sample of $\\theta$, we set $F_\\theta(\\theta) = R$, where $R$ is a uniform random variate on $[0,1]$.\n$R = 1 - \\cos^{k+1}\\theta \\implies \\cos^{k+1}\\theta = 1-R$. As $1-R$ is also uniformly distributed on $[0,1]$, we can write $\\cos^{k+1}\\theta = R'$, where $R' \\sim U[0,1]$.\nThe explicit inverse-transform rule is $\\theta = \\arccos\\left(R'^{1/(k+1)}\\right)$.\n\nThe per-sample estimator is $Y_i = \\frac{h(\\theta, \\varphi)}{p_i(\\theta, \\varphi)} = \\frac{I_0\\cos^{k+1}\\theta}{\\frac{k+1}{2\\pi}\\cos^k\\theta} = \\frac{2\\pi I_0}{k+1}\\cos\\theta$.\nThe variance $\\sigma_i^2$ is $E[Y_i^2] - q^2$.\n$$\nE[Y_i^2] = \\int_{\\Omega^{+}} \\frac{h(\\theta, \\varphi)^2}{p_i(\\theta, \\varphi)} \\, d\\omega = \\int_{\\Omega^{+}} \\frac{(I_0\\cos^{k+1}\\theta)^2}{\\frac{k+1}{2\\pi}\\cos^k\\theta} \\, d\\omega\n$$\n$$\nE[Y_i^2] = \\frac{2\\pi I_0^2}{k+1} \\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi/2} \\cos^{k+2}\\theta \\sin\\theta\\,d\\theta = \\frac{4\\pi^2 I_0^2}{k+1} \\int_{0}^{\\pi/2} \\cos^{k+2}\\theta \\sin\\theta\\,d\\theta\n$$\nThe integral equals $\\frac{1}{k+3}$ (requires $k>-3$, which is satisfied).\n$$\nE[Y_i^2] = \\frac{4\\pi^2 I_0^2}{(k+1)(k+3)}\n$$\nThe variance is:\n$$\n\\sigma_i^2 = E[Y_i^2] - q^2 = \\frac{4\\pi^2 I_0^2}{(k+1)(k+3)} - \\left(\\frac{2\\pi I_0}{k+2}\\right)^2 = 4\\pi^2 I_0^2 \\left( \\frac{1}{(k+1)(k+3)} - \\frac{1}{(k+2)^2} \\right)\n$$\n$$\n\\sigma_i^2 = 4\\pi^2 I_0^2 \\left( \\frac{(k+2)^2 - (k+1)(k+3)}{(k+1)(k+3)(k+2)^2} \\right) = 4\\pi^2 I_0^2 \\left( \\frac{k^2+4k+4 - (k^2+4k+3)}{(k+1)(k+3)(k+2)^2} \\right)\n$$\n$$\n\\sigma_i^2 = \\frac{4\\pi^2 I_0^2}{(k+1)(k+2)^2(k+3)}\n$$\n\n**3. Variance Reduction Ratio**\nFinally, we compute the ratio of the variances to quantify the effectiveness of the importance sampling scheme.\n$$\n\\frac{\\sigma_u^2}{\\sigma_i^2} = \\frac{\\frac{4\\pi^2 I_0^2 (k+1)^2}{(2k+3)(k+2)^2}}{\\frac{4\\pi^2 I_0^2}{(k+1)(k+2)^2(k+3)}}\n$$\n$$\n\\frac{\\sigma_u^2}{\\sigma_i^2} = \\frac{(k+1)^2}{(2k+3)(k+2)^2} \\cdot \\frac{(k+1)(k+2)^2(k+3)}{1}\n$$\n$$\n\\frac{\\sigma_u^2}{\\sigma_i^2} = \\frac{(k+1)^3(k+3)}{2k+3}\n$$\nThis expression is the complete and final answer for the variance reduction factor. It is valid for $k>-1$, as specified.", "answer": "$$\n\\boxed{\\frac{(k+1)^3(k+3)}{2k+3}}\n$$", "id": "2517698"}]}