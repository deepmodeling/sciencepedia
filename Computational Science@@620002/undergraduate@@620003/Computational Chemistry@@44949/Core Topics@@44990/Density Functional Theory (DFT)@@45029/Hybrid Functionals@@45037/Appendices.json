{"hands_on_practices": [{"introduction": "To understand the rationale behind hybrid functionals, we first address a fundamental flaw in many density functional approximations: the self-interaction error ($SIE$). This exercise provides a rigorous derivation showing how incorporating exact exchange from Hartree-Fock theory can perfectly cancel this spurious self-interaction for any one-electron system. By working through this foundational proof, you will uncover the theoretical justification for the \"hybrid\" approach in DFT [@problem_id:2456401].", "problem": "Consider the hydrogen molecular ion $\\mathrm{H}_{2}^{+}$ within the Born–Oppenheimer approximation at a fixed internuclear separation. This is a one-electron system. Let the electron density be $\\rho(\\mathbf{r})$ and the occupied spin orbital be $\\varphi(\\mathbf{r})$, so that $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$. The classical Coulomb (Hartree) energy is defined by\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\nFor a single Slater determinant, the Hartree–Fock (HF) exchange energy is defined by\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] = -\\frac{1}{2} \\sum_{\\sigma} \\sum_{i,j \\in \\sigma} \\int \\int \\frac{\\varphi_{i\\sigma}^{*}(\\mathbf{r})\\,\\varphi_{j\\sigma}(\\mathbf{r})\\,\\varphi_{j\\sigma}^{*}(\\mathbf{r}')\\,\\varphi_{i\\sigma}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\nConsider a global hybrid exchange–correlation energy of the form\n$$\nE_{xc}^{\\mathrm{hyb}}[\\rho] = \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] + E_{c}^{\\mathrm{DFA}}[\\rho],\n$$\nwhere $\\alpha \\in [0,1]$ is the HF mixing parameter, $E_{x}^{\\mathrm{DFA}}[\\rho]$ is an exchange energy from a given density functional approximation (DFA), and $E_{c}^{\\mathrm{DFA}}[\\rho]$ is a correlation DFA. For a one-electron density, take the exact correlation energy to be zero and assume the adopted correlation DFA respects this limit, so that $E_{c}^{\\mathrm{DFA}}[\\rho] = 0$ for the present system.\n\nImpose the requirement that the total electron–electron interaction contribution for $\\mathrm{H}_{2}^{+}$ be free of self-interaction error, meaning that the sum of the classical Coulomb energy and the hybrid exchange energy vanishes for any admissible one-electron density $\\rho(\\mathbf{r})$:\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0.\n$$\n\nDetermine the value of $\\alpha$ that satisfies this condition for all one-electron densities of $\\mathrm{H}_{2}^{+}$. Express your final answer as a single real number. No units are required. No rounding is necessary.", "solution": "The problem requires finding the value of the Hartree-Fock mixing parameter $\\alpha$ that ensures a global hybrid functional is free of self-interaction error for any one-electron density, such as that of the $\\mathrm{H}_{2}^{+}$ molecular ion. The condition for the total electron-electron interaction contribution to vanish is given as:\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\nwhere it is assumed that the correlation energy $E_{c}^{\\mathrm{DFA}}[\\rho]$ is zero for a one-electron system. This condition must hold for any admissible one-electron density $\\rho(\\mathbf{r})$.\n\nLet the single occupied spin-orbital of the one-electron system be $\\varphi(\\mathbf{r})$. The electron density is therefore $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$. We will now analyze the terms of the given equation for this specific case.\n\nThe classical Coulomb (Hartree) energy, $E_{\\mathrm{H}}[\\rho]$, is defined as:\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\nSubstituting the expression for the one-electron density, we obtain:\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{|\\varphi(\\mathbf{r})|^{2}\\,|\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\nThis term represents the spurious interaction of the electron's charge distribution with itself.\n\nNext, we evaluate the Hartree-Fock (HF) exchange energy, $E_{x}^{\\mathrm{HF}}$. The general definition for a single Slater determinant is:\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] = -\\frac{1}{2} \\sum_{\\sigma} \\sum_{i,j \\in \\sigma} \\int \\int \\frac{\\varphi_{i\\sigma}^{*}(\\mathbf{r})\\,\\varphi_{j\\sigma}(\\mathbf{r})\\,\\varphi_{j\\sigma}^{*}(\\mathbf{r}')\\,\\varphi_{i\\sigma}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\nFor a system with only one electron, the set of occupied orbitals $\\{\\varphi_{i\\sigma}\\}$ contains a single spin-orbital, which we have denoted as $\\varphi(\\mathbf{r})$. Let us assign it to the spin-up channel, $\\sigma=\\uparrow$, with orbital index $i=1$, so $\\varphi_{1\\uparrow}(\\mathbf{r})=\\varphi(\\mathbf{r})$. The sum over $\\sigma$ will have only the $\\uparrow$ contribution. The sums over indices $i$ and $j$ will each have only one term, $i=1$ and $j=1$. The expression for the HF exchange energy therefore collapses to a single term:\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -\\frac{1}{2} \\int \\int \\frac{\\varphi^{*}(\\mathbf{r})\\,\\varphi(\\mathbf{r})\\,\\varphi^{*}(\\mathbf{r}')\\,\\varphi(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\nThis can be rewritten using the fact that $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$:\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -\\frac{1}{2} \\int \\int \\frac{|\\varphi(\\mathbf{r})|^{2}\\,|\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n\nBy comparing the derived expressions for $E_{\\mathrm{H}}[\\rho]$ and $E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}]$ for a one-electron system, we establish the fundamental identity:\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -E_{\\mathrm{H}}[\\rho]\n$$\nThis identity demonstrates that pure Hartree-Fock theory is exactly free of self-interaction error, as the exchange term precisely cancels the unphysical Hartree self-repulsion.\n\nWe now substitute this identity into the problem's defining condition:\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,(-E_{\\mathrm{H}}[\\rho]) + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\nFactoring the terms gives:\n$$\n(1-\\alpha) E_{\\mathrm{H}}[\\rho] + (1-\\alpha) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\n$$\n(1-\\alpha) \\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right) = 0\n$$\nThis equation must hold true for *any* admissible one-electron density $\\rho(\\mathbf{r})$ and for a given, but not specified, density functional approximation $E_{x}^{\\mathrm{DFA}}[\\rho]$. The term $\\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right)$ represents the self-interaction error inherent in the chosen DFA. Common density functional approximations (such as those from the Local Density or Generalized Gradient families) are not exact and are known to exhibit a non-zero self-interaction error, i.e., $E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\neq 0$ for arbitrary one-electron densities.\n\nFor the equality $(1-\\alpha) \\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right) = 0$ to be universally true for any $\\rho(\\mathbf{r})$ where the second factor is generally non-zero, the first factor must be identically zero.\nTherefore, we must impose the condition:\n$$\n1 - \\alpha = 0\n$$\nSolving this simple equation for $\\alpha$ yields the unique solution:\n$$\n\\alpha = 1\n$$\nThis result signifies that for a global hybrid functional to be strictly free from self-interaction error for all one-electron systems, it must incorporate $100\\%$ of the Hartree-Fock exchange and completely exclude the DFA exchange component.", "answer": "$$\n\\boxed{1}\n$$", "id": "2456401"}, {"introduction": "The self-interaction error discussed previously has profound practical consequences, most notably the delocalization error, which results in a spurious curvature in the total energy as a function of electron number. This practice problem uses a clear, quantitative model to demonstrate how the inclusion of exact exchange in hybrid functionals remedies this pathological behavior, leading to a more physically realistic description of electron localization. This illustrates why hybrid functionals are often essential for accurately modeling chemical processes like dissociation and charge transfer [@problem_id:1373539].", "problem": "In Density Functional Theory (DFT), the total energy of a system as a function of the number of electrons, $E(N)$, should ideally be a piecewise linear function with kinks at integer electron numbers. However, many approximate exchange-correlation functionals, such as those based on the Generalized Gradient Approximation (GGA), exhibit a spurious convexity. This \"delocalization error\" artificially favors fractional electron counts on separated fragments. Hybrid functionals, which incorporate a fraction of exact exchange, typically reduce this error.\n\nConsider a single chlorine atom (Cl). For fractional electron numbers in the range $N \\in [17, 18]$, let the number of electrons be represented as $N = 17 + \\delta$, where $\\delta \\in [0, 1]$. We model the total energy as calculated by a GGA functional and a hybrid functional as:\n$$E_{\\text{GGA}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{GGA}}\\delta(1-\\delta)$$\n$$E_{\\text{hyb}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{hyb}}\\delta(1-\\delta)$$\nwhere $E(17)$ and $E(18)$ are the exact total energies of the neutral Cl atom and the $\\text{Cl}^{-}$ anion, respectively. The positive constants $C_{\\text{GGA}}$ and $C_{\\text{hyb}}$ quantify the convexity, or the severity of the delocalization error, for each functional.\n\nThe values for these parameters are given as:\n- Energy of the neutral chlorine atom, $E(17) = -459.642 \\text{ Hartree}$\n- Energy of the chlorine anion, $E(18) = -459.775 \\text{ Hartree}$\n- GGA convexity parameter, $C_{\\text{GGA}} = 0.210 \\text{ Hartree}$\n- Hybrid functional convexity parameter, $C_{\\text{hyb}} = 0.055 \\text{ Hartree}$\n\nNow, consider a system composed of two identical, non-interacting chlorine atoms. If one electron is added to this two-atom system, the correct ground state corresponds to the electron localizing on one atom, forming a [Cl, $\\text{Cl}^-$] pair. However, due to delocalization error, an approximate functional might incorrectly predict a lower energy for a state where the electron is delocalized over both atoms, resulting in a [$\\text{Cl}^{-0.5}$, $\\text{Cl}^{-0.5}$] system.\n\nCalculate the ratio of the spurious delocalization stabilization energy for the GGA functional to that for the hybrid functional. The spurious delocalization stabilization energy is defined as the energy of the delocalized state [$\\text{Cl}^{-0.5}$, $\\text{Cl}^{-0.5}$] minus the energy of the correct localized state [Cl, $\\text{Cl}^-$]. Round your final answer to three significant figures.", "solution": "For a single atom with $N=17+\\delta$, the approximate energy with a given functional characterized by convexity parameter $C$ is\n$$\nE_{\\text{fun}}(17+\\delta)=(1-\\delta)E(17)+\\delta E(18)-C\\,\\delta(1-\\delta).\n$$\nFor two non-interacting chlorine atoms with one extra electron, the localized state [Cl, $\\text{Cl}^-$] has one atom at $\\delta=0$ and the other at $\\delta=1$, so its total energy is\n$$\nE_{\\text{loc}}=E_{\\text{fun}}(17)+E_{\\text{fun}}(18)=E(17)+E(18).\n$$\nThe delocalized state [$\\text{Cl}^{-0.5}$, $\\text{Cl}^{-0.5}$] has each atom at $\\delta=\\frac{1}{2}$, giving per-atom energy\n$$\nE_{\\text{fun}}(17+\\tfrac{1}{2})=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-C\\left(\\tfrac{1}{2}\\right)\\left(1-\\tfrac{1}{2}\\right)=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-\\tfrac{C}{4}.\n$$\nThus the total energy of the delocalized state is\n$$\nE_{\\text{deloc}}=2E_{\\text{fun}}(17+\\tfrac{1}{2})=E(17)+E(18)-\\tfrac{C}{2}.\n$$\nThe spurious delocalization stabilization energy (delocalized minus localized) is therefore\n$$\n\\Delta E_{\\text{fun}}=E_{\\text{deloc}}-E_{\\text{loc}}=-\\tfrac{C}{2}.\n$$\nHence, the ratio of the GGA to hybrid stabilization energies is\n$$\nR=\\frac{\\Delta E_{\\text{GGA}}}{\\Delta E_{\\text{hyb}}}=\\frac{-\\tfrac{C_{\\text{GGA}}}{2}}{-\\tfrac{C_{\\text{hyb}}}{2}}=\\frac{C_{\\text{GGA}}}{C_{\\text{hyb}}}.\n$$\nInserting the given values,\n$$\nR=\\frac{0.210}{0.055}=\\frac{210}{55}=\\frac{42}{11}\\approx 3.81818\\ldots\n$$\nRounded to three significant figures, this is $3.82$.", "answer": "$$\\boxed{3.82}$$", "id": "1373539"}, {"introduction": "While incorporating exact exchange is crucial, the optimal amount is often property-dependent and not a universal constant, which leads to the powerful concept of \"tuning\" a functional for a specific chemical application. In this exercise, you will step into the role of a researcher, using computational data to determine the ideal mixing parameter $\\alpha$ in a custom hybrid functional to accurately reproduce the experimental singlet-triplet gap of a carbene molecule. This task highlights the pragmatic nature of developing and applying hybrid functionals in modern computational chemistry [@problem_id:1373559].", "problem": "In modern Density Functional Theory (DFT), hybrid functionals are widely used for their improved accuracy over pure DFT functionals. A global hybrid functional's exchange-correlation energy, $E_{\\text{xc}}$, is constructed by mixing a fraction, $\\alpha$, of exact Hartree-Fock (HF) exchange, $E_{\\text{x}}^{\\text{HF}}$, with a DFT exchange functional, $E_{\\text{x}}^{\\text{DFT}}$, and adding a DFT correlation functional, $E_{\\text{c}}^{\\text{DFT}}$.\n\nA computational chemist is developing a new custom hybrid functional, whose exchange-correlation energy is given by:\n$$ E_{\\text{xc}}^{\\text{custom}} = \\alpha E_{\\text{x}}^{\\text{HF}} + (1-\\alpha) E_{\\text{x}}^{\\text{PBE}} + E_{\\text{c}}^{\\text{PBE}} $$\nHere, $E_{\\text{x}}^{\\text{PBE}}$ and $E_{\\text{c}}^{\\text{PBE}}$ are the exchange and correlation components of the popular PBE functional. The chemist wants to find the optimal fraction of HF exchange, $\\alpha$, for accurately predicting the singlet-triplet energy gap ($\\Delta E_{\\text{S-T}} = E_{\\text{singlet}} - E_{\\text{triplet}}$) of the methylene carbene molecule ($\\text{CH}_2$).\n\nA highly accurate experimental benchmark for the $\\Delta E_{\\text{S-T}}$ of $\\text{CH}_2$ is known to be $37.8 \\text{ kJ/mol}$. To determine the optimal $\\alpha$, the chemist performs a series of calculations for $\\Delta E_{\\text{S-T}}$ using the custom functional with different values of $\\alpha$. The results are as follows:\n\n- For $\\alpha = 0.10$, the calculated $\\Delta E_{\\text{S-T}}$ is $26.0 \\text{ kJ/mol}$.\n- For $\\alpha = 0.20$, the calculated $\\Delta E_{\\text{S-T}}$ is $32.0 \\text{ kJ/mol}$.\n- For $\\alpha = 0.30$, the calculated $\\Delta E_{\\text{S-T}}$ is $38.0 \\text{ kJ/mol}$.\n- For $\\alpha = 0.40$, the calculated $\\Delta E_{\\text{S-T}}$ is $44.0 \\text{ kJ/mol}$.\n\nAssuming the relationship between $\\Delta E_{\\text{S-T}}$ and $\\alpha$ is linear between the calculated data points, determine the optimal value of $\\alpha$ that reproduces the experimental benchmark. Express your answer as a dimensionless decimal value rounded to three significant figures.", "solution": "Assume a linear relationship between the singlet-triplet gap and the Hartree-Fock exchange fraction: $\\Delta E_{\\text{S-T}}(\\alpha) = m\\alpha + b$. Using two data points, $(\\alpha_{1}, \\Delta E_{1}) = (0.10, 26.0)$ and $(\\alpha_{2}, \\Delta E_{2}) = (0.20, 32.0)$, compute the slope:\n$$\nm = \\frac{\\Delta E_{2} - \\Delta E_{1}}{\\alpha_{2} - \\alpha_{1}} = \\frac{32.0 - 26.0}{0.20 - 0.10} = 60.0.\n$$\nDetermine the intercept using $(0.10, 26.0)$:\n$$\n26.0 = 60.0 \\times 0.10 + b \\quad \\Rightarrow \\quad b = 26.0 - 6.0 = 20.0.\n$$\nThus,\n$$\n\\Delta E_{\\text{S-T}}(\\alpha) = 60.0\\,\\alpha + 20.0.\n$$\nSet this equal to the experimental benchmark $\\Delta E_{\\text{S-T}}^{\\text{exp}} = 37.8$ and solve for $\\alpha$:\n$$\n37.8 = 60.0\\,\\alpha + 20.0 \\quad \\Rightarrow \\quad \\alpha = \\frac{37.8 - 20.0}{60.0} = \\frac{17.8}{60.0} \\approx 0.296\\overline{6}.\n$$\nRounded to three significant figures,\n$$\n\\alpha \\approx 0.297.\n$$", "answer": "$$\\boxed{0.297}$$", "id": "1373559"}]}