{"hands_on_practices": [{"introduction": "To truly understand how a meta-GGA functional works, it's essential to first get your hands dirty with its fundamental building blocks. This exercise demystifies the complex formalism by guiding you through a step-by-step numerical calculation of all the key ingredients at a single point in space. By computing quantities like the reduced density gradient $s$, the von Weizsäcker kinetic energy density $\\tau_W$, and the iso-orbital indicator $\\alpha$, you will see exactly how information about the electron density, its gradient, and the kinetic energy density are combined to produce the final exchange energy. [@problem_id:2457672]", "problem": "Consider a single real-space integration point $\\mathbf{r}$ on a numerical quadrature grid for a closed-shell Neon atom treated within Kohn–Sham Density Functional Theory (DFT) using a meta-Generalized Gradient Approximation (meta-GGA) exchange functional. Assume a spin-unpolarized density at this point so that the spin-up and spin-down densities are equal. Work entirely in atomic units (Hartree for energy and Bohr for length), and treat the following as given at $\\mathbf{r}$:\n- Electron density $n(\\mathbf{r}) = 0.200$,\n- Density gradient magnitude $|\\nabla n(\\mathbf{r})| = 0.350$,\n- Kohn–Sham orbital kinetic energy density $\\tau(\\mathbf{r}) = 0.150$.\n\nStarting from first principles of the uniform electron gas and standard meta-GGA ingredients, proceed through the following definitions to obtain the meta-GGA exchange energy density $e_{x}^{\\text{meta}}(\\mathbf{r})$:\n1. The Fermi wavevector $k_{F}(\\mathbf{r})$ of the uniform electron gas at density $n(\\mathbf{r})$ is $k_{F}(\\mathbf{r}) = \\big(3\\pi^{2} n(\\mathbf{r})\\big)^{1/3}$.\n2. The reduced density gradient $s(\\mathbf{r})$ is $s(\\mathbf{r}) = \\dfrac{|\\nabla n(\\mathbf{r})|}{2 k_{F}(\\mathbf{r})\\, n(\\mathbf{r})}$.\n3. The von Weizsäcker kinetic energy density is $\\tau_{W}(\\mathbf{r}) = \\dfrac{|\\nabla n(\\mathbf{r})|^{2}}{8\\, n(\\mathbf{r})}$.\n4. The uniform-gas kinetic energy density is $\\tau_{\\text{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\big(3\\pi^{2}\\big)^{2/3} n(\\mathbf{r})^{5/3}$.\n5. The iso-orbital indicator is $\\alpha(\\mathbf{r}) = \\dfrac{\\tau(\\mathbf{r}) - \\tau_{W}(\\mathbf{r})}{\\tau_{\\text{unif}}(\\mathbf{r})}$.\n6. The Local Density Approximation (LDA) exchange energy density is $e_{x}^{\\text{LDA}}(\\mathbf{r}) = - C_{x}\\, n(\\mathbf{r})^{4/3}$, where $C_{x} = \\dfrac{3}{4}\\big(\\dfrac{3}{\\pi}\\big)^{1/3}$.\n7. The meta-GGA exchange enhancement factor is defined (for this problem) by\n$$\nF_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big) \\;=\\; 1 + \\kappa \\;-\\; \\dfrac{\\kappa}{1 + \\mu\\, s(\\mathbf{r})^{2} + \\beta\\, \\alpha(\\mathbf{r})},\n$$\nwith constants $\\kappa = 0.804$, $\\mu = 0.21951$, and $\\beta = 0.100$.\n8. The meta-GGA exchange energy density is $e_{x}^{\\text{meta}}(\\mathbf{r}) = e_{x}^{\\text{LDA}}(\\mathbf{r}) \\, F_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big)$.\n\nCompute $e_{x}^{\\text{meta}}(\\mathbf{r})$ numerically using the values provided. Express your final answer as a single number in Hartree per Bohr$^3$, rounded to four significant figures.", "solution": "The problem statement is validated as self-contained, scientifically grounded in the principles of Kohn-Sham Density Functional Theory, and numerically well-posed. All required constants, variables, and functional forms are explicitly provided, allowing for a direct, unambiguous calculation. A unique solution exists and will be derived by methodically applying the given definitions.\n\nWe are provided with the following local quantities at a point $\\mathbf{r}$ in atomic units:\n- Electron density: $n(\\mathbf{r}) = 0.200$\n- Magnitude of the density gradient: $|\\nabla n(\\mathbf{r})| = 0.350$\n- Kohn-Sham orbital kinetic energy density: $\\tau(\\mathbf{r}) = 0.150$\n\nThe calculation proceeds sequentially through the defined steps.\n\n1.  Compute the Fermi wavevector, $k_{F}(\\mathbf{r})$.\n    The formula for the Fermi wavevector of a uniform electron gas is given as $k_{F}(\\mathbf{r}) = \\big(3\\pi^{2} n(\\mathbf{r})\\big)^{1/3}$.\n    Substituting the given electron density $n(\\mathbf{r}) = 0.200$:\n    $$k_{F}(\\mathbf{r}) = \\big(3\\pi^{2} \\times 0.200\\big)^{1/3} = (0.6\\pi^{2})^{1/3} \\approx 1.80918$$\n\n2.  Compute the reduced density gradient, $s(\\mathbf{r})$.\n    The definition provided is $s(\\mathbf{r}) = \\dfrac{|\\nabla n(\\mathbf{r})|}{2 k_{F}(\\mathbf{r})\\, n(\\mathbf{r})}$.\n    Using the given values and the computed $k_{F}(\\mathbf{r})$:\n    $$s(\\mathbf{r}) = \\dfrac{0.350}{2 \\times 1.80918 \\times 0.200} \\approx \\dfrac{0.350}{0.723672} \\approx 0.48364$$\n\n3.  Compute the von Weizsäcker kinetic energy density, $\\tau_{W}(\\mathbf{r})$.\n    This is defined as $\\tau_{W}(\\mathbf{r}) = \\dfrac{|\\nabla n(\\mathbf{r})|^{2}}{8\\, n(\\mathbf{r})}$.\n    Substituting the given values:\n    $$\\tau_{W}(\\mathbf{r}) = \\dfrac{(0.350)^{2}}{8 \\times 0.200} = \\dfrac{0.1225}{1.6} = 0.0765625$$\n\n4.  Compute the uniform-gas kinetic energy density, $\\tau_{\\text{unif}}(\\mathbf{r})$.\n    The formula is $\\tau_{\\text{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\big(3\\pi^{2}\\big)^{2/3} n(\\mathbf{r})^{5/3}$.\n    Substituting $n(\\mathbf{r}) = 0.200$:\n    $$\\tau_{\\text{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\big(3\\pi^{2}\\big)^{2/3} (0.200)^{5/3} \\approx 0.3 \\times 9.58231 \\times 0.068399 \\approx 0.196388$$\n\n5.  Compute the iso-orbital indicator, $\\alpha(\\mathbf{r})$.\n    The definition is $\\alpha(\\mathbf{r}) = \\dfrac{\\tau(\\mathbf{r}) - \\tau_{W}(\\mathbf{r})}{\\tau_{\\text{unif}}(\\mathbf{r})}$.\n    Using the given $\\tau(\\mathbf{r})$ and the computed $\\tau_{W}(\\mathbf{r})$ and $\\tau_{\\text{unif}}(\\mathbf{r})$:\n    $$\\alpha(\\mathbf{r}) = \\dfrac{0.150 - 0.0765625}{0.196388} = \\dfrac{0.0734375}{0.196388} \\approx 0.37394$$\n\n6.  Compute the Local Density Approximation (LDA) exchange energy density, $e_{x}^{\\text{LDA}}(\\mathbf{r})$.\n    This is given by $e_{x}^{\\text{LDA}}(\\mathbf{r}) = - C_{x}\\, n(\\mathbf{r})^{4/3}$, with the constant $C_{x} = \\dfrac{3}{4}\\big(\\dfrac{3}{\\pi}\\big)^{1/3}$.\n    First, we evaluate $C_x$:\n    $$C_{x} = \\dfrac{3}{4}\\big(\\dfrac{3}{\\pi}\\big)^{1/3} \\approx 0.75 \\times (0.95493)^{1/3} \\approx 0.75 \\times 0.984745 \\approx 0.73856$$\n    Now, we compute $e_{x}^{\\text{LDA}}(\\mathbf{r})$:\n    $$e_{x}^{\\text{LDA}}(\\mathbf{r}) = - (0.73856) \\times (0.200)^{4/3} \\approx -0.73856 \\times 0.11696 \\approx -0.086383$$\n\n7.  Compute the meta-GGA exchange enhancement factor, $F_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big)$.\n    The problem specifies the form $F_{x} = 1 + \\kappa - \\dfrac{\\kappa}{1 + \\mu\\, s(\\mathbf{r})^{2} + \\beta\\, \\alpha(\\mathbf{r})}$, with constants $\\kappa = 0.804$, $\\mu = 0.21951$, and $\\beta = 0.100$.\n    We substitute the computed values of $s(\\mathbf{r})$ and $\\alpha(\\mathbf{r})$:\n    $$F_{x} = 1 + 0.804 - \\dfrac{0.804}{1 + (0.21951)(0.48364)^{2} + (0.100)(0.37394)}$$\n    $$F_{x} = 1.804 - \\dfrac{0.804}{1 + (0.21951)(0.233908) + 0.037394}$$\n    $$F_{x} = 1.804 - \\dfrac{0.804}{1 + 0.051346 + 0.037394} = 1.804 - \\dfrac{0.804}{1.08874} \\approx 1.804 - 0.73847 \\approx 1.06553$$\n\n8.  Compute the final meta-GGA exchange energy density, $e_{x}^{\\text{meta}}(\\mathbf{r})$.\n    This is the product of the LDA energy density and the enhancement factor: $e_{x}^{\\text{meta}}(\\mathbf{r}) = e_{x}^{\\text{LDA}}(\\mathbf{r}) \\, F_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big)$.\n    $$e_{x}^{\\text{meta}}(\\mathbf{r}) \\approx -0.086383 \\times 1.06553 \\approx -0.092036$$\n\nThe problem requires the final answer to be rounded to four significant figures.\nThe calculated value is $-0.092036$. Rounding this to four significant figures yields $-0.09204$.", "answer": "$$\\boxed{-0.09204}$$", "id": "2457672"}, {"introduction": "Having dissected a meta-GGA at a single point, we can now zoom out to see how its components behave across an entire chemical system. This practice challenges you to model an argon atom and map out the spatial variation of the reduced kinetic energy density, $p(r) = \\tau(r) / \\tau_{\\mathrm{unif}}(n(r))$, a quantity closely related to the iso-orbital indicator $\\alpha$. By implementing this calculation, you will develop a powerful connection between these abstract DFT variables and the intuitive chemical concepts of core and valence electron shells. [@problem_id:2457651]", "problem": "You are asked to implement, from first principles, a program that computes the reduced kinetic energy density used in meta-Generalized Gradient Approximation (meta-GGA) functionals of Density Functional Theory (DFT) for a model atom. Consider an Argon atom modeled by hydrogenic orbitals with Slater effective nuclear charges. The reduced kinetic energy density is defined as $p(\\mathbf{r}) = \\tau(\\mathbf{r}) / \\tau_{\\mathrm{unif}}(n(\\mathbf{r}))$, where $\\tau(\\mathbf{r})$ is the Kohn–Sham orbital kinetic energy density and $\\tau_{\\mathrm{unif}}(n)$ is the kinetic energy density of a uniform electron gas at density $n$. Work in atomic units throughout.\n\nLet the Kohn–Sham kinetic energy density be defined by\n$$\\tau(\\mathbf{r}) = \\frac{1}{2} \\sum_{i,\\sigma} \\left\\lVert \\nabla \\psi_{i\\sigma}(\\mathbf{r}) \\right\\rVert^2,$$\nwhere the sum is over all occupied spin orbitals $\\psi_{i\\sigma}(\\mathbf{r})$. For a spherically symmetric, closed-shell atom with all magnetic quantum numbers $m$ filled in each $(n,\\ell)$ subshell, the sum over spins and over $m$ yields a spherically symmetric $\\tau(r)$ that can be expressed in terms of the hydrogenic radial functions $R_{n\\ell}(r)$ as\n$$\\tau(r) = \\sum_{n,\\ell} \\frac{2\\ell+1}{4\\pi} \\left( \\left|\\frac{dR_{n\\ell}(r)}{dr}\\right|^2 + \\frac{\\ell(\\ell+1)}{r^2} \\left|R_{n\\ell}(r)\\right|^2 \\right),$$\nand the electron density is\n$$n(r) = \\sum_{n,\\ell} \\frac{2(2\\ell+1)}{4\\pi} \\left| R_{n\\ell}(r) \\right|^2.$$\n\nUse hydrogenic radial functions with an effective nuclear charge $Z_{\\mathrm{eff}}$ for each subshell. In atomic units, for principal quantum number $n$, angular momentum $\\ell$, effective charge $Z$, and $r \\ge 0$, write the radial function as\n$$R_{n\\ell}(r; Z) = \\mathcal{N}_{n\\ell}(Z) \\, e^{-\\rho/2} \\, \\rho^{\\ell} \\, L_{n-\\ell-1}^{(2\\ell+1)}(\\rho), \\quad \\rho = \\frac{2 Z r}{n},$$\nwith normalization constant\n$$\\mathcal{N}_{n\\ell}(Z) = \\left( \\frac{2 Z}{n} \\right)^{3/2} \\sqrt{ \\frac{(n-\\ell-1)!}{2 n \\, (n+\\ell)!} },$$\nand where $L_{k}^{(\\alpha)}$ is the generalized Laguerre polynomial of degree $k$ and order $\\alpha$. The derivative $dR_{n\\ell}/dr$ is obtained by differentiating this expression with respect to $r$.\n\nFor a spin-unpolarized uniform electron gas of density $n$, define\n$$\\tau_{\\mathrm{unif}}(n) = \\frac{3}{10} \\left( 3 \\pi^2 \\right)^{2/3} n^{5/3}.$$\n\nModel the Argon atom with electron configuration $1s^2\\,2s^2\\,2p^6\\,3s^2\\,3p^6$ by assigning Slater effective nuclear charges as follows. Use Slater’s rules for $n s$ and $n p$ electrons:\n- For a $1s$ electron: the other $1s$ electron contributes $0.30$ to the shielding $S$.\n- For an $n s$ or $n p$ electron with $n=2$: each of the other $n=2$ electrons contributes $0.35$, and each $1s$ electron contributes $0.85$.\n- For an $n s$ or $n p$ electron with $n \\ge 3$: each of the other electrons with the same principal quantum number $n$ contributes $0.35$, each electron with principal quantum number $n-1$ contributes $0.85$, and each electron with principal quantum number $n-2$ or lower contributes $1.00$.\n\nLet the nuclear charge be $Z=18$. For each subshell, compute $S$ using these rules for a representative electron in that subshell and then set $Z_{\\mathrm{eff}} = Z - S$. Apply a common $Z_{\\mathrm{eff}}$ within each of the following subshell groups: $1s$, $2s$ and $2p$ (same $Z_{\\mathrm{eff}}$), and $3s$ and $3p$ (same $Z_{\\mathrm{eff}}$). Use the resulting $Z_{\\mathrm{eff}}$ values in the hydrogenic radial functions for the corresponding subshells.\n\nDefine the reduced kinetic energy density as\n$$p(r) = \\frac{\\tau(r)}{\\tau_{\\mathrm{unif}}(n(r))}.$$\n\nTest suite specification:\n- Use the radii $r$ (in bohr) given by the ordered set $\\{0.05,\\;0.30,\\;1.00,\\;1.50,\\;2.50\\}$.\n- For each $r$ in this set, compute $p(r)$ as defined above.\n- The required final output is a single line containing these five values of $p(r)$, rounded to six decimal places, as a comma-separated list enclosed in square brackets, in the same order as the input radii. For example, the format must be exactly like $[x_1,x_2,x_3,x_4,x_5]$ with each $x_i$ a decimal string rounded to six places.\n\nAngle unit does not apply. The reduced kinetic energy density $p(r)$ is dimensionless. Ensure that radii are interpreted in bohr and all formulas are used in atomic units. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4,result_5]$).", "solution": "The problem has been subjected to rigorous validation and is determined to be well-posed, scientifically sound, and computationally tractable. It represents a standard exercise in applying the principles of Density Functional Theory to a model atomic system. We shall proceed with a systematic, first-principles-based solution. The entire analysis is conducted in atomic units, where $\\hbar=m_e=e=4\\pi\\epsilon_0=1$.\n\nThe objective is to compute the reduced kinetic energy density, $p(r)$, for a model Argon atom at specified radial distances $r$. The quantity $p(r)$ is defined as the ratio of the Kohn-Sham kinetic energy density, $\\tau(r)$, to the kinetic energy density of a uniform electron gas, $\\tau_{\\mathrm{unif}}(n(r))$, at the same local electron density $n(r)$:\n$$p(r) = \\frac{\\tau(r)}{\\tau_{\\mathrm{unif}}(n(r))}$$\n\nThe calculation proceeds in four stages:\n1.  Determination of the effective nuclear charge, $Z_{\\mathrm{eff}}$, for each relevant group of atomic orbitals using Slater's rules.\n2.  Evaluation of the hydrogenic radial wavefunctions, $R_{n\\ell}(r)$, and their derivatives, $dR_{n\\ell}/dr$, for all occupied subshells.\n3.  Computation of the total electron density, $n(r)$, and the total Kohn-Sham kinetic energy density, $\\tau(r)$, by summing contributions from all occupied subshells.\n4.  Calculation of $\\tau_{\\mathrm{unif}}(n(r))$ and the final reduced kinetic energy density, $p(r)$.\n\n**1. Effective Nuclear Charge ($Z_{\\mathrm{eff}}$)**\n\nThe Argon atom, with nuclear charge $Z=18$, has the electron configuration $1s^2\\,2s^2\\,2p^6\\,3s^2\\,3p^6$. We apply Slater's rules to calculate the shielding constant, $S$, for a representative electron in each specified subshell group. The effective nuclear charge is then $Z_{\\mathrm{eff}} = Z - S$.\n\n- **Group 1 ($1s$ subshell):** For a $1s$ electron, the shielding is from the other $1s$ electron.\n$$S_{1s} = 1 \\times 0.30 = 0.30$$\n$$Z_{\\mathrm{eff}, 1s} = 18 - 0.30 = 17.70$$\n\n- **Group 2 ($2s, 2p$ subshells):** For a representative electron in the $n=2$ shell, there are $7$ other electrons in the same shell ($n=2$) and $2$ electrons in the inner shell ($n=1$).\n$$S_{2sp} = (7 \\times 0.35) + (2 \\times 0.85) = 2.45 + 1.70 = 4.15$$\n$$Z_{\\mathrm{eff}, 2sp} = 18 - 4.15 = 13.85$$\n\n- **Group 3 ($3s, 3p$ subshells):** For a representative electron in the $n=3$ shell, there are $7$ other electrons in the same shell ($n=3$), $8$ electrons in the $n-1$ shell ($n=2$), and $2$ electrons in the $n-2$ shell ($n=1$).\n$$S_{3sp} = (7 \\times 0.35) + (8 \\times 0.85) + (2 \\times 1.00) = 2.45 + 6.80 + 2.00 = 11.25$$\n$$Z_{\\mathrm{eff}, 3sp} = 18 - 11.25 = 6.75$$\n\nThese $Z_{\\mathrm{eff}}$ values will be used in the hydrogenic radial functions for the corresponding subshells: $(1,0)$, $(2,0)$, $(2,1)$, $(3,0)$, and $(3,1)$.\n\n**2. Radial Wavefunctions and Their Derivatives**\n\nThe radial part of the hydrogenic orbital for principal quantum number $n$, angular momentum quantum number $\\ell$, and effective nuclear charge $Z$ is given by:\n$$R_{n\\ell}(r; Z) = \\mathcal{N}_{n\\ell}(Z) \\, e^{-\\rho/2} \\, \\rho^{\\ell} \\, L_{n-\\ell-1}^{(2\\ell+1)}(\\rho)$$\nwhere $\\rho = \\frac{2 Z r}{n}$, $L_{k}^{(\\alpha)}$ is the generalized Laguerre polynomial, and $\\mathcal{N}_{n\\ell}(Z)$ is the normalization constant:\n$$\\mathcal{N}_{n\\ell}(Z) = \\left( \\frac{2 Z}{n} \\right)^{3/2} \\sqrt{ \\frac{(n-\\ell-1)!}{2 n \\, (n+\\ell)!} }$$\nThe derivative $dR_{n\\ell}/dr$ is computed using the chain rule, $\\frac{dR}{dr} = \\frac{dR}{d\\rho} \\frac{d\\rho}{dr}$, where $\\frac{d\\rho}{dr} = \\frac{2Z}{n}$.\nThe derivative with respect to $\\rho$ is evaluated based on the product rule, distinguishing between the cases $\\ell=0$ and $\\ell > 0$.\nFor $\\ell=0$:\n$$\\frac{d R_{n0}}{d\\rho} = \\mathcal{N}_{n0} e^{-\\rho/2} \\left[ -\\frac{1}{2} L_{n-1}^{(1)}(\\rho) + \\frac{d}{d\\rho}L_{n-1}^{(1)}(\\rho) \\right]$$\nFor $\\ell > 0$:\n$$\\frac{d R_{n\\ell}}{d\\rho} = \\mathcal{N}_{n\\ell} e^{-\\rho/2} \\rho^{\\ell-1} \\left[ \\left(-\\frac{\\rho}{2}+\\ell\\right) L_{n-\\ell-1}^{(2\\ell+1)}(\\rho) + \\rho \\frac{d}{d\\rho}L_{n-\\ell-1}^{(2\\ell+1)}(\\rho) \\right]$$\nThe derivatives of the Laguerre polynomials are computed algorithmically.\n\n**3. Electron and Kinetic Energy Densities**\n\nFor a closed-shell, spherically symmetric atom, the total electron density $n(r)$ and Kohn-Sham kinetic energy density $\\tau(r)$ are obtained by summing the contributions from all occupied subshells $(n,\\ell)$.\n\nThe electron density is:\n$$n(r) = \\sum_{n,\\ell}^{\\text{occ}} \\frac{2(2\\ell+1)}{4\\pi} \\left| R_{n\\ell}(r) \\right|^2$$\nThe factor of $2$ accounts for the two spin states (up and down), and $(2\\ell+1)$ for the degeneracy of the magnetic quantum numbers $m$.\n\nThe kinetic energy density is:\n$$\\tau(r) = \\sum_{n,\\ell}^{\\text{occ}} \\frac{2\\ell+1}{4\\pi} \\left( \\left|\\frac{dR_{n\\ell}(r)}{dr}\\right|^2 + \\frac{\\ell(\\ell+1)}{r^2} \\left|R_{n\\ell}(r)\\right|^2 \\right)$$\nThese sums are computed numerically for each specified value of $r$.\n\n**4. Reduced Kinetic Energy Density**\n\nThe kinetic energy density of a spin-unpolarized uniform electron gas (in the Thomas-Fermi approximation) is given by:\n$$\\tau_{\\mathrm{unif}}(n) = C_K n^{5/3}, \\quad \\text{where} \\quad C_K = \\frac{3}{10} \\left( 3 \\pi^2 \\right)^{2/3}$$\nUsing the computed local values of $n(r)$ and $\\tau(r)$, the reduced kinetic energy density $p(r)$ is calculated as their ratio:\n$$p(r) = \\frac{\\tau(r)}{\\tau_{\\mathrm{unif}}(n(r))} = \\frac{\\tau(r)}{C_K \\, n(r)^{5/3}}$$\nThis procedure is repeated for each radius in the test set $\\{0.05, 0.30, 1.00, 1.50, 2.50\\}$ to yield the final results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import genlaguerre\nimport math\n\ndef solve():\n    \"\"\"\n    Computes the reduced kinetic energy density p(r) for a model Argon atom\n    at specified radii.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    radii = [0.05, 0.30, 1.00, 1.50, 2.50]\n    \n    # 1. Calculate effective nuclear charges (Z_eff) using Slater's rules\n    Z_atom = 18.0\n\n    # For 1s subshell\n    S_1s = 0.30\n    Z_eff_1s = Z_atom - S_1s\n\n    # For 2s, 2p subshells\n    S_2sp = 7 * 0.35 + 2 * 0.85\n    Z_eff_2sp = Z_atom - S_2sp\n\n    # For 3s, 3p subshells\n    S_3sp = 7 * 0.35 + 8 * 0.85 + 2 * 1.00\n    Z_eff_3sp = Z_atom - S_3sp\n\n    # Define occupied subshells for Argon with their respective Z_eff\n    occupied_subshells = [\n        # (n, l, Z_eff)\n        (1, 0, Z_eff_1s),\n        (2, 0, Z_eff_2sp),\n        (2, 1, Z_eff_2sp),\n        (3, 0, Z_eff_3sp),\n        (3, 1, Z_eff_3sp),\n    ]\n\n    results = []\n    \n    # Constant for the uniform electron gas kinetic energy density\n    C_K = (3.0 / 10.0) * (3.0 * np.pi**2)**(2.0/3.0)\n\n    for r in radii:\n        total_n_r = 0.0\n        total_tau_r = 0.0\n\n        # Sum contributions from all occupied subshells\n        for n, l, Z_eff in occupied_subshells:\n            \n            # 2. Evaluate radial wavefunctions and their derivatives\n            \n            # Calculate rho and its derivative w.r.t r\n            rho = (2.0 * Z_eff * r) / n\n            d_rho_dr = (2.0 * Z_eff) / n\n\n            # Normalization constant N_nl\n            # Use math.factorial for integer arguments\n            fact_num = math.factorial(n - l - 1)\n            fact_den = math.factorial(n + l)\n            norm_const = ((2.0 * Z_eff / n)**1.5) * np.sqrt(fact_num / (2.0 * n * fact_den))\n\n            # Generalized Laguerre polynomial L_{n-l-1}^{2l+1} and its derivative\n            k, alpha = n - l - 1, 2 * l + 1\n            L_poly = genlaguerre(k, alpha)\n            L_poly_deriv = L_poly.deriv(1)\n            \n            L_val = L_poly(rho)\n            L_deriv_val = L_poly_deriv(rho)\n\n            # Radial function R_nl(r) and its derivative dR_nl/dr\n            if l == 0:\n                # Case l=0: R_n0 = N * exp(-rho/2) * L\n                R_nl = norm_const * np.exp(-rho / 2.0) * L_val\n                # dR/d(rho) = N * exp(-rho/2) * [-0.5*L + L']\n                dR_drho = norm_const * np.exp(-rho/2.0) * (-0.5 * L_val + L_deriv_val)\n            else: # l > 0\n                # Case l>0: R_nl = N * exp(-rho/2) * rho^l * L\n                R_nl = norm_const * np.exp(-rho / 2.0) * (rho**l) * L_val\n                # dR/d(rho) = N * exp(-rho/2) * rho^(l-1) * [(-0.5*rho+l)*L + rho*L']\n                # This form is numerically stable for r > 0.\n                term_in_brackets = (-0.5 * rho + l) * L_val + rho * L_deriv_val\n                dR_drho = norm_const * np.exp(-rho/2.0) * (rho**(l-1)) * term_in_brackets\n            \n            dR_dr = dR_drho * d_rho_dr\n\n            # 3. Compute electron density n(r) and kinetic energy density tau(r)\n            \n            # Contribution to electron density n(r)\n            n_contrib = (2.0 * (2.0 * l + 1.0) / (4.0 * np.pi)) * R_nl**2\n            total_n_r += n_contrib\n            \n            # Contribution to kinetic energy density tau(r)\n            radial_ke_term = dR_dr**2\n            # The angular KE term incorporates the 1/r^2 factor. It is safe for r > 0.\n            angular_ke_term = (l * (l + 1.0) / r**2) * R_nl**2\n            tau_contrib = ((2.0 * l + 1.0) / (4.0 * np.pi)) * (radial_ke_term + angular_ke_term)\n            total_tau_r += tau_contrib\n            \n        # 4. Calculate p(r)\n        \n        # tau_unif for the total local density n(r)\n        # Add a small epsilon to total_n_r to prevent division by zero, though unlikely for these radii.\n        tau_unif_r = C_K * (total_n_r + 1e-15)**(5.0/3.0)\n        \n        # Reduced kinetic energy density p(r)\n        p_r = total_tau_r / tau_unif_r\n        results.append(p_r)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```", "id": "2457651"}, {"introduction": "Our final practice explores the 'logic' that allows a meta-GGA to outperform simpler functionals. Building on your understanding of the ingredients and their spatial behavior, this exercise simulates how the iso-orbital indicator $\\alpha$ is used within a 'switching function' to intelligently recognize and adapt to different chemical environments. By programming an analysis to find where this switching function is most active in systems representing isolated atoms and covalent bonds, you will gain a deep insight into the mechanism that gives meta-GGAs their remarkable versatility and accuracy. [@problem_id:2457711]", "problem": "You are asked to study, in a controlled and fully specified setting, the role of the switching function in the Tao–Perdew–Staroverov–Scuseria (TPSS) meta-generalized gradient approximation by quantifying where it is most active for model systems constructed from normalized Gaussian orbitals. All computations are to be carried out in Hartree atomic units.\n\nA spin-unpolarized, closed-shell Kohn–Sham system with spatial orbitals $\\{\\phi_n(\\mathbf{r})\\}$ has electron density $\\rho(\\mathbf{r}) = 2 \\sum_n |\\phi_n(\\mathbf{r})|^2$ and positive kinetic energy density $\\tau(\\mathbf{r}) = \\sum_n |\\nabla \\phi_n(\\mathbf{r})|^2$. The von Weizsäcker kinetic energy density is $\\tau_{\\mathrm{W}}(\\mathbf{r}) = \\dfrac{|\\nabla \\rho(\\mathbf{r})|^2}{8\\,\\rho(\\mathbf{r})}$ for $\\rho(\\mathbf{r})>0$, and the uniform electron gas kinetic energy density is $\\tau_{\\mathrm{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\left(3\\pi^2\\right)^{2/3}\\rho(\\mathbf{r})^{5/3}$. The iso-orbital indicator is\n$$\n\\alpha(\\mathbf{r}) = \\frac{\\tau(\\mathbf{r}) - \\tau_{\\mathrm{W}}(\\mathbf{r})}{\\tau_{\\mathrm{unif}}(\\mathbf{r})},\n$$\nwith the convention that $\\alpha(\\mathbf{r})=0$ when $\\rho(\\mathbf{r})=0$.\n\nConsider the idealized TPSS-like switching function (a smooth interpolator between the one-orbital and slowly varying limits)\n$$\nw(\\alpha) = \\frac{\\alpha^2}{1+\\alpha^2},\n$$\nwith derivative\n$$\nw'(\\alpha) = \\frac{2\\alpha}{\\left(1+\\alpha^2\\right)^2}.\n$$\nLet $w'_{\\max}$ denote the global maximum of $w'(\\alpha)$ for $\\alpha\\ge 0$. Define the local activity indicator\n$$\nA(\\mathbf{r}) =\n\\begin{cases}\n1, & \\text{if } \\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}} \\text{ and } w'(\\alpha(\\mathbf{r})) \\ge \\frac{1}{2}w'_{\\max},\\\\\n0, & \\text{otherwise,}\n\\end{cases}\n$$\nwhere $\\rho_{\\mathrm{cut}} = 10^{-8}$ in bohr$^{-3}$. The active fraction $F$ for a system is the ratio of the number of grid points with $A(\\mathbf{r})=1$ to the number of grid points with $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}}$.\n\nAll spatial fields must be evaluated on a uniform Cartesian grid spanning the cube $[-L,L]^3$ with $L=6$ in bohr, using $N=33$ equispaced points per axis.\n\nYou will evaluate $F$ for the following three test cases (the test suite), each specified entirely by first-principles constructs:\n\n1. Uniform electron gas in a box. The density is constant, $\\rho(\\mathbf{r})=\\rho_0$ with $\\rho_0=0.05$ in bohr$^{-3}$, so that $\\nabla \\rho(\\mathbf{r})=\\mathbf{0}$, $\\tau(\\mathbf{r})=\\tau_{\\mathrm{unif}}(\\mathbf{r})$, and $\\tau_{\\mathrm{W}}(\\mathbf{r})=0$ at all points.\n\n2. One-orbital atom-like system. A single normalized $s$-type Gaussian spatial orbital at the origin, doubly occupied,\n$$\n\\phi(\\mathbf{r}) = \\mathcal{N}\\, e^{-a|\\mathbf{r}|^2}, \\quad \\mathcal{N} = \\left(\\frac{2a}{\\pi}\\right)^{3/4}, \\quad a=0.5 \\text{ in bohr}^{-2}.\n$$\n\n3. Two-center diatomic-like system. Two normalized $s$-type Gaussian functions with the same exponent $a=0.5$ in bohr$^{-2}$, centered at $\\mathbf{R}_A=(0,0,-R/2)$ and $\\mathbf{R}_B=(0,0,R/2)$,\n$$\ng_A(\\mathbf{r})=\\mathcal{N}\\,e^{-a|\\mathbf{r}-\\mathbf{R}_A|^2}, \\quad g_B(\\mathbf{r})=\\mathcal{N}\\,e^{-a|\\mathbf{r}-\\mathbf{R}_B|^2},\n$$\nwith overlap $S=\\exp\\!\\left(-\\frac{aR^2}{2}\\right)$. Construct the orthonormal bonding and antibonding orbitals\n$$\n\\phi_b(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})+g_B(\\mathbf{r})}{\\sqrt{2(1+S)}}, \\quad\n\\phi_a(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})-g_B(\\mathbf{r})}{\\sqrt{2(1-S)}},\n$$\neach doubly occupied. For the candidate separations $R \\in \\{0.5,\\,1.5,\\,3.0,\\,5.0\\}$ in bohr, compute the active fraction $F(R)$ for each and report the value $R^\\star$ that maximizes $F(R)$; if multiple $R$ attain the same maximal $F$, report the smallest such $R$.\n\nAngle units are not applicable. All lengths must be treated in bohr, and all densities in bohr$^{-3}$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[F_{\\mathrm{UEG}}, F_{\\mathrm{1G}}, R^\\star]$, where $F_{\\mathrm{UEG}}$ is the active fraction for case $1$, $F_{\\mathrm{1G}}$ is the active fraction for case $2$, and $R^\\star$ is in bohr for case $3$. Express all three outputs as floats rounded to three decimal places, with no units printed. For example, a valid output format is like $[0.123,0.000,1.500]$.", "solution": "The problem presented is a well-posed and scientifically grounded exercise in computational quantum chemistry, specifically concerning the behavior of meta-Generalized Gradient Approximation (meta-GGA) density functionals. The task is to analyze an idealized switching function, characteristic of the Tao-Perdew-Staroverov-Scuseria (TPSS) functional, for several model electronic systems. All specified quantities are standard within Density Functional Theory (DFT), and the models—uniform electron gas, a single Gaussian orbital, and a diatomic system constructed from Gaussian orbitals—are canonical examples used to understand the behavior of such functionals. The problem statement is complete, consistent, and requires a direct numerical implementation of established physical and mathematical formulas. Therefore, the problem is valid, and a solution will be furnished.\n\nThe core of the problem lies in the iso-orbital indicator, $\\alpha(\\mathbf{r})$, which distinguishes different bonding environments. It is defined as:\n$$\n\\alpha(\\mathbf{r}) = \\frac{\\tau(\\mathbf{r}) - \\tau_{\\mathrm{W}}(\\mathbf{r})}{\\tau_{\\mathrm{unif}}(\\mathbf{r})}\n$$\nwhere $\\tau$ is the positive kinetic energy density, $\\tau_{\\mathrm{W}} = \\frac{|\\nabla \\rho|^2}{8\\rho}$ is the von Weizsäcker kinetic energy density, and $\\tau_{\\mathrm{unif}} = \\frac{3}{10}(3\\pi^2)^{2/3}\\rho^{5/3}$ is the kinetic energy density of a uniform electron gas (UEG) of density $\\rho$. By design, $\\alpha=0$ for any single-orbital region and $\\alpha=1$ for the UEG.\n\nThe problem investigates the local activity of a TPSS-like switching function, $w(\\alpha) = \\frac{\\alpha^2}{1+\\alpha^2}$. The activity is tied to the magnitude of its derivative, $w'(\\alpha) = \\frac{2\\alpha}{(1+\\alpha^2)^2}$. We must first find the maximum value of $w'(\\alpha)$ for $\\alpha \\ge 0$. We set the derivative of $w'(\\alpha)$ with respect to $\\alpha$ to zero:\n$$\n\\frac{d w'(\\alpha)}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{2\\alpha}{(1+\\alpha^2)^2} \\right) = \\frac{2(1+\\alpha^2)^2 - 2\\alpha \\cdot 2(1+\\alpha^2)(2\\alpha)}{(1+\\alpha^2)^4} = 0\n$$\n$$\n2(1+\\alpha^2) - 8\\alpha^2 = 0 \\implies 2 - 6\\alpha^2 = 0 \\implies \\alpha^2 = \\frac{1}{3}\n$$\nSince $\\alpha \\ge 0$, the maximum occurs at $\\alpha = 1/\\sqrt{3}$. The maximum value is:\n$$\nw'_{\\max} = w'(1/\\sqrt{3}) = \\frac{2(1/\\sqrt{3})}{(1 + 1/3)^2} = \\frac{2/\\sqrt{3}}{(16/9)} = \\frac{2}{\\sqrt{3}}\\frac{9}{16} = \\frac{9}{8\\sqrt{3}} = \\frac{3\\sqrt{3}}{8}\n$$\nThe local activity indicator, $A(\\mathbf{r})$, is $1$ if $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}} = 10^{-8}$ and $w'(\\alpha(\\mathbf{r})) \\ge \\frac{1}{2}w'_{\\max}$. The active fraction, $F$, is the ratio of the number of grid points where $A(\\mathbf{r})=1$ to the total number of points where $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}}$.\n\nWe now analyze the three specified cases.\n\n**Case 1: Uniform Electron Gas (UEG)**\nFor the UEG, the density is constant, $\\rho(\\mathbf{r}) = \\rho_0 = 0.05$. Thus, its gradient is zero, $\\nabla \\rho(\\mathbf{r}) = \\mathbf{0}$. This immediately implies that $\\tau_{\\mathrm{W}}(\\mathbf{r})=0$. The problem states that for this system, $\\tau(\\mathbf{r}) = \\tau_{\\mathrm{unif}}(\\mathbf{r})$. Substituting these into the definition of $\\alpha$:\n$$\n\\alpha(\\mathbf{r}) = \\frac{\\tau_{\\mathrm{unif}}(\\mathbf{r}) - 0}{\\tau_{\\mathrm{unif}}(\\mathbf{r})} = 1\n$$\nThe value of the derivative at $\\alpha=1$ is $w'(1) = \\frac{2(1)}{(1+1^2)^2} = \\frac{2}{4} = \\frac{1}{2}$. The activity condition is $w'(1) \\ge \\frac{1}{2}w'_{\\max}$, which is $\\frac{1}{2} \\ge \\frac{1}{2}\\frac{3\\sqrt{3}}{8}$, or $1 \\ge \\frac{3\\sqrt{3}}{8}$. Since $8^2 = 64$ and $(3\\sqrt{3})^2 = 27$, this inequality holds. The density is constant at $0.05$, which is much greater than $\\rho_{\\mathrm{cut}}$. Therefore, $A(\\mathbf{r})=1$ at every grid point. The number of active points equals the total number of points satisfying the density cutoff, yielding an active fraction $F_{\\mathrm{UEG}}=1$.\n\n**Case 2: One-Orbital Atom-like System**\nThe system consists of a single, doubly occupied, real spatial orbital $\\phi(\\mathbf{r})$. The density is $\\rho(\\mathbf{r}) = 2|\\phi(\\mathbf{r})|^2$. The gradient of the density is $\\nabla\\rho = 4\\phi(\\nabla\\phi)$. The kinetic energy density, as defined in the problem for one doubly-occupied orbital, is $\\tau(\\mathbf{r}) = |\\nabla\\phi(\\mathbf{r})|^2$. The von Weizsäcker kinetic energy density is:\n$$\n\\tau_{\\mathrm{W}}(\\mathbf{r}) = \\frac{|\\nabla\\rho|^2}{8\\rho} = \\frac{|4\\phi(\\nabla\\phi)|^2}{8(2\\phi^2)} = \\frac{16\\phi^2|\\nabla\\phi|^2}{16\\phi^2} = |\\nabla\\phi|^2 = \\tau(\\mathbf{r})\n$$\nSince $\\tau(\\mathbf{r}) = \\tau_{\\mathrm{W}}(\\mathbf{r})$ everywhere that $\\rho(\\mathbf{r})>0$, the numerator of $\\alpha$ is identically zero. Thus, $\\alpha(\\mathbf{r}) = 0$ for all $\\mathbf{r}$.\nAt $\\alpha=0$, the derivative of the switching function is $w'(0)=0$. The activity condition is $0 \\ge \\frac{1}{2}w'_{\\max}$, which is false as $w'_{\\max}>0$. Hence, $A(\\mathbf{r})=0$ everywhere. The number of active points is zero, and the active fraction is $F_{\\mathrm{1G}}=0$.\n\n**Case 3: Two-Center Diatomic-like System**\nThis system consists of two doubly occupied orthonormal orbitals, a bonding orbital $\\phi_b$ and an antibonding orbital $\\phi_a$, constructed from Gaussian basis functions $g_A$ and $g_B$.\n$$\n\\phi_b(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})+g_B(\\mathbf{r})}{\\sqrt{2(1+S)}}, \\quad \\phi_a(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})-g_B(\\mathbf{r})}{\\sqrt{2(1-S)}}\n$$\nThe total density and kinetic energy density for this four-electron system are:\n$$\n\\rho(\\mathbf{r}) = 2|\\phi_b(\\mathbf{r})|^2 + 2|\\phi_a(\\mathbf{r})|^2\n$$\n$$\n\\tau(\\mathbf{r}) = |\\nabla\\phi_b(\\mathbf{r})|^2 + |\\nabla\\phi_a(\\mathbf{r})|^2\n$$\nThe calculation of the active fraction $F(R)$ must be performed numerically for each specified internuclear distance $R$. The procedure is as follows:\n1.  Define a uniform Cartesian grid over $[-6,6]^3$ bohr with $33$ points per axis.\n2.  For each value of $R \\in \\{0.5, 1.5, 3.0, 5.0\\}$, perform the following steps.\n3.  For each point $\\mathbf{r}$ on the grid, calculate the values of the basis functions $g_{A,B}(\\mathbf{r})$ and their gradients $\\nabla g_{A,B}(\\mathbf{r})$.\n4.  From these, construct the orbitals $\\phi_{b,a}(\\mathbf{r})$ and their gradients $\\nabla \\phi_{b,a}(\\mathbf{r})$.\n5.  Compute the total density $\\rho(\\mathbf{r})$, its gradient $\\nabla\\rho(\\mathbf{r})$, and the kinetic energy density $\\tau(\\mathbf{r})$.\n6.  Calculate $\\tau_{\\mathrm{W}}(\\mathbf{r})$, $\\tau_{\\mathrm{unif}}(\\mathbf{r})$, and finally the iso-orbital indicator $\\alpha(\\mathbf{r})$. Special care is taken for regions where $\\rho(\\mathbf{r}) \\to 0$, setting the result of indeterminate forms like $0/0$ to $0$.\n7.  Evaluate the activity condition $w'(\\alpha(\\mathbf{r})) \\ge \\frac{1}{2}w'_{\\max}$ for all points where $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}}$.\n8.  Compute the active fraction $F(R)$ as the ratio of points satisfying the condition to the total number of points above the density cutoff.\n9.  After computing $F(R)$ for all candidate $R$, identify $R^\\star$ as the value of $R$ that maximizes $F(R)$. In case of a tie, the smallest $R$ is chosen.\n\nThis numerical calculation will yield the final required value, $R^\\star$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry problem as specified.\n    1. Calculates F_UEG analytically.\n    2. Calculates F_1G analytically.\n    3. Numerically calculates F(R) for the diatomic system for several R\n       and finds R* that maximizes F(R).\n    \"\"\"\n\n    # --- Case 1: Uniform Electron Gas ---\n    # As derived in the solution, alpha = 1 for the UEG.\n    # w'(1) = 2/(1+1)^2 = 0.5.\n    # w'_max = 3*sqrt(3)/8.\n    # The condition is 0.5 >= 0.5 * (3*sqrt(3)/8), which is true.\n    # Since rho > rho_cut everywhere, all points are active.\n    f_ueg = 1.0\n\n    # --- Case 2: One-Orbital Atom-like System ---\n    # As derived in the solution, alpha = 0 for any one-orbital system.\n    # w'(0) = 0. The activity condition is 0 >= 0.5 * w'_max, which is false.\n    # No points are active.\n    f_1g = 0.0\n\n    # --- Case 3: Two-center Diatomic-like System ---\n    # Numerical calculation is required.\n\n    # Grid and constant setup\n    L = 6.0\n    N = 33\n    a = 0.5\n    rho_cut = 1.0e-8\n    candidate_R = [0.5, 1.5, 3.0, 5.0]\n\n    # Pre-calculate grid coordinates\n    points = np.linspace(-L, L, N, dtype=np.float64)\n    xx, yy, zz = np.meshgrid(points, points, points, indexing='ij')\n    grid = np.stack((xx, yy, zz), axis=-1)\n\n    # Pre-calculate constants for w'\n    w_prime_max = 3 * np.sqrt(3) / 8\n    activity_threshold = 0.5 * w_prime_max\n    \n    # Constant for tau_unif\n    tau_unif_const = (3.0 / 10.0) * (3.0 * np.pi**2)**(2.0 / 3.0)\n\n    # Gaussian normalization constant\n    norm_gauss = (2 * a / np.pi)**(3.0 / 4.0)\n\n    f_values = []\n    \n    for R in candidate_R:\n        # Define atom centers\n        R_A = np.array([0.0, 0.0, -R / 2.0])\n        R_B = np.array([0.0, 0.0, R / 2.0])\n\n        # Overlap and normalization for orbitals\n        if R == 0.0:\n            S = 1.0\n        else:\n            S = np.exp(-a * R**2 / 2.0)\n        \n        # Avoid division by zero if R is very large and 1-S is close to 0, though not an issue for given R\n        C_b = np.sqrt(2.0 * (1.0 + S))\n        C_a = np.sqrt(2.0 * (1.0 - S)) if (1.0-S) > 1e-12 else 1e-6 # Avoid instability at small R\n\n        # Calculate Gaussian basis functions and their gradients\n        r_minus_RA = grid - R_A\n        r_minus_RB = grid - R_B\n        r_A_sq = np.sum(r_minus_RA**2, axis=-1)\n        r_B_sq = np.sum(r_minus_RB**2, axis=-1)\n\n        g_A = norm_gauss * np.exp(-a * r_A_sq)\n        g_B = norm_gauss * np.exp(-a * r_B_sq)\n        \n        # Using [..., np.newaxis] to facilitate broadcasting\n        grad_g_A = -2.0 * a * r_minus_RA * g_A[..., np.newaxis]\n        grad_g_B = -2.0 * a * r_minus_RB * g_B[..., np.newaxis]\n\n        # Construct orthonormal orbitals and their gradients\n        phi_b = (g_A + g_B) / C_b\n        phi_a = (g_A - g_B) / C_a\n        grad_phi_b = (grad_g_A + grad_g_B) / C_b\n        grad_phi_a = (grad_g_A - grad_g_B) / C_a\n\n        # Calculate total density and kinetic energy density\n        rho = 2.0 * (phi_b**2 + phi_a**2)\n        tau = np.sum(grad_phi_b**2, axis=-1) + np.sum(grad_phi_a**2, axis=-1)\n\n        # Calculate quantities for alpha\n        grad_rho = 4.0 * (phi_b[..., np.newaxis] * grad_phi_b + phi_a[..., np.newaxis] * grad_phi_a)\n        \n        # Use np.divide to handle rho=0 case safely\n        tau_W = np.divide(np.sum(grad_rho**2, axis=-1), 8.0 * rho, \n                          out=np.zeros_like(rho), where=rho > 1e-15)\n                          \n        tau_unif = tau_unif_const * rho**(5.0 / 3.0)\n\n        # Calculate alpha, handling tau_unif=0 case safely\n        numerator_alpha = tau - tau_W\n        alpha = np.divide(numerator_alpha, tau_unif, \n                          out=np.zeros_like(rho), where=tau_unif > 1e-15)\n\n        # Calculate w'(alpha)\n        w_prime_alpha = 2.0 * alpha / (1.0 + alpha**2)**2\n\n        # Determine active fraction F\n        rho_mask = rho >= rho_cut\n        num_rho_points = np.sum(rho_mask)\n\n        if num_rho_points == 0:\n            F = 0.0\n        else:\n            active_mask = (w_prime_alpha >= activity_threshold) & rho_mask\n            num_active_points = np.sum(active_mask)\n            F = num_active_points / num_rho_points\n        \n        f_values.append(F)\n\n    # Find R* that maximizes F(R)\n    max_f = -1.0\n    r_star = -1.0\n    for R, F in zip(candidate_R, f_values):\n        if F > max_f:\n            max_f = F\n            r_star = R\n\n    # Assemble final results and format output\n    results = [f_ueg, f_1g, r_star]\n    formatted_results = [f\"{val:.3f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2457711"}]}