{"hands_on_practices": [{"introduction": "To build a strong foundation in density functional theory (DFT), we begin with the simplest exchange-correlation functional: the Local Density Approximation (LDA). This exercise explores the LDA exchange functional, which approximates the exchange energy at any point in space using a known formula for a uniform electron gas of the same density. By analytically calculating the LDA exchange for the Helium atom and comparing it to the exact Hartree-Fock exchange, you will gain a concrete understanding of the accuracy and limitations of this fundamental approximation, solidifying the theoretical definitions of both DFT and Hartree-Fock exchange energies [@problem_id:2464278].", "problem": "Consider the helium atom in its ground state, modeled as a spin-unpolarized two-electron system occupying a single hydrogenic $1s$ spatial orbital with nuclear charge $Z=2$. Work in atomic units, where $\\hbar = 1$, $m_{e}=1$, $e=1$, $4\\pi\\varepsilon_{0}=1$, and the Bohr radius $a_{0}=1$. Let the normalized hydrogenic orbital be\n$$\n\\varphi_{1s}(r) \\;=\\; \\left(\\frac{Z^{3}}{\\pi}\\right)^{1/2}\\exp(-Z r),\n$$\nand the corresponding ground-state electron density be\n$$\n\\rho(\\mathbf{r}) \\;=\\; 2\\,|\\varphi_{1s}(\\mathbf{r})|^{2}.\n$$\nThe Local Density Approximation (LDA) exchange functional is defined by\n$$\nE_{x}^{\\mathrm{LDA}}[\\rho] \\;=\\; -\\,\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int \\rho(\\mathbf{r})^{4/3}\\,d^{3}\\mathbf{r}.\n$$\nThe Hartree energy is\n$$\nE_{H}[\\rho] \\;=\\; \\frac{1}{2}\\int\\!\\!\\int \\frac{\\rho(\\mathbf{r}_{1})\\,\\rho(\\mathbf{r}_{2})}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,d^{3}\\mathbf{r}_{1}\\,d^{3}\\mathbf{r}_{2},\n$$\nand for a two-electron singlet occupying the same spatial orbital $\\varphi_{1s}$, the electron-electron repulsion expectation value is\n$$\nJ \\;=\\; \\int\\!\\!\\int \\frac{|\\varphi_{1s}(\\mathbf{r}_{1})|^{2}\\,|\\varphi_{1s}(\\mathbf{r}_{2})|^{2}}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,d^{3}\\mathbf{r}_{1}\\,d^{3}\\mathbf{r}_{2}.\n$$\nDefine the Hartree–Fock exchange energy $E_{x}^{\\mathrm{HF}}$ for this state as the quantity that, together with the Hartree energy, reproduces the electron-electron repulsion, that is,\n$$\nE_{H}[\\rho] + E_{x}^{\\mathrm{HF}} \\;=\\; J.\n$$\nEvaluate $E_{x}^{\\mathrm{LDA}}$ and $E_{x}^{\\mathrm{HF}}$ analytically for $Z=2$, and report the single dimensionless number\n$$\nR \\;=\\; \\frac{E_{x}^{\\mathrm{LDA}}}{E_{x}^{\\mathrm{HF}}}.\n$$\nRound your final result for $R$ to $4$ significant figures. Do not include units in your final answer.", "solution": "The problem statement has been critically examined and is determined to be scientifically grounded, well-posed, and objective. It presents a standard calculation within the frameworks of Hartree-Fock theory and Density Functional Theory for a simple, analytically tractable system. The definitions provided are consistent with established principles. We therefore proceed with the analytical solution.\n\nThe task is to compute the ratio $R = \\frac{E_{x}^{\\mathrm{LDA}}}{E_{x}^{\\mathrm{HF}}}$ for a two-electron system described by a single hydrogenic $1s$ orbital with nuclear charge $Z$.\n\nFirst, we determine the Hartree-Fock exchange energy, $E_{x}^{\\mathrm{HF}}$. The problem defines this quantity through the relation:\n$$\nE_{H}[\\rho] + E_{x}^{\\mathrm{HF}} = J\n$$\nThe electron density for the two-electron system is $\\rho(\\mathbf{r}) = 2|\\varphi_{1s}(\\mathbf{r})|^2$. The Hartree energy, $E_{H}[\\rho]$, is the classical electrostatic self-repulsion of this charge density:\n$$\nE_{H}[\\rho] = \\frac{1}{2}\\int\\!\\!\\int \\frac{\\rho(\\mathbf{r}_{1})\\,\\rho(\\mathbf{r}_{2})}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,d^{3}\\mathbf{r}_{1}\\,d^{3}\\mathbf{r}_{2}\n$$\nSubstituting $\\rho(\\mathbf{r}) = 2|\\varphi_{1s}(\\mathbf{r})|^2$, we find:\n$$\nE_{H}[\\rho] = \\frac{1}{2}\\int\\!\\!\\int \\frac{(2|\\varphi_{1s}(\\mathbf{r}_{1})|^2)\\,(2|\\varphi_{1s}(\\mathbf{r}_{2})|^2)}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,d^{3}\\mathbf{r}_{1}\\,d^{3}\\mathbf{r}_{2} = 2 \\int\\!\\!\\int \\frac{|\\varphi_{1s}(\\mathbf{r}_{1})|^2\\,|\\varphi_{1s}(\\mathbf{r}_{2})|^2}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,d^{3}\\mathbf{r}_{1}\\,d^{3}\\mathbf{r}_{2}\n$$\nThe integral expression on the right is precisely the definition of the Coulomb integral $J$. Thus, we have the simple relation $E_{H}[\\rho] = 2J$.\nSubstituting this result into the problem's definition for $E_{x}^{\\mathrm{HF}}$:\n$$\n2J + E_{x}^{\\mathrm{HF}} = J \\implies E_{x}^{\\mathrm{HF}} = -J\n$$\nThis result is correct; for a two-electron singlet, the Hartree-Fock exchange energy exactly cancels the unphysical self-interaction of an electron with itself, which is contained in the Hartree term. The integral $J$ for a normalized hydrogenic $1s$ orbital with nuclear charge $Z$ is a standard result in quantum mechanics:\n$$\nJ = \\int\\!\\!\\int \\frac{|\\varphi_{1s}(\\mathbf{r}_{1})|^{2}\\,|\\varphi_{1s}(\\mathbf{r}_{2})|^{2}}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,d^{3}\\mathbf{r}_{1}\\,d^{3}\\mathbf{r}_{2} = \\frac{5}{8}Z\n$$\nTherefore, the Hartree-Fock exchange energy is:\n$$\nE_{x}^{\\mathrm{HF}} = -\\frac{5}{8}Z\n$$\n\nNext, we evaluate the Local Density Approximation (LDA) exchange energy, $E_{x}^{\\mathrm{LDA}}$. The functional is given by:\n$$\nE_{x}^{\\mathrm{LDA}}[\\rho] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int \\rho(\\mathbf{r})^{4/3}\\,d^{3}\\mathbf{r}\n$$\nThe electron density is $\\rho(r) = 2|\\varphi_{1s}(r)|^2 = 2 \\frac{Z^3}{\\pi} \\exp(-2Zr)$. We must compute the integral of $\\rho(r)^{4/3}$ over all space. Since the density is spherically symmetric, we integrate in spherical coordinates ($d^{3}\\mathbf{r} = 4\\pi r^2 dr$):\n$$\n\\int \\rho(r)^{4/3}\\,d^{3}\\mathbf{r} = \\int_{0}^{\\infty} \\left(2 \\frac{Z^3}{\\pi} \\exp(-2Zr)\\right)^{4/3} 4\\pi r^2\\,dr\n$$\nWe evaluate the terms:\n$$\n\\left(2 \\frac{Z^3}{\\pi} \\exp(-2Zr)\\right)^{4/3} = 2^{4/3} \\frac{Z^4}{\\pi^{4/3}} \\exp\\left(-\\frac{8Zr}{3}\\right)\n$$\nThe integral becomes:\n$$\n\\int \\rho(r)^{4/3}\\,d^{3}\\mathbf{r} = 4\\pi \\left(2^{4/3} \\frac{Z^4}{\\pi^{4/3}}\\right) \\int_{0}^{\\infty} r^2 \\exp\\left(-\\frac{8Zr}{3}\\right)\\,dr\n$$\nWe use the standard gamma function integral $\\int_0^\\infty x^n \\exp(-ax)\\,dx = \\frac{n!}{a^{n+1}}$. For our case, $n=2$ and $a = \\frac{8Z}{3}$.\n$$\n\\int_{0}^{\\infty} r^2 \\exp\\left(-\\frac{8Zr}{3}\\right)\\,dr = \\frac{2!}{\\left(\\frac{8Z}{3}\\right)^3} = \\frac{2}{\\frac{512Z^3}{27}} = \\frac{54}{512Z^3} = \\frac{27}{256Z^3}\n$$\nSubstituting this back into the expression for the integrated density:\n$$\n\\int \\rho(r)^{4/3}\\,d^{3}\\mathbf{r} = 4\\pi \\cdot 2^{4/3} \\frac{Z^4}{\\pi^{4/3}} \\cdot \\frac{27}{256Z^3} = \\frac{108\\pi}{256} Z \\frac{2^{4/3}}{\\pi^{4/3}} = \\frac{27}{64} Z \\frac{2^{4/3}}{\\pi^{1/3}}\n$$\nNow, we substitute this result into the formula for $E_{x}^{\\mathrm{LDA}}$:\n$$\nE_{x}^{\\mathrm{LDA}} = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left(\\frac{27}{64} Z \\frac{2^{4/3}}{\\pi^{1/3}}\\right) = -Z \\frac{3 \\cdot 27}{4 \\cdot 64} \\frac{3^{1/3} \\cdot 2^{4/3}}{\\pi^{1/3} \\cdot \\pi^{1/3}}\n$$\n$$\nE_{x}^{\\mathrm{LDA}} = -Z \\frac{81}{256} \\frac{3^{1/3} \\cdot 2^{4/3}}{\\pi^{2/3}}\n$$\n\nFinally, we compute the required ratio $R$. The nuclear charge $Z$ is a common factor and cancels out, as expected.\n$$\nR = \\frac{E_{x}^{\\mathrm{LDA}}}{E_{x}^{\\mathrm{HF}}} = \\frac{-Z \\frac{81}{256} \\frac{3^{1/3} 2^{4/3}}{\\pi^{2/3}}}{-Z \\frac{5}{8}} = \\frac{81}{256} \\cdot \\frac{8}{5} \\cdot \\frac{3^{1/3} 2^{4/3}}{\\pi^{2/3}}\n$$\nSimplifying the numerical prefactors:\n$$\nR = \\frac{81}{32 \\cdot 5} \\frac{3^{1/3} 2^{4/3}}{\\pi^{2/3}} = \\frac{81}{160} \\frac{(3 \\cdot 2^4)^{1/3}}{\\pi^{2/3}} = \\frac{81}{160} \\frac{48^{1/3}}{\\pi^{2/3}}\n$$\nThis can be further simplified by extracting $8^{1/3} = 2$:\n$$\nR = \\frac{81}{160} \\frac{(8 \\cdot 6)^{1/3}}{\\pi^{2/3}} = \\frac{81 \\cdot 2 \\cdot 6^{1/3}}{160 \\pi^{2/3}} = \\frac{81}{80} \\frac{6^{1/3}}{\\pi^{2/3}}\n$$\nWe now evaluate this expression numerically.\n$6^{1/3} \\approx 1.81712$\n$\\pi^{2/3} \\approx 2.14503$\n$$\nR \\approx \\frac{81}{80} \\cdot \\frac{1.81712}{2.14503} \\approx 1.0125 \\cdot 0.84713 \\approx 0.8577328\n$$\nRounding to $4$ significant figures, we obtain the final result.", "answer": "$$\n\\boxed{0.8577}\n$$", "id": "2464278"}, {"introduction": "Moving up \"Jacob's Ladder\" from the simple LDA, many of the most successful and widely-used DFT methods are \"hybrid\" functionals. This practice demystifies the structure of the famous B3LYP hybrid functional by revealing its construction as a precisely weighted \"cocktail\" of different energy components, including local exchange, gradient-corrected exchange, different types of correlation, and a critical fraction of exact Hartree-Fock exchange [@problem_id:2464274]. By calculating the contribution of each component for a set of hypothetical molecular energies, you will understand the recipe behind B3LYP's success and the pragmatic engineering involved in modern functional design.", "problem": "You are given the definition of the Becke three-parameter Lee–Yang–Parr (B3LYP) exchange-correlation functional used in Density Functional Theory (DFT) for a closed-shell water molecule. The exchange-correlation energy is constructed by combining five component energies: Slater exchange (Local Spin Density Approximation (LSDA) exchange), Becke 1988 exchange correction, Vosko–Wilk–Nusair (VWN) local correlation, Lee–Yang–Parr (LYP) correlation, and Hartree–Fock (HF) exact exchange. Denote these unweighted component energies by $E_{x}^{\\mathrm{Slater}}$, $E_{x}^{\\mathrm{B88}}$, $E_{c}^{\\mathrm{VWN}}$, $E_{c}^{\\mathrm{LYP}}$, and $E_{x}^{\\mathrm{HF}}$, respectively, all in Hartree.\n\nUse the standard three parameters for B3LYP: $a_{0} = 0.20$, $a_{X} = 0.72$, and $a_{C} = 0.81$. The B3LYP exchange-correlation energy is defined as the linear combination\n$$\nE_{xc}^{\\mathrm{B3LYP}} = \\left(1 - a_{0}\\right) E_{x}^{\\mathrm{Slater}} + a_{X} E_{x}^{\\mathrm{B88}} + \\left(1 - a_{C}\\right) E_{c}^{\\mathrm{VWN}} + a_{C} E_{c}^{\\mathrm{LYP}} + a_{0} E_{x}^{\\mathrm{HF}}.\n$$\nFor each test case below, compute the five weighted component contributions and their sum $E_{xc}^{\\mathrm{B3LYP}}$, all in Hartree. The required output for each test case is a list of six floats in the following order:\n$$\n\\big[\\left(1 - a_{0}\\right) E_{x}^{\\mathrm{Slater}},\\; a_{X} E_{x}^{\\mathrm{B88}},\\; \\left(1 - a_{C}\\right) E_{c}^{\\mathrm{VWN}},\\; a_{C} E_{c}^{\\mathrm{LYP}},\\; a_{0} E_{x}^{\\mathrm{HF}},\\; E_{xc}^{\\mathrm{B3LYP}}\\big].\n$$\n\nAll inputs and outputs must be expressed in Hartree. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list for one test case (for example, $[\\text{case1},\\text{case2},\\dots]$).\n\nTest suite (each tuple corresponds to $\\left(E_{x}^{\\mathrm{Slater}}, E_{x}^{\\mathrm{B88}}, E_{c}^{\\mathrm{VWN}}, E_{c}^{\\mathrm{LYP}}, E_{x}^{\\mathrm{HF}}\\right)$ in Hartree):\n- Case A (water-like, general case): $\\left(-8.000,\\; -1.200,\\; -0.300,\\; -0.500,\\; -7.500\\right)$\n- Case B (boundary, all zero components): $\\left(0.000,\\; 0.000,\\; 0.000,\\; 0.000,\\; 0.000\\right)$\n- Case C (edge, gradient correction positive): $\\left(-10.000,\\; +0.100,\\; -0.400,\\; -0.450,\\; -9.000\\right)$\n- Case D (edge, strong-magnitude components): $\\left(-20.000,\\; -5.000,\\; -1.000,\\; -1.200,\\; -18.000\\right)$", "solution": "The task requires computing the Becke three-parameter Lee–Yang–Parr (B3LYP) exchange-correlation energy by combining component energies through specified weights. The B3LYP functional is a hybrid functional that mixes a fraction of Hartree–Fock (HF) exchange with semi-local exchange and correlation terms. The definition uses the parameters $a_{0}$, $a_{X}$, and $a_{C}$.\n\nGiven $a_{0} = 0.20$, $a_{X} = 0.72$, and $a_{C} = 0.81$, we rewrite the B3LYP exchange-correlation energy in a component-wise “decomposed” form:\n$$\nE_{xc}^{\\mathrm{B3LYP}} = \\underbrace{\\left(1 - a_{0}\\right) E_{x}^{\\mathrm{Slater}}}_{\\text{weighted Slater exchange}} + \\underbrace{a_{X} E_{x}^{\\mathrm{B88}}}_{\\text{weighted Becke 88 exchange}} + \\underbrace{\\left(1 - a_{C}\\right) E_{c}^{\\mathrm{VWN}}}_{\\text{weighted VWN correlation}} + \\underbrace{a_{C} E_{c}^{\\mathrm{LYP}}}_{\\text{weighted LYP correlation}} + \\underbrace{a_{0} E_{x}^{\\mathrm{HF}}}_{\\text{weighted HF exchange}}.\n$$\nDefine the weights explicitly:\n- Slater exchange weight: $c_{\\mathrm{Slater}} = 1 - a_{0} = 1 - 0.20 = 0.80$.\n- Becke 88 exchange weight: $c_{\\mathrm{B88}} = a_{X} = 0.72$.\n- VWN correlation weight: $c_{\\mathrm{VWN}} = 1 - a_{C} = 1 - 0.81 = 0.19$.\n- LYP correlation weight: $c_{\\mathrm{LYP}} = a_{C} = 0.81$.\n- HF exchange weight: $c_{\\mathrm{HF}} = a_{0} = 0.20$.\n\nFor each test case with inputs $\\left(E_{x}^{\\mathrm{Slater}}, E_{x}^{\\mathrm{B88}}, E_{c}^{\\mathrm{VWN}}, E_{c}^{\\mathrm{LYP}}, E_{x}^{\\mathrm{HF}}\\right)$, compute:\n$$\n\\begin{aligned}\nW_{\\mathrm{Slater}} &= c_{\\mathrm{Slater}} \\, E_{x}^{\\mathrm{Slater}},\\\\\nW_{\\mathrm{B88}} &= c_{\\mathrm{B88}} \\, E_{x}^{\\mathrm{B88}},\\\\\nW_{\\mathrm{VWN}} &= c_{\\mathrm{VWN}} \\, E_{c}^{\\mathrm{VWN}},\\\\\nW_{\\mathrm{LYP}} &= c_{\\mathrm{LYP}} \\, E_{c}^{\\mathrm{LYP}},\\\\\nW_{\\mathrm{HF}} &= c_{\\mathrm{HF}} \\, E_{x}^{\\mathrm{HF}},\\\\\nE_{xc}^{\\mathrm{B3LYP}} &= W_{\\mathrm{Slater}} + W_{\\mathrm{B88}} + W_{\\mathrm{VWN}} + W_{\\mathrm{LYP}} + W_{\\mathrm{HF}}.\n\\end{aligned}\n$$\n\nNow evaluate numerically for each case, in Hartree:\n\n- Case A: $\\left(-8.000,\\; -1.200,\\; -0.300,\\; -0.500,\\; -7.500\\right)$\n$$\n\\begin{aligned}\nW_{\\mathrm{Slater}} &= 0.80 \\times (-8.000) = -6.400,\\\\\nW_{\\mathrm{B88}} &= 0.72 \\times (-1.200) = -0.864,\\\\\nW_{\\mathrm{VWN}} &= 0.19 \\times (-0.300) = -0.057,\\\\\nW_{\\mathrm{LYP}} &= 0.81 \\times (-0.500) = -0.405,\\\\\nW_{\\mathrm{HF}} &= 0.20 \\times (-7.500) = -1.500,\\\\\nE_{xc}^{\\mathrm{B3LYP}} &= -6.400 + (-0.864) + (-0.057) + (-0.405) + (-1.500) = -9.226.\n\\end{aligned}\n$$\n\n- Case B: $\\left(0.000,\\; 0.000,\\; 0.000,\\; 0.000,\\; 0.000\\right)$\n$$\n\\begin{aligned}\nW_{\\mathrm{Slater}} &= 0.80 \\times 0.000 = 0.000,\\\\\nW_{\\mathrm{B88}} &= 0.72 \\times 0.000 = 0.000,\\\\\nW_{\\mathrm{VWN}} &= 0.19 \\times 0.000 = 0.000,\\\\\nW_{\\mathrm{LYP}} &= 0.81 \\times 0.000 = 0.000,\\\\\nW_{\\mathrm{HF}} &= 0.20 \\times 0.000 = 0.000,\\\\\nE_{xc}^{\\mathrm{B3LYP}} &= 0.000.\n\\end{aligned}\n$$\n\n- Case C: $\\left(-10.000,\\; +0.100,\\; -0.400,\\; -0.450,\\; -9.000\\right)$\n$$\n\\begin{aligned}\nW_{\\mathrm{Slater}} &= 0.80 \\times (-10.000) = -8.000,\\\\\nW_{\\mathrm{B88}} &= 0.72 \\times (+0.100) = +0.072,\\\\\nW_{\\mathrm{VWN}} &= 0.19 \\times (-0.400) = -0.076,\\\\\nW_{\\mathrm{LYP}} &= 0.81 \\times (-0.450) = -0.3645,\\\\\nW_{\\mathrm{HF}} &= 0.20 \\times (-9.000) = -1.800,\\\\\nE_{xc}^{\\mathrm{B3LYP}} &= -8.000 + 0.072 - 0.076 - 0.3645 - 1.800 = -10.1685.\n\\end{aligned}\n$$\n\n- Case D: $\\left(-20.000,\\; -5.000,\\; -1.000,\\; -1.200,\\; -18.000\\right)$\n$$\n\\begin{aligned}\nW_{\\mathrm{Slater}} &= 0.80 \\times (-20.000) = -16.000,\\\\\nW_{\\mathrm{B88}} &= 0.72 \\times (-5.000) = -3.600,\\\\\nW_{\\mathrm{VWN}} &= 0.19 \\times (-1.000) = -0.190,\\\\\nW_{\\mathrm{LYP}} &= 0.81 \\times (-1.200) = -0.972,\\\\\nW_{\\mathrm{HF}} &= 0.20 \\times (-18.000) = -3.600,\\\\\nE_{xc}^{\\mathrm{B3LYP}} &= -16.000 - 3.600 - 0.190 - 0.972 - 3.600 = -24.362.\n\\end{aligned}\n$$\n\nTherefore, the decomposed outputs per case (each as a list of six floats in Hartree) are:\n- Case A: $\\left[-6.400,\\; -0.864,\\; -0.057,\\; -0.405,\\; -1.500,\\; -9.226\\right]$\n- Case B: $\\left[0.000,\\; 0.000,\\; 0.000,\\; 0.000,\\; 0.000,\\; 0.000\\right]$\n- Case C: $\\left[-8.000,\\; 0.072,\\; -0.076,\\; -0.3645,\\; -1.800,\\; -10.1685\\right]$\n- Case D: $\\left[-16.000,\\; -3.600,\\; -0.190,\\; -0.972,\\; -3.600,\\; -24.362\\right]$\n\nThe program should compute these from the given inputs and print them in a single line as a comma-separated list enclosed in square brackets, with each case represented by its six-element list, all in Hartree.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef b3lyp_decomposition(E_slater, E_b88, E_vwn, E_lyp, E_hf, a0=0.20, aX=0.72, aC=0.81):\n    \"\"\"\n    Compute the B3LYP weighted component contributions and total.\n    Returns a list: [w_slater, w_b88, w_vwn, w_lyp, w_hf, total]\n    All energies are in Hartree.\n    \"\"\"\n    c_slater = 1.0 - a0\n    c_b88 = aX\n    c_vwn = 1.0 - aC\n    c_lyp = aC\n    c_hf = a0\n\n    w_slater = c_slater * E_slater\n    w_b88 = c_b88 * E_b88\n    w_vwn = c_vwn * E_vwn\n    w_lyp = c_lyp * E_lyp\n    w_hf = c_hf * E_hf\n    total = w_slater + w_b88 + w_vwn + w_lyp + w_hf\n\n    return [w_slater, w_b88, w_vwn, w_lyp, w_hf, total]\n\ndef format_list_of_floats(lst):\n    # Format floats consistently, avoiding scientific notation for given magnitudes\n    return \"[\" + \",\".join(f\"{x:.6f}\".rstrip('0').rstrip('.') if '.' in f\"{x:.6f}\" else f\"{x:.6f}\" for x in lst) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement (Hartree units):\n    # Each tuple: (E_x^Slater, E_x^B88, E_c^VWN, E_c^LYP, E_x^HF)\n    test_cases = [\n        (-8.000, -1.200, -0.300, -0.500, -7.500),  # Case A\n        (0.000,  0.000,  0.000,  0.000,  0.000),   # Case B\n        (-10.000, 0.100, -0.400, -0.450, -9.000),  # Case C\n        (-20.000, -5.000, -1.000, -1.200, -18.000) # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        E_slater, E_b88, E_vwn, E_lyp, E_hf = case\n        result = b3lyp_decomposition(E_slater, E_b88, E_vwn, E_lyp, E_hf)\n        results.append(result)\n\n    # Build exact required format: a single line with a list of per-case lists, no extra text.\n    formatted_cases = [format_list_of_floats(r) for r in results]\n    print(f\"[{','.join(formatted_cases)}]\")\n\nsolve()\n```", "id": "2464274"}, {"introduction": "While functionals like PBE and B3LYP are powerful, they suffer from a significant challenge known as self-interaction error, which becomes particularly apparent in systems like stretched molecules. This exercise uses the dissociation of the hydrogen molecular ion, $\\mathrm{H}_2^+$, as a classic case study for this \"delocalization error.\" By comparing the energy landscape from an exact theory, which correctly localizes the electron on one atom, with a PBE-like semi-local functional, you will directly observe how common approximations can lead to unphysical fractional charges on separated fragments [@problem_id:2464317]. This problem provides crucial insight into the limitations of many functionals and motivates the ongoing development of more advanced methods.", "problem": "Consider the dissociation limit of the diatomic ion $\\mathrm{H}_2^+$, in which the internuclear separation $R$ is so large that the overlap between the hydrogen $1s$ orbitals is negligible. Let $n_{\\mathrm{A}}$ and $n_{\\mathrm{B}}$ denote the electron numbers on the two hydrogen sites $\\mathrm{A}$ and $\\mathrm{B}$, respectively, with constraints $0 \\leq n_{\\mathrm{A}} \\leq 1$, $0 \\leq n_{\\mathrm{B}} \\leq 1$, and $n_{\\mathrm{A}} + n_{\\mathrm{B}} = 1$ (one electron total).\n\nDefine a site energy model for each hydrogen in terms of a site occupation $n$ and a small site energy bias $\\Delta$ (in Hartree) that favors site $\\mathrm{A}$ when $\\Delta > 0$ and favors site $\\mathrm{B}$ when $\\Delta < 0$. The one-electron ground-state energy of an isolated hydrogen atom is $E_1$ (a constant that cancels in all comparisons below). Two energy models are to be considered:\n\n- The exact density functional theory (DFT) model, which is piecewise linear in electron number between integers, with site contribution\n  $E_{\\text{site}}^{\\text{exact}}(n; s, \\Delta) = n E_1 - s \\Delta n$, where $s = +1$ for site $\\mathrm{A}$ and $s = -1$ for site $\\mathrm{B}$.\n\n- A semi-local generalized gradient approximation model representative of Perdew–Burke–Ernzerhof (PBE), which exhibits convex deviation from piecewise linearity in fractional electron number, modeled here by a curvature parameter $c > 0$ (in Hartree):\n  $E_{\\text{site}}^{\\text{PBE-like}}(n; s, \\Delta, c) = n E_1 - s \\Delta n - c\\, n (1 - n)$, where $s$ is as above.\n\nThe total energy in each model is the sum of the two site energies,\n$E^{\\ast}(n_{\\mathrm{A}}, n_{\\mathrm{B}}; \\Delta, c) = E_{\\text{site},\\mathrm{A}}^{\\ast}(n_{\\mathrm{A}}; +1, \\Delta, c) + E_{\\text{site},\\mathrm{B}}^{\\ast}(n_{\\mathrm{B}}; -1, \\Delta, c)$, with $\\ast \\in \\{\\text{exact}, \\text{PBE-like}\\}$ and $c$ ignored for the exact model. The parameter $E_1$ cancels from the minimization and need not be specified. The task is to minimize $E^{\\ast}$ subject to $n_{\\mathrm{A}} + n_{\\mathrm{B}} = 1$ and the box constraints to obtain the predicted electron number on site $\\mathrm{A}$, denoted $n_{\\mathrm{A}}^{\\ast}$. When multiple minimizers exist in the exact model (for example, when $\\Delta = 0$), choose $n_{\\mathrm{A}}^{\\text{exact}} = 1$ as the deterministic tie-breaking convention.\n\nImplement a program that, for each parameter pair $(\\Delta, c)$, computes and returns both $n_{\\mathrm{A}}^{\\text{exact}}$ and $n_{\\mathrm{A}}^{\\text{PBE-like}}$. All $\\Delta$ and $c$ values are given in Hartree, and the outputs $n_{\\mathrm{A}}^{\\text{exact}}$ and $n_{\\mathrm{A}}^{\\text{PBE-like}}$ are dimensionless. Report each output value rounded to six decimal places.\n\nUse the following test suite of parameter values, which probe symmetry, weak and strong asymmetries, opposite bias, and numerical stability:\n- Test $1$: $\\Delta = 0$, $c = 0.20$.\n- Test $2$: $\\Delta = 0.01$, $c = 0.20$.\n- Test $3$: $\\Delta = 0.20$, $c = 0.01$.\n- Test $4$: $\\Delta = -0.01$, $c = 0.20$.\n- Test $5$: $\\Delta = 0$, $c = 1.0\\times 10^{-9}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of pairs, each pair being the two values $[n_{\\mathrm{A}}^{\\text{exact}}, n_{\\mathrm{A}}^{\\text{PBE-like}}]$ in order, and the full list enclosed in square brackets. For example, an acceptable format is $[[x_1,y_1],[x_2,y_2],\\dots]$, where each $x_i$ and $y_i$ is a decimal rounded to six places.", "solution": "In the dissociation limit $R \\to \\infty$ of $\\mathrm{H}_2^+$, the electronic coupling between the two hydrogen $1s$ orbitals vanishes, so that the electron number distribution can be described by two site occupations $n_{\\mathrm{A}}$ and $n_{\\mathrm{B}}$ satisfying $n_{\\mathrm{A}} + n_{\\mathrm{B}} = 1$ and $0 \\leq n_{\\mathrm{A}}, n_{\\mathrm{B}} \\leq 1$. The total energy is the sum of independent site energies. A small site bias $\\Delta$ models an infinitesimal external potential that favors site $\\mathrm{A}$ when $\\Delta > 0$ and favors site $\\mathrm{B}$ when $\\Delta < 0$.\n\nFor the exact density functional, the energy between integers is piecewise linear as a function of electron number. For a site with occupation $n$ and sign $s \\in \\{+1,-1\\}$ denoting $\\mathrm{A}$ or $\\mathrm{B}$, respectively, we write\n$$\nE_{\\text{site}}^{\\text{exact}}(n; s, \\Delta) = n E_1 - s \\Delta n,\n$$\nwhere $E_1$ is the one-electron ground-state energy of hydrogen. The total energy is\n$$\nE^{\\text{exact}}(n_{\\mathrm{A}}, n_{\\mathrm{B}}; \\Delta) = n_{\\mathrm{A}} E_1 - (+1)\\Delta n_{\\mathrm{A}} + n_{\\mathrm{B}} E_1 - (-1)\\Delta n_{\\mathrm{B}}.\n$$\nUsing $n_{\\mathrm{B}} = 1 - n_{\\mathrm{A}}$, the $E_1$ terms sum to $E_1$ and are constant; thus, minimizing $E^{\\text{exact}}$ reduces to minimizing\n$$\n\\tilde{E}^{\\text{exact}}(n_{\\mathrm{A}}; \\Delta) = -\\Delta (2 n_{\\mathrm{A}} - 1)\n$$\nover $0 \\leq n_{\\mathrm{A}} \\leq 1$. Because $\\tilde{E}^{\\text{exact}}$ is linear in $n_{\\mathrm{A}}$, the minimizer is at the boundary: if $\\Delta > 0$ then $n_{\\mathrm{A}}^{\\text{exact}} = 1$, if $\\Delta < 0$ then $n_{\\mathrm{A}}^{\\text{exact}} = 0$, and if $\\Delta = 0$ then any $n_{\\mathrm{A}} \\in [0,1]$ minimizes the energy. To produce a deterministic numerical output, we adopt the stipulated tie-breaking convention $n_{\\mathrm{A}}^{\\text{exact}} = 1$ when $\\Delta = 0$.\n\nFor a semi-local generalized gradient approximation such as Perdew–Burke–Ernzerhof (PBE), the energy as a function of fractional electron number is convex between integers due to delocalization error. We model this convexity by adding a curvature term $-c\\, n(1 - n)$ with $c > 0$, giving the site energy\n$$\nE_{\\text{site}}^{\\text{PBE-like}}(n; s, \\Delta, c) = n E_1 - s \\Delta n - c\\, n(1 - n).\n$$\nThe total energy becomes, up to an additive constant,\n$$\n\\tilde{E}^{\\text{PBE-like}}(n_{\\mathrm{A}}; \\Delta, c) = -2 c\\, n_{\\mathrm{A}} (1 - n_{\\mathrm{A}}) - \\Delta (2 n_{\\mathrm{A}} - 1),\n$$\nusing $n_{\\mathrm{B}} = 1 - n_{\\mathrm{A}}$. This is a concave quadratic in $n_{\\mathrm{A}}$ multiplied by $-1$ plus a linear tilt; more explicitly,\n$$\n\\tilde{E}^{\\text{PBE-like}}(n_{\\mathrm{A}}; \\Delta, c) = -2 c \\left[n_{\\mathrm{A}} - \\tfrac{1}{2}\\right]^2 + \\tfrac{c}{2} - \\Delta (2 n_{\\mathrm{A}} - 1).\n$$\nTo find the unconstrained minimizer, differentiate with respect to $n_{\\mathrm{A}}$ and set the derivative to zero:\n$$\n\\frac{d \\tilde{E}^{\\text{PBE-like}}}{d n_{\\mathrm{A}}} = -2 c (1 - 2 n_{\\mathrm{A}}) - 2 \\Delta = 0.\n$$\nSolving gives\n$$\n1 - 2 n_{\\mathrm{A}} = - \\frac{\\Delta}{c} \\quad \\Rightarrow \\quad n_{\\mathrm{A}}^{\\text{unconstrained}} = \\frac{1}{2} \\left(1 + \\frac{\\Delta}{c}\\right).\n$$\nEnforcing the physical box constraints $0 \\leq n_{\\mathrm{A}} \\leq 1$ yields the final solution\n$$\nn_{\\mathrm{A}}^{\\text{PBE-like}}(\\Delta, c) = \\min\\left\\{1, \\max\\left\\{0, \\frac{1}{2} \\left(1 + \\frac{\\Delta}{c}\\right)\\right\\}\\right\\}.\n$$\nThis expression shows directly that when $\\Delta = 0$ one obtains $n_{\\mathrm{A}}^{\\text{PBE-like}} = \\tfrac{1}{2}$, that small nonzero $\\Delta$ produces a fractional $n_{\\mathrm{A}}$ close to $\\tfrac{1}{2}$, and that only when $|\\Delta| \\geq c$ does the solution saturate to an integer occupation at a boundary. This demonstrates the characteristic PBE tendency to predict fractional charges upon dissociation, in contrast with the exact piecewise linear functional which localizes the electron entirely on the lower-energy site.\n\nAlgorithmic implementation proceeds as follows for each test pair $(\\Delta, c)$:\n1. Compute $n_{\\mathrm{A}}^{\\text{exact}}$ by the rule $n_{\\mathrm{A}}^{\\text{exact}} = 1$ if $\\Delta \\geq 0$ and $n_{\\mathrm{A}}^{\\text{exact}} = 0$ if $\\Delta < 0$, honoring the tie-breaking convention at $\\Delta = 0$.\n2. Compute $n_{\\mathrm{A}}^{\\text{PBE-like}}$ using $n_{\\mathrm{A}}^{\\text{unconstrained}} = \\tfrac{1}{2}\\left(1 + \\tfrac{\\Delta}{c}\\right)$ followed by clamping to the interval $[0,1]$.\n3. Round each result to six decimal places for output.\n\nApplying this to the specified test suite:\n- Test $1$ ($\\Delta = 0$, $c = 0.20$): $n_{\\mathrm{A}}^{\\text{exact}} = 1$, $n_{\\mathrm{A}}^{\\text{PBE-like}} = 0.500000$.\n- Test $2$ ($\\Delta = 0.01$, $c = 0.20$): $n_{\\mathrm{A}}^{\\text{exact}} = 1$, $n_{\\mathrm{A}}^{\\text{PBE-like}} = \\tfrac{1}{2}(1 + 0.05) = 0.525000$.\n- Test $3$ ($\\Delta = 0.20$, $c = 0.01$): $n_{\\mathrm{A}}^{\\text{exact}} = 1$, $n_{\\mathrm{A}}^{\\text{PBE-like}} = \\min\\{1, \\tfrac{1}{2}(1 + 20)\\} = 1.000000$.\n- Test $4$ ($\\Delta = -0.01$, $c = 0.20$): $n_{\\mathrm{A}}^{\\text{exact}} = 0$, $n_{\\mathrm{A}}^{\\text{PBE-like}} = \\tfrac{1}{2}(1 - 0.05) = 0.475000$.\n- Test $5$ ($\\Delta = 0$, $c = 1.0 \\times 10^{-9}$): $n_{\\mathrm{A}}^{\\text{exact}} = 1$, $n_{\\mathrm{A}}^{\\text{PBE-like}} = 0.500000$.\n\nThese results confirm that the PBE-like semi-local model predicts a fractional charge distribution at dissociation for $\\mathrm{H}_2^+$ in the symmetric case and for small asymmetries, illustrating the classic delocalization error of semi-local exchange-correlation functionals.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef nA_exact(delta: float) -> float:\n    \"\"\"\n    Exact DFT piecewise-linear model:\n    - If delta > 0: all electron on A -> nA = 1.0\n    - If delta < 0: all electron on B -> nA = 0.0\n    - If delta == 0: tie -> choose nA = 1.0 (deterministic tie-break)\n    \"\"\"\n    if delta < 0.0:\n        return 0.0\n    else:\n        return 1.0\n\ndef nA_pbe_like(delta: float, c: float) -> float:\n    \"\"\"\n    Semi-local PBE-like convex model with curvature c > 0:\n    nA_unconstrained = 0.5 * (1 + delta / c)\n    Then clamp to [0.0, 1.0].\n    \"\"\"\n    # Defensive check: ensure c > 0 as per model; if not, treat as exact behavior.\n    if c <= 0.0:\n        return nA_exact(delta)\n    nA = 0.5 * (1.0 + (delta / c))\n    # Clamp to physical bounds\n    if nA < 0.0:\n        nA = 0.0\n    elif nA > 1.0:\n        nA = 1.0\n    return nA\n\ndef format_pair(x: float, y: float) -> str:\n    \"\"\"Format a pair [x,y] with each value rounded to six decimals, no spaces.\"\"\"\n    return f\"[{x:.6f},{y:.6f}]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is (Delta in Hartree, c in Hartree)\n    test_cases = [\n        (0.0, 0.20),        # Test 1: symmetric, moderate curvature\n        (0.01, 0.20),       # Test 2: weak asymmetry, moderate curvature\n        (0.20, 0.01),       # Test 3: strong asymmetry, small curvature\n        (-0.01, 0.20),      # Test 4: opposite bias\n        (0.0, 1.0e-9),      # Test 5: symmetric, tiny curvature\n    ]\n\n    results_str_parts = []\n    for delta, c in test_cases:\n        nA_ex = nA_exact(delta)\n        nA_pbe = nA_pbe_like(delta, c)\n        results_str_parts.append(format_pair(nA_ex, nA_pbe))\n\n    # Final print statement in the exact required format: list of pairs\n    print(f\"[{','.join(results_str_parts)}]\")\n\nsolve()\n```", "id": "2464317"}]}