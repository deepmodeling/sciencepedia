{"hands_on_practices": [{"introduction": "To appreciate the design of modern Generalized Gradient Approximations (GGAs), we first explore why the most straightforward improvement on the Local Density Approximation (LDA) fails. This exercise guides you through an analytical calculation for the hydrogen atom, demonstrating that the second-order Gradient Expansion Approximation (GEA) can yield a less accurate exchange energy than LDA. This counterintuitive result historically underscored that a simple Taylor-like expansion is insufficient and that non-perturbative forms for the enhancement factor are necessary [@problem_id:2464549].", "problem": "Consider the exchange-only energy of the Hydrogen atom within Kohn–Sham density functional theory, using Hartree atomic units (set $\\hbar = m_{e} = e^{2}/(4\\pi \\varepsilon_{0}) = a_{0} = 1$ so that energies are in Hartree and lengths in Bohr). The ground-state Hydrogen $1s$ electron density is spherically symmetric and given by $n(r) = \\frac{1}{\\pi}\\exp(-2 r)$, with spin densities $n_{\\uparrow}(r) = n(r)$ and $n_{\\downarrow}(r) = 0$.\n\nAdopt the Local Spin Density Approximation (LSDA) for exchange,\n$$\nE_{x}^{\\mathrm{LSDA}}[n_{\\uparrow}, n_{\\downarrow}] \\;=\\; -C_{x}\\int \\Big(n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\Big)\\,d^{3}r,\n$$\nwith $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$.\n\nFor the second-order Gradient Expansion Approximation (GEA2) of the exchange energy of an unpolarized electron gas, use\n$$\nE_{x}^{\\mathrm{GEA2,unpol}}[n] \\;=\\; -C_{x}\\,2^{-1/3}\\int n(\\mathbf{r})^{4/3}\\Big(1 + \\mu\\, s(\\mathbf{r})^{2}\\Big)\\,d^{3}r,\n$$\nwith the reduced gradient $s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,n(\\mathbf{r})}$, the local Fermi wavevector $k_{F}(\\mathbf{r}) = \\big(3\\pi^{2}n(\\mathbf{r})\\big)^{1/3}$, and the exact second-order coefficient $\\mu = \\frac{10}{81}$. Use the exact spin-scaling relation for exchange,\n$$\nE_{x}[n_{\\uparrow}, n_{\\downarrow}] \\;=\\; \\frac{1}{2}\\,E_{x}^{\\mathrm{GEA2,unpol}}[2n_{\\uparrow}] \\;+\\; \\frac{1}{2}\\,E_{x}^{\\mathrm{GEA2,unpol}}[2n_{\\downarrow}].\n$$\n\nCompute the exchange-energy difference\n$$\n\\Delta E_{x} \\;=\\; E_{x}^{\\mathrm{GEA2}} - E_{x}^{\\mathrm{LSDA}}\n$$\nfor the Hydrogen $1s$ density specified above, and provide your result as a single closed-form analytic expression in Hartree. Do not round your answer.", "solution": "The problem requires the computation of the difference between the second-order gradient expansion approximation (GEA2) exchange energy and the local spin density approximation (LSDA) exchange energy for the Hydrogen $1s$ atom. The problem is scientifically grounded, well-posed, and all necessary components are provided. We shall proceed with the derivation.\n\nThe quantity to be calculated is $\\Delta E_{x} = E_{x}^{\\mathrm{GEA2}} - E_{x}^{\\mathrm{LSDA}}$.\n\nFirst, we establish the expression for the LSDA exchange energy for the given system. The spin densities are $n_{\\uparrow}(\\mathbf{r}) = n(r) = \\frac{1}{\\pi}\\exp(-2r)$ and $n_{\\downarrow}(\\mathbf{r}) = 0$. Using the provided definition for $E_{x}^{\\mathrm{LSDA}}$:\n$$\nE_{x}^{\\mathrm{LSDA}} = -C_{x}\\int \\Big(n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\Big)\\,d^{3}r = -C_{x}\\int n(r)^{4/3}\\,d^{3}r\n$$\nThis represents the LSDA energy for a fully spin-polarized system.\n\nNext, we establish the expression for the GEA2 exchange energy. The problem provides a spin-scaling relation to construct the spin-dependent GEA2 energy from the unpolarized functional $E_{x}^{\\mathrm{GEA2,unpol}}[n]$:\n$$\nE_{x}^{\\mathrm{GEA2}} = \\frac{1}{2}\\,E_{x}^{\\mathrm{GEA2,unpol}}[2n_{\\uparrow}] + \\frac{1}{2}\\,E_{x}^{\\mathrm{GEA2,unpol}}[2n_{\\downarrow}]\n$$\nSince $n_{\\downarrow}=0$, the second term vanishes. Let $n'(\\mathbf{r}) = 2n_{\\uparrow}(\\mathbf{r}) = 2n(r)$. The GEA2 energy is:\n$$\nE_{x}^{\\mathrm{GEA2}} = \\frac{1}{2}\\,E_{x}^{\\mathrm{GEA2,unpol}}[2n] = \\frac{1}{2} \\left[ -C_{x}\\,2^{-1/3}\\int (2n)^{4/3}\\Big(1 + \\mu\\, s'^{2}\\Big)\\,d^{3}r \\right]\n$$\nwhere $s'$ is the reduced gradient for the density $n' = 2n$. We must relate $s'$ to the reduced gradient $s$ for the density $n$. The reduced gradient for a generic density $\\rho$ is $s_{\\rho} = \\frac{|\\nabla \\rho|}{2 k_{F,\\rho} \\rho}$, where $k_{F,\\rho} = (3\\pi^2\\rho)^{1/3}$.\nFor $\\rho=n' = 2n$, we have $\\nabla n' = 2\\nabla n$ and $k_{F,n'} = (3\\pi^2(2n))^{1/3} = 2^{1/3}k_{F,n}$.\nTherefore, the reduced gradient $s'$ is:\n$$\ns' = \\frac{|\\nabla(2n)|}{2 k_{F,2n} (2n)} = \\frac{2|\\nabla n|}{2 (2^{1/3}k_{F,n}) (2n)} = \\frac{|\\nabla n|}{2 \\cdot 2^{1/3} k_{F,n} n} = 2^{-1/3} s\n$$\nwhere $s$ is the reduced gradient for density $n$. Substituting this into the GEA2 expression:\n$$\nE_{x}^{\\mathrm{GEA2}} = \\frac{1}{2} \\left[ -C_{x}\\,2^{-1/3}\\int 2^{4/3}n^{4/3}\\Big(1 + \\mu\\, (2^{-1/3}s)^{2}\\Big)\\,d^{3}r \\right]\n$$\n$$\nE_{x}^{\\mathrm{GEA2}} = \\frac{1}{2} \\left[ -C_{x}\\,2^{1} \\int n^{4/3}\\Big(1 + \\mu\\, 2^{-2/3}s^{2}\\Big)\\,d^{3}r \\right]\n$$\n$$\nE_{x}^{\\mathrm{GEA2}} = -C_{x} \\int n^{4/3}\\,d^{3}r - C_{x}\\mu\\,2^{-2/3} \\int n^{4/3}s^{2}\\,d^{3}r\n$$\nThe first term is precisely $E_{x}^{\\mathrm{LSDA}}$. Thus, the difference $\\Delta E_x$ simplifies significantly:\n$$\n\\Delta E_{x} = E_{x}^{\\mathrm{GEA2}} - E_{x}^{\\mathrm{LSDA}} = - C_{x}\\,\\mu\\,2^{-2/3} \\int n(r)^{4/3}s(r)^{2}\\,d^{3}r\n$$\nOur task reduces to computing the integral. First, we find the reduced gradient $s(r)$ for the Hydrogen $1s$ density $n(r) = \\frac{1}{\\pi}\\exp(-2r)$. For a spherically symmetric density, the gradient is $\\nabla n(r) = \\frac{dn}{dr}\\hat{r}$.\n$$\n|\\nabla n(r)| = \\left| \\frac{d}{dr} \\left( \\frac{1}{\\pi}\\exp(-2r) \\right) \\right| = \\left| \\frac{-2}{\\pi}\\exp(-2r) \\right| = 2n(r)\n$$\nThe reduced gradient $s(r)$ is:\n$$\ns(r) = \\frac{|\\nabla n(r)|}{2 k_{F}(r) n(r)} = \\frac{2n(r)}{2 (3\\pi^2 n(r))^{1/3} n(r)} = (3\\pi^2 n(r))^{-1/3}\n$$\nSo, $s(r)^2 = (3\\pi^2 n(r))^{-2/3} = (3\\pi^2)^{-2/3} n(r)^{-2/3}$.\nNow we evaluate the integral:\n$$\n\\int n(r)^{4/3}s(r)^{2}\\,d^{3}r = \\int n(r)^{4/3} (3\\pi^2)^{-2/3} n(r)^{-2/3}\\,d^{3}r = (3\\pi^2)^{-2/3} \\int n(r)^{2/3}\\,d^{3}r\n$$\nThe volume element is $d^3r = 4\\pi r^2 dr$.\n$$\n\\int n(r)^{2/3}\\,d^{3}r = \\int_{0}^{\\infty} \\left(\\frac{1}{\\pi}\\exp(-2r)\\right)^{2/3} 4\\pi r^2\\,dr = 4\\pi^{1/3} \\int_{0}^{\\infty} r^2 \\exp\\left(-\\frac{4}{3}r\\right)\\,dr\n$$\nThis is a standard integral of the form $\\int_0^\\infty x^k \\exp(-ax) dx = \\frac{k!}{a^{k+1}}$. With $k=2$ and $a=4/3$:\n$$\n\\int_{0}^{\\infty} r^2 \\exp\\left(-\\frac{4}{3}r\\right)\\,dr = \\frac{2!}{(4/3)^{3}} = \\frac{2}{64/27} = \\frac{54}{64} = \\frac{27}{32}\n$$\nSo, the integral over the density is:\n$$\n\\int n(r)^{2/3}\\,d^{3}r = 4\\pi^{1/3} \\left(\\frac{27}{32}\\right) = \\frac{27}{8}\\pi^{1/3}\n$$\nSubstituting this result back:\n$$\n\\int n(r)^{4/3}s(r)^{2}\\,d^{3}r = (3\\pi^2)^{-2/3} \\left(\\frac{27}{8}\\pi^{1/3}\\right) = \\frac{1}{3^{2/3}\\pi^{4/3}} \\frac{3^3}{8}\\pi^{1/3} = \\frac{3^{7/3}}{8\\pi}\n$$\nFinally, we compute $\\Delta E_x$ by substituting the values for the constants and the integral:\n$$\n\\Delta E_{x} = - C_{x}\\,\\mu\\,2^{-2/3} \\left( \\frac{3^{7/3}}{8\\pi} \\right)\n$$\nUsing the given constants $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} = \\frac{3^{4/3}}{4\\pi^{1/3}}$ and $\\mu = \\frac{10}{81} = \\frac{10}{3^4}$:\n$$\n\\Delta E_{x} = - \\left( \\frac{3^{4/3}}{4\\pi^{1/3}} \\right) \\left( \\frac{10}{3^4} \\right) 2^{-2/3} \\left( \\frac{3^{7/3}}{8\\pi} \\right)\n$$\nWe group the terms by factors:\nNumerical constants: $-\\frac{10}{4 \\cdot 8} = -\\frac{10}{32} = -\\frac{5}{16}$.\nPowers of $2$: $2^{-2/3}$.\nPowers of $3$: $3^{4/3} \\cdot 3^{-4} \\cdot 3^{7/3} = 3^{4/3 - 12/3 + 7/3} = 3^{-1/3}$.\nPowers of $\\pi$: $\\pi^{-1/3} \\cdot \\pi^{-1} = \\pi^{-4/3}$.\nCombining these gives:\n$$\n\\Delta E_{x} = -\\frac{5}{16} \\cdot 2^{-2/3} \\cdot 3^{-1/3} \\cdot \\pi^{-4/3}\n$$\nThis expression can be rearranged for clarity:\n$$\n\\Delta E_{x} = -\\frac{5}{16} (2^2 \\cdot 3)^{-1/3} \\pi^{-4/3} = -\\frac{5}{16} (12)^{-1/3} \\pi^{-4/3} = -\\frac{5}{16} (12\\pi^4)^{-1/3}\n$$\nThis constitutes the final closed-form analytic expression for the energy difference.", "answer": "$$\n\\boxed{-\\frac{5}{16}\\left(12\\pi^{4}\\right)^{-1/3}}\n$$", "id": "2464549"}, {"introduction": "While GGAs are a significant improvement over LDA, they suffer from fundamental limitations, a key one being the self-interaction error (SIE). An electron in a one-electron system, such as a hydrogen atom, should not interact with itself, yet approximate functionals like GGA introduce a spurious self-interaction. This conceptual problem delves into the SIE by asking you to analyze why a GGA calculation on a hydrogen atom yields different, incorrect energies depending on whether the calculation is spin-polarized or not, revealing a deep inconsistency in the functional's treatment of one-electron and fractional-spin systems [@problem_id:2464520].", "problem": "A single hydrogen atom has one electron. In Kohn–Sham Density Functional Theory (DFT), the total energy is decomposed into a noninteracting kinetic energy, a classical electron–electron repulsion (the Hartree term), an exchange–correlation term, and the interaction with the external potential. For any one-electron system, the exact electron–electron interaction energy in the true Hamiltonian is zero. A spin-polarized calculation treats spin-up and spin-down densities separately as $n_{\\uparrow}(\\mathbf{r})$ and $n_{\\downarrow}(\\mathbf{r})$, while a non-spin-polarized calculation uses a single density $n(\\mathbf{r})$ that is often effectively split as $n_{\\uparrow}=n_{\\downarrow}=n/2$ by fractional occupation to enforce zero net magnetization. Consider performing both a spin-polarized and a non-spin-polarized calculation for the hydrogen atom using a semilocal Generalized Gradient Approximation (GGA) exchange–correlation functional.\n\nWhich statement best explains why the two GGA total energies are different and why at least one of them is incorrect with respect to the exact result?\n\nA. In the exact functional for any one-electron density, the exchange–correlation term must cancel the entire Hartree self-interaction independent of spin polarization, yielding $E_{\\mathrm{H}}+E_{\\mathrm{xc}}=0$. Semilocal GGA does not satisfy this condition: when $n_{\\uparrow}=n$ and $n_{\\downarrow}=0$ it only partly cancels the self-interaction, and when $n_{\\uparrow}=n_{\\downarrow}=n/2$ there is an additional opposite-spin Coulomb term from $n_{\\uparrow}n_{\\downarrow}$ that semilocal exchange cannot cancel. This violation of the one-electron and fractional-spin constraints makes the spin-polarized and non-spin-polarized GGA energies differ, with at least one deviating from the exact hydrogen value.\n\nB. The difference arises because the spin-polarized GGA includes spin–orbit coupling that lowers the hydrogen energy, whereas the non-spin-polarized calculation omits spin–orbit effects.\n\nC. The non-spin-polarized calculation violates the Pauli exclusion principle for hydrogen, so it is unphysical and its Kohn–Sham equations have no valid solution; any energy difference merely reflects that inconsistency.\n\nD. The discrepancy is purely numerical: with sufficiently dense real-space grids and tight integral thresholds, the spin-polarized and non-spin-polarized GGA energies for hydrogen become identical by construction.\n\nE. In GGA the Kohn–Sham kinetic energy becomes exact for one-electron densities only when the calculation is spin-polarized; the non-spin-polarized kinetic energy is intrinsically approximate and is the sole source of the energy difference.", "solution": "The supplied problem is a valid and well-posed question in the field of computational quantum chemistry. I will proceed with a rigorous analysis.\n\nThe problem asks for an explanation of the energy difference between a spin-polarized and a non-spin-polarized Generalized Gradient Approximation (GGA) calculation for a hydrogen atom, and why at least one of these energies is incorrect.\n\nFirst, let us establish the exact conditions for a one-electron system, such as the hydrogen atom, within the framework of Kohn-Sham Density Functional Theory (DFT). The total energy of an interacting electron system in an external potential $v_{ext}(\\mathbf{r})$ is given by:\n$$E[n] = T[n] + V_{ee}[n] + \\int n(\\mathbf{r}) v_{ext}(\\mathbf{r}) d\\mathbf{r}$$\nwhere $T[n]$ is the kinetic energy of the interacting electrons, and $V_{ee}[n]$ is the electron-electron interaction energy. For a one-electron system, $V_{ee}[n]$ is exactly zero. The energy is simply $E = T_e + V_{ext}$, the sum of the electron's kinetic energy and its potential energy due to the external potential (the nucleus).\n\nIn Kohn-Sham DFT, the total energy is expressed in terms of a fictitious non-interacting system that shares the same ground-state density $n(\\mathbf{r})$ as the real system:\n$$E_{KS}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\nHere, $T_s[n]$ is the kinetic energy of the non-interacting Kohn-Sham electrons, $E_{ext}[n]$ is the interaction with the external potential, $J[n]$ is the classical Hartree Coulomb repulsion energy, and $E_{xc}[n]$ is the exchange-correlation energy.\n\nFor a one-electron system, the exact Kohn-Sham system is identical to the real system. Thus, the non-interacting kinetic energy $T_s[n]$ is equal to the true kinetic energy $T_e$. For the total energy to be exact, the remaining terms must sum to zero:\n$$J[n] + E_{xc}[n] = 0$$\nThe Hartree energy is the classical self-repulsion of the electron density with itself:\n$$J[n] = \\frac{1}{2} \\iint \\frac{n(\\mathbf{r})n(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|} d\\mathbf{r} d\\mathbf{r'}$$\nThis term is non-zero and represents a spurious self-interaction. Therefore, for any one-electron density, the exact exchange-correlation functional must exactly cancel this self-interaction:\n$$E_{xc}^{\\text{exact}}[n] = -J[n]$$\nSpecifically, for a one-electron system, the correlation energy is zero ($E_c^{\\text{exact}}[n]=0$), so the cancellation must come entirely from the exchange part: $E_x^{\\text{exact}}[n] = -J[n]$. Failure to satisfy this condition leads to the self-interaction error (SIE).\n\nApproximate functionals like GGA are \"semilocal,\" meaning the energy density at a point $\\mathbf{r}$ depends only on the electron density and its gradient at that same point, i.e., $E_{xc}^{\\text{GGA}}[n_{\\uparrow}, n_{\\downarrow}] = \\int \\epsilon_{xc}(n_{\\uparrow}, n_{\\downarrow}, \\nabla n_{\\uparrow}, \\nabla n_{\\downarrow}) d\\mathbf{r}$. This local nature prevents them from exactly canceling the non-local Hartree self-interaction term $J[n]$.\n\nNow, let us analyze the two cases described:\n\n1.  **Spin-polarized calculation:** For a hydrogen atom (one electron, spin-up by convention), the densities are $n_{\\uparrow}(\\mathbf{r})=n(\\mathbf{r})$ and $n_{\\downarrow}(\\mathbf{r})=0$. The total density is $n=n_{\\uparrow}$. The spurious interaction energy is $J[n_{\\uparrow}]$. The GGA functional provides an exchange-correlation energy $E_{xc}^{\\text{GGA}}[n_{\\uparrow}, 0]$. For most common GGAs, the correlation part is zero for a fully spin-polarized system, $E_c^{\\text{GGA}}[n_{\\uparrow}, 0]=0$. The exchange part $E_x^{\\text{GGA}}[n_{\\uparrow}, 0]$ only partially cancels the Hartree term $J[n_{\\uparrow}]$. The residual energy, $J[n_{\\uparrow}] + E_x^{\\text{GGA}}[n_{\\uparrow}, 0]$, is the one-electron SIE, which is non-zero. This makes the total energy incorrect.\n\n2.  **Non-spin-polarized calculation:** This case models a \"non-magnetic\" hydrogen atom by artificially setting the spin densities to be equal: $n_{\\uparrow}(\\mathbf{r}) = n_{\\downarrow}(\\mathbf{r}) = n(\\mathbf{r})/2$. This describes a fictitious state with half an electron of spin-up and half an electron of spin-down at every point. This is an example of what is known as a fractional spin state. The total interaction energy to be canceled is the Hartree energy of the total density, $J[n] = J[n_{\\uparrow}+n_{\\downarrow}]$. This term can be decomposed into:\n    $$J[n] = J[n_{\\uparrow}] + J[n_{\\downarrow}] + \\iint \\frac{n_{\\uparrow}(\\mathbf{r})n_{\\downarrow}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|} d\\mathbf{r} d\\mathbf{r'}$$\n    Standard semilocal exchange functionals, $E_x^{\\text{GGA}}[n_{\\uparrow}, n_{\\downarrow}]$, are constructed to approximate exchange interactions, which occur only between electrons of the *same* spin. Therefore, $E_x^{\\text{GGA}}$ has no component that can cancel the spurious opposite-spin Coulomb term $\\iint \\frac{n_{\\uparrow}(\\mathbf{r})n_{\\downarrow}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|} d\\mathbf{r} d\\mathbf{r'}$. Furthermore, with both $n_{\\uparrow} \\ne 0$ and $n_{\\downarrow} \\ne 0$, most GGA functionals yield a non-zero, spurious correlation energy $E_c^{\\text{GGA}}[n_{\\uparrow}, n_{\\downarrow}]$, which is fundamentally incorrect for a one-electron system. This leads to a very large error, known as the fractional spin error, which is a severe manifestation of SIE.\n\nBecause the nature and magnitude of the SIE are different in the spin-polarized ($n_{\\downarrow}=0$) and non-spin-polarized ($n_{\\uparrow}=n_{\\downarrow}$) cases, the two calculations yield different total energies. Since neither functional form satisfies the exact condition $J[n]+E_{xc}[n]=0$, both energies are incorrect with respect to the exact hydrogen atom energy.\n\nNow, I will evaluate each option.\n\nA. In the exact functional for any one-electron density, the exchange–correlation term must cancel the entire Hartree self-interaction independent of spin polarization, yielding $E_{\\mathrm{H}}+E_{\\mathrm{xc}}=0$. Semilocal GGA does not satisfy this condition: when $n_{\\uparrow}=n$ and $n_{\\downarrow}=0$ it only partly cancels the self-interaction, and when $n_{\\uparrow}=n_{\\downarrow}=n/2$ there is an additional opposite-spin Coulomb term from $n_{\\uparrow}n_{\\downarrow}$ that semilocal exchange cannot cancel. This violation of the one-electron and fractional-spin constraints makes the spin-polarized and non-spin-polarized GGA energies differ, with at least one deviating from the exact hydrogen value.\n**Verdict:** **Correct**. This statement provides a precise and complete explanation based on the principles outlined above. It correctly identifies the exact condition ($E_H+E_{xc}=0$, where $E_H$ is the Hartree energy), the failure of semilocal GGA to meet it, and the distinct ways this failure manifests in the integer-spin (spin-polarized) and fractional-spin (non-spin-polarized) cases.\n\nB. The difference arises because the spin-polarized GGA includes spin–orbit coupling that lowers the hydrogen energy, whereas the non-spin-polarized calculation omits spin–orbit effects.\n**Verdict:** **Incorrect**. Standard GGA functionals do not account for spin-orbit coupling, which is a relativistic effect. This effect must be introduced separately into the Hamiltonian. The energy difference in this problem is a non-relativistic artifact of the approximate exchange-correlation functional.\n\nC. The non-spin-polarized calculation violates the Pauli exclusion principle for hydrogen, so it is unphysical and its Kohn–Sham equations have no valid solution; any energy difference merely reflects that inconsistency.\n**Verdict:** **Incorrect**. The setup $n_{\\uparrow}=n_{\\downarrow}=n/2$ is indeed unphysical for a single electron, but it does not formally violate the Pauli exclusion principle. Most importantly, the Kohn-Sham equations for this setup are well-defined and can be solved self-consistently to yield a convergent energy. The problem is that the functional gives a very poor energy for this fictitious state, not that a solution is non-existent.\n\nD. The discrepancy is purely numerical: with sufficiently dense real-space grids and tight integral thresholds, the spin-polarized and non-spin-polarized GGA energies for hydrogen become identical by construction.\n**Verdict:** **Incorrect**. The difference is fundamental to the mathematical form of the GGA functional. The two calculations, one evaluating the functional at $(n_{\\uparrow}=n, n_{\\downarrow}=0)$ and the other at $(n_{\\uparrow}=n/2, n_{\\downarrow}=n/2)$, are evaluating two mathematically distinct expressions. Improving numerical precision will only make the results converge more accurately to two different values.\n\nE. In GGA the Kohn–Sham kinetic energy becomes exact for one-electron densities only when the calculation is spin-polarized; the non-spin-polarized kinetic energy is intrinsically approximate and is the sole source of the energy difference.\n**Verdict:** **Incorrect**. The non-interacting kinetic energy $T_s$ is calculated from the Kohn-Sham orbitals, not directly from an approximate density functional for the kinetic energy. The primary error is in the potential energy terms $J[n] + E_{xc}[n]$. This error in the potential leads to an incorrect self-consistent density, which in turn causes a secondary error in the kinetic energy. The kinetic energy is not the sole, or even primary, source of the energy difference.", "answer": "$$\\boxed{A}$$", "id": "2464520"}, {"introduction": "The success of many popular GGAs, like the Perdew-Burke-Ernzerhof (PBE) functional, is not due to their separate accuracy for exchange and correlation but rather to a systematic cancellation of errors between these two components. This advanced numerical practice invites you to look \"under the hood\" of PBE's design by implementing it alongside a simpler gradient expansion reference. By computing and comparing the exchange and correlation energies for a model system, you will quantify this crucial error cancellation and gain insight into the design philosophy that makes PBE a robust and widely used functional [@problem_id:2464514].", "problem": "Consider the Generalized Gradient Approximation (GGA) as used in Kohn–Sham Density Functional Theory (DFT) and, in particular, the Perdew–Burke–Ernzerhof (PBE) functional. The task is to investigate error cancellation between exchange and correlation by comparing PBE to a gradient-expansion-based reference for a family of spherically symmetric, single-parameter electron densities. Work in atomic units, where energies are in Hartree and lengths are in Bohr.\n\nYou will study a family of model, spin-unpolarized, spherically symmetric electron densities parameterized by the electron count $N$ (an integer) and a diffuseness parameter $a$ (a positive real number with units of inverse Bohr):\n$$\nn(r) \\;=\\; N \\,\\frac{a^3}{\\pi}\\, e^{-2 a r}, \\quad r \\ge 0.\n$$\nThese densities are normalized so that $\\int n(\\mathbf{r}) \\, d^3 r = N$ for all positive $a$. For each density, you will compute total exchange and correlation energies using both:\n- a PBE-type GGA that satisfies the standard PBE constraints in the spin-unpolarized case, and\n- a “gradient expansion to second order” (GE2) reference that uses the known small-gradient coefficients for exchange and correlation.\n\nBase your derivation and implementation on the following foundational definitions and constraints:\n- The Local Density Approximation (LDA) exchange energy density per volume is built from the uniform electron gas expression. Use the standard uniform-gas Fermi wave vector definition $k_F(n) = (3 \\pi^2 n)^{1/3}$, and the reduced gradients that appear in GGA design:\n  - The magnitude of the density gradient for this $n(r)$ is $|\\nabla n| = \\left|\\frac{dn}{dr}\\right|$,\n  - The reduced gradient for exchange is $s = \\frac{|\\nabla n|}{2 k_F n}$,\n  - The screening wave vector used in correlation is $k_s = \\sqrt{\\frac{4 k_F}{\\pi}}$, and the reduced gradient for correlation is $t = \\frac{|\\nabla n|}{2 k_s n}$.\n- The PBE exchange enhancement factor must satisfy the exact small-gradient limit for exchange and saturate at a finite value at large gradients. The small-gradient limit recovers the exact second-order gradient expansion with coefficient $\\mu_{\\mathrm{GE}} = \\frac{10}{81}$. The canonical PBE constants for exchange are $\\mu$ and $\\kappa$ (both dimensionless), with $\\mu$ larger than $\\mu_{\\mathrm{GE}}$ and $\\kappa$ setting the saturation value.\n- The PBE correlation must recover, in the small-gradient limit, the exact second-order gradient expansion for correlation with coefficient $\\beta_{\\mathrm{GE}}$ and must obey the exact high-density logarithmic constraint characterized by a constant $\\gamma$; it is commonly implemented by an analytic interpolation in terms of a logarithm that depends on $t$ and a density-dependent factor chosen to recover the LDA limit.\n- The LDA correlation energy per particle $\\varepsilon_c^{\\mathrm{LDA}}(n)$ should be taken from a well-known, piecewise analytic fit to uniform electron gas data for the unpolarized case.\n\nConstruct the following two functionals for a given $(N,a)$:\n1) A PBE-type GGA total exchange-correlation energy,\n$$\nE_{xc}^{\\mathrm{PBE}}[n] \\;=\\; \\int \\left(e_x^{\\mathrm{LDA}}(n)\\,F_x^{\\mathrm{PBE}}(s) + n\\,\\big(\\varepsilon_c^{\\mathrm{LDA}}(n) + H^{\\mathrm{PBE}}(n,t)\\big)\\right)\\, d^3 r,\n$$\nthat satisfies the PBE constraints described above for exchange and correlation in the spin-unpolarized case.\n2) A GE2-based reference total exchange-correlation energy,\n$$\nE_{xc}^{\\mathrm{GE2}}[n] \\;=\\; \\int \\left(e_x^{\\mathrm{LDA}}(n)\\,\\big(1 + \\mu_{\\mathrm{GE}} s^2\\big) + n\\,\\varepsilon_c^{\\mathrm{LDA}}(n) + n\\,\\beta_{\\mathrm{GE}} t^2\\right)\\, d^3 r,\n$$\nwhich uses the exact second-order gradient coefficients $\\mu_{\\mathrm{GE}}$ for exchange and $\\beta_{\\mathrm{GE}}$ for correlation.\n\nDefine the exchange error and correlation error of PBE relative to the GE2 reference as\n$$\n\\Delta E_x \\;=\\; E_x^{\\mathrm{PBE}} - E_x^{\\mathrm{GE2}}, \\qquad\n\\Delta E_c \\;=\\; E_c^{\\mathrm{PBE}} - E_c^{\\mathrm{GE2}}.\n$$\nTo quantify cancellation, report for each case the dimensionless cancellation ratio\n$$\nR \\;=\\; \\frac{\\big|\\Delta E_x + \\Delta E_c\\big|}{\\big|\\Delta E_x\\big| + \\big|\\Delta E_c\\big|}.\n$$\nValues $R \\ll 1$ indicate strong cancellation between the exchange and correlation errors. All energies are in Hartree (atomic units), and $R$ is dimensionless.\n\nNumerically evaluate the radial integrals in three dimensions using spherical symmetry, that is,\n$$\n\\int f(\\mathbf{r}) \\, d^3 r \\;=\\; 4\\pi \\int_0^\\infty f(r)\\, r^2 \\, dr.\n$$\nChoose a radial grid that is sufficiently long and dense to converge the energies for each $(N,a)$ to at least three decimal places. You must not use any user input; all parameters are specified below.\n\nUse the canonical PBE constants for the spin-unpolarized case and widely used uniform-electron-gas parameters for the LDA correlation fit. Implement your program to compute $R$ for each of the following test cases (the “test suite”):\n- Case 1 (happy path, moderately diffuse): $(N,a) = (2, 0.50)$,\n- Case 2 (more diffuse, expected strong-gradient regime): $(N,a) = (2, 0.25)$,\n- Case 3 (compact density, expected weak-gradient regime): $(N,a) = (2, 2.00)$,\n- Case 4 (higher density amplitude, moderate gradients): $(N,a) = (10, 1.00)$.\n\nYour program should produce a single line of output containing the cancellation ratios for the four cases, each rounded to three decimals, as a comma-separated list enclosed in square brackets (for example, $\\texttt{[0.137,0.021,0.402,0.189]}$). No other text should be printed. The output is dimensionless and therefore unit-free. The goal is to identify which of the provided systems yields $R$ closest to $0$, indicating that the exchange and correlation errors of PBE are both individually large but cancel almost perfectly, relative to the GE2 reference.", "solution": "We begin from the Kohn–Sham Density Functional Theory (DFT) energy partition, focusing on the exchange-correlation contribution. In the Generalized Gradient Approximation (GGA), exchange and correlation energy densities depend on the local density $n(\\mathbf{r})$ and its gradient through reduced gradients. We work in atomic units throughout.\n\nFor a spin-unpolarized system, the uniform electron gas Fermi wave vector is $k_F(n) = (3 \\pi^2 n)^{1/3}$. The spherical model densities considered are\n$$\nn(r) \\;=\\; N \\,\\frac{a^3}{\\pi}\\, e^{-2 a r}, \\quad r \\ge 0,\n$$\nwith integer $N$ and positive real $a$. For these densities, the spherical symmetry implies $|\\nabla n| = \\left|\\frac{dn}{dr}\\right| = 2 a n(r)$. The reduced gradient entering exchange is\n$$\ns(r) \\;=\\; \\frac{|\\nabla n|}{2 k_F n} \\;=\\; \\frac{a}{k_F(r)} \\;=\\; \\frac{a}{(3 \\pi^2 n(r))^{1/3}},\n$$\nand the screening wave vector for correlation is $k_s(r) = \\sqrt{\\tfrac{4 k_F(r)}{\\pi}}$, yielding the correlation reduced gradient\n$$\nt(r) \\;=\\; \\frac{|\\nabla n|}{2 k_s n} \\;=\\; \\frac{a}{k_s(r)} \\;=\\; \\frac{a}{\\sqrt{4 (3 \\pi^2 n(r))^{1/3} / \\pi}}.\n$$\n\nThe Local Density Approximation (LDA) exchange energy density per volume has the standard uniform electron gas form\n$$\ne_x^{\\mathrm{LDA}}(n) \\;=\\; - C_x\\, n^{4/3}, \\quad C_x \\;=\\; \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}.\n$$\n\nFor PBE-type exchange, we require an enhancement factor $F_x^{\\mathrm{PBE}}(s)$ that (i) reproduces the exact second-order gradient expansion as $s \\to 0$ with coefficient $\\mu_{\\mathrm{GE}} = \\tfrac{10}{81}$ and (ii) saturates to a finite upper bound to respect the Lieb–Oxford bound indirectly. The canonical analytic form satisfying these constraints is\n$$\nF_x^{\\mathrm{PBE}}(s) \\;=\\; 1 + \\kappa - \\frac{\\kappa}{1 + \\frac{\\mu}{\\kappa} s^2},\n$$\nwith $\\mu$ and $\\kappa$ taken from the original Perdew–Burke–Ernzerhof construction. The canonical PBE constants are\n$$\n\\mu \\;=\\; 0.21951, \\qquad \\kappa \\;=\\; 0.804,\n$$\nwhile the exact small-gradient reference coefficient remains $\\mu_{\\mathrm{GE}} = \\tfrac{10}{81}$.\n\nFor correlation, write the total correlation energy as\n$$\nE_c[n] \\;=\\; \\int n(r)\\,\\varepsilon_c(n(r)) \\, d^3 r,\n$$\nwhere $\\varepsilon_c(n)$ is the correlation energy per particle. The LDA correlation $\\varepsilon_c^{\\mathrm{LDA}}(n)$ is supplied by a widely used piecewise analytic fit to the uniform electron gas for the spin-unpolarized case. A standard choice is the Perdew–Zunger 1981 (PZ81) parameterization fit to the Ceperley–Alder data. In terms of the Wigner–Seitz radius $r_s(n) = \\left(\\tfrac{3}{4\\pi n}\\right)^{1/3}$, its unpolarized branch is\n$$\n\\varepsilon_c^{\\mathrm{LDA}}(r_s) =\n\\begin{cases}\nA \\ln r_s + B + C r_s \\ln r_s + D r_s,  r_s \\ge 1 \\\\\n\\gamma_0 + \\beta_1 r_s \\ln r_s + \\beta_2 r_s,  r_s  1\n\\end{cases}\n$$\nwith constants\n$$\nA = 0.0310907, \\quad B = -0.048, \\quad C = 0.0020, \\quad D = -0.0116,\\\\\n\\gamma_0 = -0.1423, \\quad \\beta_1 = 1.0529, \\quad \\beta_2 = 0.3334.\n$$\n\nThe PBE correlation adds a gradient correction $H^{\\mathrm{PBE}}(n,t)$ to LDA, chosen to (i) reproduce the exact second-order gradient expansion for correlation with the exact coefficient $\\beta_{\\mathrm{GE}}$ in the small-gradient limit, (ii) enforce the exact high-density logarithmic behavior (coefficient $\\gamma$), and (iii) avoid unphysical divergence at large gradients. The canonical PBE analytic form that meets these constraints is\n$$\n\\varepsilon_c^{\\mathrm{PBE}}(n,t) \\;=\\; \\varepsilon_c^{\\mathrm{LDA}}(n) + H^{\\mathrm{PBE}}(n,t),\n$$\nwith\n$$\nH^{\\mathrm{PBE}}(n,t) \\;=\\; \\gamma \\,\\ln\\!\\left( 1 + \\frac{\\beta\\, t^2 / \\gamma}{1 + A(n)\\, t^2} \\right),\n$$\nwhere the density-dependent factor $A(n)$ is fixed by recovering the LDA limit in the uniform case and the exact second-order gradient expansion,\n$$\nA(n) \\;=\\; \\frac{\\beta/\\gamma}{\\exp\\!\\left(-\\varepsilon_c^{\\mathrm{LDA}}(n)/\\gamma\\right) - 1}.\n$$\nThe canonical constants are\n$$\n\\beta_{\\mathrm{GE}} = \\beta = 0.066725, \\qquad \\gamma = 0.0310907.\n$$\nIn the small-gradient limit $t \\to 0$, this construction ensures $H^{\\mathrm{PBE}}(n,t) \\sim \\beta\\, t^2$, thus reproducing the exact $\\beta_{\\mathrm{GE}}$ coefficient of the second-order gradient expansion for correlation.\n\nWith these ingredients, we can write the PBE-type GGA and the GE2 reference energies for a given $(N,a)$:\n- PBE-type GGA\n$$\nE_x^{\\mathrm{PBE}}[n] \\;=\\; \\int e_x^{\\mathrm{LDA}}(n)\\, F_x^{\\mathrm{PBE}}(s)\\, d^3 r, \\qquad\nE_c^{\\mathrm{PBE}}[n] \\;=\\; \\int n \\left(\\varepsilon_c^{\\mathrm{LDA}}(n) + H^{\\mathrm{PBE}}(n,t)\\right) d^3 r.\n$$\n- GE2 reference\n$$\nE_x^{\\mathrm{GE2}}[n] \\;=\\; \\int e_x^{\\mathrm{LDA}}(n)\\, \\big(1 + \\mu_{\\mathrm{GE}} s^2\\big)\\, d^3 r, \\qquad\nE_c^{\\mathrm{GE2}}[n] \\;=\\; \\int \\left(n\\, \\varepsilon_c^{\\mathrm{LDA}}(n) + n\\, \\beta_{\\mathrm{GE}}\\, t^2\\right) d^3 r.\n$$\n\nThe numerical evaluation uses spherical symmetry to reduce the three-dimensional integral to one dimension,\n$$\n\\int f(\\mathbf{r})\\, d^3 r \\;=\\; 4 \\pi \\int_0^\\infty f(r)\\, r^2\\, dr,\n$$\nwhich we approximate using a sufficiently dense radial grid $r \\in [0, r_{\\max}]$ with $r_{\\max}$ chosen large enough (for exponential densities a practical rule is $r_{\\max} \\approx \\tfrac{40}{a}$ to ensure $n(r_{\\max})$ is negligibly small). A composite Simpson rule with uniform spacing is employed to converge each energy to at least three decimal places.\n\nFor each test case, compute the exchange and correlation errors relative to GE2,\n$$\n\\Delta E_x \\;=\\; E_x^{\\mathrm{PBE}} - E_x^{\\mathrm{GE2}}, \\qquad\n\\Delta E_c \\;=\\; E_c^{\\mathrm{PBE}} - E_c^{\\mathrm{GE2}},\n$$\nand report the cancellation ratio\n$$\nR \\;=\\; \\frac{\\left|\\Delta E_x + \\Delta E_c\\right|}{\\left|\\Delta E_x\\right| + \\left|\\Delta E_c\\right|}.\n$$\nBy design, in regions where the reduced gradients are small, the two methods agree by construction through second order; in regions of large reduced gradients, the PBE exchange enhancement saturates (to satisfy exact constraints) while the GE2 exchange continues to grow quadratically in $s$, making $E_x^{\\mathrm{PBE}}$ less negative than $E_x^{\\mathrm{GE2}}$ and thus $\\Delta E_x$ typically positive. Conversely, the PBE correlation employs a logarithmic interpolation resulting in a slower growth relative to the quadratic GE2 correlation correction, making $E_c^{\\mathrm{PBE}}$ more negative than $E_c^{\\mathrm{GE2}}$ and thus $\\Delta E_c$ typically negative. For sufficiently diffuse densities (large $r_s$, large $s$ and $t$ in extended spatial regions), these two large but opposite-signed errors can nearly cancel, yielding $R \\ll 1$.\n\nWe apply this to the specified test suite:\n- Case $1$: $(N,a) = (2, 0.50)$,\n- Case $2$: $(N,a) = (2, 0.25)$,\n- Case $3$: $(N,a) = (2, 2.00)$,\n- Case $4$: $(N,a) = (10, 1.00)$.\n\nAlgorithm outline for each case:\n1) Build a radial grid $r \\in [0, r_{\\max}]$ with $r_{\\max} = \\tfrac{40}{a}$ and a large number of points to converge the integral.\n2) Compute $n(r)$, $|\\nabla n(r)|$, $k_F(r)$, $k_s(r)$, $s(r)$, and $t(r)$.\n3) Evaluate $e_x^{\\mathrm{LDA}}(n)$, $F_x^{\\mathrm{PBE}}(s)$, and assemble $e_x^{\\mathrm{PBE}}$ and $e_x^{\\mathrm{GE2}}$.\n4) Compute $\\varepsilon_c^{\\mathrm{LDA}}(n)$ from the PZ81 fit, build $H^{\\mathrm{PBE}}(n,t)$ using the canonical PBE formula, and assemble the correlation energy densities for PBE and GE2.\n5) Radially integrate with the $4\\pi r^2$ Jacobian to obtain $E_x^{\\mathrm{PBE}}$, $E_x^{\\mathrm{GE2}}$, $E_c^{\\mathrm{PBE}}$, and $E_c^{\\mathrm{GE2}}$.\n6) Compute $\\Delta E_x$, $\\Delta E_c$, and $R$, and round $R$ to three decimals.\n\nFinally, produce a single line containing the four $R$ values, as a comma-separated list enclosed in square brackets, in the order of the cases listed above. The output is unit-free since $R$ is dimensionless.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants for atomic units and functionals\nPI = np.pi\n\n# LDA exchange constant C_x\nC_x = 0.75 * (3.0 / PI) ** (1.0 / 3.0)  # (3/4)*(3/pi)^(1/3)\n\n# PBE exchange constants\nMU_PBE = 0.21951\nKAPPA_PBE = 0.804\n\n# Exact second-order gradient expansion coefficient for exchange\nMU_GE = 10.0 / 81.0\n\n# PBE correlation constants (and GE2 correlation coefficient)\nBETA_GE = 0.066725  # equals beta in PBE\nGAMMA = 0.0310907   # high-density limit constant\n\n# PZ81 (Perdew-Zunger 1981) LDA correlation constants (unpolarized)\nA_c = 0.0310907\nB_c = -0.048\nC_c = 0.0020\nD_c = -0.0116\ngamma0 = -0.1423\nbeta1 = 1.0529\nbeta2 = 0.3334\n\ndef lda_corr_eps_pz81(rs: np.ndarray) - np.ndarray:\n    \"\"\"\n    Perdew-Zunger 1981 LDA correlation per particle (unpolarized), piecewise in rs.\n    rs is the Wigner-Seitz radius array.\n    \"\"\"\n    rs = np.asarray(rs)\n    eps = np.empty_like(rs, dtype=float)\n    # Branch rs  1\n    mask_small = rs  1.0\n    rs_small = rs[mask_small]\n    # Avoid log(0) though rs_small  0 in practice\n    eps[mask_small] = gamma0 + beta1 * rs_small * np.log(rs_small) + beta2 * rs_small\n\n    # Branch rs = 1\n    mask_large = ~mask_small\n    rs_large = rs[mask_large]\n    eps[mask_large] = A_c * np.log(rs_large) + B_c + C_c * rs_large * np.log(rs_large) + D_c * rs_large\n    return eps\n\ndef pbe_corr_H(n: np.ndarray, t: np.ndarray) - np.ndarray:\n    \"\"\"\n    PBE correlation gradient correction H(n, t) per particle, spin unpolarized.\n    Uses canonical PBE formula with density-dependent A(n).\n    \"\"\"\n    # Compute LDA correlation per particle\n    rs = (3.0 / (4.0 * PI * np.maximum(n, 1e-300))) ** (1.0 / 3.0)\n    eps_c_lda = lda_corr_eps_pz81(rs)  # per particle\n\n    # A(n) factor with numerically stable handling near exp(x)-1 ~ 0\n    x = -eps_c_lda / GAMMA\n    # Use expm1 for numerical stability: exp(x) - 1\n    denom = np.expm1(x)\n    # Where denom is extremely small, fall back to series 1/(x + x^2/2)\n    small = np.abs(denom)  1e-12\n    A = np.empty_like(denom)\n    A[~small] = (BETA_GE / GAMMA) / denom[~small]\n    # Series expansion for small x: exp(x)-1 ~ x + x^2/2\n    xs = x[small]\n    series = xs + 0.5 * xs * xs\n    # avoid zero\n    series = np.where(np.abs(series)  1e-20, np.sign(series) * 1e-20, series)\n    A[small] = (BETA_GE / GAMMA) / series\n\n    # H per particle\n    num = (BETA_GE * t * t) / GAMMA\n    den = 1.0 + A * t * t\n    arg = 1.0 + num / den\n    # Ensure positivity of log argument\n    arg = np.maximum(arg, 1e-300)\n    H = GAMMA * np.log(arg)\n    return H\n\ndef pbe_exchange_enhancement(s: np.ndarray) - np.ndarray:\n    \"\"\"\n    PBE exchange enhancement factor F_x(s) = 1 + kappa - kappa / (1 + mu s^2 / kappa)\n    \"\"\"\n    return 1.0 + KAPPA_PBE - KAPPA_PBE / (1.0 + (MU_PBE / KAPPA_PBE) * s * s)\n\ndef radial_grid(a: float, num_points: int = 40000) - np.ndarray:\n    \"\"\"\n    Build a uniform radial grid [0, rmax] with rmax = 40/a.\n    \"\"\"\n    rmax = 40.0 / a\n    return np.linspace(0.0, rmax, num_points)\n\ndef simpson_integrate(y: np.ndarray, x: np.ndarray) - float:\n    \"\"\"\n    Composite Simpson's rule for uniform grid.\n    Requires odd number of points; if even, drop last point to make it odd.\n    \"\"\"\n    n = y.size\n    if n % 2 == 0:\n        # drop last point\n        y = y[:-1]\n        x = x[:-1]\n        n -= 1\n    h = (x[-1] - x[0]) / (n - 1)\n    S = y[0] + y[-1] + 4.0 * np.sum(y[1:-1:2]) + 2.0 * np.sum(y[2:-2:2])\n    return S * h / 3.0\n\ndef compute_R_for_case(N: int, a: float, grid_points: int = 40000) - float:\n    \"\"\"\n    Compute the cancellation ratio R for a given (N, a).\n    \"\"\"\n    # Radial grid\n    r = radial_grid(a, grid_points)\n    # Density and gradient\n    n = N * (a ** 3) / PI * np.exp(-2.0 * a * r)\n    dn_dr = -2.0 * a * n\n    abs_grad_n = np.abs(dn_dr)  # = 2 a n\n\n    # Fermi wave vector, screening wave vector\n    kF = (3.0 * PI ** 2 * np.maximum(n, 1e-300)) ** (1.0 / 3.0)\n    ks = np.sqrt(4.0 * kF / PI)\n\n    # Reduced gradients\n    s = abs_grad_n / (2.0 * kF * np.maximum(n, 1e-300))\n    t = abs_grad_n / (2.0 * ks * np.maximum(n, 1e-300))\n\n    # LDA exchange energy density per volume\n    e_x_lda = -C_x * n ** (4.0 / 3.0)\n\n    # PBE exchange energy density per volume\n    Fx_pbe = pbe_exchange_enhancement(s)\n    e_x_pbe = e_x_lda * Fx_pbe\n\n    # GE2 exchange energy density per volume\n    Fx_ge2 = 1.0 + MU_GE * s * s\n    e_x_ge2 = e_x_lda * Fx_ge2\n\n    # LDA correlation per particle and per volume\n    rs = (3.0 / (4.0 * PI * np.maximum(n, 1e-300))) ** (1.0 / 3.0)\n    eps_c_lda = lda_corr_eps_pz81(rs)\n    e_c_lda = n * eps_c_lda\n\n    # PBE correlation per volume: n * (eps_c_lda + H)\n    H_pbe = pbe_corr_H(n, t)\n    e_c_pbe = n * (eps_c_lda + H_pbe)\n\n    # GE2 correlation per volume: n*eps_c_lda + n*beta*t^2\n    e_c_ge2 = e_c_lda + n * (BETA_GE * t * t)\n\n    # Radial integration with spherical Jacobian\n    jac = 4.0 * PI * r * r\n    Ex_pbe = simpson_integrate(e_x_pbe * jac, r)\n    Ex_ge2 = simpson_integrate(e_x_ge2 * jac, r)\n    Ec_pbe = simpson_integrate(e_c_pbe * jac, r)\n    Ec_ge2 = simpson_integrate(e_c_ge2 * jac, r)\n\n    dEx = Ex_pbe - Ex_ge2\n    dEc = Ec_pbe - Ec_ge2\n    denom = abs(dEx) + abs(dEc)\n    if denom == 0.0:\n        R = 0.0\n    else:\n        R = abs(dEx + dEc) / denom\n    return R\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple (N, a)\n    test_cases = [\n        (2, 0.50),  # Case 1\n        (2, 0.25),  # Case 2\n        (2, 2.00),  # Case 3\n        (10, 1.00), # Case 4\n    ]\n\n    results = []\n    for (N, a) in test_cases:\n        R = compute_R_for_case(N, a, grid_points=40001)  # odd grid size for Simpson\n        # Round to three decimals\n        results.append(f\"{R:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2464514"}]}