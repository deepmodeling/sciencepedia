{"hands_on_practices": [{"introduction": "This practice delves into the uniform electron gas, a cornerstone model in solid-state physics and the theoretical bedrock of the Local Density Approximation (LDA) in DFT. By deriving the exact scaling of the kinetic and exchange energies with density, you will gain firsthand insight into how the functional forms used in the most fundamental DFT methods are constructed [@problem_id:2453886]. This foundational exercise connects abstract functional theory with a concrete, analytically tractable physical system.", "problem": "Consider a three-dimensional uniform electron gas (often called jellium): a very large number of spin-unpolarized electrons with constant number density $\\rho_{0}$ occupying a cubic box of volume $V$, with periodic boundary conditions, in the thermodynamic limit. Work in Hartree atomic units, so that $\\hbar=m_{e}=e=4\\pi\\varepsilon_{0}=1$. In Kohn–Sham Density Functional Theory (DFT), the noninteracting kinetic energy functional $T_{s}[\\rho]$ is defined as the ground-state kinetic energy of a noninteracting reference system that reproduces the density $\\rho(\\mathbf{r})$, and the exchange energy functional $E_{x}[\\rho]$ is defined as the Fock exchange energy of that reference system.\n\nFor the uniform density $\\rho(\\mathbf{r})=\\rho_{0}$, determine the exact dependence of $T_{s}[\\rho_{0}]$ and $E_{x}[\\rho_{0}]$ on $\\rho_{0}$ and $V$, assuming a spin degeneracy of $g_{s}=2$. Express your final answer as a two-entry row matrix containing, in order, $T_{s}[\\rho_{0}]$ and $E_{x}[\\rho_{0}]$, in Hartree atomic units. No rounding is required.", "solution": "The problem as stated is valid. It is a canonical problem from solid-state physics and density functional theory concerning the uniform electron gas, also known as jellium. The premises are scientifically sound, well-posed, and all necessary information is provided. We will proceed with the solution.\n\nThe problem asks for the noninteracting kinetic energy functional, $T_s[\\rho_0]$, and the exchange energy functional, $E_x[\\rho_0]$, for a uniform electron gas of constant density $\\rho_0$ in a volume $V$. We are working in Hartree atomic units where $\\hbar = m_e = e = 4\\pi\\varepsilon_0 = 1$. The spin degeneracy is given as $g_s=2$.\n\nFirst, we determine the noninteracting kinetic energy, $T_s[\\rho_0]$. By definition, this is the kinetic energy of a system of noninteracting electrons that has the ground-state density $\\rho_0$. For a uniform gas, the noninteracting reference system is simply a gas of noninteracting fermions. The ground state is constructed by filling the single-particle energy levels up to the Fermi energy.\n\nThe single-particle wavefunctions for electrons in a cubic box of volume $V=L^3$ with periodic boundary conditions are plane waves:\n$$\n\\psi_{\\mathbf{k}}(\\mathbf{r}) = \\frac{1}{\\sqrt{V}} \\exp(i\\mathbf{k} \\cdot \\mathbf{r})\n$$\nThe corresponding kinetic energies are:\n$$\n\\epsilon_{\\mathbf{k}} = \\frac{\\hbar^2 |\\mathbf{k}|^2}{2m_e} = \\frac{|\\mathbf{k}|^2}{2}\n$$\nIn the ground state, all states with wavevector magnitude $|\\mathbf{k}|$ up to the Fermi wavevector, $k_F$, are occupied. The total number of electrons, $N$, is related to the density $\\rho_0$ by $N = \\rho_0 V$. In the thermodynamic limit, the sum over discrete $\\mathbf{k}$ states can be replaced by an integral over $\\mathbf{k}$-space:\n$$\n\\sum_{\\mathbf{k}} \\to V \\int \\frac{d^3\\mathbf{k}}{(2\\pi)^3}\n$$\nThe total number of electrons is found by integrating over the volume of the Fermi sphere in $\\mathbf{k}$-space, multiplied by the spin degeneracy $g_s=2$:\n$$\nN = g_s V \\int_{|\\mathbf{k}| \\le k_F} \\frac{d^3\\mathbf{k}}{(2\\pi)^3} = 2V \\left( \\frac{4\\pi k_F^3}{3(2\\pi)^3} \\right) = V \\frac{k_F^3}{3\\pi^2}\n$$\nFrom this, we establish the relationship between the density $\\rho_0 = N/V$ and the Fermi wavevector $k_F$:\n$$\n\\rho_0 = \\frac{k_F^3}{3\\pi^2} \\implies k_F = (3\\pi^2 \\rho_0)^{1/3}\n$$\nThe total noninteracting kinetic energy $T_s[\\rho_0]$ is the sum of the energies of all occupied states:\n$$\nT_s[\\rho_0] = g_s \\sum_{|\\mathbf{k}| \\le k_F} \\epsilon_{\\mathbf{k}} = g_s V \\int_{|\\mathbf{k}| \\le k_F} \\frac{|\\mathbf{k}|^2}{2} \\frac{d^3\\mathbf{k}}{(2\\pi)^3}\n$$\nSubstituting $g_s=2$ and switching to spherical coordinates in $\\mathbf{k}$-space ($d^3\\mathbf{k} = 4\\pi |\\mathbf{k}|^2 d|\\mathbf{k}|$), the integral becomes:\n$$\nT_s[\\rho_0] = 2 V \\frac{4\\pi}{(2\\pi)^3} \\int_0^{k_F} \\frac{k^2}{2} k^2 dk = \\frac{V}{\\pi^2} \\int_0^{k_F} \\frac{k^4}{2} dk = \\frac{V}{2\\pi^2} \\left[ \\frac{k^5}{5} \\right]_0^{k_F} = \\frac{V k_F^5}{10\\pi^2}\n$$\nFinally, we substitute the expression for $k_F$ in terms of $\\rho_0$:\n$$\nT_s[\\rho_0] = \\frac{V}{10\\pi^2} \\left[ (3\\pi^2 \\rho_0)^{1/3} \\right]^5 = \\frac{V}{10\\pi^2} (3\\pi^2)^{5/3} \\rho_0^{5/3} = \\frac{3^{5/3}\\pi^{10/3}}{10\\pi^2} V \\rho_0^{5/3} = \\frac{3}{10}(3\\pi^2)^{2/3} V \\rho_0^{5/3}\n$$\nThis is the well-known Thomas-Fermi kinetic energy functional evaluated for a uniform density.\n\nNext, we determine the exchange energy, $E_x[\\rho_0]$. For the uniform electron gas, the exchange energy given by the Local Density Approximation (LDA) is exact. The LDA exchange energy functional is given by:\n$$\nE_x^{\\text{LDA}}[\\rho] = \\int e_x^{\\text{unif}}(\\rho(\\mathbf{r})) d^3\\mathbf{r}\n$$\nwhere $e_x^{\\text{unif}}(\\rho)$ is the exchange energy per unit volume for a uniform, spin-unpolarized electron gas of density $\\rho$. The standard expression for this quantity is:\n$$\ne_x^{\\text{unif}}(\\rho) = - C_x \\rho^{4/3}\n$$\nwith the constant $C_x$ given by:\n$$\nC_x = \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3}\n$$\nFor the system in question, the density is constant, $\\rho(\\mathbf{r}) = \\rho_0$. Therefore, the exchange energy is:\n$$\nE_x[\\rho_0] = \\int -C_x \\rho_0^{4/3} d^3\\mathbf{r} = -C_x \\rho_0^{4/3} \\int d^3\\mathbf{r} = -C_x V \\rho_0^{4/3}\n$$\nSubstituting the expression for $C_x$:\n$$\nE_x[\\rho_0] = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} V \\rho_0^{4/3}\n$$\nThis is the exact exchange energy for the uniform electron gas.\n\nWe combine the two results into a single row matrix as requested.\nThe first entry is $T_s[\\rho_0] = \\frac{3}{10}(3\\pi^2)^{2/3} V \\rho_0^{5/3}$.\nThe second entry is $E_x[\\rho_0] = -\\frac{3}{4}(\\frac{3}{\\pi})^{1/3} V \\rho_0^{4/3}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{10}(3\\pi^{2})^{2/3} V \\rho_{0}^{5/3}  - \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} V \\rho_{0}^{4/3} \\end{pmatrix}}\n$$", "id": "2453886"}, {"introduction": "The core principle of DFT is finding the electron density that minimizes the total energy for a given system. This exercise provides a hands-on programming challenge to implement this variational principle in a simplified one-dimensional Thomas-Fermi model [@problem_id:2453860]. By translating the calculus of variations into a numerical algorithm, you will build a solver that directly demonstrates how DFT determines the ground-state density and energy.", "problem": "In the framework of Density Functional Theory (DFT), consider the one-dimensional simplified Thomas–Fermi model in atomic units. Let the electron density be a nonnegative function $\\rho(x) \\ge 0$ on the finite interval $x \\in [-L,L]$. The total energy functional is\n$$\nE[\\rho] \\;=\\; C_F \\int_{-L}^{L} \\rho(x)^{5/3}\\,dx \\;+\\; \\int_{-L}^{L} v_{\\text{ext}}(x)\\,\\rho(x)\\,dx,\n$$\nwhere $C_F = \\frac{3}{10}\\,(3\\pi^2)^{2/3}$ and $v_{\\text{ext}}(x)$ is a given external potential. The density must satisfy the particle-number constraint\n$$\n\\int_{-L}^{L} \\rho(x)\\,dx \\;=\\; N.\n$$\nAll quantities are in atomic units. You must compute the minimizing density $\\rho_{\\star}(x)$ that achieves the minimum of $E[\\rho]$ subject to the constraints, and report the corresponding minimal energy $E_{\\min}$ in Hartree and the associated particle-number Lagrange multiplier (chemical potential) $\\mu$ in Hartree.\n\nWrite a complete program that, for each test case below, returns the pair of floats $(E_{\\min}, \\mu)$, expressed in Hartree and rounded to six decimal places. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list for $(E_{\\min}, \\mu)$, in the same order as the test suite, for example: $[[e_1,\\mu_1],[e_2,\\mu_2],\\dots]$.\n\nThe test suite consists of the following cases, each defined by a domain half-length $L$, a particle number $N$, and a specified external potential $v_{\\text{ext}}(x)$:\n\n- Case $1$: $L = 5$, $N = 2$, $v_{\\text{ext}}(x) = 0$ for all $x \\in [-L,L]$.\n- Case $2$: $L = 10$, $N = 1$, $v_{\\text{ext}}(x) = \\tfrac{1}{2} k x^2$ with $k = 1$.\n- Case $3$: $L = 10$, $N = 1$, $v_{\\text{ext}}(x) = -V_0 \\exp\\!\\big(-x^2/(2\\sigma^2)\\big)$ with $V_0 = 2$ and $\\sigma = 1$.\n- Case $4$: $L = 10$, $N = 1.5$, $v_{\\text{ext}}(x) = \\alpha\\,|x|$ with $\\alpha = 0.2$.\n\nYour program should compute, for each case, the minimizing density $\\rho_{\\star}(x)$ consistent with the constraints, and output the list $[[E_{\\min}^{(1)},\\mu^{(1)}],[E_{\\min}^{(2)},\\mu^{(2)}],[E_{\\min}^{(3)},\\mu^{(3)}],[E_{\\min}^{(4)},\\mu^{(4)}]]$ as a single line. All energies and chemical potentials must be expressed in Hartree, rounded to six decimal places, and printed as decimal numbers without scientific notation and without any unit symbols.", "solution": "The problem posed is to find a non-negative function $\\rho_{\\star}(x)$ that minimizes the one-dimensional Thomas-Fermi energy functional\n$$\nE[\\rho] = C_F \\int_{-L}^{L} \\rho(x)^{5/3}\\,dx + \\int_{-L}^{L} v_{\\text{ext}}(x)\\,\\rho(x)\\,dx\n$$\nsubject to the particle number constraint\n$$\n\\int_{-L}^{L} \\rho(x)\\,dx = N.\n$$\nThis is a standard problem in the calculus of variations. To find the minimizing density, we introduce a Lagrange multiplier $\\mu$, which physically represents the chemical potential, to incorporate the constraint. We seek a stationary point of the auxiliary functional $\\Omega[\\rho]$:\n$$\n\\Omega[\\rho] = E[\\rho] - \\mu \\left( \\int_{-L}^{L} \\rho(x)\\,dx - N \\right).\n$$\nThe condition for an extremum is that the functional derivative of $\\Omega[\\rho]$ with respect to $\\rho(x)$ must vanish for all $x$:\n$$\n\\frac{\\delta\\Omega[\\rho]}{\\delta\\rho(x)} = 0.\n$$\nThis yields the Euler-Lagrange equation for this system. The functional derivatives are:\n$$\n\\frac{\\delta}{\\delta\\rho(x)} \\left( C_F \\int_{-L}^{L} \\rho(y)^{5/3}\\,dy \\right) = C_F \\frac{5}{3} \\rho(x)^{2/3},\n$$\n$$\n\\frac{\\delta}{\\delta\\rho(x)} \\left( \\int_{-L}^{L} v_{\\text{ext}}(y)\\rho(y)\\,dy \\right) = v_{\\text{ext}}(x),\n$$\n$$\n\\frac{\\delta}{\\delta\\rho(x)} \\left( \\mu \\int_{-L}^{L} \\rho(y)\\,dy \\right) = \\mu.\n$$\nSubstituting these expressions into the Euler-Lagrange equation gives:\n$$\nC_F \\frac{5}{3} \\rho(x)^{2/3} + v_{\\text{ext}}(x) - \\mu = 0.\n$$\nSolving this algebraic equation for $\\rho(x)$ yields:\n$$\n\\rho(x)^{2/3} = \\frac{\\mu - v_{\\text{ext}}(x)}{(5/3)C_F}.\n$$\nThe problem requires the density to be non-negative, $\\rho(x) \\ge 0$. This implies that the right-hand side of the equation above must also be non-negative. In regions where $\\mu - v_{\\text{ext}}(x)  0$, the only physically sound solution is $\\rho(x)=0$. Therefore, the minimizing density $\\rho_{\\star}(x)$ is given by:\n$$\n\\rho_{\\star}(x) = \\left( \\frac{\\max(0, \\mu - v_{\\text{ext}}(x))}{(5/3)C_F} \\right)^{3/2}.\n$$\nThe constant $(5/3)C_F$ is equal to $\\frac{1}{2}(3\\pi^2)^{2/3}$. Let us denote this constant by $K$. The chemical potential $\\mu$ is not yet known; it is determined by the particle number constraint:\n$$\n\\int_{-L}^{L} \\rho_{\\star}(x;\\mu)\\,dx = N.\n$$\nThis becomes a nonlinear algebraic equation for $\\mu$:\n$$\n\\int_{-L}^{L} \\left( \\frac{\\max(0, \\mu - v_{\\text{ext}}(x))}{K} \\right)^{3/2}\\,dx - N = 0.\n$$\nThis equation must be solved for $\\mu$. Since the integrand is a monotonically increasing function of $\\mu$ for a fixed $x$, the integral is also a monotonically increasing function of $\\mu$. This guarantees that a unique solution for $\\mu$ exists (provided a solution is possible), which can be found reliably using a numerical root-finding algorithm, such as the Brent-q method. A suitable search interval $[\\mu_{\\text{low}}, \\mu_{\\text{high}}]$ is required. A rigorous lower bound is $\\mu_{\\text{low}} = \\min_{x \\in [-L,L]} v_{\\text{ext}}(x)$, since for any $\\mu$ below this value the density would be identically zero.\n\nOnce $\\mu$ is determined, the minimum energy $E_{\\min} = E[\\rho_{\\star}]$ can be computed. We can derive a more convenient expression for $E_{\\min}$. We substitute the relation for $\\rho_{\\star}(x)$ back into the energy functional. In regions where $\\rho_{\\star}(x)0$, we have $C_F \\rho_{\\star}(x)^{2/3} = \\frac{3}{5}(\\mu - v_{\\text{ext}}(x))$, which means $C_F \\rho_{\\star}(x)^{5/3} = \\frac{3}{5}(\\mu-v_{\\text{ext}}(x))\\rho_{\\star}(x)$.\nSubstituting this into the energy expression gives:\n$$\nE_{\\min} = \\int_{-L}^{L} \\left( \\frac{3}{5}(\\mu-v_{\\text{ext}}(x))\\rho_{\\star}(x) + v_{\\text{ext}}(x)\\rho_{\\star}(x) \\right) \\,dx,\n$$\nwhich simplifies to\n$$\nE_{\\min} = \\int_{-L}^{L} \\left( \\frac{3}{5}\\mu\\,\\rho_{\\star}(x) + \\frac{2}{5}v_{\\text{ext}}(x)\\rho_{\\star}(x) \\right) \\,dx.\n$$\nUsing the particle number constraint $\\int_{-L}^{L} \\rho_{\\star}(x)dx = N$, we arrive at the final expression for the energy:\n$$\nE_{\\min} = \\frac{3}{5}\\mu N + \\frac{2}{5} \\int_{-L}^{L} v_{\\text{ext}}(x)\\rho_{\\star}(x;\\mu)\\,dx.\n$$\nThe computational algorithm for each test case is as follows:\n$1$. For the given parameters $L$, $N$, and potential $v_{\\text{ext}}(x)$, define a function $f(\\mu) = \\int_{-L}^{L} \\rho_{\\star}(x;\\mu)\\,dx - N$.\n$2$. Numerically solve the nonlinear equation $f(\\mu)=0$ for $\\mu$ using a root-finder over a determined bracket $[\\mu_{\\text{low}}, \\mu_{\\text{high}}]$. The integral within $f(\\mu)$ is evaluated using numerical quadrature.\n$3$. With the determined value of $\\mu$, compute the integral $I_v = \\int_{-L}^{L} v_{\\text{ext}}(x)\\rho_{\\star}(x;\\mu)\\,dx$, again using numerical quadrature.\n$4$. Calculate the minimal energy $E_{\\min}$ using the derived formula $E_{\\min} = \\frac{3}{5}\\mu N + \\frac{2}{5}I_v$.\n$5$. Report the pair $(E_{\\min}, \\mu)$, with both values rounded to six decimal places.\n\nThis procedure is implemented in the following program for each of the four specified test cases.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the 1D Thomas-Fermi problem for a given set of test cases.\n    \"\"\"\n\n    # Define physical constants in atomic units\n    C_F = (3.0/10.0) * (3.0 * np.pi**2)**(2.0/3.0)\n    K_CONST = (5.0/3.0) * C_F\n\n    def solve_case(L, N, v_ext_func):\n        \"\"\"\n        Solves for the chemical potential (mu) and minimum energy (E_min) for a single case.\n        \n        Args:\n            L (float): Half-length of the domain [-L, L].\n            N (float): Total number of particles.\n            v_ext_func (callable): The external potential v_ext(x).\n\n        Returns:\n            tuple: A tuple containing (E_min, mu) rounded to 6 decimal places.\n        \"\"\"\n\n        # Integrand for calculating the particle number N given a mu\n        def rho_integrand(x, mu):\n            val = mu - v_ext_func(x)\n            if val = 0:\n                return 0.0\n            return (val / K_CONST)**1.5\n\n        # Equation to solve for mu: integral(rho(x, mu)) dx - N = 0\n        def particle_number_eq(mu):\n            integral_val, _ = quad(rho_integrand, -L, L, args=(mu,), limit=100)\n            return integral_val - N\n\n        # Find a suitable bracket [mu_low, mu_high] for the root-finder\n        # mu_low is the minimum of the potential in the domain\n        x_grid = np.linspace(-L, L, 2001)\n        v_min = np.min(v_ext_func(x_grid))\n        mu_low = v_min\n        \n        # Iteratively find mu_high such that particle_number_eq(mu_high) > 0\n        # Start with a reasonable guess and expand if necessary\n        mu_high = mu_low + 1.0\n        \n        # Handle cases where v_min itself is large or negative\n        if mu_high = mu_low :\n             mu_high = mu_low + abs(mu_low) + 1.0\n\n        iter_count = 0\n        max_iters = 30\n        while particle_number_eq(mu_high)  0 and iter_count  max_iters:\n            mu_high += abs(mu_high) + 1.0  # Adaptive step\n            iter_count += 1\n        \n        if iter_count == max_iters:\n            raise RuntimeError(\"Failed to find a valid bracket for mu.\")\n\n        # Solve for mu using Brent's method\n        mu_sol = brentq(particle_number_eq, mu_low, mu_high)\n\n        # Now, calculate the energy E_min\n        # E_min = (3/5)*mu*N + (2/5) * integral(v_ext(x) * rho(x)) dx\n        def energy_pot_integrand(x, mu):\n            rho = rho_integrand(x, mu)\n            return v_ext_func(x) * rho\n\n        V_ext_integral, _ = quad(energy_pot_integrand, -L, L, args=(mu_sol,), limit=100)\n        \n        E_min = (3.0/5.0) * mu_sol * N + (2.0/5.0) * V_ext_integral\n\n        return round(E_min, 6), round(mu_sol, 6)\n\n    # Test suite from the problem statement\n    test_cases = [\n        {'L': 5.0, 'N': 2.0, 'v_ext': lambda x: 0.0 * x}, # v_ext = 0\n        {'L': 10.0, 'N': 1.0, 'v_ext': lambda x: 0.5 * x**2},\n        {'L': 10.0, 'N': 1.0, 'v_ext': lambda x: -2.0 * np.exp(-x**2 / 2.0)},\n        {'L': 10.0, 'N': 1.5, 'v_ext': lambda x: 0.2 * np.abs(x)},\n    ]\n\n    results = []\n    for case in test_cases:\n        E_min, mu = solve_case(case['L'], case['N'], case['v_ext'])\n        results.append([E_min, mu])\n\n    # Format the output as specified\n    output_str = \"[\" + \",\".join([f\"[{e},{m}]\" for e, m in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2453860"}, {"introduction": "In practical applications, the DFT result is only as good as the approximate exchange-correlation functional used. This exercise challenges you to act as a computational detective, using a set of provided calculation data for a notoriously difficult system to diagnose the sources of error. Learning to distinguish between *functional-driven* error (an intrinsic flaw in the functional's formula) and *density-driven* error (a flaw in the self-consistent density it produces) is a critical skill for any serious user of DFT [@problem_id:2453913].", "problem": "You will analyze sources of error in Density Functional Theory (DFT) calculations by distinguishing density-driven error from functional-driven error. Use the following fundamental bases: (i) the Hohenberg–Kohn theorems state that the ground-state energy is a functional of the ground-state electron density, and the exact energy is obtained by minimizing this energy functional with respect to the density; (ii) in the Kohn–Sham (KS) framework, an approximate exchange–correlation functional yields an approximate energy functional whose self-consistent minimizer is an approximate density; (iii) a finite one-electron basis set induces a discretization of the allowed densities and orbitals, leading to basis-set incompleteness error. Consider the Born–Oppenheimer ground state of H$_2$ at a stretched bond length of $R=3.0\\,\\mathrm{\\AA}$.\n\nYou have the following set of calculations. All energies are in Hartree units, $E_{\\mathrm{h}}$, and all calculations are spin-unrestricted when applicable. The notations $E_{\\mathrm{meth}}[\\rho_{\\bullet}]$ indicate the total energy from method “meth” evaluated on the density $\\rho_{\\bullet}$.\n\n- A near-exact reference in a very large basis (e.g., Full Configuration Interaction in a complete-basis limit): $E_{\\mathrm{ref}}=-1.000\\,E_{\\mathrm{h}}$.\n- Semi-local Generalized Gradient Approximation (GGA), specifically Perdew–Burke–Ernzerhof (PBE), self-consistent in a very large basis: $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{PBE}}]=-1.030\\,E_{\\mathrm{h}}$.\n- PBE evaluated non-self-consistently on an Unrestricted Hartree–Fock (UHF) density obtained in the same very large basis: $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}]=-1.008\\,E_{\\mathrm{h}}$.\n- A global hybrid functional (e.g., PBE0) self-consistent in a minimal basis set: $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}}=-0.990\\,E_{\\mathrm{h}}$.\n- The same hybrid functional evaluated on the UHF density, but both the UHF calculation and the hybrid energy evaluation are confined to the same minimal basis: $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{UHF}}]_{\\mathrm{min}}=-0.991\\,E_{\\mathrm{h}}$.\n\nConceptual reminders for interpretation:\n- Functional-driven error refers to the error that would remain even if the approximate functional were evaluated on the exact density (i.e., it originates in the functional form itself).\n- Density-driven error refers to the additional error arising because the approximate self-consistent density deviates from the exact density due to the approximate potential; it can be diagnosed in practice by how much the approximate energy changes when evaluated on a higher-fidelity density.\n- Basis-set incompleteness can limit the quality of both the density and the energy, potentially masking or mimicking other error sources.\n\nQuestion: Based on the data and principles above, which statements are correct?\n\nA. The large change from $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{PBE}}]$ to $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}]$ in the large basis indicates that, for stretched H$_2$ with a semi-local functional, density-driven error is a major component of the total error.\n\nB. The near equality of $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}}$ and $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{UHF}}]_{\\mathrm{min}}$ indicates that, in the minimal basis, basis-set incompleteness dominates over density-driven error for the hybrid functional.\n\nC. The residual gap between $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}]$ and $E_{\\mathrm{ref}}$ in the large basis is attributable to functional-driven error (e.g., missing static correlation in the semi-local form).\n\nD. Because the approximate energy functional is minimized at its own self-consistent density, the Hohenberg–Kohn variational principle ensures that replacing $\\rho_{\\mathrm{approx}}$ by a better density such as $\\rho_{\\mathrm{UHF}}$ cannot reduce the total error relative to $E_{\\mathrm{ref}}$.\n\nE. In a minimal basis, density errors must dominate the energy error because the basis limits the variational space for $\\rho(\\mathbf{r})$, so replacing $\\rho_{\\mathrm{hyb}}$ by $\\rho_{\\mathrm{UHF}}$ necessarily produces a large energy improvement.", "solution": "The problem statement will first be validated for scientific and logical soundness.\n\n**Step 1: Extract Givens**\n\nThe problem provides the following data and conceptual definitions for the ground state of H$_2$ at a bond length of $R=3.0\\,\\mathrm{\\AA}$:\n\n- **Principles:**\n    1.  Hohenberg-Kohn (HK) theorems: The ground-state energy $E$ is a functional of the ground-state electron density $\\rho(\\mathbf{r})$, $E=E[\\rho]$, and is minimized by the exact ground-state density.\n    2.  Kohn-Sham (KS) DFT: An approximate exchange-correlation functional $E_{xc}^{\\mathrm{approx}}[\\rho]$ leads to an approximate total energy functional $E^{\\mathrm{approx}}[\\rho]$ whose self-consistent minimizer is an approximate density $\\rho_{\\mathrm{approx}}$.\n    3.  Basis-set incompleteness error: A finite one-electron basis set discretizes the space of allowed densities and orbitals.\n\n- **Energy Values (in Hartree, $E_{\\mathrm{h}}$):**\n    -   Near-exact reference energy in a very large basis: $E_{\\mathrm{ref}} = -1.000\\,E_{\\mathrm{h}}$.\n    -   PBE self-consistent energy in a very large basis: $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{PBE}}] = -1.030\\,E_{\\mathrm{h}}$.\n    -   PBE energy on a UHF density in the same very large basis: $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}] = -1.008\\,E_{\\mathrm{h}}$.\n    -   Global hybrid self-consistent energy in a minimal basis: $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}} = -0.990\\,E_{\\mathrm{h}}$.\n    -   Global hybrid energy on a UHF density in the same minimal basis: $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{UHF}}]_{\\mathrm{min}} = -0.991\\,E_{\\mathrm{h}}$.\n\n- **Error Definitions:**\n    -   **Functional-driven error:** Error remaining when an approximate functional is evaluated on the exact density.\n    -   **Density-driven error:** Additional error from the deviation of the approximate self-consistent density from the exact density.\n    -   **Basis-set incompleteness error:** Error from using a finite basis set.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria.\n\n-   **Scientifically Grounded:** The problem is firmly rooted in the principles of density functional theory and quantum chemistry. The scenario of stretched H$_2$ is a canonical example used to illustrate the failure of semi-local functionals due to static correlation, a well-established concept. The definitions of functional-driven and density-driven errors are standard in modern DFT literature.\n-   **Well-Posed:** The problem provides a clear set of numerical data and definitions, and asks for an evaluation of several statements based on this information. The question is structured to have a definite set of correct and incorrect answers derivable from the provided data.\n-   **Objective:** The language is technical, precise, and free of subjectivity.\n-   **Self-Contained and Consistent:** All necessary data and definitions are provided. There are no internal contradictions. For example, the non-self-consistent energies ($E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}]$ and $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{UHF}}]_{\\mathrm{min}}$) are variationally higher (less negative) than their self-consistent counterparts ($E_{\\mathrm{PBE}}[\\rho_{\\mathrm{PBE}}]$ and $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}}$), which is consistent with the variational principle applied to an approximate functional. This is not strictly required in all cases, but its presence adds to the consistency. Note I check $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{UHF}}]_{\\mathrm{min}} = -0.991 E_{\\mathrm{h}}$ which is lower than $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}} = -0.990 E_{\\mathrm{h}}$. This indicates an issue. Let's re-read. $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}}=-0.990$, and $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{UHF}}]_{\\mathrm{min}}=-0.991$. This means $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{UHF}}]_{\\mathrm{min}}  E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}}$. This is a violation of the variational principle for the approximate functional $E_{\\mathrm{hyb}}$. This is a potential contradiction. However, in practice, numerical noise or convergence to a non-minimal saddle point can lead to such small apparent violations. But more likely, it is a typo in the problem statement, or the UHF density used was not obtained from the same basis as the hybrid calculation. Let me check the wording: \"both the UHF calculation and the hybrid energy evaluation are confined to the same minimal basis\". This confirms they are from the same basis. This very small violation ($0.001\\,E_{\\mathrm{h}}$) is on the edge of what might be considered a numerical artifact. However, a strict interpretation flags this as an inconsistency. Is it fatal to the logic of the problem? The core argument in the options related to this point relies on the *small magnitude* of the difference, not its sign. The difference is $|-0.990 - (-0.991)| = 0.001\\,E_{\\mathrm{h}}$, which is small regardless of sign. The logic of the options can still be assessed. Given that this is a conceptual problem and the magnitude is small, I will proceed, but note this slight inconsistency. It does not invalidate the entire problem structure.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid** for analysis. The minor inconsistency in the provided data concerning the variational principle for the hybrid functional is noted, but it is not significant enough to prevent a logical evaluation of the options, which primarily depend on the magnitudes of the energy differences.\n\n**Solution Derivation**\n\nThe total error of an approximate DFT calculation, $\\Delta E_{\\mathrm{tot}}$, can be decomposed into a functional-driven error, $\\Delta E_F$, and a density-driven error, $\\Delta E_D$.\n$\\Delta E_{\\mathrm{tot}} = E_{\\mathrm{approx}}[\\rho_{\\mathrm{approx}}] - E_{\\mathrm{exact}}[\\rho_{\\mathrm{exact}}]$.\nThe decomposition is:\n$$ \\Delta E_{\\mathrm{tot}} = \\underbrace{\\left( E_{\\mathrm{approx}}[\\rho_{\\mathrm{approx}}] - E_{\\mathrm{approx}}[\\rho_{\\mathrm{exact}}] \\right)}_{\\Delta E_D} + \\underbrace{\\left( E_{\\mathrm{approx}}[\\rho_{\\mathrm{exact}}] - E_{\\mathrm{exact}}[\\rho_{\\mathrm{exact}}] \\right)}_{\\Delta E_F} $$\nIn practice, $\\rho_{\\mathrm{exact}}$ is unknown. We use a high-quality reference density, here approximated by $\\rho_{\\mathrm{UHF}}$ from a large basis, to estimate these components. Thus:\n$$ \\Delta E_D \\approx E_{\\mathrm{approx}}[\\rho_{\\mathrm{approx}}] - E_{\\mathrm{approx}}[\\rho_{\\mathrm{UHF}}] $$\n$$ \\Delta E_F \\approx E_{\\mathrm{approx}}[\\rho_{\\mathrm{UHF}}] - E_{\\mathrm{ref}} $$\n\n**Analysis of PBE in a large basis:**\n- Total error: $\\Delta E_{\\mathrm{tot, PBE}} = E_{\\mathrm{PBE}}[\\rho_{\\mathrm{PBE}}] - E_{\\mathrm{ref}} = -1.030 - (-1.000) = -0.030\\,E_{\\mathrm{h}}$.\n- Approximate density-driven error: $\\Delta E_{D, \\mathrm{PBE}} \\approx E_{\\mathrm{PBE}}[\\rho_{\\mathrm{PBE}}] - E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}] = -1.030 - (-1.008) = -0.022\\,E_{\\mathrm{h}}$.\n- Approximate functional-driven error: $\\Delta E_{F, \\mathrm{PBE}} \\approx E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}] - E_{\\mathrm{ref}} = -1.008 - (-1.000) = -0.008\\,E_{\\mathrm{h}}$.\n\nThe sum of these approximate components is $(-0.022) + (-0.008) = -0.030\\,E_{\\mathrm{h}}$, which matches the total error. The magnitude of the density-driven error, $|-0.022| = 0.022\\,E_{\\mathrm{h}}$, is substantial compared to the magnitude of the total error, $|-0.030| = 0.030\\,E_{\\mathrm{h}}$.\n\n**Analysis of the hybrid functional in a minimal basis:**\n- Approximate density-driven error within the minimal basis: $\\Delta E_{D, \\mathrm{hyb}} \\approx E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}} - E_{\\mathrm{hyb}}[\\rho_{\\mathrm{UHF}}]_{\\mathrm{min}} = -0.990 - (-0.991) = +0.001\\,E_{\\mathrm{h}}$.\nThe magnitude of this error component is extremely small, $0.001\\,E_{\\mathrm{h}}$.\n\n**Option-by-Option Analysis**\n\n**A. The large change from $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{PBE}}]$ to $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}]$ in the large basis indicates that, for stretched H$_2$ with a semi-local functional, density-driven error is a major component of the total error.**\nThe energy change upon replacing the self-consistent PBE density with the UHF density is $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}] - E_{\\mathrm{PBE}}[\\rho_{\\mathrm{PBE}}] = -1.008 - (-1.030) = +0.022\\,E_{\\mathrm{h}}$. This change estimates the negative of the density-driven error. Its magnitude, $0.022\\,E_{\\mathrm{h}}$, accounts for approximately $73\\%$ of the total error's magnitude ($0.030\\,E_{\\mathrm{h}}$). This is unequivocally a \"major component\". This physical situation is characteristic of static correlation error, where the semi-local functional yields a qualitatively incorrect, over-delocalized density, leading to a large density-driven error.\n**Verdict: Correct.**\n\n**B. The near equality of $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}}$ and $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{UHF}}]_{\\mathrm{min}}$ indicates that, in the minimal basis, basis-set incompleteness dominates over density-driven error for the hybrid functional.**\nThe energy difference is $|-0.990 - (-0.991)| = 0.001\\,E_{\\mathrm{h}}$. This near-zero change implies that the energetic consequence of switching from the self-consistent density to the UHF density is negligible *within this basis*. A minimal basis severely restricts the flexibility of the electron density. It is too small to represent significant differences between $\\rho_{\\mathrm{hyb}}$ and $\\rho_{\\mathrm{UHF}}$. Therefore, the error observed in the calculation, a large deviation from the exact energy ($E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}} - E_{\\mathrm{ref}} = -0.990 - (-1.000) = +0.010\\,E_{\\mathrm{h}}$), is not due to a poor density choice *within the allowed space* but rather due to the inadequacy of the space itself. This inadequacy is the basis-set incompleteness error. The statement accurately concludes that the small observable density-driven error suggests that basis-set error is the dominant factor.\n**Verdict: Correct.**\n\n**C. The residual gap between $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}]$ and $E_{\\mathrm{ref}}$ in the large basis is attributable to functional-driven error (e.g., missing static correlation in the semi-local form).**\nThe gap is $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}] - E_{\\mathrm{ref}} = -1.008 - (-1.000) = -0.008\\,E_{\\mathrm{h}}$. This quantity represents the error of the PBE functional when evaluated on a higher-fidelity density ($\\rho_{\\mathrm{UHF}}$), which is our best proxy for the functional-driven error. This is the error stemming from the intrinsic mathematical form of the PBE functional itself, specifically its inability to correctly describe the multi-reference nature (static correlation) of the stretched H$_2$ bond, even when provided with a qualitatively correct density.\n**Verdict: Correct.**\n\n**D. Because the approximate energy functional is minimized at its own self-consistent density, the Hohenberg–Kohn variational principle ensures that replacing $\\rho_{\\mathrm{approx}}$ by a better density such as $\\rho_{\\mathrm{UHF}}$ cannot reduce the total error relative to $E_{\\mathrm{ref}}$.**\nThis statement conflates two different variational principles. The variational principle for an *approximate* functional $E_{\\mathrm{approx}}[\\rho]$ states that $E_{\\mathrm{approx}}[\\rho_{\\mathrm{approx}}] \\le E_{\\mathrm{approx}}[\\rho]$ for any other density $\\rho$. This is true for PBE: $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{PBE}}] = -1.030\\,E_{\\mathrm{h}}$ is indeed lower than $E_{\\mathrm{PBE}}[\\rho_{\\mathrm{UHF}}] = -1.008\\,E_{\\mathrm{h}}$. However, the Hohenberg-Kohn variational principle applies to the *exact* functional, guaranteeing that $E_{\\mathrm{exact}}[\\rho] \\ge E_{\\mathrm{ref}}$. There is no principle that guarantees that $E_{\\mathrm{approx}}[\\rho_{\\mathrm{approx}}]$ is closer to $E_{\\mathrm{ref}}$ than $E_{\\mathrm{approx}}[\\rho_{\\text{other}}]$ is. The data explicitly contradicts the statement's conclusion. The total error with the self-consistent density is $|-1.030 - (-1.000)| = 0.030\\,E_{\\mathrm{h}}$. The total error with the UHF density is $|-1.008 - (-1.000)| = 0.008\\,E_{\\mathrm{h}}$. The error *was* reduced by replacing the density.\n**Verdict: Incorrect.**\n\n**E. In a minimal basis, density errors must dominate the energy error because the basis limits the variational space for $\\rho(\\mathbf{r})$, so replacing $\\rho_{\\mathrm{hyb}}$ by $\\rho_{\\mathrm{UHF}}$ necessarily produces a large energy improvement.**\nThis statement contains fallacious reasoning and a conclusion contradicted by the data. The premise that limiting the variational space causes density errors to dominate is incorrect; it actually *suppresses* the ability of the system to express different densities, thereby making the observable density-driven error small, as shown in the analysis for option B. The conclusion that replacing the density \"necessarily produces a large energy improvement\" is factually disproven by the data: the change is $E_{\\mathrm{hyb}}[\\rho_{\\mathrm{hyb}}]_{\\mathrm{min}} - E_{\\mathrm{hyb}}[\\rho_{\\mathrm{UHF}}]_{\\mathrm{min}} = +0.001\\,E_{\\mathrm{h}}$, which is a negligible change, not a large improvement.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{ABC}$$", "id": "2453913"}]}