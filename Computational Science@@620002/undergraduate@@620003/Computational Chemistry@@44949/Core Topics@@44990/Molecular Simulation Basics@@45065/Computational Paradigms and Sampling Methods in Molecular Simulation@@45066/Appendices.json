{"hands_on_practices": [{"introduction": "A common point of confusion when first running molecular simulations is the distinction between thermodynamic ensembles. This exercise [@problem_id:2453071] probes your understanding of the microcanonical ($NVE$) ensemble, where total energy $E$ is conserved. You will explore why the instantaneous kinetic temperature, which is derived from the kinetic energy $K(t)$, is not a conserved quantity and is expected to fluctuate, reinforcing the statistical nature of temperature in molecular systems.", "problem": "A student performs a classical Molecular Dynamics (MD) simulation of an isolated molecule in the constant Number, Volume, Energy (NVE) ensemble (also called the microcanonical ensemble). The integrator conserves the total energy to numerical tolerance with no discernible drift over time, but the code-reported instantaneous temperature, computed from the instantaneous kinetic energy, fluctuates strongly about a stable long-time average. Which statement best characterizes whether this result is physically and statistically correct, and why?\n\nA. Correct: In the microcanonical ensemble, only the total energy is a constant of motion; the instantaneous kinetic energy $K(t)$ exchanges with the potential energy $U(t)$ so that $E = K(t) + U(t)$ remains constant. Since the kinetic temperature is defined from $K(t)$ via equipartition, it fluctuates. For a system with a finite number of quadratic degrees of freedom $f$, the relative fluctuations are large when $f$ is small and decrease roughly as $1/\\sqrt{f}$.\n\nB. Incorrect: By definition of the NVE ensemble, both total energy and temperature must remain exactly constant; large temperature fluctuations imply an unstable or inaccurate integrator.\n\nC. Incorrect: Temperature fluctuations can be removed by eliminating center-of-mass (COM) motion; if they persist, a misconfigured thermostat is to blame.\n\nD. Correct: Large temperature fluctuations are expected only when the system is coupled to a heat bath; for a truly isolated system in NVE, the kinetic temperature must be constant, so the observed behavior indicates hidden thermostatting.", "solution": "Begin from first principles of classical mechanics and statistical mechanics. In a classical MD trajectory of an isolated system in the constant Number, Volume, Energy (NVE) ensemble, the Hamiltonian dynamics conserve the total energy,\n$$\nE = K(t) + U(t),\n$$\nso that\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = 0.\n$$\nHowever, neither the kinetic energy $K(t)$ nor the potential energy $U(t)$ is individually conserved; they continuously exchange such that their sum remains constant. The commonly reported “instantaneous temperature” in classical MD is defined from the instantaneous kinetic energy by the equipartition theorem as\n$$\nT_{\\mathrm{inst}}(t) = \\frac{2\\,K(t)}{f\\,k_{\\mathrm{B}}},\n$$\nwhere $f$ is the number of quadratic degrees of freedom and $k_{\\mathrm{B}}$ is the Boltzmann constant. Because $K(t)$ fluctuates in time even under perfect energy conservation, $T_{\\mathrm{inst}}(t)$ will likewise fluctuate.\n\nThermodynamic temperature is fundamentally an ensemble property. In the microcanonical ensemble, it is defined via the entropy $S$ by\n$$\n\\frac{1}{T} = \\left(\\frac{\\partial S}{\\partial E}\\right)_{N,V}.\n$$\nIn practice, for an ergodic system, the time average of $T_{\\mathrm{inst}}(t)$ over a sufficiently long NVE trajectory is used as an estimator of the thermodynamic temperature. For a finite system with a finite number of degrees of freedom $f$, fluctuations in $K(t)$ and hence in $T_{\\mathrm{inst}}(t)$ are expected and can be large when $f$ is small. In the canonical ensemble, one can show that the relative variance obeys\n$$\n\\frac{\\mathrm{Var}\\left(T_{\\mathrm{inst}}\\right)}{\\langle T_{\\mathrm{inst}}\\rangle^{2}} \\approx \\frac{2}{f},\n$$\nso the relative standard deviation scales like $1/\\sqrt{f}$. Microcanonical fluctuations of $K$ have a closely related scaling for large $f$, and for small isolated molecules (small $f$) the instantaneous temperature typically appears to fluctuate “wildly,” even though the total energy is perfectly conserved. Therefore, such behavior is physically and statistically correct for small systems in NVE.\n\nEvaluate each option:\n\nA. This option correctly identifies that only the total energy $E$ is conserved in the microcanonical ensemble and that $K(t)$ and thus $T_{\\mathrm{inst}}(t)$ fluctuate. It also correctly states the dependence of relative fluctuation magnitude on the number of degrees of freedom $f$, decreasing roughly as $1/\\sqrt{f}$. Verdict: Correct.\n\nB. This option incorrectly claims that temperature is a constant of motion in NVE. The definition of the microcanonical ensemble fixes $E$ (and $N$, $V$), not the instantaneous kinetic temperature defined from $K(t)$. Large fluctuations in $T_{\\mathrm{inst}}(t)$ do not imply an unstable integrator if $E$ is conserved; they are expected for small $f$. Verdict: Incorrect.\n\nC. Removing center-of-mass (COM) motion eliminates global translation but does not suppress internal exchanges between $K(t)$ and $U(t)$ that cause $T_{\\mathrm{inst}}(t)$ fluctuations. Moreover, invoking a thermostat is irrelevant because NVE has no thermostat by construction; temperature fluctuations without a thermostat are expected. Verdict: Incorrect.\n\nD. This option reverses the physical situation. Coupling to a heat bath (constant Number, Volume, Temperature, NVT) constrains the average temperature but still allows fluctuations; isolation in NVE does not force the kinetic temperature to be constant. Hidden thermostatting would tend to reduce, not increase, fluctuations relative to a tiny isolated system. Verdict: Incorrect.\n\nTherefore, the observed behavior—perfect energy conservation with strongly fluctuating instantaneous temperature in a small isolated system—is physically and statistically correct, as expressed in option A.", "answer": "$$\\boxed{A}$$", "id": "2453071"}, {"introduction": "While the microcanonical ($NVE$) ensemble should theoretically conserve total energy, numerical simulations often exhibit artifacts that violate this principle. This practice problem [@problem_id:2453046] presents a classic case of energy drift and challenges you to diagnose its root cause. By analyzing the properties of a truncated potential, you will learn how discontinuities in the force can break the time-reversibility of common integrators, a crucial lesson in setting up stable and physically meaningful simulations.", "problem": "A system of $N$ identical particles is simulated with classical Molecular Dynamics (MD) in the microcanonical (NVE) ensemble using the velocity-Verlet integrator with a fixed time step $\\Delta t$. The interaction is pairwise and given by a truncated and potential-shifted Lennard–Jones potential. Specifically, the base potential is\n$$\nV_{\\mathrm{LJ}}(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\nand the implemented interaction is\n$$\nV_{\\mathrm{ps}}(r) =\n\\begin{cases}\nV_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c), & r \\le r_c,\\\\\n0, & r > r_c,\n\\end{cases}\n$$\nwith forces computed as $-\\mathrm{d}V_{\\mathrm{ps}}/\\mathrm{d}r$ inside the cutoff and set to $0$ outside. The simulation uses periodic boundary conditions and no thermostat. Despite choosing $\\Delta t$ small enough to resolve the fastest vibrations, the total energy $E(t)$ exhibits a systematic drift over long times instead of remaining constant up to bounded fluctuations.\n\nWhich diagnosis best explains, in terms of the implemented potential $V(r)$, the most likely cause of the observed energy drift?\n\nA. The truncation leaves a jump discontinuity in the force $-\\mathrm{d}V/\\mathrm{d}r$ at $r = r_c$, so pairs crossing $r_c$ incur integration errors from the unresolved force jump that accumulate into a drift.\n\nB. The potential was not shifted to satisfy $V(r_c) = 0$, so $V(r)$ has a finite jump at $r = r_c$ and energy changes discontinuously when pairs cross $r_c$.\n\nC. The short-range repulsive wall of $V_{\\mathrm{LJ}}(r)$ is too stiff, and even with a smooth cutoff any symplectic Verlet-type integrator produces a secular drift in $E(t)$ for stiff potentials.\n\nD. Neglecting analytical long-range tail corrections to the energy for $r > r_c$ in the microcanonical simulation causes a systematic drift in $E(t)$ over time.", "solution": "The problem statement must first be validated for scientific soundness and consistency.\n\nStep 1: Extracted Givens\n- System: A system of $N$ identical particles.\n- Simulation method: Classical Molecular Dynamics (MD) in the microcanonical ($NVE$) ensemble.\n- Integrator: Velocity-Verlet integrator with a fixed time step $\\Delta t$.\n- Condition on time step: $\\Delta t$ is small enough to resolve the fastest vibrations.\n- Base potential: $V_{\\mathrm{LJ}}(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$.\n- Implemented potential: $V_{\\mathrm{ps}}(r) = \\begin{cases} V_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c), & r \\le r_c,\\\\ 0, & r > r_c, \\end{cases}$.\n- Force calculation: The force is calculated as $-\\mathrm{d}V_{\\mathrm{ps}}/\\mathrm{d}r$ for $r \\le r_c$ and is set to $0$ for $r > r_c$.\n- Boundary conditions: Periodic boundary conditions are used.\n- Thermostat: No thermostat is used.\n- Observation: The total energy $E(t)$ exhibits a systematic drift over long times.\n- Question: What is the most likely cause of the observed energy drift, related to the potential $V(r)$?\n\nStep 2: Validation\nThe problem describes a standard scenario in molecular simulation. The components—microcanonical ensemble, velocity-Verlet integrator, Lennard-Jones potential, and potential truncation schemes—are all fundamental concepts in computational physics and chemistry. The observation of energy drift is a well-known numerical artifact under certain conditions. The problem is scientifically grounded, well-posed, and objective. It contains sufficient information to determine the most likely cause from the given options. No scientific principles are violated, the setup is realistic, and the question is precisely stated.\n\nStep 3: Verdict\nThe problem statement is valid. I will proceed with the derivation of the solution.\n\nDerivation of the Correct Answer\nIn a classical MD simulation within the $NVE$ ensemble, the total energy of the system, $E(t) = K(t) + U(t)$ (the sum of kinetic and potential energies), must be a conserved quantity. Numerical integration schemes, such as the velocity-Verlet algorithm, approximate the true dynamics. For a time-reversible and symplectic integrator like velocity-Verlet, when applied to a system with a time-independent, conservative, and sufficiently smooth Hamiltonian, the total energy should not exhibit a systematic drift. Instead, it should show bounded fluctuations around a constant mean value. The observed systematic drift in $E(t)$ indicates a violation of one of these conditions.\n\nThe source of the problem must be traced to the properties of the implemented potential, $V_{\\mathrm{ps}}(r)$, and the corresponding force, $F(r) = -\\mathrm{d}V_{\\mathrm{ps}}(r)/\\mathrm{d}r$.\n\nLet us analyze the potential and force at the cutoff radius, $r_c$.\n\n1.  **Continuity of the Potential $V_{\\mathrm{ps}}(r)$**:\n    The potential for $r \\le r_c$ is defined as $V_{\\mathrm{ps}}(r) = V_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c)$. At the cutoff, for $r=r_c$, this expression yields $V_{\\mathrm{ps}}(r_c) = V_{\\mathrm{LJ}}(r_c) - V_{\\mathrm{LJ}}(r_c) = 0$.\n    For $r > r_c$, the potential is defined as $V_{\\mathrm{ps}}(r) = 0$.\n    Since the value of the potential approaches $0$ from both sides of $r_c$, the potential function $V_{\\mathrm{ps}}(r)$ is continuous everywhere. This is the purpose of the \"potential-shift\" term, $-V_{\\mathrm{LJ}}(r_c)$.\n\n2.  **Continuity of the Force $F(r)$**:\n    The force is the negative gradient of the potential.\n    For $r \\le r_c$, the force is $F(r) = -\\frac{\\mathrm{d}}{\\mathrm{d}r} \\left( V_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c) \\right) = -\\frac{\\mathrm{d}V_{\\mathrm{LJ}}(r)}{\\mathrm{d}r}$, since $V_{\\mathrm{LJ}}(r_c)$ is a constant.\n    The derivative of the Lennard-Jones potential is:\n    $$ \\frac{\\mathrm{d}V_{\\mathrm{LJ}}(r)}{\\mathrm{d}r} = 4\\varepsilon \\left( -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^6}{r^7} \\right) = \\frac{24\\varepsilon}{r} \\left( -2\\frac{\\sigma^{12}}{r^{12}} + \\frac{\\sigma^6}{r^6} \\right) $$\n    For $r > r_c$, the force is explicitly set to $F(r) = 0$.\n\n    Let us evaluate the force at the boundary $r=r_c$.\n    The limit of the force as $r$ approaches $r_c$ from below is:\n    $$ F(r \\to r_c^-) = -\\frac{\\mathrm{d}V_{\\mathrm{LJ}}(r)}{\\mathrm{d}r}\\bigg|_{r=r_c} = -\\frac{24\\varepsilon}{r_c} \\left( -2\\frac{\\sigma^{12}}{r_c^{12}} + \\frac{\\sigma^6}{r_c^6} \\right) $$\n    The limit of the force as $r$ approaches $r_c$ from above is:\n    $$ F(r \\to r_c^+) = 0 $$\n    In general, $\\frac{\\mathrm{d}V_{\\mathrm{LJ}}}{\\mathrm{d}r}$ is non-zero at $r=r_c$. It is only zero at the potential minimum, $r_m = 2^{1/6}\\sigma$, which is not a sensible choice for a cutoff radius. Therefore, $F(r \\to r_c^-) \\neq F(r \\to r_c^+)$. The force field has a jump discontinuity at $r=r_c$.\n\nThe derivation of the velocity-Verlet algorithm, and the proof of its symplecticity, relies on the assumption that the potential function is smooth (at least twice differentiable, so the force is continuously differentiable). The discontinuity in the force $F(r)$ violates this condition. When a pair of particles crosses the cutoff distance $r_c$, the integrator must handle an instantaneous change in force, which it is not designed to do. This results in a small error in the integration of the equations of motion for that step. Because particle pairs cross the cutoff boundary systematically in a simulation, these small, directed errors accumulate over time, leading to a systematic drift in the total energy rather than bounded oscillations.\n\nEvaluation of Options\nA. The truncation leaves a jump discontinuity in the force $-\\mathrm{d}V/\\mathrm{d}r$ at $r = r_c$, so pairs crossing $r_c$ incur integration errors from the unresolved force jump that accumulate into a drift.\nThis statement is perfectly aligned with our derivation. The implemented potential, while continuous itself, generates a discontinuous force at the cutoff. This discontinuity breaks the symplectic nature of the Verlet integration scheme, causing an accumulation of errors that manifests as a systematic energy drift. This is the canonical explanation for energy drift with simple truncated potentials.\n**Verdict: Correct.**\n\nB. The potential was not shifted to satisfy $V(r_c) = 0$, so $V(r)$ has a finite jump at $r = r_c$ and energy changes discontinuously when pairs cross $r_c$.\nThis statement is factually incorrect. The problem explicitly describes a potential-shifted form: $V_{\\mathrm{ps}}(r) = V_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c)$ for $r \\le r_c$. As demonstrated above, this specific construction ensures that the potential $V_{\\mathrm{ps}}(r)$ is continuous at $r = r_c$, with $V_{\\mathrm{ps}}(r_c) = 0$. A discontinuous potential would cause infinite forces and catastrophic energy non-conservation, which is a more severe problem than a mere drift.\n**Verdict: Incorrect.**\n\nC. The short-range repulsive wall of $V_{\\mathrm{LJ}}(r)$ is too stiff, and even with a smooth cutoff any symplectic Verlet-type integrator produces a secular drift in $E(t)$ for stiff potentials.\nThis statement is misleading. While stiff potentials (i.e., those with large second derivatives) require a very small time step $\\Delta t$ for stable and accurate integration, the problem states that $\\Delta t$ was chosen appropriately (\"small enough to resolve the fastest vibrations\"). For any smooth potential, stiff or not, a symplectic integrator with a sufficiently small time step will conserve energy up to bounded fluctuations, without a secular (long-term, systematic) drift. The stiffness affects the amplitude of these fluctuations, but does not cause a drift. The cause of drift is the loss of symplecticity, which happens here due to the non-smoothness of the potential (discontinuous force), not its stiffness.\n**Verdict: Incorrect.**\n\nD. Neglecting analytical long-range tail corrections to the energy for $r > r_c$ in the microcanonical simulation causes a systematic drift in $E(t)$ over time.\nLong-range tail corrections are constant adjustments made to observables like energy and pressure to account for interactions beyond the cutoff. For energy, this correction is a constant value, typically calculated assuming a uniform radial distribution function for $r > r_c$. This correction affects the absolute value of the total energy reported, but it does not influence the dynamics of the simulation, as the forces are derived from the truncated potential $V_{\\mathrm{ps}}(r)$. The quantity that is supposed to be conserved by the integrator is the Hamiltonian of the simulated system, $E(t) = K(t) + U_{\\mathrm{ps}}(t)$. Adding a constant does not change its time derivative; thus, neglecting a constant correction cannot introduce a drift over time.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2453046"}, {"introduction": "Perhaps the most critical skill in computational science is judging whether a simulation has produced a meaningful result. This advanced problem [@problem_id:2453013] delves into the subtle but vital concept of ergodicity and sampling. It demonstrates how a simulation can appear 'equilibrated' based on a fast-recovering metric like kinetic temperature, while failing to sample the important slow configurational changes, providing a powerful lesson on the limitations of simple diagnostics.", "problem": "A classical Molecular Dynamics (MD) simulation of a cluster with $N=50$ particles is run under a thermostat set to a target temperature $T=300\\,\\mathrm{K}$. The Hamiltonian is separable into kinetic and potential terms, $H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$, and the equations of motion are integrated with a time step small enough to ensure numerical stability. Over a trajectory of length $10\\,\\mathrm{ns}$, the system remains confined to a single metastable basin separated by large free-energy barriers from other basins. The running time-average of the kinetic-temperature observable, defined via the instantaneous kinetic energy and the number of active degrees of freedom, matches the target temperature $T$ to within $1\\%$.\n\nStarting from first principles of the canonical ensemble, the definition of ergodicity as the equality of time and ensemble averages in the long-time limit, and the separability of kinetic and potential energy in classical mechanics, reason about how the time-averaged kinetic temperature can match the target even when the simulation is non-ergodic (i.e., trapped in a basin), and why agreement of the kinetic temperature with $T$ is a misleading diagnostic of proper sampling.\n\nWhich statements correctly explain both how this is possible and why relying on kinetic temperature alone can misdiagnose sampling quality? Select all that apply.\n\nA. In the canonical ensemble with separable Hamiltonian $H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$, the joint distribution factorizes, so a thermostat can enforce the correct Maxwell–Boltzmann momentum marginal and thereby $\\langle K\\rangle$ consistent with $T$, even if the coordinate distribution is restricted to one basin; thus the time-averaged kinetic temperature can match $T$ while configurational sampling is biased.\n\nB. Matching the target temperature guarantees that all ensemble averages are correct, because time averages equal ensemble averages regardless of ergodicity.\n\nC. The kinetic temperature depends primarily on fast velocity fluctuations and is largely insensitive to rare barrier-crossing events in slow collective coordinates; therefore it can appear correct while slow modes remain unsampled, making it an unreliable indicator of configurational sampling.\n\nD. Non-ergodicity necessarily causes the kinetic temperature to drift away from the setpoint over long times, so observing a match between the time-averaged kinetic temperature and $T$ implies ergodicity.\n\nE. Accounting for constraints reduces the number of degrees of freedom, and once this count is correct the temperature will always match $T$, which also implies that the coordinate distribution is correct.", "solution": "The problem statement will first be validated for scientific soundness and completeness.\n\n### Step 1: Extract Givens\n\n-   Simulation type: Classical Molecular Dynamics (MD)\n-   Number of particles: $N=50$\n-   Thermostat target temperature: $T=300\\,\\mathrm{K}$\n-   Hamiltonian: Separable, $H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$\n-   Integration time step: Sufficiently small for numerical stability.\n-   Trajectory length: $10\\,\\mathrm{ns}$\n-   System dynamics: The system is confined to a single metastable basin, separated by large free-energy barriers from other basins.\n-   Observation: The running time-average of the kinetic-temperature observable matches the target temperature $T$ to within $1\\%$.\n-   Definition of kinetic temperature: Derived from the instantaneous kinetic energy and the number of active degrees of freedom.\n-   Task: Explain how the time-averaged kinetic temperature can match the target $T$ despite the simulation being non-ergodic, and why this agreement is a misleading diagnostic of proper sampling.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientific Groundedness**: The problem describes a canonical scenario in computational statistical mechanics. A separable Hamiltonian is the standard form in classical mechanics. The concept of a system being trapped in a metastable basin is a central challenge in MD, known as the sampling problem. Thermostats, the canonical ensemble, and the distinction between kinetic and configurational sampling are all fundamental and well-established principles. The problem is scientifically sound.\n-   **Well-Posedness**: The question is unambiguous. It asks for a mechanistic explanation for a common observation in MD simulations and requires evaluation of provided statements against this explanation. The setup is self-contained and allows for a definitive answer based on the principles of statistical mechanics.\n-   **Objectivity**: The problem is stated in precise, objective, and technical language. There are no subjective or opinion-based elements.\n\n### Step 3: Verdict and Action\n\nThe problem statement is valid. It is scientifically grounded, well-posed, and objective. A rigorous solution can be derived from first principles.\n\n### Derivation from First Principles\n\nIn the canonical (NVT) ensemble, the equilibrium probability distribution of states in phase space $(\\mathbf{q}, \\mathbf{p})$ is given by the Boltzmann distribution:\n$$\n\\rho(\\mathbf{q}, \\mathbf{p}) = \\frac{1}{Z} e^{-\\beta H(\\mathbf{q}, \\mathbf{p})}\n$$\nwhere $\\beta = (k_B T)^{-1}$, $k_B$ is the Boltzmann constant, $T$ is the thermodynamic temperature, and $Z$ is the canonical partition function.\n\nThe problem states that the Hamiltonian is separable: $H(\\mathbf{p},\\mathbf{q}) = K(\\mathbf{p}) + U(\\mathbf{q})$. This has a profound consequence. The probability distribution factorizes into independent distributions for momenta $\\mathbf{p}$ and coordinates $\\mathbf{q}$:\n$$\n\\rho(\\mathbf{q}, \\mathbf{p}) = \\frac{1}{Z_p Z_q} e^{-\\beta K(\\mathbf{p})} e^{-\\beta U(\\mathbf{q})} = \\rho_p(\\mathbf{p}) \\rho_q(\\mathbf{q})\n$$\nwhere $\\rho_p(\\mathbf{p}) = Z_p^{-1} \\exp(-\\beta K(\\mathbf{p}))$ is the marginal probability distribution for momenta, and $\\rho_q(\\mathbf{q}) = Z_q^{-1} \\exp(-\\beta U(\\mathbf{q}))$ is the marginal probability distribution for coordinates. The key insight is that momenta and coordinates are statistically independent in the canonical ensemble for a separable Hamiltonian.\n\nA thermostat coupled to an MD simulation primarily acts to modify the equations of motion for the momenta $\\mathbf{p}$ to ensure that their distribution samples $\\rho_p(\\mathbf{p})$ correctly. This is the Maxwell-Boltzmann distribution. The ensemble average of the kinetic energy $K(\\mathbf{p})$ is then determined solely by this momentum distribution:\n$$\n\\langle K \\rangle_\\text{ens} = \\int K(\\mathbf{p}) \\rho_p(\\mathbf{p}) d\\mathbf{p}\n$$\nAccording to the equipartition theorem, which applies here, each quadratic term in the kinetic energy contributes $\\frac{1}{2} k_B T$ to this average. If there are $N_\\text{dof}$ kinetic degrees of freedom, then:\n$$\n\\langle K \\rangle_\\text{ens} = \\frac{N_\\text{dof}}{2} k_B T\n$$\nThe instantaneous kinetic temperature is defined as $T_\\text{kin}(t) = \\frac{2 K(\\mathbf{p}(t))}{N_\\text{dof} k_B}$. A working thermostat ensures that the time-average of this quantity, $\\langle T_\\text{kin} \\rangle_\\text{time}$, converges to the target temperature $T$. This equilibration happens on a very fast timescale, characteristic of molecular vibrations and collisions (femtoseconds to picoseconds).\n\nNow consider the configurational part. The ergodic hypothesis states that for a sufficiently long trajectory, the time average of an observable is equal to its ensemble average. In this problem, the simulation is explicitly stated to be non-ergodic over the $10\\,\\mathrm{ns}$ timescale because it is trapped in a single metastable basin. This means the trajectory only explores a subset of the configuration space $\\mathbf{q}$. Consequently, a time-average of any configurational observable $A(\\mathbf{q})$ will only reflect an average over that single basin, not the full Boltzmann-weighted average over all accessible configurations.\n$$\n\\langle A(\\mathbf{q}) \\rangle_\\text{time} \\approx \\langle A(\\mathbf{q}) \\rangle_\\text{basin} \\neq \\langle A(\\mathbf{q}) \\rangle_\\text{ens}\n$$\nBecause the dynamics of $\\mathbf{p}$ and $\\mathbf{q}$ are statistically decoupled in the ensemble, and because thermostats act efficiently on the fast momentum degrees of freedom, it is entirely possible for $\\langle K \\rangle_\\text{time} \\approx \\langle K \\rangle_\\text{ens}$ (and thus $\\langle T_\\text{kin} \\rangle_\\text{time} \\approx T$) while simultaneously $\\langle U \\rangle_\\text{time} \\neq \\langle U \\rangle_\\text{ens}$ and sampling of configuration space is severely biased.\n\nTherefore, agreement of the kinetic temperature with the target value $T$ is a check on the performance of the thermostat and the equilibration of kinetic degrees of freedom, but it provides no information about the sampling of the configurational landscape. Relying on it as a sole indicator of overall simulation quality or \"equilibration\" is a common but serious error, as the slow degrees of freedom responsible for conformational changes and chemical processes may be completely unsampled.\n\n### Option-by-Option Analysis\n\n**A. In the canonical ensemble with separable Hamiltonian $H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$, the joint distribution factorizes, so a thermostat can enforce the correct Maxwell–Boltzmann momentum marginal and thereby $\\langle K\\rangle$ consistent with $T$, even if the coordinate distribution is restricted to one basin; thus the time-averaged kinetic temperature can match $T$ while configurational sampling is biased.**\nThis statement is a precise summary of the statistical mechanics principles derived above. It correctly identifies the separability of the Hamiltonian and the resulting factorization of the probability distribution as the fundamental reason. It correctly explains that the thermostat acts on the momentum distribution independently of the (potentially poor) configurational sampling. This explains both *how* the phenomenon is possible and *why* kinetic temperature is a misleading diagnostic.\n**Verdict: Correct**\n\n**B. Matching the target temperature guarantees that all ensemble averages are correct, because time averages equal ensemble averages regardless of ergodicity.**\nThis statement is fundamentally false. The equivalence of time and ensemble averages is the definition of ergodicity. For a non-ergodic system, this equality does not hold. The problem explicitly describes a non-ergodic sampling situation. Therefore, this statement is in direct contradiction with the principles of statistical mechanics.\n**Verdict: Incorrect**\n\n**C. The kinetic temperature depends primarily on fast velocity fluctuations and is largely insensitive to rare barrier-crossing events in slow collective coordinates; therefore it can appear correct while slow modes remain unsampled, making it an unreliable indicator of configurational sampling.**\nThis statement provides a kinetic and timescale-based explanation which is complementary to the statistical mechanical argument in A. Momenta $\\mathbf{p}$ (and thus velocities) fluctuate on a very fast timescale ($\\sim 10^{-15} - 10^{-12}\\,\\mathrm{s}$). A thermostat can equilibrate these fluctuations quickly. Barrier-crossing events involve slow, collective motions of coordinates $\\mathbf{q}$ that occur on much longer timescales ($\\sim 10^{-9}\\,\\mathrm{s}$ or longer). A $10\\,\\mathrm{ns}$ simulation is long enough to average over the fast kinetic fluctuations, yielding a correct $\\langle T_\\text{kin} \\rangle_\\text{time}$, but may be far too short to observe the rare configurational events. This correctly identifies the timescale separation as the reason for the misleading diagnostic.\n**Verdict: Correct**\n\n**D. Non-ergodicity necessarily causes the kinetic temperature to drift away from the setpoint over long times, so observing a match between the time-averaged kinetic temperature and $T$ implies ergodicity.**\nThis statement is incorrect. As explained, non-ergodicity in configuration space does not prevent a thermostat from maintaining the kinetic temperature at the target value. The proper function of a thermostat is precisely to prevent such drifts. Therefore, observing a match between kinetic temperature and the target $T$ absolutely does not imply ergodicity in the full phase space. This statement posits the exact opposite of the correct physical picture.\n**Verdict: Incorrect**\n\n**E. Accounting for constraints reduces the number of degrees of freedom, and once this count is correct the temperature will always match $T$, which also implies that the coordinate distribution is correct.**\nThis statement is flawed. While it is true that one must use the correct number of degrees of freedom, $N_\\text{dof}$, to calculate $T_\\text{kin}$ from $K$, this is merely a matter of correct calculation. It does not guarantee that the temperature will match $T$; the thermostat does that. The final conclusion, that this implies the coordinate distribution is correct, is a non-sequitur and is fundamentally wrong for the reasons detailed in the analysis of options A and C.\n**Verdict: Incorrect**", "answer": "$$\\boxed{AC}$$", "id": "2453013"}]}