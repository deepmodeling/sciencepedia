{"hands_on_practices": [{"introduction": "This first practice establishes the fundamental test for size consistency. By examining the calculated energy of two well-separated helium atoms, you will write a simple program to quantitatively verify how several widely used electronic structure methods perform against the theoretical requirement that $E(A+B) = E(A) + E(B)$ for non-interacting systems [@problem_id:2805734]. This exercise provides a direct, hands-on experience with the core definition of size consistency and reveals which computational methods adhere to this crucial principle.", "problem": "Construct a programmatic, quantitative test of size consistency for electronic structure methods using two well-separated helium atoms treated under the Born–Oppenheimer approximation in a large one-electron basis. The fundamental base is the additivity of energies for non-interacting subsystems: when the total Hamiltonian factorizes as a direct sum, the energies add. Formally, let subsystem Hamiltonians be denoted $H_A$ and $H_B$ acting on disjoint Hilbert spaces with negligible inter-subsystem interaction at large separation $R$. The composite Hamiltonian is $H = H_A \\oplus H_B$, so the ground-state energy satisfies $E(A + B) = E(A) + E(B)$ when the subsystems are non-interacting. Size consistency is the property that a method returns $E_{\\text{method}}(A + B) = E_{\\text{method}}(A) + E_{\\text{method}}(B)$ when $A$ and $B$ do not interact. For two identical atoms, this reduces to $E_{\\text{method}}(\\text{He}\\cdot\\text{He}) = 2 E_{\\text{method}}(\\text{He})$ at sufficiently large interatomic separation $R$.\n\nUsing this base, design a numerical pass/fail test for size consistency defined as follows. For a given method, separation $R$ (in bohr), a monomer energy $E_{\\text{mono}}$ (in Hartree), a dimer energy $E_{\\text{dimer}}$ (in Hartree) computed at the same level of theory and basis, and a tolerance $\\tau$ (in Hartree), the method passes if and only if\n$$\n\\left| E_{\\text{dimer}} - 2 E_{\\text{mono}} \\right| \\le \\tau.\n$$\nAll energies must be in Hartree, and $R$ must be sufficiently large to render the interaction negligible.\n\nImplement a program that, given the test suite below, outputs a single list of booleans indicating for each case whether the method is size-consistent within the specified tolerance. The interatomic distance $R$ is provided for scientific completeness but does not enter the numerical criterion directly (it justifies the non-interacting assumption).\n\nUse the following test suite, intended to probe a variety of scenarios under a large basis where basis set superposition error is negligible:\n- Case $1$ (Hartree–Fock): $R = 30.0$ bohr, $E_{\\text{mono}} = -2.861679995$ Hartree, $E_{\\text{dimer}} = -5.723356990$ Hartree, $\\tau = 1\\times 10^{-5}$ Hartree.\n- Case $2$ (Coupled Cluster with Singles and Doubles): $R = 50.0$ bohr, $E_{\\text{mono}} = -2.902786500$ Hartree, $E_{\\text{dimer}} = -5.805572990$ Hartree, $\\tau = 1\\times 10^{-5}$ Hartree.\n- Case $3$ (Second-Order Møller–Plesset Perturbation Theory): $R = 40.0$ bohr, $E_{\\text{mono}} = -2.902350000$ Hartree, $E_{\\text{dimer}} = -5.804698000$ Hartree, $\\tau = 1\\times 10^{-5}$ Hartree.\n- Case $4$ (Configuration Interaction with Singles and Doubles): $R = 30.0$ bohr, $E_{\\text{mono}} = -2.902500000$ Hartree, $E_{\\text{dimer}} = -5.804800000$ Hartree, $\\tau = 1\\times 10^{-5}$ Hartree.\n- Case $5$ (Boundary case): $R = 35.0$ bohr, $E_{\\text{mono}} = -2.900000000$ Hartree, $E_{\\text{dimer}} = -5.800010000$ Hartree, $\\tau = 1\\times 10^{-5}$ Hartree.\n\nYour program must:\n- For each case, compute the absolute deviation $\\left| E_{\\text{dimer}} - 2 E_{\\text{mono}} \\right|$ and compare to $\\tau$.\n- Return a boolean for each case: `True` if the inequality holds and `False` otherwise.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True,True,False]\").", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It defines a correct and quantitative test for the fundamental quantum-chemical property of size consistency. The provided data are realistic and serve to illustrate the known behavior of several standard electronic structure methods. We shall proceed with the analysis.\n\nThe concept of size consistency is a critical requirement for any reliable quantum chemical method. It dictates that the energy of a system composed of two non-interacting subsystems, $A$ and $B$, must be equal to the sum of the energies of the individual subsystems. If the total Hamiltonian $H$ can be written as a direct sum of the subsystem Hamiltonians, $H = H_A \\oplus H_B$, then the total energy must be additive: $E(A + B) = E(A) + E(B)$.\n\nThe problem specifies a scenario with two identical, well-separated helium atoms, for which the interaction energy is negligible. In this case, the size consistency criterion simplifies. Let $E_{\\text{mono}}$ be the energy of a single helium atom, and $E_{\\text{dimer}}$ be the energy of the two-atom system (the \"dimer\") at a large separation distance $R$. A size-consistent method must satisfy the relation $E_{\\text{dimer}} = 2 E_{\\text{mono}}$.\n\nThe problem defines a numerical test for size consistency based on a tolerance, $\\tau$. A method is considered size-consistent if the absolute deviation from exact additivity is within this tolerance:\n$$\n\\left| E_{\\text{dimer}} - 2 E_{\\text{mono}} \\right| \\le \\tau\n$$\nWe define the size-consistency error as $\\Delta E_{\\text{SC}} = E_{\\text{dimer}} - 2 E_{\\text{mono}}$. The test is thus to check if $|\\Delta E_{\\text{SC}}| \\le \\tau$.\n\nWe now evaluate the five test cases provided.\n\nCase $1$: Hartree–Fock (HF)\nGiven: $E_{\\text{mono}} = -2.861679995$ Hartree, $E_{\\text{dimer}} = -5.723356990$ Hartree, and $\\tau = 1 \\times 10^{-5}$ Hartree.\nThe size-consistency error is:\n$$\n\\Delta E_{\\text{SC}} = -5.723356990 - 2 \\times (-2.861679995) = -5.723356990 + 5.723359990 = 0.000003000 \\text{ Hartree}\n$$\nWe test the condition:\n$$\n|\\Delta E_{\\text{SC}}| = |0.000003000| = 3.0 \\times 10^{-6} \\le 1 \\times 10^{-5}\n$$\nThe condition is satisfied. The result is `True`. This is expected, as the Hartree-Fock method is size-consistent.\n\nCase $2$: Coupled Cluster with Singles and Doubles (CCSD)\nGiven: $E_{\\text{mono}} = -2.902786500$ Hartree, $E_{\\text{dimer}} = -5.805572990$ Hartree, and $\\tau = 1 \\times 10^{-5}$ Hartree.\nThe size-consistency error is:\n$$\n\\Delta E_{\\text{SC}} = -5.805572990 - 2 \\times (-2.902786500) = -5.805572990 + 5.805573000 = 0.000000010 \\text{ Hartree}\n$$\nWe test the condition:\n$$\n|\\Delta E_{\\text{SC}}| = |0.000000010| = 1.0 \\times 10^{-8} \\le 1 \\times 10^{-5}\n$$\nThe condition is satisfied. The result is `True`. This is expected, as all standard coupled-cluster methods are size-consistent.\n\nCase $3$: Second-Order Møller–Plesset Perturbation Theory (MP2)\nGiven: $E_{\\text{mono}} = -2.902350000$ Hartree, $E_{\\text{dimer}} = -5.804698000$ Hartree, and $\\tau = 1 \\times 10^{-5}$ Hartree.\nThe size-consistency error is:\n$$\n\\Delta E_{\\text{SC}} = -5.804698000 - 2 \\times (-2.902350000) = -5.804698000 + 5.804700000 = 0.000002000 \\text{ Hartree}\n$$\nWe test the condition:\n$$\n|\\Delta E_{\\text{SC}}| = |0.000002000| = 2.0 \\times 10^{-6} \\le 1 \\times 10^{-5}\n$$\nThe condition is satisfied. The result is `True`. This is expected, as Møller–Plesset perturbation theory at any finite order is size-consistent.\n\nCase $4$: Configuration Interaction with Singles and Doubles (CISD)\nGiven: $E_{\\text{mono}} = -2.902500000$ Hartree, $E_{\\text{dimer}} = -5.804800000$ Hartree, and $\\tau = 1 \\times 10^{-5}$ Hartree.\nThe size-consistency error is:\n$$\n\\Delta E_{\\text{SC}} = -5.804800000 - 2 \\times (-2.902500000) = -5.804800000 + 5.805000000 = 0.000200000 \\text{ Hartree}\n$$\nWe test the condition:\n$$\n|\\Delta E_{\\text{SC}}| = |0.000200000| = 2.0 \\times 10^{-4} \\le 1 \\times 10^{-5}\n$$\nThe condition is not satisfied, as $2.0 \\times 10^{-4} > 1 \\times 10^{-5}$. The result is `False`. This is the canonical example of the failure of truncated Configuration Interaction methods. For the dimer, a simultaneous double excitation on each monomer constitutes a quadruple excitation relative to the dimer's reference state. Truncated CI methods like CISD, by definition, cannot represent these quadruple excitations and therefore fail to capture the full correlation energy of the separated system.\n\nCase $5$: Boundary Case\nGiven: $E_{\\text{mono}} = -2.900000000$ Hartree, $E_{\\text{dimer}} = -5.800010000$ Hartree, and $\\tau = 1 \\times 10^{-5}$ Hartree.\nThe size-consistency error is:\n$$\n\\Delta E_{\\text{SC}} = -5.800010000 - 2 \\times (-2.900000000) = -5.800010000 + 5.800000000 = -0.000010000 \\text{ Hartree}\n$$\nWe test the condition, noting the use of less than or equal to:\n$$\n|\\Delta E_{\\text{SC}}| = |-0.000010000| = 1.0 \\times 10^{-5} \\le 1 \\times 10^{-5}\n$$\nThe condition is satisfied because the absolute deviation is exactly equal to the tolerance. The result is `True`.\n\nIn summary, the results are: HF(`True`), CCSD(`True`), MP2(`True`), CISD(`False`), Boundary(`True`). The implementation will codify this logic.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n# No external libraries are necessary for this calculation.\n\ndef solve():\n    \"\"\"\n    Performs a quantitative test of size consistency for several electronic\n    structure methods based on provided energy data.\n    \"\"\"\n    # The test suite provides data for five cases. Each tuple contains:\n    # (Method Name, R, E_mono, E_dimer, tolerance)\n    # R (separation in bohr) is provided for context but not used in the calculation.\n    test_cases = [\n        # Case 1 (Hartree–Fock)\n        (\"HF\", 30.0, -2.861679995, -5.723356990, 1e-5),\n        # Case 2 (Coupled Cluster with Singles and Doubles)\n        (\"CCSD\", 50.0, -2.902786500, -5.805572990, 1e-5),\n        # Case 3 (Second-Order Møller–Plesset Perturbation Theory)\n        (\"MP2\", 40.0, -2.902350000, -5.804698000, 1e-5),\n        # Case 4 (Configuration Interaction with Singles and Doubles)\n        (\"CISD\", 30.0, -2.902500000, -5.804800000, 1e-5),\n        # Case 5 (Boundary case)\n        (\"Boundary\", 35.0, -2.900000000, -5.800010000, 1e-5),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the tuple for clarity. The method name and R are not needed for the check.\n        _, _, e_mono, e_dimer, tau = case\n\n        # Calculate the absolute deviation from size consistency.\n        # The condition is |E_dimer - 2 * E_mono| <= tau.\n        deviation = abs(e_dimer - 2.0 * e_mono)\n\n        # The method passes the test if the deviation is within the tolerance.\n        # The comparison is inclusive (<=).\n        passes_test = deviation <= tau\n        results.append(passes_test)\n\n    # The final output must be a single string: a comma-separated list of\n    # booleans enclosed in square brackets.\n    # The map(str, ...) function correctly converts True to \"True\" and False to \"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2805734"}, {"introduction": "Having observed that certain methods like Configuration Interaction (CI) can fail the size-consistency test, we now explore the theoretical reason for this shortcoming. This 'pen-and-paper' exercise guides you through a simplified but powerful model of two non-interacting molecules to analytically derive the size-consistency error of a truncated CI method [@problem_id:2805781]. By working through the straightforward linear algebra, you will uncover the precise mathematical flaw—the omission of key electron configurations—that leads to this fundamental failure.", "problem": "Consider two identical, infinitely separated hydrogen dimers $\\mathrm{H}_{2}^{(A)}$ and $\\mathrm{H}_{2}^{(B)}$ at stretched geometries, treated within the Born–Oppenheimer approximation (fixed nuclei) and a minimal basis set per monomer. For each monomer, use a two-configuration spin-adapted model space consisting of the restricted Hartree–Fock (RHF) reference determinant $\\lvert \\Phi_{0} \\rangle$ and the corresponding doubly excited determinant $\\lvert \\Phi_{2} \\rangle$ in which the electron pair is promoted from the bonding to the antibonding spatial orbital. Assume the following for each isolated monomer: (i) choose the zero of energy such that $\\langle \\Phi_{0} \\rvert \\hat{H} \\lvert \\Phi_{0} \\rangle = 0$, (ii) the diagonal energy of $\\lvert \\Phi_{2} \\rangle$ is $\\Delta > 0$, and (iii) the off-diagonal coupling between the two determinants is a real constant $v \\neq 0$, so that the electronic Hamiltonian restricted to $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$ is\n$$\n\\mathbf{H}_{\\text{mono}} \\;=\\; \\begin{pmatrix}\n0 & v \\\\\nv & \\Delta\n\\end{pmatrix}.\n$$\nConfiguration Interaction with Singles and Doubles (CISD) is defined here as the variational solution of the Schrödinger equation within the span of determinants obtained by all single and double excitations from the RHF reference for the system under consideration, using the variational principle. For a two-electron monomer in the above two-determinant space, CISD coincides with full configuration interaction.\n\nNow construct the composite, noninteracting dimer $\\mathrm{H}_{2}^{(A)} + \\mathrm{H}_{2}^{(B)}$ with Hamiltonian $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$, and take the CISD model space for the dimer to be spanned by the three product determinants\n$$\n\\big\\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle,\\; \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\big\\},\n$$\nwhich omits the disconnected product $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$ because it is a quadruple excitation relative to the dimer RHF reference. Assume strict noninteraction between monomers, so there is no coupling between excitations on different monomers and no energy shifts beyond the sum of monomer contributions.\n\nUsing only the variational principle, separability of noninteracting subsystems, and linear algebra, do the following:\n- Derive the CISD ground-state energy $E_{\\text{mono}}(\\Delta, v)$ for a single monomer.\n- Derive the CISD ground-state energy $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$ for the noninteracting dimer within the three-determinant space above.\n- Define the size-consistency error as $\\delta E_{\\text{CISD}}(\\Delta, v) \\equiv E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - \\big[ E_{\\text{mono}}(\\Delta, v) + E_{\\text{mono}}(\\Delta, v) \\big]$ and obtain a closed-form analytic expression for $\\delta E_{\\text{CISD}}(\\Delta, v)$.\n\nExpress your final answer as a single simplified analytic expression in terms of $\\Delta$ and $v$. No rounding is required. Leave the answer in symbolic form; do not include units.", "solution": "The problem statement is found to be valid, as it is scientifically grounded, well-posed, and objective. It presents a standard model in theoretical chemistry for the analysis of size consistency. We now proceed with the solution.\n\nThe problem requires a three-part derivation to find the size-consistency error of a simplified Configuration Interaction with Singles and Doubles (CISD) model.\n\nFirst, we determine the ground-state energy of a single monomer, $E_{\\text{mono}}(\\Delta, v)$. The electronic Hamiltonian for a monomer, within the specified $2$-determinant basis $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$, is given as:\n$$\n\\mathbf{H}_{\\text{mono}} = \\begin{pmatrix} 0 & v \\\\ v & \\Delta \\end{pmatrix}\n$$\nThe energy eigenvalues are found by solving the secular equation $\\det(\\mathbf{H}_{\\text{mono}} - E\\mathbf{I}) = 0$, where $\\mathbf{I}$ is the identity matrix of dimension $2$.\n$$\n\\det \\begin{pmatrix} -E & v \\\\ v & \\Delta - E \\end{pmatrix} = 0\n$$\nThis leads to the characteristic polynomial:\n$$\n(-E)(\\Delta - E) - v^2 = 0\n$$\n$$\nE^2 - \\Delta E - v^2 = 0\n$$\nThis is a quadratic equation for the energy $E$. Applying the quadratic formula, $E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with coefficients $a = 1$, $b = -\\Delta$, and $c = -v^2$, we obtain the two energy eigenvalues:\n$$\nE = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^2 - 4(1)(-v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\nThe ground-state energy is the lower of these two eigenvalues. Given that $\\Delta > 0$ and $v \\neq 0$, the term $\\sqrt{\\Delta^2 + 4v^2}$ is strictly greater than $\\Delta$. Thus, the lowest energy eigenvalue corresponds to the minus sign. This energy is the CISD energy for the monomer, which in this $2$-state model is identical to the Full Configuration Interaction (FCI) energy.\n$$\nE_{\\text{mono}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n\nSecond, we determine the CISD ground-state energy for the noninteracting dimer, $E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v)$. The dimer Hamiltonian is $\\hat{H} = \\hat{H}_{A} + \\hat{H}_{B}$. The CISD model space for the dimer is spanned by the $3$ basis functions $\\{ \\lvert \\Psi_1 \\rangle, \\lvert \\Psi_2 \\rangle, \\lvert \\Psi_3 \\rangle \\} = \\{ \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle, \\lvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle \\}$. We must construct the Hamiltonian matrix $\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}}$ in this basis. The matrix elements are $H_{ij} = \\langle \\Psi_i \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Psi_j \\rangle$. Using the properties of the monomer basis states and the noninteraction assumption:\n$H_{11} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = 0 + 0 = 0$.\n$H_{22} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{2}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{0}^{B} \\rangle = \\Delta + 0 = \\Delta$.\n$H_{33} = \\langle \\Phi_{0}^{A} \\Phi_{2}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{2}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 0 + \\Delta = \\Delta$.\n$H_{12} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{2}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\hat{H}_A \\rvert \\Phi_{2}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\Phi_{0}^{B} \\rangle = v \\cdot 1 = v$.\n$H_{13} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\rvert \\Phi_{0}^{A} \\rangle \\langle \\Phi_{0}^{B} \\rvert \\hat{H}_B \\rvert \\Phi_{2}^{B} \\rangle = 1 \\cdot v = v$.\n$H_{23} = \\langle \\Phi_{2}^{A} \\Phi_{0}^{B} \\rvert \\hat{H}_A + \\hat{H}_B \\rvert \\Phi_{0}^{A} \\Phi_{2}^{B} \\rangle = 0$, as the Hamiltonians only couple states within the same monomer.\nThe resulting Hermitian matrix is:\n$$\n\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} = \\begin{pmatrix} 0 & v & v \\\\ v & \\Delta & 0 \\\\ v & 0 & \\Delta \\end{pmatrix}\n$$\nTo find the eigenvalues $E$, we solve the characteristic equation $\\det(\\mathbf{H}_{\\text{dimer}}^{\\text{CISD}} - E\\mathbf{I}) = 0$:\n$$\n\\det \\begin{pmatrix} -E & v & v \\\\ v & \\Delta - E & 0 \\\\ v & 0 & \\Delta - E \\end{pmatrix} = -E(\\Delta - E)^2 - 2v^2(\\Delta - E) = 0\n$$\n$$\n-(\\Delta - E)[E(\\Delta - E) + 2v^2] = 0\n$$\nThis equation yields two possibilities:\n1. $\\Delta - E = 0 \\implies E = \\Delta$.\n2. $E(\\Delta - E) + 2v^2 = 0 \\implies E^2 - \\Delta E - 2v^2 = 0$.\nThe second case is a quadratic equation with solutions:\n$$\nE = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 - 4(1)(-2v^2)}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\nThe three eigenvalues are thus $\\Delta$, $\\frac{1}{2}(\\Delta + \\sqrt{\\Delta^2 + 8v^2})$, and $\\frac{1}{2}(\\Delta - \\sqrt{\\Delta^2 + 8v^2})$. The ground-state energy is the lowest of these. Since $\\sqrt{\\Delta^2 + 8v^2} > \\Delta$, the lowest eigenvalue is:\n$$\nE_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\n\nThird, we compute the size-consistency error, $\\delta E_{\\text{CISD}}(\\Delta, v)$, defined as the difference between the energy of the dimer and twice the energy of the monomer.\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = E_{\\text{dimer}}^{\\text{CISD}}(\\Delta, v) - 2 E_{\\text{mono}}(\\Delta, v)\n$$\nSubstituting the expressions derived above:\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} \\right) - 2\\left( \\frac{\\Delta - \\sqrt{\\Delta^2 + 4v^2}}{2} \\right)\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2}}{2} - (\\Delta - \\sqrt{\\Delta^2 + 4v^2})\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{\\Delta - \\sqrt{\\Delta^2 + 8v^2} - 2\\Delta + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\frac{-\\Delta - \\sqrt{\\Delta^2 + 8v^2} + 2\\sqrt{\\Delta^2 + 4v^2}}{2}\n$$\nThis expression can be rearranged to a more structured form:\n$$\n\\delta E_{\\text{CISD}}(\\Delta, v) = \\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}\n$$\nThis is the final closed-form expression for the size-consistency error. Since $v \\neq 0$, this error is generally nonzero, demonstrating the failure of the truncated CISD method to be size-consistent. This failure arises from the omission of the disconnected quadruple-excitation configuration $\\lvert \\Phi_{2}^{A} \\Phi_{2}^{B} \\rangle$ from the dimer's model space.", "answer": "$$\n\\boxed{\\sqrt{\\Delta^2 + 4v^2} - \\frac{\\Delta + \\sqrt{\\Delta^2 + 8v^2}}{2}}\n$$", "id": "2805781"}, {"introduction": "This final practice illustrates the critical real-world consequences of size inconsistency when studying large systems, such as polymers and solids. You will perform a computational experiment to predict the electronic band gap of an infinite polymer chain by extrapolating from calculations on a series of smaller oligomers [@problem_id:2462334]. This exercise demonstrates how a size-inconsistent method introduces a systematic error that leads to a qualitatively incorrect prediction for the bulk material, highlighting why size extensivity is a non-negotiable property for accurate materials modeling.", "problem": "You are to write a complete, runnable program that demonstrates, in a controlled synthetic setting, how size consistency and size extensivity affect extrapolations of an intensive property (here, a band gap) along a series of oligomers. The educational goal is to connect the definitions of size consistency and size extensivity to a mathematically testable extrapolation task and to quantify the consequence of a size-inconsistent method on the inferred infinite-polymer limit of the band gap.\n\nFundamental base. Use the following standard definitions and well-tested facts as the starting point:\n- Size consistency: For two noninteracting subsystems $A$ and $B$, a size-consistent method satisfies $E(A+B)=E(A)+E(B)$ for each electronic state.\n- Size extensivity: For $N$ identical, noninteracting copies of a subsystem, an extensive quantity such as the total correlation energy scales linearly in $N$.\n- For quasi-one-dimensional conjugated oligomers of length $N$, many intensive spectral properties (such as the lowest singlet excitation energy, colloquially the band gap) approach an $N\\to\\infty$ limit with finite-size corrections that vanish as inverse powers of $N$. This motivates modeling the $N$-dependence of the true band gap as a smooth function of $1/N$.\n\nScenario. Consider a sequence of polyene oligomers with $N$ conjugated double bonds. Let the physically correct (size-consistent) band gap sequence be represented by a smooth expansion in $1/N$,\n$$\nE_{\\mathrm{g,true}}(N)=E_{\\infty}+\\frac{a}{N}+\\frac{b}{N^{2}},\n$$\nwhere $E_{\\infty}$ (in electronvolts), $a$ (in electronvolts), and $b$ (in electronvolts) are constants for a given chemical series. A size-consistent and size-extensive electronic structure method such as Coupled Cluster with Singles and Doubles (CCSD) is assumed to recover this functional dependence to leading orders for the purpose of this test.\n\nNow, introduce a generic model of size inconsistency associated with Configuration Interaction with Singles and Doubles (CISD): when the ground and excited state total energies each contain a nonadditive correlation error that does not strictly cancel between states, the predicted band gap inherits a residual bias that does not vanish with $N$. To capture this effect at the level of the property, let the CISD-predicted band gaps follow\n$$\nE_{\\mathrm{g,CISD}}(N)=E_{\\mathrm{g,true}}(N)+\\delta_{0}+\\frac{\\delta_{1}}{N},\n$$\nwhere $\\delta_{0}$ (in electronvolts) is a residual state-dependent, nonadditive offset due to size inconsistency that persists as $N\\to\\infty$, and $\\delta_{1}$ (in electronvolts) captures subleading state-dependent finite-size mismatch.\n\nYour task. For each test case below:\n1. Generate the synthetic CCSD-consistent sequence $E_{\\mathrm{g,CCSD}}(N)$ by setting $E_{\\mathrm{g,CCSD}}(N)=E_{\\mathrm{g,true}}(N)$ for the provided $N$ values.\n2. Generate the synthetic CISD-inconsistent sequence $E_{\\mathrm{g,CISD}}(N)$ using the given $\\delta_{0}$ and $\\delta_{1}$ for the same $N$ values.\n3. For each sequence separately, estimate the infinite-polymer limit by a linear least-squares fit of the form\n$$\nE_{\\mathrm{g}}(N)\\approx c_{0}+c_{1}\\left(\\frac{1}{N}\\right)+c_{2}\\left(\\frac{1}{N^{2}}\\right),\n$$\nand report the fitted intercept $c_{0}$ as the extrapolated $E_{\\infty}$ (in electronvolts).\n4. For each method (CCSD-like and CISD-like) and each test case, compute the absolute error (in electronvolts) between the estimated $E_{\\infty}$ and the true $E_{\\infty}$ provided in the test case.\n\nNumerical and unit requirements:\n- All band gaps and errors must be expressed in electronvolts (eV).\n- Your program must round every reported floating-point output to six decimal places.\n\nTest suite. Use the following parameter sets. Each test case is a tuple containing: the list of $N$ values; the true $E_{\\infty}$; the coefficients $a$ and $b$ for $E_{\\mathrm{g,true}}(N)$; and the CISD bias parameters $\\delta_{0}$ and $\\delta_{1}$. All energies are in electronvolts, and $N$ is unitless.\n- Test 1 (general happy path): $([4,6,8,12,16],\\,2.0,\\,6.0,\\,1.5,\\,0.2,\\,0.1)$\n- Test 2 (no size inconsistency): $([4,8,12,20,40],\\,1.5,\\,4.0,\\,0.5,\\,0.0,\\,0.0)$\n- Test 3 (boundary: minimal fit points): $([5,10,20],\\,3.0,\\,3.0,\\,0.0,\\,-0.15,\\,0.0)$\n- Test 4 (strong curvature and subleading CISD mismatch): $([6,7,8,12,24],\\,1.0,\\,10.0,\\,5.0,\\,0.05,\\,-0.2)$\n- Test 5 (large-$N$ dominance): $([10,20,40,80,160],\\,0.8,\\,2.4,\\,0.4,\\,0.3,\\,0.0)$\n\nOutput specification:\n- For each test case, append four floats to the result list in this order: the CCSD-like extrapolated $E_{\\infty}$ estimate, the CISD-like extrapolated $E_{\\infty}$ estimate, the absolute error of the CCSD-like estimate, and the absolute error of the CISD-like estimate. All values must be in electronvolts, each rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For example, the output format must look like\n\"[x11,x12,x13,x14,x21,x22,x23,x24,...]\"\nwith no extra whitespace or text.\n\nYour implementation must be self-contained, require no user input, and adhere to the specified execution environment.", "solution": "The problem presented is a valid exercise in computational science. It is scientifically grounded, well-posed, and objective. It correctly uses simplified but physically meaningful models to construct a numerical experiment demonstrating a fundamental concept in quantum chemistry: the critical importance of size consistency for obtaining correct properties of large systems via extrapolation from smaller ones. We shall now proceed with the solution.\n\nThe central task is to quantify the error introduced in the extrapolation of an intensive property, the electronic band gap $E_g$, to the infinite polymer limit ($N \\to \\infty$) when using a size-inconsistent theoretical method. We are given models for the band gap of an oligomer of length $N$ as computed by a \"true\" or size-consistent method (like CCSD) and a size-inconsistent method (like CISD).\n\nThe true band gap is given by the functional form:\n$$\nE_{\\mathrm{g,true}}(N) = E_{\\infty} + \\frac{a}{N} + \\frac{b}{N^2}\n$$\nHere, $E_{\\infty}$ is the true band gap of the infinite polymer, and the terms with coefficients $a$ and $b$ represent finite-size corrections that vanish as $N$ increases. This form is physically motivated for quasi-one-dimensional systems. For the purpose of this problem, a size-consistent method such as CCSD is assumed to reproduce this behavior perfectly. Thus, we set:\n$$\nE_{\\mathrm{g,CCSD}}(N) = E_{\\mathrm{g,true}}(N)\n$$\n\nA size-inconsistent method like CISD introduces an error that does not scale correctly with system size. This is modeled by adding a bias term to the true energy:\n$$\nE_{\\mathrm{g,CISD}}(N) = E_{\\mathrm{g,true}}(N) + \\delta_{0} + \\frac{\\delta_{1}}{N}\n$$\nThe term $\\delta_0$ represents a non-additive, state-dependent error that persists even for infinitely large systems ($N \\to \\infty$). This is the mathematical signature of size inconsistency impacting an intensive property. The term $\\delta_1/N$ is a subleading size-dependent error. Substituting the expression for $E_{\\mathrm{g,true}}(N)$, we can rewrite the CISD model as:\n$$\nE_{\\mathrm{g,CISD}}(N) = (E_{\\infty} + \\delta_0) + \\frac{a + \\delta_1}{N} + \\frac{b}{N^2}\n$$\n\nThe procedure to estimate the infinite-limit band gap, $E_{\\infty}$, is to perform a linear least-squares fit on a set of calculated data points $(N_i, E_{\\mathrm{g}}(N_i))$ using the model:\n$$\nE_{\\mathrm{g}}(N) \\approx c_0 + c_1 \\left(\\frac{1}{N}\\right) + c_2 \\left(\\frac{1}{N^2}\\right)\n$$\nThe extrapolated band gap is the fitted intercept, $c_0$. This is a standard multivariable linear regression problem. We seek to find the coefficients $\\mathbf{c} = [c_0, c_1, c_2]^T$ that minimize the sum of squared residuals for the system of equations $\\mathbf{A}\\mathbf{c} \\approx \\mathbf{y}$, where:\n- $\\mathbf{y}$ is the vector of calculated band gaps, $[E_{\\mathrm{g}}(N_1), E_{\\mathrm{g}}(N_2), \\dots]^T$.\n- $\\mathbf{A}$ is the design matrix, where the $i$-th row is $[1, 1/N_i, 1/N_i^2]$.\n\nThe least-squares solution for the coefficient vector $\\mathbf{c}$ is given by $\\mathbf{c} = (\\mathbf{A}^T\\mathbf{A})^{-1}\\mathbf{A}^T\\mathbf{y}$. We will compute this using the `numpy.linalg.lstsq` function.\n\nFor the size-consistent CCSD data, the generated points $(1/N_i, E_{\\mathrm{g,CCSD}}(N_i))$ lie exactly on the curve defined by the fitting model. Consequently, the least-squares fit will be perfect (within machine precision), yielding an extrapolated intercept $c_0 = E_{\\infty}$. The resulting error, $|c_0 - E_{\\infty}|$, should be effectively zero.\n\nFor the size-inconsistent CISD data, the generated points lie on a curve defined by $(E_{\\infty} + \\delta_0) + (a + \\delta_1)/N + b/N^2$. When we fit this data to the model $c_0 + c_1/N + c_2/N^2$, the least-squares procedure will find an intercept $c_0 \\approx E_{\\infty} + \\delta_0$. The extrapolated band gap is therefore systematically incorrect, and the error $|c_0 - E_{\\infty}|$ will be approximately $|\\delta_0|$. This directly demonstrates how size inconsistency prevents accurate extrapolation to the macroscopic limit.\n\nThe algorithm proceeds as follows for each test case:\n$1$. For a given set of $N$ values and parameters ($E_{\\infty}, a, b, \\delta_0, \\delta_1$), construct the design matrix $\\mathbf{A}$ with columns for $N^0$, $N^{-1}$, and $N^{-2}$.\n$2$. Generate the vector of \"data\" $\\mathbf{y}_{\\mathrm{CCSD}}$ using the $E_{\\mathrm{g,CCSD}}(N)$ formula.\n$3$. Solve $\\mathbf{A}\\mathbf{c}_{\\mathrm{CCSD}} \\approx \\mathbf{y}_{\\mathrm{CCSD}}$ for $\\mathbf{c}_{\\mathrm{CCSD}}$ using least squares. The first element is the extrapolated gap, $c_{0,\\mathrm{CCSD}}$.\n$4$. Calculate the absolute error, $|c_{0,\\mathrm{CCSD}} - E_{\\infty}|$.\n$5$. Generate the vector of \"data\" $\\mathbf{y}_{\\mathrm{CISD}}$ using the $E_{\\mathrm{g,CISD}}(N)$ formula.\n$6$. Solve $\\mathbf{A}\\mathbf{c}_{\\mathrm{CISD}} \\approx \\mathbf{y}_{\\mathrm{CISD}}$ for $\\mathbf{c}_{\\mathrm{CISD}}$. The first element is the extrapolated gap, $c_{0,\\mathrm{CISD}}$.\n$7$. Calculate the absolute error, $|c_{0,\\mathrm{CISD}} - E_{\\infty}|$.\n$8$. Collect and report these four values, rounded to the specified precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Demonstrates the effect of size consistency on extrapolating oligomer\n    properties by simulating band gap calculations and performing a\n    least-squares fit to the infinite-polymer limit.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (list of N values, E_inf_true, a, b, delta_0, delta_1)\n    test_cases = [\n        # Test 1 (general happy path)\n        ([4, 6, 8, 12, 16], 2.0, 6.0, 1.5, 0.2, 0.1),\n        # Test 2 (no size inconsistency)\n        ([4, 8, 12, 20, 40], 1.5, 4.0, 0.5, 0.0, 0.0),\n        # Test 3 (boundary: minimal fit points)\n        ([5, 10, 20], 3.0, 3.0, 0.0, -0.15, 0.0),\n        # Test 4 (strong curvature and subleading CISD mismatch)\n        ([6, 7, 8, 12, 24], 1.0, 10.0, 5.0, 0.05, -0.2),\n        # Test 5 (large-N dominance)\n        ([10, 20, 40, 80, 160], 0.8, 2.4, 0.4, 0.3, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        Ns_list, E_inf_true, a, b, delta_0, delta_1 = case\n        \n        # Convert list of N values to a numpy array for vectorization\n        Ns = np.array(Ns_list, dtype=float)\n        \n        # Prepare the variables for the linear least-squares fit\n        inv_N = 1.0 / Ns\n        inv_N2 = inv_N**2\n        \n        # Construct the design matrix A for the model E_g = c0 + c1*(1/N) + c2*(1/N^2)\n        # The columns are N^0, N^-1, N^-2\n        A = np.vstack([np.ones_like(Ns), inv_N, inv_N2]).T\n        \n        # --- 1. CCSD-like (size-consistent) method ---\n        \n        # Generate the synthetic band gap data\n        # E_g_ccsd is identical to E_g_true in this model\n        E_g_ccsd = E_inf_true + a * inv_N + b * inv_N2\n        \n        # Perform the linear least-squares fit: A * c = E_g_ccsd\n        # lstsq returns the solution vector (c), residuals, rank, and singular values\n        c_ccsd, _, _, _ = np.linalg.lstsq(A, E_g_ccsd, rcond=None)\n        \n        # The extrapolated infinite-polymer band gap is the intercept c0\n        extrapolated_E_inf_ccsd = c_ccsd[0]\n        \n        # Calculate the absolute error\n        error_ccsd = np.abs(extrapolated_E_inf_ccsd - E_inf_true)\n        \n        # --- 2. CISD-like (size-inconsistent) method ---\n        \n        # Generate the synthetic band gap data with the inconsistency bias\n        E_g_cisd = E_g_ccsd + delta_0 + delta_1 * inv_N\n        \n        # Perform the linear least-squares fit for the CISD data\n        c_cisd, _, _, _ = np.linalg.lstsq(A, E_g_cisd, rcond=None)\n        \n        # The extrapolated infinite-polymer band gap is the intercept c0\n        extrapolated_E_inf_cisd = c_cisd[0]\n        \n        # Calculate the absolute error\n        error_cisd = np.abs(extrapolated_E_inf_cisd - E_inf_true)\n        \n        # --- 3. Store results ---\n        \n        # Append the four required values for this test case\n        results.extend([\n            extrapolated_E_inf_ccsd,\n            extrapolated_E_inf_cisd,\n            error_ccsd,\n            error_cisd\n        ])\n\n    # Final print statement in the exact required format.\n    # Each float is rounded to six decimal places.\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2462334"}]}