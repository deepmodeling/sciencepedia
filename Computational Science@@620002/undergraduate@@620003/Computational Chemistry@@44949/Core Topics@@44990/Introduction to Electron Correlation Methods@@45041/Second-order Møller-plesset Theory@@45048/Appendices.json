{"hands_on_practices": [{"introduction": "This problem goes to the heart of a Second-order Møller-Plesset (MP2) calculation. You will implement the core formula for the MP2 correlation energy, building it from its fundamental components: orbital energies and two-electron integrals. This exercise [@problem_id:2461929] also introduces the crucial concept of basis set convergence by having you perform a series of calculations and then extrapolate the results to the complete basis set (CBS) limit, a standard procedure for obtaining highly accurate theoretical energies.", "problem": "Write a complete program that computes the second-order Møller-Plesset theory (MP2) correlation energy and performs a complete basis set (CBS) extrapolation for atomic Argon using three correlation-consistent basis sets. Use the following definitions and data.\n\nLet the system be described by canonical Hartree-Fock (HF) spatial orbitals with orbital energies $\\{\\varepsilon_p\\}$ and antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$ over spatial orbitals $i,j$ (occupied) and $a,b$ (virtual). The MP2 correlation energy in terms of these quantities is\n$$\nE_{\\mathrm{MP2}} \\;=\\; \\sum_{i<j}^{\\mathrm{occ}} \\sum_{a<b}^{\\mathrm{vir}} \\frac{\\left(\\langle ij \\Vert ab \\rangle\\right)^2}{\\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b}\\,,\n$$\nwhere all quantities are in Hartree atomic units.\n\nFor the basis-set extrapolation, assume the asymptotic model for the correlation energy\n$$\nE_{\\mathrm{c}}(X) \\;=\\; E_{\\mathrm{c}}^{\\mathrm{CBS}} \\;+\\; A \\, X^{-3}\\,,\n$$\nwith cardinal numbers $X \\in \\{2,3,4\\}$ corresponding to the correlation-consistent polarized valence X-zeta (cc-pVXZ) basis sets: cc-pVDZ ($X=2$), cc-pVTZ ($X=3$), and cc-pVQZ ($X=4$). Estimate $E_{\\mathrm{c}}^{\\mathrm{CBS}}$ by a linear least-squares fit of $E_{\\mathrm{c}}(X)$ against $X^{-3}$ using the three points $X \\in \\{2,3,4\\}$.\n\nAll energies must be expressed in Hartree, $E_h$, and all final numerical results must be rounded to nine decimal places.\n\nUse the following data to define three test cases. In all cases, occupied orbital energies are denoted by $\\varepsilon_i$ and virtual orbital energies by $\\varepsilon_a$. Indices for occupied orbitals are $i \\in \\{0,1,2\\}$ with $\\varepsilon_0 = \\varepsilon_{3p_x}$, $\\varepsilon_1 = \\varepsilon_{3p_y}$, $\\varepsilon_2 = \\varepsilon_{3s}$, and indices for virtual orbitals are $a \\in \\{0,1,2\\}$ with $\\varepsilon_0 = \\varepsilon_{4s}$, $\\varepsilon_1 = \\varepsilon_{3d}$, $\\varepsilon_2 = \\varepsilon_{4p}$. The MP2 summation runs over all unique pairs $i<j$ and $a<b$.\n\nTest Case $\\mathbf{1}$ (Argon, realistic valence subset):\n- Orbital energies (Hartree):\n  - Occupied: $\\varepsilon_{3p_x} = -0.5$, $\\varepsilon_{3p_y} = -0.5$, $\\varepsilon_{3s} = -0.9$.\n  - Virtual: $\\varepsilon_{4s} = 0.1$, $\\varepsilon_{3d} = 0.2$, $\\varepsilon_{4p} = 0.3$.\n- Nonzero antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$ (Hartree) for the three basis sets $\\mathrm{X} \\in \\{\\mathrm{D},\\mathrm{T},\\mathrm{Q}\\}$ corresponding to $X \\in \\{2,3,4\\}$:\n  - For $(i,j) = (0,1)$ with $(a,b)$ as listed:\n    - $(a,b)=(0,1)$: $\\{0.30,\\,0.33,\\,0.35\\}$ for $\\{\\mathrm{D},\\mathrm{T},\\mathrm{Q}\\}$.\n    - $(a,b)=(0,2)$: $\\{0.26,\\,0.29,\\,0.31\\}$.\n    - $(a,b)=(1,2)$: $\\{0.24,\\,0.27,\\,0.29\\}$.\n  - For $(i,j) = (0,2)$:\n    - $(a,b)=(0,1)$: $\\{0.28,\\,0.31,\\,0.33\\}$.\n    - $(a,b)=(0,2)$: $\\{0.25,\\,0.28,\\,0.30\\}$.\n    - $(a,b)=(1,2)$: $\\{0.22,\\,0.25,\\,0.27\\}$.\n  - For $(i,j) = (1,2)$:\n    - $(a,b)=(0,1)$: $\\{0.27,\\,0.30,\\,0.32\\}$.\n    - $(a,b)=(0,2)$: $\\{0.24,\\,0.27,\\,0.29\\}$.\n    - $(a,b)=(1,2)$: $\\{0.21,\\,0.24,\\,0.26\\}$.\n\nTest Case $\\mathbf{2}$ (Sanity boundary: zero correlation):\n- Use the same orbital energies as in Test Case $\\mathbf{1}$.\n- For each of $\\mathrm{D},\\mathrm{T},\\mathrm{Q}$, set all $\\langle ij \\Vert ab \\rangle = 0$.\n\nTest Case $\\mathbf{3}$ (Small-magnitude edge case):\n- Use the same orbital energies as in Test Case $\\mathbf{1}$.\n- Set all nonzero $\\langle ij \\Vert ab \\rangle$ to a uniform small value for each basis:\n  - For $\\mathrm{D}$: $\\langle ij \\Vert ab \\rangle = 1.0 \\times 10^{-3}$ for all $(i<j,a<b)$.\n  - For $\\mathrm{T}$: $\\langle ij \\Vert ab \\rangle = 1.1 \\times 10^{-3}$ for all $(i<j,a<b)$.\n  - For $\\mathrm{Q}$: $\\langle ij \\Vert ab \\rangle = 1.2 \\times 10^{-3}$ for all $(i<j,a<b)$.\n\nYour program must, for each test case, compute the MP2 correlation energies $E_{\\mathrm{MP2}}$ for cc-pVDZ ($X=\\mathrm{D}$), cc-pVTZ ($X=\\mathrm{T}$), and cc-pVQZ ($X=\\mathrm{Q}$), and then compute the CBS limit estimate $E_{\\mathrm{c}}^{\\mathrm{CBS}}$ (all in Hartree). Round each reported value to nine decimal places. The final output must be a single line containing a list of three lists, one per test case, each inner list ordered as $[E_{\\mathrm{D}},E_{\\mathrm{T}},E_{\\mathrm{Q}},E_{\\mathrm{CBS}}]$; for example, $[[x_{11},x_{12},x_{13},x_{14}],[x_{21},x_{22},x_{23},x_{24}],[x_{31},x_{32},x_{33},x_{34}]]$ with all $x_{ij}$ as decimal floats in Hartree rounded to nine decimals.", "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded in the principles of quantum chemistry, specifically second-order Møller-Plesset perturbation theory (MP2) and complete basis set (CBS) extrapolation. The problem is well-posed, providing all necessary mathematical definitions, data, and constraints required for a unique and determinable solution. The language is objective and the structure is logical. No contradictions, ambiguities, or factual inaccuracies are present. We may therefore proceed with the solution.\n\nThe solution is partitioned into two main computational steps for each test case: first, the calculation of the MP2 correlation energies for a series of basis sets, and second, the extrapolation of these energies to the complete basis set limit.\n\n**Part 1: Calculation of the MP2 Correlation Energy**\n\nThe second-order Møller-Plesset (MP2) correlation energy, $E_{\\mathrm{MP2}}$, is given by the formula:\n$$\nE_{\\mathrm{MP2}} = \\sum_{i<j}^{\\mathrm{occ}} \\sum_{a<b}^{\\mathrm{vir}} \\frac{\\left(\\langle ij \\Vert ab \\rangle\\right)^2}{\\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b}\n$$\nHere, indices $i, j$ span the set of occupied canonical Hartree-Fock spatial orbitals, and indices $a, b$ span the set of virtual orbitals. The quantities $\\varepsilon_p$ represent the orbital energies, and $\\langle ij \\Vert ab \\rangle$ are the antisymmetrized two-electron integrals over spatial orbitals. All quantities are in Hartree atomic units.\n\nThe problem defines the sets of occupied and virtual orbital indices as $i,j \\in \\{0,1,2\\}$ and $a,b \\in \\{0,1,2\\}$, respectively. The summations are over unique pairs, meaning $i<j$ and $a<b$. The unique pairs of indices are $(0,1)$, $(0,2)$, and $(1,2)$. This results in a total of $3 \\times 3 = 9$ terms in the double summation for each basis set.\n\nThe orbital energies are provided as:\n- Occupied: $\\varepsilon_0 = -0.5 \\, E_h$, $\\varepsilon_1 = -0.5 \\, E_h$, $\\varepsilon_2 = -0.9 \\, E_h$.\n- Virtual: $\\varepsilon_{a=0} = 0.1 \\, E_h$, $\\varepsilon_{a=1} = 0.2 \\, E_h$, $\\varepsilon_{a=2} = 0.3 \\, E_h$.\n\nThe energy denominators, $D_{ijab} = \\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b$, are constant across all test cases and basis sets. We compute these $9$ distinct denominator values:\n- For $(i,j)=(0,1)$, $\\varepsilon_i + \\varepsilon_j = -1.0 \\, E_h$.\n  - For $(a,b)=(0,1)$, $\\varepsilon_a + \\varepsilon_b = 0.3 \\, E_h \\implies D_{0101} = -1.3 \\, E_h$.\n  - For $(a,b)=(0,2)$, $\\varepsilon_a + \\varepsilon_b = 0.4 \\, E_h \\implies D_{0102} = -1.4 \\, E_h$.\n  - For $(a,b)=(1,2)$, $\\varepsilon_a + \\varepsilon_b = 0.5 \\, E_h \\implies D_{0112} = -1.5 \\, E_h$.\n- For $(i,j)=(0,2)$, $\\varepsilon_i + \\varepsilon_j = -1.4 \\, E_h$.\n  - For $(a,b)=(0,1)$, $\\varepsilon_a + \\varepsilon_b = 0.3 \\, E_h \\implies D_{0201} = -1.7 \\, E_h$.\n  - For $(a,b)=(0,2)$, $\\varepsilon_a + \\varepsilon_b = 0.4 \\, E_h \\implies D_{0202} = -1.8 \\, E_h$.\n  - For $(a,b)=(1,2)$, $\\varepsilon_a + \\varepsilon_b = 0.5 \\, E_h \\implies D_{0212} = -1.9 \\, E_h$.\n- For $(i,j)=(1,2)$, $\\varepsilon_i + \\varepsilon_j = -1.4 \\, E_h$.\n  - For $(a,b)=(0,1)$, $\\varepsilon_a + \\varepsilon_b = 0.3 \\, E_h \\implies D_{1201} = -1.7 \\, E_h$.\n  - For $(a,b)=(0,2)$, $\\varepsilon_a + \\varepsilon_b = 0.4 \\, E_h \\implies D_{1202} = -1.8 \\, E_h$.\n  - For $(a,b)=(1,2)$, $\\varepsilon_a + \\varepsilon_b = 0.5 \\, E_h \\implies D_{1212} = -1.9 \\, E_h$.\n\nFor each basis set specified ($\\mathrm{D}$ for cc-pVDZ, $\\mathrm{T}$ for cc-pVTZ, $\\mathrm{Q}$ for cc-pVQZ), we are given a corresponding set of integral values $\\langle ij \\Vert ab \\rangle$. The MP2 energy for that basis, e.g., $E_{\\mathrm{D}}$, is computed by summing the $9$ terms, where each term uses the appropriate integral value from the provided data for basis $\\mathrm{D}$ and the corresponding pre-calculated denominator. This procedure is repeated for bases $\\mathrm{T}$ and $\\mathrm{Q}$ to obtain $E_{\\mathrm{T}}$ and $E_{\\mathrm{Q}}$.\n\n**Part 2: Complete Basis Set (CBS) Extrapolation**\n\nThe problem specifies an asymptotic model for the correlation energy $E_{\\mathrm{c}}(X)$ as a function of the basis set cardinal number $X$:\n$$\nE_{\\mathrm{c}}(X) = E_{\\mathrm{c}}^{\\mathrm{CBS}} + A \\, X^{-3}\n$$\nHere, $E_{\\mathrm{c}}(X)$ is the correlation energy computed with the cc-pVXZ basis set (in our case, the MP2 energies $E_{\\mathrm{D}}$, $E_{\\mathrm{T}}$, and $E_{\\mathrm{Q}}$), $E_{\\mathrm{c}}^{\\mathrm{CBS}}$ is the desired extrapolated energy at the complete basis set limit, and $A$ is a fitting parameter. The cardinal numbers are $X=2$ for cc-pVDZ, $X=3$ for cc-pVTZ, and $X=4$ for cc-pVQZ.\n\nThis model describes a linear relationship. If we define a dependent variable $y_X = E_{\\mathrm{c}}(X)$ and an independent variable $z_X = X^{-3}$, the equation becomes $y_X = A z_X + E_{\\mathrm{c}}^{\\mathrm{CBS}}$. The value $E_{\\mathrm{c}}^{\\mathrm{CBS}}$ is the y-intercept of a line plotting $E_{\\mathrm{c}}(X)$ against $X^{-3}$.\n\nFor each test case, we have three data points $(z_X, y_X)$:\n- $(z_2, y_2) = (2^{-3}, E_{\\mathrm{D}}) = (0.125, E_{\\mathrm{D}})$\n- $(z_3, y_3) = (3^{-3}, E_{\\mathrm{T}}) \\approx (0.037037..., E_{\\mathrm{T}})$\n- $(z_4, y_4) = (4^{-3}, E_{\\mathrm{Q}}) = (0.015625, E_{\\mathrm{Q}})$\n\nTo find $E_{\\mathrm{c}}^{\\mathrm{CBS}}$, we perform a linear least-squares regression on these three points. The intercept of the resulting regression line provides the estimate for $E_{\\mathrm{c}}^{\\mathrm{CBS}}$. This is a standard statistical procedure that can be implemented using numerical libraries such as `scipy.stats.linregress`.\n\n**Algorithm Summary**\n\nThe overall algorithm proceeds as follows for each test case:\n$1$. Define the constant orbital energy denominators $D_{ijab}$.\n$2$. For each basis set ($\\mathrm{D}, \\mathrm{T}, \\mathrm{Q}$):\n    a. Retrieve the specified set of two-electron integrals $\\langle ij \\Vert ab \\rangle$.\n    b. Calculate the MP2 energy ($E_{\\mathrm{D}}$, $E_{\\mathrm{T}}$, or $E_{\\mathrm{Q}}$) by summing the $9$ terms $\\left(\\langle ij \\Vert ab \\rangle\\right)^2 / D_{ijab}$.\n$3$. Construct the set of independent variables $z = [2^{-3}, 3^{-3}, 4^{-3}]$ and dependent variables $y=[E_{\\mathrm{D}}, E_{\\mathrm{T}}, E_{\\mathrm{Q}}]$.\n$4$. Perform a linear regression on the $(z, y)$ data points to find the intercept, which is $E_{\\mathrm{c}}^{\\mathrm{CBS}}$.\n$5$. Collect and round the four values ($E_{\\mathrm{D}}, E_{\\mathrm{T}}, E_{\\mathrm{Q}}, E_{\\mathrm{c}}^{\\mathrm{CBS}}$) to nine decimal places as required.\nThe implementation will encapsulate this logic, processing all three test cases and formatting the final output as a single list of lists.", "answer": "```python\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Computes MP2 correlation energies for three basis sets and extrapolates\n    to the Complete Basis Set (CBS) limit for three test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1: Argon, realistic valence subset\n        {\n            \"name\": \"Argon, realistic valence subset\",\n            \"integrals_D\": {\n                (0, 1): {(0, 1): 0.30, (0, 2): 0.26, (1, 2): 0.24},\n                (0, 2): {(0, 1): 0.28, (0, 2): 0.25, (1, 2): 0.22},\n                (1, 2): {(0, 1): 0.27, (0, 2): 0.24, (1, 2): 0.21},\n            },\n            \"integrals_T\": {\n                (0, 1): {(0, 1): 0.33, (0, 2): 0.29, (1, 2): 0.27},\n                (0, 2): {(0, 1): 0.31, (0, 2): 0.28, (1, 2): 0.25},\n                (1, 2): {(0, 1): 0.30, (0, 2): 0.27, (1, 2): 0.24},\n            },\n            \"integrals_Q\": {\n                (0, 1): {(0, 1): 0.35, (0, 2): 0.31, (1, 2): 0.29},\n                (0, 2): {(0, 1): 0.33, (0, 2): 0.30, (1, 2): 0.27},\n                (1, 2): {(0, 1): 0.32, (0, 2): 0.29, (1, 2): 0.26},\n            }\n        },\n        # Test Case 2: Sanity boundary: zero correlation\n        {\n            \"name\": \"Sanity boundary: zero correlation\",\n            \"integrals_D\": {\n                (0, 1): {(0, 1): 0.0, (0, 2): 0.0, (1, 2): 0.0},\n                (0, 2): {(0, 1): 0.0, (0, 2): 0.0, (1, 2): 0.0},\n                (1, 2): {(0, 1): 0.0, (0, 2): 0.0, (1, 2): 0.0},\n            },\n            \"integrals_T\": {\n                (0, 1): {(0, 1): 0.0, (0, 2): 0.0, (1, 2): 0.0},\n                (0, 2): {(0, 1): 0.0, (0, 2): 0.0, (1, 2): 0.0},\n                (1, 2): {(0, 1): 0.0, (0, 2): 0.0, (1, 2): 0.0},\n            },\n            \"integrals_Q\": {\n                (0, 1): {(0, 1): 0.0, (0, 2): 0.0, (1, 2): 0.0},\n                (0, 2): {(0, 1): 0.0, (0, 2): 0.0, (1, 2): 0.0},\n                (1, 2): {(0, 1): 0.0, (0, 2): 0.0, (1, 2): 0.0},\n            }\n        },\n        # Test Case 3: Small-magnitude edge case\n        {\n            \"name\": \"Small-magnitude edge case\",\n            \"integrals_D\": {\n                (0, 1): {(0, 1): 1e-3, (0, 2): 1e-3, (1, 2): 1e-3},\n                (0, 2): {(0, 1): 1e-3, (0, 2): 1e-3, (1, 2): 1e-3},\n                (1, 2): {(0, 1): 1e-3, (0, 2): 1e-3, (1, 2): 1e-3},\n            },\n            \"integrals_T\": {\n                (0, 1): {(0, 1): 1.1e-3, (0, 2): 1.1e-3, (1, 2): 1.1e-3},\n                (0, 2): {(0, 1): 1.1e-3, (0, 2): 1.1e-3, (1, 2): 1.1e-3},\n                (1, 2): {(0, 1): 1.1e-3, (0, 2): 1.1e-3, (1, 2): 1.1e-3},\n            },\n            \"integrals_Q\": {\n                (0, 1): {(0, 1): 1.2e-3, (0, 2): 1.2e-3, (1, 2): 1.2e-3},\n                (0, 2): {(0, 1): 1.2e-3, (0, 2): 1.2e-3, (1, 2): 1.2e-3},\n                (1, 2): {(0, 1): 1.2e-3, (0, 2): 1.2e-3, (1, 2): 1.2e-3},\n            }\n        }\n    ]\n\n    # Constants and shared data\n    occ_energies = {-0.5, -0.5, -0.9}\n    virt_energies = {0.1, 0.2, 0.3}\n    \n    eps_occ = {-0.5, -0.5, -0.9}\n    eps_i_map = {0: -0.5, 1: -0.5, 2: -0.9}\n    eps_a_map = {0: 0.1, 1: 0.2, 2: 0.3}\n\n    occ_pairs = [(0, 1), (0, 2), (1, 2)]\n    virt_pairs = [(0, 1), (0, 2), (1, 2)]\n\n    denominators = {}\n    for i, j in occ_pairs:\n        for a, b in virt_pairs:\n            denominators[(i, j, a, b)] = eps_i_map[i] + eps_i_map[j] - eps_a_map[a] - eps_a_map[b]\n\n    def calculate_mp2_energy(integrals):\n        energy = 0.0\n        for i, j in occ_pairs:\n            for a, b in virt_pairs:\n                integral_val = integrals[(i, j)][(a, b)]\n                denominator = denominators[(i, j, a, b)]\n                if denominator != 0:\n                    energy += integral_val**2 / denominator\n        return energy\n\n    all_results = []\n    for case in test_cases:\n        E_D = calculate_mp2_energy(case[\"integrals_D\"])\n        E_T = calculate_mp2_energy(case[\"integrals_T\"])\n        E_Q = calculate_mp2_energy(case[\"integrals_Q\"])\n\n        # CBS Extrapolation\n        X_vals = np.array([2, 3, 4])\n        energies = np.array([E_D, E_T, E_Q])\n        x_inv_cubed = 1 / (X_vals**3)\n\n        # Handle the trivial case to avoid polyfit/linregress warnings\n        if np.all(energies == 0):\n            E_CBS = 0.0\n        else:\n            # Linear regression: E(X) = A * X**(-3) + E_CBS\n            # slope is A, intercept is E_CBS\n            regression_result = linregress(x_inv_cubed, energies)\n            E_CBS = regression_result.intercept\n\n        case_results = [\n            round(E_D, 9),\n            round(E_T, 9),\n            round(E_Q, 9),\n            round(E_CBS, 9)\n        ]\n        all_results.append([f\"{res:.9f}\" for res in case_results])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(['[' + ','.join(res) + ']' for res in all_results])}]\")\n\nsolve()\n```", "id": "2461929"}, {"introduction": "After calculating the correlation energy, a natural question is: what is its physical effect? This practice moves beyond abstract energy values to the tangible concept of electron density. By modeling the change in electron density upon including correlation, $\\Delta \\rho(\\mathbf{r}) = \\rho_{\\mathrm{MP2}}(\\mathbf{r}) - \\rho_{\\mathrm{HF}}(\\mathbf{r})$, you will visualize how MP2 theory corrects the mean-field Hartree-Fock picture and redistributes charge to better describe phenomena like dispersion forces [@problem_id:2461938]. This is key to developing a physical intuition for what \"electron correlation\" really means.", "problem": "You are asked to implement a complete program that constructs a minimal, self-contained model of the electron density difference between second-order Møller-Plesset perturbation theory (MP2) and Hartree–Fock (HF) for a water dimer, and to compute quantitative diagnostics of this difference. The goal is to represent how electron correlation affects the charge distribution by evaluating the field $\\Delta \\rho(\\mathbf{r}) = \\rho_{\\mathrm{MP2}}(\\mathbf{r}) - \\rho_{\\mathrm{HF}}(\\mathbf{r})$ on a three-dimensional domain and at selected points.\n\nModel and definitions:\n1) Consider a water dimer consisting of two water monomers, denoted A and B. Use atomic units of length (bohr) for all position coordinates. Let the covalent O–H bond length be $b = 1.809$ and the H–O–H bond angle be $\\theta_{\\mathrm{HOH}} = 104.5$ degrees. Place the atoms as follows:\n- Monomer A:\n  - Oxygen $\\mathrm{O_A}$ at $\\mathbf{R}_{\\mathrm{O_A}} = (0,0,0)$.\n  - Hydrogens $\\mathrm{H_{A1}}$ and $\\mathrm{H_{A2}}$ in the $xy$-plane with\n    $\\mathbf{R}_{\\mathrm{H_{A1}}} = \\left(b \\cos\\left(\\frac{\\theta_{\\mathrm{HOH}}}{2}\\right), b \\sin\\left(\\frac{\\theta_{\\mathrm{HOH}}}{2}\\right), 0\\right)$ and\n    $\\mathbf{R}_{\\mathrm{H_{A2}}} = \\left(b \\cos\\left(\\frac{\\theta_{\\mathrm{HOH}}}{2}\\right), -b \\sin\\left(\\frac{\\theta_{\\mathrm{HOH}}}{2}\\right), 0\\right)$.\n- Monomer B:\n  - Oxygen $\\mathrm{O_B}$ at $\\mathbf{R}_{\\mathrm{O_B}} = (0,0,5.5)$.\n  - One hydrogen $\\mathrm{H_{B1}}$ along the negative $z$-axis from $\\mathrm{O_B}$ at $\\mathbf{R}_{\\mathrm{H_{B1}}} = (0,0,5.5 - b)$.\n  - The second hydrogen $\\mathrm{H_{B2}}$ located in the $xz$-plane at\n    $\\mathbf{R}_{\\mathrm{H_{B2}}} = \\mathbf{R}_{\\mathrm{O_B}} + b \\left( \\sin(\\varphi), 0, \\cos(\\varphi) \\right)$, where $\\varphi$ is chosen in degrees to satisfy an H–O–H angle of $104.5$ degrees at $\\mathrm{O_B}$, that is $\\varphi = 75.5$.\n\n2) Represent the electron densities $\\rho_{\\mathrm{HF}}(\\mathbf{r})$ and $\\rho_{\\mathrm{MP2}}(\\mathbf{r})$ as sums of normalized, spherically symmetric, atom-centered Gaussian components. For any atom-centered Gaussian component with exponent $\\alpha$ at center $\\mathbf{R}$, define the normalized basis density\n$$\ng_{\\alpha}(\\mathbf{r}-\\mathbf{R}) = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp\\!\\left(-\\alpha \\lVert \\mathbf{r}-\\mathbf{R} \\rVert^2\\right),\n$$\nwhich integrates to $1$ over all space. For each atom, the electron density is a weighted sum of such components, where each weight is a nonnegative number of electrons assigned to that component.\n\n3) Use the following exponents and electron weights for each atom type and each method:\n- Oxygen components: two exponents $\\alpha_{\\mathrm{O,core}} = 8.0$ and $\\alpha_{\\mathrm{O,val}} = 1.5$.\n  - HF weights on each oxygen: $c^{\\mathrm{HF}}_{\\mathrm{O,core}} = 2.0$, $c^{\\mathrm{HF}}_{\\mathrm{O,val}} = 6.0$.\n  - MP2 weights on each oxygen: $c^{\\mathrm{MP2}}_{\\mathrm{O,core}} = 1.95$, $c^{\\mathrm{MP2}}_{\\mathrm{O,val}} = 6.03$.\n- Hydrogen components: one exponent $\\alpha_{\\mathrm{H,val}} = 0.8$.\n  - HF weight on each hydrogen: $c^{\\mathrm{HF}}_{\\mathrm{H,val}} = 1.0$.\n  - MP2 weight on each hydrogen: $c^{\\mathrm{MP2}}_{\\mathrm{H,val}} = 1.01$.\n\nWith these assignments, the total integrated electrons for the dimer are conserved between Hartree–Fock and second-order Møller–Plesset perturbation theory, that is $\\int \\rho_{\\mathrm{HF}}(\\mathbf{r}) \\, d^3\\mathbf{r} = \\int \\rho_{\\mathrm{MP2}}(\\mathbf{r}) \\, d^3\\mathbf{r} = 20.0$.\n\n4) Using the model above, define the electron density for method $M \\in \\{\\mathrm{HF}, \\mathrm{MP2}\\}$ by\n$$\n\\rho_{M}(\\mathbf{r}) = \\sum_{\\text{atoms } A} \\sum_{k} c^{M}_{A,k} \\, g_{\\alpha_{A,k}}(\\mathbf{r}-\\mathbf{R}_A),\n$$\nand the difference field $\\Delta \\rho(\\mathbf{r}) = \\rho_{\\mathrm{MP2}}(\\mathbf{r}) - \\rho_{\\mathrm{HF}}(\\mathbf{r})$.\n\nComputational domain and diagnostics:\n5) Define a uniform three-dimensional Cartesian grid covering the box $x \\in [-4.0, 4.0]$, $y \\in [-4.0, 4.0]$, $z \\in [-2.0, 8.0]$, with uniform spacing $h = 0.5$ bohr along each axis. On this grid, evaluate $\\Delta \\rho(\\mathbf{r})$ at all grid points and use the Riemann sum with volume element $h^3$ to approximate the discrete integral over the box.\n\n6) Define the following three points in space (in bohr) for pointwise evaluation of $\\Delta \\rho(\\mathbf{r})$:\n- $P_1$: the midpoint of the hydrogen bond line between $\\mathrm{O_A}$ and $\\mathrm{H_{B1}}$, that is $P_1 = \\frac{1}{2} \\left( \\mathbf{R}_{\\mathrm{O_A}} + \\mathbf{R}_{\\mathrm{H_{B1}}} \\right)$.\n- $P_2$: a point near the oxygen core of $\\mathrm{O_A}$, that is $P_2 = \\mathbf{R}_{\\mathrm{O_A}} + (0.1, 0, 0)$.\n- $P_3$: a distant point, that is $P_3 = (10.0, 10.0, 10.0)$.\n\nTest suite and required outputs:\n7) Your program must compute the following five quantities, using the definitions above:\n- Test A: the value $\\Delta \\rho(P_1)$ in units of bohr$^{-3}$.\n- Test B: the value $\\Delta \\rho(P_2)$ in units of bohr$^{-3}$.\n- Test C: the value $\\Delta \\rho(P_3)$ in units of bohr$^{-3}$.\n- Test D: the discrete integral over the grid, $\\sum_{\\text{grid points } \\mathbf{r}_i} \\Delta \\rho(\\mathbf{r}_i) \\, h^3$, which represents the net electron number difference captured within the box, in units of electrons.\n- Test E: the maximum absolute value of the field on the grid, $\\max_{\\text{grid points } \\mathbf{r}_i} \\left| \\Delta \\rho(\\mathbf{r}_i) \\right|$, in units of bohr$^{-3}$.\n\nAngle unit specification:\n8) All angles in trigonometric functions must be in degrees as specified when constructing coordinates; trigonometric evaluations in your program must convert degrees to radians for numerical computation.\n\nFinal output format:\n9) Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [Test A, Test B, Test C, Test E]. Express Tests A, B, C, and E in bohr$^{-3}$, and Test D in electrons. Round each value to exactly six decimal places. For example, a valid output would look like [$x_1$,$x_2$,$x_3$,$x_4$,$x_5$], where each $x_i$ is a decimal-rendered float with six digits after the decimal point.", "solution": "The problem statement has been rigorously analyzed and is determined to be valid. It is a self-contained, scientifically grounded, and computationally well-posed problem rooted in the principles of computational quantum chemistry. All definitions, parameters, and objectives are specified with sufficient precision to permit a unique and verifiable solution. We now proceed with a systematic derivation and construction of the solution.\n\nThe task is to compute the difference in electron density, $\\Delta \\rho(\\mathbf{r}) = \\rho_{\\mathrm{MP2}}(\\mathbf{r}) - \\rho_{\\mathrm{HF}}(\\mathbf{r})$, between second-order Møller-Plesset perturbation theory (MP2) and Hartree-Fock (HF) theories for a water dimer, based on a simplified model using atom-centered Gaussian functions.\n\n**1. System Geometry**\n\nThe water dimer consists of six atoms. Their Cartesian coordinates must be determined from the provided geometric parameters. All positions are in atomic units (bohr).\n\n-   Bond length: $b = 1.809$ bohr.\n-   H-O-H angle: $\\theta_{\\mathrm{HOH}} = 104.5^\\circ$.\n-   Monomer B orientation angle: $\\varphi = 75.5^\\circ$.\n\nTrigonometric functions require angles in radians. Let $\\theta_{\\mathrm{HOH, rad}} = 104.5 \\times \\frac{\\pi}{180}$ and $\\varphi_{\\mathrm{rad}} = 75.5 \\times \\frac{\\pi}{180}$.\n\nThe atomic coordinates are:\n-   Monomer A is in the $xy$-plane:\n    -   Oxygen $\\mathrm{O_A}$: $\\mathbf{R}_{\\mathrm{O_A}} = (0, 0, 0)$.\n    -   Hydrogen $\\mathrm{H_{A1}}$: $\\mathbf{R}_{\\mathrm{H_{A1}}} = \\left(b \\cos\\left(\\frac{\\theta_{\\mathrm{HOH, rad}}}{2}\\right), b \\sin\\left(\\frac{\\theta_{\\mathrm{HOH, rad}}}{2}\\right), 0\\right) \\approx (1.107435, 1.430335, 0)$.\n    -   Hydrogen $\\mathrm{H_{A2}}$: $\\mathbf{R}_{\\mathrm{H_{A2}}} = \\left(b \\cos\\left(\\frac{\\theta_{\\mathrm{HOH, rad}}}{2}\\right), -b \\sin\\left(\\frac{\\theta_{\\mathrm{HOH, rad}}}{2}\\right), 0\\right) \\approx (1.107435, -1.430335, 0)$.\n-   Monomer B is oriented along the $z$-axis and in the $xz$-plane:\n    -   Oxygen $\\mathrm{O_B}$: $\\mathbf{R}_{\\mathrm{O_B}} = (0, 0, 5.5)$.\n    -   Hydrogen $\\mathrm{H_{B1}}$ (donor hydrogen): $\\mathbf{R}_{\\mathrm{H_{B1}}} = (0, 0, 5.5 - b) = (0, 0, 3.691)$. This atom forms the hydrogen bond with $\\mathrm{O_A}$.\n    -   Hydrogen $\\mathrm{H_{B2}}$: $\\mathbf{R}_{\\mathrm{H_{B2}}} = \\mathbf{R}_{\\mathrm{O_B}} + b \\left( \\sin(\\varphi_{\\mathrm{rad}}), 0, \\cos(\\varphi_{\\mathrm{rad}}) \\right) \\approx (1.751631, 0, 5.952932)$.\n\nThese six atomic centers, $\\{\\mathbf{R}_i\\}$, form the geometric basis for the density model.\n\n**2. Electron Density Difference Model**\n\nThe electron density for a given method, $M \\in \\{\\mathrm{HF}, \\mathrm{MP2}\\}$, is modeled as a sum of normalized, atom-centered Gaussian functions:\n$$\n\\rho_{M}(\\mathbf{r}) = \\sum_{\\text{atom } A} \\sum_{k} c^{M}_{A,k} \\, g_{\\alpha_{A,k}}(\\mathbf{r}-\\mathbf{R}_A)\n$$\nwhere the normalized Gaussian component is:\n$$\ng_{\\alpha}(\\mathbf{r}-\\mathbf{R}) = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp\\!\\left(-\\alpha \\lVert \\mathbf{r}-\\mathbf{R} \\rVert^2\\right)\n$$\nThe difference density field, $\\Delta \\rho(\\mathbf{r})$, is what we must compute. For computational efficiency, we combine the sums:\n$$\n\\Delta \\rho(\\mathbf{r}) = \\rho_{\\mathrm{MP2}}(\\mathbf{r}) - \\rho_{\\mathrm{HF}}(\\mathbf{r}) = \\sum_{\\text{atom } A} \\sum_{k} (c^{\\mathrm{MP2}}_{A,k} - c^{\\mathrm{HF}}_{A,k}) \\, g_{\\alpha_{A,k}}(\\mathbf{r}-\\mathbf{R}_A)\n$$\nWe define the difference coefficients $\\Delta c_{A,k} = c^{\\mathrm{MP2}}_{A,k} - c^{\\mathrm{HF}}_{A,k}$. The parameters are:\n-   For each of the two Oxygen atoms ($\\mathrm{O_A}, \\mathrm{O_B}$):\n    -   Core component: $\\alpha_{\\mathrm{O,core}} = 8.0$, $\\Delta c_{\\mathrm{O,core}} = 1.95 - 2.0 = -0.05$.\n    -   Valence component: $\\alpha_{\\mathrm{O,val}} = 1.5$, $\\Delta c_{\\mathrm{O,val}} = 6.03 - 6.0 = 0.03$.\n-   For each of the four Hydrogen atoms ($\\mathrm{H_{A1}}, \\mathrm{H_{A2}}, \\mathrm{H_{B1}}, \\mathrm{H_{B2}}$):\n    -   Valence component: $\\alpha_{\\mathrm{H,val}} = 0.8$, $\\Delta c_{\\mathrm{H,val}} = 1.01 - 1.0 = 0.01$.\n\nThe calculation of $\\Delta \\rho(\\mathbf{r})$ thus simplifies to a single summation over eight components (two for each oxygen atom, one for each hydrogen atom):\n$$\n\\Delta \\rho(\\mathbf{r}) = \\sum_{i=1}^{8} \\Delta c_i \\left(\\frac{\\alpha_i}{\\pi}\\right)^{3/2} \\exp\\!\\left(-\\alpha_i \\lVert \\mathbf{r}-\\mathbf{R}_i \\rVert^2\\right)\n$$\nwhere the index $i$ runs over all components on all atoms.\n\n**3. Evaluation at Specific Points (Tests A, B, C)**\n\nWe are required to evaluate $\\Delta \\rho(\\mathbf{r})$ at three specific points:\n-   $P_1 = \\frac{1}{2} (\\mathbf{R}_{\\mathrm{O_A}} + \\mathbf{R}_{\\mathrm{H_{B1}}}) = (0, 0, 1.8455)$. This point is at the midpoint of the hydrogen bond.\n-   $P_2 = \\mathbf{R}_{\\mathrm{O_A}} + (0.1, 0, 0) = (0.1, 0, 0)$. This point is near the core of the acceptor oxygen atom.\n-   $P_3 = (10.0, 10.0, 10.0)$. This is a distant point where the density field is expected to be negligible.\n\nFor each point $P_j$, we compute $\\Delta \\rho(P_j)$ by substituting $\\mathbf{r} = P_j$ into the formula for $\\Delta \\rho(\\mathbf{r})$. These correspond to Test A, B, and C.\n\n**4. Evaluation on a Grid (Tests D, E)**\n\nA uniform Cartesian grid is defined over the domain $x \\in [-4.0, 4.0]$, $y \\in [-4.0, 4.0]$, and $z \\in [-2.0, 8.0]$. The grid spacing is $h = 0.5$ bohr. We evaluate $\\Delta \\rho(\\mathbf{r}_i)$ at each grid point $\\mathbf{r}_i$.\n\n-   **Test D**: The discrete integral of $\\Delta \\rho(\\mathbf{r})$ over the grid box is approximated by a Riemann sum:\n    $$\n    I_{\\Delta \\rho} \\approx \\sum_{\\text{grid points } \\mathbf{r}_i} \\Delta \\rho(\\mathbf{r}_i) \\, \\Delta V\n    $$\n    where the volume element is $\\Delta V = h^3 = (0.5)^3 = 0.125$ bohr$^3$. This quantity represents the net change in electron population within the defined volume.\n\n-   **Test E**: The maximum absolute value of the difference density on the grid is:\n    $$\n    \\max |\\Delta \\rho| = \\max_{\\text{grid points } \\mathbf{r}_i} \\left| \\Delta \\rho(\\mathbf{r}_i) \\right|\n    $$\n    This diagnostic identifies the location of the largest magnitude change in electron density.\n\n**5. Algorithmic Implementation**\n\nA numerical program will be constructed to perform these calculations. The core of the program is a function that computes $\\Delta \\rho(\\mathbf{r})$ for any given point or array of points $\\mathbf{r}$. For grid calculations, a vectorized approach using NumPy is superior for performance. This involves creating an array of all grid point coordinates and computing the contributions from all eight Gaussian components simultaneously for all points. The pointwise evaluations use the same function, supplied with the coordinates of $P_1$, $P_2$, and $P_3$. The final results are formatted to six decimal places as required.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry problem for the water dimer density difference.\n    \"\"\"\n\n    # 1. System Geometry\n    b = 1.809  # O-H bond length in bohr\n    theta_hoh_deg = 104.5  # H-O-H bond angle in degrees\n    phi_deg = 75.5  # Monomer B orientation angle in degrees\n\n    # Convert angles to radians for numpy trigonometric functions\n    theta_hoh_rad = np.deg2rad(theta_hoh_deg)\n    phi_rad = np.deg2rad(phi_deg)\n\n    # Atomic coordinates\n    R_OA = np.array([0.0, 0.0, 0.0])\n    R_HA1 = np.array([\n        b * np.cos(theta_hoh_rad / 2),\n        b * np.sin(theta_hoh_rad / 2),\n        0.0\n    ])\n    R_HA2 = np.array([\n        b * np.cos(theta_hoh_rad / 2),\n        -b * np.sin(theta_hoh_rad / 2),\n        0.0\n    ])\n    R_OB = np.array([0.0, 0.0, 5.5])\n    R_HB1 = np.array([0.0, 0.0, 5.5 - b])\n    R_HB2 = R_OB + b * np.array([\n        np.sin(phi_rad),\n        0.0,\n        np.cos(phi_rad)\n    ])\n    \n    atom_centers = {\n        'O': [R_OA, R_OB],\n        'H': [R_HA1, R_HA2, R_HB1, R_HB2]\n    }\n\n    # 2. Electron Density Model Parameters\n    # Exponents (alpha)\n    alpha_O_core = 8.0\n    alpha_O_val = 1.5\n    alpha_H_val = 0.8\n\n    # Difference coefficients (delta_c = c_MP2 - c_HF)\n    dc_O_core = 1.95 - 2.0   # -0.05\n    dc_O_val = 6.03 - 6.0    #  0.03\n    dc_H_val = 1.01 - 1.0    #  0.01\n\n    # List of all components for difference density calculation\n    # Format: (center_coords, alpha, delta_c)\n    components = []\n    for center in atom_centers['O']:\n        components.append((center, alpha_O_core, dc_O_core))\n        components.append((center, alpha_O_val, dc_O_val))\n    for center in atom_centers['H']:\n        components.append((center, alpha_H_val, dc_H_val))\n\n    def calculate_delta_rho(points):\n        \"\"\"\n        Calculates delta_rho on a set of points using a vectorized approach.\n        \n        Args:\n            points: An (N, 3) numpy array of coordinates.\n        \n        Returns:\n            An (N,) numpy array of delta_rho values.\n        \"\"\"\n        if points.ndim == 1:\n            points = points.reshape(1, -1)\n        \n        n_points = points.shape[0]\n        delta_rho_values = np.zeros(n_points)\n\n        for center, alpha, delta_c in components:\n            # Normalization prefactor for the Gaussian function\n            prefactor = (alpha / np.pi)**1.5\n            \n            # Squared distance from all points to the current atomic center\n            dist_sq = np.sum((points - center)**2, axis=1)\n            \n            # Contribution of this component to delta_rho at all points\n            contribution = delta_c * prefactor * np.exp(-alpha * dist_sq)\n            delta_rho_values += contribution\n            \n        return delta_rho_values\n\n    # 3. Evaluation at Specific Points (Tests A, B, C)\n    P1 = 0.5 * (R_OA + R_HB1)\n    P2 = R_OA + np.array([0.1, 0.0, 0.0])\n    P3 = np.array([10.0, 10.0, 10.0])\n    \n    eval_points = np.array([P1, P2, P3])\n    pointwise_results = calculate_delta_rho(eval_points)\n    \n    test_A = pointwise_results[0]\n    test_B = pointwise_results[1]\n    test_C = pointwise_results[2]\n\n    # 4. Evaluation on a Grid (Tests D, E)\n    h = 0.5  # Grid spacing\n    x_coords = np.arange(-4.0, 4.0 + h, h)\n    y_coords = np.arange(-4.0, 4.0 + h, h)\n    z_coords = np.arange(-2.0, 8.0 + h, h)\n\n    # Create grid points\n    xx, yy, zz = np.meshgrid(x_coords, y_coords, z_coords, indexing='ij')\n    grid_points = np.vstack([xx.ravel(), yy.ravel(), zz.ravel()]).T\n\n    # Calculate delta_rho on the grid\n    grid_delta_rho = calculate_delta_rho(grid_points)\n\n    # Test D: Discrete integral\n    volume_element = h**3\n    test_D = np.sum(grid_delta_rho) * volume_element\n    \n    # Test E: Maximum absolute value on the grid\n    test_E = np.max(np.abs(grid_delta_rho))\n    \n    results = [test_A, test_B, test_C, test_D, test_E]\n\n    # 5. Final Output Formatting\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2461938"}, {"introduction": "A critical skill for any computational chemist is knowing the limitations of their tools. MP2 theory, being built on a perturbative framework, can fail dramatically when the reference state is a poor approximation, particularly in cases of near-degenerate electronic states. This exercise [@problem_id:2461933] uses a simple but powerful model to demonstrate this \"small denominator problem,\" comparing the unphysical MP2 result to the correct, non-perturbative energy and providing a clear lesson on when single-reference perturbation theory is not the right tool for the job.", "problem": "Consider a minimal two-determinant model of a beryllium-like atom that isolates the near-degenerate double excitation from the doubly occupied $2s$ orbital to the doubly occupied $2p$ orbital. Work in a basis of two normalized Slater determinants, the closed-shell reference $\\lvert ss \\rangle$ and the doubly excited configuration $\\lvert pp \\rangle$, both spin singlets. The electronic Hamiltonian restricted to this subspace is represented by the real symmetric matrix\n$$\nH \\;=\\; \\begin{pmatrix}\nE_{ss} & V \\\\\nV & E_{pp}\n\\end{pmatrix},\n$$\nwhere $E_{ss}$ and $E_{pp}$ are the diagonal matrix elements (total electronic energies in Hartree) of the two determinants, and $V \\ge 0$ is the off-diagonal coupling arising from the antisymmetrized two-electron interaction between $\\lvert ss \\rangle$ and $\\lvert pp \\rangle$. The parameter $V$ models the effective two-electron integral that mixes the closed-shell ground configuration with the near-degenerate double excitation. Throughout, use Hartree as the energy unit.\n\nDefine the correlation energy as the difference between the interacting ground-state energy and the reference energy $E_{ss}$,\n$$\nE_{\\mathrm{corr}} \\;=\\; E_{\\mathrm{ground}} \\;-\\; E_{ss}.\n$$\n\nTasks:\n1. Using second-order Møller-Plesset theory (MP2), defined here as second-order Rayleigh-Schrödinger perturbation theory with unperturbed Hamiltonian $H_0 = \\operatorname{diag}(E_{ss}, E_{pp})$ and perturbation $H' = H - H_0$, compute the MP2 correlation energy $E_{\\mathrm{corr}}^{\\mathrm{MP2}}$ for each test case below.\n2. Using Coupled Cluster with Singles and Doubles (CCSD), which for two electrons in this two-determinant subspace coincides with the exact diagonalization of $H$ in this basis, compute the CCSD correlation energy $E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$ as the difference between the lowest eigenvalue of $H$ and $E_{ss}$ for each test case.\n\nTest suite (each tuple lists $(E_{ss}, E_{pp}, V)$, all in Hartree):\n- Case 1 (well separated): $(0.000000, 0.500000, 0.100000)$\n- Case 2 (near-degenerate): $(0.000000, 0.050000, 0.100000)$\n- Case 3 (nearly degenerate limit): $(0.000000, 0.000001, 0.100000)$\n- Case 4 (no coupling boundary): $(0.000000, 0.500000, 0.000000)$\n\nFor each case, output a list containing $E_{\\mathrm{corr}}^{\\mathrm{MP2}}$ and $E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$, in this order, both expressed in Hartree and rounded to six decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the results for all cases as a comma-separated list of the per-case lists, enclosed in square brackets, for example,\n$$\n\\big[\\,[x_1,y_1],\\,[x_2,y_2],\\,[x_3,y_3],\\,[x_4,y_4]\\,\\big],\n$$\nwhere $x_k$ and $y_k$ are the rounded floats for case $k$ in Hartree.", "solution": "The problem statement is subjected to validation.\n\nGivens extracted verbatim are:\n- A two-determinant model with normalized basis states $\\lvert ss \\rangle$ and $\\lvert pp \\rangle$.\n- The Hamiltonian matrix in this basis:\n$$\nH \\;=\\; \\begin{pmatrix}\nE_{ss} & V \\\\\nV & E_{pp}\n\\end{pmatrix}\n$$\nwhere $V \\ge 0$. Energies are in Hartree.\n- Correlation energy definition: $E_{\\mathrm{corr}} \\;=\\; E_{\\mathrm{ground}} \\;-\\; E_{ss}$.\n- Task 1: Compute MP2 correlation energy, $E_{\\mathrm{corr}}^{\\mathrm{MP2}}$, using second-order Rayleigh-Schrödinger perturbation theory with $H_0 = \\operatorname{diag}(E_{ss}, E_{pp})$ and perturbation $H' = H - H_0$.\n- Task 2: Compute CCSD correlation energy, $E_{\\mathrm{corr}}^{\\mathrm{CCSD}}$, defined as exact diagonalization of $H$, where $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = (\\text{lowest eigenvalue of H}) - E_{ss}$.\n- Test cases $(E_{ss}, E_{pp}, V)$: $(0.0, 0.5, 0.1)$, $(0.0, 0.05, 0.1)$, $(0.0, 0.000001, 0.1)$, $(0.0, 0.5, 0.0)$.\n- Output requirement: A list of lists `[[mp2_1, ccsd_1], [mp2_2, ccsd_2], ...]` with values rounded to six decimal places.\n\nThe problem is assessed as valid. It is scientifically grounded in standard quantum mechanical methods (perturbation theory, configuration interaction), mathematically well-posed, and provides a complete, unambiguous, and consistent set of data and instructions. The model is a standard pedagogical tool in quantum chemistry. We proceed to the solution.\n\nThe solution requires the derivation of two quantities: the second-order Møller-Plesset (MP2) correlation energy and the exact correlation energy from diagonalization, which is here equated with Coupled Cluster with Singles and Doubles (CCSD).\n\nFirst, we address the MP2 correlation energy. The Hamiltonian is partitioned into a zeroth-order part, $H_0$, and a perturbation, $H'$.\n$$\nH_0 = \\begin{pmatrix} E_{ss} & 0 \\\\ 0 & E_{pp} \\end{pmatrix}, \\quad H' = \\begin{pmatrix} 0 & V \\\\ V & 0 \\end{pmatrix}\n$$\nThe unperturbed eigenstates of $H_0$ are the basis states themselves: $\\lvert ss \\rangle$ with energy $E_0^{(0)} = E_{ss}$, and $\\lvert pp \\rangle$ with energy $E_1^{(0)} = E_{pp}$. We take $\\lvert ss \\rangle$ as our reference state.\n\nThe energy corrections are found using standard Rayleigh-Schrödinger perturbation theory.\nThe first-order energy correction is the expectation value of the perturbation in the reference state:\n$$\nE^{(1)} = \\langle ss | H' | ss \\rangle = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & V \\\\ V & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 0\n$$\nThe second-order energy correction is given by the formula:\n$$\nE^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle \\psi_k^{(0)} | H' | \\psi_0^{(0)} \\rangle|^2}{E_0^{(0)} - E_k^{(0)}}\n$$\nIn our two-state system, the sum contains only one term, for the state $k=1$, which corresponds to $\\lvert pp \\rangle$.\nThe required matrix element is:\n$$\n\\langle pp | H' | ss \\rangle = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & V \\\\ V & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = V\n$$\nSubstituting this into the formula for $E^{(2)}$ gives:\n$$\nE^{(2)} = \\frac{|\\langle pp | H' | ss \\rangle|^2}{E_{ss} - E_{pp}} = \\frac{V^2}{E_{ss} - E_{pp}}\n$$\nThe MP2 correlation energy, $E_{\\mathrm{corr}}^{\\mathrm{MP2}}$, is defined as this second-order correction to the energy.\n$$\nE_{\\mathrm{corr}}^{\\mathrm{MP2}} = E^{(2)} = \\frac{V^2}{E_{ss} - E_{pp}}\n$$\nThis result reveals the critical flaw of non-degenerate perturbation theory: as the energy denominator $E_{ss} - E_{pp}$ approaches zero, the correction diverges.\n\nSecond, we address the CCSD correlation energy, obtained by exact diagonalization of the full Hamiltonian $H$. We seek the eigenvalues $\\lambda$ of $H$ by solving the secular equation $\\det(H - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix} E_{ss} - \\lambda & V \\\\ V & E_{pp} - \\lambda \\end{pmatrix} = (E_{ss} - \\lambda)(E_{pp} - \\lambda) - V^2 = 0\n$$\nThis yields the quadratic equation $\\lambda^2 - (E_{ss} + E_{pp})\\lambda + E_{ss}E_{pp} - V^2 = 0$. The solutions are given by the quadratic formula:\n$$\n\\lambda_{\\pm} = \\frac{(E_{ss} + E_{pp}) \\pm \\sqrt{(E_{ss} + E_{pp})^2 - 4(E_{ss}E_{pp} - V^2)}}{2} = \\frac{E_{ss} + E_{pp} \\pm \\sqrt{(E_{ss} - E_{pp})^2 + 4V^2}}{2}\n$$\nThe ground-state energy, $E_{\\mathrm{ground}}$, is the lower eigenvalue, $\\lambda_{-}$.\n$$\nE_{\\mathrm{ground}} = \\frac{E_{ss} + E_{pp} - \\sqrt{(E_{ss} - E_{pp})^2 + 4V^2}}{2}\n$$\nThe correlation energy is then $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = E_{\\mathrm{ground}} - E_{ss}$.\n$$\nE_{\\mathrm{corr}}^{\\mathrm{CCSD}} = \\frac{E_{ss} + E_{pp} - \\sqrt{(E_{ss} - E_{pp})^2 + 4V^2}}{2} - E_{ss} = \\frac{E_{pp} - E_{ss} - \\sqrt{(E_{ss} - E_{pp})^2 + 4V^2}}{2}\n$$\nThis expression is valid even for degenerate systems ($E_{ss} = E_{pp}$), where it correctly gives $E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = -V$.\n\nWe now apply these two formulas to the provided test cases.\n\nCase 1: $(E_{ss}, E_{pp}, V) = (0.0, 0.5, 0.1)$.\n$E_{\\mathrm{corr}}^{\\mathrm{MP2}} = \\frac{0.1^2}{0.0 - 0.5} = \\frac{0.01}{-0.5} = -0.02$.\n$E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = \\frac{0.5 - 0.0 - \\sqrt{(0.0 - 0.5)^2 + 4(0.1)^2}}{2} = \\frac{0.5 - \\sqrt{0.25 + 0.04}}{2} = \\frac{0.5 - \\sqrt{0.29}}{2} \\approx -0.019258$.\nIn this non-degenerate case, MP2 provides a reasonable approximation.\n\nCase 2: $(E_{ss}, E_{pp}, V) = (0.0, 0.05, 0.1)$.\n$E_{\\mathrm{corr}}^{\\mathrm{MP2}} = \\frac{0.1^2}{0.0 - 0.05} = \\frac{0.01}{-0.05} = -0.2$.\n$E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = \\frac{0.05 - 0.0 - \\sqrt{(0.0 - 0.05)^2 + 4(0.1)^2}}{2} = \\frac{0.05 - \\sqrt{0.0025 + 0.04}}{2} = \\frac{0.05 - \\sqrt{0.0425}}{2} \\approx -0.078078$.\nWith near-degeneracy, the MP2 result is qualitatively incorrect, overestimating the correlation energy magnitude significantly.\n\nCase 3: $(E_{ss}, E_{pp}, V) = (0.0, 0.000001, 0.1)$.\n$E_{\\mathrm{corr}}^{\\mathrm{MP2}} = \\frac{0.1^2}{0.0 - 0.000001} = \\frac{0.01}{-10^{-6}} = -10000$.\n$E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = \\frac{0.000001 - 0.0 - \\sqrt{(0.0 - 0.000001)^2 + 4(0.1)^2}}{2} = \\frac{10^{-6} - \\sqrt{10^{-12} + 0.04}}{2} \\approx \\frac{10^{-6} - 0.2}{2} \\approx -0.1$.\nMore precisely, the calculation yields $-0.0999995...$, which rounds to $-0.100000$.\nThis case demonstrates the catastrophic failure of MP2 for quasi-degenerate states, yielding an unphysically large correlation energy, while the non-perturbative CCSD method remains stable and gives the correct limit of $-V = -0.1$.\n\nCase 4: $(E_{ss}, E_{pp}, V) = (0.0, 0.5, 0.0)$.\n$E_{\\mathrm{corr}}^{\\mathrm{MP2}} = \\frac{0.0^2}{0.0 - 0.5} = 0$.\n$E_{\\mathrm{corr}}^{\\mathrm{CCSD}} = \\frac{0.5 - 0.0 - \\sqrt{(0.0 - 0.5)^2 + 4(0.0)^2}}{2} = \\frac{0.5 - \\sqrt{0.25}}{2} = \\frac{0.5 - 0.5}{2} = 0$.\nWith no coupling ($V=0$), there is no interaction between the configurations. Hence, there is no correlation energy beyond the reference Hartree-Fock description, and both methods correctly yield zero.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating MP2 and CCSD correlation energies\n    for a two-level quantum system.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains (Ess, Epp, V) in Hartree units.\n    test_cases = [\n        (0.000000, 0.500000, 0.100000), # Case 1: well separated\n        (0.000000, 0.050000, 0.100000), # Case 2: near-degenerate\n        (0.000000, 0.000001, 0.100000), # Case 3: nearly degenerate limit\n        (0.000000, 5.000000e-01, 0.000000), # Case 4: no coupling\n    ]\n\n    all_results = []\n    for case in test_cases:\n        Ess, Epp, V = case\n\n        # Task 1: Calculate MP2 correlation energy\n        # E_corr_mp2 = V^2 / (Ess - Epp)\n        # Non-degenerate perturbation theory is used.\n        # The denominator (Ess - Epp) approaches zero in case 3,\n        # demonstrating the characteristic failure of MP2 for near-degenerate systems.\n        # The problem inputs do not result in division by exactly zero.\n        denominator_mp2 = Ess - Epp\n        e_corr_mp2 = (V**2) / denominator_mp2\n\n        # Task 2: Calculate CCSD (exact) correlation energy\n        # This is derived from the lowest eigenvalue of the 2x2 Hamiltonian.\n        # E_corr_ccsd = (Epp - Ess - sqrt((Ess - Epp)^2 + 4*V^2)) / 2\n        delta_E = Epp - Ess\n        e_corr_ccsd = (delta_E - np.sqrt(delta_E**2 + 4 * V**2)) / 2\n\n        # Append the pair of rounded results for the current case.\n        # The problem requires rounding to six decimal places.\n        all_results.append([\n            round(e_corr_mp2, 6),\n            round(e_corr_ccsd, 6)\n        ])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists,\n    # with no spaces and with all numbers formatted to 6 decimal places.\n    case_strings = []\n    for result_pair in all_results:\n        # Format each number to ensure six decimal places are shown, e.g., 0.000000\n        formatted_pair = f\"[{result_pair[0]:.6f},{result_pair[1]:.6f}]\"\n        case_strings.append(formatted_pair)\n    \n    final_output_string = f\"[{','.join(case_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2461933"}]}