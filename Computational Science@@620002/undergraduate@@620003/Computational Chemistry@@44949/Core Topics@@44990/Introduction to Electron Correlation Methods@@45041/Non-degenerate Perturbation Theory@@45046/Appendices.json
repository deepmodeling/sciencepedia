{"hands_on_practices": [{"introduction": "This first practice serves as a foundational exercise to build proficiency with the core formula of non-degenerate perturbation theory. By applying a simple cosine perturbation to the classic particle-in-a-box model, you will gain hands-on experience in setting up and evaluating the integral for the first-order energy correction, $E_{n}^{(1)}$. Mastering this fundamental calculation [@problem_id:2459481] is the first step toward applying perturbation theory to more complex chemical systems.", "id": "2459481", "problem": "Consider a one-dimensional quantum particle of mass $m$ confined in an infinite potential well extending from $x=-L/2$ to $x=+L/2$. The unperturbed potential $U(x)$ is $U(x)=0$ for $|x|<L/2$ and $U(x)=\\infty$ for $|x|\\ge L/2$, so the unperturbed stationary states satisfy the time-independent Schrödinger equation inside the well with boundary conditions $\\psi(\\pm L/2)=0$. A weak, static perturbation is applied inside the well given by $V(x)=\\epsilon \\cos\\!\\left(\\frac{\\pi x}{L}\\right)$ for $|x|<L/2$ and $V(x)=0$ for $|x|\\ge L/2$, where $\\epsilon$ is a real parameter with units of energy and $|\\epsilon|$ is sufficiently small to justify first-order treatment.\n\nUsing time-independent non-degenerate perturbation theory, determine the first-order correction $E_{1}^{(1)}$ to the ground-state energy. Express your final answer as a closed-form analytic expression in terms of $\\epsilon$ and $\\pi$.", "solution": "The problem will first be subjected to a rigorous validation procedure before any attempt at a solution is made.\n\n**Step 1: Extract Givens**\n- Particle mass: $m$.\n- Unperturbed potential: $U(x) = 0$ for $|x| < L/2$ and $U(x) = \\infty$ for $|x| \\ge L/2$. This is a one-dimensional infinite potential well of width $L$ centered at the origin.\n- Boundary conditions for the unperturbed wavefunction: $\\psi(\\pm L/2) = 0$.\n- Perturbing potential: $V(x) = \\epsilon \\cos(\\frac{\\pi x}{L})$ for $|x| < L/2$ and $V(x) = 0$ otherwise.\n- Parameter $\\epsilon$: A small, real constant with units of energy.\n- Task: Determine the first-order correction to the ground-state energy, $E_{1}^{(1)}$, using time-independent non-degenerate perturbation theory.\n- Required form of answer: A closed-form expression in terms of $\\epsilon$ and $\\pi$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is based on fundamental principles of quantum mechanics. The infinite square well is a canonical introductory problem, and perturbation theory is a standard, essential method for solving more complex quantum systems. The form of the perturbation is physically reasonable. The problem is scientifically sound.\n- **Well-Posedness**: The problem is well-posed. It asks for a specific quantity, $E_{1}^{(1)}$, using a specified method. All necessary information is provided. The ground state of a one-dimensional potential well is always non-degenerate, which correctly justifies the use of non-degenerate perturbation theory. Therefore, a unique, stable, and meaningful solution exists.\n- **Objectivity**: The problem is stated using precise, objective mathematical and physical language, devoid of any subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically grounded, well-posed, objective, and complete. It is a standard exercise in quantum mechanics. The problem is valid. I will now proceed with the solution.\n\nThe first-order correction to the energy of a non-degenerate state $|n\\rangle$ is given by the expectation value of the perturbing potential in the unperturbed state $|\\psi_{n}^{(0)}\\rangle$. For the ground state ($n=1$), this is:\n$$\nE_{1}^{(1)} = \\langle \\psi_{1}^{(0)} | V | \\psi_{1}^{(0)} \\rangle = \\int_{-\\infty}^{\\infty} (\\psi_{1}^{(0)}(x))^{*} V(x) \\psi_{1}^{(0)}(x) \\, dx\n$$\nThe integral is restricted to the domain where the wavefunction is non-zero, which is the interior of the well from $x = -L/2$ to $x = +L/2$.\n\nFirst, we must determine the unperturbed ground-state wavefunction, $\\psi_{1}^{(0)}(x)$, for the infinite potential well centered at the origin. The time-independent Schrödinger equation inside the well is:\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} = E \\psi(x)\n$$\nThe potential $U(x)$ is an even function, so the solutions will have definite parity. The ground state must be the lowest-energy solution that is non-zero inside the well and satisfies the boundary conditions $\\psi(\\pm L/2) = 0$. This corresponds to an even function, a cosine. The general form for the even solutions is $\\psi_n(x) = A \\cos(k_n x)$ where the boundary condition $\\cos(k_n L/2)=0$ implies $k_n L/2 = \\frac{n\\pi}{2}$ for odd integers $n=1, 3, 5, \\dots$. The ground state corresponds to $n=1$, so $k_1 = \\pi/L$.\nThe unperturbed ground-state wavefunction is thus:\n$$\n\\psi_{1}^{(0)}(x) = A \\cos\\left(\\frac{\\pi x}{L}\\right)\n$$\nThe normalization constant $A$ is found by requiring $\\int_{-L/2}^{L/2} |\\psi_{1}^{(0)}(x)|^2 \\, dx = 1$:\n$$\nA^2 \\int_{-L/2}^{L/2} \\cos^2\\left(\\frac{\\pi x}{L}\\right) \\, dx = 1\n$$\nUsing the identity $\\cos^2(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$:\n$$\nA^2 \\int_{-L/2}^{L/2} \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{2\\pi x}{L}\\right)\\right) \\, dx = A^2 \\frac{1}{2} \\left[x + \\frac{L}{2\\pi}\\sin\\left(\\frac{2\\pi x}{L}\\right)\\right]_{-L/2}^{L/2} = A^2 \\frac{1}{2} \\left(L\\right) = 1\n$$\nThis gives $A^2 = 2/L$, so $A = \\sqrt{2/L}$. The normalized unperturbed ground-state wavefunction is:\n$$\n\\psi_{1}^{(0)}(x) = \\sqrt{\\frac{2}{L}} \\cos\\left(\\frac{\\pi x}{L}\\right) \\quad \\text{for } |x| < L/2\n$$\nNow we can compute the first-order energy correction. The wavefunction is real, so $(\\psi_{1}^{(0)}(x))^* = \\psi_{1}^{(0)}(x)$.\n$$\nE_{1}^{(1)} = \\int_{-L/2}^{L/2} \\left(\\sqrt{\\frac{2}{L}} \\cos\\left(\\frac{\\pi x}{L}\\right)\\right)^2 \\left(\\epsilon \\cos\\left(\\frac{\\pi x}{L}\\right)\\right) \\, dx\n$$\n$$\nE_{1}^{(1)} = \\frac{2\\epsilon}{L} \\int_{-L/2}^{L/2} \\cos^3\\left(\\frac{\\pi x}{L}\\right) \\, dx\n$$\nTo evaluate this integral, let us perform a change of variables. Let $u = \\frac{\\pi x}{L}$. Then $du = \\frac{\\pi}{L} dx$, or $dx = \\frac{L}{\\pi} du$. The limits of integration change from $x = -L/2$ to $u = -\\pi/2$ and from $x = L/2$ to $u = \\pi/2$.\n$$\nE_{1}^{(1)} = \\frac{2\\epsilon}{L} \\int_{-\\pi/2}^{\\pi/2} \\cos^3(u) \\left(\\frac{L}{\\pi}\\right) \\, du = \\frac{2\\epsilon}{\\pi} \\int_{-\\pi/2}^{\\pi/2} \\cos^3(u) \\, du\n$$\nWe use the trigonometric identity $\\cos^3(u) = \\cos(u)(1-\\sin^2(u))$.\n$$\n\\int \\cos^3(u) \\, du = \\int (1 - \\sin^2(u)) \\cos(u) \\, du\n$$\nLet $v = \\sin(u)$, so $dv = \\cos(u) \\, du$. The integral becomes:\n$$\n\\int (1-v^2) \\, dv = v - \\frac{v^3}{3} = \\sin(u) - \\frac{\\sin^3(u)}{3}\n$$\nNow we evaluate the definite integral:\n$$\n\\int_{-\\pi/2}^{\\pi/2} \\cos^3(u) \\, du = \\left[\\sin(u) - \\frac{\\sin^3(u)}{3}\\right]_{-\\pi/2}^{\\pi/2}\n$$\n$$\n= \\left(\\sin\\left(\\frac{\\pi}{2}\\right) - \\frac{\\sin^3\\left(\\frac{\\pi}{2}\\right)}{3}\\right) - \\left(\\sin\\left(-\\frac{\\pi}{2}\\right) - \\frac{\\sin^3\\left(-\\frac{\\pi}{2}\\right)}{3}\\right)\n$$\nSince $\\sin(\\pi/2) = 1$ and $\\sin(-\\pi/2) = -1$:\n$$\n= \\left(1 - \\frac{1^3}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\nSubstituting this result back into the expression for $E_{1}^{(1)}$:\n$$\nE_{1}^{(1)} = \\frac{2\\epsilon}{\\pi} \\left(\\frac{4}{3}\\right) = \\frac{8\\epsilon}{3\\pi}\n$$\nThe first-order correction to the ground-state energy is therefore $\\frac{8\\epsilon}{3\\pi}$. The result is correctly expressed in terms of $\\epsilon$ and $\\pi$ as requested.", "answer": "$$\n\\boxed{\\frac{8\\epsilon}{3\\pi}}\n$$"}, {"introduction": "Moving from calculation to physical insight, this exercise explores the deep meaning behind the first-order energy correction. We model a localized impurity using a Dirac delta function potential placed precisely at a node of a particle-in-a-box wavefunction. This carefully chosen scenario [@problem_id:2459528] reveals that the energy correction is directly related to the probability of finding the particle at the location of the perturbation, offering a powerful and intuitive understanding of how quantum systems respond to localized changes.", "id": "2459528", "problem": "Consider a one-dimensional infinite potential well of length $L$, modeling an electron delocalized along a linear conjugated segment in a computational chemistry context. The unperturbed Hamiltonian $\\hat{H}_{0}$ has eigenfunctions $\\psi_{n}^{(0)}(x)$ and eigenvalues $E_{n}^{(0)}$ for $n \\in \\mathbb{N}$ on the domain $x \\in [0,L]$ with $\\psi_{n}^{(0)}(0)=\\psi_{n}^{(0)}(L)=0$. A localized substituent is modeled as a perturbation $\\hat{H}^{\\prime} = \\alpha \\,\\delta(x-x_{0})$, where $\\alpha$ is a real coupling parameter and $\\delta(\\cdot)$ is the Dirac delta function. Let $x_{0}$ be chosen to coincide with a node of $\\psi_{n}^{(0)}(x)$ in the interior of the box; for definiteness, take $x_{0}=L/2$ and an even integer $n$, so that $\\psi_{n}^{(0)}(L/2)=0$. Using non-degenerate, time-independent perturbation theory from first principles, determine the first-order correction to the energy, $E_{n}^{(1)}$, for this state.\n\nExpress your final answer for the first-order energy correction in Joules. Provide an exact value; no rounding is required.", "solution": "The problem requires the calculation of the first-order energy correction, $E_{n}^{(1)}$, for an electron in a one-dimensional infinite potential well of length $L$. The system is perturbed by a delta function potential, $\\hat{H}^{\\prime} = \\alpha \\,\\delta(x-x_{0})$, located at the center of the well, $x_{0} = L/2$. The analysis is for a specific set of unperturbed states, namely those with an even quantum number $n$.\n\nAccording to non-degenerate, time-independent perturbation theory, the first-order correction to the energy of a state $\\psi_{n}^{(0)}$ is given by the expectation value of the perturbation Hamiltonian $\\hat{H}^{\\prime}$ in that unperturbed state. The formula is:\n$$\nE_{n}^{(1)} = \\langle \\psi_{n}^{(0)} | \\hat{H}^{\\prime} | \\psi_{n}^{(0)} \\rangle\n$$\nIn the position representation, this corresponds to the integral:\n$$\nE_{n}^{(1)} = \\int_{-\\infty}^{\\infty} (\\psi_{n}^{(0)}(x))^{*} \\hat{H}^{\\prime} \\psi_{n}^{(0)}(x) \\, dx\n$$\nThe unperturbed system is a particle in a one-dimensional box of length $L$. The potential is $V(x) = 0$ for $x \\in [0,L]$ and $V(x) = \\infty$ otherwise. The normalized eigenfunctions, $\\psi_{n}^{(0)}(x)$, which satisfy the boundary conditions $\\psi_{n}^{(0)}(0) = \\psi_{n}^{(0)}(L) = 0$, are given by:\n$$\n\\psi_{n}^{(0)}(x) = \\begin{cases} \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x}{L}\\right) & \\text{for } 0 \\le x \\le L \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nwhere $n$ is a positive integer, $n \\in \\{1, 2, 3, \\dots\\}$.\n\nThe perturbation Hamiltonian is given as $\\hat{H}^{\\prime} = \\alpha \\,\\delta(x-x_{0})$, with $\\alpha$ being a real constant and $x_{0} = L/2$. Since the eigenfunctions are zero outside the interval $[0, L]$, the integral for $E_{n}^{(1)}$ can be restricted to this domain:\n$$\nE_{n}^{(1)} = \\int_{0}^{L} (\\psi_{n}^{(0)}(x))^{*} \\left[ \\alpha \\,\\delta\\left(x-\\frac{L}{2}\\right) \\right] \\psi_{n}^{(0)}(x) \\, dx\n$$\nThe eigenfunctions $\\psi_{n}^{(0)}(x)$ are real-valued, so $(\\psi_{n}^{(0)}(x))^{*} = \\psi_{n}^{(0)}(x)$. The constant $\\alpha$ can be factored out of the integral:\n$$\nE_{n}^{(1)} = \\alpha \\int_{0}^{L} \\left(\\psi_{n}^{(0)}(x)\\right)^{2} \\delta\\left(x-\\frac{L}{2}\\right) \\, dx\n$$\nWe use the sifting property of the Dirac delta function, which states that for a function $f(x)$ continuous at $x=a$, $\\int f(x) \\delta(x-a) \\, dx = f(a)$. In this case, the function is $f(x) = (\\psi_{n}^{(0)}(x))^{2}$ and the point is $a=L/2$, which lies within the interval of integration $[0, L]$. Therefore, the integral evaluates to:\n$$\nE_{n}^{(1)} = \\alpha \\left( \\psi_{n}^{(0)}\\left(\\frac{L}{2}\\right) \\right)^{2}\n$$\nThe problem specifies that the quantum number $n$ must be an even integer. We can write $n = 2k$, where $k$ is a positive integer ($k \\in \\{1, 2, 3, \\dots\\}$). We now evaluate the eigenfunction $\\psi_{n}^{(0)}(x)$ at the point $x=L/2$ for such an even $n$:\n$$\n\\psi_{n}^{(0)}\\left(\\frac{L}{2}\\right) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi (L/2)}{L}\\right) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi}{2}\\right)\n$$\nSubstituting $n=2k$:\n$$\n\\psi_{2k}^{(0)}\\left(\\frac{L}{2}\\right) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{2k\\pi}{2}\\right) = \\sqrt{\\frac{2}{L}} \\sin(k\\pi)\n$$\nFor any integer value of $k$, the sine function $\\sin(k\\pi)$ is identically zero.\n$$\n\\sin(k\\pi) = 0 \\quad \\text{for } k \\in \\mathbb{Z}\n$$\nThus, the value of the wavefunction at the center of the box is zero for all even quantum numbers $n$:\n$$\n\\psi_{n}^{(0)}\\left(\\frac{L}{2}\\right) = 0 \\quad \\text{for even } n\n$$\nThis is consistent with the problem statement that the perturbation is located at a node of the wavefunction. Substituting this result back into the expression for the first-order energy correction:\n$$\nE_{n}^{(1)} = \\alpha \\left( 0 \\right)^{2} = 0\n$$\nThe first-order correction to the energy is exactly zero. This result is physically intuitive: the first-order correction is the expectation value of the perturbing potential. If the probability of finding the particle at the location of the perturbation is zero (i.e., at a node of the wavefunction, where $|\\psi^{(0)}|^2=0$), the particle does not \"feel\" the perturbation to first order, and its energy remains unchanged at this level of approximation. The problem asks for the answer in Joules, and $0$ Joules is a precise and valid answer.", "answer": "$$\n\\boxed{0}\n$$"}, {"introduction": "This final practice bridges the gap between analytical theory and modern computational chemistry by asking you to write a program to test the limits of perturbation theory. You will compare the energy levels predicted by perturbation theory up to second order against the exact numerical solution for a multi-level system. By analyzing scenarios including near-degeneracy and strong coupling [@problem_id:2459557], this exercise provides critical, practical experience in understanding the accuracy and domain of applicability of this essential approximation method.", "id": "2459557", "problem": "You are given a time-independent three-level quantum system used in computational chemistry modeling. Its Hamiltonian is defined as $H(\\lambda) = H_0 + \\lambda V$, where $H_0$ is a diagonal matrix with distinct real entries, $V$ is a real symmetric matrix, and $\\lambda$ is a real scalar parameter. Assume the system is non-degenerate at $\\lambda=0$, meaning the eigenvalues of $H_0$ are all distinct. All energies are dimensionless; do not include units.\n\nYour task is to write a complete program that, for each specified test case:\n- Computes the exact energies as the eigenvalues of $H(\\lambda)$.\n- Computes the energies predicted by non-degenerate perturbation theory up to and including second order for each unperturbed state.\n- Compares the two sets by associating each perturbative energy to exactly one exact energy in a way that minimizes the total absolute deviation across the three states, and then returns the largest absolute deviation over the three associated pairs.\n- Reports, for each test case, a single float equal to this largest absolute deviation, rounded to $10$ decimal places.\n\nUse the following test suite. For each case, $H_0 = \\mathrm{diag}(E_1^{(0)}, E_2^{(0)}, E_3^{(0)})$ and $V = (v_{ij})$ with $v_{ij} = v_{ji}$.\n\nTest case $1$ (general case):\n- $E^{(0)} = (0, 1, 2)$\n- $V = \\begin{pmatrix} 0.20 & 0.05 & -0.02 \\\\ 0.05 & -0.10 & 0.03 \\\\ -0.02 & 0.03 & 0.05 \\end{pmatrix}$\n- $\\lambda = 0.10$\n\nTest case $2$ (boundary case with zero coupling):\n- $E^{(0)} = (0, 1, 2)$\n- $V = \\begin{pmatrix} 0.20 & 0.05 & -0.02 \\\\ 0.05 & -0.10 & 0.03 \\\\ -0.02 & 0.03 & 0.05 \\end{pmatrix}$\n- $\\lambda = 0$\n\nTest case $3$ (diagonal perturbation only):\n- $E^{(0)} = (0, 1, 2)$\n- $V = \\begin{pmatrix} 0.30 & 0 & 0 \\\\ 0 & -0.20 & 0 \\\\ 0 & 0 & 0.10 \\end{pmatrix}$\n- $\\lambda = 0.30$\n\nTest case $4$ (near-degenerate unperturbed spectrum):\n- $E^{(0)} = (0, 0.001, 1)$\n- $V = \\begin{pmatrix} 0.01 & 0.02 & -0.01 \\\\ 0.02 & -0.02 & 0.015 \\\\ -0.01 & 0.015 & 0.005 \\end{pmatrix}$\n- $\\lambda = 0.05$\n\nTest case $5$ (stronger coupling stress test):\n- $E^{(0)} = (0, 1, 3)$\n- $V = \\begin{pmatrix} 0 & 0.20 & 0.10 \\\\ 0.20 & 0 & -0.15 \\\\ 0.10 & -0.15 & 0.25 \\end{pmatrix}$\n- $\\lambda = 0.50$\n\nFor each test case, define the largest absolute deviation as follows. Let the exact energies be the three eigenvalues of $H(\\lambda)$, and let the perturbative energies be the three second-order non-degenerate perturbation theory predictions labeled by the unperturbed levels $n \\in \\{1,2,3\\}$. Determine a one-to-one association between the three perturbative energies and the three exact energies that minimizes the sum of absolute deviations. Then take the maximum absolute deviation across the three associated pairs. Round this maximum absolute deviation to $10$ decimal places to produce the single float result for that test case.\n\nFinal output format: Your program should produce a single line of output containing the results for the five test cases as a comma-separated list enclosed in square brackets, with no spaces, and each float rounded to exactly $10$ decimal places (e.g., \"[$0.0000000000,0.1234567890,0.0000000000,0.0000123456,0.0012345678$]\").", "solution": "The problem presented is a standard exercise in computational quantum chemistry, specifically concerning the application and validation of time-independent, non-degenerate perturbation theory. The problem is well-posed, scientifically sound, and contains all necessary information for a unique solution. We shall proceed with a rigorous derivation and computational strategy.\n\nThe system is described by a Hamiltonian $H(\\lambda) = H_0 + \\lambda V$, where $H_0$ is the unperturbed Hamiltonian and $\\lambda V$ is the perturbation. The unperturbed Hamiltonian $H_0$ is diagonal in the given basis, with its eigenvalues being the unperturbed energies $E_n^{(0)}$ and its eigenvectors $|n^{(0)}\\rangle$ being the standard basis vectors. For a $3$-level system, we have:\n$$ H_0 = \\begin{pmatrix} E_1^{(0)} & 0 & 0 \\\\ 0 & E_2^{(0)} & 0 \\\\ 0 & 0 & E_3^{(0)} \\end{pmatrix} $$\nThe corresponding unperturbed eigenvectors are $|1^{(0)}\\rangle = (1, 0, 0)^T$, $|2^{(0)}\\rangle = (0, 1, 0)^T$, and $|3^{(0)}\\rangle = (0, 0, 1)^T$. The problem statement guarantees that the unperturbed energies $E_1^{(0)}$, $E_2^{(0)}$, and $E_3^{(0)}$ are distinct, satisfying the condition for non-degenerate perturbation theory.\n\nOur task involves two primary calculations for each test case:\n$1$. The exact energies of the full Hamiltonian $H(\\lambda)$.\n$2$. The approximate energies predicted by non-degenerate perturbation theory up to the second order.\n\n**1. Exact Energy Calculation**\n\nThe full Hamiltonian is the matrix sum $H(\\lambda) = H_0 + \\lambda V$. Since $H_0$ is diagonal and $V$ is a real symmetric matrix, $H(\\lambda)$ is also a real symmetric matrix. The exact energies of the system are the eigenvalues of this matrix. For a given test case with specified $E^{(0)}$, $V$, and $\\lambda$, we construct the $3 \\times 3$ matrix $H(\\lambda)$ and compute its eigenvalues. This is a standard numerical linear algebra problem, readily solved by diagonalizing the matrix. The set of three eigenvalues will be denoted $\\{E_{\\text{exact},i}\\}$.\n\n**2. Perturbative Energy Calculation**\n\nNon-degenerate perturbation theory provides a series expansion for the energy eigenvalues $E_n$ and eigenstates in powers of the perturbation parameter $\\lambda$. The energy $E_n$ corresponding to the unperturbed level $E_n^{(0)}$ is given by:\n$$ E_n(\\lambda) = E_n^{(0)} + \\lambda E_n^{(1)} + \\lambda^2 E_n^{(2)} + O(\\lambda^3) $$\nThe problem requires calculation up to the second order.\n\nThe first-order correction to the energy, $E_n^{(1)}$, is the expectation value of the perturbation potential $V$ in the unperturbed state $|n^{(0)}\\rangle$:\n$$ E_n^{(1)} = \\langle n^{(0)} | V | n^{(0)} \\rangle = V_{nn} $$\nwhere $V_{nn}$ is the $n$-th diagonal element of the matrix $V$.\n\nThe second-order correction to the energy, $E_n^{(2)}$, involves matrix elements of $V$ between different unperturbed states:\n$$ E_n^{(2)} = \\sum_{k \\neq n} \\frac{|\\langle k^{(0)} | V | n^{(0)} \\rangle|^2}{E_n^{(0)} - E_k^{(0)}} = \\sum_{k \\neq n} \\frac{|V_{kn}|^2}{E_n^{(0)} - E_k^{(0)}} $$\nwhere $V_{kn}$ are the off-diagonal elements of $V$. The denominator $E_n^{(0)} - E_k^{(0)}$ is non-zero due to the non-degeneracy condition.\n\nThe total approximate energy for the $n$-th level, up to second order, is therefore:\n$$ E_{n, \\text{pert}} = E_n^{(0)} + \\lambda V_{nn} + \\lambda^2 \\sum_{k \\neq n} \\frac{|V_{kn}|^2}{E_n^{(0)} - E_k^{(0)}} $$\nWe compute this value for each of the three unperturbed levels, $n \\in \\{1, 2, 3\\}$, to obtain the set of three perturbative energies $\\{E_{n, \\text{pert}}\\}$.\n\n**3. Comparison and Deviation Analysis**\n\nTo compare the exact energies $\\{E_{\\text{exact},i}\\}$ with the perturbative energies $\\{E_{n, \\text{pert}}\\}$, we must find the optimal pairing between the two sets. The problem defines this as the one-to-one association that minimizes the sum of absolute deviations. For two sets of real numbers, this minimum is achieved by sorting both sets in ascending order and pairing corresponding elements. Let the sorted exact energies be $E'_{\\text{exact},1} \\le E'_{\\text{exact},2} \\le E'_{\\text{exact},3}$ and the sorted perturbative energies be $E'_{\\text{pert},1} \\le E'_{\\text{pert},2} \\le E'_{\\text{pert},3}$. The optimal pairing is $(E'_{\\text{exact},i}, E'_{\\text{pert},i})$ for $i=1, 2, 3$.\n\nThe absolute deviation for each pair is $\\Delta_i = |E'_{\\text{exact},i} - E'_{\\text{pert},i}|$. The final quantity to be reported for each test case is the maximum of these deviations:\n$$ \\text{Max Deviation} = \\max(\\Delta_1, \\Delta_2, \\Delta_3) $$\n\nThis procedure will be implemented for each of the five test cases provided. The numerical calculations will be performed using standard matrix libraries, and the final results will be formatted as specified. For cases where $\\lambda=0$ or $V$ is diagonal, we expect the deviation to be zero, as perturbation theory becomes exact under these conditions. Cases with near-degenerate unperturbed energies or large $\\lambda$ values serve to test the limits of the perturbative approximation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry problem for a series of test cases.\n    For each case, it computes exact vs. second-order perturbative energies,\n    and finds the maximum absolute deviation between optimally paired results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (unperturbed energies E0, perturbation matrix V, parameter lambda)\n    test_cases = [\n        # Test case 1 (general case)\n        (\n            [0.0, 1.0, 2.0],\n            [[0.20, 0.05, -0.02], [0.05, -0.10, 0.03], [-0.02, 0.03, 0.05]],\n            0.10,\n        ),\n        # Test case 2 (boundary case with zero coupling)\n        (\n            [0.0, 1.0, 2.0],\n            [[0.20, 0.05, -0.02], [0.05, -0.10, 0.03], [-0.02, 0.03, 0.05]],\n            0.0,\n        ),\n        # Test case 3 (diagonal perturbation only)\n        (\n            [0.0, 1.0, 2.0],\n            [[0.30, 0.0, 0.0], [0.0, -0.20, 0.0], [0.0, 0.0, 0.10]],\n            0.30,\n        ),\n        # Test case 4 (near-degenerate unperturbed spectrum)\n        (\n            [0.0, 0.001, 1.0],\n            [[0.01, 0.02, -0.01], [0.02, -0.02, 0.015], [-0.01, 0.015, 0.005]],\n            0.05,\n        ),\n        # Test case 5 (stronger coupling stress test)\n        (\n            [0.0, 1.0, 3.0],\n            [[0.0, 0.20, 0.10], [0.20, 0.0, -0.15], [0.10, -0.15, 0.25]],\n            0.50,\n        ),\n    ]\n\n    results = []\n    for E0_diag, V_matrix, lam in test_cases:\n        # Convert inputs to numpy arrays for calculation\n        E0 = np.array(E0_diag)\n        V = np.array(V_matrix)\n        n_levels = len(E0)\n\n        # 1. Exact Energy Calculation\n        # Construct the unperturbed Hamiltonian H0 and the full Hamiltonian H\n        H0 = np.diag(E0)\n        H_full = H0 + lam * V\n        # Compute the exact eigenvalues of the full Hamiltonian.\n        # np.linalg.eigh is used for Hermitian matrices and returns sorted eigenvalues.\n        exact_energies = np.linalg.eigh(H_full)[0]\n\n        # 2. Perturbative Energy Calculation\n        pert_energies = np.zeros(n_levels)\n        for n in range(n_levels):\n            # Zeroth-order energy\n            E_n_0 = E0[n]\n\n            # First-order energy correction coefficient\n            E_n_1 = V[n, n]\n\n            # Second-order energy correction coefficient\n            E_n_2 = 0.0\n            for k in range(n_levels):\n                if k == n:\n                    continue\n                # The denominator is guaranteed non-zero by problem statement\n                denominator = E_n_0 - E0[k]\n                # V is real and symmetric, so V_kn = V_nk\n                numerator = V[k, n] ** 2\n                E_n_2 += numerator / denominator\n\n            # Total energy up to second order in lambda\n            pert_energies[n] = E_n_0 + lam * E_n_1 + (lam ** 2) * E_n_2\n\n        # 3. Comparison and Deviation Analysis\n        # To find the optimal pairing that minimizes the sum of absolute deviations,\n        # we sort both sets of energies and pair them element-wise.\n        # `exact_energies` is already sorted by `eigh`. We must sort `pert_energies`.\n        pert_energies.sort()\n\n        # Calculate the absolute deviations for the optimal pairing\n        deviations = np.abs(exact_energies - pert_energies)\n\n        # The result for this case is the largest absolute deviation\n        max_deviation = np.max(deviations)\n        results.append(f\"{max_deviation:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n\nsolve()\n```"}]}