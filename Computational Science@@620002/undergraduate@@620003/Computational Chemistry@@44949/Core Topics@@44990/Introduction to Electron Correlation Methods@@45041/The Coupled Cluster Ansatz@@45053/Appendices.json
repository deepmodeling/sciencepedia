{"hands_on_practices": [{"introduction": "Before diving into complex calculations, it is essential to understand the formal structure of the theories we use. This practice guides you through the process of deconstructing the Coupled Cluster (CC) and Full Configuration Interaction (FCI) wavefunctions for a simple, four-electron system. By systematically counting the number of parameters, or amplitudes, for different levels of CC theory [@problem_id:2464079], you will develop a concrete understanding of why these methods form a hierarchy and how their computational cost scales so dramatically with the desired accuracy.", "problem": "Consider the Beryllium atom treated in a spin-orbital basis with a closed-shell restricted Hartree–Fock reference determinant denoted by $|\\Phi_{0}\\rangle$. Let the total number of electrons be $N=4$, the number of occupied spin-orbitals in the reference be $n_{o}=4$, and the number of virtual spin-orbitals be $n_{v}=L-4$, where $L$ is the total number of spin-orbitals in the one-electron basis. Work at the spin-orbital level (not spin-adapted), and assume that all spin-orbitals are orthonormal.\n\n1) Using the definition of Configuration Interaction (CI), write schematically the Full Configuration Interaction (FCI) wave function for this $N=4$ system as a linear combination of Slater determinants built from $|\\Phi_{0}\\rangle$ by exciting electrons from occupied to virtual spin-orbitals. Your schematic expression should make explicit the excitation ranks and the associated index structure up to the maximum excitation rank allowed by $N=4$.\n\n2) Using the definition of the Coupled Cluster (CC) ansatz $|\\Psi\\rangle=\\exp(T)|\\Phi_{0}\\rangle$ with the cluster operator $T=T_{1}+T_{2}+T_{3}+T_{4}$, identify which excitation manifolds are retained in Coupled Cluster with Singles and Doubles (CCSD), in Coupled Cluster with Singles, Doubles, and Triples (CCSDT), and in Coupled Cluster with Singles, Doubles, Triples, and Quadruples (CCSDTQ), for this $N=4$ system.\n\n3) By first-principles counting of independent antisymmetrized amplitudes in the spin-orbital representation, derive closed-form expressions, in terms of $n_{v}$, for the total number of independent cluster amplitudes included in each of CCSD, CCSDT, and CCSDTQ for this Be system. Report your final result as a single row vector $\\big(N_{\\mathrm{CCSD}},\\,N_{\\mathrm{CCSDT}},\\,N_{\\mathrm{CCSDTQ}}\\big)$, where each entry is a closed-form analytic expression in $n_{v}$. Express your final answer without units. If you assume any constraint on $n_{v}$, state it clearly; your expressions must remain algebraically valid for any integer $n_{v}\\ge 0$.", "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically grounded, well-posed, and objective. It presents a standard, solvable problem in theoretical and computational chemistry, free of contradictions or ambiguities. We shall proceed with a complete solution.\n\nThe problem considers a Beryllium atom with $N=4$ electrons. The reference state $|\\Phi_{0}\\rangle$ is the ground-state Hartree-Fock determinant, which has $n_{o}=4$ occupied spin-orbitals. We denote the set of occupied spin-orbital indices as $\\{i, j, k, l, \\dots\\}$ and the set of virtual spin-orbital indices as $\\{a, b, c, d, \\dots\\}$. The number of virtual spin-orbitals is $n_{v}$.\n\n**1) Full Configuration Interaction (FCI) Wave Function**\n\nThe Full Configuration Interaction (FCI) wave function, $|\\Psi_{\\text{FCI}}\\rangle$, is the exact solution to the non-relativistic Schrödinger equation within the given one-electron basis set. It is constructed as a linear combination of all possible Slater determinants that can be formed by distributing the $N$ electrons among the available spin-orbitals. For an $N$-electron system, this expansion can be organized by excitation rank relative to the reference determinant $|\\Phi_{0}\\rangle$. The maximum possible excitation rank is $N$.\n\nFor the present system with $N=4$, the FCI wave function includes the reference determinant (zero excitations), and all singly, doubly, triply, and quadruply excited determinants. Let $|\\Phi_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}\\rangle$ denote a Slater determinant where electrons from occupied spin-orbitals $\\{i_{1}, \\dots, i_{k}\\}$ have been promoted to virtual spin-orbitals $\\{a_{1}, \\dots, a_{k}\\}$. The FCI wave function is written schematically as:\n$$\n|\\Psi_{\\text{FCI}}\\rangle = c_{0}|\\Phi_{0}\\rangle + \\sum_{k=1}^{N} |\\Psi_{k}\\rangle\n$$\nwhere $|\\Psi_{k}\\rangle$ represents the contribution from all $k$-tuply excited configurations. For $N=4$, this becomes:\n$$\n|\\Psi_{\\text{FCI}}\\rangle = c_{0}|\\Phi_{0}\\rangle + \\sum_{i,a} c_{i}^{a} |\\Phi_{i}^{a}\\rangle + \\sum_{\\substack{i<j \\\\ a<b}} c_{ij}^{ab} |\\Phi_{ij}^{ab}\\rangle + \\sum_{\\substack{i<j<k \\\\ a<b<c}} c_{ijk}^{abc} |\\Phi_{ijk}^{abc}\\rangle + \\sum_{\\substack{i<j<k<l \\\\ a<b<c<d}} c_{ijkl}^{abcd} |\\Phi_{ijkl}^{abcd}\\rangle\n$$\nThe summation indices $i,j,k,l$ run over the $n_{o}=4$ occupied spin-orbitals, and the indices $a,b,c,d$ run over the $n_{v}$ virtual spin-orbitals. The ordered summation indices ensure that each distinct determinant is included only once. Since $n_{o}=4$, the final summation over $i<j<k<l$ has only one term for the occupied indices, which corresponds to exciting all four electrons from the occupied space.\n\n**2) Excitation Manifolds in Coupled Cluster (CC) Theory**\n\nThe Coupled Cluster (CC) wave function is defined by the ansatz $|\\Psi_{\\text{CC}}\\rangle = \\exp(T)|\\Phi_{0}\\rangle$, where the cluster operator $T$ is a sum of excitation operators:\n$$\nT = T_{1} + T_{2} + T_{3} + \\dots + T_{N}\n$$\nThe operator $T_{k}$ creates all $k$-tuple excitations from the reference determinant:\n$$\nT_{k} = \\sum_{\\substack{i_{1}<\\dots<i_{k} \\\\ a_{1}<\\dots<a_{k}}} t_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}} \\hat{\\tau}_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}\n$$\nwhere $t_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}$ are the cluster amplitudes and $\\hat{\\tau}_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}$ is the corresponding excitation operator. Approximations to the exact CC theory (which is equivalent to FCI) are made by truncating the cluster operator $T$.\n\n-   **Coupled Cluster with Singles and Doubles (CCSD):** In this method, the cluster operator is truncated to include only single and double excitations: $T \\approx T_{\\text{CCSD}} = T_{1} + T_{2}$. Therefore, the excitation manifolds *retained in the cluster operator* are those of singles and doubles. It is crucial to note that the resulting CCSD wave function, $|\\Psi_{\\text{CCSD}}\\rangle = \\exp(T_{1}+T_{2})|\\Phi_{0}\\rangle$, contains contributions from higher-than-double excitations due to the exponential form (e.g., $\\frac{1}{2}T_{2}^{2}|\\Phi_{0}\\rangle$ generates quadruply excited determinants).\n\n-   **Coupled Cluster with Singles, Doubles, and Triples (CCSDT):** Here, the cluster operator is truncated at triple excitations: $T \\approx T_{\\text{CCSDT}} = T_{1} + T_{2} + T_{3}$. The retained manifolds in the operator are singles, doubles, and triples.\n\n-   **Coupled Cluster with Singles, Doubles, Triples, and Quadruples (CCSDTQ):** This model includes up to quadruple excitations in the cluster operator: $T \\approx T_{\\text{CCSDTQ}} = T_{1} + T_{2} + T_{3} + T_{4}$. For an $N=4$ electron system, this is the highest possible excitation level, so CCSDTQ is equivalent to FCI. The retained manifolds in the operator are singles, doubles, triples, and quadruples.\n\n**3) Number of Independent Cluster Amplitudes**\n\nThe number of independent, non-redundant cluster amplitudes for the $T_k$ operator, in a spin-orbital formulation, is determined by the number of ways to choose $k$ distinct occupied spin-orbitals from a set of $n_{o}$ and $k$ distinct virtual spin-orbitals from a set of $n_{v}$. This is a standard combinatorial calculation given by the product of two binomial coefficients:\n$$\nN_{k} = \\binom{n_{o}}{k} \\binom{n_{v}}{k}\n$$\nThe problem specifies $n_{o}=4$. The derived expressions must be valid for any non-negative integer $n_{v}$. The binomial coefficient $\\binom{n}{k}$ is zero if $k>n$, a property that our final polynomial expressions will inherently respect.\n\nThe number of amplitudes for each excitation level is:\n-   Singles ($T_{1}$): $N_{1} = \\binom{4}{1} \\binom{n_{v}}{1} = 4 \\cdot n_{v} = 4n_{v}$\n-   Doubles ($T_{2}$): $N_{2} = \\binom{4}{2} \\binom{n_{v}}{2} = \\frac{4 \\cdot 3}{2} \\cdot \\frac{n_{v}(n_{v}-1)}{2} = 6 \\cdot \\frac{n_{v}^{2}-n_{v}}{2} = 3(n_{v}^{2}-n_{v})$\n-   Triples ($T_{3}$): $N_{3} = \\binom{4}{3} \\binom{n_{v}}{3} = 4 \\cdot \\frac{n_{v}(n_{v}-1)(n_{v}-2)}{6} = \\frac{2}{3} n_{v}(n_{v}-1)(n_{v}-2)$\n-   Quadruples ($T_{4}$): $N_{4} = \\binom{4}{4} \\binom{n_{v}}{4} = 1 \\cdot \\frac{n_{v}(n_{v}-1)(n_{v}-2)(n_{v}-3)}{24} = \\frac{1}{24} n_{v}(n_{v}-1)(n_{v}-2)(n_{v}-3)$\n\nThe total number of amplitudes for each CC method is the sum of the counts for the included excitation levels.\n\n-   **Total Amplitudes in CCSD ($N_{\\mathrm{CCSD}}$):**\n$$\nN_{\\mathrm{CCSD}} = N_{1} + N_{2} = 4n_{v} + 3(n_{v}^{2}-n_{v}) = 4n_{v} + 3n_{v}^{2} - 3n_{v} = 3n_{v}^{2} + n_{v} = n_{v}(3n_{v}+1)\n$$\n\n-   **Total Amplitudes in CCSDT ($N_{\\mathrm{CCSDT}}$):**\n$$\nN_{\\mathrm{CCSDT}} = N_{\\mathrm{CCSD}} + N_{3} = (3n_{v}^{2} + n_{v}) + \\frac{2}{3} (n_{v}^{3} - 3n_{v}^{2} + 2n_{v})\n$$\n$$\nN_{\\mathrm{CCSDT}} = \\frac{2}{3}n_{v}^{3} + (3-2)n_{v}^{2} + (1+\\frac{4}{3})n_{v} = \\frac{2}{3}n_{v}^{3} + n_{v}^{2} + \\frac{7}{3}n_{v} = \\frac{n_{v}}{3}(2n_{v}^{2} + 3n_{v} + 7)\n$$\n\n-   **Total Amplitudes in CCSDTQ ($N_{\\mathrm{CCSDTQ}}$):**\n$$\nN_{\\mathrm{CCSDTQ}} = N_{\\mathrm{CCSDT}} + N_{4} = \\left(\\frac{2}{3}n_{v}^{3} + n_{v}^{2} + \\frac{7}{3}n_{v}\\right) + \\frac{1}{24}(n_{v}^{4} - 6n_{v}^{3} + 11n_{v}^{2} - 6n_{v})\n$$\n$$\nN_{\\mathrm{CCSDTQ}} = \\frac{1}{24}n_{v}^{4} + \\left(\\frac{16}{24}-\\frac{6}{24}\\right)n_{v}^{3} + \\left(\\frac{24}{24}+\\frac{11}{24}\\right)n_{v}^{2} + \\left(\\frac{56}{24}-\\frac{6}{24}\\right)n_{v}\n$$\n$$\nN_{\\mathrm{CCSDTQ}} = \\frac{1}{24}n_{v}^{4} + \\frac{10}{24}n_{v}^{3} + \\frac{35}{24}n_{v}^{2} + \\frac{50}{24}n_{v} = \\frac{n_{v}}{24}(n_{v}^{3} + 10n_{v}^{2} + 35n_{v} + 50)\n$$\n\nThe final results are presented as a row vector as requested.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nn_{v}(3n_{v} + 1) & \\frac{n_{v}}{3}(2n_{v}^{2} + 3n_{v} + 7) & \\frac{n_{v}}{24}(n_{v}^{3} + 10n_{v}^{2} + 35n_{v} + 50)\n\\end{pmatrix}\n}\n$$", "id": "2464079"}, {"introduction": "A core part of becoming a scientist is learning to critically evaluate results and question assumptions. This exercise presents a common but challenging scenario where a seemingly 'better' result, such as a lower total energy, may not indicate a more accurate method [@problem_id:2452131]. By analyzing the fundamental differences between Configuration Interaction (CI) and Coupled Cluster (CC) theories, you will explore the crucial concepts of variational principles and size-extensivity, which are key to understanding the predictive power and reliability of modern electronic structure methods.", "problem": "A new graduate student reports that their Configuration Interaction singles and doubles (CISD) implementation consistently yields a ground-state total energy that is lower (more negative) than the lab’s Coupled Cluster with singles and doubles (CCSD) program for several weakly correlated, closed-shell molecules. Both codes use the same Hartree–Fock (HF) reference determinant, the same finite orbital basis, and comparable numerical thresholds, and both calculations have converged. The student concludes that CISD is the more accurate method because it gives a lower energy.\n\nWhich of the following statements best explain why the student’s conclusion is not necessarily justified? Select all that apply.\n\nA. The Coupled Cluster with singles and doubles (CCSD) energy is not guaranteed by the variational principle to be an upper bound to the exact ground-state energy, so it can lie above or below other approximate methods’ energies without implying higher or lower accuracy.\n\nB. Configuration Interaction singles and doubles (CISD) is not size-extensive and not size-consistent; its total energy does not scale correctly with system size and does not satisfy additivity for noninteracting fragments, so a lower CISD total energy for a given system does not imply better accuracy or broader predictive reliability.\n\nC. If both programs use the same reference and basis, the variational principle guarantees that the CISD energy must be lower than or equal to the CCSD energy, so the observation necessarily proves CISD is superior.\n\nD. The exponential ansatz in Coupled Cluster with singles and doubles (CCSD) generates disconnected higher excitations that effectively include some effects of triples and quadruples, which are absent in Configuration Interaction singles and doubles (CISD); therefore CCSD can yield more accurate correlation energies and energy differences even if its total energy happens to be higher than the CISD total energy in some cases.\n\nE. The only meaningful metric of method quality is the absolute total energy; lower total energy always indicates a more accurate method than any competitor using the same reference and basis.", "solution": "The problem statement describes a scenario in computational chemistry and asks for a critical evaluation of a conclusion drawn from numerical results. The setup is scientifically sound and well-posed, providing a basis for a rigorous analysis of quantum chemical methods.\n\nThe student's fundamental error is concluding from the observation $E_{\\text{CISD}} < E_{\\text{CCSD}}$ that the Configuration Interaction with singles and doubles (CISD) method is more accurate than the Coupled Cluster with singles and doubles (CCSD) method. This conclusion is based on an incorrect application of the variational principle and a misunderstanding of what constitutes \"accuracy\" in quantum chemistry.\n\nLet us analyze the theoretical foundations of both methods to expose the flaws in the student's reasoning. Both methods start from a Hartree-Fock reference determinant, $\\Phi_0$, and aim to approximate the exact ground-state solution to the electronic Schrödinger equation within a given one-particle basis set, a problem known as full configuration interaction (FCI).\n\nThe CISD wavefunction is a linear combination of the reference determinant and all singly and doubly excited Slater determinants:\n$$ |\\Psi_{\\text{CISD}}\\rangle = c_0 |\\Phi_0\\rangle + \\sum_{i,a} c_i^a |\\Phi_i^a\\rangle + \\sum_{i<j, a<b} c_{ij}^{ab} |\\Phi_{ij}^{ab}\\rangle $$\nThe coefficients $c_0$, $c_i^a$, and $c_{ij}^{ab}$ are determined by solving a matrix eigenvalue problem, which is equivalent to minimizing the energy expectation value $\\langle\\Psi_{\\text{CISD}} | \\hat{H} | \\Psi_{\\text{CISD}}\\rangle / \\langle\\Psi_{\\text{CISD}} | \\Psi_{\\text{CISD}}\\rangle$. By the variational principle, the resulting energy, $E_{\\text{CISD}}$, is an upper bound to the exact FCI energy, $E_{\\text{FCI}}$, for the given basis set: $E_{\\text{CISD}} \\ge E_{\\text{FCI}}$. Thus, CISD is a variational method.\n\nThe CCSD wavefunction has an exponential ansatz:\n$$ |\\Psi_{\\text{CCSD}}\\rangle = e^{\\hat{T}} |\\Phi_0\\rangle $$\nwhere the cluster operator $\\hat{T}$ is restricted to single and double excitations: $\\hat{T} = \\hat{T}_1 + \\hat{T}_2$. The cluster operators are given by:\n$$ \\hat{T}_1 = \\sum_{i,a} t_i^a \\hat{a}_a^\\dagger \\hat{a}_i $$\n$$ \\hat{T}_2 = \\sum_{i<j, a<b} t_{ij}^{ab} \\hat{a}_a^\\dagger \\hat{a}_b^\\dagger \\hat{a}_j \\hat{a}_i $$\nThe energy $E_{\\text{CCSD}}$ and the amplitudes $t_i^a$ and $t_{ij}^{ab}$ are found by solving a set of non-linear equations derived by projecting the Schrödinger equation onto the reference, singly excited, and doubly excited determinants:\n$$ E_{\\text{CCSD}} = \\langle\\Phi_0| e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} |\\Phi_0\\rangle $$\n$$ \\langle\\Phi_i^a| e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} |\\Phi_0\\rangle = 0 $$\n$$ \\langle\\Phi_{ij}^{ab}| e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} |\\Phi_0\\rangle = 0 $$\nThis projection procedure does not correspond to minimizing an energy expectation value. Consequently, the CCSD method is **not** variational. The CCSD energy, $E_{\\text{CCSD}}$, is not guaranteed to be an upper bound to the FCI energy, $E_{\\text{FCI}}$. It is therefore possible for $E_{\\text{CCSD}}$ to be greater than, or in some cases even less than, $E_{\\text{FCI}}$. More relevant to the current problem, one cannot directly compare $E_{\\text{CISD}}$ and $E_{\\text{CCSD}}$ using the simple rule \"lower energy is better,\" because this rule is only meaningful when comparing two variational methods.\n\nWith this foundation, we evaluate each statement.\n\n**A. The Coupled Cluster with singles and doubles (CCSD) energy is not guaranteed by the variational principle to be an upper bound to the exact ground-state energy, so it can lie above or below other approximate methods’ energies without implying higher or lower accuracy.**\nThis statement is factually correct. As derived above, CCSD is a projective method, not a variational one. Its energy is not an upper bound to the exact energy $E_{\\text{FCI}}$. Therefore, the fact that $E_{\\text{CCSD}}$ from the lab's program is higher than the student's $E_{\\text{CISD}}$ is not, in itself, an indication of lower accuracy. This statement correctly identifies a primary flaw in the student's simplistic interpretation of the results.\n**Verdict: Correct**\n\n**B. Configuration Interaction singles and doubles (CISD) is not size-extensive and not size-consistent; its total energy does not scale correctly with system size and does not satisfy additivity for noninteracting fragments, so a lower CISD total energy for a given system does not imply better accuracy or broader predictive reliability.**\nThis statement is also factually correct and points to a critical deficiency of the CISD method. Size-extensivity requires that the energy of a system of $N$ non-interacting identical subsystems be $N$ times the energy of a single subsystem. Truncated CI methods like CISD fail this test. For example, for two non-interacting molecules A and B, $E_{\\text{CISD}}(A+B) \\neq E_{\\text{CISD}}(A) + E_{\\text{CISD}}(B)$. This unphysical scaling makes CISD unreliable for describing bond dissociation, intermolecular interactions, and properties of larger systems. In contrast, CCSD is size-extensive. Therefore, even if CISD produces a lower total energy for a specific small molecule, this result does not imply that CISD is a more reliable or broadly applicable method. Predictive reliability is a more important metric of quality than the absolute energy of a single state.\n**Verdict: Correct**\n\n**C. If both programs use the same reference and basis, the variational principle guarantees that the CISD energy must be lower than or equal to the CCSD energy, so the observation necessarily proves CISD is superior.**\nThis statement is fundamentally incorrect. The variational principle makes no statement comparing a variational energy ($E_{\\text{CISD}}$) with a non-variational one ($E_{\\text{CCSD}}$). There is no theorem that guarantees $E_{\\text{CISD}} \\le E_{\\text{CCSD}}$ or $E_{\\text{CCSD}} \\le E_{\\text{CISD}}$. The premise is false. Moreover, the conclusion that the observation \"proves CISD is superior\" is precisely the student's flawed logic.\n**Verdict: Incorrect**\n\n**D. The exponential ansatz in Coupled Cluster with singles and doubles (CCSD) generates disconnected higher excitations that effectively include some effects of triples and quadruples, which are absent in Configuration Interaction singles and doubles (CISD); therefore CCSD can yield more accurate correlation energies and energy differences even if its total energy happens to be higher than the CISD total energy in some cases.**\nThis is an accurate and sophisticated explanation for the superior performance of CCSD. The Taylor expansion of the exponential operator $e^{\\hat{T}} = 1 + \\hat{T} + \\frac{1}{2!}\\hat{T}^2 + \\ldots$ reveals that products of cluster operators generate higher-level excitations from the reference. Specifically, terms like $\\frac{1}{2}\\hat{T}_2^2$ produce quadruple excitations, and $\\hat{T}_1 \\hat{T}_2$ produce triple excitations. These are so-called \"disconnected\" excitations, which are crucial for ensuring size-extensivity and capturing a larger portion of the electron correlation. The linear CISD wavefunction, by construction, contains no contributions from determinants with excitation levels higher than two. The inclusion of these important higher-order correlation effects is why CCSD is generally far more accurate for chemically relevant energy differences (e.g., reaction energies, activation barriers) than CISD, regardless of the relative ordering of their total energies in a single calculation.\n**Verdict: Correct**\n\n**E. The only meaningful metric of method quality is the absolute total energy; lower total energy always indicates a more accurate method than any competitor using the same reference and basis.**\nThis statement is a dangerous oversimplification and is patently false. First, as established, the \"lower is better\" heuristic is only applicable when comparing variational methods. Second, absolute total energies are rarely the quantities of chemical interest. Accuracy is more often judged by the ability to predict energy differences, molecular properties, and potential energy surfaces correctly. A method's quality also depends on formal properties like size-extensivity, which guarantee correct physical behavior. This statement reflects the student's naive premise, which is incorrect.\n**Verdict: Incorrect**\n\nIn summary, the student's conclusion is not justified because CCSD is non-variational, CISD is not size-extensive, and CCSD includes important higher-excitation effects absent in CISD. A lower total energy from CISD is not a reliable indicator of higher accuracy.", "answer": "$$\\boxed{ABD}$$", "id": "2452131"}, {"introduction": "This exercise bridges the gap between the abstract theory of the Coupled Cluster ansatz and its practical application to a chemical system. You will perform a simplified calculation of the double-excitation amplitudes, the famous `$t_2$` amplitudes, which are at the heart of capturing electron correlation effects [@problem_id:2464083]. Using data for a model of the water molecule, you will not only compute these values but also learn to interpret them physically, connecting the largest amplitude to chemically intuitive concepts like excitations from lone-pair or bonding orbitals.", "problem": "You are provided with a closed-shell reference for a water molecule represented in a small active space derived from a correlation-consistent polarized valence double-zeta basis. The coupled cluster ansatz for a closed-shell reference uses the exponential operator acting on a reference determinant, with the cluster operator truncated to the doubles sector, so that the wavefunction is written as $|\\Psi \\rangle = e^{T_2} |\\Phi_0 \\rangle$, where $T_2$ is the doubles cluster operator with amplitudes $t_{ij}^{ab}$. Consider canonical Hartree–Fock molecular orbitals, and assume linearization of the similarity-transformed Hamiltonian by neglecting terms of quadratic and higher order in the cluster amplitudes. Under these conditions, the projective equations for the doubles amplitudes reduce to a set of decoupled linear relations in the canonical basis that involve the occupied orbital indices $i,j$, virtual orbital indices $a,b$, orbital energies $\\varepsilon_p$, and antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$ in Hartree. The denominator for a doubles amplitude is defined as $D_{ij}^{ab} = \\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b$. The amplitudes $t_{ij}^{ab}$ are dimensionless.\n\nFor each test case below, you are given:\n- A list of orbital energies $\\varepsilon_p$ in Hartree for a set of orbitals indexed by integers, where the first two indices correspond to occupied orbitals $i,j$ and the remaining indices correspond to virtual orbitals $a,b$.\n- A set of nonzero antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$ in Hartree for unique index combinations with $i < j$ and $a < b$. Any integral not explicitly listed is zero.\n- For each orbital, auxiliary metadata consisting of a triplet of gross population weights on atoms $(\\mathrm{O}, \\mathrm{H}_1, \\mathrm{H}_2)$ that sum to one for occupied orbitals and approximately sum to one for virtual orbitals, and a scalar bonding indicator $b_p$ (dimensionless), positive for bonding character, negative for antibonding character, and near zero for nonbonding or Rydberg-like character.\n\nYour tasks for each test case are:\n1. Compute all doubles amplitudes $t_{ij}^{ab}$ using the linearized coupled cluster doubles equations in the canonical basis. For each unique combination with $i < j$ and $a < b$, compute the amplitude using the given data.\n2. Identify the single amplitude with the largest absolute value. In case of a tie, select the quadruple $(i,j,a,b)$ that is lexicographically smallest when compared as a 4-tuple of integers.\n3. Provide a physically motivated categorical interpretation of the selected excitation using the following rule-based classifier derived from the supplied orbital metadata:\n   - For an occupied orbital $p$, define its category $c_p^{\\mathrm{occ}}$ as:\n     - $1$ (lone pair) if $q_{\\mathrm{O}} \\geq 0.8$ and $\\lvert b_p \\rvert < 0.1$,\n     - $2$ (sigma bonding) if $b_p \\geq 0.2$,\n     - $0$ otherwise.\n   - For a virtual orbital $p$, define its category $c_p^{\\mathrm{virt}}$ as:\n     - $2$ (sigma antibonding) if $b_p \\leq -0.2$ and $q_{\\mathrm{O}} \\geq 0.45$ and $(q_{\\mathrm{H}_1} + q_{\\mathrm{H}_2}) \\geq 0.4$,\n     - $3$ (Rydberg-like) if $q_{\\mathrm{O}} \\geq 0.85$ and $\\lvert b_p \\rvert < 0.1$,\n     - $0$ otherwise.\n   - For an occupied pair $(i,j)$, define $c_{\\mathrm{occ}}$ by:\n     - If $c_i^{\\mathrm{occ}} = c_j^{\\mathrm{occ}} \\neq 0$, then $c_{\\mathrm{occ}} = c_i^{\\mathrm{occ}}$,\n     - Else if $\\{c_i^{\\mathrm{occ}}, c_j^{\\mathrm{occ}}\\} = \\{1,2\\}$, then $c_{\\mathrm{occ}} = 1$,\n     - Else $c_{\\mathrm{occ}} = 0$.\n   - For a virtual pair $(a,b)$, define $c_{\\mathrm{virt}}$ by:\n     - If $c_a^{\\mathrm{virt}} = c_b^{\\mathrm{virt}} \\neq 0$, then $c_{\\mathrm{virt}} = c_a^{\\mathrm{virt}}$,\n     - Else if $2 \\in \\{c_a^{\\mathrm{virt}}, c_b^{\\mathrm{virt}}\\}$, then $c_{\\mathrm{virt}} = 2$,\n     - Else $c_{\\mathrm{virt}} = 0$ if neither is $3$, or $c_{\\mathrm{virt}} = 3$ if both are $3$.\n   - Finally, map $(c_{\\mathrm{occ}}, c_{\\mathrm{virt}})$ to an interpretation code $\\kappa$ as:\n     - $(1,2) \\mapsto 12$ (lone-pair to sigma-antibonding),\n     - $(2,2) \\mapsto 22$ (sigma-bonding to sigma-antibonding),\n     - $(1,3) \\mapsto 13$ (lone-pair to Rydberg-like),\n     - Otherwise $\\mapsto 0$.\n\nUse the following test suite. In each case, orbital energies are in Hartree, two-electron integrals in Hartree, and the resulting doubles amplitudes are dimensionless.\n\nTest case A:\n- Orbital energies $\\varepsilon_p$: $[-0.571,\\,-0.450,\\,0.120,\\,0.250,\\,0.380]$ for $p = 0,1,2,3,4$, with occupied $i,j \\in \\{0,1\\}$ and virtual $a,b \\in \\{2,3,4\\}$.\n- Nonzero antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$ for unique index quadruples $(i,j,a,b)$ with $i < j$ and $a < b$:\n  - $(0,1,2,3): 0.085$,\n  - $(0,1,2,4): 0.092$,\n  - $(0,1,3,4): 0.078$.\n  All other such integrals are zero.\n- Orbital metadata $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2}; b_p)$ for $p = 0,1,2,3,4$:\n  - $p=0$: $(0.88,\\,0.06,\\,0.06;\\,0.02)$,\n  - $p=1$: $(0.65,\\,0.20,\\,0.15;\\,0.45)$,\n  - $p=2$: $(0.55,\\,0.24,\\,0.21;\\,-0.50)$,\n  - $p=3$: $(0.90,\\,0.05,\\,0.05;\\,-0.05)$,\n  - $p=4$: $(0.52,\\,0.23,\\,0.25;\\,-0.40)$.\n\nTest case B:\n- Orbital energies $\\varepsilon_p$: $[-0.500,\\,-0.500,\\,0.100,\\,0.100,\\,0.600]$ for $p = 0,1,2,3,4$, with occupied $i,j \\in \\{0,1\\}$ and virtual $a,b \\in \\{2,3,4\\}$.\n- Nonzero antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$:\n  - $(0,1,2,3): 0.060$,\n  - $(0,1,2,4): 0.085$,\n  - $(0,1,3,4): 0.085$.\n  All others are zero.\n- Orbital metadata $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2}; b_p)$ for $p = 0,1,2,3,4$:\n  - $p=0$: $(0.60,\\,0.20,\\,0.20;\\,0.40)$,\n  - $p=1$: $(0.62,\\,0.19,\\,0.19;\\,0.42)$,\n  - $p=2$: $(0.50,\\,0.25,\\,0.25;\\,-0.45)$,\n  - $p=3$: $(0.48,\\,0.26,\\,0.26;\\,-0.43)$,\n  - $p=4$: $(0.85,\\,0.10,\\,0.05;\\,0.00)$.\n\nTest case C:\n- Orbital energies $\\varepsilon_p$: $[-0.600,\\,-0.480,\\,0.150,\\,0.260,\\,0.500]$ for $p = 0,1,2,3,4$, with occupied $i,j \\in \\{0,1\\}$ and virtual $a,b \\in \\{2,3,4\\}$.\n- No nonzero antisymmetrized two-electron integrals are provided; treat all $\\langle ij \\Vert ab \\rangle$ as zero.\n- Orbital metadata $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2}; b_p)$ for $p = 0,1,2,3,4$:\n  - $p=0$: $(0.89,\\,0.06,\\,0.05;\\,0.01)$,\n  - $p=1$: $(0.86,\\,0.07,\\,0.07;\\,0.03)$,\n  - $p=2$: $(0.80,\\,0.10,\\,0.10;\\,-0.05)$,\n  - $p=3$: $(0.78,\\,0.11,\\,0.11;\\,-0.08)$,\n  - $p=4$: $(0.60,\\,0.20,\\,0.20;\\,-0.25)$.\n\nFor each test case, produce a result consisting of:\n- The largest absolute doubles amplitude value (dimensionless), rounded to six decimal places,\n- The corresponding quadruple of orbital indices $[i,j,a,b]$ with $i < j$ and $a < b$,\n- The interpretation code $\\kappa$ as defined above.\n\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is formatted as a list of the three items specified above without any spaces. For example: [[valueA,[iA,jA,aA,bA],kappaA],[valueB,[iB,jB,aB,bB],kappaB],[valueC,[iC,jC,aC,bC],kappaC]].", "solution": "The problem requires the calculation and interpretation of coupled cluster doubles amplitudes under a linearized approximation for a closed-shell reference system. This approach is equivalent to second-order Møller-Plesset perturbation theory (MP2). The solution proceeds by first validating the problem statement, which is found to be scientifically sound and well-posed, and then executing the required computational steps for each test case.\n\nThe core of the problem lies in computing the doubles cluster amplitudes, $t_{ij}^{ab}$. In the linearized approximation using a canonical Hartree-Fock basis, the coupled cluster amplitude equations decouple and simplify significantly. For a given excitation from a pair of occupied orbitals with indices $i, j$ to a pair of virtual orbitals with indices $a, b$, the amplitude $t_{ij}^{ab}$ is given by the expression:\n$$\nt_{ij}^{ab} = \\frac{\\langle ij \\Vert ab \\rangle}{D_{ij}^{ab}}\n$$\nwhere $\\langle ij \\Vert ab \\rangle$ is the antisymmetrized two-electron integral in physics notation, and $D_{ij}^{ab}$ is the orbital energy denominator defined as:\n$$\nD_{ij}^{ab} = \\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b\n$$\nHere, $\\varepsilon_p$ represents the energy of the canonical molecular orbital with index $p$. The indices $i, j$ are restricted to occupied orbitals, and $a, b$ to virtual orbitals. The amplitudes are computed for all unique index combinations satisfying the constraints $i < j$ and $a < b$. If an integral $\\langle ij \\Vert ab \\rangle$ is not provided, it is assumed to be zero, resulting in a zero amplitude.\n\nFor each test case, the following procedure is implemented:\n1.  All non-zero doubles amplitudes $t_{ij}^{ab}$ are calculated using the provided orbital energies $\\varepsilon_p$ and two-electron integrals $\\langle ij \\Vert ab \\rangle$.\n2.  The absolute values of these amplitudes, $|t_{ij}^{ab}|$, are compared to identify the single amplitude with the largest magnitude. In the event of a tie in magnitude, the tie is resolved by selecting the amplitude corresponding to the index quadruple $(i,j,a,b)$ that is lexicographically smallest.\n3.  Once the dominant amplitude and its associated quadruple $(i,j,a,b)$ are identified, a physical interpretation is derived using the provided orbital metadata, which includes gross atomic population weights $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2})$ and a bonding indicator $b_p$. This interpretation is determined by a rule-based classifier.\n\nThe classification proceeds in three stages:\nFirst, individual orbitals are categorized based on their metadata. An occupied orbital $p$ is classified by its category $c_p^{\\mathrm{occ}}$:\n- $c_p^{\\mathrm{occ}} = 1$ (lone pair) if $q_{\\mathrm{O}} \\geq 0.8$ and $|b_p| < 0.1$.\n- $c_p^{\\mathrm{occ}} = 2$ (sigma bonding) if $b_p \\geq 0.2$.\n- $c_p^{\\mathrm{occ}} = 0$ otherwise.\nA virtual orbital $p$ is classified by its category $c_p^{\\mathrm{virt}}$:\n- $c_p^{\\mathrm{virt}} = 2$ (sigma antibonding) if $b_p \\leq -0.2$, $q_{\\mathrm{O}} \\geq 0.45$, and $(q_{\\mathrm{H}_1} + q_{\\mathrm{H}_2}) \\geq 0.4$.\n- $c_p^{\\mathrm{virt}} = 3$ (Rydberg-like) if $q_{\\mathrm{O}} \\geq 0.85$ and $|b_p| < 0.1$.\n- $c_p^{\\mathrm{virt}} = 0$ otherwise.\n\nSecond, the orbital pairs $(i,j)$ and $(a,b)$ are classified. The occupied pair category $c_{\\mathrm{occ}}$ is determined from the individual categories $c_i^{\\mathrm{occ}}$ and $c_j^{\\mathrm{occ}}$:\n- If $c_i^{\\mathrm{occ}} = c_j^{\\mathrm{occ}} \\neq 0$, then $c_{\\mathrm{occ}} = c_i^{\\mathrm{occ}}$.\n- Else if $\\{c_i^{\\mathrm{occ}}, c_j^{\\mathrm{occ}}\\} = \\{1,2\\}$, then $c_{\\mathrm{occ}} = 1$.\n- Else $c_{\\mathrm{occ}} = 0$.\nThe virtual pair category $c_{\\mathrm{virt}}$ is determined from $c_a^{\\mathrm{virt}}$ and $c_b^{\\mathrm{virt}}$:\n- If $c_a^{\\mathrm{virt}} = c_b^{\\mathrm{virt}} \\neq 0$, then $c_{\\mathrm{virt}} = c_a^{\\mathrm{virt}}$.\n- Else if $2 \\in \\{c_a^{\\mathrm{virt}}, c_b^{\\mathrm{virt}}\\}$, then $c_{\\mathrm{virt}} = 2$.\n- Else $c_{\\mathrm{virt}} = 0$. This simplified rule is sufficient for the provided test cases as the ambiguous combinations not covered by the problem description do not occur.\n\nFinally, the pair of categories $(c_{\\mathrm{occ}}, c_{\\mathrm{virt}})$ is mapped to a final interpretation code $\\kappa$:\n- $(1,2) \\mapsto 12$\n- $(2,2) \\mapsto 22$\n- $(1,3) \\mapsto 13$\n- Otherwise $\\mapsto 0$.\n\nThis systematic process yields the required three-part result for each test case: the value of the largest absolute amplitude, its corresponding index quadruple, and its interpretation code.", "answer": "[[0.061107,[0,1,2,3],12],[0.050000,[0,1,2,3],22],[0.000000,[0,1,2,3],0]]", "id": "2464083"}]}