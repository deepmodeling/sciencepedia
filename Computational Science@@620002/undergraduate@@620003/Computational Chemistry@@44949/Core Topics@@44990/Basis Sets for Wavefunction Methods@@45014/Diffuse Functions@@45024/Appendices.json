{"hands_on_practices": [{"introduction": "To truly grasp the nature of diffuse functions, we begin with a foundational numerical experiment. This exercise guides you through determining the optimal 'diffuseness' of a basis function for the simplest anion, the hydrogen anion ($H^-$), by applying the variational principle. By minimizing the energy of this model system, you will uncover the mathematical and physical reasons why anions require basis functions with very small exponents and explore the critical conditions under which an extra electron can be bound to an atom [@problem_id:2454144].", "problem": "You are to design and execute a numerical experiment in atomic units to determine the optimal exponent of a single diffuse Gaussian-type orbital for a two-electron, one-center system at the Hartree-Fock level. Consider a closed-shell hydrogen anion model in which both electrons occupy the same spatial orbital. The spatial orbital is a single, normalized, primitive, $s$-type Gaussian-type orbital (GTO) centered at the origin with exponent $\\alpha$, given by $\\phi(\\mathbf{r};\\alpha)=N(\\alpha)\\exp(-\\alpha r^{2})$, where $N(\\alpha)$ is the normalization constant and $r=\\lVert \\mathbf{r}\\rVert$. Work entirely in atomic units, where the unit of length is the Bohr and the unit of energy is the Hartree. The nuclear charge is denoted by $Z$.\n\nDefine the one-electron operator $h=-\\frac{1}{2}\\nabla^{2}-\\frac{Z}{r}$ and the electron-electron repulsion operator $r_{12}^{-1}$. For a closed-shell system with a single doubly occupied spatial orbital, the Hartree-Fock total energy as a function of $\\alpha$ is\n$$\nE(\\alpha)=2\\langle\\phi|h|\\phi\\rangle+\\langle\\phi\\phi|r_{12}^{-1}|\\phi\\phi\\rangle,\n$$\nwith all integrals taken exactly over $\\mathbb{R}^{3}$, and where $\\phi$ denotes the normalized GTO defined above.\n\nYour task is to write a complete, runnable program that, for each specified nuclear charge $Z$, determines the value $\\alpha^{\\star}\\ge 0$ that minimizes $E(\\alpha)$ over $\\alpha>0$ and returns the corresponding minimum energy $E(\\alpha^{\\star})$. If no finite minimizer exists over $\\alpha>0$, report the infimum over $\\alpha\\ge 0$. Report $\\alpha^{\\star}$ in units of $\\text{Bohr}^{-2}$ and $E(\\alpha^{\\star})$ in Hartree. Round all reported floating-point numbers to $8$ decimal places.\n\nUse the following test suite of nuclear charges (dimensionless): $[1.0,\\,2.0,\\,\\frac{1}{2\\sqrt{2}},\\,0.6]$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list $[\\alpha^{\\star},E(\\alpha^{\\star})]$ in the same order as the test suite. For example, the output must look like\n$$\n[[a_{1},e_{1}],[a_{2},e_{2}],[a_{3},e_{3}],[a_{4},e_{4}]]\n$$\nwith each $a_{k}$ and $e_{k}$ rounded to $8$ decimal places and no additional characters or lines.", "solution": "The problem statement is scientifically sound and presents a standard exercise in applying the variational principle to a minimal basis set Hartree-Fock calculation for a two-electron atom.\n\n**Step 1: Derivation of the Energy Expression**\n\nThe total energy is given by $E(\\alpha) = 2h_{11}(\\alpha) + J_{11}(\\alpha)$, where $h_{11}(\\alpha) = \\langle\\phi|h|\\phi\\rangle$ is the one-electron integral and $J_{11}(\\alpha) = \\langle\\phi\\phi|r_{12}^{-1}|\\phi\\phi\\rangle$ is the two-electron Coulomb integral. The spatial orbital $\\phi(\\mathbf{r};\\alpha)$ is a normalized $s$-type GTO, with normalization constant $N(\\alpha) = (\\frac{2\\alpha}{\\pi})^{3/4}$.\n\nWe evaluate the integrals using standard formulas for $s$-type Gaussian functions in atomic units.\n1.  **Kinetic Energy Integral:**\n    $$T(\\alpha) = \\langle\\phi|-\\frac{1}{2}\\nabla^2|\\phi\\rangle = \\frac{3\\alpha}{2}$$\n2.  **Nuclear Attraction Integral:**\n    $$V_{ne}(\\alpha) = -Z\\langle\\phi|r^{-1}|\\phi\\rangle = -Z\\sqrt{\\frac{8\\alpha}{\\pi}} = -2Z\\sqrt{\\frac{2\\alpha}{\\pi}}$$\nThe one-electron integral is thus $h_{11}(\\alpha) = T(\\alpha) + V_{ne}(\\alpha) = \\frac{3\\alpha}{2} - 2Z\\sqrt{\\frac{2\\alpha}{\\pi}}$.\n\n3.  **Two-Electron Coulomb Integral:** The repulsion integral between two identical charge distributions $|\\phi(\\mathbf{r})|^2$ is:\n    $$J_{11}(\\alpha) = \\langle\\phi\\phi|r_{12}^{-1}|\\phi\\phi\\rangle = \\sqrt{\\frac{2\\alpha}{\\pi}}$$\n\nNow we assemble the total energy expression:\n$$\nE(\\alpha) = 2h_{11}(\\alpha) + J_{11}(\\alpha) = 2\\left(\\frac{3\\alpha}{2} - 2Z\\sqrt{\\frac{2\\alpha}{\\pi}}\\right) + \\sqrt{\\frac{2\\alpha}{\\pi}}\n$$\n$$\nE(\\alpha) = 3\\alpha - 4Z\\sqrt{\\frac{2\\alpha}{\\pi}} + \\sqrt{\\frac{2\\alpha}{\\pi}} = 3\\alpha - (4Z-1)\\sqrt{\\frac{2\\alpha}{\\pi}}\n$$\nThis is the final expression for the total energy as a function of the Gaussian exponent $\\alpha$.\n\n**Step 2: Minimization of the Energy**\n\nTo find the optimal exponent $\\alpha^{\\star}$ that minimizes the energy, we differentiate $E(\\alpha)$ with respect to $\\alpha$ and set the result to zero.\n$$\n\\frac{dE}{d\\alpha} = \\frac{d}{d\\alpha}\\left(3\\alpha - (4Z-1)\\sqrt{\\frac{2}{\\pi}}\\sqrt{\\alpha}\\right) = 3 - (4Z-1)\\sqrt{\\frac{2}{\\pi}} \\frac{1}{2\\sqrt{\\alpha}} = 0\n$$\n$$\n3 = \\frac{4Z-1}{\\sqrt{2\\pi\\alpha}} \\implies \\sqrt{2\\pi\\alpha} = \\frac{4Z-1}{3} \\implies \\sqrt{\\alpha} = \\frac{4Z-1}{3\\sqrt{2\\pi}}\n$$\nA physically meaningful solution with $\\alpha > 0$ exists only if the right-hand side is positive, which requires $4Z-1 > 0$, or $Z > 1/4 = 0.25$. This is the critical nuclear charge for this model to bind two electrons.\n\n**Case 1: $Z > 1/4$**\nThe optimal exponent is found by squaring the expression for $\\sqrt{\\alpha}$:\n$$\n\\alpha^{\\star} = \\left(\\frac{4Z-1}{3\\sqrt{2\\pi}}\\right)^2 = \\frac{(4Z-1)^2}{18\\pi}\n$$\nThe corresponding minimum energy $E(\\alpha^{\\star})$ is found by substituting $\\alpha^{\\star}$ back into the energy expression:\n$$\nE(\\alpha^{\\star}) = 3\\alpha^{\\star} - (4Z-1)\\sqrt{\\frac{2}{\\pi}}\\sqrt{\\alpha^{\\star}} = 3\\left(\\frac{(4Z-1)^2}{18\\pi}\\right) - (4Z-1)\\sqrt{\\frac{2}{\\pi}}\\left(\\frac{4Z-1}{3\\sqrt{2\\pi}}\\right)\n$$\n$$\nE(\\alpha^{\\star}) = \\frac{(4Z-1)^2}{6\\pi} - \\frac{(4Z-1)^2}{3\\pi} = -\\frac{(4Z-1)^2}{6\\pi}\n$$\n\n**Case 2: $Z \\le 1/4$**\nIf $Z \\le 1/4$, then $4Z-1 \\le 0$. The derivative $\\frac{dE}{d\\alpha}$ is always positive for $\\alpha>0$, meaning $E(\\alpha)$ is a strictly increasing function. The minimum value on the domain $\\alpha \\ge 0$ occurs as $\\alpha \\to 0^+$. Since $E(0)=0$, the infimum is 0, which occurs at $\\alpha^{\\star}=0$.\n\n**Step 3: Application to Test Cases**\nThe critical value of $Z$ is $0.25$. All test cases have $Z > 0.25$, so we use the Case 1 formulas for all of them.\n\n1.  $Z = 1.0$:\n    $\\alpha^{\\star} = \\frac{(4(1.0)-1)^2}{18\\pi} = \\frac{9}{18\\pi} \\approx 0.15915494$\n    $E(\\alpha^{\\star}) = -\\frac{9}{6\\pi} \\approx -0.47746483$\n\n2.  $Z = 2.0$:\n    $\\alpha^{\\star} = \\frac{(4(2.0)-1)^2}{18\\pi} = \\frac{49}{18\\pi} \\approx 0.86588296$\n    $E(\\alpha^{\\star}) = -\\frac{49}{6\\pi} \\approx -2.59764889$\n\n3.  $Z = 1/(2\\sqrt{2}) \\approx 0.35355339$:\n    $\\alpha^{\\star} = \\frac{(4/(2\\sqrt{2})-1)^2}{18\\pi} = \\frac{(\\sqrt{2}-1)^2}{18\\pi} \\approx 0.00300624$\n    $E(\\alpha^{\\star}) = -\\frac{(\\sqrt{2}-1)^2}{6\\pi} \\approx -0.00901872$\n\n4.  $Z = 0.6$:\n    $\\alpha^{\\star} = \\frac{(4(0.6)-1)^2}{18\\pi} = \\frac{1.4^2}{18\\pi} \\approx 0.03463309$\n    $E(\\alpha^{\\star}) = -\\frac{1.4^2}{6\\pi} \\approx -0.10389926$", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the optimal Gaussian exponent and minimum energy for a two-electron,\n    one-center system at the Hartree-Fock level using a single GTO.\n    \"\"\"\n    \n    # Test suite of nuclear charges Z\n    test_cases_z = [\n        1.0,\n        2.0,\n        1.0 / (2.0 * np.sqrt(2.0)),\n        0.6\n    ]\n\n    results = []\n    \n    # The critical value of Z that separates the two solution regimes.\n    # A bound state (E  0) exists only for Z > 0.25 in this model.\n    z_critical = 0.25\n\n    for z in test_cases_z:\n        if z > z_critical:\n            # For Z > 1/4, a non-trivial minimum exists for alpha > 0.\n            # This term is common to both alpha_star and e_star.\n            term = 4.0 * z - 1.0\n            \n            # Optimal exponent alpha_star\n            alpha_star = (term**2) / (18.0 * np.pi)\n            \n            # Minimum energy E(alpha_star)\n            e_star = - (term**2) / (6.0 * np.pi)\n            \n        else:\n            # For Z = 1/4, E(alpha) increases for alpha > 0.\n            # The infimum is at alpha = 0, where E(0) = 0.\n            alpha_star = 0.0\n            e_star = 0.0\n\n        results.append([round(alpha_star, 8), round(e_star, 8)])\n\n    # Format the final output string as per the problem specification.\n    # e.g., [[a1,e1],[a2,e2],...]\n    output_items = [f\"[{res[0]:.8f},{res[1]:.8f}]\" for res in results]\n    output_str = f\"[{','.join(output_items)}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2454144"}, {"introduction": "After establishing the necessity of diffuse functions for anions, it is crucial to understand their context and limitations. This practice provides the essential counterpoint by examining a system with tightly-bound electrons, a compact cation analogous to $\\mathrm{Li}^+$. By quantifying the negligible energetic impact of adding a diffuse function, you will demonstrate that for electrons in a strong attractive potential, these functions offer little improvement, reinforcing that their use should be targeted and purposeful [@problem_id:2454101].", "problem": "Consider the one-electron nonrelativistic Hamiltonian in atomic units (Hartree atomic units) for an electron in a spherically symmetric Coulomb field of effective nuclear charge $Z$ given by $H = -\\dfrac{1}{2} \\nabla^2 - \\dfrac{Z}{r}$. Let a finite-dimensional trial subspace be spanned by normalized primitive $s$-type Gaussian functions centered at the origin of the form $\\phi_i(\\mathbf{r}) = N(\\alpha_i) \\exp(-\\alpha_i r^2)$, where $r = \\|\\mathbf{r}\\|$ and $N(\\alpha) = \\left(\\dfrac{2 \\alpha}{\\pi}\\right)^{3/4}$. For a given set of exponents $\\{\\alpha_i\\}$, define the overlap matrix $S$ with entries $S_{ij} = \\langle \\phi_i | \\phi_j \\rangle$ and the Hamiltonian matrix $H$ with entries $H_{ij} = \\langle \\phi_i | \\left(-\\dfrac{1}{2} \\nabla^2 - \\dfrac{Z}{r}\\right) | \\phi_j \\rangle$. The ground-state variational energy in this subspace is the smallest generalized eigenvalue $E$ of $H \\mathbf{c} = E S \\mathbf{c}$.\n\nYour task is to quantify, using this variational construction, the energy lowering (in Hartree) obtained by augmenting a compact $s$-Gaussian set with a single diffuse $s$-Gaussian for three specified effective charges $Z$. Use the following two basis choices for each $Z$:\n- The compact (tight) set with exponents $\\{\\alpha\\} = \\{5.0, 15.0, 45.0\\}$.\n- The augmented set that adds one diffuse exponent $\\alpha_{\\text{diff}} = 0.2$ to the compact set, i.e., $\\{5.0, 15.0, 45.0, 0.2\\}$.\n\nFor each case, compute the difference $\\Delta E = E_{\\text{augmented}} - E_{\\text{compact}}$ in Hartree, where $E_{\\text{compact}}$ is the lowest generalized eigenvalue obtained from the compact set and $E_{\\text{augmented}}$ is the lowest generalized eigenvalue obtained from the augmented set. A negative value of $\\Delta E$ indicates that including the diffuse function lowers the variational energy. All integrals must be evaluated exactly in three-dimensional space by integration over $\\mathbb{R}^3$. All energies must be expressed in Hartree and each reported $\\Delta E$ must be rounded to $8$ decimal places.\n\nTest suite (each item is a distinct test case with its own value of $Z$):\n- Case 1 (a compact cationic core representative of $\\mathrm{Li}^+$): $Z = 2.69$.\n- Case 2 (a more compact core): $Z = 5.0$.\n- Case 3 (an edge case, less compact density): $Z = 1.0$.\n\nYour program should produce a single line of output containing the three results $\\Delta E$ for the cases above, ordered as listed, as a comma-separated list enclosed in square brackets, for example, $[\\Delta E_1,\\Delta E_2,\\Delta E_3]$. Each $\\Delta E$ must be a decimal number rounded to $8$ decimal places, and the numbers must be in Hartree.", "solution": "The problem requires the calculation of the energy lowering that results from augmenting a compact set of $s$-type Gaussian basis functions with a single diffuse function. This is a standard application of the linear variational method in quantum chemistry to approximate the ground-state energy of a one-electron, hydrogen-like atom with effective nuclear charge $Z$. The Hamiltonian for this system, in Hartree atomic units, is given by:\n$$\nH = -\\frac{1}{2} \\nabla^2 - \\frac{Z}{r}\n$$\nwhere $-\\frac{1}{2} \\nabla^2$ is the kinetic energy operator and $-\\frac{Z}{r}$ is the potential energy operator describing the Coulomb attraction to the nucleus.\n\nAccording to the variational principle, the expectation value of the Hamiltonian for any trial wavefunction $\\Psi$ is an upper bound to the true ground-state energy $E_0$. We construct a trial wavefunction as a linear combination of basis functions $\\phi_i$:\n$$\n\\Psi = \\sum_{i=1}^{N} c_i \\phi_i\n$$\nThe basis functions are specified as normalized $s$-type Gaussian functions centered at the origin:\n$$\n\\phi_i(\\mathbf{r}) = \\left(\\frac{2\\alpha_i}{\\pi}\\right)^{3/4} \\exp(-\\alpha_i r^2)\n$$\nwhere $\\{\\alpha_i\\}$ is a given set of exponents.\n\nMinimizing the energy functional $E[\\Psi] = \\frac{\\langle \\Psi | H | \\Psi \\rangle}{\\langle \\Psi | \\Psi \\rangle}$ with respect to the coefficients $c_i$ leads to the secular equation. Because the Gaussian basis functions are not orthogonal, this takes the form of a generalized eigenvalue problem:\n$$\nH \\mathbf{c} = E S \\mathbf{c}\n$$\nHere, $H$ is the Hamiltonian matrix with elements $H_{ij} = \\langle \\phi_i | H | \\phi_j \\rangle$, $S$ is the overlap matrix with elements $S_{ij} = \\langle \\phi_i | \\phi_j \\rangle$, and $\\mathbf{c}$ is the vector of coefficients $c_i$. The lowest eigenvalue $E$ of this equation is the variational approximation to the ground-state energy for the given basis set.\n\nThe core of the task is to compute the matrix elements $S_{ij}$ and $H_{ij}$. The Hamiltonian matrix elements can be split into kinetic and potential energy contributions: $H_{ij} = T_{ij} + V_{ij}$. These matrix elements are evaluated by integrating over all space $\\mathbb{R}^3$. For two $s$-type Gaussian functions $\\phi_i$ and $\\phi_j$ with exponents $\\alpha_i$ and $\\alpha_j$ centered at the origin, the exact analytical formulas for these integrals are well known:\n\n1.  **Overlap Matrix Element ($S_{ij}$):** The overlap integral between two such functions is:\n    $$\n    S_{ij} = \\langle \\phi_i | \\phi_j \\rangle = \\int_{\\mathbb{R}^3} \\phi_i(\\mathbf{r}) \\phi_j(\\mathbf{r}) d^3\\mathbf{r} = \\left( \\frac{2\\sqrt{\\alpha_i \\alpha_j}}{\\alpha_i + \\alpha_j} \\right)^{3/2}\n    $$\n\n2.  **Kinetic Energy Matrix Element ($T_{ij}$):** The kinetic energy integral is:\n    $$\n    T_{ij} = \\left\\langle \\phi_i \\left| -\\frac{1}{2}\\nabla^2 \\right| \\phi_j \\right\\rangle = S_{ij} \\frac{3\\alpha_i \\alpha_j}{\\alpha_i + \\alpha_j}\n    $$\n    This formula elegantly relates the kinetic energy element to the corresponding overlap element.\n\n3.  **Potential Energy Matrix Element ($V_{ij}$):** The nuclear attraction integral is:\n    $$\n    V_{ij} = \\left\\langle \\phi_i \\left| -\\frac{Z}{r} \\right| \\phi_j \\right\\rangle = -S_{ij} \\frac{2Z}{\\sqrt{\\pi}}\\sqrt{\\alpha_i + \\alpha_j}\n    $$\n    This element accounts for the Coulomb attraction between the electron and the nucleus of effective charge $Z$.\n\nThe total Hamiltonian matrix element is the sum of the kinetic and potential energy parts:\n$$\nH_{ij} = T_{ij} + V_{ij} = S_{ij} \\left( \\frac{3\\alpha_i \\alpha_j}{\\alpha_i + \\alpha_j} - \\frac{2Z}{\\sqrt{\\pi}}\\sqrt{\\alpha_i + \\alpha_j} \\right)\n$$\n\nThe computational procedure for each specified value of $Z$ is as follows:\nFirst, we use the compact basis set with exponents $\\{\\alpha\\} = \\{5.0, 15.0, 45.0\\}$. A $3 \\times 3$ overlap matrix $S_{\\text{compact}}$ and a $3 \\times 3$ Hamiltonian matrix $H_{\\text{compact}}$ are constructed using the formulas above. The generalized eigenvalue problem $H_{\\text{compact}} \\mathbf{c} = E S_{\\text{compact}} \\mathbf{c}$ is solved, and the lowest eigenvalue is designated $E_{\\text{compact}}$.\n\nSecond, we repeat the procedure for the augmented basis set, $\\{\\alpha\\} = \\{5.0, 15.0, 45.0, 0.2\\}$, which includes the diffuse exponent $\\alpha_{\\text{diff}} = 0.2$. This yields $4 \\times 4$ matrices $S_{\\text{augmented}}$ and $H_{\\text{augmented}}$, and solving the corresponding eigenvalue problem gives a new lowest energy, $E_{\\text{augmented}}$.\n\nFinally, the energy lowering, $\\Delta E$, is computed as the difference:\n$$\n\\Delta E = E_{\\text{augmented}} - E_{\\text{compact}}\n$$\nBy the variational principle, adding a new, linearly independent function to the basis set must lower the variational energy, so we expect $\\Delta E$ to be negative. The magnitude of this lowering depends on how well the added diffuse function improves the description of the electron density's tail, which is more extended for smaller values of $Z$. Thus, we anticipate the largest energy lowering (most negative $\\Delta E$) for $Z=1.0$ and the smallest for $Z=5.0$.\n\nThe implementation will construct the matrices and use a numerical linear algebra library to solve the generalized eigenvalue problem. This procedure is performed for each of the three given values of $Z$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main function to solve the specified quantum chemistry problem.\n    It calculates the energy lowering from adding a diffuse Gaussian function\n    to a compact basis set for a hydrogen-like atom with different Zeff.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a distinct value of effective nuclear charge Z.\n    test_cases = [\n        2.69,  # Case 1 (Li+ like)\n        5.0,   # Case 2 (more compact core)\n        1.0,   # Case 3 (H-atom like)\n    ]\n\n    # Define the basis set exponents\n    compact_exponents = [5.0, 15.0, 45.0]\n    diffuse_exponent = 0.2\n    augmented_exponents = compact_exponents + [diffuse_exponent]\n\n    results = []\n    \n    for Z in test_cases:\n        # Calculate the ground state energy for the compact basis set\n        E_compact = calculate_ground_state_energy(compact_exponents, Z)\n        \n        # Calculate the ground state energy for the augmented basis set\n        E_augmented = calculate_ground_state_energy(augmented_exponents, Z)\n        \n        # Calculate the energy difference\n        delta_E = E_augmented - E_compact\n        \n        # Round the result to 8 decimal places as required\n        results.append(round(delta_E, 8))\n\n    # Format the final output string as specified\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\ndef calculate_ground_state_energy(exponents, Z):\n    \"\"\"\n    Calculates the ground-state variational energy for a given set of Gaussian\n    exponents and effective nuclear charge Z.\n\n    Args:\n        exponents (list of float): The list of Gaussian exponents.\n        Z (float): The effective nuclear charge.\n\n    Returns:\n        float: The lowest generalized eigenvalue (ground state energy in Hartree).\n    \"\"\"\n    n_basis = len(exponents)\n    S = np.zeros((n_basis, n_basis))\n    H = np.zeros((n_basis, n_basis))\n    \n    sqrt_pi = np.sqrt(np.pi)\n\n    # Build the overlap (S) and Hamiltonian (H) matrices\n    for i in range(n_basis):\n        for j in range(n_basis):\n            alpha_i = exponents[i]\n            alpha_j = exponents[j]\n            \n            p = alpha_i + alpha_j\n            \n            # Overlap matrix element S_ij\n            S_ij = (2 * np.sqrt(alpha_i * alpha_j) / p)**1.5\n            S[i, j] = S_ij\n            \n            # Kinetic energy matrix element T_ij\n            T_ij = S_ij * (3 * alpha_i * alpha_j / p)\n            \n            # Potential energy matrix element V_ij\n            V_ij = -S_ij * (2 * Z / sqrt_pi) * np.sqrt(p)\n            \n            # Hamiltonian matrix element H_ij\n            H[i, j] = T_ij + V_ij\n            \n    # Solve the generalized eigenvalue problem Hc = ESc\n    # eigh returns eigenvalues in ascending order. The first one is the ground state.\n    eigenvalues, _ = eigh(H, S)\n    ground_state_energy = eigenvalues[0]\n    \n    return ground_state_energy\n\nsolve()\n```", "id": "2454101"}, {"introduction": "From fundamental models, we now turn to a practical application that reflects common challenges in computational research. This problem presents a scenario where an improper basis set leads to an erroneous conclusion about an anion's stability, a frequent pitfall for the unwary. By analyzing the case and identifying the correct physical reasoning, you will learn how to diagnose such computational artifacts and solidify your understanding of best practices for obtaining reliable results for anionic species [@problem_id:2454120].", "problem": "A computational chemist evaluates the electron attachment propensity of a newly designed drug-like molecule. They optimize the neutral geometry using Density Functional Theory (DFT) and then compute the vertical electron affinity by single-point energies at that neutral geometry. Using the correlation-consistent polarized valence triple-zeta (cc-pVTZ) basis set, the calculated vertical electron affinity is reported as negative, for example $-0.10\\ \\mathrm{eV}$, and they conclude the anion is unstable. A colleague repeats the calculation with the augmented correlation-consistent polarized valence triple-zeta (aug-cc-pVTZ) basis set and obtains a positive value, for example $+0.45\\ \\mathrm{eV}$, and observes a spatially diffuse excess-electron density localized around the molecule. Assume all calculations were performed with well-converged Self-Consistent Field (SCF) solutions and consistent electronic structure settings except for the basis set.\n\nWhich of the following statements best explain why the initial conclusion was unreliable and what minimal corrective practices are justified by first principles? Select all that apply.\n\nA. The cc-pVTZ basis set lacks sufficiently small-exponent Gaussian primitives to represent the long-range tail of an anionic wavefunction, artificially destabilizing the extra electron; aug-cc-pVTZ adds diffuse functions that lower the anion energy relative to the neutral, recovering a bound state.\n\nB. The discrepancy is primarily due to Basis Set Superposition Error (BSSE) in the isolated anion; applying a counterpoise correction at the cc-pVTZ level would have yielded essentially the same positive vertical electron affinity as aug-cc-pVTZ.\n\nC. For dipole-bound or highly delocalized anions, omitting diffuse functions can drive the SCF procedure to a continuum-like, spuriously unbound solution; inspecting the highest occupied molecular orbital’s spatial extent and the expectation value $\\langle r^{2}\\rangle$ can diagnose an excessively diffuse, nonlocalized electron.\n\nD. Diffuse functions in aug-cc-pVTZ primarily affect excited Rydberg states and have negligible impact on ground-state anion stability; the sign change is more plausibly due to the particular DFT functional rather than the basis set.\n\nE. A reliable minimal fix for any organic anion is to place diffuse functions only on polar hydrogen atoms; augmenting heavy atoms is unnecessary if the negative charge is nominally on a proton-donating site.\n\nF. A sound best practice to avoid false negatives for anion stability is to include at least one set of diffuse functions on all atoms likely to carry excess electron density (often all non-hydrogen atoms and frequently hydrogen as well), and to verify binding by confirming a positive vertical electron affinity and a localized excess-electron density rather than an unphysically delocalized tail.", "solution": "The problem statement is scientifically valid. It describes a common and well-understood phenomenon in computational chemistry related to the calculation of electron affinities and the critical role of basis set selection. The data provided are consistent with established principles of quantum chemistry.\n\nThe central issue is the calculation of the vertical electron affinity ($EA_{vert}$), defined as:\n$$EA_{vert} = E(\\text{Neutral}) - E(\\text{Anion})$$\nwhere both energies are computed at the fixed geometry of the optimized neutral molecule. A positive $EA_{vert}$ signifies that the anion is electronically stable relative to the neutral at this geometry.\n\nThe electronic wavefunction of a molecule is constructed from a basis set of functions, typically Gaussian-type orbitals. The spatial extent of these functions is controlled by an exponent, $\\alpha$. Functions with large $\\alpha$ are \"tight\" and describe core electrons well. Functions with smaller $\\alpha$ are more \"diffuse\" and describe the valence region. For anions, particularly those that are weakly bound, the extra electron occupies a very diffuse orbital with significant density far from the nuclei. Accurately representing such an orbital requires basis functions with very small exponents, known as diffuse functions.\n\nThe `cc-pVTZ` (correlation-consistent polarized valence triple-zeta) basis set is optimized to describe the valence correlation energy of neutral atoms and molecules. It lacks the very small-exponent functions necessary to model a weakly bound excess electron. When used to calculate an anion's energy, the variational principle forces the calculation to use a linear combination of existing, tighter basis functions to approximate the diffuse orbital. This is a very poor approximation, which artificially raises the calculated energy of the anion, $E(\\text{Anion})$.\n\nThe `aug-cc-pVTZ` basis set is the `cc-pVTZ` set \"augmented\" with a set of diffuse functions on each atom. These functions provide the necessary flexibility to describe the spatially extended orbital of the excess electron. Consequently, the calculation with `aug-cc-pVTZ` yields a much lower, more accurate energy for the anion. The energy of the neutral molecule is also lowered, but to a much smaller extent, as its electrons are more tightly bound and already reasonably well-described by `cc-pVTZ`.\n\nLet $E_{anion}^{TZ}$ and $E_{anion}^{aTZ}$ be the anion energies with `cc-pVTZ` and `aug-cc-pVTZ`, respectively. The variational principle guarantees $E_{anion}^{TZ} > E_{anion}^{aTZ}$. The energy difference $\\Delta E = E_{anion}^{TZ} - E_{anion}^{aTZ}$ can be substantial, often on the order of an electron-volt. The change in the neutral's energy is negligible in comparison. This large, preferential stabilization of the anion directly increases the calculated $EA_{vert}$, and can easily change its sign from negative (as with the reported $-0.10 \\ \\mathrm{eV}$) to positive (as with $+0.45 \\ \\mathrm{eV}$), revealing the anion to be a bound state.\n\nTherefore, the initial conclusion of instability was unreliable because it was based on a calculation using an inadequate basis set for the problem at hand.\n\nNow, we evaluate each statement.\n\n**A. The cc-pVTZ basis set lacks sufficiently small-exponent Gaussian primitives to represent the long-range tail of an anionic wavefunction, artificially destabilizing the extra electron; aug-cc-pVTZ adds diffuse functions that lower the anion energy relative to the neutral, recovering a bound state.**\nThis statement is a precise and accurate description of the underlying quantum chemical principles. The lack of diffuse functions in `cc-pVTZ` leads to a poor variational description and an artificially high energy for the anion. Adding diffuse functions (`aug-cc-pVTZ`) remedies this, lowering the anion energy significantly more than the neutral energy, thereby providing a more accurate, and in this case positive, electron affinity.\n**Verdict: Correct.**\n\n**B. The discrepancy is primarily due to Basis Set Superposition Error (BSSE) in the isolated anion; applying a counterpoise correction at the cc-pVTZ level would have yielded essentially the same positive vertical electron affinity as aug-cc-pVTZ.**\nThis is incorrect. Basis Set Superposition Error (BSSE) is an artifact related to the calculation of interaction energies between molecular fragments. The problem described here concerns basis set *incompleteness* for a single molecule (the anion). The counterpoise correction is the procedure for estimating intermolecular BSSE and is irrelevant here. It cannot compensate for the fundamental lack of appropriate diffuse functions in the `cc-pVTZ` basis set. The large energy difference is a physical effect of basis set quality, not a correctable artifact like BSSE.\n**Verdict: Incorrect.**\n\n**C. For dipole-bound or highly delocalized anions, omitting diffuse functions can drive the SCF procedure to a continuum-like, spuriously unbound solution; inspecting the highest occupied molecular orbital’s spatial extent and the expectation value $\\langle r^{2}\\rangle$ can diagnose an excessively diffuse, nonlocalized electron.**\nThis statement accurately describes a common failure mode in anion calculations with inadequate basis sets and the standard diagnostic for it. Lacking proper diffuse functions to describe a genuinely bound diffuse state, a variational calculation may converge to a non-physical solution where the extra electron occupies the most diffuse available basis function, mimicking a free electron. This \"continuum-like\" state is characterized by an extremely diffuse Highest Occupied Molecular Orbital (HOMO). A large expectation value for the squared radius operator, $\\langle r^2 \\rangle$, for the HOMO is a quantitative indicator of such a spurious, non-localized state. This is a valid and important consideration.\n**Verdict: Correct.**\n\n**D. Diffuse functions in aug-cc-pVTZ primarily affect excited Rydberg states and have negligible impact on ground-state anion stability; the sign change is more plausibly due to the particular DFT functional rather than the basis set.**\nThis is false. While diffuse functions are crucial for Rydberg states, they are equally crucial for the ground states of weakly bound anions, which share the characteristic of an electron in a spatially diffuse orbital. Their impact is not negligible; it is often the dominant factor determining stability, as demonstrated by the problem. Furthermore, the problem states that all settings *except the basis set* were consistent, so the DFT functional is the same in both calculations. The observed effect is a classic example of basis set inadequacy.\n**Verdict: Incorrect.**\n\n**E. A reliable minimal fix for any organic anion is to place diffuse functions only on polar hydrogen atoms; augmenting heavy atoms is unnecessary if the negative charge is nominally on a proton-donating site.**\nThis is a flawed and dangerous generalization. The excess electron density is distributed over the molecule based on electronegativity and orbital interactions. In an anion formed by deprotonation of an acid like R-OH, the charge will be primarily on the more electronegative oxygen atom, not the hydrogen that left. Thus, diffuse functions are critically needed on the heavy atoms (O, N, C, etc.). Placing them only on hydrogens would be an unreliable and generally incorrect strategy.\n**Verdict: Incorrect.**\n\n**F. A sound best practice to avoid false negatives for anion stability is to include at least one set of diffuse functions on all atoms likely to carry excess electron density (often all non-hydrogen atoms and frequently hydrogen as well), and to verify binding by confirming a positive vertical electron affinity and a localized excess-electron density rather than an unphysically delocalized tail.**\nThis statement provides an excellent summary of best practices for computational studies of anions. Using a basis set with diffuse functions is essential. The most robust method is to augment all atoms. A necessary follow-up step is to verify the result not only by checking for a positive $EA_{vert}$, but also by ensuring the physical reasonableness of the solution, i.e., that the excess electron is localized on the molecule and not in a spurious, continuum-like orbital. This two-part check is the standard for rigor in this area.\n**Verdict: Correct.**", "answer": "$$\\boxed{A, C, F}$$", "id": "2454120"}]}