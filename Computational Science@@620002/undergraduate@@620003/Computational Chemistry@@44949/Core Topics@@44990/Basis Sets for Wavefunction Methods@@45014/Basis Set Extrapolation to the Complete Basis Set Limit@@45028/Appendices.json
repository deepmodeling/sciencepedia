{"hands_on_practices": [{"introduction": "The foundation of basis set extrapolation often begins with a two-point method. This practice introduces one of the most common extrapolation formulas, which models the correlation energy's convergence. By framing the problem in the language of linear algebra, we transform what looks like a simple curve-fitting task into a structured system of equations, a powerful and generalizable skill in computational science. This exercise [@problem_id:2450736] will guide you through setting up and solving for the Complete Basis Set (CBS) limit by representing the problem as a matrix equation, a cornerstone of many scientific computing applications.", "problem": "A common two-point model for the convergence of correlation energy toward the complete basis set (CBS) limit assumes that the computed correlation energy with a correlation-consistent basis set of cardinal number $L$ follows\n$$\nE_{\\text{corr}}(L) \\;=\\; E_{\\text{CBS}} \\;+\\; A\\,(L+\\tfrac{1}{2})^{-3},\n$$\nwhere $E_{\\text{CBS}}$ is the correlation energy at the CBS limit, $A$ is a system-dependent constant, and $(L+\\tfrac{1}{2})^{-3}$ captures the asymptotic convergence behavior.\n\nFor a given molecule, high-level calculations yield the following correlation energies (in Hartree) using two different cardinal numbers:\n$$\nE_{\\text{corr}}(3) \\;=\\; -0.200000, \\qquad E_{\\text{corr}}(4) \\;=\\; -0.220000.\n$$\n\n1. Formulate these two equations in the linear algebra form $M \\cdot v = E$, where $v = \\begin{pmatrix} E_{\\text{CBS}} \\\\ A \\end{pmatrix}$, and explicitly write the matrix $M$ and the vector $E$.\n2. Solve for the vector $v$ and report the numerical values of $E_{\\text{CBS}}$ and $A$.\n\nRound your final numerical values to six significant figures. Express energies in Hartree. Provide your final answer as the vector $v$.", "solution": "The problem has been validated and is determined to be a well-posed problem in computational chemistry. It is scientifically grounded, self-contained, and objective. We may proceed with the solution.\n\nThe problem requires us to determine the complete basis set (CBS) limit of the correlation energy, $E_{\\text{CBS}}$, and a fitting constant, $A$, from two calculations performed with correlation-consistent basis sets of cardinal numbers $L=3$ and $L=4$. The convergence is modeled by the equation:\n$$\nE_{\\text{corr}}(L) = E_{\\text{CBS}} + A(L+\\tfrac{1}{2})^{-3}\n$$\nThe provided data points are $E_{\\text{corr}}(3) = -0.200000$ Hartree and $E_{\\text{corr}}(4) = -0.220000$ Hartree.\n\nFirst, we will formulate the problem in the matrix form $M \\cdot v = E$. The given model is a linear equation with respect to the unknowns $E_{\\text{CBS}}$ and $A$. We can write one equation for each data point.\n\nFor $L=3$:\n$$\nE_{\\text{corr}}(3) = 1 \\cdot E_{\\text{CBS}} + (3+\\tfrac{1}{2})^{-3} \\cdot A\n$$\n$$\n-0.200000 = E_{\\text{CBS}} + (3.5)^{-3} \\cdot A\n$$\n\nFor $L=4$:\n$$\nE_{\\text{corr}}(4) = 1 \\cdot E_{\\text{CBS}} + (4+\\tfrac{1}{2})^{-3} \\cdot A\n$$\n$$\n-0.220000 = E_{\\text{CBS}} + (4.5)^{-3} \\cdot A\n$$\n\nThis system of two linear equations can be written in matrix form as follows:\n$$\n\\begin{pmatrix} 1 & (3.5)^{-3} \\\\ 1 & (4.5)^{-3} \\end{pmatrix} \\begin{pmatrix} E_{\\text{CBS}} \\\\ A \\end{pmatrix} = \\begin{pmatrix} -0.200000 \\\\ -0.220000 \\end{pmatrix}\n$$\nThis corresponds to the required form $M \\cdot v = E$, where the vector of unknowns is $v = \\begin{pmatrix} E_{\\text{CBS}} \\\\ A \\end{pmatrix}$, the vector of constants is $E = \\begin{pmatrix} E_{\\text{corr}}(3) \\\\ E_{\\text{corr}}(4) \\end{pmatrix} = \\begin{pmatrix} -0.200000 \\\\ -0.220000 \\end{pmatrix}$, and the coefficient matrix $M$ is:\n$$\nM = \\begin{pmatrix} 1 & (3.5)^{-3} \\\\ 1 & (4.5)^{-3} \\end{pmatrix} = \\begin{pmatrix} 1 & (\\frac{7}{2})^{-3} \\\\ 1 & (\\frac{9}{2})^{-3} \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{8}{343} \\\\ 1 & \\frac{8}{729} \\end{pmatrix}\n$$\n\nNext, we solve this system for the vector $v$, which contains the values of $E_{\\text{CBS}}$ and $A$. Let the two equations be:\n1. $E_{\\text{CBS}} + A\\frac{8}{343} = -0.200000$\n2. $E_{\\text{CBS}} + A\\frac{8}{729} = -0.220000$\n\nTo find $A$, we subtract the second equation from the first:\n$$\n\\left( E_{\\text{CBS}} + A\\frac{8}{343} \\right) - \\left( E_{\\text{CBS}} + A\\frac{8}{729} \\right) = -0.200000 - (-0.220000)\n$$\n$$\nA \\left( \\frac{8}{343} - \\frac{8}{729} \\right) = 0.020000\n$$\nWe solve for $A$ by first simplifying the term in the parentheses:\n$$\n\\frac{8}{343} - \\frac{8}{729} = 8 \\left( \\frac{1}{343} - \\frac{1}{729} \\right) = 8 \\left( \\frac{729 - 343}{343 \\times 729} \\right) = 8 \\left( \\frac{386}{250047} \\right) = \\frac{3088}{250047}\n$$\nNow, we can compute $A$:\n$$\nA \\cdot \\frac{3088}{250047} = 0.020000 \\implies A = \\frac{0.020000 \\times 250047}{3088} = \\frac{5000.94}{3088} \\approx 1.61947539507...\n$$\n\nTo find $E_{\\text{CBS}}$, we can rearrange the second equation and substitute the value of $A$:\n$$\nE_{\\text{CBS}} = -0.220000 - A \\frac{8}{729}\n$$\n$$\nE_{\\text{CBS}} = -0.220000 - \\left( \\frac{5000.94}{3088} \\right) \\frac{8}{729} = -0.220000 - \\frac{40007.52}{2251152} \\approx -0.220000 - 0.017772020725...\n$$\n$$\nE_{\\text{CBS}} \\approx -0.237772020725...\n$$\nAlternatively, a more direct formula for $E_{\\text{CBS}}$ can be derived, which is less prone to propagation of rounding errors:\n$$\nE_{\\text{CBS}} = \\frac{E_{\\text{corr}}(4) (3.5)^{-3} - E_{\\text{corr}}(3) (4.5)^{-3}}{(3.5)^{-3} - (4.5)^{-3}} = \\frac{(-0.220000) \\frac{8}{343} - (-0.200000) \\frac{8}{729}}{\\frac{8}{343} - \\frac{8}{729}}\n$$\n$$\nE_{\\text{CBS}} = \\frac{\\frac{-0.220000}{343} + \\frac{0.200000}{729}}{\\frac{1}{343} - \\frac{1}{729}} = \\frac{\\frac{-0.220000 \\times 729 + 0.200000 \\times 343}{343 \\times 729}}{\\frac{729 - 343}{343 \\times 729}} = \\frac{-160.38 + 68.6}{386} = \\frac{-91.78}{386}\n$$\n$$\nE_{\\text{CBS}} = -0.237772020725...\n$$\nThe results from both methods are consistent. Now, we round the numerical values of $E_{\\text{CBS}}$ and $A$ to six significant figures as required by the problem statement.\n$E_{\\text{CBS}} \\approx -0.237772$\n$A \\approx 1.61948$\n\nThe final answer is the vector $v = \\begin{pmatrix} E_{\\text{CBS}} \\\\ A \\end{pmatrix}$ with the calculated numerical values.\n$$\nv = \\begin{pmatrix} -0.237772 \\\\ 1.61948 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.237772 \\\\ 1.61948\n\\end{pmatrix}\n}\n$$", "id": "2450736"}, {"introduction": "While two-point models are useful, higher accuracy often demands more sophisticated extrapolation schemes that account for additional terms in the asymptotic expansion of the correlation energy. This hypothetical problem [@problem_id:2450745] explores a three-parameter model, which provides a more refined description but requires data from three separate calculations. The challenge lies in solving a system of three equations for three unknowns, a task that can be simplified with a clever algebraic transformation. This practice hones your ability to manipulate and solve more complex, non-linear-looking systems to extract a highly accurate CBS limit energy.", "problem": "In the context of basis set convergence, the complete basis set (CBS) limit for the correlation energy is the value obtained as the basis set cardinal number $X$ tends to $+\\infty$. For correlation-consistent polarized valence $X$-zeta (cc-pVXZ) basis sets applied to a closed-shell atom, assume the asymptotic behavior of the correlation energy $E_{\\mathrm{corr}}(X)$ for sufficiently large $X$ is\n$$\nE_{\\mathrm{corr}}(X) \\;=\\; E_{\\mathrm{corr}}(\\infty) \\;+\\; a\\,X^{-3} \\;+\\; b\\,X^{-5},\n$$\nwhere $E_{\\mathrm{corr}}(\\infty)$, $a$, and $b$ are $X$-independent constants. A set of high-level Coupled Cluster with Singles, Doubles, and perturbative Triples (CCSD(T)) correlation energies for the helium atom computed with cc-pVXZ at cardinal numbers $X = 2, 3, 4$ are:\n$$\nE_{\\mathrm{corr}}(2) = -0.039000 \\quad \\text{Hartree},\n$$\n$$\nE_{\\mathrm{corr}}(3) = -0.041000 \\quad \\text{Hartree},\n$$\n$$\nE_{\\mathrm{corr}}(4) = -0.041700 \\quad \\text{Hartree}.\n$$\nUsing only the assumption above and these three data points, determine the CBS-limit correlation energy $E_{\\mathrm{corr}}(\\infty)$. Express the final energy in Hartree and round your answer to six significant figures.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and objective. It presents a standard problem in computational quantum chemistry involving basis set extrapolation. No flaws are identified. The solution proceeds.\n\nThe provided asymptotic relationship for the correlation energy $E_{\\mathrm{corr}}(X)$ as a function of the basis set cardinal number $X$ is\n$$E_{\\mathrm{corr}}(X) = E_{\\mathrm{corr}}(\\infty) + a\\,X^{-3} + b\\,X^{-5}$$\nwhere $E_{\\mathrm{corr}}(\\infty)$, $a$, and $b$ are constants. We are given three data points for the correlation energy of the helium atom:\n$E_{\\mathrm{corr}}(2) = -0.039000$ Hartree, for $X=2$.\n$E_{\\mathrm{corr}}(3) = -0.041000$ Hartree, for $X=3$.\n$E_{\\mathrm{corr}}(4) = -0.041700$ Hartree, for $X=4$.\n\nLet us define the energy difference from the complete basis set (CBS) limit as $\\Delta E(X) = E_{\\mathrm{corr}}(X) - E_{\\mathrm{corr}}(\\infty)$. The equation becomes\n$$\\Delta E(X) = a\\,X^{-3} + b\\,X^{-5}$$\nWe can rearrange this equation by multiplying by $X^5$:\n$$\\Delta E(X) X^5 = a\\,X^2 + b$$\nLet us define a new variable $Z = X^2$ and a new function $g(Z) = \\Delta E(X) X^5$. Substituting these definitions gives\n$$g(Z) = a\\,Z + b$$\nThis equation shows that $g(Z)$ is a linear function of $Z$.\n\nWe have three pairs of points $(X_i, E_{\\mathrm{corr}}(X_i))$ for $i \\in \\{1, 2, 3\\}$, corresponding to cardinal numbers $X=2$, $X=3$, and $X=4$. These map to three points in the $(Z, g(Z))$ coordinate system:\nFor $X_1=2$, we have $Z_1 = 2^2 = 4$. The function value is $g(Z_1) = (E_{\\mathrm{corr}}(2) - E_{\\mathrm{corr}}(\\infty)) \\cdot 2^5 = 32(E_{\\mathrm{corr}}(2) - E_{\\mathrm{corr}}(\\infty))$.\nFor $X_2=3$, we have $Z_2 = 3^2 = 9$. The function value is $g(Z_2) = (E_{\\mathrm{corr}}(3) - E_{\\mathrm{corr}}(\\infty)) \\cdot 3^5 = 243(E_{\\mathrm{corr}}(3) - E_{\\mathrm{corr}}(\\infty))$.\nFor $X_3=4$, we have $Z_3 = 4^2 = 16$. The function value is $g(Z_3) = (E_{\\mathrm{corr}}(4) - E_{\\mathrm{corr}}(\\infty)) \\cdot 4^5 = 1024(E_{\\mathrm{corr}}(4) - E_{\\mathrm{corr}}(\\infty))$.\n\nSince these three points $(Z_1, g(Z_1))$, $(Z_2, g(Z_2))$, and $(Z_3, g(Z_3))$ lie on a straight line, the slope between any two pairs of points must be identical.\n$$\\frac{g(Z_2) - g(Z_1)}{Z_2 - Z_1} = \\frac{g(Z_3) - g(Z_2)}{Z_3 - Z_2}$$\nSubstituting the expressions for $Z_i$ and $g(Z_i)$:\n$$\\frac{243(E_{\\mathrm{corr}}(3) - E_{\\mathrm{corr}}(\\infty)) - 32(E_{\\mathrm{corr}}(2) - E_{\\mathrm{corr}}(\\infty))}{9 - 4} = \\frac{1024(E_{\\mathrm{corr}}(4) - E_{\\mathrm{corr}}(\\infty)) - 243(E_{\\mathrm{corr}}(3) - E_{\\mathrm{corr}}(\\infty))}{16 - 9}$$\nLet $E_\\infty = E_{\\mathrm{corr}}(\\infty)$, $E_2=E_{\\mathrm{corr}}(2)$, $E_3=E_{\\mathrm{corr}}(3)$, and $E_4=E_{\\mathrm{corr}}(4)$ for notational simplicity.\n$$\\frac{243(E_3 - E_\\infty) - 32(E_2 - E_\\infty)}{5} = \\frac{1024(E_4 - E_\\infty) - 243(E_3 - E_\\infty)}{7}$$\nWe can now solve this linear equation for the single unknown, $E_\\infty$.\n$$7 [243E_3 - 243E_\\infty - 32E_2 + 32E_\\infty] = 5 [1024E_4 - 1024E_\\infty - 243E_3 + 243E_\\infty]$$\n$$7 [243E_3 - 32E_2 - 211E_\\infty] = 5 [1024E_4 - 243E_3 - 781E_\\infty]$$\n$$1701E_3 - 224E_2 - 1477E_\\infty = 5120E_4 - 1215E_3 - 3905E_\\infty$$\nGroup the terms containing $E_\\infty$:\n$$E_\\infty (3905 - 1477) = 5120E_4 - 1215E_3 - 1701E_3 + 224E_2$$\n$$2428 E_\\infty = 5120E_4 - 2916E_3 + 224E_2$$\n$$E_\\infty = \\frac{5120E_4 - 2916E_3 + 224E_2}{2428}$$\nNow, we substitute the given numerical values: $E_2 = -0.039000$, $E_3 = -0.041000$, and $E_4 = -0.041700$.\n$$E_\\infty = \\frac{5120(-0.041700) - 2916(-0.041000) + 224(-0.039000)}{2428}$$\n$$E_\\infty = \\frac{-213.504 + 119.556 - 8.736}{2428}$$\n$$E_\\infty = \\frac{-102.684}{2428}$$\n$$E_\\infty \\approx -0.04229160049423...$$\nThe problem requires the answer to be rounded to six significant figures. The first six significant figures are $4, 2, 2, 9, 1, 6$. The subsequent digit is $0$, so we round down (i.e., we do not change the last digit).\n$$E_{\\mathrm{corr}}(\\infty) \\approx -0.0422916$$\nThe unit is Hartree, as specified in the problem statement.", "answer": "$$\n\\boxed{-0.0422916}\n$$", "id": "2450745"}, {"introduction": "Beyond simply applying formulas, a key skill for a computational scientist is to understand their inherent behavior and limitations. This next practice [@problem_id:2450750] is a thought experiment designed to analyze the mathematical properties of an extrapolation scheme itself. By assuming the extrapolation model is perfectly followed by a series of basis sets, we can calculate a system-independent factor that reveals how the extrapolation over- or under-shoots the next data point in the series. This exercise provides critical insight into the intrinsic accuracy and predictive power of the extrapolation method you are using.", "problem": "A central task in basis set extrapolation in computational chemistry is to estimate the value at the complete basis set (CBS) limit using a sequence of finite basis sets. Consider the family of correlation consistent polarized valence $n$-zeta (cc-pV$n$Z) basis sets with cardinal numbers $L \\in \\{3,4,5,6\\}$ corresponding to triple-zeta (T), quadruple-zeta (Q), quintuple-zeta ($5$Z), and sextuple-zeta ($6$Z), respectively. For the correlation energy of a fixed system, assume the standard asymptotic convergence form with respect to $L$,\n$$\nE(L) \\;=\\; E_{\\mathrm{CBS}} \\;+\\; A\\,(L+\\tfrac{1}{2})^{-3},\n$$\nwhere $E_{\\mathrm{CBS}}$ is the complete basis set limit and $A$ is an $L$-independent constant. A three-point extrapolation based on the cc-pV$3$Z, cc-pV$4$Z, and cc-pV$5$Z values is used, adopting the above functional form exactly to obtain an estimate $E_{\\mathrm{ext}}$ of $E_{\\mathrm{CBS}}$.\n\nSuppose that a calculation with the cc-pV$6$Z basis set is taken as the reference “exact” value, i.e., $E(6)$ is treated as the true value for the purpose of assessing accuracy. Define the signed accuracy factor\n$$\nR \\;=\\; \\frac{E_{\\mathrm{ext}} - E(6)}{E(5) - E(6)}.\n$$\nUnder the stated assumptions, compute $R$. Round your final answer to four significant figures. No units are required.", "solution": "The problem is first subjected to validation. It is found to be scientifically grounded, well-posed, and objective. The premises are consistent with established models for basis set extrapolation in computational chemistry. The problem statement provides a clear and unambiguous set of conditions that permit a unique solution. We may therefore proceed with the derivation.\n\nThe stated model for the correlation energy $E(L)$ as a function of the basis set cardinal number $L$ is\n$$\nE(L) = E_{\\mathrm{CBS}} + A \\left(L + \\frac{1}{2}\\right)^{-3}\n$$\nwhere $E_{\\mathrm{CBS}}$ is the energy at the complete basis set limit and $A$ is a constant independent of $L$.\n\nThe problem specifies that a three-point extrapolation using the results for $L \\in \\{3, 4, 5\\}$ is performed to obtain an estimate $E_{\\mathrm{ext}}$ for $E_{\\mathrm{CBS}}$. The phrase \"adopting the above functional form exactly\" is a critical condition. It implies that the energy values $E(3)$, $E(4)$, and $E(5)$ are assumed to lie perfectly on a single curve defined by the model for a specific pair of parameters. We denote this extrapolated CBS energy as $E_{\\mathrm{ext}}$. Thus, for the purpose of this analysis, $E_{\\mathrm{ext}}$ is identical to the parameter $E_{\\mathrm{CBS}}$ in the equation that fits the data for $L \\in \\{3, 4, 5\\}$.\n\nFurthermore, the problem requires assessing accuracy by treating the $L=6$ result, $E(6)$, as the reference value. Following the same assumption of the model's exactness, the energy $E(6)$ must also conform to the same functional form with the same parameters $E_{\\mathrm{ext}}$ and $A$.\n\nWe are required to compute the signed accuracy factor $R$, defined as\n$$\nR = \\frac{E_{\\mathrm{ext}} - E(6)}{E(5) - E(6)}\n$$\nWe shall express the numerator and the denominator of this fraction using the energy model.\n\nThe numerator is $E_{\\mathrm{ext}} - E(6)$. Based on the model, the energy for $L=6$ is given by\n$$\nE(6) = E_{\\mathrm{ext}} + A \\left(6 + \\frac{1}{2}\\right)^{-3}\n$$\nTherefore, the numerator simplifies to\n$$\nE_{\\mathrm{ext}} - E(6) = E_{\\mathrm{ext}} - \\left[ E_{\\mathrm{ext}} + A \\left(6.5\\right)^{-3} \\right] = - A \\left(6.5\\right)^{-3}\n$$\nThe denominator is $E(5) - E(6)$. Similarly, we express both energies using the model:\n$$\nE(5) = E_{\\mathrm{ext}} + A \\left(5 + \\frac{1}{2}\\right)^{-3} = E_{\\mathrm{ext}} + A \\left(5.5\\right)^{-3}\n$$\n$$\nE(6) = E_{\\mathrm{ext}} + A \\left(6 + \\frac{1}{2}\\right)^{-3} = E_{\\mathrm{ext}} + A \\left(6.5\\right)^{-3}\n$$\nSubtracting the second expression from the first yields\n$$\nE(5) - E(6) = \\left[ E_{\\mathrm{ext}} + A \\left(5.5\\right)^{-3} \\right] - \\left[ E_{\\mathrm{ext}} + A \\left(6.5\\right)^{-3} \\right] = A \\left[ \\left(5.5\\right)^{-3} - \\left(6.5\\right)^{-3} \\right]\n$$\nNow we can construct the ratio $R$:\n$$\nR = \\frac{- A \\left(6.5\\right)^{-3}}{A \\left[ \\left(5.5\\right)^{-3} - \\left(6.5\\right)^{-3} \\right]}\n$$\nThe constant $A$, assumed to be non-zero, cancels from the numerator and denominator. This demonstrates that the value of $R$ is independent of the specific chemical system being studied and depends only on the mathematical structure of the extrapolation formula and the cardinal numbers used.\n$$\nR = \\frac{- \\left(6.5\\right)^{-3}}{\\left(5.5\\right)^{-3} - \\left(6.5\\right)^{-3}}\n$$\nTo simplify the expression for calculation, we can write the negative exponents as fractions:\n$$\nR = \\frac{-\\frac{1}{(6.5)^3}}{\\frac{1}{(5.5)^3} - \\frac{1}{(6.5)^3}}\n$$\nMultiplying the numerator and denominator by $(5.5)^3(6.5)^3$ gives\n$$\nR = \\frac{-(5.5)^3}{(6.5)^3 - (5.5)^3}\n$$\nWe now compute the numerical values for the powers:\n$$\n(5.5)^3 = 166.375\n$$\n$$\n(6.5)^3 = 274.625\n$$\nSubstituting these values back into the expression for $R$:\n$$\nR = \\frac{-166.375}{274.625 - 166.375} = \\frac{-166.375}{108.25}\n$$\nPerforming the final division:\n$$\nR \\approx -1.5369515\n$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $1$, $5$, $3$, $6$. The fifth digit is $9$, which requires rounding up the fourth digit.\n$$\nR \\approx -1.537\n$$\nThis result is dimensionless, as required. It signifies that the extrapolation from $\\{3,4,5\\}$ overshoots the $L=6$ value, and the magnitude of this overshoot, relative to the improvement from $L=5$ to $L=6$, is approximately $1.537$.", "answer": "$$\\boxed{-1.537}$$", "id": "2450750"}]}