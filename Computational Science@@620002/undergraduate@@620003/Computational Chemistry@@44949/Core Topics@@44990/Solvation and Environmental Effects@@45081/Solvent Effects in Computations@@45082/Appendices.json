{"hands_on_practices": [{"introduction": "We begin our hands-on exploration with the simplest case of solvation: a single spherical ion in a continuous medium. The Born model provides a foundational electrostatic description for this process, linking the solvation free energy to the ion's charge and size, and the solvent's dielectric properties. This exercise [@problem_id:2462575] is more than just a calculation; it is a sensitivity analysis that demonstrates how significantly the results of continuum models can depend on their input parameters, specifically the effective ionic radius, which is not always a well-defined quantity.", "problem": "You are to write a complete, runnable program that computes the sensitivity of the solvation free energy of the chloride ion $\\mathrm{Cl^-}$ in liquid water to the choice of the cavity radius used in the Polarizable Continuum Model (PCM). Use the Born model expression for the solvation free energy, which approximates the work of charging a spherical ion of radius $r$ embedded in a dielectric continuum:\n$$\n\\Delta G_{\\text{solv}}(r,\\varepsilon) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon}-1\\Big),\n$$\nwhere $N_{\\mathrm{A}}$ is Avogadro’s number, $z$ is the ion charge number, $e$ is the elementary charge, $\\varepsilon_0$ is the vacuum permittivity, and $\\varepsilon$ is the static relative permittivity (dielectric constant) of the solvent. Take the solvent as liquid water at room temperature with dielectric constant $\\varepsilon = 78.37$. Use $z=-1$ for $\\mathrm{Cl^-}$, $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$, $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$, and $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F\\,m^{-1}}$. Treat the cavity radius $r$ as a parameter in metres. The Born model formula above yields $\\Delta G_{\\text{solv}}$ in joules per mole; convert your results to kilojoules per mole. All calculations must be expressed in kilojoules per mole.\n\nFor each test case, define a nominal PCM cavity radius $r_0$ (in ångströms), and consider two perturbed radii given by a relative change of $\\pm 10\\%$:\n- The decreased radius is $0.9\\,r_0$.\n- The increased radius is $1.1\\,r_0$.\n\nFor each test case, compute the following three quantities, all in kilojoules per mole:\n- The nominal solvation free energy $\\Delta G_{\\text{solv}}(r_0,\\varepsilon)$.\n- The absolute error for the $-10\\%$ change, defined as $\\big|\\Delta G_{\\text{solv}}(0.9\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)\\big|$.\n- The absolute error for the $+10\\%$ change, defined as $\\big|\\Delta G_{\\text{solv}}(1.1\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)\\big|$.\n\nUse the following test suite of nominal cavity radii $r_0$ for $\\mathrm{Cl^-}$ (in ångströms): $[\\,1.60,\\ 1.81,\\ 2.00,\\ 2.20\\,]$. Convert ångströms to metres using 1 Å = $1.0\\times 10^{-10}$ m.\n\nYour program must produce a single line of output containing a list of $4$ sublists, one per test case, where each sublist contains the three floating-point numbers described above, in this exact order and in kilojoules per mole, each rounded to $2$ decimal places. For example, the required format is\n$[\\,[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],[x_{31},x_{32},x_{33}],[x_{41},x_{42},x_{43}]\\,]$,\nwith no additional text.", "solution": "The problem statement has been subjected to rigorous validation against the required criteria.\n\n**Step 1: Extract Givens**\n- **Model Equation**: Born model for solvation free energy, $\\Delta G_{\\text{solv}}(r,\\varepsilon) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon}-1\\Big)$.\n- **Ion**: Chloride ion ($\\mathrm{Cl^-}$), for which the charge number is $z=-1$.\n- **Solvent**: Liquid water, with static relative permittivity $\\varepsilon = 78.37$.\n- **Physical Constants**:\n  - Avogadro's number: $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$.\n  - Elementary charge: $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$.\n  - Vacuum permittivity: $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F\\,m^{-1}}$.\n- **Unit Conversions**:\n  - Input radius $r_0$ is in ångströms (Å), where 1 Å = $1.0\\times 10^{-10}$ m.\n  - Output energy is in kilojoules per mole ($\\mathrm{kJ \\cdot mol^{-1}}$), where $1\\ \\mathrm{kJ} = 1000\\ \\mathrm{J}$.\n- **Test Suite**: A set of nominal cavity radii $r_0$ for $\\mathrm{Cl^-}$: $[\\,1.60,\\ 1.81,\\ 2.00,\\ 2.20\\,]$ in ångströms.\n- **Task**: For each $r_0$, compute three values:\n  1. The nominal solvation free energy $\\Delta G_{\\text{solv}}(r_0,\\varepsilon)$.\n  2. The absolute error for a $-10\\%$ radius change: $|\\Delta G_{\\text{solv}}(0.9\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)|$.\n  3. The absolute error for a $+10\\%$ radius change: $|\\Delta G_{\\text{solv}}(1.1\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)|$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated as scientifically grounded, well-posed, and objective.\n- **Scientific Grounding**: It is based on the Born model, a cornerstone of continuum solvation theory in physical chemistry. All physical constants are provided with their standard, accepted values. The investigation of sensitivity to a model parameter (cavity radius) is a standard and meaningful task in computational chemistry.\n- **Well-Posedness**: The problem provides a precise mathematical formula, all necessary numerical inputs, and a clear, unambiguous specification of the required outputs. It admits a unique, stable, and directly computable solution.\n- **Objectivity**: The language is quantitative and precise, free from any subjective or speculative content.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be developed.\n\nThe solution proceeds from the Born model equation for the solvation free energy $\\Delta G_{\\text{solv}}$ of a spherical ion in a dielectric continuum:\n$$\n\\Delta G_{\\text{solv}}(r,\\varepsilon) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon}-1\\Big)\n$$\nHere, $r$ is the cavity radius and $\\varepsilon$ is the static relative permittivity of the solvent. All other symbols represent fundamental physical constants.\n\nFor computational efficiency, it is advantageous to group all terms that are independent of the radius $r$ into a single constant factor, which we shall denote $C_{\\text{Born}}$.\n$$\nC_{\\text{Born}} = N_{\\mathrm{A}} \\frac{(z e)^2}{8\\pi \\varepsilon_0} \\left( \\frac{1}{\\varepsilon} - 1 \\right)\n$$\nThe units of this constant are energy multiplied by length per mole, which in the SI system are $\\mathrm{J \\cdot m \\cdot mol^{-1}}$. The solvation free energy can then be expressed in a simplified form:\n$$\n\\Delta G_{\\text{solv}}(r) = \\frac{C_{\\text{Born}}}{r}\n$$\nThis reveals that the solvation free energy, within the Born model, is inversely proportional to the cavity radius $r$. This relationship is central to the sensitivity analysis.\n\nThe computational procedure for each test case with a nominal radius $r_0$ (given in ångströms) is as follows:\n1.  **Define Constants**: All physical constants ($N_{\\mathrm{A}}$, $e$, $\\varepsilon_0$) and model parameters ($z$, $\\varepsilon$) are defined in SI units.\n2.  **Pre-compute the Born Constant**: Calculate the value of $C_{\\text{Born}}$ using the values provided. This constant will be used for all subsequent calculations.\n3.  **Process Test Cases**: For each nominal radius $r_0$ from the test suite:\n    a. Convert $r_0$ from ångströms to meters using the conversion factor 1 Å = $10^{-10}$ m.\n    b. Define the perturbed radii: $r_{(-)} = 0.9 \\cdot r_0$ and $r_{(+)} = 1.1 \\cdot r_0$.\n    c. Calculate the nominal solvation free energy $\\Delta G_0$ using the formula $\\Delta G_{\\text{solv}}(r_0) = C_{\\text{Born}} / r_0$. The result, in $\\mathrm{J \\cdot mol^{-1}}$, is converted to $\\mathrm{kJ \\cdot mol^{-1}}$ by dividing by $1000$.\n    d. Calculate the perturbed free energies, $\\Delta G_{(-)} = C_{\\text{Born}} / r_{(-)}$ and $\\Delta G_{(+)} = C_{\\text{Born}} / r_{(+)}$, and convert them to $\\mathrm{kJ \\cdot mol^{-1}}$.\n    e. Compute the required absolute errors: $\\text{Err}_{(-)} = |\\Delta G_{(-)} - \\Delta G_0|$ and $\\text{Err}_{(+)} = |\\Delta G_{(+)} - \\Delta G_0|$.\n4.  **Format Output**: The three resulting floating-point numbers ($\\Delta G_0$, $\\text{Err}_{(-)}$, $\\text{Err}_{(+)}$) are collected for each test case. These lists of results are then formatted into a final string as specified by the problem statement.\n\nThis step-by-step procedure provides a direct and rigorous path to the solution. The negative sign of $\\Delta G_{\\text{solv}}$ indicates that the solvation process for an ion in a polar solvent is spontaneous. The sensitivity analysis will demonstrate that the calculated energy is highly dependent on the choice of the cavity radius, a known limitation and critical parameter of continuum models. A smaller radius leads to a more negative (more favorable) solvation energy, and the magnitude of change is non-linear, as seen in the errors. The error for a $-10\\%$ change in radius is larger than the error for a $+10\\%$ change, as expected from the $1/r$ dependence.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of the solvation free energy of Cl-\n    to the cavity radius in the Born model.\n    \"\"\"\n    # Define physical constants and parameters in SI units.\n    NA = 6.02214076e23  # Avogadro's number (mol^-1)\n    e = 1.602176634e-19  # Elementary charge (C)\n    eps0 = 8.8541878128e-12 # Vacuum permittivity (F m^-1 or C^2 J^-1 m^-1)\n    z = -1.0             # Charge number for Cl-\n    eps_r = 78.37        # Relative permittivity of water\n    \n    # Define the list of nominal cavity radii in ångströms.\n    test_cases_r0_angstrom = [1.60, 1.81, 2.00, 2.20]\n\n    # Pre-calculate the constant part of the Born equation.\n    # The result has units of J * m / mol.\n    born_constant = (NA * (z * e)**2 / (8 * np.pi * eps0)) * (1.0 / eps_r - 1.0)\n\n    def calculate_g_solv_kj_mol(r_angstrom):\n        \"\"\"\n        Calculates the solvation free energy in kJ/mol for a given radius in ångströms.\n        \"\"\"\n        if r_angstrom = 0:\n            raise ValueError(\"Radius must be positive.\")\n        \n        # Convert radius from ångströms to meters.\n        r_meter = r_angstrom * 1.0e-10\n        \n        # Calculate solvation free energy in J/mol.\n        g_solv_j_mol = born_constant / r_meter\n        \n        # Convert to kJ/mol.\n        return g_solv_j_mol / 1000.0\n\n    # Store the results for all test cases.\n    all_results = []\n    \n    for r0_a in test_cases_r0_angstrom:\n        # Define the perturbed radii.\n        r_minus_a = 0.9 * r0_a\n        r_plus_a = 1.1 * r0_a\n\n        # Calculate the solvation free energies in kJ/mol.\n        g0 = calculate_g_solv_kj_mol(r0_a)\n        g_minus = calculate_g_solv_kj_mol(r_minus_a)\n        g_plus = calculate_g_solv_kj_mol(r_plus_a)\n\n        # Calculate the absolute errors.\n        err_minus = abs(g_minus - g0)\n        err_plus = abs(g_plus - g0)\n        \n        # Append the list of three required values.\n        all_results.append([g0, err_minus, err_plus])\n\n    # Format the final output string according to the specification.\n    # Each number is rounded to 2 decimal places.\n    formatted_sublists = []\n    for result_set in all_results:\n        g, err_m, err_p = result_set\n        formatted_sublists.append(f\"[{g:.2f},{err_m:.2f},{err_p:.2f}]\")\n\n    final_output_string = f\"[{','.join(formatted_sublists)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2462575"}, {"introduction": "Having explored the solvation of simple ions, we now turn our attention to neutral molecules that possess a dipole moment. The Onsager reaction field model provides a framework for understanding how a polar solvent stabilizes a solute's dipole, with the degree of stabilization depending on the solvent's polarity. In this practice [@problem_id:2462628], you will apply this model to a classic chemical problem: the keto-enol tautomerism. By calculating how the equilibrium between the two forms shifts as the solvent permittivity changes, you will see firsthand how continuum models can predict and explain observable chemical phenomena.", "problem": "A dipolar-solvation model is used to analyze solvent polarity effects on the keto–enol tautomeric equilibrium of acetylacetone. The keto and enol tautomers are modeled as point dipoles located at the centers of spherical cavities embedded in a homogeneous, isotropic, linear dielectric continuum. The electrostatic solvation free energy of a dipole with magnitude $\\,\\mu\\,$ (in Coulomb meter) at the center of a spherical cavity of radius $\\,a\\,$ (in meter) in a medium of relative permittivity $\\,\\varepsilon\\,$ is given by\n$$\n\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu,a) = -\\,\\frac{N_{\\mathrm{A}}\\,\\mu^2}{8\\pi \\varepsilon_0\\,a^3}\\,\\frac{\\varepsilon-1}{2\\varepsilon+1},\n$$\nwhere $\\,\\varepsilon_0\\,$ is the vacuum permittivity and $\\,N_{\\mathrm{A}}\\,$ is the Avogadro constant. The gas-phase standard free energy difference between tautomers is defined as $\\,\\Delta G_{\\mathrm{gas}} = G_{\\mathrm{keto}} - G_{\\mathrm{enol}}\\,$ at temperature $\\,T\\,$. In a solvent of permittivity $\\,\\varepsilon\\,$, the standard free energy difference becomes\n$$\n\\Delta G_{\\mathrm{tot}}(\\varepsilon) = \\Delta G_{\\mathrm{gas}} + \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{k}},a_{\\mathrm{k}}) - \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{e}},a_{\\mathrm{e}}),\n$$\nwith $\\,\\mu_{\\mathrm{k}}\\,$ and $\\,a_{\\mathrm{k}}\\,$ the dipole moment and cavity radius of the keto tautomer, and $\\,\\mu_{\\mathrm{e}}\\,$ and $\\,a_{\\mathrm{e}}\\,$ those of the enol tautomer. The equilibrium constant for keto relative to enol is\n$$\nK(\\varepsilon) = \\exp\\!\\left(-\\frac{\\Delta G_{\\mathrm{tot}}(\\varepsilon)}{R\\,T}\\right),\n$$\nwhere $\\,R\\,$ is the ideal gas constant. The mole fraction of the enol tautomer at equilibrium is then\n$$\nx_{\\mathrm{enol}}(\\varepsilon) = \\frac{1}{1 + K(\\varepsilon)}.\n$$\n\nUse the following physically grounded parameters for acetylacetone at temperature $\\,T = 298.15\\,$ K:\n- Gas-phase free energy difference: $\\,\\Delta G_{\\mathrm{gas}} = 12000\\,$ J/mol.\n- Keto tautomer dipole moment: $\\,\\mu_{\\mathrm{k}} = 4.0\\,$ Debye.\n- Enol tautomer dipole moment: $\\,\\mu_{\\mathrm{e}} = 1.7\\,$ Debye.\n- Keto tautomer cavity radius: $\\,a_{\\mathrm{k}} = 3.0\\,$ Ångström.\n- Enol tautomer cavity radius: $\\,a_{\\mathrm{e}} = 3.3\\,$ Ångström.\n\nUse the following constants:\n- Vacuum permittivity: $\\,\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,$ F/m.\n- Avogadro constant: $\\,N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\,$ mol$^{-1}$.\n- Ideal gas constant: $\\,R = 8.31446261815324\\,$ J/(mol·K).\n\nRequired unit conversions:\n- $\\,1\\,$ Debye $= 3.33564\\times 10^{-30}\\,$ C·m.\n- $\\,1\\,$ Ångström $= 1.0\\times 10^{-10}\\,$ m.\n\nTask: For each value of relative permittivity $\\,\\varepsilon\\,$ in the test suite\n$$\n[\\;1.0,\\;2.0,\\;10.0,\\;78.4,\\;200.0\\;],\n$$\ncompute the enol mole fraction $\\,x_{\\mathrm{enol}}(\\varepsilon)\\,$ as a dimensionless decimal. Express each result rounded to exactly six decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\mathrm{r}_1,\\mathrm{r}_2,\\dots]$). The output must be a list of five floats corresponding, in order, to the test permittivities given above.", "solution": "We aim to determine how solvent polarity, quantified by the relative permittivity $\\,\\varepsilon\\,$, affects the keto–enol equilibrium of acetylacetone using a continuum electrostatics model. The framework is the Onsager reaction field model, which provides the electrostatic solvation free energy $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu,a)\\,$ for a dipole $\\,\\mu\\,$ at the center of a spherical cavity of radius $\\,a\\,$ embedded in a dielectric medium of permittivity $\\,\\varepsilon\\,$:\n$$\n\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu,a) = -\\,\\frac{N_{\\mathrm{A}}\\,\\mu^2}{8\\pi \\varepsilon_0\\,a^3}\\,\\frac{\\varepsilon-1}{2\\varepsilon+1}.\n$$\nThis expression follows from classical electrostatics by computing the work of polarizing the medium and converting single-molecule energy to molar units via the Avogadro constant $\\,N_{\\mathrm{A}}\\,$. The solvation favors larger dipole moments and smaller cavity radii, with the stabilization increasing monotonically with $\\,\\varepsilon\\,$ through the factor $\\,(\\varepsilon-1)/(2\\varepsilon+1)\\,$, which is zero at $\\,\\varepsilon=1\\,$ and approaches $\\,1/2\\,$ as $\\,\\varepsilon\\to\\infty$.\n\nThe total standard free energy difference between keto and enol in the solvent is\n$$\n\\Delta G_{\\mathrm{tot}}(\\varepsilon) = \\Delta G_{\\mathrm{gas}} + \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{k}},a_{\\mathrm{k}}) - \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{e}},a_{\\mathrm{e}}),\n$$\nwhere $\\,\\Delta G_{\\mathrm{gas}} = G_{\\mathrm{keto}} - G_{\\mathrm{enol}}\\,$ is given at $\\,T=298.15\\,$ K. A positive $\\,\\Delta G_{\\mathrm{tot}}\\,$ means the keto tautomer is less stable than the enol tautomer in the specified solvent. The equilibrium constant for keto relative to enol is the standard thermodynamic relation\n$$\nK(\\varepsilon) = \\exp\\!\\left(-\\frac{\\Delta G_{\\mathrm{tot}}(\\varepsilon)}{R\\,T}\\right),\n$$\nand the enol mole fraction is\n$$\nx_{\\mathrm{enol}}(\\varepsilon) = \\frac{1}{1+K(\\varepsilon)}.\n$$\n\nAll quantities must be used in consistent International System of Units (SI). Therefore, convert the given dipole moments and radii as\n$$\n\\mu_{\\mathrm{k}} = 4.0 \\times (3.33564\\times 10^{-30})\\;\\mathrm{C\\cdot m},\\quad\n\\mu_{\\mathrm{e}} = 1.7 \\times (3.33564\\times 10^{-30})\\;\\mathrm{C\\cdot m},\n$$\n$$\na_{\\mathrm{k}} = 3.0 \\times 10^{-10}\\;\\mathrm{m},\\quad\na_{\\mathrm{e}} = 3.3 \\times 10^{-10}\\;\\mathrm{m}.\n$$\nUse the constants\n$$\n\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\;\\mathrm{F/m},\\quad\nN_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\;\\mathrm{mol^{-1}},\\quad\nR = 8.31446261815324\\;\\mathrm{J/(mol\\cdot K)},\\quad\nT = 298.15\\;\\mathrm{K}.\n$$\n\nFor each $\\,\\varepsilon\\,$ in the test suite $[\\,1.0,\\,2.0,\\,10.0,\\,78.4,\\,200.0\\,]$, carry out the following computations in SI units:\n1. Compute $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{k}},a_{\\mathrm{k}})\\,$ and $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{e}},a_{\\mathrm{e}})\\,$ using the expression above.\n2. Form $\\,\\Delta G_{\\mathrm{tot}}(\\varepsilon)\\,$ via the difference of keto and enol solvation free energies added to $\\,\\Delta G_{\\mathrm{gas}}=12000\\,$ J/mol.\n3. Compute $\\,K(\\varepsilon) = \\exp\\!\\left(-\\Delta G_{\\mathrm{tot}}(\\varepsilon)/(R T)\\right)\\,$.\n4. Compute $\\,x_{\\mathrm{enol}}(\\varepsilon) = 1/(1+K(\\varepsilon))\\,$, a dimensionless decimal.\n\nQualitative expectations consistent with the model:\n- At $\\,\\varepsilon=1\\,$ (no solvent polarization), $\\,\\Delta G_{\\mathrm{solv}}=0\\,$ for both tautomers, hence $\\,\\Delta G_{\\mathrm{tot}}=\\Delta G_{\\mathrm{gas}}\\,,$ so $\\,x_{\\mathrm{enol}}\\,$ is close to $\\,1\\,$ because $\\,\\Delta G_{\\mathrm{gas}} > 0\\,$ favors the enol tautomer.\n- As $\\,\\varepsilon\\,$ increases, the solvation stabilization is larger for the keto tautomer due to its larger dipole moment and slightly smaller cavity radius, so $\\,\\Delta G_{\\mathrm{tot}}(\\varepsilon)\\,$ decreases, and $\\,x_{\\mathrm{enol}}(\\varepsilon)\\,$ decreases monotonically.\n- The factor $\\,(\\varepsilon-1)/(2\\varepsilon+1)\\,$ saturates to $\\,1/2\\,$ for large $\\,\\varepsilon\\,$, so there is a finite limit to the solvent-induced shift in this model.\n\nThe program implements these principles, performs unit-consistent calculations, evaluates $\\,x_{\\mathrmenol}(\\varepsilon)\\,$ for the specified $\\,\\varepsilon\\,$ values, rounds each to exactly six decimal places, and outputs a single list line in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef onsager_solvation_energy(mu_debye, a_angstrom, eps_r):\n    \"\"\"\n    Compute electrostatic solvation free energy (J/mol) via the Onsager reaction field model:\n    ΔG_solv(ε; μ, a) = - N_A * μ^2 / (8π ε0 a^3) * ( (ε - 1) / (2 ε + 1) )\n    Inputs:\n        mu_debye: dipole moment in Debye\n        a_angstrom: cavity radius in Ångström\n        eps_r: relative permittivity (dimensionless)\n    Returns:\n        ΔG_solv in J/mol (float)\n    \"\"\"\n    # Constants (SI)\n    eps0 = 8.8541878128e-12  # F/m\n    NA = 6.02214076e23       # 1/mol\n    # Unit conversions\n    mu = mu_debye * 3.33564e-30     # C·m\n    a = a_angstrom * 1.0e-10        # m\n    # Onsager factor\n    reaction_factor = (eps_r - 1.0) / (2.0 * eps_r + 1.0)\n    # Energy\n    dG = - NA * (mu**2) / (8.0 * np.pi * eps0 * (a**3)) * reaction_factor\n    return dG\n\ndef enol_fraction(eps_r, params):\n    \"\"\"\n    Compute enol mole fraction for a given relative permittivity.\n    params: dict with keys ΔG_gas (J/mol), mu_k (D), a_k (Å), mu_e (D), a_e (Å), T (K), R (J/mol/K)\n    \"\"\"\n    dG_gas = params[\"dG_gas\"]\n    mu_k = params[\"mu_k\"]\n    a_k = params[\"a_k\"]\n    mu_e = params[\"mu_e\"]\n    a_e = params[\"a_e\"]\n    T = params[\"T\"]\n    R = params[\"R\"]\n\n    dG_solv_k = onsager_solvation_energy(mu_k, a_k, eps_r)\n    dG_solv_e = onsager_solvation_energy(mu_e, a_e, eps_r)\n    dG_tot = dG_gas + dG_solv_k - dG_solv_e\n    K = np.exp(-dG_tot / (R * T))\n    x_enol = 1.0 / (1.0 + K)\n    return x_enol\n\ndef solve():\n    # Define the test cases from the problem statement (relative permittivities).\n    test_eps = [1.0, 2.0, 10.0, 78.4, 200.0]\n\n    # Physical parameters\n    params = {\n        \"dG_gas\": 12000.0,              # J/mol (G_keto - G_enol)\n        \"mu_k\": 4.0,                    # Debye\n        \"a_k\": 3.0,                     # Å\n        \"mu_e\": 1.7,                    # Debye\n        \"a_e\": 3.3,                     # Å\n        \"T\": 298.15,                    # K\n        \"R\": 8.31446261815324           # J/(mol·K)\n    }\n\n    results = []\n    for eps_r in test_eps:\n        x = enol_fraction(eps_r, params)\n        # Round to exactly six decimal places\n        x_str = f\"{x:.6f}\"\n        results.append(x_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2462628"}, {"introduction": "Our first two practices focused on implicit solvent models, which approximate the solvent as a featureless continuum. An alternative and more physically detailed approach is to use explicit solvent models, where individual solvent molecules are included in the simulation, typically using Molecular Dynamics (MD). While this method offers greater realism, it introduces a formidable challenge: the problem of adequate sampling. This final practice [@problem_id:2462631] is a conceptual exercise that moves beyond calculation to critical thinking. You will analyze several common simulation scenarios to develop the crucial skill of identifying when a simulation might fail, not because the model is wrong, but because the simulation time, $T_{\\text{sim}}$, was too short to capture the system's true behavior.", "problem": "An explicit-solvent Molecular Dynamics (MD) study aims to infer equilibrium properties at temperature $T=298$ K and pressure $p=1$ atm by simulating finite trajectories and estimating ensemble averages as time averages. Consider the following distinct computational projects. In each option, a team reaches a qualitative conclusion about a solvent-dependent property from a single explicit-solvent simulation. Which option(s) most directly exemplify a case where the explicit-solvent simulation yields a qualitatively wrong conclusion due to insufficient sampling time, rather than due to model form or observable definition? Select all that apply.\n\nA. A divalent cation $\\text{Ni}^{2+}$ in liquid water is simulated with explicit solvent for $T_{\\text{sim}}=2$ ns, starting from an octahedral first hydration shell. No inner-shell water exchange event is observed. The team concludes that first-shell waters do not exchange on laboratory timescales and that the inner-shell coordination is effectively permanent.\n\nB. The same $\\text{Ni}^{2+}$ system as in option A is simulated with explicit solvent for $T_{\\text{sim}}=10\\,\\mu\\text{s}$. Multiple inner-shell water exchange events are observed. The team concludes that first-shell waters exchange on the microsecond timescale.\n\nC. An acid–base equilibrium shift in water is computed using an implicit solvent Polarizable Continuum Model (PCM). A single geometry optimization and frequency calculation are performed per species, without explicit solvent or MD. The predicted shift has the wrong sign relative to experiment, and the team attributes it to insufficient sampling time.\n\nD. The relative stability between a contact ion pair (CIP) and a solvent-separated ion pair (SSIP) of $\\text{Ca}^{2+}$ and acetate $\\text{CH}_3\\text{COO}^-$ in liquid water is assessed with explicit-solvent MD. A single $T_{\\text{sim}}=1$ ns trajectory is started from the CIP geometry; no separation to SSIP is observed. The team concludes that the CIP is thermodynamically preferred at infinite dilution.\n\nE. The mass density of pure liquid water at $T=298$ K is computed by explicit-solvent MD for $T_{\\text{sim}}=1$ ns with a standard nonpolarizable water model. The result is $0.997\\,\\text{g\\,cm}^{-3}$. The team concludes that the density is close to the experimental value and that their sampling was sufficient for this observable.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Methodology**: Explicit-solvent Molecular Dynamics (MD)\n- **Thermodynamic Conditions**: Temperature $T=298$ K, pressure $p=1$ atm.\n- **Goal**: Infer equilibrium properties.\n- **Averaging**: Ensemble averages are estimated as time averages from finite trajectories.\n- **Core Task**: Identify which option(s) present a scenario where an explicit-solvent simulation leads to a qualitatively wrong conclusion specifically due to insufficient sampling time, as opposed to errors in the model's formulation or the definition of the observable.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. It addresses a fundamental concept in computational statistical mechanics: the ergodic hypothesis and the critical issue of convergence and sampling error in molecular simulations. The scenarios described are standard problems in computational chemistry (ion solvation, chemical equilibria, bulk properties of liquids). The problem is well-posed, asking to identify examples that match a clear and specific set of criteria. The language is objective and precise. The problem is self-contained, providing all necessary context within each option for its evaluation.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. A solution will be derived.\n\n**Derivation and Option Analysis**\n\nThe central principle is the relationship between simulation time, $T_{\\text{sim}}$, and the characteristic relaxation time, $\\tau$, of the physical processes governing the system's equilibrium. According to the ergodic hypothesis, a time average from a single, sufficiently long trajectory converges to the true ensemble average. This requires $T_{\\text{sim}} \\gg \\tau$ for all relevant processes. If a simulation is run for a time $T_{\\text{sim}}$ that is much shorter than the timescale of a slow, but important, process ($\\tau_{\\text{slow}}$), the system will not adequately sample all relevant regions of its phase space. Such insufficient sampling can lead to qualitatively incorrect conclusions about thermodynamics (e.g., relative stability of states) or kinetics (e.g., whether a process occurs at all). The task is to identify cases where this specific failure mode occurs.\n\n**Option A: $\\text{Ni}^{2+}$ in water, $T_{\\text{sim}}=2$ ns**\n- **Analysis**: This option describes simulating a $\\text{Ni}^{2+}$ ion in water for $T_{\\text{sim}}=2$ ns. The conclusion drawn from observing no water exchange events is that the coordination is \"effectively permanent\" on laboratory timescales. Experimentally, the mean residence time for a water molecule in the first hydration shell of $\\text{Ni}^{2+}$ at $T=298$ K is on the order of $\\tau \\approx 30\\,\\mu\\text{s}$ ($3 \\times 10^{-5}$ s). The simulation time of $2$ ns ($2 \\times 10^{-9}$ s) is more than four orders of magnitude shorter than the characteristic time of the exchange process. The simulation is far too short to capture this rare event. Concluding that the process does not happen on laboratory timescales (which can be seconds to hours) and that coordination is \"permanent\" is a qualitatively wrong conclusion. This error arises directly and exclusively from insufficient sampling time. The model or force field could be perfect, but without adequate time, the event cannot be observed.\n- **Verdict**: **Correct**. This is a canonical example of insufficient sampling leading to a qualitatively incorrect conclusion about system dynamics.\n\n**Option B: $\\text{Ni}^{2+}$ in water, $T_{\\text{sim}}=10\\,\\mu\\text{s}$**\n- **Analysis**: This option increases the simulation time to $T_{\\text{sim}}=10\\,\\mu\\text{s}$ for the same system. This duration is now on the same order of magnitude as the experimental exchange timescale ($\\approx 30\\,\\mu\\text{s}$). Observing \"multiple\" exchange events is therefore expected. The conclusion that water exchanges on the microsecond timescale is qualitatively correct. While the statistics gathered from a $10\\,\\mu\\text{s}$ run might not be sufficient for a precise quantitative rate calculation, the qualitative nature of the process is correctly identified. The problem asks for cases with a \"qualitatively wrong conclusion.\" This is not one of them.\n- **Verdict**: **Incorrect**. The simulation time is sufficient to observe the qualitative phenomenon, and the conclusion is qualitatively correct.\n\n**Option C: Implicit solvent calculation**\n- **Analysis**: This option describes a calculation using an implicit solvent model (PCM), not an explicit-solvent MD simulation. The calculation is static, involving a single geometry optimization and frequency calculation for each species. There is no concept of \"sampling time\" in the context of a trajectory, as no trajectory is generated. The attribution of the incorrect result to \"insufficient sampling time\" is a misunderstanding of the method. The error in a PCM calculation stems from the model's form (approximations in the continuum model, the quantum mechanical level of theory, etc.), not from a failure to sample phase space over time.\n- **Verdict**: **Incorrect**. This scenario does not use an explicit-solvent simulation, a primary condition of the problem statement.\n\n**Option D: $\\text{Ca}^{2+}$ and acetate ion pair, $T_{\\text{sim}}=1$ ns**\n- **Analysis**: This option describes a $1$ ns MD simulation of a $\\text{Ca}^{2+}$-acetate contact ion pair (CIP). The simulation starts in the CIP state and does not observe dissociation into a solvent-separated ion pair (SSIP). The conclusion drawn is that the CIP is \"thermodynamically preferred at infinite dilution.\" This conclusion is wrong for several reasons, all rooted in sampling. First, the transition from CIP to SSIP is an activated process with a free energy barrier. A simulation time of $1$ ns is often insufficient to observe such transitions for divalent cations. The system is likely trapped in the local free energy minimum corresponding to the CIP state. Concluding this state is the global minimum based on a short run is a classic sampling error. Second, the conclusion about \"infinite dilution\" is particularly flawed. At infinite dilution, the thermodynamically stable state is, by definition, one of fully separated and solvated ions, not a CIP or SSIP. The failure to observe dissociation due to the short simulation leads to a qualitatively incorrect conclusion about the system's equilibrium.\n- **Verdict**: **Correct**. This is another clear example of insufficient sampling of a slow coordinate (inter-ionic distance) leading to a qualitatively wrong thermodynamic conclusion.\n\n**Option E: Density of pure water, $T_{\\text{sim}}=1$ ns**\n- **Analysis**: This option concerns the calculation of the mass density of pure water, a bulk property that does not depend on rare events. The motions that determine density (local vibrations, librations, and translations) occur on femtosecond to picosecond timescales. A simulation of $T_{\\text{sim}}=1$ ns is generally considered more than adequate to obtain a statistically converged value for the density of water. The computed result of $0.997\\,\\text{g\\,cm}^{-3}$ is in excellent agreement with the experimental value at $T=298$ K. The team's conclusion that their sampling was sufficient for this particular observable is therefore correct. The problem asks for a case with a qualitatively wrong conclusion, which is not what is presented here.\n- **Verdict**: **Incorrect**. The conclusion is not qualitatively wrong; in fact, the sampling is sufficient for this rapidly converging property, and the conclusion reflects this.", "answer": "$$\\boxed{AD}$$", "id": "2462631"}]}