{"hands_on_practices": [{"introduction": "To truly grasp the mean-field concept, we must first build its central mathematical construct: the Fock matrix. This exercise strips the problem down to its simplest, non-trivial form—the helium atom—allowing you to manually assemble the Fock matrix from its fundamental components. By directly applying the rules of Hartree-Fock theory, you will see how the intimidating many-electron problem is approximated by an effective one-electron picture, distinguishing between the core energy, the classical Coulomb repulsion, and the purely quantum mechanical exchange interaction [@problem_id:2463880].", "problem": "Consider the helium atom with nuclear charge $Z=2$ and two electrons, described in atomic units. Use the restricted Hartree–Fock (RHF) mean-field approximation with a minimal Slater-type orbital with one Gaussian (STO-1G) spatial basis consisting of a single normalized $1s$-type function $\\chi(\\mathbf{r})$ centered on the nucleus. Construct the $2 \\times 2$ Fock matrix in the spin-orbital basis $\\{\\chi\\alpha,\\ \\chi\\beta\\}$, where $\\alpha$ and $\\beta$ denote the spin functions. Let the one-electron core Hamiltonian be $\\hat{h}=-\\frac{1}{2}\\nabla^{2}-\\frac{Z}{r}$, and define the one-electron integral $h_{11}=\\langle \\chi|\\hat{h}|\\chi\\rangle$ and the two-electron Coulomb integral $(11|11)=\\iint |\\chi(\\mathbf{r}_{1})|^{2}\\,\\frac{1}{r_{12}}\\,|\\chi(\\mathbf{r}_{2})|^{2}\\,d\\mathbf{r}_{1}\\,d\\mathbf{r}_{2}$. Using the mean-field definition of the Fock operator for a closed-shell system, write the $2 \\times 2$ Fock matrix explicitly in terms of $h_{11}$ and $(11|11)$, clearly identifying within your expression which contributions arise from Coulomb and which from exchange effects. Express your final answer as the analytic $2 \\times 2$ matrix in terms of $h_{11}$ and $(11|11)$. No numerical evaluation is required.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It poses a standard, solvable problem in computational quantum chemistry. Therefore, a solution will be provided.\n\nThe objective is to construct the Fock matrix $\\mathbf{F}$ for the helium atom in the restricted Hartree-Fock (RHF) approximation. The basis consists of two spin-orbitals, $\\psi_1 = \\chi\\alpha$ and $\\psi_2 = \\chi\\beta$, where $\\chi$ is a single normalized $1s$ spatial orbital and $\\alpha$, $\\beta$ are the spin-up and spin-down functions, respectively. For a closed-shell system like ground-state helium, these two spin-orbitals are the occupied orbitals.\n\nThe general expression for a matrix element of the Fock operator $\\hat{f}$ in an orthonormal spin-orbital basis $\\{\\psi_p\\}$ is given by:\n$$F_{pq} = \\langle \\psi_p | \\hat{f} | \\psi_q \\rangle = \\langle \\psi_p | \\hat{h} | \\psi_q \\rangle + \\sum_{j}^{\\text{occ}} \\left[ \\langle \\psi_p \\psi_j | \\frac{1}{r_{12}} | \\psi_q \\psi_j \\rangle - \\langle \\psi_p \\psi_j | \\frac{1}{r_{12}} | \\psi_j \\psi_q \\rangle \\right]$$\nHere, $\\hat{h}$ is the one-electron core Hamiltonian, the sum runs over all occupied spin-orbitals, and the two-electron integrals are in physicist's notation, i.e., $\\langle ij | kl \\rangle = \\iint \\psi_i^*(\\mathbf{x}_1) \\psi_j^*(\\mathbf{x}_2) \\frac{1}{r_{12}} \\psi_k(\\mathbf{x}_1) \\psi_l(\\mathbf{x}_2) d\\mathbf{x}_1 d\\mathbf{x}_2$. The first term in the summation is the Coulomb contribution ($J_{pq}$), and the second is the exchange contribution ($K_{pq}$).\n\nIn this problem, the set of occupied spin-orbitals is $\\{\\psi_1, \\psi_2\\}$. We must calculate the four elements of the $2 \\times 2$ Fock matrix: $F_{11}$, $F_{12}$, $F_{21}$, and $F_{22}$.\n\nCalculation of the diagonal element $F_{11}$:\nWe set $p=q=1$. The summation runs over $j=1, 2$.\n$$F_{11} = \\langle \\psi_1 | \\hat{h} | \\psi_1 \\rangle + \\sum_{j=1}^{2} \\left[ \\langle 1j | 1j \\rangle - \\langle 1j | j1 \\rangle \\right]$$\nThe one-electron term is $\\langle \\psi_1 | \\hat{h} | \\psi_1 \\rangle = \\langle \\chi\\alpha | \\hat{h} | \\chi\\alpha \\rangle$. Since $\\hat{h}$ is spin-independent, this separates into a spatial and a spin integral: $\\langle \\chi | \\hat{h} | \\chi \\rangle \\langle \\alpha | \\alpha \\rangle$. Given $\\langle \\alpha | \\alpha \\rangle=1$ and the definition $h_{11} = \\langle \\chi | \\hat{h} | \\chi \\rangle$, this term is simply $h_{11}$.\n\nThe two-electron terms are evaluated for $j=1$ and $j=2$:\nFor $j=1$: The contribution is $\\langle 11 | 11 \\rangle - \\langle 11 | 11 \\rangle = 0$. This represents the exact cancellation of the Coulomb self-interaction by the exchange self-interaction, a fundamental property of Hartree-Fock theory.\nFor $j=2$: The contribution is $\\langle 12 | 12 \\rangle - \\langle 12 | 21 \\rangle$.\nThe Coulomb term is $\\langle 12 | 12 \\rangle = \\langle \\psi_1 \\psi_2 | \\frac{1}{r_{12}} | \\psi_1 \\psi_2 \\rangle = \\langle \\chi\\alpha \\chi\\beta | \\frac{1}{r_{12}} | \\chi\\alpha \\chi\\beta \\rangle$. The spatial part of this integral is $\\iint |\\chi(\\mathbf{r}_1)|^2 \\frac{1}{r_{12}} |\\chi(\\mathbf{r}_2)|^2 d\\mathbf{r}_1 d\\mathbf{r}_2$, which is defined as $(11|11)$. The spin part is $\\langle \\alpha | \\alpha \\rangle \\langle \\beta | \\beta \\rangle = 1 \\times 1 = 1$. Thus, the Coulomb term is $(11|11)$.\nThe exchange term is $\\langle 12 | 21 \\rangle = \\langle \\psi_1 \\psi_2 | \\frac{1}{r_{12}} | \\psi_2 \\psi_1 \\rangle = \\langle \\chi\\alpha \\chi\\beta | \\frac{1}{r_{12}} | \\chi\\beta \\chi\\alpha \\rangle$. The spatial part is again $(11|11)$. The spin part is $\\langle \\alpha | \\beta \\rangle \\langle \\beta | \\alpha \\rangle = 0 \\times 0 = 0$ due to the orthogonality of spin functions. Thus, the exchange term is $0$.\n\nCombining all parts for $F_{11}$:\n$F_{11} = h_{11} + 0 + [(11|11) - 0] = h_{11} + (11|11)$.\nThe two-electron contribution to this matrix element is entirely from the Coulomb interaction between the electron in $\\psi_1$ and the electron in $\\psi_2$.\n\nCalculation of the diagonal element $F_{22}$:\nBy symmetry, the calculation for $F_{22}$ is identical to that for $F_{11}$, with the roles of $\\alpha$ and $\\beta$ spin functions interchanged.\n$F_{22} = \\langle \\psi_2 | \\hat{h} | \\psi_2 \\rangle + \\sum_{j=1}^{2} \\left[ \\langle 2j | 2j \\rangle - \\langle 2j | j2 \\rangle \\right]$.\nThe core term is $\\langle \\chi\\beta | \\hat{h} | \\chi\\beta \\rangle = h_{11}$.\nThe sum for $j=2$ gives the self-interaction cancellation. The sum for $j=1$ gives the interaction with the other electron: the Coulomb part is $(11|11)$ and the exchange part is $0$.\nTherefore, $F_{22} = h_{11} + (11|11)$.\n\nCalculation of the off-diagonal element $F_{12}$:\nWe set $p=1, q=2$.\n$$F_{12} = \\langle \\psi_1 | \\hat{h} | \\psi_2 \\rangle + \\sum_{j=1}^{2} \\left[ \\langle 1j | 2j \\rangle - \\langle 1j | j2 \\rangle \\right]$$\nThe one-electron term is $\\langle \\psi_1 | \\hat{h} | \\psi_2 \\rangle = \\langle \\chi\\alpha | \\hat{h} | \\chi\\beta \\rangle = \\langle \\chi | \\hat{h} | \\chi \\rangle \\langle \\alpha | \\beta \\rangle = h_{11} \\cdot 0 = 0$.\nThe two-electron terms are also zero due to spin orthogonality. For any $j$, the spin integrals will involve an inner product of the form $\\langle \\alpha | \\beta \\rangle$ or $\\langle \\beta | \\alpha \\rangle$, which are zero. For instance, for $j=1$:\n$\\langle 11 | 21 \\rangle = \\langle \\chi\\alpha \\chi\\alpha | \\frac{1}{r_{12}} | \\chi\\beta \\chi\\alpha \\rangle \\propto \\langle \\alpha | \\beta \\rangle \\langle \\alpha | \\alpha \\rangle = 0$.\n$\\langle 11 | 12 \\rangle = \\langle \\chi\\alpha \\chi\\alpha | \\frac{1}{r_{12}} | \\chi\\alpha \\chi\\beta \\rangle \\propto \\langle \\alpha | \\alpha \\rangle \\langle \\alpha | \\beta \\rangle = 0$.\nA similar analysis for $j=2$ also yields zero.\nTherefore, $F_{12} = 0$.\n\nCalculation of the off-diagonal element $F_{21}$:\nThe Fock matrix must be Hermitian, so $F_{21} = F_{12}^* = 0$. An explicit calculation confirms this, as all terms will again involve an orthogonal spin inner product $\\langle \\beta | \\alpha \\rangle=0$.\n\nThe resulting Fock matrix is diagonal, which is expected as the spin-orbitals $\\psi_1$ and $\\psi_2$ are the canonical Hartree-Fock orbitals for this system. The diagonal elements represent the orbital energies, which are degenerate for the $\\alpha$ and $\\beta$ spins in the RHF formalism. The Fock matrix $\\mathbf{F}$ is:\n$$\\mathbf{F} = \\begin{pmatrix} F_{11} & F_{12} \\\\ F_{21} & F_{22} \\end{pmatrix} = \\begin{pmatrix} h_{11} + (11|11) & 0 \\\\ 0 & h_{11} + (11|11) \\end{pmatrix}$$\nThe term $(11|11)$ in the diagonal elements is a pure Coulomb contribution, representing the repulsion experienced by an electron from the other electron in the second spin-orbital. The exchange contribution between the two electrons is zero due to their opposite spins.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nh_{11} + (11|11) & 0 \\\\\n0 & h_{11} + (11|11)\n\\end{pmatrix}\n}\n$$", "id": "2463880"}, {"introduction": "The previous practice assumed a spin-restricted formalism (RHF), where electrons of opposite spins share the same spatial orbital. But is this always the most stable arrangement? This problem investigates the critical concept of RHF/UHF instability using a simple two-site model, an analogue for dissociating a chemical bond. You will discover that as electron correlation becomes more significant (represented by a large on-site repulsion $U$), the symmetric RHF solution can become unstable, paving the way for a lower-energy, spin-polarized Unrestricted Hartree-Fock (UHF) solution [@problem_id:2463835].", "problem": "Consider a homonuclear diatomic \"molecule\" modeled as a two-site Hubbard dimer at half filling (two electrons). The electronic Hamiltonian is\n$$\n\\hat{H} \\;=\\; -\\,t\\,\\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}}\\left(\\hat{c}_{1\\sigma}^\\dagger \\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^\\dagger \\hat{c}_{1\\sigma}\\right) \\;+\\; U \\sum_{i\\in\\{1,2\\}} \\hat{n}_{i\\uparrow}\\,\\hat{n}_{i\\downarrow},\n$$\nwhere $t$ is the hopping parameter, $U$ is the on-site electron repulsion, $\\hat{c}_{i\\sigma}^\\dagger$ and $\\hat{c}_{i\\sigma}$ create and annihilate an electron with spin $\\sigma$ on site $i$, and $\\hat{n}_{i\\sigma}=\\hat{c}_{i\\sigma}^\\dagger \\hat{c}_{i\\sigma}$. Use the Hartree–Fock (HF) mean-field approximation, in which the two-electron term is replaced by the product of one-electron densities according to\n$$\n\\hat{n}_{i\\uparrow}\\,\\hat{n}_{i\\downarrow}\\;\\approx\\;\\hat{n}_{i\\uparrow}\\,\\langle \\hat{n}_{i\\downarrow}\\rangle \\;+\\; \\langle \\hat{n}_{i\\uparrow}\\rangle\\,\\hat{n}_{i\\downarrow}\\;-\\;\\langle \\hat{n}_{i\\uparrow}\\rangle\\,\\langle \\hat{n}_{i\\downarrow}\\rangle.\n$$\nIn the Restricted Hartree–Fock (RHF) approximation, impose spin symmetry at each site so that $\\langle \\hat{n}_{i\\uparrow}\\rangle=\\langle \\hat{n}_{i\\downarrow}\\rangle$ for each $i$. In the Unrestricted Hartree–Fock (UHF) approximation, do not impose this constraint. Define that the RHF state is unstable if there exists a self-consistent UHF state whose mean-field energy is strictly lower than that of any spin-symmetric (RHF) state for the same $(t,U)$.\n\nTask: For each parameter pair $(t,U)$ in the test suite below, determine whether the RHF state is unstable according to the definition above. Your program must solve the mean-field problem in a logically consistent manner based only on the definitions given and report, for each case, a boolean value that is true if the RHF state is unstable and false otherwise. No user input is required.\n\nTest suite (each pair is $(t,U)$ with $t$ and $U$ in the same arbitrary energy units):\n- (1.0, 0.5)\n- (1.0, 2.0)\n- (1.0, 3.0)\n- (-1.0, 3.0)\n- (0.0, 0.5)\n- (0.5, 0.9)\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3}]$). Each result must be the literal boolean token true or false with an initial capital letter, with no spaces anywhere in the line, in the same order as the test suite.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem from the field of computational chemistry, specifically concerning the application of mean-field theory to a fundamental model of electron correlation, the Hubbard model. All terms are clearly defined, and the task is an objective calculation based on provided principles. We shall proceed with the derivation.\n\nThe problem requires a comparison between the ground state energies of the Restricted Hartree-Fock (RHF) and Unrestricted Hartree-Fock (UHF) approximations for a two-site, two-electron Hubbard model. The RHF state is defined as unstable if a self-consistent UHF state exists with a strictly lower mean-field energy.\n\nThe Hamiltonian is given by\n$$\n\\hat{H} = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} (\\hat{c}_{1\\sigma}^\\dagger \\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^\\dagger \\hat{c}_{1\\sigma}) + U \\sum_{i\\in\\{1,2\\}} \\hat{n}_{i\\uparrow}\\,\\hat{n}_{i\\downarrow}\n$$\nThe Hartree-Fock approximation linearizes the two-electron term:\n$$\n\\hat{n}_{i\\uparrow}\\,\\hat{n}_{i\\downarrow} \\approx \\hat{n}_{i\\uparrow}\\,\\langle \\hat{n}_{i\\downarrow}\\rangle + \\langle \\hat{n}_{i\\uparrow}\\rangle\\,\\hat{n}_{i\\downarrow} - \\langle \\hat{n}_{i\\uparrow}\\rangle\\,\\langle \\hat{n}_{i\\downarrow}\\rangle\n$$\nThis results in a one-body mean-field Hamiltonian, $\\hat{H}_{MF}$, which can be separated into spin-up ($\\sigma=\\uparrow$) and spin-down ($\\sigma=\\downarrow$) components. The matrix representation of the one-electron Hamiltonian for spin $\\sigma$, $\\mathbf{h}_{\\sigma}$, in the site basis $\\{|1\\sigma\\rangle, |2\\sigma\\rangle\\}$ is:\n$$\n\\mathbf{h}_{\\sigma} = \\begin{pmatrix} U \\langle n_{1,-\\sigma} \\rangle & -t \\\\ -t & U \\langle n_{2,-\\sigma} \\rangle \\end{pmatrix}\n$$\nHere, $\\langle n_{i,-\\sigma} \\rangle$ are the average electron densities which must be determined self-consistently.\n\nFirst, we analyze the RHF solution. The RHF approximation imposes spin symmetry, $\\langle n_{i\\uparrow} \\rangle = \\langle n_{i\\downarrow} \\rangle$ for $i \\in \\{1, 2\\}$. For a homonuclear dimer, site symmetry gives $\\langle n_{1\\sigma} \\rangle = \\langle n_{2\\sigma} \\rangle$. Combining these, and knowing the system has two electrons in total, $\\sum_{i,\\sigma} \\langle n_{i\\sigma} \\rangle = 2$, we find that the densities are uniquely determined:\n$$\n\\langle n_{1\\uparrow} \\rangle = \\langle n_{1\\downarrow} \\rangle = \\langle n_{2\\uparrow} \\rangle = \\langle n_{2\\downarrow} \\rangle = \\frac{1}{2}\n$$\nThis solution is inherently self-consistent. The RHF Fock matrix is identical for both spins:\n$$\n\\mathbf{h}_{RHF} = \\begin{pmatrix} U/2 & -t \\\\ -t & U/2 \\end{pmatrix}\n$$\nThe eigenvalues are $\\epsilon_{\\pm} = U/2 \\pm |t|$. The ground state orbital energy is $\\epsilon_g = U/2 - |t|$. We have two electrons, so one spin-up and one spin-down electron occupy this lowest-energy molecular orbital. The mean-field energy, $E = \\langle \\hat{H}_{kin} \\rangle + U \\sum_i \\langle n_{i\\uparrow} \\rangle \\langle n_{i\\downarrow} \\rangle$, is calculated. The kinetic energy is twice the expectation value of the kinetic operator $\\hat{h}_{kin} = -t(\\hat{c}_{1}^\\dagger\\hat{c}_{2}+\\hat{c}_{2}^\\dagger\\hat{c}_{1})$ in the ground state orbital, which is $-2|t|$. The interaction term is $U((1/2)(1/2) + (1/2)(1/2)) = U/2$. Thus, the RHF ground state energy is:\n$$\nE_{RHF} = -2|t| + \\frac{U}{2}\n$$\n\nNext, we analyze the UHF solution. We relax the spin-symmetry constraint and look for a solution with spin polarization. We can parameterize the densities for an antiferromagnetic alignment:\n$$\n\\langle n_{1\\uparrow} \\rangle = \\frac{1+m}{2}, \\quad \\langle n_{1\\downarrow} \\rangle = \\frac{1-m}{2}\n$$\n$$\n\\langle n_{2\\uparrow} \\rangle = \\frac{1-m}{2}, \\quad \\langle n_{2\\downarrow} \\rangle = \\frac{1+m}{2}\n$$\nHere, $m$ is the magnetization parameter. The RHF solution corresponds to $m=0$. An unstable RHF implies a stable UHF solution with $m \\neq 0$ and lower energy exists. The UHF Fock matrices for spin-up and spin-down are:\n$$\n\\mathbf{h}_{\\uparrow} = \\begin{pmatrix} U(1-m)/2 & -t \\\\ -t & U(1+m)/2 \\end{pmatrix}, \\quad \\mathbf{h}_{\\downarrow} = \\begin{pmatrix} U(1+m)/2 & -t \\\\ -t & U(1-m)/2 \\end{pmatrix}\n$$\nTo find a self-consistent solution, the densities calculated from the eigenvectors of these matrices must match the densities used to construct them. The on-site density difference for spin-$\\sigma$ is $\\langle n_{1\\sigma} \\rangle - \\langle n_{2\\sigma} \\rangle$. For the ground state eigenvector of a $2 \\times 2$ matrix $\\begin{pmatrix} a & c \\\\ c & b \\end{pmatrix}$, this difference is given by $-\\frac{a-b}{\\sqrt{(a-b)^2 + 4c^2}}$.\nFor the spin-up channel, we have $a-b = -Um$ and $c=-t$. The self-consistency condition is:\n$$\nm = \\langle n_{1\\uparrow} \\rangle - \\langle n_{2\\uparrow} \\rangle = - \\frac{-Um}{\\sqrt{(-Um)^2 + 4(-t)^2}} = \\frac{Um}{\\sqrt{U^2m^2 + 4t^2}}\n$$\nFor the spin-down channel, $a-b = Um$, giving:\n$$\n-m = \\langle n_{1\\downarrow} \\rangle - \\langle n_{2\\downarrow} \\rangle = - \\frac{Um}{\\sqrt{(Um)^2 + 4(-t)^2}} = \\frac{-Um}{\\sqrt{U^2m^2 + 4t^2}}\n$$\nBoth equations reduce to $m (1 - \\frac{U}{\\sqrt{U^2m^2 + 4t^2}}) = 0$. This equation has two types of solutions:\n1. The trivial solution, $m=0$, which is the RHF solution.\n2. A non-trivial solution ($m\\neq 0$) if $1 = \\frac{U}{\\sqrt{U^2m^2 + 4t^2}}$. This requires $U>0$. Squaring both sides yields $U^2 = U^2 m^2 + 4t^2$, which gives $m^2 = 1 - (2|t|/U)^2$. A real solution for $m \\neq 0$ exists only if $1 - (2|t|/U)^2 > 0$, which simplifies to the condition $U > 2|t|$.\n\nIf $U \\le 2|t|$, only the $m=0$ (RHF) solution is self-consistent, so the RHF state is stable.\nIf $U > 2|t|$, a broken-symmetry UHF solution with $m = \\sqrt{1 - (2|t|/U)^2}$ exists. We must check if its energy is lower than $E_{RHF}$.\nThe UHF total energy is $E_{UHF} = \\langle \\hat{H}_{kin} \\rangle_{UHF} + U \\sum_i \\langle n_{i\\uparrow} \\rangle \\langle n_{i\\downarrow} \\rangle$.\nThe kinetic energy is $\\langle \\hat{H}_{kin} \\rangle_{UHF} = -2|t|\\sqrt{1-m^2}$. Using $m^2 = 1 - 4t^2/U^2$, we get $\\sqrt{1-m^2}=2|t|/U$. So, $\\langle \\hat{H}_{kin} \\rangle_{UHF} = -2|t|(2|t|/U) = -4t^2/U$.\nThe interaction energy is $U \\sum_i \\langle n_{i{\\uparrow}} \\rangle \\langle n_{i{\\downarrow}} \\rangle = U [ (\\frac{1+m}{2})(\\frac{1-m}{2}) + (\\frac{1-m}{2})(\\frac{1+m}{2}) ] = U\\frac{1-m^2}{2} = U\\frac{4t^2/U^2}{2} = \\frac{2t^2}{U}$.\nThe total UHF energy is:\n$$\nE_{UHF} = -\\frac{4t^2}{U} + \\frac{2t^2}{U} = -\\frac{2t^2}{U}\n$$\nNow we compare $E_{UHF}$ with $E_{RHF}$ for the regime $U > 2|t|$. The RHF state is unstable if $E_{UHF} < E_{RHF}$:\n$$\n-\\frac{2t^2}{U} < -2|t| + \\frac{U}{2}\n$$\nMultiplying by $2U$ (which is positive) preserves the inequality:\n$$\n-4t^2 < -4|t|U + U^2\n$$\n$$\n0 < U^2 - 4|t|U + 4t^2\n$$\n$$\n0 < (U-2|t|)^2\n$$\nThis inequality is strictly true whenever $U \\neq 2|t|$. Since the UHF solution only exists for $U>2|t|$, this condition is always met in that regime. Therefore, the RHF state is unstable if and only if $U > 2|t|$.\n\nWe apply this criterion to the given test cases:\n1. $(t,U) = (1.0, 0.5)$: Is $0.5 > 2 \\times |1.0|$? No, $0.5 \\ngtr 2.0$. Unstable: False.\n2. $(t,U) = (1.0, 2.0)$: Is $2.0 > 2 \\times |1.0|$? No, $2.0 \\ngtr 2.0$. Unstable: False.\n3. $(t,U) = (1.0, 3.0)$: Is $3.0 > 2 \\times |1.0|$? Yes, $3.0 > 2.0$. Unstable: True.\n4. $(t,U) = (-1.0, 3.0)$: Is $3.0 > 2 \\times |-1.0|$? Yes, $3.0 > 2.0$. Unstable: True.\n5. $(t,U) = (0.0, 0.5)$: Is $0.5 > 2 \\times |0.0|$? Yes, $0.5 > 0.0$. Unstable: True.\n6. $(t,U) = (0.5, 0.9)$: Is $0.9 > 2 \\times |0.5|$? No, $0.9 \\ngtr 1.0$. Unstable: False.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Hubbard dimer problem to determine RHF instability.\n    \"\"\"\n    \n    # Test suite (t, U) from the problem statement.\n    test_cases = [\n        (1.0, 0.5),\n        (1.0, 2.0),\n        (1.0, 3.0),\n        (-1.0, 3.0),\n        (0.0, 0.5),\n        (0.5, 0.9),\n    ]\n\n    results = []\n    for t, U in test_cases:\n        # According to the mean-field analysis of the two-site Hubbard model,\n        # the Restricted Hartree-Fock (RHF) solution becomes unstable with respect\n        # to a spin-polarized (UHF) solution if and only if the on-site repulsion U\n        # is strictly greater than twice the absolute value of the hopping parameter t.\n        # This condition is derived by seeking a self-consistent, broken-symmetry\n        # solution and comparing its energy to the RHF energy.\n        \n        # The instability condition is U > 2*|t|.\n        is_unstable = U > 2.0 * abs(t)\n        \n        # The output format requires the literal boolean tokens \"True\" or \"False\".\n        # Python's str() of a boolean produces the required format.\n        results.append(str(is_unstable))\n\n    # The final print statement must match the specified format exactly:\n    # A comma-separated list of boolean tokens enclosed in square brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2463835"}, {"introduction": "Having explored the theoretical conditions for RHF instability, we now put these ideas into practice by implementing the Unrestricted Hartree-Fock (UHF) method. This coding exercise uses a model of the allyl radical to guide you through a full self-consistent field (SCF) calculation where $\\alpha$ and $\\beta$ spin-orbitals are treated independently [@problem_id:2463834]. A crucial part of this practice is to calculate the spin contamination, a quantitative measure of how much the UHF wavefunction deviates from a pure spin state, offering deep insight into the practical consequences and limitations of this important mean-field model.", "problem": "A minimal mean-field model for the allyl radical is constructed from the three-site nearest-neighbor one-band Hubbard Hamiltonian acting on a chain of three carbon sites that host the three $\\pi$ electrons. In second quantization, the Hamiltonian is\n$$\n\\hat{H} \\;=\\; \\sum_{i=1}^{3} \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\varepsilon_i \\,\\hat{n}_{i\\sigma}\n\\;-\\; t \\sum_{\\langle i,j\\rangle}\\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\left( \\hat{c}^\\dagger_{i\\sigma}\\hat{c}_{j\\sigma} + \\hat{c}^\\dagger_{j\\sigma}\\hat{c}_{i\\sigma} \\right)\n\\;+\\; U \\sum_{i=1}^{3} \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta},\n$$\nwhere $t$ is the nearest-neighbor hopping parameter on the chain $(1\\text{--}2\\text{--}3)$, $U$ is the on-site repulsion, $\\varepsilon_i$ are site energies, $\\hat{c}^\\dagger_{i\\sigma}$ creates an electron of spin $\\sigma$ in the $p_z$ orbital on site $i$, and $\\hat{n}_{i\\sigma}=\\hat{c}^\\dagger_{i\\sigma}\\hat{c}_{i\\sigma}$. Within the Unrestricted Hartree-Fock (UHF) mean-field approximation, the interaction term is replaced by its mean-field decoupling at self-consistency,\n$$\n\\hat{n}_{i\\alpha}\\hat{n}_{i\\beta} \\;\\approx\\; \\hat{n}_{i\\alpha}\\,\\langle \\hat{n}_{i\\beta}\\rangle \\;+\\; \\langle \\hat{n}_{i\\alpha}\\rangle\\,\\hat{n}_{i\\beta} \\;-\\; \\langle \\hat{n}_{i\\alpha}\\rangle \\langle \\hat{n}_{i\\beta}\\rangle,\n$$\nwhich yields spin-dependent one-electron Hamiltonians\n$$\n\\hat{F}_\\alpha \\;=\\; \\hat{h} \\;+\\; U \\sum_{i=1}^{3} \\langle \\hat{n}_{i\\beta}\\rangle \\,|i\\rangle\\langle i|,\\qquad\n\\hat{F}_\\beta \\;=\\; \\hat{h} \\;+\\; U \\sum_{i=1}^{3} \\langle \\hat{n}_{i\\alpha}\\rangle \\,|i\\rangle\\langle i|,\n$$\nwith the one-electron part\n$$\n\\hat{h} \\;=\\; \\sum_{i=1}^{3}\\sum_{\\sigma} \\varepsilon_i \\, \\hat{n}_{i\\sigma}\n\\;-\\; t \\sum_{\\langle i,j\\rangle}\\sum_{\\sigma} \\left( \\hat{c}^\\dagger_{i\\sigma}\\hat{c}_{j\\sigma} + \\hat{c}^\\dagger_{j\\sigma}\\hat{c}_{i\\sigma} \\right).\n$$\nConsider the allyl radical as an open chain of three sites with three $\\pi$ electrons, total spin $s=\\tfrac{1}{2}$ (doublet), number of $\\alpha$-spin electrons $N_\\alpha=2$, and number of $\\beta$-spin electrons $N_\\beta=1$. Let $S_z=(N_\\alpha-N_\\beta)/2=\\tfrac{1}{2}$. After obtaining a self-consistent UHF solution, the expectation value of the total spin-squared operator for a single-determinant UHF wave function can be expressed in terms of the occupied molecular orbitals as\n$$\n\\langle \\hat{S}^2 \\rangle \\;=\\; S_z\\left(S_z+1\\right) \\;+\\; N_\\beta \\;-\\; \\sum_{i=1}^{N_\\alpha}\\sum_{j=1}^{N_\\beta} \\left| \\langle \\phi_i^\\alpha \\mid \\phi_j^\\beta \\rangle \\right|^2,\n$$\nwhere $\\{ \\phi_i^\\alpha \\}$ and $\\{ \\phi_j^\\beta \\}$ are the occupied spatial orbitals for $\\alpha$ and $\\beta$ spins, respectively, expressed in the same orthonormal atomic-orbital basis. The spin contamination is defined as\n$$\n\\Delta \\;=\\; \\langle \\hat{S}^2 \\rangle \\;-\\; s(s+1),\n$$\nwith $s=\\tfrac{1}{2}$ for the allyl radical. All quantities are dimensionless in this problem.\n\nTask. Write a complete program that, for each of the parameter sets listed below, performs a self-consistent UHF mean-field calculation on the three-site allyl chain and returns the spin contamination $\\Delta$ as a real-valued number. Assume an orthonormal atomic-orbital basis $\\{ |1\\rangle, |2\\rangle, |3\\rangle \\}$ and open boundary conditions with nearest-neighbor hopping only between sites $\\langle i,j\\rangle\\in\\{(1,2),(2,3)\\}$.\n\nTest suite of parameter sets $(t, U, \\boldsymbol{\\varepsilon})$:\n- Case A (noninteracting reference): $(t, U, \\boldsymbol{\\varepsilon}) = (2.5, 0.0, (0.0, 0.0, 0.0))$.\n- Case B (moderate correlation): $(t, U, \\boldsymbol{\\varepsilon}) = (2.5, 4.0, (0.0, 0.0, 0.0))$.\n- Case C (strong correlation): $(t, U, \\boldsymbol{\\varepsilon}) = (2.5, 100.0, (0.0, 0.0, 0.0))$.\n- Case D (site-asymmetric): $(t, U, \\boldsymbol{\\varepsilon}) = (2.5, 4.0, (0.0, 0.3, 0.0))$.\n\nRequirements for the program and output:\n- For each case, compute a self-consistent Unrestricted Hartree-Fock (UHF) solution with $N_\\alpha=2$ and $N_\\beta=1$ and evaluate $\\Delta = \\langle \\hat{S}^2 \\rangle - s(s+1)$ with $s=\\tfrac{1}{2}$.\n- Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, ordered as [Case A, Case B, Case C, Case D]. Each result must be a floating-point number rounded to six decimal places.", "solution": "The problem presented is a valid and well-posed exercise in computational quantum chemistry. It asks for the implementation of the Unrestricted Hartree-Fock (UHF) mean-field theory for a Hubbard model of the allyl radical, a system comprising three electrons on three sites. The goal is to compute the spin contamination for several parameter sets. The problem is scientifically grounded, specified with sufficient detail, and computationally feasible.\n\nThe theoretical framework is the Hubbard Hamiltonian for a three-site chain:\n$$\n\\hat{H} = \\sum_{i=1}^{3} \\sum_{\\sigma} \\varepsilon_i \\hat{n}_{i\\sigma} - t \\sum_{\\langle i,j\\rangle}\\sum_{\\sigma} \\left( \\hat{c}^\\dagger_{i\\sigma}\\hat{c}_{j\\sigma} + \\text{h.c.} \\right) + U \\sum_{i=1}^{3} \\hat{n}_{i\\alpha}\\hat{n}_{i\\beta}\n$$\nwhere $\\hat{c}^\\dagger_{i\\sigma}$ is the creation operator for an electron of spin $\\sigma \\in \\{\\alpha, \\beta\\}$ at site $i$, $\\hat{n}_{i\\sigma} = \\hat{c}^\\dagger_{i\\sigma}\\hat{c}_{i\\sigma}$ is the number operator, $\\varepsilon_i$ are the on-site energies, $t$ is the nearest-neighbor hopping integral, and $U$ is the on-site Coulomb repulsion. The allyl radical has $N=3$ electrons, and we consider the doublet state with $N_\\alpha=2$ and $N_\\beta=1$, yielding a total spin projection $S_z=(N_\\alpha-N_\\beta)/2 = 1/2$.\n\nIn the UHF approximation, the two-electron interaction term is replaced by a one-electron potential where each electron moves in the average field of all other electrons. This leads to separate Schrödinger equations for $\\alpha$ and $\\beta$ spin electrons, defined by the spin-dependent Fock operators $\\hat{F}_\\alpha$ and $\\hat{F}_\\beta$. In the specified orthonormal atomic orbital (AO) basis $\\{|1\\rangle, |2\\rangle, |3\\rangle\\}$, these operators are represented by $3 \\times 3$ matrices, the Fock matrices $\\mathbf{F}_\\sigma$:\n$$\n\\mathbf{F}_\\sigma = \\mathbf{H}_{\\text{core}} + \\mathbf{G}_\\sigma\n$$\nThe matrix $\\mathbf{H}_{\\text{core}}$ represents the one-electron part of the Hamiltonian (kinetic energy and external potential). Its elements are:\n$$\n(\\mathbf{H}_{\\text{core}})_{ij} = \\langle i | \\hat{h} | j \\rangle =\n\\begin{cases}\n\\varepsilon_i & \\text{if } i=j \\\\\n-t & \\text{if } i,j \\text{ are nearest neighbors} \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nFor the three-site chain, this is:\n$$\n\\mathbf{H}_{\\text{core}} = \\begin{pmatrix} \\varepsilon_1 & -t & 0 \\\\ -t & \\varepsilon_2 & -t \\\\ 0 & -t & \\varepsilon_3 \\end{pmatrix}\n$$\nThe matrix $\\mathbf{G}_\\sigma$ represents the mean-field repulsion. For the Hubbard model, this term is diagonal in the AO basis. The potential experienced by a spin-$\\sigma$ electron at site $i$ depends on the average number of electrons of the opposite spin, $\\langle\\hat{n}_{i,-\\sigma}\\rangle$, at that site. We can write $\\langle\\hat{n}_{i,-\\sigma}\\rangle = P_{ii}^{-\\sigma}$, where $\\mathbf{P}^{-\\sigma}$ is the density matrix for the opposite spin.\n$$\n(\\mathbf{G}_\\alpha)_{ij} = \\delta_{ij} \\, U P_{ii}^\\beta, \\qquad (\\mathbf{G}_\\beta)_{ij} = \\delta_{ij} \\, U P_{ii}^\\alpha\n$$\nThe Fock matrices are thus:\n$$\n\\mathbf{F}_\\alpha = \\mathbf{H}_{\\text{core}} + U \\operatorname{diag}(P_{11}^\\beta, P_{22}^\\beta, P_{33}^\\beta)\n$$\n$$\n\\mathbf{F}_\\beta = \\mathbf{H}_{\\text{core}} + U \\operatorname{diag}(P_{11}^\\alpha, P_{22}^\\alpha, P_{33}^\\alpha)\n$$\nThe density matrix $\\mathbf{P}_\\sigma$ is constructed from the molecular orbitals (MOs) for spin $\\sigma$, which are the eigenvectors of the corresponding Fock matrix. If $\\mathbf{C}_\\sigma$ is the matrix whose columns are the MO coefficient vectors, then:\n$$\n\\mathbf{P}_\\sigma = \\sum_{k=1}^{N_\\sigma} \\mathbf{c}_k^\\sigma (\\mathbf{c}_k^\\sigma)^T\n$$\nwhere the sum is over the $N_\\sigma$ occupied MOs (those with the lowest energies), and $\\mathbf{c}_k^\\sigma$ is the $k$-th column of $\\mathbf{C}_\\sigma$.\n\nThe problem demands a self-consistent solution. Since the Fock matrices depend on the density matrices, and the density matrices are derived from the eigenvectors of the Fock matrices, we must use an iterative Self-Consistent Field (SCF) procedure:\n1.  **Initial Guess**: An initial guess for the density matrices $\\mathbf{P}_\\alpha$ and $\\mathbf{P}_\\beta$ is made. A reasonable choice is to use the solution of the non-interacting system ($U=0$), which is obtained by diagonalizing $\\mathbf{H}_{\\text{core}}$.\n2.  **SCF Cycle**:\n    a. Construct the Fock matrices $\\mathbf{F}_\\alpha$ and $\\mathbf{F}_\\beta$ using the current density matrices.\n    b. Solve the eigenvalue problems for each spin: $\\mathbf{F}_\\sigma \\mathbf{C}_\\sigma = \\mathbf{C}_\\sigma \\mathbf{E}_\\sigma$. This yields the MO coefficients $\\mathbf{C}_\\sigma$ and energies $\\mathbf{E}_\\sigma$.\n    c. Form new density matrices $\\mathbf{P}^{\\text{new}}_\\sigma$ by occupying the lowest $N_\\alpha=2$ alpha orbitals and $N_\\beta=1$ beta orbital.\n    d. Check for convergence by comparing the new density matrices with the old ones. If the difference is below a tolerance, the solution is self-consistent.\n    e. If not converged, update the density matrices (e.g., $\\mathbf{P}_\\sigma = \\mathbf{P}^{\\text{new}}_\\sigma$) and repeat the cycle.\n\nOnce the SCF procedure has converged, we calculate the spin contamination, $\\Delta$. For a single-determinant UHF wavefunction, the expectation value of the total spin-squared operator, $\\hat{S}^2$, is given by:\n$$\n\\langle \\hat{S}^2 \\rangle = S_z(S_z+1) + N_\\beta - \\sum_{i=1}^{N_\\alpha}\\sum_{j=1}^{N_\\beta} \\left| \\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle \\right|^2\n$$\nHere, $\\{\\phi_i^\\alpha\\}$ and $\\{\\phi_j^\\beta\\}$ are the spatial parts of the occupied alpha and beta spin-orbitals, respectively. These are the eigenvectors we found. Since the AO basis is orthonormal, the overlap integral $\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle$ is simply the dot product of the corresponding MO coefficient vectors, $(\\mathbf{c}_i^\\alpha)^T \\mathbf{c}_j^\\beta$.\nFor our system, $S_z=1/2$, $s=1/2$, $N_\\alpha=2$, and $N_\\beta=1$. The spin contamination is:\n$$\n\\Delta = \\langle \\hat{S}^2 \\rangle - s(s+1) = \\left( S_z(S_z+1) + N_\\beta - \\sum_{i=1}^{2}\\sum_{j=1}^{1} |\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle|^2 \\right) - s(s+1)\n$$\nSubstituting $S_z=s=1/2$ and $N_\\beta=1$:\n$$\n\\Delta = \\left( \\frac{1}{2}\\left(\\frac{3}{2}\\right) + 1 - \\sum_{i=1}^{2} |\\langle \\phi_i^\\alpha | \\phi_1^\\beta \\rangle|^2 \\right) - \\frac{1}{2}\\left(\\frac{3}{2}\\right) = 1 - \\sum_{i=1}^{2} |\\langle \\phi_i^\\alpha | \\phi_1^\\beta \\rangle|^2\n$$\nThis is the final quantity to be computed. For the non-interacting case ($U=0$), the alpha and beta MOs are identical, so $\\langle \\phi_1^\\alpha | \\phi_1^\\beta \\rangle=1$ and $\\langle \\phi_2^\\alpha | \\phi_1^\\beta \\rangle=0$, leading to $\\Delta=0$. For $U>0$, the alpha and beta orbitals differentiate to minimize electron-electron repulsion, leading to non-zero spin contamination, $\\Delta > 0$. In the limit of very large $U$, the alpha and beta orbitals become disjoint (localized on different sites), causing the overlap sums to approach zero and $\\Delta$ to approach $1$. The provided program implements this complete procedure.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_uhf_contamination(t, U, epsilons):\n    \"\"\"\n    Performs a self-consistent UHF calculation for a 3-site Hubbard model\n    and returns the spin contamination.\n\n    Args:\n        t (float): Hopping parameter.\n        U (float): On-site repulsion parameter.\n        epsilons (tuple or list): On-site energies (e1, e2, e3).\n\n    Returns:\n        float: The spin contamination Delta.\n    \"\"\"\n    # System parameters\n    n_sites = 3\n    n_alpha = 2\n    n_beta = 1\n\n    # 1. Build the core Hamiltonian matrix\n    H_core = np.diag(np.array(epsilons, dtype=float))\n    H_core[0, 1] = H_core[1, 0] = -t\n    H_core[1, 2] = H_core[2, 1] = -t\n\n    # 2. Initial guess for density matrices from the core Hamiltonian (Huckel solution)\n    # The different number of alpha and beta electrons will naturally break spin symmetry.\n    _, C_init = np.linalg.eigh(H_core)\n    \n    C_alpha_occ_init = C_init[:, :n_alpha]\n    P_alpha = C_alpha_occ_init @ C_alpha_occ_init.T\n    \n    C_beta_occ_init = C_init[:, :n_beta]\n    P_beta = C_beta_occ_init @ C_beta_occ_init.T\n\n    # 3. Self-Consistent Field (SCF) iterations\n    max_iter = 200\n    conv_tol = 1e-10\n    \n    for i in range(max_iter):\n        P_alpha_old = P_alpha.copy()\n        P_beta_old = P_beta.copy()\n\n        # Build Fock matrices\n        G_alpha = U * np.diag(np.diag(P_beta_old))\n        G_beta = U * np.diag(np.diag(P_alpha_old))\n        \n        F_alpha = H_core + G_alpha\n        F_beta = H_core + G_beta\n\n        # Solve the eigenvalue problems (diagonalize Fock matrices)\n        _, C_alpha = np.linalg.eigh(F_alpha)\n        _, C_beta = np.linalg.eigh(F_beta)\n\n        # Form new density matrices from occupied MOs (Aufbau principle)\n        C_alpha_occ = C_alpha[:, :n_alpha]\n        C_beta_occ = C_beta[:, :n_beta]\n        \n        P_alpha = C_alpha_occ @ C_alpha_occ.T\n        P_beta = C_beta_occ @ C_beta_occ.T\n\n        # Check for convergence\n        error = np.linalg.norm(P_alpha - P_alpha_old) + np.linalg.norm(P_beta - P_beta_old)\n        if error < conv_tol:\n            break\n            \n    # 4. Calculate spin contamination from the converged solution\n    # The converged MO coefficients are in C_alpha and C_beta\n    C_alpha_occ = C_alpha[:, :n_alpha]\n    C_beta_occ = C_beta[:, :n_beta]\n\n    # The formula is Delta = 1 - sum_{i=occ_a, j=occ_b} |<phi_i^a | phi_j^b>|^2\n    # For N_beta = 1, this simplifies to Delta = 1 - sum_{i=occ_a} |<phi_i^a | phi_1^b>|^2\n    overlap_sq_sum = 0.0\n    c_beta_1 = C_beta_occ[:, 0]\n    for i in range(n_alpha):\n        c_alpha_i = C_alpha_occ[:, i]\n        overlap = np.dot(c_alpha_i.T, c_beta_1)\n        overlap_sq_sum += overlap**2\n        \n    delta = 1.0 - overlap_sq_sum\n    \n    return delta\n\ndef solve():\n    \"\"\"\n    Main function to run the UHF calculations for the given test cases\n    and print the results in the required format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: (t, U, epsilons)\n        (2.5, 0.0, (0.0, 0.0, 0.0)),\n        # Case B\n        (2.5, 4.0, (0.0, 0.0, 0.0)),\n        # Case C\n        (2.5, 100.0, (0.0, 0.0, 0.0)),\n        # Case D\n        (2.5, 4.0, (0.0, 0.3, 0.0)),\n    ]\n\n    results = []\n    for case in test_cases:\n        t, U, eps = case\n        delta = calculate_uhf_contamination(t, U, eps)\n        results.append(delta)\n\n    # Format the output string as required, with 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2463834"}]}