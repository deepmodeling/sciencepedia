{"hands_on_practices": [{"introduction": "The central idea of the Hartree approximation is to simplify the formidable many-electron problem by assuming each electron moves independently in an average electric field, or *mean field*, created by all other electrons. This practice guides you through the foundational task of constructing this mean-field potential. By working through a simplified one-dimensional model of a dihydrogen molecule [@problem_id:2464655], you will translate the abstract definition of the Hartree potential into a concrete mathematical expression, a crucial first step in setting up any self-consistent field calculation.", "problem": "Consider a one-dimensional model of a dihydrogen molecule consisting of two fixed protons of charge $+1$ located at positions $x_{A}=-\\frac{R}{2}$ and $x_{B}=+\\frac{R}{2}$ on the real line, and two electrons with coordinates $x_{1}$ and $x_{2}$. Work in Hartree atomic units (HAU), where $\\hbar=1$, $m_{e}=1$, $e=1$, and $4\\pi\\varepsilon_{0}=1$. Assume the Born–Oppenheimer approximation (BO), so that the nuclei are clamped. Model all Coulomb interactions by the standard soft-Coulomb form with softening parameter $a>0$. The one-electron external potential is\n$$\nv_{\\text{ext}}(x) \\;=\\; -\\frac{1}{\\sqrt{(x-x_{A})^{2}+a^{2}}}\\;-\\;\\frac{1}{\\sqrt{(x-x_{B})^{2}+a^{2}}}\\,,\n$$\nand the electron–electron repulsion kernel is\n$$\nw(x-x') \\;=\\; \\frac{1}{\\sqrt{(x-x')^{2}+a^{2}}}\\,.\n$$\nWithin the Hartree approximation for a spin-compensated state, both electrons occupy the same normalized spatial orbital $\\phi(x)$ with $\\int_{-\\infty}^{\\infty}|\\phi(x)|^{2}\\,\\mathrm{d}x=1$. The electronic density is $\\rho(x)=2|\\phi(x)|^{2}$ on the real line.\n\nDetermine the explicit closed-form analytic expression, in terms of $\\phi(x)$, $a$, and $R$, for the Hartree potential $V_{\\mathrm{H}}(x)$ that enters the single-orbital Hartree equation for this system. Your final answer must be a single analytic expression. Do not include any units in your final answer.", "solution": "The Hartree potential, denoted $V_{\\mathrm{H}}(x)$, represents the mean-field electrostatic potential experienced by a single electron at position $x$ due to the average charge distribution of all other electrons. In density functional theory and related mean-field theories, it is defined as the classical Coulomb potential generated by the total electronic density, $\\rho(x)$.\n\nThe general definition of the Hartree potential at a point $x$ for a system with electron density $\\rho(x')$ and an interaction kernel $w(x-x')$ is given by the convolution of the density with the interaction kernel:\n$$\nV_{\\mathrm{H}}(x) = \\int \\rho(x') w(x-x') \\, \\mathrm{d}x'\n$$\nThe integral is taken over all space, which in this one-dimensional problem corresponds to the interval $(-\\infty, \\infty)$.\n\nThe problem provides the specific forms for the electronic density and the interaction kernel.\nThe electronic density for a spin-compensated system of two electrons in the same spatial orbital $\\phi(x)$ is given as:\n$$\n\\rho(x') = 2 |\\phi(x')|^2\n$$\nThe electron-electron repulsion is modeled by the soft-Coulomb kernel:\n$$\nw(x-x') = \\frac{1}{\\sqrt{(x-x')^2 + a^2}}\n$$\nSubstituting these expressions into the general definition of the Hartree potential yields:\n$$\nV_{\\mathrm{H}}(x) = \\int_{-\\infty}^{\\infty} \\left( 2 |\\phi(x')|^2 \\right) \\left( \\frac{1}{\\sqrt{(x-x')^2 + a^2}} \\right) \\, \\mathrm{d}x'\n$$\nThe constant factor of $2$ can be moved outside the integral. The resulting expression is the explicit form for the Hartree potential as a functional of the orbital $\\phi(x)$:\n$$\nV_{\\mathrm{H}}(x) = 2 \\int_{-\\infty}^{\\infty} \\frac{|\\phi(x')|^2}{\\sqrt{(x-x')^2 + a^2}} \\, \\mathrm{d}x'\n$$\nThis expression is the complete and final answer. It is an integral transform of the probability density $|\\phi(x')|^2$. Since the functional form of $\\phi(x)$ is not given, the integral cannot be evaluated further.\n\nIt must be noted that while the problem requests the answer in terms of $\\phi(x)$, $a$, and $R$, the explicit functional form for $V_{\\mathrm{H}}[\\phi](x)$ does not contain the internuclear separation $R$. The parameter $R$ enters the problem through the external potential $v_{\\text{ext}}(x)$, which dictates the overall potential in the Hartree equation for $\\phi(x)$. Therefore, the solution for $\\phi(x)$ is parametrically dependent on $R$, which means $V_{\\mathrm{H}}(x)$ has an implicit dependence on $R$ through $\\phi(x)$. However, the direct expression for the potential as a functional of an arbitrary orbital contains only $\\phi$ and the interaction parameter $a$. The expression above is the correct and most fundamental representation.", "answer": "$$\n\\boxed{2 \\int_{-\\infty}^{\\infty} \\frac{|\\phi(x')|^2}{\\sqrt{(x-x')^2 + a^2}} \\, \\mathrm{d}x'}\n$$", "id": "2464655"}, {"introduction": "While the mean-field approach is powerful, it has inherent limitations. This exercise exposes a major conceptual flaw in the pure Hartree approximation: the unphysical self-interaction error, where an electron incorrectly interacts with its own charge distribution. By applying the Hartree formalism to a single-electron hydrogen atom [@problem_id:2464654], you will calculate this spurious energy contribution firsthand. This calculation provides a stark, quantitative demonstration of why the Hartree method is an approximation and lays the conceptual groundwork for more sophisticated theories, like Hartree-Fock, that correct this error.", "problem": "Consider a single electron in a hydrogen atom occupying the nonrelativistic ground-state orbital. In the Hartree formalism (ignoring exchange), the electron-electron repulsion energy is treated classically through the Hartree energy functional. For a general electron density, the Hartree energy functional in Hartree atomic units (a.u.) is\n$$\nE_{\\mathrm{H}}[\\rho] \\;=\\; \\frac{1}{2} \\iint \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\, d^3 r\\, d^3 r' .\n$$\nFor the hydrogen atom in its ground state, take the spatial orbital to be the normalized hydrogenic $1s$ orbital\n$$\n\\varphi_{1s}(\\mathbf{r}) \\;=\\; \\frac{1}{\\sqrt{\\pi a_0^3}} \\exp\\!\\left(-\\frac{r}{a_0}\\right),\n$$\nwith $r = |\\mathbf{r}|$ and $a_0$ the Bohr radius. The corresponding electron density is $ \\rho(\\mathbf{r}) = |\\varphi_{1s}(\\mathbf{r})|^2 $. Using the Hartree functional above, compute the unphysical self-interaction energy $E_{\\mathrm{H}}[\\rho]$ of this single electron. Express your final answer as an exact fraction in Hartree (a.u.).", "solution": "The problem asks for the calculation of the Hartree self-interaction energy for an electron in the ground state of a hydrogen atom. All calculations will be performed in Hartree atomic units (a.u.), where the Bohr radius $a_0=1$.\n\nThe normalized $1s$ orbital for hydrogen is given in a.u. as:\n$$\n\\varphi_{1s}(\\mathbf{r}) = \\frac{1}{\\sqrt{\\pi}} \\exp(-r)\n$$\nThe corresponding electron density $\\rho(\\mathbf{r})$ is:\n$$\n\\rho(\\mathbf{r}) = |\\varphi_{1s}(\\mathbf{r})|^2 = \\left( \\frac{1}{\\sqrt{\\pi}} \\exp(-r) \\right)^2 = \\frac{1}{\\pi} \\exp(-2r)\n$$\nThe density $\\rho(\\mathbf{r})$ is spherically symmetric, depending only on the radial distance $r=|\\mathbf{r}|$.\n\nThe Hartree energy functional is given by:\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\iint \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, d^3 r\\, d^3 r'\n$$\nThis integral represents the classical electrostatic energy of a charge distribution $\\rho(\\mathbf{r})$ interacting with its own potential. The calculation can be broken down into two steps: first, find the electrostatic potential $V(\\mathbf{r})$ generated by the charge density $\\rho(\\mathbf{r'})$, and second, compute the interaction energy of the density with this potential.\n$$\nV(\\mathbf{r}) = \\int \\frac{\\rho(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, d^3 r'\n$$\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\rho(\\mathbf{r}) V(\\mathbf{r})\\, d^3 r\n$$\nDue to the spherical symmetry of $\\rho(r)$, the potential $V(r)$ is also spherically symmetric. Using the shell theorem from electrostatics, the potential at a distance $r$ from the center is:\n$$\nV(r) = \\frac{1}{r} \\int_0^r 4\\pi r'^2 \\rho(r') \\,dr' + \\int_r^\\infty \\frac{1}{r'} 4\\pi r'^2 \\rho(r') \\,dr'\n$$\nSubstituting $\\rho(r') = \\frac{1}{\\pi} \\exp(-2r')$, we get a standard result for the potential of an exponential charge distribution:\n$$\nV(r) = \\frac{1 - (r+1)\\exp(-2r)}{r}\n$$\nNow we compute the Hartree energy $E_{\\mathrm{H}}$:\n$$\nE_{\\mathrm{H}} = \\frac{1}{2} \\int \\rho(r) V(r) \\,d^3 r = \\frac{1}{2} \\int_0^\\infty \\rho(r) V(r) 4\\pi r^2 \\,dr = 2\\pi \\int_0^\\infty \\rho(r) V(r) r^2 \\,dr\n$$\nSubstituting the expressions for $\\rho(r)$ and $V(r)$:\n$$\nE_{\\mathrm{H}} = 2\\pi \\int_0^\\infty \\left(\\frac{1}{\\pi}\\exp(-2r)\\right) \\left(\\frac{1 - (r+1)\\exp(-2r)}{r}\\right) r^2 \\,dr\n$$\n$$\nE_{\\mathrm{H}} = 2 \\int_0^\\infty r \\exp(-2r) (1 - (r+1)\\exp(-2r)) \\,dr\n$$\n$$\nE_{\\mathrm{H}} = 2 \\int_0^\\infty \\left( r \\exp(-2r) - r(r+1)\\exp(-4r) \\right) \\,dr\n$$\n$$\nE_{\\mathrm{H}} = 2 \\left[ \\int_0^\\infty r \\exp(-2r) \\,dr - \\int_0^\\infty r^2 \\exp(-4r) \\,dr - \\int_0^\\infty r \\exp(-4r) \\,dr \\right]\n$$\nWe use the standard integral formula $\\int_0^\\infty x^n \\exp(-ax) \\,dx = \\frac{n!}{a^{n+1}}$.\nThe first integral is for $n=1, a=2$:\n$$\n\\int_0^\\infty r \\exp(-2r) \\,dr = \\frac{1!}{2^{1+1}} = \\frac{1}{4}\n$$\nThe second integral is for $n=2, a=4$:\n$$\n\\int_0^\\infty r^2 \\exp(-4r) \\,dr = \\frac{2!}{4^{2+1}} = \\frac{2}{4^3} = \\frac{2}{64} = \\frac{1}{32}\n$$\nThe third integral is for $n=1, a=4$:\n$$\n\\int_0^\\infty r \\exp(-4r) \\,dr = \\frac{1!}{4^{1+1}} = \\frac{1}{16}\n$$\nSubstituting these values back into the expression for $E_{\\mathrm{H}}$:\n$$\nE_{\\mathrm{H}} = 2 \\left[ \\frac{1}{4} - \\frac{1}{32} - \\frac{1}{16} \\right]\n$$\nTo combine the fractions, we find a common denominator, which is $32$:\n$$\nE_{\\mathrm{H}} = 2 \\left[ \\frac{8}{32} - \\frac{1}{32} - \\frac{2}{32} \\right] = 2 \\left[ \\frac{8-1-2}{32} \\right] = 2 \\left[ \\frac{5}{32} \\right]\n$$\n$$\nE_{\\mathrm{H}} = \\frac{10}{32} = \\frac{5}{16}\n$$\nThe unphysical self-interaction energy of the electron in the hydrogen $1s$ orbital, within the Hartree approximation, is $\\frac{5}{16}$ Hartrees.", "answer": "$$\n\\boxed{\\frac{5}{16}}\n$$", "id": "2464654"}, {"introduction": "Having explored the construction and limitations of the Hartree potential, it is time to perform a complete, albeit simplified, quantum chemistry calculation. This practice bridges the gap between theory and computation by tasking you with calculating the ground-state energy of a Helium atom using a Gaussian-type orbital basis [@problem_id:2464664]. You will derive the analytical expressions for all energy components—kinetic, nuclear attraction, and electron repulsion—and implement them to obtain a numerical result, providing a tangible look into the engine of modern computational chemistry software.", "problem": "Implement a complete, runnable program that performs a single Hartree Self-Consistent Field iteration in atomic units for the Helium atom modeled with a single, normalized, s-type Gaussian-type orbital centered at the nucleus. Work entirely in three spatial dimensions and in atomic units, where the electronic charge, reduced Planck constant, and electron mass are all unity. The nucleus has charge number $Z$ and is fixed at the origin.\n\nThe spatial basis function is a single normalized Gaussian of the form $\\chi(\\mathbf{r}) = N \\exp(-\\alpha r^{2})$, where $r = \\lVert \\mathbf{r} \\rVert$, $\\alpha \\gt 0$ is a given exponent parameter, and $N$ is the normalization constant chosen so that $\\int_{\\mathbb{R}^{3}} \\chi(\\mathbf{r})^{2}\\, d^{3}\\mathbf{r} = 1$.\n\nConsider two electrons occupying the same spatial orbital $\\phi(\\mathbf{r}) = \\chi(\\mathbf{r})$ with opposite spins. In the Hartree approximation, the total electron density is $\\rho(\\mathbf{r}) = 2 \\lvert \\phi(\\mathbf{r}) \\rvert^{2}$, the one-electron Hamiltonian operator is $\\hat{h} = -\\tfrac{1}{2} \\nabla^{2} - \\dfrac{Z}{r}$, and the Hartree potential is $V_{\\mathrm{H}}[\\rho](\\mathbf{r}) = \\int_{\\mathbb{R}^{3}} \\dfrac{\\rho(\\mathbf{r'})}{\\lVert \\mathbf{r} - \\mathbf{r'} \\rVert} \\, d^{3}\\mathbf{r'}$.\n\nPerform a single iteration defined as:\n- Construct the effective one-electron operator $\\hat{f} = \\hat{h} + V_{\\mathrm{H}}[\\rho]$ using $\\rho(\\mathbf{r}) = 2 \\lvert \\chi(\\mathbf{r}) \\rvert^{2}$ obtained from the given $\\chi(\\mathbf{r})$.\n- Because there is a single normalized basis function, the updated orbital remains proportional to $\\chi(\\mathbf{r})$ after diagonalization; use the normalized $\\chi(\\mathbf{r})$ directly to evaluate energies.\n- Report the total Hartree energy after this single iteration,\n$$\nE_{\\text{Hartree}}(\\alpha,Z) \\;=\\; 2\\,\\langle \\chi \\lvert \\hat{h} \\rvert \\chi \\rangle \\;+\\; \\dfrac{1}{2} \\int_{\\mathbb{R}^{3}} \\int_{\\mathbb{R}^{3}} \\dfrac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r'})}{\\lVert \\mathbf{r} - \\mathbf{r'} \\rVert} \\, d^{3}\\mathbf{r}\\, d^{3}\\mathbf{r'}.\n$$\n\nAll results must be expressed in hartree. Your program should compute $E_{\\text{Hartree}}$ as a floating-point number for each test case and round each to six decimal places.\n\nUse the following test suite, which specifies $(\\alpha,Z)$:\n- Test $1$: $(\\alpha,Z) = (1.0, 2)$.\n- Test $2$: $(\\alpha,Z) = (0.000001, 2)$.\n- Test $3$: $(\\alpha,Z) = (100.0, 2)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"), where each result is the rounded value of $E_{\\text{Hartree}}$ for the corresponding test case in the order given above.", "solution": "The objective is to compute the total Hartree energy for a two-electron atom with nuclear charge $Z$, modeled by a single normalized $s$-type Gaussian basis function $\\chi(\\mathbf{r})$. The problem defines the energy as:\n$$\nE_{\\text{Hartree}}(\\alpha,Z) = 2\\,\\langle \\chi \\lvert \\hat{h} \\rvert \\chi \\rangle + \\dfrac{1}{2} \\int_{\\mathbb{R}^{3}} \\int_{\\mathbb{R}^{3}} \\dfrac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r'})}{\\lVert \\mathbf{r} - \\mathbf{r'} \\rVert} \\, d^{3}\\mathbf{r}\\, d^{3}\\mathbf{r'}\n$$\nwhere the one-electron Hamiltonian is $\\hat{h} = -\\tfrac{1}{2} \\nabla^{2} - \\dfrac{Z}{r}$ and the total electron density is $\\rho(\\mathbf{r}) = 2 |\\chi(\\mathbf{r})|^{2}$. The spatial orbital is a normalized Gaussian $\\chi(\\mathbf{r}) = N \\exp(-\\alpha r^{2})$.\n\nFirst, we analyze the structure of the energy expression. The first term, $2\\,\\langle \\chi \\lvert \\hat{h} \\rvert \\chi \\rangle$, is twice the one-electron energy (kinetic and nuclear attraction), which we denote $2 h_{11}$.\nThe second term is the classical electrostatic self-repulsion energy of the total electron charge cloud $\\rho(\\mathbf{r})$. Substituting $\\rho(\\mathbf{r}) = 2 |\\chi(\\mathbf{r})|^2$ into this term gives:\n$$\n\\dfrac{1}{2} \\iint \\dfrac{[2 |\\chi(\\mathbf{r})|^2] [2 |\\chi(\\mathbf{r'})|^2]}{\\lVert \\mathbf{r} - \\mathbf{r'} \\rVert} \\, d^{3}\\mathbf{r}\\, d^{3}\\mathbf{r'} = 2 \\iint \\dfrac{|\\chi(\\mathbf{r})|^2 |\\chi(\\mathbf{r'})|^2}{\\lVert \\mathbf{r} - \\mathbf{r'} \\rVert} \\, d^{3}\\mathbf{r}\\, d^{3}\\mathbf{r'}\n$$\nThis is twice the standard two-electron Coulomb integral, $J_{11} = \\langle \\chi\\chi | \\chi\\chi \\rangle$. The total energy is therefore $E_{\\text{Hartree}} = 2 h_{11} + 2 J_{11}$. Our task is to derive the analytical forms of the integrals $h_{11}$ and $J_{11}$.\n\n**1. Normalization of the Basis Function**\nThe basis function is $\\chi(\\mathbf{r}) = N \\exp(-\\alpha r^2)$. The normalization condition $\\int |\\chi(\\mathbf{r})|^2 \\, d^3\\mathbf{r} = 1$ leads to the normalization constant:\n$$\nN = \\left( \\frac{2\\alpha}{\\pi} \\right)^{3/4}\n$$\n\n**2. One-Electron Integral, $h_{11}$**\nThe one-electron integral $h_{11} = T_{11} + V_{11}$ consists of kinetic energy $T_{11} = \\langle \\chi | -\\frac{1}{2}\\nabla^2 | \\chi \\rangle$ and nuclear attraction $V_{11} = \\langle \\chi | -Z/r | \\chi \\rangle$. Using standard formulas for integrals over Gaussian functions, these evaluate to:\n\n**Kinetic Energy Integral, $T_{11}$**:\n$$\nT_{11} = \\frac{3\\alpha}{2}\n$$\n\n**Nuclear Attraction Integral, $V_{11}$**:\n$$\nV_{11} = -Z \\sqrt{\\frac{8\\alpha}{\\pi}}\n$$\nCombining these, the one-electron integral is:\n$$\nh_{11} = T_{11} + V_{11} = \\frac{3\\alpha}{2} - Z \\sqrt{\\frac{8\\alpha}{\\pi}}\n$$\n\n**3. Two-Electron Integral, $J_{11}$**\nThe Coulomb repulsion integral $J_{11} = \\langle \\chi\\chi | \\chi\\chi \\rangle$ for a single normalized s-type Gaussian basis function is a standard result in quantum chemistry:\n$$\nJ_{11} = \\sqrt{\\frac{4\\alpha}{\\pi}} = 2\\sqrt{\\frac{\\alpha}{\\pi}}\n$$\n\n**4. Total Hartree Energy**\nWe assemble the final expression for $E_{\\text{Hartree}} = 2 h_{11} + 2 J_{11}$:\n$$\nE_{\\text{Hartree}}(\\alpha,Z) = 2 \\left( \\frac{3\\alpha}{2} - Z \\sqrt{\\frac{8\\alpha}{\\pi}} \\right) + 2 \\left( 2\\sqrt{\\frac{\\alpha}{\\pi}} \\right)\n$$\n$$\nE_{\\text{Hartree}}(\\alpha,Z) = 3\\alpha - 2Z \\left( 2\\sqrt{2}\\sqrt{\\frac{\\alpha}{\\pi}} \\right) + 4\\sqrt{\\frac{\\alpha}{\\pi}}\n$$\nFactoring out the common term gives the final analytical expression to be implemented:\n$$\nE_{\\text{Hartree}}(\\alpha,Z) = 3\\alpha + \\left(4 - 4Z\\sqrt{2}\\right) \\sqrt{\\frac{\\alpha}{\\pi}}\n$$\nThis formula is now used to compute the energy for the specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Hartree energy for a Helium-like atom modeled with a single\n    s-type Gaussian orbital, based on a specific energy formula provided in the problem.\n    \"\"\"\n    # Define the test cases from the problem statement as a list of tuples (alpha, Z).\n    # Test 1: (alpha=1.0, Z=2)\n    # Test 2: (alpha=0.000001, Z=2)\n    # Test 3: (alpha=100.0, Z=2)\n    test_cases = [\n        (1.0, 2),\n        (0.000001, 2),\n        (100.0, 2),\n    ]\n\n    results = []\n    \n    # Iterate through each test case to compute the energy.\n    for alpha, Z in test_cases:\n        # The analytical formula for the Hartree energy, as derived from the problem statement:\n        # E_Hartree(alpha, Z) = 3*alpha + (4 - 4*Z*sqrt(2)) * sqrt(alpha / pi)\n        \n        # Calculate the first term of the energy expression.\n        term1 = 3 * alpha\n        \n        # Calculate the coefficient for the second term.\n        coeff2 = 4 - 4 * Z * np.sqrt(2)\n        \n        # Calculate the second term of the energy expression.\n        term2 = coeff2 * np.sqrt(alpha / np.pi)\n        \n        # The total Hartree energy is the sum of the two terms.\n        total_energy = term1 + term2\n        \n        # Format the result to six decimal places and add to the list.\n        # Using f-string formatting '{:.6f}' ensures correct rounding and fixed-point representation.\n        formatted_result = f\"{total_energy:.6f}\"\n        results.append(formatted_result)\n\n    # Final print statement in the exact required format: [result1,result2,result3]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2464664"}]}