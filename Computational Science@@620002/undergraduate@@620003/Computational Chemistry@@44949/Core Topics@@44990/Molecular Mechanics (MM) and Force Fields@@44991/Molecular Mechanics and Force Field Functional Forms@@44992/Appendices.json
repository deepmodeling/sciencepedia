{"hands_on_practices": [{"introduction": "The simplest yet most fundamental component of any molecular mechanics force field is the bond stretching term, often modeled as a simple harmonic spring described by the potential energy function $V(r) = \\frac{1}{2}k(r-r_e)^2$. This exercise [@problem_id:2458468] invites you to apply this model to a tangible physical problem: predicting the change in vibrational frequency when a hydrogen atom is replaced by its heavier isotope, deuterium. By working through this calculation, you will gain a deeper appreciation for how the concept of reduced mass influences molecular dynamics and how even a simple model can provide a powerful, quantitative explanation for observable spectroscopic effects.", "problem": "An oxygen–hydrogen bond and an oxygen–deuterium bond are each modeled as an isolated two-body system interacting via the simple harmonic potential $V(r)=\\tfrac{1}{2}k\\left(r-r_{e}\\right)^{2}$ near the equilibrium separation $r_{e}$. Assume the force constant $k$ and the equilibrium bond length $r_{e}$ are identical for the two isotopologues, and neglect all couplings and anharmonicity. Take the isotopic masses to be $m_{\\mathrm{O}}=15.994914\\,\\mathrm{u}$, $m_{\\mathrm{H}}=1.007825\\,\\mathrm{u}$, and $m_{\\mathrm{D}}=2.014102\\,\\mathrm{u}$, where $\\mathrm{u}$ denotes the atomic mass unit. Using only classical mechanics applied to the given potential, determine the ratio of the fundamental vibrational frequencies $\\nu_{\\mathrm{OH}}/\\nu_{\\mathrm{OD}}$. Express your final answer as a pure number (no units) and round your result to four significant figures.", "solution": "The problem statement has been analyzed and is deemed valid. It is scientifically grounded, well-posed, and objective. It presents a standard problem in classical mechanics applied to molecular vibrations, which is a fundamental concept in computational chemistry and spectroscopy. All necessary data are provided, and the assumptions, such as the Born-Oppenheimer approximation (identical potential for isotopologues), are physically standard for this level of analysis. We may proceed with the solution.\n\nThe problem asks for the ratio of the fundamental vibrational frequencies, $\\nu_{\\mathrm{OH}}/\\nu_{\\mathrm{OD}}$, for an oxygen-hydrogen bond and an oxygen-deuterium bond. The bonds are modeled as isolated two-body systems described by a simple harmonic potential.\n\nThe vibration of a two-body system with masses $m_1$ and $m_2$ can be reduced to the problem of a single body with a reduced mass $\\mu$ moving in the same potential. The reduced mass $\\mu$ is defined as:\n$$\n\\mu = \\frac{m_1 m_2}{m_1 + m_2}\n$$\nFor the O-H system, the reduced mass $\\mu_{\\mathrm{OH}}$ is:\n$$\n\\mu_{\\mathrm{OH}} = \\frac{m_{\\mathrm{O}} m_{\\mathrm{H}}}{m_{\\mathrm{O}} + m_{\\mathrm{H}}}\n$$\nFor the O-D system, the reduced mass $\\mu_{\\mathrm{OD}}$ is:\n$$\n\\mu_{\\mathrm{OD}} = \\frac{m_{\\mathrm{O}} m_{\\mathrm{D}}}{m_{\\mathrm{O}} + m_{\\mathrm{D}}}\n$$\nThe potential energy for the system is given as a simple harmonic potential:\n$$\nV(r) = \\frac{1}{2}k(r - r_e)^2\n$$\nwhere $k$ is the force constant and $r_e$ is the equilibrium bond length. The force $F$ acting on the effective single body is given by the negative gradient of the potential with respect to the displacement from equilibrium, $x = r - r_e$:\n$$\nF = -\\frac{dV}{dx} = -\\frac{d}{dx} \\left( \\frac{1}{2}kx^2 \\right) = -kx\n$$\nAccording to Newton's second law, $F = ma$, which for our effective one-body system becomes $F = \\mu \\ddot{x}$, where $\\ddot{x}$ is the acceleration.\n$$\n\\mu \\ddot{x} = -kx\n$$\nRearranging this gives the standard equation for simple harmonic motion:\n$$\n\\ddot{x} + \\left(\\frac{k}{\\mu}\\right)x = 0\n$$\nThe general solution to this differential equation describes sinusoidal oscillation with an angular frequency $\\omega$ given by:\n$$\n\\omega^2 = \\frac{k}{\\mu} \\implies \\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\nThe fundamental vibrational frequency $\\nu$ is related to the angular frequency $\\omega$ by $\\omega = 2\\pi\\nu$. Therefore:\n$$\n\\nu = \\frac{\\omega}{2\\pi} = \\frac{1}{2\\pi}\\sqrt{\\frac{k}{\\mu}}\n$$\nWe are asked to find the ratio $\\nu_{\\mathrm{OH}} / \\nu_{\\mathrm{OD}}$. Using the expression for $\\nu$:\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\frac{\\frac{1}{2\\pi}\\sqrt{\\frac{k}{\\mu_{\\mathrm{OH}}}}}{\\frac{1}{2\\pi}\\sqrt{\\frac{k}{\\mu_{\\mathrm{OD}}}}}\n$$\nThe problem states that the force constant $k$ is identical for both isotopologues. The constants $1/(2\\pi)$ and $k$ cancel, leaving:\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\sqrt{\\frac{1/\\mu_{\\mathrm{OH}}}{1/\\mu_{\\mathrm{OD}}}} = \\sqrt{\\frac{\\mu_{\\mathrm{OD}}}{\\mu_{\\mathrm{OH}}}}\n$$\nNow, we substitute the expressions for the reduced masses:\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\sqrt{\\frac{\\frac{m_{\\mathrm{O}} m_{\\mathrm{D}}}{m_{\\mathrm{O}} + m_{\\mathrm{D}}}}{\\frac{m_{\\mathrm{O}} m_{\\mathrm{H}}}{m_{\\mathrm{O}} + m_{\\mathrm{H}}}}} = \\sqrt{\\frac{m_{\\mathrm{D}}(m_{\\mathrm{O}} + m_{\\mathrm{H}})}{m_{\\mathrm{H}}(m_{\\mathrm{O}} + m_{\\mathrm{D}})}}\n$$\nUsing the provided isotopic masses:\n$m_{\\mathrm{O}} = 15.994914\\,\\mathrm{u}$\n$m_{\\mathrm{H}} = 1.007825\\,\\mathrm{u}$\n$m_{\\mathrm{D}} = 2.014102\\,\\mathrm{u}$\n\nFirst, we calculate the reduced masses. The atomic mass unit ($\\mathrm{u}$) will cancel in the final ratio, so we can use the numerical values directly.\n$$\n\\mu_{\\mathrm{OH}} = \\frac{(15.994914)(1.007825)}{15.994914 + 1.007825} = \\frac{16.1199320}{17.002739} \\approx 0.9480838\\,\\mathrm{u}\n$$\n$$\n\\mu_{\\mathrm{OD}} = \\frac{(15.994914)(2.014102)}{15.994914 + 2.014102} = \\frac{32.2155855}{18.009016} \\approx 1.788856\\,\\mathrm{u}\n$$\nNow we compute the ratio:\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\sqrt{\\frac{\\mu_{\\mathrm{OD}}}{\\mu_{\\mathrm{OH}}}} \\approx \\sqrt{\\frac{1.788856}{0.9480838}} \\approx \\sqrt{1.886801} \\approx 1.373609\n$$\nThe problem requires the result to be rounded to four significant figures.\n$$\n1.373609 \\approx 1.374\n$$\nThis result demonstrates the isotopic effect on vibrational frequencies: the heavier isotopologue (O-D) has a lower vibrational frequency than the lighter one (O-H).", "answer": "$$\n\\boxed{1.374}\n$$", "id": "2458468"}, {"introduction": "A powerful way to understand the role of each term in a force field is to consider what happens when one is removed. In a realistic model of a water molecule, the H-O-H bond angle is maintained near its experimental value of $104.5^\\circ$ by a specific angle-bending potential. This thought experiment [@problem_id:2458473] challenges you to determine the geometry of water using a simplified force field where this crucial term is absent. By analyzing the remaining interactions—bond stretching and non-bonded forces—you will discover how electrostatics and steric repulsion conspire to dictate the molecular shape, offering a clear lesson on why angle-bending terms are essential for accurately modeling molecular structures.", "problem": "An isolated water molecule is modeled by a classical molecular mechanics force field that contains only two types of energy terms: a harmonic O–H bond-stretching term for each O–H bond and pairwise non-bonded interactions composed of Lennard-Jones (LJ) and Coulomb electrostatics. Assume the following:\n- Non-bonded interactions are evaluated for all atom pairs that are not directly bonded, that is, they include the intramolecular H–H (1–3) interaction but exclude O–H (1–2) non-bonded interactions.\n- The two O–H bonds are equivalent and share the same harmonic parameters with an equilibrium bond length $r_0$.\n- The oxygen carries a partial charge $-2q$ and each hydrogen carries a partial charge $+q$, with $q>0$, so the molecule is neutral. No numerical values are required.\n- There is no explicit angle-bending term and no improper torsion or out-of-plane term.\n\nIn the $0\\,\\mathrm{K}$ energy-minimized structure under these assumptions, what is the predicted H–O–H angle?\n\nA) $104.5^\\circ$\n\nB) $0^\\circ$\n\nC) $180^\\circ$\n\nD) Undetermined; any angle has the same energy", "solution": "The problem statement must first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n-   **System**: An isolated water molecule.\n-   **Force Field Model**: Classical molecular mechanics.\n-   **Energy Terms Included**:\n    1.  Harmonic O–H bond-stretching for each of the two O–H bonds.\n    2.  Pairwise non-bonded interactions: Lennard-Jones (LJ) and Coulomb electrostatics.\n-   **Non-bonded Interaction Rules**:\n    -   Evaluated for all atom pairs that are not directly bonded.\n    -   Includes the intramolecular H–H ($1$–$3$) interaction.\n    -   Excludes O–H ($1$–$2$) non-bonded interactions.\n-   **Bond Term Parameters**:\n    -   The two O–H bonds are equivalent.\n    -   Harmonic parameters are shared.\n    -   Equilibrium bond length is $r_0$.\n-   **Electrostatics Parameters**:\n    -   Oxygen partial charge: $-2q$.\n    -   Hydrogen partial charge: $+q$.\n    -   Condition: $q>0$.\n-   **Energy Terms Excluded**:\n    -   No explicit angle-bending term.\n    -   No improper torsion term.\n    -   No out-of-plane term.\n-   **Objective**: Find the predicted H–O–H angle in the $0\\,\\mathrm{K}$ energy-minimized structure.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a simplified but well-defined theoretical model for a water molecule using standard components of molecular mechanics force fields. The components (harmonic bond, Lennard-Jones, Coulomb) are fundamental and correctly described. The rules for applying these terms (e.g., exclusion of $1$–$2$ non-bonded interactions) are standard practice in the field. The setup is a clear and solvable problem in potential energy minimization.\n\n-   **Scientific Grounding**: The problem is well-grounded in the principles of computational chemistry and force field modeling. It represents a valid, albeit simplified, physical model.\n-   **Well-Posedness**: The problem is well-posed. It asks for the geometry that minimizes a clearly defined potential energy function. A unique minimum is expected to exist.\n-   **Objectivity**: The language is precise, technical, and free of ambiguity or subjectivity.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is self-contained, scientifically sound, and unambiguous. A rigorous solution can be derived.\n\n### Derivation of the Solution\nThe geometry of the water molecule is determined by the set of coordinates that minimizes the total potential energy, $U_{total}$. In this model, the total potential energy is the sum of the bond-stretching energy and the non-bonded interaction energy.\n$$ U_{total} = U_{bond} + U_{non-bonded} $$\nLet the two O–H bond lengths be $r_1$ and $r_2$, and let the H–O–H angle be $\\theta$.\n\nThe bond-stretching energy is given by:\n$$ U_{bond} = \\frac{1}{2} k_b (r_1 - r_0)^2 + \\frac{1}{2} k_b (r_2 - r_0)^2 $$\nwhere $k_b$ is the bond force constant and $r_0$ is the equilibrium bond length. This energy is minimized when $r_1 = r_2 = r_0$. While non-bonded forces might slightly perturb the bond lengths from $r_0$, bond-stretching potentials are typically very \"stiff\" (large $k_b$), so we can assume for the determination of the angle that the bond lengths remain fixed at their minimum-energy value, $r_0$. Thus, $U_{bond}$ can be treated as a constant with a value of $0$.\n\nThe non-bonded energy, $U_{non-bonded}$, according to the problem statement, consists only of the interaction between the two hydrogen atoms (a $1$–$3$ interaction). The O–H non-bonded interactions ($1$–$2$) are explicitly excluded.\n$$ U_{non-bonded} = U_{H-H} $$\nThis interaction is composed of a Lennard-Jones term and a Coulomb term:\n$$ U_{H-H}(r_{HH}) = U_{LJ}(r_{HH}) + U_{Coulomb}(r_{HH}) $$\nwhere $r_{HH}$ is the distance between the two hydrogen atoms.\n\nThe Coulomb term arises from the electrostatic interaction of the two hydrogen atoms, each carrying a charge of $+q$:\n$$ U_{Coulomb}(r_{HH}) = \\frac{1}{4\\pi\\epsilon_0} \\frac{q \\cdot q}{r_{HH}} = \\frac{q^2}{4\\pi\\epsilon_0 r_{HH}} $$\nSince $q>0$, $q^2$ is positive. This term is purely repulsive and monotonically decreases as $r_{HH}$ increases.\n\nThe Lennard-Jones term is:\n$$ U_{LJ}(r_{HH}) = 4\\epsilon_{HH} \\left[ \\left(\\frac{\\sigma_{HH}}{r_{HH}}\\right)^{12} - \\left(\\frac{\\sigma_{HH}}{r_{HH}}\\right)^{6} \\right] $$\nThis term consists of a very strong short-range repulsion (the $r_{HH}^{-12}$ part) and a weaker mid-range attraction (the $r_{HH}^{-6}$ part). For intramolecular $1$–$3$ H–H distances, the separation is typically small enough that the interaction is dominated by the repulsive $r_{HH}^{-12}$ term.\n\nThe total H–H interaction potential, $U_{H-H}$, is therefore dominated by repulsion. Both the electrostatic and the Lennard-Jones steric components contribute to a strong repulsive force between the two hydrogen atoms. A potential that is fundamentally repulsive is a monotonically decreasing function of the interatomic distance $r_{HH}$. Therefore, to minimize $U_{H-H}$, one must maximize the distance $r_{HH}$.\n\nThe distance $r_{HH}$ is a function of the H–O–H angle $\\theta$. Using the law of cosines on the H–O–H isosceles triangle with side length $r_{OH} = r_0$:\n$$ r_{HH}^2 = r_0^2 + r_0^2 - 2 r_0 r_0 \\cos\\theta = 2r_0^2(1 - \\cos\\theta) $$\nUsing the trigonometric identity $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$, we find:\n$$ r_{HH} = \\sqrt{4r_0^2\\sin^2(\\frac{\\theta}{2})} = 2r_0 \\left| \\sin(\\frac{\\theta}{2}) \\right| $$\nFor the physically relevant range of angles $\\theta \\in [0^\\circ, 180^\\circ]$ (or $[0, \\pi]$ radians), $\\sin(\\theta/2)$ is non-negative, so:\n$$ r_{HH}(\\theta) = 2r_0 \\sin(\\frac{\\theta}{2}) $$\nTo maximize $r_{HH}$, we must maximize $\\sin(\\theta/2)$. The maximum value of $\\sin(\\theta/2)$ is $1$, which occurs when $\\theta/2 = 90^\\circ$. This corresponds to an angle of $\\theta = 180^\\circ$.\n\nSince the total energy's dependence on angle, $U_{total}(\\theta)$, is entirely through the repulsive $U_{H-H}(r_{HH}(\\theta))$ term, minimizing the total energy requires maximizing $r_{HH}$, which in turn requires setting $\\theta = 180^\\circ$. The crucial element of the problem is the explicit absence of a harmonic angle-bending term, which in a more realistic force field would provide a restoring force to keep the angle near its experimental value. Without it, the repulsive non-bonded forces are unopposed.\n\n### Evaluation of Options\n-   **A) $104.5^\\circ$**: This is the experimental angle for water. This result is obtained from models that include a specific angle-bending potential of the form $U_{angle} = \\frac{1}{2} k_\\theta (\\theta - \\theta_0)^2$ where $\\theta_0$ is parameterized to be near $104.5^\\circ$. The problem explicitly excludes this term. Therefore, this option is **Incorrect**.\n-   **B) $0^\\circ$**: An angle of $\\theta = 0^\\circ$ would imply $r_{HH}=0$. This would cause the repulsive Lennard-Jones and Coulomb energy terms to become infinite. This represents the configuration of maximum energy, not minimum. This option is patently absurd. Therefore, this option is **Incorrect**.\n-   **C) $180^\\circ$**: An angle of $\\theta = 180^\\circ$ maximizes the distance $r_{HH}$ between the two hydrogen atoms. As established, the interaction potential $U_{H-H}$ is repulsive for all relevant distances. Maximizing the separation minimizes this repulsive energy. Since this is the only angle-dependent term in the potential, this configuration corresponds to the global energy minimum for the given model. Therefore, this option is **Correct**.\n-   **D) Undetermined; any angle has the same energy**: This is false. The total energy depends on the H–H non-bonded interaction, which is a function of the H–H distance, $r_{HH}$. Since $r_{HH}$ is a function of the angle $\\theta$, the total energy is also a function of $\\theta$. The energy is not constant for all angles. Therefore, this option is **Incorrect**.", "answer": "$$\\boxed{C}$$", "id": "2458473"}, {"introduction": "Torsional potentials, which describe the energy of rotation around a chemical bond, are among the most complex and important components of a force field. They are typically represented by a Fourier series, where each term captures a different aspect of the underlying electronic and steric interactions. This exercise [@problem_id:2458507] puts you in the role of a force field developer, tasking you with fitting the coefficients of a dihedral potential to a realistic energy scan for butane. By performing this fit and interpreting the physical meaning of the resulting parameters, you will gain firsthand experience in how these functional forms are parameterized and how they encode the subtle energetic balance between staggered and eclipsed conformations.", "problem": "You are given potential energy scans for rotation about the central carbon–carbon bond in butane, parameterized by the dihedral angle $\\phi$ of the $\\mathrm{C{-}C{-}C{-}C}$ torsion. In molecular mechanics, a standard truncated Fourier series for the torsional contribution is\n$$\nV(\\phi) \\;=\\; \\sum_{n=1}^{3} \\frac{V_n}{2}\\,\\bigl[\\,1 + \\cos\\!\\bigl(n\\phi - \\gamma\\bigr)\\,\\bigr],\n$$\nwhere $\\phi$ is the dihedral angle, $V_n$ are real coefficients with units of energy, and $\\gamma$ is a phase. For a symmetric $\\mathrm{sp^3{-}sp^3}$ torsion in butane, assume $\\gamma = 0$ on symmetry grounds. Angles $\\phi$ are provided in degrees; any trigonometric evaluation must use $\\phi$ in radians. Energies are in $\\mathrm{kcal\\,mol^{-1}}$ and must be reported in $\\mathrm{kcal\\,mol^{-1}}$.\n\nFit the coefficients $V_1$, $V_2$, and $V_3$ to each of the following three test scans by minimizing the sum of squared residuals between the model and the provided energy values, using only the model above with $\\gamma=0$ and $n \\in \\{1,2,3\\}$. Report the fitted $V_1$, $V_2$, and $V_3$ for each case. Then, separately (not in the program output), explain the physical meaning of the $V_1$, $V_2$, and $V_3$ terms in the context of butane’s torsional energetics.\n\nAngle unit: degrees for the provided data; radians inside the cosine function. Energy unit: $\\mathrm{kcal\\,mol^{-1}}$ for all reported $V_n$. Round each reported $V_n$ to three decimal places.\n\nTest suite (each case consists of the same angle grid and a corresponding list of energies):\n- Angle grid $\\{\\phi_k\\}$ in degrees (for all cases): $\\bigl[\\,0^\\circ,\\,30^\\circ,\\,60^\\circ,\\,90^\\circ,\\,120^\\circ,\\,150^\\circ,\\,180^\\circ,\\,210^\\circ,\\,240^\\circ,\\,270^\\circ,\\,300^\\circ,\\,330^\\circ\\,\\bigr]$.\n\n- Case A (realistic butane-like profile): energies in $\\mathrm{kcal\\,mol^{-1}}$,\n$\\bigl[\\,3.500,\\,1.500,\\,-0.250,\\,2.250,\\,4.250,\\,1.500,\\,-1.000,\\,1.500,\\,4.250,\\,2.250,\\,-0.250,\\,1.500\\,\\bigr]$.\n\n- Case B (boundary case: flat profile at zero): energies in $\\mathrm{kcal\\,mol^{-1}}$,\n$\\bigl[\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000\\,\\bigr]$.\n\n- Case C (edge case: pure threefold periodicity): energies in $\\mathrm{kcal\\,mol^{-1}}$,\n$\\bigl[\\,2.000,\\,1.000,\\,0.000,\\,1.000,\\,2.000,\\,1.000,\\,0.000,\\,1.000,\\,2.000,\\,1.000,\\,0.000,\\,1.000\\,\\bigr]$.\n\nFinal output format: Your program should produce a single line of output containing a list of the three fitted triples, in order $\\bigl[V_1,V_2,V_3\\bigr]$ for Case A, then Case B, then Case C. The required exact formatting is a single Python-style list of lists with each $V_n$ rounded to three decimal places, for example:\n$[[v_{1,A},v_{2,A},v_{3,A}],[v_{1,B},v_{2,B},v_{3,B}],[v_{1,C},v_{2,C},v_{3,C}]]$\nwhere each $v_{i,j}$ is a decimal number in $\\mathrm{kcal\\,mol^{-1}}$ with three digits after the decimal point.", "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique solution. The task is a standard linear least squares fitting problem in the context of computational chemistry and molecular mechanics.\n\nThe problem requires fitting the coefficients $V_1$, $V_2$, and $V_3$ of the torsional potential model\n$$V(\\phi) = \\sum_{n=1}^{3} \\frac{V_n}{2}\\,\\bigl[\\,1 + \\cos(n\\phi)\\,\\bigr]$$\nto three given sets of energy data. This task can be formulated as a linear least squares problem. The model is linear with respect to the parameters $V_1$, $V_2$, and $V_3$. We can rewrite the model as:\n$$V(\\phi) = V_1 f_1(\\phi) + V_2 f_2(\\phi) + V_3 f_3(\\phi)$$\nwhere the basis functions are $f_n(\\phi) = \\frac{1}{2}\\bigl(1 + \\cos(n\\phi)\\bigr)$.\n\nFor a given set of $M$ data points $(\\phi_k, E_k)$, where $k=1, \\dots, M$, we want to find the vector of coefficients $\\mathbf{V} = [V_1, V_2, V_3]^T$ that minimizes the sum of squared residuals, $S$:\n$$S = \\sum_{k=1}^{M} \\left( E_k - V(\\phi_k) \\right)^2 = \\sum_{k=1}^{M} \\left( E_k - \\sum_{n=1}^{3} V_n f_n(\\phi_k) \\right)^2$$\nThis minimization problem is equivalent to solving the matrix equation $A\\mathbf{V} = \\mathbf{E}$ in the least-squares sense. Here, $\\mathbf{E}$ is the $M \\times 1$ column vector of observed energies, $\\mathbf{V}$ is the $3 \\times 1$ column vector of the unknown coefficients, and $A$ is the $M \\times 3$ design matrix. The elements of the design matrix are given by $A_{kn} = f_n(\\phi_k)$. In this problem, we have $M=12$ data points. The angles $\\phi_k$ are provided in degrees and must be converted to radians before evaluation of trigonometric functions.\n\nThe least-squares solution for $\\mathbf{V}$ is found by solving the normal equations, $(A^T A)\\mathbf{V} = A^T \\mathbf{E}$. A numerically stable method to obtain this solution is to use a standard linear least-squares solver, such as `numpy.linalg.lstsq`.\n\nThe procedure is as follows:\n1.  Construct the $12 \\times 3$ design matrix $A$. The angles are given by $\\{\\phi_k\\} = [0^\\circ, 30^\\circ, \\dots, 330^\\circ]$. Convert these to radians. The three columns of $A$ are calculated as vectors where the $k$-th element of the $n$-th column is $\\frac{1}{2}(1 + \\cos(n\\phi_k))$.\n2.  For each of the three test cases (A, B, C), define the corresponding $12 \\times 1$ energy vector $\\mathbf{E}$.\n3.  Solve the system $A\\mathbf{V} = \\mathbf{E}$ for $\\mathbf{V} = [V_1, V_2, V_3]^T$ using a linear least-squares algorithm.\n4.  Collect the resulting coefficient vectors for all three cases.\n5.  Format the results as specified, rounding each coefficient to three decimal places.\n\nPhysical Interpretation of the Fourier Coefficients $V_n$:\nThe Fourier series is a general mathematical method to represent a periodic function. In the context of the dihedral potential for butane's central $\\mathrm{C-C}$ bond, each term has a physical correspondence to the interactions governing the molecule's conformational energetics.\n\n-   **The $V_1$ Term ($n=1$):** This term has a periodicity of $360^\\circ$. It governs the energy difference between the fully eclipsed syn-periplanar conformation ($\\phi=0^\\circ$) and the staggered anti-periplanar conformation ($\\phi=180^\\circ$). The primary contribution to this term is the strong steric repulsion (van der Waals repulsion) between the two bulky terminal methyl groups. This interaction is maximal at $\\phi=0^\\circ$ and minimal at $\\phi=180^\\circ$. A positive $V_1$ coefficient correctly makes the syn conformation a high-energy state and the anti conformation a low-energy state.\n\n-   **The $V_2$ Term ($n=2$):** This term has a periodicity of $180^\\circ$ and helps to describe the energy difference between the eclipsed and staggered conformations more generally. However, its main role is distinguishing between the two types of staggered conformers (anti at $180^\\circ$ vs. gauche at $\\pm 60^\\circ$) and the two principal types of eclipsed conformers (at $0^\\circ$ vs. $\\pm 120^\\circ$). This term can be related to electronic effects such as hyperconjugation, which may stabilize perpendicular arrangements of bonds, but its interpretation is less direct than for $V_1$ and $V_3$.\n\n-   **The $V_3$ Term ($n=3$):** This term has a periodicity of $120^\\circ$, reflecting the threefold symmetry of the $\\mathrm{sp^3-sp^3}$ single bond. This is the fundamental, 'ethane-like' component of the rotational barrier. It represents the intrinsic preference for staggered conformations (e.g., $\\phi = 60^\\circ, 180^\\circ, 300^\\circ$) over eclipsed conformations (e.g., $\\phi = 0^\\circ, 120^\\circ, 240^\\circ$). This preference arises primarily from Pauli repulsion (steric hindrance) between the electron clouds of the bonds on the two central carbon atoms. A positive $V_3$ coefficient ensures that all staggered forms are at lower energy than all eclipsed forms, creating the characteristic three-fold barrier profile.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Fits torsional potential parameters V_n to given energy scans for butane.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = {\n        \"angles_deg\": [\n            0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, \n            210.0, 240.0, 270.0, 300.0, 330.0\n        ],\n        \"A\": {\n            \"energies\": [\n                3.500, 1.500, -0.250, 2.250, 4.250, 1.500, -1.000, \n                1.500, 4.250, 2.250, -0.250, 1.500\n            ]\n        },\n        \"B\": {\n            \"energies\": [\n                0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,\n                0.000, 0.000, 0.000, 0.000, 0.000\n            ]\n        },\n        \"C\": {\n            \"energies\": [\n                2.000, 1.000, 0.000, 1.000, 2.000, 1.000, 0.000,\n                1.000, 2.000, 1.000, 0.000, 1.000\n            ]\n        }\n    }\n\n    # Extract angle grid and convert to radians\n    phi_deg = np.array(test_cases[\"angles_deg\"])\n    phi_rad = np.deg2rad(phi_deg)\n\n    # --- Construct the design matrix A ---\n    # The model is V(phi) = sum_{n=1 to 3} V_n * f_n(phi)\n    # where f_n(phi) = 0.5 * (1 + cos(n*phi))\n    # The columns of A are the basis functions f_n evaluated at each angle phi_k.\n    f1 = 0.5 * (1 + np.cos(1 * phi_rad))\n    f2 = 0.5 * (1 + np.cos(2 * phi_rad))\n    f3 = 0.5 * (1 + np.cos(3 * phi_rad))\n    \n    # Design matrix A (size 12x3)\n    A = np.vstack([f1, f2, f3]).T\n\n    results = []\n    # Loop through the cases to fit\n    for case_id in [\"A\", \"B\", \"C\"]:\n        # Energy vector E (size 12x1)\n        E = np.array(test_cases[case_id][\"energies\"])\n        \n        # Solve the linear least squares problem A*V = E for V=[V1, V2, V3]\n        # np.linalg.lstsq returns a tuple; the first element is the solution vector.\n        V, _, _, _ = np.linalg.lstsq(A, E, rcond=None)\n        \n        results.append(V)\n\n    # --- Format the output as specified ---\n    # Example format: [[v1A,v2A,v3A],[v1B,v2B,v3B],[v1C,v2C,v3C]]\n    # with each value rounded to three decimal places.\n    \n    outer_list = []\n    for res in results:\n        # Format each coefficient to 3 decimal places\n        inner_list_str = \",\".join([f\"{x:.3f}\" for x in res])\n        outer_list.append(f\"[{inner_list_str}]\")\n        \n    final_output_string = f\"[{','.join(outer_list)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2458507"}]}