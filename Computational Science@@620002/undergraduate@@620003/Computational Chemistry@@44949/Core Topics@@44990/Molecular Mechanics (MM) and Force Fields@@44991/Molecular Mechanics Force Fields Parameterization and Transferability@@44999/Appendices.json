{"hands_on_practices": [{"introduction": "The Lennard-Jones potential is a cornerstone of molecular mechanics, describing the fundamental non-bonded interactions of repulsion and attraction. This exercise develops your intuition by connecting its two key parameters, the size $\\sigma$ and well-depth $\\epsilon$, to a macroscopic observable: the structure of a simple liquid. By analyzing how discrepancies in the simulated radial distribution function $g(r)$ point to specific adjustments in $\\sigma$ and $\\epsilon$, you will practice the foundational logic used in refining force fields against experimental data. [@problem_id:2458523]", "problem": "A single-site Lennard–Jones (LJ) model is used in a molecular dynamics (MD) simulation of liquid argon at fixed thermodynamic state. The pair interaction is given by the Lennard–Jones potential\n$$\nU(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\n$$\nwith size parameter $\\sigma$ and well depth $\\epsilon$. The simulated radial distribution function (RDF), $g(r)$, shows that the position of the first-neighbor peak occurs at a larger separation than in experiment, and the height of that peak is lower than in experiment. Assume the ensemble, cutoff scheme, long-range corrections, and state point are correctly matched to experiment and that no many-body terms are to be added. To improve agreement by modifying only the LJ parameters while maintaining physical interpretability and transferability, which qualitative parameter adjustments are most appropriate?\n\nA. Increase $\\sigma$ and increase $\\epsilon$\n\nB. Decrease $\\sigma$ and increase $\\epsilon$\n\nC. Increase $\\sigma$ and decrease $\\epsilon$\n\nD. Decrease $\\sigma$ and decrease $\\epsilon$", "solution": "The Lennard–Jones potential $U(r)=4\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^{6}\\right]$ is defined by two physically interpretable parameters: the size parameter $\\sigma$, which sets the overall length scale of the repulsive core and the position of the minimum, and the energy parameter $\\epsilon$, which sets the depth of the attractive well. The position of the minimum is\n$$\nr_{\\min}=2^{1/6}\\sigma,\n$$\nso changing $\\sigma$ scales the characteristic intermolecular separation at which attraction and repulsion balance. The radial distribution function $g(r)$ is related to the potential of mean force $w(r)$ by\n$$\nw(r)=-k_{\\mathrm{B}}T\\ln g(r),\n$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the absolute temperature. In a simple monatomic liquid with pairwise interactions at fixed $T$ and density, the first peak of $g(r)$ reflects the most probable nearest-neighbor separation, which is governed by the steeply rising repulsive core and the location of the potential minimum. The peak height reflects the degree of local structuring, which increases when attractions are effectively stronger relative to thermal energy.\n\nFrom these principles:\n\n- If the simulated first peak position is at a larger separation than experiment, the characteristic length scale of repulsion is too large. Decreasing $\\sigma$ shifts $r_{\\min}$, and the steep repulsive wall, to smaller $r$, thereby moving the nearest-neighbor peak of $g(r)$ toward smaller separation.\n\n- If the simulated first peak height is lower than experiment, the liquid is insufficiently structured. Increasing $\\epsilon$ deepens the attractive well, lowering the reduced temperature $T^{\\ast}=k_{\\mathrm{B}}T/\\epsilon$ at fixed $T$, which enhances local ordering and increases the height of the $g(r)$ peaks.\n\nThus, to simultaneously move the peak to smaller $r$ and increase its height, one should decrease $\\sigma$ and increase $\\epsilon$.\n\nOption-by-option analysis:\n\nA. Increase $\\sigma$ and increase $\\epsilon$. Increasing $\\sigma$ shifts $r_{\\min}$ to larger $r$, worsening the discrepancy in peak position (already too large). Although increasing $\\epsilon$ would raise the peak height, the positional error would increase. Verdict: Incorrect.\n\nB. Decrease $\\sigma$ and increase $\\epsilon$. Decreasing $\\sigma$ shifts $r_{\\min}$ to smaller $r$, addressing the too-large peak position, and increasing $\\epsilon$ strengthens attractions, increasing peak height. Verdict: Correct.\n\nC. Increase $\\sigma$ and decrease $\\epsilon$. Increasing $\\sigma$ moves the peak further out, and decreasing $\\epsilon$ weakens structuring, lowering the peak height further. Both effects are opposite to what is needed. Verdict: Incorrect.\n\nD. Decrease $\\sigma$ and decrease $\\epsilon$. Decreasing $\\sigma$ helps correct the peak position, but decreasing $\\epsilon$ would further reduce the peak height, which is already too low. Verdict: Incorrect.", "answer": "$$\\boxed{B}$$", "id": "2458523"}, {"introduction": "A robust force field relies on a complete and balanced set of energy terms to maintain correct molecular geometries. This diagnostic exercise explores what happens when this balance is broken by a common user error in atom-typing. By examining a scenario where a benzene ring incorrectly puckers, you will identify the specific, and often overlooked, energy term responsible for enforcing planarity at $sp^2$ centers, highlighting the critical role of improper torsions. [@problem_id:2458525]", "problem": "A student builds benzene and, by mistake, assigns the same $sp^2$ carbon atom type to every atom in the system, including the hydrogens. The molecule is then minimized with a standard Molecular Mechanics (MM) potential that decomposes the total potential energy $V_{\\text{tot}}$ into bonded and nonbonded contributions such as bond stretching, angle bending, proper torsions, improper torsions, and van der Waals and electrostatic interactions. After minimization, the benzene ring is noticeably nonplanar despite most bond angles remaining near $120^\\circ$. Assuming no other errors in topology, which single MM energy term, if misassigned or omitted due to incorrect atom typing, most directly permits this loss of planarity in an aromatic $sp^2$ system?\n\nA. The bond angle bending term, which sets the equilibrium angle near $120^\\circ$ for trigonal centers\n\nB. The proper dihedral torsion term around carbon–carbon bonds, which sets rotational barriers along bonds\n\nC. The improper dihedral (out-of-plane) term centered on a trigonal carbon, which penalizes pyramidalization\n\nD. The Lennard–Jones (LJ) van der Waals term between nonbonded atoms, which penalizes steric crowding\n\nE. The bond stretching term, which fixes equilibrium bond lengths near those of aromatic bonds", "solution": "The total potential energy $V_{\\text{tot}}$ in a typical molecular mechanics force field is a sum of terms:\n$$V_{\\text{tot}} = V_{\\text{bond}} + V_{\\text{angle}} + V_{\\text{proper\\_dihedral}} + V_{\\text{improper\\_dihedral}} + V_{\\text{nonbonded}}$$\nThe nonbonded term is a sum of van der Waals ($V_{\\text{vdW}}$) and electrostatic ($V_{\\text{elec}}$) interactions.\n$$V_{\\text{nonbonded}} = V_{\\text{vdW}} + V_{\\text{elec}}$$\nThe core of the problem is the consequence of assigning an $sp^2$ carbon atom type to all atoms, including the six hydrogen ($H$) atoms of benzene. A force field retrieves energy function parameters (force constants, equilibrium values) based on the atom types involved in a specific interaction. If a hydrogen atom is typed as a carbon atom, say type `CA`, then any interaction involving that hydrogen will be parameterized as if it were a carbon atom of type `CA`.\n\nThe defining characteristic of an $sp^2$-hybridized center, such as a carbon in benzene, is its trigonal planar geometry. While bond angles of approximately $120^\\circ$ contribute to this, they are not sufficient on their own to enforce planarity for a group of atoms. A six-membered ring with C-C-C angles of $120^\\circ$ can still adopt a nonplanar, puckered conformation. The planarity of the ring as a whole, and at each individual carbon center, is primarily enforced by a specific term that penalizes out-of-plane distortions.\n\nLet us analyze the role of each term provided in the options.\n\n**A. The bond angle bending term, which sets the equilibrium angle near $120^\\circ$ for trigonal centers**\nThe angle bending term, typically a harmonic potential of the form $V_{\\text{angle}} = k_{\\theta}(\\theta - \\theta_0)^2$, maintains bond angles near their equilibrium values, $\\theta_0$. For a C-C-C fragment within the benzene ring, $\\theta_0$ is correctly set to $120^\\circ$. The problem states that \"most bond angles remaining near $120^\\circ$,\" which implies this term is largely functioning correctly for the carbon framework. The mis-typing would affect C-C-H angles, which would be treated as C-C-C angles, but the fundamental loss of planarity of the carbon ring itself is not a direct consequence of incorrect C-C-H angles. Maintenance of local bond angles does not guarantee global planarity. Therefore, this is not the most direct cause.\n**Verdict: Incorrect**\n\n**B. The proper dihedral torsion term around carbon–carbon bonds, which sets rotational barriers along bonds**\nA proper dihedral angle describes the rotation around a central bond in a sequence of four atoms, $I-J-K-L$. For benzene, this term would apply to C-C-C-C quartets within the ring. This term is crucial for defining the potential energy surface for ring puckering. In aromatic systems, it is parameterized to favor a planar conformation. However, the pyramidalization of a single atom (i.e., one atom moving out of the plane defined by its three bonded neighbors) is more directly controlled by the improper dihedral term. The loss of a proper dihedral term allows for easier twisting of the ring, but the loss of an improper dihedral term directly removes the restoring force that keeps individual atoms planar. Thus, the improper dihedral is a more fundamental and direct cause of the observed pyramidalization.\n**Verdict: Incorrect**\n\n**C. The improper dihedral (out-of-plane) term centered on a trigonal carbon, which penalizes pyramidalization**\nThe improper dihedral term is specifically designed to enforce planarity at centers like $sp^2$ carbons. It is defined on a quartet of atoms $I-J-K-L$, where $J$ is the central atom bonded to $I$, $K$, and $L$. The improper dihedral angle $\\omega$ measures the angle between the plane $I-J-K$ and the plane $K-J-L$, or equivalently, the degree to which atom $J$ is displaced from the plane defined by its three neighbors $I$, $K$, and $L$. The potential is often harmonic, $V_{\\text{improper}} = k_{\\omega}(\\omega - \\omega_0)^2$, where $\\omega_0$ is $0^\\circ$ or $180^\\circ$ for a planar center. In benzene, for a given carbon atom $C_i$, the planarity is enforced by an improper torsion involving $C_i$ and its three bonded neighbors (two carbons and one hydrogen). For example, $C_{i-1}-C_{i+1}-C_i-H_i$.\nBy mistyping the hydrogen atom $H_i$ as an $sp^2$ carbon, the system will search for parameters for an improper torsion involving four $sp^2$ carbon types. A force field parameter set may not contain such a definition, or the associated force constant $k_{\\omega}$ might be zero or intended for a different chemical environment. If this term is omitted or carries a zero force constant, there is no energetic penalty for the central carbon atom to move out of the plane of its neighbors. This directly *permits* the pyramidalization of the carbon centers and the subsequent loss of planarity of the entire ring. This is the most direct and primary cause.\n**Verdict: Correct**\n\n**D. The Lennard–Jones (LJ) van der Waals term between nonbonded atoms, which penalizes steric crowding**\nThe Lennard-Jones term accounts for nonbonded interactions. Mistyping a small hydrogen atom as a larger carbon atom would drastically increase the van der Waals radius used for that atomic position. This would lead to significant steric clashes, particularly between adjacent, mistyped \"hydrogens\". During energy minimization, the system would attempt to relieve this artificial steric strain, which could indeed drive the ring to pucker. However, this term does not *permit* the loss of planarity; it provides a *force* that causes distortion. The distortion is only possible because the restoring force that should maintain planarity (the improper dihedral term) is absent or incorrect. Therefore, the LJ term is a secondary, contributing factor, not the primary permissive cause. The question asks what *permits* the deformation.\n**Verdict: Incorrect**\n\n**E. The bond stretching term, which fixes equilibrium bond lengths near those of aromatic bonds**\nThe bond stretching term, $V_{\\text{bond}} = k_{b}(b - b_0)^2$, controls the lengths of covalent bonds. Mis-typing hydrogens as carbons would cause the C-H bonds to be treated as C-C bonds, likely resulting in incorrect equilibrium bond lengths after minimization (e.g., stretching a C-H bond of $\\sim 1.1$ Å to a C-C aromatic length of $\\sim 1.4$ Å). While this is a serious error, it does not directly explain the loss of planarity of the ring. A molecule can have incorrect bond lengths while remaining planar, and conversely, it can have correct bond lengths while being nonplanar.\n**Verdict: Incorrect**\n\nIn conclusion, the improper dihedral term is the specific component of an MM force field designed to maintain planarity at trigonal centers. Its omission or mis-parameterization due to the student's atom-typing error most directly allows the benzene ring to adopt a nonplanar conformation.", "answer": "$$\\boxed{C}$$", "id": "2458525"}, {"introduction": "The power of molecular mechanics lies in the transferability of its parameters—the assumption that parameters for a chemical group in one molecule can be applied to another. This hands-on coding task moves beyond this qualitative concept to a quantitative measure of performance. You will implement a function to calculate the root-mean-square deviation (RMSD) between potential energy profiles, providing a concrete metric to evaluate how well a set of dihedral parameters transfers between two related alkanes. [@problem_id:2458520]", "problem": "You are given the mathematical form of a torsional (dihedral) potential used in classical molecular mechanics. For a single dihedral angle, the torsional contribution to the potential energy is modeled by a truncated Fourier series\n$$\nE(\\varphi;\\,\\mathcal{P}) \\;=\\; \\sum_{j=1}^{M} \\frac{K_j}{2}\\,\\bigl[\\,1 + \\cos\\!\\bigl(n_j \\varphi - \\delta_j\\bigr)\\,\\bigr],\n$$\nwhere $\\varphi$ is the dihedral angle in radians, $\\mathcal{P}=\\{(K_j,n_j,\\delta_j)\\}_{j=1}^{M}$ is the parameter set, $K_j$ are amplitudes in $\\mathrm{kJ\\,mol^{-1}}$, $n_j$ are integer multiplicities, and $\\delta_j$ are phase shifts in radians. Consider a transferability test in which a parameter set $\\mathcal{P}^{(\\mathrm{but})}$ derived for $n$-butane is used to predict the torsional energy profile of $2$-methylbutane, whose reference (target) profile is given by $\\mathcal{P}^{(\\mathrm{ref})}$. Define the transferability error over a discrete set of angles $\\Phi$ as the root-mean-square deviation\n$$\n\\mathrm{RMSD}\\!\\left(\\mathcal{P}^{(\\mathrm{but})}\\to\\mathcal{P}^{(\\mathrm{ref})};\\,\\Phi\\right) \\;=\\; \\sqrt{\\frac{1}{|\\Phi|}\\sum_{\\varphi\\in\\Phi}\\Bigl(E(\\varphi;\\,\\mathcal{P}^{(\\mathrm{but})}) - E(\\varphi;\\,\\mathcal{P}^{(\\mathrm{ref})})\\Bigr)^2}.\n$$\nUsing the above definition, write a program that computes $\\mathrm{RMSD}$ in $\\mathrm{kJ\\,mol^{-1}}$ for each of the following test cases. In all cases, use the angle set $\\Phi=\\{0,\\,\\tfrac{\\pi}{2},\\,\\pi,\\,\\tfrac{3\\pi}{2}\\}$ with angles in radians. All amplitudes $K_j$ must be interpreted in $\\mathrm{kJ\\,mol^{-1}}$, all phases $\\delta_j$ in radians, and all multiplicities $n_j$ as integers.\n\nTest cases (each case specifies $\\mathcal{P}^{(\\mathrm{but})}$ and $\\mathcal{P}^{(\\mathrm{ref})}$ as lists of triples $(K,n,\\delta)$):\n\n- Case A (perfect transferability baseline):\n  - $\\mathcal{P}^{(\\mathrm{but})} = \\bigl[(4.0,\\,1,\\,0),\\,(1.0,\\,2,\\,0),\\,(2.0,\\,3,\\,0)\\bigr]$,\n  - $\\mathcal{P}^{(\\mathrm{ref})} = \\bigl[(4.0,\\,1,\\,0),\\,(1.0,\\,2,\\,0),\\,(2.0,\\,3,\\,0)\\bigr]$.\n\n- Case B (single-amplitude deviation in the $n{=}1$ term):\n  - $\\mathcal{P}^{(\\mathrm{but})} = \\bigl[(4.0,\\,1,\\,0),\\,(1.0,\\,2,\\,0),\\,(2.0,\\,3,\\,0)\\bigr]$,\n  - $\\mathcal{P}^{(\\mathrm{ref})} = \\bigl[(5.0,\\,1,\\,0),\\,(1.0,\\,2,\\,0),\\,(2.0,\\,3,\\,0)\\bigr]$.\n\n- Case C (phase inversion in the $n{=}3$ term for the reference):\n  - $\\mathcal{P}^{(\\mathrm{but})} = \\bigl[(4.0,\\,1,\\,0),\\,(1.0,\\,2,\\,0),\\,(2.0,\\,3,\\,0)\\bigr]$,\n  - $\\mathcal{P}^{(\\mathrm{ref})} = \\bigl[(4.0,\\,1,\\,0),\\,(1.0,\\,2,\\,0),\\,(2.0,\\,3,\\,\\pi)\\bigr]$.\n\n- Case D (uniform scaling of reference amplitudes by $s=0.5$):\n  - $\\mathcal{P}^{(\\mathrm{but})} = \\bigl[(4.0,\\,1,\\,0),\\,(1.0,\\,2,\\,0),\\,(2.0,\\,3,\\,0)\\bigr]$,\n  - $\\mathcal{P}^{(\\mathrm{ref})} = \\bigl[(2.0,\\,1,\\,0),\\,(0.5,\\,2,\\,0),\\,(1.0,\\,3,\\,0)\\bigr]$.\n\nYour program must produce a single line containing a list of the four $\\mathrm{RMSD}$ values corresponding to cases A, B, C, and D, expressed in $\\mathrm{kJ\\,mol^{-1}}$, each rounded to six decimal places, formatted exactly as a comma-separated list enclosed in square brackets, for example, $[\\dots]$.", "solution": "The problem requires the computation of the root-mean-square deviation (RMSD) between two torsional potential energy profiles, which serves as a measure of parameter transferability in molecular mechanics. The analysis will proceed by first defining the necessary functions and then applying them to the specified test cases.\n\nThe torsional potential energy, $E$, for a given dihedral angle $\\varphi$ is described by a finite Fourier series:\n$$\nE(\\varphi;\\,\\mathcal{P}) \\;=\\; \\sum_{j=1}^{M} \\frac{K_j}{2}\\,\\bigl[\\,1 + \\cos\\!\\bigl(n_j \\varphi - \\delta_j\\bigr)\\,\\bigr]\n$$\nHere, $\\mathcal{P}=\\{(K_j,n_j,\\delta_j)\\}_{j=1}^{M}$ is the set of parameters defining the potential, where $K_j$ is the amplitude in $\\mathrm{kJ\\,mol^{-1}}$, $n_j$ is the integer multiplicity, and $\\delta_j$ is the phase shift in radians.\n\nThe transferability error is quantified by the RMSD between the energy profile generated by the parameters to be tested, $\\mathcal{P}^{(\\mathrm{but})}$, and a reference profile, $\\mathcal{P}^{(\\mathrm{ref})}$, evaluated over a discrete set of angles $\\Phi$:\n$$\n\\mathrm{RMSD}\\!\\left(\\mathcal{P}^{(\\mathrm{but})}\\to\\mathcal{P}^{(\\mathrm{ref})};\\,\\Phi\\right) \\;=\\; \\sqrt{\\frac{1}{|\\Phi|}\\sum_{\\varphi\\in\\Phi}\\Bigl(E(\\varphi;\\,\\mathcal{P}^{(\\mathrm{but})}) - E(\\varphi;\\,\\mathcal{P}^{(\\mathrm{ref})})\\Bigr)^2}\n$$\nThe problem specifies the set of angles as $\\Phi=\\{0,\\,\\tfrac{\\pi}{2},\\,\\pi,\\,\\tfrac{3\\pi}{2}\\}$, which contains $|\\Phi|=4$ points.\n\nThe algorithm to solve this is composed of two main steps:\n$1$. A function is designed to compute the energy $E(\\varphi; \\mathcal{P})$ for any given angle $\\varphi$ and parameter set $\\mathcal{P}$. This function iterates through the terms of the parameter set, calculates the energy contribution for each term $j$ using the formula $\\frac{K_j}{2}\\,[1 + \\cos(n_j \\varphi - \\delta_j)]$, and accumulates these contributions into a total sum. For computational efficiency, this can be vectorized to calculate the energies for all angles in $\\Phi$ simultaneously.\n\n$2$. A second function is designed to compute the RMSD. This function takes as input the two parameter sets, $\\mathcal{P}^{(\\mathrm{but})}$ and $\\mathcal{P}^{(\\mathrm{ref})}$, and the angle set $\\Phi$. It performs the following sequence of operations:\n   a. For each angle $\\varphi \\in \\Phi$, it computes the energies $E(\\varphi;\\,\\mathcal{P}^{(\\mathrm{but})})$ and $E(\\varphi;\\,\\mathcal{P}^{(\\mathrm{ref})})$ using the function from step $1$.\n   b. It calculates the squared difference, $\\Delta E^2 = (E(\\varphi;\\,\\mathcal{P}^{(\\mathrm{but})}) - E(\\varphi;\\,\\mathcal{P}^{(\\mathrm{ref})}))^2$, for each angle.\n   c. It computes the mean of these squared differences over all angles in $\\Phi$.\n   d. The final RMSD is the square root of this mean.\n\nLet us illustrate with Case C. The parameter sets are:\n$\\mathcal{P}^{(\\mathrm{but})} = \\bigl[(4.0,\\,1,\\,0),\\,(1.0,\\,2,\\,0),\\,(2.0,\\,3,\\,0)\\bigr]$\n$\\mathcal{P}^{(\\mathrm{ref})} = \\bigl[(4.0,\\,1,\\,0),\\,(1.0,\\,2,\\,0),\\,(2.0,\\,3,\\,\\pi)\\bigr]$\nThe first two terms ($j=1, 2$) are identical in both sets. The energy difference $\\Delta E(\\varphi) = E(\\varphi; \\mathcal{P}^{(\\mathrm{but})}) - E(\\varphi; \\mathcal{P}^{(\\mathrm{ref})})$ depends only on the third term ($j=3$):\n$$\n\\Delta E(\\varphi) = \\frac{2.0}{2}\\bigl[1 + \\cos(3\\varphi - 0)\\bigr] - \\frac{2.0}{2}\\bigl[1 + \\cos(3\\varphi - \\pi)\\bigr]\n$$\nUsing the identity $\\cos(x - \\pi) = -\\cos(x)$, this simplifies to:\n$$\n\\Delta E(\\varphi) = \\bigl(1 + \\cos(3\\varphi)\\bigr) - \\bigl(1 - \\cos(3\\varphi)\\bigr) = 2\\cos(3\\varphi)\n$$\nWe evaluate the squared differences $(\\Delta E(\\varphi))^2 = 4\\cos^2(3\\varphi)$ at each angle in $\\Phi$:\n- For $\\varphi=0$: $(\\Delta E)^2 = 4\\cos^2(0) = 4(1)^2 = 4$.\n- For $\\varphi=\\pi/2$: $(\\Delta E)^2 = 4\\cos^2(3\\pi/2) = 4(0)^2 = 0$.\n- For $\\varphi=\\pi$: $(\\Delta E)^2 = 4\\cos^2(3\\pi) = 4(-1)^2 = 4$.\n- For $\\varphi=3\\pi/2$: $(\\Delta E)^2 = 4\\cos^2(9\\pi/2) = 4(0)^2 = 0$.\n\nThe sum of squared differences is $4+0+4+0=8$. The mean is $8/4=2$. The RMSD is therefore $\\sqrt{2} \\approx 1.414214\\,\\mathrm{kJ\\,mol^{-1}}$.\n\nThis procedure is implemented programmatically and applied to all four specified test cases to generate the final results.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the RMSD for torsional potential transferability test cases.\n    \"\"\"\n\n    def calculate_energy(phi_array, params):\n        \"\"\"\n        Calculates the torsional energy for a given array of angles.\n\n        Args:\n            phi_array (np.ndarray): An array of dihedral angles in radians.\n            params (list): A list of tuples, where each tuple is (K, n, delta).\n\n        Returns:\n            np.ndarray: An array of total torsional energies corresponding to each angle.\n        \"\"\"\n        total_energy = np.zeros_like(phi_array, dtype=float)\n        for K, n, delta in params:\n            total_energy += (K / 2.0) * (1.0 + np.cos(n * phi_array - delta))\n        return total_energy\n\n    def calculate_rmsd(params_but, params_ref, angles):\n        \"\"\"\n        Calculates the Root-Mean-Square Deviation (RMSD) between two\n        potential energy profiles.\n\n        Args:\n            params_but (list): Parameter set for the tested potential.\n            params_ref (list): Parameter set for the reference potential.\n            angles (np.ndarray): Array of angles for evaluation.\n\n        Returns:\n            float: The calculated RMSD value.\n        \"\"\"\n        # Calculate energy profiles for both parameter sets\n        E_but = calculate_energy(angles, params_but)\n        E_ref = calculate_energy(angles, params_ref)\n        \n        # Calculate the RMSD using the formula\n        squared_errors = (E_but - E_ref)**2\n        mean_squared_error = np.mean(squared_errors)\n        rmsd = np.sqrt(mean_squared_error)\n        \n        return rmsd\n\n    # Define the discrete set of angles in radians\n    angles = np.array([0, np.pi/2, np.pi, 3*np.pi/2])\n    \n    # Define the test cases as pairs of parameter sets (P_but, P_ref)\n    test_cases = [\n        # Case A: Perfect transferability baseline\n        (\n            [(4.0, 1, 0), (1.0, 2, 0), (2.0, 3, 0)],\n            [(4.0, 1, 0), (1.0, 2, 0), (2.0, 3, 0)]\n        ),\n        # Case B: Single-amplitude deviation in the n=1 term\n        (\n            [(4.0, 1, 0), (1.0, 2, 0), (2.0, 3, 0)],\n            [(5.0, 1, 0), (1.0, 2, 0), (2.0, 3, 0)]\n        ),\n        # Case C: Phase inversion in the n=3 term for the reference\n        (\n            [(4.0, 1, 0), (1.0, 2, 0), (2.0, 3, 0)],\n            [(4.0, 1, 0), (1.0, 2, 0), (2.0, 3, np.pi)]\n        ),\n        # Case D: Uniform scaling of reference amplitudes by s=0.5\n        (\n            [(4.0, 1, 0), (1.0, 2, 0), (2.0, 3, 0)],\n            [(2.0, 1, 0), (0.5, 2, 0), (1.0, 3, 0)]\n        )\n    ]\n    \n    results = []\n    for params_but, params_ref in test_cases:\n        rmsd_value = calculate_rmsd(params_but, params_ref, angles)\n        results.append(rmsd_value)\n        \n    # Format the results to six decimal places and print in the specified format\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2458520"}]}