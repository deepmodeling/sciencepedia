{"hands_on_practices": [{"introduction": "Classical force fields are powerful tools, but their accuracy depends critically on their parameters, such as partial charges and Lennard-Jones coefficients. These parameters are not arbitrary; they are carefully tuned to reproduce known experimental data, like the density or heat of vaporization of liquids. This exercise gives you a direct look into this crucial parameterization process [@problem_id:2456417]. By systematically adjusting a single partial charge, $q$, in a simplified methanol model, you will work to match its predicted heat of vaporization, $\\Delta H_{\\mathrm{vap}}$, to the experimental value, gaining a tangible understanding of how microscopic parameters govern macroscopic thermodynamic properties.", "problem": "You are given a simplified, physically grounded methanol model in which only the hydroxyl hydrogen and oxygen carry partial charges that are equal and opposite. Let the hydroxyl hydrogen carry a partial charge of $+q$ (in units of the elementary charge $e$) and the oxygen carry $-q$. The methyl group is electrically neutral. The predicted molar heat of vaporization of the liquid, denoted $\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q)$, is modeled as\n$$\n\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) \\;=\\; E_{\\mathrm{ne}} \\;+\\; \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\\,q^2 \\;+\\; R\\,T,\n$$\nwhere $E_{\\mathrm{ne}}$ is the baseline non-electrostatic cohesive contribution per mole, $s$ is a dimensionless screening factor accounting for orientational averaging and local screening, $z$ is the average hydrogen-bond coordination number per molecule, $k_e$ is the Coulomb constant expressed in force-field units, $r_{\\mathrm{HB}}$ is a characteristic oxygen-to-hydrogen hydrogen-bond distance, $R$ is the molar gas constant, and $T$ is the absolute temperature. All energies are in $\\mathrm{kJ\\,mol^{-1}}$, distances in $\\mathrm{nm}$, temperature in $\\mathrm{K}$, and charges in units of $e$. Use the constants $k_e = 138.935456\\ \\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$ and $R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$. For each test case below, let $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}$ denote the target experimental molar heat of vaporization.\n\nYour task is: for each test case, compute the nonnegative hydroxyl hydrogen partial charge $q_{\\mathrm{opt}}$ (in units of $e$) that minimizes the squared error between the model prediction and experiment, that is, minimizes\n$$\n\\left(\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}\\right)^2\n$$\nsubject to $q \\ge 0$. Report each $q_{\\mathrm{opt}}$ as a decimal number in units of $e$, rounded to four decimal places.\n\nTest suite (each bullet provides $(T,\\ \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}},\\ r_{\\mathrm{HB}},\\ z,\\ s,\\ E_{\\mathrm{ne}})$ in the order they must be processed):\n- Case 1 (nominal methanol conditions): $(298.15\\ \\mathrm{K},\\ 35.3\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.05,\\ 20.0\\ \\mathrm{kJ\\,mol^{-1}})$.\n- Case 2 (baseline exceeds target; boundary behavior): $(298.15\\ \\mathrm{K},\\ 35.3\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.05,\\ 33.0\\ \\mathrm{kJ\\,mol^{-1}})$.\n- Case 3 (elevated temperature with lower target): $(350.0\\ \\mathrm{K},\\ 31.0\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.05,\\ 20.0\\ \\mathrm{kJ\\,mol^{-1}})$.\n- Case 4 (weaker effective screening): $(298.15\\ \\mathrm{K},\\ 35.3\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.02,\\ 20.0\\ \\mathrm{kJ\\,mol^{-1}})$.\n\nFinal output format: Your program should produce a single line of output containing the four optimal charges as a comma-separated list enclosed in square brackets, in the same order as the test suite, for example, $[q_1,q_2,q_3,q_4]$, with each $q_i$ rounded to four decimal places and expressed in units of $e$.", "solution": "The problem is first critically validated.\n\n**Step 1: Extract Givens**\n- The model for the predicted molar heat of vaporization of methanol is given as:\n$$\n\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) \\;=\\; E_{\\mathrm{ne}} \\;+\\; \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\\,q^2 \\;+\\; R\\,T\n$$\nwhere $q$ is the partial charge on the hydroxyl hydrogen in units of $e$, $E_{\\mathrm{ne}}$ is the non-electrostatic cohesive energy, $s$ is a screening factor, $z$ is the coordination number, $k_e$ is the Coulomb constant, $r_{\\mathrm{HB}}$ is the hydrogen-bond distance, $R$ is the molar gas constant, and $T$ is the temperature.\n- Constants:\n  - $k_e = 138.935456\\ \\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$\n  - $R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$\n- The objective is to find the non-negative charge, $q_{\\mathrm{opt}} \\ge 0$, that minimizes the squared error:\n$$\nL(q) = \\left(\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}\\right)^2\n$$\nwhere $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}$ is the experimental molar heat of vaporization.\n- Four test cases are provided, each specifying the set of parameters $(T,\\ \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}},\\ r_{\\mathrm{HB}},\\ z,\\ s,\\ E_{\\mathrm{ne}})$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The model is a physically plausible, albeit simplified, representation of cohesive energy in a polar liquid. It partitions the energy into a non-electrostatic Lennard-Jones-type contribution ($E_{\\mathrm{ne}}$), a pairwise electrostatic term (the $q^2$ term), and a pressure-volume work term upon vaporization ($RT$). Such models are fundamental to the development of classical molecular mechanics force fields. The constants and parameter values are within realistic ranges for condensed-phase methanol. The problem is scientifically and factually sound.\n- **Well-Posedness:** The objective is to minimize a function $L(q)$ subject to $q \\ge 0$. The function is a simple polynomial in $q$, ensuring a well-defined minimum exists. The problem is mathematically structured to have a unique and stable solution.\n- **Objectivity:** The problem is stated using precise, objective, and formal scientific language, free from ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\n- The problem is valid. It is scientifically grounded, well-posed, and objective. A solution will be formulated.\n\n**Solution Derivation**\nThe task is to find the value of $q \\ge 0$ that minimizes the squared error function:\n$$\nL(q) = \\left( \\left( E_{\\mathrm{ne}} \\;+\\; R\\,T \\;+\\; \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\\,q^2 \\right) - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} \\right)^2\n$$\nTo simplify the expression, we define two auxiliary quantities. Let the baseline, non-electrostatic contribution to the enthalpy of vaporization be:\n$$\nH_{\\mathrm{base}} = E_{\\mathrm{ne}} + R\\,T\n$$\nAnd let the coefficient of the electrostatic term be:\n$$\nC_{\\mathrm{elec}} = \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\n$$\nThe parameters $s$, $z$, $k_e$, and $r_{\\mathrm{HB}}$ are all specified as positive physical quantities, hence $C_{\\mathrm{elec}} > 0$. The objective function now takes the form:\n$$\nL(q) = \\left( H_{\\mathrm{base}} + C_{\\mathrm{elec}}\\,q^2 - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} \\right)^2\n$$\nWe seek to minimize $L(q)$ for $q \\ge 0$. Since $L(q)$ is a squared quantity, its minimum value is $0$. This minimum is achieved if and only if the term inside the parenthesis is zero, provided a solution exists within the allowed domain for $q$. We therefore set the term to zero and solve for $q$:\n$$\nH_{\\mathrm{base}} + C_{\\mathrm{elec}}\\,q^2 - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} = 0\n$$\n$$\nC_{\\mathrm{elec}}\\,q^2 = \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}\n$$\n$$\nq^2 = \\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}}{C_{\\mathrm{elec}}}\n$$\nLet us analyze the numerator, $\\Delta E = \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}$.\n\nCase 1: The electrostatic interaction contributes to matching the experiment.\nIf $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} \\ge H_{\\mathrm{base}}$, then $\\Delta E \\ge 0$. The equation for $q^2$ has a non-negative right-hand side. We can find a real solution for $q$:\n$$\nq = \\pm\\sqrt{\\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}}{C_{\\mathrm{elec}}}}\n$$\nGiven the constraint that $q \\ge 0$, the optimal charge is the principal square root:\n$$\nq_{\\mathrm{opt}} = \\sqrt{\\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - (E_{\\mathrm{ne}} + R\\,T)}{s\\,z\\,k_e / r_{\\mathrm{HB}}}}\n$$\n\nCase 2: The baseline model already exceeds the experimental value.\nIf $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} < H_{\\mathrm{base}}$, then $\\Delta E < 0$. The right-hand side of the equation for $q^2$ is negative, so no real value of $q$ can make the error zero. In this situation, the term inside the parenthesis, $C_{\\mathrm{elec}}\\,q^2 - (-\\Delta E)$, is always positive for any real $q$, since $C_{\\mathrm{elec}} > 0$ and $-\\Delta E > 0$. To minimize the squared error $L(q) = (C_{\\mathrm{elec}}\\,q^2 - (-\\Delta E))^2$, we must minimize the value of $C_{\\mathrm{elec}}\\,q^2$. Given the constraint $q \\ge 0$, the term $C_{\\mathrm{elec}}\\,q^2$ is a monotonically increasing function of $q$. Its minimum value occurs at the lower boundary of the domain, which is $q=0$. Therefore, for this case:\n$$\nq_{\\mathrm{opt}} = 0\n$$\nThis result is physically logical: if the non-electrostatic model already overestimates the cohesive energy, the electrostatic contribution, which is always positive in this model, must be set to zero to achieve the best possible agreement.\n\nCombining both cases, the optimal charge $q_{\\mathrm{opt}}$ can be expressed compactly:\n$$\nq_{\\mathrm{opt}} = \\sqrt{\\max\\left(0, \\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - E_{\\mathrm{ne}} - R\\,T}{s\\,z\\,k_e / r_{\\mathrm{HB}}}\\right)}\n$$\nThis formula will be implemented to solve for $q_{\\mathrm{opt}}$ for each of the four test cases specified. The result for each case will be rounded to four decimal places.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the optimal partial charge q that minimizes the squared error\n    between a simple model for the heat of vaporization of methanol and its\n    experimental value.\n    \"\"\"\n    \n    # Define physical constants from the problem statement.\n    # k_e: Coulomb constant in kJ mol^-1 nm e^-2\n    k_e = 138.935456\n    # R: Molar gas constant in kJ mol^-1 K^-1\n    R = 8.314462618e-3\n\n    # Test suite cases: (T, delta_H_vap_exp, r_HB, z, s, E_ne)\n    # T in K, delta_H_vap_exp in kJ/mol, r_HB in nm, z dimensionless,\n    # s dimensionless, E_ne in kJ/mol.\n    test_cases = [\n        # Case 1: Nominal methanol conditions\n        (298.15, 35.3, 0.19, 1.7, 0.05, 20.0),\n        # Case 2: Baseline exceeds target; boundary behavior\n        (298.15, 35.3, 0.19, 1.7, 0.05, 33.0),\n        # Case 3: Elevated temperature with lower target\n        (350.0, 31.0, 0.19, 1.7, 0.05, 20.0),\n        # Case 4: Weaker effective screening\n        (298.15, 35.3, 0.19, 1.7, 0.02, 20.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        T, delta_H_vap_exp, r_HB, z, s, E_ne = case\n\n        # Calculate the numerator for the q^2 expression:\n        # delta_H_vap_exp - (E_ne + R*T)\n        numerator = delta_H_vap_exp - E_ne - R * T\n        \n        q_opt = 0.0\n        # If the numerator is non-negative, a non-zero charge can improve the model.\n        if numerator >= 0:\n            # Calculate the denominator (electrostatic coefficient)\n            # C_elec = (s * z * k_e) / r_HB\n            denominator = (s * z * k_e) / r_HB\n            \n            # The problem parameters ensure denominator is positive.\n            q_squared = numerator / denominator\n            q_opt = np.sqrt(q_squared)\n        # If the numerator is negative, the non-electrostatic part of the model\n        # already exceeds the target value. The best fit is achieved by setting\n        # the electrostatic contribution to zero, i.e., q_opt = 0.\n\n        results.append(q_opt)\n\n    # Format results to four decimal places as strings\n    formatted_results = [f\"{res:.4f}\" for res in results]\n\n    # Print the final output in the required format: [q1,q2,q3,q4]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2456417"}, {"introduction": "Once a force field is built and parameterized, it becomes a predictive engine for molecular interactions, a core task in fields like drug discovery. A key application is to estimate the binding affinity of different molecules to a protein target. In this practice, you will step into the role of a computational chemist and develop a \"scoring function\" to rank potential drug candidates based on their hydrogen bonding patterns observed in molecular dynamics simulations [@problem_id:2456497]. You will combine fundamental principles—electrostatics and geometric energy penalties—to quantify bond strength and learn how such scores guide the design of more effective medicines.", "problem": "A pharmaceutical team runs a short Molecular Dynamics (MD) simulation for three drug candidates, labeled $L1$, $L2$, and $L3$, bound to the same protein pocket. For each ligand, the simulation reveals two persistent hydrogen bonds to the protein. The time-averaged hydrogen-bond observables for each candidate are listed below. Each bond report includes the average hydrogen–acceptor separation $r$ (nanometers), the donor–hydrogen–acceptor angle $\\theta$ (degrees), the bond occupancy fraction $f$ (the fraction of frames in which the bond is present), and the partial charges on the hydrogen donor atom $q_H$ and acceptor atom $q_A$ (elementary charge units). The protein interior is modeled with a relative dielectric constant $\\varepsilon_r$. The following data are measured:\n- Common constants for all candidates: $\\varepsilon_r = 4.0$, ideal hydrogen–acceptor distance $r_0 = 0.19 \\ \\mathrm{nm}$, ideal angle $\\theta_0 = 180^\\circ$, distance harmonic constant $k_r = 150 \\ \\mathrm{kJ \\ mol^{-1} \\ nm^{-2}}$, angle harmonic constant $k_\\theta = 0.02 \\ \\mathrm{kJ \\ mol^{-1} \\ deg^{-2}}$. Use the molecular-mechanics Coulomb prefactor $k_e = 138.94 \\ \\mathrm{kJ \\ mol^{-1} \\ nm \\ e^{-2}}$.\n- $L1$:\n  - Bond $1$: $f = 0.75$, $r = 0.195 \\ \\mathrm{nm}$, $\\theta = 170^\\circ$, $q_H = +0.30 \\ e$, $q_A = -0.50 \\ e$.\n  - Bond $2$: $f = 0.40$, $r = 0.220 \\ \\mathrm{nm}$, $\\theta = 155^\\circ$, $q_H = +0.25 \\ e$, $q_A = -0.45 \\ e$.\n- $L2$:\n  - Bond $1$: $f = 0.60$, $r = 0.185 \\ \\mathrm{nm}$, $\\theta = 177^\\circ$, $q_H = +0.33 \\ e$, $q_A = -0.50 \\ e$.\n  - Bond $2$: $f = 0.50$, $r = 0.240 \\ \\mathrm{nm}$, $\\theta = 150^\\circ$, $q_H = +0.20 \\ e$, $q_A = -0.40 \\ e$.\n- $L3$:\n  - Bond $1$: $f = 0.90$, $r = 0.205 \\ \\mathrm{nm}$, $\\theta = 165^\\circ$, $q_H = +0.28 \\ e$, $q_A = -0.48 \\ e$.\n  - Bond $2$: $f = 0.20$, $r = 0.180 \\ \\mathrm{nm}$, $\\theta = 180^\\circ$, $q_H = +0.35 \\ e$, $q_A = -0.55 \\ e$.\n\nFrom first principles appropriate to classical force fields, construct a hydrogen-bond score intended to approximate the time-averaged energetic contribution of hydrogen bonds to binding, and use it to rank the candidates by predicted affinity. Use only the following foundational elements:\n- Electrostatics: the Coulomb interaction between two point charges $q_1$ and $q_2$ separated by $r$ in a medium with dielectric $\\varepsilon_r$ is given by $E_\\text{Coul} = \\dfrac{k_e}{\\varepsilon_r}\\dfrac{q_1 q_2}{r}$, with $k_e$ as provided above.\n- Geometry dependence: near an ideal geometry, energy penalties for deviations are well-approximated by quadratic (harmonic) terms in the displacement from the ideal value. Use the provided ideal values $r_0$ and $\\theta_0$ and the given harmonic constants to quantify distance and angle penalties.\n- Time averaging: approximate the time-averaged contribution of each hydrogen bond as the occupancy fraction $f$ multiplied by the energetic estimate evaluated at the time-averaged geometry.\n\nAssume additivity of bond contributions and that a more negative total score corresponds to a stronger net hydrogen-bonding contribution and higher affinity, all else equal. Based on these assumptions and the data above, which candidate has the most favorable (most negative) total hydrogen-bond score?\n\nA. $L1$\n\nB. $L2$\n\nC. $L3$\n\nD. They are indistinguishable within the given model (a tie)", "solution": "We begin with a critical validation of the problem statement. The exercise describes a method for scoring protein-ligand hydrogen bonds using a simplified molecular mechanics model. A cursory examination of the givens, definitions, and constraints is required to establish scientific and logical integrity before any attempt at a solution.\n\nThe problem provides the following:\n- Three ligands, $L1$, $L2$, and $L3$, each forming two hydrogen bonds.\n- Time-averaged geometric parameters for each bond: hydrogen-acceptor distance $r$ and donor-hydrogen-acceptor angle $\\theta$.\n- Bond occupancy fraction $f$ for each bond.\n- Partial charges $q_H$ and $q_A$ for the hydrogen and acceptor atoms.\n- A set of universal constants: relative dielectric constant $\\varepsilon_r = 4.0$, ideal geometric parameters $r_0 = 0.19 \\ \\mathrm{nm}$ and $\\theta_0 = 180^\\circ$, harmonic force constants for distance $k_r = 150 \\ \\mathrm{kJ \\ mol^{-1} \\ nm^{-2}}$ and angle $k_\\theta = 0.02 \\ \\mathrm{kJ \\ mol^{-1} \\ deg^{-2}}$, and the Coulombic prefactor $k_e = 138.94 \\ \\mathrm{kJ \\ mol^{-1} \\ nm \\ e^{-2}}$.\n- A clear prescription for constructing a scoring function based on Coulomb's law for electrostatics and harmonic potentials for geometric penalties, weighted by occupancy.\n- A directive to find the ligand with the most negative (most favorable) total score.\n\nThe problem formulation is scientifically grounded. The use of a simplified, additive energy function comprising electrostatic and harmonic terms is a standard approximation in molecular mechanics force fields. The values of the physical constants, charges, and geometric parameters are all within realistic ranges for such systems. The problem is well-posed; it provides all necessary information and a clear, unambiguous objective. It does not violate any fundamental principles of physics or chemistry, nor does it contain internal contradictions. The problem is therefore deemed **valid**. We may proceed with the derivation.\n\nThe problem requires the construction of a hydrogen-bond score, $S$, for each ligand. The total score for a given ligand, $S_{\\text{total}}$, is the sum of the scores for its two individual hydrogen bonds.\n$$S_{\\text{total}} = S_{\\text{bond},1} + S_{\\text{bond},2}$$\n\nAccording to the problem statement, the score for a single bond, $S_{\\text{bond}}$, is the product of its occupancy fraction, $f$, and its energy, $E_{\\text{bond}}$, calculated at the time-averaged geometry.\n$$S_{\\text{bond}} = f \\cdot E_{\\text{bond}}$$\n\nThe energy $E_{\\text{bond}}$ is composed of an electrostatic contribution and geometric penalty terms.\n$$E_{\\text{bond}} = E_{\\text{Coul}} + E_{r} + E_{\\theta}$$\n\nThe individual energy terms are defined as follows:\n1.  The electrostatic energy ($E_{\\text{Coul}}$) between the hydrogen and acceptor point charges:\n    $$E_{\\text{Coul}} = \\frac{k_e}{\\varepsilon_r}\\frac{q_H q_A}{r}$$\n2.  The harmonic penalty for deviation of the bond distance $r$ from the ideal distance $r_0$:\n    $$E_r = k_r (r - r_0)^2$$\n3.  The harmonic penalty for deviation of the bond angle $\\theta$ from the ideal angle $\\theta_0$:\n    $$E_\\theta = k_\\theta (\\theta - \\theta_0)^2$$\n\nCombining these, the score for a single hydrogen bond is:\n$$S_{\\text{bond}} = f \\left[ \\frac{k_e}{\\varepsilon_r}\\frac{q_H q_A}{r} + k_r (r - r_0)^2 + k_\\theta (\\theta - \\theta_0)^2 \\right]$$\n\nWe now apply this formula to each bond for each ligand using the provided data. The units will be in $\\mathrm{kJ \\ mol^{-1}}$.\nThe constant prefactor for the Coulomb term is $\\frac{k_e}{\\varepsilon_r} = \\frac{138.94}{4.0} = 34.735 \\ \\mathrm{kJ \\ mol^{-1} \\ nm \\ e^{-2}}$.\n\n**Candidate $L1$**\n- Bond $1$: $f=0.75$, $r=0.195 \\ \\mathrm{nm}$, $\\theta=170^\\circ$, $q_H=0.30 \\ e$, $q_A=-0.50 \\ e$.\n  $S_1 = 0.75 \\left[ 34.735 \\frac{(0.30)(-0.50)}{0.195} + 150(0.195 - 0.19)^2 + 0.02(170 - 180)^2 \\right]$\n  $S_1 = 0.75 \\left[ -26.7192 + 150(0.005)^2 + 0.02(-10)^2 \\right]$\n  $S_1 = 0.75 \\left[ -26.7192 + 0.00375 + 2.0 \\right] = 0.75(-24.7155) \\approx -18.537 \\ \\mathrm{kJ \\ mol^{-1}}$\n- Bond $2$: $f=0.40$, $r=0.220 \\ \\mathrm{nm}$, $\\theta=155^\\circ$, $q_H=0.25 \\ e$, $q_A=-0.45 \\ e$.\n  $S_2 = 0.40 \\left[ 34.735 \\frac{(0.25)(-0.45)}{0.220} + 150(0.220 - 0.19)^2 + 0.02(155 - 180)^2 \\right]$\n  $S_2 = 0.40 \\left[ -17.7472 + 150(0.03)^2 + 0.02(-25)^2 \\right]$\n  $S_2 = 0.40 \\left[ -17.7472 + 0.135 + 12.5 \\right] = 0.40(-5.1122) \\approx -2.045 \\ \\mathrm{kJ \\ mol^{-1}}$\n- Total score for $L1$: $S_{L1} = -18.537 - 2.045 = -20.582 \\ \\mathrm{kJ \\ mol^{-1}}$.\n\n**Candidate $L2$**\n- Bond $1$: $f=0.60$, $r=0.185 \\ \\mathrm{nm}$, $\\theta=177^\\circ$, $q_H=0.33 \\ e$, $q_A=-0.50 \\ e$.\n  $S_1 = 0.60 \\left[ 34.735 \\frac{(0.33)(-0.50)}{0.185} + 150(0.185 - 0.19)^2 + 0.02(177 - 180)^2 \\right]$\n  $S_1 = 0.60 \\left[ -30.9850 + 150(-0.005)^2 + 0.02(-3)^2 \\right]$\n  $S_1 = 0.60 \\left[ -30.9850 + 0.00375 + 0.18 \\right] = 0.60(-30.80125) \\approx -18.481 \\ \\mathrm{kJ \\ mol^{-1}}$\n- Bond $2$: $f=0.50$, $r=0.240 \\ \\mathrm{nm}$, $\\theta=150^\\circ$, $q_H=0.20 \\ e$, $q_A=-0.40 \\ e$.\n  $S_2 = 0.50 \\left[ 34.735 \\frac{(0.20)(-0.40)}{0.240} + 150(0.240 - 0.19)^2 + 0.02(150 - 180)^2 \\right]$\n  $S_2 = 0.50 \\left[ -11.5783 + 150(0.05)^2 + 0.02(-30)^2 \\right]$\n  $S_2 = 0.50 \\left[ -11.5783 + 0.375 + 18.0 \\right] = 0.50(6.7967) \\approx +3.398 \\ \\mathrm{kJ \\ mol^{-1}}$\n- Total score for $L2$: $S_{L2} = -18.481 + 3.398 = -15.083 \\ \\mathrm{kJ \\ mol^{-1}}$.\n\n**Candidate $L3$**\n- Bond $1$: $f=0.90$, $r=0.205 \\ \\mathrm{nm}$, $\\theta=165^\\circ$, $q_H=0.28 \\ e$, $q_A=-0.48 \\ e$.\n  $S_1 = 0.90 \\left[ 34.735 \\frac{(0.28)(-0.48)}{0.205} + 150(0.205 - 0.19)^2 + 0.02(165 - 180)^2 \\right]$\n  $S_1 = 0.90 \\left[ -22.7592 + 150(0.015)^2 + 0.02(-15)^2 \\right]$\n  $S_1 = 0.90 \\left[ -22.7592 + 0.03375 + 4.5 \\right] = 0.90(-18.22545) \\approx -16.403 \\ \\mathrm{kJ \\ mol^{-1}}$\n- Bond $2$: $f=0.20$, $r=0.180 \\ \\mathrm{nm}$, $\\theta=180^\\circ$, $q_H=0.35 \\ e$, $q_A=-0.55 \\ e$.\n  $S_2 = 0.20 \\left[ 34.735 \\frac{(0.35)(-0.55)}{0.180} + 150(0.180 - 0.19)^2 + 0.02(180 - 180)^2 \\right]$\n  $S_2 = 0.20 \\left[ -37.1618 + 150(-0.01)^2 + 0.02(0)^2 \\right]$\n  $S_2 = 0.20 \\left[ -37.1618 + 0.015 + 0 \\right] = 0.20(-37.1468) \\approx -7.429 \\ \\mathrm{kJ \\ mol^{-1}}$\n- Total score for $L3$: $S_{L3} = -16.403 - 7.429 = -23.832 \\ \\mathrm{kJ \\ mol^{-1}}$.\n\nSummary of total scores:\n$S_{L1} = -20.582 \\ \\mathrm{kJ \\ mol^{-1}}$\n$S_{L2} = -15.083 \\ \\mathrm{kJ \\ mol^{-1}}$\n$S_{L3} = -23.832 \\ \\mathrm{kJ \\ mol^{-1}}$\n\nA more negative score indicates a stronger net hydrogen-bonding contribution. Comparing the total scores, we have the order of favorability: $S_{L3} < S_{L1} < S_{L2}$. Thus, ligand $L3$ has the most favorable score.\n\nNow we evaluate the provided options.\n\nA. $L1$: The calculated score for $L1$ is $S_{L1} = -20.582 \\ \\mathrm{kJ \\ mol^{-1}}$. While this is a favorable score, it is less negative than the score for $L3$ ($-23.832 \\ \\mathrm{kJ \\ mol^{-1}}$). Therefore, $L1$ is not the candidate with the most favorable score. **Incorrect**.\n\nB. $L2$: The calculated score for $L2$ is $S_{L2} = -15.083 \\ \\mathrm{kJ \\ mol^{-1}}$. This is the least negative, and thus least favorable, score of the three candidates. This is largely due to the second bond, which has large geometric penalties and results in a net positive (destabilizing) contribution. **Incorrect**.\n\nC. $L3$: The calculated score for $L3$ is $S_{L3} = -23.832 \\ \\mathrm{kJ \\ mol^{-1}}$. This is the most negative score among the three candidates, indicating the strongest predicted hydrogen-bonding interaction according to the specified model. **Correct**.\n\nD. They are indistinguishable within the given model (a tie): The calculated scores are distinctly different: $-20.582$, $-15.083$, and $-23.832 \\ \\mathrm{kJ \\ mol^{-1}}$. The differences are significant within the context of such models. There is no tie. Therefore, this statement is false. **Incorrect**.\n\nThe analysis unequivocally identifies $L3$ as the candidate with the most favorable hydrogen-bond score.", "answer": "$$\\boxed{C}$$", "id": "2456497"}, {"introduction": "Hydrogen bonds are not static fixtures; in a dynamic environment like liquid water, they are constantly breaking and reforming on a picosecond timescale. To understand phenomena from protein folding to solvent properties, we must model these dynamics. This practice introduces the hydrogen-bond lifetime autocorrelation function, $C(t)$, a key statistical tool used to quantify the persistence of these crucial interactions [@problem_id:2456451]. By implementing a simple kinetic model, you will explore how temperature, $T$, affects the lifetime of a hydrogen bond, bridging the gap between molecular kinetics and the time-dependent data produced in simulations.", "problem": "You are given a simplified two-state model for a single hydrogen bond (H-bond) between a specific donor and acceptor in liquid water, represented as a continuous-time Markov chain (CTMC) with states \"bound\" and \"unbound.\" The indicator variable is defined as $h(t) \\in \\{0,1\\}$, where $h(t) = 1$ if the pair is hydrogen-bonded and $h(t) = 0$ otherwise. The process is assumed stationary at equilibrium. The rate of breaking from \"bound\" to \"unbound\" is $k_{\\mathrm{b}}(T)$ and the rate of forming from \"unbound\" to \"bound\" is $k_{\\mathrm{f}}(T)$, each obeying Arrhenius-type temperature dependence\n$$\nk_{\\mathrm{b}}(T) = A_{\\mathrm{b}}\\exp\\!\\left(-\\frac{E_{\\mathrm{b}}}{R\\,T}\\right), \\quad\nk_{\\mathrm{f}}(T) = A_{\\mathrm{f}}\\exp\\!\\left(-\\frac{E_{\\mathrm{f}}}{R\\,T}\\right),\n$$\nwhere $R$ is the universal gas constant. The hydrogen-bond lifetime autocorrelation function is defined in normalized form as\n$$\nC(t) = \\frac{\\langle h(0)h(t)\\rangle - \\langle h \\rangle^2}{\\langle h^2 \\rangle - \\langle h \\rangle^2},\n$$\nwith the ensemble average taken over the stationary process.\n\nUse the following physically grounded parameters appropriate for liquid water in a classical force-field description:\n- Universal gas constant $R = 8.314462618 \\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- Breaking attempt frequency $A_{\\mathrm{b}} = 2.0 \\times 10^{12} \\ \\mathrm{s^{-1}}$.\n- Formation attempt frequency $A_{\\mathrm{f}} = 1.0 \\times 10^{12} \\ \\mathrm{s^{-1}}$.\n- Breaking activation energy $E_{\\mathrm{b}} = 1.10 \\times 10^{4} \\ \\mathrm{J\\,mol^{-1}}$.\n- Formation activation energy $E_{\\mathrm{f}} = 4.00 \\times 10^{3} \\ \\mathrm{J\\,mol^{-1}}$.\n\nCompute the normalized autocorrelation values $C(t)$ for the temperatures $T = 273 \\ \\mathrm{K}$ and $T = 373 \\ \\mathrm{K}$ at the following times $t$ expressed in picoseconds: $t = [0, 1, 2, 5, 10]$. Your program must treat time internally in seconds; convert the input times from picoseconds to seconds using $1 \\ \\mathrm{ps} = 10^{-12} \\ \\mathrm{s}$. The required outputs are dimensionless values of $C(t)$ for each time and temperature, rounded to six decimal places.\n\nTest suite:\n- Temperature $T = 273 \\ \\mathrm{K}$ with times $t = [0, 1, 2, 5, 10] \\ \\mathrm{ps}$.\n- Temperature $T = 373 \\ \\mathrm{K}$ with times $t = [0, 1, 2, 5, 10] \\ \\mathrm{ps}$.\n\nYour program should produce a single line of output containing the results as a comma-separated nested list of lists corresponding to the test suite, in the order given above. For example, it must print a line in the exact format\n\"[ [C_273(t0),C_273(t1),C_273(t2),C_273(t3),C_273(t4)], [C_373(t0),C_373(t1),C_373(t2),C_373(t3),C_373(t4)] ]\"\nwith each entry rounded to six decimal places and expressed as a decimal number (no units). Do not include any other text. Angles are not involved in this problem. All quantities with physical units must be handled as specified above. The final answers must be dimensionless floats.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It describes a standard two-state kinetic model used in physical chemistry and statistical mechanics, with all necessary parameters and definitions provided. The task is to compute the hydrogen-bond lifetime autocorrelation function. I will proceed with the solution.\n\nThe system is a continuous-time Markov chain with two states, which we label as state $0$ (\"unbound\") and state $1$ (\"bound\"). The indicator variable $h(t)$ is defined as $h(t)=1$ if the system is in state $1$ and $h(t)=0$ if in state $0$. The transition rates are given as $k_{\\mathrm{f}}$ for the transition $0 \\to 1$ and $k_{\\mathrm{b}}$ for the transition $1 \\to 0$. The transition rate matrix $Q$ for this process is:\n$$\nQ = \\begin{pmatrix} -k_{\\mathrm{f}} & k_{\\mathrm{f}} \\\\ k_{\\mathrm{b}} & -k_{\\mathrm{b}} \\end{pmatrix}\n$$\nThe process is assumed to be stationary. The stationary probabilities $\\pi_0 = P(h=0)$ and $\\pi_1 = P(h=1)$ are found by solving the steady-state condition of the master equation, which leads to the detailed balance equation $k_{\\mathrm{f}} \\pi_0 = k_{\\mathrm{b}} \\pi_1$. Coupled with the normalization condition $\\pi_0 + \\pi_1 = 1$, we find the stationary probabilities:\n$$\n\\pi_0 = \\frac{k_{\\mathrm{b}}}{k_{\\mathrm{f}} + k_{\\mathrm{b}}}, \\quad \\pi_1 = \\frac{k_{\\mathrm{f}}}{k_{\\mathrm{f}} + k_{\\mathrm{b}}}\n$$\nThe problem requires the calculation of the normalized autocorrelation function:\n$$\nC(t) = \\frac{\\langle h(0)h(t)\\rangle - \\langle h \\rangle^2}{\\langle h^2 \\rangle - \\langle h \\rangle^2}\n$$\nFirst, we compute the moments of the indicator variable $h$ over the stationary distribution. Since $h$ is a Bernoulli variable taking values $0$ or $1$, its moments are straightforward to compute:\n$$\n\\langle h \\rangle = (0)\\pi_0 + (1)\\pi_1 = \\pi_1\n$$\n$$\n\\langle h^2 \\rangle = (0)^2\\pi_0 + (1)^2\\pi_1 = \\pi_1\n$$\nThe denominator of $C(t)$ is the variance of $h$:\n$$\n\\langle h^2 \\rangle - \\langle h \\rangle^2 = \\pi_1 - \\pi_1^2 = \\pi_1(1-\\pi_1) = \\pi_1\\pi_0\n$$\nNext, we evaluate the time-correlation term $\\langle h(0)h(t)\\rangle$ in the numerator. By definition of the ensemble average:\n$$\n\\langle h(0)h(t)\\rangle = \\sum_{i,j \\in \\{0,1\\}} (i \\cdot j) P\\big(h(0)=i, h(t)=j\\big)\n$$\nThe product $i \\cdot j$ is non-zero only for $i=1$ and $j=1$. Therefore:\n$$\n\\langle h(0)h(t)\\rangle = (1 \\cdot 1) P\\big(h(0)=1, h(t)=1\\big) = P\\big(h(0)=1\\big) P\\big(h(t)=1 | h(0)=1\\big)\n$$\nHere, $P\\big(h(0)=1\\big)$ is the stationary probability $\\pi_1$, and $P\\big(h(t)=1 | h(0)=1\\big)$ is the conditional probability of being in state $1$ at time $t$ given that the system was in state $1$ at time $t=0$. Let us denote this transition probability by $P_{11}(t)$. Thus, $\\langle h(0)h(t)\\rangle = \\pi_1 P_{11}(t)$.\n\nTo find $P_{11}(t)$, we solve the master equation for the probability of being in state $1$, $p_1(\\tau)$, starting from $p_1(0)=1$:\n$$\n\\frac{dp_1(\\tau)}{d\\tau} = k_{\\mathrm{f}} p_0(\\tau) - k_{\\mathrm{b}} p_1(\\tau)\n$$\nUsing $p_0(\\tau) = 1 - p_1(\\tau)$, the equation becomes:\n$$\n\\frac{dp_1(\\tau)}{d\\tau} = k_{\\mathrm{f}}(1 - p_1(\\tau)) - k_{\\mathrm{b}} p_1(\\tau) = k_{\\mathrm{f}} - (k_{\\mathrm{f}} + k_{\\mathrm{b}})p_1(\\tau)\n$$\nThis is a linear first-order ordinary differential equation. The solution with the initial condition $p_1(0) = 1$ is:\n$$\nP_{11}(t) \\equiv p_1(t) = \\frac{k_{\\mathrm{f}}}{k_{\\mathrm{f}}+k_{\\mathrm{b}}} + \\left(1 - \\frac{k_{\\mathrm{f}}}{k_{\\mathrm{f}}+k_{\\mathrm{b}}}\\right) e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t}\n$$\nSubstituting the expressions for $\\pi_0$ and $\\pi_1$:\n$$\nP_{11}(t) = \\pi_1 + \\pi_0 e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t}\n$$\nNow we can express the numerator of $C(t)$:\n$$\n\\langle h(0)h(t)\\rangle - \\langle h \\rangle^2 = \\pi_1 P_{11}(t) - \\pi_1^2 = \\pi_1 \\left( \\pi_1 + \\pi_0 e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t} \\right) - \\pi_1^2 = \\pi_1\\pi_0 e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t}\n$$\nFinally, assembling $C(t)$:\n$$\nC(t) = \\frac{\\pi_1\\pi_0 e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t}}{\\pi_1\\pi_0} = e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t}\n$$\nThis elegant result shows that the normalized autocorrelation function decays exponentially with a rate equal to the sum of the forward and backward reaction rates.\n\nThe computational procedure is as follows:\n1. For a given temperature $T$, calculate the rate constants $k_{\\mathrm{b}}(T)$ and $k_{\\mathrm{f}}(T)$ using the provided Arrhenius equations:\n   $$\n   k_{\\mathrm{b}}(T) = A_{\\mathrm{b}}\\exp\\!\\left(-\\frac{E_{\\mathrm{b}}}{R\\,T}\\right), \\quad\n   k_{\\mathrm{f}}(T) = A_{\\mathrm{f}}\\exp\\!\\left(-\\frac{E_{\\mathrm{f}}}{R\\,T}\\right)\n   $$\n2. Calculate the total relaxation rate $k_{\\mathrm{tot}}(T) = k_{\\mathrm{b}}(T) + k_{\\mathrm{f}}(T)$.\n3. For each specified time $t$ (converted from picoseconds to seconds, $1 \\ \\mathrm{ps} = 10^{-12} \\ \\mathrm{s}$), compute the autocorrelation value $C(t) = \\exp(-k_{\\mathrm{tot}}(T) \\cdot t)$.\n4. Repeat for all specified temperatures and times. The provided constants are:\n- $R = 8.314462618 \\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- $A_{\\mathrm{b}} = 2.0 \\times 10^{12} \\ \\mathrm{s^{-1}}$.\n- $A_{\\mathrm{f}} = 1.0 \\times 10^{12} \\ \\mathrm{s^{-1}}$.\n- $E_{\\mathrm{b}} = 1.10 \\times 10^{4} \\ \\mathrm{J\\,mol^{-1}}$.\n- $E_{\\mathrm{f}} = 4.00 \\times 10^{3} \\ \\mathrm{J\\,mol^{-1}}$.\nThis procedure will be implemented to generate the required numerical results.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the hydrogen bond lifetime autocorrelation function\n    for a two-state model at different temperatures and times.\n    \"\"\"\n\n    # Physical constants and model parameters\n    R = 8.314462618  # Universal gas constant in J mol^-1 K^-1\n    A_b = 2.0e12  # Breaking attempt frequency in s^-1\n    A_f = 1.0e12  # Formation attempt frequency in s^-1\n    E_b = 1.10e4  # Breaking activation energy in J mol^-1\n    E_f = 4.00e3  # Formation activation energy in J mol^-1\n    \n    # Conversion factor from picoseconds to seconds\n    PS_TO_S = 1e-12\n\n    # Test suite definition\n    test_cases = [\n        {'T': 273.0, 'times_ps': [0.0, 1.0, 2.0, 5.0, 10.0]},\n        {'T': 373.0, 'times_ps': [0.0, 1.0, 2.0, 5.0, 10.0]}\n    ]\n\n    # This list will hold the lists of results for each temperature\n    all_results = []\n\n    for case in test_cases:\n        T = case['T']\n        times_ps = case['times_ps']\n        \n        # Calculate Arrhenius rates for the given temperature\n        # k(T) = A * exp(-E / (R * T))\n        k_b = A_b * np.exp(-E_b / (R * T))\n        k_f = A_f * np.exp(-E_f / (R * T))\n        \n        # The decay rate of the autocorrelation function is the sum of the rates\n        k_tot = k_b + k_f\n        \n        # This list will hold results for the current temperature\n        temp_results = []\n        for t_ps in times_ps:\n            # Convert time from picoseconds to seconds\n            t_s = t_ps * PS_TO_S\n            \n            # Calculate the normalized autocorrelation function C(t) = exp(-k_tot * t)\n            c_t = np.exp(-k_tot * t_s)\n            \n            # Append the result to the list for the current temperature\n            temp_results.append(c_t)\n            \n        all_results.append(temp_results)\n\n    # Format the output string precisely as required: a nested list of lists\n    # represented as a string, with values rounded to six decimal places,\n    # and no spaces around commas.\n    # e.g., \"[[val1,val2,...],[val3,val4,...]]\"\n    \n    # outer_parts will hold the string representations of the inner lists\n    outer_parts = []\n    for inner_list in all_results:\n        # inner_parts will hold the formatted string representation of each number\n        inner_parts = [f\"{val:.6f}\" for val in inner_list]\n        \n        # Join the numbers with commas and enclose in brackets\n        # e.g., \"[1.000000,0.829100,...]\"\n        outer_parts.append(f\"[{','.join(inner_parts)}]\")\n\n    # Join the string representations of inner lists with a comma\n    # and enclose in brackets for the final nested list string.\n    # e.g., \"[[...],[...]]\"\n    final_output_string = f\"[{','.join(outer_parts)}]\"\n    \n    print(final_output_string)\n\nsolve()\n\n```", "id": "2456451"}]}