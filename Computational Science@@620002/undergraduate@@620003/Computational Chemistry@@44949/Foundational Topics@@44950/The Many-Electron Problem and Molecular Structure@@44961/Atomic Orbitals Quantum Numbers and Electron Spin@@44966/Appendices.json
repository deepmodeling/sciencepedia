{"hands_on_practices": [{"introduction": "The Pauli exclusion principle is not just a rule for filling orbital diagrams; it has profound consequences for the spatial distribution of electrons. This practice explores this by calculating the pair correlation function, a tool that measures how the position of one electron affects the probability of finding another nearby. By comparing the pair correlation for singlet (opposite spins) and triplet (parallel spins) states, you will directly visualize the \"Fermi hole\"—a region of reduced probability density around an electron for other electrons of the same spin [@problem_id:2449707]. This exercise provides a concrete, quantitative understanding of how electron spin dictates spatial arrangement and is fundamental to an accurate description of chemical bonding and electronic structure.", "problem": "Construct a program that, in atomic units, evaluates the pair correlation function for a two-electron system built from two distinct hydrogen-like orbitals. Consider a fixed nucleus with nuclear charge $Z$ and two real, normalized, spherically symmetric hydrogenic spatial orbitals: the $1s$ orbital $\\phi_{1s}(r)$ and the $2s$ orbital $\\phi_{2s}(r)$, where $r$ is the electron–nucleus distance expressed in Bohr. Use the following explicit definitions for the orbitals, with all quantities in atomic units:\n$$\n\\phi_{1s}(r) = \\frac{Z^{3/2}}{\\sqrt{\\pi}} e^{-Z r}, \\quad \\phi_{2s}(r) = \\frac{Z^{3/2}}{4\\sqrt{2\\pi}} \\left(2 - Z r\\right) e^{-Z r/2}.\n$$\nDefine the normalized two-electron spatial wavefunctions for the singlet and triplet spin states using the spatial orbitals $\\phi_{a} \\equiv \\phi_{1s}$ and $\\phi_{b} \\equiv \\phi_{2s}$:\n$$\n\\Psi_{\\mathrm{S}}(\\mathbf{r}_1,\\mathbf{r}_2) = \\frac{1}{\\sqrt{2}} \\left[\\phi_{a}(r_1)\\phi_{b}(r_2) + \\phi_{b}(r_1)\\phi_{a}(r_2)\\right],\n$$\n$$\n\\Psi_{\\mathrm{T}}(\\mathbf{r}_1,\\mathbf{r}_2) = \\frac{1}{\\sqrt{2}} \\left[\\phi_{a}(r_1)\\phi_{b}(r_2) - \\phi_{b}(r_1)\\phi_{a}(r_2)\\right],\n$$\nwhere $r_i = \\lvert \\mathbf{r}_i \\rvert$ for $i \\in \\{1,2\\}$. The spin variables are implicitly integrated out, so that the pair density is the squared magnitude of the spatial wavefunction. Define the one-electron density as\n$$\n\\rho(r) = \\lvert \\phi_{a}(r) \\rvert^2 + \\lvert \\phi_{b}(r) \\rvert^2,\n$$\nand the pair densities for the singlet and triplet spatial states as\n$$\nP_2^{\\mathrm{S}}(r_1,r_2) = \\left\\lvert \\Psi_{\\mathrm{S}}(\\mathbf{r}_1,\\mathbf{r}_2) \\right\\rvert^2, \\quad P_2^{\\mathrm{T}}(r_1,r_2) = \\left\\lvert \\Psi_{\\mathrm{T}}(\\mathbf{r}_1,\\mathbf{r}_2) \\right\\rvert^2.\n$$\nThe pair correlation function is defined by\n$$\ng^{X}(r_1,r_2) = \\frac{P_2^{X}(r_1,r_2)}{\\rho(r_1)\\,\\rho(r_2)}, \\quad X \\in \\{\\mathrm{S}, \\mathrm{T}\\}.\n$$\nAll distances $r_1$ and $r_2$ must be provided in Bohr, and $Z$ is dimensionless. Your program must compute, for each specified test case, the values $g^{\\mathrm{S}}(r_1,r_2)$, $g^{\\mathrm{T}}(r_1,r_2)$, and the difference $g^{\\mathrm{S}}(r_1,r_2) - g^{\\mathrm{T}}(r_1,r_2)$, each rounded to six decimal places.\n\nUse the following test suite of parameter triples $(Z, r_1, r_2)$, where $Z$ is the nuclear charge and $r_1, r_2$ are electron–nucleus distances in Bohr:\n- $(1, 0.5, 1.0)$,\n- $(1, 0.0, 0.0)$,\n- $(1, 2.0, 2.0)$,\n- $(2, 0.25, 1.0)$,\n- $(2, 5.0, 5.0)$.\n\nFinal Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of three floats in the order $\\left[g^{\\mathrm{S}}(r_1,r_2), g^{\\mathrm{T}}(r_1,r_2), g^{\\mathrm{S}}(r_1,r_2) - g^{\\mathrm{T}}(r_1,r_2)\\right]$. For example, the overall structure should look like\n$$\n\\left[\\left[x_{11},x_{12},x_{13}\\right],\\left[x_{21},x_{22},x_{23}\\right],\\ldots\\right],\n$$\nwith each $x_{ij}$ a float rounded to six decimal places and no spaces anywhere in the line.", "solution": "The problem statement has been subjected to rigorous validation and is found to be valid. It is scientifically grounded in the principles of quantum mechanics, is well-posed with all necessary information provided, and is expressed in objective, unambiguous language. The definitions for the hydrogen-like orbitals, two-electron wavefunctions, and derived densities are standard in the field of quantum chemistry. Therefore, I will proceed with a complete solution.\n\nThe objective is to compute the pair correlation function, $g^X(r_1, r_2)$, for a two-electron system in both singlet ($X = \\mathrm{S}$) and triplet ($X = \\mathrm{T}$) spin configurations. The system is described by two distinct, real, normalized, and orthogonal hydrogen-like spatial orbitals, $\\phi_{1s}$ and $\\phi_{2s}$. All quantities are expressed in atomic units.\n\nLet us denote the orbitals as $\\phi_a(r) \\equiv \\phi_{1s}(r)$ and $\\phi_b(r) \\equiv \\phi_{2s}(r)$. The explicit forms are given as:\n$$\n\\phi_a(r) = \\phi_{1s}(r) = \\frac{Z^{3/2}}{\\sqrt{\\pi}} e^{-Z r}\n$$\n$$\n\\phi_b(r) = \\phi_{2s}(r) = \\frac{Z^{3/2}}{4\\sqrt{2\\pi}} \\left(2 - Z r\\right) e^{-Z r/2}\n$$\nwhere $Z$ is the nuclear charge and $r$ is the electron-nucleus distance in Bohr.\n\nThe one-electron density, $\\rho(r)$, for this system is defined as the sum of the probability densities of the individual orbitals. For a single electron at a distance $r$ from the nucleus, the probability density is:\n$$\n\\rho(r) = \\lvert \\phi_a(r) \\rvert^2 + \\lvert \\phi_b(r) \\rvert^2\n$$\nSince the orbitals are real, this simplifies to:\n$$\n\\rho(r) = \\phi_a(r)^2 + \\phi_b(r)^2 = \\frac{Z^3}{\\pi} e^{-2Zr} + \\frac{Z^3}{32\\pi} (2 - Zr)^2 e^{-Zr}\n$$\n\nNext, we consider the two-electron spatial wavefunctions, $\\Psi_{\\mathrm{S}}$ for the singlet state and $\\Psi_{\\mathrm{T}}$ for the triplet state, constructed from $\\phi_a$ and $\\phi_b$:\n$$\n\\Psi_{\\mathrm{S}}(\\mathbf{r}_1,\\mathbf{r}_2) = \\frac{1}{\\sqrt{2}} \\left[\\phi_{a}(r_1)\\phi_{b}(r_2) + \\phi_{b}(r_1)\\phi_{a}(r_2)\\right]\n$$\n$$\n\\Psi_{\\mathrm{T}}(\\mathbf{r}_1,\\mathbf{r}_2) = \\frac{1}{\\sqrt{2}} \\left[\\phi_{a}(r_1)\\phi_{b}(r_2) - \\phi_{b}(r_1)\\phi_{a}(r_2)\\right]\n$$\nThe corresponding pair densities, $P_2^X(r_1, r_2)$, are the squared magnitudes of these wavefunctions. Given the orbitals are real:\n$$\nP_2^{\\mathrm{S}}(r_1,r_2) = \\lvert \\Psi_{\\mathrm{S}} \\rvert^2 = \\frac{1}{2} \\left[\\phi_a(r_1)\\phi_b(r_2) + \\phi_b(r_1)\\phi_a(r_2)\\right]^2\n$$\n$$\nP_2^{\\mathrm{T}}(r_1,r_2) = \\lvert \\Psi_{\\mathrm{T}} \\rvert^2 = \\frac{1}{2} \\left[\\phi_a(r_1)\\phi_b(r_2) - \\phi_b(r_1)\\phi_a(r_2)\\right]^2\n$$\nThe pair correlation function, $g^X(r_1, r_2)$, normalizes the pair density by the product of the one-electron densities at the respective positions. This function measures the relative probability of finding one electron at $\\mathbf{r}_1$ and another at $\\mathbf{r}_2$, compared to what would be expected if the electrons were uncorrelated.\n$$\ng^{X}(r_1,r_2) = \\frac{P_2^{X}(r_1,r_2)}{\\rho(r_1)\\,\\rho(r_2)}\n$$\n\nA noteworthy special case occurs when $r_1 = r_2 = r$. The triplet pair density becomes:\n$$\nP_2^{\\mathrm{T}}(r,r) = \\frac{1}{2} \\left[\\phi_a(r)\\phi_b(r) - \\phi_b(r)\\phi_a(r)\\right]^2 = 0\n$$\nConsequently, $g^{\\mathrm{T}}(r, r) = 0$. This illustrates the Pauli exclusion principle, manifesting as a \"Fermi hole\": two electrons with the same spin (a component of a triplet state) have zero probability of being found at the same location. The singlet state does not have this restriction.\n\nThe algorithm to compute the required values for each test case $(Z, r_1, r_2)$ is as follows:\n1.  For a given set of parameters ($Z$, $r_1$, $r_2$), first compute the values of the two orbitals at distances $r_1$ and $r_2$: $\\phi_a(r_1)$, $\\phi_b(r_1)$, $\\phi_a(r_2)$, and $\\phi_b(r_2)$. These are simple function evaluations.\n2.  Calculate the one-electron densities $\\rho(r_1)$ and $\\rho(r_2)$ using the formula $\\rho(r) = \\phi_a(r)^2 + \\phi_b(r)^2$. The denominator for the pair correlation function is the product $\\rho(r_1)\\rho(r_2)$. This denominator is strictly positive for any finite $r \\ge 0$, as $\\phi_a(r)$ is never zero for finite $r$.\n3.  Compute the pair densities $P_2^{\\mathrm{S}}(r_1, r_2)$ and $P_2^{\\mathrm{T}}(r_1, r_2)$ using their definitions.\n4.  Calculate the pair correlation functions $g^{\\mathrm{S}}(r_1, r_2)$ and $g^{\\mathrm{T}}(r_1, r_2)$ by dividing the pair densities by the denominator from step $2$.\n5.  Compute the difference $g^{\\mathrm{S}}(r_1, r_2) - g^{\\mathrm{T}}(r_1, r_2)$.\n6.  Round the three resulting values ($g^{\\mathrm{S}}$, $g^{\\mathrm{T}}$, and their difference) to six decimal places.\n7.  Repeat this procedure for all test cases provided in the problem statement. The results will be collected and formatted into a single string as specified.\n\nThe implementation will utilize the `numpy` library for mathematical constants (e.g., $\\pi$) and elementary functions (e.g., `sqrt`, `exp`).", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the pair correlation function for a two-electron system\n    for specified singlet and triplet states.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Z, r1, r2)\n        (1, 0.5, 1.0),\n        (1, 0.0, 0.0),\n        (1, 2.0, 2.0),\n        (2, 0.25, 1.0),\n        (2, 5.0, 5.0),\n    ]\n\n    all_results = []\n\n    for Z, r1, r2 in test_cases:\n        # Define the hydrogen-like orbitals phi_1s (phi_a) and phi_2s (phi_b).\n        # These functions are defined inside the loop to capture Z,\n        # though they could be defined outside taking Z as an argument.\n        def phi_a(r, Z_charge):\n            \"\"\"1s orbital\"\"\"\n            # \\phi_{1s}(r) = (Z^{3/2} / \\sqrt{\\pi}) * e^{-Z r}\n            return (Z_charge**(1.5) / np.sqrt(np.pi)) * np.exp(-Z_charge * r)\n\n        def phi_b(r, Z_charge):\n            \"\"\"2s orbital\"\"\"\n            # \\phi_{2s}(r) = (Z^{3/2} / (4\\sqrt{2\\pi})) * (2 - Z r) * e^{-Z r/2}\n            return (Z_charge**(1.5) / (4.0 * np.sqrt(2.0 * np.pi))) * \\\n                   (2.0 - Z_charge * r) * np.exp(-Z_charge * r / 2.0)\n\n        # Step 1: Calculate orbital values at r1 and r2\n        a1 = phi_a(r1, Z)\n        b1 = phi_b(r1, Z)\n        a2 = phi_a(r2, Z)\n        b2 = phi_b(r2, Z)\n\n        # Step 2: Calculate one-electron densities\n        rho1 = a1**2 + b1**2\n        rho2 = a2**2 + b2**2\n        \n        # Denominator for g(r1, r2)\n        denominator = rho1 * rho2\n\n        # Step 3: Compute pair densities\n        # P_2^S = 0.5 * (a1*b2 + b1*a2)^2\n        # P_2^T = 0.5 * (a1*b2 - b1*a2)^2\n        cross_term_ab = a1 * b2\n        cross_term_ba = b1 * a2\n        \n        P2_S = 0.5 * (cross_term_ab + cross_term_ba)**2\n        P2_T = 0.5 * (cross_term_ab - cross_term_ba)**2\n\n        # Step 4: Calculate pair correlation functions\n        # Handle the case where the denominator might be zero, although\n        # for finite r, rho(r) > 0.\n        if denominator == 0:\n            # This situation implies r1 or r2 is at a location where both\n            # orbitals are zero, or at infinity. Not expected for this problem.\n            # If P2 is also zero, the result could be a limit. For this problem,\n            # this would yield 0 if P2 is 0.\n            g_S = 0.0 if P2_S == 0 else np.nan\n            g_T = 0.0 if P2_T == 0 else np.nan\n        else:\n            g_S = P2_S / denominator\n            g_T = P2_T / denominator\n\n        # Step 5: Compute the difference\n        g_diff = g_S - g_T\n        \n        # Step 6: Store the rounded results for the current case\n        all_results.append([g_S, g_T, g_diff])\n\n    # Final formatting: create the output string as per problem specification.\n    # The format is [[x11,x12,x13],[x21,x22,x23],...] with no spaces and\n    # six decimal places for each float.\n    \n    sublist_strings = []\n    for case_result in all_results:\n        # Format numbers to .6f, join with comma, add brackets\n        formatted_numbers = [f\"{n:.6f}\" for n in case_result]\n        sublist_str = f\"[{','.join(formatted_numbers)}]\"\n        sublist_strings.append(sublist_str)\n    \n    # Join sublists with comma, add outer brackets\n    output_str = f\"[{','.join(sublist_strings)}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2449707"}, {"introduction": "Running a quantum chemistry calculation is more than just pressing a button; it requires a correct understanding of the physical system to set up the calculation properly. This exercise presents a realistic scenario where a computational result for the Beryllium atom contradicts well-established physical principles. Your task is to act as a computational detective, analyzing the erroneous output to diagnose the likely mistake in the calculation's setup [@problem_id:2449721]. This practice hones critical skills in interpreting computational data, understanding the assumptions behind different methods like Restricted versus Unrestricted Hartree-Fock, and connecting theoretical concepts of spin multiplicity to practical computational work.", "problem": "An anonymized single-determinant Self-Consistent Field (SCF) calculation on an isolated beryllium atom reports the following for the lowest-energy state: total electrons $4$, nuclear charge $Z=4$, an occupation pattern consistent with $1s^2\\,2s^1\\,2p^1$ with parallel spins on the valence electrons, spin expectation value $\\langle \\hat{S}^2 \\rangle \\approx 2.00$, spin multiplicity $2S+1=3$, and spin populations $N_\\alpha=3$, $N_\\beta=1$. From basic atomic structure, the true ground state of beryllium is the closed-shell configuration $1s^2\\,2s^2$ with total spin $S=0$ and multiplicity $2S+1=1$. Which choice best diagnoses the likely setup error that produced the incorrect ground-state multiplicity in this calculation?\n\nA. The run was performed with an unrestricted open-shell method (such as Unrestricted Hartree-Fock (UHF) or Unrestricted Kohn-Sham (UKS)) and the multiplicity was mistakenly set to the triplet, enforcing $N_\\alpha-N_\\beta=2$ and converging to an open-shell high-spin solution rather than a restricted closed-shell singlet.\n\nB. The run used a restricted closed-shell method (Restricted Hartree-Fock (RHF)), but the small Gaussian basis set changed the atom’s true spin multiplicity from singlet to triplet.\n\nC. The run employed Restricted Open-Shell Hartree-Fock (ROHF) with singlet multiplicity; ROHF commonly reports $\\langle \\hat{S}^2 \\rangle \\approx 2$ for closed-shell atoms due to spin contamination.\n\nD. The apparent triplet character arises because relativistic spin–orbit coupling was neglected; including it would restore the singlet multiplicity for beryllium.", "solution": "The validity of the problem statement is established through the following mandatory steps.\n\n**Step 1: Extract Givens**\n- System: An isolated beryllium atom.\n- Calculation type: Single-determinant Self-Consistent Field (SCF).\n- Total electrons: $4$.\n- Nuclear charge: $Z=4$.\n- Reported occupation pattern: $1s^2\\,2s^1\\,2p^1$.\n- Valence electron spins: Parallel.\n- Reported spin expectation value: $\\langle \\hat{S}^2 \\rangle \\approx 2.00$.\n- Reported spin multiplicity: $2S+1=3$.\n- Reported spin populations: $N_\\alpha=3$, $N_\\beta=1$.\n- Known true ground state configuration of beryllium: $1s^2\\,2s^2$.\n- Known true ground state total spin: $S=0$.\n- Known true ground state multiplicity: $2S+1=1$.\n- The task is to identify the most likely setup error that produced the incorrect multiplicity.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically sound and well-posed. It describes a common and realistic scenario in computational chemistry where a calculation converges to an incorrect electronic state due to a user input error. The provided data are internally consistent and accurately describe a triplet excited state of the beryllium atom. The number of electrons ($N_\\alpha + N_\\beta = 3+1=4$) matches the nuclear charge ($Z=4$) for a neutral atom. The total spin projection, $S_z = (N_\\alpha - N_\\beta)/2 = (3-1)/2 = 1$, corresponds to a total spin quantum number of at least $S=1$. For a pure spin state with $S=1$ (a triplet), the multiplicity is $2S+1=3$ and the expectation value of the spin-squared operator is $\\langle \\hat{S}^2 \\rangle = S(S+1) = 1(1+1) = 2$. The reported values ($2S+1=3$ and $\\langle \\hat{S}^2 \\rangle \\approx 2.00$) are fully consistent with the calculation having converged to a triplet state. The discrepancy between this calculated result and the known physical ground state ($1s^2\\,2s^2$, a singlet with $S=0$) constitutes the core of the problem, which asks for a diagnosis of the procedural error. The problem is objective, free of ambiguity, and directly pertains to the specified topic.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be derived.\n\n**Derivation and Option Analysis**\n\nThe problem requires diagnosing an error in a quantum chemistry calculation. The calculation on the beryllium atom ($Z=4$, $4$ electrons) yielded a triplet state (multiplicity $3$) corresponding to the $1s^2\\,2s^1\\,2p^1$ electronic configuration, instead of the true ground state, which is a singlet (multiplicity $1$) with configuration $1s^2\\,2s^2$. We must evaluate the provided options to find the most probable cause for this discrepancy.\n\n**A. The run was performed with an unrestricted open-shell method (such as Unrestricted Hartree-Fock (UHF) or Unrestricted Kohn-Sham (UKS)) and the multiplicity was mistakenly set to the triplet, enforcing $N_\\alpha-N_\\beta=2$ and converging to an open-shell high-spin solution rather than a restricted closed-shell singlet.**\n\nThis option proposes a specific user error: setting the multiplicity to $3$ in the input for an unrestricted calculation. Unrestricted methods, such as UHF or UKS, treat spin-up ($\\alpha$) and spin-down ($\\beta$) electrons in different sets of spatial orbitals. This allows them to model states where the number of $\\alpha$ electrons ($N_\\alpha$) is not equal to the number of $\\beta$ electrons ($N_\\beta$).\n\nIf a user specifies a multiplicity of $3$, this corresponds to a total spin $S=1$. The self-consistent field procedure will then seek the lowest-energy state that satisfies this constraint. For a triplet state, the number of excess spin-up electrons must be $N_\\alpha - N_\\beta = 2S = 2(1) = 2$. Given a total of $4$ electrons, this uniquely determines the spin populations to be $N_\\alpha=3$ and $N_\\beta=1$. This precisely matches the data provided in the problem statement. The lowest-energy electronic configuration for a beryllium atom with this spin arrangement is $1s(\\alpha)1s(\\beta)2s(\\alpha)2p(\\alpha)$, which is a shorthand for the $1s^2\\,2s^1\\,2p^1$ configuration with parallel spins in the valence shell. Furthermore, UHF/UKS wavefunctions are not necessarily pure spin eigenfunctions, leading to \"spin contamination.\" This means $\\langle \\hat{S}^2 \\rangle$ may not be exactly $S(S+1)$. The reported value of $\\langle \\hat{S}^2 \\rangle \\approx 2.00$ is perfectly characteristic of a UHF/UKS calculation on a triplet state that is nearly a pure spin state. This option provides a complete, consistent, and highly plausible explanation for all the reported results, and describes a very common mistake.\n\nVerdict: **Correct**.\n\n**B. The run used a restricted closed-shell method (Restricted Hartree-Fock (RHF)), but the small Gaussian basis set changed the atom’s true spin multiplicity from singlet to triplet.**\n\nThis option is fundamentally incorrect. The Restricted Hartree-Fock (RHF) method, by its very construction, forces every spatial orbital to be occupied by two electrons with opposite spins ($\\alpha$ and $\\beta$). This formalism inherently restricts the wavefunction to be a closed-shell singlet, meaning $N_\\alpha = N_\\beta$ and $S=0$. It is mathematically impossible for an RHF calculation to produce a state with $N_\\alpha=3$ and $N_\\beta=1$. The choice of basis set, whether small or large, affects the numerical accuracy of the orbital energies and total energy but cannot alter the fundamental spin constraint built into the RHF method. A basis set cannot \"change\" the spin multiplicity of the state being calculated.\n\nVerdict: **Incorrect**.\n\n**C. The run employed Restricted Open-Shell Hartree-Fock (ROHF) with singlet multiplicity; ROHF commonly reports $\\langle \\hat{S}^2 \\rangle \\approx 2$ for closed-shell atoms due to spin contamination.**\n\nThis option contains multiple factual errors. First, if the calculation was initiated \"with singlet multiplicity,\" it would have targeted a state with $S=0$, not the reported triplet state with $S=1$. Second, a key advantage of the Restricted Open-Shell Hartree-Fock (ROHF) method is that it produces wavefunctions that are exact eigenfunctions of the $\\hat{S}^2$ operator. Therefore, ROHF wavefunctions are free from spin contamination. An ROHF calculation on a triplet state ($S=1$) would yield an expectation value of *exactly* $\\langle \\hat{S}^2 \\rangle = 1(1+1) = 2.0$, and for a singlet state ($S=0$), it would be *exactly* $\\langle \\hat{S}^2 \\rangle = 0(0+1) = 0.0$. The statement that \"ROHF commonly reports $\\langle \\hat{S}^2 \\rangle \\approx 2$ for closed-shell atoms\" is false; it would report $\\langle \\hat{S}^2 \\rangle = 0.0$. The method that suffers from spin contamination and reports approximate $\\langle \\hat{S}^2 \\rangle$ values is UHF, as described in option A.\n\nVerdict: **Incorrect**.\n\n**D. The apparent triplet character arises because relativistic spin–orbit coupling was neglected; including it would restore the singlet multiplicity for beryllium.**\n\nThis option misattributes the effect to a physical phenomenon that is very small for this atom. Spin–orbit coupling is a relativistic effect that becomes significant for heavy elements. For a light element like beryllium ($Z=4$), its effect on the total energy is minuscule, typically on the order of micro-electron-volts ($\\mu$eV) to milli-electron-volts (meV). The energy difference between the $1s^2\\,2s^2$ ($^1S$) ground state and the $1s^2\\,2s^1\\,2p^1$ ($^3P$) excited state is substantial, approximately $2.7$ eV. A standard SCF calculation finds an electronic state by minimizing the energy according to the non-relativistic electronic Schrödinger equation. It is inconceivable that neglecting a tiny perturbation like spin-orbit coupling would cause the calculation to erroneously converge to an excited state that is several electron-volts higher in energy. The error is procedural, not a failure to include minor physical effects.\n\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2449721"}, {"introduction": "At the heart of most advanced electronic structure methods lies a set of principles known as the Slater-Condon rules. These rules provide a systematic way to calculate the energy of a many-electron system and the interactions between different electronic configurations, which are represented by Slater determinants. Instead of just using these rules, this hands-on practice guides you through implementing them from scratch for the Lithium atom [@problem_id:2449768]. By translating the abstract rules into a working program, you will gain a deep, operational understanding of how the Hamiltonian operator acts on fermionic wavefunctions, demystifying the calculation of one- and two-electron integrals which are the building blocks of computational chemistry.", "problem": "Consider the nonrelativistic, clamped-nuclei (Born–Oppenheimer) electronic Hamiltonian for a Lithium atom modeled in an orthonormal minimal basis of spatial atomic orbitals and associated spin functions. The Hamiltonian is the sum of a one-electron operator and a two-electron Coulomb operator acting on Slater determinants built from spin-orbitals. The program you will write must compute specific Hamiltonian matrix elements between Slater determinants using the Slater–Condon rules, starting from the fundamental operator definitions and the antisymmetry of fermionic wavefunctions.\n\nYou are given an orthonormal basis of three spatial orbitals labeled by their principal and angular momentum quantum numbers: $1s$, $2s$, and $2p$ (for definiteness, use the $m=0$ component for $2p$), each paired with two spin functions $\\alpha$ and $\\beta$. This yields six spin-orbitals indexed as follows:\n- Index $0$: $(1s,\\alpha)$,\n- Index $1$: $(1s,\\beta)$,\n- Index $2$: $(2s,\\alpha)$,\n- Index $3$: $(2s,\\beta)$,\n- Index $4$: $(2p,\\alpha)$,\n- Index $5$: $(2p,\\beta)$.\n\nLet a Slater determinant be specified by a strictly increasing list of three distinct spin-orbital indices (since the Lithium atom has three electrons). The one-electron spatial integrals $h_{pq}$ (in Hartree) for $p,q \\in \\{1s,2s,2p\\}$ are given by the symmetric matrix\n$$\n\\mathbf{h} =\n\\begin{pmatrix}\n-7.432 & -0.050 & -0.020 \\\\\n-0.050 & -0.850 & -0.030 \\\\\n-0.020 & -0.030 & -0.600\n\\end{pmatrix},\n$$\nwith the row/column order $(1s,2s,2p)$. The corresponding one-electron spin-orbital integrals are\n$$\nh_{p\\sigma,q\\sigma'} = \\delta_{\\sigma,\\sigma'}\\, h_{pq},\n$$\nwhere $\\delta_{\\sigma,\\sigma'}$ is the Kronecker delta.\n\nThe two-electron spatial Coulomb integrals are given for any $p,q,r,s \\in \\{1s,2s,2p\\}$ by a symmetric, positive form\n$$\ng(p,q,r,s) \\equiv \\frac{1}{1+|p-r|}\\cdot\\frac{1}{1+|q-s|} \\;+\\; \\frac{1}{2}\\,\\frac{1}{1+|p-s|}\\cdot\\frac{1}{1+|q-r|},\n$$\nwhere the spatial orbitals are mapped to integers as $1s \\mapsto 1$, $2s \\mapsto 2$, $2p \\mapsto 3$. This definition ensures the required index symmetries\n$$\ng(p,q,r,s) = g(q,p,s,r) = g(r,s,p,q),\n$$\nand all energies are in Hartree. The corresponding spin-orbital two-electron integrals are\n$$\n(p\\sigma, q\\sigma' \\mid r\\tau, s\\tau') \\;=\\; \\delta_{\\sigma,\\tau}\\,\\delta_{\\sigma',\\tau'}\\; g(p,q,r,s).\n$$\n\nStarting only from the operator-level definitions above and the antisymmetry property of Slater determinants, implement the Slater–Condon rules to evaluate Hamiltonian matrix elements $\\langle D_I \\mid \\hat{H} \\mid D_J \\rangle$ between two three-electron Slater determinants $|D_I\\rangle$ and $|D_J\\rangle$ built from the six spin-orbitals. Assume each determinant is represented in canonical ascending order of spin-orbital indices, and adopt the canonical phase convention so that no additional permutation phase factor appears beyond the inherent antisymmetrization contained in the Slater–Condon expressions. Use the Kronecker delta spin-selection rules stated above.\n\nYour program must implement the general case and then evaluate the following test suite. Each test case is a pair $(D_I, D_J)$ of determinants, each given as a sorted list of three spin-orbital indices:\n- Test 1 (diagonal “reference”): $D_I = D_J = [0,1,2]$.\n- Test 2 (single excitation, spin-conserving): $D_I = [0,1,2]$, $D_J = [0,2,3]$.\n- Test 3 (single excitation, spin-flip): $D_I = [0,1,2]$, $D_J = [0,1,3]$.\n- Test 4 (double excitation, exchange-only survives): $D_I = [0,1,2]$, $D_J = [2,3,4]$.\n- Test 5 (double excitation, Coulomb-only survives): $D_I = [0,1,2]$, $D_J = [2,4,5]$.\n- Test 6 (differ by three orbitals): $D_I = [0,1,2]$, $D_J = [3,4,5]$.\n\nRequirements:\n- All Hamiltonian matrix elements must be computed in Hartree and reported as floating-point numbers.\n- Use radians or degrees only if angles appear; angles do not appear here.\n- For each test case, the result must be a single float (Hamiltonian matrix element in Hartree).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with no spaces (for example, \"[x1,x2,x3,x4,x5,x6]\"). Each float must be rounded to exactly six digits after the decimal point.\n\nYour solution must derive and implement the logic from the provided operator definitions and the fermionic antisymmetry principle. Do not use or assume any formula beyond what follows from these bases. Ensure all numerical values are expressed in Hartree and rounded to six digits after the decimal point in the final output line.", "solution": "We begin from the nonrelativistic electronic Hamiltonian under the Born–Oppenheimer approximation, written as\n$$\n\\hat{H} = \\sum_{i=1}^{N_e} \\hat{h}(i) \\;+\\; \\frac{1}{2} \\sum_{\\substack{i,j=1 \\\\ i\\neq j}}^{N_e} \\frac{1}{r_{ij}},\n$$\nwhere $N_e$ is the electron count, $\\hat{h}(i)$ is the one-electron operator (kinetic energy plus electron–nucleus attraction), and $r_{ij}$ is the interelectronic separation. Slater determinants enforce fermionic antisymmetry by antisymmetrized products of spin-orbitals. For an orthonormal spin-orbital basis and a Hamiltonian composed of one- and two-body operators, the matrix elements between Slater determinants can be expressed in closed analytical forms dictated by antisymmetry and orthonormality (the Slater–Condon rules). These follow directly from expanding $\\langle D_I \\mid \\hat{H} \\mid D_J \\rangle$ into sums of integrals and observing that only terms with appropriate index coincidences survive (by orthonormality) and that relative signs are fixed by the antisymmetry (wedge product) structure.\n\nWe use the following foundational facts:\n- The one-electron spin-orbital integral satisfies $h_{p\\sigma,q\\sigma'} = \\delta_{\\sigma,\\sigma'} h_{pq}$, where $h_{pq}$ are given and $\\delta$ is the Kronecker delta. This results from the separability of spatial and spin parts in the chosen orthonormal basis.\n- The two-electron spin-orbital integral satisfies $(p\\sigma, q\\sigma' \\mid r\\tau, s\\tau') = \\delta_{\\sigma,\\tau}\\,\\delta_{\\sigma',\\tau'}\\, g(p,q,r,s)$, consistent with spin integration yielding Kronecker deltas and a spatial Coulomb kernel encoded here by $g$.\n\nFrom the operator-level structure, a Slater determinant matrix element vanishes unless the determinants are identical or differ by at most two spin-orbitals. This selection arises because a one-body operator can connect determinants that differ by at most one spin-orbital, while the two-body operator can connect determinants that differ by at most two spin-orbitals. Together with orthonormality, this yields:\n- If two determinants are identical, the diagonal element contains one-electron contributions $h_{ii}$ over all occupied spin-orbitals $i$ and electron–electron contributions consisting of Coulomb terms minus exchange terms for each occupied pair. The exchange survives only when the two spins are the same, as enforced by the spin Kronecker deltas.\n- If two determinants differ by a single spin-orbital $i \\to a$, only one-electron couplings and mixed one–two electron terms survive. The electron–electron part involves interactions of the excited spin-orbital with each common occupied spin-orbital $j$ and appears as a Coulomb term minus an exchange term. Spin selection rules suppress terms if the spin labels are incompatible with the Kronecker deltas. Because we work with strictly ordered determinants and a fixed canonical phase convention, no additional permutation phase appears here.\n- If two determinants differ by a double excitation $i,j \\to a,b$, the only surviving two-electron coupling is the antisymmetrized two-electron integral. Again, spin selection rules enforce that Coulomb $(ab\\mid ij)$ and exchange $(ab\\mid ji)$ terms survive only when their spin Kronecker deltas are satisfied.\n- If two determinants differ by more than two spin-orbitals, the matrix element is zero because neither one- nor two-body operators can supply the necessary excitations.\n\nFor a three-electron determinant $|D\\rangle$ with occupied spin-orbitals $O = \\{i,j,k\\}$, the diagonal matrix element is\n$$\n\\langle D \\mid \\hat{H} \\mid D \\rangle \\;=\\; \\sum_{p \\in O} h_{pp} \\;+\\; \\frac{1}{2}\\sum_{p \\in O}\\sum_{q \\in O} \\left[ (p,q\\mid p,q) - (p,q\\mid q,p) \\right],\n$$\nwith the understanding that $(p,q\\mid q,p)$ vanishes unless the spins of $p$ and $q$ match, due to the spin Kronecker deltas.\n\nFor a single excitation $i \\to a$ between determinants with common occupied set $C$, the off-diagonal matrix element is\n$$\n\\langle D_I \\mid \\hat{H} \\mid D_J \\rangle \\;=\\; h_{ai} \\;+\\; \\sum_{j \\in C} \\left[ (a,j\\mid i,j) - (a,j\\mid j,i) \\right],\n$$\nagain restricted by the spin deltas.\n\nFor a double excitation $i,j \\to a,b$, the off-diagonal matrix element is\n$$\n\\langle D_I \\mid \\hat{H} \\mid D_J \\rangle \\;=\\; (a,b\\mid i,j) - (a,b\\mid j,i),\n$$\nwith spin deltas enforcing which terms survive.\n\nAlgorithmic design:\n- Represent each spin-orbital by its spatial index $p \\in \\{1,2,3\\}$ and spin $\\sigma \\in \\{\\alpha,\\beta\\}$, mapped from $\\{0,\\dots,5\\}$ as given.\n- Implement the one-electron integral function $h_{p\\sigma,q\\sigma'} = \\delta_{\\sigma,\\sigma'} h_{pq}$ using the provided matrix $\\mathbf{h}$.\n- Implement the two-electron integral function $(p\\sigma,q\\sigma'\\mid r\\tau,s\\tau') = \\delta_{\\sigma,\\tau}\\delta_{\\sigma',\\tau'} g(p,q,r,s)$, using\n$$\ng(p,q,r,s) = \\frac{1}{1+|p-r|}\\cdot\\frac{1}{1+|q-s|} \\;+\\; \\frac{1}{2}\\,\\frac{1}{1+|p-s|}\\cdot\\frac{1}{1+|q-r|}.\n$$\n- Given two determinants $D_I$ and $D_J$, compute the sets of holes $H = D_I \\setminus D_J$ and particles $P = D_J \\setminus D_I$. Let $m = |H| = |P|$. Then:\n  - If $m \\ge 3$, return $0$.\n  - If $m = 0$, evaluate the diagonal expression above.\n  - If $m = 1$, evaluate the single-excitation expression above with the common occupied set $C$.\n  - If $m = 2$, evaluate the double-excitation expression above.\n- Because determinants are ordered canonically and we adopt a fixed phase convention, no extra sign beyond those encoded by the antisymmetrized integrals appears.\n\nSpin selection and test-case analysis:\n- Test 1: $[0,1,2]$ diagonal. The one-electron sum is $h_{00}+h_{11}+h_{22} = -7.432 + (-7.432) + (-0.850) = -15.714$. The electron–electron sum over pairs contains Coulomb minus exchange, with exchange only for same-spin pairs. The resulting two-electron contribution sums to $3.000000$, hence the total is $-12.714000$ Hartree.\n- Test 2: Single excitation $1\\beta \\to 2\\beta$; both one-electron term $h_{3,1}$ and Coulomb interactions with the common occupied $\\{(1s,\\alpha),(2s,\\alpha)\\}$ survive, while exchange terms vanish by spin selection. This yields a positive off-diagonal coupling in Hartree.\n- Test 3: Single excitation $2\\alpha \\to 2\\beta$ is a spin-flip, and all terms vanish by the spin Kronecker deltas; the matrix element is $0$.\n- Test 4: Double excitation $1\\alpha,1\\beta \\to 2\\beta,2p\\alpha$. By spin selection, the Coulomb term $(ab\\mid ij)$ vanishes while the exchange $(ab\\mid ji)$ survives, producing a negative value (the negative of the nonzero exchange).\n- Test 5: Double excitation $1\\alpha,1\\beta \\to 2p\\alpha,2p\\beta$. By spin selection, only the Coulomb term survives, giving a positive value.\n- Test 6: Determinants differ by three orbitals; the matrix element is $0$ by the operator rank restriction.\n\nImplementation details:\n- Use strictly increasing index lists for determinants.\n- Implement exact arithmetic as floating point and round outputs to six digits after the decimal point.\n- All energies are reported in Hartree.\n- Output format must be a single line with a comma-separated list enclosed in square brackets and no spaces.\n\nThe program computes all six specified cases and prints the results in the requested format and precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Mapping of spin-orbital index to (spatial_label, spin)\n# Spatial labels use integers: 1->1s, 2->2s, 3->2p\n# Spin is represented as +1 for alpha and -1 for beta for convenience\nspin_orbitals = {\n    0: (1, +1),  # (1s, alpha)\n    1: (1, -1),  # (1s, beta)\n    2: (2, +1),  # (2s, alpha)\n    3: (2, -1),  # (2s, beta)\n    4: (3, +1),  # (2p, alpha)\n    5: (3, -1),  # (2p, beta)\n}\n\n# One-electron spatial integrals h_{pq} in Hartree with order (1s,2s,2p)\nh_spatial = np.array([\n    [-7.432, -0.050, -0.020],\n    [-0.050, -0.850, -0.030],\n    [-0.020, -0.030, -0.600],\n], dtype=float)\n\ndef delta_spin(s1: int, s2: int) -> int:\n    \"\"\"Kronecker delta for spin labels (+1 for alpha, -1 for beta).\"\"\"\n    return 1 if s1 == s2 else 0\n\ndef s_decay(p: int, q: int) -> float:\n    \"\"\"s(p,q) = 1/(1+|p-q|) using spatial labels 1,2,3.\"\"\"\n    return 1.0 / (1 + abs(p - q))\n\ndef g_eri(p: int, q: int, r: int, s: int) -> float:\n    \"\"\"\n    Spatial two-electron integral g(p,q,r,s) in Hartree:\n    g = s(p,r)*s(q,s) + 0.5*s(p,s)*s(q,r)\n    \"\"\"\n    return s_decay(p, r) * s_decay(q, s) + 0.5 * s_decay(p, s) * s_decay(q, r)\n\ndef h_so(a: int, b: int) -> float:\n    \"\"\"One-electron spin-orbital integral h_{a,b} with spin selection.\"\"\"\n    pa, sa = spin_orbitals[a]\n    pb, sb = spin_orbitals[b]\n    if sa != sb:\n        return 0.0\n    # Convert spatial labels 1..3 to indices 0..2\n    ia = pa - 1\n    ib = pb - 1\n    return float(h_spatial[ia, ib])\n\ndef eri_so(p: int, q: int, r: int, s: int) -> float:\n    \"\"\"\n    Two-electron spin-orbital integral (p q | r s) with spin selection.\n    p,q,r,s are spin-orbital indices.\n    \"\"\"\n    pp, sp = spin_orbitals[p]\n    qq, sq = spin_orbitals[q]\n    rr, sr = spin_orbitals[r]\n    ss, ssn = spin_orbitals[s]\n    if (sp == sr) and (sq == ssn):\n        return g_eri(pp, qq, rr, ss)\n    return 0.0\n\ndef h_matrix_element(det_I: list, det_J: list) -> float:\n    \"\"\"\n    Compute <D_I | H | D_J> using Slater-Condon rules:\n    - If determinants identical: diagonal element.\n    - If single excitation: one-electron + Coulomb - exchange with common occs.\n    - If double excitation: antisymmetrized two-electron integral.\n    - Else (>= triple excitation): 0.\n    Assumes determinants are sorted ascending and canonical phase convention.\n    \"\"\"\n    set_I = set(det_I)\n    set_J = set(det_J)\n    holes = sorted([i for i in det_I if i not in set_J])\n    parts = sorted([a for a in det_J if a not in set_I])\n    m = len(holes)\n    if m != len(parts):\n        # Should not occur for valid determinants; return 0 defensively.\n        return 0.0\n\n    if m >= 3:\n        return 0.0\n\n    if m == 0:\n        # Diagonal element\n        # One-electron part\n        one_e = sum(h_so(i, i) for i in det_I)\n        # Two-electron part: 0.5 * sum_{i,j in occ} [ (ij|ij) - (ij|ji) ]\n        two_e = 0.0\n        for i in det_I:\n            for j in det_I:\n                two_e += (eri_so(i, j, i, j) - eri_so(i, j, j, i))\n        two_e *= 0.5\n        return one_e + two_e\n\n    if m == 1:\n        # Single excitation i -> a\n        i = holes[0]\n        a = parts[0]\n        common = sorted(set_I.intersection(set_J))\n        val = h_so(a, i)\n        for j in common:\n            val += (eri_so(a, j, i, j) - eri_so(a, j, j, i))\n        return val\n\n    # m == 2\n    # Double excitation i,j -> a,b\n    i, j = holes\n    a, b = parts\n    return eri_so(a, b, i, j) - eri_so(a, b, j, i)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        ([0, 1, 2], [0, 1, 2]),  # Test 1: diagonal\n        ([0, 1, 2], [0, 2, 3]),  # Test 2: single, spin-conserving\n        ([0, 1, 2], [0, 1, 3]),  # Test 3: single, spin-flip\n        ([0, 1, 2], [2, 3, 4]),  # Test 4: double, exchange-only\n        ([0, 1, 2], [2, 4, 5]),  # Test 5: double, Coulomb-only\n        ([0, 1, 2], [3, 4, 5]),  # Test 6: differ by three, zero\n    ]\n\n    results = []\n    for det_I, det_J in test_cases:\n        val = h_matrix_element(det_I, det_J)\n        results.append(f\"{val:.6f}\")\n\n    # Final print statement in the exact required format: no spaces.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2449768"}]}