{"hands_on_practices": [{"introduction": "This first exercise provides a foundational application of the expectation value concept. We will work with a simple but fundamentally important two-level quantum system: the spin of an electron. By calculating the expectation value of the spin operator $\\hat{S}_z$, you will practice applying the core formula $\\langle\\psi|\\hat{A}|\\psi\\rangle$ and see how it predicts the average measurement outcome for a particle in a superposition state [@problem_id:2459734].", "id": "2459734", "problem": "In computational chemistry, spin expectation values of electrons are required to evaluate spin populations and magnetic properties. Consider a single electron, modeled as a spin-$\\frac{1}{2}$ particle, with spin states in the standard $z$-quantization basis $\\{|\\uparrow\\rangle,|\\downarrow\\rangle\\}$. The spin operator $\\hat{S}_{z}$ acts on this basis according to the fundamental quantum mechanical relations $\\hat{S}_{z}|\\uparrow\\rangle=\\frac{\\hbar}{2}|\\uparrow\\rangle$ and $\\hat{S}_{z}|\\downarrow\\rangle=-\\frac{\\hbar}{2}|\\downarrow\\rangle$, and the basis is orthonormal with $\\langle\\uparrow|\\uparrow\\rangle=\\langle\\downarrow|\\downarrow\\rangle=1$ and $\\langle\\uparrow|\\downarrow\\rangle=\\langle\\downarrow|\\uparrow\\rangle=0$. Suppose the electron is prepared in the normalized spin state\n$$|\\alpha\\rangle=\\frac{1}{\\sqrt{3}}|\\uparrow\\rangle+\\sqrt{\\frac{2}{3}}|\\downarrow\\rangle.$$\nCompute the expectation value $\\langle\\hat{S}_{z}\\rangle=\\langle\\alpha|\\hat{S}_{z}|\\alpha\\rangle$. Express your final answer as the dimensionless coefficient $c$ defined by $\\langle\\hat{S}_{z}\\rangle=c\\,\\hbar$. Give an exact value (no rounding).", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **System**: A single electron, treated as a spin-$\\frac{1}{2}$ particle.\n- **Basis**: Standard $z$-quantization basis $\\{|\\uparrow\\rangle,|\\downarrow\\rangle\\}$.\n- **Operator Definition**: The spin operator $\\hat{S}_{z}$ acts on the basis as follows:\n  - $\\hat{S}_{z}|\\uparrow\\rangle=\\frac{\\hbar}{2}|\\uparrow\\rangle$\n  - $\\hat{S}_{z}|\\downarrow\\rangle=-\\frac{\\hbar}{2}|\\downarrow\\rangle$\n- **Orthonormality Conditions**:\n  - $\\langle\\uparrow|\\uparrow\\rangle=1$\n  - $\\langle\\downarrow|\\downarrow\\rangle=1$\n  - $\\langle\\uparrow|\\downarrow\\rangle=0$\n  - $\\langle\\downarrow|\\uparrow\\rangle=0$\n- **State Vector**: The electron is in the normalized spin state $|\\alpha\\rangle=\\frac{1}{\\sqrt{3}}|\\uparrow\\rangle+\\sqrt{\\frac{2}{3}}|\\downarrow\\rangle$.\n- **Objective**: Compute the expectation value $\\langle\\hat{S}_{z}\\rangle=\\langle\\alpha|\\hat{S}_{z}|\\alpha\\rangle$.\n- **Output Format**: Express the result as the dimensionless coefficient $c$ from the relation $\\langle\\hat{S}_{z}\\rangle=c\\,\\hbar$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a fundamental exercise in quantum mechanics. It is well-posed, as all necessary information for the calculation is provided. The state vector's normalization is confirmed: the sum of the squared moduli of the coefficients is $(\\frac{1}{\\sqrt{3}})^{2} + (\\sqrt{\\frac{2}{3}})^{2} = \\frac{1}{3} + \\frac{2}{3} = 1$. The problem is objective and contains no contradictions or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\nThe objective is to compute the expectation value $\\langle\\hat{S}_{z}\\rangle$ for a particle in the state $|\\alpha\\rangle$. The definition of the expectation value of an operator $\\hat{A}$ for a system in a normalized state $|\\psi\\rangle$ is $\\langle\\hat{A}\\rangle = \\langle\\psi|\\hat{A}|\\psi\\rangle$.\n\nFor this problem, the operator is $\\hat{S}_{z}$ and the state is $|\\alpha\\rangle = \\frac{1}{\\sqrt{3}}|\\uparrow\\rangle + \\sqrt{\\frac{2}{3}}|\\downarrow\\rangle$.\nThe corresponding bra vector is $\\langle\\alpha| = \\left(\\frac{1}{\\sqrt{3}}|\\uparrow\\rangle + \\sqrt{\\frac{2}{3}}|\\downarrow\\rangle\\right)^{\\dagger} = \\frac{1}{\\sqrt{3}}\\langle\\uparrow| + \\sqrt{\\frac{2}{3}}\\langle\\downarrow|$, since the coefficients are real.\n\nThe expectation value is thus given by the expression:\n$$ \\langle\\hat{S}_{z}\\rangle = \\langle\\alpha|\\hat{S}_{z}|\\alpha\\rangle = \\left( \\frac{1}{\\sqrt{3}}\\langle\\uparrow| + \\sqrt{\\frac{2}{3}}\\langle\\downarrow| \\right) \\hat{S}_{z} \\left( \\frac{1}{\\sqrt{3}}|\\uparrow\\rangle + \\sqrt{\\frac{2}{3}}|\\downarrow\\rangle \\right) $$\nFirst, we apply the operator $\\hat{S}_{z}$ to the ket $|\\alpha\\rangle$. By the linearity of quantum mechanical operators:\n$$ \\hat{S}_{z}|\\alpha\\rangle = \\hat{S}_{z} \\left( \\frac{1}{\\sqrt{3}}|\\uparrow\\rangle + \\sqrt{\\frac{2}{3}}|\\downarrow\\rangle \\right) = \\frac{1}{\\sqrt{3}}\\hat{S}_{z}|\\uparrow\\rangle + \\sqrt{\\frac{2}{3}}\\hat{S}_{z}|\\downarrow\\rangle $$\nUsing the given action of $\\hat{S}_{z}$ on the basis kets:\n$$ \\hat{S}_{z}|\\uparrow\\rangle = \\frac{\\hbar}{2}|\\uparrow\\rangle $$\n$$ \\hat{S}_{z}|\\downarrow\\rangle = -\\frac{\\hbar}{2}|\\downarrow\\rangle $$\nSubstituting these into the expression for $\\hat{S}_{z}|\\alpha\\rangle$:\n$$ \\hat{S}_{z}|\\alpha\\rangle = \\frac{1}{\\sqrt{3}}\\left(\\frac{\\hbar}{2}|\\uparrow\\rangle\\right) + \\sqrt{\\frac{2}{3}}\\left(-\\frac{\\hbar}{2}|\\downarrow\\rangle\\right) = \\frac{\\hbar}{2\\sqrt{3}}|\\uparrow\\rangle - \\frac{\\hbar}{2}\\sqrt{\\frac{2}{3}}|\\downarrow\\rangle $$\nNow, we compute the inner product of $\\langle\\alpha|$ with the resulting ket $\\hat{S}_{z}|\\alpha\\rangle$:\n$$ \\langle\\hat{S}_{z}\\rangle = \\left( \\frac{1}{\\sqrt{3}}\\langle\\uparrow| + \\sqrt{\\frac{2}{3}}\\langle\\downarrow| \\right) \\left( \\frac{\\hbar}{2\\sqrt{3}}|\\uparrow\\rangle - \\frac{\\hbar}{2}\\sqrt{\\frac{2}{3}}|\\downarrow\\rangle \\right) $$\nExpanding this expression yields four terms:\n$$ \\langle\\hat{S}_{z}\\rangle = \\left(\\frac{1}{\\sqrt{3}}\\right)\\left(\\frac{\\hbar}{2\\sqrt{3}}\\right)\\langle\\uparrow|\\uparrow\\rangle - \\left(\\frac{1}{\\sqrt{3}}\\right)\\left(\\frac{\\hbar}{2}\\sqrt{\\frac{2}{3}}\\right)\\langle\\uparrow|\\downarrow\\rangle + \\left(\\sqrt{\\frac{2}{3}}\\right)\\left(\\frac{\\hbar}{2\\sqrt{3}}\\right)\\langle\\downarrow|\\uparrow\\rangle - \\left(\\sqrt{\\frac{2}{3}}\\right)\\left(\\frac{\\hbar}{2}\\sqrt{\\frac{2}{3}}\\right)\\langle\\downarrow|\\downarrow\\rangle $$\nWe apply the orthonormality conditions $\\langle\\uparrow|\\uparrow\\rangle=1$, $\\langle\\downarrow|\\downarrow\\rangle=1$, and $\\langle\\uparrow|\\downarrow\\rangle=\\langle\\downarrow|\\uparrow\\rangle=0$:\n$$ \\langle\\hat{S}_{z}\\rangle = \\left(\\frac{1}{3}\\right)\\left(\\frac{\\hbar}{2}\\right)(1) - 0 + 0 - \\left(\\frac{2}{3}\\right)\\left(\\frac{\\hbar}{2}\\right)(1) $$\nSimplifying the expression:\n$$ \\langle\\hat{S}_{z}\\rangle = \\frac{\\hbar}{6} - \\frac{2\\hbar}{6} = -\\frac{\\hbar}{6} $$\nThe problem requires the answer in the form $\\langle\\hat{S}_{z}\\rangle = c\\,\\hbar$. By comparing our result with this form, we identify the dimensionless coefficient $c$:\n$$ c\\,\\hbar = -\\frac{1}{6}\\hbar \\implies c = -\\frac{1}{6} $$\nThis is the exact value for the coefficient.", "answer": "$$\\boxed{-\\frac{1}{6}}$$"}, {"introduction": "A quantum state does not necessarily have a definite value for every measurable property. This practice explores the crucial distinction between general states and the special case of eigenstates by examining a particle on a ring model [@problem_id:2459766]. You will first test if the given wavefunction is an eigenstate of the angular momentum operator $\\hat{L}_z$, and then you will calculate the expectation value, which gives the average angular momentum even if individual measurements yield different results.", "id": "2459766", "problem": "In the planar rigid-rotor model used in computational chemistry to approximate delocalized motion on a ring (for example, a simplified description of a single electron constrained to an aromatic ring under the Born–Oppenheimer (BO) approximation), the configuration space is the circle parameterized by the polar angle $\\phi \\in [0, 2\\pi)$ with periodic boundary conditions. Consider the canonical angular momentum operator about the $z$-axis, $\\hat{L}_{z}$, acting on functions of $\\phi$. A candidate normalized state is proposed of the form $\\Psi(\\phi) = A \\cos^{2}(\\phi)$.\n\nUsing only core definitions of operators, observables, and expectation values in quantum mechanics:\n- Determine the normalization constant $A$ consistent with the boundary conditions for a particle on a ring.\n- Assess whether $\\Psi(\\phi)$ is an eigenstate of the angular momentum operator $\\hat{L}_{z}$ in the angle representation, justifying your conclusion by examining the action of the operator on the state.\n- Compute the expectation value $\\langle \\hat{L}_{z} \\rangle$ in this state. Express your final expectation value in units of $\\hbar$. Do not round; provide an exact value.", "solution": "The problem statement is scrutinized and found to be valid. It is scientifically grounded, well-posed, objective, and complete. The problem addresses fundamental concepts of quantum mechanics—normalization, eigenstates, and expectation values—within the standard planar rigid-rotor model, which is a correct and appropriate simplification for the described physical system. All necessary components for a rigorous solution are implicitly or explicitly provided. We proceed with the solution.\n\nThe problem requires a three-part analysis of the state $\\Psi(\\phi) = A \\cos^{2}(\\phi)$ for a particle on a ring.\n\nFirst, we must determine the normalization constant $A$. The normalization condition for a wavefunction defined on the interval $\\phi \\in [0, 2\\pi)$ is given by the integral of its probability density over the entire configuration space, which must equal $1$.\n$$\n\\int_{0}^{2\\pi} \\Psi^{*}(\\phi) \\Psi(\\phi) d\\phi = 1\n$$\nGiven that the proposed state $\\Psi(\\phi) = A \\cos^{2}(\\phi)$ is a real-valued function, the complex conjugate $\\Psi^{*}(\\phi)$ is equal to $\\Psi(\\phi)$. We conventionally choose the normalization constant $A$ to be a positive real number. The condition becomes:\n$$\n\\int_{0}^{2\\pi} \\left(A \\cos^{2}(\\phi)\\right)^{2} d\\phi = A^{2} \\int_{0}^{2\\pi} \\cos^{4}(\\phi) d\\phi = 1\n$$\nTo evaluate the integral, we use trigonometric identities to reduce the power of the cosine function. We start with the power-reduction formula $\\cos^{2}(x) = \\frac{1}{2}(1 + \\cos(2x))$.\n$$\n\\cos^{4}(\\phi) = \\left(\\cos^{2}(\\phi)\\right)^{2} = \\left(\\frac{1 + \\cos(2\\phi)}{2}\\right)^{2} = \\frac{1}{4} \\left(1 + 2\\cos(2\\phi) + \\cos^{2}(2\\phi)\\right)\n$$\nApplying the power-reduction formula again for the $\\cos^{2}(2\\phi)$ term:\n$$\n\\cos^{2}(2\\phi) = \\frac{1 + \\cos(4\\phi)}{2}\n$$\nSubstituting this back, we obtain:\n$$\n\\cos^{4}(\\phi) = \\frac{1}{4} \\left(1 + 2\\cos(2\\phi) + \\frac{1 + \\cos(4\\phi)}{2}\\right) = \\frac{1}{4} \\left(\\frac{3}{2} + 2\\cos(2\\phi) + \\frac{1}{2}\\cos(4\\phi)\\right)\n$$\n$$\n\\cos^{4}(\\phi) = \\frac{3}{8} + \\frac{1}{2}\\cos(2\\phi) + \\frac{1}{8}\\cos(4\\phi)\n$$\nNow we can integrate this expression from $0$ to $2\\pi$:\n$$\n\\int_{0}^{2\\pi} \\cos^{4}(\\phi) d\\phi = \\int_{0}^{2\\pi} \\left(\\frac{3}{8} + \\frac{1}{2}\\cos(2\\phi) + \\frac{1}{8}\\cos(4\\phi)\\right) d\\phi\n$$\nThe integrals of $\\cos(2\\phi)$ and $\\cos(4\\phi)$ over a full period $[0, 2\\pi]$ are zero.\n$$\n\\int_{0}^{2\\pi} \\cos(n\\phi) d\\phi = \\left[\\frac{\\sin(n\\phi)}{n}\\right]_{0}^{2\\pi} = 0 \\quad \\text{for integer } n \\neq 0\n$$\nThus, the integral simplifies to:\n$$\n\\int_{0}^{2\\pi} \\frac{3}{8} d\\phi = \\left[\\frac{3}{8}\\phi\\right]_{0}^{2\\pi} = \\frac{3}{8}(2\\pi) = \\frac{3\\pi}{4}\n$$\nSubstituting this result into the normalization equation:\n$$\nA^{2} \\left(\\frac{3\\pi}{4}\\right) = 1 \\implies A^{2} = \\frac{4}{3\\pi}\n$$\nTaking the positive real root for the normalization constant, we find:\n$$\nA = \\sqrt{\\frac{4}{3\\pi}} = \\frac{2}{\\sqrt{3\\pi}}\n$$\n\nSecond, we assess whether $\\Psi(\\phi)$ is an eigenstate of the angular momentum operator $\\hat{L}_{z}$. In the angle representation, this operator is $\\hat{L}_{z} = -i\\hbar \\frac{\\partial}{\\partial\\phi}$. For $\\Psi(\\phi)$ to be an eigenstate of $\\hat{L}_{z}$, it must satisfy the eigenvalue equation $\\hat{L}_{z}\\Psi(\\phi) = \\lambda\\Psi(\\phi)$, where $\\lambda$ is a constant scalar (the eigenvalue).\nWe apply the operator to the state:\n$$\n\\hat{L}_{z}\\Psi(\\phi) = -i\\hbar \\frac{\\partial}{\\partial\\phi} \\left(A \\cos^{2}(\\phi)\\right)\n$$\nUsing the chain rule for differentiation, $\\frac{d}{d\\phi}\\cos^{2}(\\phi) = 2\\cos(\\phi)(-\\sin(\\phi)) = -2\\sin(\\phi)\\cos(\\phi) = -\\sin(2\\phi)$.\n$$\n\\hat{L}_{z}\\Psi(\\phi) = -i\\hbar A (-\\sin(2\\phi)) = i\\hbar A \\sin(2\\phi)\n$$\nNow we check if the result is a constant multiple of the original function $\\Psi(\\phi) = A \\cos^{2}(\\phi)$. For the eigenvalue equation to hold, we require:\n$$\ni\\hbar A \\sin(2\\phi) = \\lambda \\left(A \\cos^{2}(\\phi)\\right)\n$$\nSolving for $\\lambda$ gives:\n$$\n\\lambda = \\frac{i\\hbar \\sin(2\\phi)}{\\cos^{2}(\\phi)}\n$$\nSince $\\lambda$ is a function of $\\phi$ and is not a constant, the state $\\Psi(\\phi) = A \\cos^{2}(\\phi)$ is **not** an eigenstate of the angular momentum operator $\\hat{L}_{z}$.\n\nThird, we compute the expectation value of $\\hat{L}_{z}$ in this state, denoted $\\langle \\hat{L}_{z} \\rangle$. The expectation value is calculated by the integral:\n$$\n\\langle \\hat{L}_{z} \\rangle = \\int_{0}^{2\\pi} \\Psi^{*}(\\phi) \\hat{L}_{z} \\Psi(\\phi) d\\phi\n$$\nSubstituting the expressions for $\\Psi^{*}(\\phi)$ and $\\hat{L}_{z}\\Psi(\\phi)$:\n$$\n\\langle \\hat{L}_{z} \\rangle = \\int_{0}^{2\\pi} \\left(A \\cos^{2}(\\phi)\\right) \\left(i\\hbar A \\sin(2\\phi)\\right) d\\phi = i\\hbar A^{2} \\int_{0}^{2\\pi} \\cos^{2}(\\phi) \\sin(2\\phi) d\\phi\n$$\nWe focus on the integral part. Using the double-angle identity $\\sin(2\\phi) = 2\\sin(\\phi)\\cos(\\phi)$:\n$$\n\\int_{0}^{2\\pi} \\cos^{2}(\\phi) \\sin(2\\phi) d\\phi = \\int_{0}^{2\\pi} \\cos^{2}(\\phi) (2\\sin(\\phi)\\cos(\\phi)) d\\phi = 2 \\int_{0}^{2\\pi} \\cos^{3}(\\phi) \\sin(\\phi) d\\phi\n$$\nThis integral can be solved by substitution. Let $u = \\cos(\\phi)$, then $du = -\\sin(\\phi)d\\phi$. The limits of integration change from $\\phi=0$ to $u=\\cos(0)=1$ and from $\\phi=2\\pi$ to $u=\\cos(2\\pi)=1$.\n$$\n2 \\int_{u(0)}^{u(2\\pi)} u^{3} (-du) = -2 \\int_{1}^{1} u^{3} du\n$$\nAn integral whose upper and lower bounds are identical is exactly zero.\nAlternatively, evaluating the indefinite integral gives $-\\frac{2u^{4}}{4} = -\\frac{1}{2}\\cos^{4}(\\phi)$. Evaluating this over the definite interval:\n$$\n\\left[-\\frac{1}{2}\\cos^{4}(\\phi)\\right]_{0}^{2\\pi} = \\left(-\\frac{1}{2}\\cos^{4}(2\\pi)\\right) - \\left(-\\frac{1}{2}\\cos^{4}(0)\\right) = \\left(-\\frac{1}{2}(1)^{4}\\right) - \\left(-\\frac{1}{2}(1)^{4}\\right) = -\\frac{1}{2} + \\frac{1}{2} = 0\n$$\nTherefore, the integral is zero. The expectation value is:\n$$\n\\langle \\hat{L}_{z} \\rangle = i\\hbar A^{2} \\cdot 0 = 0\n$$\nThe expectation value of the angular momentum in the state $\\Psi(\\phi)$ is $0$. This result is sensible; the state $\\Psi(\\phi) = A \\cos^{2}(\\phi)$ is a real function which can be expressed as a superposition of eigenstates of $\\hat{L}_z$ with opposite momenta, specifically $e^{i2\\phi}$, $e^{-i2\\phi}$, and a constant term (for $m=0$). The contributions from $+m\\hbar$ and $-m\\hbar$ cancel out, leading to a zero expectation value for the momentum. For instance, $\\cos^2(\\phi) = \\frac{1}{2} + \\frac{1}{4}e^{i2\\phi} + \\frac{1}{4}e^{-i2\\phi}$, which is a superposition of states with $m=0$, $m=2$, and $m=-2$. The expectation value is the weighted average of the eigenvalues, which is $0$.\nThe problem requests the final value in units of $\\hbar$, which is simply $0$.", "answer": "$$\n\\boxed{0}\n$$"}, {"introduction": "Analytical solutions are only possible for the simplest model systems, and in real computational chemistry, wavefunctions are represented numerically on a grid, and operators become matrices. This final practice bridges the gap from theory to computation by having you implement the numerical formula for the expectation value, $\\langle \\hat{O} \\rangle = \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\hat{\\mathbf{O}} \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi}}$ [@problem_id:2459733]. Mastering this procedure is essential, as it lies at the heart of how properties are extracted from quantum simulations in almost all modern software.", "id": "2459733", "problem": "Consider a one-dimensional discretized quantum state represented on a finite grid. Let the complex-valued wavefunction be a column vector $\\boldsymbol{\\psi} \\in \\mathbb{C}^{N}$ defined on $N$ grid points with positive quadrature weights $\\mathbf{w} = (w_1,\\dots,w_N)$ that approximate integration on the grid via a diagonal weight matrix $\\mathbf{W} = \\mathrm{diag}(w_1,\\dots,w_N)$. Let the observable be represented by an $N \\times N$ matrix $\\hat{\\mathbf{O}}$. The expectation value of the observable in the state is defined by\n$$\n\\langle \\hat{O} \\rangle \\;=\\; \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\hat{\\mathbf{O}} \\, \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\boldsymbol{\\psi}},\n$$\nwhere $(\\cdot)^\\dagger$ denotes the conjugate transpose. Assume all quantities are dimensionless.\n\nWrite a program that, for each specified test case below, computes the expectation value $\\langle \\hat{O} \\rangle$ using the definition above. The wavefunction may not be normalized; the definition must be used exactly as stated. Assume $\\hat{\\mathbf{O}}$ is Hermitian with respect to the weighted inner product induced by $\\mathbf{W}$, so $\\langle \\hat{O} \\rangle$ is real.\n\nTest Suite (each case specifies $(\\boldsymbol{\\psi}, \\hat{\\mathbf{O}}, \\mathbf{w})$):\n\n1. Case A (diagonal position-like operator, uniform weights, normalized state):\n   - $N = 4$,\n   - grid values $\\mathbf{x} = (-1, 0, 1, 2)$,\n   - $\\hat{\\mathbf{O}} = \\mathrm{diag}(-1, 0, 1, 2)$,\n   - $\\mathbf{w} = (1, 1, 1, 1)$,\n   - $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} \\, (1, 1, 0, 0)^{\\mathsf{T}}$.\n\n2. Case B (identity operator, non-uniform weights, unnormalized complex state):\n   - $N = 3$,\n   - $\\hat{\\mathbf{O}} = \\mathbf{I}_3$,\n   - $\\mathbf{w} = (0.3, 0.5, 0.2)$,\n   - $\\boldsymbol{\\psi} = (1 + i, \\, 2 - i, \\, -\\tfrac{1}{2} i)^{\\mathsf{T}}$.\n\n3. Case C (diagonal position-like operator with trapezoidal weights, constant state):\n   - $N = 3$,\n   - grid values $\\mathbf{x} = (0, 0.5, 1.0)$,\n   - $\\hat{\\mathbf{O}} = \\mathrm{diag}(0, 0.5, 1.0)$,\n   - trapezoidal weights $\\mathbf{w} = (0.25, 0.5, 0.25)$,\n   - $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$.\n\n4. Case D (off-diagonal Hermitian operator, complex normalized state):\n   - $N = 2$,\n   - $\\hat{\\mathbf{O}} = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$,\n   - $\\mathbf{w} = (1, 1)$,\n   - $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} \\, (1, i)^{\\mathsf{T}}$.\n\n5. Case E (discrete momentum-like operator with periodic central difference, uniform weights, constant state):\n   - $N = 3$,\n   - grid spacing $\\Delta x = 1$,\n   - define the discrete momentum operator\n     $$\n     \\hat{\\mathbf{P}} \\;=\\; -\\frac{i}{2 \\Delta x}\n     \\begin{pmatrix}\n     0 & 1 & -1 \\\\\n     -1 & 0 & 1 \\\\\n     1 & -1 & 0\n     \\end{pmatrix},\n     $$\n     which corresponds to the periodic central-difference representation of $-\\mathrm{i}\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}$,\n   - $\\hat{\\mathbf{O}} = \\hat{\\mathbf{P}}$,\n   - $\\mathbf{w} = (1, 1, 1)$,\n   - $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$.\n\nYour program must compute the expectation value for each case and produce a single line of output containing the five results as a comma-separated list enclosed in square brackets, with each value rounded to $10$ decimal places (for example, $[a,b,c,d,e]$ where $a$ through $e$ are floats formatted to $10$ decimal places). Treat all quantities as dimensionless. No user input is required; the program must embed the test suite internally.", "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and objective. It presents a clear computational task based on fundamental principles of numerical quantum mechanics. The objective is to compute the expectation value of an observable $\\hat{\\mathbf{O}}$ for a given quantum state $\\boldsymbol{\\psi}$ on a discretized one-dimensional grid with quadrature weights $\\mathbf{w}$.\n\nThe expectation value $\\langle \\hat{O} \\rangle$ is defined by the generalized Rayleigh quotient:\n$$\n\\langle \\hat{O} \\rangle \\;=\\; \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\hat{\\mathbf{O}} \\, \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\boldsymbol{\\psi}}\n$$\nHere, $\\boldsymbol{\\psi}$ is the complex-valued state vector of size $N$, $\\hat{\\mathbf{O}}$ is the $N \\times N$ matrix representing the observable, $\\mathbf{W} = \\mathrm{diag}(w_1, \\dots, w_N)$ is the diagonal matrix of positive quadrature weights, and $(\\cdot)^\\dagger$ denotes the conjugate transpose. The denominator provides the correct normalization for the state with respect to the weighted inner product defined by $\\mathbf{W}$. The problem asserts that $\\hat{\\mathbf{O}}$ is Hermitian with respect to this weighted inner product, which guarantees that the expectation value $\\langle \\hat{O} \\rangle$ is a real number.\n\nThe computational procedure involves direct application of this formula for each of the five provided test cases. For each case, we construct the vectors $\\boldsymbol{\\psi}$ and $\\mathbf{w}$, and the matrix $\\hat{\\mathbf{O}}$. Then, we compute the numerator and denominator using matrix-vector and vector-dot products and find their ratio.\n\nThe calculation for each case is as follows:\n\n**Case A:**\n- $N = 4$\n- $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} (1, 1, 0, 0)^{\\mathsf{T}}$\n- $\\mathbf{w} = (1, 1, 1, 1)$, so $\\mathbf{W} = \\mathbf{I}_4$ (the $4 \\times 4$ identity matrix).\n- $\\hat{\\mathbf{O}} = \\mathrm{diag}(-1, 0, 1, 2)$\n\nThe denominator is the squared norm: $D = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\boldsymbol{\\psi} = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 (1^* \\cdot 1 + 1^* \\cdot 1 + 0^* \\cdot 0 + 0^* \\cdot 0) = \\frac{1}{2}(2) = 1$.\nThe numerator is $N = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\hat{\\mathbf{O}} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\hat{\\mathbf{O}} \\boldsymbol{\\psi}$. Since both $\\mathbf{W}$ and $\\hat{\\mathbf{O}}$ are diagonal, this is $\\sum_{k=1}^4 w_k O_{kk} |\\psi_k|^2$.\n$N = 1 \\cdot (-1) \\cdot \\left|\\frac{1}{\\sqrt{2}}\\right|^2 + 1 \\cdot 0 \\cdot \\left|\\frac{1}{\\sqrt{2}}\\right|^2 + 1 \\cdot 1 \\cdot |0|^2 + 1 \\cdot 2 \\cdot |0|^2 = -1 \\cdot \\frac{1}{2} + 0 = -0.5$.\nThe expectation value is $\\langle \\hat{O} \\rangle = N/D = -0.5/1 = -0.5$.\n\n**Case B:**\n- $N = 3$\n- $\\boldsymbol{\\psi} = (1 + i, 2 - i, -0.5i)^{\\mathsf{T}}$\n- $\\mathbf{w} = (0.3, 0.5, 0.2)$\n- $\\hat{\\mathbf{O}} = \\mathbf{I}_3$ (the $3 \\times 3$ identity matrix)\n\nFor any non-zero state $\\boldsymbol{\\psi}$, the expectation value of the identity operator is always $1$. The formula confirms this:\n$\\langle \\hat{O} \\rangle = \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\mathbf{I}_3 \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi}} = \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi}} = 1$.\nThe result is $\\langle \\hat{O} \\rangle = 1.0$.\n\n**Case C:**\n- $N = 3$\n- $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$\n- $\\mathbf{w} = (0.25, 0.5, 0.25)$\n- $\\hat{\\mathbf{O}} = \\mathrm{diag}(0, 0.5, 1.0)$\n\nThe denominator is $D = \\sum_{k=1}^3 w_k |\\psi_k|^2 = 0.25 \\cdot |1|^2 + 0.5 \\cdot |1|^2 + 0.25 \\cdot |1|^2 = 0.25 + 0.5 + 0.25 = 1$.\nThe numerator is $N = \\sum_{k=1}^3 w_k O_{kk} |\\psi_k|^2 = 0.25 \\cdot 0 \\cdot |1|^2 + 0.5 \\cdot 0.5 \\cdot |1|^2 + 0.25 \\cdot 1.0 \\cdot |1|^2 = 0 + 0.25 + 0.25 = 0.5$.\nThe expectation value is $\\langle \\hat{O} \\rangle = N/D = 0.5/1 = 0.5$. This corresponds to the exact expectation value of position for a constant wavefunction on the interval $[0, 1]$ when using the trapezoidal rule for integration.\n\n**Case D:**\n- $N = 2$\n- $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} (1, i)^{\\mathsf{T}}$\n- $\\mathbf{w} = (1, 1)$, so $\\mathbf{W} = \\mathbf{I}_2$.\n- $\\hat{\\mathbf{O}} = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$\n\nThe denominator is $D = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\boldsymbol{\\psi} = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 (1^* \\cdot 1 + i^* \\cdot i) = \\frac{1}{2}(1 + (-i)i) = \\frac{1}{2}(1+1) = 1$.\nThe numerator is $N = \\boldsymbol{\\psi}^\\dagger \\hat{\\mathbf{O}} \\boldsymbol{\\psi}$.\nFirst, calculate $\\hat{\\mathbf{O}}\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ i \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} i \\\\ 1 \\end{pmatrix}$.\nThen, $N = \\boldsymbol{\\psi}^\\dagger (\\hat{\\mathbf{O}}\\boldsymbol{\\psi}) = \\frac{1}{\\sqrt{2}}(1, -i) \\cdot \\frac{1}{\\sqrt{2}} \\begin{pmatrix} i \\\\ 1 \\end{pmatrix} = \\frac{1}{2}(1 \\cdot i + (-i) \\cdot 1) = \\frac{1}{2}(i - i) = 0$.\nThe expectation value is $\\langle \\hat{O} \\rangle = N/D = 0/1 = 0$.\n\n**Case E:**\n- $N = 3$\n- $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$\n- $\\mathbf{w} = (1, 1, 1)$, so $\\mathbf{W} = \\mathbf{I}_3$.\n- $\\Delta x = 1$\n- $\\hat{\\mathbf{O}} = \\hat{\\mathbf{P}} = -\\frac{i}{2\\Delta x} \\begin{pmatrix} 0 & 1 & -1 \\\\ -1 & 0 & 1 \\\\ 1 & -1 & 0 \\end{pmatrix} = -0.5i \\begin{pmatrix} 0 & 1 & -1 \\\\ -1 & 0 & 1 \\\\ 1 & -1 & 0 \\end{pmatrix}$\n\nThe denominator is $D = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\boldsymbol{\\psi} = 1^* \\cdot 1 + 1^* \\cdot 1 + 1^* \\cdot 1 = 3$.\nThe numerator is $N = \\boldsymbol{\\psi}^\\dagger \\hat{\\mathbf{P}} \\boldsymbol{\\psi}$.\nFirst, calculate $\\hat{\\mathbf{P}}\\boldsymbol{\\psi}$. The matrix part applied to $\\boldsymbol{\\psi}$ gives:\n$\\begin{pmatrix} 0 & 1 & -1 \\\\ -1 & 0 & 1 \\\\ 1 & -1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\cdot 1 + 1 \\cdot 1 - 1 \\cdot 1 \\\\ -1 \\cdot 1 + 0 \\cdot 1 + 1 \\cdot 1 \\\\ 1 \\cdot 1 - 1 \\cdot 1 + 0 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\nThus, $\\hat{\\mathbf{P}}\\boldsymbol{\\psi} = \\mathbf{0}$.\nThe numerator is $N = \\boldsymbol{\\psi}^\\dagger \\mathbf{0} = 0$.\nThe expectation value is $\\langle \\hat{O} \\rangle = N/D = 0/3 = 0$. This is expected, as a constant wavefunction represents a state of zero momentum ($k=0$), and the expectation value of the momentum operator for such a state is zero.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expectation value of an observable for several test cases\n    in a discretized quantum mechanics framework.\n    \"\"\"\n\n    def compute_expectation_value(psi, O, w):\n        \"\"\"\n        Calculates the expectation value <O> = (psi^dag W O psi) / (psi^dag W psi).\n\n        Args:\n            psi (np.ndarray): The complex-valued wavefunction vector.\n            O (np.ndarray): The complex-valued observable matrix.\n            w (np.ndarray): The real-valued quadrature weights vector.\n\n        Returns:\n            float: The real-valued expectation value.\n        \"\"\"\n        # Ensure inputs are NumPy arrays with appropriate types for calculation.\n        psi = np.asarray(psi, dtype=np.complex128)\n        O = np.asarray(O, dtype=np.complex128)\n        w = np.asarray(w, dtype=np.float64)\n\n        # Numerator: psi^dagger @ W @ O @ psi\n        # The operation W @ vector is efficiently implemented as element-wise multiplication.\n        O_psi = O @ psi\n        W_O_psi = w * O_psi\n        numerator = np.dot(psi.conj(), W_O_psi)\n\n        # Denominator: psi^dagger @ W @ psi\n        W_psi = w * psi\n        denominator = np.dot(psi.conj(), W_psi)\n        \n        # Avoid division by zero, although not expected for valid states.\n        if np.isclose(denominator, 0.0):\n            raise ValueError(\"Denominator is zero, the state norm is zero.\")\n\n        # The problem guarantees a real result. Take the real part to discard\n        # any potential imaginary noise from floating-point arithmetic.\n        expectation_value = (numerator / denominator).real\n        return expectation_value\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {   # Case A\n            \"psi\": (1 / np.sqrt(2)) * np.array([1, 1, 0, 0]),\n            \"O\": np.diag([-1, 0, 1, 2]),\n            \"w\": np.array([1, 1, 1, 1])\n        },\n        {   # Case B\n            \"psi\": np.array([1 + 1j, 2 - 1j, -0.5j]),\n            \"O\": np.identity(3),\n            \"w\": np.array([0.3, 0.5, 0.2])\n        },\n        {   # Case C\n            \"psi\": np.array([1, 1, 1]),\n            \"O\": np.diag([0, 0.5, 1.0]),\n            \"w\": np.array([0.25, 0.5, 0.25])\n        },\n        {   # Case D\n            \"psi\": (1 / np.sqrt(2)) * np.array([1, 1j]),\n            \"O\": np.array([[0, 1], [1, 0]]),\n            \"w\": np.array([1, 1])\n        },\n        {   # Case E\n            \"psi\": np.array([1, 1, 1]),\n            \"O\": (-1j / (2.0 * 1.0)) * np.array([[0, 1, -1], [-1, 0, 1], [1, -1, 0]]),\n            \"w\": np.array([1, 1, 1])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = compute_expectation_value(case[\"psi\"], case[\"O\"], case[\"w\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.10f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"}]}