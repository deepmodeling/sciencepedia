{"hands_on_practices": [{"introduction": "The cornerstone of the canonical ensemble is the partition function $Q$, which connects the microscopic energy states of a system to its macroscopic thermodynamic properties. This exercise provides fundamental practice in this procedure. You will build the partition function for a simple lattice model from first principles and then derive key thermodynamic observables like internal energy $U$ and heat capacity $C_V$ [@problem_id:2463790].", "problem": "Consider a toy two-dimensional square lattice consisting of $2 \\times 2$ adsorption sites (four sites in total) in the canonical (constant number of particles, volume, and temperature; NVT) ensemble at absolute temperature $T$. Each site hosts a single, non-interacting molecular rotor that can adopt one of two conformational states:\n\n- A ground state of energy $0$ with twofold orientational degeneracy.\n- An excited state of energy $\\varepsilon \\gt 0$ with single degeneracy.\n\nThere are no interactions between different sites, and the lattice volume is fixed. Let $k_B$ denote the Boltzmann constant. Using only first principles of the canonical ensemble, compute the canonical partition function $Q(T)$ of the four-site lattice, then derive the internal energy $U(T)$ and the constant-volume heat capacity $C_V(T)$. Provide all expressions in closed form.\n\nAnswer reporting requirement: Report only the final closed-form analytic expression for $C_V(T)$ in terms of $k_B$, $\\varepsilon$, and $T$ as your final answer. Do not include units in the final reported expression. Do not round or approximate.", "solution": "The problem as stated is scientifically sound, well-posed, objective, and self-contained. It presents a standard exercise in statistical mechanics applied to a discrete system within the canonical ensemble. All necessary parameters are provided, and no contradictions or ambiguities are present. Therefore, I will proceed with the solution.\n\nThe system consists of $N=4$ independent, non-interacting, and distinguishable molecular rotors located on a fixed lattice. The total partition function $Q(T)$ of such a system is the product of the single-particle partition functions $q(T)$:\n$$Q(T) = [q(T)]^N$$\nHere, $N=4$.\n\nThe first step is to compute the single-particle partition function $q(T)$. The partition function for a single rotor is the sum over all its available states, weighted by the Boltzmann factor $\\exp(-E_i / (k_B T))$, where $E_i$ is the energy of state $i$ and $g_i$ is its degeneracy.\n$$q(T) = \\sum_{i} g_i \\exp\\left(-\\frac{E_i}{k_B T}\\right)$$\nThe problem provides two energy levels for each rotor:\n1.  Ground state: energy $E_0 = 0$, degeneracy $g_0 = 2$.\n2.  Excited state: energy $E_1 = \\varepsilon$, degeneracy $g_1 = 1$.\n\nSubstituting these values into the expression for $q(T)$:\n$$q(T) = g_0 \\exp\\left(-\\frac{E_0}{k_B T}\\right) + g_1 \\exp\\left(-\\frac{E_1}{k_B T}\\right)$$\n$$q(T) = 2 \\cdot \\exp\\left(-\\frac{0}{k_B T}\\right) + 1 \\cdot \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)$$\n$$q(T) = 2 \\cdot 1 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right) = 2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)$$\n\nNow, we can write the total canonical partition function for the $N=4$ rotors:\n$$Q(T) = [q(T)]^4 = \\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^4$$\n\nThe next step is to derive the internal energy $U(T)$ of the system. In the canonical ensemble, the internal energy is related to the partition function by the formula:\n$$U(T) = k_B T^2 \\frac{\\partial \\ln Q(T)}{\\partial T}$$\nLet us first find $\\ln Q(T)$:\n$$\\ln Q(T) = \\ln\\left[\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^4\\right] = 4 \\ln\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)$$\nTo simplify differentiation, it is convenient to use the variable $\\beta = \\frac{1}{k_B T}$. The expression for internal energy becomes $U(\\beta) = -\\frac{\\partial \\ln Q(\\beta)}{\\partial \\beta}$.\n$$\\ln Q(\\beta) = 4 \\ln\\left(2 + \\exp(-\\varepsilon\\beta)\\right)$$\nDifferentiating with respect to $\\beta$:\n$$U(\\beta) = -\\frac{\\partial}{\\partial \\beta} \\left[4 \\ln\\left(2 + \\exp(-\\varepsilon\\beta)\\right)\\right]$$\n$$U(\\beta) = -4 \\cdot \\frac{1}{2 + \\exp(-\\varepsilon\\beta)} \\cdot \\frac{\\partial}{\\partial \\beta}\\left(2 + \\exp(-\\varepsilon\\beta)\\right)$$\n$$U(\\beta) = -4 \\cdot \\frac{1}{2 + \\exp(-\\varepsilon\\beta)} \\cdot \\left(-\\varepsilon \\exp(-\\varepsilon\\beta)\\right)$$\n$$U(\\beta) = \\frac{4\\varepsilon \\exp(-\\varepsilon\\beta)}{2 + \\exp(-\\varepsilon\\beta)}$$\nSubstituting $\\beta = \\frac{1}{k_B T}$ back, we obtain the internal energy as a function of temperature:\n$$U(T) = \\frac{4\\varepsilon \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}$$\n\nFinally, we derive the constant-volume heat capacity, $C_V(T)$. It is defined as the partial derivative of the internal energy with respect to temperature at constant volume:\n$$C_V(T) = \\left(\\frac{\\partial U}{\\partial T}\\right)_V$$\nAgain, using $\\beta$ is more direct. The relationship is $C_V = \\frac{\\partial U}{\\partial T} = \\frac{\\partial U}{\\partial \\beta} \\frac{\\partial \\beta}{\\partial T}$. Since $\\beta = \\frac{1}{k_B T}$, we have $\\frac{\\partial \\beta}{\\partial T} = -\\frac{1}{k_B T^2}$.\nSo, $C_V = -\\frac{1}{k_B T^2} \\frac{\\partial U}{\\partial \\beta}$. We must differentiate $U(\\beta)$ with respect to $\\beta$:\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} \\left(\\frac{4\\varepsilon \\exp(-\\varepsilon\\beta)}{2 + \\exp(-\\varepsilon\\beta)}\\right)$$\nUsing the quotient rule for differentiation, $\\frac{d}{dx}\\left(\\frac{f}{g}\\right) = \\frac{f'g-fg'}{g^2}$, with $f(\\beta) = 4\\varepsilon \\exp(-\\varepsilon\\beta)$ and $g(\\beta) = 2 + \\exp(-\\varepsilon\\beta)$:\n$$f'(\\beta) = -4\\varepsilon^2 \\exp(-\\varepsilon\\beta)$$\n$$g'(\\beta) = -\\varepsilon \\exp(-\\varepsilon\\beta)$$\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{(-4\\varepsilon^2 \\exp(-\\varepsilon\\beta))(2 + \\exp(-\\varepsilon\\beta)) - (4\\varepsilon \\exp(-\\varepsilon\\beta))(-\\varepsilon \\exp(-\\varepsilon\\beta))}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\nExpanding the numerator:\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{-8\\varepsilon^2 \\exp(-\\varepsilon\\beta) - 4\\varepsilon^2 \\exp(-2\\varepsilon\\beta) + 4\\varepsilon^2 \\exp(-2\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{-8\\varepsilon^2 \\exp(-\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\nNow, we substitute this back into the expression for $C_V$:\n$$C_V(T) = -\\frac{1}{k_B T^2} \\left(\\frac{-8\\varepsilon^2 \\exp(-\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}\\right)$$\n$$C_V(T) = \\frac{8\\varepsilon^2}{k_B T^2} \\frac{\\exp(-\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\nReplacing $\\beta$ with $\\frac{1}{k_B T}$ yields the final expression for the constant-volume heat capacity:\n$$C_V(T) = \\frac{8\\varepsilon^2}{k_B T^2} \\frac{\\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^2}$$\nThis expression can be rearranged for notational preference, for example:\n$$C_V(T) = 8 k_B \\left(\\frac{\\varepsilon}{k_B T}\\right)^2 \\frac{\\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^2}$$\nThe form derived first is sufficient and complete.", "answer": "$$\\boxed{\\frac{8 \\varepsilon^{2}}{k_B T^{2}} \\frac{\\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^{2}}}$$", "id": "2463790"}, {"introduction": "While analytical models build intuition, most real-world chemical problems are solved numerically. This computational exercise bridges theory and practice by having you model the conformational landscape of a biomolecule, alanine dipeptide [@problem_id:2463736]. You will implement the canonical ensemble on a discrete grid to calculate the probabilities of different conformations, exploring how temperature and solvent effects alter the equilibrium balance.", "problem": "You are asked to construct a fully specified canonical ensemble model for the conformational equilibrium of alanine dipeptide projected onto the Ramachandran torsions, and to compute canonical basin populations for two basins (alpha and beta) in vacuum versus water-like conditions. You must implement a complete, runnable program that evaluates the discrete canonical (constant number of particles, constant volume, constant temperature) ensemble over torsion angles and reports basin probabilities. All mathematical definitions are provided below; you must use them exactly as stated and express any physical quantities in the specified units.\n\nModel setup. Consider torsion angles $\\phi$ and $\\psi$ defined on the two-dimensional torus $[-180^{\\circ},180^{\\circ}) \\times [-180^{\\circ},180^{\\circ})$. Define the base potential energy surface $V_{\\text{base}}(\\phi,\\psi)$ in kilojoules per mole as\n$$\nV_{\\text{base}}(\\phi,\\psi) = V_a \\left[1 - \\cos\\!\\left(3(\\phi+60^{\\circ})\\right)\\right] + V_b \\left[1 - \\cos\\!\\left(3(\\psi+45^{\\circ})\\right)\\right] + V_c \\left[1 + \\cos\\!\\left(\\phi - \\psi\\right)\\right],\n$$\nwhere all trigonometric arguments are in degrees, and $V_a$, $V_b$, $V_c$ are constants in kilojoules per mole.\n\nModel the solvent effect as a local stabilization of the alpha basin and a local penalty of the beta basin via torus-Gaussian terms. Let the alpha basin center be $(\\phi_\\alpha,\\psi_\\alpha) = (-60^{\\circ},-45^{\\circ})$ and the beta basin center be $(\\phi_\\beta,\\psi_\\beta) = (-135^{\\circ},135^{\\circ})$. Define the squared toroidal distance between $(\\phi,\\psi)$ and $(\\phi_0,\\psi_0)$ as\n$$\nd^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_0,\\psi_0)) = \\Delta(\\phi,\\phi_0)^2 + \\Delta(\\psi,\\psi_0)^2,\n$$\nwith wrapped angular difference $\\Delta(\\theta,\\theta_0)$ in degrees given by\n$$\n\\Delta(\\theta,\\theta_0) = \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!\\left(\\theta - \\theta_0\\right), \\quad \\text{where } \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!(x) = x - 360^{\\circ}\\,\\left\\lfloor \\frac{x + 180^{\\circ}}{360^{\\circ}} \\right\\rfloor.\n$$\nLet $\\sigma$ be a width in degrees, $s_\\alpha$ a stabilization amplitude in kilojoules per mole for alpha, and $s_\\beta$ a penalty amplitude in kilojoules per mole for beta. The solvent contribution is\n$$\nV_{\\text{solv}}(\\phi,\\psi) = - s_\\alpha \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\alpha,\\psi_\\alpha))}{2\\sigma^2}\\right) + s_\\beta \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\beta,\\psi_\\beta))}{2\\sigma^2}\\right).\n$$\nThe total potential is $V(\\phi,\\psi) = V_{\\text{base}}(\\phi,\\psi) + V_{\\text{solv}}(\\phi,\\psi)$, in kilojoules per mole.\n\nCanonical ensemble. For a given absolute temperature $T$ in kelvin, with Boltzmann constant $k_{\\mathrm{B}} = 0.008314462618\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, define $\\beta = 1/(k_{\\mathrm{B}} T)$. The canonical weight at $(\\phi,\\psi)$ is $w(\\phi,\\psi) = \\exp(-\\beta V(\\phi,\\psi))$.\n\nDiscretization. Use a uniform grid of angles with spacing $\\Delta = 2^{\\circ}$ in each dimension over $[-180^{\\circ},180^{\\circ})$. The discrete partition function is\n$$\nZ = \\sum_{\\phi}\\sum_{\\psi} \\exp\\!\\left(-\\beta V(\\phi,\\psi)\\right),\n$$\nwhere the sums run over the grid points, and probabilities are defined by normalization with $Z$. Let the alpha basin window be the toroidal rectangle of half-width $w = 30^{\\circ}$ in each angular dimension around $(\\phi_\\alpha,\\psi_\\alpha)$, that is, the set of $(\\phi,\\psi)$ such that $|\\Delta(\\phi,\\phi_\\alpha)| \\le w$ and $|\\Delta(\\psi,\\psi_\\alpha)| \\le w$. Define the beta basin window analogously around $(\\phi_\\beta,\\psi_\\beta)$ with the same half-width $w$. The canonical probabilities to be reported are\n$$\nP_\\alpha = \\frac{1}{Z}\\sum_{(\\phi,\\psi)\\in \\text{alpha window}} \\exp\\!\\left(-\\beta V(\\phi,\\psi)\\right), \\quad\nP_\\beta = \\frac{1}{Z}\\sum_{(\\phi,\\psi)\\in \\text{beta window}} \\exp\\!\\left(-\\beta V(\\phi,\\psi)\\right).\n$$\nReport probabilities as dimensionless decimal numbers.\n\nConstants. Use $V_a = 4\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $V_b = 3\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $V_c = 1\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $\\sigma = 25^{\\circ}$, $w = 30^{\\circ}$, and $\\Delta = 2^{\\circ}$ exactly as given.\n\nTest suite. Your program must evaluate the following four parameter sets, each specified as $(T,\\ s_\\alpha,\\ s_\\beta)$:\n- Case 1 (vacuum, moderate temperature): $(T=\\ 300,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$ with $T$ in kelvin and $s_\\alpha,s_\\beta$ in kilojoules per mole.\n- Case 2 (water-like, moderate temperature): $(T=\\ 300,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$.\n- Case 3 (water-like, high temperature): $(T=\\ 600,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$.\n- Case 4 (vacuum, low temperature): $(T=\\ 100,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$.\n\nRequired outputs. For each test case, compute and return a two-element list $[P_\\alpha, P_\\beta]$ with both entries rounded to exactly six decimal places. Aggregate the four case results in the same order into a single list. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list, for example, \"[[0.123456,0.234567],[...],...]\" with no extra text.\n\nAngle unit requirement. All angles in the model are in degrees. All trigonometric functions should be interpreted with arguments in degrees as defined above.\n\nPhysical units. Energies must be in kilojoules per mole, temperatures in kelvin, and the Boltzmann constant in kilojoules per mole per kelvin. Express the final probabilities as dimensionless decimal numbers rounded to six decimal places.", "solution": "We are asked to compute canonical probabilities in the canonical (constant number of particles, constant volume, constant temperature) ensemble for alanine dipeptide torsions under a specified potential energy function, both in vacuum and with a solvent-like perturbation. The canonical ensemble assigns a weight proportional to the Boltzmann factor $\\exp(-\\beta V)$, where $\\beta = 1/(k_{\\mathrm{B}} T)$ and $V$ is the potential energy.\n\nFirst, we formalize the torsion angle domain as a two-dimensional torus $[-180^{\\circ},180^{\\circ}) \\times [-180^{\\circ},180^{\\circ})$ and use a uniform discrete grid of spacing $\\Delta = 2^{\\circ}$ for both $\\phi$ and $\\psi$. This discretization renders the partition function and probabilities as finite sums, ensuring that numerical evaluation is unambiguous and consistent across implementations.\n\nThe base potential is defined by\n$$\nV_{\\text{base}}(\\phi,\\psi) = V_a \\left[1 - \\cos\\!\\left(3(\\phi+60^{\\circ})\\right)\\right] + V_b \\left[1 - \\cos\\!\\left(3(\\psi+45^{\\circ})\\right)\\right] + V_c \\left[1 + \\cos\\!\\left(\\phi - \\psi\\right)\\right],\n$$\nwith $V_a = 4\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $V_b = 3\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, and $V_c = 1\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. The trigonometric functions take arguments in degrees; numerically, one can convert degrees to radians when calling standard library functions, but mathematically the definitions are fixed.\n\nThe solvent perturbation is modeled by torus-Gaussian terms that stabilize or destabilize specific regions:\n$$\nV_{\\text{solv}}(\\phi,\\psi) = - s_\\alpha \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\alpha,\\psi_\\alpha))}{2\\sigma^2}\\right) + s_\\beta \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\beta,\\psi_\\beta))}{2\\sigma^2}\\right),\n$$\nwith $(\\phi_\\alpha,\\psi_\\alpha) = (-60^{\\circ},-45^{\\circ})$, $(\\phi_\\beta,\\psi_\\beta) = (-135^{\\circ},135^{\\circ})$, and $\\sigma = 25^{\\circ}$. The toroidal squared distance is\n$$\nd^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_0,\\psi_0)) = \\Delta(\\phi,\\phi_0)^2 + \\Delta(\\psi,\\psi_0)^2,\n$$\nwhere the wrapped difference $\\Delta(\\theta,\\theta_0)$ produces the minimal angular difference on the circle:\n$$\n\\Delta(\\theta,\\theta_0) = \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!\\left(\\theta - \\theta_0\\right), \\quad \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!(x) = x - 360^{\\circ}\\,\\left\\lfloor \\frac{x + 180^{\\circ}}{360^{\\circ}} \\right\\rfloor.\n$$\nThe total potential is $V = V_{\\text{base}} + V_{\\text{solv}}$.\n\nFor a given absolute temperature $T$ and Boltzmann constant $k_{\\mathrm{B}} = 0.008314462618\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, we compute $\\beta = 1/(k_{\\mathrm{B}} T)$. The canonical weight at each grid point is $w = \\exp(-\\beta V)$. The discrete partition function is\n$$\nZ = \\sum_{\\phi}\\sum_{\\psi} w(\\phi,\\psi),\n$$\nand any canonical probability over a subset $\\Omega$ of grid points is\n$$\nP(\\Omega) = \\frac{1}{Z}\\sum_{(\\phi,\\psi)\\in \\Omega} w(\\phi,\\psi).\n$$\n\nWe define the alpha window as the toroidal rectangle centered at $(-60^{\\circ},-45^{\\circ})$ with half-width $w = 30^{\\circ}$ in each dimension:\n$$\n\\Omega_\\alpha = \\left\\{(\\phi,\\psi) : |\\Delta(\\phi,-60^{\\circ})| \\le 30^{\\circ},\\ |\\Delta(\\psi,-45^{\\circ})| \\le 30^{\\circ}\\right\\}.\n$$\nThe beta window is defined analogously around $(-135^{\\circ},135^{\\circ})$:\n$$\n\\Omega_\\beta = \\left\\{(\\phi,\\psi) : |\\Delta(\\phi,-135^{\\circ})| \\le 30^{\\circ},\\ |\\Delta(\\psi,135^{\\circ})| \\le 30^{\\circ}\\right\\}.\n$$\nThe desired outputs are $P_\\alpha = P(\\Omega_\\alpha)$ and $P_\\beta = P(\\Omega_\\beta)$.\n\nWe then evaluate these probabilities for the specified test suite:\n- Case 1: $(T=\\ 300,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$ represents vacuum at moderate temperature, where only $V_{\\text{base}}$ shapes the distribution.\n- Case 2: $(T=\\ 300,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$ represents water-like conditions at moderate temperature, where the alpha region is stabilized and the beta region is penalized relative to vacuum.\n- Case 3: $(T=\\ 600,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$ represents higher temperature, which reduces the influence of energy differences and tends to flatten the distribution, decreasing the contrast between basins.\n- Case 4: $(T=\\ 100,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$ represents vacuum at low temperature, emphasizing minima of $V_{\\text{base}}$ and sharpening basin populations.\n\nAlgorithmically, one enumerates the grid points, computes $V(\\phi,\\psi)$ and $w(\\phi,\\psi)$, forms $Z$, constructs indicator masks for $\\Omega_\\alpha$ and $\\Omega_\\beta$ via wrapped angular differences, and computes $P_\\alpha$ and $P_\\beta$ by summation and normalization. The results must be rounded to six decimal places and returned for each case in order. Qualitatively, introducing the solvent-like stabilization ($s_\\alpha > 0$ and $s_\\beta > 0$) increases $P_\\alpha$ and decreases $P_\\beta$ at fixed temperature, while raising $T$ increases entropic mixing and drives both basin probabilities toward values reflecting the relative geometrical sizes of the windows rather than energetic preferences. At low $T$, $P_\\alpha$ and $P_\\beta$ reflect the energetic minima structure of $V_{\\text{base}}$ with sharper contrasts.\n\nThe final program implements these definitions exactly and prints a single line containing a list of four two-element lists, each $[P_\\alpha, P_\\beta]$ rounded to six decimal places, in the order specified by the test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef wrap_deg(x):\n    \"\"\"\n    Wrap angle(s) in degrees to the interval (-180, 180].\n    This returns a value such that boundaries are consistent on the torus.\n    \"\"\"\n    return x - 360.0 * np.floor((x + 180.0) / 360.0)\n\ndef torus_delta(a, b):\n    \"\"\"\n    Minimal wrapped difference between angles a and b (in degrees).\n    Works with numpy arrays or scalars.\n    \"\"\"\n    return np.abs(wrap_deg(a - b))\n\ndef build_potential(phi_deg, psi_deg, Va, Vb, Vc, s_alpha, s_beta, sigma_deg):\n    \"\"\"\n    Construct the total potential V(phi, psi) in kJ/mol on the 2D grid of angles (in degrees).\n    Trigonometric functions interpret arguments in degrees as per the problem statement.\n    \"\"\"\n    # Base torsional terms: convert degree arguments to radians for numpy trig.\n    # Using identities: cos(deg) -> cos(np.deg2rad(deg_argument))\n    term_phi = np.cos(np.deg2rad(3.0 * (phi_deg + 60.0)))\n    term_psi = np.cos(np.deg2rad(3.0 * (psi_deg + 45.0)))\n    term_cross = np.cos(np.deg2rad(phi_deg - psi_deg))\n    V_base = Va * (1.0 - term_phi) + Vb * (1.0 - term_psi) + Vc * (1.0 + term_cross)\n\n    # Solvent-like Gaussian stabilization/penalty on the torus\n    phi_alpha, psi_alpha = -60.0, -45.0\n    phi_beta, psi_beta = -135.0, 135.0\n    dphi_alpha = torus_delta(phi_deg, phi_alpha)\n    dpsi_alpha = torus_delta(psi_deg, psi_alpha)\n    d2_alpha = dphi_alpha**2 + dpsi_alpha**2\n\n    dphi_beta = torus_delta(phi_deg, phi_beta)\n    dpsi_beta = torus_delta(psi_deg, psi_beta)\n    d2_beta = dphi_beta**2 + dpsi_beta**2\n\n    # Gaussian terms\n    ga_alpha = np.exp(-d2_alpha / (2.0 * sigma_deg**2))\n    ga_beta = np.exp(-d2_beta / (2.0 * sigma_deg**2))\n    V_solv = -s_alpha * ga_alpha + s_beta * ga_beta\n\n    return V_base + V_solv\n\ndef basin_masks(phi_deg, psi_deg, w_half_deg):\n    \"\"\"\n    Construct boolean masks for alpha and beta rectangular windows on the torus.\n    \"\"\"\n    phi_alpha, psi_alpha = -60.0, -45.0\n    phi_beta, psi_beta = -135.0, 135.0\n    alpha_mask = (torus_delta(phi_deg, phi_alpha) <= w_half_deg) & (torus_delta(psi_deg, psi_alpha) <= w_half_deg)\n    beta_mask = (torus_delta(phi_deg, phi_beta) <= w_half_deg) & (torus_delta(psi_deg, psi_beta) <= w_half_deg)\n    return alpha_mask, beta_mask\n\ndef compute_probabilities(T, s_alpha, s_beta):\n    \"\"\"\n    Compute (P_alpha, P_beta) for given temperature T (K) and solvent parameters s_alpha, s_beta (kJ/mol).\n    \"\"\"\n    # Constants\n    kB = 0.008314462618  # kJ/mol/K\n    Va = 4.0  # kJ/mol\n    Vb = 3.0  # kJ/mol\n    Vc = 1.0  # kJ/mol\n    sigma_deg = 25.0  # degrees\n    w_half_deg = 30.0  # degrees\n    delta = 2.0  # degrees grid spacing\n\n    # Grid\n    angles = np.arange(-180.0, 180.0, delta)  # [-180, 180) degrees\n    phi_grid, psi_grid = np.meshgrid(angles, angles, indexing='ij')\n\n    # Potential and Boltzmann weights\n    V = build_potential(phi_grid, psi_grid, Va, Vb, Vc, s_alpha, s_beta, sigma_deg)\n    beta = 1.0 / (kB * T)\n    # For numerical stability, shift by min(V) before exponentiation; cancels in normalization\n    V_shift = V - np.min(V)\n    weights = np.exp(-beta * V_shift)\n\n    Z = np.sum(weights)\n\n    # Basin masks\n    alpha_mask, beta_mask = basin_masks(phi_grid, psi_grid, w_half_deg)\n\n    P_alpha = float(np.sum(weights[alpha_mask]) / Z)\n    P_beta = float(np.sum(weights[beta_mask]) / Z)\n    return P_alpha, P_beta\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T in K, s_alpha in kJ/mol, s_beta in kJ/mol)\n    test_cases = [\n        (300.0, 0.0, 0.0),  # Case 1: vacuum, moderate T\n        (300.0, 5.0, 2.0),  # Case 2: water-like, moderate T\n        (600.0, 5.0, 2.0),  # Case 3: water-like, high T\n        (100.0, 0.0, 0.0),  # Case 4: vacuum, low T\n    ]\n\n    results = []\n    for T, s_alpha, s_beta in test_cases:\n        p_alpha, p_beta = compute_probabilities(T, s_alpha, s_beta)\n        # Round to exactly six decimal places per requirements\n        results.append([f\"{p_alpha:.6f}\", f\"{p_beta:.6f}\"])\n\n    # Final print statement in the exact required format: a single line\n    # Convert the inner strings to produce numeric-looking output without quotes\n    # Build the string manually to avoid quotes\n    out_elems = []\n    for pair in results:\n        out_elems.append(f\"[{pair[0]},{pair[1]}]\")\n    print(f\"[{','.join(out_elems)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2463736"}, {"introduction": "Molecular simulations in the canonical ensemble often rely on classical mechanics, but when is this approximation valid? This practice problem challenges you to analyze a system where a classical treatment fails dramatically, specifically for liquid hydrogen at cryogenic temperatures [@problem_id:2463773]. By comparing the thermal de Broglie wavelength $\\Lambda$ to the intermolecular spacing, you will develop a physical intuition for why nuclear quantum effects are sometimes essential for correctly predicting a system's structure and phase.", "problem": "In a computational study of molecular liquid hydrogen at cryogenic conditions, consider two simulations of identical systems in the canonical (constant number of particles, volume, and temperature; NVT) ensemble. Both systems contain $N = 512$ rigid $\\mathrm{H_2}$ molecules interacting via the same empirically parametrized pair potential. The simulations are carried out at temperature $T = 20\\,\\mathrm{K}$ and at a mass density characteristic of saturated liquid hydrogen near its normal boiling point, $\\rho = 70\\,\\mathrm{kg\\,m^{-3}}$. In Simulation 1, the nuclei are treated classically with standard Molecular Dynamics (MD). In Simulation 2, nuclear quantum effects (NQE), such as zero-point motion and quantum delocalization, are included via Path-Integral Molecular Dynamics (PIMD).\n\nFrom first principles of statistical mechanics and molecular motion, analyze whether ignoring NQE at these conditions can qualitatively change equilibrium structure and transport. Your analysis should begin from the canonical ensemble definition and the physical meaning of the thermal de Broglie wavelength. You may assume the following constants: Planck’s constant $h = 6.626\\times 10^{-34}\\,\\mathrm{J\\,s}$, Boltzmann’s constant $k_\\mathrm{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$, and the molecular mass of hydrogen $m \\approx 2\\,\\mathrm{amu} \\approx 3.32\\times 10^{-27}\\,\\mathrm{kg}$. A useful metric for the importance of NQE is the ratio of the thermal de Broglie wavelength $\\Lambda = h/\\sqrt{2\\pi m k_\\mathrm{B} T}$ to a characteristic intermolecular spacing $a \\approx n^{-1/3}$, where the number density $n = \\rho N_\\mathrm{A}/M$ with molar mass $M = 2.016\\times 10^{-3}\\,\\mathrm{kg\\,mol^{-1}}$ and Avogadro’s number $N_\\mathrm{A} = 6.022\\times 10^{23}\\,\\mathrm{mol^{-1}}$.\n\nWhich of the following qualitative outcomes at $T = 20\\,\\mathrm{K}$ and fixed $N$ and $V$ is most consistent with the fundamental reasoning you develop?\n\nA. The classical NVT simulation spuriously predicts a solid-like arrested state (e.g., vanishing self-diffusion coefficient and very sharp, high first peak in the radial distribution function $g(r)$), while the PIMD simulation remains liquid with broadened $g(r)$ peaks and finite self-diffusion at the same $N$, $V$, and $T$.\n\nB. Both simulations yield indistinguishable equilibrium structure and transport, because in the canonical ensemble at fixed $T$ and $V$ the Boltzmann weight depends only on the potential energy and not on particle masses.\n\nC. The PIMD simulation exhibits lower self-diffusion and a higher first peak of $g(r)$ than the classical simulation, because zero-point motion traps molecules more deeply in potential wells.\n\nD. The static structure $g(r)$ is identical in both runs, but the PIMD run shows higher kinetic energy while transport coefficients remain unchanged, since NQE only affect momenta and not positions in the NVT ensemble.", "solution": "The user has provided a problem from the field of computational chemistry, specifically regarding the simulation of molecular liquid hydrogen in the canonical (NVT) ensemble. The task is to validate the problem statement and, if valid, to determine the most likely qualitative difference between a classical molecular dynamics (MD) simulation and a path-integral molecular dynamics (PIMD) simulation that includes nuclear quantum effects (NQE).\n\n### Step 1: Extract Givens\n\n-   Ensemble: Canonical (constant $N$, $V$, $T$).\n-   System: $N = 512$ rigid $\\mathrm{H_2}$ molecules.\n-   Temperature: $T = 20\\,\\mathrm{K}$.\n-   Mass density: $\\rho = 70\\,\\mathrm{kg\\,m^{-3}}$.\n-   Interaction: The same empirically parametrized pair potential is used in both simulations.\n-   Simulation 1: Classical Molecular Dynamics (MD), treating nuclei classically.\n-   Simulation 2: Path-Integral Molecular Dynamics (PIMD), including nuclear quantum effects (NQE).\n-   Constants provided:\n    -   Planck's constant: $h = 6.626\\times 10^{-34}\\,\\mathrm{J\\,s}$.\n    -   Boltzmann's constant: $k_\\mathrm{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$.\n    -   Molecular mass of $\\mathrm{H_2}$: $m \\approx 2\\,\\mathrm{amu} \\approx 3.32\\times 10^{-27}\\,\\mathrm{kg}$.\n    -   Molar mass of $\\mathrm{H_2}$: $M = 2.016\\times 10^{-3}\\,\\mathrm{kg\\,mol^{-1}}$.\n    -   Avogadro's number: $N_\\mathrm{A} = 6.022\\times 10^{23}\\,\\mathrm{mol^{-1}}$.\n-   Metric for NQE importance: Ratio of the thermal de Broglie wavelength $\\Lambda = h/\\sqrt{2\\pi m k_\\mathrm{B} T}$ to the characteristic intermolecular spacing $a \\approx n^{-1/3}$, where $n = \\rho N_\\mathrm{A}/M$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem statement is scrutinized for scientific soundness, completeness, and objectivity.\n\n1.  **Scientific Grounding**: The problem addresses a fundamental topic in condensed matter physics and physical chemistry: the conditions under which quantum mechanics must be used to describe nuclear motion. The system chosen, liquid hydrogen at $20\\,\\mathrm{K}$, is a canonical example where NQE are known to be critically important due to the low mass of the hydrogen molecule and the low temperature. The methods (MD, PIMD) and concepts ($\\Lambda$, $g(r)$, NVT ensemble) are standard. The provided constants and formulas are correct. The problem is scientifically grounded.\n2.  **Well-Posedness**: The problem defines two distinct physical models (classical vs. quantum nuclei) for the same system under identical thermodynamic conditions ($N,V,T$). It asks for a qualitative comparison of their structural and transport properties, which is a standard inquiry in the field. The provided metric ($\\Lambda/a$) offers a clear, quantitative path to the solution. A unique, meaningful physical conclusion can be derived. The problem is well-posed.\n3.  **Objectivity**: The problem is stated in precise, technical language, free of subjective claims or bias.\n4.  **Completeness and Consistency**: All necessary data ($T, \\rho, m, M$) and constants ($h, k_\\mathrm{B}, N_\\mathrm{A}$) are provided to perform the requested analysis. The physical conditions are realistic; $T=20\\,\\mathrm{K}$ is near the normal boiling point of hydrogen, and $\\rho = 70\\,\\mathrm{kg\\,m^{-3}}$ is a realistic liquid density. There are no internal contradictions.\n\n### Step 3: Verdict and Action\n\nThe problem statement is valid. I will proceed with the derivation of the solution.\n\n### Derivation from First Principles\n\nThe importance of nuclear quantum effects for a particle of mass $m$ at temperature $T$ can be assessed by comparing its thermal de Broglie wavelength, $\\Lambda$, to the average distance between particles, $a$. The quantity $\\Lambda$ represents the spatial extent of a particle's wave packet due to thermal uncertainty.\n\n$$\n\\Lambda = \\frac{h}{\\sqrt{2\\pi m k_\\mathrm{B} T}}\n$$\n\nIf $\\Lambda \\ll a$, the particles are well-localized compared to their separation, and a classical description is sufficient. If $\\Lambda \\gtrsim a$, the wave packets overlap significantly, and quantum phenomena like zero-point motion and delocalization become dominant, rendering the classical description invalid.\n\nFirst, we calculate the number density, $n$.\n$$\nn = \\frac{\\rho N_\\mathrm{A}}{M} = \\frac{(70\\,\\mathrm{kg\\,m^{-3}})(6.022\\times 10^{23}\\,\\mathrm{mol^{-1}})}{2.016\\times 10^{-3}\\,\\mathrm{kg\\,mol^{-1}}} \\approx 2.088 \\times 10^{28}\\,\\mathrm{m^{-3}}\n$$\n\nNext, we calculate the characteristic intermolecular spacing, $a$.\n$$\na \\approx n^{-1/3} = (2.088 \\times 10^{28}\\,\\mathrm{m^{-3}})^{-1/3} \\approx 3.63 \\times 10^{-10}\\,\\mathrm{m} = 3.63\\,\\text{Å}\n$$\n\nNow, we calculate the thermal de Broglie wavelength, $\\Lambda$, for a hydrogen molecule at $T=20\\,\\mathrm{K}$.\n$$\n\\Lambda = \\frac{6.626\\times 10^{-34}\\,\\mathrm{J\\,s}}{\\sqrt{2\\pi (3.32\\times 10^{-27}\\,\\mathrm{kg})(1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}})(20\\,\\mathrm{K})}}\n$$\n$$\n\\Lambda \\approx \\frac{6.626\\times 10^{-34}}{\\sqrt{5.76 \\times 10^{-48}}}\\,\\mathrm{m} = \\frac{6.626\\times 10^{-34}}{2.40 \\times 10^{-24}}\\,\\mathrm{m} \\approx 2.76 \\times 10^{-10}\\,\\mathrm{m} = 2.76\\,\\text{Å}\n$$\n\nFinally, we compute the ratio $\\Lambda/a$:\n$$\n\\frac{\\Lambda}{a} \\approx \\frac{2.76\\,\\text{Å}}{3.63\\,\\text{Å}} \\approx 0.76\n$$\n\nThe result $\\Lambda/a \\approx 0.76$ is a large value, close to $1$. This confirms that nuclear quantum effects are extremely significant under these conditions.\n\n**Physical Consequences of Significant NQE:**\n\n1.  **Zero-Point Energy (ZPE) and Delocalization**: Quantum mechanics dictates that a confined particle possesses a minimum kinetic energy, the ZPE, consistent with the Heisenberg uncertainty principle. This energy is substantial for light particles like $\\mathrm{H_2}$. This inherent kinetic energy prevents the particle from settling into the absolute minimum of a potential well. Instead, its wave function is delocalized over a finite volume. In the path-integral formalism, this delocalization is visualized as the spatial extent of the \"ring polymer\" that represents the quantum particle, which is on the order of $\\Lambda$.\n\n2.  **Effect on Structure and Phase**: In a classical simulation (MD), particles lose kinetic energy as the temperature is lowered. At a sufficiently low temperature like $20\\,\\mathrm{K}$, the thermal energy $k_B T$ may be smaller than the depth of the potential energy wells between molecules. Consequently, the classical particles will localize strongly in these wells, leading to the formation of a highly ordered, solid-like or glassy (arrested) state. This would manifest as a very sharp and high first peak in the radial distribution function, $g(r)$, and a diffusion coefficient that is zero or nearly zero.\n\n    In a quantum simulation (PIMD), the large ZPE acts as a disruptive influence. It provides the molecules with an effective kinetic energy that prevents them from localizing even if the thermal energy $k_B T$ is low. This quantum delocalization effectively \"smears\" the particle over a region of space, smoothing the potential energy landscape it experiences. This resists ordering and crystallization. The system is therefore more likely to remain in a disordered liquid phase. This state is characterized by broader and lower peaks in $g(r)$ compared to the classical solid, indicating less structural order, and by finite particle mobility (a non-zero self-diffusion coefficient).\n\n**Option-by-Option Analysis**\n\n*   **A. The classical NVT simulation spuriously predicts a solid-like arrested state (e.g., vanishing self-diffusion coefficient and very sharp, high first peak in the radial distribution function $g(r)$), while the PIMD simulation remains liquid with broadened $g(r)$ peaks and finite self-diffusion at the same $N$, $V$, and $T$.**\n    This statement is fully consistent with our derivation. The classical simulation lacks the crucial ZPE and delocalization, causing it to artificially freeze. The quantum simulation correctly includes these effects, leading to a more disordered, mobile liquid state. The descriptions of $g(r)$ and self-diffusion for each case are accurate. **Correct.**\n\n*   **B. Both simulations yield indistinguishable equilibrium structure and transport, because in the canonical ensemble at fixed $T$ and $V$ the Boltzmann weight depends only on the potential energy and not on particle masses.**\n    This reasoning is fallacious. While the classical *configurational* partition function's integrand $e^{-\\beta U(\\mathbf{r}^N)}$ does not explicitly contain mass, this is a very limited view. Quantum mechanics fundamentally depends on mass via the kinetic energy operator, $\\hat{K} = -\\sum_i \\frac{\\hbar^2}{2m_i}\\nabla_i^2$. This mass dependence is precisely what gives rise to the thermal de Broglie wavelength $\\Lambda$ and all NQE. When NQE are significant ($\\Lambda/a \\approx 1$), equilibrium properties like structure become strongly dependent on mass. Therefore, the two simulations will yield vastly different results. **Incorrect.**\n\n*   **C. The PIMD simulation exhibits lower self-diffusion and a higher first peak of $g(r)$ than the classical simulation, because zero-point motion traps molecules more deeply in potential wells.**\n    This statement describes the opposite of the actual physical effect. ZPE and quantum delocalization *prevent* particles from being trapped deeply in potential wells. They promote disorder and mobility. Therefore, PIMD should show a *lower* and *broader* first peak of $g(r)$ and *higher* self-diffusion compared to a classically arrested system. **Incorrect.**\n\n*   **D. The static structure $g(r)$ is identical in both runs, but the PIMD run shows higher kinetic energy while transport coefficients remain unchanged, since NQE only affect momenta and not positions in the NVT ensemble.**\n    This statement contains multiple errors. In quantum mechanics, position and momentum are inextricably linked via the uncertainty principle. Effects on momentum (kinetic energy) must affect position distributions. The static structure $g(r)$ is a direct measure of the probability distribution of interparticle positions and will be substantially different, as argued above. While the kinetic energy is indeed higher in PIMD due to ZPE, it is incorrect to assume transport coefficients are unchanged. The very mechanism of particle motion is altered by quantum effects like delocalization and tunneling, which directly influence diffusion. **Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2463773"}]}