{"hands_on_practices": [{"introduction": "High-level methods like Multi-Reference Configuration Interaction (MRCI) can be computationally demanding. To make these calculations practical, we often use the frozen-core approximation, which assumes deep-lying core electrons are chemically inert and excludes them from the correlation treatment. This exercise [@problem_id:2459053] explores the significant and wasteful consequences of overlooking this crucial step, underscoring the importance of balancing computational cost with the pursuit of chemical accuracy for valence properties.", "problem": "In a Multi-Reference Configuration Interaction with Singles and Doubles (MRCISD) treatment, one usually starts from a Complete Active Space Self-Consistent Field (CASSCF) reference and then builds the Configuration Interaction (CI) expansion by including all single and double excitations from a specified set of occupied orbitals into a set of virtual orbitals. A common practical choice is to freeze chemically inert core orbitals so that excitations originate only from valence occupied orbitals. Consider a novice user who forgets to freeze the core orbitals and allows excitations from all occupied orbitals in the MRCISD step. Which of the following best describes the primary, wasteful consequence of this oversight?\n\nA. It dramatically increases the size of the CI expansion and thus the computational time and memory, because many additional single and double excitations from deeply bound core orbitals are included, while contributing negligibly to typical valence properties.\n\nB. It cures the well-known lack of size extensivity in MRCISD, making the method size-extensive without any a posteriori correction.\n\nC. It qualitatively corrupts the reference space by forcing strong mixing between core and valence orbitals, leading to incorrect dissociation limits in general.\n\nD. It makes the calculation non-variational so that the total energy can drop below the exact Full Configuration Interaction (FCI) limit for the given one-electron basis.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Method:** Multi-Reference Configuration Interaction with Singles and Doubles (MRCISD).\n- **Reference Wavefunction:** A Complete Active Space Self-Consistent Field (CASSCF) wavefunction.\n- **CI Expansion:** Built from all single and double excitations from a set of occupied orbitals to a set of virtual orbitals.\n- **Standard Procedure:** Chemically inert core orbitals are frozen, meaning excitations originate only from valence occupied orbitals.\n- **The Error:** A user does not freeze the core orbitals, allowing excitations from all occupied orbitals (core + valence).\n- **Question:** What is the primary, wasteful consequence of this oversight?\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically grounded, well-posed, and objective.\n- **Scientific Grounding:** The concepts presented—MRCISD, CASSCF, core/valence orbitals, frozen core approximation, and configuration interaction expansions—are all fundamental and standard topics in computational quantum chemistry. The scenario described is a realistic and common practical issue.\n- **Well-Posedness:** The problem clearly defines a specific action (not freezing core orbitals) and asks for its primary wasteful consequence. A definite and unique answer exists based on established quantum chemical theory and computational practice.\n- **Objectivity:** The language is technical and precise, free from any subjective or ambiguous terminology.\n\nThe problem does not violate any of the invalidity criteria. It is a valid, well-defined problem in computational chemistry.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be derived.\n\n**Derivation of Solution**\n\nThe Multi-Reference Configuration Interaction (MRCI) wavefunction, $\\Psi_{MRCI}$, is constructed from a reference space, which in this case is the CASSCF wavefunction, $\\Psi_{CAS}$. The CASSCF wavefunction is a linear combination of configurations, $\\Phi_i$, spanning the active space:\n$$\n\\Psi_{CAS} = \\sum_{i \\in \\text{ref}} c_i \\Phi_i\n$$\nThe MRCISD wavefunction, $\\Psi_{MRCISD}$, includes all configurations obtained by applying single ($\\hat{T}_1$) and double ($\\hat{T}_2$) excitation operators to the reference configurations.\n$$\n\\Psi_{MRCISD} = \\left( \\hat{1} + \\hat{T}_1 + \\hat{T}_2 \\right) \\Psi_{CAS} = \\sum_{i \\in \\text{ref}} c_i \\Phi_i + \\sum_{\\substack{p,a \\\\ i \\in \\text{ref}}} c_{pi}^{a} \\hat{a}_a^\\dagger \\hat{a}_p \\Phi_i + \\sum_{\\substack{p,q,a,b \\\\ i \\in \\text{ref}}} c_{pqi}^{ab} \\hat{a}_a^\\dagger \\hat{a}_b^\\dagger \\hat{a}_q \\hat{a}_p \\Phi_i\n$$\nHere, indices $p, q$ denote occupied orbitals from which electrons are excited, and indices $a, b$ denote virtual orbitals into which electrons are excited.\n\nThe total set of occupied orbitals can be partitioned into a core set, $\\{o_{core}\\}$, and a valence set, $\\{o_{val}\\}$. The number of orbitals in these sets are $N_{core}$ and $N_{val}$, respectively. The total number of occupied orbitals is $N_{occ} = N_{core} + N_{val}$. Let the number of virtual orbitals be $N_{virt}$.\n\nThe number of single excitations is proportional to $N_{occ} \\times N_{virt}$. The number of double excitations is proportional to $N_{occ}^2 \\times N_{virt}^2$. The computational cost of an MRCISD calculation, particularly the diagonalization of the Hamiltonian matrix and the construction of its elements, scales with a high polynomial power of the number of configurations in the CI expansion.\n\nIn the standard \"frozen core\" approximation, excitations are only allowed from the valence orbitals. In this case, the number of generating occupied orbitals is effectively $N_{val}$.\nThe oversight described in the problem is to allow excitations from *all* occupied orbitals, meaning the generating set has size $N_{occ} = N_{core} + N_{val}$.\n\nLet us analyze the two main consequences:\n1.  **Computational Cost:** Since $N_{occ} > N_{val}$, including the core orbitals in the excitation space leads to a sharp increase in the number of single and, more significantly, double excitations. The size of the CI expansion, $N_{CI}$, grows substantially. Since the computational effort scales as a high power of $N_{CI}$ (e.g., iteratively as $O(N_{CI}^2)$ or higher), this oversight results in a dramatic increase in computational time and memory requirements.\n\n2.  **Energetic Contribution:** The physical justification for the frozen core approximation lies in perturbation theory. The energy correction from an excited configuration $\\Phi_k$ to a state $\\Psi_0$ is approximately proportional to $|\\langle \\Psi_0 | \\hat{H} | \\Phi_k \\rangle|^2 / (E_k - E_0)$, where $E_k - E_0$ is the excitation energy. Core orbitals (e.g., $1s$ orbitals in carbon or oxygen) are very deeply bound, meaning their orbital energies are very low. Exciting an electron from a core orbital requires a very large amount of energy. Consequently, the energy denominator $E_k - E_0$ for core excitations is extremely large. This makes the energy contribution from such configurations very small. These excitations contribute negligibly to the correlation energy of the valence electrons, which governs most chemical properties like bond lengths, reaction energies, and spectroscopic constants in the visible/UV range.\n\nCombining these two points, including excitations from core orbitals massively increases the computational cost for a negligible gain in accuracy for typical chemical applications. This is the definition of a wasteful procedure.\n\n**Evaluation of Options**\n\n**A. It dramatically increases the size of the CI expansion and thus the computational time and memory, because many additional single and double excitations from deeply bound core orbitals are included, while contributing negligibly to typical valence properties.**\nThis statement is entirely consistent with the analysis above. Including the $N_{core}$ orbitals in the excitation window increases the number of occupied orbitals from $N_{val}$ to $N_{val} + N_{core}$. This leads to a combinatorial explosion in the number of configurations. As argued, the energetic contribution from these new configurations is minimal due to the large energy gap between core and virtual orbitals. Thus, computational resources are wasted for little to no benefit for valence properties.\n**Verdict: Correct.**\n\n**B. It cures the well-known lack of size extensivity in MRCISD, making the method size-extensive without any a posteriori correction.**\nSize extensivity is a property related to the correct scaling of energy with the number of particles. Truncated CI methods like CISD and MRCISD are fundamentally not size-extensive because they omit higher-order excitations (e.g., quadruple excitations that arise from products of double excitations on non-interacting subsystems). Including excitations from core orbitals does not change the truncation level of the CI expansion; it remains at singles and doubles from the reference. The method remains non-size-extensive. A posteriori corrections, such as the Davidson-Silver correction ($+Q$), are still required to approximate the effects of higher excitations and improve size extensivity. This statement is a fundamental misunderstanding of the size-extensivity problem.\n**Verdict: Incorrect.**\n\n**C. It qualitatively corrupts the reference space by forcing strong mixing between core and valence orbitals, leading to incorrect dissociation limits in general.**\nThis is incorrect. The error occurs in the MRCISD step, which is performed *after* the CASSCF calculation. The reference space and the molecular orbitals are determined by the CASSCF method and are fixed before the MRCISD calculation begins. Including core excitations in the CI step does not alter the already-computed CASSCF reference orbitals or wavefunction. Therefore, it does not \"corrupt the reference space.\" The purpose of choosing a CASSCF reference is often precisely to obtain qualitatively correct dissociation behavior. While the final dissociation energy will be affected (usually minimally) by including core correlation, the qualitative picture established by the CASSCF reference is not corrupted by this specific mistake in the subsequent CI calculation.\n**Verdict: Incorrect.**\n\n**D. It makes the calculation non-variational so that the total energy can drop below the exact Full Configuration Interaction (FCI) limit for the given one-electron basis.**\nThe Configuration Interaction method is variational by construction. The CI energy is obtained as an eigenvalue of the Hamiltonian matrix represented in a basis of Slater determinants (configurations). By the variational principle, any eigenvalue from this procedure is an upper bound to the corresponding exact eigenvalue of the full Hamiltonian. The FCI energy is the exact energy within the given one-electron basis set. Any truncated CI energy, including that from an MRCISD calculation, must be greater than or equal to the FCI energy. Expanding the CI space by including more excitations (from core orbitals) will lower the energy, bringing it closer to the FCI limit, but it can never go below it. The variational nature of the method is not violated.\n**Verdict: Incorrect.**\n\nConclusion: The only correct statement describing the primary wasteful consequence is A.", "answer": "$$\\boxed{A}$$", "id": "2459053"}, {"introduction": "The power and challenge of multi-reference methods lie in the definition of the active space—the set of orbitals and electrons central to the chemical process. A well-chosen active space is essential for capturing the static correlation needed to describe phenomena like bond breaking and transition states. This practice [@problem_id:2459075] provides a hands-on guide to designing a minimal, yet qualitatively correct, active space for the canonical $\\mathrm{F} + \\mathrm{H}_2$ reaction, a fundamental skill for any practitioner of multi-reference theory.", "problem": "You plan to compute the transition state on the lowest doublet potential energy surface for the reaction $\\mathrm{F} + \\mathrm{H}_2 \\rightarrow \\mathrm{HF} + \\mathrm{H}$ using Multi-Reference Configuration Interaction (MRCI). As customary, you will construct the multiconfigurational reference via a Complete Active Space Self-Consistent Field (CASSCF) calculation characterized by a Complete Active Space (CAS) with $\\text{CAS}(N_e, N_o)$, where $N_e$ is the number of active electrons and $N_o$ is the number of active spatial orbitals. Assume a linear transition-state geometry $\\mathrm{F}-\\mathrm{H}-\\mathrm{H}$, freeze the fluorine $1s$ core, and work on the lowest-energy doublet surface correlating to ground-state $\\mathrm{F}(^2P)$ and $\\mathrm{H}_2$. The minimal valence basis is such that the relevant valence-localized orbitals are the $\\sigma$-bonding and $\\sigma^*$-antibonding combinations of the two hydrogen $1s$ orbitals, and the three $2p$ orbitals on fluorine. Which option best represents a minimal active space that can qualitatively describe simultaneous $\\mathrm{H}-\\mathrm{H}$ bond breaking and $\\mathrm{H}-\\mathrm{F}$ bond formation at the transition state while keeping spectator orbitals inactive?\n\nA. Use $\\text{CAS}(3,3)$ with the following active orbitals: $\\sigma(\\mathrm{H}-\\mathrm{H})$, $\\sigma^*(\\mathrm{H}-\\mathrm{H})$, and the fluorine $2p_{\\parallel}$ orbital aligned with the reaction axis; freeze $\\mathrm{F}$ $1s$ and keep $\\mathrm{F}$ $2s$ and the two perpendicular $2p$ orbitals doubly occupied (closed).\n\nB. Use $\\text{CAS}(2,2)$ with the following active orbitals: only $\\sigma(\\mathrm{H}-\\mathrm{H})$ and $\\sigma^*(\\mathrm{H}-\\mathrm{H})$; treat all fluorine $2p$ orbitals as closed.\n\nC. Use $\\text{CAS}(7,4)$ with the following active orbitals: $\\sigma(\\mathrm{H}-\\mathrm{H})$ and all three fluorine $2p$ orbitals; keep $\\sigma^*(\\mathrm{H}-\\mathrm{H})$ inactive.\n\nD. Use $\\text{CAS}(5,5)$ with the following active orbitals: $\\sigma(\\mathrm{H}-\\mathrm{H})$, $\\sigma^*(\\mathrm{H}-\\mathrm{H})$, and all three fluorine $2p$ orbitals; freeze $\\mathrm{F}$ $1s$ and keep $\\mathrm{F}$ $2s$ closed.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n-   Reaction: $\\mathrm{F} + \\mathrm{H}_2 \\rightarrow \\mathrm{HF} + \\mathrm{H}$\n-   Computational Method: Multi-Reference Configuration Interaction (MRCI) based on a Complete Active Space Self-Consistent Field (CASSCF) reference.\n-   Active Space Notation: $\\text{CAS}(N_e, N_o)$, where $N_e$ is the number of active electrons and $N_o$ is the number of active spatial orbitals.\n-   System State: Transition state on the lowest doublet potential energy surface.\n-   Geometry: Linear $\\mathrm{F}-\\mathrm{H}-\\mathrm{H}$.\n-   Core Approximation: Fluorine $1s$ orbital is frozen.\n-   Electronic Correlation: The lowest-energy doublet surface correlates to ground-state $\\mathrm{F}(^2P)$ and $\\mathrm{H}_2$.\n-   Orbital Basis: Minimal valence-localized orbitals are the $\\sigma$-bonding and $\\sigma^*$-antibonding orbitals from the two hydrogen $1s$ orbitals, and the three $2p$ orbitals on fluorine.\n-   Objective: Identify the minimal active space for a qualitative description of simultaneous $\\mathrm{H}-\\mathrm{H}$ bond breaking and $\\mathrm{H}-\\mathrm{F}$ bond formation.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem describes a standard application of high-level quantum chemistry methods (CASSCF/MRCI) to a well-known benchmark chemical reaction. The concepts invoked—active space, transition state, potential energy surface, atomic and molecular orbitals—are fundamental to computational chemistry. The specified constraints (linear geometry, frozen core) are common and well-defined approximations used to simplify a problem. The question is precise and seeks the minimal active space required for a qualitative description, a standard consideration in designing multireferential calculations. The problem is scientifically grounded, well-posed, and objective. No flaws are detected.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Derivation of the Minimal Active Space**\n\nThe system consists of one fluorine atom (atomic number $Z=9$) and two hydrogen atoms ($Z=1$), for a total of $11$ electrons. The electronic state is a doublet, which is consistent with an odd number of electrons.\n\n1.  **Valence Electron Count**: The fluorine atom has an electronic configuration of $1s^2 2s^2 2p^5$, contributing $7$ valence electrons. The dihydrogen molecule, $\\mathrm{H}_2$, contributes $2$ valence electrons from its $1s$ orbitals. The total number of valence electrons is $7+2=9$. The $\\mathrm{F}\\,1s^2$ electrons are core electrons and are correctly specified as frozen.\n\n2.  **Orbital Analysis in Linear Geometry**: We assume the molecular axis is the $z$-axis. The relevant valence atomic orbitals are $\\mathrm{F}(2s, 2p_x, 2p_y, 2p_z)$ and $\\mathrm{H}_{1,2}(1s)$.\n    -   The $\\mathrm{F}(2s)$, $\\mathrm{F}(2p_z)$, and the combination of $\\mathrm{H}_{1,2}(1s)$ orbitals have $\\sigma$ symmetry.\n    -   The $\\mathrm{F}(2p_x)$ and $\\mathrm{F}(2p_y)$ orbitals have $\\pi$ symmetry. Due to the linear geometry, the $\\sigma$ and $\\pi$ spaces are orthogonal and do not mix.\n\n3.  **Identification of Active vs. Inactive Orbitals**:\n    -   **Inactive Core**: The $\\mathrm{F}(1s)$ orbital is deep in energy and does not participate in chemical bonding. It is correctly frozen.\n    -   **Inactive Valence**: The $\\mathrm{F}(2s)$ orbital is significantly lower in energy than the other valence orbitals ($\\mathrm{F}(2p)$ and $\\mathrm{H}_2(\\sigma, \\sigma^*)$). It remains doubly occupied throughout the reaction and can be placed in the inactive (closed-shell) space. This accounts for $2$ valence electrons.\n    -   **Spectator Valence**: The reaction involves bond cleavage and formation along the molecular axis. The $\\mathrm{F}(2p_x)$ and $\\mathrm{F}(2p_y)$ $\\pi$ orbitals are perpendicular to this axis. The reaction occurs on the lowest potential energy surface, which correlates to the F atom approaching with its singly occupied $p$ orbital along the internuclear axis (a $^2\\Sigma$ state of the $\\mathrm{F}\\cdots\\mathrm{H}_2$ complex). Thus, the singly occupied orbital has $\\sigma$ symmetry, and the two $\\pi$ orbitals are doubly occupied. As they are orthogonal to the reactive $\\sigma$ space, they are spectator orbitals and should remain in the inactive (closed-shell) space for a minimal description. This accounts for another $4$ valence electrons.\n    -   **Active Space**: The chemical transformation—the breaking of the $\\mathrm{H}-\\mathrm{H}$ bond and the formation of the $\\mathrm{F}-\\mathrm{H}$ bond—is fundamentally a rearrangement of electrons within the $\\sigma$ orbital space. To describe bond breaking, it is essential to include both the bonding and corresponding antibonding orbitals. The key orbitals are therefore those that correlate with the $\\mathrm{H}_2(\\sigma)$, $\\mathrm{H}_2(\\sigma^*)$, and $\\mathrm{F}(2p_z)$ fragment orbitals. At the transition state, these three orbitals are mixed. The electrons involved are the two from the $\\mathrm{H}_2(\\sigma)$ bond and the one from the $\\mathrm{F}(2p_z)$ orbital. This constitutes a system of $3$ electrons to be distributed among $3$ active orbitals.\n\n4.  **Conclusion on Minimal Active Space**: The minimal active space must contain the three crucial $\\sigma$ orbitals and the three electrons that occupy them. This is denoted as $\\text{CAS}(3,3)$. Any smaller active space would fail to capture the essential physics of the bond rearrangement. Any larger active space (e.g., by including the $\\pi$ orbitals) would not be minimal.\n\n**Evaluation of Options**\n\n*   **A. Use $\\text{CAS}(3,3)$ with the following active orbitals: $\\sigma(\\mathrm{H}-\\mathrm{H})$, $\\sigma^*(\\mathrm{H}-\\mathrm{H})$, and the fluorine $2p_{\\parallel}$ orbital aligned with the reaction axis; freeze $\\mathrm{F}$ $1s$ and keep $\\mathrm{F}$ $2s$ and the two perpendicular $2p$ orbitals doubly occupied (closed).**\n    This option proposes a $\\text{CAS}(3,3)$ active space composed of the three $\\sigma$ orbitals critical to the reaction, with $3$ active electrons. It correctly identifies the spectator orbitals ($\\mathrm{F}\\,2s$ and the two perpendicular $\\mathrm{F}\\,2p$ orbitals) as being inactive and doubly occupied, and the $\\mathrm{F}\\,1s$ as frozen. This description perfectly matches the derivation for a minimal, qualitatively correct active space.\n    Verdict: **Correct**.\n\n*   **B. Use $\\text{CAS}(2,2)$ with the following active orbitals: only $\\sigma(\\mathrm{H}-\\mathrm{H})$ and $\\sigma^*(\\mathrm{H-H})$; treat all fluorine $2p$ orbitals as closed.**\n    This active space, $\\text{CAS}(2,2)$, only describes the breaking of the $\\mathrm{H}-\\mathrm{H}$ bond in isolation. It completely neglects the open-shell nature of the fluorine radical and its role in forming the new $\\mathrm{H}-\\mathrm{F}$ bond. Treating all fluorine $2p$ orbitals as \"closed\" ($2p^6$) implies a calculation on the $\\mathrm{F}^- + \\mathrm{H}_2$ system, not $\\mathrm{F} + \\mathrm{H}_2$. This is fundamentally incorrect.\n    Verdict: **Incorrect**.\n\n*   **C. Use $\\text{CAS}(7,4)$ with the following active orbitals: $\\sigma(\\mathrm{H}-\\mathrm{H})$ and all three fluorine $2p$ orbitals; keep $\\sigma^*(\\mathrm{H}-\\mathrm{H})$ inactive.**\n    This option makes a critical error by excluding the $\\sigma^*(\\mathrm{H}-\\mathrm{H})$ orbital from the active space. The inclusion of both bonding ($\\sigma$) and antibonding ($\\sigma^*$) orbitals is a prerequisite for describing bond dissociation correctly. Without the $\\sigma^*$ orbital, the CASSCF wavefunction cannot properly represent the breaking of the $\\mathrm{H}-\\mathrm{H}$ bond.\n    Verdict: **Incorrect**.\n\n*   **D. Use $\\text{CAS}(5,5)$ with the following active orbitals: $\\sigma(\\mathrm{H}-\\mathrm{H})$, $\\sigma^*(\\mathrm{H-H})$, and all three fluorine $2p$ orbitals; freeze $\\mathrm{F}$ $1s$ and keep $\\mathrm{F}$ $2s$ closed.**\n    This option contains an internal contradiction. The specified active orbitals are the five valence orbitals remaining after excluding $\\mathrm{F}(2s)$: $\\sigma(\\mathrm{H-H})$, $\\sigma^*(\\mathrm{H-H})$, $\\mathrm{F}(2p_x, 2p_y, 2p_z)$. The number of valence electrons to be distributed in these five orbitals is $9 - 2 = 7$ (total valence minus those in $\\mathrm{F}(2s)$). The notation $\\text{CAS}(5,5)$ implies $5$ active electrons, not $7$. The correct notation for this choice of orbitals would be $\\text{CAS}(7,5)$. Furthermore, while $\\text{CAS}(7,5)$ is a valid (and often better) active space, it is not the *minimal* space required for a *qualitative* description in a linear geometry, because it includes the spectator $\\pi$ orbitals. The question explicitly asks for the minimal representation.\n    Verdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2459075"}, {"introduction": "To truly grasp MRCI, it is invaluable to move beyond using pre-packaged software and see how the theory translates into a tangible computational model. This problem [@problem_id:2459017] challenges you to implement a simplified MRCI workflow for the automerization of cyclobutadiene, a classic multi-reference system. By constructing and diagonalizing a small Hamiltonian matrix based on Hückel theory, you will calculate an energy barrier from first principles, gaining direct insight into how configuration interaction governs chemical reactivity.", "problem": "You will design and implement a complete and runnable program that evaluates a simplified Multi-Reference Configuration Interaction (MRCI) workflow to estimate the energy barrier for the automerization of cyclobutadiene through its square transition state. The model is deliberately minimal and fully specified to be solved from first principles without external data.\n\nDefinitions and model assumptions:\n\n- Use a Hückel model for the four-site ring with alternating resonance integrals to represent the rectangular minima, and equal resonance integrals to represent the square transition state. Set the on-site energy to zero, that is, $\\alpha=0$.\n- Let the resonance integral be $\\beta$ (with $\\beta  0$) and the rectangular distortion parameter be $\\delta$ with $0 \\le \\delta  1$. Define alternating couplings $t_1=\\beta(1+\\delta)$ and $t_2=\\beta(1-\\delta)$ around the ring.\n- The Hückel one-electron spectrum for this dimerized ring consists of four energies $\\pm(t_1+t_2)$ and $\\pm(t_1-t_2)$. Therefore, the two frontier molecular orbital energies are\n  $$\\varepsilon_1=2\\beta\\delta,\\qquad \\varepsilon_2=-2\\beta\\delta.$$\n  At the square transition state ($\\delta=0$), one has $\\varepsilon_1=\\varepsilon_2=0$.\n- Define a two-orbital, two-electron active space Hamiltonian for the lowest singlet in second quantization with intraorbital Coulomb repulsion $U$, interorbital direct interaction $U'$ and Hund exchange $J$ (with pair hopping equal to $J$). In the spin-adapted singlet basis $\\{\\lvert D_1\\rangle,\\lvert D_2\\rangle,\\lvert S_{12}\\rangle\\}$ where $\\lvert D_1\\rangle$ and $\\lvert D_2\\rangle$ are the doubly occupied configurations of orbital $1$ and $2$, respectively, and $\\lvert S_{12}\\rangle$ is the one-electron-per-orbital singlet, the nonzero Hamiltonian matrix elements are\n  $$\\langle D_1\\lvert H\\rvert D_1\\rangle=2\\varepsilon_1+U,\\qquad \\langle D_2\\lvert H\\rvert D_2\\rangle=2\\varepsilon_2+U,$$\n  $$\\langle D_1\\lvert H\\rvert D_2\\rangle=\\langle D_2\\lvert H\\rvert D_1\\rangle=J,$$\n  $$\\langle S_{12}\\lvert H\\rvert S_{12}\\rangle=\\varepsilon_1+\\varepsilon_2+U'-J.$$\n  All other matrix elements in this basis are zero. The MRCI singlet energy in this model is the minimum of the three singlet eigenvalues: the two eigenvalues of the $2\\times 2$ block spanned by $\\{\\lvert D_1\\rangle,\\lvert D_2\\rangle\\}$ and the diagonal element for $\\lvert S_{12}\\rangle$.\n- For a given parameter set $(\\beta,\\delta,U,U',J)$, define the MRCI singlet energy $E_{\\mathrm{MR}}(\\delta)$ as\n  $$E_{\\mathrm{MR}}(\\delta)=\\min\\Bigl\\{U+\\varepsilon_1+\\varepsilon_2-\\sqrt{(\\varepsilon_1-\\varepsilon_2)^2+J^2},\\;\\;U+\\varepsilon_1+\\varepsilon_2+\\sqrt{(\\varepsilon_1-\\varepsilon_2)^2+J^2},\\;\\;\\varepsilon_1+\\varepsilon_2+U'-J\\Bigr\\}.$$\n  Since $\\varepsilon_1+\\varepsilon_2=0$ by construction, the expression simplifies accordingly, but you must use the definition above.\n- The square transition state corresponds to $\\delta=0$. The rectangular minimum for each case is specified by a given $\\delta_{\\min} > 0$. The barrier height is the difference\n  $$\\Delta E=E_{\\mathrm{MR}}(0)-E_{\\mathrm{MR}}(\\delta_{\\min}).$$\n\nPhysical units and numerical reporting:\n\n- All energies must be expressed in hartree.\n- Your program must output the barrier heights as decimal numbers rounded to exactly six digits after the decimal point.\n\nRequired test suite:\n\nCompute $\\Delta E$ for each of the following four parameter sets, where each tuple lists $(\\beta,\\delta_{\\min},U,U',J)$ in hartree with $\\delta_{\\min}$ dimensionless:\n\n1. Case A: $(\\beta,U,U',J,\\delta_{\\min}) = (-0.15,\\,0.5,\\,0.52,\\,0.06,\\,0.2)$.\n2. Case B: $(\\beta,U,U',J,\\delta_{\\min}) = (-0.20,\\,0.6,\\,0.62,\\,0.05,\\,0.1)$.\n3. Case C (edge, no exchange): $(\\beta,U,U',J,\\delta_{\\min}) = (-0.10,\\,0.5,\\,0.45,\\,0.0,\\,0.3)$.\n4. Case D (boundary, very small distortion): $(\\beta,U,U',J,\\delta_{\\min}) = (-0.18,\\,0.55,\\,0.56,\\,0.04,\\,0.01)$.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the four barrier heights for Cases A–D, in order, as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4]$, where each $x_i$ is rounded to six digits after the decimal point and expressed in hartree.", "solution": "The problem statement is subjected to validation and is found to be valid. It presents a well-posed, scientifically grounded problem in computational quantum chemistry. The model, while simplified, is based on established principles of Hückel theory and multi-reference configuration interaction (MRCI). All parameters, definitions, and constraints are provided, forming a self-contained and logically consistent system. No flaws pertaining to scientific unsoundness, ambiguity, or incompleteness were detected. We may therefore proceed with the solution.\n\nThe objective is to compute the energy barrier, $\\Delta E$, for the automerization of cyclobutadiene. This is achieved by calculating the difference in the ground-state singlet energy of a minimal MRCI model between the square transition state geometry and the rectangular minimum geometry.\n\nThe model is defined within a two-electron, two-orbital active space comprising the frontier molecular orbitals. The energies of these orbitals are given as $\\varepsilon_1 = 2\\beta\\delta$ and $\\varepsilon_2 = -2\\beta\\delta$, where $\\beta$ is the resonance integral and $\\delta$ is a geometric distortion parameter. Note that the sum of these orbital energies is always zero: $\\varepsilon_1 + \\varepsilon_2 = 0$.\n\nThe MRCI singlet energy, $E_{\\mathrm{MR}}(\\delta)$, for a given distortion $\\delta$ is the lowest eigenvalue of the $3 \\times 3$ Hamiltonian matrix defined in the basis of singlet configurations $\\{\\lvert D_1\\rangle, \\lvert D_2\\rangle, \\lvert S_{12}\\rangle\\}$. The Hamiltonian is block-diagonal in this basis, so the eigenvalues are the eigenvalues of the $2 \\times 2$ block involving the doubly-occupied configurations, and the diagonal element for the open-shell singlet. The problem provides the explicit expression for the energy $E_{\\mathrm{MR}}(\\delta)$ as the minimum of these three state energies:\n$$E_{\\mathrm{MR}}(\\delta)=\\min\\Bigl\\{U+\\varepsilon_1+\\varepsilon_2-\\sqrt{(\\varepsilon_1-\\varepsilon_2)^2+J^2},\\;\\;U+\\varepsilon_1+\\varepsilon_2+\\sqrt{(\\varepsilon_1-\\varepsilon_2)^2+J^2},\\;\\;\\varepsilon_1+\\varepsilon_2+U'-J\\Bigr\\}$$\nHere, $U$ is the intraorbital Coulomb repulsion, $U'$ is the interorbital Coulomb repulsion, and $J$ is the Hund's exchange integral.\n\nGiven that $\\varepsilon_1+\\varepsilon_2=0$ and $\\varepsilon_1-\\varepsilon_2 = 4\\beta\\delta$, and recognizing that the term $U+\\sqrt{(\\dots)}$ will always be greater than or equal to $U-\\sqrt{(\\dots)}$, the expression for the energy simplifies to:\n$$E_{\\mathrm{MR}}(\\delta) = \\min\\Bigl\\{U - \\sqrt{(4\\beta\\delta)^2 + J^2}, \\;\\; U' - J\\Bigr\\}$$\nThis simplified form is rigorously derived from the problem statement and will be used for calculation.\n\nThe energy barrier $\\Delta E$ is defined as the difference between the energy at the square transition state ($\\delta=0$) and the energy at the rectangular minimum geometry ($\\delta=\\delta_{\\min}$).\n$$\\Delta E = E_{\\mathrm{MR}}(0) - E_{\\mathrm{MR}}(\\delta_{\\min})$$\n\nFirst, we determine the energy at the transition state, $E_{\\mathrm{MR}}(0)$, by setting $\\delta=0$:\n$$E_{\\mathrm{MR}}(0) = \\min\\Bigl\\{U - \\sqrt{(0)^2 + J^2}, \\;\\; U' - J\\Bigr\\} = \\min\\Bigl\\{U - |J|, \\;\\; U' - J\\Bigr\\}$$\nSince the Hund's exchange $J$ is a positive quantity, this simplifies to $E_{\\mathrm{MR}}(0) = \\min\\{U-J, U'-J\\}$.\n\nNext, we determine the energy at the minimum geometry, $E_{\\mathrm{MR}}(\\delta_{\\min})$, by using the given value $\\delta_{\\min}$:\n$$E_{\\mathrm{MR}}(\\delta_{\\min}) = \\min\\Bigl\\{U - \\sqrt{(4\\beta\\delta_{\\min})^2 + J^2}, \\;\\; U' - J\\Bigr\\}$$\n\nNow, we apply these formulae to each of the four specified cases.\n\n**Case A:** $(\\beta, U, U', J, \\delta_{\\min}) = (-0.15, 0.5, 0.52, 0.06, 0.2)$\nEnergy at the transition state ($\\delta=0$):\n$$E_{\\mathrm{MR}}(0) = \\min\\{0.5 - 0.06, \\; 0.52 - 0.06\\} = \\min\\{0.44, \\; 0.46\\} = 0.44 \\; \\text{hartree}$$\nEnergy at the minimum ($\\delta_{\\min}=0.2$):\nThe first term is $0.5 - \\sqrt{(4 \\times (-0.15) \\times 0.2)^2 + 0.06^2} = 0.5 - \\sqrt{(-0.12)^2 + 0.06^2} = 0.5 - \\sqrt{0.0144 + 0.0036} = 0.5 - \\sqrt{0.018} \\approx 0.3658359$.\nThe second term is $0.52 - 0.06 = 0.46$.\n$$E_{\\mathrm{MR}}(0.2) = \\min\\{0.3658359, \\; 0.46\\} = 0.3658359 \\; \\text{hartree}$$\nBarrier height:\n$$\\Delta E_A = 0.44 - 0.3658359 = 0.0741641 \\approx 0.074164 \\; \\text{hartree}$$\n\n**Case B:** $(\\beta, U, U', J, \\delta_{\\min}) = (-0.20, 0.6, 0.62, 0.05, 0.1)$\nEnergy at the transition state ($\\delta=0$):\n$$E_{\\mathrm{MR}}(0) = \\min\\{0.6 - 0.05, \\; 0.62 - 0.05\\} = \\min\\{0.55, \\; 0.57\\} = 0.55 \\; \\text{hartree}$$\nEnergy at the minimum ($\\delta_{\\min}=0.1$):\nThe first term is $0.6 - \\sqrt{(4 \\times (-0.20) \\times 0.1)^2 + 0.05^2} = 0.6 - \\sqrt{(-0.08)^2 + 0.05^2} = 0.6 - \\sqrt{0.0064 + 0.0025} = 0.6 - \\sqrt{0.0089} \\approx 0.5056602$.\nThe second term is $0.62 - 0.05 = 0.57$.\n$$E_{\\mathrm{MR}}(0.1) = \\min\\{0.5056602, \\; 0.57\\} = 0.5056602 \\; \\text{hartree}$$\nBarrier height:\n$$\\Delta E_B = 0.55 - 0.5056602 = 0.0443398 \\approx 0.044340 \\; \\text{hartree}$$\n\n**Case C:** $(\\beta, U, U', J, \\delta_{\\min}) = (-0.10, 0.5, 0.45, 0.0, 0.3)$\nEnergy at the transition state ($\\delta=0, J=0$):\n$$E_{\\mathrm{MR}}(0) = \\min\\{0.5 - 0.0, \\; 0.45 - 0.0\\} = \\min\\{0.5, \\; 0.45\\} = 0.45 \\; \\text{hartree}$$\nEnergy at the minimum ($\\delta_{\\min}=0.3$):\nThe first term is $0.5 - \\sqrt{(4 \\times (-0.10) \\times 0.3)^2 + 0.0^2} = 0.5 - | -0.12 | = 0.5 - 0.12 = 0.38$.\nThe second term is $0.45 - 0.0 = 0.45$.\n$$E_{\\mathrm{MR}}(0.3) = \\min\\{0.38, \\; 0.45\\} = 0.38 \\; \\text{hartree}$$\nBarrier height:\n$$\\Delta E_C = 0.45 - 0.38 = 0.07 = 0.070000 \\; \\text{hartree}$$\n\n**Case D:** $(\\beta, U, U', J, \\delta_{\\min}) = (-0.18, 0.55, 0.56, 0.04, 0.01)$\nEnergy at the transition state ($\\delta=0$):\n$$E_{\\mathrm{MR}}(0) = \\min\\{0.55 - 0.04, \\; 0.56 - 0.04\\} = \\min\\{0.51, \\; 0.52\\} = 0.51 \\; \\text{hartree}$$\nEnergy at the minimum ($\\delta_{\\min}=0.01$):\nThe first term is $0.55 - \\sqrt{(4 \\times (-0.18) \\times 0.01)^2 + 0.04^2} = 0.55 - \\sqrt{(-0.0072)^2 + 0.04^2} = 0.55 - \\sqrt{0.00005184 + 0.0016} = 0.55 - \\sqrt{0.00165184} \\approx 0.5093572$.\nThe second term is $0.56 - 0.04 = 0.52$.\n$$E_{\\mathrm{MR}}(0.01) = \\min\\{0.5093572, \\; 0.52\\} = 0.5093572 \\; \\text{hartree}$$\nBarrier height:\n$$\\Delta E_D = 0.51 - 0.5093572 = 0.0006428 \\approx 0.000643 \\; \\text{hartree}$$\n\nThe implementation will encode this logic to compute and format the results for the four cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the automerization barrier of cyclobutadiene using a simplified\n    MRCI model for a given set of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (beta, delta_min, U, U_prime, J).\n    test_cases = [\n        # Case A: (beta, U, U', J, delta_min) = (-0.15, 0.5, 0.52, 0.06, 0.2)\n        (-0.15, 0.2, 0.5, 0.52, 0.06),\n        # Case B: (beta, U, U', J, delta_min) = (-0.20, 0.6, 0.62, 0.05, 0.1)\n        (-0.20, 0.1, 0.6, 0.62, 0.05),\n        # Case C (edge, no exchange): (beta, U, U', J, delta_min) = (-0.10, 0.5, 0.45, 0.0, 0.3)\n        (-0.10, 0.3, 0.5, 0.45, 0.0),\n        # Case D (boundary, very small distortion): (beta, U, U', J, delta_min) = (-0.18, 0.55, 0.56, 0.04, 0.01)\n        (-0.18, 0.01, 0.55, 0.56, 0.04),\n    ]\n\n    results = []\n    \n    def calculate_barrier(beta, delta_min, U, U_prime, J):\n        \"\"\"\n        Calculates the energy barrier ΔE based on the provided MRCI model.\n\n        The MRCI energy is given by:\n        E_MR(delta) = min(U - sqrt((4*beta*delta)^2 + J^2), U' - J)\n\n        The barrier is ΔE = E_MR(0) - E_MR(delta_min).\n        \"\"\"\n        # Calculate energy at the square transition state (delta = 0)\n        # E_MR(0) = min(U - |J|, U' - J)\n        # Since J is physically non-negative, |J| = J.\n        e_ts = min(U - J, U_prime - J)\n\n        # Calculate energy at the rectangular minimum (delta = delta_min)\n        # First term of the min function for E_MR(delta_min)\n        term1_min = U - np.sqrt((4 * beta * delta_min)**2 + J**2)\n        # Second term of the min function\n        term2_min = U_prime - J\n        \n        e_min = min(term1_min, term2_min)\n\n        # Calculate the barrier height\n        delta_e = e_ts - e_min\n        \n        return delta_e\n\n    for case in test_cases:\n        beta, delta_min, U, U_prime, J = case\n        result = calculate_barrier(beta, delta_min, U, U_prime, J)\n        results.append(result)\n\n    # Format the final results to exactly six decimal places as requested.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2459017"}]}