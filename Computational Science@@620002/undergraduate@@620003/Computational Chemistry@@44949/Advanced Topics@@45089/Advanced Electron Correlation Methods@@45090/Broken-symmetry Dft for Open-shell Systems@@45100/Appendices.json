{"hands_on_practices": [{"introduction": "What does it mean when a DFT calculation for a singlet molecule gives a non-zero $⟨\\hat{S}^2⟩$ value? This exercise challenges you to think like a practicing computational chemist, evaluating various interpretations of a spin-contaminated result. Mastering this diagnostic skill is the first step toward correctly modeling complex open-shell systems. [@problem_id:2451227]", "problem": "A computational chemist performs a spin-polarized Kohn–Sham Density Functional Theory (DFT) calculation on an even-electron molecule whose experimental ground state is a spin singlet. The self-consistent field (SCF) procedure converges to a solution with a reported spin-squared expectation value $\\langle S^2 \\rangle \\approx 0.5$. For a pure spin eigenstate with total spin quantum number $S$, the exact value is $\\langle S^2 \\rangle = S(S+1)$, so a pure singlet has $\\langle S^2 \\rangle = 0$ and a pure triplet has $\\langle S^2 \\rangle = 2$. Which of the following are plausible physical and/or computational interpretations of the reported $\\langle S^2 \\rangle$? Select all that apply.\n\nA. The unrestricted single-determinant solution is spin contaminated by triplet character; the nonzero $\\langle S^2 \\rangle$ reflects mixing of $S=0$ and $S=1$ components in the Kohn–Sham determinant.\n\nB. The molecule’s true ground state is a triplet, because any deviation of $\\langle S^2 \\rangle$ from $0$ proves that $S=1$.\n\nC. The molecule may exhibit diradical or open-shell singlet character; a broken-symmetry singlet can yield $\\langle S^2 \\rangle$ values between $0$ and $1$ even when the exact state is $S=0$.\n\nD. If a spin-restricted Kohn–Sham formalism were enforced and remained stable, a closed-shell singlet determinant would have $\\langle S^2 \\rangle = 0$ by construction; therefore the observed $\\langle S^2 \\rangle \\approx 0.5$ implies the use of an unrestricted (spin-polarized) solution or instability of the restricted solution to spin-symmetry breaking.\n\nE. The noninteger $\\langle S^2 \\rangle$ necessarily arises from loose numerical thresholds (e.g., coarse grids or loose SCF tolerances) and will vanish upon tightening these without altering the qualitative character of the solution.\n\nF. The value $\\langle S^2 \\rangle \\approx 0.5$ proves the electron count is odd, i.e., the system is a radical.", "solution": "The problem requires an interpretation of a spin-squared expectation value, $\\langle S^2 \\rangle \\approx 0.5$, obtained from a spin-polarized Kohn-Sham Density Functional Theory (DFT) calculation for an even-electron molecule whose ground state is a known spin singlet.\n\nThe foundation of this analysis rests on the properties of solutions within spin-unrestricted (or spin-polarized) quantum chemical methods, such as Unrestricted Kohn-Sham (UKS) DFT. In these methods, the spatial parts of the orbitals for alpha-spin ($\\alpha$) and beta-spin ($\\beta$) electrons are allowed to differ. A single Slater determinant constructed from such orbitals is not, in general, an eigenfunction of the total spin-squared operator, $\\hat{S}^2$.\n\nFor a pure spin state with total spin quantum number $S$, the expectation value is exactly $\\langle S^2 \\rangle = S(S+1)$. A pure singlet state has $S=0$, so $\\langle S^2 \\rangle = 0$. A pure triplet state has $S=1$, so $\\langle S^2 \\rangle = 1(1+1) = 2$. The calculated result is $\\langle S^2 \\rangle \\approx 0.5$, which is intermediate between the pure singlet and pure triplet values. This indicates that the converged Kohn-Sham determinant is not a pure spin eigenstate. This phenomenon is known as spin contamination.\n\nThis situation commonly arises for molecules that possess significant diradical or open-shell singlet character. In such systems, a single closed-shell configuration (as used in Restricted Kohn-Sham, RKS, theory) is a poor approximation of the true ground state, which has significant multireference character. An unrestricted calculation can often find a lower-energy solution by breaking the spin symmetry, meaning the $\\alpha$ and $\\beta$ orbitals localize on different parts of the molecule. This \"broken-symmetry\" (BS) solution variationally incorporates some of the static correlation energy at the cost of breaking spin symmetry.\n\nThe resulting BS determinant is a mixture of different spin states. For an overall singlet system, it is predominantly a mixture of the $S=0$ singlet and the $M_S=0$ component of the $S=1$ triplet. The expectation value for such a state can be approximated as $\\langle S^2 \\rangle_{\\text{BS}} \\approx c_0^2 S_0(S_0+1) + c_1^2 S_1(S_1+1)$, where $c_0^2$ and $c_1^2$ are the weights of the singlet ($S_0=0$) and triplet ($S_1=1$) components. For a BS determinant that is an equal mixture, $\\langle S^2 \\rangle$ would be approximately $1$. A value of $\\langle S^2 \\rangle \\approx 0.5$ suggests a state with significant, but not maximal, diradical character where the singlet component still dominates.\n\nWith these principles established, we evaluate each option.\n\nA. The unrestricted single-determinant solution is spin contaminated by triplet character; the nonzero $\\langle S^2 \\rangle$ reflects mixing of $S=0$ and $S=1$ components in the Kohn–Sham determinant.\nThis statement is a correct and standard description of the phenomenon. An unrestricted Kohn-Sham determinant that is not a spin eigenfunction is, by definition, spin contaminated. For a system that should be a singlet ($S=0$), the primary contaminant is the next higher spin state with the same $M_S$ value, which is the $M_S=0$ component of the triplet ($S=1$) state. The value $\\langle S^2 \\rangle \\approx 0.5$ is a quantitative measure of this mixing.\n**Verdict: Correct.**\n\nB. The molecule’s true ground state is a triplet, because any deviation of $\\langle S^2 \\rangle$ from $0$ proves that $S=1$.\nThis reasoning is flawed. A deviation of $\\langle S^2 \\rangle$ from $0$ indicates that the computational wavefunction (the single Kohn-Sham determinant) is not a pure singlet. It does not prove that the molecule's true ground state is a pure triplet. A pure triplet state would yield $\\langle S^2 \\rangle = 2$. The calculated value of $\\approx 0.5$ is far from $2$. This interpretation contradicts both the numerical evidence and the problem's premise that the experimental ground state is a singlet.\n**Verdict: Incorrect.**\n\nC. The molecule may exhibit diradical or open-shell singlet character; a broken-symmetry singlet can yield $\\langle S^2 \\rangle$ values between $0$ and $1$ even when the exact state is $S=0$.\nThis provides the correct physical context for the computational result. The emergence of a broken-symmetry solution is a hallmark of systems with diradical or open-shell singlet character, where the restricted closed-shell description is inadequate. In such cases, the UKS calculation converges to a BS state that approximates the true, multireferential singlet state. The $\\langle S^2 \\rangle$ for such a BS solution typically falls in the range ($0, 1$], with the value indicating the degree of diradical character. The statement correctly describes this situation.\n**Verdict: Correct.**\n\nD. If a spin-restricted Kohn–Sham formalism were enforced and remained stable, a closed-shell singlet determinant would have $\\langle S^2 \\rangle = 0$ by construction; therefore the observed $\\langle S^2 \\rangle \\approx 0.5$ implies the use of an unrestricted (spin-polarized) solution or instability of the restricted solution to spin-symmetry breaking.\nThis statement correctly outlines the computational methodology and its implications. A restricted (RKS) calculation on a closed-shell singlet enforces doubly-occupied orbitals, which mathematically guarantees $\\langle S^2 \\rangle = 0$. Obtaining a non-zero $\\langle S^2 \\rangle$ requires an unrestricted formalism. Furthermore, for a UKS calculation to converge to a broken-symmetry solution (with $\\langle S^2 \\rangle > 0$) instead of the restricted one (with $\\langle S^2 \\rangle = 0$), the restricted solution must be unstable with respect to spin polarization. This instability means the broken-symmetry solution has a lower energy. The statement is a correct and logical deduction.\n**Verdict: Correct.**\n\nE. The noninteger $\\langle S^2 \\rangle$ necessarily arises from loose numerical thresholds (e.g., coarse grids or loose SCF tolerances) and will vanish upon tightening these without altering the qualitative character of the solution.\nThis is incorrect. A value as large as $\\langle S^2 \\rangle \\approx 0.5$ is not numerical noise. Numerical inaccuracies from loose thresholds might result in a very small non-zero value, such as $10^{-5}$, for a state that should be a pure spin state. A value of $\\approx 0.5$ indicates a qualitatively different electronic structure—the broken-symmetry solution—which is a genuine minimum on the potential energy surface for the given level of theory. Tightening numerical thresholds would lead to a more precise calculation of this value (e.g., converging from $0.51$ to $0.509$), but it would not make it vanish.\n**Verdict: Incorrect.**\n\nF. The value $\\langle S^2 \\rangle \\approx 0.5$ proves the electron count is odd, i.e., the system is a radical.\nThis is incorrect on two counts. First, the problem explicitly states the system is an \"even-electron molecule.\" Second, a system with an odd number of electrons is typically a doublet radical with $S=1/2$. A pure doublet state has an expectation value of $\\langle S^2 \\rangle = S(S+1) = (1/2)(1/2+1) = 0.75$. The calculated value of $\\approx 0.5$ is not consistent with a doublet state. This interpretation confuses the broken-symmetry singlet of an even-electron system with a doublet state of an odd-electron system.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{ACD}$$", "id": "2451227"}, {"introduction": "To move from qualitative interpretation to quantitative understanding, we can explore a simplified mathematical model. This practice introduces an energy functional that depends on a single spin-polarization parameter, $m$, and is governed by physical parameters such as on-site repulsion $U$ and electron hopping $t$. By analyzing this model and finding the conditions for symmetry breaking, you will gain a concrete intuition for why a spin-restricted solution can become unstable and how a broken-symmetry state emerges. [@problem_id:2451215]", "problem": "You will model, in purely mathematical terms, how a symmetry-preserving solution can be unstable to symmetry breaking in an open-shell mean-field treatment analogous to broken-symmetry Density Functional Theory (DFT). Consider a two-site, two-electron mean-field model with one spatial orbital per site and opposite-spin electrons, described by a hopping parameter $t$ (real, positive) and an on-site interaction strength $U$ (real, nonnegative). Define a spin polarization parameter $m \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$ such that the spin-up and spin-down populations on site $A$ are $n_{A,\\uparrow} = \\tfrac{1}{2} + m$ and $n_{A,\\downarrow} = \\tfrac{1}{2} - m$, while on site $B$ they are $n_{B,\\uparrow} = \\tfrac{1}{2} - m$ and $n_{B,\\downarrow} = \\tfrac{1}{2} + m$. The total mean-field energy as a function of $m$ is\n$$\nE(m; t, U) = \\frac{U}{2} - 2 \\sqrt{t^2 + U^2 m^2} + 2 U m^2.\n$$\nThe symmetry-preserving (restricted) solution corresponds to $m = 0$ with energy\n$$\nE_{\\mathrm{R}}(t,U) = E(0; t, U) = \\frac{U}{2} - 2 t.\n$$\nA stability analysis of the restricted solution is defined by the curvature of $E(m; t, U)$ at $m = 0$, namely the second derivative\n$$\n\\left.\\frac{d^2 E}{d m^2}\\right|_{m=0} = 4 U - \\frac{2 U^2}{t}.\n$$\nIf this curvature is negative, then $m = 0$ is not a local minimum and a lower-energy symmetry-broken solution exists at some $m^\\star \\in (0, \\tfrac{1}{2}]$. If it is nonnegative, then $m = 0$ is a local minimum with no lower-energy symmetry-broken solution in the domain $[-\\tfrac{1}{2}, \\tfrac{1}{2}]$.\n\nYour task is to write a program that, for each parameter pair $(t,U)$ in the test suite below, determines whether a lower-energy symmetry-broken solution exists and computes the energy difference\n$$\n\\Delta E(t,U) = E_{\\mathrm{BS}}(t,U) - E_{\\mathrm{R}}(t,U),\n$$\nwhere $E_{\\mathrm{BS}}(t,U)$ is the minimum of $E(m; t, U)$ over $m \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$. Report the existence of a lower-energy symmetry-broken solution as a boolean (true if $\\Delta E(t,U) < 0$, false otherwise), and report $\\Delta E(t,U)$ as a real number rounded to six decimal places. All energies must be expressed in electronvolts (eV). For numerical comparisons of exact equalities at boundaries, treat values within a tolerance of $10^{-12}$ as equal.\n\nTest suite (each pair $(t,U)$ is given in electronvolts):\n- Case 1 (happy path, stable restricted): $t = 1.00$, $U = 1.00$.\n- Case 2 (boundary condition): $t = 1.00$, $U = 2.00$.\n- Case 3 (happy path, unstable restricted leading to symmetry breaking): $t = 1.00$, $U = 3.00$.\n- Case 4 (edge case with small $t$ and larger $U$): $t = 0.50$, $U = 2.00$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output two values in order: first the boolean indicating whether a lower-energy symmetry-broken solution exists, then the corresponding $\\Delta E(t,U)$ rounded to six decimal places. Aggregate all test cases in the given order into a single flat list. For example, an output with two test cases would look like\n`[true,-0.123456,false,0.000000]`\nbut use the exact cases and results specified above. Booleans must be printed in Python-style capitalization (True or False).", "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded, well-posed, and internally consistent. It presents a solvable mathematical problem derived from a simplified but standard model in computational chemistry used to illustrate the concept of symmetry breaking in mean-field theories.\n\nThe task is to determine, for given parameters $t$ and $U$, if a symmetry-broken solution exists and to calculate the energy difference $\\Delta E(t,U) = E_{\\mathrm{BS}}(t,U) - E_{\\mathrm{R}}(t,U)$. Here, $E_{\\mathrm{R}}$ is the energy of the symmetry-preserving solution at $m=0$, and $E_{\\mathrm{BS}}$ is the energy of the lowest-energy solution, found by minimizing the total energy function $E(m; t, U)$ with respect to the spin polarization parameter $m$ over its full domain.\n\nThe total mean-field energy is given by:\n$$\nE(m; t, U) = \\frac{U}{2} - 2 \\sqrt{t^2 + U^2 m^2} + 2 U m^2\n$$\nThe domain for the spin polarization parameter is $m \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$. The energy of the symmetry-preserving (restricted) solution at $m=0$ is:\n$$\nE_{\\mathrm{R}}(t,U) = E(0; t, U) = \\frac{U}{2} - 2t\n$$\nOur goal is to find the global minimum of $E(m; t, U)$ on the closed interval $[-\\tfrac{1}{2}, \\tfrac{1}{2}]$. Let's denote this minimum energy as $E_{\\mathrm{BS}}(t,U)$.\n\nFirst, we observe that the energy function $E(m; t, U)$ is an even function of $m$, as $m$ appears only as $m^2$. That is, $E(m; t, U) = E(-m; t, U)$. Consequently, we can simplify the analysis by restricting our search for the minimum to the interval $m \\in [0, \\tfrac{1}{2}]$.\n\nThe global minimum of a continuous, differentiable function on a closed interval occurs either at the boundaries of the interval or at a critical point within the interval where the first derivative is zero. The boundaries of our restricted domain are $m=0$ and $m=\\tfrac{1}{2}$. We find the critical points by taking the first derivative of $E(m; t, U)$ with respect to $m$ and setting it to zero.\n\nThe first derivative is:\n$$\n\\frac{dE}{dm} = \\frac{d}{dm} \\left( \\frac{U}{2} - 2 \\sqrt{t^2 + U^2 m^2} + 2 U m^2 \\right)\n$$\n$$\n\\frac{dE}{dm} = 0 - 2 \\cdot \\frac{1}{2\\sqrt{t^2 + U^2 m^2}} \\cdot (2 U^2 m) + 4 U m\n$$\n$$\n\\frac{dE}{dm} = -\\frac{2 U^2 m}{\\sqrt{t^2 + U^2 m^2}} + 4 U m = m \\left( 4U - \\frac{2 U^2}{\\sqrt{t^2 + U^2 m^2}} \\right)\n$$\nSetting $\\frac{dE}{dm}=0$ yields two possibilities for a critical point:\n1.  $m=0$. This is one of the boundary points of our domain $[0, \\tfrac{1}{2}]$.\n2.  $4U - \\frac{2 U^2}{\\sqrt{t^2 + U^2 m^2}} = 0$.\n\nLet's analyze the second possibility for a non-trivial critical point, which we denote $m^*$. Assuming $U > 0$ (as is true for all test cases), we can rearrange the equation:\n$$\n4U = \\frac{2 U^2}{\\sqrt{t^2 + U^2 (m^*)^2}} \\implies 2 = \\frac{U}{\\sqrt{t^2 + U^2 (m^*)^2}}\n$$\nSquaring both sides gives:\n$$\n4 = \\frac{U^2}{t^2 + U^2 (m^*)^2} \\implies 4t^2 + 4U^2 (m^*)^2 = U^2\n$$\n$$\n4U^2 (m^*)^2 = U^2 - 4t^2 \\implies (m^*)^2 = \\frac{U^2 - 4t^2}{4U^2} = \\frac{1}{4} - \\frac{t^2}{U^2}\n$$\nA real, non-zero solution for $m^*$ exists only if the right-hand side is positive, i.e., $U^2 - 4t^2 > 0$. Since $t$ and $U$ are positive, this simplifies to $U > 2t$. If such a solution exists, its value is:\n$$\nm^* = \\sqrt{\\frac{1}{4} - \\frac{t^2}{U^2}}\n$$\nThis critical point $m^*$ lies within our domain of interest, as $0 < \\frac{t^2}{U^2} < \\frac{1}{4}$ (since $U>2t$), which implies $0 < m^* < \\frac{1}{2}$.\n\nThe condition $U > 2t$ for the existence of a non-trivial minimum is precisely the condition for the instability of the restricted solution. The stability is determined by the sign of the second derivative (curvature) at $m=0$:\n$$\n\\left.\\frac{d^2 E}{d m^2}\\right|_{m=0} = 4 U - \\frac{2 U^2}{t}\n$$\nIf this curvature is negative, $m=0$ is a local maximum, and a symmetry-broken minimum must exist. $4 U - \\frac{2 U^2}{t} < 0 \\iff 4U < \\frac{2U^2}{t} \\iff 2t < U$. This confirms our finding.\n\nWe can now formulate a complete strategy based on the ratio of $U$ to $t$.\n\nCase 1: Stable or marginally stable regime ($U \\le 2t$).\nIn this regime, the curvature at $m=0$ is non-negative ($4U - \\frac{2U^2}{t} \\ge 0$). The only real critical point in the domain $m \\in [0, \\infty)$ is at $m=0$. The derivative $\\frac{dE}{dm}$ is non-negative for all $m \\ge 0$, meaning the function $E(m; t, U)$ is non-decreasing on the interval $[0, \\tfrac{1}{2}]$. The minimum of the function on this interval must therefore occur at $m=0$.\nThus, the global minimum energy is $E_{\\mathrm{BS}}(t,U) = E(0; t, U) = E_{\\mathrm{R}}(t,U)$.\nThe energy difference is $\\Delta E(t,U) = E_{\\mathrm{BS}} - E_{\\mathrm{R}} = 0$.\nA lower-energy symmetry-broken solution does not exist. The corresponding boolean is `False`.\n\nCase 2: Unstable regime ($U > 2t$).\nIn this regime, the curvature at $m=0$ is negative, indicating $m=0$ is a local maximum. A non-trivial critical point $m^* = \\sqrt{\\frac{1}{4} - \\frac{t^2}{U^2}}$ exists within $(0, \\tfrac{1}{2})$. This point corresponds to a local minimum. Since $m=0$ is a local maximum and $m^*$ is the only other critical point in the interval, $m^*$ must be the global minimum on $[0, \\tfrac{1}{2}]$.\nThe minimum energy $E_{\\mathrm{BS}}$ is the energy evaluated at $m=m^*$:\n$$\nE_{\\mathrm{BS}}(t,U) = E(m^*; t, U) = \\frac{U}{2} - 2 \\sqrt{t^2 + U^2 (m^*)^2} + 2 U (m^*)^2\n$$\nWe simplify the terms. First, the square root term:\n$$\n\\sqrt{t^2 + U^2 (m^*)^2} = \\sqrt{t^2 + U^2 \\left(\\frac{U^2 - 4t^2}{4U^2}\\right)} = \\sqrt{t^2 + \\frac{U^2 - 4t^2}{4}} = \\sqrt{\\frac{4t^2 + U^2 - 4t^2}{4}} = \\sqrt{\\frac{U^2}{4}} = \\frac{U}{2}\n$$\nSubstituting this and $(m^*)^2$ back into the energy expression:\n$$\nE_{\\mathrm{BS}}(t,U) = \\frac{U}{2} - 2\\left(\\frac{U}{2}\\right) + 2U\\left(\\frac{1}{4} - \\frac{t^2}{U^2}\\right) = \\frac{U}{2} - U + \\frac{U}{2} - \\frac{2t^2}{U} = -\\frac{2t^2}{U}\n$$\nNow, we compute the energy difference $\\Delta E(t,U) = E_{\\mathrm{BS}} - E_{\\mathrm{R}}$:\n$$\n\\Delta E(t,U) = -\\frac{2t^2}{U} - \\left(\\frac{U}{2} - 2t\\right) = \\frac{-4t^2 - U^2 + 4tU}{2U} = -\\frac{U^2 - 4tU + 4t^2}{2U}\n$$\n$$\n\\Delta E(t,U) = -\\frac{(U - 2t)^2}{2U}\n$$\nSince $U > 2t$, $(U-2t)^2 > 0$ and $2U > 0$, so $\\Delta E(t,U)$ is strictly negative. This confirms the existence of a lower-energy symmetry-broken solution. The corresponding boolean is `True`.\n\nThe final algorithm is as follows: For each pair $(t, U)$, we check if $U - 2t > 10^{-12}$. If this condition is true, a lower-energy symmetry-broken solution exists; we report `True` and calculate $\\Delta E = -\\frac{(U-2t)^2}{2U}$. Otherwise, no such solution exists; we report `False` and $\\Delta E = 0$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n# No imports are needed for this problem.\n\ndef solve():\n    \"\"\"\n    Solves the broken-symmetry problem for a set of test cases.\n\n    For each parameter pair (t, U), this function determines if a lower-energy\n    symmetry-broken solution exists and computes the energy stabilization\n    delta_E = E_BS - E_R.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (t, U) in electronvolts (eV).\n    test_cases = [\n        (1.00, 1.00),  # Case 1: Stable restricted solution\n        (1.00, 2.00),  # Case 2: Boundary condition\n        (1.00, 3.00),  # Case 3: Unstable restricted (symmetry breaking)\n        (0.50, 2.00),  # Case 4: Edge case with small t\n    ]\n\n    # Tolerance for numerical comparison of floating-point numbers.\n    TOLERANCE = 1e-12\n\n    # A flat list to store the final results for all test cases.\n    results = []\n\n    for t, U in test_cases:\n        # The condition for instability of the restricted solution and the\n        # existence of a symmetry-broken minimum is U > 2*t.\n        # We use a tolerance for stable floating-point comparison.\n        if (U - 2 * t) > TOLERANCE:\n            # Case: A lower-energy symmetry-broken solution exists.\n            has_broken_symmetry = True\n            \n            # The energy difference is given by the analytical formula:\n            # delta_E = -(U - 2*t)^2 / (2*U)\n            delta_e = -((U - 2 * t) ** 2) / (2 * U)\n        else:\n            # Case: The restricted solution (m=0) is the minimum.\n            # This occurs when U <= 2*t.\n            has_broken_symmetry = False\n            delta_e = 0.0\n\n        # Append the boolean and the formatted energy difference to the results list.\n        # The energy difference must be a string rounded to six decimal places.\n        results.append(has_broken_symmetry)\n        results.append(f\"{delta_e:.6f}\")\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts boolean True/False and the pre-formatted\n    # float strings into a sequence of strings, which are then joined.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver function.\nsolve()\n```", "id": "2451215"}, {"introduction": "Now, let's apply these concepts to a real chemical system: the dissociation of the hydrogen molecule ($\\mathrm{H}_2$), a classic case where restricted methods qualitatively fail. This exercise will guide you to derive the fundamental equation for $⟨\\hat{S}^2⟩$ in a broken-symmetry determinant, and then use it to simulate the bond-breaking process. This practice provides a clear, quantitative link between the increase in spin contamination and the physical stretching of a covalent bond. [@problem_id:2451223]", "problem": "You are asked to model and compute the expectation value of the total spin-squared operator $⟨\\hat{S}^2⟩$ for the hydrogen molecule $\\mathrm{H}_2$ at several internuclear distances using two flavors of Kohn–Sham Density Functional Theory (DFT): the Restricted Kohn–Sham (RKS) formulation and the Unrestricted Kohn–Sham (UKS) formulation, with particular attention to broken-symmetry behavior at stretched geometries. Your task is to derive the necessary expressions from a fundamental base and then implement a program that evaluates and reports the predicted $⟨\\hat{S}^2⟩$ values for a specified test suite of bond lengths.\n\nFundamental base you may use:\n- The total spin operator is $\\hat{S}^2 = \\hat{S}_x^2 + \\hat{S}_y^2 + \\hat{S}_z^2$ and for two electrons $\\hat{S}^2 = \\hat{S}_1^2 + \\hat{S}_2^2 + 2\\,\\hat{\\mathbf{S}}_1 \\cdot \\hat{\\mathbf{S}}_2$. For an electron, $⟨\\hat{S}^2⟩ = \\tfrac{3}{4}$.\n- A single Slater determinant with one $\\alpha$-spin electron in spatial orbital $\\phi_\\alpha(\\mathbf{r})$ and one $\\beta$-spin electron in spatial orbital $\\phi_\\beta(\\mathbf{r})$ is a valid mean-field state for Unrestricted Kohn–Sham (UKS) theory; in Restricted Kohn–Sham (RKS) theory for a closed-shell singlet, the spatial orbitals are the same for $\\alpha$ and $\\beta$ electrons, i.e., $\\phi_\\alpha = \\phi_\\beta$.\n- For $\\mathrm{H}_2$, assume the spatial orbitals at large separation become localized hydrogenic $1s$ Slater-type orbitals on atoms $A$ and $B$ with exponent $\\zeta = 1$ in atomic units, and the spatial overlap between $1s$ orbitals at internuclear separation $R$ (in Bohr radii) is\n  $$ S(R) = e^{-\\zeta R} \\left(1 + \\zeta R + \\frac{(\\zeta R)^2}{3}\\right), $$\n  with $\\zeta = 1$. Use the conversion $1\\,\\text{\\AA} = 1.889726125\\,\\text{bohr}$.\n- Broken-symmetry in UKS appears when the $\\alpha$ and $\\beta$ spatial orbitals become spatially different (localize on different atoms); then the single-determinant state is not an eigenstate of $\\hat{S}^2$ and exhibits spin contamination. In contrast, the RKS singlet always enforces $\\phi_\\alpha = \\phi_\\beta$.\n\nModeling assumptions to make the problem fully specified and numerically testable:\n- Treat the RKS singlet as always spin-pure with $⟨\\hat{S}^2⟩_{\\mathrm{RKS}} = 0$.\n- For UKS, use the following decision rule to mimic the appearance of broken symmetry: define a critical overlap $S_{\\mathrm{crit}} = 0.73$. If $S(R) \\ge S_{\\mathrm{crit}}$, assume the UKS solution collapses to the RKS singlet with $⟨\\hat{S}^2⟩_{\\mathrm{UKS}} = 0$. If $S(R) < S_{\\mathrm{crit}}$, assume a localized broken-symmetry UKS solution with $\\alpha$ on atom $A$ and $\\beta$ on atom $B$, and evaluate $⟨\\hat{S}^2⟩_{\\mathrm{UKS}}$ in terms of the spatial overlap between these orbitals.\n- Angles do not appear; all distances are internuclear distances and must be provided in $\\text{\\AA}$ and internally converted to bohr using the given conversion.\n- All outputs are dimensionless real numbers.\n\nTasks:\n1. From first principles (spin operators and Slater determinants), derive an expression for $⟨\\hat{S}^2⟩$ of a two-electron single determinant in terms of the spatial overlap between the occupied $\\alpha$ and $\\beta$ orbitals.\n2. Apply this to the $\\mathrm{H}_2$ molecule at separation $R$ by substituting the $1s$–$1s$ overlap. For RKS, the overlap is unity due to identical orbitals; for broken-symmetry UKS, use the interatomic $1s$–$1s$ overlap between atoms $A$ and $B$ at separation $R$.\n3. Implement a program that, for each test case below, computes a pair of numbers [$⟨\\hat{S}^2⟩_{\\mathrm{RKS}}$,$⟨\\hat{S}^2⟩_{\\mathrm{UKS}}$] using the model and prints all results in the specified format.\n\nTest suite (internuclear distances in $\\text{\\AA}$):\n- $R_1 = 0.74\\,\\text{\\AA}$ (near equilibrium; expect no broken symmetry).\n- $R_2 = 0.85\\,\\text{\\AA}$ (near the onset of broken symmetry in this model).\n- $R_3 = 3.00\\,\\text{\\AA}$ (stretched).\n- $R_4 = 10.00\\,\\text{\\AA}$ (dissociation limit).\n\nFinal output format:\n- Your program must produce a single line containing a list of four entries, one for each test case in the order $R_1, R_2, R_3, R_4$. Each entry is a two-element list [$⟨\\hat{S}^2⟩_{\\mathrm{RKS}}$,$⟨\\hat{S}^2⟩_{\\mathrm{UKS}}$]. All numbers must be floats rounded to six decimal places. For example: \n```\n[[0.000000,0.000000],[0.000000,0.523456],[0.000000,0.996400],[0.000000,1.000000]]\n```", "solution": "The problem requires the derivation and computation of the expectation value of the total spin-squared operator, $⟨\\hat{S}^2⟩$, for a two-electron system described by a single Slater determinant. This is to be applied to a model of the $\\mathrm{H}_2$ molecule within the Restricted Kohn–Sham (RKS) and Unrestricted Kohn–Sham (UKS) frameworks. The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. We proceed with the derivation.\n\nFirst, we establish the theoretical foundation. The two-electron state in a mean-field theory is described by a single Slater determinant. For a system with one $\\alpha$-spin electron in spatial orbital $\\phi_\\alpha$ and one $\\beta$-spin electron in spatial orbital $\\phi_\\beta$, the wavefunction is:\n$$ \\Psi(\\mathbf{x}_1, \\mathbf{x}_2) = \\frac{1}{\\sqrt{2}} \\left| \\begin{matrix} \\phi_\\alpha(\\mathbf{r}_1)\\alpha(\\omega_1) & \\phi_\\beta(\\mathbf{r}_1)\\beta(\\omega_1) \\\\ \\phi_\\alpha(\\mathbf{r}_2)\\alpha(\\omega_2) & \\phi_\\beta(\\mathbf{r}_2)\\beta(\\omega_2) \\end{matrix} \\right| $$\nwhere $\\mathbf{x}_i = (\\mathbf{r}_i, \\omega_i)$ represents the spatial and spin coordinates of electron $i$. This can be expanded as:\n$$ \\Psi = \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\alpha(1) \\phi_\\beta(2)\\beta(2) - \\phi_\\alpha(2)\\alpha(2) \\phi_\\beta(1)\\beta(1) ] $$\nThe spatial orbitals $\\phi_\\alpha$ and $\\phi_\\beta$ are assumed to be normalized, i.e., $⟨\\phi_\\alpha|\\phi_\\alpha⟩ = 1$ and $⟨\\phi_\\beta|\\phi_\\beta⟩=1$. Their spatial overlap is denoted $S_{\\alpha\\beta}$:\n$$ S_{\\alpha\\beta} = \\langle \\phi_\\alpha | \\phi_\\beta \\rangle = \\int \\phi_\\alpha^*(\\mathbf{r}) \\phi_\\beta(\\mathbf{r}) d\\mathbf{r} $$\nThe spin-orbitals $\\chi_\\alpha(\\mathbf{x}) = \\phi_\\alpha(\\mathbf{r})\\alpha(\\omega)$ and $\\chi_\\beta(\\mathbf{x}) = \\phi_\\beta(\\mathbf{r})\\beta(\\omega)$ are orthogonal, $⟨\\chi_\\alpha|\\chi_\\beta⟩ = ⟨\\phi_\\alpha|\\phi_\\beta⟩⟨\\alpha|\\beta⟩ = 0$, thus the Slater determinant is properly normalized with the factor $1/\\sqrt{2}$.\n\nThe total spin-squared operator for a two-electron system is $\\hat{S}^2 = (\\hat{\\mathbf{S}}_1 + \\hat{\\mathbf{S}}_2)^2$. We expand it as:\n$$ \\hat{S}^2 = \\hat{S}_1^2 + \\hat{S}_2^2 + 2\\hat{\\mathbf{S}}_1 \\cdot \\hat{\\mathbf{S}}_2 = \\hat{S}_1^2 + \\hat{S}_2^2 + 2\\hat{S}_{1z}\\hat{S}_{2z} + \\hat{S}_{1+}\\hat{S}_{2-} + \\hat{S}_{1-}\\hat{S}_{2+} $$\nThe expectation value is $⟨\\hat{S}^2⟩ = ⟨\\Psi | \\hat{S}^2 | \\Psi⟩$. We evaluate it term by term.\n\n1.  Term $⟨\\hat{S}_1^2 + \\hat{S}_2^2⟩$:\n    For any single electron (a spin-$1/2$ particle), the eigenvalue of its own spin-squared operator is $s(s+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$. As $\\Psi$ is a normalized two-electron wavefunction, the expectation value of this term is simply the sum of the eigenvalues for each electron.\n    $$ ⟨\\Psi | (\\hat{S}_1^2 + \\hat{S}_2^2) | \\Psi⟩ = ⟨\\hat{S}_1^2⟩ + ⟨\\hat{S}_2^2⟩ = \\frac{3}{4} + \\frac{3}{4} = \\frac{3}{2} $$\n\n2.  Term $⟨2\\hat{S}_{1z}\\hat{S}_{2z}⟩$:\n    We apply the operator to the ket $\\Psi$. The operator $\\hat{S}_{iz}$ acts on the spin function of electron $i$, giving eigenvalue $+\\frac{1}{2}$ for $\\alpha$ spin and $-\\frac{1}{2}$ for $\\beta$ spin.\n    $$ \\hat{S}_{1z}\\hat{S}_{2z} \\Psi = \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\phi_\\beta(2)(\\hat{S}_{1z}\\alpha(1))(\\hat{S}_{2z}\\beta(2)) - \\phi_\\alpha(2)\\phi_\\beta(1)(\\hat{S}_{1z}\\beta(1))(\\hat{S}_{2z}\\alpha(2)) ] $$\n    $$ = \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\phi_\\beta(2)(+\\frac{1}{2}\\alpha(1))(-\\frac{1}{2}\\beta(2)) - \\phi_\\alpha(2)\\phi_\\beta(1)(-\\frac{1}{2}\\beta(1))(+\\frac{1}{2}\\alpha(2)) ] $$\n    $$ = -\\frac{1}{4} \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\alpha(1)\\phi_\\beta(2)\\beta(2) - \\phi_\\alpha(2)\\alpha(2)\\phi_\\beta(1)\\beta(1) ] = -\\frac{1}{4} \\Psi $$\n    Thus, $⟨\\Psi | 2\\hat{S}_{1z}\\hat{S}_{2z} | \\Psi⟩ = 2 \\cdot \\langle \\Psi | (-\\frac{1}{4}) \\Psi \\rangle = -\\frac{1}{2}⟨\\Psi|\\Psi⟩ = -\\frac{1}{2}$.\n\n3.  Term $⟨\\hat{S}_{1-}\\hat{S}_{2+} + \\hat{S}_{1+}\\hat{S}_{2-}⟩$:\n    This term accounts for spin-flipping. We first evaluate $⟨\\Psi | \\hat{S}_{1-}\\hat{S}_{2+} | \\Psi⟩$. The raising and lowering operators act as $\\hat{S}_+\\beta = \\alpha$, $\\hat{S}_+\\alpha = 0$, $\\hat{S}_-\\alpha = \\beta$, $\\hat{S}_-\\beta = 0$.\n    $$ \\hat{S}_{2+} \\Psi = \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\alpha(1)\\phi_\\beta(2)\\alpha(2) - 0 ] $$\n    $$ \\hat{S}_{1-}(\\hat{S}_{2+}\\Psi) = \\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(1)\\beta(1)\\phi_\\beta(2)\\alpha(2) ] $$\n    The expectation value integral is:\n    $$ ⟨\\Psi | \\hat{S}_{1-}\\hat{S}_{2+} | \\Psi⟩ = \\frac{1}{2} ⟨ \\phi_\\alpha(1)\\alpha(1)\\phi_\\beta(2)\\beta(2) - \\phi_\\alpha(2)\\alpha(2)\\phi_\\beta(1)\\beta(1) | \\phi_\\alpha(1)\\beta(1)\\phi_\\beta(2)\\alpha(2) ⟩ $$\n    The first term in the bra gives zero upon spin integration: $⟨\\alpha(1)\\beta(2)|\\beta(1)\\alpha(2)⟩ = ⟨\\alpha|\\beta⟩⟨\\beta|\\alpha⟩ = 0$. The second term yields:\n    $$ -\\frac{1}{2} ⟨\\phi_\\alpha(2)\\alpha(2)\\phi_\\beta(1)\\beta(1) | \\phi_\\alpha(1)\\beta(1)\\phi_\\beta(2)\\alpha(2)⟩ = -\\frac{1}{2} ⟨\\phi_\\beta|\\phi_\\alpha⟩⟨\\phi_\\alpha|\\phi_\\beta⟩⟨\\beta|\\beta⟩⟨\\alpha|\\alpha⟩ = -\\frac{1}{2}S_{\\beta\\alpha}S_{\\alpha\\beta} = -\\frac{1}{2}|S_{\\alpha\\beta}|^2 $$\n    For the second part of the term, $⟨\\Psi | \\hat{S}_{1+}\\hat{S}_{2-} | \\Psi⟩$:\n    $$ \\hat{S}_{2-} \\Psi = \\frac{1}{\\sqrt{2}} [ 0 - \\phi_\\alpha(2)\\beta(2)\\phi_\\beta(1)\\beta(1) ] $$\n    $$ \\hat{S}_{1+}(\\hat{S}_{2-}\\Psi) = -\\frac{1}{\\sqrt{2}} [ \\phi_\\alpha(2)\\beta(2)\\phi_\\beta(1)\\alpha(1) ] $$\n    The expectation value is:\n    $$ ⟨\\Psi | \\hat{S}_{1+}\\hat{S}_{2-} | \\Psi⟩ = -\\frac{1}{2} ⟨ \\phi_\\alpha(1)\\alpha(1)\\phi_\\beta(2)\\beta(2) - \\phi_\\alpha(2)\\alpha(2)\\phi_\\beta(1)\\beta(1) | \\phi_\\beta(1)\\alpha(1)\\phi_\\alpha(2)\\beta(2) ⟩ $$\n    The second term in the bra gives zero upon spin integration. The first term yields:\n    $$ -\\frac{1}{2} ⟨\\phi_\\alpha(1)\\alpha(1)\\phi_\\beta(2)\\beta(2) | \\phi_\\beta(1)\\alpha(1) \\phi_\\alpha(2)\\beta(2)⟩ = -\\frac{1}{2} ⟨\\phi_\\alpha|\\phi_\\beta⟩⟨\\phi_\\beta|\\phi_\\alpha⟩⟨\\alpha|\\alpha⟩⟨\\beta|\\beta⟩ = -\\frac{1}{2}S_{\\alpha\\beta}S_{\\beta\\alpha} = -\\frac{1}{2}|S_{\\alpha\\beta}|^2 $$\n    Combining these gives $⟨\\hat{S}_{1-}\\hat{S}_{2+} + \\hat{S}_{1+}\\hat{S}_{2-}⟩ = -|S_{\\alpha\\beta}|^2$.\n\nCombining all terms, the total expectation value is:\n$$ ⟨\\hat{S}^2⟩ = \\frac{3}{2} - \\frac{1}{2} - |S_{\\alpha\\beta}|^2 = 1 - |S_{\\alpha\\beta}|^2 $$\nThis is the general expression for the spin contamination of a two-electron single determinant with one $\\alpha$ and one $\\beta$ electron.\n\nNow, we apply this formula to the specified model for the $\\mathrm{H}_2$ molecule.\n\nFor RKS theory, the singlet state has both electrons in the same spatial orbital, so $\\phi_\\alpha = \\phi_\\beta$. The spatial overlap is $S_{\\alpha\\beta} = ⟨\\phi_\\alpha|\\phi_\\alpha⟩ = 1$.\n$$ ⟨\\hat{S}^2⟩_{\\mathrm{RKS}} = 1 - 1^2 = 0 $$\nThis corresponds to a pure singlet state, which is spin-uncontaminated, consistent with the problem's assumption.\n\nFor UKS theory, we use the provided decision rule. The bond distance $R$ is given in Ångströms and must be converted to Bohr radii ($a_0$) using the factor $1\\,\\text{\\AA} = 1.889726125\\,a_0$. The interatomic overlap between two $1s$ Slater-type orbitals is given by:\n$$ S(R) = e^{-\\zeta R} \\left(1 + \\zeta R + \\frac{(\\zeta R)^2}{3}\\right) $$\nwith $\\zeta=1$ and $R$ in $a_0$. The critical overlap is $S_{\\mathrm{crit}} = 0.73$.\n\nIf $S(R) \\ge S_{\\mathrm{crit}}$, the UKS solution is assumed to be identical to the RKS solution. In this case, $\\phi_\\alpha = \\phi_\\beta$, so $S_{\\alpha\\beta} = 1$ and:\n$$ ⟨\\hat{S}^2⟩_{\\mathrm{UKS}} = 0 $$\n\nIf $S(R) < S_{\\mathrm{crit}}$, a broken-symmetry solution forms. The $\\alpha$ electron localizes on atom A ($\\phi_\\alpha = \\phi_A$) and the $\\beta$ electron localizes on atom B ($\\phi_\\beta = \\phi_B$). The spatial overlap between the occupied orbitals is the interatomic overlap, $S_{\\alpha\\beta} = ⟨\\phi_A|\\phi_B⟩ = S(R)$. For real orbitals, $|S(R)|^2 = (S(R))^2$. The expectation value is therefore:\n$$ ⟨\\hat{S}^2⟩_{\\mathrm{UKS}} = 1 - [S(R)]^2 $$\nAs $R \\to \\infty$, $S(R) \\to 0$, and $⟨\\hat{S}^2⟩_{\\mathrm{UKS}} \\to 1$. This corresponds to a state which is a 50/50 mixture of a pure singlet ($S=0, ⟨\\hat{S}^2⟩=0$) and a pure triplet ($S=1, ⟨\\hat{S}^2⟩=2$), resulting in an average of $⟨\\hat{S}^2⟩ = (0.5 \\times 0) + (0.5 \\times 2) = 1$.\n\nThe computational procedure will be to implement this model for each given internuclear distance $R$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expectation value of the total spin-squared operator <S^2>\n    for the H2 molecule at various internuclear distances using RKS and UKS models.\n    \"\"\"\n\n    # --- Problem Givens ---\n    # Conversion factor from Angstrom to Bohr\n    BOHR_PER_ANGSTROM = 1.889726125\n    # Slater-type orbital exponent for 1s orbital of H\n    ZETA = 1.0\n    # Critical overlap for the onset of broken symmetry\n    S_CRIT = 0.73\n\n    # Test suite of internuclear distances in Angstrom\n    test_cases = [\n        0.74,  # near equilibrium\n        0.85,  # near the onset of broken symmetry\n        3.00,  # stretched\n        10.00, # dissociation limit\n    ]\n\n    def calculate_sto_overlap(R_bohr: float, zeta: float) -> float:\n        \"\"\"\n        Calculates the overlap integral S between two 1s Slater-type orbitals\n        at a separation R.\n        \n        Args:\n            R_bohr: The internuclear distance in Bohr radii.\n            zeta: The exponent of the Slater-type orbital.\n\n        Returns:\n            The value of the overlap integral.\n        \"\"\"\n        zR = zeta * R_bohr\n        return np.exp(-zR) * (1.0 + zR + (zR**2) / 3.0)\n\n    results = []\n    for R_angstrom in test_cases:\n        # For RKS, the state is always a pure singlet, so <S^2> = 0.\n        s2_rks = 0.0\n\n        # Convert distance from Angstrom to Bohr\n        R_bohr = R_angstrom * BOHR_PER_ANGSTROM\n        \n        # Calculate interatomic overlap S(R)\n        s_R = calculate_sto_overlap(R_bohr, ZETA)\n\n        # Apply the decision rule for the UKS calculation\n        if s_R >= S_CRIT:\n            # Below the critical distance, the UKS solution collapses to the\n            # RKS singlet solution, which is spin-pure.\n            s2_uks = 0.0\n        else:\n            # Above the critical distance, a broken-symmetry solution appears.\n            # The spin contamination is given by 1 - S(R)^2.\n            s2_uks = 1.0 - s_R**2\n        \n        # Append the pair of results for the current distance\n        results.append([s2_rks, s2_uks])\n\n    # Format the final output string as specified\n    # e.g., [[0.000000,0.000000],[0.000000,0.516387],...]\n    output_str_parts = []\n    for pair in results:\n        formatted_pair = f\"[{pair[0]:.6f},{pair[1]:.6f}]\"\n        output_str_parts.append(formatted_pair)\n    \n    final_output = f\"[{','.join(output_str_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2451223"}]}