{"hands_on_practices": [{"introduction": "The Hartree-Fock (HF) method provides a foundational approximation in quantum chemistry but neglects the instantaneous correlation in electron motion. The energy it misses is known as the correlation energy. This practice introduces Full Configuration Interaction (FCI) as the theoretical gold standard, which provides the exact non-relativistic electronic energy within a given basis set. By calculating the difference between the FCI and HF energies, you will quantify this crucial correlation energy for a simple system [@problem_id:1978313].", "problem": "A computational chemist is investigating the electronic structure of a four-electron atom using a specific atomic orbital basis set. The first step involves a calculation using the Hartree-Fock (HF) method, an approximation that models electron-electron repulsion in an averaged, mean-field manner. This calculation yields a ground state energy of -39.727 hartrees.\n\nFor a more accurate benchmark, the chemist then performs a Full Configuration Interaction (Full CI) calculation using the same basis set. The Full CI method accounts for all possible electronic configurations and provides the exact non-relativistic electronic energy for the system within the chosen basis set. This more exhaustive calculation yields a ground state energy of -39.845 hartrees.\n\nCalculate the correlation energy captured by this basis set for the atom. Express your answer in units of hartrees, rounded to three significant figures.", "solution": "The correlation energy within a fixed basis is defined as the difference between the exact non-relativistic electronic energy in that basis and the Hartree-Fock mean-field energy. Using Full CI as the exact reference within the basis, this is\n$$\nE_{\\text{corr}} = E_{\\text{FCI}} - E_{\\text{HF}}.\n$$\nWith $E_{\\text{HF}} = -39.727$ hartrees and $E_{\\text{FCI}} = -39.845$ hartrees,\n$$\nE_{\\text{corr}} = (-39.845) - (-39.727) = -39.845 + 39.727 = -0.118 \\text{ hartrees}.\n$$\nRounded to three significant figures, the correlation energy is $-0.118$ in units of hartrees.", "answer": "$$\\boxed{-0.118}$$", "id": "1978313"}, {"introduction": "While FCI provides the exact solution, a critical question arises: why isn't it used for every problem? This exercise directly addresses the immense computational cost of FCI by asking you to calculate the number of Slater determinants required for a small system. This calculation provides a tangible understanding of the \"combinatorial explosion\" that makes FCI computationally intractable for all but the smallest molecules and basis sets, highlighting its role as a benchmark rather than a routine tool [@problem_id:2455906].", "problem": "Consider a nonrelativistic, spin-independent electronic Hamiltonian for a system of $N$ indistinguishable electrons expanded in an orthonormal set of spatial orbitals. In a full configuration interaction (FCI) calculation, the many-electron basis is taken as all distinct Slater determinants formed from spin orbitals constructed by pairing each spatial orbital with an $\\alpha$ or $\\beta$ spin function. \n\nYou are given a system with $N=4$ electrons and $M=8$ orthonormal spatial orbitals. Assume that each spatial orbital can host at most one electron of each spin, consistent with the Pauli exclusion principle, and that Slater determinants are constructed in the usual way from spin orbitals.\n\nRestrict attention to the subspace with total spin-projection quantum number $M_s=0$.\n\nProvide your answer as an exact integer with no units.", "solution": "The problem requires calculating the number of unique Slater determinants for a system of $N=4$ electrons distributed among $M=8$ spatial orbitals, with the constraint that the total spin projection is $M_s=0$.\n\nA spin orbital is a product of a spatial orbital $\\phi_i$ and a spin function, either $\\alpha$ (spin up) or $\\beta$ (spin down). With $M=8$ spatial orbitals, there are $2M=16$ available spin orbitals. A Slater determinant is constructed by selecting $N=4$ distinct spin orbitals from this set of $16$.\n\nThe total spin-projection quantum number, $M_s$, is the sum of the individual electron spin-projection quantum numbers, $m_s$. An electron in an $\\alpha$ spin state has $m_s = +\\frac{1}{2}$, and an electron in a $\\beta$ spin state has $m_s = -\\frac{1}{2}$. Let $N_\\alpha$ be the number of electrons with spin $\\alpha$ and $N_\\beta$ be the number of electrons with spin $\\beta$. The total spin projection is given by:\n$$M_s = N_\\alpha \\left(+\\frac{1}{2}\\right) + N_\\beta \\left(-\\frac{1}{2}\\right) = \\frac{1}{2}(N_\\alpha - N_\\beta)$$\nThe total number of electrons is $N=N_\\alpha+N_\\beta=4$. The problem specifies the constraint $M_s = 0$, which implies:\n$$\\frac{1}{2}(N_\\alpha - N_\\beta) = 0 \\implies N_\\alpha = N_\\beta$$\nSolving the system of two linear equations:\n\\begin{cases}\nN_\\alpha + N_\\beta = 4 \\\\\nN_\\alpha - N_\\beta = 0\n\\end{cases}\nyields $2N_\\alpha = 4$, so $N_\\alpha=2$, and consequently $N_\\beta=2$.\nThus, for any valid Slater determinant in the $M_s=0$ subspace, there must be exactly two electrons with spin $\\alpha$ and two electrons with spin $\\beta$.\n\nThe problem now reduces to a combinatorial calculation. We must determine the number of ways to independently place the $N_\\alpha=2$ alpha electrons and the $N_\\beta=2$ beta electrons into the available orbitals.\nFor the alpha electrons, we must choose $N_\\alpha=2$ distinct spatial orbitals out of the $M=8$ available. The Pauli exclusion principle is automatically satisfied for the set of alpha spin orbitals because we are choosing distinct spatial orbitals. The number of ways to do this is given by the binomial coefficient $\\binom{M}{N_\\alpha}$.\n$$ \\text{Number of ways for } \\alpha \\text{ electrons} = \\binom{8}{2} $$\nFor the beta electrons, we must similarly choose $N_\\beta=2$ distinct spatial orbitals out of the same $M=8$ available spatial orbitals. The number of ways to do this is given by $\\binom{M}{N_\\beta}$.\n$$ \\text{Number of ways for } \\beta \\text{ electrons} = \\binom{8}{2} $$\nSince the choice of spatial orbitals for the alpha electrons is independent of the choice for the beta electrons, the total number of distinct Slater determinants (configurations) is the product of these two numbers.\n$$ \\text{Total number of determinants} = \\binom{8}{2} \\times \\binom{8}{2} $$\nWe now calculate the value of the binomial coefficient:\n$$ \\binom{8}{2} = \\frac{8!}{2!(8-2)!} = \\frac{8!}{2!6!} = \\frac{8 \\times 7}{2 \\times 1} = 28 $$\nTherefore, the total number of distinct Slater determinants is:\n$$ \\text{Total number} = 28 \\times 28 = 784 $$\nThis is the size of the FCI matrix for the $M_s=0$ subspace of the specified system.", "answer": "$$\n\\boxed{784}\n$$", "id": "2455906"}, {"introduction": "An FCI calculation yields more than just an accurate energy; it provides a detailed picture of electron correlation through the many-electron wavefunction. This practice delves into interpreting this complex wavefunction by calculating natural orbital occupation numbers. You will see how, in a correlated picture, orbitals are no longer simply \"occupied\" (with an occupation of 2) or \"virtual\" (with an occupation of 0), but can have fractional occupations, quantitatively describing how electrons are excited out of the primary Hartree-Fock configuration [@problem_id:2455920].", "problem": "Consider a minimal-basis model for the Beryllium atom with a total of $N=4$ electrons occupying $M=4$ orthonormal spatial orbitals $\\{\\phi_1,\\phi_2,\\phi_3,\\phi_4\\}$. The many-electron wavefunction is given as a normalized linear combination of closed-shell Slater determinants, each determinant corresponding to two spatial orbitals that are doubly occupied (one electron of each spin). Let the spin-summed one-particle reduced density matrix $\\gamma$ be defined by\n$$\n\\gamma_{pq}=\\langle \\Psi \\lvert \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma} \\hat{a}_{q\\sigma} \\rvert \\Psi \\rangle,\n$$\nwhere $\\hat{a}^{\\dagger}_{p\\sigma}$ and $\\hat{a}_{q\\sigma}$ are fermionic creation and annihilation operators for spatial orbitals $p$ and $q$ with spin $\\sigma$, and $\\rvert \\Psi \\rangle$ is the given normalized wavefunction. The natural orbital occupation numbers are the eigenvalues of $\\gamma$ and lie in the interval $[0,2]$, summing to $N=4$.\n\nFor each test case below, the wavefunction is specified by a list of closed-shell determinants and real coefficients. Each determinant is represented by the unordered pair $\\{i,j\\}$ with $1 \\le i < j \\le M$, indicating that orbitals $\\phi_i$ and $\\phi_j$ are doubly occupied in that determinant. The wavefunction is\n$$\n\\rvert \\Psi \\rangle \\;=\\; \\sum_{k=1}^{K} c_k \\,\\rvert D_k \\rangle,\n$$\nwith $\\sum_{k=1}^{K} c_k^2 = 1$ and each $\\rvert D_k \\rangle$ a closed-shell determinant.\n\nYour task:\n- For each test case, construct the spin-summed one-particle reduced density matrix $\\gamma$ as defined above from the given $\\rvert \\Psi \\rangle$.\n- Compute the natural orbital occupation numbers as the eigenvalues of $\\gamma$.\n- Sort the occupation numbers in non-increasing order.\n- Report the sorted occupation numbers rounded to $6$ decimal places.\n\nNo physical units are involved. Angles do not appear. The output must be numeric.\n\nTest suite:\n- Test case $1$ (single-determinant closed shell):\n  - $M=4$, determinants: $\\{1,2\\}$ with coefficient $c_1=1$.\n- Test case $2$ (correlated superposition of pair-substitution determinants):\n  - $M=4$, determinants and coefficients:\n    - $\\{1,2\\}$ with $c_1=\\sqrt{\\tfrac{7}{10}}$,\n    - $\\{1,3\\}$ with $c_2=\\sqrt{\\tfrac{2}{10}}$,\n    - $\\{2,4\\}$ with $c_3=\\sqrt{\\tfrac{1}{10}}$.\n- Test case $3$ (edge case with maximal delocalization among two determinants):\n  - $M=4$, determinants and coefficients:\n    - $\\{1,2\\}$ with $c_1=\\tfrac{1}{\\sqrt{2}}$,\n    - $\\{3,4\\}$ with $c_2=\\tfrac{1}{\\sqrt{2}}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each item is the list of the rounded, sorted natural orbital occupation numbers for one test case. For example, the output format must be\n$[ [x_{1,1},x_{1,2},x_{1,3},x_{1,4}], [x_{2,1},x_{2,2},x_{2,3},x_{2,4}], [x_{3,1},x_{3,2},x_{3,3},x_{3,4}] ]$\nwith no additional text.", "solution": "The objective is to compute the natural orbital occupation numbers, which are the eigenvalues of the spin-summed one-particle reduced density matrix, $\\gamma$. The elements of this matrix are given by the expression:\n$$ \\gamma_{pq} = \\langle \\Psi \\lvert \\hat{E}_{pq} \\rvert \\Psi \\rangle $$\nwhere $\\hat{E}_{pq} = \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma} \\hat{a}_{q\\sigma}$ is the one-electron excitation operator from orbital $q$ to $p$. The wavefunction $\\rvert \\Psi \\rangle$ is a linear combination of closed-shell determinants:\n$$ \\rvert \\Psi \\rangle = \\sum_{k=1}^{K} c_k \\rvert D_k \\rangle $$\nSubstituting this into the expression for $\\gamma_{pq}$ yields:\n$$ \\gamma_{pq} = \\left\\langle \\sum_k c_k \\rvert D_k \\rangle \\left\\lvert \\hat{E}_{pq} \\right\\rvert \\sum_l c_l \\rvert D_l \\rangle \\right\\rangle = \\sum_{k,l} c_k c_l \\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_l \\rangle $$\nWe must now evaluate the matrix elements of the operator $\\hat{E}_{pq}$ between two closed-shell determinants, $\\rvert D_k \\rangle$ and $\\rvert D_l \\rangle$.\n\nA fundamental principle of quantum mechanics, encapsulated in the Slater-Condon rules, dictates the evaluation of matrix elements of one-body operators between Slater determinants. A one-body operator can only connect determinants that differ by at most one spin-orbital.\n\nIn this problem, all determinants $\\rvert D_k \\rangle$ are of the closed-shell type, meaning they are constructed by doubly occupying a set of spatial orbitals. Let $\\rvert D_k \\rangle$ correspond to the doubly occupied orbital set $O_k$, and $\\rvert D_l \\rangle$ to the set $O_l$.\nIf $O_k \\neq O_l$, the two sets must differ by at least one orbital. Since the determinants are closed-shell, for $\\rvert D_k \\rangle$ and $\\rvert D_l \\rangle$ to be different, they must differ by at least one pair of spin-orbitals (e.g., $\\{j\\alpha, j\\beta\\}$ in $O_k$ are replaced by $\\{m\\alpha, m\\beta\\}$ in $O_l$). This constitutes a two-electron difference. The one-body operator $\\hat{E}_{pq}$ cannot connect states that differ by two or more electrons. Therefore, its matrix element between two different closed-shell determinants is strictly zero.\n$$ \\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_l \\rangle = 0 \\quad \\text{for} \\quad k \\neq l $$\n\nThis crucial observation simplifies the expression for $\\gamma_{pq}$ considerably, as only terms where $k=l$ survive the summation:\n$$ \\gamma_{pq} = \\sum_k c_k^2 \\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_k \\rangle $$\n\nNow we analyze the remaining expectation value $\\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_k \\rangle$.\n- For the off-diagonal case, $p \\neq q$: The operator $\\hat{E}_{pq}$ attempts to annihilate an electron in orbital $q$ and create one in orbital $p$. This changes the electronic configuration. The resulting state is orthogonal to the original state $\\rvert D_k \\rangle$. Thus, the expectation value is zero.\n- For the diagonal case, $p=q$: The operator $\\hat{E}_{pp} = \\sum_{\\sigma} \\hat{a}^{\\dagger}_{p\\sigma} \\hat{a}_{p\\sigma}$ is the number operator for the spatial orbital $\\phi_p$. Its expectation value for the determinant $\\rvert D_k \\rangle$ is the occupation number of orbital $\\phi_p$ in that state. Since $\\rvert D_k \\rangle$ is a closed-shell determinant, this occupation number is $2$ if $\\phi_p$ is one of the occupied orbitals in $\\rvert D_k \\rangle$, and $0$ otherwise.\n\nCombining these facts, the elements of the 1-RDM are:\n$$ \\gamma_{pq} = \\delta_{pq} \\sum_k c_k^2 \\times \\begin{cases} 2 & \\text{if orbital } p \\text{ is occupied in } \\rvert D_k \\rangle \\\\ 0 & \\text{otherwise} \\end{cases} $$\nThis result demonstrates that for the specific form of the wavefunction given—a linear combination of only closed-shell determinants—the one-particle reduced density matrix $\\gamma$ is diagonal in the basis of the spatial orbitals $\\{\\phi_i\\}$.\n\nThe natural orbital occupation numbers are the eigenvalues of $\\gamma$. Since $\\gamma$ is a diagonal matrix, its eigenvalues are simply its diagonal elements, $\\gamma_{pp}$. Let $n_p$ be the occupation number of orbital $\\phi_p$. Then:\n$$ n_p = \\gamma_{pp} = 2 \\sum_{k \\text{ s.t. } p \\in O_k} c_k^2 $$\nwhere the sum runs over all determinants $\\rvert D_k \\rangle$ in which orbital $\\phi_p$ is occupied.\n\nThe algorithm to solve the problem is as follows:\n1. For each test case, initialize a vector of occupation numbers of size $M=4$ to all zeros.\n2. For each determinant-coefficient pair $(c_k, \\{i,j\\})$ in the wavefunction expansion:\n   a. Calculate the probability weight $c_k^2$.\n   b. Add $2 \\times c_k^2$ to the occupation numbers corresponding to orbitals $\\phi_i$ and $\\phi_j$.\n3. The resulting vector contains the natural orbital occupation numbers.\n4. Sort these numbers in non-increasing order and round to $6$ decimal places.\n\nThis procedure is applied to each test case.\n\n**Test Case 1:** $\\rvert\\Psi\\rangle = 1.0 \\cdot \\rvert D_{\\{1,2\\}} \\rangle$\n- $c_1=1.0$, $c_1^2=1.0$. Determinant involves orbitals $\\{1,2\\}$.\n- $n_1 = 2 \\times 1.0 = 2.0$\n- $n_2 = 2 \\times 1.0 = 2.0$\n- $n_3 = 0.0$\n- $n_4 = 0.0$\n- Sorted occupations: $[2.0, 2.0, 0.0, 0.0]$.\n\n**Test Case 2:** $\\rvert\\Psi\\rangle = \\sqrt{0.7} \\rvert D_{\\{1,2\\}} \\rangle + \\sqrt{0.2} \\rvert D_{\\{1,3\\}} \\rangle + \\sqrt{0.1} \\rvert D_{\\{2,4\\}} \\rangle$\n- $c_1^2=0.7$ for $\\{1,2\\}$; $c_2^2=0.2$ for $\\{1,3\\}$; $c_3^2=0.1$ for $\\{2,4\\}$.\n- $n_1 = 2 \\times c_1^2 + 2 \\times c_2^2 = 2 \\times 0.7 + 2 \\times 0.2 = 1.4 + 0.4 = 1.8$\n- $n_2 = 2 \\times c_1^2 + 2 \\times c_3^2 = 2 \\times 0.7 + 2 \\times 0.1 = 1.4 + 0.2 = 1.6$\n- $n_3 = 2 \\times c_2^2 = 2 \\times 0.2 = 0.4$\n- $n_4 = 2 \\times c_3^2 = 2 \\times 0.1 = 0.2$\n- Sorted occupations: $[1.8, 1.6, 0.4, 0.2]$. Sum is $4.0$.\n\n**Test Case 3:** $\\rvert\\Psi\\rangle = \\frac{1}{\\sqrt{2}} \\rvert D_{\\{1,2\\}} \\rangle + \\frac{1}{\\sqrt{2}} \\rvert D_{\\{3,4\\}} \\rangle$\n- $c_1^2=0.5$ for $\\{1,2\\}$; $c_2^2=0.5$ for $\\{3,4\\}$.\n- $n_1 = 2 \\times c_1^2 = 2 \\times 0.5 = 1.0$\n- $n_2 = 2 \\times c_1^2 = 2 \\times 0.5 = 1.0$\n- $n_3 = 2 \\times c_2^2 = 2 \\times 0.5 = 1.0$\n- $n_4 = 2 \\times c_2^2 = 2 \\times 0.5 = 1.0$\n- Sorted occupations: $[1.0, 1.0, 1.0, 1.0]$. Sum is $4.0$.\n\nThe reasoning is sound and the calculations are straightforward.", "answer": "[[2.000000, 2.000000, 0.000000, 0.000000], [1.800000, 1.600000, 0.400000, 0.200000], [1.000000, 1.000000, 1.000000, 1.000000]]", "id": "2455920"}]}