{"hands_on_practices": [{"introduction": "Understanding the optical properties of materials begins with understanding the nature of its excitons. This first practice uses a minimalist model to explore how the interaction between just two electron-hole pairs can give rise to distinct excitonic states [@problem_id:2463571]. By solving this simple $2 \\times 2$ problem analytically, you will discover the origin of 'bright' and 'dark' excitons and see firsthand how the exciton's wavefunction dictates its ability to interact with light.", "problem": "Consider a minimal Bethe-Salpeter equation (BSE) model for singlet excitons constructed in a basis of two independent interband transitions, denoted by $\\{|1\\rangle, |2\\rangle\\}$. Each transition has the same independent-particle excitation energy $\\Delta>0$. In this minimal model, the electron-hole screened direct interaction adds an identical diagonal shift $U$ to both transitions, and the electron-hole exchange interaction couples the transitions with a symmetric off-diagonal matrix element $X$. Thus, in the resonant particle-hole basis $\\{|1\\rangle, |2\\rangle\\}$, the excitonic Hamiltonian is a $2\\times 2$ real symmetric matrix\n$$\nH \\equiv \\begin{pmatrix}\n\\Delta + U & X \\\\\nX & \\Delta + U\n\\end{pmatrix}.\n$$\nThe excitonic eigenproblem is $H\\,\\boldsymbol{A}=\\Omega\\,\\boldsymbol{A}$, where $\\boldsymbol{A}=(A_{1},A_{2})^{\\mathsf{T}}$ are the expansion coefficients of the exciton in the chosen basis. The optical oscillator strength along a fixed polarization is proportional to the squared magnitude of the exciton transition dipole, which in this basis is $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}$, where $\\boldsymbol{t}=(t_{1},t_{2})$ collects the single-particle transition dipoles. Assume the two transitions have identical and collinear dipoles, i.e., $t_{1}=t_{2}=t$ with $t\\neq 0$. A “dark” exciton state is defined as one with zero oscillator strength, i.e., $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}=0$.\n\nUnder these conditions, determine the exciton energy $\\Omega_{\\mathrm{d}}$ of the dark state as a closed-form expression in terms of $\\Delta$, $U$, and $X$. Express your final answer as a single analytic expression. No numerical rounding is required, and no units are needed.", "solution": "The problem statement will first be subjected to a rigorous validation process.\n\nStep 1: Extract Givens.\nThe givens are as follows:\n- A minimal Bethe-Salpeter equation (BSE) model for singlet excitons.\n- The basis consists of two independent interband transitions: $\\{|1\\rangle, |2\\rangle\\}$.\n- Independent-particle excitation energy for both transitions: $\\Delta > 0$.\n- Screened direct interaction (diagonal shift): $U$.\n- Electron-hole exchange interaction (off-diagonal coupling): $X$.\n- The excitonic Hamiltonian is a $2\\times 2$ real symmetric matrix:\n$$\nH = \\begin{pmatrix}\n\\Delta + U & X \\\\\nX & \\Delta + U\n\\end{pmatrix}\n$$\n- The excitonic eigenproblem is $H\\,\\boldsymbol{A}=\\Omega\\,\\boldsymbol{A}$.\n- The exciton eigenvector is $\\boldsymbol{A}=(A_{1},A_{2})^{\\mathsf{T}}$.\n- The transition dipole vector is $\\boldsymbol{t}=(t_{1},t_{2})$.\n- The condition on the dipoles is $t_{1}=t_{2}=t$ with $t\\neq 0$.\n- A \"dark\" exciton state is defined as one with zero oscillator strength, which corresponds to the condition $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}=0$.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is subjected to validation against the established criteria.\n- **Scientifically Grounded**: The problem describes a simplified but standard model of an exciton in a two-level system using the BSE formalism. The Hamiltonian represents a common scenario of two degenerate states coupled by an interaction. This is a fundamental concept in quantum mechanics and solid-state physics. The problem is scientifically sound.\n- **Well-Posed**: The problem is presented as a standard eigenvalue problem for a $2\\times 2$ symmetric matrix, which is always solvable. The condition for a \"dark\" state is mathematically precise. The problem is well-posed and has a unique solution for the energy of the dark state.\n- **Objective**: The language is precise and quantitative. All terms are defined within the context of theoretical physics. There are no subjective or ambiguous statements.\n- The problem is self-contained, consistent, and provides all necessary information to arrive at a solution.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. It is a standard exercise in quantum mechanics. A complete solution will be provided.\n\nThe energy eigenvalues $\\Omega$ and corresponding eigenvectors $\\boldsymbol{A}$ of the exciton are determined by solving the time-independent Schrödinger equation, which in matrix form is the eigenproblem $H\\boldsymbol{A} = \\Omega\\boldsymbol{A}$. The eigenvalues are found by solving the characteristic equation $\\det(H - \\Omega I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\det\\begin{pmatrix} \\Delta + U - \\Omega & X \\\\ X & \\Delta + U - \\Omega \\end{pmatrix} = 0\n$$\nExpanding the determinant gives the secular equation:\n$$\n(\\Delta + U - \\Omega)^{2} - X^{2} = 0\n$$\nThis equation is solved for $\\Omega$:\n$$\n\\Delta + U - \\Omega = \\pm X\n$$\n$$\n\\Omega = \\Delta + U \\mp X\n$$\nThis yields two distinct energy eigenvalues for the exciton states, provided $X\\neq 0$:\n$$\n\\Omega_{1} = \\Delta + U - X\n$$\n$$\n\\Omega_{2} = \\Delta + U + X\n$$\nNext, we determine the eigenvectors corresponding to each eigenvalue.\n\nFor the eigenvalue $\\Omega_{1} = \\Delta + U - X$, the eigenvector $\\boldsymbol{A}_{1} = (A_{1,1}, A_{1,2})^{\\mathsf{T}}$ is found by solving:\n$$\n\\begin{pmatrix} \\Delta + U & X \\\\ X & \\Delta + U \\end{pmatrix} \\begin{pmatrix} A_{1,1} \\\\ A_{1,2} \\end{pmatrix} = (\\Delta + U - X) \\begin{pmatrix} A_{1,1} \\\\ A_{1,2} \\end{pmatrix}\n$$\nThis gives the system of linear equations:\n$$\n(\\Delta + U)A_{1,1} + X A_{1,2} = (\\Delta + U - X)A_{1,1}\n$$\nSimplifying the equation, we obtain:\n$$\nX A_{1,1} + X A_{1,2} = 0\n$$\n$$\nX(A_{1,1} + A_{1,2}) = 0\n$$\nAssuming the coupling $X$ is non-zero (otherwise the states are trivially degenerate and uncoupled, a case we can address later), this implies $A_{1,1} = -A_{1,2}$. The unnormalized eigenvector is proportional to $(1, -1)^{\\mathsf{T}}$.\n\nFor the eigenvalue $\\Omega_{2} = \\Delta + U + X$, the eigenvector $\\boldsymbol{A}_{2} = (A_{2,1}, A_{2,2})^{\\mathsf{T}}$ is found by solving:\n$$\n\\begin{pmatrix} \\Delta + U & X \\\\ X & \\Delta + U \\end{pmatrix} \\begin{pmatrix} A_{2,1} \\\\ A_{2,2} \\end{pmatrix} = (\\Delta + U + X) \\begin{pmatrix} A_{2,1} \\\\ A_{2,2} \\end{pmatrix}\n$$\nThis gives the equation:\n$$\n(\\Delta + U)A_{2,1} + X A_{2,2} = (\\Delta + U + X)A_{2,1}\n$$\nSimplifying, we have:\n$$\n-X A_{2,1} + X A_{2,2} = 0\n$$\n$$\nX(-A_{2,1} + A_{2,2}) = 0\n$$\nAgain, assuming $X \\neq 0$, this implies $A_{2,1} = A_{2,2}$. The unnormalized eigenvector is proportional to $(1, 1)^{\\mathsf{T}}$.\n\nNow, we must identify the \"dark\" state. A state is dark if its oscillator strength is zero. The oscillator strength is proportional to $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}$, where $\\boldsymbol{t} = (t_{1}, t_{2})$. We are given that $t_{1} = t_{2} = t$ and $t \\neq 0$. Thus, $\\boldsymbol{t} = (t, t)$.\nThe condition for a dark state is $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}=0$, which is equivalent to $\\boldsymbol{t}\\cdot \\boldsymbol{A}=0$.\n$$\n\\boldsymbol{t}\\cdot \\boldsymbol{A} = (t, t) \\cdot \\begin{pmatrix} A_{1} \\\\ A_{2} \\end{pmatrix} = tA_{1} + tA_{2} = t(A_{1} + A_{2}) = 0\n$$\nSince $t \\neq 0$, the condition for a dark state simplifies to:\n$$\nA_{1} + A_{2} = 0\n$$\nWe check this condition for the two eigenvectors we found.\n- For the state with energy $\\Omega_{1} = \\Delta + U - X$, the eigenvector components satisfy $A_{1,1} = -A_{1,2}$. Thus, $A_{1,1} + A_{1,2} = -A_{1,2} + A_{1,2} = 0$. This condition is met. This state is the dark exciton.\n- For the state with energy $\\Omega_{2} = \\Delta + U + X$, the eigenvector components satisfy $A_{2,1} = A_{2,2}$. Thus, $A_{2,1} + A_{2,2} = A_{2,2} + A_{2,2} = 2A_{2,2}$. This is zero only if $A_{2,2}=0$, which would mean the eigenvector is the null vector, which is not a valid physical state. Therefore, this state is not dark; it is \"bright\".\n\nThe energy of the dark state, $\\Omega_{\\mathrm{d}}$, is the eigenvalue corresponding to the eigenvector that satisfies the dark state condition. This is $\\Omega_{1}$.\nTherefore, the exciton energy of the dark state is:\n$$\n\\Omega_{\\mathrm{d}} = \\Delta + U - X\n$$\nIf we consider the case where $X=0$, the Hamiltonian is diagonal, $H = (\\Delta+U)I$. Any vector is an eigenvector with the degenerate energy $\\Omega = \\Delta+U$. We can still form the \"symmetric\" and \"antisymmetric\" combinations of the basis states. The state with eigenvector proportional to $(1, -1)^{\\mathsf{T}}$ is dark and has energy $\\Delta+U$. Our formula gives $\\Omega_{\\mathrm{d}} = \\Delta+U-0 = \\Delta+U$, so it remains correct.\nThe final answer is the derived analytical expression for the energy of the dark exciton.", "answer": "$$\n\\boxed{\\Delta + U - X}\n$$", "id": "2463571"}, {"introduction": "Real excitons are rarely simple combinations of two states; they are complex superpositions of many electron-hole configurations. In this exercise, you will write a program to construct and diagonalize a more general Bethe-Salpeter Hamiltonian [@problem_id:2463513]. The main goal is to analyze the resulting exciton wavefunction by calculating the 'weight' of each constituent transition, providing a quantitative understanding of the exciton's character.", "problem": "Consider the lowest-energy neutral excitation (exciton) in a simple diatomic molecule within the framework of the Bethe-Salpeter equation (BSE). In the Tamm-Dancoff approximation (TDA), the exciton is expanded in a basis of single-particle electron-hole transitions (valence-to-conduction), indexed by an integer label. Let there be $N$ such transitions, with independent-particle transition energies $\\Delta_i$ in electronvolts (eV) for $i \\in \\{0,1,\\dots,N-1\\}$. Let $K_{ij}$ in electronvolts (eV) be the static screened electron-hole interaction kernel (assumed real and symmetric). Define the excitonic Hamiltonian matrix $H$ with elements\n$$\nH_{ij} = \\Delta_i \\delta_{ij} + K_{ij},\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. The exciton energies $\\Omega$ and amplitudes $A_i$ are obtained from the eigenvalue problem\n$$\n\\sum_{j=0}^{N-1} H_{ij} A_j = \\Omega A_i.\n$$\nFor the lowest-energy exciton (the eigenvector corresponding to the smallest eigenvalue), define the contribution (weight) of transition $i$ to the exciton wavefunction as\n$$\nw_i = \\frac{|A_i|^2}{\\sum_{j=0}^{N-1} |A_j|^2},\n$$\nwhich is dimensionless and satisfies $\\sum_{i=0}^{N-1} w_i = 1$.\n\nYour task is to compute, for each test case below, the list of weights $[w_0, w_1, \\dots, w_{N-1}]$ corresponding to the lowest-energy exciton. All energies must be treated in electronvolts, but the requested outputs (the weights) are dimensionless numbers. Each weight must be reported rounded to six decimal places as a decimal number.\n\nTest Suite (each case specifies $N$, the vector $\\Delta$ in electronvolts, and the matrix $K$ in electronvolts):\n- Case $1$: $N = 1$, $\\Delta = [\\,2.0\\,]$ eV, $K = \\begin{bmatrix} -0.4 \\end{bmatrix}$ eV.\n- Case $2$: $N = 2$, $\\Delta = [\\,2.0,\\,2.3\\,]$ eV, $K = \\begin{bmatrix} -0.5 & 0.0 \\\\ 0.0 & -0.2 \\end{bmatrix}$ eV.\n- Case $3$: $N = 2$, $\\Delta = [\\,2.1,\\,2.2\\,]$ eV, $K = \\begin{bmatrix} -0.4 & -0.05 \\\\ -0.05 & -0.3 \\end{bmatrix}$ eV.\n- Case $4$: $N = 3$, $\\Delta = [\\,2.5,\\,2.5,\\,2.5\\,]$ eV, $K$ has all diagonal entries $-0.3$ and all off-diagonal entries $-0.05$ eV, i.e., $K = \\begin{bmatrix} -0.3 & -0.05 & -0.05 \\\\ -0.05 & -0.3 & -0.05 \\\\ -0.05 & -0.05 & -0.3 \\end{bmatrix}$ eV.\n- Case $5$: $N = 2$, $\\Delta = [\\,2.0,\\,2.0\\,]$ eV, $K = \\begin{bmatrix} -0.3 & 0.2 \\\\ 0.2 & -0.3 \\end{bmatrix}$ eV.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each result must itself be a list of the weights in the order of the input transitions for that case, with each weight rounded to six decimal places. For example, a valid overall output could look like $[[\\,\\dots\\,],[\\,\\dots\\,],\\dots]$ with no extra text.", "solution": "The problem statement is critically examined and found to be valid. It is scientifically grounded in the principles of quantum mechanics as applied to computational chemistry and condensed matter physics, specifically the theory of excitons. The formulation adheres to the standard Bethe-Salpeter equation within the Tamm-Dancoff approximation (BSE/TDA). The problem is well-posed, providing all necessary parameters and definitions for a unique solution to be determined via standard methods of linear algebra.\n\nThe task is to find the weights $w_i$ of each electron-hole pair transition for the lowest-energy exciton. This requires solving the eigenvalue problem for the excitonic Hamiltonian matrix $H$. The procedure for each test case is as follows.\n\n1.  **Construction of the Excitonic Hamiltonian $H$**: The Hamiltonian matrix $H$ of size $N \\times N$ is constructed based on the given independent-particle transition energies $\\Delta_i$ and the electron-hole interaction kernel $K_{ij}$. The elements of $H$ are given by the formula:\n    $$\n    H_{ij} = \\Delta_i \\delta_{ij} + K_{ij}\n    $$\n    Here, $\\delta_{ij}$ is the Kronecker delta, which is $1$ if $i=j$ and $0$ otherwise. This means the diagonal elements of $H$ are $H_{ii} = \\Delta_i + K_{ii}$, and the off-diagonal elements are $H_{ij} = K_{ij}$ for $i \\neq j$. Both $\\Delta$ and $K$ are given in units of electronvolts (eV), so the resulting Hamiltonian $H$ also has units of eV. Since $K$ is stipulated to be real and symmetric, and the diagonal matrix formed from the vector $\\Delta$ is also real and symmetric, $H$ is a real, symmetric matrix.\n\n2.  **Solution of the Eigenvalue Problem**: We must solve the eigenvalue equation for the exciton energies $\\Omega$ (the eigenvalues) and the exciton amplitudes $A$ (the eigenvectors):\n    $$\n    H A = \\Omega A\n    $$\n    For a real symmetric matrix $H$ of size $N \\times N$, there exist $N$ real eigenvalues $\\Omega_k$ and a corresponding set of $N$ mutually orthogonal eigenvectors $A^{(k)}$, for $k \\in \\{0, 1, \\dots, N-1\\}$. We are interested in the lowest-energy exciton, which corresponds to the smallest eigenvalue, $\\Omega_{\\text{min}} = \\min_k\\{\\Omega_k\\}$. Let the eigenvector corresponding to $\\Omega_{\\text{min}}$ be $A = (A_0, A_1, \\dots, A_{N-1})^T$. Standard numerical algorithms, such as those implemented in `numpy.linalg.eigh`, are employed to find the eigenvalues and eigenvectors. These algorithms return eigenvalues in ascending order and the corresponding eigenvectors as columns of a matrix. The eigenvectors are also guaranteed to be normalized.\n\n3.  **Calculation of Transition Weights $w_i$**: The contribution, or weight $w_i$, of the $i$-th electron-hole transition to this lowest-energy exciton is defined as the squared magnitude of the corresponding component of the normalized eigenvector:\n    $$\n    w_i = \\frac{|A_i|^2}{\\sum_{j=0}^{N-1} |A_j|^2}\n    $$\n    If the eigenvector $A$ is normalized such that $\\sum_{j=0}^{N-1} |A_j|^2 = 1$, which is the case for the output of standard numerical libraries, this simplifies to:\n    $$\n    w_i = |A_i|^2\n    $$\n    Since $H$ is a real matrix, the eigenvectors $A_i$ can be chosen to be real, and thus $w_i = A_i^2$. The set of weights $\\{w_i\\}$ for $i \\in \\{0, 1, \\dots, N-1\\}$ forms a probability distribution, satisfying $\\sum_i w_i = 1$. The final step involves computing these weights for each test case and rounding the results to six decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the BSE/TDA eigenvalue problem for several test cases to find\n    the weights of the constituent transitions for the lowest-energy exciton.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"N\": 1,\n            \"delta\": np.array([2.0]),\n            \"K\": np.array([[-0.4]])\n        },\n        {\n            \"N\": 2,\n            \"delta\": np.array([2.0, 2.3]),\n            \"K\": np.array([[-0.5, 0.0], [0.0, -0.2]])\n        },\n        {\n            \"N\": 2,\n            \"delta\": np.array([2.1, 2.2]),\n            \"K\": np.array([[-0.4, -0.05], [-0.05, -0.3]])\n        },\n        {\n            \"N\": 3,\n            \"delta\": np.array([2.5, 2.5, 2.5]),\n            \"K\": np.array([[-0.3, -0.05, -0.05], [-0.05, -0.3, -0.05], [-0.05, -0.05, -0.3]])\n        },\n        {\n            \"N\": 2,\n            \"delta\": np.array([2.0, 2.0]),\n            \"K\": np.array([[-0.3, 0.2], [0.2, -0.3]])\n        }\n    ]\n\n    results_str = []\n    for case in test_cases:\n        delta = case[\"delta\"]\n        K = case[\"K\"]\n\n        # 1. Construct the Hamiltonian matrix H.\n        # H_ij = Delta_i * delta_ij + K_ij\n        H = np.diag(delta) + K\n\n        # 2. Solve the eigenvalue problem.\n        # H is real and symmetric, so use eigh for efficiency and stability.\n        # eigh returns eigenvalues in ascending order and corresponding normalized eigenvectors as columns.\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n\n        # 3. Identify the eigenvector for the lowest-energy exciton.\n        # This is the first column of the eigenvectors matrix, corresponding to the smallest eigenvalue.\n        lowest_energy_eigenvector = eigenvectors[:, 0]\n\n        # 4. Calculate the weights.\n        # w_i = |A_i|^2. Since the eigenvector is normalized, sum(|A_i|^2) = 1.\n        weights = np.square(lowest_energy_eigenvector)\n\n        # 5. Format the output for this case.\n        # The output format is a string like '[w0,w1,...]' without spaces.\n        case_result_str = f\"[{','.join([f'{w:.6f}' for w in weights])}]\"\n        results_str.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    # The output is a string representation of a list of lists of weights,\n    # for example: [[w0,w1],[w0,w1,w2],...]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```", "id": "2463513"}, {"introduction": "A critical aspect of computational science is understanding the relationship between accuracy and computational cost. This final practice addresses the fundamental issue of basis set convergence in BSE calculations [@problem_id:2463564]. You will write a program to investigate how the calculated exciton binding energy changes as you include more basis functions, learning how to determine the point at which your result is 'converged' and trustworthy.", "problem": "You are asked to design and implement a program that quantifies the convergence of the exciton binding energy in a simplified Bethe–Salpeter Equation (BSE) model as a function of the number of empty (conduction) bands included. Work within the Tamm–Dancoff approximation (resonant block only) and use a minimal, physically consistent model constructed from first principles.\n\nStart from the following fundamental base: in many-body perturbation theory, electron–hole excitations in an insulator or semiconductor can be modeled as eigenstates of an effective two-particle Hamiltonian whose resonant block is the sum of an independent-particle part and an attractive screened interaction kernel. In a finite basis of transitions from occupied (valence) bands to unoccupied (conduction) bands, adding more conduction bands expands the variational space and can only lower the ground-state eigenvalue by the Rayleigh–Ritz variational principle. The exciton binding energy is defined as the difference between the independent-particle gap and the lowest exciton energy.\n\nModel the resonant BSE Hamiltonian in a transition basis labeled by an index $i \\in \\{0,1,\\dots,N-1\\}$, where $N$ is the number of included conduction bands. Let the independent-particle transition energies be\n$$\n\\Omega_i = E_{\\mathrm{g}} + i\\,\\Delta_{\\mathrm{c}},\n$$\nwith $E_{\\mathrm{g}}$ the independent-particle band gap and $\\Delta_{\\mathrm{c}}$ the energy spacing between successive conduction states. Use a rank-one, attractive, separable screened interaction kernel,\n$$\nK_{ij} = -\\alpha\\,u_i\\,u_j,\\quad\\text{with}\\quad u_i = (i+1)^{-p/2},\n$$\nwhere $\\alpha$ is a positive coupling strength and $p$ is a dimensionless exponent controlling the decay of couplings with transition index. The Hamiltonian matrix is then\n$$\nH^{(N)}_{ij} = \\delta_{ij}\\,\\Omega_i + K_{ij}.\n$$\nFor a given $N$, define the lowest exciton energy as the smallest eigenvalue $E_0^{(N)}$ of $H^{(N)}$, and the exciton binding energy as\n$$\nE_{\\mathrm{bind}}^{(N)} = E_{\\mathrm{g}} - E_0^{(N)}.\n$$\nBy construction, $E_{\\mathrm{bind}}^{(N)} \\ge 0$. As $N$ increases, $E_{\\mathrm{bind}}^{(N)}$ should be non-decreasing and approach a finite limit in this model.\n\nYour task is to implement a program that:\n1. For each parameter set in the test suite below, evaluates $E_{\\mathrm{bind}}^{(N)}$ for a monotone increasing sequence of $N$ values.\n2. Determines the smallest $N$ (denote it $N_{\\star}$) at which the absolute change in binding energy with respect to the previous $N$ in the sequence is less than a prescribed tolerance $\\tau$, that is,\n$$\n\\left|E_{\\mathrm{bind}}^{(N)} - E_{\\mathrm{bind}}^{(N_{\\mathrm{prev}})}\\right| < \\tau,\n$$\nwhere $N_{\\mathrm{prev}}$ is the immediately preceding value of $N$ in the sequence.\n3. If no such $N$ exists within the provided sequence, report $N_{\\star} = -1$.\n4. Reports, in addition to $N_{\\star}$, the binding energy computed at the largest $N$ in the sequence, $E_{\\mathrm{bind}}^{(N_{\\max})}$.\n\nAll energies must be expressed in electronvolts (eV). Your program must output floating-point energies in eV. For each test case, round the reported $E_{\\mathrm{bind}}^{(N_{\\max})}$ to $6$ decimal places.\n\nTest suite. For each case, use the provided sequence of $N$ values and tolerance $\\tau$:\n- Case A: $E_{\\mathrm{g}} = 1.50$ eV, $\\Delta_{\\mathrm{c}} = 0.50$ eV, $\\alpha = 0.20$ eV, $p = 1.0$, $N \\in \\{1,2,4,8,16,32,64,128\\}$, $\\tau = 1.0\\times 10^{-3}$ eV.\n- Case B: $E_{\\mathrm{g}} = 2.00$ eV, $\\Delta_{\\mathrm{c}} = 0.30$ eV, $\\alpha = 0.05$ eV, $p = 1.0$, $N \\in \\{1,2,4,8,16,32,64\\}$, $\\tau = 5.0\\times 10^{-4}$ eV.\n- Case C: $E_{\\mathrm{g}} = 1.00$ eV, $\\Delta_{\\mathrm{c}} = 0.10$ eV, $\\alpha = 0.35$ eV, $p = 0.8$, $N \\in \\{1,2,4,8,16,32,64,128,256\\}$, $\\tau = 1.0\\times 10^{-3}$ eV.\n- Case D: $E_{\\mathrm{g}} = 1.80$ eV, $\\Delta_{\\mathrm{c}} = 0.05$ eV, $\\alpha = 0.30$ eV, $p = 1.2$, $N \\in \\{1,2,4,8,16,32\\}$, $\\tau = 1.0\\times 10^{-4}$ eV.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element must itself be a two-element bracketed list with no spaces, containing $N_{\\star}$ (an integer) and the value of $E_{\\mathrm{bind}}^{(N_{\\max})}$ (a float in eV with six digits after the decimal point). For example:\n\"[[-1,0.123456],[8,0.045678],...]\".", "solution": "The problem posed is to determine the convergence behavior of the exciton binding energy within a simplified Bethe-Salpeter Equation (BSE) model. This requires calculating the binding energy for an increasing number of basis functions and identifying the point at which the energy converges within a given tolerance. The model and parameters are physically reasonable and mathematically well-defined, rendering the problem valid.\n\nThe core of the problem lies in finding the lowest eigenvalue of the excitonic Hamiltonian, which, within the Tamm-Dancoff approximation, is given for an $N$-dimensional basis as:\n$$\nH^{(N)}_{ij} = \\delta_{ij} \\Omega_i + K_{ij}\n$$\nHere, $\\delta_{ij}$ is the Kronecker delta, $\\Omega_i = E_{\\mathrm{g}} + i\\,\\Delta_{\\mathrm{c}}$ are the independent-particle transition energies for an excitation to the $i$-th conduction band ($i \\in \\{0, 1, \\dots, N-1\\}$), and $K_{ij} = -\\alpha\\,u_i\\,u_j$ is the screened electron-hole interaction kernel. The terms $E_{\\mathrm{g}}$, $\\Delta_{\\mathrm{c}}$, and $\\alpha$ are the band gap, conduction band spacing, and coupling strength, respectively. The coupling form factors are $u_i = (i+1)^{-p/2}$. The Hamiltonian can be written as the sum of a diagonal matrix $D^{(N)}$ of the transition energies $\\Omega_i$ and a rank-one interaction matrix $K^{(N)} = -\\alpha \\mathbf{u}\\mathbf{u}^T$, where $\\mathbf{u}$ is a column vector with elements $u_i$.\n\nThe exciton energies $E$ are the eigenvalues of $H^{(N)}$. For a rank-one perturbation of a diagonal matrix, the eigenvalues can be found by solving a secular equation rather than the full characteristic polynomial. The eigenvalue equation $H^{(N)}\\mathbf{v} = E\\mathbf{v}$ can be written as:\n$$\n(D^{(N)} - E I) \\mathbf{v} = \\alpha (\\mathbf{u}^T \\mathbf{v}) \\mathbf{u}\n$$\nAssuming $E$ is not one of the independent-particle energies $\\Omega_i$, we can invert $(D^{(N)} - E I)$ to get:\n$$\n\\mathbf{v} = \\alpha (\\mathbf{u}^T \\mathbf{v}) (D^{(N)} - E I)^{-1} \\mathbf{u}\n$$\nFor a non-trivial eigenvector $\\mathbf{v}$, we must have $\\mathbf{u}^T \\mathbf{v} \\neq 0$. Multiplying from the left by $\\mathbf{u}^T$ and dividing by the scalar $\\mathbf{u}^T \\mathbf{v}$ yields the secular equation for the eigenvalues $E$:\n$$\n1 = \\alpha \\sum_{i=0}^{N-1} \\frac{u_i^2}{\\Omega_i - E}\n$$\nThe lowest eigenvalue, $E_0^{(N)}$, corresponds to the bound exciton state. This eigenvalue is guaranteed to be less than the smallest independent-particle energy, $\\Omega_0 = E_{\\mathrm{g}}$. The exciton binding energy is defined as the energy reduction from the gap edge, $E_{\\mathrm{bind}}^{(N)} = E_{\\mathrm{g}} - E_0^{(N)}$. Let $X = E_{\\mathrm{bind}}^{(N)}$. Substituting $E_0^{(N)} = E_{\\mathrm{g}} - X$ into the secular equation gives an equation for the binding energy itself:\n$$\n\\frac{1}{\\alpha} = \\sum_{i=0}^{N-1} \\frac{(i+1)^{-p}}{i\\Delta_{\\mathrm{c}} + X}\n$$\nThis equation could be solved for $X$ using a numerical root-finding algorithm. However, given that the maximum value of $N$ is $256$, a more direct and robust numerical approach is to construct the $N \\times N$ matrix $H^{(N)}$ and find its eigenvalues using a standard linear algebra library. This method is less susceptible to issues related to bracket selection or slow convergence in root-finding.\n\nThe computational procedure for each test case is as follows:\n1. Initialize variables: $E_{\\text{bind}}^{\\text{prev}} = 0.0$, $N_{\\star} = -1$, and a list to hold the final results.\n2. Iterate through the prescribed sequence of basis sizes $\\{N_1, N_2, \\dots, N_{\\max}\\}$.\n3. For each $N$ in the sequence:\n   a. Construct the $N \\times N$ real symmetric Hamiltonian matrix $H^{(N)}$. The diagonal elements are $H^{(N)}_{ii} = E_{\\mathrm{g}} + i\\Delta_{\\mathrm{c}}$, and the off-diagonal elements are $H^{(N)}_{ij} = -\\alpha (i+1)^{-p/2} (j+1)^{-p/2}$.\n   b. Compute the eigenvalues of $H^{(N)}$ using a numerically stable algorithm, such as one provided by NumPy for symmetric matrices. The eigenvalues are real, and we are interested in the smallest one, $E_0^{(N)}$.\n   c. Calculate the binding energy $E_{\\mathrm{bind}}^{(N)} = E_{\\mathrm{g}} - E_0^{(N)}$.\n   d. For $N > N_1$, check the convergence criterion: if $|E_{\\mathrm{bind}}^{(N)} - E_{\\text{bind}}^{\\text{prev}}| < \\tau$ and $N_{\\star}$ has not yet been assigned, set $N_{\\star} = N$.\n   e. Update $E_{\\text{bind}}^{\\text{prev}} = E_{\\mathrm{bind}}^{(N)}$.\n4. After the loop, the final binding energy $E_{\\mathrm{bind}}^{(N_{\\max})}$ is the value computed for the largest $N$ in the sequence.\n5. The result for the test case is the pair $[N_{\\star}, E_{\\mathrm{bind}}^{(N_{\\max})}]$, where the energy is rounded to six decimal places.\n\nThis procedure is systematically applied to all provided test cases to produce the final output.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the BSE convergence problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A\n        {'Eg': 1.50, 'delta_c': 0.50, 'alpha': 0.20, 'p': 1.0, \n         'N_values': [1, 2, 4, 8, 16, 32, 64, 128], 'tau': 1.0e-3},\n        # Case B\n        {'Eg': 2.00, 'delta_c': 0.30, 'alpha': 0.05, 'p': 1.0, \n         'N_values': [1, 2, 4, 8, 16, 32, 64], 'tau': 5.0e-4},\n        # Case C\n        {'Eg': 1.00, 'delta_c': 0.10, 'alpha': 0.35, 'p': 0.8, \n         'N_values': [1, 2, 4, 8, 16, 32, 64, 128, 256], 'tau': 1.0e-3},\n        # Case D\n        {'Eg': 1.80, 'delta_c': 0.05, 'alpha': 0.30, 'p': 1.2, \n         'N_values': [1, 2, 4, 8, 16, 32], 'tau': 1.0e-4},\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = compute_convergence_for_case(**params)\n        all_results.append(result)\n\n    # Format the final output string as specified in the problem.\n    # e.g., \"[[N_star1,E_bind1],[N_star2,E_bind2],...]\"\n    result_strings = [f\"[{res[0]},{res[1]:.6f}]\" for res in all_results]\n    print(f\"[{','.join(result_strings)}]\")\n\ndef compute_convergence_for_case(Eg, delta_c, alpha, p, N_values, tau):\n    \"\"\"\n    Computes N_star and E_bind_Nmax for a single parameter set.\n\n    Args:\n        Eg (float): Independent-particle band gap in eV.\n        delta_c (float): Energy spacing of conduction states in eV.\n        alpha (float): Coupling strength in eV.\n        p (float): Dimensionless exponent for coupling decay.\n        N_values (list[int]): Sequence of numbers of conduction bands to include.\n        tau (float): Convergence tolerance in eV.\n\n    Returns:\n        tuple[int, float]: A tuple containing N_star and the binding energy at N_max.\n    \"\"\"\n    N_star = -1\n    E_bind_prev = 0.0\n    E_bind_Nmax = 0.0\n\n    for i, N in enumerate(N_values):\n        # Construct the BSE Hamiltonian matrix H(N).\n        \n        # indices for transitions, i -> 0, 1, ..., N-1\n        indices = np.arange(N, dtype=np.float64)\n\n        # Diagonal part: independent-particle transition energies Omega_i\n        # D_ii = E_g + i * delta_c\n        D = np.diag(Eg + indices * delta_c)\n\n        # Interaction kernel part: K_ij = -alpha * u_i * u_j\n        # u_i = (i+1)^(-p/2)\n        u_vec = (indices + 1.0)**(-p / 2.0)\n        K = -alpha * np.outer(u_vec, u_vec)\n\n        # Full Hamiltonian H = D + K\n        H = D + K\n\n        # Find the eigenvalues. eigh returns sorted eigenvalues for a symmetric matrix.\n        eigenvalues = np.linalg.eigh(H)[0]\n        E0_N = eigenvalues[0]  # The lowest eigenvalue\n\n        # Calculate the exciton binding energy\n        E_bind_N = Eg - E0_N\n\n        # Check for convergence after the first step\n        if i > 0:\n            abs_change = np.abs(E_bind_N - E_bind_prev)\n            if abs_change  tau and N_star == -1:\n                N_star = N\n        \n        E_bind_prev = E_bind_N\n\n    # The final binding energy is the one for the largest N in the sequence\n    E_bind_Nmax = E_bind_N\n\n    return N_star, E_bind_Nmax\n\nsolve()\n```", "id": "2463564"}]}