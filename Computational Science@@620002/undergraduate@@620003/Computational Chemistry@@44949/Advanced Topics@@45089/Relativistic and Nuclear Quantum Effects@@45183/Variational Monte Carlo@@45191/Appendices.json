{"hands_on_practices": [{"introduction": "This exercise serves as a fundamental introduction to the mechanics of the variational principle. By working through the hydrogen atom—a cornerstone of quantum mechanics—you will analytically derive the local energy and variational energy from first principles, and then use optimization to find the best possible energy for the given trial wavefunction. This foundational practice [@problem_id:2828337] solidifies the connection between the abstract Hamiltonian operator $\\hat{H}$ and a tangible energy calculation.", "problem": "In Variational Monte Carlo (VMC) and Diffusion Monte Carlo (DMC) for electronic structure, the local energy is defined for a trial wavefunction $\\Psi_{T}(\\mathbf{R})$ by $E_{L}(\\mathbf{R}) \\equiv \\dfrac{\\hat{H}\\,\\Psi_{T}(\\mathbf{R})}{\\Psi_{T}(\\mathbf{R})}$, where $\\hat{H}$ is the system Hamiltonian. Consider a single-electron hydrogenic problem in Hartree atomic units where $\\hbar = m_{e} = e = 1$ and $4\\pi\\varepsilon_{0} = 1$. The nonrelativistic Hamiltonian for the hydrogen atom is $\\hat{H} = -\\dfrac{1}{2}\\nabla^{2} - \\dfrac{1}{r}$, where $r = |\\mathbf{r}|$.\n\nLet the isotropic trial wavefunction be $\\Psi_{T}(r) = \\exp(-\\alpha r)$, with a real parameter $\\alpha > 0$. Using only fundamental definitions, do the following:\n\n1) Derive the local energy $E_{L}(r)$.\n\n2) Using the definition of the variational energy $E_{V}(\\alpha) = \\dfrac{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2} E_{L}(\\mathbf{r})\\, d^{3}\\mathbf{r}}{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2}\\, d^{3}\\mathbf{r}}$, evaluate $E_{V}(\\alpha)$ exactly as a function of $\\alpha$.\n\n3) Minimize $E_{V}(\\alpha)$ with respect to $\\alpha$ to obtain the optimal parameter $\\alpha^{\\star}$.\n\nWork in spherical coordinates and show all steps from first principles, including the Laplacian acting on a spherically symmetric function. You may perform any required integrals analytically. Express the final answer as the exact value of $\\alpha^{\\star}$ in $\\text{bohr}^{-1}$. Provide only $\\alpha^{\\star}$ as your final answer; do not include the local energy or the minimized energy in the final box. No rounding is required.", "solution": "The problem statement is scientifically grounded, self-contained, and quantitatively rigorous. It presents a standard exercise in quantum mechanics, specifically the application of the variational principle to the hydrogen atom. The problem is valid and will be solved as stated.\n\nThe task is to find the optimal parameter $\\alpha^{\\star}$ for a given trial wavefunction $\\Psi_{T}(r) = \\exp(-\\alpha r)$ for the hydrogen atom, whose Hamiltonian in Hartree atomic units is $\\hat{H} = -\\dfrac{1}{2}\\nabla^{2} - \\dfrac{1}{r}$. This will be done in three sequential steps: first, deriving the local energy $E_{L}(r)$; second, evaluating the variational energy $E_{V}(\\alpha)$; and third, minimizing $E_{V}(\\alpha)$ with respect to $\\alpha$.\n\nStep 1: Derivation of the local energy $E_{L}(r)$\n\nThe local energy is defined as $E_{L}(\\mathbf{R}) = \\dfrac{\\hat{H}\\,\\Psi_{T}(\\mathbf{R})}{\\Psi_{T}(\\mathbf{R})}$. Since the trial wavefunction $\\Psi_{T}(r)$ is spherically symmetric, the local energy will also depend only on the radial coordinate $r$. We must apply the Hamiltonian $\\hat{H}$ to $\\Psi_{T}(r)$.\n\nThe action of the potential energy operator is trivial:\n$$\n-\\frac{1}{r} \\Psi_{T}(r) = -\\frac{1}{r} \\exp(-\\alpha r)\n$$\n\nThe action of the kinetic energy operator, $-\\dfrac{1}{2}\\nabla^{2}$, requires computing the Laplacian of $\\Psi_{T}(r)$. In spherical coordinates $(r, \\theta, \\phi)$, the Laplacian operator is:\n$$\n\\nabla^{2} = \\frac{1}{r^{2}} \\frac{\\partial}{\\partial r} \\left( r^{2} \\frac{\\partial}{\\partial r} \\right) + \\frac{1}{r^{2}\\sin\\theta} \\frac{\\partial}{\\partial \\theta} \\left( \\sin\\theta \\frac{\\partial}{\\partial \\theta} \\right) + \\frac{1}{r^{2}\\sin^{2}\\theta} \\frac{\\partial^{2}}{\\partial \\phi^{2}}\n$$\nSince $\\Psi_{T}(r)$ depends only on $r$, the derivatives with respect to $\\theta$ and $\\phi$ are zero. The Laplacian simplifies to its radial part:\n$$\n\\nabla^{2}\\Psi_{T}(r) = \\frac{1}{r^{2}} \\frac{d}{dr} \\left( r^{2} \\frac{d\\Psi_{T}(r)}{dr} \\right)\n$$\nFirst, we compute the derivative of $\\Psi_{T}(r)$ with respect to $r$:\n$$\n\\frac{d\\Psi_{T}}{dr} = \\frac{d}{dr}\\exp(-\\alpha r) = -\\alpha \\exp(-\\alpha r)\n$$\nNext, we multiply by $r^2$ and differentiate again:\n$$\n\\frac{d}{dr} \\left( r^{2} \\frac{d\\Psi_{T}}{dr} \\right) = \\frac{d}{dr} \\left( -r^{2}\\alpha \\exp(-\\alpha r) \\right) = - \\alpha \\left( 2r\\exp(-\\alpha r) - \\alpha r^{2}\\exp(-\\alpha r) \\right)\n$$\nFinally, we divide by $r^2$:\n$$\n\\nabla^{2}\\Psi_{T}(r) = \\frac{1}{r^2} \\left[ -2\\alpha r \\exp(-\\alpha r) + \\alpha^{2} r^{2} \\exp(-\\alpha r) \\right] = \\left( -\\frac{2\\alpha}{r} + \\alpha^{2} \\right) \\exp(-\\alpha r)\n$$\nSo, the action of the kinetic energy operator is:\n$$\n-\\frac{1}{2}\\nabla^{2}\\Psi_{T}(r) = -\\frac{1}{2} \\left( \\alpha^{2} - \\frac{2\\alpha}{r} \\right) \\exp(-\\alpha r) = \\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha}{r} \\right) \\exp(-\\alpha r)\n$$\nNow, we combine the kinetic and potential energy terms to find $\\hat{H}\\Psi_{T}(r)$:\n$$\n\\hat{H}\\Psi_{T}(r) = \\left( -\\frac{1}{2}\\nabla^{2} - \\frac{1}{r} \\right) \\Psi_{T}(r) = \\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha}{r} \\right) \\exp(-\\alpha r) - \\frac{1}{r} \\exp(-\\alpha r) = \\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r} \\right) \\exp(-\\alpha r)\n$$\nThe local energy $E_{L}(r)$ is obtained by dividing $\\hat{H}\\Psi_{T}(r)$ by $\\Psi_{T}(r)$:\n$$\nE_{L}(r) = \\frac{\\left( -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r} \\right) \\exp(-\\alpha r)}{\\exp(-\\alpha r)} = -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r}\n$$\n\nStep 2: Evaluation of the variational energy $E_{V}(\\alpha)$\n\nThe variational energy is the expectation value of the local energy over the probability distribution $|\\Psi_{T}|^{2}$:\n$$\nE_{V}(\\alpha) = \\frac{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2} E_{L}(\\mathbf{r})\\, d^{3}\\mathbf{r}}{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2}\\, d^{3}\\mathbf{r}} = \\langle E_{L}(r) \\rangle\n$$\nSince $\\Psi_{T}(r)$ is real, $|\\Psi_{T}(r)|^{2} = \\Psi_{T}(r)^{2} = \\exp(-2\\alpha r)$. We can write:\n$$\nE_{V}(\\alpha) = \\left\\langle -\\frac{\\alpha^{2}}{2} + \\frac{\\alpha - 1}{r} \\right\\rangle = -\\frac{\\alpha^{2}}{2} + (\\alpha - 1) \\left\\langle \\frac{1}{r} \\right\\rangle\n$$\nThe expectation value $\\langle \\frac{1}{r} \\rangle$ is given by:\n$$\n\\left\\langle \\frac{1}{r} \\right\\rangle = \\frac{\\int_{\\mathbb{R}^{3}} \\frac{1}{r} |\\Psi_{T}(\\mathbf{r})|^{2} \\,d^{3}\\mathbf{r}}{\\int_{\\mathbb{R}^{3}} |\\Psi_{T}(\\mathbf{r})|^{2} \\,d^{3}\\mathbf{r}}\n$$\nWe evaluate the numerator and denominator integrals separately. The volume element in spherical coordinates is $d^{3}\\mathbf{r} = r^{2}\\sin\\theta\\, dr\\, d\\theta\\, d\\phi$. The integration over angular variables $(\\theta, \\phi)$ gives a factor of $4\\pi$.\n\nThe denominator integral is:\n$$\n\\int_{\\mathbb{R}^{3}} |\\Psi_{T}|^{2} \\,d^{3}\\mathbf{r} = 4\\pi \\int_{0}^{\\infty} \\exp(-2\\alpha r) r^{2}\\, dr\n$$\nThis is a standard integral of the form $\\int_{0}^{\\infty} x^{n} \\exp(-ax)\\, dx = \\frac{n!}{a^{n+1}}$. Here, $n=2$ and $a=2\\alpha$.\n$$\n\\int_{0}^{\\infty} r^{2} \\exp(-2\\alpha r)\\, dr = \\frac{2!}{(2\\alpha)^{3}} = \\frac{2}{8\\alpha^{3}} = \\frac{1}{4\\alpha^{3}}\n$$\nSo, the denominator is $4\\pi \\left( \\frac{1}{4\\alpha^{3}} \\right) = \\frac{\\pi}{\\alpha^{3}}$.\n\nThe numerator integral for $\\langle \\frac{1}{r} \\rangle$ is:\n$$\n\\int_{\\mathbb{R}^{3}} \\frac{1}{r} |\\Psi_{T}|^{2} \\,d^{3}\\mathbf{r} = 4\\pi \\int_{0}^{\\infty} \\frac{1}{r} \\exp(-2\\alpha r) r^{2}\\, dr = 4\\pi \\int_{0}^{\\infty} r \\exp(-2\\alpha r)\\, dr\n$$\nThis corresponds to the case $n=1$ and $a=2\\alpha$:\n$$\n\\int_{0}^{\\infty} r \\exp(-2\\alpha r)\\, dr = \\frac{1!}{(2\\alpha)^{2}} = \\frac{1}{4\\alpha^{2}}\n$$\nSo, the numerator is $4\\pi \\left( \\frac{1}{4\\alpha^{2}} \\right) = \\frac{\\pi}{\\alpha^{2}}$.\n\nNow we compute $\\langle \\frac{1}{r} \\rangle$:\n$$\n\\left\\langle \\frac{1}{r} \\right\\rangle = \\frac{\\pi/\\alpha^{2}}{\\pi/\\alpha^{3}} = \\alpha\n$$\nSubstituting this back into the expression for $E_{V}(\\alpha)$:\n$$\nE_{V}(\\alpha) = -\\frac{\\alpha^{2}}{2} + (\\alpha - 1)\\alpha = -\\frac{\\alpha^{2}}{2} + \\alpha^{2} - \\alpha = \\frac{\\alpha^{2}}{2} - \\alpha\n$$\n\nStep 3: Minimization of $E_{V}(\\alpha)$\n\nTo find the optimal parameter $\\alpha^{\\star}$ that minimizes the variational energy, we differentiate $E_{V}(\\alpha)$ with respect to $\\alpha$ and set the result to zero:\n$$\n\\frac{dE_{V}}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{\\alpha^{2}}{2} - \\alpha \\right) = \\alpha - 1\n$$\nSetting the derivative to zero gives the condition for the extremum:\n$$\n\\alpha - 1 = 0 \\implies \\alpha^{\\star} = 1\n$$\nTo confirm this is a minimum, we check the second derivative:\n$$\n\\frac{d^{2}E_{V}}{d\\alpha^{2}} = \\frac{d}{d\\alpha}(\\alpha - 1) = 1\n$$\nSince the second derivative is positive ($1 > 0$), the extremum is a minimum. The optimal value of the parameter is $\\alpha^{\\star} = 1$. In Hartree atomic units, length is measured in units of the Bohr radius, $a_{0}$. The parameter $\\alpha$ has units of inverse length, so the units are correctly $\\text{bohr}^{-1}$. The optimal value is $1\\ \\text{bohr}^{-1}$.", "answer": "$$\n\\boxed{1}\n$$", "id": "2828337"}, {"introduction": "Moving from theory to practice, this problem addresses the efficiency of the Monte Carlo sampling at the heart of VMC. The Metropolis-Hastings algorithm's performance hinges on a well-chosen step size, $\\Delta \\tau$, and the acceptance ratio is your primary diagnostic tool. This exercise [@problem_id:2461082] explores how to interpret this ratio to tune your simulation for faster convergence and more reliable results, a crucial skill for any computational scientist.", "problem": "A Variational Monte Carlo (VMC) simulation samples electron configurations $\\mathbf{R}$ from a target distribution proportional to $\\lvert \\Psi_T(\\mathbf{R}) \\rvert^2$ using the Metropolis–Hastings (MH) algorithm. The proposal move is controlled by a walker step size parameter $\\Delta \\tau$ so that larger $\\Delta \\tau$ produces larger typical displacements. In a production run, the observed Metropolis acceptance ratio is consistently $99.9\\%$. Which statement best describes what this implies about the choice of $\\Delta \\tau$ and how it should be adjusted to improve sampling efficiency?\n\nA. $\\Delta \\tau$ is too small; it should be increased so that proposals are larger, which will reduce the acceptance ratio from $99.9\\%$ and decrease autocorrelation.\n\nB. $\\Delta \\tau$ is too large; it should be decreased to increase the acceptance ratio further and remove bias in the estimated energy.\n\nC. $\\Delta \\tau$ is optimal because maximizing the acceptance ratio always minimizes the statistical error per sample in VMC.\n\nD. Detailed balance requires an acceptance ratio of $100\\%$, so $\\Delta \\tau$ must be taken to $0$ to ensure correctness.\n\nE. The acceptance ratio in VMC is independent of $\\Delta \\tau$, so $99.9\\%$ does not inform any adjustment.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n-   Method: Variational Monte Carlo (VMC)\n-   Target distribution for electron configurations $\\mathbf{R}$: Proportional to $\\lvert \\Psi_T(\\mathbf{R}) \\rvert^2$.\n-   Sampling algorithm: Metropolis–Hastings (MH).\n-   Proposal move control parameter: Walker step size $\\Delta \\tau$.\n-   Parameter effect: Larger $\\Delta \\tau$ leads to larger typical displacements.\n-   Observation: Metropolis acceptance ratio is consistently $99.9\\%$.\n-   Question: Interpret the implication for $\\Delta \\tau$ and determine the adjustment needed to improve sampling efficiency.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is well-grounded in the standard theory of Markov chain Monte Carlo (MCMC) methods as applied in computational chemistry, specifically VMC. The use of the Metropolis-Hastings algorithm to sample from the distribution $|\\Psi_T|^2$ and the role of a step-size parameter in controlling proposal moves and acceptance rates are fundamental concepts.\n-   **Well-Posedness**: The problem is well-posed. It presents a specific, quantifiable observation ($99.9\\%$ acceptance ratio) and asks for a conclusion about simulation efficiency, which has a theoretically sound and unique answer within the framework of MCMC optimization.\n-   **Objectivity**: The problem is stated in objective, technical language.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Derivation**\n\nThe Metropolis-Hastings algorithm is employed in Variational Monte Carlo to generate a sequence of electron configurations $\\mathbf{R}_0, \\mathbf{R}_1, \\dots, \\mathbf{R}_N$ that are distributed according to the probability density function $p(\\mathbf{R}) \\propto |\\Psi_T(\\mathbf{R})|^2$, where $\\Psi_T$ is the trial wavefunction. The algorithm proceeds by proposing a move from a current configuration $\\mathbf{R}_i$ to a new configuration $\\mathbf{R}'$. For a symmetric proposal distribution, which is common, the move is accepted with probability:\n$$ \\alpha(\\mathbf{R}'|\\mathbf{R}_i) = \\min\\left(1, \\frac{p(\\mathbf{R}')}{p(\\mathbf{R}_i)}\\right) = \\min\\left(1, \\frac{|\\Psi_T(\\mathbf{R}')|^2}{|\\Psi_T(\\mathbf{R}_i)|^2}\\right) $$\nIf the move is accepted, $\\mathbf{R}_{i+1} = \\mathbf{R}'$. If rejected, the walker remains at the same position, so $\\mathbf{R}_{i+1} = \\mathbf{R}_i$.\n\nThe size of the proposed move, $\\mathbf{R}' - \\mathbf{R}_i$, is controlled by the step size parameter $\\Delta \\tau$. A larger $\\Delta \\tau$ corresponds to a larger proposed displacement.\n\nAn observed acceptance ratio of $99.9\\%$ signifies that proposed moves are almost always accepted. From the expression for $\\alpha$, this implies that the ratio $\\frac{|\\Psi_T(\\mathbf{R}')|^2}{|\\Psi_T(\\mathbf{R}_i)|^2}$ is almost always greater than or equal to $1$. This condition holds when the proposed configuration $\\mathbf{R}'$ is very close to the current configuration $\\mathbf{R}_i$. Consequently, a very high acceptance ratio is a direct indication that the proposal step size $\\Delta \\tau$ is too small.\n\nThe goal of the simulation is to achieve high sampling efficiency. Efficiency in MCMC is determined by how quickly the algorithm generates statistically independent samples. This is inversely related to the autocorrelation time of the generated sequence.\n-   If $\\Delta \\tau$ is excessively small, the acceptance rate is high, but the walker explores the configuration space very slowly. Each configuration is highly correlated with the previous one. This results in a large autocorrelation time and poor sampling efficiency.\n-   If $\\Delta \\tau$ is excessively large, proposed moves are often to regions of very low probability (where $|\\Psi_T(\\mathbf{R}')|^2$ is small), leading to a very low acceptance rate. The walker frequently gets \"stuck\" at its current position due to rejections, which also increases autocorrelation and leads to poor efficiency.\n\nOptimal sampling efficiency is achieved by balancing the move size and the acceptance rate to minimize the autocorrelation time. A general rule of thumb for many problems is that an acceptance ratio around $50\\%$ provides a good trade-off. An acceptance ratio of $99.9\\%$ is far from this optimal regime. To improve efficiency, one must explore the configuration space more rapidly. This necessitates increasing the step size $\\Delta \\tau$. Increasing $\\Delta \\tau$ will lead to larger proposed moves, which in turn will lower the acceptance ratio but decrease the autocorrelation between samples, thus improving overall sampling efficiency.\n\n**Option-by-Option Analysis**\n\n**A. $\\Delta \\tau$ is too small; it should be increased so that proposals are larger, which will reduce the acceptance ratio from $99.9\\%$ and decrease autocorrelation.**\nThis statement is fully consistent with the principles of MCMC efficiency. A $99.9\\%$ acceptance ratio implies $\\Delta \\tau$ is too small. Increasing $\\Delta \\tau$ will generate larger proposals, which will reduce the acceptance ratio from its current extreme value and allow the walker to explore configuration space more effectively, thereby decreasing autocorrelation.\n**Verdict: Correct**\n\n**B. $\\Delta \\tau$ is too large; it should be decreased to increase the acceptance ratio further and remove bias in the estimated energy.**\nThis statement is incorrect on multiple grounds. First, a $99.9\\%$ acceptance ratio implies $\\Delta \\tau$ is too small, not too large. Second, increasing the acceptance ratio further would worsen the sampling efficiency. Third, the Metropolis algorithm is designed to be asymptotically unbiased for any $\\Delta \\tau > 0$ that allows the chain to be ergodic. The choice of $\\Delta \\tau$ affects the statistical error (variance) of the estimate, not its bias.\n**Verdict: Incorrect**\n\n**C. $\\Delta \\tau$ is optimal because maximizing the acceptance ratio always minimizes the statistical error per sample in VMC.**\nThis statement is fundamentally flawed. Maximizing the acceptance ratio is achieved by setting $\\Delta \\tau \\to 0$. In this limit, the walker barely moves, leading to maximum autocorrelation and, consequently, maximum statistical error for a given number of simulation steps.\n**Verdict: Incorrect**\n\n**D. Detailed balance requires an acceptance ratio of $100\\%$, so $\\Delta \\tau$ must be taken to $0$ to ensure correctness.**\nThe principle of detailed balance, which ensures convergence to the correct stationary distribution, does not impose any requirement on the value of the acceptance ratio, other than it being correctly calculated. An acceptance ratio of $100\\%$ is not a requirement for correctness. Furthermore, taking $\\Delta \\tau = 0$ would halt the exploration of configuration space, making the simulation useless.\n**Verdict: Incorrect**\n\n**E. The acceptance ratio in VMC is independent of $\\Delta \\tau$, so $99.9\\%$ does not inform any adjustment.**\nThis statement is factually incorrect. The acceptance ratio is strongly dependent on the proposal step size $\\Delta \\tau$. Small $\\Delta \\tau$ values lead to high acceptance ratios, and large $\\Delta \\tau$ values lead to low acceptance ratios. The observed ratio is a critical diagnostic for tuning $\\Delta \\tau$.\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "2461082"}, {"introduction": "A robust understanding of any method includes knowing its limitations. This thought experiment [@problem_id:2461068] challenges you to analyze what happens when a mathematically \"improper\" trial wavefunction, $\\Psi_T$, is used in a VMC calculation. By examining the pathological case of a discontinuous wavefunction, you will gain critical insight into the theoretical requirements for $\\Psi_T$ and the subtle ways a simulation can produce profoundly incorrect results, even when it appears to run without error.", "problem": "Consider a single particle of mass $m$ moving in one dimension under the harmonic potential $V(x)=\\tfrac{1}{2}k x^2$, with Hamiltonian $H=-\\tfrac{\\hbar^{2}}{2m}\\dfrac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}+\\tfrac{1}{2}k x^2$. In Variational Monte Carlo (VMC), a commonly used estimator of the energy employs the local energy $E_{\\mathrm{L}}(x)=(H\\psi_{\\mathrm{T}})/\\psi_{\\mathrm{T}}$ where defined, and samples configurations from a probability density proportional to $\\lvert \\psi_{\\mathrm{T}}(x)\\rvert^2$. In importance-sampled VMC with drift, the proposal drift is proportional to $\\nabla \\ln\\lvert \\psi_{\\mathrm{T}}\\rvert$. Consider the discontinuous “box” trial wave function\n$$\n\\psi_{\\mathrm{T}}(x)=\n\\begin{cases}\nC, & \\lvert x\\rvert\\le L, \\\\[4pt]\n0, & \\lvert x\\rvert> L\n\\end{cases}\n$$\nwith $L>0$ and normalization constant $C=1/\\sqrt{2L}$.\n\nWhich of the following statements about using this $\\psi_{\\mathrm{T}}$ in VMC are correct?\n\nA. For almost all sampled $x$, the local energy equals $E_{\\mathrm{L}}(x)=\\tfrac{1}{2}k x^{2}$, and therefore its Monte Carlo average is an unbiased estimate of the true variational energy that obeys the variational principle for any $L$.\n\nB. Because $\\psi_{\\mathrm{T}}$ is discontinuous, the kinetic energy contribution renders the exact variational energy infinite; the usual local-energy average $\\langle E_{\\mathrm{L}}\\rangle$ computed by sampling away from the boundaries is biased and underestimates the true energy.\n\nC. The variance of the local energy is infinite due to the non-differentiability at $x=\\pm L$, even though configurations with exactly $\\lvert x\\rvert=L$ have probability zero.\n\nD. In importance-sampled VMC with drift proportional to $\\nabla \\ln\\lvert \\psi_{\\mathrm{T}}\\rvert$, the drift is identically zero wherever it is defined, so proposals reduce to a simple random walk, and any proposal that exits $\\lvert x\\rvert\\le L$ has acceptance probability $0$.\n\nE. If one minimizes the sampled average $\\langle E_{\\mathrm{L}}\\rangle$ over $L$, the optimal $L$ tends to $0$, illustrating a spurious “variational” minimum that arises from neglecting the kinetic boundary contribution.", "solution": "The problem statement will first be subjected to rigorous validation.\n\n### Step 1: Extract Givens\n\n-   **System**: A single particle of mass $m$ in one dimension.\n-   **Potential Energy**: $V(x)=\\tfrac{1}{2}k x^{2}$.\n-   **Hamiltonian**: $H=-\\tfrac{\\hbar^{2}}{2m}\\dfrac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}+\\tfrac{1}{2}k x^{2}$.\n-   **Methodology**: Variational Monte Carlo (VMC).\n-   **Local Energy Estimator**: $E_{\\mathrm{L}}(x)=(H\\psi_{\\mathrm{T}})/\\psi_{\\mathrm{T}}$.\n-   **Sampling Distribution**: Proportional to $\\lvert \\psi_{\\mathrm{T}}(x)\\rvert^{2}$.\n-   **Importance Sampling Drift**: Proportional to $\\nabla \\ln\\lvert \\psi_{\\mathrm{T}}\\rvert$.\n-   **Trial Wave Function**:\n    $$\n    \\psi_{\\mathrm{T}}(x)=\n    \\begin{cases}\n    C, & \\lvert x\\rvert\\le L \\\\\n    0, & \\lvert x\\rvert> L\n    \\end{cases}\n    $$\n-   **Constants**: $L>0$, $C=1/\\sqrt{2L}$.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientific Grounding**: The problem is based on fundamental principles of quantum mechanics (the harmonic oscillator) and a standard computational technique (Variational Monte Carlo). The use of a discontinuous trial wave function, while not representing a physical state, serves as a valid and important pedagogical case for understanding the requirements and limitations of the VMC method. The concepts are scientifically sound.\n-   **Well-Posed**: The problem is well-posed. The Hamiltonian, trial wave function, and VMC procedure are explicitly defined. The question asks for an analysis of the consequences of using this specific trial function, which is a well-defined task with a unique set of correct conclusions.\n-   **Objective**: The problem is stated in precise, objective language, free of ambiguity or subjective claims. The normalization constant $C=1/\\sqrt{2L}$ is consistent with the wave function definition: $\\int_{-\\infty}^{\\infty} \\lvert \\psi_{\\mathrm{T}}(x) \\rvert^2 dx = \\int_{-L}^{L} C^2 dx = C^2(2L) = (1/(2L))(2L) = 1$. The setup is complete and self-consistent.\n\n### Step 3: Verdict and Action\n\nThe problem statement is scientifically sound, well-posed, and objective. There are no identifiable flaws. It is a valid problem. We may proceed to the solution.\n\n### Derivation and Analysis\n\nThe core of this problem lies in the application of the Hamiltonian operator $H$ to a discontinuous trial wave function $\\psi_{\\mathrm{T}}(x)$.\n\n**1. True Variational Energy**\nThe exact variational energy is the expectation value of the Hamiltonian:\n$$ E_V = \\frac{\\langle \\psi_{\\mathrm{T}} | H | \\psi_{\\mathrm{T}} \\rangle}{\\langle \\psi_{\\mathrm{T}} | \\psi_{\\mathrm{T}} \\rangle} = \\langle \\psi_{\\mathrm{T}} | H | \\psi_{\\mathrm{T}} \\rangle $$\nsince $\\psi_{\\mathrm{T}}$ is normalized. This is $E_V = \\langle T \\rangle + \\langle V \\rangle$.\n\nLet us first calculate the potential energy expectation value:\n$$ \\langle V \\rangle = \\int_{-L}^{L} \\psi_{\\mathrm{T}}^*(x) \\left(\\frac{1}{2}kx^2\\right) \\psi_{\\mathrm{T}}(x) dx = \\int_{-L}^{L} C^2 \\frac{1}{2}kx^2 dx $$\n$$ \\langle V \\rangle = \\left(\\frac{1}{2L}\\right) \\frac{k}{2} \\int_{-L}^{L} x^2 dx = \\frac{k}{4L} \\left[\\frac{x^3}{3}\\right]_{-L}^{L} = \\frac{k}{4L} \\left(\\frac{L^3}{3} - \\frac{-L^3}{3}\\right) = \\frac{k L^2}{6} $$\nThe potential energy expectation is finite.\n\nNow, consider the kinetic energy operator $T = -\\tfrac{\\hbar^{2}}{2m}\\dfrac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}$. A wave function must be continuous and have a square-integrable first derivative to have finite kinetic energy. The given $\\psi_{\\mathrm{T}}(x)$ is discontinuous at $x=\\pm L$. To correctly evaluate the action of the second derivative, we must use distributions. The first derivative of $\\psi_{\\mathrm{T}}(x)$ involves Dirac delta functions:\n$$ \\frac{\\mathrm{d}\\psi_{\\mathrm{T}}}{\\mathrm{d}x} = C[\\delta(x+L) - \\delta(x-L)] $$\nThe kinetic energy expectation is properly calculated as:\n$$ \\langle T \\rangle = \\int_{-\\infty}^{\\infty} \\psi_{\\mathrm{T}}^*(x) \\left( -\\frac{\\hbar^{2}}{2m}\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2} \\right) \\psi_{\\mathrm{T}}(x) dx = \\frac{\\hbar^2}{2m} \\int_{-\\infty}^{\\infty} \\left| \\frac{\\mathrm{d}\\psi_{\\mathrm{T}}}{\\mathrm{d}x} \\right|^2 dx $$\nSubstituting the derivative:\n$$ \\langle T \\rangle = \\frac{\\hbar^2 C^2}{2m} \\int_{-\\infty}^{\\infty} |\\delta(x+L) - \\delta(x-L)|^2 dx $$\nThe integral of the square of a delta function is infinite. Thus, $\\langle T \\rangle = \\infty$.\nThe true variational energy is therefore $E_V = \\langle T \\rangle + \\langle V \\rangle = \\infty$.\n\n**2. VMC Energy Estimate**\nThe VMC method estimates the energy by averaging the local energy $E_{\\mathrm{L}}(x) = (H\\psi_{\\mathrm{T}})/\\psi_{\\mathrm{T}}$ over configurations sampled from the probability distribution $P(x) = |\\psi_{\\mathrm{T}}(x)|^2$. Here, $P(x)$ is a uniform distribution on $[-L, L]$.\nFor any point $x$ in the open interval $(-L, L)$, $\\psi_{\\mathrm{T}}(x) = C$ (a constant). The derivatives are zero:\n$$ \\frac{\\mathrm{d}\\psi_{\\mathrm{T}}}{\\mathrm{d}x} = 0, \\quad \\frac{\\mathrm{d}^2\\psi_{\\mathrm{T}}}{\\mathrm{d}x^2} = 0 \\quad \\text{for } |x|<L $$\nThus, for $|x|<L$, the local energy is:\n$$ E_{\\mathrm{L}}(x) = \\frac{1}{C} \\left( -\\frac{\\hbar^{2}}{2m}(0) + \\frac{1}{2}kx^2 C \\right) = \\frac{1}{2}kx^2 $$\nA Monte Carlo simulation samples points from the continuous distribution $P(x)$. The probability of sampling the specific points $x=\\pm L$ is zero. Therefore, the simulation only ever evaluates $E_{\\mathrm{L}}(x)$ for $x \\in (-L, L)$. The Monte Carlo estimate of the energy, $E_{VMC}$, converges to the average of this incomplete local energy:\n$$ E_{VMC} = \\int_{-L}^{L} E_{\\mathrm{L}}(x) P(x) dx = \\int_{-L}^{L} \\left(\\frac{1}{2} kx^2\\right) \\frac{1}{2L} dx = \\frac{k}{4L} \\left[\\frac{x^3}{3}\\right]_{-L}^{L} = \\frac{k L^2}{6} $$\nThis estimate completely neglects the infinite kinetic energy contribution from the boundaries.\n\nWe now evaluate each statement.\n\n**A. For almost all sampled $x$, the local energy equals $E_{\\mathrm{L}}(x)=\\tfrac{1}{2}k x^{2}$, and therefore its Monte Carlo average is an unbiased estimate of the true variational energy that obeys the variational principle for any $L$.**\nThe first part is correct: for almost all $x$ (i.e., excluding the set $\\{ -L, L \\}$ of measure zero), $E_{\\mathrm{L}}(x)=\\tfrac{1}{2}k x^{2}$. However, the conclusion is false. The Monte Carlo average is $E_{VMC} = \\frac{kL^2}{6}$, while the true variational energy is $E_V = \\infty$. The estimate is therefore severely biased. Furthermore, this estimate $E_{VMC}$ can be made arbitrarily small by choosing small $L$, violating the variational principle which requires the energy to be above the true ground-state energy $E_0 = \\frac{1}{2}\\hbar\\sqrt{k/m} > 0$.\n**Verdict: Incorrect.**\n\n**B. Because $\\psi_{\\mathrm{T}}$ is discontinuous, the kinetic energy contribution renders the exact variational energy infinite; the usual local-energy average $\\langle E_{\\mathrm{L}}\\rangle$ computed by sampling away from the boundaries is biased and underestimates the true energy.**\nThis statement is a precise and correct description of the situation. The discontinuity leads to an infinite kinetic energy expectation, making the exact variational energy infinite. The standard VMC sampling procedure, by evaluating local energies only where they are well-behaved (away from the boundaries), obtains a finite average $E_{VMC} = kL^2/6$. This average is biased as it does not equal the true expectation value ($E_V=\\infty$), and it is a profound underestimation.\n**Verdict: Correct.**\n\n**C. The variance of the local energy is infinite due to the non-differentiability at $x=\\pm L$, even though configurations with exactly $\\lvert x\\rvert=L$ have probability zero.**\nThe formal variance of the energy is $\\sigma_E^2 = \\langle (H-E_V)^2 \\rangle = \\langle H^2 \\rangle - E_V^2$. Since $E_V = \\infty$, this expression is ill-defined. A better measure is the variance of the local energy, $\\sigma_{E_L}^2 = \\int (E_{\\mathrm{L}}(x) - E_V)^2 |\\psi_{\\mathrm{T}}(x)|^2 dx$. Because $E_{\\mathrm{L}}(x)$ is finite for $|x|<L$ while $E_V=\\infty$, the integrand is infinite everywhere inside the box, making the integral infinite. Alternatively, one can show that $\\langle E_{\\mathrm{L}}^2 \\rangle = \\int |H\\psi_{\\mathrm{T}}(x)|^2/\\psi_{\\mathrm{T}}(x)|^2 \\cdot |\\psi_{\\mathrm{T}}(x)|^2 dx = \\int |H\\psi_{\\mathrm{T}}(x)|^2 dx$ (for real $\\psi_{\\mathrm{T}}$), which is infinite due to the singular nature of $H\\psi_{\\mathrm{T}}$. An infinite variance of the local energy is a known pathology for trial functions that are not in the domain of the Hamiltonian. This statement correctly identifies this fact and its cause.\n**Verdict: Correct.**\n\n**D. In importance-sampled VMC with drift proportional to $\\nabla \\ln\\lvert \\psi_{\\mathrm{T}}\\rvert$, the drift is identically zero wherever it is defined, so proposals reduce to a simple random walk, and any proposal that exits $\\lvert x\\rvert\\le L$ has acceptance probability $0$.**\nThe drift term is proportional to $\\nabla \\ln|\\psi_{\\mathrm{T}}|$. For $|x|<L$, $|\\psi_{\\mathrm{T}}(x)|=C$ is a constant, so $\\ln|\\psi_{\\mathrm{T}}(x)|$ is a constant, and its gradient is zero. The drift is indeed zero wherever it is defined (i.e., for $|x|<L$). The proposal mechanism thus reduces to a simple random walk (diffusion). If a walker at position $x_{old}$ inside the box proposes a move to $x_{new}$ outside the box, the acceptance probability based on the Metropolis criterion is $A = \\min\\left(1, \\frac{|\\psi_{\\mathrm{T}}(x_{new})|^2}{|\\psi_{\\mathrm{T}}(x_{old})|^2}\\right) = \\min\\left(1, \\frac{0^2}{C^2}\\right) = 0$. The statement is entirely accurate. The walkers are confined to the box, which prevents the algorithm from ever encountering the problematic boundary.\n**Verdict: Correct.**\n\n**E. If one minimizes the sampled average $\\langle E_{\\mathrm{L}}\\rangle$ over $L$, the optimal $L$ tends to $0$, illustrating a spurious “variational” minimum that arises from neglecting the kinetic boundary contribution.**\nThe sampled average is $E_{VMC}(L) = \\frac{kL^2}{6}$. This function of the variational parameter $L$ is to be minimized. For $k>0$, this function is minimized as $L \\to 0$ (since $L>0$). The corresponding \"minimal\" energy approaches $0$. This is a non-physical result, far below the true ground-state energy. This demonstrates a catastrophic failure of the variational optimization, producing a spurious minimum because the VMC estimator for this wave function is fundamentally flawed and misses the dominant (infinite) kinetic energy term.\n**Verdict: Correct.**", "answer": "$$\\boxed{BCDE}$$", "id": "2461068"}]}