{"hands_on_practices": [{"introduction": "The most fundamental definition of a molecular dipole moment, $\\boldsymbol{\\mu}$, for a set of point charges $q_i$ at positions $\\mathbf{r}_i$ is the vector sum $\\boldsymbol{\\mu} = \\sum_i q_i \\mathbf{r}_i$. This exercise grounds your understanding in this core principle, using a simple but effective point-charge model for the ammonia molecule, $\\text{NH}_3$. You will directly explore how the molecular dipole moment is not just a function of charge magnitude, but is critically dependent on the precise three-dimensional arrangement of atoms, a concept you will investigate by comparing results from experimental and theoretically optimized geometries [@problem_id:2451471].", "problem": "You will implement a program that computes the molecular dipole moment magnitude of ammonia ($\\text{NH}_3$) using a point-charge model, once for an experimental geometry and once for a theoretical geometry, and then evaluates boundary and scaling behavior. Work from the first-principles definition of the dipole moment as a charge-weighted position vector sum. Use a neutral, atom-centered point-charge model with nitrogen assigned charge $q_{\\mathrm{N}} = -0.84\\,e$ and each hydrogen assigned charge $q_{\\mathrm{H}} = +0.28\\,e$, where $e$ is the elementary charge. Place the nitrogen atom at the origin. For a trigonal pyramidal $\\text{NH}_3$ molecule with three equivalent N–H bonds of length $r$ separated by a hydrogen–nitrogen–hydrogen angle $\\psi$, the three hydrogen atoms are arranged symmetrically around the principal symmetry axis. Let $\\theta$ denote the angle each N–H bond makes with the symmetry axis through nitrogen; $\\psi$ and $\\theta$ are related by the exact identity\n$$\n\\cos \\psi \\;=\\; \\frac{3\\cos^2 \\theta - 1}{2}.\n$$\nUse this relation to compute $\\theta$ for each case. Then construct the hydrogen coordinates at fixed $r$ by placing them at polar angle $\\theta' = \\pi - \\arccos(\\cos\\theta)$ relative to the positive symmetry axis and at azimuthal angles $0^\\circ$, $120^\\circ$, and $240^\\circ$ so that the three hydrogens lie on the same cone around the symmetry axis. The total dipole moment vector is\n$$\n\\boldsymbol{\\mu} \\;=\\; \\sum_i q_i \\,\\mathbf{r}_i,\n$$\nand its magnitude should be reported in Debye. Express the final answers in Debye and round each to six decimal places. Use the following physical constants explicitly: elementary charge $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$, $1\\,\\text{\\AA} = 1.0\\times 10^{-10}\\,\\mathrm{m}$, and $1\\,\\text{Debye} = 3.33564\\times 10^{-30}\\,\\mathrm{C\\cdot m}$. Angles are provided in degrees.\n\nTest suite (all cases use the same charges given above):\n- Case A (experimental geometry): $r = 1.012\\,\\text{\\AA}$, $\\psi = 106.7^\\circ$.\n- Case B (theory-optimized geometry): $r = 1.020\\,\\text{\\AA}$, $\\psi = 107.5^\\circ$.\n- Case C (planar boundary geometry): $r = 1.012\\,\\text{\\AA}$, $\\psi = 120.0^\\circ$.\n- Case D (compressed bonds): $r = 0.500\\,\\text{\\AA}$, $\\psi = 106.7^\\circ$.\n- Case E (derived metric): the absolute difference in dipole magnitude (in Debye) between Case B and Case A.\n\nYour program must produce a single line of output containing the five results as a comma-separated list enclosed in square brackets in the order $[\\text{Case A}, \\text{Case B}, \\text{Case C}, \\text{Case D}, \\text{Case E}]$, for example, \"[1.234567,1.234567,0.000000,0.123456,0.001111]\". All five values must be floats in Debye rounded to six decimal places. Do not print any additional text.", "solution": "The problem requires the calculation of the molecular dipole moment magnitude for ammonia ($\\text{NH}_3$) under various geometric configurations using a point-charge model. We must first validate the problem statement and then develop a solution from first principles.\n\nThe problem is scientifically grounded, well-posed, and objective. It is based on the fundamental definition of the electric dipole moment and utilizes a standard, albeit simplified, point-charge model. All necessary parameters, including charges, geometric arrangements, and physical constants, are provided, and there are no internal contradictions. The relationship provided between the H–N–H angle $\\psi$ and the angle $\\theta$ of the N–H bond with the symmetry axis is a correct geometric identity for a trigonal pyramidal structure. The instructions for coordinate construction contain a potentially ambiguous step involving an angle $\\theta'$, but as will be shown, this ambiguity does not affect the calculation of the dipole moment magnitude, which is the required output. Therefore, the problem is deemed valid.\n\nThe electric dipole moment vector $\\boldsymbol{\\mu}$ for a collection of point charges $q_i$ at positions $\\mathbf{r}_i$ is defined as:\n$$\n\\boldsymbol{\\mu} = \\sum_i q_i \\mathbf{r}_i\n$$\nThe problem specifies a neutral point-charge model for $\\text{NH}_3$ with the nitrogen atom ($N$) at the origin, $\\mathbf{r}_N = \\mathbf{0}$. The charge on the nitrogen atom is $q_N = -0.84\\,e$, and the charge on each of the three hydrogen atoms ($H$) is $q_H = +0.28\\,e$, where $e$ is the elementary charge. The total charge is $q_{total} = q_N + 3 q_H = -0.84\\,e + 3(0.28\\,e) = 0$, confirming the system is neutral. For a neutral system, the calculated dipole moment is independent of the choice of origin. Placing the nitrogen atom at the origin is a convenient choice that simplifies the calculation.\n\nWith $\\mathbf{r}_N = \\mathbf{0}$, the contribution of the nitrogen charge to the sum is zero, so the expression for the dipole moment becomes:\n$$\n\\boldsymbol{\\mu} = q_H (\\mathbf{r}_{H1} + \\mathbf{r}_{H2} + \\mathbf{r}_{H3})\n$$\nwhere $\\mathbf{r}_{Hi}$ are the position vectors of the three hydrogen atoms.\n\nWe establish a coordinate system where the principal symmetry axis of the molecule aligns with the $z$-axis. The three hydrogen atoms are arranged symmetrically around this axis. We can describe their positions using spherical coordinates $(r, \\theta_p, \\phi)$, where $r$ is the N–H bond length, $\\theta_p$ is the polar angle with respect to the positive $z$-axis, and $\\phi$ is the azimuthal angle. The three hydrogen atoms are placed at azimuthal angles $\\phi_1 = 0$, $\\phi_2 = 2\\pi/3$ radians ($120^\\circ$), and $\\phi_3 = 4\\pi/3$ radians ($240^\\circ$). The Cartesian coordinates of the hydrogen atoms are:\n$$\n\\mathbf{r}_{Hi} = (r \\sin\\theta_p \\cos\\phi_i, r \\sin\\theta_p \\sin\\phi_i, r \\cos\\theta_p)\n$$\nThe sum of the position vectors $\\sum_{i=1}^3 \\mathbf{r}_{Hi}$ is required. Let's evaluate the sum component-wise:\nThe $x$-component sum is proportional to $\\sum \\cos\\phi_i = \\cos(0) + \\cos(2\\pi/3) + \\cos(4\\pi/3) = 1 - 1/2 - 1/2 = 0$.\nThe $y$-component sum is proportional to $\\sum \\sin\\phi_i = \\sin(0) + \\sin(2\\pi/3) + \\sin(4\\pi/3) = 0 + \\sqrt{3}/2 - \\sqrt{3}/2 = 0$.\nThe $z$-component sum is $\\sum z_i = r\\cos\\theta_p + r\\cos\\theta_p + r\\cos\\theta_p = 3r\\cos\\theta_p$.\n\nDue to symmetry, the $x$ and $y$ components of the total dipole moment are zero. The resulting dipole moment vector is aligned with the $z$-axis:\n$$\n\\boldsymbol{\\mu} = (0, 0, 3 q_H r \\cos\\theta_p)\n$$\nThe magnitude of the dipole moment, $\\mu$, is the absolute value of the non-zero component:\n$$\n\\mu = |\\boldsymbol{\\mu}| = |3 q_H r \\cos\\theta_p|\n$$\nSince $q_H = +0.28\\,e$ is positive and $r$ is a length, we have $\\mu = 3 q_H r |\\cos\\theta_p|$.\n\nNext, we must relate $|\\cos\\theta_p|$ to the given H–N–H angle $\\psi$. We use the dot product between the position vectors of two hydrogen atoms, for instance $\\mathbf{r}_{H1}$ and $\\mathbf{r}_{H2}$:\n$$\n\\mathbf{r}_{H1} \\cdot \\mathbf{r}_{H2} = |\\mathbf{r}_{H1}| |\\mathbf{r}_{H2}| \\cos\\psi = r^2 \\cos\\psi\n$$\nCalculating the dot product explicitly from the Cartesian coordinates:\n$$\n\\mathbf{r}_{H1} \\cdot \\mathbf{r}_{H2} = (r\\sin\\theta_p \\cos\\phi_1)(r\\sin\\theta_p \\cos\\phi_2) + (r\\sin\\theta_p \\sin\\phi_1)(r\\sin\\theta_p \\sin\\phi_2) + (r\\cos\\theta_p)(r\\cos\\theta_p)\n$$\n$$\n= r^2\\sin^2\\theta_p(\\cos\\phi_1\\cos\\phi_2 + \\sin\\phi_1\\sin\\phi_2) + r^2\\cos^2\\theta_p = r^2\\sin^2\\theta_p\\cos(\\phi_1 - \\phi_2) + r^2\\cos^2\\theta_p\n$$\nSubstituting $\\phi_1=0$ and $\\phi_2=2\\pi/3$, we get $\\cos(\\phi_1-\\phi_2) = \\cos(-2\\pi/3) = -1/2$.\n$$\n\\mathbf{r}_{H1} \\cdot \\mathbf{r}_{H2} = r^2\\sin^2\\theta_p(-1/2) + r^2\\cos^2\\theta_p = r^2\\left(-\\frac{1}{2}(1-\\cos^2\\theta_p) + \\cos^2\\theta_p\\right) = r^2\\left(\\frac{3}{2}\\cos^2\\theta_p - \\frac{1}{2}\\right)\n$$\nEquating the two expressions for the dot product gives the identity provided in the problem statement, where $\\theta$ corresponds to our $\\theta_p$:\n$$\nr^2 \\cos\\psi = r^2\\frac{3\\cos^2\\theta_p - 1}{2} \\implies \\cos\\psi = \\frac{3\\cos^2\\theta_p - 1}{2}\n$$\nSolving for $|\\cos\\theta_p|$:\n$$\n\\cos^2\\theta_p = \\frac{2\\cos\\psi + 1}{3} \\implies |\\cos\\theta_p| = \\sqrt{\\frac{2\\cos\\psi + 1}{3}}\n$$\nThis expression uniquely determines the magnitude $|\\cos\\theta_p|$ from the angle $\\psi$. Substituting this back into the formula for the dipole moment magnitude:\n$$\n\\mu = 3 q_H r \\sqrt{\\frac{2\\cos\\psi + 1}{3}}\n$$\nThis is the final formula for the calculation. The computational steps are:\n$1$. Convert the input bond length $r$ from Angstroms to meters ($1\\,\\text{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$).\n$2$. Convert the input angle $\\psi$ from degrees to radians for use in the cosine function.\n$3$. Calculate the charge $q_H$ in Coulombs: $q_H = 0.28 \\times e$, using $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$.\n$4$. Substitute these values into the derived formula to obtain $\\mu$ in SI units ($\\mathrm{C \\cdot m}$).\n$5$. Convert the result from $\\mathrm{C \\cdot m}$ to Debye ($D$) using the conversion factor $1\\,D = 3.33564 \\times 10^{-30}\\,\\mathrm{C \\cdot m}$.\n$6$. For each test case, apply the formula. For Case C, where $\\psi=120^\\circ$, $\\cos\\psi = -0.5$, the term under the square root becomes zero, correctly yielding $\\mu = 0$ for a planar geometry. Case E is the absolute difference between the magnitudes from Case B and Case A.\n$7$. Round all final values to six decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the molecular dipole moment of ammonia for several geometries\n    based on a point-charge model.\n    \"\"\"\n\n    # --- Givens and Constants ---\n    \n    # Physical constants\n    e_charge = 1.602176634e-19  # Elementary charge in Coulombs (C)\n    A_to_m = 1.0e-10             # Angstrom to meter conversion factor\n    D_to_Cm = 3.33564e-30        # Debye to Coulomb-meter conversion factor\n\n    # Model parameters\n    q_H_e = 0.28  # Charge on Hydrogen in units of elementary charge e\n\n    # Charge on Hydrogen in Coulombs\n    q_H_C = q_H_e * e_charge\n\n    # Test suite from the problem statement\n    # Each case is a tuple: (bond_length_in_A, hnh_angle_in_deg)\n    test_cases_params = [\n        (1.012, 106.7),  # Case A: experimental geometry\n        (1.020, 107.5),  # Case B: theory-optimized geometry\n        (1.012, 120.0),  # Case C: planar boundary geometry\n        (0.500, 106.7),  # Case D: compressed bonds\n    ]\n    \n    def calculate_dipole_magnitude(r_A, psi_deg):\n        \"\"\"\n        Calculates the dipole moment magnitude in Debye.\n\n        Args:\n            r_A (float): N-H bond length in Angstroms.\n            psi_deg (float): H-N-H bond angle in degrees.\n\n        Returns:\n            float: The magnitude of the molecular dipole moment in Debye.\n        \"\"\"\n        # 1. Convert inputs to SI units\n        r_m = r_A * A_to_m\n        psi_rad = np.deg2rad(psi_deg)\n\n        # 2. Calculate the geometric factor |cos(theta)|\n        cos_psi = np.cos(psi_rad)\n        \n        # Handle potential floating point inaccuracies for the planar case\n        # where the argument to sqrt should be exactly zero.\n        cos2_theta_arg = (2 * cos_psi + 1) / 3\n        if cos2_theta_arg  0:\n             # This can happen if psi > 120 due to float precision.\n             # Physically, the angle cannot exceed 120 for this geometry.\n             # For psi=120, this term is 0.\n            abs_cos_theta = 0.0\n        else:\n            abs_cos_theta = np.sqrt(cos2_theta_arg)\n\n        # 3. Calculate dipole moment magnitude in SI units (C*m)\n        # Formula: mu = 3 * q_H * r * |cos(theta)|\n        mu_si = 3 * q_H_C * r_m * abs_cos_theta\n        \n        # 4. Convert to Debye\n        mu_D = mu_si / D_to_Cm\n        \n        return mu_D\n\n    # --- Calculation for all cases ---\n    \n    # Calculate results for cases A, B, C, D\n    results_abcd = []\n    for r_A, psi_deg in test_cases_params:\n        result = calculate_dipole_magnitude(r_A, psi_deg)\n        results_abcd.append(result)\n        \n    mu_A = results_abcd[0]\n    mu_B = results_abcd[1]\n    \n    # Calculate Case E: absolute difference between B and A\n    mu_E = abs(mu_B - mu_A)\n\n    # Combine all results\n    final_results = results_abcd + [mu_E]\n    \n    # Round all results to six decimal places\n    rounded_results = [round(res, 6) for res in final_results]\n    \n    # Format for printing\n    output_str = f\"[{','.join(f'{res:.6f}' for res in rounded_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "2451471"}, {"introduction": "While point-charge models are instructive, they beg the question: where do the partial charges come from? This next practice introduces a more physically robust method, the charge equilibration model, which derives partial charges from first principles based on atomic electronegativity $\\chi$ and chemical hardness $\\eta$. By applying the principle of electronegativity equalization to several diatomic species, you will calculate the charge distribution that minimizes the system's energy and then compute the resulting dipole moment, gaining insight into the origins of bond polarity [@problem_id:2451497].", "problem": "You are to write a complete, runnable program that computes the permanent electric dipole moment along the bond axis for three gas-phase, linear diatomic species using a physically grounded, first-principles-inspired model based on charge equilibration. The model treats each atom as a site with a quadratic energy in its net charge, and the diatomic molecule as neutral. The dipole moment must be computed from the definition as the first moment of the total charge distribution.\n\nAssume the following model and conventions.\n\n- The dipole moment vector is defined by the first moment of the charge distribution: for a discrete set of point charges, the component along the bond axis is given by $\\,\\mu_z = \\sum_i q_i z_i\\,$, where $\\,q_i\\,$ are site charges in units of the elementary charge and $\\,z_i\\,$ are site positions along the $\\,z$-axis in Angstrom.\n- Each diatomic molecule $\\,\\mathrm{A}-\\mathrm{B}\\,$ is aligned along the $\\,z$-axis with atom $\\,\\mathrm{A}\\,$ at $\\,z=0\\,$ and atom $\\,\\mathrm{B}\\,$ at $\\,z=R\\,$, where $\\,R\\,$ is the internuclear distance in Angstrom. The molecule is overall neutral, so $\\,q_{\\mathrm{A}} + q_{\\mathrm{B}} = 0\\,$.\n- The site energy for an atom $\\,i \\in \\{\\mathrm{A},\\mathrm{B}\\}\\,$ with net charge $\\,q_i\\,$ is $\\,E_i(q_i) = \\chi_i q_i + \\tfrac{1}{2}\\,\\eta_i q_i^2\\,$, where $\\,\\chi_i\\,$ is the Mulliken electronegativity in electronvolt (eV) and $\\,\\eta_i\\,$ is the absolute hardness in electronvolt. The total energy of the diatomic is $\\,E(q_{\\mathrm{A}},q_{\\mathrm{B}}) = E_{\\mathrm{A}}(q_{\\mathrm{A}}) + E_{\\mathrm{B}}(q_{\\mathrm{B}})\\,$. Interatomic Coulomb coupling is neglected. The equilibrium charges satisfy the neutrality constraint and minimize $\\,E\\,$.\n- The permanent dipole moment component along the bond axis is $\\,\\mu_z = q_{\\mathrm{B}}\\,R\\,$ in units of $\\,\\mathrm{e\\cdot\\AA}\\,$, which must be converted to Debye. Use the conversion factor $\\,1\\,\\mathrm{e\\cdot\\AA} = 4.80320471257\\,\\mathrm{D}\\,$. Report the signed value of $\\,\\mu_z\\,$ in Debye, where a positive value corresponds to a net positive charge on atom $\\,\\mathrm{B}\\,$.\n\nUse the following atomic parameters, each given by the ionization energy $\\,I\\,$ and electron affinity $\\,A\\,$ in electronvolt. For each element $\\,X\\,$, compute $\\,\\chi_X = \\tfrac{1}{2}(I_X + A_X)\\,$ and $\\,\\eta_X = I_X - A_X\\,$.\n\n- Carbon $\\,(\\mathrm{C})$: $\\,I_{\\mathrm{C}} = 11.2603\\,$, $\\,A_{\\mathrm{C}} = 1.2621\\,$.\n- Nitrogen $\\,(\\mathrm{N})$: $\\,I_{\\mathrm{N}} = 14.5341\\,$, $\\,A_{\\mathrm{N}} = -0.0700\\,$.\n- Oxygen $\\,(\\mathrm{O})$: $\\,I_{\\mathrm{O}} = 13.6181\\,$, $\\,A_{\\mathrm{O}} = 1.4611\\,$.\n\nTest suite (each case specifies atom labels and bond length):\n\n- Case $\\,1\\,$: cyanide radical $\\,\\cdot\\text{CN}\\,$ (open-shell), treated as a neutral diatomic $\\,\\mathrm{C}-\\mathrm{N}\\,$ with $\\,\\mathrm{A}=\\mathrm{C}\\,$, $\\,\\mathrm{B}=\\mathrm{N}\\,$, and $\\,R = 1.171\\,$ Angstrom.\n- Case $\\,2\\,$: dinitrogen $\\,\\text{N}_2\\,$ with $\\,\\mathrm{A}=\\mathrm{N}\\,$, $\\,\\mathrm{B}=\\mathrm{N}\\,$, and $\\,R = 1.098\\,$ Angstrom.\n- Case $\\,3\\,$: carbon monoxide $\\,\\text{CO}\\,$ with $\\,\\mathrm{A}=\\mathrm{C}\\,$, $\\,\\mathrm{B}=\\mathrm{O}\\,$, and $\\,R = 1.128\\,$ Angstrom.\n\nYour program must, for each case, determine the charge distribution $\\,q_{\\mathrm{A}}\\,$ and $\\,q_{\\mathrm{B}}\\,$ that minimizes $\\,E(q_{\\mathrm{A}},q_{\\mathrm{B}})\\,$ subject to $\\,q_{\\mathrm{A}} + q_{\\mathrm{B}} = 0\\,$, and then compute the dipole component $\\,\\mu_z\\,$ in Debye. Express each result in Debye, rounded to three decimal places.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite cases $\\,1\\,$ to $\\,3\\,$. For example, $[\\mu_1, \\mu_2, \\mu_3]$ where each $\\,\\mu_k\\,$ is a float rounded to three decimal places in Debye.", "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically sound within the framework of a simplified charge equilibration model, mathematically well-posed, and provides all necessary information for a unique solution. The task is a direct application of specified physical and mathematical principles. We will now proceed with the solution.\n\nThe problem requires the calculation of the permanent electric dipole moment for three diatomic species using a charge equilibration model. The foundation of this model is the principle of electronegativity equalization, which states that charge flows between atoms in a molecule until a state of minimum energy is achieved, corresponding to a uniform chemical potential throughout the system.\n\nThe energy of an isolated atom $i$ is approximated as a quadratic function of its net charge $q_i$:\n$$E_i(q_i) = \\chi_i q_i + \\frac{1}{2} \\eta_i q_i^2$$\nwhere $\\chi_i$ is the Mulliken electronegativity and $\\eta_i$ is the absolute hardness. The total electronic energy of the diatomic molecule $\\mathrm{A}-\\mathrm{B}$ is the sum of the energies of its constituent atoms, neglecting the interatomic Coulomb interaction as specified:\n$$E(q_{\\mathrm{A}}, q_{\\mathrm{B}}) = E_{\\mathrm{A}}(q_{\\mathrm{A}}) + E_{\\mathrm{B}}(q_{\\mathrm{B}}) = \\left(\\chi_{\\mathrm{A}} q_{\\mathrm{A}} + \\frac{1}{2} \\eta_{\\mathrm{A}} q_{\\mathrm{A}}^2\\right) + \\left(\\chi_{\\mathrm{B}} q_{\\mathrm{B}} + \\frac{1}{2} \\eta_{\\mathrm{B}} q_{\\mathrm{B}}^2\\right)$$\nThe system is subject to the constraint of overall charge neutrality:\n$$q_{\\mathrm{A}} + q_{\\mathrm{B}} = 0 \\implies q_{\\mathrm{A}} = -q_{\\mathrm{B}}$$\nTo find the equilibrium charge distribution, we minimize the total energy $E$ with respect to the amount of transferred charge. Let us define the transferred charge as $q = q_{\\mathrm{B}}$, which implies $q_{\\mathrm{A}} = -q$. Substituting this into the energy expression gives a function of a single variable $q$:\n$$E(q) = \\left(\\chi_{\\mathrm{A}} (-q) + \\frac{1}{2} \\eta_{\\mathrm{A}} (-q)^2\\right) + \\left(\\chi_{\\mathrm{B}} q + \\frac{1}{2} \\eta_{\\mathrm{B}} q^2\\right)$$\n$$E(q) = (\\chi_{\\mathrm{B}} - \\chi_{\\mathrm{A}})q + \\frac{1}{2}(\\eta_{\\mathrm{A}} + \\eta_{\\mathrm{B}})q^2$$\nThis is a quadratic function of $q$. To find the minimum, we set the first derivative with respect to $q$ equal to zero:\n$$\\frac{dE}{dq} = \\chi_{\\mathrm{B}} - \\chi_{\\mathrm{A}} + (\\eta_{\\mathrm{A}} + \\eta_{\\mathrm{B}})q = 0$$\nSolving for the equilibrium charge $q = q_{\\mathrm{B}}$ yields:\n$$q_{\\mathrm{B}} = \\frac{\\chi_{\\mathrm{A}} - \\chi_{\\mathrm{B}}}{\\eta_{\\mathrm{A}} + \\eta_{\\mathrm{B}}}$$\nThe second derivative, $\\frac{d^2E}{dq^2} = \\eta_{\\mathrm{A}} + \\eta_{\\mathrm{B}}$, is positive since hardness $\\eta_i = I_i - A_i$ is positive for all relevant atoms, confirming that this solution corresponds to a minimum in energy.\n\nFirst, we calculate the required atomic parameters $\\chi_X = \\frac{1}{2}(I_X + A_X)$ and $\\eta_X = I_X - A_X$ from the given ionization energies ($I$) and electron affinities ($A$), all in units of electronvolt ($\\mathrm{eV}$):\nFor Carbon ($\\mathrm{C}$), with $I_{\\mathrm{C}} = 11.2603\\,\\mathrm{eV}$ and $A_{\\mathrm{C}} = 1.2621\\,\\mathrm{eV}$:\n$$\\chi_{\\mathrm{C}} = \\frac{1}{2}(11.2603 + 1.2621) = 6.2612\\,\\mathrm{eV}$$\n$$\\eta_{\\mathrm{C}} = 11.2603 - 1.2621 = 9.9982\\,\\mathrm{eV}$$\nFor Nitrogen ($\\mathrm{N}$), with $I_{\\mathrm{N}} = 14.5341\\,\\mathrm{eV}$ and $A_{\\mathrm{N}} = -0.0700\\,\\mathrm{eV}$:\n$$\\chi_{\\mathrm{N}} = \\frac{1}{2}(14.5341 - 0.0700) = 7.23205\\,\\mathrm{eV}$$\n$$\\eta_{\\mathrm{N}} = 14.5341 - (-0.0700) = 14.6041\\,\\mathrm{eV}$$\nFor Oxygen ($\\mathrm{O}$), with $I_{\\mathrm{O}} = 13.6181\\,\\mathrm{eV}$ and $A_{\\mathrm{O}} = 1.4611\\,\\mathrm{eV}$:\n$$\\chi_{\\mathrm{O}} = \\frac{1}{2}(13.6181 + 1.4611) = 7.5396\\,\\mathrm{eV}$$\n$$\\eta_{\\mathrm{O}} = 13.6181 - 1.4611 = 12.1570\\,\\mathrm{eV}$$\n\nNow, we compute the dipole moment for each test case. The dipole moment component along the bond axis is $\\mu_z = q_{\\mathrm{A}}z_{\\mathrm{A}} + q_{\\mathrm{B}}z_{\\mathrm{B}}$. With atom $\\mathrm{A}$ at $z=0$ and atom $\\mathrm{B}$ at $z=R$, this simplifies to $\\mu_z = q_{\\mathrm{B}}R$. The result in units of $\\mathrm{e\\cdot\\AA}$ is converted to Debye ($\\mathrm{D}$) using the factor $1\\,\\mathrm{e\\cdot\\AA} = 4.80320471257\\,\\mathrm{D}$.\n\n**Case 1: Cyanide radical ($\\mathrm{C}-\\mathrm{N}$)**\n$\\mathrm{A}=\\mathrm{C}$, $\\mathrm{B}=\\mathrm{N}$, $R = 1.171\\,\\mathrm{\\AA}$.\n$$q_{\\mathrm{N}} = \\frac{\\chi_{\\mathrm{C}} - \\chi_{\\mathrm{N}}}{\\eta_{\\mathrm{C}} + \\eta_{\\mathrm{N}}} = \\frac{6.2612 - 7.23205}{9.9982 + 14.6041} = \\frac{-0.97085}{24.6023} \\approx -0.039461\\,e$$\n$$\\mu_z = q_{\\mathrm{N}} R = (-0.039461\\,e) \\times (1.171\\,\\mathrm{\\AA}) \\approx -0.046209\\,\\mathrm{e\\cdot\\AA}$$\n$$\\mu_z \\approx -0.046209 \\times 4.80320471257\\,\\mathrm{D} \\approx -0.22195\\,\\mathrm{D}$$\nRounded to three decimal places, $\\mu_z = -0.222\\,\\mathrm{D}$.\n\n**Case 2: Dinitrogen ($\\mathrm{N}_2$)**\n$\\mathrm{A}=\\mathrm{N}$, $\\mathrm{B}=\\mathrm{N}$, $R = 1.098\\,\\mathrm{\\AA}$.\nFor a homonuclear diatomic, $\\chi_{\\mathrm{A}} = \\chi_{\\mathrm{B}}$, so the numerator $\\chi_{\\mathrm{A}} - \\chi_{\\mathrm{B}} = 0$.\n$$q_{\\mathrm{N}} = \\frac{\\chi_{\\mathrm{N}} - \\chi_{\\mathrm{N}}}{\\eta_{\\mathrm{N}} + \\eta_{\\mathrm{N}}} = 0$$\nTherefore, there is no charge transfer and the dipole moment is zero.\n$$\\mu_z = 0.000\\,\\mathrm{D}$$\n\n**Case 3: Carbon monoxide ($\\mathrm{C}-\\mathrm{O}$)**\n$\\mathrm{A}=\\mathrm{C}$, $\\mathrm{B}=\\mathrm{O}$, $R = 1.128\\,\\mathrm{\\AA}$.\n$$q_{\\mathrm{O}} = \\frac{\\chi_{\\mathrm{C}} - \\chi_{\\mathrm{O}}}{\\eta_{\\mathrm{C}} + \\eta_{\\mathrm{O}}} = \\frac{6.2612 - 7.5396}{9.9982 + 12.1570} = \\frac{-1.2784}{22.1552} \\approx -0.057702\\,e$$\n$$\\mu_z = q_{\\mathrm{O}} R = (-0.057702\\,e) \\times (1.128\\,\\mathrm{\\AA}) \\approx -0.065087\\,\\mathrm{e\\cdot\\AA}$$\n$$\\mu_z \\approx -0.065087 \\times 4.80320471257\\,\\mathrm{D} \\approx -0.31262\\,\\mathrm{D}$$\nRounded to three decimal places, $\\mu_z = -0.313\\,\\mathrm{D}$.\n\nIt is instructive to note that for carbon monoxide, this simple model predicts a small dipole with the negative end on the oxygen atom, as would be expected from naive electronegativity arguments. Experimentally, the dipole moment of $\\mathrm{CO}$ is very small ($0.112\\,\\mathrm{D}$) and, counter-intuitively, the negative pole is on the carbon atom. This discrepancy highlights the limitations of the employed model, which neglects critical factors such as orbital hybridization and the spatial extent of charge distributions, especially lone pairs. However, the calculation correctly implements the provided model.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the permanent electric dipole moment for three diatomic species\n    using a first-principles-inspired charge equilibration model.\n    \"\"\"\n\n    # Atomic parameters: Ionization Energy (I) and Electron Affinity (A) in eV.\n    atomic_params = {\n        'C': {'I': 11.2603, 'A': 1.2621},\n        'N': {'I': 14.5341, 'A': -0.0700},\n        'O': {'I': 13.6181, 'A': 1.4611},\n    }\n\n    # Test cases: (Atom A, Atom B, Bond length R in Angstrom)\n    test_cases = [\n        ('C', 'N', 1.171),  # Case 1: CN radical\n        ('N', 'N', 1.098),  # Case 2: N2\n        ('C', 'O', 1.128),  # Case 3: CO\n    ]\n\n    # Conversion factor from e.Angstrom to Debye\n    E_ANGSTROM_TO_DEBYE = 4.80320471257\n\n    results = []\n\n    # Pre-calculate model parameters chi (electronegativity) and eta (hardness)\n    model_params = {}\n    for symbol, params in atomic_params.items():\n        I = params['I']\n        A = params['A']\n        chi = 0.5 * (I + A)\n        eta = I - A\n        model_params[symbol] = {'chi': chi, 'eta': eta}\n\n    for case in test_cases:\n        atom_A_symbol, atom_B_symbol, R = case\n\n        # Get parameters for atom A and atom B\n        params_A = model_params[atom_A_symbol]\n        params_B = model_params[atom_B_symbol]\n\n        chi_A, eta_A = params_A['chi'], params_A['eta']\n        chi_B, eta_B = params_B['chi'], params_B['eta']\n\n        # Calculate equilibrium charge on atom B (in units of elementary charge e)\n        # q_B = (chi_A - chi_B) / (eta_A + eta_B)\n        # A check to prevent division by zero, although not expected here\n        # as hardness (eta) is positive.\n        denominator = eta_A + eta_B\n        if denominator == 0:\n            # This case applies for homonuclear diatomics if chi values are identical.\n            # Charge transfer is zero.\n            q_B = 0.0\n        else:\n            q_B = (chi_A - chi_B) / denominator\n\n        # Calculate dipole moment along the bond axis (in e.Angstrom)\n        # mu_z = q_B * R\n        mu_z_eA = q_B * R\n\n        # Convert dipole moment to Debye\n        mu_z_debye = mu_z_eA * E_ANGSTROM_TO_DEBYE\n\n        # The problem asks for the result rounded to three decimal places.\n        # We use a formatted string to ensure this.\n        results.append(f\"{mu_z_debye:.3f}\")\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2451497"}, {"introduction": "Individual molecules rarely exist in a single, static state; they are dynamic entities that can adopt multiple shapes, or conformers, especially in a bulk sample. This final practice elevates our analysis from a single molecule to a statistical ensemble, connecting microscopic properties to macroscopic observables. You will calculate the distinct dipole moments and energies for the *anti* and *gauche* conformers of a butane model and then use Boltzmann statistics to predict the temperature-dependent, root-mean-square dipole moment of the entire sample, demonstrating how bulk properties emerge from the underlying conformational landscape [@problem_id:2451507].", "problem": "A neutral molecule consisting of four carbon sites is used to approximate conformational properties of *n*-butane. Two conformers are considered: the anti conformer with dihedral angle $\\phi_{\\text{anti}} = 180^{\\circ}$ about the central C–C bond, and the gauche conformer with $\\phi_{\\text{gauche}} = 60^{\\circ}$. For both conformers, the positions of the four carbon nuclei are constructed from internal coordinates as follows.\n\nLet the carbon–carbon bond length be $r_{\\mathrm{CC}}$ (in $\\mathrm{\\AA}$) and the carbon–carbon–carbon bond angle be $\\theta$ (in degrees). Define the first three carbon positions in Cartesian space by\n- $\\mathbf{r}_1 = (0,0,0)$,\n- $\\mathbf{r}_2 = (r_{\\mathrm{CC}},0,0)$,\n- $\\mathbf{r}_3 = \\mathbf{r}_2 + \\mathbf{d}_{23}$ with $\\mathbf{d}_{23} = \\left(r_{\\mathrm{CC}}\\cos(\\pi - \\theta_{\\mathrm{rad}}),\\; r_{\\mathrm{CC}}\\sin(\\pi - \\theta_{\\mathrm{rad}}),\\; 0\\right)$,\n\nwhere $\\theta_{\\mathrm{rad}}$ is $\\theta$ converted to radians. The fourth carbon position $\\mathbf{r}_4$ is built from the internal coordinates $(r_{\\mathrm{CC}}, \\theta, \\phi)$ relative to $(\\mathbf{r}_1,\\mathbf{r}_2,\\mathbf{r}_3)$ by\n$$\n\\begin{aligned}\n\\mathbf{e}_1 = \\frac{\\mathbf{r}_2 - \\mathbf{r}_3}{\\lVert \\mathbf{r}_2 - \\mathbf{r}_3 \\rVert},\\quad\n\\mathbf{e}_2^{\\prime} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert},\\quad\n\\mathbf{n} = \\frac{\\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1}{\\lVert \\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1 \\rVert},\\quad\n\\mathbf{e}_2 = \\mathbf{n} \\times \\mathbf{e}_1, \\\\\n\\theta_{\\mathrm{rad}} = \\theta \\times \\frac{\\pi}{180},\\quad \\phi_{\\mathrm{rad}} = \\phi \\times \\frac{\\pi}{180}, \\\\\n\\mathbf{r}_4 = \\mathbf{r}_3 + r_{\\mathrm{CC}}\\left(-\\cos\\theta_{\\mathrm{rad}}\\,\\mathbf{e}_1 + \\sin\\theta_{\\mathrm{rad}} \\left(\\cos\\phi_{\\mathrm{rad}}\\,\\mathbf{e}_2 + \\sin\\phi_{\\mathrm{rad}}\\,\\mathbf{n}\\right)\\right).\n\\end{aligned}\n$$\n\nApproximate the permanent electric dipole moment $\\boldsymbol{\\mu}$ of each conformer using four point charges located on the carbon sites. The partial charges (in units of the elementary charge $e$) are $\\left[q_1,q_2,q_3,q_4\\right] = \\left[+\\delta,-\\delta,-\\delta,+\\delta\\right]$, so that the net charge is zero. The dipole vector is\n$$\n\\boldsymbol{\\mu} = \\sum_{i=1}^{4} q_i\\,\\mathbf{r}_i,\n$$\nexpressed in $\\mathrm{e\\cdot\\AA}$. Its magnitude in Debye is given by\n$$\n\\mu\\,(\\mathrm{D}) = \\lVert \\boldsymbol{\\mu} \\rVert \\times \\left(4.80320427\\,\\frac{\\mathrm{D}}{\\mathrm{e\\cdot\\AA}}\\right).\n$$\n\nThe conformational energy as a function of the dihedral angle $\\phi$ (in radians) is modeled by the truncated Fourier torsional potential\n$$\nE(\\phi) = V_1 \\cos\\phi + V_2 \\cos(2\\phi) + V_3 \\cos(3\\phi),\n$$\nwith $V_1$, $V_2$, and $V_3$ in $\\mathrm{kcal\\,mol}^{-1}$. Convert energies to $\\mathrm{kJ\\,mol}^{-1}$ using $1\\,\\mathrm{kcal\\,mol}^{-1} = 4.184\\,\\mathrm{kJ\\,mol}^{-1}$.\n\nLet $E_{\\text{anti}} = E(\\phi_{\\text{anti}})$ and $E_{\\text{gauche}} = E(\\phi_{\\text{gauche}})$. The energy difference to report is\n$$\n\\Delta E = E_{\\text{gauche}} - E_{\\text{anti}}\n$$\nin $\\mathrm{kJ\\,mol}^{-1}$.\n\nAssume a thermal ensemble at absolute temperature $T$ in Kelvin with only the anti conformer and two degenerate gauche conformers ($\\phi = +60^{\\circ}$ and $\\phi = -60^{\\circ}$). The degeneracies are $g_{\\text{anti}} = 1$ and $g_{\\text{gauche}} = 2$. Using the ideal-gas constant $R = 8.314462618\\,\\mathrm{J\\,mol}^{-1}\\,\\mathrm{K}^{-1}$ and energies in $\\mathrm{J\\,mol}^{-1}$, define the Boltzmann probabilities\n$$\np_{\\text{anti}}(T) = \\frac{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)}}{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}},\\quad\np_{\\text{gauche}}(T) = \\frac{g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}.\n$$\n\nThe apparent dipole magnitude of the sample is defined here as the root-mean-square dipole,\n$$\n\\mu_{\\mathrm{rms}}(T) = \\sqrt{p_{\\text{anti}}(T)\\,\\mu_{\\text{anti}}^2 + p_{\\text{gauche}}(T)\\,\\mu_{\\text{gauche}}^2},\n$$\nexpressed in Debye. Angles must be in degrees where stated; convert to radians where needed. Energies must be reported in $\\mathrm{kJ\\,mol}^{-1}$, dipole magnitudes in Debye (D), and temperatures in Kelvin.\n\nTest Suite. For each parameter set below, compute:\n- the energy difference $\\Delta E$ in $\\mathrm{kJ\\,mol}^{-1}$,\n- the dipole magnitudes $\\mu_{\\text{anti}}$ and $\\mu_{\\text{gauche}}$ in Debye,\n- the apparent dipole magnitudes $\\mu_{\\mathrm{rms}}(200\\,\\mathrm{K})$ and $\\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})$ in Debye.\n\nParameter sets:\n1) $\\delta = 0.10$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 112.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.4$, $V_3 = 0.6$ (all $V_i$ in $\\mathrm{kcal\\,mol}^{-1}$).\n2) $\\delta = 0.00$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 112.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.4$, $V_3 = 0.6$ (all $V_i$ in $\\mathrm{kcal\\,mol}^{-1}$).\n3) $\\delta = 0.20$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 110.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.2$, $V_3 = 0.4$ (all $V_i$ in $\\mathrm{kcal\\,mol}^{-1}$).\n\nFinal Output Format. Your program should produce a single line of output containing the results as a comma-separated list of three five-element lists, one per parameter set, in this exact order of elements per set:\n$$\n[\\Delta E,\\ \\mu_{\\text{anti}},\\ \\mu_{\\text{gauche}},\\ \\mu_{\\mathrm{rms}}(200\\,\\mathrm{K}),\\ \\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})].\n$$\nFor the whole test suite, print a single line:\n$$\n[ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot] ].\n$$\nAll floats must be expressed in the units specified above.", "solution": "The task requires building conformer geometries from internal coordinates, computing conformer dipole moments from point charges, evaluating conformer energies from a torsional potential, and then predicting the temperature-dependent apparent dipole magnitude from Boltzmann statistics.\n\nGeometry construction. Place $\\mathbf{r}_1 = (0,0,0)$ and $\\mathbf{r}_2 = (r_{\\mathrm{CC}},0,0)$. The third carbon $\\mathbf{r}_3$ lies in the $xy$-plane defined by the first two atoms at a bond angle $\\theta$ relative to the $\\mathrm{C}_1–\\mathrm{C}_2–\\mathrm{C}_3$ angle. Using $\\theta_{\\mathrm{rad}} = \\theta \\pi/180$, \n$$\n\\mathbf{d}_{23} = \\left(r_{\\mathrm{CC}}\\cos(\\pi - \\theta_{\\mathrm{rad}}),\\ r_{\\mathrm{CC}}\\sin(\\pi - \\theta_{\\mathrm{rad}}),\\ 0\\right) = \\left(-r_{\\mathrm{CC}}\\cos\\theta_{\\mathrm{rad}},\\ r_{\\mathrm{CC}}\\sin\\theta_{\\mathrm{rad}},\\ 0\\right).\n$$\nThen $\\mathbf{r}_3 = \\mathbf{r}_2 + \\mathbf{d}_{23}$. The fourth carbon position $\\mathbf{r}_4$ is built by the standard internal-to-Cartesian mapping. Define unit vectors along the bond directions and the plane normal:\n$$\n\\mathbf{e}_1 = \\frac{\\mathbf{r}_2 - \\mathbf{r}_3}{\\lVert \\mathbf{r}_2 - \\mathbf{r}_3 \\rVert},\\quad\n\\mathbf{e}_2^{\\prime} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert},\\quad\n\\mathbf{n} = \\frac{\\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1}{\\lVert \\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1 \\rVert},\\quad\n\\mathbf{e}_2 = \\mathbf{n} \\times \\mathbf{e}_1.\n$$\nFor given bond length $r_{\\mathrm{CC}}$, bond angle $\\theta$, and dihedral angle $\\phi$, where both angles are converted to radians, the position is\n$$\n\\mathbf{r}_4 = \\mathbf{r}_3 + r_{\\mathrm{CC}}\\left(-\\cos\\theta_{\\mathrm{rad}}\\,\\mathbf{e}_1 + \\sin\\theta_{\\mathrm{rad}} \\left(\\cos\\phi_{\\mathrm{rad}}\\,\\mathbf{e}_2 + \\sin\\phi_{\\mathrm{rad}}\\,\\mathbf{n}\\right)\\right).\n$$\nChoosing $\\phi_{\\text{anti}} = \\pi$ and $\\phi_{\\text{gauche}} = \\pi/3$ yields planar anti and skew gauche geometries, respectively.\n\nDipole moment. With partial charges $\\left[q_1,q_2,q_3,q_4\\right] = \\left[+\\delta,-\\delta,-\\delta,+\\delta\\right]$ (in units of the elementary charge), the molecular dipole vector in $\\mathrm{e\\cdot\\AA}$ is\n$$\n\\boldsymbol{\\mu} = \\sum_{i=1}^{4} q_i\\,\\mathbf{r}_i.\n$$\nBecause the total charge is zero, $\\boldsymbol{\\mu}$ is independent of the choice of origin. The magnitude in Debye is\n$$\n\\mu\\,(\\mathrm{D}) = \\lVert \\boldsymbol{\\mu} \\rVert \\times 4.80320427.\n$$\nFor the anti conformer with an inversion center at the midpoint of the inner bond when the geometry is constructed with equal bond lengths and angles, the charge distribution is invariant under inversion, leading to $\\boldsymbol{\\mu} \\approx \\mathbf{0}$. The gauche conformer lacks inversion symmetry, producing a nonzero $\\mu$ whose magnitude increases with $\\delta$ and depends on geometry.\n\nConformer energies and difference. The torsional potential is defined as\n$$\nE(\\phi) = V_1 \\cos\\phi + V_2 \\cos(2\\phi) + V_3 \\cos(3\\phi),\n$$\nwith $V_i$ in $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$. The energies at $\\phi_{\\text{anti}}$ and $\\phi_{\\text{gauche}}$ are computed, converted to $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ by multiplying by $4.184$, and the difference\n$$\n\\Delta E = E_{\\text{gauche}} - E_{\\text{anti}}\n$$\nis reported in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. The chosen parameters produce $E_{\\text{anti}}  E_{\\text{gauche}}$ with a typical alkane-like stabilization of the anti conformer.\n\nThermal populations and apparent dipole. At temperature $T$, using degeneracies $g_{\\text{anti}}=1$ and $g_{\\text{gauche}}=2$ to represent the two equivalent gauche states, the partition function over these states is\n$$\nZ = g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)},\n$$\nand the probabilities are\n$$\np_{\\text{anti}} = \\frac{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)}}{Z},\\quad\np_{\\text{gauche}} = \\frac{g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}{Z}.\n$$\nBecause the ensemble is isotropic, the vector-average dipole vanishes, and the apparent magnitude relevant for orientationally averaged observables is the root-mean-square dipole\n$$\n\\mu_{\\mathrm{rms}}(T) = \\sqrt{p_{\\text{anti}}(T)\\,\\mu_{\\text{anti}}^2 + p_{\\text{gauche}}(T)\\,\\mu_{\\text{gauche}}^2}.\n$$\n\nAlgorithmic realization. For each test case: construct $\\mathbf{r}_1,\\mathbf{r}_2,\\mathbf{r}_3$ and then $\\mathbf{r}_4$ for $\\phi_{\\text{anti}}$ and $\\phi_{\\text{gauche}}$; compute $\\mu_{\\text{anti}}$ and $\\mu_{\\text{gauche}}$ from the charges and positions; evaluate $E_{\\text{anti}}$ and $E_{\\text{gauche}}$, convert to $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, and compute $\\Delta E$; compute $p_{\\text{anti}}(T)$ and $p_{\\text{gauche}}(T)$ at $T=200\\,\\mathrm{K}$ and $T=500\\,\\mathrm{K}$ using $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ with energies converted to $\\mathrm{J}\\,\\mathrm{mol}^{-1}$; finally compute $\\mu_{\\mathrm{rms}}(T)$ at both temperatures. Report for each test case the five-tuple $[\\Delta E,\\ \\mu_{\\text{anti}},\\ \\mu_{\\text{gauche}},\\ \\mu_{\\mathrm{rms}}(200\\,\\mathrm{K}),\\ \\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})]$ in the specified units and aggregate them into a single-line list.", "answer": "```python\nimport numpy as np\n\n# Constants\nDEBYE_PER_E_ANG = 4.80320427  # 1 e*Angstrom = 4.80320427 Debye\nKCAL_TO_KJ = 4.184            # 1 kcal/mol = 4.184 kJ/mol\nR_J_PER_MOLK = 8.314462618    # Gas constant in J/(mol*K)\n\ndef deg2rad(deg: float) - float:\n    return deg * np.pi / 180.0\n\ndef unit(v: np.ndarray) - np.ndarray:\n    n = np.linalg.norm(v)\n    if n == 0.0:\n        return v\n    return v / n\n\ndef build_initial_three(r_cc: float, theta_deg: float):\n    # r1 at origin, r2 on x-axis, r3 in xy-plane\n    r1 = np.array([0.0, 0.0, 0.0])\n    r2 = np.array([r_cc, 0.0, 0.0])\n    theta = deg2rad(theta_deg)\n    d23 = np.array([r_cc * np.cos(np.pi - theta), r_cc * np.sin(np.pi - theta), 0.0])\n    r3 = r2 + d23\n    return r1, r2, r3\n\ndef place_fourth(r1: np.ndarray, r2: np.ndarray, r3: np.ndarray,\n                 r_cc: float, theta_deg: float, dihedral_deg: float) - np.ndarray:\n    theta = deg2rad(theta_deg)\n    phi = deg2rad(dihedral_deg)\n    e1 = unit(r2 - r3)\n    e2p = unit(r1 - r2)\n    n = unit(np.cross(e2p, e1))\n    # Handle potential collinearity by adjusting n if needed\n    if np.linalg.norm(n) == 0.0:\n        # In rare degenerate cases, pick an arbitrary perpendicular\n        # Choose a vector not parallel to e1\n        tmp = np.array([1.0, 0.0, 0.0])\n        if abs(np.dot(e1, tmp))  0.99:\n            tmp = np.array([0.0, 1.0, 0.0])\n        n = unit(np.cross(tmp, e1))\n    e2 = np.cross(n, e1)\n    r4 = r3 + r_cc * (-np.cos(theta) * e1 + np.sin(theta) * (np.cos(phi) * e2 + np.sin(phi) * n))\n    return r4\n\ndef dipole_magnitude_debye(positions: np.ndarray, charges_e: np.ndarray) - float:\n    # positions: (N,3), charges: (N,)\n    mu_vec_eA = (charges_e[:, None] * positions).sum(axis=0)\n    mu_mag_debye = np.linalg.norm(mu_vec_eA) * DEBYE_PER_E_ANG\n    return mu_mag_debye\n\ndef torsion_energy_kj_per_mol(phi_deg: float, V1_kcal: float, V2_kcal: float, V3_kcal: float) - float:\n    phi = deg2rad(phi_deg)\n    E_kcal = V1_kcal * np.cos(phi) + V2_kcal * np.cos(2.0 * phi) + V3_kcal * np.cos(3.0 * phi)\n    return E_kcal * KCAL_TO_KJ\n\ndef boltzmann_populations(E_anti_kJ: float, E_gauche_kJ: float, T: float):\n    # Include degeneracy: g_anti=1, g_gauche=2\n    g_anti = 1.0\n    g_gauche = 2.0\n    # Convert energies to J/mol\n    Ea = E_anti_kJ * 1000.0\n    Eg = E_gauche_kJ * 1000.0\n    beta = 1.0 / (R_J_PER_MOLK * T)\n    wa = g_anti * np.exp(-beta * Ea)\n    wg = g_gauche * np.exp(-beta * Eg)\n    Z = wa + wg\n    pa = wa / Z\n    pg = wg / Z\n    return pa, pg\n\ndef compute_case(delta_e: float, r_cc: float, theta_deg: float, V1: float, V2: float, V3: float):\n    # Build coordinates for anti and gauche\n    r1, r2, r3 = build_initial_three(r_cc, theta_deg)\n    r4_anti = place_fourth(r1, r2, r3, r_cc, theta_deg, 180.0)\n    r4_gauche = place_fourth(r1, r2, r3, r_cc, theta_deg, 60.0)\n    # Charges on carbons\n    charges = np.array([+delta_e, -delta_e, -delta_e, +delta_e])\n    # Positions arrays\n    pos_anti = np.vstack([r1, r2, r3, r4_anti])\n    pos_gauche = np.vstack([r1, r2, r3, r4_gauche])\n    # Dipoles\n    mu_anti = dipole_magnitude_debye(pos_anti, charges)\n    mu_gauche = dipole_magnitude_debye(pos_gauche, charges)\n    # Energies\n    E_anti_kJ = torsion_energy_kj_per_mol(180.0, V1, V2, V3)\n    E_gauche_kJ = torsion_energy_kj_per_mol(60.0, V1, V2, V3)\n    deltaE_kJ = E_gauche_kJ - E_anti_kJ\n    # Apparent dipoles at 200 K and 500 K\n    results = []\n    for T in (200.0, 500.0):\n        p_anti, p_gauche = boltzmann_populations(E_anti_kJ, E_gauche_kJ, T)\n        mu_rms = np.sqrt(p_anti * (mu_anti ** 2) + p_gauche * (mu_gauche ** 2))\n        results.append(mu_rms)\n    mu_rms_200, mu_rms_500 = results\n    return [deltaE_kJ, mu_anti, mu_gauche, mu_rms_200, mu_rms_500]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (delta, r_cc, theta_deg, V1, V2, V3)\n    test_cases = [\n        (0.10, 1.540, 112.0, 0.0, -0.4, 0.6),\n        (0.00, 1.540, 112.0, 0.0, -0.4, 0.6),\n        (0.20, 1.540, 110.0, 0.0, -0.2, 0.4),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, r_cc, theta_deg, V1, V2, V3 = case\n        res = compute_case(delta, r_cc, theta_deg, V1, V2, V3)\n        # Format to a reasonable number of decimals for readability\n        res_fmt = [float(f\"{x:.6f}\") for x in res]\n        results.append(res_fmt)\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2451507"}]}