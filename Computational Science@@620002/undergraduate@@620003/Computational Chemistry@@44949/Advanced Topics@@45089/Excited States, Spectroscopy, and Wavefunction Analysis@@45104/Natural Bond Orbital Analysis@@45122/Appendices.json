{"hands_on_practices": [{"introduction": "A foundational skill in computational chemistry is the ability to connect quantitative output with intuitive chemical concepts. This first practice focuses on that core task by asking you to interpret a standard Natural Bond Orbital (NBO) analysis snippet for lithium hydride (LiH). By examining the percentage contributions of each atom to the bond, you will directly determine the bond's polarity, learning how NBO translates a complex wavefunction into a clear, localized bonding picture [@problem_id:1383438].", "problem": "A computational chemistry student is investigating the electronic structure of lithium hydride (LiH) using a quantum chemistry software package. After performing a calculation, the student runs a Natural Bond Orbital (NBO) analysis to understand the nature of the chemical bond between the two atoms. The NBO analysis transforms the complex molecular orbitals into a more intuitive picture of localized bonds and lone pairs. For the primary bonding orbital between lithium (atom 1) and hydrogen (atom 2), the program provides the following output snippet:\n\n```\n(1.98765) BD (1) Li 1 - H 2\n          ( 12.34%)   0.3513*Li 1 s(100.00%)\n          ( 87.66%)   0.9363*H  2 s(100.00%)\n```\n\nHere, `BD (1)` refers to the first bonding orbital, `(1.98765)` is its electron occupation, the percentages `(12.34%)` and `(87.66%)` represent the contribution of each atom's orbital to the bond, and the numerical values `0.3513` and `0.9363` are the coefficients of the respective atomic orbitals in the linear combination that forms the bond.\n\nBased exclusively on the NBO data provided, which of the following statements most accurately describes the polarity of the Li-H bond?\n\nA. The bond is polarized towards Hydrogen, as indicated by Hydrogen's larger percentage contribution (87.66%) to the bonding orbital.\n\nB. The bond is polarized towards Lithium, because as the atom with the smaller coefficient (0.3513), it attracts the electron density more strongly.\n\nC. The bond is essentially nonpolar, because the bonding orbital is formed from pure s-orbitals on both atoms, indicating symmetric sharing.\n\nD. The bond is polarized towards Lithium, because the analysis lists the Lithium atom first in the `Li 1 - H 2` designation.\n\nE. The provided data is insufficient to determine the bond's polarity, as this requires the electronegativity values for Li and H.", "solution": "We interpret the NBO bonding orbital as a normalized linear combination of atomic orbitals on Li and H. Let the primary bonding NBO be\n$$\n\\psi_{\\text{BD}}=c_{\\text{Li}}\\chi_{\\text{Li s}}+c_{\\text{H}}\\chi_{\\text{H s}},\n$$\nwith normalization\n$$\n|c_{\\text{Li}}|^{2}+|c_{\\text{H}}|^{2}=1.\n$$\nThe NBO report gives $c_{\\text{Li}}=0.3513$ and $c_{\\text{H}}=0.9363$. Squaring the coefficients yields the orbital fractions on each atom:\n$$\n|c_{\\text{Li}}|^{2}\\approx 0.3513^{2}\\approx 0.1234,\\quad |c_{\\text{H}}|^{2}\\approx 0.9363^{2}\\approx 0.8766.\n$$\nThese match the reported atomic contributions (0.1234 and 0.8766, respectively). The electron occupation of this bonding NBO is $n\\approx 1.98765$ electrons, so the electron populations associated with this bond on each atom are\n$$\nn_{\\text{Li}}=n\\,|c_{\\text{Li}}|^{2},\\qquad n_{\\text{H}}=n\\,|c_{\\text{H}}|^{2}.\n$$\nSince $|c_{\\text{H}}|^{2}\\gg |c_{\\text{Li}}|^{2}$, it follows that $n_{\\text{H}}\\gg n_{\\text{Li}}$, i.e., the bonding electron density is predominantly localized on hydrogen. Therefore, the bond is polarized toward hydrogen.\n\nThis directly rules out the alternatives:\n- The smaller coefficient on lithium does not imply stronger attraction of electron density; rather, it indicates a smaller contribution to the bonding NBO, so option B is incorrect.\n- The fact that both basis functions are $s$-type does not imply nonpolarity; the highly unequal weights demonstrate polarity, so option C is incorrect.\n- The listing order “Li 1 - H 2” is purely nominative and not indicative of polarity, so option D is incorrect.\n- The NBO contributions themselves provide sufficient information about the direction of bond polarization; one does not need external electronegativity values to conclude the direction from these data, so option E is incorrect.\n\nHence, the correct statement is that the bond is polarized toward hydrogen due to its much larger contribution to the bonding orbital.", "answer": "$$\\boxed{A}$$", "id": "1383438"}, {"introduction": "Beyond describing localized bonds, the true power of NBO analysis lies in its ability to quantify stabilizing delocalization effects like hyperconjugation. This practice takes you \"under the hood\" of the NBO program by tasking you with implementing the core formula for this stabilization, which is derived from second-order perturbation theory. By calculating the energetic penalty of deleting hyperconjugative interactions in a model of the ethyl cation, you will gain a first-principles understanding of how NBO quantifies the energy of electron delocalization [@problem_id:2459166].", "problem": "You are asked to formalize, from first principles, how Natural Bond Orbital (NBO) deletion analysis quantifies the energetic effect of removing hyperconjugative interactions, and to implement the resulting expression in a program. In Natural Bond Orbital (NBO) analysis, a hyperconjugative stabilization arises from donor–acceptor mixing between an occupied donor natural bond orbital and a formally unoccupied acceptor natural bond orbital. In a deletion analysis (the NBO $DELETE$ keyword), a specified set of donor–acceptor couplings is removed, and the energetic penalty of this removal is equal to the stabilization that those couplings had provided. Starting from the Hartree–Fock picture and standard time-independent, non-degenerate second-order perturbation theory, derive the leading-order expression for the stabilization energy due to the interaction between one occupied donor and one empty acceptor in terms of the donor occupancy, the off-diagonal Fock matrix element, and the orbital energy gap. Generalize this to a sum over multiple donor–acceptor interactions that model the hyperconjugation in the ethyl cation. Then implement this expression to compute the total destabilization energy when these interactions are deleted.\n\nAssumptions and data model:\n- Work in the Hartree–Fock framework with orthonormal Natural Bond Orbital (NBO) basis functions.\n- Let $i$ index an occupied donor natural bond orbital with occupancy $n_i$, one-electron (Fock) energy $\\epsilon_i$ (in Hartree), and let $j$ denote a single acceptor orbital with energy $\\epsilon_j$ (in Hartree).\n- The coupling between donor $i$ and acceptor $j$ is given by the off-diagonal Fock matrix element $F_{ij}$ (in Hartree).\n- Use the convention that the energetic penalty upon deletion equals the positive magnitude of the stabilization that was present before deletion.\n- Convert energies from Hartree to kilocalories per mole using $1\\,\\text{Hartree} = 627.509\\,\\text{kcal}\\,\\text{mol}^{-1}$.\n- Express all final answers in $\\text{kcal}\\,\\text{mol}^{-1}$ as floats rounded to three decimal places.\n\nTest suite to implement and evaluate:\n- Case A (ethyl cation model, three C–H $\\sigma$ donors): one acceptor with $\\epsilon_j = -0.30$, three donors with identical donor energy $\\epsilon_i = -0.90$, donor occupancies $n_i = 1.98$ for each donor, and off-diagonal couplings $F_{ij} \\in \\{0.045, 0.038, 0.032\\}$. Report the total destabilization energy when these three hyperconjugative interactions are deleted.\n- Case B (weak/zero coupling edge case): same $\\epsilon_j = -0.30$, same $\\epsilon_i = -0.90$, donor occupancies $n_i = 1.98$ for each donor, and $F_{ij} \\in \\{0.005, 0.000, 0.002\\}$. Report the total destabilization.\n- Case C (small energy gap edge case): one acceptor with $\\epsilon_j = -0.50$, two donors with identical donor energy $\\epsilon_i = -0.55$, donor occupancies $n_i = 1.98$ for each donor, and $F_{ij} \\in \\{0.010, 0.012\\}$. Report the total destabilization.\n- Case D (single strong donor): one acceptor with $\\epsilon_j = -0.25$, one donor with $\\epsilon_i = -1.00$, donor occupancy $n_i = 1.90$, and $F_{ij} = 0.060$. Report the destabilization.\n\nScientific realism constraints:\n- Assume $\\epsilon_j > \\epsilon_i$ so that the donor–acceptor gap $\\Delta_{ij} = \\epsilon_j - \\epsilon_i$ is positive. Assume $n_i$ is close to $2.00$ for $\\sigma$ bonds and $F_{ij}$ is small compared to $\\Delta_{ij}$, ensuring the validity of second-order perturbation theory.\n\nYour program must:\n- Implement the derived expression to compute the total destabilization energy for each case as a sum over donors interacting with the specified acceptor.\n- Treat all input values as being in Hartree, apply the conversion to $\\text{kcal}\\,\\text{mol}^{-1}$, and round each case result to three decimal places.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [Case A, Case B, Case C, Case D]. For example, the output format must be exactly like [$x_A$,$x_B$,$x_C$,$x_D$] where each $x$ is a float rounded to three decimals in $\\text{kcal}\\,\\text{mol}^{-1}$, with no additional text.", "solution": "The problem as stated is scientifically sound, well-posed, and objective. It presents a standard task in computational chemistry: the derivation and application of the second-order perturbation theory expression for hyperconjugative stabilization energy within the Natural Bond Orbital (NBO) framework. All necessary data and constraints are provided, and the problem is free of logical or factual contradictions. We may therefore proceed with the derivation.\n\nThe objective is to formalize the stabilization energy, $\\Delta E_{i \\rightarrow j}$, that arises from the interaction between an occupied donor NBO, denoted by the wavefunction $|\\phi_i\\rangle$, and an empty acceptor NBO, $|\\phi_j\\rangle$. We work within the Hartree-Fock approximation, where the effective one-electron Hamiltonian is the Fock operator, $\\hat{F}$.\n\nIn the NBO basis, which is assumed to be orthonormal, the Fock matrix is not diagonal. The diagonal elements, $F_{kk} = \\langle \\phi_k | \\hat{F} | \\phi_k \\rangle$, are the NBO orbital energies, which we denote as $\\epsilon_k$. The off-diagonal elements, $F_{ij} = \\langle \\phi_i | \\hat{F} | \\phi_j \\rangle$ for $i \\neq j$, represent the coupling or interaction between different NBOs. These off-diagonal elements are precisely what give rise to delocalization effects such as hyperconjugation.\n\nTo quantify the energetic effect of these interactions, we employ time-independent, non-degenerate perturbation theory. We partition the Fock operator $\\hat{F}$ into two parts: an unperturbed Hamiltonian $\\hat{H}^{(0)}$ and a perturbation $\\hat{V}$.\n\nThe unperturbed system, $\\hat{H}^{(0)}$, is defined as the diagonal part of the Fock operator in the NBO basis. Its eigenfunctions are the NBOs themselves, $|\\phi_k\\rangle$, with corresponding eigenvalues being the NBO energies, $\\epsilon_k$:\n$$\n\\hat{H}^{(0)} |\\phi_k\\rangle = \\epsilon_k |\\phi_k\\rangle\n$$\nThe perturbation, $\\hat{V}$, comprises all off-diagonal elements of the Fock operator. We are concerned with the specific interaction between donor $|\\phi_i\\rangle$ and acceptor $|\\phi_j\\rangle$, so the perturbation of interest involves the matrix element $F_{ij}$.\n\nAccording to standard second-order perturbation theory, the energy of the state $|\\phi_i\\rangle$ is lowered due to its interaction with another state $|\\phi_j\\rangle$. The second-order correction to the energy, $E_i^{(2)}$, is given by:\n$$\nE_i^{(2)} = \\sum_{j \\neq i} \\frac{|\\langle \\phi_i | \\hat{V} | \\phi_j \\rangle|^2}{\\epsilon_i - \\epsilon_j}\n$$\nIn our specific donor-acceptor case, the perturbation matrix element $\\langle \\phi_i | \\hat{V} | \\phi_j \\rangle$ is simply the off-diagonal Fock matrix element $F_{ij}$. The energy correction for the interaction between a single donor $|\\phi_i\\rangle$ and a single acceptor $|\\phi_j\\rangle$ is thus:\n$$\n\\Delta E_i^{(2)} = \\frac{|F_{ij}|^2}{\\epsilon_i - \\epsilon_j}\n$$\nThis expression represents the energy change for a single electron. The donor NBO $|\\phi_i\\rangle$ is occupied by $n_i$ electrons. Therefore, the total stabilization energy resulting from the delocalization of these $n_i$ electrons into the acceptor orbital $|\\phi_j\\rangle$ is:\n$$\n\\Delta E_{i \\rightarrow j} = n_i \\times \\Delta E_i^{(2)} = n_i \\frac{|F_{ij}|^2}{\\epsilon_i - \\epsilon_j}\n$$\nThe problem specifies that the donor energy $\\epsilon_i$ is lower than the acceptor energy $\\epsilon_j$, so the denominator $\\epsilon_i - \\epsilon_j$ is negative. This makes $\\Delta E_{i \\rightarrow j}$ a negative quantity, correctly representing a stabilization of the system's total energy.\n\nThe NBO deletion analysis computes the energetic *penalty* associated with removing this interaction. This penalty is defined as the positive magnitude of the stabilization energy. Let us denote this quantity by $E^{(2)}_{i \\rightarrow j}$:\n$$\nE^{(2)}_{i \\rightarrow j} = |\\Delta E_{i \\rightarrow j}| = \\left| n_i \\frac{|F_{ij}|^2}{\\epsilon_i - \\epsilon_j} \\right| = n_i \\frac{|F_{ij}|^2}{\\epsilon_j - \\epsilon_i}\n$$\nSince $F_{ij}$ is given as a real number, $|F_{ij}|^2$ simplifies to $F_{ij}^2$. The final expression for the destabilization energy upon deleting a single donor-acceptor interaction is:\n$$\nE^{(2)}_{i \\rightarrow j} = n_i \\frac{F_{ij}^2}{\\epsilon_j - \\epsilon_i}\n$$\nThis is the fundamental expression used in NBO analysis to estimate the strength of hyperconjugative and other delocalization effects. The problem requires this to be generalized for the case of multiple donors, indexed by $k$, interacting with a single acceptor $j$. Assuming the contributions are additive, which is valid under the small-perturbation approximation, the total destabilization energy, $E_{\\text{total}}$, is the sum of the individual contributions:\n$$\nE_{\\text{total}} = \\sum_{k} E^{(2)}_{i_k \\rightarrow j} = \\sum_{k} n_{i_k} \\frac{F_{i_k j}^2}{\\epsilon_j - \\epsilon_{i_k}}\n$$\nThis is the final expression to be implemented. The input values are provided in atomic units (Hartree), and the final result must be converted to kilocalories per mole using the provided conversion factor, $1\\,\\text{Hartree} = 627.509\\,\\text{kcal}\\,\\text{mol}^{-1}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements the NBO second-order perturbation theory expression\n    for hyperconjugative stabilization energy.\n    \"\"\"\n\n    # Conversion factor from Hartree to kcal/mol.\n    HARTREE_TO_KCAL_MOL = 627.509\n\n    # Define the test cases from the problem statement.\n    # Data structure for each case:\n    # (acceptor_energy, donor_energies, donor_occupancies, coupling_elements)\n    # Using numpy arrays for efficient, vectorized calculations.\n    test_cases = [\n        # Case A (ethyl cation model): 1 acceptor, 3 C-H sigma donors\n        (\n            -0.30,  # eps_j\n            np.array([-0.90, -0.90, -0.90]),  # eps_i\n            np.array([1.98, 1.98, 1.98]),  # n_i\n            np.array([0.045, 0.038, 0.032]),  # F_ij\n        ),\n        # Case B (weak/zero coupling): 1 acceptor, 3 donors\n        (\n            -0.30,  # eps_j\n            np.array([-0.90, -0.90, -0.90]),  # eps_i\n            np.array([1.98, 1.98, 1.98]),  # n_i\n            np.array([0.005, 0.000, 0.002]),  # F_ij\n        ),\n        # Case C (small energy gap): 1 acceptor, 2 donors\n        (\n            -0.50,  # eps_j\n            np.array([-0.55, -0.55]),  # eps_i\n            np.array([1.98, 1.98]),  # n_i\n            np.array([0.010, 0.012]),  # F_ij\n        ),\n        # Case D (single strong donor): 1 acceptor, 1 donor\n        (\n            -0.25,  # eps_j\n            np.array([-1.00]),  # eps_i\n            np.array([1.90]),  # n_i\n            np.array([0.060]),  # F_ij\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        eps_j, eps_i_arr, n_i_arr, F_ij_arr = case\n\n        # Calculate the energy gap (denominator): delta_eps = eps_j - eps_i\n        # This is a vectorized operation: a scalar minus an array.\n        delta_eps_ij = eps_j - eps_i_arr\n        \n        # Calculate the second-order stabilization energy for each donor-acceptor pair.\n        # The formula derived is E_stabilization = n_i * F_ij^2 / (eps_j - eps_i)\n        # This is performed element-wise on the numpy arrays.\n        energies_hartree = n_i_arr * (F_ij_arr**2) / delta_eps_ij\n        \n        # The total destabilization energy is the sum of all individual contributions.\n        total_energy_hartree = np.sum(energies_hartree)\n        \n        # Convert the total energy from Hartree to kcal/mol.\n        total_energy_kcal_mol = total_energy_hartree * HARTREE_TO_KCAL_MOL\n        \n        # Round the final result to three decimal places as required.\n        rounded_result = round(total_energy_kcal_mol, 3)\n        results.append(rounded_result)\n\n    # Final print statement must produce a single line in the format [res_A,res_B,res_C,res_D].\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2459166"}, {"introduction": "Having learned to interpret NBO output and quantify stabilizing interactions, you are now equipped to analyze complex molecules like ozone ($O_3$) where simple bonding models fall short. This exercise explores how NBO handles resonance by selecting a single, optimal Lewis structure and treating delocalization as a set of quantifiable donor-acceptor interactions. Mastering this concept is crucial for understanding how NBO reconciles the localized bond concept with the reality of delocalized electronic systems, providing a powerful and nuanced view of chemical bonding [@problem_id:2459178].", "problem": "A Natural Bond Orbital (NBO) analysis is performed on ozone, $O_3$, in its closed-shell electronic ground state. Consider what the analysis would report regarding the primary Lewis structure, the treatment of delocalization, natural charges, and bond-order measures derived from the NBO basis. Which of the following statements are consistent with how NBO analysis represents $O_3$?\n\nA. The primary Lewis structure reported by NBO exhibits $2$ equivalent $O\\!-\\!O$ bonds with no formal charge separation, matching the resonance hybrid taught in introductory chemistry.\n\nB. The primary Lewis structure reported by NBO selects $1$ charge-separated structure with $1$ $O\\!=\\!O$ linkage and $1$ $O\\!-\\!O$ linkage; electron delocalization is then captured as donor–acceptor interactions between lone pairs and antibonding orbitals outside the Lewis structure.\n\nC. Because $O_3$ is delocalized, NBO cannot assign a primary Lewis structure and returns only non-Lewis orbitals for the $O\\!-\\!O$ region.\n\nD. In the second-order perturbation analysis of donor–acceptor interactions, a dominant interaction appears corresponding to donation from a lone pair on the terminal oxygen that is single-bonded in the primary Lewis structure into the $\\pi^\\ast$ antibonding orbital associated with the adjacent $O\\!=\\!O$ unit.\n\nE. The Wiberg bond indices computed in the NBO basis are exactly $2.0$ and $1.0$ for the two $O\\!-\\!O$ bonds, reflecting the double and single bonds chosen in the primary Lewis structure.\n\nF. The natural atomic charges from NBO tend to place a positive charge on the central oxygen and a more negative charge on the terminal oxygen that is single-bonded in the primary Lewis structure.", "solution": "Natural Bond Orbital (NBO) analysis starts from the one-particle density matrix and performs a sequence of transformations to obtain natural atomic orbitals (NAOs), natural hybrid orbitals (NHOs), and finally natural bond orbitals (NBOs). The central organizing principle is to find a set of localized Lewis-type orbitals (two-center two-electron bonds and lone pairs) that maximizes the occupancy in these Lewis orbitals and minimizes the residual density in non-Lewis (antibonding and Rydberg) orbitals. The resulting “primary Lewis structure” is the single most important valence-bond-like electron-pairing pattern consistent with the density. Delocalization that is not accommodated within this Lewis picture is then represented by donor–acceptor interactions between filled (donor) and empty (acceptor) NBOs and quantified by second-order perturbation stabilization energies. Wiberg bond indices derived in the NBO/NAO basis provide fractional measures of bond order obtained from the density.\n\nFor ozone, $O_3$, there are $3$ oxygen atoms with $6$ valence electrons each, for a total of $18$ valence electrons. Introductory chemistry often depicts $O_3$ as a resonance hybrid of two charge-separated Lewis structures, each with one $O\\!=\\!O$ double bond and one $O\\!-\\!O$ single bond, resulting in two equivalent $O\\!-\\!O$ bonds in the averaged picture. In contrast, the NBO procedure, by construction, chooses a single dominant Lewis structure that best localizes electron pairs. For $O_3$, this primary structure is one of the charge-separated forms with one $O\\!=\\!O$ bond and one $O\\!-\\!O$ bond. The partial equalization of the two $O\\!-\\!O$ bonds observed experimentally emerges in NBO as a consequence of specific donor–acceptor delocalizations, most prominently lone-pair donation from the terminal oxygen that is single-bonded in the primary structure into the adjacent $\\pi^\\ast$ antibonding orbital of the $O\\!=\\!O$ unit. This $n\\!(\\mathrm{O}) \\rightarrow \\pi^\\ast(O\\!-\\!O)$ interaction reduces electron density in the $\\pi$ bond and increases it in the adjacent region, leading to fractional bond orders between $1$ and $2$ for both $O\\!-\\!O$ links rather than exact integers. Natural charges reflect the electron distribution in the chosen Lewis structure and the delocalization pattern: the central oxygen, which shares electron density with both neighbors, tends to bear positive charge relative to the terminals; the terminal that is single-bonded in the primary structure tends to carry the most negative charge due to its greater lone-pair character and its role as donor.\n\nNow evaluate each option:\n\nA. Claiming that the primary Lewis structure has $2$ equivalent $O\\!-\\!O$ bonds with no charge separation confuses the resonance hybrid with the NBO primary Lewis structure. NBO selects a single dominant Lewis structure, not the averaged hybrid; for $O_3$ this is one of the charge-separated forms with unequal bonds. Therefore this is Incorrect.\n\nB. This accurately describes the NBO framework for $O_3$: one charge-separated primary Lewis structure with one $O\\!=\\!O$ and one $O\\!-\\!O$, and delocalization represented by donor–acceptor interactions outside the Lewis space. Therefore this is Correct.\n\nC. NBO always assigns a primary Lewis structure for typical closed-shell main-group molecules; delocalization is handled via non-Lewis interactions, not by abandoning the Lewis structure. Therefore this is Incorrect.\n\nD. The key delocalization that connects the two canonical charge-separated forms is $n\\!(\\mathrm{O}) \\rightarrow \\pi^\\ast$ donation from the terminal oxygen that is single-bonded in the primary structure into the adjacent $\\pi^\\ast$ of the $O\\!=\\!O$ bond. This is typically a dominant second-order perturbation interaction in NBO for $O_3$, consistent with the partial bond equalization. Therefore this is Correct.\n\nE. Wiberg bond indices are continuous measures derived from the electron density; they are not constrained to integer values and, for $O_3$, both $O\\!-\\!O$ bonds have indices between $1$ and $2$, not exactly $2.0$ and $1.0$, because of delocalization. Therefore this is Incorrect.\n\nF. Natural charges in the NBO framework for the chosen primary structure generally place positive charge on the central oxygen and more negative charge on the terminal that is single-bonded in the primary structure, consistent with the charge-separated Lewis form and donor behavior of that terminal. Therefore this is Correct.\n\nThe correct options are B, D, and F.", "answer": "$$\\boxed{BDF}$$", "id": "2459178"}]}