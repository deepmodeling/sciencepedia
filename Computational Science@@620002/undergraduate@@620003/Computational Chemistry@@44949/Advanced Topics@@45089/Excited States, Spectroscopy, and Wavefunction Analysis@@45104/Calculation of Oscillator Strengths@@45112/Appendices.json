{"hands_on_practices": [{"introduction": "Before tackling entire molecules, it's crucial to understand how oscillator strengths arise from the fundamental building blocks of quantum chemistry: the basis functions. This first practice challenges you to derive and compute the oscillator strength for a transition between two simple Gaussian-type orbitals from scratch [@problem_id:2451550]. By working through the analytic integrals, you will gain a firsthand appreciation for how the spatial extent of orbitals—distinguishing compact valence states from diffuse Rydberg states—directly impacts the predicted intensity of spectroscopic transitions.", "problem": "You will model electric dipole oscillator strengths in Atomic Units (a.u.) for one-electron transitions using normalized, same-center, primitive Cartesian Gaussian-type orbitals (GTOs). The initial (ground) state is a normalized s-type GTO, and the final (excited) state is a normalized p-type GTO oriented along the x-axis. The s-type basis function is defined as $\\phi_{s}(\\mathbf{r};\\alpha)=N_{s}\\exp(-\\alpha r^{2})$ and the p-type basis function is defined as $\\phi_{p_{x}}(\\mathbf{r};\\beta)=N_{p}(x)\\exp(-\\beta r^{2})$, both centered at the origin, where $r=\\|\\mathbf{r}\\|$, $\\alpha>0$, and $\\beta>0$. The normalization constants $N_{s}$ and $N_{p}$ are determined by the conditions $\\int_{\\mathbb{R}^{3}}|\\phi_{s}|^{2}\\,d^{3}r=1$ and $\\int_{\\mathbb{R}^{3}}|\\phi_{p_{x}}|^{2}\\,d^{3}r=1$, respectively. Work in the electric dipole approximation and length gauge, so that the oscillator strength for a transition from the ground state $\\phi_{s}$ to the excited state $\\phi_{p_{x}}$ is given by\n$$\nf=\\frac{2}{3}\\,\\Delta E\\,\\left|\\langle \\phi_{s}|\\hat{\\mathbf{r}}|\\phi_{p_{x}}\\rangle\\right|^{2},\n$$\nwhere $\\Delta E$ is the transition energy in Hartree, and the dipole matrix element reduces to a single nonzero Cartesian component $\\mu_{x}=\\langle \\phi_{s}|x|\\phi_{p_{x}}\\rangle$ for the $\\phi_{p_{x}}$ final state. All integrals are over $\\mathbb{R}^{3}$, and all distances are in Bohr. The oscillator strength $f$ is dimensionless. You must evaluate the normalization constants and the dipole matrix element from first principles by analytic integration and then compute $f$.\n\nTo investigate the effect of including diffuse functions in the basis for Rydberg versus valence transitions, use the following parameters:\n- Ground s-type exponent: $\\alpha=1.0$ (in $\\text{Bohr}^{-2}$).\n- Valence p-type exponent (compact): $\\beta_{\\text{val}}=1.0$ (in $\\text{Bohr}^{-2}$).\n- Diffuse p-type exponent: $\\beta_{\\text{diff}}=0.1$ (in $\\text{Bohr}^{-2}$).\n- Very diffuse p-type exponent (edge case): $\\beta_{\\text{vdiff}}=0.05$ (in $\\text{Bohr}^{-2}$).\n- Valence transition energy: $\\Delta E_{\\text{val}}=0.3$ (in Hartree).\n- Rydberg transition energy: $\\Delta E_{\\text{ryd}}=0.15$ (in Hartree).\n- Near-threshold Rydberg transition energy (edge case): $\\Delta E_{\\text{thr}}=0.01$ (in Hartree).\n\nCompute the oscillator strength $f$ for the following five test cases, each defined by a pair $(\\Delta E,\\beta)$ with fixed $\\alpha=1.0$:\n1. Valence transition without diffuse functions: $(\\Delta E,\\beta)=\\left(0.3,\\,1.0\\right)$.\n2. Rydberg transition without diffuse functions (using compact basis only): $(\\Delta E,\\beta)=\\left(0.15,\\,1.0\\right)$.\n3. Rydberg transition with diffuse functions: $(\\Delta E,\\beta)=\\left(0.15,\\,0.1\\right)$.\n4. Rydberg transition with very diffuse functions (edge case): $(\\Delta E,\\beta)=\\left(0.15,\\,0.05\\right).\n5. Rydberg transition near the ionization threshold with diffuse functions (edge case): $(\\Delta E,\\beta)=\\left(0.01,\\,0.1\\right)$.\n\nYour program must output a single line containing the oscillator strengths for these five cases, in this exact order, as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places. For example, the output format must be of the form\n\"[v1,v2,v3,v4,v5]\"\nwhere $v_{k}$ denotes the rounded oscillator strength for test case $k$.", "solution": "The problem presented is a standard, well-posed exercise in computational quantum chemistry. It is scientifically grounded, free of contradictions, and contains all necessary information for a unique solution. We shall therefore proceed with the derivation and calculation.\n\nThe task is to compute the dimensionless oscillator strength, $f$, for an electric dipole transition between a ground $s$-type Gaussian-type orbital (GTO) and an excited $p_x$-type GTO. The GTOs are given by $\\phi_{s}(\\mathbf{r};\\alpha)=N_{s}\\exp(-\\alpha r^{2})$ and $\\phi_{p_{x}}(\\mathbf{r};\\beta)=N_{p}(x)\\exp(-\\beta r^{2})$. All quantities are in atomic units (Hartree for energy, Bohr for length).\n\nThe oscillator strength in the length gauge is given by the formula:\n$$\nf=\\frac{2}{3}\\,\\Delta E\\,\\left|\\langle \\phi_{s}|\\hat{\\mathbf{r}}|\\phi_{p_{x}}\\rangle\\right|^{2}\n$$\nwhere $\\Delta E$ is the transition energy. The dipole moment operator is $\\hat{\\mathbf{r}} = x\\hat{i} + y\\hat{j} + z\\hat{k}$. The calculation proceeds in three steps: normalization of the orbitals, evaluation of the transition dipole moment integral, and finally, computation of $f$.\n\nFirst, we determine the normalization constants $N_s$ and $N_p$ from first principles.\n\nThe normalization condition for the $s$-type orbital is $\\int_{\\mathbb{R}^{3}} |\\phi_s|^2 d^3r = 1$. Substituting the definition of $\\phi_s$:\n$$\nN_s^2 \\int_{\\mathbb{R}^{3}} \\exp(-2\\alpha r^2) d^3r = 1\n$$\nThe integral is separable in Cartesian coordinates, where $r^2 = x^2+y^2+z^2$:\n$$\n\\int_{\\mathbb{R}^{3}} \\exp(-2\\alpha r^2) d^3r = \\left( \\int_{-\\infty}^{\\infty} e^{-2\\alpha x^2} dx \\right)^3\n$$\nUsing the standard Gaussian integral $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$, with $a=2\\alpha$, we find:\n$$\n\\int_{\\mathbb{R}^{3}} \\exp(-2\\alpha r^2) d^3r = \\left(\\sqrt{\\frac{\\pi}{2\\alpha}}\\right)^3 = \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2}\n$$\nTherefore, $N_s^2 \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2} = 1$, which gives the normalization constant:\n$$\nN_s = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}\n$$\nThe normalization condition for the $p_x$-type orbital is $\\int_{\\mathbb{R}^{3}} |\\phi_{p_x}|^2 d^3r = 1$:\n$$\nN_p^2 \\int_{\\mathbb{R}^{3}} x^2 \\exp(-2\\beta r^2) d^3r = 1\n$$\nThis integral also separates in Cartesian coordinates:\n$$\n\\int_{\\mathbb{R}^{3}} x^2 e^{-2\\beta r^2} d^3r = \\left(\\int_{-\\infty}^{\\infty} x^2 e^{-2\\beta x^2} dx\\right) \\left(\\int_{-\\infty}^{\\infty} e^{-2\\beta y^2} dy\\right) \\left(\\int_{-\\infty}^{\\infty} e^{-2\\beta z^2} dz\\right)\n$$\nThe integrals over $y$ and $z$ are $\\sqrt{\\pi/(2\\beta)}$. The integral over $x$ is of the form $\\int_{-\\infty}^{\\infty} x^2 e^{-ax^2} dx = \\frac{1}{2a}\\sqrt{\\frac{\\pi}{a}}$. With $a=2\\beta$, this is $\\frac{1}{4\\beta}\\sqrt{\\frac{\\pi}{2\\beta}}$. The product of the three integrals is:\n$$\n\\left(\\frac{1}{4\\beta}\\sqrt{\\frac{\\pi}{2\\beta}}\\right) \\left(\\sqrt{\\frac{\\pi}{2\\beta}}\\right) \\left(\\sqrt{\\frac{\\pi}{2\\beta}}\\right) = \\frac{1}{4\\beta}\\left(\\frac{\\pi}{2\\beta}\\right)^{3/2}\n$$\nSo, $N_p^2 \\frac{1}{4\\beta}\\left(\\frac{\\pi}{2\\beta}\\right)^{3/2} = 1$, which gives the normalization constant:\n$$\nN_p^2 = 4\\beta \\left(\\frac{2\\beta}{\\pi}\\right)^{3/2} \\implies N_p = \\left(\\frac{128\\beta^5}{\\pi^3}\\right)^{1/4}\n$$\nNext, we evaluate the transition dipole moment vector, $\\langle \\phi_s | \\hat{\\mathbf{r}} | \\phi_{p_x} \\rangle$. The $y$- and $z$-components of this vector are zero due to symmetry. For instance, the integrand for the $y$-component, $\\phi_s y \\phi_{p_x} = N_s N_p x y \\exp(-(\\alpha+\\beta)r^2)$, is an odd function with respect to $x$ or $y$, and its integral over all space is zero. The only non-zero component is the $x$-component, $\\mu_x$:\n$$\n\\mu_x = \\langle \\phi_s | x | \\phi_{p_x} \\rangle = \\int_{\\mathbb{R}^{3}} \\phi_s(\\mathbf{r}) x \\phi_{p_x}(\\mathbf{r}) d^3r = N_s N_p \\int_{\\mathbb{R}^{3}} x^2 \\exp(-(\\alpha+\\beta)r^2) d^3r\n$$\nThe integral is of the same form as the normalization integral for $\\phi_{p_x}$, with $2\\beta$ replaced by $\\gamma = \\alpha+\\beta$. The value of the integral is $\\frac{1}{2\\gamma}\\left(\\frac{\\pi}{\\gamma}\\right)^{3/2} = \\frac{1}{2(\\alpha+\\beta)}\\left(\\frac{\\pi}{\\alpha+\\beta}\\right)^{3/2}$.\nThe squared magnitude of the transition dipole is therefore $\\mu_x^2$:\n$$\n\\mu_x^2 = (N_s N_p)^2 \\left( \\frac{1}{2(\\alpha+\\beta)}\\left(\\frac{\\pi}{\\alpha+\\beta}\\right)^{3/2} \\right)^2\n$$\nSubstituting the expressions for $N_s^2$ and $N_p^2$:\n$$\n\\mu_x^2 = N_s^2 N_p^2 \\left( \\frac{\\pi^{3}}{4(\\alpha+\\beta)^5} \\right) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} \\left(4\\beta \\left(\\frac{2\\beta}{\\pi}\\right)^{3/2}\\right) \\frac{\\pi^{3}}{4(\\alpha+\\beta)^5}\n$$\nSimplifying this expression yields:\n$$\n\\mu_x^2 = \\frac{(2\\alpha)^{3/2} \\cdot 4\\beta \\cdot (2\\beta)^{3/2}}{\\pi^3} \\frac{\\pi^3}{4(\\alpha+\\beta)^5} = \\frac{8 \\alpha^{3/2} \\beta^{5/2}}{(\\alpha+\\beta)^5}\n$$\nNow, we substitute this result into the formula for the oscillator strength $f$, noting that $\\left|\\langle \\phi_{s}|\\hat{\\mathbf{r}}|\\phi_{p_{x}}\\rangle\\right|^{2} = \\mu_x^2$:\n$$\nf = \\frac{2}{3} \\Delta E \\mu_x^2 = \\frac{2}{3} \\Delta E \\left( \\frac{8 \\alpha^{3/2} \\beta^{5/2}}{(\\alpha+\\beta)^5} \\right) = \\frac{16}{3} \\Delta E \\frac{\\alpha^{3/2} \\beta^{5/2}}{(\\alpha+\\beta)^5}\n$$\nThis is the final analytical expression. We are given $\\alpha=1.0$ for all test cases. The formula simplifies to:\n$$\nf = \\frac{16}{3} \\Delta E \\frac{\\beta^{5/2}}{(1.0+\\beta)^5}\n$$\nWe now apply this formula to the five specified test cases.\n\nCase 1: $(\\Delta E, \\beta) = (0.3, 1.0)$\n$f_1 = \\frac{16}{3} (0.3) \\frac{1.0^{5/2}}{(1.0+1.0)^5} = 1.6 \\frac{1}{32} = 0.05$.\nResult: $0.050000$\n\nCase 2: $(\\Delta E, \\beta) = (0.15, 1.0)$\n$f_2 = \\frac{16}{3} (0.15) \\frac{1.0^{5/2}}{(1.0+1.0)^5} = 0.8 \\frac{1}{32} = 0.025$.\nResult: $0.025000$\n\nCase 3: $(\\Delta E, \\beta) = (0.15, 0.1)$\n$f_3 = \\frac{16}{3} (0.15) \\frac{0.1^{5/2}}{(1.0+0.1)^5} = 0.8 \\frac{0.1^{2.5}}{1.1^5} \\approx 0.00157088$.\nResult: $0.001571$\n\nCase 4: $(\\Delta E, \\beta) = (0.15, 0.05)$\n$f_4 = \\frac{16}{3} (0.15) \\frac{0.05^{5/2}}{(1.0+0.05)^5} = 0.8 \\frac{0.05^{2.5}}{1.05^5} \\approx 0.00035041$.\nResult: $0.000350$\n\nCase 5: $(\\Delta E, \\beta) = (0.01, 0.1)$\n$f_5 = \\frac{16}{3} (0.01) \\frac{0.1^{5/2}}{(1.0+0.1)^5} \\approx 0.00010473$.\nResult: $0.000105$\n\nThese calculations demonstrate the importance of spatially diffuse basis functions (small $\\beta$) for describing Rydberg states. The oscillator strengths for transitions to Rydberg-like states (Cases 3, 4, 5) are significantly smaller than for the valence-like transition (Case 1), reflecting the reduced spatial overlap between the compact ground state and the diffuse excited state.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates oscillator strengths for one-electron transitions between\n    s-type and p-type Gaussian orbitals based on a derived analytical formula.\n    \"\"\"\n    \n    # The ground state s-type GTO exponent is fixed.\n    alpha = 1.0\n\n    # Test cases are defined as tuples of (Delta_E, beta).\n    # Delta_E is the transition energy in Hartree.\n    # beta is the exponent of the final p-type GTO in Bohr^-2.\n    test_cases = [\n        # Case 1: Valence transition, compact basis\n        (0.3, 1.0),\n        # Case 2: Rydberg transition, compact basis\n        (0.15, 1.0),\n        # Case 3: Rydberg transition, diffuse basis\n        (0.15, 0.1),\n        # Case 4: Rydberg transition, very diffuse basis\n        (0.15, 0.05),\n        # Case 5: Near-threshold Rydberg transition, diffuse basis\n        (0.01, 0.1)\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_E, beta = case\n        \n        # The analytical formula for the oscillator strength 'f' is:\n        # f = (16/3) * delta_E * (alpha^(3/2) * beta^(5/2)) / (alpha + beta)^5\n        # Since alpha is fixed at 1.0, the formula simplifies.\n        \n        numerator = (16.0 / 3.0) * delta_E * np.power(beta, 2.5)\n        denominator = np.power(alpha + beta, 5.0)\n        \n        f = numerator / denominator\n        \n        # Format the result to six decimal places as a string.\n        results.append(f\"{f:.6f}\")\n\n    # Final print statement in the exact required format: [v1,v2,v3,v4,v5]\n    print(f\"[{','.join(results)}]\")\n\n# Execute the main function.\nsolve()\n```", "id": "2451550"}, {"introduction": "With the fundamentals in place, we can now apply them to a real chemical system. This exercise utilizes the elegant Hückel model to investigate one of the most classic structure-property relationships in chemistry: how the length of a conjugated polyene chain affects its electronic absorption [@problem_id:2451614]. By calculating the oscillator strength for the HOMO-LUMO transition across a series of linear polyenes, you will computationally discover the principles that govern the color and spectroscopic intensity of many organic dyes.", "problem": "Consider the linear polyene series H-(CH=CH)$_n$-H, modeled as a one-dimensional conjugated chain of $N$ carbon $p_z$ orbitals, where $N=2n$ and $n$ is a positive integer. Use the following first-principles model and definitions.\n\n- Model the $\\pi$-electron system with a one-electron nearest-neighbor Hückel Hamiltonian (tight-binding Hamiltonian) in an orthonormal atomic-orbital basis, where the Hamiltonian matrix $\\mathbf{H}$ has elements $H_{ij}=\\alpha\\,\\delta_{ij}+\\beta\\,(\\delta_{i,j+1}+\\delta_{i,j-1})$ for sites $i,j\\in\\{1,\\dots,N\\}$. Work in atomic units (a.u.), where the elementary charge, electron mass, reduced Planck constant, and Bohr radius are all set to $1$. Use $\\alpha=0$ and $\\beta=-1$ (energies in hartree).\n- Place the atoms collinearly along the $x$-axis with uniform spacing $a=1$ (in bohr) and center the chain at the origin. Thus, for site index $i\\in\\{1,\\dots,N\\}$, take the position $x_i=a\\,(i-(N+1)/2)$.\n- Let the normalized one-electron molecular orbitals $\\{\\psi_k\\}_{k=1}^N$ be the orthonormal eigenvectors of $\\mathbf{H}$ with corresponding eigenvalues $\\{E_k\\}_{k=1}^N$ ordered in nondecreasing energy. For the closed-shell ground state with $N$ electrons (one $\\pi$ electron per carbon) and two opposite-spin electrons per spatial orbital, the Highest Occupied Molecular Orbital (HOMO) index is $k_{\\mathrm{H}}=N/2$ and the Lowest Unoccupied Molecular Orbital (LUMO) index is $k_{\\mathrm{L}}=N/2+1$.\n- Define the transition energy $\\Delta E=E_{k_{\\mathrm{L}}}-E_{k_{\\mathrm{H}}}$ (in hartree), and the length-gauge transition dipole moment along $x$ between the HOMO and LUMO as $\\mu_x=\\langle \\psi_{k_{\\mathrm{L}}}|\\hat{x}|\\psi_{k_{\\mathrm{H}}}\\rangle=\\sum_{i=1}^{N} c_{i,k_{\\mathrm{L}}}\\,c_{i,k_{\\mathrm{H}}}\\,x_i$, where $c_{i,k}$ is the coefficient of site $i$ in orbital $k$. In atomic units, the oscillator strength for this single-electron transition is\n$$\nf=\\frac{2}{3}\\,\\Delta E\\,|\\mu_x|^2,\n$$\nwhich is dimensionless.\n\nTask: For each specified chain length, compute the oscillator strength $f$ for the HOMO–LUMO transition using the above definitions.\n\nTest suite:\n- Use the five chain lengths $n\\in\\{1,2,3,5,10\\}$, which correspond to $N=2n\\in\\{2,4,6,10,20\\}$.\n- Each output must be a floating-point number representing $f$ for the given $n$ under the model above.\n\nFinal output format:\n- Your program must produce a single line containing a comma-separated list of the five oscillator strengths in the same order of $n$ as given above, enclosed in square brackets, with each value rounded to exactly six decimal places. For example, an acceptable format is $[0.123456,0.234567,0.345678,0.456789,0.567890]$.\n- The oscillator strength $f$ is dimensionless, so no physical unit is required.", "solution": "The problem statement is parsed and validated. It is found to be scientifically grounded, well-posed, and self-contained. It is a standard exercise in the application of the Hückel molecular orbital theory, a cornerstone of theoretical organic chemistry. The provided model, definitions, and parameters are internally consistent and allow for a unique solution. We may therefore proceed with the derivation and computation.\n\nThe system is a linear chain of $N$ sites, described by a one-dimensional nearest-neighbor tight-binding Hamiltonian. The matrix elements in the atomic orbital basis are given by $H_{ij}=\\alpha\\,\\delta_{ij}+\\beta\\,(\\delta_{i,j+1}+\\delta_{i,j-1})$. With the specified parameters $\\alpha=0$ and $\\beta=-1$ (in atomic units), the Hamiltonian matrix $\\mathbf{H}$ is a real symmetric tridiagonal matrix:\n$$\n\\mathbf{H} =\n\\begin{pmatrix}\n0 & -1 & 0 & \\dots & 0 \\\\\n-1 & 0 & -1 & \\dots & 0 \\\\\n0 & -1 & 0 & \\dots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\dots & 0\n\\end{pmatrix}_{N \\times N}\n$$\nThis is a standard problem in linear algebra with known analytical solutions for its eigenvalues and eigenvectors.\n\nThe non-degenerate eigenvalues $E_k$ are given by:\n$$\nE_k = \\alpha + 2\\beta \\cos\\left(\\frac{k\\pi}{N+1}\\right)\n$$\nFor $\\alpha=0$ and $\\beta=-1$, this simplifies to:\n$$\nE_k = -2 \\cos\\left(\\frac{k\\pi}{N+1}\\right) \\quad \\text{for } k=1, 2, \\dots, N\n$$\nSince $\\cos(x)$ is a decreasing function for $x \\in [0, \\pi]$, the energy levels $E_k$ are ordered non-decreasingly with the quantum number $k$.\n\nThe normalized eigenvectors, which represent the molecular orbitals $\\psi_k$, are given by their coefficients $c_{i,k}$ in the atomic orbital basis $\\{\\phi_i\\}_{i=1}^N$. The coefficient of the $i$-th atomic orbital in the $k$-th molecular orbital is:\n$$\nc_{i,k} = \\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{ik\\pi}{N+1}\\right) \\quad \\text{for } i,k=1, 2, \\dots, N\n$$\n\nThe problem considers a closed-shell ground state with $N$ electrons, where $N=2n$ is an even integer. The electrons occupy the lowest $N/2$ orbitals, with two electrons per orbital.\nThe Highest Occupied Molecular Orbital (HOMO) corresponds to the index $k_{\\mathrm{H}} = N/2$.\nThe Lowest Unoccupied Molecular Orbital (LUMO) corresponds to the index $k_{\\mathrm{L}} = N/2 + 1$.\n\nThe HOMO-LUMO transition energy, $\\Delta E$, is the difference between their energies:\n$$\n\\Delta E = E_{k_{\\mathrm{L}}} - E_{k_{\\mathrm{H}}} = E_{N/2+1} - E_{N/2}\n$$\nSubstituting the expression for $E_k$:\n$$\n\\Delta E = -2 \\cos\\left(\\frac{(N/2+1)\\pi}{N+1}\\right) - \\left(-2 \\cos\\left(\\frac{(N/2)\\pi}{N+1}\\right)\\right) = 2\\left[\\cos\\left(\\frac{N\\pi}{2(N+1)}\\right) - \\cos\\left(\\frac{(N+2)\\pi}{2(N+1)}\\right)\\right]\n$$\nUsing the trigonometric identity $\\cos(A) - \\cos(B) = -2 \\sin\\left(\\frac{A+B}{2}\\right) \\sin\\left(\\frac{A-B}{2}\\right)$, we find:\n$$\n\\frac{A+B}{2} = \\frac{\\pi}{2(N+1)}\\left(\\frac{N}{2} + \\frac{N+2}{2}\\right) = \\frac{\\pi(N+1)}{2(N+1)} = \\frac{\\pi}{2}\n$$\n$$\n\\frac{A-B}{2} = \\frac{\\pi}{2(N+1)}\\left(\\frac{N}{2} - \\frac{N+2}{2}\\right) = \\frac{-\\pi}{2(N+1)}\n$$\nThus,\n$$\n\\Delta E = 2\\left[-2 \\sin\\left(\\frac{\\pi}{2}\\right) \\sin\\left(-\\frac{\\pi}{2(N+1)}\\right)\\right] = 4 \\sin\\left(\\frac{\\pi}{2(N+1)}\\right)\n$$\nThis is a compact analytical expression for the HOMO-LUMO gap.\n\nNext, we evaluate the transition dipole moment, $\\mu_x$, along the chain axis. The chain is centered at the origin with atomic spacing $a=1$. The position of the $i$-th atom is $x_i = i - (N+1)/2$.\n$$\n\\mu_x = \\langle \\psi_{k_{\\mathrm{L}}} | \\hat{x} | \\psi_{k_{\\mathrm{H}}} \\rangle = \\sum_{i=1}^{N} c_{i,k_{\\mathrm{L}}} c_{i,k_{\\mathrm{H}}} x_i\n$$\nSubstituting the expressions for the coefficients $c_{i,k}$ and positions $x_i$:\n$$\n\\mu_x = \\sum_{i=1}^{N} \\left(\\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{ik_{\\mathrm{L}}\\pi}{N+1}\\right)\\right) \\left(\\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{ik_{\\mathrm{H}}\\pi}{N+1}\\right)\\right) \\left(i - \\frac{N+1}{2}\\right)\n$$\n$$\n\\mu_x = \\frac{2}{N+1} \\sum_{i=1}^{N} \\sin\\left(\\frac{i(N/2+1)\\pi}{N+1}\\right) \\sin\\left(\\frac{i(N/2)\\pi}{N+1}\\right) \\left(i - \\frac{N+1}{2}\\right)\n$$\nThis summation must be computed for each value of $N$. While a closed form exists, direct numerical summation is straightforward and precise for the modest values of $N$ required.\n\nFinally, the dimensionless oscillator strength, $f$, is calculated using the provided formula in atomic units:\n$$\nf = \\frac{2}{3} \\Delta E |\\mu_x|^2\n$$\nSince the molecular orbitals and positions are real, $\\mu_x$ is real, and $|\\mu_x|^2 = \\mu_x^2$.\n\nThe computational procedure is to implement these analytical formulas for each specified value of $n \\in \\{1, 2, 3, 5, 10\\}$, corresponding to $N=2n \\in \\{2, 4, 6, 10, 20\\}$, to find the oscillator strength $f$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the oscillator strength for the HOMO-LUMO transition in linear\n    polyenes H-(CH=CH)n-H using the Hückel model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases_n = [1, 2, 3, 5, 10]\n\n    results = []\n    for n in test_cases_n:\n        # Number of carbon atoms/p_z orbitals.\n        N = 2 * n\n\n        # HOMO and LUMO quantum numbers (1-based index).\n        k_H = N // 2\n        k_L = N // 2 + 1\n\n        # 1. Calculate the transition energy Delta_E.\n        # The analytical formula is Delta_E = 4 * sin(pi / (2 * (N + 1))).\n        delta_E = 4.0 * np.sin(np.pi / (2.0 * (N + 1.0)))\n\n        # 2. Calculate the transition dipole moment mu_x.\n        # mu_x = sum_{i=1 to N} c_{i,k_L} * c_{i,k_H} * x_i\n        # c_{i,k} = sqrt(2/(N+1)) * sin(i*k*pi/(N+1))\n        # The normalization factor (sqrt(2/(N+1)))^2 is pulled out of the sum.\n        norm_factor_squared = 2.0 / (N + 1.0)\n        \n        mu_x_sum = 0.0\n        for i in range(1, N + 1):\n            # Position of site i, centered at the origin.\n            x_i = float(i) - (N + 1.0) / 2.0\n            \n            # Arguments for the sine functions.\n            arg_H = (float(i) * float(k_H) * np.pi) / (N + 1.0)\n            arg_L = (float(i) * float(k_L) * np.pi) / (N + 1.0)\n            \n            # Product of coefficients (without normalization) and position.\n            term = np.sin(arg_L) * np.sin(arg_H) * x_i\n            mu_x_sum += term\n            \n        mu_x = norm_factor_squared * mu_x_sum\n\n        # 3. Calculate the oscillator strength f.\n        # f = (2/3) * Delta_E * |mu_x|^2\n        f = (2.0 / 3.0) * delta_E * mu_x**2\n        results.append(f)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{res:.6f}' for res in results])}]\")\n\nsolve()\n```", "id": "2451614"}, {"introduction": "Our final practice deepens the exploration of the Hückel model by posing a comparative chemical question: how do the spectroscopic properties of a carbanion and a carbocation with the same carbon backbone differ? This problem requires you to construct a model from first principles to calculate and compare the oscillator strengths for these oppositely charged species [@problem_id:2451592]. Successfully navigating this challenge will provide insight into the consequences of particle-hole symmetry and develop your skills in using computational models to analyze subtle, yet significant, chemical differences.", "problem": "You are to implement a complete and runnable program that models the lowest dipole-allowed electronic transition oscillator strength for a carbanion and a carbocation built on the same linear conjugated carbon skeleton. The modeling must be based on a minimal *Hückel* tight-binding description with one $p_z$ atomic orbital per carbon site, nearest-neighbor coupling, and the independent-particle electric dipole approximation in the length gauge. You must justify algorithmic choices from fundamental principles rather than using prepackaged formulas. The goals are to compute, for each specified carbon skeleton, the oscillator strength of the lowest dipole-allowed transition for the corresponding carbanion and carbocation, and to output the ratio of the anion’s value to the cation’s value.\n\nFundamental basis you must use:\n- Nonrelativistic, time-dependent perturbation theory with the electric dipole interaction in the length gauge, and the definition of oscillator strength in terms of transition probabilities between stationary states.\n- A single-particle independent-electron model for $\\pi$ electrons described by the *Hückel* Hamiltonian on a linear chain with zero differential overlap and uniform nearest-neighbor coupling.\n- Spin-adapted single excitations from a closed-shell ground state (that is, the spin-adapted combination of a single occupied-to-virtual excitation) to form the lowest-energy dipole-allowed excited state. If needed, explain clearly how spin enters the transition dipole in the independent-particle picture.\n- The one-electron position operator along the chain direction, with the *diagonal* atomic orbital approximation for the dipole integrals, so that the matrix element reduces to a coordinate-weighted sum over sites. Use the chain’s center-of-geometry as the origin to avoid trivial origin offsets.\n\nModel and numerical specifications to implement:\n- Use atomic units throughout (Hartree for energy and Bohr radii for length). Oscillator strengths are dimensionless.\n- Consider a linear chain of $N$ carbon sites arranged along the $x$ axis with uniform spacing $a$ (in Bohr radii). The site coordinates are $x_i = \\left(i-\\frac{N+1}{2}\\right) a$ for $i \\in \\{1,\\dots,N\\}$; assume $y_i=z_i=0$ for all $i$.\n- The *Hückel* Hamiltonian in the atomic orbital basis is $H_{ij} = \\alpha \\,\\delta_{ij} + \\beta$ if $|i-j|=1$, and $H_{ij}=0$ otherwise. Use $\\alpha=0$ and $\\beta=-0.2$ (in Hartree).\n- Assume each carbon contributes one $\\pi$ electron. Thus, for a skeleton of $N$ sites, the carbanion has $N+1$ $\\pi$ electrons and the carbocation has $N-1$ $\\pi$ electrons. Restrict to odd $N$ so that both are closed-shell ($\\frac{N\\pm 1}{2}$ doubly occupied orbitals).\n- Construct molecular orbitals by diagonalizing the Hamiltonian with zero overlap ($S = I$). Use the diagonal approximation for the one-electron dipole integral so that, in the molecular orbital basis, the occupied-to-virtual transition dipole component along $x$ is a coordinate-weighted sum over sites.\n- Enumerate all single occupied-to-virtual excitations, compute their excitation energies, and identify the lowest-energy transition that is dipole-allowed (nonzero transition dipole within a numerical tolerance). For that transition, compute the oscillator strength between the closed-shell ground state and the corresponding spin-adapted singly excited state.\n\nWhat to compute and report:\n- For each skeleton specified in the test suite below, compute the oscillator strength of the lowest allowed transition for the carbocation and the carbanion separately, then report the ratio $r = f_{\\text{anion}}/f_{\\text{cation}}$ for that skeleton.\n- Your program must compute these ratios for the following test suite (each case is an independent skeleton):\n  - Case $1$: $N=3$, $a=2.6$ Bohr.\n  - Case $2$: $N=5$, $a=2.6$ Bohr.\n  - Case $3$: $N=7$, $a=2.6$ Bohr.\n  - Case $4$: $N=3$, $a=1.0$ Bohr.\n  - Case $5$: $N=3$, $a=4.0$ Bohr.\n- The final output format must be a single line containing a Python-style list with the five ratios in order, each rendered as a floating-point number rounded to exactly six digits after the decimal point, with no spaces. For example, the output must look like $[r_1,r_2,r_3,r_4,r_5]$ such as $[1.234000,2.000000,3.141593,0.500000,0.250000]$.\n\nNotes and constraints:\n- Oscillator strengths are dimensionless; therefore, no physical unit is required for them. When you use any length or energy, it must be in atomic units, as specified above.\n- Angles are not used. If you need to express a percentage at any point, express it as a decimal or a fraction instead, but percentages are not required here.\n- Your program must be complete and runnable as-is, must not require any input, and must not do any file input/output. The only output must be the single required line described above.", "solution": "The problem as stated is valid. It presents a well-defined computational task based on established principles of quantum chemistry, specifically Hückel molecular orbital theory and time-dependent perturbation theory. All necessary physical and numerical parameters are provided, the model approximations are clearly specified, and the problem is free from scientific inaccuracies, contradictions, or ambiguities. It is a rigorous exercise in applying fundamental theory to a concrete physical system.\n\nWe are tasked with computing the ratio of oscillator strengths, $r = f_{\\text{anion}}/f_{\\text{cation}}$, for the lowest dipole-allowed electronic transition in carbanions and carbocations derived from linear, conjugated carbon chains of length $N$. The analysis proceeds from first principles as required.\n\nFirst, we describe the electronic structure using the Hückel Molecular Orbital (HMO) model. For a linear chain of $N$ carbon atoms, we consider one $p_z$ atomic orbital (AO), $|\\phi_i\\rangle$, per site $i$. The Hückel Hamiltonian matrix, $\\mathbf{H}$, in this AO basis is constructed under the assumption of zero for the onsite energy ($\\alpha=0$) and a uniform nearest-neighbor coupling parameter, $\\beta$. The matrix elements are thus:\n$$ H_{ij} = \\begin{cases} 0 & \\text{if } i=j \\\\ \\beta & \\text{if } |i-j|=1 \\\\ 0 & \\text{otherwise} \\end{cases} $$\nWith the zero-overlap approximation ($S_{ij} = \\delta_{ij}$), the molecular orbitals (MOs) $|\\psi_k\\rangle$ and their corresponding energies $\\epsilon_k$ are found by solving the eigenvalue problem $\\mathbf{H}\\mathbf{C} = \\mathbf{C}\\mathbf{E}$, where $\\mathbf{E}$ is the diagonal matrix of MO energies $\\epsilon_k$ and $\\mathbf{C}$ is the matrix of MO coefficients $C_{ik}$. The $k$-th MO is expressed as a linear combination of AOs: $|\\psi_k\\rangle = \\sum_{i=1}^N C_{ik} |\\phi_i\\rangle$. The numerical diagonalization of $\\mathbf{H}$ provides these energies and coefficients.\n\nThe ground electronic state of each species is constructed by filling the MOs with available $\\pi$-electrons according to the Aufbau principle. The problem specifies odd $N$, ensuring both the carbocation (with $N_e = N-1$ electrons) and the carbanion (with $N_e = N+1$ electrons) are closed-shell species.\n- For the carbocation with $N-1$ electrons, the lowest $(N-1)/2$ MOs are doubly occupied. Thus, the Highest Occupied Molecular Orbital (HOMO) is $|\\psi_k\\rangle$ with orbital index $k = (N-1)/2$, and the Lowest Unoccupied Molecular Orbital (LUMO) is $|\\psi_{k+1}\\rangle$ with index $k+1 = (N+1)/2$.\n- For the carbanion with $N+1$ electrons, the lowest $(N+1)/2$ MOs are doubly occupied. The HOMO is $|\\psi_k\\rangle$ with $k = (N+1)/2$, and the LUMO is $|\\psi_{k+1}\\rangle$ with index $k+1 = (N+3)/2$.\n(Note: Here, orbital indices $k$ are used in the mathematical sense, $k=1, \\dots, N$. In the implementation, these will be mapped to zero-based array indices).\n\nThe oscillator strength, $f_{0 \\to f}$, for an electric-dipole-allowed transition from an initial state $|\\Psi_0\\rangle$ to a final state $|\\Psi_f\\rangle$ is given in atomic units by:\n$$ f_{0 \\to f} = \\frac{2}{3} \\Delta E_{0f} |\\langle \\Psi_f | \\hat{\\mathbf{r}} | \\Psi_0 \\rangle|^2 $$\nwhere $\\Delta E_{0f}$ is the excitation energy and $\\langle \\Psi_f | \\hat{\\mathbf{r}} | \\Psi_0 \\rangle$ is the transition dipole moment. For a transition from a closed-shell ground state $|\\Psi_0\\rangle$ to a spin-adapted singlet singly-excited state $|{}^1\\Psi_i^a\\rangle$ (arising from an excitation of an electron from MO $|\\psi_i\\rangle$ to $|\\psi_a\\rangle$), the transition dipole moment is given by the Slater-Condon rules. The crucial point regarding spin is that the dipole operator is spin-independent, allowing transitions only between states of the same spin multiplicity. From a singlet ground state, only transitions to singlet excited states are allowed. The matrix element to a normalized spin-adapted singlet state $|{}^1\\Psi_i^a\\rangle = \\frac{1}{\\sqrt{2}}(|\\det(\\dots \\psi_i\\bar{\\psi}_a \\dots)\\rangle - |\\det(\\dots \\bar{\\psi}_i\\psi_a \\dots)\\rangle)$ evaluates to $\\langle {}^1\\Psi_i^a | \\hat{\\mathbf{r}} | \\Psi_0 \\rangle = \\sqrt{2} \\langle \\psi_a | \\hat{\\mathbf{r}}_1 | \\psi_i \\rangle$, where $\\hat{\\mathbf{r}}_1$ is the one-electron position operator. The factor of $\\sqrt{2}$ accounts for the two equivalent ways to form the singlet state from the single determinantal basis.\n\nSubstituting this into the formula for $f$, and noting our system is one-dimensional along the $x$-axis, the oscillator strength for the $i \\to a$ transition becomes:\n$$ f_{i \\to a} = \\frac{2}{3} \\Delta E_{ia} \\left( |\\sqrt{2} \\langle \\psi_a | \\hat{x}_1 | \\psi_i \\rangle|^2 \\right) = \\frac{4}{3} \\Delta E_{ia} |\\mu_{x,ia}|^2 $$\nwhere $\\mu_{x,ia} = \\langle \\psi_a | \\hat{x}_1 | \\psi_i \\rangle$ is the one-electron transition dipole moment along $x$. Within the Hückel model, the excitation energy is the difference in MO energies: $\\Delta E_{ia} = \\epsilon_a - \\epsilon_i$.\n\nTo compute $\\mu_{x,ia}$, we use the provided diagonal approximation for the dipole matrix elements in the AO basis, $\\langle \\phi_p | \\hat{x}_1 | \\phi_q \\rangle \\approx x_p \\delta_{pq}$, where $x_p = (p - (N+1)/2)a$ is the coordinate of site $p$. This reduces the integral to a sum over atomic sites:\n$$ \\mu_{x,ia} = \\sum_{p,q=1}^N C_{qa}^* C_{pi} \\langle \\phi_q | \\hat{x}_1 | \\phi_p \\rangle \\approx \\sum_{p=1}^N C_{pa} C_{pi} x_p $$\n(assuming real coefficients $C_{pk}$).\n\nThe lowest-energy excitation is the HOMO $\\to$ LUMO transition. For a linear chain with inversion symmetry, the MOs have definite parity. The parity of MO $|\\psi_k\\rangle$ is $(-1)^{k-1}$. The position operator $\\hat{x}$ has odd parity. The transition dipole $\\mu_{x,ia}$ is non-zero only if the integrand has even parity overall, which requires the parities of $|\\psi_i\\rangle$ and $|\\psi_a\\rangle$ to be different ($g \\leftrightarrow u$). For both the cation and anion, the HOMO and LUMO indices differ by one, $k \\to k+1$, so they always have opposite parity. Therefore, the HOMO $\\to$ LUMO transition is dipole-allowed and is the lowest-energy allowed transition we must consider.\n\nA key property of the Hückel model for alternant systems like a linear chain is particle-hole symmetry. The MO energies are symmetric about $\\alpha=0$. For an odd-$N$ chain, there is a non-bonding MO at energy $\\epsilon=0$. The cation HOMO $\\to$ LUMO transition is from the orbital just below the non-bonding MO to the non-bonding MO itself. The anion HOMO $\\to$ LUMO transition is from the non-bonding MO to the orbital just above it. Due to the symmetric energy spectrum, $\\epsilon_{k_{\\text{LUMO,cat}}} - \\epsilon_{k_{\\text{HOMO,cat}}} = \\epsilon_{k_{\\text{LUMO,an}}} - \\epsilon_{k_{\\text{HOMO,an}}}$. Thus, $\\Delta E_{\\text{cation}} = \\Delta E_{\\text{anion}}$.\n\nThis significantly simplifies the ratio $r$:\n$$ r = \\frac{f_{\\text{anion}}}{f_{\\text{cation}}} = \\frac{\\frac{4}{3} \\Delta E_{\\text{anion}} |\\mu_{x,\\text{anion}}|^2}{\\frac{4}{3} \\Delta E_{\\text{cation}} |\\mu_{x,\\text{cation}}|^2} = \\frac{|\\mu_{x,\\text{anion}}|^2}{|\\mu_{x,\\text{cation}}|^2} $$\nFurthermore, since $x_p \\propto a$, the transition moment $\\mu_x \\propto a$. The squared moments are $\\mu_x^2 \\propto a^2$. The factor of $a^2$ appears in both the numerator and denominator and cancels. Consequently, the ratio $r$ is independent of both $\\beta$ and $a$, and depends only on the number of sites, $N$.\n\nThe algorithm implemented is a direct translation of this analysis:\n1. For a given $N$, construct the $N \\times N$ Hückel Hamiltonian matrix $\\mathbf{H}$.\n2. Numerically diagonalize $\\mathbf{H}$ to obtain the MO energies and coefficient matrix $\\mathbf{C}$.\n3. For the cation, identify the HOMO and LUMO indices, extract the corresponding MO coefficient vectors, and calculate $\\mu_{x,\\text{cation}} = \\sum_p C_{p, \\text{LUMO}} C_{p, \\text{HOMO}} x_p$.\n4. For the anion, perform the analogous calculation for $\\mu_{x,\\text{anion}}$.\n5. Compute the ratio $r = (\\mu_{x,\\text{anion}} / \\mu_{x,\\text{cation}})^2$. Since the energy difference and bond length `a` cancel, they do not need to be used in the final ratio calculation, although they are part of the full oscillator strength expression. The implementation will compute the full oscillator strengths for conceptual clarity before taking the ratio.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the ratio of oscillator strengths for\n    carbanions and carbocations on linear conjugated carbon skeletons.\n    \"\"\"\n\n    def calculate_oscillator_strength_ratio(N, a, beta):\n        \"\"\"\n        Calculates the ratio f_anion / f_cation for a given skeleton.\n\n        Args:\n            N (int): The number of carbon sites in the linear chain.\n            a (float): The uniform spacing between sites in Bohr.\n            beta (float): The Hückel coupling parameter in Hartree.\n\n        Returns:\n            float: The ratio of oscillator strengths.\n        \"\"\"\n        # 1. Define system parameters\n        # Atom site indices p run from 1 to N, so Python indices run from 0 to N-1\n        site_indices = np.arange(1, N + 1)\n        # Atomic coordinates x_p, centered at the origin\n        x_coords = (site_indices - (N + 1) / 2.0) * a\n\n        # 2. Construct the Hückel Hamiltonian matrix\n        H = np.zeros((N, N))\n        for i in range(N - 1):\n            H[i, i + 1] = beta\n            H[i + 1, i] = beta\n        # Diagonal elements are alpha=0 by default\n\n        # 3. Solve the eigenvalue problem to get MO energies and coefficients\n        # np.linalg.eigh returns eigenvalues (energies) sorted in increasing order\n        # and corresponding eigenvectors (coefficients) as columns of C.\n        energies, C = np.linalg.eigh(H)\n\n        # 4. Calculation for the Carbocation (N-1 electrons)\n        # Number of occupied orbitals is (N-1)/2. Python index for HOMO is (N-1)/2 - 1.\n        homo_idx_cat = (N - 1) // 2 - 1\n        lumo_idx_cat = (N - 1) // 2\n        \n        # Get MO coefficients for HOMO and LUMO\n        Ci_cat = C[:, homo_idx_cat]\n        Ca_cat = C[:, lumo_idx_cat]\n\n        # Excitation energy\n        delta_E_cat = energies[lumo_idx_cat] - energies[homo_idx_cat]\n\n        # Transition dipole moment along x-axis\n        mu_x_cat = np.sum(Ci_cat * Ca_cat * x_coords)\n\n        # Oscillator strength\n        # f = (4/3) * dE * mu^2\n        f_cation = (4.0 / 3.0) * delta_E_cat * mu_x_cat**2\n\n        # 5. Calculation for the Carbanion (N+1 electrons)\n        # Number of occupied orbitals is (N+1)/2. Python index for HOMO is (N+1)/2 - 1.\n        homo_idx_an = (N + 1) // 2 - 1\n        lumo_idx_an = (N + 1) // 2\n        \n        # Get MO coefficients for HOMO and LUMO\n        Ci_an = C[:, homo_idx_an]\n        Ca_an = C[:, lumo_idx_an]\n        \n        # Excitation energy\n        delta_E_an = energies[lumo_idx_an] - energies[homo_idx_an]\n        \n        # Transition dipole moment\n        mu_x_an = np.sum(Ci_an * Ca_an * x_coords)\n        \n        # Oscillator strength\n        f_anion = (4.0 / 3.0) * delta_E_an * mu_x_an**2\n        \n        # 6. Compute and return the ratio\n        if f_cation == 0:\n            # Avoid division by zero, although it shouldn't happen for these systems\n            return np.nan\n        \n        ratio = f_anion / f_cation\n        return ratio\n\n    # Model parameters from the problem statement\n    beta = -0.2  # Hartree\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (3, 2.6),  # Case 1\n        (5, 2.6),  # Case 2\n        (7, 2.6),  # Case 3\n        (3, 1.0),  # Case 4\n        (3, 4.0),  # Case 5\n    ]\n\n    results = []\n    for N, a in test_cases:\n        ratio = calculate_oscillator_strength_ratio(N, a, beta)\n        # Format to exactly six decimal places as a string\n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2451592"}]}