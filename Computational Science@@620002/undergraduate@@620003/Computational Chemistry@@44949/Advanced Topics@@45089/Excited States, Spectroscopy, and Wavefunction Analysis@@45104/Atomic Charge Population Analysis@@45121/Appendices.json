{"hands_on_practices": [{"introduction": "Before we can use or critique a method, we must understand its mathematical foundation. This first practice [@problem_id:2449473] grounds you in the fundamental definition of Mulliken population analysis by having you derive the charge expressions for a simple diatomic molecule from first principles. By working through the algebra, you will gain an intimate understanding of how the total electron count, given by the trace of the product of the density ($P$) and overlap ($S$) matrices, is partitioned among atomic centers.", "problem": "Consider a diatomic molecule $A\\!-\\!B$ represented in a minimal atomic-orbital basis consisting of $2$ real, normalized but non-orthogonal basis functions $\\,\\phi_{A}\\,$ and $\\,\\phi_{B}\\,$, centered on nuclei $A$ and $B$, respectively. Let the overlap integrals be $S_{AA}=S_{BB}=1$ and $S_{AB}=S_{BA}$ with $0<S_{AB}<1$. The one-particle density matrix in this basis is $P$, which for a spin-restricted, closed-shell description is real and symmetric with elements $P_{AA}$, $P_{BB}$, and $P_{AB}=P_{BA}$. Let the nuclear charges be $Z_{A}$ and $Z_{B}$.\n\nUsing the fundamental definition of Mulliken population analysis for a non-orthogonal basis, derive closed-form symbolic expressions for the Mulliken atomic charges $q_{A}$ and $q_{B}$ in terms of $Z_{A}$, $Z_{B}$, $P_{AA}$, $P_{BB}$, $P_{AB}$, and $S_{AB}$. Express your final result as the ordered pair $(q_{A},q_{B})$.\n\nYour final answer must be a single, closed-form analytic expression. No numerical rounding is required, and no units are to be reported.", "solution": "The problem statement has been validated and is scientifically grounded, well-posed, and objective. It presents a standard exercise in computational chemistry theory.\n\nThe derivation of the Mulliken atomic charges begins with the fundamental relationship between the one-particle density matrix $P$, the overlap matrix $S$, and the total number of electrons $N$ in a non-orthogonal basis. The total electron population is given by the trace of the product of the density and overlap matrices:\n$$ N = \\mathrm{Tr}(PS) = \\sum_{\\mu, \\nu} P_{\\mu \\nu} S_{\\nu \\mu} $$\nIn the given minimal basis set consisting of two atomic orbitals, $\\phi_{A}$ and $\\phi_{B}$, the density matrix $P$ and the overlap matrix $S$ are $2 \\times 2$ matrices. The problem states that $P$ is real and symmetric, and the basis functions are normalized. The matrices are explicitly:\n$$ P = \\begin{pmatrix} P_{AA} & P_{AB} \\\\ P_{BA} & P_{BB} \\end{pmatrix} = \\begin{pmatrix} P_{AA} & P_{AB} \\\\ P_{AB} & P_{BB} \\end{pmatrix} $$\n$$ S = \\begin{pmatrix} S_{AA} & S_{AB} \\\\ S_{BA} & S_{BB} \\end{pmatrix} = \\begin{pmatrix} 1 & S_{AB} \\\\ S_{AB} & 1 \\end{pmatrix} $$\nThe total number of electrons $N$ can be calculated by expanding the summation:\n$$ N = \\sum_{\\mu, \\nu=\\{A,B\\}} P_{\\mu \\nu} S_{\\nu \\mu} = P_{AA}S_{AA} + P_{AB}S_{BA} + P_{BA}S_{AB} + P_{BB}S_{BB} $$\nSubstituting the given values $S_{AA}=S_{BB}=1$ and symmetries $P_{BA}=P_{AB}$ and $S_{BA}=S_{AB}$:\n$$ N = P_{AA}(1) + P_{AB}S_{AB} + P_{AB}S_{AB} + P_{BB}(1) = P_{AA} + P_{BB} + 2P_{AB}S_{AB} $$\nMulliken population analysis partitions the total electronic population $N$ among the constituent atoms. The gross electronic population $N_k$ on an atom $k$ is defined as the sum of populations over all atomic orbitals $\\phi_{\\mu}$ centered on that atom. Formally, this is equivalent to summing the elements in the rows of the population matrix $PS$ that correspond to the basis functions centered on atom $k$:\n$$ N_k = \\sum_{\\mu \\in k} \\sum_{\\nu} P_{\\mu \\nu} S_{\\nu \\mu} $$\nFor the diatomic molecule $A-B$ in a minimal basis, atom $A$ is associated only with the basis function $\\phi_A$, so the sum $\\sum_{\\mu \\in A}$ consists of a single term where $\\mu = A$. The gross electronic population on atom $A$, denoted $N_A$, is:\n$$ N_A = \\sum_{\\nu=\\{A,B\\}} P_{A \\nu} S_{\\nu A} = P_{AA}S_{AA} + P_{AB}S_{BA} $$\nSubstituting the known values $S_{AA}=1$ and $S_{BA}=S_{AB}$:\n$$ N_A = P_{AA}(1) + P_{AB}S_{AB} = P_{AA} + P_{AB}S_{AB} $$\nSimilarly, for atom $B$, which is associated only with $\\phi_B$, the gross electronic population $N_B$ is:\n$$ N_B = \\sum_{\\nu=\\{A,B\\}} P_{B \\nu} S_{\\nu B} = P_{BA}S_{AB} + P_{BB}S_{BB} $$\nSubstituting the known values $P_{BA}=P_{AB}$ and $S_{BB}=1$:\n$$ N_B = P_{AB}S_{AB} + P_{BB}(1) = P_{BB} + P_{AB}S_{AB} $$\nAs a consistency check, the sum of the gross atomic populations must recover the total number of electrons:\n$$ N_A + N_B = (P_{AA} + P_{AB}S_{AB}) + (P_{BB} + P_{AB}S_{AB}) = P_{AA} + P_{BB} + 2P_{AB}S_{AB} = N $$\nThe partitioning is consistent. The Mulliken atomic charge $q_k$ on atom $k$ is defined as the difference between its nuclear charge $Z_k$ and its gross electronic population $N_k$:\n$$ q_k = Z_k - N_k $$\nApplying this definition to atom $A$:\n$$ q_A = Z_A - N_A = Z_A - (P_{AA} + P_{AB}S_{AB}) $$\n$$ q_A = Z_A - P_{AA} - P_{AB}S_{AB} $$\nAnd for atom $B$:\n$$ q_B = Z_B - N_B = Z_B - (P_{BB} + P_{AB}S_{AB}) $$\n$$ q_B = Z_B - P_{BB} - P_{AB}S_{AB} $$\nThese are the closed-form expressions for the Mulliken atomic charges. The final answer is the ordered pair $(q_A, q_B)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} Z_A - P_{AA} - P_{AB}S_{AB} & Z_B - P_{BB} - P_{AB}S_{AB} \\end{pmatrix}}\n$$", "id": "2449473"}, {"introduction": "The known sensitivity of Mulliken charges to the choice of basis set motivates the search for more stable alternatives. The Löwdin population analysis offers one such route by first transforming the atomic orbitals into an orthonormal set before partitioning the electron density [@problem_id:2449509]. This exercise guides you through the practical steps of this transformation, building essential computational skills like matrix manipulation and providing a direct contrast to the Mulliken scheme.", "problem": "Consider a heteronuclear diatomic cation with two electrons described in a minimal basis of two atom-centered atomic orbitals (AO), $\\{\\chi_{A}, \\chi_{B}\\}$, one on each atom. The atoms are labeled $A$ and $B$ with nuclear charges $Z_{A}$ and $Z_{B}$, respectively. The spin-summed one-particle density is built from a single doubly occupied molecular orbital (MO). The Atomic Orbital (AO) overlap matrix is\n$$\nS \\;=\\; \\begin{pmatrix}\n1 & 0.2 \\\\\n0.2 & 1\n\\end{pmatrix}.\n$$\nLet the unnormalized AO coefficient vector of the occupied Molecular Orbital (MO) be\n$$\nv \\;=\\; \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix},\n$$\nand let $c \\,=\\, k\\,v$ be the normalized AO coefficient vector satisfying $c^{\\mathsf T} S\\, c \\,=\\, 1$, with $k$ a scalar to be determined. The spin-summed AO density matrix is then $P \\,=\\, 2\\, c\\, c^{\\mathsf T}$.\n\nUsing the symmetric orthogonalization (Löwdin) scheme, the orthogonalizing transformation is defined by the matrix $S^{-1/2}$, where $S^{\\pm 1/2}$ denote the positive-definite matrix square root and its inverse. The Löwdin gross atomic populations are the diagonal elements of $S^{1/2} P S^{1/2}$, that is, for atom labels aligned with the AO order,\n$$\n\\text{GP}_{A} \\,=\\, \\big(S^{1/2} P S^{1/2}\\big)_{11}, \\qquad\n\\text{GP}_{B} \\,=\\, \\big(S^{1/2} P S^{1/2}\\big)_{22}.\n$$\nThe Löwdin atomic charges are defined by\n$$\nq_{A} \\,=\\, Z_{A} \\;-\\; \\text{GP}_{A}, \\qquad\nq_{B} \\,=\\, Z_{B} \\;-\\; \\text{GP}_{B}.\n$$\n\nFor a specific system, take $Z_{A} \\,=\\, 2$ and $Z_{B} \\,=\\, 1$ (so the total charge is $+1$ with two electrons in the basis). Starting by computing $S^{-1/2}$ from $S$, then obtaining $S^{1/2}$, and following the definitions above, calculate the Löwdin atomic charges $q_{A}$ and $q_{B}$. Provide your final answer as a single row matrix $\\big(q_{A}\\;\\; q_{B}\\big)$ and round your result to four significant figures. No units are required.", "solution": "The problem statement constitutes a well-posed exercise in computational quantum chemistry, specifically concerning Löwdin population analysis. All provided data and definitions are scientifically sound, consistent, and sufficient for the derivation of a unique solution. I will therefore proceed with the calculation.\n\nThe objective is to compute the Löwdin atomic charges, $q_{A}$ and $q_{B}$, for a two-electron heteronuclear diatomic cation. The definitions provided are:\n$$q_{A} = Z_{A} - \\text{GP}_{A}$$\n$$q_{B} = Z_{B} - \\text{GP}_{B}$$\nwhere $Z_{A} = 2$ and $Z_{B} = 1$ are the nuclear charges, and $\\text{GP}_{A}$ and $\\text{GP}_{B}$ are the Löwdin gross atomic populations. The populations are the diagonal elements of the Löwdin-transformed density matrix, $P' = S^{1/2} P S^{1/2}$.\n\nThe calculation proceeds in systematic steps.\n\nFirst, the unnormalized molecular orbital (MO) coefficient vector, $v$, must be normalized. The normalization condition is $c^{\\mathsf T} S c = 1$, where $c = k v$ is the normalized coefficient vector and $S$ is the atomic orbital (AO) overlap matrix.\nGiven $v = \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix}$ and $S = \\begin{pmatrix} 1 & 0.2 \\\\ 0.2 & 1 \\end{pmatrix}$, we compute the normalization factor $k$.\nThe scalar product is:\n$$v^{\\mathsf T} S v = \\begin{pmatrix} 0.9 & 0.3 \\end{pmatrix} \\begin{pmatrix} 1 & 0.2 \\\\ 0.2 & 1 \\end{pmatrix} \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 0.9 & 0.3 \\end{pmatrix} \\begin{pmatrix} 1 \\cdot 0.9 + 0.2 \\cdot 0.3 \\\\ 0.2 \\cdot 0.9 + 1 \\cdot 0.3 \\end{pmatrix} = \\begin{pmatrix} 0.9 & 0.3 \\end{pmatrix} \\begin{pmatrix} 0.96 \\\\ 0.48 \\end{pmatrix}$$\n$$v^{\\mathsf T} S v = 0.9 \\cdot 0.96 + 0.3 \\cdot 0.48 = 0.864 + 0.144 = 1.008$$\nThe normalization constant $k$ is given by $k = (v^{\\mathsf T} S v)^{-1/2} = (1.008)^{-1/2}$.\nThe normalized MO coefficient vector is $c = (1.008)^{-1/2} v$.\n\nSecond, we construct the spin-summed AO density matrix $P$. For a single, doubly occupied MO, $P = 2 c c^{\\mathsf T}$.\n$$P = 2 \\left( (1.008)^{-1/2} v \\right) \\left( (1.008)^{-1/2} v^{\\mathsf T} \\right) = \\frac{2}{1.008} v v^{\\mathsf T}$$\n$$P = \\frac{2}{1.008} \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix} \\begin{pmatrix} 0.9 & 0.3 \\end{pmatrix} = \\frac{2}{1.008} \\begin{pmatrix} 0.81 & 0.27 \\\\ 0.27 & 0.09 \\end{pmatrix}$$\n\nThird, we must find the matrix $S^{1/2}$. The problem specifies finding $S^{-1/2}$ first. This requires diagonalization of $S$. For a general $2 \\times 2$ matrix of the form $\\begin{pmatrix} 1 & s \\\\ s & 1 \\end{pmatrix}$, the eigenvalues are $\\lambda_{1,2} = 1 \\pm s$. For $S$, with $s=0.2$, the eigenvalues are $\\lambda_{1} = 1.2$ and $\\lambda_{2} = 0.8$. The corresponding normalized eigenvectors are $u_{1} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ and $u_{2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\nThe matrix of eigenvectors is $U = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$.\nThe spectral decomposition of $S$ is $S = U D U^{\\mathsf T}$, where $D = \\text{diag}(1.2, 0.8)$.\nThe matrix $S^{f}$ for any power $f$ is given by $S^{f} = U D^{f} U^{\\mathsf T}$.\nFollowing the instructions, $S^{-1/2} = U D^{-1/2} U^{\\mathsf T}$, where $D^{-1/2} = \\text{diag}(1/\\sqrt{1.2}, 1/\\sqrt{0.8})$.\nThe matrix $S^{1/2}$ is the inverse of $S^{-1/2}$, or equivalently, can be computed directly as $S^{1/2} = U D^{1/2} U^{\\mathsf T}$ with $D^{1/2} = \\text{diag}(\\sqrt{1.2}, \\sqrt{0.8})$.\n$$S^{1/2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\begin{pmatrix} \\sqrt{1.2} & 0 \\\\ 0 & \\sqrt{0.8} \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} \\sqrt{1.2}+\\sqrt{0.8} & \\sqrt{1.2}-\\sqrt{0.8} \\\\ \\sqrt{1.2}-\\sqrt{0.8} & \\sqrt{1.2}+\\sqrt{0.8} \\end{pmatrix}$$\nLet us define $A = \\frac{1}{2}(\\sqrt{1.2}+\\sqrt{0.8})$ and $B = \\frac{1}{2}(\\sqrt{1.2}-\\sqrt{0.8})$. Then $S^{1/2} = \\begin{pmatrix} A & B \\\\ B & A \\end{pmatrix}$.\n\nFourth, we compute the Löwdin gross populations, which are the diagonal elements of $P' = S^{1/2} P S^{1/2}$.\n$$\\text{GP}_{A} = (S^{1/2} P S^{1/2})_{11} = \\begin{pmatrix} A & B \\end{pmatrix} P \\begin{pmatrix} A \\\\ B \\end{pmatrix}$$\n$$\\text{GP}_{B} = (S^{1/2} P S^{1/2})_{22} = \\begin{pmatrix} B & A \\end{pmatrix} P \\begin{pmatrix} B \\\\ A \\end{pmatrix}$$\nSubstituting the expression for $P$:\n$$\\text{GP}_{A} = \\frac{2}{1.008} \\begin{pmatrix} A & B \\end{pmatrix} \\begin{pmatrix} 0.81 & 0.27 \\\\ 0.27 & 0.09 \\end{pmatrix} \\begin{pmatrix} A \\\\ B \\end{pmatrix} = \\frac{2}{1.008} (0.81 A^2 + 0.54 AB + 0.09 B^2)$$\nWe compute the necessary components:\n$$A^2 = \\frac{1}{4}(1.2 + 0.8 + 2\\sqrt{1.2 \\cdot 0.8}) = \\frac{1}{2}(1 + \\sqrt{0.96})$$\n$$B^2 = \\frac{1}{4}(1.2 + 0.8 - 2\\sqrt{1.2 \\cdot 0.8}) = \\frac{1}{2}(1 - \\sqrt{0.96})$$\n$$AB = \\frac{1}{4}(1.2 - 0.8) = \\frac{0.4}{4} = 0.1$$\nSubstituting these into the expression for $\\text{GP}_{A}$:\n$$0.81 A^2 + 0.54 AB + 0.09 B^2 = 0.81 \\cdot \\frac{1}{2}(1+\\sqrt{0.96}) + 0.54(0.1) + 0.09 \\cdot \\frac{1}{2}(1-\\sqrt{0.96})$$\n$$= 0.405(1+\\sqrt{0.96}) + 0.054 + 0.045(1-\\sqrt{0.96})$$\n$$= 0.405 + 0.405\\sqrt{0.96} + 0.054 + 0.045 - 0.045\\sqrt{0.96}$$\n$$= 0.504 + 0.36\\sqrt{0.96}$$\nSo, $\\text{GP}_{A} = \\frac{2}{1.008} (0.504 + 0.36\\sqrt{0.96}) = \\frac{1}{0.504} (0.504 + 0.36\\sqrt{0.96}) = 1 + \\frac{0.36}{0.504}\\sqrt{0.96} = 1 + \\frac{5}{7}\\sqrt{0.96}$.\nBy symmetry, or direct calculation, $\\text{GP}_{B} = 1 - \\frac{5}{7}\\sqrt{0.96}$.\n\nFifth, we calculate the numerical values for the populations and then the charges.\nUsing $\\sqrt{0.96} \\approx 0.9797959$:\n$$\\frac{5}{7}\\sqrt{0.96} \\approx \\frac{5}{7} \\cdot 0.9797959 \\approx 0.6998542$$\n$$\\text{GP}_{A} \\approx 1 + 0.6998542 = 1.6998542$$\n$$\\text{GP}_{B} \\approx 1 - 0.6998542 = 0.3001458$$\nThe sum of the populations is $\\text{GP}_{A} + \\text{GP}_{B} = 2$, which correctly equals the total number of electrons.\n\nFinally, the Löwdin atomic charges are calculated:\n$$q_{A} = Z_{A} - \\text{GP}_{A} = 2 - (1 + \\frac{5}{7}\\sqrt{0.96}) = 1 - \\frac{5}{7}\\sqrt{0.96} \\approx 1 - 0.6998542 = 0.3001458$$\n$$q_{B} = Z_{B} - \\text{GP}_{B} = 1 - (1 - \\frac{5}{7}\\sqrt{0.96}) = \\frac{5}{7}\\sqrt{0.96} \\approx 0.6998542$$\nThe total charge is $q_{A} + q_{B} = 1$, which is consistent with the system being a cation of charge $+1$.\n\nRounding the results to four significant figures:\n$$q_{A} \\approx 0.3001$$\n$$q_{B} \\approx 0.6999$$\nThe final answer is presented as a row matrix.", "answer": "$$\\boxed{\\begin{pmatrix} 0.3001 & 0.6999 \\end{pmatrix}}$$", "id": "2449509"}, {"introduction": "Theoretical differences between methods become most vivid when we test their behavior under realistic conditions, such as during molecular vibrations. In this final exercise [@problem_id:2449471], you will design a computational experiment to investigate a crucial property: the stability of calculated charges with respect to small changes in molecular geometry. This applied problem demonstrates a key practical reason why one method might be preferred over another, showing how Löwdin charges often exhibit superior stability compared to their Mulliken counterparts as a bond length is slightly perturbed.", "problem": "You must write a complete program that, for a minimal two-center, two-Atomic Orbital (AO) model of a heteronuclear diatomic with two electrons, quantifies how sensitive computed atomic charges are to small changes in the internuclear distance. Use the following physically grounded setup.\n\nDefinitions and model:\n- Let the two AOs be centered on atoms $A$ and $B$, each described by a normalized Slater-type $1s$ function with identical Slater exponent $z$ (in units of inverse bohr). The internuclear separation is $R$ (in bohr).\n- The AO overlap matrix is $S(R) \\in \\mathbb{R}^{2 \\times 2}$ with\n  $$S(R) = \\begin{bmatrix} 1 & s(R) \\\\ s(R) & 1 \\end{bmatrix}, \\quad s(R) = e^{-z R} \\left( 1 + z R + \\frac{(z R)^2}{3} \\right).$$\n- The one-electron Hamiltonian matrix $H(R) \\in \\mathbb{R}^{2 \\times 2}$ (in Hartree) is defined by\n  $$H(R) = \\begin{bmatrix} \\varepsilon_A & h_{AB}(R) \\\\ h_{AB}(R) & \\varepsilon_B \\end{bmatrix}, \\quad h_{AB}(R) = K \\, s(R) \\, \\frac{\\varepsilon_A + \\varepsilon_B}{2},$$\n  where $K$ is a dimensionless constant.\n- The Molecular Orbital (MO) coefficients $C(R) \\in \\mathbb{R}^{2 \\times 2}$ are obtained from the generalized eigenvalue problem\n  $$H(R) \\, C(R) = S(R) \\, C(R) \\, E(R),$$\n  with $E(R)$ diagonal, and the $S$-orthonormality constraint $C(R)^\\top S(R) C(R) = I$. Occupy the lowest-energy MO with two electrons (closed shell). The AO density matrix is then\n  $$P(R) = 2 \\, c_\\text{occ}(R) \\, c_\\text{occ}(R)^\\top,$$\n  where $c_\\text{occ}(R)$ is the occupied MO column of $C(R)$.\n- Mulliken gross atomic populations are defined by\n  $$g_\\mu^{\\mathrm{M}}(R) = \\sum_{\\nu=1}^{2} P_{\\mu\\nu}(R) \\, S_{\\nu\\mu}(R), \\quad \\mu \\in \\{1,2\\},$$\n  where $\\mu=1$ corresponds to atom $A$ and $\\mu=2$ to atom $B$. The Mulliken atomic charges are\n  $$q_A^{\\mathrm{M}}(R) = Z_A - g_1^{\\mathrm{M}}(R), \\quad q_B^{\\mathrm{M}}(R) = Z_B - g_2^{\\mathrm{M}}(R).$$\n- Löwdin symmetric orthogonalization is defined by the positive-definite matrix square root $S(R)^{1/2}$, with Löwdin gross populations obtained from the diagonal of\n  $$\\widetilde{P}(R) = S(R)^{1/2} \\, P(R) \\, S(R)^{1/2},$$\n  and Löwdin charges\n  $$q_A^{\\mathrm{L}}(R) = Z_A - \\widetilde{P}_{11}(R), \\quad q_B^{\\mathrm{L}}(R) = Z_B - \\widetilde{P}_{22}(R).$$\n\nParameters:\n- Use $z = 1.24$ (inverse bohr), $\\varepsilon_A = -0.50$ (Hartree), $\\varepsilon_B = -0.70$ (Hartree), $K = 1.75$ (dimensionless), $Z_A = 1$, and $Z_B = 1$.\n- All distances $R$ must be in bohr and all energies in Hartree.\n\nTask:\n- For each test case below, consisting of a pair of internuclear distances $(R_1, R_2)$, compute the absolute change in the atom $A$ charge under Mulliken analysis, $\\Delta^{\\mathrm{M}}_A = \\lvert q_A^{\\mathrm{M}}(R_2) - q_A^{\\mathrm{M}}(R_1) \\rvert$, and under Löwdin analysis, $\\Delta^{\\mathrm{L}}_A = \\lvert q_A^{\\mathrm{L}}(R_2) - q_A^{\\mathrm{L}}(R_1) \\rvert$. For each case, return a boolean indicating whether $\\Delta^{\\mathrm{L}}_A \\le \\Delta^{\\mathrm{M}}_A$.\n- Implement all required linear algebra exactly as stated by the definitions above.\n\nTest suite (each item is a distinct test case probing a different regime):\n1. $(R_1, R_2) = (1.40, 1.45)$ bohr.\n2. $(R_1, R_2) = (0.80, 0.82)$ bohr.\n3. $(R_1, R_2) = (3.00, 3.10)$ bohr.\n4. $(R_1, R_2) = (1.20, 1.21)$ bohr.\n\nRequired final output format:\n- Your program must produce a single line of output containing the results for the four test cases as a comma-separated Python-style list of boolean values enclosed in square brackets. For example, the line must look like\n  $$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4].$$\nNo other text may be printed. The answers are unitless booleans; no rounding is required.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It describes a minimal but standard molecular orbital model for a diatomic molecule based on established principles of quantum chemistry. The definitions for the Hamiltonian, overlap matrix, density matrix, and both Mulliken and Löwdin population analysis methods are correct and standard. The provided parameters are physically reasonable. Therefore, the problem is valid, and a unique solution can be derived.\n\nThe objective is to quantify and compare the sensitivity of Mulliken and Löwdin atomic charges on atom $A$ to small variations in the internuclear distance $R$. This is accomplished by computing the absolute change in charge for a given change in distance, $\\Delta R = R_2 - R_1$, for two different charge partitioning schemes. The core of the task is to implement a function that calculates the charges for a given set of parameters at a specific distance $R$. This function will be called for $R_1$ and $R_2$ for each test case.\n\nThe procedure for calculating the charges at a single internuclear distance $R$ is as follows:\n\n1.  **Define Constants**: The physical parameters of the model are given: Slater exponent $z = 1.24$, atomic orbital energies $\\varepsilon_A = -0.50$ Hartrees and $\\varepsilon_B = -0.70$ Hartrees, interaction constant $K = 1.75$, and nuclear charges $Z_A = 1$ and $Z_B = 1$.\n\n2.  **Construct Matrices**: The overlap matrix $S(R)$ and the one-electron Hamiltonian matrix $H(R)$ must be constructed.\n    - First, the overlap integral $s(R)$ between the two atomic orbitals is calculated using the provided formula:\n      $$s(R) = e^{-z R} \\left( 1 + z R + \\frac{(z R)^2}{3} \\right)$$\n    - The $2 \\times 2$ overlap matrix $S(R)$ is then given by:\n      $$S(R) = \\begin{bmatrix} 1 & s(R) \\\\ s(R) & 1 \\end{bmatrix}$$\n    - The off-diagonal element of the Hamiltonian, $h_{AB}(R)$, is calculated as:\n      $$h_{AB}(R) = K \\, s(R) \\, \\frac{\\varepsilon_A + \\varepsilon_B}{2}$$\n    - The $2 \\times 2$ Hamiltonian matrix $H(R)$ is then:\n      $$H(R) = \\begin{bmatrix} \\varepsilon_A & h_{AB}(R) \\\\ h_{AB}(R) & \\varepsilon_B \\end{bmatrix}$$\n\n3.  **Solve the Generalized Eigenvalue Problem**: The molecular orbital (MO) coefficient matrix $C(R)$ and the orbital energy matrix $E(R)$ are found by solving the Roothaan-Hall equations in their generalized eigenvalue form:\n    $$H(R) \\, C(R) = S(R) \\, C(R) \\, E(R)$$\n    This problem yields two eigenvalues, $E_1$ and $E_2$, which are the energies of the two MOs, and their corresponding eigenvectors, $c_1$ and $c_2$. The system contains two electrons, which, according to the Aufbau principle, occupy the MO with the lowest energy. Let this be $E_\\text{occ}(R) = \\min(E_1, E_2)$, with the associated eigenvector being $c_\\text{occ}(R)$. This eigenvector is normalized such that $c_\\text{occ}(R)^\\top S(R) c_\\text{occ}(R) = 1$.\n\n4.  **Construct the Density Matrix**: The one-electron density matrix in the atomic orbital basis, $P(R)$, is constructed from the occupied MO coefficients:\n    $$P(R) = 2 \\, c_\\text{occ}(R) \\, c_\\text{occ}(R)^\\top$$\n    The factor of $2$ accounts for the two electrons in the single occupied MO (a closed-shell configuration).\n\n5.  **Calculate Mulliken Charge**: The Mulliken gross atomic populations, $g_\\mu^{\\mathrm{M}}$, are the diagonal elements of the matrix product $P(R)S(R)$. The population on atom $A$ (corresponding to index $\\mu=1$) is:\n    $$g_A^{\\mathrm{M}}(R) = [P(R)S(R)]_{11}$$\n    The Mulliken charge on atom $A$ is then:\n    $$q_A^{\\mathrm{M}}(R) = Z_A - g_A^{\\mathrm{M}}(R)$$\n\n6.  **Calculate Löwdin Charge**: The Löwdin procedure first requires the symmetric orthogonalization of the atomic orbital basis. This is achieved using the matrix square root of the overlap matrix, $S(R)^{1/2}$. For the given $2 \\times 2$ structure of $S(R)$, its square root can be found analytically. Let $a = \\frac{1}{2}(\\sqrt{1+s(R)} + \\sqrt{1-s(R)})$ and $b = \\frac{1}{2}(\\sqrt{1+s(R)} - \\sqrt{1-s(R)})$. Then:\n    $$S(R)^{1/2} = \\begin{bmatrix} a & b \\\\ b & a \\end{bmatrix}$$\n    The density matrix is then transformed into the Löwdin basis:\n    $$\\widetilde{P}(R) = S(R)^{1/2} \\, P(R) \\, S(R)^{1/2}$$\n    The Löwdin gross atomic population on atom $A$ is the corresponding diagonal element of this transformed density matrix:\n    $$g_A^{\\mathrm{L}}(R) = \\widetilde{P}_{11}(R)$$\n    The Löwdin charge on atom $A$ is:\n    $$q_A^{\\mathrm{L}}(R) = Z_A - g_A^{\\mathrm{L}}(R)$$\n\n7.  **Compare Charge Sensitivities**: For each test case $(R_1, R_2)$, the above procedure is performed twice, once for $R_1$ and once for $R_2$, to obtain $\\{q_A^{\\mathrm{M}}(R_1), q_A^{\\mathrm{L}}(R_1)\\}$ and $\\{q_A^{\\mathrm{M}}(R_2), q_A^{\\mathrm{L}}(R_2)\\}$. The absolute changes are then computed:\n    $$\\Delta^{\\mathrm{M}}_A = \\lvert q_A^{\\mathrm{M}}(R_2) - q_A^{\\mathrm{M}}(R_1) \\rvert$$\n    $$\\Delta^{\\mathrm{L}}_A = \\lvert q_A^{\\mathrm{L}}(R_2) - q_A^{\\mathrm{L}}(R_1) \\rvert$$\n    Finally, the boolean condition $\\Delta^{\\mathrm{L}}_A \\le \\Delta^{\\mathrm{M}}_A$ is evaluated. This entire process is repeated for all test cases, and the resulting boolean values are collected.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef calculate_charges_at_r(R, z, eps_A, eps_B, K, Z_A):\n    \"\"\"\n    Calculates Mulliken and Löwdin charges on atom A for a given distance R.\n    \"\"\"\n    # Step 2: Construct Matrices\n    zR = z * R\n    s_R = np.exp(-zR) * (1 + zR + (zR)**2 / 3)\n\n    S = np.array([[1.0, s_R],\n                  [s_R, 1.0]])\n\n    h_AB = K * s_R * (eps_A + eps_B) / 2.0\n    H = np.array([[eps_A, h_AB],\n                  [h_AB, eps_B]])\n\n    # Step 3: Solve the Generalized Eigenvalue Problem\n    # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n    # The first eigenvector corresponds to the lowest energy MO.\n    eigenvalues, eigenvectors = eigh(H, S)\n    c_occ = eigenvectors[:, 0].reshape(2, 1)\n\n    # Step 4: Construct the Density Matrix\n    P = 2 * (c_occ @ c_occ.T)\n\n    # Step 5: Calculate Mulliken Charge\n    PS = P @ S\n    g_A_M = PS[0, 0]\n    q_A_M = Z_A - g_A_M\n\n    # Step 6: Calculate Löwdin Charge\n    # Analytically compute S^(1/2) for a 2x2 symmetric matrix\n    sqrt_1_plus_s = np.sqrt(1 + s_R)\n    sqrt_1_minus_s = np.sqrt(1 - s_R)\n    a = 0.5 * (sqrt_1_plus_s + sqrt_1_minus_s)\n    b = 0.5 * (sqrt_1_plus_s - sqrt_1_minus_s)\n    S_sqrt = np.array([[a, b], [b, a]])\n\n    P_tilde = S_sqrt @ P @ S_sqrt\n    g_A_L = P_tilde[0, 0]\n    q_A_L = Z_A - g_A_L\n\n    return q_A_M, q_A_L\n\ndef solve():\n    # Define parameters from the problem statement.\n    z = 1.24        # inverse bohr\n    eps_A = -0.50   # Hartree\n    eps_B = -0.70   # Hartree\n    K = 1.75        # dimensionless\n    Z_A = 1.0       # atomic number for A\n    Z_B = 1.0       # atomic number for B (model parameter)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.40, 1.45),\n        (0.80, 0.82),\n        (3.00, 3.10),\n        (1.20, 1.21),\n    ]\n\n    results = []\n    for R1, R2 in test_cases:\n        # Calculate charges at R1\n        q_A_M_R1, q_A_L_R1 = calculate_charges_at_r(R1, z, eps_A, eps_B, K, Z_A)\n\n        # Calculate charges at R2\n        q_A_M_R2, q_A_L_R2 = calculate_charges_at_r(R2, z, eps_A, eps_B, K, Z_A)\n\n        # Compute absolute changes\n        delta_M_A = abs(q_A_M_R2 - q_A_M_R1)\n        delta_L_A = abs(q_A_L_R2 - q_A_L_R1)\n\n        # Compare sensitivities and store the boolean result\n        results.append(delta_L_A <= delta_M_A)\n\n    # Final print statement in the exact required format.\n    # The boolean values are capitalized in f-string formatting, so map to str.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2449471"}]}