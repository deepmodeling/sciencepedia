{"hands_on_practices": [{"introduction": "Our first practice dives into a core physical principle revealed by the Configuration Interaction Singles (CIS) method. We will perform an analytical derivation to uncover the fundamental energy splitting between the singlet and triplet states arising from the same electronic promotion [@problem_id:2452219]. This exercise is crucial for understanding the physical origin of Hund's multiplicity rule in molecules, demonstrating explicitly how the energy difference, $\\Delta E_{ST}$, is governed by the exchange integral, $K_{ia}$.", "problem": "Consider a closed-shell system described within the Born–Oppenheimer and non-relativistic approximations by a restricted Hartree–Fock reference determinant built from orthonormal, real spatial orbitals $\\{\\phi_{p}\\}$. Let $\\phi_{i}$ be an occupied spatial orbital and $\\phi_{a}$ a virtual spatial orbital. Within Configuration Interaction Singles (CIS), focus on the subspace spanned by the two singly excited Slater determinants in which one electron is promoted from $\\phi_{i}$ to $\\phi_{a}$ with spin $\\alpha$ or spin $\\beta$, respectively. From these, construct the spin-adapted configuration state functions (CSFs) with total spin $S=0$ (singlet) and $S=1$ (triplet, with $M_{S}=0$). Using the standard electronic Hamiltonian $\\hat{H}=\\sum_{k}\\hat{h}(k)+\\sum_{k<l}r_{kl}^{-1}$ and no additional approximations beyond CIS and the given assumptions, determine the singlet–triplet energy splitting\n$$\\Delta E_{ST} \\equiv E_{S}-E_{T}$$\nfor this single excitation $i \\to a$, and express your final result purely in terms of the exchange integral\n$$K_{ia} \\equiv \\int\\!\\!\\!\\int \\phi_{i}(\\mathbf{r}_{1})\\,\\phi_{a}(\\mathbf{r}_{1})\\,\\frac{1}{r_{12}}\\,\\phi_{a}(\\mathbf{r}_{2})\\,\\phi_{i}(\\mathbf{r}_{2})\\,d\\mathbf{r}_{1}\\,d\\mathbf{r}_{2}.$$\nProvide a single closed-form analytic expression for $\\Delta E_{ST}$ in terms of $K_{ia}$ only. Do not introduce any other quantities. The answer should be an exact expression; no rounding is required and no units should be reported.", "solution": "The energy of an excited state within the CIS approximation is given by $E = E_0 + \\omega$, where $E_0$ is the energy of the Hartree–Fock ground state determinant $|\\Psi_0\\rangle$, and $\\omega$ is the excitation energy, obtained as an eigenvalue of the CIS matrix. Since the Hamiltonian $\\hat{H}$ is spin-independent, the CIS matrix does not couple singlet and triplet states. We are concerned only with the subspace for the specific excitation $i \\to a$, which simplifies the problem to finding the energies of the pure singlet and triplet states for this excitation.\n\nUsing the Slater–Condon rules to evaluate the necessary matrix elements for a closed-shell RHF reference, the general expressions for the excitation energies of the pure spin-adapted states are well-known. For an excitation from orbital $\\phi_i$ to $\\phi_a$:\nThe singlet excitation energy is:\n$$ \\omega_S = \\epsilon_a - \\epsilon_i - J_{ia} + 2K_{ia} $$\nThe triplet excitation energy is:\n$$ \\omega_T = \\epsilon_a - \\epsilon_i - J_{ia} $$\nHere, $\\epsilon_p$ is the canonical Hartree–Fock orbital energy of spatial orbital $\\phi_p$. The terms $J_{ia}$ and $K_{ia}$ are the Coulomb and exchange integrals, respectively, between spatial orbitals $\\phi_i$ and $\\phi_a$. They are defined as:\n$$ J_{ia} = \\int\\!\\!\\!\\int \\phi_{i}(\\mathbf{r}_{1})\\,\\phi_{i}(\\mathbf{r}_{1})\\,\\frac{1}{r_{12}}\\,\\phi_{a}(\\mathbf{r}_{2})\\,\\phi_{a}(\\mathbf{r}_{2})\\,d\\mathbf{r}_{1}\\,d\\mathbf{r}_{2} $$\n$$ K_{ia} = \\int\\!\\!\\!\\int \\phi_{i}(\\mathbf{r}_{1})\\,\\phi_{a}(\\mathbf{r}_{1})\\,\\frac{1}{r_{12}}\\,\\phi_{a}(\\mathbf{r}_{2})\\,\\phi_{i}(\\mathbf{r}_{2})\\,d\\mathbf{r}_{1}\\,d\\mathbf{r}_{2} $$\nThe definition of $K_{ia}$ provided in the problem statement is consistent with this standard definition for real orbitals.\n\nThe total energies of the singlet and triplet excited states, $E_S$ and $E_T$, are then:\n$$ E_S = E_0 + \\omega_S = E_0 + \\epsilon_a - \\epsilon_i - J_{ia} + 2K_{ia} $$\n$$ E_T = E_0 + \\omega_T = E_0 + \\epsilon_a - \\epsilon_i - J_{ia} $$\n\nThe objective is to find the singlet–triplet energy splitting, $\\Delta E_{ST} = E_S - E_T$. We compute this by taking the difference between the two expressions for the total energy:\n$$ \\Delta E_{ST} = (E_0 + \\epsilon_a - \\epsilon_i - J_{ia} + 2K_{ia}) - (E_0 + \\epsilon_a - \\epsilon_i - J_{ia}) $$\nThe terms involving the ground state energy $E_0$, the orbital energies $\\epsilon_a$ and $\\epsilon_i$, and the Coulomb integral $J_{ia}$ cancel out:\n$$ \\Delta E_{ST} = E_0 - E_0 + (\\epsilon_a - \\epsilon_i) - (\\epsilon_a - \\epsilon_i) - J_{ia} - (-J_{ia}) + 2K_{ia} $$\n$$ \\Delta E_{ST} = 0 + 0 - J_{ia} + J_{ia} + 2K_{ia} $$\nThis leaves the final expression for the energy splitting:\n$$ \\Delta E_{ST} = 2K_{ia} $$\nThis result, a specific case of Hund's rule, shows that for an excited configuration, the triplet state is lower in energy than the singlet state by an amount equal to twice the exchange integral, as $K_{ia}$ is a positive definite quantity. The result depends only on $K_{ia}$, as required by the problem statement.", "answer": "$$\\boxed{2K_{ia}}$$", "id": "2452219"}, {"introduction": "Having established the theoretical relationship between spin state and exchange energy, we now apply these ideas in a concrete numerical context. This problem challenges you to construct the CIS Hamiltonian for a 'minimal' model system: two electrons in two orbitals [@problem_id:2452230]. By working through the calculation from first principles, you will see exactly how canonical orbital energies and two-electron repulsion integrals combine to yield the final excitation energy, demystifying the components of the CIS matrix.", "problem": "Consider a two-electron closed-shell system treated at the level of Restricted Hartree–Fock (RHF). Let there be exactly two orthonormal spatial molecular orbitals, $\\,\\varphi_{1}\\,$ and $\\,\\varphi_{2}\\,$, with $\\,\\varphi_{1}\\,$ doubly occupied in the RHF ground state and $\\,\\varphi_{2}\\,$ unoccupied. Work in the canonical RHF molecular orbital basis so that the one-electron Fock operator is diagonal with orbital energies $\\,\\varepsilon_{1}\\,$ and $\\,\\varepsilon_{2}\\,$. Consider Configuration Interaction Singles (CIS) restricted to the spin-singlet sector built from the single excitation $\\,1 \\to 2\\,$. The spin-adapted singlet singly excited configuration is formed in the usual way from determinants of $\\alpha$ and $\\beta$ spin.\n\nThe two-electron repulsion integrals in the molecular orbital basis are defined as\n$$\n(pq|rs) \\;=\\; \\int\\!\\!\\int \\varphi_{p}(\\mathbf{r}_{1})\\,\\varphi_{q}(\\mathbf{r}_{1})\\,\\frac{1}{r_{12}}\\,\\varphi_{r}(\\mathbf{r}_{2})\\,\\varphi_{s}(\\mathbf{r}_{2})\\,d\\mathbf{r}_{1}\\,d\\mathbf{r}_{2}.\n$$\n\nYou are given the following canonical orbital energies and two-electron repulsion integrals (all in hartree, atomic units):\n$$\n\\varepsilon_{1} = -0.918,\\quad \\varepsilon_{2} = -0.312,\\quad (11|22) = 0.643,\\quad (12|21) = 0.102.\n$$\n\nUsing first principles, construct the explicit $1\\times 1$ CIS matrix for the spin-singlet subspace spanned by the single excitation $\\,1 \\to 2\\,$; that is, compute the single matrix element $\\,A_{1\\to 2,\\,1\\to 2}\\,$ corresponding to the CIS matrix that yields singlet excitation energies. Express your final answer in hartree and round your result to three significant figures.", "solution": "The problem requires the computation of the diagonal matrix element of the Configuration Interaction Singles (CIS) Hamiltonian for a spin-singlet excited state. This element is the excitation energy. The system is a two-electron, two-orbital model with a single excitation from occupied orbital $\\varphi_1$ to virtual orbital $\\varphi_2$.\n\nThe expression for the singlet excitation energy, $\\omega_S$, for a pure excitation from orbital $i$ to orbital $a$ is given by:\n$$\n\\omega_S = \\varepsilon_a - \\varepsilon_i - J_{ia} + 2K_{ia}\n$$\nHere, $\\varepsilon_p$ are the canonical Hartree-Fock orbital energies, $J_{ia}$ is the Coulomb integral, and $K_{ia}$ is the exchange integral.\n\nIn the chemists' notation for two-electron integrals $(pq|rs)$, the Coulomb and exchange integrals are defined as:\n$$\nJ_{ia} = (ii|aa)\n$$\n$$\nK_{ia} = (ia|ia)\n$$\nThe problem uses the notation $(pq|rs)$ where the indices are not grouped by electron. Using the symmetry of the integrals for real orbitals, we can map the given integrals to the required terms:\n- The Coulomb integral $J_{12}$ is $(11|22)$. The problem provides $(11|22) = 0.643$.\n- The exchange integral $K_{12}$ is $(12|12)$. The problem provides $(12|21) = 0.102$. By symmetry, $(12|12) = (12|21)$. So, $K_{12} = 0.102$.\n\nThe system involves a single excitation from orbital $i=1$ to $a=2$. Therefore, the $1\\times 1$ CIS matrix element, which is the singlet excitation energy, is:\n$$\nA_{1\\to 2, 1\\to 2} = \\omega_S = \\varepsilon_2 - \\varepsilon_1 - J_{12} + 2K_{12}\n$$\nWe substitute the given numerical values:\n- $\\varepsilon_1 = -0.918$ hartree\n- $\\varepsilon_2 = -0.312$ hartree\n- $J_{12} = (11|22) = 0.643$ hartree\n- $K_{12} = (12|21) = 0.102$ hartree\n$$\nA_{1\\to 2, 1\\to 2} = (-0.312) - (-0.918) - 0.643 + 2 \\times 0.102\n$$\n$$\nA_{1\\to 2, 1\\to 2} = -0.312 + 0.918 - 0.643 + 0.204\n$$\n$$\nA_{1\\to 2, 1\\to 2} = 0.606 - 0.643 + 0.204\n$$\n$$\nA_{1\\to 2, 1\\to 2} = -0.037 + 0.204\n$$\n$$\nA_{1\\to 2, 1\\to 2} = 0.167\n$$\nThe problem requires the answer to three significant figures, which is $0.167$.", "answer": "$$\n\\boxed{0.167}\n$$", "id": "2452230"}, {"introduction": "The final practice transitions from manual calculation to computational implementation, a vital skill for any computational chemist. You will write a program to construct and solve the CIS eigenvalue problem for a system with multiple possible excitations, which introduces the concept of configuration mixing [@problem_id:2452247]. This exercise solidifies your understanding of the entire CIS workflow, from using fundamental integrals to predicting a spectrum of excited state energies for different spin manifolds.", "problem": "You are given a closed-shell Restricted Hartree–Fock (RHF) reference for a two-electron system with four spatial orbitals, indexed as $0,1,2,3$. The Configuration Interaction singles (CIS) space consists of spin-adapted singly excited configurations obtained by exciting one electron from the doubly occupied orbital $i=0$ (the only occupied spatial orbital) into one of the virtual spatial orbitals $a \\in \\{1,2,3\\}$. Denote the canonical RHF orbital energies by $\\{\\varepsilon_p\\}_{p=0}^{3}$ in Hartree, and the two-electron Coulomb integrals in chemists’ notation by $(pq \\mid rs)$ over spatial orbitals, with the standard permutational symmetry $(pq \\mid rs)=(qp \\mid rs)=(pq \\mid sr)=(rs \\mid pq)$ and $(pq \\mid rs) \\in \\mathbb{R}$. All unspecified two-electron integrals are zero. Construct the spin-adapted Configuration Interaction singles (CIS) Hamiltonian matrices in the singlet and triplet subspaces using the fundamental Slater–Condon rules applied to the RHF reference and the given one-electron and two-electron data. Diagonalize each matrix and report the lowest excitation energy in each spin manifold.\n\nUse the following three independent test cases (each defines one system). In every case, the number of electrons is $N=2$, the number of spatial orbitals is $M=4$, the occupied orbital index set is $\\{0\\}$, and the virtual orbital index set is $\\{1,2,3\\}$. Energies must be reported in Hartree, rounded to six decimal places.\n\nTest Case A:\n- Orbital energies (Hartree): $[\\,-0.9,\\;0.1,\\;0.3,\\;0.6\\,]$.\n- Non-zero two-electron integrals $(pq \\mid rs)$ (Hartree):\n  - $(1,0 \\mid 0,1)=0.15$,\n  - $(2,0 \\mid 0,2)=0.12$,\n  - $(3,0 \\mid 0,3)=0.10$,\n  - $(1,1 \\mid 0,0)=0.20$,\n  - $(2,2 \\mid 0,0)=0.18$,\n  - $(3,3 \\mid 0,0)=0.16$.\n\nTest Case B:\n- Orbital energies (Hartree): $[\\,-1.0,\\;0.0,\\;0.5,\\;1.0\\,]$.\n- No non-zero two-electron integrals are provided; take all $(pq \\mid rs)=0$.\n\nTest Case C:\n- Orbital energies (Hartree): $[\\,-0.8,\\;0.0,\\;0.0,\\;0.4\\,]$.\n- Non-zero two-electron integrals (Hartree):\n  - $(1,0 \\mid 0,1)=0.20$,\n  - $(2,0 \\mid 0,2)=0.20$,\n  - $(3,0 \\mid 0,3)=0.05$,\n  - $(1,1 \\mid 0,0)=0.25$,\n  - $(2,2 \\mid 0,0)=0.25$,\n  - $(3,3 \\mid 0,0)=0.10$,\n  - $(1,2 \\mid 0,0)=0.05$.\n\nYour program must:\n- Build the spin-adapted singlet and triplet CIS Hamiltonian matrices for each test case using the RHF orbital energies and two-electron integrals specified above, enforcing the full chemists’ notation symmetry of $(pq \\mid rs)$.\n- Diagonalize each Hamiltonian and extract the lowest eigenvalue in Hartree for the singlet and the lowest eigenvalue in Hartree for the triplet.\n\nFinal output format requirement:\n- Produce a single line of output containing a list with six floating-point numbers in Hartree, rounded to six decimal places, ordered as $[E_{\\mathrm{S},A},E_{\\mathrm{T},A},E_{\\mathrm{S},B},E_{\\mathrm{T},B},E_{\\mathrm{S},C},E_{\\mathrm{T},C}]$, where $E_{\\mathrm{S},X}$ and $E_{\\mathrm{T},X}$ denote the lowest singlet and triplet CIS excitation energies for test case $X \\in \\{A,B,C\\}$. For example, the output should look like $[x_1,x_2,x_3,x_4,x_5,x_6]$.", "solution": "The CIS excitation energies are the eigenvalues of the CIS Hamiltonian matrix, $\\mathbf{A}$, constructed in a basis of spin-adapted singly excited configurations. The basis consists of excitations from the single occupied orbital $\\phi_0$ to the virtual orbitals $\\phi_a$, where $a \\in \\{1, 2, 3\\}$. The matrix is block-diagonal, separating singlet and triplet states. For a closed-shell RHF reference with real orbitals, the elements of the singlet ($\\mathbf{A}^S$) and triplet ($\\mathbf{A}^T$) CIS matrices are given by the following expressions in chemists' notation:\n\n**Diagonal elements ($a=b$):**\n$$ A^S_{aa} = (\\varepsilon_a - \\varepsilon_0) - (00|aa) + 2(0a|a0) $$\n$$ A^T_{aa} = (\\varepsilon_a - \\varepsilon_0) - (00|aa) $$\n\n**Off-diagonal elements ($a \\neq b$):**\n$$ A^S_{ab} = 2(0a|b0) - (00|ab) $$\n$$ A^T_{ab} = -(00|ab) $$\nHere, $\\varepsilon_p$ is a canonical orbital energy, $(00|aa)$ is a Coulomb integral $J_{0a}$, and $(0a|a0)$ is an exchange integral $K_{0a}$. All unspecified integrals are zero. We use the 8-fold permutational symmetry of the integrals (e.g., $(pq|rs) = (rs|pq)$) to evaluate the required terms from the provided list.\n\nWe now construct and diagonalize these $3 \\times 3$ matrices for each test case.\n\n**Test Case A**\n- Orbital energies: $\\varepsilon = [-0.9, 0.1, 0.3, 0.6]$.\n- Integrals imply: $K_{01}=(10|01)=0.15$, $K_{02}=0.12$, $K_{03}=0.10$. $J_{01}=(11|00)=0.20$, $J_{02}=0.18$, $J_{03}=0.16$. All coupling integrals are zero. The matrices are diagonal.\n\nSinglet CIS Matrix $\\mathbf{A}^S$ (diagonal elements):\n$A^S_{11} = (\\varepsilon_1 - \\varepsilon_0) - J_{01} + 2K_{01} = (0.1 - (-0.9)) - 0.20 + 2(0.15) = 1.0 - 0.20 + 0.30 = 1.10$.\n$A^S_{22} = (\\varepsilon_2 - \\varepsilon_0) - J_{02} + 2K_{02} = (0.3 - (-0.9)) - 0.18 + 2(0.12) = 1.2 - 0.18 + 0.24 = 1.26$.\n$A^S_{33} = (\\varepsilon_3 - \\varepsilon_0) - J_{03} + 2K_{03} = (0.6 - (-0.9)) - 0.16 + 2(0.10) = 1.5 - 0.16 + 0.20 = 1.54$.\nThe lowest eigenvalue is $E_{\\mathrm{S},A} = 1.10$.\n\nTriplet CIS Matrix $\\mathbf{A}^T$ (diagonal elements):\n$A^T_{11} = (\\varepsilon_1 - \\varepsilon_0) - J_{01} = 1.0 - 0.20 = 0.80$.\n$A^T_{22} = (\\varepsilon_2 - \\varepsilon_0) - J_{02} = 1.2 - 0.18 = 1.02$.\n$A^T_{33} = (\\varepsilon_3 - \\varepsilon_0) - J_{03} = 1.5 - 0.16 = 1.34$.\nThe lowest eigenvalue is $E_{\\mathrm{T},A} = 0.80$.\n\n**Test Case B**\n- Orbital energies: $\\varepsilon = [-1.0, 0.0, 0.5, 1.0]$.\n- All two-electron integrals are zero. The matrices are diagonal and identical.\n$A_{11} = \\varepsilon_1 - \\varepsilon_0 = 0.0 - (-1.0) = 1.0$.\n$A_{22} = \\varepsilon_2 - \\varepsilon_0 = 0.5 - (-1.0) = 1.5$.\n$A_{33} = \\varepsilon_3 - \\varepsilon_0 = 1.0 - (-1.0) = 2.0$.\nLowest singlet energy $E_{\\mathrm{S},B} = 1.0$. Lowest triplet energy $E_{\\mathrm{T},B} = 1.0$.\n\n**Test Case C**\n- Orbital energies: $\\varepsilon = [-0.8, 0.0, 0.0, 0.4]$. Note $\\varepsilon_1 = \\varepsilon_2$.\n- Integrals: $K_{01}=0.20, K_{02}=0.20, K_{03}=0.05$. $J_{01}=0.25, J_{02}=0.25, J_{03}=0.10$. Coupling integral $(00|12)=(12|00)=0.05$. Exchange coupling integrals like $(01|20)$ are zero.\n\nSinglet CIS Matrix $\\mathbf{A}^S$:\n$A^S_{11} = (0.0 - (-0.8)) - 0.25 + 2(0.20) = 0.95$.\n$A^S_{22} = (0.0 - (-0.8)) - 0.25 + 2(0.20) = 0.95$.\n$A^S_{33} = (0.4 - (-0.8)) - 0.10 + 2(0.05) = 1.20$.\n$A^S_{12} = 2(01|20) - (00|12) = 2(0) - 0.05 = -0.05$. $A^S_{21} = A^S_{12}$.\nAll other off-diagonal elements are zero.\n$$ \\mathbf{A}^S = \\begin{pmatrix} 0.95 & -0.05 & 0 \\\\ -0.05 & 0.95 & 0 \\\\ 0 & 0 & 1.20 \\end{pmatrix} $$\nThis matrix is block-diagonal. The eigenvalues of the top-left $2 \\times 2$ block are solutions to $(0.95-\\lambda)^2 - (-0.05)^2 = 0$, giving $\\lambda = 0.95 \\mp 0.05$. The eigenvalues are $0.90$ and $1.00$. The full set of eigenvalues is $\\{0.90, 1.00, 1.20\\}$. The lowest is $E_{\\mathrm{S},C} = 0.90$.\n\nTriplet CIS Matrix $\\mathbf{A}^T$:\n$A^T_{11} = (0.0 - (-0.8)) - 0.25 = 0.55$.\n$A^T_{22} = (0.0 - (-0.8)) - 0.25 = 0.55$.\n$A^T_{33} = (0.4 - (-0.8)) - 0.10 = 1.10$.\n$A^T_{12} = -(00|12) = -0.05$. $A^T_{21} = A^T_{12}$.\n$$ \\mathbf{A}^T = \\begin{pmatrix} 0.55 & -0.05 & 0 \\\\ -0.05 & 0.55 & 0 \\\\ 0 & 0 & 1.10 \\end{pmatrix} $$\nThe eigenvalues of the $2 \\times 2$ block are solutions to $(0.55-\\lambda)^2 - (-0.05)^2 = 0$, giving $\\lambda = 0.55 \\mp 0.05$. The eigenvalues are $0.50$ and $0.60$. The full set is $\\{0.50, 0.60, 1.10\\}$. The lowest is $E_{\\mathrm{T},C} = 0.50$.\n\nSummary of results:\n- Test Case A: $E_{\\mathrm{S},A} = 1.100000$, $E_{\\mathrm{T},A} = 0.800000$.\n- Test Case B: $E_{\\mathrm{S},B} = 1.000000$, $E_{\\mathrm{T},B} = 1.000000$.\n- Test Case C: $E_{\\mathrm{S},C} = 0.900000$, $E_{\\mathrm{T},C} = 0.500000$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the lowest singlet and triplet CIS excitation energies for three test cases.\n    \"\"\"\n    test_cases = [\n        {\n            'name': 'A',\n            'eps': np.array([-0.9, 0.1, 0.3, 0.6]),\n            'integrals': {\n                (1, 0, 0, 1): 0.15,\n                (2, 0, 0, 2): 0.12,\n                (3, 0, 0, 3): 0.10,\n                (1, 1, 0, 0): 0.20,\n                (2, 2, 0, 0): 0.18,\n                (3, 3, 0, 0): 0.16,\n            }\n        },\n        {\n            'name': 'B',\n            'eps': np.array([-1.0, 0.0, 0.5, 1.0]),\n            'integrals': {}\n        },\n        {\n            'name': 'C',\n            'eps': np.array([-0.8, 0.0, 0.0, 0.4]),\n            'integrals': {\n                (1, 0, 0, 1): 0.20,\n                (2, 0, 0, 2): 0.20,\n                (3, 0, 0, 3): 0.05,\n                (1, 1, 0, 0): 0.25,\n                (2, 2, 0, 0): 0.25,\n                (3, 3, 0, 0): 0.10,\n                (1, 2, 0, 0): 0.05,\n            }\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        eps = case['eps']\n        raw_integrals = case['integrals']\n\n        # Pre-process integrals to handle 8-fold symmetry\n        integral_map = {}\n        for (p, q, r, s), val in raw_integrals.items():\n            p_s, q_s = sorted((p, q))\n            r_s, s_s = sorted((r, s))\n            \n            pair1 = (p_s, q_s)\n            pair2 = (r_s, s_s)\n            \n            if pair1 > pair2:\n                pair1, pair2 = pair2, pair1\n            \n            key = (pair1[0], pair1[1], pair2[0], pair2[1])\n            integral_map[key] = val\n\n        def get_integral(p, q, r, s):\n            p_s, q_s = sorted((p, q))\n            r_s, s_s = sorted((r, s))\n            \n            pair1 = (p_s, q_s)\n            pair2 = (r_s, s_s)\n            \n            if pair1 > pair2:\n                pair1, pair2 = pair2, pair1\n            \n            key = (pair1[0], pair1[1], pair2[0], pair2[1])\n            return integral_map.get(key, 0.0)\n\n        # CIS implementation\n        # Occupied orbital is always index 0\n        i_occ = 0\n        # Virtual orbitals are indices 1, 2, 3\n        virt_indices = [1, 2, 3]\n        n_virt = len(virt_indices)\n        \n        A_S = np.zeros((n_virt, n_virt))\n        A_T = np.zeros((n_virt, n_virt))\n\n        for idx_a, a in enumerate(virt_indices):\n            for idx_b, b in enumerate(virt_indices):\n                # Orbital energy difference term\n                delta_eps = eps[a] - eps[i_occ] if a == b else 0.0\n\n                # Integral terms\n                # Singlet: 2*(0a|b0) - (00|ab)\n                # Triplet: -(00|ab)\n                coulomb_term = -get_integral(i_occ, i_occ, a, b)\n                exchange_term = 2 * get_integral(i_occ, a, b, i_occ)\n\n                # Assemble matrix elements\n                A_S[idx_a, idx_b] = delta_eps + coulomb_term + exchange_term\n                A_T[idx_a, idx_b] = delta_eps + coulomb_term\n\n        # Diagonalize and find the lowest eigenvalue\n        eigvals_s = np.linalg.eigh(A_S)[0]\n        eigvals_t = np.linalg.eigh(A_T)[0]\n\n        lowest_s = np.min(eigvals_s)\n        lowest_t = np.min(eigvals_t)\n\n        results.extend([lowest_s, lowest_t])\n\n    # Format the final output\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2452247"}]}