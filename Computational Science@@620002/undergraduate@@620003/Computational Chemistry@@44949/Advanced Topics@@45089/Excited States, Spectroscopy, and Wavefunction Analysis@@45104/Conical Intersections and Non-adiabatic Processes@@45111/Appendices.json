{"hands_on_practices": [{"introduction": "Understanding a photochemical reaction means tracing the molecule's geometric journey across different potential energy surfaces. The classic example of ethylene's photoisomerization involves distinct key structures: the stable ground state, the relaxed excited state, and the conical intersection that provides a rapid pathway back down. This exercise [@problem_id:2453340] builds your chemical intuition by asking you to qualitatively compare these critical geometries, connecting the abstract concept of a reaction coordinate to concrete changes in bond lengths and angles.", "problem": "Ethylene can undergo torsion about the carbon–carbon double bond in the context of photoexcitation and internal conversion. Let $\\phi$ denote the dihedral angle between the two $\\ce{CH2}$ local $\\pi$-systems (torsion about the carbon–carbon bond), with $\\phi = 0^{\\circ}$ corresponding to a planar configuration and $\\phi = 90^{\\circ}$ to orthogonal $\\pi$-systems. Let $\\theta$ denote the pyramidalization angle at a carbon atom, defined as the out-of-plane deviation from trigonal planarity, with $\\theta = 0^{\\circ}$ indicating a planar $\\ce{sp^2}$ center. Consider qualitatively the equilibrium geometries of the ground-state minimum ($S_0$), the first excited singlet-state minimum ($S_1$), and the Minimum Energy Conical Intersection (MECI) connecting $S_1$ and $S_0$ along the torsional pathway in ethylene.\n\nWhich option best compares the characteristic values of $\\phi$ and $\\theta$ and the pattern of the carbon–carbon bond length among these three structures?\n\nA. $S_0$ minimum: $\\phi \\approx 0^{\\circ}$, $\\theta \\approx 0^{\\circ}$, relatively short carbon–carbon bond; $S_1$ minimum: $\\phi \\approx 90^{\\circ}$, $\\theta \\approx 0^{\\circ}$, elongated carbon–carbon bond; $S_1/S_0$ MECI: $\\phi \\approx 90^{\\circ}$ with significant $\\theta > 0$ at at least one carbon, carbon–carbon bond similar to or slightly shorter than at the $S_1$ minimum.\n\nB. $S_0$ minimum: $\\phi \\approx 90^{\\circ}$, $\\theta \\approx 0^{\\circ}$; $S_1$ minimum: $\\phi \\approx 0^{\\circ}$, $\\theta \\approx 0^{\\circ}$; $S_1/S_0$ MECI: planar with $\\phi \\approx 45^{\\circ}$ and $\\theta \\approx 0^{\\circ}$.\n\nC. $S_0$ minimum, $S_1$ minimum, and $S_1/S_0$ MECI are all planar with $\\phi \\approx 0^{\\circ}$ and $\\theta \\approx 0^{\\circ}$, differing only in the carbon–carbon bond length.\n\nD. $S_0$ minimum and $S_1$ minimum are both planar with $\\phi \\approx 0^{\\circ}$ and $\\theta \\approx 0^{\\circ}$; $S_1/S_0$ MECI occurs at a linear geometry with $\\phi \\approx 180^{\\circ}$ and no pyramidalization.\n\nE. $S_0$ minimum: $\\phi \\approx 0^{\\circ}$, $\\theta \\approx 0^{\\circ}$; $S_1$ minimum: $\\phi \\approx 90^{\\circ}$ with substantial pyramidalization $\\theta > 0$ at both carbons; $S_1/S_0$ MECI: $\\phi \\approx 90^{\\circ}$ with $\\theta \\approx 0^{\\circ}$ at both carbons (no pyramidalization).", "solution": "The problem statement will first be subjected to rigorous validation.\n\n### Step 1: Extract Givens\n- **Molecule**: Ethylene ($\\ce{C2H4}$)\n- **Process**: Torsion about the carbon–carbon double bond following photoexcitation and internal conversion.\n- **Geometric Parameters**:\n    - $\\phi$: Dihedral angle between the two $\\ce{CH2}$ local $\\pi$-systems. $\\phi = 0^{\\circ}$ is planar; $\\phi = 90^{\\circ}$ is orthogonal.\n    - $\\theta$: Pyramidalization angle at a carbon atom. $\\theta = 0^{\\circ}$ is a planar $\\ce{sp^2}$ center.\n- **Structures of Interest**:\n    1. Ground-state minimum ($S_0$)\n    2. First excited singlet-state minimum ($S_1$)\n    3. Minimum Energy Conical Intersection (MECI) connecting $S_1$ and $S_0$.\n- **Question**: Compare the characteristic values of $\\phi$, $\\theta$, and the carbon–carbon bond length among these three structures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes the canonical model of photochemical dynamics in ethylene, a cornerstone topic in computational and physical organic chemistry.\n- **Scientifically Grounded**: The concepts of $S_0$ and $S_1$ potential energy surfaces, torsional and pyramidalization motions, and the existence of a conical intersection are fundamental and well-established in the scientific literature. The description is physically and chemically sound.\n- **Well-Posed**: The problem asks for a qualitative comparison of well-defined geometric parameters at specific, physically meaningful points on the potential energy surfaces (two minima and a MECI). A unique qualitative solution exists based on molecular orbital theory and electronic structure calculations. The terms $\\phi$ and $\\theta$ are clearly defined.\n- **Objective**: The language is technical and devoid of subjectivity.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically sound, well-posed, unambiguous, and directly pertinent to the field of computational chemistry. It is therefore **valid**. I will proceed with the derivation of the solution.\n\n### Derivation\n\nThe analysis rests on the behavior of the highest occupied molecular orbital (HOMO), which is the $\\pi$ bonding orbital, and the lowest unoccupied molecular orbital (LUMO), which is the $\\pi^*$ antibonding orbital, as a function of the torsional angle $\\phi$.\n\n1.  **Ground-State Minimum ($S_0$)**:\n    In the ground electronic state ($S_0$), the electronic configuration is $(\\pi)^2$. To maximize the overlap between the two $p$-orbitals forming the $\\pi$ bond, the molecule must be planar. This corresponds to a dihedral angle $\\phi = 0^{\\circ}$. In this configuration, the carbon atoms are trigonal planar and $\\ce{sp^2}$-hybridized, which means there is no pyramidalization. Thus, $\\theta = 0^{\\circ}$. The presence of both a $\\sigma$ bond and a full $\\pi$ bond results in a characteristic carbon–carbon double bond, which is relatively short and strong.\n    Summary for $S_0$ minimum: $\\phi \\approx 0^{\\circ}$, $\\theta \\approx 0^{\\circ}$, short C-C bond.\n\n2.  **First Excited Singlet-State Minimum ($S_1$)**:\n    Upon photoexcitation, an electron is promoted from the $\\pi$ orbital to the $\\pi^*$ orbital, leading to the $S_1$ state with a $(\\pi)^1(\\pi^*)^1$ configuration. The $\\pi^*$ orbital is antibonding. In the initial planar Franck-Condon geometry ($\\phi = 0^{\\circ}$), this configuration results in a net zero $\\pi$ bond order, significantly weakening the C-C bond. The system will relax to minimize its energy.\n    As the molecule twists around the C-C bond (increasing $\\phi$), the overlap between the $p$-orbitals decreases. This raises the energy of the bonding $\\pi$ orbital and, crucially, lowers the energy of the antibonding $\\pi^*$ orbital. The total energy of the $S_1$ state is minimized when the stabilizing effect on the singly-occupied $\\pi^*$ orbital is maximal. This occurs at $\\phi = 90^{\\circ}$, where the two $p$-orbitals are orthogonal, the $\\pi$ and $\\pi^*$ orbitals become degenerate non-bonding orbitals, and the concept of $\\pi$-bonding vanishes.\n    At this $S_1$ minimum, the geometry is twisted by $\\phi \\approx 90^{\\circ}$. The bond connecting the carbons is now essentially a pure $\\sigma$ bond, causing it to elongate significantly compared to the $S_0$ minimum. There is no intrinsic electronic reason for the $\\ce{CH2}$ groups to pyramidalize at this geometry; they remain essentially planar.\n    Summary for $S_1$ minimum: $\\phi \\approx 90^{\\circ}$, $\\theta \\approx 0^{\\circ}$, elongated C-C bond.\n\n3.  **Minimum Energy Conical Intersection ($S_1/S_0$ MECI)**:\n    A conical intersection (CI) is a point of degeneracy between two electronic states. For molecules with more than two atoms, the non-crossing rule dictates that two states of the same spin multiplicity cannot cross unless the geometry provides at least two independent coordinates along which the degeneracy is lifted. These two directions define the \"branching space\". The vectors spanning this space are the gradient difference vector and the non-adiabatic coupling vector.\n    In ethylene, the twisted $\\phi=90^{\\circ}$ geometry makes the $S_1$ and $S_0$ states close in energy, but they are not yet degenerate. The $S_0$ state at $\\phi=90^{\\circ}$ is a biradicaloid singlet, while the $S_1$ state is a zwitterionic state in some coordinate systems, but this character changes with geometry. To achieve exact degeneracy, an additional geometric distortion is required that couples the two states. This coupling coordinate is an asymmetric pyramidalization and wagging motion. Therefore, the MECI geometry is characterized by both torsion ($\\phi \\approx 90^{\\circ}$) and significant pyramidalization at one or both carbon atoms ($\\theta > 0$). This is often termed a \"twisted-pyramidalized\" structure. The C-C bond length at the MECI is still characteristic of a single bond, very similar to that at the $S_1$ minimum, as the geometry has not yet relaxed towards the planar, double-bonded $S_0$ structure.\n\n    Summary for $S_1/S_0$ MECI: $\\phi \\approx 90^{\\circ}$, $\\theta > 0$, elongated C-C bond (similar to $S_1$ minimum).\n\n### Option Analysis\n\n- **A. $S_0$ minimum: $\\phi \\approx 0^{\\circ}$, $\\theta \\approx 0^{\\circ}$, relatively short carbon–carbon bond; $S_1$ minimum: $\\phi \\approx 90^{\\circ}$, $\\theta \\approx 0^{\\circ}$, elongated carbon–carbon bond; $S_1/S_0$ MECI: $\\phi \\approx 90^{\\circ}$ with significant $\\theta > 0$ at at least one carbon, carbon–carbon bond similar to or slightly shorter than at the $S_1$ minimum.**\n  This statement correctly describes the planar ground state with a double bond. It correctly identifies the $S_1$ minimum as twisted but largely non-pyramidalized, with an elongated single-like bond. It correctly describes the MECI as a twisted-pyramidalized structure, which is necessary to achieve degeneracy, with a bond length comparable to the $S_1$ minimum. This description is fully consistent with established theory.\n  **Verdict: Correct.**\n\n- **B. $S_0$ minimum: $\\phi \\approx 90^{\\circ}$, $\\theta \\approx 0^{\\circ}$; $S_1$ minimum: $\\phi \\approx 0^{\\circ}$, $\\theta \\approx 0^{\\circ}$; $S_1/S_0$ MECI: planar with $\\phi \\approx 45^{\\circ}$ and $\\theta \\approx 0^{\\circ}$.**\n  This is fundamentally incorrect. The $S_0$ minimum is planar ($\\phi=0^{\\circ}$), not twisted. The $S_1$ minimum is twisted ($\\phi=90^{\\circ}$), not planar. The MECI is twisted and pyramidalized, not planar at $\\phi=45^{\\circ}$.\n  **Verdict: Incorrect.**\n\n- **C. $S_0$ minimum, $S_1$ minimum, and $S_1/S_0$ MECI are all planar with $\\phi \\approx 0^{\\circ}$ and $\\theta \\approx 0^{\\circ}$, differing only in the carbon–carbon bond length.**\n  This is incorrect. It completely ignores the critical roles of torsional motion for relaxation on the $S_1$ surface and pyramidalization for creating the conical intersection. photochemistry would not occur as it does without these non-planar distortions.\n  **Verdict: Incorrect.**\n\n- **D. $S_0$ minimum and $S_1$ minimum are both planar with $\\phi \\approx 0^{\\circ}$ and $\\theta \\approx 0^{\\circ}$; $S_1/S_0$ MECI occurs at a linear geometry with $\\phi \\approx 180^{\\circ}$ and no pyramidalization.**\n  This is incorrect. The $S_1$ minimum is not planar. A linear geometry for ethylene is energetically prohibitive and irrelevant to this process. $\\phi=180^{\\circ}$ is geometrically identical to $\\phi=0^{\\circ}$.\n  **Verdict: Incorrect.**\n\n- **E. $S_0$ minimum: $\\phi \\approx 0^{\\circ}$, $\\theta \\approx 0^{\\circ}$; $S_1$ minimum: $\\phi \\approx 90^{\\circ}$ with substantial pyramidalization $\\theta > 0$ at both carbons; $S_1/S_0$ MECI: $\\phi \\approx 90^{\\circ}$ with $\\theta \\approx 0^{\\circ}$ at both carbons (no pyramidalization).**\n  This option incorrectly swaps the roles of pyramidalization for the $S_1$ minimum and the MECI. The $S_1$ minimum is twisted but not significantly pyramidalized ($\\theta \\approx 0^{\\circ}$). The MECI *requires* pyramidalization ($\\theta > 0$) to exist. A structure with $\\phi=90^{\\circ}$ and $\\theta=0^{\\circ}$ is the $S_1$ minimum, not the MECI.\n  **Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2453340"}, {"introduction": "Non-adiabatic transitions are governed by coupling terms that mathematically describe how nuclear motion causes different electronic states to interact. In this practice [@problem_id:2453334], you will move from qualitative pictures to a rigorous analytical derivation within a simplified but powerful vibronic coupling model. By analyzing the structure of the Hamiltonian, you will discover how symmetry considerations can cause certain non-adiabatic couplings to vanish, providing deep insight into the selection rules that govern photochemical reactivity.", "problem": "Consider the triatomic cation H$_3^+$ at the equilateral geometry of point group $\\mathrm{D}_{3h}$. Near this geometry, model the two lowest electronic states that span the doubly degenerate $\\mathrm{E}'$ irreducible representation in a diabatic basis $\\{\\,|E_x\\rangle, |E_y\\rangle\\,\\}$ by the linear vibronic coupling Hamiltonian\n$$\n\\hat{H}_{\\mathrm{d}}(\\mathbf{q}) \\;=\\; \\left(E_0 + \\alpha\\, q_s\\right)\\,\\hat{I}\n\\;+\\;\n\\begin{pmatrix}\n\\dfrac{\\Delta}{2} & k\\,(q_x - i\\,q_y) \\\\\nk\\,(q_x + i\\,q_y) & -\\dfrac{\\Delta}{2}\n\\end{pmatrix},\n$$\nwhere $\\mathbf{q}=(q_x,q_y,q_s)$, the pair $(q_x,q_y)$ are the normal coordinates transforming as the degenerate $\\mathrm{e}'$ vibrational mode, $q_s$ is the totally symmetric $\\mathrm{a}_1'$ normal coordinate, $\\hat{I}$ is the identity operator on the diabatic electronic subspace, $E_0$ is a constant reference energy, $\\alpha$ and $k$ are real vibronic coupling constants, and $\\Delta \\ge 0$ is a real parameter.\n\nLet the adiabatic electronic states $\\{\\,|\\psi_+(\\mathbf{q})\\rangle,\\,|\\psi_-(\\mathbf{q})\\rangle\\,\\}$ be the normalized eigenstates of $\\hat{H}_{\\mathrm{d}}(\\mathbf{q})$ with eigenvalues $E_+(\\mathbf{q})$ and $E_-(\\mathbf{q})$, respectively. Define the off-diagonal non-adiabatic derivative coupling element along a nuclear coordinate $q_\\mu$ as\n$$\nd_{+-}^{(\\mu)}(\\mathbf{q}) \\;=\\; \\langle \\psi_+(\\mathbf{q}) \\,|\\, \\partial/\\partial q_\\mu \\,|\\, \\psi_-(\\mathbf{q}) \\rangle.\n$$\n\nUsing only the information given above and first-principles reasoning, determine the exact analytic expression for the non-adiabatic derivative coupling component $d_{+-}^{(s)}(\\mathbf{q})$ along the totally symmetric displacement $q_s$ in terms of the parameters $\\Delta$, $k$, $\\alpha$, $E_0$, and the coordinates $(q_x,q_y,q_s)$. Express your final answer as a single, closed-form expression. No numerical approximation is required. Do not include any units.", "solution": "The problem requires the determination of the non-adiabatic derivative coupling element $d_{+-}^{(s)}(\\mathbf{q})$ along the totally symmetric coordinate $q_s$. This quantity is defined as:\n$$\nd_{+-}^{(s)}(\\mathbf{q}) \\;=\\; \\langle \\psi_+(\\mathbf{q}) \\,|\\, \\frac{\\partial}{\\partial q_s} \\,|\\, \\psi_-(\\mathbf{q}) \\rangle\n$$\nwhere $|\\psi_+(\\mathbf{q})\\rangle$ and $|\\psi_-(\\mathbf{q})\\rangle$ are the adiabatic electronic eigenstates corresponding to the eigenvalues $E_+(\\mathbf{q})$ and $E_-(\\mathbf{q})$ of the provided diabatic Hamiltonian $\\hat{H}_{\\mathrm{d}}(\\mathbf{q})$.\n\nA rigorous analysis must begin with the structure of the Hamiltonian operator. The given Hamiltonian is:\n$$\n\\hat{H}_{\\mathrm{d}}(\\mathbf{q}) \\;=\\; \\left(E_0 + \\alpha\\, q_s\\right)\\,\\hat{I}\n\\;+\\;\n\\begin{pmatrix}\n\\dfrac{\\Delta}{2} & k\\,(q_x - i\\,q_y) \\\\\nk\\,(q_x + i\\,q_y) & -\\dfrac{\\Delta}{2}\n\\end{pmatrix}\n$$\nThis operator can be decomposed into two distinct terms. The first term, $ (E_0 + \\alpha\\, q_s)\\,\\hat{I} $, is a scalar operator, being a multiple of the $2 \\times 2$ identity operator $\\hat{I}$. This term depends solely on the coordinate $q_s$. The second term is a matrix operator that depends exclusively on the coordinates $q_x$ and $q_y$. Let us denote this second term as $\\hat{V}(q_x, q_y)$:\n$$\n\\hat{V}(q_x, q_y) \\;=\\;\n\\begin{pmatrix}\n\\dfrac{\\Delta}{2} & k\\,(q_x - i\\,q_y) \\\\\nk\\,(q_x + i\\,q_y) & -\\dfrac{\\Delta}{2}\n\\end{pmatrix}\n$$\nThe full Hamiltonian can then be concisely expressed as the sum:\n$$\n\\hat{H}_{\\mathrm{d}}(\\mathbf{q}) \\;=\\; \\left(E_0 + \\alpha\\, q_s\\right)\\,\\hat{I} \\;+\\; \\hat{V}(q_x, q_y)\n$$\nThe adiabatic electronic states $|\\psi_\\pm(\\mathbf{q})\\rangle$ are, by definition, the eigenvectors of $\\hat{H}_{\\mathrm{d}}(\\mathbf{q})$. A fundamental property of linear operators dictates that the eigenvectors of $\\hat{H}_{\\mathrm{d}}(\\mathbf{q})$ are identical to the eigenvectors of $\\hat{V}(q_x, q_y)$. This is because the term proportional to the identity operator, $(E_0 + \\alpha q_s)\\hat{I}$, commutes with any operator and thus only shifts the eigenvalues of $\\hat{V}(q_x, q_y)$ by a constant amount, $(E_0 + \\alpha q_s)$, without affecting the corresponding eigenvectors.\nTo be explicit, if $|\\phi\\rangle$ is an eigenvector of $\\hat{V}(q_x, q_y)$ with eigenvalue $\\lambda_V$, such that $\\hat{V}(q_x, q_y) |\\phi\\rangle = \\lambda_V |\\phi\\rangle$, then its action under the full Hamiltonian is:\n$$\n\\hat{H}_{\\mathrm{d}}(\\mathbf{q}) |\\phi\\rangle \\;=\\; \\left(E_0 + \\alpha\\, q_s\\right)\\hat{I}|\\phi\\rangle \\;+\\; \\hat{V}(q_x, q_y) |\\phi\\rangle \\;=\\; \\left(E_0 + \\alpha\\, q_s\\right) |\\phi\\rangle \\;+\\; \\lambda_V |\\phi\\rangle \\;=\\; \\left(E_0 + \\alpha\\, q_s + \\lambda_V \\right) |\\phi\\rangle\n$$\nThis demonstrates that $|\\phi\\rangle$ is also an eigenvector of $\\hat{H}_{\\mathrm{d}}(\\mathbf{q})$.\n\nConsequently, the adiabatic eigenstates $|\\psi_\\pm(\\mathbf{q})\\rangle$ are determined solely by the diagonalization of the matrix $\\hat{V}(q_x, q_y)$. Since the matrix elements of $\\hat{V}(q_x, q_y)$ are functions of only $q_x$ and $q_y$, its eigenvectors must also be functions of only $q_x$ and $q_y$. The adiabatic states, therefore, exhibit no functional dependence on the coordinate $q_s$. We are justified in writing $|\\psi_\\pm(\\mathbf{q})\\rangle$ more precisely as $|\\psi_\\pm(q_x, q_y)\\rangle$.\n\nWith this critical insight, we can now evaluate the expression for the non-adiabatic derivative coupling $d_{+-}^{(s)}(\\mathbf{q})$. We substitute the correct functional dependence of the adiabatic states into the definition:\n$$\nd_{+-}^{(s)}(\\mathbf{q}) \\;=\\; \\langle \\psi_+(q_x, q_y) \\,|\\, \\frac{\\partial}{\\partial q_s} \\,|\\, \\psi_-(q_x, q_y) \\rangle\n$$\nThe partial derivative operator $\\frac{\\partial}{\\partial q_s}$ acts on the ket vector $|\\psi_-(q_x, q_y)\\rangle$. As we have established that this vector has no dependence on the variable $q_s$, its partial derivative with respect to $q_s$ is identically zero:\n$$\n\\frac{\\partial}{\\partial q_s} \\,|\\, \\psi_-(q_x, q_y) \\rangle \\;=\\; \\mathbf{0}\n$$\nwhere $\\mathbf{0}$ represents the zero vector in the electronic Hilbert space.\nSubstituting this result back into the expression for the coupling element yields the final answer:\n$$\nd_{+-}^{(s)}(\\mathbf{q}) \\;=\\; \\langle \\psi_+(q_x, q_y) \\,|\\, \\mathbf{0} \\rangle \\;=\\; 0\n$$\nThis result is exact and holds for all points $\\mathbf{q}$ in the coordinate space and for all possible values of the parameters $E_0$, $\\alpha$, $k$, and $\\Delta$. The physical reason is that the totally symmetric coordinate $q_s$ acts as a \"tuning\" mode, which shifts the energies of both potential surfaces equally but does not introduce any coupling between the diabatic states. Therefore, it cannot induce any non-adiabatic coupling between the resulting adiabatic states.", "answer": "$$\n\\boxed{0}\n$$", "id": "2453334"}, {"introduction": "While conceptual understanding is crucial, a key skill in computational chemistry is the ability to actually locate important structures like conical intersections on a potential energy surface. This hands-on coding exercise [@problem_id:2453357] challenges you to implement a penalty function method, a common algorithm used to find the Minimum Energy Conical Intersection (MECI). By bridging theory with practical implementation, you will gain a tangible understanding of how these elusive but critical points are pinpointed in modern computational studies.", "problem": "Consider a two-state linear vibronic coupling model for a conical intersection in the branching plane spanned by two mass-weighted normal coordinates $q_g$ and $q_h$ (both dimensionless). The diabatic Hamiltonian $H(q_g,q_h)$ is a $2 \\times 2$ real symmetric matrix with entries\n$$\nH(q_g,q_h) = \\begin{pmatrix}\nV_{11}(q_g,q_h) & V_{12}(q_g,q_h) \\\\\nV_{12}(q_g,q_h) & V_{22}(q_g,q_h)\n\\end{pmatrix},\n$$\nwhere the diabatic potentials are given by\n$$\nV_{11}(q_g,q_h) = \\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2 + \\tfrac{\\Delta}{2} + k_g q_g + k_h q_h,\n$$\n$$\nV_{22}(q_g,q_h) = \\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2 - \\tfrac{\\Delta}{2} - k_g q_g - k_h q_h,\n$$\n$$\nV_{12}(q_g,q_h) = c_0 + c_g q_g + c_h q_h,\n$$\nwith all energies in electronvolts. The adiabatic energies $E_1(q_g,q_h)$ and $E_2(q_g,q_h)$ (in electronvolts) are defined as the ordered eigenvalues of $H(q_g,q_h)$ with $E_1 \\le E_2$. A conical intersection occurs where the energy gap $G(q_g,q_h) = E_2 - E_1$ vanishes. The Minimum Energy Conical Intersection (MECI) is the point on the intersection set that minimizes the average adiabatic energy $\\bar{E}(q_g,q_h) = \\tfrac{1}{2}(E_1 + E_2)$, both in electronvolts.\n\nYou are asked to implement a numerical penalty-function method to locate the MECI by minimizing the scalar objective\n$$\nF(q_g,q_h;\\mu) = \\bar{E}(q_g,q_h) + \\mu \\, \\big(E_2(q_g,q_h) - E_1(q_g,q_h)\\big)^2,\n$$\nwhere $\\mu \\ge 0$ is a penalty weight. Your program must, for each test case, perform a two-dimensional unconstrained numerical minimization of $F$ starting from the specified initial guess $(q_g^{(0)}, q_h^{(0)})$ and return the optimized $(q_g^\\star, q_h^\\star)$, the corresponding optimized average energy $\\bar{E}^\\star = \\bar{E}(q_g^\\star,q_h^\\star)$ in electronvolts, and the residual energy gap $G^\\star = E_2(q_g^\\star,q_h^\\star)$ $- E_1(q_g^\\star,q_h^\\star)$ in electronvolts.\n\nFundamental base you should rely on:\n- The Born–Oppenheimer framework and its breakdown near degeneracies, where adiabatic energies are defined as eigenvalues of the electronic Hamiltonian parametrized by nuclear coordinates.\n- The concept of the conical intersection where the adiabatic energy gap $G$ is zero, and the MECI as the lowest-energy point on this set.\n- Numerical optimization principles for minimizing a scalar objective function.\n\nImplement the algorithm in a universal way and apply it to the following scientifically plausible and self-consistent test suite. All energies must be expressed in electronvolts, and all coordinates are dimensionless mass-weighted normal coordinates. Angles are not involved. Your program should round each reported floating-point quantity to six decimal places in the final output.\n\nUse the following two parameter sets:\n\n- Parameter set A: $\\kappa_g = 1.0$, $\\kappa_h = 1.2$, $\\Delta = 0.05$, $k_g = 0.6$, $k_h = -0.2$, $c_0 = 0.02$, $c_g = 0.4$, $c_h = -0.3$.\n- Parameter set B: $\\kappa_g = 0.8$, $\\kappa_h = 1.1$, $\\Delta = -0.08$, $k_g = 0.5$, $k_h = 0.1$, $c_0 = 0.03$, $c_g = 0.2$, $c_h = 0.25$.\n\nTest suite (each test is defined by $(\\text{parameter set}, \\mu, q_g^{(0)}, q_h^{(0)})$):\n1. $(\\text{A}, 50.0, 0.0, 0.0)$\n2. $(\\text{A}, 1.0, 0.5, -0.5)$\n3. $(\\text{A}, 0.0, 0.0, 0.0)$\n4. $(\\text{B}, 100.0, 0.0, 0.0)$\n\nFor each test case, output the list $[q_g^\\star, q_h^\\star, \\bar{E}^\\star, G^\\star]$ with all four entries rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a bracketed comma-separated list. For example, the output format must be\n\"[ [qg1,qh1,Eavg1,gap1],[qg2,qh2,Eavg2,gap2],... ]\" but without spaces, i.e.,\n\"[[qg1,qh1,Eavg1,gap1],[qg2,qh2,Eavg2,gap2],...]\".", "solution": "The validity of the problem statement is hereby confirmed. The problem is scientifically grounded within the standard linear vibronic coupling (LVC) model of computational chemistry, is well-posed, objective, and self-contained. All provided parameters and conditions are physically and mathematically consistent. We may proceed to the solution.\n\nThe core of the problem is to find the Minimum Energy Conical Intersection (MECI) for a two-state system described by a diabatic Hamiltonian matrix $H(q_g,q_h)$. The MECI is a point in the nuclear coordinate space $(q_g, q_h)$ where the two adiabatic electronic states become degenerate, $E_1 = E_2$, and the energy at this point is the lowest possible among all such degeneracy points.\n\nFirst, we must derive analytical expressions for the quantities involved in the objective function. The adiabatic energies, $E_1$ and $E_2$, are the eigenvalues of the $2 \\times 2$ real symmetric Hamiltonian matrix:\n$$\nH(q_g,q_h) = \\begin{pmatrix}\nV_{11}(q_g,q_h) & V_{12}(q_g,q_h) \\\\\nV_{12}(q_g,q_h) & V_{22}(q_g,q_h)\n\\end{pmatrix}\n$$\nThe eigenvalues of such a matrix are given by the standard formula:\n$$\nE_{1,2} = \\frac{V_{11} + V_{22}}{2} \\pm \\frac{1}{2}\\sqrt{(V_{11} - V_{22})^2 + 4V_{12}^2}\n$$\nBy definition, $E_1 \\le E_2$. The average adiabatic energy $\\bar{E}$ and the energy gap $G$ are therefore:\n$$\n\\bar{E}(q_g,q_h) = \\frac{E_1 + E_2}{2} = \\frac{V_{11} + V_{22}}{2}\n$$\n$$\nG(q_g,q_h) = E_2 - E_1 = \\sqrt{(V_{11} - V_{22})^2 + 4V_{12}^2}\n$$\nNext, we substitute the specific forms of the diabatic potentials provided in the problem statement.\nFor the average energy $\\bar{E}$:\n$$\nV_{11} + V_{22} = \\left(\\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2 + \\tfrac{\\Delta}{2} + k_g q_g + k_h q_h\\right) + \\left(\\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2 - \\tfrac{\\Delta}{2} - k_g q_g - k_h q_h\\right)\n$$\n$$\nV_{11} + V_{22} = \\kappa_g q_g^2 + \\kappa_h q_h^2\n$$\nThus, the average energy is a simple harmonic potential:\n$$\n\\bar{E}(q_g,q_h) = \\frac{1}{2}(\\kappa_g q_g^2 + \\kappa_h q_h^2)\n$$\nFor the energy gap $G$, we need the difference of the diagonal terms and the off-diagonal term:\n$$\nV_{11} - V_{22} = \\left(\\tfrac{\\Delta}{2} + k_g q_g + k_h q_h\\right) - \\left(-\\tfrac{\\Delta}{2} - k_g q_g - k_h q_h\\right) = \\Delta + 2k_g q_g + 2k_h q_h\n$$\n$$\nV_{12} = c_0 + c_g q_g + c_h q_h\n$$\nSubstituting these into the expression for the gap $G$ gives:\n$$\nG(q_g,q_h) = \\sqrt{(\\Delta + 2k_g q_g + 2k_h q_h)^2 + 4(c_0 + c_g q_g + c_h q_h)^2}\n$$\nThe problem requires finding the MECI by minimizing a penalty function $F(q_g,q_h;\\mu)$:\n$$\nF(q_g,q_h;\\mu) = \\bar{E}(q_g,q_h) + \\mu \\, G(q_g,q_h)^2\n$$\nThe squared gap term $G^2$ is used to create a smooth objective function and to penalize any deviation from the conical intersection condition $G=0$. The parameter $\\mu$ is a penalty weight; a larger $\\mu$ enforces the $G=0$ constraint more strictly.\nSubstituting our derived expressions for $\\bar{E}$ and $G$ into $F$:\n$$\nF(q_g,q_h;\\mu) = \\left( \\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2 \\right) + \\mu \\left[ (\\Delta + 2k_g q_g + 2k_h q_h)^2 + 4(c_0 + c_g q_g + c_h q_h)^2 \\right]\n$$\nThis expression is a quadratic form in $q_g$ and $q_h$. For the given positive-definite harmonic terms ($\\kappa_g, \\kappa_h > 0$) and a non-negative penalty weight $\\mu \\ge 0$, this function is convex and possesses a unique global minimum. The task is to find this minimum $(q_g^\\star, q_h^\\star)$ numerically.\n\nThe algorithmic approach is as follows:\n1.  For each test case, define the specific set of parameters $(\\kappa_g, \\kappa_h, \\Delta, k_g, k_h, c_0, c_g, c_h, \\mu)$.\n2.  Implement the objective function $F(q_g,q_h;\\mu)$ in code. This function will take a vector of coordinates $[q_g, q_h]$ and the parameters as input.\n3.  Utilize a standard numerical optimization algorithm to find the minimum of $F$. The Broyden–Fletcher–Goldfarb–Shanno (BFGS) algorithm, available in the `scipy.optimize.minimize` library function, is an excellent choice for this unconstrained minimization of a smooth function.\n4.  The minimization procedure starts from the initial guess $(q_g^{(0)}, q_h^{(0)})$ provided for each test case.\n5.  Upon convergence, the optimizer returns the optimal coordinates $(q_g^\\star, q_h^\\star)$.\n6.  Using these optimized coordinates, calculate the final quantities of interest:\n    - The optimized average energy: $\\bar{E}^\\star = \\bar{E}(q_g^\\star, q_h^\\star) = \\tfrac{1}{2}\\kappa_g (q_g^\\star)^2 + \\tfrac{1}{2}\\kappa_h (q_h^\\star)^2$.\n    - The residual energy gap at the optimized point: $G^\\star = G(q_g^\\star, q_h^\\star) = \\sqrt{(\\Delta + 2k_g q_g^\\star + 2k_h q_h^\\star)^2 + 4(c_0 + c_g q_g^\\star + c_h q_h^\\star)^2}$.\n7.  The final result for each test case is the list $[q_g^\\star, q_h^\\star, \\bar{E}^\\star, G^\\star]$, with each value rounded to six decimal places.\n\nConsider the case $\\mu=0$ (Test Case 3). The objective function becomes $F(q_g,q_h;0) = \\bar{E}(q_g,q_h) = \\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2$. The minimum of this function is trivially at $(q_g,q_h) = (0,0)$. The optimization simply finds the minimum of the average energy surface, ignoring the conical intersection condition. The resulting gap $G^\\star$ will generally be non-zero. For $\\mu > 0$, the optimizer must balance minimizing $\\bar{E}$ (which pulls the solution toward the origin) and minimizing $G$ (which pulls the solution toward the intersection seam). Larger values of $\\mu$ yield a point closer to the true MECI, at the cost of potentially slower convergence or numerical stiffness.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the MECI optimization problem for the given test cases.\n    \"\"\"\n    # Define the parameter sets from the problem statement.\n    params_A = {\n        'kappa_g': 1.0, 'kappa_h': 1.2, 'Delta': 0.05,\n        'k_g': 0.6, 'k_h': -0.2, 'c_0': 0.02,\n        'c_g': 0.4, 'c_h': -0.3\n    }\n    params_B = {\n        'kappa_g': 0.8, 'kappa_h': 1.1, 'Delta': -0.08,\n        'k_g': 0.5, 'k_h': 0.1, 'c_0': 0.03,\n        'c_g': 0.2, 'c_h': 0.25\n    }\n\n    # Define the test cases from the problem statement.\n    # Each case is (parameter_set_dict, mu, q_g_initial, q_h_initial)\n    test_cases = [\n        (params_A, 50.0, 0.0, 0.0),\n        (params_A, 1.0, 0.5, -0.5),\n        (params_A, 0.0, 0.0, 0.0),\n        (params_B, 100.0, 0.0, 0.0),\n    ]\n\n    def objective_function(q, params, mu):\n        \"\"\"\n        Calculates the penalty function F(q_g, q_h; mu).\n        q: numpy array [q_g, q_h]\n        params: dictionary of model parameters\n        mu: penalty weight\n        \"\"\"\n        q_g, q_h = q\n        \n        # Unpack parameters\n        kappa_g = params['kappa_g']\n        kappa_h = params['kappa_h']\n        Delta = params['Delta']\n        k_g = params['k_g']\n        k_h = params['k_h']\n        c_0 = params['c_0']\n        c_g = params['c_g']\n        c_h = params['c_h']\n\n        # Calculate average energy E_bar\n        e_avg = 0.5 * kappa_g * q_g**2 + 0.5 * kappa_h * q_h**2\n        \n        # Calculate squared energy gap G^2\n        # G^2 = (V11 - V22)^2 + 4 * V12^2\n        v11_minus_v22 = Delta + 2 * k_g * q_g + 2 * k_h * q_h\n        v12 = c_0 + c_g * q_g + c_h * q_h\n        g_squared = v11_minus_v22**2 + 4 * v12**2\n        \n        # Return the penalty function value\n        return e_avg + mu * g_squared\n\n    results = []\n    for params, mu, qg0, qh0 in test_cases:\n        # Set initial guess\n        initial_guess = np.array([qg0, qh0])\n        \n        # Perform numerical minimization\n        opt_result = minimize(\n            objective_function,\n            initial_guess,\n            args=(params, mu),\n            method='BFGS'\n        )\n        \n        # Extract optimized coordinates\n        q_star = opt_result.x\n        qg_star, qh_star = q_star\n        \n        # Unpack parameters for final calculations\n        kappa_g = params['kappa_g']\n        kappa_h = params['kappa_h']\n        Delta = params['Delta']\n        k_g = params['k_g']\n        k_h = params['k_h']\n        c_0 = params['c_0']\n        c_g = params['c_g']\n        c_h = params['c_h']\n\n        # Calculate final quantities at the optimized point\n        e_avg_star = 0.5 * kappa_g * qg_star**2 + 0.5 * kappa_h * qh_star**2\n        \n        v11_minus_v22_star = Delta + 2 * k_g * qg_star + 2 * k_h * qh_star\n        v12_star = c_0 + c_g * qg_star + c_h * qh_star\n        g_star = np.sqrt(v11_minus_v22_star**2 + 4 * v12_star**2)\n        \n        # Append the results for this case\n        results.append([qg_star, qh_star, e_avg_star, g_star])\n\n    # Format the final output string as specified\n    output_str = '[' + ','.join([f'[{r[0]:.6f},{r[1]:.6f},{r[2]:.6f},{r[3]:.6f}]' for r in results]) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "2453357"}]}