{"hands_on_practices": [{"introduction": "Understanding a complex concept often begins with a simplified, solvable model. This practice invites you to derive the non-adiabatic coupling vector (NACV) for a fundamental two-state system, which forms the basis for describing countless chemical processes like charge transfer and photochemistry. By working through the derivation from first principles [@problem_id:2459464], you will gain a concrete understanding of how the NACV component $d_{12}(R)$ arises directly from the Hamiltonian's dependence on nuclear geometry and mediates transitions between different electronic states, a contrast to the diagonal coupling $\\mathbf{d}_{II}(\\mathbf{R})$ which can be set to zero by a suitable gauge choice [@problem_id:2459426].", "problem": "A heteronuclear diatomic molecule with two nuclei separated by internuclear distance $R$ has a total of three electrons. Two electrons form a frozen closed shell in a core orbital that is the same for all $R$ and does not couple to the active space. The remaining single active electron is described in a fixed orthonormal diabatic basis $\\{|A\\rangle, |B\\rangle\\}$ that is independent of $R$, where $|A\\rangle$ is localized on atom $A$ and $|B\\rangle$ is localized on atom $B$. In this diabatic basis, the effective one-electron Hamiltonian is the real symmetric $2 \\times 2$ matrix\n$$\nH(R) \\;=\\; \\begin{pmatrix}\n\\varepsilon_A & V(R) \\\\\nV(R) & \\varepsilon_B\n\\end{pmatrix},\n$$\nwith constant on-site energy difference $\\Delta_0 \\equiv \\varepsilon_A - \\varepsilon_B \\neq 0$ and an off-diagonal electronic coupling\n$$\nV(R) \\;=\\; V_0 \\,\\exp(-\\alpha R),\n$$\nwhere $V_0 > 0$ and $\\alpha > 0$ are constants. The adiabatic electronic states for the three-electron system are Slater determinants built as the product of the frozen closed shell and the single-electron eigenstates of $H(R)$. Under these conditions, the non-adiabatic coupling vector (NACV) between the two lowest-energy doublet adiabatic states is purely along the internuclear axis and its scalar component is given by the derivative coupling\n$$\nd_{12}(R) \\;\\equiv\\; \\langle \\Psi_1(R) \\,|\\, \\partial/\\partial R \\,|\\, \\Psi_2(R) \\rangle \\;=\\; \\langle \\psi_1(R) \\,|\\, \\partial/\\partial R \\,|\\, \\psi_2(R) \\rangle,\n$$\nwhere $|\\psi_1(R)\\rangle$ and $|\\psi_2(R)\\rangle$ are the normalized, real, $R$-dependent one-electron eigenstates of $H(R)$ ordered by increasing energy, and the phase (gauge) is chosen to be smooth in $R$.\n\nStarting from the definitions above and first principles, derive an explicit closed-form analytic expression for $d_{12}(R)$ as a function of $R$ in terms of the parameters $V_0$, $\\alpha$, and $\\Delta_0$. Use atomic units, taking $R$ in bohr, $\\alpha$ in inverse bohr, and $V_0$ and $\\Delta_0$ in hartree, so that $d_{12}(R)$ has units of inverse bohr. Express your final answer as a single analytic function of $R$. Do not substitute numerical values and do not round; no numerical approximation is required.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n-   System: A heteronuclear diatomic molecule with one active electron.\n-   Basis: A fixed, $R$-independent, orthonormal diabatic basis $\\{|A\\rangle, |B\\rangle\\}$.\n-   Hamiltonian: The effective one-electron Hamiltonian in the diabatic basis is a real symmetric $2 \\times 2$ matrix:\n    $$ H(R) = \\begin{pmatrix} \\varepsilon_A & V(R) \\\\ V(R) & \\varepsilon_B \\end{pmatrix} $$\n-   Parameters:\n    -   On-site energy difference: $\\Delta_0 \\equiv \\varepsilon_A - \\varepsilon_B \\neq 0$.\n    -   Off-diagonal electronic coupling: $V(R) = V_0 \\exp(-\\alpha R)$, with $V_0 > 0$ and $\\alpha > 0$.\n-   Adiabatic States: $|\\psi_1(R)\\rangle$ and $|\\psi_2(R)\\rangle$ are the normalized, real, $R$-dependent one-electron eigenstates of $H(R)$, ordered by increasing energy ($E_1 < E_2$).\n-   Target Quantity: The non-adiabatic derivative coupling, $d_{12}(R)$, is defined as:\n    $$ d_{12}(R) = \\langle \\psi_1(R) \\,|\\, \\frac{\\partial}{\\partial R} \\,|\\, \\psi_2(R) \\rangle $$\n    The phase is chosen such that the eigenstates are real and smooth functions of $R$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem describes a standard two-state model system, which is a fundamental and widely used concept in computational and theoretical chemistry for studying non-adiabatic processes, such as charge transfer. The Hamiltonian structure and the definition of the non-adiabatic coupling are correct.\n-   **Well-Posedness**: The problem is well-posed. It provides all necessary information—the Hamiltonian, its parameters, and the definition of the quantity to be derived—to find a unique analytical solution.\n-   **Objectivity**: The problem is stated in precise, objective, and standard scientific language.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, and self-contained. It is therefore deemed **valid**. We proceed to the derivation of the solution.\n\nThe objective is to derive an analytical expression for the non-adiabatic coupling $d_{12}(R)$. A direct and rigorous method is to use the off-diagonal Hellmann-Feynman theorem. For two distinct orthonormal eigenstates $|\\psi_i\\rangle$ and $|\\psi_j\\rangle$ of a Hamiltonian $H(R)$ with eigenvalues $E_i$ and $E_j$ respectively, the derivative coupling is given by:\n$$ \\langle \\psi_i \\,|\\, \\frac{\\partial}{\\partial R} \\,|\\, \\psi_j \\rangle = \\frac{\\langle \\psi_i \\,|\\, \\frac{\\partial H}{\\partial R} \\,|\\, \\psi_j \\rangle}{E_j - E_i} \\quad (i \\neq j) $$\nWe will apply this formula for $i=1$ and $j=2$. This requires us to determine the eigenvalues $E_1(R)$, $E_2(R)$, the eigenvectors $|\\psi_1(R)\\rangle$, $|\\psi_2(R)\\rangle$, and the derivative of the Hamiltonian matrix, $\\frac{\\partial H}{\\partial R}$.\n\nFirst, we find the eigenvalues and eigenvectors of $H(R)$. It is convenient to express the Hamiltonian matrix in terms of the average energy $\\bar{E} = \\frac{\\varepsilon_A + \\varepsilon_B}{2}$ and the difference $\\Delta_0 = \\varepsilon_A - \\varepsilon_B$:\n$$ H(R) = \\begin{pmatrix} \\bar{E} + \\frac{\\Delta_0}{2} & V(R) \\\\ V(R) & \\bar{E} - \\frac{\\Delta_0}{2} \\end{pmatrix} $$\nThe eigenvalues $E$ are found by solving the characteristic equation $\\det(H - E I) = 0$:\n$$ (\\bar{E} + \\frac{\\Delta_0}{2} - E)(\\bar{E} - \\frac{\\Delta_0}{2} - E) - V(R)^2 = 0 $$\n$$ (E - \\bar{E})^2 - (\\frac{\\Delta_0}{2})^2 - V(R)^2 = 0 $$\n$$ E = \\bar{E} \\pm \\sqrt{(\\frac{\\Delta_0}{2})^2 + V(R)^2} $$\nThe problem states that the states are ordered by increasing energy. Thus, the two eigenvalues are:\n$$ E_1(R) = \\frac{\\varepsilon_A + \\varepsilon_B}{2} - \\frac{1}{2} \\sqrt{\\Delta_0^2 + 4V(R)^2} $$\n$$ E_2(R) = \\frac{\\varepsilon_A + \\varepsilon_B}{2} + \\frac{1}{2} \\sqrt{\\Delta_0^2 + 4V(R)^2} $$\nThe energy difference, required for the denominator of the coupling formula, is:\n$$ E_2(R) - E_1(R) = \\sqrt{\\Delta_0^2 + 4V(R)^2} $$\n\nNext, we find the eigenvectors. The transformation from the diabatic basis $\\{|A\\rangle, |B\\rangle\\}$ to the adiabatic basis $\\{|\\psi_1\\rangle, |\\psi_2\\rangle\\}$ can be described by a rotation matrix with a mixing angle $\\theta(R)$. Let the adiabatic eigenvectors be:\n$$ |\\psi_1(R) \\rangle = -\\sin\\theta(R) |A\\rangle + \\cos\\theta(R) |B\\rangle $$\n$$ |\\psi_2(R) \\rangle = \\cos\\theta(R) |A\\rangle + \\sin\\theta(R) |B\\rangle $$\nThis parameterization corresponds to a rotation that diagonalizes the Hamiltonian. The condition for diagonalization is that the off-diagonal elements of the transformed Hamiltonian must be zero, which leads to the relation:\n$$ \\tan(2\\theta) = \\frac{2V(R)}{\\varepsilon_A - \\varepsilon_B} = \\frac{2V(R)}{\\Delta_0} $$\nThis defines the mixing angle $\\theta(R)$ as a smooth function of $R$, satisfying the problem's condition on the gauge.\n\nNow we compute the terms in the Hellmann-Feynman formula. The derivative of the Hamiltonian is:\n$$ \\frac{\\partial H}{\\partial R} = \\begin{pmatrix} 0 & \\frac{dV}{dR} \\\\ \\frac{dV}{dR} & 0 \\end{pmatrix} $$\nThe numerator is the matrix element $\\langle \\psi_1 | \\frac{\\partial H}{\\partial R} | \\psi_2 \\rangle$. In the diabatic basis representation, where $|\\psi_1\\rangle \\leftrightarrow \\begin{pmatrix} -\\sin\\theta \\\\ \\cos\\theta \\end{pmatrix}$ and $|\\psi_2\\rangle \\leftrightarrow \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$:\n$$ \\langle \\psi_1 | \\frac{\\partial H}{\\partial R} | \\psi_2 \\rangle = \\begin{pmatrix} -\\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} 0 & \\frac{dV}{dR} \\\\ \\frac{dV}{dR} & 0 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} $$\n$$ = \\begin{pmatrix} \\cos\\theta \\frac{dV}{dR} & -\\sin\\theta \\frac{dV}{dR} \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = \\frac{dV}{dR}(\\cos^2\\theta - \\sin^2\\theta) = \\frac{dV}{dR} \\cos(2\\theta) $$\nFrom the relation $\\tan(2\\theta) = \\frac{2V}{\\Delta_0}$, we can express $\\cos(2\\theta)$ in terms of the Hamiltonian parameters. Assuming $2\\theta$ is in the quadrant determined by the signs of $V$ and $\\Delta_0$:\n$$ \\cos(2\\theta) = \\frac{\\Delta_0}{\\sqrt{\\Delta_0^2 + (2V)^2}} = \\frac{\\Delta_0}{\\sqrt{\\Delta_0^2 + 4V^2}} $$\nSubstituting this into the numerator gives:\n$$ \\langle \\psi_1 | \\frac{\\partial H}{\\partial R} | \\psi_2 \\rangle = \\frac{dV}{dR} \\frac{\\Delta_0}{\\sqrt{\\Delta_0^2 + 4V(R)^2}} $$\n\nNow we assemble the expression for $d_{12}(R)$:\n$$ d_{12}(R) = \\frac{\\langle \\psi_1 | \\frac{\\partial H}{\\partial R} | \\psi_2 \\rangle}{E_2 - E_1} = \\frac{\\frac{dV}{dR} \\frac{\\Delta_0}{\\sqrt{\\Delta_0^2 + 4V(R)^2}}}{\\sqrt{\\Delta_0^2 + 4V(R)^2}} = \\frac{\\Delta_0 \\frac{dV}{dR}}{\\Delta_0^2 + 4V(R)^2} $$\n\nThis confirms a known result that can also be obtained by directly calculating $d_{12}(R) = \\langle\\psi_1|\\partial_R \\psi_2\\rangle$. Since the diabatic basis is $R$-independent, we have $\\partial_R |\\psi_2\\rangle = (\\partial_R \\cos\\theta)|A\\rangle + (\\partial_R \\sin\\theta)|B\\rangle = (-\\sin\\theta|A\\rangle + \\cos\\theta|B\\rangle)\\frac{d\\theta}{dR} = |\\psi_1\\rangle \\frac{d\\theta}{dR}$. This gives $d_{12}(R) = \\langle\\psi_1|\\psi_1\\rangle \\frac{d\\theta}{dR} = \\frac{d\\theta}{dR}$. Differentiating $\\tan(2\\theta) = \\frac{2V}{\\Delta_0}$ with respect to $R$ yields $\\sec^2(2\\theta) \\cdot 2\\frac{d\\theta}{dR} = \\frac{2}{\\Delta_0}\\frac{dV}{dR}$, which simplifies to $\\frac{d\\theta}{dR} = \\frac{\\Delta_0 \\frac{dV}{dR}}{\\Delta_0^2 + 4V^2}$, confirming our result.\n\nFinally, we substitute the explicit forms for $V(R)$ and its derivative.\nGiven $V(R) = V_0 \\exp(-\\alpha R)$, the derivative is:\n$$ \\frac{dV(R)}{dR} = -\\alpha V_0 \\exp(-\\alpha R) $$\nSubstituting this into our expression for $d_{12}(R)$:\n$$ d_{12}(R) = \\frac{\\Delta_0 (-\\alpha V_0 \\exp(-\\alpha R))}{\\Delta_0^2 + 4(V_0 \\exp(-\\alpha R))^2} $$\nThis simplifies to the final closed-form expression:\n$$ d_{12}(R) = -\\frac{\\alpha \\Delta_0 V_0 \\exp(-\\alpha R)}{\\Delta_0^2 + 4V_0^2 \\exp(-2\\alpha R)} $$\nThis is the required analytical expression for the non-adiabatic coupling as a function of $R$ in terms of the given parameters.", "answer": "$$\\boxed{-\\frac{\\alpha \\Delta_0 V_0 \\exp(-\\alpha R)}{\\Delta_0^2 + 4V_0^2 \\exp(-2\\alpha R)}}$$", "id": "2459464"}, {"introduction": "The non-adiabatic coupling vector $\\mathbf{d}_{IJ}(\\mathbf{R})$ is a static property of the electronic wavefunctions at a given nuclear geometry, but its physical consequences emerge during chemical dynamics. The actual probability of a transition is governed by the scalar coupling term $\\dot{\\mathbf{R}} \\cdot \\mathbf{d}_{IJ}(\\mathbf{R})$, which depends on both the NACV and the nuclear velocity $\\dot{\\mathbf{R}}$. This exercise uses a hypothetical scenario [@problem_id:2459454] to explore this crucial interplay by examining a kinetic isotope effect, showing how changing nuclear mass affects non-adiabatic transition probabilities even when the underlying NACV field remains identical.", "problem": "In the adiabatic representation of the electronic Schrödinger equation for a molecule, the non-adiabatic coupling vector (NACV) is defined as $\\mathbf{d}_{IJ}(\\mathbf{R}) = \\langle \\Phi_I(\\mathbf{R}) \\,|\\, \\nabla_{\\mathbf{R}} \\,|\\, \\Phi_J(\\mathbf{R}) \\rangle$, where $|\\Phi_I(\\mathbf{R})\\rangle$ and $|\\Phi_J(\\mathbf{R})\\rangle$ are adiabatic electronic states and $\\mathbf{R}$ are nuclear coordinates. Consider two isotopologues, A-H and A-D, that differ only by replacing H with D. Assume the Born–Oppenheimer potential energy surfaces $E_I(\\mathbf{R})$ and $E_J(\\mathbf{R})$, as well as the NACV field $\\mathbf{d}_{IJ}(\\mathbf{R})$, are identical functions of $\\mathbf{R}$ for both isotopologues. A single effective nuclear coordinate $q$ drives the system through a localized coupling region of length $L$ centered at $q_c$, where $\\mathbf{d}_{IJ}(\\mathbf{R}) \\approx d_0 \\,\\hat{\\mathbf{e}}_q$ and the energy gap $\\Delta E_{IJ} = E_J - E_I$ is approximately constant and nonzero. The motion along $q$ is treated classically with mass $M$ and kinetic energy $E_{\\mathrm{kin}}$ at the entrance to the region. The electronic population transfer between states $I$ and $J$ during this passage is driven by the time-derivative coupling (TDC) $\\tau_{IJ}(t) = \\dot{q}(t)\\, d_0$, where $\\dot{q}(t)$ is the velocity along $q$. The two isotopologues enter the region with the same $E_{\\mathrm{kin}}$, but their masses differ, with $M_{\\mathrm{D}} = 2 M_{\\mathrm{H}}$.\n\nWhich option best describes how replacing H by D affects the probability of an $I \\to J$ transition during a single passage through the coupling region under these assumptions?\n\nA. It is identical for A-H and A-D because $\\mathbf{d}_{IJ}$ is an electronic property and does not depend on nuclear mass.\n\nB. It is larger for A-D because the heavier mass increases the time spent in the coupling region, which necessarily enhances mixing between the adiabatic states.\n\nC. It is smaller for A-D because, at the same $E_{\\mathrm{kin}}$, the nuclear speed satisfies $\\vert \\dot{q} \\vert \\propto 1/\\sqrt{M}$, reducing $\\vert \\tau_{IJ} \\vert$; for a finite $\\Delta E_{IJ}$ this suppresses the transition amplitude accumulated during the passage.\n\nD. It is zero for both isotopologues if $\\mathbf{d}_{IJ}$ is approximately constant in the region, because the TDC integrates to zero over the passage.", "solution": "The non-adiabatic coupling vector (NACV) $\\mathbf{d}_{IJ}(\\mathbf{R}) = \\langle \\Phi_I(\\mathbf{R}) \\,|\\, \\nabla_{\\mathbf{R}} \\,|\\, \\Phi_J(\\mathbf{R}) \\rangle$ is defined entirely by the electronic states at a fixed nuclear geometry $\\mathbf{R}$. By the statement of the problem, both isotopologues share the same electronic Hamiltonian as a function of $\\mathbf{R}$, so $\\mathbf{d}_{IJ}(\\mathbf{R})$ is identical for A-H and A-D at the same $\\mathbf{R}$.\n\nPopulation transfer between adiabatic states is induced by the time-derivative coupling (TDC) $\\tau_{IJ}(t) = \\langle \\Phi_I \\,|\\, \\partial_t \\,|\\, \\Phi_J \\rangle = \\dot{\\mathbf{R}}(t) \\cdot \\mathbf{d}_{IJ}(\\mathbf{R}(t))$. Under the present one-dimensional assumption along $q$ with $\\mathbf{d}_{IJ} \\approx d_0 \\,\\hat{\\mathbf{e}}_q$, this reduces to $\\tau_{IJ}(t) = \\dot{q}(t)\\, d_0$. The different masses $M$ enter through the nuclear velocity $\\dot{q}$. At fixed kinetic energy $E_{\\mathrm{kin}}$ along $q$, classical mechanics gives $\\tfrac{1}{2} M \\dot{q}^2 = E_{\\mathrm{kin}}$, so $\\vert \\dot{q} \\vert = \\sqrt{2 E_{\\mathrm{kin}}/M} \\propto 1/\\sqrt{M}$. Therefore, replacing H by D halves the speed by a factor $\\sqrt{2}$, reducing the magnitude of the TDC at any instant by the same factor.\n\nTo connect this kinematic change to the transition probability, consider the adiabatic electronic equation of motion in the two-state subspace. In the interaction picture with respect to the adiabatic energies, the first-order transition amplitude from $I$ to $J$ accumulated over the passage from time $t_i$ to $t_f$ is\n$$\nc_J(t_f) \\approx - \\int_{t_i}^{t_f} \\mathrm{d}t \\; \\tau_{JI}(t) \\, e^{\\tfrac{i}{\\hbar} \\int_{t_i}^{t} \\Delta E_{JI}(t') \\, \\mathrm{d}t'} \\, .\n$$\nWith $\\tau_{JI}(t) \\approx \\dot{q}(t) d_0$ and a constant gap $\\Delta E_{JI} = \\Delta E \\neq 0$ over a region of length $L$, we can approximate the speed as constant within the region, $\\dot{q}(t) \\approx v = \\sqrt{2 E_{\\mathrm{kin}}/M}$, and the passage time as $T = L/v$. The integral then evaluates to\n$$\nc_J(t_f) \\approx - v d_0 \\int_{0}^{T} \\mathrm{d}t \\; e^{i \\Delta E t/\\hbar}\n= - v d_0 \\, \\frac{e^{i \\Delta E T/\\hbar} - 1}{i \\Delta E/\\hbar} \\, .\n$$\nIts magnitude is\n$$\n\\vert c_J(t_f) \\vert = \\frac{2 v \\vert d_0 \\vert}{\\Delta E/\\hbar} \\, \\Big\\vert \\sin\\!\\Big( \\frac{\\Delta E \\, T}{2 \\hbar} \\Big) \\Big\\vert\n= \\frac{2 v \\vert d_0 \\vert}{\\Delta E/\\hbar} \\, \\Big\\vert \\sin\\!\\Big( \\frac{\\Delta E \\, L}{2 \\hbar \\, v} \\Big) \\Big\\vert \\, .\n$$\nFor fixed $L$ and $\\Delta E \\neq 0$, decreasing $v$ (heavier isotope) increases the argument of the sine, which leads to increased phase oscillations and, on average over typical conditions, a smaller transition amplitude due to destructive interference. This trend is fully consistent with the Landau–Zener (LZ) picture, where the probability of an adiabatic-state transition decreases monotonically as the speed along the coupling coordinate decreases at a given coupling strength and gap variation rate. In contrast, in the special limit $\\Delta E \\to 0$ over the entire region (an exact degeneracy throughout the passage), the integral would scale as $\\int \\dot{q} \\, \\mathrm{d}t = \\int \\mathrm{d}q = L$, but the problem explicitly excludes this case by specifying a nonzero, approximately constant $\\Delta E$.\n\nThus, under the stated assumptions and with the same $E_{\\mathrm{kin}}$, the heavier isotope D has a smaller $\\vert \\dot{q} \\vert$, a smaller instantaneous TDC, and, for finite $\\Delta E$, a smaller net transition probability per passage.\n\nOption-by-option analysis:\n\n- Option A: Incorrect. While $\\mathbf{d}_{IJ}(\\mathbf{R})$ is electronic and unchanged by isotope substitution at fixed $\\mathbf{R}$, the actual transition probability depends on the TDC $\\tau_{IJ} = \\dot{q} \\, d_0$, which includes the nuclear velocity and hence the mass. Therefore, isotope substitution can and does affect the transition probability even if $\\mathbf{d}_{IJ}$ is unchanged.\n\n- Option B: Incorrect. A heavier mass does increase the residence time $T = L/v$, but the instantaneous TDC is reduced by the same kinematic factor, and, for a finite gap, the accumulated phase $\\Delta E t/\\hbar$ causes increased destructive interference as $T$ grows. Standard two-state dynamics and the LZ model both predict fewer transitions between adiabatic states at lower speeds for fixed coupling characteristics.\n\n- Option C: Correct. For equal $E_{\\mathrm{kin}}$, $\\vert \\dot{q} \\vert \\propto 1/\\sqrt{M}$, so A-D has a smaller instantaneous TDC. With a nonzero $\\Delta E$, the longer interaction time at smaller $\\vert \\dot{q} \\vert$ produces more phase accumulation and thus suppresses the net transition amplitude, leading to a smaller transition probability per passage.\n\n- Option D: Incorrect. A constant $\\mathbf{d}_{IJ}$ does not make the TDC integral vanish. The integral of a nonzero constant times velocity over time equals the path length, modulo a phase factor from the energy gap. Only in the trivial case of zero coupling or complete destructive interference at very specific, fine-tuned conditions would the net transfer vanish; generically it does not, and the problem specifies a finite coupling region.", "answer": "$$\\boxed{C}$$", "id": "2459454"}, {"introduction": "Moving from analytical models to real-world computations brings new challenges, including the need to verify the physical correctness of our results. A fundamental principle is that the NACV must be invariant with respect to overall translation and rotation of the molecule; it should only depend on internal geometry. This hands-on computational task [@problem_id:2459442] guides you through implementing a standard procedure to test this invariance, a critical quality-control check performed in modern quantum chemistry software that distinguishes internal vibrations from rigid-body motions.", "problem": "You are given the task of assessing the translational and rotational invariance of a computed Non-Adiabatic Coupling Vector (NACV), defined between two adiabatic electronic states of a molecule. Consider a system of $N$ nuclei with masses $\\{m_i\\}_{i=1}^N$ and positions $\\{\\mathbf{R}_i\\}_{i=1}^N$ in three-dimensional space. The NACV is a $3N$-dimensional vector $\\mathbf{D}$ composed of $N$ three-dimensional blocks $\\{\\mathbf{D}_i\\}_{i=1}^N$, one for each nucleus. Let the mass-weighted inner product of two $3N$-vectors $\\mathbf{A}$ and $\\mathbf{B}$ be defined as\n$$\n\\langle \\mathbf{A}, \\mathbf{B} \\rangle_m \\equiv \\sum_{i=1}^N m_i\\, \\mathbf{A}_i \\cdot \\mathbf{B}_i,\n$$\nand the corresponding norm be\n$$\n\\|\\mathbf{A}\\|_m \\equiv \\sqrt{\\langle \\mathbf{A}, \\mathbf{A} \\rangle_m}.\n$$\nDefine the center of mass as\n$$\n\\mathbf{R}_{\\mathrm{CM}} \\equiv \\frac{\\sum_{i=1}^N m_i\\, \\mathbf{R}_i}{\\sum_{i=1}^N m_i}.\n$$\nThe rigid-body subspace $\\mathcal{S}$ consists of all $3N$-vectors $\\boldsymbol{\\delta}\\mathbf{R}$ that correspond to rigid translations and rotations, that is, there exist constant vectors $\\mathbf{a}$ and $\\boldsymbol{\\omega}$ such that\n$$\n\\boldsymbol{\\delta}\\mathbf{R}_i = \\mathbf{a} + \\boldsymbol{\\omega} \\times \\left(\\mathbf{R}_i - \\mathbf{R}_{\\mathrm{CM}}\\right), \\quad i = 1,\\dots,N.\n$$\nFor a non-linear molecule, the subspace $\\mathcal{S}$ has dimension $6$ (three translations and three rotations); for a strictly linear molecule, $\\mathcal{S}$ has dimension $5$ (three translations and two rotations orthogonal to the molecular axis).\n\nBy definition, a physically valid NACV must be orthogonal (with respect to $\\langle \\cdot,\\cdot\\rangle_m$) to every vector in $\\mathcal{S}$. Quantify the degree of invariance violation by the dimensionless number\n$$\nV(\\mathbf{D}) \\equiv \n\\begin{cases}\n\\displaystyle \\frac{\\left\\| \\mathbf{P}_{\\mathcal{S}}(\\mathbf{D}) \\right\\|_m}{\\|\\mathbf{D}\\|_m}, & \\text{if } \\|\\mathbf{D}\\|_m \\neq 0,\\\\\n0, & \\text{if } \\|\\mathbf{D}\\|_m = 0,\n\\end{cases}\n$$\nwhere $\\mathbf{P}_{\\mathcal{S}}$ denotes the orthogonal projector (with respect to $\\langle\\cdot,\\cdot\\rangle_m$) onto the rigid-body subspace $\\mathcal{S}$. By construction, $V(\\mathbf{D}) \\in [0,1]$, and $V(\\mathbf{D})=0$ indicates perfect translational and rotational invariance.\n\nImplement a program that, for each test case below, computes $V(\\mathbf{D})$ using only the given data. All positions must be interpreted in ångström, masses in atomic mass units, and NACV components in inverse ångström. The output is dimensionless.\n\nTest Suite:\n- Case $1$ (non-linear molecule, trivial edge case):\n  - $N = 3$.\n  - Masses: $\\left[m_1, m_2, m_3\\right] = \\left[15.999, 1.008, 1.008\\right]$.\n  - Positions: $\\left[\\mathbf{R}_1, \\mathbf{R}_2, \\mathbf{R}_3\\right] = \\left[(0.0, 0.0, 0.0),\\ (0.9572, 0.0, 0.0),\\ (-0.2399872, 0.927297, 0.0)\\right]$.\n  - NACV blocks: $\\left[\\mathbf{D}_1, \\mathbf{D}_2, \\mathbf{D}_3\\right] = \\left[(0.0, 0.0, 0.0),\\ (0.0, 0.0, 0.0),\\ (0.0, 0.0, 0.0)\\right]$.\n- Case $2$ (non-linear molecule, pure translation violation):\n  - $N = 3$.\n  - Masses: $\\left[15.999, 1.008, 1.008\\right]$.\n  - Positions: $\\left[(0.0, 0.0, 0.0),\\ (0.9572, 0.0, 0.0),\\ (-0.2399872, 0.927297, 0.0)\\right]$.\n  - NACV blocks: $\\left[(1.0\\times 10^{-3}, -2.0\\times 10^{-3}, 3.0\\times 10^{-3}),\\ (1.0\\times 10^{-3}, -2.0\\times 10^{-3}, 3.0\\times 10^{-3}),\\ (1.0\\times 10^{-3}, -2.0\\times 10^{-3}, 3.0\\times 10^{-3})\\right]$.\n- Case $3$ (linear molecule, pure rotation violation about the $z$ axis):\n  - $N = 3$.\n  - Masses: $\\left[15.999, 12.011, 15.999\\right]$.\n  - Positions: $\\left[(-1.16, 0.0, 0.0),\\ (0.0, 0.0, 0.0),\\ (1.16, 0.0, 0.0)\\right]$.\n  - NACV blocks constructed as $\\mathbf{D}_i = \\boldsymbol{\\omega}\\times(\\mathbf{R}_i-\\mathbf{R}_{\\mathrm{CM}})$ with $\\boldsymbol{\\omega}=(0.0, 0.0, 1.0\\times 10^{-3})$, explicitly:\n    - $\\mathbf{D}_1 = (0.0,\\ -1.16\\times 10^{-3},\\ 0.0)$,\n    - $\\mathbf{D}_2 = (0.0,\\ 0.0,\\ 0.0)$,\n    - $\\mathbf{D}_3 = (0.0,\\ 1.16\\times 10^{-3},\\ 0.0)$.\n- Case $4$ (non-linear molecule, general NACV):\n  - $N = 3$.\n  - Masses: $\\left[15.999, 1.008, 1.008\\right]$.\n  - Positions: $\\left[(0.0, 0.0, 0.0),\\ (0.9572, 0.0, 0.0),\\ (-0.2399872, 0.927297, 0.0)\\right]$.\n  - NACV blocks: $\\left[(2.0\\times 10^{-3}, -1.0\\times 10^{-3}, 5.0\\times 10^{-4}),\\ (-1.5\\times 10^{-3}, 7.0\\times 10^{-4}, -3.0\\times 10^{-4}),\\ (8.0\\times 10^{-4}, 4.0\\times 10^{-4}, -2.0\\times 10^{-4})\\right]$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, for example: $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$. Each $\\text{result}_k$ must be a floating-point number in decimal notation. No additional text or formatting should be printed.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of molecular mechanics and quantum chemistry, specifically concerning the properties of non-adiabatic coupling vectors. The problem is well-posed, providing all necessary definitions, data, and constraints to compute a unique, meaningful result. It is expressed in objective, unambiguous mathematical language and is free of factual errors or contradictions.\n\nThe central task is to compute the dimensionless quantity $V(\\mathbf{D})$, which measures the component of a non-adiabatic coupling vector (NACV) $\\mathbf{D}$ that lies within the rigid-body subspace $\\mathcal{S}$ of translations and rotations. The formula is given by:\n$$\nV(\\mathbf{D}) = \\frac{\\left\\| \\mathbf{P}_{\\mathcal{S}}(\\mathbf{D}) \\right\\|_m}{\\|\\mathbf{D}\\|_m}\n$$\nfor $\\|\\mathbf{D}\\|_m \\neq 0$, and $V(\\mathbf{D})=0$ otherwise. Here, $\\mathbf{P}_{\\mathcal{S}}$ is the orthogonal projector onto the subspace $\\mathcal{S}$ with respect to the specified mass-weighted inner product $\\langle \\mathbf{A}, \\mathbf{B} \\rangle_m = \\sum_{i=1}^N m_i \\mathbf{A}_i \\cdot \\mathbf{B}_i$.\n\nTo compute the norm of the projection, we first construct an orthonormal basis for the subspace $\\mathcal{S}$. Let this basis be $\\{\\mathbf{b}_k\\}_{k=1}^d$, where $d$ is the dimension of $\\mathcal{S}$. These basis vectors satisfy the orthonormality condition $\\langle \\mathbf{b}_j, \\mathbf{b}_k \\rangle_m = \\delta_{jk}$. The projection of $\\mathbf{D}$ onto $\\mathcal{S}$ is then given by $\\mathbf{P}_{\\mathcal{S}}(\\mathbf{D}) = \\sum_{k=1}^d \\langle \\mathbf{D}, \\mathbf{b}_k \\rangle_m \\mathbf{b}_k$. The squared norm of this projection is, by virtue of the orthonormality of the basis:\n$$\n\\left\\| \\mathbf{P}_{\\mathcal{S}}(\\mathbf{D}) \\right\\|_m^2 = \\left\\langle \\sum_{j=1}^d \\langle \\mathbf{D}, \\mathbf{b}_j \\rangle_m \\mathbf{b}_j, \\sum_{k=1}^d \\langle \\mathbf{D}, \\mathbf{b}_k \\rangle_m \\mathbf{b}_k \\right\\rangle_m = \\sum_{j,k} \\langle \\mathbf{D}, \\mathbf{b}_j \\rangle_m \\langle \\mathbf{D}, \\mathbf{b}_k \\rangle_m \\delta_{jk} = \\sum_{k=1}^d \\left( \\langle \\mathbf{D}, \\mathbf{b}_k \\rangle_m \\right)^2.\n$$\nThe problem thus reduces to constructing the orthonormal basis $\\{\\mathbf{b}_k\\}$.\n\nThe rigid-body subspace $\\mathcal{S}$ is spanned by vectors corresponding to rigid translations and rotations. A general vector in $\\mathcal{S}$ has atomic components $\\boldsymbol{\\delta}\\mathbf{R}_i = \\mathbf{a} + \\boldsymbol{\\omega} \\times \\mathbf{r}_i$, where $\\mathbf{r}_i = \\mathbf{R}_i - \\mathbf{R}_{\\mathrm{CM}}$ are the position vectors relative to the center of mass. This shows that $\\mathcal{S}$ can be decomposed into a direct sum of the translational subspace $\\mathcal{T}$ and the rotational subspace $\\mathcal{L}$, i.e., $\\mathcal{S} = \\mathcal{T} \\oplus \\mathcal{L}$. These subspaces are mutually orthogonal with respect to the mass-weighted inner product. To demonstrate this, consider a purely translational vector $\\mathbf{T}$ with components $\\mathbf{T}_i=\\mathbf{a}$ and a purely rotational vector $\\mathbf{L}$ with components $\\mathbf{L}_i = \\boldsymbol{\\omega} \\times \\mathbf{r}_i$. Their inner product is:\n$$\n\\langle \\mathbf{T}, \\mathbf{L} \\rangle_m = \\sum_{i=1}^N m_i \\mathbf{a} \\cdot (\\boldsymbol{\\omega} \\times \\mathbf{r}_i) = \\mathbf{a} \\cdot \\left( \\boldsymbol{\\omega} \\times \\sum_{i=1}^N m_i \\mathbf{r}_i \\right).\n$$\nBy the definition of the center of mass, $\\sum_{i=1}^N m_i \\mathbf{r}_i = \\sum_{i=1}^N m_i (\\mathbf{R}_i - \\mathbf{R}_{\\mathrm{CM}}) = 0$. Thus, $\\langle \\mathbf{T}, \\mathbf{L} \\rangle_m = 0$. This orthogonality allows us to construct orthonormal bases for $\\mathcal{T}$ and $\\mathcal{L}$ independently.\n\n**Orthonormal Basis for the Translational Subspace $\\mathcal{T}$**\nThe translational subspace $\\mathcal{T}$ is $3$-dimensional, spanned by vectors corresponding to translations along the Cartesian axes. Let $\\mathbf{T}_x, \\mathbf{T}_y, \\mathbf{T}_z$ be $3N$-dimensional vectors whose atomic blocks are $(\\mathbf{T}_x)_i = (1,0,0)$, $(\\mathbf{T}_y)_i = (0,1,0)$, and $(\\mathbf{T}_z)_i=(0,0,1)$ respectively. These are orthogonal under the mass-weighted inner product: $\\langle \\mathbf{T}_\\alpha, \\mathbf{T}_\\beta \\rangle_m = \\sum_i m_i (\\mathbf{e}_\\alpha \\cdot \\mathbf{e}_\\beta) = \\delta_{\\alpha\\beta} \\sum_i m_i = \\delta_{\\alpha\\beta} M_{\\text{tot}}$, where $M_{\\text{tot}}$ is the total mass. The corresponding orthonormal basis vectors are:\n$$\n\\mathbf{t}_\\alpha = \\frac{1}{\\sqrt{M_{\\text{tot}}}} \\mathbf{T}_\\alpha, \\quad \\alpha \\in \\{x,y,z\\}.\n$$\n\n**Orthonormal Basis for the Rotational Subspace $\\mathcal{L}$**\nThe rotational subspace $\\mathcal{L}$ is spanned by vectors corresponding to rotations about the Cartesian axes. Let $\\mathbf{L}_x, \\mathbf{L}_y, \\mathbf{L}_z$ be vectors with atomic blocks $(\\mathbf{L}_\\alpha)_i = \\mathbf{e}_\\alpha \\times \\mathbf{r}_i$. Unlike the translational basis, these vectors are not generally orthogonal. Their inner products form the elements of the moment of inertia tensor $\\mathbf{I}$:\n$$\n\\langle \\mathbf{L}_\\alpha, \\mathbf{L}_\\beta \\rangle_m = \\sum_{i=1}^N m_i (\\mathbf{e}_\\alpha \\times \\mathbf{r}_i) \\cdot (\\mathbf{e}_\\beta \\times \\mathbf{r}_i) = \\sum_{i=1}^N m_i \\left( \\delta_{\\alpha\\beta} |\\mathbf{r}_i|^2 - (\\mathbf{r}_i)_\\alpha (\\mathbf{r}_i)_\\beta \\right) = I_{\\alpha\\beta}.\n$$\nTo find an orthogonal basis for $\\mathcal{L}$, we diagonalize the symmetric matrix $\\mathbf{I}$. Let $\\mathbf{v}_k$ be the normalized eigenvectors of $\\mathbf{I}$ with corresponding eigenvalues $I_k$ (the principal moments of inertia). We define a new set of rotational vectors $\\mathbf{L'}_k$ with atomic blocks $(\\mathbf{L'}_k)_i = \\mathbf{v}_k \\times \\mathbf{r}_i$. These new vectors are orthogonal:\n$$\n\\langle \\mathbf{L'}_j, \\mathbf{L'}_k \\rangle_m = (\\mathbf{v}_j)^T \\mathbf{I} \\mathbf{v}_k = (\\mathbf{v}_j)^T (I_k \\mathbf{v}_k) = I_k \\delta_{jk}.\n$$\nThe dimension of $\\mathcal{L}$ depends on the number of non-zero eigenvalues of $\\mathbf{I}$. For a non-linear molecule, all $3$ eigenvalues are non-zero, and the dimension is $3$. For a linear molecule, one eigenvalue is zero (corresponding to rotation about the molecular axis), so the dimension is $2$.\nThe orthonormal basis vectors for $\\mathcal{L}$ are obtained by normalizing $\\mathbf{L'}_k$ for each $k$ where $I_k > 0$:\n$$\n\\mathbf{l}_k = \\frac{1}{\\sqrt{I_k}} \\mathbf{L'}_k.\n$$\n\n**Algorithm Summary**\nThe final algorithm is as follows:\n$1$. For a given system of $N$ nuclei with masses $\\{m_i\\}$ and positions $\\{\\mathbf{R}_i\\}$, compute the total mass $M_{\\text{tot}}$ and the center of mass $\\mathbf{R}_{\\mathrm{CM}}$.\n$2$. Compute the center-of-mass-referred coordinates $\\mathbf{r}_i = \\mathbf{R}_i - \\mathbf{R}_{\\mathrm{CM}}$.\n$3$. Construct the $3$ orthonormal translational basis vectors $\\{\\mathbf{t}_x, \\mathbf{t}_y, \\mathbf{t}_z\\}$.\n$4$. Construct the $3 \\times 3$ moment of inertia tensor $\\mathbf{I}$ using the coordinates $\\mathbf{r}_i$.\n$5$. Compute the eigenvalues $I_k$ and eigenvectors $\\mathbf{v}_k$ of $\\mathbf{I}$.\n$6$. For each eigenvalue $I_k$ that is significantly greater than zero (to account for numerical precision and identify linear molecules), construct the corresponding orthonormal rotational basis vector $\\mathbf{l}_k$. This yields $3$ vectors for a non-linear molecule and $2$ for a linear one.\n$7$. Collect all constructed translational and rotational vectors to form the complete orthonormal basis $\\{\\mathbf{b}_k\\}_{k=1}^d$ for $\\mathcal{S}$, where $d \\in \\{5, 6\\}$.\n$8$. Compute the squared norm of the NACV, $\\|\\mathbf{D}\\|_m^2 = \\sum_{i=1}^N m_i |\\mathbf{D}_i|^2$. If this norm is zero, $V(\\mathbf{D})=0$.\n$9$. Otherwise, compute the squared norm of the projection onto $\\mathcal{S}$: $\\|\\mathbf{P}_{\\mathcal{S}}(\\mathbf{D})\\|_m^2 = \\sum_{k=1}^d (\\langle \\mathbf{D}, \\mathbf{b}_k \\rangle_m)^2$.\n$10$. The final result is $V(\\mathbf{D}) = \\sqrt{\\|\\mathbf{P}_{\\mathcal{S}}(\\mathbf{D})\\|_m^2 / \\|\\mathbf{D}\\|_m^2}$.\nThis procedure is applied to each test case provided.", "answer": "$$\\boxed{[0.0,1.0,1.0,0.288922]}$$", "id": "2459442"}]}