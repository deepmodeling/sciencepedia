{"hands_on_practices": [{"introduction": "To truly understand the Intrinsic Reaction Coordinate (IRC), we begin with its fundamental mathematical definition. This exercise challenges you to derive the IRC path analytically for a classic one-dimensional double-well potential, starting from first principles [@problem_id:2899955]. By directly integrating the defining differential equation, you will build a solid theoretical foundation and see how the abstract concept of mass-weighted arc length, $s$, relates to the familiar Cartesian coordinate of the reaction.", "problem": "Consider a one-dimensional model potential energy surface defined by the function $V(x) = (x^{2}-1)^{2}/4$, with atomic mass parameter $m=1$. The stationary point at $x=0$ is the transition state, and the minima are at $x=\\pm 1$. In the formalism of the intrinsic reaction coordinate (IRC), the path is defined as the steepest-descent curve on the potential energy surface when written in mass-weighted coordinates. Let $q=\\sqrt{m}\\,x$ denote the mass-weighted coordinate and let $s$ denote the arc-length parameter defined by the line element $\\mathrm{d}s^{2}=\\mathrm{d}q^{2}$, so that the tangent vector satisfies $|\\mathrm{d}q/\\mathrm{d}s|=1$, and the path direction is everywhere aligned with the negative gradient of $V$ in the $q$-coordinates.\n\nStarting only from these definitions and the given $V(x)$, derive the differential equation governing the IRC in one dimension and integrate it with the initial condition $x(0)=0$ to obtain the explicit expressions $x(s)$ for the two branches connecting the transition state to the two minima at $x=\\pm 1$. Then, expressing the path length $s$ as a function of the Cartesian coordinate $x$, show that it coincides with the absolute value of $x$ up to a constant factor for $m=1$, and determine that constant.\n\nGive your final answer in the form of a single closed-form expression for $s(x)$, valid on both branches. No units are required. Do not round.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The provided problem statement describes a standard exercise in theoretical chemistry concerning the Intrinsic Reaction Coordinate (IRC). It provides a one-dimensional potential energy surface $V(x) = (x^{2}-1)^{2}/4$, an atomic mass parameter $m=1$, and clear definitions for mass-weighted coordinates $q=\\sqrt{m}\\,x$ and the path arc length $s$. The definition of the IRC as the steepest-descent path in mass-weighted coordinates is standard. All provided information is self-contained and consistent. No scientific or logical flaws are identified. The problem is therefore deemed **valid** and a solution will be derived.\n\nThe Intrinsic Reaction Coordinate (IRC) is defined as the path of steepest descent on the potential energy surface, traced in mass-weighted coordinates. The tangent vector to this path, $\\mathrm{d}\\mathbf{q}/\\mathrm{d}s$, where $\\mathbf{q}$ is the vector of mass-weighted coordinates and $s$ is the arc length, is aligned with the negative of the potential energy gradient, $-\\nabla_q V$. The arc length $s$ is defined such that the tangent vector is a unit vector, $|\\mathrm{d}\\mathbf{q}/\\mathrm{d}s|=1$. This leads to the fundamental equation for the IRC:\n$$\n\\frac{\\mathrm{d}\\mathbf{q}}{\\mathrm{d}s} = -\\frac{\\nabla_q V}{|\\nabla_q V|}\n$$\nFor a one-dimensional system, the vectors become scalars, and the gradient $\\nabla_q$ becomes the derivative $\\mathrm{d}/\\mathrm{d}q$. The equation simplifies to:\n$$\n\\frac{\\mathrm{d}q}{\\mathrm{d}s} = -\\frac{\\mathrm{d}V/\\mathrm{d}q}{|\\mathrm{d}V/\\mathrm{d}q|} = -\\mathrm{sgn}\\left(\\frac{\\mathrm{d}V}{\\mathrm{d}q}\\right)\n$$\nwhere $\\mathrm{sgn}(\\cdot)$ is the sign function.\n\nThe mass-weighted coordinate $q$ is related to the Cartesian coordinate $x$ by $q = \\sqrt{m}x$. The potential $V$ must be expressed as a function of $q$. Substituting $x=q/\\sqrt{m}$ into the expression for $V(x)$:\n$$\nV(q) = \\frac{1}{4} \\left( \\left(\\frac{q}{\\sqrt{m}}\\right)^{2} - 1 \\right)^{2} = \\frac{1}{4} \\left( \\frac{q^{2}}{m} - 1 \\right)^{2}\n$$\nNext, we compute the derivative of $V$ with respect to $q$:\n$$\n\\frac{\\mathrm{d}V}{\\mathrm{d}q} = \\frac{1}{4} \\cdot 2 \\left( \\frac{q^{2}}{m} - 1 \\right) \\cdot \\frac{2q}{m} = \\frac{q}{m} \\left( \\frac{q^{2}}{m} - 1 \\right) = \\frac{q(q^{2}-m)}{m^{2}}\n$$\nThe sign of $\\mathrm{d}V/\\mathrm{d}q$ is determined by the term $q(q^{2}-m)$, since $m^{2}$ is always positive. In terms of the Cartesian coordinate $x$, this term is $\\sqrt{m}x(m x^{2} - m) = m^{3/2}x(x^{2}-1)$. As $m>0$, the sign of $\\mathrm{d}V/\\mathrm{d}q$ is identical to the sign of $x(x^{2}-1)$.\nThe differential equation for the IRC in this specific problem is therefore:\n$$\n\\frac{\\mathrm{d}q}{\\mathrm{d}s} = -\\mathrm{sgn}(x(x^{2}-1))\n$$\nSubstituting $q=\\sqrt{m}x$ into the left-hand side gives $\\mathrm{d}(\\sqrt{m}x)/\\mathrm{d}s = \\sqrt{m}(\\mathrm{d}x/\\mathrm{d}s)$. The equation becomes:\n$$\n\\sqrt{m}\\frac{\\mathrm{d}x}{\\mathrm{d}s} = -\\mathrm{sgn}(x(x^{2}-1))\n$$\nWe must now solve this equation for the two branches starting from the transition state at $x=0$, where by convention we set the arc length $s=0$.\n\nBranch 1: Path from the transition state ($x=0$) to the minimum at $x=1$. Along this path, the coordinate $x$ is in the interval $0 < x < 1$. In this interval, $x>0$ and $x^{2}-1<0$, so the product $x(x^{2}-1)$ is negative.\n$$\n\\mathrm{sgn}(x(x^{2}-1)) = -1\n$$\nThe differential equation for this branch is:\n$$\n\\sqrt{m}\\frac{\\mathrm{d}x}{\\mathrm{d}s} = -(-1) = 1\n$$\nThis is a separable differential equation: $\\sqrt{m}\\,\\mathrm{d}x = \\mathrm{d}s$. We integrate from the initial condition $(x,s) = (0,0)$ to a point $(x,s)$ on the path:\n$$\n\\int_{0}^{x} \\sqrt{m} \\, \\mathrm{d}x' = \\int_{0}^{s} \\mathrm{d}s' \\implies \\sqrt{m}x = s\n$$\nThe explicit expression for the path is $x(s) = s/\\sqrt{m}$, and the path length as a function of coordinate is $s(x) = \\sqrt{m}x$.\n\nBranch 2: Path from the transition state ($x=0$) to the minimum at $x=-1$. Along this path, the coordinate $x$ is in the interval $-1 < x < 0$. In this interval, $x<0$ and $x^{2}-1<0$, so the product $x(x^{2}-1)$ is positive.\n$$\n\\mathrm{sgn}(x(x^{2}-1)) = +1\n$$\nThe differential equation for this branch is:\n$$\n\\sqrt{m}\\frac{\\mathrm{d}x}{\\mathrm{d}s} = -(+1) = -1\n$$\nSeparating variables gives $\\sqrt{m}\\,\\mathrm{d}x = -\\mathrm{d}s$. Integrating from the initial condition $(x,s) = (0,0)$:\n$$\n\\int_{0}^{x} \\sqrt{m} \\, \\mathrm{d}x' = \\int_{0}^{s} (-1) \\, \\mathrm{d}s' \\implies \\sqrt{m}x = -s\n$$\nThe explicit expression for the path is $x(s) = -s/\\sqrt{m}$, and the path length as a function of coordinate is $s(x) = -\\sqrt{m}x$.\n\nCombining the results for the two branches, we can express the path length $s$ as a single function of the coordinate $x$:\nFor $x \\ge 0$, $s(x) = \\sqrt{m}x$.\nFor $x < 0$, $s(x) = -\\sqrt{m}x$.\nThis is equivalent to the compact expression:\n$$\ns(x) = \\sqrt{m}|x|\n$$\nThis result shows that the path length $s$ coincides with the absolute value of the Cartesian coordinate, $|x|$, up to a constant factor of $\\sqrt{m}$.\n\nThe problem explicitly states that the mass parameter is $m=1$. Substituting this value into our derived expression for $s(x)$:\n$$\ns(x) = \\sqrt{1} |x| = |x|\n$$\nThus, for the specified mass $m=1$, the constant factor is $1$. The final answer is the closed-form expression for $s(x)$ valid on both branches for $m=1$.", "answer": "$$\n\\boxed{|x|}\n$$", "id": "2899955"}, {"introduction": "An IRC path is not just any low-energy trajectory; it is the unique steepest-descent path that defines the reaction mechanism. This practice explores the special nature of the IRC by investigating what happens when you start a path-following calculation just slightly 'off-course' from the true transition vector at the saddle point [@problem_id:2456634]. By numerically integrating the trajectories, you will discover the concept of a potential energy 'watershed' that separates the reactant and product basins, highlighting the critical importance of the transition state's structure.", "problem": "Consider a two-dimensional model potential energy surface defined on coordinates $x$ and $y$ with potential energy\n$$\nV(x,y) \\;=\\; \\tfrac{1}{4}x^{4} \\;-\\; \\tfrac{1}{2}x^{2} \\;+\\; \\tfrac{1}{2}y^{2} \\;+\\; d\\,x^{2}y^{2},\n$$\nwhere $d$ is a fixed positive parameter. The point $(x,y)=(0,0)$ is a first-order saddle point (transition state), and the two symmetry-related minima are located along the $x$-axis at nonzero $x$. Assume unit masses for all coordinates. The Intrinsic Reaction Coordinate (IRC) is defined as the curve $\\mathbf{R}(s)=(x(s),y(s))$ in mass-weighted coordinates that follows the steepest descent of the potential energy starting from the transition state in the direction of the negative-curvature eigenvector of the Hessian. In unit masses, the steepest-descent flow obeys the ordinary differential equation\n$$\n\\frac{d\\mathbf{R}}{ds} \\;=\\; -\\,\\nabla V\\big(\\mathbf{R}(s)\\big),\n$$\nwith $s$ a scalar path parameter. The gradient flow property implies\n$$\n\\frac{d}{ds}V\\big(\\mathbf{R}(s)\\big)\\;=\\; \\nabla V\\cdot\\frac{d\\mathbf{R}}{ds} \\;=\\; -\\,\\|\\nabla V\\|^{2}\\,\\le\\,0.\n$$\nThe Hessian matrix at the transition state is the matrix of second derivatives of $V(x,y)$ evaluated at $(0,0)$. The true transition vector is the eigenvector associated with the single negative eigenvalue of this Hessian. In this model, this true transition vector points along the $x$-axis (either $+x$ or $-x$).\n\nYour task is to write a complete program that integrates the steepest-descent equation from a small displacement off the transition state along an initial unit vector that is rotated by a given angle away from the true transition vector, and then determines the destination of the trajectory. Use the following precise specifications.\n\n1) Potential and its derivatives: Use $d=0.5$. The potential is\n$$\nV(x,y) \\;=\\; \\tfrac{1}{4}x^{4} \\;-\\; \\tfrac{1}{2}x^{2} \\;+\\; \\tfrac{1}{2}y^{2} \\;+\\; 0.5\\,x^{2}y^{2}.\n$$\nIts gradient components are\n$$\n\\frac{\\partial V}{\\partial x} \\;=\\; x^{3} - x + x\\,y^{2},\\qquad\n\\frac{\\partial V}{\\partial y} \\;=\\; y + x^{2}y,\n$$\nand its Hessian components are\n$$\n\\frac{\\partial^{2} V}{\\partial x^{2}} \\;=\\; 3x^{2} - 1 + y^{2},\\quad\n\\frac{\\partial^{2} V}{\\partial y^{2}} \\;=\\; 1 + x^{2},\\quad\n\\frac{\\partial^{2} V}{\\partial x\\,\\partial y} \\;=\\; 2xy.\n$$\n2) Initial condition construction: Let the transition state be at $(x,y)=(0,0)$ and let the true transition vector be along $+x$. For a given angle $\\theta$ (in degrees), define the unit direction $\\mathbf{u}(\\theta) = (\\cos\\theta,\\,\\sin\\theta)$, where the angle is interpreted with respect to $+x$ in the usual counterclockwise sense. Start the trajectory at\n$$\n\\mathbf{R}(0) \\;=\\; \\delta\\,\\mathbf{u}(\\theta),\n$$\nwith a fixed small displacement magnitude $\\delta = 10^{-3}$.\n\n3) IRC following as gradient flow: Integrate\n$$\n\\frac{d\\mathbf{R}}{ds} \\;=\\; -\\,\\nabla V(\\mathbf{R}),\n$$\nfrom $s=0$ until convergence, defined by $\\|\\nabla V(\\mathbf{R})\\|\\le \\varepsilon_{\\text{grad}}$ with $\\varepsilon_{\\text{grad}} = 10^{-8}$, or until a maximum path parameter $s_{\\max}$ is exceeded, where $s_{\\max}=200$.\n\n4) Destination classification: Upon convergence by the gradient-norm criterion, classify the endpoint $(x_{\\text{end}},y_{\\text{end}})$ by computing the Hessian eigenvalues at the endpoint. If all Hessian eigenvalues are strictly positive (within a numerical tolerance), classify the endpoint as a minimum; return the integer label $2$ if $x_{\\text{end}}>0$ and $1$ if $x_{\\text{end}}<0$. If at least one Hessian eigenvalue is negative (within a numerical tolerance) and the gradient norm is small, classify it as a first-order saddle near the transition state and return the integer label $0$. If the integration does not meet the gradient-norm convergence within $s_{\\max}$, you must still return an integer; in that case return $0$ if the endpoint Hessian has a negative eigenvalue, otherwise return $1$ if $x_{\\text{end}}<0$ or $2$ if $x_{\\text{end}}>0$. All numerical comparisons should use reasonable tolerances consistent with the scales given above.\n\n5) Angle unit: All angles $\\theta$ provided below are in degrees. No physical units are involved in this problem.\n\n6) Test suite: Run the program for the following five test angles with the fixed displacement magnitude $\\delta = 10^{-3}$ and with the parameters specified above:\n- $\\theta = 0$,\n- $\\theta = 180$,\n- $\\theta = 90$,\n- $\\theta = 80$,\n- $\\theta = 100$.\n\n7) Required final output format: Your program should produce a single line of output containing the results as a comma-separated list of integers enclosed in square brackets, in the same order as the test angles above. For example, an acceptable format is\n$$\n[\\ell_{1},\\ell_{2},\\ell_{3},\\ell_{4},\\ell_{5}],\n$$\nwhere each $\\ell_{k}$ is one of the integers $0$, $1$, or $2$ defined by the destination classification rule.\n\nYour implementation must numerically integrate the specified steepest-descent equation and apply the stated classification logic. The goal is to algorithmically answer: if the initial direction is rotated by $90$ degrees away from the true transition vector at the transition state, where does the trajectory go, and how does that compare with other rotations?", "solution": "The problem requires the numerical determination of the destination of steepest-descent paths on a two-dimensional potential energy surface, starting from the vicinity of a transition state. This is a classic problem in computational chemistry related to the concept of the Intrinsic Reaction Coordinate (IRC). The IRC formally connects a transition state to its adjacent minima.\n\nThe potential energy surface (PES) is given by the function:\n$$ V(x,y) = \\tfrac{1}{4}x^{4} - \\tfrac{1}{2}x^{2} + \\tfrac{1}{2}y^{2} + d\\,x^{2}y^{2} $$\nwith the parameter $d = 0.5$. The stationary points of this PES, where the gradient $\\nabla V = (\\partial V / \\partial x, \\partial V / \\partial y)$ is zero, are found to be at $(0,0)$, $(1,0)$, and $(-1,0)$. Analysis of the Hessian matrix of second derivatives,\n$$ \\mathbf{H} = \\begin{pmatrix} \\partial^2 V / \\partial x^2 & \\partial^2 V / \\partial x \\partial y \\\\ \\partial^2 V / \\partial y \\partial x & \\partial^2 V / \\partial y^2 \\end{pmatrix}, $$\nreveals their character. The point $(0,0)$ is a first-order saddle point (a transition state), with one negative and one positive eigenvalue. The points $(1,0)$ and $(-1,0)$ are minima, where both Hessian eigenvalues are positive. These represent the stable reactant and product states connected by the reaction path.\n\nThe IRC path is approximated by the steepest-descent trajectory $\\mathbf{R}(s) = (x(s), y(s))$ which follows the negative of the potential energy gradient. This is described by the system of ordinary differential equations (ODEs):\n$$ \\frac{d\\mathbf{R}}{ds} = -\\nabla V(\\mathbf{R}(s)) $$\nwhere $s$ is the path parameter. We are given the analytical expressions for the gradient components:\n$$ \\nabla V(x,y) = \\begin{pmatrix} x^{3} - x + x y^{2} \\\\ y + x^{2}y \\end{pmatrix} $$\n\nThe integration starts not at the transition state itself, which is a point of unstable equilibrium, but at a small displacement $\\delta = 10^{-3}$ away from it. The initial direction is specified by a unit vector $\\mathbf{u}(\\theta) = (\\cos\\theta, \\sin\\theta)$, where $\\theta$ is an angle in degrees relative to the $+x$ axis, which corresponds to the direction of the unstable mode (the transition vector) of the saddle point. Thus, the initial condition is:\n$$ \\mathbf{R}(0) = \\delta\\,\\mathbf{u}(\\theta) $$\n\nThe numerical solution is obtained by integrating this system of ODEs using a robust algorithm, such as the one implemented in `scipy.integrate.solve_ivp`. The integration proceeds until one of two conditions is met:\n$1.$ The path converges to a stationary point, which is detected when the norm of the gradient falls below a threshold: $\\|\\nabla V\\| \\le \\varepsilon_{\\text{grad}} = 10^{-8}$.\n$2.$ The path parameter $s$ reaches a maximum allowed value, $s_{\\max} = 200$.\n\nUpon termination, the destination of the trajectory must be classified. This is achieved by analyzing the properties of the final point $\\mathbf{R}_{\\text{end}} = (x_{\\text{end}}, y_{\\text{end}})$. The eigenvalues of the Hessian matrix $\\mathbf{H}(\\mathbf{R}_{\\text{end}})$ are computed.\n- If any eigenvalue is negative (within a numerical tolerance, taken as $-10^{-8}$), the endpoint is classified as being in a saddle point region, yielding the label $0$. This result is expected for trajectories that return to the vicinity of the transition state, exemplified by the path starting exactly along the stable $y$-direction ($\\theta = 90^\\circ$).\n- If all eigenvalues are non-negative, the endpoint is in a potential well corresponding to a minimum. The destination is then distinguished by the sign of the $x$-coordinate:\n  - Label $1$ is assigned if $x_{\\text{end}} < 0$, corresponding to the minimum at $(-1,0)$.\n  - Label $2$ is assigned if $x_{\\text{end}} > 0$, corresponding to the minimum at $(1,0)$.\n\nThis classification logic is applied regardless of whether convergence was achieved by the gradient norm criterion or by reaching the maximum path length. The behavior of the system is expected to show a bifurcation; for initial angles $\\theta$ in a range around $0^\\circ$, the trajectory will lead to the minimum at $(1,0)$, while for angles around $180^\\circ$, it will lead to the minimum at $(-1,0)$. The critical angle $\\theta = 90^\\circ$ lies on the dividing surface (the \"watershed\") between the two basins of attraction, and a trajectory starting there is expected to fall back to the transition state. The test cases with $\\theta=80^\\circ$ and $\\theta=100^\\circ$ are designed to probe this bifurcation behavior.\n\nThe program implements this entire procedure. It defines functions for the potential's gradient and Hessian, sets up the initial conditions for each test angle, performs the numerical integration with an event handler to detect convergence, and applies the specified classification rules to the final point of each trajectory.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# --- Problem-specific constants ---\nD_PARAM = 0.5  # Parameter d in the potential\nDELTA = 1e-3  # Initial displacement magnitude\nEPS_GRAD = 1e-8  # Gradient norm for convergence\nS_MAX = 200.0  # Maximum integration path parameter\nNEG_EIG_TOL = -1e-8 # Tolerance for checking for negative Hessian eigenvalues\n\ndef get_gradient(R):\n    \"\"\"\n    Computes the gradient of the potential V(x,y).\n    R is a 2-element array [x, y].\n    \"\"\"\n    x, y = R\n    x2 = x * x\n    y2 = y * y\n    grad_x = x**3 - x + x * y2\n    grad_y = y + x2 * y\n    return np.array([grad_x, grad_y])\n\ndef get_hessian(R):\n    \"\"\"\n    Computes the Hessian matrix of the potential V(x,y).\n    R is a 2-element array [x, y].\n    \"\"\"\n    x, y = R\n    x2 = x * x\n    y2 = y * y\n    \n    # Hessian components from the problem statement:\n    # d2V/dx2 = 3x^2 - 1 + y^2\n    # d2V/dy2 = 1 + x^2\n    # d2V/dxdy = 2xy\n    h_xx = 3.0 * x2 - 1.0 + y2\n    h_yy = 1.0 + x2\n    h_xy = 2.0 * x * y\n    \n    return np.array([[h_xx, h_xy], [h_xy, h_yy]])\n\n\ndef classify_trajectory_destination(theta_deg):\n    \"\"\"\n    Integrates a trajectory for a given initial angle and classifies the endpoint.\n    \"\"\"\n    # 1. Set up the initial condition\n    theta_rad = np.deg2rad(theta_deg)\n    R0 = np.array([DELTA * np.cos(theta_rad), DELTA * np.sin(theta_rad)])\n\n    # 2. Define the ODE system for the integrator (dR/ds = -grad(V))\n    def ode_func(s, R):\n        # The potential V is defined implicitly by its gradient.\n        # dV/dx = x^3 - x + (2*d)*x*y^2, dV/dy = y + (2*d)*x^2*y with V = .. + d*x^2*y^2\n        # For d=0.5, dV/dx=x^3-x+x*y^2 and dV/dy=y+x^2*y per problem statement.\n        grad = get_gradient(R)\n        return -grad\n\n    # 3. Define the convergence event\n    def convergence_event(s, R):\n        grad_norm = np.linalg.norm(get_gradient(R))\n        return grad_norm - EPS_GRAD\n    convergence_event.terminal = True\n    convergence_event.direction = -1 # Event triggers when value goes from positive to negative\n\n    # 4. Perform the numerical integration\n    sol = solve_ivp(\n        ode_func,\n        t_span=(0, S_MAX),\n        y0=R0,\n        method='DOP853',\n        events=convergence_event,\n        dense_output=True,\n        atol=1e-10,\n        rtol=1e-10\n    )\n\n    # 5. Determine the final point of the trajectory\n    # If the integration was terminated by the event, use the state at the event time.\n    if sol.status == 1 and sol.y_events[0].size > 0:\n        R_end = sol.y_events[0][0, :]\n    else: # Otherwise, use the last point of the integration.\n        R_end = sol.y[:, -1]\n\n    # 6. Classify the destination\n    x_end = R_end[0]\n    hessian_end = get_hessian(R_end)\n    eigenvalues = np.linalg.eigvalsh(hessian_end)\n\n    # If any eigenvalue is negative, it's a saddle-like point (label 0).\n    if np.any(eigenvalues < NEG_EIG_TOL):\n        return 0\n    else: # Otherwise, it's a minimum. Classify by the sign of x.\n        if x_end > 0:\n            return 2\n        else: # (x_end <= 0)\n            return 1\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0,   # theta = 0 degrees\n        180, # theta = 180 degrees\n        90,  # theta = 90 degrees\n        80,  # theta = 80 degrees\n        100, # theta = 100 degrees\n    ]\n\n    results = []\n    for theta in test_cases:\n        label = classify_trajectory_destination(theta)\n        results.append(label)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2456634"}, {"introduction": "While simple steepest-descent illustrates the IRC concept, modern computational chemistry relies on more robust and efficient algorithms to trace reaction paths. This exercise provides a hands-on look at one such method, the popular Gonzalez-Schlegel algorithm, by having you perform a single predictor-corrector step manually [@problem_id:2899996]. This deep dive into the underlying mechanics of constrained optimization on the potential energy surface will demystify how these advanced tools operate with precision and efficiency.", "problem": "In mass-weighted internal coordinates $\\mathbf{Q}=(Q_{x},Q_{y})$, consider the two-dimensional potential energy surface $V(\\mathbf{Q})=\\frac{(Q_{x}^{2}-1)^{2}}{4}+\\frac{Q_{y}^{2}}{2}$. The intrinsic reaction coordinate is defined as the steepest-descent path in mass-weighted space, and a single Gonzalez–Schlegel step may be realized as a constrained minimization of $V(\\mathbf{Q})$ on a hypersphere centered at a predictor point obtained from a trial tangent. Starting from $\\mathbf{Q}^{(0)}=(0,0)$, a trial unit tangent $\\hat{\\mathbf{t}}=(1,0)^{T}$, and a step size $h=0.1$, construct the predictor center $\\mathbf{C}=\\mathbf{Q}^{(0)}+h\\,\\hat{\\mathbf{t}}$ and perform the correction by minimizing $V(\\mathbf{Q})$ subject to the constraint $\\|\\mathbf{Q}-\\mathbf{C}\\|=h$. Parameterize the constraint as $\\mathbf{Q}(\\theta)=\\mathbf{C}+h(\\cos\\theta,\\sin\\theta)$, determine the stationary point(s) on the circle, select the corrected point $\\mathbf{Q}^{(1)}$ that minimizes $V$ on the circle, and verify the stationarity orthogonality condition by explicitly evaluating $\\nabla V(\\mathbf{Q}^{(1)})\\cdot\\dot{\\mathbf{Q}}(\\theta^{\\ast})$, where $\\dot{\\mathbf{Q}}(\\theta)=\\frac{d\\mathbf{Q}}{d\\theta}$ and $\\theta^{\\ast}$ is the angle corresponding to $\\mathbf{Q}^{(1)}$. Report your final result as a row matrix containing three entries in the following order: $Q_{x}^{(1)}$, $Q_{y}^{(1)}$, and the scalar $\\nabla V(\\mathbf{Q}^{(1)})\\cdot\\dot{\\mathbf{Q}}(\\theta^{\\ast})$. No rounding is required and no units are needed for this problem.", "solution": "The problem is first validated for scientific and logical consistency.\n\nStep 1: Extract Givens\n- Coordinates: mass-weighted internal coordinates $\\mathbf{Q}=(Q_{x},Q_{y})$.\n- Potential Energy Surface: $V(\\mathbf{Q})=\\frac{(Q_{x}^{2}-1)^{2}}{4}+\\frac{Q_{y}^{2}}{2}$.\n- Initial point: $\\mathbf{Q}^{(0)}=(0,0)$.\n- Trial unit tangent: $\\hat{\\mathbf{t}}=(1,0)^{T}$.\n- Step size: $h=0.1$.\n- Predictor center definition: $\\mathbf{C}=\\mathbf{Q}^{(0)}+h\\,\\hat{\\mathbf{t}}$.\n- Constraint for corrector step: $\\|\\mathbf{Q}-\\mathbf{C}\\|=h$.\n- Parameterization of constraint: $\\mathbf{Q}(\\theta)=\\mathbf{C}+h(\\cos\\theta,\\sin\\theta)$.\n- Task 1: Determine stationary points of $V$ on the constraint circle.\n- Task 2: Select the corrected point $\\mathbf{Q}^{(1)}$ that minimizes $V$.\n- Task 3: Verify stationarity by evaluating $\\nabla V(\\mathbf{Q}^{(1)})\\cdot\\dot{\\mathbf{Q}}(\\theta^{\\ast})$, where $\\dot{\\mathbf{Q}}(\\theta)=\\frac{d\\mathbf{Q}}{d\\theta}$ and $\\theta^{\\ast}$ is the angle for $\\mathbf{Q}^{(1)}$.\n- Reporting format: a row matrix with $Q_{x}^{(1)}$, $Q_{y}^{(1)}$, and the scalar product.\n\nStep 2: Validate Using Extracted Givens\nThe problem describes a single step of the Gonzalez–Schlegel second-order algorithm for intrinsic reaction coordinate (IRC) following, a standard and well-established method in computational chemistry. The potential energy surface is a simple, well-behaved analytical function suitable for testing numerical algorithms. The initial conditions and parameters are clearly specified. The problem is scientifically grounded, well-posed, and objective. It contains no inconsistencies, ambiguities, or unsound premises.\n\nStep 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe potential energy surface is given by\n$$V(\\mathbf{Q}) = \\frac{(Q_{x}^{2}-1)^{2}}{4} + \\frac{Q_{y}^{2}}{2}$$\nThe gradient of the potential, $\\nabla V$, is required for the analysis.\n$$ \\nabla V(\\mathbf{Q}) = \\left( \\frac{\\partial V}{\\partial Q_x}, \\frac{\\partial V}{\\partial Q_y} \\right) = \\left( \\frac{1}{4} \\cdot 2(Q_x^2 - 1) \\cdot (2Q_x), \\frac{1}{2} \\cdot 2Q_y \\right) = \\left( Q_x(Q_x^2 - 1), Q_y \\right) $$\nThe starting point is $\\mathbf{Q}^{(0)} = (0, 0)$, the trial tangent is $\\hat{\\mathbf{t}} = (1, 0)^{T}$, and the step size is $h=0.1$. The predictor point, which serves as the center of the hypersphere for the corrector step, is\n$$ \\mathbf{C} = \\mathbf{Q}^{(0)} + h\\,\\hat{\\mathbf{t}} = (0, 0) + 0.1 (1, 0) = (0.1, 0) $$\nThe corrector step involves minimizing $V(\\mathbf{Q})$ subject to the constraint that the new point $\\mathbf{Q}$ lies on a circle of radius $h$ centered at $\\mathbf{C}$. The constraint is $\\|\\mathbf{Q} - \\mathbf{C}\\| = h$, or explicitly,\n$$ (Q_x - 0.1)^2 + Q_y^2 = (0.1)^2 = 0.01 $$\nWe use the given parameterization for points on this circle:\n$$ \\mathbf{Q}(\\theta) = \\mathbf{C} + h(\\cos\\theta, \\sin\\theta) = (0.1, 0) + 0.1(\\cos\\theta, \\sin\\theta) $$\nThis gives the coordinate components as functions of the angle $\\theta$:\n$$ Q_x(\\theta) = 0.1 + 0.1\\cos\\theta = 0.1(1 + \\cos\\theta) $$\n$$ Q_y(\\theta) = 0.1\\sin\\theta $$\nTo find the stationary points of $V$ on this circle, we can use the method of Lagrange multipliers or, equivalently, substitute the parameterized coordinates into $V$ and find the extrema of $V$ as a function of $\\theta$. A stationary point $\\mathbf{Q}^{*}$ on the circle must satisfy the condition that the gradient $\\nabla V(\\mathbf{Q}^{*})$ is orthogonal to the tangent vector of the circle at that point. The tangent vector to the circle is $\\dot{\\mathbf{Q}}(\\theta) = \\frac{d\\mathbf{Q}}{d\\theta}$.\n$$ \\dot{\\mathbf{Q}}(\\theta) = (-0.1\\sin\\theta, 0.1\\cos\\theta) $$\nThe condition for a stationary point is $\\frac{dV}{d\\theta} = \\nabla V(\\mathbf{Q}(\\theta)) \\cdot \\dot{\\mathbf{Q}}(\\theta) = 0$.\n$$ \\nabla V(\\mathbf{Q}(\\theta)) \\cdot \\dot{\\mathbf{Q}}(\\theta) = [Q_x(Q_x^2 - 1)](-0.1\\sin\\theta) + [Q_y](0.1\\cos\\theta) = 0 $$\nSubstitute the expressions for $Q_x(\\theta)$ and $Q_y(\\theta)$:\n$$ [0.1(1+\\cos\\theta)((0.1(1+\\cos\\theta))^2 - 1)](-0.1\\sin\\theta) + [0.1\\sin\\theta](0.1\\cos\\theta) = 0 $$\nWe can factor out $0.1\\sin\\theta$:\n$$ 0.1\\sin\\theta \\left( -[0.1(1+\\cos\\theta)((0.1(1+\\cos\\theta))^2 - 1)] + 0.1\\cos\\theta \\right) = 0 $$\nThis equation is satisfied if either $\\sin\\theta = 0$ or the term in the parentheses is zero.\n\nCase 1: $\\sin\\theta = 0$. This implies $\\theta = 0$ or $\\theta = \\pi$.\nIf $\\theta = 0$:\n$$ Q_x(0) = 0.1(1 + \\cos 0) = 0.1(1+1) = 0.2 $$\n$$ Q_y(0) = 0.1\\sin 0 = 0 $$\nThis gives the stationary point $\\mathbf{Q}_1 = (0.2, 0)$.\n\nIf $\\theta = \\pi$:\n$$ Q_x(\\pi) = 0.1(1 + \\cos \\pi) = 0.1(1-1) = 0 $$\n$$ Q_y(\\pi) = 0.1\\sin \\pi = 0 $$\nThis gives the stationary point $\\mathbf{Q}_2 = (0, 0)$, which is the initial point.\n\nCase 2: The term in parentheses is zero. This leads to a cubic equation for $\\cos\\theta$ and corresponds to other stationary points on the circle, which are maxima or saddle points of the potential along the circle, lying between the minima.\n\nTo find the corrected point $\\mathbf{Q}^{(1)}$, we must find the global minimum of $V$ on the circle. We evaluate $V$ at the stationary points $\\mathbf{Q}_1$ and $\\mathbf{Q}_2$.\nFor $\\mathbf{Q}_1 = (0.2, 0)$:\n$$ V(0.2, 0) = \\frac{((0.2)^2 - 1)^2}{4} + \\frac{0^2}{2} = \\frac{(0.04 - 1)^2}{4} = \\frac{(-0.96)^2}{4} = \\frac{0.9216}{4} = 0.2304 $$\nFor $\\mathbf{Q}_2 = (0, 0)$:\n$$ V(0, 0) = \\frac{(0^2 - 1)^2}{4} + \\frac{0^2}{2} = \\frac{1}{4} = 0.25 $$\nComparing the potential values, $V(\\mathbf{Q}_1) < V(\\mathbf{Q}_2)$. The other stationary points (from Case 2) must correspond to values of $V$ greater than or equal to $V(\\mathbf{Q}_2)$, as they would be maxima between the two minima found. Therefore, the point on the circle that minimizes the potential is $\\mathbf{Q}_1 = (0.2, 0)$. This is the corrected point $\\mathbf{Q}^{(1)}$.\n$$ \\mathbf{Q}^{(1)} = (0.2, 0) $$\nThe angle corresponding to this point is $\\theta^{\\ast}=0$.\n\nFinally, we must verify the stationarity orthogonality condition by evaluating $\\nabla V(\\mathbf{Q}^{(1)})\\cdot\\dot{\\mathbf{Q}}(\\theta^{\\ast})$. This is precisely the condition $\\frac{dV}{d\\theta}=0$ which we used to find the stationary points, so the result must be $0$. We perform the calculation explicitly as requested.\nFirst, compute the gradient at $\\mathbf{Q}^{(1)}=(0.2, 0)$:\n$$ \\nabla V(0.2, 0) = (0.2((0.2)^2 - 1), 0) = (0.2(0.04 - 1), 0) = (0.2(-0.96), 0) = (-0.192, 0) $$\nNext, compute the tangent vector at $\\theta^{\\ast}=0$:\n$$ \\dot{\\mathbf{Q}}(0) = (-0.1\\sin 0, 0.1\\cos 0) = (0, 0.1) $$\nThe scalar product is:\n$$ \\nabla V(\\mathbf{Q}^{(1)})\\cdot\\dot{\\mathbf{Q}}(\\theta^{\\ast}) = (-0.192, 0) \\cdot (0, 0.1) = (-0.192)(0) + (0)(0.1) = 0 $$\nThe condition is verified. The values to be reported are $Q_x^{(1)} = 0.2$, $Q_y^{(1)} = 0$, and the scalar product, which is $0$.\nThe result is presented as a row matrix: $(0.2, 0, 0)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "2899996"}]}