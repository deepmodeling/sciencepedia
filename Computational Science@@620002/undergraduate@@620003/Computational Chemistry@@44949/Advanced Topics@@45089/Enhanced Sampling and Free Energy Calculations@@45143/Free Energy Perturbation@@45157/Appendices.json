{"hands_on_practices": [{"introduction": "To build a solid understanding of Free Energy Perturbation (FEP), it is often best to start with a system where the physics is transparent. This first practice invites you to connect the formal FEP equation to fundamental principles of classical electromagnetism [@problem_id:2455869]. By calculating the free energy change for a simple charge perturbation in two different ways, you will see how the statistical mechanical machinery of FEP yields the exact result expected from a first-principles energy calculation, providing a crucial sanity check and building intuition for more complex systems.", "problem": "A single rigid, infinitesimally thin spherical shell of fixed radius $a$ is placed in vacuum (relative permittivity $1$) at absolute temperature $T$. The shell carries a total charge $q$, which is quasi-statically changed to $q + \\delta q$ while the shell remains isolated in vacuum and no other degrees of freedom are present. Assume classical electromagnetism and the canonical ensemble of statistical mechanics apply, and that the only energetic contribution is from the electromagnetic field generated by the shell.\n\nUsing only first principles, determine the exact Helmholtz free energy change $\\Delta G$ associated with changing the charge from $q$ to $q + \\delta q$. Then, within the canonical ensemble, evaluate the exact Free Energy Perturbation (FEP) expression for $\\Delta G$ for this system and simplify it fully. Express your final result as a single closed-form analytic expression in terms of $q$, $\\delta q$, $a$, and $\\varepsilon_{0}$. Express the energy in Joules (J). Do not evaluate numerically.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n-   System: A single rigid, infinitesimally thin spherical shell of fixed radius $a$.\n-   Initial state charge: $q$.\n-   Final state charge: $q + \\delta q$.\n-   Process: Quasi-static change in charge.\n-   Environment: Vacuum, relative permittivity $1$. Permittivity of free space is $\\varepsilon_{0}$.\n-   Thermodynamic conditions: Constant absolute temperature $T$, canonical ensemble.\n-   Constraint: The shell is isolated, and no other degrees of freedom are present.\n-   Energy model: The only energetic contribution is from the electromagnetic field.\n-   Objective: To find the Helmholtz free energy change, denoted as $\\Delta G$ in the problem, using two methods: (1) first principles and (2) the Free Energy Perturbation (FEP) formula. The final result should be in terms of $q$, $\\delta q$, $a$, and $\\varepsilon_{0}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and internally consistent. It combines principles from classical electromagnetism and statistical mechanics in a non-trivial but solvable manner. The constraint that \"no other degrees of freedom are present\" is a critical piece of information that simplifies the statistical mechanical treatment, making the problem tractable. This implies the system's energy is solely a function of its charge, and for a given charge, the system possesses only a single microstate. The problem's use of $\\Delta G$ to denote Helmholtz free energy change is unconventional; the standard symbol is $A$ or $F$. However, the problem explicitly states \"Helmholtz free energy change\", removing ambiguity. I will proceed using the standard notation $\\Delta A$.\n\n**Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\nThe objective is to compute the change in Helmholtz free energy, $\\Delta A$, when the charge on a spherical shell is changed from $q$ to $q + \\delta q$. This will be done via two independent derivations as requested.\n\n**Part 1: Helmholtz Free Energy from First Principles**\n\nThe Helmholtz free energy $A$ is related to the internal energy $U$ and entropy $S$ by the thermodynamic relation $A = U - TS$. In the context of statistical mechanics, for a system in the canonical ensemble, the entropy is given by the Boltzmann formula, $S = k_B \\ln(W)$, where $W$ is the number of microstates corresponding to the given macrostate.\n\nThe problem states that \"no other degrees of freedom are present\". This means that for a given total charge $Q$ on the shell, the system has exactly one microstate. Therefore, the number of microstates is $W=1$. The entropy of the system is $S = k_B \\ln(1) = 0$.\n\nConsequently, the Helmholtz free energy $A$ is exactly equal to the internal energy $U$ of the system.\n$$A = U - T(0) = U$$\nThe internal energy $U$ is specified to be solely the electrostatic potential energy stored in the electric field of the charged spherical shell. From classical electromagnetism, the electrostatic energy $U(Q)$ of a spherical shell of radius $a$ carrying a total charge $Q$ is given by:\n$$U(Q) = \\frac{Q^2}{8\\pi\\varepsilon_{0}a}$$\nThis energy is equivalent to the work done to quasi-statically assemble the charge $Q$ on the shell.\n\nThe initial state of the system has charge $q$. Its Helmholtz free energy is $A_{\\text{initial}}$.\n$$A_{\\text{initial}} = U(q) = \\frac{q^2}{8\\pi\\varepsilon_{0}a}$$\nThe final state has charge $q + \\delta q$. Its Helmholtz free energy is $A_{\\text{final}}$.\n$$A_{\\text{final}} = U(q + \\delta q) = \\frac{(q + \\delta q)^2}{8\\pi\\varepsilon_{0}a}$$\nThe change in Helmholtz free energy, $\\Delta A$, is the difference between the final and initial free energies.\n$$\\Delta A = A_{\\text{final}} - A_{\\text{initial}}$$\n$$\\Delta A = \\frac{(q + \\delta q)^2}{8\\pi\\varepsilon_{0}a} - \\frac{q^2}{8\\pi\\varepsilon_{0}a}$$\nFactoring out the common term, we get:\n$$\\Delta A = \\frac{1}{8\\pi\\varepsilon_{0}a} \\left[ (q + \\delta q)^2 - q^2 \\right]$$\nExpanding the squared term:\n$$\\Delta A = \\frac{1}{8\\pi\\varepsilon_{0}a} \\left[ (q^2 + 2q\\delta q + (\\delta q)^2) - q^2 \\right]$$\nSimplifying the expression inside the brackets gives the final result from this method:\n$$\\Delta A = \\frac{2q\\delta q + (\\delta q)^2}{8\\pi\\varepsilon_{0}a}$$\n\n**Part 2: Helmholtz Free Energy from the Free Energy Perturbation (FEP) Formula**\n\nThe Free Energy Perturbation (FEP) theorem provides a formal way to calculate the free energy difference between two states, a reference state (denoted by subscript $0$) and a target state (denoted by subscript $1$). The formula is:\n$$\\Delta A = A_1 - A_0 = -k_B T \\ln \\left\\langle \\exp\\left(-\\frac{U_1 - U_0}{k_B T}\\right) \\right\\rangle_0$$\nHere, $\\beta = \\frac{1}{k_B T}$ is the inverse temperature, $U_0$ and $U_1$ are the potential energies of the reference and target states, respectively, and the notation $\\langle \\cdot \\rangle_0$ indicates a canonical ensemble average taken over the microstates of the reference state $0$.\n\nLet us define our states:\n-   Reference state $0$: Charge on the shell is $q$. The system energy is $U_0 = U(q) = \\frac{q^2}{8\\pi\\varepsilon_{0}a}$.\n-   Target state $1$: Charge on the shell is $q + \\delta q$. The system energy is $U_1 = U(q + \\delta q) = \\frac{(q + \\delta q)^2}{8\\pi\\varepsilon_{0}a}$.\n\nThe energy difference is $\\Delta U = U_1 - U_0$.\n$$\\Delta U = \\frac{(q + \\delta q)^2 - q^2}{8\\pi\\varepsilon_{0}a} = \\frac{2q\\delta q + (\\delta q)^2}{8\\pi\\varepsilon_{0}a}$$\nThe ensemble average in the FEP formula is defined as:\n$$\\left\\langle \\exp(-\\beta \\Delta U) \\right\\rangle_0 = \\sum_{i} P_i \\exp(-\\beta \\Delta U_i)$$\nwhere the sum is over all microstates $i$ of the reference system $0$, and $P_i$ is the probability of being in microstate $i$.\n\nAs established in Part 1, the crucial simplification for this problem is that the reference system (with charge $q$) has only one possible microstate. Let this single state be indexed by $i=1$. Its probability is therefore $P_1 = 1$. The energy difference $\\Delta U$ does not depend on any internal coordinates (as there are none), so it is a constant value for the entire \"ensemble\".\n\nThe ensemble average thus collapses to a single term:\n$$\\left\\langle \\exp(-\\beta \\Delta U) \\right\\rangle_0 = (1) \\cdot \\exp(-\\beta \\Delta U) = \\exp(-\\beta \\Delta U)$$\nNow we substitute this simplified average back into the FEP formula:\n$$\\Delta A = -k_B T \\ln \\left[ \\exp(-\\beta \\Delta U) \\right]$$\nUsing the property that $\\ln(\\exp(x)) = x$:\n$$\\Delta A = -k_B T (-\\beta \\Delta U) = k_B T \\beta \\Delta U$$\nSubstituting $\\beta = \\frac{1}{k_B T}$:\n$$\\Delta A = k_B T \\left(\\frac{1}{k_B T}\\right) \\Delta U = \\Delta U$$\nThis demonstrates that for a system with only one microstate (and thus zero entropy), the FEP formula correctly reduces to the statement that the Helmholtz free energy change is equal to the change in the system's potential energy.\n\n$$\\Delta A = U_1 - U_0 = \\frac{2q\\delta q + (\\delta q)^2}{8\\pi\\varepsilon_{0}a}$$\nThis result is identical to the one obtained from first principles, confirming the consistency of the physical model. The final expression for the Helmholtz free energy change is:\n$$\\Delta A = \\frac{2q\\delta q + (\\delta q)^2}{8\\pi\\varepsilon_{0}a}$$\nThe units of this expression are Joules (J) in the SI system, as is required for energy. This is dimensionally consistent, since $\\frac{\\text{charge}^2}{\\text{permittivity} \\times \\text{length}}$ has units of energy.", "answer": "$$\\boxed{\\frac{2q\\delta q + (\\delta q)^2}{8\\pi \\varepsilon_{0} a}}$$", "id": "2455869"}, {"introduction": "Having established the foundational principles, we now apply FEP to one of its most powerful applications: calculating the relative binding affinity of two different molecules to a host [@problem_id:2455844]. This exercise utilizes a thermodynamic cycle, a cornerstone of physical chemistry, to relate the alchemical transformation of one ligand into another to their binding energies. By working through this analytically tractable model, you will gain hands-on experience in setting up and solving a problem that mirrors the complex calculations used in modern drug discovery.", "problem": "You are asked to compute the relative binding free energy for two ligands, benzene (ligand A) and phenol (ligand B), to a model host cavity, using a classical, analytically tractable model suitable for Free Energy Perturbation (FEP). The relative binding free energy (RBFE) is defined as the difference in binding free energies between the two ligands, which can be obtained from a thermodynamic cycle using alchemical transformation. Consider the canonical ensemble at absolute temperature $T$, with Boltzmann constant $k_{\\mathrm{B}}$. The alchemical free energy change transforming ligand A to ligand B in a fixed environment (either bound or unbound) is given by the canonical definition\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = -k_{\\mathrm{B}} T \\ln\\left(\\frac{Z_{B}^{(\\mathrm{env})}}{Z_{A}^{(\\mathrm{env})}}\\right),\n$$\nwhere $Z_{X}^{(\\mathrm{env})}$ is the canonical partition function for ligand $X \\in \\{\\mathrm{A}, \\mathrm{B}\\}$ in the specified environment. The relative binding free energy is then\n$$\n\\Delta \\Delta G_{\\mathrm{binding}} = \\Delta G_{A \\to B}^{(\\mathrm{bound})} - \\Delta G_{A \\to B}^{(\\mathrm{unbound})}.\n$$\nIn this model, the environment-ligand potential energy for each state is an isotropic $D$-dimensional harmonic potential with a constant energy offset:\n$$\nU_{X}^{(\\mathrm{env})}(\\mathbf{x}) = c_{X}^{(\\mathrm{env})} + \\frac{1}{2} k_{X}^{(\\mathrm{env})} \\lVert \\mathbf{x} \\rVert^{2},\n$$\nwhere $k_{X}^{(\\mathrm{env})} > 0$ is the stiffness in units of kilojoules per mole per square nanometer, $c_{X}^{(\\mathrm{env})}$ is a constant offset in kilojoules per mole, and $\\mathbf{x} \\in \\mathbb{R}^{D}$. The canonical partition function is, by definition,\n$$\nZ_{X}^{(\\mathrm{env})} = \\int_{\\mathbb{R}^{D}} \\exp\\left[-\\beta \\, U_{X}^{(\\mathrm{env})}(\\mathbf{x})\\right] \\, d^{D}\\mathbf{x},\n$$\nwith inverse temperature $\\beta = 1/(k_{\\mathrm{B}} T)$. Use the above definitions to obtain an explicit expression for $\\Delta \\Delta G_{\\mathrm{binding}}$ in terms of $T$, $D$, $k_{\\mathrm{B}}$, and the parameters $\\{k_{X}^{(\\mathrm{env})}, c_{X}^{(\\mathrm{env})}\\}$, and evaluate it numerically for the test suite below.\n\nConstants and units:\n- Use $k_{\\mathrm{B}} = 0.008314462618$ kilojoules per mole per Kelvin.\n- All stiffness parameters $k$ are given in kilojoules per mole per square nanometer.\n- All offsets $c$ are given in kilojoules per mole.\n- All temperatures $T$ are in Kelvin.\n- Report the final answers in kilojoules per mole as decimal floats.\n\nTest suite (each case is $(T, D, k_{\\mathrm{b},A}, c_{\\mathrm{b},A}, k_{\\mathrm{b},B}, c_{\\mathrm{b},B}, k_{\\mathrm{u},A}, c_{\\mathrm{u},A}, k_{\\mathrm{u},B}, c_{\\mathrm{u},B})$ where $\\mathrm{b}$ denotes bound and $\\mathrm{u}$ denotes unbound):\n1. Case 1 (happy path): $(298.15, 3, 200, -20, 250, -25, 50, 0, 60, -2)$\n2. Case 2 (equality check): $(298.15, 1, 100, -10, 100, -10, 100, 0, 100, 0)$\n3. Case 3 (stiffness-dominated edge): $(310, 2, 1000, -20, 100, -20, 10, 0, 1000, 0)$\n4. Case 4 (temperature variation): $(350, 3, 150, -18, 180, -21, 60, 0, 65, -1.5)$\n\nProgram requirements:\n- For each case, compute $\\Delta \\Delta G_{\\mathrm{binding}}$ as a single float in kilojoules per mole.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each number formatted to six digits after the decimal point (for example, $[-1.234567,2.345678,0.000000, \\dots]$).", "solution": "The problem is well-defined and grounded in the fundamental principles of statistical mechanics. It presents a simplified, analytically solvable model for a Free Energy Perturbation calculation, which is a standard technique in computational chemistry. Therefore, the problem is valid, and we proceed to derive the solution.\n\nThe objective is to compute the relative binding free energy, $\\Delta \\Delta G_{\\mathrm{binding}}$, defined by the thermodynamic cycle:\n$$\n\\Delta \\Delta G_{\\mathrm{binding}} = \\Delta G_{A \\to B}^{(\\mathrm{bound})} - \\Delta G_{A \\to B}^{(\\mathrm{unbound})}\n$$\nEach alchemical free energy change, $\\Delta G_{A \\to B}^{(\\mathrm{env})}$, is given by the expression:\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = -k_{\\mathrm{B}} T \\ln\\left(\\frac{Z_{B}^{(\\mathrm{env})}}{Z_{A}^{(\\mathrm{env})}}\\right)\n$$\nwhere $Z_{X}^{(\\mathrm{env})}$ is the canonical partition function for ligand $X$ in a given environment (bound or unbound). The first step is to derive an analytical expression for $Z_{X}^{(\\mathrm{env})}$.\n\nThe potential energy is given as:\n$$\nU_{X}^{(\\mathrm{env})}(\\mathbf{x}) = c_{X}^{(\\mathrm{env})} + \\frac{1}{2} k_{X}^{(\\mathrm{env})} \\lVert \\mathbf{x} \\rVert^{2}\n$$\nThe partition function is the integral of the Boltzmann factor over all configurations in $\\mathbb{R}^{D}$:\n$$\nZ_{X}^{(\\mathrm{env})} = \\int_{\\mathbb{R}^{D}} \\exp\\left[-\\beta \\, U_{X}^{(\\mathrm{env})}(\\mathbf{x})\\right] \\, d^{D}\\mathbf{x}\n$$\nwhere $\\beta = 1/(k_{\\mathrm{B}} T)$. Substituting the potential energy expression:\n$$\nZ_{X}^{(\\mathrm{env})} = \\int_{\\mathbb{R}^{D}} \\exp\\left[-\\beta \\left( c_{X}^{(\\mathrm{env})} + \\frac{1}{2} k_{X}^{(\\mathrm{env})} \\lVert \\mathbf{x} \\rVert^{2} \\right)\\right] \\, d^{D}\\mathbf{x}\n$$\nThe exponential of a sum is a product of exponentials. The term involving $c_{X}^{(\\mathrm{env})}$ is constant with respect to the integration variable $\\mathbf{x}$ and can be factored out:\n$$\nZ_{X}^{(\\mathrm{env})} = \\exp(-\\beta c_{X}^{(\\mathrm{env})}) \\int_{\\mathbb{R}^{D}} \\exp\\left(-\\frac{\\beta k_{X}^{(\\mathrm{env})}}{2} \\lVert \\mathbf{x} \\rVert^{2}\\right) \\, d^{D}\\mathbf{x}\n$$\nThe integral is a standard $D$-dimensional Gaussian integral. By writing $\\lVert \\mathbf{x} \\rVert^{2} = \\sum_{i=1}^{D} x_{i}^{2}$, the multidimensional integral separates into a product of $D$ identical one-dimensional integrals:\n$$\n\\int_{\\mathbb{R}^{D}} \\exp\\left(-\\frac{\\beta k_{X}^{(\\mathrm{env})}}{2} \\sum_{i=1}^{D} x_{i}^{2}\\right) \\, d^{D}\\mathbf{x} = \\prod_{i=1}^{D} \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_{X}^{(\\mathrm{env})}}{2} x_{i}^{2}\\right) \\, dx_{i} \\right]\n$$\nUsing the standard result for a Gaussian integral, $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$, with $a = \\frac{\\beta k_{X}^{(\\mathrm{env})}}{2}$, each one-dimensional integral evaluates to:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_{X}^{(\\mathrm{env})}}{2} x_{i}^{2}\\right) \\, dx_{i} = \\sqrt{\\frac{2\\pi}{\\beta k_{X}^{(\\mathrm{env})}}}\n$$\nThe $D$-dimensional integral is then the $D$-th power of this result:\n$$\n\\left(\\sqrt{\\frac{2\\pi}{\\beta k_{X}^{(\\mathrm{env})}}}\\right)^{D} = \\left(\\frac{2\\pi}{\\beta k_{X}^{(\\mathrm{env})}}\\right)^{D/2}\n$$\nSubstituting this back into the expression for the partition function yields:\n$$\nZ_{X}^{(\\mathrm{env})} = \\exp(-\\beta c_{X}^{(\\mathrm{env})}) \\left(\\frac{2\\pi}{\\beta k_{X}^{(\\mathrm{env})}}\\right)^{D/2}\n$$\nNow, we can compute the ratio of partition functions required for $\\Delta G_{A \\to B}^{(\\mathrm{env})}$:\n$$\n\\frac{Z_{B}^{(\\mathrm{env})}}{Z_{A}^{(\\mathrm{env})}} = \\frac{\\exp(-\\beta c_{B}^{(\\mathrm{env})}) \\left(\\frac{2\\pi}{\\beta k_{B}^{(\\mathrm{env})}}\\right)^{D/2}}{\\exp(-\\beta c_{A}^{(\\mathrm{env})}) \\left(\\frac{2\\pi}{\\beta k_{A}^{(\\mathrm{env})}}\\right)^{D/2}}\n$$\nThe terms $(2\\pi/\\beta)^{D/2}$ cancel, leaving:\n$$\n\\frac{Z_{B}^{(\\mathrm{env})}}{Z_{A}^{(\\mathrm{env})}} = \\frac{\\exp(-\\beta c_{B}^{(\\mathrm{env})}) (k_{B}^{(\\mathrm{env})})^{-D/2}}{\\exp(-\\beta c_{A}^{(\\mathrm{env})}) (k_{A}^{(\\mathrm{env})})^{-D/2}} = \\exp\\left[-\\beta(c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})})\\right] \\left(\\frac{k_{A}^{(\\mathrm{env})}}{k_{B}^{(\\mathrm{env})}}\\right)^{D/2}\n$$\nThe alchemical free energy change is then:\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = -k_{\\mathrm{B}} T \\ln \\left( \\exp\\left[-\\beta(c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})})\\right] \\left(\\frac{k_{A}^{(\\mathrm{env})}}{k_{B}^{(\\mathrm{env}})}\\right)^{D/2} \\right)\n$$\nUsing the properties of logarithms, $\\ln(ab) = \\ln(a) + \\ln(b)$ and $\\ln(e^x) = x$, and recalling that $k_{\\mathrm{B}} T \\beta = 1$:\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = -k_{\\mathrm{B}} T \\left[ -\\beta(c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})}) + \\frac{D}{2} \\ln\\left(\\frac{k_{A}^{(\\mathrm{env}})}{k_{B}^{(\\mathrm{env}})}\\right) \\right]\n$$\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = (c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})}) - \\frac{k_{\\mathrm{B}} T D}{2} \\ln\\left(\\frac{k_{A}^{(\\mathrm{env})}}{k_{B}^{(\\mathrm{env})}}\\right)\n$$\nUsing $\\ln(1/x) = -\\ln(x)$, we can write this more symmetrically as:\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = (c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})}) + \\frac{k_{\\mathrm{B}} T D}{2} \\ln\\left(\\frac{k_{B}^{(\\mathrm{env})}}{k_{A}^{(\\mathrm{env})}}\\right)\n$$\nThis is the general expression for the free energy change in a single environment.\nFinally, we compute the relative binding free energy $\\Delta \\Delta G_{\\mathrm{binding}}$ by subtracting the result for the unbound state from the bound state. Let $\\Delta c^{(\\mathrm{env})} = c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})}$.\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{bound})} = \\Delta c^{(\\mathrm{bound})} + \\frac{k_{\\mathrm{B}} T D}{2} \\ln\\left(\\frac{k_{B}^{(\\mathrm{bound})}}{k_{A}^{(\\mathrm{bound})}}\\right)\n$$\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{unbound})} = \\Delta c^{(\\mathrm{unbound})} + \\frac{k_{\\mathrm{B}} T D}{2} \\ln\\left(\\frac{k_{B}^{(\\mathrm{unbound})}}{k_{A}^{(\\mathrm{unbound})}}\\right)\n$$\nSubtracting the two expressions:\n$$\n\\Delta \\Delta G_{\\mathrm{binding}} = (\\Delta c^{(\\mathrm{bound})} - \\Delta c^{(\\mathrm{unbound})}) + \\frac{k_{\\mathrm{B}} T D}{2} \\left[ \\ln\\left(\\frac{k_{B}^{(\\mathrm{bound})}}{k_{A}^{(\\mathrm{bound})}}\\right) - \\ln\\left(\\frac{k_{B}^{(\\mathrm{unbound})}}{k_{A}^{(\\mathrm{unbound})}}\\right) \\right]\n$$\nSubstituting back the definitions of $\\Delta c$ and combining the logarithmic terms using $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$\n\\Delta \\Delta G_{\\mathrm{binding}} = (c_{B}^{(\\mathrm{bound})} - c_{A}^{(\\mathrm{bound})} - c_{B}^{(\\mathrm{unbound})} + c_{A}^{(\\mathrm{unbound})}) + \\frac{k_{\\mathrm{B}} T D}{2} \\ln\\left( \\frac{ k_{B}^{(\\mathrm{bound})} k_{A}^{(\\mathrm{unbound})} }{ k_{A}^{(\\mathrm{bound})} k_{B}^{(\\mathrm{unbound})} } \\right)\n$$\nThis is the final analytical formula. It will be implemented to compute the numerical results for the provided test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative binding free energy for a series of test cases\n    based on an analytical model of alchemical transformation.\n    \"\"\"\n    kB = 0.008314462618  # Boltzmann constant in kJ/(mol·K)\n\n    # Test cases: (T, D, k_bA, c_bA, k_bB, c_bB, k_uA, c_uA, k_uB, c_uB)\n    test_cases = [\n        (298.15, 3, 200, -20, 250, -25, 50, 0, 60, -2),\n        (298.15, 1, 100, -10, 100, -10, 100, 0, 100, 0),\n        (310, 2, 1000, -20, 100, -20, 10, 0, 1000, 0),\n        (350, 3, 150, -18, 180, -21, 60, 0, 65, -1.5)\n    ]\n\n    results = []\n    for case in test_cases:\n        T, D, k_bA, c_bA, k_bB, c_bB, k_uA, c_uA, k_uB, c_uB = case\n\n        # The analytical formula for the relative binding free energy is:\n        # ΔΔG = (c_bB - c_bA - c_uB + c_uA) + (k_B*T*D/2) * ln((k_bB*k_uA) / (k_bA*k_uB))\n        \n        # Contribution from the potential energy offsets\n        delta_c_term = (c_bB - c_bA) - (c_uB - c_uA)\n\n        # Contribution from the stiffness (entropy)\n        # We must protect against division by zero, although the problem states k > 0.\n        # Also, the argument of the logarithm must be positive.\n        k_ratio = (k_bB * k_uA) / (k_bA * k_uB)\n        \n        # The prefactor for the logarithmic term\n        log_prefactor = 0.5 * kB * T * D\n        \n        # Logarithmic term\n        log_term = log_prefactor * np.log(k_ratio)\n        \n        # Total relative binding free energy\n        ddG_binding = delta_c_term + log_term\n        \n        results.append(ddG_binding)\n\n    # Format the results to six decimal places and print\n    # in the specified comma-separated list format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2455844"}, {"introduction": "A calculated number is only as good as its reliability, and in computational science, rigorous validation is paramount. Free energy is a state function, a property that provides a powerful method for checking the internal consistency of simulation results [@problem_id:2455881]. This final practice takes you into the world of data analysis, where you will use a \"cycle-closure\" test to determine if a set of independent FEP calculations are statistically consistent with each other, a crucial step in any serious free energy study.", "problem": "In free energy perturbation (FEP), relative Gibbs free energy changes between states are estimated from molecular simulations. For three alchemical mutations $A \\to B$, $B \\to C$, and $A \\to C$, suppose you have independently obtained the following estimates (means and standard errors), in $\\mathrm{kcal\\,mol^{-1}}$:\n- $\\Delta G_{A \\to B} = 1.20 \\pm 0.30$\n- $\\Delta G_{B \\to C} = -0.80 \\pm 0.40$\n- $\\Delta G_{A \\to C} = 0.50 \\pm 0.35$\n\nSelect the option that correctly defines a statistically sound cycle-closure consistency test at $95\\%$ confidence for this three-state set and correctly evaluates whether these data pass that test.\n\nA. Define the cycle-closure residual as $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C}$, and, assuming independent estimates, the uncertainty as $\\sigma_{\\varepsilon} = \\sqrt{\\sigma_{A \\to B}^{2} + \\sigma_{B \\to C}^{2} + \\sigma_{A \\to C}^{2}}$. Declare the cycle consistent if $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$; with the given data, the cycle passes.\n\nB. Enforce thermodynamic consistency by requiring $\\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{A \\to C} = 0$ exactly; with the given data, the cycle fails.\n\nC. Define the closure residual as $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C}$, and the uncertainty as $\\sigma_{\\varepsilon} = \\sigma_{A \\to B} + \\sigma_{B \\to C} + \\sigma_{A \\to C}$. Declare the cycle consistent if $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$; with the given data, the cycle passes.\n\nD. Define the closure residual as $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{C \\to A}$, taking $\\Delta G_{C \\to A} = \\Delta G_{A \\to C}$, and combine uncertainties as $\\sigma_{\\varepsilon} = \\sqrt{\\sigma_{A \\to B}^{2} + \\sigma_{B \\to C}^{2} + \\sigma_{A \\to C}^{2}}$. Declare the cycle consistent if $\\lvert \\varepsilon \\rvert \\le \\sigma_{\\varepsilon}$; with the given data, the cycle passes.\n\nE. Define the closure residual as $\\varepsilon = \\Delta G_{A \\to C} - \\left(\\Delta G_{A \\to B} + \\Delta G_{B \\to C}\\right)$ and its uncertainty as the average $\\sigma_{\\varepsilon} = \\left(\\sigma_{A \\to B} + \\sigma_{B \\to C} + \\sigma_{A \\to C}\\right)/3$. Declare consistency if $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$; with the given data, the cycle fails.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\nThe provided information is as follows:\n- A thermodynamic cycle involving three states, $A$, $B$, and $C$, is considered.\n- The relative Gibbs free energy changes are estimated from independent molecular simulations.\n- $\\Delta G_{A \\to B} = 1.20 \\pm 0.30 \\, \\mathrm{kcal\\,mol^{-1}}$ (mean $\\pm$ standard error).\n- $\\Delta G_{B \\to C} = -0.80 \\pm 0.40 \\, \\mathrm{kcal\\,mol^{-1}}$ (mean $\\pm$ standard error).\n- $\\Delta G_{A \\to C} = 0.50 \\pm 0.35 \\, \\mathrm{kcal\\,mol^{-1}}$ (mean $\\pm$ standard error).\n- The task is to identify a statistically sound cycle-closure consistency test at $95\\%$ confidence and evaluate it with the given data.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is based on the fundamental principle that Gibbs free energy is a state function, a cornerstone of thermodynamics. The application of statistical error analysis (propagation of uncertainty, confidence intervals) to computational chemistry results (FEP simulations) is a standard and rigorous practice in the field. The provided numerical values are physically plausible. The problem is scientifically sound.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary data (means and standard errors of independent measurements) to construct a statistical test for cycle closure. The question is precise and allows for a unique, determinable answer based on established statistical methods.\n- **Objectivity**: The problem is stated objectively using quantitative data and established scientific terminology. It is free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is a standard exercise in the statistical analysis of simulation data. I shall proceed with the derivation and evaluation.\n\n### Derivation\n\nThe analysis rests on two principles: one from thermodynamics and one from statistics.\n\n**1. Thermodynamic Principle:**\nGibbs free energy, $G$, is a state function. This implies that for any cyclic path, the net change in free energy is zero. For the cycle $A \\to B \\to C \\to A$, we have:\n$$ \\Delta G_{\\text{cycle}} = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{C \\to A} = 0 $$\nFurthermore, the free energy change for a reverse process is the negative of the forward process: $\\Delta G_{C \\to A} = - \\Delta G_{A \\to C}$. Substituting this into the cycle equation gives the condition for ideal cycle closure:\n$$ \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C} = 0 $$\nThis equation defines the ideal relationship that the true mean values should satisfy.\n\n**2. Statistical Principle:**\nThe values provided are not the true, exact free energies, but are *estimates* from finite simulations, each with an associated statistical error (standard error of the mean). We must therefore test whether the observed deviation from ideal closure is statistically significant.\n\nWe define a cycle-closure residual, $\\varepsilon$, as the deviation from the expected value of zero:\n$$ \\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C} $$\nUsing the given mean values, we calculate the observed residual:\n$$ \\varepsilon = 1.20 \\, \\mathrm{kcal\\,mol^{-1}} + (-0.80 \\, \\mathrm{kcal\\,mol^{-1}}) - 0.50 \\, \\mathrm{kcal\\,mol^{-1}} = -0.10 \\, \\mathrm{kcal\\,mol^{-1}} $$\nThe problem states the estimates are \"independently obtained\". For a quantity $Y = c_1 X_1 + c_2 X_2 + c_3 X_3$ where $X_i$ are independent random variables with variances $\\sigma_{X_i}^2$, the variance of $Y$ is $\\sigma_Y^2 = c_1^2 \\sigma_{X_1}^2 + c_2^2 \\sigma_{X_2}^2 + c_3^2 \\sigma_{X_3}^2$. In our case, $\\Delta G_{A \\to B}$, $\\Delta G_{B \\to C}$, and $\\Delta G_{A \\to C}$ are the independent variables, and the coefficients are $c_1=1$, $c_2=1$, and $c_3=-1$. The variance of the residual, $\\sigma_{\\varepsilon}^2$, is therefore:\n$$ \\sigma_{\\varepsilon}^2 = (1)^2 \\sigma_{A \\to B}^2 + (1)^2 \\sigma_{B \\to C}^2 + (-1)^2 \\sigma_{A \\to C}^2 = \\sigma_{A \\to B}^2 + \\sigma_{B \\to C}^2 + \\sigma_{A \\to C}^2 $$\nThe standard error of the residual, $\\sigma_{\\varepsilon}$, is the square root of the variance:\n$$ \\sigma_{\\varepsilon} = \\sqrt{\\sigma_{A \\to B}^2 + \\sigma_{B \\to C}^2 + \\sigma_{A \\to C}^2} $$\nSubstituting the given standard errors:\n$$ \\sigma_{\\varepsilon} = \\sqrt{(0.30)^2 + (0.40)^2 + (0.35)^2} = \\sqrt{0.09 + 0.16 + 0.1225} = \\sqrt{0.3725} \\approx 0.6103 \\, \\mathrm{kcal\\,mol^{-1}} $$\nA test at $95\\%$ confidence checks if the ideal value of $0$ is within the $95\\%$ confidence interval of our estimated residual. Assuming the Central Limit Theorem holds and the errors are approximately normally distributed, this interval is $\\varepsilon \\pm 1.96 \\, \\sigma_{\\varepsilon}$. The cycle is considered consistent if $0$ lies within this interval, which simplifies to the condition:\n$$ \\lvert \\varepsilon \\rvert \\le 1.96 \\, \\sigma_{\\varepsilon} $$\nLet us evaluate this condition with our calculated values:\n- Left side: $\\lvert \\varepsilon \\rvert = \\lvert -0.10 \\rvert = 0.10$.\n- Right side: $1.96 \\, \\sigma_{\\varepsilon} \\approx 1.96 \\times 0.6103 \\approx 1.196$.\n\nThe condition is $0.10 \\le 1.196$, which is true. The cycle is consistent at the $95\\%$ confidence level; the data pass the test.\n\n### Option-by-Option Analysis\n\n**A. Define the cycle-closure residual as $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C}$, and, assuming independent estimates, the uncertainty as $\\sigma_{\\varepsilon} = \\sqrt{\\sigma_{A \\to B}^{2} + \\sigma_{B \\to C}^{2} + \\sigma_{A \\to C}^{2}}$. Declare the cycle consistent if $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$; with the given data, the cycle passes.**\n- The definition of the residual $\\varepsilon$ is correct based on thermodynamic principles.\n- The formula for propagating uncertainty (standard error $\\sigma_{\\varepsilon}$) is correct for a sum of independent variables.\n- The statistical test $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$ is the correct criterion for $95\\%$ confidence.\n- The evaluation \"the cycle passes\" matches our derivation.\n- **Verdict: Correct.**\n\n**B. Enforce thermodynamic consistency by requiring $\\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{A \\to C} = 0$ exactly; with the given data, the cycle fails.**\n- The formula $\\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{A \\to C} = 0$ is thermodynamically incorrect; it should be $\\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C} = 0$.\n- More importantly, requiring an exact equality for statistical estimates is fundamentally flawed logic. It completely ignores the nature of statistical uncertainty inherent in the measurements. This is a deterministic, not a statistical, test.\n- **Verdict: Incorrect.**\n\n**C. Define the closure residual as $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C}$, and the uncertainty as $\\sigma_{\\varepsilon} = \\sigma_{A \\to B} + \\sigma_{B \\to C} + \\sigma_{A \\to C}$. Declare the cycle consistent if $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$; with the given data, the cycle passes.**\n- The definition of the residual $\\varepsilon$ is correct.\n- The formula for the uncertainty, $\\sigma_{\\varepsilon} = \\sigma_{A \\to B} + \\sigma_{B \\to C} + \\sigma_{A \\to C}$, is incorrect. Standard errors add in quadrature (sum of squares), not linearly. This is a gross violation of error propagation rules for independent variables.\n- **Verdict: Incorrect.**\n\n**D. Define the closure residual as $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{C \\to A}$, taking $\\Delta G_{C \\to A} = \\Delta G_{A \\to C}$, and combine uncertainties as $\\sigma_{\\varepsilon} = \\sqrt{\\sigma_{A \\to B}^{2} + \\sigma_{B \\to C}^{2} + \\sigma_{A \\to C}^{2}}$. Declare the cycle consistent if $\\lvert \\varepsilon \\rvert \\le \\sigma_{\\varepsilon}$; with the given data, the cycle passes.**\n- The definition of the residual uses the assumption $\\Delta G_{C \\to A} = \\Delta G_{A \\to C}$, which is thermodynamically incorrect. The correct relation is $\\Delta G_{C \\to A} = - \\Delta G_{A \\to C}$.\n- The consistency test $\\lvert \\varepsilon \\rvert \\le \\sigma_{\\varepsilon}$ corresponds to a confidence level of approximately $68\\%$ (one standard deviation), not the required $95\\%$.\n- The option contains at least two fundamental errors.\n- **Verdict: Incorrect.**\n\n**E. Define the closure residual as $\\varepsilon = \\Delta G_{A \\to C} - \\left(\\Delta G_{A \\to B} + \\Delta G_{B \\to C}\\right)$ and its uncertainty as the average $\\sigma_{\\varepsilon} = \\left(\\sigma_{A \\to B} + \\sigma_{B \\to C} + \\sigma_{A \\to C}\\right)/3$. Declare consistency if $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$; with the given data, the cycle fails.**\n- The definition of the uncertainty as the arithmetic average of the standard errors is baseless in statistics. There is no principle that justifies this combination rule for error propagation.\n- Furthermore, the evaluation \"the cycle fails\" is a miscalculation even with the flawed formula. As calculated in the derivation, $\\lvert \\varepsilon \\rvert = 0.10$. Using the flawed uncertainty formula, $\\sigma_{\\varepsilon} = (0.30 + 0.40 + 0.35)/3 = 0.35$. Then $1.96\\,\\sigma_{\\varepsilon} = 1.96 \\times 0.35 = 0.686$. Since $0.10 \\le 0.686$, the cycle would pass this test. The option contradicts itself.\n- **Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2455881"}]}