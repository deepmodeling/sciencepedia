{"hands_on_practices": [{"introduction": "This first exercise takes us back to a classic thought experiment in probability, Bertrand's Box Paradox. By working through this problem, you will practice the fundamental mechanics of Bayes' theorem: updating a prior belief after observing new evidence. This variation [@problem_id:691205] adds a layer of realism by introducing non-uniform prior probabilities, forcing us to consider how our initial assumptions, or priors, quantitatively impact our final conclusion.", "problem": "Consider a variation of the classic Bertrand's Box Paradox. There are three boxes, indistinguishable from the outside.\n- Box 1 contains two gold coins (GG).\n- Box 2 contains two silver coins (SS).\n- Box 3 contains one gold and one silver coin (GS).\n\nUnlike the classic paradox, the boxes are not chosen with equal probability. The prior probability of selecting the GG box is $p_G$, of selecting the SS box is $p_S$, and of selecting the GS box is $p_M$. These probabilities are known constants, greater than zero, and sum to one: $p_G + p_S + p_M = 1$.\n\nAn experiment is conducted where a box is chosen according to these prior probabilities, and then a single coin is drawn uniformly at random from the selected box. Upon inspection, the drawn coin is found to be gold.\n\nDerive a closed-form analytic expression for the posterior probability that the *other* coin in the chosen box is also gold, given the observation that the first drawn coin is gold. Express your answer in terms of the prior probabilities $p_G$ and $p_M$.", "solution": "We denote the events $B_{GG},B_{GS},B_{SS}$ for choosing the respective boxes, and $D$ for drawing a gold coin. The priors and conditional probabilities are\n$$P(B_{GG})=p_G,\\quad P(B_{GS})=p_M,\\quad P(B_{SS})=p_S,$$\n$$P(D\\mid B_{GG})=1,\\quad P(D\\mid B_{GS})=\\frac{1}{2},\\quad P(D\\mid B_{SS})=0.$$\n\nThe total probability of drawing gold is\n$$P(D)=p_G\\cdot1 + p_M\\cdot\\frac{1}{2} + p_S\\cdot0 = p_G + \\frac{1}{2}p_M.$$\n\nBy Bayes' theorem,\n$$P(B_{GG}\\mid D)=\\frac{P(D\\mid B_{GG})\\,P(B_{GG})}{P(D)} = \\frac{p_G}{p_G + \\frac{1}{2}p_M}.$$\n\nSince only the $GG$ box yields the other coin gold, the desired posterior probability is\n$$P(\\text{other coin is gold}\\mid D)=P(B_{GG}\\mid D)=\\frac{p_G}{p_G + \\frac{1}{2}p_M}.$$", "answer": "$$\\boxed{\\frac{p_G}{p_G + \\frac{1}{2}p_M}}$$", "id": "691205"}, {"introduction": "Now, let's move from classic paradoxes to a practical application in diagnostics, a core area of bioinformatics. This scenario [@problem_id:1898684] involves a veterinarian facing a diagnostic puzzle, a situation where Bayes' theorem is invaluable for making informed decisions under uncertainty. You will learn to integrate various pieces of information—disease prevalence (the prior), symptom manifestation, and the results of an imperfect diagnostic test (the evidence)—to calculate the most likely diagnosis.", "problem": "A veterinarian is investigating a peculiar new symptom in dogs: a faint, intermittent bioluminescence of the paw pads. After extensive research, it is determined that this symptom is caused exclusively by one of two mutually exclusive and rare medical conditions: Canine Lumiviral Infection (CLI) or Amber-Paw Syndrome (APS).\n\nIn the general canine population, the prevalence of CLI is 1 in 100, while the prevalence of APS is 1 in 2000. Not all dogs with these conditions exhibit the symptom. The probability that a dog with CLI will show the glowing paw symptom is 0.80. The probability that a dog with APS will show the symptom is 0.95.\n\nA rapid diagnostic test exists for CLI, but not for APS. The test for CLI has a sensitivity of 0.98 and a specificity of 0.99.\n\nA dog is brought to the clinic presenting with the glowing paw pad symptom. The veterinarian administers the test for CLI, and the result is negative. Given this information, what is the probability that the dog has Amber-Paw Syndrome?\n\nCalculate your answer and round it to three significant figures.", "solution": "Let $C$ denote CLI, $A$ denote APS, $S$ denote the glowing paw symptom, and $N$ denote a negative CLI test. Given: $P(C)=\\frac{1}{100}=0.01$, $P(A)=\\frac{1}{2000}=0.0005$, $P(S\\mid C)=0.80$, $P(S\\mid A)=0.95$. The CLI test has sensitivity $0.98$ and specificity $0.99$, so $P(N\\mid C)=1-0.98=0.02$ and, since $A$ implies not $C$, $P(N\\mid A)=0.99$. The symptom arises exclusively from $C$ or $A$, so other causes can be ignored.\n\nWe seek $P(A\\mid S,N)$. By Bayes’ rule with conditional independence of $S$ and $N$ given the condition,\n$$\nP(A\\mid S,N)=\\frac{P(A)P(S\\mid A)P(N\\mid A)}{P(C)P(S\\mid C)P(N\\mid C)+P(A)P(S\\mid A)P(N\\mid A)}.\n$$\nCompute the terms:\n$$\nP(A)P(S\\mid A)P(N\\mid A)=\\frac{1}{2000}\\cdot 0.95\\cdot 0.99=0.00047025,\n$$\n$$\nP(C)P(S\\mid C)P(N\\mid C)=\\frac{1}{100}\\cdot 0.80\\cdot 0.02=0.00016.\n$$\nThus\n$$\nP(A\\mid S,N)=\\frac{0.00047025}{0.00016+0.00047025}=\\frac{1881}{2521}\\approx 0.746133\\ldots\n$$\nRounded to three significant figures, this is $0.746$.", "answer": "$$\\boxed{0.746}$$", "id": "1898684"}, {"introduction": "Our final practice problem presents a sophisticated and critical challenge encountered in real-world genetic association studies: Simpson's Paradox. This counter-intuitive phenomenon, where a trend appears in different groups of data but reverses when these groups are combined, highlights the limits of simple statistical association. This exercise [@problem_id:2374723] will guide you to use Bayesian reasoning and causal models to untangle confounding variables and arrive at a correct scientific interpretation, a crucial skill for any computational biologist.", "problem": "A biobank study pools individuals from two ancestrally distinct sub-populations. Let the binary variables be genotype indicator $G \\in \\{0,1\\}$ for the presence ($G=1$) versus absence ($G=0$) of an allele, disease status $D \\in \\{0,1\\}$ for case ($D=1$) versus control ($D=0$), and sub-population $S \\in \\{s_{0}, s_{1}\\}$. Within each sub-population, the allele is believed to increase risk: for $S=s_{0}$, the within-stratum risks are $P(D=1 \\mid G=0, S=s_{0}) = 0.01$ and $P(D=1 \\mid G=1, S=s_{0}) = 0.02$; for $S=s_{1}$, the within-stratum risks are $P(D=1 \\mid G=0, S=s_{1}) = 0.20$ and $P(D=1 \\mid G=1, S=s_{1}) = 0.30$. The sub-population mixture proportions are $P(S=s_{0}) = 0.70$ and $P(S=s_{1}) = 0.30$. The allele is much more common in $s_{0}$ than in $s_{1}$: $P(G=1 \\mid S=s_{0}) = 0.90$ and $P(G=1 \\mid S=s_{1}) = 0.10$.\n\nUsing only the definitions of joint and conditional probability and the law of total probability as the fundamental starting point, do the following: infer the appropriate causal explanation and adjustment strategy for the observed reversal known as Simpson’s Paradox, and compute the marginal risks $P(D=1 \\mid G=1)$ and $P(D=1 \\mid G=0)$ implied by the numbers above to check whether the allele appears protective overall despite being harmful within each sub-population.\n\nWhich option best explains the paradox with a Bayesian causal model and identifies the correct adjustment to recover the causal effect of $G$ on $D$?\n\nA. A Directed Acyclic Graph (DAG) with edges $S \\rightarrow G$, $S \\rightarrow D$, and $G \\rightarrow D$ explains the reversal: $S$ confounds the $G \\rightarrow D$ relationship because it affects both $G$ and $D$. The marginal association $P(D=1 \\mid G)$ is a mixture over $S$, so with the given numbers one obtains $P(D=1 \\mid G=1) &lt; P(D=1 \\mid G=0)$ even though, for each stratum $s \\in \\{s_{0}, s_{1}\\}$, $P(D=1 \\mid G=1, S=s) &gt; P(D=1 \\mid G=0, S=s)$. Adjusting for $S$ recovers the true risk-increasing effect of the allele.\n\nB. A DAG with $G \\rightarrow S \\leftarrow D$ (so $S$ is a collider) explains the reversal: the paradox arises only when conditioning on $S$. Without conditioning, the marginal association equals the causal effect, so no adjustment is needed, and the given numbers would imply $P(D=1 \\mid G=1) &gt; P(D=1 \\mid G=0)$.\n\nC. A DAG with $G \\leftarrow S \\rightarrow D$ explains the reversal, but to remove the bias one must adjust for the outcome $D$ rather than $S$. The overall association flips direction only after conditioning on $D$.\n\nD. A DAG with $G \\rightarrow D$ and no other edges explains the data; there is no confounding and the observed reversal is sampling variability. The marginal and conditional associations agree in direction, so no adjustment is warranted.", "solution": "The problem statement must first be validated for its scientific and logical integrity.\n\n**Step 1: Extraction of Givens**\nThe provided quantitative information is as follows:\n-   A set of three binary random variables: $G \\in \\{0,1\\}$ (genotype), $D \\in \\{0,1\\}$ (disease status), $S \\in \\{s_{0}, s_{1}\\}$ (sub-population).\n-   Within-stratum conditional probabilities (risks) for sub-population $s_{0}$:\n    $P(D=1 \\mid G=0, S=s_{0}) = 0.01$\n    $P(D=1 \\mid G=1, S=s_{0}) = 0.02$\n-   Within-stratum conditional probabilities (risks) for sub-population $s_{1}$:\n    $P(D=1 \\mid G=0, S=s_{1}) = 0.20$\n    $P(D=1 \\mid G=1, S=s_{1}) = 0.30$\n-   Sub-population marginal probabilities (mixture proportions):\n    $P(S=s_{0}) = 0.70$\n    $P(S=s_{1}) = 0.30$\n-   Allele frequencies conditioned on sub-population:\n    $P(G=1 \\mid S=s_{0}) = 0.90$\n    $P(G=1 \\mid S=s_{1}) = 0.10$\n\n**Step 2: Validation of Problem Statement**\nThe problem describes a classic scenario of confounding leading to Simpson's Paradox, a well-established statistical phenomenon. The context is population stratification in genetic association studies, which is a fundamental topic in bioinformatics and statistical genetics. All probabilities are well-defined and sum to unity where required (e.g., $P(S=s_{0}) + P(S=s_{1}) = 0.70 + 0.30 = 1.0$). The data provided are self-contained, consistent, and scientifically plausible. The problem is well-posed and asks for a standard analysis involving probability calculus and causal reasoning using Directed Acyclic Graphs (DAGs). There are no logical contradictions, factual errors, or ambiguities in the core statement. The problem is therefore valid.\n\n**Step 3: Solution Derivation**\nThe task is to compute the marginal risks, verify the paradox, and identify the correct causal explanation and adjustment strategy. The fundamental principles are the law of total probability and Bayes' theorem.\n\nFirst, we establish the causal relationships between the variables $S$, $G$, and $D$ to construct a DAG.\n1.  Ancestral sub-population ($S$) is a demographic attribute that precedes an individual's genotype ($G$). The problem states that allele frequencies differ between sub-populations ($P(G=1 \\mid S=s_0) \\neq P(G=1 \\mid S=s_1)$), which implies a causal directed edge $S \\rightarrow G$.\n2.  Sub-population ($S$) can also influence disease risk ($D$) through various genetic, environmental, or socioeconomic factors other than the specific allele $G$. The given data show that baseline disease risk differs significantly between subpopulations (e.g., $P(D=1 \\mid G=0, S=s_0) = 0.01$ whereas $P(D=1 \\mid G=0, S=s_1) = 0.20$). This implies a causal directed edge $S \\rightarrow D$.\n3.  The problem hypothesizes that the allele ($G$) influences disease risk ($D$). The within-stratum risks confirm this: in both sub-populations, the presence of the allele increases the risk of the disease ($P(D=1 \\mid G=1, S=s) > P(D=1 \\mid G=0, S=s)$ for $s \\in \\{s_0, s_1\\}$). This justifies a causal directed edge $G \\rightarrow D$.\nCombining these, the causal structure is represented by a DAG with edges $S \\rightarrow G$ and $S \\rightarrow D$, as well as $G \\rightarrow D$. In this structure, $S$ is a common cause of $G$ and $D$, making it a confounder of the relationship between $G$ and $D$. The path $G \\leftarrow S \\rightarrow D$ is a non-causal \"backdoor\" path that can induce a spurious association between $G$ and $D$.\n\nNext, we calculate the marginal (overall) risks, $P(D=1 \\mid G=1)$ and $P(D=1 \\mid G=0)$. The marginal risk $P(D=1 \\mid G=g)$ for a specific genotype $g \\in \\{0, 1\\}$ is obtained by applying the law of total probability, marginalizing over the sub-populations $S$:\n$$P(D=1 \\mid G=g) = \\sum_{s \\in \\{s_0, s_1\\}} P(D=1 \\mid G=g, S=s) P(S=s \\mid G=g)$$\nTo use this formula, we must first compute $P(S=s \\mid G=g)$ using Bayes' theorem:\n$$P(S=s \\mid G=g) = \\frac{P(G=g \\mid S=s) P(S=s)}{P(G=g)}$$\nThis requires the marginal probability of the genotype, $P(G=g)$, which is found again using the law of total probability:\n$$P(G=g) = P(G=g \\mid S=s_0)P(S=s_0) + P(G=g \\mid S=s_1)P(S=s_1)$$\nWe also need the probabilities of allele absence, which are $P(G=0 \\mid S=s_0) = 1 - 0.90 = 0.10$ and $P(G=0 \\mid S=s_1) = 1 - 0.10 = 0.90$.\n\nCalculations:\n1.  Marginal probabilities of genotypes:\n    $P(G=1) = (0.90)(0.70) + (0.10)(0.30) = 0.63 + 0.03 = 0.66$\n    $P(G=0) = (0.10)(0.70) + (0.90)(0.30) = 0.07 + 0.27 = 0.34$\n    (Check: $0.66 + 0.34 = 1.0$)\n\n2.  Conditional probabilities of sub-population given genotype:\n    $P(S=s_0 \\mid G=1) = \\frac{P(G=1 \\mid S=s_0)P(S=s_0)}{P(G=1)} = \\frac{(0.90)(0.70)}{0.66} = \\frac{0.63}{0.66} = \\frac{21}{22}$\n    $P(S=s_1 \\mid G=1) = \\frac{P(G=1 \\mid S=s_1)P(S=s_1)}{P(G=1)} = \\frac{(0.10)(0.30)}{0.66} = \\frac{0.03}{0.66} = \\frac{1}{22}$\n    $P(S=s_0 \\mid G=0) = \\frac{P(G=0 \\mid S=s_0)P(S=s_0)}{P(G=0)} = \\frac{(0.10)(0.70)}{0.34} = \\frac{0.07}{0.34} = \\frac{7}{34}$\n    $P(S=s_1 \\mid G=0) = \\frac{P(G=0 \\mid S=s_1)P(S=s_1)}{P(G=0)} = \\frac{(0.90)(0.30)}{0.34} = \\frac{0.27}{0.34} = \\frac{27}{34}$\n\n3.  Marginal risks:\n    $P(D=1 \\mid G=1) = P(D=1 \\mid G=1, S=s_0)P(S=s_0 \\mid G=1) + P(D=1 \\mid G=1, S=s_1)P(S=s_1 \\mid G=1)$\n    $$P(D=1 \\mid G=1) = (0.02)\\left(\\frac{21}{22}\\right) + (0.30)\\left(\\frac{1}{22}\\right) = \\frac{0.42 + 0.30}{22} = \\frac{0.72}{22} \\approx 0.0327$$\n    $P(D=1 \\mid G=0) = P(D=1 \\mid G=0, S=s_0)P(S=s_0 \\mid G=0) + P(D=1 \\mid G=0, S=s_1)P(S=s_1 \\mid G=0)$\n    $$P(D=1 \\mid G=0) = (0.01)\\left(\\frac{7}{34}\\right) + (0.20)\\left(\\frac{27}{34}\\right) = \\frac{0.07 + 5.40}{34} = \\frac{5.47}{34} \\approx 0.1609$$\n\nComparing the risks, we find that $P(D=1 \\mid G=1) \\approx 0.0327 < P(D=1 \\mid G=0) \\approx 0.1609$. This demonstrates a reversal: the allele appears protective in the pooled population. However, we were given that for each stratum $s$, $P(D=1 \\mid G=1, S=s) > P(D=1 \\mid G=0, S=s)$. This is Simpson's Paradox. The confounding variable $S$ is associated with both the exposure ($G$) and the outcome ($D$) and creates a spurious marginal association. To estimate the true causal effect of $G$ on $D$, one must adjust for the confounder $S$. This is done by examining the stratum-specific risks, which consistently show that the allele is harmful. The paradox arises because individuals with the risk allele ($G=1$) are predominantly from the low-risk population ($s_0$), while those without the allele ($G=0$) are predominantly from the high-risk population ($s_1$).\n\n**Step 4: Evaluation of Options**\n\nA. This option proposes the DAG with $S \\rightarrow G$, $S \\rightarrow D$, and $G \\rightarrow D$. This correctly models $S$ as a confounder. It states that the marginal association $P(D=1 \\mid G)$ will be reversed, which our calculation $P(D=1 \\mid G=1) < P(D=1 \\mid G=0)$ confirms. It correctly identifies that the true effect is risk-increasing and is recovered by adjusting for $S$. The reasoning is sound and aligns perfectly with our derivation.\n**Verdict: Correct.**\n\nB. This option proposes a DAG where $S$ is a collider ($G \\rightarrow S \\leftarrow D$). This causal structure is nonsensical, as genotype and disease do not cause ancestry. It incorrectly claims the paradox arises *from* conditioning on $S$, which is the opposite of the truth for confounding. It also incorrectly predicts the marginal association would be positive.\n**Verdict: Incorrect.**\n\nC. This option correctly identifies the confounding structure ($G \\leftarrow S \\rightarrow D$) but proposes adjusting for the outcome $D$. Adjusting for an outcome to find the effect of a cause is a fundamental error in causal inference and would introduce bias, not remove it. The paradox is an observation about the marginal association, not something that appears after conditioning on the outcome.\n**Verdict: Incorrect.**\n\nD. This option claims there is no confounding and the correct DAG is simply $G \\rightarrow D$. This is directly contradicted by the given probabilities, which show strong associations between $S$ and $G$, and between $S$ and $D$. It incorrectly dismisses the paradox as \"sampling variability\" when it is a deterministic consequence of the given population probabilities.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2374723"}]}