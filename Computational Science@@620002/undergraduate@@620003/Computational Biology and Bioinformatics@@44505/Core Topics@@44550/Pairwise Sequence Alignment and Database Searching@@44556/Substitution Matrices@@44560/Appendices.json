{"hands_on_practices": [{"introduction": "The first step in mastering substitution matrices is learning how to use them to evaluate a given alignment. This practice [@problem_id:2136014] provides a direct, hands-on opportunity to calculate the score of a simple protein alignment using the widely-used BLOSUM62 matrix. By summing the scores for each aligned pair of amino acids and accounting for gap penalties, you will build a foundational understanding of how sequence similarity is quantified.", "problem": "In the field of bioinformatics, sequence alignment is a fundamental method for comparing protein or nucleotide sequences to identify regions of similarity that may be a consequence of functional, structural, or evolutionary relationships. The quality of an alignment is quantified by a score, calculated using a substitution matrix and gap penalties.\n\nConsider the following gapped alignment of two short peptide sequences, Seq1 and Seq2:\n\nSeq1: `F E S A G K D E`\nSeq2: `F R S - G K T E`\n\nCalculate the total alignment score using the BLOcks SUbstitution Matrix 62 (BLOSUM62) and a linear gap penalty. A linear gap penalty means that each gap character, represented by a hyphen (`-`), incurs a fixed negative score, regardless of its length or position. For this problem, the linear gap penalty is $-8$.\n\nThe relevant substitution scores from the BLOSUM62 matrix are provided below:\n- Score(F, F) = 6\n- Score(E, R) = 0\n- Score(S, S) = 4\n- Score(G, G) = 6\n- Score(K, K) = 5\n- Score(D, T) = -1\n- Score(E, E) = 5\n\nProvide the total score as an integer.", "solution": "An alignment score with a substitution matrix and a linear gap penalty is computed by summing the substitution score for each aligned residue pair and adding the gap penalty for each gap character. Let $s(x,y)$ denote the BLOSUM62 substitution score and let the linear gap penalty be $g=-8$ per gap character.\n\nFor the given alignment across 8 columns, the contributions are:\n$$\ns(F,F)=6,\\quad s(E,R)=0,\\quad s(S,S)=4,\\quad \\text{gap}=g=-8,\\quad s(G,G)=6,\\quad s(K,K)=5,\\quad s(D,T)=-1,\\quad s(E,E)=5.\n$$\n\nTherefore, the total alignment score $S$ is\n$$\nS=6+0+4+(-8)+6+5+(-1)+5=17.\n$$", "answer": "$$\\boxed{17}$$", "id": "2136014"}, {"introduction": "While standard matrices like BLOSUM are powerful, the true strength of the log-odds scoring system lies in its adaptability. This exercise [@problem_id:2136035] invites you to step into the role of a bioinformatician creating a specialized matrix for proteins in a specific cellular environment. By calculating a single substitution score from given amino acid frequencies, you will directly apply the log-odds formula, $S_{ij} = k \\ln(p_{ij} / (q_i q_j))$, which forms the theoretical heart of all modern substitution matrices.", "problem": "A team of computational biologists is developing a specialized substitution matrix, which they have named \"CytoBLOSUM.\" This matrix is intended for the accurate alignment of protein sequences that are known to exist exclusively within the highly reducing environment of a cell's cytosol. The matrix is being derived using the same fundamental principles as the widely used Blocks Substitution Matrix (BLOSUM) family.\n\nThe score ($S_{ij}$) for substituting amino acid $i$ with amino acid $j$ in such a matrix is determined by the log-odds ratio of observed versus expected frequencies. The score is calculated using the following formula:\n$$S_{ij} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{p_{ij}}{q_i q_j}\\right)$$\nHere, $p_{ij}$ represents the observed frequency of the amino acid pair $(i, j)$ appearing aligned in the source protein blocks, while $q_i$ and $q_j$ are the individual background frequencies of the amino acids $i$ and $j$ in the dataset. The scaling factor $\\frac{2}{\\ln(2)}$ is used to express the final score in units of \"half-bits.\"\n\nYou are tasked with calculating the self-alignment score for the amino acid Cysteine (Cys) in this new CytoBLOSUM matrix. Cysteine is biochemically notable for its ability to form structural disulfide bonds, a process that occurs predominantly in oxidizing environments outside the cytosol. The frequency analysis of the team's cytosolic protein alignment data has yielded the following values for Cysteine:\n- Background frequency of Cys, $q_{C,cyto} = 0.018$\n- Observed pair frequency of Cys-Cys, $p_{CC,cyto} = 0.0010$\n\nUsing the provided formula and data, calculate the Cys-Cys diagonal score ($S_{CC}$) for the CytoBLOSUM matrix. Round your final answer to three significant figures.", "solution": "The substitution score is defined as the scaled log-odds ratio:\n$$S_{ij} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{p_{ij}}{q_{i} q_{j}}\\right).$$\nFor the Cys-Cys diagonal entry, set $i=j=C$, giving\n$$S_{CC} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{p_{CC}}{q_{C}^{2}}\\right).$$\nInsert the given frequencies $p_{CC} = 0.0010$ and $q_{C} = 0.018$:\n$$q_{C}^{2} = (0.018)^{2} = 0.000324,$$\n$$\\frac{p_{CC}}{q_{C}^{2}} = \\frac{0.0010}{0.000324} = \\frac{1000}{324} = \\frac{250}{81}.$$\nTherefore,\n$$S_{CC} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{250}{81}\\right).$$\nFor a numerical value,\n$$\\ln\\left(\\frac{250}{81}\\right) \\approx \\ln(3.086419753) \\approx 1.127011775,$$\n$$\\frac{2}{\\ln 2} \\approx 2.885390082,$$\nso\n$$S_{CC} \\approx 2.885390082 \\times 1.127011775 \\approx 3.251868564.$$\nRounded to three significant figures, the Cys-Cys score is $3.25$ (in half-bits).", "answer": "$$\\boxed{3.25}$$", "id": "2136035"}, {"introduction": "Substitution matrices can be derived not only from observed alignments but also from fundamental biophysical principles. This advanced practice [@problem_id:2432240] explores how a scoring system can be built from scratch using a model based on amino acid hydropathy, a key physicochemical property. By working through the normalization and calculation of a score in this custom matrix, you will gain insight into how alignment tools can be designed to capture specific structural or functional similarities, showcasing the true flexibility of the log-odds scoring paradigm.", "problem": "You are given a reduced alphabet of amino acids $\\{A, V, I, D, K\\}$ with hydropathy values $h(a)$ on the Kyteâ€“Doolittle scale: $h(A)=1.8$, $h(V)=4.2$, $h(I)=4.5$, $h(D)=-3.5$, $h(K)=-3.9$. Assume background (independent) amino acid frequencies $p(A)=0.30$, $p(V)=0.25$, $p(I)=0.20$, $p(D)=0.15$, $p(K)=0.10$. Consider a target joint distribution for aligned residue pairs defined by\n$$\nP(a,b) \\;=\\; \\frac{1}{Z}\\,p(a)\\,p(b)\\,\\exp\\!\\big(-\\beta\\,|h(a)-h(b)|\\big),\n$$\nwhere $\\beta=0.5$ and $Z$ is the unique normalizing constant such that $\\sum_{a}\\sum_{b} P(a,b)=1$. Define the substitution score in natural log-odds units (nats) by\n$$\nS(a,b)\\;=\\;\\ln\\!\\left(\\frac{P(a,b)}{p(a)\\,p(b)}\\right).\n$$\nCompute the substitution score $S(V,I)$ implied by this model. Use the natural logarithm and round your final answer to $4$ significant figures. Express the result as a pure number in nats (do not include units).", "solution": "The substitution score $S(a,b)$ is defined in nats (natural log-odds units) as:\n$$\nS(a,b) = \\ln\\left(\\frac{P(a,b)}{p(a)\\,p(b)}\\right)\n$$\nWe are given the model for the joint probability $P(a,b)$:\n$$\nP(a,b) = \\frac{1}{Z}\\,p(a)\\,p(b)\\,\\exp(-\\beta\\,|h(a)-h(b)|)\n$$\nwhere $Z$ is a normalization constant. Substituting the expression for $P(a,b)$ into the definition of $S(a,b)$ yields:\n$$\nS(a,b) = \\ln\\left(\\frac{\\frac{1}{Z}\\,p(a)\\,p(b)\\,\\exp(-\\beta\\,|h(a)-h(b)|)}{p(a)\\,p(b)}\\right)\n$$\nThe background frequencies $p(a)$ and $p(b)$ in the numerator and denominator cancel out, which simplifies the expression significantly:\n$$\nS(a,b) = \\ln\\left(\\frac{1}{Z}\\,\\exp(-\\beta\\,|h(a)-h(b)|)\\right)\n$$\nUsing the properties of logarithms, $\\ln(x y) = \\ln(x)+\\ln(y)$ and $\\ln(1/x) = -\\ln(x)$, we obtain:\n$$\nS(a,b) = \\ln\\left(\\frac{1}{Z}\\right) + \\ln\\left(\\exp(-\\beta\\,|h(a)-h(b)|)\\right) = -\\ln(Z) - \\beta\\,|h(a)-h(b)|\n$$\nTo compute $S(V,I)$, we must first determine the value of the normalization constant $Z$. By definition, the sum of all probabilities must be $1$:\n$$\n\\sum_{a,b \\in \\mathcal{A}} P(a,b) = \\sum_{a,b \\in \\mathcal{A}} \\frac{1}{Z}\\,p(a)\\,p(b)\\,\\exp(-\\beta\\,|h(a)-h(b)|) = 1\n$$\nwhere $\\mathcal{A} = \\{A, V, I, D, K\\}$. Solving for $Z$ gives:\n$$\nZ = \\sum_{a,b \\in \\mathcal{A}} p(a)\\,p(b)\\,\\exp(-\\beta\\,|h(a)-h(b)|)\n$$\nThis is a double summation over all $5 \\times 5 = 25$ pairs of amino acids in the reduced alphabet. The sum can be separated into diagonal ($a=b$) and off-diagonal ($a \\neq b$) terms. Since $|h(a)-h(b)| = |h(b)-h(a)|$, the matrix of terms is symmetric. We can write:\n$$\nZ = \\sum_{a \\in \\mathcal{A}} p(a)^2\\exp(-\\beta|h(a)-h(a)|) + \\sum_{a \\neq b} p(a)p(b)\\exp(-\\beta|h(a)-h(b)|)\n$$\nSince $|h(a)-h(a)| = 0$, $\\exp(0)=1$, so the first term simplifies to $\\sum_{a \\in \\mathcal{A}} p(a)^2$.\nThe diagonal sum is:\n$$\np(A)^2 + p(V)^2 + p(I)^2 + p(D)^2 + p(K)^2 = (0.30)^2 + (0.25)^2 + (0.20)^2 + (0.15)^2 + (0.10)^2\n$$\n$$\n= 0.09 + 0.0625 + 0.04 + 0.0225 + 0.01 = 0.225\n$$\nThe off-diagonal terms are calculated for each pair $(a,b)$ where $a \\neq b$. It is more efficient to sum over pairs where $a$ comes before $b$ in some ordering (e.g., alphabetical) and multiply by $2$.\nThe required hydropathy differences $|h(a)-h(b)|$ and exponential terms $\\exp(-0.5|h(a)-h(b)|)$ are:\n- $|h(A)-h(V)| = |1.8 - 4.2| = 2.4 \\implies \\exp(-1.2)$\n- $|h(A)-h(I)| = |1.8 - 4.5| = 2.7 \\implies \\exp(-1.35)$\n- $|h(A)-h(D)| = |1.8 - (-3.5)| = 5.3 \\implies \\exp(-2.65)$\n- $|h(A)-h(K)| = |1.8 - (-3.9)| = 5.7 \\implies \\exp(-2.85)$\n- $|h(V)-h(I)| = |4.2 - 4.5| = 0.3 \\implies \\exp(-0.15)$\n- $|h(V)-h(D)| = |4.2 - (-3.5)| = 7.7 \\implies \\exp(-3.85)$\n- $|h(V)-h(K)| = |4.2 - (-3.9)| = 8.1 \\implies \\exp(-4.05)$\n- $|h(I)-h(D)| = |4.5 - (-3.5)| = 8.0 \\implies \\exp(-4.0)$\n- $|h(I)-h(K)| = |4.5 - (-3.9)| = 8.4 \\implies \\exp(-4.2)$\n- $|h(D)-h(K)| = |-3.5 - (-3.9)| = 0.4 \\implies \\exp(-0.2)$\n\nThe sum of off-diagonal terms is $2 \\sum_{ab} p(a)p(b)\\exp(-0.5|h(a)-h(b)|)$:\n$2 \\times [ p(A)p(V)\\exp(-1.2) + p(A)p(I)\\exp(-1.35) + p(A)p(D)\\exp(-2.65) + p(A)p(K)\\exp(-2.85) + p(V)p(I)\\exp(-0.15) + p(V)p(D)\\exp(-3.85) + p(V)p(K)\\exp(-4.05) + p(I)p(D)\\exp(-4.0) + p(I)p(K)\\exp(-4.2) + p(D)p(K)\\exp(-0.2) ]$\n$= 2 \\times [ (0.3)(0.25)\\exp(-1.2) + (0.3)(0.2)\\exp(-1.35) + (0.3)(0.15)\\exp(-2.65) + (0.3)(0.1)\\exp(-2.85) + (0.25)(0.2)\\exp(-0.15) + (0.25)(0.15)\\exp(-3.85) + (0.25)(0.1)\\exp(-4.05) + (0.2)(0.15)\\exp(-4.0) + (0.2)(0.1)\\exp(-4.2) + (0.15)(0.1)\\exp(-0.2) ]$\n$= 2 \\times [ 0.075(0.30119) + 0.06(0.25924) + 0.045(0.07065) + 0.03(0.05785) + 0.05(0.86071) + 0.0375(0.02128) + 0.025(0.01742) + 0.03(0.01832) + 0.02(0.01500) + 0.015(0.81873) ]$\n$= 2 \\times [ 0.022589 + 0.015554 + 0.003179 + 0.001736 + 0.043036 + 0.000798 + 0.000436 + 0.000550 + 0.000300 + 0.012281 ]$\n$= 2 \\times [ 0.100459 ] = 0.200918$\n\nNow, we calculate $Z$ by adding the diagonal and off-diagonal contributions:\n$$\nZ = 0.225 + 0.200918 = 0.425918\n$$\nWith $Z$ computed, we can find $S(V,I)$. We need the specific hydropathy difference for this pair:\n$$\n|h(V)-h(I)| = |4.2 - 4.5| = 0.3\n$$\nThe value of $\\beta$ is given as $0.5$. Thus, the second term in the score equation is:\n$$\n\\beta|h(V)-h(I)| = 0.5 \\times 0.3 = 0.15\n$$\nThe first term is $-\\ln(Z)$:\n$$\n-\\ln(Z) = -\\ln(0.425918) \\approx -(-0.853467) = 0.853467\n$$\nFinally, we compute the substitution score for $(V,I)$:\n$$\nS(V,I) = -\\ln(Z) - \\beta|h(V)-h(I)| \\approx 0.853467 - 0.15 = 0.703467\n$$\nThe problem requires the answer to be rounded to $4$ significant figures.\n$$\nS(V,I) \\approx 0.7035\n$$\nThis result is positive, indicating that a substitution between Valine ($V$) and Isoleucine ($I$) is more probable than expected by chance under this model, which is consistent with their similar hydropathic character.", "answer": "$$\n\\boxed{0.7035}\n$$", "id": "2432240"}]}