{"hands_on_practices": [{"introduction": "Before we can ask a computer to find the best alignment between two sequences, we must first define what \"best\" means. This is achieved through a scoring scheme, a set of rules that assign a numerical value to an alignment. This first exercise provides a direct, hands-on opportunity to apply a simple scoring scheme to a pre-existing alignment, helping to solidify the fundamental arithmetic behind how we quantify sequence similarity [@problem_id:2136319].", "problem": "In bioinformatics, sequence alignment is a fundamental method for comparing two or more biological sequences. The quality of an alignment is often quantified by a scoring system. Consider the following gapped alignment of two short peptide sequences, represented using standard one-letter amino acid codes. A hyphen (`-`) is used to represent a gap.\n\nSequence 1: `M A V L I S Q R T V K`\nSequence 2: `M G V L - S R Q T - K`\n\nA simple scoring scheme is employed to evaluate this alignment. The rules are as follows:\n- A match, where the amino acids in a column are identical, receives a score of `+5`.\n- A mismatch, where the amino acids in a column are different, receives a score of `-3`.\n- A gap, where an amino acid is aligned with a gap character (`-`), incurs a penalty of `-8`.\n\nBased on this scoring scheme, calculate the total alignment score for the given pairwise alignment.", "solution": "To calculate the total alignment score, we need to analyze the alignment column by column and sum the scores for each position according to the provided scoring scheme.\n\nThe given alignment is:\nSequence 1: `M A V L I S Q R T V K`\nSequence 2: `M G V L - S R Q T - K`\n\nThe scoring rules are:\n- Match score = `+5`\n- Mismatch score = `-3`\n- Gap penalty = `-8`\n\nLet's iterate through the 11 columns of the alignment and determine the type of alignment at each position (match, mismatch, or gap).\n\n1.  Position 1: `M` vs `M`. This is a **match**.\n2.  Position 2: `A` vs `G`. This is a **mismatch**.\n3.  Position 3: `V` vs `V`. This is a **match**.\n4.  Position 4: `L` vs `L`. This is a **match**.\n5.  Position 5: `I` vs `-`. This is a **gap**.\n6.  Position 6: `S` vs `S`. This is a **match**.\n7.  Position 7: `Q` vs `R`. This is a **mismatch**.\n8.  Position 8: `R` vs `Q`. This is a **mismatch**.\n9.  Position 9: `T` vs `T`. This is a **match**.\n10. Position 10: `V` vs `-`. This is a **gap**.\n11. Position 11: `K` vs `K`. This is a **match**.\n\nNext, we count the total number of matches, mismatches, and gaps.\n-   Number of matches = 6 (at positions 1, 3, 4, 6, 9, 11)\n-   Number of mismatches = 3 (at positions 2, 7, 8)\n-   Number of gaps = 2 (at positions 5, 10)\n\nNow, we calculate the total score by multiplying the counts by their respective scores and summing the results.\n\nTotal Score = (Number of matches * Match score) + (Number of mismatches * Mismatch score) + (Number of gaps * Gap penalty)\n\nSubstituting the values:\nTotal Score = $(6 \\times 5) + (3 \\times (-3)) + (2 \\times (-8))$\nTotal Score = $30 - 9 - 16$\nTotal Score = $21 - 16$\nTotal Score = $5$\n\nThus, the total alignment score for the given alignment is 5.", "answer": "$$\\boxed{5}$$", "id": "2136319"}, {"introduction": "The scores for matches, mismatches, and gaps are not arbitrary; they are derived from statistical evidence gathered from large datasets of related proteins. This practice delves into the theoretical heart of modern substitution matrices like BLOSUM by guiding you through the calculation of log-odds scores. By working through this hypothetical scenario with a simplified alphabet, you will understand how these scores represent the likelihood of a particular substitution occurring due to evolution versus by random chance [@problem_id:2371031].", "problem": "You are given a simplified residue alphabet with two physicochemical categories: hydrophobic ($\\mathrm{H}$) and polar ($\\mathrm{P}$). From a curated set of homologous protein sequence alignments, the following ordered aligned-pair counts were observed across $N$ aligned positions: $\\mathrm{H}$–$\\mathrm{H}$ pairs: $2800$, $\\mathrm{H}$–$\\mathrm{P}$ pairs: $1200$, $\\mathrm{P}$–$\\mathrm{H}$ pairs: $1200$, and $\\mathrm{P}$–$\\mathrm{P}$ pairs: $4800$, where $N = 2800 + 1200 + 1200 + 4800$. Separately, background composition estimated from a large nonredundant protein database gives $\\Pr(\\mathrm{H}) = 0.40$ and $\\Pr(\\mathrm{P}) = 0.60$.\n\nBy definition, the log-odds substitution score for an aligned pair $(a,b)$ is $s(a,b) = \\ln\\!\\big(q_{ab} / (p_{a} p_{b})\\big)$, where $q_{ab}$ is the joint probability of observing the ordered aligned pair $(a,b)$ in homologous alignments and $p_{a}$ is the background probability of residue class $a$. Use the natural logarithm for $\\ln(\\cdot)$ in your computations.\n\nCompute the log-odds scores $s(\\mathrm{H},\\mathrm{H})$, $s(\\mathrm{H},\\mathrm{P})$, $s(\\mathrm{P},\\mathrm{H})$, and $s(\\mathrm{P},\\mathrm{P})$. Report your final numeric scores in the order $s(\\mathrm{H},\\mathrm{H})$, $s(\\mathrm{H},\\mathrm{P})$, $s(\\mathrm{P},\\mathrm{H})$, $s(\\mathrm{P},\\mathrm{P})$ as a single row matrix, rounding each entry to four significant figures.", "solution": "The problem requires the computation of log-odds substitution scores for a simplified two-character alphabet, {$\\mathrm{H}$, $\\mathrm{P}$}, representing hydrophobic and polar residues.\n\nFirst, the validity of the problem statement is established. All necessary data are provided, the definitions are clear and standard in the field of bioinformatics, and the problem is scientifically sound and well-posed. There are no contradictions or ambiguities.\n\nThe log-odds score, $s(a,b)$, for an aligned pair of residues $(a,b)$ is defined as:\n$$s(a,b) = \\ln\\left( \\frac{q_{ab}}{p_{a} p_{b}} \\right)$$\nwhere $q_{ab}$ is the target frequency of observing the ordered pair $(a,b)$ in alignments of homologous sequences, and $p_a$ and $p_b$ are the background frequencies of observing residues $a$ and $b$, respectively, in a large, general protein database.\n\nThe given data are:\n- Observed counts for aligned pairs:\n  - $C(\\mathrm{H},\\mathrm{H}) = 2800$\n  - $C(\\mathrm{H},\\mathrm{P}) = 1200$\n  - $C(\\mathrm{P},\\mathrm{H}) = 1200$\n  - $C(\\mathrm{P},\\mathrm{P}) = 4800$\n- Background probabilities:\n  - $p_{\\mathrm{H}} = 0.40$\n  - $p_{\\mathrm{P}} = 0.60$\n\nThe first step is to calculate the total number of aligned positions, $N$, from the given counts.\n$$N = C(\\mathrm{H},\\mathrm{H}) + C(\\mathrm{H},\\mathrm{P}) + C(\\mathrm{P},\\mathrm{H}) + C(\\mathrm{P},\\mathrm{P})$$\n$$N = 2800 + 1200 + 1200 + 4800 = 10000$$\n\nNext, we compute the target frequencies, $q_{ab}$, by dividing the observed count for each pair by the total number of positions $N$.\n$$q_{\\mathrm{HH}} = \\frac{C(\\mathrm{H},\\mathrm{H})}{N} = \\frac{2800}{10000} = 0.28$$\n$$q_{\\mathrm{HP}} = \\frac{C(\\mathrm{H},\\mathrm{P})}{N} = \\frac{1200}{10000} = 0.12$$\n$$q_{\\mathrm{PH}} = \\frac{C(\\mathrm{P},\\mathrm{H})}{N} = \\frac{1200}{10000} = 0.12$$\n$$q_{\\mathrm{PP}} = \\frac{C(\\mathrm{P},\\mathrm{P})}{N} = \\frac{4800}{10000} = 0.48$$\n\nNow, we compute the expected frequencies, $p_a p_b$, for each pair based on the background probabilities. These represent the frequencies expected by random chance.\n$$p_{\\mathrm{H}} p_{\\mathrm{H}} = (0.40)(0.40) = 0.16$$\n$$p_{\\mathrm{H}} p_{\\mathrm{P}} = (0.40)(0.60) = 0.24$$\n$$p_{\\mathrm{P}} p_{\\mathrm{H}} = (0.60)(0.40) = 0.24$$\n$$p_{\\mathrm{P}} p_{\\mathrm{P}} = (0.60)(0.60) = 0.36$$\n\nWith all components calculated, we can determine the log-odds score for each pair. The natural logarithm, $\\ln(\\cdot)$, is used as specified.\n\nFor the H–H pair:\n$$s(\\mathrm{H},\\mathrm{H}) = \\ln\\left( \\frac{q_{\\mathrm{HH}}}{p_{\\mathrm{H}} p_{\\mathrm{H}}} \\right) = \\ln\\left( \\frac{0.28}{0.16} \\right) = \\ln(1.75)$$\n$$s(\\mathrm{H},\\mathrm{H}) \\approx 0.5596157...$$\nRounding to four significant figures, $s(\\mathrm{H},\\mathrm{H}) \\approx 0.5596$. A positive score indicates that this pairing occurs more frequently in homologous alignments than expected by chance, suggesting it is a favorable substitution.\n\nFor the H–P pair:\n$$s(\\mathrm{H},\\mathrm{P}) = \\ln\\left( \\frac{q_{\\mathrm{HP}}}{p_{\\mathrm{H}} p_{\\mathrm{P}}} \\right) = \\ln\\left( \\frac{0.12}{0.24} \\right) = \\ln(0.5)$$\n$$s(\\mathrm{H},\\mathrm{P}) \\approx -0.6931471...$$\nRounding to four significant figures, $s(\\mathrm{H},\\mathrm{P}) \\approx -0.6931$. A negative score indicates that this pairing is disfavored.\n\nFor the P–H pair:\n$$s(\\mathrm{P},\\mathrm{H}) = \\ln\\left( \\frac{q_{\\mathrm{PH}}}{p_{\\mathrm{P}} p_{\\mathrm{H}}} \\right) = \\ln\\left( \\frac{0.12}{0.24} \\right) = \\ln(0.5)$$\n$$s(\\mathrm{P},\\mathrm{H}) \\approx -0.6931471...$$\nRounding to four significant figures, $s(\\mathrm{P},\\mathrm{H}) \\approx -0.6931$. As expected, this is identical to $s(\\mathrm{H},\\mathrm{P})$ because the underlying counts and background probabilities are symmetric.\n\nFor the P–P pair:\n$$s(\\mathrm{P},\\mathrm{P}) = \\ln\\left( \\frac{q_{\\mathrm{PP}}}{p_{\\mathrm{P}} p_{\\mathrm{P}}} \\right) = \\ln\\left( \\frac{0.48}{0.36} \\right) = \\ln\\left( \\frac{4}{3} \\right)$$\n$$s(\\mathrm{P},\\mathrm{P}) \\approx 0.2876820...$$\nRounding to four significant figures, $s(\\mathrm{P},\\mathrm{P}) \\approx 0.2877$. This positive score indicates a favored pairing.\n\nThe computed scores, rounded to four significant figures, are $s(\\mathrm{H},\\mathrm{H}) = 0.5596$, $s(\\mathrm{H},\\mathrm{P}) = -0.6931$, $s(\\mathrm{P},\\mathrm{H}) = -0.6931$, and $s(\\mathrm{P},\\mathrm{P}) = 0.2877$.\nThe problem requests these values to be reported in a single row matrix in this specific order.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5596 & -0.6931 & -0.6931 & 0.2877\n\\end{pmatrix}\n}\n$$", "id": "2371031"}, {"introduction": "Scoring schemes can be tailored to reflect specific biological hypotheses. This exercise introduces a sophisticated, codon-based scoring model that distinguishes between changes at the DNA level that alter the resulting amino acid (non-synonymous) and those that do not (synonymous). By calculating a score based on these evolutionarily significant categories, you will gain a deeper appreciation for how alignment scoring can be adapted to investigate molecular evolution, moving beyond simple residue-to-residue comparisons [@problem_id:2370992].", "problem": "Two protein-coding deoxyribonucleic acid (DNA) sequences are aligned in-frame, codon-by-codon, with no insertions or deletions. Consider the following two sequences (written as contiguous codons, left to right):\n\n- Sequence A: GCT GCT GGT TCT GAA ATG TGT GTT\n- Sequence B: GCT GCC GGA AGC GAC ATA TAT GAT\n\nFor the codons that appear in these sequences, use the following mapping from codon to amino acid (standard genetic code, restricted to the codons present here):\n- GCT, GCC: Alanine\n- GGT, GGA: Glycine\n- TCT, AGC: Serine\n- GAA: Glutamate\n- GAC, GAT: Aspartate\n- ATG: Methionine\n- ATA: Isoleucine\n- TGT: Cysteine\n- TAT: Tyrosine\n- GTT: Valine\n\nDefine the substitution score for each aligned codon pair as follows:\n- If the codons are identical, add $+6$.\n- If the codons are different but encode the same amino acid (synonymous change), then for each nucleotide difference between the two codons: add $-1$ for a transition and $-2$ for a transversion.\n- If the codons encode different amino acids (non-synonymous change), then for each nucleotide difference between the two codons: add $-3$ for a transition and $-4$ for a transversion.\n\nA transition is a change between purines (A $\\leftrightarrow$ G) or between pyrimidines (C $\\leftrightarrow$ T). A transversion is any change between a purine and a pyrimidine (A $\\leftrightarrow$ C, A $\\leftrightarrow$ T, G $\\leftrightarrow$ C, G $\\leftrightarrow$ T).\n\nCompute the total alignment score by summing the substitution scores over all aligned codon pairs. Report the total as a single integer (no rounding needed).", "solution": "The problem statement must first be validated for scientific soundness, completeness, and objectivity.\n\nStep 1: Extract Givens\n- Sequence A: GCT GCT GGT TCT GAA ATG TGT GTT\n- Sequence B: GCT GCC GGA AGC GAC ATA TAT GAT\n- Sequences are aligned in-frame, codon-by-codon, with no gaps.\n- Codon to Amino Acid Mapping:\n    - GCT, GCC $\\rightarrow$ Alanine\n    - GGT, GGA $\\rightarrow$ Glycine\n    - TCT, AGC $\\rightarrow$ Serine\n    - GAA $\\rightarrow$ Glutamate\n    - GAC, GAT $\\rightarrow$ Aspartate\n    - ATG $\\rightarrow$ Methionine\n    - ATA $\\rightarrow$ Isoleucine\n    - TGT $\\rightarrow$ Cysteine\n    - TAT $\\rightarrow$ Tyrosine\n    - GTT $\\rightarrow$ Valine\n- Substitution Scoring Rules:\n    - Identical codons: score is $+6$.\n    - Synonymous change (different codons, same amino acid):\n        - For each transition: add $-1$.\n        - For each transversion: add $-2$.\n    - Non-synonymous change (different amino acids):\n        - For each transition: add $-3$.\n        - For each transversion: add $-4$.\n- Definitions:\n    - Transition: A $\\leftrightarrow$ G (purine $\\leftrightarrow$ purine), or C $\\leftrightarrow$ T (pyrimidine $\\leftrightarrow$ pyrimidine).\n    - Transversion: Purine $\\leftrightarrow$ Pyrimidine (A $\\leftrightarrow$ C, A $\\leftrightarrow$ T, G $\\leftrightarrow$ C, G $\\leftrightarrow$ T).\n- Task: Compute the total alignment score by summing the scores for all aligned codon pairs.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. It presents a simplified but coherent model for scoring DNA sequence alignments based on codon substitutions, a fundamental concept in computational biology and molecular evolution. The definitions of codons, amino acids, transitions, and transversions are standard and correct. The problem is well-posed, providing all necessary data and a deterministic set of rules to compute a single, unique numerical answer. The language is objective and unambiguous. The problem does not violate any of the invalidity criteria.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A solution will be derived.\n\nThe total alignment score, $S_{total}$, is the sum of the scores for each of the $8$ aligned codon pairs. We will analyze each pair systematically.\n\nThe two sequences are:\n- Sequence A: $S_A = (\\text{GCT, GCT, GGT, TCT, GAA, ATG, TGT, GTT})$\n- Sequence B: $S_B = (\\text{GCT, GCC, GGA, AGC, GAC, ATA, TAT, GAT})$\n\nLet us denote the score for the $i$-th codon pair as $s_i$.\n\n1.  Pair 1: $\\text{GCT}$ vs $\\text{GCT}$\n    - The codons are identical.\n    - Amino acids: Alanine vs Alanine.\n    - According to the rule, the score is $s_1 = +6$.\n\n2.  Pair 2: $\\text{GCT}$ vs $\\text{GCC}$\n    - The codons are different.\n    - Amino acids: GCT $\\rightarrow$ Alanine, GCC $\\rightarrow$ Alanine. This is a synonymous change.\n    - We must examine the nucleotide differences. The third position differs: T $\\rightarrow$ C.\n    - The change T $\\leftrightarrow$ C is a pyrimidine-to-pyrimidine substitution, which is a transition.\n    - The score for one synonymous transition is $-1$.\n    - $s_2 = -1$.\n\n3.  Pair 3: $\\text{GGT}$ vs $\\text{GGA}$\n    - The codons are different.\n    - Amino acids: GGT $\\rightarrow$ Glycine, GGA $\\rightarrow$ Glycine. This is a synonymous change.\n    - The third position differs: T $\\rightarrow$ A.\n    - The change T (pyrimidine) $\\leftrightarrow$ A (purine) is a transversion.\n    - The score for one synonymous transversion is $-2$.\n    - $s_3 = -2$.\n\n4.  Pair 4: $\\text{TCT}$ vs $\\text{AGC}$\n    - The codons are different.\n    - Amino acids: TCT $\\rightarrow$ Serine, AGC $\\rightarrow$ Serine. This is a synonymous change.\n    - We examine the differences at each position:\n        - Position 1: T $\\rightarrow$ A. This is a pyrimidine-to-purine change, a transversion. Score contribution: $-2$.\n        - Position 2: C $\\rightarrow$ G. This is a pyrimidine-to-purine change, a transversion. Score contribution: $-2$.\n        - Position 3: T $\\rightarrow$ C. This is a pyrimidine-to-pyrimidine change, a transition. Score contribution: $-1$.\n    - The total score for this pair is the sum of the penalties for each nucleotide difference: $s_4 = (-2) + (-2) + (-1) = -5$.\n\n5.  Pair 5: $\\text{GAA}$ vs $\\text{GAC}$\n    - The codons are different.\n    - Amino acids: GAA $\\rightarrow$ Glutamate, GAC $\\rightarrow$ Aspartate. This is a non-synonymous change.\n    - The third position differs: A $\\rightarrow$ C.\n    - The change A (purine) $\\leftrightarrow$ C (pyrimidine) is a transversion.\n    - The score for one non-synonymous transversion is $-4$.\n    - $s_5 = -4$.\n\n6.  Pair 6: $\\text{ATG}$ vs $\\text{ATA}$\n    - The codons are different.\n    - Amino acids: ATG $\\rightarrow$ Methionine, ATA $\\rightarrow$ Isoleucine. This is a non-synonymous change.\n    - The third position differs: G $\\rightarrow$ A.\n    - The change G $\\leftrightarrow$ A is a purine-to-purine substitution, which is a transition.\n    - The score for one non-synonymous transition is $-3$.\n    - $s_6 = -3$.\n\n7.  Pair 7: $\\text{TGT}$ vs $\\text{TAT}$\n    - The codons are different.\n    - Amino acids: TGT $\\rightarrow$ Cysteine, TAT $\\rightarrow$ Tyrosine. This is a non-synonymous change.\n    - The second position differs: G $\\rightarrow$ A.\n    - The change G $\\leftrightarrow$ A is a purine-to-purine substitution, a transition.\n    - The score for one non-synonymous transition is $-3$.\n    - $s_7 = -3$.\n\n8.  Pair 8: $\\text{GTT}$ vs $\\text{GAT}$\n    - The codons are different.\n    - Amino acids: GTT $\\rightarrow$ Valine, GAT $\\rightarrow$ Aspartate. This is a non-synonymous change.\n    - The second position differs: T $\\rightarrow$ A.\n    - The change T (pyrimidine) $\\leftrightarrow$ A (purine) is a transversion.\n    - The score for one non-synonymous transversion is $-4$.\n    - $s_8 = -4$.\n\nFinally, the total alignment score $S_{total}$ is the sum of the individual scores:\n$$S_{total} = \\sum_{i=1}^{8} s_i = s_1 + s_2 + s_3 + s_4 + s_5 + s_6 + s_7 + s_8$$\n$$S_{total} = 6 + (-1) + (-2) + (-5) + (-4) + (-3) + (-3) + (-4)$$\n$$S_{total} = 6 - 1 - 2 - 5 - 4 - 3 - 3 - 4$$\n$$S_{total} = 6 - (1 + 2 + 5 + 4 + 3 + 3 + 4) = 6 - 22$$\n$$S_{total} = -16$$\nThe total alignment score is $-16$.", "answer": "$$\\boxed{-16}$$", "id": "2370992"}]}