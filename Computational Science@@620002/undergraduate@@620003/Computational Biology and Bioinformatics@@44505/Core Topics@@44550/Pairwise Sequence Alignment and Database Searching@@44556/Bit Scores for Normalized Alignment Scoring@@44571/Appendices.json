{"hands_on_practices": [{"introduction": "This exercise solidifies your understanding of the mathematical relationship between the raw score $S$ and the bit score $S'$. By exploring the specific, hypothetical condition where these two scores are identical, you will determine the unique values of the statistical parameters $\\lambda$ and $K$ that make the normalization formula an identity function. This practice deepens your grasp of how these parameters define the linear transformation from a raw score to a normalized bit score. [@problem_id:2375714]", "problem": "In pairwise local sequence alignment under the Karlin–Altschul statistical framework, consider any fixed substitution scoring matrix with entries $s_{ij}$ over a finite alphabet and an affine gap penalty model with gap-opening penalty $g$ and gap-extension penalty $h$, both strictly positive. For any alignment under this scoring system, the raw alignment score is $S$. The bit score $S'$ for an alignment is defined by\n$$\nS' \\;=\\; \\frac{\\lambda S - \\ln K}{\\ln 2},\n$$\nwhere $\\lambda$ and $K$ are the Karlin–Altschul parameters associated with the chosen scoring matrix, gap penalties, and background letter frequencies.\n\nCharacterize the class of scoring matrices and affine gap penalties for which the equality $S' = S$ holds for every possible alignment produced under that scoring system. In particular, determine the necessary and sufficient values of $\\lambda$ and $K$ that enforce $S' = S$ for all raw scores $S$ arising from the system. Express your final answer as the ordered pair $(\\lambda, K)$. No rounding is required.", "solution": "The problem requires us to determine the necessary and sufficient values of the Karlin–Altschul parameters $\\lambda$ and $K$ for which the bit score $S'$ is equal to the raw score $S$ for every possible alignment.\n\nFirst, we perform the problem validation.\n\nStep 1: Extract Givens.\n- The context is pairwise local sequence alignment under the Karlin–Altschul statistical framework.\n- The scoring system consists of a substitution matrix with entries $s_{ij}$ and an affine gap penalty model with gap-opening penalty $g > 0$ and gap-extension penalty $h > 0$.\n- The raw alignment score is denoted by $S$.\n- The bit score $S'$ is defined by the relation:\n$$ S' = \\frac{\\lambda S - \\ln K}{\\ln 2} $$\nwhere $\\lambda$ and $K$ are the Karlin–Altschul statistical parameters.\n- The condition to be satisfied is $S' = S$ for *every possible alignment score* $S$ produced by the given scoring system.\n\nStep 2: Validate Using Extracted Givens.\n- The problem is **Scientifically Grounded**. The definitions of bit score, raw score, and the Karlin–Altschul parameters are standard in the field of bioinformatics.\n- The problem is **Well-Posed**. It asks for specific values of parameters that satisfy a well-defined mathematical identity.\n- The problem is **Objective**. The language is precise and devoid of any subjectivity.\n- The problem does not violate any of the criteria for invalidity. It is a formalizable, complete, and logically consistent problem within its scientific domain.\n\nStep 3: Verdict and Action.\nThe problem is deemed **valid**. A solution will be provided.\n\nThe core of the problem is the condition that the equality $S' = S$ must hold for any and all raw scores $S$ that can be generated by the specified scoring system. We begin by substituting the definition of $S'$ into this equality:\n$$ S = \\frac{\\lambda S - \\ln K}{\\ln 2} $$\nThis equation must be satisfied for all possible values of $S$. We can rearrange this equation to isolate the terms involving $S$:\n$$ S \\ln 2 = \\lambda S - \\ln K $$\nMoving all terms to one side yields a linear equation in the variable $S$:\n$$ S \\ln 2 - \\lambda S + \\ln K = 0 $$\n$$ S (\\ln 2 - \\lambda) + \\ln K = 0 $$\nLet us analyze this equation. It is of the form $aS + b = 0$, where the coefficient $a = \\ln 2 - \\lambda$ and the constant term $b = \\ln K$. The problem states that this equality must hold for *every possible alignment score* $S$.\n\nFor any non-trivial scoring system (i.e., one where not all possible alignments result in the exact same score), there will be at least two different possible values for the raw score $S$. Let us denote two such distinct scores as $S_1$ and $S_2$, with $S_1 \\neq S_2$. According to the problem's condition, the equation must hold for both scores:\n1. $S_1 (\\ln 2 - \\lambda) + \\ln K = 0$\n2. $S_2 (\\ln 2 - \\lambda) + \\ln K = 0$\n\nSubtracting the second equation from the first gives:\n$$ (S_1 - S_2) (\\ln 2 - \\lambda) = 0 $$\nSince we have established that $S_1 \\neq S_2$ for a non-trivial system, the term $(S_1 - S_2)$ is non-zero. Therefore, for the product to be zero, the other factor must be zero:\n$$ \\ln 2 - \\lambda = 0 $$\nThis gives us the value for $\\lambda$:\n$$ \\lambda = \\ln 2 $$\nNow that we have determined the value of the coefficient of $S$, we can substitute it back into the original equation $S (\\ln 2 - \\lambda) + \\ln K = 0$. This yields:\n$$ S (0) + \\ln K = 0 $$\n$$ \\ln K = 0 $$\nThis provides the value for $K$:\n$$ K = \\exp(0) = 1 $$\nThese conditions, $\\lambda = \\ln 2$ and $K = 1$, are necessary. To confirm they are also sufficient, we can substitute them back into the original relation $S' = S$:\n$$ S = \\frac{(\\ln 2) S - \\ln 1}{\\ln 2} $$\n$$ S = \\frac{S \\ln 2 - 0}{\\ln 2} $$\n$$ S = \\frac{S \\ln 2}{\\ln 2} $$\n$$ S = S $$\nThis is a tautology, which is true for any value of $S$. Therefore, the derived values of $\\lambda$ and $K$ are both necessary and sufficient.\n\nThe class of scoring matrices and affine gap penalties for which this equality holds is precisely the set of systems that result in Karlin–Altschul parameters $\\lambda = \\ln 2$ and $K = 1$. The problem asks for the values of $\\lambda$ and $K$, which we have determined. The final answer is the ordered pair $(\\lambda, K)$.", "answer": "$$\\boxed{\\begin{pmatrix} \\ln 2 & 1 \\end{pmatrix}}$$", "id": "2375714"}, {"introduction": "This practice explores the core motivation behind using bit scores: creating a universal currency for alignment significance. You will investigate how uniformly scaling a substitution matrix, such as BLOSUM62, affects the raw score $S$ and the statistical parameters $\\lambda$ and $K$. This exercise reveals the elegant invariance of the bit score $S'$, demonstrating why it is a superior measure for comparing results across different searches or scoring systems. [@problem_id:2375719]", "problem": "Consider local, ungapped alignments between two independent and identically distributed (i.i.d.) random protein sequences of lengths $m$ and $n$, with background amino acid frequencies $\\{p_{a}\\}$ and $\\{q_{b}\\}$ for residues $a$ and $b$. Let the substitution score for aligning residues $a$ and $b$ be $s(a,b)$, taken from the BLOSUM62 matrix. For a particular fixed alignment, its raw alignment score is the sum of substitution scores over all aligned pairs and is denoted by $S$. Under the Karlin–Altschul framework for local alignments, the score statistics are characterized by parameters $\\lambda$ and $K$ satisfying the following: the scale parameter $\\lambda$ is the unique positive solution to\n$$\n\\sum_{a,b} p_{a} q_{b} \\exp\\!\\big(\\lambda\\, s(a,b)\\big) \\;=\\; 1,\n$$\nand the expected number of high-scoring segment pairs (HSPs) with score at least $x$ obeys the asymptotic form\n$$\nE(x) \\;\\approx\\; K\\, m n\\, \\exp(-\\lambda x).\n$$\nThe bit score $S'$ associated with a raw score $S$ is defined by\n$$\nS' \\;=\\; \\frac{\\lambda S - \\ln K}{\\ln 2}.\n$$\n\nNow form a new scoring system by multiplying every entry of the BLOSUM62 matrix by a positive constant $c=2$, while keeping the background frequencies $\\{p_{a}\\}$ and $\\{q_{b}\\}$ unchanged and still considering local, ungapped alignments. Denote the new raw score, $\\lambda$ parameter, and $K$ parameter by $S_{\\mathrm{new}}$, $\\lambda_{\\mathrm{new}}$, and $K_{\\mathrm{new}}$, respectively, and the new bit score by $S'_{\\mathrm{new}}$.\n\nDetermine the effect of this scaling on the score and statistical parameters by computing the following four-tuple:\n$$\n\\left(\\frac{S_{\\mathrm{new}}}{S},\\, S'_{\\mathrm{new}} - S',\\, \\frac{\\lambda_{\\mathrm{new}}}{\\lambda},\\, \\frac{K_{\\mathrm{new}}}{K}\\right).\n$$\n\nProvide your final answer as a single row matrix. No rounding is required, and no units are needed.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\n-   Alignment type: local, ungapped.\n-   Sequences: two independent and identically distributed (i.i.d.) random protein sequences of lengths $m$ and $n$.\n-   Background frequencies: $\\{p_{a}\\}$ and $\\{q_{b}\\}$.\n-   Original substitution scores: $s(a,b)$ from the BLOSUM62 matrix.\n-   Original raw score: $S = \\sum_{\\text{aligned pairs}} s(a,b)$.\n-   Karlin-Altschul statistical framework parameters $\\lambda$ and $K$.\n-   Defining equation for $\\lambda$: $\\sum_{a,b} p_{a} q_{b} \\exp(\\lambda s(a,b)) = 1$, where $\\lambda > 0$ is the unique solution.\n-   Expected number of high-scoring pairs (HSPs): $E(x) \\approx K m n \\exp(-\\lambda x)$ for a score of at least $x$.\n-   Bit score definition: $S' = \\frac{\\lambda S - \\ln K}{\\ln 2}$.\n-   New scoring system: $s_{\\mathrm{new}}(a,b) = c \\cdot s(a,b)$, with the constant $c=2$.\n-   New parameters: $S_{\\mathrm{new}}$, $\\lambda_{\\mathrm{new}}$, $K_{\\mathrm{new}}$, $S'_{\\mathrm{new}}$.\n-   Objective: Compute the four-tuple $\\left(\\frac{S_{\\mathrm{new}}}{S}, S'_{\\mathrm{new}} - S', \\frac{\\lambda_{\\mathrm{new}}}{\\lambda}, \\frac{K_{\\mathrm{new}}}{K}\\right)$.\n\nStep 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the well-established Karlin-Altschul statistical theory for local sequence alignment, a cornerstone of modern bioinformatics (e.g., BLAST). All equations and definitions are standard representations of this theory.\n-   **Well-Posed**: The problem is clearly stated, providing all necessary definitions and relationships to determine the effect of scaling the scoring matrix. A unique solution can be derived from the given information.\n-   **Objective**: The problem is quantitative and free of subjective or ambiguous language.\n\nStep 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, and objective. A solution will be provided.\n\nThe analysis proceeds by determining the effect of the scaling transformation on each quantity in the requested four-tuple. The scaling constant is $c=2$.\n\nFirst, consider the new raw score, $S_{\\mathrm{new}}$. By definition, the raw score is the sum of substitution scores over the pairs of residues in a given alignment. For the same fixed alignment, the new raw score $S_{\\mathrm{new}}$ is:\n$$\nS_{\\mathrm{new}} = \\sum_{\\text{aligned pairs}} s_{\\mathrm{new}}(a,b) = \\sum_{\\text{aligned pairs}} c \\cdot s(a,b) = c \\left( \\sum_{\\text{aligned pairs}} s(a,b) \\right) = cS\n$$\nTherefore, the ratio of the new raw score to the old raw score is:\n$$\n\\frac{S_{\\mathrm{new}}}{S} = c = 2\n$$\n\nNext, we determine the new scale parameter, $\\lambda_{\\mathrm{new}}$. It is the unique positive solution to the equation:\n$$\n\\sum_{a,b} p_{a} q_{b} \\exp(\\lambda_{\\mathrm{new}} s_{\\mathrm{new}}(a,b)) = 1\n$$\nSubstituting $s_{\\mathrm{new}}(a,b) = c \\cdot s(a,b)$ into this equation gives:\n$$\n\\sum_{a,b} p_{a} q_{b} \\exp(\\lambda_{\\mathrm{new}} (c \\cdot s(a,b))) = \\sum_{a,b} p_{a} q_{b} \\exp((c\\lambda_{\\mathrm{new}}) s(a,b)) = 1\n$$\nThe original parameter $\\lambda$ is defined as the unique positive solution to $\\sum_{a,b} p_{a} q_{b} \\exp(\\lambda s(a,b)) = 1$. By comparing the two equations and invoking the uniqueness of the solution, we can equate the coefficients of $s(a,b)$ in the exponent:\n$$\n\\lambda = c\\lambda_{\\mathrm{new}} \\implies \\lambda_{\\mathrm{new}} = \\frac{\\lambda}{c}\n$$\nThe ratio of the new $\\lambda$ parameter to the old one is:\n$$\n\\frac{\\lambda_{\\mathrm{new}}}{\\lambda} = \\frac{1}{c} = \\frac{1}{2}\n$$\n\nNow we consider the bit scores, $S'$ and $S'_{\\mathrm{new}}$, and the statistical parameters, $K$ and $K_{\\mathrm{new}}$. The purpose of the bit score is to provide a normalized measure of an alignment's statistical significance that is independent of the arbitrary scale of the underlying scoring matrix. The significance of a given alignment is an intrinsic property and should not change simply because the scoring matrix has been multiplied by a constant factor. Thus, the bit score for a specific alignment must be invariant under this scaling transformation. This is a fundamental principle of the normalization scheme. We therefore must have:\n$$\nS'_{\\mathrm{new}} = S'\n$$\nFrom this, the second element of the tuple is immediately determined:\n$$\nS'_{\\mathrm{new}} - S' = 0\n$$\n\nFinally, we use the invariance of the bit score to determine the relationship between $K_{\\mathrm{new}}$ and $K$. The definitions of the bit scores are:\n$$\nS' = \\frac{\\lambda S - \\ln K}{\\ln 2}\n$$\n$$\nS'_{\\mathrm{new}} = \\frac{\\lambda_{\\mathrm{new}} S_{\\mathrm{new}} - \\ln K_{\\mathrm{new}}}{\\ln 2}\n$$\nSince $S'_{\\mathrm{new}} = S'$, we can equate the expressions:\n$$\n\\frac{\\lambda S - \\ln K}{\\ln 2} = \\frac{\\lambda_{\\mathrm{new}} S_{\\mathrm{new}} - \\ln K_{\\mathrm{new}}}{\\ln 2}\n$$\n$$\n\\lambda S - \\ln K = \\lambda_{\\mathrm{new}} S_{\\mathrm{new}} - \\ln K_{\\mathrm{new}}\n$$\nWe have already established that $S_{\\mathrm{new}} = cS$ and $\\lambda_{\\mathrm{new}} = \\lambda/c$. Substituting these into the right side of the equation:\n$$\n\\lambda_{\\mathrm{new}} S_{\\mathrm{new}} = \\left(\\frac{\\lambda}{c}\\right) (cS) = \\lambda S\n$$\nThe product $\\lambda S$ is itself invariant under the scaling. Substituting this back into the equality:\n$$\n\\lambda S - \\ln K = \\lambda S - \\ln K_{\\mathrm{new}}\n$$\nThis simplifies to:\n$$\n-\\ln K = -\\ln K_{\\mathrm{new}} \\implies \\ln K = \\ln K_{\\mathrm{new}}\n$$\nExponentiating both sides gives:\n$$\nK = K_{\\mathrm{new}}\n$$\nTherefore, the parameter $K$ is also invariant under this scaling. The ratio is:\n$$\n\\frac{K_{\\mathrm{new}}}{K} = 1\n$$\n\nIn summary, the four requested quantities are:\n1.  $\\frac{S_{\\mathrm{new}}}{S} = 2$\n2.  $S'_{\\mathrm{new}} - S' = 0$\n3.  $\\frac{\\lambda_{\\mathrm{new}}}{\\lambda} = \\frac{1}{2}$\n4.  $\\frac{K_{\\mathrm{new}}}{K} = 1$\n\nAssembling these into the specified four-tuple gives the final answer.", "answer": "$$\n\\boxed{\\begin{pmatrix} 2 & 0 & \\frac{1}{2} & 1 \\end{pmatrix}}\n$$", "id": "2375719"}, {"introduction": "This final practice challenges the common misconception that higher percent identity always signifies a more significant alignment. You will compare a short, high-identity alignment with a longer, gapped alignment and discover how statistical significance, captured by the bit score, can provide a more nuanced evaluation. This hands-on calculation, which includes applying an affine gap penalty, highlights why robust statistical frameworks like Karlin-Altschul are essential for identifying biologically meaningful relationships over simple similarity metrics. [@problem_id:2375731]", "problem": "A protein database search using the Basic Local Alignment Search Tool (BLAST) yields two high-scoring pairs under identical scoring conditions and background composition. The scoring system uses the BLOSUM62 substitution matrix for the relevant residue pairs and an affine gap penalty model. The alignments are as follows.\n\nAlignment A (short, gapless):\n- Residue-residue columns: $10$ total, with $9$ identical pairs $A$–$A$ and one mismatch $G$–$T$.\n- Gap columns: $0$.\n- Relevant BLOSUM62 scores: $s(A,A)=4$, $s(G,T)=-2$.\n\nAlignment B (longer, with a single gap):\n- Residue-residue columns: $15$ total, consisting of $6$ identical $G$–$G$, $3$ identical $T$–$T$, $3$ identical $A$–$A$, and $3$ mismatches ($A$–$G$, $A$–$T$, $G$–$T$).\n- Gap columns: $4$ consecutive positions (a single contiguous gap of length $4$).\n- Relevant BLOSUM62 scores: $s(G,G)=6$, $s(T,T)=5$, $s(A,A)=4$, $s(A,G)=0$, $s(A,T)=0$, $s(G,T)=-2$.\n- Affine gap penalties: gap opening cost $11$ and gap extension cost $1$ per additional gap position beyond the first.\n\nFor both alignments, the Karlin–Altschul statistical parameters are identical and given by $\\lambda=0.318$ and $K=0.13$.\n\nAssume percent identity is defined as the proportion of identical residue-residue pairs among the residue-residue columns (gap-only columns are excluded from this proportion). Under this definition, Alignment A has higher percent identity than Alignment B.\n\nUsing only the information above and fundamental definitions, compute the difference in normalized bit score (Alignment B minus Alignment A). Round your answer to four significant figures. Express your final answer in bits (do not include units in the boxed answer).", "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extraction of Givens.\n- **Alignment A (short, gapless):**\n  - Residue-residue columns: $10$\n  - Identical pairs: $9$ of type $A$–$A$\n  - Mismatch pairs: $1$ of type $G$–$T$\n  - Gap columns: $0$\n  - Relevant BLOSUM62 scores: $s(A,A) = 4$, $s(G,T) = -2$\n\n- **Alignment B (longer, with a single gap):**\n  - Residue-residue columns: $15$\n  - Identical pairs: $6$ of type $G$–$G$, $3$ of type $T$–$T$, $3$ of type $A$–$A$\n  - Mismatch pairs: $3$ total, specified as $A$–$G$, $A$–$T$, and $G$–$T$\n  - Gap columns: $4$ consecutive positions, forming a single gap of length $4$\n  - Relevant BLOSUM62 scores: $s(G,G) = 6$, $s(T,T) = 5$, $s(A,A) = 4$, $s(A,G) = 0$, $s(A,T) = 0$, $s(G,T) = -2$\n  - Affine gap penalties: gap opening cost $g_o = 11$, gap extension cost $g_e = 1$\n\n- **Statistical Parameters:**\n  - For both alignments, $\\lambda = 0.318$ and $K = 0.13$.\n\n- **Definition and Condition:**\n  - Percent identity is defined as the proportion of identical residue-residue pairs.\n  - It is stated that Alignment A has a higher percent identity than Alignment B. We verify this claim:\n    - Percent identity of A: $\\frac{9}{10} = 0.9$\n    - Percent identity of B: $\\frac{6+3+3}{15} = \\frac{12}{15} = 0.8$\n    - The condition $0.9 > 0.8$ is true.\n\n- **Task:**\n  - Compute the difference in normalized bit score: $(\\text{Bit Score of B}) - (\\text{Bit Score of A})$.\n  - Round the answer to four significant figures.\n\nStep 2: Validation Verdict.\nThe problem is scientifically grounded in the principles of bioinformatics and sequence alignment theory. It is well-posed, providing all necessary data and definitions for a unique solution (BLOSUM62 scores, affine gap penalty parameters, and Karlin-Altschul statistical parameters). The problem setup is objective and free of contradictions or ambiguities. Therefore, the problem is deemed **valid**. We proceed with the solution.\n\nThe raw score, $S$, of a local alignment is calculated by summing the substitution scores for each aligned pair of residues and subtracting the penalties for any gaps introduced.\n\nFirst, we calculate the raw score for Alignment A, denoted as $S_A$. This alignment is gapless, so its score is purely the sum of substitution scores.\n$$ S_A = 9 \\times s(A,A) + 1 \\times s(G,T) $$\nSubstituting the given values:\n$$ S_A = 9 \\times 4 + 1 \\times (-2) = 36 - 2 = 34 $$\n\nNext, we calculate the raw score for Alignment B, denoted as $S_B$. This calculation involves both substitution scores and a gap penalty.\nThe sum of substitution scores for Alignment B is:\n$$ \\sum s = 6 \\times s(G,G) + 3 \\times s(T,T) + 3 \\times s(A,A) + 1 \\times s(A,G) + 1 \\times s(A,T) + 1 \\times s(G,T) $$\n$$ \\sum s = 6 \\times 6 + 3 \\times 5 + 3 \\times 4 + 1 \\times 0 + 1 \\times 0 + 1 \\times (-2) $$\n$$ \\sum s = 36 + 15 + 12 + 0 + 0 - 2 = 61 $$\nThe penalty for a single gap of length $k=4$ under an affine model is $g_o + (k-1)g_e$.\nWith $g_o = 11$ and $g_e = 1$:\n$$ \\text{Gap Penalty} = 11 + (4-1) \\times 1 = 11 + 3 = 14 $$\nThe raw score $S_B$ is the sum of substitution scores minus the gap penalty:\n$$ S_B = 61 - 14 = 47 $$\n\nThe normalized bit score, $S'$, is derived from the raw score $S$ using the Karlin-Altschul statistical parameters $\\lambda$ and $K$. The conversion formula is:\n$$ S' = \\frac{\\lambda S - \\ln(K)}{\\ln(2)} $$\nWe are asked to compute the difference in bit scores, $\\Delta S' = S'_B - S'_A$.\n$$ \\Delta S' = S'_B - S'_A = \\left( \\frac{\\lambda S_B - \\ln(K)}{\\ln(2)} \\right) - \\left( \\frac{\\lambda S_A - \\ln(K)}{\\ln(2)} \\right) $$\nThis expression simplifies considerably, as the term involving $K$ is common to both bit scores and cancels out:\n$$ \\Delta S' = \\frac{(\\lambda S_B - \\ln(K)) - (\\lambda S_A - \\ln(K))}{\\ln(2)} = \\frac{\\lambda S_B - \\lambda S_A}{\\ln(2)} $$\n$$ \\Delta S' = \\frac{\\lambda (S_B - S_A)}{\\ln(2)} $$\nThis demonstrates that the difference in bit scores is directly proportional to the difference in raw scores. This is an important property of the normalization. The fact that Alignment B has a lower percent identity but a higher raw score ($47 > 34$) illustrates why statistically-based scoring is more informative than simple identity metrics.\n\nSubstituting the calculated raw scores and the given parameters:\n$S_B - S_A = 47 - 34 = 13$\n$\\lambda = 0.318$\n$$ \\Delta S' = \\frac{0.318 \\times 13}{\\ln(2)} = \\frac{4.134}{\\ln(2)} $$\nUsing the value $\\ln(2) \\approx 0.693147$:\n$$ \\Delta S' \\approx \\frac{4.134}{0.693147} \\approx 5.964100... $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\Delta S' \\approx 5.964 $$\nThe result is in units of bits, as per the definition of bit scores.", "answer": "$$\n\\boxed{5.964}\n$$", "id": "2375731"}]}