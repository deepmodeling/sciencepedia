{"hands_on_practices": [{"introduction": "To begin our hands-on exploration of gap penalties, we'll start with the most straightforward model: the linear gap penalty. In this model, every gap character is assigned a uniform, fixed penalty, regardless of whether it's opening a new gap or extending an existing one. This exercise [@problem_id:2136014] will help you master the basic arithmetic of alignment scoring and provide a crucial foundation before we move on to more sophisticated penalty systems.", "problem": "In the field of bioinformatics, sequence alignment is a fundamental method for comparing protein or nucleotide sequences to identify regions of similarity that may be a consequence of functional, structural, or evolutionary relationships. The quality of an alignment is quantified by a score, calculated using a substitution matrix and gap penalties.\n\nConsider the following gapped alignment of two short peptide sequences, Seq1 and Seq2:\n\nSeq1: `F E S A G K D E`\nSeq2: `F R S - G K T E`\n\nCalculate the total alignment score using the BLOcks SUbstitution Matrix 62 (BLOSUM62) and a linear gap penalty. A linear gap penalty means that each gap character, represented by a hyphen (`-`), incurs a fixed negative score, regardless of its length or position. For this problem, the linear gap penalty is $-8$.\n\nThe relevant substitution scores from the BLOSUM62 matrix are provided below:\n- Score(F, F) = 6\n- Score(E, R) = 0\n- Score(S, S) = 4\n- Score(G, G) = 6\n- Score(K, K) = 5\n- Score(D, T) = -1\n- Score(E, E) = 5\n\nProvide the total score as an integer.", "solution": "An alignment score with a substitution matrix and a linear gap penalty is computed by summing the substitution score for each aligned residue pair and adding the gap penalty for each gap character. Let $s(x,y)$ denote the BLOSUM62 substitution score and let the linear gap penalty be $g=-8$ per gap character.\n\nFor the given alignment across 8 columns, the contributions are:\n$$\ns(F,F)=6,\\quad s(E,R)=0,\\quad s(S,S)=4,\\quad \\text{gap}=g=-8,\\quad s(G,G)=6,\\quad s(K,K)=5,\\quad s(D,T)=-1,\\quad s(E,E)=5.\n$$\n\nTherefore, the total alignment score $S$ is\n$$\nS=6+0+4+(-8)+6+5+(-1)+5=17.\n$$", "answer": "$$\\boxed{17}$$", "id": "2136014"}, {"introduction": "While the linear model is simple, biological reality is often more complex; a single large insertion or deletion event is more probable than many independent single-residue events. The affine gap penalty model captures this by using a large penalty to open a gap and a smaller one to extend it. This practice problem [@problem_id:2136038] will guide you through calculating a score with an affine penalty, a critical skill for interpreting the output of real-world sequence alignment programs.", "problem": "In bioinformatics, sequence alignment is a fundamental method for comparing protein or nucleotide sequences to identify regions of similarity. The quality of a given alignment is quantified by a numerical score, calculated based on the matches, mismatches, and gaps between the sequences. A particularly common model for penalizing gaps is the affine gap penalty model, which distinguishes between the cost of opening a gap and the cost of extending it.\n\nConsider the following specific alignment of two short peptide sequences, `PEPTIDE X` and `PEPTIDE Y`:\n\n`PEPTIDE X: VDLMSETKRG`\n`PEPTIDE Y: VDL-----RG`\n\nThe total alignment score is determined by summing the substitution scores for each vertically aligned pair of amino acids and adding the penalties for any gaps present. The scoring system for this task is defined as follows:\n\n1.  **Substitution Scores**: The score for aligning an amino acid from `PEPTIDE X` with an identical one from `PEPTIDE Y` is given in the table below.\n    *   S(V,V) = 4\n    *   S(D,D) = 6\n    *   S(L,L) = 4\n    *   S(R,R) = 5\n    *   S(G,G) = 6\n\n2.  **Affine Gap Penalty**: The introduction of a gap is penalized using an affine model with the following parameters:\n    *   Gap Opening Penalty: -11\n    *   Gap Extension Penalty: -1\n\nCalculate the total alignment score for the specific alignment shown above. The final answer should be a single integer.", "solution": "We parse the given alignment:\nPEPTIDE X: V D L M S E T K R G\nPEPTIDE Y: V D L - - - - - R G\n\nThe vertically aligned pairs are:\n- Matches: $(V,V)$, $(D,D)$, $(L,L)$, $(R,R)$, $(G,G)$.\n- One contiguous gap in PEPTIDE Y of length $k=5$ aligned against $M,S,E,T,K$ from PEPTIDE X.\n\nSubstitution score contribution is the sum of the given identical-pair scores:\n$$\nS_{\\text{sub}} = S(V,V) + S(D,D) + S(L,L) + S(R,R) + S(G,G)\n= 4 + 6 + 4 + 5 + 6 = 25.\n$$\n\nUsing the affine gap penalty model, the penalty for a single contiguous gap of length $k$ is\n$$\nG_{\\text{gap}} = \\text{gap\\_open} + (k-1)\\,\\text{gap\\_extend}.\n$$\nWith $\\text{gap\\_open} = -11$, $\\text{gap\\_extend} = -1$, and $k=5$, we obtain\n$$\nG_{\\text{gap}} = -11 + (5-1)(-1) = -11 - 4 = -15.\n$$\n\nTherefore, the total alignment score is\n$$\nS_{\\text{total}} = S_{\\text{sub}} + G_{\\text{gap}} = 25 + (-15) = 10.\n$$", "answer": "$$\\boxed{10}$$", "id": "2136038"}, {"introduction": "Now that you're comfortable calculating scores with different gap penalty models, let's explore a deeper question: how do the penalty values themselves affect the outcome of an alignment? The choice of parameters is not arbitrary; it represents a hypothesis about the evolutionary distance between sequences. This exercise [@problem_id:2392977] challenges you to determine the precise threshold at which introducing a gap becomes more favorable than accepting a series of mismatches, providing a powerful insight into the trade-offs at the heart of sequence alignment.", "problem": "Consider global alignment of two specific, equal-length nucleotide sequences under an affine gap penalty model. The alignment score is defined as the sum over all aligned columns of a substitution score for letter–letter pairs plus a gap cost for any contiguous gap block. The substitution scores are: a match contributes $+2$ and a mismatch contributes $-1$. For any gap block of length $\\ell$, the affine gap cost is $g_{open} + g_{ext} \\times (\\ell - 1)$, where $g_{open} \\ge 0$ is the gap opening penalty and $g_{ext} = 1$ is the gap extension penalty per additional gap character beyond the first.\n\nYou are given that, for these two sequences of length $n = 12$, the best possible global alignment that forbids gaps (i.e., a position-wise, gapless alignment) achieves exactly $m_{0} = 6$ matches and $n - m_{0} = 6$ mismatches. If alignments are instead allowed to contain at most one contiguous gap block of length $\\ell = 1$ in either sequence, then there exists a placement of this single-gap alignment that yields exactly $m_{1} = 10$ matches and $(n - 1) - m_{1} = 1$ mismatch (noting that one alignment column is a letter–gap pair).\n\nDetermine the largest value of the gap opening penalty $g_{open}$ (in the same scoring units as the substitution scores) for which there exists an optimal global alignment that contains at least one gap; equivalently, determine the threshold value $g_{open}^{*}$ such that a single-gap alignment attains a score greater than or equal to the best gapless score if and only if $g_{open} \\le g_{open}^{*}$. Give your answer as a single number. No rounding is required.", "solution": "The objective is to find the threshold value for the gap opening penalty, $g_{open}$, where an alignment with a gap becomes at least as optimal as the best gapless alignment. This occurs when the score of the gapped alignment, $S_{gap}$, is greater than or equal to the score of the gapless alignment, $S_{nogap}$.\n\nFirst, we calculate the score of the best gapless alignment, $S_{nogap}$. This alignment has 6 matches and 6 mismatches.\n$$S_{nogap} = (6 \\times 2) + (6 \\times -1) = 12 - 6 = 6$$\n\nNext, we calculate the score of the alignment containing a single gap of length $\\ell=1$, $S_{gap}$. This alignment has 10 matches and 1 mismatch. Its score is the sum of substitution scores minus the gap cost.\nThe substitution part of the score is:\n$$S_{\\text{substitutions}} = (10 \\times 2) + (1 \\times -1) = 20 - 1 = 19$$\n\nThe cost for a gap of length $\\ell=1$ under the affine model is simply the opening penalty:\n$$C(1) = g_{open} + g_{ext} \\times (1 - 1) = g_{open}$$\nThe total score for the gapped alignment is:\n$$S_{gap} = S_{\\text{substitutions}} - C(1) = 19 - g_{open}$$\n\nWe find the threshold by setting $S_{gap} \\ge S_{nogap}$:\n$$19 - g_{open} \\ge 6$$\nSolving for $g_{open}$ gives:\n$$13 \\ge g_{open}$$\nThe largest value of $g_{open}$ that satisfies this condition is 13. Therefore, the threshold $g_{open}^{*}$ is 13.", "answer": "$$\\boxed{13}$$", "id": "2392977"}]}