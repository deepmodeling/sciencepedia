{"hands_on_practices": [{"introduction": "The power of modern mass spectrometry lies in its ability to measure mass with extraordinary precision. This precision allows us to distinguish molecules that have the same nominal mass but different elemental compositions—a phenomenon critical for identifying post-translational modifications (PTMs). This exercise challenges you to quantify the analytical performance needed to resolve two such isobaric PTMs, trimethylation and acetylation, by calculating the required mass spectrometer resolution [@problem_id:2416842]. Mastering this calculation solidifies your understanding of mass accuracy, mass defect, and the fundamental link between instrument capability and biological discovery.", "problem": "A peptide has a neutral monoisotopic mass $M_0 = 1500.0000$ Da. Consider two alternative post-translational modifications (PTMs) on a lysine residue: trimethylation and acetylation. For the net mass shift added to the peptide backbone, use the elemental compositions $C_3H_6$ for trimethylation and $C_2H_2O$ for acetylation. Both modified precursor ions are observed in a high-resolution mass spectrometer as doubly protonated species with charge state $z=2$. Assume monoisotopic atomic masses $m(\\mathrm{C}) = 12.000000$, $m(\\mathrm{H}) = 1.00782503223$, $m(\\mathrm{N}) = 14.00307400443$, $m(\\mathrm{O}) = 15.99491461957$, and the proton mass $m_p = 1.00727646688$ (all in daltons). Use the conventional definition of resolving power at full width at half maximum (FWHM) for mass spectrometry, and evaluate it at the average $m/z$ of the two monoisotopic precursor peaks.\n\nWhat is the theoretical minimum resolving power $R$ required to distinguish the acetylated and trimethylated precursors under these conditions? Round your answer to four significant figures. Report $R$ as a dimensionless number.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Neutral monoisotopic mass of the unmodified peptide: $M_0 = 1500.0000$ Da.\n- Post-translational modification 1 (PTM1): Trimethylation, with a net mass shift corresponding to the elemental composition $C_3H_6$.\n- Post-translational modification 2 (PTM2): Acetylation, with a net mass shift corresponding to the elemental composition $C_2H_2O$.\n- Charge state of precursor ions: $z=2$.\n- Monoisotopic atomic masses:\n  - $m(\\mathrm{C}) = 12.000000$ Da\n  - $m(\\mathrm{H}) = 1.00782503223$ Da\n  - $m(\\mathrm{N}) = 14.00307400443$ Da\n  - $m(\\mathrm{O}) = 15.99491461957$ Da\n- Proton mass: $m_p = 1.00727646688$ Da.\n- Definition of resolving power: $R = \\frac{m}{(\\Delta m)_{\\text{FWHM}}}$, where $(\\Delta m)_{\\text{FWHM}}$ is the full width at half maximum of a peak at mass-to-charge ratio $m$.\n- Evaluation point for $R$: The average $m/z$ of the two monoisotopic precursor peaks.\n- Objective: Determine the minimum resolving power $R$ required to distinguish the two precursor ions.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard calculation in high-resolution proteomics mass spectrometry. The provided atomic masses are the correct values for monoisotopes. The definitions for the mass shifts of trimethylation and acetylation on lysine are chemically correct. The problem provides all necessary information to compute a unique, meaningful solution. There are no contradictions, ambiguities, or factual unsoundness.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\nThe task is to find the minimum theoretical resolving power, $R$, required to distinguish two isotopically distinct precursor ions. The criterion for two peaks to be just resolved is that the difference between their mass-to-charge ratios, $\\Delta(m/z)$, is equal to the full width at half maximum (FWHM) of the peaks, denoted as $(\\Delta m)_{\\text{FWHM}}$.\n$$(\\Delta m)_{\\text{FWHM}} = \\Delta(m/z)$$\nThe resolving power is defined as $R = \\frac{m}{(\\Delta m)_{\\text{FWHM}}}$. The problem specifies that $R$ should be evaluated at the average mass-to-charge ratio of the two peaks, $(m/z)_{\\text{avg}}$.\nTherefore, the minimum required resolving power is given by:\n$$R = \\frac{(m/z)_{\\text{avg}}}{\\Delta(m/z)}$$\n\nFirst, we calculate the mass shifts, $\\Delta M$, for each PTM from their elemental compositions.\nFor trimethylation ($PTM_1$):\n$$\\Delta M_{tri} = 3 \\times m(\\mathrm{C}) + 6 \\times m(\\mathrm{H})$$\n$$\\Delta M_{tri} = 3 \\times 12.000000 + 6 \\times 1.00782503223 = 36.000000 + 6.04695019338 = 42.04695019338 \\text{ Da}$$\nFor acetylation ($PTM_2$):\n$$\\Delta M_{ac} = 2 \\times m(\\mathrm{C}) + 2 \\times m(\\mathrm{H}) + 1 \\times m(\\mathrm{O})$$\n$$\\Delta M_{ac} = 2 \\times 12.000000 + 2 \\times 1.00782503223 + 15.99491461957 = 24.000000 + 2.01565006446 + 15.99491461957 = 42.01056468403 \\text{ Da}$$\n\nNext, we determine the neutral monoisotopic masses of the two modified peptides, $M_{tri}$ and $M_{ac}$.\n$$M_{tri} = M_0 + \\Delta M_{tri} = 1500.0000 + 42.04695019338 = 1542.04695019338 \\text{ Da}$$\n$$M_{ac} = M_0 + \\Delta M_{ac} = 1500.0000 + 42.01056468403 = 1542.01056468403 \\text{ Da}$$\n\nThe mass-to-charge ratio, $m/z$, for an ion with neutral mass $M$, charge state $z$, and proton mass $m_p$ is given by:\n$$(m/z) = \\frac{M + z \\cdot m_p}{z} = \\frac{M}{z} + m_p$$\nThe difference in $m/z$ between the two species is:\n$$\\Delta(m/z) = (m/z)_{tri} - (m/z)_{ac} = \\left(\\frac{M_{tri}}{z} + m_p\\right) - \\left(\\frac{M_{ac}}{z} + m_p\\right) = \\frac{M_{tri} - M_{ac}}{z}$$\nThe difference in neutral mass is:\n$$M_{tri} - M_{ac} = \\Delta M_{tri} - \\Delta M_{ac} = 42.04695019338 - 42.01056468403 = 0.03638550935 \\text{ Da}$$\nWith $z=2$, the difference in $m/z$ is:\n$$\\Delta(m/z) = \\frac{0.03638550935}{2} = 0.018192754675$$\n\nNow, we calculate the average mass-to-charge ratio, $(m/z)_{\\text{avg}}$.\n$$(m/z)_{\\text{avg}} = \\frac{(m/z)_{tri} + (m/z)_{ac}}{2} = \\frac{1}{2} \\left[ \\left(\\frac{M_{tri}}{z} + m_p\\right) + \\left(\\frac{M_{ac}}{z} + m_p\\right) \\right] = \\frac{M_{tri} + M_{ac}}{2z} + m_p$$\nThe average neutral mass is:\n$$M_{avg} = \\frac{M_{tri} + M_{ac}}{2} = \\frac{1542.04695019338 + 1542.01056468403}{2} = 1542.028757438705 \\text{ Da}$$\nThe average $m/z$ is:\n$$(m/z)_{\\text{avg}} = \\frac{1542.028757438705}{2} + 1.00727646688 = 771.0143787193525 + 1.00727646688 = 772.02165518623$$\n\nFinally, we calculate the required minimum resolving power $R$.\n$$R = \\frac{(m/z)_{\\text{avg}}}{\\Delta(m/z)} = \\frac{772.02165518623}{0.018192754675} \\approx 42436.0029$$\nThe problem requires the answer to be rounded to four significant figures.\n$$R \\approx 42440$$\nIn standard scientific notation, this is $4.244 \\times 10^4$.", "answer": "$$\\boxed{4.244 \\times 10^{4}}$$", "id": "2416842"}, {"introduction": "A central challenge in proteomics is distinguishing genuine biological proteoforms from artifacts generated during the analytical process. In a top-down Liquid Chromatography–Mass Spectrometry (LC–MS) experiment, smaller proteins might be either biologically truncated species or gas-phase fragments of a larger protein. This practice problem guides you to think like a data scientist, asking you to devise a computational strategy to tell them apart [@problem_id:2416811]. The key lies in understanding that genuine molecules undergo chromatographic separation, giving them a unique elution profile, whereas gas-phase fragments are merely temporal shadows of their precursors, a principle you must use to build a robust filtering logic.", "problem": "You are analyzing data from a Liquid Chromatography–Mass Spectrometry (LC–MS) top-down proteomics experiment, where intact proteins (proteoforms) are ionized after chromatographic separation and subjected to mass analysis. In such experiments, smaller protein species observed in the mass spectra can arise from two different origins: (i) fragments generated in the gas phase after ionization (for example, by in-source fragmentation or during tandem acquisition), or (ii) genuine proteoforms that are biologically truncated in the cell before separation. You are restricted to computational analysis of the acquired data and cannot change any instrument settings or perform additional experiments. Your goal is to distinguish gas-phase fragments from bona fide truncated proteoforms.\n\nWhich approach best exploits fundamental properties of separation and ion formation to distinguish these two cases in a realistic, computational workflow?\n\nA. Construct a feature-level co-elution and covariance analysis across the chromatographic dimension, linking features whose masses are exact N-terminal or C-terminal prefixes/suffixes of a higher-mass proteoform within mass accuracy, and classify as gas-phase fragments those smaller features that (i) co-elute with the higher-mass feature (shared apex and strongly correlated Extracted Ion Chromatograms (XICs)) and (ii) lack an independent chromatographic peak.\n\nB. Search all observed termini against a proteome database of known protease motifs and predicted signal peptide cleavage sites, and classify any truncation matching a motif as biological, irrespective of retention behavior or relationships to co-eluting features.\n\nC. Compare isotopic envelope shapes and skewness; gas-phase fragments can be identified because their isotopic distributions systematically deviate from the theoretical multinomial pattern expected for the same elemental composition.\n\nD. Use charge state distributions alone; gas-phase fragments always carry at least $1$ fewer charge than a genuine truncated proteoform of similar mass, so lower average charge unambiguously indicates gas-phase origin.\n\nE. Rely solely on tandem spectra of the smaller species; gas-phase fragments will not produce sequence-informative fragment ions (for example, b/y or c/z ions), whereas genuine truncated proteoforms will do so reliably.\n\nSelect the single best option.", "solution": "The problem statement poses a standard-yet-critical task in computational proteomics: the differentiation of genuine, biologically truncated proteoforms from artifactual gas-phase fragments that arise during mass spectrometric analysis. The core constraint is that this differentiation must be performed computationally on existing Liquid Chromatography–Mass Spectrometry (LC–MS) data.\n\n### Problem Validation\n\nFirst, I will validate the problem statement itself.\n\n**Step 1: Extracted Givens**\n- **Technique:** Liquid Chromatography–Mass Spectrometry (LC–MS) for top-down proteomics.\n- **Process:** Intact proteoforms are separated by chromatography, then ionized and analyzed by a mass spectrometer.\n- **Observation:** Smaller protein species are detected.\n- **Hypothesized Origins of Smaller Species:**\n    - (i) Gas-phase fragments generated post-ionization (e.g., in-source fragmentation, tandem acquisition).\n    - (ii) Genuine, biologically truncated proteoforms present in the sample before analysis.\n- **Constraint:** The analysis must be purely computational using the acquired data. No further experiments are permitted.\n- **Objective:** To computationally distinguish between origin (i) and origin (ii).\n- **Question:** Identify the best approach that utilizes fundamental principles of separation and ion formation.\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientific Grounding:** The problem is firmly grounded in the principles of analytical chemistry and biochemistry. The existence of both in-source/gas-phase fragments and biologically truncated proteoforms is a well-documented reality in top-down proteomics. The challenge of distinguishing them is a significant topic in the field's data analysis workflows. The problem is scientifically sound.\n- **Well-Posed:** The problem is well-posed. It presents a clear objective and a realistic set of constraints. It asks for the \"best\" approach, which implies a comparative analysis based on underlying physical and chemical principles, leading to a determinable answer.\n- **Objective:** The language is technical, precise, and free of subjectivity. Terms like \"proteoform,\" \"co-elution,\" \"in-source fragmentation,\" and \"tandem acquisition\" are standard and rigorously defined within the discipline.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is scientifically sound, well-posed, and objective. It describes a non-trivial and relevant challenge in bioinformatics and computational mass spectrometry. I will now proceed with a full derivation and analysis of the options.\n\n### Solution Derivation\n\nThe fundamental principle that allows for the distinction between the two types of species lies in the sequence of events they experience.\n1.  **Genuine Truncated Proteoforms:** These are distinct molecular entities that exist in the sample *before* it is injected into the LC system. They undergo chromatographic separation based on their unique physicochemical properties (e.g., size, hydrophobicity). Therefore, a genuine truncated proteoform will elute from the column at its own characteristic retention time, producing a distinct chromatographic peak. This retention time will almost certainly differ from that of the full-length protein from which it may have been derived.\n2.  **Gas-Phase Fragments:** These species do not exist in the original sample. They are generated *after* ionization, inside the mass spectrometer. They are formed from a larger, intact precursor proteoform that has already eluted from the chromatography column. Consequently, the appearance of a gas-phase fragment in time is strictly dependent on the presence of its precursor ion. It cannot have its own independent chromatographic profile because it never underwent separation. It will only be detected when its precursor is being detected.\n\nTherefore, the most reliable and fundamental distinguishing feature is the chromatographic elution profile. A genuine proteoform has its own peak; a gas-phase fragment's signal is merely a \"shadow\" of its precursor's peak. A robust computational method must exploit this temporal relationship.\n\n### Option-by-Option Analysis\n\n**A. Construct a feature-level co-elution and covariance analysis across the chromatographic dimension, linking features whose masses are exact N-terminal or C-terminal prefixes/suffixes of a higher-mass proteoform within mass accuracy, and classify as gas-phase fragments those smaller features that (i) co-elute with the higher-mass feature (shared apex and strongly correlated Extracted Ion Chromatograms (XICs)) and (ii) lack an independent chromatographic peak.**\n\nThis approach directly operationalizes the fundamental principles derived above.\n- It correctly establishes the potential chemical relationship by checking if the smaller mass is a subsequence of the larger one (\"N-terminal or C-terminal prefixes/suffixes\"). This is a necessary condition for a fragment.\n- It then tests the critical temporal relationship. \"Co-elution,\" \"shared apex,\" and \"strongly correlated XICs\" are the mathematical formalizations of the concept that the fragment is an artifact of the precursor. If the small species is a gas-phase fragment of the larger one, its abundance at any point in time must be proportional to the abundance of the precursor at that same time. This leads to perfectly correlated XICs.\n- The condition of lacking an \"independent chromatographic peak\" correctly identifies that the species did not undergo its own separation.\n\nThis method is logical, physically sound, and represents the state-of-the-art computational approach to this problem.\n\n**Verdict: Correct.**\n\n**B. Search all observed termini against a proteome database of known protease motifs and predicted signal peptide cleavage sites, and classify any truncation matching a motif as biological, irrespective of retention behavior or relationships to co-eluting features.**\n\nThis method is flawed and unreliable.\n- Its primary sin is to be \"irrespective of retention behavior.\" The chromatographic separation provides the most definitive evidence available in the data, and to ignore it is a grave error. A species that perfectly co-elutes with a precursor is almost certainly a gas-phase fragment, even if its mass accidentally corresponds to a known protease cleavage site.\n- The approach is based on incomplete knowledge. Protease specificity databases are not exhaustive, and many biological processing events are uncharacterized or result from non-specific degradation. This leads to false negatives (true biological forms are missed).\n- Conversely, many protease motifs are simple, increasing the probability of chance matches, which would lead to false positives (classifying a gas-phase fragment as biological).\n\n**Verdict: Incorrect.**\n\n**C. Compare isotopic envelope shapes and skewness; gas-phase fragments can be identified because their isotopic distributions systematically deviate from the theoretical multinomial pattern expected for the same elemental composition.**\n\nThis premise is scientifically false. The isotopic distribution of an ion is a function of its elemental composition and the natural abundance of stable isotopes. The process of generating a fragment by breaking a covalent bond (e.g., in-source fragmentation) does not alter the isotopic composition of the atoms within that fragment. A fragment with a given elemental formula will exhibit the same theoretical isotopic distribution as any other molecule with that same formula, regardless of its origin. There is no physical basis for a \"systematic deviation\" that would serve as a signature of fragmentation.\n\n**Verdict: Incorrect.**\n\n**D. Use charge state distributions alone; gas-phase fragments always carry at least $1$ fewer charge than a genuine truncated proteoform of similar mass, so lower average charge unambiguously indicates gas-phase origin.**\n\nThis statement is factually incorrect and represents a misunderstanding of the electrospray ionization (ESI) and fragmentation processes.\n- The charge an ion acquires in ESI depends on its conformation and the number of available charging sites. Two species of similar mass and composition, one a fragment and one a genuine truncated form, are expected to have very similar charge state distributions.\n- The claim that a fragment \"always\" carries at least $1$ fewer charge is baseless. In fact, one could argue the opposite: if a highly charged precursor fragments, the resulting pieces might retain a high amount of charge relative to their now-smaller mass, potentially leading to *higher* average charge states compared to a separately ionized proteoform of the same mass. The relationship is complex and not \"unambiguous.\"\n\n**Verdict: Incorrect.**\n\n**E. Rely solely on tandem spectra of the smaller species; gas-phase fragments will not produce sequence-informative fragment ions (for example, b/y or c/z ions), whereas genuine truncated proteoforms will do so reliably.**\n\nThis statement is fundamentally wrong. The ability of an ion to fragment upon collisional activation (or other methods) is an intrinsic property of its chemical structure and charge, not its history.\n- A gas-phase fragment is simply a smaller peptide/protein ion. If isolated and subjected to an additional stage of fragmentation (MS$^3$), it will produce sequence-informative ions (e.g., $b/y$ ions) just like any other peptide of the same sequence.\n- Moreover, the problem statement itself notes that fragmentation during \"tandem acquisition\" is one source of the species in question. Tandem MS is precisely the technique used to generate sequence-informative ions. Therefore, by definition, some of these gas-phase fragments *are* the sequence-informative ions ($b/y$, $c/z$, etc.).\n\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2416811"}, {"introduction": "In an ideal experiment, each tandem mass spectrum would arise from a single peptide. In reality, co-eluting peptides often enter the mass spectrometer simultaneously, producing \"chimeric\" spectra that are a mixture of signals from multiple precursors. This hands-on coding exercise challenges you to tackle this problem directly by implementing an algorithm to deconvolve a chimeric spectrum [@problem_id:2416809]. You will model the observed spectrum $\\mathbf{y}$ as a linear combination of two template spectra, $\\mathbf{a}_1$ and $\\mathbf{a}_2$, and solve for their relative contributions, a classic problem in non-negative least squares.", "problem": "A tandem Mass Spectrometry (MS/MS) chimeric spectrum arises when two peptide precursors co-isolate and co-fragment, producing a single observed spectrum that is the superposition of two underlying peptide spectra. Let the observed spectrum be represented on a fixed centroided mass-to-charge grid in Thomson units (Th) as a nonnegative column vector $\\mathbf{y} \\in \\mathbb{R}_{\\ge 0}^{N}$, and let the two peptide-specific nonnegative template spectra be the column vectors $\\mathbf{a}_1, \\mathbf{a}_2 \\in \\mathbb{R}_{\\ge 0}^{N}$ whose elements encode the relative intensities at the same $N$ mass-to-charge bins. Assume that, within the considered window, each peptide’s isotopic envelope is well approximated by its provided template, and that co-elution implies the single-scan observation can be modeled as a linear combination\n$$\n\\mathbf{y} = c_1 \\mathbf{a}_1 + c_2 \\mathbf{a}_2 + \\boldsymbol{\\varepsilon},\n$$\nwhere $c_1 \\ge 0$ and $c_2 \\ge 0$ are the unknown peptide abundances to be estimated, and $\\boldsymbol{\\varepsilon}$ is an additive residual vector that may be zero. You must design a program that, given $(\\mathbf{a}_1, \\mathbf{a}_2, \\mathbf{y})$, returns the nonnegative pair $(\\hat{c}_1, \\hat{c}_2)$ that minimizes the squared Euclidean norm of the residual, that is,\n$$\n(\\hat{c}_1, \\hat{c}_2) = \\arg\\min_{c_1 \\ge 0,\\, c_2 \\ge 0} \\left\\| \\mathbf{y} - c_1 \\mathbf{a}_1 - c_2 \\mathbf{a}_2 \\right\\|_2^2.\n$$\nAll intensities are in arbitrary but consistent units, and mass-to-charge is in Thomson (Th). The outputs $(\\hat{c}_1, \\hat{c}_2)$ are dimensionless scalars.\n\nTest suite. For each test case below, $N$ and the vectors $\\mathbf{a}_1$, $\\mathbf{a}_2$, and $\\mathbf{y}$ are specified explicitly. Your program must compute $(\\hat{c}_1, \\hat{c}_2)$ for each case.\n\n- Test case $1$ (disjoint isotopic envelopes; no residual):\n  - $N = 6$.\n  - $\\mathbf{a}_1 = [\\,0.6,\\,0.3,\\,0.1,\\,0,\\,0,\\,0\\,]^{\\top}$.\n  - $\\mathbf{a}_2 = [\\,0,\\,0,\\,0,\\,0.5,\\,0.33,\\,0.17\\,]^{\\top}$.\n  - True abundances: $c_1 = 1.0$, $c_2 = 0.8$.\n  - $\\mathbf{y} = c_1 \\mathbf{a}_1 + c_2 \\mathbf{a}_2 = [\\,0.6,\\,0.3,\\,0.1,\\,0.4,\\,0.264,\\,0.136\\,]^{\\top}$.\n\n- Test case $2$ (partially overlapping isotopic envelopes; no residual):\n  - $N = 6$.\n  - $\\mathbf{a}_1 = [\\,0,\\,0.6,\\,0.3,\\,0.1,\\,0,\\,0\\,]^{\\top}$.\n  - $\\mathbf{a}_2 = [\\,0,\\,0,\\,0.5,\\,0.33,\\,0.17,\\,0\\,]^{\\top}$.\n  - True abundances: $c_1 = 1.2$, $c_2 = 0.7$.\n  - $\\mathbf{y} = c_1 \\mathbf{a}_1 + c_2 \\mathbf{a}_2 = [\\,0,\\,0.72,\\,0.71,\\,0.351,\\,0.119,\\,0\\,]^{\\top}$.\n\n- Test case $3$ (nearly collinear templates; no residual):\n  - $N = 3$.\n  - $\\mathbf{a}_1 = [\\,0.5,\\,0.3,\\,0.2\\,]^{\\top}$.\n  - $\\mathbf{a}_2 = [\\,0.52,\\,0.31,\\,0.17\\,]^{\\top}$.\n  - True abundances: $c_1 = 0.9$, $c_2 = 0.9$.\n  - $\\mathbf{y} = c_1 \\mathbf{a}_1 + c_2 \\mathbf{a}_2 = [\\,0.918,\\,0.549,\\,0.333\\,]^{\\top}$.\n\nRequired final output format. Your program should produce a single line of output containing the results for all test cases as a nested list, where each inner list is $[\\,\\hat{c}_1, \\hat{c}_2\\,]$ for the corresponding test case, with each float rounded to exactly six decimal places, in the order of test cases $1$, $2$, and $3$. For example, the output must have the form\n$$\n[\\,[\\,x_{1,1},x_{1,2}\\,],\\,[\\,x_{2,1},x_{2,2}\\,],\\,[\\,x_{3,1},x_{3,2}\\,]\\,],\n$$\nwhere each $x_{i,j}$ is a decimal representation with exactly six digits after the decimal point.", "solution": "The problem requires the determination of the non-negative abundances $(\\hat{c}_1, \\hat{c}_2)$ that best explain an observed chimeric mass spectrum $\\mathbf{y}$ as a linear combination of two template spectra, $\\mathbf{a}_1$ and $\\mathbf{a}_2$. The objective is to minimize the squared Euclidean norm of the residual vector, formulated as the following optimization problem:\n$$\n(\\hat{c}_1, \\hat{c}_2) = \\arg\\min_{c_1 \\ge 0,\\, c_2 \\ge 0} \\left\\| \\mathbf{y} - c_1 \\mathbf{a}_1 - c_2 \\mathbf{a}_2 \\right\\|_2^2.\n$$\nThis problem can be expressed more compactly in matrix algebra. Let the template spectra $\\mathbf{a}_1 \\in \\mathbb{R}_{\\ge 0}^{N}$ and $\\mathbf{a}_2 \\in \\mathbb{R}_{\\ge 0}^{N}$ be the columns of an $N \\times 2$ matrix $A$, and let the unknown abundances be the elements of a vector $\\mathbf{c} = [c_1, c_2]^{\\top} \\in \\mathbb{R}_{\\ge 0}^{2}$. The problem is then to find the vector $\\hat{\\mathbf{c}}$ that solves:\n$$\n\\hat{\\mathbf{c}} = \\arg\\min_{\\mathbf{c} \\ge \\mathbf{0}} \\left\\| \\mathbf{y} - A\\mathbf{c} \\right\\|_2^2.\n$$\nThis is a standard Non-Negative Least Squares (NNLS) problem. The objective function $f(\\mathbf{c}) = \\left\\| \\mathbf{y} - A\\mathbf{c} \\right\\|_2^2$ is a convex quadratic function of $\\mathbf{c}$, and the feasible region defined by the constraints $\\mathbf{c} \\ge \\mathbf{0}$ (i.e., $c_1 \\ge 0$ and $c_2 \\ge 0$) is a convex set. Consequently, this is a convex optimization problem which guarantees that any local minimum is also a global minimum. If the columns of $A$ are linearly independent, the solution is unique.\n\nWhile one could derive the solution by analyzing the Karush-Kuhn-Tucker (KKT) conditions for constrained optimization, this is generally non-trivial. A more practical and robust approach is to employ an iterative numerical algorithm. The active-set method, as developed by Lawson and Hanson, is a classic and widely-used algorithm for solving NNLS problems. It works by iteratively partitioning the variables in $\\mathbf{c}$ into an \"active set\" (where coefficients are fixed at zero) and a \"passive set\" (where coefficients are allowed to be positive), solving an unconstrained least squares problem on the passive set at each step, and updating the sets until the KKT conditions are satisfied.\n\nThe implementation will leverage standard scientific computing libraries that provide a robust solver for the NNLS problem. Specifically, the `scipy.optimize.nnls` function from the SciPy library in Python implements the aforementioned active-set algorithm.\n\nFor each test case, the solution procedure is as follows:\n1.  The input vectors $\\mathbf{a}_1$, $\\mathbf{a}_2$, and $\\mathbf{y}$ are defined.\n2.  The matrix $A$ is constructed by assembling $\\mathbf{a}_1$ and $\\mathbf{a}_2$ as its columns.\n3.  The `scipy.optimize.nnls` function is called with $A$ and $\\mathbf{y}$ as arguments.\n4.  The function returns the optimal non-negative coefficient vector $\\hat{\\mathbf{c}} = [\\hat{c}_1, \\hat{c}_2]^{\\top}$.\n\nIt is important to note that for all test cases provided, the observed spectrum $\\mathbf{y}$ is constructed as an exact linear combination of the templates with positive coefficients and no additive noise ($\\boldsymbol{\\varepsilon} = \\mathbf{0}$). For such noise-free cases, where the true solution lies in the interior of the feasible region (i.e., $c_1 > 0, c_2 > 0$), the NNLS solution coincides with the unconstrained Ordinary Least Squares (OLS) solution, $\\hat{\\mathbf{c}} = (A^{\\top}A)^{-1}A^{\\top}\\mathbf{y}$. Therefore, the algorithm is expected to recover the true abundances exactly. The use of a general NNLS solver ensures the methodology remains correct and applicable to more realistic scenarios involving measurement noise or cases where one component might be absent.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves for the non-negative abundances of two peptides in chimeric mass spectra\n    for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"a1\": np.array([0.6, 0.3, 0.1, 0.0, 0.0, 0.0]),\n            \"a2\": np.array([0.0, 0.0, 0.0, 0.5, 0.33, 0.17]),\n            \"y\": np.array([0.6, 0.3, 0.1, 0.4, 0.264, 0.136]),\n        },\n        {\n            \"a1\": np.array([0.0, 0.6, 0.3, 0.1, 0.0, 0.0]),\n            \"a2\": np.array([0.0, 0.0, 0.5, 0.33, 0.17, 0.0]),\n            \"y\": np.array([0.0, 0.72, 0.71, 0.351, 0.119, 0.0]),\n        },\n        {\n            \"a1\": np.array([0.5, 0.3, 0.2]),\n            \"a2\": np.array([0.52, 0.31, 0.17]),\n            \"y\": np.array([0.918, 0.549, 0.333]),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        a1 = case[\"a1\"]\n        a2 = case[\"a2\"]\n        y = case[\"y\"]\n\n        # Construct the matrix A from template vectors a1 and a2\n        A = np.stack([a1, a2], axis=1)\n\n        # Solve the Non-Negative Least Squares problem: argmin_c ||Ac - y||_2^2 for c >= 0\n        c, _ = nnls(A, y)\n        results.append(list(c))\n\n    # Format the results into the required string format.\n    # Each float must be represented with exactly six decimal places.\n    # The final format is a nested list string representation, e.g., [[c1,c2],[c1,c2],...].\n    formatted_pairs = []\n    for pair in results:\n        formatted_pair_str = [f\"{val:.6f}\" for val in pair]\n        formatted_pairs.append(f\"[{','.join(formatted_pair_str)}]\")\n    \n    final_output = f\"[{','.join(formatted_pairs)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2416809"}]}