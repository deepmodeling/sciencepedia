{"hands_on_practices": [{"introduction": "In RNA sequencing analysis, raw read counts can be misleading when comparing gene expression across different samples. This initial hands-on practice introduces a foundational normalization method, Reads Per Kilobase per Million mapped reads (RPKM), to correct for variations in library size (sequencing depth). By working through this simple but powerful example [@problem_id:2424950], you'll see firsthand why direct comparison of raw counts is insufficient for accurate analysis and how normalization provides a clearer picture.", "problem": "An RNA sequencing experiment profiles a single gene across two samples. In Sample A, the gene receives $1$ uniquely mapped read out of $10 \\times 10^{6}$ total uniquely mapped reads. In Sample B, the gene receives $2$ uniquely mapped reads out of $20 \\times 10^{6}$ total uniquely mapped reads. The gene’s length is $1$ kilobase (kb). Reads per kilobase of transcript per million mapped reads (RPKM) is defined as the number of reads assigned to a gene, normalized by the gene’s length in kilobases and by the total number of mapped reads in millions.\n\nCompute the expression fold-change of this gene measured by RPKM, defined as the ratio of the gene’s RPKM in Sample B to its RPKM in Sample A. Report your answer as a pure number (unitless) and round your answer to three significant figures.", "solution": "The problem statement will first be subjected to rigorous validation.\n\n**Step 1: Extract Givens**\n- Sample A: Gene receives $1$ uniquely mapped read.\n- Sample A: Total uniquely mapped reads are $10 \\times 10^{6}$.\n- Sample B: Gene receives $2$ uniquely mapped reads.\n- Sample B: Total uniquely mapped reads are $20 \\times 10^{6}$.\n- Gene length: $1$ kilobase (kb).\n- Definition of RPKM (Reads Per Kilobase of transcript per Million mapped reads): \"the number of reads assigned to a gene, normalized by the gene’s length in kilobases and by the total number of mapped reads in millions\".\n- Required computation: Fold-change, defined as the ratio of the gene’s RPKM in Sample B to its RPKM in Sample A.\n- Required format: Pure number, rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the required criteria.\n- **Scientifically Grounded**: The problem describes a standard, fundamental calculation in RNA sequencing data analysis. RPKM is a well-established, though now often superseded, metric for normalizing gene expression. The values provided are plausible for a real experiment. The problem is scientifically sound.\n- **Well-Posed**: All necessary data and definitions are provided. The objective is clear and leads to a unique, stable solution. The problem is well-posed.\n- **Objective**: The problem is stated using precise, quantitative, and unbiased language. It is free of subjective or opinion-based claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically grounded, well-posed, objective, and complete. A solution will now be derived.\n\nThe problem requires the computation of a fold-change in gene expression between two samples, where expression is quantified using the Reads Per Kilobase of transcript per Million mapped reads (RPKM) metric.\n\nLet us define the variables from the problem statement:\n- $C_A$: number of reads mapped to the gene in Sample A, $C_A = 1$.\n- $N_A$: total number of mapped reads in Sample A, $N_A = 10 \\times 10^{6}$.\n- $C_B$: number of reads mapped to the gene in Sample B, $C_B = 2$.\n- $N_B$: total number of mapped reads in Sample B, $N_B = 20 \\times 10^{6}$.\n- $L$: length of the gene in kilobases (kb), $L = 1$.\n\nThe definition of RPKM is given as:\n$$ \\text{RPKM} = \\frac{\\text{Number of reads}}{(\\text{Gene length in kb}) \\times (\\text{Total reads in millions})} $$\nThis can be formulated mathematically. The total number of reads in millions is the total read count divided by $10^6$.\n$$ \\text{RPKM} = \\frac{C}{L \\times (N / 10^6)} $$\nwhere $C$ is the read count for the gene, $L$ is the gene length in kb, and $N$ is the total library size (total mapped reads).\n\nFirst, we calculate the RPKM for Sample A ($\\text{RPKM}_A$):\n$$ \\text{RPKM}_A = \\frac{C_A}{L \\times (N_A / 10^6)} $$\nSubstituting the given values:\n$$ \\text{RPKM}_A = \\frac{1}{1 \\times (10 \\times 10^6 / 10^6)} = \\frac{1}{1 \\times 10} = 0.1 $$\n\nNext, we calculate the RPKM for Sample B ($\\text{RPKM}_B$):\n$$ \\text{RPKM}_B = \\frac{C_B}{L \\times (N_B / 10^6)} $$\nSubstituting the given values:\n$$ \\text{RPKM}_B = \\frac{2}{1 \\times (20 \\times 10^6 / 10^6)} = \\frac{2}{1 \\times 20} = \\frac{2}{20} = 0.1 $$\n\nThe problem asks for the fold-change (FC), defined as the ratio of $\\text{RPKM}_B$ to $\\text{RPKM}_A$.\n$$ \\text{FC} = \\frac{\\text{RPKM}_B}{\\text{RPKM}_A} $$\nSubstituting the calculated RPKM values:\n$$ \\text{FC} = \\frac{0.1}{0.1} = 1 $$\n\nAlternatively, we can compute the fold-change symbolically first, which is a more robust method.\n$$ \\text{FC} = \\frac{\\text{RPKM}_B}{\\text{RPKM}_A} = \\frac{\\frac{C_B}{L \\times (N_B / 10^6)}}{\\frac{C_A}{L \\times (N_A / 10^6)}} $$\nThe gene length $L$ and the scaling factor $10^6$ are common to both the numerator and the denominator, and thus they cancel out:\n$$ \\text{FC} = \\frac{C_B / N_B}{C_A / N_A} = \\frac{C_B}{C_A} \\times \\frac{N_A}{N_B} $$\nThis expression shows that the RPKM fold-change is the ratio of raw read counts, corrected by the inverse ratio of the total library sizes. Now, we substitute the numerical values into this simplified expression:\n$$ \\text{FC} = \\frac{2}{1} \\times \\frac{10 \\times 10^6}{20 \\times 10^6} = 2 \\times \\frac{10}{20} = 2 \\times \\frac{1}{2} = 1 $$\n\nThe result is exactly $1$. The problem requires the answer to be rounded to three significant figures. To express $1$ with three significant figures, we write it as $1.00$. This indicates that the value is precise to the hundredths place.\nThe doubling of the raw read count (from $1$ to $2$) is perfectly offset by the doubling of the sequencing depth (from $10$ million to $20$ million reads), resulting in an identical normalized expression value and thus a fold-change of $1$.", "answer": "$$\n\\boxed{1.00}\n$$", "id": "2424950"}, {"introduction": "After learning to compare a single gene's expression *between* samples, we now turn to comparing the expression of different genes *within* the same sample. This exercise [@problem_id:2424999] introduces Transcripts Per Million (TPM), a metric specifically designed for this type of within-sample comparison. Through this problem, you will not only calculate relative expression levels but also uncover a key mathematical property of TPM that simplifies these comparisons and distinguishes it from RPKM.", "problem": "An RNA sequencing experiment yields uniquely mapped read counts for two single-isoform genes measured in the same sample. Gene $\\mathcal{A}$ has length $500$ base pairs (bp) and has $50$ mapped reads. Gene $\\mathcal{B}$ has length $5000$ bp and has $450$ mapped reads. Transcripts Per Million (TPM) is defined as a within-sample expression measure obtained by first normalizing each gene’s read count by its transcript length in kilobases and then scaling the resulting values so that their sum across all genes in the sample equals one million.\n\nUsing only the information above and the definition of TPM, determine which gene is more highly expressed in this sample by computing the ratio $\\mathrm{TPM}_{\\mathcal{A}} / \\mathrm{TPM}_{\\mathcal{B}}$. Express your answer as an exact fraction with no units. The final answer must be a single real-valued number.", "solution": "The problem requires the calculation of the ratio of Transcripts Per Million ($\\mathrm{TPM}$) for two genes, $\\mathcal{A}$ and $\\mathcal{B}$, from a single RNA sequencing sample.\n\nFirst, we must rigorously formalize the definition of $\\mathrm{TPM}$ as provided. Let $C_i$ be the number of uniquely mapped reads for a gene $i$, and let $L_i$ be the length of gene $i$ in base pairs (bp). The definition involves two steps.\n\nStep 1: Normalize the read count by gene length in kilobases (kb).\nThe length of gene $i$ in kilobases, denoted $L_{i, \\text{kb}}$, is given by $L_{i, \\text{kb}} = \\frac{L_i}{1000}$.\nThe length-normalized read count, which we will call $R_i$, is the ratio of the read count to the gene length in kilobases:\n$$R_i = \\frac{C_i}{L_{i, \\text{kb}}} = \\frac{C_i}{L_i / 1000}$$\n\nStep 2: Scale these normalized counts so that their sum across all genes in the sample equals one million ($10^6$).\nLet $\\mathcal{G}$ represent the set of all genes in the sample. The sum of all length-normalized read counts is given by the scaling factor $S$:\n$$S = \\sum_{j \\in \\mathcal{G}} R_j$$\nThe $\\mathrm{TPM}$ value for an individual gene $i$ is then calculated as:\n$$\\mathrm{TPM}_i = \\left( \\frac{R_i}{S} \\right) \\times 10^6$$\n\nWe are given the following data:\nFor gene $\\mathcal{A}$:\n- Read count: $C_{\\mathcal{A}} = 50$\n- Length: $L_{\\mathcal{A}} = 500$ bp\n\nFor gene $\\mathcal{B}$:\n- Read count: $C_{\\mathcal{B}} = 450$\n- Length: $L_{\\mathcal{B}} = 5000$ bp\n\nWe now apply Step 1 to each gene.\nFor gene $\\mathcal{A}$, the length in kilobases is $L_{\\mathcal{A}, \\text{kb}} = \\frac{500}{1000} = 0.5$ kb.\nThe length-normalized read count for gene $\\mathcal{A}$ is:\n$$R_{\\mathcal{A}} = \\frac{C_{\\mathcal{A}}}{L_{\\mathcal{A}, \\text{kb}}} = \\frac{50}{0.5} = 100$$\n\nFor gene $\\mathcal{B}$, the length in kilobases is $L_{\\mathcal{B}, \\text{kb}} = \\frac{5000}{1000} = 5$ kb.\nThe length-normalized read count for gene $\\mathcal{B}$ is:\n$$R_{\\mathcal{B}} = \\frac{C_{\\mathcal{B}}}{L_{\\mathcal{B}, \\text{kb}}} = \\frac{450}{5} = 90$$\n\nThe problem asks for the ratio $\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}}$. Using the formula for $\\mathrm{TPM}$, we can write this ratio as:\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{\\left( \\frac{R_{\\mathcal{A}}}{S} \\right) \\times 10^6}{\\left( \\frac{R_{\\mathcal{B}}}{S} \\right) \\times 10^6}$$\n\nThe per-million scaling factor, $10^6$, and the total sum of normalized reads, $S$, are identical for both genes as they are measured in the same sample. Therefore, these terms cancel out from the ratio:\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{R_{\\mathcal{A}}}{R_{\\mathcal{B}}}$$\nThis shows that the ratio of $\\mathrm{TPM}$ values between two genes in the same sample depends only on their respective read counts and lengths, not on any other genes in the library.\n\nSubstituting the calculated values for $R_{\\mathcal{A}}$ and $R_{\\mathcal{B}}$:\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{100}{90}$$\nSimplifying this fraction gives the final result:\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{10}{9}$$\nSince the ratio $\\frac{10}{9} > 1$, it is evident that $\\mathrm{TPM}_{\\mathcal{A}} > \\mathrm{TPM}_{\\mathcal{B}}$, which means gene $\\mathcal{A}$ is more highly expressed than gene $\\mathcal{B}$ in this sample. The problem asks for the numerical value of this ratio.", "answer": "$$\\boxed{\\frac{10}{9}}$$", "id": "2424999"}, {"introduction": "Our final practice consolidates these concepts by applying them to a small, realistic dataset containing multiple genes. You will perform a complete Transcripts Per Million (TPM) calculation, which involves normalizing for gene length and then scaling based on the entire set of expressed genes in the sample. This culminating exercise [@problem_id:2424928] demonstrates the critical importance of proper normalization, revealing how it can fundamentally alter the rank order of gene expression and, therefore, our biological interpretations.", "problem": "An experiment profiles messenger ribonucleic acid (mRNA) expression using single-end RNA sequencing across a single sample. Consider the following gene-level dataset, where each gene $G_{i}$ has a transcript length and an observed raw read count. The total number of mapped reads equals the sum of the raw counts shown.\n\n- Gene $G_{1}$: length $2000$ bp, raw count $4000$\n- Gene $G_{2}$: length $10000$ bp, raw count $9000$\n- Gene $G_{3}$: length $1500$ bp, raw count $3500$\n- Gene $G_{4}$: length $3000$ bp, raw count $5000$\n- Gene $G_{5}$: length $500$ bp, raw count $1200$\n- Gene $G_{6}$: length $8000$ bp, raw count $7000$\n- Gene $G_{7}$: length $1200$ bp, raw count $3000$\n\nThis dataset is constructed so that the rank order of the top $5$ most expressed genes differs when using raw counts versus normalized expression metrics. Use the standard single-sample definitions of Reads Per Kilobase per Million mapped reads (RPKM) and Transcripts Per Million (TPM). Fragments Per Kilobase of transcript per Million mapped reads (FPKM) is not applicable here because the data are single-end.\n\nCompute the TPM value for gene $G_{5}$. Round your answer to four significant figures. Express the final value in TPM units.", "solution": "The problem statement is a standard exercise in bioinformatics, specifically in the normalization of RNA sequencing data. It asks for the calculation of Transcripts Per Million (TPM) for a specific gene from a given dataset of raw read counts and gene lengths.\n\nFirst, the validity of the problem is assessed.\n\nGivens are extracted verbatim:\n- Gene $G_{1}$: length $2000$ bp, raw count $4000$\n- Gene $G_{2}$: length $10000$ bp, raw count $9000$\n- Gene $G_{3}$: length $1500$ bp, raw count $3500$\n- Gene $G_{4}$: length $3000$ bp, raw count $5000$\n- Gene $G_{5}$: length $500$ bp, raw count $1200$\n- Gene $G_{6}$: length $8000$ bp, raw count $7000$\n- Gene $G_{7}$: length $1200$ bp, raw count $3000$\n- Data is from single-end RNA sequencing.\n- The total number of mapped reads equals the sum of the raw counts shown.\n- Standard definitions of RPKM and TPM apply.\n- FPKM is not applicable.\n- The task is to compute the TPM for gene $G_{5}$ and round to four significant figures.\n\nThe problem is scientifically grounded, as TPM is a widely used metric for normalizing gene expression data. It is well-posed, providing all necessary data ($7$ genes with their lengths and read counts) for a unique solution. The language is objective and precise. The problem contains no scientific fallacies, contradictions, or ambiguities. Therefore, the problem is deemed valid and a rigorous solution will be derived.\n\nThe Transcripts Per Million (TPM) normalization method is designed to account for biases from both gene length and sequencing depth. The calculation proceeds in two steps. First, raw read counts are normalized by the length of the gene transcript. Second, these length-normalized counts are then normalized by the total \"number\" of transcripts in the sample to ensure that the sum of all TPM values is one million.\n\nLet $C_{i}$ be the raw read count for gene $i$, and $L_{i}$ be the length of gene $i$ in base pairs (bp).\n\nStep 1: Normalize each gene's read count by its length. We express the gene length in kilobases (kb), where $1$ kb $= 1000$ bp. For each gene $i$, we compute a rate $R_{i}$ which represents reads per kilobase of transcript.\n$$R_{i} = \\frac{C_{i}}{L_{i} / 1000}$$\nWe compute this value for all $7$ genes in the dataset.\n\nFor gene $G_{1}$: $R_{1} = \\frac{4000}{2000 / 1000} = \\frac{4000}{2} = 2000$\nFor gene $G_{2}$: $R_{2} = \\frac{9000}{10000 / 1000} = \\frac{9000}{10} = 900$\nFor gene $G_{3}$: $R_{3} = \\frac{3500}{1500 / 1000} = \\frac{3500}{1.5} = \\frac{7000}{3}$\nFor gene $G_{4}$: $R_{4} = \\frac{5000}{3000 / 1000} = \\frac{5000}{3}$\nFor gene $G_{5}$: $R_{5} = \\frac{1200}{500 / 1000} = \\frac{1200}{0.5} = 2400$\nFor gene $G_{6}$: $R_{6} = \\frac{7000}{8000 / 1000} = \\frac{7000}{8} = 875$\nFor gene $G_{7}$: $R_{7} = \\frac{3000}{1200 / 1000} = \\frac{3000}{1.2} = 2500$\n\nStep 2: Normalize these rates to a total sum of one million. To do this, we first compute the sum of all the rates, which we denote as $S$.\n$$S = \\sum_{i=1}^{7} R_{i}$$\n$$S = 2000 + 900 + \\frac{7000}{3} + \\frac{5000}{3} + 2400 + 875 + 2500$$\nCombining the integer terms and the fractional terms separately:\n$$S = (2000 + 900 + 2400 + 875 + 2500) + \\left(\\frac{7000}{3} + \\frac{5000}{3}\\right)$$\n$$S = 8675 + \\frac{12000}{3} = 8675 + 4000 = 12675$$\nThis sum $S$ is the scaling factor for the sample.\n\nThe TPM for a specific gene $i$ is then calculated by taking its rate $R_{i}$, dividing by the total sum of rates $S$, and multiplying by $10^{6}$.\n$$TPM_{i} = \\frac{R_{i}}{S} \\times 10^{6}$$\nWe are asked to compute the TPM for gene $G_{5}$. We use the values $R_{5} = 2400$ and $S = 12675$.\n$$TPM_{5} = \\frac{2400}{12675} \\times 10^{6}$$\nNow, we perform the numerical calculation:\n$$TPM_{5} \\approx 0.1893491124 \\times 10^{6} = 189349.1124$$\nThe problem requires the answer to be rounded to four significant figures. The number is $189349.1124...$. The first four significant digits are $1$, $8$, $9$, and $3$. The fifth significant digit is $4$. Since $4 < 5$, we round down, which means we keep the fourth significant digit as is and replace the subsequent digits with zeros to maintain the magnitude.\nThe rounded value is $189300$.\n\nExpressed in scientific notation to explicitly show four significant figures, this is $1.893 \\times 10^{5}$. The units are TPM, but as per global formatting rules, units are omitted from the final boxed answer.", "answer": "$$\n\\boxed{1.893 \\times 10^{5}}\n$$", "id": "2424928"}]}