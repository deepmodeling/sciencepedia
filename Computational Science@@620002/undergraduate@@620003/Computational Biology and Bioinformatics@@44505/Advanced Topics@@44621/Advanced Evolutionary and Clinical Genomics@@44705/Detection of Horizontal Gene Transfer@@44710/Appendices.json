{"hands_on_practices": [{"introduction": "A foundational method for detecting Horizontal Gene Transfer (HGT) is to search for genes whose sequence composition markedly differs from the host genome's average. This practice introduces a powerful statistical approach, Principal Component Analysis (PCA), to quantify this compositional distinctiveness [@problem_id:2385117]. By analyzing tetranucleotide frequencies, you will learn to project high-dimensional compositional data into a lower-dimensional space where anomalous genes, potential HGT candidates, can be identified as statistical outliers.", "problem": "You are given a collection of deoxyribonucleic acid (DNA) coding regions from a single prokaryotic genome. For each coding region (gene), the counts of a fixed set of tetranucleotides (four-nucleotide words) have been tabulated. The biological hypothesis is that genes acquired by horizontal gene transfer have compositional patterns that deviate from the genome’s typical tetranucleotide usage. Your task is to formalize this hypothesis as a purely mathematical detection rule applied to the provided count data and to implement it as a complete program that flags anomalous genes.\n\nMathematical setup. Let there be $n_g$ genes and $n_k$ tetranucleotide categories. For gene $i \\in \\{0,\\dots,n_g-1\\}$, let $\\mathbf{c}_i \\in \\mathbb{N}_0^{n_k}$ denote the count vector of the prescribed tetranucleotide categories, and let $N_i = \\sum_{j=0}^{n_k-1} c_{i,j}$ be the total count for gene $i$. Define the frequency vector $\\mathbf{f}_i \\in \\mathbb{R}^{n_k}$ by $f_{i,j} = c_{i,j} / N_i$ for all $j$. Let the mean frequency vector be $\\boldsymbol{\\mu} = \\frac{1}{n_g}\\sum_{i=0}^{n_g-1} \\mathbf{f}_i$. Define the centered vectors $\\mathbf{z}_i = \\mathbf{f}_i - \\boldsymbol{\\mu}$. Let the empirical covariance matrix be\n$$\n\\boldsymbol{\\Sigma} = \\frac{1}{n_g - 1} \\sum_{i=0}^{n_g-1} \\mathbf{z}_i \\mathbf{z}_i^\\top \\in \\mathbb{R}^{n_k \\times n_k}.\n$$\nLet the eigendecomposition of $\\boldsymbol{\\Sigma}$ be $\\boldsymbol{\\Sigma} = \\mathbf{V}\\boldsymbol{\\Lambda}\\mathbf{V}^\\top$, where $\\boldsymbol{\\Lambda} = \\mathrm{diag}(\\lambda_1,\\dots,\\lambda_{n_k})$ with $\\lambda_1 \\ge \\lambda_2 \\ge \\dots \\ge \\lambda_{n_k} \\ge 0$, and $\\mathbf{V} = [\\mathbf{v}_1,\\dots,\\mathbf{v}_{n_k}]$ contains orthonormal eigenvectors. For a chosen integer $m$ with $1 \\le m \\le n_k$, let $\\mathbf{V}_m = [\\mathbf{v}_1,\\dots,\\mathbf{v}_m]$ and $\\boldsymbol{\\Lambda}_m = \\mathrm{diag}(\\lambda_1,\\dots,\\lambda_m)$. Define the projected coordinates (scores) for gene $i$ as $\\mathbf{y}_i = \\mathbf{V}_m^\\top \\mathbf{z}_i \\in \\mathbb{R}^m$. Define the squared distance\n$$\nd_i^2 = \\sum_{j=1}^{m} \\frac{y_{i,j}^2}{\\lambda_j},\n$$\nwith the convention that any term with $\\lambda_j = 0$ contributes $0$ to the sum. A gene $i$ is flagged as anomalous if and only if $d_i^2$ is strictly greater than a given positive threshold $\\tau$.\n\nData. Use $n_g = 10$ genes and $n_k = 8$ tetranucleotide categories in the fixed order\n$$\n[\\text{AAAA}, \\text{AAAT}, \\text{AATA}, \\text{ATAA}, \\text{TAAA}, \\text{GCGC}, \\text{CGCG}, \\text{CCGG}].\n$$\nThe count vectors $\\mathbf{c}_i$ for $i \\in \\{0,\\dots,9\\}$ are:\n- $i=0$: $[120, 110, 95, 105, 115, 4, 3, 2]$,\n- $i=1$: $[130, 100, 100, 110, 120, 3, 2, 2]$,\n- $i=2$: $[115, 120, 90, 95, 125, 5, 4, 3]$,\n- $i=3$: $[125, 115, 85, 100, 110, 6, 4, 5]$,\n- $i=4$: $[140, 105, 100, 100, 100, 8, 5, 4]$,\n- $i=5$: $[118, 112, 98, 108, 118, 7, 5, 4]$,\n- $i=6$: $[122, 118, 89, 102, 120, 6, 5, 4]$,\n- $i=7$: $[128, 107, 92, 106, 112, 5, 4, 4]$,\n- $i=8$: $[15, 12, 10, 9, 8, 160, 150, 155]$,\n- $i=9$: $[12, 9, 8, 7, 10, 155, 165, 150]$.\n\nTest suite. Your program must execute the detection rule above for each of the following parameter cases, each specified by the pair $(m,\\tau)$:\n- Case $1$: $(m,\\tau) = (2, 10.0)$,\n- Case $2$: $(m,\\tau) = (2, 10^{-6})$,\n- Case $3$: $(m,\\tau) = (2, 10^{9})$.\n\nNumerical details. All computations are in real arithmetic. For the eigenvalues $\\lambda_j$, use only those strictly greater than an absolute tolerance $\\varepsilon = 10^{-12}$ when forming $d_i^2$; any $\\lambda_j \\le \\varepsilon$ contributes $0$ to the sum. Indices of flagged genes must be reported using zero-based indexing and must be sorted in strictly increasing order for each case.\n\nRequired final output format. Your program should produce a single line of output containing a list of three elements, one per case, where each element is a list of the flagged gene indices for that case. The format must be exactly a single line with no spaces, for example, \"[[a,b],[c,d,e],[]]\" where $a,b,c,d,e$ are integers.", "solution": "The problem posed is a valid and well-defined exercise in computational biology, specifically in the sub-field of comparative genomics. It requires the implementation of a statistical anomaly detection algorithm to identify genes that may have been acquired through horizontal gene transfer. The underlying premise—that horizontally transferred genes exhibit atypical nucleotide composition compared to the host genome's native genes—is a well-established principle used in bioinformatics for this purpose. The specified methodology is a standard application of Principal Component Analysis (PCA), a robust technique for analyzing multivariate data. The problem provides all necessary data, parameters, and a clear, unambiguous mathematical formulation. Therefore, a direct solution is possible and warranted.\n\nThe solution proceeds through the following formal steps:\n\n1.  **Data Normalization**: The raw counts of tetranucleotides for each gene, denoted by the vector $\\mathbf{c}_i \\in \\mathbb{N}_0^{n_k}$ for the $i$-th gene, are dependent on gene length. To analyze compositional properties independent of length, the counts are converted into frequencies. The total count for gene $i$ is $N_i = \\sum_{j=0}^{n_k-1} c_{i,j}$. The frequency vector $\\mathbf{f}_i \\in \\mathbb{R}^{n_k}$ is then computed, with elements $f_{i,j} = c_{i,j} / N_i$. This ensures that each gene is represented by a vector whose components sum to $1$, placing all genes on a comparable scale.\n\n2.  **Data Centering**: The dataset of frequency vectors $\\{\\mathbf{f}_i\\}_{i=0}^{n_g-1}$ is centered by subtracting the mean frequency vector, $\\boldsymbol{\\mu} = \\frac{1}{n_g}\\sum_{i=0}^{n_g-1} \\mathbf{f}_i$. This transformation yields a set of centered vectors $\\mathbf{z}_i = \\mathbf{f}_i - \\boldsymbol{\\mu}$. Each vector $\\mathbf{z}_i$ now represents the deviation of gene $i$'s composition from the average composition of the entire genome sample. The mean of the set $\\{\\mathbf{z}_i\\}$ is the zero vector.\n\n3.  **Principal Component Analysis**: The core of the method is to identify the principal axes of variation in the centered data. This is achieved by computing the empirical sample covariance matrix, $\\boldsymbol{\\Sigma} = \\frac{1}{n_g - 1} \\sum_{i=0}^{n_g-1} \\mathbf{z}_i \\mathbf{z}_i^\\top$. The eigendecomposition of this real, symmetric matrix, $\\boldsymbol{\\Sigma} = \\mathbf{V}\\boldsymbol{\\Lambda}\\mathbf{V}^\\top$, yields the principal components. The columns of the orthogonal matrix $\\mathbf{V}$ are the eigenvectors $\\mathbf{v}_j$, which define the directions of principal axes. The diagonal entries of $\\boldsymbol{\\Lambda}$, the eigenvalues $\\lambda_j$, represent the variance of the data projected onto the corresponding eigenvectors. The eigenvalues are sorted in descending order, $\\lambda_1 \\ge \\lambda_2 \\ge \\dots \\ge \\lambda_{n_k} \\ge 0$, so that $\\mathbf{v}_1$ corresponds to the direction of maximum variance.\n\n4.  **Dimensionality Reduction**: The analysis focuses on the subspace spanned by the first $m$ principal components, which capture the most significant variance in the dataset. Each centered data vector $\\mathbf{z}_i$ is projected onto this subspace to obtain a vector of scores, $\\mathbf{y}_i = \\mathbf{V}_m^\\top \\mathbf{z}_i \\in \\mathbb{R}^m$, where $\\mathbf{V}_m = [\\mathbf{v}_1, \\dots, \\mathbf{v}_m]$. The $j$-th component of the score vector, $y_{i,j} = \\mathbf{v}_j^\\top \\mathbf{z}_i$, quantifies the extent to which gene $i$'s deviation from the mean aligns with the $j$-th principal axis of variation.\n\n5.  **Anomaly Score Calculation**: To quantify how anomalous each gene is, a distance metric is calculated in the reduced $m$-dimensional space. The specified squared distance is $d_i^2 = \\sum_{j=1}^{m} \\frac{y_{i,j}^2}{\\lambda_j}$. This is the squared Mahalanobis distance of the projected point from the origin. By dividing each squared score $y_{i,j}^2$ by its corresponding variance $\\lambda_j$, the distance is normalized. This creates a scale-invariant measure of how many standard deviations a gene is from the compositional average along each principal axis. Terms for which the eigenvalue $\\lambda_j$ is effectively zero (i.e., $\\le \\varepsilon=10^{-12}$) are excluded from the sum, preventing numerical instability and acknowledging that there is no variation along such dimensions.\n\n6.  **Classification Rule**: Finally, a gene $i$ is flagged as anomalous if its anomaly score $d_i^2$ is strictly greater than a predefined positive threshold $\\tau$. This provides a clear, quantitative criterion for identifying genes with compositional patterns that are statistically divergent from the genomic norm. The procedure is executed for each specified pair of parameters $(m, \\tau)$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the HGT detection problem by implementing the specified\n    multivariate statistical analysis.\n    \"\"\"\n    # Define constants and data from the problem statement.\n    n_g = 10\n    n_k = 8\n    epsilon = 1e-12\n\n    # Gene count vectors c_i\n    counts = np.array([\n        [120, 110, 95, 105, 115, 4, 3, 2],    # Gene 0\n        [130, 100, 100, 110, 120, 3, 2, 2],    # Gene 1\n        [115, 120, 90, 95, 125, 5, 4, 3],    # Gene 2\n        [125, 115, 85, 100, 110, 6, 4, 5],    # Gene 3\n        [140, 105, 100, 100, 100, 8, 5, 4],    # Gene 4\n        [118, 112, 98, 108, 118, 7, 5, 4],    # Gene 5\n        [122, 118, 89, 102, 120, 6, 5, 4],    # Gene 6\n        [128, 107, 92, 106, 112, 5, 4, 4],    # Gene 7\n        [15, 12, 10, 9, 8, 160, 150, 155], # Gene 8\n        [12, 9, 8, 7, 10, 155, 165, 150]  # Gene 9\n    ], dtype=float)\n\n    # Test cases (m, tau)\n    test_cases = [\n        (2, 10.0),\n        (2, 1e-6),\n        (2, 1e9)\n    ]\n\n    # --- Step 1: Calculate Frequency Vectors ---\n    # N_i: total counts for each gene\n    total_counts = counts.sum(axis=1)\n    # f_i,j = c_i,j / N_i\n    frequencies = counts / total_counts[:, np.newaxis]\n\n    # --- Step 2: Center the Data ---\n    # mu: mean frequency vector\n    mean_freq = frequencies.mean(axis=0)\n    # z_i = f_i - mu\n    centered_vectors = frequencies - mean_freq\n\n    # --- Step 3: P.C.A. - Covariance and Eigendecomposition ---\n    # Sigma: sample covariance matrix. ddof=1 for division by (n_g - 1).\n    # rowvar=False because observations (genes) are rows, variables are columns.\n    cov_matrix = np.cov(frequencies, rowvar=False, ddof=1)\n    \n    # Eigendecomposition of the symmetric covariance matrix\n    eigenvalues, eigenvectors = np.linalg.eigh(cov_matrix)\n\n    # Sort eigenvalues and eigenvectors in descending order\n    sorted_indices = np.argsort(eigenvalues)[::-1]\n    sorted_eigenvalues = eigenvalues[sorted_indices]\n    sorted_eigenvectors = eigenvectors[:, sorted_indices]\n\n    all_results = []\n    \n    for m, tau in test_cases:\n        # --- Step 4: Project Data onto Principal Components ---\n        # V_m: matrix of first m eigenvectors\n        V_m = sorted_eigenvectors[:, :m]\n        \n        # y_i = V_m^T * z_i, calculated for all genes at once\n        # Resulting 'scores' matrix has shape (n_g, m)\n        scores = centered_vectors @ V_m\n\n        # --- Step 5: Calculate Anomaly Distances ---\n        # lambdas_m: first m eigenvalues\n        lambdas_m = sorted_eigenvalues[:m]\n        \n        # Calculate inverse eigenvalues, handling values below epsilon\n        inv_lambdas_m = np.array([1.0/val if val > epsilon else 0.0 for val in lambdas_m])\n\n        # d_i^2 = sum_{j=1 to m} (y_i,j^2 / lambda_j)\n        # This is a dot product of squared scores with inverse eigenvalues\n        d_squared = (scores**2) @ inv_lambdas_m\n\n        # --- Step 6: Flag Anomalous Genes ---\n        # Find indices where d_i^2 > tau\n        flagged_indices = np.where(d_squared > tau)[0].tolist()\n        \n        # The problem requires indices to be sorted, which np.where guarantees.\n        all_results.append(flagged_indices)\n        \n    # Final print statement in the exact required format: [[...],[...],[...]]\n    # Manually construct the string to avoid spaces introduced by str() or repr().\n    inner_parts = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output_string = f\"[{','.join(inner_parts)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2385117"}, {"introduction": "While compositional methods are powerful, they can fail when a gene is transferred between closely related species with similar genomic signatures. This exercise introduces a second, independent line of evidence: phylogenetic analysis. You will use the principle of Maximum Parsimony to determine whether a patchy gene distribution across a species tree is better explained by a single HGT event or by multiple gene loss events [@problem_id:2385158]. This practice hones crucial logical reasoning skills for interpreting evolutionary histories and weighing competing scenarios.", "problem": "Consider a rooted, bifurcating species tree on taxa $A,B,C,D,E,F,G,H$ with the following topology: the root splits into two clades, $X$ and $Y$. Clade $X$ further splits into two subclades with leaves $(A,B)$ and $(C,D)$, and clade $Y$ further splits into two subclades with leaves $(E,F)$ and $(G,H)$. Thus, the topology is the resolved binary tree corresponding to the Newick description $(((A,B),(C,D)),((E,F),(G,H)))$, with the root at the split between $X$ and $Y$.\n\nYou survey an operon of $m$ genes involved in aromatic compound degradation and find that the operon is present (all $m$ genes syntenic and co-occurring) in taxa $E$ and $F$, and absent (no operon genes detected) in taxa $A,B,C,D,G,H$. Assume the following two hypotheses:\n\n- Hypothesis $\\mathrm{L}$ (loss-dominated vertical inheritance): The operon was present in the last common ancestor of all eight taxa and thereafter can only be lost as a single block along any branch (no horizontal acquisition is allowed). Under this hypothesis, the parsimony score is the minimal number of block-loss events required to explain the observed present/absent pattern on the given rooted species tree.\n\n- Hypothesis $\\mathrm{T}$ (single-event horizontal gene transfer): The operon was absent in the last common ancestor of all eight taxa, and it can be introduced by at most one horizontal gene transfer event into a single branch of the species tree; after introduction, it is inherited vertically and can be lost as a single block along any branch. Under this hypothesis, the parsimony score is the minimal number of events, counting the single horizontal transfer as one event and each subsequent block-loss as one event.\n\nUsing the principle of Maximum Parsimony (MP), which selects the scenario that minimizes the total number of evolutionary events consistent with the constraints of each hypothesis, compute the parsimony advantage of $\\mathrm{T}$ over $\\mathrm{L}$, defined as\n$$\n\\Delta \\;=\\; E_{\\mathrm{L}} \\;-\\; E_{\\mathrm{T}},\n$$\nwhere $E_{\\mathrm{L}}$ and $E_{\\mathrm{T}}$ are the minimal event counts under hypotheses $\\mathrm{L}$ and $\\mathrm{T}$, respectively. Express your final answer as an integer. No rounding is required.", "solution": "The problem requires the calculation of parsimony scores for two competing evolutionary hypotheses, followed by the determination of the parsimony advantage of one over the other. The subject is a character state (presence/absence of an operon) distributed on a given fixed species tree. The principle of Maximum Parsimony dictates that the preferred evolutionary scenario is the one that requires the minimum number of events. Let us proceed with a systematic validation and analysis.\n\nFirst, the givens of the problem are extracted and verified.\nThe species tree topology is given by the Newick string $(((A,B),(C,D)),((E,F),(G,H)))$. This represents a rooted, bifurcating tree. Let us denote the root as $R$. The root splits into two clades, which we label $X$ and $Y$. Clade $X$ is the most recent common ancestor (MRCA) of $\\{A,B,C,D\\}$, and clade $Y$ is the MRCA of $\\{E,F,G,H\\}$. The internal nodes are the MRCAs of their respective descendant leaves: node $AB$ for $\\{A,B\\}$, node $CD$ for $\\{C,D\\}$, node $EF$ for $\\{E,F\\}$, and node $GH$ for $\\{G,H\\}$.\n\nThe character state is the presence or absence of an operon. We will represent presence by the state $1$ and absence by the state $0$.\nThe observed states at the leaves (taxa) are:\n- $S(A)=0, S(B)=0, S(C)=0, S(D)=0$\n- $S(E)=1, S(F)=1$\n- $S(G)=0, S(H)=0$\n\nThe problem is scientifically grounded, well-posed, and objective. It utilizes standard concepts from computational phylogenetics such as parsimony, horizontal gene transfer, and gene loss on a specified tree structure. The constraints for each hypothesis are clearly defined, and sufficient information is provided to compute a unique score for each. Therefore, the problem is valid and we may proceed to the solution.\n\nWe will analyze each hypothesis separately to find the minimum number of evolutionary events required to explain the observed pattern of operon presence/absence.\n\nAnalysis of Hypothesis $\\mathrm{L}$ (Loss-dominated vertical inheritance):\nUnder this hypothesis, the operon is present in the last common ancestor of all eight taxa. This means the state at the root of the tree is $1$, i.e., $S(R)=1$. Only loss events ($1 \\to 0$) are permitted; no gain events ($0 \\to 1$) are allowed. The parsimony score $E_{\\mathrm{L}}$ is the minimum number of required loss events.\n\nTo reconstruct the states at the internal nodes, we use the Fitch algorithm, constrained by the \"no gain\" rule.\n1. The operon is present in taxa $E$ and $F$, so $S(E)=1$ and $S(F)=1$. For this state to be inherited from the root, all nodes on the path from the root to $E$ and $F$ must have the state $1$. This path is $R \\to Y \\to EF$. Thus, we must have $S(R)=1$, $S(Y)=1$, and $S(EF)=1$. The premise $S(R)=1$ is satisfied. There are no events along this path.\n\n2. The operon is absent in taxa $A,B,C,D$. The MRCA of these taxa is node $X$. Since the state at the root $R$ is $1$, and all descendants of $X$ have state $0$, a loss event must have occurred on the branch connecting $R$ to $X$. This accounts for one event. The state at node $X$ becomes $0$, i.e., $S(X)=0$. This state $0$ is then inherited by nodes $AB$, $CD$, and leaves $A,B,C,D$ without any further events. This is the most parsimonious explanation for the absence in this clade. Number of events so far: $1$.\n\n3. The operon is absent in taxa $G$ and $H$. The MRCA of these taxa is node $GH$. We established that the state at node $Y$ (the parent of $GH$) is $1$. To explain the absence in $G$ and $H$, a loss event must have occurred on the branch connecting $Y$ to $GH$. This accounts for a second event. The state at node $GH$ becomes $0$, i.e., $S(GH)=0$. This state $0$ is then inherited by leaves $G$ and $H$ without further events. Number of new events: $1$.\n\nSumming the events under Hypothesis $\\mathrm{L}$, we have one loss on the branch $R \\to X$ and one loss on the branch $Y \\to GH$.\nThus, the minimum number of events is $E_{\\mathrm{L}} = 1 + 1 = 2$.\n\nAnalysis of Hypothesis $\\mathrm{T}$ (Single-event horizontal gene transfer):\nUnder this hypothesis, the operon was absent in the last common ancestor, so $S(R)=0$. Exactly one horizontal gene transfer (HGT) event ($0 \\to 1$) is permitted on a single branch. Subsequent evolution allows for vertical inheritance and block-loss events ($1 \\to 0$). The parsimony score $E_{\\mathrm{T}}$ is the sum of the HGT event and any subsequent loss events.\n\nThe operon is present in $E$ and $F$. A single HGT event must explain this presence. For both $E$ and $F$ to inherit the operon vertically after a single HGT, the transfer must have occurred on a branch that is an ancestor to the clade $(E,F)$. The possible branches for the HGT event are:\n- The branch leading to node $EF$ (the MRCA of $E$ and $F$).\n- The branch leading to node $Y$ (the parent of $EF$).\nAn HGT to a terminal branch (e.g., leading to $E$) would not explain the presence in $F$ with a single HGT event, so this is not considered.\n\nLet us evaluate the parsimony score for each potential HGT placement:\n\nCase 1: HGT on the branch leading to node $EF$.\nThe parent of node $EF$ is node $Y$. The states of the nodes from the root are as follows: $S(R)=0$. This state is inherited by its children, so $S(X)=0$ and $S(Y)=0$. The HGT occurs on the branch $Y \\to EF$. This changes the state from $0$ to $1$ for the subtree rooted at $EF$. So, $S(EF)=1$. This is one event (the HGT). The state $1$ is then inherited by leaves $E$ and $F$. No losses are needed.\nElsewhere in the tree, the state $0$ is inherited from the root down. $S(X)=0$ leads to $S(A)=S(B)=S(C)=S(D)=0$. $S(Y)=0$ leads to $S(GH)=0$, which in turn leads to $S(G)=S(H)=0$. All observed states are explained.\nThe total number of events in this scenario is $1$ (the HGT).\n\nCase 2: HGT on the branch leading to node $Y$.\nThe parent of node $Y$ is the root $R$. The HGT occurs on the branch $R \\to Y$. The state of $Y$ becomes $1$, i.e., $S(Y)=1$. This is one event (the HGT).\nSince $S(R)=0$, the other child of the root, node $X$, inherits the state $0$, and consequently so do all its descendants ($A,B,C,D$). No events in this part of the tree.\nNow consider the subtree rooted at $Y$, where $S(Y)=1$.\n- To explain $S(E)=1$ and $S(F)=1$, node $EF$ must have state $1$. The state is inherited from $Y$ without any loss event.\n- To explain $S(G)=0$ and $S(H)=0$, a loss event must occur on the branch from $Y$ to their MRCA, node $GH$. So, $S(GH)$ becomes $0$. This is a second event (a loss).\nThe total number of events in this scenario is $1$ (HGT) $+ 1$ (loss) $= 2$.\n\nBy the principle of Maximum Parsimony, we must choose the scenario for Hypothesis $\\mathrm{T}$ that minimizes the event count. Comparing Case 1 (score $1$) and Case 2 (score $2$), the minimum score is $1$.\nTherefore, the parsimony score for Hypothesis $\\mathrm{T}$ is $E_{\\mathrm{T}} = 1$. This corresponds to a single HGT event into the branch leading to the common ancestor of taxa $E$ and $F$.\n\nFinally, we compute the parsimony advantage of Hypothesis $\\mathrm{T}$ over Hypothesis $\\mathrm{L}$, which is defined as $\\Delta = E_{\\mathrm{L}} - E_{\\mathrm{T}}$.\nSubstituting the calculated values:\n$$\n\\Delta = 2 - 1 = 1\n$$\nThe parsimony advantage is $1$. This indicates that the hypothesis involving a single targeted horizontal transfer event is more parsimonious than the hypothesis of ancestral presence followed by multiple losses to explain the observed distribution of the operon.", "answer": "$$\\boxed{1}$$", "id": "2385158"}, {"introduction": "In practice, the strongest case for HGT comes from integrating multiple, independent lines of evidence. This capstone exercise guides you through the development of a formal, probabilistic scoring system to do just that [@problem_id:2385114]. By deriving and calculating a Bayesian posterior log-odds score, $S_{HGT}$, you will learn how to combine evidence from sequence composition, phylogenetic incongruence, and genomic synteny into a single, robust statistical measure, reflecting the modern, integrative approach used in bioinformatics research.", "problem": "You are designing a principled integrative score for detecting horizontal gene transfer (HGT) in prokaryotic genomes. For a given gene, you observe three independent types of evidence conditional on the hypothesis: a compositional deviation magnitude $x \\in [0,\\infty)$ (e.g., deviation in guanine–cytosine (GC) content and oligonucleotide usage), a phylogenetic incongruence score $y \\in (0,1)$ (e.g., a normalized Robinson–Foulds (RF) distance), and a synteny disruption count $k \\in \\{0,1,2,\\dots\\}$ (e.g., the number of breaks in conserved neighborhood).\n\nAssume the following generative model. Let $H$ denote the hypothesis that the gene is horizontally transferred, and $N$ denote the hypothesis that it is not. The prior probabilities are $\\Pr(H)=\\pi_{H}$ and $\\Pr(N)=\\pi_{N}$, with $\\pi_{H}+\\pi_{N}=1$. Conditional on $H$ or $N$, the evidence variables are independent with distributions:\n- Compositional deviation $x$ follows an exponential distribution with rate $\\lambda_{H}$ under $H$ and rate $\\lambda_{N}$ under $N$, with density $f(x\\mid\\lambda)=\\lambda \\exp(-\\lambda x)$ for $x\\ge 0$.\n- Phylogenetic incongruence $y$ follows a Beta distribution with parameters $(\\alpha_{H},\\beta_{H})$ under $H$ and $(\\alpha_{N},\\beta_{N})$ under $N$, with density $g(y\\mid\\alpha,\\beta)=\\dfrac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\\, y^{\\alpha-1}(1-y)^{\\beta-1}$ for $y\\in(0,1)$, where $\\Gamma(\\cdot)$ is the gamma function.\n- Synteny disruption count $k$ follows a Poisson distribution with mean $\\mu_{H}$ under $H$ and mean $\\mu_{N}$ under $N$, with probability mass function $h(k\\mid\\mu)=\\exp(-\\mu)\\mu^{k}/k!$ for $k\\in\\{0,1,2,\\dots\\}$.\n\nDefine the score $S_{HGT}(x,y,k)$ to be the posterior log-odds in favor of $H$ over $N$ given $(x,y,k)$, namely\n$$\nS_{HGT}(x,y,k) \\equiv \\ln\\!\\left(\\frac{\\Pr(H\\mid x,y,k)}{\\Pr(N\\mid x,y,k)}\\right).\n$$\nUnder the model above, derive a closed-form analytic expression for $S_{HGT}(x,y,k)$ in terms of $(x,y,k)$ and the parameters. Then, using the parameter values $\\pi_{H}=0.1$, $\\pi_{N}=0.9$, $\\lambda_{H}=0.8$, $\\lambda_{N}=2.0$, $(\\alpha_{H},\\beta_{H})=(5,2)$, $(\\alpha_{N},\\beta_{N})=(2,5)$, $\\mu_{H}=3.5$, $\\mu_{N}=0.8$, and the observed evidence $(x,y,k)=(1.2,0.7,4)$, evaluate $S_{HGT}(x,y,k)$.\n\nProvide your final numerical result for $S_{HGT}(1.2,0.7,4)$ rounded to four significant figures. No units are required and the answer is a single real number.", "solution": "The problem statement is validated and deemed valid. It is scientifically grounded, well-posed, objective, complete, and consistent. It describes a standard Bayesian classification problem applied to the detection of horizontal gene transfer, a well-established topic in computational biology. All required definitions, distributions, and parameters are provided, enabling a direct and unambiguous solution. We will proceed with the derivation and calculation.\n\nThe problem asks for the derivation of the posterior log-odds score, $S_{HGT}(x,y,k)$, and its evaluation for a specific set of evidence. The score is defined as:\n$$\nS_{HGT}(x,y,k) \\equiv \\ln\\left(\\frac{\\Pr(H\\mid x,y,k)}{\\Pr(N\\mid x,y,k)}\\right)\n$$\nwhere $H$ is the hypothesis of horizontal transfer and $N$ is the null hypothesis.\n\nWe begin by applying Bayes' theorem to the posterior probabilities $\\Pr(H\\mid x,y,k)$ and $\\Pr(N\\mid x,y,k)$.\n$$\n\\Pr(H\\mid x,y,k) = \\frac{\\Pr(x,y,k\\mid H)\\Pr(H)}{\\Pr(x,y,k)}\n$$\n$$\n\\Pr(N\\mid x,y,k) = \\frac{\\Pr(x,y,k\\mid N)\\Pr(N)}{\\Pr(x,y,k)}\n$$\nSubstituting these into the definition of $S_{HGT}$, the evidence term $\\Pr(x,y,k)$ in the denominators cancels:\n$$\nS_{HGT}(x,y,k) = \\ln\\left(\\frac{\\Pr(x,y,k\\mid H)\\Pr(H)}{\\Pr(x,y,k\\mid N)\\Pr(N)}\\right)\n$$\nUsing the properties of the logarithm, we can separate this into the log-likelihood ratio and the prior log-odds:\n$$\nS_{HGT}(x,y,k) = \\ln\\left(\\frac{\\Pr(x,y,k\\mid H)}{\\Pr(x,y,k\\mid N)}\\right) + \\ln\\left(\\frac{\\Pr(H)}{\\Pr(N)}\\right)\n$$\nThe problem states that the evidence variables $x$, $y$, and $k$ are conditionally independent given the hypothesis. This allows us to factorize the joint conditional probabilities:\n$$\n\\Pr(x,y,k\\mid H) = \\Pr(x\\mid H)\\Pr(y\\mid H)\\Pr(k\\mid H) = f(x\\mid H)g(y\\mid H)h(k\\mid H)\n$$\n$$\n\\Pr(x,y,k\\mid N) = \\Pr(x\\mid N)\\Pr(y\\mid N)\\Pr(k\\mid N) = f(x\\mid N)g(y\\mid N)h(k\\mid N)\n$$\nThe log-likelihood ratio term can therefore be decomposed into the sum of the log-likelihood ratios for each piece of evidence:\n$$\n\\ln\\left(\\frac{\\Pr(x,y,k\\mid H)}{\\Pr(x,y,k\\mid N)}\\right) = \\ln\\left(\\frac{f(x\\mid H)}{f(x\\mid N)}\\right) + \\ln\\left(\\frac{g(y\\mid H)}{g(y\\mid N)}\\right) + \\ln\\left(\\frac{h(k\\mid H)}{h(k\\mid N)}\\right)\n$$\nWe now derive each of these three terms.\n\n1.  **Compositional deviation ($x$)**: The distributions are exponential.\n    $f(x\\mid H) = \\lambda_{H} \\exp(-\\lambda_{H} x)$ and $f(x\\mid N) = \\lambda_{N} \\exp(-\\lambda_{N} x)$.\n    The log-likelihood ratio is:\n    $$\n    \\ln\\left(\\frac{\\lambda_{H} \\exp(-\\lambda_{H} x)}{\\lambda_{N} \\exp(-\\lambda_{N} x)}\\right) = \\ln\\left(\\frac{\\lambda_{H}}{\\lambda_{N}}\\right) - \\lambda_{H}x + \\lambda_{N}x = \\ln\\left(\\frac{\\lambda_{H}}{\\lambda_{N}}\\right) - (\\lambda_{H} - \\lambda_{N})x\n    $$\n\n2.  **Phylogenetic incongruence ($y$)**: The distributions are Beta. Let the Beta function be $B(\\alpha,\\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$. The density is $g(y\\mid\\alpha,\\beta) = \\frac{1}{B(\\alpha,\\beta)} y^{\\alpha-1}(1-y)^{\\beta-1}$.\n    $g(y\\mid H)$ is Beta$(\\alpha_{H},\\beta_{H})$ and $g(y\\mid N)$ is Beta$(\\alpha_{N},\\beta_{N})$.\n    The log-likelihood ratio is:\n    $$\n    \\ln\\left(\\frac{\\frac{1}{B(\\alpha_{H},\\beta_{H})} y^{\\alpha_{H}-1}(1-y)^{\\beta_{H}-1}}{\\frac{1}{B(\\alpha_{N},\\beta_{N})} y^{\\alpha_{N}-1}(1-y)^{\\beta_{N}-1}}\\right) = \\ln\\left(\\frac{B(\\alpha_{N},\\beta_{N})}{B(\\alpha_{H},\\beta_{H})}\\right) + (\\alpha_{H}-1)\\ln(y) + (\\beta_{H}-1)\\ln(1-y) - [(\\alpha_{N}-1)\\ln(y) + (\\beta_{N}-1)\\ln(1-y)]\n    $$\n    $$\n    = \\ln\\left(\\frac{B(\\alpha_{N},\\beta_{N})}{B(\\alpha_{H},\\beta_{H})}\\right) + (\\alpha_{H}-\\alpha_{N})\\ln(y) + (\\beta_{H}-\\beta_{N})\\ln(1-y)\n    $$\n\n3.  **Synteny disruption count ($k$)**: The distributions are Poisson.\n    $h(k\\mid H) = \\frac{\\exp(-\\mu_{H})\\mu_{H}^{k}}{k!}$ and $h(k\\mid N) = \\frac{\\exp(-\\mu_{N})\\mu_{N}^{k}}{k!}$.\n    The log-likelihood ratio is:\n    $$\n    \\ln\\left(\\frac{\\frac{\\exp(-\\mu_{H})\\mu_{H}^{k}}{k!}}{\\frac{\\exp(-\\mu_{N})\\mu_{N}^{k}}{k!}}\\right) = \\ln\\left(\\frac{\\exp(-\\mu_{H})\\mu_{H}^{k}}{\\exp(-\\mu_{N})\\mu_{N}^{k}}\\right) = (-\\mu_{H} + k\\ln(\\mu_{H})) - (-\\mu_{N} + k\\ln(\\mu_{N}))\n    $$\n    $$\n    = -(\\mu_{H}-\\mu_{N}) + k\\ln\\left(\\frac{\\mu_{H}}{\\mu_{N}}\\right)\n    $$\n\nCombining all terms, the complete analytical expression for the score $S_{HGT}(x,y,k)$ is:\n$$\nS_{HGT}(x,y,k) = \\ln\\left(\\frac{\\pi_{H}}{\\pi_{N}}\\right) + \\ln\\left(\\frac{\\lambda_{H}}{\\lambda_{N}}\\right) - (\\lambda_{H} - \\lambda_{N})x + \\ln\\left(\\frac{B(\\alpha_{N},\\beta_{N})}{B(\\alpha_{H},\\beta_{H})}\\right) + (\\alpha_{H}-\\alpha_{N})\\ln(y) + (\\beta_{H}-\\beta_{N})\\ln(1-y) - (\\mu_{H}-\\mu_{N}) + k\\ln\\left(\\frac{\\mu_{H}}{\\mu_{N}}\\right)\n$$\nThis is the required closed-form expression.\n\nNow, we evaluate this expression for the given parameters and data.\nParameters: $\\pi_{H}=0.1, \\pi_{N}=0.9, \\lambda_{H}=0.8, \\lambda_{N}=2.0, (\\alpha_{H},\\beta_{H})=(5,2), (\\alpha_{N},\\beta_{N})=(2,5), \\mu_{H}=3.5, \\mu_{N}=0.8$.\nData: $(x,y,k)=(1.2,0.7,4)$.\n\nWe calculate each component of the score:\n- **Prior log-odds**:\n  $$ \\ln\\left(\\frac{\\pi_{H}}{\\pi_{N}}\\right) = \\ln\\left(\\frac{0.1}{0.9}\\right) = \\ln\\left(\\frac{1}{9}\\right) = -\\ln(9) \\approx -2.1972 $$\n- **Compositional term**:\n  $$ \\ln\\left(\\frac{0.8}{2.0}\\right) - (0.8 - 2.0) \\times 1.2 = \\ln(0.4) - (-1.2) \\times 1.2 = \\ln(0.4) + 1.44 \\approx -0.9163 + 1.44 = 0.5237 $$\n- **Phylogenetic term**: First, we evaluate the constant part.\n  $B(\\alpha_{H},\\beta_{H}) = B(5,2) = \\frac{\\Gamma(5)\\Gamma(2)}{\\Gamma(5+2)} = \\frac{4!1!}{6!} = \\frac{24}{720} = \\frac{1}{30}$.\n  $B(\\alpha_{N},\\beta_{N}) = B(2,5) = \\frac{\\Gamma(2)\\Gamma(5)}{\\Gamma(2+5)} = \\frac{1!4!}{6!} = \\frac{24}{720} = \\frac{1}{30}$.\n  Thus, $\\ln\\left(\\frac{B(\\alpha_{N},\\beta_{N})}{B(\\alpha_{H},\\beta_{H})}\\right) = \\ln(1) = 0$.\n  The variable part is:\n  $$ (\\alpha_{H}-\\alpha_{N})\\ln(y) + (\\beta_{H}-\\beta_{N})\\ln(1-y) = (5-2)\\ln(0.7) + (2-5)\\ln(1-0.7) = 3\\ln(0.7) - 3\\ln(0.3) = 3\\ln\\left(\\frac{0.7}{0.3}\\right) = 3\\ln\\left(\\frac{7}{3}\\right) \\approx 3 \\times 0.8473 = 2.5419 $$\n- **Synteny term**:\n  $$ -(\\mu_{H}-\\mu_{N}) + k\\ln\\left(\\frac{\\mu_{H}}{\\mu_{N}}\\right) = -(3.5 - 0.8) + 4\\ln\\left(\\frac{3.5}{0.8}\\right) = -2.7 + 4\\ln(4.375) \\approx -2.7 + 4 \\times 1.4760 = -2.7 + 5.9040 = 3.2040 $$\n\nFinally, we sum all components to obtain the total score:\n$$\nS_{HGT}(1.2, 0.7, 4) \\approx -2.1972 + 0.5237 + 2.5419 + 3.2040\n$$\n$$\nS_{HGT}(1.2, 0.7, 4) \\approx 4.0724\n$$\nThe calculation using higher precision yields:\n$\\ln(1/9) \\approx -2.19722$\n$\\ln(0.4) + 1.44 \\approx 0.52371$\n$3\\ln(7/3) \\approx 2.54189$\n$-2.7 + 4\\ln(4.375) \\approx 3.20385$\nSum: $-2.19722 + 0.52371 + 2.54189 + 3.20385 = 4.07223$.\nRounding to four significant figures gives $4.072$.", "answer": "$$\n\\boxed{4.072}\n$$", "id": "2385114"}]}