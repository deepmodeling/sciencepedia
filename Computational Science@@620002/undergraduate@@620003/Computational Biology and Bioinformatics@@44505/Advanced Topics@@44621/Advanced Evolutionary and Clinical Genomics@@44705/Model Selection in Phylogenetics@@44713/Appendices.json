{"hands_on_practices": [{"introduction": "The core of model selection lies in balancing model fit with model complexity. This hands-on exercise guides you through the fundamental practice of applying two of the most common tools for this task: the Akaike Information Criterion ($AIC$) and the Bayesian Information Criterion ($BIC$). By working with hypothetical log-likelihoods for a nested set of standard nucleotide substitution models, you will gain direct experience in calculating these criteria and using them to select the most appropriate model for a given dataset [@problem_id:2734801].", "problem": "A nucleotide alignment of length $5000$ sites has been analyzed on a fixed, fully resolved unrooted topology relating $12$ taxa. For an unrooted binary phylogeny with $m$ taxa, there are $2m - 3$ branches, each with an independent branch-length parameter. The maximum log-likelihoods (natural logarithm) obtained under five time-homogeneous, time-reversible substitution models are given below, all estimated on the same topology and alignment:\n\n- JC69: $\\ln \\hat{L}_{\\mathrm{JC69}} = -7423.6$\n- HKY: $\\ln \\hat{L}_{\\mathrm{HKY}} = -7089.2$\n- GTR: $\\ln \\hat{L}_{\\mathrm{GTR}} = -7012.8$\n- GTR+G (four discrete gamma categories with a single shape parameter): $\\ln \\hat{L}_{\\mathrm{GTR+G}} = -6844.5$\n- GTR+G+I (gamma as above plus a proportion of invariable sites): $\\ln \\hat{L}_{\\mathrm{GTR+G+I}} = -6839.7$\n\nAssume standard parameterizations for nucleotide models: JC69 has equal base frequencies and equal exchangeabilities, contributing no free substitution-process parameters beyond the branch lengths; HKY adds one transition/transversion rate ratio parameter $\\kappa$ and three independent base-frequency parameters; GTR has five independent exchangeability parameters and three independent base-frequency parameters; the $+G$ extension adds one gamma shape parameter $\\alpha$; the $+I$ extension adds one parameter for the proportion of invariable sites. The number of discrete gamma categories is fixed and does not add parameters.\n\nUsing the canonical definitions of the Akaike Information Criterion (AIC) and the Bayesian Information Criterion (BIC), where each criterion balances the maximized log-likelihood against a penalty term that increases with the number of free parameters and, for BIC, with the sample size (here, the number of alignment sites), do the following:\n\n1. Determine the total number of free parameters $k$ for each model, including all branch lengths and model-specific parameters.\n2. Compute the AIC and BIC for each model.\n3. Identify the preferred model under AIC and under BIC (the model with the smallest value of each criterion).\n4. As your final numeric answer, report the Akaike weight (the normalized relative likelihood based on AIC) of the AIC-preferred model, expressed as a decimal fraction. Round your final numeric answer to four significant figures.", "solution": "The problem requires a comparative analysis of five nested models of nucleotide substitution using the Akaike Information Criterion (AIC) and the Bayesian Information Criterion (BIC). The objective is to identify the best-fitting model and quantify its support via its Akaike weight.\n\nFirst, we must define the criteria. The AIC is given by the formula:\n$$\nAIC = 2k - 2\\ln \\hat{L}\n$$\nwhere $k$ is the number of free parameters in the model and $\\ln \\hat{L}$ is the maximized natural log-likelihood. The BIC is given by:\n$$\nBIC = k \\ln(n) - 2\\ln \\hat{L}\n$$\nwhere $n$ is the sample size, which in this context is the number of sites in the nucleotide alignment, given as $n = 5000$.\n\nThe first step is to correctly determine the total number of free parameters, $k$, for each of the five models. The total number of parameters is the sum of the number of branch-length parameters and the number of substitution-process parameters.\nFor an unrooted binary phylogenetic tree with $m$ taxa, the number of branches is $2m - 3$. Here, with $m = 12$ taxa, the number of branches is $2(12) - 3 = 21$. Each branch has a length parameter, so all models share $k_{branches} = 21$ parameters.\n\nWe now determine the number of substitution-process parameters ($k_{subst}$) for each model as described:\n- **JC69**: This model assumes equal base frequencies and a single rate of substitution. It has no free parameters for the substitution process. Thus, $k_{subst, \\mathrm{JC69}} = 0$.\n- **HKY**: This model introduces a parameter for the transition/transversion rate ratio ($\\kappa$) and allows for unequal base frequencies. Since the four base frequencies must sum to $1$, there are $3$ free frequency parameters. Thus, $k_{subst, \\mathrm{HKY}} = 1 + 3 = 4$.\n- **GTR**: This is the general time-reversible model. It has $6$ exchangeability parameters, but they are relative, so only $5$ are free. It also has $3$ free base-frequency parameters. Thus, $k_{subst, \\mathrm{GTR}} = 5 + 3 = 8$.\n- **GTR+G**: This model adds a parameter for the gamma distribution of rates across sites, the shape parameter $\\alpha$. Thus, $k_{subst, \\mathrm{GTR+G}} = k_{subst, \\mathrm{GTR}} + 1 = 8 + 1 = 9$.\n- **GTR+G+I**: This model adds a parameter for the proportion of invariable sites, $p_{inv}$. Thus, $k_{subst, \\mathrm{GTR+G+I}} = k_{subst, \\mathrm{GTR+G}} + 1 = 9 + 1 = 10$.\n\nThe total number of parameters ($k$) for each model is:\n- $k_{\\mathrm{JC69}} = 21 + 0 = 21$\n- $k_{\\mathrm{HKY}} = 21 + 4 = 25$\n- $k_{\\mathrm{GTR}} = 21 + 8 = 29$\n- $k_{\\mathrm{GTR+G}} = 21 + 9 = 30$\n- $k_{\\mathrm{GTR+G+I}} = 21 + 10 = 31$\n\nWith the values of $k$, $\\ln \\hat{L}$, and $n=5000$, we can compute the AIC and BIC for each model.\n\n1. **JC69**: $k = 21$, $\\ln \\hat{L} = -7423.6$\n   $AIC_{\\mathrm{JC69}} = 2(21) - 2(-7423.6) = 42 + 14847.2 = 14889.2$\n   $BIC_{\\mathrm{JC69}} = 21\\ln(5000) - 2(-7423.6) \\approx 21(8.5172) + 14847.2 = 178.8612 + 14847.2 = 15026.0612$\n\n2. **HKY**: $k = 25$, $\\ln \\hat{L} = -7089.2$\n   $AIC_{\\mathrm{HKY}} = 2(25) - 2(-7089.2) = 50 + 14178.4 = 14228.4$\n   $BIC_{\\mathrm{HKY}} = 25\\ln(5000) - 2(-7089.2) \\approx 25(8.5172) + 14178.4 = 212.9300 + 14178.4 = 14391.3300$\n\n3. **GTR**: $k = 29$, $\\ln \\hat{L} = -7012.8$\n   $AIC_{\\mathrm{GTR}} = 2(29) - 2(-7012.8) = 58 + 14025.6 = 14083.6$\n   $BIC_{\\mathrm{GTR}} = 29\\ln(5000) - 2(-7012.8) \\approx 29(8.5172) + 14025.6 = 246.9988 + 14025.6 = 14272.5988$\n\n4. **GTR+G**: $k = 30$, $\\ln \\hat{L} = -6844.5$\n   $AIC_{\\mathrm{GTR+G}} = 2(30) - 2(-6844.5) = 60 + 13689.0 = 13749.0$\n   $BIC_{\\mathrm{GTR+G}} = 30\\ln(5000) - 2(-6844.5) \\approx 30(8.5172) + 13689.0 = 255.5160 + 13689.0 = 13944.5160$\n\n5. **GTR+G+I**: $k = 31$, $\\ln \\hat{L} = -6839.7$\n   $AIC_{\\mathrm{GTR+G+I}} = 2(31) - 2(-6839.7) = 62 + 13679.4 = 13741.4$\n   $BIC_{\\mathrm{GTR+G+I}} = 31\\ln(5000) - 2(-6839.7) \\approx 31(8.5172) + 13679.4 = 264.0332 + 13679.4 = 13943.4332$\n\nThe preferred model is the one that minimizes the information criterion score.\n- For AIC, the minimum value is $AIC_{min} = 13741.4$, corresponding to the **GTR+G+I** model.\n- For BIC, the minimum value is $BIC_{min} \\approx 13943.43$, also corresponding to the **GTR+G+I** model.\n\nFinally, we must calculate the Akaike weight of the preferred model under AIC, which is GTR+G+I. The Akaike weight ($w_i$) for model $i$ is a measure of its relative support among the set of candidate models. It is calculated as:\n$$\nw_i = \\frac{\\exp(-\\frac{1}{2}\\Delta_i)}{\\sum_{j=1}^{R} \\exp(-\\frac{1}{2}\\Delta_j)}\n$$\nwhere $\\Delta_i = AIC_i - AIC_{min}$ and $R=5$ is the number of models.\n\nFirst, we calculate the $\\Delta_i$ values for each model relative to $AIC_{min} = AIC_{\\mathrm{GTR+G+I}} = 13741.4$.\n- $\\Delta_{\\mathrm{JC69}} = 14889.2 - 13741.4 = 1147.8$\n- $\\Delta_{\\mathrm{HKY}} = 14228.4 - 13741.4 = 487.0$\n- $\\Delta_{\\mathrm{GTR}} = 14083.6 - 13741.4 = 342.2$\n- $\\Delta_{\\mathrm{GTR+G}} = 13749.0 - 13741.4 = 7.6$\n- $\\Delta_{\\mathrm{GTR+G+I}} = 13741.4 - 13741.4 = 0$\n\nNext, we calculate the numerator for the Akaike weight of the preferred model (GTR+G+I):\n$\\exp(-\\frac{1}{2}\\Delta_{\\mathrm{GTR+G+I}}) = \\exp(-\\frac{1}{2} \\times 0) = \\exp(0) = 1$.\n\nNow, we calculate the denominator, which is the sum of the relative likelihoods of all models:\n$\\sum_{j=1}^{5} \\exp(-\\frac{1}{2}\\Delta_j) = \\exp(-\\frac{1147.8}{2}) + \\exp(-\\frac{487.0}{2}) + \\exp(-\\frac{342.2}{2}) + \\exp(-\\frac{7.6}{2}) + \\exp(-\\frac{0}{2})$\n$\\sum_{j} \\exp(-\\frac{1}{2}\\Delta_j) = \\exp(-573.9) + \\exp(-243.5) + \\exp(-171.1) + \\exp(-3.8) + \\exp(0)$\nThe first three terms are vanishingly small and numerically negligible. We compute:\n$\\exp(-3.8) \\approx 0.0223708$\n$\\exp(0) = 1$\nSo, the sum is approximately $0 + 0 + 0 + 0.0223708 + 1 = 1.0223708$.\n\nThe Akaike weight for the GTR+G+I model is:\n$w_{\\mathrm{GTR+G+I}} = \\frac{1}{1.0223708} \\approx 0.978119$\n\nRounding to four significant figures, the Akaike weight of the AIC-preferred model is $0.9781$. This indicates that, given the data and the set of candidate models, there is approximately a $97.81\\%$ probability that the GTR+G+I model is the best model in the Kullback-Leibler sense.", "answer": "$$\\boxed{0.9781}$$", "id": "2734801"}, {"introduction": "While the standard $AIC$ provides a powerful framework, its derivation relies on the assumption of a large sample size. This practice introduces the small-sample correction, $AICc$, which is essential when the number of data points is not substantially larger than the number of model parameters. By comparing the results from $AIC$ and $AICc$ in a carefully constructed scenario, you will discover how this correction can alter model preference and learn to identify situations where its use is critical for robust inference [@problem_id:2734863].", "problem": "A phylogenomic data set of $n=800$ aligned nucleotide sites from $10$ taxa is analyzed under maximum likelihood with two time-reversible substitution models that differ in parameterization but share the same fixed topology and branch-length optimization procedure. Model $\\mathcal{M}_{1}$ has $k_{1}=20$ free parameters and achieves a maximized log-likelihood $\\ln \\hat{L}_{1}=-11234.5$. Model $\\mathcal{M}_{2}$ has $k_{2}=40$ free parameters and achieves a maximized log-likelihood $\\ln \\hat{L}_{2}=-11213.5$. Using the principle of maximum likelihood and the standard definitions of the Akaike Information Criterion (AIC) and the small-sample corrected Akaike Information Criterion (AICc), carry out the following:\n\n1) Compute the AIC and AICc for $\\mathcal{M}_{1}$ and $\\mathcal{M}_{2}$.\n\n2) Determine which model is preferred under AIC and which under AICc, and explain the difference in ranking by deriving the threshold improvement in log-likelihood $\\Delta \\ln \\hat{L}=\\ln \\hat{L}_{2}-\\ln \\hat{L}_{1}$ required for the more complex model $\\mathcal{M}_{2}$ to be preferred under AIC and under AICc for the given $(n,k_{1},k_{2})$.\n\n3) Finally, report the single numerical quantity $\\Delta=\\mathrm{AICc}_{2}-\\mathrm{AICc}_{1}$, rounded to four significant figures. Do not include units in your final reported number.", "solution": "The Akaike Information Criterion (AIC) is defined as:\n$$ \\mathrm{AIC} = 2k - 2 \\ln \\hat{L} $$\nwhere $k$ is the number of estimable parameters in the model and $\\ln \\hat{L}$ is the maximized value of the log-likelihood function.\n\nThe small-sample corrected Akaike Information Criterion (AICc), which is recommended when the ratio $\\frac{n}{k}$ is small (typically less than $40$), is defined as:\n$$ \\mathrm{AICc} = \\mathrm{AIC} + \\frac{2k(k+1)}{n-k-1} = 2k - 2 \\ln \\hat{L} + \\frac{2k(k+1)}{n-k-1} $$\n\n**1) Computation of AIC and AICc**\n\nFor model $\\mathcal{M}_{1}$, we have $k_{1} = 20$, $\\ln \\hat{L}_{1} = -11234.5$, and $n=800$.\nThe AIC is:\n$$ \\mathrm{AIC}_{1} = 2k_{1} - 2 \\ln \\hat{L}_{1} = 2(20) - 2(-11234.5) = 40 + 22469 = 22509 $$\nThe AICc is:\n$$ \\mathrm{AICc}_{1} = \\mathrm{AIC}_{1} + \\frac{2k_{1}(k_{1}+1)}{n-k_{1}-1} = 22509 + \\frac{2(20)(20+1)}{800-20-1} = 22509 + \\frac{840}{779} \\approx 22509 + 1.0783 = 22510.0783 $$\n\nFor model $\\mathcal{M}_{2}$, we have $k_{2} = 40$, $\\ln \\hat{L}_{2} = -11213.5$, and $n=800$.\nThe AIC is:\n$$ \\mathrm{AIC}_{2} = 2k_{2} - 2 \\ln \\hat{L}_{2} = 2(40) - 2(-11213.5) = 80 + 22427 = 22507 $$\nThe AICc is:\n$$ \\mathrm{AICc}_{2} = \\mathrm{AIC}_{2} + \\frac{2k_{2}(k_{2}+1)}{n-k_{2}-1} = 22507 + \\frac{2(40)(40+1)}{800-40-1} = 22507 + \\frac{3280}{759} \\approx 22507 + 4.3215 = 22511.3215 $$\n\n**2) Model Preference and Threshold Derivation**\n\nThe model with the lower AIC or AICc score is preferred.\n- Under AIC: $\\mathrm{AIC}_{2} = 22507 < \\mathrm{AIC}_{1} = 22509$. Therefore, the more complex model $\\mathcal{M}_{2}$ is preferred.\n- Under AICc: $\\mathrm{AICc}_{1} \\approx 22510.08 < \\mathrm{AICc}_{2} \\approx 22511.32$. Therefore, the simpler model $\\mathcal{M}_{1}$ is preferred.\n\nThe discrepancy arises because the AICc applies a greater penalty for additional parameters than AIC, and this penalty increases non-linearly with $k$. The correction term for $\\mathcal{M}_{2}$ is significantly larger than for $\\mathcal{M}_{1}$, which reverses the preference.\n\nNow, we derive the threshold improvement in log-likelihood, $\\Delta \\ln \\hat{L} = \\ln \\hat{L}_{2} - \\ln \\hat{L}_{1}$, required for $\\mathcal{M}_{2}$ to be preferred.\n\nFor AIC, $\\mathcal{M}_{2}$ is preferred if $\\mathrm{AIC}_{2} < \\mathrm{AIC}_{1}$:\n$$ 2k_{2} - 2 \\ln \\hat{L}_{2} < 2k_{1} - 2 \\ln \\hat{L}_{1} $$\n$$ 2(\\ln \\hat{L}_{1} - \\ln \\hat{L}_{2}) < 2(k_{1} - k_{2}) $$\n$$ \\ln \\hat{L}_{2} - \\ln \\hat{L}_{1} > k_{2} - k_{1} $$\nGiven $k_{1}=20$ and $k_{2}=40$, the threshold is:\n$$ \\Delta \\ln \\hat{L} > 40 - 20 = 20 $$\nThe observed improvement is $\\ln \\hat{L}_{2} - \\ln \\hat{L}_{1} = -11213.5 - (-11234.5) = 21$. Since $21 > 20$, $\\mathcal{M}_{2}$ is indeed preferred under AIC.\n\nFor AICc, $\\mathcal{M}_{2}$ is preferred if $\\mathrm{AICc}_{2} < \\mathrm{AICc}_{1}$:\n$$ \\mathrm{AIC}_{2} + \\frac{2k_{2}(k_{2}+1)}{n-k_{2}-1} < \\mathrm{AIC}_{1} + \\frac{2k_{1}(k_{1}+1)}{n-k_{1}-1} $$\n$$ (2k_{2} - 2 \\ln \\hat{L}_{2}) + \\frac{2k_{2}(k_{2}+1)}{n-k_{2}-1} < (2k_{1} - 2 \\ln \\hat{L}_{1}) + \\frac{2k_{1}(k_{1}+1)}{n-k_{1}-1} $$\nRearranging for $\\Delta \\ln \\hat{L} = \\ln \\hat{L}_{2} - \\ln \\hat{L}_{1}$:\n$$ \\ln \\hat{L}_{2} - \\ln \\hat{L}_{1} > (k_{2}-k_{1}) + \\frac{k_{2}(k_{2}+1)}{n-k_{2}-1} - \\frac{k_{1}(k_{1}+1)}{n-k_{1}-1} $$\nSubstituting the given values:\n$$ \\Delta \\ln \\hat{L} > (40-20) + \\frac{40(41)}{800-40-1} - \\frac{20(21)}{800-20-1} $$\n$$ \\Delta \\ln \\hat{L} > 20 + \\frac{1640}{759} - \\frac{420}{779} $$\n$$ \\Delta \\ln \\hat{L} > 20 + 2.160737... - 0.539152... $$\n$$ \\Delta \\ln \\hat{L} > 20 + 1.621585... = 21.621585... $$\nThe observed improvement $\\Delta \\ln \\hat{L} = 21$ is less than this threshold of approximately $21.62$. Thus, under AICc, the improvement in fit is insufficient to justify the addition of $20$ parameters, and $\\mathcal{M}_{1}$ is preferred.\n\n**3) Calculation of $\\Delta = \\mathrm{AICc}_{2} - \\mathrm{AICc}_{1}$**\n\nWe are asked to compute the single numerical quantity $\\Delta = \\mathrm{AICc}_{2} - \\mathrm{AICc}_{1}$.\n$$ \\Delta = \\mathrm{AICc}_{2} - \\mathrm{AICc}_{1} = (22511.32147...) - (22510.07830...) = 1.24317... $$\nAlternatively, this can be calculated symbolically:\n$$ \\Delta = (2k_{2} - 2\\ln \\hat{L}_{2} + \\frac{2k_{2}(k_{2}+1)}{n-k_{2}-1}) - (2k_{1} - 2\\ln \\hat{L}_{1} + \\frac{2k_{1}(k_{1}+1)}{n-k_{1}-1}) $$\n$$ \\Delta = 2(k_{2}-k_{1}) - 2(\\ln \\hat{L}_{2} - \\ln \\hat{L}_{1}) + 2 \\left( \\frac{k_{2}(k_{2}+1)}{n-k_{2}-1} - \\frac{k_{1}(k_{1}+1)}{n-k_{1}-1} \\right) $$\n$$ \\Delta = 2(20) - 2(21) + 2 \\left( \\frac{1640}{759} - \\frac{420}{779} \\right) $$\n$$ \\Delta = 40 - 42 + 2(2.160737... - 0.539152...) $$\n$$ \\Delta = -2 + 2(1.621585...) = -2 + 3.24317... = 1.24317... $$\nRounding to four significant figures, the result is $1.243$.", "answer": "$$ \\boxed{1.243} $$", "id": "2734863"}, {"introduction": "Model selection is not limited to information criteria; the classical framework of Null Hypothesis Significance Testing also offers powerful tools, such as the Likelihood Ratio Test (LRT) for nested models. This practice moves beyond pure calculation to explore the different statistical philosophies underpinning $AIC$ and the LRT, demonstrating how they can lead to conflicting model preferences [@problem_id:2406819]. By analyzing a scenario where their conclusions diverge, you will gain a deeper appreciation for the assumptions and goals inherent in each approach.", "problem": "An evolutionary biologist fits two nested time-reversible nucleotide substitution models to a fixed, well-resolved phylogenetic tree using a deoxyribonucleic acid (DNA) alignment of length $1000$ sites. The models are the Hasegawa–Kishino–Yano model plus Gamma (HKY85$+\\Gamma$) and the General Time Reversible model plus Gamma (GTR$+\\Gamma$). The GTR$+\\Gamma$ model nests HKY85$+\\Gamma$ by relaxing constraints on relative exchangeability rates; relative to HKY85$+\\Gamma$, GTR$+\\Gamma$ introduces $4$ additional free substitution-process parameters while keeping the same number of branch-length parameters and the same Gamma shape parameter.\n\nMaximum log-likelihoods (optimized over all model-specific parameters including branch lengths and the Gamma shape) are\n- $\\ell_{\\mathrm{HKY}+\\Gamma} = -2765.3$,\n- $\\ell_{\\mathrm{GTR}+\\Gamma} = -2760.7$.\n\nThe analyst applies the Likelihood Ratio Test (LRT) at significance level $\\alpha = 0.05$ and also computes the Akaike Information Criterion (AIC) for both models. Assume standard regularity conditions so that the LRT statistic has an approximate chi-squared ($\\chi^2$) distribution with degrees of freedom equal to the difference in the number of free parameters.\n\nWhich option best describes which model each method will prefer and gives the correct statistical reason they can disagree in this scenario?\n\nA. AIC will select GTR$+$$\\Gamma$ because the log-likelihood gain of $\\Delta \\ell = 4.6$ makes $2\\Delta \\ell = 9.2$ exceed the AIC complexity penalty of $2\\Delta k = 8$ for $\\Delta k = 4$, whereas the LRT at $\\alpha = 0.05$ will not reject HKY85$+$$\\Gamma$ because $2\\Delta \\ell = 9.2$ is less than the $\\chi^2_{4,0.95} \\approx 9.49$ threshold. They disagree because AIC targets expected out-of-sample Kullback–Leibler (KL) divergence with a fixed $2$-per-parameter penalty, while the LRT controls Type I error at a chosen $\\alpha$ using a chi-squared cutoff that can be stricter than AIC’s implicit threshold.\n\nB. Both AIC and the LRT will select GTR$+$$\\Gamma$ because any positive increase in log-likelihood justifies additional parameters; disagreements only occur when the sample size is extremely small.\n\nC. The LRT will select GTR$+$$\\Gamma$ because it always chooses the more complex nested model when $\\Delta k > 0$, while AIC will prefer HKY85$+$$\\Gamma$ because it penalizes complexity more heavily than a test with $\\alpha = 0.05$.\n\nD. The disagreement occurs because the chi-squared approximation is invalid at $n = 1000$, causing the LRT to prefer HKY85$+$$\\Gamma$ while AIC prefers GTR$+$$\\Gamma$; with valid asymptotics they would agree.\n\nE. They disagree because the Gamma shape parameter is on the boundary of the parameter space under the null hypothesis, invalidating the LRT; AIC is unaffected and therefore prefers the complex model.", "solution": "The task is to compare two nested models of nucleotide substitution, the simpler Hasegawa–Kishino–Yano model with Gamma-distributed rates ($\\text{HKY85}+\\Gamma$) and the more complex General Time Reversible model with Gamma-distributed rates ($\\text{GTR}+\\Gamma$). We will use two standard methods: the Likelihood Ratio Test (LRT) and the Akaike Information Criterion (AIC).\n\nLet $M_0$ denote the null model, $\\text{HKY85}+\\Gamma$, and $M_1$ denote the alternative model, $\\text{GTR}+\\Gamma$.\nThe provided data are:\n- Maximum log-likelihood for $M_0$: $\\ell_0 = \\ell_{\\mathrm{HKY}+\\Gamma} = -2765.3$.\n- Maximum log-likelihood for $M_1$: $\\ell_1 = \\ell_{\\mathrm{GTR}+\\Gamma} = -2760.7$.\n- The difference in the number of free parameters between the models is $\\Delta k = k_1 - k_0 = 4$.\n- The significance level for the LRT is $\\alpha = 0.05$.\n\nFirst, we conduct the Likelihood Ratio Test (LRT). The LRT is applicable because the models are nested ($M_0$ is a special case of $M_1$). The null hypothesis, $H_0$, is that the simpler model $M_0$ is adequate. The alternative hypothesis, $H_1$, is that the more complex model $M_1$ provides a significantly better fit.\n\nThe LRT statistic, $\\delta$, is calculated as:\n$$ \\delta = 2(\\ell_1 - \\ell_0) $$\nSubstituting the given values:\n$$ \\delta = 2(-2760.7 - (-2765.3)) = 2(4.6) = 9.2 $$\nUnder the null hypothesis and the assumption of standard regularity conditions, this statistic follows a chi-squared ($\\chi^2$) distribution with degrees of freedom ($df$) equal to the difference in the number of free parameters, $df = \\Delta k = 4$.\n$$ \\delta \\sim \\chi^2_4 $$\nWe must compare our calculated $\\delta$ with the critical value of the $\\chi^2_4$ distribution at the significance level $\\alpha = 0.05$. This critical value, $\\chi^2_{4, 0.95}$, is the value that is exceeded with probability $0.05$. From standard statistical tables or computation, this value is approximately $9.488$.\nWe reject the null hypothesis $H_0$ if $\\delta > \\chi^2_{4, 0.95}$.\n$$ 9.2 < 9.488 $$\nSince the test statistic is less than the critical value, we fail to reject the null hypothesis. The LRT concludes that there is insufficient evidence to justify the additional complexity of the $\\text{GTR}+\\Gamma$ model. Therefore, the LRT prefers the simpler model, $\\text{HKY85}+\\Gamma$.\n\nSecond, we evaluate the models using the Akaike Information Criterion (AIC). The AIC for a model is defined as:\n$$ \\text{AIC} = 2k - 2\\ell $$\nwhere $k$ is the number of free parameters and $\\ell$ is the maximum log-likelihood. The model with the lower AIC score is preferred.\n\nTo compare the two models, we can check if $\\text{AIC}_1 < \\text{AIC}_0$:\n$$ 2k_1 - 2\\ell_1 < 2k_0 - 2\\ell_0 $$\nRearranging this inequality gives:\n$$ 2(\\ell_1 - \\ell_0) > 2(k_1 - k_0) $$\n$$ 2\\Delta\\ell > 2\\Delta k $$\nLet's substitute the values from the problem:\n- The log-likelihood gain is $\\Delta\\ell = \\ell_1 - \\ell_0 = 4.6$. Thus, $2\\Delta\\ell = 9.2$.\n- The increase in parameters is $\\Delta k = 4$. The AIC penalty for this added complexity is $2\\Delta k = 2(4) = 8$.\n\nThe inequality becomes:\n$$ 9.2 > 8 $$\nThis statement is true. This means that $\\text{AIC}_{\\text{GTR}+\\Gamma} < \\text{AIC}_{\\text{HKY}+\\Gamma}$. Therefore, AIC prefers the more complex model, $\\text{GTR}+\\Gamma$.\n\nThe two methods give conflicting recommendations: the LRT prefers the simpler $\\text{HKY85}+\\Gamma$ model, while AIC prefers the more complex $\\text{GTR}+\\Gamma$ model. This disagreement arises from their different penalty functions for model complexity. For adding $\\Delta k$ parameters, AIC requires the LRT statistic $2\\Delta\\ell$ to exceed a fixed threshold of $2\\Delta k$. The LRT requires $2\\Delta\\ell$ to exceed a threshold $\\chi^2_{\\Delta k, 1-\\alpha}$, which depends on both $\\Delta k$ and the chosen significance level $\\alpha$.\nFor this problem, AIC's threshold is $8$, whereas the LRT's threshold at $\\alpha=0.05$ is $\\approx 9.49$. The LRT requires a higher standard of evidence for the additional parameters, making it more conservative in this instance.\n\nNow we evaluate the given options:\n\n**A. AIC will select GTR$+$$\\Gamma$ because the log-likelihood gain of $\\Delta \\ell = 4.6$ makes $2\\Delta \\ell = 9.2$ exceed the AIC complexity penalty of $2\\Delta k = 8$ for $\\Delta k = 4$, whereas the LRT at $\\alpha = 0.05$ will not reject HKY85$+$$\\Gamma$ because $2\\Delta \\ell = 9.2$ is less than the $\\chi^2_{4,0.95} \\approx 9.49$ threshold. They disagree because AIC targets expected out-of-sample Kullback–Leibler (KL) divergence with a fixed $2$-per-parameter penalty, while the LRT controls Type I error at a chosen $\\alpha$ using a chi-squared cutoff that can be stricter than AIC’s implicit threshold.**\n- The calculations and conclusions for both AIC and LRT are correct as derived above.\n- The explanation for the disagreement is also correct. AIC is an information-theoretic approach attempting to estimate predictive accuracy (approximating KL divergence), and it uses a fixed penalty. The LRT is a hypothesis testing framework designed to control the rate of Type I errors at a pre-specified level $\\alpha$. The LRT's critical value can be, and in this case is, more stringent than the AIC's implicit threshold.\n- Verdict: **Correct**.\n\n**B. Both AIC and the LRT will select GTR$+$$\\Gamma$ because any positive increase in log-likelihood justifies additional parameters; disagreements only occur when the sample size is extremely small.**\n- The premise that both methods will select $\\text{GTR}+\\Gamma$ is false. The LRT selects $\\text{HKY85}+\\Gamma$.\n- The reason given, that \"any positive increase in log-likelihood justifies additional parameters,\" is fundamentally incorrect. Both methods penalize complexity and require the likelihood gain to be substantial enough to overcome this penalty.\n- Verdict: **Incorrect**.\n\n**C. The LRT will select GTR$+$$\\Gamma$ because it always chooses the more complex nested model when $\\Delta k > 0$, while AIC will prefer HKY85$+$$\\Gamma$ because it penalizes complexity more heavily than a test with $\\alpha = 0.05$.**\n- The statement that the LRT will select $\\text{GTR}+\\Gamma$ is false.\n- The statement that AIC will prefer $\\text{HKY85}+\\Gamma$ is false.\n- The claim that AIC penalizes complexity more heavily than an LRT with $\\alpha = 0.05$ is false for this specific case ($\\Delta k=4$). The effective penalty for AIC is a log-likelihood difference of $2\\Delta k / 2 = \\Delta k = 4$, corresponding to a LRT statistic threshold of $2\\Delta k = 8$. The LRT threshold is $\\chi^2_{4,0.95} \\approx 9.49$. Since $9.49 > 8$, the LRT is more stringent (penalizes more heavily) here.\n- Verdict: **Incorrect**.\n\n**D. The disagreement occurs because the chi-squared approximation is invalid at $n = 1000$, causing the LRT to prefer HKY85$+$$\\Gamma$ while AIC prefers GTR$+$$\\Gamma$; with valid asymptotics they would agree.**\n- The problem explicitly states to assume the $\\chi^2$ approximation is valid. Arguing against this assumption violates the problem's constraints.\n- An alignment length of $n=1000$ sites is often considered sufficient for the asymptotics to be a reasonable approximation.\n- AIC and LRT are based on different statistical philosophies and there is no guarantee they will agree, even asymptotically.\n- Verdict: **Incorrect**.\n\n**E. They disagree because the Gamma shape parameter is on the boundary of the parameter space under the null hypothesis, invalidating the LRT; AIC is unaffected and therefore prefers the complex model.**\n- The parameter test here is on the substitution rate parameters that differentiate GTR and HKY85, not on the Gamma shape parameter. The null hypothesis does not place the relevant parameters on a boundary.\n- The problem explicitly instructs to assume standard regularity conditions hold, which this option contradicts.\n- Verdict: **Incorrect**.\n\nOption A provides a complete and accurate account of the calculations for both methods and a correct statistical explanation for their differing conclusions.", "answer": "$$\\boxed{A}$$", "id": "2406819"}]}