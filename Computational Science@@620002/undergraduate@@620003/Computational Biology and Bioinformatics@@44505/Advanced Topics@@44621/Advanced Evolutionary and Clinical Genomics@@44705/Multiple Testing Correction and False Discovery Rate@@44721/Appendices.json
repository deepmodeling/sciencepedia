{"hands_on_practices": [{"introduction": "Before diving into complex calculations, it is crucial to understand the fundamental principle of multiple testing correction. This exercise presents a common scenario in genomics to test your understanding of the final decision rule: when faced with a raw $p$-value and an FDR-adjusted $p$-value, which one dictates your conclusion? [@problem_id:1450340] Mastering this concept is the first step toward correctly interpreting high-throughput biological data.", "problem": "In a large-scale differential gene expression study, a systems biologist uses Ribonucleic Acid sequencing (RNA-seq) to compare gene activity in cancer cells treated with a new drug versus untreated control cells. This analysis involves simultaneously testing 20,000 genes to identify which ones show a statistically significant change in expression.\n\nFor one particular gene, `GENE123`, the initial statistical test yields a raw p-value of 0.04. However, to account for the large number of simultaneous tests, the biologist applies a multiple testing correction procedure to control the False Discovery Rate (FDR). After this correction, the FDR-adjusted p-value (also known as a q-value) for `GENE123` is calculated to be 0.35.\n\nThe research team has set their significance threshold for this study at an FDR of 5% (i.e., 0.05). Based on this information, which of the following is the most appropriate conclusion regarding the differential expression of `GENE123`?\n\nA. The gene is significantly differentially expressed because its raw p-value (0.04) is less than the conventional significance level of 0.05.\n\nB. The gene is not significantly differentially expressed because its FDR-adjusted p-value (0.35) is greater than the chosen FDR threshold (0.05).\n\nC. The result is inconclusive; the raw p-value suggests significance while the adjusted p-value does not, so a new experiment is required to resolve the contradiction.\n\nD. The gene is significantly differentially expressed because an FDR-adjusted p-value of 0.35 indicates that only 35% of the discoveries are expected to be false.\n\nE. The gene is a known false positive discovery because its raw p-value was not substantially smaller than 0.05, leading to a large adjustment.", "solution": "We formalize the setting. Let $m=20000$ be the number of simultaneously tested hypotheses (genes), and let the target false discovery rate be $\\alpha=0.05$. For the specific gene, denote the raw p-value by $p$ and the FDR-adjusted p-value (q-value) by $\\tilde{p}$. The data provide $p=0.04$ and $\\tilde{p}=0.35$.\n\nThe decision rule under FDR control (e.g., Benjamini–Hochberg or any equivalent FDR-controlling procedure) is: reject the null hypothesis for a given gene (declare it significantly differentially expressed) at level $\\alpha$ if and only if $\\tilde{p} \\leq \\alpha$. The quantity $\\tilde{p}$ is the minimal FDR level at which the gene would be called significant.\n\nApplying the rule with $\\alpha=0.05$, we compare $\\tilde{p}=0.35$ to $\\alpha=0.05$ and obtain $0.350.05$, hence we do not reject the null hypothesis for this gene. Therefore, the gene is not significantly differentially expressed at the chosen FDR level.\n\nEvaluate the options:\n- A is incorrect because it ignores multiple testing; after multiplicity adjustment, decisions must be based on $\\tilde{p}$, not on the raw $p$ alone.\n- B is correct: $\\tilde{p}=0.35\\alpha=0.05$, so the gene is not significant.\n- C is incorrect because there is no contradiction; the adjustment appropriately alters the decision threshold under multiple testing.\n- D reflects a misinterpretation: $\\tilde{p}=0.35$ means the gene would only be called significant if one were willing to control FDR at $0.35$, which exceeds the chosen $\\alpha=0.05$; thus it is not significant at the study’s threshold.\n- E is incorrect because one cannot label the gene a “known false positive”; the proper conclusion is simply that it is not significant at the specified FDR level.\n\nHence the correct choice is B.", "answer": "$$\\boxed{B}$$", "id": "1450340"}, {"introduction": "Now that we see the importance of using adjusted $p$-values, let's explore the mechanics of a cornerstone method. This problem guides you through applying the Benjamini-Hochberg (BH) procedure to a set of hypothetical $p$-values from a proteomics experiment. [@problem_id:2860696] This hands-on process demystifies the algorithm and builds intuition for how significance thresholds are dynamically determined in a high-throughput setting.", "problem": "In a data-dependent acquisition immunopeptidomics experiment, peptide-spectrum matches are aggregated to the peptide level to test whether each candidate peptide is presented by Major Histocompatibility Complex (MHC) on the cell surface. For each of $m$ peptide-level null hypotheses of non-presentation, a $p$-value is obtained from a calibrated target-decoy competition calibrated score. Assume that under any true null hypothesis the $p$-value is stochastically dominated by the uniform distribution on $[0,1]$ and that $p$-values across hypotheses are independent or satisfy positive regression dependence on a subset (PRDS), as is commonly approximated after decoy-based calibration.\n\nStarting from the definition of the False Discovery Rate (FDR), $\\operatorname{FDR}=\\mathbb{E}\\!\\left[\\frac{V}{\\max(R,1)}\\right]$, where $V$ is the number of false rejections and $R$ is the total number of rejections, derive a step-up multiple-testing rule that guarantees $\\operatorname{FDR}\\leq \\alpha$ for any configuration with $m_{0}$ true nulls, with equality bounded by $\\operatorname{FDR}\\leq \\frac{m_{0}}{m}\\alpha$ under the stated dependence conditions. Then, apply your derived rule to the following $m=10$ peptide-level $p$-values (already sorted in increasing order) to control FDR at $\\alpha=0.01$:\n$\\{0.0005,\\,0.001,\\,0.002,\\,0.004,\\,0.006,\\,0.008,\\,0.012,\\,0.02,\\,0.03,\\,0.05\\}$.\nReport the single Benjamini–Hochberg rejection threshold $p^{\\star}$ (that is, the maximum $p$-value among the rejected hypotheses under your rule) as a pure number without units. No rounding is required.", "solution": "We begin from the definition of False Discovery Rate (FDR). For $m$ hypotheses with $m_{0}$ true nulls, let $R$ denote the total number of rejected hypotheses and $V$ the number of rejected true nulls. The False Discovery Rate is $\\operatorname{FDR}=\\mathbb{E}\\!\\left[\\frac{V}{\\max(R,1)}\\right]$. We assume that for each true null hypothesis the corresponding $p$-value, denoted $p_{j}$, satisfies $\\mathbb{P}(p_{j}\\leq t)\\leq t$ for all $t\\in[0,1]$ (super-uniformity), and that the vector of $p$-values is independent or satisfies positive regression dependence on a subset (PRDS).\n\nOur goal is to construct a data-dependent rejection rule that ensures $\\operatorname{FDR}\\leq \\alpha$ for a chosen target $\\alpha\\in(0,1)$, with the standard Benjamini–Hochberg (BH) upper bound $\\operatorname{FDR}\\leq \\frac{m_{0}}{m}\\alpha$.\n\nWe consider a step-up rule: sort the observed $p$-values in nondecreasing order, $p_{(1)}\\leq p_{(2)}\\leq\\cdots\\leq p_{(m)}$. For a nondecreasing sequence of critical values $\\{c_{i}\\}_{i=1}^{m}$ in $[0,1]$, define the step-up index\n$$\nk=\\max\\{i\\in\\{1,\\dots,m\\}: p_{(i)}\\leq c_{i}\\},\n$$\nwith the convention that $k=0$ if the set is empty. Then reject all hypotheses with $p$-values at most $p_{(k)}$ (equivalently, all $p$-values at most $c_{k}$). We will choose $c_{i}=\\frac{i}{m}\\alpha$ and show the Benjamini–Hochberg guarantee.\n\nDefine indicator variables for the $m_{0}$ true nulls: for a true null indexed by $j$, let $I_{j}=\\mathbf{1}\\{p_{j}\\text{ is rejected}\\}$. Under the step-up rule with $c_{i}=\\frac{i}{m}\\alpha$, the event $\\{p_{j}\\text{ is rejected}\\}$ implies $p_{j}\\leq c_{R}=\\frac{R}{m}\\alpha$, because the rejection threshold is monotone in $R$ and the largest rejected ordered $p$-value satisfies $p_{(R)}\\leq \\frac{R}{m}\\alpha$. Therefore,\n$$\n\\frac{V}{\\max(R,1)}=\\sum_{j\\in\\mathcal{H}_{0}}\\frac{I_{j}}{\\max(R,1)}=\\sum_{j\\in\\mathcal{H}_{0}}\\frac{\\mathbf{1}\\{p_{j}\\leq \\frac{R}{m}\\alpha\\}}{\\max(R,1)}.\n$$\nTaking expectations and using the law of total expectation,\n$$\n\\operatorname{FDR}=\\mathbb{E}\\!\\left[\\frac{V}{\\max(R,1)}\\right]=\\sum_{j\\in\\mathcal{H}_{0}}\\mathbb{E}\\!\\left[\\frac{\\mathbf{1}\\{p_{j}\\leq \\frac{R}{m}\\alpha\\}}{\\max(R,1)}\\right].\n$$\nUnder independence or PRDS, conditioning on the $p$-values of all hypotheses except $j$, the random variable $R$ is measurable with respect to the $\\sigma$-algebra generated by the other $p$-values, and $p_{j}$ remains super-uniform. Hence,\n$$\n\\mathbb{E}\\!\\left[\\left.\\mathbf{1}\\left\\{p_{j}\\leq \\frac{R}{m}\\alpha\\right\\}\\right|\\mathcal{F}_{-j}\\right]\\leq \\frac{R}{m}\\alpha,\n$$\nwhere $\\mathcal{F}_{-j}$ denotes the $\\sigma$-algebra generated by all $p$-values other than $p_{j}$. Dividing by $\\max(R,1)$ and taking expectations yields\n$$\n\\mathbb{E}\\!\\left[\\frac{\\mathbf{1}\\{p_{j}\\leq \\frac{R}{m}\\alpha\\}}{\\max(R,1)}\\right]\\leq \\mathbb{E}\\!\\left[\\frac{\\frac{R}{m}\\alpha}{\\max(R,1)}\\right]\\leq \\frac{\\alpha}{m},\n$$\nwhere the last inequality uses $\\frac{R}{\\max(R,1)}\\leq 1$. Summing over the $m_{0}$ true nulls gives\n$$\n\\operatorname{FDR}\\leq \\sum_{j\\in\\mathcal{H}_{0}}\\frac{\\alpha}{m}=\\frac{m_{0}}{m}\\alpha\\leq \\alpha.\n$$\nThus, the step-up rule with critical values $c_{i}=\\frac{i}{m}\\alpha$ controls the False Discovery Rate at level $\\alpha$ under the stated conditions. This is the Benjamini–Hochberg procedure.\n\nWe now apply this rule to the given $m=10$ peptide-level $p$-values (already sorted):\n$$\n\\{0.0005,\\,0.001,\\,0.002,\\,0.004,\\,0.006,\\,0.008,\\,0.012,\\,0.02,\\,0.03,\\,0.05\\},\n$$\nwith target $\\alpha=0.01$. Compute the sequence of BH critical values $c_{i}=\\frac{i}{m}\\alpha=\\frac{i}{10}\\cdot 0.01$ for $i=1,\\dots,10$:\n$$\nc_{1}=0.001,\\; c_{2}=0.002,\\; c_{3}=0.003,\\; c_{4}=0.004,\\; c_{5}=0.005,\\; c_{6}=0.006,\\; c_{7}=0.007,\\; c_{8}=0.008,\\; c_{9}=0.009,\\; c_{10}=0.010.\n$$\nCompare $p_{(i)}$ to $c_{i}$ to find the largest $k$ such that $p_{(i)}\\leq c_{i}$ for all $i\\leq k$ and $p_{(k)}\\leq c_{k}$:\n- For $i=1$: $0.0005\\leq 0.001$ holds.\n- For $i=2$: $0.001\\leq 0.002$ holds.\n- For $i=3$: $0.002\\leq 0.003$ holds.\n- For $i=4$: $0.004\\leq 0.004$ holds.\n- For $i=5$: $0.006\\leq 0.005$ fails.\n\nThus, the maximal index is $k=4$. The BH rejection threshold $p^{\\star}$, defined as the largest $p$-value among the rejected hypotheses (equivalently $p_{(k)}$), is\n$$\np^{\\star}=p_{(4)}=0.004.\n$$\nTherefore, all hypotheses with $p$-values at most $0.004$ are rejected, and the single numerical threshold requested is $0.004$.", "answer": "$$\\boxed{0.004}$$", "id": "2860696"}, {"introduction": "The Benjamini-Hochberg procedure is powerful, but it's essential to understand the trade-offs it represents by controlling the False Discovery Rate (FDR). This exercise [@problem_id:2408529] places the BH method in context by having you compare its results directly against those from the Holm-Bonferroni procedure, which controls the more stringent Family-Wise Error Rate (FWER). This side-by-side comparison illuminates the critical relationship between the choice of error control, statistical power, and the number of significant discoveries.", "problem": "A differential expression study tests $m=10$ independent gene-wise null hypotheses for equality of mean expression between two conditions, yielding the following two-sided p-values (unsorted): $\\{0.2,\\,0.043,\\,0.013,\\,0.028,\\,0.006,\\,0.001,\\,0.019,\\,0.037,\\,0.024,\\,0.009\\}$. Apply the Benjamini–Hochberg (BH) step-up procedure at target false discovery rate (FDR) $q=0.05$ and, separately, apply the Holm–Bonferroni step-down procedure at family-wise error rate (FWER) $\\alpha=0.05$ to decide which null hypotheses to reject in each case. Let $N_{\\mathrm{BH}}$ be the number of rejections under BH and $N_{\\mathrm{Holm}}$ be the number of rejections under Holm–Bonferroni. Compute the single numerical value $N_{\\mathrm{BH}}-N_{\\mathrm{Holm}}$. No rounding is required.", "solution": "The problem statement is parsed and validated.\n\n### Step 1: Extract Givens\n- Number of independent gene-wise null hypotheses: $m=10$.\n- Set of p-values: $\\{0.2, 0.043, 0.013, 0.028, 0.006, 0.001, 0.019, 0.037, 0.024, 0.009\\}$.\n- Target false discovery rate (FDR) for the Benjamini–Hochberg (BH) procedure: $q=0.05$.\n- Target family-wise error rate (FWER) for the Holm–Bonferroni procedure: $\\alpha=0.05$.\n- $N_{\\mathrm{BH}}$ is the number of rejections under the BH procedure.\n- $N_{\\mathrm{Holm}}$ is the number of rejections under the Holm–Bonferroni procedure.\n- The objective is to compute the value of $N_{\\mathrm{BH}}-N_{\\mathrm{Holm}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientifically Grounded:** The problem is based on established, standard statistical methods for multiple hypothesis testing correction (Benjamini–Hochberg and Holm–Bonferroni procedures), which are fundamental in fields like computational biology and bioinformatics. It is scientifically sound.\n- **Well-Posed:** The problem is clearly defined with all necessary data and parameters. The procedures are algorithmic, leading to a unique, stable, and meaningful solution.\n- **Objective:** The problem is stated with precise, quantitative, and unambiguous language.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe first step for applying both multiple testing correction procedures is to sort the $m=10$ p-values in ascending order. Let $p_{(i)}$ be the $i$-th smallest p-value.\nThe given set of p-values is $\\{0.2, 0.043, 0.013, 0.028, 0.006, 0.001, 0.019, 0.037, 0.024, 0.009\\}$.\nThe sorted p-values are:\n$p_{(1)} = 0.001$\n$p_{(2)} = 0.006$\n$p_{(3)} = 0.009$\n$p_{(4)} = 0.013$\n$p_{(5)} = 0.019$\n$p_{(6)} = 0.024$\n$p_{(7)} = 0.028$\n$p_{(8)} = 0.037$\n$p_{(9)} = 0.043$\n$p_{(10)} = 0.2$\n\nFirst, we apply the Benjamini–Hochberg (BH) step-up procedure to control the FDR at level $q=0.05$.\nThe procedure is to find the largest integer $k \\in \\{1, 2, \\dots, m\\}$ such that $p_{(k)} \\le \\frac{k}{m}q$.\nIf such a $k$ exists, we reject the null hypotheses corresponding to the p-values $p_{(1)}, p_{(2)}, \\dots, p_{(k)}$. Otherwise, we reject no hypotheses.\nHere, $m=10$ and $q=0.05$. We need to find the largest $k$ for which $p_{(k)} \\le \\frac{k}{10}(0.05) = k \\times 0.005$.\nWe check this condition for each $i=1, \\dots, 10$:\n- For $i=1$: $p_{(1)} = 0.001$. Compare with $\\frac{1}{10}(0.05) = 0.005$. Since $0.001 \\le 0.005$, the condition holds.\n- For $i=2$: $p_{(2)} = 0.006$. Compare with $\\frac{2}{10}(0.05) = 0.01$. Since $0.006 \\le 0.01$, the condition holds.\n- For $i=3$: $p_{(3)} = 0.009$. Compare with $\\frac{3}{10}(0.05) = 0.015$. Since $0.009 \\le 0.015$, the condition holds.\n- For $i=4$: $p_{(4)} = 0.013$. Compare with $\\frac{4}{10}(0.05) = 0.02$. Since $0.013 \\le 0.02$, the condition holds.\n- For $i=5$: $p_{(5)} = 0.019$. Compare with $\\frac{5}{10}(0.05) = 0.025$. Since $0.019 \\le 0.025$, the condition holds.\n- For $i=6$: $p_{(6)} = 0.024$. Compare with $\\frac{6}{10}(0.05) = 0.03$. Since $0.024 \\le 0.03$, the condition holds.\n- For $i=7$: $p_{(7)} = 0.028$. Compare with $\\frac{7}{10}(0.05) = 0.035$. Since $0.028 \\le 0.035$, the condition holds.\n- For $i=8$: $p_{(8)} = 0.037$. Compare with $\\frac{8}{10}(0.05) = 0.04$. Since $0.037 \\le 0.04$, the condition holds.\n- For $i=9$: $p_{(9)} = 0.043$. Compare with $\\frac{9}{10}(0.05) = 0.045$. Since $0.043 \\le 0.045$, the condition holds.\n- For $i=10$: $p_{(10)} = 0.2$. Compare with $\\frac{10}{10}(0.05) = 0.05$. Since $0.2 \\not\\le 0.05$, the condition does not hold.\nThe largest index $k$ for which the condition $p_{(k)} \\le \\frac{k}{m}q$ is satisfied is $k=9$.\nTherefore, the BH procedure rejects the $9$ null hypotheses corresponding to the $9$ smallest p-values. The number of rejections is $N_{\\mathrm{BH}} = 9$.\n\nNext, we apply the Holm–Bonferroni step-down procedure to control the FWER at level $\\alpha=0.05$.\nThe procedure tests the sorted p-values sequentially. For each $i=1, \\dots, m$, we compare $p_{(i)}$ with the adjusted significance level $\\frac{\\alpha}{m-i+1}$. The procedure stops at the first index $k$ for which $p_{(k)}  \\frac{\\alpha}{m-k+1}$. We then reject the null hypotheses corresponding to $p_{(1)}, \\dots, p_{(k-1)}$ and fail to reject the rest.\nHere, $m=10$ and $\\alpha=0.05$. We check the condition $p_{(i)} \\le \\frac{0.05}{10-i+1}$.\n- For $i=1$: $p_{(1)} = 0.001$. The threshold is $\\frac{0.05}{10-1+1} = \\frac{0.05}{10} = 0.005$. Since $0.001 \\le 0.005$, we reject the first null hypothesis and proceed to the next step.\n- For $i=2$: $p_{(2)} = 0.006$. The threshold is $\\frac{0.05}{10-2+1} = \\frac{0.05}{9} \\approx 0.00556$. Since $0.006  \\frac{0.05}{9}$, the condition fails. The procedure stops here.\nWe reject the null hypotheses for $i  2$, which means only the hypothesis corresponding to $p_{(1)}$ is rejected. All other hypotheses (for $i=2, \\dots, 10$) are not rejected.\nTherefore, the number of rejections under the Holm–Bonferroni procedure is $N_{\\mathrm{Holm}} = 1$.\n\nFinally, we compute the required value, which is the difference between the number of rejections from the two procedures:\n$N_{\\mathrm{BH}} - N_{\\mathrm{Holm}} = 9 - 1 = 8$.\nThis demonstrates the generally higher power of the Benjamini–Hochberg procedure, which controls the less stringent FDR, compared to the Holm–Bonferroni procedure, which controls the more stringent FWER.", "answer": "$$\\boxed{8}$$", "id": "2408529"}]}