{"hands_on_practices": [{"introduction": "The foundation of reconciling gene and species trees lies in the Duplication-Loss (DL) model. By applying the principle of parsimony, we can infer the most likely evolutionary history that explains the gene copies we see today. This practice problem challenges you to think like a bioinformatician, calculating the minimum number of gene duplication and loss events needed to reconcile observed copy numbers with a species tree, a core skill in phylogenomics [@problem_id:2394119].", "problem": "Consider a single gene family evolving along a rooted binary species tree $(A,B)$, where $A$ and $B$ are the only extant species. Assume the gene family evolves under the standard Duplication–Loss (DL) model with the following conditions: (i) a gene duplication event increases the copy number by $1$ in the lineage in which it occurs, (ii) a gene loss event removes a single copy from the lineage in which it occurs, (iii) there is no horizontal gene transfer and no incomplete lineage sorting, and (iv) the family is present as a single copy in the last common ancestor of $A$ and $B$. You observe a gene tree with leaves mapped to species by sequence labels: three leaves from species $A$ and one leaf from species $B$ (that is, $3$ extant copies in $A$ and $1$ extant copy in $B$). The internal topology of the gene tree is unspecified. Among all reconciliations consistent with these observations and the DL model, determine the minimum number of gene duplication events $d$ and the minimum number of gene loss events $\\ell$ required to explain the observed present-day copy numbers. Report your answer as two integers $d$ and $\\ell$. No rounding is needed.", "solution": "The problem as stated is well-posed and grounded in the standard principles of computational biology. We can proceed with a formal solution.\n\nLet $S$ be the rooted binary species tree. The leaves of $S$ are the extant species $A$ and $B$. Let $R$ denote the root of $S$, which is the last common ancestor (LCA) of $A$ and $B$. The structure of the species tree is thus specified by the root $R$ and two branches descending from it, one leading to leaf $A$ and the other to leaf $B$.\n\nWe are given the copy numbers of the gene family in the extant species: $c(A) = 3$ and $c(B) = 1$. The evolution of the gene family follows a Duplication-Loss (DL) model, with no horizontal gene transfer. The problem states that the gene family is \"present as a single copy in the last common ancestor of $A$ and $B$.\" This establishes the root condition for the copy number evolution. A crucial step is to determine the most parsimonious scenario by considering the number of gene copies present at the moment of speciation at node $R$.\n\nLet $k$ be the number of gene copies present in the ancestral species $R$ just before the speciation event. The initial condition of a single ancestral gene implies that to reach $k$ copies from an initial state of one copy (at an ancestor of $R$), a minimum of $\\max(0, k-1)$ duplication events and $\\max(0, 1-k)$ loss events are required on the branch leading to $R$. Since we seek a minimum number of events, we can assume $k \\ge 1$, so the cost to reach $k$ copies is $k-1$ duplications.\n\nAt the speciation event at node $R$, all $k$ gene copies are passed down to both daughter lineages. Therefore, the lineage leading to species $A$ starts with $k$ copies, and the lineage leading to species $B$ also starts with $k$ copies.\n\nWe now analyze the number of events required on each branch to match the observed copy numbers at the leaves. The minimum number of events required to change the copy number from a starting value $c_{start}$ to an ending value $c_{end}$ on a single lineage is $|c_{end} - c_{start}|$. This comprises $\\max(0, c_{end} - c_{start})$ duplications and $\\max(0, c_{start} - c_{end})$ losses.\n\nFor the lineage leading to $A$:\nThe copy number changes from $k$ to $c(A) = 3$.\nNumber of duplications, $d_A(k) = \\max(0, 3-k)$.\nNumber of losses, $\\ell_A(k) = \\max(0, k-3)$.\n\nFor the lineage leading to $B$:\nThe copy number changes from $k$ to $c(B) = 1$.\nNumber of duplications, $d_B(k) = \\max(0, 1-k)$.\nNumber of losses, $\\ell_B(k) = \\max(0, k-1)$.\n\nThe total number of duplications $d(k)$ and losses $\\ell(k)$ for a given copy number $k$ at speciation is the sum of events on the root branch and on the descending branches:\n$$d(k) = (k-1) + d_A(k) + d_B(k) = (k-1) + \\max(0, 3-k) + \\max(0, 1-k)$$\n$$\\ell(k) = \\ell_A(k) + \\ell_B(k) = \\max(0, k-3) + \\max(0, k-1)$$\nThis assumes $k \\ge 1$.\n\nWe must find the value of $k$ that minimizes the total number of events, which is the sum $d(k) + \\ell(k)$. Let's evaluate this for small integer values of $k \\ge 1$:\n\nCase $k=1$:\n$d(1) = (1-1) + \\max(0, 3-1) + \\max(0, 1-1) = 0 + 2 + 0 = 2$.\n$\\ell(1) = \\max(0, 1-3) + \\max(0, 1-1) = 0 + 0 = 0$.\nThe total number of events is $d(1) + \\ell(1) = 2$.\n\nCase $k=2$:\n$d(2) = (2-1) + \\max(0, 3-2) + \\max(0, 1-2) = 1 + 1 + 0 = 2$.\n$\\ell(2) = \\max(0, 2-3) + \\max(0, 2-1) = 0 + 1 = 1$.\nThe total number of events is $d(2) + \\ell(2) = 3$.\n\nCase $k=3$:\n$d(3) = (3-1) + \\max(0, 3-3) + \\max(0, 1-3) = 2 + 0 + 0 = 2$.\n$\\ell(3) = \\max(0, 3-3) + \\max(0, 3-1) = 0 + 2 = 2$.\nThe total number of events is $d(3) + \\ell(3) = 4$.\n\nFor $k > 3$:\n$d(k) = (k-1) + 0 + 0 = k-1$.\n$\\ell(k) = (k-3) + (k-1) = 2k-4$.\nThe total events $d(k) + \\ell(k) = 3k-5$, which is an increasing function of $k$.\n\nComparing the total number of events, the minimum occurs at $k=1$, yielding a total of $2$ events. This most parsimonious scenario corresponds to having exactly one gene copy at the speciation node $R$, which is consistent with the most direct interpretation of the problem statement.\n\nFor this optimal scenario ($k=1$), the required number of duplications and losses are:\nMinimum duplications $d = d(1) = 2$.\nMinimum losses $\\ell = \\ell(1) = 0$.\n\nThis result corresponds to the following evolutionary history: The single gene copy at the root $R$ is passed to the lineages of $A$ and $B$. In the lineage to $B$, no events occur. In the lineage to $A$, two duplication events occur, raising the copy number from $1$ to $3$.", "answer": "$$\\boxed{\\begin{pmatrix} 2 & 0 \\end{pmatrix}}$$", "id": "2394119"}, {"introduction": "Gene trees inferred from sequence data are often not fully resolved, containing 'polytomies' or nodes with more than two descendants. It is crucial to understand that this uncertainty does not automatically mean a complex burst of evolution occurred. This conceptual exercise explores how reconciliation handles such cases, showing that the most parsimonious explanation for an unresolved gene tree can be a simple history of speciation with no duplications or losses [@problem_id:2394172].", "problem": "Consider a rooted, fully bifurcating species tree $T$ on four species $S_1, S_2, S_3, S_4$ with topology $T = ((S_1,S_2),(S_3,S_4))$. For a single gene family, assume exactly one observed gene copy per species, denoted by leaves $g_{S_1}, g_{S_2}, g_{S_3}, g_{S_4}$. The rooted gene tree $G$ inferred from the gene sequences is a perfect star phylogeny: $G$ has exactly one internal node (the root) connected directly to all four leaves $g_{S_1}, g_{S_2}, g_{S_3}, g_{S_4}$, and no other internal edges. Assume the standard gene tree–species tree reconciliation framework without Horizontal Gene Transfer (HGT), and use duplication–loss parsimony: among all reconciliations $r$ that map each node of $G$ to a node of $T$ and respect ancestral constraints, prefer those that minimize the total number of gene duplication and gene loss events. Here, a reconciliation assigns each internal gene node either a speciation or a duplication label according to whether its image in $T$ equals the lowest common ancestor (LCA) in $T$ of its children’s species mappings or falls below, and gene losses are counted along species-tree branches implied by the mapping.\n\nWhich statement best characterizes what reconciliation implies about the evolution of this gene family, given $G$ is a perfect star?\n\nA. The minimum-parsimony reconciliation infers $0$ duplications and $0$ losses; many equally optimal reconciliations exist because $G$ is unresolved, and any binary refinement of $G$ that is topologically congruent with $T$ yields the minimum.\n\nB. A star gene tree necessarily requires at least $3$ duplications for $4$ leaves, because every extra leaf beyond $2$ must be generated by a duplication at the gene-tree root.\n\nC. At least $1$ loss must be inferred, because a star gene tree cannot be embedded in a fully bifurcating species tree without invoking missing lineages.\n\nD. The only viable reconciliation of a star gene tree requires invoking Horizontal Gene Transfer (HGT), since vertical descent is incompatible with a polytomy.", "solution": "We reason from first principles of duplication–loss reconciliation. Let $G$ be the gene tree and $T$ the species tree. A reconciliation $r$ maps each node of $G$ to a node of $T$ such that:\n- For a leaf $g_{S_i}$, $r(g_{S_i}) = S_i$.\n- For an internal node $u$ of $G$ with children $u_1, \\dots, u_k$, $r(u)$ is constrained to lie on or above $\\mathrm{LCA}_T(r(u_1), \\dots, r(u_k))$ in $T$ to respect temporal and containment constraints.\n- A node $u$ is labeled a speciation if $r(u) = \\mathrm{LCA}_T(r(u_1), \\dots, r(u_k))$; otherwise it is a duplication. Gene losses are counted along branches of $T$ when mapped gene lineages fail to persist across speciations implied by the mapping.\n\nIn duplication–loss parsimony, we seek to minimize the total number of duplications plus losses over valid reconciliations. When there is exactly one observed gene copy per species (one-to-one orthology is not assumed a priori, but it is possible a posteriori), a reconciliation with $0$ duplications and $0$ losses exists if and only if there is a binary refinement of $G$ whose topology is identical to $T$. Because $G$ is a perfect star (a multifurcation with $4$ children), it is topologically unresolved: all binary trees on the same leaf set are refinements of $G$. In particular, the binary tree with topology $((g_{S_1}, g_{S_2}), (g_{S_3}, g_{S_4}))$ is a refinement of $G$ that is isomorphic to $T$ under the leaf-to-species identification. Mapping each internal node of this refined $G$ to the corresponding internal node of $T$ yields a reconciliation in which every internal gene node is a speciation, and because there is exactly one gene per species and no extra lineages implied, no losses are required. Therefore, the minimum-parsimony cost is $0$ duplications and $0$ losses. Moreover, because $G$ is unresolved, there are many equally valid reconciliations at the same minimum cost: any refinement of $G$ that is topologically congruent with $T$ (here, exactly the one matching $T$ up to isomorphism) achieves the minimum; more generally, the mapping from the multifurcating root of $G$ to the root of $T$ with a congruent refinement yields the same minimal event count. The reconciliation is thus non-unique.\n\nWe now analyze each option:\n\nA. This states that the minimum-parsimony reconciliation infers $0$ duplications and $0$ losses and that many equally optimal reconciliations exist because $G$ is unresolved, with any binary refinement of $G$ that is congruent with $T$ achieving the minimum. As shown above, there exists a refinement of $G$ matching $T$, yielding a reconciliation with no duplications or losses. The unresolved nature of $G$ implies multiple equally optimal mappings in general, and in particular, any congruent refinement achieves the minimum. This is Correct.\n\nB. This claims at least $3$ duplications are required for $4$ leaves. That reasoning incorrectly treats each additional leaf beyond $2$ as necessarily produced by duplication. In our setting, with one copy per species and a species tree that can be matched by a refinement of $G$, no duplication is required: speciations in $T$ can account for the presence of $4$ leaves. This is Incorrect.\n\nC. This asserts that at least $1$ loss must be inferred because a star cannot be embedded in a bifurcating species tree without losses. The star reflects lack of resolution in $G$, not missing lineages. Since a refinement of $G$ can match $T$, no loss is necessary to reconcile the observed one-to-one presence. This is Incorrect.\n\nD. This says Horizontal Gene Transfer (HGT) is required. The assumptions explicitly exclude HGT, and even without that exclusion, HGT is not required here: vertical descent along $T$ with a congruent refinement of $G$ explains the data without any extra events. This is Incorrect.", "answer": "$$\\boxed{A}$$", "id": "2394172"}, {"introduction": "Evolution is not always a simple story of vertical descent; Horizontal Gene Transfer (HGT) allows genes to jump between species, creating complex histories. Reconciliation algorithms using the Duplication-Transfer-Loss (DTL) model are designed to unravel these events. This practice problem presents a classic scenario to help you distinguish between orthologs, which arise from speciation, and xenologs, which are a direct consequence of HGT [@problem_id:2405916].", "problem": "A Horizontal Gene Transfer (HGT) event moves a gene from a donor lineage $\\mathcal{D}$ into a recipient lineage $\\mathcal{R}$ at time $t_0$. Immediately afterward (at time $t_0 + \\varepsilon$), the species $\\mathcal{R}$ undergoes a speciation that yields two descendant species $\\mathcal{R}_1$ and $\\mathcal{R}_2$. Assume that prior to the HGT, the recipient lineage $\\mathcal{R}$ had no homolog of this gene, and that after the HGT and speciation events there are no additional gene duplications or gene losses. Consequently, the present-day samples include one gene copy from $\\mathcal{D}$ (inherited vertically within $\\mathcal{D}$) and one gene copy in each of $\\mathcal{R}_1$ and $\\mathcal{R}_2$ (descended from the transferred copy). A gene tree–species tree reconciliation under a model allowing gene Duplication, Transfer, and Loss (DTL) is applied.\n\nWhich interpretation best describes how the reconciliation algorithm maps the gene tree to the species tree around these events, and how it classifies the pairwise relationships among the three sampled gene copies?\n\nA. The algorithm interprets a gene duplication within $\\mathcal{R}$ just before the speciation of $\\mathcal{R}$, followed by vertical inheritance into $\\mathcal{R}_1$ and $\\mathcal{R}_2$; it classifies the $\\mathcal{R}_1$ and $\\mathcal{R}_2$ copies as in-paralogs and treats both as orthologs of the $\\mathcal{D}$ copy.\n\nB. The algorithm interprets a transfer from $\\mathcal{D}$ into $\\mathcal{R}$, followed by a speciation event in $\\mathcal{R}$ that vertically splits the transferred lineage into $\\mathcal{R}_1$ and $\\mathcal{R}_2$; it classifies the $\\mathcal{R}_1$ and $\\mathcal{R}_2$ copies as orthologs of each other, and each as a xenolog of the $\\mathcal{D}$ copy.\n\nC. The algorithm interprets incomplete lineage sorting without duplication, transfer, or loss; it classifies all three copies ($\\mathcal{D}$, $\\mathcal{R}_1$, $\\mathcal{R}_2$) as mutual orthologs.\n\nD. The algorithm interprets a speciation in $\\mathcal{D}$ mirrored by a duplication in $\\mathcal{R}$, followed by concerted evolution; it classifies the $\\mathcal{R}_1$ and $\\mathcal{R}_2$ copies as xenologs of each other and both as orthologs of the $\\mathcal{D}$ copy.", "solution": "The Duplication-Transfer-Loss (DTL) reconciliation model aims to explain the incongruence between a gene tree and a species tree by postulating a minimum number of gene duplication, horizontal gene transfer, and gene loss events. Let us trace the history of the three sampled gene copies—let them be $g_{\\mathcal{D}}$, $g_{\\mathcal{R}_1}$, and $g_{\\mathcal{R}_2}$ from species $\\mathcal{D}$, $\\mathcal{R}_1$, and $\\mathcal{R}_2$ respectively.\n\n$1$. **The HGT Event**: The problem explicitly states that at time $t_0$, a gene was transferred from lineage $\\mathcal{D}$ to lineage $\\mathcal{R}$. In a DTL reconciliation, this event is identified as a horizontal transfer because the gene tree will show the ancestor of $g_{\\mathcal{R}_1}$ and $g_{\\mathcal{R}_2}$ branching from within the $\\mathcal{D}$ lineage, a topology that is incongruent with the species tree unless a transfer is invoked.\n\n$2$. **The Speciation Event**: Immediately after the transfer, at time $t_0 + \\varepsilon$, the recipient species $\\mathcal{R}$ speciates into $\\mathcal{R}_1$ and $\\mathcal{R}_2$. The gene that was newly acquired by $\\mathcal{R}$ is passed down to both descendant species through vertical inheritance. The divergence between the gene lineages leading to $g_{\\mathcal{R}_1}$ and $g_{\\mathcal{R}_2}$ is therefore caused by the speciation of their host organism.\n\n$3$. **Classification of Homologous Relationships**: The classification of the relationship between any two homologous genes is determined by the last common evolutionary event of their ancestral copies.\n- **Orthologs**: Genes in different species that originated from a single ancestral gene in the last common ancestor of those species. Their divergence is a result of a speciation event. In our case, the last common ancestor of $g_{\\mathcal{R}_1}$ and $g_{\\mathcal{R}_2}$ existed in species $\\mathcal{R}$, and these two gene copies diverged precisely because species $\\mathcal{R}$ split into $\\mathcal{R}_1$ and $\\mathcal{R}_2$. Therefore, $g_{\\mathcal{R}_1}$ and $g_{\\mathcal{R}_2}$ are **orthologs**.\n- **Paralogs**: Genes related via a duplication event. Since the problem states no duplication occurs, this relationship is not present.\n- **Xenologs**: Genes in different species where the history of at least one of the genes involves an HGT event since their last common ancestor. The common ancestor of the entire gene family in this problem existed before the HGT. The lineage leading to $g_{\\mathcal{D}}$ evolved vertically, while the lineage leading to $g_{\\mathcal{R}_1}$ and $g_{\\mathcal{R}_2}$ was initiated by an HGT from $\\mathcal{D}$'s lineage. Therefore, the relationship between $g_{\\mathcal{D}}$ and $g_{\\mathcal{R}_1}$ is one of **xenology**. Similarly, the relationship between $g_{\\mathcal{D}}$ and $g_{\\mathcal{R}_2}$ is also **xenology**.\n\nIn summary, the DTL reconciliation algorithm will map an HGT event from $\\mathcal{D}$ to $\\mathcal{R}$, followed by a speciation event at the node where $\\mathcal{R}$ splits into $\\mathcal{R}_1$ and $\\mathcal{R}_2$. This leads to the classification of ($g_{\\mathcal{R}_1}$, $g_{\\mathcal{R}_2}$) as orthologs, and ($g_{\\mathcal{D}}$, $g_{\\mathcal{R}_1}$) and ($g_{\\mathcal{D}}$, $g_{\\mathcal{R}_2}$) as xenologs.\n\n**Option-by-Option Analysis**\n\n**A. The algorithm interprets a gene duplication within $\\mathcal{R}$ just before the speciation of $\\mathcal{R}$, followed by vertical inheritance into $\\mathcal{R}_1$ and $\\mathcal{R}_2$; it classifies the $\\mathcal{R}_1$ and $\\mathcal{R}_2$ copies as in-paralogs and treats both as orthologs of the $\\mathcal{D}$ copy.**\nThis is incorrect. A DTL algorithm infers a duplication when gene divergence precedes species divergence. Here, the gene divergence (splitting of the gene in $\\mathcal{R}$ into the copies in $\\mathcal{R}_1$ and $\\mathcal{R}_2$) is coincident with the species divergence. This is the definition of a speciation event in reconciliation. Consequently, the copies in $\\mathcal{R}_1$ and $\\mathcal{R}_2$ are orthologs, not paralogs. The relationship to the gene in $\\mathcal{D}$ involves an HGT and is thus xenology, not orthology. **Verdict: Incorrect.**\n\n**B. The algorithm interprets a transfer from $\\mathcal{D}$ into $\\mathcal{R}$, followed by a speciation event in $\\mathcal{R}$ that vertically splits the transferred lineage into $\\mathcal{R}_1$ and $\\mathcal{R}_2$; it classifies the $\\mathcal{R}_1$ and $\\mathcal{R}_2$ copies as orthologs of each other, and each as a xenolog of the $\\mathcal{D}$ copy.**\nThis is correct. The interpretation correctly identifies the sequence of events: a transfer from $\\mathcal{D}$ to $\\mathcal{R}$, followed by a speciation of $\\mathcal{R}$. The classification is also correct. The divergence of genes due to the host's speciation makes them orthologs. The HGT event in the history of the $\\mathcal{R}$-clade genes makes them xenologs with respect to the $\\mathcal{D}$ gene. This description perfectly matches the derived outcome. **Verdict: Correct.**\n\n**C. The algorithm interprets incomplete lineage sorting without duplication, transfer, or loss; it classifies all three copies ($\\mathcal{D}$, $\\mathcal{R}_1$, $\\mathcal{R}_2$) as mutual orthologs.**\nThis is incorrect. A DTL reconciliation model explicitly accounts for Duplication, Transfer, and Loss. It does not primarily model Incomplete Lineage Sorting (ILS), which is typically handled by coalescent-based models. Given the scenario where a gene appears in a distant lineage where it was previously absent, a DTL model's most parsimonious explanation is HGT, not ILS. Furthermore, classifying all three as \"mutual orthologs\" is incorrect because the relationship with the $\\mathcal{D}$ gene is xenology. **Verdict: Incorrect.**\n\n**D. The algorithm interprets a speciation in $\\mathcal{D}$ mirrored by a duplication in $\\mathcal{R}$, followed by concerted evolution; it classifies the $\\mathcal{R}_1$ and $\\mathcal{R}_2$ copies as xenologs of each other and both as orthologs of the $\\mathcal{D}$ copy.**\nThis is incorrect. The terminology \"speciation in $\\mathcal{D}$ mirrored by a duplication in $\\mathcal{R}$\" and \"concerted evolution\" is not part of the standard DTL reconciliation framework and does not describe the given events. The classification is fundamentally wrong: the $\\mathcal{R}_1$ and $\\mathcal{R}_2$ copies are orthologs, not xenologs, of each other. The relationship to the $\\mathcal{D}$ copy is xenology, not orthology. **Verdict: Incorrect.**", "answer": "$$\\boxed{B}$$", "id": "2405916"}]}