{"hands_on_practices": [{"introduction": "Distinguishing orthologs from paralogs is a cornerstone of comparative genomics, but the dynamic nature of evolution can create misleading scenarios. This exercise explores a classic pitfall known as hidden paralogy, where gene duplication followed by differential gene loss can make two paralogous genes appear as a simple one-to-one orthologous pair. By working through this thought experiment [@problem_id:2405912], you will develop a foundational understanding of how evolutionary history, not just gene counts, defines these critical relationships.", "problem": "Two sister lineages, species $A$ and species $B$, diverged from a common ancestor at a single speciation event. In the common ancestor, before this speciation, a single ancestral gene $G$ duplicated once, producing two distinct paralogous copies $G_1$ and $G_2$. After the speciation, gene loss events may occur independently in each lineage. By definition, orthologs are genes in different species that diverged due to a speciation event, while paralogs are genes related by a duplication event. A naive orthology inference procedure labels a pair of genes as orthologs if and only if there is exactly one detectable copy in species $A$ and exactly one detectable copy in species $B$ (a $1$-to-$1$ relationship).\n\nAssume that all duplications occurred before the speciation and that no further duplications occur after speciation. Starting from the duplication in the ancestor and the subsequent speciation, what is the minimal total number $k$ of independent post-speciation gene loss events across the sister lineages required so that, at present, there is exactly one detectable copy in species $A$ and exactly one detectable copy in species $B$, yet those two extant copies are not orthologs but instead are paralogs that would be incorrectly labeled as $1$-to-$1$ orthologs by the naive procedure?\n\nGive your answer as an integer. No rounding is needed.", "solution": "The problem requires an analysis of gene lineage evolution, specifically concerning the concepts of orthology and paralogy, following a gene duplication event and a subsequent speciation event. We must determine the minimum number of post-speciation gene loss events required to create a specific misleading scenario for a naive orthology detection method.\n\nLet us begin by formalizing the state of the gene families immediately following the given events.\n\n$1$. **Ancestral State**: Before speciation, a single gene $G$ in the common ancestor duplicates, resulting in two paralogous gene copies, which we denote as $G_1$ and $G_2$. By definition, $G_1$ and $G_2$ are paralogs. The genome of the common ancestor thus contains $\\{G_1, G_2\\}$.\n\n$2$. **Speciation Event**: The common ancestor splits into two new lineages, which will evolve into species $A$ and species $B$. At the moment of speciation, the entire genomic content of the ancestor, including both paralogs, is inherited by each nascent lineage.\n\n$3$. **Post-Speciation State (Initial)**: Immediately after the speciation event, but before any gene loss, the gene content is as follows:\n- The lineage leading to species $A$ contains two genes, which we label $G_{1A}$ and $G_{2A}$.\n- The lineage leading to species $B$ contains two genes, which we label $G_{1B}$ and $G_{2B}$.\n\n$G_{1A}$ is the descendant of the ancestral gene $G_1$ in species $A$, and so forth.\n\n$4$. **Gene Relationships**: Based on the standard definitions of orthology and paralogy:\n- **Orthologs** are genes in different species that arose from a common ancestral gene via a speciation event. Therefore, the orthologous pairs are $(G_{1A}, G_{1B})$ and $(G_{2A}, G_{2B})$.\n- **Paralogs** are genes related by a duplication event.\n  - The duplication occurred in the common ancestor, before the speciation. Thus, $G_1$ and $G_2$ are paralogs. All of their descendants inherit this paralogous relationship.\n  - Within species $A$, the pair $(G_{1A}, G_{2A})$ are paralogs.\n  - Within species $B$, the pair $(G_{1B}, G_{2B})$ are paralogs.\n  - Across species, the pairs $(G_{1A}, G_{2B})$ and $(G_{2A}, G_{1B})$ are also paralogs. These are specifically termed \"out-paralogs,\" as their duplication event predates the speciation event separating their respective species.\n\nThe problem describes a naive orthology inference procedure that classifies a pair of genes as orthologs if and only if there is exactly one copy in species $A$ and one copy in species $B$. We are tasked with finding the minimal number of post-speciation gene loss events, $k$, that leads to a state where:\na) There is exactly one gene copy in species $A$.\nb) There is exactly one gene copy in species $B$.\nc) This pair of genes are paralogs, not orthologs.\n\nThis configuration, having a $1$-to-$1$ gene count, would be incorrectly labeled as a pair of \"orthologs\" by the naive procedure.\n\nLet us analyze the number of gene losses required. The initial state contains four genes in total across the two species: $\\{G_{1A}, G_{2A}\\}$ in species $A$ and $\\{G_{1B}, G_{2B}\\}$ in species $B$. The target state must have one gene in each species.\n\nTo satisfy the condition that the remaining two genes are paralogs, the final pair must be either $(G_{1A}, G_{2B})$ or $(G_{2A}, G_{1B})$.\n\nLet us consider the first case: the final pair is $(G_{1A}, G_{2B})$.\n- To have only $G_{1A}$ remaining in species $A$, the gene $G_{2A}$ must be lost. This constitutes **one** gene loss event.\n- To have only $G_{2B}$ remaining in species $B$, the gene $G_{1B}$ must be lost. This constitutes a **second** gene loss event.\nThe total number of independent gene loss events required for this scenario is $1 + 1 = 2$.\n\nNow, let us consider the second case: the final pair is $(G_{2A}, G_{1B})$.\n- To have only $G_{2A}$ remaining in species $A$, the gene $G_{1A}$ must be lost. This is **one** gene loss event.\n- To have only $G_{1B}$ remaining in species $B$, the gene $G_{2B}$ must be lost. This is a **second** gene loss event.\nThe total number of independent gene loss events required for this scenario is also $1 + 1 = 2$.\n\nIn both scenarios that satisfy all conditions of the problem, exactly two gene loss events are required. We must now verify if it is possible to achieve this state with fewer than $2$ events.\n\n- **Case of $k=0$ losses**: Species $A$ has $\\{G_{1A}, G_{2A}\\}$ and species $B$ has $\\{G_{1B}, G_{2B}\\}$. This is a $2$-to-$2$ relationship, which violates the condition of having exactly one gene in each species.\n\n- **Case of $k=1$ loss**: Let us assume one gene is lost. For example, suppose $G_{1A}$ is lost.\n  - Species $A$ now has $\\{G_{2A}\\}$ (one copy).\n  - Species $B$ still has $\\{G_{1B}, G_{2B}\\}$ (two copies).\n  This results in a $1$-to-$2$ relationship, which violates the condition of having exactly one gene in species $B$. The outcome is analogous for any other single gene loss event. Therefore, one loss event is insufficient.\n\nSince the desired configuration cannot be achieved with $0$ or $1$ loss events, and we have demonstrated that it can be achieved with $2$ loss events, the minimal total number of gene loss events is $2$. This phenomenon, where differential gene loss of paralogs after speciation leads to a $1$-to-$1$ relationship between paralogs, is a classic example of \"hidden paralogy\" that confounds simple orthology detection methods.", "answer": "$$\\boxed{2}$$", "id": "2405912"}, {"introduction": "While sequence similarity is a powerful guide for identifying homologs, it can be a deceptive proxy for orthology, especially when evolutionary rates are not uniform across gene families. This problem [@problem_id:2405969] presents a realistic scenario where the popular Reciprocal Best Hit (RBH) method fails due to asymmetric sequence divergence, incorrectly pairing a gene with its more highly conserved paralog. You will see how integrating contextual information, specifically conserved gene order (synteny), provides the crucial evidence needed to resolve the true orthologous relationship.", "problem": "Two species, denoted $S_A$ and $S_B$, each contain homologs of an ancient enzyme gene. In the common ancestor of $S_A$ and $S_B$, this enzyme gene duplicated to produce two copies, which we denote $G\\alpha$ and $G\\beta$. After the subsequent speciation that produced $S_A$ and $S_B$, species $S_A$ lost copy $G\\beta$, whereas species $S_B$ retained both $G\\alpha$ and $G\\beta$. Thus, in the present day, $S_A$ has one enzyme gene, $G_A$, and $S_B$ has two enzyme genes, $G\\alpha_B$ and $G\\beta_B$.\n\nLocal gene neighborhoods in the two species are as follows:\n- In $S_A$, the order of three adjacent genes on a chromosome is $X_A$ — $G_A$ — $Y_A$.\n- In $S_B$, there are two loci containing $G\\alpha_B$ and $G\\beta_B$:\n  - Locus $1$: $X_B$ — $G\\alpha_B$ — $Y_B$\n  - Locus $2$: $U_B$ — $G\\beta_B$ — $V_B$\n\nPairwise protein sequence similarity searches using the Basic Local Alignment Search Tool (BLAST) were performed across the full proteomes of $S_A$ and $S_B$. The top alignments relevant to these genes are:\n- $G_A$ vs $G\\beta_B$: 93% amino acid identity over 900 aligned positions, E-value $1\\times 10^{-150}$.\n- $G_A$ vs $G\\alpha_B$: 85% amino acid identity over 900 aligned positions, E-value $1\\times 10^{-120}$.\n- When $G\\beta_B$ is queried against $S_A$, its best hit is $G_A$ (the alignment above). When $G\\alpha_B$ is queried against $S_A$, its best hit is also $G_A$ with 85% identity as above.\n\nFor the flanking genes, the best matches between $S_A$ and $S_B$ are:\n- $X_A$ vs $X_B$: 88% identity, highly significant; no significant similarity between $X_A$ and genes near $G\\beta_B$.\n- $Y_A$ vs $Y_B$: 90% identity, highly significant; no significant similarity between $Y_A$ and genes near $G\\beta_B$.\n\nAssume that orthologs are defined as homologous genes whose most recent divergence event is a speciation, and paralogs are homologous genes whose most recent divergence event is a duplication. A reciprocal best hit (RBH) is defined here as a pair of genes from $S_A$ and $S_B$ that are each other’s single highest-scoring BLAST hit across the respective proteomes. A synteny-based inference relies on conservation of local gene order and content to infer shared ancestry across a speciation event.\n\nBased only on the information provided and these definitions, which option best identifies the orthologous relationship between $G_A$ and the $S_B$ copies, and explains why a reciprocal best hit approach would fail while a synteny-based approach would succeed in this case?\n\nA. $G\\alpha_B$ is the sole ortholog of $G_A$; the duplication predated speciation so $G\\beta_B$ is an out-paralog. Despite its lower sequence identity, $G\\alpha_B$ resides between $X_B$ and $Y_B$, whose orthologs $X_A$ and $Y_A$ flank $G_A$, indicating conserved synteny and shared ancestry across the speciation. The reciprocal best hit between $G_A$ and $G\\beta_B$ is misleading due to more recent sequence homogenization of $G\\beta_B$.\n\nB. $G\\beta_B$ is the sole ortholog of $G_A$; the reciprocal best hit and higher sequence identity definitively establish orthology, making synteny irrelevant.\n\nC. Neither $G\\alpha_B$ nor $G\\beta_B$ is an ortholog of $G_A$; $G_A$ has no ortholog in $S_B$ because the duplication and subsequent losses severed orthologous relationships.\n\nD. Both $G\\alpha_B$ and $G\\beta_B$ are orthologs (co-orthologs) of $G_A$ because the duplication occurred after the speciation of $S_A$ and $S_B$, so sequence and synteny cannot distinguish them.", "solution": "The problem statement will first be subjected to rigorous validation.\n\n**Step 1: Extract Givens**\n\n1.  **Species and Genes**:\n    -   Two species: $S_A$ and $S_B$.\n    -   Common ancestor had an enzyme gene.\n    -   Gene duplication in common ancestor produced two paralogous copies: $G\\alpha$ and $G\\beta$.\n    -   Subsequent speciation produced lineages leading to $S_A$ and $S_B$.\n    -   Post-speciation, $S_A$ lost copy $G\\beta$. $S_B$ retained both $G\\alpha$ and $G\\beta$.\n    -   Present-day genes: $S_A$ has $G_A$; $S_B$ has $G\\alpha_B$ and $G\\beta_B$.\n\n2.  **Gene Neighborhoods (Synteny)**:\n    -   In $S_A$: $X_A$ — $G_A$ — $Y_A$.\n    -   In $S_B$, Locus $1$: $X_B$ — $G\\alpha_B$ — $Y_B$.\n    -   In $S_B$, Locus $2$: $U_B$ — $G\\beta_B$ — $V_B$.\n\n3.  **BLAST Sequence Similarity**:\n    -   $G_A$ vs $G\\beta_B$: 93% amino acid identity over 900 positions, E-value $1\\times 10^{-150}$.\n    -   $G_A$ vs $G\\alpha_B$: 85% amino acid identity over 900 positions, E-value $1\\times 10^{-120}$.\n    -   When $G\\beta_B$ is queried against $S_A$, its best hit is $G_A$.\n    -   When $G\\alpha_B$ is queried against $S_A$, its best hit is $G_A$.\n\n4.  **Flanking Gene Similarity**:\n    -   $X_A$ vs $X_B$: 88% identity, highly significant.\n    -   $Y_A$ vs $Y_B$: 90% identity, highly significant.\n    -   No significant similarity between $X_A$ or $Y_A$ and genes near $G\\beta_B$.\n\n5.  **Definitions**:\n    -   **Orthologs**: Homologous genes whose most recent divergence event is a speciation.\n    -   **Paralogs**: Homologous genes whose most recent divergence event is a duplication.\n    -   **Reciprocal Best Hit (RBH)**: A pair of genes from $S_A$ and $S_B$ that are each other’s single highest-scoring BLAST hit.\n    -   **Synteny-based inference**: Relies on conservation of local gene order.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The scenario describes gene duplication, speciation, and differential gene loss, which are fundamental processes in molecular evolution. The methods described—BLAST for sequence similarity, reciprocal best hits, and synteny analysis—are standard and established techniques in computational biology for inferring homology relationships. The data provided (identities, E-values) are plausible. The problem is firmly grounded in scientific principles.\n-   **Well-Posed**: The problem provides a clear evolutionary history and sufficient data (sequence similarity, synteny) to deduce the relationships between the genes. It then asks to evaluate different inference methods against this known history. A unique, meaningful solution can be derived from the premises.\n-   **Objective**: The statement is presented with quantitative data and formal definitions. It is free of subjective or ambiguous language.\n-   **Consistency and Completeness**: The problem statement is internally consistent. The evolutionary history described is a classic case study used to illustrate the complexities of orthology assignment. All necessary definitions and data are provided.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is scientifically sound, well-posed, objective, and self-contained. It is a valid problem in computational biology. I will proceed with the solution.\n\n**Solution Derivation**\n\nThe core of the problem is to determine the correct evolutionary relationships based on the provided history and then evaluate how two common bioinformatic methods—Reciprocal Best Hit (RBH) and synteny analysis—perform in this scenario.\n\n1.  **Reconstruction of Evolutionary History and Relationships**:\n    Let us formalize the evolutionary history as described.\n    -   **Event 1 (Duplication)**: In the common ancestor of $S_A$ and $S_B$, a gene $G_{anc}$ duplicates, creating $G\\alpha$ and $G\\beta$. By definition, $G\\alpha$ and $G\\beta$ are paralogs. This duplication predates the speciation. Genes related by such a duplication are termed \"out-paralogs\" with respect to the subsequent speciation event.\n    -   **Event 2 (Speciation)**: The ancestral species splits into two lineages, one leading to $S_A$ and one to $S_B$. Both lineages inherit both gene copies, $G\\alpha$ and $G\\beta$. The ancestor of $S_A$ has $G\\alpha_{ancA}$ and $G\\beta_{ancA}$. The ancestor of $S_B$ has $G\\alpha_{ancB}$ and $G\\beta_{ancB}$. The divergence between $G\\alpha_{ancA}$ and $G\\alpha_{ancB}$ is the speciation event, making them orthologs. Similarly, $G\\beta_{ancA}$ and $G\\beta_{ancB}$ are orthologs.\n    -   **Event 3 (Gene Loss)**: The lineage leading to $S_A$ loses its $G\\beta_{ancA}$ copy. The lineage leading to $S_B$ retains both copies.\n    -   **Present Day**: $G\\alpha_{ancA}$ has evolved into $G_A$ in species $S_A$. $G\\alpha_{ancB}$ has evolved into $G\\alpha_B$ in species $S_B$. $G\\beta_{ancB}$ has evolved into $G\\beta_B$ in species $S_B$.\n\n    Based on this causal chain, we determine the correct relationships:\n    -   The divergence between $G_A$ and $G\\alpha_B$ traces back to the speciation event. Therefore, **$G_A$ and $G\\alpha_B$ are orthologs.**\n    -   The divergence between $G_A$ (descended from $G\\alpha$) and $G\\beta_B$ (descended from $G\\beta$) traces back to the gene duplication event in the common ancestor. Therefore, **$G_A$ and $G\\beta_B$ are paralogs (specifically, out-paralogs).**\n\n2.  **Analysis of Inference Methods**:\n    -   **Reciprocal Best Hit (RBH) Method**:\n        - A BLAST search of $G_A$ against the proteome of $S_B$ would compare the alignment scores for $G\\alpha_B$ and $G\\beta_B$. Given the data, $G_A$ vs $G\\beta_B$ shows 93% identity and E-value $1\\times 10^{-150}$, while $G_A$ vs $G\\alpha_B$ shows 85% identity and E-value $1\\times 10^{-120}$. The alignment with $G\\beta_B$ is significantly better. Thus, the best hit for $G_A$ in $S_B$ is $G\\beta_B$.\n        - The problem states that the best hit for $G\\beta_B$ in $S_A$ is $G_A$.\n        - Since they are each other's best hit, $G_A$ and $G\\beta_B$ form a reciprocal best hit pair. The RBH method would therefore incorrectly identify the paralogs $G_A$ and $G\\beta_B$ as orthologs.\n        - **Conclusion**: The RBH method fails in this scenario. This is a known pitfall of RBH, occurring when there is asymmetric sequence divergence after speciation, where a paralog retains higher sequence similarity to a gene in another species than the true ortholog does.\n\n    -   **Synteny-Based Method**:\n        - Synteny refers to the conservation of gene order on chromosomes.\n        - The gene neighborhood in $S_A$ is $X_A$ — $G_A$ — $Y_A$.\n        - In $S_B$, gene $G\\alpha_B$ is in the neighborhood $X_B$ — $G\\alpha_B$ — $Y_B$.\n        - The problem states that $X_A$ and $X_B$ are highly similar, as are $Y_A$ and $Y_B$. This indicates that the entire genomic locus $X-G-Y$ is conserved between $S_A$ and the locus containing $G\\alpha_B$ in $S_B$. Such a conserved block of genes is strong evidence that these two regions are orthologous, meaning they derive from the same region in the common ancestor.\n        - Conversely, there is no conserved synteny between the locus of $G_A$ in $S_A$ and the locus of $G\\beta_B$ ($U_B$ — $G\\beta_B$ — $V_B$) in $S_B$.\n        - Therefore, synteny analysis correctly infers that $G_A$ and $G\\alpha_B$, which reside in orthologous genomic contexts, are the true orthologs.\n        - **Conclusion**: The synteny-based method succeeds.\n\n**Option-by-Option Analysis**\n\n-   **A. $G\\alpha_B$ is the sole ortholog of $G_A$; the duplication predated speciation so $G\\beta_B$ is an out-paralog. Despite its lower sequence identity, $G\\alpha_B$ resides between $X_B$ and $Y_B$, whose orthologs $X_A$ and $Y_A$ flank $G_A$, indicating conserved synteny and shared ancestry across the speciation. The reciprocal best hit between $G_A$ and $G\\beta_B$ is misleading due to more recent sequence homogenization of $G\\beta_B$.**\n    -   This option correctly identifies $G\\alpha_B$ as the ortholog and $G\\beta_B$ as the out-paralog based on a correct understanding of the evolutionary history (duplication before speciation).\n    -   It correctly uses the synteny data ($X_A$/$X_B$, $Y_A$/$Y_B$) to support the orthology claim.\n    -   It correctly identifies that the RBH method is misleading. The reason given (\"homogenization\") is one possible, though not explicitly proven, cause for the asymmetric divergence rates, but the overall statement is the most accurate and complete description of the facts presented.\n    -   **Verdict: Correct.**\n\n-   **B. $G\\beta_B$ is the sole ortholog of $G_A$; the reciprocal best hit and higher sequence identity definitively establish orthology, making synteny irrelevant.**\n    -   This option incorrectly identifies $G\\beta_B$ as the ortholog. As derived, it is a paralog.\n    -   It incorrectly claims that RBH and sequence identity are \"definitive\". They are heuristics that are demonstrably failing in this well-defined case.\n    -   It incorrectly dismisses synteny, which is the key evidence for the correct assignment.\n    -   **Verdict: Incorrect.**\n\n-   **C. Neither $G\\alpha_B$ nor $G\\beta_B$ is an ortholog of $G_A$; $G_A$ has no ortholog in $S_B$ because the duplication and subsequent losses severed orthologous relationships.**\n    -   This statement fundamentally misunderstands the definition of orthology. The relationship between $G_A$ and $G\\alpha_B$ is orthologous because their last common ancestor gene existed immediately prior to the speciation event. Gene loss in one lineage does not erase the orthologous relationship between the surviving genes.\n    -   **Verdict: Incorrect.**\n\n-   **D. Both $G\\alpha_B$ and $G\\beta_B$ are orthologs (co-orthologs) of $G_A$ because the duplication occurred after the speciation of $S_A$ and $S_B$, so sequence and synteny cannot distinguish them.**\n    -   The premise of this option, that the duplication occurred *after* speciation, directly contradicts the problem statement: \"In the common ancestor of $S_A$ and $S_B$, this enzyme gene duplicated\". If the premise were true, the conclusion about co-orthology would be correct, but since the premise is false, the option is invalid.\n    -   **Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2405969"}, {"introduction": "Robust orthology inference often requires synthesizing multiple, independent lines of evidence rather than relying on a single criterion. This exercise [@problem_id:2405931] introduces a powerful, quantitative framework for this task by combining sequence similarity, synteny, and co-expression data into a single \"orthology confidence score.\" By calculating this score, which uses a weighted harmonic mean to appropriately penalize weakness in any one area, you will learn a practical method for moving beyond simple heuristics to a more sophisticated and reliable model of orthology.", "problem": "You are given a set of candidate gene pairs between two species. For each pair, three independent evidence types are provided: a normalized sequence similarity score $s \\in [0,1]$, a normalized synteny conservation score $y \\in [0,1]$ representing the fraction of conserved neighbors, and a co-expression correlation $r \\in [-1,1]$ measured as the Pearson correlation coefficient (PCC) across matched conditions. Define a nonnegative correlation-derived evidence $c$ by the linear mapping $c = \\dfrac{r + 1}{2}$ so that $c \\in [0,1]$ and $c$ is monotonically increasing in $r$. Define a weighted evidence integration score (orthology confidence score) $S$ for each candidate pair as follows, using fixed nonnegative weights $w_s$, $w_y$, and $w_c$ that sum to $1$:\n1. If $s = 0$ or $y = 0$ or $c = 0$, then $S = 0$.\n2. Otherwise,\n$$\nS \\;=\\; \\dfrac{w_s + w_y + w_c}{\\dfrac{w_s}{s} + \\dfrac{w_y}{y} + \\dfrac{w_c}{c}}.\n$$\nUse the weights $w_s = 0.5$, $w_y = 0.3$, and $w_c = 0.2$. Your task is to compute $S$ for each of the following test cases, where each case is a triple $(s,y,r)$:\n- Case $1$: $(0.9, 0.7, 0.6)$\n- Case $2$: $(1.0, 1.0, 1.0)$\n- Case $3$: $(0.0, 1.0, 1.0)$\n- Case $4$: $(1.0, 0.0, 0.2)$\n- Case $5$: $(0.5, 0.5, 0.0)$\n- Case $6$: $(0.8, 0.2, -1.0)$\n- Case $7$: $(0.95, 0.85, -0.2)$\nYour program must output a single line containing a list of the $7$ values of $S$ in the same order as the cases above, rounded to exactly $6$ digits after the decimal point. The required format is a single line with a comma-separated list enclosed in square brackets, for example $[x_1,x_2,\\dots,x_7]$, where each $x_i$ is the rounded value of $S$ for case $i$.", "solution": "The problem has been subjected to rigorous validation and is found to be valid. It is scientifically grounded, well-posed, and objective. It presents a clear, formalizable task within the domain of computational biology and bioinformatics. All necessary parameters and definitions are provided, and there are no contradictions or ambiguities.\n\nThe problem requires the computation of a weighted evidence integration score, $S$, for identifying orthologous gene pairs. This score is based on three independent sources of evidence: sequence similarity $s$, synteny conservation $y$, and co-expression correlation $r$.\n\nFirst, the co-expression correlation $r \\in [-1, 1]$ is transformed into a non-negative score $c \\in [0, 1]$ via the linear mapping:\n$$\nc = \\dfrac{r + 1}{2}\n$$\nThis transformation ensures that all three evidence scores, $s$, $y$, and $c$, lie within the same range $[0, 1]$ and are monotonically increasing with the strength of the evidence.\n\nThe confidence score $S$ is defined as the weighted harmonic mean of these three scores. The weights are given as $w_s = 0.5$, $w_y = 0.3$, and $w_c = 0.2$. Note that the weights are non-negative and sum to $1$: $w_s + w_y + w_c = 0.5 + 0.3 + 0.2 = 1.0$.\n\nThe computation of $S$ follows a two-part rule:\n1.  A strict veto condition: if any evidence score is zero, the combined score is also zero. That is, if $s = 0$ or $y = 0$ or $c = 0$, then $S = 0$. This reflects the principle that a complete lack of evidence from any one critical source is sufficient to disqualify a candidate pair.\n2.  For all other cases where $s > 0$, $y > 0$, and $c > 0$, the score $S$ is calculated using the formula for the weighted harmonic mean:\n    $$\n    S = \\dfrac{w_s + w_y + w_c}{\\dfrac{w_s}{s} + \\dfrac{w_y}{y} + \\dfrac{w_c}{c}}\n    $$\n    Since the weights sum to $1$, this expression simplifies to:\n    $$\n    S = \\left(\\dfrac{w_s}{s} + \\dfrac{w_y}{y} + \\dfrac{w_c}{c}\\right)^{-1}\n    $$\n    The harmonic mean is appropriate here as it is sensitive to the smallest values, ensuring that a low score in any one dimension strongly penalizes the overall confidence score.\n\nWe now proceed to calculate $S$ for each of the seven test cases provided.\n\nCase 1: $(s, y, r) = (0.9, 0.7, 0.6)$\nFirst, calculate $c$: $c = \\dfrac{0.6 + 1}{2} = 0.8$.\nSince $s, y, c$ are all non-zero, we apply the harmonic mean formula:\n$$\nS_1 = \\left(\\dfrac{0.5}{0.9} + \\dfrac{0.3}{0.7} + \\dfrac{0.2}{0.8}\\right)^{-1} = \\left(0.555555... + 0.428571... + 0.25\\right)^{-1} = \\left(1.23412698...\\right)^{-1} \\approx 0.81029255\n$$\nRounded to $6$ decimal places, $S_1 = 0.810293$.\n\nCase 2: $(s, y, r) = (1.0, 1.0, 1.0)$\nCalculate $c$: $c = \\dfrac{1.0 + 1}{2} = 1.0$.\nAll scores are maximal.\n$$\nS_2 = \\left(\\dfrac{0.5}{1.0} + \\dfrac{0.3}{1.0} + \\dfrac{0.2}{1.0}\\right)^{-1} = \\left(0.5 + 0.3 + 0.2\\right)^{-1} = \\left(1.0\\right)^{-1} = 1.0\n$$\nRounded to $6$ decimal places, $S_2 = 1.000000$.\n\nCase 3: $(s, y, r) = (0.0, 1.0, 1.0)$\nHere, $s = 0$. According to the veto condition, the score is immediately set to zero.\n$$\nS_3 = 0\n$$\nRounded to $6$ decimal places, $S_3 = 0.000000$.\n\nCase 4: $(s, y, r) = (1.0, 0.0, 0.2)$\nHere, $y = 0$. The veto condition applies.\n$$\nS_4 = 0\n$$\nRounded to $6$ decimal places, $S_4 = 0.000000$.\n\nCase 5: $(s, y, r) = (0.5, 0.5, 0.0)$\nCalculate $c$: $c = \\dfrac{0.0 + 1}{2} = 0.5$.\nSince $s, y, c$ are all non-zero:\n$$\nS_5 = \\left(\\dfrac{0.5}{0.5} + \\dfrac{0.3}{0.5} + \\dfrac{0.2}{0.5}\\right)^{-1} = \\left(1.0 + 0.6 + 0.4\\right)^{-1} = \\left(2.0\\right)^{-1} = 0.5\n$$\nRounded to $6$ decimal places, $S_5 = 0.500000$.\n\nCase 6: $(s, y, r) = (0.8, 0.2, -1.0)$\nCalculate $c$: $c = \\dfrac{-1.0 + 1}{2} = 0.0$.\nHere, $c = 0$. The veto condition applies.\n$$\nS_6 = 0\n$$\nRounded to $6$ decimal places, $S_6 = 0.000000$.\n\nCase 7: $(s, y, r) = (0.95, 0.85, -0.2)$\nCalculate $c$: $c = \\dfrac{-0.2 + 1}{2} = \\dfrac{0.8}{2} = 0.4$.\nSince $s, y, c$ are all non-zero:\n$$\nS_7 = \\left(\\dfrac{0.5}{0.95} + \\dfrac{0.3}{0.85} + \\dfrac{0.2}{0.4}\\right)^{-1} = \\left(0.5263157... + 0.3529411... + 0.5\\right)^{-1} = \\left(1.3792569...\\right)^{-1} \\approx 0.72502693\n$$\nRounded to $6$ decimal places, $S_7 = 0.725027$.\n\nThe final results are compiled into a list as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the weighted evidence integration score (S) for several candidate\n    gene pairs based on sequence similarity (s), synteny conservation (y),\n    and co-expression correlation (r).\n    \"\"\"\n\n    # Define the weights for the evidence scores.\n    # ws: weight for sequence similarity\n    # wy: weight for synteny conservation\n    # wc: weight for co-expression correlation\n    ws = 0.5\n    wy = 0.3\n    wc = 0.2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (s, y, r).\n    test_cases = [\n        (0.9, 0.7, 0.6),   # Case 1\n        (1.0, 1.0, 1.0),   # Case 2\n        (0.0, 1.0, 1.0),   # Case 3\n        (1.0, 0.0, 0.2),   # Case 4\n        (0.5, 0.5, 0.0),   # Case 5\n        (0.8, 0.2, -1.0),  # Case 6\n        (0.95, 0.85, -0.2) # Case 7\n    ]\n\n    results = []\n    for case in test_cases:\n        s, y, r = case\n\n        # Transform the Pearson correlation r from [-1, 1] to a score c in [0, 1].\n        c = (r + 1.0) / 2.0\n\n        # Rule 1: If any evidence score is 0, the total score S is 0.\n        # This handles division-by-zero for the harmonic mean and enforces a\n        # strict veto on any candidate pair lacking one type of evidence.\n        if s == 0.0 or y == 0.0 or c == 0.0:\n            S = 0.0\n        else:\n            # Rule 2: Otherwise, calculate S as the weighted harmonic mean.\n            # Since the weights sum to 1, S = 1 / (ws/s + wy/y + wc/c).\n            weighted_inverse_sum = (ws / s) + (wy / y) + (wc / c)\n            S = 1.0 / weighted_inverse_sum\n        \n        # Format the result to exactly 6 decimal places.\n        results.append(f\"{S:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2405931"}]}