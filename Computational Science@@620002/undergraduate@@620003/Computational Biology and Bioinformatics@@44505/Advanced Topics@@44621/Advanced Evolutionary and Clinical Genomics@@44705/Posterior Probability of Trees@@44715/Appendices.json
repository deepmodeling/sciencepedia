{"hands_on_practices": [{"introduction": "Before delving into complex simulations, it's crucial to grasp the fundamental probabilistic landscape of phylogenetic inference. The posterior probability of any single tree topology, even the one with the highest probability, can often be surprisingly low because of the vast number of possible trees. This exercise [@problem_id:2415485] uses the basic complement rule of probability to illuminate a vital concept: the evidence for one hypothesis is intrinsically linked to the collective evidence for all competing hypotheses. Understanding this relationship helps interpret the posterior probability of a single topology, $p$, in the broader context of the entire space of possible evolutionary histories.", "problem": "In Bayesian phylogenetic inference for a fixed set of taxa under a specified substitution model and prior, the posterior distribution over unrooted bifurcating tree topologies is a probability mass function on a finite set of topologies. Let $T^{\\star}$ denote a particular topology and let $p \\in (0,1)$ denote its posterior probability, that is, $p = \\Pr(T^{\\star} \\mid D)$ where $D$ denotes the observed sequence alignment and all continuous parameters (such as branch lengths and substitution rates) have been marginalized out. Define $U$ to be the set containing all other distinct unrooted bifurcating topologies on the same taxa, so that $U$ is the complement of $\\{T^{\\star}\\}$ within the set of all considered topologies.\n\nCompute the posterior probability $\\Pr(U \\mid D)$ as a closed-form expression in terms of $p$. Then, interpret this quantity in the context of testing the point hypothesis $H_{0}\\!:\\;T=T^{\\star}$ against the composite alternative $H_{1}\\!:\\;T \\in U$ in a Bayesian decision framework with zeroâ€“one loss. Provide only the expression for $\\Pr(U \\mid D)$ as your final answer. No rounding is required.", "solution": "The problem statement is submitted to validation.\n\nStep 1: Extract Givens.\n- The set of taxa is fixed.\n- The substitution model is specified.\n- The prior distribution is specified.\n- The posterior distribution over unrooted bifurcating tree topologies is a probability mass function.\n- $T^{\\star}$ denotes a particular topology.\n- $p \\in (0,1)$ is the posterior probability of $T^{\\star}$, given by $p = \\Pr(T^{\\star} \\mid D)$.\n- $D$ is the observed sequence alignment.\n- All continuous parameters have been marginalized out.\n- $U$ is the set containing all other distinct unrooted bifurcating topologies on the same taxa, such that $U$ is the complement of $\\{T^{\\star}\\}$ within the set of all considered topologies.\n- The task is to compute the posterior probability $\\Pr(U \\mid D)$ as a closed-form expression in terms of $p$.\n- A secondary task, not for the final answer, is to interpret this quantity in the context of a specific Bayesian hypothesis test.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded. It describes a standard scenario in Bayesian phylogenetic inference, a core area of computational biology. All concepts, including posterior probability, tree topologies, marginalization, and the definition of a complement set, are standard and well-defined in statistics and phylogenetics.\n\nThe problem is well-posed. The sample space is the finite set of all possible unrooted bifurcating topologies for a given number of taxa. Let this set be denoted by $\\mathcal{T}$. The problem defines two events: the true topology being $T^{\\star}$ and the true topology being in the set $U$. By definition, $U = \\mathcal{T} \\setminus \\{T^{\\star}\\}$. Thus, the sets $\\{T^{\\star}\\}$ and $U$ form a partition of the sample space $\\mathcal{T}$. The problem provides the probability of one event, $p = \\Pr(T^{\\star} \\mid D)$, and asks for the probability of its complement, $\\Pr(U \\mid D)$. The solution is uniquely determined by the axioms of probability.\n\nThe problem is objective and uses precise terminology. It is free of ambiguity, subjective claims, or factual inaccuracies.\n\nVerdict: The problem is valid. It is a straightforward application of fundamental probability theory within a well-defined scientific context.\n\nProceeding to solution.\n\nLet $\\mathcal{T}$ be the sample space of all possible unrooted bifurcating tree topologies for the given set of taxa. The posterior distribution, conditioned on the data $D$, is a probability mass function over this discrete, finite sample space. The sum of posterior probabilities over all possible topologies must equal $1$.\n$$\n\\sum_{T \\in \\mathcal{T}} \\Pr(T \\mid D) = 1\n$$\nThe problem defines the set $U$ as the complement of the singleton set $\\{T^{\\star}\\}$ within $\\mathcal{T}$. This means that the set of all topologies $\\mathcal{T}$ can be partitioned into two disjoint subsets: $\\{T^{\\star}\\}$ and $U$.\n$$\n\\mathcal{T} = \\{T^{\\star}\\} \\cup U \\quad \\text{and} \\quad \\{T^{\\star}\\} \\cap U = \\emptyset\n$$\nBy the sum rule for probabilities of disjoint events, the probability of the union is the sum of the probabilities.\n$$\n\\Pr(\\mathcal{T} \\mid D) = \\Pr(\\{T^{\\star}\\} \\cup U \\mid D) = \\Pr(T^{\\star} \\mid D) + \\Pr(U \\mid D)\n$$\nSince $\\mathcal{T}$ represents the entire sample space, its total probability is $1$.\n$$\n\\Pr(\\mathcal{T} \\mid D) = 1\n$$\nTherefore, we have the following equality:\n$$\n\\Pr(T^{\\star} \\mid D) + \\Pr(U \\mid D) = 1\n$$\nThe problem states that the posterior probability of the specific topology $T^{\\star}$ is $p$.\n$$\n\\Pr(T^{\\star} \\mid D) = p\n$$\nSubstituting this into the equation yields:\n$$\np + \\Pr(U \\mid D) = 1\n$$\nSolving for the desired quantity, $\\Pr(U \\mid D)$, we obtain the expression:\n$$\n\\Pr(U \\mid D) = 1 - p\n$$\nThis is the posterior probability that the true topology is one of the topologies *other than* $T^{\\star}$.\n\nFor the interpretation part of the problem, consider the hypothesis test with the null hypothesis $H_{0}\\!:\\;T=T^{\\star}$ and the composite alternative hypothesis $H_{1}\\!:\\;T \\in U$. In the Bayesian framework, we compare the posterior probabilities of these hypotheses.\nThe posterior probability of the null hypothesis is:\n$$\n\\Pr(H_{0} \\mid D) = \\Pr(T=T^{\\star} \\mid D) = p\n$$\nThe posterior probability of the alternative hypothesis is:\n$$\n\\Pr(H_{1} \\mid D) = \\Pr(T \\in U \\mid D) = \\Pr(U \\mid D) = 1 - p\n$$\nThe quantity $\\Pr(U \\mid D) = 1 - p$ is therefore the posterior probability of the alternative hypothesis $H_{1}$. In a Bayesian decision framework with a zero-one loss function, one would choose the hypothesis with the greater posterior probability. Thus, one would reject $H_0$ in favor of $H_1$ if $1 - p > p$, which simplifies to $p < 0.5$. The expression $1 - p$ represents the total weight of evidence, given the data $D$, against the specific point hypothesis $H_0$ and in favor of the collection of all other possible topologies.\nThe problem, however, only requests the expression for $\\Pr(U \\mid D)$ as the final answer.", "answer": "$$\\boxed{1 - p}$$", "id": "2415485"}, {"introduction": "In modern Bayesian phylogenetics, we rarely compute posterior probabilities analytically. Instead, we approximate the posterior distribution by generating a large sample of plausible trees using methods like Markov chain Monte Carlo (MCMC). This practice [@problem_id:2415452] develops a core, hands-on skill: estimating the posterior probability of a specific grouping of taxa, known as a clade. By calculating the frequency of a clade's appearance within a properly processed posterior sample, we obtain a robust and intuitive estimate of our confidence in that particular evolutionary relationship, a value commonly reported in phylogenetic studies.", "problem": "A Bayesian phylogenetic analysis of a molecular sequence alignment produced a Markov chain Monte Carlo (MCMC) posterior sample of $10{,}000$ rooted trees under a specified substitution model and prior. The Maximum A Posteriori (MAP) tree is the single tree $T^{\\ast}$ in the sample with the highest posterior probability among sampled states. Consider a particular monophyletic group $C$ defined by a fixed set of taxa. This group $C$ is not present in the MAP tree $T^{\\ast}$. The MCMC was diagnosed to have reached stationarity after iteration $2{,}000$, and the first $2{,}000$ trees were discarded as burn-in. To reduce autocorrelation, every $5$th tree was retained from the remaining $8{,}000$ trees, yielding a posterior sample of $1{,}600$ trees. In this retained sample, the group $C$ occurs in exactly $482$ trees. Using only this retained posterior sample, compute the posterior probability $\\Pr(C \\mid D)$ of the monophyletic group $C$ given the data $D$. Express your answer as a decimal and round your answer to $4$ significant figures.", "solution": "The problem requires the computation of the posterior probability of a monophyletic group, or clade, denoted as $C$, given a set of molecular sequence data, $D$. This quantity is represented as $\\Pr(C \\mid D)$.\n\nIn the framework of Bayesian phylogenetics, the central object of inference is the posterior probability distribution of phylogenetic trees, $\\Pr(T \\mid D)$, where $T$ represents a tree topology along with its associated branch lengths. This distribution is obtained via Bayes' theorem:\n$$\n\\Pr(T \\mid D) = \\frac{\\Pr(D \\mid T) \\Pr(T)}{\\Pr(D)}\n$$\nwhere $\\Pr(D \\mid T)$ is the likelihood of the data given the tree, $\\Pr(T)$ is the prior probability on trees, and $\\Pr(D)$ is the marginal likelihood, a normalizing constant.\n\nThe posterior probability of a specific feature of the tree, such as the clade $C$, is defined as the sum of the posterior probabilities of all trees that contain this feature. This corresponds to marginalizing over the posterior distribution. If we let $I(C \\in T)$ be an indicator function that equals $1$ if tree $T$ contains clade $C$ and $0$ otherwise, the posterior probability of $C$ is given by the expectation of this indicator function over the posterior distribution:\n$$\n\\Pr(C \\mid D) = \\int I(C \\in T) \\Pr(T \\mid D) \\, dT\n$$\nThis integral over the vast space of all possible trees is computationally intractable to solve analytically. Therefore, it is approximated using a set of samples drawn from the posterior distribution $\\Pr(T \\mid D)$ via a Markov chain Monte Carlo (MCMC) algorithm.\n\nThe Ergodic theorem for Markov chains states that for a sufficiently long chain, the frequency of a state in the sampled sequence converges to the true probability of that state in the stationary distribution. Thus, the posterior probability of clade $C$ can be estimated as the proportion of trees in the MCMC sample that contain $C$.\n\nThe problem provides the following details about the MCMC simulation:\n- The initial MCMC run produced a sample of $10{,}000$ trees.\n- The first $2{,}000$ trees were discarded as burn-in. This is a standard procedure to ensure that the samples are drawn from the stationary distribution of the Markov chain.\n- The number of trees remaining after burn-in is $10{,}000 - 2{,}000 = 8{,}000$.\n- The chain was thinned by retaining every $5$th tree to reduce autocorrelation between successive samples.\n- The final, effective posterior sample consists of $N = \\frac{8{,}000}{5} = 1{,}600$ trees.\n\nThe problem states that within this final sample of $1{,}600$ trees, the clade $C$ is present in exactly $N_C = 482$ trees.\n\nThe estimate for the posterior probability of clade $C$ is the frequency of its occurrence in this final sample:\n$$\n\\Pr(C \\mid D) \\approx \\frac{N_C}{N} = \\frac{482}{1{,}600}\n$$\nThe information that clade $C$ is not present in the Maximum A Posteriori (MAP) tree, $T^{\\ast}$, is irrelevant for this calculation. The MAP tree is the single point estimate corresponding to the mode of the posterior distribution. The posterior probability of a clade, however, is a marginal probability that represents the total probability mass of all trees containing that clade. It is a common occurrence in phylogenetic inference for a clade to have a significant posterior probability (e.g., greater than $0.5$) yet be absent from the MAP tree, especially when the posterior distribution is diffuse across multiple conflicting topologies with similar probabilities.\n\nPerforming the calculation:\n$$\n\\frac{482}{1{,}600} = 0.30125\n$$\nThe problem requires the answer to be expressed as a decimal rounded to $4$ significant figures. The first four significant figures are $3$, $0$, $1$, and $2$. The fifth digit is $5$, so we round up the fourth digit. This yields:\n$$\n\\Pr(C \\mid D) \\approx 0.3013\n$$", "answer": "$$\\boxed{0.3013}$$", "id": "2415452"}, {"introduction": "While the posterior probability of a specific clade tells us about our confidence in one part of the tree, we often need a way to quantify the overall uncertainty in our phylogenetic estimate. Is the data strongly pointing to one topology, or is it spread thinly across many competing possibilities? This practice [@problem_id:2415418] introduces Shannon entropy, a powerful concept from information theory, as a method to summarize the entire posterior distribution over topologies into a single, elegant number. Calculating the entropy provides a global measure of phylogenetic uncertainty, allowing for a more holistic understanding of the evolutionary signal within our data.", "problem": "A Bayesian phylogenetic analysis was performed on four taxa, yielding a posterior distribution over the three possible unrooted, fully resolved tree topologies, denoted by $T_{1}$, $T_{2}$, and $T_{3}$. After integrating over branch lengths and substitution model parameters, the marginal posterior probabilities for the topologies are:\n$p(T_{1}) = 0.60$, $p(T_{2}) = 0.25$, and $p(T_{3}) = 0.15$.\nTreat this as a discrete posterior distribution over tree topologies. Compute the Shannon entropy $H$ of this distribution using the natural logarithm, that is, measured in nats. Report your final result as a pure number (dimensionless) rounded to $4$ significant figures.", "solution": "The problem requires the computation of the Shannon entropy for a given discrete probability distribution. The distribution describes the posterior probabilities of three distinct unrooted phylogenetic tree topologies, denoted as $T_{1}$, $T_{2}$, and $T_{3}$. The given probabilities are $p(T_{1}) = 0.60$, $p(T_{2}) = 0.25$, and $p(T_{3}) = 0.15$. These probabilities sum to $0.60 + 0.25 + 0.15 = 1.00$, which confirms it is a valid probability mass function.\n\nThe Shannon entropy, $H$, of a discrete random variable with a set of possible outcomes $\\{x_1, x_2, \\dots, x_n\\}$ and associated probabilities $p(x_i)$ is defined by the formula:\n$$ H = - \\sum_{i=1}^{n} p(x_i) \\log_{b} p(x_i) $$\nIn this problem, the entropy is to be measured in nats, which implies the use of the natural logarithm (base $e$). Therefore, the formula becomes:\n$$ H = - \\sum_{i=1}^{n} p(x_i) \\ln(p(x_i)) $$\n\nFor the given set of three topologies and their posterior probabilities, the entropy is calculated as follows:\n$$ H = - \\left[ p(T_{1})\\ln(p(T_{1})) + p(T_{2})\\ln(p(T_{2})) + p(T_{3})\\ln(p(T_{3})) \\right] $$\nSubstituting the numerical values for the probabilities:\n$$ H = - \\left[ 0.60 \\ln(0.60) + 0.25 \\ln(0.25) + 0.15 \\ln(0.15) \\right] $$\nWe proceed to evaluate the expression.\nThe individual terms within the bracket are:\n$$ 0.60 \\ln(0.60) \\approx 0.60 \\times (-0.5108256) \\approx -0.30649536 $$\n$$ 0.25 \\ln(0.25) \\approx 0.25 \\times (-1.3862944) \\approx -0.34657360 $$\n$$ 0.15 \\ln(0.15) \\approx 0.15 \\times (-1.8971200) \\approx -0.28456800 $$\nSumming these values gives the total sum inside the brackets:\n$$ \\sum_{i=1}^{3} p(T_{i}) \\ln(p(T_{i})) \\approx -0.30649536 - 0.34657360 - 0.28456800 \\approx -0.93763696 $$\nThe entropy $H$ is the negative of this sum:\n$$ H = -(-0.93763696) \\approx 0.93763696 $$\nThe problem requires the final answer to be reported as a pure number rounded to $4$ significant figures. The first four significant figures are $9, 3, 7, 6$. The fifth significant figure is $3$, which is less than $5$, so we do not round up the last digit.\nTherefore, the entropy rounded to $4$ significant figures is $0.9376$.", "answer": "$$\\boxed{0.9376}$$", "id": "2415418"}]}