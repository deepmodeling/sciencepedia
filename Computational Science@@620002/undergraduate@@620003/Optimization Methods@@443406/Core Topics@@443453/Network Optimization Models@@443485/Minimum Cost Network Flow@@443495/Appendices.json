{"hands_on_practices": [{"introduction": "Moving from theory to practice, our first exercise builds fundamental intuition for what makes a flow \"optimal.\" It might seem that sending flow along the most direct route is always best, but this problem challenges that assumption by introducing the crucial interplay between per-unit costs and path capacities. By working through this scenario [@problem_id:3151104], you will learn to evaluate the entire network, comparing alternative paths to find a routing strategy that minimizes total cost, which is the core task of any minimum cost flow problem.", "problem": "Consider a directed network flow problem with one source node and one sink node. Let node $1$ have supply $10$, node $4$ have demand $10$, and nodes $2$ and $3$ be transshipment nodes with zero net supply. All arcs have nonnegative unit costs $c_{ij} \\ge 0$ and finite capacities. The minimum cost network flow problem seeks flows $x_{ij} \\ge 0$ on each arc $(i,j)$ to satisfy flow conservation at all nodes, respect arc capacities, and minimize the total cost $\\sum_{(i,j)} c_{ij} x_{ij}$. The arcs, with their capacities and unit costs, are:\n- Arc $(1,4)$ has capacity $10$ and unit cost $5$.\n- Arc $(1,2)$ has capacity $6$ and unit cost $2$.\n- Arc $(2,4)$ has capacity $6$ and unit cost $2$.\n- Arc $(1,3)$ has capacity $4$ and unit cost $1$.\n- Arc $(3,4)$ has capacity $4$ and unit cost $3$.\n\nNo other arcs exist. Using only the fundamental definitions of flow conservation, capacity feasibility, and total cost minimization, determine which of the following statements correctly characterizes an optimal flow routing from node $1$ to node $4$ under these data.\n\nA. Send $10$ units directly on arc $(1,4)$.\n\nB. Send $2$ units on arc $(1,4)$, $6$ units along the path $(1,2,4)$, and $2$ units along the path $(1,3,4)$.\n\nC. Send $0$ units on arc $(1,4)$ and route $6$ units along the path $(1,2,4)$ and $4$ units along the path $(1,3,4)$.\n\nD. It is optimal to send all $10$ units through node $3$, i.e., $10$ units along $(1,3,4)$, with no flow on $(1,4)$ or $(1,2)$ and $(2,4)$.", "solution": "The user wants me to solve a minimum cost network flow problem.\n\nHere's my plan:\n1.  **Validate the problem statement**:\n    *   **Step 1: Extract Givens**: I'll list all the nodes, their supplies/demands, the arcs with their capacities and costs.\n    *   **Step 2: Validate**: I will check if the problem is scientifically grounded, well-posed, objective, and complete. It's a standard optimization problem, so it should be valid. The network is clearly defined.\n        *   Nodes: $1, 2, 3, 4$.\n        *   Source node: $1$ with supply $b_1 = 10$.\n        *   Sink node: $4$ with demand $10$, which means supply $b_4 = -10$.\n        *   Transshipment nodes: $2, 3$ with supply $b_2 = 0, b_3 = 0$.\n        *   Total supply = $10$. Total demand = $10$. The problem is balanced.\n        *   Objective: Minimize total cost $\\sum_{(i,j)} c_{ij} x_{ij}$.\n        *   Constraints:\n            *   Flow conservation: $\\sum_{j} x_{ji} - \\sum_{j} x_{ij} = b_i$ for each node $i$.\n            *   Capacity constraints: $0 \\le x_{ij} \\le u_{ij}$ for each arc $(i,j)$.\n        *   Arc data:\n            *   Arc $(1,4)$: $u_{14} = 10$, $c_{14} = 5$.\n            *   Arc $(1,2)$: $u_{12} = 6$, $c_{12} = 2$.\n            *   Arc $(2,4)$: $u_{24} = 6$, $c_{24} = 2$.\n            *   Arc $(1,3)$: $u_{13} = 4$, $c_{13} = 1$.\n            *   Arc $(3,4)$: $u_{34} = 4$, $c_{34} = 3$.\n        *   The problem is a well-defined minimum cost network flow problem. It is scientifically sound (within the domain of optimization), well-posed (a solution exists because feasible flows exist and costs are non-negative), objective, and complete. The validation verdict will be \"Valid\".\n\n2.  **Solve the problem**:\n    *   The goal is to find a flow of $10$ units from node $1$ to node $4$ with minimum cost.\n    *   I need to identify the possible paths from the source (1) to the sink (4).\n        *   Path 1: $1 \\to 4$. Cost per unit = $c_{14} = 5$. Capacity = $u_{14} = 10$.\n        *   Path 2: $1 \\to 2 \\to 4$. Cost per unit = $c_{12} + c_{24} = 2 + 2 = 4$. Capacity = $\\min(u_{12}, u_{24}) = \\min(6, 6) = 6$.\n        *   Path 3: $1 \\to 3 \\to 4$. Cost per unit = $c_{13} + c_{34} = 1 + 3 = 4$. Capacity = $\\min(u_{13}, u_{34}) = \\min(4, 4) = 4$.\n    *   I need to send a total of $10$ units. I should use the cheapest paths first.\n    *   Path 2 ($1 \\to 2 \\to 4$) has a cost of $4$.\n    *   Path 3 ($1 \\to 3 \\to 4$) has a cost of $4$.\n    *   Path 1 ($1 \\to 4$) has a cost of $5$.\n    *   The two cheapest paths are Path 2 and Path 3, both with a unit cost of $4$. The most expensive path is Path 1 with a unit cost of $5$.\n    *   To minimize cost, I should send as much flow as possible along the cheapest paths.\n    *   Let's send flow along Path 3 ($1 \\to 3 \\to 4$). Its capacity is $4$. Sending $4$ units along this path costs $4 \\times 4 = 16$.\n    *   Let's send flow along Path 2 ($1 \\to 2 \\to 4$). Its capacity is $6$. Sending $6$ units along this path costs $6 \\times 4 = 24$.\n    *   So far, I have sent $4 + 6 = 10$ units. The demand is met.\n    *   The total cost for this flow is $16 + 24 = 40$.\n    *   The flow assignment is:\n        *   $x_{13} = 4$\n        *   $x_{34} = 4$\n        *   $x_{12} = 6$\n        *   $x_{24} = 6$\n        *   $x_{14} = 0$\n    *   This flow is feasible:\n        *   Capacity constraints:\n            *   $x_{14}=0 \\le u_{14}=10$ (OK)\n            *   $x_{12}=6 \\le u_{12}=6$ (OK)\n            *   $x_{24}=6 \\le u_{24}=6$ (OK)\n            *   $x_{13}=4 \\le u_{13}=4$ (OK)\n            *   $x_{34}=4 \\le u_{34}=4$ (OK)\n        *   Flow conservation constraints:\n            *   Node 1 (source): Outflow = $x_{14} + x_{12} + x_{13} = 0 + 6 + 4 = 10$. Inflow = $0$. Net outflow = $10$. (Correct, matches supply)\n            *   Node 2 (transshipment): Inflow = $x_{12} = 6$. Outflow = $x_{24} = 6$. Net outflow = $0$. (Correct)\n            *   Node 3 (transshipment): Inflow = $x_{13} = 4$. Outflow = $x_{34} = 4$. Net outflow = $0$. (Correct)\n            *   Node 4 (sink): Inflow = $x_{14} + x_{24} + x_{34} = 0 + 6 + 4 = 10$. Outflow = $0$. Net outflow = $-10$. (Correct, matches demand)\n    *   This flow is feasible. Is it optimal?\n    *   This is a greedy approach based on path costs. It's often called the \"successive shortest path algorithm\" if there are no negative costs (which is the case here). We augment flow along the cheapest available path until the total demand is met.\n    *   The paths identified are:\n        *   $p_1 = (1,3,4)$ with cost $c(p_1)=4$ and capacity $u(p_1)=4$.\n        *   $p_2 = (1,2,4)$ with cost $c(p_2)=4$ and capacity $u(p_2)=6$.\n        *   $p_3 = (1,4)$ with cost $c(p_3)=5$ and capacity $u(p_3)=10$.\n    *   The algorithm proceeds as follows:\n        1. Find the cheapest path. Paths $p_1$ and $p_2$ are tied with cost $4$. Let's pick $p_1$.\n        2. Send as much flow as possible along $p_1$: $\\min(\\text{demand}, u(p_1)) = \\min(10, 4) = 4$ units.\n        3. Update residual capacities and remaining demand. Remaining demand is $10-4=6$. The capacities on arcs $(1,3)$ and $(3,4)$ are now $0$.\n        4. Find the cheapest path in the residual graph. Path $p_1$ is no longer available. The next cheapest path is $p_2$ with cost $4$.\n        5. Send as much flow as possible along $p_2$: $\\min(\\text{demand}, u(p_2)) = \\min(6, 6) = 6$ units.\n        6. Update residual capacities and remaining demand. Remaining demand is $6-6=0$. The capacities on arcs $(1,2)$ and $(2,4)$ are now $0$.\n        7. The demand is met. The total flow sent is $4+6=10$.\n    *   The resulting flow is $x_{13}=4$, $x_{34}=4$, $x_{12}=6$, $x_{24}=6$, $x_{14}=0$.\n    *   Total cost = $(4 \\times c_{13}) + (4 \\times c_{34}) + (6 \\times c_{12}) + (6 \\times c_{24}) = (4 \\times 1) + (4 \\times 3) + (6 \\times 2) + (6 \\times 2) = 4 + 12 + 12 + 12 = 40$.\n    *   This confirms my initial calculation.\n\n3.  **Evaluate the options**:\n    *   **Option A**: \"Send $10$ units directly on arc $(1,4)$.\"\n        *   This corresponds to flow $x_{14} = 10$, and all other flows are $0$.\n        *   Is this flow feasible? $x_{14} = 10 \\le u_{14} = 10$. Yes. Flow conservation is met. It's a valid flow.\n        *   What is the cost? Cost = $10 \\times c_{14} = 10 \\times 5 = 50$.\n        *   Is this optimal? The cost is $50$. My calculated optimal cost is $40$. So, $50 > 40$. This is not an optimal flow.\n        *   Verdict: **Incorrect**.\n\n    *   **Option B**: \"Send $2$ units on arc $(1,4)$, $6$ units along the path $(1,2,4)$, and $2$ units along the path $(1,3,4)$.\"\n        *   This corresponds to flow assignment:\n            *   $x_{14} = 2$.\n            *   $x_{12} = 6$, $x_{24} = 6$.\n            *   $x_{13} = 2$, $x_{34} = 2$.\n        *   Let's check feasibility:\n            *   Total flow from source 1: $x_{14} + x_{12} + x_{13} = 2 + 6 + 2 = 10$. (Correct)\n            *   Total flow to sink 4: $x_{14} + x_{24} + x_{34} = 2 + 6 + 2 = 10$. (Correct)\n            *   Node 2: Inflow $x_{12} = 6$. Outflow $x_{24} = 6$. (Balanced)\n            *   Node 3: Inflow $x_{13} = 2$. Outflow $x_{34} = 2$. (Balanced)\n            *   Check capacities:\n                *   $x_{14} = 2 \\le u_{14} = 10$ (OK)\n                *   $x_{12} = 6 \\le u_{12} = 6$ (OK)\n                *   $x_{24} = 6 \\le u_{24} = 6$ (OK)\n                *   $x_{13} = 2 \\le u_{13} = 4$ (OK)\n                *   $x_{34} = 2 \\le u_{34} = 4$ (OK)\n            *   The flow is feasible.\n        *   Let's calculate the cost:\n            *   Cost = $(2 \\times c_{14}) + (6 \\times c_{12}) + (6 \\times c_{24}) + (2 \\times c_{13}) + (2 \\times c_{34})$\n            *   Cost = $(2 \\times 5) + (6 \\times 2) + (6 \\times 2) + (2 \\times 1) + (2 \\times 3)$\n            *   Cost = $10 + 12 + 12 + 2 + 6 = 42$.\n        *   Is this optimal? The cost is $42$. My calculated optimal cost is $40$. So, $42 > 40$. This is not an optimal flow.\n        *   Verdict: **Incorrect**.\n\n    *   **Option C**: \"Send $0$ units on arc $(1,4)$ and route $6$ units along the path $(1,2,4)$ and $4$ units along the path $(1,3,4)$.\"\n        *   This corresponds to the flow assignment:\n            *   $x_{14} = 0$.\n            *   $x_{12} = 6$, $x_{24} = 6$.\n            *   $x_{13} = 4$, $x_{34} = 4$.\n        *   This is exactly the flow I derived as optimal.\n        *   Let's re-verify everything for this option.\n        *   Feasibility:\n            *   Total flow from source 1: $x_{14} + x_{12} + x_{13} = 0 + 6 + 4 = 10$. (Correct)\n            *   Total flow to sink 4: $x_{14} + x_{24} + x_{34} = 0 + 6 + 4 = 10$. (Correct)\n            *   Node 2: Inflow $x_{12} = 6$. Outflow $x_{24} = 6$. (Balanced)\n            *   Node 3: Inflow $x_{13} = 4$. Outflow $x_{34} = 4$. (Balanced)\n            *   Capacities:\n                *   $x_{14} = 0 \\le u_{14} = 10$ (OK)\n                *   $x_{12} = 6 \\le u_{12} = 6$ (OK)\n                *   $x_{24} = 6 \\le u_{24} = 6$ (OK)\n                *   $x_{13} = 4 \\le u_{13} = 4$ (OK)\n                *   $x_{34} = 4 \\le u_{34} = 4$ (OK)\n            *   The flow is feasible.\n        *   Calculate the cost:\n            *   Cost = $(0 \\times c_{14}) + (6 \\times c_{12}) + (6 \\times c_{24}) + (4 \\times c_{13}) + (4 \\times c_{34})$\n            *   Cost = $(0 \\times 5) + (6 \\times 2) + (6 \\times 2) + (4 \\times 1) + (4 \\times 3)$\n            *   Cost = $0 + 12 + 12 + 4 + 12 = 40$.\n        *   Is this optimal? Yes, the cost is $40$, which is the minimum possible cost I calculated. Any other feasible flow will have a higher cost. For example, replacing one unit of flow from path $(1,2,4)$ or $(1,3,4)$ with one unit from path $(1,4)$ would increase the total cost by $5 - 4 = 1$. Since paths $(1,2,4)$ and $(1,3,4)$ are fully saturated, no more flow can be sent along them. So this must be the optimal solution.\n        *   Verdict: **Correct**.\n\n    *   **Option D**: \"It is optimal to send all $10$ units through node $3$, i.e., $10$ units along $(1,3,4)$, with no flow on $(1,4)$ or $(1,2)$ and $(2,4)$.\"\n        *   This corresponds to flow assignment:\n            *   $x_{13} = 10$, $x_{34} = 10$.\n            *   $x_{14} = 0, x_{12} = 0, x_{24} = 0$.\n        *   Is this flow feasible?\n            *   Check capacities:\n                *   $x_{13} = 10$. The capacity is $u_{13} = 4$. So $x_{13} > u_{13}$. The capacity of arc $(1,3)$ is violated.\n                *   $x_{34} = 10$. The capacity is $u_{34} = 4$. So $x_{34} > u_{34}$. The capacity of arc $(3,4)$ is violated.\n            *   The path $(1,3,4)$ has a capacity of $\\min(u_{13}, u_{34}) = \\min(4,4) = 4$. It is impossible to send $10$ units along this path.\n        *   This flow is not feasible. An infeasible flow cannot be optimal.\n        *   Verdict: **Incorrect**.\n\n4.  **Final check and formatting**:\n    *   The problem is valid.\n    *   The derivation of the optimal solution seems solid. I used the successive shortest path (greedy) method, which works for min-cost flow problems with non-negative costs.\n    *   The evaluation of each option appears correct.\n    *   Option A is feasible but not optimal.\n    *   Option B is feasible but not optimal.\n    *   Option C describes the optimal feasible flow.\n    *   Option D describes an infeasible flow.\n    *   The final answer is C.\n    *   I need to write this all out using LaTeX for all mathematical expressions. I will be careful with the LaTeX syntax. For example, variables like $c_{ij}$ and $x_{ij}$ must be in LaTeX. Numbers like $10$, $5$, $6$, $2$, $4$, $1$, $3$ must also be in LaTeX. Everything.", "answer": "$$\\boxed{C}$$", "id": "3151104"}, {"introduction": "With a solid intuition for optimal routing, we now turn to a formal, step-by-step method for finding the minimum cost flow: the successive shortest path algorithm. This powerful and intuitive algorithm operates on a simple greedy principle: repeatedly find the cheapest available path from source to sink in the residual network and send as much flow as possible. This exercise [@problem_id:3151081] guides you through this iterative process, demonstrating how a series of locally optimal choices culminates in a globally optimal solution for networks with non-negative costs.", "problem": "Consider the directed network $G=(V,E)$ with node set $V=\\{s,a,b,c,t\\}$ and arc set $E$ described by the following arc capacities and per-unit arc costs. For each arc $(i,j)\\in E$, let $u_{ij}$ denote its capacity and $c_{ij}$ denote its per-unit cost:\n- $(s,b)$ with $u_{sb}=1$ and $c_{sb}=0$,\n- $(b,t)$ with $u_{bt}=1$ and $c_{bt}=2$,\n- $(s,a)$ with $u_{sa}=2$ and $c_{sa}=1$,\n- $(a,b)$ with $u_{ab}=2$ and $c_{ab}=1$,\n- $(a,t)$ with $u_{at}=2$ and $c_{at}=4$,\n- $(b,c)$ with $u_{bc}=1$ and $c_{bc}=2$,\n- $(c,t)$ with $u_{ct}=2$ and $c_{ct}=1$,\n- $(s,c)$ with $u_{sc}=1$ and $c_{sc}=3$.\n\nA total of $k=3$ units of flow must be sent from node $s$ (source) to node $t$ (sink). Every arc has the given capacity and linear per-unit cost. There are no other supplies or demands; all intermediate nodes have net supply equal to $0$. All arc costs are nonnegative, and the network contains no negative-cost cycles.\n\nTask:\n1. Using the foundational definition of minimum-cost flow, compute the minimal total cost $C^{*}$ to send $k=3$ units of flow from $s$ to $t$ subject to flow conservation and arc capacities.\n2. Apply $k=3$ repetitions of the unit-augmentation version of the successive shortest path algorithm: at each repetition, in the current residual network, select an $s$-$t$ path of minimum total cost (with respect to current arc costs and residual capacities) and augment exactly $1$ unit of flow along that path; update the residual network and repeat. Compute the resulting total cost $C^{\\mathrm{SSP}}$ of the produced $3$-unit flow.\n3. Report the numerical difference $\\Delta=C^{\\mathrm{SSP}}-C^{*}$.\n\nExpress the final answer as a single real number. No rounding is necessary, and there are no physical units to report.", "solution": "The problem presented is a minimum cost flow problem, a canonical topic in the field of optimization methods. It requires sending a specified amount of flow from a source node to a sink node through a directed network with capacity and cost constraints on its arcs, such that the total cost is minimized. The problem is well-defined, providing all necessary parameters for a standard network flow formulation.\n\nThe problem asks for three computations:\n1. The minimal total cost $C^{*}$ to send $k=3$ units of flow from source $s$ to sink $t$.\n2. The total cost $C^{\\mathrm{SSP}}$ obtained by applying $k=3$ iterations of the unit-augmentation successive shortest path algorithm.\n3. The numerical difference $\\Delta = C^{\\mathrm{SSP}} - C^{*}$.\n\nThe successive shortest path algorithm is a standard, provably optimal algorithm for solving the minimum cost flow problem when all arc costs are non-negative, as is the case here. The algorithm iteratively finds the minimum-cost path in the residual network and pushes flow along it. The cost $C^{\\mathrm{SSP}}$ resulting from this algorithm is thus guaranteed to be the true minimum cost, $C^{*}$. Therefore, we can anticipate that $\\Delta = 0$. We will now demonstrate this by executing the algorithm.\n\nLet $x_{ij}$ be the flow on arc $(i,j)$, $u_{ij}$ be its capacity, and $c_{ij}$ be its per-unit cost. We need to send a total of $k=3$ units from $s$ to $t$.\n\n**Initial State:**\nThe initial flow is $x_{ij} = 0$ for all arcs $(i,j) \\in E$. The total flow sent is $v=0$ and the total cost is $C=0$. The initial residual network, $G_0$, is identical to the original network $G$.\n\n**Iteration 1: Augment 1 unit of flow**\nWe find the shortest path from $s$ to $t$ in the network $G_0$ based on the costs $c_{ij}$. We can use Dijkstra's algorithm or inspection for this small graph.\nThe potential $s-t$ paths and their costs are:\n- $P_A: s \\to b \\to t$. Cost: $c_{sb} + c_{bt} = 0 + 2 = 2$.\n- $P_B: s \\to b \\to c \\to t$. Cost: $c_{sb} + c_{bc} + c_{ct} = 0 + 2 + 1 = 3$.\n- $P_C: s \\to a \\to b \\to t$. Cost: $c_{sa} + c_{ab} + c_{bt} = 1 + 1 + 2 = 4$.\n- $P_D: s \\to c \\to t$. Cost: $c_{sc} + c_{ct} = 3 + 1 = 4$.\n- $P_E: s \\to a \\to t$. Cost: $c_{sa} + c_{at} = 1 + 4 = 5$.\n- $P_F: s \\to a \\to b \\to c \\to t$. Cost: $c_{sa} + c_{ab} + c_{bc} + c_{ct} = 1 + 1 + 2 + 1 = 5$.\n\nThe shortest path is $P_1 = s \\to b \\to t$ with a cost of $2$. The capacity of this path is $\\min(u_{sb}, u_{bt}) = \\min(1, 1) = 1$.\nWe augment $\\delta_1 = 1$ unit of flow along $P_1$.\n- Cost of this augmentation: $\\delta_1 \\times 2 = 1 \\times 2 = 2$.\n- Total flow: $v = 1$.\n- Cumulative cost: $C_1 = 2$.\n- Update flow variables: $x_{sb}=1$, $x_{bt}=1$.\n- Update residual network ($G_1$): The residual capacities of the forward arcs become $u^R_{sb} = 1-1=0$ and $u^R_{bt} = 1-1=0$. New backward arcs $(b,s)$ and $(t,b)$ are introduced with costs $c_{bs} = -c_{sb} = 0$ and $c_{tb} = -c_{bt} = -2$, and capacities equal to the flow, i.e., $1$.\n\n**Iteration 2: Augment 1 unit of flow**\nWe find the shortest path in the residual network $G_1$. The arcs $(s,b)$ and $(b,t)$ are saturated in the forward direction.\nThe available $s-t$ paths in $G_1$ and their costs are:\n- $P_D: s \\to c \\to t$. Cost: $c_{sc} + c_{ct} = 3 + 1 = 4$. Path capacity is $\\min(u_{sc}, u_{ct}) = \\min(1, 2)=1$.\n- $P_E: s \\to a \\to t$. Cost: $c_{sa} + c_{at} = 1 + 4 = 5$. Path capacity is $\\min(u_{sa}, u_{at}) = \\min(2, 2)=2$.\n- $P_F: s \\to a \\to b \\to c \\to t$. Cost: $c_{sa} + c_{ab} + c_{bc} + c_{ct} = 1+1+2+1=5$. Path capacity is $\\min(u_{sa}, u_{ab}, u_{bc}, u_{ct}) = \\min(2,2,1,2)=1$.\n(Note: Paths $P_B$ and $P_C$ are unavailable due to saturated arcs from Iteration 1).\nThe shortest path is $P_2 = s \\to c \\to t$ with a cost of $4$.\nWe augment $\\delta_2 = 1$ unit of flow along $P_2$.\n- Cost of this augmentation: $\\delta_2 \\times 4 = 1 \\times 4 = 4$.\n- Total flow: $v = 1 + 1 = 2$.\n- Cumulative cost: $C_2 = 2 + 4 = 6$.\n- Update flow variables: $x_{sc}=1$, $x_{ct}=1$.\n- Update residual network ($G_2$): $u^R_{sc} = 1-1=0$. $u^R_{ct}$ is reduced to $2-1=1$. Backward arcs $(c,s)$ and $(t,c)$ are introduced.\n\n**Iteration 3: Augment 1 unit of flow**\nWe find the shortest path in the residual network $G_2$. Now arcs $(s,b)$, $(b,t)$, and $(s,c)$ are saturated in the forward direction. Any path from $s$ must begin with the arc $(s,a)$.\nThe available paths starting with $(s,a)$ are:\n- $P_E: s \\to a \\to t$. Cost: $c_{sa} + c_{at} = 1 + 4 = 5$.\n- $P_F: s \\to a \\to b \\to c \\to t$. Cost: $c_{sa} + c_{ab} + c_{bc} + c_{ct} = 1+1+2+1=5$.\nBoth remaining path options have a cost of $5$. The algorithm may choose either one. Let's choose $P_3 = s \\to a \\to t$.\nWe augment $\\delta_3 = 1$ unit of flow along $P_3$.\n- Cost of this augmentation: $\\delta_3 \\times 5 = 1 \\times 5 = 5$.\n- Total flow: $v = 2 + 1 = 3$. This satisfies the requirement.\n- Cumulative cost: $C_3 = 6 + 5 = 11$.\n\nThe algorithm terminates as $k=3$ units of flow have been sent. The total cost is $C^{\\mathrm{SSP}} = 11$.\nThe final flow assignment is: $x_{sb}=1, x_{bt}=1, x_{sc}=1, x_{ct}=1, x_{sa}=1, x_{at}=1$, and all other flows are $0$. This flow is feasible and has a total cost of $1(2) + 1(4) + 1(5) = 11$.\n\n**Computation of $C^{*}$ and $\\Delta$**\nAccording to the fundamental theory of network flows, the successive shortest path algorithm correctly computes the minimum cost for a given amount of flow in a network with non-negative costs. Therefore, the cost $C^{\\mathrm{SSP}}$ obtained is the minimal possible cost.\n1. Minimal total cost: $C^{*} = C^{\\mathrm{SSP}} = 11$.\n2. Cost from the Successive Shortest Path algorithm: $C^{\\mathrm{SSP}} = 11$.\n3. The numerical difference $\\Delta$ is:\n$$\n\\Delta = C^{\\mathrm{SSP}} - C^{*} = 11 - 11 = 0\n$$\n\nThe final answer is the value of $\\Delta$.", "answer": "$$\\boxed{0}$$", "id": "3151081"}, {"introduction": "Our final practice delves into the deeper theoretical foundations that govern network flow optimality, connecting the primal flow problem to its dual representation. This advanced exercise [@problem_id:3151093] introduces the concepts of node potentials and reduced costs, which are essential for formally certifying whether a given flow is optimal. Furthermore, it explores the fascinating phenomenon of degeneracy, where the existence of a zero-cost cycle among tight arcs reveals the presence of multiple, distinct optimal solutions, all achieving the exact same minimum cost.", "problem": "Consider a directed network with node set $\\{s,a,b,t\\}$, where node $s$ is a source with supply $b_{s} = 10$, node $t$ is a sink with demand $b_{t} = -10$, and nodes $a$ and $b$ are transshipment nodes with $b_{a} = 0$ and $b_{b} = 0$. All arcs have lower bound $0$ and upper bound $+\\infty$. The arc set and per-unit costs are:\n- Arc $s \\to a$ with cost $2$.\n- Arc $a \\to t$ with cost $3$.\n- Arc $s \\to b$ with cost $2$.\n- Arc $b \\to t$ with cost $3$.\n- Arc $a \\to b$ with cost $0$.\n- Arc $b \\to a$ with cost $0$.\n\nYou will use the formal structure of the Minimum Cost Flow (MCF) problem and its Linear Programming (LP) dual to analyze optimality and degeneracy. \n\nTasks:\n1. Formulate the MCF for sending the required flow from $s$ to $t$ over the given network, starting from the fundamental definitions of flow conservation and nonnegativity. Identify the objective and constraints explicitly in mathematical form.\n2. Using the dual characterization via node potentials (also called reduced costs), derive the necessary and sufficient optimality conditions for this network. Do not assume or quote a pre-derived formula; instead, connect the dual variables and reduced costs to the primal feasibility through complementary slackness.\n3. Construct a feasible flow that ships all $10$ units from $s$ to $t$, and propose node potentials $\\pi_{s}, \\pi_{a}, \\pi_{b}, \\pi_{t}$ that certify optimality of your flow by making the arcs you use tight (zero reduced cost) and ensuring all unused arcs satisfy the appropriate reduced-cost sign conditions.\n4. Identify a directed cycle comprised entirely of tight arcs with zero reduced cost, and explain how adding a circulation along this cycle generates multiple distinct optimal flows without changing the objective value. Your explanation must be grounded in the LP duality and complementary slackness conditions.\n5. Compute the minimum total cost of shipping the $10$ units from $s$ to $t$ in this network. Provide your final answer as a single real number. No rounding is required.\n\nYour final reported answer must be the minimum cost value only, expressed as a single real number.", "solution": "The problem is a well-posed Minimum Cost Flow (MCF) problem, a standard topic in network optimization. It is self-contained, mathematically consistent, and all terms are clearly defined. The total supply equals the total demand, $\\sum_i b_i = 10 + 0 + 0 - 10 = 0$, ensuring the potential for a feasible solution. Therefore, the problem is valid and a solution will be provided.\n\n**1. Formulation of the Minimum Cost Flow Problem**\n\nLet $x_{ij}$ be the amount of flow on the directed arc from node $i$ to node $j$. The set of nodes is $N = \\{s, a, b, t\\}$ and the set of arcs is $A = \\{(s,a), (a,t), (s,b), (b,t), (a,b), (b,a)\\}$. The problem is to minimize the total cost of sending a flow of $10$ units from the source $s$ to the sink $t$.\n\nThe objective function to minimize is the total cost, which is the sum of the costs on each arc multiplied by the flow on that arc:\n$$ \\text{Minimize } Z = c_{sa}x_{sa} + c_{at}x_{at} + c_{sb}x_{sb} + c_{bt}x_{bt} + c_{ab}x_{ab} + c_{ba}x_{ba} $$\nSubstituting the given costs, we have:\n$$ \\text{Minimize } Z = 2x_{sa} + 3x_{at} + 2x_{sb} + 3x_{bt} + 0x_{ab} + 0x_{ba} $$\n\nThe constraints are as follows:\n- **Flow Conservation:** For each node $i \\in N$, the net flow (total outflow minus total inflow) must equal the supply/demand $b_i$.\n    - Node $s$ (supply $b_s=10$):\n    $$ x_{sa} + x_{sb} = 10 $$\n    - Node $a$ (transshipment $b_a=0$):\n    $$ (x_{at} + x_{ab}) - (x_{sa} + x_{ba}) = 0 $$\n    - Node $b$ (transshipment $b_b=0$):\n    $$ (x_{bt} + x_{ba}) - (x_{sb} + x_{ab}) = 0 $$\n    - Node $t$ (sink/demand $b_t=-10$):\n    $$ 0 - (x_{at} + x_{bt}) = -10 \\quad \\text{or} \\quad x_{at} + x_{bt} = 10 $$\n- **Non-negativity and Capacity:** The flow on each arc must be non-negative and must not exceed its capacity. The lower bound is given as $0$ and the upper bound is $+\\infty$.\n    $$ x_{ij} \\ge 0 \\quad \\text{for all } (i,j) \\in A $$\n    The infinite upper bounds do not impose active constraints.\n\n**2. Optimality Conditions from LP Duality**\n\nThe MCF problem is a Linear Program (LP). The optimality conditions can be derived from the theory of LP duality. We associate a dual variable, or node potential, $\\pi_i$ with each flow conservation constraint for node $i$. The dual LP is:\n$$ \\text{Maximize } W = \\sum_{i \\in N} b_i \\pi_i = 10\\pi_s + 0\\pi_a + 0\\pi_b - 10\\pi_t $$\nSubject to constraints derived from the primal variables $x_{ij}$. For each arc $(i,j) \\in A$, the dual constraint is:\n$$ \\pi_i - \\pi_j \\le c_{ij} $$\nThis can be rewritten using the concept of **reduced cost**, $c_{ij}^\\pi = c_{ij} - \\pi_i + \\pi_j$. The dual constraints are equivalent to requiring that all reduced costs are non-negative:\n$$ c_{ij}^\\pi \\ge 0 \\quad \\text{for all } (i,j) \\in A $$\nThe dual variables $\\pi_i$ are unrestricted in sign.\n\nThe Karush-Kuhn-Tucker (KKT) conditions for optimality connect the primal solution $x$ and the dual solution $\\pi$. They consist of:\n1.  **Primal Feasibility:** The flow vector $x$ must satisfy all flow conservation and non-negativity constraints.\n2.  **Dual Feasibility:** The node potentials $\\pi$ must satisfy the reduced cost non-negativity condition, $c_{ij}^\\pi \\ge 0$ for all arcs $(i,j)$.\n3.  **Complementary Slackness:** For each arc $(i,j) \\in A$, the product of the primal flow and the slack in the dual constraint must be zero. The slack in the dual constraint is exactly the reduced cost. Thus, the condition is:\n    $$ x_{ij} \\cdot c_{ij}^\\pi = 0 $$\nThis implies that if a flow $x_{ij}$ is positive, then its corresponding arc must be \"tight,\" meaning its reduced cost $c_{ij}^\\pi$ must be zero. If an arc has a strictly positive reduced cost ($c_{ij}^\\pi > 0$), the flow on that arc must be zero.\n\n**3. Construction of an Optimal Flow and Certifying Potentials**\n\nLet's propose a simple feasible flow. The path $s \\to a \\to t$ has a total cost of $c_{sa} + c_{at} = 2 + 3 = 5$. The path $s \\to b \\to t$ also has a cost of $c_{sb} + c_{bt} = 2 + 3 = 5$. Let's send all $10$ units of flow along the first path.\nProposed flow $x$:\n- $x_{sa} = 10$\n- $x_{at} = 10$\n- $x_{sb} = 0$, $x_{bt} = 0$, $x_{ab} = 0$, $x_{ba} = 0$\nThis flow is primally feasible as it satisfies all conservation and non-negativity constraints.\n\nNow, we must find node potentials $\\pi_i$ that certify the optimality of this flow. The potentials are not unique, so we can set one arbitrarily, e.g., $\\pi_s = 0$.\nThe complementary slackness conditions require that arcs with positive flow have zero reduced cost:\n- For arc $(s,a)$ with $x_{sa}=10 > 0$: $c_{sa}^\\pi = c_{sa} - \\pi_s + \\pi_a = 2 - 0 + \\pi_a = 0 \\implies \\pi_a = -2$.\n- For arc $(a,t)$ with $x_{at}=10 > 0$: $c_{at}^\\pi = c_{at} - \\pi_a + \\pi_t = 3 - (-2) + \\pi_t = 0 \\implies 5 + \\pi_t = 0 \\implies \\pi_t = -5$.\n\nNext, we must ensure dual feasibility for all other arcs (those with zero flow). We need to determine $\\pi_b$ such that all remaining reduced costs are non-negative.\n- Arc $(s,b)$: $c_{sb}^\\pi = c_{sb} - \\pi_s + \\pi_b = 2 - 0 + \\pi_b \\ge 0 \\implies \\pi_b \\ge -2$.\n- Arc $(b,t)$: $c_{bt}^\\pi = c_{bt} - \\pi_b + \\pi_t = 3 - \\pi_b + (-5) = -2 - \\pi_b \\ge 0 \\implies \\pi_b \\le -2$.\n- Arc $(a,b)$: $c_{ab}^\\pi = c_{ab} - \\pi_a + \\pi_b = 0 - (-2) + \\pi_b = 2 + \\pi_b \\ge 0 \\implies \\pi_b \\ge -2$.\n- Arc $(b,a)$: $c_{ba}^\\pi = c_{ba} - \\pi_b + \\pi_a = 0 - \\pi_b + (-2) = -2 - \\pi_b \\ge 0 \\implies \\pi_b \\le -2$.\n\nThe only value that satisfies both $\\pi_b \\ge -2$ and $\\pi_b \\le -2$ is $\\pi_b = -2$.\nThus, our proposed set of potentials is $\\pi_s = 0$, $\\pi_a = -2$, $\\pi_b = -2$, $\\pi_t = -5$. This set satisfies all KKT conditions, certifying that our proposed flow is optimal.\n\n**4. Degeneracy, Zero-Cost Cycles, and Multiple Optima**\n\nAn interesting outcome of our chosen potentials is that several arcs with zero flow also have zero reduced cost. This is a condition known as degeneracy in LP, and it indicates the existence of multiple optimal solutions. Let's calculate all reduced costs with our potentials:\n- $c_{sa}^\\pi = 2 - 0 + (-2) = 0$\n- $c_{at}^\\pi = 3 - (-2) + (-5) = 0$\n- $c_{sb}^\\pi = 2 - 0 + (-2) = 0$\n- $c_{bt}^\\pi = 3 - (-2) + (-5) = 0$\n- $c_{ab}^\\pi = 0 - (-2) + (-2) = 0$\n- $c_{ba}^\\pi = 0 - (-2) + (-2) = 0$\nAll arcs in the network are tight (have zero reduced cost).\n\nA directed cycle comprised entirely of tight arcs is a zero-cost cycle. The cycle $a \\to b \\to a$ consists of arcs $(a,b)$ and $(b,a)$. As shown, $c_{ab}^\\pi = 0$ and $c_{ba}^\\pi = 0$.\n\nLet $x^*$ be any optimal flow (e.g., the one found in part 3). Let $C$ be the cycle $a \\to b \\to a$. We can define a circulation $d$ on this cycle where $d_{ab} = \\delta$ and $d_{ba} = \\delta$ for some $\\delta \\ge 0$, and $d_{ij} = 0$ for all other arcs. This is a valid circulation because at node $a$, the net flow is $d_{ab} - d_{ba} = \\delta - \\delta = 0$, and at node $b$, the net flow is $d_{ba} - d_{ab} = \\delta - \\delta = 0$.\nThe cost of this circulation is $\\sum c_{ij} d_{ij} = c_{ab}\\delta + c_{ba}\\delta = 0 \\cdot \\delta + 0 \\cdot \\delta = 0$.\n\nWe can generate a new feasible flow $x' = x^* + d$. Since $d$ is a circulation, $x'$ will also satisfy the flow conservation constraints. Since all flows in $x^*$ are non-negative and we choose $\\delta \\ge 0$, the flow $x'$ remains non-negative. The cost of $x'$ is $\\text{Cost}(x') = \\text{Cost}(x^*) + \\text{Cost}(d) = \\text{Cost}(x^*) + 0$.\nThus, by adding a zero-cost circulation, we have created a new flow that is also optimal. For example, starting with $x_{sa}=10, x_{at}=10$ and all others zero, we can create a new optimal flow $x'$ with $x'_{sa}=10, x'_{at}=10, x'_{ab}=\\delta, x'_{ba}=\\delta$. This can be done for any $\\delta \\ge 0$, demonstrating an infinite number of optimal flow patterns, all achieving the same minimum cost. This phenomenon arises because the set of tight arcs contains a cycle, which is a direct consequence of the LP degeneracy.\n\n**5. Minimum Total Cost**\n\nThe minimum cost can be computed from any optimal flow. Using the flow $x$ from part 3:\n$$ Z = c_{sa}x_{sa} + c_{at}x_{at} = 2 \\cdot 10 + 3 \\cdot 10 = 20 + 30 = 50 $$\nAlternatively, we can use strong duality, which states that the optimal objective value of the primal problem equals the optimal objective value of the dual problem. Using our optimal potentials from part 3:\n$$ W = 10\\pi_s - 10\\pi_t = 10(0) - 10(-5) = 50 $$\nBoth methods yield the same result. The minimum total cost is $50$.", "answer": "$$\\boxed{50}$$", "id": "3151093"}]}