{"hands_on_practices": [{"introduction": "While simple heuristics like the Northwest Corner rule provide a quick way to find an initial feasible solution, their disregard for costs can lead to highly inefficient outcomes. This exercise challenges you to construct a specific scenario where this cost-blind approach yields a solution that is far from optimal. By calculating the exact suboptimality gap, you will gain a tangible understanding of why rigorous, cost-aware optimization methods are indispensable for solving real-world transportation problems. [@problem_id:3193108]", "problem": "Consider the balanced transportation problem with decision variables $x_{ij}$ that minimize the total transportation cost $\\sum_{i=1}^{m}\\sum_{j=1}^{n} c_{ij} x_{ij}$ subject to supply constraints $\\sum_{j=1}^{n} x_{ij} = s_i$ for each origin $i$ and demand constraints $\\sum_{i=1}^{m} x_{ij} = d_j$ for each destination $j$, with $x_{ij} \\ge 0$, where $\\sum_{i=1}^{m} s_i = \\sum_{j=1}^{n} d_j$. Build an explicit $3 \\times 3$ instance that is balanced and for which the Northwest corner rule (NW) yields a highly suboptimal feasible solution.\n\nConstruct the instance as follows. Let $m = n = 3$. Let supplies be $s_1 = s_2 = s_3 = S$ with $S  0$. Let demands be $d_1 = S - \\delta$, $d_2 = S$, and $d_3 = S + \\delta$, where $\\delta \\in (0,S)$. Let the transportation costs satisfy\n$$\nc_{11} = c_{22} = c_{33} = M, \\quad c_{ij} = \\varepsilon \\text{ for all } (i,j) \\text{ with } i \\ne j,\n$$\nwith parameters $M$ and $\\varepsilon$ such that $M  \\varepsilon \\ge 0$.\n\nStarting from the fundamental model definition above, evaluate the total cost of the NW allocation $Z(x^{\\text{NW}})$, construct a feasible allocation that achieves the optimal value $Z(x^\\star)$, argue its optimality from first principles, and then compute the exact additive suboptimality gap\n$$\n\\Delta Z \\equiv Z(x^{\\text{NW}}) - Z(x^\\star)\n$$\nas a closed-form analytic expression in terms of $S$, $\\delta$, $M$, and $\\varepsilon$. Give your answer as a single simplified expression. No rounding is required.", "solution": "The problem statement has been validated and is found to be self-contained, consistent, and scientifically grounded. It presents a well-posed problem in the field of optimization methods.\n\nThe problem asks for an analysis of a specific $3 \\times 3$ balanced transportation problem. We are given the following:\n- Number of origins $m=3$, and number of destinations $n=3$.\n- Supplies: $s_1 = S$, $s_2 = S$, $s_3 = S$, for some $S  0$.\n- Demands: $d_1 = S - \\delta$, $d_2 = S$, $d_3 = S + \\delta$, where $0  \\delta  S$.\n- The problem is balanced, as total supply $\\sum s_i = 3S$ equals total demand $\\sum d_j = (S-\\delta) + S + (S+\\delta) = 3S$.\n- Costs: $c_{11} = c_{22} = c_{33} = M$, and $c_{ij} = \\varepsilon$ for all $i \\ne j$, with $M  \\varepsilon \\ge 0$.\n\nThe transportation tableau is:\n$$\n\\begin{array}{c|ccc|c}\n              d_1=S-\\delta  d_2=S  d_3=S+\\delta  \\text{Supply} \\\\ \\hline\n\\text{Origin 1}  c_{11}=M  c_{12}=\\varepsilon  c_{13}=\\varepsilon  s_1=S \\\\\n\\text{Origin 2}  c_{21}=\\varepsilon  c_{22}=M  c_{23}=\\varepsilon  s_2=S \\\\\n\\text{Origin 3}  c_{31}=\\varepsilon  c_{32}=\\varepsilon  c_{33}=M  s_3=S \\\\ \\hline\n\\text{Demand}  S-\\delta  S  S+\\delta  3S\n\\end{array}\n$$\n\n**1. Northwest Corner (NW) Rule Allocation and Cost**\n\nThe Northwest Corner rule determines an initial basic feasible solution by allocating units starting from the top-left cell $(1,1)$ of the tableau, without regard to costs.\n\n- **Cell (1,1):** Allocate $x_{11} = \\min(s_1, d_1) = \\min(S, S-\\delta) = S-\\delta$.\n  The demand for destination $1$ is satisfied. The remaining supply at origin $1$ is $s'_1 = S - (S-\\delta) = \\delta$.\n\n- **Cell (1,2):** Move to the right as column $1$ is satisfied. Allocate $x_{12} = \\min(s'_1, d_2) = \\min(\\delta, S) = \\delta$.\n  The supply from origin $1$ is exhausted. The remaining demand at destination $2$ is $d'_2 = S - \\delta$.\n\n- **Cell (2,2):** Move down as row $1$ is satisfied. Allocate $x_{22} = \\min(s_2, d'_2) = \\min(S, S-\\delta) = S-\\delta$.\n  The demand for destination $2$ is satisfied. The remaining supply at origin $2$ is $s'_2 = S - (S-\\delta) = \\delta$.\n\n- **Cell (2,3):** Move to the right as column $2$ is satisfied. Allocate $x_{23} = \\min(s'_2, d_3) = \\min(\\delta, S+\\delta) = \\delta$.\n  The supply from origin $2$ is exhausted. The remaining demand at destination $3$ is $d'_3 = (S+\\delta) - \\delta = S$.\n\n- **Cell (3,3):** Move down as row $2$ is satisfied. Allocate $x_{33} = \\min(s_3, d'_3) = \\min(S, S) = S$.\n  The supply from origin $3$ is exhausted, and the demand at destination $3$ is met. The allocation is complete.\n\nThe resulting allocation, denoted by $x^{\\text{NW}}$, is:\n$x^{\\text{NW}}_{11} = S-\\delta$\n$x^{\\text{NW}}_{12} = \\delta$\n$x^{\\text{NW}}_{22} = S-\\delta$\n$x^{\\text{NW}}_{23} = \\delta$\n$x^{\\text{NW}}_{33} = S$\nAll other $x^{\\text{NW}}_{ij} = 0$.\n\nThe total cost of this allocation, $Z(x^{\\text{NW}})$, is:\n$$\nZ(x^{\\text{NW}}) = \\sum_{i=1}^{3}\\sum_{j=1}^{3} c_{ij} x^{\\text{NW}}_{ij} = c_{11}x^{\\text{NW}}_{11} + c_{12}x^{\\text{NW}}_{12} + c_{22}x^{\\text{NW}}_{22} + c_{23}x^{\\text{NW}}_{23} + c_{33}x^{\\text{NW}}_{33}\n$$\n$$\nZ(x^{\\text{NW}}) = M(S-\\delta) + \\varepsilon(\\delta) + M(S-\\delta) + \\varepsilon(\\delta) + M(S)\n$$\n$$\nZ(x^{\\text{NW}}) = M(S-\\delta + S-\\delta + S) + \\varepsilon(\\delta + \\delta)\n$$\n$$\nZ(x^{\\text{NW}}) = M(3S - 2\\delta) + 2\\delta\\varepsilon\n$$\n\n**2. Optimal Allocation and Cost**\n\nTo find the optimal solution, we analyze the structure of the cost function. Let $Q_D = x_{11} + x_{22} + x_{33}$ be the total quantity shipped along the main diagonal (high-cost routes). The total quantity shipped is $\\sum_{i,j} x_{ij} = 3S$. The quantity shipped on off-diagonal routes is $3S - Q_D$. The total cost can be written as:\n$$\nZ = M \\sum_{i=j} x_{ij} + \\varepsilon \\sum_{i \\ne j} x_{ij} = M Q_D + \\varepsilon (3S - Q_D)\n$$\n$$\nZ = (M - \\varepsilon) Q_D + 3S\\varepsilon\n$$\nSince $M > \\varepsilon$, the term $(M-\\varepsilon)$ is positive. Therefore, to minimize the total cost $Z$, one must minimize $Q_D$, the total flow on the high-cost diagonal routes. Since all $x_{ij} \\ge 0$, the minimum possible value for $Q_D$ is $0$.\n\nWe must verify that a feasible allocation exists with $Q_D = x_{11} + x_{22} + x_{33} = 0$. This requires finding a feasible solution using only the off-diagonal cells (where cost is $\\varepsilon$). Let's construct such a solution, $x^\\star$.\nConsider the following allocation:\n$x^\\star_{12} = S-\\delta$\n$x^\\star_{13} = \\delta$\n$x^\\star_{23} = S$\n$x^\\star_{31} = S-\\delta$\n$x^\\star_{32} = \\delta$\nAll other $x^\\star_{ij}=0$, including the diagonal elements $x^\\star_{11}, x^\\star_{22}, x^\\star_{33}$.\n\nLet's check if this allocation is feasible:\n- Non-negativity: Since $0  \\delta  S$, all allocated quantities are positive.\n- Supply constraints:\n  - Row 1: $x^\\star_{12} + x^\\star_{13} = (S-\\delta) + \\delta = S$. (Correct)\n  - Row 2: $x^\\star_{23} = S$. (Correct)\n  - Row 3: $x^\\star_{31} + x^\\star_{32} = (S-\\delta) + \\delta = S$. (Correct)\n- Demand constraints:\n  - Column 1: $x^\\star_{31} = S-\\delta$. (Correct)\n  - Column 2: $x^\\star_{12} + x^\\star_{32} = (S-\\delta) + \\delta = S$. (Correct)\n  - Column 3: $x^\\star_{13} + x^\\star_{23} = \\delta + S = S+\\delta$. (Correct)\n\nThe allocation $x^\\star$ is feasible and has $Q_D=0$. Therefore, it achieves the minimum possible cost. This is an optimal solution. The optimal cost, $Z(x^\\star)$, is:\n$$\nZ(x^\\star) = (M - \\varepsilon) (0) + 3S\\varepsilon = 3S\\varepsilon\n$$\n\n**3. Suboptimality Gap**\n\nThe additive suboptimality gap, $\\Delta Z$, is the difference between the cost of the NW allocation and the optimal cost.\n$$\n\\Delta Z = Z(x^{\\text{NW}}) - Z(x^\\star)\n$$\n$$\n\\Delta Z = \\left( M(3S - 2\\delta) + 2\\delta\\varepsilon \\right) - (3S\\varepsilon)\n$$\n$$\n\\Delta Z = 3SM - 2\\delta M + 2\\delta\\varepsilon - 3S\\varepsilon\n$$\nTo simplify, we group terms with $M$ and $\\varepsilon$:\n$$\n\\Delta Z = (3SM - 3S\\varepsilon) - (2\\delta M - 2\\delta\\varepsilon)\n$$\n$$\n\\Delta Z = 3S(M - \\varepsilon) - 2\\delta(M - \\varepsilon)\n$$\nFactoring out the common term $(M-\\varepsilon)$ yields the final simplified expression:\n$$\n\\Delta Z = (3S - 2\\delta)(M - \\varepsilon)\n$$\nThis expression represents the exact additive suboptimality gap of the Northwest corner rule allocation for the given problem instance.", "answer": "$$\n\\boxed{(3S - 2\\delta)(M - \\varepsilon)}\n$$", "id": "3193108"}, {"introduction": "Finding one optimal solution is a great achievement, but is it the only one? This practice delves into the concept of alternative optima, a common occurrence in linear programming. You will use the method of potentials to calculate dual variables, $u_i$ and $v_j$, and their corresponding reduced costs to discover that multiple optimal shipping plans exist. By performing different pivots that maintain optimality, you will learn to navigate the set of optimal solutions and appreciate the flexibility it can offer a decision-maker. [@problem_id:3193076]", "problem": "Consider the classical transportation problem that minimizes total shipping cost subject to supply and demand conservation. You are given two factories $\\{i=1,2\\}$ and three warehouses $\\{j=1,2,3\\}$. The supplies are $s_{1}=20$ units and $s_{2}=30$ units, and the demands are $d_{1}=10$ units, $d_{2}=15$ units, and $d_{3}=25$ units. The per-unit shipping costs are given by the matrix\n$$\n\\begin{pmatrix}\nc_{11}  c_{12}  c_{13} \\\\\nc_{21}  c_{22}  c_{23}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4  3  1 \\\\\n3  2  0\n\\end{pmatrix}.\n$$\nThe decision variables are $x_{ij}\\geq 0$ denoting the units shipped from factory $i$ to warehouse $j$, with conservation constraints $\\sum_{j}x_{ij}=s_{i}$ for each factory $i$ and $\\sum_{i}x_{ij}=d_{j}$ for each warehouse $j$. The objective is to minimize $\\sum_{i=1}^{2}\\sum_{j=1}^{3}c_{ij}x_{ij}$.\n\nStart from the following basic feasible solution (BFS) obtained by the Northwest corner method:\n- $x_{11}=10$, $x_{12}=10$, $x_{22}=5$, $x_{23}=25$, and all other $x_{ij}=0$.\n\nDefine potentials $u_{i}$ and $v_{j}$ via the basic equalities $c_{ij}=u_{i}+v_{j}$ on the basic cells of the given BFS, and define reduced costs $r_{ij}:=c_{ij}-(u_{i}+v_{j})$ for all $(i,j)$. Using only the conservation equalities $\\sum_{j}x_{ij}=s_{i}$ and $\\sum_{i}x_{ij}=d_{j}$ and the definition $c_{ij}=u_{i}+v_{j}$ on basic cells, reason from first principles of linear programming optimality for the transportation problem (no shortcut formulas may be assumed) to:\n\n1. Compute one valid set of potentials $\\{u_{1},u_{2},v_{1},v_{2},v_{3}\\}$ consistent with the given BFS, and show that at least two distinct nonbasic positions $(i,j)$ have tied reduced costs $r_{ij}=0$.\n2. Perform two different pivot choices (entering variables), one with $(1,3)$ and one with $(2,1)$, each time tracing the unique cycle, determining the permissible step size, and updating the basic variables to obtain two distinct optimal BFSs $\\{x_{ij}\\}$.\n3. Explain, using the feasible-flow equalities and your potentials, why the total cost $\\sum_{i,j}c_{ij}x_{ij}$ is invariant under these two pivots.\n4. Determine the numerical value of the optimal objective cost $\\sum_{i=1}^{2}\\sum_{j=1}^{3}c_{ij}x_{ij}$ for this instance. Express the final answer in dollars, and provide a single real number. No rounding is needed beyond exact arithmetic, and do not include units in your final boxed answer.", "solution": "The problem presents a classical balanced transportation problem, which is a specific type of linear program. I will first validate the problem statement according to the required procedure.\n\n### Step 1: Extract Givens\n- **Sources (Factories)**: $i \\in \\{1, 2\\}$\n- **Destinations (Warehouses)**: $j \\in \\{1, 2, 3\\}$\n- **Supplies**: $s_1 = 20$, $s_2 = 30$\n- **Demands**: $d_1 = 10$, $d_2 = 15$, $d_3 = 25$\n- **Cost Matrix**: $C = \\begin{pmatrix} c_{11}  c_{12}  c_{13} \\\\ c_{21}  c_{22}  c_{23} \\end{pmatrix} = \\begin{pmatrix} 4  3  1 \\\\ 3  2  0 \\end{pmatrix}$\n- **Decision Variables**: $x_{ij} \\ge 0$, the quantity shipped from factory $i$ to warehouse $j$.\n- **Constraints**:\n    - Supply: $\\sum_{j=1}^{3} x_{ij} = s_i$ for $i=1,2$.\n    - Demand: $\\sum_{i=1}^{2} x_{ij} = d_j$ for $j=1,2,3$.\n- **Objective Function**: Minimize $Z = \\sum_{i=1}^{2}\\sum_{j=1}^{3} c_{ij} x_{ij}$.\n- **Initial Basic Feasible Solution (BFS)**: $x_{11}=10$, $x_{12}=10$, $x_{22}=5$, $x_{23}=25$. The remaining variables $x_{13}$ and $x_{21}$ are non-basic and thus equal to $0$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem is a standard transportation problem within the field of optimization and linear programming. The methodology (method of potentials or transportation simplex) is a well-established scientific algorithm. The problem is scientifically grounded.\n2.  **Well-Posedness**:\n    - The problem is balanced, as total supply equals total demand: $\\sum s_i = 20 + 30 = 50$ and $\\sum d_j = 10 + 15 + 25 = 50$. This is a necessary condition for a feasible solution to exist.\n    - The provided initial solution is checked for feasibility:\n        - Supply $1$: $x_{11} + x_{12} + x_{13} = 10 + 10 + 0 = 20 = s_1$. (Correct)\n        - Supply $2$: $x_{21} + x_{22} + x_{23} = 0 + 5 + 25 = 30 = s_2$. (Correct)\n        - Demand $1$: $x_{11} + x_{21} = 10 + 0 = 10 = d_1$. (Correct)\n        - Demand $2$: $x_{12} + x_{22} = 10 + 5 = 15 = d_2$. (Correct)\n        - Demand $3$: $x_{13} + x_{23} = 0 + 25 = 25 = d_3$. (Correct)\n    - All $x_{ij}$ values are non-negative.\n    - The number of basic variables is $4$, which equals $m+n-1 = 2+3-1=4$. The BFS is non-degenerate.\n    - The problem is well-posed.\n3.  **Objectivity**: The problem is stated with precise mathematical definitions and numerical data. It is free of subjective language.\n4.  **Completeness**: All necessary data (supplies, demands, costs) and conditions are provided to solve the problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n---\n\nThe solution proceeds by following the four parts requested in the problem statement.\n\n**1. Computation of Potentials and Reduced Costs**\n\nThe given Basic Feasible Solution (BFS) has basic variables corresponding to the cells $(1,1)$, $(1,2)$, $(2,2)$, and $(2,3)$. For these basic cells, the potentials $u_i$ and $v_j$ must satisfy the equality $c_{ij} = u_i + v_j$. This gives a system of $4$ equations with $5$ unknowns ($u_1, u_2, v_1, v_2, v_3$):\n- For $(1,1)$: $c_{11} = u_1 + v_1 \\implies 4 = u_1 + v_1$\n- For $(1,2)$: $c_{12} = u_1 + v_2 \\implies 3 = u_1 + v_2$\n- For $(2,2)$: $c_{22} = u_2 + v_2 \\implies 2 = u_2 + v_2$\n- For $(2,3)$: $c_{23} = u_2 + v_3 \\implies 0 = u_2 + v_3$\n\nThis system has one degree of freedom. We can set one potential arbitrarily. Let $u_1 = 0$.\n1.  From $3 = u_1 + v_2$, we get $3 = 0 + v_2 \\implies v_2 = 3$.\n2.  From $4 = u_1 + v_1$, we get $4 = 0 + v_1 \\implies v_1 = 4$.\n3.  From $2 = u_2 + v_2$, we get $2 = u_2 + 3 \\implies u_2 = -1$.\n4.  From $0 = u_2 + v_3$, we get $0 = -1 + v_3 \\implies v_3 = 1$.\n\nA valid set of potentials is $\\{u_1, u_2, v_1, v_2, v_3\\} = \\{0, -1, 4, 3, 1\\}$.\n\nNext, we compute the reduced costs $r_{ij} = c_{ij} - (u_i + v_j)$ for the non-basic cells, which are $(1,3)$ and $(2,1)$.\n- For $(1,3)$: $r_{13} = c_{13} - (u_1 + v_3) = 1 - (0 + 1) = 0$.\n- For $(2,1)$: $r_{21} = c_{21} - (u_2 + v_1) = 3 - (-1 + 4) = 3 - 3 = 0$.\n\nSince all reduced costs are non-negative ($r_{ij} \\geq 0$), the current BFS is optimal. Furthermore, we have found two non-basic positions, $(1,3)$ and $(2,1)$, which have tied reduced costs of $r_{ij}=0$. This indicates the existence of alternative optimal solutions.\n\n**2. Pivots for Two Alternative Optimal BFSs**\n\nWe can pivot by introducing either $x_{13}$ or $x_{21}$ into the basis. The objective function value will not change since their reduced costs are zero.\n\n**Pivot 1: Entering variable $x_{13}$**\nWe introduce $x_{13} = \\theta$ into the solution. To maintain the conservation constraints, we must adjust other basic variables. This forms a unique cycle in the transportation tableau involving the entering cell $(1,3)$ and some current basic cells. The cycle is $(1,3) \\to (2,3) \\to (2,2) \\to (1,2) \\to (1,3)$. We alternately add and subtract $\\theta$ around this loop:\n- $x_{13}' = x_{13} + \\theta = 0 + \\theta$\n- $x_{23}' = x_{23} - \\theta = 25 - \\theta$\n- $x_{22}' = x_{22} + \\theta = 5 + \\theta$\n- $x_{12}' = x_{12} - \\theta = 10 - \\theta$\nThe remaining basic variable $x_{11}$ is not in the cycle and remains unchanged. For the new solution to be feasible, all variables must be non-negative. This requires $25 - \\theta \\ge 0$ and $10 - \\theta \\ge 0$. The maximum permissible value for $\\theta$ is $\\theta = \\min(25, 10) = 10$.\nWith $\\theta=10$, the variable $x_{12}$ becomes $0$ and leaves the basis. The new optimal BFS, denoted $\\{x_{ij}'\\}$, is:\n- $x_{11}' = 10$\n- $x_{12}' = 0$ (non-basic)\n- $x_{13}' = 10$ (basic)\n- $x_{22}' = 5 + 10 = 15$\n- $x_{23}' = 25 - 10 = 15$\n- All other $x_{ij}'$ are zero. The new basic cells are $(1,1), (1,3), (2,2), (2,3)$.\n\n**Pivot 2: Entering variable $x_{21}$ (from the original BFS)**\nWe introduce $x_{21} = \\theta$ into the original solution. The cycle is $(2,1) \\to (1,1) \\to (1,2) \\to (2,2) \\to (2,1)$. We adjust variables:\n- $x_{21}'' = x_{21} + \\theta = 0 + \\theta$\n- $x_{11}'' = x_{11} - \\theta = 10 - \\theta$\n- $x_{12}'' = x_{12} + \\theta = 10 + \\theta$\n- $x_{22}'' = x_{22} - \\theta = 5 - \\theta$\nThe variable $x_{23}$ is not in the cycle and is unchanged. Feasibility requires $10 - \\theta \\ge 0$ and $5 - \\theta \\ge 0$. The maximum value is $\\theta = \\min(10, 5) = 5$.\nWith $\\theta=5$, the variable $x_{22}$ becomes $0$ and leaves the basis. The second new optimal BFS, denoted $\\{x_{ij}''\\}$, is:\n- $x_{11}'' = 10 - 5 = 5$\n- $x_{12}'' = 10 + 5 = 15$\n- $x_{21}'' = 5$ (basic)\n- $x_{22}'' = 0$ (non-basic)\n- $x_{23}'' = 25$\n- All other $x_{ij}''$ are zero. The new basic cells are $(1,1), (1,2), (2,1), (2,3)$.\n\n**3. Invariance of the Total Cost**\n\nThe total cost is $Z = \\sum_{i,j} c_{ij} x_{ij}$. When we pivot to a new solution $\\{x'_{ij}\\}$ by introducing a non-basic variable $x_{kl}$ with flow $\\theta$, the change in cost is $\\Delta Z = \\sum_{i,j} c_{ij} (x'_{ij} - x_{ij})$. The only changes $\\Delta x_{ij} = x'_{ij} - x_{ij}$ are for variables in the cycle, where $\\Delta x_{ij}$ takes values $\\pm\\theta$ or $0$. Let the cycle be $(k,l), (k, m_1), (p_1, m_1), \\dots, (p_N, l)$. The change in cost is:\n$\\Delta Z = c_{kl}(\\theta) + c_{k m_1}(-\\theta) + c_{p_1 m_1}(\\theta) + \\dots = \\theta (c_{kl} - c_{k m_1} + c_{p_1 m_1} - \\dots)$\nThe cells other than $(k,l)$ in this cycle are basic, so their costs satisfy $c_{ij} = u_i + v_j$. Substituting these into the expression:\n$\\Delta Z = \\theta (c_{kl} - (u_k + v_{m_1}) + (u_{p_1} + v_{m_1}) - \\dots + (u_{p_N} + v_{l}))$.\nDue to the structure of the cycle, the potentials for the intermediate vertices cancel out in pairs (e.g., $-v_{m_1} + v_{m_1} = 0$). The expression telescopes to:\n$\\Delta Z = \\theta (c_{kl} - (u_k + v_l))$\nThe term $c_{kl} - (u_k + v_l)$ is by definition the reduced cost $r_{kl}$ of the entering variable. Thus, $\\Delta Z = \\theta \\cdot r_{kl}$.\n\nIn our pivots:\n- For Pivot 1, we introduced $x_{13}$ with $r_{13}=0$. The change in cost is $\\Delta Z = \\theta \\cdot r_{13} = 10 \\cdot 0 = 0$.\n- For Pivot 2, we introduced $x_{21}$ with $r_{21}=0$. The change in cost is $\\Delta Z = \\theta \\cdot r_{21} = 5 \\cdot 0 = 0$.\n\nIn both cases, the cost change is zero because the entering variable has a reduced cost of zero. This is a general principle: pivoting on a non-basic variable with zero reduced cost moves the solution to another BFS on the same optimal face of the feasible polytope, without changing the objective function value.\n\n**4. Optimal Objective Cost**\n\nSince the initial BFS is optimal, we can calculate the minimum total cost using its variable values: $x_{11}=10, x_{12}=10, x_{22}=5, x_{23}=25$.\nThe objective function value is:\n$$Z = \\sum_{i,j} c_{ij} x_{ij} = c_{11}x_{11} + c_{12}x_{12} + c_{22}x_{22} + c_{23}x_{23}$$\nSubstituting the given costs and variable values:\n$$Z = (4)(10) + (3)(10) + (2)(5) + (0)(25)$$\n$$Z = 40 + 30 + 10 + 0 = 80$$\nThe optimal cost for this transportation problem is $80$. As a verification, we can compute the cost for the two alternative optimal solutions found in part 2, and they will also yield a total cost of $80$.\n- Cost of BFS 1: $Z' = (4)(10) + (1)(10) + (2)(15) + (0)(15) = 40 + 10 + 30 + 0 = 80$.\n- Cost of BFS 2: $Z'' = (4)(5) + (3)(15) + (3)(5) + (0)(25) = 20 + 45 + 15 + 0 = 80$.\nAll three solutions confirm the optimal cost. The numerical value of the optimal cost is $80$.", "answer": "$$\n\\boxed{80}\n$$", "id": "3193076"}, {"introduction": "The dual variables, or \"potentials,\" in a transportation problem are more than just computational aids; they carry a profound economic meaning. This exercise provides a hands-on validation of the envelope theorem, which connects these dual variables to the sensitivity of the optimal cost. You will perturb the demand constraints slightly and observe how the total cost changes, discovering that the dual variable $v_j$ perfectly predicts this change. This practice solidifies the interpretation of dual variables as \"shadow prices,\" a cornerstone concept in optimization theory. [@problem_id:3193102]", "problem": "Consider the following transportation problem in the framework of Linear Programming (LP). There are two supply nodes (sources) indexed by $i \\in \\{1,2\\}$ with supplies $s_{1}=4$ and $s_{2}=3$, and three demand nodes (destinations) indexed by $j \\in \\{1,2,3\\}$ with demands $d_{1}=2$, $d_{2}=4$, and $d_{3}=1$. The problem is balanced, i.e., $\\sum_{i=1}^{2} s_{i}=\\sum_{j=1}^{3} d_{j}=7$. The per-unit shipping costs are given by $c_{11}=2$, $c_{12}=3$, $c_{13}=0$, $c_{21}=4$, $c_{22}=1$, and $c_{23}=0$. The decision variables are $x_{ij} \\ge 0$, the quantity shipped from source $i$ to destination $j$. The primal problem is\nminimize $\\sum_{i=1}^{2}\\sum_{j=1}^{3} c_{ij} x_{ij}$ subject to the supply equalities $\\sum_{j=1}^{3} x_{ij} = s_{i}$ for $i=1,2$ and the demand equalities $\\sum_{i=1}^{2} x_{ij} = d_{j}$ for $j=1,2,3$.\n\na) Solve this transportation problem to optimality and determine an optimal basic feasible solution together with an associated optimal dual solution in terms of node potentials $(u_{1},u_{2})$ for the supplies and $(v_{1},v_{2},v_{3})$ for the demands, satisfying $u_{i}+v_{j}=c_{ij}$ on basic arcs and $u_{i}+v_{j} \\le c_{ij}$ otherwise.\n\nb) Now perform the following perturbation experiment to validate the envelope principle at the optimum: increase the single demand $d_{2}$ by a small amount $\\varepsilon=0.5$, and simultaneously decrease the demand $d_{3}$ by the same amount, i.e., replace $(d_{1},d_{2},d_{3})=(2,4,1)$ by $(d_{1},d_{2}+\\varepsilon,d_{3}-\\varepsilon)=(2,4.5,0.5)$, keeping supplies $(s_{1},s_{2})=(4,3)$ and all costs $c_{ij}$ unchanged. Assuming the same set of basic variables remains optimal and feasible under this perturbation, compute:\n- the finite-difference marginal cost per unit $\\Delta Z/\\varepsilon$, where $\\Delta Z$ is the change in the optimal objective value due to the perturbation,\n- and the demand-side dual price difference $v_{2}-v_{3}$ from your part (a).\n\nc) Report the absolute discrepancy between these two quantities, i.e., $|\\Delta Z/\\varepsilon - (v_{2}-v_{3})|$. Round your final answer to four significant figures. The final answer must be a single real number without units.", "solution": "The user wants me to solve a transportation problem, perform a sensitivity analysis, and report the discrepancy between a finite-difference marginal cost and a dual price difference.\n\n### Problem Validation\n\nFirst, I must validate the problem statement.\n\n**Step 1: Extract Givens**\n- **Sources**: $i \\in \\{1, 2\\}$\n- **Destinations**: $j \\in \\{1, 2, 3\\}$\n- **Supplies**: $s_1 = 4$, $s_2 = 3$. Total supply $\\sum s_i = 7$.\n- **Demands**: $d_1 = 2$, $d_2 = 4$, $d_3 = 1$. Total demand $\\sum d_j = 7$.\n- **Costs**: $c_{11}=2$, $c_{12}=3$, $c_{13}=0$, $c_{21}=4$, $c_{22}=1$, $c_{23}=0$.\n- **Decision Variables**: $x_{ij} \\ge 0$.\n- **Primal Problem**: Minimize $Z = \\sum_{i=1}^{2}\\sum_{j=1}^{3} c_{ij} x_{ij}$ subject to $\\sum_{j=1}^{3} x_{ij} = s_{i}$ for $i=1,2$ and $\\sum_{i=1}^{2} x_{ij} = d_{j}$ for $j=1,2,3$.\n- **Dual Problem Conditions**: Find dual variables $(u_1, u_2)$ and $(v_1, v_2, v_3)$ such that $u_i + v_j = c_{ij}$ for basic variables and $u_i + v_j \\le c_{ij}$ for non-basic variables.\n- **Perturbation**: $\\varepsilon = 0.5$. New demands are $(d_1, d_2+\\varepsilon, d_3-\\varepsilon) = (2, 4.5, 0.5)$.\n- **Assumption for Perturbation**: The set of basic variables from the optimal solution in part (a) remains optimal and feasible.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is a standard transportation problem, a well-established topic within linear programming and optimization methods. It is mathematically and logically sound.\n- **Well-Posed**: The problem is balanced ($\\sum s_i = \\sum d_j$), ensuring a feasible solution exists. An optimal solution is guaranteed since the feasible region is non-empty and bounded (as $x_{ij} \\le \\min(s_i, d_j)$). The objective is clearly defined. The question asks for specific, computable quantities.\n- **Objective**: The problem statement uses precise mathematical language and provides all necessary numerical data. It is free of ambiguity and subjectivity.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the solution.\n\n---\n\n### Part (a): Optimal Primal and Dual Solution\n\nThe transportation problem can be represented by the following cost and requirements table:\n\n| | Destination 1 | Destination 2 | Destination 3 | Supply |\n|---|---|---|---|---|\n| **Source 1** | $c_{11}=2$ | $c_{12}=3$ | $c_{13}=0$ | $s_1=4$ |\n| **Source 2** | $c_{21}=4$ | $c_{22}=1$ | $c_{23}=0$ | $s_2=3$ |\n| **Demand** | $d_1=2$ | $d_2=4$ | $d_3=1$ | Total=7 |\n\nTo find an initial basic feasible solution (BFS), I will use the Least Cost Method.\n1. The lowest cost is $c_{13}=c_{23}=0$. I will choose cell $(1,3)$. Allocate $x_{13} = \\min(s_1, d_3) = \\min(4, 1) = 1$. The demand at destination $3$ is satisfied. The remaining supply at source $1$ is $4-1=3$.\n2. The problem reduces. The next lowest cost is $c_{22}=1$. Allocate $x_{22} = \\min(s_2, d_2) = \\min(3, 4) = 3$. The supply at source $2$ is exhausted. The remaining demand at destination $2$ is $4-3=1$.\n3. The problem reduces further. The only remaining supplier is source $1$. We must satisfy the remaining demands for destinations $1$ and $2$. The lowest cost for source $1$ is $c_{11}=2$. Allocate $x_{11} = \\min(\\text{rem }s_1, d_1) = \\min(3, 2) = 2$. The demand at destination $1$ is satisfied. The remaining supply at source $1$ is $3-2=1$.\n4. The only remaining demand is at destination $2$ ($1$ unit), and the only remaining supply is at source $1$ ($1$ unit). Allocate $x_{12} = 1$.\n\nThe initial BFS is: $x_{11}=2$, $x_{12}=1$, $x_{13}=1$, $x_{22}=3$, and all other $x_{ij}=0$.\nThis solution has $m+n-1 = 2+3-1=4$ basic variables, so it is non-degenerate. Let's check feasibility:\n- Source 1: $x_{11}+x_{12}+x_{13} = 2+1+1=4=s_1$. (Correct)\n- Source 2: $x_{21}+x_{22}+x_{23} = 0+3+0=3=s_2$. (Correct)\n- Destination 1: $x_{11}+x_{21} = 2+0=2=d_1$. (Correct)\n- Destination 2: $x_{12}+x_{22} = 1+3=4=d_2$. (Correct)\n- Destination 3: $x_{13}+x_{23} = 1+0=1=d_3$. (Correct)\n\nNow, I will test this solution for optimality by computing the dual variables $(u_i, v_j)$ and the reduced costs for non-basic variables. The basic variables are $x_{11}, x_{12}, x_{13}, x_{22}$. For these, $u_i + v_j = c_{ij}$.\nLet's set $u_1 = 0$ arbitrarily.\n- Basic cell $(1,1)$: $u_1+v_1=c_{11} \\implies 0+v_1=2 \\implies v_1=2$.\n- Basic cell $(1,2)$: $u_1+v_2=c_{12} \\implies 0+v_2=3 \\implies v_2=3$.\n- Basic cell $(1,3)$: $u_1+v_3=c_{13} \\implies 0+v_3=0 \\implies v_3=0$.\n- Basic cell $(2,2)$: $u_2+v_2=c_{22} \\implies u_2+3=1 \\implies u_2=-2$.\nSo, the dual variables are $(u_1, u_2) = (0, -2)$ and $(v_1, v_2, v_3) = (2, 3, 0)$.\n\nNow, check the optimality condition $u_i+v_j \\le c_{ij}$ for all non-basic cells. The non-basic cells are $(2,1)$ and $(2,3)$.\n- Non-basic cell $(2,1)$: The reduced cost is $\\bar{c}_{21} = c_{21} - (u_2+v_1) = 4 - (-2+2) = 4$. Since $4 \\ge 0$, the condition holds.\n- Non-basic cell $(2,3)$: The reduced cost is $\\bar{c}_{23} = c_{23} - (u_2+v_3) = 0 - (-2+0) = 2$. Since $2 \\ge 0$, the condition holds.\n\nSince all reduced costs are non-negative, the current basic feasible solution is optimal.\n- **Optimal Basic Feasible Solution**: $x_{11}=2$, $x_{12}=1$, $x_{13}=1$, $x_{22}=3$, $x_{21}=0$, $x_{23}=0$.\n- **Associated Optimal Dual Solution**: $(u_1, u_2) = (0, -2)$ and $(v_1, v_2, v_3) = (2, 3, 0)$.\n\nThe optimal objective value is $Z = \\sum c_{ij} x_{ij} = c_{11}x_{11} + c_{12}x_{12} + c_{13}x_{13} + c_{22}x_{22} = (2)(2) + (3)(1) + (0)(1) + (1)(3) = 4+3+0+3 = 10$.\n\n### Part (b): Perturbation Analysis\n\nThe demands are perturbed to $d'_1=2$, $d'_2 = d_2+\\varepsilon = 4+0.5=4.5$, and $d'_3 = d_3-\\varepsilon = 1-0.5=0.5$. The supplies remain $(s_1, s_2) = (4, 3)$.\nWe assume the same set of basic variables $\\{x_{11}, x_{12}, x_{13}, x_{22}\\}$ remains optimal and feasible. The non-basic variables $x_{21}$ and $x_{23}$ remain zero. Let the new flows be $x'_{ij}$.\n\nWe solve for the new flows using the supply and demand constraints:\n- $\\sum_j x'_{1j} = s_1 \\implies x'_{11}+x'_{12}+x'_{13} = 4$.\n- $\\sum_j x'_{2j} = s_2 \\implies x'_{21}+x'_{22}+x'_{23} = 3$.\n- $\\sum_i x'_{i1} = d'_1 \\implies x'_{11}+x'_{21} = 2$.\n- $\\sum_i x'_{i2} = d'_2 \\implies x'_{12}+x'_{22} = 4.5$.\n- $\\sum_i x'_{i3} = d'_3 \\implies x'_{13}+x'_{23} = 0.5$.\n\nUsing the fact that non-basic variables are zero ($x'_{21}=0, x'_{23}=0$):\n- From the demand constraint at $j=1$: $x'_{11}+0 = 2 \\implies x'_{11}=2$.\n- From the demand constraint at $j=3$: $x'_{13}+0 = 0.5 \\implies x'_{13}=0.5$.\n- From the supply constraint at $i=2$: $0+x'_{22}+0 = 3 \\implies x'_{22}=3$.\n- From the demand constraint at $j=2$: $x'_{12}+x'_{22} = 4.5 \\implies x'_{12}+3 = 4.5 \\implies x'_{12}=1.5$.\nThe new solution is $x'_{11}=2, x'_{12}=1.5, x'_{13}=0.5, x'_{22}=3$.\nLet's check the supply constraint for $i=1$: $x'_{11}+x'_{12}+x'_{13} = 2+1.5+0.5=4$. This is consistent.\nSince all $x'_{ij} \\ge 0$, the new solution is feasible, validating the assumption.\n\nNow, compute the new objective value $Z'$:\n$Z' = c_{11}x'_{11} + c_{12}x'_{12} + c_{13}x'_{13} + c_{22}x'_{22} = (2)(2) + (3)(1.5) + (0)(0.5) + (1)(3) = 4 + 4.5 + 0 + 3 = 11.5$.\n\nThe change in the objective value is $\\Delta Z = Z' - Z = 11.5 - 10 = 1.5$.\nThe finite-difference marginal cost per unit is $\\frac{\\Delta Z}{\\varepsilon} = \\frac{1.5}{0.5} = 3$.\n\nNext, we compute the demand-side dual price difference $v_2 - v_3$ from part (a).\nUsing the dual solution from part (a), $(v_1, v_2, v_3) = (2, 3, 0)$.\n$v_2 - v_3 = 3 - 0 = 3$.\n\n### Part (c): Absolute Discrepancy\n\nThe absolute discrepancy between the two quantities calculated in part (b) is:\n$D = \\left| \\frac{\\Delta Z}{\\varepsilon} - (v_2 - v_3) \\right| = |3 - 3| = 0$.\n\nThe problem asks to round the final answer to four significant figures. The calculated value is exactly zero. Representing zero to four significant figures can be ambiguous, but the value itself is exactly $0$. Therefore, rounding is not strictly necessary. The most accurate representation is simply $0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "3193102"}]}