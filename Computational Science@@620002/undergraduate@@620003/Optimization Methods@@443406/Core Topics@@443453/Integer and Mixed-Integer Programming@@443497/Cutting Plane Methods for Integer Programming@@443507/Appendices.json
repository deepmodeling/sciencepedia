{"hands_on_practices": [{"introduction": "The journey into cutting plane methods begins with understanding why they are necessary. Often, standard modeling techniques like the \"big-$M$\" method can lead to weak linear programming (LP) relaxations, hindering the search for an optimal integer solution. This first exercise [@problem_id:3115608] provides a foundational link between strengthening a formulation and generating a cutting plane, demonstrating how deriving the tightest possible big-$M$ value leads directly to the strongest valid inequality, the convex hull cut.", "problem": "A binary decision variable $x \\in \\{0,1\\}$ and a continuous variable $y \\in \\mathbb{R}$ model a logic implication requiring that whenever $x=1$ holds, the continuous variable must satisfy $y \\leq b$. You are given the data $b=7$ and known, valid bounds on $y$, namely $2 \\leq y \\leq 11$. A naïve big-$M$ encoding takes the form $y \\leq b + M(1 - x)$ with a large constant $M$, but choosing $M$ too large yields a weak linear programming relaxation.\n\nWorking from first principles and core definitions, do the following:\n\n1) Encode the implication $x=1 \\Rightarrow y \\leq b$ using a big-$M$ inequality. Explain the validity condition that $M$ must satisfy relative to the known upper bound on $y$ so that the encoding does not cut off any feasible point when $x=0$.\n\n2) Using only the known bounds on $y$, derive the smallest valid value of $M$ that preserves correctness of the implication for all $x \\in \\{0,1\\}$.\n\n3) Consider the linear programming relaxation where $x \\in [0,1]$. Using the principle of mixed-integer rounding (MIR) applied to the big-$M$ inequality together with the bound information on $y$, derive a single valid linear inequality in $(x,y)$ that\n- is satisfied by all integer-feasible points with $x \\in \\{0,1\\}$,\n- cuts off the fractional point $(x,y)=(0.4,11)$ that is feasible for the naïve big-$M$ with a very large $M$, and\n- coincides with the convex hull of the two cases $x=0$ and $x=1$ as they constrain $y$.\n\nExpress your final result in the form $y \\leq \\alpha + \\beta x$ and provide the explicit expression $\\alpha + \\beta x$ as your answer. No rounding is required.", "solution": "The problem will be addressed in three parts as requested, after validating the problem statement.\n\nFirst, the problem is validated against the required criteria.\n**Step 1: Extract Givens**\n- Binary decision variable: $x \\in \\{0, 1\\}$\n- Continuous variable: $y \\in \\mathbb{R}$\n- Logical implication to be modeled: $x=1 \\Rightarrow y \\leq b$\n- Given constant: $b=7$\n- Known bounds on the continuous variable: $2 \\leq y \\leq 11$. We denote the lower bound as $L=2$ and the upper bound as $U=11$.\n- Proposed big-$M$ inequality form: $y \\leq b + M(1 - x)$\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded within the established mathematical field of optimization and integer programming. The concepts of big-$M$ formulations, linear programming relaxations, and cutting planes (specifically mixed-integer rounding) are standard and well-defined. The problem is well-posed, objective, and self-contained, providing all necessary data ($b=7$, bounds on $y$) to derive a unique solution. The data is consistent and does not contain any contradictions. The problem does not exhibit any of the flaws listed in the instructions, such as being unsound, trivial, or ambiguous.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\n**Part 1: Big-$M$ Formulation and Validity Condition**\n\nThe logical implication to be encoded is $x=1 \\Rightarrow y \\leq b$. We are given the big-$M$ inequality form $y \\leq b + M(1 - x)$, where $M$ is a sufficiently large positive constant. We analyze this inequality for the two possible integer values of $x$.\n\nCase 1: $x=1$.\nThe inequality becomes $y \\leq b + M(1-1)$, which simplifies to $y \\leq b$. This correctly enforces the consequent of the implication, as required.\n\nCase 2: $x=0$.\nThe premise of the implication ($x=1$) is false, so the implication is vacuously true. In this case, the big-$M$ constraint should not impose any new restrictions on $y$ beyond its pre-existing bounds, which are given as $2 \\leq y \\leq 11$. The upper bound is $y \\leq 11$.\nWhen $x=0$, the inequality becomes $y \\leq b + M(1-0)$, which simplifies to $y \\leq b+M$.\nFor this constraint to be non-restrictive with respect to the known upper bound on $y$ (let's call it $U=11$), the new upper limit $b+M$ must be greater than or equal to $U$.\nTherefore, the validity condition is $b+M \\geq U$.\nThis can be rewritten to provide a condition on $M$:\n$M \\geq U - b$.\nAny value of $M$ satisfying this condition ensures that if $x=0$, the constraint $y \\leq b+M$ is redundant, as $y$ is already known to be bounded by $y \\leq U$. If $M < U-b$, then $b+M < U$, and the constraint $y \\leq b+M$ would incorrectly cut off feasible solutions where $x=0$ and $b+M < y \\leq U$.\n\n**Part 2: Smallest Valid Value of $M$**\n\nFrom Part 1, the condition for $M$ to yield a valid formulation is $M \\geq U - b$. To create the tightest possible linear programming relaxation, we should choose the smallest possible valid value for $M$.\nThe smallest value of $M$ that satisfies this inequality is $M = U - b$.\nUsing the given data:\n- The upper bound on $y$ is $U=11$.\n- The constant from the implication is $b=7$.\n\nSubstituting these values, we find the smallest valid $M$:\n$$M_{\\text{min}} = U - b = 11 - 7 = 4$$\n\n**Part 3: Derivation of the Mixed-Integer Rounding (MIR) Cut**\n\nThe problem asks us to derive a single valid linear inequality that represents the convex hull of the feasible region, using the principle of mixed-integer rounding. This is equivalent to deriving the tightest possible linear inequality for the problem. This can be achieved by substituting the smallest valid $M$ (derived in Part 2) into the general big-$M$ inequality. This procedure is a specific instance of generating a disjunctive cut, which is a form of MIR cut.\n\nLet's start with the big-$M$ inequality:\n$$y \\leq b + M(1 - x)$$\nSubstitute the tightest value $M = U - b$:\n$$y \\leq b + (U-b)(1 - x)$$\nNow, we expand and simplify the right-hand side of the inequality:\n$$y \\leq b + (U-b) - (U-b)x$$\n$$y \\leq U - (U-b)x$$\nThis is the strongest possible linear inequality for $0 \\leq x \\leq 1$ that is valid for the original integer problem. Let's substitute the given numerical values, $U=11$ and $b=7$:\n$$y \\leq 11 - (11-7)x$$\n$$y \\leq 11 - 4x$$\nThis inequality is of the form $y \\leq \\alpha + \\beta x$ with $\\alpha=11$ and $\\beta=-4$.\n\nWe verify this inequality against the problem's criteria:\n1.  **Satisfied by all integer-feasible points:**\n    - If $x=0$: The inequality becomes $y \\leq 11$. The feasible region for $x=0$ is $2 \\leq y \\leq 11$, so this is satisfied.\n    - If $x=1$: The inequality becomes $y \\leq 11 - 4(1) = 7$. The feasible region for $x=1$ is $y \\leq 7$ (and $y \\geq 2$), so this is satisfied.\n    The inequality is valid for all integer points.\n\n2.  **Cuts off the fractional point $(x,y)=(0.4, 11)$:**\n    Substitute the point into our derived inequality:\n    $$11 \\leq 11 - 4(0.4)$$\n    $$11 \\leq 11 - 1.6$$\n    $$11 \\leq 9.4$$\n    This statement is false. Thus, the inequality correctly cuts off the fractional point $(0.4, 11)$, which would have been feasible under a naïve (weaker) LP relaxation (e.g., using a very large $M$).\n\n3.  **Coincides with the convex hull:**\n    The feasible set of the mixed-integer problem is the union of two line segments: $\\{(0,y) | 2 \\leq y \\leq 11\\}$ and $\\{(1,y) | 2 \\leq y \\leq 7\\}$. The convex hull of this set is a quadrilateral with vertices at $(0,2)$, $(0,11)$, $(1,7)$, and $(1,2)$. The upper boundary of this convex region is the line segment connecting the points $(0,11)$ and $(1,7)$. The equation of the line passing through these two points is $y = (7-11)x + 11$, which simplifies to $y = -4x + 11$. Our derived inequality $y \\leq 11 - 4x$ precisely defines this upper boundary.\n\nThe explicit expression $\\alpha + \\beta x$ is therefore $11 - 4x$.", "answer": "$$\\boxed{11 - 4x}$$", "id": "3115608"}, {"introduction": "Once an LP relaxation yields a fractional solution, the core task is to generate a cut that separates this point from the integer feasible region. This practice [@problem_id:3115646] walks you through the mechanics of one of the most famous techniques: the Gomory fractional cut. By working directly with rows from a final simplex tableau, you will learn the systematic procedure for deriving these cuts and explore the practical question of how to select the most effective cut when multiple candidates are available.", "problem": "Consider a pure Integer Linear Programming (ILP) problem with all decision variables constrained to be nonnegative integers. Its Linear Programming (LP) relaxation has been solved to optimality using the simplex method, yielding a fractional basic feasible solution. In the final simplex tableau, the current nonbasic variables are $x_{1}$, $x_{2}$, $x_{3}$, and $x_{4}$, and the following three basic variable rows are recorded:\n$$\nx_{5} \\;=\\; 2.75 \\;+\\; 0.60\\,x_{1} \\;+\\; 1.20\\,x_{2} \\;+\\; 0.90\\,x_{3} \\;+\\; 0.30\\,x_{4},\n$$\n$$\nx_{6} \\;=\\; 1.30 \\;+\\; 0.10\\,x_{1} \\;+\\; 0.50\\,x_{2} \\;+\\; 1.70\\,x_{3} \\;+\\; 0.80\\,x_{4},\n$$\n$$\nx_{7} \\;=\\; 3.40 \\;+\\; 0.20\\,x_{1} \\;+\\; 2.30\\,x_{2} \\;+\\; 0.40\\,x_{3} \\;+\\; 0.60\\,x_{4}.\n$$\nAt the current LP optimum $x^{*}$, the nonbasic variables satisfy $x_{1}=x_{2}=x_{3}=x_{4}=0$, so the basic variables take the fractional values $x_{5}=2.75$, $x_{6}=1.30$, and $x_{7}=3.40$.\n\nUsing only core definitions and well-tested facts about ILP, LP relaxation, and cutting planes, do the following:\n1. From each tableau row, derive the associated Gomory fractional cut that is valid for the ILP.\n2. For each derived cut, determine its geometric efficacy at the point $x^{*}$, understood as the signed violation of the cut by $x^{*}$ divided by the Euclidean norm of the cut’s normal vector.\n3. Identify the cut with the largest geometric efficacy and report the numerical value of that maximum efficacy.\n\nRound your final numerical answer to four significant figures.", "solution": "The derivation of the Gomory fractional cut begins with a generic row from the optimal simplex tableau, which can be written as:\n$$ x_B + \\sum_{j \\in N} \\bar{a}_{Bj} x_j = \\bar{b}_B $$\nwhere $x_B$ is a basic variable, $N$ is the set of nonbasic variables, $\\bar{b}_B$ is the current (potentially fractional) value of $x_B$, and $\\bar{a}_{Bj}$ are the constraint coefficients.\n\nBy decomposing each coefficient into its integer and fractional parts (e.g., $\\bar{b}_B = \\lfloor \\bar{b}_B \\rfloor + f_B$, where $f_B \\in [0, 1)$), and using the fact that all variables must be integers in the final solution, we can derive the valid inequality:\n$$ \\sum_{j \\in N} f(\\bar{a}_{Bj}) x_j \\ge f_B $$\nwhere $f(z) = z - \\lfloor z \\rfloor$ is the fractional part of $z$. Note that for negative numbers, the fractional part is positive, e.g., $f(-1.2) = -1.2 - \\lfloor -1.2 \\rfloor = -1.2 - (-2) = 0.8$.\n\nThe problem presents the tableau rows in the form $x_B = b + \\sum c_j x_j$. This is equivalent to the standard form $x_B - \\sum c_j x_j = b$, where $\\bar{b}_B = b$ and $\\bar{a}_{Bj} = -c_j$.\n\n**1. Derivation of Gomory Cuts**\n\n*   **Cut from Row 1 ($x_5$):**\n    The equation is $x_5 - 0.60x_1 - 1.20x_2 - 0.90x_3 - 0.30x_4 = 2.75$.\n    - Fractional part of RHS: $f(2.75) = 0.75$.\n    - Fractional parts of coefficients: $f(-0.60)=0.40$, $f(-1.20)=0.80$, $f(-0.90)=0.10$, $f(-0.30)=0.70$.\n    - **Cut 1 (C1):** $0.40 x_1 + 0.80 x_2 + 0.10 x_3 + 0.70 x_4 \\ge 0.75$.\n\n*   **Cut from Row 2 ($x_6$):**\n    The equation is $x_6 - 0.10x_1 - 0.50x_2 - 1.70x_3 - 0.80x_4 = 1.30$.\n    - Fractional part of RHS: $f(1.30) = 0.30$.\n    - Fractional parts of coefficients: $f(-0.10)=0.90$, $f(-0.50)=0.50$, $f(-1.70)=0.30$, $f(-0.80)=0.20$.\n    - **Cut 2 (C2):** $0.90 x_1 + 0.50 x_2 + 0.30 x_3 + 0.20 x_4 \\ge 0.30$.\n\n*   **Cut from Row 3 ($x_7$):**\n    The equation is $x_7 - 0.20x_1 - 2.30x_2 - 0.40x_3 - 0.60x_4 = 3.40$.\n    - Fractional part of RHS: $f(3.40) = 0.40$.\n    - Fractional parts of coefficients: $f(-0.20)=0.80$, $f(-2.30)=0.70$, $f(-0.40)=0.60$, $f(-0.60)=0.40$.\n    - **Cut 3 (C3):** $0.80 x_1 + 0.70 x_2 + 0.60 x_3 + 0.40 x_4 \\ge 0.40$.\n\n**2. Calculation of Geometric Efficacy**\n\nGeometric efficacy is defined as the signed violation of the cut by the current LP solution $x^*$ divided by the Euclidean norm of the cut's normal vector. For a cut $a^\\top x \\ge b$ and the current solution $x^*=0$ (in the space of non-basic variables), the violation amount is $b$. Efficacy is interpreted as the geometric depth of the cut, $\\frac{b}{\\|a\\|}$.\n\n*   **Efficacy of C1:**\n    $E_1 = \\frac{0.75}{\\sqrt{0.40^2 + 0.80^2 + 0.10^2 + 0.70^2}} = \\frac{0.75}{\\sqrt{0.16 + 0.64 + 0.01 + 0.49}} = \\frac{0.75}{\\sqrt{1.30}} \\approx 0.65778$.\n\n*   **Efficacy of C2:**\n    $E_2 = \\frac{0.30}{\\sqrt{0.90^2 + 0.50^2 + 0.30^2 + 0.20^2}} = \\frac{0.30}{\\sqrt{0.81 + 0.25 + 0.09 + 0.04}} = \\frac{0.30}{\\sqrt{1.19}} \\approx 0.27500$.\n\n*   **Efficacy of C3:**\n    $E_3 = \\frac{0.40}{\\sqrt{0.80^2 + 0.70^2 + 0.60^2 + 0.40^2}} = \\frac{0.40}{\\sqrt{0.64 + 0.49 + 0.36 + 0.16}} = \\frac{0.40}{\\sqrt{1.65}} \\approx 0.31139$.\n\n**3. Identification of Maximum Efficacy**\n\nComparing the three values:\n- $E_1 \\approx 0.6578$\n- $E_2 \\approx 0.2750$\n- $E_3 \\approx 0.3114$\n\nThe largest geometric efficacy belongs to the first cut. Rounding this value to four significant figures gives $0.6578$.", "answer": "$$\\boxed{0.6578}$$", "id": "3115646"}, {"introduction": "After mastering the generation of cuts, a deeper question arises: what makes a cut truly useful? It is tempting to believe that the \"deepest\" cut—the one that cuts off the fractional solution by the largest margin—is always the best. This insightful exercise [@problem_id:3115638] challenges that intuition by presenting a scenario where a geometrically deep cut provides zero improvement to the objective function bound. This practice highlights the critical relationship between a cut's orientation and the objective function, a crucial concept for understanding the practical performance of cutting plane algorithms.", "problem": "Consider the following $0$-$1$ knapsack Integer Programming (IP) instance designed to illustrate the interplay between cut efficacy and objective-parallelism:\n\nMaximize the linear objective\n$$c^{\\top}x = x_{1}$$\nsubject to the knapsack constraint\n$$x_{1} + 5x_{2} + 5x_{3} + 5x_{4} \\leq 14.9,$$\nand the integrality and bound constraints\n$$x_{i} \\in \\{0,1\\} \\text{ for } i \\in \\{1,2,3,4\\}, \\quad 0 \\leq x_{i} \\leq 1.$$\n\nConsider the Linear Programming (LP) relaxation obtained by replacing $x_{i} \\in \\{0,1\\}$ with $0 \\leq x_{i} \\leq 1$. In this relaxation, define the vector of weights $w = (1,5,5,5)$, capacity $b = 14.9$, and the objective vector $c = (1,0,0,0)$. Let $C = \\{2,3,4\\}$ be a cover, meaning $\\sum_{i \\in C} w_{i} > b$, and consider the corresponding valid cover inequality (cut)\n$$x_{2} + x_{3} + x_{4} \\leq 2.$$\n\nUsing foundational definitions from Integer Programming and Linear Programming (feasible region, LP relaxation, cover inequality validity for $0$-$1$ knapsack problems), answer the following:\n\n1. Derive the optimal extreme point $x^{\\star}$ of the LP relaxation for the given objective and constraints.\n2. Compute the violation of the cover cut at $x^{\\star}$ and the Euclidean perpendicular distance from $x^{\\star}$ to the hyperplane defined by the cut. Use the standard Euclidean norm to define this perpendicular distance.\n3. Determine the parallelism angle between the cut hyperplane and the objective direction. Interpret the parallelism angle as the angle between the objective vector and the hyperplane, which equals the complement of the angle between the objective vector and the cut normal.\n4. Compute the LP bound improvement in the objective value due to adding the cut, defined as the difference between the optimal LP objective value before the cut and the optimal LP objective value after the cut.\n\nProvide the value of the LP bound improvement as your final answer. No rounding is required. Express the final answer as a single real number without units.", "solution": "This problem requires a four-part analysis of a cutting plane applied to the LP relaxation of a $0-1$ knapsack problem.\n\n**1. Derive the optimal extreme point $x^{\\star}$ of the LP relaxation.**\n\nThe LP relaxation is:\nMaximize $z = x_1$\nSubject to:\n$x_{1} + 5x_{2} + 5x_{3} + 5x_{4} \\leq 14.9$\n$0 \\leq x_i \\leq 1$ for $i \\in \\{1,2,3,4\\}$\n\nThis is a continuous knapsack problem. An optimal basic feasible solution can be found using the greedy approach based on the objective-to-weight ratio ($c_i/w_i$). Item 1 has the highest ratio ($1/1=1$), while others have a ratio of 0.\n1.  Set $x_1=1$. Remaining capacity: $14.9 - 1 = 13.9$.\n2.  Set $x_2=1$. Remaining capacity: $13.9 - 5 = 8.9$.\n3.  Set $x_3=1$. Remaining capacity: $8.9 - 5 = 3.9$.\n4.  Set $x_4 = 3.9/5 = 0.78$.\n\nThe resulting LP optimal solution is $x^{\\star} = (1, 1, 1, 0.78)$. The optimal objective value is $z_{LP} = x_1^{\\star} = 1$.\n\n**2. Compute the violation and distance.**\n\nThe cover cut is $x_{2} + x_{3} + x_{4} \\leq 2$. At $x^{\\star}$, the left-hand side (LHS) is $1 + 1 + 0.78 = 2.78$.\n- **Violation:** The amount by which the LHS exceeds the RHS is $2.78 - 2 = 0.78$.\n- **Distance:** The cut hyperplane is $x_2+x_3+x_4-2=0$, with normal vector $a = (0, 1, 1, 1)^{\\top}$. The Euclidean perpendicular distance from $x^{\\star}$ to this hyperplane is:\n$$ d = \\frac{|a^{\\top}x^{\\star} - 2|}{\\|a\\|_2} = \\frac{|(0)(1) + (1)(1) + (1)(1) + (1)(0.78) - 2|}{\\sqrt{0^2 + 1^2 + 1^2 + 1^2}} = \\frac{|2.78 - 2|}{\\sqrt{3}} = \\frac{0.78}{\\sqrt{3}} $$\n\n**3. Determine the parallelism angle.**\n\nThe parallelism angle is the complement of the angle $\\theta$ between the objective vector $c = (1, 0, 0, 0)^{\\top}$ and the cut normal vector $a = (0, 1, 1, 1)^{\\top}$.\nThe dot product is $c \\cdot a = (1)(0) + (0)(1) + (0)(1) + (0)(1) = 0$.\nSince the dot product is zero, the vectors are orthogonal ($\\theta = 90^{\\circ}$). The parallelism angle (angle between vector and plane) is $90^{\\circ} - \\theta = 0^{\\circ}$. This means the objective direction is parallel to the cutting plane.\n\n**4. Compute the LP bound improvement.**\n\nThe new LP problem is:\nMaximize $z' = x_1$\nSubject to:\n$x_{1} + 5x_{2} + 5x_{3} + 5x_{4} \\leq 14.9$\n$x_{2} + x_{3} + x_{4} \\leq 2$ (new cut)\n$0 \\leq x_i \\leq 1$ for $i \\in \\{1,2,3,4\\}$\n\nThe original optimal objective value was $z_{LP} = 1$. We check if this value is still attainable. A feasible solution to the new LP is, for example, $(x_1, x_2, x_3, x_4) = (1, 1, 1, 0)$. This point satisfies all constraints:\n- $1 + 5(1) + 5(1) + 5(0) = 11 \\leq 14.9$.\n- $1 + 1 + 0 = 2 \\leq 2$.\n- All variables are in $[0,1]$.\nThe objective value for this point is $x_1=1$. Since the objective cannot exceed 1, the new optimal value is $z'_{LP} = 1$.\nThe LP bound improvement is $z_{LP} - z'_{LP} = 1 - 1 = 0$.", "answer": "$$\\boxed{0}$$", "id": "3115638"}]}