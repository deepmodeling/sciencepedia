{"hands_on_practices": [{"introduction": "Linear Programming (LP) represents the ideal setting for duality, where the relationship between a problem and its dual is exceptionally elegant and powerful. This first exercise provides a hands-on exploration of this foundational concept. By deriving the dual of a standard LP from first principles [@problem_id:3139594], you will uncover the beautiful symmetry between the primal and dual problems, rather than just memorizing the transformation rules. You will then apply this theory to a concrete example, using the Karush-Kuhn-Tucker (KKT) conditions and complementary slackness to simultaneously find the optimal primal and dual solutions, witnessing strong duality in action.", "problem": "Consider the following minimization Linear Programming (LP) problem in standard inequality form: minimize the linear objective subject to linear inequality constraints and nonnegativity constraints,\n$$\\min_{x \\in \\mathbb{R}^{n}} \\; c^{\\top} x \\quad \\text{subject to} \\quad A x \\ge b, \\; x \\ge 0,$$\nwhere $A \\in \\mathbb{R}^{m \\times n}$, $b \\in \\mathbb{R}^{m}$, and $c \\in \\mathbb{R}^{n}$. Using the foundational Lagrangian duality framework and the definitions of weak and strong duality (without invoking any pre-memorized dual formula), derive the dual optimization problem corresponding to the above primal problem by introducing appropriate nonnegative Lagrange multipliers for each inequality constraint. Clearly state the resulting dual decision variables, constraints, and objective function.\n\nNext, specialize to the concrete instance with dimension $m = 3$ and $n = 2$ given by\n$$A = \\begin{pmatrix} 2 & 0 \\\\ 0 & 3 \\\\ 1 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 4 \\\\ 3 \\\\ 5 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}.$$\nUse complementary slackness, derived from the Karush-Kuhn-Tucker (KKT) conditions for LP, to determine which of the primal constraints $A x \\ge b$ bind at optimality and which are slack for this instance. Then, infer a dual optimal solution and verify optimality via strong duality. Finally, compute the optimal primal objective value $c^{\\top} x^{\\star}$ for this instance and express it as an exact real number. No rounding is required for the final answer.", "solution": "The user has provided a multipart problem concerning Linear Programming (LP) duality. The first part requires a formal derivation of the dual problem from first principles using the Lagrangian framework. The second part involves applying this theory to a specific LP instance to find primal and dual optimal solutions, verify optimality, and determine the optimal objective value.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem provides the following:\n1.  A primal LP problem in standard inequality form:\n    $$\\min_{x \\in \\mathbb{R}^{n}} \\; c^{\\top} x \\quad \\text{subject to} \\quad A x \\ge b, \\; x \\ge 0$$\n    where $A \\in \\mathbb{R}^{m \\times n}$, $b \\in \\mathbb{R}^{m}$, and $c \\in \\mathbb{R}^{n}$.\n2.  A task to derive the dual problem using the Lagrangian framework, introducing nonnegative Lagrange multipliers.\n3.  A specific instance with dimensions $m = 3$ and $n = 2$:\n    $$A = \\begin{pmatrix} 2 & 0 \\\\ 0 & 3 \\\\ 1 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 4 \\\\ 3 \\\\ 5 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}$$\n4.  A task to use complementary slackness to determine which primal constraints $A x \\ge b$ are binding at optimality for this instance, infer a dual optimal solution, verify optimality via strong duality, and compute the optimal primal objective value $c^{\\top} x^{\\star}$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is a standard, fundamental exercise in the field of mathematical optimization, specifically concerning duality theory in linear programming.\n-   **Scientifically Grounded:** The problem is based entirely on established mathematical principles of optimization and linear algebra. It is free of any scientific or factual unsoundness.\n-   **Well-Posed:** The problem is clearly structured. The derivation requested is a standard procedure, and the specific LP instance is well-defined and has a unique optimal solution, making it a well-posed problem.\n-   **Objective:** The language is precise, mathematical, and free of any subjectivity or ambiguity.\n-   **Completeness:** All necessary data ($A, b, c$) and theoretical context (Lagrangian duality, KKT conditions, complementary slackness) are provided or are standard prerequisites for such a problem. The problem is self-contained.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. It is a well-posed, scientifically grounded, and objective question in mathematical optimization. I will proceed with a full solution.\n\n### Part 1: Derivation of the Dual Problem\n\nThe primal problem is given as:\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\; c^{\\top} x \\quad \\text{subject to} \\quad A x \\ge b, \\; x \\ge 0\n$$\nTo apply the Lagrangian framework, we first express the inequality constraints in the form $f_i(x) \\le 0$. The constraints are:\n1.  $A x \\ge b \\iff b - A x \\le 0$ (a set of $m$ inequalities)\n2.  $x \\ge 0 \\iff -x \\le 0$ (a set of $n$ inequalities)\n\nWe introduce nonnegative Lagrange multipliers for each of these constraints. Let $\\lambda \\in \\mathbb{R}^m$ be the vector of multipliers for the constraints $b - A x \\le 0$, so $\\lambda \\ge 0$. Let $\\mu \\in \\mathbb{R}^n$ be the vector of multipliers for the constraints $-x \\le 0$, so $\\mu \\ge 0$.\n\nThe Lagrangian function $L(x, \\lambda, \\mu)$ is defined as the objective function plus the sum of multipliers times their corresponding constraint functions:\n$$\nL(x, \\lambda, \\mu) = c^{\\top} x + \\lambda^{\\top}(b - A x) + \\mu^{\\top}(-x)\n$$\nWe can rearrange the terms by collecting those involving the primal variable $x$:\n$$\nL(x, \\lambda, \\mu) = c^{\\top} x - \\lambda^{\\top} A x - \\mu^{\\top} x + \\lambda^{\\top} b\n$$\n$$\nL(x, \\lambda, \\mu) = (c^{\\top} - \\lambda^{\\top} A - \\mu^{\\top})x + b^{\\top} \\lambda\n$$\nThis can be written more compactly using transposes:\n$$\nL(x, \\lambda, \\mu) = (c - A^{\\top} \\lambda - \\mu)^{\\top}x + b^{\\top} \\lambda\n$$\nThe Lagrange dual function, denoted $g(\\lambda, \\mu)$, is defined as the infimum of the Lagrangian over the primal variable $x$:\n$$\ng(\\lambda, \\mu) = \\inf_{x \\in \\mathbb{R}^n} L(x, \\lambda, \\mu) = \\inf_{x \\in \\mathbb{R}^n} \\left[ (c - A^{\\top} \\lambda - \\mu)^{\\top}x + b^{\\top} \\lambda \\right]\n$$\nThe expression inside the infimum is an affine (linear plus constant) function of $x$. If the coefficient vector of $x$ is non-zero, i.e., $c - A^{\\top} \\lambda - \\mu \\ne 0$, then the function is unbounded below, and its infimum is $-\\infty$. To obtain a finite value for the dual function, the linear term in $x$ must vanish. This imposes a constraint on the dual variables $\\lambda$ and $\\mu$:\n$$\nc - A^{\\top} \\lambda - \\mu = 0\n$$\nWhen this condition holds, the Lagrangian becomes independent of $x$, and its value is simply $b^{\\top} \\lambda$. Therefore, the dual function is:\n$$\ng(\\lambda, \\mu) = \\begin{cases}\nb^{\\top}\\lambda & \\text{if } c - A^{\\top}\\lambda - \\mu = 0 \\\\\n-\\infty & \\text{otherwise}\n\\end{cases}\n$$\nThe dual problem is to maximize the dual function subject to the constraints on the dual variables:\n$$\n\\max_{\\lambda, \\mu} \\; g(\\lambda, \\mu) \\quad \\text{subject to} \\quad \\lambda \\ge 0, \\; \\mu \\ge 0\n$$\nMaximizing $g(\\lambda, \\mu)$ is equivalent to maximizing $b^{\\top}\\lambda$ subject to the condition that makes $g(\\lambda, \\mu)$ finite. The dual problem is thus:\n$$\n\\max_{\\lambda, \\mu} \\; b^{\\top}\\lambda \\quad \\text{subject to} \\quad c - A^{\\top}\\lambda - \\mu = 0, \\quad \\lambda \\ge 0, \\quad \\mu \\ge 0\n$$\nWe can eliminate the dual variable $\\mu$. The constraint $c - A^{\\top}\\lambda - \\mu = 0$ implies $\\mu = c - A^{\\top}\\lambda$. The nonnegativity constraint $\\mu \\ge 0$ then becomes $c - A^{\\top}\\lambda \\ge 0$, which is equivalent to $A^{\\top}\\lambda \\le c$.\n\nSubstituting this back into the optimization problem, we obtain the dual problem solely in terms of the dual variable $\\lambda$:\n-   Dual decision variables: $\\lambda \\in \\mathbb{R}^m$.\n-   Dual objective function: Maximize $b^{\\top}\\lambda$.\n-   Dual constraints: $A^{\\top}\\lambda \\le c$ and $\\lambda \\ge 0$.\n\nThe resulting dual problem is:\n$$\n\\max_{\\lambda \\in \\mathbb{R}^{m}} \\; b^{\\top} \\lambda \\quad \\text{subject to} \\quad A^{\\top}\\lambda \\le c, \\; \\lambda \\ge 0\n$$\n\n### Part 2: Analysis of the Concrete Instance\n\nThe problem gives the concrete instance:\n$$A = \\begin{pmatrix} 2 & 0 \\\\ 0 & 3 \\\\ 1 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 4 \\\\ 3 \\\\ 5 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}$$\nLet $x = (x_1, x_2)^{\\top}$. The primal problem is:\n$$\n\\min_{x_1, x_2} \\; 5x_1 + 4x_2\n$$\nsubject to:\n$$\n\\begin{align*}\n2x_1 &\\ge 4 \\\\\n3x_2 &\\ge 3 \\\\\nx_1 + x_2 &\\ge 5 \\\\\nx_1, x_2 &\\ge 0\n\\end{align*}\n$$\nThese constraints simplify to $x_1 \\ge 2$, $x_2 \\ge 1$, and $x_1 + x_2 \\ge 5$. The nonnegativity constraints $x_1 \\ge 0, x_2 \\ge 0$ are redundant.\n\nTo find the optimal primal solution $x^{\\star}$, we can examine the vertices of the feasible region. The boundaries are $x_1=2$, $x_2=1$, and $x_1+x_2=5$. The vertices are the feasible intersections of these lines.\n-   Intersection of $x_1=2$ and $x_1+x_2=5$: $2+x_2=5 \\implies x_2=3$. The point is $(2, 3)$, which is feasible.\n-   Intersection of $x_2=1$ and $x_1+x_2=5$: $x_1+1=5 \\implies x_1=4$. The point is $(4, 1)$, which is feasible.\nThe objective function is $z(x_1, x_2) = 5x_1 + 4x_2$. We evaluate it at the vertices:\n-   At $(2, 3)$: $z = 5(2) + 4(3) = 10 + 12 = 22$.\n-   At $(4, 1)$: $z = 5(4) + 4(1) = 20 + 4 = 24$.\nThe minimum objective value is $22$, occurring at the optimal primal solution $x^{\\star} = (2, 3)^{\\top}$.\n\nNow we determine which constraints of $A x \\ge b$ are binding at $x^{\\star} = (2, 3)$:\n1.  $2x_1^{\\star} \\ge 4 \\implies 2(2) = 4$. This is **binding**.\n2.  $3x_2^{\\star} \\ge 3 \\implies 3(3) = 9 > 3$. This is **slack**.\n3.  $x_1^{\\star} + x_2^{\\star} \\ge 5 \\implies 2+3 = 5$. This is **binding**.\n\nThe Karush-Kuhn-Tucker (KKT) conditions for an LP imply complementary slackness. Let $\\lambda = (\\lambda_1, \\lambda_2, \\lambda_3)^{\\top}$ be the dual variable. The complementary slackness conditions are:\n-   $\\lambda_i ((Ax^{\\star})_i - b_i) = 0$ for $i=1, 2, 3$.\n-   $(c - A^{\\top}\\lambda^{\\star})_j x_j^{\\star} = 0$ for $j=1, 2$.\n\nFrom the first set of conditions, since the second primal constraint is slack, its corresponding dual variable must be zero: $\\lambda_2^{\\star} = 0$.\n\nFrom the second set of conditions:\n-   For $j=1$: $x_1^{\\star} = 2 > 0$, so the first dual constraint must be binding: $(A^{\\top}\\lambda^{\\star})_1 = c_1$.\n    Using $A^{\\top} = \\begin{pmatrix} 2 & 0 & 1 \\\\ 0 & 3 & 1 \\end{pmatrix}$, this is $2\\lambda_1^{\\star} + 0\\lambda_2^{\\star} + 1\\lambda_3^{\\star} = 5 \\implies 2\\lambda_1^{\\star} + \\lambda_3^{\\star} = 5$.\n-   For $j=2$: $x_2^{\\star} = 3 > 0$, so the second dual constraint must be binding: $(A^{\\top}\\lambda^{\\star})_2 = c_2$.\n    This is $0\\lambda_1^{\\star} + 3\\lambda_2^{\\star} + 1\\lambda_3^{\\star} = 4 \\implies 3\\lambda_2^{\\star} + \\lambda_3^{\\star} = 4$.\n\nWe now have a system of equations to find the dual optimal solution $\\lambda^{\\star}$:\n1.  $\\lambda_2^{\\star} = 0$\n2.  $2\\lambda_1^{\\star} + \\lambda_3^{\\star} = 5$\n3.  $3\\lambda_2^{\\star} + \\lambda_3^{\\star} = 4$\n\nSubstituting $\\lambda_2^{\\star}=0$ into the third equation gives $3(0) + \\lambda_3^{\\star} = 4$, so $\\lambda_3^{\\star} = 4$.\nSubstituting $\\lambda_3^{\\star}=4$ into the second equation gives $2\\lambda_1^{\\star} + 4 = 5$, so $2\\lambda_1^{\\star} = 1$, which means $\\lambda_1^{\\star} = \\frac{1}{2}$.\nThe inferred dual optimal solution is $\\lambda^{\\star} = (\\frac{1}{2}, 0, 4)^{\\top}$.\n\nTo verify optimality, we use strong duality. We check if the primal and dual objective values are equal.\n-   Primal optimal objective value: $p^{\\star} = c^{\\top}x^{\\star} = 5(2) + 4(3) = 22$.\n-   Dual optimal objective value: $d^{\\star} = b^{\\top}\\lambda^{\\star} = 4\\lambda_1^{\\star} + 3\\lambda_2^{\\star} + 5\\lambda_3^{\\star} = 4(\\frac{1}{2}) + 3(0) + 5(4) = 2 + 0 + 20 = 22$.\n\nSince $p^{\\star} = d^{\\star} = 22$, and both $x^{\\star}$ and $\\lambda^{\\star}$ are feasible for their respective problems (we must check dual feasibility for $\\lambda^{\\star}$: $\\lambda^{\\star} \\ge 0$ is true, and $A^{\\top}\\lambda^{\\star} \\le c$ is true since both constraints hold with equality), we have verified the optimality of both solutions.\n\nThe final request is to compute the optimal primal objective value $c^{\\top}x^{\\star}$. As calculated, this value is $22$.", "answer": "$$\n\\boxed{22}\n$$", "id": "3139594"}, {"introduction": "While strong duality holds for all linear programs, it is not a universal guarantee. The property of convexity is a critical dividing line. This practice [@problem_id:3217490] is designed to provide a clear, tangible example of what happens when convexity is absent. You will analyze a simple non-convex optimization problem and compute its true optimal value, $p^{\\star}$. Then, by carefully constructing and solving the Lagrange dual problem to find its optimal value, $d^{\\star}$, you will discover a non-zero duality gap ($p^{\\star} \\gt d^{\\star}$), vividly illustrating the meaning of weak duality and the limitations of the dual approach for non-convex problems.", "problem": "Consider the following constrained minimization problem with decision variables $x_{1}$ and $x_{2}$:\nMinimize $f(x_{1}, x_{2}) = x_{1} + x_{2}$ subject to the inequality constraints $x_{1} x_{2} \\geq 1$, $x_{1} \\geq 0$, and $x_{2} \\geq 0$.\nThis problem is non-convex when written in the standard inequality form $g_{i}(x_{1}, x_{2}) \\leq 0$ because the function $g(x_{1}, x_{2}) = 1 - x_{1} x_{2}$ is not convex, even though the feasible set is closed and nonempty. Using the foundational definition of the Lagrangian, the dual function as the infimum over the primal variables, and weak duality, determine the exact primal optimal value and the exact dual optimal value for this problem. Then compute the duality gap, defined as $p^{\\star} - d^{\\star}$, where $p^{\\star}$ is the primal optimal value and $d^{\\star}$ is the dual optimal value. Provide your final answer as a single exact number with no units. No rounding is required.", "solution": "The user wants me to solve the following problem:\nMinimize $f(x_{1}, x_{2}) = x_{1} + x_{2}$ subject to the inequality constraints $x_{1} x_{2} \\geq 1$, $x_{1} \\geq 0$, and $x_{2} \\geq 0$.\n\n### Step 1: Extract Givens\n- Objective function to minimize: $f(x_{1}, x_{2}) = x_{1} + x_{2}$.\n- Decision variables: $x_{1}, x_{2}$.\n- Constraints:\n  1. $g_1(x_1, x_2): x_{1} x_{2} \\geq 1$\n  2. $g_2(x_1, x_2): x_{1} \\geq 0$\n  3. $g_3(x_1, x_2): x_{2} \\geq 0$\n- The problem states that expressing the first constraint as $1 - x_1 x_2 \\leq 0$ makes it non-convex.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a well-defined constrained optimization problem in the field of numerical methods and scientific computing.\n- **Scientifically Grounded**: The problem is based on the mathematical principles of optimization theory. All functions are standard algebraic functions. The concepts of Lagrangian duality, primal/dual problems, and duality gap are central to this field. The claim that $g(x_1, x_2) = 1 - x_1 x_2$ is non-convex is correct; its Hessian matrix is $\\begin{pmatrix} 0 & -1 \\\\ -1 & 0 \\end{pmatrix}$, which has eigenvalues $\\pm 1$ and is therefore indefinite.\n- **Well-Posed**: The problem is self-contained. It has a clear objective function and a non-empty feasible region. A unique optimal solution for the primal problem exists. The dual problem is also well-defined.\n- **Objective**: The language is precise and without ambiguity or subjective claims.\n\nThe problem is valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now proceed with the solution.\n\n### Primal Problem\nThe primal problem is to find the minimum value of $f(x_{1}, x_{2}) = x_{1} + x_{2}$ subject to the constraints $x_{1} x_{2} \\geq 1$, $x_{1} \\geq 0$, and $x_{2} \\geq 0$. Let $p^{\\star}$ denote the primal optimal value.\n\nThe constraints $x_{1} \\geq 0$, $x_{2} \\geq 0$, and $x_{1}x_{2} \\geq 1$ imply that we must have $x_{1} > 0$ and $x_{2} > 0$.\nBy the Arithmetic Mean-Geometric Mean (AM-GM) inequality, for any non-negative numbers $x_{1}$ and $x_{2}$, we have:\n$$ \\frac{x_{1} + x_{2}}{2} \\geq \\sqrt{x_{1}x_{2}} $$\nUsing the constraint $x_{1}x_{2} \\geq 1$, we can write:\n$$ \\sqrt{x_{1}x_{2}} \\geq \\sqrt{1} = 1 $$\nCombining these inequalities gives:\n$$ \\frac{x_{1} + x_{2}}{2} \\geq 1 $$\n$$ x_{1} + x_{2} \\geq 2 $$\nThis shows that the objective function $f(x_{1}, x_{2})$ is bounded below by $2$. The minimum value of $2$ is attainable if the equality in the AM-GM inequality holds, which occurs if and only if $x_{1} = x_{2}$.\nSubstituting $x_{1} = x_{2}$ into the constraint $x_{1}x_{2} \\geq 1$, we get:\n$$ x_{1}^{2} \\geq 1 $$\nSince $x_{1} > 0$, this implies $x_{1} \\geq 1$. To achieve the minimum value of the sum $x_1+x_2 = 2x_1$, we must choose the smallest possible value for $x_1$, which is $x_{1} = 1$.\nThis gives the optimal point $(x_{1}^{\\star}, x_{2}^{\\star}) = (1, 1)$. This point satisfies all constraints: $1 \\times 1 = 1 \\geq 1$, $1 \\geq 0$, and $1 \\geq 0$.\nThe primal optimal value is the value of the objective function at this point:\n$$ p^{\\star} = f(1, 1) = 1 + 1 = 2 $$\n\n### Dual Problem\nTo formulate the dual problem, we first write the constraints in the standard form $g_{i}(x) \\leq 0$:\n1. $c_{1}(x_{1}, x_{2}) = 1 - x_{1}x_{2} \\leq 0$\n2. $c_{2}(x_{1}, x_{2}) = -x_{1} \\leq 0$\n3. $c_{3}(x_{1}, x_{2}) = -x_{2} \\leq 0$\n\nThe Lagrangian function $L(x_1, x_2, \\lambda_1, \\lambda_2, \\lambda_3)$ is defined as:\n$$ L(x_{1}, x_{2}, \\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = f(x_{1}, x_{2}) + \\lambda_{1} c_{1}(x_{1}, x_{2}) + \\lambda_{2} c_{2}(x_{1}, x_{2}) + \\lambda_{3} c_{3}(x_{1}, x_{2}) $$\nwhere $\\lambda_{1}, \\lambda_{2}, \\lambda_{3} \\geq 0$ are the Lagrange multipliers (dual variables).\nSubstituting the functions, we have:\n$$ L(x_{1}, x_{2}, \\lambda) = (x_{1} + x_{2}) + \\lambda_{1}(1 - x_{1}x_{2}) + \\lambda_{2}(-x_{1}) + \\lambda_{3}(-x_{2}) $$\nWe can rearrange the terms by gathering coefficients of $x_{1}$ and $x_{2}$:\n$$ L(x_{1}, x_{2}, \\lambda) = (1 - \\lambda_{2})x_{1} + (1 - \\lambda_{3})x_{2} - \\lambda_{1}x_{1}x_{2} + \\lambda_{1} $$\nThe Lagrange dual function $q(\\lambda)$ is the infimum of the Lagrangian over the primal variables $x_{1}$ and $x_{2}$:\n$$ q(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = \\inf_{x_{1}, x_{2} \\in \\mathbb{R}} L(x_{1}, x_{2}, \\lambda_{1}, \\lambda_{2}, \\lambda_{3}) $$\nThe term $L(x_{1}, x_{2}, \\lambda)$ is a function of $x_1, x_2$ that includes a bilinear term $- \\lambda_{1}x_{1}x_{2}$.\nIf $\\lambda_{1} > 0$, this function is a hyperbolic paraboloid, which is unbounded below. For any $\\lambda_1 > 0$, we can choose $x_1=x_2=x$ and let $x \\to \\infty$, which would make $L \\to -\\infty$ due to the $- \\lambda_1 x^2$ term. Thus, the infimum is $-\\infty$ if $\\lambda_{1} > 0$.\nIf $\\lambda_{1} = 0$, the Lagrangian becomes a linear function:\n$$ L(x_{1}, x_{2}, \\lambda) = (1 - \\lambda_{2})x_{1} + (1 - \\lambda_{3})x_{2} $$\nFor the infimum of this linear function over $\\mathbb{R}^2$ to be finite (i.e., not $-\\infty$), the coefficients of $x_{1}$ and $x_{2}$ must be zero. This requires:\n$$ 1 - \\lambda_{2} = 0 \\implies \\lambda_{2} = 1 $$\n$$ 1 - \\lambda_{3} = 0 \\implies \\lambda_{3} = 1 $$\nSo, for the dual function to not be $-\\infty$, the dual variables must satisfy $\\lambda_{1} = 0$, $\\lambda_{2} = 1$, and $\\lambda_{3} = 1$. These values also satisfy the non-negativity constraints $\\lambda_i \\ge 0$.\nAt this specific point $(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = (0, 1, 1)$, the Lagrangian is:\n$$ L(x_{1}, x_{2}, 0, 1, 1) = (1-1)x_{1} + (1-1)x_{2} - 0 \\cdot x_{1}x_{2} + 0 = 0 $$\nThe dual function value at this point is:\n$$ q(0, 1, 1) = \\inf_{x_{1}, x_{2} \\in \\mathbb{R}} 0 = 0 $$\nFor any other set of non-negative dual variables, $q(\\lambda) = -\\infty$.\n\nThe dual problem is to maximize the dual function $q(\\lambda)$ subject to $\\lambda_{i} \\geq 0$:\n$$ d^{\\star} = \\sup_{\\lambda_{1},\\lambda_{2},\\lambda_{3} \\geq 0} q(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) $$\nSince $q(\\lambda)$ is $0$ for one specific point and $-\\infty$ everywhere else, the supremum is $0$:\n$$ d^{\\star} = 0 $$\n\n### Duality Gap\nThe duality gap is the difference between the primal optimal value $p^{\\star}$ and the dual optimal value $d^{\\star}$:\n$$ \\text{Duality Gap} = p^{\\star} - d^{\\star} $$\nSubstituting the computed values:\n$$ \\text{Duality Gap} = 2 - 0 = 2 $$\nThe existence of this non-zero duality gap ($p^{\\star} > d^{\\star}$) is a consequence of the fact that the problem is not convex (specifically, the constraint function $1-x_1x_2$ is not convex), and therefore strong duality does not hold. Weak duality, which states $p^{\\star} \\geq d^{\\star}$, is always true and is satisfied here.", "answer": "$$\n\\boxed{2}\n$$", "id": "3217490"}, {"introduction": "The duality gap is not just a theoretical curiosity; it has profound practical implications in fields like combinatorial optimization. This exercise [@problem_id:3123596] connects the abstract concept of a duality gap to the widely encountered \"integrality gap\" in integer programming. You will investigate a classic binary knapsack problem, which is non-convex due to its discrete variables. By formulating and solving its Linear Programming (LP) relaxation, you will find an optimal value that provides a bound on the true integer solution. This difference, the integrality gap, is a direct manifestation of the duality gap, and this problem will guide you to interpret its magnitude in terms of the physical characteristics of the problem, namely the value densities of the items.", "problem": "Consider the binary knapsack integer program with $3$ items and capacity $10$. Let the weights be $w_1=7$, $w_2=6$, $w_3=4$ and the values be $v_1=15$, $v_2=12$, $v_3=9$. The binary decision variables $x_i\\in\\{0,1\\}$ indicate whether item $i$ is selected. The integer program is to maximize the total value subject to the capacity constraint. Consider its Linear Programming (LP) relaxation where the constraints $x_i\\in\\{0,1\\}$ are replaced by $0\\le x_i\\le 1$, and the dual of this LP relaxation. Work from the fundamental definitions of primal-dual pairs of linear programs, weak duality, and strong duality for linear programs, and from the definition of the binary knapsack problem. Using these, identify the correct statement among the options below that gives:\n- the optimal value of the integer program,\n- the optimal value of the LP relaxation,\n- a dual-feasible solution that certifies the LP relaxation’s optimal value via strong duality,\n- and a correct interpretation of the integrality gap of the LP relaxation as a duality gap for the original nonconvex integer program, including how the magnitude of this gap relates to item value-to-weight densities $v_i/w_i$.\n\nChoose the single correct option.\n\nA. $z_{\\mathrm{IP}}=21$, $z_{\\mathrm{LP}}=\\dfrac{153}{7}$, and there exists a dual-feasible solution with $y^*=\\dfrac{15}{7}$ and $s_1=0$, $s_2=0$, $s_3=\\dfrac{3}{7}$ such that $w_i y^*+s_i\\ge v_i$ for all $i$ and $C y^*+\\sum_i s_i=\\dfrac{153}{7}$. The duality gap for the nonconvex integer program, measured against this LP-dual bound, equals $z_{\\mathrm{LP}}-z_{\\mathrm{IP}}=\\dfrac{6}{7}$, which arises because the LP can take a fractional amount of a high-density item to fill remaining capacity; the closer the item densities $v_i/w_i$ are to one another, the smaller this gap tends to be.\n\nB. $z_{\\mathrm{IP}}=21$, $z_{\\mathrm{LP}}=21$, so the duality gap is $0$ and strong duality holds even for the integer program; the item densities do not affect the gap because fractional decisions are unnecessary.\n\nC. $z_{\\mathrm{IP}}=15$, $z_{\\mathrm{LP}}=22.5$, so the duality gap is $7.5$; this large gap is driven by the low-density items, not by the ability to fractionally include any single high-density item.\n\nD. $z_{\\mathrm{IP}}=21$, $z_{\\mathrm{LP}}=22$ (attained with dual scalar $y=2$), so the duality gap is $1$; the magnitude of the gap is unrelated to value-to-weight densities and is determined only by total capacity.\n\nE. $z_{\\mathrm{IP}}=21$, $z_{\\mathrm{LP}}=\\dfrac{153}{7}$, but the duality gap is $z_{\\mathrm{IP}}-z_{\\mathrm{LP}}=-\\dfrac{6}{7}$; since this is negative, it shows strong duality holds for the integer program, independent of item densities.", "solution": "The user has provided a problem concerning a binary knapsack integer program (IP), its linear programming (LP) relaxation, and the corresponding dual problem. I will first validate the problem statement, then proceed with a full derivation and analysis.\n\n### Problem Validation\n**Step 1: Extract Givens**\n-   Problem: Binary knapsack integer program.\n-   Number of items: $3$.\n-   Knapsack capacity: $C=10$.\n-   Item weights: $w_1=7$, $w_2=6$, $w_3=4$.\n-   Item values: $v_1=15$, $v_2=12$, $v_3=9$.\n-   Decision variables: $x_i \\in \\{0, 1\\}$ for $i \\in \\{1, 2, 3\\}$.\n-   Objective: Maximize $\\sum_{i=1}^3 v_i x_i$.\n-   Constraint: $\\sum_{i=1}^3 w_i x_i \\le C$.\n-   LP Relaxation: The constraints $x_i \\in \\{0, 1\\}$ are replaced by $0 \\le x_i \\le 1$.\n-   Task: Analyze the IP, its LP relaxation, and the dual of the LP relaxation to identify the correct statement among the given options. The statement must correctly identify the optimal IP value ($z_{\\mathrm{IP}}$), the optimal LP relaxation value ($z_{\\mathrm{LP}}$), a corresponding optimal dual solution, and provide a correct interpretation of the integrality gap.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically and mathematically sound. It is a specific, well-defined instance of the knapsack problem, a canonical problem in the field of optimization methods. All data and definitions are standard and self-consistent. The problem is well-posed, objective, and complete, allowing for a unique solution to be derived from first principles. There are no factual errors, ambiguities, or logical flaws.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. I will proceed to the solution.\n\n### Derivation\n\n**1. Integer Program (IP) Formulation and Solution**\n\nThe binary knapsack integer program is formulated as:\n$$\n\\begin{array}{ll}\n\\text{maximize} & z = 15x_1 + 12x_2 + 9x_3 \\\\\n\\text{subject to} & 7x_1 + 6x_2 + 4x_3 \\le 10 \\\\\n& x_1, x_2, x_3 \\in \\{0, 1\\}\n\\end{array}\n$$\nTo find the optimal value $z_{\\mathrm{IP}}$, we can enumerate all feasible combinations due to the small problem size:\n-   $x=(0,0,0)$: weight=$0$, value=$0$.\n-   $x=(1,0,0)$: weight=$7$, value=$15$.\n-   $x=(0,1,0)$: weight=$6$, value=$12$.\n-   $x=(0,0,1)$: weight=$4$, value=$9$.\n-   $x=(1,1,0)$: weight=$7+6=13 > 10$ (infeasible).\n-   $x=(1,0,1)$: weight=$7+4=11 > 10$ (infeasible).\n-   $x=(0,1,1)$: weight=$6+4=10$, value=$12+9=21$.\n-   $x=(1,1,1)$: weight=$7+6+4=17 > 10$ (infeasible).\n\nComparing the values of the feasible solutions ($0$, $15$, $12$, $9$, $21$), the maximum value is $21$.\nThe optimal integer solution is $x_{\\mathrm{IP}}^*=(0, 1, 1)$, and the optimal value is $z_{\\mathrm{IP}} = 21$.\n\n**2. LP Relaxation Formulation and Solution**\n\nThe LP relaxation allows the decision variables to be continuous in the range $[0,1]$:\n$$\n\\begin{array}{ll}\n\\text{maximize} & z = 15x_1 + 12x_2 + 9x_3 \\\\\n\\text{subject to} & 7x_1 + 6x_2 + 4x_3 \\le 10 \\\\\n& 0 \\le x_1 \\le 1, \\quad 0 \\le x_2 \\le 1, \\quad 0 \\le x_3 \\le 1\n\\end{array}\n$$\nThis is a fractional knapsack problem, which can be solved optimally using a greedy approach based on value-to-weight densities ($v_i/w_i$).\n-   Item 1 density: $v_1/w_1 = 15/7 \\approx 2.143$\n-   Item 2 density: $v_2/w_2 = 12/6 = 2$\n-   Item 3 density: $v_3/w_3 = 9/4 = 2.25$\n\nThe items are sorted by decreasing density: Item 3, Item 1, Item 2.\n1.  Select all of Item 3 ($x_3=1$). Weight used: $4$. Remaining capacity: $10 - 4 = 6$.\n2.  Select as much of Item 1 as possible. Item 1 has weight $7$, but only $6$ units of capacity remain. Thus, we take a fraction $x_1 = 6/7$. Weight used: $(6/7) \\times 7 = 6$. Remaining capacity: $6 - 6 = 0$.\n3.  No capacity is left for Item 2, so $x_2=0$.\n\nThe optimal LP solution is $x_{\\mathrm{LP}}^*=(6/7, 0, 1)$. The optimal value $z_{\\mathrm{LP}}$ is:\n$$z_{\\mathrm{LP}} = 15\\left(\\frac{6}{7}\\right) + 12(0) + 9(1) = \\frac{90}{7} + 9 = \\frac{90+63}{7} = \\frac{153}{7}$$\nSo, $z_{\\mathrm{LP}} = 153/7 \\approx 21.857$.\n\n**3. Dual of the LP Relaxation**\n\nThe primal LP can be written as:\n$$\n\\begin{array}{ll}\n\\text{maximize} & 15x_1 + 12x_2 + 9x_3 \\\\\n\\text{subject to} & 7x_1 + 6x_2 + 4x_3 \\le 10 & \\quad (\\text{dual variable } y \\ge 0) \\\\\n& x_1 \\le 1 & \\quad (\\text{dual variable } s_1 \\ge 0) \\\\\n& x_2 \\le 1 & \\quad (\\text{dual variable } s_2 \\ge 0) \\\\\n& x_3 \\le 1 & \\quad (\\text{dual variable } s_3 \\ge 0) \\\\\n& x_1, x_2, x_3 \\ge 0\n\\end{array}\n$$\nThe corresponding dual LP is:\n$$\n\\begin{array}{ll}\n\\text{minimize} & 10y + s_1 + s_2 + s_3 \\\\\n\\text{subject to} & 7y + s_1 \\ge 15 \\\\\n& 6y + s_2 \\ge 12 \\\\\n& 4y + s_3 \\ge 9 \\\\\n& y, s_1, s_2, s_3 \\ge 0\n\\end{array}\n$$\nBy strong duality for linear programs, the optimal value of the dual, $z_D^*$, must equal $z_{\\mathrm{LP}}^*$. We can find the optimal dual solution $(y^*, s_1^*, s_2^*, s_3^*)$ using the complementary slackness conditions with the optimal primal solution $x_{\\mathrm{LP}}^*=(6/7, 0, 1)$.\n-   The primal constraint $x_1 \\le 1$ is slack ($6/7 < 1$), so $s_1^*=0$.\n-   The primal constraint $x_2 \\le 1$ is slack ($0 < 1$), so $s_2^*=0$.\n-   The primal variable $x_1^*$ is non-zero ($x_1^*=6/7$), so the first dual constraint must be tight: $7y^* + s_1^* = 15$. With $s_1^*=0$, we get $7y^*=15$, so $y^*=15/7$.\n-   The primal variable $x_3^*$ is non-zero ($x_3^*=1$), so the third dual constraint must be tight: $4y^* + s_3^* = 9$. Substituting $y^*=15/7$, we get $4(15/7) + s_3^* = 9 \\implies 60/7 + s_3^* = 63/7 \\implies s_3^*=3/7$.\n\nThe optimal dual solution is $(y^*, s_1^*, s_2^*, s_3^*) = (15/7, 0, 0, 3/7)$.\nLet's verify this is a feasible solution: all variables are non-negative.\n-   Constraint 1: $7(15/7)+0 = 15 \\ge 15$ (True).\n-   Constraint 2: $6(15/7)+0 = 90/7 \\approx 12.857 \\ge 12$ (True).\n-   Constraint 3: $4(15/7)+3/7 = 60/7+3/7 = 63/7 = 9 \\ge 9$ (True).\nThe dual objective value is $10y^* + s_1^* + s_2^* + s_3^* = 10(15/7) + 0 + 0 + 3/7 = 150/7 + 3/7 = 153/7$.\nThis matches $z_{\\mathrm{LP}}$, as expected from strong duality.\n\n**4. Integrality Gap and Interpretation**\n\nThe integrality gap for this maximization problem is defined as $z_{\\mathrm{LP}} - z_{\\mathrm{IP}}$.\n$$\n\\text{Gap} = \\frac{153}{7} - 21 = \\frac{153}{7} - \\frac{147}{7} = \\frac{6}{7}\n$$\nThis gap is also the duality gap between the original nonconvex integer program and its Lagrangian dual, whose optimal value is $z_{\\mathrm{LP}}$. The gap arises because the LP relaxation can make a fractional choice that is unavailable to the IP. Here, the LP model fills the last $6$ units of capacity with a fraction $6/7$ of the high-density item 1 (density $15/7 \\approx 2.14$), whereas the IP must pick a combination of whole items, with the best choice being items 2 and 3 (densities $2$ and $2.25$). The ability to fractionally use item 1, which has a higher density than item 2, gives the LP relaxation an advantage. The magnitude of this advantage is related to the difference in item densities. Had all densities been equal, no such advantage could be gained. Thus, larger differences in densities tend to allow for larger integrality gaps.\n\n### Evaluation of Options\n\n**A. $z_{\\mathrm{IP}}=21$, $z_{\\mathrm{LP}}=\\dfrac{153}{7}$, and there exists a dual-feasible solution with $y^*=\\dfrac{15}{7}$ and $s_1=0$, $s_2=0$, $s_3=\\dfrac{3}{7}$ such that $w_i y^*+s_i\\ge v_i$ for all $i$ and $C y^*+\\sum_i s_i=\\dfrac{153}{7}$. The duality gap for the nonconvex integer program, measured against this LP-dual bound, equals $z_{\\mathrm{LP}}-z_{\\mathrm{IP}}=\\dfrac{6}{7}$, which arises because the LP can take a fractional amount of a high-density item to fill remaining capacity; the closer the item densities $v_i/w_i$ are to one another, the smaller this gap tends to be.**\n-   The values for $z_{\\mathrm{IP}}$ and $z_{\\mathrm{LP}}$ are correct.\n-   The dual solution $(y^*, s_1, s_2, s_3) = (15/7, 0, 0, 3/7)$ is the correct optimal dual solution derived via complementary slackness.\n-   The conditions $w_i y^*+s_i\\ge v_i$ correctly state dual feasibility, and $C y^*+\\sum_i s_i=\\dfrac{153}{7}$ correctly states that this feasible solution achieves the optimal value, thus certifying the LP solution's optimality.\n-   The integrality gap is correctly calculated as $z_{\\mathrm{LP}}-z_{\\mathrm{IP}} = 6/7$.\n-   The interpretation of the gap's origin and its relationship to item densities is accurate.\n-   Verdict: **Correct**.\n\n**B. $z_{\\mathrm{IP}}=21$, $z_{\\mathrm{LP}}=21$, so the duality gap is $0$ and strong duality holds even for the integer program; the item densities do not affect the gap because fractional decisions are unnecessary.**\n-   The value $z_{\\mathrm{LP}}=21$ is incorrect. It is $153/7$. The premise is false.\n-   Verdict: **Incorrect**.\n\n**C. $z_{\\mathrm{IP}}=15$, $z_{\\mathrm{LP}}=22.5$, so the duality gap is $7.5$; this large gap is driven by the low-density items, not by the ability to fractionally include any single high-density item.**\n-   The value $z_{\\mathrm{IP}}=15$ is incorrect. It is $21$. The premise is false.\n-   Verdict: **Incorrect**.\n\n**D. $z_{\\mathrm{IP}}=21$, $z_{\\mathrm{LP}}=22$ (attained with dual scalar $y=2$), so the duality gap is $1$; the magnitude of the gap is unrelated to value-to-weight densities and is determined only by total capacity.**\n-   The value $z_{\\mathrm{LP}}=22$ is an incorrect approximation. The exact value is $153/7$. While $y=2$ provides an upper bound of $22$, it is not the least upper bound.\n-   The claim that the gap is unrelated to densities is false.\n-   Verdict: **Incorrect**.\n\n**E. $z_{\\mathrm{IP}}=21$, $z_{\\mathrm{LP}}=\\dfrac{153}{7}$, but the duality gap is $z_{\\mathrm{IP}}-z_{\\mathrm{LP}}=-\\dfrac{6}{7}$; since this is negative, it shows strong duality holds for the integer program, independent of item densities.**\n-   The definition of the integrality gap is conventionally non-negative for maximization problems ($z_{\\mathrm{LP}} - z_{\\mathrm{IP}} \\ge 0$).\n-   The conclusion that a non-zero gap (regardless of sign) implies strong duality for the IP is a fundamental misunderstanding. Strong duality for the IP requires a zero gap.\n-   Verdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "3123596"}]}