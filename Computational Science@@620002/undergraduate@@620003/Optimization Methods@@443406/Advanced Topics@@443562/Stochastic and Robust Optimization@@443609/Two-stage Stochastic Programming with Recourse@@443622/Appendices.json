{"hands_on_practices": [{"introduction": "This first exercise provides a practical introduction to formulating a two-stage stochastic program from a real-world description. The scenario of managing theater ticket sales [@problem_id:3194929] exemplifies the common trade-off between the risk of over-committing resources and the opportunity cost of under-utilization. By working through this problem, you will practice identifying the first-stage decision, the random variables that constitute the uncertainty, and the optimal second-stage (recourse) actions needed to respond to a specific outcome.", "problem": "A small, limited-access preview theater offers a fixed set of premium seats. A planning decision is made before the show to release a number of advance-reservation tickets. After the show starts, some advance-reservation customers may not show up, and the theater can admit standby customers to fill empty seats. This can be modeled as a two-stage stochastic program with recourse, where the first-stage decision is the number of advance-reservation tickets to release and the second-stage recourse decision admits standby customers after the uncertainty realizes.\n\nThe theater has capacity of $S = 3$ premium seats. The first-stage decision is the integer number $x \\in \\{0,1,2,3,4,5\\}$ of advance-reservation tickets to release. Each advance-reservation customer independently shows up with probability $s = 0.8$ (Independent and Identically Distributed (i.i.d.) attendance), yielding a random number of shows $Z \\sim \\text{Binomial}(x, s)$. The theater collects revenue on attendance only; an advance-reservation attendee pays $p_{a} = 30$ upon entry. If there are fewer advance-reservation attendees than seats, the theater may admit up to $L = 2$ standby customers at price $p_{s} = 10$ each to fill remaining empty seats. If the number of advance-reservation attendees exceeds capacity, the excess must be turned away due to fire code, incurring a penalty cost $c_{b} = 40$ for each turned-away customer (assume they do not pay the ticket price).\n\nLet the second-stage recourse decision be $y(\\xi)$, where $\\xi$ is the realized number of no-shows among the $x$ advance reservations. Equivalently, let $Z = x - \\xi$ denote realized advance-reservation attendees. After observing $\\xi$ (or $Z$), the theater chooses $y(\\xi)$ to maximize realized revenue, subject to physical capacity and standby limits. Use the core definitions of two-stage stochastic programming with recourse and standard probability facts to:\n\n1. Formulate the realized revenue as a function of the realization $Z$ and the recourse decision $y(\\xi)$, enforcing the constraints that total admissions do not exceed capacity and standby admissions do not exceed $L$.\n2. Derive the expected revenue $\\mathbb{E}[R(x)]$ as a function of $x$ using the Binomial distribution for $Z$.\n3. Compute $\\mathbb{E}[R(x)]$ for each $x \\in \\{0,1,2,3,4,5\\}$ and determine the value $x^{\\star}$ that maximizes the expected revenue.\n\nProvide the final answer as the value of $x^{\\star}$. No rounding is required. Express the final answer as a pure number without units.", "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- Theater capacity: $S = 3$ premium seats.\n- First-stage decision variable (number of advance-reservation tickets): $x \\in \\{0, 1, 2, 3, 4, 5\\}$.\n- Probability of an advance-reservation customer showing up: $s = 0.8$.\n- Random variable for the number of advance-reservation attendees: $Z \\sim \\text{Binomial}(x, s)$.\n- Revenue from an advance-reservation attendee: $p_{a} = 30$.\n- Maximum number of standby customers: $L = 2$.\n- Revenue from a standby customer: $p_{s} = 10$.\n- Penalty for each turned-away customer: $c_{b} = 40$.\n- Second-stage recourse decision: $y(\\xi)$, where $\\xi$ is the number of no-shows.\n- Realized advance-reservation attendees: $Z = x - \\xi$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n- **Scientific Grounding**: The problem is a standard application of two-stage stochastic programming, a well-established discipline within operations research and optimization theory. The use of a Binomial distribution to model independent customer arrivals is a common and valid technique.\n- **Well-Posedness**: The problem is well-posed. It requires finding the integer $x$ from a finite set that maximizes a well-defined expected revenue function. All necessary parameters and constraints are provided, and there are no contradictions. A unique optimal solution is expected to exist.\n- **Objectivity**: The problem is stated in precise, quantitative terms, free from any subjective or ambiguous language.\n\nThe problem does not exhibit any of the invalidity flaws. It is a complete, consistent, and formalizable problem directly related to the specified topic of *two-stage stochastic programming with recourse*.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThis problem is a two-stage stochastic program. The first-stage decision is to choose the number of advance-reservation tickets to sell, $x \\in \\{0, 1, 2, 3, 4, 5\\}$. After this decision is made, the uncertainty is realized: the number of customers who actually show up, denoted by the random variable $Z$. $Z$ follows a Binomial distribution, $Z \\sim \\text{Binomial}(x, s)$, with parameters $x$ and $s = 0.8$. The second-stage (recourse) decision is to determine how many standby customers to admit, $y$, after observing the realization of $Z$, say $k$. The overall objective is to choose $x$ to maximize the expected total revenue.\n\n**1. Formulate the Realized Revenue (Second-Stage Problem)**\n\nLet $k$ be the realized number of advance-reservation attendees who show up. After observing $k$, the theater makes a recourse decision on the number of standby customers, $y$, to admit. The goal is to maximize the revenue for this specific realization.\n\nThe number of admitted advance-reservation customers is $\\min(k, S)$.\nThe number of turned-away advance-reservation customers is $\\max(0, k-S)$.\nThe number of available seats for standby customers is $S - k$, if $k  S$, and $0$ otherwise. This can be written as $\\max(0, S-k)$.\n\nThe recourse decision $y$ is constrained by the number of available seats and the limit on standby customers, $L$:\n$$y \\le \\max(0, S-k)$$\n$$y \\le L$$\n$$y \\ge 0$$\nCombining these, we have $0 \\le y \\le \\min(L, \\max(0, S-k))$.\nSince the revenue from a standby customer $p_s = 10$ is positive, the theater maximizes its second-stage revenue by admitting as many standby customers as possible. The optimal recourse decision $y^*(k)$ is:\n$$y^*(k) = \\min(L, \\max(0, S-k))$$\n\nThe total realized revenue, $R(k)$, for a realization $k$ is the sum of revenue from admitted advance-reservation customers and standby customers, minus the penalty for turned-away customers.\n$$R(k) = p_a \\cdot \\min(k, S) + p_s \\cdot y^*(k) - c_b \\cdot \\max(0, k-S)$$\nSubstituting the expression for $y^*(k)$ and the given parameters $S=3$, $p_a=30$, $p_s=10$, $c_b=40$, and $L=2$:\n$$R(k) = 30 \\cdot \\min(k, 3) + 10 \\cdot \\min(2, \\max(0, 3-k)) - 40 \\cdot \\max(0, k-3)$$\n\nLet's evaluate this function for possible values of $k$:\n- If $k=0$: $R(0) = 30(0) + 10 \\cdot \\min(2, 3) - 40(0) = 20$.\n- If $k=1$: $R(1) = 30(1) + 10 \\cdot \\min(2, 2) - 40(0) = 30 + 20 = 50$.\n- If $k=2$: $R(2) = 30(2) + 10 \\cdot \\min(2, 1) - 40(0) = 60 + 10 = 70$.\n- If $k=3$: $R(3) = 30(3) + 10 \\cdot \\min(2, 0) - 40(0) = 90$.\n- If $k=4$: $R(4) = 30(3) + 10 \\cdot \\min(2, 0) - 40(1) = 90 - 40 = 50$.\n- If $k=5$: $R(5) = 30(3) + 10 \\cdot \\min(2, 0) - 40(2) = 90 - 80 = 10$.\n\n**2. Derive the Expected Revenue**\n\nThe expected revenue for a first-stage decision $x$ is given by $\\mathbb{E}[R(x)]$. This is calculated by summing the realized revenues $R(k)$ over all possible outcomes $k \\in \\{0, 1, \\dots, x\\}$, weighted by their respective probabilities. The probability mass function for $Z \\sim \\text{Binomial}(x, 0.8)$ is $P(Z=k|x) = \\binom{x}{k} (0.8)^k (0.2)^{x-k}$.\n$$\\mathbb{E}[R(x)] = \\sum_{k=0}^{x} R(k) \\cdot P(Z=k|x)$$\n$$ \\mathbb{E}[R(x)] = \\sum_{k=0}^{x} \\left( 30 \\cdot \\min(k, 3) + 10 \\cdot \\min(2, \\max(0, 3-k)) - 40 \\cdot \\max(0, k-3) \\right) \\binom{x}{k} (0.8)^k (0.2)^{x-k} $$\n\n**3. Compute $\\mathbb{E}[R(x)]$ and Determine the Optimal $x^{\\star}$**\n\nWe now compute the expected revenue for each possible value of $x \\in \\{0, 1, 2, 3, 4, 5\\}$.\n\n- **For $x=0$**: $P(Z=0)=1$.\n$\\mathbb{E}[R(0)] = R(0) \\cdot 1 = 20$.\n\n- **For $x=1$**: $P(Z=0) = 0.2$, $P(Z=1) = 0.8$.\n$\\mathbb{E}[R(1)] = R(0) \\cdot 0.2 + R(1) \\cdot 0.8 = 20(0.2) + 50(0.8) = 4 + 40 = 44$.\n\n- **For $x=2$**: $P(Z=0)=(0.2)^2=0.04$, $P(Z=1)=2(0.8)(0.2)=0.32$, $P(Z=2)=(0.8)^2=0.64$.\n$\\mathbb{E}[R(2)] = R(0)\\cdot(0.04) + R(1)\\cdot(0.32) + R(2)\\cdot(0.64) = 20(0.04) + 50(0.32) + 70(0.64) = 0.8 + 16 + 44.8 = 61.6$.\n\n- **For $x=3$**: $P(Z=0)=(0.2)^3=0.008$, $P(Z=1)=3(0.8)(0.2)^2=0.096$, $P(Z=2)=3(0.8)^2(0.2)=0.384$, $P(Z=3)=(0.8)^3=0.512$.\n$\\mathbb{E}[R(3)] = R(0)\\cdot(0.008) + R(1)\\cdot(0.096) + R(2)\\cdot(0.384) + R(3)\\cdot(0.512)$\n$\\mathbb{E}[R(3)] = 20(0.008) + 50(0.096) + 70(0.384) + 90(0.512) = 0.16 + 4.8 + 26.88 + 46.08 = 77.92$.\n\n- **For $x=4$**: $P(Z=0)=(0.2)^4=0.0016$, $P(Z=1)=4(0.8)(0.2)^3=0.0256$, $P(Z=2)=6(0.8)^2(0.2)^2=0.1536$, $P(Z=3)=4(0.8)^3(0.2)=0.4096$, $P(Z=4)=(0.8)^4=0.4096$.\n$\\mathbb{E}[R(4)] = R(0)P(0) + R(1)P(1) + R(2)P(2) + R(3)P(3) + R(4)P(4)$\n$\\mathbb{E}[R(4)] = 20(0.0016) + 50(0.0256) + 70(0.1536) + 90(0.4096) + 50(0.4096)$\n$\\mathbb{E}[R(4)] = 0.032 + 1.28 + 10.752 + 36.864 + 20.48 = 69.408$.\n\n- **For $x=5$**: $P(Z=0)=(0.2)^5=0.00032$, $P(Z=1)=5(0.8)(0.2)^4=0.0064$, $P(Z=2)=10(0.8)^2(0.2)^3=0.0512$, $P(Z=3)=10(0.8)^3(0.2)^2=0.2048$, $P(Z=4)=5(0.8)^4(0.2)=0.4096$, $P(Z=5)=(0.8)^5=0.32768$.\n$\\mathbb{E}[R(5)] = R(0)P(0) + R(1)P(1) + R(2)P(2) + R(3)P(3) + R(4)P(4) + R(5)P(5)$\n$\\mathbb{E}[R(5)] = 20(0.00032) + 50(0.0064) + 70(0.0512) + 90(0.2048) + 50(0.4096) + 10(0.32768)$\n$\\mathbb{E}[R(5)] = 0.0064 + 0.32 + 3.584 + 18.432 + 20.48 + 3.2768 = 46.0992$.\n\nSummarizing the expected revenues:\n- $\\mathbb{E}[R(0)] = 20$\n- $\\mathbb{E}[R(1)] = 44$\n- $\\mathbb{E}[R(2)] = 61.6$\n- $\\mathbb{E}[R(3)] = 77.92$\n- $\\mathbb{E}[R(4)] = 69.408$\n- $\\mathbb{E}[R(5)] = 46.0992$\n\nThe maximum expected revenue is $77.92$, which occurs when $x=3$. Therefore, the optimal number of advance-reservation tickets to release is $x^{\\star} = 3$.", "answer": "$$\\boxed{3}$$", "id": "3194929"}, {"introduction": "Once a stochastic problem is formulated, a key question is: what is the value of resolving the uncertainty? This practice introduces the concept of the Expected Value of Perfect Information (EVPI), a critical metric in decision analysis. The hypothetical supply chain problem [@problem_id:3195012] challenges you to not only find the optimal sourcing strategy under disruption risk but also to calculate the maximum price you should be willing to pay for a perfect forecast of that disruption.", "problem": "A firm must meet a deterministic demand of $d = 100$ units. It can source from two suppliers in the first stage before the disruption state is known: a risky supplier with unit cost $c_{s} = 5$ that delivers only if the disruption state $\\xi = 1$ (no disruption), and a reliable supplier with unit cost $c_{\\ell} = 8$ that delivers regardless of $\\xi$. The firm decides a first-stage allocation $x \\in [0, d]$ to the risky supplier and $d - x$ to the reliable supplier. The disruption state is a binary random variable $\\xi \\in \\{0,1\\}$ with $\\mathbb{P}(\\xi = 0) = q = 0.2$ and $\\mathbb{P}(\\xi = 1) = 1 - q = 0.8$. If $\\xi = 0$ (disruption occurs), the risky supplier fails and delivers $0$ units; to fulfill demand, the firm then uses a second-stage recourse action $y(\\xi)$ to buy any unmet quantity at a penalty price $p = 12$ per unit after observing $\\xi$. Assume all supplier payments are per delivered unit, unsatisfied demand is not permitted, and no overage or salvage is allowed.\n\nUsing the core definition of a two-stage stochastic program with recourse and the definition of Expected Value of Perfect Information (EVPI), formulate the expected total cost as a function of $x$ and derive the optimal first-stage decision under uncertainty. Then, compute the Expected Value of Perfect Information (EVPI) of the disruption state $\\xi$ for this sourcing problem. Express the EVPI as a single real number. No rounding is required, and do not include units in your final answer.", "solution": "### Step 1: Extract Givens\n- Deterministic demand: $d = 100$ units.\n- Risky supplier unit cost: $c_s = 5$.\n- Reliable supplier unit cost: $c_{\\ell} = 8$.\n- First-stage decision variable (quantity from risky supplier): $x \\in [0, d]$.\n- Quantity from reliable supplier: $d - x$.\n- Disruption state (random variable): $\\xi \\in \\{0, 1\\}$.\n- Probability of disruption ($\\xi = 0$): $\\mathbb{P}(\\xi = 0) = q = 0.2$.\n- Probability of no disruption ($\\xi = 1$): $\\mathbb{P}(\\xi = 1) = 1 - q = 0.8$.\n- Second-stage recourse penalty price: $p = 12$.\n- Recourse action (quantity bought at penalty price): $y(\\xi)$.\n- Constraint: Unsatisfied demand is not permitted. Payment is per delivered unit. No overage or salvage value.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a classic example of a two-stage stochastic linear program with recourse, a well-established topic in operations research and optimization.\n- **Scientifically Grounded:** The problem is based on standard principles of stochastic optimization. All concepts (recourse, EVPI) are well-defined in the field.\n- **Well-Posed:** All necessary data ($d, c_s, c_{\\ell}, p, q$) are provided. The objective (minimize expected cost) and constraints ($0 \\leq x \\leq d$, meet demand) are clear, leading to a unique optimal first-stage decision and a well-defined EVPI.\n- **Objective:** The problem is stated in precise, quantitative terms, free from any subjective or ambiguous language.\nThe problem is self-contained, consistent, and does not violate any of the specified invalidity criteria. It is therefore deemed **valid**.\n\n### Step 3: Solution Derivation\n\nThe problem is to find the optimal first-stage sourcing quantity $x$ from the risky supplier that minimizes the total expected cost. This is the **Recourse Problem (RP)**.\n\nFirst, we define the total cost as a function of the first-stage decision $x$ and the realization of the random state $\\xi$.\n\n**Scenario 1: Disruption Occurs ($\\xi = 0$)**\n- With probability $q = 0.2$, the risky supplier fails and delivers $0$ units.\n- The reliable supplier delivers $d - x$ units.\n- The total quantity available before recourse is $d - x$.\n- To meet the total demand $d$, the firm must purchase the shortfall, which is $d - (d - x) = x$.\n- The second-stage recourse action is $y(0) = x$.\n- The total cost in this scenario, $C(x, 0)$, is the sum of the cost of units from the reliable supplier and the cost of recourse units:\n$$C(x, 0) = c_{\\ell}(d - x) + p \\cdot y(0) = c_{\\ell}(d - x) + px$$\n\n**Scenario 2: No Disruption Occurs ($\\xi = 1$)**\n- With probability $1 - q = 0.8$, the risky supplier delivers $x$ units.\n- The reliable supplier delivers $d - x$ units.\n- The total quantity available is $x + (d - x) = d$.\n- The demand is fully met, so no recourse action is needed: $y(1) = 0$.\n- The total cost in this scenario, $C(x, 1)$, is the sum of payments to both suppliers, which are made per delivered unit:\n$$C(x, 1) = c_{\\ell}(d - x) + c_s x$$\n\n**The Recourse Problem (RP): Minimizing Expected Cost**\nThe objective is to choose $x$ to minimize the expected total cost, $Z(x)$.\n$$Z(x) = \\mathbb{E}[C(x, \\xi)] = \\mathbb{P}(\\xi=0) \\cdot C(x, 0) + \\mathbb{P}(\\xi=1) \\cdot C(x, 1)$$\n$$Z(x) = q [c_{\\ell}(d - x) + px] + (1-q) [c_{\\ell}(d - x) + c_s x]$$\nWe can rearrange terms to analyze the function $Z(x)$:\n$$Z(x) = q c_{\\ell} d - q c_{\\ell} x + q p x + (1-q) c_{\\ell} d - (1-q) c_{\\ell} x + (1-q) c_s x$$\n$$Z(x) = (q + 1 - q) c_{\\ell} d + x [ -q c_{\\ell} + q p - (1-q) c_{\\ell} + (1-q) c_s ]$$\n$$Z(x) = c_{\\ell} d + x [ -c_{\\ell} + qp + (1-q) c_s ]$$\nThis is a linear function of $x$ over the interval $[0, d]$. The optimal value of $x$ depends on the sign of the coefficient of $x$. Let this coefficient be $S$:\n$$S = (1-q)c_s + qp - c_{\\ell}$$\nSubstituting the given values:\n$$S = (1 - 0.2)(5) + (0.2)(12) - 8$$\n$$S = (0.8)(5) + 2.4 - 8 = 4 + 2.4 - 8 = -1.6$$\nSince $S  0$, the function $Z(x)$ is decreasing in $x$. To minimize $Z(x)$, we must choose the largest possible value for $x$. The feasible range is $x \\in [0, d]$, so the optimal first-stage decision is $x^* = d = 100$.\n\nThe optimal expected cost for the Recourse Problem, denoted $Z_{RP}$, is $Z(x^*)$:\n$$Z_{RP} = Z(100) = c_{\\ell}d + 100 \\cdot S$$\n$$Z_{RP} = (8)(100) + 100(-1.6) = 800 - 160 = 640$$\n\n**The Wait-and-See Problem (WS) and EVPI**\nThe Expected Value of Perfect Information (EVPI) is the difference between the optimal cost of the Recourse Problem ($Z_{RP}$) and the expected cost of the Wait-and-See problem ($Z_{WS}$). The $Z_{WS}$ is the expected cost if the decision could be made after observing the value of $\\xi$.\n\nIf we know $\\xi=0$ (disruption) in advance: The risky supplier is not an option. The choice is between the reliable supplier at cost $c_{\\ell} = 8$ and the recourse option at cost $p = 12$. Since $c_{\\ell}  p$, the optimal strategy is to source all $d = 100$ units from the reliable supplier. The cost is:\n$$C^*(0) = c_{\\ell}d = 8 \\cdot 100 = 800$$\n\nIf we know $\\xi=1$ (no disruption) in advance: The risky supplier is available. The choice is between the risky supplier at cost $c_s = 5$ and the reliable supplier at cost $c_{\\ell} = 8$. Since $c_s  c_{\\ell}$, the optimal strategy is to source all $d = 100$ units from the risky supplier. The cost is:\n$$C^*(1) = c_s d = 5 \\cdot 100 = 500$$\n\nThe expected cost of the Wait-and-See problem is the expectation of these optimal costs:\n$$Z_{WS} = \\mathbb{E}[C^*(\\xi)] = q \\cdot C^*(0) + (1-q) \\cdot C^*(1)$$\n$$Z_{WS} = (0.2)(800) + (0.8)(500) = 160 + 400 = 560$$\n\nFinally, the EVPI is the value of knowing the state $\\xi$ in advance:\n$$EVPI = Z_{RP} - Z_{WS}$$\n$$EVPI = 640 - 560 = 80$$\nThe EVPI is $80$. This value represents the maximum amount the firm should be willing to pay for perfect information about whether a disruption will occur.", "answer": "$$\\boxed{80}$$", "id": "3195012"}, {"introduction": "This final exercise serves as a comprehensive capstone, bringing together modeling and advanced analysis. You will encounter recourse functions that are piecewise-linear, a common feature in practice, and optimize a non-linear first-stage objective. Most importantly, this problem introduces both the EVPI and the Value of the Stochastic Solution (VSS) [@problem_id:3194980], which measures the performance gain of using a stochastic model over a simpler deterministic one based on average values. Calculating VSS allows you to justify the very use of stochastic programming.", "problem": "A firm must choose a first-stage capacity investment $x \\geq 0$ at a unit cost $c = 7$ before uncertainty in product rewards and available units is revealed. In the second stage, after the scenario $\\xi \\in \\{\\xi_{1}, \\xi_{2}\\}$ is realized, the firm allocates capacity $x$ to two products, $A$ and $B$, via nonnegative allocations $y_{A}(\\xi)$ and $y_{B}(\\xi)$ that satisfy the capacity and availability constraints $y_{A}(\\xi) + y_{B}(\\xi) \\leq x$, $y_{A}(\\xi) \\leq b_{A}(\\xi)$, and $y_{B}(\\xi) \\leq b_{B}(\\xi)$. The per-unit rewards $r_{A}(\\xi)$ and $r_{B}(\\xi)$ and the availability caps $b_{A}(\\xi)$ and $b_{B}(\\xi)$ are random and depend on the scenario. There are two scenarios with probabilities $\\mathbb{P}(\\xi_{1}) = 0.4$ and $\\mathbb{P}(\\xi_{2}) = 0.6$, with parameters:\n- Scenario $\\xi_{1}$: $r_{A}(\\xi_{1}) = 9$, $r_{B}(\\xi_{1}) = 5$, $b_{A}(\\xi_{1}) = 3$, $b_{B}(\\xi_{1}) = 4$.\n- Scenario $\\xi_{2}$: $r_{A}(\\xi_{2}) = 6$, $r_{B}(\\xi_{2}) = 10$, $b_{A}(\\xi_{2}) = 2$, $b_{B}(\\xi_{2}) = 5$.\n\nThe second-stage (recourse) problem for a realized scenario $\\xi$ is to choose $y_{A}(\\xi)$ and $y_{B}(\\xi)$ to maximize the total reward $r_{A}(\\xi) y_{A}(\\xi) + r_{B}(\\xi) y_{B}(\\xi)$ subject to the allocation constraints stated above. The first-stage objective is to maximize the expected net reward $\\mathbb{E}[Q(x,\\xi)] - c x$, where $Q(x,\\xi)$ denotes the optimal second-stage reward under scenario $\\xi$ given capacity $x$.\n\nUsing the foundational definitions of two-stage stochastic programming with recourse, derive from first principles:\n1. The piecewise-linear expressions of the recourse functions $Q(x,\\xi_{1})$ and $Q(x,\\xi_{2})$ as functions of $x$.\n2. The optimal first-stage capacity $x^{\\star}$ that solves the recourse problem, and the corresponding optimal expected objective value.\n3. The Wait-and-See (WS) benchmark, defined as the expected optimal value when the decision-maker knows $\\xi$ before choosing $x$, and the corresponding scenario-optimal capacities $x^{\\star}(\\xi_{1})$ and $x^{\\star}(\\xi_{2})$.\n4. The Expected Value (EV) deterministic problem obtained by replacing the random parameters with their expectations, the EV-optimal capacity $x^{EV}$, and the Expected result of using the EV solution (EEV), which is the expected objective value when $x^{EV}$ is evaluated in the original stochastic recourse model.\n5. The Expected Value of Perfect Information (EVPI), defined as the difference between the WS expected value and the recourse problem optimal expected value, and the Value of the Stochastic Solution (VSS), defined as the difference between the recourse problem optimal expected value and the EEV.\n\nReport the final numerical values of EVPI and VSS. No rounding is required. Express the final answer as a pair in the order $\\text{EVPI}, \\text{VSS}$.", "solution": "### Solution Derivation\n\nThis problem is solved by following the five steps outlined in the problem description. First, we derive the piecewise-linear recourse functions for each scenario. Second, we find the optimal first-stage decision $x^{\\star}$ by maximizing the expected net reward. Third, we compute the Wait-and-See (WS) benchmark. Fourth, we solve the deterministic Expected Value (EV) problem to find the EEV. Finally, we use these values to calculate the EVPI and VSS.\n\n**1. Derivation of Recourse Functions $Q(x, \\xi_{1})$ and $Q(x, \\xi_{2})$**\n\nThe second-stage problem is a linear program solved for a given capacity $x$. The optimal strategy is to allocate capacity to the product with the higher reward first, up to its availability limit.\n\n**For scenario $\\xi_1$:**\nThe problem is to maximize $9 y_{A}(\\xi_1) + 5 y_{B}(\\xi_1)$ subject to $y_{A}(\\xi_1) + y_{B}(\\xi_1) \\leq x$, $y_{A}(\\xi_1) \\leq 3$, $y_{B}(\\xi_1) \\leq 4$, and non-negativity.\nSince $r_{A}(\\xi_{1}) = 9 > r_{B}(\\xi_{1}) = 5$, we prioritize allocation to product $A$.\n\n*   If $0 \\leq x \\leq 3$: We allocate all capacity to $A$. $y_{A}(\\xi_1) = x$, $y_{B}(\\xi_1) = 0$.\n    $Q(x, \\xi_{1}) = 9x$.\n*   If $3  x \\leq 3+4=7$: We first satisfy the full availability of $A$, $y_{A}(\\xi_1) = 3$. The remaining capacity $x-3$ is allocated to $B$. $y_{B}(\\xi_1) = x-3$.\n    $Q(x, \\xi_{1}) = 9(3) + 5(x-3) = 27 + 5x - 15 = 5x + 12$.\n*   If $x > 7$: Capacity is sufficient to meet all availability. $y_{A}(\\xi_1) = 3$, $y_{B}(\\xi_1) = 4$.\n    $Q(x, \\xi_{1}) = 9(3) + 5(4) = 27 + 20 = 47$.\n\nSo, $Q(x, \\xi_{1}) = \\begin{cases} 9x  \\text{if } 0 \\leq x \\leq 3 \\\\ 5x + 12  \\text{if } 3  x \\leq 7 \\\\ 47  \\text{if } x  7 \\end{cases}$.\n\n**For scenario $\\xi_2$:**\nThe problem is to maximize $6 y_{A}(\\xi_2) + 10 y_{B}(\\xi_2)$ subject to $y_{A}(\\xi_2) + y_{B}(\\xi_2) \\leq x$, $y_{A}(\\xi_2) \\leq 2$, $y_{B}(\\xi_2) \\leq 5$, and non-negativity.\nSince $r_{B}(\\xi_{2}) = 10 > r_{A}(\\xi_{2}) = 6$, we prioritize allocation to product $B$.\n\n*   If $0 \\leq x \\leq 5$: We allocate all capacity to $B$. $y_{B}(\\xi_2) = x$, $y_{A}(\\xi_2) = 0$.\n    $Q(x, \\xi_{2}) = 10x$.\n*   If $5  x \\leq 5+2=7$: We first satisfy the full availability of $B$, $y_{B}(\\xi_2) = 5$. The remaining capacity $x-5$ is allocated to $A$. $y_{A}(\\xi_2) = x-5$.\n    $Q(x, \\xi_{2}) = 10(5) + 6(x-5) = 50 + 6x - 30 = 6x + 20$.\n*   If $x > 7$: Capacity is sufficient. $y_{B}(\\xi_2) = 5$, $y_{A}(\\xi_2) = 2$.\n    $Q(x, \\xi_{2}) = 10(5) + 6(2) = 50 + 12 = 62$.\n\nSo, $Q(x, \\xi_{2}) = \\begin{cases} 10x  \\text{if } 0 \\leq x \\leq 5 \\\\ 6x + 20  \\text{if } 5  x \\leq 7 \\\\ 62  \\text{if } x  7 \\end{cases}$.\n\n**2. Optimal First-Stage Capacity $x^{\\star}$ and Recourse Problem (RP) Value**\n\nThe first-stage objective is to maximize $Z(x) = \\mathbb{E}[Q(x,\\xi)] - cx$, where $c=7$.\n$Z(x) = 0.4 Q(x, \\xi_{1}) + 0.6 Q(x, \\xi_{2}) - 7x$.\nThe function $Z(x)$ is piecewise-linear and concave. We find the optimum by examining the derivative (slope) of $Z(x)$ in each interval defined by the breakpoints of the recourse functions, which are $\\{3, 5, 7\\}$.\n\n*   For $x \\in [0, 3]$:\n    $Z(x) = 0.4(9x) + 0.6(10x) - 7x = (3.6 + 6 - 7)x = 2.6x$.\n    The slope is $Z'(x)=2.6 > 0$.\n*   For $x \\in (3, 5]$:\n    $Z(x) = 0.4(5x+12) + 0.6(10x) - 7x = (2x + 4.8) + 6x - 7x = x + 4.8$.\n    The slope is $Z'(x)=1 > 0$.\n*   For $x \\in (5, 7]$:\n    $Z(x) = 0.4(5x+12) + 0.6(6x+20) - 7x = (2x + 4.8) + (3.6x + 12) - 7x = -1.4x + 16.8$.\n    The slope is $Z'(x)=-1.4  0$.\n\nThe slope of the objective function $Z(x)$ turns from positive to negative at $x=5$. Therefore, the optimal first-stage capacity is $x^{\\star} = 5$.\n\nThe optimal expected objective value (the value of the Recourse Problem, RP) is $Z_{RP} = Z(x^{\\star}=5)$.\nUsing the expression for $x \\in (3, 5]$, we have:\n$Z_{RP} = Z(5) = 5 + 4.8 = 9.8$.\n\n**3. Wait-and-See (WS) Benchmark**\n\nThe WS value is the expected optimal profit if the scenario is known before choosing $x$.\n$Z_{WS} = \\sum_{i=1}^{2} \\mathbb{P}(\\xi_i) \\max_{x \\geq 0} \\{Q(x, \\xi_i) - cx\\}$.\n\n**For scenario $\\xi_1$**: Maximize $W_1(x) = Q(x, \\xi_1) - 7x$.\n*   $x \\in [0, 3]$: $W_1(x) = 9x - 7x = 2x$. Slope is $2$.\n*   $x \\in (3, 7]$: $W_1(x) = (5x+12) - 7x = 12 - 2x$. Slope is $-2$.\nThe maximum is at $x=3$. So, $x^{\\star}(\\xi_1) = 3$.\nThe optimal value is $W_1^{\\star} = 2(3) = 6$.\n\n**For scenario $\\xi_2$**: Maximize $W_2(x) = Q(x, \\xi_2) - 7x$.\n*   $x \\in [0, 5]$: $W_2(x) = 10x - 7x = 3x$. Slope is $3$.\n*   $x \\in (5, 7]$: $W_2(x) = (6x+20) - 7x = 20 - x$. Slope is $-1$.\nThe maximum is at $x=5$. So, $x^{\\star}(\\xi_2) = 5$.\nThe optimal value is $W_2^{\\star} = 3(5) = 15$.\n\nThe WS value is the expectation of these scenario-optimal values:\n$Z_{WS} = \\mathbb{P}(\\xi_1) W_1^{\\star} + \\mathbb{P}(\\xi_2) W_2^{\\star} = 0.4(6) + 0.6(15) = 2.4 + 9.0 = 11.4$.\n\n**4. Expected Value (EV) Problem and EEV**\n\nFirst, compute the expected values of the random parameters:\n$\\mathbb{E}[r_A] = 0.4(9) + 0.6(6) = 3.6 + 3.6 = 7.2$.\n$\\mathbb{E}[r_B] = 0.4(5) + 0.6(10) = 2.0 + 6.0 = 8.0$.\n$\\mathbb{E}[b_A] = 0.4(3) + 0.6(2) = 1.2 + 1.2 = 2.4$.\n$\\mathbb{E}[b_B] = 0.4(4) + 0.6(5) = 1.6 + 3.0 = 4.6$.\n\nThe EV problem is to solve the deterministic problem using these expected values:\nMaximize $Z^{EV}(x) = Q^{EV}(x) - 7x$, where $Q^{EV}(x)$ is the optimal reward from allocating capacity $x$ with expected parameters.\n$Q^{EV}(x) = \\max \\{7.2y_A + 8y_B \\mid y_A+y_B \\le x, y_A \\le 2.4, y_B \\le 4.6, y_A,y_B \\ge 0 \\}$.\nSince $\\mathbb{E}[r_B]=8.0 > \\mathbb{E}[r_A]=7.2$, we prioritize $y_B$.\n\n*   For $x \\in [0, 4.6]$: $Z^{EV}(x) = 8x - 7x = x$. Slope is $1$.\n*   For $x \\in (4.6, 4.6+2.4=7]$: $Q^{EV}(x) = 8(4.6) + 7.2(x-4.6) = 7.2x + 3.68$.\n    $Z^{EV}(x) = (7.2x + 3.68) - 7x = 0.2x + 3.68$. Slope is $0.2$.\n*   For $x > 7$: $Q^{EV}(x) = 8(4.6) + 7.2(2.4) = 54.08$.\n    $Z^{EV}(x) = 54.08 - 7x$. Slope is $-7$.\n\nThe slope is always positive up to $x=7$ and then becomes negative. The optimal capacity for the EV problem is $x^{EV} = 7$.\n\nThe Expected result of using the EV solution (EEV) is the value obtained by using $x=x^{EV}=7$ in the original stochastic problem.\n$Z_{EEV} = \\mathbb{E}[Q(7, \\xi)] - 7(7)$.\nWe need $Q(7, \\xi_1)$ and $Q(7, \\xi_2)$:\n$Q(7, \\xi_1) = 5(7) + 12 = 47$.\n$Q(7, \\xi_2) = 6(7) + 20 = 62$.\n$\\mathbb{E}[Q(7, \\xi)] = 0.4(47) + 0.6(62) = 18.8 + 37.2 = 56$.\n$Z_{EEV} = 56 - 49 = 7$.\n\n**5. EVPI and VSS**\n\nThe Expected Value of Perfect Information (EVPI) is the gain from having perfect information about the future.\n$EVPI = Z_{WS} - Z_{RP} = 11.4 - 9.8 = 1.6$.\n\nThe Value of the Stochastic Solution (VSS) is the gain from solving the stochastic problem instead of the simpler EV problem.\n$VSS = Z_{RP} - Z_{EEV} = 9.8 - 7 = 2.8$.\n\nThe final requested values are $EVPI = 1.6$ and $VSS = 2.8$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.6  2.8\n\\end{pmatrix}\n}\n$$", "id": "3194980"}]}