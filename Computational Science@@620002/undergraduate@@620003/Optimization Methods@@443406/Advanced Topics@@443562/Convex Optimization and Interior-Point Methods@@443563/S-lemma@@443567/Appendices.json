{"hands_on_practices": [{"introduction": "This first exercise provides the quintessential motivation for the S-lemma. We explore a carefully constructed scenario where a quadratic function, $f(\\mathbf{x})$, is not globally non-negative but becomes so when restricted to a set defined by another quadratic inequality, $g(\\mathbf{x}) \\le 0$. This practice will guide you through verifying this non-obvious property and then using the S-lemma framework to find the non-negative scalar $\\lambda$ that \"proves\" it, offering a concrete look at how this powerful certificate works [@problem_id:3174402].", "problem": "Let $\\mathbf{x} \\in \\mathbb{R}^{2}$ and consider two quadratic functions $f(\\mathbf{x}) = \\mathbf{x}^{\\top} A \\mathbf{x} + a^{\\top} \\mathbf{x} + a_{0}$ and $g(\\mathbf{x}) = \\mathbf{x}^{\\top} B \\mathbf{x} + b^{\\top} \\mathbf{x} + b_{0}$, where $A$ and $B$ are symmetric matrices in $\\mathbb{R}^{2 \\times 2}$, $a,b \\in \\mathbb{R}^{2}$, and $a_{0},b_{0} \\in \\mathbb{R}$. The S-lemma (also known as the S-procedure) in optimization methods asserts that, under a strict feasibility condition for $g$, a quadratic $f$ that is nonnegative on the sublevel set $\\{\\mathbf{x} : g(\\mathbf{x}) \\le 0\\}$ admits a global nonnegativity certificate via an appropriate nonnegative scalar multiplier applied to $g$.\n\nConstruct the following specific instance by taking $A = -I_{2}$, $a = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$, $a_{0} = 5$, $B = I_{2}$, $b = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$, and $b_{0} = -4$, where $I_{2}$ denotes the $2 \\times 2$ identity matrix. With these choices, the functions become $f(\\mathbf{x}) = -\\|\\mathbf{x}\\|^{2} + 5$ and $g(\\mathbf{x}) = \\|\\mathbf{x}\\|^{2} - 4$.\n\nStarting from fundamental definitions of quadratic forms and the notion of positive semidefiniteness, and without invoking any shortcut formulas, do the following:\n- Verify that the feasible set $\\{\\mathbf{x} : g(\\mathbf{x}) \\le 0\\}$ is nonempty and strictly feasible, and show that $f(\\mathbf{x}) \\ge 0$ holds on this set.\n- Show that $f(\\mathbf{x})$ attains negative values outside the feasible set of $g$.\n- Use the S-lemma to argue the existence of a nonnegative scalar $\\lambda$ such that $f(\\mathbf{x}) + \\lambda g(\\mathbf{x}) \\ge 0$ for all $\\mathbf{x} \\in \\mathbb{R}^{2}$, and then determine the smallest such $\\lambda$ that achieves global nonnegativity.\n\nYour final answer must be the single value of the smallest $\\lambda$ (no units). If any numerical approximation were necessary, you would be instructed to round to a specified number of significant figures; here an exact value is expected.", "solution": "The problem is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n- The vector variable is $\\mathbf{x} \\in \\mathbb{R}^{2}$.\n- Two quadratic functions are defined as $f(\\mathbf{x}) = \\mathbf{x}^{\\top} A \\mathbf{x} + a^{\\top} \\mathbf{x} + a_{0}$ and $g(\\mathbf{x}) = \\mathbf{x}^{\\top} B \\mathbf{x} + b^{\\top} \\mathbf{x} + b_{0}$.\n- Parameters are specified as $A, B$ being symmetric matrices in $\\mathbb{R}^{2 \\times 2}$, vectors $a,b \\in \\mathbb{R}^{2}$, and scalars $a_{0},b_{0} \\in \\mathbb{R}$.\n- The S-lemma is described as asserting that if a strict feasibility condition holds for $g$, then $f(\\mathbf{x}) \\ge 0$ on the set $\\{\\mathbf{x} : g(\\mathbf{x}) \\le 0\\}$ implies the existence of a nonnegative scalar $\\lambda$ such that $f(\\mathbf{x}) + \\lambda g(\\mathbf{x}) \\ge 0$ for all $\\mathbf{x}$.\n- A specific instance is constructed with:\n  - $A = -I_{2}$ (where $I_{2}$ is the $2 \\times 2$ identity matrix)\n  - $a = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$\n  - $a_{0} = 5$\n  - $B = I_{2}$\n  - $b = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$\n  - $b_{0} = -4$\n- The resulting functions are given as $f(\\mathbf{x}) = -\\|\\mathbf{x}\\|^{2} + 5$ and $g(\\mathbf{x}) = \\|\\mathbf{x}\\|^{2} - 4$.\n- The tasks are:\n  1. Verify the feasible set $\\{\\mathbf{x} : g(\\mathbf{x}) \\le 0\\}$ is nonempty and strictly feasible, and show $f(\\mathbf{x}) \\ge 0$ on this set.\n  2. Show $f(\\mathbf{x})$ can be negative outside this set.\n  3. Use the S-lemma to argue for the existence of a $\\lambda \\ge 0$ such that $f(\\mathbf{x}) + \\lambda g(\\mathbf{x}) \\ge 0$ for all $\\mathbf{x} \\in \\mathbb{R}^{2}$, and find the smallest such $\\lambda$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the S-lemma, a fundamental and well-established theorem in convex optimization and control theory. All mathematical objects (matrices, vectors, quadratic forms) are standard and well-defined. The problem is mathematically sound.\n- **Well-Posed:** The problem provides all necessary information to define the functions $f(\\mathbf{x})$ and $g(\\mathbf{x})$. The tasks are explicit and lead to the determination of a specific, unique value for the smallest $\\lambda$. The existence of a solution is guaranteed by the S-lemma under the conditions that the problem asks to be verified.\n- **Objective:** The problem is stated using precise, formal mathematical language. It is free of any ambiguity, subjectivity, or opinion.\n- The problem is self-contained, consistent, and adheres to all criteria for validity.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n**Solution Derivation**\n\nThe given parameters are $A = -I_{2}$, $a = \\mathbf{0}$, $a_{0} = 5$, $B = I_{2}$, $b = \\mathbf{0}$, and $b_{0} = -4$. For $\\mathbf{x} \\in \\mathbb{R}^{2}$, the quadratic functions are:\n$f(\\mathbf{x}) = \\mathbf{x}^{\\top}(-I_{2})\\mathbf{x} + \\mathbf{0}^{\\top}\\mathbf{x} + 5 = -\\mathbf{x}^{\\top}\\mathbf{x} + 5 = -\\|\\mathbf{x}\\|^{2} + 5$\n$g(\\mathbf{x}) = \\mathbf{x}^{\\top}(I_{2})\\mathbf{x} + \\mathbf{0}^{\\top}\\mathbf{x} - 4 = \\mathbf{x}^{\\top}\\mathbf{x} - 4 = \\|\\mathbf{x}\\|^{2} - 4$\nHere, $\\|\\mathbf{x}\\|$ represents the Euclidean norm of the vector $\\mathbf{x}$.\n\n**Part 1: Analysis of the feasible set and non-negativity of $f(\\mathbf{x})$**\n\nThe feasible set is defined by the inequality $g(\\mathbf{x}) \\le 0$.\n$g(\\mathbf{x}) \\le 0 \\implies \\|\\mathbf{x}\\|^{2} - 4 \\le 0 \\implies \\|\\mathbf{x}\\|^{2} \\le 4 \\implies \\|\\mathbf{x}\\| \\le 2$.\nThe feasible set $S = \\{\\mathbf{x} \\in \\mathbb{R}^{2} : g(\\mathbf{x}) \\le 0\\}$ is the closed disk of radius $2$ centered at the origin.\n\nTo verify that the set is nonempty, we can observe that the origin $\\mathbf{x} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ satisfies the condition, since $\\|\\mathbf{0}\\| = 0 \\le 2$. Thus, $S$ is nonempty.\n\nThe strict feasibility condition requires the existence of a point $\\mathbf{x}_{0}$ such that $g(\\mathbf{x}_{0})  0$. Let us again choose the origin $\\mathbf{x}_{0} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$. We compute $g(\\mathbf{0}) = \\|\\mathbf{0}\\|^{2} - 4 = 0 - 4 = -4$. Since $-4  0$, the strict feasibility condition (also known as Slater's condition) is satisfied.\n\nNext, we must show that $f(\\mathbf{x}) \\ge 0$ for all $\\mathbf{x}$ in the feasible set $S$. For any $\\mathbf{x} \\in S$, we have $\\|\\mathbf{x}\\|^{2} \\le 4$. Multiplying by $-1$ reverses the inequality: $-\\|\\mathbf{x}\\|^{2} \\ge -4$. Adding $5$ to both sides gives:\n$-\\|\\mathbf{x}\\|^{2} + 5 \\ge -4 + 5$\n$f(\\mathbf{x}) \\ge 1$\nSince $1 > 0$, it is certainly true that $f(\\mathbf{x}) \\ge 0$ on the set $S$.\n\n**Part 2: Behavior of $f(\\mathbf{x})$ outside the feasible set**\n\nOutside the feasible set, we have $\\|\\mathbf{x}\\| > 2$. We need to show that $f(\\mathbf{x})$ can take negative values in this region.\n$f(\\mathbf{x}) = -\\|\\mathbf{x}\\|^{2} + 5$.\nFor $f(\\mathbf{x})$ to be negative, we require:\n$-\\|\\mathbf{x}\\|^{2} + 5  0 \\implies 5  \\|\\mathbf{x}\\|^{2} \\implies \\|\\mathbf{x}\\| > \\sqrt{5}$.\nSince $\\sqrt{5} \\approx 2.236$, the condition $\\|\\mathbf{x}\\| > \\sqrt{5}$ is a stronger condition than $\\|\\mathbf{x}\\| > 2$. Any point $\\mathbf{x}$ satisfying $\\|\\mathbf{x}\\| > \\sqrt{5}$ lies outside the feasible set $S$ and results in $f(\\mathbf{x})  0$.\nFor instance, consider the point $\\mathbf{x} = \\begin{pmatrix}3 \\\\ 0\\end{pmatrix}$. Its norm is $\\|\\mathbf{x}\\| = 3$, which is greater than $2$, so it is outside $S$.\nThe value of the function at this point is $f(\\begin{pmatrix}3 \\\\ 0\\end{pmatrix}) = -\\| \\begin{pmatrix}3 \\\\ 0\\end{pmatrix} \\|^{2} + 5 = -3^{2} + 5 = -9 + 5 = -4$.\nSince $-4  0$, this demonstrates that $f(\\mathbf{x})$ attains negative values outside the feasible set.\n\n**Part 3: Application of the S-lemma and determination of the smallest $\\lambda$**\n\nThe S-lemma for one quadratic constraint states that the implication\n$(g(\\mathbf{x}) \\le 0 \\implies f(\\mathbf{x}) \\ge 0)$\nis equivalent to the existence of a scalar $\\lambda \\ge 0$ such that the function $f(\\mathbf{x}) + \\lambda g(\\mathbf{x})$ is globally nonnegative, i.e., $f(\\mathbf{x}) + \\lambda g(\\mathbf{x}) \\ge 0$ for all $\\mathbf{x} \\in \\mathbb{R}^{n}$. This equivalence holds provided the strict feasibility condition (there exists $\\mathbf{x}_0$ with $g(\\mathbf{x}_0)  0$) is met.\n\nWe have already verified both the premise $(g(\\mathbf{x}) \\le 0 \\implies f(\\mathbf{x}) \\ge 0)$ and the strict feasibility condition. Therefore, the S-lemma guarantees the existence of at least one $\\lambda \\ge 0$ that satisfies the global nonnegativity property. We now seek to find the smallest such $\\lambda$.\n\nLet us form the combined quadratic function $H(\\mathbf{x}, \\lambda) = f(\\mathbf{x}) + \\lambda g(\\mathbf{x})$:\n$H(\\mathbf{x}, \\lambda) = (-\\|\\mathbf{x}\\|^{2} + 5) + \\lambda (\\|\\mathbf{x}\\|^{2} - 4)$\nCombining terms, we get:\n$H(\\mathbf{x}, \\lambda) = (\\lambda - 1)\\|\\mathbf{x}\\|^{2} + (5 - 4\\lambda)$\n\nThis expression is a quadratic form in $\\mathbf{x}$. For $H(\\mathbf{x}, \\lambda)$ to be non-negative for all $\\mathbf{x} \\in \\mathbb{R}^{2}$, we must analyze its structure.\nThe function can be written as $\\mathbf{x}^{\\top} Q \\mathbf{x} + c$, where the matrix of the quadratic form is $Q = (\\lambda - 1)I_{2}$ and the constant term is $c = 5 - 4\\lambda$.\n\nFor $H(\\mathbf{x}, \\lambda) \\ge 0$ for all $\\mathbf{x}$, two conditions must be satisfied:\n1. The matrix $Q$ must be positive semidefinite ($Q \\succeq 0$). For a diagonal matrix like $Q = \\begin{pmatrix} \\lambda-1  0 \\\\ 0  \\lambda-1 \\end{pmatrix}$, this means its diagonal entries must be non-negative. This gives the condition $\\lambda - 1 \\ge 0$, which implies $\\lambda \\ge 1$. If this condition holds, the term $(\\lambda - 1)\\|\\mathbf{x}\\|^{2}$ is always non-negative, and the function is bounded below.\n2. The global minimum of the function must be non-negative. When $\\lambda - 1 \\ge 0$, the quadratic term $(\\lambda - 1)\\|\\mathbf{x}\\|^{2}$ is a convex function whose minimum value is $0$, achieved at $\\mathbf{x} = \\mathbf{0}$. Therefore, the global minimum of $H(\\mathbf{x}, \\lambda)$ is its value at $\\mathbf{x} = \\mathbf{0}$:\n$\\min_{\\mathbf{x}} H(\\mathbf{x}, \\lambda) = H(\\mathbf{0}, \\lambda) = (\\lambda - 1)\\|\\mathbf{0}\\|^{2} + (5 - 4\\lambda) = 5 - 4\\lambda$.\nFor global non-negativity, this minimum value must be greater than or equal to $0$:\n$5 - 4\\lambda \\ge 0 \\implies 5 \\ge 4\\lambda \\implies \\lambda \\le \\frac{5}{4}$.\n\nWe must satisfy both conditions simultaneously: $\\lambda \\ge 1$ and $\\lambda \\le \\frac{5}{4}$. The set of all values of $\\lambda$ for which $f(\\mathbf{x}) + \\lambda g(\\mathbf{x})$ is globally non-negative is the closed interval $[1, \\frac{5}{4}]$.\n\nThe problem asks for the smallest such non-negative scalar $\\lambda$. The smallest value in the interval $[1, \\frac{5}{4}]$ is $1$. This value also satisfies the requirement from the S-lemma that $\\lambda \\ge 0$.\nTherefore, the smallest value of $\\lambda$ is $1$.\nLet's check for $\\lambda=1$:\n$H(\\mathbf{x}, 1) = (1-1)\\|\\mathbf{x}\\|^2 + (5 - 4(1)) = 0 + 1 = 1$.\nThe function is $H(\\mathbf{x},1)=1$ for all $\\mathbf{x}$, which is indeed non-negative.", "answer": "$$\\boxed{1}$$", "id": "3174402"}, {"introduction": "To deepen your understanding, this problem investigates a crucial boundary case of the S-lemma. You will analyze a situation where the implication $g(x) \\le 0 \\Rightarrow f(x) \\ge 0$ holds for a trivial reason: the function $f(x)$ is already non-negative everywhere, regardless of the constraint. By working through this thought experiment, you will discover that the S-lemma certificate becomes $\\lambda=0$, reinforcing the idea that $\\lambda$ quantifies how much the constraint $g(x)$ is needed to enforce the non-negativity of $f(x)$ [@problem_id:3174414].", "problem": "Consider quadratic functions on $\\mathbb{R}^{2}$ defined by $f(x) = x^{\\top} A x + 2 b^{\\top} x + c$ and $g(x) = x^{\\top} B x + 2 d^{\\top} x + e$, where $x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}$. Let\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix},\\quad b = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix},\\quad c = 1,\\quad\nB = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix},\\quad d = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix},\\quad e = 1.\n$$\nThus $f(x) = x_{1}^{2} - 2 x_{1} + 1 + 2 x_{2}^{2}$ and $g(x) = - x_{1}^{2} - x_{2}^{2} + 1$. The implication of interest is $g(x) \\le 0 \\Rightarrow f(x) \\ge 0$. Work from fundamental definitions of positive semidefinite matrices and global nonnegativity of quadratic functions (without invoking any pre-stated certificates) to analyze this implication and the role of a scalar multiplier in certifying it.\n\nTasks:\n- Using only the definition of global nonnegativity and properties of positive semidefinite matrices, determine whether $f(x) \\ge 0$ holds for all $x \\in \\mathbb{R}^{2}$ and compute $\\min_{x \\in \\mathbb{R}^{2}} f(x)$.\n- Determine whether there exists $x \\in \\mathbb{R}^{2}$ such that $g(x)  0$.\n- Decide whether the implication $g(x) \\le 0 \\Rightarrow f(x) \\ge 0$ is trivial in the sense that it holds regardless of the set $\\{x : g(x) \\le 0\\}$, and identify the smallest nonnegative scalar $\\lambda$ that certifies this implication in the framework of the S-lemma.\n- Derive structural conditions on a general quadratic $f(x) = x^{\\top} A x + 2 b^{\\top} x + c$ that guarantee the choice $\\lambda = 0$ suffices to certify the implication for every quadratic $g$ that admits a strictly feasible point (that is, there exists $x$ with $g(x)  0$). Express your conditions in terms of $A$, $b$, and $c$, and standard linear algebraic objects.\n\nYour final reported quantity must be the smallest certifying scalar $\\lambda$. If a numerical approximation were required, a significant-figures instruction would be provided; here, give the exact value.", "solution": "The problem asks for an analysis of two quadratic functions, $f(x)$ and $g(x)$, the validity of an implication between them, and the determination of a certifying scalar $\\lambda$ in the context of the S-lemma.\n\nThe quadratic functions are defined on $\\mathbb{R}^{2}$ as $f(x) = x^{\\top} A x + 2 b^{\\top} x + c$ and $g(x) = x^{\\top} B x + 2 d^{\\top} x + e$, with $x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}$. The given matrices and scalars are:\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix},\\quad b = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix},\\quad c = 1\n$$\n$$\nB = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix},\\quad d = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix},\\quad e = 1\n$$\nThis gives the explicit forms $f(x) = x_{1}^{2} + 2x_{2}^{2} - 2x_{1} + 1$ and $g(x) = -x_{1}^{2} - x_{2}^{2} + 1$.\n\nThe tasks are addressed sequentially.\n\nTask 1: Determine if $f(x) \\ge 0$ for all $x \\in \\mathbb{R}^{2}$ and compute its minimum.\nWe analyze $f(x)$ by completing the square:\n$$\nf(x) = (x_{1}^{2} - 2x_{1} + 1) + 2x_{2}^{2} = (x_{1} - 1)^{2} + 2x_{2}^{2}\n$$\nFor any real vector $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$, the term $(x_1 - 1)^2$ is non-negative, and the term $2x_2^2$ is non-negative. Therefore, their sum, $f(x)$, must be non-negative for all $x \\in \\mathbb{R}^{2}$. So, $f(x) \\ge 0$ holds globally.\n\nThe minimum value of $f(x)$ is attained when both squared terms are zero. This occurs when $x_1 - 1 = 0$ (so $x_1=1$) and $x_2=0$. The minimum value is $f(\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}) = (1-1)^2 + 2(0)^2 = 0$. Thus, $\\min_{x \\in \\mathbb{R}^{2}} f(x) = 0$.\n\nTo confirm this using the requested matrix-based definition, we check if the matrix $M_f = \\begin{pmatrix} A  b \\\\ b^{\\top}  c \\end{pmatrix}$ is positive semidefinite (PSD).\n$$\nM_f = \\begin{pmatrix} 1  0  -1 \\\\ 0  2  0 \\\\ -1  0  1 \\end{pmatrix}\n$$\nA matrix is PSD if and only if all of its principal minors are non-negative.\nThe $1 \\times 1$ principal minors are the diagonal entries: $1 \\ge 0$, $2 \\ge 0$, $1 \\ge 0$.\nThe $2 \\times 2$ principal minors are:\n$$\n\\det\\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix} = 2 \\ge 0\n$$\n$$\n\\det\\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 1 - 1 = 0 \\ge 0\n$$\n$$\n\\det\\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} = 2 \\ge 0\n$$\nThe $3 \\times 3$ principal minor is the determinant of $M_f$ itself:\n$$\n\\det(M_f) = 1(2 \\cdot 1 - 0) - 0 + (-1)(0 \\cdot 0 - 2(-1)) = 2 - 2 = 0 \\ge 0\n$$\nSince all principal minors are non-negative, $M_f$ is positive semidefinite, which confirms that $f(x)$ is globally non-negative. The fact that $\\det(M_f)=0$ indicates that the minimum value of $f(x)$ is $0$.\n\nTask 2: Determine if there exists $x \\in \\mathbb{R}^{2}$ such that $g(x)  0$.\nThe condition $g(x)  0$ translates to:\n$$\n-x_{1}^{2} - x_{2}^{2} + 1  0 \\quad \\Leftrightarrow \\quad 1  x_{1}^{2} + x_{2}^{2}\n$$\nThis inequality describes the set of points in the plane that are strictly outside the unit circle centered at the origin. This set is clearly non-empty. For example, we can choose $x = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$. For this point, we have $g(\\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}) = -2^2 - 0^2 + 1 = -4+1 = -3  0$. Therefore, such an $x$ exists. This is known as the strict feasibility condition, or Slater's condition, for the constraint $g(x) \\le 0$.\n\nTask 3: Decide if the implication $g(x) \\le 0 \\Rightarrow f(x) \\ge 0$ is trivial and find the smallest certifying scalar $\\lambda$.\nFrom Task 1, we established that $f(x) \\ge 0$ for all $x \\in \\mathbb{R}^{2}$. This means the conclusion of the implication is always true, regardless of the premise. Therefore, the implication $g(x) \\le 0 \\Rightarrow f(x) \\ge 0$ is true. It is \"trivial\" in the sense that the non-negativity of $f(x)$ does not depend on the constraint imposed by $g(x)$.\n\nThe S-lemma states that (given the strict feasibility from Task 2) the implication $g(x) \\le 0 \\Rightarrow f(x) \\ge 0$ is equivalent to the existence of a scalar $\\lambda \\ge 0$ such that $f(x) + \\lambda g(x) \\ge 0$ for all $x \\in \\mathbb{R}^2$. We need to find the smallest such non-negative $\\lambda$.\nThe condition is that the quadratic function $h(x, \\lambda) = f(x) + \\lambda g(x)$ must be globally non-negative. This is equivalent to its associated homogenized matrix $M(\\lambda)$ being positive semidefinite.\n$$\nh(x, \\lambda) = x^{\\top}(A + \\lambda B)x + 2(b + \\lambda d)^{\\top}x + (c + \\lambda e)\n$$\nThe matrix is $M(\\lambda) = \\begin{pmatrix} A+\\lambda B  b+\\lambda d \\\\ (b+\\lambda d)^{\\top}  c+\\lambda e \\end{pmatrix}$.\nSubstituting the given parameters:\n$$\nM(\\lambda) = \\begin{pmatrix} 1-\\lambda  0  -1 \\\\ 0  2-\\lambda  0 \\\\ -1  0  1+\\lambda \\end{pmatrix}\n$$\nFor $M(\\lambda)$ to be PSD, we must have all its principal minors be non-negative. We seek the smallest $\\lambda \\ge 0$ that satisfies this. One of the $2 \\times 2$ principal minors gives the condition:\n$$\n\\det\\begin{pmatrix} 1-\\lambda  -1 \\\\ -1  1+\\lambda \\end{pmatrix} = (1-\\lambda)(1+\\lambda) - (-1)^2 = 1 - \\lambda^2 - 1 = -\\lambda^2 \\ge 0\n$$\nSince $\\lambda$ is a real number, $\\lambda^2 \\ge 0$, and thus $-\\lambda^2 \\le 0$. The only way to satisfy $-\\lambda^2 \\ge 0$ is if $\\lambda^2=0$, which implies $\\lambda=0$.\nWe must verify that $\\lambda=0$ satisfies all other PSD conditions. For $\\lambda=0$, $M(0) = M_f = \\begin{pmatrix} 1  0  -1 \\\\ 0  2  0 \\\\ -1  0  1 \\end{pmatrix}$. As shown in Task 1, this matrix is indeed positive semidefinite.\nSince the conditions require $\\lambda=0$, and $\\lambda=0$ is a valid choice, the smallest non-negative certifying scalar is $\\lambda = 0$.\n\nTask 4: Derive general conditions for $\\lambda=0$ to suffice.\nThe task is to find structural conditions on a general quadratic $f(x) = x^{\\top} A x + 2 b^{\\top} x + c$ such that $\\lambda=0$ certifies the implication $g(x) \\le 0 \\Rightarrow f(x) \\ge 0$ for any quadratic $g(x)$ that admits a strictly feasible point.\nAccording to the S-lemma, choosing $\\lambda=0$ as the certificate means that the statement $f(x) + 0 \\cdot g(x) \\ge 0$ must hold for all $x$. This simplifies to:\n$$\nf(x) \\ge 0 \\quad \\text{for all } x \\in \\mathbb{R}^n\n$$\nThis condition is that $f(x)$ must be globally non-negative. This condition is independent of $g(x)$, so if it holds, it holds for all valid $g(x)$.\nThe structural condition on $A$, $b$, and $c$ for $f(x)$ to be globally non-negative is that the $(n+1) \\times (n+1)$ matrix formed by homogenizing the quadratic function must be positive semidefinite. This matrix is:\n$$\n\\begin{pmatrix} A  b \\\\ b^{\\top}  c \\end{pmatrix}\n$$\nTherefore, the condition is that this matrix must be positive semidefinite, which is written as $\\begin{pmatrix} A  b \\\\ b^{\\top}  c \\end{pmatrix} \\succeq 0$. This is a standard condition expressed in terms of the objects defining the function and the concept of positive semidefiniteness from linear algebra.\n\nThe problem asks for the single numerical value of the smallest certifying scalar $\\lambda$ from the specific case analysis.", "answer": "$$\n\\boxed{0}\n$$", "id": "3174414"}, {"introduction": "Moving from verifying implications to solving optimization problems, this advanced practice showcases the S-lemma's utility as a computational tool. You will tackle a quadratically constrained quadratic program (QCQP) by reformulating it as a problem of finding a parameter that ensures a matrix pencil is positive semidefinite. This exercise reveals a profound and elegant connection between the optimal value of the optimization problem and the generalized eigenvalues of the matrices involved, a cornerstone result in modern optimization [@problem_id:3174413].", "problem": "Consider two homogeneous quadratic functions on $\\mathbb{R}^{2}$ defined by $f(\\mathbf{x}) = \\mathbf{x}^{\\top} A \\mathbf{x}$ and $g(\\mathbf{x}) = \\mathbf{x}^{\\top} B \\mathbf{x}$, where $A$ and $B$ are real symmetric matrices\n$$\nA = \\begin{pmatrix}\n4  1 \\\\\n1  2\n\\end{pmatrix}, \\qquad\nB = \\begin{pmatrix}\n-3  0 \\\\\n0  -1\n\\end{pmatrix}.\n$$\nAssume the Slater condition holds, i.e., there exists $\\bar{\\mathbf{x}}$ such that $g(\\bar{\\mathbf{x}})  0$. Starting from foundational facts about quadratic forms, homogeneity, and the S-lemma, do the following:\n\nFirst, analyze the optimization problem of finding the minimal value of $f(\\mathbf{x})$ over the cone $\\{\\mathbf{x} \\in \\mathbb{R}^{2} : g(\\mathbf{x}) \\le 0\\}$. Use homogeneity and the S-lemma to rigorously determine whether the minimal value is finite and, if so, what its value is.\n\nSecond, to obtain a nontrivial finite value, normalize the homogeneous inequality by restricting to the level set $g(\\mathbf{x}) = -1$. Derive, from first principles and using the S-lemma as the central equivalence tool, a closed-form expression for the minimal value of $f(\\mathbf{x})$ over $\\{\\mathbf{x} \\in \\mathbb{R}^{2} : g(\\mathbf{x}) = -1\\}$ in terms of the generalized eigenvalues of the matrix pencil $(A,-B)$. Then compute this value explicitly for the given $A$ and $B$.\n\nYour final reported quantity must be the exact minimal value of $f(\\mathbf{x})$ under the normalized constraint $g(\\mathbf{x}) = -1$. No rounding is required. Express your final answer as a single real number with no units.", "solution": "The problem is first validated to ensure it is well-posed and scientifically sound.\n\n### Step 1: Extract Givens\n- Homogeneous quadratic functions: $f(\\mathbf{x}) = \\mathbf{x}^{\\top} A \\mathbf{x}$ and $g(\\mathbf{x}) = \\mathbf{x}^{\\top} B \\mathbf{x}$, for $\\mathbf{x} \\in \\mathbb{R}^{2}$.\n- Real symmetric matrices:\n$$\nA = \\begin{pmatrix}\n4  1 \\\\\n1  2\n\\end{pmatrix}, \\qquad\nB = \\begin{pmatrix}\n-3  0 \\\\\n0  -1\n\\end{pmatrix}.\n$$\n- The Slater condition is assumed to hold for the inequality $g(\\mathbf{x}) \\le 0$, i.e., there exists a point $\\bar{\\mathbf{x}}$ such that $g(\\bar{\\mathbf{x}})  0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in quadratically constrained quadratic programming (QCQP) and the theory of the S-lemma.\n1.  **Scientifically Grounded:** The problem is based on established mathematical principles of linear algebra, matrix analysis, and optimization theory. The S-lemma is a fundamental result in this area.\n2.  **Well-Posed:** The problem is clearly defined with all necessary data. The matrices $A$ and $B$ are specified, and the objective functions and constraints are unambiguous. The Slater condition is explicitly given. We can verify it: $g(\\mathbf{x}) = -3x_1^2 - x_2^2$. For any non-zero $\\bar{\\mathbf{x}}$, e.g., $\\bar{\\mathbf{x}} = (1, 0)^{\\top}$, we have $g(\\bar{\\mathbf{x}}) = -3  0$. The condition holds.\n3.  **Objective:** The problem is stated in precise and objective mathematical language.\n4.  **Completeness and Consistency:** The problem is self-contained and free from contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution\n\nThe problem is divided into two parts. We address them sequentially.\n\n**Part 1: Analysis of the optimization problem over the cone $\\{ \\mathbf{x} \\in \\mathbb{R}^2 : g(\\mathbf{x}) \\le 0 \\}$**\n\nThe first optimization problem is\n$$\n\\min_{\\mathbf{x} \\in \\mathbb{R}^2} f(\\mathbf{x}) \\quad \\text{subject to} \\quad g(\\mathbf{x}) \\le 0.\n$$\nThe constraint is $g(\\mathbf{x}) = \\mathbf{x}^{\\top} B \\mathbf{x} = -3x_1^2 - x_2^2 \\le 0$. The matrix $B$ is negative definite, as its eigenvalues are $-3$ and $-1$. Consequently, the inequality $g(\\mathbf{x}) \\le 0$ holds for all $\\mathbf{x} \\in \\mathbb{R}^2$ (and is strict for $\\mathbf{x} \\neq \\mathbf{0}$). The feasible set is the entire space $\\mathbb{R}^2$. The problem is therefore equivalent to an unconstrained minimization of $f(\\mathbf{x})$ over $\\mathbb{R}^2$.\n\nThe function $f(\\mathbf{x}) = \\mathbf{x}^{\\top} A \\mathbf{x}$ is a quadratic form. Its properties are determined by the matrix $A$. The eigenvalues of $A$ are given by the roots of the characteristic equation $\\det(A - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} 4-\\lambda  1 \\\\ 1  2-\\lambda \\end{pmatrix} = (4-\\lambda)(2-\\lambda)-1 = \\lambda^2 - 6\\lambda + 7 = 0.\n$$\nThe eigenvalues are $\\lambda = \\frac{6 \\pm \\sqrt{36 - 28}}{2} = 3 \\pm \\sqrt{2}$. Both eigenvalues are positive, so the matrix $A$ is positive definite ($A \\succ 0$).\n\nSince $A$ is positive definite, $f(\\mathbf{x}) = \\mathbf{x}^{\\top}A\\mathbf{x} > 0$ for all $\\mathbf{x} \\neq \\mathbf{0}$, and $f(\\mathbf{0}) = 0$. The global minimum of $f(\\mathbf{x})$ is therefore $0$, achieved at $\\mathbf{x} = \\mathbf{0}$. The point $\\mathbf{x} = \\mathbf{0}$ is in the feasible set, as $g(\\mathbf{0}) = 0$. Thus, the minimal value is finite and is equal to $0$.\n\nWe can also use the S-lemma to confirm that $f(\\mathbf{x}) \\ge 0$ on the feasible set. The S-lemma states that for two quadratic forms $f(\\mathbf{x})$ and $g(\\mathbf{x})$, the implication $g(\\mathbf{x}) \\le 0 \\implies f(\\mathbf{x}) \\ge 0$ holds if and only if there exists a scalar $\\lambda \\ge 0$ such that the quadratic form $f(\\mathbf{x}) - \\lambda g(\\mathbf{x})$ is positive semidefinite, provided the Slater condition holds. In matrix form, this requires that the matrix $A - \\lambda B$ is positive semidefinite for some $\\lambda \\ge 0$. Let us check this condition:\n$$\nA - \\lambda B = \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix} - \\lambda \\begin{pmatrix} -3  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 4+3\\lambda  1 \\\\ 1  2+\\lambda \\end{pmatrix}.\n$$\nFor this matrix to be positive semidefinite for some $\\lambda \\ge 0$, its principal minors must be non-negative.\n1.  $4+3\\lambda \\ge 0$ (true for $\\lambda \\ge 0$).\n2.  $\\det(A-\\lambda B) = (4+3\\lambda)(2+\\lambda) - 1 = 3\\lambda^2 + 10\\lambda + 7 \\ge 0$.\nThe roots of $3\\lambda^2 + 10\\lambda + 7 = 0$ are $\\lambda_1 = -1$ and $\\lambda_2 = -7/3$. Since the parabola opens upwards, the quadratic is positive for all $\\lambda > -1$.\nSince we need to find if there exists a $\\lambda \\ge 0$ that satisfies the condition, and any $\\lambda \\ge 0$ works (as $\\lambda \\ge 0$ is a subset of $\\lambda > -1$), we can choose $\\lambda = 0$. The existence of such a $\\lambda$ is confirmed. This means $f(\\mathbf{x}) \\ge 0$ holds on the feasible set, and since $\\mathbf{0}$ is feasible, the minimum is $0$.\n\n**Part 2: Analysis of the optimization problem over the level set $\\{ \\mathbf{x} \\in \\mathbb{R}^2 : g(\\mathbf{x}) = -1 \\}$**\n\nThe second optimization problem is to find the minimal value of $f(\\mathbf{x})$ subject to the equality constraint $g(\\mathbf{x}) = -1$:\n$$\n\\gamma^* = \\min_{\\mathbf{x} \\in \\mathbb{R}^2} \\mathbf{x}^{\\top} A \\mathbf{x} \\quad \\text{subject to} \\quad \\mathbf{x}^{\\top} B \\mathbf{x} = -1.\n$$\nThe constraint $\\mathbf{x}^{\\top} B \\mathbf{x} = -1$ is equivalent to $-3x_1^2 - x_2^2 = -1$, or $3x_1^2 + x_2^2 = 1$. This defines a compact set (an ellipse), so a minimum value is guaranteed to exist.\n\nThis problem is a QCQP with one equality constraint. We can find its solution using Lagrange duality, which is guaranteed to be strong by the S-lemma. The minimal value $\\gamma^*$ is the supremum of all $\\gamma$ such that the statement \"$\\mathbf{x}^{\\top}A\\mathbf{x} \\ge \\gamma$ for all $\\mathbf{x}$ with $\\mathbf{x}^{\\top}B\\mathbf{x} = -1$\" is true. This can be rewritten using homogenization as:\n$\\mathbf{z}^{\\top} \\begin{pmatrix} A  \\mathbf{0} \\\\ \\mathbf{0}^{\\top}  -\\gamma \\end{pmatrix} \\mathbf{z} \\ge 0$ for all $\\mathbf{z} = (\\mathbf{x}^{\\top}, t)^{\\top}$ such that $\\mathbf{z}^{\\top} \\begin{pmatrix} B  \\mathbf{0} \\\\ \\mathbf{0}^{\\top}  1 \\end{pmatrix} \\mathbf{z} = 0$.\nBy the S-lemma for equality constraints (a result also known as Finsler's Lemma), this implication holds if and only if there exists a scalar $\\lambda \\in \\mathbb{R}$ such that:\n$$\n\\begin{pmatrix} A  \\mathbf{0} \\\\ \\mathbf{0}^{\\top}  -\\gamma \\end{pmatrix} + \\lambda \\begin{pmatrix} B  \\mathbf{0} \\\\ \\mathbf{0}^{\\top}  1 \\end{pmatrix} \\succeq 0.\n$$\nThis block-diagonal matrix is positive semidefinite if and only if both diagonal blocks are positive semidefinite:\n1.  $A + \\lambda B \\succeq 0$.\n2.  $-\\gamma + \\lambda \\ge 0 \\implies \\gamma \\le \\lambda$.\n\nSo, for $\\gamma$ to be a lower bound for the objective function, there must exist a $\\lambda$ such that $A+\\lambda B \\succeq 0$ and $\\gamma \\le \\lambda$. We seek the minimal value $\\gamma^*$, which is the tightest (largest) such lower bound. This is given by the solution to the dual problem, which is to maximize $\\gamma$ subject to these conditions. This is equivalent to finding the maximum $\\lambda$ for which the condition holds:\n$$\n\\gamma^* = \\max \\{ \\lambda \\mid A+\\lambda B \\succeq 0 \\}.\n$$\nLet's analyze the condition $A+\\lambda B \\succeq 0$:\n$$\nA + \\lambda B = \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix} + \\lambda \\begin{pmatrix} -3  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 4-3\\lambda  1 \\\\ 1  2-\\lambda \\end{pmatrix}.\n$$\nThis matrix is positive semidefinite if and only if its principal minors are non-negative:\n1.  $4-3\\lambda \\ge 0 \\implies \\lambda \\le 4/3$.\n2.  $\\det(A+\\lambda B) = (4-3\\lambda)(2-\\lambda) - 1 = 3\\lambda^2 - 10\\lambda + 7 \\ge 0$.\nThe roots of $3\\lambda^2 - 10\\lambda + 7 = 0$ are $\\lambda = \\frac{10 \\pm \\sqrt{100-84}}{6} = \\frac{10 \\pm 4}{6}$, which gives $\\lambda_1 = 1$ and $\\lambda_2 = 7/3$. The quadratic is non-negative for $\\lambda \\in (-\\infty, 1] \\cup [7/3, \\infty)$.\n\nWe must satisfy both $\\lambda \\le 4/3$ and ($\\lambda \\le 1$ or $\\lambda \\ge 7/3$). The intersection of these conditions is $\\lambda \\le 1$. The set of feasible $\\lambda$ is $(-\\infty, 1]$.\nThe dual problem is to find $\\max\\{\\lambda \\mid \\lambda \\in (-\\infty, 1] \\}$. The maximum value is $1$.\nBy strong duality, which holds for this problem, the optimal value of the primal problem is equal to the optimal value of the dual problem. Thus, $\\gamma^* = 1$.\n\nThis result can be expressed in terms of the generalized eigenvalues of the matrix pencil $(A, -B)$. A generalized eigenvalue $\\lambda$ of $(A, -B)$ is a root of $\\det(A - \\lambda(-B)) = \\det(A+\\lambda B) = 0$. As computed above, these eigenvalues are $\\lambda_1 = 1$ and $\\lambda_2 = 7/3$.\nThe problem $\\min \\mathbf{x}^\\top A \\mathbf{x}$ subject to $\\mathbf{x}^\\top (-B) \\mathbf{x} = 1$ is a Rayleigh quotient problem, since $-B$ is positive definite. The minimum value of this quotient is the smallest generalized eigenvalue of the pair $(A, -B)$.\nThe generalized eigenvalues are $1$ and $7/3$. The smallest is $1$.\n\nThe minimal value of $f(\\mathbf{x})$ over $\\{\\mathbf{x} \\in \\mathbb{R}^{2} : g(\\mathbf{x}) = -1\\}$ is $1$.", "answer": "$$\\boxed{1}$$", "id": "3174413"}]}