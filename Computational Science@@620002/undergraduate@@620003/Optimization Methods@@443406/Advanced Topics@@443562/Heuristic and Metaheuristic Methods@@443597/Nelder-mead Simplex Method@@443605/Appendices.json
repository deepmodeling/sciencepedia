{"hands_on_practices": [{"introduction": "Before the Nelder-Mead algorithm can take a step, it must first assess its current state by evaluating the objective function at each vertex of the simplex. This initial exercise focuses on the crucial preparatory step of identifying the worst-performing vertex and calculating the centroid of the remaining, better-performing vertices [@problem_id:2217758]. Mastering this calculation is fundamental, as the centroid acts as the pivot point for all subsequent geometric transformations that guide the search.", "problem": "In an effort to optimize a manufacturing process, an engineer is using the Nelder-Mead algorithm to find a set of two parameters, $x$ and $y$, that minimizes a cost function, $f(x,y)$. At the beginning of an iteration, the algorithm's simplex in the 2-dimensional parameter space consists of three vertices: $P_1$, $P_2$, and $P_3$. The coordinates of these vertices and their corresponding cost function values are given as follows:\n\n- Vertex $P_1$: coordinates $(\\frac{3}{2}, 2)$, with function value $f(P_1) = \\frac{25}{2}$.\n- Vertex $P_2$: coordinates $(3, \\frac{9}{2})$, with function value $f(P_2) = 25$.\n- Vertex $P_3$: coordinates $(\\frac{5}{2}, 1)$, with function value $f(P_3) = \\frac{17}{2}$.\n\nAs a preliminary step for determining the next test point, you need to identify the worst vertex (the one with the highest function value) and calculate the centroid of the remaining vertices.\n\nDetermine the coordinates $(x_w, y_w)$ of the worst vertex and the coordinates $(x_c, y_c)$ of the centroid of the other vertices. Your final answer should be a row matrix containing these four values in the order $(x_w, y_w, x_c, y_c)$. Provide the coordinates as exact fractions or integers.", "solution": "In the Nelder-Mead algorithm, the worst vertex is the one with the highest function value. Given the function values\n$$f(P_{1})=\\frac{25}{2}, \\quad f(P_{2})=25, \\quad f(P_{3})=\\frac{17}{2},$$\nwe note that\n$$25 > \\frac{25}{2}, \\quad 25 > \\frac{17}{2},$$\nso the worst vertex is $P_{2}$ with coordinates $(3, \\frac{9}{2})$. Thus $(x_{w}, y_{w})=(3, \\frac{9}{2})$.\n\nThe centroid of the remaining two vertices $P_{1}=(\\frac{3}{2},2)$ and $P_{3}=(\\frac{5}{2},1)$ is the average of their coordinates. Therefore,\n$$x_{c}=\\frac{\\frac{3}{2}+\\frac{5}{2}}{2}=\\frac{\\frac{8}{2}}{2}=\\frac{4}{2}=2,$$\n$$y_{c}=\\frac{2+1}{2}=\\frac{3}{2}.$$\nHence $(x_{c}, y_{c})=(2, \\frac{3}{2})$.\n\nThe requested row matrix in the order $(x_{w}, y_{w}, x_{c}, y_{c})$ is $\\begin{pmatrix}3 & \\frac{9}{2} & 2 & \\frac{3}{2}\\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} 3 & \\frac{9}{2} & 2 & \\frac{3}{2} \\end{pmatrix}}$$", "id": "2217758"}, {"introduction": "The primary engine of the Nelder-Mead method is the reflection step, which seeks a better point by projecting the worst vertex through the centroid of the remaining points. To build clear intuition for this core mechanism, this problem simplifies the search to a one-dimensional space, where the simplex is merely a line segment connecting two points [@problem_id:2217764]. By performing a single reflection, you will see exactly how the algorithm proposes a new candidate point in its quest for the minimum.", "problem": "The Nelder-Mead method is a popular numerical algorithm for finding the minimum of a function in a multi-dimensional space without requiring the function's derivatives. The method iteratively updates a simplex, a geometric figure consisting of $n+1$ vertices in an $n$-dimensional space, to explore the function's landscape.\n\nConsider the application of this method to find the minimum of a one-dimensional function $f(x)$, where $n=1$. In this case, the simplex is simply a set of $n+1=2$ distinct points. Let the function to be minimized be given by:\n$$f(x) = (x - 2)^2 + 1$$\nSuppose the initial simplex consists of the two points $x_1 = \\frac{5}{2}$ and $x_2 = \\frac{7}{2}$.\n\nAn iteration of the Nelder-Mead algorithm begins by identifying the \"best\" point $x_b$ (the one with the lowest function value) and the \"worst\" point $x_w$ (the one with the highest function value) in the current simplex. Then, a new test point is generated by reflecting the worst point through the centroid of all other points in the simplex. For our one-dimensional, two-point case, the \"centroid of all other points\" is simply the best point, $x_b$.\n\nThe new reflected point, $x_r$, is calculated using the formula:\n$$x_r = x_o + \\alpha(x_o - x_w)$$\nwhere $x_o$ is the centroid of the points excluding the worst one, $x_w$ is the worst point, and $\\alpha$ is a positive constant called the reflection coefficient.\n\nGiven the initial simplex and using a reflection coefficient of $\\alpha = 1$, calculate the value of the reflected point $x_r$ that would be generated in the first step of the algorithm. Express your final answer as an exact fraction.", "solution": "We are given $f(x)=(x-2)^{2}+1$ with initial simplex points $x_{1}=\\frac{5}{2}$ and $x_{2}=\\frac{7}{2}$. To identify the best and worst points, evaluate:\n$$f\\!\\left(\\frac{5}{2}\\right)=\\left(\\frac{5}{2}-2\\right)^{2}+1=\\left(\\frac{1}{2}\\right)^{2}+1=\\frac{1}{4}+1=\\frac{5}{4},$$\n$$f\\!\\left(\\frac{7}{2}\\right)=\\left(\\frac{7}{2}-2\\right)^{2}+1=\\left(\\frac{3}{2}\\right)^{2}+1=\\frac{9}{4}+1=\\frac{13}{4}.$$\nThus the best point is $x_{b}=\\frac{5}{2}$ and the worst point is $x_{w}=\\frac{7}{2}$. In one dimension with two points, the centroid of the points excluding the worst is $x_{o}=x_{b}=\\frac{5}{2}$.\n\nUsing the reflection formula with $\\alpha=1$,\n$$x_{r}=x_{o}+\\alpha(x_{o}-x_{w})=x_{o}+(x_{o}-x_{w})=2x_{o}-x_{w}.$$\nSubstituting $x_{o}=\\frac{5}{2}$ and $x_{w}=\\frac{7}{2}$ gives\n$$x_{r}=2\\cdot\\frac{5}{2}-\\frac{7}{2}=5-\\frac{7}{2}=\\frac{10}{2}-\\frac{7}{2}=\\frac{3}{2}.$$", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "2217764"}, {"introduction": "A full iteration of the Nelder-Mead algorithm involves a sophisticated decision-making process that goes beyond simple reflection, potentially expanding or contracting the simplex to adapt its size and shape. This advanced exercise requires you to navigate two complete iterations for a 2D optimization problem, applying the standard decision rules to choose between reflection, expansion, and contraction moves [@problem_id:3155005]. This practice will solidify your understanding of the algorithm's dynamic and adaptive strategy for navigating complex function landscapes.", "problem": "Consider the derivative-free Nelder-Mead (NM) simplex method for unconstrained minimization in $\\mathbb{R}^{2}$, which iteratively updates a set of $3$ vertices (a simplex) using reflection, expansion, contraction, and shrink moves. Let the objective function be\n$$\nf(x_{1},x_{2})=\\max\\big\\{(x_{1}-1)^{2},\\,10(x_{2}+1)^{2}\\big\\}.\n$$\nUse the following classic NM coefficients: reflection coefficient $\\alpha=1$, expansion coefficient $\\gamma=2$, contraction coefficient $\\rho=\\frac{1}{2}$, and shrink coefficient $\\sigma=\\frac{1}{2}$. Start from the initial simplex with vertices\n$$\nx^{(1)}=(4,-2),\\quad x^{(2)}=(5,0),\\quad x^{(3)}=(2,-3).\n$$\nAt each iteration, order the vertices by increasing objective value so that $x^{(L)}$ is the best (lowest function value), $x^{(H)}$ is the worst (highest function value), and $x^{(G)}$ is the remaining vertex. Then compute the centroid $x^{(C)}$ of all points except $x^{(H)}$, reflect $x^{(H)}$ through $x^{(C)}$ via $x^{(R)}=x^{(C)}+\\alpha\\big(x^{(C)}-x^{(H)}\\big)$, and apply the standard NM decision rules to select among reflection, expansion, outside contraction, inside contraction, or shrink.\n\nPerform exactly $2$ iterations of the NM method under these rules. Predict, for each iteration, which move is accepted. Then, after completing the $2$ iterations, report the value of $f$ at the best vertex in the resulting simplex. Provide the exact value of this final objective.", "solution": "The problem requires performing exactly $2$ iterations of the Nelder-Mead (NM) simplex method for the objective function $f(x_{1},x_{2})=\\max\\big\\{(x_{1}-1)^{2},\\,10(x_{2}+1)^{2}\\big\\}$. The NM parameters are given as the reflection coefficient $\\alpha=1$, expansion coefficient $\\gamma=2$, contraction coefficient $\\rho=\\frac{1}{2}$, and shrink coefficient $\\sigma=\\frac{1}{2}$. The initial simplex is defined by the vertices $x^{(1)}=(4,-2)$, $x^{(2)}=(5,0)$, and $x^{(3)}=(2,-3)$.\n\n**Iteration 1**\n\nFirst, we evaluate the objective function at each of the initial vertices.\nThe vertex $x^{(1)}=(4,-2)$ has the function value:\n$$f(x^{(1)}) = f(4,-2) = \\max\\big\\{(4-1)^{2}, 10(-2+1)^{2}\\big\\} = \\max\\{3^{2}, 10(-1)^{2}\\} = \\max\\{9, 10\\} = 10$$\nThe vertex $x^{(2)}=(5,0)$ has the function value:\n$$f(x^{(2)}) = f(5,0) = \\max\\big\\{(5-1)^{2}, 10(0+1)^{2}\\big\\} = \\max\\{4^{2}, 10(1)^{2}\\} = \\max\\{16, 10\\} = 16$$\nThe vertex $x^{(3)}=(2,-3)$ has the function value:\n$$f(x^{(3)}) = f(2,-3) = \\max\\big\\{(2-1)^{2}, 10(-3+1)^{2}\\big\\} = \\max\\{1^{2}, 10(-2)^{2}\\} = \\max\\{1, 40\\} = 40$$\n\nNext, we order the vertices according to their function values, from best (lowest) to worst (highest).\nThe best vertex is $x^{(L)} = x^{(1)} = (4,-2)$, with $f_L = 10$.\nThe next-best vertex is $x^{(G)} = x^{(2)} = (5,0)$, with $f_G = 16$.\nThe worst vertex is $x^{(H)} = x^{(3)} = (2,-3)$, with $f_H = 40$.\n\nWe compute the centroid $x^{(C)}$ of all vertices except the worst one, $x^{(H)}$:\n$$x^{(C)} = \\frac{1}{2}(x^{(L)} + x^{(G)}) = \\frac{1}{2}\\big((4,-2) + (5,0)\\big) = \\frac{1}{2}(9,-2) = \\left(\\frac{9}{2}, -1\\right)$$\n\nNow, we perform the reflection step. The reflected point $x^{(R)}$ is computed using $\\alpha=1$:\n$$x^{(R)} = x^{(C)} + \\alpha(x^{(C)} - x^{(H)}) = 2x^{(C)} - x^{(H)} = 2\\left(\\frac{9}{2}, -1\\right) - (2,-3) = (9,-2) - (2,-3) = (7,1)$$\nWe evaluate the objective function at $x^{(R)}$:\n$$f_R = f(7,1) = \\max\\big\\{(7-1)^{2}, 10(1+1)^{2}\\big\\} = \\max\\{6^{2}, 10(2)^{2}\\} = \\max\\{36, 40\\} = 40$$\n\nWe apply the NM decision rules. We compare $f_R=40$ with $f_L=10$, $f_G=16$, and $f_H=40$.\nSince $f_R \\ge f_G$ (as $40 \\ge 16$), neither reflection nor expansion is accepted. We proceed to a contraction step.\nWe determine whether to perform an outside or inside contraction. Since $f_R \\ge f_H$ (as $40 \\ge 40$), an **inside contraction** is required.\nThe accepted move for the first iteration is an inside contraction.\n\nThe inside-contracted point $x_{IC}$ is computed with $\\rho=\\frac{1}{2}$:\n$$x_{IC} = x^{(C)} + \\rho(x^{(H)} - x^{(C)}) = (1-\\rho)x^{(C)} + \\rho x^{(H)} = \\frac{1}{2}x^{(C)} + \\frac{1}{2}x^{(H)}$$\n$$x_{IC} = \\frac{1}{2}\\left(\\frac{9}{2}, -1\\right) + \\frac{1}{2}(2,-3) = \\left(\\frac{9}{4}, -\\frac{1}{2}\\right) + \\left(1, -\\frac{3}{2}\\right) = \\left(\\frac{13}{4}, -2\\right)$$\nWe evaluate the objective function at $x_{IC}$:\n$$f_{IC} = f\\left(\\frac{13}{4}, -2\\right) = \\max\\left\\{\\left(\\frac{13}{4}-1\\right)^{2}, 10(-2+1)^{2}\\right\\} = \\max\\left\\{\\left(\\frac{9}{4}\\right)^{2}, 10(-1)^{2}\\right\\} = \\max\\left\\{\\frac{81}{16}, 10\\right\\} = 10$$\nSince $f_{IC} < f_H$ (as $10 < 40$), the contraction is successful. We accept the new point $x_{IC}$ and replace the worst vertex $x^{(H)}$ with it.\nThe new simplex for the next iteration has vertices $\\{x^{(L)}, x^{(G)}, x_{IC}\\}$, which are $\\left\\{(4,-2), (5,0), \\left(\\frac{13}{4}, -2\\right)\\right\\}$.\n\n**Iteration 2**\n\nWe start with the new simplex and their corresponding function values:\n- $v_1 = (4,-2)$ with $f(v_1) = 10$.\n- $v_2 = (5,0)$ with $f(v_2) = 16$.\n- $v_3 = \\left(\\frac{13}{4}, -2\\right)$ with $f(v_3) = 10$.\n\nWe order these vertices:\nThe worst vertex is $x^{(H)} = v_2 = (5,0)$, with $f_H = 16$.\nThe other two vertices have the same best value. We can assign them arbitrarily. Let $x^{(L)} = v_1 = (4,-2)$ with $f_L=10$, and $x^{(G)} = v_3 = \\left(\\frac{13}{4}, -2\\right)$ with $f_G=10$.\n\nWe compute the centroid of the best points:\n$$x^{(C)} = \\frac{1}{2}(x^{(L)} + x^{(G)}) = \\frac{1}{2}\\left((4,-2) + \\left(\\frac{13}{4}, -2\\right)\\right) = \\frac{1}{2}\\left(\\frac{16+13}{4}, -4\\right) = \\frac{1}{2}\\left(\\frac{29}{4}, -4\\right) = \\left(\\frac{29}{8}, -2\\right)$$\n\nWe perform the reflection step with $\\alpha=1$:\n$$x^{(R)} = 2x^{(C)} - x^{(H)} = 2\\left(\\frac{29}{8}, -2\\right) - (5,0) = \\left(\\frac{29}{4}, -4\\right) - (5,0) = \\left(\\frac{29-20}{4}, -4\\right) = \\left(\\frac{9}{4}, -4\\right)$$\nWe evaluate the objective function at $x^{(R)}$:\n$$f_R = f\\left(\\frac{9}{4},-4\\right) = \\max\\left\\{\\left(\\frac{9}{4}-1\\right)^{2}, 10(-4+1)^{2}\\right\\} = \\max\\left\\{\\left(\\frac{5}{4}\\right)^{2}, 10(-3)^{2}\\right\\} = \\max\\left\\{\\frac{25}{16}, 90\\right\\} = 90$$\n\nWe apply the NM rules with $f_R=90$, $f_L=10$, $f_G=10$, and $f_H=16$.\nSince $f_R \\ge f_G$ (as $90 \\ge 10$), we proceed to a contraction.\nSince $f_R \\ge f_H$ (as $90 \\ge 16$), an **inside contraction** is required.\nThe accepted move for the second iteration is again an inside contraction.\n\nThe inside-contracted point $x_{IC}$ is computed with $\\rho=\\frac{1}{2}$:\n$$x_{IC} = \\frac{1}{2}x^{(C)} + \\frac{1}{2}x^{(H)} = \\frac{1}{2}\\left(\\frac{29}{8}, -2\\right) + \\frac{1}{2}(5,0) = \\left(\\frac{29}{16}, -1\\right) + \\left(\\frac{5}{2}, 0\\right) = \\left(\\frac{29+40}{16}, -1\\right) = \\left(\\frac{69}{16}, -1\\right)$$\nWe evaluate the objective function at $x_{IC}$:\n$$f_{IC} = f\\left(\\frac{69}{16},-1\\right) = \\max\\left\\{\\left(\\frac{69}{16}-1\\right)^{2}, 10(-1+1)^{2}\\right\\} = \\max\\left\\{\\left(\\frac{53}{16}\\right)^{2}, 0\\right\\} = \\frac{2809}{256}$$\nTo check for acceptance, we compare $f_{IC}$ with $f_H$. $f_{IC} = \\frac{2809}{256} \\approx 10.97$, and $f_H=16$.\nSince $f_{IC} < f_H$, the contraction is successful. We replace $x^{(H)}$ with $x_{IC}$.\n\nThe final simplex after $2$ iterations consists of the vertices $\\left\\{(4,-2), \\left(\\frac{13}{4}, -2\\right), \\left(\\frac{69}{16}, -1\\right)\\right\\}$.\n\n**Final Result**\n\nThe problem asks for the value of $f$ at the best vertex in the resulting simplex. We examine the function values at the three final vertices:\n- $f(4,-2) = 10$\n- $f\\left(\\frac{13}{4}, -2\\right) = 10$\n- $f\\left(\\frac{69}{16}, -1\\right) = \\frac{2809}{256}$\n\nThe function values are $\\{10, 10, \\frac{2809}{256}\\}$. Since $\\frac{2809}{256} \\approx 10.97$, the minimum (best) value among these is $10$.\nThe accepted moves in the two iterations were: Inside Contraction, and Inside Contraction.\nThe value of $f$ at the best vertex in the final simplex is $10$.", "answer": "$$\\boxed{10}$$", "id": "3155005"}]}