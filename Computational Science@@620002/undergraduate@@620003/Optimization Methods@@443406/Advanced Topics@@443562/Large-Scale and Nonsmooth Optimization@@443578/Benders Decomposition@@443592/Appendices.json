{"hands_on_practices": [{"introduction": "Benders decomposition is a powerful technique for solving large-scale optimization problems with a special structure. This first practice provides a comprehensive, hands-on walkthrough of the entire algorithm applied to a classic generation planning problem [@problem_id:3101899]. By manually executing each step—from solving the initial master problem to generating optimality cuts from the subproblem's dual—you will build a concrete understanding of the iterative process and the convergence criteria that certify optimality.", "problem": "Consider the following two-facility generation planning problem formulated as a Mixed-Integer Linear Program (MILP). There are two potential generators indexed by $i \\in \\{1,2\\}$ and an external market indexed by $i=0$. The system must meet a fixed demand of $D = 7$ units. If generator $i \\in \\{1,2\\}$ is committed (on), it can produce up to a capacity $K_i$ at a variable cost $c_i$ per unit and incurs a fixed commitment cost $F_i$. The external market provides unlimited supply at a variable cost $c_0$ per unit with no fixed cost. For reliability, at least one generator must be committed. The data are: $K_1 = 4$, $K_2 = 6$, $c_1 = 3$, $c_2 = 5$, $c_0 = 9$, $F_1 = 8$, $F_2 = 6$.\n\nThe MILP is:\nMinimize the total cost\n$$\n\\min_{y_1,y_2 \\in \\{0,1\\},\\, x_0,x_1,x_2 \\ge 0} \\; F_1 y_1 + F_2 y_2 + c_0 x_0 + c_1 x_1 + c_2 x_2\n$$\nsubject to the constraints\n$$\nx_0 + x_1 + x_2 = D,\\quad x_1 \\le K_1 y_1,\\quad x_2 \\le K_2 y_2,\\quad y_1 + y_2 \\ge 1.\n$$\n\nYou will apply Benders decomposition, separating the binary master problem over $(y_1,y_2)$ from the linear programming (LP) subproblem over $(x_0,x_1,x_2)$. Introduce the Benders master approximation variable $\\theta$ representing the optimal subproblem value given $(y_1,y_2)$; the master objective is $F_1 y_1 + F_2 y_2 + \\theta$. The subproblem, for fixed $(y_1,y_2)$, is the LP:\n$$\n\\min_{x_0,x_1,x_2 \\ge 0} \\; c_0 x_0 + c_1 x_1 + c_2 x_2 \\quad \\text{subject to} \\quad x_0 + x_1 + x_2 = D,\\; x_1 \\le K_1 y_1,\\; x_2 \\le K_2 y_2.\n$$\n\nTasks:\n1) Form the LP dual of the subproblem using Linear Programming (LP) duality from first principles. Clearly identify the dual variables, their signs, and the dual feasibility constraints.\n\n2) Initialize the Benders master with the constraints $\\theta \\ge 0$ and $y_1 + y_2 \\ge 1$ only. Solve this initial master to obtain the first candidate commitment $y^{(0)} = (y_1^{(0)}, y_2^{(0)})$.\n\n3) For $y^{(0)}$, solve the subproblem and its dual to optimality. Using the optimal dual solution $(\\pi^{(0)}, u_1^{(0)}, u_2^{(0)})$, derive the corresponding Benders optimality cut of the form\n$$\n\\theta \\ge D \\,\\pi^{(k)} - K_1 \\, u_1^{(k)} \\, y_1 - K_2 \\, u_2^{(k)} \\, y_2,\n$$\nand add it to the master.\n\n4) Reoptimize the master to obtain $y^{(1)}$, resolve the subproblem and dual at $y^{(1)}$, derive and add the next optimality cut, and reoptimize the master again.\n\n5) Repeat until the master’s $\\theta$ at the incumbent $(y_1,y_2)$ equals the subproblem’s optimal value, certifying convergence to the true optimal objective. Throughout, ensure each dual solution you use to generate a cut is dual-feasible for the subproblem LP so that the cut is valid globally.\n\nWhat is the optimal total cost $F_1 y_1^{\\star} + F_2 y_2^{\\star} + \\theta^{\\star}$ of the original MILP under these data? Provide your final answer as a single real number. No rounding is required.", "solution": "The problem asks for the optimal total cost of a two-facility generation planning problem, solved using Benders decomposition. The problem is a Mixed-Integer Linear Program (MILP) with binary commitment variables $(y_1, y_2)$ and continuous production variables $(x_0, x_1, x_2)$.\n\nFirst, we validate the problem statement.\nAll given data are extracted:\n- Demand: $D = 7$\n- Generator capacities: $K_1 = 4$, $K_2 = 6$\n- Variable costs: $c_1 = 3$, $c_2 = 5$, $c_0 = 9$ (external market)\n- Fixed costs: $F_1 = 8$, $F_2 = 6$\nThe MILP formulation, the Benders decomposition structure, the subproblem formulation, and the form of the optimality cut are all provided and are standard in the field of optimization. The problem is scientifically grounded in operations research, well-posed, objective, and contains a complete and consistent set of data and constraints. No flaws are identified. The problem is valid.\n\nThe solution proceeds by following the specified steps of the Benders decomposition algorithm.\n\n**1. Formulation of the LP Dual of the Subproblem**\nThe subproblem for a fixed integer vector $\\bar{y} = (\\bar{y}_1, \\bar{y}_2)$ is:\n$$\nQ(\\bar{y}) = \\min_{x_0, x_1, x_2 \\ge 0} \\; c_0 x_0 + c_1 x_1 + c_2 x_2\n$$\nsubject to:\n$$\n\\begin{align*} x_0 + x_1 + x_2 &= D & (\\text{dual variable: } \\pi) \\\\ x_1 &\\le K_1 \\bar{y}_1 & (\\text{dual variable: } u_1) \\\\ x_2 &\\le K_2 \\bar{y}_2 & (\\text{dual variable: } u_2) \\end{align*}\n$$\nTo construct the dual, we can form the Lagrangian. For a minimization problem, we introduce dual variables for constraints of the form $g(x) \\le 0$ with non-negative multipliers. We rewrite the constraints as $D - (x_0+x_1+x_2) = 0$, $x_1 - K_1 \\bar{y}_1 \\le 0$, and $x_2 - K_2 \\bar{y}_2 \\le 0$. The corresponding Lagrangian with dual multipliers $\\pi$ (unrestricted), $u_1 \\ge 0$, and $u_2 \\ge 0$ is:\n$$\nL(x, \\pi, u_1, u_2) = (c_0 x_0 + c_1 x_1 + c_2 x_2) + \\pi(D - x_0 - x_1 - x_2) + u_1(x_1 - K_1 \\bar{y}_1) + u_2(x_2 - K_2 \\bar{y}_2)\n$$\nRearranging terms:\n$$\nL = (c_0 - \\pi)x_0 + (c_1 - \\pi + u_1)x_1 + (c_2 - \\pi + u_2)x_2 + D\\pi - K_1 \\bar{y}_1 u_1 - K_2 \\bar{y}_2 u_2\n$$\nThe dual problem is $\\max_{\\pi, u_1 \\ge 0, u_2 \\ge 0} \\inf_{x_0, x_1, x_2 \\ge 0} L(x, \\pi, u_1, u_2)$. For the infimum over $x$ to be bounded, the coefficients of the non-negative variables $x_i$ must be non-negative. This gives the dual feasibility constraints:\n$$\nc_0 - \\pi \\ge 0 \\implies \\pi \\le c_0 \\\\\nc_1 - \\pi + u_1 \\ge 0 \\implies \\pi - u_1 \\le c_1 \\\\\nc_2 - \\pi + u_2 \\ge 0 \\implies \\pi - u_2 \\le c_2\n$$\nThe LP dual of the subproblem is:\n$$\n\\max_{\\pi, u_1, u_2} \\quad D\\pi - K_1 \\bar{y}_1 u_1 - K_2 \\bar{y}_2 u_2\n$$\nsubject to:\n$$\n\\begin{align*} \\pi &\\le c_0 \\\\ \\pi - u_1 &\\le c_1 \\\\ \\pi - u_2 &\\le c_2 \\\\ u_1, u_2 &\\ge 0 \\\\ \\pi &\\text{ is unrestricted in sign.} \\end{align*}\n$$\nThe dual variables are $\\pi$ for the demand equality constraint, $u_1$ for the capacity constraint of generator $1$, and $u_2$ for the capacity constraint of generator $2$. $u_1$ and $u_2$ must be non-negative.\n\n**2. Benders Decomposition: Iteration $k=0$**\nThe initial Benders master problem is:\n$$\n\\min_{y_1, y_2 \\in \\{0,1\\}, \\theta} \\quad F_1 y_1 + F_2 y_2 + \\theta = 8 y_1 + 6 y_2 + \\theta\n$$\nsubject to:\n$$\n\\begin{align*} y_1 + y_2 &\\ge 1 \\\\ \\theta &\\ge 0 \\end{align*}\n$$\nTo minimize the objective, we set $\\theta$ to its minimum possible value, $\\theta=0$. We then find the combination of $(y_1, y_2)$ satisfying $y_1+y_2 \\ge 1$ that minimizes $8y_1+6y_2$.\n- If $(y_1, y_2)=(1,0)$, cost is $8(1)+6(0)=8$.\n- If $(y_1, y_2)=(0,1)$, cost is $8(0)+6(1)=6$.\n- If $(y_1, y_2)=(1,1)$, cost is $8(1)+6(1)=14$.\nThe minimum is $6$. Thus, the solution to the initial master problem is $y^{(0)} = (0,1)$ and $\\theta^{(0)}=0$. This gives a lower bound on the optimal MILP objective of $6$.\n\n**3. Subproblem Solution and Cut Generation for $y^{(0)}$**\nWe solve the subproblem for $y^{(0)} = (0,1)$. The subproblem is:\n$$\n\\min_{x_0, x_1, x_2 \\ge 0} \\quad 9 x_0 + 3 x_1 + 5 x_2\n$$\nsubject to $x_0 + x_1 + x_2 = 7$, $x_1 \\le 4(0)=0 \\implies x_1=0$, and $x_2 \\le 6(1)=6$.\nWith $x_1=0$, we have $\\min 9x_0 + 5x_2$ subject to $x_0+x_2=7$, $x_2 \\le 6$.\nTo meet the demand of $7$, we use the cheaper source, generator $2$ (cost $5$), up to its capacity: $x_2 = \\min(7, 6) = 6$. The remaining demand, $7-6=1$, is met by the market: $x_0=1$. The primal solution is $x^{(0)}=(1, 0, 6)$.\nThe subproblem optimal value is $Q(y^{(0)}) = 9(1) + 3(0) + 5(6) = 9 + 30 = 39$.\nThe total cost for this feasible solution is $F_1(0) + F_2(1) + Q(y^{(0)}) = 6 + 39 = 45$. This is an upper bound on the optimal MILP cost.\n\nNow, we find the optimal dual variables for this subproblem. Using complementary slackness with the primal solution $x^{(0)}=(1,0,6)$ and dual constraints:\n- $x_0 = 1 > 0 \\implies$ dual constraint for $x_0$ is tight: $\\pi = c_0 = 9$.\n- $x_2 = 6 > 0 \\implies$ dual constraint for $x_2$ is tight: $\\pi - u_2 = c_2 \\implies 9 - u_2 = 5 \\implies u_2 = 4$.\n- The dual constraint for $x_1$ does not need to be tight. From $\\pi - u_1 \\le c_1$, we have $9 - u_1 \\le 3 \\implies u_1 \\ge 6$. Since the dual variable $u_1$ does not appear in the dual objective function for $y^{(0)}=(0,1)$ (as it is multiplied by $\\bar{y}_1=0$), any feasible value will do. An optimal dual solution is $(\\pi^{(0)}, u_1^{(0)}, u_2^{(0)}) = (9, 6, 4)$.\nThe dual objective value is $D\\pi - K_2 y_2 u_2=7(9) - 6(1)(4) = 63 - 24 = 39$, which matches $Q(y^{(0)})$.\nThe first Benders optimality cut is:\n$$\n\\theta \\ge D \\pi^{(0)} - K_1 u_1^{(0)} y_1 - K_2 u_2^{(0)} y_2 \\implies \\theta \\ge 7(9) - 4(6)y_1 - 6(4)y_2 \\implies \\theta \\ge 63 - 24y_1 - 24y_2\n$$\n\n**4. Benders Decomposition: Iteration $k=1$**\nWe add the new cut to the master problem:\n$$\n\\min_{y_1, y_2 \\in \\{0,1\\}, \\theta} \\quad 8 y_1 + 6 y_2 + \\theta\n$$\nsubject to:\n$$\n\\begin{align*} y_1 + y_2 &\\ge 1 \\\\ \\theta &\\ge 0 \\\\ \\theta &\\ge 63 - 24y_1 - 24y_2 \\end{align*}\n$$\nWe evaluate the total objective $8y_1+6y_2+\\theta$ for each feasible $(y_1, y_2)$:\n- For $(y_1, y_2)=(1,0)$: $\\theta \\ge 63-24 = 39$. Cost = $8(1)+6(0)+39 = 47$.\n- For $(y_1, y_2)=(0,1)$: $\\theta \\ge 63-24 = 39$. Cost = $8(0)+6(1)+39 = 45$.\n- For $(y_1, y_2)=(1,1)$: $\\theta \\ge 63-48 = 15$. Cost = $8(1)+6(1)+15 = 14+15 = 29$.\nThe minimum value is $29$. The new master solution is $y^{(1)}=(1,1)$ with $\\theta^{(1)}=15$. The lower bound increases to $29$.\n\nWe solve the subproblem for $y^{(1)}=(1,1)$:\n$$\n\\min_{x_0, x_1, x_2 \\ge 0} \\quad 9 x_0 + 3 x_1 + 5 x_2\n$$\nsubject to $x_0 + x_1 + x_2 = 7$, $x_1 \\le 4$, $x_2 \\le 6$.\nWe load the cheapest generators first:\n1. Use generator $1$ (cost $3$) to its capacity: $x_1=4$. Remaining demand: $7-4=3$.\n2. Use generator $2$ (cost $5$) for the remaining demand: $x_2=3$.\nThe primal solution is $x^{(1)}=(0, 4, 3)$.\nThe subproblem cost is $Q(y^{(1)}) = 9(0) + 3(4) + 5(3) = 12 + 15 = 27$.\nThe total cost is $F_1(1) + F_2(1) + Q(y^{(1)}) = 8+6+27 = 41$. This updates the upper bound to $41$.\nSince $\\theta^{(1)}=15 < Q(y^{(1)})=27$, we are not done. We generate a new cut.\nDual variables for $y^{(1)}=(1,1)$ from $x^{(1)}=(0,4,3)$:\n- $x_2=3 < 6 \\implies$ capacity constraint for generator 2 is not binding, so $u_2=0$.\n- $x_1=4>0 \\implies \\pi-u_1=c_1=3$.\n- $x_2=3>0 \\implies \\pi-u_2=c_2=5$. With $u_2=0$, this gives $\\pi=5$.\n- From $\\pi-u_1=3$, we get $5-u_1=3 \\implies u_1=2$.\nThe dual solution is $(\\pi^{(1)}, u_1^{(1)}, u_2^{(1)}) = (5, 2, 0)$.\nThe dual objective value is $7(5) - 4(1)(2) - 6(1)(0) = 35-8=27$, matching $Q(y^{(1)})$.\nThe new Benders cut is:\n$$\n\\theta \\ge D \\pi^{(1)} - K_1 u_1^{(1)} y_1 - K_2 u_2^{(1)} y_2 \\implies \\theta \\ge 7(5) - 4(2)y_1 - 6(0)y_2 \\implies \\theta \\ge 35 - 8y_1\n$$\n\n**5. Benders Decomposition: Iteration $k=2$ and Convergence**\nWe add the second cut to the master problem:\n$$\n\\min_{y_1, y_2 \\in \\{0,1\\}, \\theta} \\quad 8 y_1 + 6 y_2 + \\theta\n$$\nsubject to:\n$$\n\\begin{align*} y_1 + y_2 &\\ge 1 \\\\ \\theta &\\ge 0 \\\\ \\theta &\\ge 63 - 24y_1 - 24y_2 & (\\text{Cut 1}) \\\\ \\theta &\\ge 35 - 8y_1 & (\\text{Cut 2}) \\end{align*}\n$$\nWe evaluate the total objective $8y_1+6y_2+\\theta$ for each feasible $(y_1, y_2)$:\n- For $(y_1, y_2)=(1,0)$: $\\theta \\ge \\max(63-24, 35-8) = \\max(39, 27) = 39$. Cost = $8+0+39 = 47$.\n- For $(y_1, y_2)=(0,1)$: $\\theta \\ge \\max(63-24, 35-0) = \\max(39, 35) = 39$. Cost = $0+6+39 = 45$.\n- For $(y_1, y_2)=(1,1)$: $\\theta \\ge \\max(63-48, 35-8) = \\max(15, 27) = 27$. Cost = $8+6+27 = 41$.\nThe minimum value is $41$. The new master solution is $y^{(2)}=(1,1)$ with $\\theta^{(2)}=27$. The lower bound is now $41$.\nThe current lower bound ($41$) is equal to the current best upper bound (found with solution $y=(1,1)$, cost $41$). Therefore, the algorithm has converged.\nThe optimal commitment is $y^{\\star}=(1,1)$. The optimal value of the subproblem for this commitment is $Q(y^{\\star})=27$. The optimal total cost is $F_1 y^{\\star}_1 + F_2 y^{\\star}_2 + Q(y^{\\star}) = 8(1) + 6(1) + 27 = 41$.\n\nFinal check: The master problem at this last iteration gives $y^{(2)}=(1,1)$ and $\\theta^{(2)}=27$. We check the convergence condition: is $Q(y^{(2)}) \\le \\theta^{(2)}$? We have $Q(1,1)=27$ and $\\theta^{(2)}=27$. The condition $27 \\le 27$ is satisfied. The process terminates.\n\nThe optimal total cost is $41$.", "answer": "$$\n\\boxed{41}\n$$", "id": "3101899"}, {"introduction": "The standard Benders algorithm assumes the subproblem is always feasible; however, this is not always the case. This exercise focuses on the crucial mechanism for handling infeasible subproblems: the generation of feasibility cuts [@problem_id:3101858]. You will explore a pure-feasibility problem and learn how to derive these cuts from the extreme rays of the dual cone, effectively teaching the master problem to avoid decisions that lead to impossible scenarios.", "problem": "Consider a two-stage pure-feasibility setup suitable for Benders decomposition, where the master problem controls a decision vector $y \\in \\mathbb{R}^{2}$ and the subproblem checks feasibility of a linear system in a single auxiliary variable $x \\in \\mathbb{R}$. The master decision set is the box $Y = \\{ y \\in \\mathbb{R}^{2} \\mid 0 \\leq y_{1} \\leq 2,\\ 0 \\leq y_{2} \\leq 2 \\}$, and the master objective is to minimize the linear function $y_{1} + y_{2}$. The subproblem, for a given $y$, is the set of linear constraints in $x$:\n$$\nx \\geq 2 - y_{1},\\qquad x \\geq 2 - y_{2},\\qquad x \\leq 1,\\qquad x \\geq 0.\n$$\nThis subproblem only enforces feasibility and has no objective. Begin from an initial master trial point $y^{0} = (0, 0)$.\n\nUsing only feasibility cuts generated from the subproblem’s dual extreme rays, formulate the cuts that exclude infeasible $y$ and solve the master problem. Interpret these cuts geometrically as half-spaces whose outward normals correspond to extreme rays of the dual cone, and view the resulting update of $y$ as the Euclidean projection of $y^{0}$ onto the polyhedral region of $y$ that makes the subproblem feasible. Compute the Euclidean distance $\\|y^{\\star} - y^{0}\\|_{2}$ between the initial point $y^{0}$ and the master solution $y^{\\star}$ found using feasibility cuts alone.\n\nExpress the final distance exactly, with no rounding and no units, as a single real-valued number or a single closed-form analytic expression.", "solution": "The problem asks us to solve a two-stage optimization problem using Benders decomposition. The master problem involves minimizing a function of the vector $y \\in \\mathbb{R}^2$, while the subproblem checks for the feasibility of a system of linear inequalities for a given $y$.\n\nThe master problem is:\n$$\n\\min_{y \\in Y} y_{1} + y_{2}\n$$\nwhere the master decision set is $Y = \\{ y \\in \\mathbb{R}^{2} \\mid 0 \\leq y_{1} \\leq 2,\\ 0 \\leq y_{2} \\leq 2 \\}$.\n\nFor a fixed $y$, the subproblem is to find a scalar $x \\in \\mathbb{R}$ satisfying the following constraints:\n1. $x \\geq 2 - y_{1}$\n2. $x \\geq 2 - y_{2}$\n3. $x \\leq 1$\n4. $x \\geq 0$\n\nThis system of inequalities can be rewritten as finding an $x$ such that $\\max(2 - y_{1}, 2 - y_{2}, 0) \\leq x \\leq 1$. Such an $x$ exists if and only if the lower bound is less than or equal to the upper bound, i.e., $\\max(2 - y_{1}, 2 - y_{2}, 0) \\leq 1$. This single condition is equivalent to the set of conditions:\n- $2 - y_{1} \\leq 1 \\implies y_{1} \\geq 1$\n- $2 - y_{2} \\leq 1 \\implies y_{2} \\geq 1$\n- $0 \\leq 1$ (which is always true)\n\nThus, the subproblem is feasible if and only if $y_{1} \\geq 1$ and $y_{2} \\geq 1$. We will derive these conditions formally using Benders feasibility cuts.\n\nThe Benders decomposition algorithm starts with an initial trial point $y^{0} = (0, 0)$. We substitute this into the subproblem constraints:\n$x \\geq 2 - 0 = 2$\n$x \\geq 2 - 0 = 2$\n$x \\leq 1$\n$x \\geq 0$\nThis simplifies to $2 \\leq x \\leq 1$, which is impossible. The subproblem is infeasible. Therefore, we must generate one or more feasibility cuts.\n\nA Benders feasibility cut is derived from an extreme ray of the dual of the feasibility subproblem. Let's write the subproblem in the standard form $Ax \\leq b(y)$:\n$-x \\leq y_{1} - 2$\n$-x \\leq y_{2} - 2$\n$x \\leq 1$\n$-x \\leq 0$\nThis can be written as:\n$$\n\\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{pmatrix} x \\leq \\begin{pmatrix} y_{1} - 2 \\\\ y_{2} - 2 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\nAccording to Farkas' Lemma, this system is infeasible if and only if there exists a vector $u \\geq 0$ such that $u^T A = 0$ and $u^T b(y) < 0$. A Benders feasibility cut enforces the necessary condition for feasibility, which is $u^T b(y) \\geq 0$ for all extreme rays $u$ of the dual cone $\\{u \\ge 0 \\mid u^T A=0\\}$.\n\nLet $u = (u_{1}, u_{2}, u_{3}, u_{4})^T$. The condition $u \\ge 0$ means $u_i \\ge 0$ for $i=1,2,3,4$. The condition $u^T A = 0$ is:\n$$\n\\begin{pmatrix} u_{1} & u_{2} & u_{3} & u_{4} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{pmatrix} = -u_{1} - u_{2} + u_{3} - u_{4} = 0\n$$\nThis can be rearranged to $u_{3} = u_{1} + u_{2} + u_{4}$. The extreme rays of this cone can be found by setting all but one of the independent variables ($u_{1}, u_{2}, u_{4}$) to zero.\n1. Set $u_{1}=1, u_{2}=0, u_{4}=0$: This gives $u_{3}=1$. The ray is $u^{(1)} = (1, 0, 1, 0)^T$.\n2. Set $u_{1}=0, u_{2}=1, u_{4}=0$: This gives $u_{3}=1$. The ray is $u^{(2)} = (0, 1, 1, 0)^T$.\n3. Set $u_{1}=0, u_{2}=0, u_{4}=1$: This gives $u_{3}=1$. The ray is $u^{(3)} = (0, 0, 1, 1)^T$.\n\nThese rays generate the feasibility cuts $(u^{(i)})^T b(y) \\geq 0$.\nThe vector $b(y)$ is $(y_{1} - 2, y_{2} - 2, 1, 0)^T$.\n\nCut from $u^{(1)}$:\n$$\n(u^{(1)})^T b(y) = 1(y_{1} - 2) + 0(y_{2} - 2) + 1(1) + 0(0) = y_{1} - 1 \\geq 0 \\implies y_{1} \\geq 1\n$$\nCut from $u^{(2)}$:\n$$\n(u^{(2)})^T b(y) = 0(y_{1} - 2) + 1(y_{2} - 2) + 1(1) + 0(0) = y_{2} - 1 \\geq 0 \\implies y_{2} \\geq 1\n$$\nCut from $u^{(3)}$:\n$$\n(u^{(3)})^T b(y) = 0(y_{1} - 2) + 0(y_{2} - 2) + 1(1) + 1(0) = 1 \\geq 0\n$$\nThe third cut, $1 \\geq 0$, is trivial and adds no restriction. The two non-trivial feasibility cuts are $y_{1} \\geq 1$ and $y_{2} \\geq 1$.\n\nWe now add these cuts to the master problem to form the complete master problem:\n$$\n\\min_{y} \\quad y_{1} + y_{2}\n$$\nSubject to:\n$$\n0 \\leq y_{1} \\leq 2 \\\\\n0 \\leq y_{2} \\leq 2 \\\\\ny_{1} \\geq 1 \\\\\ny_{2} \\geq 1\n$$\nCombining these constraints, the feasible region for $y$ becomes $1 \\leq y_{1} \\leq 2$ and $1 \\leq y_{2} \\leq 2$. The objective function $y_{1} + y_{2}$ is to be minimized over this square region. The minimum value of this linear function will occur at the corner of the feasible region where $y_{1}$ and $y_{2}$ are smallest. This is the point $(y_{1}, y_{2}) = (1, 1)$.\nThus, the optimal solution is $y^{\\star} = (1, 1)$.\n\nGeometrically, the cuts $y_{1} \\geq 1$ and $y_{2} \\geq 1$ define two half-spaces. Their intersection forms the feasible region for the subproblem. The initial trial point $y^0 = (0,0)$ is outside this region. The problem notes an interpretation of the solution $y^\\star$ as the Euclidean projection of $y^0$ onto the feasible region. The feasible region for $y$ is the square $[1, 2] \\times [1, 2]$. The projection of the point $(0,0)$ onto this square is indeed $(1,1)$, which coincides with our solution $y^{\\star}$. This occurs because the objective function and the constraints are structured in a particular way for this specific problem.\n\nFinally, we compute the Euclidean distance between the initial point $y^{0}=(0, 0)$ and the solution $y^{\\star}=(1, 1)$:\n$$\n\\| y^{\\star} - y^{0} \\|_{2} = \\| (1, 1) - (0, 0) \\|_{2} = \\| (1, 1) \\|_{2} = \\sqrt{1^{2} + 1^{2}} = \\sqrt{2}\n$$\nThe required distance is $\\sqrt{2}$.", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "3101858"}, {"introduction": "Beyond the mechanics, a deep understanding of Benders decomposition comes from its geometric interpretation. This exercise uses a carefully constructed example to reveal the connection between Benders cuts and the underlying convex recourse function they approximate [@problem_id:3101945]. By analyzing a case where the algorithm converges in a single iteration, you will gain a powerful intuition for how cuts act as supporting hyperplanes and why the method is guaranteed to find the optimal solution.", "problem": "Consider the following two-stage separable linear optimization model suitable for Benders decomposition. The first-stage (master) decision variable is $y \\in \\mathbb{R}$ with feasibility set $0 \\le y \\le 2$ and first-stage cost $2y$. The second-stage (recourse) problem, parameterized by $y$, has a single decision variable $x \\in \\mathbb{R}_{+}$ and is defined by the linear programming (LP) subproblem\n$$\nQ(y) \\equiv \\min_{x \\ge 0} \\left\\{ x \\,\\middle|\\, x \\ge 3 - y \\right\\}.\n$$\nThus the full problem is\n$$\n\\min_{0 \\le y \\le 2} \\left\\{ 2y + Q(y) \\right\\}.\n$$\nYour tasks are:\n- Using only fundamental facts from linear optimization, derive the dual representation of the recourse function $Q(y)$ and characterize it as the pointwise supremum of supporting hyperplanes.\n- Construct and explain, from geometric first principles, why in this model the function $Q(y)$ coincides with a single supporting hyperplane over the entire feasible set of $y$, and why this implies that the first Benders cut obtained at any initial $y^{0} \\in [0,2]$ is already optimal (degeneracy).\n- Formulate the one-cut Benders master problem and solve it exactly.\n- Compute the optimal objective value of the original two-stage problem. Provide this final answer as a single real number. No rounding is required.", "solution": "### Task 1: Dual Representation of the Recourse Function $Q(y)$\n\nThe second-stage (recourse) problem is given by:\n$$\nQ(y) \\equiv \\min_{x} \\{ 1 \\cdot x \\mid x \\ge 3 - y, x \\ge 0 \\}\n$$\nThis is a linear program (LP) in the variable $x$. To find its dual representation, we first write it in a standard form. Let's introduce a dual variable $\\pi_1$ for the constraint $x \\ge 3 - y$ and a dual variable $\\pi_2$ for the non-negativity constraint $x \\ge 0$. The primal LP is:\n$$\n\\text{(Primal)} \\quad \\min_{x} \\quad 1 \\cdot x\n$$\n$$\n\\text{subject to:} \\quad 1 \\cdot x \\ge 3 - y\n$$\n$$\n\\quad 1 \\cdot x \\ge 0\n$$\nThe dual linear program is formulated by maximizing the inner product of the right-hand side a vector of dual variables, subject to constraints on the dual variables. Let $\\pi = (\\pi_1, \\pi_2)$ be the vector of dual variables, both non-negative since the primal constraints are of the '$\\ge$' type.\n$$\n\\text{(Dual)} \\quad \\max_{\\pi_1, \\pi_2} \\quad (3-y)\\pi_1 + 0 \\cdot \\pi_2\n$$\n$$\n\\text{subject to:} \\quad 1 \\cdot \\pi_1 + 1 \\cdot \\pi_2 = 1\n$$\n$$\n\\quad \\pi_1 \\ge 0, \\pi_2 \\ge 0\n$$\nBy strong duality of linear programming, the optimal value of the primal, $Q(y)$, is equal to the optimal value of the dual. We can simplify the dual problem. From the equality constraint, $\\pi_2 = 1 - \\pi_1$. The condition $\\pi_2 \\ge 0$ implies $1 - \\pi_1 \\ge 0$, so $\\pi_1 \\le 1$. The condition $\\pi_1 \\ge 0$ is already stated. The feasible region for $\\pi_1$ is thus $[0, 1]$. We can eliminate $\\pi_2$ and write the dual problem solely in terms of $\\pi_1$ (let's rename it $\\pi$ for simplicity):\n$$\nQ(y) = \\max_{0 \\le \\pi \\le 1} \\{(3-y)\\pi\\}\n$$\nThis is the dual representation of the recourse function $Q(y)$. It characterizes $Q(y)$ as the pointwise supremum of an infinite collection of linear functions (supporting hyperplanes) of $y$, of the form $L_{\\pi}(y) = (3-y)\\pi$ for each $\\pi \\in [0, 1]$. The feasible set for the dual variable $\\pi$, denoted $\\Pi = [0, 1]$, is a polyhedron (a line segment in this case). The extreme points of this polyhedron are $\\pi=0$ and $\\pi=1$. For LPs, the optimal value is achieved at an extreme point. Thus, we can write $Q(y)$ as:\n$$\nQ(y) = \\max \\{ (3-y) \\cdot 0, (3-y) \\cdot 1 \\} = \\max \\{0, 3-y\\}\n$$\n\n### Task 2: The Single Optimal Benders Cut\n\nThe Benders decomposition algorithm iteratively builds an approximation of $Q(y)$ using cuts. An optimality cut is generated at a point $y^k$ using an optimal dual solution $\\pi^k$ of the subproblem $Q(y^k)$. The cut is given by the supporting hyperplane $\\theta \\ge (3-y)\\pi^k$, where $\\theta$ is an epigraph variable representing $Q(y)$.\n\nLet's analyze the optimal dual solution $\\pi^*$ for any given $y$ in its feasible domain $[0, 2]$. The dual problem is $\\max_{0 \\le \\pi \\le 1} \\{(3-y)\\pi\\}$.\n- The feasible set for $y$ is $[0, 2]$.\n- For any $y \\in [0, 2]$, the term $(3-y)$ is strictly positive. Specifically, $3-y \\in [1, 3]$.\n- To maximize the product $(3-y)\\pi$, where $(3-y) > 0$ and $\\pi \\in [0, 1]$, we must choose the largest possible value for $\\pi$.\n- Therefore, for any $y \\in [0, 2]$, the unique optimal dual solution is $\\pi^* = 1$.\n\nThis has a critical implication for Benders decomposition. Regardless of the initial choice of $y^0 \\in [0, 2]$ for the first-stage problem, solving the second-stage subproblem $Q(y^0)$ will always yield the same optimal dual solution $\\pi^0 = 1$. Consequently, the first Benders cut generated will always be:\n$$\n\\theta \\ge (3-y)\\pi^0 \\quad \\implies \\quad \\theta \\ge 3-y\n$$\nNow, let's examine the actual function $Q(y)$ over the domain $y \\in [0, 2]$. From our previous derivation, $Q(y) = \\max\\{0, 3-y\\}$. Since $y \\in [0, 2]$, $3-y \\ge 1 > 0$, so the maximum is always $3-y$. Thus, over the entire feasible region of $y$, the recourse function is exactly $Q(y) = 3-y$.\n\nGeometrically, the function $Q(y)$ is the upper envelope of the lines $L_0(y) = 0$ and $L_1(y) = 3-y$. The \"kink\" in this piecewise linear function occurs where $0 = 3-y$, i.e., at $y=3$. The entire feasible domain for the master problem, $y \\in [0, 2]$, lies to the left of this kink. In this region, $Q(y)$ is not piecewise linear but purely linear, coinciding exactly with the single supporting hyperplane $L_1(y) = 3-y$.\n\nThe first Benders cut, $\\theta \\ge 3-y$, is therefore not just an approximation or a lower bound for $Q(y)$, but an exact representation: $\\theta \\ge Q(y)$. Adding this cut to the master problem provides all the necessary information about the second stage. No further cuts can improve upon this, so the Benders algorithm converges in a single iteration. This is a special case (which the problem refers to as degeneracy) where the iterative nature of the algorithm collapses into a single step.\n\n### Task 3: The One-Cut Benders Master Problem\n\nThe full problem is $\\min_{0 \\le y \\le 2} \\{2y + Q(y)\\}$. Using an epigraph variable $\\theta$ to represent $Q(y)$, the Benders master problem is initially:\n$$\n\\min_{y, \\theta} \\quad 2y + \\theta\n$$\n$$\n\\text{subject to:} \\quad 0 \\le y \\le 2\n$$\nAfter one iteration, we add the single, optimal cut $\\theta \\ge 3-y$. The master problem becomes:\n$$\n\\min_{y, \\theta} \\quad 2y + \\theta\n$$\n$$\n\\text{subject to:} \\quad 0 \\le y \\le 2\n$$\n$$\n\\quad \\theta \\ge 3-y\n$$\nSince the objective is to minimize $2y+\\theta$, and $\\theta$ only has a lower bound, the optimal solution will satisfy the cut constraint with equality, i.e., $\\theta = 3-y$. We can substitute this into the objective function to eliminate $\\theta$:\n$$\n\\min_{0 \\le y \\le 2} \\{2y + (3-y)\\}\n$$\nThis simplifies to:\n$$\n\\min_{0 \\le y \\le 2} \\{y + 3\\}\n$$\nThe objective function $f(y) = y+3$ is a strictly increasing function of $y$. To minimize this function over the closed interval $[0, 2]$, we must select the minimum possible value for $y$, which is $y=0$.\nThe optimal first-stage decision is $y^* = 0$.\n\n### Task 4: Optimal Objective Value\n\nThe optimal objective value of the original two-stage problem can be computed by substituting $y^*=0$ back into the original objective function, $2y + Q(y)$.\nFirst, evaluate $Q(y^*)$:\n$$\nQ(0) = \\max\\{0, 3-0\\} = 3\n$$\nThen, evaluate the total cost:\n$$\n2y^* + Q(y^*) = 2(0) + 3 = 3\n$$\nAlternatively, from the solution to the one-cut master problem, the minimum value was found to be $y^*+3 = 0+3=3$.\nThe optimal objective value of the original problem is $3$.", "answer": "$$\\boxed{3}$$", "id": "3101945"}]}