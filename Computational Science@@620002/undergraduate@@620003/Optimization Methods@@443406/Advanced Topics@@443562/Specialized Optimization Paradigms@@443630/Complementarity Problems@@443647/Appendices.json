{"hands_on_practices": [{"introduction": "A key skill in optimization is recognizing how to reformulate seemingly complex problems into standard forms. This practice demonstrates the power of the complementarity framework by showing how a system of non-linear, non-differentiable absolute value equations (AVEs) can be transformed into a standard Linear Complementarity Problem (LCP). By working through this transformation [@problem_id:3109507], you will develop the algebraic dexterity to model a broader class of problems and understand the conditions under which such a reformulation is valid.", "problem": "Consider absolute value equations (AVE) of the form $A x + |B x| = c$ in $\\mathbb{R}^n$, where $A \\in \\mathbb{R}^{n \\times n}$ is nonsingular, $B \\in \\mathbb{R}^{n \\times n}$, and $c \\in \\mathbb{R}^n$. The linear complementarity problem (LCP) is defined as: given $M \\in \\mathbb{R}^{m \\times m}$ and $q \\in \\mathbb{R}^m$, find $w, z \\in \\mathbb{R}^m$ such that $w = M z + q$, $w \\ge 0$, $z \\ge 0$, and $w^\\top z = 0$, where inequalities are interpreted componentwise. Starting from these definitions, do the following without using any pre-derived transformation formulas.\n\n1) Using only fundamental manipulations and definitions, introduce auxiliary nonnegative variables that encode $|B x|$ and show that the AVE can be reformulated as an LCP in a single nonnegative variable. Express the LCP data $(M, q)$ explicitly in terms of $A$, $B$, and $c$, and clearly state all conditions you use on $A$ and $B$ to justify the reformulation.\n\n2) Apply your reformulation to the specific instance with\n$$\nA = \\begin{pmatrix} 3 & 1 \\\\ 0 & 2 \\end{pmatrix},\\quad\nB = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix},\\quad\nc = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}.\n$$\nCompute the corresponding $(M, q)$, solve the resulting LCP exactly, recover the unique solution $x$ of the AVE, and finally report the scalar $s = x_1 + 2 x_2$ in exact form.\n\n3) Briefly explain, in terms of properties of $M$ and related matrices you have constructed, when this AVE has a unique solution and how an LCP algorithm can be used to compute it. Name at least one algorithm and explain how the AVE-to-LCP reformulation enables its use.\n\nYour final reported quantity must be the single scalar $s = x_1 + 2 x_2$ from part $2$ in exact form (no rounding).", "solution": "The problem as stated is formally sound, self-contained, and grounded in established principles of optimization theory and linear algebra. It presents a well-posed mathematical task. We will proceed with the solution.\n\nThe problem is divided into three parts. We will address them in sequence.\n\nPart 1: Reformulation of the Absolute Value Equation (AVE) into a Linear Complementarity Problem (LCP).\n\nWe are given the Absolute Value Equation (AVE):\n$$A x + |B x| = c$$\nwhere $A, B \\in \\mathbb{R}^{n \\times n}$, $c \\in \\mathbb{R}^n$, and $x \\in \\mathbb{R}^n$. $A$ is assumed to be nonsingular. The absolute value of a vector is taken componentwise.\n\nWe are also given the definition of the Linear Complementarity Problem (LCP): Find $w, z \\in \\mathbb{R}^m$ such that\n$$w = M z + q, \\quad w \\ge 0, \\quad z \\ge 0, \\quad w^\\top z = 0$$\nfor given $M \\in \\mathbb{R}^{m \\times m}$ and $q \\in \\mathbb{R}^m$.\n\nTo reformulate the AVE as an LCP, we must handle the non-linear term $|Bx|$. Let $y = Bx$. We need to express $|y|$ using variables suitable for an LCP. For any scalar $y_i$, its absolute value $|y_i|$ can be defined through a complementarity relationship. Consider the identity $|y_i| = y_i + 2\\max(0, -y_i)$. Let $z_i = \\max(0, -y_i)$. By definition, $z_i \\ge 0$.\nIf $y_i \\ge 0$, then $z_i = 0$, and the identity gives $|y_i| = y_i$.\nIf $y_i < 0$, then $z_i = -y_i > 0$, and the identity gives $|y_i| = y_i + 2(-y_i) = -y_i$.\nThis is correct.\nThe condition $z_i = \\max(0, -y_i)$ can be expressed using complementarity. Let $w_i = y_i + z_i$.\nIf $y_i \\ge 0$, then $z_i=0$, so $w_i = y_i \\ge 0$ and $w_i z_i = y_i \\cdot 0 = 0$.\nIf $y_i < 0$, then $z_i=-y_i$, so $w_i = y_i + (-y_i) = 0$ and $w_i z_i = 0 \\cdot (-y_i) = 0$.\nIn both cases, we have $z_i \\ge 0$, $w_i \\ge 0$, and $w_i z_i = 0$.\nSo, for a vector $y$, we can write $|y| = y + 2z$ subject to the conditions $z \\ge 0$, $w = y+z \\ge 0$, and $w^\\top z = 0$.\n\nLet's apply this to the AVE. Let $y = Bx$. The AVE becomes:\n$$A x + (Bx + 2z) = c$$\nwhere $z \\in \\mathbb{R}^n$ is an auxiliary variable vector satisfying the LCP conditions with $w = Bx+z$.\nCombining terms involving $x$, we get:\n$$(A+B)x + 2z = c$$\nTo solve for $x$, we must assume that the matrix $(A+B)$ is nonsingular. This is a critical condition for this reformulation. Under this assumption, we have:\n$$x = (A+B)^{-1}(c - 2z)$$\nNow, we must express the slack variable $w$ in terms of $z$ to obtain the LCP form.\n$$w = Bx + z$$\nSubstitute the expression for $x$:\n$$w = B\\left((A+B)^{-1}(c - 2z)\\right) + z$$\n$$w = B(A+B)^{-1}c - 2B(A+B)^{-1}z + I z$$\n$$w = \\left(I - 2B(A+B)^{-1}\\right)z + B(A+B)^{-1}c$$\nThis is precisely the form of an LCP, $w = Mz+q$, where the variable vector is $z \\in \\mathbb{R}^n$, and the LCP data $(M, q)$ are given by:\n$$M = I - 2B(A+B)^{-1} \\in \\mathbb{R}^{n \\times n}$$\n$$q = B(A+B)^{-1}c \\in \\mathbb{R}^{n}$$\nThe LCP is to find $z \\in \\mathbb{R}^n$ that satisfies $w = Mz+q$, $z \\ge 0$, $w \\ge 0$, and $w^\\top z = 0$. Once such a $z$ is found, the solution $x$ to the original AVE can be recovered using $x = (A+B)^{-1}(c - 2z)$.\nThe key condition used to justify this reformulation is that the matrix $(A+B)$ must be nonsingular.\n\nPart 2: Application to a specific instance.\n\nWe are given the data:\n$$A = \\begin{pmatrix} 3 & 1 \\\\ 0 & 2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$$\nFirst, we check the condition for the reformulation. We compute $A+B$:\n$$A+B = \\begin{pmatrix} 3 & 1 \\\\ 0 & 2 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 4 & 1 \\\\ 1 & 3 \\end{pmatrix}$$\nThe determinant is $\\det(A+B) = 4 \\cdot 3 - 1 \\cdot 1 = 11$, which is non-zero. Thus, $(A+B)$ is nonsingular and the reformulation is valid.\nNext, we compute the inverse of $(A+B)$:\n$$(A+B)^{-1} = \\frac{1}{11}\\begin{pmatrix} 3 & -1 \\\\ -1 & 4 \\end{pmatrix}$$\nNow we compute the LCP matrix $M$ and vector $q$:\n$$q = B(A+B)^{-1}c = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} \\frac{1}{11}\\begin{pmatrix} 3 & -1 \\\\ -1 & 4 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$$\n$$q = \\frac{1}{11} \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} 3(2) - 1(3) \\\\ -1(2) + 4(3) \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 10 \\end{pmatrix} = \\frac{1}{11}\\begin{pmatrix} 3 \\\\ 13 \\end{pmatrix}$$\n\n$$M = I - 2B(A+B)^{-1} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - 2 \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix} \\frac{1}{11}\\begin{pmatrix} 3 & -1 \\\\ -1 & 4 \\end{pmatrix}$$\n$$M = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\frac{2}{11} \\begin{pmatrix} 1(3)+0(-1) & 1(-1)+0(4) \\\\ 1(3)+1(-1) & 1(-1)+1(4) \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\frac{2}{11} \\begin{pmatrix} 3 & -1 \\\\ 2 & 3 \\end{pmatrix}$$\n$$M = \\begin{pmatrix} 1 - 6/11 & 2/11 \\\\ -4/11 & 1 - 6/11 \\end{pmatrix} = \\frac{1}{11}\\begin{pmatrix} 5 & 2 \\\\ -4 & 5 \\end{pmatrix}$$\nThe LCP is to find $z=\\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} \\ge 0$ such that $w = Mz+q \\ge 0$ and $w^\\top z = 0$. We solve this by considering the four possible sets of basic variables:\n1.  $z_1=0, z_2=0$: This implies $w = q = \\frac{1}{11}\\begin{pmatrix} 3 \\\\ 13 \\end{pmatrix}$. Since $w_1 = 3/11 \\ge 0$ and $w_2 = 13/11 \\ge 0$, this is a valid solution to the LCP. So, $z = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ is a solution.\n2.  $w_1=0, z_2=0$: The first equation of $w=Mz+q$ becomes $0 = \\frac{1}{11}(5z_1 + 3)$, which gives $z_1 = -3/5$. This violates $z_1 \\ge 0$. No solution in this case.\n3.  $z_1=0, w_2=0$: The second equation becomes $0 = \\frac{1}{11}(5z_2 + 13)$, which gives $z_2 = -13/5$. This violates $z_2 \\ge 0$. No solution in this case.\n4.  $w_1=0, w_2=0$: This requires solving $Mz = -q$. $\\frac{1}{11}\\begin{pmatrix} 5 & 2 \\\\ -4 & 5 \\end{pmatrix}z = -\\frac{1}{11}\\begin{pmatrix} 3 \\\\ 13 \\end{pmatrix}$. This system is $\\begin{cases} 5z_1 + 2z_2 = -3 \\\\ -4z_1 + 5z_2 = -13 \\end{cases}$. Solving this system yields $z_1 = 1/3$ and $z_2 = -7/3$. This violates $z_2 \\ge 0$. No solution in this case.\n\nThe only solution to the LCP is $z = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\nNow we recover the unique solution $x$ of the AVE:\n$$x = (A+B)^{-1}(c - 2z) = (A+B)^{-1}c$$\nWe have already computed this vector in the process of finding $q$:\n$$x = \\frac{1}{11}\\begin{pmatrix} 3 \\\\ 10 \\end{pmatrix}$$\nSo, $x_1 = 3/11$ and $x_2 = 10/11$.\nFinally, we compute the scalar $s$:\n$$s = x_1 + 2x_2 = \\frac{3}{11} + 2\\left(\\frac{10}{11}\\right) = \\frac{3+20}{11} = \\frac{23}{11}$$\n\nPart 3: Uniqueness of solution and algorithmic considerations.\n\nThe reformulation establishes a one-to-one correspondence between solutions of the AVE and solutions of the LCP $(M, q)$, provided that $(A+B)$ is nonsingular. Therefore, the AVE has a unique solution if and only if the LCP has a unique solution.\n\nA sufficient condition for an LCP $(M, q)$ to have a unique solution for any vector $q$ is that the matrix $M$ is a P-matrix. A matrix is a P-matrix if all of its principal minors are positive. For our specific case in Part 2, the matrix $M = \\frac{1}{11}\\begin{pmatrix} 5 & 2 \\\\ -4 & 5 \\end{pmatrix}$ has principal minors:\n- Order 1: $M_{11} = 5/11 > 0$ and $M_{22} = 5/11 > 0$.\n- Order 2: $\\det(M) = (\\frac{1}{11})^2(5 \\cdot 5 - 2(-4)) = \\frac{33}{121} = \\frac{3}{11} > 0$.\nSince all principal minors are positive, $M$ is a P-matrix, which guarantees a unique solution to the LCP, and thus to the AVE for this specific instance. In general, if the matrix $M=I-2B(A+B)^{-1}$ constructed from the AVE data is a P-matrix, the AVE has a unique solution.\n\nThe AVE-to-LCP reformulation is crucial for computational purposes. The original problem $Ax+|Bx|=c$ involves a non-linear and non-differentiable function (the absolute value), making it difficult to solve with standard numerical methods for linear or smooth systems. The LCP, while still a specialized problem, possesses a rich mathematical structure that has been extensively studied. This structure allows for the development of dedicated, finite-step algorithms.\n\nOne of the most well-known algorithms for solving LCPs is Lemke's algorithm, also known as the complementary pivot algorithm. This algorithm operates on the linear system $w=Mz+q$ and systematically pivots through a sequence of bases (like the simplex method for linear programming) in a way that seeks to satisfy the complementarity condition $w^\\top z=0$. The reformulation provides the necessary input $(M,q)$ for Lemke's algorithm. When the matrix $M$ is a P-matrix, Lemke's algorithm is guaranteed to find the unique solution to the LCP in a finite number of steps. Thus, the reformulation enables the application of powerful, proven algorithms to solve a class of non-linear equations.", "answer": "$$\\boxed{\\frac{23}{11}}$$", "id": "3109507"}, {"introduction": "After formulating a problem as an LCP, the next logical questions are: does a solution exist, and is it unique? This exercise is a puzzle designed to build your intuition about the geometry of LCP solutions by reasoning from first principles. By analyzing a simple 2D case with a skew-symmetric matrix [@problem_id:3109456], you will explore how the solution set's properties depend critically on the problem data and why common assumptions about matrices can be misleading.", "problem": "Consider the linear complementarity problem $\\mathrm{LCP}(M,q)$ in dimension $2$, defined as follows: given $M\\in\\mathbb{R}^{2\\times 2}$ and $q\\in\\mathbb{R}^{2}$, find vectors $z\\in\\mathbb{R}^{2}$ and $w\\in\\mathbb{R}^{2}$ such that\n$w = q + M z$, $z \\ge 0$, $w \\ge 0$, and $z^\\top w = 0$, where inequalities are understood componentwise. Let\n$$\nM=\\begin{bmatrix}0&1\\\\-1&0\\end{bmatrix}.\n$$\nUsing only the definition of the linear complementarity problem and the basic notion of monotonicity for linear maps (the mapping $F(z)=Mz$ is monotone if and only if the symmetric part $\\tfrac{1}{2}(M+M^\\top)$ is positive semidefinite), reason from first principles about the feasibility geometry in the nonnegative orthant and determine which statement correctly describes existence and uniqueness of solutions for generic $q\\in\\mathbb{R}^2$ (that is, away from measure-zero degeneracies).\n\nChoose exactly one option.\n\nA) For every $q\\in\\mathbb{R}^2$, $\\mathrm{LCP}(M,q)$ is solvable and has a unique solution.\n\nB) For generic $q$ (i.e., excluding the lines $q_1=0$ or $q_2=0$), $\\mathrm{LCP}(M,q)$ has no solution when $q_2<0$, and exactly one solution when $q_2>0$. On the coordinate axes ($q_1=0$ or $q_2=0$), the solution set can be empty or infinite depending on $q$.\n\nC) Because $\\det(M)>0$, $\\mathrm{LCP}(M,q)$ is a $P$-matrix linear complementarity problem and therefore has a unique solution for all $q\\in\\mathbb{R}^2$.\n\nD) Since $M$ is skew-symmetric, $z^\\top M z>0$ for all nonzero $z$, which implies existence and uniqueness of a solution for all $q\\in\\mathbb{R}^2$.\n\nE) For generic $q$, existence depends only on the sign of $q_1$, with solutions if and only if $q_1>0$.", "solution": "The problem is to find $z = [z_1, z_2]^\\top$ and $w = [w_1, w_2]^\\top$ such that:\n1.  $w = q + M z$\n2.  $z \\ge 0$ (i.e., $z_1 \\ge 0, z_2 \\ge 0$)\n3.  $w \\ge 0$ (i.e., $w_1 \\ge 0, w_2 \\ge 0$)\n4.  $z^\\top w = 0$\n\nSubstituting the given matrix $M=\\begin{bmatrix}0&1\\\\-1&0\\end{bmatrix}$ and vectors $z=\\begin{bmatrix}z_1\\\\z_2\\end{bmatrix}$, $q=\\begin{bmatrix}q_1\\\\q_2\\end{bmatrix}$, the first condition becomes:\n$$\n\\begin{bmatrix}w_1\\\\w_2\\end{bmatrix} = \\begin{bmatrix}q_1\\\\q_2\\end{bmatrix} + \\begin{bmatrix}0&1\\\\-1&0\\end{bmatrix}\\begin{bmatrix}z_1\\\\z_2\\end{bmatrix} = \\begin{bmatrix}q_1+z_2\\\\q_2-z_1\\end{bmatrix}\n$$\nThe non-negativity conditions are $z_1 \\ge 0$, $z_2 \\ge 0$, $w_1 = q_1+z_2 \\ge 0$, and $w_2 = q_2-z_1 \\ge 0$.\nThe complementarity condition $z^\\top w = z_1w_1+z_2w_2 = 0$, combined with non-negativity, is equivalent to the system of conditions $z_1w_1=0$ and $z_2w_2=0$.\n\nWe reason from first principles by considering the four mutually exclusive and exhaustive cases arising from the complementarity conditions:\n1.  $z_1=0, z_2=0$\n2.  $z_1>0, z_2=0$\n3.  $z_1=0, z_2>0$\n4.  $z_1>0, z_2>0$\n\n**Case 1: $z_1 = 0, z_2 = 0$**\nIf $z=0$, then $w = q+M(0) = q$. For this to be a solution, all conditions must be met. $z \\ge 0$ is satisfied. We only need $w \\ge 0$, which means $q \\ge 0$. So, if $q_1 \\ge 0$ and $q_2 \\ge 0$, then $z=0$ is a solution.\n\n**Case 2: $z_1 > 0, z_2 = 0$**\nThe condition $z_1>0$ implies $w_1=0$ from complementarity ($z_1w_1=0$).\n$w_1 = q_1+z_2 = q_1+0=q_1$. Thus, we must have $q_1=0$.\nThe remaining conditions are $z_1 > 0$ and $w_2 = q_2 - z_1 \\ge 0$, which implies $z_1 \\le q_2$.\nFor a solution of this form to exist, we must have $q_1=0$ and there must be a $z_1$ such that $0 < z_1 \\le q_2$. This requires $q_2>0$.\nThis case is only possible on the degenerate line $q_1=0$ (specifically, for $q_1=0, q_2>0$). For generic $q$, where $q_1 \\neq 0$, this case does not yield a solution.\n\n**Case 3: $z_1 = 0, z_2 > 0$**\nThe condition $z_2>0$ implies $w_2=0$ from complementarity ($z_2w_2=0$).\n$w_2 = q_2 - z_1 = q_2-0=q_2$. Thus, we must have $q_2=0$.\nThe remaining conditions are $z_2 > 0$ and $w_1 = q_1 + z_2 \\ge 0$, which implies $z_2 \\ge -q_1$.\nFor a solution of this form to exist, we must have $q_2=0$ and there must be a $z_2$ such that $z_2 > 0$ and $z_2 \\ge -q_1$. This is possible for any value of $q_1$.\nThis case is only possible on the degenerate line $q_2=0$. For generic $q$, where $q_2 \\neq 0$, this case does not yield a solution.\n\n**Case 4: $z_1 > 0, z_2 > 0$**\nThese conditions imply $w_1=0$ and $w_2=0$.\n$w_1 = q_1+z_2=0 \\implies z_2=-q_1$.\n$w_2 = q_2-z_1=0 \\implies z_1=q_2$.\nFor this to be a valid solution, we must satisfy the assumptions $z_1 > 0$ and $z_2 > 0$.\n$z_1 = q_2 > 0$.\n$z_2 = -q_1 > 0 \\implies q_1 < 0$.\nSo, a solution of this form exists if and only if $q_1 < 0$ and $q_2 > 0$. If these conditions on $q$ hold, the solution is unique: $z = [q_2, -q_1]^\\top$.\n\n**Summary for Generic $q$**\nFor generic $q$, we have $q_1 \\neq 0$ and $q_2 \\neq 0$. This means we only need to consider Cases 1 and 4.\n*   **If $q_1 > 0$ and $q_2 > 0$ (first quadrant):** Case 1 applies, giving the solution $z=0$. Case 4 requires $q_1 < 0$, so it does not apply. Thus, there is a unique solution $z=0$.\n*   **If $q_1 < 0$ and $q_2 > 0$ (second quadrant):** Case 1 requires $q_1 \\ge 0$, so it does not apply. Case 4 applies, giving the unique solution $z=[q_2, -q_1]^\\top$.\n*   **If $q_1 < 0$ and $q_2 < 0$ (third quadrant):** Case 1 requires $q_2 \\ge 0$, so it does not apply. Case 4 requires $q_2 > 0$, so it does not apply. There is no solution.\n*   **If $q_1 > 0$ and $q_2 < 0$ (fourth quadrant):** Case 1 requires $q_2 \\ge 0$, so it does not apply. Case 4 requires $q_1 < 0$, so it does not apply. There is no solution.\n\nCombining these findings for generic $q$:\n- If $q_2 > 0$, there is always exactly one solution.\n- If $q_2 < 0$, there is no solution.\n\n**Summary for Degenerate $q$ (on the axes)**\n*   **$q_1=0, q_2>0$:** Case 1 gives a solution ($z=0$). Case 2 also applies, giving solutions $z=[z_1, 0]^\\top$ for any $z_1 \\in (0, q_2]$. Combining with $z=0$, the solution set is $\\{[z_1,0]^\\top \\mid 0 \\le z_1 \\le q_2\\}$, which is infinite.\n*   **$q_1 \\ne 0, q_2=0$:** Case 3 applies. Solutions are $z=[0, z_2]^\\top$ for $z_2 > \\max(0,-q_1)$. This is an infinite set of solutions.\n*   **$q_1=0, q_2 < 0$:** We check the four cases. None of them yield a solution. For instance, from the basic inequalities, $z_1 \\ge 0$ and $w_2=q_2-z_1 \\ge 0 \\implies z_1 \\le q_2$. Since $q_2<0$, this implies $z_1 \\le q_2 < 0$, which contradicts $z_1 \\ge 0$. So there is no feasible solution, hence no solution to the LCP. The solution set is empty.\n*   **$q=(0,0)$:** A combination of the axis cases. Infinite solutions.\n\nThis confirms that on the axes, the solution set can be infinite (e.g., for $q=[0,1]^\\top$) or empty (e.g., for $q=[0,-1]^\\top$).\n\n**Evaluation of Options**\n\n**A) For every $q\\in\\mathbb{R}^2$, $\\mathrm{LCP}(M,q)$ is solvable and has a unique solution.**\n**Incorrect.** Our analysis shows that for any $q$ with $q_2 < 0$, there is no solution. For example, $q=[1, -1]^\\top$.\n\n**B) For generic $q$ (i.e., excluding the lines $q_1=0$ or $q_2=0$), $\\mathrm{LCP}(M,q)$ has no solution when $q_2<0$, and exactly one solution when $q_2>0$. On the coordinate axes ($q_1=0$ or $q_2=0$), the solution set can be empty or infinite depending on $q$.**\n**Correct.** This statement precisely matches our detailed case-by-case analysis. For generic $q$, existence depends only on the sign of $q_2$, and uniqueness holds when a solution exists. On the axes, we demonstrated cases with no solutions (e.g., $q=[0, -1]^\\top$) and cases with infinite solutions (e.g., $q=[0, 1]^\\top$).\n\n**C) Because $\\det(M)>0$, $\\mathrm{LCP}(M,q)$ is a $P$-matrix linear complementarity problem and therefore has a unique solution for all $q\\in\\mathbb{R}^2$.**\n**Incorrect.** A matrix is a $P$-matrix if all its principal minors are positive. The matrix is $M=\\begin{bmatrix}0&1\\\\-1&0\\end{bmatrix}$. The $1 \\times 1$ principal minors are the diagonal elements, $M_{11}=0$ and $M_{22}=0$. Since these are not positive, $M$ is not a $P$-matrix. The premise of the argument is false.\n\n**D) Since $M$ is skew-symmetric, $z^\\top M z>0$ for all nonzero $z$, which implies existence and uniqueness of a solution for all $q\\in\\mathbb{R}^2$.**\n**Incorrect.** The matrix $M$ is indeed skew-symmetric, as $M^\\top = \\begin{bmatrix}0&-1\\\\1&0\\end{bmatrix} = -M$. However, for any skew-symmetric matrix and any vector $z$, the quadratic form $z^\\top M z$ is identically zero. This can be seen by $z^\\top M z = (z^\\top M z)^\\top = z^\\top M^\\top z = z^\\top (-M) z = -z^\\top M z$, which implies $2 z^\\top M z = 0$, so $z^\\top M z = 0$. The premise \"$z^\\top M z > 0$ for all nonzero $z$\" is false.\n\n**E) For generic $q$, existence depends only on the sign of $q_1$, with solutions if and only if $q_1>0$.**\n**Incorrect.** Our analysis showed conclusively that for generic $q$, a solution exists if and only if $q_2>0$. For example, for $q=[-1, 1]^\\top$, we have $q_1 < 0$ but a unique solution exists.", "answer": "$$\\boxed{B}$$", "id": "3109456"}, {"introduction": "The final step is to find a solution computationally. This practice takes you under the hood of Lemke's algorithm, one of the foundational methods for solving LCPs. More importantly, it demonstrates what happens when an LCP has no solution. By analyzing a specific case [@problem_id:3109485], you will see how the algorithm's termination on a \"secondary ray\" serves as a certificate of infeasibility, connecting algorithmic behavior to the underlying mathematical theory.", "problem": "You are given a small instance of the Linear Complementarity Problem (LCP) defined by a matrix $M \\in \\mathbb{R}^{2 \\times 2}$ and a vector $q \\in \\mathbb{R}^{2}$, together with a strictly positive covering vector $d \\in \\mathbb{R}^{2}_{++}$ for the Lemke algorithm with an artificial variable $z_{0}$. Consider\n$$\nM \\;=\\; \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}, \n\\quad\nq \\;=\\; \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix},\n\\quad\nd \\;=\\; \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\nThe LCP seeks $z \\in \\mathbb{R}^{2}$ and $w \\in \\mathbb{R}^{2}$ such that\n$$\nz \\;\\ge\\; 0,\\quad w \\;=\\; q + M z \\;\\ge\\; 0, \\quad \\text{and} \\quad z^{\\top} w \\;=\\; 0.\n$$\nLemke’s algorithm applies to the augmented system\n$$\nw \\;=\\; q + M z + z_{0} d, \n\\quad z \\;\\ge\\; 0, \\quad w \\;\\ge\\; 0, \\quad z_{0} \\;\\ge\\; 0, \n\\quad \\text{and} \\quad z_{i} w_{i} \\;=\\; 0 \\;\\; \\text{for} \\; i \\in \\{1,2\\}.\n$$\n\nTasks:\n1. Using the definitions of the Linear Complementarity Problem (LCP) and the lemma of alternatives from linear inequalities (as a well-tested foundational fact), verify directly whether the original LCP has a solution for the given $M$ and $q$. Justify your conclusion from first principles by inspecting feasibility of $w \\;=\\; q + M z$ under $z \\;\\ge\\; 0$.\n2. Using the covering vector $d$, determine the minimal artificial variable level $z_{0}^{\\ast}$ at which the standard initialization of Lemke’s algorithm starts from the artificial solution with $z \\;=\\; 0$ and $w \\;=\\; q + z_{0} d \\;\\ge\\; 0$.\n3. Apply the secondary ray theory for Lemke’s algorithm (a well-tested fact: if there exists a nonzero $r \\;\\ge\\; 0$ with $M r \\;\\ge\\; 0$ and $q^{\\top} r \\;<\\; 0$, then the LCP has no solution and Lemke’s path must terminate on a secondary ray) to this instance. Exhibit an explicit nonzero vector $r$ satisfying $r \\;\\ge\\; 0$ and $M r \\;\\ge\\; 0$, compute $q^{\\top} r$, and explain why this forces Lemke’s algorithm to produce a ray rather than a solution.\n4. Let $\\Delta z$ denote the $z$-component of a direction of the secondary ray in the augmented system at $z_{0} \\;=\\; 0$. Compute the scalar ratio\n$$\n\\rho \\;=\\; \\frac{\\Delta z_{2}}{\\Delta z_{1}}.\n$$\n\nProvide your final answer as a single real number. No rounding is required.", "solution": "The problem is defined by the matrix $M$, vector $q$, and covering vector $d$:\n$$\nM = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}, \\quad q = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}, \\quad d = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\nThe LCP is to find $z, w \\in \\mathbb{R}^2$ satisfying $z \\ge 0, w = q + Mz \\ge 0, z^{\\top}w = 0$.\n\n**1. Verification of LCP Solution Existence**\n\nA solution to the LCP must, at a minimum, satisfy the feasibility conditions $z \\ge 0$ and $w = q + Mz \\ge 0$. Let $z = \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix}$. The condition $z \\ge 0$ implies $z_1 \\ge 0$ and $z_2 \\ge 0$.\n\nThe condition $w \\ge 0$ is expressed as:\n$$\nw = \\begin{pmatrix} w_1 \\\\ w_2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} = \\begin{pmatrix} -1 - z_2 \\\\ z_1 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\nThis yields two component-wise inequalities:\n1.  $w_1 = -1 - z_2 \\ge 0$, which implies $z_2 \\le -1$.\n2.  $w_2 = z_1 \\ge 0$.\n\nThe problem requires $z \\ge 0$, which means $z_2 \\ge 0$. However, the feasibility of $w$ requires $z_2 \\le -1$. These two conditions, $z_2 \\ge 0$ and $z_2 \\le -1$, are mutually exclusive. There is no real number $z_2$ that can satisfy both. Therefore, the set of feasible solutions $\\{z \\in \\mathbb{R}^2 \\mid z \\ge 0, q+Mz \\ge 0\\}$ is empty. Since no feasible solution exists, the LCP has no solution.\n\nAs suggested, we can confirm this using a lemma of alternatives (specifically, a form of Farkas's Lemma). The system $Mz \\ge -q, z \\ge 0$ is infeasible if and only if there exists a vector $y \\ge 0$ such that $M^{\\top}y \\le 0$ and $(-q)^{\\top}y > 0$.\nLet's search for such a vector $y = \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} \\ge 0$.\nThe condition $M^{\\top}y \\le 0$ is:\n$$\nM^{\\top}y = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} y_2 \\\\ -y_1 \\end{pmatrix} \\le \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\nThis gives $y_2 \\le 0$ and $-y_1 \\le 0$ (or $y_1 \\ge 0$).\nThe condition $(-q)^{\\top}y > 0$ is:\n$$\n(-q)^{\\top}y = - \\begin{pmatrix} -1 & 0 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = y_1 > 0.\n$$\nWe need to find $y_1, y_2$ satisfying $y_1 \\ge 0$, $y_2 \\ge 0$ (from $y \\ge 0$), $y_1 \\ge 0$, $y_2 \\le 0$ (from $M^{\\top}y \\le 0$), and $y_1 > 0$ (from $(-q)^{\\top}y > 0$).\nCombining these, we get $y_1 > 0$ and $y_2 = 0$. A valid choice is $y = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. This vector satisfies all conditions: $y \\ge 0$, $M^{\\top}y = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} \\le 0$, and $(-q)^{\\top}y = 1 > 0$. The existence of such a $y$ confirms that the original LCP is infeasible.\n\n**2. Minimal Artificial Variable Level $z_0^{\\ast}$**\n\nLemke's algorithm begins from an artificial solution where $z=0$. The augmented system is $w = q + Mz + z_0 d$. At initialization, we set $z=0$ and find the minimum $z_0 \\ge 0$ such that $w = q + z_0 d \\ge 0$.\nSubstituting the given vectors $q$ and $d$:\n$$\n\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} + z_0 \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} -1 + z_0 \\\\ z_0 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis leads to the inequalities:\n1.  $-1 + z_0 \\ge 0 \\implies z_0 \\ge 1$.\n2.  $z_0 \\ge 0$.\nTo satisfy both, we must have $z_0 \\ge 1$. The minimal value of $z_0$ is therefore $z_0^{\\ast} = 1$.\n\n**3. Application of Secondary Ray Theory**\n\nThe theory states that if there exists a nonzero vector $r \\ge 0$ such that $Mr \\ge 0$ and $q^{\\top}r < 0$, then the LCP has no solution, and Lemke's algorithm terminates on a secondary ray.\nLet $r = \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix}$. The conditions are:\n1.  $r \\ge 0 \\implies r_1 \\ge 0, r_2 \\ge 0$. Also, $r \\ne 0$.\n2.  $Mr \\ge 0$:\n    $$\n    Mr = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix} = \\begin{pmatrix} -r_2 \\\\ r_1 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n    $$\n    This implies $-r_2 \\ge 0$ (so $r_2 \\le 0$) and $r_1 \\ge 0$.\n3.  $q^{\\top}r < 0$:\n    $$\n    q^{\\top}r = \\begin{pmatrix} -1 & 0 \\end{pmatrix} \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix} = -r_1 < 0.\n    $$\n    This implies $r_1 > 0$.\n\nCombining the conditions on $r$: from $r_2 \\ge 0$ and $r_2 \\le 0$, we get $r_2 = 0$. From $r_1 > 0$ and $r \\ne 0$, we see that any vector of the form $r = \\begin{pmatrix} r_1 \\\\ 0 \\end{pmatrix}$ with $r_1 > 0$ will work.\nLet's exhibit an explicit vector by choosing $r_1 = 1$. So, $r = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\nLet's verify the conditions for this $r$:\n-   $r = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\ge 0$ and is nonzero.\n-   $Mr = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\ge 0$.\n-   $q^{\\top}r = \\begin{pmatrix} -1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -1 < 0$.\nAll conditions are met. The existence of such a vector $r$ proves that the LCP has no solution and forces Lemke's algorithm to terminate on a secondary ray, which is an unbounded direction of the feasible region of the augmented system for which $z_0=0$.\n\n**4. Computation of the Ratio $\\rho$**\n\nThe secondary ray corresponds to a nonzero direction $(\\Delta z, \\Delta w)$ in the space of variables $(z, w)$ such that starting from a point on the ray, one can move indefinitely in this direction while maintaining feasibility ($z \\ge 0, w \\ge 0$) and complementarity. For a secondary ray, $z_0=0$. The direction vector $(\\Delta z, \\Delta w)$ must satisfy the homogeneous system:\n1.  $\\Delta w = M \\Delta z$\n2.  $\\Delta z \\ge 0, \\Delta w \\ge 0$, with $\\Delta z \\ne 0$ (since the ray is in the $z$-space).\n3.  The direction itself must be complementary: $\\Delta z_i \\Delta w_i = 0$ for $i \\in \\{1,2\\}$.\n\nLet $\\Delta z = \\begin{pmatrix} \\Delta z_1 \\\\ \\Delta z_2 \\end{pmatrix}$. From $\\Delta w = M \\Delta z$, we have:\n$$\n\\Delta w = \\begin{pmatrix} \\Delta w_1 \\\\ \\Delta w_2 \\end{pmatrix} = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} \\Delta z_1 \\\\ \\Delta z_2 \\end{pmatrix} = \\begin{pmatrix} -\\Delta z_2 \\\\ \\Delta z_1 \\end{pmatrix}.\n$$\nThe non-negativity conditions $\\Delta z \\ge 0$ and $\\Delta w \\ge 0$ require:\n-   $\\Delta z_1 \\ge 0$\n-   $\\Delta z_2 \\ge 0$\n-   $\\Delta w_1 = -\\Delta z_2 \\ge 0 \\implies \\Delta z_2 \\le 0$\n-   $\\Delta w_2 = \\Delta z_1 \\ge 0$\n\nFrom $\\Delta z_2 \\ge 0$ and $\\Delta z_2 \\le 0$, we must have $\\Delta z_2 = 0$.\nSince $\\Delta z \\ne 0$, we must have $\\Delta z_1 > 0$.\nThe direction of the ray in the $z$-variables is thus any vector proportional to $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. Let's set $\\Delta z = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\nThen $\\Delta z_1 = 1$ and $\\Delta z_2 = 0$. The corresponding $\\Delta w$ is $\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$. Let's verify the complementarity condition $\\Delta z_i \\Delta w_i = 0$:\n-   For $i=1$: $\\Delta z_1 \\Delta w_1 = 1 \\cdot 0 = 0$.\n-   For $i=2$: $\\Delta z_2 \\Delta w_2 = 0 \\cdot 1 = 0$.\nThe conditions are satisfied. The $z$-component of the ray direction is $\\Delta z = \\begin{pmatrix} k \\\\ 0 \\end{pmatrix}$ for any $k>0$.\nThe problem asks for the ratio $\\rho = \\frac{\\Delta z_2}{\\Delta z_1}$. Using any such direction vector, we get:\n$$\n\\rho = \\frac{0}{k} = 0.\n$$\nThe value of the ratio is independent of the positive scaling factor $k$.\nThe final answer is $0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "3109485"}]}