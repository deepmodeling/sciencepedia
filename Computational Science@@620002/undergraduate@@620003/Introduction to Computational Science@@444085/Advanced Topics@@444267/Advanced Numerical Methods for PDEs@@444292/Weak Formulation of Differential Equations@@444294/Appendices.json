{"hands_on_practices": [{"introduction": "Our journey into weak formulations begins with a cornerstone of mathematical physics: the Poisson equation. This first practice [@problem_id:3230086] guides you through the essential mechanics of converting a strong-form boundary value problem into its weak (or variational) equivalent. By working through this exercise, you will master the technique of integration by parts to transfer derivatives from the unknown solution to a test function and gain an appreciation for the function spaces required for a well-posed problem.", "problem": "Consider the boundary value problem for the one-dimensional Poisson equation: find a function $u$ such that $-u''(x)=f(x)$ for $x \\in (0,1)$ with homogeneous Dirichlet boundary conditions $u(0)=u(1)=0$. Starting only from the product rule for derivatives, the definition of the weak derivative, the definition of the Lebesgue space $L^{2}(0,1)$, and the Sobolev space $H^{1}(0,1)=\\{w \\in L^{2}(0,1) : w' \\in L^{2}(0,1)\\}$ with $H_{0}^{1}(0,1)$ being the closure of $C_{c}^{\\infty}(0,1)$ in the $H^{1}$ norm, derive a weak formulation of the problem by multiplying the differential equation by an arbitrary test function and integrating by parts to move derivatives off $u$. Identify the appropriate trial and test spaces required for well-posedness by the Lax–Milgram theorem, and explicitly write down the bilinear form and linear functional.\n\nThen, specializing to the data $f(x)=1$ for $x \\in (0,1)$, compute the squared energy norm of the exact solution, defined by $\\|u\\|_{E}^{2}=a(u,u)$, where $a(\\cdot,\\cdot)$ is the bilinear form from your weak formulation. Express your final answer as an exact rational number with no units. Do not round.", "solution": "The problem asks for the derivation of the weak formulation for the one-dimensional Poisson equation, the identification of the associated functional-analytic objects, and the computation of the squared energy norm of the exact solution for a specific source term.\n\nFirst, we derive the weak formulation. The strong form of the boundary value problem is given by:\nFind a function $u$ such that\n$$-u''(x) = f(x) \\quad \\text{for } x \\in (0,1)$$\nwith homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$.\n\nFollowing the prescribed method, we multiply the differential equation by an arbitrary test function $v(x)$ and integrate over the domain $\\Omega = (0,1)$:\n$$-\\int_{0}^{1} u''(x) v(x) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx$$\nTo move the derivative from $u$ to $v$, we apply integration by parts to the left-hand side. The integration by parts formula, $\\int_{a}^{b} g(x)h'(x) \\, dx = [g(x)h(x)]_{a}^{b} - \\int_{a}^{b} g'(x)h(x) \\, dx$, is a consequence of integrating the product rule for derivatives. Let $h'(x) = u''(x)$ and $g(x) = v(x)$. Then $h(x) = u'(x)$ and $g'(x) = v'(x)$. The left-hand side becomes:\n$$-\\int_{0}^{1} v(x) u''(x) \\, dx = - \\left( [v(x)u'(x)]_{0}^{1} - \\int_{0}^{1} v'(x)u'(x) \\, dx \\right)$$\n$$= \\int_{0}^{1} u'(x)v'(x) \\, dx - [v(1)u'(1) - v(0)u'(0)]$$\nThe solution $u$ must satisfy the essential boundary conditions $u(0)=0$ and $u(1)=0$. To ensure the boundary term $[v(x)u'(x)]_{0}^{1}$ vanishes for any such $u$, we require the test function $v$ to also satisfy homogeneous boundary conditions, i.e., $v(0)=0$ and $v(1)=0$. With this constraint on $v$, the boundary term is identically zero.\n\nThe original integrated equation simplifies to what is known as the weak or variational formulation:\n$$\\int_{0}^{1} u'(x)v'(x) \\, dx = \\int_{0}^{1} f(x)v(x) \\, dx$$\nThis equation must hold for all valid test functions $v$.\n\nNext, we identify the appropriate function spaces. The weak formulation involves integrals of functions and their first derivatives. For these integrals to be finite (well-defined), the functions and their derivatives must be at least square-integrable over the domain $(0,1)$. The space of functions $w$ for which both $w \\in L^2(0,1)$ and its weak derivative $w' \\in L^2(0,1)$ is the Sobolev space $H^1(0,1)$, as defined in the problem. Both the solution $u$ (the trial function) and the test function $v$ must belong to $H^1(0,1)$.\n\nFurthermore, both $u$ and $v$ must satisfy the homogeneous Dirichlet boundary conditions. The subspace of $H^1(0,1)$ containing functions that vanish at the boundary is denoted $H_0^1(0,1)$. This is the correct space for both the trial and test functions.\nSo, the trial space is $V = H_0^1(0,1)$ and the test space is also $V = H_0^1(0,1)$.\nThe weak problem is: Find $u \\in H_0^1(0,1)$ such that $\\int_{0}^{1} u'(x)v'(x) \\, dx = \\int_{0}^{1} f(x)v(x) \\, dx$ for all $v \\in H_0^1(0,1)$.\n\nThis problem is in the abstract form required by the Lax-Milgram theorem: find $u \\in V$ such that $a(u,v) = L(v)$ for all $v \\in V$. By comparing our weak formulation to this abstract form, we identify:\nThe bilinear form: $a(u,v) = \\int_{0}^{1} u'(x)v'(x) \\, dx$.\nThe linear functional: $L(v) = \\int_{0}^{1} f(x)v(x) \\, dx$.\nThe function space $V=H_0^1(0,1)$ is a Hilbert space, and for a source term $f \\in L^2(0,1)$, the bilinear form $a(\\cdot,\\cdot)$ is continuous and coercive (by the Poincaré-Friedrichs inequality) and the linear functional $L(\\cdot)$ is continuous. This guarantees the existence and uniqueness of a solution to the weak problem.\n\nFinally, we specialize to the case $f(x)=1$ and compute the squared energy norm of the exact solution, defined by $\\|u\\|_{E}^{2} = a(u,u)$.\nFirst, we find the exact solution to the strong form: $-u''(x) = 1$ with $u(0)=u(1)=0$.\nIntegrating once with respect to $x$ yields:\n$-u'(x) = x + C_1$\nIntegrating a second time yields:\n$-u(x) = \\frac{1}{2}x^2 + C_1x + C_2 \\implies u(x) = -\\frac{1}{2}x^2 - C_1x - C_2$\nWe apply the boundary conditions to find the constants $C_1$ and $C_2$:\n$u(0) = 0 \\implies -\\frac{1}{2}(0)^2 - C_1(0) - C_2 = 0 \\implies C_2=0$.\n$u(1) = 0 \\implies -\\frac{1}{2}(1)^2 - C_1(1) - 0 = 0 \\implies -\\frac{1}{2} - C_1 = 0 \\implies C_1 = -\\frac{1}{2}$.\nSubstituting the constants, the exact solution is:\n$u(x) = -\\frac{1}{2}x^2 - (-\\frac{1}{2})x = \\frac{1}{2}x - \\frac{1}{2}x^2 = \\frac{1}{2}x(1-x)$.\n\nThe squared energy norm is $\\|u\\|_{E}^{2}=a(u,u) = \\int_{0}^{1} (u'(x))^2 \\, dx$.\nThe derivative of the solution is $u'(x) = \\frac{d}{dx}\\left(\\frac{1}{2}x - \\frac{1}{2}x^2\\right) = \\frac{1}{2} - x$.\nWe compute the integral:\n$$\\|u\\|_{E}^{2} = \\int_{0}^{1} \\left(\\frac{1}{2} - x\\right)^2 \\, dx = \\int_{0}^{1} \\left(\\frac{1}{4} - x + x^2\\right) \\, dx$$\n$$= \\left[ \\frac{1}{4}x - \\frac{1}{2}x^2 + \\frac{1}{3}x^3 \\right]_{0}^{1}$$\n$$= \\left(\\frac{1}{4}(1) - \\frac{1}{2}(1)^2 + \\frac{1}{3}(1)^3\\right) - (0) = \\frac{1}{4} - \\frac{1}{2} + \\frac{1}{3}$$\nUsing a common denominator of $12$:\n$$\\|u\\|_{E}^{2} = \\frac{3}{12} - \\frac{6}{12} + \\frac{4}{12} = \\frac{1}{12}$$\nAlternatively, since $u$ is the solution, it satisfies $a(u,v) = L(v)$ for all $v \\in H_0^1(0,1)$. Choosing $v=u$ (which is a valid choice as $u \\in H_0^1(0,1)$), we have $a(u,u) = L(u)$.\n$$\\|u\\|_{E}^{2} = a(u,u) = L(u) = \\int_{0}^{1} f(x)u(x) \\, dx = \\int_{0}^{1} (1)\\left(\\frac{1}{2}x - \\frac{1}{2}x^2\\right) \\, dx$$\n$$= \\frac{1}{2} \\int_{0}^{1} (x - x^2) \\, dx = \\frac{1}{2} \\left[ \\frac{1}{2}x^2 - \\frac{1}{3}x^3 \\right]_{0}^{1}$$\n$$= \\frac{1}{2} \\left( \\left(\\frac{1}{2} - \\frac{1}{3}\\right) - (0) \\right) = \\frac{1}{2} \\left( \\frac{3-2}{6} \\right) = \\frac{1}{2} \\left( \\frac{1}{6} \\right) = \\frac{1}{12}$$\nBoth methods confirm the result.", "answer": "$$\\boxed{\\frac{1}{12}}$$", "id": "3230086"}, {"introduction": "Having established the basic procedure, we now explore the profound generality of the weak formulation. This exercise [@problem_id:3202046] challenges you to consider a solution, $u(x)=|x|$, which lacks the smoothness required by the classical differential equation. You will use the formal definition of a weak derivative to discover that such functions can be valid solutions in a weak sense, corresponding to source terms that are distributions, like the Dirac delta, rather than ordinary functions.", "problem": "You are given the function $u(x)=|x|$ defined on the open interval $(-1,1)$. The goal is to use core definitions from distribution theory and Sobolev space theory to determine a weak derivative for $u$, identify an appropriate weak formulation of the second-order boundary value problem $-u''=f$ that can admit such a function $u$ as a solution, and make function space choices that ensure mathematical consistency.\n\nProceed as follows, starting only from the definition of a weak derivative and the definition of a weak solution obtained by integrating by parts:\n\n1. Using the definition of weak derivative based on testing against smooth compactly supported functions, determine a function $w$ such that $w$ is a weak first derivative of $u$ on $(-1,1)$.\n\n2. Using the distributional derivative of your weak first derivative, determine a distribution $f$ such that $-u''=f$ in the sense of distributions on $(-1,1)$.\n\n3. Propose a weak formulation of the boundary value problem $-u''=f$ on $(-1,1)$ with essential boundary conditions $u(-1)=1$ and $u(1)=1$ that can admit $u(x)=|x|$ as a weak solution. Clearly specify:\n   - the trial space,\n   - the test space,\n   - the bilinear form,\n   - and the linear functional on the right-hand side,\nand explain why your choices are compatible with your $f$.\n\n4. Let $v(x)=1-x^{2}$. Using your linear functional from step $3$, evaluate it at $v$.\n\nAnswer specification: Report only the numerical value of the evaluation in step $4$ as your final answer. No units are involved. Do not round your answer.", "solution": "The problem requires a four-step analysis of the function $u(x)=|x|$ on the interval $(-1,1)$ in the context of weak derivatives and weak formulations of boundary value problems.\n\n**1. Determination of the Weak First Derivative**\n\nThe weak derivative of a function $u \\in L^1_{\\text{loc}}(-1,1)$ is a function $w \\in L^1_{\\text{loc}}(-1,1)$ that satisfies the following relation for all smooth test functions $\\phi$ with compact support in $(-1,1)$, denoted $\\phi \\in C_c^\\infty(-1,1)$:\n$$ \\int_{-1}^{1} u(x) \\phi'(x) \\, dx = - \\int_{-1}^{1} w(x) \\phi(x) \\, dx $$\nFor the given function $u(x) = |x|$, the integral on the left-hand side is separated at $x=0$, where the definition of $|x|$ changes:\n$$ \\int_{-1}^{1} |x| \\phi'(x) \\, dx = \\int_{-1}^{0} (-x) \\phi'(x) \\, dx + \\int_{0}^{1} x \\phi'(x) \\, dx $$\nWe apply integration by parts to each term. For the first integral:\n$$ \\int_{-1}^{0} (-x) \\phi'(x) \\, dx = [-x \\phi(x)]_{-1}^{0} - \\int_{-1}^{0} (-1) \\phi(x) \\, dx $$\nSince $\\phi \\in C_c^\\infty(-1,1)$, it vanishes at the boundaries of the support, so $\\phi(-1)=0$. The boundary term evaluates to $-0 \\cdot \\phi(0) - (-(-1)\\phi(-1)) = 0$. The expression simplifies to:\n$$ \\int_{-1}^{0} (-x) \\phi'(x) \\, dx = \\int_{-1}^{0} \\phi(x) \\, dx $$\nFor the second integral:\n$$ \\int_{0}^{1} x \\phi'(x) \\, dx = [x \\phi(x)]_{0}^{1} - \\int_{0}^{1} (1) \\phi(x) \\, dx $$\nSimilarly, $\\phi(1)=0$, so the boundary term $1 \\cdot \\phi(1) - 0 \\cdot \\phi(0) = 0$. The expression simplifies to:\n$$ \\int_{0}^{1} x \\phi'(x) \\, dx = - \\int_{0}^{1} \\phi(x) \\, dx $$\nCombining these results gives the total value of the left-hand side:\n$$ \\int_{-1}^{1} |x| \\phi'(x) \\, dx = \\int_{-1}^{0} \\phi(x) \\, dx - \\int_{0}^{1} \\phi(x) \\, dx $$\nTo match this to the form $- \\int_{-1}^{1} w(x) \\phi(x) \\, dx$, we can write:\n$$ \\int_{-1}^{0} (1) \\phi(x) \\, dx + \\int_{0}^{1} (-1) \\phi(x) \\, dx = - \\left( \\int_{-1}^{0} (-1) \\phi(x) \\, dx + \\int_{0}^{1} (1) \\phi(x) \\, dx \\right) $$\nThis implies that the weak derivative $w(x)$ is the function that takes the value $-1$ on $(-1,0)$ and $1$ on $(0,1)$. This is the sign function, $\\text{sgn}(x)$.\n$$ w(x) = u'(x) = \\begin{cases} -1 & \\text{for } x \\in (-1,0) \\\\ 1 & \\text{for } x \\in (0,1) \\end{cases} $$\nThe value at $x=0$ is inconsequential as it is a set of measure zero.\n\n**2. Determination of the Distribution $f$**\n\nThe second weak derivative of $u$, denoted $u''$, is the weak derivative of its first weak derivative, $w(x)$. As $w(x)$ is discontinuous, its derivative must be understood in the sense of distributions. The distributional derivative $w'$ is a distribution $T_{w'}$ whose action on a test function $\\phi \\in C_c^\\infty(-1,1)$ is given by:\n$$ \\langle w', \\phi \\rangle = - \\int_{-1}^{1} w(x) \\phi'(x) \\, dx $$\nWe substitute the expression for $w(x)$:\n$$ \\langle w', \\phi \\rangle = - \\left( \\int_{-1}^{0} (-1) \\phi'(x) \\, dx + \\int_{0}^{1} (1) \\phi'(x) \\, dx \\right) = \\int_{-1}^{0} \\phi'(x) \\, dx - \\int_{0}^{1} \\phi'(x) \\, dx $$\nBy the Fundamental Theorem of Calculus:\n$$ \\int_{-1}^{0} \\phi'(x) \\, dx = \\phi(0) - \\phi(-1) $$\n$$ \\int_{0}^{1} \\phi'(x) \\, dx = \\phi(1) - \\phi(0) $$\nSince $\\phi$ has compact support within $(-1,1)$, we have $\\phi(-1)=0$ and $\\phi(1)=0$. Substituting these into the expression for $\\langle w', \\phi \\rangle$:\n$$ \\langle w', \\phi \\rangle = (\\phi(0) - 0) - (0 - \\phi(0)) = 2\\phi(0) $$\nThe action of this distribution on $\\phi$ is to multiply the value of $\\phi$ at $x=0$ by $2$. This is, by definition, the action of $2$ times the Dirac delta distribution centered at $x=0$, denoted $\\delta_0$. Thus, $u'' = w' = 2\\delta_0$.\nThe problem states that $-u''=f$. Therefore, the distribution $f$ is:\n$$ f = -2\\delta_0 $$\n\n**3. Weak Formulation of the Boundary Value Problem**\n\nWe are asked to propose a weak formulation for the problem $-u''=f$ on $(-1,1)$ with essential boundary conditions $u(-1)=1$ and $u(1)=1$, which admits $u(x)=|x|$ as a solution.\nTo derive the weak form, we multiply the differential equation $-u''=f$ by a suitable test function $v$ and integrate over the domain $(-1,1)$. In the distributional sense, this is expressed as $\\langle -u'', v \\rangle = \\langle f, v \\rangle$.\nThe term $\\langle -u'', v \\rangle$ is equivalent to $\\langle u', v' \\rangle$ after integration by parts, provided the boundary terms vanish. The formal integration by parts gives:\n$$ -\\int_{-1}^{1} u''(x)v(x) \\, dx = \\int_{-1}^{1} u'(x)v'(x) \\, dx - [u'(x)v(x)]_{-1}^{1} $$\nTo ensure the boundary term $[u'(x)v(x)]_{-1}^{1}$ vanishes, we require the test functions $v$ to be zero at the boundaries where essential conditions are specified, i.e., $v(-1)=0$ and $v(1)=0$.\nThis leads to the weak formulation: Find $u$ satisfying the essential boundary conditions such that for all test functions $v$ with $v(-1)=v(1)=0$:\n$$ \\int_{-1}^{1} u'(x)v'(x) \\, dx = \\langle f, v \\rangle $$\nWe now specify the components of this formulation:\n- **Function Spaces**: The natural setting for this problem is the Sobolev space $H^1(-1,1)$, which consists of functions in $L^2(-1,1)$ whose weak derivatives are also in $L^2(-1,1)$. The given solution $u(x)=|x|$ is in $H^1(-1,1)$ because $\\int_{-1}^1 |x|^2 dx = 2/3 < \\infty$ and $\\int_{-1}^1 (u'(x))^2 dx = \\int_{-1}^1 (\\text{sgn}(x))^2 dx = \\int_{-1}^1 1 \\, dx = 2 < \\infty$.\n  - **Trial Space**: The space of candidate solutions, which must satisfy the essential boundary conditions. This is the affine space $V = \\{ \\psi \\in H^1(-1,1) \\mid \\psi(-1)=1, \\psi(1)=1 \\}$.\n  - **Test Space**: The space of test functions, which must satisfy the homogeneous version of the essential boundary conditions. This is the vector space $V_0 = H_0^1(-1,1) = \\{ v \\in H^1(-1,1) \\mid v(-1)=0, v(1)=0 \\}$.\n- **Bilinear Form**: The left-hand side of the weak formulation, denoted $a(u,v)$.\n  $$ a(u,v) = \\int_{-1}^{1} u'(x) v'(x) \\, dx $$\n- **Linear Functional**: The right-hand side of the weak formulation, denoted $L(v)$.\n  $$ L(v) = \\langle f, v \\rangle = \\langle -2\\delta_0, v \\rangle = -2v(0) $$\n- **Compatibility**: The formulation is consistent because $f=-2\\delta_0$ is a valid member of the dual space of $H_0^1(-1,1)$, denoted $H^{-1}(-1,1)$. By the Sobolev embedding theorem for one dimension ($n=1$), the space $H^1(-1,1)$ embeds continuously into the space of continuous functions $C([-1,1])$. This means that for any $v \\in H^1(-1,1)$, the point evaluation $v(0)$ is well-defined and continuous. Consequently, the Dirac delta $\\delta_0$ is a continuous linear functional on $H_0^1(-1,1)$, making $L(v) = -2v(0)$ a valid linear functional for this weak formulation.\n\n**4. Evaluation of the Linear Functional**\n\nWe must evaluate the linear functional $L(v)$ for the specific function $v(x) = 1-x^2$.\nFirst, we verify that $v(x)$ is a valid test function, i.e., $v \\in H_0^1(-1,1)$.\n- As a polynomial, $v(x)$ is smooth ($C^\\infty([-1,1])$), so it and its derivatives of all orders are in $L^2(-1,1)$. Thus, $v \\in H^1(-1,1)$.\n- We check the boundary conditions:\n  - $v(-1) = 1 - (-1)^2 = 1 - 1 = 0$.\n  - $v(1) = 1 - (1)^2 = 1 - 1 = 0$.\nSince the boundary conditions are met, $v(x)=1-x^2$ is a valid test function in $H_0^1(-1,1)$.\nNow, we evaluate the linear functional $L(v) = -2v(0)$:\n$$ v(0) = 1 - 0^2 = 1 $$\nSubstituting this value into the expression for $L(v)$:\n$$ L(v) = -2 \\times v(0) = -2 \\times 1 = -2 $$\nThe numerical value of the evaluation is $-2$.", "answer": "$$\\boxed{-2}$$", "id": "3202046"}, {"introduction": "Finally, we apply our knowledge to a new class of problems and a more advanced technique. This practice [@problem_id:3202036] addresses the linear advection equation, a model for transport phenomena that is notoriously difficult to solve numerically without introducing non-physical oscillations. You will derive a stabilized weak form using the Petrov-Galerkin method, where test functions are chosen differently from the trial functions to build stability directly into the formulation, a concept known as streamline upwinding.", "problem": "Consider the linear advection (transport) equation on a one-dimensional periodic domain,\n$$\nu_{t}(x,t) + a\\,u_{x}(x,t) = 0,\\quad x\\in(0,L),\\ t>0\n$$\nwith constant advection speed $a>0$, period $L>0$, and a given periodic initial condition $u(x,0)=u_{0}(x)$. Let the spatial trial space be a conforming finite element subspace $V_{h}\\subset H^{1}_{\\mathrm{per}}(0,L)$ consisting of continuous, piecewise polynomial functions over a uniform partition of $(0,L)$ with mesh size $h>0$. In a Petrov–Galerkin setting, use the upwinded (streamline) test functions\n$$\nw_{h} = v_{h} + \\tau\\,a\\,\\partial_{x} v_{h},\\quad v_{h}\\in V_{h}\n$$\nwhere $\\tau>0$ is a stabilization parameter with units of time, and $\\partial_{x}$ denotes differentiation with respect to $x$.\n\nStarting from fundamental principles of weak formulations (multiplying by test functions and integrating over the spatial domain, invoking periodic boundary conditions to handle surface terms, and employing integration by parts only where it is justified), derive the stabilized weak form that results from these upwind test functions. Then, interpret the added stabilization in terms of an artificial diffusion mechanism acting on the semi-discrete solution $u_{h}(t)\\in V_{h}$.\n\nYour task:\n- Derive the semi-discrete stabilized weak formulation using the above Petrov–Galerkin choice of test functions.\n- From your derived form, identify the artificial diffusion coefficient that the stabilization contributes to the spatial operator. Express this coefficient as a symbolic expression in terms of $a$ and $\\tau$.\n- Explain physically and mathematically (at the level of the derived bilinear forms) why this artificial diffusion damps spurious oscillations, especially at higher spatial frequencies, under periodic boundary conditions.\n\nAnswer specification:\n- The final answer must be a single closed-form symbolic expression equal to the artificial diffusion coefficient contributed by the stabilization.\n- For interpretation, this coefficient has physical units of squared length per unit time. If you were to evaluate it numerically, express it in $\\mathrm{m}^{2}/\\mathrm{s}$. In the boxed final answer, provide only the symbolic expression without units.", "solution": "### Derivation and Interpretation\n\n**Part 1: Derivation of the Semi-Discrete Stabilized Weak Formulation**\n\nThe core principle of a weak formulation is to require that the residual of the differential equation is orthogonal to a chosen space of test functions. The semi-discrete problem seeks an approximate solution $u_{h}(t) \\in V_{h}$ such that the residual $R(u_{h}) = \\partial_{t} u_{h} + a\\,\\partial_{x} u_{h}$ is orthogonal to all test functions $w_{h}$ in the $L^{2}$ sense. The test functions are given as $w_{h} = v_{h} + \\tau\\,a\\,\\partial_{x} v_{h}$ for any choice of $v_{h}$ from the trial space $V_{h}$.\n\nThe weak formulation is thus: find $u_{h}(t) \\in V_{h}$ such that for all $v_{h} \\in V_{h}$:\n$$\n\\int_{0}^{L} R(u_{h}(x,t)) w_{h}(x) \\,dx = 0\n$$\nSubstituting the expressions for the residual and the test function, we get:\n$$\n\\int_{0}^{L} \\left( \\partial_{t} u_{h} + a\\,\\partial_{x} u_{h} \\right) \\left( v_{h} + \\tau\\,a\\,\\partial_{x} v_{h} \\right) \\,dx = 0\n$$\nWe expand the integrand, which yields four terms. The resulting semi-discrete weak formulation is:\n$$\n\\int_{0}^{L} (\\partial_{t} u_{h}) v_{h} \\,dx + \\int_{0}^{L} a (\\partial_{x} u_{h}) v_{h} \\,dx + \\int_{0}^{L} \\tau a (\\partial_{t} u_{h}) (\\partial_{x} v_{h}) \\,dx + \\int_{0}^{L} \\tau a^{2} (\\partial_{x} u_{h}) (\\partial_{x} v_{h}) \\,dx = 0\n$$\nThis equation must hold for all $v_{h} \\in V_{h}$. This is the complete semi-discrete stabilized weak formulation derived directly from the problem statement. The first two terms correspond to the standard Galerkin formulation. The third and fourth terms are the stabilization terms introduced by the Petrov-Galerkin choice of test functions.\n\n**Part 2: Identification of the Artificial Diffusion Coefficient**\n\nTo interpret the stabilizing effect, we analyze the structure of the added terms. The term of primary interest for this interpretation is the fourth one: $\\int_{0}^{L} \\tau a^{2} (\\partial_{x} u_{h}) (\\partial_{x} v_{h}) \\,dx$. We compare this term to the weak form of a physical diffusion operator, $-k\\,\\partial_{xx}u$, where $k$ is the diffusion coefficient.\n\nLet's derive the weak form of the operator $-k\\,\\partial_{xx}$. We multiply by an arbitrary test function $v(x)$ and integrate over the domain $(0,L)$:\n$$\n\\int_{0}^{L} (-k\\,\\partial_{xx}u) v \\,dx\n$$\nApplying integration by parts, we obtain:\n$$\n\\int_{0}^{L} (-k\\,\\partial_{xx}u) v \\,dx = -[k (\\partial_{x}u) v]_{0}^{L} + \\int_{0}^{L} k (\\partial_{x}u) (\\partial_{x}v) \\,dx\n$$\nSince the functions in $V_{h}$ are periodic on $(0,L)$, the boundary term vanishes: $[k (\\partial_{x}u_{h}) v_{h}]_{0}^{L} = k (\\partial_{x}u_{h}(L)) v_{h}(L) - k (\\partial_{x}u_{h}(0)) v_{h}(0) = 0$. Therefore, the weak form of the operator $-k\\,\\partial_{xx}u$ on this periodic domain is the bilinear form $(u,v) \\mapsto \\int_{0}^{L} k (\\partial_{x}u) (\\partial_{x}v) \\,dx$.\n\nComparing this canonical diffusion form with the fourth term in our derived weak formulation,\n$$\n\\int_{0}^{L} \\underbrace{(\\tau a^{2})}_{k_{\\text{art}}} (\\partial_{x} u_{h}) (\\partial_{x} v_{h}) \\,dx\n$$\nwe can directly identify the artificial diffusion coefficient, $k_{\\text{art}}$, contributed by the stabilization scheme. This coefficient is:\n$$\nk_{\\text{art}} = \\tau a^{2}\n$$\nThis interpretation implies that the stabilization method effectively introduces a term of the form $-(\\tau a^{2}) \\partial_{xx}u_{h}$ into the original PDE, turning the pure advection equation into an advection-diffusion equation.\n\n**Part 3: Physical and Mathematical Explanation of Damping**\n\nThe introduction of an artificial diffusion term, $-k_{\\text{art}}\\,\\partial_{xx}u_{h}$, is the mechanism responsible for damping spurious oscillations.\n\n**Mathematical Explanation:**\nThe standard Galerkin formulation for the advection operator, $\\int_{0}^{L} a(\\partial_{x}u_{h})v_{h}\\,dx$, leads to a skew-symmetric system matrix after integration by parts, which lacks coercivity. This is a primary source of numerical instability, manifesting as non-physical oscillations. The stabilization term adds the bilinear form $B(u_{h}, v_{h}) = \\int_{0}^{L} \\tau a^{2} (\\partial_{x} u_{h}) (\\partial_{x} v_{h}) \\,dx$. When the test function basis is the same as the trial function basis ($v_{h} = u_{h}$), this term contributes $\\tau a^{2} \\int_{0}^{L} (\\partial_{x} u_{h})^{2} \\,dx = \\tau a^{2} \\| \\partial_{x} u_{h} \\|_{L^{2}}^{2}$ to the diagonal of the system. Since $\\tau > 0$, this term is positive and provides coercivity to the spatial operator, thereby ensuring stability by penalizing large gradients in the solution.\n\nFurthermore, we can analyze the effect in the frequency domain. Spurious numerical oscillations are high-frequency (high-wavenumber) artifacts. Let's consider the action of the artificial diffusion operator on a single Fourier mode, $\\exp(i\\omega x)$, where $\\omega$ is the spatial frequency.\n$$\n(-k_{\\text{art}}\\,\\partial_{xx}) \\exp(i\\omega x) = -k_{\\text{art}} (i\\omega)^{2} \\exp(i\\omega x) = k_{\\text{art}} \\omega^{2} \\exp(i\\omega x)\n$$\nThe damping effect of the operator is proportional to $\\omega^{2}$. This means that high-frequency components of the solution (large $\\omega$) are damped much more significantly than low-frequency components. The artificial diffusion thus acts as a low-pass filter, selectively removing the high-frequency numerical noise while preserving the smooth, physically meaningful part of the solution.\n\n**Physical Explanation:**\nPhysically, diffusion is a process that smooths out sharp variations and gradients. For example, in heat transfer, conduction smooths temperature profiles. In fluid mechanics, viscosity dissipates sharp velocity gradients. Spurious oscillations in a numerical solution represent extremely sharp, unphysical gradients. The artificial diffusion term mimics a physical dissipative process. It acts to \"smear out\" or dissipate these sharp, oscillatory features, resulting in a smoother and more stable numerical solution that is free from the characteristic \"wiggles\" that plague standard Galerkin methods for advection-dominated problems. The parameter $\\tau$ controls the amount of this numerical dissipation.", "answer": "$$\n\\boxed{\\tau a^{2}}\n$$", "id": "3202036"}]}