{"hands_on_practices": [{"introduction": "This first exercise will guide you through the fundamental application of the Galerkin method. You will find an approximate solution to a simple boundary value problem by using a single polynomial basis function that is cleverly chosen to satisfy the boundary conditions [@problem_id:2149969]. This practice is designed to solidify your understanding of the core procedure: converting the differential equation to its weak form, forming the Galerkin equation, and solving for the unknown coefficient that best approximates the true solution.", "problem": "Consider the one-dimensional steady-state heat conduction equation given by $-u'' = \\cos(x)$, which describes the temperature distribution $u(x)$ in a rod on the domain $x \\in [-\\pi/2, \\pi/2]$. The rod is subject to a spatially varying internal heat source, represented by $\\cos(x)$. The ends of the rod are held at a fixed zero temperature, leading to the boundary conditions $u(-\\pi/2) = u(\\pi/2) = 0$.\n\nUsing the Galerkin method, determine an approximate solution to this boundary value problem. You are to use a single, symmetric trial function of the form $u_a(x) = c \\phi(x)$, where the basis function is the polynomial $\\phi(x) = \\frac{\\pi^2}{4} - x^2$, and $c$ is a constant coefficient to be determined. All trigonometric functions in the problem are defined in terms of radians.\n\nExpress your final answer for the approximate solution $u_a(x)$ as a function of $x$ and the constant $\\pi$.", "solution": "We are given the boundary value problem $-u''(x)=\\cos(x)$ on $x\\in[-\\pi/2,\\pi/2]$ with $u(-\\pi/2)=u(\\pi/2)=0$. The Galerkin weak form for $-u''=f$ with homogeneous Dirichlet boundary conditions is\n$$\n\\int_{-\\pi/2}^{\\pi/2} u'(x)\\,v'(x)\\,dx=\\int_{-\\pi/2}^{\\pi/2} f(x)\\,v(x)\\,dx\n$$\nfor all admissible test functions $v$. Using the one-dimensional trial space spanned by $\\phi(x)=\\frac{\\pi^{2}}{4}-x^{2}$, we set $u_{a}(x)=c\\,\\phi(x)$ and choose $v=\\phi$. This gives\n$$\nc\\int_{-\\pi/2}^{\\pi/2} \\left(\\phi'(x)\\right)^{2} dx=\\int_{-\\pi/2}^{\\pi/2} \\cos(x)\\,\\phi(x)\\,dx.\n$$\nCompute $\\phi'(x)=-2x$, hence $\\left(\\phi'(x)\\right)^{2}=4x^{2}$. The denominator becomes\n$$\n\\int_{-\\pi/2}^{\\pi/2}4x^{2}dx=4\\cdot 2\\int_{0}^{\\pi/2}x^{2}dx=8\\cdot \\frac{(\\pi/2)^{3}}{3}=\\frac{\\pi^{3}}{3}.\n$$\nFor the numerator,\n$$\n\\int_{-\\pi/2}^{\\pi/2}\\cos(x)\\left(\\frac{\\pi^{2}}{4}-x^{2}\\right)dx\n=\\frac{\\pi^{2}}{4}\\int_{-\\pi/2}^{\\pi/2}\\cos(x)dx-\\int_{-\\pi/2}^{\\pi/2}x^{2}\\cos(x)dx.\n$$\nEvaluate the first term:\n$$\n\\frac{\\pi^{2}}{4}\\int_{-\\pi/2}^{\\pi/2}\\cos(x)dx=\\frac{\\pi^{2}}{4}\\left[\\sin(x)\\right]_{-\\pi/2}^{\\pi/2}=\\frac{\\pi^{2}}{4}\\cdot 2=\\frac{\\pi^{2}}{2}.\n$$\nFor the second term, use evenness and integration by parts:\n$$\n\\int_{-\\pi/2}^{\\pi/2}x^{2}\\cos(x)dx=2\\int_{0}^{\\pi/2}x^{2}\\cos(x)dx,\n$$\nand\n$$\n\\int x^{2}\\cos(x)\\,dx=x^{2}\\sin(x)+2x\\cos(x)-2\\sin(x)+C.\n$$\nThus,\n$$\n\\int_{0}^{\\pi/2}x^{2}\\cos(x)\\,dx=\\left[x^{2}\\sin(x)+2x\\cos(x)-2\\sin(x)\\right]_{0}^{\\pi/2}=\\frac{\\pi^{2}}{4}-2,\n$$\nso\n$$\n\\int_{-\\pi/2}^{\\pi/2}x^{2}\\cos(x)dx=2\\left(\\frac{\\pi^{2}}{4}-2\\right)=\\frac{\\pi^{2}}{2}-4.\n$$\nHence the numerator is\n$$\n\\frac{\\pi^{2}}{2}-\\left(\\frac{\\pi^{2}}{2}-4\\right)=4.\n$$\nTherefore,\n$$\nc=\\frac{\\int_{-\\pi/2}^{\\pi/2}\\cos(x)\\,\\phi(x)\\,dx}{\\int_{-\\pi/2}^{\\pi/2}\\left(\\phi'(x)\\right)^{2}dx}\n=\\frac{4}{\\pi^{3}/3}=\\frac{12}{\\pi^{3}}.\n$$\nThe Galerkin approximate solution is\n$$\nu_{a}(x)=c\\,\\phi(x)=\\frac{12}{\\pi^{3}}\\left(\\frac{\\pi^{2}}{4}-x^{2}\\right).\n$$\nThis satisfies $u_{a}(\\pm \\pi/2)=0$ by construction.", "answer": "$$\\boxed{\\frac{12}{\\pi^{3}}\\left(\\frac{\\pi^{2}}{4}-x^{2}\\right)}$$", "id": "2149969"}, {"introduction": "Real-world problems often involve non-zero, or inhomogeneous, boundary conditions. This practice introduces a powerful and standard technique to handle such cases within the Galerkin framework [@problem_id:2150022]. You will construct a trial solution as a sum of two parts: a function that satisfies the given boundary conditions and a weighted basis function that is zero at the boundaries. This exercise demonstrates how to systematically adapt the method to a broader and more practical class of problems.", "problem": "Consider the two-point boundary value problem defined by the differential equation $-u''(x) = 1$ on the interval $x \\in (0, 1)$, subject to the inhomogeneous boundary conditions $u(0) = 1$ and $u(1) = 2$.\n\nWe seek an approximate solution to this problem using the Galerkin method. A trial solution is proposed in the form $u_h(x) = (x+1) + c_1 x(1-x)$, where $c_1$ is an unknown constant coefficient that needs to be determined. The term $x(1-x)$ serves as the single basis function for the homogeneous part of the solution.\n\nUsing the Galerkin method, determine the value of the coefficient $c_1$. Express your answer as a fraction.", "solution": "We approximate the solution $u$ by $u_{h}(x)=(x+1)+c_{1}\\,x(1-x)$, which satisfies the essential boundary conditions for all $c_{1}$. In the Galerkin method for $-u''=1$ with homogeneous test space, the weak form is\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx=\\int_{0}^{1} v(x)\\,dx\n$$\nfor all test functions $v$ vanishing at the endpoints. With a single basis function $v(x)=x(1-x)$, we compute\n$$\nu_{h}'(x)=1+c_{1}(1-2x), \\quad v'(x)=1-2x.\n$$\nThe Galerkin equation becomes\n$$\n\\int_{0}^{1}\\left[1+c_{1}(1-2x)\\right](1-2x)\\,dx=\\int_{0}^{1}x(1-x)\\,dx.\n$$\nEvaluate the left-hand side by splitting terms:\n$$\n\\int_{0}^{1}(1-2x)\\,dx + c_{1}\\int_{0}^{1}(1-2x)^{2}\\,dx.\n$$\nWe have\n$$\n\\int_{0}^{1}(1-2x)\\,dx=\\left[x-x^{2}\\right]_{0}^{1}=1-1=0,\n$$\nand\n$$\n\\int_{0}^{1}(1-2x)^{2}\\,dx=\\int_{0}^{1}\\left(1-4x+4x^{2}\\right)\\,dx=1-2+\\frac{4}{3}=\\frac{1}{3}.\n$$\nThe right-hand side is\n$$\n\\int_{0}^{1}x(1-x)\\,dx=\\int_{0}^{1}(x-x^{2})\\,dx=\\left[\\frac{x^{2}}{2}-\\frac{x^{3}}{3}\\right]_{0}^{1}=\\frac{1}{2}-\\frac{1}{3}=\\frac{1}{6}.\n$$\nThus,\n$$\nc_{1}\\cdot\\frac{1}{3}=\\frac{1}{6}\\quad\\Rightarrow\\quad c_{1}=\\frac{1}{2}.\n$$\nFor completeness, the residual form gives the same result: $u_{h}''(x)=-2c_{1}$, so $-u_{h}''-1=2c_{1}-1$, and the Galerkin condition $\\int_{0}^{1}(2c_{1}-1)\\,x(1-x)\\,dx=0$ yields $(2c_{1}-1)\\cdot\\frac{1}{6}=0$, hence $c_{1}=\\frac{1}{2}$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2150022"}, {"introduction": "The power of the Galerkin method extends far beyond simple steady-state problems. In this advanced exercise, we apply it to a time-dependent partial differential equation—the heat equation [@problem_id:2445292]. By applying the Galerkin procedure only to the spatial dimension, we perform what is known as semi-discretization. This powerful technique transforms the PDE into an ordinary differential equation (ODE) in time, revealing the underlying structure of the system in terms of mass and stiffness matrices, which are central concepts in computational engineering.", "problem": "Consider one-dimensional transient heat conduction in a homogeneous rod of length $L>0$ with constant mass density $\\rho>0$, specific heat $c>0$, and thermal conductivity $k>0$. The temperature field $u(x,t)$ satisfies the partial differential equation (PDE) \n$$\\rho c\\,\\frac{\\partial u}{\\partial t}(x,t)-k\\,\\frac{\\partial^{2}u}{\\partial x^{2}}(x,t)=Q(x),\\quad x\\in(0,L),\\ t>0,$$\nwith homogeneous Dirichlet boundary conditions \n$$u(0,t)=0,\\quad u(L,t)=0,\\quad t>0.$$\nPartition the spatial domain into two equal subintervals with nodes at $x=0$, $x=L/2$, and $x=L$. Using the method of weighted residuals with Galerkin’s choice of the weight (test) function applied only to the spatial variable, approximate $u(x,t)$ by a single degree of freedom using the unique interior hat function $N_{2}(x)$ associated with $x=L/2$ as both the trial and the test function. Do not use any mass lumping. Derive the semi-discrete ordinary differential equation (ODE)\n$$M\\,\\dot{c}(t)+K\\,c(t)=f,$$\nwhere $c(t)$ is the time-dependent coefficient of the approximation $u(x,t)\\approx c(t)N_{2}(x)$. Then, for the case of zero volumetric heating $Q(x)=0$, determine the exact symbolic expression, in terms of $k$, $\\rho$, $c$, and $L$, for the decay rate \n$$\\lambda=\\frac{K}{M}.$$\nProvide your final answer as a single closed-form analytic expression in terms of $k$, $\\rho$, $c$, and $L$. Do not evaluate numerically.", "solution": "The semi-discrete formulation is obtained using the method of weighted residuals. The residual $R(x,t)$ of the PDE is defined by substituting the approximation $\\tilde{u}(x,t) = c(t)N_{2}(x)$ into the governing equation:\n$$R(x,t) = \\rho c\\,\\frac{\\partial \\tilde{u}}{\\partial t}-k\\,\\frac{\\partial^{2}\\tilde{u}}{\\partial x^{2}}-Q(x)$$\n$$R(x,t) = \\rho c\\,\\dot{c}(t)N_{2}(x) - k\\,c(t)N_{2}''(x) - Q(x)$$\nIn Galerkin's method, the weight function is the basis function $N_2(x)$. The weighted residual statement requires the residual to be orthogonal to the weight function over the domain:\n$$\\int_{0}^{L} R(x,t) N_{2}(x) \\,dx = 0$$\nSubstituting the expression for the residual gives:\n$$\\int_{0}^{L} \\left( \\rho c\\,\\dot{c}(t)N_{2}(x) - k\\,c(t)N_{2}''(x) - Q(x) \\right) N_{2}(x) \\,dx = 0$$\nThis can be separated into terms:\n$$\\dot{c}(t) \\left( \\int_{0}^{L} \\rho c\\, N_{2}(x)N_{2}(x) \\,dx \\right) - c(t) \\left( \\int_{0}^{L} k\\, N_{2}''(x)N_{2}(x) \\,dx \\right) - \\int_{0}^{L} Q(x)N_{2}(x) \\,dx = 0$$\nTo reduce the order of differentiation in the second term, we apply integration by parts:\n$$\\int_{0}^{L} N_{2}''(x)N_{2}(x) \\,dx = \\left[ N_{2}'(x)N_{2}(x) \\right]_{0}^{L} - \\int_{0}^{L} N_{2}'(x)N_{2}'(x) \\,dx$$\nThe basis function $N_2(x)$ is constructed to be zero at the boundary nodes $x=0$ and $x=L$. Therefore, $N_2(0)=0$ and $N_2(L)=0$, and the boundary term $\\left[ N_{2}'(x)N_{2}(x) \\right]_{0}^{L}$ vanishes. The integral becomes:\n$$\\int_{0}^{L} N_{2}''(x)N_{2}(x) \\,dx = - \\int_{0}^{L} (N_{2}'(x))^2 \\,dx$$\nSubstituting this result back into the weighted residual equation, we obtain the weak form:\n$$\\dot{c}(t) \\left( \\rho c \\int_{0}^{L} (N_{2}(x))^{2} \\,dx \\right) + c(t) \\left( k \\int_{0}^{L} (N_{2}'(x))^{2} \\,dx \\right) = \\int_{0}^{L} Q(x)N_{2}(x) \\,dx$$\nThis equation is of the form $M\\,\\dot{c}(t)+K\\,c(t)=f$, where:\n$$M = \\rho c \\int_{0}^{L} (N_{2}(x))^{2} \\,dx$$\n$$K = k \\int_{0}^{L} (N_{2}'(x))^{2} \\,dx$$\n$$f = \\int_{0}^{L} Q(x)N_{2}(x) \\,dx$$\nNext, we must evaluate the integrals for $M$ and $K$. The interior hat function $N_{2}(x)$ for nodes at $0$, $L/2$, and $L$ is defined piecewise:\n$$N_{2}(x) = \\begin{cases} \\frac{x}{L/2} = \\frac{2x}{L}  \\text{if } 0 \\le x \\le L/2 \\\\ \\frac{L-x}{L-L/2} = \\frac{2(L-x)}{L}  \\text{if } L/2 \\le x \\le L \\end{cases}$$\nThe derivative $N_{2}'(x)$ is also piecewise constant:\n$$N_{2}'(x) = \\begin{cases} \\frac{2}{L}  \\text{if } 0  x  L/2 \\\\ -\\frac{2}{L}  \\text{if } L/2  x  L \\end{cases}$$\nNow we compute the integral for $M$:\n$$\\int_{0}^{L} (N_{2}(x))^{2} \\,dx = \\int_{0}^{L/2} \\left(\\frac{2x}{L}\\right)^{2} \\,dx + \\int_{L/2}^{L} \\left(\\frac{2(L-x)}{L}\\right)^{2} \\,dx$$\nBy symmetry, the two integrals are equal. We compute the first one:\n$$\\int_{0}^{L/2} \\frac{4x^2}{L^2} \\,dx = \\frac{4}{L^2} \\left[ \\frac{x^3}{3} \\right]_{0}^{L/2} = \\frac{4}{L^2} \\frac{(L/2)^3}{3} = \\frac{4}{L^2} \\frac{L^3}{24} = \\frac{L}{6}$$\nThus, the total integral is $\\frac{L}{6} + \\frac{L}{6} = \\frac{L}{3}$.\nThe coefficient $M$ is:\n$$M = \\rho c \\frac{L}{3}$$\nNext, we compute the integral for $K$:\n$$\\int_{0}^{L} (N_{2}'(x))^{2} \\,dx = \\int_{0}^{L/2} \\left(\\frac{2}{L}\\right)^{2} \\,dx + \\int_{L/2}^{L} \\left(-\\frac{2}{L}\\right)^{2} \\,dx$$\n$$\\int_{0}^{L} (N_{2}'(x))^{2} \\,dx = \\frac{4}{L^2} \\int_{0}^{L/2} \\,dx + \\frac{4}{L^2} \\int_{L/2}^{L} \\,dx = \\frac{4}{L^2} \\left( \\frac{L}{2} \\right) + \\frac{4}{L^2} \\left( L - \\frac{L}{2} \\right) = \\frac{2}{L} + \\frac{2}{L} = \\frac{4}{L}$$\nThe coefficient $K$ is:\n$$K = k \\frac{4}{L}$$\nThe problem asks for the decay rate $\\lambda = K/M$ for the case $Q(x)=0$. In this case, the ODE is $M\\dot{c}(t) + Kc(t) = 0$, or $\\dot{c}(t) + (K/M)c(t)=0$. The solution is $c(t) = c(0) \\exp(-(K/M)t)$, confirming that $\\lambda = K/M$ is the decay rate.\nWe calculate this ratio using our expressions for $M$ and $K$:\n$$\\lambda = \\frac{K}{M} = \\frac{4k/L}{\\rho c L/3} = \\frac{4k}{L} \\cdot \\frac{3}{\\rho c L} = \\frac{12k}{\\rho c L^2}$$\nThis is the final symbolic expression for the decay rate.", "answer": "$$\\boxed{\\frac{12k}{\\rho c L^2}}$$", "id": "2445292"}]}