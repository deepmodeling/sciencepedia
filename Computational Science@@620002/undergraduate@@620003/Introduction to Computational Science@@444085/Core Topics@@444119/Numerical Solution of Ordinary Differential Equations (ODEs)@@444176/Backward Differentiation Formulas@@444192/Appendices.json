{"hands_on_practices": [{"introduction": "Backward Differentiation Formulas are implicit methods, a characteristic that is central to their stability but also presents a computational challenge. Each step forward in time requires solving an algebraic equation for the new solution value. This practice [@problem_id:2155132] introduces a standard and powerful technique for this task: using Newton's method to iteratively find the solution at the next time step, a foundational skill for implementing implicit solvers.", "problem": "Consider the problem of numerically solving the autonomous Ordinary Differential Equation (ODE), a type of differential equation that does not explicitly depend on the independent variable. The specific ODE under consideration is:\n$$y'(t) = \\cos(y(t))$$\nAn implicit numerical scheme is employed to approximate the solution. Let $y_n$ be the numerical approximation of the solution $y(t_n)$ at time $t_n$. With a constant time step $h$, so that $t_{n+1} = t_n + h$, the approximation at the next time step, $y_{n+1}$, is determined by the following implicit equation:\n$$y_{n+1} = y_n + h \\cos(y_{n+1})$$\nTo find the value of $y_{n+1}$ at each step, we must solve this equation. This is accomplished by finding the root of the function $g(x) = x - y_n - h \\cos(x)$, where the root $x$ corresponds to $y_{n+1}$. The root is found using an iterative procedure. Let $y_{n+1}^{(k)}$ be the $k$-th approximation of the root. The subsequent approximation, $y_{n+1}^{(k+1)}$, is determined by finding the root of the line that is tangent to the function $g(x)$ at the point $x = y_{n+1}^{(k)}$.\n\nYour task is to derive the iterative update rule for $y_{n+1}^{(k+1)}$. Express your answer in terms of $y_{n+1}^{(k)}$, $y_n$, and the step size $h$.", "solution": "We are given the implicit equation for $y_{n+1}$ as the root of $g(x)=x-y_{n}-h\\cos(x)$. To compute $y_{n+1}$ iteratively, we apply Newton's method, which updates an iterate $x^{(k)}$ via\n$$\nx^{(k+1)}=x^{(k)}-\\frac{g(x^{(k)})}{g'(x^{(k)})}.\n$$\nFirst, compute the derivative of $g(x)$:\n$$\ng'(x)=\\frac{d}{dx}\\left(x-y_{n}-h\\cos(x)\\right)=1+h\\sin(x).\n$$\nUsing $x^{(k)}=y_{n+1}^{(k)}$, we substitute into Newton's update:\n$$\ny_{n+1}^{(k+1)}=y_{n+1}^{(k)}-\\frac{y_{n+1}^{(k)}-y_{n}-h\\cos\\!\\left(y_{n+1}^{(k)}\\right)}{1+h\\sin\\!\\left(y_{n+1}^{(k)}\\right)}.\n$$\nThis gives the required iterative rule expressed in terms of $y_{n+1}^{(k)}$, $y_{n}$, and $h$.", "answer": "$$\\boxed{y_{n+1}^{(k+1)}=y_{n+1}^{(k)}-\\dfrac{y_{n+1}^{(k)}-y_{n}-h\\cos\\!\\left(y_{n+1}^{(k)}\\right)}{1+h\\sin\\!\\left(y_{n+1}^{(k)}\\right)}}$$", "id": "2155132"}, {"introduction": "For any linear multistep method, convergence to the true solution is not guaranteed without stability. Zero-stability is a fundamental requirement ensuring that the numerical solution does not grow unboundedly due to the method itself. In this exercise [@problem_id:2155174], you will verify this critical property for the two-step BDF method by finding the roots of its characteristic polynomial and applying the root condition, bridging the gap between abstract stability theory and concrete analysis.", "problem": "In the field of numerical analysis, linear multistep methods are used for the numerical solution of ordinary differential equations. A fundamental property of such a method is its zero-stability, which is essential for convergence. A linear multistep method is defined to be zero-stable if all roots of its first characteristic polynomial, $\\rho(z)$, satisfy the root condition:\n1. All roots must lie within or on the unit circle in the complex plane, i.e., their magnitude $|z|$ must be less than or equal to 1.\n2. Any root that lies exactly on the unit circle (i.e., $|z|=1$) must be a simple root (i.e., not a repeated root).\n\nConsider the two-step Backward Differentiation Formula (BDF2), a popular method for solving stiff differential equations. Its first characteristic polynomial is given by:\n$$\n\\rho(z) = \\frac{3}{2}z^2 - 2z + \\frac{1}{2}\n$$\n\nBy finding the roots of this polynomial and applying the root condition, determine which of the following statements correctly describes the zero-stability of the BDF2 method.\n\nA. The method is not zero-stable because a root lies outside the unit circle.\n\nB. The method is not zero-stable because there is a multiple root on the unit circle.\n\nC. The method is zero-stable because all roots lie strictly inside the unit circle.\n\nD. The method is zero-stable because all roots have a magnitude less than or equal to one, and the root on the unit circle is simple.\n\nE. The method is not zero-stable because one of its roots is a non-integer fraction.", "solution": "Zero-stability requires that all roots of the first characteristic polynomial lie in the closed unit disk and that any root on the unit circle be simple.\n\nGiven the BDF2 characteristic polynomial\n$$\n\\rho(z) = \\frac{3}{2}z^{2} - 2z + \\frac{1}{2},\n$$\nwe find its roots by solving $\\rho(z)=0$. Multiply by $2$ to clear denominators:\n$$\n3z^{2} - 4z + 1 = 0.\n$$\nApply the quadratic formula to $az^{2} + bz + c = 0$ with $a=3$, $b=-4$, $c=1$:\n$$\nz = \\frac{-b \\pm \\sqrt{b^{2} - 4ac}}{2a} = \\frac{4 \\pm \\sqrt{16 - 12}}{6} = \\frac{4 \\pm 2}{6}.\n$$\nThus the two roots are\n$$\nz_{1} = \\frac{6}{6} = 1, \\qquad z_{2} = \\frac{2}{6} = \\frac{1}{3}.\n$$\nTheir magnitudes are\n$$\n|z_{1}| = 1, \\qquad |z_{2}| = \\frac{1}{3} < 1.\n$$\nBoth roots lie in or on the unit circle, and the root on the unit circle, $z=1$, is simple because the roots are distinct. Therefore the root condition is satisfied and the method is zero-stable.\n\nAmong the given statements, this corresponds to: all roots have magnitude less than or equal to one, and the root on the unit circle is simple.", "answer": "$$\\boxed{D}$$", "id": "2155174"}, {"introduction": "Beyond formal stability, the practical behavior of a numerical method reveals much about its utility. This exercise [@problem_id:2155163] investigates the phenomenon of numerical dissipation by applying the BDF1 method to an undamped harmonic oscillator, a system that should conserve energy. By quantifying the artificial amplitude decay, you will gain insight into the L-stability of BDF methods, a key feature that makes them exceptionally effective for solving stiff differential equations.", "problem": "A numerical analyst is investigating the inherent dissipative properties of the first-order Backward Differentiation Formula (BDF1). The BDF1 method approximates the solution to a system of Ordinary Differential Equations (ODEs) of the form $\\mathbf{u}'(t) = \\mathbf{f}(t, \\mathbf{u}(t))$ using the iterative scheme:\n$$\n\\mathbf{u}_{n+1} = \\mathbf{u}_n + h \\mathbf{f}(t_{n+1}, \\mathbf{u}_{n+1})\n$$\nwhere $h$ is the constant time step size, $t_n = n h$, and $\\mathbf{u}_n$ is the numerical approximation of $\\mathbf{u}(t_n)$.\n\nTo quantify the dissipation, the analyst applies the BDF1 method to the undamped simple harmonic oscillator, described by the second-order ODE:\n$$\ny''(t) + \\omega^2 y(t) = 0\n$$\nwhere $\\omega$ is a constant positive angular frequency. This equation is first converted into a system of two first-order ODEs by defining a state vector $\\mathbf{u}(t) = \\begin{pmatrix} y(t) \\\\ y'(t) \\end{pmatrix}$.\n\nThe true solution to this ODE exhibits oscillations with a constant amplitude. However, when solved numerically with the BDF1 method, the amplitude of the numerical solution artificially decays over time. This phenomenon is known as numerical dissipation.\n\nCalculate the factor $\\gamma$ by which the amplitude of the numerical solution is reduced after integrating over one full period, $T = 2\\pi/\\omega$, of the true oscillation. Express your final answer as a function of the dimensionless parameter $\\alpha = \\omega h$.", "solution": "We start by rewriting the harmonic oscillator as a first-order linear system. Define the state vector $\\mathbf{u}(t) = \\begin{pmatrix} y(t) \\\\ v(t) \\end{pmatrix}$ with $v(t) = y'(t)$. Then the dynamics are\n$$\n\\mathbf{u}'(t) = A \\mathbf{u}(t), \\quad A = \\begin{pmatrix} 0 & 1 \\\\ -\\omega^{2} & 0 \\end{pmatrix}.\n$$\nApplying the BDF1 (backward Euler) method to a linear system $\\mathbf{u}' = A \\mathbf{u}$ with constant step size $h$ gives the one-step relation\n$$\n\\mathbf{u}_{n+1} = \\mathbf{u}_{n} + h A \\mathbf{u}_{n+1},\n$$\nwhich is equivalent to\n$$\n\\left(I - h A\\right)\\mathbf{u}_{n+1} = \\mathbf{u}_{n}, \\quad \\mathbf{u}_{n+1} = G \\mathbf{u}_{n}, \\quad G = \\left(I - h A\\right)^{-1}.\n$$\nFor the given $A$,\n$$\nI - h A = \\begin{pmatrix} 1 & -h \\\\ h \\omega^{2} & 1 \\end{pmatrix}, \\quad \\det(I - h A) = 1 + h^{2}\\omega^{2}.\n$$\nThus,\n$$\nG = \\frac{1}{1 + h^{2}\\omega^{2}} \\begin{pmatrix} 1 & h \\\\ -h \\omega^{2} & 1 \\end{pmatrix}.\n$$\nThe eigenvalues of $A$ are $\\lambda_{\\pm} = \\pm i \\omega$. Since $G = (I - h A)^{-1}$, the eigenvalues of $G$ are\n$$\n\\mu_{\\pm} = \\frac{1}{1 - h \\lambda_{\\pm}} = \\frac{1}{1 \\mp i \\omega h}.\n$$\nLet $\\alpha = \\omega h$. Then\n$$\n\\mu_{\\pm} = \\frac{1}{1 \\mp i \\alpha}, \\quad |\\mu_{\\pm}| = \\frac{1}{\\sqrt{1 + \\alpha^{2}}}.\n$$\nTherefore, each backward Euler step multiplies the oscillatory mode by a complex number of magnitude\n$$\nr = \\frac{1}{\\sqrt{1 + \\alpha^{2}}} < 1,\n$$\nwhich represents the per-step decay factor for the amplitude. Over a time interval $T$, the number of steps is $M = T/h$. Hence, the total amplitude reduction factor is $r^{M}$.\n\nFor one true period $T = \\frac{2\\pi}{\\omega}$, we have $M = \\frac{T}{h} = \\frac{2\\pi}{\\omega h} = \\frac{2\\pi}{\\alpha}$. Thus the amplitude reduction factor after one full period is\n$$\n\\gamma = r^{M} = \\left(\\frac{1}{\\sqrt{1 + \\alpha^{2}}}\\right)^{\\frac{2\\pi}{\\alpha}} = \\left(1 + \\alpha^{2}\\right)^{-\\frac{\\pi}{\\alpha}}.\n$$\nThis gives the required dissipation factor as a function of the dimensionless parameter $\\alpha$.", "answer": "$$\\boxed{\\left(1+\\alpha^{2}\\right)^{-\\frac{\\pi}{\\alpha}}}$$", "id": "2155163"}]}