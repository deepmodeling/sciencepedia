{"hands_on_practices": [{"introduction": "The best way to understand the shooting method is to implement it. This first practice provides a complete, hands-on exercise in solving a nonlinear boundary value problem (BVP) where an analytical solution is not readily available. By working through the challenge of solving $y''=y^3$, you will construct the full numerical pipeline: converting the BVP into an initial value problem (IVP), using a numerical integrator to \"shoot,\" and employing a root-finding algorithm to \"aim\" your shot until the boundary condition is met [@problem_id:3192271]. This exercise serves as a foundational template for applying the shooting method to a wide array of problems in science and engineering.", "problem": "Consider the boundary value problem (BVP) for a scalar function $y(x)$ on the interval $[0,1]$ given by the second-order ordinary differential equation $y''(x)=y(x)^3$ with boundary conditions $y(0)=0$ and $y(1)=B$, where $B$ is a real parameter. The shooting method reduces this BVP to solving an initial value problem with an unknown initial slope $s=y'(0)$ and defining a residual map $F(s)=y(1;s)-B$, where $y(x;s)$ denotes the solution of the initial value problem $y''=y^3$, $y(0)=0$, $y'(0)=s$. A solution to the BVP corresponds to a root of $F(s)=0$. Starting from the fundamental definitions of ordinary differential equations and the shooting method, and using well-tested facts from calculus (energy integrals and monotonicity derived from separable forms), derive the qualitative behavior of the map $s\\mapsto y(1;s)$ for the nonlinear equation $y''=y^3$. In particular, address whether multiple distinct values of $s$ can satisfy $y(1)=B$ for a fixed $B$, and discuss how a robust root-finding algorithm navigates potential multiple solution branches.\n\nYour program must:\n- Implement the shooting method by numerically integrating the initial value problem $y'(x)=v(x)$, $v'(x)=y(x)^3$ with $y(0)=0$ and $v(0)=s$ to $x=1$, and computing $F(s)=y(1;s)-B$.\n- Use a bracketing-based root-finder to solve $F(s)=0$ for $s$, expanding brackets adaptively to ensure a sign change.\n- For each test case specified below, compute a numerical approximation of the initial slope $s$ that satisfies the boundary condition at $x=1$.\n\nThere are no physical units involved in this problem. Angles are not used. All numeric answers must be floats.\n\nTest suite:\n1. $B=0$ (boundary case).\n2. $B=0.5$ (positive amplitude, general case).\n3. $B=-0.5$ (negative amplitude, symmetric branch).\n4. $B=2.0$ (larger positive amplitude).\n5. $B=-2.0$ (larger negative amplitude).\n\nFinal output format:\n- Your program should produce a single line of output containing the computed values of $s$ for the five test cases as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places (e.g., $[s_1,s_2,s_3,s_4,s_5]$).", "solution": "The user has provided a problem that requires both a qualitative analysis of a boundary value problem (BVP) and a numerical solution using the shooting method. I will first validate the problem statement.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: Second-order ordinary differential equation (ODE) $y''(x)=y(x)^3$.\n-   **Domain**: $x \\in [0,1]$.\n-   **Boundary Conditions (BCs)**: $y(0)=0$ and $y(1)=B$, where $B$ is a real parameter.\n-   **Shooting Method Formulation**:\n    -   The BVP is converted to an initial value problem (IVP) by introducing an unknown initial slope $s = y'(0)$.\n    -   The equivalent IVP is: $y''=y^3$, with initial conditions $y(0)=0$ and $y'(0)=s$.\n    -   A residual map is defined as $F(s)=y(1;s)-B$, where $y(x;s)$ is the solution to the IVP for a given $s$.\n    -   A solution to the BVP corresponds to finding a root $s$ such that $F(s)=0$.\n-   **Required Analysis**: Derive the qualitative behavior of the map $s \\mapsto y(1;s)$, including the possibility of multiple solutions and its implications for root-finding.\n-   **Test Suite**: The parameter $B$ is given for five test cases: $0, 0.5, -0.5, 2.0, -2.0$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded (Critical)**: The problem is based on the well-established theory of ordinary differential equations and standard numerical methods (the shooting method). The equation $y''=y^3$ is a specific instance of a nonlinear Emden-Fowler equation, a widely studied class of equations. The problem is scientifically sound.\n2.  **Well-Posed**: The problem asks for both a qualitative analysis and a numerical solution. The qualitative analysis below will establish that for any given $B$, a unique solution for $s$ exists, making the root-finding problem well-posed.\n3.  **Objective (Critical)**: The problem is stated using precise mathematical language and definitions. There are no subjective or ambiguous terms.\n4.  **Completeness**: All necessary information (the ODE, boundary conditions, and the definition of the shooting method) is provided to perform the analysis and develop a numerical solution. The problem is self-contained.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-defined task in computational science that involves both theoretical analysis and numerical implementation. I will now proceed with a full solution.\n\n---\n\n### Principle-Based Solution\n\nThe task is to solve the boundary value problem $y''(x) = y(x)^3$ on the interval $x \\in [0, 1]$, with boundary conditions $y(0)=0$ and $y(1)=B$. The core of the problem lies in understanding the properties of the shooting function, which maps the initial slope $s=y'(0)$ to the final position $y(1;s)$.\n\n#### Qualitative Analysis of the Map $s \\mapsto y(1;s)$\n\nLet $g(s) = y(1;s)$ be the map we wish to analyze.\n\n**1. Energy Integral and Sign Behavior**\nWe can derive a first integral of the motion for the ODE $y'' = y^3$ by multiplying by $y'$:\n$$ y'(x) y''(x) = y(x)^3 y'(x) $$\nIntegrating with respect to $x$ from $0$ to $x$ yields:\n$$ \\int_0^x \\frac{d}{d\\tau}\\left(\\frac{1}{2}(y'(\\tau))^2\\right) d\\tau = \\int_0^x \\frac{d}{d\\tau}\\left(\\frac{1}{4}y(\\tau)^4\\right) d\\tau $$\nApplying the fundamental theorem of calculus and the initial conditions $y(0)=0$ and $y'(0)=s$:\n$$ \\frac{1}{2}(y'(x))^2 - \\frac{1}{2}(y'(0))^2 = \\frac{1}{4}y(x)^4 - \\frac{1}{4}y(0)^4 $$\n$$ \\frac{1}{2}(y'(x))^2 - \\frac{1}{2}s^2 = \\frac{1}{4}y(x)^4 - 0 $$\nThis gives the \"energy conservation\" law:\n$$ (y'(x))^2 = \\frac{1}{2}y(x)^4 + s^2 $$\nFrom this relation, we can infer the sign of the solution $y(x;s)$:\n-   If $s=0$, the equation becomes $(y')^2 = \\frac{1}{2}y^4$. With ICs $y(0)=0$, $y'(0)=0$, the unique solution is the trivial one: $y(x;0) = 0$ for all $x$. Thus, $g(0) = y(1;0) = 0$.\n-   If $s  0$, then $y'(0)  0$. The right-hand side $\\frac{1}{2}y^4 + s^2$ is always positive. Therefore, $y'(x)$ can never be zero and must maintain its initial positive sign. So, for $s0$, $y'(x)0$ for all $x$. Since $y(0)=0$, the function $y(x)$ is strictly increasing, which implies $y(x;s)  0$ for $x0$. Consequently, $g(s) = y(1;s)  0$.\n-   If $s  0$, then $y'(0)  0$. Similarly, $y'(x)$ must remain negative. The function $y(x)$ is strictly decreasing, which implies $y(x;s)  0$ for $x0$. Consequently, $g(s) = y(1;s)  0$.\n\nIn summary, the function $g(s)$ is sign-preserving: $g(s)$ has the same sign as $s$.\n\n**2. Monotonicity and Uniqueness of Solutions**\nTo determine if multiple values of $s$ can lead to the same $y(1)=B$, we analyze the derivative of $g(s)$, i.e., $g'(s) = \\frac{d}{ds}y(1;s)$. Let $z(x;s) = \\frac{\\partial y}{\\partial s}(x;s)$. We can find the differential equation governing $z$ by differentiating the original IVP with respect to $s$:\n-   ODE: $\\frac{\\partial}{\\partial s}(y'' - y^3) = 0 \\implies z'' - 3y^2 z = 0$, so $z''(x) = 3y(x;s)^2 z(x)$.\n-   IC 1: $z(0) = \\frac{\\partial}{\\partial s}y(0;s) = \\frac{\\partial}{\\partial s}(0) = 0$.\n-   IC 2: $z'(0) = \\frac{\\partial}{\\partial s}y'(0;s) = \\frac{\\partial}{\\partial s}(s) = 1$.\n\nThis is a linear, homogeneous, second-order ODE for $z(x)$. The coefficient $q(x) = 3y(x;s)^2$ is always non-negative. Since $z(0)=0$ and $z'(0)=1$, $z(x)$ starts increasing from zero. For $x  0$ where $z(x)0$, the term $z''(x) = q(x)z(x)$ must be non-negative, which indicates that $z(x)$ is convex. A convex function starting at $0$ with a positive slope must remain positive for all $x0$. Thus, $z(x;s)  0$ for all $x  0$.\nIn particular, at $x=1$, we have $g'(s) = z(1;s)  0$. Since the derivative of $g(s)$ is always positive, the function $g(s)=y(1;s)$ is strictly increasing for all $s$ where it is defined.\n\n**Conclusion**: For any real number $B$, the equation $y(1;s)=B$ can have at most one solution for $s$. There are no multiple solution branches. This significantly simplifies the root-finding task.\n\n**3. Finite-Time Blow-up and Robust Root-Finding**\nThe separable form of the energy integral, $y' = \\sqrt{\\frac{1}{2}y^4+s^2}$ (for $s0$), can be written as $dx = \\frac{dy}{\\sqrt{\\frac{1}{2}y^4+s^2}}$. The time $x$ to reach a state $y$ is $x(y) = \\int_0^y \\frac{d\\tilde{y}}{\\sqrt{\\frac{1}{2}\\tilde{y}^4+s^2}}$. The integral to $y \\to \\infty$ converges to a finite value, $x_{bu}(s)$, meaning the solution blows up to infinity at a finite $x$. The larger $|s|$, the faster $y$ grows, and the smaller $x_{bu}(s)$ becomes.\nThis implies there exists a critical value $|s_{crit}|$ such that $x_{bu}(|s_{crit}|)=1$. For any $|s| \\ge |s_{crit}|$, the solution to the IVP becomes infinite at or before $x=1$. Therefore, the domain of our map $g(s)$ is the open interval $(-s_{crit}, s_{crit})$. Within this domain, $g(s)$ is strictly increasing from $-\\infty$ to $+\\infty$.\nThis proves that for any finite $B$, there exists exactly one value of $s$ solving $y(1;s)=B$.\n\nA robust root-finding algorithm should not be concerned with multiple roots, but with the finite domain of $g(s)$. A bracketing method (like bisection or Brent's method) is ideal due to the proven monotonicity. The main challenge is finding an initial bracket $[s_a, s_b]$ that lies within $(-s_{crit}, s_{crit})$. An adaptive search for the bracket must correctly interpret a failure of the numerical ODE integrator (which occurs if a trial $s$ is outside the domain) as an indication that $y(1;s)$ is effectively infinite, thus helping to bound the root.\n\n**4. Symmetry**\nWe can analyze the symmetry of the map $g(s)$. Let $y(x; s)$ be the solution to the IVP $y''=y^3$, $y(0)=0$, $y'(0)=s$. Now consider the function $u(x) = -y(x; -s)$. Let's check the IVP it satisfies:\n-   Initial condition 1: $u(0) = -y(0; -s) = -0 = 0$.\n-   Initial condition 2: $u'(x) = -y'(x; -s)$, so $u'(0) = -y'(0; -s) = -(-s) = s$.\n-   ODE: $u''(x) = -y''(x; -s) = -(y(x; -s))^3$. Since $y(x;-s) = -u(x)$, this becomes $u''(x) = -(-u(x))^3 = -(-u(x)^3) = u(x)^3$.\nSo, $u(x)$ satisfies the exact same IVP as $y(x; s)$. By the uniqueness of solutions to IVPs, we must have $u(x) = y(x; s)$. This gives the identity $y(x; s) = -y(x; -s)$. At $x=1$, this means $g(s) = y(1; s) = -y(1; -s) = -g(-s)$, proving that $g(s)$ is an odd function. This symmetry implies that if $s_B$ is the slope that yields $y(1)=B$, then the slope $-s_B$ will yield $y(1)=-B$.\n\n#### Numerical Implementation\nBased on this analysis, the numerical approach is:\n1.  Represent the second-order ODE as a system of two first-order ODEs: let $\\mathbf{u} = [y, v]^T = [y, y']^T$. Then $\\mathbf{u}' = [v, y^3]^T$. The initial condition is $\\mathbf{u}(0) = [0, s]^T$.\n2.  For a given $B$, define the residual function $F(s) = y(1;s) - B$. This function uses a numerical integrator, such as `scipy.integrate.solve_ivp`, to compute $y(1;s)$.\n3.  Implement an adaptive bracketing search. For $B0$, we know $s0$. We can fix one end of the bracket at $s_a=0$ (where $F(0, B) = -B  0$) and search for an $s_b  0$ such that $F(s_b, B)  0$. The search must handle integration failures, which indicate $s_b$ is beyond the blow-up point and can serve as an upper bound. A similar strategy applies for $B0$.\n4.  Use a robust bracketing root-finder, like Brent's method (`scipy.optimize.root_scalar` with `method='brentq'`), to find the unique root within the determined bracket.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the initial slope 's' for a BVP using the shooting method\n    for several boundary values 'B'.\n    \"\"\"\n    test_cases = [0.0, 0.5, -0.5, 2.0, -2.0]\n    results = []\n\n    for B in test_cases:\n        # For the trivial boundary condition B=0, the solution is y(x)=0,\n        # which corresponds to an initial slope s=0.\n        if B == 0.0:\n            results.append(0.0)\n            continue\n\n        def residual_map(s, B_val):\n            \"\"\"\n            Computes the residual F(s) = y(1;s) - B.\n            This function defines the shooting problem to be solved.\n            \"\"\"\n            # For s=0, we know y(1;0)=0 without integration.\n            if s == 0.0:\n                y_at_1 = 0.0\n            else:\n                # Define the ODE system for the integrator.\n                # Let u = [y, y'], so u' = [y', y''] = [y', y^3].\n                def ode_system(t, u):\n                    return [u[1], u[0]**3]\n\n                u0 = [0.0, s]  # Initial conditions: y(0)=0, y'(0)=s\n                t_span = [0.0, 1.0]\n\n                # Numerically integrate the IVP from x=0 to x=1.\n                sol = solve_ivp(\n                    ode_system,\n                    t_span,\n                    u0,\n                    method='RK45',\n                    atol=1e-9,  # Use tight tolerances for accuracy.\n                    rtol=1e-9,\n                    max_step=0.01  # Prevent solver from stepping over singularity.\n                )\n                \n                # If integration fails, it implies a finite-time blow-up.\n                # We treat y(1) as infinite, helping to bound the root.\n                if sol.status != 0:\n                    return np.sign(s) * np.inf\n                \n                y_at_1 = sol.y[0, -1]\n\n            return y_at_1 - B_val\n\n        # --- Adaptive Bracketing Strategy ---\n        # Based on the qualitative analysis, s must have the same sign as B.\n        s_a, s_b = None, None\n        \n        if B > 0:\n            # We need an s > 0. The bracket will be [0, s_b].\n            # F(0, B) = -B  0.\n            s_a = 0.0\n            s_b_guess = 0.1  # Start with a small positive guess for s.\n            max_iter = 20\n            for _ in range(max_iter):\n                f_b = residual_map(s_b_guess, B)\n                # Success if f_b is positive (or +inf, meaning we passed the blow-up point).\n                if f_b > 0:\n                    s_b = s_b_guess\n                    break\n                s_b_guess *= 2.0  # Expand the search interval.\n            else:\n                raise RuntimeError(f\"Could not find an upper bracket for B={B}\")\n        \n        else:  # B  0\n            # We need an s  0. The bracket will be [s_a, 0].\n            # F(0, B) = -B > 0.\n            s_b = 0.0\n            s_a_guess = -0.1 # Start with a small negative guess for s.\n            max_iter = 20\n            for _ in range(max_iter):\n                f_a = residual_map(s_a_guess, B)\n                # Success if f_a is negative (or -inf).\n                if f_a  0:\n                    s_a = s_a_guess\n                    break\n                s_a_guess *= 2.0\n            else:\n                raise RuntimeError(f\"Could not find a lower bracket for B={B}\")\n        \n        # Use a robust bracketing root-finder (Brent's method).\n        sol_root = root_scalar(residual_map, args=(B,), bracket=[s_a, s_b], method='brentq')\n        results.append(sol_root.root)\n\n    # Format and print the final output as a single-line list.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n\n```", "id": "3192271"}, {"introduction": "After learning the mechanics of how to aim and shoot, it is crucial to explore scenarios where the method behaves unexpectedly. This problem presents a critical thought experiment using the simple harmonic oscillator equation, $y'' + y = 0$. Here, we investigate what happens when the boundary value problem is structured as a homogeneous eigenvalue problem, a situation where non-trivial solutions exist only for specific system parameters [@problem_id:3192307]. Analyzing this case reveals a fundamental failure mode where infinitely many initial slopes satisfy the boundary conditions, making the root-finding aspect of the shooting method ill-posed and offering deep insight into the method's limitations.", "problem": "Consider the two-point Boundary Value Problem (BVP) for a second-order linear Ordinary Differential Equation (ODE) on the interval $[0,\\pi]$: $y'' + y = 0$, with Dirichlet boundary conditions $y(0) = 0$ and $y(\\pi) = 0$. In the shooting method, one converts the BVP to an Initial Value Problem (IVP) by selecting an initial slope (shooting angle) $s = y'(0)$ and integrating forward from $x = 0$ to $x = \\pi$ to test the terminal boundary condition. Based on the governing equation, its linearity, and the structure of solutions under these boundary conditions, determine which of the following statements are correct:\n\nA. For any real shooting angle $s = y'(0)$, the solution of the IVP satisfies $y(\\pi) = 0$, so the boundary condition at $x = \\pi$ is met regardless of $s$.\n\nB. The boundary condition at $x = \\pi$ is satisfied only when $s = 0$.\n\nC. The irrelevance of $s$ arises because the pair $\\{y'' + y = 0,\\, y(0) = 0,\\, y(\\pi) = 0\\}$ constitutes an eigenvalue problem in which $\\lambda = 1$ is an eigenvalue on $[0,\\pi]$, yielding an eigenfunction proportional to $\\sin x$ that automatically vanishes at both boundaries.\n\nD. If one defines the shooting residual $R(s) = y(\\pi; s) - 0$ and applies a Newton update in $s$, then $\\mathrm{d}R/\\mathrm{d}s$ is identically $0$, so the update cannot change $s$.\n\nE. Replacing $y'' + y$ by $y'' + (1 + \\varepsilon)y$ for any small positive $\\varepsilon$ preserves the property that $y(\\pi; s) = 0$ for all $s$.\n\nF. The space of functions that satisfy both boundary conditions is one-dimensional and given by $\\{A \\sin x : A \\in \\mathbb{R}\\}$, so $s$ plays the role of a free amplitude parameter.\n\nSelect all correct options.", "solution": "The user wants me to act as a meticulous STEM professor, validate the provided problem statement, and then solve it by evaluating each option.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Governing Equation**: Second-order linear Ordinary Differential Equation (ODE): $y'' + y = 0$.\n-   **Domain**: The interval $[0, \\pi]$.\n-   **Boundary Conditions (BCs)**: Dirichlet boundary conditions $y(0) = 0$ and $y(\\pi) = 0$.\n-   **Shooting Method Setup**: The Boundary Value Problem (BVP) is converted to an Initial Value Problem (IVP).\n-   **Initial Conditions (ICs) for IVP**: $y(0) = 0$ and an initial slope (shooting angle) $s = y'(0)$.\n-   **Objective**: To determine the properties of the solution $y(x; s)$ of the IVP, particularly with respect to the terminal boundary condition at $x = \\pi$.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The problem is a classic example from the theory of ordinary differential equations and numerical analysis. The equation $y'' + y = 0$ represents a simple harmonic oscillator. The shooting method is a standard technique for solving BVPs. The connection to eigenvalue problems (specifically, Sturm-Liouville theory) is a fundamental concept. The problem is scientifically sound.\n-   **Well-Posed**: The BVP itself ($y''+y=0, y(0)=0, y(\\pi)=0$) is a homogeneous problem. Such problems are known to have either only the trivial solution or infinitely many solutions. The fact that this BVP has non-unique solutions is the central point of the question, which asks us to analyze the consequences of this feature for the shooting method. The question posed about this specific BVP is well-defined and seeks to probe the understanding of this special case.\n-   **Objective**: The problem is stated using precise mathematical language, free from ambiguity or subjective content.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. It is a well-posed question about a specific, conceptually important BVP that highlights a particular behavior of the shooting method. I will proceed with the solution.\n\n### Solution Derivation\n\nThe core of the shooting method is to solve the IVP defined by the ODE and the-initial conditions.\nThe ODE is:\n$$y'' + y = 0$$\nThe initial conditions are:\n$$y(0) = 0$$\n$$y'(0) = s$$\nThis is a second-order linear homogeneous ODE with constant coefficients. The characteristic equation is $r^2 + 1 = 0$, which has roots $r = \\pm i$.\nThe general solution is of the form:\n$$y(x) = C_1 \\cos(x) + C_2 \\sin(x)$$\nWe apply the initial conditions to find the constants $C_1$ and $C_2$.\nFrom $y(0) = 0$:\n$$y(0) = C_1 \\cos(0) + C_2 \\sin(0) = C_1 \\cdot 1 + C_2 \\cdot 0 = C_1$$\nSo, $C_1 = 0$. The solution simplifies to $y(x) = C_2 \\sin(x)$.\n\nNext, we use the second initial condition, $y'(0) = s$. First, we find the derivative of $y(x)$:\n$$y'(x) = C_2 \\cos(x)$$\nNow, apply the condition at $x=0$:\n$$y'(0) = C_2 \\cos(0) = C_2 \\cdot 1 = C_2$$\nSo, $C_2 = s$.\n\nSubstituting the values of $C_1$ and $C_2$ back into the general solution, we obtain the unique solution to the IVP for a given shooting angle $s$:\n$$y(x; s) = s \\sin(x)$$\nNow, we must check if this solution satisfies the terminal boundary condition, $y(\\pi) = 0$. We evaluate our solution at $x = \\pi$:\n$$y(\\pi; s) = s \\sin(\\pi) = s \\cdot 0 = 0$$\nThis result shows that the terminal boundary condition $y(\\pi) = 0$ is satisfied for **any** real value of the shooting parameter $s$. This is a special case where the shooting method does not yield a unique value for $s$ because any value of $s$ leads to a solution of the BVP.\n\n### Option-by-Option Analysis\n\n**A. For any real shooting angle $s = y'(0)$, the solution of the IVP satisfies $y(\\pi) = 0$, so the boundary condition at $x = \\pi$ is met regardless of $s$.**\nOur derivation showed that $y(\\pi; s) = s \\sin(\\pi) = 0$ for any arbitrary real number $s$. This statement is a direct and accurate conclusion from the solution of the IVP.\n**Verdict: Correct**\n\n**B. The boundary condition at $x = \\pi$ is satisfied only when $s = 0$.**\nThis statement contradicts our finding that the boundary condition is met for all real $s$. The case $s=0$ yields the trivial solution $y(x) = 0$, which satisfies the BCs, but any non-zero $s$ also yields a valid non-trivial solution, for example $y(x) = \\sin(x)$ for $s=1$.\n**Verdict: Incorrect**\n\n**C. The irrelevance of $s$ arises because the pair $\\{y'' + y = 0,\\, y(0) = 0,\\, y(\\pi) = 0\\}$ constitutes an eigenvalue problem in which $\\lambda = 1$ is an eigenvalue on $[0,\\pi]$, yielding an eigenfunction proportional to $\\sin x$ that automatically vanishes at both boundaries.**\nLet's analyze the BVP as a Sturm-Liouville eigenvalue problem of the form $-y'' = \\lambda y$ with $y(0)=0$ and $y(\\pi)=0$. Our ODE $y''+y=0$ can be written as $-y'' = 1 \\cdot y$, so we are testing if $\\lambda=1$ is an eigenvalue. The general solution for $-y'' = \\lambda y$ is $y(x) = A \\cos(\\sqrt{\\lambda}x) + B \\sin(\\sqrt{\\lambda}x)$. Applying $y(0)=0$ gives $A=0$. The solution is $y(x) = B \\sin(\\sqrt{\\lambda}x)$. Applying $y(\\pi)=0$ gives $B \\sin(\\sqrt{\\lambda}\\pi) = 0$. For a non-trivial solution ($B \\neq 0$), we require $\\sin(\\sqrt{\\lambda}\\pi) = 0$, which means $\\sqrt{\\lambda}\\pi = n\\pi$ for an integer $n \\geq 1$. The eigenvalues are $\\lambda_n = n^2$. For $n=1$, we get the eigenvalue $\\lambda_1 = 1$, with the corresponding eigenfunction $\\sin(x)$. The given BVP corresponds exactly to this case. Any solution must be a multiple of the eigenfunction, i.e., $y(x) = A \\sin(x)$. Our IVP solution $y(x;s) = s \\sin(x)$ is precisely of this form. The irrelevance of $s$ is that any multiple of the eigenfunction is a valid solution, so there is no unique non-trivial solution to determine. This statement correctly identifies the fundamental reason for the observed behavior.\n**Verdict: Correct**\n\n**D. If one defines the shooting residual $R(s) = y(\\pi; s) - 0$ and applies a Newton update in $s$, then $\\mathrm{d}R/\\mathrm{d}s$ is identically $0$, so the update cannot change $s$.**\nThe residual function is $R(s) = y(\\pi; s) = s \\sin(\\pi) = 0$. Since $R(s)$ is the constant function $0$, its derivative with respect to $s$ is also identically $0$: $\\frac{\\mathrm{d}R}{\\mathrm{d}s} = 0$. Newton's method for finding a root of $R(s)=0$ requires the update step $s_{k+1} = s_k - R(s_k) / (\\mathrm{d}R/\\mathrm{d}s)$. In our case, this becomes $s_{k+1} = s_k - 0/0$, which is an undefined expression. Therefore, the method fails and cannot produce a new value for $s$. The statement accurately describes this breakdown.\n**Verdict: Correct**\n\n**E. Replacing $y'' + y$ by $y'' + (1 + \\varepsilon)y$ for any small positive $\\varepsilon$ preserves the property that $y(\\pi; s) = 0$ for all $s$.**\nLet's consider the perturbed problem $y'' + (1 + \\varepsilon)y = 0$ with $\\varepsilon  0$. Let $\\omega^2 = 1+\\varepsilon$. The general solution is $y(x) = C_1 \\cos(\\omega x) + C_2 \\sin(\\omega x)$. Applying the IVP conditions $y(0)=0$ and $y'(0)=s$, we find $C_1=0$ and $C_2 = s/\\omega$. The solution is $y(x; s) = \\frac{s}{\\omega} \\sin(\\omega x)$. At $x=\\pi$, we have $y(\\pi; s) = \\frac{s}{\\sqrt{1+\\varepsilon}} \\sin(\\pi\\sqrt{1+\\varepsilon})$. For this to be zero for all $s$, we would need $\\sin(\\pi\\sqrt{1+\\varepsilon}) = 0$. This would imply $\\sqrt{1+\\varepsilon}$ must be an integer. But for small $\\varepsilon  0$, $\\sqrt{1+\\varepsilon}$ is a number slightly greater than $1$ but not an integer. Thus, $\\sin(\\pi\\sqrt{1+\\varepsilon}) \\neq 0$. Consequently, $y(\\pi; s) = 0$ only if $s=0$. The property is not preserved.\n**Verdict: Incorrect**\n\n**F. The space of functions that satisfy both boundary conditions is one-dimensional and given by $\\{A \\sin x : A \\in \\mathbb{R}\\}$, so $s$ plays the role of a free amplitude parameter.**\nAs shown in the analysis for option C, any function satisfying the BVP ($y''+y=0, y(0)=0, y(\\pi)=0$) must be of the form $y(x) = A \\sin(x)$ for some real constant $A$. This set of functions is a vector space spanned by the single function $\\sin(x)$, so it is one-dimensional. The solution to the IVP (shooting problem) was found to be $y(x; s) = s \\sin(x)$. By comparing the two forms, we see that the shooting parameter $s$ is identical to the amplitude parameter $A$. Since $A$ can be any real number, $s$ is a free parameter. This statement provides a clear and correct description of the structure of the solution space and the role of $s$.\n**Verdict: Correct**", "answer": "$$\\boxed{ACDF}$$", "id": "3192307"}, {"introduction": "Beyond the theoretical structure of the problem, the practical success of the shooting method also depends on numerical stability. This final practice delves into a subtle but critical pitfall: catastrophic cancellation in floating-point arithmetic. We will analyze a system, $y''(x) + \\lambda^2 y(x) = 0$, that operates very close to a resonant frequency, where $\\lambda \\approx n\\pi$ [@problem_id:2158315]. In such cases, the solution becomes extremely sensitive to the initial slope, and subtracting two nearly identical endpoint values during the root-finding process can lead to a massive loss of precision. This exercise provides a sharp, analytical look at how numerical errors can undermine an otherwise sound algorithm.", "problem": "A numerical analyst is tasked with solving a second-order linear Ordinary Differential Equation (ODE) arising from a model of steady-state mechanical resonance. The governing equation is given by:\n$$y''(x) + \\lambda^2 y(x) = 0$$\nwhere $y(x)$ is the displacement at position $x$. The analysis is performed on a domain of length $L=1$. The Boundary Value Problem (BVP) is defined with the boundary conditions $y(0) = A$ and $y(1) = B$.\n\nThe analyst employs the shooting method to solve this BVP. This involves converting the BVP into an Initial Value Problem (IVP) with initial conditions $y(0) = A$ and $y'(0) = s$, where the initial slope $s$ is the shooting parameter. The correct value of $s$ is found by using the secant method to find the root of the function $F(s) = y(1; s) - B$, where $y(1; s)$ is the displacement at $x=1$ for a given slope $s$. A key step in the secant method is the computation of the difference $F(s_k) - F(s_{k-1}) = y(1; s_k) - y(1; s_{k-1})$ for two successive slope estimates, $s_k$ and $s_{k-1}$.\n\nThe computations are executed using standard floating-point arithmetic with a machine relative precision of $\\epsilon$. For the system in question, the parameter $\\lambda$ is known to be very close to $n\\pi$ for a specific large, even integer $n$. We can express this as $\\lambda = n\\pi + \\gamma$, where $\\gamma$ is a small, non-zero value. This proximity to a resonance point leads to numerical difficulties.\n\nThe primary source of numerical error in the secant method step is catastrophic cancellation when computing the difference of the two nearly-equal values, $F(s_k)$ and $F(s_{k-1})$. Assuming a worst-case scenario for rounding errors during this subtraction, determine a symbolic expression for the magnitude of $\\gamma$, which is $|\\lambda - n\\pi|$, at which the relative error of the computed difference $F(s_k) - F(s_{k-1})$ reaches 1 (i.e., 100%).\n\nExpress your answer in terms of the parameters $A$, $B$, $n$, $\\epsilon$, and the magnitude of the difference between the trial slopes, $\\Delta s = |s_k - s_{k-1}|$.", "solution": "The homogeneous ODE $y''(x) + \\lambda^2 y(x) = 0$ has the general solution $y(x) = C_{1} \\cos(\\lambda x) + C_{2} \\sin(\\lambda x)$. Imposing the IVP initial conditions $y(0) = A$ and $y'(0) = s$ gives $C_{1} = A$ and, since $y'(x) = -A \\lambda \\sin(\\lambda x) + C_{2} \\lambda \\cos(\\lambda x)$, we get $y'(0) = C_{2} \\lambda = s$, hence $C_{2} = s/\\lambda$. Therefore,\n$$\ny(1; s) = A \\cos(\\lambda) + \\frac{s}{\\lambda} \\sin(\\lambda).\n$$\nThe secant method uses $F(s) = y(1; s) - B$, so\n$$\nF(s) = A \\cos(\\lambda) + \\frac{s}{\\lambda} \\sin(\\lambda) - B.\n$$\nThus, for two trial slopes $s_{k}$ and $s_{k-1}$,\n$$\nF(s_{k}) - F(s_{k-1}) = \\frac{s_{k} - s_{k-1}}{\\lambda} \\sin(\\lambda),\n$$\nand with $\\Delta s = |s_{k} - s_{k-1}|$,\n$$\n|F(s_{k}) - F(s_{k-1})| = \\frac{\\Delta s}{|\\lambda|} |\\sin(\\lambda)|.\n$$\n\nUnder standard floating-point rounding, the worst-case absolute error in subtracting two nearly equal floating-point numbers $a$ and $b$ is bounded by $\\epsilon \\left(|a| + |b|\\right)$. Applying this to $a = F(s_{k})$ and $b = F(s_{k-1})$, the worst-case relative error in the computed difference is\n$$\n\\text{rel. err.} \\approx \\frac{\\epsilon\\left(|F(s_{k})| + |F(s_{k-1})|\\right)}{|F(s_{k}) - F(s_{k-1})|}.\n$$\nCatastrophic cancellation drives this relative error to $1$ when\n$$\n|F(s_{k}) - F(s_{k-1})| = \\epsilon\\left(|F(s_{k})| + |F(s_{k-1})|\\right).\n$$\nNear resonance $\\lambda = n\\pi + \\gamma$ with even $n$ and small nonzero $\\gamma$, we have $\\cos(\\lambda) = \\cos(\\gamma)$ and $\\sin(\\lambda) = \\sin(\\gamma)$. For small $|\\gamma|$, $\\cos(\\gamma) \\approx 1$ and $\\sin(\\gamma) \\approx \\gamma$, and $|\\lambda| \\approx n\\pi$. Moreover, the dominant magnitude of $F(s)$ is set by the common term $A \\cos(\\lambda) - B \\approx A - B$, since the slope-dependent term is small near resonance. Hence,\n$$\n|F(s_{k})| + |F(s_{k-1})| \\approx 2|A \\cos(\\lambda) - B| \\approx 2|A - B|.\n$$\nEquating the true difference to the worst-case rounding error gives\n$$\n\\frac{\\Delta s}{|\\lambda|} |\\sin(\\lambda)| \\approx \\epsilon \\cdot 2|A - B|.\n$$\nUsing $|\\lambda| \\approx n\\pi$ and $|\\sin(\\lambda)| \\approx |\\gamma|$ for even $n$,\n$$\n|\\gamma| \\approx \\frac{2 \\epsilon \\, n \\pi \\, |A - B|}{\\Delta s}.\n$$\nThis is the magnitude of the detuning $|\\lambda - n\\pi|$ at which the relative error of the computed difference in the secant step reaches $1$ under the stated worst-case rounding scenario.", "answer": "$$\\boxed{\\frac{2 \\epsilon \\, n \\pi \\, |A - B|}{\\Delta s}}$$", "id": "2158315"}]}