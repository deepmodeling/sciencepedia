{"hands_on_practices": [{"introduction": "Before we can use LU decomposition to solve complex problems, we must first understand the fundamental relationship between the matrices $A$, $L$, and $U$. This exercise provides direct practice in verifying the decomposition $A = LU$ by challenging you to determine the lower triangular matrix $L$ when given the original matrix $A$ and the upper triangular matrix $U$ [@problem_id:2204087]. Mastering this step is crucial for building a solid foundation in how LU factorization works at a mechanical level.", "problem": "In numerical linear algebra, the Lower-Upper (LU) decomposition of a square matrix $A$ is its factorization into a product $A = LU$, where $L$ is a lower triangular matrix and $U$ is an upper triangular matrix. For the Doolittle factorization, the matrix $L$ is further constrained to be a lower unit triangular matrix, meaning all the entries on its main diagonal are 1.\n\nConsider the matrix $A$ and its corresponding upper triangular factor $U$ from a Doolittle decomposition, given as:\n$$\nA = \\begin{pmatrix} 2 & 1 & -3 \\\\ 4 & 6 & -1 \\\\ -2 & 11 & 16 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 2 & 1 & -3 \\\\ 0 & 4 & 5 \\\\ 0 & 0 & -2 \\end{pmatrix}\n$$\n\nWhich of the following matrices represents the correct lower unit triangular matrix $L$ such that $A = LU$?\n\nA. $L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}$\n\nB. $L = \\begin{pmatrix} 1 & 0 & 0 \\\\ -2 & 1 & 0 \\\\ 1 & -3 & 1 \\end{pmatrix}$\n\nC. $L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 4 & 1 & 0 \\\\ -2 & 11 & 1 \\end{pmatrix}$\n\nD. $L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ 1 & 3 & 1 \\end{pmatrix}$\n\nE. $L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & -3 & 1 \\end{pmatrix}$", "solution": "For a Doolittle factorization, $L$ is lower unit triangular. Let\n$$\nL=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n\\ell_{21} & 1 & 0 \\\\\n\\ell_{31} & \\ell_{32} & 1\n\\end{pmatrix}, \\quad\nU=\\begin{pmatrix}\n2 & 1 & -3 \\\\\n0 & 4 & 5 \\\\\n0 & 0 & -2\n\\end{pmatrix}.\n$$\nWe impose $A=LU$ and determine $\\ell_{21}, \\ell_{31}, \\ell_{32}$ by equating $LU$ to $A$ entrywise.\n\nRow 1 of $LU$ is the first row of $U$, so\n$$\n[2,\\,1,\\,-3]=\\text{row}_{1}(A),\n$$\nwhich is satisfied automatically.\n\nRow 2 of $LU$ equals $\\ell_{21}\\,\\text{row}_{1}(U)+\\text{row}_{2}(U)$, hence\n$$\n[2\\ell_{21},\\,\\ell_{21}+4,\\,-3\\ell_{21}+5]=[4,\\,6,\\,-1].\n$$\nEquating components gives\n$$\n2\\ell_{21}=4 \\;\\Rightarrow\\; \\ell_{21}=2,\n$$\nand consistency checks $\\ell_{21}+4=6$ and $-3\\ell_{21}+5=-1$ hold with $\\ell_{21}=2$.\n\nRow 3 of $LU$ equals $\\ell_{31}\\,\\text{row}_{1}(U)+\\ell_{32}\\,\\text{row}_{2}(U)+\\text{row}_{3}(U)$, so\n$$\n[2\\ell_{31},\\,\\ell_{31}+4\\ell_{32},\\,-3\\ell_{31}+5\\ell_{32}-2]=[-2,\\,11,\\,16].\n$$\nEquating components yields\n$$\n2\\ell_{31}=-2 \\;\\Rightarrow\\; \\ell_{31}=-1,\n$$\n$$\n\\ell_{31}+4\\ell_{32}=11 \\;\\Rightarrow\\; -1+4\\ell_{32}=11 \\;\\Rightarrow\\; \\ell_{32}=3,\n$$\nand the third component checks:\n$$\n-3(-1)+5(3)-2=3+15-2=16.\n$$\n\nTherefore,\n$$\nL=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n-1 & 3 & 1\n\\end{pmatrix},\n$$\nwhich corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "2204087"}, {"introduction": "The primary motivation for computing an LU decomposition is to efficiently solve a system of linear equations $Ax=b$. This practice problem demonstrates the core application of the method, where the single difficult problem is replaced by two simple ones: solving $Ly=b$ via forward substitution and then $Ux=y$ via backward substitution [@problem_id:2204086]. By working through this process, you will see firsthand why factorization is a cornerstone of numerical linear algebra.", "problem": "A system of linear equations is given by the matrix equation $Ax=b$. The matrix $A$ has been factored into a product of a lower triangular matrix $L$ and an upper triangular matrix $U$, such that $A=LU$. This specific type of Lower-Upper (LU) factorization is one where the upper triangular matrix $U$ has ones on its main diagonal.\n\nGiven the matrices $L$, $U$, and the vector $b$ as follows:\n$$\nL = \\begin{pmatrix} 2 & 0 & 0 \\\\ -1 & 3 & 0 \\\\ 4 & -2 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 1 & 2 & -1 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad \\text{and} \\quad b = \\begin{pmatrix} -4 \\\\ 5 \\\\ -9 \\end{pmatrix}\n$$\nDetermine the solution vector $x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$.", "solution": "We are given $A=LU$ with $L$ lower triangular and $U$ upper triangular having ones on its main diagonal, and we must solve $Ax=b$. Define $y=Ux$. Then $Ly=b$ can be solved by forward substitution, followed by solving $Ux=y$ by back substitution.\n\nFirst solve $Ly=b$ with\n$$\nL=\\begin{pmatrix}2&0&0\\\\-1&3&0\\\\4&-2&1\\end{pmatrix},\\quad\ny=\\begin{pmatrix}y_{1}\\\\y_{2}\\\\y_{3}\\end{pmatrix},\\quad\nb=\\begin{pmatrix}-4\\\\5\\\\-9\\end{pmatrix}.\n$$\nWriting out the system:\n$$\n2y_{1}=-4,\\quad -y_{1}+3y_{2}=5,\\quad 4y_{1}-2y_{2}+y_{3}=-9.\n$$\nFrom the first equation,\n$$\ny_{1}=\\frac{-4}{2}=-2.\n$$\nSubstitute into the second equation:\n$$\n-(-2)+3y_{2}=5\\;\\Rightarrow\\;2+3y_{2}=5\\;\\Rightarrow\\;3y_{2}=3\\;\\Rightarrow\\;y_{2}=1.\n$$\nSubstitute $y_{1}$ and $y_{2}$ into the third equation:\n$$\n4(-2)-2(1)+y_{3}=-9\\;\\Rightarrow\\;-8-2+y_{3}=-9\\;\\Rightarrow\\;-10+y_{3}=-9\\;\\Rightarrow\\;y_{3}=1.\n$$\nHence,\n$$\ny=\\begin{pmatrix}-2\\\\1\\\\1\\end{pmatrix}.\n$$\n\nNext solve $Ux=y$ with\n$$\nU=\\begin{pmatrix}1&2&-1\\\\0&1&3\\\\0&0&1\\end{pmatrix},\\quad\nx=\\begin{pmatrix}x_{1}\\\\x_{2}\\\\x_{3}\\end{pmatrix},\\quad\ny=\\begin{pmatrix}-2\\\\1\\\\1\\end{pmatrix}.\n$$\nWriting out the system:\n$$\nx_{3}=1,\\quad x_{2}+3x_{3}=1,\\quad x_{1}+2x_{2}-x_{3}=-2.\n$$\nFrom the third row,\n$$\nx_{3}=1.\n$$\nFrom the second row,\n$$\nx_{2}+3(1)=1\\;\\Rightarrow\\;x_{2}=-2.\n$$\nFrom the first row,\n$$\nx_{1}+2(-2)-1=-2\\;\\Rightarrow\\;x_{1}-4-1=-2\\;\\Rightarrow\\;x_{1}-5=-2\\;\\Rightarrow\\;x_{1}=3.\n$$\nTherefore, the solution vector is $x=\\begin{pmatrix}3\\\\-2\\\\1\\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} 3 \\\\ -2 \\\\ 1 \\end{pmatrix}}$$", "id": "2204086"}, {"introduction": "While LU decomposition provides a powerful method for solving linear systems, computations in finite-precision arithmetic can lead to approximate, rather than exact, solutions. This exercise introduces iterative refinement, a technique to improve the accuracy of a computed solution by calculating a residual and solving for the error [@problem_id:2204084]. You will see how the already-computed $L$ and $U$ factors can be efficiently reused, demonstrating a key practical advantage of decomposition methods in numerical analysis.", "problem": "A numerical analyst is tasked with solving the linear system of equations $Ax = b$, where the matrix $A$ and vector $b$ are given by:\n$$\nA = \\begin{pmatrix} 4 & 2 & 1 \\\\ 8 & 6 & 4 \\\\ 4 & 4 & 5 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 3 \\\\ 6 \\end{pmatrix}\n$$\nThe analyst first computes the Lower-Upper (LU) decomposition of $A$, such that $A=LU$, and finds:\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ 1 & 1 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 4 & 2 & 1 \\\\ 0 & 2 & 2 \\\\ 0 & 0 & 2 \\end{pmatrix}\n$$\nUsing these factors, an initial solution $\\tilde{x}^{(0)}$ is computed. However, due to the limitations of finite-precision arithmetic, this solution is only an approximation:\n$$\n\\tilde{x}^{(0)} = \\begin{pmatrix} 0.51 \\\\ -1.55 \\\\ 2.02 \\end{pmatrix}\n$$\nTo improve the accuracy, perform exactly one step of iterative refinement to compute the new approximate solution $\\tilde{x}^{(1)}$. Provide the three components of the refined solution vector $\\tilde{x}^{(1)} = (x^{(1)}_1, x^{(1)}_2, x^{(1)}_3)^T$. Round each component to four significant figures.", "solution": "The principle of iterative refinement is to compute the error in the current approximate solution and add it as a correction. Let $\\tilde{x}^{(0)}$ be the initial approximate solution. The true solution $x$ can be written as $x = \\tilde{x}^{(0)} + e$, where $e$ is the error vector. Substituting this into the original equation $Ax=b$ gives $A(\\tilde{x}^{(0)} + e) = b$, which rearranges to $Ae = b - A\\tilde{x}^{(0)}$. The term $r = b - A\\tilde{x}^{(0)}$ is called the residual vector. The iterative refinement process consists of three main steps:\n\n1.  Calculate the residual $r$.\n2.  Solve the linear system $Ae = r$ for the error vector $e$.\n3.  Update the solution: $\\tilde{x}^{(1)} = \\tilde{x}^{(0)} + e$.\n\n**Step 1: Calculate the residual**\nFirst, we compute the product $A\\tilde{x}^{(0)}$:\n$$\nA\\tilde{x}^{(0)} = \\begin{pmatrix} 4 & 2 & 1 \\\\ 8 & 6 & 4 \\\\ 4 & 4 & 5 \\end{pmatrix} \\begin{pmatrix} 0.51 \\\\ -1.55 \\\\ 2.02 \\end{pmatrix}\n= \\begin{pmatrix} 4(0.51) + 2(-1.55) + 1(2.02) \\\\ 8(0.51) + 6(-1.55) + 4(2.02) \\\\ 4(0.51) + 4(-1.55) + 5(2.02) \\end{pmatrix}\n= \\begin{pmatrix} 2.04 - 3.10 + 2.02 \\\\ 4.08 - 9.30 + 8.08 \\\\ 2.04 - 6.20 + 10.10 \\end{pmatrix}\n= \\begin{pmatrix} 0.96 \\\\ 2.86 \\\\ 5.94 \\end{pmatrix}\n$$\nNow, we calculate the residual $r = b - A\\tilde{x}^{(0)}$:\n$$\nr = \\begin{pmatrix} 1 \\\\ 3 \\\\ 6 \\end{pmatrix} - \\begin{pmatrix} 0.96 \\\\ 2.86 \\\\ 5.94 \\end{pmatrix} = \\begin{pmatrix} 0.04 \\\\ 0.14 \\\\ 0.06 \\end{pmatrix}\n$$\n\n**Step 2: Solve for the error vector**\nWe need to solve the system $Ae=r$. Since the LU decomposition of $A$ is already provided ($A=LU$), we can solve this efficiently without re-inverting $A$. We solve $LUe=r$ by first solving $Ly=r$ for $y$ (forward substitution) and then solving $Ue=y$ for $e$ (backward substitution).\n\nFirst, solve $Ly=r$:\n$$\n\\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ 1 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} = \\begin{pmatrix} 0.04 \\\\ 0.14 \\\\ 0.06 \\end{pmatrix}\n$$\nFrom the first row: $y_1 = 0.04$.\nFrom the second row: $2y_1 + y_2 = 0.14 \\implies y_2 = 0.14 - 2(0.04) = 0.14 - 0.08 = 0.06$.\nFrom the third row: $y_1 + y_2 + y_3 = 0.06 \\implies y_3 = 0.06 - y_1 - y_2 = 0.06 - 0.04 - 0.06 = -0.04$.\nSo, the intermediate vector is $y = \\begin{pmatrix} 0.04 \\\\ 0.06 \\\\ -0.04 \\end{pmatrix}$.\n\nNext, solve $Ue=y$:\n$$\n\\begin{pmatrix} 4 & 2 & 1 \\\\ 0 & 2 & 2 \\\\ 0 & 0 & 2 \\end{pmatrix} \\begin{pmatrix} e_1 \\\\ e_2 \\\\ e_3 \\end{pmatrix} = \\begin{pmatrix} 0.04 \\\\ 0.06 \\\\ -0.04 \\end{pmatrix}\n$$\nFrom the third row (backward): $2e_3 = -0.04 \\implies e_3 = -0.02$.\nFrom the second row: $2e_2 + 2e_3 = 0.06 \\implies 2e_2 = 0.06 - 2(-0.02) = 0.06 + 0.04 = 0.10 \\implies e_2 = 0.05$.\nFrom the first row: $4e_1 + 2e_2 + e_3 = 0.04 \\implies 4e_1 = 0.04 - 2(0.05) - (-0.02) = 0.04 - 0.10 + 0.02 = -0.04 \\implies e_1 = -0.01$.\nThe error vector is $e = \\begin{pmatrix} -0.01 \\\\ 0.05 \\\\ -0.02 \\end{pmatrix}$.\n\n**Step 3: Update the solution**\nThe refined solution $\\tilde{x}^{(1)}$ is the sum of the initial solution and the error vector:\n$$\n\\tilde{x}^{(1)} = \\tilde{x}^{(0)} + e = \\begin{pmatrix} 0.51 \\\\ -1.55 \\\\ 2.02 \\end{pmatrix} + \\begin{pmatrix} -0.01 \\\\ 0.05 \\\\ -0.02 \\end{pmatrix} = \\begin{pmatrix} 0.51 - 0.01 \\\\ -1.55 + 0.05 \\\\ 2.02 - 0.02 \\end{pmatrix} = \\begin{pmatrix} 0.50 \\\\ -1.50 \\\\ 2.00 \\end{pmatrix}\n$$\nThe problem requires each component to be rounded to four significant figures.\nThe first component is $0.50$, which is $0.5000$ to four significant figures.\nThe second component is $-1.50$, which is $-1.500$ to four significant figures.\nThe third component is $2.00$, which is $2.000$ to four significant figures.\nThus, the refined solution vector is $\\tilde{x}^{(1)} = (0.5000, -1.500, 2.000)^T$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.5000 \\\\ -1.500 \\\\ 2.000 \\end{pmatrix}}$$", "id": "2204084"}]}