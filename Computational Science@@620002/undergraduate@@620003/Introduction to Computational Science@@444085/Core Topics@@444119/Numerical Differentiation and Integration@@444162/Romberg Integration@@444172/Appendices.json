{"hands_on_practices": [{"introduction": "To truly understand Romberg integration, it is best to start by building the Romberg tableau by hand. This exercise guides you through the fundamental steps of the process, from calculating initial estimates with the trapezoidal rule to applying the first level of Richardson extrapolation. By manually computing the first few entries for a simple polynomial, you will gain a concrete feel for how the algorithm systematically refines its approximations. [@problem_id:2198730]", "problem": "Romberg integration is a numerical method used to estimate the definite integral of a function by applying Richardson extrapolation to the results from the trapezoidal rule. The estimates are organized in a triangular array called the Romberg tableau, denoted by $R_{k,j}$. The first column, $R_{k,1}$ (for $k \\geq 1$), is generated using the composite trapezoidal rule with $n = 2^{k-1}$ subintervals. Subsequent entries are computed using the recursive formula:\n$$R_{k,j} = R_{k,j-1} + \\frac{1}{4^{j-1} - 1}(R_{k,j-1} - R_{k-1,j-1}) \\quad \\text{for } k \\geq j \\geq 2.$$\n\nConsider the definite integral of a polynomial function $f(x) = 4x^3 - 3x^2 + 5$ over the interval $[0, 2]$. Your task is to manually compute the first three entries of the Romberg tableau for this integral.\n\nCalculate the values of $R_{1,1}$, $R_{2,1}$, and $R_{2,2}$. Provide your answer as a row vector of the three numerical values $(R_{1,1}, R_{2,1}, R_{2,2})$ expressed as exact integers.", "solution": "We integrate $f(x)=4x^{3}-3x^{2}+5$ over $[a,b]=[0,2]$. The composite trapezoidal rule with $n$ subintervals of width $h=\\frac{b-a}{n}$ is\n$$\nT_{n}=\\frac{h}{2}\\left(f(a)+2\\sum_{i=1}^{n-1}f(a+ih)+f(b)\\right).\n$$\nBy definition, $R_{k,1}=T_{2^{\\,k-1}}$.\n\nFor $R_{1,1}$, take $n=1$ so $h=2$. Evaluate $f(0)=5$ and $f(2)=4\\cdot 2^{3}-3\\cdot 2^{2}+5=32-12+5=25$. Then\n$$\nR_{1,1}=T_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\cdot(5+25)=30.\n$$\n\nFor $R_{2,1}$, take $n=2$ so $h=1$ with nodes $0,1,2$. Compute $f(1)=4-3+5=6$. Then\n$$\nR_{2,1}=T_{2}=\\frac{1}{2}\\left(f(0)+2f(1)+f(2)\\right)=\\frac{1}{2}\\left(5+2\\cdot 6+25\\right)=\\frac{42}{2}=21.\n$$\n\nRomberg extrapolation uses\n$$\nR_{k,j}=R_{k,j-1}+\\frac{1}{4^{\\,j-1}-1}\\left(R_{k,j-1}-R_{k-1,j-1}\\right), \\quad k\\geq j\\geq 2.\n$$\nThus,\n$$\nR_{2,2}=R_{2,1}+\\frac{1}{4^{1}-1}\\left(R_{2,1}-R_{1,1}\\right)=21+\\frac{1}{3}(21-30)=21-\\frac{9}{3}=18.\n$$\n\nAs a consistency check, the exact integral is\n$$\n\\int_{0}^{2}\\left(4x^{3}-3x^{2}+5\\right)\\,dx=\\left(x^{4}-x^{3}+5x\\right)\\bigg|_{0}^{2}=16-8+10=18,\n$$\nagreeing with $R_{2,2}$ as expected for a cubic.", "answer": "$$\\boxed{\\begin{pmatrix}30 & 21 & 18\\end{pmatrix}}$$", "id": "2198730"}, {"introduction": "The power of Romberg integration lies in its rapid convergence to a highly accurate solution. This practice demonstrates this power by applying the method to a cubic polynomial, a case where the second-level Romberg estimate, $R_{2,2}$, yields a special result. Performing this calculation reveals an important connection between Romberg integration and another classic numerical method, Simpson's rule, showcasing how extrapolation eliminates lower-order error terms. [@problem_id:2198741]", "problem": "Romberg integration is an algorithm used to estimate the definite integral $I = \\int_{a}^{b} f(x) \\, dx$. The method generates a triangular array of estimates, denoted by $R_{k,j}$, where $k$ is the row index and $j$ is the column index, with $k \\ge 1$ and $j \\ge 1$. The process begins with initial estimates using the composite trapezoidal rule. The first column of the Romberg table, $R_{k,1}$, corresponds to the composite trapezoidal rule with $n=2^{k-1}$ subintervals. For $k \\ge 2$, subsequent, more accurate estimates are generated using the Richardson extrapolation formula:\n\n$$R_{k,j} = R_{k, j-1} + \\frac{R_{k,j-1} - R_{k-1, j-1}}{4^{j-1} - 1} \\quad \\text{for } j \\ge 2$$\n\nConsider the definite integral of the function $f(x) = x^3$ over the interval $[1, 3]$. Your task is to compute the Romberg integration estimate $R_{2,2}$ for this integral. Report your final answer as a real number.", "solution": "We apply Romberg integration, where the first column $R_{k,1}$ consists of composite trapezoidal rule estimates with $n=2^{k-1}$ subintervals on $[a,b]=[1,3]$ for $f(x)=x^{3}$. The composite trapezoidal rule with $n$ subintervals and step size $h=\\frac{b-a}{n}$ is\n$$\nT_{n}=h\\left(\\frac{1}{2}f(a)+\\sum_{i=1}^{n-1}f(a+ih)+\\frac{1}{2}f(b)\\right).\n$$\nFor $k=1$, we have $n=2^{0}=1$, so $h=\\frac{3-1}{1}=2$, and\n$$\nR_{1,1}=T_{1}=2\\left(\\frac{f(1)+f(3)}{2}\\right)=2\\left(\\frac{1^{3}+3^{3}}{2}\\right)=2\\left(\\frac{1+27}{2}\\right)=28.\n$$\nFor $k=2$, we have $n=2^{1}=2$, so $h=\\frac{3-1}{2}=1$, and\n$$\nR_{2,1}=T_{2}=1\\left(\\frac{1}{2}f(1)+f(2)+\\frac{1}{2}f(3)\\right)=\\frac{1}{2}\\cdot 1^{3}+2^{3}+\\frac{1}{2}\\cdot 3^{3}=\\frac{1}{2}+8+\\frac{27}{2}=22.\n$$\nRomberg extrapolation uses\n$$\nR_{k,j}=R_{k,j-1}+\\frac{R_{k,j-1}-R_{k-1,j-1}}{4^{j-1}-1}, \\quad j\\ge 2.\n$$\nFor $k=2$, $j=2$,\n$$\nR_{2,2}=R_{2,1}+\\frac{R_{2,1}-R_{1,1}}{4^{1}-1}=22+\\frac{22-28}{3}=22-\\frac{6}{3}=20.\n$$\nThus, the Romberg estimate $R_{2,2}$ equals $20$, which coincides with the exact integral $\\int_{1}^{3}x^{3}\\,dx=\\left.\\frac{x^{4}}{4}\\right|_{1}^{3}=\\frac{81-1}{4}=20$.", "answer": "$$\\boxed{20}$$", "id": "2198741"}, {"introduction": "A key aspect of mastering any numerical method is understanding its limitations. Romberg integration relies on the assumption that the function being integrated is sufficiently smooth, which allows for a specific error structure that extrapolation can exploit. This problem challenges you to analyze a case where this assumption is violated, using the function $f(x) = |x|$ with its sharp \"kink\" at the origin, and to reason about why the method fails to converge as expected. [@problem_id:2435348]", "problem": "Consider applying Romberg integration (successive Richardson extrapolation built on the composite trapezoidal rule with step sizes $h, h/2, h/4, \\ldots$) to evaluate the definite integral $\\int_{-1}^{1} |x| \\, dx$. The composite trapezoidal rule on a uniform grid of $N$ subintervals has step size $h = \\frac{2}{N}$. Your task is to reason, starting from the differentiability properties of the integrand and the structure of the composite trapezoidal rule, about whether and why Romberg integration does or does not accelerate convergence for this integral.\n\nWhich statement best explains the behavior?\n\nA. The integrand $|x|$ is not differentiable at $x=0$, so the even-power error expansion assumed by Romberg does not hold. For the composite trapezoidal rule, the global error is parity-dependent: it is $E_N = \\frac{h^2}{4}$ when $N$ is odd (the kink lies strictly inside one panel) and $E_N = 0$ when $N$ is even (the kink coincides with a node and each panel sees a linear function). Because the leading error coefficient is not a fixed constant across refinements, the first Richardson extrapolation from $h$ to $h/2$ can produce a value far from the exact integral.\n\nB. Romberg integration fails because the integral is improper and diverges at $x=0$, so no quadrature rule can be meaningfully applied.\n\nC. Romberg integration fails because $|x|$ is an odd function over symmetric limits, and cancellation near $x=0$ invalidates the extrapolation process.\n\nD. Romberg integration would succeed if the initial step size $h$ were made sufficiently small; the cusp at $x=0$ effectively disappears for small enough $h$, restoring the smooth even-power error expansion that Romberg requires.\n\nE. Romberg integration fails because the composite trapezoidal rule is only first-order accurate globally, and an even-power Richardson extrapolation is therefore inapplicable regardless of smoothness considerations.", "solution": "The problem requires an analysis of the performance of Romberg integration for the definite integral $I = \\int_{-1}^{1} |x| \\, dx$. The core of the analysis rests on the theoretical foundation of Romberg integration and the properties of the integrand $f(x) = |x|$.\n\nFirst, we establish the exact value of the integral. The integrand $f(x) = |x|$ is an even function, so the integral over the symmetric interval $[-1, 1]$ can be calculated as:\n$$ I = \\int_{-1}^{1} |x| \\, dx = 2 \\int_{0}^{1} x \\, dx = 2 \\left[ \\frac{x^2}{2} \\right]_{0}^{1} = 2 \\left( \\frac{1^2}{2} - \\frac{0^2}{2} \\right) = 1 $$\nThe exact value of the integral is $1$.\n\nNext, we analyze the basis of Romberg integration. Romberg integration is a method that uses Richardson extrapolation to accelerate the convergence of the composite trapezoidal rule. The composite trapezoidal rule approximation $T(h)$ for an integral $I$, with step size $h$, has an asymptotic error expansion given by the Euler-Maclaurin formula:\n$$ T(h) = I + C_1 h^2 + C_2 h^4 + C_3 h^6 + \\dots $$\nThis expansion is valid provided the integrand $f(x)$ is sufficiently smooth (i.e., has a sufficient number of continuous derivatives) on the integration interval $[a, b]$. Specifically, for the expansion to contain only even powers of $h$, the integrand and all its odd-order derivatives must vanish at the endpoints $a$ and $b$, or the function must be periodic with period $b-a$. For a general non-periodic function, the expansion is $T(h) = I + C_1 h^2 + C_2 h^4 + \\dots + K_p h^{2p} + O(h^{2p+2})$, which requires the integrand to be at least in the class $C^{2p+2}[a, b]$.\n\nThe integrand in this problem is $f(x) = |x|$. This function is continuous everywhere. However, its first derivative is the signum function, $f'(x) = \\text{sgn}(x)$, which has a jump discontinuity at $x=0$.\n$$ f'(x) = \\begin{cases} -1 & x < 0 \\\\ 1 & x > 0 \\end{cases} $$\nSince $f'(x)$ is not continuous at $x=0$, the function $f(x)=|x|$ is not in the class $C^1[-1, 1]$. Consequently, it is also not in $C^2[-1, 1]$. The fundamental smoothness requirement for the standard Euler-Maclaurin error expansion is violated. The error of the composite trapezoidal rule will not have the form with only even powers of $h$, and therefore, the premise for Romberg integration is invalid.\n\nWe must now analyze the specific behavior of the composite trapezoidal rule for this particular integrand. The rule is applied on a uniform grid of $N$ subintervals over $[-1, 1]$, with step size $h = \\frac{2}{N}$ and nodes $x_k = -1 + k h$ for $k=0, 1, \\dots, N$. The behavior depends critically on whether the point of non-differentiability, $x=0$, is a grid node.\n\nCase 1: $N$ is an even number.\nLet $N=2m$ for some integer $m \\ge 1$. The step size is $h = \\frac{2}{2m} = \\frac{1}{m}$. The grid nodes are $x_k = -1 + \\frac{k}{m}$. The node corresponding to $k=m$ is $x_m = -1 + \\frac{m}{m} = 0$. Thus, when $N$ is even, the point of non-differentiability $x=0$ is always a grid node. The composite trapezoidal rule sums the results over each subinterval. In the subintervals within $[-1, 0]$, the integrand is $f(x)=-x$, a linear function. In the subintervals within $[0, 1]$, the integrand is $f(x)=x$, also a linear function. The trapezoidal rule is exact for linear functions (its error term involves the second derivative of the integrand, which is zero for a linear function). Therefore, the approximation is exact for every subinterval, and the total computed integral is exact. The error $E_N = T_N - I = 0$ when $N$ is even.\n\nCase 2: $N$ is an odd number.\nLet $N=2m+1$ for some integer $m \\ge 0$. The step size is $h = \\frac{2}{2m+1}$. The grid nodes are $x_k = -1 + k \\frac{2}{2m+1}$. For $x_k=0$, we would need $-1 + k \\frac{2}{2m+1} = 0$, which implies $k = \\frac{2m+1}{2}$. This is never an integer. Thus, when $N$ is odd, the point $x=0$ always falls strictly inside one of the subintervals. This subinterval is $[x_m, x_{m+1}]$, where $x_m = -1 + m h = \\frac{-(2m+1)+2m}{2m+1} = \\frac{-1}{2m+1}$ and $x_{m+1} = -1 + (m+1)h = \\frac{-(2m+1)+2m+2}{2m+1} = \\frac{1}{2m+1}$. Notice that this interval is symmetric around $0$ and has length $h$. The error for the composite trapezoidal rule comes exclusively from this single subinterval, as the integrand is linear on all other subintervals.\nThe trapezoidal approximation for this subinterval is:\n$$ T_{[x_m, x_{m+1}]} = \\frac{h}{2} (f(x_m) + f(x_{m+1})) = \\frac{h}{2} \\left(\\left|\\frac{-1}{2m+1}\\right| + \\left|\\frac{1}{2m+1}\\right|\\right) = \\frac{h}{2} \\left(\\frac{1}{2m+1} + \\frac{1}{2m+1}\\right) = \\frac{h}{2} \\left(\\frac{2}{2m+1}\\right) = \\frac{h^2}{2} $$\nThe exact integral over this subinterval is:\n$$ I_{[x_m, x_{m+1}]} = \\int_{-1/(2m+1)}^{1/(2m+1)} |x|\\, dx = 2 \\int_0^{1/(2m+1)} x\\, dx = \\left[x^2\\right]_0^{1/(2m+1)} = \\left(\\frac{1}{2m+1}\\right)^2 = \\left(\\frac{h}{2}\\right)^2 = \\frac{h^2}{4} $$\nThe error for this subinterval, which is the total error $E_N$, is $E_N = T_{[x_m, x_{m+1}]} - I_{[x_m, x_{m+1}]} = \\frac{h^2}{2} - \\frac{h^2}{4} = \\frac{h^2}{4}$. When $N$ is odd, $E_N = \\frac{h^2}{4} \\ne 0$.\n\nThe Richardson extrapolation formula $R_{k,1} = \\frac{4R_{k,0} - R_{k-1,0}}{3}$ assumes that the error $E(h) = C h^2 + O(h^4)$ with a constant $C$. Our analysis shows the error sequence is $E_N=h^2/4$ for odd $N$ and $E_N=0$ for even $N$. As the step size is halved ($h \\to h/2$), the number of intervals is doubled ($N \\to 2N$), which changes the parity of $N$ if $N$ is odd. This means the \"constant\" $C$ in the error term is not constant but alternates. This invalidates the extrapolation. For example, if we start with an odd $N_0$ (error $\\sim h_0^2/4$) and go to $N_1=2N_0$ (error is $0$), extrapolation will produce a poor result.\n\nNow, we evaluate each option.\n\nA. The integrand $|x|$ is not differentiable at $x=0$, so the even-power error expansion assumed by Romberg does not hold. For the composite trapezoidal rule, the global error is parity-dependent: it is $E_N = \\frac{h^2}{4}$ when $N$ is odd (the kink lies strictly inside one panel) and $E_N = 0$ when $N$ is even (the kink coincides with a node and each panel sees a linear function). Because the leading error coefficient is not a fixed constant across refinements, the first Richardson extrapolation from $h$ to $h/2$ can produce a value far from the exact integral.\nThis statement is a perfect summary of our derivation. Every claim made is correct: the non-differentiability, the failure of the error expansion, the parity-dependent error of the trapezoidal rule ($E_N=h^2/4$ for odd $N$, $E_N=0$ for even $N$), the non-constant error coefficient, and the resulting failure of extrapolation.\nVerdict: **Correct**.\n\nB. Romberg integration fails because the integral is improper and diverges at $x=0$, so no quadrature rule can be meaningfully applied.\nThe integral $\\int_{-1}^{1} |x| \\, dx$ is a proper integral. The integrand $|x|$ is continuous and bounded on the finite interval $[-1, 1]$. The integral converges to $1$. The statement is factually false.\nVerdict: **Incorrect**.\n\nC. Romberg integration fails because $|x|$ is an odd function over symmetric limits, and cancellation near $x=0$ invalidates the extrapolation process.\nThe function $f(x)=|x|$ is an even function, because $f(-x) = |-x| = |x| = f(x)$. The premise of the statement is false.\nVerdict: **Incorrect**.\n\nD. Romberg integration would succeed if the initial step size $h$ were made sufficiently small; the cusp at $x=0$ effectively disappears for small enough $h$, restoring the smooth even-power error expansion that Romberg requires.\nThe non-differentiability at $x=0$ is an intrinsic property of the function $|x|$. It does not disappear at any scale. Reducing the step size $h$ does not make the function smoother or restore the required error expansion. The parity-dependent error behavior persists regardless of the scale of $h$.\nVerdict: **Incorrect**.\n\nE. Romberg integration fails because the composite trapezoidal rule is only first-order accurate globally, and an even-power Richardson extrapolation is therefore inapplicable regardless of smoothness considerations.\nThe composite trapezoidal rule is second-order accurate ($O(h^2)$) for sufficiently smooth ($C^2$) functions, not first-order. The failure of Romberg integration in this case is precisely due to smoothness considerations, which this statement dismisses. The premise of the statement is incorrect.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2435348"}]}