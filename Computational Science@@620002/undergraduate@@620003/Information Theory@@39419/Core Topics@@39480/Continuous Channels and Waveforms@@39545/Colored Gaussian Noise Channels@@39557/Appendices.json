{"hands_on_practices": [{"introduction": "Understanding the theory of water-filling is one thing, but seeing its practical benefit is another. This first exercise provides a direct, quantitative comparison between a simple, intuitive power allocation strategy and the optimal water-filling method. By working through a scenario with two parallel channels of differing quality [@problem_id:1611663], you will calculate the tangible improvement in channel capacity, cementing your understanding of why optimizing power distribution is crucial for efficient communication.", "problem": "An advanced communication system utilizes two parallel, independent frequency bands for data transmission. Each band can be modeled as an Additive White Gaussian Noise (AWGN) channel. The noise powers in the two channels are different: the first channel has a noise power of $N_1 = 1.00$ arbitrary units, while the second, more corrupted channel, has a noise power of $N_2 = 100.0$ arbitrary units. The total power available for transmission across both channels is constrained to $P = 199.0$ units.\n\nThe capacity $C_i$ of an individual channel $i$ with signal power $S_i$ and noise power $N_i$ is given by the formula $C_i = \\frac{1}{2} \\log_2(1 + \\frac{S_i}{N_i})$. The total capacity of the system is the sum of the individual capacities, $C_{total} = C_1 + C_2$.\n\nAn engineer is comparing two power allocation strategies:\n1.  **Simple Allocation**: All available power $P$ is allocated to the channel with the lower noise power.\n2.  **Optimal Allocation**: The total power $P$ is distributed between the two channels in a way that maximizes the total capacity $C_{total}$.\n\nCalculate the fractional improvement in capacity achieved by the Optimal Allocation strategy compared to the Simple Allocation strategy. The fractional improvement is defined as $\\frac{C_{optimal} - C_{simple}}{C_{simple}}$. Provide your answer as a decimal rounded to three significant figures.", "solution": "The two channels are parallel AWGN links with individual capacities given by $C_{i} = \\frac{1}{2}\\log_2\\left(1 + \\frac{S_{i}}{N_{i}}\\right)$ and total capacity $C_{total} = C_{1} + C_{2}$.\n\nSimple Allocation: All power goes to the lower-noise channel (channel 1), so $S_{1} = P$ and $S_{2} = 0$. The total capacity is\n$$\nC_{\\text{simple}} = \\frac{1}{2}\\log_2\\left(1 + \\frac{P}{N_{1}}\\right) = \\frac{1}{2}\\log_2(1 + 199) = \\frac{1}{2}\\log_2(200).\n$$\n\nOptimal Allocation: Maximize $\\sum_{i=1}^{2}\\frac{1}{2}\\log_2\\left(1 + \\frac{S_{i}}{N_{i}}\\right)$ subject to $S_{i} \\geq 0$ and $S_{1} + S_{2} = P$. By the water-filling/KKT condition, for active channels $N_{i} + S_{i} = \\lambda$ for some water level $\\lambda$, so $S_{i} = \\lambda - N_{i}$ if $\\lambda > N_{i}$ and $S_{i} = 0$ otherwise. With $N_{1} = 1$, $N_{2} = 100$, and $P = 199$, both channels are active, and\n$$\n(\\lambda - N_{1}) + (\\lambda - N_{2}) = P \\quad \\Rightarrow \\quad 2\\lambda - (N_{1} + N_{2}) = P \\quad \\Rightarrow \\quad \\lambda = \\frac{P + N_{1} + N_{2}}{2} = \\frac{199 + 1 + 100}{2} = 150.\n$$\nThus $S_{1}^{*} = 150 - 1 = 149$ and $S_{2}^{*} = 150 - 100 = 50$. The optimal total capacity is\n$$\nC_{\\text{optimal}} = \\frac{1}{2}\\left[\\log_2\\left(1 + \\frac{149}{1}\\right) + \\log_2\\left(1 + \\frac{50}{100}\\right)\\right] = \\frac{1}{2}\\left[\\log_2(150) + \\log_2(1.5)\\right] = \\frac{1}{2}\\log_2(225).\n$$\n\nThe fractional improvement is\n$$\n\\frac{C_{\\text{optimal}} - C_{\\text{simple}}}{C_{\\text{simple}}}\n= \\frac{\\frac{1}{2}\\log_2(225) - \\frac{1}{2}\\log_2(200)}{\\frac{1}{2}\\log_2(200)}\n= \\frac{\\log_2\\left(\\frac{225}{200}\\right)}{\\log_2(200)}\n= \\frac{\\log_2\\left(\\frac{9}{8}\\right)}{\\log_2(200)}.\n$$\nNumerically, this evaluates to approximately $0.0222$ when rounded to three significant figures.", "answer": "$$\\boxed{0.0222}$$", "id": "1611663"}, {"introduction": "Building on the discrete channel model, we now turn our attention to a continuous frequency spectrum, a more realistic model for many communication systems. This problem explores a special but important case of colored noise: a channel with a \"dead zone\" where noise is prohibitively high [@problem_id:1611653]. This scenario forces us to confront a key tenet of the water-filling principle: sometimes the best investment is no investment at all. You will determine the capacity by strategically allocating power only to the usable portions of the band.", "problem": "Consider a continuous-time communication channel that is strictly band-limited to the frequency range $[-W, W]$. The channel is subject to additive Gaussian noise. The noise is \"colored,\" meaning its Power Spectral Density (PSD), denoted as $N(f)$, is not constant across all frequencies. Specifically, the two-sided noise PSD is given by:\n\n$$\nN(f) = \\begin{cases}\n    \\infty & \\text{for } |f| \\le f_0 \\\\\n    N_0 & \\text{for } f_0 < |f| \\le W \\\\\n    0 & \\text{for } |f| > W\n\\end{cases}\n$$\n\nHere, $W$, $f_0$, and $N_0$ are positive constants, with $f_0 < W$. This describes a scenario where a specific central portion of the channel's bandwidth is rendered unusable due to extremely high interference.\n\nThe average total transmit power is constrained to be no more than $P$. Assuming an optimal power allocation strategy is used, determine the capacity $C$ of this channel. Express your answer as a single closed-form analytic expression in terms of $P$, $N_0$, $W$, and $f_0$. The capacity should be in bits per second, which implies the use of the base-2 logarithm.", "solution": "We model the strictly band-limited real Gaussian channel with unity gain over the band $[-W,W]$ and two-sided noise PSD $N(f)$ as given. For a continuous-time real Gaussian channel with two-sided PSDs, the capacity in bits per second under an input PSD $S(f)$ is\n$$\nC=\\frac{1}{2}\\int_{-W}^{W}\\log_2\\left(1+\\frac{S(f)}{N(f)}\\right)\\,df,\n$$\nsubject to the average power constraint\n$$\n\\int_{-W}^{W}S(f)\\,df\\le P,\\quad S(f)\\ge 0.\n$$\n\nThe optimal $S(f)$ is obtained by water-filling:\n$$\nS(f)=\\left[\\lambda - N(f)\\right]_{+},\n$$\nfor some water level $\\lambda\\ge 0$ chosen to satisfy the power constraint with equality when $P>0$.\n\nGiven the PSD\n$$\nN(f)=\\begin{cases}\n\\infty & \\text{for } |f|\\le f_{0},\\\\\nN_{0} & \\text{for } f_{0}<|f|\\le W,\\\\\n0 & \\text{for } |f|>W,\n\\end{cases}\n$$\nwe have $S(f)=0$ on $|f|\\le f_{0}$ because $N(f)=\\infty$, so those frequencies are unusable. On the usable subbands $f_{0}<|f|\\le W$, the noise PSD is flat, $N(f)=N_{0}$, so water-filling yields a flat input PSD there:\n$$\nS(f)=\\lambda - N_{0}\\quad \\text{for } f_{0}<|f|\\le W,\n$$\nprovided $\\lambda>N_{0}$ (which holds for $P>0$). The total measure of the usable subbands is $2(W-f_{0})$, so the power constraint gives\n$$\nP=\\int_{-W}^{W}S(f)\\,df=2(W-f_{0})\\left(\\lambda - N_{0}\\right),\n$$\nhence\n$$\n\\lambda = N_{0}+\\frac{P}{2(W-f_{0})}.\n$$\n\nThe capacity integral reduces to the usable subbands, where $S(f)$ and $N(f)$ are constant:\n$$\nC=\\frac{1}{2}\\int_{|f|\\in(f_{0},W]}\\log_2\\left(1+\\frac{S(f)}{N(f)}\\right)\\,df\n=\\frac{1}{2}\\cdot 2(W-f_{0})\\cdot \\log_2\\left(1+\\frac{\\lambda - N_{0}}{N_{0}}\\right).\n$$\nUsing $\\lambda/N_{0}=1+\\frac{P}{2N_{0}(W-f_{0})}$, we obtain\n$$\nC=(W-f_{0})\\log_2\\left(1+\\frac{P}{2N_{0}(W-f_{0})}\\right).\n$$\n\nThis expression is valid for $P\\ge 0$, yields $C=0$ when $P=0$, and reduces to the standard flat-noise result when $f_{0}=0$.", "answer": "$$\\boxed{(W - f_{0}) \\log_2\\left(1 + \\frac{P}{2 N_{0} (W - f_{0})}\\right)}$$", "id": "1611653"}, {"introduction": "Noise coloration is not just a phenomenon of the frequency domain; it can also manifest as correlation in the time domain. This practice shifts our perspective to a discrete-time channel where the noise at one moment depends on the past [@problem_id:1611660]. Here, we introduce a powerful and elegant technique known as \"noise whitening,\" which uses a filter to transform the complex, colored-noise channel into an equivalent, much simpler, Additive White Gaussian Noise (AWGN) channel. This exercise demonstrates the versatility of information-theoretic tools in tackling different types of channel impairments.", "problem": "Consider a discrete-time communication channel used in a modern wireless system that experiences temporal correlation in its noise. The channel can be modeled by the equation:\n$$\nY_i = X_i + Z_i\n$$\nwhere $i$ is the time index, $X_i$ is the real-valued channel input, and $Y_i$ is the real-valued channel output. The input signal is subject to an average power constraint, given by:\n$$\n\\lim_{N\\to\\infty} \\frac{1}{N} \\sum_{i=1}^{N} E[X_i^2] \\le P\n$$\nwhere $P$ is a positive constant representing the maximum average input power.\n\nThe additive noise, $Z_i$, is a stationary colored Gaussian process. It is described by a first-order autoregressive (AR(1)) model:\n$$\nZ_i = \\alpha Z_{i-1} + W_i\n$$\nHere, $\\alpha$ is a real constant such that $0 \\le |\\alpha| < 1$, which characterizes the memory of the noise process. The term $W_i$ represents a sequence of independent and identically distributed (i.i.d.) Gaussian random variables with a mean of zero and a variance of $\\sigma_W^2$.\n\nDetermine the capacity, $C$, of this channel in bits per channel use. Express your answer as a single, closed-form analytic expression in terms of $P$, $\\sigma_W^2$, and $\\alpha$. Your expression should use the base-2 logarithm.", "solution": "We are given a discrete-time additive Gaussian noise channel\n$$\nY_{i}=X_{i}+Z_{i},\n$$\nwith an average input power constraint\n$$\n\\lim_{N\\to\\infty}\\frac{1}{N}\\sum_{i=1}^{N}E[X_{i}^{2}]\\leq P,\n$$\nand a stationary colored Gaussian noise process $Z_{i}$ that follows the AR(1) model\n$$\nZ_{i}=\\alpha Z_{i-1}+W_{i},\n$$\nwhere $W_{i}$ are i.i.d. Gaussian with mean zero and variance $\\sigma_{W}^{2}$, and $0\\leq|\\alpha|<1$.\n\nStep 1: Noise whitening via an invertible linear time-invariant transformation on the output. Consider the stable, causal, and invertible LTI filter with transfer function $F(z)=1-\\alpha z^{-1}$ (stability and invertibility hold for $|\\alpha|<1$). Apply this filter to the entire output sequence $\\{Y_{i}\\}$ to produce\n$$\nY'_{i}=Y_{i}-\\alpha Y_{i-1}=(X_{i}-\\alpha X_{i-1})+(Z_{i}-\\alpha Z_{i-1}).\n$$\nUsing the AR(1) recursion, we have $Z_{i}-\\alpha Z_{i-1}=W_{i}$, so the transformed channel is\n$$\nY'_{i}=(X_{i}-\\alpha X_{i-1})+W_{i}.\n$$\nBecause $F(z)$ is invertible, this is a one-to-one transformation of the output sequence, which leaves the mutual information rate and thus the capacity unchanged by the data-processing inequality applied to invertible transformations.\n\nStep 2: Equivalent AWGN representation by input shaping. Define the auxiliary sequence\n$$\nU_{i}\\triangleq X_{i}-\\alpha X_{i-1}.\n$$\nThen the transformed channel is a memoryless AWGN channel\n$$\nY'_{i}=U_{i}+W_{i},\n$$\nwith white Gaussian noise $W_{i}\\sim\\mathcal{N}(0,\\sigma_{W}^{2})$.\n\nWe now construct inputs $X_{i}$ by passing an i.i.d. Gaussian driving process $\\{U_{i}\\}$ through the stable causal filter\n$$\nG(z)=\\frac{1}{1-\\alpha z^{-1}},\n$$\nwhich satisfies the first-order recursion $X_{i}=\\alpha X_{i-1}+U_{i}$ so that $U_{i}=X_{i}-\\alpha X_{i-1}$ holds exactly. If $U_{i}\\sim\\mathcal{N}(0,S)$ i.i.d., then $\\{X_{i}\\}$ is a stationary Gaussian process with average power given by the H2-norm of $G$:\n$$\nE[X_{i}^{2}]=S\\sum_{k=0}^{\\infty}\\alpha^{2k}=S\\frac{1}{1-\\alpha^{2}},\n$$\nsince the impulse response of $G$ is $\\{1,\\alpha,\\alpha^{2},\\dots\\}$ and $|\\alpha|<1$. The input power constraint thus imposes\n$$\nS\\frac{1}{1-\\alpha^{2}}\\le P\\quad\\Longleftrightarrow\\quad S\\le P(1-\\alpha^{2}).\n$$\n\nStep 3: Capacity computation for the equivalent AWGN channel. For the AWGN channel $Y'_{i}=U_{i}+W_{i}$ with input power $S$ and noise variance $\\sigma_{W}^{2}$, the capacity per channel use is\n$$\n\\frac{1}{2}\\log_2\\!\\left(1+\\frac{S}{\\sigma_{W}^{2}}\\right),\n$$\nachieved by i.i.d. Gaussian $U_{i}$. Subject to the constraint $S\\le P(1-\\alpha^{2})$, the mutual information is maximized by choosing $S^{\\star}=P(1-\\alpha^{2})$. Therefore, the channel capacity in bits per channel use is\n$$\nC=\\frac{1}{2}\\log_2\\!\\left(1+\\frac{P(1-\\alpha^{2})}{\\sigma_{W}^{2}}\\right).\n$$\n\nThis expression is a single, closed-form analytic function of $P$, $\\sigma_{W}^{2}$, and $\\alpha$, using the base-2 logarithm, as required.", "answer": "$$\\boxed{\\frac{1}{2}\\log_2\\!\\left(1+\\frac{P\\left(1-\\alpha^{2}\\right)}{\\sigma_{W}^{2}}\\right)}$$", "id": "1611660"}]}