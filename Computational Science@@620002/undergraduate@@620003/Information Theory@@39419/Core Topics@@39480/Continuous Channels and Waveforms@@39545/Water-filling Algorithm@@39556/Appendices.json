{"hands_on_practices": [{"introduction": "To begin our hands-on exploration of the water-filling algorithm, we start with a fundamental scenario involving two parallel channels with different noise levels. This first practice is designed to build your intuition by working through the core mechanics of optimal power allocation. By determining how to distribute a fixed power budget across these channels, you will directly apply the principle of assigning more resources to the \"cleaner\" channel to maximize the total data throughput.", "problem": "A wireless communication system operates over two distinct, non-interfering frequency bands. Each band can be modeled as a parallel Additive White Gaussian Noise (AWGN) channel, where AWGN refers to a channel model in which the only impairment is a linear addition of wideband or white noise with a constant spectral density and a Gaussian distribution of amplitude. For the purposes of this problem, assume the channel power gain for both bands is unity.\n\nThe noise power in the first frequency band is characterized by a variance of $\\sigma_1^2 = 1.0$ arbitrary units, while the noise power variance in the second band is $\\sigma_2^2 = 3.0$ arbitrary units. The transmitter has a total power budget of $P = 4.0$ arbitrary units that can be distributed between the two bands.\n\nTo achieve the maximum possible total information-theoretic capacity across both channels, an optimal power allocation strategy must be employed. Determine the optimal power $P_1$ to be allocated to the first channel and the optimal power $P_2$ to be allocated to the second channel.\n\nProvide your answer as a pair of numerical values $(P_1, P_2)$ in arbitrary units.", "solution": "We model the two bands as parallel AWGN channels with unit gains and noise variances $\\sigma_{1}^{2}$ and $\\sigma_{2}^{2}$. Let $P_{1}$ and $P_{2}$ be the powers allocated to channels $1$ and $2$, with $P_{1} \\ge 0$, $P_{2} \\ge 0$, and $P_{1} + P_{2} = P$.\n\nThe total capacity (per channel use) is proportional to\n$$\nC(P_{1},P_{2}) \\propto \\ln\\!\\left(1 + \\frac{P_{1}}{\\sigma_{1}^{2}}\\right) + \\ln\\!\\left(1 + \\frac{P_{2}}{\\sigma_{2}^{2}}\\right),\n$$\nwhere the use of $\\ln$ (natural logarithm) is without loss of generality because any positive multiplicative or monotonic transformation does not change the maximizer under the same constraint.\n\nForm the Lagrangian for maximizing $C$ subject to $P_{1} + P_{2} = P$ and $P_{i} \\ge 0$:\n$$\n\\mathcal{L} = \\sum_{i=1}^{2} \\ln\\!\\left(1 + \\frac{P_{i}}{\\sigma_{i}^{2}}\\right) - \\lambda\\left(P_{1} + P_{2} - P\\right) - \\sum_{i=1}^{2} \\nu_{i} P_{i},\n$$\nwith $\\lambda$ the multiplier for the equality constraint and $\\nu_{i} \\ge 0$ for the nonnegativity constraints.\n\nThe Karush-Kuhn-Tucker (KKT) stationarity condition for any $i$ with $P_{i}  0$ (hence $\\nu_{i} = 0$) gives\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial P_{i}} = \\frac{1}{\\sigma_{i}^{2} + P_{i}} - \\lambda = 0\n\\;\\;\\Rightarrow\\;\\;\nP_{i} = \\frac{1}{\\lambda} - \\sigma_{i}^{2}.\n$$\nImposing $P_{i} \\ge 0$ yields the water-filling solution\n$$\nP_{i} = \\max\\!\\left(0,\\, \\mu - \\sigma_{i}^{2}\\right), \\quad \\text{where } \\mu \\equiv \\frac{1}{\\lambda},\n$$\nwith $\\mu$ chosen to satisfy the total power constraint\n$$\n\\sum_{i=1}^{2} \\max\\!\\left(0,\\, \\mu - \\sigma_{i}^{2}\\right) = P.\n$$\n\nSubstitute the given values $\\sigma_{1}^{2} = 1$, $\\sigma_{2}^{2} = 3$, and $P = 4$. Check whether both channels are active. If $\\mu \\le 3$, then $P_{2} = 0$ and $P_{1} = \\mu - 1$. Enforcing $P_{1} = 4$ would require $\\mu = 5$, which contradicts $\\mu \\le 3$. Therefore $\\mu  3$, so both channels are active and\n$$\n(\\mu - 1) + (\\mu - 3) = 4\n\\;\\;\\Rightarrow\\;\\;\n2\\mu - 4 = 4\n\\;\\;\\Rightarrow\\;\\;\n\\mu = 4.\n$$\nHence\n$$\nP_{1} = \\mu - \\sigma_{1}^{2} = 4 - 1 = 3,\n\\qquad\nP_{2} = \\mu - \\sigma_{2}^{2} = 4 - 3 = 1,\n$$\nwhich satisfy $P_{1} + P_{2} = 4$ and $P_{i} \\ge 0$ and therefore solve the optimal allocation problem.", "answer": "$$\\boxed{\\begin{pmatrix}3  1\\end{pmatrix}}$$", "id": "1668042"}, {"introduction": "Moving beyond a simple allocation problem, this exercise challenges you to think about the dynamics of the water-filling process. Instead of starting with a given power budget, you will determine the precise amount of total power needed to activate a specific channel. This practice illuminates the concept of the \"water level\" $\\mu$ and how it must rise to overcome the noise floor of progressively weaker channels, offering a deeper insight into the algorithm's sequential nature.", "problem": "A communication system operates over three parallel independent Additive White Gaussian Noise (AWGN) channels. The noise power in each channel is constant and known. Let the noise powers for the three channels be $\\sigma_1^2 = 2$, $\\sigma_2^2 = 5$, and $\\sigma_3^2 = 10$, in arbitrary units. A total transmission power $P$ is available to be distributed among these three channels. The power allocation is performed optimally to maximize the total sum-rate capacity across the parallel channels.\n\nDetermine the exact value of the total power $P$ at the critical point where the second channel (the one with noise power $\\sigma_2^2 = 5$) just begins to receive a non-zero power allocation.", "solution": "The problem of maximizing the sum-rate capacity over parallel Gaussian channels subject to a total power constraint is a classic optimization problem solved by the water-filling algorithm.\n\nThe capacity of an individual AWGN channel $i$ with allocated power $P_i$ and noise variance $\\sigma_i^2$ is given by the Shannon-Hartley theorem, $C_i = B \\log_2(1 + \\frac{P_i}{B N_i})$, where $B$ is the bandwidth and $N_i$ is the noise power spectral density. Assuming a normalized bandwidth, the capacity expression can be written as $C_i \\propto \\log_2(1 + \\frac{P_i}{\\sigma_i^2})$, where $\\sigma_i^2$ is the noise power. The goal is to maximize the total capacity $C = \\sum_{i=1}^{3} C_i$ subject to the total power constraint $\\sum_{i=1}^{3} P_i = P$.\n\nThe water-filling algorithm provides the optimal power allocation. The intuition is that we should allocate more power to \"better\" channels, i.e., those with less noise. This is visualized as pouring a total amount of \"water\" (power) $P$ into a vessel whose bottom has varying depths corresponding to the noise levels $\\sigma_i^2$.\n\nThe power allocated to channel $i$, $P_i$, is given by the formula:\n$$P_i = \\max(0, \\mu - \\sigma_i^2)$$\nwhere $\\mu$ is the \"water level\" determined by the total power $P$. The water level $\\mu$ is a constant across all channels and is chosen such that the total power constraint is met:\n$$P = \\sum_{i=1}^{3} \\max(0, \\mu - \\sigma_i^2)$$\n\nThe problem asks for the specific value of total power $P$ at which the second channel just begins to receive a non-zero power allocation. The channels are ordered by their noise power: $\\sigma_1^2 = 2  \\sigma_2^2 = 5  \\sigma_3^2 = 10$.\n\nThe water-filling procedure allocates power to the channel with the lowest noise first (channel 1). As total power $P$ increases, the water level $\\mu$ rises.\n- If $\\mu  \\sigma_1^2$, no channel receives power.\n- If $\\sigma_1^2  \\mu  \\sigma_2^2$, only channel 1 receives power.\n- The second channel (with noise power $\\sigma_2^2$) will begin to receive a non-zero power allocation at the exact moment the water level $\\mu$ reaches its noise floor $\\sigma_2^2$.\n\nSo, the critical point is defined by the condition $\\mu = \\sigma_2^2$.\n\nAt this water level, we can calculate the power allocated to each of the three channels:\n1.  For channel 1 (noise $\\sigma_1^2 = 2$):\n    $P_1 = \\max(0, \\mu - \\sigma_1^2) = \\max(0, \\sigma_2^2 - \\sigma_1^2) = \\max(0, 5 - 2) = 3$.\n    Since $\\sigma_2^2 > \\sigma_1^2$, channel 1 receives positive power.\n\n2.  For channel 2 (noise $\\sigma_2^2 = 5$):\n    $P_2 = \\max(0, \\mu - \\sigma_2^2) = \\max(0, \\sigma_2^2 - \\sigma_2^2) = \\max(0, 0) = 0$.\n    This is consistent with the condition that it \"just begins\" to receive power. Any infinitesimal increase in total power would raise $\\mu$ above $\\sigma_2^2$, making $P_2 > 0$.\n\n3.  For channel 3 (noise $\\sigma_3^2 = 10$):\n    $P_3 = \\max(0, \\mu - \\sigma_3^2) = \\max(0, \\sigma_2^2 - \\sigma_3^2) = \\max(0, 5 - 10) = \\max(0, -5) = 0$.\n    Since $\\sigma_2^2  \\sigma_3^2$, channel 3 receives no power.\n\nThe total power $P$ at this critical point is the sum of the powers allocated to all channels:\n$$P = P_1 + P_2 + P_3$$\n$$P = 3 + 0 + 0 = 3$$\n\nThus, a total power of $P=3$ is required to raise the water level exactly to the noise floor of the second channel.", "answer": "$$\\boxed{3}$$", "id": "1668056"}, {"introduction": "Our final practice problem integrates the concepts we've explored into a more complex and realistic scenario with four channels. Here, you will not only determine the optimal power allocation but also discover that it can be optimal to leave some of the noisiest channels unused. This exercise solidifies your understanding by taking you through the complete process from applying the water-filling algorithm to calculating the final, maximized system capacity.", "problem": "Consider a simplified model of a communication system employing parallel channels, which is a foundational concept in technologies like Orthogonal Frequency-Division Multiplexing (OFDM). The system is comprised of four independent parallel Additive White Gaussian Noise (AWGN) channels. The noise power, represented by the variance $\\sigma_i^2$, for each of the four channels is given as $\\sigma_1^2 = 1.0$, $\\sigma_2^2 = 2.0$, $\\sigma_3^2 = 4.0$, and $\\sigma_4^2 = 8.0$, all in standardized power units.\n\nA total transmission power budget of $P_{total} = 10.0$ units is available to be distributed among these four channels. To maximize the overall data rate, the power is allocated according to the water-filling algorithm.\n\nThe capacity $C_i$ of an individual channel $i$ with allocated power $P_i$ and noise power $\\sigma_i^2$ is governed by the formula $C_i = \\log_2(1 + P_i / \\sigma_i^2)$. The unit for capacity is bits per channel use.\n\nCalculate the total capacity of the system, $C_{total} = \\sum_{i=1}^4 C_i$. Express your final answer in bits per channel use, rounded to four significant figures.", "solution": "We must maximize the sum capacity over four independent AWGN subchannels with noise variances $\\sigma_{1}^{2}=1$, $\\sigma_{2}^{2}=2$, $\\sigma_{3}^{2}=4$, $\\sigma_{4}^{2}=8$, subject to the total power constraint $\\sum_{i=1}^{4}P_{i}=P_{\\text{total}}=10$ and $P_{i}\\geq 0$. The per-channel capacity is $C_{i}=\\log_{2}\\!\\left(1+\\frac{P_{i}}{\\sigma_{i}^{2}}\\right)$, so the optimization problem is\n$$\n\\max_{P_{i}\\geq 0,\\ \\sum P_{i}=10}\\ \\sum_{i=1}^{4}\\log_{2}\\!\\left(1+\\frac{P_{i}}{\\sigma_{i}^{2}}\\right).\n$$\nUsing the Karush-Kuhn-Tucker (KKT) conditions for this concave optimization, the optimal allocation is given by the water-filling rule\n$$\nP_{i}=\\max\\{0,\\ \\lambda-\\sigma_{i}^{2}\\},\n$$\nwhere the water level $\\lambda$ is chosen to satisfy $\\sum_{i=1}^{4}P_{i}=10$.\n\nOrder the noise variances as $1,2,4,8$. First test the hypothesis that all four channels are active, which requires $\\lambda8$. Then\n$$\n\\sum_{i=1}^{4}P_{i}=\\sum_{i=1}^{4}(\\lambda-\\sigma_{i}^{2})=4\\lambda-(1+2+4+8)=4\\lambda-15=10,\n$$\nwhich gives $\\lambda=\\frac{25}{4}=6.25$, contradicting $\\lambda8$. Hence not all four are active.\n\nNext test three active channels (the first three), which requires $4\\lambda\\leq 8$. Then\n$$\n\\sum_{i=1}^{3}P_{i}=3\\lambda-(1+2+4)=3\\lambda-7=10 \\quad\\Rightarrow\\quad \\lambda=\\frac{17}{3}.\n$$\nSince $\\frac{17}{3}\\in(4,8]$, this is consistent. Therefore, the optimal powers are\n$$\nP_{1}=\\frac{17}{3}-1=\\frac{14}{3},\\quad P_{2}=\\frac{17}{3}-2=\\frac{11}{3},\\quad P_{3}=\\frac{17}{3}-4=\\frac{5}{3},\\quad P_{4}=0,\n$$\nand indeed $\\frac{14}{3}+\\frac{11}{3}+\\frac{5}{3}=10$.\n\nFor active channels, note that\n$$\n1+\\frac{P_{i}}{\\sigma_{i}^{2}}=1+\\frac{\\lambda-\\sigma_{i}^{2}}{\\sigma_{i}^{2}}=\\frac{\\lambda}{\\sigma_{i}^{2}}.\n$$\nThus the individual capacities are\n$$\nC_{1}=\\log_{2}\\!\\left(\\frac{\\lambda}{\\sigma_{1}^{2}}\\right)=\\log_{2}\\!\\left(\\frac{17}{3}\\right),\\quad\nC_{2}=\\log_{2}\\!\\left(\\frac{\\lambda}{\\sigma_{2}^{2}}\\right)=\\log_{2}\\!\\left(\\frac{17}{6}\\right),\\quad\nC_{3}=\\log_{2}\\!\\left(\\frac{\\lambda}{\\sigma_{3}^{2}}\\right)=\\log_{2}\\!\\left(\\frac{17}{12}\\right),\\quad\nC_{4}=0,\n$$\nand the total capacity is\n$$\nC_{\\text{total}}=\\log_{2}\\!\\left(\\frac{17}{3}\\right)+\\log_{2}\\!\\left(\\frac{17}{6}\\right)+\\log_{2}\\!\\left(\\frac{17}{12}\\right)\n=\\log_{2}\\!\\left(\\frac{17^{3}}{3\\cdot 6\\cdot 12}\\right)\n=\\log_{2}\\!\\left(\\frac{4913}{216}\\right).\n$$\nNumerically, \n$$\nC_{\\text{total}}=\\log_{2}\\!\\left(\\frac{4913}{216}\\right)\\approx 4.507501\\ \\text{bits per channel use},\n$$\nwhich rounded to four significant figures is $4.508$.", "answer": "$$\\boxed{4.508}$$", "id": "1668060"}]}