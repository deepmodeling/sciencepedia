{"hands_on_practices": [{"introduction": "Before we can find the 'best' path through a trellis, we must first learn how to measure the 'goodness' of any single path. The path metric, often calculated as the cumulative Hamming distance between the expected and received sequences, serves as this fundamental measure. This exercise [@problem_id:1645324] provides a direct, hands-on opportunity to master this core calculation for a given path, which is the essential building block for the Viterbi decoding algorithm.", "problem": "A digital communication system uses a rate $R=1/2$, memory $m=2$ convolutional encoder. The encoder has one input stream, $u_k$, and two output streams, $v_k^{(1)}$ and $v_k^{(2)}$, at each time step $k$. The connections are defined by the generator equations:\n$$v_k^{(1)} = u_k \\oplus u_{k-1} \\oplus u_{k-2}$$\n$$v_k^{(2)} = u_k \\oplus u_{k-2}$$\nwhere $\\oplus$ represents addition modulo 2 (the XOR operation). The state of the encoder is defined by the two previous input bits, $(u_{k-1}, u_{k-2})$. The encoder is initialized in the all-zero state, meaning $u_0=0$ and $u_{-1}=0$ before the first input bit $u_1$ arrives.\n\nAn information sequence of three bits is encoded and transmitted. Due to noise in the channel, the received sequence of output pairs is $r$ is `(10, 10, 01)`.\n\nThe performance of the decoder is evaluated using a path metric, which is defined as the cumulative Hamming distance between the received sequence of pairs and the sequence of pairs generated by a specific path in the encoder's trellis diagram.\n\nCalculate the path metric for the specific path through the trellis that corresponds to the input information sequence `101`.", "solution": "The convolutional encoder has memory $m=2$ and generator equations\n$$v_{k}^{(1)}=u_{k}\\oplus u_{k-1}\\oplus u_{k-2},\\qquad v_{k}^{(2)}=u_{k}\\oplus u_{k-2}.$$\nThe state is initialized with $u_{0}=0$ and $u_{-1}=0$. The input sequence corresponding to the specified path is $u_{1}u_{2}u_{3}=1\\,0\\,1$. The received output pairs are $r_{1}=(1,0)$, $r_{2}=(1,0)$, and $r_{3}=(0,1)$.\n\nCompute the encoder outputs for each $k$:\n- At $k=1$, $(u_{1},u_{0},u_{-1})=(1,0,0)$, hence\n$$v_{1}^{(1)}=1\\oplus 0\\oplus 0=1,\\qquad v_{1}^{(2)}=1\\oplus 0=1,$$\nso the transmitted pair is $(1,1)$. The Hamming distance to $r_{1}=(1,0)$ is $1$.\n\n- At $k=2$, $(u_{2},u_{1},u_{0})=(0,1,0)$, hence\n$$v_{2}^{(1)}=0\\oplus 1\\oplus 0=1,\\qquad v_{2}^{(2)}=0\\oplus 0=0,$$\nso the transmitted pair is $(1,0)$. The Hamming distance to $r_{2}=(1,0)$ is $0$.\n\n- At $k=3$, $(u_{3},u_{2},u_{1})=(1,0,1)$, hence\n$$v_{3}^{(1)}=1\\oplus 0\\oplus 1=0,\\qquad v_{3}^{(2)}=1\\oplus 1=0,$$\nso the transmitted pair is $(0,0)$. The Hamming distance to $r_{3}=(0,1)$ is $1$.\n\nThe path metric, defined as the cumulative Hamming distance over the three time steps, is\n$$1+0+1=2.$$", "answer": "$$\\boxed{2}$$", "id": "1645324"}, {"introduction": "The Viterbi algorithm efficiently finds the most likely sequence by making optimal decisions at each step. At the heart of this process is the \"add-compare-select\" operation, where paths merging at a state are compared, and only the one with the best metric—the 'survivor path'—is kept for future consideration. In this practice [@problem_id:1645347], you will manually trace these decisions to determine a survivor path, gaining a practical understanding of how the algorithm prunes suboptimal paths.", "problem": "A rate $R=1/2$ convolutional encoder is defined by a single memory bit, resulting in two possible states: state $s_0$ (memory value of 0) and state $s_1$ (memory value of 1). The encoder accepts one input bit and produces a two-bit output at each time step. The state transitions and corresponding outputs are determined as follows:\n\n*   From state $s_0$: an input bit of `0` produces the output `00` and the next state is $s_0$; an input bit of `1` produces the output `11` and the next state is $s_1$.\n*   From state $s_1$: an input bit of `0` produces the output `10` and the next state is $s_0$; an input bit of `1` produces the output `01` and the next state is $s_1$.\n\nThe encoder is known to start in state $s_0$ at time $t=0$. An information sequence is encoded and transmitted. Over a noisy channel, the received sequence for the first three time steps (from $t=1$ to $t=3$) is observed as $y = (y_1, y_2, y_3)$ is `(01, 11, 01)`.\n\nTo decode the sequence, the Viterbi algorithm is used. The distance between a received two-bit block and a possible output block is measured by the Hamming distance, which serves as the branch metric. The path metric for any given path through the trellis is the sum of the branch metrics along that path. A \"survivor path\" for a given state at a specific time is the path from the starting state to that state which has the minimum possible path metric.\n\nDetermine the survivor path leading to state $s_1$ at time $t=3$. A path is represented as an ordered sequence of $(S_0, S_1, S_2, S_3)$, where $S_t$ is the state at time $t$.\n\nA. $(s_0, s_0, s_1, s_1)$\n\nB. $(s_0, s_1, s_0, s_1)$\n\nC. $(s_0, s_1, s_0, s_0)$\n\nD. $(s_0, s_0, s_0, s_0)$\n\nE. $(s_0, s_1, s_1, s_1)$", "solution": "We model the Viterbi decoding with branch metric equal to the Hamming distance between a received two-bit block and a candidate encoder output, and path metric as the sum of branch metrics along a path. Let $d_{H}(\\cdot,\\cdot)$ denote the Hamming distance on two-bit blocks. The encoder starts in $s_{0}$ at $t=0$, so $M_{0}(s_{0})=0$ and $M_{0}(s_{1})=\\infty$. The received sequence is $y_{1}=01$, $y_{2}=11$, $y_{3}=01$.\n\nAt $t=1$ with $y_{1}=01$:\n- Transitions from $s_{0}$: $s_{0}\\xrightarrow{0,\\,00}s_{0}$ with $d_{H}(00,01)=1$; $s_{0}\\xrightarrow{1,\\,11}s_{1}$ with $d_{H}(11,01)=1$.\n- Transitions from $s_{1}$: $s_{1}\\xrightarrow{0,\\,10}s_{0}$ with $d_{H}(10,01)=2$; $s_{1}\\xrightarrow{1,\\,01}s_{1}$ with $d_{H}(01,01)=0$.\n\nPath metrics:\n$$\nM_{1}(s_{0})=\\min\\{M_{0}(s_{0})+1,\\;M_{0}(s_{1})+2\\}=\\min\\{0+1,\\;\\infty\\}=1,\n$$\n$$\nM_{1}(s_{1})=\\min\\{M_{0}(s_{0})+1,\\;M_{0}(s_{1})+0\\}=\\min\\{0+1,\\;\\infty\\}=1.\n$$\nSurvivors: $s_{0}$ at $t=1$ comes from $s_{0}$; $s_{1}$ at $t=1$ comes from $s_{0}$.\n\nAt $t=2$ with $y_{2}=11$:\n- From $s_{0}$: $s_{0}\\xrightarrow{0,\\,00}s_{0}$ with $d_{H}(00,11)=2$; $s_{0}\\xrightarrow{1,\\,11}s_{1}$ with $d_{H}(11,11)=0$.\n- From $s_{1}$: $s_{1}\\xrightarrow{0,\\,10}s_{0}$ with $d_{H}(10,11)=1$; $s_{1}\\xrightarrow{1,\\,01}s_{1}$ with $d_{H}(01,11)=1$.\n\nPath metrics:\n$$\nM_{2}(s_{0})=\\min\\{M_{1}(s_{0})+2,\\;M_{1}(s_{1})+1\\}=\\min\\{1+2,\\;1+1\\}=2,\n$$\n$$\nM_{2}(s_{1})=\\min\\{M_{1}(s_{0})+0,\\;M_{1}(s_{1})+1\\}=\\min\\{1+0,\\;1+1\\}=1.\n$$\nSurvivors: $s_{0}$ at $t=2$ comes from $s_{1}$; $s_{1}$ at $t=2$ comes from $s_{0}$.\n\nAt $t=3$ with $y_{3}=01$:\n- From $s_{0}$: $s_{0}\\xrightarrow{0,\\,00}s_{0}$ with $d_{H}(00,01)=1$; $s_{0}\\xrightarrow{1,\\,11}s_{1}$ with $d_{H}(11,01)=1$.\n- From $s_{1}$: $s_{1}\\xrightarrow{0,\\,10}s_{0}$ with $d_{H}(10,01)=2$; $s_{1}\\xrightarrow{1,\\,01}s_{1}$ with $d_{H}(01,01)=0$.\n\nPath metric to $s_{1}$:\n$$\nM_{3}(s_{1})=\\min\\{M_{2}(s_{0})+1,\\;M_{2}(s_{1})+0\\}=\\min\\{2+1,\\;1+0\\}=1,\n$$\nso the survivor to $s_{1}$ at $t=3$ comes from $s_{1}$ at $t=2$.\n\nBacktracking the survivor path to $s_{1}$ at $t=3$: $S_{3}=s_{1}$, $S_{2}=s_{1}$ (from $t=3$ survivor), $S_{1}=s_{0}$ (since $s_{1}$ at $t=2$ came from $s_{0}$), and $S_{0}=s_{0}$ (initial state). Therefore, the survivor path is $(s_{0}, s_{0}, s_{1}, s_{1})$, which corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1645347"}, {"introduction": "Why is it so crucial to always select the path with the minimum metric? This insightful thought experiment [@problem_id:1645362] allows you to probe the logic of the Viterbi algorithm by deliberately violating its core rule at a single point. By tracing the consequences of an intentionally suboptimal choice, you will develop a deeper intuition for the principle of optimality, which guarantees that the Viterbi algorithm successfully finds the single best path through the entire trellis.", "problem": "Consider a rate $1/2$ convolutional encoder with constraint length $K=2$. The encoder has a single bit of memory, representing its state, which can be either $S_0=0$ or $S_1=1$. The encoder's operation is defined by the generator polynomials $g^{(1)} = (1, 1)$ and $g^{(2)} = (0, 1)$. This means that for an input bit $u_i$ at time $i$, and with the previous input bit (the state) being $u_{i-1}$, the two output bits $v_i^{(1)}$ and $v_i^{(2)}$ are generated by the equations $v_i^{(1)} = u_i \\oplus u_{i-1}$ and $v_i^{(2)} = u_{i-1}$, where $\\oplus$ denotes addition modulo 2. The encoder is initialized in state $S_0=0$ at time $t=0$.\n\nA sequence of bits is encoded and transmitted over a noisy channel. The received sequence of bit pairs for three time steps is $r$ is `(11, 01, 10)`.\n\nYou are to analyze the Viterbi decoding process with a specific modification. The path metric used for decoding is the cumulative Hamming distance between the expected codeword bits for a path and the received bits.\n\nFollow the Viterbi algorithm for time steps $t=1$ and $t=2$. At time $t=2$, when calculating the path metric for state $S_0$, there will be two incoming paths to consider. For this problem only, you must artificially select the path with the *larger* path metric as the survivor path for state $S_0$. For state $S_1$ at $t=2$, you should perform the normal Viterbi selection (choosing the path with the smaller metric).\n\nUsing this modified set of survivor paths and their corresponding path metrics from $t=2$, proceed to calculate the path metrics for both states, $S_0$ and $S_1$, at time $t=3$ by applying the standard Viterbi update rule (add-compare-select, always choosing the minimum metric).\n\nWhat are the resulting path metrics for states $S_0$ and $S_1$ at time $t=3$? Present your answer as a row matrix containing the two path metrics in the order $[PM_3(S_0), PM_3(S_1)]$.", "solution": "The encoder has memory one, with state at time $i$ given by $s_{i}=u_{i-1}\\in\\{0,1\\}$. For input $u_{i}$ and previous state $s_{i}$, the outputs are\n$$\nv_{i}^{(1)}=u_{i}\\oplus s_{i},\\quad v_{i}^{(2)}=s_{i},\n$$\nand the next state is $s_{i+1}=u_{i}$. Thus the possible branches and their outputs are:\n- From $S_{0}$ with $u=0$: next $S_{0}$, output $(0,0)$.\n- From $S_{0}$ with $u=1$: next $S_{1}$, output $(1,0)$.\n- From $S_{1}$ with $u=0$: next $S_{0}$, output $(1,1)$.\n- From $S_{1}$ with $u=1$: next $S_{1}$, output $(0,1)$.\n\nThe path metric is the cumulative Hamming distance between expected outputs and received pairs. Initialize\n$$\nPM_{0}(S_{0})=0,\\quad PM_{0}(S_{1})=\\infty.\n$$\n\nAt $t=1$, received $r_{1}=(1,1)$:\n- From $S_{0}\\to S_{0}$ via $(0,0)$: branch metric $d_{H}((0,0),(1,1))=2$, so $PM_{1}(S_{0})=0+2=2$.\n- From $S_{0}\\to S_{1}$ via $(1,0)$: branch metric $d_{H}((1,0),(1,1))=1$, so $PM_{1}(S_{1})=0+1=1$.\n\nAt $t=2$, received $r_{2}=(0,1)$:\n- To $S_{0}$: two incoming paths\n  - $S_{0}\\to S_{0}$ via $(0,0)$: branch metric $d_{H}((0,0),(0,1))=1$, candidate metric $2+1=3$.\n  - $S_{1}\\to S_{0}$ via $(1,1)$: branch metric $d_{H}((1,1),(0,1))=1$, candidate metric $1+1=2$.\n  By the problem’s instruction, select the larger metric as survivor for $S_{0}$, hence\n  $$\n  PM_{2}(S_{0})=3\\quad\\text{(survivor via }S_{0}\\to S_{0}\\text{)}.\n  $$\n- To $S_{1}$: two incoming paths\n  - $S_{0}\\to S_{1}$ via $(1,0)$: branch metric $d_{H}((1,0),(0,1))=2$, candidate metric $2+2=4$.\n  - $S_{1}\\to S_{1}$ via $(0,1)$: branch metric $d_{H}((0,1),(0,1))=0$, candidate metric $1+0=1$.\n  Apply standard selection (minimum), hence\n  $$\n  PM_{2}(S_{1})=1\\quad\\text{(survivor via }S_{1}\\to S_{1}\\text{)}.\n  $$\n\nAt $t=3$, received $r_{3}=(1,0)$, use the modified survivors and metrics from $t=2$ and apply standard add-compare-select:\n- To $S_{0}$:\n  - From $S_{0}$ via $(0,0)$: branch metric $d_{H}((0,0),(1,0))=1$, candidate $3+1=4$.\n  - From $S_{1}$ via $(1,1)$: branch metric $d_{H}((1,1),(1,0))=1$, candidate $1+1=2$.\n  Select minimum, so $PM_{3}(S_{0})=2$.\n- To $S_{1}$:\n  - From $S_{0}$ via $(1,0)$: branch metric $d_{H}((1,0),(1,0))=0$, candidate $3+0=3$.\n  - From $S_{1}$ via $(0,1)$: branch metric $d_{H}((0,1),(1,0))=2$, candidate $1+2=3$.\n  Select minimum (tie), so $PM_{3}(S_{1})=3$.\n\nTherefore, the path metrics at $t=3$ are $[PM_{3}(S_{0}),\\,PM_{3}(S_{1})]=[2,\\,3]$.", "answer": "$$\\boxed{\\begin{pmatrix}2 & 3\\end{pmatrix}}$$", "id": "1645362"}]}