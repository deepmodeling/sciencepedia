{"hands_on_practices": [{"introduction": "To truly grasp the concept of perfect secrecy, we must move beyond the abstract definition and apply it to a concrete system. This first exercise provides a small-scale, hypothetical encryption scheme. Your task is to act as a cryptanalyst and rigorously check if the system achieves perfect secrecy by directly applying its mathematical definition: $P(M=m | C=c) = P(M=m)$. This practice will solidify your understanding of how posterior probabilities are calculated and why even a single instance of information leakage is enough to disqualify a system from having perfect secrecy [@problem_id:1657890].", "problem": "A minimalist secure messaging system is designed to transmit one of two critical commands: 'HOLD' or 'PROCEED'. The system's specifications are as follows:\n\n- The message space is $\\mathcal{M} = \\{m_0, m_1\\}$, where $m_0$ represents 'HOLD' and $m_1$ represents 'PROCEED'.\n- Due to operational context, the prior probability of sending 'HOLD' is $P(M=m_0) = \\frac{1}{3}$, and the probability of sending 'PROCEED' is $P(M=m_1) = \\frac{2}{3}$.\n- The key space is $\\mathcal{K} = \\{k_A, k_B\\}$. A key is chosen uniformly at random for each transmission, meaning $P(K=k_A) = P(K=k_B) = \\frac{1}{2}$. The choice of key is independent of the choice of message.\n- The ciphertext is generated according to the following encryption table, where the rows represent the key, the columns represent the plaintext message, and the cells contain the resulting ciphertext from the space $\\mathcal{C} = \\{c_X, c_Y, c_Z\\}$.\n\n| $E(k,m)$      | $m_0$ ('HOLD') | $m_1$ ('PROCEED') |\n| :-----------: | :------------: | :---------------: |\n| $\\mathbf{k_A}$| $c_X$          | $c_Y$             |\n| $\\mathbf{k_B}$| $c_Y$          | $c_Z$             |\n\nAn encryption system is said to have perfect secrecy if observing a ciphertext provides no information about the plaintext message. Mathematically, this is true if and only if $P(M=m | C=c) = P(M=m)$ for all messages $m \\in \\mathcal{M}$ and all ciphertexts $c \\in \\mathcal{C}$ for which $P(C=c) > 0$.\n\nBased on this definition, which of the following statements is true for the described system?\n\nA. Yes, the system has perfect secrecy because the number of keys is equal to the number of messages.\n\nB. Yes, the system has perfect secrecy because for every message, there are multiple possible ciphertexts.\n\nC. No, the system does not have perfect secrecy because observing ciphertext $c_X$ reveals the plaintext message.\n\nD. No, the system does not have perfect secrecy because the message probabilities are not uniform.", "solution": "We use the definition of perfect secrecy: for all ciphertexts $c$ with $P(C=c)>0$ and for all messages $m$, perfect secrecy requires $P(M=m \\mid C=c)=P(M=m)$.\n\nGiven independence of $M$ and $K$ and a deterministic encryption $C=E(K,M)$, we compute $P(C=c \\mid M=m)$ by averaging over $K$:\n$$\nP(C=c \\mid M=m)=\\sum_{k \\in \\mathcal{K}} P(C=c \\mid M=m,K=k) P(K=k),\n$$\nwhere $P(C=c \\mid M=m,K=k)=1$ if $E(k,m)=c$ and $0$ otherwise.\n\nFrom the table:\n- For $c_{X}$: $E(k_{A},m_{0})=c_{X}$ and no other pair produces $c_{X}$.\n- For $c_{Y}$: $E(k_{A},m_{1})=c_{Y}$ and $E(k_{B},m_{0})=c_{Y}$.\n- For $c_{Z}$: $E(k_{B},m_{1})=c_{Z}$ and no other pair produces $c_{Z}$.\n\nCompute for $c_{X}$:\n- $P(C=c_{X} \\mid M=m_{0})=P(K=k_{A})=\\frac{1}{2}$, and $P(C=c_{X} \\mid M=m_{1})=0$.\n- By the law of total probability,\n$$\nP(C=c_{X})=\\sum_{m \\in \\mathcal{M}} P(C=c_{X} \\mid M=m) P(M=m)=\\frac{1}{2}\\cdot \\frac{1}{3}+0 \\cdot \\frac{2}{3}=\\frac{1}{6}.\n$$\n- By Bayes' rule,\n$$\nP(M=m_{0} \\mid C=c_{X})=\\frac{P(C=c_{X} \\mid M=m_{0})P(M=m_{0})}{P(C=c_{X})}=\\frac{\\frac{1}{2}\\cdot \\frac{1}{3}}{\\frac{1}{6}}=1,\n$$\n$$\nP(M=m_{1} \\mid C=c_{X})=\\frac{P(C=c_{X} \\mid M=m_{1})P(M=m_{1})}{P(C=c_{X})}=0.\n$$\nSince $P(M=m_{0})=\\frac{1}{3} \\neq 1$ and $P(M=m_{1})=\\frac{2}{3} \\neq 0$, we have $P(M=m \\mid C=c_{X}) \\neq P(M=m)$. Therefore the system does not have perfect secrecy.\n\nFor completeness, $c_{Z}$ similarly reveals $m_{1}$ with posterior $1$, while $c_{Y}$ yields posteriors equal to priors. However, perfect secrecy requires the equality for all ciphertexts with positive probability; the failure for $c_{X}$ suffices to conclude no perfect secrecy.\n\nThus the correct statement is that observing ciphertext $c_{X}$ reveals the plaintext message.", "answer": "$$\\boxed{C}$$", "id": "1657890"}, {"introduction": "Having learned how to verify perfect secrecy, the next step is to understand how to design for it. This problem shifts our perspective from analysis to engineering, using the classic Caesar cipher as a case study. You will determine the exact conditions that must be imposed on the secret key to elevate this simple substitution cipher to the level of perfect secrecy, even when the underlying message probabilities are non-uniform. This exercise reveals a fundamental requirement of Shannon's theorem: the critical role of a uniformly random key drawn from a sufficiently large key space [@problem_id:1657898].", "problem": "In a cryptographic scenario, a communication system employs a simple Caesar cipher to encrypt messages. The alphabet for plaintext, ciphertext, and keys is the set of integers $\\mathcal{S} = \\{0, 1, \\dots, 25\\}$, which corresponds to the 26 letters of the English alphabet. The encryption of a plaintext symbol $m \\in \\mathcal{S}$ using a key $k \\in \\mathcal{S}$ produces a ciphertext symbol $c$ according to the rule $c = (m + k) \\pmod{26}$.\n\nThe source of the plaintext messages is known to have a non-uniform probability distribution. The probability of any given plaintext symbol $m$ appearing is $P(M=m) = p_m$, where it is known that $p_m > 0$ for all $m \\in \\mathcal{S}$ and $\\sum_{m=0}^{25} p_m = 1$.\n\nIn order to make the cipher secure, the goal is to achieve perfect secrecy. A cryptosystem is said to have perfect secrecy if observing the ciphertext provides no information about the plaintext. This is formally defined by the condition that for any plaintext symbol $m$ and any ciphertext symbol $c$, the conditional probability of the plaintext being $m$ given that the ciphertext is $c$ is equal to the prior probability of the plaintext being $m$. That is, $P(M=m|C=c) = P(M=m)$.\n\nTo achieve this, the key $k$ must be chosen randomly from $\\mathcal{S}$ according to a specific probability distribution, $P(K=k)$. Determine the required probability $P(K=k)$ for any key $k \\in \\mathcal{S}$. Express your answer as a single numerical fraction.", "solution": "Let the plaintext, key, and ciphertext alphabets be $\\mathcal{S}=\\{0,1,\\dots,25\\}$, and encryption be $c=(m+k)\\bmod 26$. Perfect secrecy requires $P(M=m\\mid C=c)=P(M=m)$ for all $m,c$. By Bayesâ€™ rule,\n$$\nP(M=m\\mid C=c)=\\frac{P(C=c\\mid M=m)P(M=m)}{P(C=c)}.\n$$\nThus perfect secrecy for all $m$ with $P(M=m)>0$ implies\n$$\nP(C=c\\mid M=m)=P(C=c)\\quad\\text{for all }m,c.\n$$\nGiven $M=m$, the ciphertext $C$ equals $c$ if and only if $K=(c-m)\\bmod 26$, so\n$$\nP(C=c\\mid M=m)=P\\bigl(K=(c-m)\\bmod 26\\bigr).\n$$\nHence the perfect secrecy condition becomes\n$$\nP\\bigl(K=(c-m)\\bmod 26\\bigr)=P(C=c)\\quad\\text{for all }m,c.\n$$\nFix any $c$ and take two plaintexts $m$ and $m'$; then\n$$\nP\\bigl(K=(c-m)\\bmod 26\\bigr)=P\\bigl(K=(c-m')\\bmod 26\\bigr).\n$$\nSince for fixed $c$ the set $\\{(c-m)\\bmod 26:m\\in\\mathcal{S}\\}$ equals all of $\\mathcal{S}$, it follows that $P(K=k)$ is the same constant for all $k\\in\\mathcal{S}$. Let this constant be $q$. Using $\\sum_{k=0}^{25}P(K=k)=1$ gives $26q=1$, hence $q=\\frac{1}{26}$. Therefore\n$$\nP(K=k)=\\frac{1}{26}\\quad\\text{for all }k\\in\\mathcal{S}.\n$$\nThis choice also yields $P(C=c\\mid M=m)=\\frac{1}{26}$ for all $m,c$, so $P(M=m\\mid C=c)=P(M=m)$, achieving perfect secrecy for any $\\{p_m\\}$ with $p_m>0$.", "answer": "$$\\boxed{\\frac{1}{26}}$$", "id": "1657898"}, {"introduction": "Perfect secrecy is a powerful property, but it is also exceptionally fragile. A minor deviation from a proven design can lead to a complete collapse of security. This exercise explores such a scenario by examining a modified version of the one-time pad, a system known to be perfectly secure. By introducing a single, seemingly innocuous special rule for one message, we create a potential vulnerability. Your analysis will uncover whether this modification compromises the system's integrity, thereby highlighting the strict and unforgiving nature of the conditions for perfect secrecy [@problem_id:1657844].", "problem": "In an effort to design a secure communication channel, an engineer proposes a new encryption scheme for messages of a fixed length $L$. The message space $\\mathcal{M}$, key space $\\mathcal{K}$, and ciphertext space $\\mathcal{C}$ are all the set of binary strings of length $L$, i.e., $\\{0,1\\}^L$.\n\nThe key $K$ is always chosen uniformly at random from $\\mathcal{K}$ and is statistically independent of the message $M$. The message distribution is such that the probability of sending the all-zeros message, $m_0 = (0, 0, \\dots, 0)$, is non-zero, i.e., $P(M=m_0) > 0$, and also less than one, $P(M=m_0) < 1$.\n\nThe proposed encryption rule is a modification of the standard one-time pad:\n1. If the message $M$ is the all-zeros string $m_0$, the resulting ciphertext $C$ is also the all-zeros string $m_0$, regardless of the chosen key $K$.\n2. For any other message $M \\neq m_0$, the ciphertext is calculated as $C = M \\oplus K$, where $\\oplus$ denotes the bitwise exclusive-OR operation.\n\nDoes this encryption system provide perfect secrecy?\n\nA. Yes, the system provides perfect secrecy under all conditions.\n\nB. No, the system does not provide perfect secrecy.\n\nC. The system provides perfect secrecy if and only if the message distribution is uniform over all non-zero messages.\n\nD. The system's security cannot be determined without knowing the exact value of $P(M=m_0)$.", "solution": "Let $\\mathcal{M}=\\mathcal{K}=\\mathcal{C}=\\{0,1\\}^{L}$ and let $m_{0}$ denote the all-zeros string. Let $p_{0}=P(M=m_{0})$ with $0<p_{0}<1$. Perfect secrecy requires that for all $m\\in\\mathcal{M}$ and all $c\\in\\mathcal{C}$ with $P(C=c)>0$,\n$$\nP(M=m\\mid C=c)=P(M=m).\n$$\n\nWe compute the conditional distribution of $C$ given $M$ under the proposed scheme.\n- If $M=m_{0}$, rule 1 gives\n$$\nP(C=c\\mid M=m_{0})=\\begin{cases}\n1, & c=m_{0},\\\\\n0, & c\\neq m_{0}.\n\\end{cases}\n$$\n- If $M\\neq m_{0}$, rule 2 gives $C=M\\oplus K$ with $K$ uniform on $\\{0,1\\}^{L}$ and independent, hence $C$ is uniform on $\\{0,1\\}^{L}$:\n$$\nP(C=c\\mid M=m)=2^{-L}\\quad\\text{for all }c\\in\\{0,1\\}^{L}.\n$$\n\nUsing the law of total probability, for any $c\\in\\{0,1\\}^{L}$,\n$$\nP(C=c)=P(C=c\\mid M=m_{0})P(M=m_{0})+\\sum_{m\\neq m_{0}}P(C=c\\mid M=m)P(M=m).\n$$\nThus,\n$$\nP(C=m_{0})=p_{0}+(1-p_{0})2^{-L},\n$$\nand for any $c\\neq m_{0}$,\n$$\nP(C=c)=(1-p_{0})2^{-L}.\n$$\nSince $0<p_{0}<1$, we have $P(C=c)>0$ for all $c$.\n\nNow evaluate $P(M=m_{0}\\mid C=c)$.\n- For any $c\\neq m_{0}$,\n$$\nP(M=m_{0}\\mid C=c)=\\frac{P(C=c\\mid M=m_{0})P(M=m_{0})}{P(C=c)}=\\frac{0\\cdot p_{0}}{(1-p_{0})2^{-L}}=0.\n$$\nBecause $p_{0}>0$, this yields $P(M=m_{0}\\mid C=c)=0\\neq p_{0}$, violating the perfect secrecy condition.\n\nFor completeness, for $c=m_{0}$,\n$$\nP(M=m_{0}\\mid C=m_{0})=\\frac{1\\cdot p_{0}}{p_{0}+(1-p_{0})2^{-L}}.\n$$\nThis equals $p_{0}$ only if $p_{0}=0$ or $p_{0}=1$, which contradicts $0<p_{0}<1$.\n\nTherefore, the scheme does not provide perfect secrecy for any $0<p_{0}<1$, independent of the exact value of $p_{0}$ and regardless of the distribution over nonzero messages.", "answer": "$$\\boxed{B}$$", "id": "1657844"}]}