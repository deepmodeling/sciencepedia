{"hands_on_practices": [{"introduction": "Understanding perfect secrecy begins with its fundamental definition: the ciphertext must reveal no information about the plaintext. This practice challenges you to apply this principle by comparing two simple ciphers, one using the familiar XOR operation and another using the XNOR operation [@problem_id:1645927]. By working through the analysis, you will develop a deeper intuition that perfect secrecy depends on the resulting statistical relationship between message and ciphertext, not on the specific algebraic function used for encryption.", "problem": "Two cryptography students, Alex and Beth, are discussing simple ciphers for encrypting a single bit of information. The plaintext message is a single bit $M \\in \\{0, 1\\}$, and the secret key is also a single bit $K \\in \\{0, 1\\}$. The key $K$ is chosen uniformly at random, meaning $P(K=0) = P(K=1) = 1/2$. The resulting ciphertext is a single bit $C \\in \\{0, 1\\}$.\n\nAlex proposes a cipher based on the exclusive OR (XOR) operation, denoted by $\\oplus$. The encryption rule is:\n$$C_A = M \\oplus K$$\n\nBeth proposes an alternative cipher based on the exclusive NOR (XNOR) operation. The XNOR operation yields 1 if its two inputs are the same and 0 otherwise. Beth's encryption rule is:\n$$C_B = M \\text{ XNOR } K$$\n\nThey are analyzing whether these ciphers achieve perfect secrecy. A system is said to have perfect secrecy if an observer of the ciphertext can gain no additional information about the plaintext. Mathematically, this is true if the probability distribution of the ciphertext is independent of the plaintext.\n\nWhich of the following statements correctly compares the two ciphers regarding the property of perfect secrecy?\n\nA. Only Alex's cipher achieves perfect secrecy; Beth's cipher leaks some information about the plaintext.\n\nB. Only Beth's cipher achieves perfect secrecy; Alex's cipher leaks some information about the plaintext.\n\nC. Both ciphers achieve perfect secrecy and are functionally equivalent from the perspective of an attacker analyzing the ciphertext for information about the plaintext.\n\nD. Both ciphers fail to achieve perfect secrecy because the key space is too small.\n\nE. Both ciphers achieve perfect secrecy, but Alex's cipher is superior because the XOR operation has properties that make decryption simpler.\n\nF. Both ciphers achieve perfect secrecy, but they are fundamentally different because the statistical properties of the ciphertext in Beth's scheme depend on the plaintext, unlike in Alex's scheme.", "solution": "To determine which cipher achieves perfect secrecy, we must analyze the relationship between the plaintext and the ciphertext for each system. A cipher has perfect secrecy if the conditional probability of the ciphertext $C$ given the plaintext $M$ is independent of the plaintext. That is, $P(C=c|M=m)$ must be the same for all values of $m$. We are given that the key $K$ is uniformly random, so $P(K=0) = P(K=1) = 1/2$.\n\nLet's first analyze Alex's cipher: $C_A = M \\oplus K$.\n\nCase 1: The plaintext is $M=0$.\nThe ciphertext is $C_A = 0 \\oplus K = K$.\nThe probability of getting ciphertext $C_A=0$ is $P(C_A=0|M=0) = P(K=0) = 1/2$.\nThe probability of getting ciphertext $C_A=1$ is $P(C_A=1|M=0) = P(K=1) = 1/2$.\n\nCase 2: The plaintext is $M=1$.\nThe ciphertext is $C_A = 1 \\oplus K = \\neg K$ (the negation of K).\nThe probability of getting ciphertext $C_A=0$ is $P(C_A=0|M=1) = P(\\neg K=0) = P(K=1) = 1/2$.\nThe probability of getting ciphertext $C_A=1$ is $P(C_A=1|M=1) = P(\\neg K=1) = P(K=0) = 1/2$.\n\nIn all situations, $P(C_A=c|M=m) = 1/2$ for any plaintext bit $m \\in \\{0,1\\}$ and any ciphertext bit $c \\in \\{0,1\\}$. Since the probability distribution of the ciphertext is independent of the plaintext, Alex's cipher achieves perfect secrecy.\n\nNow, let's analyze Beth's cipher: $C_B = M \\text{ XNOR } K$.\nThe XNOR operation is defined as $a \\text{ XNOR } b = 1$ if $a=b$ and $0$ if $a \\neq b$. This is equivalent to $a \\text{ XNOR } b = \\neg(a \\oplus b)$.\n\nCase 1: The plaintext is $M=0$.\nThe ciphertext is $C_B = 0 \\text{ XNOR } K$. If $K=0$, $C_B=1$. If $K=1$, $C_B=0$. Thus, $C_B = \\neg K$.\nThe probability of getting ciphertext $C_B=0$ is $P(C_B=0|M=0) = P(\\neg K=0) = P(K=1) = 1/2$.\nThe probability of getting ciphertext $C_B=1$ is $P(C_B=1|M=0) = P(\\neg K=1) = P(K=0) = 1/2$.\n\nCase 2: The plaintext is $M=1$.\nThe ciphertext is $C_B = 1 \\text{ XNOR } K$. If $K=0$, $C_B=0$. If $K=1$, $C_B=1$. Thus, $C_B = K$.\nThe probability of getting ciphertext $C_B=0$ is $P(C_B=0|M=1) = P(K=0) = 1/2$.\nThe probability of getting ciphertext $C_B=1$ is $P(C_B=1|M=1) = P(K=1) = 1/2$.\n\nJust like with Alex's cipher, we find that $P(C_B=c|M=m) = 1/2$ for any plaintext bit $m \\in \\{0,1\\}$ and any ciphertext bit $c \\in \\{0,1\\}$. The probability distribution of the ciphertext is also independent of the plaintext in Beth's cipher. Therefore, Beth's cipher also achieves perfect secrecy.\n\nSince both ciphers achieve perfect secrecy, options A, B, and D are incorrect. Option F is incorrect because, as we have just shown, the statistical properties of the ciphertext in Beth's scheme are also independent of the plaintext.\n\nLet's consider the observer's perspective. For both ciphers, the probability of observing a particular ciphertext bit $c$ is given by the law of total probability:\n$$P(C=c) = P(C=c|M=0)P(M=0) + P(C=c|M=1)P(M=1)$$\nSince $P(C=c|M=m) = 1/2$ for both ciphers, this simplifies to:\n$$P(C=c) = \\frac{1}{2} P(M=0) + \\frac{1}{2} P(M=1) = \\frac{1}{2} (P(M=0) + P(M=1)) = \\frac{1}{2}$$\nFor both Alex's and Beth's ciphers, the output ciphertext is a uniformly random bit ($P(C=0)=1/2, P(C=1)=1/2$), regardless of the original plaintext distribution. An attacker observing the ciphertext stream would see a sequence of perfectly random bits and would not be able to distinguish whether the XOR or XNOR operation was used. Thus, the ciphers are functionally equivalent from an information-theoretic security standpoint.\n\nFinally, option E claims Alex's cipher is superior due to simpler decryption. For Alex's cipher, $C_A = M \\oplus K$, so decryption is $M = C_A \\oplus K$. For Beth's cipher, $C_B = M \\text{ XNOR } K$. Let's check decryption: $C_B \\text{ XNOR } K = (M \\text{ XNOR } K) \\text{ XNOR } K$. Since XNOR is associative and $K \\text{ XNOR } K = 1$, this becomes $M \\text{ XNOR } (K \\text{ XNOR } K) = M \\text{ XNOR } 1 = M$. So, decryption for Beth's cipher is $M = C_B \\text{ XNOR } K$. The decryption operation is the same as the encryption operation, just as with XOR. Therefore, option E's premise is false.\n\nBased on this analysis, both ciphers achieve perfect secrecy and are indistinguishable to an attacker observing the ciphertext.\n\nTherefore, statement C is the correct conclusion.", "answer": "$$\\boxed{C}$$", "id": "1645927"}, {"introduction": "While perfect secrecy is a powerful ideal, real-world systems can have flaws. This exercise explores the practical consequences when a key is not perfectly random, a common vulnerability in cryptographic implementations [@problem_id:1645954]. You will use the concept of mutual information, $I(M;C)$, to precisely quantify how many bits of information about the message are leaked, bridging the gap between the absolute definition of secrecy and the measurable reality of imperfect systems.", "problem": "An engineer is analyzing a simple cryptographic system designed to encrypt a single binary digit. The system model is as follows: The plaintext message, represented by the random variable $M$, can be either 0 or 1. The message source is unbiased, meaning $P(M=0) = 0.5$. The encryption key, represented by the random variable $K$, is also a single binary digit. This key is generated by a process that is supposed to be random, but a flaw results in a biased distribution: the probability of generating a 0 is $P(K=0) = 0.2$. The ciphertext, $C$, is produced by taking the bitwise Exclusive OR (XOR) of the message and the key, such that $C = M \\oplus K$. Assume the key generation process is independent of the message.\n\nYour task is to quantify the information leakage of this system by calculating the mutual information $I(M;C)$ between the message $M$ and the ciphertext $C$. Express your answer in bits, rounded to three significant figures.", "solution": "Let $M\\in\\{0,1\\}$ with $P(M=0)=P(M=1)=\\frac{1}{2}$ and $K\\in\\{0,1\\}$ independent of $M$ with $P(K=0)=0.2$ and $P(K=1)=0.8$. The ciphertext is $C=M\\oplus K$.\n\nWe compute the mutual information using\n$$\nI(M;C)=H(C)-H(C|M).\n$$\n\nFirst, compute $H(C)$. Since $C=M\\oplus K$,\n$$\nP(C=1)=P(M\\neq K)=P(M=0)P(K=1)+P(M=1)P(K=0)=\\tfrac{1}{2}\\cdot 0.8+\\tfrac{1}{2}\\cdot 0.2=\\tfrac{1}{2},\n$$\nand similarly $P(C=0)=\\tfrac{1}{2}$. Thus\n$$\nH(C)=H_{2}\\!\\left(\\tfrac{1}{2}\\right)=1 \\text{ bit},\n$$\nwhere $H_{2}(p)=-p\\log_{2}p-(1-p)\\log_{2}(1-p)$ is the binary entropy function.\n\nNext, compute $H(C|M)$. For any fixed $m\\in\\{0,1\\}$,\n$$\nP(C=m\\,|\\,M=m)=P(K=0)=0.2,\\quad P(C\\neq m\\,|\\,M=m)=P(K=1)=0.8,\n$$\nso\n$$\nH(C|M=m)=H_{2}(0.8).\n$$\nAveraging over $M$ gives\n$$\nH(C|M)=H_{2}(0.8).\n$$\n\nTherefore,\n$$\nI(M;C)=H(C)-H(C|M)=1-H_{2}(0.8).\n$$\nNumerically,\n$$\nH_{2}(0.8)=-0.8\\log_{2}(0.8)-0.2\\log_{2}(0.2)\\approx 0.721928094887,\n$$\nhence\n$$\nI(M;C)\\approx 1-0.721928094887=0.278071905113 \\text{ bits}.\n$$\nRounded to three significant figures, this is $0.278$ bits.", "answer": "$$\\boxed{0.278}$$", "id": "1645954"}, {"introduction": "Building on the properties of a secure key, this practice generalizes our understanding to a broader class of ciphers known as additive or shift ciphers. The problem asks you to determine the one crucial condition on the key's probability distribution that guarantees perfect secrecy for this system [@problem_id:1657913]. Solving this will solidify one of Claude Shannon's foundational results and demonstrate why a uniformly random key is not just a good idea, but a mathematical necessity for achieving this level of security.", "problem": "A minimalist secure communication system is designed to transmit one of three possible messages, represented by the set of integers $\\mathcal{M} = \\{0, 1, 2\\}$. To encrypt a message $m \\in \\mathcal{M}$, a secret key $k$ is chosen from the set $\\mathcal{K} = \\{0, 1, 2\\}$ according to a probability distribution $P(K=k)$. The encryption function, which maps a message $m$ and a key $k$ to a ciphertext $c$, is given by the modular arithmetic rule $c = (m + k) \\pmod 3$. The resulting ciphertext $c$ is also an element of the set $\\{0, 1, 2\\}$.\n\nThe system is designed to achieve perfect secrecy. A cryptosystem exhibits perfect secrecy if and only if the conditional probability of observing a ciphertext $c$ given a plaintext $m$, denoted $P(C=c|M=m)$, is independent of the plaintext $m$ for all possible ciphertexts.\n\nWhich of the following describes the necessary and sufficient condition on the key probability distribution for this system to be perfectly secret?\n\nA. $P(K=0) = P(K=1) = P(K=2)$\n\nB. $P(K=0) = 1/2$, $P(K=1) = 1/4$, $P(K=2) = 1/4$\n\nC. The key distribution must be identical to the plaintext distribution, i.e., $P(K=i) = P(M=i)$ for $i \\in \\{0, 1, 2\\}$.\n\nD. One key must be chosen with certainty, for example $P(K=0)=1$.\n\nE. Any distribution is valid as long as $P(K=k) > 0$ for all $k \\in \\mathcal{K}$.", "solution": "We are given a cipher over the set $\\{0,1,2\\}$ with encryption rule $c = (m + k) \\bmod 3$. The key $K$ is chosen according to a distribution $P(K=k)$ and, as is standard in the analysis of perfect secrecy, $K$ is chosen independently of $M$. Perfect secrecy requires that $P(C=c \\mid M=m)$ be independent of $m$ for all $c$.\n\nSince the encryption is deterministic, for any fixed $m$ and $c$, the event $\\{C=c\\}$ occurs if and only if $K \\equiv c - m \\pmod{3}$. Using independence of $K$ and $M$, we obtain\n$$\nP(C=c \\mid M=m) = P\\big(K = (c - m) \\bmod 3\\big).\n$$\nTherefore, for perfect secrecy (independence of $C$ from $M$), the right-hand side must not depend on $m$. Fix $c$, and compare different values of $m$:\n- For $m=0$: $P(C=c \\mid M=0) = P(K=c)$.\n- For $m=1$: $P(C=c \\mid M=1) = P(K=(c-1) \\bmod 3)$.\n- For $m=2$: $P(C=c \\mid M=2) = P(K=(c-2) \\bmod 3)$.\n\nIndependence in $m$ implies, for each fixed $c$, that\n$$\nP(K=0) = P(K=1) = P(K=2).\n$$\nThis shows necessity. For sufficiency, if $P(K=0) = P(K=1) = P(K=2)$, then for any $m$ and $c$,\n$$\nP(C=c \\mid M=m) = P\\big(K = (c - m) \\bmod 3\\big)\n$$\nequals the same constant for all three possible values of $(c-m) \\bmod 3$, hence it is independent of $m$. Since the key must be a probability distribution, the only possibility is $P(K=0) = P(K=1) = P(K=2) = 1/3$. This is the uniform distribution. Thus the condition is also sufficient.\n\nTherefore, the key distribution must be uniform on $\\{0,1,2\\}$, which is exactly option A.", "answer": "$$\\boxed{A}$$", "id": "1657913"}]}