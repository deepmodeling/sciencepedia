{"hands_on_practices": [{"introduction": "Primality testing is a cornerstone of modern cryptography, and many efficient algorithms are probabilistic. The Fermat primality test, based on Fermat's Little Theorem, offers an elegant first approach. However, it has a critical weakness. This exercise asks you to find a specific counterexample—a composite number that the test incorrectly identifies as potentially prime—which reveals the limitations of this method and motivates the need for more robust algorithms like Miller-Rabin. [@problem_id:1441645]", "problem": "The Fermat primality test is a probabilistic method for determining if a number is likely prime. For a given integer $n  2$ to be tested, one chooses an integer $a$, called the base, such that $1  a  n-1$. According to Fermat's Little Theorem, if $n$ is a prime number, then $a^{n-1} \\equiv 1 \\pmod{n}$.\n\nThe test works as follows: if $a^{n-1} \\not\\equiv 1 \\pmod{n}$, then $n$ is definitively composite. If, however, $a^{n-1} \\equiv 1 \\pmod{n}$, the number $n$ is declared a \"probable prime\" to base $a$. While all prime numbers pass this test for any valid base $a$, some composite numbers also satisfy the congruence for certain bases. These composite numbers are known as Fermat pseudoprimes, and they represent \"false positives\" for the test.\n\nYour task is to find the smallest odd composite integer $n$ that is a Fermat pseudoprime to the base $a=2$.", "solution": "We seek the smallest odd composite integer $n$ such that $2^{n-1} \\equiv 1 \\pmod{n}$. Such an $n$ is called a Fermat pseudoprime to base $2$.\n\nConsider $n=341$. First factor $341=11 \\cdot 31$, with $\\gcd(2,341)=1$. By Fermat's Little Theorem, for primes $p$ we have $2^{p-1} \\equiv 1 \\pmod{p}$, and the multiplicative order of $2$ modulo $p$ divides $p-1$.\n\nCompute the following:\n- Modulo $11$: $2^{5}=32 \\equiv 10 \\equiv -1 \\pmod{11}$, hence $2^{10} \\equiv 1 \\pmod{11}$.\n- Modulo $31$: $2^{5}=32 \\equiv 1 \\pmod{31}$, hence in particular $2^{10} \\equiv 1 \\pmod{31}$.\n\nTherefore $2^{10} \\equiv 1 \\pmod{11}$ and $2^{10} \\equiv 1 \\pmod{31}$. Since $11$ and $31$ are coprime, by the Chinese remainder theorem this implies\n$$\n2^{10} \\equiv 1 \\pmod{341}.\n$$\nRaising both sides to the $34$-th power gives\n$$\n2^{340} = \\left(2^{10}\\right)^{34} \\equiv 1^{34} \\equiv 1 \\pmod{341}.\n$$\nThus $341$ is a Fermat pseudoprime to base $2$.\n\nIt is a standard and well-established fact that $341$ is the smallest odd composite integer with this property (the first base-$2$ Fermat pseudoprime, also known as the first Poulet number). Hence the smallest odd composite $n$ such that $2^{n-1} \\equiv 1 \\pmod{n}$ is $341$.", "answer": "$$\\boxed{341}$$", "id": "1441645"}, {"introduction": "Having seen that the Fermat primality test is not completely reliable, we now turn to a more powerful successor: the Miller-Rabin test. This algorithm improves upon the Fermat test by using a stricter set of conditions to expose composite numbers. This hands-on problem will allow you to apply the Miller-Rabin criteria directly, guiding you through the process of finding a \"strong witness\" to prove a number's compositeness and building your intuition for how the test operates. [@problem_id:1441673]", "problem": "In the field of computational number theory, the Miller-Rabin test is a widely used probabilistic algorithm to determine if a number is composite. A key concept in this test is that of a \"strong witness\". For an odd integer $n  2$ that we wish to test, we first write $n-1$ in the form $2^k \\cdot m$, where $m$ is an odd integer and $k \\ge 1$.\n\nAn integer $a$ such that $1  a  n-1$ is defined as a **strong witness** to the compositeness of $n$ if both of the following conditions are satisfied:\n1. $a^m \\not\\equiv 1 \\pmod n$\n2. $a^{2^i \\cdot m} \\not\\equiv -1 \\pmod n$ for all integers $i$ in the range $0 \\le i  k$.\n\nIf such a strong witness $a$ is found, the number $n$ is definitively composite.\n\nConsider a scenario where a cryptographic system's primality testing module is being validated. It is fed the known composite number $n=57$. Your task is to perform a manual check by finding the smallest integer $a  1$ that serves as a strong witness to the compositeness of $n=57$.", "solution": "We are given $n=57$ and must write $n-1$ in the form $2^{k} m$ with $m$ odd. Since $57-1=56$ and $56=2^{3}\\cdot 7$, we have $k=3$ and $m=7$.\n\nWe seek the smallest integer $a$ with $1an-1$ that is a strong witness, i.e., satisfies:\n1. $a^{m} \\not\\equiv 1 \\pmod{57}$,\n2. $a^{2^{i} m} \\not\\equiv -1 \\pmod{57}$ for all $i$ with $0 \\leq i  3$.\n\nTest $a=2$ (the smallest admissible base). Compute successive powers modulo $57$:\n$$\n2^{6}=64 \\equiv 7 \\pmod{57} \\quad \\Rightarrow \\quad 2^{7}=2\\cdot 2^{6} \\equiv 2\\cdot 7=14 \\pmod{57}.\n$$\nThus $2^{m} \\equiv 14 \\not\\equiv 1 \\pmod{57}$, satisfying the first condition.\n\nNow square successively to check the second condition for $i=0,1,2$:\n$$\n2^{14} \\equiv 14^{2}=196 \\equiv 196-3\\cdot 57=196-171=25 \\pmod{57},\n$$\n$$\n2^{28} \\equiv 25^{2}=625 \\equiv 625-10\\cdot 57=625-570=55 \\pmod{57}.\n$$\nNote that $-1 \\equiv 56 \\pmod{57}$. None of $14$, $25$, or $55$ equals $56$ modulo $57$. Therefore, for $i=0,1,2$, we have $2^{2^{i} m} \\not\\equiv -1 \\pmod{57}$.\n\nBy the given definition, $a=2$ is a strong witness to the compositeness of $n=57$. Since $2$ is the smallest admissible integer greater than $1$, it is the smallest strong witness.", "answer": "$$\\boxed{2}$$", "id": "1441673"}, {"introduction": "Randomized algorithms are effective because the probability of making a mistake is very small. To understand this principle concretely, we can analyze the prevalence of \"liars\"—bases that make a composite number appear prime. This practice will have you move from executing a test to analyzing its reliability by calculating the exact proportion of Fermat liars for a given composite number. Completing this exercise will provide a quantitative foundation for why we can place high confidence in probabilistic primality tests despite the theoretical possibility of error. [@problem_id:1441704]", "problem": "The Fermat primality test for an integer $n  1$ is a probabilistic test based on Fermat's Little Theorem, which states that if $p$ is a prime number, then for any integer $a$ not divisible by $p$, the congruence $a^{p-1} \\equiv 1 \\pmod{p}$ holds. The test proceeds as follows: to test if $n$ is prime, one picks a base $a$ such that $1 \\le a  n$ and checks if $a^{n-1} \\equiv 1 \\pmod{n}$. If the congruence fails, $n$ is definitively composite. If the congruence holds for a composite number $n$, then $n$ is called a Fermat pseudoprime to base $a$, and the base $a$ is called a \"Fermat liar\" for $n$.\n\nConsider the composite number $n=91$. Your task is to determine the exact proportion of Fermat liars for $n=91$ among all possible bases $a$ in the set $\\{a \\in \\mathbb{Z} \\mid 1 \\le a  91 \\text{ and } \\gcd(a, 91) = 1\\}$. Express your answer as an exact fraction in simplest form.", "solution": "Let $n=91=7\\cdot 13$. We consider bases $a$ with $\\gcd(a,91)=1$, i.e., the unit group $(\\mathbb{Z}/91\\mathbb{Z})^{\\times}$, which has size\n$$\n\\varphi(91)=\\varphi(7)\\varphi(13)=6\\cdot 12=72.\n$$\nBy the Chinese Remainder Theorem,\n$$\n(\\mathbb{Z}/91\\mathbb{Z})^{\\times}\\cong (\\mathbb{Z}/7\\mathbb{Z})^{\\times}\\times (\\mathbb{Z}/13\\mathbb{Z})^{\\times},\n$$\nwith $|(\\mathbb{Z}/7\\mathbb{Z})^{\\times}|=6$ and $|(\\mathbb{Z}/13\\mathbb{Z})^{\\times}|=12$.\n\nWe must count the number of $a$ such that\n$$\na^{90}\\equiv 1 \\pmod{91}.\n$$\nBy CRT, this holds if and only if\n$$\na^{90}\\equiv 1 \\pmod{7}\\quad \\text{and}\\quad a^{90}\\equiv 1 \\pmod{13}.\n$$\n\nFor modulo $7$, since $(\\mathbb{Z}/7\\mathbb{Z})^{\\times}$ has order $6$, for any unit $u$,\n$$\nu^{6}\\equiv 1 \\pmod{7}\\implies u^{90}=u^{6\\cdot 15}\\equiv 1 \\pmod{7}.\n$$\nThus every unit mod $7$ satisfies $u^{90}\\equiv 1 \\pmod{7}$; there are $6$ such residues.\n\nFor modulo $13$, $(\\mathbb{Z}/13\\mathbb{Z})^{\\times}$ has order $12$ and is cyclic. For any unit $v$,\n$$\nv^{90}=v^{12\\cdot 7+6}=(v^{12})^{7}v^{6}\\equiv v^{6}\\pmod{13}.\n$$\nHence $v^{90}\\equiv 1 \\pmod{13}$ if and only if $v^{6}\\equiv 1 \\pmod{13}$. In a cyclic group of order $12$, the equation $x^{6}=1$ has exactly $\\gcd(6,12)=6$ solutions. Therefore there are $6$ residues mod $13$ satisfying $v^{90}\\equiv 1 \\pmod{13}$.\n\nBy CRT, the total number of $a$ modulo $91$ with $\\gcd(a,91)=1$ and $a^{90}\\equiv 1 \\pmod{91}$ is\n$$\n6\\cdot 6=36.\n$$\nThus the proportion among all $72$ units is\n$$\n\\frac{36}{72}=\\frac{1}{2}.\n$$\nTherefore the exact proportion of Fermat liars for $n=91$ is $\\frac{1}{2}$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1441704"}]}