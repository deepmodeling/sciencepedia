{"hands_on_practices": [{"introduction": "This first practice grounds the theory of polynomial identity testing in a tangible example. We explore a hypothetical scenario where a claimed mathematical identity is tested not by a rigorous proof, but by a quick probabilistic check. By calculating the exact probability of this test failing, you will gain a concrete understanding of how a non-zero polynomial's limited number of roots governs the effectiveness of this powerful technique [@problem_id:1462426].", "problem": "A computer science student is tasked with verifying a complex formula found in an old mathematics handbook. The handbook claims that for any positive integer $n$, the following identity for the sum of cubes is true:\n$$ \\sum_{k=1}^{n} k^3 = \\frac{1}{4}n^4 + \\frac{1}{2}n^3 - \\frac{3}{4}n^2 + 15n - 50 $$\nLacking the time to perform a full symbolic proof, the student decides to use a probabilistic test. The procedure involves picking a single integer, $n$, uniformly at random from the set of integers $S = \\{1, 2, 3, \\ldots, 500\\}$. The student will then calculate the values of the left-hand side (the sum) and the right-hand side (the polynomial) for this chosen $n$. If the two values match, the student will conclude that the identity is correct. Otherwise, they will conclude it is incorrect.\n\nIn reality, the claimed identity is false. What is the probability that the student's test will fail to detect this, meaning they will incorrectly conclude that the identity is correct? Express the answer as a decimal value, rounded to three significant figures.", "solution": "The true formula for the sum of cubes is\n$$\nS(n)=\\sum_{k=1}^{n} k^{3}=\\left(\\frac{n(n+1)}{2}\\right)^{2}=\\frac{1}{4}\\left(n^{4}+2n^{3}+n^{2}\\right)=\\frac{1}{4}n^{4}+\\frac{1}{2}n^{3}+\\frac{1}{4}n^{2}.\n$$\nThe claimed polynomial is\n$$\nP(n)=\\frac{1}{4}n^{4}+\\frac{1}{2}n^{3}-\\frac{3}{4}n^{2}+15n-50.\n$$\nThe identity would hold exactly when $S(n)=P(n)$. Consider the difference\n$$\nD(n)=S(n)-P(n)=\\left(\\frac{1}{4}n^{4}+\\frac{1}{2}n^{3}+\\frac{1}{4}n^{2}\\right)-\\left(\\frac{1}{4}n^{4}+\\frac{1}{2}n^{3}-\\frac{3}{4}n^{2}+15n-50\\right).\n$$\nSimplifying term by term,\n$$\nD(n)=\\left(\\frac{1}{4}-\\frac{1}{4}\\right)n^{4}+\\left(\\frac{1}{2}-\\frac{1}{2}\\right)n^{3}+\\left(\\frac{1}{4}+\\frac{3}{4}\\right)n^{2}-15n+50\n= n^{2}-15n+50.\n$$\nThus the claimed identity holds exactly when\n$$\nn^{2}-15n+50=0.\n$$\nSolving,\n$$\nn=\\frac{15\\pm\\sqrt{15^{2}-4\\cdot 1\\cdot 50}}{2}=\\frac{15\\pm\\sqrt{225-200}}{2}=\\frac{15\\pm 5}{2}\\in\\{5,10\\}.\n$$\nBoth $n=5$ and $n=10$ lie in $S=\\{1,2,\\ldots,500\\}$. Therefore, with $n$ chosen uniformly from $S$, the probability of (incorrectly) concluding the identity is correct equals\n$$\n\\frac{|\\{5,10\\}|}{|S|}=\\frac{2}{500}=\\frac{1}{250}=0.00400,\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{0.00400}$$", "id": "1462426"}, {"introduction": "Moving from a specific case to a general principle, this problem simulates a common scenario in cryptography and distributed computing. Instead of knowing the exact incorrect formula, we often only know its complexity, such as its maximum degree. This exercise [@problem_id:1462388] demonstrates how to use the Schwartz-Zippel Lemma to establish a guaranteed upper bound on the probability of error, a crucial assurance for the reliability of any randomized protocol.", "problem": "A company has developed a cryptographic checksum system for verifying data integrity across a distributed network. A central server holds a master dataset, which is mathematically represented by a polynomial $P(x_1, x_2, x_3)$. A remote client processes some information and generates its own dataset, represented by a polynomial $Q(x_1, x_2, x_3)$. The client's computation is considered correct if and only if its polynomial $Q$ is identical to the master polynomial $P$.\n\nTo verify the client's work without transmitting the large polynomials, they use a probabilistic verification protocol. The server publicly announces a finite set of integers, $S$. Then, a random evaluation point $(r_1, r_2, r_3)$ is securely generated by choosing each coordinate $r_i$ independently and uniformly at random from the set $S$. The client's work is accepted if its polynomial evaluates to the same value as the server's at this random point, i.e., if $P(r_1, r_2, r_3) = Q(r_1, r_2, r_3)$.\n\nSuppose the master polynomial $P$ and the client's polynomial $Q$ are known to have a total degree of at most $d=20$. For a particular verification run, the server announces that the values for $r_1, r_2,$ and $r_3$ must be chosen from the set $S = \\{0, 1, 2, \\dots, 999\\}$.\n\nAssuming the client's computation was faulty and its polynomial $Q$ is not identical to $P$, what is the maximum possible probability that this single verification test will fail to detect the error (i.e., that the test passes)? Express your answer as an exact fraction in its simplest form.", "solution": "Let $S=\\{0,1,2,\\dots,999\\}$, so $|S|=1000$. The verification picks $(r_{1},r_{2},r_{3})\\in S^{3}$ uniformly at random with independent coordinates. Assume $Q\\not\\equiv P$. Define the difference polynomial\n$$\nR(x_{1},x_{2},x_{3})=P(x_{1},x_{2},x_{3})-Q(x_{1},x_{2},x_{3}).\n$$\nThen $R$ is a nonzero polynomial with total degree at most $d=20$. The test passes exactly when $P(r_{1},r_{2},r_{3})=Q(r_{1},r_{2},r_{3})$, i.e., when $R(r_{1},r_{2},r_{3})=0$.\n\nBy the Schwartz-Zippel lemma, for a nonzero polynomial $R$ of total degree at most $d$ and a random point chosen uniformly from $S^{n}$ (here $n=3$), the probability that $R$ evaluates to zero is at most $\\frac{d}{|S|}$. Applying this with $d=20$ and $|S|=1000$ gives\n$$\n\\Pr\\big(R(r_{1},r_{2},r_{3})=0\\big)\\leq \\frac{20}{1000}=\\frac{1}{50}.\n$$\nMoreover, this bound is tight: for instance, take $R(x_{1},x_{2},x_{3})=\\prod_{k=1}^{20}(x_{1}-a_{k})$ with distinct $a_{k}\\in S$. Then $R$ has degree $20$ and vanishes exactly when $r_{1}\\in\\{a_{1},\\dots,a_{20}\\}$, which happens with probability $\\frac{20}{1000}=\\frac{1}{50}$, independently of $r_{2}$ and $r_{3}$. Therefore, the maximum possible probability that the single test fails to detect the error equals $\\frac{1}{50}$.", "answer": "$$\\boxed{\\frac{1}{50}}$$", "id": "1462388"}, {"introduction": "This final practice challenges you to move beyond simple identity verification and use the lemma as a tool for algorithmic design. Here, we tackle the more abstract task of testing a structural property of a polynomial: symmetry. This exercise [@problem_id:1462404] showcases the versatility of randomized evaluation, requiring you to construct a novel test polynomial to efficiently solve a problem that might otherwise be computationally intensive.", "problem": "An arithmetic circuit is a computational model representing a polynomial. It is a directed acyclic graph where leaf nodes are labeled with input variables ($x_1, \\dots, x_n$) or constants, and internal nodes (gates) are labeled with arithmetic operations ($+, \\times, -$). The output of the circuit is the polynomial computed at a designated root node. This representation can be very compact, even for polynomials of high degree.\n\nA multivariate polynomial $P(x_1, \\dots, x_n)$ is called **symmetric** if its value is invariant under any permutation of its variables. That is, for every permutation $\\sigma$ of the set $\\{1, 2, \\dots, n\\}$, the identity $P(x_1, \\dots, x_n) \\equiv P(x_{\\sigma(1)}, \\dots, x_{\\sigma(n)})$ holds.\n\nConsider a polynomial $P(x_1, \\dots, x_n)$ with $n \\ge 2$ variables, given as an arithmetic circuit over the field of real numbers. You are given that the total degree of $P$ is at most $d$. Your task is to design a randomized algorithm to test if $P$ is symmetric.\n\nYour algorithm must be based on the evaluation of a single test expression, constructed from $P$, at a single randomly chosen point. This test must have a one-sided error: if $P$ is symmetric, the test must pass with certainty. If $P$ is not symmetric, the test may fail (i.e., erroneously report that $P$ is symmetric) with some probability.\n\nTo construct your test, you may use the following fact from group theory: for $n \\ge 2$, the symmetric group $S_n$, which is the group of all permutations of $n$ elements, is generated by the transposition $\\tau = (1, 2)$ (which swaps the first two elements) and the long cycle $\\pi = (1, 2, \\dots, n)$ (which cyclically permutes all elements). This means any polynomial invariant under both $\\tau$ and $\\pi$ is fully symmetric.\n\nYou will construct your test using $P$, one auxiliary variable $y$, and the permutations $\\tau$ and $\\pi$. The test will involve picking values for $x_1, \\dots, x_n$ and $y$ independently and uniformly at random from a finite set of integers $S$.\n\nWhat is the tightest upper bound on the probability of an erroneous result (i.e., the algorithm outputting \"Symmetric\" when $P$ is not) for such a test? Express your answer as a single closed-form analytic expression in terms of $d$ and the size of the sampling set, $|S|$.", "solution": "Let $n \\ge 2$ and let $P(x_{1},\\dots,x_{n})$ be given by an arithmetic circuit over $\\mathbb{R}$ with total degree at most $d$. For $x=(x_{1},\\dots,x_{n})$, define the actions of the generators of $S_{n}$ by\n$$\n\\tau(x)=(x_{2},x_{1},x_{3},\\dots,x_{n}),\\qquad \\pi(x)=(x_{2},x_{3},\\dots,x_{n},x_{1}).\n$$\nLet\n$$\nA(x) \\equiv P(x)-P(\\tau(x)),\\qquad B(x) \\equiv P(x)-P(\\pi(x)).\n$$\nSince permutations do not change total degree, both $A$ and $B$ have total degree at most $d$. Introduce one auxiliary variable $y$ and define the single test polynomial\n$$\nQ(x,y) \\equiv A(x) + y\\,B(x).\n$$\nWe pick $x_{1},\\dots,x_{n},y$ independently and uniformly at random from a finite set of integers $S$, and output “Symmetric” if and only if $Q(x,y)=0$ at the sampled point.\n\nThis test has one-sided error:\n- If $P$ is symmetric, then it is invariant under both $\\tau$ and $\\pi$, hence $A \\equiv 0$ and $B \\equiv 0$, so $Q \\equiv 0$. Therefore the test always outputs “Symmetric.”\n- If $P$ is not symmetric, then at least one of $A,B$ is a nonzero polynomial, hence $Q$ is a nonzero polynomial in the variables $(x_{1},\\dots,x_{n},y)$.\n\nWe bound the error probability (the event that $Q(x,y)=0$ at the sampled point when $Q \\not\\equiv 0$) using the Schwartz-Zippel lemma. The total degree of $Q$ satisfies\n$$\n\\deg(Q) \\le \\max\\{\\deg(A),\\,\\deg(yB)\\} \\le \\max\\{d,\\,1+d\\} = d+1,\n$$\nsince $\\deg(A) \\le d$ and $\\deg(B) \\le d$, and multiplication by $y$ increases the total degree by at most $1$. By the Schwartz-Zippel lemma, for a nonzero polynomial of total degree at most $D$ over a field, when each variable is sampled independently and uniformly from a finite set $S$, the probability of evaluating to zero is at most $D/|S|$. Applying this with $D=d+1$ gives\n$$\n\\Pr[Q(x,y)=0 \\mid Q \\not\\equiv 0] \\le \\frac{d+1}{|S|}.\n$$\nThis bound is tight in general for tests of this form because $\\deg(Q)$ cannot be bounded below $d+1$ in the worst case (when $\\deg(B)=d$), and the Schwartz-Zippel bound is optimal up to equality for polynomials of a given total degree.\n\nTherefore, the tightest upper bound on the erroneous acceptance probability is $\\frac{d+1}{|S|}$.", "answer": "$$\\boxed{\\frac{d+1}{|S|}}$$", "id": "1462404"}]}