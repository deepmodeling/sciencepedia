{"hands_on_practices": [{"introduction": "The power of B-splines lies in their locally-supported basis functions, which are constructed recursively. This first exercise [@problem_id:2424168] invites you to build a quadratic B-spline basis function from the ground up using the celebrated Cox–de Boor recursion formula. By performing this calculation manually, you will gain a concrete understanding of how the placement and multiplicity of knots directly shape the resulting polynomial pieces and control the continuity of the spline.", "problem": "In computational engineering, basis splines (B-splines) provide robust piecewise polynomial approximations with compact support and controllable continuity. Consider the open, non-uniform knot vector $t = \\{0, 0, 0, 1, 3, 3, 4, 4, 4\\}$ and quadratic degree $p = 2$. Starting from the fundamental definition of zero-degree B-spline basis functions and the Cox–de Boor recursion, manually derive the explicit piecewise polynomial expression for the quadratic B-spline basis function $N_{3,2}(x)$ associated with this knot vector. Use the standard convention that if a denominator in the recursion is zero, then the corresponding term is taken to be zero, and take characteristic intervals as half-open of the form $[a,b)$. Express your final result as a single piecewise-defined analytic expression in $x$. No numerical rounding is required, and no units are involved. The final answer must be the closed-form expression only.", "solution": "The posed problem is subject to rigorous validation before any attempt at a solution is made.\n\n### Step 1: Extract Givens\n-   **Field**: Computational Engineering\n-   **Topic**: Piecewise polynomial approximations, B-splines\n-   **Knot Vector**: $t = \\{0, 0, 0, 1, 3, 3, 4, 4, 4\\}$\n-   **Degree**: $p = 2$ (quadratic)\n-   **Target Basis Function**: $N_{3,2}(x)$\n-   **Method**: Cox–de Boor recursion, starting from zero-degree basis functions.\n-   **Convention 1**: If a denominator in the recursion formula is zero, the corresponding term is zero.\n-   **Convention 2**: Characteristic intervals are half-open, $[a,b)$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a standard, fundamental exercise in the theory of B-splines, a core topic in numerical analysis and computer-aided geometric design. All concepts, including the knot vector, degree, and the Cox-de Boor recursion, are well-established. The problem is scientifically sound.\n2.  **Well-Posed**: The problem is specified with precision. The knot vector, polynomial degree, and the target basis function are explicitly given. The conventions for handling zero denominators and interval forms remove any potential ambiguity in the calculation. A unique, stable, and meaningful piecewise polynomial solution exists and can be derived.\n3.  **Objective**: The language is clear, precise, and entirely objective. It presents a mathematical task without subjective or speculative content.\n\n### Step 3: Verdict and Action\nThe problem is determined to be **valid**. It is self-contained, scientifically grounded, and well-posed. A solution will be derived.\n\n### Derivation\nThe derivation of the B-spline basis function $N_{i,p}(x)$ is governed by the Cox-de Boor recursion formula. We begin with the definition of the zero-degree basis functions, $N_{i,0}(x)$:\n$$\nN_{i,0}(x) =\n\\begin{cases}\n1 & \\text{if } t_i \\le x < t_{i+1} \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nFor a degree $p > 0$, the higher-degree basis functions are defined recursively:\n$$\nN_{i,p}(x) = \\frac{x - t_i}{t_{i+p} - t_i} N_{i, p-1}(x) + \\frac{t_{i+p+1} - x}{t_{i+p+1} - t_{i+1}} N_{i+1, p-1}(x)\n$$\nThe provided convention states that any term with a zero denominator is taken to be zero.\n\nThe problem specifies the knot vector $t = \\{t_0, t_1, \\dots, t_8\\}$ as:\n$$\nt = \\{0, 0, 0, 1, 3, 3, 4, 4, 4\\}\n$$\nThe degree is $p=2$. We are required to find the expression for the basis function $N_{3,2}(x)$.\n\nFirst, we determine the support of $N_{3,2}(x)$. The support of a B-spline basis function $N_{i,p}(x)$ is the interval $[t_i, t_{i+p+1})$. For $N_{3,2}(x)$, this corresponds to the interval $[t_3, t_{3+2+1}) = [t_3, t_6)$. From the knot vector, $t_3=1$ and $t_6=4$. Therefore, $N_{3,2}(x)$ is non-zero only for $x \\in [1, 4)$.\n\nWe apply the recursion formula to find $N_{3,2}(x)$:\n$$\nN_{3,2}(x) = \\frac{x - t_3}{t_{3+2} - t_3} N_{3,1}(x) + \\frac{t_{3+2+1} - x}{t_{3+2+1} - t_{3+1}} N_{4,1}(x) = \\frac{x - t_3}{t_5 - t_3} N_{3,1}(x) + \\frac{t_6 - x}{t_6 - t_4} N_{4,1}(x)\n$$\nSubstituting the knot values $t_3=1$, $t_4=3$, $t_5=3$, and $t_6=4$:\n$$\nN_{3,2}(x) = \\frac{x - 1}{3 - 1} N_{3,1}(x) + \\frac{4 - x}{4 - 3} N_{4,1}(x) = \\frac{x - 1}{2} N_{3,1}(x) + (4 - x) N_{4,1}(x)\n$$\nNext, we must find the expressions for the linear basis functions $N_{3,1}(x)$ and $N_{4,1}(x)$.\n\nFor $N_{3,1}(x)$, the recursion is:\n$$\nN_{3,1}(x) = \\frac{x - t_3}{t_{3+1} - t_3} N_{3,0}(x) + \\frac{t_{3+1+1} - x}{t_{3+1+1} - t_{3+1}} N_{4,0}(x) = \\frac{x - t_3}{t_4 - t_3} N_{3,0}(x) + \\frac{t_5 - x}{t_5 - t_4} N_{4,0}(x)\n$$\nSubstituting knot values $t_3=1$, $t_4=3$, $t_5=3$:\n$$\nN_{3,1}(x) = \\frac{x - 1}{3 - 1} N_{3,0}(x) + \\frac{3 - x}{3 - 3} N_{4,0}(x)\n$$\nThe denominator $t_5 - t_4$ is zero, so the second term is zero.\n$$\nN_{3,1}(x) = \\frac{x - 1}{2} N_{3,0}(x)\n$$\nThe support of $N_{3,0}(x)$ is $[t_3, t_4) = [1, 3)$, where it is equal to $1$. Thus, $N_{3,1}(x)$ is:\n$$\nN_{3,1}(x) = \\begin{cases} \\frac{x-1}{2} & 1 \\le x < 3 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nFor $N_{4,1}(x)$, the recursion is:\n$$\nN_{4,1}(x) = \\frac{x - t_4}{t_{4+1} - t_4} N_{4,0}(x) + \\frac{t_{4+1+1} - x}{t_{4+1+1} - t_{4+1}} N_{5,0}(x) = \\frac{x - t_4}{t_5 - t_4} N_{4,0}(x) + \\frac{t_6 - x}{t_6 - t_5} N_{5,0}(x)\n$$\nSubstituting knot values $t_4=3$, $t_5=3$, $t_6=4$:\n$$\nN_{4,1}(x) = \\frac{x - 3}{3 - 3} N_{4,0}(x) + \\frac{4 - x}{4 - 3} N_{5,0}(x)\n$$\nThe denominator $t_5 - t_4$ is zero, so the first term is zero.\n$$\nN_{4,1}(x) = \\frac{4 - x}{1} N_{5,0}(x) = (4 - x) N_{5,0}(x)\n$$\nThe support of $N_{5,0}(x)$ is $[t_5, t_6) = [3, 4)$, where it is equal to $1$. Thus, $N_{4,1}(x)$ is:\n$$\nN_{4,1}(x) = \\begin{cases} 4 - x & 3 \\le x < 4 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nNow, we substitute these piecewise expressions for $N_{3,1}(x)$ and $N_{4,1}(x)$ into the equation for $N_{3,2}(x)$. We consider the intervals over its support $[1, 4)$.\n\nCase 1: $x \\in [1, 3)$\nIn this interval, $N_{3,1}(x) = \\frac{x-1}{2}$ and $N_{4,1}(x) = 0$.\n$$\nN_{3,2}(x) = \\frac{x - 1}{2} \\left( \\frac{x-1}{2} \\right) + (4 - x)(0) = \\frac{(x-1)^2}{4}\n$$\n\nCase 2: $x \\in [3, 4)$\nIn this interval, $N_{3,1}(x) = 0$ and $N_{4,1}(x) = 4-x$.\n$$\nN_{3,2}(x) = \\frac{x-1}{2}(0) + (4 - x)(4 - x) = (4-x)^2\n$$\n\nCombining these results, we obtain the complete piecewise-defined expression for $N_{3,2}(x)$:\n$$\nN_{3,2}(x) =\n\\begin{cases}\n\\frac{(x-1)^2}{4} & \\text{if } 1 \\leq x < 3 \\\\\n(4-x)^2 & \\text{if } 3 \\leq x < 4 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nThis function has support $[1,4)$. At the knot $x=3$, which has multiplicity $k=2$, the continuity is $C^{p-k} = C^{2-2} = C^0$. We verify this:\n$\\lim_{x \\to 3^-} N_{3,2}(x) = \\frac{(3-1)^2}{4} = 1$.\n$N_{3,2}(3) = (4-3)^2 = 1$.\nThe function is continuous, as required.", "answer": "$$\n\\boxed{\nN_{3,2}(x) = \n\\begin{cases}\n\\frac{(x-1)^{2}}{4} & 1 \\le x < 3 \\\\\n(4-x)^{2} & 3 \\le x < 4 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n}\n$$", "id": "2424168"}, {"introduction": "Moving from individual basis functions to a complete solution, this practice focuses on one of the most important applications of piecewise polynomials: data interpolation. You will construct a 'not-a-knot' cubic spline to fit a given set of data points [@problem_id:2424185]. This process involves enforcing continuity conditions at the interior knots to derive a system of linear equations, a classic procedure that reveals the inner workings of spline interpolation and yields a beautifully smooth curve.", "problem": "In a computational engineering workflow, you must interpolate discrete simulation outputs by a piecewise polynomial with minimal artificial oscillation. You are given five strictly increasing nodes $x_0, x_1, x_2, x_3, x_4$ and corresponding scalar data values $y_0, y_1, y_2, y_3, y_4$:\n- $(x_0,y_0) = (\\,0,\\,1\\,)$,\n- $(x_1,y_1) = (\\,1,\\,0\\,)$,\n- $(x_2,y_2) = (\\,2,\\,5\\,)$,\n- $(x_3,y_3) = (\\,3,\\,22\\,)$,\n- $(x_4,y_4) = (\\,5,\\,116\\,)$.\n\nConstruct the not-a-knot cubic spline interpolant $S(x)$ on the partition $0=x_0<x_1<x_2<x_3<x_4=5$ using only the defining properties of cubic splines and the not-a-knot end conditions. Specifically, start from the fundamental definition that a cubic spline is a function $S$ such that on each interval $[x_i,x_{i+1}]$ it is a cubic polynomial, and $S$, $S'$, and $S''$ are continuous at each interior node, while the not-a-knot condition enforces continuity of the third derivative at the first and last interior nodes. Do not invoke any prepackaged spline coefficient formulas.\n\nThen, verify explicitly the not-a-knot condition, namely that $S'''$ is continuous at $x_1$ and $x_3$.\n\nFinally, evaluate the interpolant at $x=4$. Express your final answer as an exact number with no rounding and no units. Your final reported answer must be the single value $S(4)$.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Data Points**: Five points $(x_i, y_i)$ are provided: $(x_0,y_0) = (0,1)$, $(x_1,y_1) = (1,0)$, $(x_2,y_2) = (2,5)$, $(x_3,y_3) = (3,22)$, and $(x_4,y_4) = (5,116)$.\n- **Nodes**: The nodes are $x_0=0$, $x_1=1$, $x_2=2$, $x_3=3$, and $x_4=5$.\n- **Function Type**: A piecewise cubic spline, denoted $S(x)$.\n- **Interpolation Condition**: $S(x_i) = y_i$ for $i=0, 1, 2, 3, 4$.\n- **Continuity Conditions**: $S(x)$, $S'(x)$, and $S''(x)$ must be continuous at the interior nodes $x_1$, $x_2$, and $x_3$.\n- **End Conditions**: The \"not-a-knot\" condition is specified, which requires the third derivative, $S'''(x)$, to be continuous at the first and last interior nodes, $x_1$ and $x_3$.\n- **Task**: First, construct the spline $S(x)$ from these defining properties. Second, verify the not-a-knot condition explicitly. Third, evaluate $S(4)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on the theory of spline interpolation, a fundamental and well-established topic in numerical analysis and computational engineering. All concepts are mathematically sound.\n- **Well-Posed**: The problem of constructing a not-a-knot cubic spline for $n+1$ points is well-posed and has a unique solution. The provided data consists of 5 points, which is a standard configuration.\n- **Objective**: The problem is stated using precise, objective mathematical language, free from any subjectivity or ambiguity.\n- **Completeness and Consistency**: The number of constraints matches the number of degrees of freedom. For a spline with 4 cubic pieces ($S_0, S_1, S_2, S_3$), there are $4 \\times 4 = 16$ coefficients to determine. The conditions are: $2 \\times 4 = 8$ interpolation conditions at the ends of each interval, $3$ continuity conditions for $S'(x)$ at $x_1, x_2, x_3$, $3$ continuity conditions for $S''(x)$ at $x_1, x_2, x_3$, and $2$ not-a-knot conditions for $S'''(x)$ at $x_1, x_3$. This totals $8+3+3+2=16$ conditions. The setup is complete and consistent.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A rigorous solution will be provided.\n\nA cubic spline $S(x)$ is a set of cubic polynomials, $S_i(x)$, defined on the intervals $[x_i, x_{i+1}]$. The second derivative of each cubic piece, $S_i''(x)$, is a linear function. We can express it by linear interpolation of the second derivative values at the nodes, $M_i = S''(x_i)$:\n$$S_i''(x) = M_i \\frac{x_{i+1} - x}{h_i} + M_{i+1} \\frac{x - x_i}{h_i}$$\nwhere $h_i = x_{i+1} - x_i$. This formulation inherently enforces the continuity of $S''(x)$ at the interior nodes.\n\nIntegrating $S_i''(x)$ twice with respect to $x$ yields:\n$$S_i(x) = M_i \\frac{(x_{i+1} - x)^3}{6h_i} + M_{i+1} \\frac{(x - x_i)^3}{6h_i} + C_i(x-x_i) + D_i$$\nThe constants of integration $C_i$ and $D_i$ are determined by the interpolation conditions $S_i(x_i) = y_i$ and $S_i(x_{i+1}) = y_{i+1}$. This leads to the standard form for the spline segment:\n$$S_i(x) = \\frac{M_i}{6h_i}(x_{i+1}-x)^3 + \\frac{M_{i+1}}{6h_i}(x-x_i)^3 + \\left(y_i - \\frac{M_i h_i^2}{6}\\right)\\frac{x_{i+1}-x}{h_i} + \\left(y_{i+1} - \\frac{M_{i+1} h_i^2}{6}\\right)\\frac{x-x_i}{h_i}$$\nThis form ensures $S(x)$ is continuous and satisfies the interpolation conditions. The remaining unknowns are the moments $M_i$ for $i=0, \\dots, 4$.\n\nTo find the moments, we enforce the continuity of the first derivative, $S'(x)$, at the interior nodes $x_1, x_2, x_3$. The condition $S'_{i-1}(x_i) = S'_{i}(x_i)$ for $i=1, 2, 3$ leads to the following system of linear equations:\n$$h_{i-1}M_{i-1} + 2(h_{i-1} + h_i)M_i + h_i M_{i+1} = 6 \\left( \\frac{y_{i+1}-y_i}{h_i} - \\frac{y_i-y_{i-1}}{h_{i-1}} \\right)$$\n\nThe problem specifies not-a-knot end conditions. This implies continuity of the third derivative at notes $x_1$ and $x_3$. The third derivative of $S_i(x)$ is constant on $(x_i, x_{i+1})$:\n$$S_i'''(x) = \\frac{M_{i+1} - M_i}{h_i}$$\nContinuity at $x_1$ means $S_0'''(x_1) = S_1'''(x_1)$, which gives $\\frac{M_1 - M_0}{h_0} = \\frac{M_2 - M_1}{h_1}$.\nContinuity at $x_3$ means $S_2'''(x_3) = S_3'''(x_3)$, which gives $\\frac{M_3 - M_2}{h_2} = \\frac{M_4 - M_3}{h_3}$.\n\nWe now apply these general relations to the specific problem data. The interval lengths are:\n$h_0 = x_1 - x_0 = 1 - 0 = 1$\n$h_1 = x_2 - x_1 = 2 - 1 = 1$\n$h_2 = x_3 - x_2 = 3 - 2 = 1$\n$h_3 = x_4 - x_3 = 5 - 3 = 2$\n\nThe system of equations for the five unknown moments $M_0, M_1, M_2, M_3, M_4$ is:\n1.  Not-a-knot at $x_1$: $\\frac{M_1 - M_0}{1} = \\frac{M_2 - M_1}{1} \\implies -M_0 + 2M_1 - M_2 = 0$.\n2.  $S'$ continuity at $x_1$ ($i=1$): $h_0M_0 + 2(h_0+h_1)M_1 + h_1M_2 = 6(\\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0})$\n    $$1 \\cdot M_0 + 2(1+1)M_1 + 1 \\cdot M_2 = 6\\left(\\frac{5-0}{1} - \\frac{0-1}{1}\\right) = 6(5+1)=36 \\implies M_0 + 4M_1 + M_2 = 36$$\n3.  $S'$ continuity at $x_2$ ($i=2$): $h_1M_1 + 2(h_1+h_2)M_2 + h_2M_3 = 6(\\frac{y_3-y_2}{h_2} - \\frac{y_2-y_1}{h_1})$\n    $$1 \\cdot M_1 + 2(1+1)M_2 + 1 \\cdot M_3 = 6\\left(\\frac{22-5}{1} - \\frac{5-0}{1}\\right) = 6(17-5)=72 \\implies M_1 + 4M_2 + M_3 = 72$$\n4.  $S'$ continuity at $x_3$ ($i=3$): $h_2M_2 + 2(h_2+h_3)M_3 + h_3M_4 = 6(\\frac{y_4-y_3}{h_3} - \\frac{y_3-y_2}{h_2})$\n    $$1 \\cdot M_2 + 2(1+2)M_3 + 2 \\cdot M_4 = 6\\left(\\frac{116-22}{2} - \\frac{22-5}{1}\\right) = 6(47-17)=180 \\implies M_2 + 6M_3 + 2M_4 = 180$$\n5.  Not-a-knot at $x_3$: $\\frac{M_3 - M_2}{1} = \\frac{M_4 - M_3}{2} \\implies 2(M_3 - M_2) = M_4 - M_3 \\implies -2M_2 + 3M_3 - M_4 = 0$.\n\nWe solve this $5 \\times 5$ system.\nFrom (1) and (2):\nAdd (1) to (2): $(-M_0 + 2M_1 - M_2) + (M_0 + 4M_1 + M_2) = 0 + 36 \\implies 6M_1 = 36 \\implies M_1 = 6$.\nSubstitute $M_1=6$ into (1): $-M_0 + 12 - M_2 = 0 \\implies M_2 = 12 - M_0$.\n\nFrom (5), we have $M_4 = 3M_3 - 2M_2$.\nSubstitute this into (4): $M_2 + 6M_3 + 2(3M_3 - 2M_2) = 180 \\implies M_2 + 6M_3 + 6M_3 - 4M_2 = 180 \\implies -3M_2 + 12M_3 = 180 \\implies -M_2 + 4M_3 = 60$.\n\nNow use (3) with $M_1=6$: $6 + 4M_2 + M_3 = 72 \\implies 4M_2 + M_3 = 66$.\n\nWe have a $2 \\times 2$ system for $M_2$ and $M_3$:\n(A) $4M_2 + M_3 = 66$\n(B) $-M_2 + 4M_3 = 60 \\implies M_2 = 4M_3 - 60$\nSubstitute (B) into (A): $4(4M_3 - 60) + M_3 = 66 \\implies 16M_3 - 240 + M_3 = 66 \\implies 17M_3 = 306 \\implies M_3 = 18$.\nThen $M_2 = 4(18) - 60 = 72 - 60 = 12$.\n\nNow we find the remaining moments:\nFrom $M_2 = 12 - M_0$, we have $12 = 12 - M_0 \\implies M_0 = 0$.\nFrom $M_4 = 3M_3 - 2M_2$, we have $M_4 = 3(18) - 2(12) = 54 - 24 = 30$.\n\nThe calculated moments are: $M_0=0$, $M_1=6$, $M_2=12$, $M_3=18$, $M_4=30$.\n\nNext, we explicitly verify the not-a-knot conditions as requested.\nCondition at $x_1=1$: Show $\\frac{M_1 - M_0}{h_0} = \\frac{M_2 - M_1}{h_1}$.\nLeft side: $\\frac{6-0}{1} = 6$.\nRight side: $\\frac{12-6}{1} = 6$.\nThe condition is satisfied. $S'''(x)=6$ for $x \\in [0,2]$.\n\nCondition at $x_3=3$: Show $\\frac{M_3 - M_2}{h_2} = \\frac{M_4 - M_3}{h_3}$.\nLeft side: $\\frac{18-12}{1} = 6$.\nRight side: $\\frac{30-18}{2} = \\frac{12}{2} = 6$.\nThe condition is satisfied. $S'''(x)=6$ for $x \\in [2,5]$.\nThis confirms the third derivative is continuous at $x_1$ and $x_3$.\n\nFinally, we evaluate the interpolant at $x=4$. The point $x=4$ lies in the interval $[x_3, x_4] = [3, 5]$, so we must use the expression for $S_3(x)$.\nThe needed parameters are: $i=3$, $x_3=3$, $y_3=22$, $x_4=5$, $y_4=116$, $h_3=2$, $M_3=18$, $M_4=30$.\n$$S_3(x) = \\frac{M_3}{6h_3}(x_4-x)^3 + \\frac{M_4}{6h_3}(x-x_3)^3 + \\left(y_3 - \\frac{M_3 h_3^2}{6}\\right)\\frac{x_4-x}{h_3} + \\left(y_4 - \\frac{M_4 h_3^2}{6}\\right)\\frac{x-x_3}{h_3}$$\nSubstitute the values:\n$$S_3(x) = \\frac{18}{6(2)}(5-x)^3 + \\frac{30}{6(2)}(x-3)^3 + \\left(22 - \\frac{18 \\cdot 2^2}{6}\\right)\\frac{5-x}{2} + \\left(116 - \\frac{30 \\cdot 2^2}{6}\\right)\\frac{x-3}{2}$$\n$$S_3(x) = \\frac{3}{2}(5-x)^3 + \\frac{5}{2}(x-3)^3 + \\left(22 - \\frac{72}{6}\\right)\\frac{5-x}{2} + \\left(116 - \\frac{120}{6}\\right)\\frac{x-3}{2}$$\n$$S_3(x) = \\frac{3}{2}(5-x)^3 + \\frac{5}{2}(x-3)^3 + (22 - 12)\\frac{5-x}{2} + (116 - 20)\\frac{x-3}{2}$$\n$$S_3(x) = \\frac{3}{2}(5-x)^3 + \\frac{5}{2}(x-3)^3 + 10\\frac{5-x}{2} + 96\\frac{x-3}{2}$$\n$$S_3(x) = \\frac{3}{2}(5-x)^3 + \\frac{5}{2}(x-3)^3 + 5(5-x) + 48(x-3)$$\nNow, we evaluate at $x=4$:\n$$S_3(4) = \\frac{3}{2}(5-4)^3 + \\frac{5}{2}(4-3)^3 + 5(5-4) + 48(4-3)$$\n$$S_3(4) = \\frac{3}{2}(1)^3 + \\frac{5}{2}(1)^3 + 5(1) + 48(1)$$\n$$S_3(4) = \\frac{3}{2} + \\frac{5}{2} + 5 + 48$$\n$$S_3(4) = \\frac{8}{2} + 53 = 4 + 53 = 57$$\nThe value of the interpolant at $x=4$ is $57$.", "answer": "$$\n\\boxed{57}\n$$", "id": "2424185"}, {"introduction": "A true mastery of any tool includes knowing its limitations. This final exercise challenges you to think critically about the boundaries of spline approximation using the pathological function $f(x) = \\sin(1/x)$ [@problem_id:2424126]. By analyzing why a continuous spline with a finite number of knots cannot uniformly approximate this function's infinite oscillations near the origin, you will develop a deeper appreciation for the theoretical underpinnings of approximation error and the crucial assumptions upon which they depend.", "problem": "Consider the function $f:(0,1]\\to\\mathbb{R}$ defined by $f(x)=\\sin(1/x)$ for $x\\in(0,1]$, and define $f(0)=0$ for reference when discussing norms on $[0,1]$. Let a spline of degree at most $p\\in\\mathbb{N}$ with $M\\in\\mathbb{N}_0$ interior knots be any function $s:[0,1]\\to\\mathbb{R}$ that is continuous on $[0,1]$ and such that there exist knots $0=\\xi_0<\\xi_1<\\cdots<\\xi_M<\\xi_{M+1}=1$ for which the restriction of $s$ to each open subinterval $(\\xi_j,\\xi_{j+1})$ is a polynomial of degree at most $p$. Define the mesh size $h=\\max_{0\\le j\\le M}(\\xi_{j+1}-\\xi_j)$.\n\nSelect all statements that are correct.\n\nA. For any fixed finite $M$ and $p$, no matter how the $M$ knots are placed in $(0,1)$, the infimum over all degree-$p$ splines with those $M$ knots of the uniform error on $(0,1]$ satisfies\n$$\\inf_{s}\\,\\sup_{x\\in(0,1]}\\,|f(x)-s(x)|\\ge 1.$$\n\nB. If the domain is restricted to $[\\delta,1]$ with any fixed $\\delta\\in(0,1)$, then for degree-$p$ splines with mesh size $h\\to 0$ on $[\\delta,1]$ and $f\\in C^{p+1}([\\delta,1])$, the best uniform approximation error decays on the order of $h^{p+1}$, i.e., there exists a constant $C(\\delta,p)>0$ such that\n$$\\inf_{s}\\,\\sup_{x\\in[\\delta,1]}\\,|f(x)-s(x)|\\le C(\\delta,p)\\,h^{p+1}.$$\n\nC. By moving a fixed finite set of $M$ knots increasingly close to $x=0$ (allowing $h\\to 0$ near $x=0$ but not increasing $M$), one can make the uniform error on $(0,1]$ arbitrarily small; that is, for any prescribed $\\varepsilon\\in(0,1)$ there exist knot locations and a degree-$p$ spline $s$ with $\\sup_{x\\in(0,1]}|f(x)-s(x)|\\le \\varepsilon$.\n\nD. To attain uniform error strictly less than $1$ on $(0,1]$ with a degree-$p$ spline approximation of $f$, it is necessary that the spline have an infinite number of knots that accumulate at $x=0$.\n\nE. In the least-squares (Lebesgue $L^2$) sense on $[0,1]$ with unit weight $w(x)\\equiv 1$, and with fixed finite $M$ and $p$, the optimal degree-$p$ spline error can be driven to $0$ by shifting the $M$ knots so that they increasingly cluster near $x=0$, even without increasing $M$.", "solution": "The problem statement is submitted for validation.\n\n### Step 1: Extract Givens\n\n-   Function definition: $f:(0,1]\\to\\mathbb{R}$ is defined by $f(x)=\\sin(1/x)$ for $x\\in(0,1]$.\n-   Reference value at $x=0$: $f(0)=0$.\n-   Spline definition: A function $s:[0,1]\\to\\mathbb{R}$ is a spline of degree at most $p\\in\\mathbb{N}$ with $M\\in\\mathbb{N}_0$ interior knots if:\n    1.  $s$ is continuous on $[0,1]$.\n    2.  There exist knots $0=\\xi_0<\\xi_1<\\cdots<\\xi_M<\\xi_{M+1}=1$.\n    3.  The restriction of $s$ to each open subinterval $(\\xi_j,\\xi_{j+1})$ is a polynomial of degree at most $p$.\n-   Mesh size: $h=\\max_{0\\le j\\le M}(\\xi_{j+1}-\\xi_j)$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem concerns the approximation of the function $f(x) = \\sin(1/x)$ using splines. This is a standard topic in approximation theory and computational engineering. The function $f(x)$ is a classic example of a function with pathological behavior at a point, specifically an essential singularity at $x=0$, leading to infinite oscillations as $x\\to 0^+$. The definition of a spline is standard for a $C^0$ piecewise polynomial. The questions posed relate to the convergence and error bounds of spline approximations in the uniform ($L^\\infty$) and least-squares ($L^2$) norms, which are well-defined mathematical concepts. The problem is self-contained, scientifically grounded in mathematical analysis, well-posed, and objective. It contains no contradictions, vagueness, or scientifically unsound premises.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. A full analysis of each statement will be performed.\n\n### Analysis of the Function and Spline Approximation\n\nThe function $f(x) = \\sin(1/x)$ exhibits infinite oscillation as $x \\to 0^+$. In any interval $(0, \\epsilon)$ for any $\\epsilon > 0$, $f(x)$ attains every value in $[-1, 1]$ infinitely many times. The function is continuous on $(0, 1]$, but at $x=0$, the limit $\\lim_{x\\to 0^+} f(x)$ does not exist. The provided definition $f(0)=0$ makes the function defined on $[0,1]$, but it is discontinuous at $x=0$.\n\nA spline $s(x)$ as defined is required to be continuous on the entire closed interval $[0,1]$. This implies that the limit $\\lim_{x\\to 0^+} s(x)$ must exist and be equal to $s(0)$. Let this value be $c$. On the first subinterval $(0, \\xi_1)$, the spline $s(x)$ is a polynomial $P_0(x)$ of degree at most $p$. Continuity at $x=0$ means $P_0(0) = s(0) = c$.\n\n### Option-by-Option Analysis\n\n**Statement A:** For any fixed finite $M$ and $p$, no matter how the $M$ knots are placed in $(0,1)$, the infimum over all degree-$p$ splines with those $M$ knots of the uniform error on $(0,1]$ satisfies $\\inf_{s}\\,\\sup_{x\\in(0,1]}\\,|f(x)-s(x)|\\ge 1.$\n\nLet $s(x)$ be any spline continuous on $[0,1]$. Let $s(0) = c$. By continuity, for any $\\delta > 0$, there exists an $\\eta > 0$ such that for all $x \\in [0, \\eta)$, $|s(x) - c| < \\delta$.\nThe function $f(x)=\\sin(1/x)$ oscillates between $-1$ and $1$ in any interval $(0, \\eta)$. Thus, we can find points $x_1, x_2 \\in (0, \\eta)$ such that $f(x_1) = 1$ and $f(x_2) = -1$.\nThe error at these points is $|f(x_1) - s(x_1)| = |1 - s(x_1)|$ and $|f(x_2) - s(x_2)| = |-1 - s(x_2)|$.\nUsing the triangle inequality, we can bound these from below:\n$|1 - s(x_1)| = |(1-c) - (s(x_1)-c)| \\ge |1-c| - |s(x_1)-c| > |1-c| - \\delta$.\n$|-1 - s(x_2)| = |(-1-c) - (s(x_2)-c)| \\ge |-1-c| - |s(x_2)-c| > |1+c| - \\delta$.\nThe uniform error is the supremum over the whole domain:\n$$ \\sup_{x\\in(0,1]} |f(x)-s(x)| \\ge \\max(|f(x_1)-s(x_1)|, |f(x_2)-s(x_2)|) > \\max(|1-c|-\\delta, |1+c|-\\delta) $$\nSince this holds for any $\\delta > 0$, we must have:\n$$ \\sup_{x\\in(0,1]} |f(x)-s(x)| \\ge \\max(|1-c|, |1+c|) $$\nThe expression $\\max(|1-c|, |1+c|)$ is minimized when $c=0$, where its value is $1$. For any $c \\in \\mathbb{R}$, $\\max(|1-c|, |1+c|) \\ge 1$.\nThus, for any spline $s(x)$ continuous on $[0,1]$, the uniform error is at least $1$. The infimum of a set of numbers all greater than or equal to $1$ must also be greater than or equal to $1$.\nThe statement is **Correct**.\n\n**Statement B:** If the domain is restricted to $[\\delta,1]$ with any fixed $\\delta\\in(0,1)$, then for degree-$p$ splines with mesh size $h\\to 0$ on $[\\delta,1]$ and $f\\in C^{p+1}([\\delta,1])$, the best uniform approximation error decays on the order of $h^{p+1}$, i.e., there exists a constant $C(\\delta,p)>0$ such that $\\inf_{s}\\,\\sup_{x\\in[\\delta,1]}\\,|f(x)-s(x)|\\le C(\\delta,p)\\,h^{p+1}.$\n\nOn the interval $[\\delta, 1]$ where $\\delta > 0$, the function $f(x)=\\sin(1/x)$ is infinitely differentiable. Its derivatives are of the form of sums of terms like $P(1/x)\\sin(1/x)$ and $Q(1/x)\\cos(1/x)$, where $P$ and $Q$ are polynomials. Since $x$ is bounded away from $0$ (i.e., $x \\ge \\delta > 0$), $1/x$ is bounded above by $1/\\delta$. Therefore, for any integer $k \\ge 0$, the $k$-th derivative $f^{(k)}(x)$ is continuous and bounded on $[\\delta, 1]$. In particular, $f \\in C^{p+1}([\\delta,1])$.\nA standard theorem in approximation theory states that for a function $g \\in C^{p+1}([a,b])$, there exists a spline approximant $s$ of degree $p$ such that the uniform error is bounded as:\n$$ \\sup_{x\\in[a,b]} |g(x)-s(x)| \\le K h^{p+1} $$\nwhere $h$ is the mesh size and $K$ is a constant that depends on $\\|g^{(p+1)}\\|_{\\infty, [a,b]}$.\nApplying this theorem to our function $f$ on the interval $[\\delta, 1]$ directly yields the result stated in this option. The constant $C(\\delta, p)$ would depend on the maximum value of $|f^{(p+1)}(x)|$ on $[\\delta,1]$, which is finite.\nThe statement is **Correct**.\n\n**Statement C:** By moving a fixed finite set of $M$ knots increasingly close to $x=0$ (allowing $h\\to 0$ near $x=0$ but not increasing $M$), one can make the uniform error on $(0,1]$ arbitrarily small; that is, for any prescribed $\\varepsilon\\in(0,1)$ there exist knot locations and a degree-$p$ spline $s$ with $\\sup_{x\\in(0,1]}|f(x)-s(x)|\\le \\varepsilon$.\n\nThis statement claims that the uniform error can be made less than any $\\varepsilon \\in (0,1)$, for instance $\\varepsilon = 1/2$. However, as proven in the analysis of statement A, the uniform error for any spline $s(x)$ that is continuous on $[0,1]$ is bounded below by $1$.\n$$ \\inf_{s}\\,\\sup_{x\\in(0,1]}\\,|f(x)-s(x)|\\ge 1 $$\nThis lower bound is independent of the number or placement of knots, as long as the spline is continuous on $[0,1]$. Therefore, it is impossible to make the uniform error arbitrarily small, and specifically, it is impossible to make it less than $1$.\nThe statement is **Incorrect**.\n\n**Statement D:** To attain uniform error strictly less than $1$ on $(0,1]$ with a degree-$p$ spline approximation of $f$, it is necessary that the spline have an infinite number of knots that accumulate at $x=0$.\n\nThis statement is of the logical form $P \\implies Q$, where:\n$P$: \"uniform error is strictly less than $1$\".\n$Q$: \"the spline has an infinite number of knots that accumulate at $x=0$\".\nFrom the analysis of statement A, we know that for any spline $s$ as defined in the problem (continuous on $[0,1]$ with a finite number of knots $M$), the uniform error $\\sup_{x\\in(0,1]} |f(x)-s(x)|$ is always greater than or equal to $1$. Therefore, the premise $P$ is false for any spline under consideration.\nIn classical logic, an implication $P \\implies Q$ is true if the premise $P$ is false. This is known as a vacuous truth. Since it is impossible to attain a uniform error strictly less than $1$, any necessary condition for it is vacuously satisfied.\n\nAlternatively, let us analyze the statement from another perspective. The problem defines splines as having a finite number of knots, $M$. The condition $Q$ of having an infinite number of knots is thus false for any spline defined in the problem statement. The implication $P \\implies Q$ is logically equivalent to $\\neg P \\lor Q$. Since $Q$ is always false for the objects in question, this expression simplifies to $\\neg P$. The statement D is thus equivalent to asserting $\\neg P$, which means \"it is not possible to attain uniform error strictly less than $1$\". As we established in part A, this is a true statement.\nTherefore, despite its confusing phrasing, the statement is logically sound.\nThe statement is **Correct**.\n\n**Statement E:** In the least-squares (Lebesgue $L^2$) sense on $[0,1]$ with unit weight $w(x)\\equiv 1$, and with fixed finite $M$ and $p$, the optimal degree-$p$ spline error can be driven to $0$ by shifting the $M$ knots so that they increasingly cluster near $x=0$, even without increasing $M$.\n\nLet us consider the consequence of clustering all $M$ interior knots near $x=0$. This means for any $\\delta > 0$, we can choose the knot locations $\\xi_1, \\dots, \\xi_M$ such that $0 < \\xi_1 < \\dots < \\xi_M < \\delta$.\nUnder this arrangement, the spline $s(x)$ consists of $M$ polynomial pieces on $(0, \\xi_M)$ and one single polynomial piece on the interval $(\\xi_M, 1)$. Let this polynomial be $P(x)$.\nThe total $L^2$ error is given by $E_2^2(s) = \\int_0^1 |f(x) - s(x)|^2 dx$.\nThis error is certainly greater than or equal to the error over any subinterval:\n$$ E_2^2(s) \\ge \\int_\\delta^1 |f(x) - s(x)|^2 dx $$\nSince $\\xi_M < \\delta$, on the interval $[\\delta, 1]$, our spline $s(x)$ is simply the polynomial $P(x)$. Thus:\n$$ E_2^2(s) \\ge \\int_\\delta^1 |f(x) - P(x)|^2 dx $$\nThe error can only be driven to $0$ if $\\int_\\delta^1 |f(x) - P(x)|^2 dx$ can be made arbitrarily small. However, $f(x)=\\sin(1/x)$ is not a polynomial on $[\\delta, 1]$. The set of polynomials of degree at most $p$ is a finite-dimensional subspace of $L^2([\\delta, 1])$. The best $L^2$ approximation of $f$ by such a polynomial results in a non-zero error, given by the norm of $f$ projected onto the orthogonal complement of this subspace.\nThis minimum error, $\\inf_{P} \\int_\\delta^1 |f(x) - P(x)|^2 dx$, is a fixed positive value for a given $\\delta$.\nBecause clustering the knots near $x=0$ leaves the entire interval $[\\delta, 1]$ to be approximated by a single polynomial, the contribution to the error from this interval cannot be made to approach zero. Therefore, the total $L^2$ error cannot be driven to $0$.\nThe statement is **Incorrect**.", "answer": "$$\\boxed{ABD}$$", "id": "2424126"}]}