{"hands_on_practices": [{"introduction": "To begin our practical exploration, we will analyze one of the most fundamental schemes: the Forward-Time Central-Space (FTCS) method. This exercise demonstrates that numerical stability is not merely a mathematical constraint but is deeply connected to the physical nature of the governing partial differential equation. By applying the same scheme to the well-posed heat equation and the ill-posed backward heat equation, you will see firsthand how a stable numerical method correctly reflects the underlying physics [@problem_id:2450098]. This practice provides a clear and foundational example of how the amplification factor reveals the behavior of a numerical scheme.", "problem": "Consider the one-dimensional Partial Differential Equation (PDE) $u_t=\\pm u_{xx}$ on a periodic domain, discretized on a uniform grid $x_j=j\\,\\Delta x$ and $t^n=n\\,\\Delta t$ with integers $j$ and $n$. Define the nondimensional parameter $r=\\Delta t/\\Delta x^2$. The Forward-Time Central-Space (FTCS) scheme applied to each sign choice yields the following two-level explicit updates:\n- For $u_t=+u_{xx}$: $u_j^{n+1}=u_j^n+r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$.\n- For $u_t=-u_{xx}$: $u_j^{n+1}=u_j^n-r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$.\n\nUsing the concept of a Fourier-mode amplification factor for this linear scheme under periodic boundary conditions, which option correctly explains why the same discrete stencil can be stable for $u_t=+u_{xx}$ (for some range of $r$) but is unstable for $u_t=-u_{xx}$ for any positive $r$?\n\nA. For $u_t=+u_{xx}$, the amplification factor is $G(\\theta)=1-4r\\sin^2(\\theta/2)$, so $|G(\\theta)|\\le 1$ for all $\\theta$ if and only if $0\\le r\\le 1/2$. For $u_t=-u_{xx}$, the amplification factor is $G(\\theta)=1+4r\\sin^2(\\theta/2)$, which satisfies $G(\\theta)>1$ for any nonzero mode when $r>0$, hence the scheme is unstable.\n\nB. For $u_t=+u_{xx}$, the amplification factor is $G(\\theta)=1+4r\\sin^2(\\theta/2)$, so it exceeds $1$ for nonzero modes and is unstable; for $u_t=-u_{xx}$, it is $G(\\theta)=1-4r\\sin^2(\\theta/2)$ and is therefore stable when $0\\le r\\le 1/2$.\n\nC. The amplification factor is the same for both sign choices, but the local truncation error is smaller for $u_t=+u_{xx}$ than for $u_t=-u_{xx}$, which explains stability in the former and instability in the latter.\n\nD. The scheme is unconditionally stable for both sign choices because the central spatial difference yields purely imaginary Fourier symbols, so $|G(\\theta)|\\le 1$ for all $r>0$ and all $\\theta$.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Partial Differential Equations (PDEs): $u_t = +u_{xx}$ and $u_t = -u_{xx}$.\n- Domain: One-dimensional, periodic.\n- Discretization: Uniform grid $x_j=j\\,\\Delta x$ and $t^n=n\\,\\Delta t$ for integer $j$ and $n$.\n- Nondimensional parameter: $r=\\Delta t/\\Delta x^2$.\n- FTCS scheme for $u_t = +u_{xx}$: $u_j^{n+1}=u_j^n+r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$.\n- FTCS scheme for $u_t = -u_{xx}$: $u_j^{n+1}=u_j^n-r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$.\n- Question: Explain why the scheme can be stable for $u_t = +u_{xx}$ but is unstable for $u_t = -u_{xx}$ using the Fourier-mode amplification factor.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem concerns the stability analysis of the Forward-Time Central-Space (FTCS) finite difference scheme, a fundamental topic in numerical analysis for PDEs. The PDEs are the heat equation ($u_t = u_{xx}$), which propagates information forward in time, and the backward heat equation ($u_t = -u_{xx}$), which is known to be ill-posed for initial value problems. The analysis of how a numerical scheme reflects the well-posedness of the underlying PDE is a critical and standard scientific inquiry.\n- **Well-Posedness**: The problem provides all necessary information to perform a von Neumann stability analysis. The question is specific, asking for an explanation based on the amplification factor, and a unique, technically correct answer can be derived.\n- **Objectivity**: The language is objective and technical, with no subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is scientifically sound, well-posed, objective, and self-contained. I will proceed with the solution.\n\nThe stability of a linear finite difference scheme with constant coefficients on a periodic domain is determined by the von Neumann stability analysis. We consider a single Fourier mode of the numerical solution of the form $u_j^n = \\hat{u}^n(k) e^{ikx_j}$, where $k$ is the wavenumber. Substituting $x_j = j \\Delta x$, this becomes $u_j^n = \\hat{u}^n e^{ij\\theta}$, where $\\theta = k\\Delta x$ is the dimensionless wavenumber or phase angle per grid cell. The evolution of the mode's amplitude is given by $\\hat{u}^{n+1} = G(\\theta)\\hat{u}^n$, where $G(\\theta)$ is the amplification factor. For a stable scheme, it is necessary that $|G(\\theta)| \\le 1$ for all values of $\\theta \\in [-\\pi, \\pi]$.\n\n**Case 1: The Heat Equation, $u_t = +u_{xx}$**\nThe discrete scheme is $u_j^{n+1} = u_j^n + r(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$.\nSubstitute the Fourier mode $u_j^n = G(\\theta)^n e^{ij\\theta}$ into the scheme (we can use $A^n$ for the amplitude instead of $G^n$, and find $G=A^{n+1}/A^n$):\n$G(\\theta) \\hat{u}^n e^{ij\\theta} = \\hat{u}^n e^{ij\\theta} + r \\left( \\hat{u}^n e^{i(j+1)\\theta} - 2\\hat{u}^n e^{ij\\theta} + \\hat{u}^n e^{i(j-1)\\theta} \\right)$.\nDividing by the common non-zero factor $\\hat{u}^n e^{ij\\theta}$ yields the amplification factor:\n$G(\\theta) = 1 + r \\left( e^{i\\theta} - 2 + e^{-i\\theta} \\right)$.\nUsing the identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$, this simplifies to:\n$G(\\theta) = 1 + r(2\\cos\\theta - 2) = 1 + 2r(\\cos\\theta - 1)$.\nUsing the half-angle identity $\\cos\\theta - 1 = -2\\sin^2(\\theta/2)$:\n$G(\\theta) = 1 - 4r\\sin^2(\\theta/2)$.\n\nFor stability, we require $|G(\\theta)| \\le 1$.\nSince $r > 0$ and $\\sin^2(\\theta/2) \\ge 0$, the term $4r\\sin^2(\\theta/2)$ is non-negative.\nThus, $G(\\theta) = 1 - (\\text{a non-negative quantity}) \\le 1$. This condition is always satisfied.\nThe second part of the stability requirement is $G(\\theta) \\ge -1$:\n$1 - 4r\\sin^2(\\theta/2) \\ge -1$\n$2 \\ge 4r\\sin^2(\\theta/2)$\n$r\\sin^2(\\theta/2) \\le 1/2$.\nThis inequality must hold for all $\\theta$. The maximum value of $\\sin^2(\\theta/2)$ is $1$, which occurs for the most oscillatory mode $\\theta = \\pm \\pi$. Therefore, the condition becomes:\n$r \\le 1/2$.\nThe scheme is conditionally stable for $0 < r \\le 1/2$.\n\n**Case 2: The Backward Heat Equation, $u_t = -u_{xx}$**\nThe discrete scheme is $u_j^{n+1} = u_j^n - r(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$.\nFollowing the same procedure, we substitute the Fourier mode:\n$G(\\theta) \\hat{u}^n e^{ij\\theta} = \\hat{u}^n e^{ij\\theta} - r \\left( \\hat{u}^n e^{i(j+1)\\theta} - 2\\hat{u}^n e^{ij\\theta} + \\hat{u}^n e^{i(j-1)\\theta} \\right)$.\nDividing by $\\hat{u}^n e^{ij\\theta}$:\n$G(\\theta) = 1 - r \\left( e^{i\\theta} - 2 + e^{-i\\theta} \\right)$\n$G(\\theta) = 1 - 2r(\\cos\\theta - 1)$\n$G(\\theta) = 1 + 4r\\sin^2(\\theta/2)$.\n\nFor stability, we require $|G(\\theta)| \\le 1$.\nGiven $r > 0$. For any non-zero mode, i.e., $\\theta \\ne 0$, we have $\\sin^2(\\theta/2) > 0$.\nThis implies $4r\\sin^2(\\theta/2) > 0$.\nTherefore, $G(\\theta) = 1 + (\\text{a positive quantity}) > 1$.\nSince $|G(\\theta)| > 1$ for any spatially varying mode, any small perturbation will be amplified exponentially in time. The scheme is unconditionally unstable for any $r > 0$.\nThis correctly reflects the ill-posed nature of the continuous backward heat equation.\n\nNow, we evaluate the provided options.\n\n**A.** For $u_t=+u_{xx}$, the amplification factor is $G(\\theta)=1-4r\\sin^2(\\theta/2)$, so $|G(\\theta)|\\le 1$ for all $\\theta$ if and only if $0\\le r\\le 1/2$. For $u_t=-u_{xx}$, the amplification factor is $G(\\theta)=1+4r\\sin^2(\\theta/2)$, which satisfies $G(\\theta)>1$ for any nonzero mode when $r>0$, hence the scheme is unstable.\nThis statement precisely matches the derivation performed above. The expressions for both amplification factors are correct, and the resulting stability conditions are correct.\n**Verdict: Correct.**\n\n**B.** For $u_t=+u_{xx}$, the amplification factor is $G(\\theta)=1+4r\\sin^2(\\theta/2)$, so it exceeds $1$ for nonzero modes and is unstable; for $u_t=-u_{xx}$, it is $G(\\theta)=1-4r\\sin^2(\\theta/2)$ and is therefore stable when $0\\le r\\le 1/2$.\nThis option incorrectly swaps the amplification factors and stability conclusions between the two PDEs. The heat equation ($u_t=+u_{xx}$) is assigned the amplification factor for the backward heat equation, and vice versa.\n**Verdict: Incorrect.**\n\n**C.** The amplification factor is the same for both sign choices, but the local truncation error is smaller for $u_t=+u_{xx}$ than for $u_t=-u_{xx}$, which explains stability in the former and instability in the latter.\nAs derived, the amplification factor for $u_t=+u_{xx}$ is $1-4r\\sin^2(\\theta/2)$ and for $u_t=-u_{xx}$ is $1+4r\\sin^2(\\theta/2)$. These are not the same. The premise of the option is factually wrong. Stability is determined by the amplification factor, not a comparison of truncation errors.\n**Verdict: Incorrect.**\n\n**D.** The scheme is unconditionally stable for both sign choices because the central spatial difference yields purely imaginary Fourier symbols, so $|G(\\theta)|\\le 1$ for all $r>0$ and all $\\theta$.\nThis option makes several false claims. First, the scheme is not unconditionally stable for both cases; one is conditionally stable and the other is unconditionally unstable. Second, the Fourier symbol of the second-order central difference operator $\\frac{1}{\\Delta x^2}(u_{j+1}-2u_j+u_{j-1})$ is $\\frac{1}{\\Delta x^2}(e^{i\\theta}-2+e^{-i\\theta}) = \\frac{-4}{\\Delta x^2}\\sin^2(\\theta/2)$, which is purely real and non-positive, not purely imaginary. Purely imaginary symbols arise from central difference approximations to first-order derivatives.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2450098"}, {"introduction": "Building on the concept of conditional stability, we now investigate a more flexible and powerful tool: the $\\theta$-scheme. This method provides a unified framework that includes the explicit Forward Euler, the implicit Backward Euler, and the balanced Crank-Nicolson schemes by varying a single parameter, $\\theta$. This hands-on practice will guide you through deriving the stability constraints for this entire family of schemes, culminating in the discovery of the threshold for unconditional stability [@problem_id:2450103]. Mastering this concept is essential for tackling problems where the stability limit of explicit methods would require impractically small time steps.", "problem": "Consider the heat equation $u_{t}=\\kappa u_{xx}$ on a periodic domain with spatial grid spacing $\\Delta x$ and time step $\\Delta t$, where $\\kappa>0$ is the thermal diffusivity. Define the central second-difference operator $\\delta_{xx}u_{j}^{n}=\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right)/\\Delta x^{2}$, and consider the $\\theta$-scheme (a weighted average of Forward Euler and Backward Euler) given by\n$$(u_{j}^{n+1}-u_{j}^{n})/\\Delta t=\\kappa\\left[\\theta\\,\\delta_{xx}u_{j}^{n+1}+(1-\\theta)\\,\\delta_{xx}u_{j}^{n}\\right],$$\nwith weight parameter $\\theta\\in\\mathbb{R}$. Using von Neumann stability analysis (Fourier mode analysis) with modes $u_{j}^{n}=\\hat{u}\\,G^{n}\\exp(i j \\xi)$, where $\\xi\\in[-\\pi,\\pi]$ is the nondimensional wave number measured in radians and $i^{2}=-1$, derive the amplification factor $G(\\xi,\\theta,\\kappa,\\Delta t,\\Delta x)$ and determine for which values of $\\theta$ the scheme is unconditionally stable, meaning $|G|\\leq 1$ for all $\\xi\\in[-\\pi,\\pi]$ and for all ratios $r=\\kappa\\,\\Delta t/\\Delta x^{2}\\ge 0$.\n\nReport your final answer as the minimal value of $\\theta$ that guarantees unconditional stability. Express your answer as a single simplified rational number. No rounding is required and no units are needed in the final answer.", "solution": "The problem statement is coherent, scientifically grounded, and well-posed. We proceed with the derivation.\n\nThe given $\\theta$-scheme for the heat equation is:\n$$ \\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\kappa\\left[\\theta\\,\\delta_{xx}u_{j}^{n+1}+(1-\\theta)\\,\\delta_{xx}u_{j}^{n}\\right] $$\nwhere $\\delta_{xx}$ is the central second-difference operator. Substituting the definition of $\\delta_{xx}$ yields:\n$$ \\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta \\left( u_{j+1}^{n+1} - 2u_{j}^{n+1} + u_{j-1}^{n+1} \\right) + (1-\\theta) \\left( u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n} \\right) \\right] $$\nTo perform the von Neumann stability analysis, we introduce the Fourier mode ansatz $u_{j}^{n} = G^{n} \\exp(i j \\xi)$, where $G$ is the amplification factor, $n$ is the time index, $j$ is the spatial index, $\\xi$ is the dimensionless wave number, and $i^{2}=-1$. We have dropped the constant amplitude $\\hat{u}$ as it cancels out.\n\nSubstituting this ansatz into the scheme involves the following relations:\n$u_{j}^{n+1} = G u_{j}^{n}$\n$u_{j\\pm 1}^{n} = \\exp(\\pm i \\xi) u_{j}^{n}$\n$u_{j\\pm 1}^{n+1} = G \\exp(\\pm i \\xi) u_{j}^{n}$\n\nSubstituting these into the discretized equation:\n$$ \\frac{G u_{j}^{n} - u_{j}^{n}}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta G \\left( e^{i\\xi} - 2 + e^{-i\\xi} \\right)u_{j}^{n} + (1-\\theta) \\left( e^{i\\xi} - 2 + e^{-i\\xi} \\right)u_{j}^{n} \\right] $$\nAssuming a non-trivial solution, we can divide by $u_{j}^{n}$:\n$$ \\frac{G - 1}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta G ( e^{i\\xi} + e^{-i\\xi} - 2 ) + (1-\\theta) ( e^{i\\xi} + e^{-i\\xi} - 2 ) \\right] $$\nUsing the identity $e^{i\\xi} + e^{-i\\xi} = 2\\cos(\\xi)$, the term in parentheses becomes $2\\cos(\\xi) - 2 = -2(1-\\cos(\\xi))$. Using the half-angle identity $1-\\cos(\\xi) = 2\\sin^{2}(\\xi/2)$, this term is equal to $-4\\sin^{2}(\\xi/2)$.\nThe equation for $G$ becomes:\n$$ \\frac{G-1}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left( -4\\sin^{2}(\\xi/2) \\right) \\left[ \\theta G + (1-\\theta) \\right] $$\nLet $r = \\kappa \\Delta t / \\Delta x^{2}$ be the Courant-Friedrichs-Lewy (CFL) number, or more specifically, the diffusion number.\n$$ G - 1 = -4r \\sin^{2}(\\xi/2) \\left[ \\theta G + 1 - \\theta \\right] $$\nWe must now solve for the amplification factor $G$:\n$$ G - 1 = -4r\\theta G \\sin^{2}(\\xi/2) - 4r(1-\\theta)\\sin^{2}(\\xi/2) $$\n$$ G \\left( 1 + 4r\\theta \\sin^{2}(\\xi/2) \\right) = 1 - 4r(1-\\theta)\\sin^{2}(\\xi/2) $$\n$$ G = \\frac{1 - 4r(1-\\theta)\\sin^{2}(\\xi/2)}{1 + 4r\\theta\\sin^{2}(\\xi/2)} $$\nFor unconditional stability, the magnitude of the amplification factor must satisfy $|G| \\le 1$ for all values of $r \\ge 0$ and for all wave numbers $\\xi \\in [-\\pi, \\pi]$. Let $S = 4r\\sin^{2}(\\xi/2)$. Since $r \\ge 0$ and $\\sin^{2}(\\xi/2) \\ge 0$, the domain for $S$ is $[0, \\infty)$. The expression for $G$ becomes:\n$$ G = \\frac{1 - (1-\\theta)S}{1 + \\theta S} $$\nThe stability condition is $|G| \\leq 1$, which is equivalent to:\n$$ |1 - (1-\\theta)S| \\leq |1 + \\theta S| $$\nWe must analyze this inequality for all $S \\ge 0$. Note that if the denominator $1 + \\theta S$ becomes zero for some $S > 0$, the scheme is ill-defined and unstable. This occurs if $\\theta < 0$. If $\\theta < 0$, let $\\theta = -\\beta$ where $\\beta > 0$. The denominator is $1 - \\beta S$. For $S = 1/\\beta$, the denominator is zero. Thus, for unconditional stability, we must have $\\theta \\ge 0$.\n\nAssuming $\\theta \\ge 0$, the denominator $1 + \\theta S$ is always positive (it is $1$ for $S=0$ and greater than $1$ for $S>0$). Thus we can multiply by it:\n$$ - (1 + \\theta S) \\leq 1 - (1-\\theta)S \\leq 1 + \\theta S $$\nThis compound inequality consists of two parts.\n\nFirst, the right-hand side inequality:\n$$ 1 - (1-\\theta)S \\leq 1 + \\theta S $$\n$$ -(1-\\theta)S \\leq \\theta S $$\n$$ -S + \\theta S \\leq \\theta S $$\n$$ -S \\leq 0 $$\nSince we defined $S = 4r\\sin^{2}(\\xi/2) \\ge 0$, this inequality is always satisfied for any $\\theta$.\n\nSecond, the left-hand side inequality:\n$$ -(1 + \\theta S) \\leq 1 - (1-\\theta)S $$\n$$ -1 - \\theta S \\leq 1 - S + \\theta S $$\n$$ 0 \\leq 2 - S + 2\\theta S $$\n$$ 0 \\leq 2 + (2\\theta - 1)S $$\nThis inequality must hold for all $S \\in [0, \\infty)$.\nIf the coefficient of $S$ is non-negative, i.e., $2\\theta - 1 \\ge 0$, then the term $(2\\theta - 1)S$ is non-negative for all $S \\ge 0$. The inequality $2 + (\\text{non-negative quantity}) \\ge 0$ is always true. Therefore, the scheme is unconditionally stable if $2\\theta - 1 \\ge 0$, which implies $\\theta \\ge 1/2$.\n\nIf the coefficient of $S$ is negative, i.e., $2\\theta - 1 < 0$ (or $\\theta < 1/2$), the inequality becomes $ (1-2\\theta)S \\le 2 $, or $S \\le \\frac{2}{1-2\\theta}$. This imposes a condition on $S = 4r\\sin^{2}(\\xi/2)$, meaning the stability is conditional on $r$. This violates the requirement of unconditional stability.\n\nThus, the condition for unconditional stability is $\\theta \\ge 1/2$. The problem asks for the minimal value of $\\theta$ that guarantees this. This minimal value is precisely when the coefficient of $S$ becomes non-negative.\n\nThe minimal value of $\\theta$ is $1/2$.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2450103"}, {"introduction": "The power of Von Neumann analysis extends to more complex, multi-step methods and different classes of PDEs. In this problem, we shift our focus from the parabolic heat equation to the hyperbolic advection equation and analyze the stability of the widely used MacCormack predictor-corrector scheme. This exercise will challenge you to apply the analysis to a two-step process, demonstrating how to derive a single amplification factor for the entire time step [@problem_id:2450092]. Successfully completing this analysis will solidify your ability to assess the stability of sophisticated schemes used in computational fluid dynamics and other fields.", "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a > 0$ on a periodic, uniform, $1$-dimensional spatial grid $x_{j} = j\\,\\Delta x$ and time levels $t^{n} = n\\,\\Delta t$. Let $u_{j}^{n}$ denote the numerical approximation to $u(x_{j}, t^{n})$. The MacCormack predictor–corrector scheme advances $u_{j}^{n}$ to $u_{j}^{n+1}$ via\n$$\n\\text{Predictor:}\\quad u_{j}^{\\ast} = u_{j}^{n} - a\\,\\frac{\\Delta t}{\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right),\n$$\n$$\n\\text{Corrector:}\\quad u_{j}^{n+1} = \\frac{1}{2}\\left[u_{j}^{n} + u_{j}^{\\ast} - a\\,\\frac{\\Delta t}{\\Delta x}\\left(u_{j}^{\\ast} - u_{j-1}^{\\ast}\\right)\\right].\n$$\nDefine the Courant–Friedrichs–Lewy (CFL) number $C = a\\,\\Delta t/\\Delta x$. Assume periodic boundary conditions so that discrete Fourier modes are admissible.\n\nDetermine the largest value of $C$ such that, for every discrete wavenumber $\\theta \\in [-\\pi,\\pi]$, the magnitude of the single-step amplification factor does not exceed $1$. Provide your answer as a single real number. No rounding is required.", "solution": "The problem requires the determination of the stability limit for the MacCormack scheme applied to the linear advection equation, $u_{t} + a\\,u_{x} = 0$, where $a > 0$ is a constant wave speed. The stability will be assessed using the von Neumann stability analysis method.\n\nThe MacCormack scheme is given by a two-step predictor-corrector process. First, the predictor step is:\n$$\nu_{j}^{\\ast} = u_{j}^{n} - C\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\n$$\nwhere $C = a\\,\\frac{\\Delta t}{\\Delta x}$ is the Courant–Friedrichs–Lewy (CFL) number. The corrector step is:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left[u_{j}^{n} + u_{j}^{\\ast} - C\\left(u_{j}^{\\ast} - u_{j-1}^{\\ast}\\right)\\right]\n$$\nTo perform the von Neumann analysis, we consider the behavior of a single Fourier mode of the numerical solution. We posit a solution of the form $u_{j}^{n} = \\hat{u}^{n} \\exp(i k x_{j})$, where $k$ is the wavenumber. On a discrete grid, this becomes $u_{j}^{n} = \\hat{u}^{n} \\exp(i \\theta j)$, where $\\theta = k \\Delta x$ is the dimensionless wavenumber or phase angle, which varies in the range $[-\\pi, \\pi]$. The amplification factor, $G(\\theta)$, is defined by the relation $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^{n}$.\n\nWe first substitute the Fourier mode into the predictor step. The terms $u_{j+1}^{n}$ and $u_{j-1}^{n}$ are expressed as:\n$$\nu_{j+1}^{n} = \\hat{u}^{n} \\exp(i \\theta (j+1)) = u_{j}^{n} \\exp(i \\theta)\n$$\n$$\nu_{j-1}^{n} = \\hat{u}^{n} \\exp(i \\theta (j-1)) = u_{j}^{n} \\exp(-i \\theta)\n$$\nThe intermediate solution $u_{j}^{\\ast}$ will also have a Fourier representation, $u_{j}^{\\ast} = \\hat{u}^{\\ast} \\exp(i \\theta j)$. Substituting these forms into the predictor equation yields:\n$$\n\\hat{u}^{\\ast} \\exp(i \\theta j) = \\hat{u}^{n} \\exp(i \\theta j) - C \\left(\\hat{u}^{n} \\exp(i \\theta (j+1)) - \\hat{u}^{n} \\exp(i \\theta j)\\right)\n$$\nDividing by $\\exp(i \\theta j)$ gives the amplitude of the predicted solution:\n$$\n\\hat{u}^{\\ast} = \\hat{u}^{n} - C \\left(\\hat{u}^{n} \\exp(i \\theta) - \\hat{u}^{n}\\right) = \\hat{u}^{n} \\left(1 - C(\\exp(i \\theta) - 1)\\right)\n$$\nNext, we substitute the Fourier modes into the corrector step:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left[u_{j}^{n} + u_{j}^{\\ast} - C\\left(u_{j}^{\\ast} - u_{j-1}^{\\ast}\\right)\\right]\n$$\nThis translates to the amplitudes as:\n$$\n\\hat{u}^{n+1} = \\frac{1}{2}\\left[\\hat{u}^{n} + \\hat{u}^{\\ast} - C\\left(\\hat{u}^{\\ast} - \\hat{u}^{\\ast} \\exp(-i \\theta)\\right)\\right]\n$$\n$$\n\\hat{u}^{n+1} = \\frac{1}{2}\\left[\\hat{u}^{n} + \\hat{u}^{\\ast}\\left(1 - C(1 - \\exp(-i \\theta))\\right)\\right]\n$$\nNow, we substitute the expression for $\\hat{u}^{\\ast}$ in terms of $\\hat{u}^{n}$:\n$$\n\\hat{u}^{n+1} = \\frac{1}{2}\\left[\\hat{u}^{n} + \\hat{u}^{n}\\left(1 - C(\\exp(i \\theta) - 1)\\right) \\left(1 - C(1 - \\exp(-i \\theta))\\right)\\right]\n$$\nThe amplification factor $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^{n}$ is therefore:\n$$\nG(\\theta) = \\frac{1}{2}\\left[1 + \\left(1 - C(\\exp(i \\theta) - 1)\\right) \\left(1 - C(1 - \\exp(-i \\theta))\\right)\\right]\n$$\nLet us expand the product term inside the bracket:\n$$\n\\left(1 - C(\\exp(i \\theta) - 1)\\right) \\left(1 - C(1 - \\exp(-i \\theta))\\right) = 1 - C(1 - \\exp(-i \\theta)) - C(\\exp(i \\theta) - 1) + C^{2}(\\exp(i \\theta) - 1)(1 - \\exp(-i \\theta))\n$$\n$$\n= 1 - C + C\\exp(-i \\theta) - C\\exp(i \\theta) + C + C^{2}(\\exp(i \\theta) - 1-1 + \\exp(-i\\theta))\n$$\n$$\n= 1 - C(\\exp(i \\theta) - \\exp(-i \\theta)) + C^{2}(\\exp(i \\theta) + \\exp(-i \\theta) - 2)\n$$\nUsing Euler's identities, $\\exp(i \\theta) - \\exp(-i \\theta) = 2i\\sin(\\theta)$ and $\\exp(i \\theta) + \\exp(-i \\theta) = 2\\cos(\\theta)$, the expression becomes:\n$$\n1 - C(2i\\sin(\\theta)) + C^{2}(2\\cos(\\theta) - 2) = 1 - 2iC\\sin(\\theta) + 2C^{2}(\\cos(\\theta) - 1)\n$$\nSubstituting this back into the expression for $G(\\theta)$:\n$$\nG(\\theta) = \\frac{1}{2}\\left[1 + 1 - 2iC\\sin(\\theta) + 2C^{2}(\\cos(\\theta) - 1)\\right] = 1 - iC\\sin(\\theta) + C^{2}(\\cos(\\theta) - 1)\n$$\nThe amplification factor is a complex number, $G(\\theta) = \\left(1 + C^{2}(\\cos(\\theta) - 1)\\right) - i\\left(C\\sin(\\theta)\\right)$. For the scheme to be stable, the magnitude of the amplification factor must not exceed $1$ for any wavenumber $\\theta$, i.e., $|G(\\theta)| \\le 1$. This is equivalent to $|G(\\theta)|^{2} \\le 1$.\n$$\n|G(\\theta)|^{2} = \\left(1 + C^{2}(\\cos(\\theta) - 1)\\right)^{2} + \\left(-C\\sin(\\theta)\\right)^{2} \\le 1\n$$\n$$\n1 + 2C^{2}(\\cos(\\theta) - 1) + C^{4}(\\cos(\\theta) - 1)^{2} + C^{2}\\sin^{2}(\\theta) \\le 1\n$$\nSubtracting $1$ from both sides and dividing by $C^{2}$ (since $C>0$):\n$$\n2(\\cos(\\theta) - 1) + C^{2}(\\cos(\\theta) - 1)^{2} + \\sin^{2}(\\theta) \\le 0\n$$\nUsing the identity $\\sin^{2}(\\theta) = 1 - \\cos^{2}(\\theta) = (1 - \\cos(\\theta))(1 + \\cos(\\theta))$, we can rewrite the inequality:\n$$\n-2(1 - \\cos(\\theta)) + C^{2}(1 - \\cos(\\theta))^{2} + (1 - \\cos(\\theta))(1 + \\cos(\\theta)) \\le 0\n$$\nFactor out the term $(1 - \\cos(\\theta))$, which is non-negative:\n$$\n(1 - \\cos(\\theta)) \\left[-2 + C^{2}(1 - \\cos(\\theta)) + (1 + \\cos(\\theta))\\right] \\le 0\n$$\n$$\n(1 - \\cos(\\theta)) \\left[-1 + \\cos(\\theta) + C^{2}(1 - \\cos(\\theta))\\right] \\le 0\n$$\n$$\n(1 - \\cos(\\theta)) \\left[-(1 - \\cos(\\theta)) + C^{2}(1 - \\cos(\\theta))\\right] \\le 0\n$$\n$$\n(1 - \\cos(\\theta))^{2} (C^{2} - 1) \\le 0\n$$\nThe term $(1 - \\cos(\\theta))^{2}$ is always non-negative for any real $\\theta$. For the product to be less than or equal to zero for all $\\theta \\in [-\\pi, \\pi]$, the other factor, $(C^{2} - 1)$, must be non-positive.\n$$\nC^{2} - 1 \\le 0 \\implies C^{2} \\le 1\n$$\nGiven that $C = a \\frac{\\Delta t}{\\Delta x}$ where $a, \\Delta t, \\Delta x$ are all positive quantities, $C$ must be positive. Therefore, the stability condition is $0 < C \\le 1$.\nThe problem asks for the largest value of $C$ for which the stability condition holds. This value is $1$.", "answer": "$$\\boxed{1}$$", "id": "2450092"}]}