{"hands_on_practices": [{"introduction": "The best way to understand a new numerical technique is to apply it step-by-step. This first practice focuses on the fundamental mechanics of Heun's method. By working through a single step for a given ordinary differential equation, you will gain hands-on experience with the two-stage predictor-corrector process that defines this powerful scheme. [@problem_id:2202828]", "problem": "Consider the first-order ordinary differential equation (ODE) given by $y'(t) = \\sin(t) - \\frac{y(t)}{t+1}$, which describes a system with a time-varying input and a time-dependent decay rate. We are given the initial condition $y(0) = 2$. We wish to approximate the value of $y(0.1)$ using a single step of Heun's method. The argument of the sine function is in radians.\n\nHeun's method is a predictor-corrector algorithm for solving an initial value problem of the form $y' = f(t,y)$, with $y(t_0) = y_0$. For a given step size $h$, the approximation at the next time step, $y_1 \\approx y(t_0+h)$, is computed in two stages:\n\n1.  **Predictor Step**: An intermediate value, $\\tilde{y}_1$, is estimated using Euler's method:\n    $$ \\tilde{y}_1 = y_0 + h f(t_0, y_0) $$\n2.  **Corrector Step**: The final approximation, $y_1$, is calculated by averaging the slope at the initial point $(t_0, y_0)$ and the slope at the estimated point $(t_1, \\tilde{y}_1)$, where $t_1 = t_0 + h$:\n    $$ y_1 = y_0 + \\frac{h}{2} \\left[ f(t_0, y_0) + f(t_1, \\tilde{y}_1) \\right] $$\n\nUsing a single step, calculate the numerical approximation for $y(0.1)$. Round your final answer to four significant figures.", "solution": "We are given the ODE $y'(t)=\\sin(t)-\\dfrac{y(t)}{t+1}$ with $y(0)=2$ and seek $y(0.1)$ using one Heun step of size $h=0.1$. Define $f(t,y)=\\sin(t)-\\dfrac{y}{t+1}$.\n\nAt the initial point $(t_{0},y_{0})=(0,2)$, compute the slope:\n$$\nf(t_{0},y_{0})=f(0,2)=\\sin(0)-\\frac{2}{0+1}=0-2=-2.\n$$\n\nPredictor step (Euler):\n$$\n\\tilde{y}_{1}=y_{0}+h\\,f(t_{0},y_{0})=2+0.1\\cdot(-2)=1.8.\n$$\n\nEvaluate the slope at $(t_{1},\\tilde{y}_{1})$ with $t_{1}=t_{0}+h=0.1$:\n$$\nf(t_{1},\\tilde{y}_{1})=f(0.1,1.8)=\\sin(0.1)-\\frac{1.8}{1.1}.\n$$\nUsing radians, $\\sin(0.1)\\approx 0.0998334166$ and $\\dfrac{1.8}{1.1}\\approx 1.6363636364$, so\n$$\nf(t_{1},\\tilde{y}_{1})\\approx 0.0998334166 - 1.6363636364 \\approx -1.5365302198.\n$$\n\nCorrector step:\n$$\ny_{1}=y_{0}+\\frac{h}{2}\\Big(f(t_{0},y_{0})+f(t_{1},\\tilde{y}_{1})\\Big)\n=2+0.05\\left(-2 - 1.5365302198\\right) \\approx 2 - 0.176826511 \\approx 1.823173489.\n$$\n\nRounding to four significant figures gives $y(0.1)\\approx 1.823$.", "answer": "$$\\boxed{1.823}$$", "id": "2202828"}, {"introduction": "While predictor-corrector schemes are designed to improve accuracy, they are not universally foolproof. This exercise explores a crucial concept in computational engineering: numerical stability. By applying Heun's method to a \"stiff\" ordinary differential equation with a deliberately large step size, you will uncover a counter-intuitive scenario where the corrector step actually degrades the solution, highlighting the importance of choosing an appropriate step size. [@problem_id:2428207]", "problem": "Consider the initial value problem for the ordinary differential equation (ODE)\n$$\\frac{dy}{dt}=-10\\,y,\\qquad y(0)=1.$$\nAdvance the solution from $t=0$ to $t=0.5$ using a single two-stage explicit trapezoidal predictor–corrector step (Heun’s method) with step size $h=0.5$. Let $y_{E}$ denote the forward Euler predictor obtained at $t=0.5$, and let $y_{H}$ denote the corrected value at $t=0.5$ after applying the trapezoidal corrector. Let $y^{\\ast}$ denote the exact solution at $t=0.5$. Compute the ratio\n$$r=\\frac{|y_{H}-y^{\\ast}|}{|y_{E}-y^{\\ast}|}.$$\nRound your final answer to four significant figures. Do not include units.", "solution": "The initial value problem is given by the ordinary differential equation (ODE) $ \\frac{dy}{dt} = f(t, y) = -10y $ with the initial condition $y(0) = 1$. We are tasked to find the numerical solution at $t_1 = 0.5$ using one step of size $h = 0.5$, starting from $t_0 = 0$ and $y_0 = 1$.\n\nFirst, we determine the exact solution, denoted by $y^{\\ast}(t)$. The ODE is separable, leading to the solution $y(t) = A \\exp(-10t)$. Using the initial condition $y(0) = 1$, we find $A=1$. Thus, the exact solution is $y^{\\ast}(t) = \\exp(-10t)$. At $t=0.5$, the exact value is:\n$$ y^{\\ast} = y^{\\ast}(0.5) = \\exp(-10 \\cdot 0.5) = \\exp(-5) $$\n\nNext, we compute the forward Euler predictor value, $y_{E}$, at $t_1 = 0.5$. The method is given by $y_{n+1} = y_n + h f(t_n, y_n)$.\n$$ y_{E} = y_0 + h f(t_0, y_0) = 1 + (0.5)(-10 \\cdot 1) = 1 - 5 = -4 $$\n\nNow, we compute the corrected value, $y_{H}$, using Heun's method. The predictor step gives $\\tilde{y}_1 = y_E = -4$. For the corrector step, we need the slope at the start, $k_1 = f(0, 1) = -10$, and the slope at the predicted end, $k_2 = f(0.5, -4) = -10(-4) = 40$.\nThe corrected value $y_H$ is:\n$$ y_{H} = y_0 + \\frac{h}{2} (k_1 + k_2) = 1 + \\frac{0.5}{2} (-10 + 40) = 1 + (0.25)(30) = 1 + 7.5 = 8.5 $$\n\nFinally, we compute the ratio $r$ of the absolute errors.\nThe error of the corrected value is $|y_{H} - y^{\\ast}| = |8.5 - \\exp(-5)|$.\nThe error of the predictor (Euler) value is $|y_{E} - y^{\\ast}| = |-4 - \\exp(-5)| = 4 + \\exp(-5)$.\nThe ratio $r$ is:\n$$ r = \\frac{|y_{H} - y^{\\ast}|}{|y_{E} - y^{\\ast}|} = \\frac{|8.5 - \\exp(-5)|}{4 + \\exp(-5)} $$\nUsing the numerical value $\\exp(-5) \\approx 0.006737947$:\n$$ r = \\frac{8.5 - 0.006737947}{4 + 0.006737947} = \\frac{8.493262053}{4.006737947} \\approx 2.1197368 $$\nRounding the result to four significant figures, we get:\n$$ r \\approx 2.120 $$\nThis ratio, being greater than $1$, indicates that for this large step size, the corrector step increases the error relative to the predictor. This occurs because the step size $h=0.5$ gives $z = \\lambda h = -10 \\cdot 0.5 = -5$, which is outside the region of absolute stability for Heun's method, $[-2, 0]$.", "answer": "$$\\boxed{2.120}$$", "id": "2428207"}, {"introduction": "Having seen how Heun's method can fail, we now investigate the opposite extreme: when can it be perfect? This advanced problem challenges you to think deeply about the mathematical underpinnings of predictor-corrector schemes. By constructing an ordinary differential equation for which Heun's method is exact regardless of step size, you will uncover the fundamental connection between this method and the trapezoidal rule of integration, revealing the precise conditions for its ideal performance. [@problem_id:2428172]", "problem": "Consider the initial value problem for an ordinary differential equation (ODE) given by $y^{\\prime}(t)=f(t,y(t))$ with an arbitrary initial condition $y(0)=y_{0}$. Construct a specific function $f(t,y)$ such that, when this system is advanced in time using Heun’s method (the explicit trapezoidal predictor–corrector scheme) with any step size $h>0$, the numerical values at the grid points coincide exactly with the analytical solution for all choices of $y_{0}$ and for all $h>0$. \n\nProvide your answer as a single explicit expression for $f(t,y)$ (for example, an expression in $t$ and $y$), not as an equation. No rounding is required.", "solution": "For Heun's method to be exact, the numerical approximation at each step must equal the true analytical value. Let's assume we start a step at $(t_n, y_n)$ where $y_n = y(t_n)$ is the exact solution. The method must produce $y_{n+1} = y(t_{n+1})$.\n\nThe analytical solution is given by the integral of the ODE: $y(t_{n+1}) = y(t_n) + \\int_{t_n}^{t_{n+1}} f(s, y(s)) ds$.\nHeun's method gives: $y_{n+1} = y_n + \\frac{h}{2} [f(t_n, y_n) + f(t_{n+1}, y_n + h f(t_n, y_n))]$.\n\nThe condition for exactness is therefore that the integral is perfectly represented by the Heun's formula for all $h>0$:\n$$ \\int_{t_n}^{t_{n+1}} f(s, y(s)) ds = \\frac{h}{2} [f(t_n, y(t_n)) + f(t_{n+1}, y(t_n) + h f(t_n, y(t_n)))] $$\nConsider the special case where $f(t,y)$ is independent of $y$, i.e., $f(t, y) = g(t)$. The identity simplifies to:\n$$ \\int_{t_n}^{t_{n+1}} g(s) ds = \\frac{h}{2} [g(t_n) + g(t_{n+1})] $$\nThis equation states that the trapezoidal rule for integrating $g(t)$ must be exact for any interval. The error of the trapezoidal rule is proportional to the second derivative of the integrand. For the error to be zero for any interval, the second derivative must be identically zero: $g''(s) = 0$. This implies that $g(s)$ must be a linear function: $g(s) = as + c$, where $a$ and $c$ are constants.\n\nMore generally, one can show that if $f(t,y)$ is assumed to be a linear function $f(t, y) = at + by + c$, the condition for exactness (which requires all higher-order error terms in the Taylor expansion to vanish) forces the coefficient of $y$ to be zero, i.e., $b=0$. This is because the requirement that the third derivative of the solution, $y'''(t)$, is zero for any initial condition $y_0$ leads to a contradiction unless $b=0$.\n\nTherefore, the only functions for which Heun's method is exact are those that are linear in time and independent of $y$:\n$$ f(t,y) = at+c $$\nThe problem asks for a specific function. We can choose any constants for $a$ and $c$. A simple non-trivial example is to set $a=1$ and $c=0$, which gives $f(t,y) = t$.\n\nTo verify, if $f(t,y)=t$, the ODE is $y'=t$, with analytical solution $y(t) = \\frac{1}{2}t^2+y_0$.\nHeun's method becomes $y_{n+1} = y_n + \\frac{h}{2}[t_n + t_{n+1}]$.\nThe exact solution satisfies $y(t_{n+1}) - y(t_n) = \\frac{1}{2}t_{n+1}^2 - \\frac{1}{2}t_n^2 = \\frac{1}{2}(t_{n+1}-t_n)(t_{n+1}+t_n) = \\frac{h}{2}(t_n+t_{n+1})$.\nThus, $y_{n+1} = y_n + (y(t_{n+1}) - y(t_n))$. If $y_n = y(t_n)$, then $y_{n+1} = y(t_{n+1})$. By induction, the method is exact for all steps.", "answer": "$$\n\\boxed{t}\n$$", "id": "2428172"}]}