{"hands_on_practices": [{"introduction": "Gaussian elimination produces the powerful $PA=LU$ factorization, a tool that extends far beyond solving a single system $Ax=b$. This practice challenges you to leverage this factorization to solve a related but different system, $A^T x = b$, without the costly steps of explicitly forming the transpose $A^T$ or re-factorizing the matrix [@problem_id:2396194]. Mastering this algebraic manipulation is key to writing efficient and elegant numerical code.", "problem": "Let $A \\in \\mathbb{R}^{3 \\times 3}$. You are given the Lower-Upper (LU) factorization with row pivoting $P A = L U$, where $P$ is a permutation matrix, $L$ is unit lower triangular, and $U$ is upper triangular:\n$$\nP = \\begin{pmatrix}\n0 & 1 & 0 \\\\\n1 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix},\\quad\nL = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n3 & 1 & 0 \\\\\n2 & -1 & 1\n\\end{pmatrix},\\quad\nU = \\begin{pmatrix}\n2 & -1 & 1 \\\\\n0 & 4 & 2 \\\\\n0 & 0 & 3\n\\end{pmatrix}.\n$$\nConsider the linear system $A^{T} x = b$ with\n$$\nb = \\begin{pmatrix} 10 \\\\ 7 \\\\ 8 \\end{pmatrix}.\n$$\nCompute the second component $x_{2}$ of the unique solution $x$. Provide the exact value of $x_{2}$.", "solution": "The starting point is the given factorization $P A = L U$. We need to solve the linear system $A^{T} x = b$. First, we must express $A^T$ in terms of the given matrices $P$, $L$, and $U$.\nTaking the transpose of the factorization equation and using the property $(XY)^{T} = Y^{T}X^{T}$:\n$$\n(P A)^{T} = (L U)^{T} \\implies A^{T} P^{T} = U^{T} L^{T}\n$$\nTo isolate $A^T$, we right-multiply by $(P^{T})^{-1}$. Since $P$ is a permutation matrix, its inverse is its transpose, $P^{-1} = P^{T}$, which implies $(P^{T})^{-1} = (P^{-1})^{-1} = P$.\nThus, we have:\n$$\nA^{T} = U^{T} L^{T} P\n$$\nSubstituting this into the linear system $A^{T} x = b$:\n$$\n(U^{T} L^{T} P) x = b\n$$\nThis equation is solved as a sequence of three simpler systems. Let $y = Px$ and $z = L^T y$. The system decomposes into the following steps:\n1.  Solve $U^{T} z = b$ for the vector $z$.\n2.  Solve $L^{T} y = z$ for the vector $y$.\n3.  Solve $y = Px$ for the final solution vector $x$.\n\n**Step 1: Solve $U^{T} z = b$**\nThe system is $U^{T} z = b$:\n$$\n\\begin{pmatrix}\n2 & 0 & 0 \\\\\n-1 & 4 & 0 \\\\\n1 & 2 & 3\n\\end{pmatrix}\n\\begin{pmatrix}\nz_{1} \\\\\nz_{2} \\\\\nz_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n10 \\\\\n7 \\\\\n8\n\\end{pmatrix}\n$$\nThis is a lower triangular system, solvable by forward substitution.\nFrom the first row: $2 z_{1} = 10 \\implies z_{1} = 5$.\nFrom the second row: $-z_{1} + 4 z_{2} = 7 \\implies -5 + 4 z_{2} = 7 \\implies 4 z_{2} = 12 \\implies z_{2} = 3$.\nFrom the third row: $z_{1} + 2 z_{2} + 3 z_{3} = 8 \\implies 5 + 2(3) + 3 z_{3} = 8 \\implies 11 + 3 z_{3} = 8 \\implies 3 z_{3} = -3 \\implies z_{3} = -1$.\nThe intermediate vector is $z = (5, 3, -1)^T$.\n\n**Step 2: Solve $L^{T} y = z$**\nThe system is $L^{T} y = z$:\n$$\n\\begin{pmatrix}\n1 & 3 & 2 \\\\\n0 & 1 & -1 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\ny_{1} \\\\\ny_{2} \\\\\ny_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n5 \\\\\n3 \\\\\n-1\n\\end{pmatrix}\n$$\nThis is an upper triangular system, solvable by back substitution.\nFrom the third row: $y_{3} = -1$.\nFrom the second row: $y_{2} - y_{3} = 3 \\implies y_{2} - (-1) = 3 \\implies y_{2} = 2$.\nFrom the first row: $y_{1} + 3 y_{2} + 2 y_{3} = 5 \\implies y_{1} + 3(2) + 2(-1) = 5 \\implies y_{1} + 4 = 5 \\implies y_{1} = 1$.\nThe intermediate vector is $y = (1, 2, -1)^T$.\n\n**Step 3: Solve $y = Px$ for $x$**\nThe final step is to find $x$ from $y = Px$, which gives $x = P^{-1}y$. Since $P^{-1} = P^T$ and $P$ is symmetric, $P^{-1}=P$.\n$$\nx = P y = \\begin{pmatrix}\n0 & 1 & 0 \\\\\n1 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\\n2 \\\\\n-1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2 \\\\\n1 \\\\\n-1\n\\end{pmatrix}\n$$\nThe solution vector is $x = (2, 1, -1)^T$. The problem asks for the second component, $x_{2}$.\nThe value of $x_2$ is $1$.", "answer": "$$\\boxed{1}$$", "id": "2396194"}, {"introduction": "In the world of computation, a singular matrix often signals a problem—a point where algorithms like Gaussian elimination might fail due to a zero pivot. But what does singularity mean in a physical context? This hands-on practice [@problem_id:2396187] bridges the gap between abstract linear algebra and engineering reality by tasking you with modeling a simple truss structure. You will discover how removing a single component can render the structure unstable, a physical state that is mathematically represented by a singular stiffness matrix.", "problem": "A planar pin-jointed structure consists of a single free joint $P$ at coordinates $(0,0)$ connected to two fixed anchors $A$ and $B$ by straight, axially deformable members that obey Hooke’s law in their axial direction. The fixed anchors are located at $A=(1,0)$ and $B=(1,1)$. Each member has Young’s modulus $E=210\\times 10^{9}$ and cross-sectional area $A=1.0\\times 10^{-4}$, and each member’s axial stiffness equals $k=\\dfrac{EA}{L}$, where $L$ is its undeformed length. The global displacement of $P$ is $u=\\begin{pmatrix}u_x\\\\ u_y\\end{pmatrix}$ in Cartesian components. The fixed anchors do not move.\n\nAssume the member $PB$ is removed from the structure while all other data are unchanged. Using only first principles of axial member behavior and equilibrium, assemble the reduced global stiffness matrix $K\\in\\mathbb{R}^{2\\times 2}$ that relates the nodal force at $P$ to its displacement $u$ for the modified structure, and then compute the determinant of $K$.\n\nProvide your final answer as a single real number. Express the determinant in $\\mathrm{N}^2\\,\\mathrm{m}^{-2}$. No rounding is required.", "solution": "The modified structure consists of a single plane truss member, $PA$, connecting a free joint $P$ at $(0,0)$ to a fixed anchor $A$ at $(1,0)$. The displacement of joint $P$ is $u = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix}$.\n\nFirst, we determine the geometric and material properties of member $PA$. Its undeformed length, $L$, is:\n$$ L = \\sqrt{(1-0)^2 + (0-0)^2} = 1 \\, \\mathrm{m} $$\nThe axial stiffness, $k$, is given by $k = \\frac{EA}{L}$. Using the provided values:\n$$ k = \\frac{(210 \\times 10^{9} \\, \\mathrm{N/m^2}) \\cdot (1.0 \\times 10^{-4} \\, \\mathrm{m^2})}{1 \\, \\mathrm{m}} = 2.1 \\times 10^7 \\, \\mathrm{N/m} $$\n\nNext, we derive the $2 \\times 2$ stiffness matrix $K$ that relates the external forces $F_P = \\begin{pmatrix} F_x \\\\ F_y \\end{pmatrix}$ at node $P$ to its displacements $u$.\n\n1.  **Kinematics**: We relate the member's elongation, $\\Delta L$, to the nodal displacement $u$. Under the small displacement assumption, the elongation is the projection of the displacement vector of the moving end onto the original axis of the member. The member lies along the vector from $P$ to $A$, which is $(1,0)$. The displacement of P is $(u_x, u_y)$. The member elongates if P moves in the direction opposite to the member's orientation, so the elongation is:\n    $$ \\Delta L = (u_x, u_y) \\cdot (-1, 0) = -u_x $$\n\n2.  **Constitutive Law**: Hooke's law states that the axial tensile force $T$ in the member is proportional to its elongation: $T = k \\cdot \\Delta L$.\n    $$ T = k(-u_x) = -k u_x $$\n\n3.  **Equilibrium**: The external force $F_P$ applied to node $P$ must balance the internal force exerted by the member on the node. A positive tension ($T>0$) means the member is stretched and pulls node $P$ towards $A$ (in the positive x-direction). The force vector from the member on the node is along the member's axis, so it is $(T, 0)$. For equilibrium, the external force must be equal and opposite to the sum of internal forces.\n    $$ F_P = - \\vec{F}_{\\text{member}} = -(T, 0) = -(-k u_x, 0) = (k u_x, 0) $$\n    This gives the relationship between external force and displacement:\n    $$ \\begin{pmatrix} F_x \\\\ F_y \\end{pmatrix} = \\begin{pmatrix} k u_x \\\\ 0 \\end{pmatrix} $$\n    Expressing this in the matrix form $F_P = K u$:\n    $$ \\begin{pmatrix} F_x \\\\ F_y \\end{pmatrix} = \\begin{pmatrix} k & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix} $$\nThe reduced global stiffness matrix $K$ is:\n$$ K = \\begin{pmatrix} k & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 2.1 \\times 10^7 & 0 \\\\ 0 & 0 \\end{pmatrix} \\, \\mathrm{N/m} $$\n\nFinally, we compute the determinant of $K$:\n$$ \\det(K) = \\det\\begin{pmatrix} 2.1 \\times 10^7 & 0 \\\\ 0 & 0 \\end{pmatrix} = (2.1 \\times 10^7) \\cdot 0 - 0 \\cdot 0 = 0 $$\nThe units of the determinant are $(\\mathrm{N/m})^2 = \\mathrm{N}^2\\,\\mathrm{m}^{-2}$. A zero determinant signifies that the matrix is singular, which is physically correct because the structure offers no resistance to displacement in the y-direction, making it a mechanism rather than a stable structure.", "answer": "$$\\boxed{0}$$", "id": "2396187"}, {"introduction": "Computer-based solutions to linear systems are subject to finite-precision rounding errors, which can lead to inaccuracies, especially for ill-conditioned systems. How can we trust and improve our results? This practice introduces iterative refinement [@problem_id:2396227], a fundamental numerical technique that uses the original matrix $A$ to calculate a correction for an approximate solution. By solving a system for the error itself, you can systematically improve the accuracy of an initial result, a crucial skill in high-stakes engineering applications.", "problem": "A square linear system is given by the pair $(A,b)$, where $A \\in \\mathbb{R}^{n \\times n}$ is nonsingular and $b \\in \\mathbb{R}^n$. For each test case below, an initial approximation $x_0 \\in \\mathbb{R}^n$ is also provided. Define the residual $r \\in \\mathbb{R}^n$ by $r = b - A x_0$. Define the correction $\\delta x \\in \\mathbb{R}^n$ as the unique solution of the linear system $A \\, \\delta x = r$. Define the refined approximation $x_1 \\in \\mathbb{R}^n$ by $x_1 = x_0 + \\delta x$. Your task is to compute $x_1$ for each test case.\n\nAll computations are purely mathematical; no physical units are involved.\n\nUse the following test suite. In each case, $A$ and $b$ specify the linear system, and $x_0$ is the initial approximation.\n\n- Test case $1$ (well-conditioned $3 \\times 3$ system):\n  - $\n    A_1 =\n    \\begin{bmatrix}\n    4 & 2 & 0 \\\\\n    2 & 5 & 1 \\\\\n    0 & 1 & 3\n    \\end{bmatrix}, \\quad\n    b_1 =\n    \\begin{bmatrix}\n    6 \\\\\n    9 \\\\\n    7\n    \\end{bmatrix}, \\quad\n    x_{0,1} =\n    \\begin{bmatrix}\n    1.2 \\\\\n    0.8 \\\\\n    1.9\n    \\end{bmatrix}.\n  $\n- Test case $2$ (requires row pivoting in the first column):\n  - $\n    A_2 =\n    \\begin{bmatrix}\n    0 & 1 & 2 \\\\\n    1 & 0 & 3 \\\\\n    4 & 1 & 8\n    \\end{bmatrix}, \\quad\n    b_2 =\n    \\begin{bmatrix}\n    0 \\\\\n    -2 \\\\\n    -2\n    \\end{bmatrix}, \\quad\n    x_{0,2} =\n    \\begin{bmatrix}\n    0.9 \\\\\n    1.8 \\\\\n    -1.2\n    \\end{bmatrix}.\n  $\n- Test case $3$ (ill-conditioned Hilbert system of size $5$):\n  - $\n    A_3 =\n    \\begin{bmatrix}\n    1 & \\tfrac{1}{2} & \\tfrac{1}{3} & \\tfrac{1}{4} & \\tfrac{1}{5} \\\\\n    \\tfrac{1}{2} & \\tfrac{1}{3} & \\tfrac{1}{4} & \\tfrac{1}{5} & \\tfrac{1}{6} \\\\\n    \\tfrac{1}{3} & \\tfrac{1}{4} & \\tfrac{1}{5} & \\tfrac{1}{6} & \\tfrac{1}{7} \\\\\n    \\tfrac{1}{4} & \\tfrac{1}{5} & \\tfrac{1}{6} & \\tfrac{1}{7} & \\tfrac{1}{8} \\\\\n    \\tfrac{1}{5} & \\tfrac{1}{6} & \\tfrac{1}{7} & \\tfrac{1}{8} & \\tfrac{1}{9}\n    \\end{bmatrix}, \\quad\n    b_3 = A_3 \\cdot\n    \\begin{bmatrix}\n    1 \\\\\n    1 \\\\\n    1 \\\\\n    1 \\\\\n    1\n    \\end{bmatrix}\n    , \\quad\n    x_{0,3} =\n    \\begin{bmatrix}\n    0.9 \\\\\n    1.1 \\\\\n    0.8 \\\\\n    1.2 \\\\\n    0.7\n    \\end{bmatrix}.\n  $\n- Test case $4$ (nearly singular $2 \\times 2$ system with very small leading coefficient):\n  - $\n    A_4 =\n    \\begin{bmatrix}\n    10^{-10} & 1 \\\\\n    1 & 1\n    \\end{bmatrix}, \\quad\n    b_4 = A_4 \\cdot\n    \\begin{bmatrix}\n    1 \\\\\n    1\n    \\end{bmatrix}\n    =\n    \\begin{bmatrix}\n    1.0000000001 \\\\\n    2\n    \\endbmatrix}\n    , \\quad\n    x_{0,4} =\n    \\begin{bmatrix}\n    0.5 \\\\\n    0.5\n    \\end{bmatrix}.\n  $\n\nYour program must process all four test cases and output the refined approximations $x_1$ for each case. The required final output format is a single line containing the list of refined vectors as a bracketed, comma-separated list of lists, where each component is rounded to $10$ decimal places using standard rounding and written in decimal notation (for example, $1$ should be printed as $1.0000000000$). For instance, an output for two vectors might look like $[[1.0000000000,2.0000000000],[3.5000000000,4.2500000000]]$. Ensure there are no spaces in the printed line.", "solution": "For each test case, we perform one step of iterative refinement to improve the initial approximation $x_0$. The process is as follows:\n\n1.  **Compute the Residual**: First, we calculate the residual vector $r$, which measures how much the initial guess misses the correct right-hand side:\n    $$r = b - A x_0$$\n\n2.  **Solve for the Correction**: Next, we solve the linear system $A \\delta x = r$ to find the error correction vector $\\delta x$. This system has the same matrix $A$ as the original problem. This step is performed using a standard numerical solver, such as one based on LU decomposition with pivoting.\n\n3.  **Update the Solution**: Finally, we add the correction to the initial guess to get the refined solution:\n    $$x_1 = x_0 + \\delta x$$\n\nIn exact arithmetic, this single step would yield the true solution. The procedure is applied to all four test cases provided, and the resulting refined vectors $x_1$ are computed and formatted as requested.", "answer": "[[1.0000000000,1.0000000000,2.0000000000],[1.0000000000,2.0000000000,-1.0000000000],[1.0000000000,1.0000000000,1.0000000000,1.0000000000,1.0000000000],[1.0000000000,1.0000000000]]", "id": "2396227"}]}