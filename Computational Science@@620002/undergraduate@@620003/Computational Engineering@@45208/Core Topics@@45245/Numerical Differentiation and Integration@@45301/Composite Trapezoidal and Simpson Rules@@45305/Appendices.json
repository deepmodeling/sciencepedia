{"hands_on_practices": [{"introduction": "To truly master numerical methods, we must move from theory to practice. This first exercise provides a direct, hands-on opportunity to apply both the Composite Trapezoidal and Simpson's rules to a practical engineering problem: calculating the total power radiated by an antenna [@problem_id:2202278]. By performing the step-by-step calculations and comparing your results to a high-accuracy reference value, you will gain a concrete feel for how these methods work and see firsthand the typical difference in their precision.", "problem": "An antenna engineer is analyzing the radiation pattern of a newly designed device. In a simplified one-dimensional model, the angular power density, $P(\\theta)$, radiated by the antenna is described by the function $P(\\theta) = \\frac{\\sin(\\theta)}{\\theta}$ for $\\theta > 0$, where $\\theta$ is the angle in radians from the main axis and the power density is measured in watts per radian (W/rad). The total power, $W_{total}$, radiated within the angular interval from $\\theta_a = 1$ radian to $\\theta_b = 2$ radians is given by the integral $W_{total} = \\int_{1}^{2} \\frac{\\sin(\\theta)}{\\theta} \\,d\\theta$.\n\nDue to the nature of the sine integral function, this integral has no elementary closed-form solution. The engineer decides to compare two numerical approximation methods: the Trapezoidal rule and Simpson's 1/3 rule. For the comparison, a total of $n=4$ subintervals will be used for both methods.\n\nA highly accurate reference value for the total power, obtained from a high-performance computing cluster, is $W_{ref} = 0.65932991$ W.\n\nLet $W_T$ be the approximation of $W_{total}$ using the Trapezoidal rule and $W_S$ be the approximation using Simpson's 1/3 rule. The absolute error for each method is given by $E_T = |W_T - W_{ref}|$ and $E_S = |W_S - W_{ref}|$, respectively.\n\nCalculate the absolute difference between these two errors, $|E_T - E_S|$. Express your final answer in watts (W), rounded to three significant figures.", "solution": "We are to approximate the definite integral\n$$\nW_{total}=\\int_{1}^{2}\\frac{\\sin(\\theta)}{\\theta}\\,d\\theta\n$$\nusing the composite Trapezoidal rule and Simpson's 1/3 rule with $n=4$ subintervals on $[1,2]$, and then compare the absolute errors against the given reference $W_{ref}=0.65932991$.\n\nWith $n=4$, the uniform step is\n$$\nh=\\frac{2-1}{4}=\\frac{1}{4}.\n$$\nThe nodes are\n$$\n\\theta_{i}=1+ih,\\quad i=0,1,2,3,4,\n$$\nnamely $\\theta_{0}=1$, $\\theta_{1}=1.25$, $\\theta_{2}=1.5$, $\\theta_{3}=1.75$, $\\theta_{4}=2$. Define $f(\\theta)=\\frac{\\sin(\\theta)}{\\theta}$. Numerically,\n$$\n\\begin{aligned}\nf(\\theta_{0})&=\\frac{\\sin(1)}{1}\\approx 0.8414709848078965,\\\\\nf(\\theta_{1})&=\\frac{\\sin(1.25)}{1.25}\\approx \\frac{0.9489846171708334}{1.25}\\approx 0.7591876937366667,\\\\\nf(\\theta_{2})&=\\frac{\\sin(1.5)}{1.5}\\approx \\frac{0.9974949866040544}{1.5}\\approx 0.6649966577360363,\\\\\nf(\\theta_{3})&=\\frac{\\sin(1.75)}{1.75}\\approx \\frac{0.9839859468735364}{1.75}\\approx 0.5622776839277350,\\\\\nf(\\theta_{4})&=\\frac{\\sin(2)}{2}\\approx \\frac{0.9092974268256817}{2}\\approx 0.45464871341284085.\n\\end{aligned}\n$$\n\nThe composite Trapezoidal rule with $n=4$ is\n$$\nW_{T}=\\frac{h}{2}\\left[f(\\theta_{0})+2\\sum_{i=1}^{3}f(\\theta_{i})+f(\\theta_{4})\\right].\n$$\nCompute the interior sum\n$$\n\\sum_{i=1}^{3}f(\\theta_{i})=0.7591876937366667+0.6649966577360363+0.5622776839277350=1.9864620354004380,\n$$\nhence\n$$\n\\begin{aligned}\nW_{T}&=\\frac{1/4}{2}\\left[0.8414709848078965+2(1.9864620354004380)+0.45464871341284085\\right]\\\\\n&=\\frac{1}{8}\\left[0.8414709848078965+3.9729240708008760+0.45464871341284085\\right]\\\\\n&=\\frac{1}{8}\\left[5.26904376902161335\\right]\\approx 0.6586304711277017.\n\\end{aligned}\n$$\n\nThe composite Simpson's 1/3 rule with $n=4$ is\n$$\nW_{S}=\\frac{h}{3}\\left[f(\\theta_{0})+4\\big(f(\\theta_{1})+f(\\theta_{3})\\big)+2f(\\theta_{2})+f(\\theta_{4})\\right].\n$$\nCompute\n$$\n\\begin{aligned}\nf(\\theta_{1})+f(\\theta_{3})&=0.7591876937366667+0.5622776839277350=1.3214653776644017,\\\\\n4\\big(f(\\theta_{1})+f(\\theta_{3})\\big)&=5.2858615106576068,\\\\\n2f(\\theta_{2})&=1.3299933154720726,\n\\end{aligned}\n$$\nso\n$$\n\\begin{aligned}\nW_{S}&=\\frac{1/4}{3}\\left[0.8414709848078965+5.2858615106576068+1.3299933154720726+0.45464871341284085\\right]\\\\\n&=\\frac{1}{12}\\left[7.91197452435041675\\right]\\approx 0.6593312103625347.\n\\end{aligned}\n$$\n\nWith $W_{ref}=0.65932991$, the absolute errors are\n$$\nE_{T}=|W_{T}-W_{ref}|=|0.6586304711277017-0.65932991|\\approx 6.994388722983\\times 10^{-4},\n$$\n$$\nE_{S}=|W_{S}-W_{ref}|=|0.6593312103625347-0.65932991|\\approx 1.3003625347\\times 10^{-6}.\n$$\nTherefore, the required absolute difference is\n$$\n|E_{T}-E_{S}|\\approx 6.981385097637\\times 10^{-4}.\n$$\nRounded to three significant figures, this is\n$$\n6.98\\times 10^{-4}.\n$$", "answer": "$$\\boxed{6.98\\times 10^{-4}}$$", "id": "2202278"}, {"introduction": "After observing the difference in accuracy between the Trapezoidal and Simpson's rules, it is crucial to understand the theoretical reason for this discrepancy. This problem [@problem_id:2224223] shifts our focus to the error bounds, which dictate the convergence behavior of each method. By deriving the ratio of the theoretical maximum errors, you will mathematically prove why Simpson's rule, with an error that scales as $O(N^{-4})$, is generally far superior to the Trapezoidal rule, which scales as $O(N^{-2})$, providing a rigorous foundation for the concept of order of accuracy.", "problem": "Consider approximating the definite integral $I = \\int_0^1 \\exp(x) \\, dx$ using two different numerical methods, both employing a fixed number of $N$ subintervals of equal width. The methods are the Composite Trapezoidal Rule and the Composite Simpson's Rule.\n\nThe theoretical upper bounds for the magnitude of the truncation error for a function $f(x)$ on an interval $[a,b]$ are given by:\n- For the Composite Trapezoidal Rule: $B_T = \\frac{(b-a)^3}{12N^2} \\max_{x \\in [a,b]} |f''(x)|$\n- For the Composite Simpson's Rule: $B_S = \\frac{(b-a)^5}{180N^4} \\max_{x \\in [a,b]} |f^{(4)}(x)|$\n\nFor the specific integral $I$ given above, determine the ratio of these error bounds, $\\frac{B_T}{B_S}$. Express your answer as a function of $N$.", "solution": "We are given $I=\\int_{0}^{1}\\exp(x)\\,dx$ and the error bounds for $N$ subintervals:\n- Composite Trapezoidal Rule: $B_{T}=\\frac{(b-a)^{3}}{12N^{2}}\\max_{x\\in[a,b]}|f''(x)|$,\n- Composite Simpson's Rule: $B_{S}=\\frac{(b-a)^{5}}{180N^{4}}\\max_{x\\in[a,b]}|f^{(4)}(x)|$.\n\nFor $f(x)=\\exp(x)$ on $[0,1]$, we have $f''(x)=\\exp(x)$ and $f^{(4)}(x)=\\exp(x)$. Since $\\exp(x)$ is strictly increasing on $[0,1]$, its maximum occurs at $x=1$, hence\n$$\n\\max_{x\\in[0,1]}|f''(x)|=\\max_{x\\in[0,1]}|f^{(4)}(x)|=\\exp(1).\n$$\nWith $a=0$ and $b=1$, we have $b-a=1$. Therefore,\n$$\nB_{T}=\\frac{1^{3}}{12N^{2}}\\exp(1)=\\frac{1}{12N^{2}}\\exp(1),\\qquad\nB_{S}=\\frac{1^{5}}{180N^{4}}\\exp(1)=\\frac{1}{180N^{4}}\\exp(1).\n$$\nThe ratio is\n$$\n\\frac{B_{T}}{B_{S}} = \\frac{\\frac{1}{12N^{2}}\\exp(1)}{\\frac{1}{180N^{4}}\\exp(1)} = \\frac{1}{12N^{2}}\\exp(1) \\cdot \\frac{180N^{4}}{\\exp(1)} = \\frac{180}{12}N^{2} = 15N^{2}.\n$$\nThus, the ratio of the error bounds as a function of $N$ is $15N^{2}$.", "answer": "$$\\boxed{15N^{2}}$$", "id": "2224223"}, {"introduction": "A common pitfall in numerical analysis is to treat rules of thumb as absolute laws. While Simpson's rule is generally more accurate due to its higher order, this is not always the case. This final, insightful exercise [@problem_id:2377352] presents a carefully constructed counterexample where the Trapezoidal rule yields a more accurate result. By analyzing this specific scenario, you will develop a deeper, more critical understanding of the assumptions underpinning these methods and learn that a rule's effectiveness is tied to how well its underlying polynomial approximation fits the specific shape of the function being integrated.", "problem": "Let $f(x) = \\cos\\!\\left(\\tfrac{3\\pi}{2}\\,x\\right)$ on the interval $[-1,1]$, where all trigonometric arguments are in radians. This $f(x)$ is smooth and non-polynomial. Consider the definite integral $I = \\int_{-1}^{1} f(x)\\,dx$. Using $n=2$ subintervals, compute the composite trapezoidal approximation $T_{2}$ and the composite Simpson approximation $S_{2}$ of $I$ according to their standard definitions. Define the absolute errors $E_{T} = |T_{2} - I|$ and $E_{S} = |S_{2} - I|$. Finally, compute the single quantity $\\Delta = E_{S} - E_{T}$. Provide $\\Delta$ as an exact value with no rounding.", "solution": "The function under consideration is $f(x) = \\cos\\left(\\frac{3\\pi}{2}x\\right)$, and the interval of integration is $[-1, 1]$. The definite integral $I$ is given by:\n$$I = \\int_{-1}^{1} \\cos\\left(\\frac{3\\pi}{2}x\\right) \\,dx$$\nTo find the exact value of $I$, we compute the antiderivative of the integrand:\n$$I = \\left[ \\frac{1}{\\frac{3\\pi}{2}} \\sin\\left(\\frac{3\\pi}{2}x\\right) \\right]_{-1}^{1} = \\left[ \\frac{2}{3\\pi} \\sin\\left(\\frac{3\\pi}{2}x\\right) \\right]_{-1}^{1}$$\nEvaluating at the limits of integration, $a = -1$ and $b = 1$:\n$$I = \\frac{2}{3\\pi} \\left[ \\sin\\left(\\frac{3\\pi}{2}(1)\\right) - \\sin\\left(\\frac{3\\pi}{2}(-1)\\right) \\right] = \\frac{2}{3\\pi} \\left[ \\sin\\left(\\frac{3\\pi}{2}\\right) - \\sin\\left(-\\frac{3\\pi}{2}\\right) \\right]$$\nUsing the identity $\\sin(-u) = -\\sin(u)$, the expression simplifies to:\n$$I = \\frac{2}{3\\pi} \\left[ \\sin\\left(\\frac{3\\pi}{2}\\right) + \\sin\\left(\\frac{3\\pi}{2}\\right) \\right] = \\frac{4}{3\\pi} \\sin\\left(\\frac{3\\pi}{2}\\right)$$\nSince $\\sin\\left(\\frac{3\\pi}{2}\\right) = -1$, the exact value of the integral is:\n$$I = \\frac{4}{3\\pi} (-1) = -\\frac{4}{3\\pi}$$\nNow, we compute the numerical approximations. The problem specifies $n=2$ subintervals. The width of each subinterval is $h$:\n$$h = \\frac{b-a}{n} = \\frac{1 - (-1)}{2} = \\frac{2}{2} = 1$$\nThe grid points for the approximation are $x_0 = -1$, $x_1 = 0$, and $x_2 = 1$. We evaluate the function $f(x)$ at these points:\n$$f(x_0) = f(-1) = \\cos\\left(-\\frac{3\\pi}{2}\\right) = 0$$\n$$f(x_1) = f(0) = \\cos(0) = 1$$\n$$f(x_2) = f(1) = \\cos\\left(\\frac{3\\pi}{2}\\right) = 0$$\nThe composite trapezoidal rule for $n=2$ subintervals is given by the formula:\n$$T_2 = \\frac{h}{2} [f(x_0) + 2f(x_1) + f(x_2)]$$\nSubstituting the values we have computed:\n$$T_2 = \\frac{1}{2} [0 + 2(1) + 0] = \\frac{2}{2} = 1$$\nThe composite Simpson's rule for $n=2$ subintervals, which corresponds to a single application of the basic Simpson's $1/3$ rule over the interval, is given by:\n$$S_2 = \\frac{h}{3} [f(x_0) + 4f(x_1) + f(x_2)]$$\nSubstituting the function values:\n$$S_2 = \\frac{1}{3} [0 + 4(1) + 0] = \\frac{4}{3}$$\nNext, we determine the absolute errors $E_T$ and $E_S$.\nThe absolute error for the trapezoidal approximation is:\n$$E_T = |T_2 - I| = \\left|1 - \\left(-\\frac{4}{3\\pi}\\right)\\right| = \\left|1 + \\frac{4}{3\\pi}\\right|$$\nSince $1 > 0$ and $\\frac{4}{3\\pi} > 0$, the sum is positive, and the absolute value operation is redundant.\n$$E_T = 1 + \\frac{4}{3\\pi}$$\nThe absolute error for the Simpson's approximation is:\n$$E_S = |S_2 - I| = \\left|\\frac{4}{3} - \\left(-\\frac{4}{3\\pi}\\right)\\right| = \\left|\\frac{4}{3} + \\frac{4}{3\\pi}\\right|$$\nSimilarly, both terms are positive, so their sum is positive.\n$$E_S = \\frac{4}{3} + \\frac{4}{3\\pi}$$\nFinally, we compute the required quantity $\\Delta = E_S - E_T$:\n$$\\Delta = \\left(\\frac{4}{3} + \\frac{4}{3\\pi}\\right) - \\left(1 + \\frac{4}{3\\pi}\\right)$$\n$$\\Delta = \\frac{4}{3} + \\frac{4}{3\\pi} - 1 - \\frac{4}{3\\pi}$$\nThe term $\\frac{4}{3\\pi}$ is eliminated from the expression.\n$$\\Delta = \\frac{4}{3} - 1 = \\frac{4}{3} - \\frac{3}{3} = \\frac{1}{3}$$\nThe final value is an exact rational number.", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2377352"}]}