{"hands_on_practices": [{"introduction": "Understanding fairness begins with being able to compute key metrics like the True Positive Rate ($TPR$) and False Positive Rate ($FPR$) from a model's outputs. This practice provides a concrete scenario with discrete scores to show how these rates form a group's Receiver Operating Characteristic (ROC) space. You will discover a fundamental challenge in algorithmic fairness: the achievable performance points for different groups may be disjoint, making Equalized Odds impossible with simple deterministic classifiers and motivating the use of randomized strategies [@problem_id:3120831].", "problem": "Consider a binary classification setting with a protected attribute $A \\in \\{a,b\\}$, a binary label $Y \\in \\{0,1\\}$, and a discrete risk score $S \\in \\{3,2,1,0\\}$. For each group $A$, you will construct Receiver Operating Characteristic (ROC) points and assess the feasibility of Equalized Odds (EO). The Receiver Operating Characteristic (ROC) point at a threshold $\\tau$ is defined by the pair $(\\text{FPR}, \\text{TPR})$, where the False Positive Rate (FPR) is the probability that $\\hat{Y}_{\\tau} = 1$ given $Y=0$, and the True Positive Rate (TPR) is the probability that $\\hat{Y}_{\\tau} = 1$ given $Y=1$. The classifier at threshold $\\tau$ predicts $\\hat{Y}_{\\tau} = 1$ if and only if $S \\ge \\tau$. Equalized Odds (EO) requires that the classifier yields identical $\\text{FPR}$ and $\\text{TPR}$ across groups $A=a$ and $A=b$. In this problem, you must also respect the operational constraints $\\text{TPR} \\ge 0.6$ and $\\text{FPR} \\le 0.5$.\n\nYou are given a synthetic dataset defined by counts for each group. For $A=a$, there are $10$ positives and $10$ negatives with the following score allocations:\n- For $Y=1$ (positives): $5$ with $S=3$, $3$ with $S=2$, $1$ with $S=1$, $1$ with $S=0$.\n- For $Y=0$ (negatives): $2$ with $S=3$, $2$ with $S=2$, $3$ with $S=1$, $3$ with $S=0$.\n\nFor $A=b$, there are $10$ positives and $10$ negatives with the following score allocations:\n- For $Y=1$ (positives): $6$ with $S=3$, $3$ with $S=2$, $1$ with $S=1$, $0$ with $S=0$.\n- For $Y=0$ (negatives): $2$ with $S=3$, $3$ with $S=2$, $2$ with $S=1$, $3$ with $S=0$.\n\nTasks:\n1. Using the definitions of $\\text{TPR}$ and $\\text{FPR}$, compute the ROC points $(\\text{FPR}, \\text{TPR})$ for thresholds $\\tau=3$ and $\\tau=2$ separately for $A=a$ and $A=b$.\n2. Demonstrate that, under the constraints $\\text{TPR} \\ge 0.6$ and $\\text{FPR} \\le 0.5$, Equalized Odds is infeasible without randomization, by showing that no single threshold choice for each group yields identical $(\\text{FPR}, \\text{TPR})$ across $A=a$ and $A=b$.\n3. Now consider a mixed classifier for $A=b$ that randomizes between thresholds $\\tau=3$ and $\\tau=2$: with probability $\\lambda$ it uses $\\tau=2$, and with probability $1-\\lambda$ it uses $\\tau=3$. Let $A=a$ use the deterministic threshold $\\tau=2$. Using first principles, express $\\text{TPR}$ and $\\text{FPR}$ for the mixed classifier for $A=b$ as functions of $\\lambda$, impose the EO equalities with the chosen point for $A=a$, and solve for $\\lambda \\in [0,1]$ that achieves EO while meeting the constraints. Report the mixing probability $\\lambda$ as a single exact value. No rounding is required.", "solution": "The problem requires a three-part analysis of fairness metrics, specifically Equalized Odds (EO), for a binary classifier based on a discrete risk score $S$. The analysis involves two groups, $A=a$ and $A=b$. The final task is to find a mixing probability $\\lambda$ for a randomized classifier that achieves EO while satisfying given performance constraints.\n\nFirst, we establish the necessary definitions and data. The classifier predicts $\\hat{Y}_{\\tau} = 1$ if the score $S \\ge \\tau$ and $\\hat{Y}_{\\tau} = 0$ otherwise.\nThe True Positive Rate (TPR) is $P(\\hat{Y}_{\\tau}=1|Y=1)$.\nThe False Positive Rate (FPR) is $P(\\hat{Y}_{\\tau}=1|Y=0)$.\nThe counts of individuals for each group, label, and score are used to estimate these probabilities.\n\nFor group $A=a$, the total number of positives ($Y=1$) is $N_{+,a}=10$, and the total number of negatives ($Y=0$) is $N_{-,a}=10$. The score distributions are:\n- For $Y=1$: $5$ at $S=3$, $3$ at $S=2$, $1$ at $S=1$, $1$ at $S=0$.\n- For $Y=0$: $2$ at $S=3$, $2$ at $S=2$, $3$ at $S=1$, $3$ at $S=0$.\n\nFor group $A=b$, the total number of positives ($Y=1$) is $N_{+,b}=10$, and the total number of negatives ($Y=0$) is $N_{-,b}=10$. The score distributions are:\n- For $Y=1$: $6$ at $S=3$, $3$ at $S=2$, $1$ at $S=1$, $0$ at $S=0$.\n- For $Y=0$: $2$ at $S=3$, $3$ at $S=2$, $2$ at $S=1$, $3$ at $S=0$.\n\n**Task 1: Compute ROC points for $\\tau=3$ and $\\tau=2$**\n\nFor each group and threshold, we calculate the number of true positives (TP) and false positives (FP).\n- A true positive is an individual with $Y=1$ and $S \\ge \\tau$.\n- A false positive is an individual with $Y=0$ and $S \\ge \\tau$.\n\nFor group $A=a$:\n- At threshold $\\tau=3$:\n  - $\\text{TP}_a(\\tau=3) = (\\text{count of } Y=1, S=3) = 5$.\n  - $\\text{TPR}_a(\\tau=3) = \\frac{\\text{TP}_a(\\tau=3)}{N_{+,a}} = \\frac{5}{10} = 0.5$.\n  - $\\text{FP}_a(\\tau=3) = (\\text{count of } Y=0, S=3) = 2$.\n  - $\\text{FPR}_a(\\tau=3) = \\frac{\\text{FP}_a(\\tau=3)}{N_{-,a}} = \\frac{2}{10} = 0.2$.\n  - The ROC point is $(\\text{FPR}_a, \\text{TPR}_a) = (0.2, 0.5)$.\n- At threshold $\\tau=2$:\n  - $\\text{TP}_a(\\tau=2) = (\\text{count of } Y=1, S \\ge 2) = 5 + 3 = 8$.\n  - $\\text{TPR}_a(\\tau=2) = \\frac{8}{10} = 0.8$.\n  - $\\text{FP}_a(\\tau=2) = (\\text{count of } Y=0, S \\ge 2) = 2 + 2 = 4$.\n  - $\\text{FPR}_a(\\tau=2) = \\frac{4}{10} = 0.4$.\n  - The ROC point is $(\\text{FPR}_a, \\text{TPR}_a) = (0.4, 0.8)$.\n\nFor group $A=b$:\n- At threshold $\\tau=3$:\n  - $\\text{TP}_b(\\tau=3) = (\\text{count of } Y=1, S=3) = 6$.\n  - $\\text{TPR}_b(\\tau=3) = \\frac{\\text{TP}_b(\\tau=3)}{N_{+,b}} = \\frac{6}{10} = 0.6$.\n  - $\\text{FP}_b(\\tau=3) = (\\text{count of } Y=0, S=3) = 2$.\n  - $\\text{FPR}_b(\\tau=3) = \\frac{\\text{FP}_b(\\tau=3)}{N_{-,b}} = \\frac{2}{10} = 0.2$.\n  - The ROC point is $(\\text{FPR}_b, \\text{TPR}_b) = (0.2, 0.6)$.\n- At threshold $\\tau=2$:\n  - $\\text{TP}_b(\\tau=2) = (\\text{count of } Y=1, S \\ge 2) = 6 + 3 = 9$.\n  - $\\text{TPR}_b(\\tau=2) = \\frac{9}{10} = 0.9$.\n  - $\\text{FP}_b(\\tau=2) = (\\text{count of } Y=0, S \\ge 2) = 2 + 3 = 5$.\n  - $\\text{FPR}_b(\\tau=2) = \\frac{5}{10} = 0.5$.\n  - The ROC point is $(\\text{FPR}_b, \\text{TPR}_b) = (0.5, 0.9)$.\n\n**Task 2: Demonstrate infeasibility of Equalized Odds without randomization**\n\nEqualized Odds (EO) requires that the classifier achieves the same $(\\text{FPR}, \\text{TPR})$ pair for both groups $A=a$ and $A=b$. We must also satisfy the constraints $\\text{TPR} \\ge 0.6$ and $\\text{FPR} \\le 0.5$. We need to check all possible non-randomized classifiers, which correspond to setting a single threshold $\\tau$ for each group. The possible thresholds are values of $S$ and values just above/below them, effectively $\\tau > 3$, $\\tau=3$, $\\tau=2$, $\\tau=1$, $\\tau=0$.\n\nFirst, we find the set of valid ROC points for each group that satisfy the constraints.\nFor group $A=a$:\n- $\\tau>3$: $(\\text{FPR}, \\text{TPR})=(0,0)$. Fails $\\text{TPR} \\ge 0.6$.\n- $\\tau=3$: $(\\text{FPR}, \\text{TPR})=(0.2, 0.5)$. Fails $\\text{TPR} \\ge 0.6$.\n- $\\tau=2$: $(\\text{FPR}, \\text{TPR})=(0.4, 0.8)$. Satisfies both $\\text{TPR} \\ge 0.6$ and $\\text{FPR} \\le 0.5$. Valid.\n- $\\tau=1$: $(\\text{FPR}, \\text{TPR})=(\\frac{7}{10}, \\frac{9}{10}) = (0.7, 0.9)$. Fails $\\text{FPR} \\le 0.5$.\n- $\\tau=0$: $(\\text{FPR}, \\text{TPR})=(1.0, 1.0)$. Fails $\\text{FPR} \\le 0.5$.\nThe only valid operating point for group $A=a$ is $(0.4, 0.8)$, achieved with $\\tau_a=2$.\n\nFor group $A=b$:\n- $\\tau>3$: $(\\text{FPR}, \\text{TPR})=(0,0)$. Fails $\\text{TPR} \\ge 0.6$.\n- $\\tau=3$: $(\\text{FPR}, \\text{TPR})=(0.2, 0.6)$. Satisfies both constraints. Valid.\n- $\\tau=2$: $(\\text{FPR}, \\text{TPR})=(0.5, 0.9)$. Satisfies both constraints. Valid.\n- $\\tau=1$: $(\\text{FPR}, \\text{TPR})=(\\frac{7}{10}, \\frac{10}{10}) = (0.7, 1.0)$. Fails $\\text{FPR} \\le 0.5$.\n- $\\tau=0$: $(\\text{FPR}, \\text{TPR})=(1.0, 1.0)$. Fails $\\text{FPR} \\le 0.5$.\nThe valid operating points for group $A=b$ are $(0.2, 0.6)$ achieved with $\\tau_b=3$, and $(0.5, 0.9)$ achieved with $\\tau_b=2$.\n\nTo satisfy EO, we must find a common valid point. The only valid point for group $a$ is $(0.4, 0.8)$. This point is not in the set of valid points for group $b$, i.e., $\\{(0.2, 0.6), (0.5, 0.9)\\}$. Therefore, it is impossible to choose deterministic thresholds for each group that satisfy both the constraints and the EO condition. EO is infeasible without randomization.\n\n**Task 3: Find mixing probability $\\lambda$ for Equalized Odds**\n\nWe are instructed to fix the classifier for group $A=a$ to use the deterministic threshold $\\tau=2$. This yields the ROC point $(\\text{FPR}_a, \\text{TPR}_a) = (0.4, 0.8)$. As established, this point satisfies the operational constraints.\n\nFor group $A=b$, we use a mixed classifier that randomizes between two thresholds: it uses $\\tau=2$ with probability $\\lambda$ and $\\tau=3$ with probability $1-\\lambda$. The ROC points corresponding to these thresholds for group $b$ are:\n- For $\\tau=2$: $(\\text{FPR}_{b, \\tau=2}, \\text{TPR}_{b, \\tau=2}) = (0.5, 0.9)$.\n- For $\\tau=3$: $(\\text{FPR}_{b, \\tau=3}, \\text{TPR}_{b, \\tau=3}) = (0.2, 0.6)$.\n\nThe TPR and FPR of the mixed classifier for group $b$, denoted $\\text{TPR}_b(\\lambda)$ and $\\text{FPR}_b(\\lambda)$, are linear combinations of the rates at the constituent thresholds, weighted by their respective probabilities.\nUsing the law of total probability:\n$$ \\text{FPR}_b(\\lambda) = \\lambda \\cdot \\text{FPR}_{b, \\tau=2} + (1-\\lambda) \\cdot \\text{FPR}_{b, \\tau=3} $$\n$$ \\text{TPR}_b(\\lambda) = \\lambda \\cdot \\text{TPR}_{b, \\tau=2} + (1-\\lambda) \\cdot \\text{TPR}_{b, \\tau=3} $$\nSubstituting the values:\n$$ \\text{FPR}_b(\\lambda) = \\lambda(0.5) + (1-\\lambda)(0.2) = 0.5\\lambda + 0.2 - 0.2\\lambda = 0.3\\lambda + 0.2 $$\n$$ \\text{TPR}_b(\\lambda) = \\lambda(0.9) + (1-\\lambda)(0.6) = 0.9\\lambda + 0.6 - 0.6\\lambda = 0.3\\lambda + 0.6 $$\n\nTo achieve Equalized Odds, we must enforce equality of TPR and FPR across groups:\n$$ \\text{FPR}_a = \\text{FPR}_b(\\lambda) \\implies 0.4 = 0.3\\lambda + 0.2 $$\n$$ \\text{TPR}_a = \\text{TPR}_b(\\lambda) \\implies 0.8 = 0.3\\lambda + 0.6 $$\n\nWe solve either equation for $\\lambda$. Both equations must yield the same solution for a consistent solution to exist.\nFrom the FPR equation:\n$$ 0.4 - 0.2 = 0.3\\lambda $$\n$$ 0.2 = 0.3\\lambda $$\n$$ \\lambda = \\frac{0.2}{0.3} = \\frac{2}{3} $$\nFrom the TPR equation:\n$$ 0.8 - 0.6 = 0.3\\lambda $$\n$$ 0.2 = 0.3\\lambda $$\n$$ \\lambda = \\frac{0.2}{0.3} = \\frac{2}{3} $$\nBoth equations consistently yield $\\lambda = \\frac{2}{3}$. This value is within the valid range for a probability, $[0,1]$.\nThe resulting ROC point for both groups is $(0.4, 0.8)$, which satisfies the constraints $\\text{TPR} \\ge 0.6$ and $\\text{FPR} \\le 0.5$. Thus, the mixing probability $\\lambda$ is $\\frac{2}{3}$.", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "3120831"}, {"introduction": "In many real-world applications, we need to audit a model for fairness without access to its internal workings. This exercise introduces a powerful, nonparametric approach to test for violations of Demographic Parity across all possible decision thresholds. By constructing empirical survival functions for different groups and calculating the Kolmogorov-Smirnov statistic, you will learn a practical method to quantify the maximum disparity in positive prediction rates [@problem_id:3120841].", "problem": "Consider a binary sensitive attribute $A \\in \\{0,1\\}$ and a black-box score $\\hat{p} \\in [0,1]$ output by a classifier for each individual. Under demographic parity, the binary decision $\\hat{Y}$ is independent of $A$. Suppose decisions are produced by thresholding $\\hat{p}$ at a level $t \\in [0,1]$ according to $\\hat{Y}_{t} = \\mathbf{1}\\{\\hat{p} \\ge t\\}$. Audit demographic parity nonparametrically by testing whether the distribution of $\\hat{p}$ is the same across the two groups, using the survival function $S_{a}(t) = P(\\hat{p} \\ge t \\mid A=a)$ and a supremum-type discrepancy between the groups. Derive this test from first principles, starting from the independence definition of demographic parity and the properties of empirical distribution functions, without assuming any parametric form for the score distribution.\n\nYou are given two independent samples of scores:\n- Group $A=0$ has $n_{0}=6$ scores: $0.02$, $0.10$, $0.22$, $0.40$, $0.65$, $0.90$.\n- Group $A=1$ has $n_{1}=8$ scores: $0.05$, $0.08$, $0.25$, $0.30$, $0.45$, $0.60$, $0.85$, $0.95$.\n\nConstruct the empirical survival functions $\\hat{S}_{0}(t)$ and $\\hat{S}_{1}(t)$ for these samples and compute the resulting Kolmogorov–Smirnov (KS) statistic, defined as the supremum of the absolute difference between the two empirical survival functions over $t \\in [0,1]$. Report the value of this KS statistic. Express the final answer exactly (no rounding).", "solution": "Demographic parity requires the decision $\\hat{Y}$ to be independent of the sensitive attribute $A$. If the decision is generated by thresholding the score at a level $t \\in [0,1]$, then $\\hat{Y}_{t} = \\mathbf{1}\\{\\hat{p} \\ge t\\}$ and demographic parity at threshold $t$ means\n$$\nP(\\hat{Y}_{t}=1 \\mid A=0) \\;=\\; P(\\hat{Y}_{t}=1 \\mid A=1).\n$$\nBy the definition of $\\hat{Y}_{t}$, this condition is equivalent to\n$$\nP(\\hat{p} \\ge t \\mid A=0) \\;=\\; P(\\hat{p} \\ge t \\mid A=1),\n$$\nwhich is the equality of the survival functions $S_{0}(t)$ and $S_{1}(t)$ at the threshold $t$. If the threshold is not specified a priori, auditing demographic parity across all possible thresholds amounts to testing\n$$\nS_{0}(t) \\;=\\; S_{1}(t) \\quad \\text{for all } t \\in [0,1].\n$$\nThis is equivalent to testing equality of the conditional distributions of $\\hat{p}$ given $A=0$ and $A=1$, since $S_{a}(t) = 1 - F_{a}(t-)$ where $F_{a}$ is the cumulative distribution function of $\\hat{p}$ given $A=a$. A nonparametric test that targets the maximal discrepancy between distributions is the Kolmogorov–Smirnov (KS) test, which compares the supremum of absolute differences between empirical distribution functions. Because $S_{a}(t)$ and $F_{a}(t)$ differ only by a complement, the supremum of $|\\hat{S}_{0}(t) - \\hat{S}_{1}(t)|$ over $t$ yields the same discrepancy as the KS statistic computed on cumulative distribution functions.\n\nTo estimate $S_{a}(t)$ nonparametrically from data, we use the empirical survival function\n$$\n\\hat{S}_{a}(t) \\;=\\; \\frac{1}{n_{a}} \\sum_{i: A_{i}=a} \\mathbf{1}\\{\\hat{p}_{i} \\ge t\\}.\n$$\nThe KS statistic based on survival functions is then\n$$\nD \\;=\\; \\sup_{t \\in [0,1]} \\left| \\hat{S}_{0}(t) - \\hat{S}_{1}(t) \\right|.\n$$\n\nWe now compute $\\hat{S}_{0}(t)$ and $\\hat{S}_{1}(t)$ across $t$ for the given samples. Because the empirical survival functions are right-continuous step functions that change only at observed scores, it suffices to evaluate at thresholds $t$ taken from the combined set of observed values. Let $n_{0} = 6$ and $n_{1} = 8$. The sorted scores are:\n- For $A=0$: $0.02$, $0.10$, $0.22$, $0.40$, $0.65$, $0.90$.\n- For $A=1$: $0.05$, $0.08$, $0.25$, $0.30$, $0.45$, $0.60$, $0.85$, $0.95$.\n\nWe evaluate $\\hat{S}_{0}(t)$ and $\\hat{S}_{1}(t)$ at the unique thresholds $t \\in \\{0.02, 0.05, 0.08, 0.10, 0.22, 0.25, 0.30, 0.40, 0.45, 0.60, 0.65, 0.85, 0.90, 0.95\\}$ (and note behavior between them):\n\n- At $t=0.02$: $\\hat{S}_{0}(0.02) = \\frac{6}{6} = 1$, $\\hat{S}_{1}(0.02) = \\frac{8}{8} = 1$, difference $0$.\n- At $t=0.05$: $\\hat{S}_{0}(0.05) = \\frac{5}{6}$, $\\hat{S}_{1}(0.05) = \\frac{8}{8} = 1$, difference $\\left| \\frac{5}{6} - 1 \\right| = \\frac{1}{6}$.\n- At $t=0.08$: $\\hat{S}_{0}(0.08) = \\frac{5}{6}$, $\\hat{S}_{1}(0.08) = \\frac{7}{8}$, difference $\\left| \\frac{5}{6} - \\frac{7}{8} \\right| = \\frac{1}{24}$.\n- At $t=0.10$: $\\hat{S}_{0}(0.10) = \\frac{5}{6}$, $\\hat{S}_{1}(0.10) = \\frac{6}{8} = \\frac{3}{4}$, difference $\\left| \\frac{5}{6} - \\frac{3}{4} \\right| = \\frac{1}{12}$.\n- At $t=0.22$: $\\hat{S}_{0}(0.22) = \\frac{4}{6} = \\frac{2}{3}$, $\\hat{S}_{1}(0.22) = \\frac{6}{8} = \\frac{3}{4}$, difference $\\left| \\frac{2}{3} - \\frac{3}{4} \\right| = \\frac{1}{12}$.\n- At $t=0.25$: $\\hat{S}_{0}(0.25) = \\frac{3}{6} = \\frac{1}{2}$, $\\hat{S}_{1}(0.25) = \\frac{6}{8} = \\frac{3}{4}$, difference $\\left| \\frac{1}{2} - \\frac{3}{4} \\right| = \\frac{1}{4}$.\n- At $t=0.30$: $\\hat{S}_{0}(0.30) = \\frac{3}{6} = \\frac{1}{2}$, $\\hat{S}_{1}(0.30) = \\frac{5}{8}$, difference $\\left| \\frac{1}{2} - \\frac{5}{8} \\right| = \\frac{1}{8}$.\n- At $t=0.40$: $\\hat{S}_{0}(0.40) = \\frac{3}{6} = \\frac{1}{2}$, $\\hat{S}_{1}(0.40) = \\frac{4}{8} = \\frac{1}{2}$, difference $0$.\n- At $t=0.45$: $\\hat{S}_{0}(0.45) = \\frac{2}{6} = \\frac{1}{3}$, $\\hat{S}_{1}(0.45) = \\frac{4}{8} = \\frac{1}{2}$, difference $\\left| \\frac{1}{3} - \\frac{1}{2} \\right| = \\frac{1}{6}$.\n- At $t=0.60$: $\\hat{S}_{0}(0.60) = \\frac{2}{6} = \\frac{1}{3}$, $\\hat{S}_{1}(0.60) = \\frac{3}{8}$, difference $\\left| \\frac{1}{3} - \\frac{3}{8} \\right| = \\frac{1}{24}$.\n- At $t=0.65$: $\\hat{S}_{0}(0.65) = \\frac{2}{6} = \\frac{1}{3}$, $\\hat{S}_{1}(0.65) = \\frac{2}{8} = \\frac{1}{4}$, difference $\\left| \\frac{1}{3} - \\frac{1}{4} \\right| = \\frac{1}{12}$.\n- At $t=0.85$: $\\hat{S}_{0}(0.85) = \\frac{1}{6}$, $\\hat{S}_{1}(0.85) = \\frac{2}{8} = \\frac{1}{4}$, difference $\\left| \\frac{1}{6} - \\frac{1}{4} \\right| = \\frac{1}{12}$.\n- At $t=0.90$: $\\hat{S}_{0}(0.90) = \\frac{1}{6}$, $\\hat{S}_{1}(0.90) = \\frac{1}{8}$, difference $\\left| \\frac{1}{6} - \\frac{1}{8} \\right| = \\frac{1}{24}$.\n- At $t=0.95$: $\\hat{S}_{0}(0.95) = 0$, $\\hat{S}_{1}(0.95) = \\frac{1}{8}$, difference $\\left| 0 - \\frac{1}{8} \\right| = \\frac{1}{8}$.\n\nBetween these thresholds, the empirical survival functions are constant on intervals, so the absolute differences are equal to the values at the endpoints within each interval. The maximal absolute difference observed is $\\frac{1}{4}$, which occurs for $t$ in the interval $[0.25, 0.30)$ (including $t=0.25$).\n\nTherefore, the Kolmogorov–Smirnov statistic based on the empirical survival functions is\n$$\nD \\;=\\; \\frac{1}{4}.\n$$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "3120841"}, {"introduction": "While auditing for fairness is crucial, we also need constructive methods to build fair models. This practice moves from empirical data to a continuous, parametric setting, assuming classifier scores follow a Gaussian distribution. By working through the analytics, you will see how to leverage knowledge of the score distributions to precisely engineer group-specific decision thresholds that satisfy the rigorous criteria of Equalized Odds [@problem_id:3120888].", "problem": "Consider a binary classification scenario in statistical learning with a protected attribute $A\\in\\{0,1\\}$ and ground-truth label $Y\\in\\{0,1\\}$. A score $X\\in\\mathbb{R}$ is produced by a model prior to thresholding. The classifier uses group-specific thresholds: it predicts $\\hat{Y}=1$ for group $g\\in\\{0,1\\}$ if and only if $X\\geq t_g$. Synthetic data are generated so that the score distribution is Gaussian and class-conditional with group-dependent means and a common variance, specifically\n$$\nX\\mid (A=0,Y=1)\\sim \\mathcal{N}(2,1),\\quad X\\mid (A=0,Y=0)\\sim \\mathcal{N}(0,1),\n$$\n$$\nX\\mid (A=1,Y=1)\\sim \\mathcal{N}(5,1),\\quad X\\mid (A=1,Y=0)\\sim \\mathcal{N}(3,1).\n$$\nStarting only from the fundamental definitions of the True Positive Rate (TPR), False Positive Rate (FPR), and the Receiver Operating Characteristic (ROC), where the Receiver Operating Characteristic (ROC) curve for a given group is the set of achievable $(\\text{FPR},\\text{TPR})$ pairs induced by varying the threshold $t_g$, and using standard properties of the Gaussian distribution (including the standard normal cumulative distribution function), perform the following:\n\n1. Derive analytically the group-wise $\\text{TPR}$ and $\\text{FPR}$ as functions of the threshold $t_g$ for each group $g\\in\\{0,1\\}$, and thereby write the parametric ROC for each group as $t_g$ varies over $\\mathbb{R}$.\n\n2. Using the formal definition of Equalized Odds (EO), which requires $\\text{TPR}_0=\\text{TPR}_1$ and $\\text{FPR}_0=\\text{FPR}_1$, find thresholds $(t_0,t_1)$ that satisfy Equalized Odds exactly and, in addition, achieve a common True Positive Rate equal to $0.8$.\n\nRound your numerical final answers to four significant figures. Express your final answer as the ordered pair $(t_0,t_1)$.", "solution": "This problem requires us to find a pair of group-specific thresholds, $(t_0, t_1)$, that satisfy Equalized Odds (EO) and achieve a True Positive Rate (TPR) of $0.8$. The solution proceeds in two steps: first, deriving the analytical formulas for TPR and False Positive Rate (FPR) for each group, and second, using these formulas to solve for the thresholds.\n\nLet $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution, $\\mathcal{N}(0, 1)$. For a normally distributed variable $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$, the probability $P(X \\ge t)$ is $1 - \\Phi(\\frac{t-\\mu}{\\sigma})$.\n\n**1. Derivation of Group-Wise TPR and FPR**\n\nFor each group $g \\in \\{0, 1\\}$, the prediction is $\\hat{Y}=1$ if the score $X \\ge t_g$.\n\n**Group A=0:**\nThe distributions are $X \\mid (A=0, Y=1) \\sim \\mathcal{N}(2, 1)$ for true positives and $X \\mid (A=0, Y=0) \\sim \\mathcal{N}(0, 1)$ for true negatives. The rates are functions of the threshold $t_0$:\n$$\n\\text{TPR}_0(t_0) = P(X \\ge t_0 | A=0, Y=1) = 1 - \\Phi\\left(\\frac{t_0-2}{1}\\right) = 1 - \\Phi(t_0-2)\n$$\n$$\n\\text{FPR}_0(t_0) = P(X \\ge t_0 | A=0, Y=0) = 1 - \\Phi\\left(\\frac{t_0-0}{1}\\right) = 1 - \\Phi(t_0)\n$$\n\n**Group A=1:**\nThe distributions are $X \\mid (A=1, Y=1) \\sim \\mathcal{N}(5, 1)$ for true positives and $X \\mid (A=1, Y=0) \\sim \\mathcal{N}(3, 1)$ for true negatives. The rates are functions of the threshold $t_1$:\n$$\n\\text{TPR}_1(t_1) = P(X \\ge t_1 | A=1, Y=1) = 1 - \\Phi\\left(\\frac{t_1-5}{1}\\right) = 1 - \\Phi(t_1-5)\n$$\n$$\n\\text{FPR}_1(t_1) = P(X \\ge t_1 | A=1, Y=0) = 1 - \\Phi\\left(\\frac{t_1-3}{1}\\right) = 1 - \\Phi(t_1-3)\n$$\n\n**2. Calculation of Thresholds for Equalized Odds**\n\nThe EO condition requires $\\text{TPR}_0(t_0) = \\text{TPR}_1(t_1)$ and $\\text{FPR}_0(t_0) = \\text{FPR}_1(t_1)$. We are also given that the common TPR must be $0.8$.\n\nFirst, we use the TPR constraint to find expressions for $t_0$ and $t_1$:\n$$\n\\text{TPR}_0(t_0) = 1 - \\Phi(t_0 - 2) = 0.8 \\implies \\Phi(t_0 - 2) = 0.2\n$$\n$$\nt_0 - 2 = \\Phi^{-1}(0.2) \\implies t_0 = 2 + \\Phi^{-1}(0.2)\n$$\nFor group 1:\n$$\n\\text{TPR}_1(t_1) = 1 - \\Phi(t_1 - 5) = 0.8 \\implies \\Phi(t_1 - 5) = 0.2\n$$\n$$\nt_1 - 5 = \\Phi^{-1}(0.2) \\implies t_1 = 5 + \\Phi^{-1}(0.2)\n$$\nNext, we verify that these thresholds also satisfy the FPR equality.\n$$\n\\text{FPR}_0(t_0) = 1 - \\Phi(t_0) = 1 - \\Phi(2 + \\Phi^{-1}(0.2))\n$$\n$$\n\\text{FPR}_1(t_1) = 1 - \\Phi(t_1 - 3) = 1 - \\Phi((5 + \\Phi^{-1}(0.2)) - 3) = 1 - \\Phi(2 + \\Phi^{-1}(0.2))\n$$\nThe expressions for $\\text{FPR}_0(t_0)$ and $\\text{FPR}_1(t_1)$ are identical, confirming that the EO condition is satisfied. This is a consequence of the fact that the ROC curves for both groups are identical because the difference between the means of the positive and negative classes is the same for both groups ($2-0=2$ and $5-3=2$).\n\nFor the numerical calculation, we use the value of the standard normal quantile $\\Phi^{-1}(0.2) \\approx -0.84162$.\n$$\nt_0 = 2 + (-0.84162) = 1.15838\n$$\n$$\nt_1 = 5 + (-0.84162) = 4.15838\n$$\nRounding to four significant figures, we get:\n$$\nt_0 \\approx 1.158\n$$\n$$\nt_1 \\approx 4.158\n$$\nThe final ordered pair of thresholds is $(1.158, 4.158)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1.158 & 4.158 \\end{pmatrix}}\n$$", "id": "3120888"}]}