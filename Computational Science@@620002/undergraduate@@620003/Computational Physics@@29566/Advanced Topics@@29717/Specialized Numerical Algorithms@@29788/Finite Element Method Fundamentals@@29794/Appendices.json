{"hands_on_practices": [{"introduction": "The Finite Element Method's power lies in its systematic approach to discretizing physical laws. A core task is deriving element matrices that represent physical properties, which begins with the weak form of a governing equation. This exercise [@problem_id:2172585] guides you through the fundamental process of deriving a consistent mass matrix for a simple 1D element, demonstrating how continuous mass distribution is captured by integrating over the element's shape functions.", "problem": "In the finite element analysis of structures undergoing vibration, the inertia of the elements is represented by a mass matrix. Consider a single one-dimensional, two-noded linear element used to model a segment of a uniform rod. This element has a length $h_e$, a constant mass density $\\rho$, and a uniform cross-sectional area $A$.\n\nA local coordinate system is defined such that the element occupies the domain $x \\in [0, h_e]$, with node 1 at $x=0$ and node 2 at $x=h_e$. The axial displacement field within the element is interpolated from the nodal displacements using the linear functions $N_1(x) = 1 - \\frac{x}{h_e}$ and $N_2(x) = \\frac{x}{h_e}$.\n\nThe entries $M_{ij}$ of the $2 \\times 2$ element mass matrix $\\mathbf{M}$ (where $i, j \\in \\{1, 2\\}$) are determined by the following integral over the element's length:\n$$\nM_{ij} = \\int_{0}^{h_e} \\rho A N_i(x) N_j(x) dx\n$$\nCalculate the element mass matrix $\\mathbf{M}$. Your answer should be a $2 \\times 2$ matrix expressed in terms of $\\rho$, $A$, and $h_e$.", "solution": "We use the consistent mass matrix definition for a one-dimensional element:\n$$\nM_{ij}=\\int_{0}^{h_{e}}\\rho A\\,N_{i}(x)N_{j}(x)\\,dx,\\quad i,j\\in\\{1,2\\},\n$$\nwith linear shape functions $N_{1}(x)=1-\\frac{x}{h_{e}}$ and $N_{2}(x)=\\frac{x}{h_{e}}$ on $x\\in[0,h_{e}]$.\n\nCompute each entry:\nFor $M_{11}$,\n$$\nM_{11}=\\int_{0}^{h_{e}}\\rho A\\left(1-\\frac{x}{h_{e}}\\right)^{2}dx\n=\\rho A\\int_{0}^{h_{e}}\\left(1-\\frac{2x}{h_{e}}+\\frac{x^{2}}{h_{e}^{2}}\\right)dx.\n$$\nIntegrating term by term,\n$$\nM_{11}=\\rho A\\left[x-\\frac{x^{2}}{h_{e}}+\\frac{x^{3}}{3h_{e}^{2}}\\right]_{0}^{h_{e}}\n=\\rho A\\left(h_{e}-h_{e}+\\frac{h_{e}}{3}\\right)\n=\\rho A\\frac{h_{e}}{3}.\n$$\n\nFor $M_{12}$,\n$$\nM_{12}=\\int_{0}^{h_{e}}\\rho A\\left(1-\\frac{x}{h_{e}}\\right)\\left(\\frac{x}{h_{e}}\\right)dx\n=\\rho A\\int_{0}^{h_{e}}\\left(\\frac{x}{h_{e}}-\\frac{x^{2}}{h_{e}^{2}}\\right)dx.\n$$\nIntegrating,\n$$\nM_{12}=\\rho A\\left[\\frac{x^{2}}{2h_{e}}-\\frac{x^{3}}{3h_{e}^{2}}\\right]_{0}^{h_{e}}\n=\\rho A\\left(\\frac{h_{e}}{2}-\\frac{h_{e}}{3}\\right)\n=\\rho A\\frac{h_{e}}{6}.\n$$\n\nBy symmetry, $M_{21}=M_{12}=\\rho A\\frac{h_{e}}{6}$, and similarly\n$$\nM_{22}=\\int_{0}^{h_{e}}\\rho A\\left(\\frac{x}{h_{e}}\\right)^{2}dx\n=\\rho A\\int_{0}^{h_{e}}\\frac{x^{2}}{h_{e}^{2}}dx\n=\\rho A\\frac{1}{h_{e}^{2}}\\left[\\frac{x^{3}}{3}\\right]_{0}^{h_{e}}\n=\\rho A\\frac{h_{e}}{3}.\n$$\n\nAssembling the entries gives\n$$\n\\mathbf{M}=\n\\begin{pmatrix}\n\\rho A\\frac{h_{e}}{3} & \\rho A\\frac{h_{e}}{6} \\\\\n\\rho A\\frac{h_{e}}{6} & \\rho A\\frac{h_{e}}{3}\n\\end{pmatrix}\n=\\frac{\\rho A h_{e}}{6}\n\\begin{pmatrix}\n2 & 1 \\\\\n1 & 2\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\frac{\\rho A h_{e}}{6}\\begin{pmatrix}2 & 1 \\\\ 1 & 2\\end{pmatrix}}$$", "id": "2172585"}, {"introduction": "After calculating individual element matrices, the next crucial step is assembling them into a single global system that represents the entire problem domain. This practice [@problem_id:2393853] challenges you to perform this assembly for a 1D heat conduction problem with intentionally non-sequential node numbering. Mastering this process is key to understanding how FEM software constructs and solves large, complex systems from simple, repeatable element calculations.", "problem": "A steady one-dimensional heat conduction problem is considered on a straight, prismatic bar with constant thermal conductivity $k$ and constant cross-sectional area $A$. There is no internal heat generation. The bar is discretized using the standard Galerkin finite element method with linear Lagrange shape functions into $4$ elements over $5$ global nodes. The global node identifiers and their positions along the bar are:\n- Node $42$: $x=0.00 \\ \\mathrm{m}$\n- Node $7$: $x=0.35 \\ \\mathrm{m}$\n- Node $13$: $x=0.50 \\ \\mathrm{m}$\n- Node $5$: $x=0.90 \\ \\mathrm{m}$\n- Node $21$: $x=1.20 \\ \\mathrm{m}$\n\nThe element connectivity is intentionally scrambled and given by the following list of two-node elements $(\\text{first node}, \\text{second node})$:\n- Element $17$: $(42,7)$\n- Element $100$: $(13,7)$\n- Element $9$: $(13,5)$\n- Element $23$: $(21,5)$\n\nAssemble the global stiffness matrix for the unconstrained system (that is, before applying any boundary conditions). The rows and columns of the global stiffness matrix are to be ordered according to the node-identifier sequence $(5, \\ 42, \\ 13, \\ 21, \\ 7)$.\n\nMaterial and geometric properties are:\n- Thermal conductivity $k = 180 \\ \\mathrm{W \\, m^{-1} \\, K^{-1}}$\n- Cross-sectional area $A = 2.0 \\times 10^{-3} \\ \\mathrm{m^{2}}$\n\nWhat is the value of the diagonal entry of the assembled global stiffness matrix associated with global node identifier $13$? Express your answer in $\\mathrm{W \\, K^{-1}}$ and round your answer to $4$ significant figures.", "solution": "The governing differential equation for steady one-dimensional heat conduction in a prismatic bar with constant thermal conductivity $k$ and cross-sectional area $A$ without internal heat generation is\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(k A \\, \\frac{\\mathrm{d}T}{\\mathrm{d}x}\\right) \\,=\\, 0.\n$$\nThe standard Galerkin finite element method with linear Lagrange shape functions over a two-node element of length $L_{e}$ produces the element stiffness matrix\n$$\n\\mathbf{K}^{(e)} \\,=\\, \\int_{0}^{L_{e}} k A \\, \\left(\\frac{\\mathrm{d}\\mathbf{N}}{\\mathrm{d}x}\\right)^{\\!\\top} \\left(\\frac{\\mathrm{d}\\mathbf{N}}{\\mathrm{d}x}\\right) \\, \\mathrm{d}x,\n$$\nwhere $\\mathbf{N} = \\begin{bmatrix} N_{1} & N_{2} \\end{bmatrix}$ are the linear shape functions. For a linear two-node element, the derivatives are constant on the element, $\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}x} = -\\frac{1}{L_{e}}$ and $\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}x} = \\frac{1}{L_{e}}$, so\n$$\n\\mathbf{K}^{(e)} \\,=\\, k A \\int_{0}^{L_{e}} \n\\begin{bmatrix}\n\\frac{1}{L_{e}^{2}} & -\\frac{1}{L_{e}^{2}} \\\\\n-\\frac{1}{L_{e}^{2}} & \\frac{1}{L_{e}^{2}}\n\\end{bmatrix}\n\\mathrm{d}x\n\\,=\\, \\frac{k A}{L_{e}} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}.\n$$\n\nThus, each element contributes $\\frac{k A}{L_{e}}$ to the diagonal entries associated with its two nodes and $-\\frac{k A}{L_{e}}$ to the corresponding off-diagonal couplings. The diagonal entry of the global stiffness matrix associated with a particular global node is the sum of the diagonal contributions from the elements incident on that node.\n\nWe first compute the element lengths from the given node coordinates:\n- Element $17$ connects nodes $(42, 7)$ at $x=0.00 \\ \\mathrm{m}$ and $x=0.35 \\ \\mathrm{m}$, so $L_{17} = |0.35 - 0.00| = 0.35 \\ \\mathrm{m}$.\n- Element $100$ connects nodes $(13, 7)$ at $x=0.50 \\ \\mathrm{m}$ and $x=0.35 \\ \\mathrm{m}$, so $L_{100} = |0.50 - 0.35| = 0.15 \\ \\mathrm{m}$.\n- Element $9$ connects nodes $(13, 5)$ at $x=0.50 \\ \\mathrm{m}$ and $x=0.90 \\ \\mathrm{m}$, so $L_{9} = |0.90 - 0.50| = 0.40 \\ \\mathrm{m}$.\n- Element $23$ connects nodes $(21, 5)$ at $x=1.20 \\ \\mathrm{m}$ and $x=0.90 \\ \\mathrm{m}$, so $L_{23} = |1.20 - 0.90| = 0.30 \\ \\mathrm{m}$.\n\nGlobal node $13$ is incident on elements $100$ and $9$. Therefore, the diagonal entry of the global stiffness matrix associated with node $13$ is\n$$\nK_{(13,13)} \\,=\\, \\frac{k A}{L_{100}} \\,+\\, \\frac{k A}{L_{9}}.\n$$\n\nInsert the given material and geometric properties $k = 180 \\ \\mathrm{W \\, m^{-1} \\, K^{-1}}$ and $A = 2.0 \\times 10^{-3} \\ \\mathrm{m^{2}}$:\n$$\nk A \\,=\\, 180 \\times \\left(2.0 \\times 10^{-3}\\right) \\,=\\, 3.6 \\times 10^{-1} \\ \\mathrm{W \\, m \\, K^{-1}}.\n$$\nThus,\n$$\nK_{(13,13)} \\,=\\, \\left(3.6 \\times 10^{-1}\\right)\\left(\\frac{1}{0.15} + \\frac{1}{0.40}\\right) \\ \\mathrm{W \\, K^{-1}}.\n$$\nCompute the reciprocal lengths:\n$$\n\\frac{1}{0.15} \\,=\\, \\frac{100}{15} \\,=\\, \\frac{20}{3} \\,=\\, 6.\\overline{6}, \n\\qquad\n\\frac{1}{0.40} \\,=\\, \\frac{10}{4} \\,=\\, \\frac{5}{2} \\,=\\, 2.5.\n$$\nTherefore,\n$$\nK_{(13,13)} \\,=\\, \\left(3.6 \\times 10^{-1}\\right)\\left( \\frac{20}{3} + \\frac{5}{2} \\right) \\ \\mathrm{W \\, K^{-1}}\n\\,=\\, \\left(3.6 \\times 10^{-1}\\right)\\left( \\frac{40}{6} + \\frac{15}{6} \\right) \\ \\mathrm{W \\, K^{-1}}\n\\,=\\, \\left(3.6 \\times 10^{-1}\\right)\\left( \\frac{55}{6} \\right) \\ \\mathrm{W \\, K^{-1}}.\n$$\nMultiply:\n$$\n\\left(3.6 \\times 10^{-1}\\right)\\left( \\frac{55}{6} \\right)\n\\,=\\, \\frac{3.6 \\times 55}{6} \\times 10^{-1}\n\\,=\\, \\frac{198}{6} \\times 10^{-1}\n\\,=\\, 33 \\times 10^{-1}\n\\,=\\, 3.3.\n$$\n\nHence, the diagonal entry associated with global node $13$ is\n$$\nK_{(13,13)} \\,=\\, 3.3 \\ \\mathrm{W \\, K^{-1}}.\n$$\nRounding to $4$ significant figures yields $3.300 \\ \\mathrm{W \\, K^{-1}}$ as required.", "answer": "$$\\boxed{3.300}$$", "id": "2393853"}, {"introduction": "To model complex geometries, FEM uses a powerful technique called isoparametric mapping to transform simple reference elements into varied shapes in the physical domain. However, this mapping can fail if the element is too distorted. This exercise [@problem_id:2172610] explores the mathematical heart of this issue—the Jacobian determinant—by investigating the conditions under which a $2D$ quadrilateral element becomes invalid, connecting an abstract mathematical tool to the tangible quality of a finite element mesh.", "problem": "A four-node isoparametric quadrilateral element is used to map a square parent domain, defined by $-1 \\le \\xi \\le 1$ and $-1 \\le \\eta \\le 1$, to a physical domain in the $xy$-plane. The nodes of the physical element are numbered counter-clockwise, and their coordinates are as follows:\n*   Node 1: $(x_1, y_1) = (0, 0)$ corresponding to $(\\xi, \\eta) = (-1, -1)$\n*   Node 2: $(x_2, y_2) = (4, 0)$ corresponding to $(\\xi, \\eta) = (1, -1)$\n*   Node 3: $(x_3, y_3) = (4, 4)$ corresponding to $(\\xi, \\eta) = (1, 1)$\n*   Node 4: $(x_4, y_4)$ corresponding to $(\\xi, \\eta) = (-1, 1)$\n\nThe position of Node 4 is variable. A valid mapping requires the quadrilateral to be convex, which is a condition for the determinant of the Jacobian of the transformation to remain positive throughout the element. As the position of Node 4 changes, the quadrilateral can transition from a convex shape to a non-convex (concave) shape. This transition occurs when Node 4 lies on a specific straight line determined by the other three nodes.\n\nDetermine the equation of this boundary line in the form $A x_4 + B y_4 + C = 0$. Provide your answer as a row matrix of the integer coefficients $[A, B, C]$, where the integers $A, B, C$ are co-prime (their greatest common divisor is 1) and the first non-zero coefficient is positive.", "solution": "For a four-node bilinear isoparametric quadrilateral, the mapping from $(\\xi,\\eta)$ to $(x,y)$ is given by\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i},\\quad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i},\n$$\nwith shape functions\n$$\nN_{1}=\\frac{(1-\\xi)(1-\\eta)}{4},\\quad\nN_{2}=\\frac{(1+\\xi)(1-\\eta)}{4},\\quad\nN_{3}=\\frac{(1+\\xi)(1+\\eta)}{4},\\quad\nN_{4}=\\frac{(1-\\xi)(1+\\eta)}{4}.\n$$\nThe Jacobian determinant is\n$$\nJ(\\xi,\\eta)=\\det\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix},\n$$\nand convexity with the given counter-clockwise node ordering requires $J(\\xi,\\eta)>0$ throughout $[-1,1]^{2}$. A transition from convex to non-convex occurs when $J$ first becomes zero somewhere in the domain; for a bilinear mapping, a necessary boundary is when $J$ vanishes at a corner.\n\nCompute the derivatives using $x_{1}=0$, $y_{1}=0$, $x_{2}=4$, $y_{2}=0$, $x_{3}=4$, $y_{3}=4$, and $(x_{4},y_{4})$ unknown:\n$$\n\\frac{\\partial x}{\\partial \\xi}=2-\\frac{x_{4}}{4}(1+\\eta),\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi}=(1+\\eta)\\left(1-\\frac{y_{4}}{4}\\right),\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}=\\frac{x_{4}}{4}(1-\\xi),\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta}=(1+\\xi)+\\frac{y_{4}}{4}(1-\\xi).\n$$\nEvaluate $J$ at the four corners:\n- At $(\\xi,\\eta)=(-1,-1)$:\n$$\n\\frac{\\partial x}{\\partial \\xi}=2,\\quad \\frac{\\partial y}{\\partial \\xi}=0,\\quad \\frac{\\partial x}{\\partial \\eta}=\\frac{x_{4}}{2},\\quad \\frac{\\partial y}{\\partial \\eta}=\\frac{y_{4}}{2},\n$$\nso\n$$\nJ(-1,-1)=2\\cdot \\frac{y_{4}}{2}-\\frac{x_{4}}{2}\\cdot 0=y_{4}.\n$$\n- At $(\\xi,\\eta)=(1,-1)$:\n$$\n\\frac{\\partial x}{\\partial \\xi}=2,\\quad \\frac{\\partial y}{\\partial \\xi}=0,\\quad \\frac{\\partial x}{\\partial \\eta}=0,\\quad \\frac{\\partial y}{\\partial \\eta}=2,\n$$\nso\n$$\nJ(1,-1)=2\\cdot 2-0\\cdot 0=4>0.\n$$\n- At $(\\xi,\\eta)=(1,1)$:\n$$\n\\frac{\\partial x}{\\partial \\xi}=2-\\frac{x_{4}}{2},\\quad \\frac{\\partial y}{\\partial \\xi}=2\\left(1-\\frac{y_{4}}{4}\\right),\\quad \\frac{\\partial x}{\\partial \\eta}=0,\\quad \\frac{\\partial y}{\\partial \\eta}=2,\n$$\nso\n$$\nJ(1,1)=\\left(2-\\frac{x_{4}}{2}\\right)\\cdot 2-0=4-x_{4}.\n$$\n- At $(\\xi,\\eta)=(-1,1)$:\n$$\n\\frac{\\partial x}{\\partial \\xi}=2-\\frac{x_{4}}{2},\\quad \\frac{\\partial y}{\\partial \\xi}=2-\\frac{y_{4}}{2},\\quad \\frac{\\partial x}{\\partial \\eta}=\\frac{x_{4}}{2},\\quad \\frac{\\partial y}{\\partial \\eta}=\\frac{y_{4}}{2},\n$$\nso\n$$\nJ(-1,1)=\\left(2-\\frac{x_{4}}{2}\\right)\\frac{y_{4}}{2}-\\frac{x_{4}}{2}\\left(2-\\frac{y_{4}}{2}\\right)=y_{4}-x_{4}.\n$$\n\nTherefore, the necessary boundary lines where $J$ can vanish are\n$$\ny_{4}=0,\\quad x_{4}=4,\\quad y_{4}=x_{4}.\n$$\nWith nodes $1$, $2$, and $3$ fixed as given and counter-clockwise, the convex region relevant to standard meshes is characterized by $y_{4}>0$, $x_{4}<4$, and $y_{4}>x_{4}$. The transition from convex to concave while remaining away from the degenerate edges $y_{4}=0$ and $x_{4}=4$ occurs precisely when Node 4 lies on the line through Nodes 1 and 3, namely $y_{4}=x_{4}$.\n\nWriting this as $A x_{4}+B y_{4}+C=0$ with co-prime integers and the first non-zero coefficient positive gives\n$$\nx_{4}-y_{4}=0\\quad\\Rightarrow\\quad [A,B,C]=[1,-1,0].\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1 & -1 & 0\\end{pmatrix}}$$", "id": "2172610"}]}