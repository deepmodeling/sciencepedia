{"hands_on_practices": [{"introduction": "This first exercise lays the groundwork for the Finite Element Method by focusing on its most fundamental component: the one-dimensional linear element. You will derive the interpolation function, $u_h(x)$, which approximates the solution within a single element by blending nodal values using linear basis (or shape) functions. Mastering this simple case is crucial, as it builds the intuition for how complex problems are broken down and solved piece by piece across a mesh [@problem_id:2172650].", "problem": "In the Finite Element Method (FEM), a continuous domain is discretized into smaller, simpler subdomains called finite elements. Consider a one-dimensional physical problem, such as heat transfer along a thin uniform rod. The rod is modeled as a line segment and is partitioned into several linear finite elements.\n\nWe are interested in a single generic linear element connecting two nodes, node $i$ and node $i+1$. These nodes are located at spatial coordinates $x_i$ and $x_{i+1}$, respectively. The values of the unknown field variable (e.g., temperature) at these nodes are denoted by $u_i$ and $u_{i+1}$.\n\nWithin this element, for any coordinate $x$ such that $x_i \\le x \\le x_{i+1}$, the field variable is approximated by a linear interpolation function, $u_h(x)$. This function is constructed as a linear combination of basis functions (also called shape functions) and the nodal values.\n\nDetermine the expression for the approximate solution $u_h(x)$ within this element. Your final answer should be expressed in terms of the variable $x$, the nodal coordinates $x_i$ and $x_{i+1}$, and the nodal values $u_i$ and $u_{i+1}$.", "solution": "We consider a single linear finite element on the interval $[x_{i},x_{i+1}]$ with nodal values $u_{i}$ at $x_{i}$ and $u_{i+1}$ at $x_{i+1}$. In the standard Galerkin finite element approximation for a linear element, the field within the element is represented as a linear combination of nodal values and corresponding linear shape functions:\n$$\nu_{h}(x)=N_{i}(x)\\,u_{i}+N_{i+1}(x)\\,u_{i+1}.\n$$\nFor a two-node linear element, the shape functions are the first-degree Lagrange polynomials on $[x_{i},x_{i+1}]$, uniquely determined by the interpolation (Kronecker-delta) conditions:\n$$\nN_{i}(x_{i})=1,\\quad N_{i}(x_{i+1})=0,\\quad N_{i+1}(x_{i})=0,\\quad N_{i+1}(x_{i+1})=1.\n$$\nThe linear polynomials satisfying these conditions are\n$$\nN_{i}(x)=\\frac{x_{i+1}-x}{x_{i+1}-x_{i}},\\qquad N_{i+1}(x)=\\frac{x-x_{i}}{x_{i+1}-x_{i}}.\n$$\nSubstituting these into the approximation gives the explicit interpolation formula within the element:\n$$\nu_{h}(x)=\\frac{x_{i+1}-x}{x_{i+1}-x_{i}}\\,u_{i}+\\frac{x-x_{i}}{x_{i+1}-x_{i}}\\,u_{i+1},\n$$\nwhich satisfies $u_{h}(x_{i})=u_{i}$ and $u_{h}(x_{i+1})=u_{i+1}$ as required.", "answer": "$$\\boxed{\\frac{x_{i+1}-x}{x_{i+1}-x_{i}}\\,u_{i}+\\frac{x-x_{i}}{x_{i+1}-x_{i}}\\,u_{i+1}}$$", "id": "2172650"}, {"introduction": "Real-world simulations often require meshes with varying densities, leading to \"hanging nodes\" where fine and coarse elements meet. To maintain a valid, continuous solution, we must design special \"transition elements\". This exercise challenges you to move beyond standard textbook formulas and derive the basis functions for a three-node transition element from first principles, ensuring continuity across the refinement interface [@problem_id:2375624]. This practice demonstrates the power and flexibility of the Kronecker-delta property in constructing custom shape functions for practical applications.", "problem": "Consider a one-dimensional interface between a coarse mesh region and a fine mesh region for the Finite Element Method (FEM). The interface is the reference interval $[-1,1] \\subset \\mathbb{R}$, where the coarse side is represented by a single element spanning $[-1,1]$, and the fine side is represented by two elements spanning $[-1,0]$ and $[0,1]$. To ensure a conforming discretization with a hanging node at $x=0$, introduce a three-node transition element on $[-1,1]$ with nodal locations $x=-1$, $x=0$, and $x=1$.\n\nLet the basis (shape) functions be $N_{-1}(x)$, $N_{0}(x)$, and $N_{1}(x)$ associated with the nodes at $x=-1$, $x=0$, and $x=1$, respectively. These basis functions must satisfy all of the following requirements:\n1. Nodal interpolation (Kronecker-delta property): $N_{i}(x_{j})=\\delta_{ij}$ for $i,j \\in \\{-1,0,1\\}$.\n2. Partition of unity: $N_{-1}(x)+N_{0}(x)+N_{1}(x)=1$ for all $x \\in [-1,1]$.\n3. Conformity to the fine mesh on subintervals: on $[-1,0]$, the restriction of the transition basis must coincide with the standard linear two-node basis on the nodes $x=-1$ and $x=0$; on $[0,1]$, the restriction must coincide with the standard linear two-node basis on the nodes $x=0$ and $x=1$. In particular, this implies that $N_{1}(x)=0$ on $[-1,0]$ and $N_{-1}(x)=0$ on $[0,1]$, and each active basis is linear within the corresponding subinterval.\n\nDerive explicit expressions for $N_{-1}(x)$, $N_{0}(x)$, and $N_{1}(x)$ on the entire interval $[-1,1]$ that satisfy all the above properties, and express your final answer as a single closed-form analytic expression without splitting into cases. Your final answer should be the row vector $[\\,N_{-1}(x)\\;N_{0}(x)\\;N_{1}(x)\\,]$.\n\nNo numerical approximation or rounding is required. Do not include physical units in your answer.", "solution": "The objective is to find explicit expressions for the three basis functions $N_{-1}(x)$, $N_{0}(x)$, and $N_{1}(x)$ on the reference interval $[-1,1]$ for a three-node transition element with nodes at $x_{-1}=-1$, $x_{0}=0$, and $x_{1}=1$.\n\nThe derivation proceeds from Requirement 3, which dictates the form of the basis functions on the subintervals $[-1,0]$ and $[0,1]$.\n\nFirst, consider the subinterval $[-1,0]$. The problem states that the basis here must coincide with the standard linear two-node basis on nodes $x=-1$ and $x=0$.\nThe standard linear Lagrangian basis functions on an interval $[x_a, x_b]$ are given by:\n$$L_a(x) = \\frac{x_b - x}{x_b - x_a}, \\quad L_b(x) = \\frac{x - x_a}{x_b - x_a}$$\nFor the interval $[-1,0]$, we have $x_a = -1$ and $x_b = 0$. The basis functions associated with these nodes are:\n$$L_{-1}(x) = \\frac{0 - x}{0 - (-1)} = -x$$\n$$L_{0}(x) = \\frac{x - (-1)}{0 - (-1)} = x+1$$\nAccording to Requirement 3, on the interval $[-1,0]$, the basis functions $N_i(x)$ are:\n$N_{-1}(x) = L_{-1}(x) = -x$\n$N_{0}(x) = L_{0}(x) = x+1$\nThe node $x=1$ is not part of this sub-element, so its corresponding basis function must be zero. This is also explicitly stated as an implication in Requirement 3.\n$N_{1}(x) = 0$\n\nNext, consider the subinterval $[0,1]$. The basis must coincide with the standard linear two-node basis on nodes $x=0$ and $x=1$.\nFor the interval $[0,1]$, we have $x_a = 0$ and $x_b = 1$. The basis functions associated with these nodes are:\n$$L_0(x) = \\frac{1 - x}{1 - 0} = 1-x$$\n$$L_1(x) = \\frac{x - 0}{1 - 0} = x$$\nAccording to Requirement 3, on the interval $[0,1]$, the basis functions $N_i(x)$ are:\n$N_{0}(x) = L_{0}(x) = 1-x$\n$N_{1}(x) = L_{1}(x) = x$\nThe node $x=-1$ is not part of this sub-element, so its corresponding basis function must be zero.\n$N_{-1}(x) = 0$\n\nCombining these results, we obtain the piecewise definitions for the basis functions on the entire interval $[-1,1]$:\n$$N_{-1}(x) = \\begin{cases} -x & \\text{for } x \\in [-1, 0] \\\\ 0 & \\text{for } x \\in [0, 1] \\end{cases}$$\n$$N_{0}(x) = \\begin{cases} x+1 & \\text{for } x \\in [-1, 0] \\\\ 1-x & \\text{for } x \\in [0, 1] \\end{cases}$$\n$$N_{1}(x) = \\begin{cases} 0 & \\text{for } x \\in [-1, 0] \\\\ x & \\text{for } x \\in [0, 1] \\end{cases}$$\n\nThe problem requires a single closed-form analytic expression for each function. We can achieve this using the absolute value function, $|x|$, which is defined as:\n$$|x| = \\begin{cases} -x & \\text{for } x < 0 \\\\ x & \\text{for } x \\ge 0 \\end{cases}$$\n\nFor $N_{0}(x)$:\nOn $[-1,0]$, we have $|x|=-x$, so $1-|x| = 1-(-x) = 1+x$. This matches.\nOn $[0,1]$, we have $|x|=x$, so $1-|x| = 1-x$. This matches.\nThus, the closed-form expression for $N_{0}(x)$ is:\n$$N_{0}(x) = 1 - |x|$$\n\nFor $N_{-1}(x)$:\nConsider the expression $\\frac{1}{2}(-x+|x|)$.\nOn $[-1,0]$, $|x|=-x$, so the expression becomes $\\frac{1}{2}(-x-x) = -x$. This matches.\nOn $[0,1]$, $|x|=x$, so the expression becomes $\\frac{1}{2}(-x+x) = 0$. This matches.\nThus, the closed-form expression for $N_{-1}(x)$ is:\n$$N_{-1}(x) = \\frac{1}{2}(-x+|x|)$$\n\nFor $N_{1}(x)$:\nConsider the expression $\\frac{1}{2}(x+|x|)$.\nOn $[-1,0]$, $|x|=-x$, so the expression becomes $\\frac{1}{2}(x-x) = 0$. This matches.\nOn $[0,1]$, $|x|=x$, so the expression becomes $\\frac{1}{2}(x+x) = x$. This matches.\nThus, the closed-form expression for $N_{1}(x)$ is:\n$$N_{1}(x) = \\frac{1}{2}(x+|x|)$$\n\nWe must verify that these closed-form expressions satisfy all three original requirements.\n\n1. Nodal Interpolation ($N_{i}(x_{j})=\\delta_{ij}$):\nAt $x=-1$:\n$N_{-1}(-1) = \\frac{1}{2}(-(-1)+|-1|) = \\frac{1}{2}(1+1) = 1$\n$N_{0}(-1) = 1 - |-1| = 1 - 1 = 0$\n$N_{1}(-1) = \\frac{1}{2}(-1+|-1|) = \\frac{1}{2}(-1+1) = 0$\nAt $x=0$:\n$N_{-1}(0) = \\frac{1}{2}(-0+|0|) = 0$\n$N_{0}(0) = 1 - |0| = 1$\n$N_{1}(0) = \\frac{1}{2}(0+|0|) = 0$\nAt $x=1$:\n$N_{-1}(1) = \\frac{1}{2}(-1+|1|) = \\frac{1}{2}(-1+1) = 0$\n$N_{0}(1) = 1 - |1| = 1 - 1 = 0$\n$N_{1}(1) = \\frac{1}{2}(1+|1|) = \\frac{1}{2}(1+1) = 1$\nThe nodal interpolation property is satisfied.\n\n2. Partition of Unity ($\\sum_{i} N_{i}(x) = 1$):\n$$N_{-1}(x)+N_{0}(x)+N_{1}(x) = \\frac{1}{2}(-x+|x|) + (1-|x|) + \\frac{1}{2}(x+|x|)$$\n$$= \\left(\\frac{-x}{2} + \\frac{x}{2}\\right) + \\left(\\frac{|x|}{2} - |x| + \\frac{|x|}{2}\\right) + 1$$\n$$= 0 + \\left(|x| - |x|\\right) + 1 = 1$$\nThe partition of unity is satisfied for all $x \\in [-1,1]$.\n\n3. Conformity: The closed-form expressions were constructed precisely to match the piecewise linear functions derived from the conformity requirement. Therefore, this property is satisfied by construction.\n\nThe derived basis functions meet all specified criteria. The final answer is the row vector containing these three functions.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}(-x+|x|) & 1-|x| & \\frac{1}{2}(x+|x|)\n\\end{pmatrix}\n}\n$$", "id": "2375624"}, {"introduction": "In the isoparametric formulation, the same shape functions that approximate the solution field are also used to map the geometry from an ideal reference element to the physical element in the mesh. The validity of this mapping is governed by its Jacobian matrix, whose determinant, $J$, relates the differential areas between the two domains. This exercise provides a hands-on look at the consequences of severe mesh distortion by having you compute the Jacobian for a deliberately misshapen quadratic element, revealing how a negative determinant signals a physically meaningless \"inside-out\" element and a failure of the simulation [@problem_id:2375611].", "problem": "Consider the isoparametric quadratic triangular element used in the Finite Element Method (FEM). Let the reference (parent) triangle be defined in the natural coordinates $(\\xi,\\eta)$ by $\\xi \\ge 0$, $\\eta \\ge 0$, and $\\xi + \\eta \\le 1$. Let the associated area (barycentric) coordinates be $L_{1} = 1 - \\xi - \\eta$, $L_{2} = \\xi$, and $L_{3} = \\eta$. The physical element has vertex nodes at $(x_{1},y_{1}) = (0,0)$, $(x_{2},y_{2}) = (1,0)$, and $(x_{3},y_{3}) = (0,1)$. The mid-side nodes are $(x_{4},y_{4}) = \\left(\\frac{1}{2},0\\right)$ on edge $1$–$2$, $(x_{6},y_{6}) = \\left(0,\\frac{1}{2}\\right)$ on edge $3$–$1$, and node $5$ (nominally on edge $2$–$3$) is deliberately moved to $(x_{5},y_{5}) = \\left(0,\\frac{1}{5}\\right)$. Using the standard quadratic shape functions constructed from the area coordinates for a $6$-node quadratic triangle, form the isoparametric map $(x(\\xi,\\eta),y(\\xi,\\eta)) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) (x_{i},y_{i})$, compute the Jacobian matrix $\\partial(x,y)/\\partial(\\xi,\\eta)$ at the centroid $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$, and evaluate its determinant $J$ at that point. Report the exact value of $J$ (no rounding). Then, in a single sentence, state the physical meaning of the sign of $J$ for this element configuration. Your final numerical answer should be the value of $J$.", "solution": "The problem requires the computation of the Jacobian determinant of an isoparametric mapping for a $6$-node quadratic triangular element at a specific point. The physical coordinates $(x,y)$ are mapped from the reference coordinates $(\\xi,\\eta)$ using the relation:\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) x_{i}\n$$\n$$\ny(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) y_{i}\n$$\nwhere $(x_i, y_i)$ are the nodal coordinates in the physical domain and $N_i$ are the quadratic shape functions defined in the reference domain.\n\nThe shape functions for a $6$-node serendipity triangle are given in terms of the area coordinates $L_1$, $L_2$, and $L_3$. For the vertex nodes ($i=1,2,3$), the shape functions are:\n$$\nN_1 = L_1(2L_1 - 1)\n$$\n$$\nN_2 = L_2(2L_2 - 1)\n$$\n$$\nN_3 = L_3(2L_3 - 1)\n$$\nFor the mid-side nodes ($i=4,5,6$), located on edges $1$-$2$, $2$-$3$, and $3$-$1$ respectively, the shape functions are:\n$$\nN_4 = 4L_1L_2\n$$\n$$\nN_5 = 4L_2L_3\n$$\n$$\nN_6 = 4L_3L_1\n$$\nThe area coordinates are related to the natural coordinates $(\\xi, \\eta)$ by:\n$L_1 = 1 - \\xi - \\eta$, $L_2 = \\xi$, and $L_3 = \\eta$.\nSubstituting these into the expressions for the shape functions yields:\n$N_1 = (1 - \\xi - \\eta)(1 - 2\\xi - 2\\eta)$\n$N_2 = \\xi(2\\xi - 1)$\n$N_3 = \\eta(2\\eta - 1)$\n$N_4 = 4\\xi(1 - \\xi - \\eta)$\n$N_5 = 4\\xi\\eta$\n$N_6 = 4\\eta(1 - \\xi - \\eta)$\n\nThe given nodal coordinates in the physical domain are:\n$(x_{1},y_{1}) = (0,0)$\n$(x_{2},y_{2}) = (1,0)$\n$(x_{3},y_{3}) = (0,1)$\n$(x_{4},y_{4}) = (\\frac{1}{2},0)$\n$(x_{5},y_{5}) = (0,\\frac{1}{5})$\n$(x_{6},y_{6}) = (0,\\frac{1}{2})$\n\nWe construct the mapping for $x(\\xi,\\eta)$ by summing the products of the shape functions and the corresponding $x$-coordinates:\n$$\nx(\\xi,\\eta) = N_1(0) + N_2(1) + N_3(0) + N_4\\left(\\frac{1}{2}\\right) + N_5(0) + N_6(0)\n$$\n$$\nx(\\xi,\\eta) = N_2 + \\frac{1}{2}N_4 = \\xi(2\\xi - 1) + \\frac{1}{2} \\cdot 4\\xi(1 - \\xi - \\eta) = 2\\xi^2 - \\xi + 2\\xi(1 - \\xi - \\eta)\n$$\n$$\nx(\\xi,\\eta) = 2\\xi^2 - \\xi + 2\\xi - 2\\xi^2 - 2\\xi\\eta = \\xi - 2\\xi\\eta\n$$\nSimilarly, for $y(\\xi,\\eta)$:\n$$\ny(\\xi,\\eta) = N_1(0) + N_2(0) + N_3(1) + N_4(0) + N_5\\left(\\frac{1}{5}\\right) + N_6\\left(\\frac{1}{2}\\right)\n$$\n$$\ny(\\xi,\\eta) = N_3 + \\frac{1}{5}N_5 + \\frac{1}{2}N_6 = \\eta(2\\eta - 1) + \\frac{1}{5}(4\\xi\\eta) + \\frac{1}{2}(4\\eta(1 - \\xi - \\eta))\n$$\n$$\ny(\\xi,\\eta) = 2\\eta^2 - \\eta + \\frac{4}{5}\\xi\\eta + 2\\eta(1 - \\xi - \\eta) = 2\\eta^2 - \\eta + \\frac{4}{5}\\xi\\eta + 2\\eta - 2\\xi\\eta - 2\\eta^2\n$$\n$$\ny(\\xi,\\eta) = \\eta + \\left(\\frac{4}{5} - 2\\right)\\xi\\eta = \\eta - \\frac{6}{5}\\xi\\eta\n$$\nThe isoparametric mapping is thus:\n$x(\\xi,\\eta) = \\xi(1 - 2\\eta)$\n$y(\\xi,\\eta) = \\eta\\left(1 - \\frac{6}{5}\\xi\\right)$\n\nThe Jacobian matrix $\\mathbf{J}$ of the transformation is defined as:\n$$\n\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nWe compute the partial derivatives:\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi - 2\\xi\\eta) = 1 - 2\\eta$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi - 2\\xi\\eta) = -2\\xi$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\eta - \\frac{6}{5}\\xi\\eta) = -\\frac{6}{5}\\eta$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\eta - \\frac{6}{5}\\xi\\eta) = 1 - \\frac{6}{5}\\xi$\nThe Jacobian matrix is:\n$$\n\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} 1 - 2\\eta & -2\\xi \\\\ -\\frac{6}{5}\\eta & 1 - \\frac{6}{5}\\xi \\end{pmatrix}\n$$\nWe must evaluate this matrix at the centroid of the reference triangle, which is at $(\\xi, \\eta) = (\\frac{1}{3}, \\frac{1}{3})$.\nSubstituting these values:\n$\\frac{\\partial x}{\\partial \\xi} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = 1 - 2\\left(\\frac{1}{3}\\right) = \\frac{1}{3}$\n$\\frac{\\partial x}{\\partial \\eta} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = -2\\left(\\frac{1}{3}\\right) = -\\frac{2}{3}$\n$\\frac{\\partial y}{\\partial \\xi} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = -\\frac{6}{5}\\left(\\frac{1}{3}\\right) = -\\frac{2}{5}$\n$\\frac{\\partial y}{\\partial \\eta} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = 1 - \\frac{6}{5}\\left(\\frac{1}{3}\\right) = 1 - \\frac{2}{5} = \\frac{3}{5}$\nThe Jacobian matrix at the centroid is:\n$$\n\\mathbf{J}\\left(\\frac{1}{3},\\frac{1}{3}\\right) = \\begin{pmatrix} \\frac{1}{3} & -\\frac{2}{3} \\\\ -\\frac{2}{5} & \\frac{3}{5} \\end{pmatrix}\n$$\nThe determinant $J$ of this matrix is:\n$$\nJ = \\det(\\mathbf{J}) = \\left(\\frac{1}{3}\\right)\\left(\\frac{3}{5}\\right) - \\left(-\\frac{2}{3}\\right)\\left(-\\frac{2}{5}\\right) = \\frac{3}{15} - \\frac{4}{15} = -\\frac{1}{15}\n$$\nThe value of the Jacobian determinant at the centroid is $-\\frac{1}{15}$.\n\nThe physical meaning of the sign of the Jacobian determinant $J$ relates to the local validity of the mapping; the negative sign of $J$ indicates that the isoparametric mapping from reference to physical coordinates is not one-to-one and has locally inverted the element geometry at that point.", "answer": "$$ \\boxed{-\\frac{1}{15}} $$", "id": "2375611"}]}