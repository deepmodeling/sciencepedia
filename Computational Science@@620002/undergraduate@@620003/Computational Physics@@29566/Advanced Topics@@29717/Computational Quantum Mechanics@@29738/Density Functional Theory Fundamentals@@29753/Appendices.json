{"hands_on_practices": [{"introduction": "The Kohn-Sham (KS) framework is the workhorse of modern DFT, built on the remarkable idea that the ground-state density of a complex, interacting system can be reproduced by a simpler, non-interacting system. This practice provides a rare opportunity to make this abstract concept concrete by working with an exactly solvable model. By deriving the exact ground-state density of an interacting two-particle system, you will \"invert\" the process to construct the one-of-a-kind Kohn-Sham potential, $v_{KS}(x)$, that perfectly yields this density [@problem_id:2384975].", "problem": "In atomic units, consider a one-dimensional system of two indistinguishable spin-$\\tfrac{1}{2}$ fermions in a spin-singlet state with the interacting Hamiltonian\n$$\n\\hat{H}(\\omega,k) \\;=\\; -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} \\;-\\;\\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2} \\;+\\; \\frac{1}{2}\\,\\omega^2\\,(x_1^2+x_2^2) \\;+\\; \\frac{1}{2}\\,k\\,(x_1-x_2)^2,\n$$\nwhere $\\omega0$ and $k\\ge 0$ are real constants, $x_1$ and $x_2$ are the particle coordinates along the line, and all quantities are expressed in atomic units (energies in Hartree and lengths in bohr). Introduce the center-of-mass and relative coordinates\n$$\nX=\\frac{x_1+x_2}{2},\\qquad u=x_1-x_2.\n$$\nAssume the spatial ground state is normalized and nondegenerate. The exact one-body density is\n$$\nn(x)\\;=\\;2\\int_{-\\infty}^{+\\infty}\\left|\\Psi(x,x_2)\\right|^2\\,dx_2,\n$$\nwhere $\\Psi(x_1,x_2)$ is the exact interacting ground-state spatial wavefunction.\n\nIn Kohn–Sham Density Functional Theory (DFT), the spin-compensated two-electron system is mapped to a single doubly occupied Kohn–Sham (KS) orbital $\\varphi(x)$ obeying the time-independent Kohn–Sham equation\n$$\n\\left[-\\frac{1}{2}\\frac{d^2}{dx^2}+v_{KS}(x)\\right]\\varphi(x)=\\varepsilon\\,\\varphi(x),\\qquad n(x)=2|\\varphi(x)|^2,\n$$\nwhere $v_{KS}(x)$ is the Kohn–Sham effective potential and $\\varepsilon$ is the corresponding orbital energy. The potential $v_{KS}(x)$ is defined up to an additive constant. Fix its gauge by the convention\n$$\nv_{KS}(0)=0.\n$$\n\nTask: For the system $\\hat{H}(\\omega,k)$ defined above, use first principles to construct an exactly solvable interacting ground state, obtain the exact density $n(x)$, and then numerically determine the exact Kohn–Sham potential $v_{KS}(x)$ that reproduces this density for a single doubly occupied orbital. You must use the gauge condition $v_{KS}(0)=0$ and return the following three scalar quantities for each parameter pair $(\\omega,k)$:\n- the value $v_{KS}(0)$ in Hartree,\n- the value $v_{KS}(x)$ at $x=1$ bohr (i.e., $v_{KS}(1)$) in Hartree,\n- the curvature $\\kappa=\\left.\\dfrac{d^2 v_{KS}}{dx^2}\\right|_{x=0}$ in Hartree per bohr squared.\n\nUse the following test suite of parameter values:\n- Case A: $(\\omega,k)=(1.0,0.5)$,\n- Case B: $(\\omega,k)=(1.2,0.0)$,\n- Case C: $(\\omega,k)=(0.8,4.0)$.\n\nYour program must output a single line containing the nine results, ordered case by case as\n$$\n\\big[v_{KS}^{(A)}(0),\\; v_{KS}^{(A)}(1),\\; \\kappa^{(A)},\\; v_{KS}^{(B)}(0),\\; v_{KS}^{(B)}(1),\\; \\kappa^{(B)},\\; v_{KS}^{(C)}(0),\\; v_{KS}^{(C)}(1),\\; \\kappa^{(C)}\\big],\n$$\nprinted as a comma-separated list enclosed in square brackets, on a single line, with no additional text. All energies must be in Hartree and the curvature in Hartree per bohr squared. Angles do not appear in this problem. Percentages do not appear; any ratios must be expressed as decimals or fractions without a percentage sign.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It describes a solvable model system, the one-dimensional harmonium atom, and poses a standard task in density functional theory: the inversion of the Kohn-Sham equations to find the exact effective potential that reproduces the exact ground-state density. The problem is valid and a solution will be provided.\n\nThe procedure is as follows: first, we solve the exact two-particle Schrödinger equation by separating the Hamiltonian into center-of-mass and relative coordinates. Second, we derive the exact one-body density from the resulting ground-state wavefunction. Third, we use the definition of the Kohn-Sham system to determine the unique Kohn-Sham orbital and, by inverting the Kohn-Sham equation, the exact Kohn-Sham potential $v_{KS}(x)$. Finally, we compute the required quantities for the specified parameters.\n\n### Step 1: Solving the Exact Interacting System\n\nThe two-particle Hamiltonian is given by\n$$\n\\hat{H}(\\omega,k) \\;=\\; -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} \\;-\\;\\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2} \\;+\\; \\frac{1}{2}\\,\\omega^2\\,(x_1^2+x_2^2) \\;+\\; \\frac{1}{2}\\,k\\,(x_1-x_2)^2.\n$$\nWe introduce the center-of-mass coordinate $X=\\frac{x_1+x_2}{2}$ and the relative coordinate $u=x_1-x_2$. The inverse transformation is $x_1=X+\\frac{u}{2}$ and $x_2=X-\\frac{u}{2}$.\n\nIn these new coordinates, the kinetic energy operator becomes\n$$\n-\\frac{1}{2}\\left(\\frac{\\partial^2}{\\partial x_1^2} + \\frac{\\partial^2}{\\partial x_2^2}\\right) = -\\frac{1}{2\\cdot 2}\\frac{\\partial^2}{\\partial X^2} - \\frac{1}{2\\cdot(1/2)}\\frac{\\partial^2}{\\partial u^2} = -\\frac{1}{4}\\frac{\\partial^2}{\\partial X^2} - \\frac{\\partial^2}{\\partial u^2}.\n$$\nThis corresponds to the kinetic energy of a center-of-mass particle with mass $M=2$ and a relative particle with reduced mass $\\mu=1/2$.\n\nThe potential energy becomes\n$$\nV(x_1, x_2) = \\frac{1}{2}\\omega^2(x_1^2+x_2^2) + \\frac{1}{2}k(x_1-x_2)^2 = \\frac{1}{2}\\omega^2\\left(2X^2 + \\frac{u^2}{2}\\right) + \\frac{1}{2}ku^2 = \\omega^2 X^2 + \\left(\\frac{\\omega^2}{4} + \\frac{k}{2}\\right)u^2.\n$$\nThe Hamiltonian is separable: $\\hat{H} = \\hat{H}_X + \\hat{H}_u$, where\n$$\n\\hat{H}_X = -\\frac{1}{4}\\frac{\\partial^2}{\\partial X^2} + \\omega^2 X^2 = -\\frac{1}{2M}\\frac{\\partial^2}{\\partial X^2} + \\frac{1}{2}M\\Omega_X^2 X^2\n$$\n$$\n\\hat{H}_u = -\\frac{\\partial^2}{\\partial u^2} + \\left(\\frac{\\omega^2}{4} + \\frac{k}{2}\\right)u^2 = -\\frac{1}{2\\mu}\\frac{\\partial^2}{\\partial u^2} + \\frac{1}{2}\\mu\\Omega_u^2 u^2.\n$$\nBy comparing the coefficients, we find the frequencies of the two uncoupled harmonic oscillators:\nFor the center-of-mass motion: $M=2$, $\\frac{1}{2}M\\Omega_X^2 = \\omega^2 \\implies \\Omega_X^2 = \\omega^2 \\implies \\Omega_X = \\omega$.\nFor the relative motion: $\\mu=1/2$, $\\frac{1}{2}\\mu\\Omega_u^2 = \\frac{\\omega^2}{4} + \\frac{k}{2} \\implies \\frac{1}{4}\\Omega_u^2 = \\frac{\\omega^2}{4} + \\frac{k}{2} \\implies \\Omega_u = \\sqrt{\\omega^2+2k}$.\n\nThe ground-state wavefunction of the system is the product of the ground-state wavefunctions of these two oscillators, $\\Psi(X,u) = \\Psi_X(X) \\Psi_u(u)$. For a spin-singlet state, the spatial wavefunction must be symmetric under particle exchange ($x_1 \\leftrightarrow x_2$), which corresponds to $(X, u) \\leftrightarrow (X, -u)$. The ground state of the relative oscillator is an even function of $u$, so this condition is satisfied.\nThe ground-state wavefunction is a Gaussian:\n$$\n\\Psi(x_1, x_2) = C \\exp\\left(-\\frac{M\\Omega_X}{2}X^2 - \\frac{\\mu\\Omega_u}{2}u^2\\right) = C \\exp\\left(-\\omega X^2 - \\frac{\\sqrt{\\omega^2+2k}}{4}u^2\\right),\n$$\nwhere $C$ is a normalization constant.\n\n### Step 2: Derivation of the Exact One-Body Density\n\nThe one-body density is defined as $n(x) = 2 \\int_{-\\infty}^{\\infty} |\\Psi(x, x_2)|^2 dx_2$. Let $x_1=x$.\nThe squared wavefunction is $|\\Psi(x,x_2)|^2 = |C|^2 \\exp\\left(-2\\omega (\\frac{x+x_2}{2})^2 - \\frac{\\sqrt{\\omega^2+2k}}{2} (x-x_2)^2\\right)$.\nThe integral over $x_2$ is a standard Gaussian integral. The exponent is a quadratic form of $x_2$: $A x_2^2 + B x_2 + D$. After performing the integration, the density is found to be a Gaussian function of $x$:\n$$\nn(x) = N_0 \\exp(-\\gamma x^2),\n$$\nwhere the decay constant $\\gamma$ is given by\n$$\n\\gamma = \\frac{2\\omega\\Omega_u}{\\omega+\\Omega_u} = \\frac{2\\omega\\sqrt{\\omega^2+2k}}{\\omega+\\sqrt{\\omega^2+2k}}.\n$$\nThe normalization constant $N_0$ is such that $\\int_{-\\infty}^\\infty n(x)dx=2$.\n\n### Step 3: Inversion of the Kohn-Sham Equation\n\nIn the Kohn-Sham framework for this spin-compensated system, the density is given by $n(x) = 2|\\varphi(x)|^2$, where $\\varphi(x)$ is the single doubly-occupied Kohn-Sham orbital.\nFrom the exact density, we find the KS orbital (up to an irrelevant phase factor, we choose it to be real and positive):\n$$\n\\varphi(x) = \\sqrt{\\frac{n(x)}{2}} = \\sqrt{\\frac{N_0}{2}} \\exp\\left(-\\frac{\\gamma}{2}x^2\\right).\n$$\nThis is a Gaussian function, which is the ground state of a one-dimensional simple harmonic oscillator. Therefore, the Kohn-Sham potential $v_{KS}(x)$ must be a quadratic potential of the form $v_{KS}(x) = \\frac{1}{2}m_{KS}\\omega_{KS}^2 x^2 + \\text{constant}$.\n\nWe can determine $v_{KS}(x)$ by inverting the KS equation:\n$$\nv_{KS}(x) = \\varepsilon + \\frac{1}{2}\\frac{1}{\\varphi(x)}\\frac{d^2\\varphi(x)}{dx^2}.\n$$\nLet $\\varphi(x) = A \\exp(-\\frac{\\gamma}{2}x^2)$. Its second derivative is $\\frac{d^2\\varphi}{dx^2} = (-\\gamma+\\gamma^2 x^2)\\varphi(x)$.\nSubstituting this into the expression for $v_{KS}(x)$:\n$$\nv_{KS}(x) = \\varepsilon + \\frac{1}{2}(-\\gamma+\\gamma^2 x^2) = \\left(\\varepsilon - \\frac{\\gamma}{2}\\right) + \\frac{1}{2}\\gamma^2 x^2.\n$$\nThe potential is defined up to a constant. We use the specified gauge condition $v_{KS}(0)=0$ to fix this constant.\n$$\nv_{KS}(0) = \\varepsilon - \\frac{\\gamma}{2} = 0 \\implies \\varepsilon = \\frac{\\gamma}{2}.\n$$\nTherefore, the exact Kohn-Sham potential is\n$$\nv_{KS}(x) = \\frac{1}{2}\\gamma^2 x^2.\n$$\n\n### Step 4: Calculation of Observable Quantities\n\nWe can now compute the required quantities using the derived expression for $v_{KS}(x)$ and $\\gamma$.\n1.  The value of the potential at the origin: By the gauge condition, this is exactly zero.\n    $$\n    v_{KS}(0) = 0.\n    $$\n2.  The value of the potential at $x=1$ bohr:\n    $$\n    v_{KS}(1) = \\frac{1}{2}\\gamma^2.\n    $$\n3.  The curvature of the potential at the origin:\n    $$\n    \\kappa = \\left.\\frac{d^2 v_{KS}}{dx^2}\\right|_{x=0} = \\left.\\frac{d^2}{dx^2}\\left(\\frac{1}{2}\\gamma^2 x^2\\right)\\right|_{x=0} = \\gamma^2.\n    $$\nNotice that $v_{KS}(1) = \\kappa/2$.\n\nThe final procedure is to substitute the given values of $\\omega$ and $k$ for each case into the expression for $\\gamma$, then compute $\\kappa = \\gamma^2$ and $v_{KS}(1) = \\kappa/2$.\n\nThe calculation for Case A, $(\\omega,k)=(1.0,0.5)$, serves as an example:\n$\\Omega_u = \\sqrt{1.0^2 + 2(0.5)} = \\sqrt{2}$.\n$\\gamma = \\frac{2(1.0)\\sqrt{2}}{1.0+\\sqrt{2}} = \\frac{2\\sqrt{2}( \\sqrt{2}-1)}{(1+\\sqrt{2})(\\sqrt{2}-1)} = 4 - 2\\sqrt{2}$.\n$\\kappa = (4 - 2\\sqrt{2})^2 = 16 - 16\\sqrt{2} + 8 = 24 - 16\\sqrt{2}$.\n$v_{KS}(1) = \\frac{1}{2}\\kappa = 12 - 8\\sqrt{2}$.\n$v_{KS}(0) = 0$.\n\nThe same procedure is applied to all test cases to generate the final numerical results.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Kohn-Sham potential properties for a 1D two-electron system.\n\n    The problem provides an exactly solvable interacting two-electron system in a \n    harmonic trap with harmonic inter-particle interaction. The task is to find \n    the exact Kohn-Sham (KS) potential that reproduces the exact ground-state density.\n\n    The analytic solution shows that the KS potential is also harmonic, of the form\n    v_KS(x) = 0.5 * gamma**2 * x**2, where gamma is a function of the system\n    parameters omega and k.\n    \"\"\"\n    \n    # Test cases are given as tuples (omega, k).\n    test_cases = [\n        (1.0, 0.5),  # Case A\n        (1.2, 0.0),  # Case B\n        (0.8, 4.0),  # Case C\n    ]\n\n    results = []\n    \n    for omega, k in test_cases:\n        # Step 1: Calculate the frequency of the relative-coordinate oscillator.\n        # Omega_u = sqrt(omega^2 + 2*k)\n        omega_u = np.sqrt(omega**2 + 2 * k)\n\n        # Step 2: Calculate the density decay parameter gamma.\n        # gamma = (2 * omega * Omega_u) / (omega + Omega_u)\n        gamma = (2 * omega * omega_u) / (omega + omega_u)\n\n        # Step 3: Calculate the requested quantities.\n        # The KS potential is v_KS(x) = 0.5 * gamma^2 * x^2.\n        \n        # v_KS(0) is 0 by the specified gauge condition.\n        vks_at_0 = 0.0\n        \n        # The curvature kappa is the second derivative at x=0, which is gamma^2.\n        kappa = gamma**2\n        \n        # v_KS(1) is simply 0.5 * gamma^2 * 1^2 = 0.5 * kappa.\n        vks_at_1 = kappa / 2.0\n        \n        results.extend([vks_at_0, vks_at_1, kappa])\n\n    # Format the results into the required string format.\n    # e.g., \"[0.0,0.6862915062890378,1.3725830125780757,...]\"\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2384975"}, {"introduction": "While exactly solvable models are deeply insightful, real-world applications of DFT rely on approximations for the exchange-correlation functional. This hands-on exercise takes you into the engine room of computational quantum chemistry, comparing the widely-used Hartree-Fock (HF) theory with the foundational Local Density Approximation (LDA) of DFT. By calculating the orbital energies for the helium atom from first principles in both formalisms, you will gain a practical understanding of how these two powerful methods differ, especially in their treatment of electron exchange [@problem_id:2384971].", "problem": "Implement a minimal-basis calculation of the helium atom using both the Hartree–Fock method and the Local Density Approximation (LDA) exchange-only Kohn–Sham approach, and report the resulting orbital energies. Use atomic units throughout, so that the unit of energy is the Hartree. The helium nucleus of charge $Z=2$ is fixed at the origin. Use a single normalized $s$-type Gaussian basis function centered at the origin with exponent $\\alpha0$ given by\n$$\n\\phi_{\\alpha}(\\mathbf{r})=\\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4} e^{-\\alpha r^2}.\n$$\nAssume a closed-shell configuration with two electrons occupying the same spatial orbital so that the electron density is\n$$\n\\rho(\\mathbf{r}) = 2 \\lvert \\phi_{\\alpha}(\\mathbf{r}) \\rvert^2.\n$$\nDefine the one-electron core Hamiltonian operator\n$$\n\\hat{h} = -\\frac{1}{2}\\nabla^2 - \\frac{Z}{r}.\n$$\nDefine the Hartree potential as the Coulomb potential generated by the electron density,\n$$\nv_{\\mathrm{H}}(\\mathbf{r}) = \\int \\frac{\\rho(\\mathbf{r'})}{\\lvert \\mathbf{r}-\\mathbf{r'} \\rvert} \\, d^3 r'.\n$$\nFor the Local Density Approximation (exchange-only), use the Dirac exchange potential for the spin-unpolarized uniform electron gas,\n$$\nv_{\\mathrm{x}}(\\rho) = - \\left(\\frac{3}{\\pi}\\right)^{1/3} \\rho^{1/3}.\n$$\nFor the Hartree–Fock calculation, define the orbital energy of the doubly occupied spatial orbital as the expectation value of the Fock operator in the minimal basis representation derived from first principles, using the exact integral definitions for the kinetic, nuclear attraction, Coulomb (Hartree), and exchange terms appropriate for a closed-shell system with a single spatial orbital. For the LDA calculation, define the Kohn–Sham orbital energy as the expectation value of the Kohn–Sham operator\n$$\n\\hat{h}_{\\mathrm{KS}} = -\\frac{1}{2}\\nabla^2 - \\frac{Z}{r} + v_{\\mathrm{H}}[\\rho](\\mathbf{r}) + v_{\\mathrm{x}}[\\rho](\\mathbf{r}),\n$$\nevaluated self-consistently with the given density built from the same single basis function and closed-shell occupation.\n\nYour program must, for each specified Gaussian exponent $\\alpha$, compute:\n- the Hartree–Fock orbital energy in Hartree,\n- the LDA (exchange-only) Kohn–Sham orbital energy in Hartree,\n\nboth obtained from first principles using the definitions above with the given basis function and density, without invoking any external data. For this problem, correlation is to be neglected, that is, only the exchange part of the Local Density Approximation is to be included.\n\nExpress all final energies in Hartree and round each to eight decimal places.\n\nTest Suite:\nUse the following set of Gaussian exponents as input cases to fully assess general behavior, diffuse and tight basis limits, and intermediate values:\n- $\\alpha = 0.05$,\n- $\\alpha = 0.5$,\n- $\\alpha = 1.0$,\n- $\\alpha = 2.0$,\n- $\\alpha = 6.0$,\n- $\\alpha = 20.0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each exponent $\\alpha$ in the order listed above, first output the Hartree–Fock orbital energy and then the LDA orbital energy, both rounded to eight decimal places. The final list therefore contains $12$ floating-point numbers and must follow the exact format\n$$\n[\\varepsilon_{\\mathrm{HF}}(\\alpha_1),\\varepsilon_{\\mathrm{LDA}}(\\alpha_1),\\varepsilon_{\\mathrm{HF}}(\\alpha_2),\\varepsilon_{\\mathrm{LDA}}(\\alpha_2),\\dots].\n$$", "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded, well-posed, and objective, presenting a standard problem in computational quantum physics.\n\nWe are tasked with calculating the orbital energy for a Helium atom ($Z=2$) using a minimal basis set consisting of a single normalized $s$-type Gaussian function, $\\phi_{\\alpha}(\\mathbf{r})$, for two distinct theoretical models: Hartree-Fock (HF) and exchange-only Local Density Approximation (LDA) Kohn-Sham (KS) Density Functional Theory (DFT). The basis function is given by:\n$$\n\\phi_{\\alpha}(\\mathbf{r}) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4} e^{-\\alpha r^2}\n$$\nThe electron density for the two-electron closed-shell system is:\n$$\n\\rho(\\mathbf{r}) = 2 |\\phi_{\\alpha}(\\mathbf{r})|^2 = 2 \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} e^{-2\\alpha r^2}\n$$\nAll calculations are performed in atomic units.\n\n**1. Hartree-Fock (HF) Orbital Energy Calculation**\n\nFor a closed-shell system with a single doubly-occupied spatial orbital $\\phi_{\\alpha}$, the Hartree-Fock orbital energy $\\varepsilon_{\\mathrm{HF}}$ is the expectation value of the Fock operator $\\hat{F}$. Since the basis set consists of a single normalized function, the orbital is identical to this function, and the orbital energy is given by the single element of the Fock matrix, $F_{11}$.\n$$\n\\varepsilon_{\\mathrm{HF}} = F_{11} = \\langle \\phi_{\\alpha} | \\hat{F} | \\phi_{\\alpha} \\rangle\n$$\nThe Fock operator for this system is $\\hat{F} = \\hat{h} + 2\\hat{J} - \\hat{K}$, where $\\hat{h}$ is the core-Hamiltonian operator, and $\\hat{J}$ and $\\hat{K}$ are the Coulomb and exchange operators, respectively, for the orbital $\\phi_{\\alpha}$. Since we are using a single, real basis function, the matrix elements of $\\hat{J}$ and $\\hat{K}$ are identical. The orbital energy is thus:\n$$\n\\varepsilon_{\\mathrm{HF}} = \\langle \\phi_{\\alpha} | \\hat{h} | \\phi_{\\alpha} \\rangle + \\langle \\phi_{\\alpha} | 2\\hat{J} - \\hat{K} | \\phi_{\\alpha} \\rangle = h_{11} + J_{11}\n$$\nwhere $h_{11}$ is the core integral and $J_{11}$ is the two-electron repulsion integral $(\\phi_\\alpha \\phi_\\alpha | \\phi_\\alpha \\phi_\\alpha)$.\n\n**a) Core-Hamiltonian Integral ($h_{11}$)**\nThe core Hamiltonian is $\\hat{h} = -\\frac{1}{2}\\nabla^2 - \\frac{Z}{r}$. The integral $h_{11}$ is the sum of the kinetic energy ($T$) and the nuclear-electron attraction ($V_{ne}$) expectation values.\nThe kinetic energy integral for a normalized Gaussian orbital is a standard result:\n$$\nT = \\langle \\phi_{\\alpha} | -\\frac{1}{2}\\nabla^2 | \\phi_{\\alpha} \\rangle = \\frac{3\\alpha}{2}\n$$\nThe nuclear-electron attraction integral is:\n$$\nV_{ne} = \\langle \\phi_{\\alpha} | -\\frac{Z}{r} | \\phi_{\\alpha} \\rangle = -Z \\int \\frac{|\\phi_{\\alpha}(\\mathbf{r})|^2}{r} d^3r\n$$\nSubstituting $|\\phi_{\\alpha}(\\mathbf{r})|^2 = (\\frac{2\\alpha}{\\pi})^{3/2} e^{-2\\alpha r^2}$ and evaluating the integral gives:\n$$\nV_{ne} = -Z \\int_0^{\\infty} \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} e^{-2\\alpha r^2} \\frac{1}{r} 4\\pi r^2 dr = -Z \\sqrt{\\frac{8\\alpha}{\\pi}}\n$$\nFor Helium, $Z=2$, so $V_{ne} = -2\\sqrt{\\frac{8\\alpha}{\\pi}} = -4\\sqrt{\\frac{2\\alpha}{\\pi}}$.\nCombining these, the core integral is:\n$$\nh_{11} = T + V_{ne} = \\frac{3\\alpha}{2} - 4\\sqrt{\\frac{2\\alpha}{\\pi}}\n$$\n\n**b) Two-Electron Repulsion Integral**\nThe term $J_{11}$ is the two-electron repulsion integral (ERI) for the single basis function. In standard notation, this is $(\\phi_{\\alpha}\\phi_{\\alpha}|\\phi_{\\alpha}\\phi_{\\alpha})$:\n$$\n(\\phi_{\\alpha}\\phi_{\\alpha}|\\phi_{\\alpha}\\phi_{\\alpha}) = \\iint |\\phi_{\\alpha}(\\mathbf{r}_1)|^2 \\frac{1}{|\\mathbf{r}_1-\\mathbf{r}_2|} |\\phi_{\\alpha}(\\mathbf{r}_2)|^2 d^3r_1 d^3r_2\n$$\nFor normalized $s$-type Gaussian functions, this integral has a known analytical form:\n$$\n(\\phi_{\\alpha}\\phi_{\\alpha}|\\phi_{\\alpha}\\phi_{\\alpha}) = 2\\sqrt{\\frac{\\alpha}{\\pi}}\n$$\n\n**c) Final HF Orbital Energy**\nThe HF orbital energy is the sum of the core integral and the ERI:\n$$\n\\varepsilon_{\\mathrm{HF}}(\\alpha) = h_{11} + (\\phi_{\\alpha}\\phi_{\\alpha}|\\phi_{\\alpha}\\phi_{\\alpha}) = \\left(\\frac{3\\alpha}{2} - 4\\sqrt{\\frac{2\\alpha}{\\pi}}\\right) + 2\\sqrt{\\frac{\\alpha}{\\pi}}\n$$\nSimplifying the expression gives:\n$$\n\\varepsilon_{\\mathrm{HF}}(\\alpha) = \\frac{3\\alpha}{2} + \\left( \\frac{2 - 4\\sqrt{2}}{\\sqrt{\\pi}} \\right) \\sqrt{\\alpha}\n$$\n\n**2. Kohn-Sham (KS) Orbital Energy Calculation (LDA)**\n\nThe Kohn-Sham orbital energy for the single occupied orbital $\\phi_{\\alpha}$ is the expectation value of the KS Hamiltonian $\\hat{h}_{\\mathrm{KS}}$:\n$$\n\\varepsilon_{\\mathrm{LDA}} = \\langle \\phi_{\\alpha} | \\hat{h}_{\\mathrm{KS}} | \\phi_{\\alpha} \\rangle = \\langle \\phi_{\\alpha} | \\hat{h} + v_{\\mathrm{H}}[\\rho] + v_{\\mathrm{x}}[\\rho] | \\phi_{\\alpha} \\rangle\n$$\nThis can be expanded as:\n$$\n\\varepsilon_{\\mathrm{LDA}} = h_{11} + \\langle \\phi_{\\alpha} | v_{\\mathrm{H}}[\\rho] | \\phi_{\\alpha} \\rangle + \\langle \\phi_{\\alpha} | v_{\\mathrm{x}}[\\rho] | \\phi_{\\alpha} \\rangle\n$$\nThe core term $h_{11}$ is the same as in the HF calculation.\n\n**a) Hartree Potential Expectation Value**\nThe Hartree potential is $v_{\\mathrm{H}}(\\mathbf{r}) = \\int \\frac{\\rho(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|} d^3r'$. With $\\rho(\\mathbf{r}) = 2|\\phi_{\\alpha}(\\mathbf{r})|^2$, its expectation value is twice the ERI calculated previously:\n$$\n\\langle \\phi_{\\alpha} | v_{\\mathrm{H}}[\\rho] | \\phi_{\\alpha} \\rangle = \\int |\\phi_{\\alpha}(\\mathbf{r})|^2 \\left( \\int \\frac{2|\\phi_{\\alpha}(\\mathbf{r'})|^2}{|\\mathbf{r}-\\mathbf{r'}|} d^3r' \\right) d^3r = 2 (\\phi_{\\alpha}\\phi_{\\alpha}|\\phi_{\\alpha}\\phi_{\\alpha}) = 2 \\left( 2\\sqrt{\\frac{\\alpha}{\\pi}} \\right) = 4\\sqrt{\\frac{\\alpha}{\\pi}}\n$$\n\n**b) Exchange Potential Expectation Value ($V_x$)**\nThe LDA exchange potential is $v_{\\mathrm{x}}(\\rho) = -(\\frac{3}{\\pi})^{1/3} \\rho^{1/3}$. Its expectation value $V_x$ is:\n$$\nV_x = \\langle \\phi_{\\alpha} | v_{\\mathrm{x}}[\\rho] | \\phi_{\\alpha} \\rangle = \\int |\\phi_{\\alpha}(\\mathbf{r})|^2 v_{\\mathrm{x}}[\\rho(\\mathbf{r})] d^3r = -\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int |\\phi_{\\alpha}(\\mathbf{r})|^2 \\rho(\\mathbf{r})^{1/3} d^3r\n$$\nSince $|\\phi_{\\alpha}(\\mathbf{r})|^2 = \\rho(\\mathbf{r})/2$, this becomes:\n$$\nV_x = -\\frac{1}{2} \\left(\\frac{3}{\\pi}\\right)^{1/3} \\int \\rho(\\mathbf{r})^{4/3} d^3r\n$$\nWe evaluate the integral of $\\rho^{4/3}$:\n$$\n\\int \\rho(\\mathbf{r})^{4/3} d^3r = \\int \\left( 2 \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} e^{-2\\alpha r^2} \\right)^{4/3} d^3r = 2^{4/3}\\left(\\frac{2\\alpha}{\\pi}\\right)^2 \\int e^{-(8\\alpha/3) r^2} d^3r\n$$\nUsing the standard Gaussian integral $\\int e^{-a r^2} d^3r = (\\pi/a)^{3/2}$ with $a=8\\alpha/3$, we get:\n$$\n\\int \\rho^{4/3} d^3r = 2^{4/3} \\frac{4\\alpha^2}{\\pi^2} \\left(\\frac{3\\pi}{8\\alpha}\\right)^{3/2} = 2^{10/3} \\frac{\\alpha^2}{\\pi^2} \\frac{3^{3/2}\\pi^{3/2}}{8^{3/2}\\alpha^{3/2}} = 2^{-7/6} 3^{3/2} \\pi^{-1/2} \\sqrt{\\alpha}\n$$\nSubstituting this back into the expression for $V_x$:\n$$\nV_x = - \\frac{1}{2} \\left(\\frac{3}{\\pi}\\right)^{1/3} \\left( 2^{-7/6} 3^{3/2} \\pi^{-1/2} \\sqrt{\\alpha} \\right) = - 2^{-13/6} 3^{11/6} \\pi^{-5/6} \\sqrt{\\alpha}\n$$\n\n**c) Final LDA Orbital Energy**\nCombining all terms for the LDA orbital energy:\n$$\n\\varepsilon_{\\mathrm{LDA}}(\\alpha) = h_{11} + \\langle \\phi_{\\alpha} | v_{\\mathrm{H}}[\\rho] | \\phi_{\\alpha} \\rangle + V_x\n$$\n$$\n\\varepsilon_{\\mathrm{LDA}}(\\alpha) = \\left(\\frac{3\\alpha}{2} - 4\\sqrt{\\frac{2\\alpha}{\\pi}}\\right) + 4\\sqrt{\\frac{\\alpha}{\\pi}} - \\frac{3^{11/6}}{2^{13/6}\\pi^{5/6}} \\sqrt{\\alpha}\n$$\nThe terms containing $\\sqrt{\\alpha}$ simplify:\n$$\n-4\\frac{\\sqrt{2\\alpha}}{\\sqrt{\\pi}} + 4\\frac{\\sqrt{\\alpha}}{\\sqrt{\\pi}} = \\frac{4(1-\\sqrt{2})}{\\sqrt{\\pi}}\\sqrt{\\alpha}\n$$\nThus, the final expression is:\n$$\n\\varepsilon_{\\mathrm{LDA}}(\\alpha) = \\frac{3\\alpha}{2} + \\left( \\frac{4(1 - \\sqrt{2})}{\\sqrt{\\pi}} - \\frac{3^{11/6}}{2^{13/6}\\pi^{5/6}} \\right) \\sqrt{\\alpha}\n$$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates Hartree-Fock and LDA orbital energies for a minimal-basis Helium atom.\n\n    The problem specifies a single normalized s-type Gaussian basis function\n    phi_alpha(r) = (2*alpha/pi)^(3/4) * exp(-alpha*r^2)\n    for the Helium atom (Z=2). The electron density is rho = 2 * |phi_alpha|^2.\n\n    The orbital energies are derived from first principles as functions of alpha:\n\n    1. Hartree-Fock Orbital Energy (e_HF):\n       e_HF = h_11 + J_11\n       h_11 = phi| -0.5*nabla^2 - Z/r |phi = (3/2)*alpha - Z*sqrt(8*alpha/pi)\n       J_11 = phi phi | 1/r_12 | phi phi = 2*sqrt(alpha/pi)\n       For He (Z=2), h_11 = (3/2)*alpha - 4*sqrt(2*alpha/pi).\n       e_HF = (3/2)*alpha - 4*sqrt(2*alpha/pi) + 2*sqrt(alpha/pi)\n            = 1.5*alpha + (2 - 4*sqrt(2))/sqrt(pi) * sqrt(alpha)\n\n    2. LDA Kohn-Sham Orbital Energy (e_LDA):\n       e_LDA = h_11 + v_H + v_x\n       v_H = phi| v_H[rho] |phi = 2*J_11 = 4*sqrt(alpha/pi)\n       v_x = phi| v_x[rho] |phi = - (3**(11/6) * 2**(-13/6) * pi**(-5/6)) * sqrt(alpha)\n       e_LDA = (3/2)*alpha - 4*sqrt(2*alpha/pi) + 4*sqrt(alpha/pi) + v_x\n             = 1.5*alpha + [ (4 - 4*sqrt(2))/sqrt(pi) - (3**(11/6) * 2**(-13/6) * pi**(-5/6)) ] * sqrt(alpha)\n\n    These final formulas are implemented below.\n    \"\"\"\n    \n    # Test cases for the Gaussian exponent alpha as specified in the problem statement.\n    test_cases = [0.05, 0.5, 1.0, 2.0, 6.0, 20.0]\n\n    # Pre-calculate constants for efficiency and readability\n    PI = np.pi\n    SQRT_2 = np.sqrt(2.0)\n    SQRT_PI = np.sqrt(PI)\n\n    # Coefficient for the sqrt(alpha) term in the Hartree-Fock orbital energy\n    # C_HF = (2 - 4*sqrt(2))/sqrt(pi)\n    C_HF = (2.0 - 4.0 * SQRT_2) / SQRT_PI\n\n    # Coefficients for the sqrt(alpha) term in the LDA Kohn-Sham orbital energy\n    # C_LDA = C_LDA_H + C_LDA_x\n    # C_LDA_H is the contribution from the core Hamiltonian and Hartree potential.\n    C_LDA_H = (4.0 * (1.0 - SQRT_2)) / SQRT_PI\n    # C_LDA_x is the contribution from the LDA exchange potential.\n    C_LDA_x = - (3.0**(11.0/6.0)) * (2.0**(-13.0/6.0)) * (PI**(-5.0/6.0))\n    C_LDA = C_LDA_H + C_LDA_x\n\n    results = []\n    for alpha in test_cases:\n        sqrt_alpha = np.sqrt(alpha)\n\n        # Calculate Hartree-Fock orbital energy using the derived formula.\n        e_hf = 1.5 * alpha + C_HF * sqrt_alpha\n        results.append(round(e_hf, 8))\n\n        # Calculate LDA orbital energy using the derived formula.\n        e_lda = 1.5 * alpha + C_LDA * sqrt_alpha\n        results.append(round(e_lda, 8))\n\n    # The final print statement must produce only the specified single-line format.\n    print(f\"[{','.join(f'{x:.8f}' for x in results)}]\")\n\nsolve()\n```", "id": "2384971"}, {"introduction": "Approximations are powerful, but they are not perfect, and understanding their limitations is key to being a skillful practitioner of DFT. Many common functionals, like the Generalized Gradient Approximation (GGA), suffer from a subtle but profound flaw known as self-interaction error (SIE). This exercise challenges you to diagnose why a GGA calculation unphysically predicts a stable anion for the neon atom, connecting this failure to the fundamental properties of the exact energy functional versus its approximate counterparts [@problem_id:2461994].", "problem": "A computational chemistry study evaluates the electron affinity of the neon atom using a semi-local Generalized Gradient Approximation (GGA) exchange–correlation functional within Kohn–Sham Density Functional Theory (DFT). The calculation yields a positive electron affinity, i.e., the total energies satisfy $E(N)-E(N+1)0$ for $N=10$ electrons, implying that $\\mathrm{Ne}^{-}$ is predicted to be stable. Experimentally, the electron affinity of neon is negative and $\\mathrm{Ne}^{-}$ is unbound. Using first principles of Density Functional Theory (DFT) and the definition of self-interaction error (SIE), identify the statement that best explains this unphysical prediction as a manifestation of SIE.\n\nDefinition: The electron affinity is $A \\equiv E(N)-E(N+1)$, where $E(N)$ is the ground-state total energy of the $N$-electron system. In atomic units, a free electron at rest has energy $0$.\n\nChoose the single best option.\n\nA. Semi-local GGA functionals do not exactly cancel the electron’s Hartree self-interaction for one-electron regions of the density. This residual self-interaction leads to over-delocalization and a convex total-energy curve $E(N+\\alpha)$ versus fractional electron number $\\alpha\\in[0,1]$, which artificially lowers $E(N+1)$ relative to $E(N)$. Consequently, $A=E(N)-E(N+1)$ is overestimated and can spuriously become positive for $\\mathrm{Ne}$.\n\nB. The GGA exchange–correlation potential has the correct long-range asymptotic behavior $v_{xc}(\\mathbf r)\\sim -1/r$, which makes the potential overly attractive at large $r$ and therefore overbinds the extra electron, yielding a positive electron affinity.\n\nC. The positive electron affinity arises primarily from basis set superposition error; in the complete basis set limit a GGA will still predict $A0$ for $\\mathrm{Ne}$ because semi-local functionals possess a nonzero derivative discontinuity that stabilizes anions.\n\nD. Hartree–Fock theory, which eliminates self-interaction, would predict an even larger positive electron affinity for $\\mathrm{Ne}$ because neglect of electron correlation generally binds additional electrons more strongly than correlated methods.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **System:** Neon atom ($\\mathrm{Ne}$).\n- **Method:** Kohn–Sham Density Functional Theory (DFT) using a semi-local Generalized Gradient Approximation (GGA) exchange–correlation functional.\n- **Computational Result:** The calculation yields a positive electron affinity, $A  0$. This is expressed as the total energy condition $E(N)-E(N+1)0$ for $N=10$ electrons.\n- **Implication of Result:** The calculation predicts that the neon anion, $\\mathrm{Ne}^{-}$, is stable.\n- **Experimental Fact:** The electron affinity of neon is negative, and $\\mathrm{Ne}^{-}$ is experimentally observed to be unbound.\n- **Definition:** Electron affinity is defined as $A \\equiv E(N)-E(N+1)$, where $E(N)$ is the ground-state total energy of the $N$-electron system.\n- **Energy Reference:** A free electron at rest has an energy of $0$.\n- **Task:** Identify the statement that best explains the unphysical prediction as a manifestation of self-interaction error (SIE).\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-posed and scientifically grounded.\n- **Scientifically Grounded:** The problem describes a well-documented artifact of approximate DFT functionals. The failure of semi-local functionals like GGA to correctly predict negative electron affinities for closed-shell atoms such as Neon is a standard example used to illustrate the consequences of self-interaction error. The concepts of DFT, GGA, SIE, and electron affinity are fundamental to computational chemistry and physics.\n- **Well-Posed:** The question asks for a causal explanation, based on first principles of DFT, for a specific, realistic computational observation. It is structured to have a unique, correct answer among the given options.\n- **Objective:** The language is technical, precise, and free of subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be derived.\n\n**Derivation**\n\nThe core of the problem lies in the concept of Self-Interaction Error (SIE) within Density Functional Theory (DFT). In exact DFT, the total energy functional includes the classical electrostatic repulsion of the electron density with itself, known as the Hartree energy:\n$$E_H[\\rho] = \\frac{1}{2} \\iint \\frac{\\rho(\\mathbf{r})\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} d\\mathbf{r}d\\mathbf{r}'$$\nThis term unphysically includes the interaction of each electron with its own charge distribution. In the exact theory, this spurious self-interaction is perfectly cancelled by the exchange part of the exchange-correlation energy functional, $E_{xc}[\\rho]$. For any one-electron system with density $\\rho_{1e}$, the exact functional must satisfy:\n$$E_H[\\rho_{1e}] + E_{xc}[\\rho_{1e}] = 0$$\nApproximate functionals, such as the Local Density Approximation (LDA) and Generalized Gradient Approximations (GGA), are not constructed to satisfy this condition. They are based on models (the uniform electron gas and its gradients) that do not enforce this exact cancellation. The residual, uncancelled self-interaction is the SIE.\n\nA primary consequence of SIE is its effect on the total energy $E(N)$ as a function of the number of electrons, $N$. For the exact functional, the ground-state energy $E(N+\\alpha)$ must be a piecewise linear function of $\\alpha$ for $\\alpha \\in [0, 1]$. This means the energy curve consists of straight line segments connecting the energies at integer electron numbers. This property is a consequence of the grand-canonical ensemble formulation of DFT for fractional particle numbers.\n\nHowever, functionals suffering from SIE, like GGAs, yield an energy curve $E(N+\\alpha)$ that is erroneously **convex** (i.e., it bows downward) between integer numbers of electrons. This convexity implies that a state with a fractional electron, representing a delocalized charge, is artificially stabilized. An electron, to minimize its spurious self-repulsion, will prefer to delocalize over all space. This over-delocalization is a hallmark of SIE.\n\nThe electron affinity is defined as $A = E(N) - E(N+1)$. For the Neon atom, $N=10$. We are evaluating $A = E(10) - E(11)$.\nDue to the convex nature of the $E(N+\\alpha)$ curve from a GGA calculation, the energy of the $(N+1)$-electron system, $E(N+1)$, is artificially lowered relative to what a linear extrapolation from $E(N)$ would give. This artificial energetic stabilization of the anion, $\\mathrm{Ne}^{-}$, directly leads to an overestimation of the electron affinity, $A$. For an atom like Neon, whose anion is experimentally unbound ($A  0$), this artificial stabilization can be sufficiently large to make the calculated affinity spuriously positive ($A_{GGA}  0$), leading to the incorrect prediction of a stable anion.\n\n**Option-by-Option Analysis**\n\n**A. Semi-local GGA functionals do not exactly cancel the electron’s Hartree self-interaction for one-electron regions of the density. This residual self-interaction leads to over-delocalization and a convex total-energy curve $E(N+\\alpha)$ versus fractional electron number $\\alpha\\in[0,1]$, which artificially lowers $E(N+1)$ relative to $E(N)$. Consequently, $A=E(N)-E(N+1)$ is overestimated and can spuriously become positive for $\\mathrm{Ne}$.**\nThis statement is a precise and complete summary of the issue. It correctly identifies residual self-interaction as the cause. It correctly links SIE to the over-delocalization of charge and the convexity of the $E(N+\\alpha)$ energy curve. It correctly concludes that this convexity leads to an artificial lowering of the anion's energy, $E(N+1)$, which results in an overestimation of the electron affinity, $A$. This is the standard, accepted explanation for this failure of GGA functionals.\n**Verdict: Correct.**\n\n**B. The GGA exchange–correlation potential has the correct long-range asymptotic behavior $v_{xc}(\\mathbf r)\\sim -1/r$, which makes the potential overly attractive at large $r$ and therefore overbinds the extra electron, yielding a positive electron affinity.**\nThis statement is factually incorrect. A well-known deficiency of semi-local functionals like GGA is that their exchange-correlation potential, $v_{xc}(\\mathbf{r})$, decays too rapidly at large distances $r$ from the nucleus (typically exponentially, not as $-1/r$). The correct $-1/r$ asymptotic decay is a feature of the exact exchange potential but is absent in approximate local and semi-local forms. This rapid decay makes the total effective potential for a neutral atom insufficiently attractive at long range. This error would tend to *underbind* an extra electron, not overbind it. Therefore, the premise of the argument is false.\n**Verdict: Incorrect.**\n\n**C. The positive electron affinity arises primarily from basis set superposition error; in the complete basis set limit a GGA will still predict $A0$ for $\\mathrm{Ne}$ because semi-local functionals possess a nonzero derivative discontinuity that stabilizes anions.**\nThis statement contains two major fallacies. First, while basis set superposition error (BSSE) can influence calculations, the spurious binding of the electron to Neon is an intrinsic failure of the GGA functional itself and persists even when calculations are performed with extremely large basis sets or on a numerical grid, effectively approaching the complete basis set limit. It is not the *primary* cause. Second, and more critically, it claims that semi-local functionals possess a nonzero derivative discontinuity. The opposite is true. A key failure of approximate functionals is that they exhibit a vanishing or negligible derivative discontinuity at integer electron numbers, which is directly related to the convexity of the $E(N)$ curve. The existence of a proper, non-zero derivative discontinuity is a feature of the *exact* functional.\n**Verdict: Incorrect.**\n\n**D. Hartree–Fock theory, which eliminates self-interaction, would predict an even larger positive electron affinity for $\\mathrm{Ne}$ because neglect of electron correlation generally binds additional electrons more strongly than correlated methods.**\nThis statement is factually incorrect. Hartree-Fock (HF) theory is free of self-interaction in the sense that an electron in a given spin-orbital does not interact with itself. An HF calculation on the Neon atom correctly predicts that the $\\mathrm{Ne}^{-}$ anion is unbound; the electron affinity is negative. The lowest unoccupied molecular orbital (LUMO) of Ne in HF has a positive energy, indicating that an added electron would not be bound. A direct calculation of the energy difference, $\\Delta \\text{SCF} = E_{HF}(\\mathrm{Ne}) - E_{HF}(\\mathrm{Ne}^{-})$, also yields a negative electron affinity. Therefore, the premise that HF would predict a positive affinity is false. The rationalization that neglecting correlation leads to stronger binding of an additional electron is an incorrect generalization and is counterfactual in this specific, well-known case.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2461994"}]}