{"hands_on_practices": [{"introduction": "The first step in mastering Von Neumann analysis is applying it to a complete numerical scheme. This problem guides you through the stability analysis of the Richtmyer method, a common two-step approach used for wave propagation phenomena like the voltage pulse described [@problem_id:2225605]. By deriving the amplification factor for a multi-step scheme and establishing its stability limit, you will build a foundational skill for assessing the reliability of more complex numerical methods.", "problem": "An electrical engineer is modeling the propagation of a voltage pulse, $u(x, t)$, along a lossless transmission line. The behavior is governed by the one-dimensional linear advection equation:\n$$ \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0 $$\nwhere $c$ is the constant speed of signal propagation. To solve this equation numerically, a two-step finite difference scheme, known as the Richtmyer method, is proposed. Let $u_j^n$ be the numerical approximation of the voltage at position $x_j = j\\Delta x$ and time $t_n = n\\Delta t$, where $\\Delta x$ is the spatial grid spacing and $\\Delta t$ is the time step.\n\nThe scheme is defined by two sequential steps:\n1.  A provisional value is calculated at a half-time step and a mid-grid point:\n    $$ u_{j+1/2}^{n+1/2} = \\frac{1}{2}(u_{j+1}^n + u_j^n) - \\frac{c\\Delta t}{2\\Delta x}(u_{j+1}^n - u_j^n) $$\n2.  The final value at the next full time step is computed using these provisional values:\n    $$ u_j^{n+1} = u_j^n - \\frac{c\\Delta t}{\\Delta x}(u_{j+1/2}^{n+1/2} - u_{j-1/2}^{n+1/2}) $$\n\nTo ensure that numerical errors do not grow uncontrollably, the scheme must be stable. By performing a von Neumann stability analysis, determine the stability condition for the Courant number, $\\mu = \\frac{c\\Delta t}{\\Delta x}$.\n\nWhich of the following inequalities represents the necessary condition for this scheme to be numerically stable?\n\nA. $|\\mu| \\le 2$\n\nB. $|\\mu| \\le \\frac{1}{2}$\n\nC. $|\\mu| \\le 1$\n\nD. $|\\mu| \\le \\sqrt{2}$\n\nE. The scheme is unconditionally unstable.\n\nF. The scheme is unconditionally stable.", "solution": "We perform a von Neumann stability analysis by assuming a single Fourier mode of the form $u_{j}^{n}=\\hat{u}^{n}\\exp(i\\theta j)$, where $\\theta=k\\Delta x$ and $k$ is the wavenumber. Then $u_{j+1}^{n}=\\hat{u}^{n}\\exp(i\\theta(j+1))=\\hat{u}^{n}\\exp(i\\theta j)\\exp(i\\theta)$ and $u_{j-1}^{n}=\\hat{u}^{n}\\exp(i\\theta(j-1))=\\hat{u}^{n}\\exp(i\\theta j)\\exp(-i\\theta)$.\n\nDefine the Courant number $\\mu=\\frac{c\\Delta t}{\\Delta x}$. The provisional half-step value is\n$$\nu_{j+1/2}^{n+1/2}=\\frac{1}{2}\\left(u_{j+1}^{n}+u_{j}^{n}\\right)-\\frac{\\mu}{2}\\left(u_{j+1}^{n}-u_{j}^{n}\\right).\n$$\nSubstituting the Fourier mode and factoring $\\hat{u}^{n}\\exp(i\\theta j)$ gives\n$$\nu_{j+1/2}^{n+1/2}=\\hat{u}^{n}\\exp(i\\theta j)\\left[\\frac{1}{2}\\left(\\exp(i\\theta)+1\\right)-\\frac{\\mu}{2}\\left(\\exp(i\\theta)-1\\right)\\right].\n$$\nSimilarly,\n$$\nu_{j-1/2}^{n+1/2}=\\frac{1}{2}\\left(u_{j}^{n}+u_{j-1}^{n}\\right)-\\frac{\\mu}{2}\\left(u_{j}^{n}-u_{j-1}^{n}\\right)\n=\\hat{u}^{n}\\exp(i\\theta j)\\left[\\frac{1}{2}\\left(1+\\exp(-i\\theta)\\right)-\\frac{\\mu}{2}\\left(1-\\exp(-i\\theta)\\right)\\right].\n$$\nThe update to the next time level is\n$$\nu_{j}^{n+1}=u_{j}^{n}-\\mu\\left(u_{j+1/2}^{n+1/2}-u_{j-1/2}^{n+1/2}\\right).\n$$\nWriting $u_{j}^{n}=\\hat{u}^{n}\\exp(i\\theta j)$ and $u_{j}^{n+1}=\\hat{u}^{n+1}\\exp(i\\theta j)$, the amplification factor $G$ defined by $\\hat{u}^{n+1}=G\\,\\hat{u}^{n}$ is\n$$\nG=1-\\mu\\left\\{\\left[\\frac{1}{2}\\left(\\exp(i\\theta)+1\\right)-\\frac{\\mu}{2}\\left(\\exp(i\\theta)-1\\right)\\right]-\\left[\\frac{1}{2}\\left(1+\\exp(-i\\theta)\\right)-\\frac{\\mu}{2}\\left(1-\\exp(-i\\theta)\\right)\\right]\\right\\}.\n$$\nCompute the bracketed difference:\n$$\n\\frac{1}{2}\\left(\\exp(i\\theta)+1\\right)-\\frac{1}{2}\\left(1+\\exp(-i\\theta)\\right)=\\frac{1}{2}\\left(\\exp(i\\theta)-\\exp(-i\\theta)\\right)=i\\sin\\theta,\n$$\n$$\n-\\frac{\\mu}{2}\\left[\\left(\\exp(i\\theta)-1\\right)-\\left(1-\\exp(-i\\theta)\\right)\\right]=-\\frac{\\mu}{2}\\left(\\exp(i\\theta)+\\exp(-i\\theta)-2\\right)=-\\mu\\left(\\cos\\theta-1\\right)=\\mu\\left(1-\\cos\\theta\\right).\n$$\nHence\n$$\nG=1-\\mu\\left[i\\sin\\theta+\\mu\\left(1-\\cos\\theta\\right)\\right]=1-i\\mu\\sin\\theta-\\mu^{2}\\left(1-\\cos\\theta\\right).\n$$\nThe squared modulus is\n$$\n|G|^{2}=\\left[1-\\mu^{2}\\left(1-\\cos\\theta\\right)\\right]^{2}+\\left[\\mu\\sin\\theta\\right]^{2}.\n$$\nLet $S=\\sin\\theta$ and $C=\\cos\\theta$. Using $S^{2}=1-C^{2}$,\n$$\n|G|^{2}=1-2\\mu^{2}(1-C)+\\mu^{4}(1-2C+C^{2})+\\mu^{2}(1-C^{2}).\n$$\nCombine the $\\mu^{2}$ terms:\n$$\n(1-C^{2})-2(1-C)=-\\left(1-2C+C^{2}\\right)=-(1-C)^{2},\n$$\nand note $(1-2C+C^{2})=(1-C)^{2}$. Therefore\n$$\n|G|^{2}=1-\\mu^{2}(1-C)^{2}+\\mu^{4}(1-C)^{2}=1+(1-C)^{2}\\mu^{2}\\left(\\mu^{2}-1\\right).\n$$\nSince $(1-C)^{2}\\geq 0$ for all $\\theta$, the necessary and sufficient condition for $|G|\\leq 1$ for all $\\theta$ is\n$$\n\\mu^{2}\\left(\\mu^{2}-1\\right)\\leq 0 \\quad \\Longleftrightarrow \\quad \\mu^{2}\\leq 1 \\quad \\Longleftrightarrow \\quad |\\mu|\\leq 1.\n$$\nThus the scheme is stable if and only if $|\\mu|\\leq 1$, corresponding to option C.", "answer": "$$\\boxed{C}$$", "id": "2225605"}, {"introduction": "Von Neumann analysis is not just for preventing solutions from exploding; it is also a powerful tool for designing better numerical schemes. This exercise shifts the focus from simple stability, where the amplification factor $G$ must satisfy $|G| \\le 1$, to the goal of enhancing numerical accuracy [@problem_id:2225599]. By tuning a simulation parameter to make $G=0$ for the most troublesome high-frequency error, you will learn how the amplification factor can be used to strategically control and suppress specific, non-physical oscillations.", "problem": "A numerical analyst is studying a finite difference scheme for solving a one-dimensional transport process. The stability of the scheme is analyzed by decomposing the numerical error into its Fourier modes. The amplification factor, $G$, which determines how the amplitude of a single Fourier mode with wave number $k$ evolves from one time step to the next, is found to be:\n$$ G = 1 - 2\\mu (1 - \\cos(k \\Delta x)) $$\nHere, $\\Delta x$ is the spatial grid spacing, and $\\mu$ is a dimensionless parameter that depends on the time step, grid spacing, and physical properties of the system being modeled.\n\nThe analyst is particularly concerned with high-frequency errors, specifically the error component that has a wavelength of exactly $2\\Delta x$, as this represents the most oscillatory error that the grid can resolve. The goal is to choose the simulation parameter $\\mu$ such that this specific error component is completely eliminated after just a single time step.\n\nDetermine the exact value of $\\mu$ required to achieve this. Express your answer as a decimal value.", "solution": "We analyze the Fourier mode with wavelength $\\lambda = 2\\Delta x$. For a Fourier mode, the relation between wavelength and wavenumber is $k = \\frac{2\\pi}{\\lambda}$, hence\n$$\nk\\Delta x = \\frac{2\\pi}{\\lambda}\\Delta x = \\frac{2\\pi}{2\\Delta x}\\Delta x = \\pi.\n$$\nSubstituting $k\\Delta x = \\pi$ into the amplification factor,\n$$\nG = 1 - 2\\mu\\left(1 - \\cos(k\\Delta x)\\right) = 1 - 2\\mu\\left(1 - \\cos(\\pi)\\right).\n$$\nUsing $\\cos(\\pi) = -1$,\n$$\nG = 1 - 2\\mu\\left(1 - (-1)\\right) = 1 - 2\\mu \\cdot 2 = 1 - 4\\mu.\n$$\nTo eliminate this error component after a single time step, its amplification factor must be zero, so we set $G = 0$:\n$$\n1 - 4\\mu = 0 \\quad \\Rightarrow \\quad \\mu = \\frac{1}{4}.\n$$\nExpressed as a decimal, this is $0.25$.", "answer": "$$\\boxed{0.25}$$", "id": "2225599"}, {"introduction": "A robust numerical scheme must reflect the underlying physics of the problem it solves. This thought experiment explores the critical link between a scheme's structure and the physical direction of information flow, a concept central to \"upwinding\" [@problem_id:2450096]. By analyzing the stability of a standard upwind scheme when the wave speed's direction is reversed, you will discover firsthand why a mismatch between the numerical method and the physics can lead to catastrophic instability, a crucial lesson in computational modeling.", "problem": "Consider the linear advection equation $u_t + c\\,u_x = 0$ with constant wavespeed $c$ on a uniform spatial grid $x_j = j\\,\\Delta x$ and time levels $t^n = n\\,\\Delta t$, where $\\Delta x > 0$ and $\\Delta t > 0$. Define the Courant number $\\nu = c\\,\\Delta t/\\Delta x$. Suppose one uses the explicit one-step upwind scheme whose spatial stencil is chosen for the case $c>0$, namely\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\nu\\,\\big(u_j^n - u_{j-1}^n\\big)\\,.\n$$\nNow assume that the wavespeed $c$ becomes negative, but the numerical update above is left unchanged (that is, the stencil is not adapted to the new sign of $c$). Which statement best describes the linear stability of this fixed-stencil method as a function of $\\nu$?\n\nA. The method remains stable whenever $\\Delta t$ satisfies the Courant-Friedrichs-Lewy (CFL) condition $0 \\le \\nu \\le 1$.\n\nB. The method is stable provided $|\\nu| \\le 1$.\n\nC. The method becomes unconditionally unstable: for any $\\Delta t > 0$ there exists a Fourier mode whose amplification factor has magnitude greater than $1$.\n\nD. The method remains neutrally stable with $|G|=1$ for all Fourier modes because advection is nondissipative.\n\nE. The method is stable if $\\nu \\le 0$ with $|\\nu| \\le 1/2$.", "solution": "We analyze stability from first principles using the linear constant-coefficient scheme and a Fourier mode ansatz. Consider a single Fourier mode $u_j^n = \\hat{u}^n \\, e^{\\mathrm{i} j \\theta}$, where $\\theta \\in [-\\pi,\\pi]$ is the nondimensional wavenumber. Substituting this into the update\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\nu\\,\\big(u_j^n - u_{j-1}^n\\big)\n$$\nyields the amplification factor $G(\\theta)$ defined by $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^n$. Because $u_{j-1}^n = \\hat{u}^n e^{\\mathrm{i}(j-1)\\theta} = e^{-\\mathrm{i}\\theta} u_j^n$, we obtain\n$$\nG(\\theta) \\;=\\; 1 \\;-\\; \\nu\\,\\big(1 - e^{-\\mathrm{i}\\theta}\\big)\\,.\n$$\nLinear stability requires $\\sup_{\\theta} |G(\\theta)| \\le 1$. The scheme as written is the upwind choice for $c>0$, which is known to be stable under $0 \\le \\nu \\le 1$. Here we are concerned with $c<0$ while keeping the same stencil, so $\\nu<0$. Let $\\nu = -\\mu$ with $\\mu>0$. Then\n$$\nG(\\theta) \\;=\\; 1 \\;+\\; \\mu\\,\\big(1 - e^{-\\mathrm{i}\\theta}\\big)\n\\;=\\; (1+\\mu) \\;-\\; \\mu\\,e^{-\\mathrm{i}\\theta}\\,.\n$$\nCompute the magnitude squared:\n\\begin{align*}\n|G(\\theta)|^2\n&= \\Big[(1+\\mu) - \\mu\\cos\\theta\\Big]^2 + \\Big[\\mu\\sin\\theta\\Big]^2 \\\\\n&= (1+\\mu)^2 - 2\\mu(1+\\mu)\\cos\\theta + \\mu^2\\cos^2\\theta + \\mu^2\\sin^2\\theta \\\\\n&= (1+\\mu)^2 - 2\\mu(1+\\mu)\\cos\\theta + \\mu^2 \\\\\n&= 1 + 2\\mu + 2\\mu^2 \\;-\\; 2\\mu(1+\\mu)\\cos\\theta\\,.\n\\end{align*}\nBecause the coefficient of $\\cos\\theta$ is negative, $|G(\\theta)|^2$ is maximized at $\\cos\\theta = -1$ (i.e., at $\\theta = \\pi$), giving\n$$\n\\max_{\\theta} |G(\\theta)|^2 \\;=\\; 1 + 2\\mu + 2\\mu^2 + 2\\mu(1+\\mu)\n\\;=\\; 1 + 4\\mu + 4\\mu^2 \\;=\\; (1 + 2\\mu)^2\\,.\n$$\nHence\n$$\n\\max_{\\theta} |G(\\theta)| \\;=\\; 1 + 2\\mu \\;>\\; 1 \\quad \\text{for all } \\mu>0\\,.\n$$\nTherefore, as soon as $c<0$ (so $\\nu<0$) and $\\Delta t>0$, there exists a Fourier mode (specifically, the highest-frequency mode with $\\theta=\\pi$) that grows in magnitude. The fixed-stencil method is thus unconditionally unstable when the sign of $c$ is negative but the stencil is not adapted.\n\nOption-by-option analysis:\n\nA. This claims stability under $0 \\le \\nu \\le 1$. When $c<0$, we have $\\nu<0$, so the stated condition cannot be met unless $\\Delta t=0$. More importantly, for any $\\nu<0$, we just showed there exists a growing mode. Verdict: Incorrect.\n\nB. This claims stability for $|\\nu| \\le 1$. Taking $\\nu=-\\mu$ with any $\\mu \\in (0,1]$, we found $\\max_{\\theta} |G(\\theta)| = 1 + 2\\mu > 1$, so the scheme is unstable even though $|\\nu|\\le 1$. Verdict: Incorrect.\n\nC. This states unconditional instability for the unadapted stencil: for any $\\Delta t>0$ there exists a Fourier mode with $|G|>1$. Our analysis shows $\\max_{\\theta} |G(\\theta)| = 1 + 2\\mu > 1$ for all $\\mu>0$ (equivalently, all $\\nu<0$ with $\\Delta t>0$). Verdict: Correct.\n\nD. This asserts neutral stability ($|G|=1$) on the grounds that the continuous advection equation is nondissipative. However, the discrete scheme with a mismatched (downwind) stencil is anti-diffusive and produces $|G|>1$ for some modes. Verdict: Incorrect.\n\nE. This proposes conditional stability for $\\nu \\le 0$ with $|\\nu|\\le 1/2$. Setting $\\mu = |\\nu| \\in (0,1/2]$ still yields $\\max_{\\theta} |G(\\theta)| = 1+2\\mu > 1$. Verdict: Incorrect.", "answer": "$$\\boxed{C}$$", "id": "2450096"}]}