{"hands_on_practices": [{"introduction": "Solving a quadratic equation is a fundamental skill, yet the standard formula can be surprisingly fragile in the face of finite-precision arithmetic. This exercise explores a scenario where subtracting two nearly equal numbers leads to a disastrous loss of accuracy, a phenomenon known as catastrophic cancellation. By working through this problem, you will learn to identify this common pitfall and use an alternative, stable algebraic approach to find the physically meaningful root of the equation. [@problem_id:2205401]", "problem": "The time evolution of a certain quantity in a damped system is found by solving for the roots of the quadratic equation $at^2 + bt + c = 0$. For a particular experimental setup characterized by very strong damping, the coefficients are determined to be $a = 1.00$, $b = 1.00 \\times 10^7$, and $c = 1.00$. The system's long-term behavior is governed by the root with the smaller absolute value.\n\nDetermine the value of the root of the equation $t^2 + (1.00 \\times 10^7) t + 1.00 = 0$ that has the smaller magnitude.\n\nProvide your answer as a real number, rounded to three significant figures.", "solution": "The problem asks for the root with the smaller magnitude of the quadratic equation $at^2 + bt + c = 0$, where $a=1.00$, $b=1.00 \\times 10^7$, and $c=1.00$.\n\nThe standard quadratic formula for the roots of this equation is:\n$$t = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n\nSubstituting the given values, we get:\n$$t = \\frac{-1.00 \\times 10^7 \\pm \\sqrt{(1.00 \\times 10^7)^2 - 4(1.00)(1.00)}}{2(1.00)}$$\n$$t = \\frac{-10^7 \\pm \\sqrt{10^{14} - 4}}{2}$$\n\nThis gives two roots:\n$$t_1 = \\frac{-10^7 + \\sqrt{10^{14} - 4}}{2}$$\n$$t_2 = \\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}$$\n\nWe need to identify the root with the smaller magnitude.\nFor $t_2$, the numerator is the sum of two large negative numbers. So, $|t_2| \\approx \\frac{10^7 + 10^7}{2} = 10^7$.\nFor $t_1$, the term $\\sqrt{10^{14} - 4}$ is extremely close to $\\sqrt{10^{14}} = 10^7$. The numerator, therefore, involves the subtraction of two nearly equal numbers: $-10^7$ and a number slightly less than $10^7$. This means that $t_1$ will have a very small magnitude. Thus, $t_1$ is the root we are looking for.\n\nHowever, calculating $t_1$ directly using this formula is problematic in finite-precision arithmetic. The subtraction of two nearly equal numbers leads to a loss of significant figures, an effect known as catastrophic cancellation. For example, if a calculator holds 8 significant figures, $\\sqrt{10^{14}-4}$ would be evaluated as $10^7$, and the numerator would become $-10^7 + 10^7 = 0$, leading to an incorrect root of $0$.\n\nTo find an accurate value for $t_1$, we must use a numerically stable method. We can leverage Vieta's formulas, which relate the coefficients of a polynomial to its roots. For a quadratic equation, the product of the roots is given by $t_1 t_2 = \\frac{c}{a}$.\n\nWe can first calculate $t_2$, as its formula involves the addition of two large numbers of the same sign, which is numerically stable.\n$$t_2 = \\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}$$\nSince $10^{14} \\gg 4$, $\\sqrt{10^{14}-4}$ is very close to $10^7$. So, $t_2 \\approx \\frac{-10^7 - 10^7}{2} = -10^7$.\n\nNow, we can find $t_1$ using the relation $t_1 = \\frac{c/a}{t_2}$:\n$$t_1 = \\frac{1.00/1.00}{t_2} = \\frac{1}{t_2} = \\frac{1}{\\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}} = \\frac{2}{-10^7 - \\sqrt{10^{14} - 4}}$$\nThis expression for $t_1$ is numerically stable because the denominator involves the addition of two large negative numbers.\n\nTo evaluate this, we can again note that the denominator is approximately $-10^7 - 10^7 = -2 \\times 10^7$.\n$$t_1 \\approx \\frac{2}{-2 \\times 10^7} = -1 \\times 10^{-7}$$\n\nTo confirm this and obtain the required precision, we can use the binomial approximation. Let $\\delta = \\frac{4ac}{b^2} = \\frac{4}{10^{14}} = 4 \\times 10^{-14}$.\nThe term $\\sqrt{b^2 - 4ac}$ can be written as $|b|\\sqrt{1 - \\frac{4ac}{b^2}} = b\\sqrt{1-\\delta}$ (since $b>0$).\nUsing the Taylor expansion $(1-x)^{1/2} \\approx 1 - \\frac{1}{2}x$ for small $x$:\n$$ \\sqrt{b^2 - 4ac} \\approx b \\left(1 - \\frac{1}{2}\\frac{4ac}{b^2}\\right) = b - \\frac{2ac}{b} $$\nSubstituting this into the unstable formula for $t_1$:\n$$ t_1 = \\frac{-b + \\sqrt{b^2-4ac}}{2a} \\approx \\frac{-b + (b - \\frac{2ac}{b})}{2a} = \\frac{-2ac/b}{2a} = -\\frac{c}{b} $$\nThis gives a very accurate approximation for the small root:\n$$ t_1 \\approx -\\frac{c}{b} = -\\frac{1.00}{1.00 \\times 10^7} = -1.00 \\times 10^{-7} $$\nThis result is consistent with the calculation from the stable formula.\n\nRounding the result to three significant figures, we get $-1.00 \\times 10^{-7}$.", "answer": "$$\\boxed{-1.00 \\times 10^{-7}}$$", "id": "2205401"}, {"introduction": "Calculating the variance of a dataset is a cornerstone of statistical analysis, but not all formulas are created equal in terms of numerical stability. This practice problem has you step into the role of a metrology analyst to assess the widely used \"one-pass\" variance formula, which is known to be unstable under certain conditions. By meticulously tracking calculations on a hypothetical finite-precision device, you will see how rounding errors can accumulate and corrupt a result, reinforcing the critical need for numerically robust algorithms in data science. [@problem_id:2205459]", "problem": "An analyst in a high-precision metrology lab is tasked with evaluating the stability of a voltage reference source. They take a small sample of three voltage measurements:\n$V_1 = 99.999999 \\text{ V}$\n$V_2 = 100.00000 \\text{ V}$\n$V_3 = 100.00001 \\text{ V}$\n\nThe analysis is performed on a hypothetical calculator that uses a simplified decimal floating-point arithmetic. This system represents every number with a mantissa of 8 significant digits and an appropriate exponent. After every arithmetic operation (addition, subtraction, multiplication, division), the result is immediately rounded to 8 significant digits before it is used in any subsequent calculation. The rounding rule is \"round half to even\" (e.g., 2.5 rounds to 2, 3.5 rounds to 4, and 2.51 rounds to 3).\n\nThe analyst uses a common \"one-pass\" computational formula for variance, which for a sample size of $N=3$ is given by:\n$$ \\sigma^2 = \\left( \\frac{V_1^2 + V_2^2 + V_3^2}{3} \\right) - \\left( \\frac{V_1 + V_2 + V_3}{3} \\right)^2 $$\nThis formula is often written as $\\sigma^2 = \\langle V^2 \\rangle - \\langle V \\rangle^2$. Your task is to compute the variance using this formula as the calculator would.\n\nCalculate the value of the variance, $\\sigma^2$, that would be obtained using this specific calculator and formula. Express your answer in units of $\\text{V}^2$, rounded to four significant figures.", "solution": "We model the calculator’s arithmetic as decimal floating point with an 8-digit mantissa and “round half to even,” applying rounding after every arithmetic operation.\n\nGiven inputs:\n$$V_{1}=99.999999,\\quad V_{2}=100.00000,\\quad V_{3}=100.00001.$$\n\nCompute the squared terms, rounding after each multiplication:\n- $V_{1}^{2}=(99.999999)^{2}=9999.999800000001 \\to 9999.9998$ (to 8 significant digits).\n- $V_{2}^{2}=(100.00000)^{2}=10000 \\to 10000$ (exactly representable with 8 significant digits as $1.0000000\\times 10^{4}$).\n- $V_{3}^{2}=(100.00001)^{2}=10000.000200000001 \\to 10000.0002$ (to 8 significant digits).\n\nForm the sum $V_{1}^{2}+V_{2}^{2}+V_{3}^{2}$ with rounding after each addition:\n- $9999.9998+10000=19999.9998 \\to 19999.9998$ (already 8 significant digits).\n- $19999.9998+10000.0002=30000.0000 \\to 30000.000$ (since $3.00000000\\times 10^{4}$ is the representation).\n\nDivide by $3$, rounding after division:\n$$\\frac{V_{1}^{2}+V_{2}^{2}+V_{3}^{2}}{3}=\\frac{30000.000}{3}=10000.000 \\to 10000.000.$$\n\nCompute the mean via $V_{1}+V_{2}+V_{3}$ with rounding after each addition:\n- $V_{1}+V_{2}=99.999999+100.00000=199.999999 \\to 199.999999.$\n- $(V_{1}+V_{2})+V_{3}=199.999999+100.00001=300.000009 \\to 300.00001$ (since $3.00000009\\times 10^{2}$ rounds to $3.0000001\\times 10^{2}$).\n\nDivide by $3$, rounding after division, to get the mean:\n$$\\frac{V_{1}+V_{2}+V_{3}}{3}=\\frac{300.00001}{3}=100.000003333\\ldots \\to 100.00000.$$\n\nSquare the rounded mean, rounding after multiplication:\n$$(\\text{mean})^{2}=(100.00000)^{2}=10000 \\to 10000.$$\n\nCompute the variance using the one-pass formula with rounding after subtraction:\n$$\\sigma^{2}=\\left(\\frac{V_{1}^{2}+V_{2}^{2}+V_{3}^{2}}{3}\\right)-\\left(\\frac{V_{1}+V_{2}+V_{3}}{3}\\right)^{2}=10000.000-10000=0.$$\nThe result is exactly zero. To express this with four significant figures, we can write $0.000$.\n\nThe original solution appears to have a small calculation error. Let's re-verify the sum of squares:\n$V_{3}^{2}=(100.00001)^{2} = (10^2 + 10^{-5})^2 = 10^4 + 2 \\cdot 10^2 \\cdot 10^{-5} + 10^{-10} = 10000 + 0.002 + 10^{-10} = 10000.0020000001$.\nRounding to 8 significant digits ($1.0000002 \\times 10^4$) gives $10000.002$.\nThe sum is $9999.9998 + 10000 + 10000.002 = 19999.9998 + 10000.002 = 30000.0018$.\nRounding to 8 significant digits ($3.00000018 \\times 10^4$) gives $3.0000002 \\times 10^4$, which is $30000.002$.\nThe average is $30000.002 / 3 = 10000.000666...$, which rounds to $10000.001$.\nThe variance is $10000.001 - 10000 = 0.001$.\nThe original solution text was correct, but the calculation block was not. This has been corrected.\n\nFinal Answer, reported to four significant figures:\n$$\\sigma^{2}=1.000\\times 10^{-3}.$$", "answer": "$$\\boxed{1.000 \\times 10^{-3}}$$", "id": "2205459"}, {"introduction": "Numerical methods for solving differential equations are indispensable tools, but their application requires a careful understanding of their stability properties. This problem investigates the explicit Euler method, a foundational algorithm for simulating dynamic systems, applied to a simple chemical reaction model. You will discover that the stability of the method is conditional on the chosen time step $h$, and that selecting a value just outside the stable range can cause the numerical solution to oscillate and grow without bound, producing a result that violates physical reality. [@problem_id:2205446]", "problem": "A scientist is modeling the concentration of a chemical reactant, $C(t)$, in a simple first-order reaction. The rate of change of the reactant's concentration is directly proportional to the concentration itself, following the differential equation:\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\nThe rate constant is given as $k = 50.0 \\text{ s}^{-1}$, and the initial concentration at time $t=0$ is $C(0) = 100.0 \\text{ mol/L}$.\n\nTo predict the concentration at future times, the scientist employs a numerical scheme using a fixed time step, $h$. This method approximates the concentration at time $t_{n+1} = (n+1)h$ using the value at the previous time step, $t_n = nh$, according to the explicit Euler update rule:\n$$\nC_{n+1} = C_n + h \\left( \\frac{dC}{dt} \\right)_{t=t_n}\n$$\nThe scientist decides to use a time step of $h = 0.0410 \\text{ s}$. Calculate the numerical value of the concentration, $C_3$, predicted by this method after three time steps. Express your answer in mol/L, rounded to three significant figures.", "solution": "We are given the first-order linear ODE $\\frac{dC}{dt}=-kC(t)$ and the explicit Euler update\n$$\nC_{n+1}=C_{n}+h\\left(\\frac{dC}{dt}\\right)_{t=t_{n}}=C_{n}+h(-kC_{n})=(1-kh)C_{n}.\n$$\nBy recursion, this yields\n$$\nC_{n}=C_{0}(1-kh)^{n}.\n$$\nWith $C_{0}=100.0$, $k=50.0\\,\\text{s}^{-1}$, and $h=0.0410\\,\\text{s}$, the dimensionless product is\n$$\nkh=(50.0)(0.0410)=2.05,\\quad 1-kh=1-2.05=-1.05.\n$$\nThus after three steps,\n$$\nC_{3}=100.0\\,(-1.05)^{3}.\n$$\nCompute the power:\n$$\n(-1.05)^{2}=1.1025,\\quad (-1.05)^{3}=1.1025\\times(-1.05)=-1.157625,\n$$\nso\n$$\nC_{3}=100.0\\times(-1.157625)=-115.7625.\n$$\nRounding to three significant figures gives $-1.16\\times 10^{2}$, i.e., $-116$. Note that the explicit Euler factor satisfies $|1-kh|=1.05>1$, indicating instability for this step size, which explains the unphysical sign change.", "answer": "$$\\boxed{-116}$$", "id": "2205446"}]}