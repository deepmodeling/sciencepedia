{"hands_on_practices": [{"introduction": "We begin with a classic case study in numerical analysis, the expression $\\ln(x+1) - \\ln(x)$. For large values of $x$, the two logarithmic terms become nearly identical, and their direct subtraction leads to a severe loss of precision known as subtractive cancellation. This exercise guides you through a fundamental strategy for restoring accuracy: using algebraic identities to reformulate the problem into a numerically stable equivalent, $\\ln(1 + \\frac{1}{x})$, which can then be analyzed effectively for large $x$ [@problem_id:2186157].", "problem": "In numerical computing, evaluating expressions in their most direct algebraic form can sometimes lead to catastrophic precision loss. A classic example is the function $f(x) = \\ln(x+1) - \\ln(x)$, which is problematic for very large positive values of $x$. When $x$ is large, $\\ln(x+1)$ and $\\ln(x)$ are very close in value, and their subtraction (an operation known as subtractive cancellation) results in a substantial loss of significant figures.\n\nTo perform a reliable calculation, the function $f(x)$ must first be transformed into a mathematically equivalent but numerically stable form that avoids this subtraction. Your task is to analyze the behavior of this stable form for large $x$.\n\nDetermine the series expansion for the numerically stable form of $f(x)$ for large $x$. Specifically, find the first three non-zero terms of the expansion in inverse powers of $x$. Express your answer as a polynomial in the variable $z = \\frac{1}{x}$.", "solution": "We start from the given function $f(x) = \\ln(x+1) - \\ln(x)$. Using the logarithm identity $\\ln(a) - \\ln(b) = \\ln\\!\\left(\\frac{a}{b}\\right)$, we obtain a mathematically equivalent and numerically stable form:\n$$\nf(x) = \\ln\\!\\left(\\frac{x+1}{x}\\right) = \\ln\\!\\left(1 + \\frac{1}{x}\\right).\n$$\nFor large positive $x$, the quantity $\\frac{1}{x}$ is small, so this avoids subtractive cancellation and is suitable for stable evaluation.\n\nIntroduce the variable $z = \\frac{1}{x}$. Then\n$$\nf(x) = \\ln(1+z).\n$$\nTo find the series expansion for large $x$ (equivalently small $z$), use the Taylor series of $\\ln(1+z)$ about $z=0$, which is\n$$\n\\ln(1+z) = \\sum_{n=1}^{\\infty} \\frac{(-1)^{n+1}}{n} z^{n}, \\quad \\text{valid for } |z|  1.\n$$\nTherefore, the first three non-zero terms are\n$$\n\\ln(1+z) = z - \\frac{z^{2}}{2} + \\frac{z^{3}}{3} + \\cdots.\n$$\nExpressed as a polynomial in $z = \\frac{1}{x}$, the requested expansion through the first three non-zero terms is\n$$\nz - \\frac{1}{2} z^{2} + \\frac{1}{3} z^{3}.\n$$", "answer": "$$\\boxed{z - \\frac{1}{2} z^{2} + \\frac{1}{3} z^{3}}$$", "id": "2186157"}, {"introduction": "Building on the idea of reformulation, this next practice makes the abstract concept of numerical error tangible. You will compare two methods for calculating the expression $x^4 - y^4$ for two very close numbers, $x$ and $y$, by simulating the arithmetic on a hypothetical computer with limited precision. This exercise provides a concrete demonstration of how a naive subtraction can discard critical information, whereas a stable algorithm based on factorization, $(x-y)(x+y)(x^2+y^2)$, preserves it [@problem_id:2186152].", "problem": "A computational scientist is studying a system where a critical quantity of interest is the difference $D = x^4 - y^4$. The inputs, $x$ and $y$, are positive values obtained from a high-precision experiment, and are often very close to each other. The scientist is concerned that the naive method of computing $D$ may suffer from a loss of significance due to subtractive cancellation.\n\nAll calculations are performed on a hypothetical decimal-based computer. This computer represents numbers in a normalized floating-point format that stores a mantissa of 10 significant digits. After every individual arithmetic operation (addition, subtraction, multiplication, or division), the result is rounded to 10 significant digits. The rounding rule is to round to the nearest value, with ties (i.e., numbers ending in 5) rounded away from zero.\n\nThe scientist decides to compare two methods for calculating $D$ given the inputs $x = 1000.00005$ and $y = 1000.00004$.\n\n-   **Method 1 (Naive):** First compute $X = x^4$ and $Y = y^4$, then find their difference $D_1 = X - Y$.\n-   **Method 2 (Algorithmically Stable):** Use the algebraically equivalent formulation $D_2 = (x-y)(x+y)(x^2+y^2)$ to find the result.\n\nAssuming the value $D_2$ computed by Method 2 is the more accurate approximation of the true value, calculate the relative error of Method 1, which is defined as $\\frac{|D_2 - D_1|}{|D_2|}$. All intermediate and final calculations must be performed using the arithmetic rules of the hypothetical computer.\n\nExpress your final answer as a single real number rounded to three significant figures.", "solution": "We model the arithmetic as base-10 floating point with a 10-significant-digit mantissa, rounding to nearest with ties away from zero after every operation. Write $x=1000.00005=1.00000005\\times 10^{3}$ and $y=1000.00004=1.00000004\\times 10^{3}$; these inputs are exactly representable.\n\nMethod 1 (Naive): Compute $X=x^{4}$ and $Y=y^{4}$ via squaring with rounding at each multiplication.\n1) Compute $x^{2}$:\n$$x^{2}=(1.00000005)^{2}\\times 10^{6}=1.0000001000000025\\times 10^{6}\\;\\;\\to\\;\\;1.000000100\\times 10^{6},$$\nso $x^{2}_{\\text{fl}}=1000000.100$.\n2) Compute $y^{2}$:\n$$y^{2}=(1.00000004)^{2}\\times 10^{6}=1.0000000800000016\\times 10^{6}\\;\\;\\to\\;\\;1.000000080\\times 10^{6},$$\nso $y^{2}_{\\text{fl}}=1000000.080$.\n3) Square to get fourth powers:\n$$x^{4}=(1.000000100)^{2}\\times 10^{12}=1.00000020000001\\times 10^{12}\\;\\;\\to\\;\\;1.000000200\\times 10^{12},$$\n$$y^{4}=(1.000000080)^{2}\\times 10^{12}=1.0000001600000064\\times 10^{12}\\;\\;\\to\\;\\;1.000000160\\times 10^{12}.$$\nThus\n$$D_{1}=X-Y=(1.000000200-1.000000160)\\times 10^{12}=0.000000040\\times 10^{12}=4.000000000\\times 10^{4}.$$\n\nMethod 2 (Stable): Compute $D_{2}=(x-y)(x+y)(x^{2}+y^{2})$ with rounding after each operation.\n1) Differences and sums:\n$$x-y=0.00001=1.000000000\\times 10^{-5},\\quad x+y=2000.00009=2.000000090\\times 10^{3}.$$\n2) Sum of squares (using the rounded $x^{2},y^{2}$ from above):\n$$x^{2}+y^{2}=(1.000000100+1.000000080)\\times 10^{6}=2.000000180\\times 10^{6}.$$\n3) First product:\n$$(x-y)(x+y)=(1.000000000\\times 10^{-5})(2.000000090\\times 10^{3})=2.000000090\\times 10^{-2}\\;(\\text{already }10\\text{ sig. digits}).$$\n4) Final product:\n$$D_{2}=(2.000000090\\times 10^{-2})(2.000000180\\times 10^{6})=(2.000000090\\cdot 2.000000180)\\times 10^{4}.$$\nThe exact mantissa product is $4.0000005400000162$, which rounds to $4.000000540$ (10 significant digits), giving\n$$D_{2}=4.000000540\\times 10^{4}=40000.00540.$$\n\nRelative error (using $D_{2}$ as reference) is computed on the machine with rounding after each operation:\n1) Difference:\n$$|D_{2}-D_{1}|=|4.000000540\\times 10^{4}-4.000000000\\times 10^{4}|=0.000000540\\times 10^{4}=5.400000000\\times 10^{-3}.$$\n2) Division:\n$$\\frac{|D_{2}-D_{1}|}{|D_{2}|}=\\frac{5.400000000\\times 10^{-3}}{4.000000540\\times 10^{4}}=\\left(\\frac{5.400000000}{4.000000540}\\right)\\times 10^{-7}.$$\nPerforming the division to 10 significant digits yields\n$$\\frac{5.400000000}{4.000000540}=1.349999818\\;(\\text{rounded to 10 sig. digits}),$$\nso the machine result for the relative error is\n$$1.349999818\\times 10^{-7}.$$\n\nFinally, rounding this result to three significant figures (using the stated rounding rule) gives\n$$1.35\\times 10^{-7}.$$", "answer": "$$\\boxed{1.35 \\times 10^{-7}}$$", "id": "2186152"}, {"introduction": "This final practice illustrates the broad applicability of these numerical techniques, extending them to the field of statistics. Calculating the probability of a random variable falling within a very small interval often involves subtracting two nearly equal values of a Cumulative Distribution Function (CDF), such as $\\Phi(x + \\delta) - \\Phi(x)$. This problem demonstrates how a Taylor series approximation, which uses the Probability Density Function (PDF), provides a simple yet powerful and numerically stable alternative to direct subtraction [@problem_id:2186161].", "problem": "In a factory producing high-precision components, the deviation of a critical dimension from its target value is modeled by a standard normal random variable $Z$. The quality control process requires calculating the probability of this deviation falling within a tiny interval. Let $\\Phi(z)$ be the Cumulative Distribution Function (CDF) of the standard normal distribution, which gives the probability $P(Z \\leq z)$. We want to compute the probability $P = \\Phi(x + \\delta) - \\Phi(x)$ for $x = 2.0$ and $\\delta = 1.0 \\times 10^{-7}$.\n\nYou are working on a legacy computer system that performs all floating-point arithmetic with a precision of 9 significant figures. This means that any number stored, or any result of an intermediate calculation, must be rounded to 9 significant figures. You are given the following values from a standard mathematical library, which are themselves accurate beyond the precision of your system:\n$$ \\Phi(2.0) = 0.977249868 $$\n$$ \\Phi(2.0000001) = 0.977249873 $$\n\nA junior engineer calculates the probability $P$ by directly subtracting these two values on the legacy system. A senior engineer reviews the calculation and suggests that for a very small $\\delta$, a much more numerically stable result can be obtained by using the approximation $P \\approx \\delta \\cdot \\phi(x)$, where $\\phi(x)$ is the Probability Density Function (PDF) of the standard normal distribution. The value of the PDF at $x=2.0$ is given as:\n$$ \\phi(2.0) = 0.0539909665 $$\n\nYour task is to calculate the value of the probability $P$ using the senior engineer's suggested approximation. Perform the calculation as it would be done on the described legacy system. Express your final answer in scientific notation of the form $a \\times 10^b$, rounded to three significant figures.", "solution": "We need $P=\\Phi(x+\\delta)-\\Phi(x)$ with $x=2.0$ and $\\delta=1.0\\times 10^{-7}$. For small $\\delta$, use the first-order Taylor expansion of $\\Phi$ about $x$:\n$$\n\\Phi(x+\\delta)\\approx \\Phi(x)+\\Phi'(x)\\,\\delta=\\Phi(x)+\\phi(x)\\,\\delta,\n$$\nso\n$$\nP\\approx \\delta\\,\\phi(x),\n$$\nwhere $\\phi(x)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{x^{2}}{2}\\right)$ is the standard normal PDF.\n\nOn the legacy system, all stored numbers and intermediate results are rounded to $9$ significant figures. Store the inputs to $9$ significant figures:\n- $\\delta=1.0\\times 10^{-7}\\to 1.00000000\\times 10^{-7}$,\n- $\\phi(2.0)=0.0539909665=5.39909665\\times 10^{-2}$, which already has $9$ significant figures.\n\nCompute the product with $9$-significant-figure arithmetic:\n$$\nP\\approx (1.00000000\\times 10^{-7})\\,(5.39909665\\times 10^{-2})\n=(1.00000000\\times 5.39909665)\\times 10^{-9}\n=5.39909665\\times 10^{-9},\n$$\nwhich already has $9$ significant figures, so no further internal rounding is needed.\n\nFinally, express the result in scientific notation rounded to three significant figures:\n$$\n5.39909665\\times 10^{-9}\\;\\to\\;5.40\\times 10^{-9}.\n$$", "answer": "$$\\boxed{5.40 \\times 10^{-9}}$$", "id": "2186161"}]}