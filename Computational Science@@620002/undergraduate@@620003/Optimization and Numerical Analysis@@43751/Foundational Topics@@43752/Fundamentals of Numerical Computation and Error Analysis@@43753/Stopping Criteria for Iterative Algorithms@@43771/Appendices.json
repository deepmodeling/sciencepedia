{"hands_on_practices": [{"introduction": "When we solve a system of linear equations like $Ax=b$, the underlying mathematical problem remains identical if we scale the entire system by a non-zero constant. Intuitively, a robust stopping criterion should not be affected by such a superficial change, as it does not alter the true solution. This practice problem [@problem_id:2206933] challenges you to test whether a common criterion, the absolute residual norm $\\|b - Ax_k\\|  \\epsilon$, possesses this desirable property of scale-invariance.", "problem": "In the field of numerical linear algebra, iterative methods are often used to find approximate solutions to a system of linear equations of the form $Ax = b$. A crucial part of these algorithms is the stopping criterion, which determines when the approximate solution is \"good enough.\"\n\nConsider a linear system defined by the matrix $A$ and the vector $b$:\n$$\nA = \\begin{pmatrix} 3  -1 \\\\ 1  2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 5 \\\\ 5 \\end{pmatrix}\n$$\nAn iterative solver has produced an approximate solution $x_k$:\n$$\nx_k = \\begin{pmatrix} 2.1 \\\\ 1.2 \\end{pmatrix}\n$$\nA common stopping criterion is based on the Euclidean norm (L2-norm) of the residual vector, $r_k = b - Ax_k$. The iteration stops if $\\|r_k\\|_2  \\epsilon$, where the Euclidean norm of a vector $v = (v_1, v_2, \\dots, v_n)^T$ is defined as $\\|v\\|_2 = \\sqrt{v_1^2 + v_2^2 + \\dots + v_n^2}$. For this problem, let the tolerance be $\\epsilon = 0.4$.\n\nNow, consider a second linear system, $A'x = b'$, which is derived by scaling the original system by a factor of $c=5$. Thus, $A' = cA$ and $b' = cb$. We will test the same approximate solution $x_k$ against this scaled system using the same stopping criterion, $\\|r'_k\\|_2  \\epsilon$, where $r'_k = b' - A'x_k$.\n\nWhich of the following statements is true regarding the application of the stopping criterion to these two systems with the approximate solution $x_k$?\n\nA. The criterion is met for the original system but is not met for the scaled system.\n\nB. The criterion is not met for the original system but is met for the scaled system.\n\nC. The criterion is met for both the original system and the scaled system.\n\nD. The criterion is not met for either the original system or the scaled system.\n\nE. The outcome is identical for both systems, as scaling does not affect whether the criterion is met.", "solution": "We compute the residual for the original system. With $A=\\begin{pmatrix} 3  -1 \\\\ 1  2 \\end{pmatrix}$, $b=\\begin{pmatrix} 5 \\\\ 5 \\end{pmatrix}$, and $x_{k}=\\begin{pmatrix} 2.1 \\\\ 1.2 \\end{pmatrix}=\\begin{pmatrix} \\frac{21}{10} \\\\ \\frac{6}{5} \\end{pmatrix}$, first evaluate\n$$\nA x_{k}\n=\n\\begin{pmatrix}\n3  -1 \\\\\n1  2\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{21}{10} \\\\\n\\frac{6}{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n3\\cdot\\frac{21}{10}-1\\cdot\\frac{6}{5} \\\\\n1\\cdot\\frac{21}{10}+2\\cdot\\frac{6}{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{63}{10}-\\frac{12}{10} \\\\\n\\frac{21}{10}+\\frac{24}{10}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{51}{10} \\\\\n\\frac{45}{10}\n\\end{pmatrix}.\n$$\nThus the residual is\n$$\nr_{k}=b-Ax_{k}\n=\n\\begin{pmatrix}\n5 \\\\\n5\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n\\frac{51}{10} \\\\\n\\frac{45}{10}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{1}{10} \\\\\n\\frac{1}{2}\n\\end{pmatrix}.\n$$\nIts Euclidean norm satisfies\n$$\n\\|r_{k}\\|_{2}^{2}=\\left(-\\frac{1}{10}\\right)^{2}+\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{100}+\\frac{1}{4}=\\frac{26}{100}=\\frac{13}{50},\n$$\nso\n$$\n\\|r_{k}\\|_{2}=\\sqrt{\\frac{13}{50}}.\n$$\nWith tolerance $\\epsilon=0.4=\\frac{2}{5}$, compare squares:\n$$\n\\|r_{k}\\|_{2}^{2}=\\frac{13}{50} \\quad\\text{and}\\quad \\epsilon^{2}=\\left(\\frac{2}{5}\\right)^{2}=\\frac{4}{25}=\\frac{8}{50}.\n$$\nSince $\\frac{13}{50}\\frac{8}{50}$, it follows that $\\|r_{k}\\|_{2}\\epsilon$, so the stopping criterion is not met for the original system.\n\nFor the scaled system with $c=5$, we have $A'=cA$ and $b'=cb$. The residual is\n$$\nr'_{k}=b'-A'x_{k}=cb-cAx_{k}=c(b-Ax_{k})=c\\,r_{k},\n$$\nhence the norm scales linearly:\n$$\n\\|r'_{k}\\|_{2}=|c|\\,\\|r_{k}\\|_{2}=5\\sqrt{\\frac{13}{50}}.\n$$\nBecause $5\\sqrt{\\frac{13}{50}}\\sqrt{\\frac{13}{50}}\\frac{2}{5}$, the stopping criterion is also not met for the scaled system. Therefore, the correct choice is that the criterion is not met for either system.", "answer": "$$\\boxed{D}$$", "id": "2206933"}, {"introduction": "A common and intuitive assumption about iterative methods is that each step brings the approximation closer to the true solution, suggesting the residual norm should always decrease. While this is often the case, it is not a mathematical guarantee for every method, even on problems where they are known to eventually converge. This exercise [@problem_id:2206869] asks you to find a concrete counterexample using the classic Jacobi method, highlighting why a naive reliance on a steadily decreasing residual can be a flawed way to monitor an algorithm's progress.", "problem": "In numerical linear algebra, iterative methods are often used to approximate the solution to a system of linear equations $Ax=b$. One of the simplest methods is the Jacobi method. For a system where the diagonal entries $A_{ii}$ of the matrix $A$ are all non-zero, the Jacobi iteration is defined by the component-wise formula:\n$$x_{i}^{(k+1)} = \\frac{1}{A_{ii}} \\left( b_i - \\sum_{j \\neq i} A_{ij} x_{j}^{(k)} \\right)$$\nwhere $x^{(k)}$ is the approximation of the solution at the $k$-th iteration.\n\nA common way to monitor the progress of an iterative method is to track the norm of the residual vector, $r^{(k)} = b - Ax^{(k)}$. It is often assumed that for a convergent method, the norm of the residual, $\\|r^{(k)}\\|$, should decrease with each iteration. However, this is not always the case.\n\nConsider the following five scenarios, each defined by a matrix $A$, a vector $b$, and an initial guess $x^{(0)}$. For which of these scenarios does the Euclidean norm (also known as the $L_2$-norm) of the residual vector *increase* after the first Jacobi iteration? That is, for which option is $\\|r^{(1)}\\|_2  \\|r^{(0)}\\|_2$?\n\nA.\n$A = \\begin{pmatrix} 1  2 \\\\ 3  1 \\end{pmatrix}$, $b = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$, $x^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$\n\nB.\n$A = \\begin{pmatrix} 3  1 \\\\ 1  3 \\end{pmatrix}$, $b = \\begin{pmatrix} 4 \\\\ 4 \\end{pmatrix}$, $x^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$\n\nC.\n$A = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$, $b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, $x^{(0)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n\nD.\n$A = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$, $b = \\begin{pmatrix} 5 \\\\ 5 \\end{pmatrix}$, $x^{(0)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n\nE.\n$A = \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$, $b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$, $x^{(0)} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$", "solution": "We use the Jacobi update $x_{i}^{(1)} = \\frac{1}{A_{ii}}\\left(b_{i} - \\sum_{j \\neq i} A_{ij} x_{j}^{(0)}\\right)$ and residuals $r^{(k)} = b - A x^{(k)}$. To decide whether the Euclidean norm increases after the first iteration, we compute $\\|r^{(0)}\\|_{2}^{2}$ and $\\|r^{(1)}\\|_{2}^{2}$ for each option and compare.\n\nOption A:\nGiven $A = \\begin{pmatrix} 1  2 \\\\ 3  1 \\end{pmatrix}$, $b = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$, $x^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\nCompute $r^{(0)} = b - A x^{(0)} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$, hence $\\|r^{(0)}\\|_{2}^{2} = 3^{2} + 4^{2} = 25$.\nJacobi update gives $x^{(1)} = \\begin{pmatrix} \\frac{1}{1}(3 - 2 \\cdot 0) \\\\ \\frac{1}{1}(4 - 3 \\cdot 0) \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$.\nThen $A x^{(1)} = \\begin{pmatrix} 1  2 \\\\ 3  1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 11 \\\\ 13 \\end{pmatrix}$, so $r^{(1)} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} - \\begin{pmatrix} 11 \\\\ 13 \\end{pmatrix} = \\begin{pmatrix} -8 \\\\ -9 \\end{pmatrix}$ and $\\|r^{(1)}\\|_{2}^{2} = (-8)^{2} + (-9)^{2} = 145  25$. The norm increases.\n\nOption B:\nGiven $A = \\begin{pmatrix} 3  1 \\\\ 1  3 \\end{pmatrix}$, $b = \\begin{pmatrix} 4 \\\\ 4 \\end{pmatrix}$, $x^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\n$r^{(0)} = \\begin{pmatrix} 4 \\\\ 4 \\end{pmatrix}$, so $\\|r^{(0)}\\|_{2}^{2} = 4^{2} + 4^{2} = 32$.\n$x^{(1)} = \\begin{pmatrix} \\frac{1}{3}(4 - 1 \\cdot 0) \\\\ \\frac{1}{3}(4 - 1 \\cdot 0) \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{3} \\\\ \\frac{4}{3} \\end{pmatrix}$.\n$A x^{(1)} = \\begin{pmatrix} \\frac{16}{3} \\\\ \\frac{16}{3} \\end{pmatrix}$, thus $r^{(1)} = \\begin{pmatrix} 4 \\\\ 4 \\end{pmatrix} - \\begin{pmatrix} \\frac{16}{3} \\\\ \\frac{16}{3} \\end{pmatrix} = \\begin{pmatrix} -\\frac{4}{3} \\\\ -\\frac{4}{3} \\end{pmatrix}$ and $\\|r^{(1)}\\|_{2}^{2} = 2 \\cdot \\left(\\frac{4}{3}\\right)^{2} = \\frac{32}{9}  32$. The norm decreases.\n\nOption C:\nGiven $A = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$, $b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, $x^{(0)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n$A x^{(0)} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$, so $r^{(0)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}$ and $\\|r^{(0)}\\|_{2}^{2} = 1 + 4 = 5$.\nJacobi: $x^{(1)}_{1} = \\frac{1}{2}(1 - (-1) \\cdot 0) = \\frac{1}{2}$, $x^{(1)}_{2} = \\frac{1}{2}(1 - (-1) \\cdot 1) = 1$, so $x^{(1)} = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\end{pmatrix}$.\n$A x^{(1)} = \\begin{pmatrix} 0 \\\\ \\frac{3}{2} \\end{pmatrix}$, hence $r^{(1)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -\\frac{1}{2} \\end{pmatrix}$ and $\\|r^{(1)}\\|_{2}^{2} = 1 + \\frac{1}{4} = \\frac{5}{4}  5$. The norm decreases.\n\nOption D:\nGiven $A = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$, $b = \\begin{pmatrix} 5 \\\\ 5 \\end{pmatrix}$, $x^{(0)} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n$r^{(0)} = \\begin{pmatrix} 5 \\\\ 5 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 4 \\end{pmatrix}$, so $\\|r^{(0)}\\|_{2}^{2} = 32$.\nJacobi gives $x^{(1)} = \\begin{pmatrix} 5 \\\\ 5 \\end{pmatrix}$, hence $r^{(1)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ and $\\|r^{(1)}\\|_{2}^{2} = 0  32$. The norm decreases.\n\nOption E:\nGiven $A = \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$, $b = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$, $x^{(0)} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$.\n$A x^{(0)} = \\begin{pmatrix} 2 \\\\ -2 \\end{pmatrix}$, so $r^{(0)} = \\begin{pmatrix} -2 \\\\ 2 \\end{pmatrix}$ and $\\|r^{(0)}\\|_{2}^{2} = 8$.\nJacobi: $x^{(1)}_{1} = 0 - (-1)\\cdot 0 = 0$, $x^{(1)}_{2} = 0 - (-1)\\cdot 2 = 2$, so $x^{(1)} = \\begin{pmatrix} 0 \\\\ 2 \\end{pmatrix}$.\n$A x^{(1)} = \\begin{pmatrix} -2 \\\\ 2 \\end{pmatrix}$, hence $r^{(1)} = \\begin{pmatrix} 2 \\\\ -2 \\end{pmatrix}$ and $\\|r^{(1)}\\|_{2}^{2} = 8$. The norm remains unchanged, not increased.\n\nTherefore, the Euclidean norm of the residual increases only in Option A.", "answer": "$$\\boxed{A}$$", "id": "2206869"}, {"introduction": "The principles for designing good stopping criteria are not limited to linear algebra; they are crucial in all iterative methods, including root-finding. When seeking a root $x$ such that $f(x)=0$, we can choose to stop when the residual $|f(x_k)|$ is small or when the step size $|x_k - x_{k-1}|$ is small. As this problem [@problem_id:2206929] demonstrates through a hands-on calculation with Newton's method, the local steepness of the function can make one criterion far more reliable than the other, making this choice a critical design decision.", "problem": "In numerical analysis, iterative methods are used to approximate solutions to equations. A crucial aspect of these methods is the stopping criterion, which determines when the algorithm has found a sufficiently accurate answer. Different criteria can behave differently depending on the nature of the problem. This problem explores the behavior of two common stopping criteria for a function with a rapidly changing slope near its root.\n\nConsider the task of finding the root of the function $f(x) = \\exp(10x) - 1000$ using Newton's method, which is defined by the iterative formula $x_{k+1} = x_k - \\frac{f(x_k)}{f'(x_k)}$. Start with an initial guess of $x_0 = 1.0$.\n\nTwo different stopping criteria are proposed:\n- **Criterion A (Residual-based)**: The algorithm stops if $|f(x_k)|  10.0$.\n- **Criterion B (Step size-based)**: The algorithm stops if $|x_k - x_{k-1}|  0.001$. This criterion is checked starting from $k=1$.\n\nThe algorithm terminates at the first iteration $k \\ge 1$ for which a criterion is met. Determine the iteration number at which each criterion is satisfied and select the correct statement from the options below.\n\nA. Criterion A stops at $k=5$, and Criterion B stops at $k=6$. Criterion A stops first.\n\nB. Criterion A stops at $k=6$, and Criterion B stops at $k=5$. Criterion B stops first.\n\nC. Both criteria stop at $k=5$.\n\nD. Both criteria stop at $k=6$.\n\nE. Criterion A stops at $k=4$, and Criterion B stops at $k=7$. Criterion A stops first.", "solution": "We are solving for a root of $f(x)=\\exp(10x)-1000$ by Newton’s method\n$$\nx_{k+1}=x_{k}-\\frac{f(x_{k})}{f'(x_{k})},\\quad f'(x)=10\\exp(10x).\n$$\nHence the explicit iteration is\n$$\nx_{k+1}=x_{k}-\\frac{\\exp(10x_{k})-1000}{10\\exp(10x_{k})}\n=x_{k}-\\frac{1}{10}+\\frac{100}{\\exp(10x_{k})}.\n$$\nThe exact root is $x^{\\star}=\\frac{3\\ln 10}{10}$ since $\\exp(10x^{\\star})=1000$.\n\nWe start with $x_{0}=1.0$ and iterate, evaluating the two stopping criteria:\n- Criterion A: stop at the first $k\\geq 1$ with $|f(x_{k})|10$.\n- Criterion B: stop at the first $k\\geq 1$ with $|x_{k}-x_{k-1}|0.001$.\nNote that the Newton step is $s_{k}:=x_{k+1}-x_{k}=-\\frac{f(x_{k})}{f'(x_{k})}=-\\frac{1}{10}+\\frac{100}{\\exp(10x_{k})}$.\n\nStep from $k=0$ to $k=1$:\n$$\nx_{1}=x_{0}-\\frac{1}{10}+100\\exp(-10)\\approx 1-\\frac{1}{10}+0.004539992976\\approx 0.904539992976.\n$$\nThen $|x_{1}-x_{0}|\\approx 9.5460007024\\times 10^{-2}0.001$, and\n$$\nf(x_{1})=\\exp(10x_{1})-1000\\approx 8.479442089\\times 10^{3}-1000\\approx 7.479442089\\times 10^{3}10.\n$$\nNeither criterion is satisfied at $k=1$.\n\nStep from $k=1$ to $k=2$:\n$$\nx_{2}=x_{1}-\\frac{1}{10}+\\frac{100}{\\exp(10x_{1})}\\approx 0.904539992976-0.1+\\frac{100}{8.479442089\\times 10^{3}}\\approx 0.816333970.\n$$\nThen $|x_{2}-x_{1}|\\approx 8.8206023\\times 10^{-2}0.001$, and\n$$\nf(x_{2})\\approx \\exp(8.163339699)-1000\\approx 3.509899\\times 10^{3}-1000\\approx 2.509899\\times 10^{3}10.\n$$\nNeither criterion is satisfied at $k=2$.\n\nStep from $k=2$ to $k=3$:\n$$\nx_{3}=x_{2}-\\frac{1}{10}+\\frac{100}{\\exp(10x_{2})}\\approx 0.816333970-0.1+\\frac{100}{3.509899\\times 10^{3}}\\approx 0.744826870.\n$$\nThen $|x_{3}-x_{2}|\\approx 7.15071\\times 10^{-2}0.001$, and\n$$\nf(x_{3})\\approx \\exp(7.4482687)-1000\\approx 1.71686\\times 10^{3}-1000\\approx 7.1686\\times 10^{2}10.\n$$\nNeither criterion is satisfied at $k=3$.\n\nStep from $k=3$ to $k=4$:\n$$\nx_{4}=x_{3}-\\frac{1}{10}+\\frac{100}{\\exp(10x_{3})}\\approx 0.744826870-0.1+\\frac{100}{1.71686\\times 10^{3}}\\approx 0.703078870.\n$$\nThen $|x_{4}-x_{3}|\\approx 4.1748\\times 10^{-2}0.001$, and\n$$\nf(x_{4})\\approx \\exp(7.0307887)-1000\\approx 1.1309226\\times 10^{3}-1000\\approx 1.309226\\times 10^{2}10.\n$$\nNeither criterion is satisfied at $k=4$.\n\nStep from $k=4$ to $k=5$:\n$$\nx_{5}=x_{4}-\\frac{1}{10}+\\frac{100}{\\exp(10x_{4})}\\approx 0.703078870-0.1+\\frac{100}{1.1309226\\times 10^{3}}\\approx 0.691501970.\n$$\nTo evaluate Criterion A precisely, write $10x_{5}=6.9150197$ and note $\\ln(1000)=3\\ln 10\\approx 6.907755278982137$. Hence\n$$\nd:=10x_{5}-\\ln(1000)\\approx 0.007264421,\\quad \\exp(10x_{5})=1000\\,\\exp(d),\n$$\nso\n$$\nf(x_{5})=1000(\\exp(d)-1)\\approx 1000\\left(d+\\frac{d^{2}}{2}+\\frac{d^{3}}{6}\\right)\\approx 1000\\left(0.007264421+2.6396\\times 10^{-5}+6.4\\times 10^{-8}\\right)\\approx 7.29088.\n$$\nThus $|f(x_{5})|\\approx 7.2908810$, so Criterion A is satisfied at $k=5$. Meanwhile $|x_{5}-x_{4}|=|s_{4}|\\approx 1.15769\\times 10^{-2}0.001$, so Criterion B is not yet met at $k=5$.\n\nStep from $k=5$ to $k=6$ (for Criterion B):\nUsing $s_{5}=-\\frac{f(x_{5})}{f'(x_{5})}$ with $f'(x_{5})=10\\exp(10x_{5})\\approx 10\\times 1000\\exp(d)\\approx 10072.9088$, we get\n$$\n|x_{6}-x_{5}|=|s_{5}|=\\left|\\frac{f(x_{5})}{f'(x_{5})}\\right|\\approx \\frac{7.29088}{10072.9088}\\approx 7.23\\times 10^{-4}0.001.\n$$\nTherefore Criterion B is satisfied at $k=6$.\n\nConclusion: Criterion A first holds at $k=5$, and Criterion B first holds at $k=6$. Thus the correct option is A.", "answer": "$$\\boxed{A}$$", "id": "2206929"}]}