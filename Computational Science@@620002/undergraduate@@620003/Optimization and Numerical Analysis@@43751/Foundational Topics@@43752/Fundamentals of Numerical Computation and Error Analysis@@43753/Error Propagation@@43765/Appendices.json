{"hands_on_practices": [{"introduction": "Scientific models are built upon parameters determined from measurements, and these measurements always contain some degree of uncertainty. This first practice demonstrates a fundamental technique to analyze how such an input error propagates through a mathematical model. By examining a simple exponential growth model, you will use calculus to quantify the \"error amplification,\" a measure of how sensitive a model's prediction is to uncertainty in one of its key parameters [@problem_id:2169903]. This is a foundational skill for evaluating the reliability and robustness of any quantitative model.", "problem": "In a simplified climate model, the atmospheric concentration of a particular greenhouse gas, $C$, is projected to grow over time, $t$, according to the exponential growth model:\n$$C(t) = C_0 \\exp(kt)$$\nwhere $C_0$ is the initial concentration at $t=0$ and $k$ is the net fractional growth rate per year.\n\nA team of scientists has determined the initial concentration $C_0$ with very high precision, such that its associated error can be considered negligible. However, the growth rate $k$ is estimated from complex geophysical data and has a known uncertainty. This uncertainty in $k$ propagates and affects the long-term prediction of the concentration $C(t)$.\n\nLet the first-order approximation of the relative error in a quantity $X$ be defined as $\\epsilon_X = \\left|\\frac{\\Delta X}{X}\\right|$, where $\\Delta X$ is the small error in $X$. The sensitivity of the model's prediction to the uncertainty in the growth rate is quantified by the error amplification factor, $A$, defined as the ratio of the relative error in the predicted concentration to the relative error in the growth rate:\n$$A = \\frac{\\epsilon_C}{\\epsilon_k}$$\nAssuming the growth rate $k$ is positive, calculate the value of this amplification factor $A$ for a prediction made at time $t = 50$ years, given that the estimated growth rate is $k = 0.035$ per year.\n\nRound your final answer to three significant figures.", "solution": "The problem asks for the error amplification factor $A = \\frac{\\epsilon_C}{\\epsilon_k}$ for the concentration model $C(t) = C_0 \\exp(kt)$. The relative errors are defined as $\\epsilon_C = \\left|\\frac{\\Delta C}{C}\\right|$ and $\\epsilon_k = \\left|\\frac{\\Delta k}{k}\\right|$. We need to find the relationship between a small change (error) $\\Delta k$ in the growth rate and the resulting change $\\Delta C$ in the predicted concentration.\n\nWe can use differential calculus to find this relationship. We treat the concentration $C$ as a function of the variable $k$, with $C_0$ and $t$ being constant parameters. For a small change $\\Delta k$, the first-order change in $C$ is given by:\n$$\\Delta C \\approx \\frac{dC}{dk} \\Delta k$$\nFirst, we need to compute the derivative of $C(k) = C_0 \\exp(kt)$ with respect to $k$. Using the chain rule for differentiation:\n$$\\frac{dC}{dk} = \\frac{d}{dk} \\left( C_0 \\exp(kt) \\right) = C_0 \\cdot \\frac{d}{dk}(\\exp(kt))$$\n$$\\frac{dC}{dk} = C_0 \\cdot \\exp(kt) \\cdot \\frac{d}{dk}(kt) = C_0 \\exp(kt) \\cdot t$$\nNotice that the term $C_0 \\exp(kt)$ is just the original function $C(t)$. So, we can write the derivative as:\n$$\\frac{dC}{dk} = C(t) \\cdot t$$\nNow we substitute this derivative back into the expression for $\\Delta C$:\n$$\\Delta C \\approx (C(t) \\cdot t) \\cdot \\Delta k$$\nTo find the relative error in $C$, $\\epsilon_C$, we divide both sides by $C = C(t)$:\n$$\\frac{\\Delta C}{C(t)} \\approx \\frac{C(t) \\cdot t \\cdot \\Delta k}{C(t)}$$\n$$\\frac{\\Delta C}{C(t)} \\approx t \\cdot \\Delta k$$\nWe are interested in the relationship between relative errors. The relative error in $k$ is $\\epsilon_k = \\left|\\frac{\\Delta k}{k}\\right|$. We can rewrite the expression for $\\Delta k$ as $\\Delta k = k \\cdot \\left(\\frac{\\Delta k}{k}\\right)$. Substituting this into our equation:\n$$\\frac{\\Delta C}{C(t)} \\approx t \\cdot \\left(k \\cdot \\frac{\\Delta k}{k}\\right)$$\n$$\\frac{\\Delta C}{C(t)} \\approx (kt) \\cdot \\frac{\\Delta k}{k}$$\nNow we take the absolute value of both sides to get the relationship between the magnitudes of the relative errors:\n$$\\left|\\frac{\\Delta C}{C(t)}\\right| \\approx \\left| (kt) \\cdot \\frac{\\Delta k}{k} \\right|$$\nSince $k$ and $t$ are given as positive values, their product $kt$ is also positive, so $|kt| = kt$.\n$$\\left|\\frac{\\Delta C}{C(t)}\\right| \\approx kt \\cdot \\left|\\frac{\\Delta k}{k}\\right|$$\nUsing the definitions of the relative errors, $\\epsilon_C = \\left|\\frac{\\Delta C}{C}\\right|$ and $\\epsilon_k = \\left|\\frac{\\Delta k}{k}\\right|$, we have:\n$$\\epsilon_C \\approx (kt) \\cdot \\epsilon_k$$\nThe error amplification factor $A$ is defined as the ratio $\\frac{\\epsilon_C}{\\epsilon_k}$. From the equation above, we get:\n$$A = \\frac{\\epsilon_C}{\\epsilon_k} \\approx kt$$\nThis is the general expression for the amplification factor for this model. Now we can substitute the given numerical values: $t = 50$ years and $k = 0.035$ year$^{-1}$.\n$$A \\approx (0.035 \\text{ year}^{-1}) \\cdot (50 \\text{ years})$$\n$$A \\approx 1.75$$\nThe problem asks to round the answer to three significant figures. The calculated value $1.75$ already has three significant figures.", "answer": "$$\\boxed{1.75}$$", "id": "2169903"}, {"introduction": "Beyond errors in measured inputs, numerical inaccuracies can arise from the very way we perform calculations on a computer. This exercise tackles a classic computational pitfall known as \"catastrophic cancellation,\" where subtracting two nearly equal numbers can lead to a dramatic loss of significant digits. By working with the function $f(x) = \\sqrt{x^{2}+1} - x$ for large $x$, you will learn to algebraically reformulate an expression to create a numerically stable algorithm, a crucial technique for writing reliable scientific code [@problem_id:2375840].", "problem": "Let $f(x) = \\sqrt{x^{2}+1} - x$ for real $x > 0$. In a standard floating-point arithmetic model with unit roundoff $u$, direct evaluation of $f(x)$ for very large $x$ can suffer from catastrophic cancellation. By reasoning from first principles, derive an algebraically equivalent, numerically stable closed-form expression for $f(x)$ that avoids subtracting nearly equal quantities for very large $x$. Express your final answer as a single analytic expression in terms of $x$ only. No rounding is required.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted as follows:\n1.  The function is defined as $f(x) = \\sqrt{x^{2}+1} - x$.\n2.  The domain of the function is specified as real $x > 0$.\n3.  The computational context is a standard floating-point arithmetic model with unit roundoff $u$.\n4.  The stated numerical issue is that direct evaluation of $f(x)$ for very large $x$ suffers from catastrophic cancellation.\n5.  The objective is to derive an algebraically equivalent, numerically stable, closed-form expression for $f(x)$ that avoids this issue. The final answer must be a single analytic expression in terms of $x$.\n\nValidation of the problem statement:\n-   **Scientific Groundedness**: The problem is scientifically sound. The phenomenon of catastrophic cancellation when subtracting nearly equal floating-point numbers is a fundamental topic in numerical analysis and computational science. The function $f(x) = \\sqrt{x^{2}+1} - x$ is a canonical example used to illustrate this effect. For large positive $x$, the term $\\sqrt{x^{2}+1}$ can be approximated by a Taylor series expansion: $\\sqrt{x^{2}+1} = x\\sqrt{1 + \\frac{1}{x^{2}}} \\approx x(1 + \\frac{1}{2x^{2}}) = x + \\frac{1}{2x}$. Thus, $f(x) \\approx (x + \\frac{1}{2x}) - x = \\frac{1}{2x}$. The two quantities being subtracted, $\\sqrt{x^{2}+1}$ and $x$, are indeed nearly equal, confirming the premise of catastrophic cancellation.\n-   **Well-Posedness**: The problem is well-posed. It asks for an algebraic reformulation of a given expression to achieve a specific, well-defined numerical property (stability). A unique, standard solution exists.\n-   **Objectivity**: The problem is stated in precise, objective mathematical language. It is free from ambiguity and subjective claims.\n\nThe problem statement is therefore deemed valid. The solution proceeds.\n\nThe source of numerical instability in the expression $f(x) = \\sqrt{x^{2}+1} - x$ for large $x > 0$ is the subtraction of two quantities of similar magnitude. In floating-point arithmetic, if two numbers $a$ and $b$ are very close, their difference $a-b$ will have a significantly smaller number of correct significant digits than either $a$ or $b$ individually. This loss of relative precision is known as catastrophic cancellation.\n\nTo derive a numerically stable expression, we must eliminate this subtraction. A standard algebraic technique for expressions involving a difference with a square root, of the form $\\sqrt{A} - B$, is to multiply and divide by the conjugate expression, which is $\\sqrt{A} + B$. This technique is often referred to as \"rationalizing the numerator\".\n\nThe given function is $f(x) = \\sqrt{x^{2}+1} - x$. Its conjugate expression is $\\sqrt{x^{2}+1} + x$. We multiply and divide $f(x)$ by this conjugate:\n\n$$ f(x) = (\\sqrt{x^{2}+1} - x) \\cdot \\frac{\\sqrt{x^{2}+1} + x}{\\sqrt{x^{2}+1} + x} $$\n\nThe numerator is now of the form $(a-b)(a+b)$, which simplifies to $a^{2}-b^{2}$. Here, $a = \\sqrt{x^{2}+1}$ and $b = x$.\n\n$$ f(x) = \\frac{(\\sqrt{x^{2}+1})^{2} - x^{2}}{\\sqrt{x^{2}+1} + x} $$\n\nSimplifying the numerator:\n\n$$ (\\sqrt{x^{2}+1})^{2} - x^{2} = (x^{2}+1) - x^{2} = 1 $$\n\nSubstituting this result back into the expression for $f(x)$:\n\n$$ f(x) = \\frac{1}{\\sqrt{x^{2}+1} + x} $$\n\nThis new expression is algebraically equivalent to the original for all $x$ in the domain. We must now verify its numerical stability. The denominator consists of the sum of two positive quantities, $\\sqrt{x^{2}+1}$ and $x$. In floating-point arithmetic, the addition of two numbers of the same sign is a benign operation that does not cause catastrophic cancellation. The subsequent division by this sum is also a numerically stable operation.\n\nFor large $x$, the denominator becomes large, and the result correctly approaches zero without any loss of relative precision. This transformed expression is therefore numerically stable for all $x > 0$, especially for large values of $x$ where the original expression failed.", "answer": "$$ \\boxed{\\frac{1}{\\sqrt{x^{2}+1} + x}} $$", "id": "2375840"}, {"introduction": "In the world of numerical methods, improving accuracy is often a balancing act. For instance, when approximating a derivative, using a smaller step size $h$ reduces the theoretical approximation error, but it can amplify the computational round-off error. This practice explores this critical trade-off [@problem_id:2169892]. You will derive an optimal step size that minimizes the total error by finding the \"sweet spot\" between these two competing error sources, a sophisticated skill essential for designing efficient and accurate numerical algorithms.", "problem": "An engineer is analyzing a signal, represented by a function $f(t)$ that is at least three times continuously differentiable ($C^3$). To estimate the instantaneous rate of change of the signal, $f'(t)$, at a specific time $t_0$, the engineer uses the symmetric difference quotient:\n$$\nf'(t_0) \\approx \\frac{f(t_0+h) - f(t_0-h)}{2h}\n$$\nwhere $h > 0$ is the step size.\n\nThe total error in this estimation arises from two distinct sources:\n1.  **Approximation Error**: This error is inherent to the formula itself, which is an approximation of the true derivative. For a sufficiently smooth function, the magnitude of this error is bounded by $|E_A| \\le \\frac{M h^2}{6}$, where $M$ is a positive constant representing the maximum absolute value of the third derivative of the function, $|f'''(t)|$, in the vicinity of $t_0$.\n2.  **Computational Precision Error**: The device used to measure or compute the function values $f(t)$ has limited precision. The computed value of $f(t)$, denoted $\\text{fl}(f(t))$, is subject to a round-off error. The absolute error for any single function evaluation is bounded by a maximum value $\\varepsilon > 0$, such that $|\\text{fl}(f(t)) - f(t)| \\le \\varepsilon$. This error propagates when the difference quotient is calculated using these imprecise values.\n\nThe engineer seeks to select a step size $h$ that minimizes the total error. Assuming the worst-case scenario where the individual errors add up, determine the optimal step size $h_{opt}$ that minimizes the total error bound. Express your answer as a symbolic expression in terms of $M$ and $\\varepsilon$.", "solution": "We denote the central difference approximation by\n$$\nD(h) = \\frac{f(t_{0}+h)-f(t_{0}-h)}{2h}.\n$$\nBy Taylor's theorem with remainder, for some points between $t_{0}-h$ and $t_{0}+h$, one has\n$$\nf(t_{0}\\pm h) = f(t_{0}) \\pm h f'(t_{0}) + \\frac{h^{2}}{2} f''(t_{0}) \\pm \\frac{h^{3}}{6} f^{(3)}(\\xi_{\\pm}),\n$$\nwhich yields the central difference truncation error\n$$\nE_{A} = D(h) - f'(t_{0}) = \\frac{h^{2}}{6} f^{(3)}(\\xi),\n$$\nfor some $\\xi$ between $t_{0}-h$ and $t_{0}+h$. Hence, using $|f^{(3)}(t)| \\le M$ near $t_{0}$, the approximation error satisfies\n$$\n|E_{A}| \\le \\frac{M h^{2}}{6}.\n$$\n\nFor the computational precision error, let the computed function values be\n$$\n\\text{fl}(f(t_{0}\\pm h)) = f(t_{0}\\pm h) + \\delta_{\\pm}, \\quad |\\delta_{\\pm}| \\le \\varepsilon.\n$$\nThen the computed difference quotient is\n$$\n\\frac{\\text{fl}(f(t_{0}+h)) - \\text{fl}(f(t_{0}-h))}{2h}\n= D(h) + \\frac{\\delta_{+} - \\delta_{-}}{2h},\n$$\nso the induced round-off contribution satisfies\n$$\n|E_{R}| = \\left|\\frac{\\delta_{+} - \\delta_{-}}{2h}\\right|\n\\le \\frac{|\\delta_{+}| + |\\delta_{-}|}{2h}\n\\le \\frac{2 \\varepsilon}{2 h}\n= \\frac{\\varepsilon}{h}.\n$$\n\nAssuming worst-case additive accumulation, the total error bound as a function of $h>0$ is\n$$\nE(h) = \\frac{M h^{2}}{6} + \\frac{\\varepsilon}{h}.\n$$\nTo minimize $E(h)$, differentiate and set to zero:\n$$\nE'(h) = \\frac{M}{3} h - \\varepsilon h^{-2} = 0\n\\quad \\Longrightarrow \\quad\n\\frac{M}{3} h^{3} = \\varepsilon\n\\quad \\Longrightarrow \\quad\nh = \\left(\\frac{3 \\varepsilon}{M}\\right)^{\\frac{1}{3}}.\n$$\nSince\n$$\nE''(h) = \\frac{M}{3} + 2 \\varepsilon h^{-3} > 0,\n$$\nthis critical point is the unique minimizer. Therefore, the optimal step size is\n$$\nh_{\\text{opt}} = \\left(\\frac{3 \\varepsilon}{M}\\right)^{\\frac{1}{3}}.\n$$", "answer": "$$\\boxed{\\left(\\frac{3 \\varepsilon}{M}\\right)^{\\frac{1}{3}}}$$", "id": "2169892"}]}