{"hands_on_practices": [{"introduction": "Finite difference formulas are not arbitrary sets of coefficients; they are derived from fundamental mathematical principles. This exercise guides you through one of the most common derivation methods, often called the \"method of undetermined coefficients.\" By requiring the formula to be exact for polynomials of the highest possible degree, we can systematically determine the coefficients, providing a solid theoretical foundation for the tools we use in numerical differentiation [@problem_id:2191768].", "problem": "In numerical analysis, the derivative of a function $f(x)$ at a point $x$ can be approximated using a finite difference formula. Consider a forward difference formula of the form:\n$$\nf'(x) \\approx A f(x) + B f(x+h) + C f(x+2h)\n$$\nwhere $h > 0$ is a small step size, and $A$, $B$, and $C$ are coefficients that may depend on $h$. Your task is to find the specific coefficients that make this approximation exact for any polynomial of the highest possible degree.\n\nDetermine the coefficients $A$, $B$, and $C$ as expressions in terms of $h$. Present your answer as a row matrix containing the three coefficients in the order $[A, B, C]$.", "solution": "We seek coefficients $A$, $B$, and $C$ such that the forward difference combination $A f(x) + B f(x+h) + C f(x+2h)$ reproduces $f'(x)$ exactly for polynomials of the highest possible degree. Using Taylor expansions about $x$, write\n$$\nf(x+h) = f(x) + h f'(x) + \\frac{h^{2}}{2} f''(x) + \\frac{h^{3}}{6} f^{(3)}(x) + \\cdots,\n$$\n$$\nf(x+2h) = f(x) + 2h f'(x) + \\frac{(2h)^{2}}{2} f''(x) + \\frac{(2h)^{3}}{6} f^{(3)}(x) + \\cdots.\n$$\nSubstitute into $A f(x) + B f(x+h) + C f(x+2h)$ and collect terms in derivatives of $f$:\n$$\nA f(x) + B f(x+h) + C f(x+2h) = (A + B + C) f(x) + h(B + 2C) f'(x) + h^{2}\\!\\left(\\frac{B}{2} + 2C\\right) f''(x) + \\frac{h^{3}}{6} (B + 8C) f^{(3)}(x) + \\cdots.\n$$\nTo match $f'(x)$ exactly for polynomials up to the highest possible degree with three coefficients, we impose that the coefficients of $f(x)$ and $f''(x)$ vanish and the coefficient of $f'(x)$ equals $1$:\n$$\nA + B + C = 0, \\quad h(B + 2C) = 1, \\quad h^{2}\\!\\left(\\frac{B}{2} + 2C\\right) = 0.\n$$\nSolving, the third equation gives $B = -4C$. Substituting into the second yields $-4C + 2C = \\frac{1}{h}$, so $C = -\\frac{1}{2h}$ and hence $B = \\frac{2}{h}$. From the first equation, $A = -B - C = -\\frac{3}{2h}$.\n\nWith these coefficients, the remaining term starts at order $h^{2}$:\n$$\n\\frac{h^{3}}{6}(B + 8C) f^{(3)}(x) = \\frac{h^{3}}{6}\\!\\left(\\frac{2}{h} - \\frac{8}{2h}\\right) f^{(3)}(x) = -\\frac{h^{2}}{3} f^{(3)}(x),\n$$\nso the formula is exact for all polynomials of degree at most $2$, which is the highest possible degree given three coefficients.\n\nTherefore, the required coefficients are $A = -\\frac{3}{2h}$, $B = \\frac{2}{h}$, and $C = -\\frac{1}{2h}$, and the row matrix in the order $[A, B, C]$ is as follows.", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{3}{2h} & \\frac{2}{h} & -\\frac{1}{2h}\\end{pmatrix}}$$", "id": "2191768"}, {"introduction": "The most common finite difference formulas are the forward, backward, and central difference approximations. While all three can estimate a derivative, their accuracy is not the same. This practice problem allows you to directly compare the performance of these three methods on a known function, quantifying their respective errors and revealing why the central difference formula is often the preferred choice for its higher order of accuracy [@problem_id:2191753].", "problem": "Consider the function $f(x) = x \\exp(-x)$. We are interested in approximating its derivative, $f'(x)$, at the point $x_0 = 1$. The quality of an approximation is measured by its absolute error, defined as the absolute difference between the approximated value and the true value of the derivative.\n\nYou are to compare three common finite difference formulas for approximating the derivative:\n1.  **Forward Difference Approximation**: $D_f(x_0, h) = \\frac{f(x_0+h) - f(x_0)}{h}$\n2.  **Backward Difference Approximation**: $D_b(x_0, h) = \\frac{f(x_0) - f(x_0-h)}{h}$\n3.  **Central Difference Approximation**: $D_c(x_0, h) = \\frac{f(x_0+h) - f(x_0-h)}{2h}$\n\nLet $E_f$, $E_b$, and $E_c$ be the absolute errors corresponding to the forward, backward, and central difference approximations, respectively, when using a step size of $h = 0.1$.\n\nCalculate the value of the ratio $R = \\frac{E_f + E_b}{E_c}$. Round your final answer to three significant figures.", "solution": "We begin with $f(x) = x \\exp(-x)$. Its derivative is obtained by the product rule:\n$$\nf'(x) = \\exp(-x) + x \\frac{d}{dx}\\big(\\exp(-x)\\big) = \\exp(-x) - x \\exp(-x) = \\exp(-x)\\,(1 - x).\n$$\nAt $x_{0} = 1$, this gives\n$$\nf'(1) = \\exp(-1)\\,(1 - 1) = 0.\n$$\nHence, for any finite difference approximation $D$, the absolute error at $x_{0}=1$ is simply the absolute value of the approximation:\n$$\nE_{f} = |D_{f}(1,h)|,\\quad E_{b} = |D_{b}(1,h)|,\\quad E_{c} = |D_{c}(1,h)|.\n$$\n\nWith $h = 0.1$, compute the three finite differences using $f(x) = x \\exp(-x)$:\n- Forward difference:\n$$\nD_{f}(1,h) = \\frac{f(1+h) - f(1)}{h} = \\frac{(1.1)\\exp(-1.1) - \\exp(-1)}{0.1}.\n$$\n- Backward difference:\n$$\nD_{b}(1,h) = \\frac{f(1) - f(1-h)}{h} = \\frac{\\exp(-1) - (0.9)\\exp(-0.9)}{0.1}.\n$$\n- Central difference:\n$$\nD_{c}(1,h) = \\frac{f(1+h) - f(1-h)}{2h} = \\frac{(1.1)\\exp(-1.1) - (0.9)\\exp(-0.9)}{0.2}.\n$$\n\nFactor $\\exp(-1)$ by writing $\\exp(-1.1) = \\exp(-1)\\exp(-0.1)$ and $\\exp(-0.9) = \\exp(-1)\\exp(0.1)$. Define $t = \\exp(0.1)$ so that $\\exp(-0.1) = 1/t$. Then\n$$\nD_{f}(1,h) = \\frac{\\exp(-1)}{0.1}\\left(1.1\\,\\frac{1}{t} - 1 \\right),\\quad\nD_{b}(1,h) = \\frac{\\exp(-1)}{0.1}\\left(1 - 0.9\\,t \\right),\n$$\n$$\nD_{c}(1,h) = \\frac{\\exp(-1)}{0.2}\\left(1.1\\,\\frac{1}{t} - 0.9\\,t \\right).\n$$\nLet\n$$\nA = 1.1\\,\\frac{1}{t} - 1,\\quad B = 1 - 0.9\\,t,\\quad C = 1.1\\,\\frac{1}{t} - 0.9\\,t.\n$$\nThen\n$$\nE_{f} = \\frac{\\exp(-1)}{0.1}\\,|A|,\\quad E_{b} = \\frac{\\exp(-1)}{0.1}\\,|B|,\\quad E_{c} = \\frac{\\exp(-1)}{0.2}\\,|C|.\n$$\nTherefore, the ratio simplifies to\n$$\nR = \\frac{E_{f} + E_{b}}{E_{c}} = \\frac{\\frac{\\exp(-1)}{0.1}(|A|+|B|)}{\\frac{\\exp(-1)}{0.2}|C|} = 2\\,\\frac{|A|+|B|}{|C|}.\n$$\n\nNumerically, with $t = \\exp(0.1) \\approx 1.1051701859880927$ and $1/t = \\exp(-0.1) \\approx 0.9048374180359596$,\n$$\nA = 1.1\\cdot 0.9048374180359596 - 1 \\approx -0.00467884016044447,\\quad |A| \\approx 0.00467884016044447,\n$$\n$$\nB = 1 - 0.9\\cdot 1.1051701859880927 \\approx 0.00534683261071661,\\quad |B| \\approx 0.00534683261071661,\n$$\n$$\nC = 1.1\\cdot 0.9048374180359596 - 0.9\\cdot 1.1051701859880927 \\approx 0.000667992450272143,\\quad |C| \\approx 0.000667992450272143.\n$$\nHence,\n$$\nR = 2\\,\\frac{0.00467884016044447 + 0.00534683261071661}{0.000667992450272143} \\approx \\frac{0.02005134554232216}{0.000667992450272143} \\approx 30.0173.\n$$\nRounded to three significant figures,\n$$\nR \\approx 30.0\n$$", "answer": "$$\\boxed{30.0}$$", "id": "2191753"}, {"introduction": "A key goal in numerical methods is to achieve higher accuracy efficiently. Rather than simply using a smaller step size, which can be computationally expensive, we can use clever techniques to improve our results. This exercise introduces Richardson extrapolation, a powerful method for combining results from a lower-order formula at two different step sizes to produce a single, higher-order, and more accurate approximation [@problem_id:2191783].", "problem": "An engineer is trying to estimate the instantaneous rate of change of a physical quantity, described by a smooth function $f(x)$, at a particular point $x_0$. They are using a computational method based on the first-order forward difference formula, which provides an approximation $N_1(h)$ to the true derivative $f'(x_0)$ for a given step size $h$. The error of this method is known to have the following structure:\n$$f'(x_0) = N_1(h) + K_1 h + K_2 h^2 + O(h^3)$$\nwhere $K_1$ and $K_2$ are unknown constants independent of the step size $h$.\n\nUsing a step size of $h = 0.4$, the engineer computes the approximation $N_1(0.4) = 2.7836$.\nThen, by halving the step size to $h/2 = 0.2$, they compute a new approximation $N_1(0.2) = 2.9152$.\n\nBy combining these two first-order approximations, $N_1(0.4)$ and $N_1(0.2)$, construct an improved, second-order accurate approximation, which we can call $N_2(h)$, for $f'(x_0)$. Calculate the numerical value of this improved approximation. Round your final answer to four significant figures.", "solution": "The given error model for the first-order forward difference approximation is\n$$f'(x_{0})=N_{1}(h)+K_{1}h+K_{2}h^{2}+O(h^{3}).$$\nFor the halved step, this gives\n$$f'(x_{0})=N_{1}\\!\\left(\\frac{h}{2}\\right)+K_{1}\\frac{h}{2}+K_{2}\\frac{h^{2}}{4}+O(h^{3}).$$\nSeek a linear combination $N_{2}(h)=A\\,N_{1}\\!\\left(\\frac{h}{2}\\right)+B\\,N_{1}(h)$ that is second-order accurate. Imposing that the combination matches $f'(x_{0})$ and cancels the $O(h)$ term yields\n$$A+B=1,\\qquad \\frac{A}{2}+B=0.$$\nSolving gives $A=2$ and $B=-1$, hence\n$$N_{2}(h)=2\\,N_{1}\\!\\left(\\frac{h}{2}\\right)-N_{1}(h).$$\nIts error is $O(h^{2})$, since\n$$2N_{1}\\!\\left(\\frac{h}{2}\\right)-N_{1}(h)=f'(x_{0})+\\frac{K_{2}}{2}h^{2}+O(h^{3}).$$\nUsing the given data with $h=0.4$,\n$$N_{2}(0.4)=2\\,N_{1}(0.2)-N_{1}(0.4)=2\\cdot 2.9152-2.7836=3.0468.$$\nRounded to four significant figures, this is $3.047$.", "answer": "$$\\boxed{3.047}$$", "id": "2191783"}]}