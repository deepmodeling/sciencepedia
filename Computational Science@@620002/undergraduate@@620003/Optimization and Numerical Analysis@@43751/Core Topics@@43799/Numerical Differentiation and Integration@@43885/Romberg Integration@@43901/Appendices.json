{"hands_on_practices": [{"introduction": "To truly understand an algorithm, it is often best to start by performing the calculations by hand. This first practice guides you through the fundamental mechanics of Romberg integration for a simple polynomial, where the results can be checked easily. By computing the initial trapezoidal approximations and applying the first level of Richardson extrapolation, you will build a solid foundation for the method's more complex applications [@problem_id:2198730].", "problem": "Romberg integration is a numerical method used to estimate the definite integral of a function by applying Richardson extrapolation to the results from the trapezoidal rule. The estimates are organized in a triangular array called the Romberg tableau, denoted by $R_{k,j}$. The first column, $R_{k,1}$ (for $k \\geq 1$), is generated using the composite trapezoidal rule with $n = 2^{k-1}$ subintervals. Subsequent entries are computed using the recursive formula:\n$$R_{k,j} = R_{k,j-1} + \\frac{1}{4^{j-1} - 1}(R_{k,j-1} - R_{k-1,j-1}) \\quad \\text{for } k \\geq j \\geq 2.$$\n\nConsider the definite integral of a polynomial function $f(x) = 4x^3 - 3x^2 + 5$ over the interval $[0, 2]$. Your task is to manually compute the first three entries of the Romberg tableau for this integral.\n\nCalculate the values of $R_{1,1}$, $R_{2,1}$, and $R_{2,2}$. Provide your answer as a row vector of the three numerical values $(R_{1,1}, R_{2,1}, R_{2,2})$ expressed as exact integers.", "solution": "We integrate $f(x)=4x^{3}-3x^{2}+5$ over $[a,b]=[0,2]$. The composite trapezoidal rule with $n$ subintervals of width $h=\\frac{b-a}{n}$ is\n$$\nT_{n}=\\frac{h}{2}\\left(f(a)+2\\sum_{i=1}^{n-1}f(a+ih)+f(b)\\right).\n$$\nBy definition, $R_{k,1}=T_{2^{k-1}}$.\n\nFor $R_{1,1}$, take $n=1$ so $h=2$. Evaluate $f(0)=5$ and $f(2)=4\\cdot 2^{3}-3\\cdot 2^{2}+5=32-12+5=25$. Then\n$$\nR_{1,1}=T_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\cdot(5+25)=30.\n$$\n\nFor $R_{2,1}$, take $n=2$ so $h=1$ with nodes $0,1,2$. Compute $f(1)=4-3+5=6$. Then\n$$\nR_{2,1}=T_{2}=\\frac{1}{2}\\left(f(0)+2f(1)+f(2)\\right)=\\frac{1}{2}\\left(5+2\\cdot 6+25\\right)=\\frac{42}{2}=21.\n$$\n\nRomberg extrapolation uses\n$$\nR_{k,j}=R_{k,j-1}+\\frac{1}{4^{j-1}-1}\\left(R_{k,j-1}-R_{k-1,j-1}\\right), \\quad k\\geq j\\geq 2.\n$$\nThus,\n$$\nR_{2,2}=R_{2,1}+\\frac{1}{4^{1}-1}\\left(R_{2,1}-R_{1,1}\\right)=21+\\frac{1}{3}(21-30)=21-\\frac{9}{3}=18.\n$$\n\nAs a consistency check, the exact integral is\n$$\n\\int_{0}^{2}\\left(4x^{3}-3x^{2}+5\\right)\\,dx=\\left(x^{4}-x^{3}+5x\\right)\\bigg|_{0}^{2}=16-8+10=18,\n$$\nagreeing with $R_{2,2}$ as expected for a cubic.", "answer": "$$\\boxed{\\begin{pmatrix}30 & 21 & 18\\end{pmatrix}}$$", "id": "2198730"}, {"introduction": "Now that you have seen how to compute Romberg estimates, let's explore why this method is so powerful. This exercise delves into the theoretical underpinnings of Romberg integration, connecting its remarkable accuracy to the properties of the function being integrated [@problem_id:2198758]. Understanding this relationship is key to knowing when and why Romberg integration provides exceptionally precise results, often reaching the exact answer for polynomials much faster than anticipated.", "problem": "Romberg integration is a numerical method for estimating the definite integral of a function, which applies successive levels of Richardson extrapolation to the results of the composite trapezoidal rule. The results are typically organized in a triangular array called the Romberg tableau, with entries denoted by $T_{m,k}$.\n\nThe first column, $T_{m,0}$ for $m = 0, 1, 2, \\ldots$, contains the approximations from the composite trapezoidal rule with $2^m$ subintervals. Subsequent columns are generated by the recurrence relation:\n$$\nT_{m, k} = T_{m, k-1} + \\frac{T_{m, k-1} - T_{m-1, k-1}}{4^k - 1} \\quad \\text{for } k \\ge 1\n$$\nEach column $k$ represents a higher order of accuracy. For a sufficiently smooth function, the values in the tableau converge to the true value of the integral.\n\nConsider the task of integrating an arbitrary polynomial of degree 5. There exists a minimum column index $k$ for which the result $T_{m,k}$ is no longer an approximation but becomes the exact value of the integral for any sufficiently large row index $m$. What is this smallest value of $k$?\n\nA. 1\n\nB. 2\n\nC. 3\n\nD. 4\n\nE. 5", "solution": "Let the integral be $I=\\int_{a}^{b} f(x)\\,dx$ and let $h=(b-a)/2^{m}$. The composite trapezoidal rule with step $h$ is $T(h)=T_{m,0}$. By the Euler–Maclaurin expansion specialized to the trapezoidal rule,\n$$\nI=T(h)+\\sum_{n=1}^{\\infty}\\frac{B_{2n}}{(2n)!}h^{2n}\\left(f^{(2n-1)}(b)-f^{(2n-1)}(a)\\right),\n$$\nwhere $B_{2n}$ are Bernoulli numbers. If $f$ is a polynomial of degree $5$, then $f^{(k)}\\equiv 0$ for $k\\geq 6$, and in particular the series truncates after $n=3$ (the $h^{6}$ term). Moreover, for $n=3$ one has $f^{(5)}$ constant, hence $f^{(5)}(b)-f^{(5)}(a)=0$, so the $h^{6}$ term vanishes identically. Therefore, for degree-$5$ polynomials the expansion is exact and reduces to\n$$\nI=T(h)+c_{2}h^{2}+c_{4}h^{4},\n$$\nwith $c_{2}=\\frac{B_{2}}{2!}\\left(f'(b)-f'(a)\\right)$ and $c_{4}=\\frac{B_{4}}{4!}\\left(f^{(3)}(b)-f^{(3)}(a)\\right)$.\n\nWrite the same formula for step $2h$:\n$$\nI=T(2h)+c_{2}(2h)^{2}+c_{4}(2h)^{4}.\n$$\nHence\n$$\nT(h)-T(2h)=\\left[I-c_{2}h^{2}-c_{4}h^{4}\\right]-\\left[I-c_{2}(2h)^{2}-c_{4}(2h)^{4}\\right]\n=3c_{2}h^{2}+15c_{4}h^{4}.\n$$\nThe first Romberg extrapolation (column $k=1$) is\n$$\nT_{m,1}=T(h)+\\frac{T(h)-T(2h)}{4-1}\n=I-c_{2}h^{2}-c_{4}h^{4}+\\left(c_{2}h^{2}+5c_{4}h^{4}\\right)\n=I+4c_{4}h^{4},\n$$\nso the $h^{2}$ term is eliminated and the remaining error is $O(h^{4})$.\n\nApply the same to $2h$ for the second extrapolation. We have\n$$\nT_{m-1,1}=T(2h)+\\frac{T(2h)-T(4h)}{4-1}=I+4c_{4}(2h)^{4}=I+64c_{4}h^{4}.\n$$\nThus the second Romberg extrapolation (column $k=2$) is\n$$\nT_{m,2}=T_{m,1}+\\frac{T_{m,1}-T_{m-1,1}}{4^{2}-1}\n=\\left(I+4c_{4}h^{4}\\right)+\\frac{\\left(I+4c_{4}h^{4}\\right)-\\left(I+64c_{4}h^{4}\\right)}{16-1}\n=I+4c_{4}h^{4}-\\frac{60c_{4}h^{4}}{15}\n=I.\n$$\nTherefore, for any polynomial of degree $5$, $T_{m,2}$ equals the exact integral (for any $m$ for which these quantities are defined; the phrase “sufficiently large $m$” is thus satisfied). Equivalently, Romberg column $k$ has algebraic degree of precision $2k+1$, so $k=2$ integrates all polynomials up to degree $5$ exactly.\n\nHence the minimal $k$ is $2$.", "answer": "$$\\boxed{B}$$", "id": "2198758"}, {"introduction": "The standard Romberg integration formula is derived assuming the trapezoidal rule's error expands in even powers of the step size, $h$. But what happens if this ideal assumption does not hold, for instance, with functions that have a singularity at an endpoint? This thought-provoking problem challenges you to adapt the core principle of Richardson extrapolation to a more general error structure, deepening your understanding of numerical error correction beyond rote formula application [@problem_id:2198771].", "problem": "An engineer is testing a new numerical integration library on a proprietary, non-trivial function $f(x)$ over an interval of length $L$. They use the composite trapezoidal rule and attempt to use Romberg extrapolation to improve accuracy. The trapezoidal rule approximation with $N=2^{i-1}$ subintervals is denoted by $R_{i,0}$. The step size for this approximation is $h_i = L/2^{i-1}$. The first column of the Romberg tableau is calculated and found to be:\n\n$R_{1,0} = 2.79159265$\n$R_{2,0} = 2.85096765$\n$R_{3,0} = 2.97030359$\n$R_{4,0} = 3.04905115$\n\nThe engineer observes that the convergence is not quadratic as would be expected for a very smooth function. A theoretical analysis of the integrand $f(x)$ reveals that the error of the trapezoidal rule approximation, $E(h_i) = I - R_{i,0}$ (where $I$ is the true value of the integral), has a full asymptotic expansion in integer powers of the step size $h_i$. That is, $E(h_i) \\sim \\sum_{k=1}^{\\infty} C_k h_i^k$ for some non-zero coefficients $C_k$, rather than an expansion in only even powers of $h_i$.\n\nBased on this information, determine the correct extrapolation procedure to build the Romberg tableau. Use this procedure to compute the most accurate possible estimate of the integral from the given data, which corresponds to the value of $R_{4,3}$.\n\nExpress your final answer as a single real number rounded to five significant figures.", "solution": "The composite trapezoidal approximations are $R_{i,0}$ with step sizes $h_{i} = L/2^{i-1}$. The error satisfies an asymptotic expansion in all integer powers,\n$$\nR_{i,0} = I + \\sum_{k=1}^{\\infty} C_{k} h_{i}^{k}, \\quad C_{k} \\neq 0 \\text{ in general}.\n$$\nSince $h_{i-1} = 2 h_{i}$, the two successive approximations expand as\n$$\nR_{i,0} = I + C_{1} h_{i} + C_{2} h_{i}^{2} + C_{3} h_{i}^{3} + \\cdots,\n$$\n$$\nR_{i-1,0} = I + C_{1} (2 h_{i}) + C_{2} (2 h_{i})^{2} + C_{3} (2 h_{i})^{3} + \\cdots = I + \\sum_{k=1}^{\\infty} C_{k} 2^{k} h_{i}^{k}.\n$$\nTo eliminate the leading $h_{i}^{1}$ term, form the Richardson combination with factor $2$:\n$$\nR_{i,1} = \\frac{2 R_{i,0} - R_{i-1,0}}{2 - 1} = 2 R_{i,0} - R_{i-1,0}.\n$$\nIts error begins at $O(h_{i}^{2})$. Repeating this logic, after $j-1$ extrapolations the leading error is $O(h_{i}^{j})$, so the next elimination uses factor $2^{j}$. Therefore, the correct Romberg-like recursion for an error expansion in all integer powers is\n$$\nR_{i,j} = \\frac{2^{j} R_{i,j-1} - R_{i-1,j-1}}{2^{j} - 1}, \\quad j \\geq 1.\n$$\n\nUsing the given first column:\n$$\nR_{1,0} = 2.79159265,\\quad R_{2,0} = 2.85096765,\\quad R_{3,0} = 2.97030359,\\quad R_{4,0} = 3.04905115,\n$$\ncompute the tableau:\n\nFirst extrapolation ($j=1$):\n$$\nR_{2,1} = 2 R_{2,0} - R_{1,0} = 2.91034265,\n$$\n$$\nR_{3,1} = 2 R_{3,0} - R_{2,0} = 3.08963953,\n$$\n$$\nR_{4,1} = 2 R_{4,0} - R_{3,0} = 3.12779871.\n$$\n\nSecond extrapolation ($j=2$):\n$$\nR_{3,2} = \\frac{4 R_{3,1} - R_{2,1}}{3} = \\frac{4 \\cdot 3.08963953 - 2.91034265}{3} = 3.1494051566666667,\n$$\n$$\nR_{4,2} = \\frac{4 R_{4,1} - R_{3,1}}{3} = \\frac{4 \\cdot 3.12779871 - 3.08963953}{3} = 3.1405184366666667.\n$$\n\nThird extrapolation ($j=3$):\n$$\nR_{4,3} = \\frac{8 R_{4,2} - R_{3,2}}{7} = \\frac{8 \\cdot 3.1405184366666667 - 3.1494051566666667}{7} = 3.139249048095238.\n$$\n\nThus, the most accurate estimate from the given data is $R_{4,3} \\approx 3.139249048095238$, which rounded to five significant figures is $3.1392$.", "answer": "$$\\boxed{3.1392}$$", "id": "2198771"}]}