{"hands_on_practices": [{"introduction": "The composite trapezoidal rule offers a straightforward way to approximate definite integrals, but a crucial part of numerical analysis is understanding the accuracy of our results. This first exercise provides a foundational practice in both applying the rule and evaluating its performance. By calculating an approximation and then comparing the actual error against the theoretical error bound, you will gain a tangible understanding of how the error formula works and what it represents [@problem_id:2210486].", "problem": "A numerical analyst is studying the accuracy of the composite trapezoidal rule for approximating the definite integral $I = \\int_1^2 \\frac{1}{x} dx$. The approximation is performed using $n=4$ subintervals of equal width.\n\nThe exact value of the integral is known to be $I = \\ln(2)$. The theoretical error bound for the composite trapezoidal rule is given by the inequality $|E_T| \\le \\frac{M(b-a)^3}{12n^2}$, where $[a, b]$ is the interval of integration and $M$ is a constant such that $|f''(x)| \\le M$ for all $x$ in $[a, b]$.\n\nCalculate the difference between the theoretical maximum absolute error (the error bound, using the smallest possible value for $M$) and the actual absolute error of the approximation. For the purpose of this calculation, use the value $\\ln(2) \\approx 0.69314718$.\n\nExpress your final answer as a single real number rounded to six significant figures.", "solution": "We approximate $I=\\int_{1}^{2}\\frac{1}{x}\\,dx$ with the composite trapezoidal rule using $n=4$ subintervals. The step size is\n$$\nh=\\frac{b-a}{n}=\\frac{2-1}{4}=\\frac{1}{4}.\n$$\nThe nodes are $x_{0}=1$, $x_{1}=1+\\frac{1}{4}=\\frac{5}{4}$, $x_{2}=1+\\frac{2}{4}=\\frac{3}{2}$, $x_{3}=1+\\frac{3}{4}=\\frac{7}{4}$, $x_{4}=2$.\n\nThe composite trapezoidal approximation is\n$$\nT=\\frac{h}{2}\\left[f(x_{0})+2\\sum_{k=1}^{n-1}f(x_{k})+f(x_{n})\\right].\n$$\nWith $f(x)=\\frac{1}{x}$, we have\n$$\nf(x_{0})=1,\\quad f(x_{1})=\\frac{4}{5},\\quad f(x_{2})=\\frac{2}{3},\\quad f(x_{3})=\\frac{4}{7},\\quad f(x_{4})=\\frac{1}{2}.\n$$\nCompute the weighted sum:\n$$\nS=f(x_{0})+2\\big(f(x_{1})+f(x_{2})+f(x_{3})\\big)+f(x_{4})\n=1+2\\left(\\frac{4}{5}+\\frac{2}{3}+\\frac{4}{7}\\right)+\\frac{1}{2}.\n$$\nWith common denominator $105$ inside the parentheses,\n$$\n\\frac{4}{5}+\\frac{2}{3}+\\frac{4}{7}=\\frac{84+70+60}{105}=\\frac{214}{105},\n$$\nso\n$$\nS=1+2\\cdot\\frac{214}{105}+\\frac{1}{2}\n=1+\\frac{428}{105}+\\frac{1}{2}\n=\\frac{1171}{210}.\n$$\nThus\n$$\nT=\\frac{h}{2}S=\\frac{1/4}{2}\\cdot\\frac{1171}{210}=\\frac{1}{8}\\cdot\\frac{1171}{210}=\\frac{1171}{1680}.\n$$\n\nUsing $\\ln(2)\\approx 0.69314718$, the actual absolute error is\n$$\nE_{\\text{actual}}=\\left|\\,\\ln(2)-T\\,\\right|=\\left|\\;0.69314718-\\frac{1171}{1680}\\;\\right|.\n$$\nSince $\\frac{1171}{1680} \\approx 0.6970238 > 0.69314718$, the actual error is $T - \\ln(2)$.\n$$\nE_{\\text{actual}} \\approx 0.6970238095 - 0.69314718 \\approx 0.0038766295.\n$$\n\nFor the trapezoidal rule error bound,\n$$\n|E_{T}|\\le \\frac{M(b-a)^{3}}{12n^{2}},\n$$\nwith $f''(x)=\\frac{2}{x^{3}}$, so on $[1,2]$ the smallest possible $M$ satisfying $|f''(x)|\\le M$ is $M=f''(1)=2$. With $b-a=1$ and $n=4$, we get\n$$\nE_{\\text{bound}}=\\frac{2\\cdot 1^{3}}{12\\cdot 4^{2}}=\\frac{2}{192}=\\frac{1}{96}\\approx 0.0104166667.\n$$\n\nThe requested difference (error bound minus actual absolute error) is\n$$\nD = E_{\\text{bound}} - E_{\\text{actual}} \\approx 0.0104166667 - 0.0038766295 \\approx 0.0065400372.\n$$\nRounding to six significant figures gives\n$$\nD\\approx 0.00654004.\n$$", "answer": "$$\\boxed{0.00654004}$$", "id": "2210486"}, {"introduction": "Beyond simply calculating an approximation, a powerful application of numerical methods is in design and planning. The error bound for the trapezoidal rule can be used proactively to determine the computational effort required to achieve a specified accuracy. This practice places you in the role of a biomedical engineer who needs to guarantee a certain level of precision, using the error bound formula to find the minimum number of subintervals, $n$, needed for the task [@problem_id:2210520]. This demonstrates a key skill: *a priori* error estimation.", "problem": "In a pharmacokinetic study, the concentration of a new drug in a patient's bloodstream is modeled as a function of time, $t$, by the equation $C(t) = C_0 \\exp(-kt^2)$. Here, $t$ is the time in hours after injection, $C_0 = 50$ mg/L is the initial concentration, and $k = 0.5 \\text{ hr}^{-2}$ is a constant related to the drug's elimination rate.\n\nTo assess the total drug exposure over the first two hours, a biomedical engineer needs to calculate the Area Under the Curve (AUC), which is given by the definite integral $A = \\int_{0}^{T} C(t) dt$ with $T=2$ hours.\n\nThe engineer uses a numerical approximation method. The time interval $[0, T]$ is divided into $n$ equal subintervals, and the value of the integral is approximated by summing the areas of the trapezoids formed by connecting the points $(t_i, C(t_i))$ and $(t_{i+1}, C(t_{i+1}))$ for each subinterval.\n\nFor this specific numerical method, the absolute error, $|E_n|$, is known to be bounded by the inequality:\n$$|E_n| \\le \\frac{M(T-0)^3}{12n^2}$$\nwhere $M$ is the maximum absolute value of the second derivative of the concentration function, $M = \\max_{t \\in [0, T]} |C''(t)|$.\n\nDetermine the minimum integer number of subintervals, $n$, that the engineer must use to guarantee that the absolute error in the calculated AUC is less than $10^{-3}$ mgÂ·hr/L.", "solution": "We are given $C(t) = C_{0}\\exp(-k t^{2})$ with $C_{0} = 50$ and $k = 0.5$, and the trapezoidal rule error bound\n$$|E_{n}| \\le \\frac{M(T-0)^{3}}{12 n^{2}}, \\quad M = \\max_{t \\in [0,T]} |C''(t)|, \\quad T=2.$$\n\nFirst compute $C''(t)$. Differentiating,\n$$C'(t) = C_{0}\\exp(-k t^{2})(-2 k t),$$\n$$C''(t) = C_{0}\\exp(-k t^{2})\\left(-2k + 4k^{2} t^{2}\\right) = 2k C_{0}\\exp(-k t^{2})\\left(-1 + 2k t^{2}\\right).$$\nThus\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left| -1 + 2k t^{2} \\right|.$$\n\nLet $t_{0} = \\frac{1}{\\sqrt{2k}}$. For $t \\in [0,t_{0}]$, we have $-1 + 2k t^{2} \\le 0$, so\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(1 - 2k t^{2}\\right).$$\nDefine $h_{1}(t) = 2k C_{0}\\exp(-k t^{2})(1 - 2k t^{2})$. Its derivative is\n$$h_{1}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(-3 + 2k t^{2}\\right).$$\nOn $(0,t_{0}]$, since $t_{0}^{2} = \\frac{1}{2k}$, we have $-3 + 2k t^{2} \\le -3 + 1 = -2  0$, hence $h_{1}'(t)  0$. Therefore $h_{1}$ is decreasing on $[0,t_{0}]$ and attains its maximum at $t=0$:\n$$h_{1}(0) = 2k C_{0}.$$\n\nFor $t \\in [t_{0},T]$, we have $-1 + 2k t^{2} \\ge 0$, so\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(-1 + 2k t^{2}\\right).$$\nDefine $h_{2}(t) = 2k C_{0}\\exp(-k t^{2})(-1 + 2k t^{2})$. Its derivative is\n$$h_{2}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(3 - 2k t^{2}\\right).$$\nCritical points in $[t_{0},T]$ occur at $t = \\sqrt{\\frac{3}{2k}}$ if this lies in the interval. With $k = 0.5$, we have $t_{0} = 1$, $T=2$, and $\\sqrt{\\frac{3}{2k}} = \\sqrt{3} \\in [1,2]$. Evaluate $h_{2}$ at candidates:\n- At $t = t_{0}$, $h_{2}(t_{0}) = 0$.\n- At $t = \\sqrt{\\frac{3}{2k}}$, since $2k t^{2} = 3$,\n$$h_{2}\\!\\left(\\sqrt{\\frac{3}{2k}}\\right) = 2k C_{0} \\cdot 2 \\cdot \\exp\\!\\left(-\\frac{3}{2}\\right) = 4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right).$$\n- At $t = T=2$,\n$$h_{2}(2) = 2k C_{0}\\left(-1 + 8k\\right)\\exp(-4k).$$\n\nCompare these to $2k C_{0}$. Note that\n$$4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right) = 2k C_{0}\\cdot 2\\exp\\!\\left(-\\frac{3}{2}\\right)  2k C_{0}$$\nbecause $\\exp\\!\\left(\\frac{3}{2}\\right) > 2$, hence $2\\exp(-\\frac{3}{2})  1$. Also $h_{2}(2)$ is smaller than $2k C_{0}$ for $k=0.5$. Therefore the maximum over $[0,2]$ is attained at $t=0$:\n$$M = \\max_{t \\in [0,2]} |C''(t)| = 2k C_{0} = 2 \\cdot 0.5 \\cdot 50 = 50.$$\n\nApply the error bound with $T=2$:\n$$|E_{n}| \\le \\frac{M T^{3}}{12 n^{2}} = \\frac{50 \\cdot 2^{3}}{12 n^{2}} = \\frac{100}{3 n^{2}}.$$\nRequire $|E_{n}|  10^{-3}$:\n$$\\frac{100}{3 n^{2}}  10^{-3} \\quad \\Longleftrightarrow \\quad n^{2} > \\frac{100}{3 \\cdot 10^{-3}} = \\frac{100000}{3}.$$\nThus $n > \\sqrt{\\frac{100000}{3}}$. Since $182^{2} = 33124  \\frac{100000}{3}  33489 = 183^{2}$, the minimal integer $n$ satisfying the inequality is\n$$n = 183.$$", "answer": "$$\\boxed{183}$$", "id": "2210520"}, {"introduction": "Standard quadrature rules, like the trapezoidal rule, often assume the function we are integrating is well-behaved across the entire interval. However, many problems in science and engineering involve integrable singularities, where the function value goes to infinity at an endpoint. This practice introduces an advanced and elegant technique called 'singularity subtraction' to handle such cases [@problem_id:2210479]. By cleverly separating the problematic part of the integrand for analytical treatment, you will transform the problem into one that can be accurately solved using the standard composite trapezoidal rule.", "problem": "A common challenge in numerical integration is the presence of an integrable singularity at one of the endpoints of the integration interval, which prevents the direct application of standard quadrature rules. Consider the definite integral\n$$ I = \\int_{0}^{1} \\frac{\\cos(x)}{\\sqrt[3]{x}} dx $$\nThe integrand is singular at $x=0$. A standard technique to handle this is to rewrite the integral by separating the singular and non-singular behaviors. We can express the integral $I$ as the sum of a purely analytical integral and another integral whose integrand is well-behaved over the closed interval $[0, 1]$:\n$$ I = \\int_{0}^{1} \\left( \\frac{\\cos(x) - 1}{\\sqrt[3]{x}} \\right) dx + \\int_{0}^{1} \\frac{1}{\\sqrt[3]{x}} dx $$\nLet's call the first integral on the right-hand side $I_{num}$ and the second one $I_{an}$. The main integral is then $I = I_{num} + I_{an}$.\n\nYour task is to find a numerical approximation for the original integral $I$. First, evaluate $I_{an}$ analytically. Then, approximate the value of $I_{num}$ using the composite trapezoidal rule with $N=4$ subintervals. Combine your results to find the final value for $I$.\n\nProvide the final numerical value for $I$, rounded to five significant figures. Use radians for the argument of the cosine function.", "solution": "We rewrite the integral as stated:\n$$\nI=\\int_{0}^{1}\\frac{\\cos(x)}{x^{1/3}}\\,dx=\\int_{0}^{1}\\frac{\\cos(x)-1}{x^{1/3}}\\,dx+\\int_{0}^{1}\\frac{1}{x^{1/3}}\\,dx=I_{num}+I_{an}.\n$$\nFirst, evaluate the analytical part. Using $\\int x^{\\alpha}\\,dx=\\frac{x^{\\alpha+1}}{\\alpha+1}$ for $\\alpha\\neq -1$,\n$$\nI_{an}=\\int_{0}^{1}x^{-1/3}\\,dx=\\left[\\frac{x^{2/3}}{2/3}\\right]_{0}^{1}=\\frac{3}{2}.\n$$\nFor the numerical part, define $f(x)=\\frac{\\cos(x)-1}{x^{1/3}}$ for $x>0$ and extend continuously to $x=0$ by the limit\n$$\n\\lim_{x\\to 0}\\frac{\\cos(x)-1}{x^{1/3}}=\\lim_{x\\to 0}\\frac{-x^{2}/2+O(x^{4})}{x^{1/3}}=0,\n$$\nso $f(0)=0$. Apply the composite trapezoidal rule on $[0,1]$ with $N=4$ subintervals, step size $h=\\frac{1-0}{4}=\\frac{1}{4}$. The nodes are $x_{i}=ih$ for $i=0,1,2,3,4$, and\n$$\nI_{num}\\approx h\\left(\\frac{f(x_{0})+f(x_{4})}{2}+\\sum_{i=1}^{3}f(x_{i})\\right).\n$$\nCompute the needed values (using radians):\n- $x_{0}=0$: $f(x_{0})=0$.\n- $x_{1}=\\frac{1}{4}$: $\\cos\\!\\left(\\frac{1}{4}\\right)\\approx 0.9689124217106448$, $(\\frac{1}{4})^{1/3}=4^{-1/3}\\approx 0.6299605249474366$, hence\n$$\nf(x_{1})=\\frac{\\cos(0.25)-1}{(0.25)^{1/3}}\\approx \\frac{-0.0310875782893552}{0.6299605249474366}\\approx -0.0493484218083552.\n$$\n- $x_{2}=\\frac{1}{2}$: $\\cos\\!\\left(\\frac{1}{2}\\right)\\approx 0.8775825618903728$, $(\\frac{1}{2})^{1/3}=2^{-1/3}\\approx 0.7937005259840998$, hence\n$$\nf(x_{2})\\approx \\frac{-0.1224174381096272}{0.7937005259840998}\\approx -0.1542363071485222.\n$$\n- $x_{3}=\\frac{3}{4}$: $\\cos\\!\\left(\\frac{3}{4}\\right)\\approx 0.7316888688738209$, $(\\frac{3}{4})^{1/3}\\approx 0.9085602964160698$, hence\n$$\nf(x_{3})\\approx \\frac{-0.2683111311261791}{0.9085602964160698}\\approx -0.2953146116024106.\n$$\n- $x_{4}=1$: $\\cos(1)\\approx 0.5403023058681398$, so\n$$\nf(x_{4})=\\cos(1)-1\\approx -0.4596976941318602.\n$$\nAssemble the trapezoidal approximation:\n$$\nI_{num}\\approx \\frac{1}{4}\\left(\\frac{0+(-0.4596976941318602)}{2}+(-0.0493484218083552)+(-0.1542363071485222)+(-0.2953146116024106)\\right),\n$$\n$$\nI_{num}\\approx \\frac{1}{4}\\left(-0.2298488470659301-0.0493484218083552-0.1542363071485222-0.2953146116024106\\right)\\approx \\frac{1}{4}(-0.7287481876252181)\\approx -0.1821870469063045.\n$$\nCombine with $I_{an}=\\frac{3}{2}$:\n$$\nI\\approx I_{an}+I_{num}= \\frac{3}{2}-0.1821870469063045\\approx 1.3178129530936955.\n$$\nRounded to five significant figures, the value is $1.3178$.", "answer": "$$\\boxed{1.3178}$$", "id": "2210479"}]}