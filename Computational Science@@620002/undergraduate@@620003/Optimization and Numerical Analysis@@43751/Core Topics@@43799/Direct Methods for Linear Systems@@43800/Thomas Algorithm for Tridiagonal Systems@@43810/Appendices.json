{"hands_on_practices": [{"introduction": "Before we dive into solving tridiagonal systems, let's start with the basics of verifying a potential solution. This practice will help you get comfortable with the structure of a tridiagonal matrix and introduce the concept of the residual vector, which is a fundamental tool for assessing the accuracy of any proposed solution [@problem_id:2222914]. By calculating the residual, you are directly measuring how \"far off\" a guess is from the true answer, a core concept in iterative methods and error analysis.", "problem": "In the context of solving systems of linear equations that arise from discretizing differential equations, tridiagonal systems are very common. Consider the specific tridiagonal system of linear equations $A\\mathbf{x} = \\mathbf{d}$, where the $3 \\times 3$ matrix $A$ is defined by its elements $a_{11}=2$, $a_{12}=-1$, $a_{21}=-1$, $a_{22}=2$, $a_{23}=-1$, $a_{32}=-1$, and $a_{33}=2$, with all other elements being zero. The right-hand side vector $\\mathbf{d}$ has components $d_1 = 4$, $d_2 = 1$, and $d_3 = 6$.\n\nAn engineer proposes a candidate solution vector $\\mathbf{x}_{\\text{candidate}}$ with components $x_1 = 4$, $x_2 = 5$, and $x_3 = 5$. To assess the accuracy of this proposal, calculate the Euclidean norm of the residual vector $\\mathbf{r}$, which is defined as $\\mathbf{r} = \\mathbf{d} - A\\mathbf{x}_{\\text{candidate}}$.\n\nProvide the value of the Euclidean norm of the residual, rounded to three significant figures.", "solution": "We are given the tridiagonal matrix\n$$\nA=\\begin{pmatrix}\n2 & -1 & 0\\\\\n-1 & 2 & -1\\\\\n0 & -1 & 2\n\\end{pmatrix},\n$$\nthe right-hand side vector $\\mathbf{d}=\\begin{pmatrix}4\\\\1\\\\6\\end{pmatrix}$, and the candidate vector $\\mathbf{x}_{\\text{candidate}}=\\begin{pmatrix}4\\\\5\\\\5\\end{pmatrix}$.\n\nCompute $A\\mathbf{x}_{\\text{candidate}}$ by matrix-vector multiplication:\n$$\nA\\mathbf{x}_{\\text{candidate}}=\n\\begin{pmatrix}\n2\\cdot 4+(-1)\\cdot 5+0\\cdot 5\\\\\n(-1)\\cdot 4+2\\cdot 5+(-1)\\cdot 5\\\\\n0\\cdot 4+(-1)\\cdot 5+2\\cdot 5\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n8-5\\\\\n-4+10-5\\\\\n-5+10\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n3\\\\\n1\\\\\n5\n\\end{pmatrix}.\n$$\n\nThe residual is $\\mathbf{r}=\\mathbf{d}-A\\mathbf{x}_{\\text{candidate}}$, hence\n$$\n\\mathbf{r}=\n\\begin{pmatrix}\n4\\\\\n1\\\\\n6\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n3\\\\\n1\\\\\n5\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1\\\\\n0\\\\\n1\n\\end{pmatrix}.\n$$\n\nThe Euclidean norm is\n$$\n\\|\\mathbf{r}\\|_{2}=\\sqrt{1^{2}+0^{2}+1^{2}}=\\sqrt{2}.\n$$\n\nRounding to three significant figures gives $1.41$.", "answer": "$$\\boxed{1.41}$$", "id": "2222914"}, {"introduction": "The Thomas algorithm efficiently solves tridiagonal systems in two main stages: forward elimination and backward substitution. This exercise allows you to focus solely on the second stage, a recursive process that is elegant in its simplicity. By starting with a system that has already undergone forward elimination, you can practice the backward sweep to construct the final solution vector component by component [@problem_id:2222856].", "problem": "In computational physics, discretizing differential equations often leads to large systems of linear equations. For example, modeling one-dimensional steady-state heat conduction in a rod can result in a tridiagonal system of the form $A\\mathbf{x} = \\mathbf{d}$, where $\\mathbf{x}$ represents the temperatures at discrete points along the rod.\n\nSuppose such a $5 \\times 5$ system has been pre-processed using the forward elimination stage of the Thomas algorithm. This operation transforms the original system into an equivalent upper bidiagonal system $U\\mathbf{x} = \\mathbf{y}$ of the form:\n$$\n\\begin{pmatrix}\n1 & c'_{1} & 0 & 0 & 0 \\\\\n0 & 1 & c'_{2} & 0 & 0 \\\\\n0 & 0 & 1 & c'_{3} & 0 \\\\\n0 & 0 & 0 & 1 & c'_{4} \\\\\n0 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\\\ x_5\n\\end{pmatrix}\n=\n\\begin{pmatrix}\ny_1 \\\\ y_2 \\\\ y_3 \\\\ y_4 \\\\ y_5\n\\end{pmatrix}\n$$\nThe non-zero off-diagonal coefficients of the matrix $U$ are given as:\n$c'_{1} = -0.5$\n$c'_{2} = 0.25$\n$c'_{3} = -0.2$\n$c'_{4} = 0.5$\n\nThe elements of the transformed right-hand side vector $\\mathbf{y}$ are:\n$y_1 = 3.0$\n$y_2 = -1.0$\n$y_3 = 5.0$\n$y_4 = 2.0$\n$y_5 = 8.0$\n\nYour task is to complete the solution process by performing the backward substitution pass to find the unknown vector $\\mathbf{x} = (x_1, x_2, x_3, x_4, x_5)^T$. Calculate the value of the first component, $x_1$. Round your final answer to four significant figures.", "solution": "The backward substitution for an upper bidiagonal system with unit diagonal proceeds from the last equation upward. For the given system, the equations are:\n$$x_{5} = y_{5},$$\n$$x_{4} + c'_{4} x_{5} = y_{4} \\implies x_{4} = y_{4} - c'_{4} x_{5},$$\n$$x_{3} + c'_{3} x_{4} = y_{3} \\implies x_{3} = y_{3} - c'_{3} x_{4},$$\n$$x_{2} + c'_{2} x_{3} = y_{2} \\implies x_{2} = y_{2} - c'_{2} x_{3},$$\n$$x_{1} + c'_{1} x_{2} = y_{1} \\implies x_{1} = y_{1} - c'_{1} x_{2}.$$\n\nSubstituting the given values:\n$$x_{5} = 8.0,$$\n$$x_{4} = 2.0 - (0.5)(8.0) = 2.0 - 4.0 = -2.0,$$\n$$x_{3} = 5.0 - (-0.2)(-2.0) = 5.0 - 0.4 = 4.6,$$\n$$x_{2} = -1.0 - (0.25)(4.6) = -1.0 - 1.15 = -2.15,$$\n$$x_{1} = 3.0 - (-0.5)(-2.15) = 3.0 - 1.075 = 1.925.$$\n\nRounding $x_{1}$ to four significant figures gives $1.925$.", "answer": "$$\\boxed{1.925}$$", "id": "2222856"}, {"introduction": "A powerful algorithm is best utilized when its limitations are understood. This practice moves beyond rote application to critical analysis, focusing on the conditions that can cause the Thomas algorithm to fail. You will investigate the forward elimination formulas to see how a \"zero pivot\" can arise, which is a crucial concept for ensuring the stability and reliability of numerical solvers in real-world applications [@problem_id:2222897].", "problem": "A tridiagonal system of linear equations is a system of the form $Ax=d$, where the matrix $A$ has non-zero elements only on the main diagonal, the first diagonal below it (subdiagonal), and the first diagonal above it (superdiagonal). A general $n \\times n$ tridiagonal system can be written as:\n$$\n\\begin{pmatrix}\nb_1 & c_1 & & & \\\\\na_2 & b_2 & c_2 & & \\\\\n& \\ddots & \\ddots & \\ddots & \\\\\n& & a_{n-1} & b_{n-1} & c_{n-1} \\\\\n& & & a_n & b_n\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\ x_2 \\\\ \\vdots \\\\ x_{n-1} \\\\ x_n\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nd_1 \\\\ d_2 \\\\ \\vdots \\\\ d_{n-1} \\\\ d_n\n\\end{pmatrix}\n$$\nwhere elements not shown are zero. Note that by convention, the subdiagonal vector is indexed from $a_2$ to $a_n$ and the superdiagonal from $c_1$ to $c_{n-1}$.\n\nThe Thomas algorithm is an efficient method for solving such systems. The first stage of the algorithm, known as the forward elimination pass, involves calculating a new set of coefficients for the matrix and the right-hand side vector. The recurrence relations for this pass are:\n$$c'_1 = \\frac{c_1}{b_1}$$\n$$d'_1 = \\frac{d_1}{b_1}$$\nand for $i = 2, 3, \\dots, n$:\n$$m_i = b_i - a_i c'_{i-1}$$\n$$c'_i = \\frac{c_i}{m_i} \\quad (\\text{for } i<n)$$\n$$d'_i = \\frac{d_i - a_i d'_{i-1}}{m_i}$$\nThe algorithm fails if a division by zero is encountered at any step, which occurs if $b_1=0$ or if any $m_i=0$.\n\nConsider the following $3 \\times 3$ tridiagonal systems, all with the right-hand side vector $\\mathbf{d} = \\begin{pmatrix} 3 & 5 & 2 \\end{pmatrix}^T$. For which of the systems does the standard Thomas algorithm fail due to a division by zero during the forward elimination pass?\n\nA. \n$$A = \\begin{pmatrix} 4 & -1 & 0 \\\\ -1 & 4 & -1 \\\\ 0 & -1 & 4 \\end{pmatrix}$$\n\nB. \n$$A = \\begin{pmatrix} 1 & 1 & 0 \\\\ 2 & 3 & 1 \\\\ 0 & 3 & 5 \\end{pmatrix}$$\n\nC. \n$$A = \\begin{pmatrix} 2 & 4 & 0 \\\\ 1 & 2 & -3 \\\\ 0 & 1 & 1 \\end{pmatrix}$$\n\nD. \n$$A = \\begin{pmatrix} 5 & -2 & 0 \\\\ 10 & -3 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix}$$", "solution": "To determine for which system the Thomas algorithm fails, we must check the denominators in the forward elimination recurrence relations for a division by zero. The potential points of failure are the first pivot element, $b_1$, and the subsequent pivot elements, $m_i = b_i - a_i c'_{i-1}$. We are given $3 \\times 3$ systems, so we need to check $b_1$ and $m_2 = b_2 - a_2 c'_{1}$. We do not need to calculate $m_3$ if $m_2$ is already zero. The right-hand side vector $\\mathbf{d}$ does not affect whether the forward elimination fails due to a zero pivot, so we only need to consider the matrix $A$ for each option.\n\nFor each system, the vectors $a$, $b$, and $c$ are defined as:\n$$A = \\begin{pmatrix} b_1 & c_1 & 0 \\\\ a_2 & b_2 & c_2 \\\\ 0 & a_3 & b_3 \\end{pmatrix}$$\n\nLet's analyze each option:\n\n**Option A:**\nThe matrix is $A = \\begin{pmatrix} 4 & -1 & 0 \\\\ -1 & 4 & -1 \\\\ 0 & -1 & 4 \\end{pmatrix}$.\nThe coefficients are $b_1=4, c_1=-1, a_2=-1, b_2=4$.\n1.  Check the first pivot: $b_1 = 4$. Since $b_1 \\neq 0$, the first step is valid.\n2.  Calculate $c'_1$: $c'_1 = \\frac{c_1}{b_1} = \\frac{-1}{4}$.\n3.  Calculate the second pivot, $m_2$: $m_2 = b_2 - a_2 c'_{1} = 4 - (-1)\\left(\\frac{-1}{4}\\right) = 4 - \\frac{1}{4} = \\frac{15}{4}$.\nSince $m_2 \\neq 0$, the algorithm does not fail for this system.\n\n**Option B:**\nThe matrix is $A = \\begin{pmatrix} 1 & 1 & 0 \\\\ 2 & 3 & 1 \\\\ 0 & 3 & 5 \\end{pmatrix}$.\nThe coefficients are $b_1=1, c_1=1, a_2=2, b_2=3$.\n1.  Check the first pivot: $b_1 = 1$. Since $b_1 \\neq 0$, the first step is valid.\n2.  Calculate $c'_1$: $c'_1 = \\frac{c_1}{b_1} = \\frac{1}{1} = 1$.\n3.  Calculate the second pivot, $m_2$: $m_2 = b_2 - a_2 c'_{1} = 3 - (2)(1) = 3 - 2 = 1$.\nSince $m_2 \\neq 0$, the algorithm does not fail for this system.\n\n**Option C:**\nThe matrix is $A = \\begin{pmatrix} 2 & 4 & 0 \\\\ 1 & 2 & -3 \\\\ 0 & 1 & 1 \\end{pmatrix}$.\nThe coefficients are $b_1=2, c_1=4, a_2=1, b_2=2$.\n1.  Check the first pivot: $b_1 = 2$. Since $b_1 \\neq 0$, the first step is valid.\n2.  Calculate $c'_1$: $c'_1 = \\frac{c_1}{b_1} = \\frac{4}{2} = 2$.\n3.  Calculate the second pivot, $m_2$: $m_2 = b_2 - a_2 c'_{1} = 2 - (1)(2) = 2 - 2 = 0$.\nSince $m_2 = 0$, a division by zero will occur when calculating $c'_2$ and $d'_2$. Therefore, the Thomas algorithm fails for this system.\n\n**Option D:**\nThe matrix is $A = \\begin{pmatrix} 5 & -2 & 0 \\\\ 10 & -3 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix}$.\nThe coefficients are $b_1=5, c_1=-2, a_2=10, b_2=-3$.\n1.  Check the first pivot: $b_1 = 5$. Since $b_1 \\neq 0$, the first step is valid.\n2.  Calculate $c'_1$: $c'_1 = \\frac{c_1}{b_1} = \\frac{-2}{5}$.\n3.  Calculate the second pivot, $m_2$: $m_2 = b_2 - a_2 c'_{1} = -3 - (10)\\left(\\frac{-2}{5}\\right) = -3 - (-4) = 1$.\nSince $m_2 \\neq 0$, the algorithm does not fail for this system.\n\nBased on the analysis, only the system in Option C causes a division by zero during the forward elimination pass of the Thomas algorithm.", "answer": "$$\\boxed{C}$$", "id": "2222897"}]}