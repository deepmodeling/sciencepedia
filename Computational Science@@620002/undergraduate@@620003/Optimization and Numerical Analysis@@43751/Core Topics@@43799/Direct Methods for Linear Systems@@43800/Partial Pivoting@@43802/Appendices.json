{"hands_on_practices": [{"introduction": "The journey into Gaussian elimination with partial pivoting begins with a single, crucial first step. Before any elimination occurs, we must ensure our pivot element is the best possible choice to maintain numerical stability. This initial exercise [@problem_id:2193012] focuses on mastering this fundamental operation: identifying the element with the largest absolute value in the first column and performing the necessary row swap to bring it into the pivot position.", "problem": "In numerical linear algebra, strategies are employed to improve the stability of algorithms like Gaussian elimination. Consider the system of linear equations represented by the matrix equation $A\\mathbf{x} = \\mathbf{b}$, where the coefficient matrix $A$ is given by:\n\n$$\nA = \\begin{pmatrix}\n3.1 & -1.5 & 4.2 \\\\\n-2.5 & 8.9 & -0.7 \\\\\n-7.8 & 3.4 & 1.1\n\\end{pmatrix}\n$$\n\nTo start solving this system using Gaussian elimination with a partial pivoting strategy, a specific row interchange must be performed first to ensure the pivot element has the largest possible magnitude. Which of the following describes the first operation required by this strategy?\n\nA. Interchange Row 1 and Row 2.\n\nB. Interchange Row 1 and Row 3.\n\nC. Interchange Row 2 and Row 3.\n\nD. No row interchange is required in the first step.\n\nE. The strategy cannot be applied as the matrix is singular.", "solution": "The problem asks for the first step of Gaussian elimination with a partial pivoting strategy for the given $3 \\times 3$ matrix $A$.\n\nThe matrix is:\n$$\nA = \\begin{pmatrix}\n3.1 & -1.5 & 4.2 \\\\\n-2.5 & 8.9 & -0.7 \\\\\n-7.8 & 3.4 & 1.1\n\\end{pmatrix}\n$$\n\nThe partial pivoting strategy for the first column (step $k=1$) involves identifying the row that contains the element with the largest absolute value in the first column. This element will be the pivot for the first stage of elimination.\n\nLet's denote the elements of the matrix as $a_{ij}$, where $i$ is the row index and $j$ is the column index. We need to examine the elements in the first column: $a_{11}$, $a_{21}$, and $a_{31}$.\n\nThe elements are:\n$a_{11} = 3.1$\n$a_{21} = -2.5$\n$a_{31} = -7.8$\n\nNext, we calculate the absolute value of each of these elements:\n$|a_{11}| = |3.1| = 3.1$\n$|a_{21}| = |-2.5| = 2.5$\n$|a_{31}| = |-7.8| = 7.8$\n\nWe now find the maximum of these absolute values:\n$\\max(|a_{11}|, |a_{21}|, |a_{31}|) = \\max(3.1, 2.5, 7.8) = 7.8$.\n\nThis maximum absolute value corresponds to the element $a_{31}$, which is in the third row.\n\nAccording to the partial pivoting procedure, the row containing the pivot element (the element with the largest absolute value in the current column) must be swapped with the current pivot row. For the first step, the current pivot row is Row 1. Since the largest magnitude element is in Row 3, we must interchange Row 1 and Row 3.\n\nAfter the interchange, the matrix will look like this:\n$$\nA' = \\begin{pmatrix}\n-7.8 & 3.4 & 1.1 \\\\\n-2.5 & 8.9 & -0.7 \\\\\n3.1 & -1.5 & 4.2\n\\end{pmatrix}\n$$\nThe new pivot element is $a'_{11} = -7.8$, which has a larger magnitude than the other original elements in the first column.\n\nTherefore, the first operation required is to interchange Row 1 and Row 3. This corresponds to option B. Option E is incorrect as the pivoting strategy can be applied regardless of singularity (though a singular matrix will lead to a zero pivot at some stage), and the operation is well-defined.", "answer": "$$\\boxed{B}$$", "id": "2193012"}, {"introduction": "Why is partial pivoting so essential? This practice [@problem_id:2193047] provides a concrete answer by asking you to solve a sensitive system of equations using finite-precision arithmetic. You will see firsthand how choosing the largest pivot prevents the amplification of round-off errors, a foundational concept for achieving reliable numerical solutions.", "problem": "Consider the following system of linear equations:\n$$\n\\begin{align*}\n(2.00 \\times 10^{-4}) x_1 + 2.00 x_2 &= 4.00 \\\\\n1.00 x_1 + 3.00 x_2 &= 5.00\n\\end{align*}\n$$\nYou are to solve this system using Gaussian elimination, but all calculations must be performed using a simplified floating-point representation known as **three-digit chopping arithmetic**. In this arithmetic system, numbers are first written in normalized decimal form, $\\pm 0.d_1d_2d_3d_4... \\times 10^n$, where $d_1 \\in \\{1, 2, \\dots, 9\\}$. The number is then stored by \"chopping off\" all digits after the third, resulting in the form $\\pm 0.d_1d_2d_3 \\times 10^n$. This chopping occurs after every individual arithmetic operation (addition, subtraction, multiplication, division).\n\nCalculate the solution vector $\\mathbf{x} = [x_1, x_2]^T$ using Gaussian elimination **with partial pivoting**. Express your final answer as the two components of the solution vector.", "solution": "We apply Gaussian elimination with partial pivoting under three-digit chopping arithmetic (store numbers in normalized form with three significant digits after each operation).\n\nStart with the augmented matrix\n$$\n\\left[\\begin{array}{cc|c}\n2.00\\times 10^{-4} & 2.00 & 4.00\\\\\n1.00 & 3.00 & 5.00\n\\end{array}\\right].\n$$\nPartial pivoting on column 1 compares $|2.00\\times 10^{-4}|$ and $|1.00|$, so we swap the two rows:\n$$\n\\left[\\begin{array}{cc|c}\n1.00 & 3.00 & 5.00\\\\\n2.00\\times 10^{-4} & 2.00 & 4.00\n\\end{array}\\right].\n$$\nElimination multiplier\n$$\n\\ell_{21}=\\text{chop}_{3}\\left(\\frac{2.00\\times 10^{-4}}{1.00}\\right)=2.00\\times 10^{-4}.\n$$\nUpdate row 2 entries with chopping after each operation:\n- New $a_{21}$:\n$$\n\\text{chop}_{3}\\left(2.00\\times 10^{-4}-\\ell_{21}\\cdot 1.00\\right)=\\text{chop}_{3}\\left(2.00\\times 10^{-4}-2.00\\times 10^{-4}\\right)=0.\n$$\n- New $a_{22}$:\n$$\n\\ell_{21}\\cdot a_{12}=\\text{chop}_{3}\\left((2.00\\times 10^{-4})\\cdot 3.00\\right)=6.00\\times 10^{-4},\n$$\n$$\na_{22}^{(new)}=\\text{chop}_{3}\\left(2.00-6.00\\times 10^{-4}\\right)=\\text{chop}_{3}(1.9994)=1.99.\n$$\n- New $b_{2}$:\n$$\n\\ell_{21}\\cdot b_{1}=\\text{chop}_{3}\\left((2.00\\times 10^{-4})\\cdot 5.00\\right)=1.00\\times 10^{-3},\n$$\n$$\nb_{2}^{(new)}=\\text{chop}_{3}\\left(4.00-1.00\\times 10^{-3}\\right)=\\text{chop}_{3}(3.999)=3.99.\n$$\nThe upper triangular system is thus\n$$\n\\begin{cases}\n1.00\\,x_{1}+3.00\\,x_{2}=5.00,\\\\\n1.99\\,x_{2}=3.99.\n\\end{cases}\n$$\nBack substitution with chopping after each operation:\n$$\nx_{2}=\\text{chop}_{3}\\left(\\frac{3.99}{1.99}\\right)=\\text{chop}_{3}(2.005025\\ldots)=2.00.\n$$\nThen\n$$\na_{12}\\,x_{2}=\\text{chop}_{3}(3.00\\cdot 2.00)=6.00,\\quad\nb_{1}-a_{12}x_{2}=\\text{chop}_{3}(5.00-6.00)=-1.00,\n$$\n$$\nx_{1}=\\text{chop}_{3}\\left(\\frac{-1.00}{1.00}\\right)=-1.00.\n$$\nTherefore, under three-digit chopping arithmetic with partial pivoting, the solution vector is $x_{1}=-1.00$ and $x_{2}=2.00$.", "answer": "$$\\boxed{\\begin{pmatrix}-1.00 & 2.00\\end{pmatrix}}$$", "id": "2193047"}, {"introduction": "Partial pivoting usually provides a clear path, but what happens when there's a tie for the best pivot? This problem [@problem_id:2193057] explores such a scenario within the context of LU decomposition, revealing that the resulting $L$ and $U$ factors are not necessarily unique. By working through the consequences of this ambiguity, you will gain a deeper appreciation for the structure of the factorization and the choices embedded within the algorithm.", "problem": "In numerical linear algebra, the LU decomposition with partial pivoting is a standard algorithm for factorizing a matrix $A$ into the form $PA = LU$, where $P$ is a permutation matrix, $L$ is a unit lower-triangular matrix (with ones on its diagonal), and $U$ is an upper-triangular matrix. The choice of the permutation matrix at each step is determined by selecting the element with the largest absolute value in the current column as the pivot.\n\nConsider the following $3 \\times 3$ matrix:\n$$\nA = \\begin{pmatrix} 4 & 2 & 1 \\\\ 2 & 5 & 3 \\\\ -4 & -1 & 6 \\end{pmatrix}\n$$\nWhen performing the first step of Gaussian elimination on this matrix, there is a tie for the pivot choice in the first column. This ambiguity leads to two distinct but valid LU factorizations, $(P_1, L_1, U_1)$ and $(P_2, L_2, U_2)$.\n\nThe Frobenius norm of a matrix $M$ is defined as $\\|M\\|_F = \\sqrt{\\sum_{i,j} |M_{ij}|^2}$. Your task is to find both possible factorizations that arise from this tie and then calculate the absolute difference between the squared Frobenius norms of the two resulting lower-triangular matrices, i.e., compute $|\\, \\|L_1\\|_F^2 - \\|L_2\\|_F^2 \\,|$.\n\nExpress your final answer as an exact fraction in simplest form.", "solution": "We perform LU decomposition with partial pivoting on\n$$\nA=\\begin{pmatrix}4&2&1\\\\2&5&3\\\\-4&-1&6\\end{pmatrix}.\n$$\nIn the first column, $|4|=|-4|$, so there are two valid pivot choices, yielding two factorizations.\n\nCase 1 (pivot $4$ in row 1, no initial swap): Compute first-column multipliers\n$$\n\\ell_{21}=\\frac{2}{4}=\\frac{1}{2},\\qquad \\ell_{31}=\\frac{-4}{4}=-1.\n$$\nEliminating below the pivot gives\n$$\n\\begin{pmatrix}\n4&2&1\\\\\n0&4&\\frac{5}{2}\\\\\n0&1&7\n\\end{pmatrix}.\n$$\nIn column 2, the pivot is $4$ (no swap). The multiplier is\n$$\n\\ell_{32}=\\frac{1}{4}.\n$$\nEliminating yields the final upper-triangular matrix\n$$\nU_{1}=\\begin{pmatrix}\n4&2&1\\\\\n0&4&\\frac{5}{2}\\\\\n0&0&\\frac{51}{8}\n\\end{pmatrix},\n$$\nand the unit lower-triangular matrix storing the multipliers is\n$$\nL_{1}=\\begin{pmatrix}\n1&0&0\\\\[4pt]\n\\frac{1}{2}&1&0\\\\[4pt]\n-1&\\frac{1}{4}&1\n\\end{pmatrix}.\n$$\nThe squared Frobenius norm is the sum of squares of the entries:\n$$\n\\|L_{1}\\|_{F}^{2}=1^{2}+0+0+\\left(\\frac{1}{2}\\right)^{2}+1^{2}+0+(-1)^{2}+\\left(\\frac{1}{4}\\right)^{2}+1^{2}\n=4+\\frac{1}{4}+\\frac{1}{16}=\\frac{69}{16}.\n$$\n\nCase 2 (pivot $-4$ in row 3, swap rows 1 and 3 initially): After swapping rows 1 and 3, the working matrix is\n$$\n\\begin{pmatrix}\n-4&-1&6\\\\\n2&5&3\\\\\n4&2&1\n\\end{pmatrix}.\n$$\nFirst-column multipliers are\n$$\n\\ell_{21}'=\\frac{2}{-4}=-\\frac{1}{2},\\qquad \\ell_{31}'=\\frac{4}{-4}=-1.\n$$\nEliminating gives\n$$\n\\begin{pmatrix}\n-4&-1&6\\\\\n0&\\frac{9}{2}&6\\\\\n0&1&7\n\\end{pmatrix}.\n$$\nIn column 2, the pivot is $\\frac{9}{2}$ (no swap). The multiplier is\n$$\n\\ell_{32}'=\\frac{1}{9/2}=\\frac{2}{9}.\n$$\nEliminating yields\n$$\nU_{2}=\\begin{pmatrix}\n-4&-1&6\\\\\n0&\\frac{9}{2}&6\\\\\n0&0&\\frac{17}{3}\n\\end{pmatrix},\\qquad\nL_{2}=\\begin{pmatrix}\n1&0&0\\\\[4pt]\n-\\frac{1}{2}&1&0\\\\[4pt]\n-1&\\frac{2}{9}&1\n\\end{pmatrix}.\n$$\nThus\n$$\n\\|L_{2}\\|_{F}^{2}=1^{2}+0+0+\\left(\\frac{1}{2}\\right)^{2}+1^{2}+0+(-1)^{2}+\\left(\\frac{2}{9}\\right)^{2}+1^{2}\n=4+\\frac{1}{4}+\\frac{4}{81}=\\frac{1393}{324}.\n$$\n\nFinally, the required absolute difference is\n$$\n\\left|\\|L_{1}\\|_{F}^{2}-\\|L_{2}\\|_{F}^{2}\\right|\n=\\left|\\frac{69}{16}-\\frac{1393}{324}\\right|\n=\\left|\\frac{5589}{1296}-\\frac{5572}{1296}\\right|\n=\\frac{17}{1296}.\n$$", "answer": "$$\\boxed{\\frac{17}{1296}}$$", "id": "2193057"}]}