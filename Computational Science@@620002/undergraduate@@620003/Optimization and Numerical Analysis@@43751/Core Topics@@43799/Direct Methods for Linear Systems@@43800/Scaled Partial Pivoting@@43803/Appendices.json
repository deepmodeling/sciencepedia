{"hands_on_practices": [{"introduction": "The scaled partial pivoting algorithm begins with a crucial preparatory step: evaluating the \"scale\" of each row. This problem focuses on this foundational mechanic. By first calculating the scale vector and then using it to determine the initial pivot row, you will practice the essential first step that underpins the entire process of numerically stable Gaussian elimination. [@problem_id:2199854]", "id": "2199854", "problem": "Consider the linear system $A\\mathbf{x} = \\mathbf{b}$, where the matrix $A$ is given by:\n$$ A = \\begin{pmatrix} 2 & 1 & -5 \\\\ -4 & 8 & 2 \\\\ 3 & -1 & 4 \\end{pmatrix} $$\nWhen solving this system using Gaussian elimination with a scaled partial pivoting strategy, the procedure begins by determining an initial scale vector and selecting the first pivot row. The scale vector $\\mathbf{s}$ is a column vector where its $i$-th component, $s_i$, is the maximum absolute value of the elements in the $i$-th row of $A$ (i.e., $s_i = \\max_{j} |a_{ij}|$). The first pivot row is then chosen by identifying the row index $p$ that maximizes the ratio $\\frac{|a_{p1}|}{s_p}$.\n\nWhich of the following options correctly identifies the initial scale vector $\\mathbf{s}$ (written as a row vector for display) and the index of the first pivot row? (Assume rows are indexed starting from 1).\n\nA. Scale vector $[5, 8, 4]$, first pivot row is 2.\nB. Scale vector $[2, 4, 3]$, first pivot row is 2.\nC. Scale vector $[5, 8, 4]$, first pivot row is 3.\nD. Scale vector $[8, 14, 8]$, first pivot row is 3.\nE. Scale vector $[5, 8, 4]$, first pivot row is 1.\n\n", "solution": "We use scaled partial pivoting. For each row $i$, the scale $s_{i}$ is defined by $s_{i}=\\max_{j}|a_{ij}|$. For the given matrix\n$$\nA=\\begin{pmatrix}\n2 & 1 & -5\\\\\n-4 & 8 & 2\\\\\n3 & -1 & 4\n\\end{pmatrix},\n$$\ncompute the rowwise maxima:\n- Row 1: $\\max(|2|,|1|,|{-5}|)=5$, so $s_{1}=5$.\n- Row 2: $\\max(|{-4}|,|8|,|2|)=8$, so $s_{2}=8$.\n- Row 3: $\\max(|3|,|{-1}|,|4|)=4$, so $s_{3}=4$.\n\nThus the initial scale vector (displayed as a row vector) is $[5,8,4]$.\n\nTo choose the first pivot row, compute the ratios $r_{i}=\\frac{|a_{i1}|}{s_{i}}$ for $i=1,2,3$:\n$$\nr_{1}=\\frac{|2|}{5}=\\frac{2}{5},\\quad\nr_{2}=\\frac{|{-4}|}{8}=\\frac{4}{8}=\\frac{1}{2},\\quad\nr_{3}=\\frac{|3|}{4}=\\frac{3}{4}.\n$$\nThe maximum ratio is $\\frac{3}{4}$, attained at row $3$. Therefore, the first pivot row index is $3$.\n\nComparing with the options, this corresponds to option C.", "answer": "$$\\boxed{C}$$"}, {"introduction": "Once the first pivot row is identified, the next step is to perform the elimination and record the transformation. This exercise connects the act of pivoting to the broader goal of $PA=LU$ factorization. You will apply the first pivot and subsequent elimination to determine the multipliers that form the first column of the lower triangular matrix $L$, providing a concrete look at how pivoting shapes the resulting factors. [@problem_id:2199861]", "id": "2199861", "problem": "Consider the matrix $A$ given by:\n$$A = \\begin{pmatrix} 2 & -4 & 1 \\\\ 6 & 2 & -2 \\\\ -1 & 3 & 5 \\end{pmatrix}$$\nWe seek to find the $PA=LU$ factorization of this matrix, which is obtained through Gaussian elimination with a scaled partial pivoting strategy. In this factorization, $P$ is a permutation matrix that accounts for row interchanges, $L$ is a unit lower triangular matrix (i.e., its diagonal entries are all 1), and $U$ is an upper triangular matrix.\n\nYour task is to perform the necessary computations for the first pivot and elimination step to determine the elements of the first column of the matrix $L$.\n\nExpress your answer as a row matrix containing the elements of the first column, $(l_{11}, l_{21}, l_{31})$, in that order.\n\n", "solution": "We perform scaled partial pivoting on the first column. For each row of $A$, compute the scaling factor $s_{i}$ as the maximum absolute value in that row:\n$$\ns_{1}=\\max\\{ |2|,|{-4}|,|1|\\}=4,\\quad\ns_{2}=\\max\\{ |6|,|2|,|{-2}|\\}=6,\\quad\ns_{3}=\\max\\{ |{-1}|,|3|,|5|\\}=5.\n$$\nCompute the ratios $r_{i}=\\frac{|a_{i1}|}{s_{i}}$ for the first column:\n$$\nr_{1}=\\frac{|2|}{4}=\\frac{1}{2},\\quad\nr_{2}=\\frac{|6|}{6}=1,\\quad\nr_{3}=\\frac{|{-1}|}{5}=\\frac{1}{5}.\n$$\nThe largest ratio is for row 2, so we pivot by swapping row 1 with row 2. The permuted matrix for this step is\n$$\nA^{(1)}=\\begin{pmatrix}\n6 & 2 & -2\\\\\n2 & -4 & 1\\\\\n-1 & 3 & 5\n\\end{pmatrix}.\n$$\nFor the first elimination step, the multipliers (which become the subdiagonal entries in the first column of $L$) are\n$$\nl_{11}=1,\\quad\nl_{21}=\\frac{a^{(1)}_{21}}{a^{(1)}_{11}}=\\frac{2}{6}=\\frac{1}{3},\\quad\nl_{31}=\\frac{a^{(1)}_{31}}{a^{(1)}_{11}}=\\frac{-1}{6}=-\\frac{1}{6}.\n$$\nThus, the first column of $L$ is $(1,\\frac{1}{3},-\\frac{1}{6})$.", "answer": "$$\\boxed{\\begin{pmatrix} 1 & \\frac{1}{3} & -\\frac{1}{6} \\end{pmatrix}}$$"}, {"introduction": "A deeper understanding of an algorithm comes from exploring its sensitivity and edge cases. This problem challenges you to think critically about how the initial state of the matrix influences the entire pivoting sequence. By analyzing how a change in a single element can alter the choice of the *second* pivot row, you will gain insight into the dynamic nature of scaled partial pivoting and the lasting impact of the initial scale vector calculation. [@problem_id:2199850]", "id": "2199850", "problem": "In applying Gaussian elimination to solve a linear system $A\\mathbf{x} = \\mathbf{b}$, a pivoting strategy is often employed to enhance numerical stability. One such strategy is scaled partial pivoting. In this method, before the $k$-th elimination step, we select a pivot row from the set of rows $\\{k, k+1, \\dots, n\\}$. The chosen pivot row, designated by index $p$, is the one that maximizes the ratio of the absolute value of the potential pivot element to a pre-computed scale factor for that row. Specifically, we find $p$ such that\n$$\n\\frac{|A_{pk}^{(k-1)}|}{s_p} = \\max_{i=k, \\dots, n} \\frac{|A_{ik}^{(k-1)}|}{s_i}\n$$\nwhere $A_{ij}^{(k-1)}$ denotes the matrix elements after the first $k-1$ elimination steps, and the scale factor $s_i$ for each row $i$ is determined only once from the original matrix $A^{(0)} = A$ as $s_i = \\max_{j=1, \\dots, n} |A_{ij}|$. In case of a tie in the maximal ratio, the row with the smallest index is selected as the pivot row.\n\nConsider the $3 \\times 3$ matrix $A$ defined as:\n$$\nA = \\begin{pmatrix}\n10 & 2 & -1 \\\\\n5 & 20 & 5 \\\\\n-2 & C & 8\n\\end{pmatrix}\n$$\nwhere $C$ is a real parameter. When performing Gaussian elimination with scaled partial pivoting on this matrix, it is known that for the case $C=18$, the second pivot row chosen (for the second elimination step) is row 3.\n\nDetermine the largest positive integer value of $C$ strictly less than 18 for which the second pivot row becomes row 2 instead.\n\n", "solution": "We apply scaled partial pivoting. The row scale factors, computed once from the original matrix $A$, are\n$$\ns_{1}=\\max\\{|10|,|2|,|{-1}|\\}=10,\\quad s_{2}=\\max\\{|5|,|20|,|5|\\}=20,\\quad s_{3}=\\max\\{|{-2}|,|C|,|8|\\}=\\max\\{8,|C|\\}.\n$$\nAt the first step ($k=1$), the selection ratios are\n$$\n\\frac{|A_{11}|}{s_{1}}=\\frac{10}{10}=1,\\quad \\frac{|A_{21}|}{s_{2}}=\\frac{5}{20}=\\frac{1}{4},\\quad \\frac{|A_{31}|}{s_{3}}=\\frac{2}{\\max\\{8,|C|\\}}\\leq \\frac{1}{4}.\n$$\nThus row $1$ is the pivot. Perform elimination with multipliers $m_{21}=A_{21}/A_{11}=1/2$ and $m_{31}=A_{31}/A_{11}=-1/5$. The updated entries in column $2$ after the first step are\n$$\nA_{22}^{(1)}=20-\\frac{1}{2}\\cdot 2=19,\\qquad A_{32}^{(1)}=C-\\left(-\\frac{1}{5}\\right)\\cdot 2=C+\\frac{2}{5}.\n$$\nFor the second step ($k=2$), the scaled ratios to select the pivot from rows $2$ and $3$ are\n$$\nr_{2}=\\frac{|A_{22}^{(1)}|}{s_{2}}=\\frac{19}{20},\\qquad r_{3}=\\frac{|A_{32}^{(1)}|}{s_{3}}=\\frac{C+\\frac{2}{5}}{\\max\\{8,|C|\\}}.\n$$\nUsing the tie-break rule (smaller index wins), row $2$ is selected if and only if $r_{2}\\geq r_{3}$. Consider two cases for $s_{3}$:\n\n1) If $C\\geq 8$, then $s_{3}=C$ and\n$$\nr_{3}=\\frac{C+\\frac{2}{5}}{C}=1+\\frac{2}{5C}>1>\\frac{19}{20}=r_{2},\n$$\nso row $3$ is selected.\n\n2) If $0<C<8$, then $s_{3}=8$ and the condition $r_{2}\\geq r_{3}$ becomes\n$$\n\\frac{19}{20}\\geq \\frac{C+\\frac{2}{5}}{8}\\quad\\Longleftrightarrow\\quad 19\\cdot 8\\geq 20\\left(C+\\frac{2}{5}\\right)\\quad\\Longleftrightarrow\\quad 152\\geq 20C+8\n$$\n$$\n\\Longleftrightarrow\\quad 144\\geq 20C\\quad\\Longleftrightarrow\\quad C\\leq \\frac{36}{5}=7.2.\n$$\nFor positive integers $C<18$, this yields $C\\in\\{1,2,3,4,5,6,7\\}$ for which the second pivot row is row $2$. Therefore, the largest positive integer $C$ strictly less than $18$ making the second pivot row equal to row $2$ is $7$.", "answer": "$$\\boxed{7}$$"}]}