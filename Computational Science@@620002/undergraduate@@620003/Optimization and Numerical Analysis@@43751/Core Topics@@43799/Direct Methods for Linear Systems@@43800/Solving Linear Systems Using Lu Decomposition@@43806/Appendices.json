{"hands_on_practices": [{"introduction": "The most effective way to grasp the LU decomposition method is by applying it from beginning to end. This exercise guides you through the complete workflow: first, you'll factor a matrix $A$ into its lower triangular ($L$) and upper triangular ($U$) components. Subsequently, you will use these factors to efficiently solve the linear system $A\\mathbf{x} = \\mathbf{b}$ through forward and backward substitution. Performing this process on a matrix that includes a parameter, as demonstrated in this problem [@problem_id:2204091], reinforces the algebraic mechanics of the algorithm, moving beyond simple numerical examples.", "problem": "In the analysis of a certain two-variable linear dynamical system, its steady-state behavior is described by the matrix equation $A\\mathbf{x} = \\mathbf{b}$. The system matrix $A$ and the input vector $\\mathbf{b}$ are dependent on a real parameter $\\gamma$, which represents a coupling strength. They are given by:\n$$A = \\begin{pmatrix} \\gamma & \\gamma \\\\ 1 & 2\\gamma \\end{pmatrix} \\quad \\text{and} \\quad \\mathbf{b} = \\begin{pmatrix} 2\\gamma \\\\ 3 \\end{pmatrix}$$\nYou are given that the parameter $\\gamma$ is positive ($\\gamma > 0$) and is not equal to $1/2$.\n\nYour task is to find the steady-state solution vector $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$. To do this, you must first find the Lower-Upper (LU) decomposition of the matrix $A$, in the form $A = LU$, where $L$ is a lower triangular matrix with ones on its main diagonal, and $U$ is an upper triangular matrix. Then, use this decomposition to solve for $\\mathbf{x}$. Express your final answer for $\\mathbf{x}$ in terms of $\\gamma$.", "solution": "We seek an LU decomposition of $A$ with $L$ unit lower triangular and $U$ upper triangular, and then solve $A\\mathbf{x}=\\mathbf{b}$ via forward and backward substitution. Since $\\gamma>0$, we have $\\gamma\\neq 0$, and the given $\\gamma\\neq \\frac{1}{2}$ ensures $\\det(A)=\\gamma(2\\gamma-1)\\neq 0$.\n\nAssume\n$$\nL=\\begin{pmatrix}1&0\\\\ \\ell&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}&u_{12}\\\\ 0&u_{22}\\end{pmatrix},\n$$\nso that $A=LU$ implies\n$$\n\\begin{pmatrix}\\gamma&\\gamma\\\\ 1&2\\gamma\\end{pmatrix}\n=\n\\begin{pmatrix}1&0\\\\ \\ell&1\\end{pmatrix}\n\\begin{pmatrix}u_{11}&u_{12}\\\\ 0&u_{22}\\end{pmatrix}\n=\n\\begin{pmatrix}u_{11}&u_{12}\\\\ \\ell u_{11}&\\ell u_{12}+u_{22}\\end{pmatrix}.\n$$\nEquating entries gives\n$$\nu_{11}=\\gamma,\\quad u_{12}=\\gamma,\\quad \\ell u_{11}=1,\\quad \\ell u_{12}+u_{22}=2\\gamma.\n$$\nFrom $\\ell u_{11}=1$ we get $\\ell=\\frac{1}{\\gamma}$. Then\n$$\nu_{22}=2\\gamma-\\ell u_{12}=2\\gamma-\\frac{1}{\\gamma}\\,\\gamma=2\\gamma-1.\n$$\nThus\n$$\nL=\\begin{pmatrix}1&0\\\\ \\frac{1}{\\gamma}&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}\\gamma&\\gamma\\\\ 0&2\\gamma-1\\end{pmatrix}.\n$$\n\nTo solve $A\\mathbf{x}=\\mathbf{b}$, write $LU\\mathbf{x}=\\mathbf{b}$ and first solve $L\\mathbf{y}=\\mathbf{b}$ for $\\mathbf{y}$, then $U\\mathbf{x}=\\mathbf{y}$. With $\\mathbf{b}=\\begin{pmatrix}2\\gamma\\\\ 3\\end{pmatrix}$, the system $L\\mathbf{y}=\\mathbf{b}$ is\n$$\n\\begin{pmatrix}1&0\\\\ \\frac{1}{\\gamma}&1\\end{pmatrix}\n\\begin{pmatrix}y_{1}\\\\ y_{2}\\end{pmatrix}\n=\n\\begin{pmatrix}2\\gamma\\\\ 3\\end{pmatrix}.\n$$\nFrom the first row, $y_{1}=2\\gamma$. From the second row, $\\frac{1}{\\gamma}y_{1}+y_{2}=3$, hence\n$$\ny_{2}=3-\\frac{1}{\\gamma}(2\\gamma)=3-2=1,\n$$\nso $\\mathbf{y}=\\begin{pmatrix}2\\gamma\\\\ 1\\end{pmatrix}$.\n\nNow solve $U\\mathbf{x}=\\mathbf{y}$:\n$$\n\\begin{pmatrix}\\gamma&\\gamma\\\\ 0&2\\gamma-1\\end{pmatrix}\n\\begin{pmatrix}x_{1}\\\\ x_{2}\\end{pmatrix}\n=\n\\begin{pmatrix}2\\gamma\\\\ 1\\end{pmatrix}.\n$$\nFrom the second row, $(2\\gamma-1)x_{2}=1$, so\n$$\nx_{2}=\\frac{1}{2\\gamma-1}.\n$$\nFrom the first row, $\\gamma(x_{1}+x_{2})=2\\gamma$, hence $x_{1}+x_{2}=2$, so\n$$\nx_{1}=2-\\frac{1}{2\\gamma-1}=\\frac{4\\gamma-3}{2\\gamma-1}.\n$$\n\nTherefore, the steady-state solution vector is\n$$\n\\mathbf{x}=\\begin{pmatrix}\\frac{4\\gamma-3}{2\\gamma-1}\\\\ \\frac{1}{2\\gamma-1}\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{4\\gamma-3}{2\\gamma-1}\\\\ \\frac{1}{2\\gamma-1}\\end{pmatrix}}$$", "id": "2204091"}, {"introduction": "The standard Gaussian elimination procedure, which forms the basis of LU decomposition, can encounter a significant obstacle: a zero pivot, which brings the algorithm to a halt. This practice [@problem_id:2204103] introduces the crucial technique of partial pivoting, a standard remedy where matrix rows are strategically swapped to avoid zero pivots and enhance numerical stability. Mastering the use of a permutation matrix $P$ to reorder the system into the form $PA = LU$ is fundamental to developing robust and reliable numerical solvers.", "problem": "In numerical linear algebra, solving systems of equations $Ax=b$ is often accomplished by first factoring the matrix $A$. However, for some matrices, a direct LU factorization is not possible due to zero pivots appearing during Gaussian elimination. This issue is resolved by permuting the rows of the matrix, which is equivalent to left-multiplying by a permutation matrix $P$. One can then perform an LU decomposition on the permuted matrix, $PA=LU$. This is known as LU factorization with partial pivoting.\n\nConsider the matrix $A$ and the permutation matrix $P$ given below:\n$$A = \\begin{pmatrix} 2 & 1 & 5 \\\\ 4 & 2 & -1 \\\\ -6 & 1 & 0 \\end{pmatrix}, \\quad P = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}$$\n\nPerform a Doolittle LU decomposition on the matrix product $PA$, such that $PA = LU$. In a Doolittle decomposition, the matrix $L$ is a lower triangular matrix with ones on its main diagonal, and $U$ is an upper triangular matrix.\n\nYour task is to find the matrix sum $L+U$.", "solution": "First compute the permuted matrix $PA$ by left-multiplying $A$ by $P$, which swaps the second and third rows of $A$:\n$$\nPA=\\begin{pmatrix} 2 & 1 & 5 \\\\ -6 & 1 & 0 \\\\ 4 & 2 & -1 \\end{pmatrix}.\n$$\nPerform a Doolittle LU decomposition $PA=LU$ with $L$ unit lower triangular and $U$ upper triangular.\n\nUse Gaussian elimination on $PA$ to determine the multipliers and the entries of $U$:\n- Pivot at $(1,1)$: $u_{11}=2$, and set\n$$\n\\ell_{21}=\\frac{-6}{2}=-3,\\quad \\ell_{31}=\\frac{4}{2}=2.\n$$\nEliminate below the first pivot:\n$$\n\\text{Row }2 \\leftarrow \\text{Row }2 - \\ell_{21}\\,\\text{Row }1 = \\begin{pmatrix} 0 & 4 & 15 \\end{pmatrix},\\quad\n\\text{Row }3 \\leftarrow \\text{Row }3 - \\ell_{31}\\,\\text{Row }1 = \\begin{pmatrix} 0 & 0 & -11 \\end{pmatrix}.\n$$\nThus the first row of $U$ is $[2,1,5]$, and after the first elimination step, the submatrix is\n$$\n\\begin{pmatrix} 0 & 4 & 15 \\\\ 0 & 0 & -11 \\end{pmatrix}.\n$$\n- Pivot at $(2,2)$: $u_{22}=4$, and set\n$$\n\\ell_{32}=\\frac{0}{4}=0.\n$$\nEliminate below the second pivot:\n$$\n\\text{Row }3 \\leftarrow \\text{Row }3 - \\ell_{32}\\,\\text{Row }2 = \\begin{pmatrix} 0 & 0 & -11 \\end{pmatrix},\n$$\nso $u_{23}=15$ and $u_{33}=-11$.\n\nTherefore,\n$$\nL=\\begin{pmatrix} 1 & 0 & 0 \\\\ -3 & 1 & 0 \\\\ 2 & 0 & 1 \\end{pmatrix},\\quad\nU=\\begin{pmatrix} 2 & 1 & 5 \\\\ 0 & 4 & 15 \\\\ 0 & 0 & -11 \\end{pmatrix}.\n$$\nCompute the matrix sum $L+U$:\n$$\nL+U=\\begin{pmatrix} 1+2 & 0+1 & 0+5 \\\\ -3+0 & 1+4 & 0+15 \\\\ 2+0 & 0+0 & 1+(-11) \\end{pmatrix}\n=\\begin{pmatrix} 3 & 1 & 5 \\\\ -3 & 5 & 15 \\\\ 2 & 0 & -10 \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 1 & 5 \\\\ -3 & 5 & 15 \\\\ 2 & 0 & -10 \\end{pmatrix}}$$", "id": "2204103"}, {"introduction": "A primary advantage of LU decomposition lies in its efficiency: once the factors $L$ and $U$ are computed, they can be reused to solve any system involving the matrix $A$ with remarkable speed. This problem [@problem_id:2204064] showcases this power by tasking you with solving a more complex equation, $A^2\\mathbf{x} = \\mathbf{b}$. Rather than undertaking the computationally intensive task of squaring the matrix $A$, you will discover how to leverage the LU factors to find the solution through two consecutive and fast substitution steps, highlighting the method's elegance and computational economy.", "problem": "In a computational model of a mechanical system, the steady-state displacement vector, $\\mathbf{x}$, is determined by solving a matrix equation of the form $A^2\\mathbf{x} = \\mathbf{b}$. Instead of performing a costly matrix multiplication to find $A^2$, an efficient solution can be found by leveraging the LU decomposition of the matrix $A$.\n\nYou are given the LU decomposition of a $3 \\times 3$ matrix $A$, such that $A=LU$. The matrix $L$ is a unit lower triangular matrix, and $U$ is an upper triangular matrix. The specific matrices and the vector $\\mathbf{b}$ are:\n\n$L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2 & 1 & -1 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}$, and $\\mathbf{b} = \\begin{pmatrix} -3 \\\\ -45 \\\\ -90 \\end{pmatrix}$\n\nYour task is to find the solution vector $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$.\n\nExpress your final answer as a row matrix of the form $\\begin{pmatrix} x_1 & x_2 & x_3 \\end{pmatrix}$.", "solution": "We need to solve $A^{2}\\mathbf{x}=\\mathbf{b}$ with $A=LU$. Introduce the auxiliary vector $\\mathbf{y}$ defined by $\\mathbf{y}=A\\mathbf{x}$. Then $A\\mathbf{y}=\\mathbf{b}$. Thus we can solve two consecutive linear systems with the same coefficient matrix $A$ using its LU decomposition:\n1) Solve $A\\mathbf{y}=\\mathbf{b}$.\n2) Solve $A\\mathbf{x}=\\mathbf{y}$.\n\nSince $A=LU$, each solve $A\\mathbf{w}=\\mathbf{r}$ is performed by first solving $L\\mathbf{z}=\\mathbf{r}$ (forward substitution) and then $U\\mathbf{w}=\\mathbf{z}$ (back substitution).\n\nFirst solve $A\\mathbf{y}=\\mathbf{b}$ with $L=\\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}$, $U=\\begin{pmatrix} 2 & 1 & -1 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}$, and $\\mathbf{b}=\\begin{pmatrix} -3 \\\\ -45 \\\\ -90 \\end{pmatrix}$.\n\nForward substitution for $L\\mathbf{z}=\\mathbf{b}$:\n$$\n\\begin{cases}\nz_{1}=-3,\\\\\n2z_{1}+z_{2}=-45 \\;\\Rightarrow\\; z_{2}=-39,\\\\\n-z_{1}+3z_{2}+z_{3}=-90 \\;\\Rightarrow\\; z_{3}=24,\n\\end{cases}\n$$\nso $\\mathbf{z}=\\begin{pmatrix}-3\\\\-39\\\\24\\end{pmatrix}$.\n\nBack substitution for $U\\mathbf{y}=\\mathbf{z}$:\n$$\n\\begin{cases}\n-2y_{3}=24 \\;\\Rightarrow\\; y_{3}=-12,\\\\\n3y_{2}+y_{3}=-39 \\;\\Rightarrow\\; y_{2}=-9,\\\\\n2y_{1}+y_{2}-y_{3}=-3 \\;\\Rightarrow\\; y_{1}=-3,\n\\end{cases}\n$$\nso $\\mathbf{y}=\\begin{pmatrix}-3\\\\-9\\\\-12\\end{pmatrix}$.\n\nNext solve $A\\mathbf{x}=\\mathbf{y}$.\n\nForward substitution for $L\\mathbf{t}=\\mathbf{y}$:\n$$\n\\begin{cases}\nt_{1}=-3,\\\\\n2t_{1}+t_{2}=-9 \\;\\Rightarrow\\; t_{2}=-3,\\\\\n-t_{1}+3t_{2}+t_{3}=-12 \\;\\Rightarrow\\; t_{3}=-6,\n\\end{cases}\n$$\nso $\\mathbf{t}=\\begin{pmatrix}-3\\\\-3\\\\-6\\end{pmatrix}$.\n\nBack substitution for $U\\mathbf{x}=\\mathbf{t}$:\n$$\n\\begin{cases}\n-2x_{3}=-6 \\;\\Rightarrow\\; x_{3}=3,\\\\\n3x_{2}+x_{3}=-3 \\;\\Rightarrow\\; x_{2}=-2,\\\\\n2x_{1}+x_{2}-x_{3}=-3 \\;\\Rightarrow\\; x_{1}=1,\n\\end{cases}\n$$\nso $\\mathbf{x}=\\begin{pmatrix}1\\\\-2\\\\3\\end{pmatrix}$.\n\nTherefore, the requested row matrix is $\\begin{pmatrix}1 & -2 & 3\\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} 1 & -2 & 3 \\end{pmatrix}}$$", "id": "2204064"}]}