{"hands_on_practices": [{"introduction": "While fitting a line to a set of 2D points is a cornerstone of data analysis, many scientific and engineering problems involve relationships with multiple independent variables. This practice extends the familiar least squares method into three dimensions. You will determine the best-fit plane for a set of data points, a common task in fields like material science and geodesy. This exercise [@problem_id:2212243] builds a strong foundation in multivariate regression by applying the core principle of minimizing the sum of squared vertical errors in a more general context.", "problem": "A quality control engineer is inspecting a newly manufactured rectangular plate that is intended to be perfectly flat. To assess its flatness, the engineer uses a coordinate measuring machine to record the height, $z$, at several points on the plate's surface, corresponding to coordinates $(x, y)$. The engineer's model for the plate's surface is a plane defined by the equation $z = ax + by + c$, where $a$ and $b$ represent the tilts in the $x$ and $y$ directions, respectively, and $c$ is the height at the origin $(0, 0)$.\n\nThe following four measurements are taken, with all coordinates given in dimensionless units:\n- Point 1: $(x_1, y_1, z_1) = (0, 0, 1)$\n- Point 2: $(x_2, y_2, z_2) = (1, 0, 3)$\n- Point 3: $(x_3, y_3, z_3) = (0, 2, 2)$\n- Point 4: $(x_4, y_4, z_4) = (1, 2, 5)$\n\nAssuming the \"best-fit\" plane is the one that minimizes the sum of the squared vertical distances between the measured points and the plane, determine the optimal values for the parameters $a$, $b$, and $c$.\n\nPresent your final answer for the parameters $(a, b, c)$ as a row matrix.", "solution": "We model the surface as $z=ax+by+c$ and seek the least-squares estimates of $(a,b,c)$ by minimizing the sum of squared residuals $S(a,b,c)=\\sum_{i=1}^{4}\\left(ax_{i}+by_{i}+c-z_{i}\\right)^{2}$. Setting the gradient of $S$ with respect to $(a,b,c)$ to zero yields the normal equations\n$$\nX^{T}X\\,\\theta=X^{T}z,\n$$\nwhere $X$ has rows $[x_{i}\\;y_{i}\\;1]$, $z$ is the vector of measured heights, and $\\theta=\\begin{pmatrix}a\\\\ b\\\\ c\\end{pmatrix}$. From the data,\n$$\nX=\\begin{pmatrix}\n0 & 0 & 1\\\\\n1 & 0 & 1\\\\\n0 & 2 & 1\\\\\n1 & 2 & 1\n\\end{pmatrix},\\quad\nz=\\begin{pmatrix}\n1\\\\\n3\\\\\n2\\\\\n5\n\\end{pmatrix}.\n$$\nCompute\n$$\nX^{T}X=\\begin{pmatrix}\n\\sum x_{i}^{2} & \\sum x_{i}y_{i} & \\sum x_{i}\\\\\n\\sum x_{i}y_{i} & \\sum y_{i}^{2} & \\sum y_{i}\\\\\n\\sum x_{i} & \\sum y_{i} & 4\n\\end{pmatrix}\n=\\begin{pmatrix}\n2 & 2 & 2\\\\\n2 & 8 & 4\\\\\n2 & 4 & 4\n\\end{pmatrix},\n$$\nand\n$$\nX^{T}z=\\begin{pmatrix}\n\\sum x_{i}z_{i}\\\\\n\\sum y_{i}z_{i}\\\\\n\\sum z_{i}\n\\end{pmatrix}\n=\\begin{pmatrix}\n8\\\\\n14\\\\\n11\n\\end{pmatrix}.\n$$\nThus we solve\n$$\n\\begin{pmatrix}\n2 & 2 & 2\\\\\n2 & 8 & 4\\\\\n2 & 4 & 4\n\\end{pmatrix}\n\\begin{pmatrix}\na\\\\\nb\\\\\nc\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n8\\\\\n14\\\\\n11\n\\end{pmatrix}.\n$$\nDividing each equation by $2$ gives\n$$\n\\begin{cases}\na+b+c=4,\\\\\na+4b+2c=7,\\\\\na+2b+2c=\\frac{11}{2}.\n\\end{cases}\n$$\nSubtracting the first from the second yields $3b+c=3$, and subtracting the first from the third yields $b+c=\\frac{3}{2}$. Subtracting these two equations gives $2b=\\frac{3}{2}$, hence $b=\\frac{3}{4}$. Substituting into $b+c=\\frac{3}{2}$ gives $c=\\frac{3}{4}$. Finally, from $a+b+c=4$ we get $a=4-\\frac{3}{4}-\\frac{3}{4}=\\frac{5}{2}$. Therefore, the least-squares best-fit parameters are $(a,b,c)=\\left(\\frac{5}{2},\\frac{3}{4},\\frac{3}{4}\\right)$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2} & \\frac{3}{4} & \\frac{3}{4}\\end{pmatrix}}$$", "id": "2212243"}, {"introduction": "The standard least squares method tacitly assumes that all measurement error resides in the dependent variable. But what if our measurements of the independent variable are also uncertain? This practice explores an alternative and often more realistic approach called Total Least Squares (TLS). Instead of minimizing vertical distances to the fitted line, you will minimize the perpendicular distances, thereby accounting for errors in both variables. This problem [@problem_id:2212231] challenges you to think critically about the nature of error and select a fitting technique that best reflects the underlying experimental reality.", "problem": "A physics undergraduate is studying the motion of a small bead on a nearly frictionless, straight wire. A theoretical model predicts a linear relationship between the bead's position, $p$, and an experimental control parameter, time $t$, given by the equation $p = mt + c$. To test this theory and determine the constants $m$ and $c$, the student collects a series of data points. However, due to inherent limitations in the measurement apparatus, both the position readings and the time measurements are subject to random experimental errors.\n\nThe student decides to find the \"best-fit\" line by employing a method that accounts for errors in both variables. This method defines the best-fit line as the one that minimizes the sum of the squared *perpendicular* distances from each data point to the line.\n\nThe collected experimental data, consisting of four $(t, p)$ pairs, is as follows:\n(2 s, 3 m), (4 s, 8 m), (7 s, 10 m), (9 s, 15 m).\n\nUsing this data, calculate the slope $m$ and the intercept $c$ of the best-fit line defined by minimizing the sum of squared perpendicular distances. Report your answer for the slope in units of m/s and for the intercept in units of m. Round your final answers to four significant figures.", "solution": "We model the data by the line $p = mt + c$ and define the sum of squared perpendicular distances to be minimized as\n$$\nF(m,c) = \\sum_{i=1}^{n} \\frac{(m t_{i} - p_{i} + c)^{2}}{m^{2} + 1}.\n$$\nSetting $\\frac{\\partial F}{\\partial c}=0$ gives\n$$\n\\frac{2}{m^{2}+1}\\sum_{i=1}^{n}\\left(m t_{i} - p_{i} + c\\right)=0 \\quad\\Longrightarrow\\quad c=\\bar{p}-m\\bar{t},\n$$\nwhere $\\bar{t}$ and $\\bar{p}$ are the sample means. Define centered variables $t_{i}'=t_{i}-\\bar{t}$ and $p_{i}'=p_{i}-\\bar{p}$. Substituting $c=\\bar{p}-m\\bar{t}$ yields\n$$\nF(m)=\\frac{1}{m^{2}+1}\\sum_{i=1}^{n}\\left(m t_{i}' - p_{i}'\\right)^{2}\n=\\frac{m^{2} S_{tt} - 2 m S_{tp} + S_{pp}}{m^{2}+1},\n$$\nwhere $S_{tt}=\\sum (t_{i}')^{2}$, $S_{pp}=\\sum (p_{i}')^{2}$, and $S_{tp}=\\sum t_{i}'p_{i}'$. Differentiating with respect to $m$ and setting to zero gives the total least squares condition\n$$\nS_{tp} m^{2} + (S_{tt} - S_{pp}) m - S_{tp} = 0,\n$$\nequivalently\n$$\nS_{tp}(m^{2}-1) + (S_{tt}-S_{pp}) m = 0.\n$$\nSolving this quadratic,\n$$\nm=\\frac{S_{pp}-S_{tt} \\pm \\sqrt{(S_{pp}-S_{tt})^{2}+4 S_{tp}^{2}}}{2 S_{tp}}.\n$$\nWe compute the sample means and sums for the data $(t,p) \\in \\{(2,3),(4,8),(7,10),(9,15)\\}$. With $n=4$,\n$$\n\\bar{t}=\\frac{2+4+7+9}{4}=\\frac{22}{4}=5.5,\\qquad \\bar{p}=\\frac{3+8+10+15}{4}=\\frac{36}{4}=9.\n$$\nThe centered values are $(t',p')\\in\\{(-3.5,-6),(-1.5,-1),(1.5,1),(3.5,6)\\}$, giving\n$$\nS_{tt}=(-3.5)^{2}+(-1.5)^{2}+(1.5)^{2}+(3.5)^{2}=29,\n$$\n$$\nS_{pp}=(-6)^{2}+(-1)^{2}+(1)^{2}+(6)^{2}=74,\n$$\n$$\nS_{tp}=(-3.5)(-6)+(-1.5)(-1)+(1.5)(1)+(3.5)(6)=45.\n$$\nThus\n$$\nm=\\frac{74-29 \\pm \\sqrt{(74-29)^{2}+4\\cdot 45^{2}}}{2\\cdot 45}\n=\\frac{45 \\pm 45\\sqrt{5}}{90}=\\frac{1\\pm \\sqrt{5}}{2}.\n$$\nThe data exhibit positive correlation, so we take the positive root,\n$$\nm=\\frac{1+\\sqrt{5}}{2}.\n$$\nThe intercept follows from $c=\\bar{p}-m\\bar{t}$:\n$$\nc=9-\\left(\\frac{1+\\sqrt{5}}{2}\\right)\\cdot 5.5\n=9-\\frac{11(1+\\sqrt{5})}{4}\n=\\frac{25-11\\sqrt{5}}{4}.\n$$\nNumerically, to four significant figures,\n$$\nm\\approx 1.618,\\qquad c\\approx 0.1008.\n$$\nThese correspond to units m/s for $m$ and m for $c$, as required.", "answer": "$$\\boxed{\\begin{pmatrix}1.618 & 0.1008\\end{pmatrix}}$$", "id": "2212231"}, {"introduction": "Real-world systems do not always follow a single, consistent pattern; sometimes their behavior changes abruptly. This practice introduces changepoint analysis, a powerful technique for modeling systems that exhibit such structural breaks. You will be tasked with finding the optimal point to split a dataset into two distinct linear regimes. This exercise [@problem_id:2212179] moves beyond fitting a single global model and introduces the concept of piecewise regression, where the challenge is to identify both the model parameters for each segment and the location of the change itself.", "problem": "An engineer is calibrating a novel pressure sensor. The sensor's output voltage is expected to vary linearly with the applied pressure. During a test, the pressure is increased in discrete steps, and the sensor's voltage output is recorded. The ordered data pairs $(x_i, y_i)$, where $x_i$ is the applied pressure in kilopascals (kPa) and $y_i$ is the output voltage in millivolts (mV), are as follows:\n\n(1, 2.1), (2, 2.9), (3, 3.8), (4, 2.1), (5, -0.1), (6, -1.8)\n\nThe engineer suspects that the sensor's response characteristic changed abruptly at some point during the test. To model this, they propose a changepoint model. The data is to be split into two contiguous segments at an integer index $k$. The first segment consists of data points $1$ through $k$, and the second segment consists of points $k+1$ through $6$. Each segment is then fitted with its own independent straight line, $y=mx+c$.\n\nThe \"best\" fit for each segment is defined as the line that minimizes the sum of squared vertical errors for the points within that segment. The overall quality of the changepoint model for a given $k$ is measured by the total Sum of Squared Errors (SSE), which is the sum of the SSEs from the two separate linear fits.\n\nTo ensure that each linear fit is well-defined, each segment must contain at least two data points. Therefore, the possible values for the changepoint index $k$ are $2, 3, \\text{and } 4$.\n\nDetermine the optimal integer value of the changepoint index $k$ that minimizes the total SSE.", "solution": "The sum of squared errors for an ordinary least squares fit of a straight line $y=mx+c$ to a segment with points $(x_{i},y_{i})$ for $i=1,\\dots,n$ can be expressed using\n$$\nS_{x}=\\sum x_{i},\\quad S_{y}=\\sum y_{i},\\quad \\sum x_{i}^{2},\\quad \\sum y_{i}^{2},\\quad \\sum x_{i}y_{i},\n$$\nand the centered sums\n$$\nS_{xx}=\\sum x_{i}^{2}-\\frac{S_{x}^{2}}{n},\\quad S_{yy}=\\sum y_{i}^{2}-\\frac{S_{y}^{2}}{n},\\quad S_{xy}=\\sum x_{i}y_{i}-\\frac{S_{x}S_{y}}{n}.\n$$\nThe slope is $m=\\frac{S_{xy}}{S_{xx}}$ and the segment SSE is\n$$\n\\mathrm{SSE}=S_{yy}-\\frac{S_{xy}^{2}}{S_{xx}}.\n$$\nFor two-point segments, the fitted line passes through both points, so the SSE equals $0$.\n\nCase $k=2$: Segment $1$ uses $(1,2.1),(2,2.9)$, so $\\mathrm{SSE}_{1}=0$. Segment $2$ uses $(3,3.8),(4,2.1),(5,-0.1),(6,-1.8)$ with $n=4$, $S_{x}=18$, $S_{y}=4.0$, $\\sum x_{i}^{2}=86$, $\\sum y_{i}^{2}=22.10$, $\\sum x_{i}y_{i}=8.5$. Hence\n$$\nS_{xx}=86-\\frac{18^{2}}{4}=5,\\quad S_{yy}=22.10-\\frac{4.0^{2}}{4}=18.10,\\quad S_{xy}=8.5-\\frac{18\\cdot 4.0}{4}=-9.5,\n$$\nso\n$$\n\\mathrm{SSE}_{2}=18.10-\\frac{(-9.5)^{2}}{5}=18.10-18.05=0.05.\n$$\nThus $\\mathrm{SSE}_{\\text{total}}(k=2)=0+0.05=0.05$.\n\nCase $k=3$: Segment $1$ uses $(1,2.1),(2,2.9),(3,3.8)$ with $n=3$, $S_{x}=6$, $S_{y}=8.8$, $\\sum x_{i}^{2}=14$, $\\sum y_{i}^{2}=27.26$, $\\sum x_{i}y_{i}=19.3$. Then\n$$\nS_{xx}=14-\\frac{6^{2}}{3}=2,\\quad S_{yy}=27.26-\\frac{8.8^{2}}{3}=\\frac{217}{150},\\quad S_{xy}=19.3-\\frac{6\\cdot 8.8}{3}=1.7,\n$$\nso\n$$\n\\mathrm{SSE}_{1}=\\frac{217}{150}-\\frac{(1.7)^{2}}{2}=\\frac{217}{150}-\\frac{289}{200}=\\frac{1}{600}.\n$$\nSegment $2$ uses $(4,2.1),(5,-0.1),(6,-1.8)$ with $n=3$, $S_{x}=15$, $S_{y}=0.2$, $\\sum x_{i}^{2}=77$, $\\sum y_{i}^{2}=7.66$, $\\sum x_{i}y_{i}=-2.9$. Then\n$$\nS_{xx}=77-\\frac{15^{2}}{3}=2,\\quad S_{yy}=7.66-\\frac{0.2^{2}}{3}=\\frac{1147}{150},\\quad S_{xy}=-2.9-\\frac{15\\cdot 0.2}{3}=-3.9,\n$$\nso\n$$\n\\mathrm{SSE}_{2}=\\frac{1147}{150}-\\frac{(-3.9)^{2}}{2}=\\frac{1147}{150}-\\frac{1521}{200}=\\frac{1}{24}.\n$$\nThus\n$$\n\\mathrm{SSE}_{\\text{total}}(k=3)=\\frac{1}{600}+\\frac{1}{24}=\\frac{26}{600}=\\frac{13}{300}\\approx 0.043333\\ldots.\n$$\n\nCase $k=4$: Segment $1$ uses $(1,2.1),(2,2.9),(3,3.8),(4,2.1)$ with $n=4$, $S_{x}=10$, $S_{y}=10.9$, $\\sum x_{i}^{2}=30$, $\\sum y_{i}^{2}=31.67$, $\\sum x_{i}y_{i}=27.7$. Then\n$$\nS_{xx}=30-\\frac{10^{2}}{4}=5,\\quad S_{yy}=31.67-\\frac{10.9^{2}}{4}=1.9675,\\quad S_{xy}=27.7-\\frac{10\\cdot 10.9}{4}=0.45,\n$$\nso\n$$\n\\mathrm{SSE}_{1}=1.9675-\\frac{(0.45)^{2}}{5}=1.9675-0.0405=1.927.\n$$\nSegment $2$ uses $(5,-0.1),(6,-1.8)$, so $\\mathrm{SSE}_{2}=0$. Thus $\\mathrm{SSE}_{\\text{total}}(k=4)=1.927$.\n\nComparing the totals, $\\mathrm{SSE}_{\\text{total}}(k=2)=0.05$, $\\mathrm{SSE}_{\\text{total}}(k=3)=\\frac{13}{300}\\approx 0.04333$, and $\\mathrm{SSE}_{\\text{total}}(k=4)=1.927$. The minimum is attained at $k=3$.", "answer": "$$\\boxed{3}$$", "id": "2212179"}]}