{"hands_on_practices": [{"introduction": "To truly understand how Runge-Kutta methods achieve their remarkable accuracy, we must first look under the hood. The classical fourth-order Runge-Kutta (RK4) method, a cornerstone of numerical analysis, works by calculating four distinct estimates of the slope across a single step. This exercise [@problem_id:2219964] invites you to compute these four stages—$k_1$, $k_2$, $k_3$, and $k_4$—by hand, providing a concrete feel for how the method samples the derivative to produce a highly accurate, weighted-average slope for advancing the solution.", "problem": "Consider the first-order ordinary differential equation (ODE) given by:\n$$\n\\frac{dy}{dt} = \\sin(t) - y^{2}\n$$\nwith the initial condition $y(0) = 0.5$.\n\nWe wish to approximate the solution using the classical fourth-order Runge-Kutta (RK4) method. The first step of this method involves calculating four intermediate slope values, or stages, denoted by $k_1$, $k_2$, $k_3$, and $k_4$. For an ODE of the form $\\frac{dy}{dt} = f(t, y)$, with a step size $h$ starting from a point $(t_n, y_n)$, these stages are defined as:\n\\begin{align*}\nk_1 &= f(t_n, y_n) \\\\\nk_2 &= f\\left(t_n + \\frac{h}{2}, y_n + h\\frac{k_1}{2}\\right) \\\\\nk_3 &= f\\left(t_n + \\frac{h}{2}, y_n + h\\frac{k_2}{2}\\right) \\\\\nk_4 &= f(t_n + h, y_n + h k_3)\n\\end{align*}\n\nCalculate the values of the four stages $k_1$, $k_2$, $k_3$, and $k_4$ for the single step starting from the given initial condition, using a step size of $h = 0.2$. Assume the argument of the sine function is in radians.\n\nGive your answers for $k_1$, $k_2$, $k_3$, and $k_4$ as a set of four numbers, in that order, with each number rounded to four significant figures.", "solution": "We have the ODE $y' = f(t,y) = \\sin(t) - y^{2}$ with $(t_{0},y_{0})=(0,0.5)$ and step size $h=0.2$. The RK4 stages are\n$$\nk_{1}=f(t_{0},y_{0}),\\quad\nk_{2}=f\\left(t_{0}+\\frac{h}{2},\\,y_{0}+\\frac{h}{2}k_{1}\\right),\\quad\nk_{3}=f\\left(t_{0}+\\frac{h}{2},\\,y_{0}+\\frac{h}{2}k_{2}\\right),\\quad\nk_{4}=f\\left(t_{0}+h,\\,y_{0}+h\\,k_{3}\\right).\n$$\nCompute each stage:\n1) $k_{1} = \\sin(0) - (0.5)^{2} = 0 - 0.25 = -0.25$.\n\n2) For $k_{2}$, use $t_{0}+\\frac{h}{2}=0.1$ and $y_{0}+\\frac{h}{2}k_{1}=0.5+\\frac{0.2}{2}(-0.25)=0.475$, hence\n$$\nk_{2}=\\sin(0.1) - (0.475)^{2} = 0.09983341664682815 - 0.225625 = -0.12579158335317182.\n$$\n\n3) For $k_{3}$, use $t_{0}+\\frac{h}{2}=0.1$ and $y_{0}+\\frac{h}{2}k_{2}=0.5+0.1(-0.12579158335317182)=0.4874208416646828$, hence\n$$\n(0.4874208416646828)^{2} \\approx 0.23757907690468282,\n$$\nso\n$$\nk_{3}=\\sin(0.1) - (0.4874208416646828)^{2} = 0.09983341664682815 - 0.23757907690468282 = -0.13774566025785467.\n$$\n\n4) For $k_{4}$, use $t_{0}+h=0.2$ and $y_{0}+h\\,k_{3}=0.5+0.2(-0.13774566025785467)=0.47245086794842906$, hence\n$$\n(0.47245086794842906)^{2} \\approx 0.22321002262447222,\\quad \\sin(0.2)=0.19866933079506122,\n$$\nso\n$$\nk_{4}=\\sin(0.2) - (0.47245086794842906)^{2} = 0.19866933079506122 - 0.22321002262447222 = -0.02454069182941100.\n$$\n\nRounding to four significant figures:\n$$\nk_{1}=-0.2500,\\quad k_{2}=-0.1258,\\quad k_{3}=-0.1377,\\quad k_{4}=-0.02454.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-0.2500 & -0.1258 & -0.1377 & -0.02454\\end{pmatrix}}$$", "id": "2219964"}, {"introduction": "While higher-order methods like RK4 are powerful, their complexity can obscure the fundamental benefit they provide. This practice [@problem_id:2220001] strips things back to basics by comparing the simplest numerical integrator, the Forward Euler method (an RK1 method), against the Improved Euler method (an RK2 method). By directly calculating and comparing their results for a single step, you will gain an intuitive understanding of what 'higher order' means in practice: a significant leap in accuracy for a modest increase in computational effort.", "problem": "Consider the first-order Ordinary Differential Equation (ODE) initial value problem given by:\n$$ \\frac{dy}{dt} = f(t, y) = y - t^2, \\quad y(0) = 1 $$\nWe wish to approximate the value of the solution $y(t)$ at $t=0.2$. Two common numerical methods for this task are the Forward Euler method and the Improved Euler method (also known as Heun's method).\n\nUsing a single step of size $h = 0.2$ for both methods, calculate the absolute difference between the approximation of $y(0.2)$ obtained from the Forward Euler method and the approximation obtained from the Improved Euler method.\n\nRound your final answer to four significant figures.", "solution": "We are given the initial value problem $y^{\\prime}(t)=f(t,y)=y-t^{2}$ with $y(0)=1$, and we want a single-step approximation to $y(0.2)$ with step size $h=0.2$ using the Forward Euler and Improved Euler (Heun) methods, then compute the absolute difference between the two approximations.\n\nFor the Forward Euler method, the update formula is\n$$\ny_{n+1}=y_{n}+h\\,f(t_{n},y_{n}).\n$$\nWith $t_{0}=0$, $y_{0}=1$, and $h=0.2$, we have\n$$\nf(t_{0},y_{0})=f(0,1)=1-0^{2}=1,\n$$\nso\n$$\ny_{1}^{\\text{FE}}=1+0.2\\cdot 1=1.2.\n$$\n\nFor the Improved Euler (Heun) method, we first compute the predictor\n$$\ny^{p}=y_{0}+h\\,f(t_{0},y_{0})=1+0.2\\cdot 1=1.2,\n$$\nand set $t_{1}=t_{0}+h=0.2$. Then we evaluate\n$$\nf(t_{1},y^{p})=f(0.2,1.2)=1.2-(0.2)^{2}=1.16.\n$$\nThe corrected value is\n$$\ny_{1}^{\\text{IE}}=y_{0}+\\frac{h}{2}\\left[f(t_{0},y_{0})+f(t_{1},y^{p})\\right]\n=1+\\frac{0.2}{2}\\left[1+1.16\\right]\n=1+0.1\\cdot 2.16\n=1.216.\n$$\n\nThe absolute difference between the two approximations is\n$$\n\\left|y_{1}^{\\text{FE}}-y_{1}^{\\text{IE}}\\right|=\\left|1.2-1.216\\right|=0.016.\n$$\nRounding to four significant figures gives $1.600 \\times 10^{-2}$.", "answer": "$$\\boxed{1.600 \\times 10^{-2}}$$", "id": "2220001"}, {"introduction": "Beyond just minimizing local error, a crucial test for a numerical method is its ability to conserve the physical quantities of the system it models. This exercise [@problem_id:2219992] delves into this concept using the simple harmonic oscillator, a fundamental system in physics where total energy should remain constant. You will analytically prove that the simple Forward Euler method fails this test, systematically adding energy to the system with every step, a critical insight that underscores why the choice of integrator is not just a matter of accuracy, but of physical fidelity.", "problem": "Consider a simple harmonic oscillator, whose motion is described by the system of first-order ordinary differential equations:\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -x\n$$\nwhere $x$ is the position and $v$ is the velocity of the oscillator. The total mechanical energy of the system is defined as $E = \\frac{1}{2}(x^2 + v^2)$.\n\nSuppose the system is at an initial state $(x_0, v_0)$ at time $t=0$, with an initial energy $E_0$. We wish to approximate the state of the system at a later time $t=h$ using a single step of the Forward Euler method. The Forward Euler method for a system $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$ advances the solution from $\\mathbf{y}_n$ to $\\mathbf{y}_{n+1}$ using the formula $\\mathbf{y}_{n+1} = \\mathbf{y}_n + h \\cdot \\mathbf{f}(t_n, \\mathbf{y}_n)$, where $h$ is the time step size, and we assume $h > 0$.\n\nLet the new state be $(x_1, v_1)$ and the corresponding energy be $E_1$. Determine the ratio $\\frac{E_1}{E_0}$, assuming the initial state is not the origin (i.e., $E_0 \\neq 0$). Your answer should be an expression solely in terms of the step size $h$.", "solution": "We write the system in vector form as $\\mathbf{y} = \\begin{pmatrix} x \\\\ v \\end{pmatrix}$ with $\\mathbf{f}(\\mathbf{y}) = \\begin{pmatrix} v \\\\ -x \\end{pmatrix}$. A single Forward Euler step with step size $h$ from $(x_{0}, v_{0})$ gives\n$$\nx_{1} = x_{0} + h v_{0}, \\quad v_{1} = v_{0} + h(-x_{0}) = v_{0} - h x_{0}.\n$$\nThe energy at step $n$ is defined as $E_{n} = \\frac{1}{2}(x_{n}^{2} + v_{n}^{2})$. Thus,\n$$\nE_{1} = \\frac{1}{2}\\left(x_{1}^{2} + v_{1}^{2}\\right) = \\frac{1}{2}\\left((x_{0} + h v_{0})^{2} + (v_{0} - h x_{0})^{2}\\right).\n$$\nExpanding each square and summing,\n$$\n(x_{0} + h v_{0})^{2} = x_{0}^{2} + 2 h x_{0} v_{0} + h^{2} v_{0}^{2}, \\quad (v_{0} - h x_{0})^{2} = v_{0}^{2} - 2 h x_{0} v_{0} + h^{2} x_{0}^{2},\n$$\nso\n$$\nx_{1}^{2} + v_{1}^{2} = x_{0}^{2} + v_{0}^{2} + h^{2}(x_{0}^{2} + v_{0}^{2}).\n$$\nTherefore,\n$$\nE_{1} = \\frac{1}{2}(1 + h^{2})(x_{0}^{2} + v_{0}^{2}) = (1 + h^{2}) E_{0}.\n$$\nSince $E_{0} \\neq 0$, the ratio is\n$$\n\\frac{E_{1}}{E_{0}} = 1 + h^{2}.\n$$", "answer": "$$\\boxed{1 + h^{2}}$$", "id": "2219992"}]}