{"hands_on_practices": [{"introduction": "The best way to understand the Fourth-order Runge-Kutta method is to apply it directly. This first practice focuses on the fundamental mechanics of the RK4 algorithm by having you compute a single step for a given first-order initial value problem. Mastering this core procedure, which involves calculating four intermediate slopes to find a weighted average, is the essential first building block for solving more complex differential equations [@problem_id:2174154].", "problem": "Consider the first-order ordinary differential equation given by the initial value problem (IVP):\n$$\n\\frac{dy}{dt} = t - y^2, \\quad \\text{with } y(0) = 1\n$$\nYou are asked to approximate the value of $y(0.2)$ by performing a single step of the fourth-order Runge-Kutta (RK4) method.\n\nThe formulas for a single step of the RK4 method to find $y_{n+1} \\approx y(t_n + h)$ from $y_n = y(t_n)$ are given by:\n$$\ny_{n+1} = y_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\nwhere $h$ is the step size, and the coefficients are:\n\\begin{align*}\nk_1 &= f(t_n, y_n) \\\\\nk_2 &= f\\left(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1\\right) \\\\\nk_3 &= f\\left(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2\\right) \\\\\nk_4 &= f(t_n + h, y_n + h k_3)\n\\end{align*}\nHere, $f(t,y)$ is the function on the right-hand side of the differential equation $\\frac{dy}{dt} = f(t,y)$.\n\nUse a step size of $h=0.2$ to compute the approximation for $y(0.2)$. Round your final answer to four significant figures.", "solution": "We are given the initial value problem $\\frac{dy}{dt} = t - y^2$ with the initial condition $y(0) = 1$. We want to find the approximate value of $y(0.2)$ using one step of the fourth-order Runge-Kutta (RK4) method.\n\nThe given parameters for the first step ($n=0$) are:\n- The function $f(t, y) = t - y^2$.\n- The initial time $t_0 = 0$.\n- The initial value $y_0 = 1$.\n- The step size $h = 0.2$.\n\nWe need to calculate the four RK4 coefficients, $k_1, k_2, k_3,$ and $k_4$.\n\nStep 1: Calculate $k_1$.\n$$\nk_1 = f(t_0, y_0) = f(0, 1) = 0 - 1^2 = -1\n$$\n\nStep 2: Calculate $k_2$.\nThe intermediate values for time and $y$ are:\n$t_0 + \\frac{h}{2} = 0 + \\frac{0.2}{2} = 0.1$\n$y_0 + \\frac{h}{2}k_1 = 1 + \\frac{0.2}{2}(-1) = 1 - 0.1 = 0.9$\nNow, we evaluate $f$ at these intermediate values:\n$$\nk_2 = f(0.1, 0.9) = 0.1 - (0.9)^2 = 0.1 - 0.81 = -0.71\n$$\n\nStep 3: Calculate $k_3$.\nThe intermediate values for time and $y$ are:\n$t_0 + \\frac{h}{2} = 0.1$\n$y_0 + \\frac{h}{2}k_2 = 1 + \\frac{0.2}{2}(-0.71) = 1 - 0.071 = 0.929$\nNow, we evaluate $f$ at these new intermediate values:\n$$\nk_3 = f(0.1, 0.929) = 0.1 - (0.929)^2 = 0.1 - 0.863041 = -0.763041\n$$\n\nStep 4: Calculate $k_4$.\nThe values for time and $y$ at the end of the interval are:\n$t_0 + h = 0 + 0.2 = 0.2$\n$y_0 + h k_3 = 1 + 0.2(-0.763041) = 1 - 0.1526082 = 0.8473918$\nNow, we evaluate $f$ at these values:\n$$\nk_4 = f(0.2, 0.8473918) = 0.2 - (0.8473918)^2 = 0.2 - 0.71807299 \\approx -0.518073\n$$\n\nStep 5: Calculate the next value $y_1 \\approx y(0.2)$.\nWe use the main RK4 formula:\n$$\ny_1 = y_0 + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\nSubstitute the values we have calculated:\n$$\ny_1 = 1 + \\frac{0.2}{6} \\left( (-1) + 2(-0.71) + 2(-0.763041) + (-0.518073) \\right)\n$$\n$$\ny_1 = 1 + \\frac{0.2}{6} \\left( -1 - 1.42 - 1.526082 - 0.518073 \\right)\n$$\n$$\ny_1 = 1 + \\frac{0.2}{6} (-4.464155)\n$$\n$$\ny_1 = 1 + \\frac{-0.892831}{6}\n$$\n$$\ny_1 = 1 - 0.14880517 \\approx 0.85119483\n$$\n\nThe problem asks to round the final answer to four significant figures.\nThe first four significant figures are 8, 5, 1, and 1. The fifth significant figure is 9, so we round up the fourth digit.\n$$\ny(0.2) \\approx 0.8512\n$$", "answer": "$$\\boxed{0.8512}$$", "id": "2174154"}, {"introduction": "Real-world dynamic systems, from planetary orbits to vibrating springs, are often described by second-order differential equations. This exercise demonstrates the crucial technique of transforming a second-order ODE into a system of two first-order equations, a standard practice that makes the problem solvable with RK4. By tackling the classic simple harmonic oscillator, you'll learn how to apply the RK4 method to a vector of state variables, a technique essential for modeling complex physical systems [@problem_id:2174142].", "problem": "A payload of mass $m$ is attached to an ideal horizontal spring with spring constant $k$. The payload is free to slide on a frictionless surface. The motion of this simple harmonic oscillator is described by the second-order Ordinary Differential Equation (ODE), $m \\frac{d^2x}{dt^2} + kx = 0$, where $x(t)$ is the displacement of the payload from its equilibrium position at time $t$.\n\nAssume the payload has a mass $m = 2.0$ kg and the spring has a constant $k = 8.0$ N/m. At the initial time $t=0$, the payload is located at a position $x(0) = 1.0$ m and is moving with an initial velocity $v(0) = \\frac{dx}{dt}|_{t=0} = 2.0$ m/s.\n\nUsing a single step of the fourth-order Runge-Kutta method with a step size of $h = 0.1$ s, estimate the velocity of the payload at time $t = 0.1$ s. Express your answer in m/s, rounded to four significant figures.", "solution": "The equation of motion is the simple harmonic oscillator ODE $m \\frac{d^{2}x}{dt^{2}} + k x = 0$. Introducing the velocity $v(t) = \\frac{dx}{dt}$, we rewrite it as a first-order system:\n$$\n\\frac{dx}{dt} = v, \\quad \\frac{dv}{dt} = -\\frac{k}{m} x.\n$$\nWith $m=2.0$ and $k=8.0$, we have $\\frac{k}{m} = 4.0$, so\n$$\n\\frac{dx}{dt} = v, \\quad \\frac{dv}{dt} = -4 x.\n$$\nLet $y = \\begin{pmatrix} x \\\\ v \\end{pmatrix}$ and $f(y) = \\begin{pmatrix} v \\\\ -4 x \\end{pmatrix}$. Using one step of the fourth-order Runge-Kutta method with step size $h=0.1$ from $t=0$ with $x(0)=1.0$ and $v(0)=2.0$, define\n$$\nk_{1} = f(y_{0}), \\quad\nk_{2} = f\\!\\left(y_{0} + \\frac{h}{2} k_{1}\\right), \\quad\nk_{3} = f\\!\\left(y_{0} + \\frac{h}{2} k_{2}\\right), \\quad\nk_{4} = f\\!\\left(y_{0} + h k_{3}\\right),\n$$\nand\n$$\ny_{1} = y_{0} + \\frac{h}{6}\\left(k_{1} + 2 k_{2} + 2 k_{3} + k_{4}\\right).\n$$\nCompute the stage values componentwise. At $t_{0}=0$, $x_{0}=1.0$, $v_{0}=2.0$:\n$$\nk_{1x} = v_{0} = 2.0, \\quad k_{1v} = -4 x_{0} = -4.0.\n$$\nWith $h/2 = 0.05$,\n$$\nx_{0} + \\frac{h}{2} k_{1x} = 1.0 + 0.05 \\cdot 2.0 = 1.1, \\quad\nv_{0} + \\frac{h}{2} k_{1v} = 2.0 + 0.05 \\cdot (-4.0) = 1.8,\n$$\nso\n$$\nk_{2x} = 1.8, \\quad k_{2v} = -4 \\cdot 1.1 = -4.4.\n$$\nNext,\n$$\nx_{0} + \\frac{h}{2} k_{2x} = 1.0 + 0.05 \\cdot 1.8 = 1.09, \\quad\nv_{0} + \\frac{h}{2} k_{2v} = 2.0 + 0.05 \\cdot (-4.4) = 1.78,\n$$\nso\n$$\nk_{3x} = 1.78, \\quad k_{3v} = -4 \\cdot 1.09 = -4.36.\n$$\nThen,\n$$\nx_{0} + h k_{3x} = 1.0 + 0.1 \\cdot 1.78 = 1.178, \\quad\nv_{0} + h k_{3v} = 2.0 + 0.1 \\cdot (-4.36) = 1.564,\n$$\nso\n$$\nk_{4x} = 1.564, \\quad k_{4v} = -4 \\cdot 1.178 = -4.712.\n$$\nThe velocity update is\n$$\nv_{1} = v_{0} + \\frac{h}{6}\\left(k_{1v} + 2 k_{2v} + 2 k_{3v} + k_{4v}\\right).\n$$\nCompute the weighted sum:\n$$\nk_{1v} + 2 k_{2v} + 2 k_{3v} + k_{4v} = -4.0 + 2(-4.4) + 2(-4.36) + (-4.712) = -26.232,\n$$\nhence, with $h/6 = 0.1/6$,\n$$\nv_{1} = 2.0 + \\frac{0.1}{6} \\cdot (-26.232) = 2.0 - 0.4372 = 1.5628.\n$$\nRounding to four significant figures gives $1.563$.", "answer": "$$\\boxed{1.563}$$", "id": "2174142"}, {"introduction": "Numerical integration is often thought of as marching forward in time, but what if we only know the final state of a system? This practice introduces a powerful and clever application of the RK4 method: solving a problem backward in time. By simply setting the step size $h$ to a negative value, you can integrate from a known terminal condition to estimate the initial state, a technique with applications in fields like trajectory analysis and thermal history reconstruction [@problem_id:2174167].", "problem": "A small spherical probe is ejected from a deep-space exploration vessel. The probe's internal electronics generate a small but constant amount of heat, while its surface radiates heat into the near-absolute-zero vacuum of space. The temperature $T$ of the probe (in Kelvin, K) as a function of time $t$ (in seconds, s) is governed by the following first-order ordinary differential equation:\n$$\n\\frac{dT}{dt} = - \\alpha T^{4} + \\beta\n$$\nHere, $\\alpha = 2.0 \\times 10^{-8} \\text{ K}^{-3}\\text{s}^{-1}$ is a constant related to the probe's emissivity and surface area, and $\\beta = 0.5 \\text{ K s}^{-1}$ is the constant rate of temperature increase due to internal heat generation.\n\nAt time $t_f = 2.0$ s after ejection, a remote measurement determines the probe's temperature to be $T(t_f) = 100.0$ K. Your task is to estimate the temperature of the probe at the moment of ejection, $t_0 = 0.0$ s.\n\nUse the fourth-order Runge-Kutta method (RK4) with a single time step to compute the approximate value of $T(0.0)$. Express your answer in Kelvin (K), rounded to four significant figures.", "solution": "We are given the first-order ODE for the probe's temperature:\n$$\n\\frac{dT}{dt} = f(T) = - \\alpha T^{4} + \\beta\n$$\nThe problem states that heat is radiated away (the $-\\alpha T^4$ term) and generated internally (the $+\\beta$ term). We are given the constants $\\alpha = 2.0 \\times 10^{-8} \\text{ K}^{-3}\\text{s}^{-1}$ and $\\beta = 0.5 \\text{ K s}^{-1}$, and the terminal condition $T(t_{f}) = T(2.0) = 100.0$ K. We need to estimate the initial temperature $T(0.0)$ by integrating backward in time.\n\nThis requires a single fourth-order Runge-Kutta step from our \"start\" time $t_n = t_f = 2.0$ to our \"end\" time $t_{n+1} = t_0 = 0.0$. The step size is therefore $h = t_0 - t_f = 0.0 - 2.0 = -2.0$ s. Our initial value for the integration is $T_n = T(2.0) = 100.0$ K.\n\nThe RK4 update formula is:\n$$\nT_{n+1} = T_{n} + \\frac{h}{6}\\left(k_{1} + 2 k_{2} + 2 k_{3} + k_{4}\\right)\n$$\nWe compute the intermediate slopes $k_i$:\n\nStep 1: Calculate $k_1$.\n$$\nk_1 = f(T_n) = f(100.0) = -(2.0 \\times 10^{-8})(100.0)^4 + 0.5 = -2.0 + 0.5 = -1.5\n$$\n\nStep 2: Calculate $k_2$.\nThe intermediate temperature is $T_n + \\frac{h}{2}k_1 = 100.0 + \\frac{-2.0}{2}(-1.5) = 100.0 + 1.5 = 101.5$.\n$$\nk_2 = f(101.5) = -(2.0 \\times 10^{-8})(101.5)^4 + 0.5 \\approx -2.122727 + 0.5 = -1.622727\n$$\n\nStep 3: Calculate $k_3$.\nThe next intermediate temperature is $T_n + \\frac{h}{2}k_2 = 100.0 + \\frac{-2.0}{2}(-1.622727) = 101.622727$.\n$$\nk_3 = f(101.622727) = -(2.0 \\times 10^{-8})(101.622727)^4 + 0.5 \\approx -2.132076 + 0.5 = -1.632076\n$$\n\nStep 4: Calculate $k_4$.\nThe final intermediate temperature is $T_n + h k_3 = 100.0 + (-2.0)(-1.632076) = 103.264152$.\n$$\nk_4 = f(103.264152) = -(2.0 \\times 10^{-8})(103.264152)^4 + 0.5 \\approx -2.274042 + 0.5 = -1.774042\n$$\n\nStep 5: Calculate the next value $T_{n+1} \\approx T(0.0)$.\nWe use the main RK4 formula:\n$$\nT_{n+1} = 100.0 + \\frac{-2.0}{6} \\left( (-1.5) + 2(-1.622727) + 2(-1.632076) + (-1.774042) \\right)\n$$\n$$\nT_{n+1} = 100.0 - \\frac{1}{3} \\left( -1.5 - 3.245454 - 3.264152 - 1.774042 \\right)\n$$\n$$\nT_{n+1} = 100.0 - \\frac{1}{3} (-9.783648)\n$$\n$$\nT_{n+1} = 100.0 + 3.261216 \\approx 103.261216\n$$\n\nRounding to four significant figures, the estimated temperature at ejection is $103.3$ K.", "answer": "$$\\boxed{103.3}$$", "id": "2174167"}]}