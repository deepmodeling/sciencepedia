{"hands_on_practices": [{"introduction": "The first step in mastering the Wolfe conditions is to become proficient in their direct application. This exercise [@problem_id:2226157] provides a concrete scenario with a multi-dimensional quadratic function, allowing you to practice the core calculations. By verifying both the sufficient decrease (Armijo) and curvature conditions, you will build the foundational skill of determining whether a candidate step length is acceptable according to these crucial criteria.", "problem": "In numerical optimization, line search algorithms iteratively find a minimum of a function $f: \\mathbb{R}^n \\to \\mathbb{R}$ by choosing a search direction $\\mathbf{p}_k$ from a point $\\mathbf{x}_k$ and then finding a suitable step length $\\alpha > 0$ that minimizes $f(\\mathbf{x}_k + \\alpha \\mathbf{p}_k)$. The Wolfe conditions are a pair of inequalities that define what constitutes a \"suitable\" step length.\n\nConsider the objective function $f(x_1, x_2) = 2x_1^2 + 3x_2^2$. We are at the point $\\mathbf{x}_k = (3, -2)^T$ and choose the steepest descent direction for our search direction $\\mathbf{p}_k$. We want to test a potential step length of $\\alpha = 0.1$.\n\nThe Wolfe conditions for a given step length $\\alpha$ are:\n1.  **Armijo (Sufficient Decrease) Condition**: $f(\\mathbf{x}_k + \\alpha \\mathbf{p}_k) \\le f(\\mathbf{x}_k) + c_1 \\alpha \\nabla f(\\mathbf{x}_k)^T \\mathbf{p}_k$\n2.  **Curvature Condition**: $\\nabla f(\\mathbf{x}_k + \\alpha \\mathbf{p}_k)^T \\mathbf{p}_k \\ge c_2 \\nabla f(\\mathbf{x}_k)^T \\mathbf{p}_k$\n\nUsing the standard constants $c_1 = 10^{-4}$ and $c_2 = 0.9$, determine which of these conditions are satisfied for the step length $\\alpha = 0.1$.\n\nA. Only the Armijo condition is satisfied.\n\nB. Only the Curvature condition is satisfied.\n\nC. Both the Armijo and Curvature conditions are satisfied.\n\nD. Neither the Armijo nor the Curvature condition is satisfied.", "solution": "We use steepest descent, so the search direction is the negative gradient. The objective is $f(\\mathbf{x}) = f(x_1, x_2) = 2x_1^2 + 3x_2^2$, hence\n$$\n\\nabla f(\\mathbf{x}) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x_1} \\\\ \\frac{\\partial f}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 4x_1 \\\\ 6x_2 \\end{pmatrix}.\n$$\nAt $\\mathbf{x}_k = \\begin{pmatrix} 3 \\\\ -2 \\end{pmatrix}$ we have\n$$\n\\nabla f(\\mathbf{x}_k) = \\begin{pmatrix} 12 \\\\ -12 \\end{pmatrix}, \\quad \\mathbf{p}_k = -\\nabla f(\\mathbf{x}_k) = \\begin{pmatrix} -12 \\\\ 12 \\end{pmatrix}.\n$$\nCompute the baseline function value and directional derivative:\n$$\nf(\\mathbf{x}_k) = 2 \\cdot 3^2 + 3 \\cdot (-2)^2 = 18 + 12 = 30, \\quad \\nabla f(\\mathbf{x}_k)^T \\mathbf{p}_k = \\begin{pmatrix} 12  -12 \\end{pmatrix} \\begin{pmatrix} -12 \\\\ 12 \\end{pmatrix} = -288.\n$$\nFor $\\alpha=0.1$, the trial point is\n$$\n\\mathbf{x}_k + \\alpha \\mathbf{p}_k = \\begin{pmatrix} 3 \\\\ -2 \\end{pmatrix} + 0.1 \\begin{pmatrix} -12 \\\\ 12 \\end{pmatrix} = \\begin{pmatrix} 1.8 \\\\ -0.8 \\end{pmatrix}.\n$$\nEvaluate $f$ at the trial point:\n$$\nf(\\mathbf{x}_k + \\alpha \\mathbf{p}_k) = 2 \\cdot (1.8)^2 + 3 \\cdot (-0.8)^2 = 2 \\cdot 3.24 + 3 \\cdot 0.64 = 6.48 + 1.92 = 8.4.\n$$\nArmijo condition with $c_1=10^{-4}$ requires\n$$\nf(\\mathbf{x}_k + \\alpha \\mathbf{p}_k) \\le f(\\mathbf{x}_k) + c_1 \\alpha \\nabla f(\\mathbf{x}_k)^T \\mathbf{p}_k.\n$$\nThe right-hand side equals\n$$\n30 + (10^{-4})(0.1)(-288) = 30 - 2.88 \\times 10^{-3} = 29.99712,\n$$\nand since $8.4 \\le 29.99712$, the Armijo condition is satisfied.\n\nFor the curvature condition with $c_2=0.9$, compute the new gradient and its directional derivative:\n$$\n\\nabla f(\\mathbf{x}_k + \\alpha \\mathbf{p}_k) = \\begin{pmatrix} 4 \\cdot 1.8 \\\\ 6 \\cdot (-0.8) \\end{pmatrix} = \\begin{pmatrix} 7.2 \\\\ -4.8 \\end{pmatrix},\n$$\n$$\n\\nabla f(\\mathbf{x}_k + \\alpha \\mathbf{p}_k)^T \\mathbf{p}_k = \\begin{pmatrix} 7.2  -4.8 \\end{pmatrix} \\begin{pmatrix} -12 \\\\ 12 \\end{pmatrix} = -86.4 - 57.6 = -144.\n$$\nThe curvature condition requires\n$$\n\\nabla f(\\mathbf{x}_k + \\alpha \\mathbf{p}_k)^T \\mathbf{p}_k \\ge c_2 \\nabla f(\\mathbf{x}_k)^T \\mathbf{p}_k = 0.9 \\cdot (-288) = -259.2.\n$$\nSince $-144 \\ge -259.2$, the curvature condition is also satisfied.\n\nTherefore, both Wolfe conditions are satisfied for $\\alpha=0.1$.", "answer": "$$\\boxed{C}$$", "id": "2226157"}, {"introduction": "The Wolfe conditions are not redundant; each inequality serves a distinct and vital purpose in guiding the line search. This practice problem [@problem_id:2226173] explores a specific case where a step length satisfies the curvature condition but fails the Armijo (sufficient decrease) condition. By analyzing this scenario, you will gain a deeper insight into how the Armijo condition specifically prevents steps that are too large, ensuring that each iteration makes meaningful progress in reducing the objective function.", "problem": "In an optimization routine that uses a line search algorithm, we consider the one-dimensional objective function $f(x) = 2x^3 + 2x^2 - 4x$. The algorithm is currently at the iterate $x_k=0$ and has determined a descent search direction $p_k=1$.\n\nThe goal is to find a step length $\\alpha  0$ that satisfies the Wolfe conditions. The first Wolfe condition, also known as the Armijo (or sufficient decrease) condition, is given by:\n$$f(x_k + \\alpha p_k) \\le f(x_k) + c_1 \\alpha f'(x_k) p_k$$\nThe second Wolfe condition, also known as the curvature condition, is given by:\n$$f'(x_k + \\alpha p_k) p_k \\ge c_2 f'(x_k) p_k$$\nFor this particular search, the constants are set to $c_1 = 0.25$ and $c_2 = 0.75$.\n\nFrom the options below, which value of the step length $\\alpha$ satisfies the curvature condition but fails to satisfy the Armijo condition?\n\nA. $\\alpha = 0.1$\n\nB. $\\alpha = 0.5$\n\nC. $\\alpha = 0.7$\n\nD. $\\alpha = 0.9$", "solution": "We are given $f(x) = 2x^{3} + 2x^{2} - 4x$, with $x_{k} = 0$ and $p_{k} = 1$. Its derivative is\n$$\nf'(x) = 6x^{2} + 4x - 4.\n$$\nAt $x_{k}=0$, we have\n$$\nf(0) = 0, \\quad f'(0) = -4,\n$$\nand $p_{k}$ is a descent direction since $p_{k}f'(x_{k}) = -4  0$.\n\nArmijo condition with $c_{1} = 0.25$ is\n$$\nf(x_{k} + \\alpha p_{k}) \\le f(x_{k}) + c_{1}\\alpha f'(x_{k}) p_{k},\n$$\nwhich reduces to\n$$\nf(\\alpha) \\le -\\alpha.\n$$\nSince $f(\\alpha) = 2\\alpha^{3} + 2\\alpha^{2} - 4\\alpha$, this is equivalent to\n$$\n2\\alpha^{3} + 2\\alpha^{2} - 4\\alpha \\le -\\alpha \\;\\;\\Longleftrightarrow\\;\\; 2\\alpha^{3} + 2\\alpha^{2} - 3\\alpha \\le 0 \\;\\;\\Longleftrightarrow\\;\\; \\alpha\\left(2\\alpha^{2} + 2\\alpha - 3\\right) \\le 0.\n$$\nFor $\\alpha  0$, this becomes\n$$\n2\\alpha^{2} + 2\\alpha - 3 \\le 0,\n$$\nwhose positive root is\n$$\n\\alpha_{A} = \\frac{-1 + \\sqrt{7}}{2}.\n$$\nThus Armijo holds for $0  \\alpha \\le \\alpha_{A}$ and fails for $\\alpha  \\alpha_{A}$.\n\nCurvature condition with $c_{2} = 0.75$ is\n$$\nf'(x_{k} + \\alpha p_{k})p_{k} \\ge c_{2} f'(x_{k})p_{k},\n$$\nwhich reduces to\n$$\nf'(\\alpha) \\ge -3.\n$$\nSince $f'(\\alpha) = 6\\alpha^{2} + 4\\alpha - 4$, this is\n$$\n6\\alpha^{2} + 4\\alpha - 4 \\ge -3 \\;\\;\\Longleftrightarrow\\;\\; 6\\alpha^{2} + 4\\alpha - 1 \\ge 0.\n$$\nThe positive root of $6\\alpha^{2} + 4\\alpha - 1 = 0$ is\n$$\n\\alpha_{C} = \\frac{-2 + \\sqrt{10}}{6}.\n$$\nThus the curvature condition holds for $\\alpha \\ge \\alpha_{C}$.\n\nNow test the options by direct evaluation of both conditions:\n\n- For $\\alpha = 0.1$:\nArmijo: $2(0.1)^{3} + 2(0.1)^{2} - 3(0.1) = 0.002 + 0.02 - 0.3 = -0.278 \\le 0$ holds.\nCurvature: $f'(0.1) = 6(0.1)^{2} + 4(0.1) - 4 = 0.06 + 0.4 - 4 = -3.54 \\not\\ge -3$ fails.\n\n- For $\\alpha = 0.5$:\nArmijo: $2(0.5)^{3} + 2(0.5)^{2} - 3(0.5) = 0.25 + 0.5 - 1.5 = -0.75 \\le 0$ holds.\nCurvature: $f'(0.5) = 6(0.5)^{2} + 4(0.5) - 4 = 1.5 + 2 - 4 = -0.5 \\ge -3$ holds.\n\n- For $\\alpha = 0.7$:\nArmijo: $2(0.7)^{3} + 2(0.7)^{2} - 3(0.7) = 0.686 + 0.98 - 2.1 = -0.434 \\le 0$ holds.\nCurvature: $f'(0.7) = 6(0.7)^{2} + 4(0.7) - 4 = 2.94 + 2.8 - 4 = 1.74 \\ge -3$ holds.\n\n- For $\\alpha = 0.9$:\nArmijo: $2(0.9)^{3} + 2(0.9)^{2} - 3(0.9) = 1.458 + 1.62 - 2.7 = 0.378  0$ fails.\nCurvature: $f'(0.9) = 6(0.9)^{2} + 4(0.9) - 4 = 4.86 + 3.6 - 4 = 4.46 \\ge -3$ holds.\n\nTherefore, the step length that satisfies the curvature condition but fails the Armijo condition is $\\alpha = 0.9$.", "answer": "$$\\boxed{D}$$", "id": "2226173"}, {"introduction": "The true power of the Wolfe conditions is revealed when they are used to drive an iterative algorithm. This advanced problem [@problem_id:2226137] simulates the 'zoom' phase of a standard line search routine, where you will use the conditions to systematically narrow an interval guaranteed to contain an acceptable step length. Engaging with this process provides a hands-on feel for how these theoretical checks are implemented in practice to ensure the convergence and efficiency of optimization algorithms.", "problem": "In numerical optimization, a line search algorithm seeks to find a suitable step length $\\alpha  0$ along a given search direction. The strong Wolfe conditions are a popular set of criteria for terminating the line search. They ensure both sufficient decrease in the objective function and a sufficient decrease in the magnitude of the projected gradient.\n\nConsider a a one-dimensional search function $\\phi(\\alpha)$ which represents the value of an objective function along a search direction, starting from a point where $\\phi(0) = 5$ and the directional derivative is $\\phi'(0) = -12$. The function is given by the cubic polynomial:\n$$\n\\phi(\\alpha) = 2\\alpha^3 - 3\\alpha^2 - 12\\alpha + 5\n$$\nThe strong Wolfe conditions are defined as:\n1.  **Sufficient Decrease Condition**: $\\phi(\\alpha) \\le \\phi(0) + c_1 \\alpha \\phi'(0)$\n2.  **Strong Curvature Condition**: $|\\phi'(\\alpha)| \\le c_2 |\\phi'(0)|$\n\nFor this problem, use the constants $c_1 = \\frac{1}{10}$ and $c_2 = \\frac{1}{2}$.\n\nA line search algorithm has first performed a bracketing phase and found an initial interval $[\\alpha_{lo}, \\alpha_{hi}] = [1, 4]$. This interval is known to satisfy the standard entry requirements for the 'zoom' phase of the algorithm: the sufficient decrease condition holds for $\\alpha_{lo}$, while it is violated for $\\alpha_{hi}$.\n\nYou are to trace the 'zoom' phase to find an acceptable step length. In each iteration, a trial step length $\\alpha_j$ is selected by taking the midpoint (bisection) of the current interval $[\\alpha_{lo}, \\alpha_{hi}]$. The interval is then updated according to the following rules:\n\n*   **Rule A**: If the sufficient decrease condition is violated at the trial point $\\alpha_j$, the new interval becomes $[\\alpha_{lo}, \\alpha_j]$.\n*   **Rule B**: If the sufficient decrease condition is satisfied at $\\alpha_j$:\n    1.  Check if the strong curvature condition is also satisfied. If it is, the search terminates and $\\alpha_j$ is the solution.\n    2.  If the curvature condition is violated, check the sign of the derivative $\\phi'(\\alpha_j)$.\n        *   If $\\phi'(\\alpha_j) \\ge 0$, the new interval becomes $[\\alpha_{lo}, \\alpha_j]$.\n        *   If $\\phi'(\\alpha_j)  0$, the new interval becomes $[\\alpha_j, \\alpha_{hi}]$.\n\nDetermine the first value of $\\alpha$ found by this procedure that satisfies both strong Wolfe conditions. Express your final answer as an exact fraction.", "solution": "We are given $\\phi(\\alpha)=2\\alpha^{3}-3\\alpha^{2}-12\\alpha+5$ with $\\phi(0)=5$ and $\\phi'(0)=-12$. Its derivative is\n$$\n\\phi'(\\alpha)=6\\alpha^{2}-6\\alpha-12=6(\\alpha-2)(\\alpha+1).\n$$\nThe strong Wolfe constants are $c_{1}=\\frac{1}{10}$ and $c_{2}=\\frac{1}{2}$. Thus the sufficient decrease condition is\n$$\n\\phi(\\alpha)\\leq \\phi(0)+c_{1}\\alpha\\phi'(0)=5-\\frac{6}{5}\\alpha,\n$$\nand the strong curvature condition is\n$$\n|\\phi'(\\alpha)|\\leq c_{2}|\\phi'(0)|=6.\n$$\n\nFirst, verify the bracketing interval $[\\alpha_{lo},\\alpha_{hi}]=[1,4]$:\n- At $\\alpha=1$, compute $\\phi(1)=2-3-12+5=-8$ and the right-hand side $5-\\frac{6}{5}\\cdot 1=\\frac{19}{5}$. Since $-8\\leq \\frac{19}{5}$, the sufficient decrease condition holds at $\\alpha_{lo}=1$.\n- At $\\alpha=4$, compute $\\phi(4)=128-48-48+5=37$ and the right-hand side $5-\\frac{6}{5}\\cdot 4=\\frac{1}{5}$. Since $37\\leq \\frac{1}{5}$ is false, the sufficient decrease condition is violated at $\\alpha_{hi}=4$.\nThus the entry conditions for zoom are satisfied.\n\nZoom iteration 1 (bisection):\n- Trial $\\alpha_{1}=\\frac{1+4}{2}=\\frac{5}{2}$. Evaluate $\\phi\\!\\left(\\frac{5}{2}\\right)$:\n$$\n\\phi\\!\\left(\\frac{5}{2}\\right)=2\\left(\\frac{125}{8}\\right)-3\\left(\\frac{25}{4}\\right)-12\\left(\\frac{5}{2}\\right)+5=\\frac{125}{4}-\\frac{75}{4}-30+5=-\\frac{25}{2}.\n$$\nThe sufficient decrease right-hand side is $5-\\frac{6}{5}\\cdot \\frac{5}{2}=2$. Since $-\\frac{25}{2}\\leq 2$, the sufficient decrease condition holds.\n- Check curvature at $\\alpha_{1}$:\n$$\n\\phi'\\!\\left(\\frac{5}{2}\\right)=6\\left(\\frac{5}{2}-2\\right)\\left(\\frac{5}{2}+1\\right)=6\\left(\\frac{1}{2}\\right)\\left(\\frac{7}{2}\\right)=\\frac{21}{2},\n$$\nso $|\\phi'\\!\\left(\\frac{5}{2}\\right)|=\\frac{21}{2}6$, and the strong curvature condition is violated. Since $\\phi'\\!\\left(\\frac{5}{2}\\right)\\geq 0$, apply Rule B with nonnegative derivative, setting the new interval to $[\\alpha_{lo},\\alpha_{1}]=\\left[1,\\frac{5}{2}\\right]$.\n\nZoom iteration 2 (bisection):\n- Trial $\\alpha_{2}=\\frac{1+\\frac{5}{2}}{2}=\\frac{7}{4}$. Evaluate $\\phi\\!\\left(\\frac{7}{4}\\right)$:\n$$\n\\phi\\!\\left(\\frac{7}{4}\\right)=2\\left(\\frac{343}{64}\\right)-3\\left(\\frac{49}{16}\\right)-12\\left(\\frac{7}{4}\\right)+5=\\frac{343}{32}-\\frac{147}{16}-21+5=-\\frac{463}{32}.\n$$\nThe sufficient decrease right-hand side is $5-\\frac{6}{5}\\cdot \\frac{7}{4}=\\frac{29}{10}$. Since $-\\frac{463}{32}\\leq \\frac{29}{10}$, the sufficient decrease condition holds.\n- Check curvature at $\\alpha_{2}$:\n$$\n\\phi'\\!\\left(\\frac{7}{4}\\right)=6\\left(\\frac{7}{4}-2\\right)\\left(\\frac{7}{4}+1\\right)=6\\left(-\\frac{1}{4}\\right)\\left(\\frac{11}{4}\\right)=-\\frac{33}{8},\n$$\nso $|\\phi'\\!\\left(\\frac{7}{4}\\right)|=\\frac{33}{8}\\leq 6$ because $\\frac{33}{8}\\leq \\frac{48}{8}$. Therefore, the strong curvature condition holds.\n\nSince both strong Wolfe conditions are satisfied at $\\alpha=\\frac{7}{4}$, the zoom phase terminates with this step length as the first acceptable value found by the procedure.", "answer": "$$\\boxed{\\frac{7}{4}}$$", "id": "2226137"}]}