{"hands_on_practices": [{"introduction": "We begin our hands-on exploration with a foundational exercise that establishes the core mechanics of clamped splines. This problem guides you through the construction of a clamped cubic spline for a simple three-point dataset, where the derivatives at both ends are set to zero. This scenario, representing a curve that starts and ends horizontally, is a common and intuitive starting point for understanding how externally imposed slope constraints shape the interpolating curve [@problem_id:2159084].", "problem": "A clamped cubic spline is used to interpolate a set of data points. A cubic spline $S(x)$ consists of piecewise cubic polynomials, one for each interval between consecutive data points. For a set of points $(x_0, y_0), (x_1, y_1), \\dots, (x_n, y_n)$, the polynomial on the interval $[x_j, x_{j+1}]$ is given by $S_j(x) = a_j + b_j(x-x_j) + c_j(x-x_j)^2 + d_j(x-x_j)^3$.\n\nConsider a dataset consisting of three points: $(x_0, y_0) = (0, 0)$, $(x_1, y_1) = (1, 2)$, and $(x_2, y_2) = (2, 1)$. A clamped cubic spline $S(x)$ is constructed to pass through these points, with the additional boundary conditions that the derivatives at the endpoints are zero, i.e., $S'(0) = 0$ and $S'(2) = 0$.\n\nCalculate the value of this spline at $x=1.5$. Round your final answer to three significant figures.", "solution": "A clamped cubic spline with knots $x_{0}=0$, $x_{1}=1$, $x_{2}=2$ and endpoint derivatives $S'(0)=0$, $S'(2)=0$ can be constructed using the standard second-derivative (moment) formulation. Let $M_{i}=S''(x_{i})$ and $h_{i}=x_{i+1}-x_{i}$. For clamped ends, the system for $M_{0},M_{1},M_{2}$ is\n$$\n2h_{0}M_{0}+h_{0}M_{1}=6\\left(\\frac{y_{1}-y_{0}}{h_{0}}-S'(x_{0})\\right),\n$$\n$$\nh_{0}M_{0}+2(h_{0}+h_{1})M_{1}+h_{1}M_{2}=6\\left(\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}\\right),\n$$\n$$\nh_{1}M_{1}+2h_{1}M_{2}=6\\left(S'(x_{2})-\\frac{y_{2}-y_{1}}{h_{1}}\\right).\n$$\nHere $h_{0}=h_{1}=1$, $(y_{0},y_{1},y_{2})=(0,2,1)$, $\\frac{y_{1}-y_{0}}{h_{0}}=2$, $\\frac{y_{2}-y_{1}}{h_{1}}=-1$, and $S'(x_{0})=S'(x_{2})=0$. The system becomes\n$$\n2M_{0}+M_{1}=12,\\quad M_{0}+4M_{1}+M_{2}=-18,\\quad M_{1}+2M_{2}=6.\n$$\nSolving gives\n$$\nM_{0}=\\frac{21}{2},\\quad M_{1}=-9,\\quad M_{2}=\\frac{15}{2}.\n$$\nOn the interval $[x_{1},x_{2}]=[1,2]$, the spline is\n$$\nS_{1}(x)=\\frac{M_{1}}{6}(x_{2}-x)^{3}+\\frac{M_{2}}{6}(x-x_{1})^{3}+\\left(y_{1}-\\frac{M_{1}h_{1}^{2}}{6}\\right)\\frac{x_{2}-x}{h_{1}}+\\left(y_{2}-\\frac{M_{2}h_{1}^{2}}{6}\\right)\\frac{x-x_{1}}{h_{1}}.\n$$\nWith $h_{1}=1$, $x_{1}=1$, $x_{2}=2$, $M_{1}/6=-\\frac{3}{2}$, $M_{2}/6=\\frac{5}{4}$, $y_{1}-M_{1}/6=\\frac{7}{2}$, and $y_{2}-M_{2}/6=-\\frac{1}{4}$, this simplifies to\n$$\nS_{1}(x)=-\\frac{3}{2}(2-x)^{3}+\\frac{5}{4}(x-1)^{3}+\\frac{7}{2}(2-x)-\\frac{1}{4}(x-1).\n$$\nAt $x=1.5$, letting $u=0.5$ gives\n$$\nS(1.5)=-\\frac{3}{2}u^{3}+\\frac{5}{4}u^{3}+\\frac{7}{2}u-\\frac{1}{4}u\n= -\\frac{3}{16}+\\frac{5}{32}+\\frac{7}{4}-\\frac{1}{8}\n=\\frac{51}{32}=1.59375.\n$$\nRounding to three significant figures yields $1.59$.", "answer": "$$\\boxed{1.59}$$", "id": "2159084"}, {"introduction": "Having mastered the basic mechanics, we now explore the profound impact of boundary conditions on a model's physical realism. A poorly chosen derivative can introduce artificial \"wobbles\" or inflection points that do not reflect the underlying data. This exercise challenges you to determine the precise initial derivative needed to ensure a spline model remains concave, matching the known behavior of a physical process and thus avoiding non-physical artifacts [@problem_id:2159102].", "problem": "A clamped cubic spline is being used to model a physical process based on three discrete measurements. The data points $(t_i, y_i)$ are given as $(0, 1)$, $(1, 3)$, and $(3, 2)$, where $t$ is time in an arbitrary unit and $y$ is a sensor reading.\n\nThe spline, denoted $S(t)$, interpolates these points. To ensure a smooth transition to subsequent data, the spline is \"clamped\" with a specified derivative at the final point: $S'(3) = -1$. The derivative at the initial point, $v_0 = S'(0)$, is a parameter that an engineer must choose.\n\nThe underlying physical process being modeled is known to be inherently concave, meaning its true second derivative is always non-positive. A poor choice for the initial derivative $v_0$ can cause the spline model to exhibit an artificial \"wobble,\" which manifests as a region of convexity where the spline's second derivative, $S''(t)$, becomes positive. Such a region would represent a non-physical artifact in the model.\n\nDetermine the minimum numerical value of the initial derivative $v_0$ that ensures the resulting spline $S(t)$ is purely concave over the entire interval $[0, 3]$, thus avoiding any non-physical artifacts. Express your answer rounded to three significant figures.", "solution": "We construct the clamped cubic spline on knots $t_{0}=0$, $t_{1}=1$, $t_{2}=3$ with values $y_{0}=1$, $y_{1}=3$, $y_{2}=2$, and prescribed endpoint derivatives $S'(0)=v_{0}$ (unknown) and $S'(3)=-1$. Let $h_{0}=t_{1}-t_{0}=1$ and $h_{1}=t_{2}-t_{1}=2$. In the standard cubic spline formulation, let $M_{i}=S''(t_{i})$ for $i=0,1,2$. For a clamped spline, the $M_{i}$ satisfy the tridiagonal system:\n- Interior equation (from continuity of $S'$ at $t_{1}$):\n$$\nh_{0} M_{0} + 2(h_{0}+h_{1}) M_{1} + h_{1} M_{2} = 6\\left( \\frac{y_{2}-y_{1}}{h_{1}} - \\frac{y_{1}-y_{0}}{h_{0}} \\right).\n$$\n- Left boundary (clamped) equation:\n$$\n2 h_{0} M_{0} + h_{0} M_{1} = 6\\left( \\frac{y_{1}-y_{0}}{h_{0}} - v_{0} \\right).\n$$\n- Right boundary (clamped) equation:\n$$\nh_{1} M_{1} + 2 h_{1} M_{2} = 6\\left( -1 - \\frac{y_{2}-y_{1}}{h_{1}} \\right).\n$$\n\nCompute the needed slopes:\n$$\n\\frac{y_{1}-y_{0}}{h_{0}} = 2, \\qquad \\frac{y_{2}-y_{1}}{h_{1}} = -\\frac{1}{2}.\n$$\nSubstituting $h_{0}=1$, $h_{1}=2$ and these slopes, the system becomes\n$$\n\\text{(I)}\\quad M_{0} + 6 M_{1} + 2 M_{2} = -15,\n$$\n$$\n\\text{(L)}\\quad 2 M_{0} + M_{1} = 12 - 6 v_{0},\n$$\n$$\n\\text{(R)}\\quad 2 M_{1} + 4 M_{2} = -3.\n$$\nSolve for $M_{i}$ in terms of $v_{0}$. From (R), $M_{1} = -\\frac{3}{2} - 2 M_{2}$. Substitute into (I) to get $M_{0} = -6 + 10 M_{2}$. Substitute both into (L):\n$$\n2(-6 + 10 M_{2}) + \\left( -\\frac{3}{2} - 2 M_{2} \\right) = 12 - 6 v_{0},\n$$\nwhich simplifies to\n$$\n18 M_{2} - \\frac{27}{2} = 12 - 6 v_{0}.\n$$\nHence\n$$\nM_{2} = \\frac{51 - 12 v_{0}}{36} = \\frac{17 - 4 v_{0}}{12}.\n$$\nThen\n$$\nM_{1} = -\\frac{3}{2} - 2 M_{2} = -\\frac{3}{2} - \\frac{17 - 4 v_{0}}{6} = \\frac{2 v_{0} - 13}{3},\n$$\nand\n$$\nM_{0} = -6 + 10 M_{2} = -6 + \\frac{10(17 - 4 v_{0})}{12} = \\frac{49 - 20 v_{0}}{6}.\n$$\n\nThe second derivative of a cubic spline on each subinterval is linear:\n$$\nS''(t) = M_{i} \\frac{t_{i+1}-t}{h_{i}} + M_{i+1} \\frac{t - t_{i}}{h_{i}}, \\qquad t \\in [t_{i}, t_{i+1}],\n$$\nso $S''$ is the linear interpolation between $M_{i}$ and $M_{i+1}$. Therefore $S''(t) \\le 0$ for all $t \\in [0,3]$ if and only if\n$$\nM_{0} \\le 0, \\quad M_{1} \\le 0, \\quad M_{2} \\le 0.\n$$\nImposing these with the expressions above:\n- $M_{2} \\le 0 \\implies \\frac{17 - 4 v_{0}}{12} \\le 0 \\implies v_{0} \\ge \\frac{17}{4}.$\n- $M_{1} \\le 0 \\implies \\frac{2 v_{0} - 13}{3} \\le 0 \\implies v_{0} \\le \\frac{13}{2}.$\n- $M_{0} \\le 0 \\implies \\frac{49 - 20 v_{0}}{6} \\le 0 \\implies v_{0} \\ge \\frac{49}{20}.$\n\nCombining yields\n$$\nv_{0} \\in \\left[ \\frac{17}{4}, \\frac{13}{2} \\right],\n$$\nso the minimum $v_{0}$ ensuring $S''(t) \\le 0$ on $[0,3]$ is $v_{0} = \\frac{17}{4} = 4.25$. Rounded to three significant figures, this is $4.25$.", "answer": "$$\\boxed{4.25}$$", "id": "2159102"}, {"introduction": "This final practice elevates the concept of clamped conditions from a simple constraint to a powerful design tool in engineering. Instead of being a given value, an endpoint derivative here becomes an unknown you must solve for to satisfy a global system propertyâ€”in this case, a specific value for the total integrated stress. This problem demonstrates how clamped splines are used in inverse problems, where we determine local model parameters to achieve a desired global outcome [@problem_id:2159088].", "problem": "A mechanical component's one-dimensional stress profile, $S(x)$, is modeled over the domain $[0, 3]$ using a cubic spline. A cubic spline is a function constructed of piecewise cubic polynomials, joined at a set of points known as knots, in a way that the first and second derivatives are continuous at each internal knot.\n\nThe spline $S(x)$ is defined by the following specifications:\n1.  The knots are located at $x_0 = 0$, $x_1 = 1$, and $x_2 = 3$.\n2.  The spline must pass through the points $(x_0, y_0) = (0, 0)$, $(x_1, y_1) = (1, 1)$, and $(x_2, y_2) = (3, -1)$.\n3.  The spline is a clamped cubic spline, meaning its first derivatives at the endpoints are specified. The derivative at the start of the interval is given as $S'(0) = 1$.\n4.  The total integrated stress over the component's length, which corresponds to the total force, must be equal to a specific target value. This is given by the constraint $\\int_{0}^{3} S(x) dx = \\frac{7}{16}$.\n\nYour task is to determine the required value of the derivative at the end of the interval, $S'(3)$, that satisfies all the given conditions. Express your answer as a single real number.", "solution": "Let the cubic spline be $S(x)$. It is defined on two intervals: $[0, 1]$ by a cubic polynomial $S_0(x)$, and $[1, 3]$ by a cubic polynomial $S_1(x)$. The knots are $x_0=0, x_1=1, x_2=3$. The corresponding function values are $y_0=0, y_1=1, y_2=-1$. The lengths of the intervals are $h_0 = x_1 - x_0 = 1$ and $h_1 = x_2 - x_1 = 2$.\n\nA cubic spline is uniquely determined by its second derivatives at the knots, $M_i = S''(x_i)$. For a spline with $n+1$ knots ($x_0, \\dots, x_n$), the values $M_1, \\dots, M_{n-1}$ satisfy a system of linear equations. For a clamped spline, where $S'(x_0)=v_0$ and $S'(x_n)=v_n$ are specified, the full set of second derivatives $M_0, \\dots, M_n$ is found by solving a larger system.\n\nIn our case, $n=2$. The general system for the internal knot $x_1$ is:\n$$h_0 M_0 + 2(h_0+h_1)M_1 + h_1 M_2 = 6\\left(\\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0}\\right)$$\nSubstituting the given values ($h_0=1, h_1=2, y_0=0, y_1=1, y_2=-1$):\n$$1 \\cdot M_0 + 2(1+2)M_1 + 2 \\cdot M_2 = 6\\left(\\frac{-1-1}{2} - \\frac{1-0}{1}\\right)$$\n$$M_0 + 6M_1 + 2M_2 = 6(-1 - 1) = -12 \\quad (*)$$\n\nFor a clamped spline, the boundary conditions provide two more equations.\nAt $x_0=0$, we have $S'(0) = v_0 = 1$. The equation is:\n$$2h_0 M_0 + h_0 M_1 = 6\\left(\\frac{y_1-y_0}{h_0} - v_0\\right)$$\n$$2(1)M_0 + 1 \\cdot M_1 = 6\\left(\\frac{1-0}{1} - 1\\right) = 0$$\n$$2M_0 + M_1 = 0 \\implies M_1 = -2M_0 \\quad (**)$$\n\nAt $x_2=3$, the derivative $S'(3)=v_2$ is what we need to find. The equation is:\n$$h_1 M_1 + 2h_1 M_2 = 6\\left(v_2 - \\frac{y_2-y_1}{h_1}\\right)$$\n$$2M_1 + 2(2)M_2 = 6\\left(v_2 - \\frac{-1-1}{2}\\right) = 6(v_2+1)$$\n$$2M_1 + 4M_2 = 6v_2 + 6 \\implies M_1 + 2M_2 = 3v_2 + 3 \\quad (***)$$\n\nWe have a system of three linear equations for $M_0, M_1, M_2$ in terms of the unknown $v_2$. Let's solve for the $M_i$ in terms of $v_2$.\nSubstitute $M_1 = -2M_0$ from $(**)$ into $(*)$ and $(***)$:\nInto $(*)$: $M_0 + 6(-2M_0) + 2M_2 = -12 \\implies -11M_0 + 2M_2 = -12$.\nInto $(***)$: $-2M_0 + 2M_2 = 3v_2 + 3 \\implies 2M_2 = 2M_0 + 3v_2 + 3$.\n\nNow substitute the expression for $2M_2$ into the modified equation $(*)$:\n$$-11M_0 + (2M_0 + 3v_2 + 3) = -12$$\n$$-9M_0 = -15 - 3v_2 \\implies M_0 = \\frac{15+3v_2}{9} = \\frac{5}{3} + \\frac{1}{3}v_2$$\nNow we can find $M_1$ and $M_2$:\n$$M_1 = -2M_0 = -2\\left(\\frac{5}{3} + \\frac{1}{3}v_2\\right) = -\\frac{10}{3} - \\frac{2}{3}v_2$$\n$$2M_2 = 2M_0 + 3v_2 + 3 = 2\\left(\\frac{5}{3} + \\frac{1}{3}v_2\\right) + 3v_2 + 3 = \\frac{10}{3} + \\frac{2}{3}v_2 + 3v_2 + 3 = \\frac{19}{3} + \\frac{11}{3}v_2$$\n$$M_2 = \\frac{19}{6} + \\frac{11}{6}v_2$$\n\nThe next step is to use the integral constraint. The integral of a single cubic spline segment from $x_i$ to $x_{i+1}$ is given by:\n$$\\int_{x_i}^{x_{i+1}} S_i(x) dx = \\frac{h_i}{2}(y_i + y_{i+1}) - \\frac{h_i^3}{24}(M_i + M_{i+1})$$\nThe total integral is the sum of integrals over the two segments $[0,1]$ and $[1,3]$:\n$$\\int_0^3 S(x) dx = \\left[\\frac{h_0}{2}(y_0+y_1) - \\frac{h_0^3}{24}(M_0+M_1)\\right] + \\left[\\frac{h_1}{2}(y_1+y_2) - \\frac{h_1^3}{24}(M_1+M_2)\\right]$$\nSubstituting values:\n$$\\int_0^3 S(x) dx = \\left[\\frac{1}{2}(0+1) - \\frac{1^3}{24}(M_0+M_1)\\right] + \\left[\\frac{2}{2}(1-1) - \\frac{2^3}{24}(M_1+M_2)\\right]$$\n$$\\int_0^3 S(x) dx = \\left(\\frac{1}{2} - \\frac{1}{24}(M_0+M_1)\\right) + \\left(0 - \\frac{8}{24}(M_1+M_2)\\right)$$\n$$\\int_0^3 S(x) dx = \\frac{1}{2} - \\frac{1}{24}M_0 - \\frac{1}{24}M_1 - \\frac{8}{24}M_1 - \\frac{8}{24}M_2$$\n$$\\int_0^3 S(x) dx = \\frac{1}{2} - \\frac{1}{24}(M_0 + 9M_1 + 8M_2)$$\nWe are given that $\\int_0^3 S(x) dx = \\frac{7}{16}$.\n$$\\frac{7}{16} = \\frac{1}{2} - \\frac{1}{24}(M_0 + 9M_1 + 8M_2)$$\n$$\\frac{1}{24}(M_0 + 9M_1 + 8M_2) = \\frac{1}{2} - \\frac{7}{16} = \\frac{8-7}{16} = \\frac{1}{16}$$\n$$M_0 + 9M_1 + 8M_2 = \\frac{24}{16} = \\frac{3}{2}$$\n\nNow, substitute the expressions for $M_0, M_1, M_2$ in terms of $v_2$ into this equation:\n$$\\left(\\frac{5}{3} + \\frac{1}{3}v_2\\right) + 9\\left(-\\frac{10}{3} - \\frac{2}{3}v_2\\right) + 8\\left(\\frac{19}{6} + \\frac{11}{6}v_2\\right) = \\frac{3}{2}$$\n$$\\frac{5}{3} + \\frac{1}{3}v_2 - 30 - 6v_2 + \\frac{76}{3} + \\frac{44}{3}v_2 = \\frac{3}{2}$$\nGroup terms with and without $v_2$:\n$$\\left(\\frac{5}{3} - 30 + \\frac{76}{3}\\right) + \\left(\\frac{1}{3} - 6 + \\frac{44}{3}\\right)v_2 = \\frac{3}{2}$$\n$$\\left(\\frac{81}{3} - 30\\right) + \\left(\\frac{45}{3} - 6\\right)v_2 = \\frac{3}{2}$$\n$$(27 - 30) + (15 - 6)v_2 = \\frac{3}{2}$$\n$$-3 + 9v_2 = \\frac{3}{2}$$\n$$9v_2 = 3 + \\frac{3}{2} = \\frac{9}{2}$$\n$$v_2 = \\frac{1}{9}\\left(\\frac{9}{2}\\right) = \\frac{1}{2}$$\nThus, the required derivative at $x=3$ is $S'(3) = 1/2$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2159088"}]}