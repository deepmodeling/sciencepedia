{"hands_on_practices": [{"introduction": "The foundation of the barycentric interpolation method lies in a set of pre-computed values called barycentric weights. These weights depend solely on the positions of the interpolation nodes, not the function values. This first exercise [@problem_id:2156180] will guide you through the process of calculating these fundamental weights, a crucial first step for any application of the formula.", "problem": "In numerical analysis, the barycentric interpolation formula is an efficient method for evaluating a polynomial that passes through a given set of points. A key component of this formula is the set of barycentric weights, which are pre-computed from the interpolation nodes.\n\nFor a set of $n+1$ distinct interpolation nodes $\\{x_0, x_1, \\ldots, x_n\\}$, the barycentric weights $w_j$ are defined by the formula:\n$$w_j = \\frac{1}{\\prod_{k=0, k \\neq j}^{n} (x_j - x_k)}$$\nfor $j = 0, 1, \\ldots, n$.\n\nConsider the specific case of polynomial interpolation using the following three nodes ($n=2$):\n$x_0 = -1$\n$x_1 = 0$\n$x_2 = 1$\n\nCalculate the corresponding barycentric weights $w_0$, $w_1$, and $w_2$. Present your answer as a row matrix with the elements ordered as $\\begin{pmatrix} w_0 & w_1 & w_2 \\end{pmatrix}$.", "solution": "We are given nodes $x_{0}=-1$, $x_{1}=0$, and $x_{2}=1$ and the barycentric weight definition\n$$\nw_{j}=\\frac{1}{\\prod_{k=0,\\,k\\neq j}^{2}\\left(x_{j}-x_{k}\\right)}\\quad\\text{for }j=0,1,2.\n$$\nCompute each product explicitly:\n\nFor $j=0$,\n$$\n\\prod_{k=0,\\,k\\neq 0}^{2}\\left(x_{0}-x_{k}\\right)=(x_{0}-x_{1})(x_{0}-x_{2})=(-1-0)(-1-1)=(-1)(-2)=2,\n$$\nhence\n$$\nw_{0}=\\frac{1}{2}.\n$$\n\nFor $j=1$,\n$$\n\\prod_{k=0,\\,k\\neq 1}^{2}\\left(x_{1}-x_{k}\\right)=(x_{1}-x_{0})(x_{1}-x_{2})=(0-(-1))(0-1)=(1)(-1)=-1,\n$$\nhence\n$$\nw_{1}=\\frac{1}{-1}=-1.\n$$\n\nFor $j=2$,\n$$\n\\prod_{k=0,\\,k\\neq 2}^{2}\\left(x_{2}-x_{k}\\right)=(x_{2}-x_{0})(x_{2}-x_{1})=(1-(-1))(1-0)=(2)(1)=2,\n$$\nhence\n$$\nw_{2}=\\frac{1}{2}.\n$$\n\nTherefore, the barycentric weights in the requested order are $\\begin{pmatrix}\\frac{1}{2} & -1 & \\frac{1}{2}\\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & -1 & \\frac{1}{2}\\end{pmatrix}}$$", "id": "2156180"}, {"introduction": "With the ability to calculate weights, we can now use the full second barycentric formula to perform interpolation. This practice [@problem_id:2156163] demonstrates how to combine the nodes, function values, and weights to estimate the value of the function at a new point. This is the core application of the method, showcasing its utility in practical modeling scenarios like sensor calibration.", "problem": "An engineer is calibrating a sensor that measures temperature. The sensor's output voltage is expected to be a smooth function of the temperature. During a calibration test, the following data points are recorded, relating the true temperature $T$ (in degrees Celsius) to the sensor's output voltage $V$ (in millivolts):\n- At $T_0 = 0 \\,^{\\circ}\\text{C}$, the voltage is $V_0 = 1$ mV.\n- At $T_1 = 1 \\,^{\\circ}\\text{C}$, the voltage is $V_1 = 4$ mV.\n- At $T_2 = 3 \\,^{\\circ}\\text{C}$, the voltage is $V_2 = 22$ mV.\n\nTo create a continuous model from these discrete measurements, a quadratic polynomial $V(T)$ is used to interpolate the data. Using the barycentric interpolation formula, determine the predicted voltage output of the sensor when the temperature is $T = 2 \\,^{\\circ}\\text{C}$.\n\nExpress your answer for the voltage in millivolts.", "solution": "We are given three data points $(T_{0},V_{0})=(0,1)$, $(T_{1},V_{1})=(1,4)$, and $(T_{2},V_{2})=(3,22)$ and we interpolate with a quadratic using the second-form barycentric interpolation formula. For nodes $x_{j}=T_{j}$ with values $y_{j}=V_{j}$, the barycentric weights are defined by\n$$\nw_{j}=\\frac{1}{\\prod_{k\\neq j}(x_{j}-x_{k})},\n$$\nand for any $x$ not equal to a node, the interpolant is\n$$\np(x)=\\frac{\\sum_{j=0}^{2}\\dfrac{w_{j}y_{j}}{x-x_{j}}}{\\sum_{j=0}^{2}\\dfrac{w_{j}}{x-x_{j}}}.\n$$\nWith $(x_{0},y_{0})=(0,1)$, $(x_{1},y_{1})=(1,4)$, $(x_{2},y_{2})=(3,22)$, the weights are\n$$\nw_{0}=\\frac{1}{(0-1)(0-3)}=\\frac{1}{3},\\quad\nw_{1}=\\frac{1}{(1-0)(1-3)}=-\\frac{1}{2},\\quad\nw_{2}=\\frac{1}{(3-0)(3-1)}=\\frac{1}{6}.\n$$\nWe evaluate at $x=2$. The needed differences are\n$$\n2-x_{0}=2,\\quad 2-x_{1}=1,\\quad 2-x_{2}=-1.\n$$\nCompute the denominator\n$$\nD=\\sum_{j=0}^{2}\\frac{w_{j}}{2-x_{j}}=\\frac{\\tfrac{1}{3}}{2}+\\frac{-\\tfrac{1}{2}}{1}+\\frac{\\tfrac{1}{6}}{-1}=\\frac{1}{6}-\\frac{1}{2}-\\frac{1}{6}=-\\frac{1}{2},\n$$\nand the numerator\n$$\nN=\\sum_{j=0}^{2}\\frac{w_{j}y_{j}}{2-x_{j}}=\\frac{\\tfrac{1}{3}\\cdot 1}{2}+\\frac{-\\tfrac{1}{2}\\cdot 4}{1}+\\frac{\\tfrac{1}{6}\\cdot 22}{-1}=\\frac{1}{6}-2-\\frac{11}{3}=-\\frac{11}{2}.\n$$\nTherefore,\n$$\np(2)=\\frac{N}{D}=\\frac{-\\tfrac{11}{2}}{-\\tfrac{1}{2}}=11.\n$$\nThus, the predicted sensor voltage at $T=2$ is $11$ millivolts.", "answer": "$$\\boxed{11}$$", "id": "2156163"}, {"introduction": "A careful look at the second barycentric formula reveals a potential issue: what happens if we try to evaluate the polynomial at one of the original nodes $x_k$? This would lead to division by zero in a naive implementation. This final practice [@problem_id:2156214] is a thought experiment that addresses this apparent singularity, revealing through a limiting process the elegant way the formula resolves to the expected value and highlighting an important consideration for writing robust code.", "problem": "In numerical analysis, the second barycentric formula provides a numerically stable way to evaluate the unique polynomial $p(x)$ of degree at most $n$ that interpolates a given set of $n+1$ data points $(x_0, y_0), (x_1, y_1), \\dots, (x_n, y_n)$, where the nodes $x_j$ are all distinct. The formula is given by:\n\n$$\np(x) = \\frac{\\sum_{j=0}^{n} \\frac{w_j}{x-x_j} y_j}{\\sum_{j=0}^{n} \\frac{w_j}{x-x_j}}\n$$\n\nHere, the $w_j$ are the barycentric weights, which depend only on the nodes $x_0, \\dots, x_n$ and are assumed to be non-zero.\n\nA student writes a computer program to implement this formula directly. They discover that when they try to evaluate the polynomial at one of the interpolation nodes, say $x_k$ where $k \\in \\{0, 1, \\dots, n\\}$, their program fails due to a division-by-zero error, as the term `1/(x-x_k)` becomes undefined. Mathematically, this corresponds to an indeterminate form of the type \"$\\infty/\\infty$\" or \"$0/0$\".\n\nDespite the apparent singularity in the formula, the interpolating polynomial $p(x)$ is well-defined everywhere. By analyzing the behavior of the formula in the vicinity of the node $x_k$, determine the mathematically correct value of $p(x_k)$. Your answer should be one of the symbolic parameters defined in the problem.", "solution": "We consider the second barycentric formula\n$$\np(x) = \\frac{\\sum_{j=0}^{n} \\frac{w_{j}}{x - x_{j}}\\, y_{j}}{\\sum_{j=0}^{n} \\frac{w_{j}}{x - x_{j}}}\n$$\nwith distinct nodes $x_{0},\\dots,x_{n}$ and nonzero weights $w_{j}$. To evaluate $p(x)$ at an interpolation node $x_{k}$, we analyze the limit as $x \\to x_{k}$. Split the sums into the term with $j=k$ and the remaining terms:\n$$\np(x) = \\frac{\\frac{w_{k}}{x - x_{k}}\\, y_{k} + \\sum_{j \\neq k} \\frac{w_{j}}{x - x_{j}}\\, y_{j}}{\\frac{w_{k}}{x - x_{k}} + \\sum_{j \\neq k} \\frac{w_{j}}{x - x_{j}}}.\n$$\nTo remove the apparent singularity at $x = x_{k}$, multiply numerator and denominator by $(x - x_{k})$:\n$$\np(x) = \\frac{w_{k} y_{k} + (x - x_{k}) \\sum_{j \\neq k} \\frac{w_{j}}{x - x_{j}}\\, y_{j}}{w_{k} + (x - x_{k}) \\sum_{j \\neq k} \\frac{w_{j}}{x - x_{j}}}.\n$$\nAs $x \\to x_{k}$, for each $j \\neq k$ we have $x - x_{j} \\to x_{k} - x_{j} \\neq 0$, hence\n$$\n\\lim_{x \\to x_{k}} \\frac{x - x_{k}}{x - x_{j}} = 0.\n$$\nTherefore,\n$$\n\\lim_{x \\to x_{k}} (x - x_{k}) \\sum_{j \\neq k} \\frac{w_{j}}{x - x_{j}}\\, y_{j} = 0\n\\quad \\text{and} \\quad\n\\lim_{x \\to x_{k}} (x - x_{k}) \\sum_{j \\neq k} \\frac{w_{j}}{x - x_{j}} = 0.\n$$\nTaking the limit gives\n$$\n\\lim_{x \\to x_{k}} p(x) = \\frac{w_{k} y_{k}}{w_{k}} = y_{k}.\n$$\nThus, the interpolating polynomial is continuous and satisfies $p(x_{k}) = y_{k}$, as required by interpolation.", "answer": "$$\\boxed{y_{k}}$$", "id": "2156214"}]}