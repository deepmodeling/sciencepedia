{"hands_on_practices": [{"introduction": "The most fundamental way to interpolate data is by connecting points with straight lines, creating a linear spline. This exercise provides an essential starting point by asking you to determine the equation for a single segment of such a spline. Mastering this simple case builds a strong foundation for understanding how more complex splines are constructed piece by piece. [@problem_id:2185130]", "problem": "A scientist is modeling the temperature distribution along a thin metal rod. Temperature measurements are taken at three distinct points. At position $x=0$ meters, the temperature is 1 degree Celsius. At position $x=1$ meter, the temperature is 4 degrees Celsius. At position $x=2$ meters, the temperature is 2 degrees Celsius.\n\nTo create a simple continuous model of the temperature, a linear spline is constructed using these three data points: $(0, 1)$, $(1, 4)$, and $(2, 2)$.\n\nLet $S(x)$ denote the linear spline function. Determine the analytical expression for the segment of the spline, let's call it $S_1(x)$, that is valid over the interval $[1, 2]$, where $x$ is the position in meters.", "solution": "A linear spline is a function constructed by connecting a series of data points with straight line segments. Each segment is a linear function valid over a specific interval. We are given the data points $(x_0, y_0) = (0, 1)$, $(x_1, y_1) = (1, 4)$, and $(x_2, y_2) = (2, 2)$.\n\nThe problem asks for the analytical expression for the segment of the spline on the interval $[1, 2]$. This interval is defined by the points $(x_1, y_1) = (1, 4)$ and $(x_2, y_2) = (2, 2)$. The spline segment, $S_1(x)$, is simply the equation of the straight line that passes through these two points.\n\nWe can find the equation of a line using the point-slope form, $y - y_a = m(x - x_a)$, where $m$ is the slope and $(x_a, y_a)$ is a point on the line.\n\nFirst, we calculate the slope $m$ of the line segment connecting $(1, 4)$ and $(2, 2)$:\n$$m = \\frac{y_2 - y_1}{x_2 - x_1}$$\nSubstituting the coordinates of the points:\n$$m = \\frac{2 - 4}{2 - 1} = \\frac{-2}{1} = -2$$\n\nNow we use the point-slope form with the slope $m=-2$ and one of the points, for instance, $(x_1, y_1) = (1, 4)$. The equation for the spline segment $S_1(x)$ is:\n$$S_1(x) - y_1 = m(x - x_1)$$\n$$S_1(x) - 4 = -2(x - 1)$$\n\nTo find the explicit expression for $S_1(x)$, we isolate it on one side of the equation:\n$$S_1(x) = -2(x - 1) + 4$$\nDistributing the $-2$:\n$$S_1(x) = -2x + 2 + 4$$\nCombining the constant terms:\n$$S_1(x) = -2x + 6$$\n\nThis is the analytical expression for the spline segment valid on the interval $[1, 2]$. We can verify this result using the other point, $(2, 2)$:\n$$S_1(2) = -2(2) + 6 = -4 + 6 = 2$$\nSince the function correctly evaluates to $y=2$ at $x=2$, our expression is correct.", "answer": "$$\\boxed{-2x + 6}$$", "id": "2185130"}, {"introduction": "While linear splines are simple, they lack the smoothness often required in applications like robotics or animation. This practice introduces quadratic splines, which ensure the resulting curve has a continuous first derivative ($C^1$ continuity) at the knots, creating a visibly smoother path. You will explore how to use interpolation points, continuity constraints, and boundary conditions to uniquely determine the coefficients of a quadratic spline segment. [@problem_id:2185128]", "problem": "A quadratic spline $S(x)$ is used to model a smooth path through a series of waypoints. The spline consists of piecewise quadratic polynomials. For a set of knots $x_0 < x_1 < \\dots < x_n$, the spline on each subinterval $[x_i, x_{i+1}]$ is represented by a quadratic polynomial $S_i(x) = a_i(x-x_i)^2 + b_i(x-x_i) + c_i$.\n\nConsider a path that must pass through the three waypoints $(x_0, y_0) = (0, 1)$, $(x_1, y_1) = (1, 2)$, and $(x_2, y_2) = (2, 0)$. This path is defined by a quadratic spline $S(x)$ with two pieces: $S_0(x)$ on the interval $[0, 1]$ and $S_1(x)$ on $[1, 2]$.\n\nThe spline must satisfy the following conditions:\n1.  It must interpolate the waypoints, meaning $S(x_i) = y_i$ for $i=0, 1, 2$.\n2.  The spline must have a continuous first derivative at the interior knot $x_1$, meaning $S'_0(x_1) = S'_1(x_1)$.\n3.  A \"natural\" starting condition is imposed, such that the second derivative at the starting point is zero: $S''(0) = 0$.\n\nDetermine the coefficients $(a_1, b_1, c_1)$ for the second segment of the spline, $S_1(x)$, which is defined for $x \\in [1, 2]$. Present the answer as a set of three numerical values in the order $(a_1, b_1, c_1)$.", "solution": "We model each segment by $S_{i}(x)=a_{i}(x-x_{i})^{2}+b_{i}(x-x_{i})+c_{i}$.\n\nFor the first segment on $[0,1]$, $S_{0}(x)=a_{0}x^{2}+b_{0}x+c_{0}$.\nThe natural condition $S''(0)=0$ implies $S_{0}''(x)=2a_{0}$, hence\n$$\n2a_{0}=0 \\;\\Rightarrow\\; a_{0}=0.\n$$\nInterpolation at $x=0$ gives $S_{0}(0)=c_{0}=1$, so\n$$\nc_{0}=1.\n$$\nInterpolation at $x=1$ gives $S_{0}(1)=a_{0}\\cdot 1^{2}+b_{0}\\cdot 1+c_{0}=2$, hence\n$$\n0+b_{0}+1=2 \\;\\Rightarrow\\; b_{0}=1.\n$$\nThus $S_{0}'(x)=2a_{0}(x-0)+b_{0}=b_{0}=1$, so\n$$\nS_{0}'(1)=1.\n$$\n\nFor the second segment on $[1,2]$, $S_{1}(x)=a_{1}(x-1)^{2}+b_{1}(x-1)+c_{1}$.\nInterpolation at $x=1$ gives\n$$\nS_{1}(1)=c_{1}=2 \\;\\Rightarrow\\; c_{1}=2.\n$$\nInterpolation at $x=2$ gives\n$$\nS_{1}(2)=a_{1}\\cdot 1^{2}+b_{1}\\cdot 1+c_{1}=0 \\;\\Rightarrow\\; a_{1}+b_{1}+2=0 \\;\\Rightarrow\\; a_{1}+b_{1}=-2.\n$$\nDerivative continuity at $x=1$ requires $S_{0}'(1)=S_{1}'(1)$. Since $S_{1}'(x)=2a_{1}(x-1)+b_{1}$, we have\n$$\nS_{1}'(1)=b_{1}=S_{0}'(1)=1 \\;\\Rightarrow\\; b_{1}=1.\n$$\nSubstituting into $a_{1}+b_{1}=-2$ gives\n$$\na_{1}+1=-2 \\;\\Rightarrow\\; a_{1}=-3.\n$$\nTogether with $c_{1}=2$, the coefficients for $S_{1}$ are $(a_{1},b_{1},c_{1})=(-3,1,2)$.", "answer": "$$\\boxed{\\begin{pmatrix}-3 & 1 & 2\\end{pmatrix}}$$", "id": "2185128"}, {"introduction": "Spline interpolation is a powerful tool for modeling and analyzing data from real-world systems. In this comprehensive exercise, you will apply your skills to a practical scenario from power systems engineering, modeling a solar panel's output. The task involves not only constructing a complete, multi-segment quadratic spline from measured data but also analyzing the resulting model to find its maximum value, demonstrating how splines are used to extract critical insights. [@problem_id:2185163]", "problem": "A Microgrid Power Management System (MPMS) is used to model the net power output of a small-scale solar energy system over an 8-hour period, from $t=0$ (start of workday) to $t=8$ hours. To create a continuous power model, $P(t)$, from discrete measurements, a quadratic spline interpolant $S(t)$ is constructed.\n\nThe spline is defined over the interval $[0, 8]$ with knots at $t_0=0, t_1=3, t_2=5,$ and $t_3=8$. The measured power values (in kilowatts, kW) at these knots are:\n$P(0) = 10$\n$P(3) = 80$\n$P(5) = 90$\n$P(8) = 45$\n\nThe quadratic spline $S(t)$ is composed of three quadratic polynomials, $S_0(t)$, $S_1(t)$, and $S_2(t)$, for the intervals $[0, 3]$, $[3, 5]$, and $[5, 8]$, respectively. The construction of the spline follows these rules:\n1. Interpolation: The spline must pass through all the measured data points, i.e., $S(t_i) = P(t_i)$ for $i=0, 1, 2, 3$.\n2. Smoothness: The spline must have a continuous first derivative, $S'(t)$, across the interior knots (at $t=3$ and $t=5$).\n3. Boundary Condition: At the beginning of the period, the power is known to be increasing at a rate of 20 kW per hour, i.e., $S'(0) = 20$.\n\nYour task is to analyze this power model. Determine the time $t_{max}$ in hours and the value of the maximum power $P_{max}$ in kW. Round both values to four significant figures.", "solution": "The quadratic spline $S(t)$ is defined piecewise. For each subinterval $[t_i, t_{i+1}]$, the corresponding piece $S_i(t)$ can be written in the form:\n$$S_i(t) = a_i (t-t_i)^2 + b_i(t-t_i) + c_i$$\nThis form is convenient because the coefficients have direct meaning: $c_i = S_i(t_i)$ and $b_i = S'_i(t_i)$.\n\n**Step 1: Determine the spline coefficients.**\nWe are given the knots $t_0=0, t_1=3, t_2=5, t_3=8$ and the corresponding values $y_0=10, y_1=80, y_2=90, y_3=45$. The interval lengths are $h_0=t_1-t_0=3$, $h_1=t_2-t_1=2$, and $h_2=t_3-t_2=3$.\n\nFrom the interpolation condition $S(t_i)=y_i$ and the form of $S_i(t)$, we immediately have $c_i = S_i(t_i) = y_i$.\nSo, $c_0 = y_0 = 10$, $c_1 = y_1 = 80$, and $c_2 = y_2 = 90$.\n\nFrom the derivative continuity condition $S'_i(t_i) = b_i$, we can establish a recurrence relation for the $b_i$ coefficients. The derivative of a piece is $S'_i(t) = 2a_i(t-t_i) + b_i$.\nThe continuity of the spline function itself requires $S_i(t_{i+1}) = y_{i+1}$.\n$$a_i h_i^2 + b_i h_i + c_i = y_{i+1} \\implies a_i = \\frac{y_{i+1} - y_i - b_i h_i}{h_i^2}$$\nThe continuity of the first derivative at an interior knot $t_i$ means $S'_{i-1}(t_i) = S'_i(t_i)$.\nThe derivative at the right end of interval $i-1$ is $S'_{i-1}(t_i) = 2a_{i-1}(t_i - t_{i-1}) + b_{i-1} = 2a_{i-1}h_{i-1} + b_{i-1}$.\nThe derivative at the left end of interval $i$ is $S'_i(t_i) = b_i$.\nThus, $b_i = 2a_{i-1}h_{i-1} + b_{i-1}$.\nSubstituting the expression for $a_{i-1}$:\n$$b_i = 2 \\left( \\frac{y_i - y_{i-1} - b_{i-1}h_{i-1}}{h_{i-1}^2} \\right) h_{i-1} + b_{i-1}$$\n$$b_i = \\frac{2(y_i - y_{i-1})}{h_{i-1}} - 2b_{i-1} + b_{i-1}$$\nThis simplifies to the recurrence relation: $b_i + b_{i-1} = \\frac{2(y_i - y_{i-1})}{h_{i-1}}$.\n\nWe are given the boundary condition $S'(0) = 20$. Since $t_0=0$, this means $b_0 = S'_0(t_0) = 20$.\nWe can now find the other $b_i$ coefficients:\nFor $i=1$ (at knot $t_1=3$):\n$$b_1 + b_0 = \\frac{2(y_1 - y_0)}{h_0} \\implies b_1 + 20 = \\frac{2(80-10)}{3} = \\frac{140}{3}$$\n$$b_1 = \\frac{140}{3} - 20 = \\frac{140-60}{3} = \\frac{80}{3}$$\n\nFor $i=2$ (at knot $t_2=5$):\n$$b_2 + b_1 = \\frac{2(y_2 - y_1)}{h_1} \\implies b_2 + \\frac{80}{3} = \\frac{2(90-80)}{2} = 10$$\n$$b_2 = 10 - \\frac{80}{3} = \\frac{30-80}{3} = -\\frac{50}{3}$$\n\nNow we find the remaining $a_i$ coefficients:\n$$a_0 = \\frac{y_1 - y_0 - b_0 h_0}{h_0^2} = \\frac{80-10 - 20(3)}{3^2} = \\frac{70-60}{9} = \\frac{10}{9}$$\n$$a_1 = \\frac{y_2 - y_1 - b_1 h_1}{h_1^2} = \\frac{90-80 - (\\frac{80}{3})(2)}{2^2} = \\frac{10 - \\frac{160}{3}}{4} = \\frac{\\frac{30-160}{3}}{4} = \\frac{-130/3}{4} = -\\frac{130}{12} = -\\frac{65}{6}$$\n$$a_2 = \\frac{y_3 - y_2 - b_2 h_2}{h_2^2} = \\frac{45-90 - (-\\frac{50}{3})(3)}{3^2} = \\frac{-45 + 50}{9} = \\frac{5}{9}$$\n\n**Step 2: Find the global maximum of S(t) on [0, 8].**\nThe global maximum must occur at either the endpoints of the interval $[0, 8]$ or at an interior point where the derivative is zero. The candidate points for the maximum are:\n1. The endpoints of the entire interval: $t=0$ and $t=8$.\n2. The interior knots where the defining polynomial changes: $t=3$ and $t=5$.\n3. The critical points of each quadratic piece, if they fall within their respective subintervals.\n\nThe values at the endpoints and knots are given:\n$P(0) = 10$, $P(3) = 80$, $P(5) = 90$, $P(8) = 45$.\n\nNow, we check for critical points within each piece by setting the derivative to zero.\nFor $S_0(t)$ on $[0, 3]$:\n$S'_0(t) = 2a_0(t-t_0) + b_0 = 2(\\frac{10}{9})t + 20$. Setting $S'_0(t)=0$ gives $t = -9$, which is outside $[0, 3]$. Since $a_0 > 0$, the parabola opens upwards, so the maximum on this subinterval occurs at the right endpoint, $P(3)=80$.\n\nFor $S_1(t)$ on $[3, 5]$:\n$S'_1(t) = 2a_1(t-t_1) + b_1 = 2(-\\frac{65}{6})(t-3) + \\frac{80}{3} = -\\frac{65}{3}(t-3) + \\frac{80}{3}$.\nSetting $S'_1(t)=0$:\n$$-\\frac{65}{3}(t-3) = -\\frac{80}{3} \\implies 65(t-3) = 80 \\implies t-3 = \\frac{80}{65} = \\frac{16}{13}$$\n$$t_{crit} = 3 + \\frac{16}{13} = \\frac{39+16}{13} = \\frac{55}{13}$$\nThis time is in the interval $[3, 5]$ since $3 < 55/13 \\approx 4.23 < 5$. Since $a_1 = -65/6 < 0$, the parabola opens downwards, so this critical point is a local maximum. We calculate its value:\n$P_{crit} = S_1(\\frac{55}{13}) = a_1(\\frac{16}{13})^2 + b_1(\\frac{16}{13}) + c_1 = -\\frac{65}{6}(\\frac{16}{13})^2 + \\frac{80}{3}(\\frac{16}{13}) + 80$\n$P_{crit} = -\\frac{65}{6}\\frac{256}{169} + \\frac{1280}{39} + 80 = -\\frac{5 \\cdot 13}{2 \\cdot 3}\\frac{256}{13^2} + \\frac{1280}{39} + 80$\n$P_{crit} = -\\frac{5 \\cdot 256}{78} + \\frac{1280}{39} + 80 = -\\frac{640}{39} + \\frac{1280}{39} + \\frac{3120}{39} = \\frac{-640 + 1280 + 3120}{39} = \\frac{3760}{39}$.\n\nFor $S_2(t)$ on $[5, 8]$:\n$S'_2(t) = 2a_2(t-t_2) + b_2 = 2(\\frac{5}{9})(t-5) - \\frac{50}{3} = \\frac{10}{9}(t-5) - \\frac{50}{3}$.\nSetting $S'_2(t)=0$: $\\frac{10}{9}(t-5) = \\frac{50}{3} \\implies t-5 = \\frac{50}{3} \\cdot \\frac{9}{10} = 15$.\n$t=20$, which is outside $[5, 8]$. Since $a_2 > 0$, this parabola opens upwards, so its maximum on this subinterval is at an endpoint, $P(5)=90$.\n\n**Step 3: Compare candidate values and determine the global maximum.**\nThe candidate values for the maximum power are:\n$P(0) = 10$\n$P(3) = 80$\n$P(5) = 90$\n$P(8) = 45$\n$P(55/13) = \\frac{3760}{39} \\approx 96.410256...$\n\nComparing these values, the global maximum is $P_{max} = \\frac{3760}{39}$, which occurs at $t_{max} = \\frac{55}{13}$.\n\n**Step 4: Format the final answer.**\nThe problem asks for numerical values rounded to four significant figures.\n$t_{max} = \\frac{55}{13} \\approx 4.230769...$\nRounding to four significant figures gives $t_{max} = 4.231$.\n\n$P_{max} = \\frac{3760}{39} \\approx 96.410256...$\nRounding to four significant figures gives $P_{max} = 96.41$.", "answer": "$$\\boxed{\\begin{pmatrix} 4.231 & 96.41 \\end{pmatrix}}$$", "id": "2185163"}]}