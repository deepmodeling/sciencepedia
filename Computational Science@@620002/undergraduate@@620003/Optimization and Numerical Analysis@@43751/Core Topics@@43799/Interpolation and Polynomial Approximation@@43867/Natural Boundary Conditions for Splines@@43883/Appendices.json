{"hands_on_practices": [{"introduction": "This first exercise is about mastering the fundamental mechanics of spline interpolation. You will take a discrete set of data points and translate them into the specific system of linear equations that defines the natural cubic spline passing through them. This practice is essential for understanding how the abstract spline theory is applied to solve concrete numerical problems. [@problem_id:2193878]", "problem": "In computational modeling, a cubic spline is a powerful tool for interpolating a set of data points with a smooth curve. A function $s(x)$ is a cubic spline that interpolates the $n+1$ data points $(x_0, y_0), (x_1, y_1), \\dots, (x_n, y_n)$ if it is a piecewise cubic polynomial that passes through all the points and has continuous first and second derivatives at the interior points $x_1, \\dots, x_{n-1}$.\n\nLet $M_i = s''(x_i)$ be the second derivative of the spline at the point $x_i$, and let $h_i = x_{i+1} - x_i$ be the spacing between consecutive points. The values of $M_i$ for the interior points ($i=1, \\dots, n-1$) are related by the following system of linear equations:\n$$ \\frac{h_{i-1}}{6} M_{i-1} + \\frac{h_{i-1} + h_i}{3} M_i + \\frac{h_i}{6} M_{i+1} = \\frac{y_{i+1} - y_i}{h_i} - \\frac{y_i - y_{i-1}}{h_{i-1}} $$\nA \"natural\" cubic spline is defined by the additional boundary conditions $M_0 = 0$ and $M_n = 0$. These conditions physically correspond to the ends of a flexible beam being free from bending moments.\n\nConsider the task of finding a natural cubic spline that interpolates the following four data points: $(0, 1)$, $(1, 3)$, $(3, 2)$, and $(4, 4)$. The conditions give rise to a system of linear equations for the unknown internal second derivatives, $M_1$ and $M_2$. This system can be written in matrix form as $\\mathbf{A} \\mathbf{M} = \\mathbf{b}$, where $\\mathbf{M} = \\begin{pmatrix} M_1 \\\\ M_2 \\end{pmatrix}$, $\\mathbf{A}$ is a $2 \\times 2$ coefficient matrix, and $\\mathbf{b}$ is a $2 \\times 1$ constant vector.\n\nDetermine the numerical values for the entries of the matrix $\\mathbf{A} = \\begin{pmatrix} a_{11}  a_{12} \\\\ a_{21}  a_{22} \\end{pmatrix}$ and the vector $\\mathbf{b} = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$. Present your final answer as a single row matrix containing the six values in the order $(a_{11}, a_{12}, a_{21}, a_{22}, b_1, b_2)$.", "solution": "We are given the cubic spline tridiagonal relation for interior points:\n$$\\frac{h_{i-1}}{6}M_{i-1}+\\frac{h_{i-1}+h_{i}}{3}M_{i}+\\frac{h_{i}}{6}M_{i+1}=\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}},$$\nwith natural boundary conditions $M_{0}=0$ and $M_{3}=0$ for the points $(x_{0},y_{0})=(0,1)$, $(x_{1},y_{1})=(1,3)$, $(x_{2},y_{2})=(3,2)$, $(x_{3},y_{3})=(4,4)$.\n\nFirst compute the spacings:\n$$h_{0}=x_{1}-x_{0}=1,\\quad h_{1}=x_{2}-x_{1}=2,\\quad h_{2}=x_{3}-x_{2}=1.$$\n\nFor $i=1$:\n$$\\frac{h_{0}}{6}M_{0}+\\frac{h_{0}+h_{1}}{3}M_{1}+\\frac{h_{1}}{6}M_{2}=\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}.$$\nSubstitute values:\n$$\\frac{1}{6}M_{0}+\\frac{1+2}{3}M_{1}+\\frac{2}{6}M_{2}=\\frac{2-3}{2}-\\frac{3-1}{1},$$\n$$0+1\\cdot M_{1}+\\frac{1}{3}M_{2}=-\\frac{1}{2}-2=-\\frac{5}{2}.$$\nThus the first row is $a_{11}=1$, $a_{12}=\\frac{1}{3}$ and $b_{1}=-\\frac{5}{2}$.\n\nFor $i=2$:\n$$\\frac{h_{1}}{6}M_{1}+\\frac{h_{1}+h_{2}}{3}M_{2}+\\frac{h_{2}}{6}M_{3}=\\frac{y_{3}-y_{2}}{h_{2}}-\\frac{y_{2}-y_{1}}{h_{1}}.$$\nSubstitute values:\n$$\\frac{2}{6}M_{1}+\\frac{2+1}{3}M_{2}+\\frac{1}{6}M_{3}=\\frac{4-2}{1}-\\frac{2-3}{2},$$\n$$\\frac{1}{3}M_{1}+1\\cdot M_{2}+0=2-(-\\frac{1}{2})=\\frac{5}{2}.$$\nThus the second row is $a_{21}=\\frac{1}{3}$, $a_{22}=1$ and $b_{2}=\\frac{5}{2}$.\n\nTherefore,\n$$A=\\begin{pmatrix}1  \\frac{1}{3} \\\\ \\frac{1}{3}  1\\end{pmatrix},\\quad \\mathbf{b}=\\begin{pmatrix}-\\frac{5}{2} \\\\ \\frac{5}{2}\\end{pmatrix},$$\nso the requested single row matrix is $\\begin{pmatrix}1  \\frac{1}{3}  \\frac{1}{3}  1  -\\frac{5}{2}  \\frac{5}{2}\\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix}1  \\frac{1}{3}  \\frac{1}{3}  1  -\\frac{5}{2}  \\frac{5}{2}\\end{pmatrix}}$$", "id": "2193878"}, {"introduction": "Now that we can construct a spline, let's investigate its geometric properties. This problem explores the connection between the positions of the data points and the resulting shape of the curve, specifically whether it has local extrema. By analyzing how a single point's coordinate influences the spline's derivative, you will gain deeper insight into how splines respond to data geometry. [@problem_id:2189213]", "problem": "A natural cubic spline, denoted by $S(x)$, is constructed to interpolate three non-collinear points $P_0 = (x_0, y_0)$, $P_1 = (x_1, y_1)$, and $P_2 = (x_2, y_2)$. The spline consists of two cubic polynomial pieces, one for the interval $[x_0, x_1]$ and one for $[x_1, x_2]$, joined smoothly. The \"natural\" condition specifies that the second derivatives of the spline are zero at the endpoints of the entire interval, i.e., $S''(x_0) = 0$ and $S''(x_2) = 0$.\n\nConsider the specific set of points $P_0 = (-1, 1)$, $P_1 = (0, 0)$, and $P_2 = (2, c)$, where $c$ is a real-valued constant. The non-collinearity condition implies that $c$ cannot take a specific value that would place $P_2$ on the line defined by $P_0$ and $P_1$.\n\nDetermine the set of all possible values for the constant $c$ such that the resulting natural cubic spline $S(x)$ possesses at least one local extremum (a point $x^*$ where $S'(x^*) = 0$) strictly within the open interval $(-1, 2)$.\n\nSelect the correct option that describes the set of values for $c$.\n\nA. $c  -14$ or $c > -1/2$\n\nB. $-14  c  -1/2$\n\nC. $c  -2$ or $c > -2$\n\nD. $c  -2$ or $c > -1/14$\n\nE. The spline never has an extremum in $(-1, 2)$ for any value of $c$.", "solution": "Let $x_{0}=-1$, $x_{1}=0$, $x_{2}=2$, with $y_{0}=1$, $y_{1}=0$, $y_{2}=c$. For the natural cubic spline, set $M_{i}=S''(x_{i})$. The natural conditions give $M_{0}=0$ and $M_{2}=0$. The standard tridiagonal system for $M_{1}$ is\n$$\nh_{0}M_{0}+2(h_{0}+h_{1})M_{1}+h_{1}M_{2}=6\\left(\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}\\right),\n$$\nwhere $h_{0}=x_{1}-x_{0}=1$ and $h_{1}=x_{2}-x_{1}=2$. Substituting yields\n$$\nM_{0}+6M_{1}+2M_{2}=6\\left(\\frac{c}{2}-(-1)\\right)=3c+6,\n$$\nhence $6M_{1}=3c+6$, so\n$$\nM_{1}=1+\\frac{c}{2}=:m.\n$$\n\nOn $[x_{0},x_{1}]$, using the standard cubic spline form with $h=1$, $M_{0}=0$, $M_{1}=m$, $y_{0}=1$, $y_{1}=0$, we obtain\n$$\nS_{0}(x)=\\frac{m}{6}(x+1)^{3}-x-\\frac{m}{6}(x+1),\n$$\nso\n$$\nS_{0}'(x)=\\frac{m}{6}\\left(3(x+1)^{2}-1\\right)-1=\\frac{m}{2}(x+1)^{2}-\\frac{m}{6}-1.\n$$\nSetting $S_{0}'(x)=0$ gives\n$$\n(x+1)^{2}=\\frac{2}{m}+\\frac{1}{3}=:R_{L}.\n$$\nA root lies in $(-1,0)$ if and only if $0R_{L}1$, i.e.,\n$$\n0\\frac{2}{m}+\\frac{1}{3}1.\n$$\nSolve by cases:\n\n- If $m0$, then $\\frac{2}{m}0$, hence the left inequality holds automatically; the right inequality gives $\\frac{2}{m}\\frac{2}{3}$, so $m3$, i.e., $c4$. At $m=3$ (i.e., $c=4$), $R_{L}=1$ yields $x=0$, which is in $(-1,2)$ and gives a stationary point at the knot.\n\n- If $m0$, then $0\\frac{2}{m}+\\frac{1}{3}$ implies $\\frac{2}{m}-\\frac{1}{3}$; multiplying by $m0$ reverses the inequality to $2-\\frac{m}{3}$, i.e., $m-6$, equivalently $c-14$. The upper inequality is automatic for $m0$.\n\nThus, from the left interval, an interior stationary point exists if $c-14$ or $c\\geq 4$ (with $c=4$ yielding $x^{*}=0$).\n\nOn $[x_{1},x_{2}]$, with $h=2$, $M_{1}=m$, $M_{2}=0$, $y_{1}=0$, $y_{2}=c$,\n$$\nS_{1}(x)=\\frac{m}{12}(2-x)^{3}-\\frac{m}{3}(2-x)+\\frac{c}{2}x,\n$$\nso\n$$\nS_{1}'(x)=-\\frac{m}{4}(2-x)^{2}+\\frac{m}{3}+\\frac{c}{2}.\n$$\nSetting $S_{1}'(x)=0$ yields\n$$\n(2-x)^{2}=\\frac{4}{m}\\left(\\frac{m}{3}+\\frac{c}{2}\\right)=\\frac{4(1+2c)}{3m}=:R_{R}.\n$$\nA root lies in $(0,2)$ if and only if $0R_{R}4$, i.e.,\n$$\n0\\frac{1+2c}{m}3.\n$$\nLet $n=1+2c$ and recall $m=1+\\frac{c}{2}$. Consider intervals of $c$:\n\n- If $c-2$, then $m0$ and $n0$, so $\\frac{n}{m}0$. The inequality $\\frac{n}{m}3$ becomes $n3m$ (since $m0$), i.e., $(1+2c)3(1+\\frac{c}{2})$, which simplifies to $\\frac{c}{2}-20$, i.e., $c4$, impossible here. Hence no root in $(0,2)$ for $c-2$.\n\n- If $-2c-\\frac{1}{2}$, then $m0$ and $n0$, so $\\frac{n}{m}0$, violating positivity; no root.\n\n- If $c-\\frac{1}{2}$, then $m0$ and $n0$, so positivity holds; the bound $\\frac{n}{m}3$ requires $1+2c3(1+\\frac{c}{2})$, i.e., $\\frac{c}{2}-20$, hence $c4$. Therefore there is a root in $(0,2)$ for $-\\frac{1}{2}c4$. At $c=4$, we get $(2-x)^{2}=4$, giving $x=0$ or $x=4$; $x=0$ lies in $(-1,2)$ and is a stationary point at the knot. At $c=-\\frac{1}{2}$, $(2-x)^{2}=0$ gives $x=2$, which is not in $(0,2)$.\n\nCombining both intervals, a stationary point in $(-1,2)$ exists for $c-14$ (left interval), for $-\\frac{1}{2}c4$ (right interval), and also at $c=4$ (stationary at $x=0$). Hence the union is $c-14$ or $c-\\frac{1}{2}$. The excluded collinear case $c=-2$ is not in this union. Therefore the correct option is A.\n\nFinally, since $S''$ at the stationary points is nonzero in the above ranges (left: $S_{0}''(x)=m(x+1)$ with $m3$ or $m-6$ and $x+10$; right: $S_{1}''(x)=\\frac{m}{2}(2-x)$ with $m0$ and $0x2$), these stationary points are indeed local extrema.", "answer": "$$\\boxed{A}$$", "id": "2189213"}, {"introduction": "A crucial question in interpolation is whether the resulting curve faithfully represents the data's trends. This final exercise confronts a classic phenomenon known as \"overshoot,\" where a spline can introduce oscillations not present in the original data. You will determine the precise condition under which a spline interpolating a strictly increasing dataset develops a local extremum, thus violating the data's monotonicity. [@problem_id:2189238]", "problem": "In applications such as computer-aided geometric design and data visualization, it is often desirable that an interpolating curve preserves the shape of the data. For instance, if a set of data points is monotonically increasing, one might hope the interpolating curve is also monotonic. However, this is not always guaranteed with standard methods like cubic splines.\n\nConsider four points $(x_0, y_0), (x_1, y_1), (x_2, y_2), (x_3, y_3)$ with strictly increasing ordinates $y_0  y_1  y_2  y_3$. A natural cubic spline, denoted by $S(x)$, is used to interpolate these points. A natural cubic spline is a piecewise cubic polynomial that passes through the given points and has its second derivative equal to zero at the endpoints of the interpolation interval.\n\nLet the knots be fixed at $x_0=0, x_1=1, x_2=2,$ and $x_3=3$. The first three ordinates are given as $y_0=0, y_1=10,$ and $y_2=11.5$. The fourth ordinate is a parameter, $y_3=k$, where $k$ is a real number such that the data remains strictly increasing (i.e., $k  11.5$).\n\nIt is found that for a certain range of $k$, the resulting spline $S(x)$ exhibits non-monotonic behavior (an \"overshoot\") in the vicinity of the knot $x_2$. Determine the specific value of $k$ for which the spline's derivative at the knot $x_2=2$ is exactly zero, i.e., $S'(2)=0$.\n\nExpress your answer as an exact fraction.", "solution": "Let $M_{i}=S''(x_{i})$ be the spline’s second derivatives at the knots. For a natural cubic spline with uniform spacing $h_{i}=x_{i+1}-x_{i}=1$, the interior moments satisfy, for $i=1,2$,\n$$\nh_{i-1}M_{i-1}+2(h_{i-1}+h_{i})M_{i}+h_{i}M_{i+1}\n=6\\left(\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}}\\right),\n$$\nwith $M_{0}=M_{3}=0$.\n\nHere $x_{0}=0,x_{1}=1,x_{2}=2,x_{3}=3$, $y_{0}=0$, $y_{1}=10$, $y_{2}=\\frac{23}{2}$, $y_{3}=k$, and $h_{0}=h_{1}=h_{2}=1$. Thus the system becomes\n$$\n4M_{1}+M_{2}=6\\left(\\frac{23}{2}-10- (10-0)\\right)=6\\left(\\frac{3}{2}-10\\right)=-51,\n$$\n$$\nM_{1}+4M_{2}=6\\left(k-\\frac{23}{2}-\\left(\\frac{23}{2}-10\\right)\\right)=6\\left(k-13\\right)=6k-78,\n$$\nwith $M_{0}=M_{3}=0$.\n\nSolving, from the first equation $M_{2}=-51-4M_{1}$. Substituting into the second,\n$$\nM_{1}+4(-51-4M_{1})=6k-78\n\\;\\Rightarrow\\;\n-15M_{1}=6k+126\n\\;\\Rightarrow\\;\nM_{1}=-\\frac{2k+42}{5}.\n$$\nThen\n$$\nM_{2}=-51-4\\left(-\\frac{2k+42}{5}\\right)=\\frac{8k-87}{5}.\n$$\n\nThe derivative of the cubic spline at an interior knot $x_{i+1}$ from the left (interval $[x_{i},x_{i+1}]$ with spacing $h_i$) is\n$$\nS'(x_{i+1}^{-})=\\frac{y_{i+1}-y_i}{h_i}+\\frac{h_i M_{i}}{6}+\\frac{h_i M_{i+1}}{3}.\n$$\nAt $x_{2}$ (i.e., $i=1$), and using $h_1=1$, this gives\n$$\nS'(2)=(y_{2}-y_{1})+\\frac{M_{1}}{6}+\\frac{M_{2}}{3}.\n$$\nUsing $y_{2}-y_{1}=\\frac{23}{2}-10=\\frac{3}{2}$ and the expressions for $M_{1},M_{2}$,\n$$\n0=S'(2)=\\frac{3}{2}+\\frac{1}{6}\\left(-\\frac{2k+42}{5}\\right)+\\frac{1}{3}\\left(\\frac{8k-87}{5}\\right)\n=\\frac{3}{2}-\\frac{k+21}{15}+\\frac{8k-87}{15}\n=\\frac{3}{2}+\\frac{7k-108}{15}.\n$$\nMultiplying by $30$,\n$$\n45+2(7k-108)=0 \\;\\Rightarrow\\; 45+14k-216=0 \\;\\Rightarrow\\; 14k=171 \\;\\Rightarrow\\; k=\\frac{171}{14}.\n$$\nThis value satisfies $k11.5$, so the data remain strictly increasing.", "answer": "$$\\boxed{\\frac{171}{14}}$$", "id": "2189238"}]}