{"hands_on_practices": [{"introduction": "The journey into multidimensional numerical integration begins with extending familiar one-dimensional rules. This practice demonstrates the application of the composite Midpoint rule to a triple integral over a simple cubic domain, $I = \\iiint_R f(x,y,z) \\,dV$. By partitioning the volume and evaluating the function at the center of each sub-cube, you will practice the foundational technique of grid-based numerical integration in three dimensions [@problem_id:2191981].", "problem": "A scalar field is defined in a three-dimensional region by the function $f(x,y,z) = x^2 y \\exp(z)$. We are interested in the value of the triple integral of this function over the cubic region $R$ defined by the inequalities $0 \\le x \\le 1$, $0 \\le y \\le 1$, and $0 \\le z \\le 1$.\n\nUse the composite Midpoint rule to estimate the value of the integral $I = \\iiint_R f(x,y,z) \\,dV$. The estimation should be based on a partition of the region $R$ into smaller identical cubes, using 2 divisions along the x-axis, 2 divisions along the y-axis, and 2 divisions along the z-axis.\n\nProvide the estimated value of the integral as a single closed-form analytic expression.", "solution": "We apply the composite Midpoint rule in three dimensions. Partition the unit cube $R=[0,1]^{3}$ into $2 \\times 2 \\times 2$ identical subcubes. The step sizes are $h_{x}=\\frac{1}{2}$, $h_{y}=\\frac{1}{2}$, and $h_{z}=\\frac{1}{2}$, so each subcube has volume $\\Delta V=h_{x}h_{y}h_{z}=\\frac{1}{8}$. The midpoints along each axis are $x^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$, $y^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$, and $z^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$.\n\nThe composite Midpoint rule gives\n$$\nI \\approx \\sum_{i=1}^{2}\\sum_{j=1}^{2}\\sum_{k=1}^{2} f\\!\\left(x_{i}^{*},y_{j}^{*},z_{k}^{*}\\right)\\,\\Delta V.\n$$\nSince $f(x,y,z)=x^{2}y\\exp(z)$ is separable, the sum factorizes:\n$$\n\\sum_{i,j,k} f\\!\\left(x_{i}^{*},y_{j}^{*},z_{k}^{*}\\right)\n=\\left(\\sum_{i=1}^{2} \\left(x_{i}^{*}\\right)^{2}\\right)\\left(\\sum_{j=1}^{2} y_{j}^{*}\\right)\\left(\\sum_{k=1}^{2} \\exp\\!\\left(z_{k}^{*}\\right)\\right).\n$$\nCompute each factor:\n$$\n\\sum_{i=1}^{2} \\left(x_{i}^{*}\\right)^{2}\n=\\left(\\frac{1}{4}\\right)^{2}+\\left(\\frac{3}{4}\\right)^{2}\n=\\frac{1}{16}+\\frac{9}{16}\n=\\frac{10}{16}\n=\\frac{5}{8},\n$$\n$$\n\\sum_{j=1}^{2} y_{j}^{*}\n=\\frac{1}{4}+\\frac{3}{4}\n=1,\n$$\n$$\n\\sum_{k=1}^{2} \\exp\\!\\left(z_{k}^{*}\\right)\n=\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right).\n$$\nTherefore,\n$$\nI \\approx \\Delta V \\cdot \\frac{5}{8} \\cdot 1 \\cdot \\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right)\n=\\frac{1}{8}\\cdot \\frac{5}{8}\\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right)\n=\\frac{5}{64}\\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right).\n$$", "answer": "$$\\boxed{\\frac{5}{64}\\left(\\exp\\left(\\frac{1}{4}\\right)+\\exp\\left(\\frac{3}{4}\\right)\\right)}$$", "id": "2191981"}, {"introduction": "Many practical applications involve integration over non-rectangular domains, where standard grid-based rules cannot be directly applied. This exercise introduces a powerful technique: transforming a complex domain into a simple unit square using a change of variables [@problem_id:2191987]. You will find the appropriate affine transformation, calculate its Jacobian determinant, and apply a numerical rule to the transformed integral, a method central to engineering and physics simulations.", "problem": "Consider the integral of the function $f(x,y) = (x-y)^2$ over a parallelogram-shaped region $R$ in the $xy$-plane. The vertices of the parallelogram $R$ are given by the points $V_1 = (1, 2)$, $V_2 = (4, 3)$, $V_3 = (2, 6)$, and $V_4 = (5, 7)$.\n\nYour task is to approximate the double integral $I = \\iint_R f(x,y) \\,dA$.\n\nTo do this, first determine the affine transformation $T(u,v) = (x(u,v), y(u,v))$ that maps the vertices of the unit square $S = [0,1] \\times [0,1]$ in the $uv$-plane, specifically $(0,0), (1,0), (0,1), (1,1)$, to the vertices of the parallelogram $R$, specifically $V_1, V_2, V_3, V_4$, respectively. Then, use this transformation to change the variables of integration from $(x,y)$ to $(u,v)$.\n\nFinally, approximate the resulting integral over the unit square $S$ using a composite midpoint rule based on a $2 \\times 2$ grid of uniform sub-squares.\n\nCalculate the numerical value of this approximation. Round your final answer to four significant figures.", "solution": "The problem asks for a numerical approximation of the integral $I = \\iint_R (x-y)^2 \\,dA$, where $R$ is a parallelogram with vertices $V_1=(1,2)$, $V_2=(4,3)$, $V_3=(2,6)$, and $V_4=(5,7)$. The approximation is to be done by transforming the integral to the unit square $S = [0,1] \\times [0,1]$ and then applying a composite midpoint rule on a $2 \\times 2$ grid.\n\nFirst, we find the affine transformation $T(u,v) = (x(u,v), y(u,v))$ that maps the unit square $S$ in the $uv$-plane to the parallelogram $R$ in the $xy$-plane. An affine transformation has the general form:\n$x(u,v) = x_0 + au + cv$\n$y(u,v) = y_0 + bu + dv$\n\nWe use the given mapping of the vertices:\n1.  $T(0,0) = (1,2)$:\n    $x(0,0) = x_0 = 1$\n    $y(0,0) = y_0 = 2$\n2.  $T(1,0) = (4,3)$:\n    $x(1,0) = x_0 + a(1) + c(0) = 1 + a = 4 \\implies a = 3$\n    $y(1,0) = y_0 + b(1) + d(0) = 2 + b = 3 \\implies b = 1$\n3.  $T(0,1) = (2,6)$:\n    $x(0,1) = x_0 + a(0) + c(1) = 1 + c = 2 \\implies c = 1$\n    $y(0,1) = y_0 + b(0) + d(1) = 2 + d = 6 \\implies d = 4$\n\nThus, the affine transformation is:\n$x(u,v) = 1 + 3u + v$\n$y(u,v) = 2 + u + 4v$\n\nWe can verify this with the fourth vertex: $T(1,1) = (1+3+1, 2+1+4) = (5,7)$, which is correct.\n\nNext, we apply the change of variables formula for double integrals:\n$I = \\iint_R f(x,y) \\,dx\\,dy = \\iint_S f(x(u,v), y(u,v)) \\left| \\det(J) \\right| \\,du\\,dv$\nwhere $J$ is the Jacobian matrix of the transformation $T$.\n$$J = \\begin{pmatrix} \\frac{\\partial x}{\\partial u} & \\frac{\\partial x}{\\partial v} \\\\ \\frac{\\partial y}{\\partial u} & \\frac{\\partial y}{\\partial v} \\end{pmatrix} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 4 \\end{pmatrix}$$\nThe determinant of the Jacobian is $\\det(J) = (3)(4) - (1)(1) = 12 - 1 = 11$.\nThe absolute value is $|\\det(J)| = 11$. Since this is a constant, the area of the parallelogram is $11$ times the area of the unit square.\n\nNow, we transform the integrand $f(x,y) = (x-y)^2$:\n$x - y = (1 + 3u + v) - (2 + u + 4v) = -1 + 2u - 3v$\nSo, $f(x(u,v), y(u,v)) = (-1 + 2u - 3v)^2$.\n\nThe integral becomes:\n$I = \\int_0^1 \\int_0^1 (-1 + 2u - 3v)^2 \\cdot 11 \\,du\\,dv$\nLet the new integrand be $g(u,v) = 11(-1 + 2u - 3v)^2$.\n\nWe are to approximate this integral using a composite midpoint rule on a $2 \\times 2$ grid. The unit square $S$ is divided into four sub-squares, each of area $\\Delta A = 0.5 \\times 0.5 = 0.25$. The midpoints of these sub-squares are:\n$(u_1, v_1) = (0.25, 0.25)$\n$(u_2, v_2) = (0.75, 0.25)$\n$(u_3, v_3) = (0.25, 0.75)$\n$(u_4, v_4) = (0.75, 0.75)$\n\nThe approximation of the integral is given by:\n$I \\approx \\sum_{i=1}^{4} g(u_i,v_i) \\Delta A = 0.25 \\left[ g(0.25, 0.25) + g(0.75, 0.25) + g(0.25, 0.75) + g(0.75, 0.75) \\right]$\n\nWe evaluate $g(u,v)$ at each midpoint:\n1.  $g(0.25, 0.25) = 11(-1 + 2(0.25) - 3(0.25))^2 = 11(-1 + 0.5 - 0.75)^2 = 11(-1.25)^2 = 11(1.5625) = 17.1875$\n2.  $g(0.75, 0.25) = 11(-1 + 2(0.75) - 3(0.25))^2 = 11(-1 + 1.5 - 0.75)^2 = 11(-0.25)^2 = 11(0.0625) = 0.6875$\n3.  $g(0.25, 0.75) = 11(-1 + 2(0.25) - 3(0.75))^2 = 11(-1 + 0.5 - 2.25)^2 = 11(-2.75)^2 = 11(7.5625) = 83.1875$\n4.  $g(0.75, 0.75) = 11(-1 + 2(0.75) - 3(0.75))^2 = 11(-1 + 1.5 - 2.25)^2 = 11(-1.75)^2 = 11(3.0625) = 33.6875$\n\nNow, we sum these values and multiply by $\\Delta A$:\n$I \\approx 0.25 (17.1875 + 0.6875 + 83.1875 + 33.6875) = 0.25 (134.75) = 33.6875$\n\nFinally, we round the result to four significant figures.\n$I \\approx 33.69$.", "answer": "$$\\boxed{33.69}$$", "id": "2191987"}, {"introduction": "We now address integrals over domains where the integration limits are not constant, such as the triangular region in $I = \\int_{0}^{1} ( \\int_{0}^{x} \\exp(y^{2}) \\,dy ) \\,dx$. This problem requires a nested application of the Trapezoidal rule, where the inner integral must be numerically evaluated at each node of the outer integral's grid [@problem_id:2191953]. This practice is crucial for developing an algorithmic approach to complex numerical tasks, especially when the integrand itself, like $\\exp(y^2)$, lacks a simple antiderivative.", "problem": "A common task in computational science is to evaluate definite integrals whose integrands are themselves defined by an integral. Consider the following double integral:\n$$I = \\int_{0}^{1} \\left( \\int_{0}^{x} \\exp(y^{2}) \\,dy \\right) \\,dx$$\nThis integral cannot be solved using elementary analytic techniques. You are tasked with finding a numerical approximation for $I$.\n\nTo do this, you will employ a nested application of the composite Trapezoidal rule. The composite Trapezoidal rule for approximating an integral $\\int_a^b f(z) \\,dz$ over $n$ subintervals is given by:\n$$ \\int_a^b f(z) \\,dz \\approx \\frac{h}{2} [f(z_0) + 2f(z_1) + \\dots + 2f(z_{n-1}) + f(z_n)] $$\nwhere $h = (b-a)/n$ and $z_k = a + k h$ for $k=0, 1, \\dots, n$.\n\nLet the inner integral be denoted by $F(x) = \\int_{0}^{x} \\exp(y^{2}) \\,dy$. First, approximate the outer integral $I = \\int_0^1 F(x) \\,dx$ using the composite Trapezoidal rule with $n_x = 4$ subintervals. The values of $F(x)$ required at the nodes of the outer integration must themselves be approximated. For each required value $F(x_k)$, you must approximate it by applying the composite Trapezoidal rule to the inner integral, using $n_y = 4$ subintervals.\n\nCalculate the numerical value of the integral $I$ using this procedure. Round your final answer to four significant figures.", "solution": "The problem asks for the numerical evaluation of the double integral $I = \\int_{0}^{1} \\left( \\int_{0}^{x} \\exp(y^{2}) \\,dy \\right) \\,dx$ using a nested Trapezoidal rule approach.\n\nLet $F(x) = \\int_{0}^{x} \\exp(y^{2}) \\,dy$ and $g(y) = \\exp(y^2)$. The overall integral is $I = \\int_0^1 F(x) \\,dx$.\n\n**Step 1: Set up the outer integral approximation.**\nWe use the composite Trapezoidal rule with $n_x=4$ to approximate $I = \\int_0^1 F(x) \\,dx$.\nThe step size is $h_x = (1-0)/4 = 0.25$.\nThe nodes are $x_0 = 0$, $x_1 = 0.25$, $x_2 = 0.5$, $x_3 = 0.75$, and $x_4 = 1$.\nThe Trapezoidal rule for the outer integral is:\n$$ I \\approx \\frac{h_x}{2} [F(x_0) + 2F(x_1) + 2F(x_2) + 2F(x_3) + F(x_4)] $$\n$$ I \\approx \\frac{0.25}{2} [F(0) + 2F(0.25) + 2F(0.5) + 2F(0.75) + F(1)] $$\n\n**Step 2: Evaluate $F(x)$ at each node using the inner integral approximation.**\nFor each $x_k$, we must compute $F(x_k) = \\int_{0}^{x_k} g(y) \\,dy = \\int_{0}^{x_k} \\exp(y^2) \\,dy$ using the Trapezoidal rule with $n_y=4$.\n\n*   **For $x_0 = 0$:**\n    $F(0) = \\int_0^0 \\exp(y^2) \\,dy = 0$. This is an exact value.\n\n*   **For $x_1 = 0.25$:**\n    We approximate $F(0.25) = \\int_0^{0.25} \\exp(y^2) \\,dy$.\n    The step size is $h_y = (0.25-0)/4 = 0.0625$.\n    The nodes are $y_0=0$, $y_1=0.0625$, $y_2=0.125$, $y_3=0.1875$, $y_4=0.25$.\n    The function values are:\n    $g(0) = \\exp(0) = 1$\n    $g(0.0625) = \\exp(0.0625^2) \\approx 1.003914$\n    $g(0.125) = \\exp(0.125^2) \\approx 1.015753$\n    $g(0.1875) = \\exp(0.1875^2) \\approx 1.035783$\n    $g(0.25) = \\exp(0.25^2) \\approx 1.064494$\n    $F(0.25) \\approx \\frac{0.0625}{2} [1 + 2(1.003914) + 2(1.015753) + 2(1.035783) + 1.064494]$\n    $F(0.25) \\approx 0.03125 [1 + 2.007828 + 2.031506 + 2.071566 + 1.064494] = 0.03125 [8.175394] \\approx 0.255481$\n\n*   **For $x_2 = 0.5$:**\n    We approximate $F(0.5) = \\int_0^{0.5} \\exp(y^2) \\,dy$.\n    The step size is $h_y = (0.5-0)/4 = 0.125$.\n    The nodes are $y_0=0$, $y_1=0.125$, $y_2=0.25$, $y_3=0.375$, $y_4=0.5$.\n    The function values are:\n    $g(0) = 1$\n    $g(0.125) \\approx 1.015753$\n    $g(0.25) \\approx 1.064494$\n    $g(0.375) = \\exp(0.375^2) \\approx 1.150993$\n    $g(0.5) = \\exp(0.5^2) \\approx 1.284025$\n    $F(0.5) \\approx \\frac{0.125}{2} [1 + 2(1.015753) + 2(1.064494) + 2(1.150993) + 1.284025]$\n    $F(0.5) \\approx 0.0625 [1 + 2.031506 + 2.128988 + 2.301986 + 1.284025] = 0.0625 [8.746505] \\approx 0.546657$\n\n*   **For $x_3 = 0.75$:**\n    We approximate $F(0.75) = \\int_0^{0.75} \\exp(y^2) \\,dy$.\n    The step size is $h_y = (0.75-0)/4 = 0.1875$.\n    The nodes are $y_0=0$, $y_1=0.1875$, $y_2=0.375$, $y_3=0.5625$, $y_4=0.75$.\n    The function values are:\n    $g(0) = 1$\n    $g(0.1875) \\approx 1.035783$\n    $g(0.375) \\approx 1.150993$\n    $g(0.5625) = \\exp(0.5625^2) \\approx 1.372190$\n    $g(0.75) = \\exp(0.75^2) \\approx 1.755055$\n    $F(0.75) \\approx \\frac{0.1875}{2} [1 + 2(1.035783) + 2(1.150993) + 2(1.372190) + 1.755055]$\n    $F(0.75) \\approx 0.09375 [1 + 2.071566 + 2.301986 + 2.744380 + 1.755055] = 0.09375 [9.872987] \\approx 0.925593$\n\n*   **For $x_4 = 1$:**\n    We approximate $F(1) = \\int_0^1 \\exp(y^2) \\,dy$.\n    The step size is $h_y = (1-0)/4 = 0.25$.\n    The nodes are $y_0=0$, $y_1=0.25$, $y_2=0.5$, $y_3=0.75$, $y_4=1$.\n    The function values are:\n    $g(0) = 1$\n    $g(0.25) \\approx 1.064494$\n    $g(0.5) \\approx 1.284025$\n    $g(0.75) \\approx 1.755055$\n    $g(1) = \\exp(1^2) = e \\approx 2.718282$\n    $F(1) \\approx \\frac{0.25}{2} [1 + 2(1.064494) + 2(1.284025) + 2(1.755055) + 2.718282]$\n    $F(1) \\approx 0.125 [1 + 2.128988 + 2.568050 + 3.510110 + 2.718282] = 0.125 [11.92543] \\approx 1.490679$\n\n**Step 3: Combine the results to find the final value of I.**\nNow substitute the approximated values of $F(x_k)$ back into the formula for the outer integral:\n$$ I \\approx \\frac{0.25}{2} [F(0) + 2F(0.25) + 2F(0.5) + 2F(0.75) + F(1)] $$\n$$ I \\approx 0.125 [0 + 2(0.255481) + 2(0.546657) + 2(0.925593) + 1.490679] $$\n$$ I \\approx 0.125 [0 + 0.510962 + 1.093314 + 1.851186 + 1.490679] $$\n$$ I \\approx 0.125 [4.946141] $$\n$$ I \\approx 0.618267625 $$\n\n**Step 4: Round the final answer.**\nThe problem asks for the answer to be rounded to four significant figures.\n$I \\approx 0.6183$.", "answer": "$$\\boxed{0.6183}$$", "id": "2191953"}]}