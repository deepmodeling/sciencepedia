{"hands_on_practices": [{"introduction": "The best way to understand an algorithm is to execute it yourself. This first exercise provides a direct, hands-on opportunity to trace the decision-making process of a simple adaptive quadrature algorithm. By manually calculating the approximations and applying the error criterion for the integral of a basic polynomial, you will build a foundational intuition for how these methods intelligently decide where to focus their computational effort [@problem_id:2153105].", "problem": "An adaptive quadrature algorithm refines its calculation mesh to meet a desired error tolerance. Consider the following recursive algorithm designed to approximate the definite integral $I = \\int_a^b f(x) \\,dx$.\n\n**Adaptive Integration Algorithm:**\nThe function `AdaptiveIntegrate(f, a, b, ε)` takes a function $f$, an interval $[a, b]$, and a tolerance $\\epsilon$ as input.\n\n1.  Calculate $S_1$, the approximation from the trapezoidal rule using a single interval of width $h_1 = b-a$. The formula is $S_1 = \\frac{h_1}{2}(f(a) + f(b))$.\n2.  Let $c = (a+b)/2$ be the midpoint of the interval. Calculate $S_2$, the approximation from the composite trapezoidal rule using two subintervals $[a, c]$ and $[c, b]$, each of width $h_2 = (b-a)/2$. The formula is $S_2 = \\frac{h_2}{2}(f(a) + f(c)) + \\frac{h_2}{2}(f(c) + f(b))$.\n3.  An estimate for the error in the more accurate approximation $S_2$ is based on the difference between the two approximations. The stopping criterion is $|S_2 - S_1| < 3\\epsilon$.\n4.  If the criterion is met, the procedure for this interval terminates and returns the value of $S_2$.\n5.  If the criterion is not met, the algorithm refines the interval. It recursively calls itself on the two subintervals, halving the tolerance for each. The result for the interval $[a, b]$ is the sum of the results from these two calls:\n    `AdaptiveIntegrate(f, a, c, ε/2) + AdaptiveIntegrate(f, c, b, ε/2)`\n\nYour task is to manually trace this algorithm to find the numerical approximation of the integral\n$$ I = \\int_0^4 x^2 \\,dx $$\nwith an initial tolerance of $\\epsilon = 2$.\n\nCalculate the final numerical approximation for the integral returned by the algorithm. Provide your answer as an exact integer or fraction.", "solution": "We apply the given adaptive trapezoidal algorithm to $f(x)=x^{2}$ on $[0,4]$ with initial tolerance $\\epsilon=2$. The trapezoidal approximation on $[a,b]$ with one panel is $S_{1}=\\frac{h_{1}}{2}\\left(f(a)+f(b)\\right)$ where $h_{1}=b-a$, and with two panels is\n$$\nS_{2}=\\frac{h_{2}}{2}\\left(f(a)+f(c)\\right)+\\frac{h_{2}}{2}\\left(f(c)+f(b)\\right),\n$$\nwhere $c=\\frac{a+b}{2}$ and $h_{2}=\\frac{b-a}{2}$. The stopping criterion for an interval is $\\left|S_{2}-S_{1}\\right|<3\\epsilon$. If not met, we recurse on $[a,c]$ and $[c,b]$ with tolerance $\\epsilon/2$ each and sum the returned values.\n\nTop-level interval $[0,4]$ with $\\epsilon=2$:\n- Compute $h_{1}=4$, $S_{1}=\\frac{4}{2}\\left(f(0)+f(4)\\right)=2\\left(0+16\\right)=32$.\n- Midpoint $c=2$, $h_{2}=2$, and\n$$\nS_{2}=\\frac{2}{2}\\left(f(0)+f(2)\\right)+\\frac{2}{2}\\left(f(2)+f(4)\\right)=1\\left(0+4\\right)+1\\left(4+16\\right)=4+20=24.\n$$\n- Error check: $\\left|S_{2}-S_{1}\\right|=\\left|24-32\\right|=8$, while $3\\epsilon=3\\cdot 2=6$. Since $8\\not<6$, we recurse on $[0,2]$ and $[2,4]$ with tolerance $\\epsilon/2=1$ each.\n\nSubinterval $[0,2]$ with $\\epsilon=1$:\n- Compute $h_{1}=2$, $S_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\left(0+4\\right)=4$.\n- Midpoint $c=1$, $h_{2}=1$, and\n$$\nS_{2}=\\frac{1}{2}\\left(f(0)+f(1)\\right)+\\frac{1}{2}\\left(f(1)+f(2)\\right)=\\frac{1}{2}\\left(0+1\\right)+\\frac{1}{2}\\left(1+4\\right)=\\frac{1}{2}+\\frac{5}{2}=3.\n$$\n- Error check: $\\left|S_{2}-S_{1}\\right|=\\left|3-4\\right|=1$, while $3\\epsilon=3\\cdot 1=3$. Since $1<3$, accept $S_{2}=3$ for $[0,2]$.\n\nSubinterval $[2,4]$ with $\\epsilon=1$:\n- Compute $h_{1}=2$, $S_{1}=\\frac{2}{2}\\left(f(2)+f(4)\\right)=1\\left(4+16\\right)=20$.\n- Midpoint $c=3$, $h_{2}=1$, and\n$$\nS_{2}=\\frac{1}{2}\\left(f(2)+f(3)\\right)+\\frac{1}{2}\\left(f(3)+f(4)\\right)=\\frac{1}{2}\\left(4+9\\right)+\\frac{1}{2}\\left(9+16\\right)=\\frac{13}{2}+\\frac{25}{2}=19.\n$$\n- Error check: $\\left|S_{2}-S_{1}\\right|=\\left|19-20\\right|=1$, while $3\\epsilon=3$. Since $1<3$, accept $S_{2}=19$ for $[2,4]$.\n\nFinally, the top-level call returns the sum of the accepted subinterval results:\n$$\n\\text{Result} = 3+19=22.\n$$\nThis is the final numerical approximation returned by the algorithm.", "answer": "$$\\boxed{22}$$", "id": "2153105"}, {"introduction": "A key advantage of adaptive quadrature is its efficiency, which stems from avoiding redundant calculations. This practice focuses on a critical aspect of the algorithm's implementation: the reuse of previously computed function values during the refinement process. By analyzing a single refinement step for an adaptive Simpson's rule, you will quantify exactly how many *new* computations are needed, revealing the method’s clever design [@problem_id:2153098].", "problem": "In numerical analysis, adaptive quadrature methods are algorithms for computing definite integrals numerically to a desired precision. These methods are more efficient than non-adaptive methods because they concentrate computational effort on the parts of the domain where the integrand is most difficult to approximate.\n\nConsider an adaptive scheme based on Simpson's rule. For a function $f(x)$ over an interval $[a, b]$, the basic Simpson's rule approximation, which we will call the coarse approximation $S_1$, is given by:\n$$S_1 = \\frac{b-a}{6} \\left[ f(a) + 4f\\left(\\frac{a+b}{2}\\right) + f(b) \\right]$$\nThis calculation requires evaluating the function at three points: the endpoints $a$ and $b$, and the midpoint $c = \\frac{a+b}{2}$.\n\nThe core of an adaptive strategy involves a refinement step. If the initial approximation is not accurate enough, the interval $[a, b]$ is divided into two subintervals of equal length, $[a, c]$ and $[c, b]$. Simpson's rule is then applied to each of these subintervals, and the results are summed to get a new, more refined approximation, $S_2$. The approximation for the left subinterval $[a, c]$ is $S_L$, and for the right subinterval $[c, b]$ is $S_R$, such that $S_2 = S_L + S_R$.\n\nAn essential aspect of this method's efficiency is reusing previous computations. Assuming the values $f(a)$, $f(c)$, and $f(b)$ have already been computed and stored for the initial coarse approximation $S_1$, how many *additional* function evaluations are necessary to compute the refined approximation $S_2$?\n\nA. 1\n\nB. 2\n\nC. 3\n\nD. 4\n\nE. 5", "solution": "We begin with the coarse Simpson approximation over $[a,b]$:\n$$S_{1}=\\frac{b-a}{6}\\left[f(a)+4f\\left(c\\right)+f(b)\\right],\\quad c=\\frac{a+b}{2}.$$\nBy assumption, the function values $f(a)$, $f(c)$, and $f(b)$ have already been computed.\n\nFor the refinement, we split $[a,b]$ at $c$ into $[a,c]$ and $[c,b]$. Applying Simpson’s rule on $[a,c]$ requires the values at $a$, $c$, and the midpoint of $[a,c]$, which is\n$$m_{L}=\\frac{a+c}{2}.$$\nThus,\n$$S_{L}=\\frac{c-a}{6}\\left[f(a)+4f\\left(m_{L}\\right)+f(c)\\right].$$\nSimilarly, applying Simpson’s rule on $[c,b]$ requires the values at $c$, $b$, and the midpoint of $[c,b]$, which is\n$$m_{R}=\\frac{c+b}{2}.$$\nThus,\n$$S_{R}=\\frac{b-c}{6}\\left[f(c)+4f\\left(m_{R}\\right)+f(b)\\right].$$\nThe refined approximation is $S_{2}=S_{L}+S_{R}$.\n\nThe set of function values needed to compute $S_{2}$ is $\\{f(a),f(c),f(b),f(m_{L}),f(m_{R})\\}$. Since $f(a)$, $f(c)$, and $f(b)$ are already known, the only additional evaluations are at the two new midpoints $m_{L}$ and $m_{R}$. Therefore, exactly $2$ additional function evaluations are required.", "answer": "$$\\boxed{B}$$", "id": "2153098"}, {"introduction": "Numerical methods are powerful, but not infallible; a skilled practitioner must understand their limitations. This exercise explores a scenario where an adaptive quadrature algorithm can be 'fooled' by a carefully constructed function whose most challenging features are missed by the algorithm's sampling points. By analyzing a case where the error estimate is deceptively small, you will learn why blind trust in numerical outputs can be risky and appreciate the importance of understanding the behavior of the integrand [@problem_id:2153058].", "problem": "An adaptive quadrature algorithm based on Simpson's rule is used to approximate the definite integral of a function $f(x)$ over an interval $[a, b]$ to within a given tolerance $\\epsilon$. The core of the algorithm is a recursive procedure that operates as follows:\n\n1.  Given an interval $[a, b]$ and a tolerance `tol`, first compute the coarse Simpson's rule approximation, $S_1 = S(a,b)$, using the three points $a$, $c=(a+b)/2$, and $b$.\n2.  Next, compute a more refined approximation, $S_2 = S(a,c) + S(c,b)$, by applying Simpson's rule to the two sub-intervals $[a,c]$ and $[c,b]$ and summing the results.\n3.  The absolute error of the refined approximation $S_2$ is estimated to be $E_{est} = \\frac{1}{15}|S_2 - S_1|$.\n4.  If $E_{est} \\le \\text{tol}$, the recursion terminates for this interval and returns the value $S_2$ as the approximation.\n5.  If $E_{est} > \\text{tol}$, the algorithm is called recursively on the sub-intervals $[a,c]$ and $[c,b]$, each with a new tolerance of $\\text{tol}/2$. The final approximation is the sum of the results from these two recursive calls.\n\nConsider the integral of the function\n$$\nf(x) = \\alpha - \\beta x^2 - \\gamma x^4 + C \\sin^2(\\pi x)\n$$\nover the interval $[-L, L]$, where the parameters are given by $\\alpha = 2$, $\\beta = 0.5$, $\\gamma = 0.01$, $C = 10$, and $L = 2$.\n\nThe algorithm is initiated with the interval $[-2, 2]$ and a tolerance of $\\epsilon = 0.01$. It is found that the algorithm terminates after only the first step (i.e., without any recursive calls). Your task is to analyze this outcome.\n\nCalculate the ratio of the true absolute error of the returned approximation to the estimated absolute error. Round your final answer to four significant figures.", "solution": "We use Simpson’s rule on an interval $[a,b]$ with midpoint $c=(a+b)/2$:\n$$\nS(a,b) = \\frac{b-a}{6}\\big(f(a) + 4 f(c) + f(b)\\big).\n$$\nHere $a=-2$, $b=2$, $c=0$. The adaptive scheme computes\n$$\nS_{1} = S(-2,2), \\quad S_{2} = S(-2,0) + S(0,2), \\quad E_{\\text{est}} = \\frac{1}{15}|S_{2} - S_{1}|.\n$$\nThe function is\n$$\nf(x) = 2 - \\frac{1}{2}x^{2} - \\frac{1}{100}x^{4} + 10 \\sin^{2}(\\pi x),\n$$\nwhich is even. At the Simpson nodes $x \\in \\{-2,-1,0,1,2\\}$ we have $\\sin^{2}(\\pi x)=0$, so at these nodes $f$ reduces to its polynomial part. Hence\n$$\nf(0)=2, \\quad f(1)=2 - \\frac{1}{2} - \\frac{1}{100} = \\frac{149}{100}, \\quad f(2)=2 - 2 - \\frac{16}{100} = -\\frac{4}{25}.\n$$\nCompute $S_{1}$ and $S_{2}$:\n$$\nS_{1} = \\frac{4}{6}\\big(f(-2) + 4 f(0) + f(2)\\big) = \\frac{4}{6}\\big(2 f(2) + 4 f(0)\\big) = \\frac{4}{3}\\big(f(2) + 2 f(0)\\big) = \\frac{4}{3}\\left(-\\frac{4}{25} + 4\\right) = \\frac{128}{25},\n$$\n$$\nS_{2} = \\frac{2}{6}\\big(f(-2) + 4 f(-1) + f(0)\\big) + \\frac{2}{6}\\big(f(0) + 4 f(1) + f(2)\\big) = \\frac{2}{3}\\big(f(2) + 4 f(1) + f(0)\\big) = \\frac{2}{3}\\left(-\\frac{4}{25} + 4\\cdot\\frac{149}{100} + 2\\right) = \\frac{26}{5}.\n$$\nThus\n$$\nS_{2} - S_{1} = \\frac{26}{5} - \\frac{128}{25} = \\frac{2}{25}, \\quad E_{\\text{est}} = \\frac{1}{15}\\left|\\frac{2}{25}\\right| = \\frac{2}{375} \\leq 0.01,\n$$\nso the algorithm terminates after the first step and returns $S_{2}$.\n\nNow compute the exact integral $I = \\int_{-2}^{2} f(x)\\,dx$. Split into polynomial and trigonometric parts. For the polynomial part,\n$$\n\\int_{-2}^{2}\\left(2 - \\frac{1}{2}x^{2} - \\frac{1}{100}x^{4}\\right) dx = 8 - \\frac{8}{3} - \\frac{16}{125} = \\frac{1952}{375}.\n$$\nFor the trigonometric part, since $\\sin^{2}(\\pi x) = \\frac{1 - \\cos(2\\pi x)}{2}$ and there are four full periods on $[-2,2]$,\n$$\n\\int_{-2}^{2} 10 \\sin^{2}(\\pi x)\\,dx = 10 \\cdot \\frac{1}{2} \\cdot 4 = 20 = \\frac{7500}{375}.\n$$\nTherefore the exact integral is\n$$\nI = \\frac{1952}{375} + \\frac{7500}{375} = \\frac{9452}{375}.\n$$\nThe true absolute error of the returned approximation is\n$$\nE_{\\text{true}} = \\left|I - S_{2}\\right| = \\left|\\frac{9452}{375} - \\frac{26}{5}\\right| = \\left|\\frac{9452}{375} - \\frac{1950}{375}\\right| = \\frac{7502}{375}.\n$$\nHence, the ratio of the true absolute error to the estimated absolute error is\n$$\n\\frac{E_{\\text{true}}}{E_{\\text{est}}} = \\frac{\\frac{7502}{375}}{\\frac{2}{375}} = \\frac{7502}{2} = 3751.\n$$\nRounded to four significant figures, this is $3751$.", "answer": "$$\\boxed{3751}$$", "id": "2153058"}]}