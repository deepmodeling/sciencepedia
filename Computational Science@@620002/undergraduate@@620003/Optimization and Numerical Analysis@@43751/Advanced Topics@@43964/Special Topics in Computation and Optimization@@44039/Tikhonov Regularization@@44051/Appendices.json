{"hands_on_practices": [{"introduction": "Solving ill-conditioned linear systems is a common challenge where small errors in data can lead to large errors in the solution. This first exercise provides a direct, hands-on application of the Tikhonov regularization formula, $x_{\\lambda} = (A^T A + \\lambda I)^{-1} A^T b$, to a simple system. By working through this problem [@problem_id:2223140], you will build foundational familiarity with the core mechanics of regularization and see how the parameter $\\lambda$ directly mediates the components of the resulting solution vector.", "problem": "In many scientific and engineering applications, one encounters linear systems of equations of the form $Ax=b$ that are \"ill-conditioned.\" This means that small changes in the measurement vector $b$ can lead to very large changes in the solution vector $x$. Tikhonov regularization is a common method to stabilize the solution in such cases. The regularized solution, denoted by $x_{\\lambda}$, is found by solving a modified optimization problem, which leads to the formula:\n$$x_{\\lambda} = (A^T A + \\lambda I)^{-1} A^T b$$\nHere, $A$ is the system matrix, $b$ is the measurement vector, $I$ is the identity matrix, and $\\lambda > 0$ is a user-chosen regularization parameter that controls the trade-off between fitting the data and stabilizing the solution.\n\nConsider a simple two-dimensional system characterized by the matrix $A$ and measurement vector $b$ given below:\n$$A = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$$\nThe small entry in matrix $A$ makes this system sensitive to noise and thus a good candidate for regularization. Your task is to investigate the behavior of the regularized solution $x_{\\lambda}$.\n\nDetermine the specific value of the regularization parameter $\\lambda$ for which the two components of the solution vector $x_{\\lambda}$ are equal. Provide your answer as a real number rounded to three significant figures.", "solution": "We use the Tikhonov formula for the regularized solution:\n$$\nx_{\\lambda}=(A^{T}A+\\lambda I)^{-1}A^{T}b.\n$$\nFor the given diagonal matrix $A=\\begin{pmatrix}1&0\\\\0&\\frac{1}{10}\\end{pmatrix}$, we have $A^{T}=A$, so\n$$\nA^{T}A=\\begin{pmatrix}1&0\\\\0&\\frac{1}{100}\\end{pmatrix}, \\quad A^{T}b=\\begin{pmatrix}1\\\\ \\frac{1}{5}\\end{pmatrix}.\n$$\nThus,\n$$\nA^{T}A+\\lambda I=\\begin{pmatrix}1+\\lambda&0\\\\0&\\lambda+\\frac{1}{100}\\end{pmatrix}, \\quad (A^{T}A+\\lambda I)^{-1}=\\begin{pmatrix}\\frac{1}{1+\\lambda}&0\\\\0&\\frac{1}{\\lambda+\\frac{1}{100}}\\end{pmatrix}.\n$$\nTherefore,\n$$\nx_{\\lambda}=\\begin{pmatrix}\\frac{1}{1+\\lambda}&0\\\\0&\\frac{1}{\\lambda+\\frac{1}{100}}\\end{pmatrix}\\begin{pmatrix}1\\\\ \\frac{1}{5}\\end{pmatrix}=\\begin{pmatrix}\\frac{1}{1+\\lambda}\\\\ \\frac{\\frac{1}{5}}{\\lambda+\\frac{1}{100}}\\end{pmatrix}.\n$$\nWe seek $\\lambda$ such that the two components are equal:\n$$\n\\frac{1}{1+\\lambda}=\\frac{\\frac{1}{5}}{\\lambda+\\frac{1}{100}}.\n$$\nCross-multiplying gives\n$$\n\\lambda+\\frac{1}{100}=\\frac{1}{5}(1+\\lambda).\n$$\nMultiplying by $100$,\n$$\n100\\lambda+1=20+20\\lambda \\quad \\Rightarrow \\quad 80\\lambda=19 \\quad \\Rightarrow \\quad \\lambda=\\frac{19}{80}.\n$$\nNumerically, $\\lambda=\\frac{19}{80}=0.2375$, which rounded to three significant figures is $0.238$.", "answer": "$$\\boxed{0.238}$$", "id": "2223140"}, {"introduction": "Beyond single calculations, it is powerful to visualize how the regularized solution $x_\\lambda$ evolves as the parameter $\\lambda$ changes, tracing what is known as a \"regularization path.\" This practice [@problem_id:2223157] explores the geometric nature of this path for a 2D system, challenging you to find where it intersects a coordinate axis. This exercise helps build a deeper intuition for the trade-off controlled by $\\lambda$, viewing it as a journey from a complex, data-fitting solution to a simple, constrained one.", "problem": "In many scientific and engineering applications, one encounters the need to solve a linear system of equations $Ax=b$ where the matrix $A$ is ill-conditioned. A common approach to stabilize the solution is Tikhonov regularization, which seeks to find a vector $x$ that minimizes the composite objective function $\\|Ax-b\\|^2_2 + \\lambda \\|x\\|^2_2$, where $\\| \\cdot \\|_2$ denotes the Euclidean norm and $\\lambda > 0$ is a regularization parameter. The unique solution to this minimization problem, denoted as $x_\\lambda$, is given by the formula $x_\\lambda = (A^T A + \\lambda I)^{-1} A^T b$, where $I$ is the identity matrix.\n\nConsider the ill-conditioned linear system with the matrix $A$ and vector $b$ defined as:\n$$\nA = \\begin{pmatrix} 1 & 1.01 \\\\ 1 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\nThe solution vector $x_\\lambda = \\begin{pmatrix} x_1(\\lambda) \\\\ x_2(\\lambda) \\end{pmatrix}$ traces a path in the plane as the parameter $\\lambda$ varies. There exists a unique positive value of $\\lambda$, let's call it $\\lambda^*$, for which the solution path intersects the $x_2$-axis. This corresponds to the first component of the solution vector being zero, i.e., $x_1(\\lambda^*) = 0$.\n\nDetermine the value of the second component, $x_2(\\lambda^*)$, at this specific point of intersection. Round your final answer to four significant figures.", "solution": "The Tikhonov regularized solution to the system $Ax=b$ is given by $x_\\lambda = (A^T A + \\lambda I)^{-1} A^T b$. We are given the matrix $A$ and vector $b$:\n$$\nA = \\begin{pmatrix} 1 & 1.01 \\\\ 1 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\n\nFirst, we compute the required matrix and vector products.\nThe transpose of $A$ is:\n$$\nA^T = \\begin{pmatrix} 1 & 1 \\\\ 1.01 & 1 \\end{pmatrix}\n$$\nNext, we compute $A^T A$:\n$$\nA^T A = \\begin{pmatrix} 1 & 1 \\\\ 1.01 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 1.01 \\\\ 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 1 \\cdot 1 & 1 \\cdot 1.01 + 1 \\cdot 1 \\\\ 1.01 \\cdot 1 + 1 \\cdot 1 & 1.01 \\cdot 1.01 + 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 2 & 2.01 \\\\ 2.01 & 1.0201 + 1 \\end{pmatrix} = \\begin{pmatrix} 2 & 2.01 \\\\ 2.01 & 2.0201 \\end{pmatrix}\n$$\nNow, we compute $A^T b$:\n$$\nA^T b = \\begin{pmatrix} 1 & 1 \\\\ 1.01 & 1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 2 + 1 \\cdot 1 \\\\ 1.01 \\cdot 2 + 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 2.02 + 1 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 3.02 \\end{pmatrix}\n$$\nThe expression for $x_\\lambda$ involves the matrix $(A^T A + \\lambda I)$:\n$$\nA^T A + \\lambda I = \\begin{pmatrix} 2 & 2.01 \\\\ 2.01 & 2.0201 \\end{pmatrix} + \\lambda \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 2+\\lambda & 2.01 \\\\ 2.01 & 2.0201+\\lambda \\end{pmatrix}\n$$\nTo find the inverse of this matrix, we first compute its determinant:\n$$\n\\det(A^T A + \\lambda I) = (2+\\lambda)(2.0201+\\lambda) - (2.01)^2\n$$\n$$\n= (4.0402 + 2\\lambda + 2.0201\\lambda + \\lambda^2) - 4.0401\n$$\n$$\n= \\lambda^2 + 4.0201\\lambda + 0.0001\n$$\nThe inverse matrix is:\n$$\n(A^T A + \\lambda I)^{-1} = \\frac{1}{\\lambda^2 + 4.0201\\lambda + 0.0001} \\begin{pmatrix} 2.0201+\\lambda & -2.01 \\\\ -2.01 & 2+\\lambda \\end{pmatrix}\n$$\nNow we can write the full expression for $x_\\lambda$:\n$$\nx_\\lambda = \\begin{pmatrix} x_1(\\lambda) \\\\ x_2(\\lambda) \\end{pmatrix} = \\frac{1}{\\lambda^2 + 4.0201\\lambda + 0.0001} \\begin{pmatrix} 2.0201+\\lambda & -2.01 \\\\ -2.01 & 2+\\lambda \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 3.02 \\end{pmatrix}\n$$\nLet's compute the matrix-vector product in the numerator:\n$$\n\\begin{pmatrix} (2.0201+\\lambda) \\cdot 3 - 2.01 \\cdot 3.02 \\\\ -2.01 \\cdot 3 + (2+\\lambda) \\cdot 3.02 \\end{pmatrix} = \\begin{pmatrix} 6.0603 + 3\\lambda - 6.0702 \\\\ -6.03 + 6.04 + 3.02\\lambda \\end{pmatrix} = \\begin{pmatrix} 3\\lambda - 0.0099 \\\\ 3.02\\lambda + 0.01 \\end{pmatrix}\n$$\nSo, the solution vector is:\n$$\nx_\\lambda = \\begin{pmatrix} x_1(\\lambda) \\\\ x_2(\\lambda) \\end{pmatrix} = \\frac{1}{\\lambda^2 + 4.0201\\lambda + 0.0001} \\begin{pmatrix} 3\\lambda - 0.0099 \\\\ 3.02\\lambda + 0.01 \\end{pmatrix}\n$$\nThe problem asks for the value of $x_2(\\lambda^*)$ where $\\lambda^*$ is the positive value of $\\lambda$ that makes $x_1(\\lambda) = 0$.\nWe set the first component's numerator to zero to find $\\lambda^*$:\n$$\n3\\lambda^* - 0.0099 = 0\n$$\n$$\n3\\lambda^* = 0.0099 \\implies \\lambda^* = 0.0033\n$$\nThis value is positive, as required. Now we substitute $\\lambda^*=0.0033$ into the expression for $x_2(\\lambda)$:\n$$\nx_2(\\lambda^*) = \\frac{3.02(0.0033) + 0.01}{(0.0033)^2 + 4.0201(0.0033) + 0.0001}\n$$\nCalculate the numerator:\n$$\n3.02 \\times 0.0033 + 0.01 = 0.009966 + 0.01 = 0.019966\n$$\nCalculate the denominator:\n$$\n(0.0033)^2 = 0.00001089\n$$\n$$\n4.0201 \\times 0.0033 = 0.01326633\n$$\n$$\n\\text{Denominator} = 0.00001089 + 0.01326633 + 0.0001 = 0.01337722\n$$\nFinally, we compute the value of $x_2(\\lambda^*)$:\n$$\nx_2(\\lambda^*) = \\frac{0.019966}{0.01337722} \\approx 1.4925343\n$$\nRounding the result to four significant figures, we get $1.493$.", "answer": "$$\\boxed{1.493}$$", "id": "2223157"}, {"introduction": "A critical task in applying regularization is selecting an appropriate value for the parameter $\\lambda$. This problem [@problem_id:2223147] introduces a powerful and intuitive method for this, known as the discrepancy principle. The principle states that the solution should not fit the data more closely than the level of noise present in the measurements, providing a clear criterion for choosing $\\lambda$. By solving this problem, you will learn how to connect the abstract regularization parameter to a tangible data characteristic, a key skill for real-world applications.", "problem": "In the study of inverse problems, one frequently encounters linear systems of the form $Ax=b$ that are ill-posed. A common example arises when trying to determine a set of causal parameters $x$ from a set of observed effects $b$. For such systems, the matrix $A$ is typically ill-conditioned or singular, meaning that small amounts of noise in the measurement vector $b$ can lead to large, physically meaningless oscillations in the solution vector $x$.\n\nTikhonov regularization is a widely used technique to address this issue. Instead of solving $Ax=b$ directly, one seeks a solution $x_{\\lambda}$ that minimizes a composite objective function involving both the residual norm and the solution norm:\n$$ \\min_{x} \\left( \\|Ax - b\\|_2^2 + \\lambda^2 \\|x\\|_2^2 \\right) $$\nHere, $\\lambda > 0$ is the regularization parameter, which controls the trade-off between fitting the data and penalizing the magnitude of the solution.\n\nA crucial part of this process is choosing an appropriate value for $\\lambda$. The discrepancy principle provides a heuristic for this choice. It posits that if the noise level in the data vector $b$ is known or can be estimated as $\\delta = \\|b - b_{\\text{true}}\\|_2$, then a good choice for $\\lambda$ is one that makes the residual norm of the regularized solution equal to this noise level.\n\nConsider an ill-posed system described by the matrix $A$ and the measured data vector $b$:\n$$ A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 5 \\\\ 3 \\end{pmatrix} $$\nThe noise level in the measurement $b$ has been estimated to be $\\delta = 3\\sqrt{2}$.\n\nDetermine the value of the regularization parameter $\\lambda$ by applying the discrepancy principle, which in this case means finding the value of $\\lambda > 0$ that satisfies the equation $\\|A x_{\\lambda} - b\\|_2 = \\delta$. Express your final answer as an exact, closed-form analytic expression.", "solution": "We seek the Tikhonov-regularized solution\n$$\nx_{\\lambda}=\\arg\\min_{x}\\left(\\|Ax-b\\|_{2}^{2}+\\lambda^{2}\\|x\\|_{2}^{2}\\right),\n$$\nwhich satisfies the normal equation\n$$\n(A^{T}A+\\lambda^{2}I)x_{\\lambda}=A^{T}b.\n$$\nFor the given matrix and vector,\n$$\nA=\\begin{pmatrix}1&1\\\\1&1\\end{pmatrix},\\quad b=\\begin{pmatrix}5\\\\3\\end{pmatrix},\n$$\nwe compute\n$$\nA^{T}A=\\begin{pmatrix}2&2\\\\2&2\\end{pmatrix},\\quad A^{T}b=Ab=\\begin{pmatrix}8\\\\8\\end{pmatrix}.\n$$\nLet $M= A^{T}A+\\lambda^{2}I=2J+\\lambda^{2}I$, where $J$ is the $2\\times 2$ all-ones matrix. The vector $u=(1,1)^{T}$ is an eigenvector of $J$ with $J u=2u$, hence $M u=(4+\\lambda^{2})u$, while any vector orthogonal to $u$ is an eigenvector with eigenvalue $\\lambda^{2}$. Since $A^{T}b$ is proportional to $u$, we obtain\n$$\nx_{\\lambda}=\\frac{8}{4+\\lambda^{2}}\\,u=\\frac{8}{4+\\lambda^{2}}\\begin{pmatrix}1\\\\1\\end{pmatrix}.\n$$\nThe residual is\n$$\nr_{\\lambda}=Ax_{\\lambda}-b=Jx_{\\lambda}-b=\\frac{16}{4+\\lambda^{2}}\\begin{pmatrix}1\\\\1\\end{pmatrix}-\\begin{pmatrix}5\\\\3\\end{pmatrix}.\n$$\nDefine $t=\\dfrac{16}{4+\\lambda^{2}}$. Then\n$$\nr_{\\lambda}=\\begin{pmatrix}t-5\\\\ t-3\\end{pmatrix},\\quad \\|r_{\\lambda}\\|_{2}^{2}=(t-5)^{2}+(t-3)^{2}=2t^{2}-16t+34.\n$$\nThe discrepancy principle requires $\\|r_{\\lambda}\\|_{2}=\\delta=3\\sqrt{2}$, i.e.,\n$$\n2t^{2}-16t+34=18 \\quad\\Longrightarrow\\quad 2t^{2}-16t+16=0 \\quad\\Longrightarrow\\quad t^{2}-8t+8=0.\n$$\nSolving the quadratic gives\n$$\nt=4\\pm 2\\sqrt{2}.\n$$\nSince $t=\\dfrac{16}{4+\\lambda^{2}}$ satisfies $0<t\\leq 4$, the admissible root is $t=4-2\\sqrt{2}$. Hence\n$$\n\\frac{16}{4+\\lambda^{2}}=4-2\\sqrt{2}\\quad\\Longrightarrow\\quad 4+\\lambda^{2}=\\frac{16}{4-2\\sqrt{2}}.\n$$\nRationalizing the denominator,\n$$\n\\frac{16}{4-2\\sqrt{2}}=\\frac{8}{2-\\sqrt{2}}=\\frac{8(2+\\sqrt{2})}{(2-\\sqrt{2})(2+\\sqrt{2})}=\\frac{8(2+\\sqrt{2})}{2}=4(2+\\sqrt{2})=8+4\\sqrt{2}.\n$$\nTherefore,\n$$\n\\lambda^{2}=8+4\\sqrt{2}-4=4+4\\sqrt{2}=4(1+\\sqrt{2}),\n$$\nso the regularization parameter is\n$$\n\\lambda=2\\sqrt{1+\\sqrt{2}}.\n$$", "answer": "$$\\boxed{2\\sqrt{1+\\sqrt{2}}}$$", "id": "2223147"}]}