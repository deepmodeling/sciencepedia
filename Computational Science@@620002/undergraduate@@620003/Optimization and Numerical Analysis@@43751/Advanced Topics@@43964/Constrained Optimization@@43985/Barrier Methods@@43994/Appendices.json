{"hands_on_practices": [{"introduction": "Barrier methods work by adding a special function to the objective that penalizes solutions as they approach the boundary of the feasible region. This practice is your first step into the mechanics of these methods, focusing on the logarithmic barrier function. By calculating its gradient, you are essentially finding the \"force\" that pushes the solution away from the constraints, a critical component for any gradient-based optimization algorithm used to solve the problem. [@problem_id:2155906]", "problem": "In the field of optimization, interior-point methods are a class of algorithms used to solve linear and nonlinear convex optimization problems. A key component of these methods is the use of a barrier function to handle inequality constraints.\n\nConsider a feasible set defined by a system of $m$ linear inequalities in $\\mathbb{R}^n$, written in matrix form as $Ax \\le b$, where $A$ is an $m \\times n$ matrix and $b$ is an $m \\times 1$ vector. Let $a_i^T$ denote the $i$-th row of matrix $A$, and let $b_i$ be the $i$-th component of vector $b$. The $i$-th inequality is thus $a_i^T x \\le b_i$.\n\nThe standard logarithmic barrier function for this set of inequalities is defined for points $x$ that are strictly feasible (i.e., $a_i^T x < b_i$ for all $i=1, \\dots, m$):\n$$ \\phi(x) = -\\sum_{i=1}^m \\ln(b_i - a_i^T x) $$\nYour task is to determine the gradient of this function, $\\nabla \\phi(x)$. Express your final answer as a vector expression in terms of the vectors $a_i$ (where $a_i$ is the column vector corresponding to the transpose of the row vector $a_i^T$), $x$, and the scalars $b_i$.", "solution": "We are given the logarithmic barrier function for strictly feasible $x$:\n$$\n\\phi(x) = -\\sum_{i=1}^{m} \\ln\\!\\big(b_i - a_i^{T} x\\big).\n$$\nDefine $f_i(x) = -\\ln\\!\\big(b_i - a_i^{T} x\\big)$ for each $i$. By the chain rule applied to the composition of the scalar function $g(u) = -\\ln(u)$ with $u_i(x) = b_i - a_i^{T} x$, we have\n$$\n\\nabla f_i(x) = g^{\\prime}\\!\\big(u_i(x)\\big)\\,\\nabla u_i(x).\n$$\nCompute the derivatives:\n- $g^{\\prime}(u) = -\\frac{1}{u}$, so $g^{\\prime}\\!\\big(u_i(x)\\big) = -\\frac{1}{b_i - a_i^{T} x}$.\n- Since $u_i(x) = b_i - a_i^{T} x$ is affine, its gradient is $\\nabla u_i(x) = -a_i$.\n\nTherefore,\n$$\n\\nabla f_i(x) = -\\frac{1}{b_i - a_i^{T} x}\\,(-a_i) = \\frac{a_i}{b_i - a_i^{T} x}.\n$$\nSumming over all $i$,\n$$\n\\nabla \\phi(x) = \\sum_{i=1}^{m} \\nabla f_i(x) = \\sum_{i=1}^{m} \\frac{a_i}{b_i - a_i^{T} x}.\n$$\nThis expression is valid for strictly feasible $x$ satisfying $a_i^{T} x < b_i$ for all $i$.", "answer": "$$\\boxed{\\sum_{i=1}^{m}\\frac{a_i}{b_i - a_i^{T} x}}$$", "id": "2155906"}, {"introduction": "The core idea of an interior-point method is to trace a \"central path\" that travels through the interior of the feasible set towards the optimal solution. This path is defined as the set of minimizers of the barrier-augmented objective function for different values of the barrier parameter $t$. This exercise demystifies this abstract concept by asking you to derive the explicit formula for the central path in a simple, one-dimensional setting, providing a clear and tangible understanding of its behavior. [@problem_id:2155925]", "problem": "Consider a simple one-dimensional linear programming problem defined as:\nminimize $f(x) = c x$\nsubject to $x \\ge 0$\nwhere $x$ is a scalar variable and $c$ is a given positive constant, $c > 0$.\n\nTo solve this using an interior-point method, we can employ the logarithmic barrier function. The original constrained problem is transformed into a sequence of unconstrained optimization problems by augmenting the objective function with a barrier term. The modified objective function for this problem is given by:\n$$P(x; t) = t(cx) - \\ln(x)$$\nwhere $t > 0$ is a scalar barrier parameter. The minimizer of $P(x; t)$ for a given value of $t$ is a point on the so-called \"central path\", and we denote this point as $x^*(t)$.\n\nDetermine the explicit formula for the central path point $x^*(t)$ in terms of the constants $c$ and $t$.", "solution": "We consider the barrier-augmented objective for $x>0$:\n$$\nP(x;t) = t c x - \\ln(x),\n$$\nwith $t>0$ and $c>0$. To find the central path point $x^{*}(t)$, we set the first derivative to zero:\n$$\n\\frac{dP}{dx} = t c - \\frac{1}{x} = 0.\n$$\nSolving for $x$ gives\n$$\n\\frac{1}{x} = t c \\quad \\Rightarrow \\quad x^{*}(t) = \\frac{1}{c t}.\n$$\nTo verify this is a minimizer, we check the second derivative:\n$$\n\\frac{d^{2}P}{dx^{2}} = \\frac{1}{x^{2}} > 0 \\quad \\text{for } x>0,\n$$\nso $P(\\cdot;t)$ is strictly convex on its domain and the critical point is the unique minimizer. Therefore, the central path is\n$$\nx^{*}(t) = \\frac{1}{c t}.\n$$", "answer": "$$\\boxed{\\frac{1}{c t}}$$", "id": "2155925"}, {"introduction": "In practice, tracing the central path involves solving a series of \"centering problems,\" which are themselves nonlinear systems of equations. Newton's method is the engine that powers this process, and at its heart lies the solution of a linear system to find the search direction at each step. This problem brings you directly to the implementation core of a primal-dual interior-point method, where you will derive a key part of the Jacobian matrix for the Newton step applied to a general Quadratic Program (QP). [@problem_id:2155926]", "problem": "Consider a standard convex Quadratic Program (QP), which seeks to minimize a quadratic function subject to linear inequality constraints:\n$$\n\\min_{x \\in \\mathbb{R}^n} \\frac{1}{2}x^T Q x + c^T x \\quad \\text{subject to} \\quad Ax \\le b\n$$\nHere, $x \\in \\mathbb{R}^n$ is the optimization variable, $Q \\in \\mathbb{R}^{n \\times n}$ is a symmetric positive-semidefinite matrix, $c \\in \\mathbb{R}^n$ is a vector, $A \\in \\mathbb{R}^{m \\times n}$ is a matrix, and $b \\in \\mathbb{R}^m$ is a vector.\n\nPrimal-dual interior-point methods are a powerful technique for solving such problems. They operate by introducing slack variables $s \\in \\mathbb{R}^m$ to convert the inequality constraints into equalities ($Ax+s=b, s \\ge 0$) and then applying a logarithmic barrier to the non-negativity constraint on $s$. This approach transforms the original constrained problem into a task of finding a solution $(x, \\lambda, s)$ that satisfies a set of perturbed Karush-Kuhn-Tucker (KKT) conditions for a parameter $t>0$:\n1. $Qx + c + A^T \\lambda = 0$\n2. $Ax + s - b = 0$\n3. $\\text{diag}(s)\\lambda = (1/t)\\mathbf{1}$\n\nHere, $\\lambda \\in \\mathbb{R}^m$ is the vector of dual variables, $\\mathbf{1}$ is the $m \\times 1$ vector of all ones, and $\\text{diag}(v)$ denotes a square matrix with the elements of vector $v$ on its main diagonal and zeros elsewhere.\n\nTo solve this non-linear system, Newton's method is employed. At each iteration, given a strictly feasible point $(x, \\lambda, s)$ (with $s>0, \\lambda>0$), we compute a search direction $(\\Delta x, \\Delta \\lambda, \\Delta s)$ by solving the linear system obtained by linearizing the KKT equations. This linear system can be written in a 3x3 block matrix form:\n$$\n\\begin{pmatrix} M_{11} & M_{12} & M_{13} \\\\ M_{21} & M_{22} & M_{23} \\\\ M_{31} & M_{32} & M_{33} \\end{pmatrix} \\begin{pmatrix} \\Delta x \\\\ \\Delta \\lambda \\\\ \\Delta s \\end{pmatrix} = \\begin{pmatrix} r_{\\text{dual}} \\\\ r_{\\text{primal}} \\\\ r_{\\text{cent}} \\end{pmatrix}\n$$\nwhere the matrix on the left is the Jacobian of the system of KKT equations.\n\nDetermine the block matrices that form the first block-column of this Jacobian matrix: $M_{11}$, $M_{21}$, and $M_{31}$. Express your answers in terms of the problem data ($Q, A, b, c$) and the current iterate's variables ($x, \\lambda, s$). Your final answer should be a composite row matrix containing the three required block matrices in order. Use $I$ for the identity matrix and $0$ for a zero matrix of appropriate dimensions.", "solution": "We write the perturbed KKT equations as the mapping\n$$\nF(x,\\lambda,s) \\equiv \\begin{pmatrix}\nQx + c + A^{T}\\lambda \\\\\nAx + s - b \\\\\n\\operatorname{diag}(s)\\lambda - \\frac{1}{t}\\mathbf{1}\n\\end{pmatrix} = 0.\n$$\nThe Newton system linearizes this mapping at a strictly feasible point and uses its Jacobian. The first block-column of the Jacobian consists of the partial derivatives of each block equation with respect to $x$.\n\nFor the first equation $Qx + c + A^{T}\\lambda = 0$, the derivative with respect to $x$ is\n$$\n\\frac{\\partial}{\\partial x}(Qx + c + A^{T}\\lambda) = Q,\n$$\nso $M_{11} = Q$.\n\nFor the second equation $Ax + s - b = 0$, the derivative with respect to $x$ is\n$$\n\\frac{\\partial}{\\partial x}(Ax + s - b) = A,\n$$\nso $M_{21} = A$.\n\nFor the third equation $\\operatorname{diag}(s)\\lambda - \\frac{1}{t}\\mathbf{1} = 0$, there is no dependence on $x$, hence\n$$\n\\frac{\\partial}{\\partial x}\\big(\\operatorname{diag}(s)\\lambda - \\tfrac{1}{t}\\mathbf{1}\\big) = 0,\n$$\nso $M_{31} = 0$ (with appropriate dimensions $m \\times n$).\n\nTherefore, the first block-column is given by the three blocks $M_{11} = Q$, $M_{21} = A$, and $M_{31} = 0$, which we list in the requested composite row matrix order.", "answer": "$$\\boxed{\\begin{pmatrix} Q & A & 0 \\end{pmatrix}}$$", "id": "2155926"}]}