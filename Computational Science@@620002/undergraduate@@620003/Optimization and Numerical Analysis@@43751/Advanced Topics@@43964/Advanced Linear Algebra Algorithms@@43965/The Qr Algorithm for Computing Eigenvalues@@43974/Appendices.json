{"hands_on_practices": [{"introduction": "The best way to understand an algorithm is to perform it by hand. This first exercise guides you through one complete iteration of the unshifted QR algorithm. By applying the process to a small, symmetric matrix, you will solidify your understanding of the two core steps: the QR decomposition and the subsequent formation of the next iterate, $A_{k+1} = R_k Q_k$ [@problem_id:2219215]. This fundamental practice is the bedrock upon which more complex insights are built.", "problem": "The unshifted QR algorithm is an iterative numerical method used to compute the eigenvalues of a matrix. The process begins with a matrix $A_0 = A$. In each iteration $k$ (starting from $k=0$), the matrix $A_k$ is decomposed into a product $A_k = Q_k R_k$, where $Q_k$ is an orthogonal matrix and $R_k$ is an upper triangular matrix. The matrix for the next iteration is then computed as $A_{k+1} = R_k Q_k$.\n\nConsider the initial real symmetric matrix $A_0$ given by:\n$$A_0 = \\begin{pmatrix} 5 & 2 \\\\ 2 & 2 \\end{pmatrix}$$\nPerform one full iteration of the unshifted QR algorithm to find the matrix $A_1$. Your final answer should be the matrix $A_1$ with its entries expressed as exact fractions.", "solution": "We apply one unshifted QR step to $A_{0}=\\begin{pmatrix} 5 & 2 \\\\ 2 & 2 \\end{pmatrix}$. First compute the QR decomposition $A_{0}=Q_{0}R_{0}$ via Gram–Schmidt. Let the columns of $A_{0}$ be $a_{1}=\\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix}$ and $a_{2}=\\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}$. Compute $r_{11}=\\|a_{1}\\|=\\sqrt{5^{2}+2^{2}}=\\sqrt{29}$ and $q_{1}=a_{1}/r_{11}=\\begin{pmatrix} \\frac{5}{\\sqrt{29}} \\\\ \\frac{2}{\\sqrt{29}} \\end{pmatrix}$. Next, $r_{12}=q_{1}^{T}a_{2}=\\frac{1}{\\sqrt{29}}(5\\cdot 2+2\\cdot 2)=\\frac{14}{\\sqrt{29}}$. Form $u_{2}=a_{2}-r_{12}q_{1}=\\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}-\\frac{14}{29}\\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix}=\\begin{pmatrix} -\\frac{12}{29} \\\\ \\frac{30}{29} \\end{pmatrix}$, so $r_{22}=\\|u_{2}\\|=\\frac{2\\sqrt{261}}{29}$ and $q_{2}=u_{2}/r_{22}=\\begin{pmatrix} -\\frac{6}{\\sqrt{261}} \\\\ \\frac{15}{\\sqrt{261}} \\end{pmatrix}$. Therefore,\n$$\nQ_{0}=\\begin{pmatrix}\n\\frac{5}{\\sqrt{29}} & -\\frac{6}{\\sqrt{261}} \\\\\n\\frac{2}{\\sqrt{29}} & \\frac{15}{\\sqrt{261}}\n\\end{pmatrix},\\quad\nR_{0}=\\begin{pmatrix}\n\\sqrt{29} & \\frac{14}{\\sqrt{29}} \\\\\n0 & \\frac{18}{\\sqrt{261}}\n\\end{pmatrix}.\n$$\nThe next iterate is $A_{1}=R_{0}Q_{0}$. Compute the entries:\n$$\nA_{1}(1,1)=\\sqrt{29}\\cdot\\frac{5}{\\sqrt{29}}+\\frac{14}{\\sqrt{29}}\\cdot\\frac{2}{\\sqrt{29}}=5+\\frac{28}{29}=\\frac{173}{29},\n$$\n$$\nA_{1}(1,2)=\\sqrt{29}\\cdot\\left(-\\frac{6}{\\sqrt{261}}\\right)+\\frac{14}{\\sqrt{29}}\\cdot\\frac{15}{\\sqrt{261}}=-2+\\frac{70}{29}=\\frac{12}{29},\n$$\n$$\nA_{1}(2,1)=0\\cdot\\frac{5}{\\sqrt{29}}+\\frac{18}{\\sqrt{261}}\\cdot\\frac{2}{\\sqrt{29}}=\\frac{36}{3\\cdot 29}=\\frac{12}{29},\n$$\n$$\nA_{1}(2,2)=0\\cdot\\left(-\\frac{6}{\\sqrt{261}}\\right)+\\frac{18}{\\sqrt{261}}\\cdot\\frac{15}{\\sqrt{261}}=\\frac{270}{261}=\\frac{30}{29}.\n$$\nThus,\n$$\nA_{1}=\\begin{pmatrix}\n\\frac{173}{29} & \\frac{12}{29} \\\\\n\\frac{12}{29} & \\frac{30}{29}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{173}{29} & \\frac{12}{29} \\\\ \\frac{12}{29} & \\frac{30}{29}\\end{pmatrix}}$$", "id": "2219215"}, {"introduction": "Beyond the raw mechanics, it's crucial to grasp the deeper properties of the QR algorithm. Each iteration performs a unitary similarity transformation on the matrix, meaning $A_{k+1} = Q_k^T A_k Q_k$. This exercise explores a key consequence of this property: certain matrix characteristics, like the Frobenius norm, remain unchanged throughout the iterative process. By analyzing a rank-one matrix, you will discover this invariance firsthand and see that while the matrix entries evolve, its overall 'size' in the sense of the Frobenius norm is conserved [@problem_id:2219176].", "problem": "The basic (unshifted) QR algorithm is an iterative method for finding eigenvalues of a matrix. Starting with a matrix $A_0 = A$, the algorithm generates a sequence of matrices $\\{A_k\\}$ using the iterative formula $A_{k+1} = R_k Q_k$, where $A_k = Q_k R_k$ is the QR decomposition of $A_k$ into an orthogonal matrix $Q_k$ and an upper triangular matrix $R_k$.\n\nConsider an initial $3 \\times 3$ matrix $A_0$ which is a non-zero rank-one matrix defined as $A_0 = uv^T$, where $u$ and $v$ are column vectors in $\\mathbb{R}^3$ given by:\n$$ u = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}, \\quad v = \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix} $$\nLet $A_1$ be the matrix obtained after one complete iteration of the basic QR algorithm. The Frobenius norm of a matrix $M$ with entries $m_{ij}$ is defined as $\\|M\\|_F = \\sqrt{\\sum_{i,j} |m_{ij}|^2}$.\n\nDetermine the exact value of the Frobenius norm of the matrix $A_1$. Express your answer as a single closed-form analytic expression.", "solution": "The basic QR step produces $A_{1} = R_{0}Q_{0}$ where $A_{0} = Q_{0}R_{0}$ is the QR decomposition of $A_{0}$. Using $A_{0} = Q_{0}R_{0}$, we have\n$$\nA_{1} = R_{0}Q_{0} = Q_{0}^{T}A_{0}Q_{0}.\n$$\nThe Frobenius norm is unitarily invariant: for any orthogonal matrices $U$ and $V$,\n$$\n\\|UMV\\|_{F}^{2} = \\operatorname{trace}\\big((UMV)^{T}(UMV)\\big) = \\operatorname{trace}\\big(V^{T}M^{T}U^{T}UMV\\big) = \\operatorname{trace}\\big(V^{T}M^{T}MV\\big) = \\operatorname{trace}(M^{T}M) = \\|M\\|_{F}^{2}.\n$$\nTherefore,\n$$\n\\|A_{1}\\|_{F} = \\|A_{0}\\|_{F}.\n$$\n\nSince $A_{0} = uv^{T}$ is rank one, its Frobenius norm satisfies\n$$\n\\|uv^{T}\\|_{F}^{2} = \\operatorname{trace}\\big((uv^{T})^{T}(uv^{T})\\big) = \\operatorname{trace}\\big(vu^{T}uv^{T}\\big) = \\operatorname{trace}\\big((u^{T}u)\\,vv^{T}\\big) = (u^{T}u)\\operatorname{trace}(vv^{T}) = (u^{T}u)(v^{T}v),\n$$\nso\n$$\n\\|uv^{T}\\|_{F} = \\|u\\|_{2}\\,\\|v\\|_{2}.\n$$\n\nFor $u = \\begin{pmatrix}1 \\\\ 2 \\\\ 2\\end{pmatrix}$ and $v = \\begin{pmatrix}1 \\\\ -1 \\\\ 3\\end{pmatrix}$, compute\n$$\nu^{T}u = 1^{2} + 2^{2} + 2^{2} = 9, \\qquad v^{T}v = 1^{2} + (-1)^{2} + 3^{2} = 11.\n$$\nHence\n$$\n\\|A_{1}\\|_{F} = \\|A_{0}\\|_{F} = \\sqrt{(u^{T}u)(v^{T}v)} = \\sqrt{9 \\cdot 11} = 3\\sqrt{11}.\n$$", "answer": "$$\\boxed{3\\sqrt{11}}$$", "id": "2219176"}, {"introduction": "The unshifted QR algorithm is elegant but not always fast. Its convergence rate can be slow for matrices with eigenvalues that are close in magnitude, a situation exemplified by matrices that are nearly 'defective' like a Jordan block. This advanced problem challenges you to analyze such a case and quantify how an off-diagonal element changes after one iteration [@problem_id:2219199]. Your findings will reveal the limitations of the basic algorithm and provide a clear motivation for the powerful shifting strategies used to accelerate convergence in practice.", "problem": "The unshifted QR algorithm is a fundamental method for computing the eigenvalues of a matrix. The algorithm generates a sequence of matrices $\\{A_k\\}$ starting with $A_0 = A$. Each step consists of computing the QR decomposition of the current matrix, $A_k = Q_k R_k$, and then reversing the factors to form the next matrix, $A_{k+1} = R_k Q_k$. Here, $Q_k$ is an orthogonal matrix and $R_k$ is an upper-triangular matrix. For a unique decomposition, we enforce the condition that the diagonal entries of $R_k$ must be positive.\n\nThe convergence rate of the algorithm is known to be slow for matrices with eigenvalues of nearly equal magnitude. This behavior is particularly pronounced for matrices that are close to being non-diagonalizable (defective). A canonical example of a defective matrix is a Jordan block.\n\nConsider the matrix $A$ which is a small perturbation of a Jordan block:\n$$\nA = \\begin{pmatrix} \\lambda & 1 \\\\ \\delta^2 & \\lambda \\end{pmatrix}\n$$\nwhere $\\lambda$ is a positive real number and $\\delta$ is a real parameter such that $0 < |\\delta| \\ll \\lambda$. As $\\delta \\to 0$, this matrix approaches a defective Jordan block with a double eigenvalue at $\\lambda$.\n\nLet $A_0 = A$. Perform one full iteration of the unshifted QR algorithm to obtain the matrix $A_1$. The sub-diagonal entry, $(A_1)_{2,1}$, is a key indicator of the algorithm's progress towards finding the eigenvalues. Determine the exact expression for this entry, $(A_1)_{2,1}$, as a function of $\\lambda$ and $\\delta$.", "solution": "We write $A$ by columns as $A=[a_{1}\\ a_{2}]$ with $a_{1}=\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}$ and $a_{2}=\\begin{pmatrix}1\\\\ \\lambda\\end{pmatrix}$. The QR decomposition with positive diagonal entries in $R$ is obtained by Gram–Schmidt:\n1) Compute $r_{11}=\\|a_{1}\\|_{2}=\\sqrt{\\lambda^{2}+\\delta^{4}}>0$ and $q_{1}=a_{1}/r_{11}=\\frac{1}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}$.\n2) Compute $r_{12}=q_{1}^{\\top}a_{2}=\\frac{1}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\\left(\\lambda\\cdot 1+\\delta^{2}\\cdot \\lambda\\right)=\\frac{\\lambda(1+\\delta^{2})}{\\sqrt{\\lambda^{2}+\\delta^{4}}}$.\n3) Form $u_{2}=a_{2}-q_{1}r_{12}$. Using $r_{11}^{2}=\\lambda^{2}+\\delta^{4}$,\n$$\nu_{2}= \\begin{pmatrix}1\\\\ \\lambda\\end{pmatrix}-\\frac{\\lambda(1+\\delta^{2})}{\\lambda^{2}+\\delta^{4}}\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}\n=\\frac{\\lambda^{2}-\\delta^{2}}{\\lambda^{2}+\\delta^{4}}\\begin{pmatrix}-\\delta^{2}\\\\ \\lambda\\end{pmatrix}.\n$$\nHence $r_{22}=\\|u_{2}\\|_{2}=\\left|\\frac{\\lambda^{2}-\\delta^{2}}{\\lambda^{2}+\\delta^{4}}\\right|\\sqrt{\\lambda^{2}+\\delta^{4}}=\\frac{|\\lambda^{2}-\\delta^{2}|}{\\sqrt{\\lambda^{2}+\\delta^{4}}}>0$, and $q_{2}=u_{2}/r_{22}$ (its explicit form is not needed).\nWith $A=QR$ and $A_{1}=RQ$, the sub-diagonal entry is\n$$\n(A_{1})_{2,1}=R_{2,1}Q_{1,1}+R_{2,2}Q_{2,1}=r_{22}\\,q_{1,2},\n$$\nbecause $R_{2,1}=0$. Using $q_{1,2}=\\delta^{2}/\\sqrt{\\lambda^{2}+\\delta^{4}}$ and the expression for $r_{22}$,\n$$\n(A_{1})_{2,1}=\\frac{|\\lambda^{2}-\\delta^{2}|}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\\cdot \\frac{\\delta^{2}}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\n=\\frac{\\delta^{2}\\,|\\lambda^{2}-\\delta^{2}|}{\\lambda^{2}+\\delta^{4}}.\n$$\nGiven the stated regime $0<|\\delta|\\ll \\lambda$ with $\\lambda>0$, we have $\\lambda^{2}-\\delta^{2}>0$, so the absolute value may be dropped, yielding\n$$\n(A_{1})_{2,1}=\\frac{\\delta^{2}\\left(\\lambda^{2}-\\delta^{2}\\right)}{\\lambda^{2}+\\delta^{4}}.\n$$", "answer": "$$\\boxed{\\frac{\\delta^{2}\\left(\\lambda^{2}-\\delta^{2}\\right)}{\\lambda^{2}+\\delta^{4}}}$$", "id": "2219199"}]}