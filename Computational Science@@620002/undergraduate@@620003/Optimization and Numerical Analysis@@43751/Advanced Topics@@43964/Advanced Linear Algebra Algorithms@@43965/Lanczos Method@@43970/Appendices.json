{"hands_on_practices": [{"introduction": "The best way to understand the Lanczos algorithm is by performing the calculations yourself. This first exercise provides a direct, hands-on application of the Lanczos recurrence relations for a small, symmetric matrix [@problem_id:2184053]. By manually computing the first few steps, you will gain a concrete understanding of how the orthonormal basis and the tridiagonal matrix $T_k$ are constructed.", "problem": "Let a real symmetric matrix $A$ and a vector $b$ be defined as:\n$$\nA = \\begin{pmatrix} 4 & 1 & 1 \\\\ 1 & 2 & 0 \\\\ 1 & 0 & 3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe Lanczos algorithm is used to generate a sequence of tridiagonal matrices $T_k$ that approximate the eigenvalues of $A$. Using the vector $b$ as the starting vector for the algorithm, determine the $2 \\times 2$ tridiagonal matrix $T_2$ that is produced after two full iterations.", "solution": "We apply the Lanczos algorithm using the notation from the main text. The orthonormal vectors are denoted by $q_j$, and the tridiagonal matrix is $T_2 = \\begin{pmatrix} \\alpha_1 & \\beta_2 \\\\ \\beta_2 & \\alpha_2 \\end{pmatrix}$.\n\n**Step 0: Initialization**\nThe starting vector $b$ has a norm of $\\|b\\|_2 = 1$, so we set the first Lanczos vector $q_1 = b$. We also initialize $\\beta_1 = 0$ and $q_0 = \\mathbf{0}$.\n\n**Step 1: First Iteration (j=1)**\nFollowing the recurrence $\\beta_{j+1} q_{j+1} = A q_j - \\alpha_j q_j - \\beta_j q_{j-1}$:\n1.  Compute $w_1 = A q_1 = \\begin{pmatrix} 4 \\\\ 1 \\\\ 1 \\end{pmatrix}$.\n2.  Compute the diagonal element $\\alpha_1 = q_1^T w_1 = 4$.\n3.  Compute the unnormalized next vector: $\\tilde{w}_1 = w_1 - \\alpha_1 q_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$.\n4.  Compute the off-diagonal element $\\beta_2 = \\|\\tilde{w}_1\\|_2 = \\sqrt{2}$.\n5.  Normalize to find the next vector: $q_2 = \\tilde{w}_1 / \\beta_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$.\n\n**Step 2: Second Iteration (j=2)**\n1.  Compute the vector for the recurrence: $w_2 = A q_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 2 \\\\ 2 \\\\ 3 \\end{pmatrix}$.\n2.  Compute the diagonal element $\\alpha_2 = q_2^T w_2 = \\frac{1}{2}(0 \\cdot 2 + 1 \\cdot 2 + 1 \\cdot 3) = \\frac{5}{2}$.\n\n**Result:**\nThe required tridiagonal matrix is:\n$$ T_2 = \\begin{pmatrix} 4 & \\sqrt{2} \\\\ \\sqrt{2} & \\frac{5}{2} \\end{pmatrix} $$", "answer": "$$\\boxed{\\begin{pmatrix} 4 & \\sqrt{2} \\\\ \\sqrt{2} & \\frac{5}{2} \\end{pmatrix}}$$", "id": "2184053"}, {"introduction": "Now that you are familiar with the mechanical steps, let's explore a special case that reveals the power of the Lanczos method. This problem investigates what happens when the starting vector is an eigenvector of the matrix [@problem_id:2184039]. This scenario beautifully illustrates how the algorithm behaves when the Krylov subspace is minimal, providing a direct link between the method's output and the matrix's exact eigenvalues.", "problem": "Consider the real symmetric matrix $A$ and the starting vector $b$ given by:\n$$A = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$$\nThe Lanczos algorithm is a numerical procedure used to find approximations of eigenvalues of a matrix. Starting with the vector $b$, the algorithm generates a sequence of orthonormal vectors $q_1, q_2, \\ldots, q_k$ and a real symmetric tridiagonal matrix $T_k$. The entries of this matrix are determined by the Lanczos recurrence relations. The first vector in the orthonormal sequence is defined by normalizing the starting vector, $q_1 = b / ||b||_2$, and the first diagonal element of $T_k$ is computed as $\\alpha_1 = q_1^T A q_1$.\n\nSuppose you apply the Lanczos algorithm with the given matrix $A$ and starting vector $b$. What is the value of the first diagonal element, $\\alpha_1$?\n\nA. $0$\n\nB. $1$\n\nC. $2$\n\nD. $\\sqrt{2}$\n\nE. $2 + \\sqrt{2}$", "solution": "The Lanczos algorithm sets $q_{1} = b / \\|b\\|_{2}$ and computes $\\alpha_{1} = q_{1}^{T} A q_{1}$. Using the normalization, this can be written as\n$$\n\\alpha_{1} = \\frac{b^{T} A b}{b^{T} b}.\n$$\nFirst compute the norm of $b$:\n$$\n\\|b\\|_{2} = \\sqrt{b^{T} b} = \\sqrt{1^{2} + 0^{2} + (-1)^{2}} = \\sqrt{2}.\n$$\nNext compute $A b$. With\n$$\nA = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix},\n$$\nwe have\n$$\nA b = \\begin{pmatrix} 2\\cdot 1 + (-1)\\cdot 0 + 0\\cdot (-1) \\\\ (-1)\\cdot 1 + 2\\cdot 0 + (-1)\\cdot (-1) \\\\ 0\\cdot 1 + (-1)\\cdot 0 + 2\\cdot (-1) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 0 \\\\ -2 \\end{pmatrix} = 2 b.\n$$\nTherefore,\n$$\nb^{T} A b = b^{T} (2 b) = 2\\, b^{T} b.\n$$\nSubstituting into the expression for $\\alpha_{1}$ gives\n$$\n\\alpha_{1} = \\frac{2\\, b^{T} b}{b^{T} b} = 2.\n$$\nThus the correct option is C.", "answer": "$$\\boxed{C}$$", "id": "2184039"}, {"introduction": "A deep understanding of any algorithm includes knowing its limitations. This final exercise challenges you to apply the symmetric Lanczos algorithm to a non-symmetric matrix, a situation for which it was not designed [@problem_id:2184074]. By observing which fundamental property fails, you will gain critical insight into why matrix symmetry is an essential requirement for the standard Lanczos method to produce a symmetric tridiagonalization.", "problem": "The symmetric Lanczos algorithm is a numerical method used to find eigenvalues of a large symmetric matrix. It generates an orthonormal basis for a Krylov subspace through a three-term recurrence relation. The steps are as follows:\n\nGiven a real symmetric $n \\times n$ matrix $A$ and an arbitrary starting vector $v_1$ with Euclidean norm $\\|v_1\\|_2 = 1$.\n1.  Initialize $\\beta_1 = 0$ and $v_0 = \\mathbf{0}$ (the zero vector).\n2.  For $j = 1, 2, \\dots$:\n    a. Compute the vector $w_j = A v_j$.\n    b. Compute the coefficient $\\alpha_j = v_j^T w_j$.\n    c. Compute the residual vector $w'_j = w_j - \\alpha_j v_j - \\beta_j v_{j-1}$.\n    d. Compute the coefficient $\\beta_{j+1} = \\|w'_j\\|_2$.\n    e. If $\\beta_{j+1}$ is zero (or close to it in practice), the algorithm terminates.\n    f. Normalize to find the next vector: $v_{j+1} = w'_j / \\beta_{j+1}$.\n\nThis process generates a set of orthonormal vectors $\\{v_j\\}$ and a real symmetric tridiagonal matrix $T$ with diagonal entries $\\alpha_j$ and off-diagonal entries $\\beta_{j+1}$. For a symmetric matrix $A$, a key property is that the projection of $A$ onto the subspace spanned by the Lanczos vectors is this tridiagonal matrix, i.e., $V^T A V = T$, where $V$ is the matrix whose columns are the Lanczos vectors $v_j$.\n\nConsider applying this algorithm, which is specifically designed for symmetric matrices, to the following non-symmetric $2 \\times 2$ matrix:\n$$A = \\begin{pmatrix} 1 & -1 \\\\ 2 & 1 \\end{pmatrix}$$\nUse the starting vector $v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n\nAfter performing one full step of the algorithm to generate the scalars $\\alpha_1$, $\\beta_2$ and the vector $v_2$, determine which of the following fundamental properties, that is guaranteed to hold for a symmetric matrix, fails in this case.\n\nA. The newly generated vector $v_2$ is not orthogonal to the starting vector $v_1$; i.e., $v_1^T v_2 \\neq 0$.\n\nB. The $(1,2)$ entry of the projected matrix $V^TAV$ does not match the corresponding entry in the generated symmetric tridiagonal matrix $T$; i.e., $v_1^T A v_2 \\neq \\beta_2$.\n\nC. The algorithm cannot proceed because the generated vector $v_2$ is identical to $v_1$.\n\nD. The algorithm terminates prematurely because the residual vector $w'_1$ is the zero vector.\n\nE. The second diagonal entry of the projected matrix $V^TAV$ is not equal to the computed $\\alpha_2$; i.e., $v_2^T A v_2 \\neq \\alpha_2$.", "solution": "We are given the nonsymmetric matrix\n$$\nA=\\begin{pmatrix}1&-1\\\\2&1\\end{pmatrix},\n$$\nwith starting vector\n$$\nv_{1}=\\begin{pmatrix}1\\\\0\\end{pmatrix},\\quad \\|v_{1}\\|_{2}=1,\n$$\nand initializations $\\beta_{1}=0$ and $v_{0}=\\mathbf{0}$.\n\nApply the Lanczos step for $j=1$:\n1) Compute\n$$\nw_{1}=A v_{1}=\\begin{pmatrix}1\\\\2\\end{pmatrix}.\n$$\n2) Compute\n$$\n\\alpha_{1}=v_{1}^{T}w_{1}= \\begin{pmatrix}1&0\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=1.\n$$\n3) Form the residual\n$$\nw_{1}'=w_{1}-\\alpha_{1}v_{1}-\\beta_{1}v_{0}=\\begin{pmatrix}1\\\\2\\end{pmatrix}-1\\begin{pmatrix}1\\\\0\\end{pmatrix}-0\\cdot \\mathbf{0}=\\begin{pmatrix}0\\\\2\\end{pmatrix}.\n$$\n4) Its norm is\n$$\n\\beta_{2}=\\|w_{1}'\\|_{2}=\\sqrt{0^{2}+2^{2}}=2\\neq 0,\n$$\nso the algorithm does not terminate.\n5) Normalize to obtain\n$$\nv_{2}=\\frac{w_{1}'}{\\beta_{2}}=\\frac{1}{2}\\begin{pmatrix}0\\\\2\\end{pmatrix}=\\begin{pmatrix}0\\\\1\\end{pmatrix}.\n$$\n\nNow check the listed properties:\n\n- Orthogonality of $v_{2}$ to $v_{1}$:\n$$\nv_{1}^{T}v_{2}=\\begin{pmatrix}1&0\\end{pmatrix}\\begin{pmatrix}0\\\\1\\end{pmatrix}=0,\n$$\nso $v_{2}$ is orthogonal to $v_{1}$. Thus A does not fail.\n\n- Off-diagonal match in the projection:\nDefine $V=[v_{1}\\ v_{2}]=I$, hence\n$$\nV^{T}AV=A=\\begin{pmatrix}1&-1\\\\2&1\\end{pmatrix}.\n$$\nWe have already computed $\\beta_{2}=2$. Compute\n$$\nv_{1}^{T}A v_{2}=\\begin{pmatrix}1&0\\end{pmatrix}\\left(A\\begin{pmatrix}0\\\\1\\end{pmatrix}\\right)=\\begin{pmatrix}1&0\\end{pmatrix}\\begin{pmatrix}-1\\\\1\\end{pmatrix}=-1\\neq \\beta_{2}=2.\n$$\nTherefore the property $v_{1}^{T}A v_{2}=\\beta_{2}$, which holds for symmetric $A$, fails here. Thus B fails.\n\n- Identity of $v_{2}$ and $v_{1}$:\n$$\nv_{2}=\\begin{pmatrix}0\\\\1\\end{pmatrix}\\neq \\begin{pmatrix}1\\\\0\\end{pmatrix}=v_{1},\n$$\nso C does not fail.\n\n- Premature termination:\n$$\nw_{1}'=\\begin{pmatrix}0\\\\2\\end{pmatrix}\\neq \\mathbf{0},\n$$\nso D does not fail.\n\n- Diagonal entry consistency for the second vector:\nCompute\n$$\nw_{2}=A v_{2}=\\begin{pmatrix}-1\\\\1\\end{pmatrix},\\quad \\alpha_{2}=v_{2}^{T}w_{2}=\\begin{pmatrix}0&1\\end{pmatrix}\\begin{pmatrix}-1\\\\1\\end{pmatrix}=1,\n$$\nand\n$$\nv_{2}^{T}A v_{2}=\\alpha_{2}=1,\n$$\nso E does not fail.\n\nHence, the fundamental property that fails is the off-diagonal equality $v_{1}^{T}A v_{2}=\\beta_{2}$, i.e., option B.\n\nFor completeness, note that although $v_{1}^{T}A v_{2}\\neq \\beta_{2}$, one still has $v_{2}^{T}A v_{1}=\\beta_{2}$ from the construction:\n$$\nv_{2}^{T}A v_{1}=\\begin{pmatrix}0&1\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=2=\\beta_{2},\n$$\nhighlighting the asymmetry that breaks the symmetric Lanczos identity $v_{1}^{T}A v_{2}=v_{2}^{T}A v_{1}$.", "answer": "$$\\boxed{B}$$", "id": "2184074"}]}