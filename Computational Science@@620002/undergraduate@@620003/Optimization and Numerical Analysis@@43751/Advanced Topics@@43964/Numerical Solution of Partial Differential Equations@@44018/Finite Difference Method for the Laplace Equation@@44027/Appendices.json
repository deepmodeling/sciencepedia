{"hands_on_practices": [{"introduction": "The journey from a continuous partial differential equation to a numerical solution begins with discretization. This first practice exercise [@problem_id:2101988] guides you through this fundamental process. By applying the five-point stencil to a simple $2 \\times 2$ grid, you will construct the system of linear equations that approximates the Laplace equation, gaining insight into how the connectivity of the grid points translates directly into the structure of the resulting coefficient matrix.", "problem": "Consider a long, hollow conducting pipe with a square cross-section in the $xy$-plane, defined by the region $0 \\le x \\le L$ and $0 \\le y \\le L$. The walls of the pipe are maintained at a constant electrostatic potential $V_0$. Far from the ends of the pipe, the electrostatic potential $V(x,y)$ inside the pipe is governed by the two-dimensional Laplace equation:\n$$\n\\frac{\\partial^2 V}{\\partial x^2} + \\frac{\\partial^2 V}{\\partial y^2} = 0\n$$\nTo find an approximate solution for the potential, we can use the finite difference method. We discretize the domain with a uniform grid spacing of $h = L/3$ in both directions. This creates a set of four interior grid points at locations $(ih, jh)$ for $i,j \\in \\{1, 2\\}$. Let $V_{ij}$ denote the potential $V(ih, jh)$ at these interior points.\n\nThe value of the potential at each interior grid point is approximated as the average of the potentials at its four nearest neighbors (the five-point stencil method), which can be algebraically rearranged from the discrete form of Laplace's equation:\n$$\n4V_{ij} - V_{i+1,j} - V_{i-1,j} - V_{i,j+1} - V_{i,j-1} = 0\n$$\nApplying this relation at each of the four interior points, and using the known boundary potentials, yields a system of four linear equations for the four unknown potentials. This system can be written in matrix form as $A\\mathbf{v} = \\mathbf{b}$.\n\nLet the vector of unknown potentials be ordered column-by-column as $\\mathbf{v} = [V_{11}, V_{12}, V_{21}, V_{22}]^T$. Determine the numerical value of the determinant of the coefficient matrix $A$.", "solution": "The five-point stencil for the discrete Laplace equation at each interior node gives, for $(i,j)\\in\\{(1,1),(1,2),(2,1),(2,2)\\}$,\n$$\n4V_{ij} - V_{i+1,j} - V_{i-1,j} - V_{i,j+1} - V_{i,j-1} = 0.\n$$\nMoving known boundary values to the right-hand side leaves the coefficients of the unknowns unchanged. Writing the equations explicitly and ordering the unknowns as $\\mathbf{v}=[V_{11},V_{12},V_{21},V_{22}]^{T}$ yields\n- At $(1,1)$: $4V_{11} - V_{12} - V_{21} = V_{01}+V_{10}$.\n- At $(1,2)$: $-V_{11} + 4V_{12} - V_{22} = V_{02}+V_{13}$.\n- At $(2,1)$: $-V_{11} + 4V_{21} - V_{22} = V_{31}+V_{20}$.\n- At $(2,2)$: $-V_{12} - V_{21} + 4V_{22} = V_{32}+V_{23}$.\n\nThus the coefficient matrix $A$ (independent of boundary values) is\n$$\nA=\\begin{pmatrix}\n4 & -1 & -1 & 0\\\\\n-1 & 4 & 0 & -1\\\\\n-1 & 0 & 4 & -1\\\\\n0 & -1 & -1 & 4\n\\end{pmatrix}.\n$$\nPartitioning $A$ into $2\\times 2$ blocks as\n$$\nA=\\begin{pmatrix}B & C\\\\ C & B\\end{pmatrix},\\quad\nB=\\begin{pmatrix}4 & -1\\\\ -1 & 4\\end{pmatrix},\\quad\nC=\\begin{pmatrix}-1 & 0\\\\ 0 & -1\\end{pmatrix},\n$$\nwe use the standard block-diagonalization via the orthogonal matrix that maps symmetric and antisymmetric combinations, which yields\n$$\n\\det(A)=\\det(B+C)\\,\\det(B-C).\n$$\nCompute\n$$\nB+C=\\begin{pmatrix}3 & -1\\\\ -1 & 3\\end{pmatrix},\\quad \\det(B+C)=3\\cdot 3-(-1)(-1)=8,\n$$\n$$\nB-C=\\begin{pmatrix}5 & -1\\\\ -1 & 5\\end{pmatrix},\\quad \\det(B-C)=5\\cdot 5-(-1)(-1)=24.\n$$\nTherefore,\n$$\n\\det(A)=8\\times 24=192.\n$$", "answer": "$$\\boxed{192}$$", "id": "2101988"}, {"introduction": "Once the Laplace equation is discretized into a linear system $A\\mathbf{u}=\\mathbf{b}$, we need an efficient way to solve for the unknown potentials $\\mathbf{u}$. This exercise [@problem_id:2172039] introduces the Jacobi method, a classic iterative approach where each point's new value is calculated based on its neighbors from the previous iteration. Performing your first Jacobi iteration will give you a concrete feel for how these methods progressively refine an initial guess towards the correct solution.", "problem": "Consider the problem of determining the electrostatic potential $u(x,y)$ inside a square, charge-free region. The potential satisfies the two-dimensional Laplace equation:\n$$\n\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0\n$$\nThe domain is discretized into a uniform grid of points $(x_i, y_j)$, where $x_i = i \\cdot h$ and $y_j = j \\cdot h$ for $i,j \\in \\{0, 1, 2, 3\\}$. The grid spacing $h$ is constant. This grid results in four interior points: $(x_1, y_1)$, $(x_1, y_2)$, $(x_2, y_1)$, and $(x_2, y_2)$. Let the potential at these grid points be denoted by $u_{ij} = u(x_i, y_j)$.\n\nThe potential on the boundary is fixed. The values at the boundary points adjacent to the interior grid points are given as follows:\n- On the left boundary: $u_{0,1} = 21.0$ V and $u_{0,2} = 21.0$ V.\n- On the right boundary: $u_{3,1} = 41.0$ V and $u_{3,2} = 41.0$ V.\n- On the bottom boundary: $u_{1,0} = 9.0$ V and $u_{2,0} = 9.0$ V.\n- On the top boundary: $u_{1,3} = 81.0$ V and $u_{2,3} = 81.0$ V.\n\nThe Laplace equation is approximated using the standard five-point stencil finite difference formula, which relates the potential at an interior point to its four nearest neighbors. The Jacobi method is used to solve the resulting system of linear equations.\n\nStarting with an initial guess of $u_{ij}^{(0)} = 0$ V for all four interior points (where $i,j \\in \\{1,2\\}$), calculate the numerical values of the potential at these points after one complete iteration of the Jacobi method.\n\nProvide the updated potential values for $u_{11}, u_{12}, u_{21}, u_{22}$ in this specific order. The final answer should be a set of four numbers. Do not include units in your final answer.", "solution": "The two-dimensional Laplace equation discretized with the standard five-point stencil on a uniform grid gives, for an interior node $(i,j)$,\n$$\n\\frac{u_{i+1,j}-2u_{i,j}+u_{i-1,j}}{h^{2}}+\\frac{u_{i,j+1}-2u_{i,j}+u_{i,j-1}}{h^{2}}=0,\n$$\nwhich simplifies to the averaging relation\n$$\nu_{i,j}=\\frac{1}{4}\\left(u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}\\right).\n$$\nThe Jacobi iteration updates each interior point using neighbors from the previous iterate:\n$$\nu_{i,j}^{(k+1)}=\\frac{1}{4}\\left(u_{i+1,j}^{(k)}+u_{i-1,j}^{(k)}+u_{i,j+1}^{(k)}+u_{i,j-1}^{(k)}\\right),\n$$\nwith boundary values held fixed. With the initial guess $u_{ij}^{(0)}=0$ for $i,j\\in\\{1,2\\}$ and the given boundary data, the first-iteration updates are:\n\nFor $u_{11}$:\n$$\nu_{11}^{(1)}=\\frac{1}{4}\\left(u_{21}^{(0)}+u_{01}+u_{12}^{(0)}+u_{10}\\right)=\\frac{1}{4}\\left(0+21+0+9\\right)=7.5.\n$$\n\nFor $u_{12}$:\n$$\nu_{12}^{(1)}=\\frac{1}{4}\\left(u_{22}^{(0)}+u_{02}+u_{13}+u_{11}^{(0)}\\right)=\\frac{1}{4}\\left(0+21+81+0\\right)=25.5.\n$$\n\nFor $u_{21}$:\n$$\nu_{21}^{(1)}=\\frac{1}{4}\\left(u_{31}+u_{11}^{(0)}+u_{22}^{(0)}+u_{20}\\right)=\\frac{1}{4}\\left(41+0+0+9\\right)=12.5.\n$$\n\nFor $u_{22}$:\n$$\nu_{22}^{(1)}=\\frac{1}{4}\\left(u_{32}+u_{12}^{(0)}+u_{23}+u_{21}^{(0)}\\right)=\\frac{1}{4}\\left(41+0+81+0\\right)=30.5.\n$$\n\nThus, after one Jacobi iteration starting from zero, the updated potentials in the order $(u_{11},u_{12},u_{21},u_{22})$ are $(7.5,25.5,12.5,30.5)$.", "answer": "$$\\boxed{\\begin{pmatrix} 7.5 & 25.5 & 12.5 & 30.5 \\end{pmatrix}}$$", "id": "2172039"}, {"introduction": "While the Jacobi method is intuitive, its convergence can be slow. This practice [@problem_id:2172011] explores a more advanced technique, the Gauss-Seidel method with red-black ordering, which often converges faster and is a cornerstone of parallel scientific computing. By separating the grid points into two \"colors\" and updating them in stages, you will see how we can use the most recent information available to accelerate the solution process, a key strategy in modern numerical solvers.", "problem": "Consider the problem of determining the steady-state temperature distribution $T(x,y)$ on a thin, square metallic plate occupying the region $[0, L] \\times [0, L]$. The distribution is governed by the two-dimensional Laplace equation, a Partial Differential Equation (PDE), given by $\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = 0$.\n\nThe problem is discretized on a uniform grid with a spacing of $h=L/4$, creating a $3 \\times 3$ lattice of interior points $(x_i, y_j) = (ih, jh)$ where $i,j \\in \\{1, 2, 3\\}$. The temperature at these interior points is denoted by $T_{i,j}$. The temperature at boundary points $(x_i, y_j)$ where $i \\in \\{0,4\\}$ or $j \\in \\{0,4\\}$ is fixed.\n\nThe boundary conditions are defined as:\n- $T_{i,0} = 0$ for $i=0, \\dots, 4$ (bottom edge)\n- $T_{0,j} = 0$ for $j=0, \\dots, 4$ (left edge)\n- $T_{4,j} = 0$ for $j=0, \\dots, 4$ (right edge)\n- $T_{i,4} = 152$ for $i=0, \\dots, 4$ (top edge)\n\nThe standard five-point finite difference approximation for the Laplace equation at any interior point $(i,j)$ relates its temperature to its four nearest neighbors:\n$$T_{i,j} = \\frac{1}{4}(T_{i-1,j} + T_{i+1,j} + T_{i,j-1} + T_{i,j+1})$$\n\nAn iterative solver is used to find the temperature distribution. The solver is initialized with a guess of $T^{(0)}_{i,j} = 0$ for all interior points. The solver updates the temperatures using a special two-stage process for each iteration $k=1, 2, \\dots$:\n\n1.  **Stage 1:** For all interior points $(i,j)$ where the sum of indices $i+j$ is an **even** number, a new temporary value $T'_{i,j}$ is calculated using the temperatures from the previous iteration, $T^{(k-1)}$, for all its neighbors.\n2.  **Stage 2:** For all interior points $(i,j)$ where the sum of indices $i+j$ is an **odd** number, a new value $T''_{i,j}$ is calculated using the most up-to-date neighbor values available. This means using the temporary values $T'_{i',j'}$ computed in Stage 1 for any neighbor where $i'+j'$ is even, and values from the previous iteration $T^{(k-1)}_{i'',j''}$ for any neighbor where $i''+j''$ is odd (or fixed boundary values).\n\nAfter both stages are complete, the temperature field for the end of iteration $k$ is defined as $T^{(k)}_{i,j} = T'_{i,j}$ for points from Stage 1, and $T^{(k)}_{i,j} = T''_{i,j}$ for points from Stage 2.\n\nCalculate the temperature $T_{2,2}$ at the center of the plate after **two full iterations** (i.e., find the value of $T^{(2)}_{2,2}$). Round your final answer to three significant figures.", "solution": "We discretize the Laplace equation using the five-point stencil at interior nodes:\n$$\nT_{i,j}=\\frac{1}{4}\\left(T_{i-1,j}+T_{i+1,j}+T_{i,j-1}+T_{i,j+1}\\right),\n$$\nwith boundary values $T_{i,0}=0$, $T_{0,j}=0$, $T_{4,j}=0$, and $T_{i,4}=152$. The interior nodes are $(i,j)\\in\\{1,2,3\\}\\times\\{1,2,3\\}$. The initial guess is $T^{(0)}_{i,j}=0$ for all interior nodes. The iterative scheme updates even-sum nodes $(i+j$ even$)$ in Stage 1 using only values from the previous iterate, and odd-sum nodes $(i+j$ odd$)$ in Stage 2 using the most up-to-date neighbor values.\n\nIteration 1, Stage 1 (even nodes, using $T^{(0)}$ and boundary data):\n$$\nT'_{1,1}=\\frac{1}{4}\\left(T_{0,1}+T^{(0)}_{2,1}+T_{1,0}+T^{(0)}_{1,2}\\right)=\\frac{1}{4}(0+0+0+0)=0,\n$$\n$$\nT'_{3,1}=\\frac{1}{4}\\left(T^{(0)}_{2,1}+T_{4,1}+T_{3,0}+T^{(0)}_{3,2}\\right)=\\frac{1}{4}(0+0+0+0)=0,\n$$\n$$\nT'_{2,2}=\\frac{1}{4}\\left(T^{(0)}_{1,2}+T^{(0)}_{3,2}+T^{(0)}_{2,1}+T^{(0)}_{2,3}\\right)=\\frac{1}{4}(0+0+0+0)=0,\n$$\n$$\nT'_{1,3}=\\frac{1}{4}\\left(T_{0,3}+T^{(0)}_{2,3}+T^{(0)}_{1,2}+T_{1,4}\\right)=\\frac{1}{4}(0+0+0+152)=38,\n$$\n$$\nT'_{3,3}=\\frac{1}{4}\\left(T^{(0)}_{2,3}+T_{4,3}+T^{(0)}_{3,2}+T_{3,4}\\right)=\\frac{1}{4}(0+0+0+152)=38.\n$$\n\nIteration 1, Stage 2 (odd nodes, using $T'$ for even neighbors and $T^{(0)}$ for odd neighbors):\n$$\nT''_{2,1}=\\frac{1}{4}\\left(T'_{1,1}+T'_{3,1}+T_{2,0}+T'_{2,2}\\right)=\\frac{1}{4}(0+0+0+0)=0,\n$$\n$$\nT''_{1,2}=\\frac{1}{4}\\left(T_{0,2}+T'_{2,2}+T'_{1,1}+T'_{1,3}\\right)=\\frac{1}{4}(0+0+0+38)=9.5,\n$$\n$$\nT''_{3,2}=\\frac{1}{4}\\left(T'_{2,2}+T_{4,2}+T'_{3,1}+T'_{3,3}\\right)=\\frac{1}{4}(0+0+0+38)=9.5,\n$$\n$$\nT''_{2,3}=\\frac{1}{4}\\left(T'_{1,3}+T'_{3,3}+T'_{2,2}+T_{2,4}\\right)=\\frac{1}{4}(38+38+0+152)=57.\n$$\nThus after iteration 1: even nodes take $T'$, odd nodes take $T''$; in particular,\n$T^{(1)}_{1,3}=38$, $T^{(1)}_{3,3}=38$, $T^{(1)}_{1,2}=9.5$, $T^{(1)}_{3,2}=9.5$, $T^{(1)}_{2,3}=57$, and the remaining interior values are $0$.\n\nIteration 2, Stage 1 (even nodes, using $T^{(1)}$ for all neighbors):\n$$\nT'_{1,1}=\\frac{1}{4}\\left(T_{0,1}+T^{(1)}_{2,1}+T_{1,0}+T^{(1)}_{1,2}\\right)=\\frac{1}{4}(0+0+0+9.5)=2.375,\n$$\n$$\nT'_{3,1}=\\frac{1}{4}\\left(T^{(1)}_{2,1}+T_{4,1}+T_{3,0}+T^{(1)}_{3,2}\\right)=\\frac{1}{4}(0+0+0+9.5)=2.375,\n$$\n$$\nT'_{2,2}=\\frac{1}{4}\\left(T^{(1)}_{1,2}+T^{(1)}_{3,2}+T^{(1)}_{2,1}+T^{(1)}_{2,3}\\right)=\\frac{1}{4}(9.5+9.5+0+57)=19,\n$$\n$$\nT'_{1,3}=\\frac{1}{4}\\left(T_{0,3}+T^{(1)}_{2,3}+T^{(1)}_{1,2}+T_{1,4}\\right)=\\frac{1}{4}(0+57+9.5+152)=54.625,\n$$\n$$\nT'_{3,3}=\\frac{1}{4}\\left(T^{(1)}_{2,3}+T_{4,3}+T^{(1)}_{3,2}+T_{3,4}\\right)=\\frac{1}{4}(57+0+9.5+152)=54.625.\n$$\n\nIteration 2, Stage 2 (odd nodes, using $T'$ for even neighbors and $T^{(1)}$ for odd neighbors):\n$$\nT''_{2,1}=\\frac{1}{4}\\left(T'_{1,1}+T'_{3,1}+T_{2,0}+T'_{2,2}\\right)=\\frac{1}{4}(2.375+2.375+0+19)=5.9375,\n$$\n$$\nT''_{1,2}=\\frac{1}{4}\\left(T_{0,2}+T'_{2,2}+T'_{1,1}+T'_{1,3}\\right)=\\frac{1}{4}(0+19+2.375+54.625)=19,\n$$\n$$\nT''_{3,2}=\\frac{1}{4}\\left(T'_{2,2}+T_{4,2}+T'_{3,1}+T'_{3,3}\\right)=\\frac{1}{4}(19+0+2.375+54.625)=19,\n$$\n$$\nT''_{2,3}=\\frac{1}{4}\\left(T'_{1,3}+T'_{3,3}+T'_{2,2}+T_{2,4}\\right)=\\frac{1}{4}(54.625+54.625+19+152)=70.0625.\n$$\n\nBy the scheme definition, after iteration $k=2$, even nodes take their Stage 1 values and odd nodes take their Stage 2 values. Therefore,\n$$\nT^{(2)}_{2,2}=T'_{2,2}=19.0.\n$$\nRounded to three significant figures, this is $19.0$.", "answer": "$$\\boxed{19.0}$$", "id": "2172011"}]}