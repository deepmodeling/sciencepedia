{"hands_on_practices": [{"introduction": "Before we can solve differential equations, we must first learn how to represent any given function, such as an initial condition, using our chosen set of basis functions. This exercise [@problem_id:2204923] guides you through the fundamental process of projecting a function onto a Fourier sine basis to find its spectral coefficients. Mastering this skill is the essential first step towards harnessing the power of spectral methods.", "problem": "In the analysis of physical systems, such as the vibration of a string or heat conduction in a rod, it is often useful to represent an initial state as a series of sine functions. This approach is fundamental to spectral methods for solving partial differential equations.\n\nConsider a function $f(x)$ defined on the interval $x \\in [0, 1]$. This function describes an initial profile and is given by the piecewise definition:\n$$\nf(x) = \\begin{cases} \n2x & \\text{for } 0 \\le x \\le 1/2 \\\\\n2(1-x) & \\text{for } 1/2 < x \\le 1 \n\\end{cases}\n$$\nThis function can be represented by its Fourier sine series on the interval $[0, 1]$, which has the form:\n$$\nf(x) = \\sum_{n=1}^{\\infty} b_n \\sin(n\\pi x)\n$$\nDetermine the exact values of the first three non-zero coefficients $b_n$ in this series expansion. Present your answer as a row matrix containing the three coefficients, ordered by their increasing index $n$.", "solution": "For the Fourier sine series on $[0,1]$, the coefficients are given by the orthogonality of $\\{\\sin(n\\pi x)\\}_{n\\ge 1}$:\n$$\nb_{n} = 2 \\int_{0}^{1} f(x)\\,\\sin(n\\pi x)\\,dx.\n$$\nWith the given piecewise $f(x)$, split the integral:\n$$\nb_{n} = 2\\left[\\int_{0}^{1/2} 2x\\,\\sin(n\\pi x)\\,dx + \\int_{1/2}^{1} 2(1-x)\\,\\sin(n\\pi x)\\,dx\\right] = 4\\left[I_{1}+I_{2}\\right],\n$$\nwhere\n$$\nI_{1} = \\int_{0}^{1/2} x\\,\\sin(n\\pi x)\\,dx,\\qquad I_{2} = \\int_{1/2}^{1} (1-x)\\,\\sin(n\\pi x)\\,dx.\n$$\nUse the substitution $u=1-x$ in $I_{2}$ and the identity $\\sin(n\\pi(1-u)) = \\sin(n\\pi)\\cos(n\\pi u) - \\cos(n\\pi)\\sin(n\\pi u) = (-1)^{n+1}\\sin(n\\pi u)$ to obtain\n$$\nI_{2} = (-1)^{n+1}\\int_{0}^{1/2} u\\,\\sin(n\\pi u)\\,du = (-1)^{n+1} I_{1}.\n$$\nHence\n$$\nb_{n} = 4\\left[1 + (-1)^{n+1}\\right] I_{1}.\n$$\nTherefore $b_{n}=0$ for even $n$, and for odd $n$ we have $b_{n} = 8 I_{1}$. It remains to compute $I_{1}$:\n$$\nI_{1} = \\int_{0}^{1/2} x\\,\\sin(n\\pi x)\\,dx.\n$$\nIntegrate by parts with $u=x$, $dv=\\sin(n\\pi x)\\,dx$, so $du=dx$ and $v=-\\cos(n\\pi x)/(n\\pi)$. Then\n$$\nI_{1} = \\left[-\\frac{x\\cos(n\\pi x)}{n\\pi} + \\frac{\\sin(n\\pi x)}{(n\\pi)^{2}}\\right]_{0}^{1/2}\n= -\\frac{1}{2n\\pi}\\cos\\!\\left(\\frac{n\\pi}{2}\\right) + \\frac{1}{(n\\pi)^{2}}\\sin\\!\\left(\\frac{n\\pi}{2}\\right).\n$$\nFor odd $n$, $\\cos(n\\pi/2)=0$ and $\\sin(n\\pi/2)=(-1)^{(n-1)/2}$, so\n$$\nb_{n} = 8 I_{1} = \\frac{8}{(n\\pi)^{2}} \\sin\\!\\left(\\frac{n\\pi}{2}\\right), \\quad \\text{for odd } n.\n$$\nThus the first three nonzero coefficients correspond to $n=1,3,5$:\n$$\nb_{1} = \\frac{8}{\\pi^{2}},\\qquad b_{3} = -\\frac{8}{9\\pi^{2}},\\qquad b_{5} = \\frac{8}{25\\pi^{2}}.\n$$\nArranged as a row matrix in increasing $n$, the result is\n$$\n\\begin{pmatrix}\n\\frac{8}{\\pi^{2}} & -\\frac{8}{9\\pi^{2}} & \\frac{8}{25\\pi^{2}}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{8}{\\pi^{2}} & -\\frac{8}{9\\pi^{2}} & \\frac{8}{25\\pi^{2}}\\end{pmatrix}}$$", "id": "2204923"}, {"introduction": "With the ability to represent functions spectrally, we can now tackle a full partial differential equation. This practice [@problem_id:2204882] demonstrates the core of spectral methods: transforming a PDE in physical space into a simpler system of ordinary differential equations (ODEs) in spectral space. You will derive the time-update rule for the heat equation, a classic example that reveals the elegance and efficiency of this approach.", "problem": "Consider the process of heat diffusion in a thin, insulated metallic ring of circumference $L$. The temperature distribution, $u(x, t)$, at position $x$ along the ring and time $t \\geq 0$ is governed by the one-dimensional heat equation, a type of Partial Differential Equation (PDE):\n$$ \\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2} $$\nwhere $\\alpha$ is the constant thermal diffusivity of the metal. The geometry of the ring imposes periodic boundary conditions on the domain $x \\in [0, L]$.\n\nTo solve this PDE numerically, a Fourier spectral method is employed for the spatial dimension. The temperature function is represented as a complex Fourier series:\n$$ u(x, t) = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_k(t) \\exp\\left(i \\frac{2\\pi k x}{L}\\right) $$\nHere, $i = \\sqrt{-1}$, $k$ is an integer representing the wavenumber, and $\\hat{u}_k(t)$ are the time-dependent Fourier coefficients.\n\nFor the time integration, the forward Euler method is used with a constant time step $\\Delta t$. The approximation of a coefficient $\\hat{u}_k$ at time $t_n = n \\Delta t$ is denoted by $\\hat{u}_k^n$. The forward Euler approximation for the time derivative is given by $\\frac{d\\hat{u}_k}{dt} \\approx \\frac{\\hat{u}_k^{n+1} - \\hat{u}_k^n}{\\Delta t}$.\n\nBased on this numerical scheme, derive a fully-discrete update expression for the Fourier coefficient at the next time step, $\\hat{u}_k^{n+1}$, in terms of its value at the current time step, $\\hat{u}_k^n$, and the physical and numerical parameters $\\alpha$, $L$, $k$, and $\\Delta t$.", "solution": "We start from the heat equation with periodic boundary conditions on $x \\in [0, L]$:\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^{2} u}{\\partial x^{2}}.\n$$\nRepresent $u(x,t)$ by its complex Fourier series:\n$$\nu(x,t) = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t) \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right).\n$$\nDifferentiate termwise in time:\n$$\n\\frac{\\partial u}{\\partial t} = \\sum_{k=-\\infty}^{\\infty} \\frac{d \\hat{u}_{k}}{dt}(t) \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right).\n$$\nDifferentiate twice in space. The first derivative is\n$$\n\\frac{\\partial u}{\\partial x} = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t)\\, i \\frac{2\\pi k}{L} \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right),\n$$\nand the second derivative is\n$$\n\\frac{\\partial^{2} u}{\\partial x^{2}} = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t)\\, \\left(i \\frac{2\\pi k}{L}\\right)^{2} \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right) = - \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t)\\, \\left(\\frac{2\\pi k}{L}\\right)^{2} \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right),\n$$\nsince $i^{2} = -1$. Substituting into the PDE and equating coefficients of the orthogonal Fourier modes yields, for each integer $k$,\n$$\n\\frac{d \\hat{u}_{k}}{dt}(t) = - \\alpha \\left(\\frac{2\\pi k}{L}\\right)^{2} \\hat{u}_{k}(t).\n$$\nDiscretize in time with forward Euler using time step $\\Delta t$ at times $t_{n} = n \\Delta t$:\n$$\n\\frac{\\hat{u}_{k}^{n+1} - \\hat{u}_{k}^{n}}{\\Delta t} = - \\alpha \\left(\\frac{2\\pi k}{L}\\right)^{2} \\hat{u}_{k}^{n}.\n$$\nSolving for $\\hat{u}_{k}^{n+1}$ gives the fully-discrete update:\n$$\n\\hat{u}_{k}^{n+1} = \\left[1 - \\alpha \\Delta t \\left(\\frac{2\\pi k}{L}\\right)^{2}\\right] \\hat{u}_{k}^{n}.\n$$", "answer": "$$\\boxed{\\hat{u}_{k}^{n+1}=\\left[1-\\alpha\\,\\Delta t\\,\\left(\\frac{2\\pi k}{L}\\right)^{2}\\right]\\hat{u}_{k}^{n}}$$", "id": "2204882"}, {"introduction": "A powerful method is only effective when applied correctly, and understanding its limitations is as important as knowing its strengths. This problem [@problem_id:2204920] presents a scenario where a spectral method unexpectedly fails, yielding a completely incorrect answer. By analyzing this failure, you will uncover a crucial principle: the solution space spanned by your basis functions must be capable of representing all components of your problem, including the forcing term.", "problem": "A numerical analyst is tasked with solving the one-dimensional Poisson equation, $u_{xx}(x) = f(x)$, on the domain $x \\in [0, 1]$, subject to homogeneous Dirichlet boundary conditions, $u(0)=0$ and $u(1)=0$. The specific forcing function for this problem is given by $f(x) = \\sin(8\\pi x)$.\n\nThe analyst chooses to use a spectral Galerkin method. They propose an approximate solution $u_N(x)$ as a finite linear combination of basis functions:\n$$u_N(x) = \\sum_{k=1}^{N} c_k \\phi_k(x)$$\nThe chosen basis functions are the sine eigenfunctions of the Laplacian on this domain, $\\phi_k(x) = \\sin(k\\pi x)$, which automatically satisfy the boundary conditions. For this particular attempt, the analyst sets the number of basis functions to $N=7$.\n\nThe core principle of the Galerkin method is to enforce that the residual of the equation, $R(x) = u_{N,xx}(x) - f(x)$, is orthogonal to every basis function in the chosen set. That is, $\\int_0^1 R(x) \\phi_j(x) dx = 0$ for all $j=1, 2, \\dots, N$. This procedure yields a system of linear equations for the unknown coefficients $c_k$.\n\nWhen the analyst implements this method with $N=7$, the computation returns a solution of $u_7(x) = 0$ for all $x$. This is clearly incorrect, as substituting $u(x)=0$ into the original differential equation yields $0 = \\sin(8\\pi x)$, which is not true.\n\nWhich of the following statements provides the correct fundamental reason for the failure of this specific numerical implementation?\n\nA. The forcing function $f(x)$ is orthogonal to every basis function in the set $\\{\\sin(k\\pi x)\\}_{k=1}^{7}$. Consequently, the projection of $f(x)$ onto the space spanned by these basis functions is zero, resulting in a computed trivial solution $u_7(x)=0$.\n\nB. The system of linear equations for the coefficients $c_k$ becomes singular because the determinant of the coefficient matrix is zero, indicating that the basis functions are not linearly independent.\n\nC. The sine basis is only appropriate for problems with even-indexed forcing functions, like $\\sin(2n\\pi x)$. The odd-indexed forcing function $\\sin(8\\pi x)$ (as $k=8$ is not a power of 2) requires a cosine basis.\n\nD. The chosen number of basis functions, $N=7$, is too small to resolve the oscillations of the forcing term. According to the Nyquist-Shannon sampling theorem, at least $2 \\times 8 = 16$ basis functions are required for a stable solution.\n\nE. The method fails because the boundary conditions $u(0)=u(1)=0$ are incompatible with a forcing function that is also zero at the boundaries. This creates an ill-posed problem.", "solution": "We consider the spectral Galerkin approximation with basis functions $\\phi_{k}(x)=\\sin(k\\pi x)$ for $k=1,\\dots,N$, here $N=7$. The approximate solution is $u_{N}(x)=\\sum_{k=1}^{N}c_{k}\\sin(k\\pi x)$, so its second derivative is\n$$\nu_{N,xx}(x)=\\sum_{k=1}^{N}c_{k}\\phi_{k}''(x)=\\sum_{k=1}^{N}c_{k}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right).\n$$\nWith $f(x)=\\sin(8\\pi x)$ and residual $R(x)=u_{N,xx}(x)-f(x)$, the Galerkin conditions are\n$$\n\\int_{0}^{1}R(x)\\,\\sin(j\\pi x)\\,dx=0,\\quad j=1,\\dots,N.\n$$\nSubstituting $R$ gives\n$$\n\\int_{0}^{1}\\left(\\sum_{k=1}^{N}c_{k}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right)-\\sin(8\\pi x)\\right)\\sin(j\\pi x)\\,dx=0.\n$$\nUsing the orthogonality relations\n$$\n\\int_{0}^{1}\\sin(k\\pi x)\\sin(j\\pi x)\\,dx=\\begin{cases}\n0,& j\\neq k,\\\\\n\\frac{1}{2},& j=k,\n\\end{cases}\n$$\neach Galerkin equation decouples to\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\int_{0}^{1}\\sin^{2}(j\\pi x)\\,dx=\\int_{0}^{1}\\sin(8\\pi x)\\sin(j\\pi x)\\,dx,\\quad j=1,\\dots,7,\n$$\nthat is,\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\left(\\frac{1}{2}\\right)=\\int_{0}^{1}\\sin(8\\pi x)\\sin(j\\pi x)\\,dx,\\quad j=1,\\dots,7.\n$$\nBy orthogonality, the right-hand side is zero for every $j=1,\\dots,7$, because $\\sin(8\\pi x)$ is orthogonal to $\\sin(j\\pi x)$ unless $j=8$. Therefore,\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\left(\\frac{1}{2}\\right)=0\\quad\\Rightarrow\\quad c_{j}=0,\\quad j=1,\\dots,7,\n$$\nwhich yields $u_{7}(x)=0$.\n\nThis shows the fundamental cause: the forcing function lies entirely in the mode $k=8$, which is not contained in the span of $\\{\\sin(k\\pi x)\\}_{k=1}^{7}$. Consequently, its projection onto this subspace is zero, and the Galerkin system has zero right-hand side while the stiffness matrix is diagonal and invertible:\n$$\na_{jk}=\\int_{0}^{1}\\phi_{k}''(x)\\phi_{j}(x)\\,dx=\\int_{0}^{1}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right)\\sin(j\\pi x)\\,dx=-\\,\\frac{1}{2}k^{2}\\pi^{2}\\,\\delta_{jk},\n$$\nso there is no singularity. If $N$ included $8$, one would obtain $c_{8}=-1/(8^{2}\\pi^{2})$ and recover the exact solution. The explanations invoking a cosine basis, Nyquist-Shannon sampling, or incompatibility with boundary conditions are incorrect for this boundary value problem. The correct choice is that the forcing is orthogonal to the chosen subspace.\n\nTherefore, the correct option is A.", "answer": "$$\\boxed{A}$$", "id": "2204920"}]}