{"hands_on_practices": [{"introduction": "To understand the power of multigrid methods, we must first master the art of communicating between different levels of detailâ€”the fine and coarse grids. Let's begin with the fundamental operation of restriction: transferring information from a high-resolution fine grid to a lower-resolution coarse grid. This process is crucial for allowing the coarse grid to \"see\" and correct the large-scale, smooth components of the error that are difficult for standard iterative solvers to eliminate efficiently. This exercise [@problem_id:2188716] provides a concrete, hands-on application of the simplest restriction technique, known as injection, building your intuition for how fine-grid data is effectively down-sampled.", "problem": "In the context of multigrid methods for solving one-dimensional boundary value problems, we often need to transfer information between grids of different resolutions. Consider a fine uniform grid, $\\Omega_h$, on the interval $[0, 1]$ with 9 interior grid points. The values of a residual vector, $r_h$, at these interior points are given in order as:\n$$\nr_h = (1.2, 0.5, -0.8, 2.1, 0.0, -1.5, 3.3, 0.9, -2.4)^T\n$$\nNow, consider a coarse grid, $\\Omega_{2h}$, which is constructed by taking every second point from the fine grid $\\Omega_h$. This results in a coarse grid with 4 interior points.\n\nThe process of transferring the residual from the fine grid to the coarse grid is called restriction. We will use the simplest restriction operator, known as injection. In injection, the value of the residual at a coarse grid point is simply set to be the value of the residual at the corresponding coincident point on the fine grid.\n\nCalculate the residual vector, $r_{2h}$, on the 4 interior points of the coarse grid $\\Omega_{2h}$. Express your answer as a single row matrix containing the 4 components of the coarse grid residual vector in order.", "solution": "The problem asks us to compute the residual vector on a coarse grid by applying an injection restriction operator to a residual vector from a fine grid.\n\nLet the interior points of the fine grid $\\Omega_h$ be denoted by $x_i$ for $i=1, 2, \\dots, 9$. The given fine-grid residual vector is $r_h$, where the $i$-th component, $(r_h)_i$, is the residual value at point $x_i$.\nSo, we have:\n$r_h(x_1) = 1.2$\n$r_h(x_2) = 0.5$\n$r_h(x_3) = -0.8$\n$r_h(x_4) = 2.1$\n$r_h(x_5) = 0.0$\n$r_h(x_6) = -1.5$\n$r_h(x_7) = 3.3$\n$r_h(x_8) = 0.9$\n$r_h(x_9) = -2.4$\n\nThe coarse grid, $\\Omega_{2h}$, is formed by taking every second point from the fine grid. This means the interior points of the coarse grid, let's call them $X_j$ for $j=1, 2, 3, 4$, coincide with the even-indexed points of the fine grid.\nSpecifically:\nThe first interior point of the coarse grid, $X_1$, coincides with the second interior point of the fine grid, $x_2$.\nThe second interior point of the coarse grid, $X_2$, coincides with the fourth interior point of the fine grid, $x_4$.\nThe third interior point of the coarse grid, $X_3$, coincides with the sixth interior point of the fine grid, $x_6$.\nThe fourth interior point of the coarse grid, $X_4$, coincides with the eighth interior point of the fine grid, $x_8$.\nIn general, the $j$-th coarse grid point $X_j$ corresponds to the fine grid point $x_{2j}$.\n\nThe restriction operator is injection. This means the value of the coarse-grid residual, $r_{2h}$, at a coarse grid point is simply the value of the fine-grid residual, $r_h$, at the same location.\nMathematically, this is expressed as:\n$$\nr_{2h}(X_j) = r_h(x_{2j})\n$$\n\nWe can now compute the components of the coarse-grid residual vector $r_{2h}$.\n\nFor the first component (at point $X_1$):\n$$\n(r_{2h})_1 = r_{2h}(X_1) = r_h(x_2) = 0.5\n$$\nThis is the 2nd component of the given $r_h$ vector.\n\nFor the second component (at point $X_2$):\n$$\n(r_{2h})_2 = r_{2h}(X_2) = r_h(x_4) = 2.1\n$$\nThis is the 4th component of the given $r_h$ vector.\n\nFor the third component (at point $X_3$):\n$$\n(r_{2h})_3 = r_{2h}(X_3) = r_h(x_6) = -1.5\n$$\nThis is the 6th component of the given $r_h$ vector.\n\nFor the fourth component (at point $X_4$):\n$$\n(r_{2h})_4 = r_{2h}(X_4) = r_h(x_8) = 0.9\n$$\nThis is the 8th component of the given $r_h$ vector.\n\nCombining these components in order, we get the coarse-grid residual vector:\n$$\nr_{2h} = (0.5, 2.1, -1.5, 0.9)^T\n$$\n\nThe problem asks for this vector to be presented as a single row matrix.", "answer": "$$\\boxed{\\begin{pmatrix} 0.5 & 2.1 & -1.5 & 0.9 \\end{pmatrix}}$$", "id": "2188716"}, {"introduction": "After a correction has been computed on the coarse grid, we need a way to bring this insight back to the fine grid to improve our solution. This \"up-sampling\" process is handled by a prolongation, or interpolation, operator. It takes the sparse correction values from the coarse grid and distributes them across the dense fine grid. This practice [@problem_id:2188706] demonstrates this critical step using linear interpolation, a widely used and intuitive method. By working through it, you will see how a few calculated values on a coarse level can generate a detailed correction that benefits the entire fine-grid solution.", "problem": "In the context of a multigrid method for solving a one-dimensional boundary value problem on the domain $[0, 1]$, a fine grid $\\Omega_h$ and a coarse grid $\\Omega_{2h}$ are used. The fine grid $\\Omega_h$ is defined by nodes $x_i = i \\cdot h$ for $i = 0, 1, \\dots, 8$, with a grid spacing of $h = 1/8$. The coarse grid $\\Omega_{2h}$ is a subset of the fine grid, containing only the nodes $x_j = j \\cdot (2h)$ for $j = 0, 1, \\dots, 4$. Consequently, the interior points of the fine grid are $\\{x_1, x_2, x_3, x_4, x_5, x_6, x_7\\}$, and the interior points of the coarse grid correspond to $\\{x_2, x_4, x_6\\}$ on the fine grid's indexing.\n\nIn one step of the algorithm, an error correction equation is solved on the coarse grid, yielding a correction vector $e_{2h}$. This vector is defined at the interior nodes of $\\Omega_{2h}$ with the values $e_{2h}(x_2) = c_1$, $e_{2h}(x_4) = c_2$, and $e_{2h}(x_6) = c_3$, where $c_1, c_2, c_3$ are symbolic constants. The correction is known to be zero at the boundaries of the domain, so $e_{2h}(x_0) = 0$ and $e_{2h}(x_8) = 0$.\n\nThis coarse-grid correction must be transferred back to the fine grid using a prolongation (interpolation) operator, denoted $I_{2h}^h$, to produce a fine-grid correction vector $e_h = I_{2h}^h e_{2h}$. The interpolation is linear and defined as follows:\n1. For any fine-grid node $x_i$ that is also a coarse-grid node (i.e., $i$ is an even number), the value is directly injected: $e_h(x_i) = e_{2h}(x_i)$.\n2. For any fine-grid node $x_i$ that is not a coarse-grid node (i.e., $i$ is an odd number), the value is the arithmetic mean of the values at its two nearest neighboring coarse-grid nodes.\n\nDetermine the complete correction vector $e_h$ at all seven interior points of the fine grid, $\\{x_1, x_2, \\dots, x_7\\}$. Express your answer as a single row vector with 7 components, ordered from $x_1$ to $x_7$, in terms of the constants $c_1$, $c_2$, and $c_3$.", "solution": "We are given two nested uniform grids on $[0,1]$: the fine grid $\\Omega_{h}$ with nodes $x_{i}=i h$ for $i=0,\\dots,8$ and $h=1/8$, and the coarse grid $\\Omega_{2h}$ consisting of the subset of even-indexed fine nodes $x_{j}=j(2h)$ for $j=0,\\dots,4$, i.e., indices $i=0,2,4,6,8$. The interior fine nodes are $x_{1},\\dots,x_{7}$, and the interior coarse nodes correspond to $x_{2},x_{4},x_{6}$. The coarse-grid correction $e_{2h}$ is specified by\n$$\ne_{2h}(x_{2})=c_{1},\\quad e_{2h}(x_{4})=c_{2},\\quad e_{2h}(x_{6})=c_{3},\\quad e_{2h}(x_{0})=0,\\quad e_{2h}(x_{8})=0.\n$$\nWe construct the fine-grid correction $e_{h}=I_{2h}^{h} e_{2h}$ using linear prolongation. The interpolation rule is:\n- For even $i$ (fine node coincides with coarse node): injection,\n$$\ne_{h}(x_{i})=e_{2h}(x_{i}).\n$$\n- For odd $i$ (fine node midway between two neighboring coarse nodes): arithmetic mean,\n$$\ne_{h}(x_{i})=\\frac{e_{2h}(x_{i-1})+e_{2h}(x_{i+1})}{2}.\n$$\n\nWe now evaluate $e_{h}$ at the seven interior fine nodes:\n\n1) $i=1$ (odd), neighbors $x_{0}$ and $x_{2}$:\n$$\ne_{h}(x_{1})=\\frac{e_{2h}(x_{0})+e_{2h}(x_{2})}{2}=\\frac{0+c_{1}}{2}=\\frac{c_{1}}{2}.\n$$\n\n2) $i=2$ (even), injection:\n$$\ne_{h}(x_{2})=e_{2h}(x_{2})=c_{1}.\n$$\n\n3) $i=3$ (odd), neighbors $x_{2}$ and $x_{4}$:\n$$\ne_{h}(x_{3})=\\frac{e_{2h}(x_{2})+e_{2h}(x_{4})}{2}=\\frac{c_{1}+c_{2}}{2}.\n$$\n\n4) $i=4$ (even), injection:\n$$\ne_{h}(x_{4})=e_{2h}(x_{4})=c_{2}.\n$$\n\n5) $i=5$ (odd), neighbors $x_{4}$ and $x_{6}$:\n$$\ne_{h}(x_{5})=\\frac{e_{2h}(x_{4})+e_{2h}(x_{6})}{2}=\\frac{c_{2}+c_{3}}{2}.\n$$\n\n6) $i=6$ (even), injection:\n$$\ne_{h}(x_{6})=e_{2h}(x_{6})=c_{3}.\n$$\n\n7) $i=7$ (odd), neighbors $x_{6}$ and $x_{8}$:\n$$\ne_{h}(x_{7})=\\frac{e_{2h}(x_{6})+e_{2h}(x_{8})}{2}=\\frac{c_{3}+0}{2}=\\frac{c_{3}}{2}.\n$$\n\nCollecting the components in order from $x_{1}$ to $x_{7}$ yields the row vector\n$$\n\\begin{pmatrix}\n\\frac{c_{1}}{2} & c_{1} & \\frac{c_{1}+c_{2}}{2} & c_{2} & \\frac{c_{2}+c_{3}}{2} & c_{3} & \\frac{c_{3}}{2}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{c_{1}}{2} & c_{1} & \\frac{c_{1}+c_{2}}{2} & c_{2} & \\frac{c_{2}+c_{3}}{2} & c_{3} & \\frac{c_{3}}{2}\\end{pmatrix}}$$", "id": "2188706"}, {"introduction": "We have seen how to transfer information back and forth, but what is the actual equation we solve on the coarse grid? A robust and mathematically elegant answer is provided by the Galerkin principle, which constructs the coarse-grid operator, $A_{2h}$, directly from the fine-grid operator, $A_h$, and the transfer operators we've just practiced. The relationship is elegantly expressed as $A_{2h} = R A_h P$, where $R$ is the restriction and $P$ is the prolongation operator. This practice [@problem_id:2188696] guides you through this vital calculation and uncovers a non-intuitive result: even if $A_h$ is a simple matrix (like a tridiagonal one), the resulting $A_{2h}$ may be more complex, a fact that has important implications for multigrid implementation.", "problem": "In the context of multigrid methods for solving numerical problems, consider a one-dimensional problem defined on the domain $[0, 1]$. We use two grids: a fine grid with mesh size $h=1/8$, which has $N_h = 7$ interior grid points, and a coarse grid with mesh size $2h=1/4$, which has $N_{2h} = 3$ interior grid points.\n\nThe fine-grid linear operator, $A_h$, which represents a discretized differential operator, is given by the following $7 \\times 7$ tridiagonal matrix:\n$$\nA_h = \\begin{pmatrix}\n 2 & -1 &  0 &  0 &  0 &  0 &  0 \\\\\n-1 &  2 & -1 &  0 &  0 &  0 &  0 \\\\\n 0 & -1 &  2 & -1 &  0 &  0 &  0 \\\\\n 0 &  0 & -1 &  2 & -1 &  0 &  0 \\\\\n 0 &  0 &  0 & -1 &  2 & -1 &  0 \\\\\n 0 &  0 &  0 &  0 & -1 &  2 & -1 \\\\\n 0 &  0 &  0 &  0 &  0 & -1 &  2\n\\end{pmatrix}\n$$\nTo transfer data from the coarse grid to the fine grid, a prolongation (or interpolation) operator, $P \\equiv I_{2h}^h$, is used. We define a specific, non-standard $7 \\times 3$ prolongation operator $P$ as:\n$$\nP = \\begin{pmatrix}\n0.5 & 0 & 0 \\\\\n1 & 0 & 0 \\\\\n0.5 & 0.5 & 0 \\\\\n0 & 1 & 2 \\\\\n0 & 0.5 & 0.5 \\\\\n0 & 0 & 1 \\\\\n0 & 0 & 0.5\n\\end{pmatrix}\n$$\nThe restriction operator, $R \\equiv I_h^{2h}$, which transfers data from the fine grid to the coarse grid, is defined as the transpose of the prolongation operator, i.e., $R = P^T$.\n\nThe coarse-grid operator, $A_{2h}$, is constructed using the Galerkin principle: $A_{2h} = R A_h P$.\nCalculate the value of the entry in the first row and third column of the resulting coarse-grid operator $A_{2h}$. Express your answer as an exact number.", "solution": "The goal is to compute the entry $(1,3)$ of the coarse-grid operator $A_{2h}$, which is defined by the Galerkin product $A_{2h} = R A_h P$. From matrix multiplication rules, the entry $A_{2h}(1,3)$ is given by the dot product of the first row of $R$ and the third column of the matrix product $(A_h P)$.\n\nThe operators are given as:\n- Fine-grid operator $A_h$: a $7 \\times 7$ matrix.\n- Prolongation operator $P$: a $7 \\times 3$ matrix.\n- Restriction operator $R$: a $3 \\times 7$ matrix, defined as $R = P^T$.\n\nThe coarse-grid operator $A_{2h}$ is a $3 \\times 3$ matrix. Its $(1,3)$ entry is given by:\n$$\nA_{2h}(1,3) = (\\text{Row 1 of } R) \\cdot (\\text{Column 3 of } (A_h P))\n$$\n\n**Step 1: Identify the required vectors and matrices.**\n\nThe first row of $R=P^T$ is the transpose of the first column of $P$. Let's denote the columns of $P$ by $p_1, p_2, p_3$.\n$$\np_1 = [0.5, 1, 0.5, 0, 0, 0, 0]^T\n$$\nSo, the first row of $R$ is $p_1^T = [0.5, 1, 0.5, 0, 0, 0, 0]$.\n\nThe third column of the matrix product $(A_h P)$ is the result of multiplying the matrix $A_h$ by the third column of $P$, which we denote as $p_3$.\n$$\np_3 = [0, 0, 0, 2, 0.5, 1, 0.5]^T\n$$\nThus, we need to compute the vector $v = A_h p_3$.\n\n**Step 2: Compute the vector $v = A_h p_3$.**\n\nWe perform the matrix-vector multiplication:\n$$\nv = A_h p_3 = \\begin{pmatrix}\n 2 & -1 &  0 &  0 &  0 &  0 &  0 \\\\\n-1 &  2 & -1 &  0 &  0 &  0 &  0 \\\\\n 0 & -1 &  2 & -1 &  0 &  0 &  0 \\\\\n 0 &  0 & -1 &  2 & -1 &  0 &  0 \\\\\n 0 &  0 &  0 & -1 &  2 & -1 &  0 \\\\\n 0 &  0 &  0 &  0 & -1 &  2 & -1 \\\\\n 0 &  0 &  0 &  0 &  0 & -1 &  2\n\\end{pmatrix}\n\\begin{pmatrix}\n0 \\\\ 0 \\\\ 0 \\\\ 2 \\\\ 0.5 \\\\ 1 \\\\ 0.5\n\\end{pmatrix}\n$$\nLet's compute each component of the resulting vector $v$:\n$v_1 = (2)(0) + (-1)(0) = 0$\n$v_2 = (-1)(0) + (2)(0) + (-1)(0) = 0$\n$v_3 = (-1)(0) + (2)(0) + (-1)(2) = -2$\n$v_4 = (-1)(0) + (2)(2) + (-1)(0.5) = 4 - 0.5 = 3.5$\n$v_5 = (-1)(2) + (2)(0.5) + (-1)(1) = -2 + 1 - 1 = -2$\n$v_6 = (-1)(0.5) + (2)(1) + (-1)(0.5) = -0.5 + 2 - 0.5 = 1$\n$v_7 = (-1)(1) + (2)(0.5) = -1 + 1 = 0$\n\nSo, the third column of $(A_h P)$ is the vector $v = [0, 0, -2, 3.5, -2, 1, 0]^T$.\n\n**Step 3: Compute the final value of $A_{2h}(1,3)$.**\n\nNow we compute the dot product of the first row of $R$ (which is $p_1^T$) and the vector $v$ we just calculated.\n$$\nA_{2h}(1,3) = p_1^T \\cdot v = [0.5, 1, 0.5, 0, 0, 0, 0] \\cdot \\begin{pmatrix}\n0 \\\\ 0 \\\\ -2 \\\\ 3.5 \\\\ -2 \\\\ 1 \\\\ 0\n\\end{pmatrix}\n$$\n$$\nA_{2h}(1,3) = (0.5)(0) + (1)(0) + (0.5)(-2) + (0)(3.5) + (0)(-2) + (0)(1) + (0)(0)\n$$\n$$\nA_{2h}(1,3) = 0 + 0 - 1 + 0 + 0 + 0 + 0 = -1\n$$\nThe value of the entry $A_{2h}(1,3)$ is -1. This non-zero value for an off-diagonal entry where $|i-j| > 1$ demonstrates that the resulting coarse-grid operator $A_{2h}$ is not tridiagonal, even though the fine-grid operator $A_h$ was. This is a consequence of the non-local nature of the chosen prolongation operator.", "answer": "$$\\boxed{-1}$$", "id": "2188696"}]}