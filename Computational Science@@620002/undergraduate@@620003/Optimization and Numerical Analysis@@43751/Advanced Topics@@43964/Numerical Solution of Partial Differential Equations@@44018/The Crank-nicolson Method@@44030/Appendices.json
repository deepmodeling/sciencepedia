{"hands_on_practices": [{"introduction": "The first step in applying any numerical method to a partial differential equation (PDE) is translating the continuous problem into a discrete algebraic system. This practice is designed to build your fundamental skills in this process for the Crank-Nicolson method. By working through a simple one-dimensional heat equation, you will derive the explicit matrix form $A\\mathbf{u}^{n+1} = B\\mathbf{u}^{n}$ that advances the solution from one time step to the next, revealing the characteristic tridiagonal structure of the system matrices.[@problem_id:2139888]", "problem": "Consider the one-dimensional heat equation, $u_t = \\alpha u_{xx}$, for a function $u(x, t)$ defined on the spatial domain $x \\in [0, L]$ and for time $t \\geq 0$. The equation is subject to homogeneous Dirichlet boundary conditions, $u(0, t) = u(L, t) = 0$.\n\nWe wish to solve this equation numerically using the Crank-Nicolson method. The spatial domain is discretized into a uniform grid with spacing $\\Delta x$, such that there are exactly three interior grid points. Let $\\Delta t$ be the time step. The method results in a matrix system of the form $A\\mathbf{u}^{n+1} = B\\mathbf{u}^{n}$, where $\\mathbf{u}^{k}$ is the column vector of the numerical solution at the three interior grid points at time step $k$.\n\nLet the parameter $\\lambda$ be defined as $\\lambda = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$.\n\nWhich of the following options correctly identifies the $3 \\times 3$ matrices $A$ and $B$?\n\nA. $A = \\begin{pmatrix} 1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\ -\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\ 0 & -\\frac{\\lambda}{2} & 1+\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\ \\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\ 0 & \\frac{\\lambda}{2} & 1-\\lambda \\end{pmatrix}$\n\nB. $A = \\begin{pmatrix} 1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\ \\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\ 0 & \\frac{\\lambda}{2} & 1-\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\ -\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\ 0 & -\\frac{\\lambda}{2} & 1+\\lambda \\end{pmatrix}$\n\nC. $A = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$, $B = \\begin{pmatrix} 1-2\\lambda & \\lambda & 0 \\\\ \\lambda & 1-2\\lambda & \\lambda \\\\ 0 & \\lambda & 1-2\\lambda \\end{pmatrix}$\n\nD. $A = \\begin{pmatrix} 1+2\\lambda & -\\lambda & 0 \\\\ -\\lambda & 1+2\\lambda & -\\lambda \\\\ 0 & -\\lambda & 1+2\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$", "solution": "We discretize the spatial interval with uniform spacing $\\Delta x$ and denote interior indices $i=1,2,3$. The homogeneous Dirichlet boundary conditions impose $u_{0}^{n}=0$ and $u_{4}^{n}=0$ for all $n$.\n\nLet $u_{i}^{n}$ approximate $u(x_{i}, t^{n})$. The Crank–Nicolson discretization of $u_{t}=\\alpha u_{xx}$ at interior point $i$ is\n$$\n\\frac{u_{i}^{n+1}-u_{i}^{n}}{\\Delta t}\n=\\frac{\\alpha}{2}\\left(\\frac{u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}}{(\\Delta x)^{2}}+\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{(\\Delta x)^{2}}\\right).\n$$\nWith $\\lambda=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}$, multiply both sides by $\\Delta t$ to obtain\n$$\nu_{i}^{n+1}-u_{i}^{n}\n=\\frac{\\lambda}{2}\\left[(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n})+(u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1})\\right].\n$$\nRearranging to collect the unknown time level $n+1$ on the left and time level $n$ on the right gives\n$$\n\\left(1+\\lambda\\right)u_{i}^{n+1}-\\frac{\\lambda}{2}u_{i+1}^{n+1}-\\frac{\\lambda}{2}u_{i-1}^{n+1}\n=\\left(1-\\lambda\\right)u_{i}^{n}+\\frac{\\lambda}{2}u_{i+1}^{n}+\\frac{\\lambda}{2}u_{i-1}^{n}.\n$$\nBecause the boundary values are zero, no additional boundary terms appear. Writing this system for $i=1,2,3$ in matrix form $A\\mathbf{u}^{n+1}=B\\mathbf{u}^{n}$ with $\\mathbf{u}^{k}=(u_{1}^{k},u_{2}^{k},u_{3}^{k})^{T}$, the matrices are\n$$\nA=\\begin{pmatrix}\n1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\\n-\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\\n0 & -\\frac{\\lambda}{2} & 1+\\lambda\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\\n\\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\\n0 & \\frac{\\lambda}{2} & 1-\\lambda\n\\end{pmatrix}.\n$$\nThese match option A.", "answer": "$$\\boxed{A}$$", "id": "2139888"}, {"introduction": "A numerical simulation is only as good as its initial setup. Once we have the machinery to evolve the system in time, we need a valid starting point, $\\mathbf{u}^0$. This exercise tackles the practical challenge of converting a continuous initial condition—in this case, an idealized instantaneous injection represented by a Dirac delta function—into a discrete vector that is both computationally usable and physically meaningful.[@problem_id:2139861] This process highlights the important principle of conservation in numerical modeling.", "problem": "A computational physicist is setting up a simulation to model the diffusion of a chemical dye in a long, thin, one-dimensional tube of length $L=5.0$ meters. The concentration of the dye, $u(x,t)$, is governed by the one-dimensional diffusion partial differential equation (PDE), $u_t = D u_{xx}$, where $D$ is the diffusion coefficient. The ends of the tube are connected to large reservoirs that maintain a zero concentration, leading to the boundary conditions $u(0,t) = u(L,t) = 0$.\n\nAt the beginning of the experiment, $t=0$, a unit amount of dye is injected precisely at the location $x_0 = 3.6$ meters. This initial state is mathematically modeled as a Dirac delta function: $u(x,0) = \\delta(x-x_0)$.\n\nTo solve the PDE numerically, the spatial domain $[0, L]$ is discretized into $N=125$ equal subintervals. The grid points are denoted by $x_j = j \\Delta x$ for $j=0, 1, \\dots, N$. The state of the system at any time is represented by a vector of concentrations at the interior grid points. The initial state is therefore a vector $\\mathbf{u}^0$, where the component $u_j^0$ represents the concentration $u(x_j, 0)$.\n\nTo properly represent the instantaneous injection, the physicist decides to assign a non-zero concentration value to only the single grid point corresponding to the injection location $x_0$, while setting all other interior grid points to zero. The value of this non-zero concentration must be chosen such that the total amount of dye in the discrete system is the same as the total amount in the continuous system (which is 1, by the property of the delta function).\n\nDetermine the numerical value of this single non-zero component in the initial state vector $\\mathbf{u}^0$. Express your answer in units of $\\text{m}^{-1}$.", "solution": "We discretize the interval $[0,L]$ into $N$ equal subintervals, so the grid spacing is $\\Delta x = \\frac{L}{N}$ and the grid points are $x_{j} = j \\Delta x$ for $j=0,1,\\dots,N$. The discrete approximation to the total dye amount is given by a Riemann sum over the interior nodes:\n$$\n\\sum_{j=1}^{N-1} u_{j}^{0}\\,\\Delta x \\approx \\int_{0}^{L} u(x,0)\\,dx.\n$$\nThe continuous initial condition is $u(x,0)=\\delta(x-x_{0})$, hence\n$$\n\\int_{0}^{L} u(x,0)\\,dx = \\int_{0}^{L} \\delta(x-x_{0})\\,dx = 1.\n$$\nThe physicist assigns a non-zero value only at the grid index $k$ such that $x_{k}=x_{0}$. With this choice, the discrete total is exactly\n$$\n\\sum_{j=1}^{N-1} u_{j}^{0}\\,\\Delta x = u_{k}^{0}\\,\\Delta x.\n$$\nMass conservation requires $u_{k}^{0}\\,\\Delta x = 1$, so\n$$\nu_{k}^{0} = \\frac{1}{\\Delta x} = \\frac{N}{L}.\n$$\nWith the given data, $L=5.0$ and $N=125$, so $\\Delta x = \\frac{L}{N} = \\frac{5.0}{125}$ and $x_{0} = 3.6$ satisfies $x_{0}/\\Delta x = \\frac{3.6}{5.0/125} = 90$, confirming that $x_{0}$ lies exactly on an interior grid point. Therefore,\n$$\nu_{k}^{0} = \\frac{N}{L} = \\frac{125}{5.0} = 25,\n$$\nwhich has units of $\\text{m}^{-1}$, as required by the delta normalization in one dimension.", "answer": "$$\\boxed{25}$$", "id": "2139861"}, {"introduction": "The Crank-Nicolson method is prized for its unconditional stability, but this property can sometimes be misleading. Stability does not guarantee accuracy, especially when dealing with non-smooth initial conditions or large time steps. This final practice serves as a crucial cautionary tale, guiding you to calculate the result of a single time step under conditions designed to expose a classic pitfall of the method: the generation of spurious, non-physical oscillations.[@problem_id:2139894] This will deepen your appreciation for the nuances of numerical simulation beyond mere formula application.", "problem": "Consider the one-dimensional heat equation, $u_t = \\alpha u_{xx}$, defined on a spatial domain $x \\in [0, L]$. The rod is subject to homogeneous Dirichlet boundary conditions, such that $u(0, t) = u(L, t) = 0$ for all time $t \\ge 0$.\n\nThe equation is to be solved numerically using the Crank-Nicolson finite difference scheme. The spatial domain is discretized into $N_x$ equal intervals of size $\\Delta x = L/N_x$, with grid points labeled $x_j = j \\Delta x$ for $j=0, 1, \\dots, N_x$. The time is discretized with a constant step size $\\Delta t$, with time levels $t_n = n \\Delta t$. The numerical approximation to the solution $u(x_j, t_n)$ is denoted by $u_j^n$.\n\nThe Crank-Nicolson scheme is given by:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} + \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n\nFor this problem, use the following parameters:\n-   Length of the rod, $L = 1.0$.\n-   Thermal diffusivity, $\\alpha = 1.0$.\n-   Number of spatial intervals, $N_x = 4$. This results in three interior grid points.\n-   The initial condition at $t=0$ is a sharp, localized pulse approximated on the grid by setting the temperature at the central interior point to $u_2^0 = 2.0$, and the temperature at all other interior points to zero.\n-   The computational mesh ratio is set to $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} = 10.0$. This corresponds to a large time step, chosen to investigate the method's behavior under such conditions.\n\nYour task is to calculate the value of the solution at the central interior grid point, $u_2^1$, after the first time step. Express your answer as a fraction in simplest form.", "solution": "We discretize the heat equation $u_{t}=\\alpha u_{xx}$ on $x\\in[0,L]$ with homogeneous Dirichlet boundary conditions using the Crank–Nicolson scheme. With mesh ratio $r=\\alpha \\Delta t/(\\Delta x)^{2}$, the Crank–Nicolson update for interior nodes is\n$$\nu_{j}^{n+1}-u_{j}^{n}=\\frac{r}{2}\\Big[(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n})+(u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1})\\Big].\n$$\nRearranging to collect the $n+1$ terms on the left gives, for $j=1,2,3$,\n$$\n-\\frac{r}{2}u_{j-1}^{n+1}+(1+r)u_{j}^{n+1}-\\frac{r}{2}u_{j+1}^{n+1}=(1-r)u_{j}^{n}+\\frac{r}{2}(u_{j-1}^{n}+u_{j+1}^{n}),\n$$\nwith $u_{0}^{n}=u_{4}^{n}=0$.\n\nWith $N_{x}=4$, the interior unknowns at the first step are $u_{1}^{1},u_{2}^{1},u_{3}^{1}$, and the initial condition is $u_{1}^{0}=0$, $u_{2}^{0}=2$, $u_{3}^{0}=0$. Substituting these and the boundary values into the right-hand sides yields the linear system\n$$\n(1+r)u_{1}^{1}-\\frac{r}{2}u_{2}^{1}=r,\n$$\n$$\n-\\frac{r}{2}u_{1}^{1}+(1+r)u_{2}^{1}-\\frac{r}{2}u_{3}^{1}=2-2r,\n$$\n$$\n-\\frac{r}{2}u_{2}^{1}+(1+r)u_{3}^{1}=r.\n$$\nBy symmetry, $u_{1}^{1}=u_{3}^{1}$; denote $a=u_{1}^{1}=u_{3}^{1}$ and $b=u_{2}^{1}$. The system reduces to\n$$\n(1+r)a-\\frac{r}{2}b=r,\n$$\n$$\n-ra+(1+r)b=2-2r.\n$$\nFrom the first equation, $a=\\big(r+\\frac{r}{2}b\\big)/(1+r)$. Substituting into the second gives\n$$\n-\\frac{r\\big(r+\\frac{r}{2}b\\big)}{1+r}+(1+r)b=2-2r.\n$$\nMultiplying through by $(1+r)$ and collecting $b$ terms,\n$$\n-r^{2}-\\frac{r^{2}}{2}b+(1+2r+r^{2})b=2-2r^{2},\n$$\n$$\n\\Big(1+2r+\\frac{r^{2}}{2}\\Big)b=2-r^{2}.\n$$\nHence,\n$$\nb=\\frac{2-r^{2}}{1+2r+\\frac{r^{2}}{2}}=\\frac{4-2r^{2}}{r^{2}+4r+2}.\n$$\nWith the given mesh ratio $r=10$, this yields\n$$\nu_{2}^{1}=b=\\frac{4-2\\cdot 100}{100+40+2}=\\frac{-196}{142}=-\\frac{98}{71}.\n$$\nTherefore, the value at the central interior grid point after the first time step is $-\\frac{98}{71}$.", "answer": "$$\\boxed{-\\frac{98}{71}}$$", "id": "2139894"}]}