{"hands_on_practices": [{"introduction": "The first step in using variational methods is learning how to transform a classical differential equation, or \"strong form,\" into its equivalent integral-based \"weak form.\" This exercise guides you through this fundamental process using a physical model of a string under a concentrated force, which is modeled by a Dirac delta function. You will see how the weak formulation elegantly handles such singular forces, a task that is awkward in the classical setting.", "problem": "Consider a simplified model for the static vertical displacement, $u(x)$, of a taut, elastic string stretched along the x-axis from $x=0$ to $x=1$. The string is fixed at both ends, so its displacement is zero at the endpoints. A concentrated point-like force is applied at the midpoint of the string, located at $x=1/2$.\n\nThe governing equation for the displacement $u(x)$ is the one-dimensional Poisson equation given by the following boundary value problem (strong form):\n$$ -u''(x) = f(x) \\quad \\text{for } x \\in (0, 1) $$\nwith boundary conditions $u(0) = 0$ and $u(1) = 0$. The source term $f(x)$ representing the concentrated force is modeled by the Dirac delta function, $f(x) = \\delta(x-1/2)$.\n\nThe weak formulation of this problem seeks a solution $u$ in a function space $V$ such that an integral equation holds for all test functions $v$ from the same space $V$. For this problem, the appropriate space is the Sobolev space $H_0^1(0,1)$, which consists of functions that are square-integrable, have square-integrable first derivatives, and satisfy the boundary conditions $v(0)=0$ and $v(1)=0$.\n\nWhich of the following represents the correct weak formulation for this problem?\n\nA. Find $u \\in V$ such that $\\int_0^1 u'(x)v'(x) \\,dx = v(1/2)$ for all $v \\in V$.\n\nB. Find $u \\in V$ such that $\\int_0^1 u'(x)v'(x) \\,dx = v'(1/2)$ for all $v \\in V$.\n\nC. Find $u \\in V$ such that $-\\int_0^1 u'(x)v'(x) \\,dx = v(1/2)$ for all $v \\in V$.\n\nD. Find $u \\in V$ such that $\\int_0^1 u''(x)v(x) \\,dx = v(1/2)$ for all $v \\in V$.\n\nE. Find $u \\in V$ such that $\\int_0^1 u'(x)v'(x) \\,dx - u'(1)v(1) + u'(0)v(0) = v(1/2)$ for all $v \\in V$.", "solution": "We start from the strong form of the boundary value problem:\n$$\n-u''(x)=\\delta(x-\\tfrac{1}{2}) \\quad \\text{for } x\\in(0,1), \\quad u(0)=0, \\quad u(1)=0.\n$$\nTo derive the weak formulation, we multiply the equation by an arbitrary test function $v\\in V$, where $V=H_{0}^{1}(0,1)$, and integrate over $(0,1)$:\n$$\n\\int_{0}^{1}\\left(-u''(x)\\right)v(x)\\,dx=\\int_{0}^{1}\\delta(x-\\tfrac{1}{2})\\,v(x)\\,dx.\n$$\nThe right-hand side is the action of the Dirac delta distribution on $v$, which yields\n$$\n\\int_{0}^{1}\\delta(x-\\tfrac{1}{2})\\,v(x)\\,dx = v\\!\\left(\\tfrac{1}{2}\\right).\n$$\nFor the left-hand side, we integrate by parts (Green's identity) using that $v\\in H_{0}^{1}(0,1)$ satisfies $v(0)=v(1)=0$:\n$$\n\\int_{0}^{1}\\left(-u''(x)\\right)v(x)\\,dx\n=\\left[-u'(x)v(x)\\right]_{0}^{1}+\\int_{0}^{1}u'(x)v'(x)\\,dx\n=\\int_{0}^{1}u'(x)v'(x)\\,dx,\n$$\nbecause $v(0)=v(1)=0$ makes the boundary term vanish. Therefore, the weak formulation is:\n$$\n\\int_{0}^{1}u'(x)v'(x)\\,dx = v\\!\\left(\\tfrac{1}{2}\\right) \\quad \\text{for all } v\\in H_{0}^{1}(0,1).\n$$\nThis matches option A.\n\nWhy the other options are incorrect:\n- B is incorrect because the Dirac delta acts on the function value $v(\\tfrac{1}{2})$, not on the derivative $v'(\\tfrac{1}{2})$.\n- C has the wrong sign; integration by parts produces a positive left-hand side $\\int u'v'$ under homogeneous Dirichlet boundary conditions.\n- D is not a proper weak form because it requires $u''$ to be integrable against $v$, whereas the weak solution $u$ lies in $H_{0}^{1}(0,1)$ and $u''$ need not exist as an $L^{2}$ function.\n- E includes boundary terms involving $u'(0)$ and $u'(1)$, which are not necessarily well-defined traces for $u\\in H_{0}^{1}(0,1)$; moreover, since $v(0)=v(1)=0$, such terms should not appear in a well-posed weak formulation.", "answer": "$$\\boxed{A}$$", "id": "2225027"}, {"introduction": "The weak formulation allows us to consider a broader class of solutions, including those that are not continuously differentiable. However, this extension has its limits. This practice challenges you to explore the nature of weak derivatives by examining a function with a jump discontinuity, a common feature in many physical problems. Understanding why such a function doesn't have a simple weak derivative in the space $L^2$ is key to appreciating the structure of the Sobolev spaces where weak solutions live.", "problem": "In the study of partial differential equations and numerical analysis, the concept of a weak derivative is used to extend the notion of differentiation to functions that are not classically differentiable, such as those that are not continuous. We consider functions in the space $L^2(0,1)$, which is the set of all functions $f(x)$ defined on the interval $(0,1)$ for which the integral $\\int_0^1 |f(x)|^2 \\,dx$ is finite.\n\nA function $v \\in L^2(0,1)$ is defined as the weak derivative of a function $u \\in L^2(0,1)$ if the following identity holds for every \"test function\" $\\phi \\in C_c^\\infty(0,1)$:\n$$ \\int_0^1 u(x) \\phi'(x) \\,dx = - \\int_0^1 v(x) \\phi(x) \\,dx $$\nHere, $C_c^\\infty(0,1)$ represents the set of all infinitely differentiable functions that are equal to zero outside some closed subinterval of $(0,1)$. A key property of these test functions is that they are zero at the boundaries, i.e., $\\phi(0) = \\phi(1) = 0$.\n\nNow, consider the specific function $u(x)$ defined on the interval $(0,1)$ as:\n$$ u(x) = \\begin{cases} 0 & \\text{if } 0 < x < 1/2 \\\\ 1 & \\text{if } 1/2 \\le x < 1 \\end{cases} $$\nThis function has a jump discontinuity at $x = 1/2$ and is an element of $L^2(0,1)$. It is a fundamental result that this function $u(x)$ does not possess a weak derivative that is also in $L^2(0,1)$.\n\nWhich of the following statements provides the most accurate reason for this fact?\n\nA. The function $u(x)$ is not in $L^2(0,1)$ because of its discontinuity, so the concept of a weak derivative is not applicable.\n\nB. The integral $\\int_0^1 u(x) \\phi'(x) \\,dx$ is mathematically undefined because $u(x)$ is not continuous.\n\nC. The test functions $\\phi(x) \\in C_c^\\infty(0,1)$ are not guaranteed to be in $L^2(0,1)$, making the integrals in the definition of the weak derivative invalid.\n\nD. Applying integration by parts to the term $\\int_0^1 u(x) \\phi'(x) \\,dx$ reveals a dependency on the value of the test function at the point of discontinuity, $\\phi(1/2)$, which cannot be produced by the integral of any single function $v \\in L^2(0,1)$ against $\\phi(x)$.\n\nE. The classical derivative of $u(x)$ is zero almost everywhere, which implies its weak derivative must be the zero function in $L^2(0,1)$. This leads to a contradiction because only constant functions have a zero weak derivative.", "solution": "We first verify that $u \\in L^{2}(0,1)$. Since $u(x)=0$ on $(0,\\frac{1}{2})$ and $u(x)=1$ on $[\\frac{1}{2},1)$, we have\n$$\n\\int_{0}^{1} |u(x)|^{2}\\,dx=\\int_{0}^{1/2} 0\\,dx+\\int_{1/2}^{1} 1\\,dx=\\frac{1}{2}<\\infty,\n$$\nso option A is false.\n\nFor any $\\phi \\in C_{c}^{\\infty}(0,1)$, we compute the defining integral for a weak derivative:\n$$\n\\int_{0}^{1} u(x)\\,\\phi'(x)\\,dx=\\int_{0}^{1/2} 0\\cdot \\phi'(x)\\,dx+\\int_{1/2}^{1} 1\\cdot \\phi'(x)\\,dx=\\phi(1)-\\phi\\!\\left(\\tfrac{1}{2}\\right).\n$$\nSince $\\phi(1)=0$ for $\\phi \\in C_{c}^{\\infty}(0,1)$, this reduces to\n$$\n\\int_{0}^{1} u(x)\\,\\phi'(x)\\,dx=-\\phi\\!\\left(\\tfrac{1}{2}\\right).\n$$\nThus, if a weak derivative $v \\in L^{2}(0,1)$ existed, by definition it would satisfy\n$$\n\\int_{0}^{1} u(x)\\,\\phi'(x)\\,dx=-\\int_{0}^{1} v(x)\\,\\phi(x)\\,dx \\quad \\text{for all } \\phi \\in C_{c}^{\\infty}(0,1),\n$$\nwhich, combined with the previous identity, would force\n$$\n\\int_{0}^{1} v(x)\\,\\phi(x)\\,dx=\\phi\\!\\left(\\tfrac{1}{2}\\right) \\quad \\text{for all } \\phi \\in C_{c}^{\\infty}(0,1).\n$$\nThe right-hand side is the point-evaluation functional at $x=\\tfrac{1}{2}$. We now show that no $v \\in L^{2}(0,1)$ can produce this functional via the $L^{2}$ pairing.\n\nAssume for contradiction that such $v \\in L^{2}(0,1)$ exists. By the Cauchyâ€“Schwarz inequality,\n$$\n\\left|\\int_{0}^{1} v(x)\\,\\phi(x)\\,dx\\right| \\le \\|v\\|_{L^{2}(0,1)}\\,\\|\\phi\\|_{L^{2}(0,1)} \\quad \\text{for all } \\phi \\in L^{2}(0,1).\n$$\nHence the functional $\\phi \\mapsto \\int_{0}^{1} v\\phi$ is continuous on $L^{2}(0,1)$ with respect to the $L^{2}$ norm. But the evaluation functional $\\phi \\mapsto \\phi\\!\\left(\\tfrac{1}{2}\\right)$ is not continuous on $L^{2}(0,1)$. To see this, choose a fixed $\\eta \\in C_{c}^{\\infty}((-1,1))$ with $\\eta(0)=1$ and define\n$$\n\\phi_{n}(x)=\\eta\\!\\left(n\\left(x-\\tfrac{1}{2}\\right)\\right).\n$$\nThen $\\phi_{n} \\in C_{c}^{\\infty}(0,1)$ for all sufficiently large $n$, $\\phi_{n}\\!\\left(\\tfrac{1}{2}\\right)=\\eta(0)=1$, and\n$$\n\\|\\phi_{n}\\|_{L^{2}(0,1)}^{2}=\\int_{0}^{1} \\left|\\eta\\!\\left(n\\left(x-\\tfrac{1}{2}\\right)\\right)\\right|^{2}\\,dx=\\frac{1}{n}\\int_{-1}^{1} |\\eta(y)|^{2}\\,dy \\to 0 \\quad \\text{as } n \\to \\infty.\n$$\nThus $|\\phi_{n}\\!\\left(\\tfrac{1}{2}\\right)|=1$ while $\\|\\phi_{n}\\|_{2} \\to 0$, contradicting any inequality of the form $|\\phi\\!\\left(\\tfrac{1}{2}\\right)| \\le C\\|\\phi\\|_{2}$. Therefore no $v \\in L^{2}(0,1)$ can satisfy $\\int v\\phi=\\phi\\!\\left(\\tfrac{1}{2}\\right)$ for all $\\phi \\in C_{c}^{\\infty}(0,1)$.\n\nThis shows that $u$ has no weak derivative in $L^{2}(0,1)$. Interpreted distributionally, the weak derivative is the Dirac measure at $\\tfrac{1}{2}$, which is not an $L^{2}$ function. Consequently, among the options, D is the accurate reason.\n\nFor completeness, we note that:\n- B is false because $\\int_{0}^{1} u\\,\\phi'$ is well-defined (indeed, computed above).\n- C is false because every $\\phi \\in C_{c}^{\\infty}(0,1)$ belongs to $L^{2}(0,1)$.\n- E is false: while the classical derivative of $u$ is zero almost everywhere, the weak derivative accounts for the jump via a distributional term; it is not the zero function in $L^{2}(0,1).", "answer": "$$\\boxed{D}$$", "id": "2225059"}, {"introduction": "Beyond its theoretical elegance, the weak formulation is the cornerstone of the powerful Finite Element Method (FEM) used to solve complex engineering and physics problems. This hands-on practice provides a glimpse into this computational world by having you construct a \"stiffness matrix,\" which is the discrete version of the differential operator for a set of basis functions. By doing so, you will be turning an infinite-dimensional problem into a solvable system of linear equations, forming the heart of the Galerkin method.", "problem": "Consider two continuous, piecewise linear functions, $\\phi_1(x)$ and $\\phi_2(x)$, defined on the interval $[0, 1]$. These functions are constructed based on a partition of the interval into three equal subintervals with nodes at $x_0=0$, $x_1=1/3$, $x_2=2/3$, and $x_3=1$.\n\nThe function $\\phi_1(x)$ is defined as:\n$$\n\\phi_1(x) =\n\\begin{cases}\n3x & \\text{for } 0 \\le x \\le 1/3 \\\\\n-3x + 2 & \\text{for } 1/3 < x \\le 2/3 \\\\\n0 & \\text{for } 2/3 < x \\le 1\n\\end{cases}\n$$\n\nThe function $\\phi_2(x)$ is defined as:\n$$\n\\phi_2(x) =\n\\begin{cases}\n0 & \\text{for } 0 \\le x \\le 1/3 \\\\\n3x - 1 & \\text{for } 1/3 < x \\le 2/3 \\\\\n-3x + 3 & \\text{for } 2/3 < x \\le 1\n\\end{cases}\n$$\n\nYour task is to compute the $2 \\times 2$ matrix $A$ with entries $A_{ij}$ given by the formula:\n$$\nA_{ij} = \\int_{0}^{1} \\frac{d\\phi_i}{dx}(x) \\frac{d\\phi_j}{dx}(x) \\,dx\n$$\nfor $i, j \\in \\{1, 2\\}$. Present your final answer as a $2 \\times 2$ matrix.", "solution": "We first compute the derivatives of the piecewise linear basis functions. Since derivatives at isolated points do not affect the integrals, we specify them on open subintervals and note that values at the knots are irrelevant for the integrals.\n\nFrom the definition of $\\phi_{1}(x)$,\n$$\n\\frac{d\\phi_{1}}{dx}(x)=\n\\begin{cases}\n3 & \\text{for } 0<x<\\frac{1}{3},\\\\\n-3 & \\text{for } \\frac{1}{3}<x<\\frac{2}{3},\\\\\n0 & \\text{for } \\frac{2}{3}<x<1.\n\\end{cases}\n$$\nFrom the definition of $\\phi_{2}(x)$,\n$$\n\\frac{d\\phi_{2}}{dx}(x)=\n\\begin{cases}\n0 & \\text{for } 0<x<\\frac{1}{3},\\\\\n3 & \\text{for } \\frac{1}{3}<x<\\frac{2}{3},\\\\\n-3 & \\text{for } \\frac{2}{3}<x<1.\n\\end{cases}\n$$\n\nWe now compute each entry $A_{ij}=\\int_{0}^{1}\\frac{d\\phi_{i}}{dx}(x)\\frac{d\\phi_{j}}{dx}(x)\\,dx$.\n\nFor $A_{11}$,\n$$\nA_{11}=\\int_{0}^{\\frac{1}{3}}3^{2}\\,dx+\\int_{\\frac{1}{3}}^{\\frac{2}{3}}(-3)^{2}\\,dx+\\int_{\\frac{2}{3}}^{1}0\\,dx\n=9\\left(\\frac{1}{3}\\right)+9\\left(\\frac{1}{3}\\right)+0=3+3=6.\n$$\n\nFor $A_{22}$,\n$$\nA_{22}=\\int_{0}^{\\frac{1}{3}}0\\,dx+\\int_{\\frac{1}{3}}^{\\frac{2}{3}}3^{2}\\,dx+\\int_{\\frac{2}{3}}^{1}(-3)^{2}\\,dx\n=0+9\\left(\\frac{1}{3}\\right)+9\\left(\\frac{1}{3}\\right)=3+3=6.\n$$\n\nFor $A_{12}$ (and by symmetry $A_{21}$),\n$$\nA_{12}=\\int_{0}^{\\frac{1}{3}}3\\cdot 0\\,dx+\\int_{\\frac{1}{3}}^{\\frac{2}{3}}(-3)\\cdot 3\\,dx+\\int_{\\frac{2}{3}}^{1}0\\cdot(-3)\\,dx\n=0+(-9)\\left(\\frac{1}{3}\\right)+0=-3.\n$$\nHence $A_{21}=A_{12}=-3$.\n\nTherefore, the matrix is\n$$\nA=\\begin{pmatrix}\n6 & -3\\\\\n-3 & 6\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}6 & -3 \\\\ -3 & 6\\end{pmatrix}}$$", "id": "2225051"}]}