{"hands_on_practices": [{"introduction": "The first step in mastering trust-region methods is understanding how to find the Cauchy point. This point represents a guaranteed decrease in our model function by searching along the most intuitive directionâ€”the steepest descent, $-g_k$. This practice problem [@problem_id:2209950] breaks this process down into a one-dimensional search, guiding you to calculate the precise scalar step length $t^C$ that minimizes the quadratic model within the confines of the trust region.", "problem": "In the field of numerical optimization, trust-region methods are a class of algorithms used for solving unconstrained optimization problems. At each iteration $k$, these methods approximate a function $f(x)$ with a quadratic model $m_k(p)$ around the current iterate $x_k$. The goal is to find a step $p$ that minimizes this model within a \"trust region\" of radius $\\Delta_k > 0$. The subproblem is formulated as:\n$$ \\min_{p \\in \\mathbb{R}^n} \\quad m_k(p) = f_k + g_k^T p + \\frac{1}{2} p^T B_k p $$\n$$ \\text{subject to} \\quad \\|p\\|_2 \\le \\Delta_k $$\nwhere $f_k = f(x_k)$ is the function value, $g_k = \\nabla f(x_k)$ is the gradient, and $B_k$ is a symmetric matrix that approximates the Hessian of $f$ at $x_k$.\n\nA fundamental component of many trust-region algorithms is the calculation of the Cauchy point. The Cauchy point, denoted $p^C$, is defined as the minimizer of the quadratic model $m_k(p)$ along the steepest descent direction ($-g_k$), constrained by the trust region. The step is of the form $p^C = -t^C g_k$, where the scalar step length $t^C > 0$ is chosen to solve the one-dimensional problem:\n$$ \\min_{t > 0} \\quad m_k(-t g_k) \\quad \\text{subject to} \\quad \\|-t g_k\\|_2 \\le \\Delta_k $$\n\nConsider a specific iteration of a trust-region algorithm where the gradient is given by $g_k = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$, the Hessian approximation is the diagonal matrix $B_k = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}$, and the trust-region radius is $\\Delta_k = 8$.\n\nYour task is to determine the exact value of the scalar step length $t^C$ for the Cauchy point. Express your answer as a fraction in simplest form.", "solution": "The goal is to find the value of $t^C$ that minimizes the quadratic model along the steepest descent direction, subject to the trust-region constraint. The step is $p(t) = -t g_k$ for $t > 0$.\n\nFirst, we substitute $p(t)$ into the model function $m_k(p)$ to obtain a one-dimensional function of $t$, which we'll call $\\phi(t)$.\n$$ \\phi(t) = m_k(-t g_k) = f_k + g_k^T(-t g_k) + \\frac{1}{2}(-t g_k)^T B_k (-t g_k) $$\nUsing the properties of transposes and scalars, this simplifies to:\n$$ \\phi(t) = f_k - t (g_k^T g_k) + \\frac{1}{2} t^2 (g_k^T B_k g_k) $$\nRecognizing that $g_k^T g_k = \\|g_k\\|_2^2$, the function is:\n$$ \\phi(t) = f_k - t \\|g_k\\|_2^2 + \\frac{1}{2} t^2 (g_k^T B_k g_k) $$\nThis is a quadratic function in $t$ of the form $C + At + \\frac{1}{2} Dt^2$, where $C=f_k$, $A = -\\|g_k\\|_2^2$, and $D = g_k^T B_k g_k$.\n\nNext, we analyze the trust-region constraint:\n$$ \\|-t g_k\\|_2 \\le \\Delta_k $$\nSince $t > 0$, we can take it out of the norm:\n$$ t \\|g_k\\|_2 \\le \\Delta_k $$\nThis gives an upper bound on $t$:\n$$ t \\le \\frac{\\Delta_k}{\\|g_k\\|_2} $$\n\nThe minimization of $\\phi(t)$ depends on the sign of the quadratic coefficient, $g_k^T B_k g_k$.\n\nCase 1: $g_k^T B_k g_k > 0$. The function $\\phi(t)$ is a convex quadratic and has a unique minimizer. We can find this unconstrained minimizer, $t^*$, by setting the derivative of $\\phi(t)$ with respect to $t$ to zero:\n$$ \\frac{d\\phi}{dt} = -\\|g_k\\|_2^2 + t (g_k^T B_k g_k) = 0 $$\n$$ t^* = \\frac{\\|g_k\\|_2^2}{g_k^T B_k g_k} $$\nThe constrained minimizer $t^C$ is then found by taking the smaller of $t^*$ and the maximum allowed step from the trust-region constraint:\n$$ t^C = \\min\\left(t^*, \\frac{\\Delta_k}{\\|g_k\\|_2}\\right) $$\n\nCase 2: $g_k^T B_k g_k \\le 0$. The function $\\phi(t)$ is either linear and decreasing (if $g_k \\neq 0$) or concave. In this situation, the function value decreases as $t$ increases. Thus, the minimum within the allowed interval $[0, \\Delta_k/\\|g_k\\|_2]$ is achieved at the boundary.\n$$ t^C = \\frac{\\Delta_k}{\\|g_k\\|_2} $$\n\nNow, let's apply the given values: $g_k = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$, $B_k = \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}$, $\\Delta_k = 8$.\n\nFirst, we compute the necessary scalar quantities:\nThe squared L2-norm of the gradient is:\n$$ \\|g_k\\|_2^2 = 3^2 + 4^2 = 9 + 16 = 25 $$\nThe L2-norm of the gradient is:\n$$ \\|g_k\\|_2 = \\sqrt{25} = 5 $$\nThe curvature term is:\n$$ g_k^T B_k g_k = \\begin{pmatrix} 3 & 4 \\end{pmatrix} \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} $$\n$$ = \\begin{pmatrix} 3 & 4 \\end{pmatrix} \\begin{pmatrix} 2 \\cdot 3 + 0 \\cdot 4 \\\\ 0 \\cdot 3 + 1 \\cdot 4 \\end{pmatrix} = \\begin{pmatrix} 3 & 4 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 4 \\end{pmatrix} $$\n$$ = 3 \\cdot 6 + 4 \\cdot 4 = 18 + 16 = 34 $$\n\nSince $g_k^T B_k g_k = 34 > 0$, we are in Case 1.\nWe calculate the unconstrained minimizer step length $t^*$:\n$$ t^* = \\frac{\\|g_k\\|_2^2}{g_k^T B_k g_k} = \\frac{25}{34} $$\nNext, we calculate the step length to the trust-region boundary:\n$$ \\frac{\\Delta_k}{\\|g_k\\|_2} = \\frac{8}{5} $$\nThe Cauchy step length $t^C$ is the minimum of these two values:\n$$ t^C = \\min\\left(\\frac{25}{34}, \\frac{8}{5}\\right) $$\nTo compare the two fractions, we can find a common denominator or use cross-multiplication.\n$25 \\times 5 = 125$\n$34 \\times 8 = 272$\nSince $125  272$, it follows that $\\frac{25}{34}  \\frac{8}{5}$.\n\nTherefore, the unconstrained minimizer lies within the trust region, and the Cauchy step length is:\n$$ t^C = \\frac{25}{34} $$\nThis fraction is in its simplest form as the prime factors of 25 are (5, 5) and the prime factors of 34 are (2, 17), so they share no common factors.", "answer": "$$\\boxed{\\frac{25}{34}}$$", "id": "2209950"}, {"introduction": "In our previous exercise, the step length calculation depended on the term $g_k^T B_k g_k$. This exercise [@problem_id:2209930] delves into the physical meaning of this term: the curvature of the objective function model along the steepest descent direction. Understanding curvature is critical, as negative curvature ($g_k^T B_k g_k  0$) implies the model decreases indefinitely along this path, making the trust-region boundary not just a constraint, but a necessity for finding a meaningful step.", "problem": "In the field of numerical optimization, trust-region methods are a class of algorithms for solving unconstrained optimization problems. At each step, they approximate the objective function $f(x)$ with a simpler model function $m_k(p)$ within a \"trust region\" around the current point $x_k$. A common choice for the model is a quadratic function:\n$$m_k(p) = f(x_k) + g_k^T p + \\frac{1}{2} p^T B_k p$$\nHere, $p$ is the step to be taken from $x_k$, $g_k = \\nabla f(x_k)$ is the gradient of the objective function at $x_k$, and $B_k$ is a symmetric matrix that approximates the Hessian of $f$ at $x_k$.\n\nThe curvature of the model $m_k(p)$ along a direction $p$ is given by the value $p^T B_k p$. If this value is negative, it indicates \"negative curvature,\" a situation where the quadratic model does not have a minimizer and decreases as one moves along that direction.\n\nConsider an optimization problem in two dimensions ($x \\in \\mathbb{R}^2$). At a certain iteration $k$, the gradient is found to be $g_k = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$. The Hessian approximation is a diagonal matrix of the form $B_k = \\text{diag}(d_1, d_2)$. A common check in trust-region algorithms involves examining the curvature along the direction of steepest descent, which is given by $-g_k$.\n\nFor which of the following pairs of values $(d_1, d_2)$ does the quadratic model $m_k(p)$ exhibit negative curvature along the steepest descent direction? Select all that apply.\n\nA. $(d_1, d_2) = (1.5, 0.5)$\n\nB. $(d_1, d_2) = (3.0, -2.5)$\n\nC. $(d_1, d_2) = (-4.0, 1.0)$\n\nD. $(d_1, d_2) = (-2.0, -1.5)$\n\nE. $(d_1, d_2) = (2.0, -3.0)$", "solution": "The curvature of the quadratic model $m_{k}(p)$ along a direction $p$ is given by $p^{T} B_{k} p$. Negative curvature along a direction occurs when $p^{T} B_{k} p  0$.\n\nThe steepest descent direction at $x_{k}$ is $-g_{k}$. Given $g_{k} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, the direction is\n$$\np = -g_{k} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}.\n$$\nWith $B_{k} = \\mathrm{diag}(d_{1}, d_{2})$, we have\n$$\np^{T} B_{k} p = \\begin{pmatrix} -1  -1 \\end{pmatrix} \\begin{pmatrix} d_{1}  0 \\\\ 0  d_{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} = d_{1}(-1)^{2} + d_{2}(-1)^{2} = d_{1} + d_{2}.\n$$\nTherefore, the model exhibits negative curvature along $-g_{k}$ if and only if\n$$\nd_{1} + d_{2}  0.\n$$\n\nEvaluate each option:\n- A: $1.5 + 0.5 = 2.0 > 0$; not negative curvature.\n- B: $3.0 + (-2.5) = 0.5 > 0$; not negative curvature.\n- C: $-4.0 + 1.0 = -3.0  0$; negative curvature.\n- D: $-2.0 + (-1.5) = -3.5  0$; negative curvature.\n- E: $2.0 + (-3.0) = -1.0  0$; negative curvature.\n\nThus, the correct choices are C, D, and E.", "answer": "$$\\boxed{CDE}$$", "id": "2209930"}, {"introduction": "We have seen that the Cauchy point can either lie strictly inside the trust region or on its boundary, depending on whether the unconstrained minimum is \"too far\". This final practice problem [@problem_id:2209918] challenges you to synthesize this concept by finding the exact trust-radius value, $\\Delta_k$, that defines the critical threshold between these two cases. Determining this boundary sharpens your intuition for how the algorithm's step is governed by the interplay between the model's local geometry and the size of the search area.", "problem": "In trust-region methods for numerical optimization, a function $f(x)$ is approximated at an iterate $x_k$ by a quadratic model $m_k(p)$:\n$$m_k(p) = f(x_k) + g_k^T p + \\frac{1}{2} p^T B_k p$$\nHere, $p$ is the step from $x_k$, $g_k$ is the gradient of $f$ at $x_k$, and $B_k$ is an approximation to the Hessian matrix of $f$ at $x_k$. The step $p$ is found by minimizing $m_k(p)$ within a trust region defined by $\\|p\\|_2 \\le \\Delta_k$, where $\\Delta_k > 0$ is the trust-region radius.\n\nA fundamental component of this method is the calculation of the Cauchy point, $p_k^C$. This point is defined as the minimizer of the quadratic model $m_k(p)$ along the steepest descent direction, $p(\\tau) = -\\tau g_k$ for $\\tau > 0$, subject to the trust-region constraint.\n\nConsider a specific iteration where the gradient is $g_k = \\begin{pmatrix} 3 \\\\ -4 \\end{pmatrix}$ and the Hessian approximation is $B_k = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix}$.\n\nDetermine the exact value of the trust-region radius $\\Delta_k$ that marks the boundary between two cases: where the Cauchy point is found by an unconstrained minimization along the steepest descent direction, and where it is limited by the trust-region boundary. Express your answer as an exact fraction.", "solution": "We consider the quadratic model $m_{k}(p)=f(x_{k})+g_{k}^{T}p+\\frac{1}{2}p^{T}B_{k}p$ and restrict to the steepest-descent ray $p(\\tau)=-\\tau g_{k}$ with $\\tau > 0$. Along this ray,\n$$\nm_{k}(-\\tau g_{k})=f(x_{k})-\\tau\\,g_{k}^{T}g_{k}+\\frac{1}{2}\\tau^{2}\\,g_{k}^{T}B_{k}g_{k}.\n$$\nThe unconstrained minimizer along the ray is obtained by setting the derivative with respect to $\\tau$ to zero:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\tau}m_{k}(-\\tau g_{k})=-g_{k}^{T}g_{k}+\\tau\\,g_{k}^{T}B_{k}g_{k}=0,\n$$\nwhich yields\n$$\n\\tau_{\\ast}=\\frac{g_{k}^{T}g_{k}}{g_{k}^{T}B_{k}g_{k}}.\n$$\nThe corresponding unconstrained step is $p_{\\ast}=-\\tau_{\\ast}g_{k}$, whose norm is\n$$\n\\|p_{\\ast}\\|_{2}=\\tau_{\\ast}\\|g_{k}\\|_{2}.\n$$\nThe trust-region Cauchy point equals this unconstrained minimizer along the ray if and only if $\\|p_{\\ast}\\|_{2} \\le \\Delta_{k}$. Therefore, the boundary between the unconstrained case and the trust-region-limited case is\n$$\n\\Delta_{k}^{\\text{boundary}}=\\|p_{\\ast}\\|_{2}=\\tau_{\\ast}\\|g_{k}\\|_{2}.\n$$\nWith $g_{k}=\\begin{pmatrix}3\\\\-4\\end{pmatrix}$ and $B_{k}=\\begin{pmatrix}21\\\\13\\end{pmatrix}$, we compute:\n$$\ng_{k}^{T}g_{k}=3^{2}+(-4)^{2}=9+16=25,\n$$\n$$\nB_{k}g_{k}=\\begin{pmatrix}21\\\\13\\end{pmatrix}\\begin{pmatrix}3\\\\-4\\end{pmatrix}=\\begin{pmatrix}2\\cdot 3+1\\cdot(-4)\\\\1\\cdot 3+3\\cdot(-4)\\end{pmatrix}=\\begin{pmatrix}2\\\\-9\\end{pmatrix},\n$$\n$$\ng_{k}^{T}B_{k}g_{k}= \\begin{pmatrix}3-4\\end{pmatrix}\\begin{pmatrix}2\\\\-9\\end{pmatrix}=3\\cdot 2+(-4)\\cdot(-9)=6+36=42,\n$$\nand\n$$\n\\|g_{k}\\|_{2}=\\sqrt{25}=5.\n$$\nHence\n$$\n\\tau_{\\ast}=\\frac{25}{42},\\qquad \\Delta_{k}^{\\text{boundary}}=\\tau_{\\ast}\\|g_{k}\\|_{2}=\\frac{25}{42}\\cdot 5=\\frac{125}{42}.\n$$\nThus, the exact trust-region radius at the boundary between the two cases is $\\frac{125}{42}$.", "answer": "$$\\boxed{\\frac{125}{42}}$$", "id": "2209918"}]}