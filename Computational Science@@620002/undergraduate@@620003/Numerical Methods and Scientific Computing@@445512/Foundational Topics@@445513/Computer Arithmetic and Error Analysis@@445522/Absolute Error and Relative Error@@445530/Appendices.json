{"hands_on_practices": [{"introduction": "To begin our exploration of error analysis, we'll ground ourselves in a common engineering scenario. This practice involves calculating the work done by an expanding gas, a value determined by an integral. By comparing the exact result with a simple numerical approximation, you will calculate the absolute error, which is the most direct way to quantify the discrepancy between a true value and an estimated one [@problem_id:2152061].", "problem": "An engineer is analyzing the isothermal expansion of a gas in a piston-cylinder assembly. The work, $W$, performed by the gas as it expands from an initial volume $V_1$ to a final volume $V_2$ is given by the integral $W = \\int_{V_1}^{V_2} P(V) dV$, where $P(V)$ is the pressure of the gas as a function of its volume $V$.\n\nThe gas is modeled as an ideal gas, so its pressure follows the relation $P(V) = \\frac{nRT}{V}$, where $n$ is the number of moles of the gas, $R$ is the ideal gas constant, and $T$ is the absolute temperature. The expansion occurs under the following conditions:\n- Moles of gas, $n = 1.00$ mol\n- Ideal gas constant, $R = 8.314 \\text{ J/(mol}\\cdot\\text{K)}$\n- Constant temperature, $T = 300$ K\n- Initial volume, $V_1 = 0.0250 \\, \\text{m}^3$\n- Final volume, $V_2 = 0.0500 \\, \\text{m}^3$\n\nTo quickly estimate the work done, the engineer uses a linear approximation for the pressure. This approximation assumes the work can be estimated using the formula $W_{approx} = \\frac{1}{2}(P_1 + P_2)(V_2 - V_1)$, where $P_1$ and $P_2$ are the pressures at the initial volume $V_1$ and final volume $V_2$, respectively.\n\nCalculate the absolute error of this approximation, which is defined as the absolute difference between the exact work done and the approximated work. Express your answer in joules, rounded to three significant figures.", "solution": "The problem asks for the absolute error between the exact work done by an isothermally expanding ideal gas and an approximation of that work. The absolute error, $E_{\\text{abs}}$, is given by $E_{\\text{abs}} = |W_{exact} - W_{approx}|$.\n\nFirst, we calculate the exact work done, $W_{exact}$. The formula for work is $W = \\int_{V_1}^{V_2} P(V) dV$. For an ideal gas, $P(V) = \\frac{nRT}{V}$. Substituting this into the integral gives:\n$$W_{exact} = \\int_{V_1}^{V_2} \\frac{nRT}{V} dV$$\nSince $n$, $R$, and $T$ are constants, we can take them out of the integral:\n$$W_{exact} = nRT \\int_{V_1}^{V_2} \\frac{1}{V} dV$$\nEvaluating the integral of $\\frac{1}{V}$ gives the natural logarithm, $\\ln(V)$:\n$$W_{exact} = nRT \\left[ \\ln|V| \\right]_{V_1}^{V_2} = nRT (\\ln(V_2) - \\ln(V_1))$$\nUsing the properties of logarithms, this can be simplified to:\n$$W_{exact} = nRT \\ln\\left(\\frac{V_2}{V_1}\\right)$$\n\nNext, we calculate the approximated work, $W_{approx}$, using the provided formula:\n$$W_{approx} = \\frac{1}{2}(P_1 + P_2)(V_2 - V_1)$$\nHere, $P_1$ and $P_2$ are the pressures at volumes $V_1$ and $V_2$, respectively. Using the ideal gas law:\n$$P_1 = P(V_1) = \\frac{nRT}{V_1}$$\n$$P_2 = P(V_2) = \\frac{nRT}{V_2}$$\nSubstituting these expressions for pressure into the approximation formula:\n$$W_{approx} = \\frac{1}{2}\\left(\\frac{nRT}{V_1} + \\frac{nRT}{V_2}\\right)(V_2 - V_1)$$\nWe can factor out the constant term $nRT$:\n$$W_{approx} = \\frac{nRT}{2}\\left(\\frac{1}{V_1} + \\frac{1}{V_2}\\right)(V_2 - V_1)$$\nTo simplify the expression in the parentheses, we find a common denominator:\n$$W_{approx} = \\frac{nRT}{2}\\left(\\frac{V_2 + V_1}{V_1 V_2}\\right)(V_2 - V_1)$$\nRecognizing that $(V_2 + V_1)(V_2 - V_1) = V_2^2 - V_1^2$, we get:\n$$W_{approx} = \\frac{nRT}{2} \\frac{V_2^2 - V_1^2}{V_1 V_2}$$\n\nNow we can write the expression for the absolute error, $E_{\\text{abs}}$:\n$$E_{\\text{abs}} = |W_{exact} - W_{approx}| = \\left| nRT \\ln\\left(\\frac{V_2}{V_1}\\right) - \\frac{nRT}{2} \\frac{V_2^2 - V_1^2}{V_1 V_2} \\right|$$\nFactoring out $nRT$:\n$$E_{\\text{abs}} = nRT \\left| \\ln\\left(\\frac{V_2}{V_1}\\right) - \\frac{V_2^2 - V_1^2}{2V_1 V_2} \\right|$$\n\nNow, we substitute the given numerical values:\n$n = 1.00$ mol\n$R = 8.314 \\text{ J/(mol}\\cdot\\text{K)}$\n$T = 300$ K\n$V_1 = 0.0250 \\, \\text{m}^3$\n$V_2 = 0.0500 \\, \\text{m}^3$\n\nFirst, let's calculate the pre-factor $nRT$:\n$$nRT = (1.00 \\, \\text{mol}) \\times (8.314 \\, \\frac{\\text{J}}{\\text{mol}\\cdot\\text{K}}) \\times (300 \\, \\text{K}) = 2494.2 \\, \\text{J}$$\nNext, let's evaluate the terms inside the absolute value. The ratio of volumes is:\n$$\\frac{V_2}{V_1} = \\frac{0.0500 \\, \\text{m}^3}{0.0250 \\, \\text{m}^3} = 2$$\nSo the logarithmic term is $\\ln(2)$.\n\nFor the second term, we can substitute the volumes:\n$$\\frac{V_2^2 - V_1^2}{2V_1 V_2} = \\frac{(0.0500)^2 - (0.0250)^2}{2(0.0250)(0.0500)} = \\frac{0.0025 - 0.000625}{0.0025} = \\frac{0.001875}{0.0025} = 0.75$$\nAlternatively, using the symbolic ratio $V_2 = 2V_1$:\n$$\\frac{(2V_1)^2 - V_1^2}{2V_1 (2V_1)} = \\frac{4V_1^2 - V_1^2}{4V_1^2} = \\frac{3V_1^2}{4V_1^2} = \\frac{3}{4} = 0.75$$\n\nNow, substitute these values back into the expression for $E_{\\text{abs}}$:\n$$E_{\\text{abs}} = 2494.2 \\, \\text{J} \\times \\left| \\ln(2) - 0.75 \\right|$$\nUsing a calculator for $\\ln(2)$:\n$$\\ln(2) \\approx 0.693147$$\nSo the term in the absolute value is:\n$$|0.693147 - 0.75| = |-0.056853| = 0.056853$$\nFinally, calculate the absolute error:\n$$E_{\\text{abs}} = 2494.2 \\times 0.056853 \\approx 141.8105 \\, \\text{J}$$\n\nThe problem requires the answer to be rounded to three significant figures.\n$$E_{\\text{abs}} \\approx 142 \\, \\text{J}$$", "answer": "$$\\boxed{142}$$", "id": "2152061"}, {"introduction": "While some numerical errors are small and manageable, others can grow dramatically and invalidate a computation. This practice explores the critical concept of numerical stability by examining what happens when a computer subtracts two very close numbers [@problem_id:2152049]. By simulating calculations with finite precision, you will see how an algebraically correct formula can lead to a large relative error, and how a simple rearrangement can restore accuracy.", "problem": "In a numerical simulation, a quantity of interest is calculated using the function $f(x) = \\sqrt{x+1} - \\sqrt{x}$ for large values of $x$. Due to potential numerical instability, an algebraically equivalent form $g(x) = \\frac{1}{\\sqrt{x+1} + \\sqrt{x}}$ is also considered.\n\nSuppose the calculations are performed on a processor that uses six-digit rounding arithmetic. This means that after every arithmetic operation (addition, subtraction, multiplication, division, and square root), the result is rounded to six significant figures before the next operation is performed.\n\nLet $\\tilde{y}_f$ be the value computed for $f(x)$ and $\\tilde{y}_g$ be the value computed for $g(x)$ at $x = 1.2 \\times 10^5$. For the purpose of this analysis, treat the value $\\tilde{y}_g$ obtained from the more stable form as the correct reference value.\n\nCalculate the relative error of $\\tilde{y}_f$ with respect to $\\tilde{y}_g$. Express your final answer as a decimal rounded to four significant figures.", "solution": "We simulate six-digit rounding arithmetic after every operation. Let $x = 1.2 \\times 10^{5}$.\n\nCompute for $f(x) = \\sqrt{x+1} - \\sqrt{x}$:\n- Addition: $x+1 = 120000 + 1 = 120001$, which is already six significant figures.\n- Square roots (rounded to six significant figures each):\n  - $\\sqrt{120000} = 346.4101615\\ldots \\to 346.410$.\n  - $\\sqrt{120001} \\approx 346.411604886\\ldots \\to 346.412$.\n- Subtraction and rounding: $\\tilde{y}_{f} = 346.412 - 346.410 = 0.002$. Rounded to six significant figures, this is $0.00200000$, numerically $0.002$.\n\nCompute for $g(x) = \\frac{1}{\\sqrt{x+1} + \\sqrt{x}}$:\n- Reuse the rounded square roots: $346.412$ and $346.410$.\n- Addition and rounding: $346.412 + 346.410 = 692.822$, which has six significant figures.\n- Division and rounding: $\\tilde{y}_{g} = \\frac{1}{692.822} \\approx 0.001443372\\ldots \\to 0.00144337$ (six significant figures).\n\nTreat $\\tilde{y}_{g}$ as the correct reference. The relative error of $\\tilde{y}_{f}$ with respect to $\\tilde{y}_{g}$ is\n$$\n\\text{RelErr} = \\frac{|\\tilde{y}_{f} - \\tilde{y}_{g}|}{|\\tilde{y}_{g}|}\n= \\frac{|0.002 - 0.00144337|}{0.00144337}\n= \\frac{0.00055663}{0.00144337} \\approx 0.385646\\ldots\n$$\nRounded to four significant figures, the relative error is $0.3856$.", "answer": "$$\\boxed{0.3856}$$", "id": "2152049"}, {"introduction": "To deepen our understanding of catastrophic cancellation, we now move from simulation to a formal numerical experiment. This exercise asks you to model and implement a test to find the maximum possible relative error when subtracting nearly equal numbers under a fixed-relative-error model. By taking an adversarial approach—intentionally maximizing the error—you will gain a powerful insight into the principles of robust numerical programming and error analysis [@problem_id:3202463].", "problem": "You are asked to design and implement a numerical experiment, grounded in first principles, to demonstrate that subtracting nearly equal numbers that each have a fixed relative error can produce a result with an arbitrarily large relative error. Use only the foundational definitions of absolute error and relative error, and construct your experiment accordingly.\n\nDefinitions and modeling assumptions:\n- For a true value $x$ and an approximation $\\hat{x}$, the absolute error is $|\\hat{x}-x|$ and the relative error is $|\\hat{x}-x|/|x|$.\n- Adopt the fixed-relative-error model: for a prescribed $\\epsilon > 0$, each computed operand $\\hat{x}$ of a true value $x$ satisfies $\\hat{x}=x(1+s\\epsilon)$ where $s \\in \\{-1,+1\\}$ is an adversarial sign that can vary from operand to operand.\n\nExperiment design (universal mathematical setting with no physical units):\n- Consider subtracting two positive numbers $a$ and $b$ that are nearly equal. Let $a=1$ and $b=1-d$ with $d > 0$ small. The true difference is $c=a-b=d$.\n- Suppose each operand is computed with a fixed relative error magnitude $\\epsilon > 0$, independently choosing the error sign for each operand. That is, $\\hat{a}=a(1+s_1\\epsilon)$ and $\\hat{b}=b(1+s_2\\epsilon)$ with $s_1,s_2 \\in \\{-1,+1\\}$.\n- The computed difference is $\\hat{c}=\\hat{a}-\\hat{b}$, and the relative error of the result is $|\\hat{c}-c|/|c|$.\n\nTask:\n- For a fixed $\\epsilon$ and each given $d$, evaluate the maximum possible relative error of the subtraction result over all four sign combinations $(s_1,s_2) \\in \\{-1,+1\\}^2$. This corresponds to an adversarial choice of operand error signs under the fixed-relative-error model.\n- Your program must implement this experiment and produce the requested outputs with no user input.\n\nTest suite and coverage:\n- Use the fixed relative error magnitude $\\epsilon=10^{-8}$.\n- Use the following list of $d$-values to probe different regimes: $[10^{-1},\\,10^{-4},\\,10^{-8},\\,10^{-10},\\,10^{-12}]$.\n  - $d=10^{-1}$ is a happy-path case where the difference is not too small relative to $\\epsilon$.\n  - $d=10^{-4}$ is a moderately small difference.\n  - $d=10^{-8}$ is a boundary-scale difference comparable to $\\epsilon$.\n  - $d=10^{-10}$ and $d=10^{-12}$ are edge cases where the difference is much smaller than $\\epsilon$, illustrating blow-up.\n\nOutput specification:\n- For each $d$ in the order listed, compute the maximum relative error (a nonnegative real number) over the four sign combinations. Aggregate the five results into a single list in the same order.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4,x_5]$.\n- Format each number in base-$10$ scientific notation with exactly $12$ digits after the decimal point. For example, the value $1.234567890123\\times 10^{3}$ must be printed as the string $1.234567890123e+03$.", "solution": "The objective is to find the maximum possible relative error in the computation of $c = a-b$, where $a=1$ and $b=1-d$. The true result is $c = a-b = 1 - (1-d) = d$.\n\nThe operands are computed with a fixed relative error of magnitude $\\epsilon$. The computed values, $\\hat{a}$ and $\\hat{b}$, are given by:\n$$ \\hat{a} = a(1+s_1\\epsilon) = 1(1+s_1\\epsilon) = 1+s_1\\epsilon $$\n$$ \\hat{b} = b(1+s_2\\epsilon) = (1-d)(1+s_2\\epsilon) $$\nwhere $s_1, s_2 \\in \\{-1, +1\\}$.\n\nThe computed difference is $\\hat{c} = \\hat{a} - \\hat{b}$. Let us substitute the expressions for $\\hat{a}$ and $\\hat{b}$:\n$$ \\hat{c} = (1+s_1\\epsilon) - (1-d)(1+s_2\\epsilon) $$\nExpanding the second term:\n$$ \\hat{c} = 1+s_1\\epsilon - (1 + s_2\\epsilon - d - ds_2\\epsilon) $$\n$$ \\hat{c} = 1+s_1\\epsilon - 1 - s_2\\epsilon + d + ds_2\\epsilon $$\n$$ \\hat{c} = d + s_1\\epsilon - s_2\\epsilon + ds_2\\epsilon $$\n\nThe absolute error in the result is $\\Delta c = \\hat{c}-c$:\n$$ \\Delta c = (d + s_1\\epsilon - s_2\\epsilon + ds_2\\epsilon) - d $$\n$$ \\Delta c = s_1\\epsilon - s_2\\epsilon + ds_2\\epsilon = \\epsilon(s_1 - s_2 + ds_2) $$\n\nThe relative error, $E_{rel}$, is defined as $|\\Delta c|/|c|$. Since $c=d$ and we are given $d>0$, $|c|=d$.\n$$ E_{rel} = \\frac{|\\Delta c|}{|c|} = \\frac{|\\epsilon(s_1 - s_2 + ds_2)|}{d} $$\nSince $\\epsilon > 0$ and $d > 0$, we can write:\n$$ E_{rel} = \\frac{\\epsilon}{d} |s_1 - s_2 + ds_2| $$\n\nWe must find the maximum value of $E_{rel}$ over the four possible sign combinations for $(s_1, s_2)$.\n1.  Case $(s_1, s_2) = (+1, +1)$:\n    $|s_1 - s_2 + ds_2| = |1 - 1 + d(1)| = |d| = d$.\n    $E_{rel} = \\frac{\\epsilon}{d} \\cdot d = \\epsilon$.\n2.  Case $(s_1, s_2) = (-1, -1)$:\n    $|s_1 - s_2 + ds_2| = |-1 - (-1) + d(-1)| = |-d| = d$.\n    $E_{rel} = \\frac{\\epsilon}{d} \\cdot d = \\epsilon$.\n3.  Case $(s_1, s_2) = (+1, -1)$:\n    $|s_1 - s_2 + ds_2| = |1 - (-1) + d(-1)| = |2 - d|$. Since all given $d \\ll 2$, this is $2-d$.\n    $E_{rel} = \\frac{\\epsilon}{d} (2 - d) = \\epsilon\\left(\\frac{2}{d} - 1\\right)$.\n4.  Case $(s_1, s_2) = (-1, +1)$:\n    $|s_1 - s_2 + ds_2| = |-1 - 1 + d(1)| = |-2 + d|$. Since $d \\ll 2$, this is $2-d$.\n    $E_{rel} = \\frac{\\epsilon}{d} (2 - d) = \\epsilon\\left(\\frac{2}{d} - 1\\right)$.\n\nThe maximum relative error, $E_{rel, \\text{max}}$, is the maximum of the values from these cases:\n$$ E_{rel, \\text{max}} = \\max\\left(\\epsilon, \\epsilon\\left(\\frac{2}{d} - 1\\right)\\right) $$\nSince $\\epsilon > 0$, this is equivalent to finding $\\max\\left(1, \\frac{2}{d} - 1\\right)$. The condition $\\frac{2}{d} - 1 > 1$ simplifies to $\\frac{2}{d} > 2$, which means $1 > d$. All values of $d$ in the test suite satisfy $d  1$. Therefore, the maximum is achieved when the errors in the operands have opposite signs (cases 3 and 4), leading to cancellation of the leading terms and amplification of the error relative to the small result.\n\nThe formula for the maximum relative error is:\n$$ E_{rel, \\text{max}} = \\frac{\\epsilon(2-d)}{d} $$\nAs $d \\to 0$, $E_{rel, \\text{max}} \\approx \\frac{2\\epsilon}{d}$, which demonstrates that the relative error can become arbitrarily large.\n\nThe specified values are $\\epsilon=10^{-8}$ and $d \\in [10^{-1},\\,10^{-4},\\,10^{-8},\\,10^{-10},\\,10^{-12}]$. We apply the derived formula for each $d$.\n\n- For $d=10^{-1}$: $E_{rel, \\text{max}} = 10^{-8} \\frac{2-0.1}{0.1} = 10^{-8} \\times 19 = 1.9 \\times 10^{-7}$.\n- For $d=10^{-4}$: $E_{rel, \\text{max}} = 10^{-8} \\frac{2-10^{-4}}{10^{-4}} = 10^{-4}(2-10^{-4}) = 2 \\times 10^{-4} - 10^{-8} = 0.00019999$.\n- For $d=10^{-8}$: $E_{rel, \\text{max}} = 10^{-8} \\frac{2-10^{-8}}{10^{-8}} = 2 - 10^{-8} = 1.99999999$.\n- For $d=10^{-10}$: $E_{rel, \\text{max}} = 10^{-8} \\frac{2-10^{-10}}{10^{-10}} = 10^2(2 - 10^{-10}) = 200 - 10^{-8} = 199.99999999$.\n- For $d=10^{-12}$: $E_{rel, \\text{max}} = 10^{-8} \\frac{2-10^{-12}}{10^{-12}} = 10^4(2 - 10^{-12}) = 20000 - 10^{-8} = 19999.99999999$.\n\nThese values will be computed and formatted as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a numerical experiment to demonstrate catastrophic cancellation\n    when subtracting nearly equal numbers with fixed relative error.\n    \"\"\"\n    # Define the fixed relative error magnitude from the problem statement.\n    epsilon = 1e-8\n\n    # Define the test cases for d from the problem statement.\n    # a = 1, b = 1 - d\n    d_values = [\n        1e-1,\n        1e-4,\n        1e-8,\n        1e-10,\n        1e-12,\n    ]\n\n    results = []\n    \n    # We derived the formula for the maximum relative error as:\n    # E_rel_max = epsilon * (2 - d) / d\n    # This formula resulted from analyzing the four sign combinations (s1, s2)\n    # for the operand errors and finding the worst-case scenario, which occurs\n    # when s1 = -s2.\n    \n    for d in d_values:\n        # Calculate the maximum possible relative error using the derived analytical formula.\n        # This is more efficient and direct than simulating all four sign cases.\n        # Using 2.0 ensures floating-point arithmetic.\n        max_relative_error = epsilon * (2.0 - d) / d\n        results.append(max_relative_error)\n\n    # Format each result into base-10 scientific notation with exactly 12 digits\n    # after the decimal point, as required by the output specification.\n    # Example format: 1.234567890123e-07\n    formatted_results = [f\"{res:.12e}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3202463"}]}