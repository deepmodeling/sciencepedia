{"hands_on_practices": [{"introduction": "To master the technique of converting higher-order ODEs, we must first understand the fundamental rules of the game. This exercise serves as a crucial conceptual check by presenting a plausible but incorrect method for converting a second-order ODE. By analyzing why this approach fails, you will solidify your understanding of what constitutes a valid, \"closed\" state-space systemâ€”the essential starting point for any numerical solver.", "problem": "Consider the second-order ordinary differential equation (ODE) $$y''(t)=f\\big(y(t)\\big),$$ with initial conditions $$y(t_0)=y_0,\\quad y'(t_0)=w_0,$$ where $f$ is a given sufficiently smooth function and $t$ denotes time. A student proposes to convert this ODE into a first-order state-space system suitable for standard numerical integrators by defining the state vector as $$\\mathbf{v}(t)=\\begin{bmatrix}v_1(t)\\\\ v_2(t)\\end{bmatrix}=\\begin{bmatrix}y(t)\\\\ y''(t)\\end{bmatrix}.$$ Using only the core definition that a first-order state-space representation must have the form $$\\mathbf{v}'(t)=\\mathbf{G}\\big(t,\\mathbf{v}(t)\\big),\\quad \\mathbf{v}(t_0)=\\mathbf{v}_0,$$ where the right-hand side depends only on the current time and the current state, select the best explanation for why this proposal is not a valid state-space representation for use with standard first-order ODE solvers.\n\nA. It is not valid because the resulting system is not closed: expressing $v_1'(t)$ and $v_2'(t)$ requires quantities such as $y'(t)$ and $y'''(t)$ that are not functions of $\\big(t,v_1(t),v_2(t)\\big)$ alone, and the standard initial data $y(t_0)$ and $y'(t_0)$ do not directly provide a consistent $\\mathbf{v}(t_0)$ without introducing higher derivatives.\n\nB. It fails only when $f$ is nonlinear; if $f$ is linear, defining $v_1=y$ and $v_2=y''$ always yields a valid first-order state-space system.\n\nC. It is invalid because autonomous equations like $y''=f(y)$ cannot be written in state-space form; a valid state-space form requires explicit time dependence in the right-hand side.\n\nD. It is invalid because numerical integrators for initial value problems require the ODE to remain in second-order form; converting to first order is generally not allowed for implementation reasons.", "solution": "To determine why the student's proposal is invalid, we must check if it meets the definition of a first-order state-space system. A valid representation must be \"closed,\" meaning the time derivative of the state vector, $\\mathbf{v}'(t)$, can be expressed as a function $\\mathbf{G}$ that depends only on the time $t$ and the state vector $\\mathbf{v}(t)$ itself, i.e., $\\mathbf{v}'(t) = \\mathbf{G}(t, \\mathbf{v}(t))$.\n\nThe student proposes the state vector:\n$$\n\\mathbf{v}(t) = \\begin{bmatrix} v_1(t) \\\\ v_2(t) \\end{bmatrix} = \\begin{bmatrix} y(t) \\\\ y''(t) \\end{bmatrix}\n$$\nThe original ODE is $y''(t) = f(y(t))$. We can substitute this into the state vector definition:\n$$\n\\mathbf{v}(t) = \\begin{bmatrix} y(t) \\\\ f(y(t)) \\end{bmatrix} = \\begin{bmatrix} v_1(t) \\\\ f(v_1(t)) \\end{bmatrix}\n$$\nNow, let's compute the time derivative of the state vector, $\\mathbf{v}'(t)$:\n$$\n\\mathbf{v}'(t) = \\begin{bmatrix} v_1'(t) \\\\ v_2'(t) \\end{bmatrix} = \\begin{bmatrix} \\frac{d}{dt}y(t) \\\\ \\frac{d}{dt}y''(t) \\end{bmatrix} = \\begin{bmatrix} y'(t) \\\\ y'''(t) \\end{bmatrix}\n$$\nLet's analyze each component to see if it can be expressed as a function of only $t$, $v_1(t)$, and $v_2(t)$.\n\n1.  **Analyzing $v_1'(t)$:** The first component is $v_1'(t) = y'(t)$. The quantity $y'(t)$ (the velocity) is not part of the defined state vector $\\mathbf{v}(t) = [y(t), y''(t)]^T$. We cannot express $y'(t)$ as a function of $v_1=y$ and $v_2=y''$ without solving the original ODE, which is what we are trying to do in the first place. The system is not closed because the evolution of $v_1$ depends on a quantity, $y'$, that is external to the defined state.\n\n2.  **Analyzing $v_2'(t)$:** The second component is $v_2'(t) = y'''(t)$. Using the original ODE, $y''=f(y)$, we can find $y'''$ by differentiating with respect to time using the chain rule:\n    $$\n    y'''(t) = \\frac{d}{dt}y''(t) = \\frac{d}{dt}f(y(t)) = f'(y(t)) \\cdot y'(t)\n    $$\n    This expression also depends on $y'(t)$, which, as established, is not part of the state vector. Therefore, $v_2'(t)$ cannot be written as a function of only $v_1$ and $v_2$.\n\n3.  **Analyzing Initial Conditions:** The standard initial conditions for the second-order ODE are $y(t_0)=y_0$ and $y'(t_0)=w_0$. To start a numerical integration of the proposed system, we would need the initial state vector $\\mathbf{v}(t_0) = [v_1(t_0), v_2(t_0)]^T$. According to the proposal, this would be:\n    $$\n    \\mathbf{v}(t_0) = \\begin{bmatrix} y(t_0) \\\\ y''(t_0) \\end{bmatrix} = \\begin{bmatrix} y_0 \\\\ f(y(t_0)) \\end{bmatrix} = \\begin{bmatrix} y_0 \\\\ f(y_0) \\end{bmatrix}\n    $$\n    This initial vector is constructed using only $y_0$. The crucial initial condition $y'(t_0)=w_0$ is completely ignored. Without this information, the unique solution to the original ODE cannot be determined.\n\n**Conclusion:** The proposed state vector fails for two main reasons: it results in an \"open\" system where the state's derivative depends on external quantities, and it fails to incorporate all the necessary initial conditions.\n\n**Analysis of Options:**\n\n*   **A:** This option correctly states that the system is not closed because expressing the derivatives $v_1'$ and $v_2'$ requires quantities ($y'$ and $y'''$) that are not functions of the state variables $(v_1, v_2)$. It also correctly notes that the standard initial conditions cannot be consistently used. This aligns perfectly with our analysis.\n*   **B:** This is incorrect. The failure is structural and does not depend on whether $f$ is linear or nonlinear. For the linear case $y'' = -k y$, the proposed state is $\\mathbf{v} = [y, -ky]^T$. The derivative is $\\mathbf{v}' = [y', -ky']^T$. The dependency on the external quantity $y'$ remains.\n*   **C:** This is incorrect. Autonomous equations are routinely and validly converted to state-space form. The standard method $(x_1=y, x_2=y')$ yields the valid autonomous system $x_1' = x_2, x_2' = f(x_1)$.\n*   **D:** This is incorrect and states the opposite of standard numerical practice. The vast majority of general-purpose ODE solvers are designed for first-order systems, making the conversion of higher-order ODEs a fundamental and necessary step.\n\nTherefore, the best explanation is given in Option A.", "answer": "$$\\boxed{A}$$", "id": "3219198"}, {"introduction": "With the foundational principles clear, let's move to a practical application. This problem guides you through the standard procedure for converting a third-order linear ODE into a first-order system using the natural chain of derivatives. The exercise adds a realistic twist by providing initial conditions in a non-standard format, requiring you to translate them into the correct initial state vector for the new system.", "problem": "Consider the third-order ordinary differential equation (ODE)\n$$y^{(3)}(t)-4\\,y^{(2)}(t)+y^{(1)}(t)+6\\,y(t)=\\sin(t),$$\nwhere $y^{(k)}(t)$ denotes the $k$th derivative of $y(t)$ with respect to $t$. In numerical methods, a standard approach is to convert a higher-order ODE into an equivalent first-order system by introducing a state vector built from successive derivatives of $y(t)$. Using only the fundamental derivative relationships $y^{(1)}(t)=\\frac{d}{dt}y(t)$ and $y^{(k+1)}(t)=\\frac{d}{dt}y^{(k)}(t)$, define a state vector $\\boldsymbol{x}(t)$ with components $x_{1}(t)$, $x_{2}(t)$, and $x_{3}(t)$ such that the original third-order ODE becomes a first-order system for $\\boldsymbol{x}(t)$. The initial information is given in non-standard form:\n$$y(0)=2,\\quad y^{(1)}(0)=-1,\\quad y(0)+y^{(2)}(0)=5.$$\nDerive the consistent initial state vector $\\boldsymbol{x}(0)$ that must be supplied to a numerical solver for the first-order system. Express your final answer as a row matrix with exact values. No rounding is required.", "solution": "The problem requires converting a third-order ordinary differential equation (ODE) into a first-order system and then determining the initial state vector for this system based on a given set of initial conditions.\n\nThe given third-order ODE is:\n$$\ny^{(3)}(t) - 4\\,y^{(2)}(t) + y^{(1)}(t) + 6\\,y(t) = \\sin(t)\n$$\nwhere $y^{(k)}(t)$ is the $k$-th derivative of $y(t)$ with respect to $t$.\n\nThe standard method for converting an $n$-th order ODE into a first-order system is to define a state vector $\\boldsymbol{x}(t)$ of dimension $n$ whose components are the function $y(t)$ and its successive derivatives up to order $n-1$. For this third-order ODE, $n=3$, so the state vector $\\boldsymbol{x}(t)$ has $3$ components. We define the components as follows:\n$$\nx_{1}(t) = y(t)\n$$\n$$\nx_{2}(t) = y^{(1)}(t)\n$$\n$$\nx_{3}(t) = y^{(2)}(t)\n$$\nThe state vector is $\\boldsymbol{x}(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\\\ x_{3}(t) \\end{pmatrix}$.\n\nThe task is to find the initial state vector $\\boldsymbol{x}(0)$, which is given by:\n$$\n\\boldsymbol{x}(0) = \\begin{pmatrix} x_{1}(0) \\\\ x_{2}(0) \\\\ x_{3}(0) \\end{pmatrix} = \\begin{pmatrix} y(0) \\\\ y^{(1)}(0) \\\\ y^{(2)}(0) \\end{pmatrix}\n$$\nWe must determine the values of $y(0)$, $y^{(1)}(0)$, and $y^{(2)}(0)$ from the information provided in the problem.\n\nThe problem gives the following initial information:\n1. $y(0) = 2$\n2. $y^{(1)}(0) = -1$\n3. $y(0) + y^{(2)}(0) = 5$\n\nWe can directly use these to find the components of the initial state vector $\\boldsymbol{x}(0)$.\n\nFor the first component, $x_{1}(0)$:\nFrom our definition, $x_{1}(0) = y(0)$. The first condition provides this value directly.\n$$\nx_{1}(0) = 2\n$$\n\nFor the second component, $x_{2}(0)$:\nFrom our definition, $x_{2}(0) = y^{(1)}(0)$. The second condition provides this value directly.\n$$\nx_{2}(0) = -1\n$$\n\nFor the third component, $x_{3}(0)$:\nFrom our definition, $x_{3}(0) = y^{(2)}(0)$. The third condition relates $y^{(2)}(0)$ to $y(0)$. We can use the known value of $y(0)$ to solve for $y^{(2)}(0)$.\nThe third condition is $y(0) + y^{(2)}(0) = 5$.\nSubstituting the value $y(0) = 2$ into this equation gives:\n$$\n2 + y^{(2)}(0) = 5\n$$\nSolving for $y^{(2)}(0)$:\n$$\ny^{(2)}(0) = 5 - 2 = 3\n$$\nTherefore, the third component of the initial state vector is:\n$$\nx_{3}(0) = 3\n$$\n\nHaving found all three components, we can now construct the initial state vector $\\boldsymbol{x}(0)$.\n$$\n\\boldsymbol{x}(0) = \\begin{pmatrix} 2 \\\\ -1 \\\\ 3 \\end{pmatrix}\n$$\nThe problem requests the final answer to be expressed as a row matrix. Therefore, the consistent initial state vector is:\n$$\n\\begin{pmatrix} 2 & -1 & 3 \\end{pmatrix}\n$$\nThis vector provides the complete set of initial conditions $x_1(0)$, $x_2(0)$, and $x_3(0)$ required to start a numerical integration of the corresponding first-order system.", "answer": "$$\\boxed{\\begin{pmatrix} 2 & -1 & 3 \\end{pmatrix}}$$", "id": "3219214"}, {"introduction": "The standard conversion method is powerful, but it's not the only approach. This advanced exercise explores the famous pendulum equation to demonstrate how different choices of state variables can lead to different first-order systems. By comparing the standard representation with a trigonometric one, you will uncover the concept of a system invariantâ€”a conserved quantity that has profound implications for the long-term accuracy and stability of numerical solutions.", "problem": "A plane pendulum with dimensionless angle displacement modeled as an Ordinary Differential Equation (ODE) evolves according to $\\,\\theta'' + \\sin(\\theta) = 0\\,$, where $\\,\\theta = \\theta(t)\\,$ and $\\,t\\,$ is time. Your goal is to reformulate this second-order ODE as first-order systems using two different choices of state vector and then compare their structural implications for numerical methods.\n\nTasks:\n1) Introduce the angular velocity variable $\\,\\omega = \\theta'\\,$ and derive the equivalent first-order autonomous system in the state vector $\\,(\\theta,\\omega)\\,$. Use only fundamental differentiation rules (for example, the chain rule and product rule), and do not assume any pre-packaged formulas for state-space conversion.\n\n2) Consider the trigonometric embedding $\\,x = \\sin(\\theta)\\,$ and $\\,y = \\cos(\\theta)\\,$. Using only the chain rule and the given ODE, determine whether a closed two-dimensional autonomous system for $\\, (x,y) \\,$ exists. If it does not, identify the minimal augmentation needed to represent the pendulum dynamics as an autonomous first-order system in variables built from $\\,x\\,$ and $\\,y\\,$, and then derive the resulting autonomous system explicitly.\n\n3) For the autonomous system you derived in Task 2, define the constraint function $\\,C(x,y) = x^{2} + y^{2}\\,$. Compute its time derivative $\\,\\frac{d}{dt} C(x,y)\\,$ along the trajectories of your system. As your final answer, report the exact simplified expression for $\\,\\frac{d}{dt} C(x,y)\\,$. No rounding is required, and no units are needed for the final answer.\n\nYour exposition should be clear and logically justified from the fundamental differentiation rules and the given ODE. You may discuss structural properties (such as invariants or constraints) that are directly derived from these rules, but do not use any pre-formed state-space representations beyond what you derive.", "solution": "The governing Ordinary Differential Equation (ODE) for the plane pendulum is given as:\n$$\n\\theta'' + \\sin(\\theta) = 0\n$$\nwhere $\\theta = \\theta(t)$ is the angle as a function of time $t$, and $\\theta''$ denotes the second time derivative, $\\frac{d^2\\theta}{dt^2}$.\n\n**Task 1: Derivation of the first-order system in $(\\theta, \\omega)$**\n\nWe are asked to reformulate the second-order ODE into a system of first-order ODEs. Let the state vector be composed of the angle $\\theta$ and its time derivative, the angular velocity $\\omega$.\nWe define the state variables as:\n$$\nz_1(t) = \\theta(t)\n$$\n$$\nz_2(t) = \\omega(t) = \\theta'(t) = \\frac{d\\theta}{dt}\n$$\nOur goal is to find expressions for the time derivatives of these state variables, $z_1'$ and $z_2'$, in terms of $z_1$ and $z_2$ themselves.\n\nFirst, we compute the derivative of $z_1$:\n$$\nz_1' = \\frac{d}{dt}(\\theta) = \\theta'\n$$\nBy our definition of $z_2$, we have $\\theta' = z_2$. Therefore, the first equation of our system is:\n$$\nz_1' = z_2\n$$\nNext, we compute the derivative of $z_2$:\n$$\nz_2' = \\frac{d}{dt}(\\omega) = \\frac{d}{dt}(\\theta') = \\theta''\n$$\nThe original second-order ODE, $\\theta'' + \\sin(\\theta) = 0$, can be rearranged to solve for $\\theta''$:\n$$\n\\theta'' = -\\sin(\\theta)\n$$\nSubstituting our state variable definitions, $\\theta = z_1$, we get:\n$$\n\\theta'' = -\\sin(z_1)\n$$\nThus, the second equation of our system is:\n$$\nz_2' = -\\sin(z_1)\n$$\nCombining these two first-order equations, we obtain the autonomous system for the state vector $\\mathbf{z}(t) = (\\theta(t), \\omega(t))^T = (z_1(t), z_2(t))^T$:\n$$\n\\begin{cases}\nz_1' = z_2 \\\\\nz_2' = -\\sin(z_1)\n\\end{cases}\n$$\nIn vector form, if $\\mathbf{z} = \\begin{pmatrix} \\theta \\\\ \\omega \\end{pmatrix}$, then $\\mathbf{z}' = \\begin{pmatrix} \\omega \\\\ -\\sin(\\theta) \\end{pmatrix}$. This system is autonomous because the derivatives depend only on the state variables $\\theta$ and $\\omega$, not explicitly on time $t$. The state space is a cylinder, as the angle $\\theta$ is periodic.\n\n**Task 2: Derivation of the system with trigonometric embedding**\n\nWe are asked to consider an alternative state representation using the variables $x = \\sin(\\theta)$ and $y = \\cos(\\theta)$. We must determine if a closed, autonomous system for $(x, y)$ can be derived.\n\nLet's find the time derivatives of $x$ and $y$ using the chain rule.\nFor $x(t) = \\sin(\\theta(t))$:\n$$\n\\frac{dx}{dt} = \\frac{d}{dt}\\sin(\\theta(t)) = \\frac{d(\\sin(\\theta))}{d\\theta} \\frac{d\\theta}{dt} = \\cos(\\theta) \\cdot \\theta'\n$$\nUsing the definitions $y = \\cos(\\theta)$ and $\\omega = \\theta'$, we have:\n$$\nx' = y \\omega\n$$\nFor $y(t) = \\cos(\\theta(t))$:\n$$\n\\frac{dy}{dt} = \\frac{d}{dt}\\cos(\\theta(t)) = \\frac{d(\\cos(\\theta))}{d\\theta} \\frac{d\\theta}{dt} = -\\sin(\\theta) \\cdot \\theta'\n$$\nUsing the definitions $x = \\sin(\\theta)$ and $\\omega = \\theta'$, we have:\n$$\ny' = -x \\omega\n$$\nThe system for $(x, y)$ is:\n$$\n\\begin{cases}\nx' = y \\omega \\\\\ny' = -x \\omega\n\\end{cases}\n$$\nThese equations for $x'$ and $y'$ depend on a third variable, $\\omega = \\theta'$, which is not expressible solely in terms of $x$ and $y$. For example, $\\omega$ can take any real value, whereas $x$ and $y$ are constrained by $x^2 + y^2 = 1$. Therefore, a closed two-dimensional autonomous system for $(x, y)$ does not exist.\n\nTo create an autonomous system, we must perform a minimal augmentation by including $\\omega$ as a state variable. The state vector now becomes $(x, y, \\omega)$. We already have equations for $x'$ and $y'$, and we now need an equation for $\\omega'$.\nThe derivative of $\\omega$ is:\n$$\n\\omega' = \\frac{d}{dt}(\\theta') = \\theta''\n$$\nFrom the original pendulum equation, we know that $\\theta'' = -\\sin(\\theta)$. By our definition, $x = \\sin(\\theta)$. Substituting this into the expression for $\\omega'$ gives:\n$$\n\\omega' = -x\n$$\nThis equation depends only on the state variable $x$, so the system is now closed. The complete, autonomous first-order system in the state variables $(x, y, \\omega)$ is a three-dimensional system:\n$$\n\\begin{cases}\nx' = y \\omega \\\\\ny' = -x \\omega \\\\\n\\omega' = -x\n\\end{cases}\n$$\nThe structural implication for numerical methods is significant. This formulation introduces an algebraic constraint, $x^2 + y^2 = 1$, which must hold for all time $t$. Standard numerical integrators (like explicit Euler or Runge-Kutta methods) do not automatically preserve such invariants. Over many time steps, numerical errors can accumulate, causing the solution to drift away from the constraint surface (a cylinder in the $(x, y, \\omega)$ space), leading to a physically meaningless result where $\\sin^2(\\theta) + \\cos^2(\\theta) \\neq 1$. This formulation is thus a good model for testing and demonstrating the value of geometric integrators or projection methods, which are specifically designed to preserve such geometric or algebraic structures.\n\n**Task 3: Computation of the time derivative of the constraint**\n\nWe are given the constraint function $C(x, y) = x^2 + y^2$. We need to compute its total time derivative, $\\frac{dC}{dt}$, along the trajectories of the autonomous system derived in Task 2.\n\nUsing the chain rule for multivariable functions, the total time derivative of $C(x(t), y(t))$ is:\n$$\n\\frac{dC}{dt} = \\frac{\\partial C}{\\partial x} \\frac{dx}{dt} + \\frac{\\partial C}{\\partial y} \\frac{dy}{dt}\n$$\nFirst, we find the partial derivatives of $C$:\n$$\n\\frac{\\partial C}{\\partial x} = \\frac{\\partial}{\\partial x}(x^2 + y^2) = 2x\n$$\n$$\n\\frac{\\partial C}{\\partial y} = \\frac{\\partial}{\\partial y}(x^2 + y^2) = 2y\n$$\nNext, we substitute these partial derivatives and the expressions for $x' = y\\omega$ and $y' = -x\\omega$ from our $3$-dimensional system into the equation for $\\frac{dC}{dt}$:\n$$\n\\frac{dC}{dt} = (2x)(y\\omega) + (2y)(-x\\omega)\n$$\nSimplifying the expression:\n$$\n\\frac{dC}{dt} = 2xy\\omega - 2xy\\omega\n$$\nThis simplifies to:\n$$\n\\frac{dC}{dt} = 0\n$$\nThe result that $\\frac{dC}{dt} = 0$ confirms that $C(x, y) = x^2 + y^2$ is a constant of motion, or an invariant, for the system. This is expected, as $x^2 + y^2 = \\sin^2(\\theta) + \\cos^2(\\theta)$, which must always equal $1$. The dynamics are thus confined to the surface of a cylinder defined by $x^2 + y^2 = 1$ in the state space of $(x, y, \\omega)$.\nThe final answer is the exact simplified expression for $\\frac{d}{dt} C(x,y)$, which is $0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "3219211"}]}