{"hands_on_practices": [{"introduction": "This first exercise introduces the fundamental mechanism of a predictor-corrector method in its simplest form. We will use the explicit Euler method as a 'predictor' to make an initial guess for the solution at the next step, and then use the implicit Trapezoidal rule as a 'corrector' to refine this guess. This practice [@problem_id:2194236] provides a concrete, step-by-step walkthrough of the predict-evaluate-correct cycle that is central to this family of numerical techniques.", "problem": "Consider the initial value problem defined by the ordinary differential equation:\n$$ y' = x^2 - y^2 $$\nwith the initial condition $y(0) = 1$.\n\nYour task is to approximate the value of $y(0.1)$ by performing a single step of the Euler predictor-trapezoidal corrector method. Use a step size of $h=0.1$.\n\nRound your final answer to four significant figures.", "solution": "We define the differential equation as $y' = f(x,y)$ with $f(x,y) = x^{2} - y^{2}$ and initial condition $y(0) = 1$. Let $h = 0.1$, $x_{0} = 0$, and $x_{1} = x_{0} + h = 0.1$.\n\nThe Euler predictor is given by\n$$\ny_{1}^{(p)} = y_{0} + h\\,f(x_{0},y_{0}).\n$$\nCompute\n$$\nf(x_{0},y_{0}) = f(0,1) = 0^{2} - 1^{2} = -1,\n$$\nso\n$$\ny_{1}^{(p)} = 1 + 0.1(-1) = 0.9.\n$$\n\nThe trapezoidal corrector (one correction using the predictor) is\n$$\ny_{1} = y_{0} + \\frac{h}{2}\\left[f(x_{0},y_{0}) + f(x_{1},y_{1}^{(p)})\\right].\n$$\nEvaluate\n$$\nf(x_{1},y_{1}^{(p)}) = f(0.1,0.9) = (0.1)^{2} - (0.9)^{2} = 0.01 - 0.81 = -0.8.\n$$\nThus\n$$\ny_{1} = 1 + \\frac{0.1}{2}\\left[(-1) + (-0.8)\\right] = 1 + 0.05(-1.8) = 1 - 0.09 = 0.91.\n$$\n\nRounding to four significant figures gives $0.9100$.", "answer": "$$\\boxed{0.9100}$$", "id": "2194236"}, {"introduction": "While single-step predictors are intuitive, greater accuracy can often be achieved by incorporating information from several preceding steps. This exercise [@problem_id:2194665] demonstrates a complete, multi-step predictor-corrector scheme using the popular Adams-Bashforth method for the prediction and the Adams-Moulton method for the correction. By carrying out the calculation over multiple time steps, you will gain hands-on experience with the data management required for these powerful techniques.", "problem": "An engineer is numerically solving the initial value problem for a system whose behavior is described by the ordinary differential equation:\n$$\n\\frac{dy}{dt} = y - t^2 + 1\n$$\nwith the initial condition $y(0) = 0.5$.\n\nThe solution is advanced in time using a 2-step Predictor-Corrector method with a fixed step size of $h=0.2$. At each step from $y_n$ to $y_{n+1}$, the algorithm proceeds as follows:\n\n1.  **Predict:** An estimate for $y_{n+1}$, denoted $y_{n+1}^p$, is calculated using the 2-step Adams-Bashforth formula:\n    $$\n    y_{n+1}^p = y_n + \\frac{h}{2} \\left( 3f_n - f_{n-1} \\right)\n    $$\n2.  **Evaluate:** The function $f$ is evaluated using the predicted value: $f_{n+1}^p = f(t_{n+1}, y_{n+1}^p)$.\n3.  **Correct:** The final value for $y_{n+1}$ is calculated using the 2-step Adams-Moulton formula with the predicted value:\n    $$\n    y_{n+1} = y_n + \\frac{h}{2} \\left( f_{n+1}^p + f_n \\right)\n    $$\n\nIn these formulas, $t_k = k \\cdot h$ and $f_k = f(t_k, y_k)$. To execute a step from $t_n$ to $t_{n+1}$, the algorithm requires the two most recent function evaluations from its history, specifically $f_n$ and $f_{n-1}$. After a complete step (prediction and correction) yields the final value $y_{n+1}$, the new function value $f_{n+1} = f(t_{n+1}, y_{n+1})$ is computed and the history is updated for the next iteration.\n\nBeing a multistep method, it requires starting values. We are given $y_0 = y(0) = 0.5$. The value for the first step, $y_1 = y(0.2)$, has been pre-computed using a more accurate single-step method, yielding $y_1 = 0.8293$.\n\nUsing this scheme, calculate the numerical approximation for $y(0.6)$. Round your final answer to four significant figures.", "solution": "We are given the initial value problem $y' = f(t,y) = y - t^{2} + 1$ with $h=0.2$, $y_{0}=0.5$, and $y_{1}=0.8293$. The two-step predictor-corrector uses:\n- Predictor (Adams-Bashforth 2):\n$$\ny_{n+1}^{p} = y_{n} + \\frac{h}{2}\\left(3f_{n} - f_{n-1}\\right)\n$$\n- Corrector (Adams-Moulton 2 with predicted $f_{n+1}^{p}$):\n$$\ny_{n+1} = y_{n} + \\frac{h}{2}\\left(f_{n+1}^{p} + f_{n}\\right)\n$$\nwith $t_{k} = k h$ and $f_{k} = f(t_{k}, y_{k})$.\n\nCompute the starting function values:\n$$\nt_{0} = 0,\\quad y_{0} = 0.5,\\quad f_{0} = y_{0} - t_{0}^{2} + 1 = 0.5 + 1 = 1.5,\n$$\n$$\nt_{1} = 0.2,\\quad y_{1} = 0.8293,\\quad f_{1} = y_{1} - t_{1}^{2} + 1 = 0.8293 - 0.04 + 1 = 1.7893.\n$$\n\nStep from $t_{1}$ to $t_{2}=0.4$:\n- Predictor:\n$$\ny_{2}^{p} = y_{1} + \\frac{h}{2}\\left(3f_{1} - f_{0}\\right) = 0.8293 + 0.1\\left(3\\cdot 1.7893 - 1.5\\right) = 0.8293 + 0.38679 = 1.21609.\n$$\n- Evaluate:\n$$\nf_{2}^{p} = f(t_{2}, y_{2}^{p}) = y_{2}^{p} - t_{2}^{2} + 1 = 1.21609 - 0.16 + 1 = 2.05609.\n$$\n- Corrector:\n$$\ny_{2} = y_{1} + \\frac{h}{2}\\left(f_{2}^{p} + f_{1}\\right) = 0.8293 + 0.1\\left(2.05609 + 1.7893\\right) = 0.8293 + 0.384539 = 1.213839.\n$$\n- Update:\n$$\nf_{2} = f(t_{2}, y_{2}) = y_{2} - t_{2}^{2} + 1 = 1.213839 - 0.16 + 1 = 2.053839.\n$$\n\nStep from $t_{2}$ to $t_{3}=0.6$:\n- Predictor:\n$$\ny_{3}^{p} = y_{2} + \\frac{h}{2}\\left(3f_{2} - f_{1}\\right) = 1.213839 + 0.1\\left(3\\cdot 2.053839 - 1.7893\\right) = 1.213839 + 0.4372217 = 1.6510607.\n$$\n- Evaluate:\n$$\nf_{3}^{p} = f(t_{3}, y_{3}^{p}) = y_{3}^{p} - t_{3}^{2} + 1 = 1.6510607 - 0.36 + 1 = 2.2910607.\n$$\n- Corrector:\n$$\ny_{3} = y_{2} + \\frac{h}{2}\\left(f_{3}^{p} + f_{2}\\right) = 1.213839 + 0.1\\left(2.2910607 + 2.053839\\right) = 1.213839 + 0.43448997 = 1.64832897.\n$$\n\nThus, the numerical approximation at $t=0.6$ is $y(0.6) \\approx 1.64832897$. Rounding to four significant figures gives $1.648$.", "answer": "$$\\boxed{1.648}$$", "id": "2194665"}, {"introduction": "A crucial test for any numerical method in physics is not just its short-term accuracy, but its ability to respect the fundamental conservation laws of the system it models. This practice [@problem_id:2194239] challenges you to analyze the energy conservation properties of the Euler-Trapezoid predictor-corrector method when applied to a simple harmonic oscillator. By deriving the change in energy over a single step, you will uncover a key characteristic of this method and gain insight into the long-term fidelity of numerical simulations.", "problem": "In computational physics, a critical test for any numerical integration algorithm is its ability to respect the conservation laws of the continuous physical system it aims to model. Consider the simple harmonic oscillator, a fundamental model in physics, described by the second-order differential equation $\\frac{d^2x}{dt^2} = -x$. This can be expressed as a system of two first-order ordinary differential equations:\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -x\n$$\nwhere $x$ is the position and $v$ is the velocity. For this continuous system, the total energy, defined as $E = \\frac{1}{2}(v^2 + x^2)$, is a conserved quantity.\n\nWe wish to investigate the energy conservation properties of a specific numerical method, the Euler-Trapezoid predictor-corrector method. To advance the solution from a time $t_n$ to $t_{n+1} = t_n + h$, where $h$ is the step size, the method proceeds in two stages:\n\n1.  **Predictor Stage**: First, an intermediate, predicted state $(\\tilde{x}_{n+1}, \\tilde{v}_{n+1})$ is calculated using a single forward Euler step from the state $(x_n, v_n)$:\n    $$\n    \\tilde{x}_{n+1} = x_n + h \\cdot v_n\n    $$\n    $$\n    \\tilde{v}_{n+1} = v_n + h \\cdot (-x_n)\n    $$\n2.  **Corrector Stage**: The final state $(x_{n+1}, v_{n+1})$ is then computed by applying the trapezoidal rule, which averages the derivative at the beginning of the step, $(v_n, -x_n)$, and the derivative at the predicted end of the step, $(\\tilde{v}_{n+1}, -\\tilde{x}_{n+1})$:\n    $$\n    x_{n+1} = x_n + \\frac{h}{2}(v_n + \\tilde{v}_{n+1})\n    $$\n    $$\n    v_{n+1} = v_n + \\frac{h}{2}(-x_n - \\tilde{x}_{n+1})\n    $$\n\nLet $E_n = \\frac{1}{2}(v_n^2 + x_n^2)$ be the numerical energy of the system at step $n$. After a single step of this predictor-corrector method with step size $h$, the energy will change to $E_{n+1} = \\frac{1}{2}(v_{n+1}^2 + x_{n+1}^2)$.\n\nAssuming the initial state $(x_n, v_n)$ is not the origin, determine the ratio of the energy after one step to the initial energy, $E_{n+1}/E_n$, as a function of the step size $h$.", "solution": "We start from the given predictor-corrector scheme for the system $x' = v$, $v' = -x$.\n\nPredictor stage:\n$$\n\\tilde{x}_{n+1} = x_{n} + h v_{n}, \\qquad \\tilde{v}_{n+1} = v_{n} - h x_{n}.\n$$\n\nCorrector stage:\n$$\nx_{n+1} = x_{n} + \\frac{h}{2}\\left(v_{n} + \\tilde{v}_{n+1}\\right), \\qquad v_{n+1} = v_{n} + \\frac{h}{2}\\left(-x_{n} - \\tilde{x}_{n+1}\\right).\n$$\nSubstituting the predictor values into the corrector gives\n$$\nx_{n+1} = x_{n} + \\frac{h}{2}\\left(v_{n} + v_{n} - h x_{n}\\right) = \\left(1 - \\frac{h^{2}}{2}\\right)x_{n} + h v_{n},\n$$\n$$\nv_{n+1} = v_{n} + \\frac{h}{2}\\left(-x_{n} - (x_{n} + h v_{n})\\right) = -h x_{n} + \\left(1 - \\frac{h^{2}}{2}\\right)v_{n}.\n$$\n\nThus the one-step update can be written in matrix form as\n$$\n\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix}\n=\n\\underbrace{\\begin{pmatrix} 1 - \\frac{h^{2}}{2} & h \\\\ -h & 1 - \\frac{h^{2}}{2} \\end{pmatrix}}_{M}\n\\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}.\n$$\nLet $a = 1 - \\frac{h^{2}}{2}$ and $b = h$. Then $M = a I + b J$ with\n$$\nI = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\qquad J = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}.\n$$\nNote the properties $J^{T} = -J$ and $J^{2} = -I$. Compute\n$$\nM^{T}M = (a I - b J)(a I + b J) = a^{2} I - b^{2} J^{2} = (a^{2} + b^{2}) I.\n$$\nFor any state vector $w_{n} = \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$, this implies\n$$\nx_{n+1}^{2} + v_{n+1}^{2} = \\|w_{n+1}\\|^{2} = w_{n}^{T} M^{T} M w_{n} = (a^{2} + b^{2}) \\|w_{n}\\|^{2} = (a^{2} + b^{2})(x_{n}^{2} + v_{n}^{2}).\n$$\nWith $E_{n} = \\frac{1}{2}(x_{n}^{2} + v_{n}^{2})$, we get\n$$\n\\frac{E_{n+1}}{E_{n}} = \\frac{\\frac{1}{2}(x_{n+1}^{2} + v_{n+1}^{2})}{\\frac{1}{2}(x_{n}^{2} + v_{n}^{2})} = a^{2} + b^{2}.\n$$\nSubstituting $a = 1 - \\frac{h^{2}}{2}$ and $b = h$,\n$$\na^{2} + b^{2} = \\left(1 - \\frac{h^{2}}{2}\\right)^{2} + h^{2} = 1 - h^{2} + \\frac{h^{4}}{4} + h^{2} = 1 + \\frac{h^{4}}{4}.\n$$\nSince $(x_{n}, v_{n}) \\neq (0,0)$ by assumption, the ratio is well-defined and independent of the particular initial state.\n\nTherefore,\n$$\n\\frac{E_{n+1}}{E_{n}} = 1 + \\frac{h^{4}}{4}.\n$$", "answer": "$$\\boxed{1+\\frac{h^{4}}{4}}$$", "id": "2194239"}]}