{"hands_on_practices": [{"introduction": "This first practice grounds your understanding of the Composite Trapezoidal Rule by having you apply it to a standard integral. You will not only calculate the approximation but also confront the difference between the actual error and the theoretical error bound. This exercise is fundamental for developing an intuition for how well the theoretical guarantees of a numerical method reflect its real-world performance [@problem_id:2210486].", "problem": "A numerical analyst is studying the accuracy of the composite trapezoidal rule for approximating the definite integral $I = \\int_1^2 \\frac{1}{x} dx$. The approximation is performed using $n=4$ subintervals of equal width.\n\nThe exact value of the integral is known to be $I = \\ln(2)$. The theoretical error bound for the composite trapezoidal rule is given by the inequality $|E_T| \\le \\frac{M(b-a)^3}{12n^2}$, where $[a, b]$ is the interval of integration and $M$ is a constant such that $|f''(x)| \\le M$ for all $x$ in $[a, b]$.\n\nCalculate the difference between the theoretical maximum absolute error (the error bound, using the smallest possible value for $M$) and the actual absolute error of the approximation. For the purpose of this calculation, use the value $\\ln(2) \\approx 0.69314718$.\n\nExpress your final answer as a single real number rounded to six significant figures.", "solution": "We approximate $I=\\int_{1}^{2}\\frac{1}{x}\\,dx$ with the composite trapezoidal rule using $n=4$ subintervals. The step size is\n$$\nh=\\frac{b-a}{n}=\\frac{2-1}{4}=\\frac{1}{4}.\n$$\nThe nodes are $x_{0}=1$, $x_{1}=1+\\frac{1}{4}=\\frac{5}{4}$, $x_{2}=1+\\frac{2}{4}=\\frac{3}{2}$, $x_{3}=1+\\frac{3}{4}=\\frac{7}{4}$, $x_{4}=2$.\n\nThe composite trapezoidal approximation is\n$$\nT=\\frac{h}{2}\\left[f(x_{0})+2\\sum_{k=1}^{n-1}f(x_{k})+f(x_{n})\\right].\n$$\nWith $f(x)=\\frac{1}{x}$, we have\n$$\nf(x_{0})=1,\\quad f(x_{1})=\\frac{4}{5},\\quad f(x_{2})=\\frac{2}{3},\\quad f(x_{3})=\\frac{4}{7},\\quad f(x_{4})=\\frac{1}{2}.\n$$\nCompute the weighted sum:\n$$\nS=f(x_{0})+2\\big(f(x_{1})+f(x_{2})+f(x_{3})\\big)+f(x_{4})\n=1+2\\left(\\frac{4}{5}+\\frac{2}{3}+\\frac{4}{7}\\right)+\\frac{1}{2}.\n$$\nWith common denominator $105$ inside the parentheses,\n$$\n\\frac{4}{5}+\\frac{2}{3}+\\frac{4}{7}=\\frac{84+70+60}{105}=\\frac{214}{105},\n$$\nso\n$$\nS=1+2\\cdot\\frac{214}{105}+\\frac{1}{2}\n=1+\\frac{428}{105}+\\frac{1}{2}\n=\\frac{1171}{210}.\n$$\nThus\n$$\nT=\\frac{h}{2}S=\\frac{1/4}{2}\\cdot\\frac{1171}{210}=\\frac{1}{8}\\cdot\\frac{1171}{210}=\\frac{1171}{1680}.\n$$\n\nThe actual absolute error is\n$$\nE_{\\text{actual}}=\\left|\\,\\ln(2)-T\\,\\right|=\\left|\\;0.69314718-\\frac{1171}{1680}\\;\\right| \\approx |0.69314718 - 0.69702381| \\approx 0.00387663.\n$$\nSince the function $f(x)=1/x$ is concave up on $[1,2]$ (since $f''(x) = 2/x^3 > 0$), the trapezoidal rule overestimates the integral. The actual absolute error is\n$$\nE_{\\text{actual}} = T - \\ln(2) = \\frac{1171}{1680} - 0.69314718 \\approx 0.6970238095 - 0.69314718 = 0.0038766295.\n$$\n\nFor the trapezoidal rule error bound,\n$$\n|E_{T}|\\le \\frac{M(b-a)^{3}}{12n^{2}},\n$$\nwith $f''(x)=\\frac{2}{x^{3}}$, so on $[1,2]$ the smallest possible $M$ satisfying $|f''(x)|\\le M$ is $M=2$. With $b-a=1$ and $n=4$, we get\n$$\nE_{\\text{bound}}=\\frac{2\\cdot 1^{3}}{12\\cdot 4^{2}}=\\frac{2}{192}=\\frac{1}{96}\\approx 0.0104166667.\n$$\n\nThe requested difference (error bound minus actual absolute error) is\n$$\nD=E_{\\text{bound}}-E_{\\text{actual}} \\approx 0.0104166667 - 0.0038766295 \\approx 0.0065400372.\n$$\nRounding to six significant figures gives\n$$\nD\\approx 0.00654004.\n$$", "answer": "$$\\boxed{0.00654004}$$", "id": "2210486"}, {"introduction": "Building on the concept of error analysis, this problem shifts the focus from analyzing an existing approximation to planning a new one. You will determine the minimum number of subintervals needed to ensure the integration error stays within a specified tolerance, a crucial skill in scientific and engineering applications. This task highlights the practical utility of error bounds in designing efficient and reliable numerical computations [@problem_id:2210520].", "problem": "In a pharmacokinetic study, the concentration of a new drug in a patient's bloodstream is modeled as a function of time, $t$, by the equation $C(t) = C_0 \\exp(-kt^2)$. Here, $t$ is the time in hours after injection, $C_0 = 50$ mg/L is the initial concentration, and $k = 0.5 \\text{ hr}^{-2}$ is a constant related to the drug's elimination rate.\n\nTo assess the total drug exposure over the first two hours, a biomedical engineer needs to calculate the Area Under the Curve (AUC), which is given by the definite integral $A = \\int_{0}^{T} C(t) dt$ with $T=2$ hours.\n\nThe engineer uses a numerical approximation method. The time interval $[0, T]$ is divided into $n$ equal subintervals, and the value of the integral is approximated by summing the areas of the trapezoids formed by connecting the points $(t_i, C(t_i))$ and $(t_{i+1}, C(t_{i+1}))$ for each subinterval.\n\nFor this specific numerical method, the absolute error, $|E_n|$, is known to be bounded by the inequality:\n$$|E_n| \\le \\frac{M(T-0)^3}{12n^2}$$\nwhere $M$ is the maximum absolute value of the second derivative of the concentration function, $M = \\max_{t \\in [0, T]} |C''(t)|$.\n\nDetermine the minimum integer number of subintervals, $n$, that the engineer must use to guarantee that the absolute error in the calculated AUC is less than $10^{-3}$ mgÂ·hr/L.", "solution": "We are given $C(t) = C_{0}\\exp(-k t^{2})$ with $C_{0} = 50$ and $k = 0.5$, and we need to use the trapezoidal rule error bound\n$$|E_{n}| \\le \\frac{M(T-0)^{3}}{12 n^{2}},$$\nwhere $M = \\max_{t \\in [0,T]} |C''(t)|$ and $T=2$.\n\nFirst, we compute the second derivative of $C(t)$:\n$$C'(t) = C_{0} \\frac{d}{dt} \\exp(-k t^{2}) = C_0 \\exp(-kt^2)(-2kt) = -2kC_0 t \\exp(-kt^2).$$\n$$C''(t) = -2kC_0 \\left[ 1 \\cdot \\exp(-kt^2) + t \\cdot \\exp(-kt^2)(-2kt) \\right] = -2kC_0 \\exp(-kt^2)(1 - 2kt^2) = 2kC_0 (2kt^2 - 1)\\exp(-kt^2).$$\nWith $C_0 = 50$ and $k=0.5$, this simplifies to:\n$$C''(t) = 50(t^2 - 1)\\exp(-0.5t^2).$$\n\nNow, we need to find the maximum value of $|C''(t)|$ on the interval $[0, 2]$. Let $g(t) = C''(t)$. We find the maximum of $|g(t)|$ by checking the endpoints of the interval and the critical points where $g'(t)=0$.\n$$g'(t) = \\frac{d}{dt} \\left[ 50(t^2 - 1)\\exp(-0.5t^2) \\right] = 50 \\left[ 2t \\exp(-0.5t^2) + (t^2-1)\\exp(-0.5t^2)(-t) \\right]$$\n$$g'(t) = 50t \\exp(-0.5t^2) [2 - (t^2-1)] = 50t \\exp(-0.5t^2) (3 - t^2).$$\nThe critical points on $[0,2]$ are $t=0$ and $t=\\sqrt{3}$.\n\nNow we evaluate $|C''(t)|$ at the endpoints $t=0, t=2$ and the critical point $t=\\sqrt{3}$:\n-   At $t=0$: $|C''(0)| = |50(0^2 - 1)\\exp(0)| = |-50| = 50$.\n-   At $t=\\sqrt{3}$: $|C''(\\sqrt{3})| = |50(3-1)\\exp(-0.5 \\cdot 3)| = |100 \\exp(-1.5)| \\approx 22.31$.\n-   At $t=2$: $|C''(2)| = |50(2^2 - 1)\\exp(-0.5 \\cdot 4)| = |150 \\exp(-2)| \\approx 20.28$.\n\nThe maximum absolute value on the interval $[0, 2]$ is $M=50$.\n\nNow we use the error bound to find the required number of subintervals $n$:\n$$|E_{n}| \\le \\frac{M T^{3}}{12 n^{2}}  10^{-3}.$$\nSubstituting the values $M=50$ and $T=2$:\n$$\\frac{50 \\cdot 2^{3}}{12 n^{2}}  10^{-3} \\implies \\frac{400}{12 n^{2}}  10^{-3} \\implies \\frac{100}{3 n^{2}}  10^{-3}.$$\nNow, we solve for $n$:\n$$n^{2} > \\frac{100}{3 \\cdot 10^{-3}} = \\frac{100 \\cdot 10^3}{3} = \\frac{100000}{3} \\approx 33333.33.$$\n$$n > \\sqrt{\\frac{100000}{3}} \\approx \\sqrt{33333.33} \\approx 182.574.$$\nSince $n$ must be an integer, the minimum number of subintervals required is $n=183$.", "answer": "$$\\boxed{183}$$", "id": "2210520"}, {"introduction": "Our final practice introduces Richardson extrapolation, a powerful method for enhancing the accuracy of numerical approximations. By cleverly combining two trapezoidal rule estimates obtained with different numbers of subintervals, you can eliminate the leading error term and produce a superior result. This exercise reveals how understanding the systematic nature of the error in the trapezoidal rule allows for significant improvements in computational efficiency and accuracy [@problem_id:2210511].", "problem": "A research satellite is designed to measure a specific type of cosmic radiation as it passes through a planetary nebula. The measured radiation flux, $F(t)$, varies as a function of time $t$ according to the model:\n$$F(t) = F_0 \\exp\\left(-\\frac{t^2}{\\tau^2}\\right) \\cos(\\omega t)$$\nThe total energy per unit area received by the satellite's detector over an observation period, known as the fluence $\\Phi$, is given by the time integral of the flux.\n\nGiven the following parameters for the observation:\n-   Peak flux, $F_0 = 100.0 \\, \\text{J/(m}^2 \\cdot \\text{s)}$\n-   Characteristic time, $\\tau = 2.0 \\, \\text{s}$\n-   Angular frequency, $\\omega = 0.5 \\, \\text{rad/s}$\n\nYou are tasked with estimating the total fluence from $t=0$ s to $t=2.0$ s. To do this, first, compute two approximations for the integral using the composite trapezoidal rule: one with $n=2$ subintervals and another with $2n=4$ subintervals. Then, use these two approximations to perform a single step of Richardson extrapolation to find a more accurate value for the fluence.\n\nCalculate the final extrapolated value for the total fluence $\\Phi$. Express your answer in Joules per square meter (J/m$^2$), rounded to four significant figures.", "solution": "The fluence is the time integral of the flux over the observation window:\n$$\n\\Phi=\\int_{0}^{2}F(t)\\,dt=\\int_{0}^{2}F_{0}\\exp\\left(-\\frac{t^{2}}{\\tau^{2}}\\right)\\cos(\\omega t)\\,dt.\n$$\nUsing the composite trapezoidal rule with $n$ subintervals and step size $h=\\frac{b-a}{n}$,\n$$\nT_{n}=h\\left[\\frac{F(a)+F(b)}{2}+\\sum_{i=1}^{n-1}F(a+ih)\\right],\n$$\nwith $a=0$ and $b=2$.\n\nFor $n=2$, the step size is $h=(2-0)/2=1$, and the nodes are $t_{0}=0$, $t_{1}=1$, $t_{2}=2$. The flux function with the given parameters is:\n$$\nF(t)=100\\,\\exp\\left(-\\frac{t^{2}}{4}\\right)\\cos\\left(0.5\\,t\\right).\n$$\nWe evaluate the function at the nodes:\n$$\nF(0)=100\\,\\exp(0)\\cos(0) = 100\n$$\n$$\nF(1)=100\\,\\exp\\left(-\\frac{1}{4}\\right)\\cos\\left(0.5\\right)\\approx 68.3461986\n$$\n$$\nF(2)=100\\,\\exp(-1)\\cos(1)\\approx 19.8766110\n$$\nThe trapezoidal approximation for $n=2$ is:\n$$\nT_{2}=1 \\cdot \\left[\\frac{F(0)+F(2)}{2}+F(1)\\right] = \\frac{100+19.8766110}{2}+68.3461986 \\approx 59.9383055 + 68.3461986 = 128.2845041.\n$$\n\nFor $n=4$, the step size is $h=(2-0)/4=0.5$, and the nodes are $t=0, 0.5, 1.0, 1.5, 2.0$. We already have values for $t=0, 1, 2$. We need to evaluate the function at the new nodes:\n$$\nF(0.5)=100\\,\\exp\\left(-\\frac{(0.5)^{2}}{4}\\right)\\cos\\left(0.25\\right)\\approx 91.0208986\n$$\n$$\nF(1.5)=100\\,\\exp\\left(-\\frac{(1.5)^{2}}{4}\\right)\\cos\\left(0.75\\right)\\approx 41.6903751\n$$\nThe trapezoidal approximation for $n=4$ is:\n$$\nT_{4}=0.5 \\cdot \\left[\\frac{F(0)+F(2)}{2}+F(0.5)+F(1)+F(1.5)\\right]\n$$\n$$\nT_4 \\approx 0.5 \\cdot [59.9383055 + 91.0208986 + 68.3461986 + 41.6903751] = 0.5 \\cdot [260.9957778] = 130.4978889.\n$$\n\nFor the trapezoidal rule, the error has the form $I = T_n + C h^2 + O(h^4)$. Richardson extrapolation combines the two approximations, $T_2$ (with step $h=1$) and $T_4$ (with step $h/2=0.5$), to get a more accurate estimate, which is of order $O(h^4)$:\n$$\n\\Phi_{\\text{extrapolated}} = \\frac{4T_{4}-T_{2}}{3}.\n$$\nSubstituting the computed values:\n$$\n\\Phi_{\\text{extrapolated}} = \\frac{4\\cdot (130.4978889) - 128.2845041}{3} = \\frac{521.9915556 - 128.2845041}{3} = \\frac{393.7070515}{3} \\approx 131.2356838.\n$$\nRounding to four significant figures gives $131.2$ J/m$^2$.", "answer": "$$\\boxed{131.2}$$", "id": "2210511"}]}