{"hands_on_practices": [{"introduction": "To compare the effectiveness of different numerical integration techniques, we need a formal way to measure their inherent accuracy. The \"degree of precision\" serves as this fundamental metric, defining the highest degree of polynomial a method can integrate exactly. This first practice [@problem_id:2175007] introduces this concept by guiding you through the process of verifying the degree of precision for the one-point Gauss-Legendre rule, also known as the Midpoint Rule, providing a solid foundation for more complex methods.", "problem": "The degree of precision of a numerical quadrature rule is the largest integer $d$ such that the rule exactly computes the integral for all polynomials of degree up to and including $d$.\n\nConsider the one-point Gauss-Legendre quadrature rule, which approximates the definite integral of a function $f(x)$ over the interval $[-1, 1]$ using the formula:\n$$ \\int_{-1}^{1} f(x) \\,dx \\approx 2 f(0) $$\n\nTo determine the degree of precision for this rule, you must test its accuracy on monomials of the form $f(x) = x^k$ for non-negative integers $k = 0, 1, 2, \\ldots$. By identifying the highest value of $k$ for which the rule gives the exact result, you can determine the degree of precision.\n\nWhat is the degree of precision of the one-point Gauss-Legendre quadrature rule described above?\n\nA. 0\n\nB. 1\n\nC. 2\n\nD. 3", "solution": "We test the rule $Q(f)=2 f(0)$ on monomials $f(x)=x^k$ and compare with the exact integral over $[-1,1]$ to determine the largest integer $d$ such that the rule is exact for all polynomials of degree at most $d$.\n\nFor $k=0$ (constants): \nThe exact integral is $\\int_{-1}^{1} x^{0} \\, dx=\\int_{-1}^{1} 1 \\, dx=2$.\nThe quadrature gives $Q(x^0)=2 \\cdot 1=2$.\nThus it is exact for $k=0$.\n\nFor $k=1$ (linear):\nThe exact integral is $\\int_{-1}^{1} x \\, dx=0$.\nThe quadrature gives $Q(x)=2 \\cdot 0=0$.\nThus it is exact for $k=1$.\n\nFor $k=2$ (quadratic):\nThe exact integral is $\\int_{-1}^{1} x^{2} \\, dx=\\left.\\frac{x^{3}}{3}\\right|_{-1}^{1}=\\frac{2}{3}$.\nThe quadrature gives $Q(x^2)=2 \\cdot 0^2=0$.\nThus it is not exact for $k=2$.\n\nTherefore, the rule is exact for all polynomials of degree at most $1$ and fails for degree $2$. Hence, the degree of precision is $1$, which corresponds to option B. (Note: although the rule is also exact for all odd monomials due to symmetry and $f(0)=0$, the degree of precision requires exactness for all polynomials up to a given degree, and failure at $k=2$ limits the degree to $1$.)", "answer": "$$\\boxed{B}$$", "id": "2175007"}, {"introduction": "Building upon the foundational concept of precision, we now investigate a more powerful quadrature rule. While the Midpoint Rule is simple, more sophisticated methods achieve far greater accuracy by using strategically chosen nodes and weights. This exercise [@problem_id:2419560] challenges you to apply the same systematic testing procedure to a three-point rule, revealing the surprisingly high degree of precision that can be attained and reinforcing the link between a rule's design and its performance.", "problem": "An unknown $3$-point quadrature rule $Q[f]$ is specified for the integral $\\int_{-1}^{1} f(x)\\,dx$ by its nodes and weights:\n- Nodes: $x_{1}=-\\sqrt{\\dfrac{3}{5}}$, $x_{2}=0$, $x_{3}=+\\sqrt{\\dfrac{3}{5}}$.\n- Weights: $w_{1}=\\dfrac{5}{9}$, $w_{2}=\\dfrac{8}{9}$, $w_{3}=\\dfrac{5}{9}$.\n\nUsing only these nodes and weights, determine the polynomial degree of precision of this rule, i.e., the largest integer $m$ such that $Q[p]=\\int_{-1}^{1} p(x)\\,dx$ for every polynomial $p$ of degree at most $m$.\n\nChoose one:\n\nA. $3$\n\nB. $4$\n\nC. $5$\n\nD. $6$", "solution": "To determine the degree of precision, we test the quadrature rule $Q[f] = \\sum_{i=1}^{3} w_i f(x_i)$ on monomials $f(x) = x^k$ for $k=0, 1, 2, \\dots$ and find the largest integer $m$ for which the rule is exact for all $k \\le m$. The exact integral is $I[x^k] = \\int_{-1}^{1} x^k \\,dx$.\n\nThe quadrature approximation for $x^k$ is:\n$$ Q[x^k] = \\frac{5}{9} \\left(-\\sqrt{\\frac{3}{5}}\\right)^k + \\frac{8}{9} (0)^k + \\frac{5}{9} \\left(\\sqrt{\\frac{3}{5}}\\right)^k $$\n\n- **For $k=0$**: $I[1] = \\int_{-1}^{1} 1 \\,dx = 2$. The rule gives $Q[1] = \\frac{5}{9}(1) + \\frac{8}{9}(1) + \\frac{5}{9}(1) = \\frac{18}{9} = 2$. The rule is exact.\n\n- **For odd $k \\ge 1$**: The exact integral is $I[x^k]=0$. Since the nodes and weights are symmetric, for any odd function $f(x)$, $Q[f]=w_2 f(0)$. For $f(x)=x^k$ with odd $k$, $f(0)=0$, so $Q[x^k]=0$. The rule is exact for all odd degrees.\n\n- **For even $k \\ge 2$**: The exact integral is $I[x^k] = \\frac{2}{k+1}$. The rule simplifies to $Q[x^k] = 2 \\cdot \\frac{5}{9} \\left(\\sqrt{\\frac{3}{5}}\\right)^k = \\frac{10}{9} \\left(\\frac{3}{5}\\right)^{k/2}$.\n  - For $k=2$: $I[x^2] = \\frac{2}{3}$. $Q[x^2] = \\frac{10}{9} \\left(\\frac{3}{5}\\right) = \\frac{2}{3}$. Exact.\n  - For $k=4$: $I[x^4] = \\frac{2}{5}$. $Q[x^4] = \\frac{10}{9} \\left(\\frac{3}{5}\\right)^2 = \\frac{10}{9} \\cdot \\frac{9}{25} = \\frac{2}{5}$. Exact.\n  - For $k=6$: $I[x^6] = \\frac{2}{7}$. $Q[x^6] = \\frac{10}{9} \\left(\\frac{3}{5}\\right)^3 = \\frac{10}{9} \\cdot \\frac{27}{125} = \\frac{6}{25}$. Not exact.\n\nThe rule is exact for all polynomials of degree up to and including 5, but not for degree 6. Therefore, the degree of precision is 5.", "answer": "$$\\boxed{C}$$", "id": "2419560"}, {"introduction": "The theoretical accuracy of a numerical method, such as its degree of precision, is only part of the story in practical computation. Real-world applications are constrained by the finite precision of computers, which introduces round-off error. This final practice [@problem_id:3222056] shifts our focus to this crucial trade-off, exploring how to balance a method's intrinsic truncation error against computational round-off error to achieve the most accurate result possible. Although this example uses numerical differentiation, the principle of finding an optimal balance is a universal and essential skill in scientific computing.", "problem": "You are approximating the derivative of a smooth function $f$ at a point $x$ using the forward-difference formula $D(h) = \\frac{f(x+h) - f(x)}{h}$ computed in standard floating-point arithmetic with unit roundoff $u \\in (0,1)$. Assume that $f$ is at least twice continuously differentiable in a neighborhood of $x$, that $f''(x) \\neq 0$, and that $|f(x)| > 0$. Adopt the conventional floating-point model that each returned function value satisfies $\\widehat{f}(y) = f(y)\\,(1+\\delta)$ with $|\\delta| \\leq u$, independently for each evaluation.\n\nUsing Taylorâ€™s theorem for truncation error and the floating-point model above for round-off error, derive an explicit upper bound, as a function of the step size $h>0$, on the absolute error of $D(h)$ as an approximation to $f'(x)$. Then, by minimizing that bound with respect to $h$, determine the step size $h$ that balances truncation and round-off errors. Provide your final answer as a single closed-form expression in terms of $u$, $|f(x)|$, and $|f''(x)|$. Do not introduce any numerical values for these quantities, and do not assume any cancellations beyond what is justified by the assumptions stated. Your final answer must be a single analytic expression.", "solution": "The total error in the computed approximation, $\\widehat{D}(h)$, is the sum of truncation error and round-off error. We can bound this total error, $E(h)$, by analyzing each component separately.\n$$ E(h) = |\\widehat{D}(h) - f'(x)| \\le |D(h) - f'(x)| + |\\widehat{D}(h) - D(h)| = E_{\\text{trunc}}(h) + E_{\\text{round}}(h) $$\n\n**1. Truncation Error ($E_{\\text{trunc}}$)**\nUsing Taylor's theorem for $f(x+h)$ around $x$, assuming $f \\in C^2$:\n$$ f(x+h) = f(x) + hf'(x) + \\frac{h^2}{2} f''(\\xi) \\quad \\text{for some } \\xi \\in (x, x+h) $$\nThe truncation error of the forward-difference formula is:\n$$ E_{\\text{trunc}}(h) = |D(h) - f'(x)| = \\left| \\frac{f(x+h) - f(x)}{h} - f'(x) \\right| = \\left| \\frac{h}{2} f''(\\xi) \\right| $$\nFor small $h$, we can approximate $f''(\\xi) \\approx f''(x)$, giving the leading-order error bound:\n$$ E_{\\text{trunc}}(h) \\approx \\frac{h}{2} |f''(x)| $$\n\n**2. Round-off Error ($E_{\\text{round}}$)**\nThe computed function values are $\\widehat{f}(y) = f(y)(1+\\delta)$ with $|\\delta| \\le u$. The computed difference is:\n$$ \\widehat{D}(h) = \\frac{\\widehat{f}(x+h) - \\widehat{f}(x)}{h} = \\frac{f(x+h)(1+\\delta_2) - f(x)(1+\\delta_1)}{h} $$\nThe round-off error is the difference between the computed and exact formulas:\n$$ E_{\\text{round}}(h) = |\\widehat{D}(h) - D(h)| = \\left| \\frac{f(x+h)\\delta_2 - f(x)\\delta_1}{h} \\right| \\le \\frac{|f(x+h)||\\delta_2| + |f(x)||\\delta_1|}{h} $$\nUsing $|\\delta_i| \\le u$ and approximating $|f(x+h)| \\approx |f(x)|$ for small $h$, we get the bound:\n$$ E_{\\text{round}}(h) \\le \\frac{u(|f(x)| + |f(x)|)}{h} = \\frac{2u|f(x)|}{h} $$\n\n**3. Optimal Step Size**\nThe total error bound is the sum of the two components:\n$$ E(h) \\approx \\frac{h}{2} |f''(x)| + \\frac{2u|f(x)|}{h} $$\nTo find the optimal step size $h$ that minimizes this bound, we differentiate with respect to $h$ and set the derivative to zero:\n$$ \\frac{dE}{dh} = \\frac{1}{2}|f''(x)| - \\frac{2u|f(x)|}{h^2} = 0 $$\nSolving for $h^2$:\n$$ \\frac{1}{2}|f''(x)| = \\frac{2u|f(x)|}{h^2} \\implies h^2 = \\frac{4u|f(x)|}{|f''(x)|} $$\nTaking the positive square root gives the optimal step size:\n$$ h_{\\text{opt}} = 2\\sqrt{\\frac{u|f(x)|}{|f''(x)|}} $$\nThis value balances the truncation error (which decreases with $h$) and the round-off error (which increases as $h$ decreases).", "answer": "$$ \\boxed{2\\sqrt{\\frac{u|f(x)|}{|f''(x)|}}} $$", "id": "3222056"}]}