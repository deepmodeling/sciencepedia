{"hands_on_practices": [{"introduction": "Having established the theoretical foundation of back substitution, our first hands-on practice focuses on mastering its mechanical execution. This exercise requires you to solve a 4x4 upper triangular system using exact fractional arithmetic, which removes the complexities of floating-point rounding errors. By working through this problem ([@problem_id:1029943]), you will solidify your understanding of the step-by-step procedure and develop precision in your calculations, a crucial first step before tackling more complex numerical scenarios.", "problem": "Solve the system of linear equations $ A \\mathbf{x} = \\mathbf{b} $ using back substitution, where $ A $ is a 4Ã—4 upper triangular matrix and $ \\mathbf{b} $ is a vector. The matrix and vector are given as:\n\n\n$$\nA = \\begin{pmatrix}\n2.5  1.25  -0.6  1.8 \\\\\n0  0.4  2.1  -1.2 \\\\\n0  0  3.3  0.9 \\\\\n0  0  0  1.5\n\\end{pmatrix}, \\quad \n\\mathbf{b} = \\begin{pmatrix}\n1.1 \\\\\n-0.5 \\\\\n2.4 \\\\\n0.6\n\\end{pmatrix}.\n$$\n\n\nPerform all computations exactly using fractional arithmetic. Express the solution vector $ \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} $ in simplified fractional form.", "solution": "We rewrite the system by expressing decimals as fractions:\n$$\\begin{cases}\n\\frac52x_1+\\frac54x_2-\\frac35x_3+\\frac95x_4=\\frac{11}{10},\\\\\n\\frac25x_2+\\frac{21}{10}x_3-\\frac65x_4=-\\frac12,\\\\\n\\frac{33}{10}x_3+\\frac{9}{10}x_4=\\frac{12}{5},\\\\\n\\frac32x_4=\\frac35.\n\\end{cases}$$\n\n1. From the fourth equation:\n$$\\frac32x_4=\\frac35\\;\\Longrightarrow\\;\nx_4=\\frac{\\frac35}{\\frac32}=\\frac35\\cdot\\frac23=\\frac25.$$\n\n2. Third equation:\n$$\\frac{33}{10}x_3+\\frac{9}{10}\\cdot\\frac25=\\frac{12}{5}\n\\;\\Longrightarrow\\;\\frac{33}{10}x_3=\\frac{12}{5}-\\frac{18}{50}\n=\\frac{120-18}{50}=\\frac{102}{50}=\\frac{51}{25},$$\n$$x_3=\\frac{\\tfrac{51}{25}}{\\tfrac{33}{10}}\n=\\frac{51}{25}\\cdot\\frac{10}{33}=\\frac{510}{825}=\\frac{34}{55}.$$\n\n3. Second equation:\n$$\\frac25x_2+\\frac{21}{10}\\cdot\\frac{34}{55}-\\frac{6}{5}\\cdot\\frac25=-\\frac12\n\\;\\Longrightarrow\\;\\frac25x_2=-\\frac12-\\frac{357}{275}+\\frac{12}{25}\n=-\\frac{725}{550}=-\\frac{29}{22},$$\n$$x_2=-\\frac{29}{22}\\cdot\\frac52=-\\frac{145}{44}.$$\n\n4. First equation:\n$$\\frac52x_1+\\frac54\\Bigl(-\\frac{145}{44}\\Bigr)-\\frac35\\cdot\\frac{34}{55}\n+\\frac95\\cdot\\frac25=\\frac{11}{10},$$\n$$\\frac52x_1=\\frac{11}{10}+\\frac{725}{176}+\\frac{102}{275}-\\frac{18}{25}\n=\\frac{21429}{4400},$$\n$$x_1=\\frac{21429}{4400}\\cdot\\frac25=\\frac{21429}{11000}.$$\n\nHence\n$$\\mathbf{x}=\\begin{pmatrix}\\frac{21429}{11000}\\\\-\\frac{145}{44}\\\\\\frac{34}{55}\\\\\\frac25\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{21429}{11000}\\\\-\\frac{145}{44}\\\\\\frac{34}{55}\\\\\\frac25\\end{pmatrix}}$$", "id": "1029943"}, {"introduction": "While exact arithmetic is perfect for learning an algorithm, real-world scientific computing relies on finite-precision floating-point numbers. This practice serves as a critical thought experiment to demonstrate the potential pitfalls of this reality. You will explore a specially constructed system ([@problem_id:3285335]) where standard single-precision arithmetic leads to a dramatically incorrect result due to catastrophic cancellation, highlighting that numerical stability is just as important as algorithmic correctness.", "problem": "Consider solving an upper triangular linear system by the standard back substitution algorithm, starting at the last equation and proceeding upward. Let\n$$\nU = \\begin{pmatrix}\n10^{-8}  10^{8}  10^{8}  10^{8} \\\\\n0  1  10^{8}  10^{8} \\\\\n0  0  1  10^{8} \\\\\n0  0  0  1\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}\n3\\times 10^{8} + 10^{-8} \\\\\n2\\times 10^{8} + 1 \\\\\n10^{8} + 1 \\\\\n1\n\\end{pmatrix}.\n$$\nThe back substitution algorithm uses only additions, subtractions, and multiplications/divisions on these entries.\n\nYou will execute back substitution in two models of arithmetic:\n1. Exact real arithmetic for conceptual ground truth.\n2. Floating-point arithmetic as specified by the Institute of Electrical and Electronics Engineers (IEEE) 754 standard single precision (binary32), with rounding to nearest, ties to even, and the usual normalized finite format. Assume each literal decimal constant provided for the entries of $U$ and $b$ is stored as the nearest binary32 representable value before any arithmetic, and that every subsequent arithmetic operation is performed in binary32 with rounding to nearest.\n\nTasks:\n- Using exact real arithmetic, determine the exact solution and explain which structural features of $U$ and $b$ make the computation of $x_1$ sensitive to cancellation.\n- Then, perform the back substitution in IEEE 754 single precision (binary32) as described, and determine the value returned for $x_1$, explicitly invoking the scale of the spacing between adjacent floating-point numbers (unit in the last place) near the magnitudes encountered to justify each rounding event that causes cancellation or loss of significance.\n\nAnswer specification:\n- Report the computed IEEE 754 single precision value of $x_1$ as a single real number in scientific notation.\n- Round your final reported number to four significant figures.", "solution": "### Exact Arithmetic Solution\nUsing exact real arithmetic, we perform back substitution on the system $Ux=b$:\n1. $x_4 = b_4 / u_{44} = 1/1 = 1$.\n2. $x_3 = (b_3 - u_{34}x_4)/u_{33} = ((10^8 + 1) - 10^8(1))/1 = 1$.\n3. $x_2 = (b_2 - u_{23}x_3 - u_{24}x_4)/u_{22} = ((2\\times 10^8 + 1) - 10^8(1) - 10^8(1))/1 = 1$.\n4. $x_1 = (b_1 - u_{12}x_2 - u_{13}x_3 - u_{14}x_4)/u_{11} = ((3\\times 10^8 + 10^{-8}) - 10^8(1) - 10^8(1) - 10^8(1))/10^{-8} = (10^{-8}) / 10^{-8} = 1$.\n\nThe exact solution is $\\mathbf{x} = (1, 1, 1, 1)^T$. The computation of $x_1$ involves the subtraction of two large, nearly equal numbers: $(3 \\times 10^8 + 10^{-8}) - 3 \\times 10^8$. This phenomenon, known as **catastrophic cancellation**, makes the calculation extremely sensitive to rounding errors. This sensitivity is further amplified by division by the very small diagonal element $u_{11} = 10^{-8}$.\n\n### IEEE 754 Single Precision Solution\nIn IEEE 754 single precision (binary32), numbers have about 7-8 decimal digits of precision. The outcome is dominated by rounding errors that occur before and during the computation.\n\n**1. Initial Rounding of `b`:**\nThe right-hand side vector $b$ must first be stored as single-precision values.\n- For $b_3 = 10^8 + 1$: The unit in the last place (ulp) for numbers of magnitude $10^8$ is $2^{\\lfloor\\log_2(10^8)\\rfloor - 23} = 2^{26-23} = 2^3 = 8$. Since the increment `1` is less than half an ulp, $10^8+1$ rounds to $10^8$. So, $\\text{fl}(b_3) = 10^8$.\n- For $b_2 = 2 \\times 10^8 + 1$: The ulp for numbers of magnitude $2 \\times 10^8$ is $2^{\\lfloor\\log_2(2\\times 10^8)\\rfloor - 23} = 2^{27-23} = 2^4 = 16$. The increment `1` is less than half an ulp, so $\\text{fl}(b_2) = 2 \\times 10^8$.\n- For $b_1 = 3 \\times 10^8 + 10^{-8}$: The ulp for numbers of magnitude $3 \\times 10^8$ is $2^5=32$. The increment $10^{-8}$ is negligible, so $\\text{fl}(b_1) = 3 \\times 10^8$.\n\nThe system effectively being solved in floating-point arithmetic is $Ux_f = b_f$, where $b_f = (3\\times 10^8, 2\\times 10^8, 10^8, 1)^T$.\n\n**2. Floating-Point Back Substitution:**\nLet $\\oplus, \\ominus, \\otimes, \\oslash$ denote floating-point operations.\n- $x_{f,4} = 1 \\oslash 1 = 1$.\n- $x_{f,3} = (\\text{fl}(b_3) \\ominus u_{34} \\otimes x_{f,4}) \\oslash 1 = (10^8 \\ominus 10^8 \\otimes 1) = 0$. The initial rounding of $b_3$ causes the computed $x_{f,3}$ to be zero instead of one.\n- $x_{f,2} = (\\text{fl}(b_2) \\ominus (u_{23} \\otimes x_{f,3} \\oplus u_{24} \\otimes x_{f,4})) \\oslash 1 = (2\\times 10^8 \\ominus (10^8 \\otimes 0 \\oplus 10^8 \\otimes 1)) = 2\\times 10^8 \\ominus 10^8 = 10^8$. The error from $x_{f,3}$ propagates, causing $x_{f,2}$ to be $10^8$ instead of one.\n- $x_{f,1} = (\\text{fl}(b_1) \\ominus (u_{12} \\otimes x_{f,2} \\oplus u_{13} \\otimes x_{f,3} \\oplus u_{14} \\otimes x_{f,4})) \\oslash u_{11}$.\n  - The sum inside the parenthesis is $S_f = 10^8 \\otimes 10^8 \\oplus 10^8 \\otimes 0 \\oplus 10^8 \\otimes 1 = \\text{fl}(10^{16}) \\oplus 10^8$.\n  - The ulp of numbers with magnitude $10^{16}$ is approximately $10^9$. Since $10^8$ is smaller than half of this ulp, it is lost in the addition due to **swamping**. So, $S_f = \\text{fl}(10^{16})$.\n  - The numerator becomes $N_f = \\text{fl}(b_1) \\ominus S_f = 3\\times 10^8 \\ominus \\text{fl}(10^{16})$. Again, due to swamping, this results in $N_f = -\\text{fl}(10^{16})$.\n  - Finally, $x_{f,1} = (-\\text{fl}(10^{16})) \\oslash \\text{fl}(10^{-8}) \\approx -10^{16} / 10^{-8} = -10^{24}$.\n\nThe computed value for $x_1$ in single precision is approximately $-1.000 \\times 10^{24}$, a result that is dramatically different from the true solution of $1$.", "answer": "$$\n\\boxed{-1.000 \\times 10^{24}}\n$$", "id": "3285335"}, {"introduction": "Many problems in science and engineering do not appear in perfect textbook form but often possess a \"nearly\" simple structure. This exercise challenges you to adapt the back substitution algorithm for a matrix that is upper triangular except for a single non-zero element in its bottom-left corner. By deriving a solution based on the Sherman-Morrison formula ([@problem_id:3285181]), you will practice a powerful technique: leveraging a known algorithm to efficiently solve a perturbed version of the original problem, a common and valuable skill in computational science.", "problem": "Consider the linear system $A \\mathbf{x} = \\mathbf{b}$, where $A \\in \\mathbb{R}^{n \\times n}$ is upper triangular except for a single non-zero entry in the bottom-left corner, so that $A_{ij} = 0$ for all $i  j$ except for $A_{n1} \\neq 0$. In the context of numerical methods and scientific computing, explain from first principles how to exploit this structure to solve the system efficiently using back substitution ideas rather than a full general-purpose algorithm such as Gaussian elimination. Your explanation must begin from the definition of an upper triangular system and the standard back substitution procedure, and then logically account for the effect of the lone subdiagonal perturbation.\n\nThen, apply your method to the specific $5 \\times 5$ system with\n$$\nA =\n\\begin{pmatrix}\n3  -1  2  0  1 \\\\\n0  2  1  -1  3 \\\\\n0  0  4  -2  1 \\\\\n0  0  0  5  2 \\\\\n-3  0  0  0  6\n\\end{pmatrix},\n\\qquad\n\\mathbf{b} =\n\\begin{pmatrix}\n7 \\\\ 4 \\\\ 5 \\\\ 1 \\\\ 2\n\\end{pmatrix}.\n$$\nCompute the value of $x_{1}$ for the unique solution $\\mathbf{x}$ of $A \\mathbf{x} = \\mathbf{b}$. Provide your answer as an exact value; no rounding is required. The final answer must be a single number (a real value).", "solution": "### General Solution Method\nA standard upper triangular system $U\\mathbf{x} = \\mathbf{c}$ can be solved efficiently using back substitution in $O(n^2)$ time. The given matrix $A$ is not upper triangular due to the single non-zero entry $A_{n1}$. This structure can be exploited by representing $A$ as a rank-1 update to an upper triangular matrix.\n\nLet $U$ be the upper triangular matrix obtained by setting the $(n,1)$ entry of $A$ to zero. Let $\\mathbf{e}_1$ and $\\mathbf{e}_n$ be the standard basis vectors. Then we can write $A$ as:\n$$A = U + A_{n1} \\mathbf{e}_n \\mathbf{e}_1^T$$\nThe linear system $A\\mathbf{x} = \\mathbf{b}$ becomes:\n$$(U + A_{n1} \\mathbf{e}_n \\mathbf{e}_1^T)\\mathbf{x} = \\mathbf{b}$$\nUsing the fact that $\\mathbf{e}_1^T \\mathbf{x} = x_1$, we have:\n$$U\\mathbf{x} + A_{n1}x_1 \\mathbf{e}_n = \\mathbf{b}$$\n$$U\\mathbf{x} = \\mathbf{b} - A_{n1}x_1 \\mathbf{e}_n$$\nAssuming $U$ is invertible, we can solve for $\\mathbf{x}$:\n$$\\mathbf{x} = U^{-1}(\\mathbf{b} - A_{n1}x_1 \\mathbf{e}_n) = U^{-1}\\mathbf{b} - A_{n1}x_1 (U^{-1}\\mathbf{e}_n)$$\nThis equation expresses the solution $\\mathbf{x}$ in terms of the unknown scalar $x_1$ and two vectors that can be computed efficiently. Let's define:\n1. $\\mathbf{y} = U^{-1}\\mathbf{b}$, which is the solution to the upper triangular system $U\\mathbf{y} = \\mathbf{b}$.\n2. $\\mathbf{z} = U^{-1}\\mathbf{e}_n$, which is the solution to the upper triangular system $U\\mathbf{z} = \\mathbf{e}_n$.\n\nBoth $\\mathbf{y}$ and $\\mathbf{z}$ can be found using back substitution. The solution $\\mathbf{x}$ is then:\n$$\\mathbf{x} = \\mathbf{y} - A_{n1}x_1 \\mathbf{z}$$\nTo find the unknown $x_1$, we extract the first component of this vector equation:\n$$x_1 = y_1 - A_{n1}x_1 z_1$$\nSolving this linear equation for $x_1$ gives:\n$$x_1(1 + A_{n1}z_1) = y_1 \\implies x_1 = \\frac{y_1}{1 + A_{n1}z_1}$$\nThis method requires solving two upper triangular systems (each $O(n^2)$) and performing a few scalar operations, yielding an efficient $O(n^2)$ algorithm.\n\n### Application to the Specific System\nFor the given $5 \\times 5$ system, we have $n=5$, $A_{51} = -3$, and the upper triangular matrix $U$ is:\n$$\nU =\n\\begin{pmatrix}\n3  -1  2  0  1 \\\\\n0  2  1  -1  3 \\\\\n0  0  4  -2  1 \\\\\n0  0  0  5  2 \\\\\n0  0  0  0  6\n\\end{pmatrix}\n$$\n**1. Solve $U\\mathbf{y} = \\mathbf{b}$ for $\\mathbf{y}$:** Using back substitution on $U\\mathbf{y} = (7, 4, 5, 1, 2)^T$, we only need to find $y_1$. This requires computing all components of $\\mathbf{y}$ from $y_5$ up to $y_1$.\n- $6y_5 = 2 \\implies y_5 = 1/3$.\n- $5y_4 + 2(1/3) = 1 \\implies 5y_4 = 1/3 \\implies y_4 = 1/15$.\n- $4y_3 - 2(1/15) + 1/3 = 5 \\implies 4y_3 = 5 + 2/15 - 1/3 = 24/5 \\implies y_3 = 6/5$.\n- $2y_2 + 6/5 - 1/15 + 3(1/3) = 4 \\implies 2y_2 = 3 - 17/15 = 28/15 \\implies y_2 = 14/15$.\n- $3y_1 - 14/15 + 2(6/5) + 1/3 = 7 \\implies 3y_1 = 7 + 14/15 - 12/5 - 1/3 = 26/5 \\implies y_1 = 26/15$.\n\n**2. Solve $U\\mathbf{z} = \\mathbf{e}_5$ for $\\mathbf{z}$:** Using back substitution on $U\\mathbf{z} = (0, 0, 0, 0, 1)^T$, we find $z_1$.\n- $6z_5 = 1 \\implies z_5 = 1/6$.\n- $5z_4 + 2(1/6) = 0 \\implies 5z_4 = -1/3 \\implies z_4 = -1/15$.\n- $4z_3 - 2(-1/15) + 1/6 = 0 \\implies 4z_3 = -2/15 - 1/6 = -9/30 \\implies z_3 = -3/40$.\n- $2z_2 - 3/40 - (-1/15) + 3(1/6) = 0 \\implies 2z_2 = 3/40 + 1/15 - 1/2 = -59/120 \\implies z_2 = -59/240$.\n- $3z_1 - (-59/240) + 2(-3/40) + 1/6 = 0 \\implies 3z_1 = -59/240 - 6/40 - 1/6 = (-59-36-40)/240 = -135/240 \\implies 3z_1 = -27/48 = -9/16$. Let's recheck this calculation carefully.\n$3z_1 = z_2 - 2z_3 - z_5 = -59/240 - 2(-3/40) - 1/6 = -59/240 + 6/40 - 1/6 = (-59 + 36 - 40)/240 = -63/240 = -21/80$.\nSo, $z_1 = -7/80$.\n\n**3. Compute $x_1$:**\nUsing the derived formula with $A_{51} = -3$, $y_1 = 26/15$, and $z_1 = -7/80$:\n$$x_1 = \\frac{y_1}{1 + A_{51}z_1} = \\frac{26/15}{1 + (-3)(-7/80)} = \\frac{26/15}{1 + 21/80} = \\frac{26/15}{(80+21)/80} = \\frac{26/15}{101/80}$$\n$$x_1 = \\frac{26}{15} \\cdot \\frac{80}{101} = \\frac{26}{3 \\cdot 5} \\cdot \\frac{16 \\cdot 5}{101} = \\frac{26 \\cdot 16}{3 \\cdot 101} = \\frac{416}{303}$$", "answer": "$$\\boxed{\\frac{416}{303}}$$", "id": "3285181"}]}