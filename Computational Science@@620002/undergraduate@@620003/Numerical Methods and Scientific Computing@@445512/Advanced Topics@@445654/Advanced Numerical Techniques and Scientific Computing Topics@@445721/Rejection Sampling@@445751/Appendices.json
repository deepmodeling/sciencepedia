{"hands_on_practices": [{"introduction": "To begin our hands-on exploration of rejection sampling, we will first focus on its efficiency. The effectiveness of this method is measured by the acceptance probability—the chance that a candidate sample from our proposal distribution is kept. This exercise [@problem_id:1387131] guides you through calculating this fundamental metric, demonstrating how the relationship between the target and proposal distributions determines the overall performance of the algorithm.", "problem": "A data scientist is implementing a rejection sampling algorithm to generate random numbers that follow a specific target distribution. The target distribution is a Beta distribution with parameters $\\alpha = 2$ and $\\beta = 2$. The probability density function (PDF) of this target distribution, denoted by $f(x)$, is given by:\n$$f(x) = 6x(1-x) \\quad \\text{for } x \\in [0, 1]$$\nand $f(x) = 0$ otherwise.\n\nFor the proposal distribution, the data scientist uses the standard uniform distribution, U(0, 1). The PDF of this proposal distribution, denoted by $g(x)$, is:\n$$g(x) = 1 \\quad \\text{for } x \\in [0, 1]$$\nand $g(x) = 0$ otherwise.\n\nThe rejection sampling method requires finding a constant $M$ such that the inequality $f(x) \\le M g(x)$ holds for all possible values of $x$. To maximize the efficiency of the sampling process, the smallest possible value of $M$ is chosen. The algorithm then generates a sample $Y$ from the proposal distribution $g(x)$ and accepts it with probability $\\frac{f(Y)}{M g(Y)}$.\n\nCalculate the overall theoretical probability that a sample drawn from the proposal distribution is accepted. Express your answer as an exact fraction.", "solution": "We need the smallest constant $M$ such that $f(x) \\le M g(x)$ for all $x$. Since $g(x)=1$ for $x \\in [0,1]$ and $g(x)=0$ otherwise, the condition reduces on $[0,1]$ to $f(x) \\le M$. Therefore the minimal admissible $M$ is the supremum of $f(x)$ on $[0,1]$.\n\nCompute the maximum of $f(x)=6x(1-x)=6(x - x^{2})$ on $[0,1]$. Differentiate:\n$$\nf'(x)=6(1-2x), \\quad f''(x)=-12.\n$$\nSetting $f'(x)=0$ gives $x=\\frac{1}{2}$. Since $f''(x)<0$, this is a maximum. Evaluate\n$$\nM=\\max_{x \\in [0,1]} f(x)=f\\!\\left(\\tfrac{1}{2}\\right)=6 \\cdot \\tfrac{1}{2} \\cdot \\left(1-\\tfrac{1}{2}\\right)=\\frac{3}{2}.\n$$\n\nGiven $Y \\sim g$, the acceptance probability conditional on $Y=y$ is $\\frac{f(y)}{M g(y)}$. The overall acceptance probability is the expectation under $g$:\n$$\n\\mathbb{P}(\\text{accept})=\\mathbb{E}_{g}\\!\\left[\\frac{f(Y)}{M g(Y)}\\right]=\\int_{0}^{1} \\frac{f(x)}{M g(x)} g(x) \\, dx=\\frac{1}{M} \\int_{0}^{1} f(x) \\, dx.\n$$\nSince $f$ is a probability density on $[0,1]$, $\\int_{0}^{1} f(x) \\, dx=1$. For completeness:\n$$\n\\int_{0}^{1} 6x(1-x)\\,dx=6 \\int_{0}^{1} \\left(x - x^{2}\\right) dx=6 \\left(\\frac{1}{2}-\\frac{1}{3}\\right)=1.\n$$\nTherefore,\n$$\n\\mathbb{P}(\\text{accept})=\\frac{1}{M}=\\frac{1}{\\frac{3}{2}}=\\frac{2}{3}.\n$$", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "1387131"}, {"introduction": "Having explored the theoretical efficiency, let's now walk through the mechanics of the rejection sampling process step-by-step. This problem [@problem_id:1387121] provides a concrete scenario with pre-generated random numbers, allowing you to simulate the algorithm by hand. By manually checking each proposal against the acceptance criterion, you will gain a practical, tangible understanding of how the combination of a proposed value and a random draw leads to an accepted sample from the target distribution.", "problem": "A quality control engineer is inspecting small batches of 3 items. Historical data suggests that any given item has a 50% chance of being defective, independently of other items. The number of defective items in a batch, let's call this random variable $X$, thus follows a Binomial distribution with parameters $n=3$ and $p=1/2$.\n\nTo simulate potential outcomes, the engineer uses a computational method known as rejection sampling. The process relies on a simpler \"proposal\" distribution to generate candidate values, which are then either accepted or rejected. For this task, the proposal distribution is a discrete uniform distribution over the set of possible outcomes $\\{0, 1, 2, 3\\}$.\n\nThe simulation proceeds in rounds. In each round, a candidate value is drawn from the proposal distribution, and a random number is drawn from a continuous uniform distribution on the interval $(0, 1)$. These two numbers are used in an acceptance test. If the test passes, the candidate value is accepted as a valid sample from the target Binomial distribution, and the simulation stops. If the test fails, the candidate value is rejected, and the process moves to the next round with new random numbers.\n\nSuppose the following two sequences of random numbers are generated for the simulation:\n-   Sequence of proposals from the discrete uniform distribution: `3, 0, 2, 1`\n-   Sequence of draws from the uniform distribution on $(0, 1)$: `0.85, 0.60, 0.90, 0.45`\n\nUsing these sequences, determine the first accepted value for the number of defective items.", "solution": "The target distribution is $X \\sim \\mathrm{Binomial}(n=3,p=\\frac{1}{2})$, so for $k \\in \\{0,1,2,3\\}$ the probability mass function is\n$$\np(k)=\\mathbb{P}(X=k)=\\binom{3}{k}\\left(\\frac{1}{2}\\right)^{k}\\left(\\frac{1}{2}\\right)^{3-k}=\\binom{3}{k}\\,2^{-3}.\n$$\nThus,\n$$\np(0)=\\frac{1}{8},\\quad p(1)=\\frac{3}{8},\\quad p(2)=\\frac{3}{8},\\quad p(3)=\\frac{1}{8}.\n$$\nThe proposal distribution is uniform on $\\{0,1,2,3\\}$, so $q(k)=\\frac{1}{4}$ for all $k$. The acceptance-rejection method uses a constant $c$ such that $p(k)\\leq c\\,q(k)$ for all $k$, i.e.\n$$\nc=\\sup_{k}\\frac{p(k)}{q(k)}=\\sup_{k}\\left(4\\,p(k)\\right)=\\max\\left\\{\\frac{1}{2},\\frac{3}{2},\\frac{3}{2},\\frac{1}{2}\\right\\}=\\frac{3}{2}.\n$$\nThe acceptance probability for a proposed value $k$ is\n$$\n\\alpha(k)=\\frac{p(k)}{c\\,q(k)}=\\frac{p(k)}{(\\frac{3}{2})(\\frac{1}{4})}=\\frac{8}{3}\\,p(k).\n$$\nTherefore,\n$$\n\\alpha(0)=\\alpha(3)=\\frac{8}{3}\\cdot\\frac{1}{8}=\\frac{1}{3},\\qquad \\alpha(1)=\\alpha(2)=\\frac{8}{3}\\cdot\\frac{3}{8}=1.\n$$\nProcess the given sequences:\n- Round 1: propose $k=3$, draw $u=0.85$. Since $u=0.85>\\alpha(3)=\\frac{1}{3}$, reject.\n- Round 2: propose $k=0$, draw $u=0.60$. Since $u=0.60>\\alpha(0)=\\frac{1}{3}$, reject.\n- Round 3: propose $k=2$, draw $u=0.90$. Since $u=0.90\\leq\\alpha(2)=1$, accept.\n\nHence, the first accepted value is $2$.", "answer": "$$\\boxed{2}$$", "id": "1387121"}, {"introduction": "Understanding the rules of an algorithm often involves seeing what happens when those rules are broken. This final practice problem [@problem_id:1387128] presents a hypothetical scenario where a crucial condition of rejection sampling—that $f(x) \\le M g(x)$ for all $x$—is violated. By analyzing the outcome of this flawed implementation, you will uncover why this condition is not just a mathematical formality but a strict requirement for generating samples from the correct target distribution, thereby deepening your conceptual grasp of the method.", "problem": "A data scientist is trying to generate random numbers from a target probability distribution whose Probability Density Function (PDF) is given by $f(x) = 2x$ for $x \\in [0, 1]$ and $f(x)=0$ otherwise. They decide to use the rejection sampling method.\n\nThe procedure is as follows:\n1. A candidate sample, $x^*$, is drawn from a uniform proposal distribution with PDF $g(x) = 1$ for $x \\in [0, 1]$ and $g(x)=0$ otherwise.\n2. A random number, $u$, is drawn from a uniform distribution on the interval $[0, 1]$.\n3. The candidate $x^*$ is accepted if the condition $u \\le \\frac{f(x^*)}{M g(x^*)}$ is met. Otherwise, it is rejected.\n\nHowever, the data scientist makes a mistake and sets the constant scaling factor to $M=1$. Despite this error, which violates a key assumption of the algorithm, the process still generates a set of accepted samples.\n\nDetermine the PDF, let's call it $h(x)$, of the distribution of these accepted samples. Your final answer should be expressed as a piecewise function of $x$.", "solution": "The target density is $f(x)=2x$ for $x\\in[0,1]$ and $0$ otherwise. The proposal is $g(x)=1$ for $x\\in[0,1]$ and $0$ otherwise. In rejection sampling, given a candidate $x$ drawn from $g$, the acceptance event is $\\{u\\leq f(x)/(M g(x))\\}$ with $u\\sim\\text{Uniform}[0,1]$ independent of $x$. Therefore, the acceptance probability conditional on $x$ is\n$$\na(x)=\\mathbb{P}\\!\\left(u\\leq \\frac{f(x)}{M g(x)}\\mid x\\right)=\\min\\!\\left(1,\\frac{f(x)}{M g(x)}\\right).\n$$\nWith the mistaken choice $M=1$, we have for $x\\in[0,1]$\n$$\na(x)=\\min\\!\\left(1,\\frac{2x}{1}\\right)=\\min(1,2x)=\\begin{cases}\n2x, & 0\\le x\\le \\frac{1}{2},\\\\\n1, & \\frac{1}{2}\\le x\\le 1,\n\\end{cases}\n$$\nand $a(x)=0$ for $x\\notin[0,1]$. The density of accepted samples is the conditional density of $x$ given acceptance:\n$$\nh(x)=\\frac{g(x)\\,a(x)}{\\int_{-\\infty}^{\\infty} g(t)\\,a(t)\\,dt}.\n$$\nSince $g(x)=1$ on $[0,1]$ and $0$ otherwise, the normalizing constant is\n$$\nZ=\\int_{0}^{1} a(t)\\,dt=\\int_{0}^{1/2} 2t\\,dt+\\int_{1/2}^{1} 1\\,dt=\\left[t^{2}\\right]_{0}^{1/2}+\\left[t\\right]_{1/2}^{1}=\\frac{1}{4}+\\frac{1}{2}=\\frac{3}{4}.\n$$\nThus, for $x\\in[0,1]$,\n$$\nh(x)=\\frac{a(x)}{Z}=\\frac{4}{3}\\,a(x)=\\begin{cases}\n\\frac{8}{3}\\,x, & 0\\le x\\le \\frac{1}{2},\\\\\n\\frac{4}{3}, & \\frac{1}{2}\\le x\\le 1,\n\\end{cases}\n$$\nand $h(x)=0$ for $x\\notin[0,1]$. This piecewise function integrates to $1$ and is the PDF of the accepted samples under the mistaken choice $M=1$.", "answer": "$$\\boxed{h(x)=\\begin{cases}\\frac{8}{3}\\,x,&0\\le x\\le \\frac{1}{2},\\\\[4pt]\\frac{4}{3},&\\frac{1}{2}\\le x\\le 1,\\\\[4pt]0,&\\text{otherwise.}\\end{cases}}$$", "id": "1387128"}]}