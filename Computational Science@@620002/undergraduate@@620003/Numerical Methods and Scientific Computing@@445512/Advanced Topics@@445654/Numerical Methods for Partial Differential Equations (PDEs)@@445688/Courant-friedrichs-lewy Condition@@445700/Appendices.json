{"hands_on_practices": [{"introduction": "The one-dimensional wave equation is a cornerstone of mathematical physics, describing phenomena from the vibrations of a guitar string to the propagation of signals in a cable. When we solve this equation numerically using explicit methods, we face a critical constraint: the time step $\\Delta t$ must be sufficiently small relative to the spatial grid spacing $\\Delta x$ to ensure a stable solution. This first exercise [@problem_id:2139541] provides fundamental practice in applying the Courant-Friedrichs-Lewy (CFL) condition to determine the maximum stable time step for a standard wave simulation.", "problem": "An engineer is developing a numerical simulation for voltage pulse propagation along a specialized coaxial cable. In a simplified one-dimensional model, the voltage $u(x, t)$ at position $x$ and time $t$ is governed by the wave equation:\n$$ \\frac{\\partial^2 u}{\\partial t^2} = 16 \\frac{\\partial^2 u}{\\partial x^2} $$\nwhere $x$ is in meters and $t$ is in seconds.\n\nThe engineer decides to use a standard explicit finite difference scheme to solve this equation numerically. The spatial grid for the simulation is set up with a uniform spacing of $\\Delta x = 0.05$ meters. To ensure the stability of the numerical solution, the time step $\\Delta t$ must be chosen carefully.\n\nWhat is the maximum possible time step $\\Delta t$ that can be used while satisfying the Courant-Friedrichs-Lewy (CFL) stability condition for this scheme? Express your answer in seconds, rounded to three significant figures.", "solution": "We start from the one-dimensional wave equation written in the standard form\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}=c^{2}\\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\nwhere, by comparison with the given equation $\\frac{\\partial^{2} u}{\\partial t^{2}}=16\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$, the wave speed is $c=4$.\n\nA standard explicit second-order finite difference discretization (centered in time and space) on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$ is\n$$\n\\frac{u_{j}^{n+1}-2u_{j}^{n}+u_{j}^{n-1}}{(\\Delta t)^{2}}=c^{2}\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\nRearranging gives the update formula\n$$\nu_{j}^{n+1}=2u_{j}^{n}-u_{j}^{n-1}+r^{2}\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\nwhere the Courant number is defined by\n$$\nr=\\frac{c\\,\\Delta t}{\\Delta x}.\n$$\n\nTo determine the stability constraint, perform a von Neumann analysis by seeking Fourier mode solutions of the form $u_{j}^{n}=G^{n}\\exp(\\mathrm{i}\\kappa j\\Delta x)$, where $G$ is the amplification factor and $\\kappa$ is the wavenumber. Substituting into the update yields\n$$\nG-2+G^{-1}=r^{2}\\left(e^{\\mathrm{i}\\kappa\\Delta x}-2+e^{-\\mathrm{i}\\kappa\\Delta x}\\right)=-4r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right).\n$$\nEquivalently,\n$$\nG+G^{-1}=2\\left[1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right)\\right].\n$$\nThis implies the dispersion relation\n$$\n\\cos(\\omega\\Delta t)=1-2r^{2}\\sin^{2}\\left(\\frac{\\kappa\\Delta x}{2}\\right),\n$$\nso that stability, which requires $|G|=1$ for all modes, holds provided the right-hand side lies in the interval $[-1,1]$ for all $\\kappa$. Since $\\sin^{2}(\\cdot)\\in[0,1]$, the minimum of the right-hand side over all $\\kappa$ is $1-2r^{2}$. Requiring $1-2r^{2}\\geq -1$ gives\n$$\nr^{2}\\leq 1 \\quad\\Longleftrightarrow\\quad r\\leq 1.\n$$\nTherefore, the Courant-Friedrichs-Lewy stability condition for this explicit scheme is\n$$\n\\frac{c\\,\\Delta t}{\\Delta x}\\leq 1 \\quad\\Longrightarrow\\quad \\Delta t\\leq \\frac{\\Delta x}{c}.\n$$\n\nFor the given data, $\\Delta x=0.05$ and $c=4$, hence the maximum stable time step is\n$$\n\\Delta t_{\\max}=\\frac{0.05}{4}=0.0125.\n$$\nRounded to three significant figures, this value is $0.0125$ seconds.", "answer": "$$\\boxed{0.0125}$$", "id": "2139541"}, {"introduction": "After learning to calculate the CFL stability limit, it's valuable to gain a deeper intuition for what it represents. This next exercise [@problem_id:2139538] is a thought experiment that explores the ideal scenario for the linear advection equation, where the Courant number is exactly one. By analyzing this special case, we uncover why the CFL condition is not just an abstract mathematical boundary but is fundamentally linked to the speed at which information travels across the numerical grid, revealing a situation where the numerical solution can be perfectly exact.", "problem": "Consider the one-dimensional linear advection equation, which models the transport of a quantity $u$ at a constant speed. The equation is given by:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u(x, t)$ is the transported quantity at position $x$ and time $t$, and $c$ is a constant positive advection speed ($c > 0$). The equation is solved over the spatial domain $x \\in (-\\infty, \\infty)$ for time $t \\ge 0$.\n\nThe initial condition at $t=0$ is a well-defined, localized pulse, $u(x, 0) = f(x)$, which is non-zero only on a finite interval.\n\nTo solve this equation numerically, a computational grid is established with uniform spatial spacing $\\Delta x$ and uniform time steps $\\Delta t$. The grid points are denoted by $x_j = j \\Delta x$ and $t_n = n \\Delta t$, where $j$ is an integer and $n$ is a non-negative integer. Let $U_j^n$ represent the numerical approximation of $u(x_j, t_n)$.\n\nThe first-order upwind finite difference scheme is used for the numerical solution. Given the positive advection speed $c>0$, the scheme is defined by discretizing the time derivative with a forward difference and the spatial derivative with a backward difference:\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0\n$$\nThe grid spacing $\\Delta x$ and time step $\\Delta t$ are specifically chosen such that the Courant number, defined as $\\sigma = \\frac{c \\Delta t}{\\Delta x}$, is exactly equal to 1.\n\nAfter evolving the system for $N$ time steps, where $N$ is a positive integer, which of the following statements best describes the numerical solution profile, $\\{U_j^N\\}_{j \\in \\mathbb{Z}}$, in relation to the initial discrete profile, $\\{U_j^0\\}_{j \\in \\mathbb{Z}}$?\n\nA. The numerical solution is identical to the exact analytical solution at the grid points, representing a perfect, shape-preserving translation of the initial profile.\n\nB. The peak value of the pulse has decreased, and its base has widened, indicating the presence of numerical diffusion.\n\nC. Spurious oscillations have appeared in the numerical solution, particularly near regions of high gradient in the initial pulse.\n\nD. The magnitude of the numerical solution has grown without bound, indicating a numerical instability.\n\nE. The pulse has translated, but it has become asymmetric, with one side becoming steeper than the other.\n\nF. The pulse has remained centered at its initial position but its amplitude has decayed over time.", "solution": "The continuous problem is the linear advection equation with constant positive speed $c>0$,\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\nwith initial condition $u(x,0)=f(x)$ that is compactly supported. By the method of characteristics, along curves satisfying $\\frac{\\mathrm{d}x}{\\mathrm{d}t}=c$, the solution is constant. Therefore the exact solution is\n$$\nu(x,t) = f(x - c t).\n$$\n\nOn a uniform grid with $x_j=j \\Delta x$, $t_n=n \\Delta t$, the first-order upwind scheme for $c>0$ is\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0.\n$$\nIntroducing the Courant number $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ and rearranging gives\n$$\nU_j^{n+1} = U_j^n - \\sigma \\left(U_j^n - U_{j-1}^n\\right) = (1-\\sigma) U_j^n + \\sigma U_{j-1}^n.\n$$\nWith the specific choice $\\sigma=1$, this update reduces to the pure shift operator\n$$\nU_j^{n+1} = U_{j-1}^n.\n$$\nIterating this identity for $N$ time steps yields\n$$\nU_j^{N} = U_{j-1}^{N-1} = \\cdots = U_{j-N}^{0}.\n$$\nThus the discrete profile is translated exactly by $N$ grid cells to the right without any change of shape or amplitude.\n\nTo compare with the exact solution at grid points at time $t_N = N \\Delta t$, evaluate\n$$\nu(x_j, t_N) = f(x_j - c t_N) = f\\big(j \\Delta x - c N \\Delta t\\big).\n$$\nSince $\\sigma= \\frac{c \\Delta t}{\\Delta x} = 1$, we have $c N \\Delta t = N \\Delta x$, hence\n$$\nu(x_j, t_N) = f\\big((j-N)\\Delta x\\big) = f(x_{j-N}).\n$$\nBy the definition of the initial discrete data, $U_{j-N}^{0} = f(x_{j-N})$, so\n$$\nU_j^{N} = U_{j-N}^{0} = u(x_j, t_N).\n$$\nTherefore, at the grid points, the numerical solution coincides exactly with the analytical solution and represents a perfect, shape-preserving translation of the initial profile by $N$ cells to the right. None of the effects described by numerical diffusion, spurious oscillations, instability, asymmetry, or stationary decay occur in this case.\n\nThe correct choice is A.", "answer": "$$\\boxed{A}$$", "id": "2139538"}, {"introduction": "Many physical systems involve a combination of transport mechanisms. The advection-diffusion equation, for example, models phenomena like heat or pollutant concentration carried by a flow while simultaneously spreading out. This final practice problem [@problem_id:2139560] challenges us to extend our stability analysis to such a hybrid system, demonstrating how the constraints from both advection (the CFL condition) and diffusion must be satisfied simultaneously, leading to a more restrictive condition on the time step.", "problem": "A computational engineer is developing a simulation to model the concentration of a soluble chemical pollutant in a long, uniform channel. The concentration of the pollutant, $u(x,t)$, where $x$ is the position along the channel and $t$ is time, is governed by the one-dimensional advection-diffusion equation:\n$$ \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = D \\frac{\\partial^2 u}{\\partial x^2} $$\nHere, $c$ is the constant advection speed of the water flow, and $D$ is the constant diffusion coefficient of the pollutant.\n\nFor the numerical simulation, the engineer employs an explicit finite-difference method based on a uniform grid with spatial step size $\\Delta x$ and time step size $\\Delta t$. The scheme uses a forward difference for the time derivative, a centered difference for the advection (first spatial derivative) term, and a centered difference for the diffusion (second spatial derivative) term. This results in the following discrete update equation for the concentration $U_j^n \\approx u(j\\Delta x, n\\Delta t)$:\n$$ \\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_{j+1}^n - U_{j-1}^n}{2\\Delta x} = D \\frac{U_{j+1}^n - 2U_j^n + U_{j-1}^n}{(\\Delta x)^2} $$\n\nThe physical parameters for the channel and pollutant are given as:\n- Advection speed, $c = 0.5 \\text{ m/s}$\n- Diffusion coefficient, $D = 0.01 \\text{ m}^2\\text{/s}$\n\nThe engineer sets the spatial grid spacing for the simulation to be $\\Delta x = 0.1 \\text{ m}$. To ensure the simulation does not produce unphysical oscillations and grow unboundedly, the time step $\\Delta t$ must be chosen to satisfy the stability condition for this numerical scheme. According to the Courant-Friedrichs-Lewy (CFL) stability criterion, there is a maximum allowable time step.\n\nDetermine the maximum allowable time step, $\\Delta t_{max}$, for which this numerical scheme is stable. Express your answer in seconds, rounded to three significant figures.", "solution": "The given explicit finite-difference update is\n$$\n\\frac{U_{j}^{n+1}-U_{j}^{n}}{\\Delta t}+c\\frac{U_{j+1}^{n}-U_{j-1}^{n}}{2\\Delta x}\n= D\\frac{U_{j+1}^{n}-2U_{j}^{n}+U_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\nRewriting, introduce the nondimensional parameters\n$$\n\\mu \\equiv \\frac{c\\,\\Delta t}{\\Delta x}, \\qquad \\beta \\equiv \\frac{D\\,\\Delta t}{(\\Delta x)^{2}},\n$$\nto obtain\n$$\nU_{j}^{n+1} = U_{j}^{n} - \\frac{\\mu}{2}\\left(U_{j+1}^{n}-U_{j-1}^{n}\\right)\n+ \\beta \\left(U_{j+1}^{n}-2U_{j}^{n}+U_{j-1}^{n}\\right).\n$$\nPerform a von Neumann analysis with the Fourier mode $U_{j}^{n}=\\xi^{n}\\exp(i\\theta j)$, where $\\theta=k\\Delta x$. Substituting $U_{j\\pm 1}^{n}=\\xi^{n}\\exp[i\\theta(j\\pm 1)]$ gives the amplification factor\n$$\n\\xi = 1 - i\\mu \\sin\\theta + 2\\beta(\\cos\\theta - 1).\n$$\nStability requires $|\\xi|\\leq 1$ for all $\\theta$. Compute\n$$\n|\\xi|^{2} = \\left[1 + 2\\beta(\\cos\\theta - 1)\\right]^{2} + \\mu^{2}\\sin^{2}\\theta.\n$$\nUse the half-angle identities $\\cos\\theta - 1 = -2\\sin^{2}(\\tfrac{\\theta}{2})$ and $\\sin\\theta = 2\\sin(\\tfrac{\\theta}{2})\\cos(\\tfrac{\\theta}{2})$. Let $y \\equiv \\sin^{2}(\\tfrac{\\theta}{2})\\in[0,1]$ so that $\\cos^{2}(\\tfrac{\\theta}{2})=1-y$. Then\n$$\n|\\xi|^{2} = \\left(1 - 4\\beta y\\right)^{2} + 4\\mu^{2}y(1-y)\n= 1 + y\\left(-8\\beta + 4\\mu^{2}\\right) + y^{2}\\left(16\\beta^{2} - 4\\mu^{2}\\right).\n$$\nDefine the quadratic increment $R(y) \\equiv |\\xi|^{2} - 1 = y(-8\\beta + 4\\mu^{2}) + y^{2}(16\\beta^{2} - 4\\mu^{2})$. Stability is equivalent to $R(y)\\leq 0$ for all $y\\in[0,1]$. Evaluate at the endpoints:\n$$\nR(0)=0,\\qquad R(1)=16\\beta^{2} - 8\\beta = 8\\beta(2\\beta - 1)\\leq 0 \\;\\;\\Longleftrightarrow\\;\\; \\beta \\leq \\frac{1}{2}.\n$$\nWhen $16\\beta^{2} - 4\\mu^{2}\\geq 0$ (convex case), the maximum of $R$ on $[0,1]$ occurs at an endpoint, so $\\beta\\leq \\frac{1}{2}$ suffices. When $16\\beta^{2} - 4\\mu^{2}<0$ (concave case), the vertex $y^{*}$ is the maximum if it lies in $(0,1)$. To prevent this, it is necessary and sufficient that the vertex lie outside $[0,1]$, which reduces to the condition\n$$\n\\mu^{2} \\leq 2\\beta.\n$$\nTherefore the von Neumann stability region for this scheme is\n$$\n\\mu^{2} \\leq 2\\beta \\quad \\text{and} \\quad \\beta \\leq \\frac{1}{2}.\n$$\nTranslating back to $\\Delta t$,\n$$\n\\left(\\frac{c\\,\\Delta t}{\\Delta x}\\right)^{2} \\leq 2\\,\\frac{D\\,\\Delta t}{(\\Delta x)^{2}}\n\\;\\;\\Longleftrightarrow\\;\\; c^{2}\\Delta t \\leq 2D\n\\;\\;\\Longleftrightarrow\\;\\; \\Delta t \\leq \\frac{2D}{c^{2}},\n$$\nand\n$$\n\\frac{D\\,\\Delta t}{(\\Delta x)^{2}} \\leq \\frac{1}{2}\n\\;\\;\\Longleftrightarrow\\;\\; \\Delta t \\leq \\frac{(\\Delta x)^{2}}{2D}.\n$$\nThus\n$$\n\\Delta t_{\\max} = \\min\\!\\left(\\frac{2D}{c^{2}},\\, \\frac{(\\Delta x)^{2}}{2D}\\right).\n$$\nInsert the given values $c=0.5$, $D=0.01$, $\\Delta x=0.1$:\n$$\n\\frac{2D}{c^{2}} = \\frac{2\\times 0.01}{(0.5)^{2}} = \\frac{0.02}{0.25} = 0.08,\n\\qquad\n\\frac{(\\Delta x)^{2}}{2D} = \\frac{0.01}{0.02} = 0.5.\n$$\nTherefore, the maximum allowable time step is\n$$\n\\Delta t_{\\max} = 0.08,\n$$\nwhich to three significant figures is $8.00\\times 10^{-2}$.", "answer": "$$\\boxed{8.00 \\times 10^{-2}}$$", "id": "2139560"}]}