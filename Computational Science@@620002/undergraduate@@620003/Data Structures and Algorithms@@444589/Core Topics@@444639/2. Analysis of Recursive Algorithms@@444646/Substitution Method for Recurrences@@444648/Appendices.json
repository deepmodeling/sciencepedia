{"hands_on_practices": [{"introduction": "We begin our practice with a foundational example that illustrates the core idea of the substitution method. By repeatedly \"unrolling\" the recurrence, we transform it into a summation, a common outcome of this technique. This problem not only provides practice with the mechanics of substitution but also reveals an elegant connection between an algorithmic scenario and the classical Harmonic series. [@problem_id:3277485]", "problem": "Consider an algorithm that processes a stream of $n$ distinct elements arriving one by one and maintains a running minimum. Each time the current element is strictly smaller than all previously seen elements, the algorithm performs an additional constant-time update. Let $T(n)$ denote the expected number of these additional updates after observing $n$ elements, and suppose the following recurrence holds for all integers $n \\geq 2$:\n$$\nT(n) = T(n-1) + \\frac{1}{n},\n$$\nwith base condition $T(1) = 0$. Using the substitution method (also known as the method of unrolling), derive a closed-form expression for $T(n)$ in terms of the $n$th harmonic number $H_n$, where $H_n$ is defined by\n$$\nH_n = \\sum_{k=1}^{n} \\frac{1}{k}.\n$$\nYour final answer must be a single analytic expression written in terms of $n$ and $H_n$.", "solution": "The problem statement is first validated according to the required procedure.\n\n### Step 1: Extract Givens\n- The stream has $n$ distinct elements.\n- The recurrence relation for the expected number of updates $T(n)$ is $T(n) = T(n-1) + \\frac{1}{n}$ for all integers $n \\geq 2$.\n- The base condition is $T(1) = 0$.\n- The method to be used is the substitution method (unrolling).\n- The $n$th harmonic number is defined as $H_n = \\sum_{k=1}^{n} \\frac{1}{k}$.\n- The objective is to find a closed-form expression for $T(n)$ in terms of $n$ and $H_n$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is standard in the analysis of algorithms. If the $n$ elements arrive in a random permutation, the probability that the $n$-th element is the minimum of all elements seen so far is exactly $\\frac{1}{n}$. By linearity of expectation, the expected number of updates at step $n$ is $\\frac{1}{n}$, leading to the given recurrence. The problem is mathematically sound.\n2.  **Well-Posed**: The problem provides a first-order linear recurrence relation with a specified base case. This structure guarantees a unique solution.\n3.  **Objective**: The problem is stated using precise mathematical language with no ambiguity.\n4.  **Completeness**: All necessary information (recurrence, base case, definition of $H_n$) is provided.\n5.  **Relevance**: The problem is a direct application of the substitution method for solving recurrences, a core topic in data structures and algorithms.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically grounded, well-posed, objective, and complete. A solution will be derived.\n\nThe problem requires solving the recurrence relation\n$$\nT(n) = T(n-1) + \\frac{1}{n}\n$$\nfor $n \\geq 2$, with the base case $T(1) = 0$. The method to be used is the substitution method, also known as unrolling or iteration.\n\nWe begin with the given recurrence relation:\n$$\nT(n) = T(n-1) + \\frac{1}{n}\n$$\nWe unroll the recurrence by repeatedly substituting the expression for the term with a smaller index.\nFor the $T(n-1)$ term, the recurrence relation implies $T(n-1) = T(n-2) + \\frac{1}{n-1}$. Substituting this into the equation for $T(n)$:\n$$\nT(n) = \\left( T(n-2) + \\frac{1}{n-1} \\right) + \\frac{1}{n} = T(n-2) + \\frac{1}{n-1} + \\frac{1}{n}\n$$\nNext, we substitute for $T(n-2)$, which is $T(n-3) + \\frac{1}{n-2}$:\n$$\nT(n) = \\left( T(n-3) + \\frac{1}{n-2} \\right) + \\frac{1}{n-1} + \\frac{1}{n} = T(n-3) + \\frac{1}{n-2} + \\frac{1}{n-1} + \\frac{1}{n}\n$$\nA pattern is emerging. After $i$ steps of unrolling, the expression becomes:\n$$\nT(n) = T(n-i) + \\sum_{k=0}^{i-1} \\frac{1}{n-k}\n$$\nTo reach the base case $T(1)$, we must unroll until the argument of $T$ becomes $1$. We set $n-i = 1$, which gives $i = n-1$.\nSubstituting $i = n-1$ into the general pattern:\n$$\nT(n) = T(n-(n-1)) + \\sum_{k=0}^{(n-1)-1} \\frac{1}{n-k} = T(1) + \\sum_{k=0}^{n-2} \\frac{1}{n-k}\n$$\nLet's expand the summation to see the terms explicitly:\n$$\n\\sum_{k=0}^{n-2} \\frac{1}{n-k} = \\frac{1}{n-0} + \\frac{1}{n-1} + \\dots + \\frac{1}{n-(n-2)} = \\frac{1}{n} + \\frac{1}{n-1} + \\dots + \\frac{1}{2}\n$$\nThis is the sum of reciprocals from $2$ to $n$. We can write this using summation notation with an index running upwards:\n$$\n\\sum_{j=2}^{n} \\frac{1}{j}\n$$\nSo, the expression for $T(n)$ becomes:\n$$\nT(n) = T(1) + \\sum_{j=2}^{n} \\frac{1}{j}\n$$\nWe are given the base condition $T(1) = 0$. Substituting this value:\n$$\nT(n) = 0 + \\sum_{j=2}^{n} \\frac{1}{j} = \\sum_{j=2}^{n} \\frac{1}{j}\n$$\nThe problem asks for the solution in terms of the $n$th harmonic number, $H_n$, which is defined as:\n$$\nH_n = \\sum_{k=1}^{n} \\frac{1}{k}\n$$\nWe can split the sum for $H_n$ at $k=1$:\n$$\nH_n = \\frac{1}{1} + \\sum_{k=2}^{n} \\frac{1}{k} = 1 + \\sum_{k=2}^{n} \\frac{1}{k}\n$$\nComparing this with our expression for $T(n)$, we see that $T(n) = \\sum_{j=2}^{n} \\frac{1}{j}$.\nTherefore, we can write:\n$$\nH_n = 1 + T(n)\n$$\nSolving for $T(n)$, we obtain the final closed-form expression:\n$$\nT(n) = H_n - 1\n$$\nThis is the expected number of times the running minimum is updated when processing a random permutation of $n$ distinct elements.", "answer": "$$\\boxed{H_n - 1}$$", "id": "3277485"}, {"introduction": "This next exercise introduces a common complexity in recurrence relations: dependence on the input's structure. Here, the recurrence's step size of two means the solution path depends on the parity of $n$, whether it is even or odd. Solving this problem will demonstrate the necessity of careful case analysis and how to manage multiple base cases. [@problem_id:3277510]", "problem": "Consider the recurrence relation on the nonnegative integers defined by $T(n) = T(n-2) + n^{2}$ for all integers $n \\geq 2$, with base values $T(0) = \\alpha$ and $T(1) = \\beta$, where $\\alpha$ and $\\beta$ are fixed real constants. Using the substitution (iterative expansion) method, start from the recurrence definition and unroll it until a base case is reached. Carefully account for how parity affects the unrolling path, and reduce the resulting expressions to closed forms using well-tested summation facts. Your task is to derive exact closed-form analytic expressions for $T(n)$ in terms of $n$, $\\alpha$, and $\\beta$, distinguishing the cases where $n$ is even and where $n$ is odd. Express your final answer as a row matrix where the first entry corresponds to the closed form for even $n$ and the second entry corresponds to the closed form for odd $n$. No rounding is required.", "solution": "The problem is valid as it is a well-posed mathematical problem in the analysis of algorithms, with a complete and consistent setup. We will proceed to solve it using the substitution method as requested.\n\nThe recurrence relation is given by $T(n) = T(n-2) + n^{2}$ for integers $n \\geq 2$, with initial conditions $T(0) = \\alpha$ and $T(1) = \\beta$. The step size of $2$ in the recurrence argument, $n-2$, indicates that the parity of the input is preserved. This means that values of $T(n)$ for even $n$ depend only on the base case $T(0)$, and values for odd $n$ depend only on $T(1)$. We must therefore analyze the two cases separately.\n\n**Case 1: $n$ is even**\nLet $n$ be an even non-negative integer. We can write $n = 2k$ for some integer $k \\geq 0$. We will use the substitution method (iterative expansion) to unroll the recurrence until we reach the base case $T(0)$.\n$T(n) = T(n-2) + n^2$\n$T(n) = \\left( T(n-4) + (n-2)^2 \\right) + n^2 = T(n-4) + (n-2)^2 + n^2$\n$T(n) = \\left( T(n-6) + (n-4)^2 \\right) + (n-2)^2 + n^2 = T(n-6) + (n-4)^2 + (n-2)^2 + n^2$\n\nAfter $i$ steps of unrolling, the recurrence becomes:\n$T(n) = T(n-2i) + \\sum_{j=0}^{i-1} (n-2j)^2$\n\nSince $n = 2k$, we want to find the number of steps $i$ required to reach the base case $T(0)$. This occurs when $n-2i = 0$, which implies $2k - 2i = 0$, so $i=k$.\nSubstituting $i=k$ and $n=2k$ into the expanded form:\n$T(2k) = T(2k - 2k) + \\sum_{j=0}^{k-1} (2k - 2j)^2$\n$T(2k) = T(0) + \\sum_{j=0}^{k-1} (2(k-j))^2$\n$T(2k) = \\alpha + 4 \\sum_{j=0}^{k-1} (k-j)^2$\n\nLet the index of summation be $m = k-j$. When $j=0$, $m=k$. When $j=k-1$, $m=1$. The sum becomes:\n$T(2k) = \\alpha + 4 \\sum_{m=1}^{k} m^2$\n\nWe use the standard formula for the sum of the first $k$ squares: $\\sum_{m=1}^{k} m^2 = \\frac{k(k+1)(2k+1)}{6}$.\n$T(2k) = \\alpha + 4 \\left( \\frac{k(k+1)(2k+1)}{6} \\right) = \\alpha + \\frac{2}{3} k(k+1)(2k+1)$\n\nTo obtain the closed form in terms of $n$, we substitute $k = n/2$:\n$T(n) = \\alpha + \\frac{2}{3} \\left(\\frac{n}{2}\\right) \\left(\\frac{n}{2}+1\\right) \\left(2 \\cdot \\frac{n}{2}+1\\right)$\n$T(n) = \\alpha + \\frac{n}{3} \\left(\\frac{n+2}{2}\\right) (n+1)$\n$T(n) = \\alpha + \\frac{n(n+1)(n+2)}{6}$\n\n**Case 2: $n$ is odd**\nLet $n$ be an odd non-negative integer. We can write $n = 2k+1$ for some integer $k \\geq 0$. We unroll the recurrence until we reach the base case $T(1)$.\nAfter $i$ steps, we have:\n$T(n) = T(n-2i) + \\sum_{j=0}^{i-1} (n-2j)^2$\n\nSince $n = 2k+1$, we want to find the number of steps $i$ required to reach $T(1)$. This occurs when $n-2i = 1$, which implies $2k+1 - 2i = 1$, so $2k = 2i$, and $i=k$.\nSubstituting $i=k$ and $n=2k+1$:\n$T(2k+1) = T(2k+1 - 2k) + \\sum_{j=0}^{k-1} (2k+1 - 2j)^2$\n$T(2k+1) = T(1) + \\sum_{j=0}^{k-1} (2(k-j)+1)^2$\n\nLet the index of summation be $m = k-j$. When $j=0$, $m=k$. When $j=k-1$, $m=1$. The sum becomes:\n$T(2k+1) = \\beta + \\sum_{m=1}^{k} (2m+1)^2$\n\nWe evaluate the sum $\\sum_{m=1}^{k} (2m+1)^2$:\n$\\sum_{m=1}^{k} (2m+1)^2 = \\sum_{m=1}^{k} (4m^2 + 4m + 1) = 4\\sum_{m=1}^{k} m^2 + 4\\sum_{m=1}^{k} m + \\sum_{m=1}^{k} 1$\nUsing the formulas $\\sum m^2 = \\frac{k(k+1)(2k+1)}{6}$, $\\sum m = \\frac{k(k+1)}{2}$, and $\\sum 1 = k$:\n$S_k = 4\\left(\\frac{k(k+1)(2k+1)}{6}\\right) + 4\\left(\\frac{k(k+1)}{2}\\right) + k$\n$S_k = \\frac{2k(k+1)(2k+1)}{3} + 2k(k+1) + k$\n$S_k = \\frac{k}{3} [2(k+1)(2k+1) + 6(k+1) + 3]$\n$S_k = \\frac{k}{3} [2(2k^2+3k+1) + 6k+6 + 3]$\n$S_k = \\frac{k}{3} [4k^2+6k+2 + 6k+9] = \\frac{k(4k^2+12k+11)}{3}$\nSo, $T(2k+1) = \\beta + S_k = \\beta + \\frac{k(4k^2+12k+11)}{3}$.\n\nTo obtain the closed form in terms of $n$, we substitute $k = (n-1)/2$:\n$T(n) = \\beta + \\frac{(n-1)/2}{3} \\left[ 4\\left(\\frac{n-1}{2}\\right)^2 + 12\\left(\\frac{n-1}{2}\\right) + 11 \\right]$\n$T(n) = \\beta + \\frac{n-1}{6} \\left[ 4\\frac{(n-1)^2}{4} + 6(n-1) + 11 \\right]$\n$T(n) = \\beta + \\frac{n-1}{6} [ (n^2-2n+1) + 6n-6+11 ]$\n$T(n) = \\beta + \\frac{n-1}{6} (n^2+4n+6)$\nExpanding the polynomial product:\n$(n-1)(n^2+4n+6) = n(n^2+4n+6) - (n^2+4n+6) = n^3+4n^2+6n - n^2-4n-6 = n^3+3n^2+2n-6$\nThe term $n^3+3n^2+2n$ can be factored as $n(n^2+3n+2) = n(n+1)(n+2)$.\nSo, the expression becomes:\n$T(n) = \\beta + \\frac{n(n+1)(n+2) - 6}{6}$\n$T(n) = \\beta + \\frac{n(n+1)(n+2)}{6} - 1$\n\nIn summary, the closed-form solutions are:\nFor even $n$: $T(n) = \\alpha + \\frac{n(n+1)(n+2)}{6}$\nFor odd $n$: $T(n) = \\beta - 1 + \\frac{n(n+1)(n+2)}{6}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\alpha + \\frac{n(n+1)(n+2)}{6}  \\beta - 1 + \\frac{n(n+1)(n+2)}{6}\n\\end{pmatrix}\n}\n$$", "id": "3277510"}, {"introduction": "Not all recurrences unroll into sums with convenient closed-form expressions. This final practice problem introduces a powerful method for when an exact solution is out of reach: approximating the resulting sum using a definite integral. This technique is a cornerstone of advanced algorithm analysis, allowing us to determine the dominant asymptotic behavior of a function by bridging discrete summation and continuous calculus. [@problem_id:3277521]", "problem": "Let $c \\in \\mathbb{Z}_{\\ge 1}$ be a fixed constant and define the recurrence for integers $n \\ge 1$ by\n$$\nT(n) \\;=\\; T(n - c) \\;+\\; \\ln n,\n$$\nwith the base condition $T(n) = 0$ for all $n \\le 0$. Assume $\\ln$ denotes the natural logarithm. Using the substitution method (that is, repeatedly expanding the recurrence until the base condition is reached), derive the asymptotic growth of $T(n)$ in terms of $n$ and $c$ starting from the following foundational facts only: the definition of the $\\Theta(\\cdot)$ notation, the monotonicity of the natural logarithm, and the elementary calculus identity $\\int \\ln x \\, dx = x \\ln x - x$. From your derivation, determine the exact value of the limit\n$$\nL(c) \\;=\\; \\lim_{n \\to \\infty} \\frac{T(n)}{n \\ln n},\n$$\nand use it to decide for which integer constants $c$ the function $T(n)$ has order $\\Theta(n \\ln n)$. Report only the exact expression for $L(c)$ as your final answer. No rounding is required.", "solution": "The user-provided problem is evaluated as valid based on the specified criteria. It is scientifically grounded, well-posed, objective, and contains no discernible flaws. The solution process may therefore proceed.\n\nThe task is to analyze the recurrence relation $T(n) = T(n - c) + \\ln n$ for integers $n \\ge 1$ with a fixed integer constant $c \\in \\mathbb{Z}_{\\ge 1}$. The base condition is $T(n) = 0$ for all $n \\le 0$. We will use the substitution method to find an expression for $T(n)$, determine its asymptotic growth, and compute the limit $L(c) = \\lim_{n \\to \\infty} \\frac{T(n)}{n \\ln n}$.\n\nFirst, we expand the recurrence relation using substitution:\n$$\n\\begin{aligned}\nT(n) = T(n-c) + \\ln n \\\\\n= (T(n-2c) + \\ln(n-c)) + \\ln n \\\\\n= (T(n-3c) + \\ln(n-2c)) + \\ln(n-c) + \\ln n \\\\\n\\vdots \\\\\n= T(n-kc) + \\sum_{i=0}^{k-1} \\ln(n-ic)\n\\end{aligned}\n$$\nThe recursion terminates when the argument of $T$ becomes non-positive, i.e., $n-kc \\le 0$. Since $T(x)=0$ for $x \\le 0$, we can write $T(n)$ purely as a sum. The sum includes terms $\\ln(n-ic)$ as long as $n-ic  0$. Let $k_{max}$ be the number of terms in the sum. The arguments are $n, n-c, n-2c, \\dots, n-(k_{max}-1)c$. The last term must be positive, so $n-(k_{max}-1)c  0$, which implies $(k_{max}-1)c  n$, or $k_{max}  \\frac{n}{c} + 1$. The number of terms is $k = \\lfloor \\frac{n-1}{c} \\rfloor + 1$.\nLet $n-1 = qc+r$, where $q = \\lfloor \\frac{n-1}{c} \\rfloor$ is an integer and $0 \\le r  c$.\nThe number of terms in the sum is $k = q+1$.\nThe sum is $T(n) = \\sum_{i=0}^{k-1} \\ln(n-ic)$.\nThe argument of the last term in the sum is for $i=k-1=q$: $n-cq = (qc+r+1)-cq = r+1$. Since $0 \\le r  c$, we have $1 \\le r+1 \\le c$. Thus, all arguments of the logarithm are positive integers.\nSo, $T(n) = \\sum_{i=0}^{q} \\ln(n-ic) = \\ln(n) + \\ln(n-c) + \\dots + \\ln(r+1)$.\n\nTo find the asymptotic behavior of $T(n)$, we approximate this sum using an integral. This is justified by the fact that $\\ln x$ is a monotonic function, one of the foundational facts we are permitted to use.\nThe terms in the sum are values of the function $f(x) = \\ln x$ at points separated by a distance of $c$. Let the arguments be denoted in increasing order: $x_j = (r+1)+jc$ for $j=0, 1, \\dots, q$. Note that $x_q = r+1+qc = n$. The sum for $T(n)$ is $T(n) = \\sum_{j=0}^{q} \\ln(x_j)$.\n\nSince $\\ln x$ is a monotonically increasing function, we can establish lower and upper bounds for the sum by comparing it with an integral.\nFor an interval $[x_j, x_{j+1}]$, we have $x_{j+1}-x_j = c$. Because $\\ln x$ is increasing:\n$$\nc \\ln(x_j) \\le \\int_{x_j}^{x_{j+1}} \\ln(t) dt \\le c \\ln(x_{j+1})\n$$\nSumming from $j=0$ to $q-1$:\n$$\nc \\sum_{j=0}^{q-1} \\ln(x_j) \\le \\sum_{j=0}^{q-1} \\int_{x_j}^{x_{j+1}} \\ln(t) dt \\le c \\sum_{j=0}^{q-1} \\ln(x_{j+1})\n$$\nThe sum of integrals telescopes: $\\sum_{j=0}^{q-1} \\int_{x_j}^{x_{j+1}} \\ln(t) dt = \\int_{x_0}^{x_q} \\ln(t) dt = \\int_{r+1}^{n} \\ln(t) dt$.\nThe sum on the left is $c(\\sum_{j=0}^{q} \\ln(x_j) - \\ln(x_q)) = c(T(n)-\\ln n)$.\nThe sum on the right is $c(\\sum_{j=0}^{q} \\ln(x_j) - \\ln(x_0)) = c(T(n)-\\ln(r+1))$.\nThis yields the two inequalities:\n$1.$ $c(T(n)-\\ln n) \\le \\int_{r+1}^{n} \\ln t \\, dt \\implies T(n) \\le \\frac{1}{c}\\int_{r+1}^{n} \\ln t \\, dt + \\ln n$.\n$2.$ $\\int_{r+1}^{n} \\ln t \\, dt \\le c(T(n)-\\ln(r+1)) \\implies T(n) \\ge \\frac{1}{c}\\int_{r+1}^{n} \\ln t \\, dt + \\ln(r+1)$.\n\nWe now use the given identity $\\int \\ln x \\, dx = x \\ln x - x$ to evaluate the definite integral:\n$$\n\\int_{r+1}^{n} \\ln t \\, dt = [t \\ln t - t]_{r+1}^{n} = (n \\ln n - n) - ((r+1)\\ln(r+1) - (r+1))\n$$\nThe term $((r+1)\\ln(r+1) - (r+1))$ is a constant with respect to $n$, as $r$ depends only on $(n-1) \\pmod c$ and thus cycles through a finite set of values. Let's denote this term by $C_r = (r+1)\\ln(r+1) - (r+1)$, which is bounded since $1 \\le r+1 \\le c$.\n\nWe can now write the bounds for $T(n)$:\n$$\n\\frac{1}{c}(n \\ln n - n - C_r) + \\ln(r+1) \\le T(n) \\le \\frac{1}{c}(n \\ln n - n - C_r) + \\ln n\n$$\nTo find the limit $L(c)$, we divide the entire inequality by $n \\ln n$:\n$$\n\\frac{1}{c}\\left(1 - \\frac{1}{\\ln n} - \\frac{C_r}{n \\ln n}\\right) + \\frac{\\ln(r+1)}{n \\ln n} \\le \\frac{T(n)}{n \\ln n} \\le \\frac{1}{c}\\left(1 - \\frac{1}{\\ln n} - \\frac{C_r}{n \\ln n}\\right) + \\frac{1}{n}\n$$\nNow, we take the limit as $n \\to \\infty$. For the lower bound:\n$$\n\\lim_{n \\to \\infty} \\left[ \\frac{1}{c}\\left(1 - \\frac{1}{\\ln n} - \\frac{C_r}{n \\ln n}\\right) + \\frac{\\ln(r+1)}{n \\ln n} \\right] = \\frac{1}{c}(1 - 0 - 0) + 0 = \\frac{1}{c}\n$$\nFor the upper bound:\n$$\n\\lim_{n \\to \\infty} \\left[ \\frac{1}{c}\\left(1 - \\frac{1}{\\ln n} - \\frac{C_r}{n \\ln n}\\right) + \\frac{1}{n} \\right] = \\frac{1}{c}(1 - 0 - 0) + 0 = \\frac{1}{c}\n$$\nBy the Squeeze Theorem, since both the lower and upper bounds of $\\frac{T(n)}{n \\ln n}$ converge to $\\frac{1}{c}$, we have:\n$$\nL(c) = \\lim_{n \\to \\infty} \\frac{T(n)}{n \\ln n} = \\frac{1}{c}\n$$\nThe problem also asks for which integer constants $c$ the function $T(n)$ has order $\\Theta(n \\ln n)$. A function $f(n)$ is $\\Theta(g(n))$ if $\\lim_{n \\to \\infty} \\frac{f(n)}{g(n)}$ exists and is a positive constant. In our case, $g(n) = n \\ln n$. We found that the limit is $L(c) = \\frac{1}{c}$. The problem states that $c \\in \\mathbb{Z}_{\\ge 1}$, which means $c$ is a positive integer ($1, 2, 3, \\dots$). For any such $c$, the limit $\\frac{1}{c}$ is a positive constant. Therefore, $T(n) = \\Theta(n \\ln n)$ for all integer constants $c \\ge 1$.\n\nThe final answer required is the exact expression for $L(c)$.", "answer": "$$\n\\boxed{\\frac{1}{c}}\n$$", "id": "3277521"}]}