{"hands_on_practices": [{"introduction": "The first and most critical test for any numerical evolution scheme is its stability. An unstable scheme will produce exponentially growing errors that quickly overwhelm the physical solution, rendering the simulation useless. This practice delves into von Neumann stability analysis, a cornerstone technique for analyzing finite difference methods, by applying it to a simplified model that mirrors the hyperbolic structure of the BSSN equations. By deriving the famous Courant-Friedrichs-Lewy (CFL) condition, you will gain hands-on experience with the fundamental constraint connecting the time step $\\Delta t$, the grid spacing $\\Delta x$, and the characteristic speeds of the system [@problem_id:910011].", "problem": "In the realm of numerical relativity, the BSSN (Baumgarte-Shapiro-Shibata-Nakamura) formulation is a robust method for evolving Einstein's equations. A key aspect of implementing such a formulation is ensuring the numerical stability of the chosen discretization scheme. Stability analysis is often performed on simplified \"toy models\" that capture the essential mathematical structure of the full system.\n\nConsider the following 1D linearized toy model, which mimics some features of the BSSN system, such as the introduction of an auxiliary variable and advection terms. The system describes the evolution of three fields, $u(t,x)$, $v(t,x)$, and $q(t,x)$:\n$$\n\\begin{aligned}\n\\partial_t u &= -b \\, \\partial_x u + v \\\\\n\\partial_t v &= -b \\, \\partial_x v + c^2 \\, \\partial_x q \\\\\n\\partial_t q &= -b \\, \\partial_x q + \\partial_x v\n\\end{aligned}\n$$\nHere, $c$ is a constant positive characteristic speed ($c>0$), and $b$ is a constant advection speed, analogous to a component of the shift vector in general relativity.\n\nThis system is to be solved numerically on a grid with uniform spacing $\\Delta x$ in space and $\\Delta t$ in time. The numerical scheme employed is a second-order accurate method, combining the leapfrog scheme for time evolution with a centered finite-difference approximation for spatial derivatives. Specifically, for a generic field vector $\\mathbf{U} = (u,v,q)^T$, the scheme is:\n$$\n\\frac{\\mathbf{U}^{n+1}_j - \\mathbf{U}^{n-1}_j}{2\\Delta t} = (\\text{RHS})^n_j\n$$\nwhere the subscript $j$ and superscript $n$ denote the spatial and temporal grid points, $x_j=j\\Delta x$ and $t_n=n\\Delta t$. The right-hand-side (RHS) of the PDE system is evaluated at time step $n$, and all spatial derivatives $\\partial_x$ are approximated by the second-order centered difference operator:\n$$\n\\partial_x f(t_n, x_j) \\approx \\frac{f^n_{j+1} - f^n_{j-1}}{2\\Delta x}\n$$\n\nYour task is to perform a von Neumann stability analysis on this numerical scheme. Determine the Courant-Friedrichs-Lewy (CFL) stability condition. Based on this, what is the maximum allowed value of the Courant number, $\\lambda_C = \\Delta t / \\Delta x$, for which the scheme is stable for all possible wave modes?", "solution": "1. The Fourier symbol for the centered difference operator is $ik_{\\text{eff}}$ where $k_{\\text{eff}} = \\sin(k\\Delta x)/\\Delta x$. The eigenvalues $\\lambda$ of the semi-discretized RHS matrix are $\\lambda_1 = -i b k_{\\text{eff}}$, and $\\lambda_{2,3} = -i b k_{\\text{eff}} \\pm i c k_{\\text{eff}} = -i(b \\mp c) k_{\\text{eff}}$.\n2. The leapfrog advancement scheme $U^{n+1}=U^{n-1}+2\\Delta t L U^n$ has the characteristic equation $\\zeta^2 - 2\\Delta t \\lambda \\zeta - 1 = 0$, which yields amplification factors $\\zeta = \\Delta t \\lambda \\pm \\sqrt{1 + (\\Delta t \\lambda)^2}$.\n3. For purely imaginary eigenvalues $\\lambda=i\\omega$, stability ($|\\zeta| \\le 1$) requires the term under the square root to be real, which implies $1 - (\\Delta t \\omega)^2 \\ge 0$, or $|\\Delta t \\omega| \\le 1$.\n4. The maximum magnitude of the eigenvalue frequencies is $|\\omega|_{\\max} = \\max(|b|, |b\\pm c|) \\cdot |k_{\\text{eff}}|_{\\max}$. Since $|k_{\\text{eff}}|_{\\max} = 1/\\Delta x$, we have $|\\omega|_{\\max} = (|b|+c)/\\Delta x$. The stability condition is thus $\\Delta t (|b|+c)/\\Delta x \\le 1$, which means the Courant number must satisfy $\\lambda_C = \\Delta t/\\Delta x \\le 1/(c+|b|)$.", "answer": "$$\\boxed{\\frac{1}{c+|b|}}$$", "id": "910011"}, {"introduction": "Beyond stability, a high-quality numerical scheme must also be accurate, a goal that requires actively managing unphysical numerical artifacts. High-order finite difference methods, while powerful, often suffer from numerical dispersion, where different wave components of the solution propagate at incorrect speeds, leading to spurious oscillations that can pollute the results. This exercise explores the common and practical remedy of adding a carefully calibrated artificial dissipation term to the equations. You will determine the precise amount of Kreiss-Oliger dissipation needed to selectively damp the most problematic high-frequency modes, providing crucial insight into the art of balancing numerical accuracy against the suppression of non-physical noise [@problem_id:910026].", "problem": "In the field of numerical relativity, high-order finite difference schemes are often employed to solve systems of hyperbolic partial differential equations that describe the evolution of gravitational fields. To suppress high-frequency numerical instabilities, artificial dissipation terms are typically added to the discretized equations. This problem concerns the interplay between the numerical dispersion of the physical wave propagation and the damping effect of such artificial dissipation.\n\nConsider the one-dimensional advection equation for a scalar field $u(t, x)$:\n$$\n\\partial_t u + c \\, \\partial_x u = 0\n$$\nwhere $c > 0$ is the constant advection speed. We are using a method-of-lines approach, where space is discretized but time is kept continuous. Let the spatial grid points be $x_j = j \\Delta x$ for integer $j$. The semi-discrete version of the equation at grid point $j$ is given by:\n$$\n\\frac{d u_j}{dt} = -c (D_x u)_j + (Q u)_j\n$$\nThe spatial derivative $\\partial_x$ is approximated by a fourth-order accurate, centered finite difference operator $D_x$ with a five-point stencil:\n$$\n(D_x u)_j = \\frac{1}{12\\Delta x}(-u_{j+2} + 8u_{j+1} - 8u_{j-1} + u_{j-2})\n$$\nThe term $(Q u)_j$ represents a sixth-order Kreiss-Oliger artificial dissipation, defined as:\n$$\n(Q u)_j = \\frac{\\epsilon_d c}{\\Delta x} (D_+ D_-)^3 u_j\n$$\nwhere $\\epsilon_d$ is a dimensionless dissipation parameter, and $D_+$ and $D_-$ are the standard first-order forward and backward difference operators, $D_+ u_j = u_{j+1} - u_j$ and $D_- u_j = u_j - u_{j-1}$. The operator $(D_+ D_-)^3$ is thus applied as a thirteen-point stencil.\n\nThe fourth-order advection operator introduces numerical dispersion, causing different Fourier modes to propagate at different group velocities. The dissipation operator, on the other hand, damps Fourier modes at different rates.\n\nYour task is to find the specific value of the dissipation parameter $\\epsilon_d$ for which the e-folding damping time of the Fourier mode with grid wavenumber $\\theta = k \\Delta x = \\pi/2$ is equal to the time it takes for a wave packet to travel a distance of one grid spacing, $\\Delta x$, at the maximum possible magnitude of the group velocity allowed by the numerical advection scheme.", "solution": "1. The Fourier symbol of the fourth-order centered derivative operator $D_x$ is $i a(\\theta)$, where the modified wavenumber is:\n$$\na(\\theta) = \\frac{8\\sin\\theta-\\sin2\\theta}{6\\Delta x}.\n$$\n\n2. The dispersion relation from the advection term is $\\omega(k) = -c a(\\theta) = -\\frac{c}{6\\Delta x}(8\\sin\\theta-\\sin2\\theta)$, where $\\theta=k\\Delta x$.\n\n3. The group velocity is $v_g = \\frac{d\\omega}{dk} = \\Delta x \\frac{d\\omega}{d\\theta}$:\n$$\nv_g(\\theta) = -c\\,\\frac{d}{d\\theta}\\left(\\frac{8\\sin\\theta-\\sin2\\theta}{6}\\right) = -c\\,\\frac{4\\cos\\theta-\\cos2\\theta}{3}.\n$$\nLet $x=\\cos\\theta$. The function to maximize is $|-2x^2+4x+1|$ on $x\\in[-1,1]$. The extrema are at $x=1$ (value is 3) and $x=-1$ (value is -5). Hence, the maximum group velocity magnitude is $|v_g|_{\\max} = \\frac{5c}{3}$.\n\n4. The advection time across one grid spacing is:\n$$\nt_{\\text{adv}} = \\frac{\\Delta x}{|v_g|_{\\max}} = \\frac{3\\Delta x}{5c}.\n$$\n\n5. The Fourier symbol of the dissipation operator $(D_+ D_-)^3$ is $[-2(1-\\cos\\theta)]^3 = -8(1-\\cos\\theta)^3$. The semi-discrete equation with only dissipation is $\\frac{du_j}{dt} = (Qu)_j$, which in Fourier space becomes $\\frac{d\\hat{u}}{dt} = -\\gamma(\\theta)\\hat{u}$, where the damping rate is:\n$$\n\\gamma(\\theta) = \\frac{8\\epsilon_d c}{\\Delta x}(1-\\cos\\theta)^3.\n$$\nThe e-folding damping time is $\\tau(\\theta) = 1/\\gamma(\\theta)$. At $\\theta=\\pi/2$, $\\cos\\theta=0$, so the time is $\\tau(\\pi/2) = \\frac{\\Delta x}{8\\epsilon_d c}$.\n\n6. Equating the damping time to the advection time:\n$$\n\\tau(\\pi/2) = t_{\\text{adv}} \\implies \\frac{\\Delta x}{8\\epsilon_d c} = \\frac{3\\Delta x}{5c} \\implies \\epsilon_d = \\frac{5}{24}.\n$$", "answer": "$$\\boxed{\\frac{5}{24}}$$", "id": "910026"}, {"introduction": "Before evolving spacetime forward in time, a numerical relativist must first construct a valid initial \"snapshot\" that self-consistently satisfies Einstein's constraint equations. This task typically involves solving a set of coupled, non-linear elliptic equations on a spatial slice. This problem provides a concrete look into the implementation of a spectral solver for the Lichnerowicz-York equation, a standard and powerful method for generating black hole initial data. By calculating a specific element of the discretized differential operator, you will practice the key steps of coordinate transformation and operator representation that are central to the application of these highly accurate numerical techniques [@problem_id:910030].", "problem": "In the context of constructing initial data for a binary black hole merger, one must solve the Einstein constraint equations on a 3-dimensional spatial slice. The Lichnerowicz-York (LY) method provides a powerful way to solve these equations. For a vacuum spacetime with a conformally flat, maximally sliced ($K=0$) initial slice, the Hamiltonian constraint reduces to a non-linear elliptic equation for the conformal factor $\\psi$, which relates the physical metric $g_{ij}$ and the flat conformal metric $\\delta_{ij}$ via $g_{ij} = \\psi^4 \\delta_{ij}$.\n\nThe LY equation for a single black hole with linear momentum $P^i$ (a Bowen-York black hole) is given by:\n$$ \\nabla^2 \\psi + \\frac{1}{8} \\left(\\hat{A}_{ij}\\hat{A}^{ij}\\right) \\psi^{-7} = 0 $$\nwhere $\\nabla^2$ is the flat-space Laplacian, and $\\hat{A}_{ij}$ is the conformally related extrinsic curvature. For a boost of magnitude $P$ along the z-axis, the source term is $\\hat{A}_{ij}\\hat{A}^{ij} = \\frac{9P^2}{2r^4}(1+\\cos^2\\theta)$, where $r$ is the isotropic radial coordinate and $\\theta$ is the polar angle.\n\nTo solve this equation numerically, we often linearize it around an approximate solution $\\psi_0$, by setting $\\psi = \\psi_0 + \\delta\\psi$. This yields a linear elliptic equation for the correction $\\delta\\psi$:\n$$ L[\\delta\\psi] \\equiv \\nabla^2(\\delta\\psi) - \\frac{7}{8}\\left(\\hat{A}_{ij}\\hat{A}^{ij}\\right)\\psi_0^{-8}\\delta\\psi = -\\left( \\nabla^2 \\psi_0 + \\frac{1}{8} \\hat{A}_{ij}\\hat{A}^{ij} \\psi_0^{-7}\\right) $$\nFor simplicity, we approximate the background solution at large radii by $\\psi_0=1$. The problem is typically solved by expanding $\\delta\\psi$ in spherical harmonics, $\\delta\\psi(r, \\theta) = \\sum_l \\phi_l(r) Y_{l0}(\\theta)$ (assuming axisymmetry). The operator $L$ then becomes a matrix operator in the basis of spherical harmonics.\n\nConsider the diagonal part of this operator, $L_0$, acting on the spherically symmetric ($l=0$) radial function $\\phi_0(r)$. This operator is obtained by taking the spherical average of the potential term:\n$$ L_0[\\phi_0(r)] = \\left(\\frac{d^2}{dr^2} + \\frac{2}{r}\\frac{d}{dr}\\right)\\phi_0(r) - V_0(r)\\phi_0(r) $$\nwhere $V_0(r)$ is the spherical average of $\\frac{7}{8}(\\hat{A}_{ij}\\hat{A}^{ij})\\psi_0^{-8}|_{\\psi_0=1}$.\n\nThe problem is posed on the domain exterior to a sphere of radius $A$, i.e., $r \\in [A, \\infty)$. We compactify this domain using the coordinate transformation $r(x) = \\frac{2A}{1+x}$, which maps $r \\in [A, \\infty)$ to the computational domain $x \\in [1, -1]$. The radial function $\\phi_0(x)$ is then approximated by a truncated sum of Chebyshev polynomials, $\\phi_0(x) \\approx \\sum_{k=0}^N c_k T_k(x)$. The equation is enforced at a set of collocation points, which for a basis of order $N$ are the Chebyshev-Gauss-Lobatto points $x_j = \\cos(j\\pi/N)$ for $j=0, \\dots, N$.\n\nThis procedure transforms the differential equation into a matrix equation $M \\cdot \\vec{c} = \\vec{s}$, where the matrix elements of the operator are given by $M_{jk} = L_0[T_k(x)]|_{x=x_j}$.\n\n**Your task is to calculate the matrix element $M_{23}$ for a basis of order $N=3$.**", "solution": "1. The basis function is the Chebyshev polynomial $T_3(x)=4x^3-3x$. Its derivatives are $T_3'(x)=12x^2-3$ and $T_3''(x)=24x$.\n\n2. The coordinate map is $r(x)=\\frac{2A}{1+x}$, so $x(r) = \\frac{2A}{r}-1$. The derivative is $\\frac{dx}{dr}=-\\frac{2A}{r^2}$.\n\n3. For a function $\\phi(r) = \\phi(x(r))$, the chain rule gives the radial derivatives:\n$\\frac{d\\phi}{dr} = \\frac{d\\phi}{dx}\\frac{dx}{dr} = -\\frac{2A}{r^2}\\frac{d\\phi}{dx}$\n$\\frac{d^2\\phi}{dr^2} = \\frac{d}{dr}\\left(-\\frac{2A}{r^2} \\frac{d\\phi}{dx}\\right) = \\frac{4A}{r^3}\\frac{d\\phi}{dx} + \\frac{4A^2}{r^4}\\frac{d^2\\phi}{dx^2}$.\n\n4. Substituting into the operator $L_0[\\phi] = \\frac{d^2\\phi}{dr^2} + \\frac{2}{r}\\frac{d\\phi}{dr} - V_0\\phi$ gives:\n$L_0[\\phi] = \\left(\\frac{4A^2}{r^4}\\frac{d^2\\phi}{dx^2} + \\frac{4A}{r^3}\\frac{d\\phi}{dx}\\right) + \\frac{2}{r}\\left(-\\frac{2A}{r^2}\\frac{d\\phi}{dx}\\right) - V_0\\phi = \\frac{4A^2}{r^4}\\frac{d^2\\phi}{dx^2} - V_0(r)\\phi$.\n\n5. The potential $V_0(r)$ is the spherical average of $\\frac{7}{8}\\hat{A}_{ij}\\hat{A}^{ij}$. With $\\langle 1+\\cos^2\\theta\\rangle = 4/3$, we get $\\langle \\hat{A}_{ij}\\hat{A}^{ij} \\rangle = \\frac{9P^2}{2r^4}\\frac{4}{3} = \\frac{6P^2}{r^4}$. So, $V_0(r) = \\frac{7}{8} \\frac{6P^2}{r^4} = \\frac{21P^2}{4r^4}$.\n\n6. For $N=3$, the collocation point is $x_2 = \\cos(2\\pi/3) = -1/2$. At this point, the radius is $r(x_2) = \\frac{2A}{1-1/2} = 4A$.\nThe basis function and its second derivative evaluate to $T_3(x_2)=1$ and $T_3''(x_2)=24(-1/2)=-12$.\n\n7. Substitute these values to find the matrix element $M_{23} = L_0[T_3(x)]|_{x=x_2}$:\n$M_{23} = \\frac{4A^2}{r(x_2)^4} T_3''(x_2) - V_0(r(x_2)) T_3(x_2)$\n$M_{23} = \\frac{4A^2}{(4A)^4}(-12) - \\frac{21P^2}{4(4A)^4}(1) = \\frac{-48A^2}{256A^4} - \\frac{21P^2}{1024A^4}$\n$M_{23} = -\\frac{3}{16A^2} - \\frac{21P^2}{1024A^4}$.", "answer": "$$\\boxed{-\\frac{3}{16A^2} - \\frac{21P^2}{1024A^4}}$$", "id": "910030"}]}