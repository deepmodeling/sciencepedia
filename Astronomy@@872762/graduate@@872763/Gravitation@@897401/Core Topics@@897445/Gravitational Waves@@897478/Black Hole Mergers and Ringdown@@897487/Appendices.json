{"hands_on_practices": [{"introduction": "Before delving into the complex mathematics of quasi-normal modes, a powerful first step in understanding any physical phenomenon is to determine its characteristic scales. This exercise utilizes the fundamental tool of dimensional analysis to derive the natural timescale for a perturbed black hole to settle down. By combining the black hole's mass $M$, the gravitational constant $G$, and the speed of light $c$, you will uncover the fundamental tempo of black hole ringdown, providing an essential physical intuition for all subsequent analysis [@problem_id:1890737].", "problem": "Following a cataclysmic event, such as a merger with another compact object, a non-rotating black hole of mass $M$ becomes distorted. It then radiates energy in the form of gravitational waves, eventually settling into its final, quiescent spherical state. This process is known as black hole \"ringdown,\" analogous to a struck bell radiating sound as its vibrations decay.\n\nBased on fundamental principles, derive a symbolic expression for the characteristic time scale, $\\tau$, of this ringdown process. Your expression should be formulated exclusively in terms of the black hole's mass $M$, the gravitational constant $G$, and the speed of light in vacuum $c$.", "solution": "A non-rotating (Schwarzschild) black hole in vacuum is fully characterized by its mass $M$. In general relativity, for such a system there are no additional length or time scales beyond those that can be formed from $M$, the gravitational constant $G$, and the speed of light $c$. The ringdown is governed by quasi-normal modes whose frequencies and damping times are set by the near-horizon curvature scale, so the characteristic time $\\tau$ must be constructed from $G$, $M$, and $c$ by dimensional analysis.\n\nSeek a combination of the form $G^{a} M^{b} c^{d}$ with dimensions of time. Using base dimensions for mass $\\mathcal{M}$, length $L$, and time $T$,\n$$\n[G] = L^{3}\\mathcal{M}^{-1} T^{-2}, \\quad [M] = \\mathcal{M}, \\quad [c] = L T^{-1}.\n$$\nThus,\n$$\n[G^{a} M^{b} c^{d}] = L^{3a + d} \\mathcal{M}^{-a + b} T^{-2a - d}.\n$$\nRequiring this to have the dimensions of time, i.e., $L^{0}\\mathcal{M}^{0}T^{1}$, yields the system\n$$\n3a + d = 0, \\quad -a + b = 0, \\quad -2a - d = 1.\n$$\nSolving, one finds\n$$\na = 1, \\quad b = 1, \\quad d = -3,\n$$\nso the unique timescale (up to a dimensionless factor) is\n$$\n\\tau \\propto \\frac{G M}{c^{3}}.\n$$\nThis matches the physical intuition that the ringdown timescale is set by the light-crossing time of the gravitational radius, with $r_{s} = \\frac{2GM}{c^{2}}$ implying a light-crossing time $t_{\\text{lc}} = \\frac{r_{s}}{c} = \\frac{2GM}{c^{3}}$, i.e., of the same order as $\\frac{GM}{c^{3}}$. Detailed perturbation theory fixes a specific dimensionless coefficient for a given quasi-normal mode, but from fundamental principles and dimensional reasoning the characteristic timescale is set by\n$$\n\\tau = \\frac{G M}{c^{3}},\n$$\nup to a dimensionless factor of order unity that depends on the mode.", "answer": "$$\\boxed{\\frac{G M}{c^{3}}}$$", "id": "1890737"}, {"introduction": "The precise mathematical form of a gravitational wave signal encodes deep truths about its source. This practice explores how the ringdown signal can be a powerful tool for testing fundamental physics, such as the weak cosmic censorship conjecture. By contrasting the expected exponential decay of a black hole's quasi-normal modes with a hypothetical power-law decay from a naked singularity, you will quantify a key observational difference and appreciate how gravitational wave astronomy probes the nature of spacetime itself [@problem_id:1858156].", "problem": "According to the weak cosmic censorship conjecture in general relativity, singularities formed from gravitational collapse must be hidden within an event horizon, resulting in a black hole. The final state of such a black hole is a Kerr black hole, characterized only by its mass and spin. The gravitational wave (GW) signal from the formation of a Kerr black hole is expected to end with a \"ringdown\" phase, where the signal is a superposition of damped sinusoids, known as quasinormal modes.\n\nLet's consider two hypothetical scenarios for the post-merger phase of a binary compact object coalescence.\nScenario A (Black Hole): A stable Kerr black hole forms. The amplitude of the dominant GW mode's strain, $A_{BH}(t)$, decays exponentially with time $t$ after the merger, following the model:\n$$A_{BH}(t) = A_0 \\exp(-t/\\tau)$$\nwhere $A_0$ is the initial amplitude at $t=0$, and $\\tau$ is the characteristic damping timescale of the fundamental quasinormal mode.\n\nScenario B (Naked Singularity): The collapse violates cosmic censorship and forms a naked singularity. Such an object, lacking a horizon, is hypothesized to interact with surrounding fields in a complex manner, leading to a much slower decay of its GW signal. A simplified model for the amplitude of its dominant GW signal, $A_{NS}(t)$, is a power-law decay:\n$$A_{NS}(t) = A_0 \\left(1 + \\frac{t}{t_0}\\right)^{-\\gamma}$$\nwhere $t_0$ is a characteristic timescale for the singularity, and $\\gamma$ is a positive dimensionless exponent governing the decay rate. Assume the initial amplitude $A_0$ is the same as in Scenario A.\n\nTo provide an observational discriminant between these two scenarios, a useful quantity is the signal's amplitude half-life, $t_{1/2}$, defined as the time it takes for the signal amplitude to decay to half of its initial value, $A_0/2$.\n\nCalculate the dimensionless ratio $R = \\frac{t_{1/2, NS}}{t_{1/2, BH}}$, where $t_{1/2, NS}$ is the half-life for the naked singularity scenario and $t_{1/2, BH}$ is the half-life for the black hole scenario. Express your answer as a symbolic expression in terms of $\\tau$, $t_0$, and $\\gamma$.", "solution": "The amplitude half-life $t_{1/2}$ is defined by the condition that the amplitude equals $A_{0}/2$.\n\nFor Scenario A (Black Hole), the amplitude is $A_{BH}(t)=A_{0}\\exp(-t/\\tau)$. Setting $A_{BH}(t_{1/2,BH})=A_{0}/2$ gives\n$$\nA_{0}\\exp\\!\\left(-\\frac{t_{1/2,BH}}{\\tau}\\right)=\\frac{A_{0}}{2}.\n$$\nDividing both sides by $A_{0}$ yields\n$$\n\\exp\\!\\left(-\\frac{t_{1/2,BH}}{\\tau}\\right)=\\frac{1}{2}.\n$$\nTaking the natural logarithm and solving for $t_{1/2,BH}$,\n$$\n-\\frac{t_{1/2,BH}}{\\tau}=\\ln\\!\\left(\\frac{1}{2}\\right)=-\\ln 2\n\\quad\\Rightarrow\\quad\nt_{1/2,BH}=\\tau\\ln 2.\n$$\n\nFor Scenario B (Naked Singularity), the amplitude is $A_{NS}(t)=A_{0}\\left(1+\\frac{t}{t_{0}}\\right)^{-\\gamma}$. Setting $A_{NS}(t_{1/2,NS})=A_{0}/2$ gives\n$$\nA_{0}\\left(1+\\frac{t_{1/2,NS}}{t_{0}}\\right)^{-\\gamma}=\\frac{A_{0}}{2}.\n$$\nDividing both sides by $A_{0}$ and inverting both sides,\n$$\n\\left(1+\\frac{t_{1/2,NS}}{t_{0}}\\right)^{\\gamma}=2.\n$$\nTaking both sides to the power $1/\\gamma$ and solving for $t_{1/2,NS}$,\n$$\n1+\\frac{t_{1/2,NS}}{t_{0}}=2^{1/\\gamma}\n\\quad\\Rightarrow\\quad\nt_{1/2,NS}=t_{0}\\left(2^{1/\\gamma}-1\\right).\n$$\n\nThe required ratio is\n$$\nR=\\frac{t_{1/2,NS}}{t_{1/2,BH}}=\\frac{t_{0}\\left(2^{1/\\gamma}-1\\right)}{\\tau\\ln 2}.\n$$", "answer": "$$\\boxed{\\frac{t_{0}}{\\tau}\\,\\frac{2^{1/\\gamma}-1}{\\ln 2}}$$", "id": "1858156"}, {"introduction": "This final practice brings together theory and data analysis in a comprehensive computational experiment. You will simulate the ringdown signals from two distinct merger events that, according to the \"no-hair\" theorem, should result in identical final black holes. By fitting a model to this simulated noisy data and inferring the final mass and spin, you will perform a direct test of this cornerstone theorem of general relativity, experiencing firsthand how gravitational wave observations can provide high-precision tests of fundamental physics [@problem_id:2399211].", "problem": "You will design and implement a computational experiment to test the black hole \"no-hair\" theorem in the ringdown phase of gravitational waves from compact binary mergers. The no-hair theorem asserts that the exterior spacetime of an astrophysical black hole is completely characterized by a small set of macroscopic parameters. For astrophysically realistic scenarios with negligible electrical charge, these are the final black hole mass and dimensionless spin. In the ringdown regime following a merger, gravitational perturbations are well described by superpositions of damped sinusoids called quasi-normal modes, whose frequencies and damping times depend only on the final mass and spin.\n\nStart from the following fundamental base:\n- In linear perturbation theory of a Kerr black hole, the perturbations obey a separable wave equation, and the late-time signal is a superposition of damped sinusoids (quasi-normal modes). Dimensional analysis implies that for a fixed dimensionless spin, the quasi-normal mode frequencies scale inversely with the black hole mass. The definition of quality factor relates the real frequency and damping time.\n- Use the leading quasi-normal mode with spherical-harmonic indices $(\\ell, m, n) = (2, 2, 0)$ as the signal model for each event, modeled in the time domain as $h(t) = A \\exp(-t/\\tau) \\cos(2 \\pi f t + \\phi)$ for $t \\ge 0$, where $A$ is an overall amplitude, $f$ is the real frequency in hertz, $\\tau$ is the damping time in seconds, and $\\phi$ is a constant phase in radians.\n- Use the well-tested fitting functions for the dimensionless angular frequency and quality factor of the $(2, 2, 0)$ mode, expressed as functions of the dimensionless spin $\\chi \\in [0, 1)$:\n  $$M \\omega_{22}(\\chi) = 1.5251 - 1.1568 \\left(1 - \\chi\\right)^{0.1292},$$\n  $$Q_{22}(\\chi) = 0.7000 + 1.4187 \\left(1 - \\chi\\right)^{-0.4990}.$$\n  Here $M \\omega_{22}$ is the dimensionless angular frequency (geometric units with $G = c = 1$). Convert from dimensionless quantities to physical units using\n  $$f = \\frac{c^3}{2 \\pi G M} \\left(M \\omega_{22}(\\chi)\\right), \\quad \\tau = \\frac{Q_{22}(\\chi)}{\\pi f},$$\n  with $G$ the gravitational constant, $c$ the speed of light, and $M$ the final black hole mass. Use $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m}^3\\ \\mathrm{kg}^{-1}\\ \\mathrm{s}^{-2}$, $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$, and the solar mass $M_{\\odot} = 1.98847 \\times 10^{30}\\ \\mathrm{kg}$. Express masses in units of $M_{\\odot}$ and times in seconds; angles are in radians.\n\nYour task:\n- Simulate, for each test case below, two independent ringdown signals (two different merger events) with potentially different amplitudes and phases, but with the specified final mass and spin parameters for each event in the pair. Each signal is a single $(2, 2, 0)$ damped sinusoid beginning at $t = 0$ with additive zero-mean Gaussian white noise. Use a sampling frequency $f_{\\mathrm{s}} = 4096\\ \\mathrm{Hz}$ and a total duration $T = 0.1\\ \\mathrm{s}$. The noise standard deviation is a given parameter in units of the strain amplitude. Angles must be treated in radians.\n- For each event, estimate the mode parameters $(f, \\tau)$ by fitting the noisy time series to the single damped sinusoid model. Then use the measured $(f, \\tau)$ to infer the final dimensionless spin $\\chi$ and mass $M$ as follows: compute the measured quality factor $Q_{\\mathrm{meas}} = \\pi f \\tau$ and invert $Q_{22}(\\chi)$ to determine $\\chi$; then use the measured $f$ and the inferred $\\chi$ to compute $M$ from the frequency scaling relation. Report $M$ in units of $M_{\\odot}$.\n- Devise a no-hair consistency decision for each test case, defined as follows: given the two inferences $(M_1, \\chi_1)$ and $(M_2, \\chi_2)$ from the two events, return true if both the fractional mass difference satisfies $\\lvert M_1 - M_2 \\rvert / \\left( \\frac{M_1 + M_2}{2} \\right) \\le 0.02$ and the absolute spin difference satisfies $\\lvert \\chi_1 - \\chi_2 \\rvert \\le 0.02$, and false otherwise.\n\nPhysical units and angle units requirement:\n- Frequencies must be in hertz, times in seconds, masses reported in $M_{\\odot}$, and angles interpreted in radians at all stages.\n\nTest suite:\n- Use the following three cases, each defined by a pair of events with parameters $(M/M_{\\odot}, \\chi, A, \\phi, \\sigma)$ where $M$ is the final mass in $M_{\\odot}$, $\\chi$ is the dimensionless spin, $A$ is the amplitude, $\\phi$ is the phase in radians, and $\\sigma$ is the standard deviation of the Gaussian white noise:\n  - Case $1$:\n    - Event $\\mathrm{A1}$: $(60, 0.70, 1.0, 0.3, 1.0 \\times 10^{-3})$,\n    - Event $\\mathrm{A2}$: $(60, 0.70, 0.7, 2.1, 1.0 \\times 10^{-3})$.\n  - Case $2$:\n    - Event $\\mathrm{B1}$: $(60, 0.70, 1.0, 1.0, 1.0 \\times 10^{-3})$,\n    - Event $\\mathrm{B2}$: $(60, 0.65, 0.8, 2.3, 1.0 \\times 10^{-3})$.\n  - Case $3$:\n    - Event $\\mathrm{C1}$: $(60, 0.70, 1.0, 0.1, 1.0 \\times 10^{-3})$,\n    - Event $\\mathrm{C2}$: $(58, 0.70, 0.9, 1.7, 1.0 \\times 10^{-3})$.\n\nProgram requirements:\n- Implement a complete, runnable program that performs the simulation, parameter estimation, inversion from $(f, \\tau)$ to $(\\chi, M)$, and the final no-hair consistency decision for each of the three cases described above.\n- Deterministic noise is required to ensure reproducibility; use a fixed random number generator seed of your choice and document it in the code.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, \"[true,false,true]\" but with the actual Python boolean capitalization and no spaces. The output must be a list of three boolean values corresponding to the three cases, in order.\n\nDeliverables:\n- A self-contained program that, without user input, simulates the signals, performs the estimation and inversion, and outputs a single line as specified.", "solution": "The problem statement has been critically examined and is determined to be valid. It constitutes a well-posed, scientifically grounded computational experiment in the field of gravitational-wave physics. It is free of contradiction, ambiguity, and factual error. The task is to simulate a test of the black hole no-hair theorem, which is a cornerstone of general relativity, using a standard and simplified model of the ringdown phase of a binary merger. All necessary physical constants, mathematical models, and numerical parameters are provided. We may therefore proceed with the solution.\n\nThe solution is structured as a computational procedure that encompasses signal simulation, parameter estimation, and a final consistency test based on the principles of black hole perturbation theory.\n\nFirst, we establish the theoretical foundation. The no-hair theorem posits that a stationary, isolated, uncharged black hole is completely described by its mass $M$ and spin angular momentum $J$. The dimensionless spin parameter is defined as $\\chi = cJ/(GM^2)$, with $\\chi \\in [0, 1)$. Perturbations of the Kerr spacetime geometry, such as those produced in the aftermath of a binary merger, radiate away as gravitational waves. In the late-time ringdown phase, the signal is a superposition of quasi-normal modes (QNMs), each being a damped sinusoid. The frequencies and damping times of these modes are predicted by linear perturbation theory to depend only on the final black hole's mass $M$ and spin $\\chi$.\n\nFor this problem, we model the dominant $(\\ell, m, n) = (2, 2, 0)$ QNM. Its time-domain representation is given by:\n$$h(t) = A e^{-t/\\tau} \\cos(2 \\pi f t + \\phi)$$\nwhere $A$ is the amplitude, $f$ is the frequency, $\\tau$ is the damping time, and $\\phi$ is the phase. The parameters $f$ and $\\tau$ are not independent but are determined by $(M, \\chi)$. The problem provides phenomenological fitting formulas for the dimensionless angular frequency $M\\omega_{22}(\\chi)$ and quality factor $Q_{22}(\\chi)$:\n$$M \\omega_{22}(\\chi) = 1.5251 - 1.1568 (1 - \\chi)^{0.1292}$$\n$$Q_{22}(\\chi) = 0.7000 + 1.4187 (1 - \\chi)^{-0.4990}$$\nThese dimensionless quantities are converted to physical observables using fundamental constants $G$ and $c$:\n$$f = \\frac{c^3}{2 \\pi G M} \\left(M \\omega_{22}(\\chi)\\right)$$\n$$\\tau = \\frac{Q_{22}(\\chi)}{\\pi f}$$\nHere, $M$ is the mass in kilograms. When providing mass in units of solar mass $M_{\\odot}$, the proper conversion must be applied. Let $M_{sol} = M/M_{\\odot}$. The frequency equation can be written as $f = C_f \\frac{M\\omega_{22}(\\chi)}{M_{sol}}$, where $C_f = \\frac{c^3}{2 \\pi G M_{\\odot}}$ is a constant.\n\nThe computational experiment consists of the following steps:\n\n1.  **Signal Generation (Forward Problem)**: For each event specified in a test case, we first compute the theoretical values of $f$ and $\\tau$ from the given \"true\" parameters $(M, \\chi)$. The mass $M$ given in solar masses must be converted to kilograms for this calculation. A discrete time series is then generated for a duration $T = 0.1 \\text{ s}$ with a sampling rate $f_s = 4096 \\text{ Hz}$. This involves creating a time vector $t_k = k/f_s$ for $k = 0, 1, ..., N-1$, where $N = T f_s$. The clean signal $h(t_k)$ is calculated at these time points. Finally, zero-mean Gaussian white noise is added. The noise is generated using a fixed random seed for reproducibility, with its standard deviation $\\sigma$ given in the test case parameters.\n\n2.  **Parameter Estimation (Inverse Problem, Part 1)**: The core of the analysis is to estimate the signal parameters from the noisy data. We fit the generated time series data to the four-parameter model $h(t; A, f, \\tau, \\phi)$. This is a non-linear least-squares fitting problem, for which we employ the Levenberg-Marquardt algorithm, as implemented in `scipy.optimize.curve_fit`. The success of such a fit depends critically on providing reasonable initial guesses for the parameters $(A, f, \\tau, \\phi)$. An initial guess for the amplitude $A$ can be the maximum absolute value of the data. Based on the problem's physical parameters, an initial frequency of $f \\approx 280\\ \\mathrm{Hz}$ and damping time $\\tau \\approx 4\\ \\mathrm{ms}$ are appropriate. The phase can be initialized to $0$. The fit yields the estimated parameters $(f_{meas}, \\tau_{meas})$.\n\n3.  **Inference of Black Hole Parameters (Inverse Problem, Part 2)**: With the measured $(f_{meas}, \\tau_{meas})$, we test the no-hair hypothesis by inverting the relations to infer the black hole parameters $(M_{inf}, \\chi_{inf})$.\n    *   First, the measured quality factor is computed: $Q_{meas} = \\pi f_{meas} \\tau_{meas}$.\n    *   Next, we solve for the spin $\\chi$ from the equation $Q_{meas} = Q_{22}(\\chi)$. This equation can be analytically inverted:\n        $$\\chi_{inf} = 1 - \\left( \\frac{Q_{meas} - 0.7000}{1.4187} \\right)^{-1/0.4990}$$\n        It is necessary to respect the physical domain $\\chi \\in [0, 1)$. The function $Q_{22}(\\chi)$ has a minimum value at $\\chi=0$, which is $Q_{22}(0) \\approx 2.1187$. If measurement noise results in $Q_{meas} < Q_{22}(0)$, the formula would yield an unphysical negative spin. In such cases, the inferred spin must be clipped to $\\chi_{inf} = 0$, the closest physical value.\n    *   With the inferred spin $\\chi_{inf}$, we then compute the theoretical dimensionless frequency $M\\omega_{22}(\\chi_{inf})$.\n    *   Finally, we invert the frequency relation to solve for the mass $M_{inf}$. The mass in solar units is given by:\n        $$M_{inf}/M_{\\odot} = \\left(\\frac{c^3}{2 \\pi G M_{\\odot}}\\right) \\frac{M\\omega_{22}(\\chi_{inf})}{f_{meas}}$$\n\n4.  **No-Hair Consistency Decision**: This procedure is performed for both events in a given test case, yielding two sets of inferred parameters: $(M_1, \\chi_1)$ and $(M_2, \\chi_2)$. According to the no-hair theorem, if both signals originated from black holes with identical mass and spin, the inferred parameters should be consistent within statistical uncertainty. The problem defines a specific quantitative test for this consistency: the result is `true` if and only if both the fractional mass difference and the absolute spin difference are below specified thresholds:\n    $$\\frac{|M_1 - M_2|}{\\frac{1}{2}(M_1 + M_2)} \\le 0.02 \\quad \\text{and} \\quad |\\chi_1 - \\chi_2| \\le 0.02$$\n    Otherwise, the result is `false`.\n\nThis entire sequence is implemented for each of the three test cases. The final output is a list of three boolean values corresponding to the consistency check for each case.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Simulates a test of the black hole no-hair theorem for binary merger ringdowns.\n    \"\"\"\n    # Physical constants\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    C = 2.99792458e8  # m s^-1\n    M_SUN = 1.98847e30  # kg\n\n    # Simulation parameters\n    FS = 4096.0  # Hz\n    T = 0.1  # s\n    MAIN_SEED = 42 # For reproducibility of noise\n\n    # Test cases: (M/M_solar, chi, Amplitude, phase_rad, noise_std)\n    test_cases = [\n        # Case 1\n        [\n            (60.0, 0.70, 1.0, 0.3, 1.0e-3),\n            (60.0, 0.70, 0.7, 2.1, 1.0e-3)\n        ],\n        # Case 2\n        [\n            (60.0, 0.70, 1.0, 1.0, 1.0e-3),\n            (60.0, 0.65, 0.8, 2.3, 1.0e-3)\n        ],\n        # Case 3\n        [\n            (60.0, 0.70, 1.0, 0.1, 1.0e-3),\n            (58.0, 0.70, 0.9, 1.7, 1.0e-3)\n        ]\n    ]\n\n    # Pre-calculated constant for frequency conversion\n    # CF = c^3 / (2 * pi * G * M_sun)\n    CF = C**3 / (2 * np.pi * G * M_SUN)\n\n    def M_omega_22(chi):\n        \"\"\"Dimensionless angular frequency of the (2,2,0) mode.\"\"\"\n        return 1.5251 - 1.1568 * (1 - chi)**0.1292\n\n    def Q_22(chi):\n        \"\"\"Quality factor of the (2,2,0) mode.\"\"\"\n        return 0.7000 + 1.4187 * (1 - chi)**-0.4990\n\n    def model_func(t, A, f, tau, phi):\n        \"\"\"Damped sinusoid model for fitting.\"\"\"\n        return A * np.exp(-t / tau) * np.cos(2 * np.pi * f * t + phi)\n\n    def analyze_event(event_params, event_seed):\n        \"\"\"\n        Generates a noisy signal, fits it, and infers (M, chi).\n        \"\"\"\n        M_sol, chi, A, phi, sigma = event_params\n        \n        # 1. Forward model: Calculate true f and tau\n        f_true = CF * M_omega_22(chi) / M_sol\n        q_true = Q_22(chi)\n        tau_true = q_true / (np.pi * f_true)\n\n        # 2. Generate signal\n        t = np.arange(0, T, 1.0 / FS)\n        h_clean = model_func(t, A, f_true, tau_true, phi)\n        \n        rng = np.random.default_rng(event_seed)\n        noise = rng.normal(0, sigma, len(t))\n        h_noisy = h_clean + noise\n\n        # 3. Parameter estimation\n        # Initial guesses for the fit\n        p0 = [np.max(np.abs(h_noisy)), f_true, tau_true, phi]\n        bounds = ([0, 0, 0, -np.pi], [np.inf, FS / 2, np.inf, np.pi])\n        \n        try:\n            popt, _ = curve_fit(model_func, t, h_noisy, p0=p0, bounds=bounds, maxfev=5000)\n            f_meas, tau_meas = popt[1], popt[2]\n        except RuntimeError:\n            return np.nan, np.nan # Fit failed\n\n        # 4. Inversion to (M, chi)\n        Q_meas = np.pi * f_meas * tau_meas\n        \n        # Invert Q_22(chi) to find chi\n        # chi = 1 - ((Q_meas - 0.7) / 1.4187)^(-1/0.4990)\n        q_arg = (Q_meas - 0.7000) / 1.4187\n        \n        # The minimum physical Q corresponds to chi=0, where q_arg = 1.\n        # If noise causes Q_meas to be too low, q_arg < 1, which implies chi < 0.\n        # We clip to the physical boundary chi=0.\n        if q_arg <= 1.0:\n            chi_inf = 0.0\n        else:\n            chi_inf = 1.0 - q_arg**(-1.0 / 0.4990)\n        \n        # Invert frequency relation for M\n        m_omega_val = M_omega_22(chi_inf)\n        M_inf_sol = CF * m_omega_val / f_meas\n        \n        return M_inf_sol, chi_inf\n\n    results = []\n    event_seed_counter = 0\n    for case in test_cases:\n        event1_params, event2_params = case\n        \n        seed1 = MAIN_SEED + event_seed_counter\n        M1, chi1 = analyze_event(event1_params, seed1)\n        event_seed_counter += 1\n        \n        seed2 = MAIN_SEED + event_seed_counter\n        M2, chi2 = analyze_event(event2_params, seed2)\n        event_seed_counter += 1\n\n        if np.isnan(M1) or np.isnan(M2):\n            is_consistent = False\n        else:\n            # 5. No-hair consistency check\n            mass_diff = np.abs(M1 - M2) / (0.5 * (M1 + M2))\n            spin_diff = np.abs(chi1 - chi2)\n            \n            is_consistent = (mass_diff <= 0.02) and (spin_diff <= 0.02)\n\n        results.append(is_consistent)\n\n    # Format output as required\n    print(f\"[{','.join(map(str, results))}]\".replace(\"True\", \"true\").replace(\"False\", \"false\"))\n\nsolve()\n```", "id": "2399211"}]}