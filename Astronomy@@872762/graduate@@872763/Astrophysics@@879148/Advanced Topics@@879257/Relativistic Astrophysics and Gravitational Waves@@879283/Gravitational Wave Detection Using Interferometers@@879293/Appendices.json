{"hands_on_practices": [{"introduction": "This problem tackles a cornerstone of terrestrial gravitational wave detection: active seismic isolation. To detect the minuscule spacetime distortions from a gravitational wave, the interferometer's test masses must be shielded from much larger terrestrial vibrations. This exercise guides you through the principles of feedback control, allowing you to derive how a proportional-integral (PI) controller actively suppresses seismic noise and stabilizes a test mass [@problem_id:217704]. Understanding this process is fundamental to appreciating how these incredibly sensitive instruments are made possible.", "problem": "In ground-based gravitational wave interferometers, the test masses that form the arms of the interferometer must be kept stable against environmental disturbances. A crucial element in achieving this is the use of feedback control systems to suppress the residual motion of the test masses, which are suspended as pendulums to provide passive seismic isolation at high frequencies.\n\nConsider a simplified model of such a control system. The open-loop displacement noise of a test mass, which represents the uncontrolled motion due to various disturbances, is characterized by a one-sided power spectral density (PSD) given by:\n$$\nS_x^{\\text{OL}}(f) = \\frac{A}{f^2}\n$$\nwhere $A$ is a constant representing the noise strength and $f$ is the frequency.\n\nTo counteract this motion, a negative feedback loop is implemented. The \"plant\" represents the system being controlled, which translates the control signal into a displacement. For this problem, we model the plant as a pure integrator, with a transfer function in the Laplace domain ($s$) given by:\n$$\nP(s) = \\frac{g}{s}\n$$\nwhere $g$ is the plant gain.\n\nThe controller used in the feedback loop is a proportional-integral (PI) controller, with the transfer function:\n$$\nC(s) = K_p + \\frac{K_i}{s}\n$$\nwhere $K_p$ and $K_i$ are the proportional and integral gains, respectively.\n\nThe open-loop gain of the entire system is $G(s) = P(s)C(s)$. When the feedback loop is closed, the displacement noise PSD is suppressed. The resulting closed-loop residual displacement noise PSD, $S_x^{\\text{CL}}(f)$, is related to the open-loop PSD by the formula:\n$$\nS_x^{\\text{CL}}(f) = \\frac{S_x^{\\text{OL}}(f)}{|1 + G(i2\\pi f)|^2}\n$$\nAssume that the feedback loop is stable.\n\nDerive the analytical expression for the closed-loop residual displacement spectrum, $S_x^{\\text{CL}}(f)$. Express your answer as a function of frequency $f$ and the symbolic constants $A$, $g$, $K_p$, and $K_i$.", "solution": "We have the following definitions:  \n1. Open‐loop displacement noise PSD  \n$$S_x^{\\rm OL}(f)=\\frac{A}{f^2}.$$  \n2. Plant transfer function  \n$$P(s)=\\frac{g}{s}.$$  \n3. PI controller transfer function  \n$$C(s)=K_p+\\frac{K_i}{s}.$$  \n4. Open‐loop gain  \n$$G(s)=P(s)\\,C(s)=\\frac{g}{s}\\Bigl(K_p+\\frac{K_i}{s}\\Bigr)\n=\\frac{gK_p}{s}+\\frac{gK_i}{s^2}.$$  \nEvaluate at $s=i\\omega$ with $\\omega=2\\pi f$:  \n$$G(i2\\pi f)=\\frac{gK_p}{i\\omega}+\\frac{gK_i}{(i\\omega)^2}\n=-\\,\\frac{gK_i}{\\omega^2}-i\\,\\frac{gK_p}{\\omega}.$$  \nThus  \n$$1+G(i2\\pi f)\n=\\Bigl(1-\\frac{gK_i}{\\omega^2}\\Bigr)-i\\,\\frac{gK_p}{\\omega},$$  \nand its magnitude squared is  \n$$\\bigl|1+G(i2\\pi f)\\bigr|^2\n=\\Bigl(1-\\frac{gK_i}{\\omega^2}\\Bigr)^2+\\Bigl(\\frac{gK_p}{\\omega}\\Bigr)^2.$$\nThe closed‐loop residual PSD is  \n$$S_x^{\\rm CL}(f)\n=\\frac{S_x^{\\rm OL}(f)}{\\bigl|1+G(i2\\pi f)\\bigr|^2}\n=\\frac{\\displaystyle \\frac{A}{f^2}}\n{\\displaystyle \\Bigl(1-\\frac{gK_i}{(2\\pi f)^2}\\Bigr)^2\n+\\Bigl(\\frac{gK_p}{2\\pi f}\\Bigr)^2}\\,. $$", "answer": "$$\\boxed{\\frac{A/f^2}{\\left(1-\\frac{gK_i}{(2\\pi f)^2}\\right)^2+\\left(\\frac{gK_p}{2\\pi f}\\right)^2}}$$", "id": "217704"}, {"introduction": "An ideal, perfectly symmetric interferometer would be immune to many sources of noise. However, real instruments have small imperfections that can create pathways for noise to contaminate the gravitational-wave signal. This practice explores a classic example: how angular jitter of the input laser beam, $\\vec{\\alpha}(t)$, couples with a static misalignment of an end mirror, $\\vec{\\theta}$, to produce a spurious differential arm length signal [@problem_id:217611]. By working through this geometric optics model, you will gain a concrete understanding of why tight alignment and beam stability tolerances are essential for reaching design sensitivity.", "problem": "A ground-based gravitational-wave observatory is modeled as a Michelson interferometer. The sensitivity of such an instrument can be limited by various noise sources, including the coupling of laser pointing fluctuations (jitter) to asymmetries in the interferometer. This problem explores this coupling mechanism in the geometric optics limit.\n\nConsider a Michelson interferometer with two arms of length $L_1$ and $L_2$. The laser beam entering the interferometer has a time-varying angular jitter $\\vec{\\alpha}(t)$. This jitter describes the small, time-dependent angle between the beam's propagation direction and the interferometer's main optical axis. The laser is a Gaussian beam, and its waist (the point of its narrowest cross-section) is located at a distance $z_w$ from the beam splitter, along the input path (a positive $z_w$ means the waist is before the beam splitter). A key principle of Gaussian beam optics is that a ray tilted by a small angle $\\vec{\\alpha}$ relative to the optical axis appears to intersect the axis at the beam waist location.\n\nThe two end mirrors of the interferometer are not perfectly aligned. They have small, static angular misalignments given by the vectors $\\vec{\\theta}_1$ and $\\vec{\\theta}_2$, respectively. For a beam whose center strikes an end mirror at a displacement $\\vec{d}$ from its center of rotation, the resulting round-trip optical path length change, $\\Delta P$, due to a small mirror tilt $\\vec{\\theta}$ is given by $\\Delta P = 2 \\vec{d} \\cdot \\vec{\\theta}$. The interferometer measures an apparent differential arm length change, $\\delta L$, which is related to the path length change by $\\delta L = \\Delta P / 2$.\n\nFor this problem, assume the jitter is only in the x-direction, so $\\vec{\\alpha}(t) = \\alpha(t) \\hat{x}$. The mirror misalignments are also pure tilts around their respective y-axes, so $\\vec{\\theta}_1 = \\theta_1 \\hat{x}$ and $\\vec{\\theta}_2 = \\theta_2 \\hat{x}$. The beam splitter is located at the origin of our coordinate system.\n\nDerive the expression for the spurious differential arm length signal, $\\delta L_{sig}(t) = \\delta L_1(t) - \\delta L_2(t)$, which is linearly proportional to the input jitter $\\alpha(t)$.", "solution": "We work in the paraxial, geometric‐optics limit.  A ray tilted by a small angle $ \\alpha(t)$ intersects the waist plane at zero transverse offset, so at a distance $s$ from the waist its transverse offset is $x = \\alpha(t)\\,s$.  Placing the beam waist a distance $z_w$ before the beam splitter (BS) and denoting the arm lengths beyond the BS by $L_1$ and $L_2$, the distances from waist to end mirrors are\n$$\ns_1 = L_1 + z_w,\\qquad\ns_2 = L_2 + z_w.\n$$\nThus the beam‐spot displacements on the two mirrors are\n$$\n\\vec d_1(t) = \\alpha(t)\\,(L_1 + z_w)\\,\\hat x,\\qquad\n\\vec d_2(t) = \\alpha(t)\\,(L_2 + z_w)\\,\\hat x.\n$$\nA small mirror tilt $\\vec\\theta = \\theta\\,\\hat x$ produces a round‐trip path change\n$$\n\\Delta P = 2\\,\\vec d\\cdot\\vec\\theta,\n$$\nand the corresponding apparent arm‐length shift is $\\delta L=\\Delta P/2=\\vec d\\cdot\\vec\\theta$.  Hence\n$$\n\\delta L_1(t) = \\alpha(t)\\,(L_1 + z_w)\\,\\theta_1,\\qquad\n\\delta L_2(t) = \\alpha(t)\\,(L_2 + z_w)\\,\\theta_2.\n$$\nSubtracting gives the spurious differential signal\n$$\n\\delta L_{sig}(t)\n= \\delta L_1(t)-\\delta L_2(t)\n= \\alpha(t)\\Bigl[(L_1 + z_w)\\,\\theta_1 - (L_2 + z_w)\\,\\theta_2\\Bigr].\n$$", "answer": "$$\\boxed{\\alpha(t)\\bigl[(L_1 + z_w)\\,\\theta_1 - (L_2 + z_w)\\,\\theta_2\\bigr]}$$", "id": "217611"}, {"introduction": "After building and controlling an interferometer, the final step is to analyze its output data, which contains a rich spectrum of instrumental noise features. Accurately modeling this noise is crucial for both instrument characterization and the search for astrophysical signals. This problem introduces you to a powerful data analysis technique, Bayesian model selection, to distinguish between competing models for a thermal noise peak in the data [@problem_id:217662]. This exercise will demonstrate how to use the Bayesian evidence, $Z$, to make a quantitative, statistically-grounded decision about the underlying physics of an observed noise feature.", "problem": "In the context of characterizing instrumental noise in gravitational-wave interferometers, a common task is to model features in the power spectral density (PSD). These features often arise from thermal noise in the mirror suspensions and can be modeled as Lorentzian peaks. Bayesian model selection is a powerful tool to determine the number of peaks required to adequately describe the data.\n\nThe preference for a model $M_2$ over a model $M_1$ is quantified by the Bayes factor, $K = Z_2/Z_1$, where $Z_i$ is the Bayesian evidence for model $M_i$. The evidence is the integral of the likelihood times the prior over the entire parameter space of the model:\n$$Z = \\int \\mathcal{L}(\\text{data}|\\theta) \\pi(\\theta) d\\theta$$\nwhere $\\theta$ is the vector of model parameters. The product in the integrand is the posterior probability distribution (up to a normalization constant). For a multi-dimensional parameter space, this integral is often evaluated using the Laplace approximation, which becomes exact if the posterior is a multivariate Gaussian. For a posterior that can be written as $P(\\theta|\\text{data}) \\propto \\exp(\\Phi(\\theta))$, the evidence is given by:\n$$Z \\approx \\exp(\\Phi(\\hat{\\theta})) (2\\pi)^{d/2} \\det(-\\nabla\\nabla\\Phi|_{\\hat{\\theta}})^{-1/2}$$\nwhere $\\hat{\\theta}$ is the location of the posterior peak (the mode), $d$ is the dimensionality of the parameter space $\\theta$, and $-\\nabla\\nabla\\Phi|_{\\hat{\\theta}}$ is the Hessian matrix of $-\\Phi$ evaluated at the peak.\n\nConsider two competing models for a feature in a PSD:\n1.  **Model $M_1$**: A single thermal peak. Its parameters are amplitude $A$ and central frequency $f$. The log-posterior for these parameters $\\theta_1 = (A,f)$ is found to be a Gaussian centered at $(A_p, f_p)$:\n    $$ \\Phi_1(A, f) = \\ln C_1 - \\frac{1}{2}\\left[\\frac{(A-A_p)^2}{\\sigma_{A0}^2} + \\frac{(f-f_p)^2}{\\sigma_{f0}^2}\\right] $$\n    where $C_1, A_p, f_p, \\sigma_{A0}, \\sigma_{f0}$ are known positive constants derived from the analysis.\n\n2.  **Model $M_2$**: Two blended thermal peaks. Its parameters are the amplitudes and frequencies of two peaks, $\\theta_2 = (A_1, f_1, A_2, f_2)$. The log-posterior is also a Gaussian, peaked at $(A_{p1}, f_{p1}, A_{p2}, f_{p2})$. Defining the deviation from the peak as $\\vec{y} = (A_1-A_{p1}, f_1-f_{p1}, A_2-A_{p2}, f_2-f_{p2})^T$, the log-posterior is given by:\n    $$ \\Phi_2(\\theta_2) = \\ln C_2 - \\frac{1}{2} \\vec{y}^T \\mathbf{\\Sigma}^{-1} \\vec{y} $$\n    Here, $C_2$ is a known positive constant, and $\\mathbf{\\Sigma}$ is the $4 \\times 4$ parameter covariance matrix. The blending of the peaks introduces correlations between their parameters. Based on physical modeling, the covariance matrix is determined to be:\n    $$ \\mathbf{\\Sigma} = \\begin{pmatrix}\n    \\sigma_A^2 & 0 & \\rho_A \\sigma_A^2 & 0 \\\\\n    0 & \\sigma_f^2 & 0 & \\rho_f \\sigma_f^2 \\\\\n    \\rho_A \\sigma_A^2 & 0 & \\sigma_A^2 & 0 \\\\\n    0 & \\rho_f \\sigma_f^2 & 0 & \\sigma_f^2\n    \\end{pmatrix} $$\n    where $\\sigma_A$ and $\\sigma_f$ are the standard deviations of the amplitude and frequency for each peak (assumed identical), and $\\rho_A$ and $\\rho_f$ are the correlation coefficients between the amplitudes and frequencies of the two peaks, respectively. All these parameters are known, with $|\\rho_A| < 1$ and $|\\rho_f| < 1$.\n\nDerive the Bayes factor $K = Z_2/Z_1$ in favor of the two-peak model.", "solution": "Relevant equations:\n1. Laplace approximation for evidence in $d$ dimensions:\n$$Z\\approx \\exp(\\Phi(\\hat\\theta))(2\\pi)^{d/2}\\det\\bigl(-\\nabla\\nabla\\Phi|_{\\hat\\theta}\\bigr)^{-1/2}.$$\n2. Model $M_1$ ($d_1=2$), log-posterior\n$$\\Phi_1=\\ln C_1-\\tfrac12\\bigl[(A-A_p)^2/\\sigma_{A0}^2+(f-f_p)^2/\\sigma_{f0}^2\\bigr],$$\nso at the peak $\\exp(\\Phi_1)=C_1$, and\n$$-\\nabla\\nabla\\Phi_1=\\mathrm{diag}(1/\\sigma_{A0}^2,1/\\sigma_{f0}^2),\\quad\n\\det(-\\nabla\\nabla\\Phi_1)=\\tfrac1{\\sigma_{A0}^2\\sigma_{f0}^2}.$$\nHence\n$$Z_1=C_1\\,(2\\pi)^{2/2}\\bigl(\\sigma_{A0}\\sigma_{f0}\\bigr)=C_1\\,(2\\pi)\\,\\sigma_{A0}\\sigma_{f0}.$$\n3. Model $M_2$ ($d_2=4$), log-posterior\n$$\\Phi_2=\\ln C_2-\\tfrac12\\,\\vec y^T\\Sigma^{-1}\\vec y,\\quad \\exp(\\Phi_2)=C_2,$$\nand \n$$-\\nabla\\nabla\\Phi_2=\\Sigma^{-1},\\qquad \n\\det(-\\nabla\\nabla\\Phi_2)=\\det(\\Sigma^{-1})=1/\\det\\Sigma.$$\nThus\n$$Z_2=C_2\\,(2\\pi)^{4/2}\\,\\det(\\Sigma)^{1/2}\n=C_2\\,(2\\pi)^{2}\\,\\det(\\Sigma)^{1/2}.$$\n4. The covariance matrix factorizes into 2×2 blocks, giving\n$$\\det\\Sigma\n=\\bigl[\\sigma_A^4(1-\\rho_A^2)\\bigr]\\bigl[\\sigma_f^4(1-\\rho_f^2)\\bigr]\n=\\sigma_A^4\\sigma_f^4\\,(1-\\rho_A^2)(1-\\rho_f^2),$$\nso\n$$\\det(\\Sigma)^{1/2}\n=\\sigma_A^2\\sigma_f^2\\sqrt{(1-\\rho_A^2)(1-\\rho_f^2)}.$$\n5. The Bayes factor $K=Z_2/Z_1$ is therefore\n$$\nK=\\frac{C_2\\,(2\\pi)^{2}\\,\\sigma_A^2\\sigma_f^2\\sqrt{(1-\\rho_A^2)(1-\\rho_f^2)}}\n{C_1\\,(2\\pi)\\,\\sigma_{A0}\\sigma_{f0}}\n=\\frac{C_2}{C_1}\\,2\\pi\\,\\frac{\\sigma_A^2\\sigma_f^2}{\\sigma_{A0}\\sigma_{f0}}\n\\sqrt{(1-\\rho_A^2)(1-\\rho_f^2)}.\n$$", "answer": "$$\\boxed{\\frac{C_2}{C_1}\\,2\\pi\\,\\frac{\\sigma_A^2\\sigma_f^2}{\\sigma_{A0}\\,\\sigma_{f0}}\n\\sqrt{(1-\\rho_A^2)(1-\\rho_f^2)}}$$", "id": "217662"}]}