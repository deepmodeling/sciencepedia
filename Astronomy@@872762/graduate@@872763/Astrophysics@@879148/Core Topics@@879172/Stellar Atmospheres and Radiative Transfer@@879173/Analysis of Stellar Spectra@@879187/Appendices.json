{"hands_on_practices": [{"introduction": "To interpret a spectrum, we must first understand the underlying physics that dictates the strength of its individual lines. For molecules in astrophysical environments like cool stellar atmospheres or interstellar clouds, the intensity of a rotational transition depends on the population of its originating energy level. This population is governed by a competition between the increasing number of available states at higher energies (degeneracy) and the decreasing probability of occupation according to the Boltzmann distribution. This exercise [@problem_id:189134] provides fundamental practice in applying statistical mechanics to find the most populated rotational level, directly connecting the gas temperature to the most prominent feature in its molecular spectrum.", "problem": "In the study of cold molecular clouds within the interstellar medium, the rotational spectra of diatomic molecules like carbon monoxide (CO) are crucial for determining the gas temperature. The energy of the rotational levels of a diatomic molecule, modeled as a rigid rotor, is quantized and given by $E_J = B J(J+1)$, where $J$ is the rotational quantum number ($J=0, 1, 2, ...$) and $B$ is the rotational constant of the molecule. Each energy level has a degeneracy of $g_J = 2J+1$.\n\nFor a gas of these molecules in thermal equilibrium at a temperature $T$, the population of each rotational level, $N_J$, is governed by the Boltzmann distribution. The number of molecules in a given level $J$ is proportional to its degeneracy multiplied by the Boltzmann factor:\n$$N_J \\propto g_J \\exp\\left(-\\frac{E_J}{k_B T}\\right)$$\nwhere $k_B$ is the Boltzmann constant. The intensity of an observed spectral line corresponding to a transition from a level $J$ is proportional to the population $N_J$ of that level.\n\nTo predict which rotational line will be the most intense, one must find the quantum number $J$ for which the population $N_J$ is maximized.\n\nDerive an expression for the rotational quantum number $J_{max}$ that corresponds to the most populated rotational energy level. To obtain a closed-form analytical answer, you should treat $J$ as a continuous, non-negative real variable and find the value that maximizes the population function $N_J(J)$. Express your result in terms of the rotational constant $B$, the Boltzmann constant $k_B$, and the temperature $T$.", "solution": "We define the continuous level population \n$$N(J)=(2J+1)\\exp\\!\\bigl(-\\tfrac{B\\,J(J+1)}{k_B T}\\bigr)\\,. $$\nMaximize by solving $\\tfrac{d}{dJ}\\ln N(J)=0$. We compute\n$$\\frac{d}{dJ}\\ln N(J)\n=\\frac{2}{2J+1}-\\frac{B(2J+1)}{k_B T}=0\\,. $$\nHence\n$$\\frac{2}{2J+1}=\\frac{B(2J+1)}{k_B T}\\quad\\Longrightarrow\\quad(2J+1)^2=\\frac{2k_B T}{B}\\,. $$\nTaking the positive root gives\n$$2J+1=\\sqrt{\\frac{2k_B T}{B}}\\quad\\Longrightarrow\\quad\nJ_{\\max}=\\frac{\\sqrt{\\frac{2k_B T}{B}}-1}{2}\\,. $$", "answer": "$$\\boxed{\\frac{\\sqrt{\\frac{2k_B T}{B}}-1}{2}}$$", "id": "189134"}, {"introduction": "An observed spectral line is never a perfect representation of the intrinsic line emitted by a star; it is inevitably blurred by the finite resolution of the spectrograph. This instrumental effect is mathematically described as a convolution of the true line profile with the instrument's response function. This practice [@problem_id:189256] delves into this crucial aspect of data analysis by examining how to account for the broadening of a stellar rotational profile by a Gaussian instrumental profile, a vital skill for accurately extracting physical parameters like rotational velocity from real-world observational data.", "problem": "The analysis of stellar spectral lines is a cornerstone of astrophysics. The intrinsic shape of a spectral line is often altered by various broadening mechanisms, including the star's rotation and the finite resolution of the observing instrument.\n\nConsider a spectral line from a rotating star. The intrinsic line profile, dominated by rotational broadening, is given by the semi-elliptical function:\n$$\nR(\\Delta\\lambda) = C_R \\sqrt{1 - \\left(\\frac{\\Delta\\lambda}{\\Delta\\lambda_L}\\right)^2}, \\quad |\\Delta\\lambda| \\le \\Delta\\lambda_L\n$$\nand $R(\\Delta\\lambda) = 0$ for $|\\Delta\\lambda|  \\Delta\\lambda_L$. Here, $\\Delta\\lambda$ is the wavelength displacement from the line center, $\\Delta\\lambda_L$ is the maximum Doppler shift due to rotation, and $C_R$ is a normalization constant.\n\nThis line is observed with a spectrograph whose instrumental profile is well-approximated by a Gaussian, $G(\\Delta\\lambda)$, with a Full-Width at Half-Maximum (FWHM) of $W_G$. The observed line profile, $O(\\Delta\\lambda)$, is the convolution of the intrinsic and instrumental profiles: $O(\\Delta\\lambda) = (R * G)(\\Delta\\lambda)$.\n\nFor any two profiles, the variance of their convolution is the sum of their individual variances. Let $\\sigma_R^2$, $\\sigma_G^2$, and $\\sigma_O^2$ be the variances of the rotational, Gaussian, and observed profiles, respectively. Then $\\sigma_O^2 = \\sigma_R^2 + \\sigma_G^2$. The variance of a normalized profile $f(x)$ is defined as $\\sigma_f^2 = \\int_{-\\infty}^{\\infty} x^2 f(x) \\, dx$. For a Gaussian, the relationship between its FWHM and variance is $W_G^2 = (8\\ln 2) \\sigma_G^2$.\n\nIn the common astrophysical scenario where the instrumental broadening is small compared to the rotational broadening ($W_G \\ll W_R$, where $W_R$ is the FWHM of the rotational profile), the shape of the observed profile $O(\\Delta\\lambda)$ is a good approximation of the intrinsic profile $R(\\Delta\\lambda)$. This implies that the relationship between the squared FWHM and the variance is approximately the same for both profiles, i.e., $W_O^2 / \\sigma_O^2 \\approx W_R^2 / \\sigma_R^2$.\n\nUnder this assumption, the squared FWHM of the observed profile, $W_O^2$, can be approximated by a linear combination of the squared FWHMs of the constituent profiles:\n$$\nW_O^2 \\approx W_R^2 + K \\cdot W_G^2\n$$\nYour task is to derive the value of the constant coefficient $K$.", "solution": "We start from the approximation\n$$\n\\frac{W_O^2}{\\sigma_O^2}\\approx\\frac{W_R^2}{\\sigma_R^2},\\qquad \n\\sigma_O^2=\\sigma_R^2+\\sigma_G^2.\n$$\nHence\n$$\n\\frac{W_R^2+K\\,W_G^2}{\\sigma_R^2+\\sigma_G^2}\n=\\frac{W_R^2}{\\sigma_R^2}\n\\;\\Longrightarrow\\;\nK\\,W_G^2\\,\\sigma_R^2\n=W_R^2\\,\\sigma_G^2\n\\;\\Longrightarrow\\;\nK=\\frac{W_R^2\\,\\sigma_G^2}{W_G^2\\,\\sigma_R^2}.\n$$\n\nFor a Gaussian $W_G^2=(8\\ln2)\\,\\sigma_G^2$, so\n$$\n\\frac{\\sigma_G^2}{W_G^2}=\\frac1{8\\ln2}.\n$$\n\nNext, for the rotational profile \n$R(x)=C_R\\sqrt{1-(x/\\Delta\\lambda_L)^2}$ on $[-\\Delta\\lambda_L,\\Delta\\lambda_L]$,\nnormalized by \n$$\n\\int_{-\\Delta\\lambda_L}^{\\Delta\\lambda_L}C_R\\sqrt{1-(x/\\Delta\\lambda_L)^2}\\,dx=1\n\\;\\Longrightarrow\\;\nC_R=\\frac{2}{\\pi\\Delta\\lambda_L}.\n$$\nIts variance is\n$$\n\\sigma_R^2\n=C_R\\int_{-\\Delta\\lambda_L}^{\\Delta\\lambda_L}x^2\\sqrt{1-(x/\\Delta\\lambda_L)^2}\\,dx\n=\\frac{\\Delta\\lambda_L^2}{4}.\n$$\nThe FWHM satisfies \n$$\n\\sqrt{1-(x/\\Delta\\lambda_L)^2}=\\tfrac12\n\\;\\Longrightarrow\\;\nx=\\frac{\\sqrt3}{2}\\,\\Delta\\lambda_L\n\\;\\Longrightarrow\\;\nW_R=2x=\\sqrt3\\,\\Delta\\lambda_L,\n\\quad\nW_R^2=3\\,\\Delta\\lambda_L^2.\n$$\nThus\n$$\n\\frac{W_R^2}{\\sigma_R^2}\n=\\frac{3\\,\\Delta\\lambda_L^2}{\\Delta\\lambda_L^2/4}\n=12,\n$$\nand finally\n$$\nK\n=\\frac{W_R^2}{\\sigma_R^2}\\,\\frac{\\sigma_G^2}{W_G^2}\n=12\\cdot\\frac1{8\\ln2}\n=\\frac{3}{2\\ln2}.\n$$", "answer": "$$\\boxed{\\frac{3}{2\\ln 2}}$$", "id": "189256"}, {"introduction": "One of the most powerful applications of stellar spectroscopy is the measurement of a star's motion along our line of sight, its radial velocity. The standard technique for this measurement is the cross-correlation function (CCF), which effectively slides a template spectrum across an observed spectrum to find the velocity shift that yields the best match. This hands-on problem [@problem_id:189402] demystifies this workhorse of modern astrophysics by having you derive the analytical form of the CCF for an idealized spectrum and mask, providing a first-principles understanding of the method behind countless discoveries, from exoplanets to stellar dynamics.", "problem": "In stellar spectroscopy, the cross-correlation function (CCF) is a powerful tool used to measure the radial velocity of a star. This is achieved by comparing an observed spectrum with a template mask that represents the expected spectral lines. The peak of the CCF corresponds to the Doppler shift that best aligns the template with the observed spectrum, thus revealing the star's line-of-sight velocity.\n\nConsider a simplified model of an observed stellar spectrum, $S(\\lambda)$, which consists of a flat continuum and a single Gaussian absorption line. The spectrum is described by the function:\n$$\nS(\\lambda) = F_c - F_l \\exp\\left[-\\frac{(\\lambda - \\lambda_0)^2}{2\\sigma^2}\\right]\n$$\nwhere $F_c$ is the constant continuum flux, $F_l$ is the depth of the absorption line (a positive constant), $\\lambda_0$ is the central wavelength of the line in the star's rest frame, and $\\sigma$ is the standard deviation that determines the line's width.\n\nThis spectrum is to be cross-correlated with an idealized template mask, $M(\\lambda)$. The mask is a simple rectangular function designed to isolate the absorption line. For this problem, the mask is centered at the rest-frame wavelength $\\lambda_0$, has a width $W$, and is defined as:\n$$\nM(\\lambda) = \\begin{cases} -1  \\text{if } |\\lambda - \\lambda_0| \\le \\frac{W}{2} \\\\ \\phantom{-}0  \\text{otherwise} \\end{cases}\n$$\n\nThe cross-correlation function, $C(v)$, for a given radial velocity $v$, is computed by integrating the product of the observed spectrum $S(\\lambda)$ and the template mask, which has been Doppler-shifted by $\\Delta\\lambda_v = \\frac{\\lambda_0 v}{c}$. Here, $c$ is the speed of light. The shifted mask, $M_v(\\lambda)$, is centered at $\\lambda_0 + \\Delta\\lambda_v$. The CCF is therefore given by the integral:\n$$\nC(v) = \\int_{-\\infty}^{\\infty} S(\\lambda) M_v(\\lambda) d\\lambda\n$$\n\nDerive the analytical expression for the cross-correlation function $C(v)$ in terms of the given parameters $F_c, F_l, \\lambda_0, \\sigma, W, c$, and the variable $v$.\n\nNote: The error function is defined as $\\text{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_0^x e^{-t^2} dt$. Your final expression may involve this function.", "solution": "We wish to compute  \n$$C(v)=\\int_{-\\infty}^{\\infty}S(\\lambda)\\,M_v(\\lambda)\\,d\\lambda$$ \nwith  \n$$S(\\lambda)=F_c-F_l\\exp\\!\\Bigl[-\\frac{(\\lambda-\\lambda_0)^2}{2\\sigma^2}\\Bigr],$$  \n$$M_v(\\lambda)=\n\\begin{cases}\n-1,|\\lambda-(\\lambda_0+\\Delta\\lambda_v)|\\le\\tfrac W2,\\\\\n0,\\text{otherwise},\n\\end{cases}\n\\quad\\Delta\\lambda_v=\\frac{\\lambda_0\\,v}{c}.$$  \n\n1.  Split the integral over the nonzero region $[a,b]$ with  \n$$a=\\lambda_0+\\Delta\\lambda_v-\\frac W2,\\quad b=\\lambda_0+\\Delta\\lambda_v+\\frac W2.$$  \nThus  \n$$C(v)=-\\int_a^b\\bigl(F_c-F_l e^{-(\\lambda-\\lambda_0)^2/(2\\sigma^2)}\\bigr)d\\lambda \n=-F_c(b-a)+F_l\\int_a^b e^{-\\frac{(\\lambda-\\lambda_0)^2}{2\\sigma^2}}\\,d\\lambda.$$\n\n2.  Evaluate the Gaussian integral by the change of variable  \n$$x=\\frac{\\lambda-\\lambda_0}{\\sigma\\sqrt2},\\quad d\\lambda=\\sigma\\sqrt2\\,dx.$$  \nThe limits become  \n$$x_a=\\frac{a-\\lambda_0}{\\sigma\\sqrt2}\n=\\frac{\\Delta\\lambda_v-\\tfrac W2}{\\sigma\\sqrt2},\\quad\nx_b=\\frac{b-\\lambda_0}{\\sigma\\sqrt2}\n=\\frac{\\Delta\\lambda_v+\\tfrac W2}{\\sigma\\sqrt2}.$$  \nHence  \n$$\\int_a^b e^{-\\frac{(\\lambda-\\lambda_0)^2}{2\\sigma^2}}\\,d\\lambda\n=\\sigma\\sqrt2\\int_{x_a}^{x_b}e^{-x^2}dx\n=\\sigma\\sqrt2\\frac{\\sqrt\\pi}{2}\\Bigl[\\erf(x_b)-\\erf(x_a)\\Bigr].$$\n\n3.  Combine results, noting $b-a=W$, to obtain  \n$$C(v)=-F_c\\,W\n+F_l\\,\\sigma\\sqrt{\\frac{\\pi}{2}}\\Bigl[\\erf\\!\\bigl(x_b\\bigr)-\\erf\\!\\bigl(x_a\\bigr)\\Bigr]$$  \nwith $x_{a,b}=(\\tfrac{\\lambda_0 v}{c}\\mp\\tfrac W2)/(\\sigma\\sqrt2)$.  \nThis is the desired analytical expression for the CCF.", "answer": "$$\\boxed{-F_c\\,W\n+F_l\\,\\sigma\\sqrt{\\frac{\\pi}{2}}\\Bigl[\n\\text{erf}\\!\\Bigl(\\frac{\\frac{\\lambda_0\\,v}{c}+\\frac{W}{2}}{\\sigma\\sqrt2}\\Bigr)\n-\\text{erf}\\!\\Bigl(\\frac{\\frac{\\lambda_0\\,v}{c}-\\frac{W}{2}}{\\sigma\\sqrt2}\\Bigr)\n\\Bigr]}$$", "id": "189402"}]}