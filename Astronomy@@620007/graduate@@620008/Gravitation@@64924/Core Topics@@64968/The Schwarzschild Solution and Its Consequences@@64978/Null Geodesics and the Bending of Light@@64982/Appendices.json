{"hands_on_practices": [{"introduction": "The Schwarzschild metric provides the simplest model for a non-rotating, uncharged black hole and is a cornerstone for understanding strong gravitational fields. For photons passing very close to this object, the bending of light becomes extreme, a phenomenon governed by an unstable circular orbit known as the photon sphere. This exercise [@problem_id:329472] challenges you to explore this strong-field regime by calculating a key coefficient that characterizes the logarithmic divergence of the deflection angle for light rays with an impact parameter infinitesimally close to the critical value for capture.", "problem": "In the theory of General Relativity, the path of a photon in the vicinity of a static, spherically symmetric massive object of mass $M$ is described by a null geodesic in the Schwarzschild spacetime. The geometry is characterized by the Schwarzschild radius, $r_s = 2GM/c^2$.\n\nA photon approaching the massive object from infinity with an impact parameter $b$ will be deflected. The total change in the azimuthal angle $\\phi$ for a photon that reaches a minimum distance $r_0$ (the periastron) and returns to infinity is given by the integral:\n$$\n\\Delta\\phi(b) = 2 \\int_{r_0}^{\\infty} \\frac{dr}{r^2 \\sqrt{\\frac{1}{b^2} - V_{\\text{eff}}(r)}}\n$$\nwhere the effective potential for the photon is $V_{\\text{eff}}(r) = \\frac{1}{r^2}\\left(1-\\frac{r_s}{r}\\right)$. The distance of closest approach, $r_0$, is the largest real root of the equation $1/b^2 = V_{\\text{eff}}(r_0)$.\n\nThere exists a critical impact parameter, $b_{crit}$, for which the photon is captured into an unstable circular orbit at the photon sphere radius, $r_{ph} = \\frac{3}{2}r_s$. For $b > b_{crit}$, the photon is deflected and escapes to infinity. For $b$ infinitesimally larger than $b_{crit}$, the photon circles the massive object many times before escaping, leading to a large bending angle, $\\alpha(b) = \\Delta\\phi(b) - \\pi$.\n\nIn the limit that $b \\to b_{crit}$ from above, the bending angle diverges logarithmically. This divergence can be expressed with the leading-order term:\n$$\n\\alpha(b) \\approx -C \\ln\\left(\\frac{b}{b_{crit}} - 1\\right) + \\mathcal{O}(1)\n$$\nYour task is to derive the dimensionless constant $C$.", "solution": "1. Starting from the null-geodesic integral in the variable $u=1/r$,\n$$\n\\Delta\\phi(b)\n=2\\int_{0}^{u_0}\\frac{du}{\\sqrt{\\frac{1}{b^2}-u^2+r_su^3}}\\,,\\quad \nu_0:\\; \\frac{1}{b^2}-u_0^2+r_su_0^3=0.\n$$\nThe photon-sphere is at \n$u_m=\\frac{1}{r_{ph}}=\\frac{2}{3r_s}$, with critical impact parameter given by\n$\\frac{1}{b_{crit}^2}=u_m^2-r_su_m^3=\\frac{4}{27r_s^2}$.\n\n2. Define \n$\\varepsilon=\\frac{1}{b^2}-\\frac{1}{b_{crit}^2}$, \nso for $b \\to b_{crit}^+$ one has $\\varepsilon \\to 0^-$.  Expand the radicand $Q(u)=\\frac{1}{b^2}-u^2+r_su^3$ about $u_m$:\n$Q(u) = \\varepsilon + \\frac{1}{2}Q''(u_m)(u-u_m)^2+\\cdots$. Since $Q'(u_m)=0$ and $Q''(u_m)=2$, this gives\n$Q(u)\\approx\\varepsilon+(u-u_m)^2$.\nThe turning point is \n$u_0=u_m-\\sqrt{-\\varepsilon}$.\n\n3. The divergent part of $\\Delta\\phi$ comes from $u\\approx u_m$. Set \n$u-u_m=-\\sqrt{-\\varepsilon}\\,y$,\nthen \n$du=-\\sqrt{-\\varepsilon}\\,dy$, and\n$\\sqrt{Q(u)}=\\sqrt{-\\varepsilon}\\,\\sqrt{y^2-1}$.\nThus\n$$\n\\Delta\\phi_{\\rm div}\n=2\\int_{u_0}^{U}\\frac{du}{\\sqrt{Q(u)}}\n=2\\int_{1}^{y_U}\\frac{-\\sqrt{-\\varepsilon}\\,dy}{\\sqrt{-\\varepsilon}\\,\\sqrt{y^2-1}}\n=2\\int_{1}^{y_U}\\frac{dy}{\\sqrt{y^2-1}}\n=2\\arccosh(y_U).\n$$\nFor large cutoff $y_U\\sim(u_m-U)/\\sqrt{-\\varepsilon}\\gg1$,\n$$\n2\\arccosh(y_U)=2\\ln\\bigl(y_U+\\sqrt{y_U^2-1}\\bigr)\n=-\\ln(-\\varepsilon)+\\mathcal{O}(1).\n$$\n\n4. Noting $-\\varepsilon = 1/b_{crit}^2 - 1/b^2 \\propto (b/b_{crit}-1)$, one finds\n$\\alpha(b)=\\Delta\\phi(b)-\\pi\\approx -\\ln(b/b_{crit}-1)+\\mathcal{O}(1)$,\nso the dimensionless constant is\n$$\nC=1.\n$$", "answer": "$$\\boxed{1}$$", "id": "329472"}, {"introduction": "While the Schwarzschild solution is fundamental, most astrophysical black holes are expected to possess angular momentum. The Kerr metric describes the spacetime around a rotating black hole, introducing fascinating effects like frame-dragging. This practice [@problem_id:901733] delves into the consequences of spin on null geodesics by asking you to calculate the critical impact parameter for an extremal Kerr black hole. Successfully determining this value for a prograde orbit highlights the profound difference between static and rotating spacetimes and is a crucial step in modeling phenomena like black hole shadows.", "problem": "A Kerr black hole is described by its mass $M$ and its spin parameter $a$. The spacetime geometry in Boyer-Lindquist coordinates $(t, r, \\theta, \\phi)$ is given by the metric:\n$$ds^2 = -\\left(1-\\frac{2Mr}{\\Sigma}\\right)dt^2 - \\frac{4Mar\\sin^2\\theta}{\\Sigma}dtd\\phi + \\frac{\\Sigma}{\\Delta}dr^2 + \\Sigma d\\theta^2 + \\left(r^2+a^2+\\frac{2Ma^2r\\sin^2\\theta}{\\Sigma}\\right)\\sin^2\\theta d\\phi^2$$\nwhere $\\Sigma = r^2+a^2\\cos^2\\theta$ and $\\Delta = r^2-2Mr+a^2$.\n\nConsider a photon moving in the equatorial plane ($\\theta=\\pi/2$) of an **extremal** Kerr black hole, for which the spin parameter is maximal, i.e., $a=M$. The photon is on a **prograde** orbit, meaning its orbital angular momentum has the same sign as the black hole's spin.\n\nThe photon's trajectory is governed by its conserved energy at infinity, $E$, and its conserved axial component of angular momentum, $L$. The impact parameter is defined as $b = L/E$. Photons with an impact parameter smaller than a certain critical value, $b_c$, are captured by the black hole, while those with an impact parameter larger than $b_c$ are scattered to infinity. This critical value corresponds to the impact parameter of an unstable circular photon orbit.\n\nYour task is to compute the critical impact parameter $b_c$ for a photon on a prograde equatorial orbit around an extremal Kerr black hole. Express your answer in terms of the black hole's mass $M$.", "solution": "1. The radial potential for equatorial null geodesics ($\\eta=0$), with impact parameter $\\xi=b=L/E$:\n$R(r)=\\bigl[E(r^2+a^2)-aL\\bigr]^2-\\Delta(L-aE)^2=E^2V(r,b)$.\nThe conditions for a circular orbit, $V=0$ and $dV/dr=0$, give\n$$V=(r^2+a^2-ab)^2-(r^2-2Mr+a^2)(b-a)^2=0,$$\n$$\\frac{dV}{dr}=4r(r^2+a^2-ab)-2(r-M)(b-a)^2=0.$$\n2. Define $k=b-a$. Then $r^2+a^2-ab =r^2-ak$. The equations become\n  a) $(r^2-ak)^2-\\Delta\\,k^2=0\\implies r^2(r^2-k(2a+k))+2Mrk^2=0,$  \n  b) $2r(r^2-ak)-(r-M)k^2=0\\implies2r^3-2akr-(r-M)k^2=0.$\n3. These equations can be solved to yield the photon-orbit cubic equation for the possible radii $r$:\n$$r^3-6Mr^2+9M^2r-4a^2M=0.$$\n4. For an extremal Kerr black hole, $a=M$, this cubic equation factors as $(r-M)^2(r-4M)=0$. The unstable prograde orbit corresponds to the radius\n$$r_{\\rm ph}=M.$$\n5. Substituting $r=M$ and $a=M$ back into the condition from $dV/dr=0$ gives a direct way to find the critical impact parameter $b_c$:\n$4M(M^2+M^2-Mb_c) - 2(M-M)(b_c-M)^2 = 0$.\n$4M(2M^2-Mb_c) = 0$.\nSince $M \\neq 0$, we have $2M^2 - Mb_c = 0$, which implies\n$$b_c = 2M.$$", "answer": "$$\\boxed{2M}$$", "id": "901733"}, {"introduction": "Bridging the gap between analytical theory and practical application is a vital skill in modern physics. This exercise [@problem_id:2421994] moves from exact derivations to computational modeling by tackling the classic problem of weak-field light deflection. You will derive the perturbative form of the orbital equation for a light ray and then implement the highly accurate Numerov method to solve it numerically. This hands-on coding task not only reinforces the theoretical underpinnings of gravitational lensing but also provides direct experience in translating the equations of General Relativity into a predictive computational tool.", "problem": "You are to model the weak-field bending of a light ray by a spherically symmetric, non-rotating massive body using the second-order differential equation for null geodesics in the Schwarzschild spacetime, reduced to the plane of motion and expressed in terms of the reciprocal radius $u(\\phi) = 1/r(\\phi)$, where $r$ is the radial coordinate and $\\phi$ is the polar angle (in radians). Work in geometric units where the gravitational constant $G$ and the speed of light $c$ are set to $1$, and scale all lengths by the impact parameter $b$ of the unperturbed straight-line trajectory so that distances become dimensionless. Define the dimensionless parameters $\\mu = M/b$ and $\\bar{u}(\\phi) = b\\,u(\\phi)$, where $M$ is the mass of the central body.\n\nStarting from the null geodesic equation in the Schwarzschild metric, use the standard reduction to an orbital equation (Binet form) and perform a first-order weak-field perturbation expansion in the small parameter $\\mu$. Proceed from the following fundamental bases:\n\n- The Schwarzschild solution of General Relativity (GR) for a static, spherically symmetric vacuum spacetime.\n- The null geodesic condition and the planar reduction for central potentials.\n- The introduction of the reciprocal radius $u(\\phi)$ and the Binet form of the orbital equation for null geodesics in Schwarzschild spacetime.\n\nYour tasks:\n\n1. Derive the dimensionless orbital equation for $\\bar{u}(\\phi)$ and obtain the unperturbed straight-line solution $\\bar{u}_0(\\phi)$ that corresponds to $\\mu = 0$ with closest approach at $\\phi = \\pi/2$. Express $\\bar{u}_0(\\phi)$ explicitly as a function of $\\phi$ and justify your choice of origin for $\\phi$.\n\n2. Introduce a first-order perturbation $\\bar{u}(\\phi) = \\bar{u}_0(\\phi) + \\mu\\,w(\\phi)$ and, keeping only terms up to first order in $\\mu$, derive the linear inhomogeneous second-order ordinary differential equation (ODE) for $w(\\phi)$ of the form $w''(\\phi) + k(\\phi)\\,w(\\phi) = s(\\phi)$, together with boundary conditions at $\\phi = \\pi/2$ that encode symmetry at closest approach. Clearly identify $k(\\phi)$ and $s(\\phi)$ in terms of $\\bar{u}_0(\\phi)$.\n\n3. Design a Numerov scheme to solve the ODE for $w(\\phi)$ on a uniform grid of $\\phi \\in [0,\\pi]$ using the boundary conditions at $\\phi=\\pi/2$. Your algorithm must:\n   - Use a uniform step size $h$ in $\\phi$ (in radians).\n   - Implement the Numerov recurrence appropriate for linear inhomogeneous equations $y''(x) + k(x)\\,y(x) = s(x)$.\n   - Initialize the two starting values near $\\phi = \\pi/2$ by using a Taylor expansion consistent with the derived ODE and boundary conditions.\n   - March from $\\phi=\\pi/2$ to both $\\phi=0$ and $\\phi=\\pi$.\n\n4. Using your computed $w(\\phi)$, estimate to first order in $\\mu$ the total bending angle (magnitude) $\\alpha$ in radians by determining the shifts of the incoming and outgoing asymptotes of the trajectory. Proceed by noting that asymptotes correspond to zeros of $\\bar{u}(\\phi)$ near $\\phi=0$ (incoming) and near $\\phi=\\pi$ (outgoing). Use a first-order local linearization near these zeros to estimate the angular shifts and combine them to obtain $\\alpha$ as a positive real number in radians. You must express the final bending angle in radians.\n\n5. Implement the above in a complete, runnable program and evaluate the bending angle for the following test suite of dimensionless mass-to-impact ratios:\n   - $\\mu = 0$\n   - $\\mu = 10^{-6}$\n   - $\\mu = 10^{-5}$\n   - $\\mu = 5\\times 10^{-5}$\n\nNumerical and output requirements:\n\n- Angles must be in radians.\n- Use a sufficiently fine grid in $\\phi$ to ensure that the Numerov methodâ€™s sixth-order accuracy is reflected in the results to at least $6$ significant digits for the given test suite.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each result must be a floating-point number in radians corresponding to the bending angle for the respective $\\mu$ in the order given above.\n\nYour derivations must rely only on the stated fundamental bases and you must not assume any result that is not derived from these. All symbols, operators, and numbers must be expressed in LaTeX in your written derivation. The program should be self-contained and require no user input or external files.", "solution": "The problem statement has been critically validated and is deemed scientifically grounded, well-posed, and objective. It presents a standard problem in computational physics derived from General Relativity, with a clear path to a unique, meaningful solution. All required data and conditions are provided.\n\nThe solution proceeds by following the specified tasks.\n\n**1. Derivation of the Dimensionless Orbital Equation and Unperturbed Solution**\n\nThe Binet equation for the trajectory of a massless particle (a null geodesic) in the Schwarzschild spacetime, expressed using the reciprocal radius $u(\\phi) = 1/r(\\phi)$, is given in geometric units ($G=c=1$) by:\n$$\n\\frac{d^2u}{d\\phi^2} + u = 3Mu^2\n$$\nwhere $M$ is the mass of the central body.\n\nWe introduce the dimensionless variables $\\bar{u}(\\phi) = b u(\\phi)$ and $\\mu = M/b$, where $b$ is the impact parameter. Substituting $u = \\bar{u}/b$ into the equation:\n$$\n\\frac{d^2}{d\\phi^2}\\left(\\frac{\\bar{u}}{b}\\right) + \\left(\\frac{\\bar{u}}{b}\\right) = 3M\\left(\\frac{\\bar{u}}{b}\\right)^2\n$$\nMultiplying by $b$ yields the dimensionless orbital equation:\n$$\n\\frac{d^2\\bar{u}}{d\\phi^2} + \\bar{u} = \\frac{3M}{b}\\bar{u}^2\n$$\n$$\n\\frac{d^2\\bar{u}}{d\\phi^2} + \\bar{u} = 3\\mu \\bar{u}^2\n$$\nThis is the required equation for $\\bar{u}(\\phi)$.\n\nFor the unperturbed case, we set $\\mu=0$. The equation reduces to the simple harmonic oscillator equation:\n$$\n\\frac{d^2\\bar{u}_0}{d\\phi^2} + \\bar{u}_0 = 0\n$$\nThe general solution is $\\bar{u}_0(\\phi) = A\\cos(\\phi) + B\\sin(\\phi)$. The coordinate system for $\\phi$ is chosen such that the incoming path is from $\\phi \\approx 0$ and the outgoing path is towards $\\phi \\approx \\pi$. The problem states that the point of closest approach occurs at $\\phi = \\pi/2$. At closest approach, $r$ is a minimum, so $u=1/r$ and $\\bar{u}$ are maximum. This requires the derivative of $\\bar{u}_0$ to be zero at $\\phi=\\pi/2$:\n$$\n\\frac{d\\bar{u}_0}{d\\phi}\\bigg|_{\\phi=\\pi/2} = [-A\\sin(\\phi) + B\\cos(\\phi)]_{\\phi=\\pi/2} = -A\\sin(\\pi/2) + B\\cos(\\pi/2) = -A = 0\n$$\nThus, $A=0$, and the solution is of the form $\\bar{u}_0(\\phi) = B\\sin(\\phi)$. For the unperturbed straight-line trajectory, the distance of closest approach is the impact parameter $b$. At $\\phi=\\pi/2$, we have $r=b$, which means $u=1/b$. In dimensionless terms, this is $\\bar{u}_0(\\pi/2) = b u(\\pi/2) = b(1/b) = 1$. Evaluating our solution at this point gives $\\bar{u}_0(\\pi/2) = B\\sin(\\pi/2)=B=1$.\nTherefore, the unperturbed solution is:\n$$\n\\bar{u}_0(\\phi) = \\sin(\\phi)\n$$\n\n**2. Derivation of the First-Order Perturbation Equation**\n\nWe introduce a first-order perturbation of the form $\\bar{u}(\\phi) = \\bar{u}_0(\\phi) + \\mu w(\\phi)$ into the full dimensionless equation:\n$$\n\\frac{d^2}{d\\phi^2}(\\bar{u}_0 + \\mu w) + (\\bar{u}_0 + \\mu w) = 3\\mu(\\bar{u}_0 + \\mu w)^2\n$$\nExpanding and grouping by powers of $\\mu$:\n$$\n\\left(\\frac{d^2\\bar{u}_0}{d\\phi^2} + \\bar{u}_0\\right) + \\mu\\left(\\frac{d^2w}{d\\phi^2} + w\\right) = 3\\mu(\\bar{u}_0^2 + 2\\mu\\bar{u}_0w + \\mathcal{O}(\\mu^2))\n$$\nThe first term on the left is zero since $\\bar{u}_0$ is the solution to the homogeneous equation. Equating terms of order $\\mu$ on both sides gives:\n$$\n\\mu\\left(\\frac{d^2w}{d\\phi^2} + w\\right) = 3\\mu\\bar{u}_0^2\n$$\nDividing by $\\mu$ and substituting $\\bar{u}_0(\\phi)=\\sin(\\phi)$, we obtain the linear inhomogeneous ordinary differential equation for the perturbation function $w(\\phi)$:\n$$\n\\frac{d^2w}{d\\phi^2}(\\phi) + w(\\phi) = 3\\sin^2(\\phi)\n$$\nThis ODE is of the form $w''(\\phi) + k(\\phi)w(\\phi) = s(\\phi)$, with $k(\\phi)=1$ and $s(\\phi)=3\\sin^2(\\phi)$.\n\nThe physical trajectory must be symmetric about the point of closest approach, $\\phi=\\pi/2$. Since the unperturbed solution $\\bar{u}_0(\\phi)=\\sin(\\phi)$ is symmetric about $\\phi=\\pi/2$ (as $\\sin(\\pi/2+\\delta) = \\sin(\\pi/2-\\delta)$), the perturbation $w(\\phi)$ must also be symmetric. This implies that its derivative must be zero at the point of symmetry:\n$$\n\\frac{dw}{d\\phi}\\bigg|_{\\phi=\\pi/2} = 0\n$$\nThis provides one boundary condition. To start a numerical integration, a second condition, the value of $w(\\pi/2)$, is needed. The general solution to the ODE for $w(\\phi)$ includes a homogeneous part and a particular solution. A particular solution is $w_p(\\phi) = 2 - \\sin^2(\\phi)$. The homogeneous solution that satisfies $w'(\\pi/2)=0$ is $C_H \\cos(\\phi)$ for some constant $C_H$. However, the final bending angle is independent of the choice of homogeneous solution. For computational simplicity, we can choose the particular solution that uniquely satisfies the boundary conditions. Setting $C_H=0$ is the standard choice. This gives the second boundary condition:\n$$\nw(\\pi/2) = 2 - \\sin^2(\\pi/2) = 1\n$$\n\n**3. Numerov Scheme Design**\n\nThe task is to solve the ODE $w''(\\phi) + k(\\phi)w(\\phi) = s(\\phi)$ where $k(\\phi)=1$ and $s(\\phi)=3\\sin^2(\\phi)$. The Numerov method is a sixth-order accurate scheme for this type of equation. On a uniform grid $\\phi_n = n h$, the recurrence relation is:\n$$\ny_{n+1}\\left(1+\\frac{h^2}{12}k_{n+1}\\right) = 2y_n\\left(1-\\frac{5h^2}{12}k_n\\right) - y_{n-1}\\left(1+\\frac{h^2}{12}k_{n-1}\\right) + \\frac{h^2}{12}(s_{n+1}+10s_n+s_{n-1})\n$$\nSince $k(\\phi)=1$ is constant, this simplifies for $w_n=w(\\phi_n)$ to:\n$$\nw_{n+1}\\left(1+\\frac{h^2}{12}\\right) = 2w_n\\left(1-\\frac{5h^2}{12}\\right) - w_{n-1}\\left(1+\\frac{h^2}{12}\\right) + \\frac{h^2}{12}(s_{n+1}+10s_n+s_{n-1})\n$$\nThe integration will start from the center point $\\phi_c = \\pi/2$. Let the grid index for this point be $i_c$. We need two initial values to start the recurrence. We use $w_{i_c} = w(\\pi/2)$ and a second value $w_{i_c-1} = w(\\pi/2 - h)$ derived from a Taylor expansion around $\\phi_c = \\pi/2$:\n$$\nw(\\phi_c-h) = w(\\phi_c) - h w'(\\phi_c) + \\frac{h^2}{2}w''(\\phi_c) - \\frac{h^3}{6}w'''(\\phi_c) + \\frac{h^4}{24}w^{(4)}(\\phi_c) + \\mathcal{O}(h^6)\n$$\nUsing our boundary conditions and the ODE:\n- $w(\\phi_c) = 1$\n- $w'(\\phi_c) = 0$\n- $w''(\\phi_c) = -w(\\phi_c) + s(\\phi_c) = -1 + 3\\sin^2(\\pi/2) = 2$\n- $w'''(\\phi) = -w'(\\phi) + 3\\sin(2\\phi) \\implies w'''(\\phi_c) = 0$\n- $w^{(4)}(\\phi) = -w''(\\phi) + 6\\cos(2\\phi) \\implies w^{(4)}(\\phi_c) = -2 + 6\\cos(\\pi) = -8$\n\nSubstituting these into the expansion:\n$$\nw(\\pi/2 - h) = 1 + h^2 - \\frac{h^4}{3}\n$$\nWith $w_{i_c}$ and $w_{i_c-1}$ known, we can march backwards towards $\\phi=0$ by rearranging the Numerov recurrence to solve for $w_{n-1}$:\n$$\nw_{n-1} = \\frac{1}{1+h^2/12}\\left[ 2w_n\\left(1-\\frac{5h^2}{12}\\right) - w_{n+1}\\left(1+\\frac{h^2}{12}\\right) + \\frac{h^2}{12}(s_{n+1}+10s_n+s_{n-1}) \\right]\n$$\nThis is applied iteratively for $n = i_c-1, i_c-2, ..., 1$. The solution for $\\phi \\in [\\pi/2, \\pi]$ is found by exploiting the symmetry: $w(\\pi/2+\\delta) = w(\\pi/2-\\delta)$, which means on the grid, $w_{i_c+k} = w_{i_c-k}$.\n\n**4. Bending Angle Estimation**\n\nThe total bending angle $\\alpha$ is the deviation of the total change in angle of the trajectory from the unperturbed value of $\\pi$ radians. The asymptotes of the trajectory occur where $r \\to \\infty$, which means $\\bar{u}(\\phi) = 0$. We seek the roots of $\\bar{u}(\\phi) = \\sin(\\phi) + \\mu w(\\phi) = 0$.\n\nFor the incoming asymptote, near $\\phi=0$, let the root be $\\phi_{in}$. For small $\\phi_{in}$, we linearize: $\\sin(\\phi_{in}) \\approx \\phi_{in}$ and $w(\\phi_{in}) \\approx w(0)$.\n$$\n\\phi_{in} + \\mu w(0) \\approx 0 \\implies \\phi_{in} \\approx -\\mu w(0)\n$$\nFor the outgoing asymptote, near $\\phi=\\pi$, let the root be $\\phi_{out} = \\pi + \\delta\\phi$. For small $\\delta\\phi$: $\\sin(\\pi+\\delta\\phi) \\approx -\\delta\\phi$ and $w(\\pi+\\delta\\phi) \\approx w(\\pi)$.\n$$\n-\\delta\\phi + \\mu w(\\pi) \\approx 0 \\implies \\delta\\phi \\approx \\mu w(\\pi)\n$$\nSo, $\\phi_{out} \\approx \\pi + \\mu w(\\pi)$. The total angle traversed is $\\Delta\\Phi = \\phi_{out} - \\phi_{in} \\approx (\\pi + \\mu w(\\pi)) - (-\\mu w(0)) = \\pi + \\mu(w(0)+w(\\pi))$.\nThe bending angle $\\alpha$ is the deviation from $\\pi$:\n$$\n\\alpha = \\Delta\\Phi - \\pi = \\mu(w(0) + w(\\pi))\n$$\nFrom symmetry, $w(0) = w(\\pi)$. Thus, the final formula for the bending angle using the numerically computed $w(\\phi)$ is:\n$$\n\\alpha = 2\\mu w(0)\n$$\nThe analytical solution $w(\\phi) = 2-\\sin^2(\\phi)$ gives $w(0)=2$, which recovers the known GR result $\\alpha = 4\\mu = 4M/b$. Our numerical procedure should approximate this result. For the test case $\\mu=0$, the formula correctly gives $\\alpha=0$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_bending_angle(mu, N=2**16):\n    \"\"\"\n    Calculates the weak-field gravitational bending angle of light.\n\n    This function implements a Numerov scheme to solve the first-order\n    perturbation equation for a null geodesic in Schwarzschild spacetime.\n\n    Args:\n        mu (float): The dimensionless mass-to-impact-parameter ratio M/b.\n        N (int): The number of grid intervals for the phi-domain [0, pi].\n                 Must be an even number.\n\n    Returns:\n        float: The total bending angle alpha in radians.\n    \"\"\"\n    if mu == 0.0:\n        return 0.0\n\n    # 1. Set up the grid and known functions\n    h = np.pi / N\n    phi = np.linspace(0.0, np.pi, N + 1)\n    \n    # The source term s(phi) = 3*sin^2(phi) in w'' + w = s\n    s = 3.0 * np.sin(phi)**2\n    \n    # The perturbation function array\n    w = np.zeros(N + 1)\n    \n    # Index of the center point, phi = pi/2\n    ic = N // 2\n\n    # 2. Initialize the solution at the center using boundary conditions\n    # From the problem analysis, we choose w(pi/2) = 1.\n    w[ic] = 1.0\n    \n    # Use a Taylor expansion for the second point w(pi/2 - h) to match\n    # the high order of the Numerov method.\n    # w(pi/2-h) = w(pi/2) + h^2 - h^4/3 + O(h^6)\n    w[ic - 1] = 1.0 + h**2 - (h**4) / 3.0\n\n    # 3. Implement the Numerov method\n    # The recurrence for w'' + w = s is:\n    # w_{n-1} = (2*w_n*(1 - 5h^2/12) - w_{n+1}*(1+h^2/12) + h^2/12*(s_{n+1}+10s_n+s_{n-1}))/(1+h^2/12)\n    \n    # Pre-calculate coefficients for efficiency\n    c1 = 1.0 + h**2 / 12.0\n    c2 = 2.0 * (1.0 - 5.0 * h**2 / 12.0)\n    c3 = h**2 / 12.0\n\n    # March backwards from the center (phi=pi/2) to phi=0\n    # At each step n, we have w[n] and w[n+1] and compute w[n-1].\n    for n in range(ic - 1, 0, -1):\n        s_term = s[n + 1] + 10.0 * s[n] + s[n - 1]\n        numerator = c2 * w[n] - c1 * w[n + 1] + c3 * s_term\n        w[n - 1] = numerator / c1\n\n    # 4. Calculate the bending angle\n    # The bending angle alpha is given by alpha = 2 * mu * w(0)\n    w_0 = w[0]\n    alpha = 2.0 * mu * w_0\n    \n    return alpha\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.0,\n        1e-6,\n        1e-5,\n        5e-5,\n    ]\n\n    results = []\n    # Use a sufficiently large number of grid points for high accuracy.\n    # N must be even. 2^16 ensures precision well beyond the required 6 sig figs.\n    N_grid = 2**16 \n    \n    for mu in test_cases:\n        angle = calculate_bending_angle(mu, N=N_grid)\n        results.append(angle)\n\n    # Final print statement in the exact required format.\n    # e.g., \"[0.0,4.0e-06,4.0e-05,2.0e-04]\"\n    # Using a general format string that adapts to the number's magnitude.\n    print(f\"[{','.join(f'{r:.7g}' for r in results)}]\")\n\nsolve()\n```", "id": "2421994"}]}