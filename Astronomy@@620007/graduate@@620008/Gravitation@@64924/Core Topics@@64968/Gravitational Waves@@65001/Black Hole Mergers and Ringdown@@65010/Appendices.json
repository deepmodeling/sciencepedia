{"hands_on_practices": [{"introduction": "Before delving into complex simulations, it is crucial to build physical intuition about the scales involved in a black hole ringdown. This first exercise challenges you to use dimensional analysis, a powerful tool in a physicist's arsenal, to derive the characteristic timescale of the process. By considering only the fundamental constants that govern gravity and spacetime—the gravitational constant $G$, the speed of light $c$, and the black hole's mass $M$—you will uncover the intrinsic \"clock\" of a perturbed black hole, providing a foundational estimate for the duration of its gravitational wave signal [@problem_id:1890737].", "problem": "Following a cataclysmic event, such as a merger with another compact object, a non-rotating black hole of mass $M$ becomes distorted. It then radiates energy in the form of gravitational waves, eventually settling into its final, quiescent spherical state. This process is known as black hole \"ringdown,\" analogous to a struck bell radiating sound as its vibrations decay.\n\nBased on fundamental principles, derive a symbolic expression for the characteristic time scale, $\\tau$, of this ringdown process. Your expression should be formulated exclusively in terms of the black hole's mass $M$, the gravitational constant $G$, and the speed of light in vacuum $c$.", "solution": "A non-rotating (Schwarzschild) black hole in vacuum is fully characterized by its mass $M$. In general relativity, for such a system there are no additional length or time scales beyond those that can be formed from $M$, the gravitational constant $G$, and the speed of light $c$. The ringdown is governed by quasi-normal modes whose frequencies and damping times are set by the near-horizon curvature scale, so the characteristic time $\\tau$ must be constructed from $G$, $M$, and $c$ by dimensional analysis.\n\nSeek a combination of the form $G^{a} M^{b} c^{d}$ with dimensions of time. Using base dimensions for mass $\\mathcal{M}$, length $L$, and time $T$,\n$$\n[G] = L^{3}\\mathcal{M}^{-1} T^{-2}, \\quad [M] = \\mathcal{M}, \\quad [c] = L T^{-1}.\n$$\nThus,\n$$\n[G^{a} M^{b} c^{d}] = L^{3a + d} \\mathcal{M}^{-a + b} T^{-2a - d}.\n$$\nRequiring this to have the dimensions of time, i.e., $L^{0}\\mathcal{M}^{0}T^{1}$, yields the system\n$$\n3a + d = 0, \\quad -a + b = 0, \\quad -2a - d = 1.\n$$\nSolving, one finds\n$$\na = 1, \\quad b = 1, \\quad d = -3,\n$$\nso the unique timescale (up to a dimensionless factor) is\n$$\n\\tau \\propto \\frac{G M}{c^{3}}.\n$$\nThis matches the physical intuition that the ringdown timescale is set by the light-crossing time of the gravitational radius, with $r_{s} = \\frac{2GM}{c^{2}}$ implying a light-crossing time $t_{\\text{lc}} = \\frac{r_{s}}{c} = \\frac{2GM}{c^{3}}$, i.e., of the same order as $\\frac{GM}{c^{3}}$. Detailed perturbation theory fixes a specific dimensionless coefficient for a given quasi-normal mode, but from fundamental principles and dimensional reasoning the characteristic timescale is set by\n$$\n\\tau = \\frac{G M}{c^{3}},\n$$\nup to a dimensionless factor of order unity that depends on the mode.", "answer": "$$\\boxed{\\frac{G M}{c^{3}}}$$", "id": "1890737"}, {"introduction": "The \"ringdown\" of a black hole is technically described by quasinormal modes (QNMs), which are the characteristic damped vibrations of spacetime itself. While their full relativistic treatment is mathematically intensive, the underlying physics closely mirrors that of a more familiar system: the damped mechanical oscillator. This practice provides a hands-on computational analogy, where you will model a QNM as the decaying oscillation of a coupled mechanical system, solidifying your understanding of how its defining complex frequency dictates the observable signal [@problem_id:2418598].", "problem": "Consider a linear, viscously damped, two-degree-of-freedom mechanical system with generalized coordinates $\\mathbf{x}(t) = \\begin{bmatrix} x_1(t) \\\\ x_2(t) \\end{bmatrix}$ governed by the second-order ordinary differential equation\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{x}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{x}}(t) + \\mathbf{K}\\,\\mathbf{x}(t) = \\mathbf{0},\n$$\nwhere the mass matrix $\\mathbf{M}$, damping matrix $\\mathbf{C}$, and stiffness matrix $\\mathbf{K}$ are\n$$\n\\mathbf{M} = \\begin{bmatrix} m_1 & 0 \\\\ 0 & m_2 \\end{bmatrix},\\quad\n\\mathbf{C} = \\begin{bmatrix} c_1 + c_c & -c_c \\\\ -c_c & c_2 + c_c \\end{bmatrix},\\quad\n\\mathbf{K} = \\begin{bmatrix} k_1 + \\kappa & -\\kappa \\\\ -\\kappa & k_2 + \\kappa \\end{bmatrix}.\n$$\nAssume free vibration initial conditions $\\mathbf{x}(0)=\\mathbf{x}_0$ and $\\dot{\\mathbf{x}}(0)=\\mathbf{v}_0$. The normal mode solutions of this damped system are of the form $\\mathbf{x}(t)=\\Re\\{\\mathbf{u}\\,e^{s t}\\}$ with complex temporal growth rate $s \\in \\mathbb{C}$ and (generally complex) mode shape $\\mathbf{u}\\neq \\mathbf{0}$. Define the complex angular frequency $\\omega \\in \\mathbb{C}$ associated with a mode by the relation\n$$\n\\omega = i\\,s,\n$$\nso that $\\omega = \\omega_R + i\\,\\omega_I$ with $\\omega_I < 0$ corresponds to a decaying oscillation. In the context of black hole ringdowns, a single quasinormal mode can be modeled as a scalar damped oscillator with complex frequency, producing a real-valued signal\n$$\ny(t) = 2\\,\\Re\\left\\{ A\\,e^{-i\\,\\omega\\,t}\\right\\},\n$$\nwith complex amplitude $A \\in \\mathbb{C}$. For this problem, define the scalar signal to be the ringdown measured from the first coordinate, with initial scalar conditions $y(0)=x_1(0)$ and $\\dot{y}(0)=\\dot{x}_1(0)$. These conditions determine $A$ uniquely whenever $\\omega_R \\neq 0$.\n\nYour task is to, for each parameter set below, identify the least-damped normal mode (the one with the largest real part of $s$ while remaining stable) of the coupled system, convert it to the complex frequency $\\omega = \\omega_R + i\\,\\omega_I$ with $\\omega_I < 0$ using $\\omega=i\\,s$, construct the scalar ringdown $y(t)$ that matches $y(0)=x_1(0)$ and $\\dot{y}(0)=\\dot{x}_1(0)$, and evaluate $y(t)$ at the specified times. Express all displacements in meters and time in seconds. Angles implied by $\\omega_R t$ must be in radians. Report the values of $y(t)$ rounded to exactly six decimal places.\n\nUse the following test suite of parameter values (all in the International System of Units), where each case is given as\n$$\n(m_1, m_2, k_1, k_2, \\kappa, c_1, c_2, c_c, \\mathbf{x}_0, \\mathbf{v}_0, \\text{times})\n$$\nwith $\\mathbf{x}_0 = \\begin{bmatrix} x_{01} \\\\ x_{02} \\end{bmatrix}$ in meters, $\\mathbf{v}_0 = \\begin{bmatrix} v_{01} \\\\ v_{02} \\end{bmatrix}$ in meters per second, and times as a list in seconds:\n\n- Case $1$: $(m_1,m_2,k_1,k_2,\\kappa,c_1,c_2,c_c) = (1, 1.2, 100, 120, 30, 0.8, 0.9, 0.05)$, $\\mathbf{x}_0 = \\begin{bmatrix} 0.01 \\\\ 0 \\end{bmatrix}$, $\\mathbf{v}_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$, times $[0, 0.02, 0.1, 0.5]$.\n- Case $2$: $(m_1,m_2,k_1,k_2,\\kappa,c_1,c_2,c_c) = (1, 1, 200, 150, 50, 0.05, 0.05, 0.02)$, $\\mathbf{x}_0 = \\begin{bmatrix} 0 \\\\ 0.01 \\end{bmatrix}$, $\\mathbf{v}_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$, times $[0, 0.05, 0.2, 0.5]$.\n- Case $3$: $(m_1,m_2,k_1,k_2,\\kappa,c_1,c_2,c_c) = (2, 1.5, 80, 90, 70, 2.5, 1.5, 0.7)$, $\\mathbf{x}_0 = \\begin{bmatrix} -0.005 \\\\ 0.002 \\end{bmatrix}$, $\\mathbf{v}_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$, times $[0, 0.1, 0.3, 0.7]$.\n\nYour program must produce a single line of output containing a list of lists. Each inner list must contain the values of $y(t)$ (in meters) at the specified times for the corresponding test case, in the given order, rounded to six decimal places. For example, the output format must be\n$$\n[\\,[y_{1,1},y_{1,2},\\dots],\\,[y_{2,1},y_{2,2},\\dots],\\,[y_{3,1},y_{3,2},\\dots]\\,],\n$$\nprinted on one line with no additional characters or whitespace beyond commas, brackets, minus signs, and decimal digits.", "solution": "The problem requires the analysis of a linear, viscously damped, two-degree-of-freedom mechanical system. The governing equation is a second-order matrix ordinary differential equation:\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{x}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{x}}(t) + \\mathbf{K}\\,\\mathbf{x}(t) = \\mathbf{0}\n$$\nTo determine the normal modes of the system, we assume a solution of the form $\\mathbf{x}(t) = \\mathbf{u}\\, e^{st}$, where $\\mathbf{u} \\in \\mathbb{C}^{2}$ is the complex mode shape vector and $s \\in \\mathbb{C}$ is the complex eigenvalue, or temporal growth rate. Substituting this ansatz into the equation of motion yields the quadratic eigenvalue problem (QEP):\n$$\n(s^2 \\mathbf{M} + s \\mathbf{C} + \\mathbf{K})\\mathbf{u} = \\mathbf{0}\n$$\nfor a non-trivial eigenvector $\\mathbf{u} \\neq \\mathbf{0}$. A standard and computationally robust method to solve this QEP is to convert the system of $N$ second-order differential equations into a system of $2N$ first-order differential equations. For our system with $N=2$ degrees of freedom, we define a state vector $\\mathbf{z}(t) \\in \\mathbb{R}^{4}$ as:\n$$\n\\mathbf{z}(t) = \\begin{bmatrix} \\mathbf{x}(t) \\\\ \\dot{\\mathbf{x}}(t) \\end{bmatrix}\n$$\nThe first-order system, also known as the state-space representation, is then:\n$$\n\\dot{\\mathbf{z}}(t) = \\mathbf{A} \\mathbf{z}(t)\n$$\nwhere $\\mathbf{A}$ is the $4 \\times 4$ state-space matrix, constructed from the system matrices:\n$$\n\\mathbf{A} = \\begin{bmatrix} \\mathbf{0} & \\mathbf{I} \\\\ -\\mathbf{M}^{-1}\\mathbf{K} & -\\mathbf{M}^{-1}\\mathbf{C} \\end{bmatrix}\n$$\nHere, $\\mathbf{0}$ and $\\mathbf{I}$ are the $2 \\times 2$ zero and identity matrices, respectively. The solutions to this first-order system are of the form $\\mathbf{z}(t) = \\mathbf{z}_0 e^{st}$, where the values of $s$ are the eigenvalues of $\\mathbf{A}$. These are the same eigenvalues as those of the original QEP. We will therefore compute the eigenvalues of $\\mathbf{A}$ numerically. For a stable physical system, all eigenvalues must have non-positive real parts, i.e., $\\Re(s) \\le 0$. The eigenvalues for an underdamped system will appear in complex conjugate pairs.\n\nThe problem requires identification of the *least-damped* normal mode. The damping of a mode is related to the real part of its eigenvalue, $\\sigma = \\Re(s)$, which dictates the rate of exponential decay $e^{\\sigma t}$. The least-damped mode is the one that decays the slowest, which corresponds to the eigenvalue $s_{\\text{ld}}$ having the largest (least negative) real part:\n$$\ns_{\\text{ld}} = \\underset{s_j}{\\mathrm{argmax}} \\{ \\Re(s_j) \\}\n$$\nwhere $\\{s_j\\}$ is the set of all computed eigenvalues of $\\mathbf{A}$. Since oscillatory modes correspond to a conjugate pair of eigenvalues $s = \\sigma \\pm i \\omega_d$, we must select one from this pair to define the mode's frequency. By convention, we select the eigenvalue with a non-negative imaginary part, i.e., $\\Im(s_{\\text{ld}}) \\ge 0$.\n\nNext, we convert this eigenvalue $s_{\\text{ld}}$ to the complex angular frequency $\\omega$ using the given relation $\\omega = i s_{\\text{ld}}$. Let $s_{\\text{ld}} = \\sigma + i \\omega_d$. Then:\n$$\n\\omega = i(\\sigma + i \\omega_d) = -\\omega_d + i\\sigma\n$$\nThis gives the real and imaginary parts of $\\omega$ as $\\omega_R = -\\omega_d$ and $\\omega_I = \\sigma$. As the system is stable, $\\sigma < 0$, which correctly implies $\\omega_I < 0$ as specified for a decaying oscillation.\n\nThe problem then requires the construction of a scalar ringdown signal, $y(t)$, based on this single-mode frequency $\\omega$. The signal is defined as:\n$$\ny(t) = 2\\,\\Re\\left\\{ A\\,e^{-i\\,\\omega\\,t}\\right\\}\n$$\nThe complex amplitude $A = A_R + i A_I$ is determined by matching the initial conditions of the first coordinate, such that $y(0) = x_1(0) = x_{01}$ and $\\dot{y}(0) = \\dot{x}_1(0) = v_{01}$. Expanding the expression for $y(t)$ using $\\omega = \\omega_R + i \\omega_I$:\n$$\ny(t) = 2 \\Re\\left\\{ A\\,e^{-i(\\omega_R + i\\omega_I)t}\\right\\} = 2 \\Re\\left\\{ A\\,e^{\\omega_I t} e^{-i\\omega_R t}\\right\\} = 2 e^{\\omega_I t} \\Re\\left\\{ (A_R+iA_I)(\\cos(\\omega_R t)-i\\sin(\\omega_R t)) \\right\\}\n$$\n$$\ny(t) = 2 e^{\\omega_I t} (A_R \\cos(\\omega_R t) + A_I \\sin(\\omega_R t))\n$$\nWe apply the initial conditions to solve for $A_R$ and $A_I$. At $t=0$:\n$$\ny(0) = 2e^0(A_R \\cos(0) + A_I \\sin(0)) = 2A_R = x_{01} \\implies A_R = \\frac{x_{01}}{2}\n$$\nThe time derivative of $y(t)$ is:\n$$\n\\dot{y}(t) = 2\\omega_I e^{\\omega_I t} (A_R \\cos(\\omega_R t) + A_I \\sin(\\omega_R t)) + 2e^{\\omega_I t} (-A_R \\omega_R \\sin(\\omega_R t) + A_I \\omega_R \\cos(\\omega_R t))\n$$\nAt $t=0$:\n$$\n\\dot{y}(0) = 2\\omega_I A_R + 2\\omega_R A_I = v_{01}\n$$\nSubstituting the expression for $A_R$:\n$$\n\\omega_I x_{01} + 2\\omega_R A_I = v_{01} \\implies A_I = \\frac{v_{01} - \\omega_I x_{01}}{2\\omega_R}\n$$\nThis provides a unique solution for the complex amplitude $A$ as long as $\\omega_R \\neq 0$, which holds for underdamped oscillatory modes. If $x_{01}=0$ and $v_{01}=0$, then $A_R=0$ and $A_I=0$, leading to $y(t) \\equiv 0$.\n\nThe computational procedure implemented is as follows:\n$1$. For each set of parameters, construct the matrices $\\mathbf{M}$, $\\mathbf{C}$, and $\\mathbf{K}$.\n$2$. Construct the state-space matrix $\\mathbf{A} = \\begin{bmatrix} \\mathbf{0} & \\mathbf{I} \\\\ -\\mathbf{M}^{-1}\\mathbf{K} & -\\mathbf{M}^{-1}\\mathbf{C} \\end{bmatrix}$.\n$3$. Compute the eigenvalues of $\\mathbf{A}$.\n$4$. Find the eigenvalue $s_{\\text{ld}}$ with the largest real part, choosing the one with a non-negative imaginary part in the case of a conjugate pair.\n$5$. Calculate $\\omega = i s_{\\text{ld}}$ and extract its real and imaginary parts, $\\omega_R$ and $\\omega_I$.\n$6$. Use the initial conditions $x_{01}$ and $v_{01}$ to compute the coefficients $A_R$ and $A_I$.\n$7$. Evaluate the function $y(t) = 2 e^{\\omega_I t} (A_R \\cos(\\omega_R t) + A_I \\sin(\\omega_R t))$ at the specified times.\n$8$. Collect and format the results as required.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the scalar ringdown signal y(t) for a 2-DOF damped system.\n\n    The problem involves finding the least-damped normal mode of a system defined by\n    M*x_ddot + C*x_dot + K*x = 0, constructing a scalar signal y(t) based on\n    this mode's frequency, and matching it to the initial conditions of the first\n    coordinate, x1(0) and x1_dot(0).\n    \"\"\"\n\n    # Test cases defined as (m1, m2, k1, k2, kappa, c1, c2, c_c, x0, v0, times)\n    test_cases = [\n        (1, 1.2, 100, 120, 30, 0.8, 0.9, 0.05, \n         np.array([0.01, 0]), np.array([0, 0]), [0, 0.02, 0.1, 0.5]),\n        (1, 1, 200, 150, 50, 0.05, 0.05, 0.02, \n         np.array([0, 0.01]), np.array([0, 0]), [0, 0.05, 0.2, 0.5]),\n        (2, 1.5, 80, 90, 70, 2.5, 1.5, 0.7, \n         np.array([-0.005, 0.002]), np.array([0, 0]), [0, 0.1, 0.3, 0.7]),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        m1, m2, k1, k2, kappa, c1, c2, c_c, x0, v0, times = case\n        \n        # 1. Construct system matrices M, C, K\n        M = np.array([[m1, 0], [0, m2]])\n        K = np.array([[k1 + kappa, -kappa], [-kappa, k2 + kappa]])\n        C = np.array([[c1 + c_c, -c_c], [-c_c, c2 + c_c]])\n\n        # 2. Construct the state-space matrix A\n        M_inv = np.linalg.inv(M)\n        A_ss = np.block([\n            [np.zeros((2, 2)), np.eye(2)],\n            [-M_inv @ K, -M_inv @ C]\n        ])\n\n        # 3. Compute eigenvalues of A\n        s_vals = np.linalg.eigvals(A_ss)\n\n        # 4. Find the least-damped mode s_ld\n        # This is the eigenvalue with the largest (least negative) real part.\n        # We choose the one with a non-negative imaginary part by convention.\n        s_ld = s_vals[np.argmax(np.real(s_vals))]\n        if np.imag(s_ld) < 0:\n            s_ld = np.conj(s_ld)\n\n        # 5. Calculate complex frequency omega\n        omega = 1j * s_ld\n        omega_R = np.real(omega)\n        omega_I = np.imag(omega)\n\n        # Initial conditions for scalar signal y(t)\n        y0 = x0[0]\n        y0_dot = v0[0]\n\n        case_results = []\n        \n        # Handle the trivial case where y(t) must be zero\n        if np.isclose(y0, 0) and np.isclose(y0_dot, 0):\n            for t in times:\n                case_results.append(0.0)\n            all_results.append(case_results)\n            continue\n            \n        # 6. Compute coefficients of complex amplitude A\n        A_R = y0 / 2.0\n        \n        # If omega_R is zero, it's a non-oscillatory mode.\n        # The formula for y(t) simplifies, and A_I is not well-defined by the general formula.\n        # Given the problem context, we assume underdamped modes.\n        if np.isclose(omega_R, 0):\n             # For a non-oscillatory mode, the signal model is y(t) = 2*A_R*exp(omega_I*t)\n             # The derivative condition becomes y0_dot = 2*A_R*omega_I = y0*omega_I\n             # If y0_dot != y0*omega_I, the conditions are inconsistent for this model.\n             # However, problem parameters lead to underdamped modes where omega_R is not zero.\n             # We can proceed assuming omega_R != 0 for these cases.\n             A_I = 0.0\n        else:\n            A_I = (y0_dot - omega_I * y0) / (2.0 * omega_R)\n\n        # 7. Evaluate y(t) at specified times\n        for t in times:\n            val = 2.0 * np.exp(omega_I * t) * (A_R * np.cos(omega_R * t) + A_I * np.sin(omega_R * t))\n            case_results.append(val)\n        \n        all_results.append(case_results)\n\n    # 8. Format the final output\n    formatted_lists = []\n    for res_list in all_results:\n        formatted_vals = [f\"{val:.6f}\" for val in res_list]\n        formatted_lists.append(f\"[{','.join(formatted_vals)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_lists)}]\")\n\nsolve()\n```", "id": "2418598"}, {"introduction": "Gravitational wave observations offer unprecedented opportunities to test general relativity in the strong-field regime. This advanced practice places you in the role of a gravitational-wave astronomer, tasked with testing the celebrated \"no-hair\" theorem. By simulating ringdown signals from different merger histories that theoretically produce the same final black hole, you will perform a complete data analysis pipeline—from signal generation and noise injection to parameter estimation—to verify that the final state's properties are indeed independent of its formation pathway, as the theorem predicts [@problem_id:2399211].", "problem": "You will design and implement a computational experiment to test the black hole \"no-hair\" theorem in the ringdown phase of gravitational waves from compact binary mergers. The no-hair theorem asserts that the exterior spacetime of an astrophysical black hole is completely characterized by a small set of macroscopic parameters. For astrophysically realistic scenarios with negligible electrical charge, these are the final black hole mass and dimensionless spin. In the ringdown regime following a merger, gravitational perturbations are well described by superpositions of damped sinusoids called quasi-normal modes, whose frequencies and damping times depend only on the final mass and spin.\n\nStart from the following fundamental base:\n- In linear perturbation theory of a Kerr black hole, the perturbations obey a separable wave equation, and the late-time signal is a superposition of damped sinusoids (quasi-normal modes). Dimensional analysis implies that for a fixed dimensionless spin, the quasi-normal mode frequencies scale inversely with the black hole mass. The definition of quality factor relates the real frequency and damping time.\n- Use the leading quasi-normal mode with spherical-harmonic indices $(\\ell, m, n) = (2, 2, 0)$ as the signal model for each event, modeled in the time domain as $h(t) = A \\exp(-t/\\tau) \\cos(2 \\pi f t + \\phi)$ for $t \\ge 0$, where $A$ is an overall amplitude, $f$ is the real frequency in hertz, $\\tau$ is the damping time in seconds, and $\\phi$ is a constant phase in radians.\n- Use the well-tested fitting functions for the dimensionless angular frequency and quality factor of the $(2, 2, 0)$ mode, expressed as functions of the dimensionless spin $\\chi \\in [0, 1)$:\n  $$M \\omega_{22}(\\chi) = 1.5251 - 1.1568 \\left(1 - \\chi\\right)^{0.1292},$$\n  $$Q_{22}(\\chi) = 0.7000 + 1.4187 \\left(1 - \\chi\\right)^{-0.4990}.$$\n  Here $M \\omega_{22}$ is the dimensionless angular frequency (geometric units with $G = c = 1$). Convert from dimensionless quantities to physical units using\n  $$f = \\frac{c^3}{2 \\pi G M} \\left(M \\omega_{22}(\\chi)\\right), \\quad \\tau = \\frac{Q_{22}(\\chi)}{\\pi f},$$\n  with $G$ the gravitational constant, $c$ the speed of light, and $M$ the final black hole mass. Use $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m}^3\\ \\mathrm{kg}^{-1}\\ \\mathrm{s}^{-2}$, $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$, and the solar mass $M_{\\odot} = 1.98847 \\times 10^{30}\\ \\mathrm{kg}$. Express masses in units of $M_{\\odot}$ and times in seconds; angles are in radians.\n\nYour task:\n- Simulate, for each test case below, two independent ringdown signals (two different merger events) with potentially different amplitudes and phases, but with the specified final mass and spin parameters for each event in the pair. Each signal is a single $(2, 2, 0)$ damped sinusoid beginning at $t = 0$ with additive zero-mean Gaussian white noise. Use a sampling frequency $f_{\\mathrm{s}} = 4096\\ \\mathrm{Hz}$ and a total duration $T = 0.1\\ \\mathrm{s}$. The noise standard deviation is a given parameter in units of the strain amplitude. Angles must be treated in radians.\n- For each event, estimate the mode parameters $(f, \\tau)$ by fitting the noisy time series to the single damped sinusoid model. Then use the measured $(f, \\tau)$ to infer the final dimensionless spin $\\chi$ and mass $M$ as follows: compute the measured quality factor $Q_{\\mathrm{meas}} = \\pi f \\tau$ and invert $Q_{22}(\\chi)$ to determine $\\chi$; then use the measured $f$ and the inferred $\\chi$ to compute $M$ from the frequency scaling relation. Report $M$ in units of $M_{\\odot}$.\n- Devise a no-hair consistency decision for each test case, defined as follows: given the two inferences $(M_1, \\chi_1)$ and $(M_2, \\chi_2)$ from the two events, return true if both the fractional mass difference satisfies $\\lvert M_1 - M_2 \\rvert / \\left( \\frac{M_1 + M_2}{2} \\right) \\le 0.02$ and the absolute spin difference satisfies $\\lvert \\chi_1 - \\chi_2 \\rvert \\le 0.02$, and false otherwise.\n\nPhysical units and angle units requirement:\n- Frequencies must be in hertz, times in seconds, masses reported in $M_{\\odot}$, and angles interpreted in radians at all stages.\n\nTest suite:\n- Use the following three cases, each defined by a pair of events with parameters $(M/M_{\\odot}, \\chi, A, \\phi, \\sigma)$ where $M$ is the final mass in $M_{\\odot}$, $\\chi$ is the dimensionless spin, $A$ is the amplitude, $\\phi$ is the phase in radians, and $\\sigma$ is the standard deviation of the Gaussian white noise:\n  - Case $1$:\n    - Event $\\mathrm{A1}$: $(60, 0.70, 1.0, 0.3, 1.0 \\times 10^{-3})$,\n    - Event $\\mathrm{A2}$: $(60, 0.70, 0.7, 2.1, 1.0 \\times 10^{-3})$.\n  - Case $2$:\n    - Event $\\mathrm{B1}$: $(60, 0.70, 1.0, 1.0, 1.0 \\times 10^{-3})$,\n    - Event $\\mathrm{B2}$: $(60, 0.65, 0.8, 2.3, 1.0 \\times 10^{-3})$.\n  - Case $3$:\n    - Event $\\mathrm{C1}$: $(60, 0.70, 1.0, 0.1, 1.0 \\times 10^{-3})$,\n    - Event $\\mathrm{C2}$: $(58, 0.70, 0.9, 1.7, 1.0 \\times 10^{-3})$.\n\nProgram requirements:\n- Implement a complete, runnable program that performs the simulation, parameter estimation, inversion from $(f, \\tau)$ to $(\\chi, M)$, and the final no-hair consistency decision for each of the three cases described above.\n- Deterministic noise is required to ensure reproducibility; use a fixed random number generator seed of your choice and document it in the code.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, \"[true,false,true]\" but with the actual Python boolean capitalization and no spaces. The output must be a list of three boolean values corresponding to the three cases, in order.\n\nDeliverables:\n- A self-contained program that, without user input, simulates the signals, performs the estimation and inversion, and outputs a single line as specified.", "solution": "The problem statement has been critically examined and is determined to be valid. It constitutes a well-posed, scientifically grounded computational experiment in the field of gravitational-wave physics. It is free of contradiction, ambiguity, and factual error. The task is to simulate a test of the black hole no-hair theorem, which is a cornerstone of general relativity, using a standard and simplified model of the ringdown phase of a binary merger. All necessary physical constants, mathematical models, and numerical parameters are provided. We may therefore proceed with the solution.\n\nThe solution is structured as a computational procedure that encompasses signal simulation, parameter estimation, and a final consistency test based on the principles of black hole perturbation theory.\n\nFirst, we establish the theoretical foundation. The no-hair theorem posits that a stationary, isolated, uncharged black hole is completely described by its mass $M$ and spin angular momentum $J$. The dimensionless spin parameter is defined as $\\chi = cJ/(GM^2)$, with $\\chi \\in [0, 1)$. Perturbations of the Kerr spacetime geometry, such as those produced in the aftermath of a binary merger, radiate away as gravitational waves. In the late-time ringdown phase, the signal is a superposition of quasi-normal modes (QNMs), each being a damped sinusoid. The frequencies and damping times of these modes are predicted by linear perturbation theory to depend only on the final black hole's mass $M$ and spin $\\chi$.\n\nFor this problem, we model the dominant $(\\ell, m, n) = (2, 2, 0)$ QNM. Its time-domain representation is given by:\n$$h(t) = A e^{-t/\\tau} \\cos(2 \\pi f t + \\phi)$$\nwhere $A$ is the amplitude, $f$ is the frequency, $\\tau$ is the damping time, and $\\phi$ is the phase. The parameters $f$ and $\\tau$ are not independent but are determined by $(M, \\chi)$. The problem provides phenomenological fitting formulas for the dimensionless angular frequency $M\\omega_{22}(\\chi)$ and quality factor $Q_{22}(\\chi)$:\n$$M \\omega_{22}(\\chi) = 1.5251 - 1.1568 (1 - \\chi)^{0.1292}$$\n$$Q_{22}(\\chi) = 0.7000 + 1.4187 (1 - \\chi)^{-0.4990}$$\nThese dimensionless quantities are converted to physical observables using fundamental constants $G$ and $c$:\n$$f = \\frac{c^3}{2 \\pi G M} \\left(M \\omega_{22}(\\chi)\\right)$$\n$$\\tau = \\frac{Q_{22}(\\chi)}{\\pi f}$$\nHere, $M$ is the mass in kilograms. When providing mass in units of solar mass $M_{\\odot}$, the proper conversion must be applied. Let $M_{sol} = M/M_{\\odot}$. The frequency equation can be written as $f = C_f \\frac{M\\omega_{22}(\\chi)}{M_{sol}}$, where $C_f = \\frac{c^3}{2 \\pi G M_{\\odot}}$ is a constant.\n\nThe computational experiment consists of the following steps:\n\n1.  **Signal Generation (Forward Problem)**: For each event specified in a test case, we first compute the theoretical values of $f$ and $\\tau$ from the given \"true\" parameters $(M, \\chi)$. The mass $M$ given in solar masses must be converted to kilograms for this calculation. A discrete time series is then generated for a duration $T = 0.1 \\text{ s}$ with a sampling rate $f_s = 4096 \\text{ Hz}$. This involves creating a time vector $t_k = k/f_s$ for $k = 0, 1, ..., N-1$, where $N = T f_s$. The clean signal $h(t_k)$ is calculated at these time points. Finally, zero-mean Gaussian white noise is added. The noise is generated using a fixed random seed for reproducibility, with its standard deviation $\\sigma$ given in the test case parameters.\n\n2.  **Parameter Estimation (Inverse Problem, Part 1)**: The core of the analysis is to estimate the signal parameters from the noisy data. We fit the generated time series data to the four-parameter model $h(t; A, f, \\tau, \\phi)$. This is a non-linear least-squares fitting problem, for which we employ the Levenberg-Marquardt algorithm, as implemented in `scipy.optimize.curve_fit`. The success of such a fit depends critically on providing reasonable initial guesses for the parameters $(A, f, \\tau, \\phi)$. An initial guess for the amplitude $A$ can be the maximum absolute value of the data. Based on the problem's physical parameters, an initial frequency of $f \\approx 280\\ \\mathrm{Hz}$ and damping time $\\tau \\approx 4\\ \\mathrm{ms}$ are appropriate. The phase can be initialized to $0$. The fit yields the estimated parameters $(f_{meas}, \\tau_{meas})$.\n\n3.  **Inference of Black Hole Parameters (Inverse Problem, Part 2)**: With the measured $(f_{meas}, \\tau_{meas})$, we test the no-hair hypothesis by inverting the relations to infer the black hole parameters $(M_{inf}, \\chi_{inf})$.\n    *   First, the measured quality factor is computed: $Q_{meas} = \\pi f_{meas} \\tau_{meas}$.\n    *   Next, we solve for the spin $\\chi$ from the equation $Q_{meas} = Q_{22}(\\chi)$. This equation can be analytically inverted:\n        $$\\chi_{inf} = 1 - \\left( \\frac{Q_{meas} - 0.7000}{1.4187} \\right)^{-1/0.4990}$$\n        It is necessary to respect the physical domain $\\chi \\in [0, 1)$. The function $Q_{22}(\\chi)$ has a minimum value at $\\chi=0$, which is $Q_{22}(0) \\approx 2.1187$. If measurement noise results in $Q_{meas} < Q_{22}(0)$, the formula would yield an unphysical negative spin. In such cases, the inferred spin must be clipped to $\\chi_{inf} = 0$, the closest physical value.\n    *   With the inferred spin $\\chi_{inf}$, we then compute the theoretical dimensionless frequency $M\\omega_{22}(\\chi_{inf})$.\n    *   Finally, we invert the frequency relation to solve for the mass $M_{inf}$. The mass in solar units is given by:\n        $$M_{inf}/M_{\\odot} = \\left(\\frac{c^3}{2 \\pi G M_{\\odot}}\\right) \\frac{M\\omega_{22}(\\chi_{inf})}{f_{meas}}$$\n\n4.  **No-Hair Consistency Decision**: This procedure is performed for both events in a given test case, yielding two sets of inferred parameters: $(M_1, \\chi_1)$ and $(M_2, \\chi_2)$. According to the no-hair theorem, if both signals originated from black holes with identical mass and spin, the inferred parameters should be consistent within statistical uncertainty. The problem defines a specific quantitative test for this consistency: the result is `true` if and only if both the fractional mass difference and the absolute spin difference are below specified thresholds:\n    $$\\frac{|M_1 - M_2|}{\\frac{1}{2}(M_1 + M_2)} \\le 0.02 \\quad \\text{and} \\quad |\\chi_1 - \\chi_2| \\le 0.02$$\n    Otherwise, the result is `false`.\n\nThis entire sequence is implemented for each of the three test cases. The final output is a list of three boolean values corresponding to the consistency check for each case.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Simulates a test of the black hole no-hair theorem for binary merger ringdowns.\n    \"\"\"\n    # Physical constants\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    C = 2.99792458e8  # m s^-1\n    M_SUN = 1.98847e30  # kg\n\n    # Simulation parameters\n    FS = 4096.0  # Hz\n    T = 0.1  # s\n    MAIN_SEED = 42 # For reproducibility of noise\n\n    # Test cases: (M/M_solar, chi, Amplitude, phase_rad, noise_std)\n    test_cases = [\n        # Case 1\n        [\n            (60.0, 0.70, 1.0, 0.3, 1.0e-3),\n            (60.0, 0.70, 0.7, 2.1, 1.0e-3)\n        ],\n        # Case 2\n        [\n            (60.0, 0.70, 1.0, 1.0, 1.0e-3),\n            (60.0, 0.65, 0.8, 2.3, 1.0e-3)\n        ],\n        # Case 3\n        [\n            (60.0, 0.70, 1.0, 0.1, 1.0e-3),\n            (58.0, 0.70, 0.9, 1.7, 1.0e-3)\n        ]\n    ]\n\n    # Pre-calculated constant for frequency conversion\n    # CF = c^3 / (2 * pi * G * M_sun)\n    CF = C**3 / (2 * np.pi * G * M_SUN)\n\n    def M_omega_22(chi):\n        \"\"\"Dimensionless angular frequency of the (2,2,0) mode.\"\"\"\n        return 1.5251 - 1.1568 * (1 - chi)**0.1292\n\n    def Q_22(chi):\n        \"\"\"Quality factor of the (2,2,0) mode.\"\"\"\n        return 0.7000 + 1.4187 * (1 - chi)**-0.4990\n\n    def model_func(t, A, f, tau, phi):\n        \"\"\"Damped sinusoid model for fitting.\"\"\"\n        return A * np.exp(-t / tau) * np.cos(2 * np.pi * f * t + phi)\n\n    def analyze_event(event_params, event_seed):\n        \"\"\"\n        Generates a noisy signal, fits it, and infers (M, chi).\n        \"\"\"\n        M_sol, chi, A, phi, sigma = event_params\n        \n        # 1. Forward model: Calculate true f and tau\n        f_true = CF * M_omega_22(chi) / M_sol\n        q_true = Q_22(chi)\n        tau_true = q_true / (np.pi * f_true)\n\n        # 2. Generate signal\n        t = np.arange(0, T, 1.0 / FS)\n        h_clean = model_func(t, A, f_true, tau_true, phi)\n        \n        rng = np.random.default_rng(event_seed)\n        noise = rng.normal(0, sigma, len(t))\n        h_noisy = h_clean + noise\n\n        # 3. Parameter estimation\n        # Initial guesses for the fit\n        p0 = [np.max(np.abs(h_noisy)), f_true, tau_true, phi]\n        bounds = ([0, 0, 0, -np.pi], [np.inf, FS / 2, np.inf, np.pi])\n        \n        try:\n            popt, _ = curve_fit(model_func, t, h_noisy, p0=p0, bounds=bounds, maxfev=5000)\n            f_meas, tau_meas = popt[1], popt[2]\n        except RuntimeError:\n            return np.nan, np.nan # Fit failed\n\n        # 4. Inversion to (M, chi)\n        Q_meas = np.pi * f_meas * tau_meas\n        \n        # Invert Q_22(chi) to find chi\n        # chi = 1 - ((Q_meas - 0.7) / 1.4187)^(-1/0.4990)\n        q_arg = (Q_meas - 0.7000) / 1.4187\n        \n        # The minimum physical Q corresponds to chi=0, where q_arg = 1.\n        # If noise causes Q_meas to be too low, q_arg < 1, which implies chi < 0.\n        # We clip to the physical boundary chi=0.\n        if q_arg <= 1.0:\n            chi_inf = 0.0\n        else:\n            chi_inf = 1.0 - q_arg**(-1.0 / 0.4990)\n        \n        # Invert frequency relation for M\n        m_omega_val = M_omega_22(chi_inf)\n        M_inf_sol = CF * m_omega_val / f_meas\n        \n        return M_inf_sol, chi_inf\n\n    results = []\n    event_seed_counter = 0\n    for case in test_cases:\n        event1_params, event2_params = case\n        \n        seed1 = MAIN_SEED + event_seed_counter\n        M1, chi1 = analyze_event(event1_params, seed1)\n        event_seed_counter += 1\n        \n        seed2 = MAIN_SEED + event_seed_counter\n        M2, chi2 = analyze_event(event2_params, seed2)\n        event_seed_counter += 1\n\n        if np.isnan(M1) or np.isnan(M2):\n            is_consistent = False\n        else:\n            # 5. No-hair consistency check\n            mass_diff = np.abs(M1 - M2) / (0.5 * (M1 + M2))\n            spin_diff = np.abs(chi1 - chi2)\n            \n            is_consistent = (mass_diff <= 0.02) and (spin_diff <= 0.02)\n\n        results.append(is_consistent)\n\n    # Format output as required\n    print(f\"[{','.join(map(str, results))}]\".replace(\"True\", \"true\").replace(\"False\", \"false\"))\n\nsolve()\n```", "id": "2399211"}]}