{"hands_on_practices": [{"introduction": "A fundamental challenge in simulating black holes is representing their singular nature on a regular computational grid. The \"puncture\" method, combined with specific slicings of spacetime like the \"trumpet\" geometry, elegantly solves this by excising the singularity and evolving only the exterior region. This exercise explores the geometric implications of such a choice by asking you to calculate a physical distance in a black hole spacetime described by a specific, non-trivial conformal factor [@problem_id:906998]. Mastering this type of calculation is key to understanding how the abstract coordinates of a simulation map onto the physical reality of the spacetime being modeled.", "problem": "In the 3+1 decomposition of spacetime, a common technique for numerical simulations of black holes is to use a conformally flat spatial metric on each time slice. For a non-rotating black hole of mass $M$, the spatial geometry can be described by a line element in spherical-like coordinates $(r, \\theta, \\phi)$:\n$$ dl^2 = \\psi^4(r) (dr^2 + r^2 d\\Omega^2) $$\nwhere $d\\Omega^2 = d\\theta^2 + \\sin^2\\theta d\\phi^2$, and $\\psi(r)$ is the conformal factor. The choice of $\\psi(r)$ corresponds to a specific slicing of the Schwarzschild spacetime. Slicings that avoid the central singularity by pushing it to an infinite proper distance are known as \"trumpet\" slices.\n\nThe proper radial distance $L$ between two spheres at coordinate radii $r_1$ and $r_2$ is given by the integral of the proper distance element along a radial path:\n$$ L = \\int_{r_1}^{r_2} \\psi^2(r) dr $$\n\nConsider a hypothetical trumpet-like slice of a spacetime containing a central mass $M$, for which the square of the conformal factor is given by\n$$ \\psi^2(r) = 1 + \\frac{M}{r} + \\frac{\\alpha M^2}{(r+\\beta M)^2} $$\nwhere $\\alpha$ and $\\beta$ are given positive dimensionless constants.\n\nCalculate the proper radial distance $L$ between the sphere at coordinate radius $r_1 = M$ and the sphere at $r_2 = 2M$. Express your answer as a closed-form expression in terms of the mass $M$ and the constants $\\alpha$ and $\\beta$.", "solution": "1. Write the integral as a sum:\n$$L=\\int_{M}^{2M}\\Bigl(1+\\frac{M}{r}+\\frac{\\alpha M^2}{(r+\\beta M)^2}\\Bigr)dr\n=\\int_{M}^{2M}dr+\\int_{M}^{2M}\\frac{M}{r}dr+\\int_{M}^{2M}\\frac{\\alpha M^2}{(r+\\beta M)^2}dr.$$\n\n2. Integrate term by term:\n$$\\int dr=r,\\quad\n\\int\\frac{M}{r}dr=M\\ln r,\\quad\n\\int\\frac{\\alpha M^2}{(r+\\beta M)^2}dr\n=-\\frac{\\alpha M^2}{r+\\beta M}.$$\n\n3. Combine and evaluate from $r=M$ to $r=2M$:\n$$L=\\Bigl[r+M\\ln r-\\frac{\\alpha M^2}{r+\\beta M}\\Bigr]_{M}^{2M}.$$\nAt $r=2M$:\n$$2M+M\\ln(2M)-\\frac{\\alpha M^2}{2M+\\beta M}\n=2M+M(\\ln2+\\ln M)-\\frac{\\alpha M}{2+\\beta}.$$\nAt $r=M$:\n$$M+M\\ln M-\\frac{\\alpha M^2}{M+\\beta M}\n=M+M\\ln M-\\frac{\\alpha M}{1+\\beta}.$$\nSubtracting lower from upper:\n$$L=\\bigl(2M+M\\ln2+M\\ln M-\\frac{\\alpha M}{2+\\beta}\\bigr)\n-\\bigl(M+M\\ln M-\\frac{\\alpha M}{1+\\beta}\\bigr)$$\n$$=M+M\\ln2\n+\\alpha M\\Bigl(\\frac{1}{1+\\beta}-\\frac{1}{2+\\beta}\\Bigr)\n=M\\Bigl(1+\\ln2+\\frac{\\alpha}{(1+\\beta)(2+\\beta)}\\Bigr).$$", "answer": "$$\\boxed{M\\Bigl(1+\\ln2+\\frac{\\alpha}{(1+\\beta)(2+\\beta)}\\Bigr)}$$", "id": "906998"}, {"introduction": "The merger of black holes and neutron stars inevitably creates shock waves and sharp discontinuities in the fluid. Accurately capturing these features without introducing spurious numerical oscillations is paramount for a stable and accurate simulation. Weighted Essentially Non-Oscillatory (WENO) schemes are a powerful class of methods designed for this purpose, adaptively using information about the smoothness of the solution to build a high-quality reconstruction. This practice provides direct insight into the inner workings of a WENO scheme by having you compute its non-linear weights in the presence of an idealized shock front [@problem_id:906993].", "problem": "In the numerical simulation of relativistic astrophysical phenomena, such as black hole or neutron star mergers, high-order, shock-capturing numerical methods are essential for accurately evolving the equations of general relativistic hydrodynamics. The Weighted Essentially Non-Oscillatory (WENO) reconstruction is a widely used technique to achieve high-order accuracy in smooth regions of the solution while avoiding spurious oscillations near discontinuities like shock fronts.\n\nThis problem concerns the 5th-order accurate WENO scheme (WENO5). Consider a uniform one-dimensional grid with cell spacing $\\Delta x$. The cell-averaged values of a scalar fluid variable $q$ at cell $i$ are denoted by $q_i$. The WENO5 scheme reconstructs the value of $q$ at the interface $x_{i+1/2}$ between cells $i$ and $i+1$ by combining three 3rd-order polynomial reconstructions, each based on a different 3-cell sub-stencil: $S_0 = \\{q_{i-2}, q_{i-1}, q_i\\}$, $S_1 = \\{q_{i-1}, q_i, q_{i+1}\\}$, and $S_2 = \\{q_i, q_{i+1}, q_{i+2}\\}$.\n\nThe reconstructed value is given by a weighted average:\n$$\nq_{i+1/2} = w_0 \\hat{q}_0 + w_1 \\hat{q}_1 + w_2 \\hat{q}_2\n$$\nwhere $\\hat{q}_k$ are the values obtained from the $k$-th sub-stencil's reconstruction polynomial.\nThe non-linear weights $w_k$ are the core of the WENO method. They are computed as:\n$$\nw_k = \\frac{\\alpha_k}{\\sum_{j=0}^{2} \\alpha_j} \\quad , \\quad \\alpha_k = \\frac{d_k}{(\\epsilon + \\beta_k)^p}\n$$\nHere, $d_k$ are the optimal weights that yield 5th-order accuracy for smooth solutions. For the interface $x_{i+1/2}$, these are $d_0 = 1/10$, $d_1 = 6/10$, and $d_2 = 3/10$. The parameter $p$ is typically set to $p=2$. The small constant $\\epsilon > 0$ prevents division by zero. The quantities $\\beta_k$ are the smoothness indicators for each sub-stencil, defined as:\n$$\n\\begin{aligned}\n\\beta_0 &= \\frac{13}{12}(q_{i-2} - 2q_{i-1} + q_i)^2 + \\frac{1}{4}(q_{i-2} - 4q_{i-1} + 3q_i)^2 \\\\\n\\beta_1 &= \\frac{13}{12}(q_{i-1} - 2q_i + q_{i+1})^2 + \\frac{1}{4}(q_{i-1} - q_{i+1})^2 \\\\\n\\beta_2 &= \\frac{13}{12}(q_i - 2q_{i+1} + q_{i+2})^2 + \\frac{1}{4}(3q_i - 4q_{i+1} + q_{i+2})^2\n\\end{aligned}\n$$\nThese indicators measure the oscillatory content of the solution on each stencil. In smooth regions, $\\beta_k$ are small and $w_k \\approx d_k$. Near a discontinuity, the $\\beta_k$ for stencils crossing the discontinuity become large, and their corresponding weights $w_k$ become very small.\n\n**Problem:**\nConsider a 5-cell stencil $\\{i-2, i-1, i, i+1, i+2\\}$ describing the profile of the rest-mass density $\\rho$ of a relativistic fluid across a stationary shock front located at the interface $x_{i+1/2}$. The cell-averaged values are given by:\n$$\n\\rho_{i-2} = \\rho_L, \\quad \\rho_{i-1} = \\rho_L, \\quad \\rho_i = \\rho_L, \\quad \\rho_{i+1} = \\rho_R, \\quad \\rho_{i+2} = \\rho_R\n$$\nwhere $\\rho_L$ and $\\rho_R$ are the constant density states to the left and right of the shock, respectively.\n\nUsing the WENO5 formulation with $p=2$, determine the non-linear weight $w_1$ for the reconstruction at the interface $x_{i+1/2}$. Your final answer should be a symbolic expression in terms of $\\rho_L$, $\\rho_R$, and the parameter $\\epsilon$.", "solution": "1. Define $\\Delta\\rho=\\rho_R-\\rho_L$.\n2. Compute smoothness indicators:\n   $$\n   \\beta_0=0,\\quad\n   \\beta_1=\\frac{4}{3}\\,\\Delta\\rho^2,\\quad\n   \\beta_2=\\frac{10}{3}\\,\\Delta\\rho^2.\n   $$\n3. Compute $\\alpha_k$:\n   $$\n   \\alpha_0=\\frac{1/10}{(\\epsilon+0)^2}\n             =\\frac{1}{10\\,\\epsilon^2},\\quad\n   \\alpha_1=\\frac{6/10}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}\n             =\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2},\n   $$\n   $$\n   \\alpha_2=\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}\\Delta\\rho^2\\bigr)^2}.\n   $$\n4. Form the nonlinear weight $w_1$:\n   $$\n   w_1\n   =\\frac{\\alpha_1}{\\alpha_0+\\alpha_1+\\alpha_2}\n   =\\frac{\\displaystyle \\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}}\n         {\\displaystyle \\frac{1}{10\\,\\epsilon^2}\n          +\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}\n          +\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}\\Delta\\rho^2\\bigr)^2}}.\n   $$\n5. Substitute back $\\Delta\\rho=\\rho_R-\\rho_L$.", "answer": "$$\\boxed{\\frac{\\displaystyle \\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}}\n{\\displaystyle \\frac{1}{10\\,\\epsilon^2}\n+\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}\n+\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}}}$$", "id": "906993"}, {"introduction": "Numerical relativity codes for hydrodynamics typically evolve a set of conserved quantities like energy and momentum density. However, the underlying physics and the equations themselves often depend on primitive variables like pressure and velocity. The \"conservative-to-primitive\" recovery is the crucial, and often difficult, algebraic step that bridges this gap at every point in space and time. This practice delves into the robustness of this procedure, asking you to find the condition under which the recovery fails, leading to an unphysical state [@problem_id:906980]. Understanding these failure modes is essential for developing robust simulation codes and interpreting their output correctly.", "problem": "In numerical simulations of relativistic fluids, a crucial step is the \"primitive variable recovery\", where physical quantities like pressure ($p$) and the Lorentz factor ($W$) are determined from the conserved variables evolved by the code. For certain physical states, this recovery can fail, indicating a breakdown of the model or the emergence of unphysical conditions due to numerical error.\n\nConsider a one-dimensional, non-magnetized, relativistic radiation fluid. Such a fluid is described by a gamma-law equation of state relating its pressure $p$ to its comoving frame energy density $\\mathcal{E}$ via $p = (\\Gamma-1)\\mathcal{E}$, with a constant adiabatic index $\\Gamma \\in (1, 2]$. General relativity defines the following lab-frame conserved quantities (in units where $c=1$):\n- The conserved energy density, $\\tau = W^2 (\\mathcal{E} + p) - p$.\n- The conserved momentum density, $S = W^2 (\\mathcal{E} + p) v$.\n\nHere, $W = (1-v^2)^{-1/2}$ is the fluid's Lorentz factor and $v$ is its velocity.\n\nThe primitive recovery procedure involves solving for the primitive variables ($p$, $v$, $\\mathcal{E}$) from the known conserved variables ($\\tau$, $S$). Combining the equations above leads to an algebraic equation for the Lorentz factor $W$. It can be shown that this is a quadratic equation in terms of $x = W^2$.\n\nYour task is to find the criterion, expressed as an inequality involving the ratio $S^2/\\tau^2$ and the adiabatic index $\\Gamma$, for which this quadratic equation for $x=W^2$ has no real solutions. Such a situation represents a state from which no consistent physical primitives can be recovered.", "solution": "Relevant equations:\n$$p=(\\Gamma-1)\\mathcal{E},\\quad\n\\tau=W^2(\\mathcal{E}+p)-p,\\quad\nS=W^2(\\mathcal{E}+p)\\,v,\\quad\nW^2=x,\\quad v=\\sqrt{1-\\frac1x}.$$\n\n1. Write $\\mathcal{E}+p=\\Gamma\\mathcal{E}$ and $p=\\mathcal{E}(\\Gamma-1)$, so\n$$\\tau=x\\,\\Gamma\\mathcal{E}-p,\\quad S=x\\,\\Gamma\\mathcal{E}\\,\\sqrt{1-\\frac1x}.$$\n\n2. Solve for $p$ from $\\tau$:\n$$\\tau=x\\,\\frac{\\Gamma p}{\\Gamma-1}-p\n\\;\\Longrightarrow\\;p\n=\\frac{\\tau(\\Gamma-1)}{\\Gamma x-(\\Gamma-1)}.$$\n\n3. Square $S$:\n$$S^2\n=\\Bigl(x\\,\\frac{\\Gamma p}{\\Gamma-1}\\Bigr)^{2}\\Bigl(1-\\frac1x\\Bigr)\n=\\frac{\\Gamma^2\\,p^2}{(\\Gamma-1)^2}\\,x(x-1).$$\n\n4. Define $\\sigma=\\frac{S^2}{\\tau^2}$ and substitute $p$:\n$$\\sigma\n=\\frac{\\Gamma^2\\,x(x-1)}{\\bigl(\\Gamma x-(\\Gamma-1)\\bigr)^2}.$$\n\n5. Multiply out to get a quadratic in $x$:\n$$\\sigma\\bigl(\\Gamma x-(\\Gamma-1)\\bigr)^2=\\Gamma^2x(x-1)\n\\;\\Longrightarrow\\;\nA\\,x^2+B\\,x+C=0,$$\nwith $A=\\Gamma^2(\\sigma-1)$, $B=\\Gamma^2-2\\Gamma(\\Gamma-1)\\sigma$, and $C=(\\Gamma-1)^2\\sigma$.\n\n6. Compute the discriminant $\\Delta=B^2-4AC$:\n\n$$\n\\Delta\n=\\Gamma^2\\Bigl[\\Gamma-2(\\Gamma-1)\\sigma\\Bigr]^2\n-4\\,\\Gamma^2(\\sigma-1)(\\Gamma-1)^2\\sigma\n=\\Gamma^2\\bigl[\\Gamma^2-4(\\Gamma-1)\\sigma\\bigr].\n$$\n\n\n7. No real solutions when $\\Delta0$:\n$$\\Gamma^2-4(\\Gamma-1)\\sigma0\n\\;\\Longrightarrow\\;\n\\sigma\\frac{\\Gamma^2}{4(\\Gamma-1)}.$$\nThus the breakdown criterion is\n$$\\frac{S^2}{\\tau^2}\\frac{\\Gamma^2}{4(\\Gamma-1)}.$$", "answer": "$$\\boxed{\\frac{S^2}{\\tau^2}\\frac{\\Gamma^2}{4(\\Gamma-1)}}$$", "id": "906980"}]}