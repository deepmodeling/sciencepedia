{"hands_on_practices": [{"introduction": "We begin our exploration with one of the simplest solvable cosmological models: an empty universe with negative spatial curvature, known as the Milne model. By applying these specific conditions to the Friedmann equation, we can derive a fundamental timescale for cosmic expansion, the Hubble time, $t_H = 1/H_0$. This exercise serves as a crucial first step, establishing a clear connection between cosmic geometry and dynamics and providing a baseline for comparison with more complex, matter-filled universes [@problem_id:853752].", "problem": "In the context of the Friedmann-Lemaître-Robertson-Walker (FLRW) cosmological models, the evolution of the universe's scale factor, $a(t)$, is described by the first Friedmann equation:\n$$ \\left(\\frac{\\dot{a}}{a}\\right)^2 = \\frac{8\\pi G}{3c^2} \\varepsilon(a) - \\frac{k c^2}{a^2} $$\nHere, $\\dot{a} \\equiv da/dt$, $a(t)$ is the scale factor normalized to $a(t_0)=1$ at the present time $t_0$, $\\varepsilon(a)$ is the total energy density as a function of the scale factor, $G$ is the gravitational constant, $c$ is the speed of light, and $k$ is the dimensionless spatial curvature parameter ($k=+1, 0, -1$ for closed, flat, and open universes, respectively). The Hubble parameter is defined as $H(t) = \\dot{a}/a$, with its present-day value being $H_0 = H(t_0)$.\n\nConsider a specific cosmological model known as the Milne universe. This model describes a universe that is completely empty, meaning its energy density due to matter and radiation is zero, i.e., $\\varepsilon(a)=0$. Furthermore, this universe is characterized by a negative spatial curvature, corresponding to an open geometry.\n\nAssuming the universe began from a singularity ($a \\to 0$ as $t \\to 0$), derive an expression for the current age of this Milne universe, $t_0$, in terms of the present-day Hubble constant, $H_0$.", "solution": "1. The first Friedmann equation with $\\varepsilon(a)=0$ is\n$$\\Bigl(\\frac{\\dot a}{a}\\Bigr)^2=-\\frac{k\\,c^2}{a^2}\\,. $$\n\n2. For the Milne universe $k=-1$, so\n$$\\Bigl(\\frac{\\dot a}{a}\\Bigr)^2=\\frac{c^2}{a^2}\n\\quad\\Longrightarrow\\quad\n\\frac{\\dot a}{a}=\\frac{c}{a}\\,. $$\n\n3. This gives the ordinary differential equation\n$$\\dot a=c\\,. $$\n\n4. Integrating from $t=0$ (where $a(0)=0$) to time $t$ yields\n$$a(t)=c\\,t\\,. $$\n\n5. The Hubble parameter is\n$$H(t)=\\frac{\\dot a}{a}=\\frac{c}{c\\,t}=\\frac1t\\,. $$\n\n6. Evaluated at the present time $t_0$, $H_0=H(t_0)=1/t_0$, hence\n$$t_0=\\frac1{H_0}\\,. $$", "answer": "$$\\boxed{\\frac{1}{H_0}}$$", "id": "853752"}, {"introduction": "Next, we introduce matter into our model and investigate the evolution of a closed universe, where the gravitational pull of its contents is sufficient to eventually halt and reverse the expansion. This practice requires using the classic parametric solution for a matter-dominated, closed cosmology, which beautifully describes the expansion and subsequent recollapse as a cycloid. By calculating the age of such a universe at its moment of maximum expansion, you will gain a deeper, quantitative understanding of how the total density parameter $\\Omega_{m,0}$ governs the ultimate fate of a cosmos destined for a \"Big Crunch\" [@problem_id:874998].", "problem": "Consider a homogeneous and isotropic universe described by the Friedmann-Lemaître-Robertson-Walker (FLRW) metric. The dynamics of its dimensionless scale factor, $a(t)$, are governed by the first Friedmann equation:\n$$ H(t)^2 \\equiv \\left(\\frac{\\dot{a}(t)}{a(t)}\\right)^2 = \\frac{8\\pi G}{3}\\rho(t) - \\frac{k c^2}{\\mathcal{R}_0^2 a(t)^2} $$\nHere, $H(t)$ is the Hubble parameter, $\\rho(t)$ is the total energy density, $G$ is the gravitational constant, $c$ is the speed of light, and $k \\in \\{-1, 0, +1\\}$ is the curvature parameter, which determines whether the spatial geometry is open, flat, or closed, respectively. $\\mathcal{R}_0$ is the radius of curvature at the present time $t_0$, and the scale factor is normalized such that $a(t_0) = 1$.\n\nThe critical density is defined as $\\rho_c(t) = 3H(t)^2 / (8\\pi G)$, and the density parameter for a given component 'i' is $\\Omega_i(t) = \\rho_i(t) / \\rho_c(t)$. The total density parameter is $\\Omega(t) = \\sum_i \\Omega_i(t)$. The value of the curvature parameter $k$ is related to the total density parameter at the present time, $\\Omega_0 \\equiv \\Omega(t_0)$, by the relation $k = \\mathrm{sgn}(\\Omega_0 - 1)$.\n\nAssume a universe containing only non-relativistic matter (dust), so $\\rho(t) = \\rho_m(t)$. The energy density of this matter component scales with the expansion as $\\rho_m(t) = \\rho_{m,0} a(t)^{-3}$, where $\\rho_{m,0}$ is the matter density at present time $t_0$. For such a universe to be closed ($k=+1$), the present-day total density parameter must be greater than one, i.e., $\\Omega_{m,0} > 1$. This type of universe starts from a Big Bang, expands to a maximum size, and then recollapses in a \"Big Crunch\".\n\nDetermine the age of this universe at the moment of maximum expansion, $t_{max}$. Express your answer as a closed-form analytic expression in terms of the present-day Hubble parameter, $H_0 \\equiv H(t_0)$, and the present-day matter density parameter, $\\Omega_{m,0}$.", "solution": "1. The Friedmann equation for a matter‐only closed universe ($k=+1$, $\\Omega_{m,0}>1$) reads\n$$\\left(\\frac{\\dot a}{a}\\right)^2 \\;=\\; H_0^2\\Bigl[\\Omega_{m,0}\\,a^{-3}+(1-\\Omega_{m,0})\\,a^{-2}\\Bigr]\\,. $$\nMultiply by $a^2$ to obtain\n$$\\dot a^2 \\;=\\; H_0^2\\Bigl[\\Omega_{m,0}\\,a^{-1}+(1-\\Omega_{m,0})\\Bigr]\\,. $$\n\n2. Since $1-\\Omega_{m,0}=-(\\Omega_{m,0}-1)<0$, set\n$$a(\\eta)=\\frac{\\Omega_{m,0}}{2(\\Omega_{m,0}-1)}\\bigl(1-\\cos\\eta\\bigr),$$\nwhich implies $a(0)=0$ and reaches its maximum $a_{\\max}=\\Omega_{m,0}/(\\Omega_{m,0}-1)$ at $\\eta=\\pi$. \n\n3. A consistent parametric time‐solution is\n$$t(\\eta)=\\frac{\\Omega_{m,0}}{2H_0\\,(\\Omega_{m,0}-1)^{3/2}}\\bigl(\\eta-\\sin\\eta\\bigr)\\,, $$\nwhich indeed satisfies $\\dot a\\,d\\eta=dt$ upon differentiation. \n\n4. At maximum expansion $\\eta=\\pi$, so\n$$t_{\\max}=t(\\pi)\n=\\frac{\\Omega_{m,0}}{2H_0\\,(\\Omega_{m,0}-1)^{3/2}}\\bigl(\\pi-0\\bigr)\n=\\frac{\\pi\\,\\Omega_{m,0}}{2\\,H_0\\,(\\Omega_{m,0}-1)^{3/2}}\\,. $$", "answer": "$$\\boxed{\\frac{\\pi\\,\\Omega_{m,0}}{2\\,H_0\\,(\\Omega_{m,0}-1)^{3/2}}}$$", "id": "874998"}, {"introduction": "Our final practice bridges the gap between theoretical models and astronomical observation by focusing on a key observable quantity: the luminosity distance, $d_L$. This computational exercise challenges you to synthesize the concepts of matter density, dark energy, and spatial curvature into a single, powerful tool for calculating distances to cosmological objects. By numerically integrating the full Friedmann equation for various universal geometries—flat, open, and closed—you will directly see how the universe's contents and shape affect the light we receive from distant galaxies [@problem_id:2397758].", "problem": "You are to compute the luminosity distance $d_L$ in a general non-flat Friedmann–Lemaître–Robertson–Walker (FLRW) universe by evaluating the line-of-sight comoving distance integral using Gaussian quadrature. You must write a complete, runnable program that performs the following.\n\nStart from the following foundational elements, which are well-tested in modern cosmology. The expansion rate as a function of redshift $z$ is given by the Hubble parameter $H(z)$ expressed in terms of the present-day Hubble constant $H_0$ and the present-day density parameters $\\Omega_r$, $\\Omega_m$, and $\\Omega_\\Lambda$. Define the curvature parameter by closure, $\\Omega_k = 1 - \\Omega_r - \\Omega_m - \\Omega_\\Lambda$. The dimensionless expansion rate is\n$$\nE(z) \\equiv \\frac{H(z)}{H_0} = \\sqrt{\\Omega_r (1+z)^4 + \\Omega_m (1+z)^3 + \\Omega_k (1+z)^2 + \\Omega_\\Lambda}.\n$$\nThe line-of-sight comoving distance is\n$$\nD_C(z) = \\frac{c}{H_0} \\int_{0}^{z} \\frac{dz'}{E(z')},\n$$\nwhere $c$ is the speed of light. The transverse comoving distance $D_M(z)$ depends on the spatial curvature through the function $S_k(\\chi)$, where $\\chi \\equiv \\int_{0}^{z} \\frac{dz'}{E(z')}$:\n$$\nD_M(z) = \\frac{c}{H_0}\n\\begin{cases}\n\\frac{1}{\\sqrt{\\Omega_k}} \\sinh\\!\\big(\\sqrt{\\Omega_k}\\,\\chi\\big), & \\Omega_k > 0,\\\\\n\\chi, & \\Omega_k = 0,\\\\\n\\frac{1}{\\sqrt{|\\Omega_k|}} \\sin\\!\\big(\\sqrt{|\\Omega_k|}\\,\\chi\\big), & \\Omega_k < 0.\n\\end{cases}\n$$\nThe luminosity distance is related to the transverse comoving distance by\n$$\nd_L(z) = (1+z)\\,D_M(z).\n$$\n\nYour program must:\n- Use Gaussian quadrature (specifically Gauss–Legendre quadrature) to evaluate the integral $\\int_{0}^{z} \\frac{dz'}{E(z')}$ on the finite interval $[0,z]$. Do not use any black-box numerical integration routines; instead, construct the quadrature using nodes and weights for Gauss–Legendre quadrature and apply the appropriate mapping to the interval $[0,z]$.\n- Use the speed of light $c = 299792.458\\,\\mathrm{km\\,s^{-1}}$ and accept $H_0$ in units of $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, so that distances are produced in megaparsecs (Mpc) without further unit conversion.\n- Compute $\\Omega_k$ from $\\Omega_r$, $\\Omega_m$, and $\\Omega_\\Lambda$ using $\\Omega_k = 1 - \\Omega_r - \\Omega_m - \\Omega_\\Lambda$ for each test case.\n- Handle all three curvature cases $\\Omega_k > 0$, $\\Omega_k = 0$, and $\\Omega_k  0$ in a numerically stable manner.\n\nAngle units do not appear in this problem. All physical distance outputs must be expressed in megaparsecs (Mpc), rounded to six decimal places.\n\nTest suite. Your program must compute $d_L$ for the following $5$ test cases, each specified by $(H_0, \\Omega_m, \\Omega_r, \\Omega_\\Lambda, z)$:\n- Case $1$: $(70.0,\\;0.3,\\;0.0,\\;0.7,\\;1.0)$.\n- Case $2$: $(70.0,\\;0.3,\\;0.0,\\;0.6,\\;2.0)$.\n- Case $3$: $(70.0,\\;0.4,\\;0.0,\\;0.7,\\;1.0)$.\n- Case $4$: $(67.74,\\;0.3089,\\;0.0,\\;0.6911,\\;0.0)$.\n- Case $5$: $(73.0,\\;0.27,\\;9.0\\times 10^{-5},\\;0.73,\\;3.0)$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test cases above, with each entry equal to the luminosity distance $d_L$ in $\\mathrm{Mpc}$ rounded to six decimal places, for example:\n$[d_{L,1},d_{L,2},d_{L,3},d_{L,4},d_{L,5}]$.", "solution": "The problem requires the computation of the luminosity distance, $d_L$, in a Friedmann–Lemaître–Robertson–Walker (FLRW) universe for several sets of cosmological parameters. The solution must be derived by numerically evaluating the comoving distance integral using Gauss-Legendre quadrature.\n\nThe fundamental relationship between luminosity distance and comoving distance is rooted in the geometry of an expanding, homogeneous, and isotropic universe as described by the FLRW metric. The luminosity distance $d_L$ accounts for both the expansion of space and the time dilation of light signals from distant sources.\n\nThe calculation proceeds through the following logical steps.\n\nFirst, we define the dimensionless Hubble parameter, $E(z)$, which describes the expansion rate of the universe as a function of redshift $z$:\n$$\nE(z) = \\sqrt{\\Omega_r (1+z)^4 + \\Omega_m (1+z)^3 + \\Omega_k (1+z)^2 + \\Omega_\\Lambda}\n$$\nHere, $\\Omega_m$, $\\Omega_r$, and $\\Omega_\\Lambda$ are the present-day density parameters for matter, radiation, and dark energy, respectively. The curvature density parameter, $\\Omega_k$, is determined by the closure relation:\n$$\n\\Omega_k = 1 - \\Omega_m - \\Omega_r - \\Omega_\\Lambda\n$$\nA value of $\\Omega_k=0$ corresponds to a spatially flat universe, $\\Omega_k > 0$ to an open (hyperbolic) universe, and $\\Omega_k  0$ to a closed (spherical) universe.\n\nSecond, we compute the line-of-sight comoving distance, $D_C(z)$, by integrating the inverse of the Hubble parameter. This distance represents the proper distance between two objects at a fixed moment of cosmic time. It is given by:\n$$\nD_C(z) = D_H \\int_{0}^{z} \\frac{dz'}{E(z')}\n$$\nwhere $D_H = c/H_0$ is the Hubble distance, with $c$ being the speed of light and $H_0$ the Hubble constant today. We define the dimensionless comoving distance integral as:\n$$\n\\chi(z) = \\int_{0}^{z} \\frac{dz'}{E(z')}\n$$\n\nTo evaluate this integral numerically, we employ Gauss-Legendre quadrature, a highly efficient method for approximating definite integrals of well-behaved functions. The standard $N$-point Gauss-Legendre quadrature approximates an integral over the interval $[-1, 1]$:\n$$\n\\int_{-1}^{1} f(x) dx \\approx \\sum_{i=1}^{N} w_i f(x_i)\n$$\nwhere $x_i$ are the nodes (roots of the $N$-th Legendre polynomial) and $w_i$ are the corresponding weights. To apply this to our integral over $[0, z]$, we must perform a change of variables. Let $z' = \\frac{z}{2}(1+x)$. As $x$ goes from $-1$ to $1$, $z'$ goes from $0$ to $z$. The differential is $dz' = \\frac{z}{2}dx$. The integral for $\\chi(z)$ becomes:\n$$\n\\chi(z) = \\int_{-1}^{1} \\frac{1}{E\\left(\\frac{z}{2}(1+x)\\right)} \\frac{z}{2} dx\n$$\nApplying the quadrature rule, the numerical approximation for $\\chi(z)$ is:\n$$\n\\chi(z) \\approx \\frac{z}{2} \\sum_{i=1}^{N} \\frac{w_i}{E\\left(\\frac{z}{2}(1+x_i)\\right)}\n$$\nFor a redshift $z=0$, the integral is trivially $0$, thus $\\chi(0)=0$. For all non-zero redshifts, we use this summation. A sufficiently large number of points, for instance $N=100$, ensures high precision for the smooth integrands encountered in cosmology.\n\nThird, we calculate the transverse comoving distance, $D_M(z)$. This distance corrects the line-of-sight comoving distance for the effects of spatial curvature. It is defined as:\n$$\nD_M(z) = D_H \\cdot S_k(\\chi)\n$$\nwhere $S_k(\\chi)$ is a function that depends on the sign of $\\Omega_k$:\n$$\nS_k(\\chi) =\n\\begin{cases}\n\\frac{1}{\\sqrt{\\Omega_k}} \\sinh(\\sqrt{\\Omega_k}\\,\\chi)  \\text{if } \\Omega_k  0 \\quad \\text{(open)} \\\\\n\\chi  \\text{if } \\Omega_k = 0 \\quad \\text{(flat)} \\\\\n\\frac{1}{\\sqrt{|\\Omega_k|}} \\sin(\\sqrt{|\\Omega_k|}\\,\\chi)  \\text{if } \\Omega_k  0 \\quad \\text{(closed)}\n\\end{cases}\n$$\nFor numerical stability when $\\Omega_k$ is very close to zero, it is crucial to handle these expressions carefully. The limits of the open and closed forms both converge to $\\chi$ as $\\Omega_k \\to 0$. For implementation, we establish a small threshold, such as $10^{-8}$, and if $|\\Omega_k|$ is below this threshold, we use the flat-space expression $D_M(z) = D_H \\chi$.\n\nFinally, the luminosity distance $d_L(z)$ is obtained by multiplying the transverse comoving distance by a factor of $(1+z)$. This factor accounts for the cosmological redshift of photon energy and the time dilation between the emission and reception of photons.\n$$\nd_L(z) = (1+z) D_M(z)\n$$\nFor the trivial case where $z=0$, the luminosity distance is $d_L(0) = 0$ Mpc, as any object at zero redshift is at zero distance.\n\nThe provided program implements this entire procedure. It defines a function that takes the cosmological parameters for each test case, calculates $\\Omega_k$, performs the Gauss-Legendre quadrature for $\\chi(z)$, computes $D_M(z)$ with stable handling of curvature, and finally returns $d_L(z)$. The program iterates through the specified test suite, collects the results, and prints them in the required format. The speed of light is taken as $c = 299792.458\\,\\mathrm{km\\,s^{-1}}$, and with $H_0$ in $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, all distance results are naturally in units of megaparsecs (Mpc).", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Computes the luminosity distance for a set of cosmological models\n    using Gauss-Legendre quadrature for the comoving distance integral.\n    \"\"\"\n\n    # Physical constant\n    C_LIGHT_KM_S = 299792.458  # Speed of light in km/s\n\n    # Gaussian quadrature parameters\n    N_QUADRATURE = 100  # Number of points for Gauss-Legendre quadrature\n    nodes, weights = roots_legendre(N_QUADRATURE)\n\n    # Test cases: (H0, Omega_m, Omega_r, Omega_Lambda, z)\n    test_cases = [\n        (70.0, 0.3, 0.0, 0.7, 1.0),\n        (70.0, 0.3, 0.0, 0.6, 2.0),\n        (70.0, 0.4, 0.0, 0.7, 1.0),\n        (67.74, 0.3089, 0.0, 0.6911, 0.0),\n        (73.0, 0.27, 9.0e-5, 0.73, 3.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        h0, omega_m, omega_r, omega_l, z = case\n\n        # Trivial case: at z=0, the distance is 0.\n        if z == 0.0:\n            results.append(0.0)\n            continue\n\n        # Calculate curvature density parameter by closure\n        omega_k = 1.0 - omega_m - omega_r - omega_l\n\n        def e_z(z_prime):\n            \"\"\"\n            Dimensionless Hubble parameter E(z').\n            \"\"\"\n            term_r = omega_r * (1 + z_prime)**4\n            term_m = omega_m * (1 + z_prime)**3\n            term_k = omega_k * (1 + z_prime)**2\n            term_l = omega_l\n            return np.sqrt(term_r + term_m + term_k + term_l)\n\n        # Gauss-Legendre quadrature for the comoving distance integral chi(z)\n        # We map the integration interval [0, z] to [-1, 1] for quadrature.\n        # Let z' = z/2 * (1 + x), so dz' = z/2 * dx.\n        # Integral becomes (z/2) * integral from -1 to 1 of 1/E(z'(x)) dx\n        \n        # Evaluate function at mapped nodes\n        z_prime_values = 0.5 * z * (1 + nodes)\n        integrand_values = 1.0 / e_z(z_prime_values)\n        \n        # Calculate the dimensionless comoving distance integral chi\n        chi = 0.5 * z * np.sum(weights * integrand_values)\n        \n        # Hubble distance in Mpc\n        hubble_distance = C_LIGHT_KM_S / h0\n\n        # Calculate transverse comoving distance D_M, handling curvature cases stably\n        # A small threshold for Omega_k to use the flat case approximation\n        k_threshold = 1e-8\n        \n        if abs(omega_k)  k_threshold:\n            # Flat universe (Omega_k is zero or numerically close to it)\n            dm = hubble_distance * chi\n        elif omega_k  0:\n            # Open universe\n            sqrt_k = np.sqrt(omega_k)\n            dm = hubble_distance * (1.0 / sqrt_k) * np.sinh(sqrt_k * chi)\n        else: # omega_k  0\n            # Closed universe\n            sqrt_abs_k = np.sqrt(abs(omega_k))\n            dm = hubble_distance * (1.0 / sqrt_abs_k) * np.sin(sqrt_abs_k * chi)\n\n        # Luminosity distance d_L\n        d_l = (1 + z) * dm\n        results.append(d_l)\n\n    # Format the final output string as per requirements\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2397758"}]}