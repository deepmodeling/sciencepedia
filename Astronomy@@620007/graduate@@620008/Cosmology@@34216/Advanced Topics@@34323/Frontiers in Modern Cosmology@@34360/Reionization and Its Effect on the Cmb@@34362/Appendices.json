{"hands_on_practices": [{"introduction": "The epoch of reionization was driven by the ionizing radiation from the first generations of galaxies. To model this process, we can connect the theory of cosmological structure formation to the production of these photons. This exercise [@problem_id:845651] demonstrates how to construct a simple but physically motivated model for the reionization history, using the Press-Schechter formalism to describe the collapse of dark matter halos and linking it to photon production via a constant ionizing efficiency, $\\zeta$.", "problem": "This problem explores a simplified, yet physically motivated, model of cosmic reionization. We consider a universe described by a matter-dominated Einstein-de Sitter (EdS) cosmology, where the Hubble parameter is $H(z) = H_0 (1+z)^{3/2}$.\n\nReionization is driven by ionizing photons emitted from galaxies residing in dark matter halos. The abundance of these halos is described by the Press-Schechter formalism. The fraction of matter collapsed into halos with mass greater than a minimum mass $M_{min}$ at a given redshift $z$ is given by:\n$$\nf_{coll}(z) = \\text{erfc}\\left( K(1+z) \\right)\n$$\nwhere $\\text{erfc}(x)$ is the complementary error function, and $K$ is a constant that depends on the properties of the linear density field: $K = \\frac{\\delta_{c,0}}{\\sqrt{2}\\sigma(M_{min})}$. Here, $\\delta_{c,0}$ is the critical linear overdensity for spherical collapse extrapolated to $z=0$, and $\\sigma(M_{min})$ is the root-mean-square of the linear density field at $z=0$, smoothed on a mass scale $M_{min}$.\n\nThe production rate of ionizing photons per comoving volume, $\\dot{n}_{ion}$, is assumed to be directly proportional to the rate at which baryons are accreted into these halos. This relationship is modeled as:\n$$\n\\dot{n}_{ion}(t) = \\zeta \\bar{n}_{b,0} \\frac{df_{coll}}{dt}\n$$\nwhere $\\zeta$ is the constant dimensionless ionizing efficiency (representing the number of ionizing photons produced per baryon that collapses into a halo), and $\\bar{n}_{b,0}$ is the mean comoving number density of baryons.\n\nCalculate the total number of ionizing photons produced per comoving volume, integrated over conformal time, which is defined as $\\mathcal{N}_\\eta = \\int \\dot{n}_{ion} d\\eta$. Recalling that the element of conformal time is $d\\eta = \\frac{dt}{a(t)} = \\frac{dz}{H(z)}$, this quantity can be expressed as:\n$$\n\\mathcal{N}_\\eta = \\int_0^\\infty \\frac{\\dot{n}_{ion}(z)}{H(z)} dz\n$$\nExpress your final answer in terms of $\\zeta$, $\\bar{n}_{b,0}$, and the constant $K$.", "solution": "We begin with the definition\n$$\n\\mathcal{N}_\\eta \\;=\\;\\int_0^\\infty \\frac{\\dot n_{\\text{ion}}(z)}{H(z)}\\,dz,\n$$\nand the model\n$$\n\\dot n_{\\text{ion}}(t)=\\zeta\\,\\bar n_{b,0}\\,\\frac{df_{\\text{coll}}}{dt}, \n\\qquad\nf_{\\text{coll}}(z)=\\text{erfc}\\bigl(K(1+z)\\bigr).\n$$\n1. Compute the derivative with respect to $z$:\n$$\n\\frac{df_{\\text{coll}}}{dz}\n=\\frac{d}{dz}\\text{erfc}\\bigl(K(1+z)\\bigr)\n=-\\frac{2K}{\\sqrt\\pi}\\,e^{-K^2(1+z)^2}.\n$$\n2. Use the chain rule $df_{\\text{coll}}/dt=(df_{\\text{coll}}/dz)(dz/dt)$ and \n$dz/dt=-(1+z)H(z)$ to get\n$$\n\\frac{df_{\\text{coll}}}{dt}\n=\\frac{2K}{\\sqrt\\pi}\\,(1+z)\\,H(z)\\,e^{-K^2(1+z)^2}.\n$$\nThus\n$$\n\\dot n_{\\text{ion}}\n=\\zeta\\,\\bar n_{b,0}\\,\\frac{2K}{\\sqrt\\pi}(1+z)H(z)e^{-K^2(1+z)^2},\n$$\nand\n$$\n\\frac{\\dot n_{\\text{ion}}}{H(z)}\n=\\zeta\\,\\bar n_{b,0}\\,\\frac{2K}{\\sqrt\\pi}(1+z)e^{-K^2(1+z)^2}.\n$$\n3. Substitute into the integral:\n$$\n\\mathcal{N}_\\eta\n=\\zeta\\,\\bar n_{b,0}\\,\\frac{2K}{\\sqrt\\pi}\n\\int_0^\\infty(1+z)e^{-K^2(1+z)^2}dz.\n$$\n4. Change variable to $u=K(1+z)$, so $dz=du/K$, $z=0\\to u=K$, $z\\to\\infty\\to u\\to\\infty$:\n$$\n\\int_0^\\infty(1+z)e^{-K^2(1+z)^2}dz\n=\\int_K^\\infty\\frac{u}{K}e^{-u^2}\\frac{du}{K}\n=\\frac{1}{K^2}\\int_K^\\infty u\\,e^{-u^2}du.\n$$\n5. Evaluate the Gaussian integral:\n$$\n\\int_K^\\infty u\\,e^{-u^2}du\n=\\frac12\\int_{K^2}^{\\infty}e^{-t}dt\n=\\frac12e^{-K^2}.\n$$\nHence\n$$\n\\mathcal{N}_\\eta\n=\\zeta\\,\\bar n_{b,0}\\,\\frac{2K}{\\sqrt\\pi}\n\\cdot\\frac{1}{K^2}\\,\\frac12e^{-K^2}\n=\\frac{\\zeta\\,\\bar n_{b,0}}{K\\sqrt\\pi}\\,e^{-K^2}.\n$$", "answer": "$$\\boxed{\\frac{\\zeta \\bar{n}_{b,0}}{K \\sqrt{\\pi}}\\,e^{-K^2}}$$", "id": "845651"}, {"introduction": "The re-emergence of a large population of free electrons during reionization inevitably alters our view of the Cosmic Microwave Background (CMB). This practice [@problem_id:852281] explores a key signature of this era: the generation of secondary temperature anisotropies through the kinetic Sunyaev-Zel'dovich (kSZ) effect. By calculating the relative heights of acoustic oscillations in a simplified kSZ power spectrum model, you will gain insight into how this effect imprints information about the universe's expansion and matter content onto small angular scales of the CMB.", "problem": "The primordial temperature fluctuations of the Cosmic Microwave Background (CMB), imprinted at the last-scattering surface, are not observed directly. Their signal is modified during its propagation to us. One such modification arises from Thomson scattering of CMB photons off free electrons during the epoch of cosmic reionization. This process damps the primordial anisotropies and introduces new, secondary anisotropies, most notably through the kinetic Sunyaev-Zel'dovich (kSZ) effect.\n\nThe kSZ effect arises from the Doppler shift of CMB photons scattering off electrons with a non-zero peculiar velocity. In the standard cosmological model, the baryon peculiar velocity field on large scales is sourced by the same primordial density fluctuations that give rise to the large-scale structure of the universe. Consequently, the baryon velocity power spectrum, and thus the kSZ angular power spectrum, contains imprints of Baryon Acoustic Oscillations (BAO). These appear as a series of decaying wiggles in the kSZ power spectrum at small angular scales (high multipoles $l$).\n\nA useful quantity to study these anisotropies is $\\mathcal{D}_l = l(l+1)C_l/(2\\pi)$, where $C_l$ is the angular power spectrum. For large $l$, $\\mathcal{D}_l \\approx l^2 C_l/(2\\pi)$. The oscillatory BAO signature in the kSZ power spectrum, $\\mathcal{D}_{l, \\text{osc}}^{\\text{kSZ}}$, can be modeled with the simplified form:\n$$\n\\mathcal{D}_{l, \\text{osc}}^{\\text{kSZ}} = \\mathcal{A} \\cdot l^{-\\nu} \\sin\\left(\\frac{l}{l_s}\\right)\n$$\nwhere $\\mathcal{A}$ is an overall amplitude, $\\nu$ is an effective spectral index that models the scale-dependence of the underlying non-oscillatory power spectrum, and $l_s$ is a characteristic angular scale. This scale is given by $l_s = \\chi_{re}/r_d$, where $\\chi_{re}$ is the comoving distance to the reionization epoch and $r_d$ is the comoving sound horizon at the baryon drag epoch.\n\nThe peaks of these acoustic oscillations in multipole space are found where the function $\\mathcal{D}_{l, \\text{osc}}^{\\text{kSZ}}$ reaches its local maxima. To simplify the analysis, assume that the locations of the maxima, $l_n$, are well-approximated by the maxima of the sine function, i.e.,\n$$\n\\frac{l_n}{l_s} = \\left(2n + \\frac{1}{2}\\right)\\pi\n$$\nfor integers $n=0, 1, 2, \\dots$.\n\nYour task is to calculate the ratio $R = H_1/H_0$ of the peak height of the second acoustic oscillation ($n=1$) to that of the first acoustic oscillation ($n=0$). Express your answer in terms of the effective spectral index $\\nu$. The height $H_n$ of the $n$-th peak is the value of $|\\mathcal{D}_{l_n, \\text{osc}}^{\\text{kSZ}}|$.", "solution": "The oscillatory kSZ power spectrum is given by\n$$\n\\mathcal{D}_{l,\\text{osc}}^\\text{kSZ}\n=\\mathcal{A}\\,l^{-\\nu}\\sin\\!\\Bigl(\\frac{l}{l_s}\\Bigr)\\,.\n$$\nPeaks occur where the sine attains its extrema, i.e.\n$$\n\\frac{l_n}{l_s}=\\Bigl(2n+\\tfrac12\\Bigr)\\pi\n\\quad\\Longrightarrow\\quad\nl_n=(2n+\\tfrac12)\\pi\\,l_s\\,.\n$$\nThe height of the $n$-th peak is\n$$\nH_n=\\bigl|\\mathcal{D}_{l_n,\\text{osc}}^\\text{kSZ}\\bigr|\n=\\mathcal{A}\\,l_n^{-\\nu}\\,,\n$$\nsince $|\\sin(\\cdot)|=1$ at the extrema.  Thus the ratio of the second peak ($n=1$) to the first peak ($n=0$) is\n$$\nR=\\frac{H_1}{H_0}\n=\\frac{l_1^{-\\nu}}{l_0^{-\\nu}}\n=\\Bigl(\\frac{l_1}{l_0}\\Bigr)^{-\\nu}\n=\\biggl(\\frac{(5/2)\\pi\\,l_s}{(1/2)\\pi\\,l_s}\\biggr)^{-\\nu}\n=5^{-\\nu}\\,.\n$$", "answer": "$$\\boxed{5^{-\\nu}}$$", "id": "852281"}, {"introduction": "While the power spectrum provides a measure of the overall amplitude of kSZ fluctuations, it does not capture the full picture of the reionization process, which was spatially inhomogeneous. Because reionization proceeded in patches, with bubbles of ionized hydrogen growing and merging, the resulting kSZ signal is inherently non-Gaussian. This advanced problem [@problem_id:845705] introduces the bispectrum, a 3-point correlation function, as a powerful tool to quantify this non-Gaussianity and extract crucial information about the morphology of reionization.", "problem": "The kinetic Sunyaev-Zel'dovich (kSZ) effect provides a powerful probe of the epoch of reionization. The temperature anisotropies, $\\Theta(\\hat{n}) \\equiv \\Delta T(\\hat{n}) / T_\\text{CMB}$, are sourced by the peculiar velocities of free electrons. During patchy reionization, these anisotropies are primarily generated by the spatial variations in the ionized fraction, $x_e$.\n\nIn the flat-sky approximation, the kSZ temperature field in 2D Fourier space, $\\Theta(\\vec{\\ell})$, can be related to the 3D field $q(\\vec{x}) = \\delta_{x_e}(\\vec{x}) (v_z(\\vec{x})/c)$, which represents the product of the ionization fraction fluctuation $\\delta_{x_e}$ and the line-of-sight component of the peculiar velocity field $v_z$. The kSZ bispectrum, $B_\\Theta(\\ell_1, \\ell_2, \\ell_3)$, which measures the 3-point correlation of the temperature field, is sourced by the 3D bispectrum of the field $q$, denoted $B_q(\\vec{k}_1, \\vec{k}_2, \\vec{k}_3)$.\n\nTo model the non-linearities of the reionization process, we consider a model where the ionization fluctuation, $\\delta_{x_e}(\\vec{k})$, and the peculiar velocity, $v_z(\\vec{k})$, are treated as jointly Gaussian random fields. This is a simple model that captures the essential fact that the two fields are correlated (as both are sourced by the underlying matter density) and that their product is a non-Gaussian field.\n\nUnder this assumption, the bispectrum of their product field $q(\\vec{k}) = (\\delta_{x_e} \\star v_z/c)(\\vec{k})$ is non-zero. The full bispectrum $B_q(\\vec{k}_1, \\vec{k}_2, \\vec{k}_3)$ is a sum of eight terms involving loop integrals over products of the power spectra of the constituent fields: the ionization power spectrum $P_{x_e}(k)$, the velocity power spectrum $P_{v_z}(k)$, and their cross-power spectrum $P_{x_e, v_z}(k)$. These terms can be grouped by permutations of the external momenta $\\vec{k}_1, \\vec{k}_2, \\vec{k}_3$. The bispectrum expression is:\n$$\nB_q(\\vec{k}_1, \\vec{k}_2, \\vec{k}_3) = \\frac{1}{c^3} \\left[ \\Big( I_{x_e, v_z, v_z}(\\vec{k_1}, \\vec{k_2}, \\vec{k_3}) + \\text{cyc. perms.} \\Big) + 2 \\Big( I_{x_e v_z, x_e v_z, v_z}(\\vec{k_1}, \\vec{k_2}, \\vec{k_3}) + \\text{cyc. perms.} \\Big) \\right]\n$$\nwhere a \"cyclic permutation\" means summing over $(\\vec{k_1}, \\vec{k_2}, \\vec{k_3})$, $(\\vec{k_2}, \\vec{k_3}, \\vec{k_1})$, and $(\\vec{k_3}, \\vec{k_1}, \\vec{k_2})$. The integral terms are defined as:\n$$\nI_{A,B,C}(\\vec{k_1}, \\vec{k_2}, \\vec{k_3}) = \\int \\frac{d^3\\vec{p}}{(2\\pi)^3} P_A(p) P_B(|\\vec{k}_1-\\vec{p}|) P_C(|\\vec{k}_2+\\vec{p}|).\n$$\nYour task is to calculate the total 3D bispectrum $B_q(k,k,k)$ for the equilateral configuration, where $|\\vec{k}_1|=|\\vec{k}_2|=|\\vec{k}_3|=k$ and $\\vec{k}_1+\\vec{k}_2+\\vec{k}_3=0$.\n\nFor this calculation, assume the following simple power-law forms for the power spectra at a characteristic redshift of reionization:\n- $P_{x_e}(k) = \\frac{A_x}{k^3}$\n- $P_{v_z}(k) = \\frac{A_v}{k^3}$\n- $P_{x_e, v_z}(k) = \\frac{A_{xv}}{k^3}$\n\nwhere $A_x, A_v, A_{xv}$ are constant amplitudes. For this specific choice of power laws, the required loop integral for an equilateral triangle of side $k$ evaluates to a simple form. You are given the following exact result for this integral:\n$$\nJ(k) \\equiv \\int \\frac{d^3\\vec{p}}{(2\\pi)^3} \\frac{1}{|\\vec{p}|^3 |\\vec{k}_1-\\vec{p}|^3 |\\vec{k}_2+\\vec{p}|^3} = \\frac{\\mathcal{C}}{k^6}\n$$\nwhere $\\mathcal{C}$ is a dimensionless constant. Use this result to find the total equilateral bispectrum $B_q(k,k,k)$.", "solution": "1. We start from the definition  \n$$\nB_q(\\vec{k}_1,\\vec{k}_2,\\vec{k}_3)\n=\\frac{1}{c^3}\\Bigl[\\bigl(I_{x_e,v_z,v_z}+\\text{cyc.}\\bigr)\n+2\\bigl(I_{x_e v_z,x_e v_z,v_z}+\\text{cyc.}\\bigr)\\Bigr].\n$$  \n2. For equilateral configuration $|\\vec k_i|=k$ and $\\vec k_1+\\vec k_2+\\vec k_3=0$, each loop integral  \n$$\nI_{A,B,C}(k,k,k)\n=\\int\\frac{d^3p}{(2\\pi)^3}P_A(p)P_B(|\\vec k_1-p|)P_C(|\\vec k_2+p|)\n$$  \nwith power laws $P_X(q)=A_X/q^3$ yields  \n$$\nI_{A,B,C}(k,k,k)=A_A\\,A_B\\,A_C\\;J(k)\n=A_A\\,A_B\\,A_C\\;\\frac{\\mathcal{C}}{k^6}.\n$$  \n3. Evaluate the two distinct integrals and count cyclic permutations (three each):  \n   a. $I_{x_e,v_z,v_z}=A_x\\,A_v\\,A_v\\,\\frac{\\mathcal{C}}{k^6}=A_xA_v^2\\frac{\\mathcal{C}}{k^6}$, so  \n   $$\\sum_{\\rm cyc}I_{x_e,v_z,v_z}=3A_xA_v^2\\frac{\\mathcal{C}}{k^6}.$$  \n   b. $I_{x_e v_z,x_e v_z,v_z}=A_{xv}^2A_v\\,\\frac{\\mathcal{C}}{k^6}$, so  \n   $$\\sum_{\\rm cyc}I_{x_e v_z,x_e v_z,v_z}=3A_{xv}^2A_v\\frac{\\mathcal{C}}{k^6}.$$  \n4. Assemble $B_q$:\n$$\nB_q(k,k,k)\n=\\frac{1}{c^3}\\Bigl[3A_xA_v^2\\frac{\\mathcal{C}}{k^6}\n+2\\cdot3A_{xv}^2A_v\\frac{\\mathcal{C}}{k^6}\\Bigr]\n=\\frac{\\mathcal{C}}{c^3k^6}\\bigl(3A_xA_v^2+6A_{xv}^2A_v\\bigr).\n$$", "answer": "$$\\boxed{\\frac{\\mathcal{C}\\,\\bigl(3A_xA_v^2+6A_{xv}^2A_v\\bigr)}{c^3k^6}}$$", "id": "845705"}]}