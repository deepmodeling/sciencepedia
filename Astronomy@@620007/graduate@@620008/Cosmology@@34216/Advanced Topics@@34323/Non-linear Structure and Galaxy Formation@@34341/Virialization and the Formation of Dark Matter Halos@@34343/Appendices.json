{"hands_on_practices": [{"introduction": "The standard spherical collapse model is a cornerstone of structure formation, but it relies on simplifying assumptions. One such assumption is that the velocity dispersion of particles in a virialized halo is isotropic. This exercise [@problem_id:849416] challenges you to refine this model by incorporating velocity anisotropy, a feature commonly observed in simulated halos where radial orbits can be more dominant. By using the scalar virial theorem, you will explore whether the internal kinematics, quantified by the anisotropy parameter $\\beta$, influence the final equilibrium state and the resulting virial overdensity $\\Delta_{\\text{vir}}$.", "problem": "In the standard spherical collapse model for halo formation in an Einstein-de Sitter (EdS) universe, a spherical top-hat overdensity detaches from the Hubble flow, reaches a maximum radius (turn-around), and collapses. It is assumed that the halo virializes at a time twice the turn-around time. The standard simple model assumes the kinetic and potential energies ($K$ and $W$) of the virialized halo satisfy the scalar virial theorem $2K+W=0$.\n\nThis problem considers a modification to account for velocity anisotropy in the virialized halo. The velocity dispersion of dark matter particles in the halo is not isotropic. The anisotropy is quantified by the parameter $\\beta(r) = 1 - \\sigma_t^2(r) / \\sigma_r^2(r)$, where $\\sigma_r$ is the radial velocity dispersion and $\\sigma_t$ is the one-dimensional tangential velocity dispersion ($\\sigma_\\theta = \\sigma_\\phi = \\sigma_t$). We will assume $\\beta$ is constant throughout the halo.\n\nThe total kinetic energy is the sum of the radial and tangential components, $K=K_r+K_t$, where $K_r = \\int_0^{R_{\\text{vir}}} \\frac{1}{2} (4\\pi r^2 \\rho) \\sigma_r^2 dr$ and $K_t = \\int_0^{R_{\\text{vir}}} \\frac{1}{2} (4\\pi r^2 \\rho) (\\sigma_\\theta^2+\\sigma_\\phi^2) dr$.\n\nYour task is to calculate the virial overdensity $\\Delta_{\\text{vir}} = \\rho_{\\text{vir}}/\\rho_b(t_{\\text{vir}})$ as a function of the constant velocity anisotropy parameter $\\beta$. $\\rho_{\\text{vir}}$ is the average density of the halo at the virial radius $R_{\\text{vir}}$, and $\\rho_b(t_{\\text{vir}})$ is the background density of the EdS universe at the time of virialization, $t_{\\text{vir}}$.\n\nYou should use the following information and assumptions:\n1.  The background universe is a flat, matter-only (Einstein-de Sitter) universe, where the background density is $\\rho_b(t) = (6\\pi G t^2)^{-1}$.\n2.  The collapse is purely radial up to the point of virialization. This means the total energy of the collapsing region is fixed at the turn-around time $t_{\\text{ta}}$, when its kinetic energy is zero.\n3.  The virialization time is $t_{\\text{vir}} = 2 t_{\\text{ta}}$. The turn-around time for a spherical overdensity of mass $M$ and turn-around radius $R_{\\text{ta}}$ is $t_{\\text{ta}} = \\pi \\sqrt{R_{\\text{ta}}^3 / (8GM)}$.\n4.  The virialized halo is in equilibrium, satisfying the scalar virial theorem $2K+W=0$, where $K$ is the total kinetic energy and $W$ is the total potential energy. For a system with constant anisotropy $\\beta$, the total tangential kinetic energy is related to the total radial kinetic energy by $K_t = 2(1-\\beta)K_r$.\n5.  Assume the halo has a uniform density profile at both turn-around and at virialization. The gravitational potential energy of a uniform sphere of mass $M$ and radius $R$ is $W = -\\frac{3}{5}\\frac{GM^2}{R}$.\n6.  The mass $M$ of the overdense region is conserved throughout the collapse and virialization.\n\nCalculate the virial overdensity $\\Delta_{\\text{vir}}$ as a function of $\\beta$.", "solution": "1. State the virial and energy relations.\n   - The scalar virial theorem states that for the virialized halo, $2K+W=0$.\n   - The total energy $E = K+W$ is conserved during the collapse.\n   - At virialization, using the virial theorem, the total energy is $E_{\\text{vir}} = K_{\\text{vir}} + W_{\\text{vir}} = (-W_{\\text{vir}}/2) + W_{\\text{vir}} = W_{\\text{vir}}/2$.\n\n2. Relate virial state to turn-around state via energy conservation.\n   - At the turn-around time $t_{\\text{ta}}$, the kinetic energy of the shell is zero, so the total energy is purely potential: $E_{\\text{ta}} = W_{\\text{ta}}$.\n   - By conservation of energy, $E_{\\text{vir}} = E_{\\text{ta}}$, which implies $W_{\\text{vir}}/2 = W_{\\text{ta}}$.\n   - Note that this step does not depend on the kinetic energy structure (i.e., on $\\beta$), only on the existence of a virial equilibrium described by $2K+W=0$.\n\n3. Find the relationship between virial radius and turn-around radius.\n   - The potential energy of a uniform sphere of mass $M$ and radius $R$ is $W = -\\frac{3}{5}\\frac{GM^2}{R}$.\n   - Substituting this into the energy relation:\n     $$ \\frac{1}{2} \\left(-\\frac{3}{5}\\frac{GM^2}{R_{\\text{vir}}}\\right) = -\\frac{3}{5}\\frac{GM^2}{R_{\\text{ta}}} $$\n   - This simplifies to:\n     $$ \\frac{1}{2 R_{\\text{vir}}} = \\frac{1}{R_{\\text{ta}}} \\quad\\Longrightarrow\\quad R_{\\text{vir}} = \\frac{1}{2} R_{\\text{ta}} $$\n   - The virial radius is half the turn-around radius, regardless of the velocity anisotropy $\\beta$.\n\n4. Compute the virial overdensity $\\Delta_{\\text{vir}}=\\rho_{\\text{vir}}/\\rho_b(t_{\\text{vir}})$.\n   - The average density of the halo at virialization is:\n     $$ \\rho_{\\text{vir}} = \\frac{M}{\\frac{4\\pi}{3}R_{\\text{vir}}^3} = \\frac{M}{\\frac{4\\pi}{3}(\\frac{1}{2}R_{\\text{ta}})^3} = \\frac{6M}{\\pi R_{\\text{ta}}^3} $$\n   - The background density of the EdS universe at the virialization time $t_{\\text{vir}} = 2t_{\\text{ta}}$ is:\n     $$ \\rho_b(t_{\\text{vir}}) = \\frac{1}{6\\pi G (2t_{\\text{ta}})^2} = \\frac{1}{24\\pi G t_{\\text{ta}}^2} $$\n   - Using the given expression for the turn-around time, $t_{\\text{ta}}^2 = \\pi^2 R_{\\text{ta}}^3 / (8GM)$:\n     $$ \\rho_b(t_{\\text{vir}}) = \\frac{1}{24\\pi G} \\frac{8GM}{\\pi^2 R_{\\text{ta}}^3} = \\frac{M}{3\\pi^3 R_{\\text{ta}}^3} $$\n   - The virial overdensity is the ratio of these two densities:\n     $$ \\Delta_{\\text{vir}} = \\frac{\\rho_{\\text{vir}}}{\\rho_b(t_{\\text{vir}})} = \\frac{6M / (\\pi R_{\\text{ta}}^3)}{M / (3\\pi^3 R_{\\text{ta}}^3)} = 18\\pi^2 $$\n   - The result is a constant, independent of the anisotropy parameter $\\beta$.", "answer": "$$\\boxed{18\\pi^2}$$", "id": "849416"}, {"introduction": "While the spherical collapse model provides essential insights, we know that dark matter halos are not perfect spheres. This practice [@problem_id:896413] delves into the more realistic ellipsoidal collapse model, which explains the origin of halo shapes from the anisotropic nature of gravitational collapse. You will model the collapse along three principal axes independently, establishing a direct, quantitative link between the initial tidal field conditions of a proto-halo and the final axis ratios of the virialized structure. This exercise is crucial for understanding the morphological diversity of halos within the cosmic web.", "problem": "In the context of the formation of dark matter halos within an Einstein-de Sitter (EdS) universe, we consider a simplified version of the ellipsoidal collapse model. A proto-halo is identified at an early cosmic time $t_{ini}$ when the Hubble parameter is $H_{ini}$. At this time, the proto-halo is a uniform spherical overdense region of mass $M$ and radius $R_{ini}$. The mean linear theory overdensity within this region is $\\delta_L > 0$.\n\nThe initial peculiar velocity field inside the proto-halo, $\\vec{v}_{pec}$, is assumed to be homogeneous and is described by a symmetric velocity gradient tensor $\\mu_{ij} = \\partial v_{pec,i} / \\partial x_j$. The principal axes of this tensor define a coordinate system $(x_1, x_2, x_3)$ in which it is diagonal. The eigenvalues are denoted $\\mu_1, \\mu_2, \\mu_3$. These eigenvalues are related to the mean overdensity by the linear theory constraint $\\mu_1 + \\mu_2 + \\mu_3 = -H_{ini} \\delta_L$. We define the dimensionless normalized eigenvalues as $\\nu_i = \\mu_i / H_{ini}$, satisfying $\\nu_1 + \\nu_2 + \\nu_3 = -\\delta_L$. We adopt the convention $\\nu_1 > \\nu_2 > \\nu_3$.\n\nThe collapse of the proto-halo is modeled by assuming that the evolution of each principal semi-axis, $R_i(t)$, is governed by an independent one-dimensional equation of motion:\n$$ \\ddot{R}_i = -\\frac{GM}{R_i^2} $$\nwhere $G$ is the gravitational constant. The initial conditions for each axis at $t_{ini}$ are $R_i(t_{ini}) = R_{ini}$ and $\\dot{R}_i(t_{ini}) = H_{ini} R_{ini} + v_{pec,i} = (H_{ini} + \\mu_i) R_{ini}$.\n\nThe halo is considered fully virialized after each axis has collapsed and settled into a stable radius. The model assumes that the final virial radius for each axis, $R_{vir,i}$, is half of its respective maximum turnaround radius, $R_{ta,i}$. The resulting virialized halo is an ellipsoid with semi-axes $a > b > c$.\n\nDetermine the axis ratio $c/a$ of the final virialized halo in terms of the initial parameters $\\delta_L, \\nu_1, \\nu_2,$ and $\\nu_3$.", "solution": "The problem asks for the axis ratio $c/a$ of a virialized dark matter halo, based on a simplified model of ellipsoidal collapse.\n\n**1. Energy of Each Axis**\n\nThe motion of a test particle on the edge of the collapsing sphere along principal axis $i$ is described by the energy conservation equation for that 1D system. The specific energy (energy per unit mass) for axis $i$ is:\n$$ E_i = \\frac{1}{2} \\dot{R}_i^2 - \\frac{GM}{R_i} $$\nThis energy $E_i$ is a constant of motion for each axis. We can evaluate it at the initial time $t_{ini}$.\nAt $t_{ini}$, we have $R_i(t_{ini}) = R_{ini}$ and $\\dot{R}_i(t_{ini}) = (H_{ini} + \\mu_i)R_{ini}$.\nSubstituting these initial conditions into the energy equation:\n$$ E_i = \\frac{1}{2} ((H_{ini} + \\mu_i)R_{ini})^2 - \\frac{GM}{R_{ini}} $$\n\n**2. Expressing Energy in Terms of Given Parameters**\n\nThe mass $M$ of the proto-halo is related to the initial background density $\\bar{\\rho}_{ini}$ and the initial linear overdensity $\\delta_L$. The mean density inside the sphere is $\\bar{\\rho}_{ini}(1+\\delta_{NL})$, where $\\delta_{NL}$ is the non-linear overdensity. In the linear regime where $\\delta_L \\ll 1$, we have $\\delta_{NL} \\approx \\delta_L$.\nThe mass is $M = \\frac{4\\pi}{3} R_{ini}^3 \\bar{\\rho}_{ini} (1+\\delta_L)$.\n\nFor an Einstein-de Sitter (EdS) universe, the Hubble parameter and the background density are related by the Friedmann equation: $H_{ini}^2 = \\frac{8\\pi G}{3} \\bar{\\rho}_{ini}$.\nFrom this, we can write $G = \\frac{3H_{ini}^2}{8\\pi \\bar{\\rho}_{ini}}$.\nSubstituting this into the expression for the mass term:\n$$ \\frac{GM}{R_{ini}} = \\frac{G}{R_{ini}} \\left( \\frac{4\\pi}{3} R_{ini}^3 \\bar{\\rho}_{ini} (1+\\delta_L) \\right) = \\frac{4\\pi G \\bar{\\rho}_{ini}}{3} R_{ini}^2 (1+\\delta_L) $$\nUsing the Friedmann equation again: $\\frac{4\\pi G \\bar{\\rho}_{ini}}{3} = \\frac{H_{ini}^2}{2}$.\nSo, the potential energy term becomes:\n$$ \\frac{GM}{R_{ini}} = \\frac{1}{2} H_{ini}^2 R_{ini}^2 (1+\\delta_L) $$\n\nNow, substitute this back into the expression for $E_i$:\n$$ E_i = \\frac{1}{2} R_{ini}^2 (H_{ini} + \\mu_i)^2 - \\frac{1}{2} H_{ini}^2 R_{ini}^2 (1+\\delta_L) $$\nFactor out common terms and use the normalized eigenvalue $\\nu_i = \\mu_i/H_{ini}$:\n$$ E_i = \\frac{1}{2} H_{ini}^2 R_{ini}^2 \\left[ (1 + \\frac{\\mu_i}{H_{ini}})^2 - (1+\\delta_L) \\right] $$\n$$ E_i = \\frac{1}{2} H_{ini}^2 R_{ini}^2 \\left[ (1 + \\nu_i)^2 - (1+\\delta_L) \\right] $$\nFor the object to be gravitationally bound and eventually collapse, its total energy must be negative, so $E_i < 0$. This requires $(1+\\nu_i)^2 < 1+\\delta_L$.\n\n**3. Turnaround and Virial Radii**\n\nAt the turnaround point for axis $i$, the velocity $\\dot{R}_i$ is momentarily zero. The turnaround radius $R_{ta,i}$ is the radius at this instant. From the energy equation:\n$$ E_i = \\frac{1}{2}(0)^2 - \\frac{GM}{R_{ta,i}} = -\\frac{GM}{R_{ta,i}} $$\nTherefore, the turnaround radius for each axis is:\n$$ R_{ta,i} = -\\frac{GM}{E_i} $$\nThe problem states that the final virialized radius for each axis is half its turnaround radius:\n$$ R_{vir,i} = \\frac{1}{2} R_{ta,i} = -\\frac{GM}{2E_i} $$\n\n**4. Axis Ratios of the Final Halo**\n\nThe final virialized halo is an ellipsoid with semi-axes $R_{vir,1}, R_{vir,2}, R_{vir,3}$. The ratio of any two axes is:\n$$ \\frac{R_{vir,j}}{R_{vir,i}} = \\frac{-GM/(2E_j)}{-GM/(2E_i)} = \\frac{E_i}{E_j} $$\nSubstituting the expression for the energy $E_i$:\n$$ \\frac{R_{vir,j}}{R_{vir,i}} = \\frac{\\frac{1}{2} H_{ini}^2 R_{ini}^2 \\left[ (1 + \\nu_i)^2 - (1+\\delta_L) \\right]}{\\frac{1}{2} H_{ini}^2 R_{ini}^2 \\left[ (1 + \\nu_j)^2 - (1+\\delta_L) \\right]} = \\frac{(1 + \\nu_i)^2 - (1+\\delta_L)}{(1 + \\nu_j)^2 - (1+\\delta_L)} $$\n\n**5. Identifying the Major and Minor Axes**\n\nWe need to find the ratio $c/a$, where $c$ is the shortest axis and $a$ is the longest axis of the final halo. The lengths of the virialized axes are inversely proportional to the magnitude of their (negative) energies: $R_{vir,i} \\propto 1/|E_i|$. A more negative energy leads to a smaller turnaround radius and thus a smaller virial radius.\n\nThe initial eigenvalues are ordered as $\\nu_1 > \\nu_2 > \\nu_3$.\nThis means $(1+\\nu_1) > (1+\\nu_2) > (1+\\nu_3)$.\nThen $(1+\\nu_1)^2 > (1+\\nu_2)^2 > (1+\\nu_3)^2$.\nThe energies are $E_i \\propto [(1+\\nu_i)^2 - (1+\\delta_L)]$. Since all $E_i$ must be negative for collapse, this implies:\n$$ E_1 > E_2 > E_3 $$\n(i.e., $E_1$ is the least negative, and $E_3$ is the most negative).\nSince the final radii are $R_{vir,i} = -GM/(2E_i)$, the ordering of the radii will be:\n$$ R_{vir,1} > R_{vir,2} > R_{vir,3} $$\nTherefore, the longest semi-axis is $a = R_{vir,1}$, the intermediate axis is $b=R_{vir,2}$, and the shortest semi-axis is $c=R_{vir,3}$.\n\nThe desired axis ratio is $c/a = R_{vir,3}/R_{vir,1}$.\n$$ \\frac{c}{a} = \\frac{R_{vir,3}}{R_{vir,1}} = \\frac{E_1}{E_3} $$\nSubstituting the expressions for $E_1$ and $E_3$:\n$$ \\frac{c}{a} = \\frac{(1 + \\nu_1)^2 - (1+\\delta_L)}{(1 + \\nu_3)^2 - (1+\\delta_L)} $$\n\nThis is the final expression for the axis ratio $c/a$.", "answer": "$$ \\boxed{\\frac{(1 + \\nu_1)^2 - (1 + \\delta_L)}{(1 + \\nu_3)^2 - (1 + \\delta_L)}} $$", "id": "896413"}, {"introduction": "Moving from the dynamics of single halos to the statistics of the entire population, the excursion set theory offers a powerful framework for predicting the halo mass function. This advanced problem [@problem_id:896407] invites you to explore the frontiers of this theory by modifying its core assumptions. You will treat the critical collapse barrier not as a constant, but as a stochastically fluctuating quantity, providing a simplified model for the complex effects of baryonic feedback. By solving for the first-crossing distribution in this new scenario, you will gain hands-on experience with the path-integral formulation of the theory and appreciate its flexibility in modeling new physical processes.", "problem": "In the framework of the excursion set theory for halo formation, the formation of a dark matter halo of mass $M$ is associated with the first time the smoothed linear density contrast, $\\delta(\\sigma^2)$, on a scale corresponding to variance $\\sigma^2(M)$, crosses a critical collapse threshold $\\delta_c$. The evolution of $\\delta$ as a function of the variance $\\sigma^2$ (which increases as the smoothing mass scale $M$ decreases) can be modeled as a random walk. In the path-integral formulation, this corresponds to a diffusion process.\n\nLet's consider a modification to this model where baryonic feedback processes introduce stochasticity into the collapse condition. We model this by promoting the constant collapse barrier $\\delta_c$ to a stochastically fluctuating barrier $B(\\sigma^2)$.\n\nThe problem is defined by two independent stochastic processes:\n1.  The linear density contrast, $\\delta(\\sigma^2)$, which is a Wiener process starting at $\\delta(0)=0$. Its variance is given by $\\langle \\delta(\\sigma^2)^2 \\rangle = \\sigma^2$. The probability distribution for $\\delta$ evolves according to the diffusion equation $\\frac{\\partial P}{\\partial \\sigma^2} = \\frac{1}{2} \\frac{\\partial^2 P}{\\partial \\delta^2}$.\n2.  The fluctuating collapse barrier, $B(\\sigma^2)$, which is also a Wiener process, but is independent of $\\delta(\\sigma^2)$. It starts at a mean value $B(0) = \\delta_c$, and its fluctuations grow with variance given by $\\langle (B(\\sigma^2) - \\delta_c)^2 \\rangle = D \\sigma^2$, where $D$ is a positive dimensionless constant that quantifies the strength of the barrier's stochasticity.\n\nA halo is formed at the mass scale $M$ corresponding to the variance $\\sigma^2$ where the trajectory of the density contrast $\\delta(\\sigma^2)$ first crosses the trajectory of the barrier $B(\\sigma^2)$.\n\nDetermine the modified first-crossing distribution, $f(\\sigma^2)$. This function is defined such that $f(\\sigma^2) d\\sigma^2$ represents the probability that a given mass element collapses (i.e., its trajectory first crosses the barrier) within the variance interval $[\\sigma^2, \\sigma^2 + d\\sigma^2]$.", "solution": "1. Define the two independent Wiener processes on “time” $s\\equiv\\sigma^2$:\n   - $\\delta(s)$ with mean $0$ and $\\langle\\delta(s)^2\\rangle=s$.\n   - $B(s)$ with mean $\\delta_c$ and $\\langle(B(s)-\\delta_c)^2\\rangle=D\\,s$.\n2. Introduce \n   $$X(s)\\equiv B(s)-\\delta(s)\\,,$$ \n   so that $X(0)=\\delta_c$ and \n   $$\\langle[X(s)-\\delta_c]^2\\rangle \n     =\\langle(B(s)-\\delta_c)^2\\rangle+\\langle\\delta(s)^2\\rangle\n     =(D+1)\\,s\\,.$$ \n   Hence $X(s)$ is equivalent to a single Wiener process starting at $\\delta_c$ whose variance grows as $(1+D)s$.\n3. The first‐crossing of $\\delta(s)$ above $B(s)$ is equivalently the first‐passage of $X(s)$ to zero, starting from $X(0)=\\delta_c$.\n4. For a Wiener process with zero drift starting at $x_0$, whose variance is $k \\cdot s$, the standard first‐passage time distribution at level zero is \n   $$f(s)=\\frac{x_0}{\\sqrt{2\\pi k s^3}}\n            \\exp\\!\\Bigl(-\\frac{x_0^2}{2 k s}\\Bigr)\\,. $$\n5. In our case, the starting position is $x_0 = \\delta_c$, the \"time\" is $s = \\sigma^2$, and the variance coefficient is $k=1+D$. Substituting these gives the modified first‐crossing distribution.", "answer": "$$\\boxed{f(\\sigma^2)=\\frac{\\delta_c}{\\sqrt{2\\pi\\,(1+D)\\,(\\sigma^2)^3}}\n\\exp\\!\\Bigl(-\\frac{\\delta_c^2}{2\\,(1+D)\\,\\sigma^2}\\Bigr)}$$", "id": "896407"}]}