{"hands_on_practices": [{"introduction": "The velocity of a star in the plane of the sky is not a direct observable but a quantity derived from its proper motion and parallax. This fundamental calculation is the first step in any kinematic analysis. This exercise demonstrates how to correctly propagate measurement uncertainties from the raw astrometric data to the final tangential velocity components, highlighting a crucial point: since both velocity components depend on the same parallax measurement, their uncertainties are inherently correlated. Deriving the full covariance matrix is essential for any rigorous subsequent analysis. [@problem_id:274431]", "problem": "In stellar kinematics, the tangential velocity of a star in the plane of the sky is a crucial derived quantity. It is typically resolved into two components along the axes of a celestial coordinate system. In the Galactic coordinate system, these components are $v_l$ (velocity in the direction of increasing Galactic longitude $l$) and $v_b$ (velocity in the direction of increasing Galactic latitude $b$).\n\nThese velocities are not directly measured but are calculated from three astrometric observables: the annual parallax $\\varpi$ and the two components of proper motion, $\\mu_l$ and $\\mu_b$. The relationships are:\n$$v_l = K \\frac{\\mu_l}{\\varpi}$$\n$$v_b = K \\frac{\\mu_b}{\\varpi}$$\nwhere $K$ is a constant that handles the conversion of units (e.g., from milliarcseconds for parallax and milliarcseconds/year for proper motion to km/s for velocity).\n\nThe observed quantities $(\\mu_l, \\mu_b, \\varpi)$ each have measurement uncertainties, denoted by $\\sigma_{\\mu_l}$, $\\sigma_{\\mu_b}$, and $\\sigma_\\varpi$, respectively. It is standard to assume that the measurement errors for these three observables are statistically independent (uncorrelated). However, since both $v_l$ and $v_b$ depend on the same parallax measurement $\\varpi$, their uncertainties will be correlated.\n\nThe uncertainty of a set of derived quantities $\\mathbf{y} = f(\\mathbf{x})$ can be described by a covariance matrix $\\mathbf{C_y}$, which is calculated from the covariance matrix of the input observables, $\\mathbf{C_x}$, using the first-order error propagation formula:\n$$\\mathbf{C_y} = \\mathbf{J} \\mathbf{C_x} \\mathbf{J}^T$$\nwhere $\\mathbf{J}$ is the Jacobian matrix of the transformation ($J_{ij} = \\partial y_i / \\partial x_j$) and $\\mathbf{J}^T$ is its transpose.\n\nDerive the 2x2 covariance matrix for the tangential velocity components, $\\mathbf{C_v}$, defined as:\n$$\\mathbf{C_v} = \\begin{pmatrix} \\sigma_{v_l}^2 & \\mathrm{Cov}(v_l, v_b) \\\\ \\mathrm{Cov}(v_b, v_l) & \\sigma_{v_b}^2 \\end{pmatrix}$$\nExpress your answer in terms of the observables $\\mu_l, \\mu_b, \\varpi$, their uncertainties $\\sigma_{\\mu_l}, \\sigma_{\\mu_b}, \\sigma_\\varpi$, and the constant $K$.", "solution": "We have $\\mathbf{y}=(v_l,v_b)$ and $\\mathbf{x}=(\\mu_l,\\mu_b,\\varpi)$.  The Jacobian matrix $J_{ij}=\\partial y_i/\\partial x_j$ is\n$$\\frac{\\partial v_l}{\\partial\\mu_l}=\\frac{K}{\\varpi},\\quad\n\\frac{\\partial v_l}{\\partial\\mu_b}=0,\\quad\n\\frac{\\partial v_l}{\\partial\\varpi}=-\\frac{K\\mu_l}{\\varpi^2},$$\n$$\\frac{\\partial v_b}{\\partial\\mu_l}=0,\\quad\n\\frac{\\partial v_b}{\\partial\\mu_b}=\\frac{K}{\\varpi},\\quad\n\\frac{\\partial v_b}{\\partial\\varpi}=-\\frac{K\\mu_b}{\\varpi^2},$$\nso\n$$J=\\begin{pmatrix}\nK/\\varpi & 0 & -K\\mu_l/\\varpi^2\\\\\n0 & K/\\varpi & -K\\mu_b/\\varpi^2\n\\end{pmatrix}.$$\n\nThe input covariance is\n$$C_x=\\operatorname{diag}(\\sigma_{\\mu_l}^2,\\sigma_{\\mu_b}^2,\\sigma_\\varpi^2).$$\nBy first-order error propagation,\n$$C_v=J\\,C_x\\,J^T,$$\ngiving componentwise\n$$\\sigma_{v_l}^2\n=(K/\\varpi)^2\\sigma_{\\mu_l}^2+(-K\\mu_l/\\varpi^2)^2\\,\\sigma_\\varpi^2\n=K^2\\Bigl(\\frac{\\sigma_{\\mu_l}^2}{\\varpi^2}+\\frac{\\mu_l^2\\sigma_\\varpi^2}{\\varpi^4}\\Bigr),$$\n$$\\sigma_{v_b}^2\n=(K/\\varpi)^2\\sigma_{\\mu_b}^2+(-K\\mu_b/\\varpi^2)^2\\,\\sigma_\\varpi^2\n=K^2\\Bigl(\\frac{\\sigma_{\\mu_b}^2}{\\varpi^2}+\\frac{\\mu_b^2\\sigma_\\varpi^2}{\\varpi^4}\\Bigr),$$\n$$\\mathrm{Cov}(v_l,v_b)\n=(-K\\mu_l/\\varpi^2)(-K\\mu_b/\\varpi^2)\\,\\sigma_\\varpi^2\n=K^2\\frac{\\mu_l\\mu_b\\,\\sigma_\\varpi^2}{\\varpi^4}.$$\n\nHence\n$$C_v=\\begin{pmatrix}\nK^2\\bigl(\\tfrac{\\sigma_{\\mu_l}^2}{\\varpi^2}+\\tfrac{\\mu_l^2\\sigma_\\varpi^2}{\\varpi^4}\\bigr)\n&K^2\\tfrac{\\mu_l\\mu_b\\,\\sigma_\\varpi^2}{\\varpi^4}\\\\\nK^2\\tfrac{\\mu_l\\mu_b\\,\\sigma_\\varpi^2}{\\varpi^4}\n&K^2\\bigl(\\tfrac{\\sigma_{\\mu_b}^2}{\\varpi^2}+\\tfrac{\\mu_b^2\\sigma_\\varpi^2}{\\varpi^4}\\bigr)\n\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}\nK^2\\Bigl(\\frac{\\sigma_{\\mu_l}^2}{\\varpi^2}+\\frac{\\mu_l^2\\sigma_\\varpi^2}{\\varpi^4}\\Bigr)&\nK^2\\frac{\\mu_l\\mu_b\\,\\sigma_\\varpi^2}{\\varpi^4}\\\\\nK^2\\frac{\\mu_l\\mu_b\\,\\sigma_\\varpi^2}{\\varpi^4}&\nK^2\\Bigl(\\frac{\\sigma_{\\mu_b}^2}{\\varpi^2}+\\frac{\\mu_b^2\\sigma_\\varpi^2}{\\varpi^4}\\Bigr)\n\\end{pmatrix}}$$", "id": "274431"}, {"introduction": "Understanding measurement uncertainty is only half the battle; we must also contend with the subtle systematic biases it can introduce. This thought experiment explores a classic issue in stellar kinematics, a form of Lutz-Kelker bias, where unbiased, random errors in parallax lead to a systematic overestimation of a population's kinetic energy. The exercise provides a hands-on way to understand how non-linear relationships, like the inverse dependence of velocity on parallax ($v_t \\propto 1/\\varpi$), can skew statistical results. [@problem_id:274126]", "problem": "In astrophysical measurements, the tangential velocity $v_t$ of a star is determined from its observed annual proper motion $\\mu$ and its trigonometric parallax $\\varpi$ using the relation $v_t = K \\frac{\\mu}{\\varpi}$, where $K$ is a known numerical constant that handles the conversion of units.\n\nConsider a large population of stars that are all at the same true distance from the Sun, and thus share the same true parallax, denoted by $\\varpi_t$. Furthermore, assume all stars in this population have the same true tangential velocity, $v_{t,t}$. An astronomer measures the parallax for each star in this population. The measurement process is subject to random errors, such that the measured parallax for any given star, $\\varpi_m$, is a random variable described by a Gaussian (normal) distribution with a mean equal to the true parallax $\\varpi_t$ and a standard deviation $\\sigma_\\varpi$. The proper motion $\\mu$ is assumed to be measured with negligible uncertainty.\n\nDue to the non-linear relationship between $v_t$ and $\\varpi$, the expectation value of the squared measured tangential velocity, $\\langle v_{t,m}^2 \\rangle$, will not be equal to the true squared tangential velocity, $v_{t,t}^2$. This discrepancy is a form of statistical bias.\n\nFor high-precision measurements, the fractional parallax uncertainty, defined as $f = \\sigma_\\varpi / \\varpi_t$, is much less than one ($f \\ll 1$). In this limit, the ratio of the expected measured squared velocity to the true squared velocity can be approximated by a power series in $f$. To the leading non-trivial order, this relationship takes the form:\n$$\n\\frac{\\langle v_{t,m}^2 \\rangle}{v_{t,t}^2} = 1 + C f^2 + \\mathcal{O}(f^4)\n$$\nYour task is to derive the value of the dimensionless constant coefficient $C$.", "solution": "1. The measured and true tangential velocities satisfy\n$$\nv_{t,m} \\;=\\; K\\,\\frac{\\mu}{\\varpi_m}, \n\\quad\nv_{t,t} \\;=\\; K\\,\\frac{\\mu}{\\varpi_t},\n$$\nso\n$$\n\\frac{\\langle v_{t,m}^2\\rangle}{v_{t,t}^2}\n=\\left\\langle\\left(\\frac{\\varpi_t}{\\varpi_m}\\right)^2\\right\\rangle.\n$$\n\n2. Let $\\varpi_m$ be a Gaussian random variable $X\\sim\\mathcal{N}(\\varpi_t,\\sigma_\\varpi)$ and define the dimensionless\n$$\nY = \\frac{X}{\\varpi_t}\\sim\\mathcal{N}(1,f), \n\\quad f = \\frac{\\sigma_\\varpi}{\\varpi_t}.\n$$\nThen\n$$\n\\frac{\\langle v_{t,m}^2\\rangle}{v_{t,t}^2}\n= \\big\\langle Y^{-2}\\big\\rangle.\n$$\n\n3. Write $Y=1+\\delta$ with $\\delta\\sim\\mathcal{N}(0,f)$ and expand\n$$\n\\frac{1}{Y^2} = (1+\\delta)^{-2}\n= \\sum_{k=0}^\\infty \\binom{-2}{k}\\,\\delta^k\n=1 -2\\delta +3\\delta^2 -4\\delta^3 +5\\delta^4+\\cdots.\n$$\n\n4. Taking expectations and using $E[\\delta]=0$, $E[\\delta^2]=f^2$, $E[\\delta^3]=0$, $E[\\delta^4]=3f^4$,\n$$\n\\big\\langle Y^{-2}\\big\\rangle = 1 +3f^2 + \\mathcal{O}(f^4).\n$$\n\n5. Hence\n$$\n\\frac{\\langle v_{t,m}^2\\rangle}{v_{t,t}^2} = 1 + 3f^2 + \\mathcal{O}(f^4),\n$$\nand the coefficient is $C=3$.", "answer": "$$\\boxed{3}$$", "id": "274126"}, {"introduction": "Armed with a proper understanding of velocities and their uncertainties, we can tackle sophisticated problems in Galactic archeology, such as identifying coherent stellar streams. This practice moves into the realm of modern statistical modeling by asking you to construct a likelihood function for a Gaussian Mixture Model (GMM). This powerful technique allows us to kinematically disentangle a stream population from the background field population by properly accounting for both the intrinsic velocity dispersion of each group and the unique measurement error for every star. [@problem_id:274260]", "problem": "An astronomical survey has collected kinematic data for a large sample of $N$ stars in a region of the Milky Way thought to contain a stellar stream. These streams are coherent structures of stars with common origin, and thus similar kinematics, moving through the general \"field\" population of the Galaxy. The observed 3D velocity vector $\\vec{v}_i$ for each star $i$ (derived from its proper motion, radial velocity, and parallax) is subject to measurement uncertainties, characterized by a $3 \\times 3$ covariance matrix $\\mathbf{C}_i$.\n\nTo distinguish the stream from the field population, we model the velocity distribution of the entire sample as a Gaussian Mixture Model (GMM). The model has two components: a \"stream\" component and a \"field\" component.\n\nThe model assumptions are as follows:\n1.  A fraction $f_s$ of the stars in the sample belong to the stream, and the remaining fraction $(1-f_s)$ belong to the field.\n2.  The true 3D velocities of the stream stars are drawn from a multivariate Gaussian distribution with a mean vector $\\vec{\\mu}_s$ and an intrinsic covariance matrix $\\mathbf{\\Sigma}_s$.\n3.  The true 3D velocities of the field stars are drawn from a separate multivariate Gaussian distribution with mean vector $\\vec{\\mu}_f$ and intrinsic covariance matrix $\\mathbf{\\Sigma}_f$.\n4.  The observational process introduces a measurement error for each star. The observed velocity $\\vec{v}_i$ of a star is the sum of its true velocity $\\vec{u}_i$ and a measurement error vector $\\vec{\\epsilon}_i$. The errors are assumed to be drawn from a zero-mean multivariate Gaussian distribution, $P(\\vec{\\epsilon}_i) = \\mathcal{N}(\\vec{\\epsilon}_i|\\vec{0}, \\mathbf{C}_i)$, where $\\mathbf{C}_i$ is the known measurement error covariance matrix for star $i$.\n\nThe full set of model parameters is $\\theta = \\{f_s, \\vec{\\mu}_s, \\mathbf{\\Sigma}_s, \\vec{\\mu}_f, \\mathbf{\\Sigma}_f\\}$. The available data is the set of observed velocities and their error covariances, $\\{\\vec{v}_i, \\mathbf{C}_i\\}_{i=1}^N$.\n\nDerive the total log-likelihood function, $\\ln L(\\theta)$, for the model parameters given the observed data. The final expression must be a single, closed-form analytic expression, written in terms of the model parameters and the data.", "solution": "1. The marginal likelihood for observed velocity $\\vec v_i$ is the mixture of two Gaussians,\n$$\nP(\\vec v_i\\mid\\theta)\n= f_s\\,\\mathcal N(\\vec v_i\\mid\\vec\\mu_s,\\Sigma_s+C_i)\n+(1-f_s)\\,\\mathcal N(\\vec v_i\\mid\\vec\\mu_f,\\Sigma_f+C_i),\n$$\nwith\n$$\n\\mathcal N(\\vec v\\mid\\vec\\mu,\\Sigma)\n=\\frac{1}{\\sqrt{(2\\pi)^3\\det\\Sigma}}\n\\exp\\!\\Bigl(-\\tfrac12(\\vec v-\\vec\\mu)^\\top\\Sigma^{-1}(\\vec v-\\vec\\mu)\\Bigr).\n$$\n\n2. The total likelihood is\n$$\nL(\\theta)=\\prod_{i=1}^N P(\\vec v_i\\mid\\theta).\n$$\n\n3. Taking the logarithm gives the log-likelihood,\n$$\n\\ln L(\\theta)\n=\\sum_{i=1}^N\\ln\\Biggl[\nf_s\\,\\frac{\\exp\\!\\bigl(-\\tfrac12(\\vec v_i-\\vec\\mu_s)^\\top(\\Sigma_s+C_i)^{-1}(\\vec v_i-\\vec\\mu_s)\\bigr)}\n{\\sqrt{(2\\pi)^3\\det(\\Sigma_s+C_i)}} \n+(1-f_s)\\,\\frac{\\exp\\!\\bigl(-\\tfrac12(\\vec v_i-\\vec\\mu_f)^\\top(\\Sigma_f+C_i)^{-1}(\\vec v_i-\\vec\\mu_f)\\bigr)}\n{\\sqrt{(2\\pi)^3\\det(\\Sigma_f+C_i)}}\\Biggr].\n$$", "answer": "$$\\boxed{\\ln L(\\theta)=\\sum_{i=1}^N\\ln\\Biggl[f_s\\frac{1}{\\sqrt{(2\\pi)^3\\det(\\Sigma_s+C_i)}}\\exp\\Bigl(-\\tfrac12(\\vec v_i-\\vec\\mu_s)^\\top(\\Sigma_s+C_i)^{-1}(\\vec v_i-\\vec\\mu_s)\\Bigr)+(1-f_s)\\frac{1}{\\sqrt{(2\\pi)^3\\det(\\Sigma_f+C_i)}}\\exp\\Bigl(-\\tfrac12(\\vec v_i-\\vec\\mu_f)^\\top(\\Sigma_f+C_i)^{-1}(\\vec v_i-\\vec\\mu_f)\\Bigr)\\Biggr]}$$", "id": "274260"}]}