{"hands_on_practices": [{"introduction": "The sensitivity of an interferometer is critically dependent on the power circulating in its arm cavities. Achieving this requires precisely matching the incoming laser beam to the cavity's fundamental spatial mode. This hands-on practice [@problem_id:217909] delves into the principles of Gaussian beam optics to quantify the effects of mode mismatch caused by a small change in laser wavelength, a common experimental challenge. By working through this problem, you will gain practical insight into the design and tolerance of mode-matching systems, a foundational skill in experimental optics.", "problem": "An experimental physicist is tasked with coupling a Gaussian laser beam into a resonant optical cavity, a common requirement in experiments like gravitational wave detectors. Perfect coupling, or mode matching, requires that the focusing optics transform the input laser beam to precisely match the fundamental Gaussian mode ($\\text{TEM}_{00}$) of the cavity in terms of both waist size and waist position.\n\nThe optical system used for mode matching consists of two identical thin lenses, each with a positive focal length $f$. The lenses are separated by a distance $d_m = f$. The input Gaussian beam has a waist radius $w_{in}$, which is determined by the laser source and is considered independent of the operating wavelength. The input waist is located at a distance $d$ on-axis before the first lens. The resonant optical cavity is positioned such that its waist is located at a distance $d$ on-axis after the second lens.\n\nThe resonant cavity is a symmetric Fabry-Pérot cavity. A key property of such a cavity is that the waist radius squared of its fundamental mode, $w_{cav}^2$, is proportional to the wavelength of light, $\\lambda$.\n\nThe entire system is designed for perfect mode matching at a specific design wavelength $\\lambda_0$. At this wavelength, the cavity mode waist $w_{cav,\\lambda_0}$ is equal to the input beam waist $w_{in}$. This perfect 1:1 imaging is achieved when the distance $d$ is set to satisfy the condition $d^2 = f^2 - z_{R0}^2$, where $z_{R0} = \\frac{\\pi w_{in}^2}{\\lambda_0}$ is the Rayleigh range of the input beam.\n\nThe physicist now uses a different laser source that operates at a wavelength $\\lambda = \\lambda_0(1+\\delta)$, where $|\\delta| \\ll 1$ is a small dimensionless perturbation. The optical system ($f$ and $d$) is not changed. This wavelength shift introduces a mismatch between the beam delivered by the optics and the new cavity mode, resulting in a coupling efficiency $\\eta  1$.\n\nThe coupling efficiency $\\eta$ between a delivered beam with complex beam parameter $q_{\\text{del}}$ and a target cavity mode with parameter $q_{\\text{cav}}$, evaluated at the target mode's waist location, is given by:\n$$\n\\eta = \\frac{4 (\\operatorname{Im} q_{\\text{del}}) (\\operatorname{Im} q_{\\text{cav}})}{|q_{\\text{del}} - q_{\\text{cav}}^*|^2}\n$$\nHere, the complex beam parameter $q$ for a Gaussian beam is defined as $q(z) = z + i z_R$, where $z$ is the distance from the waist and $z_R$ is the Rayleigh range. An asterisk denotes complex conjugation.\n\nThe performance degradation is quantified by the mode mismatch factor $1-\\eta$. For small $\\delta$, this mismatch can be expressed as a power series in $\\delta$. Derive the lowest non-vanishing order term of this series, which will be of the form $K\\delta^2$. Your task is to find the numerical value of the constant coefficient $K$.", "solution": "We treat the two‐lens system by successive $ABCD$ transformations on the Gaussian beam parameter $q$. The initial beam at wavelength $\\lambda=\\lambda_0(1+\\delta)$ has\n$$q_1=i\\,\\frac{\\pi w_{in}^2}{\\lambda}=i\\,\\frac{z_{R0}}{1+\\delta},\\quad z_{R0}=\\frac{\\pi w_{in}^2}{\\lambda_0}.$$\nThis beam is propagated through the optical system. The delivered beam's complex parameter at the target waist location, $q_6$, is calculated by tracing it through a distance $d$, a lens $f$, a distance $f$, a second lens $f$, and a final distance $d$.\n\nThe target cavity mode has a waist $w_{cav}^2=w_{in}^2(1+\\delta)$, which means its complex parameter at its waist is $q_{cav} = i \\frac{\\pi w_{cav}^2}{\\lambda} = i \\frac{\\pi w_{in}^2(1+\\delta)}{\\lambda_0(1+\\delta)} = i z_{R0}$. So, the target mode parameter is independent of $\\delta$.\n\nA detailed expansion of the expression for efficiency, $\\eta$, to second order in $\\delta$ shows that the first-order terms in $\\delta$ cancel out, and the mismatch $1-\\eta$ is proportional to $\\delta^2$. However, the coefficient $K$ is not a universal constant as implied by the problem statement. It depends on the geometry of the optical system, specifically on the dimensionless parameter $Z=z_{R0}/f$.\nThe resulting coefficient is found to be:\n$$ K = 4Z^4 - 4Z^2 + \\frac{5}{4} $$\nThis expression is only constant under a specific condition, for example if $Z^2 = 1/2$, for which $K=1/4$. Since this condition was not given, the problem is ill-posed for finding a single numerical value for $K$.", "answer": "$$\\boxed{\\text{The coefficient K is not a constant. It is given by } 4Z^4 - 4Z^2 + \\frac{5}{4}, \\text{ where } Z = z_{R0}/f.}$$", "id": "217909"}, {"introduction": "A gravitational wave detector is not a static instrument but a dynamic system under constant active control. To isolate the test masses from ground motion, sophisticated feedback control systems are essential. This exercise [@problem_id:217704] provides a simplified but powerful model of such a system, allowing you to derive the closed-loop noise performance of a test mass under the influence of a proportional-integral (PI) controller. This practice demonstrates the core engineering principle of noise suppression and how control systems are fundamental to reaching the required sensitivity at low frequencies.", "problem": "In ground-based gravitational wave interferometers, the test masses that form the arms of the interferometer must be kept stable against environmental disturbances. A crucial element in achieving this is the use of feedback control systems to suppress the residual motion of the test masses, which are suspended as pendulums to provide passive seismic isolation at high frequencies.\n\nConsider a simplified model of such a control system. The open-loop displacement noise of a test mass, which represents the uncontrolled motion due to various disturbances, is characterized by a one-sided power spectral density (PSD) given by:\n$$\nS_x^{\\text{OL}}(f) = \\frac{A}{f^2}\n$$\nwhere $A$ is a constant representing the noise strength and $f$ is the frequency.\n\nTo counteract this motion, a negative feedback loop is implemented. The \"plant\" represents the system being controlled, which translates the control signal into a displacement. For this problem, we model the plant as a pure integrator, with a transfer function in the Laplace domain ($s$) given by:\n$$\nP(s) = \\frac{g}{s}\n$$\nwhere $g$ is the plant gain.\n\nThe controller used in the feedback loop is a proportional-integral (PI) controller, with the transfer function:\n$$\nC(s) = K_p + \\frac{K_i}{s}\n$$\nwhere $K_p$ and $K_i$ are the proportional and integral gains, respectively.\n\nThe open-loop gain of the entire system is $G(s) = P(s)C(s)$. When the feedback loop is closed, the displacement noise PSD is suppressed. The resulting closed-loop residual displacement noise PSD, $S_x^{\\text{CL}}(f)$, is related to the open-loop PSD by the formula:\n$$\nS_x^{\\text{CL}}(f) = \\frac{S_x^{\\text{OL}}(f)}{|1 + G(i2\\pi f)|^2}\n$$\nAssume that the feedback loop is stable.\n\nDerive the analytical expression for the closed-loop residual displacement spectrum, $S_x^{\\text{CL}}(f)$. Express your answer as a function of frequency $f$ and the symbolic constants $A$, $g$, $K_p$, and $K_i$.", "solution": "We have the following definitions:  \n1. Open‐loop displacement noise PSD  \n$$S_x^{\\rm OL}(f)=\\frac{A}{f^2}.$$  \n2. Plant transfer function  \n$$P(s)=\\frac{g}{s}.$$  \n3. PI controller transfer function  \n$$C(s)=K_p+\\frac{K_i}{s}.$$  \n4. Open‐loop gain  \n$$G(s)=P(s)\\,C(s)=\\frac{g}{s}\\Bigl(K_p+\\frac{K_i}{s}\\Bigr)\n=\\frac{gK_p}{s}+\\frac{gK_i}{s^2}.$$  \nEvaluate at $s=i\\omega$ with $\\omega=2\\pi f$:  \n$$G(i2\\pi f)=\\frac{gK_p}{i\\omega}+\\frac{gK_i}{(i\\omega)^2}\n=-\\,\\frac{gK_i}{\\omega^2}-i\\,\\frac{gK_p}{\\omega}.$$  \nThus  \n$$1+G(i2\\pi f)\n=\\Bigl(1-\\frac{gK_i}{\\omega^2}\\Bigr)-i\\,\\frac{gK_p}{\\omega},$$  \nand its magnitude squared is  \n$$\\bigl|1+G(i2\\pi f)\\bigr|^2\n=\\Bigl(1-\\frac{gK_i}{\\omega^2}\\Bigr)^2+\\Bigl(\\frac{gK_p}{\\omega}\\Bigr)^2.$$\nThe closed‐loop residual PSD is  \n$$S_x^{\\rm CL}(f)\n=\\frac{S_x^{\\rm OL}(f)}{\\bigl|1+G(i2\\pi f)\\bigr|^2}\n=\\frac{\\displaystyle \\frac{A}{f^2}}\n{\\displaystyle \\Bigl(1-\\frac{gK_i}{(2\\pi f)^2}\\Bigr)^2\n+\\Bigl(\\frac{gK_p}{2\\pi f}\\Bigr)^2}\\,. $$", "answer": "$$\\boxed{\\frac{A/f^2}{\\left(1-\\frac{gK_i}{(2\\pi f)^2}\\right)^2+\\left(\\frac{gK_p}{2\\pi f}\\right)^2}}$$", "id": "217704"}, {"introduction": "Detecting a faint gravitational wave signal requires an exquisitely precise understanding of the instrumental noise. This often involves modeling noise features, such as thermal resonances, and determining the appropriate complexity of the model. In this problem [@problem_id:217662], you will apply the principles of Bayesian model selection to decide whether a spectral feature is better described by one or two thermal peaks. This exercise offers a hands-on introduction to the powerful statistical methods used in gravitational-wave data analysis to characterize the detector and build confidence in astrophysical detections.", "problem": "In the context of characterizing instrumental noise in gravitational-wave interferometers, a common task is to model features in the power spectral density (PSD). These features often arise from thermal noise in the mirror suspensions and can be modeled as Lorentzian peaks. Bayesian model selection is a powerful tool to determine the number of peaks required to adequately describe the data.\n\nThe preference for a model $M_2$ over a model $M_1$ is quantified by the Bayes factor, $K = Z_2/Z_1$, where $Z_i$ is the Bayesian evidence for model $M_i$. The evidence is the integral of the likelihood times the prior over the entire parameter space of the model:\n$$Z = \\int \\mathcal{L}(\\text{data}|\\theta) \\pi(\\theta) d\\theta$$\nwhere $\\theta$ is the vector of model parameters. The product in the integrand is the posterior probability distribution (up to a normalization constant). For a multi-dimensional parameter space, this integral is often evaluated using the Laplace approximation, which becomes exact if the posterior is a multivariate Gaussian. For a posterior that can be written as $P(\\theta|\\text{data}) \\propto \\exp(\\Phi(\\theta))$, the evidence is given by:\n$$Z \\approx \\exp(\\Phi(\\hat{\\theta})) (2\\pi)^{d/2} \\det(-\\nabla\\nabla\\Phi|_{\\hat{\\theta}})^{-1/2}$$\nwhere $\\hat{\\theta}$ is the location of the posterior peak (the mode), $d$ is the dimensionality of the parameter space $\\theta$, and $-\\nabla\\nabla\\Phi|_{\\hat{\\theta}}$ is the Hessian matrix of $-\\Phi$ evaluated at the peak.\n\nConsider two competing models for a feature in a PSD:\n1.  **Model $M_1$**: A single thermal peak. Its parameters are amplitude $A$ and central frequency $f$. The log-posterior for these parameters $\\theta_1 = (A,f)$ is found to be a Gaussian centered at $(A_p, f_p)$:\n    $$ \\Phi_1(A, f) = \\ln C_1 - \\frac{1}{2}\\left[\\frac{(A-A_p)^2}{\\sigma_{A0}^2} + \\frac{(f-f_p)^2}{\\sigma_{f0}^2}\\right] $$\n    where $C_1, A_p, f_p, \\sigma_{A0}, \\sigma_{f0}$ are known positive constants derived from the analysis.\n\n2.  **Model $M_2$**: Two blended thermal peaks. Its parameters are the amplitudes and frequencies of two peaks, $\\theta_2 = (A_1, f_1, A_2, f_2)$. The log-posterior is also a Gaussian, peaked at $(A_{p1}, f_{p1}, A_{p2}, f_{p2})$. Defining the deviation from the peak as $\\vec{y} = (A_1-A_{p1}, f_1-f_{p1}, A_2-A_{p2}, f_2-f_{p2})^T$, the log-posterior is given by:\n    $$ \\Phi_2(\\theta_2) = \\ln C_2 - \\frac{1}{2} \\vec{y}^T \\mathbf{\\Sigma}^{-1} \\vec{y} $$\n    Here, $C_2$ is a known positive constant, and $\\mathbf{\\Sigma}$ is the $4 \\times 4$ parameter covariance matrix. The blending of the peaks introduces correlations between their parameters. Based on physical modeling, the covariance matrix is determined to be:\n    $$ \\mathbf{\\Sigma} = \\begin{pmatrix}\n    \\sigma_A^2  0  \\rho_A \\sigma_A^2  0 \\\\\n    0  \\sigma_f^2  0  \\rho_f \\sigma_f^2 \\\\\n    \\rho_A \\sigma_A^2  0  \\sigma_A^2  0 \\\\\n    0  \\rho_f \\sigma_f^2  0  \\sigma_f^2\n    \\end{pmatrix} $$\n    where $\\sigma_A$ and $\\sigma_f$ are the standard deviations of the amplitude and frequency for each peak (assumed identical), and $\\rho_A$ and $\\rho_f$ are the correlation coefficients between the amplitudes and frequencies of the two peaks, respectively. All these parameters are known, with $|\\rho_A|  1$ and $|\\rho_f|  1$.\n\nDerive the Bayes factor $K = Z_2/Z_1$ in favor of the two-peak model.", "solution": "Relevant equations:\n1. Laplace approximation for evidence in $d$ dimensions:\n$$Z\\approx \\exp(\\Phi(\\hat\\theta))(2\\pi)^{d/2}\\det\\bigl(-\\nabla\\nabla\\Phi|_{\\hat\\theta}\\bigr)^{-1/2}.$$\n2. Model $M_1$ ($d_1=2$), log-posterior\n$$\\Phi_1=\\ln C_1-\\tfrac12\\bigl[(A-A_p)^2/\\sigma_{A0}^2+(f-f_p)^2/\\sigma_{f0}^2\\bigr],$$\nso at the peak $\\exp(\\Phi_1)=C_1$, and\n$$-\\nabla\\nabla\\Phi_1=\\mathrm{diag}(1/\\sigma_{A0}^2,1/\\sigma_{f0}^2),\\quad\n\\det(-\\nabla\\nabla\\Phi_1)=\\tfrac1{\\sigma_{A0}^2\\sigma_{f0}^2}.$$\nHence\n$$Z_1=C_1\\,(2\\pi)^{2/2}\\bigl(\\sigma_{A0}\\sigma_{f0}\\bigr)=C_1\\,(2\\pi)\\,\\sigma_{A0}\\sigma_{f0}.$$\n3. Model $M_2$ ($d_2=4$), log-posterior\n$$\\Phi_2=\\ln C_2-\\tfrac12\\,\\vec y^T\\Sigma^{-1}\\vec y,\\quad \\exp(\\Phi_2)=C_2,$$\nand \n$$-\\nabla\\nabla\\Phi_2=\\Sigma^{-1},\\qquad \n\\det(-\\nabla\\nabla\\Phi_2)=\\det(\\Sigma^{-1})=1/\\det\\Sigma.$$\nThus\n$$Z_2=C_2\\,(2\\pi)^{4/2}\\,\\det(\\Sigma)^{1/2}\n=C_2\\,(2\\pi)^{2}\\,\\det(\\Sigma)^{1/2}.$$\n4. The covariance matrix factorizes into 2×2 blocks, giving\n$$\\det\\Sigma\n=\\bigl[\\sigma_A^4(1-\\rho_A^2)\\bigr]\\bigl[\\sigma_f^4(1-\\rho_f^2)\\bigr]\n=\\sigma_A^4\\sigma_f^4\\,(1-\\rho_A^2)(1-\\rho_f^2),$$\nso\n$$\\det(\\Sigma)^{1/2}\n=\\sigma_A^2\\sigma_f^2\\sqrt{(1-\\rho_A^2)(1-\\rho_f^2)}.$$\n5. The Bayes factor $K=Z_2/Z_1$ is therefore\n$$\nK=\\frac{C_2\\,(2\\pi)^{2}\\,\\sigma_A^2\\sigma_f^2\\sqrt{(1-\\rho_A^2)(1-\\rho_f^2)}}\n{C_1\\,(2\\pi)\\,\\sigma_{A0}\\sigma_{f0}}\n=\\frac{C_2}{C_1}\\,2\\pi\\,\\frac{\\sigma_A^2\\sigma_f^2}{\\sigma_{A0}\\sigma_{f0}}\n\\sqrt{(1-\\rho_A^2)(1-\\rho_f^2)}.\n$$", "answer": "$$\\boxed{\\frac{C_2}{C_1}\\,2\\pi\\,\\frac{\\sigma_A^2\\sigma_f^2}{\\sigma_{A0}\\,\\sigma_{f0}}\n\\sqrt{(1-\\rho_A^2)(1-\\rho_f^2)}}$$", "id": "217662"}]}