{"hands_on_practices": [{"introduction": "The overall morphology of an eclipsing binary light curve holds fundamental clues about the system's geometry. A key diagnostic is the shape of the eclipse minimum, which allows us to distinguish between partial and total/annular eclipses. This exercise demonstrates analytically why a partial eclipse results in a V-shaped, cusped minimum, characterized by a non-zero second derivative at its central point, providing a direct link between an observable feature and the underlying physical configuration of the stars [@problem_id:188358].", "problem": "Consider a detached eclipsing binary system consisting of two spherical stars with uniform surface brightness. Star 1 has radius $R_1$ and total luminosity $L_1$. Star 2 has radius $R_2$ and total luminosity $L_2$. The stars are in a circular orbit, which is observed from a large distance. Near the point of conjunction, the projected relative motion of the centers of the stars can be approximated as a straight line. The relative tangential velocity in the plane of the sky is $v$, and the impact parameter (the minimum projected separation between the centers) is $\\delta_0$.\n\nWe are interested in the primary eclipse, where the eclipsing star (star 2) passes in front of the eclipsed star (star 1). The eclipse is partial, which means that the minimum separation $\\delta_0$ satisfies the condition $|R_1 - R_2| < \\delta_0 < R_1 + R_2$. The observed light from the system is normalized to the out-of-eclipse flux, yielding the normalized light curve $l(t) = L_{\\text{obs}}(t) / (L_1 + L_2)$, where $t=0$ corresponds to the moment of mid-eclipse (minimum separation).\n\nThe shape of the light curve minimum provides crucial information about the nature of the eclipse. Specifically, the second time derivative of the light curve at mid-eclipse, $d^2l/dt^2|_{t=0}$, is non-zero for a partial eclipse but vanishes for a total or annular eclipse.\n\nDerive the analytical expression for the second time derivative of the normalized light curve, $d^2l/dt^2$, evaluated at mid-eclipse ($t=0$) for a partial eclipse. Express your answer in terms of the physical parameters of the system: $R_1$, $R_2$, $L_1$, $L_2$, $v$, and $\\delta_0$.", "solution": "We denote the overlap area of the two disks as $A(\\delta)$, where the center-to-center separation in projection is \n$$\\delta(t)=\\sqrt{\\delta_0^2+v^2t^2}\\,.$$\nThe normalized flux is \n$$l(t)=1-\\frac{L_1}{L_1+L_2}\\,\\frac{A(\\delta(t))}{\\pi R_1^2}\\,.$$\n\n1. Compute the second-time derivative at $t=0$.  Since $\\delta'(0)=0$ and \n$$\\delta''(0)=\\frac{v^2}{\\delta_0},$$\nwe have\n$$\\frac{d^2l}{dt^2}\\Big|_{t=0}\n=-\\frac{L_1}{L_1+L_2}\\,\\frac{1}{\\pi R_1^2}\\,\n\\frac{dA}{d\\delta}\\Big|_{\\delta_0}\\;\\delta''(0)\n=-\\frac{L_1}{L_1+L_2}\\,\\frac{1}{\\pi R_1^2}\\,\n\\frac{dA}{d\\delta}\\Big|_{\\delta_0}\\;\\frac{v^2}{\\delta_0}\\,.$$\n\n2. The overlap area for $|R_1-R_2|<\\delta<R_1+R_2$ is\n$$\nA(\\delta)\n=R_1^2\\cos^{-1}\\!\\biggl(\\frac{\\delta^2+R_1^2-R_2^2}{2\\delta R_1}\\biggr)\n+R_2^2\\cos^{-1}\\!\\biggl(\\frac{\\delta^2+R_2^2-R_1^2}{2\\delta R_2}\\biggr)\n-\\tfrac12\\sqrt{(\\!-\\delta+R_1+R_2)(\\delta+R_1-R_2)(\\delta-R_1+R_2)(\\delta+R_1+R_2)}\\,. \n$$\n\n3. One finds by direct differentiation that\n$$\n\\frac{dA}{d\\delta}\n=-\\frac{1}{\\delta}\\sqrt{\\bigl(\\delta^2-(R_1-R_2)^2\\bigr)\\bigl((R_1+R_2)^2-\\delta^2\\bigr)}\\,.\n$$\n\n4. Hence at $\\delta=\\delta_0$,\n$$\n\\frac{d^2l}{dt^2}\\Big|_{t=0}\n=\\frac{L_1}{L_1+L_2}\\,\\frac{v^2}{\\pi R_1^2\\,\\delta_0^2}\n\\sqrt{\\bigl(\\delta_0^2-(R_1-R_2)^2\\bigr)\\bigl((R_1+R_2)^2-\\delta_0^2\\bigr)}\\,. \n$$", "answer": "$$\\boxed{\\frac{L_1\\,v^2}{(L_1+L_2)\\,\\pi\\,R_1^2\\,\\delta_0^2}\\,\n\\sqrt{\\bigl(\\delta_0^2-(R_1-R_2)^2\\bigr)\\bigl((R_1+R_2)^2-\\delta_0^2\\bigr)}}$$", "id": "188358"}, {"introduction": "Moving beyond simple geometric models, a more faithful representation of a star must account for the fact that its surface brightness is not uniform, an effect known as limb-darkening. This practice delves into the impact of limb-darkening on the shape of the light curve, focusing on the moment of second contact in a central eclipse. By deriving the second time derivative of the light curve at this specific phase, you will explore how this physical effect quantitatively modifies the light curve's curvature and provides a means to constrain the brightness profile of the eclipsed star [@problem_id:188140].", "problem": "Consider an eclipsing binary system consisting of two spherical stars, Star 1 and Star 2, with radii $R_1$ and $R_2$ (where $R_2 < R_1$), respectively. The stars are in a circular orbit which is observed perfectly edge-on ($i=90^\\circ$), leading to a central primary eclipse (the smaller star, Star 2, transits the larger star, Star 1). The relative transverse velocity between the centers of the two stars in the plane of the sky is constant with magnitude $v$.\n\nThe total unocculted luminosity of the system is $L_0$. The total luminosity emitted by Star 1 alone is $L_1$. The surface brightness of Star 1 is not uniform but follows a simplified polynomial limb-darkening law given by:\n$$\nI_1(r) = I_c \\left(1 - \\gamma \\frac{r^2}{R_1^2}\\right)\n$$\nwhere $r$ is the radial distance from the center of Star 1's disk, $I_c$ is the specific intensity at the center of the disk, and $\\gamma$ is a given dimensionless limb-darkening coefficient ($0 \\le \\gamma \\le 1$). The normalized light curve of the system, $l(t)$, is defined as the total observed luminosity at time $t$, $L(t)$, divided by the unocculted luminosity, $L_0$.\n\nDerive a rigorous, closed-form expression for the second time derivative of the normalized light curve, $\\frac{d^2 l}{dt^2}$, evaluated at the precise moment of second contact. Second contact is the instant when the transit becomes total, i.e., when the disk of Star 2 is fully projected onto the disk of Star 1 for the first time. Express your final answer in terms of $R_1$, $R_2$, $v$, $L_0$, $L_1$, and $\\gamma$.", "solution": "1. The observed flux deficit (blocked flux) at time $t$ is\n$$F(t)=\\iint_{\\rm overlap}I_1(r)\\,dA\n=I_c\\Biggl[\\iint_{\\rm overlap}1\\,dA-\\frac{\\gamma}{R_1^2}\\iint_{\\rm overlap}r^2\\,dA\\Biggr].$$\nAfter second contact, Star 2 lies entirely within Star 1, so the overlap region is a circle of radius $R_2$ whose center-to-center separation is \n$$d(t)=R_1-R_2-v\\,(t-t_2),$$\nwith $t_2$ the time of second contact.  Thus\n$$\\iint_{\\rm overlap}1\\,dA=\\pi R_2^2,\\quad\n\\iint_{\\rm overlap}r^2\\,dA=\\pi\\Bigl(\\tfrac{R_2^4}{2}+d^2R_2^2\\Bigr)$$\n(via the parallel-axis theorem).  Hence\n$$F(t)=I_c\\pi R_2^2-\\frac{\\gamma I_c\\pi R_2^2}{R_1^2}\\Bigl(\\tfrac{R_2^2}{2}+d^2\\Bigr).$$\n2. Differentiate twice w.r.t. $t$.  Since $d(t)=d_0-v(t-t_2)$ with $d_0=R_1-R_2$,\n$$\\frac{dF}{dt}\n=-\\frac{\\gamma I_c\\pi R_2^2}{R_1^2}\\,2d\\,\\frac{dd}{dt}\n=2\\frac{\\gamma I_c\\pi R_2^2}{R_1^2}\\,v\\,d(t),$$\n$$\\frac{d^2F}{dt^2}\n=2\\frac{\\gamma I_c\\pi R_2^2}{R_1^2}\\,v\\,\\frac{dd}{dt}\n=-2\\frac{\\gamma I_c\\pi R_2^2}{R_1^2}\\,v^2.$$\n3. The normalized light curve is $l(t)=1-F(t)/L_0$, so\n$$\\frac{d^2l}{dt^2}=-\\frac{1}{L_0}\\frac{d^2F}{dt^2}\n=\\frac{2\\gamma I_c\\pi R_2^2\\,v^2}{R_1^2\\,L_0}.$$\n4. Finally express $I_c$ via $L_1=\\pi I_cR_1^2(1-\\gamma/2)$:\n$$I_c=\\frac{L_1}{\\pi R_1^2(1-\\gamma/2)}\\;\\;\\Longrightarrow\\;\\;\n\\frac{d^2l}{dt^2}\\Big|_{t_2}\n=\\frac{2\\gamma L_1R_2^2v^2}{(1-\\gamma/2)\\,R_1^4\\,L_0}.$$", "answer": "$$\\boxed{\\frac{2\\gamma L_1 R_2^2 v^2}{\\bigl(1-\\tfrac{\\gamma}{2}\\bigr)\\,R_1^4 L_0}}$$", "id": "188140"}, {"introduction": "Modern analysis of high-precision photometry often confronts the challenge of correlated noise, where sources like stellar activity or instrumental systematics introduce time-dependent variations that are not captured by a simple physical model plus white noise. This advanced practice introduces the Gaussian Process (GP), a powerful statistical framework for modeling such complex noise structures. You will derive a key component required for Bayesian inference with GPs—the gradient of the log-likelihood—which is essential for sophisticated sampling algorithms like Hamiltonian Monte Carlo (HMC) that are used to characterize the system's parameters and the noise properties simultaneously [@problem_id:188212].", "problem": "In the analysis of light curves from eclipsing binary systems, it is common to model the residual signal, after subtracting a primary physical model, using a Gaussian Process (GP). This approach accounts for time-correlated noise arising from sources such as stellar activity (e.g., starspots, pulsations) or instrumental effects.\n\nConsider a set of $N$ light curve residuals, represented by the data vector $\\mathbf{r} \\in \\mathbb{R}^N$, observed at times $\\{t_i\\}_{i=1}^N$. We model these residuals as a draw from a zero-mean multivariate Gaussian distribution, $\\mathbf{r} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{K})$, where $\\mathbf{K}$ is the $N \\times N$ covariance matrix.\n\nThe covariance matrix $\\mathbf{K}$ is constructed from a kernel function. A common choice is the sum of a squared-exponential kernel to model the correlated noise and a white noise term for uncorrelated jitter. The matrix elements are given by:\n$$\nK_{ij} = \\alpha^2 \\exp\\left(-\\frac{(t_i - t_j)^2}{2\\lambda^2}\\right) + \\sigma_n^2 \\delta_{ij}\n$$\nHere, $\\alpha$ is the amplitude of the correlated noise, $\\lambda$ is its characteristic length-scale, $\\sigma_n$ is the standard deviation of the white noise, and $\\delta_{ij}$ is the Kronecker delta. We can decompose the covariance matrix as $\\mathbf{K} = \\mathbf{K}_{SE} + \\sigma_n^2 \\mathbf{I}$, where $\\mathbf{K}_{SE}$ is the matrix corresponding to the squared-exponential kernel part and $\\mathbf{I}$ is the $N \\times N$ identity matrix.\n\nThe log-likelihood of observing the data $\\mathbf{r}$ given the hyperparameters $\\theta = (\\alpha, \\lambda, \\sigma_n)$ is:\n$$\n\\ln P(\\mathbf{r} | \\theta) = -\\frac{1}{2} \\mathbf{r}^T \\mathbf{K}^{-1} \\mathbf{r} - \\frac{1}{2} \\ln \\det(\\mathbf{K}) - \\frac{N}{2} \\ln(2\\pi)\n$$\nTo infer the posterior distribution of the hyperparameters using Hamiltonian Monte Carlo (HMC), one must compute the gradient of the log-posterior with respect to these hyperparameters. This gradient provides the \"force\" that guides the sampler's trajectory. Assuming flat (uninformative) priors, the gradient of the log-posterior is identical to the gradient of the log-likelihood.\n\nDerive the analytical expression for the partial derivative of the log-likelihood with respect to the amplitude hyperparameter, $\\alpha$. Express your final answer in terms of $\\alpha$, the data vector $\\mathbf{r}$, the full covariance matrix $\\mathbf{K}$ (and its inverse), and the squared-exponential component of the covariance matrix, $\\mathbf{K}_{SE}$.", "solution": "We have \n$$\\ln P(\\mathbf r|\\theta)=-\\tfrac12\\,\\mathbf r^T\\mathbf K^{-1}\\mathbf r-\\tfrac12\\ln\\det\\mathbf K-\\tfrac N2\\ln(2\\pi)\\,.$$\nUsing the matrix derivative identities\n$$\\frac{\\partial}{\\partial\\alpha}\\bigl(-\\tfrac12\\,\\mathbf r^T\\mathbf K^{-1}\\mathbf r\\bigr)\n=+\\tfrac12\\,\\mathbf r^T\\mathbf K^{-1}\\,\\frac{\\partial\\mathbf K}{\\partial\\alpha}\\,\\mathbf K^{-1}\\,\\mathbf r,$$\n$$\\frac{\\partial}{\\partial\\alpha}\\bigl(-\\tfrac12\\ln\\det\\mathbf K\\bigr)\n=-\\tfrac12\\,\\mathrm{tr}\\!\\Bigl(\\mathbf K^{-1}\\frac{\\partial\\mathbf K}{\\partial\\alpha}\\Bigr)\\,.$$\nSince \n$$\\mathbf K=\\mathbf K_{SE}+\\sigma_n^2\\mathbf I,\\quad\n\\mathbf K_{SE}=\\alpha^2\\mathbf E,\\quad \\mathbf E_{ij}=\\exp\\!\\bigl(-\\tfrac{(t_i-t_j)^2}{2\\lambda^2}\\bigr),$$\nwe get\n$$\\frac{\\partial\\mathbf K}{\\partial\\alpha}\n=\\frac{\\partial}{\\partial\\alpha}(\\alpha^2\\mathbf E)=2\\alpha\\,\\mathbf E\n=\\frac{2}{\\alpha}\\,\\mathbf K_{SE}\\,.$$\nCombining,\n$$\\frac{\\partial\\ln P}{\\partial\\alpha}\n=\\tfrac12\\,\\mathbf r^T\\mathbf K^{-1}\\Bigl(\\tfrac{2}{\\alpha}\\mathbf K_{SE}\\Bigr)\\mathbf K^{-1}\\mathbf r\n-\\tfrac12\\,\\mathrm{tr}\\!\\Bigl(\\mathbf K^{-1}\\tfrac{2}{\\alpha}\\mathbf K_{SE}\\Bigr)\n=\\frac{1}{\\alpha}\\Bigl(\\mathbf r^T\\mathbf K^{-1}\\mathbf K_{SE}\\mathbf K^{-1}\\mathbf r\n-\\mathrm{tr}(\\mathbf K^{-1}\\mathbf K_{SE})\\Bigr)\\,.$$", "answer": "$$\\boxed{\\frac{1}{\\alpha}\\Bigl(\\mathbf{r}^T\\mathbf{K}^{-1}\\mathbf{K}_{SE}\\mathbf{K}^{-1}\\mathbf{r}-\\mathrm{tr}\\bigl(\\mathbf{K}^{-1}\\mathbf{K}_{SE}\\bigr)\\Bigr)}$$", "id": "188212"}]}