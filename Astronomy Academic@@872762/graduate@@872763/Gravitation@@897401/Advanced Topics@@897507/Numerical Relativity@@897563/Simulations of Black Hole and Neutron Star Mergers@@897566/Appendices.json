{"hands_on_practices": [{"introduction": "Simulating black holes presents a fundamental challenge: the physical singularity at the center. The \"puncture\" framework in numerical relativity elegantly sidesteps this by excising the singularity and evolving the surrounding spacetime. This exercise explores the \"trumpet\" geometry, a type of spatial slicing that causes the proper radial distance to the puncture to become infinite, effectively keeping the singularity off the computational grid. By calculating the proper distance using a specific conformal factor $\\psi$, you will gain a tangible understanding of how coordinate choices in the 3+1 formalism can dramatically warp the geometry to make simulations feasible [@problem_id:906998].", "problem": "In the 3+1 decomposition of spacetime, a common technique for numerical simulations of black holes is to use a conformally flat spatial metric on each time slice. For a non-rotating black hole of mass $M$, the spatial geometry can be described by a line element in spherical-like coordinates $(r, \\theta, \\phi)$:\n$$ dl^2 = \\psi^4(r) (dr^2 + r^2 d\\Omega^2) $$\nwhere $d\\Omega^2 = d\\theta^2 + \\sin^2\\theta d\\phi^2$, and $\\psi(r)$ is the conformal factor. The choice of $\\psi(r)$ corresponds to a specific slicing of the Schwarzschild spacetime. Slicings that avoid the central singularity by pushing it to an infinite proper distance are known as \"trumpet\" slices.\n\nThe proper radial distance $L$ between two spheres at coordinate radii $r_1$ and $r_2$ is given by the integral of the proper distance element along a radial path:\n$$ L = \\int_{r_1}^{r_2} \\psi^2(r) dr $$\n\nConsider a hypothetical trumpet-like slice of a spacetime containing a central mass $M$, for which the square of the conformal factor is given by\n$$ \\psi^2(r) = 1 + \\frac{M}{r} + \\frac{\\alpha M^2}{(r+\\beta M)^2} $$\nwhere $\\alpha$ and $\\beta$ are given positive dimensionless constants.\n\nCalculate the proper radial distance $L$ between the sphere at coordinate radius $r_1 = M$ and the sphere at $r_2 = 2M$. Express your answer as a closed-form expression in terms of the mass $M$ and the constants $\\alpha$ and $\\beta$.", "solution": "1. Write the integral as a sum:\n$$L=\\int_{M}^{2M}\\Bigl(1+\\frac{M}{r}+\\frac{\\alpha M^2}{(r+\\beta M)^2}\\Bigr)dr\n=\\int_{M}^{2M}dr+\\int_{M}^{2M}\\frac{M}{r}dr+\\int_{M}^{2M}\\frac{\\alpha M^2}{(r+\\beta M)^2}dr.$$\n\n2. Integrate term by term:\n$$\\int dr=r,\\quad\n\\int\\frac{M}{r}dr=M\\ln r,\\quad\n\\int\\frac{\\alpha M^2}{(r+\\beta M)^2}dr\n=-\\frac{\\alpha M^2}{r+\\beta M}.$$\n\n3. Combine and evaluate from $r=M$ to $r=2M$:\n$$L=\\Bigl[r+M\\ln r-\\frac{\\alpha M^2}{r+\\beta M}\\Bigr]_{M}^{2M}.$$\nAt $r=2M$:\n$$2M+M\\ln(2M)-\\frac{\\alpha M^2}{2M+\\beta M}\n=2M+M(\\ln2+\\ln M)-\\frac{\\alpha M}{2+\\beta}.$$\nAt $r=M$:\n$$M+M\\ln M-\\frac{\\alpha M^2}{M+\\beta M}\n=M+M\\ln M-\\frac{\\alpha M}{1+\\beta}.$$\nSubtracting lower from upper:\n$$L=\\bigl(2M+M\\ln2+M\\ln M-\\frac{\\alpha M}{2+\\beta}\\bigr)\n-\\bigl(M+M\\ln M-\\frac{\\alpha M}{1+\\beta}\\bigr)$$\n$$=M+M\\ln2\n+\\alpha M\\Bigl(\\frac{1}{1+\\beta}-\\frac{1}{2+\\beta}\\Bigr)\n=M\\Bigl(1+\\ln2+\\frac{\\alpha}{(1+\\beta)(2+\\beta)}\\Bigr).$$", "answer": "$$\\boxed{M\\Bigl(1+\\ln2+\\frac{\\alpha}{(1+\\beta)(2+\\beta)}\\Bigr)}$$", "id": "906998"}, {"introduction": "The merger of neutron stars or the accretion of matter onto black holes inevitably creates shock wavesâ€”sharp discontinuities in fluid properties. Accurately capturing these shocks without introducing spurious numerical oscillations is paramount, a task for which high-resolution shock-capturing schemes are designed. This practice delves into the heart of the popular Weighted Essentially Non-Oscillatory (WENO) method by examining its behavior at a perfect shock front, allowing you to calculate the scheme's non-linear weights and revealing the elegant mechanism that automatically adjusts the scheme's stencil to ensure a stable solution [@problem_id:906993].", "problem": "In the numerical simulation of relativistic astrophysical phenomena, such as black hole or neutron star mergers, high-order, shock-capturing numerical methods are essential for accurately evolving the equations of general relativistic hydrodynamics. The Weighted Essentially Non-Oscillatory (WENO) reconstruction is a widely used technique to achieve high-order accuracy in smooth regions of the solution while avoiding spurious oscillations near discontinuities like shock fronts.\n\nThis problem concerns the 5th-order accurate WENO scheme (WENO5). Consider a uniform one-dimensional grid with cell spacing $\\Delta x$. The cell-averaged values of a scalar fluid variable $q$ at cell $i$ are denoted by $q_i$. The WENO5 scheme reconstructs the value of $q$ at the interface $x_{i+1/2}$ between cells $i$ and $i+1$ by combining three 3rd-order polynomial reconstructions, each based on a different 3-cell sub-stencil: $S_0 = \\{q_{i-2}, q_{i-1}, q_i\\}$, $S_1 = \\{q_{i-1}, q_i, q_{i+1}\\}$, and $S_2 = \\{q_i, q_{i+1}, q_{i+2}\\}$.\n\nThe reconstructed value is given by a weighted average:\n$$\nq_{i+1/2} = w_0 \\hat{q}_0 + w_1 \\hat{q}_1 + w_2 \\hat{q}_2\n$$\nwhere $\\hat{q}_k$ are the values obtained from the $k$-th sub-stencil's reconstruction polynomial.\nThe non-linear weights $w_k$ are the core of the WENO method. They are computed as:\n$$\nw_k = \\frac{\\alpha_k}{\\sum_{j=0}^{2} \\alpha_j} \\quad , \\quad \\alpha_k = \\frac{d_k}{(\\epsilon + \\beta_k)^p}\n$$\nHere, $d_k$ are the optimal weights that yield 5th-order accuracy for smooth solutions. For the interface $x_{i+1/2}$, these are $d_0 = 1/10$, $d_1 = 6/10$, and $d_2 = 3/10$. The parameter $p$ is typically set to $p=2$. The small constant $\\epsilon > 0$ prevents division by zero. The quantities $\\beta_k$ are the smoothness indicators for each sub-stencil, defined as:\n$$\n\\begin{aligned}\n\\beta_0 &= \\frac{13}{12}(q_{i-2} - 2q_{i-1} + q_i)^2 + \\frac{1}{4}(q_{i-2} - 4q_{i-1} + 3q_i)^2 \\\\\n\\beta_1 &= \\frac{13}{12}(q_{i-1} - 2q_i + q_{i+1})^2 + \\frac{1}{4}(q_{i-1} - q_{i+1})^2 \\\\\n\\beta_2 &= \\frac{13}{12}(q_i - 2q_{i+1} + q_{i+2})^2 + \\frac{1}{4}(3q_i - 4q_{i+1} + q_{i+2})^2\n\\end{aligned}\n$$\nThese indicators measure the oscillatory content of the solution on each stencil. In smooth regions, $\\beta_k$ are small and $w_k \\approx d_k$. Near a discontinuity, the $\\beta_k$ for stencils crossing the discontinuity become large, and their corresponding weights $w_k$ become very small.\n\n**Problem:**\nConsider a 5-cell stencil $\\{i-2, i-1, i, i+1, i+2\\}$ describing the profile of the rest-mass density $\\rho$ of a relativistic fluid across a stationary shock front located at the interface $x_{i+1/2}$. The cell-averaged values are given by:\n$$\n\\rho_{i-2} = \\rho_L, \\quad \\rho_{i-1} = \\rho_L, \\quad \\rho_i = \\rho_L, \\quad \\rho_{i+1} = \\rho_R, \\quad \\rho_{i+2} = \\rho_R\n$$\nwhere $\\rho_L$ and $\\rho_R$ are the constant density states to the left and right of the shock, respectively.\n\nUsing the WENO5 formulation with $p=2$, determine the non-linear weight $w_1$ for the reconstruction at the interface $x_{i+1/2}$. Your final answer should be a symbolic expression in terms of $\\rho_L$, $\\rho_R$, and the parameter $\\epsilon$.", "solution": "1. Define $\\Delta\\rho=\\rho_R-\\rho_L$.\n2. Compute smoothness indicators:\n   $$\n   \\beta_0=0,\\quad\n   \\beta_1=\\frac{4}{3}\\,\\Delta\\rho^2,\\quad\n   \\beta_2=\\frac{10}{3}\\,\\Delta\\rho^2.\n   $$\n3. Compute $\\alpha_k$:\n   $$\n   \\alpha_0=\\frac{1/10}{(\\epsilon+0)^2}\n             =\\frac{1}{10\\,\\epsilon^2},\\quad\n   \\alpha_1=\\frac{6/10}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}\n             =\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2},\n   $$\n   $$\n   \\alpha_2=\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}\\Delta\\rho^2\\bigr)^2}.\n   $$\n4. Form the nonlinear weight $w_1$:\n   $$\n   w_1\n   =\\frac{\\alpha_1}{\\alpha_0+\\alpha_1+\\alpha_2}\n   =\\frac{\\displaystyle \\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}}\n         {\\displaystyle \\frac{1}{10\\,\\epsilon^2}\n          +\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}\\Delta\\rho^2\\bigr)^2}\n          +\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}\\Delta\\rho^2\\bigr)^2}}.\n   $$\n5. Substitute back $\\Delta\\rho=\\rho_R-\\rho_L$.", "answer": "$$\\boxed{\\frac{\\displaystyle \\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}}\n{\\displaystyle \\frac{1}{10\\,\\epsilon^2}\n+\\frac{3/5}{\\bigl(\\epsilon+\\tfrac{4}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}\n+\\frac{3/10}{\\bigl(\\epsilon+\\tfrac{10}{3}(\\rho_R-\\rho_L)^2\\bigr)^2}}}$$", "id": "906993"}, {"introduction": "High-order finite difference schemes, while excellent for capturing smooth features of a solution, are prone to numerical instabilities, particularly the growth of high-frequency grid-scale noise. To prevent this unphysical noise from contaminating and ultimately crashing a simulation, a small amount of artificial dissipation is often added. This exercise focuses on the widely-used Kreiss-Oliger dissipation, a technique designed to surgically damp the most troublesome high-frequency modes while leaving the physical, long-wavelength solution largely unaffected. By analyzing the damping rate for the highest-frequency mode on the grid, you will quantify the direct stabilizing effect of this essential numerical tool [@problem_id:906946].", "problem": "In numerical simulations of fluid dynamics and gravitational fields, such as those modeling black hole or neutron star mergers, high-order finite difference schemes are often employed to solve systems of hyperbolic partial differential equations. To control high-frequency numerical noise without corrupting the physically relevant parts of the solution, artificial dissipation is commonly added. A popular choice is the Kreiss-Oliger dissipation.\n\nConsider the one-dimensional linear advection equation for a scalar field $u(x,t)$:\n$$ \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0 $$\nwhere $c$ is a constant wave speed. This equation is discretized on a uniform spatial grid with points $x_j = j \\Delta x$ for integer $j$, leading to a system of ordinary differential equations in time for the grid functions $u_j(t) \\equiv u(x_j, t)$. This is the method of lines approach. The semi-discretized equation is:\n$$ \\frac{du_j(t)}{dt} = \\mathcal{L}[u]_j $$\nThe spatial operator $\\mathcal{L}$ consists of a 4th-order accurate centered difference approximation for the advection term and a 6th-order Kreiss-Oliger dissipation term. The full operator is given by:\n$$ \\mathcal{L}[u]_j = -c \\left( \\frac{-u_{j+2} + 8u_{j+1} - 8u_{j-1} + u_{j-2}}{12\\Delta x} \\right) + \\frac{\\sigma_K}{\\Delta x} \\left( u_{j+3} - 6u_{j+2} + 15u_{j+1} - 20u_j + 15u_{j-1} - 6u_{j-2} + u_{j-3} \\right) $$\nHere, $\\sigma_K$ is a positive dimensionless coefficient that controls the strength of the dissipation. The dissipation operator, when applied to a sufficiently smooth function, is a consistent approximation to $\\sigma_K (\\Delta x)^5 \\partial_x^6 u$.\n\nYour task is to determine the damping rate of the highest-frequency mode that can be represented on this spatial grid. The damping rate $\\Gamma$ is defined from the complex growth rate $\\omega$ of a mode, where $u_j(t) \\propto e^{\\omega t}$, as $\\Gamma = -\\text{Re}(\\omega)$.\n\nProvide the expression for the damping rate of this mode in terms of the parameters $c$, $\\Delta x$, and $\\sigma_K$.", "solution": "1. Fourier ansatz: $u_j(t)=e^{i k j\\Delta x+\\omega t}$.\n2. Dissipation symbol: $S(\\phi)=\\sum_{m=-3}^3 a_m e^{i m\\phi}$, with $\\phi=k\\Delta x$ and coefficients $a_{\\pm 3}=1, a_{\\pm 2}=-6, a_{\\pm 1}=15, a_0=-20$.\n3. For $\\phi=\\pi$:\n   $$S(\\pi)=e^{i3\\pi}-6e^{i2\\pi}+15e^{i\\pi}-20+15e^{-i\\pi}-6e^{-i2\\pi}+e^{-i3\\pi} = -1-6-15-20-15-6-1=-64.$$\n4. Dissipation contribution to $\\omega$: $\\omega_{dis}=(\\sigma_K/\\Delta x)S(\\pi)=-64\\sigma_K/\\Delta x$.\n5. Advection contribution vanishes at $\\phi=\\pi$.\n6. Total $\\omega=-64\\sigma_K/\\Delta x \\Rightarrow \\Gamma=-\\text{Re}(\\omega)=64\\sigma_K/\\Delta x$.", "answer": "$$\\boxed{\\frac{64\\sigma_K}{\\Delta x}}$$", "id": "906946"}]}