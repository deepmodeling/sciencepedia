{"hands_on_practices": [{"introduction": "This practice tackles a classic challenge in astronomy: determining the mass of a binary system that is too distant to be resolved into two distinct stars. You will work through a fundamental derivation that combines two different types of observation: astrometry, which tracks the motion of the system's \"center of light\" (photocenter), and spectroscopy, which provides the mass ratio. This exercise [@problem_id:236867] demonstrates how astronomers ingeniously piece together different clues to measure one of the most fundamental properties of stars, their mass, even when they cannot see the components directly.", "problem": "An unresolved binary star system is observed as a single-line spectroscopic binary (SB1) and also as an astrometric binary. Due to the system being unresolved, astrometric measurements track the orbit of the system's photocenter (the center of light) about the barycenter, not the orbit of the primary star itself.\n\nAssume the two stars, with masses $M_1$ and $M_2$ and luminosities $L_1$ and $L_2$, move in a circular orbit with period $P$. The system is at a distance corresponding to a parallax $\\varpi$. The angular semi-major axis of the photocenter's orbit has been measured to be $\\alpha_{ph}$.\n\nDefine the mass ratio as $q = M_2/M_1$ and the luminosity ratio as $\\beta = L_2/L_1$. For the purpose of this derivation, assume $q > \\beta$. The universal gravitational constant is $G$.\n\nDerive a closed-form expression for the total mass of the system, $M_T = M_1 + M_2$, in terms of the given parameters: $P, \\varpi, \\alpha_{ph}, q, \\beta$, and the constant $G$.", "solution": "The goal is to derive an expression for the total mass $M_T = M_1 + M_2$ of the binary system. We begin with Kepler's Third Law, which relates the total mass to the orbital period $P$ and the semi-major axis of the relative orbit, $a$.\n\nKepler's Third Law is given by:\n$$\nM_T = M_1 + M_2 = \\frac{4\\pi^2 a^3}{G P^2}\n$$\nHere, $a$ is the semi-major axis of the relative orbit of the two stars ($\\vec{r} = \\vec{r}_1 - \\vec{r}_2$). Our task is to express $a$ in terms of the given observable and system parameters.\n\nThe semi-major axis $a$ can be expressed as the sum of the semi-major axes of the individual orbits of the stars around the barycenter, $a_1$ and $a_2$:\n$$\na = a_1 + a_2\n$$\nThe position of the barycenter is defined such that $M_1 \\vec{r}_1 + M_2 \\vec{r}_2 = 0$. For the semi-major axes of the orbits, this implies:\n$$\nM_1 a_1 = M_2 a_2\n$$\nUsing the mass ratio $q = M_2/M_1$, we can write $a_2$ in terms of $a_1$:\n$$\na_2 = \\frac{M_1}{M_2} a_1 = \\frac{1}{q} a_1\n$$\nSubstituting this into the expression for the total semi-major axis $a$:\n$$\na = a_1 + \\frac{1}{q} a_1 = a_1 \\left(1 + \\frac{1}{q}\\right) = a_1 \\frac{q+1}{q}\n$$\nNow, we need to relate $a_1$ to the observed quantity, $\\alpha_{ph}$. The astrometric measurements give the semi-major axis of the photocenter's orbit, $a_{ph}$. This physical size is related to the angular size $\\alpha_{ph}$ and the parallax $\\varpi$ by:\n$$\na_{ph} = \\frac{\\alpha_{ph}}{\\varpi}\n$$\nThe position of the photocenter, $\\vec{r}_{ph}$, relative to the barycenter is the luminosity-weighted average of the positions of the two stars:\n$$\n\\vec{r}_{ph} = \\frac{L_1 \\vec{r}_1 + L_2 \\vec{r}_2}{L_1 + L_2}\n$$\nWe can express $\\vec{r}_2$ in terms of $\\vec{r}_1$ using the barycenter definition: $\\vec{r}_2 = -(M_1/M_2)\\vec{r}_1 = -(1/q)\\vec{r}_1$. Substituting this into the photocenter equation:\n$$\n\\vec{r}_{ph} = \\frac{L_1 \\vec{r}_1 + L_2 (-\\frac{1}{q}\\vec{r}_1)}{L_1 + L_2} = \\vec{r}_1 \\left( \\frac{L_1 - L_2/q}{L_1 + L_2} \\right)\n$$\nWe can factor out $L_1$ from the term in the parenthesis and use the luminosity ratio $\\beta = L_2/L_1$:\n$$\n\\vec{r}_{ph} = \\vec{r}_1 \\left( \\frac{L_1(1 - (L_2/L_1)/q)}{L_1(1 + L_2/L_1)} \\right) = \\vec{r}_1 \\left( \\frac{1 - \\beta/q}{1 + \\beta} \\right)\n$$\nThis relation holds for the semi-major axes as well. Since we assume $q > \\beta$, the term $(1 - \\beta/q)$ is positive.\n$$\na_{ph} = a_1 \\frac{1 - \\beta/q}{1 + \\beta} = a_1 \\frac{q - \\beta}{q(1 + \\beta)}\n$$\nWe can now solve for $a_1$ in terms of $a_{ph}$:\n$$\na_1 = a_{ph} \\frac{q(1 + \\beta)}{q - \\beta}\n$$\nSubstitute $a_{ph} = \\alpha_{ph}/\\varpi$:\n$$\na_1 = \\frac{\\alpha_{ph}}{\\varpi} \\frac{q(1 + \\beta)}{q - \\beta}\n$$\nNow we substitute this expression for $a_1$ into our equation for the total semi-major axis, $a = a_1 \\frac{q+1}{q}$:\n$$\na = \\left( \\frac{\\alpha_{ph}}{\\varpi} \\frac{q(1 + \\beta)}{q - \\beta} \\right) \\left( \\frac{q+1}{q} \\right) = \\frac{\\alpha_{ph}}{\\varpi} \\frac{(1 + \\beta)(1 + q)}{q - \\beta}\n$$\nFinally, we substitute this complete expression for $a$ into Kepler's Third Law to find the total mass $M_T$:\n$$\nM_T = \\frac{4\\pi^2}{G P^2} a^3 = \\frac{4\\pi^2}{G P^2} \\left( \\frac{\\alpha_{ph}}{\\varpi} \\frac{(1 + \\beta)(1 + q)}{q - \\beta} \\right)^3\n$$\nThis simplifies to the final expression for the total mass:\n$$\nM_T = \\frac{4\\pi^2 \\alpha_{ph}^3}{G P^2 \\varpi^3} \\left( \\frac{(1 + \\beta)(1 + q)}{q - \\beta} \\right)^3\n$$", "answer": "$$\n\\boxed{\\frac{4\\pi^2 \\alpha_{ph}^3}{G P^2 \\varpi^3} \\left( \\frac{(1 + \\beta)(1 + q)}{q - \\beta} \\right)^3}\n$$", "id": "236867"}, {"introduction": "A central task in studying visual binaries is to fit an orbital model to a series of position measurements, but a fitted parameter is only as good as its uncertainty. This practice delves into the statistical heart of orbital analysis by asking you to derive the covariance matrix for the Thiele-Innes constants, a set of parameters that linearize the orbital fitting problem. By working through this exercise [@problem_id:236830], you will gain a practical understanding of how observational errors propagate into the uncertainties of the derived orbital elements, a crucial skill for any quantitative analysis.", "problem": "The apparent orbit of a visual binary star system can be described by projecting the true orbit onto the plane of the sky. The rectangular coordinates of the secondary star relative to the primary, $(x(t), y(t))$, are given as a function of time $t$. For an orbit where the non-linear parameters (period $P$, time of periastron passage $T$, and eccentricity $e$) are known, the position coordinates can be expressed linearly in terms of four parameters known as the Thiele-Innes constants, denoted $A, B, F, G$. The model is:\n$$\nx(t) = A X(t) + F Y(t) \\\\\ny(t) = B X(t) + G Y(t)\n$$\nHere, $X(t) = \\cos E(t) - e$ and $Y(t) = \\sqrt{1-e^2} \\sin E(t)$ are orbital basis functions, where $E(t)$ is the eccentric anomaly. For a set of $N$ observations at times $t_k$, these basis functions take known values $X_k = X(t_k)$ and $Y_k = Y(t_k)$.\n\nConsider a set of $N$ astrometric observations $(x_k, y_k)$ taken at times $t_k$ for $k=1, \\dots, N$. The measurement errors associated with each coordinate $x_k$ and $y_k$ are independent and identically distributed, following a Gaussian distribution with zero mean and a constant, known variance $\\sigma^2$. The errors are also independent from one observation time to another.\n\nThe Thiele-Innes constants are estimated by minimizing the sum of squared residuals (linear least squares). The uncertainty in these estimated parameters is captured by their covariance matrix.\n\nYour task is to derive the $4 \\times 4$ covariance matrix, $C_{\\mathbf{c}}$, for the vector of estimated parameters $\\mathbf{c} = (A, B, F, G)^T$. Express your answer in terms of the measurement variance $\\sigma^2$ and the following sums over the known basis functions:\n$$\nS_{XX} \\equiv \\sum_{k=1}^{N} X_k^2, \\quad S_{YY} \\equiv \\sum_{k=1}^{N} Y_k^2, \\quad S_{XY} \\equiv \\sum_{k=1}^{N} X_k Y_k\n$$", "solution": "The model can be written in matrix form for the two coordinates as\n$$\n\\begin{pmatrix}x_k\\\\y_k\\end{pmatrix}\n=\n\\underbrace{\\begin{pmatrix}X_k&0&Y_k&0\\\\0&X_k&0&Y_k\\end{pmatrix}}_{=\\;H_k}\n\\begin{pmatrix}A\\\\B\\\\F\\\\G\\end{pmatrix}\n+\n\\begin{pmatrix}\\varepsilon_{x,k}\\\\\\varepsilon_{y,k}\\end{pmatrix},\n\\quad\n\\mathrm{Var}(\\varepsilon_{x,k})=\\mathrm{Var}(\\varepsilon_{y,k})=\\sigma^2.\n$$\nStacking over $k=1\\ldots N$ gives the normal-equations matrix\n$$\nH^T H\n=\\begin{pmatrix}\n\\sum X_k^2&0&\\sum X_kY_k&0\\\\\n0&\\sum X_k^2&0&\\sum X_kY_k\\\\\n\\sum X_kY_k&0&\\sum Y_k^2&0\\\\\n0&\\sum X_kY_k&0&\\sum Y_k^2\n\\end{pmatrix}\n=\\begin{pmatrix}\nS_{XX}&0&S_{XY}&0\\\\\n0&S_{XX}&0&S_{XY}\\\\\nS_{XY}&0&S_{YY}&0\\\\\n0&S_{XY}&0&S_{YY}\n\\end{pmatrix}.\n$$\nSince the x- and y-fits are independent, the covariance of \n$\\mathbf c=(A,B,F,G)^T$ is\n$$\nC_{\\mathbf c}\n=\\sigma^2\\,(H^TH)^{-1}\n=\\sigma^2\\;\\mathrm{blockdiag}\\!\\bigl(M^{-1},M^{-1}\\bigr),\n\\quad\nM=\\begin{pmatrix}S_{XX}&S_{XY}\\\\S_{XY}&S_{YY}\\end{pmatrix}.\n$$\nFor the $2\\times2$ matrix $M$ one has\n$$\nM^{-1}\n=\\frac1{S_{XX}S_{YY}-S_{XY}^2}\n\\begin{pmatrix}S_{YY}&-S_{XY}\\\\-S_{XY}&S_{XX}\\end{pmatrix}.\n$$\nPutting these blocks into the $4\\times4$ form yields the final covariance.", "answer": "$$\\boxed{\n\\sigma^2\n\\begin{pmatrix}\n\\frac{S_{YY}}{S_{XX}S_{YY}-S_{XY}^2}&0&-\\frac{S_{XY}}{S_{XX}S_{YY}-S_{XY}^2}&0\\\\\n0&\\frac{S_{YY}}{S_{XX}S_{YY}-S_{XY}^2}&0&-\\frac{S_{XY}}{S_{XX}S_{YY}-S_{XY}^2}\\\\\n-\\frac{S_{XY}}{S_{XX}S_{YY}-S_{XY}^2}&0&\\frac{S_{XX}}{S_{XX}S_{YY}-S_{XY}^2}&0\\\\\n0&-\\frac{S_{XY}}{S_{XX}S_{YY}-S_{XY}^2}&0&\\frac{S_{XX}}{S_{XX}S_{YY}-S_{XY}^2}\n\\end{pmatrix}\n}$$", "id": "236830"}, {"introduction": "Astrophysical systems are rarely as simple as our initial models assume, and this exercise explores how to handle a common complication. You will investigate an apparent binary star system that is actually part of a larger triple system, which induces a systematic drift in the observed radial velocities. Your task is to derive a correction for the mass ratio, which would otherwise be biased by the unmodeled acceleration from the third body [@problem_id:237039], illustrating the critical process of identifying and correcting for systematic errors to achieve a more accurate result.", "problem": "In the study of double-lined spectroscopic binaries (SB2), the mass ratio of the two component stars, $q = m_2/m_1$, is conventionally determined from the semi-amplitudes of their radial velocity curves, $K_1$ and $K_2$. For a circular orbit, the radial velocities of the stars with respect to the system's center of mass are given by $v_{r,1}(t) = K_1 \\sin(\\omega t + \\phi)$ and $v_{r,2}(t) = -K_2 \\sin(\\omega t + \\phi)$. Since the center of mass is defined by $m_1 v_1 + m_2 v_2 = 0$, it follows that $m_1 K_1 = m_2 K_2$, leading to the standard formula for the true mass ratio: $q_{true} = m_2/m_1 = K_1/K_2$.\n\nConsider a scenario where the binary system is itself part of a wider triple system. The gravitational influence of a distant third body causes the center of mass of the inner binary to accelerate. Over the span of observations, this acceleration can be approximated as being constant, resulting in a linear drift in the observed radial velocity.\n\nThe observed radial velocities for the two stars are therefore not purely sinusoidal but include this drift:\n$$ v_{obs,1}(t) = K_1 \\sin(\\omega t) + \\gamma_0 + \\dot{\\gamma} t $$\n$$ v_{obs,2}(t) = -K_2 \\sin(\\omega t) + \\gamma_0 + \\dot{\\gamma} t $$\nHere, $K_1$ and $K_2$ are the true semi-amplitudes, $\\omega$ is the orbital frequency of the inner binary, $\\gamma_0$ is the mean systemic velocity at $t=0$, and $\\dot{\\gamma}$ is the constant rate of change of the systemic velocity (the acceleration). For simplicity, the phase $\\phi$ is set to zero by choosing an appropriate time origin.\n\nAn astronomer, unaware of the third body, analyzes the data by fitting a standard sinusoidal model, $v_{fit}(t) = K_{obs} \\sin(\\omega t + \\phi_{obs}) + \\gamma_{obs}$, to the observed radial velocity curves over a time interval $T$ that spans many orbital periods. This procedure yields observed (and incorrect) semi-amplitudes $K_{obs,1}$ and $K_{obs,2}$. From these, an observed mass ratio is calculated as $q_{obs} = K_{obs,1} / K_{obs,2}$.\n\nYour task is to derive an expression for the true mass ratio, $q_{true}$, in terms of the observed mass ratio, $q_{obs}$, and a dimensionless parameter $\\alpha = \\frac{2\\dot{\\gamma}}{\\omega K_{obs,2}}$. This parameter $\\alpha$ is constructed from quantities that can be determined from the observational data: the drift $\\dot{\\gamma}$ (which can be found from a more sophisticated fit or from the residuals of the simple sinusoidal fit), the orbital frequency $\\omega$, and the observed semi-amplitude of the secondary star, $K_{obs,2}$.", "solution": "1. Relevant definitions:\n   v_{obs,1}(t)=K_{1}\\sin\\omega t+\\gamma_{0}+\\dot\\gamma\\,t,\\quad\n   v_{obs,2}(t)=-K_{2}\\sin\\omega t+\\gamma_{0}+\\dot\\gamma\\,t.\n   The astronomer fits v=A\\sin\\omega t+B\\cos\\omega t+C over T=N\\,(2\\pi/\\omega), so the drift term contributes to the fitted sine-coefficients\n   A_{1}=(2/T)\\!\\int_{0}^{T}\\!(K_{1}\\sin\\omega t+\\dot\\gamma t)\\sin\\omega t\\,dt\n          =K_{1}-\\frac{2\\dot\\gamma}{\\omega}, \n   A_{2}=(2/T)\\!\\int_{0}^{T}\\!(-K_{2}\\sin\\omega t+\\dot\\gamma t)\\sin\\omega t\\,dt\n          =-K_{2}-\\frac{2\\dot\\gamma}{\\omega}.\n2. Hence the observed semi-amplitudes are\n   K_{obs,1}=A_{1}=K_{1}-d,\\quad K_{obs,2}=-A_{2}=K_{2}+d,\\quad d\\equiv\\frac{2\\dot\\gamma}{\\omega}.\n3. The observed mass ratio is\n   q_{obs}=\\frac{K_{obs,1}}{K_{obs,2}}\n          =\\frac{K_{1}-d}{K_{2}+d}.\n4. True mass ratio q_{true}=K_{1}/K_{2}.  Write K_{1}=q_{true}\\,K_{2} and solve\n   q_{obs}=\\frac{q_{true}K_{2}-d}{K_{2}+d}\n   \\;\\Longrightarrow\\;(q_{true}-q_{obs})K_{2}=d\\,(q_{obs}+1)\n   \\;\\Longrightarrow\\;K_{2}=\\frac{d\\,(q_{obs}+1)}{q_{true}-q_{obs}}.\n5. But K_{obs,2}=K_{2}+d\n   =\\frac{d\\,(q_{obs}+1)}{q_{true}-q_{obs}}+d\n   =d\\,\\frac{q_{true}+1}{q_{true}-q_{obs}}\n   \\;\\Longrightarrow\\;\\alpha\\equiv\\frac{2\\dot\\gamma}{\\omega\\,K_{obs,2}}\n   =\\frac{d}{K_{obs,2}}\n   =\\frac{q_{true}-q_{obs}}{q_{true}+1}.\n6. Solve for q_{true}:\n   \\alpha(q_{true}+1)=q_{true}-q_{obs}\n   \\;\\Longrightarrow\\;q_{true}(1-\\alpha)=q_{obs}+\\alpha\n   \\;\\Longrightarrow\\;q_{true}=\\frac{q_{obs}+\\alpha}{1-\\alpha}.", "answer": "$$\\boxed{\\frac{q_{obs}+\\alpha}{1-\\alpha}}$$", "id": "237039"}]}