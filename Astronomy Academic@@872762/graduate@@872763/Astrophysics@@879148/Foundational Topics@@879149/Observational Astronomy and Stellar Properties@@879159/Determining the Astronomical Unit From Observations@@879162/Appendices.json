{"hands_on_practices": [{"introduction": "The principle of parallax is the cornerstone of distance measurement in astronomy, providing a direct geometric method to gauge the vast scales of the cosmos. This exercise provides a hands-on application of this principle by analyzing the occultation of a distant star by an asteroid as seen from two different observatories. By relating the observed time delay to the known baseline and the asteroid's relative velocity, you will derive the value of the astronomical unit, solidifying the connection between terrestrial measurements and the fundamental scale of our solar system. [@problem_id:206069]", "problem": "An asteroid is observed to occult a distant star. The event is recorded by two astronomical observatories on Earth, separated by a known baseline. By analyzing the timing difference of the occultation between the two sites, it is possible to determine the length of the astronomical unit (AU).\n\nWe model this scenario in a 2D Cartesian coordinate system $(x,y)$ located on the \"plane of the sky,\" which is tangent to the celestial sphere at the star's position and perpendicular to the line of sight.\n\nThe following quantities are known:\n1.  The baseline vector between the two observatories, as projected onto the plane of the sky, is given by $\\vec{b} = (b_x, b_y)$. The components are measured in kilometers (km). This vector is assumed to be constant throughout the observation.\n2.  The difference in the time of the star's disappearance as seen by the two observatories is $\\Delta t$, measured in seconds (s). Let observatory 2 experience the event at a time $\\Delta t$ after observatory 1.\n3.  From the well-established orbital elements of the Earth and the asteroid, the asteroid's transverse velocity vector relative to the Earth, projected onto the sky plane, has been calculated as $\\vec{V} = (V_x, V_y)$. The components are expressed in units of astronomical units per second (AU/s).\n\nWithin the short duration of the occultation across the observatories' baseline, you can make the following simplifying assumptions:\n- The asteroid's shadow moves with a constant velocity across the sky plane.\n- The leading edge of the asteroid's shadow, which causes the star to disappear, can be approximated as a straight line moving perpendicular to its velocity vector.\n\nDerive a formula for the astronomical unit (AU) in kilometers, expressed in terms of the given quantities $b_x, b_y, V_x, V_y,$ and $\\Delta t$.", "solution": "1. Let $L$ denote the length of 1 AU in km.  The asteroid’s sky‐plane velocity in km/s is\n$$\\vec V_{\\rm km} = L\\,\\vec V = \\bigl(LV_x,\\;LV_y\\bigr)\\,. $$\n\n2. Its speed and unit‐direction are\n$$|\\vec V_{\\rm km}| = L\\,\\sqrt{V_x^2+V_y^2},\\qquad \n\\hat v = \\frac{\\vec V_{\\rm km}}{|\\vec V_{\\rm km}|}\n= \\frac{\\vec V}{\\sqrt{V_x^2+V_y^2}}\\,. $$\n\n3. The projected separation of the two sites along the motion is \n$$\\vec b\\cdot\\hat v = \\frac{b_xV_x+b_yV_y}{\\sqrt{V_x^2+V_y^2}}\\,. $$\n\n4. The time delay $\\Delta t$ equals this projected separation divided by the shadow speed:\n$$\n\\Delta t = \\frac{\\vec b\\cdot\\hat v}{|\\vec V_{\\rm km}|}\n= \\frac{(b_xV_x+b_yV_y)/\\sqrt{V_x^2+V_y^2}}{L\\,\\sqrt{V_x^2+V_y^2}}\n= \\frac{b_xV_x+b_yV_y}{L\\,(V_x^2+V_y^2)}\\,. \n$$\n\n5. Solving for $L$ gives the AU in km:\n$$\nL = \\frac{b_xV_x+b_yV_y}{\\Delta t\\,(V_x^2+V_y^2)}\\,. \n$$", "answer": "$$\\boxed{\\frac{b_xV_x+b_yV_y}{\\Delta t\\,(V_x^2+V_y^2)}}$$", "id": "206069"}, {"introduction": "While idealized calculations provide foundational understanding, precision science demands a rigorous accounting of systematic errors. This practice delves into a classic challenge that faced astronomers attempting to measure the AU via Venus transits: the distorting effect of Earth's atmosphere. You will model how differential refraction alters the apparent positions of Venus and the Sun, leading to a measurable timing error, and use approximation techniques to derive an analytical expression for this important systematic effect. [@problem_id:206217]", "problem": "An astronomer is attempting to precisely time the second internal contact of a Venus transit to contribute to a determination of the astronomical unit (AU). The measurement is affected by Earth's atmosphere, which refracts the light from both the Sun and Venus. This differential refraction introduces a systematic timing error.\n\nConsider an observer for whom the second internal contact occurs at the point on the Sun's limb that is closest to the local zenith. The Sun's center is at a fixed true zenith angle $z_0$, and its true angular radius is $R_S$. Venus has a true angular radius $R_V$ and moves with a constant relative velocity $\\vec{v}$ with respect to the Sun's center. For this specific geometry, the relative motion component relevant for contact timing is the radial speed of separation of the limbs, $v_r$.\n\nThe angle of atmospheric refraction $R(z)$ for an object at a true zenith angle $z$ is given by the simplified law $R(z) = k \\tan(z)$, where $k$ is the constant of atmospheric refraction. We assume that $z_0 > R_S$ and that the observation is made sufficiently far from the horizon.\n\nBy modeling the apparent positions of the limbs of the Sun and Venus, a transcendental equation for the observed contact time can be found. This equation has a trivial solution corresponding to no timing error, and potentially a non-trivial solution. You are to derive an approximate analytical expression for this non-trivial timing error, $\\delta t = t_{observed} - t_{true}$. Assume the error is small and perform a Taylor expansion to find the lowest-order non-vanishing approximation for $\\delta t$.", "solution": "We denote $u=z_0-R_S$ and $\\delta t=t_{\\rm obs}-t_{\\rm true}$, and set $\\delta z=v_r\\,\\delta t$.  The observed‐contact condition is\n$$Z_V^{\\rm obs}-Z_S^{\\rm obs}\n=\\bigl[z_V^{\\rm true}-R(z_V^{\\rm true})\\bigr]\n-\\bigl[z_S^{\\rm true}-R(z_S^{\\rm true})\\bigr]=0.$$  \nSince $z_S^{\\rm true}=u$ and $z_V^{\\rm true}=u+v_r\\delta t=u+\\delta z$, we have\n$$\\delta z\n=k\\bigl[\\tan(u+\\delta z)-\\tan(u)\\bigr].\\tag{1}$$  \nTaylor‐expand to second order in $\\delta z$:\n$$\\tan(u+\\delta z)=\\tan u+\\delta z\\sec^2u+\\delta z^2\\sec^2u\\tan u+O(\\delta z^3).$$  \nThus (1) gives\n$$\\delta z\n=k\\bigl[\\delta z\\sec^2u+\\delta z^2\\sec^2u\\tan u+\\cdots\\bigr],$$\nso\n$$\\delta z\\,(1-k\\sec^2u)=k\\,\\delta z^2\\sec^2u\\tan u.$$\nFor the non‐trivial root ($\\delta z\\neq0$) divide by $\\delta z$:\n$$1-k\\sec^2u\n=k\\,\\delta z\\,\\sec^2u\\tan u\n\\quad\\Longrightarrow\\quad\n\\delta z=\\frac{1-k\\sec^2u}{k\\sec^2u\\tan u}.$$\nFinally\n$$\\delta t=\\frac{\\delta z}{v_r}\n=\\frac{1-k\\sec^2u}{k\\,v_r\\,\\sec^2u\\,\\tan u}\n=\\frac{\\cos^2u-k}{k\\,v_r\\,\\tan u},\\quad u=z_0-R_S.$$", "answer": "$$\\boxed{\\frac{\\cos^2\\!\\bigl(z_0 - R_S\\bigr)-k}{k\\,v_r\\,\\tan\\!\\bigl(z_0-R_S\\bigr)}}$$", "id": "206217"}, {"introduction": "Modern astronomical measurements are fundamentally probabilistic, combining new data with existing knowledge under a rigorous statistical framework. This advanced exercise introduces a Bayesian approach to determining the AU from asteroid observations, representing the state-of-the-art in parameter estimation. You will derive the Maximum A Posteriori (MAP) estimate for the AU by synthesizing a physical model of parallax, a realistic error distribution, and prior information into a single coherent analysis. [@problem_id:206240]", "problem": "An essential task in fundamental astronomy is the precise determination of the astronomical unit (AU), the scale factor linking solar system dynamics (typically modeled in AU) to terrestrial measurements (in SI units, e.g., kilometers). Consider a Bayesian experiment designed to estimate the value of the AU, denoted as $A_U$, from astrometric observations of a near-Earth asteroid.\n\nThe asteroid is observed simultaneously at $N$ distinct epochs, indexed by $i=1, \\dots, N$, from two geographically separated observatories on Earth, indexed by $k \\in \\{1, 2\\}$. For each epoch $t_i$, the following information is available:\n- The observed direction to the asteroid from observatory $k$ is given by the unit vector $\\hat{\\rho}_{k,i}^{\\text{obs}}$.\n- The geocentric inertial position vector of observatory $k$ is $\\vec{R}_{k,i}$, measured in kilometers.\n- A high-precision orbital model of the asteroid provides its true geocentric position vector $\\vec{d}_i$ for each epoch $t_i$, measured in units of AU. Let $d_i = |\\vec{d}_i|$ and $\\hat{d}_i = \\vec{d}_i / d_i$.\n\nThe measurement process is modeled as follows:\nThe likelihood of observing the direction $\\hat{\\rho}_{k,i}^{\\text{obs}}$ given the true direction $\\hat{\\rho}_{k,i}^{\\text{true}}$ is described by a von Mises-Fisher distribution on the sphere, with a known concentration parameter $\\kappa$. The likelihood for a single observation is:\n$$ P(\\hat{\\rho}_{k,i}^{\\text{obs}} | \\hat{\\rho}_{k,i}^{\\text{true}}) \\propto \\exp(\\kappa \\, \\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\hat{\\rho}_{k,i}^{\\text{true}}) $$\nAll observations are independent.\n\nA prior belief about the value of $A_U$ is described by an Inverse-Gamma distribution with given shape hyperparameter $\\alpha_0$ and scale hyperparameter $\\beta_0$:\n$$ P(A_U) \\propto A_U^{-\\alpha_0-1} \\exp(-\\beta_0/A_U) $$\n\nThe problem is to be solved under the small-parallax approximation, where the geocentric distance to the asteroid (in km) is much larger than the observatory's distance from the geocenter, i.e., $A_U d_i \\gg |\\vec{R}_{k,i}|$. This allows for a first-order Taylor expansion in the small parameter $\\epsilon_{k,i} = |\\vec{R}_{k,i}|/(A_U d_i)$.\n\nDefine the vector component of $\\vec{R}_{k,i}$ perpendicular to the line-of-sight vector $\\hat{d}_i$ as $\\vec{R}_{k,i}^{\\perp} = \\vec{R}_{k,i} - \\hat{d}_i (\\hat{d}_i \\cdot \\vec{R}_{k,i})$.\n\nUsing the information and models provided, derive the Maximum A Posteriori (MAP) estimate for the astronomical unit, $A_{U, \\text{MAP}}$. Express your answer in terms of the given symbolic quantities: $\\alpha_0, \\beta_0, \\kappa, N$, and the provided data vectors $\\{\\hat{\\rho}_{k,i}^{\\text{obs}}, \\vec{R}_{k,i}, \\vec{d}_i\\}$.", "solution": "The goal is to find the Maximum A Posteriori (MAP) estimate of the astronomical unit, $A_U$. The MAP estimate is the value of $A_U$ that maximizes the posterior probability density $P(A_U | D)$, where $D = \\{\\hat{\\rho}_{k,i}^{\\text{obs}}\\}$ is the set of all observations.\n\nBy Bayes' theorem, the posterior probability is proportional to the product of the likelihood and the prior:\n$$ P(A_U | D) \\propto P(D | A_U) P(A_U) $$\nMaximizing the posterior is equivalent to maximizing its logarithm (the log-posterior):\n$$ \\ln P(A_U | D) = \\ln P(D | A_U) + \\ln P(A_U) + \\text{constant} $$\n\n**1. The Likelihood Function**\n\nThe observations are independent, so the total likelihood is the product of the individual likelihoods:\n$$ P(D | A_U) = \\prod_{i=1}^{N} \\prod_{k=1}^{2} P(\\hat{\\rho}_{k,i}^{\\text{obs}} | \\hat{\\rho}_{k,i}^{\\text{true}}(A_U)) $$\nThe log-likelihood is:\n$$ \\ln L(A_U) \\equiv \\ln P(D | A_U) = \\sum_{i=1}^{N} \\sum_{k=1}^{2} \\ln P(\\hat{\\rho}_{k,i}^{\\text{obs}} | \\hat{\\rho}_{k,i}^{\\text{true}}(A_U)) $$\nUsing the given von Mises-Fisher distribution form:\n$$ \\ln L(A_U) = \\sum_{i=1}^{N} \\sum_{k=1}^{2} \\left( \\kappa \\, \\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) \\right) + \\text{constant} $$\nThe true direction vector from observatory $k$ to the asteroid, $\\hat{\\rho}_{k,i}^{\\text{true}}(A_U)$, depends on $A_U$. The geometric relationship is that the vector from the observatory to the asteroid, $\\vec{\\Delta}_{k,i}$, is given by:\n$$ \\vec{\\Delta}_{k,i} = (A_U \\vec{d}_i) - \\vec{R}_{k,i} $$\nwhere $A_U \\vec{d}_i$ is the geocentric vector to the asteroid in km. The true direction is the unit vector:\n$$ \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) = \\frac{A_U \\vec{d}_i - \\vec{R}_{k,i}}{|A_U \\vec{d}_i - \\vec{R}_{k,i}|} $$\n\n**2. The Small-Parallax Approximation**\n\nWe now apply the approximation $A_U d_i \\gg |\\vec{R}_{k,i}|$. Let's expand $\\hat{\\rho}_{k,i}^{\\text{true}}(A_U)$ to first order.\nFirst, expand the magnitude in the denominator:\n$$ |A_U \\vec{d}_i - \\vec{R}_{k,i}| = \\sqrt{(A_U \\vec{d}_i - \\vec{R}_{k,i}) \\cdot (A_U \\vec{d}_i - \\vec{R}_{k,i})} = \\sqrt{A_U^2 d_i^2 - 2 A_U (\\vec{d}_i \\cdot \\vec{R}_{k,i}) + |\\vec{R}_{k,i}|^2} $$\n$$ = A_U d_i \\sqrt{1 - \\frac{2 (\\hat{d}_i \\cdot \\vec{R}_{k,i})}{A_U d_i} + O\\left(\\left(\\frac{|\\vec{R}_{k,i}|}{A_U d_i}\\right)^2\\right)} \\approx A_U d_i \\left(1 - \\frac{\\hat{d}_i \\cdot \\vec{R}_{k,i}}{A_U d_i}\\right) = A_U d_i - (\\hat{d}_i \\cdot \\vec{R}_{k,i}) $$\nNow substitute this back into the expression for $\\hat{\\rho}_{k,i}^{\\text{true}}(A_U)$:\n$$ \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) \\approx \\frac{A_U d_i \\hat{d}_i - \\vec{R}_{k,i}}{A_U d_i - (\\hat{d}_i \\cdot \\vec{R}_{k,i})} = \\left(\\hat{d}_i - \\frac{\\vec{R}_{k,i}}{A_U d_i}\\right) \\left(1 - \\frac{\\hat{d}_i \\cdot \\vec{R}_{k,i}}{A_U d_i}\\right)^{-1} $$\nUsing the first-order binomial approximation $(1-x)^{-1} \\approx 1+x$ for small $x$:\n$$ \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) \\approx \\left(\\hat{d}_i - \\frac{\\vec{R}_{k,i}}{A_U d_i}\\right) \\left(1 + \\frac{\\hat{d}_i \\cdot \\vec{R}_{k,i}}{A_U d_i}\\right) $$\n$$ \\approx \\hat{d}_i + \\frac{\\hat{d}_i(\\hat{d}_i \\cdot \\vec{R}_{k,i})}{A_U d_i} - \\frac{\\vec{R}_{k,i}}{A_U d_i} - \\frac{\\vec{R}_{k,i}(\\hat{d}_i \\cdot \\vec{R}_{k,i})}{(A_U d_i)^2} $$\nKeeping only terms up to first order in $1/A_U$:\n$$ \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) \\approx \\hat{d}_i - \\frac{1}{A_U d_i} \\left( \\vec{R}_{k,i} - \\hat{d}_i(\\hat{d}_i \\cdot \\vec{R}_{k,i}) \\right) $$\nUsing the definition $\\vec{R}_{k,i}^{\\perp} = \\vec{R}_{k,i} - \\hat{d}_i(\\hat{d}_i \\cdot \\vec{R}_{k,i})$:\n$$ \\hat{\\rho}_{k,i}^{\\text{true}}(A_U) \\approx \\hat{d}_i - \\frac{\\vec{R}_{k,i}^{\\perp}}{A_U d_i} $$\n\n**3. The Log-Posterior**\n\nSubstitute this approximate true direction into the log-likelihood:\n$$ \\ln L(A_U) \\approx \\kappa \\sum_{i,k} \\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\left(\\hat{d}_i - \\frac{\\vec{R}_{k,i}^{\\perp}}{A_U d_i}\\right) + \\text{const} $$\n$$ = \\kappa \\sum_{i,k} (\\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\hat{d}_i) - \\frac{\\kappa}{A_U} \\sum_{i,k} \\frac{\\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\vec{R}_{k,i}^{\\perp}}{d_i} + \\text{const} $$\nThe first summation does not depend on $A_U$, so it can be absorbed into the constant term. Let $S = \\sum_{i,k} \\frac{\\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\vec{R}_{k,i}^{\\perp}}{d_i}$.\n$$ \\ln L(A_U) \\approx -\\frac{\\kappa S}{A_U} + \\text{constant} $$\nThe prior is $P(A_U) \\propto A_U^{-\\alpha_0-1} \\exp(-\\beta_0/A_U)$. The log-prior is:\n$$ \\ln P(A_U) = -(\\alpha_0+1)\\ln A_U - \\frac{\\beta_0}{A_U} + \\text{constant} $$\nNow, form the log-posterior:\n$$ \\ln P(A_U | D) \\approx \\left( -\\frac{\\kappa S}{A_U} \\right) + \\left( -(\\alpha_0+1)\\ln A_U - \\frac{\\beta_0}{A_U} \\right) + \\text{constant} $$\n$$ \\ln P(A_U | D) \\approx -(\\alpha_0+1)\\ln A_U - \\frac{1}{A_U} (\\beta_0 + \\kappa S) + \\text{constant} $$\nThis shows the posterior distribution is also an Inverse-Gamma distribution, $P(A_U|D) = \\text{Inv-Gamma}(A_U | \\alpha_p, \\beta_p)$, with posterior hyperparameters $\\alpha_p = \\alpha_0$ and $\\beta_p = \\beta_0 + \\kappa S$.\n\n**4. Finding the MAP Estimate**\n\nTo find the MAP estimate, we maximize the log-posterior by taking its derivative with respect to $A_U$ and setting it to zero.\n$$ \\frac{d}{dA_U} \\ln P(A_U | D) = \\frac{d}{dA_U} \\left( -(\\alpha_0+1)\\ln A_U - \\frac{\\beta_0 + \\kappa S}{A_U} \\right) $$\n$$ = -\\frac{\\alpha_0+1}{A_U} + \\frac{\\beta_0 + \\kappa S}{A_U^2} $$\nSetting the derivative to zero:\n$$ -\\frac{\\alpha_0+1}{A_{U, \\text{MAP}}} + \\frac{\\beta_0 + \\kappa S}{A_{U, \\text{MAP}}^2} = 0 $$\n$$ \\frac{\\beta_0 + \\kappa S}{A_{U, \\text{MAP}}^2} = \\frac{\\alpha_0+1}{A_{U, \\text{MAP}}} $$\nSolving for $A_{U, \\text{MAP}}$:\n$$ A_{U, \\text{MAP}} = \\frac{\\beta_0 + \\kappa S}{\\alpha_0+1} $$\nSubstituting the expression for $S$:\n$$ A_{U, \\text{MAP}} = \\frac{\\beta_0 + \\kappa \\sum_{i=1}^N \\sum_{k=1}^2 \\frac{\\hat{\\rho}_{k,i}^{\\text{obs}}\\cdot\\vec{R}_{k,i}^{\\perp}}{d_i}}{\\alpha_0+1} $$\nExpanding $\\vec{R}_{k,i}^{\\perp}$ gives the final expression.\n\n$$ A_{U, \\text{MAP}} = \\frac{\\beta_0 + \\kappa \\sum_{i=1}^N \\sum_{k=1}^2 \\frac{\\hat{\\rho}_{k,i}^{\\text{obs}}\\cdot\\left(\\vec{R}_{k,i} - \\hat{d}_i (\\hat{d}_i \\cdot \\vec{R}_{k,i})\\right)}{d_i}}{\\alpha_0+1} $$", "answer": "$$ \\boxed{\\frac{\\beta_0 + \\kappa \\sum_{i=1}^{N} \\sum_{k=1}^{2} \\frac{\\hat{\\rho}_{k,i}^{\\text{obs}} \\cdot \\vec{R}_{k,i}^{\\perp}}{d_i}}{\\alpha_0 + 1}} $$", "id": "206240"}]}