{"hands_on_practices": [{"introduction": "A raw image from a radio interferometer, known as a \"dirty map,\" is not a true representation of the sky but is contaminated by artifacts from the instrument's response. The Högbom CLEAN algorithm is a foundational deconvolution technique used for decades to remove these artifacts. This exercise provides a concrete look at the very first step of this iterative process, building intuition for how a clean representation of the sky is recovered from the corrupted data [@problem_id:249013].", "problem": "In radio interferometry, the observed image, known as the \"dirty map\" $I_D(\\vec{r})$, is the true sky brightness distribution convolved with the interferometer's point spread function, the \"dirty beam\" $B_D(\\vec{r})$. The Högbom CLEAN algorithm is a widely used iterative deconvolution technique to remove the artifacts introduced by the dirty beam's sidelobes.\n\nThe algorithm proceeds as follows:\n1.  Initialize a \"residual map\" $I_R$ to be the dirty map, $I_{R,0}(\\vec{r}) = I_D(\\vec{r})$.\n2.  In each iteration $i$, find the location $\\vec{r}_{p,i}$ and flux $I_{p,i}$ of the brightest point in the current residual map $I_{R,i}(\\vec{r})$.\n3.  Subtract a fraction of the dirty beam, scaled by the peak flux and centered at the peak location, from the residual map. This update is given by:\n    $$I_{R, i+1}(\\vec{r}) = I_{R, i}(\\vec{r}) - g \\, I_{p,i} \\, B_D(\\vec{r} - \\vec{r}_{p,i})$$\n    Here, $g$ is a dimensionless parameter called the \"loop gain\", typically between $0$ and $1$.\n4.  The process is repeated until a stopping criterion is met.\n\nConsider a simple case where the dirty map consists of a single, unresolved point source. Due to convolution with the dirty beam, the dirty map is represented by a Gaussian function centered at $\\vec{r}_0 = (x_0, y_0)$:\n$$I_D(x, y) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{2\\sigma_S^2}\\right)$$\nwhere $A > 0$ is the peak amplitude and $\\sigma_S$ is the characteristic width.\n\nThe dirty beam for this particular observation has a central lobe and one significant sidelobe. It is modeled as a sum of two Gaussians:\n$$B_D(x, y) = \\exp\\left(-\\frac{x^2+y^2}{2\\sigma_B^2}\\right) + S \\exp\\left(-\\frac{(x-x_s)^2 + (y-y_s)^2}{2\\sigma_B^2}\\right)$$\nwhere $\\sigma_B$ is the width of the Gaussian components, $(x_s, y_s)$ is the position of the sidelobe relative to the main lobe, and $S$ is the relative strength of the sidelobe. You may assume that the global maximum of the dirty beam is at the origin $(0,0)$, which is satisfied for $0  S  1$.\n\nDerive the analytical expression for the residual map, $I_{R,1}(x, y)$, after the first complete iteration of the Högbom CLEAN algorithm. Your final expression should be in terms of $x, y, A, x_0, y_0, \\sigma_S, g, \\sigma_B, S, x_s$, and $y_s$.", "solution": "1. Initial residual is the dirty map:  \n$$I_{R,0}(x,y)=I_D(x,y)=A\\exp\\Bigl(-\\frac{(x-x_0)^2+(y-y_0)^2}{2\\sigma_S^2}\\Bigr)\\,. $$  \n2. The brightest peak occurs at $(x_0,y_0)$ with flux $I_{p,0}=A$ and position $\\vec r_{p,0}=(x_0,y_0)$.  \n3. The CLEAN update after one iteration is  \n$$I_{R,1}(x,y)=I_{R,0}(x,y)-g\\,I_{p,0}\\,B_D\\bigl(x-x_0,y-y_0\\bigr)\\,. $$  \n4. Substituting $I_{R,0}$ and $B_D$:  \n$$\\begin{aligned}\nI_{R,1}(x,y)=A\\exp\\Bigl(-\\frac{(x-x_0)^2+(y-y_0)^2}{2\\sigma_S^2}\\Bigr)\n-gA\\Bigl[\\exp\\Bigl(-\\frac{(x-x_0)^2+(y-y_0)^2}{2\\sigma_B^2}\\Bigr)\\\\\n\\quad+S\\exp\\Bigl(-\\frac{(x-x_0-x_s)^2+(y-y_0-y_s)^2}{2\\sigma_B^2}\\Bigr)\\Bigr]\\,.  \n\\end{aligned}$$", "answer": "$$\\boxed{A\\exp\\!\\Bigl(-\\frac{(x-x_0)^2+(y-y_0)^2}{2\\sigma_S^2}\\Bigr)\\;-\\;g\\,A\\Bigl[\\exp\\!\\Bigl(-\\frac{(x-x_0)^2+(y-y_0)^2}{2\\sigma_B^2}\\Bigr)\\;+\\;S\\,\\exp\\!\\Bigl(-\\frac{(x-x_0-x_s)^2+(y-y_0-y_s)^2}{2\\sigma_B^2}\\Bigr)\\Bigr]}$$", "id": "249013"}, {"introduction": "High-precision polarimetry hinges on the performance of optical components designed to manipulate the polarization state of light. A rotating half-wave plate (HWP) is a common modulator, but manufacturing imperfections mean it rarely behaves exactly as theory predicts. This practice delves into the practical consequences of such non-ideality, allowing you to quantify how a small retardance error degrades the instrument's ability to measure linear polarization, a critical factor in instrumental design and error analysis [@problem_id:248789].", "problem": "A rotating half-wave plate (HWP) is a common component in polarimeters used to measure linear polarization. An ideal HWP introduces a phase shift (retardance) of $\\Delta = \\pi$ radians between two orthogonal linear polarization components of light. In this setup, the HWP rotates with its fast axis at an angle $\\theta$ relative to a reference direction. It is followed by a fixed linear polarizer, called an analyzer, which is oriented along the reference direction (angle $\\alpha=0$). This configuration modulates the incoming linear polarization signal into a time-varying intensity signal that can be easily measured.\n\nIn a real instrument, the HWP is imperfect and has a retardance $\\Delta = \\pi + \\delta$, where $\\delta$ is a small, constant retardance error. This imperfection reduces the instrument's ability to measure linear polarization.\n\nThe Stokes vector $S = [I, Q, U, V]^T$ describes the polarization state of light. An optical element is described by a $4\\times4$ Mueller matrix $M$. The outgoing Stokes vector $S_{out}$ is given by $S_{out} = M S_{in}$. The measured intensity is the first component of the final Stokes vector.\n\nThe Mueller matrix for a retarder with fast-axis angle $\\theta$ and retardance $\\Delta$ is:\n$$\nM_{R}(\\theta, \\Delta) = \\begin{pmatrix}\n1  0  0  0 \\\\\n0  \\cos^2(2\\theta) + \\sin^2(2\\theta)\\cos(\\Delta)  \\cos(2\\theta)\\sin(2\\theta)(1-\\cos(\\Delta))  -\\sin(2\\theta)\\sin(\\Delta) \\\\\n0  \\cos(2\\theta)\\sin(2\\theta)(1-\\cos(\\Delta))  \\sin^2(2\\theta) + \\cos^2(2\\theta)\\cos(\\Delta)  \\cos(2\\theta)\\sin(\\Delta) \\\\\n0  \\sin(2\\theta)\\sin(\\Delta)  -\\cos(2\\theta)\\sin(\\Delta)  \\cos(\\Delta)\n\\end{pmatrix}\n$$\nThe Mueller matrix for a linear polarizer oriented at an angle $\\alpha$ is:\n$$\nM_{LP}(\\alpha) = \\frac{1}{2} \\begin{pmatrix}\n1  \\cos(2\\alpha)  \\sin(2\\alpha)  0 \\\\\n\\cos(2\\alpha)  \\cos^2(2\\alpha)  \\cos(2\\alpha)\\sin(2\\alpha)  0 \\\\\n\\sin(2\\alpha)  \\cos(2\\alpha)\\sin(2\\alpha)  \\sin^2(2\\alpha)  0 \\\\\n0  0  0  0\n\\end{pmatrix}\n$$\n\nThe \"polarimetric modulation efficiency\", $\\eta$, for linear polarization is defined as the ratio of the amplitude of the intensity modulation at the $4\\theta$ harmonic for the real HWP to the corresponding amplitude for an ideal HWP ($\\delta=0$).\n\nDerive the loss in polarimetric modulation efficiency, defined as $1-\\eta$, caused by the retardance error $\\delta$. Your final expression should be valid for small $\\delta$ and given to the lowest non-vanishing order in $\\delta$.", "solution": "1. The output intensity after the rotating retarder and fixed polarizer is\n$$I_{\\rm out}=\\frac12\\bigl[I_{\\rm in}+S_{1}\\bigr],$$\nwhere $S_{1}$ is the second Stokes component after the retarder:\n$$S_{1}=M_{R,11}Q+M_{R,12}U.$$\n2. For $Δ=π+δ$ with $δ\\ll1$,\n$$\\cosΔ=-1+\\frac{δ^2}{2}+O(δ^4),\\quad1-\\cosΔ=2-\\frac{δ^2}{2}+O(δ^4).$$\n3. From the Mueller matrix,\n$$M_{R,11}=\\cos^2(2θ)+\\sin^2(2θ)\\cosΔ\n=\\cos4θ+\\frac{δ^2}{2}\\sin^2(2θ),$$\n$$M_{R,12}=\\cos(2θ)\\sin(2θ)\\,(1-\\cosΔ)\n=\\sin4θ-\\frac{δ^2}{4}\\sin4θ.$$\nThus\n$$S_{1}\n=\\Bigl[\\cos4θ+\\tfrac{δ^2}{2}\\sin^2(2θ)\\Bigr]Q\n+\\Bigl[\\sin4θ-\\tfrac{δ^2}{4}\\sin4θ\\Bigr]U.$$\n4. Writing $\\sin^2(2θ)=\\tfrac12(1-\\cos4θ)$, the $4θ$ terms become\n$$S_{1}^{(4θ)}=(1-\\tfrac{δ^2}{4})\\bigl[Q\\cos4θ+U\\sin4θ\\bigr].$$\nHence the modulation amplitude is\n$$A_{\\rm real}=\\frac12\\bigl(1-\\frac{δ^2}{4}\\bigr)\\sqrt{Q^2+U^2},\\quad\nA_{\\rm ideal}=\\frac12\\sqrt{Q^2+U^2}.$$\n5. The efficiency is\n$$\\eta=\\frac{A_{\\rm real}}{A_{\\rm ideal}}=1-\\frac{δ^2}{4},$$\nso the loss is\n$$1-\\eta=\\frac{δ^2}{4}.$$", "answer": "$$\\boxed{\\frac{\\delta^2}{4}}$$", "id": "248789"}, {"introduction": "Beyond the core optics, the antenna structure and electronics can introduce their own polarization signatures, corrupting the astronomical signal in a process often modeled by \"D-terms.\" To achieve scientific accuracy, these instrumental effects must be meticulously calibrated and removed from the data. This problem models a standard calibration observation, demonstrating how observing a polarized source at different sky orientations allows us to mathematically isolate and solve for these instrumental leakage terms [@problem_id:249075].", "problem": "In radio polarimetry, the voltage signals measured by an antenna are related to the true electromagnetic waves from a celestial source via a $2 \\times 2$ Jones matrix, $J$. The measurement equation for the observed coherency matrix, $\\rho'$, is given by $\\rho' = J \\rho J^\\dagger$, where $\\rho$ is the true coherency matrix of the source in the antenna's reference frame. The coherency matrix is related to the Stokes parameters $(I, Q, U, V)$ by the convention:\n$$\n\\rho = \\frac{1}{2}\\begin{pmatrix} I+Q  U+iV \\\\ U-iV  I-Q \\end{pmatrix}\n$$\nConsider a simplified model for an antenna's instrumental polarization, where the primary gains are normalized to unity and the instrumental leakage is described by small, complex \"D-terms\", $d_x$ and $d_y$. The Jones matrix is given by:\n$$\nJ = \\begin{pmatrix} 1  d_x \\\\ d_y  1 \\end{pmatrix}\n$$\nTo calibrate these D-terms, a single, unresolved calibrator source with known Stokes parameters $(I_c, Q_c, U_c)$ is observed over a range of parallactic angles, $\\psi$. As the source moves across the sky, its polarization orientation appears to rotate with respect to the fixed antenna. The true coherency matrix of the source in the antenna frame, $\\rho_{ant}(\\psi)$, is thus a function of parallactic angle.\n\nFor small D-terms ($|d_x|, |d_y| \\ll 1$), the measurement equation can be linearized. The deviation in the observed off-diagonal term, $\\rho'_{xy}$, from its true value in the antenna frame, $\\rho_{xy,ant}(\\psi)$, is well-approximated by:\n$$\n\\rho'_{xy}(\\psi) - \\rho_{xy,ant}(\\psi) \\approx d_x \\rho_{yy,ant}(\\psi) + d_y^* \\rho_{xx,ant}(\\psi)\n$$\nSuppose a series of measurements at different parallactic angles has been made. The complex data vector $\\Delta(\\psi) = 2 \\left( \\rho'_{xy}(\\psi) - \\rho_{xy,ant}(\\psi) \\right)$ has been fitted to a model that accounts for the parallactic angle rotation:\n$$\n\\Delta(\\psi) = A_1 + A_2 \\cos(2\\psi) + A_3 \\sin(2\\psi)\n$$\nThe best-fit complex coefficients from this procedure are found to be $A_1$, $A_2$, and $A_3$.\n\nAssuming the calibrator has non-zero total intensity ($I_c \\neq 0$) and is linearly polarized ($Q_c^2 + U_c^2 \\neq 0$), derive the least-squares estimate for the instrumental leakage term $d_x$. Express your answer in terms of the known calibrator Stokes parameters $I_c$, $Q_c$, $U_c$, and the fitted complex coefficients $A_1$, $A_2$, and $A_3$.", "solution": "We begin with the source Stokes parameters in the antenna frame.  For a calibrator with $V_c=0$, the rotation by parallactic angle $\\psi$ gives\n$$\nQ_{\\rm ant}(\\psi)=Q_c\\cos2\\psi+U_c\\sin2\\psi,\\quad\nU_{\\rm ant}(\\psi)=-Q_c\\sin2\\psi+U_c\\cos2\\psi.\n$$\nHence the true coherency terms are\n$$\n\\rho_{xy,ant}=\\tfrac12\\,U_{\\rm ant},\\quad\n\\rho_{xx,ant}=\\tfrac12\\,(I_c+Q_{\\rm ant}),\\quad\n\\rho_{yy,ant}=\\tfrac12\\,(I_c-Q_{\\rm ant}).\n$$\n\nLinearizing the measurement equation gives\n$$\n\\Delta(\\psi)=2\\bigl(\\rho'_{xy}-\\rho_{xy,ant}\\bigr)\n\\approx d_x\\,(I_c-Q_{\\rm ant})+d_y^*\\,(I_c+Q_{\\rm ant}).\n$$\nSubstitute $Q_{\\rm ant}=Q_c\\cos2\\psi+U_c\\sin2\\psi$:\n$$\n\\Delta(\\psi)=(d_x+d_y^*)\\,I_c+(-d_x+d_y^*)\\,(Q_c\\cos2\\psi+U_c\\sin2\\psi).\n$$\nFitting $\\Delta(\\psi)=A_1+A_2\\cos2\\psi+A_3\\sin2\\psi$ yields\n$$\nA_1=(d_x+d_y^*)\\,I_c,\\quad \nA_2=(-d_x+d_y^*)\\,Q_c,\\quad\nA_3=(-d_x+d_y^*)\\,U_c.\n$$\nDefine\n$$\nS=d_x+d_y^*,\\quad D=-d_x+d_y^*.\n$$\nThen $S=A_1/I_c$ and the least‐squares solution for $D$ is\n$$\nD=\\frac{Q_cA_2+U_cA_3}{Q_c^2+U_c^2}.\n$$\nFinally,\n$$\nd_x=\\frac{S-D}{2}\n=\\frac12\\Bigl(\\frac{A_1}{I_c}-\\frac{Q_cA_2+U_cA_3}{Q_c^2+U_c^2}\\Bigr).\n$$", "answer": "$$\\boxed{\\frac12\\Bigl(\\frac{A_1}{I_c}-\\frac{Q_cA_2+U_cA_3}{Q_c^2+U_c^2}\\Bigr)}$$", "id": "249075"}]}