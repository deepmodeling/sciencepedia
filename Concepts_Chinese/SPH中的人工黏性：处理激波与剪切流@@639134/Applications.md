## 应用与跨学科联系

在我们迄今为止的旅程中，我们已经了解到[光滑粒子流体动力学](@entry_id:637248)（SPH）是一种非常直观的描述[流体运动](@entry_id:182721)的方式。我们不把流体想象成一个连续的块体，而是看作一堆相互作用的粒子，每个粒子都携带着它自己的故事片段——它的质量、它的速度、它的温度。我们看到，为了防止这些粒子非物理地互相穿透，并正确捕捉激波的物理特性，我们必须引入一个名为“[人工黏性](@entry_id:756576)”的概念。这是一项必要的发明，一种在粒子相互冲撞时开启的数学摩擦。

但像许多强大的工具一样，[人工黏性](@entry_id:756576)是一把双刃剑。虽然它对于捕捉激波的尖锐压缩特征至关重要，但在其他情况下却可能是一个极大的麻烦。毕竟，宇宙并非仅由正面碰撞构成；它充满了优雅的漩涡、[剪切层](@entry_id:274623)和宏伟的旋转。在这些流体层相互滑过的流动中，[人工黏性](@entry_id:756576)可能是一位不受欢迎的客人，它会产生一种伪摩擦，抑制我们希望研究的运动。本章讲述了物理学家和工程师们如何学会驯服这头“猛兽”，在需要时开启它，在不需要时关闭它，并在少数情况下，为其在远离其初衷的领域中找到了令人驚訝而美妙的新用途。

### 宇宙芭蕾：在天体物理学中驯服黏性

在天体物理学中，不必要摩擦的问题表现得尤为明显。考虑那些围绕着年轻恒星或[超大质量黑洞](@entry_id:157796)旋转的巨大气体盘。这些是行星的孕育场，也是宇宙中最亮天体的引擎。它们的演化受制于[引力](@entry_id:175476)将物质向内拉和角动量使其在[轨道](@entry_id:137151)上保持 aloft 之间的微妙平衡。气体只有在能够以某种方式失去其角动量时，才能吸积到中心天体上。在自然界中，这是通过[湍流](@entry_id:151300)和[磁场](@entry_id:153296)实现的，这个过程在[吸积盘](@entry_id:159973)理论中由著名的Shakura-Sunyaev参数 $\alpha_{\mathrm{SS}}$ 来[参数化](@entry_id:272587)。

如果我们使用带有简单[人工黏性](@entry_id:756576)的SPH来模拟这样一个盘，我们就会遇到灾难。盘的剪切运动，即内部旋转比外部快，在幼稚的[人工黏性](@entry_id:756576)算法看来，就像一系列温和的压缩。它尽职尽责地开启，产生一种与真实物理无关的强大数值摩擦。这种伪黏性可以产生一个人为的 $\alpha_{\mathrm{SS}}$，其值比物理值大几个[数量级](@entry_id:264888)，导致模拟的盘过快地耗尽其角动量并吸积到恒星上[@problem_id:3504492]。同样的悲剧也发生在旋转恒星的模拟中，其中[人工黏性](@entry_id:756576)可以产生伪差动旋转，在物理时间尺度上错误地将角动量从恒星核心输送到其包层[@problem_id:3444446]。

这个难题的解决方案非常优雅。它在于教会算法区分不同类型的[流体运动](@entry_id:182721)。激波是一个强*汇聚*区——速度场的散度很大且为负（$\nabla \cdot \boldsymbol{v} \lt 0$）。而剪切流则是一个强*涡度*或旋度区（$\nabla \times \boldsymbol{v} \neq 0$）。物理学家设计了“开关”，可以在局部同时测量这两个量，并利用它们的比率来决定施加多大的[人工黏性](@entry_id:756576)。一个著名的例子是Balsara开关，它将黏性乘以一个因子，当散度远大于旋度时该因子很大，而当旋度占主导时该因子很小[@problem_id:3504492]。在激波中，开关开启。在平滑旋转的盘中，它关闭。这个简单的局部技巧完美地解决了问题，使我们能够模拟宇宙结构数十亿年而不会被数值人为效应撕裂。

这种使方法适应问题特定环境的主题在宇宙学中达到了顶峰。当我们[模拟宇宙](@entry_id:754872)的一小块区域时，我们是在模拟一个存在于[膨胀时空](@entry_id:161389)中的流体。任何气体团的总速度都是由于宇宙膨胀造成的平滑“哈勃流”与其自身落入星系和[星系团](@entry_id:160919)时的“[本动速度](@entry_id:157964)”之和。SPH的幼稚应用会将哈勃膨胀视为[速度散度](@entry_id:264117)，并可能错误地在各处触发黏性。解决方案是构建一个“哈勃感知”的黏性开关。我们必须计算[本动速度](@entry_id:157964)的散度 $\nabla \cdot \boldsymbol{v}_{\mathrm{pec}}$，并将其与[宇宙膨胀](@entry_id:161474)率（与哈勃参数 $H$ 相关）进行比较，而不是与零比较。一个应该触发黏性的真实物理压缩，只有当[本动速度](@entry_id:157964)的汇聚强度足以克服背景膨胀时才会发生，这个条件表示为 $\nabla \cdot \boldsymbol{v}_{\mathrm{total}} = 3H + \nabla \cdot \boldsymbol{v}_{\mathrm{pec}} \lt 0$ [@problem_id:3465336]。这一修改使得SPH能够正确识别形成激[波的坍缩](@entry_id:181687)结构，同时忽略宇宙普遍存在的温和膨胀。

当然，SPH并不是[模拟宇宙](@entry_id:754872)的唯一工具。它与基于网格的方法如[自适应网格加密](@entry_id:143852)（AMR）和[移动网格](@entry_id:752196)（MMFV）方案竞争。每种方法都有其优点。SPH是[拉格朗日方法](@entry_id:142825)，没有[平流](@entry_id:270026)误差，并提供了极好的、内置的角动量守恒，因为其基本的粒子间力是完全中心的[@problem_id:3475499]。这使其成为处理涉及旋转的问题（如[螺旋星系](@entry_id:162037)的形成）的自然选择。然而，它处理流体混合的能力可能较差，因为像化学丰度这样的标量会“粘”在它们的粒子上，抑制了物理[扩散](@entry_id:141445)[@problem_id:3505193]。相比之下，网格方法擅长捕捉激波和混合，但在角动量守恒方面因网格对齐误差而遇到困难[@problem_id:3475499] [@problem_id:3475507]。这些方法的持续发展，例如通过发明沿流动方向伸长的各向异性SPH核以更好地解析剪切[@problem_id:2439470]，展示了一个充满活力的领域，其中工具的选择关键取决于所要研究的问题。

### 从星辰到土壤：SPH在地球上的应用

帮助我们模拟旋转星系的同样基于粒子的思维方式，也可以应用于离我们更近的问题。在岩[土力学](@entry_id:180264)领域，工程师希望了解土壤和岩石在应力下的变形和破坏方式。一个经典问题是锥形贯入试验（CPT），即将一个锥形仪器推入地下以测量土壤的性质。这涉及巨大的变形、材料破坏以及固体土壤颗粒与其孔隙中水之间的复杂相互作用——对于传统的、会被大变形缠住的网格方法来说，这是一场噩梦。

然而，SPH是天然的适配者。我们可以将土壤建模为SPH粒子的集合，锥体的贯入变成一个边界相互作用问题。用于估算气体云[速度散度](@entry_id:264117)的完全相同的SPH数学机制，可以用来估算土壤中的局部[应变率](@entry_id:154778)[@problem_id:3543166]。这个估算出的[应变率](@entry_id:154778)随后成为复杂土壤物理模型的输入。例如，许多土壤的屈服强度取决于它们的变形速度（一种称为黏塑性的特性）。SPH估算的应变率可以代入黏塑性模型来计算土壤的阻力。此外，当土壤被压缩时，孔隙水中的压力 $u$ 会增加。这个[孔隙压力](@entry_id:188528)会产生[反作用](@entry_id:203910)，降低土壤骨架上的[有效应力](@entry_id:198048)。SPH估算的压缩率可用于模拟这种孔隙压力的累积。通过将SPH的基于粒子的[运动学](@entry_id:173318)与土壤强度和[孔隙压力](@entry_id:188528)的物理模型相结合，我们可以构建一个能够预测锥尖阻力 $q_c$ 和套管[摩擦力](@entry_id:171772) $\bar{\tau}_s$ 的模拟，而这些正是真实世界CPT中测量的量[@problem_id:3543166]。

### 一个创造性的飞跃：当缺陷变成特性

也许最富智力趣味的应用来自于用新的眼光看待一个老问题。我们已经将[人工黏性](@entry_id:756576)称为一种“必要的恶”，是为SPH基本方法中的一个缺陷所做的数值修正。但这个缺陷能变成一个特性吗？答案在于与另一个物理学领域——[颗粒流](@entry_id:750004)——的类比。

想象沙子流过沙漏。沙粒在经典意义上不是流体；它们是通过碰撞和摩擦相互作用的固体颗粒。在“密集[惯性区](@entry_id:273327)”，流动沙子内部的应力不取决于流体黏性（这是无关紧要的），而是取决于颗粒的密度、颗粒尺寸 $d$ 和剪切率 $\dot{\gamma}$ 的平方。这被称为Bagnold标度律，其中[剪切应力](@entry_id:137139) $\tau_{\mathrm{B}} \propto d^2 \dot{\gamma}^2$ [@problem_id:3504549]。[能量耗散](@entry_id:147406)来自于颗粒之间的[非弹性碰撞](@entry_id:137360)。

现在让我们再看看SPH[人工黏性](@entry_id:756576)中的二次项。它产生一个与粒子间速度差的平方成正比的黏性压力，其耗散的能量与剪切率的立方成比例，即 $\epsilon_{\mathrm{AV}} \propto \beta h^2 \dot{\gamma}^3$，其中 $\beta$ 是黏性系数，h是光滑长度。Bagnold耗散率也是如此：$\epsilon_{\mathrm{B}} = \tau_{\mathrm{B}}\dot{\gamma} \propto d^2 \dot{\gamma}^3$。数学形式完全相同！

这是一个深刻的联系。我们为捕捉理想化流体激波中动量交换而发明的数值项，其行为与描述[颗粒材料](@entry_id:750005)中通过碰撞进行动量交换的物理项完全一样。因此，我们可以重新利用带有[人工黏性](@entry_id:756576)的SPH来作为[颗粒流](@entry_id:750004)的模型。通过令耗散率相等，$\epsilon_{\mathrm{AV}} = \epsilon_{\mathrm{B}}$，我们可以推导出物理上的Bagnold系数与数值上的SPH黏性参数 $\beta$ 之间的直接映射关系[@problem_id:3504549]。曾经的数值人为效应，变成了一个物理模型。

### 物理学家的视角：[湍流](@entry_id:151300)与分辨率

最后，让我们退后一步，问一个基本问题。通过添加[人工黏性](@entry_id:756576)，我们实际上在模拟什么样的流体？在物理学中，流动的特性通常由一个称为雷诺数 $Re = UL/\nu$ 的无量纲量来描述，它衡量了[惯性力](@entry_id:169104)与黏性力的比率。高[雷诺数](@entry_id:136372)表示[湍流](@entry_id:151300)，而低雷诺数表示平滑的层流。

正如我们所讨论的，SPH[人工黏性](@entry_id:756576)表现为一个等效的物理黏性 $\nu_{\mathrm{eff}}$，它与声速、光滑长度和黏性参数 $\alpha$ 成正比[@problem_id:3465305]。这意味着SPH模拟并不具有无限的[雷诺数](@entry_id:136372)；它具有一个由模拟本身分辨率决定的有限的、等效的[雷诺数](@entry_id:136372)。光滑长度 $h$ 越小，等效黏性就越小，等效[雷诺数](@entry_id:136372)就越高。

这对模拟[湍流](@entry_id:151300)具有深远的意义。[湍流](@entry_id:151300)中存在能量从大尺度[涡流](@entry_id:271366)向非常小的尺度级联的过程，在这些小尺度上，能量被真实的物理黏性所耗散。一个模拟只能解析比其分辨率尺度（在我们的情况下是光滑长度 $h$）更大的涡流。SPH中的[人工黏性](@entry_id:756576)充当了一个“亚格子”模型：它在尺度 $h$ 处介入，并移除那些本会级联到更小的、未解析尺度的能量。这正是工程学中一种广泛使用的技术——[大涡模拟（LES）](@entry_id:273295)——背后的哲学。因此，即使我们不是在试图模拟激波，[人工黏性](@entry_id:756576)也扮演着一个关键的物理角色，定义了我们模拟流体的等效[雷诺数](@entry_id:136372)，并决定了我们能实际捕捉到[湍流](@entry_id:151300)级联的哪个部分[@problem_id:3465305]。

从星系的旋转旋臂到我们脚下土壤的行为，从沙子的流动到[湍流](@entry_id:151300)的基本性质，将流体表示为粒[子集](@entry_id:261956)合的简单思想已被证明是惊人地富有成果。我们在此过程中遇到的挑战，其中最主要的是[人工黏性](@entry_id:756576)这个微妙的问题，并不仅仅是障碍。它们是创新的驱动力，迫使我们更深入地思考我们试图模拟的流动的本质，并 dẫn đến 优雅的解决方案和令人驚訝的联系，揭示了物理学 krásné, underlying unity。