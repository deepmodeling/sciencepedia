## 应用与跨学科联系

我们已经花了一些时间学习[多相流](@entry_id:146480)模拟的原理和机理，即支配我们如何教计算机将世界看作[流体混合物](@entry_id:190732)的底层“语法”。但学习语法只有在你想创作诗篇时才有用。所以现在，我们转向诗篇。我们将探索这些基本规则和计算技巧如何让我们能够描述、预测和改造我们周围的世界。物理学以及描述它的计算方法有一个显著的特点，即同一套核心思想可以用来理解惊人广泛的现象——从单个微观液滴的行为到地球深处数英里岩石中油和水的流动。

### 界面的艺术：捕捉不可捕捉之物

任何多相模拟的核心都是一个看似简单的问题：流体之间的边界在哪里？在现实世界中，这个界面是一个极其薄的区域，或许只有几个分子那么宽。而在以存储在网格单元中的离散数据块进行思考的计算机中，不存在“中间地带”。一个单元格要么包含流体A，要么包含流体B，要么是两者的某种混合。因此，核心挑战在于，如何用粗糙的、离散的网格来表示这个清晰、连续的界面。

做到这一点最流行和最直观的方法之一是[流体体积法](@entry_id:756561)（VOF）。其思想非常简单：在每个单元格中，我们只追踪一个数字，即[体积分数](@entry_id:756566) $C$，它告诉我们该单元格被流体A占据的比例是多少。$C=1$ 的值意味着单元格充满了流体A，$C=0$ 意味着它充满了流体B，而像 $C=0.5$ 这样的中间值则意味着该单元格位于界面上。

但这种简单性隐藏着一个微妙的陷阱。当流体从一个单元格移动到另一个单元格时，我们如何更新这些分数值，而不让本应清晰的界面模糊成一团不真实的混乱状态？想象一下，将一个简单的方形流体块在另一个流体域中进行[对流](@entry_id:141806)。如果我们的数值格式不够谨慎，这个方块的锐利边缘会很快变得圆滑和弥散。为了解决这个问题，我们必须使用具有“方向感”的方法。[迎风](@entry_id:756372)离散格式正是这样做的：它观察流动的来源方向（上游），以决定如何计算穿过单元格边界的流体通量。这个简单的思想对于防止数值扩散和保持界面完整性至关重要，构成了稳健[界面捕捉](@entry_id:750724)模拟的基石 [@problem_id:2449009]。

我们可以做得更好。除了知道一个单元格是半满的，如果我们还能估计该单元格内界面的朝向呢？这就是像分段线性界面计算（PLIC）这类更先进技术背后的思想。在每个界面单元格内部，我们不仅存储体积分数，还构建一个代表局部界面片段的线段（在3D中是平面）。这将计算流体通量的问题转变为一个计算几何的绝妙实践。为了找出一个小时间步 $\Delta t$ 内有多少流体A从一个单元格移动到其邻居，我们实际上是去计算由流体区域、单元格边界以及流动扫过的区域相交形成的那个多边形的面积 [@problem_id:3461680]。我们化身为微小而细致的会计师，追踪几何形状的运动，以确保模拟流体一滴不失。

这种几何视角为连接其他物理领域提供了一座极其强大的桥梁。考虑一个停留在表面上的液滴。液滴边缘与固体相接的角度并非任意的，它是由分子间力的微妙平衡决定的——即两种流体之间的表面张力以及它们各自与固体表面的相互作用。这就是著名的静态接触角。在我们的模拟中，我们必须遵循这一物理定律。利用我们的PLIC框架，我们正可以做到这一点。对于一个与固体边界相邻的单元格，我们可以调整重构线段的朝向，使其以预设的[接触角](@entry_id:145614)与壁面相接，同时仍然确保单元格中的总流体体积是守恒的 [@problem_id:3516372]。在这个单一的计算步骤中，我们看到了表面能的微观物理、液滴的宏观几何以及使这一切可计算的数值算法之间的联系。这是[多物理场建模](@entry_id:752308)的一个完美例子，我们将[流体动力学](@entry_id:136788)、[材料科学](@entry_id:152226)和[计算数学](@entry_id:153516)的原理编织在一起。

### 从颗粒到相：不同的观察方式

VOF方法是一种“自顶向下”的方法：我们从界面的宏观概念出发，然后想办法追踪它。但如果我们尝试一种“自底向上”的方法呢？如果我们不追踪边界，而是模拟流体“粒子”的集体行为，让界面自行涌现出来呢？

这就是[格子玻尔兹曼方法](@entry_id:142209)（LBM）背后的哲学。在LBM中，模拟域是一个网格，在每个网格点上，我们追踪沿着少数离散方向移动的虚拟粒子的布居。规则很简单：在每个时间步，粒子“迁移”到相邻的网格点，然后在每个点上“碰撞”，根据局部[守恒定律](@entry_id:269268)重新分配它们的布居。为了模拟多相，我们可以在碰撞步骤中加入一点额外的物理学。例如，Shan-Chen模型引入了一种简单的粒子间相互作用力，该力取决于局部流体密度。如果我们让这个力具有吸[引力](@entry_id:175476)，奇妙的事情就会发生：如果密度恰到好处，粒子会自发地聚集在一起，分离成一个稠密的“液”相和一个稀疏的“汽”相，它们之间形成一个稳定的界面 [@problem_id:1764347]。表面张力不是我们放入模型的东西；它是简单的、局部的相互作用规则的一种*涌现属性*。这是一个深刻的概念，反映了自然界中许多复杂现象是如何从简单的底层规律中产生的。

还有另一种非常实用的方法，可以将颗粒和连续体观点混合起来。考虑模拟发动机中的燃油喷雾或药用吸入器中的细雾。我们有一个连续的气相（空气）和由许许多多微小液滴组成的离散相。在计算上，解析每个液滴周围的界面是不可能的。取而代之，我们使用一种混合的[欧拉-拉格朗日方法](@entry_id:749107)。我们在标准的欧拉网格上对连续气相进行建模，并将液滴作为单独的拉格朗日“计算包裹”进行追踪，每个包裹代表一团相似的真实液滴。

这两种描述必须相互“对话”。气流推动液滴（曳力），当[液滴蒸发](@entry_id:748678)时，它们释放蒸汽并交换热量，从而改变气体的性质。这种交换是气体的质量和能量源。当单个液滴包裹在一个时间步内穿越多个网格单元时，一个基本问题就出现了。为了完美地守恒质量和能量，我们必须仔细计算包裹在其穿过的每个单元格中花费了多长时间。通过将包裹的质量和能量交换率在这些“[驻留时间](@entry_id:177781)”上积分，我们可以将[源项](@entry_id:269111)精确地分配到各个欧拉单元格中 [@problem_id:3364858]。这种细致的记账是耦合离散世界和连续世界的关键，使得模拟一些最重要的工业过程成为可能。

### 流动的交响曲：[湍流](@entry_id:151300)与不稳定性

流体的世界很少是平静的。它常常是[湍流](@entry_id:151300)的、混沌的，并充满了形形色色的复杂模式和不稳定性。[多相流](@entry_id:146480)也不例外；事实上，多相的存在往往使其行为更加丰富和复杂。

多相[湍流](@entry_id:151300)中最引人入胜的问题之一是相间的“[双向耦合](@entry_id:178809)”。我们知道流体流动会携带颗粒，但颗粒如何影响流动呢？你可能会直观地认为，向流体中添加颗粒总是会使其变得更迟滞和耗散。但事实更为微妙和有趣。其效果关键取决于颗粒的惯性，这由一个称为[斯托克斯数](@entry_id:185766)（$St$）的无量纲数来量化。[斯托克斯数](@entry_id:185766)比较的是颗粒的响应时间与流中湍流涡的[特征时间尺度](@entry_id:276738)。

在[大涡模拟（LES）](@entry_id:273295)中，我们可以在[计算网格](@entry_id:168560)的尺度上分析这种相互作用。[湍流](@entry_id:151300)是能量从大涡向小涡的串级。我们解析的最小涡会产生更小的、未解析的“亚格子”涡，这种能量传递必须被建模。我们可以将这种亚格子能量的产生速率与颗粒[对流](@entry_id:141806)体的曳力所耗散能量的速率进行比较。该分析揭示了一个显著的结果：当颗粒的响应时间与涡的时间尺度相似时，即当 $St \approx 1$ 时，它们在抑制[湍流](@entry_id:151300)方面最有效。太轻的颗粒（$St \ll 1$）只是跟随流动，而太重的颗粒（$St \gg 1$）几乎不对涡作出响应。但对于 $St \approx 1$ 的颗粒，它们不断地试图追赶涡，在此过程中，它们从流动中提取了最大量的能量，从而有效地抑制了[湍流](@entry_id:151300) [@problem_id:3531130]。

不稳定性也会导致被称为[流型](@entry_id:152820)的[大尺度结构](@entry_id:158990)的形成。在输送气液混合物的垂直管道中，人们可能会看到气泡在液柱中上升，或者一层薄薄的液膜附着在管壁上，中心是快速移动的气核（[环状流](@entry_id:149763)）。在高速率气流下，[环状流](@entry_id:149763)中的界面变得不稳定，大振幅的波会生长、合并和破碎，导致一种称为“搅混流”的高度混沌的[流态](@entry_id:152820)。这种转变不仅仅是一片随机的混乱；它可以通过优雅的[非线性波](@entry_id:273091)数学来理解。[液膜](@entry_id:260769)上波的速度取决于其高度。[液膜](@entry_id:260769)较厚的部分（波峰）比薄的部分（波谷）移动得更快。这导致波的后部追上其前部，引起波的变陡并最终破碎，就像海滩上的波浪一样。通过比较这种[非线性](@entry_id:637147)变陡的时间尺度与波被带过管道所需的时间，我们可以预测流动从平滑的[环状流](@entry_id:149763)过渡到混沌的搅混流的条件 [@problem_id:3301502]。这是一个美丽的物理学应用，将一个复杂的工业问题与[双曲守恒律](@entry_id:147752)的基本理论联系起来。

### 改造地球：模拟不可见之物

一些最引人注目的[多相流](@entry_id:146480)模拟应用隐藏在我们的脚下深处，不为肉眼所见。我们站立的地面不是一个实心块；它是一个多孔介质，一个由岩石和土壤组成的复杂海绵体，其孔隙中充满了水、石油和天然气等流体。模拟这些系统中的流动对于管理[地下水](@entry_id:201480)资源、开采能源以及开发像[二氧化碳封存](@entry_id:747418)这样的技术至关重要。

支配多孔介质中质量守恒的基本方程看起来很熟悉：一个累积项、一个通量项和一个源项。关键的区别在于支配流体速度的定律。流体流动不再由[Navier-Stokes方程](@entry_id:161487)描述，而是由多孔基质的[粘性阻力](@entry_id:271349)主导，并由Darcy's Law描述。该定律通过介质的渗透率将流体速度与压力梯度联系起来。当存在多种不互溶流体时，情况变得更加复杂。每个相都会干扰其他相，降低它们的流动能力。这通过[相对渗透率](@entry_id:272081)的概念来捕捉，[相对渗透率](@entry_id:272081)取决于流体饱和度。此外，由于毛细管力，流体之间的界面是弯曲的，导致相间存在压力差。一个用于可变形多孔介质中[多相流](@entry_id:146480)的完整模型必须将[质量平衡方程](@entry_id:178786)与这些基本的本构关系结合起来：多相[达西定律](@entry_id:153223)、毛管压力-饱和度曲线、流体状态方程，以及一个描述岩石本身如何在变化的压力下变形的[孔隙力学](@entry_id:175398)模型 [@problem_id:3544983]。

大自然又增加了一层复杂性。许多地质构造，如页岩储层或火山岩，是“双重孔隙”系统。它们包含岩石基质原始的、非常细粒度的孔隙（渗透率很低），以及一个具有非常[高渗](@entry_id:145393)透率的较大裂缝网络。为了模拟这样的系统，我们可以使用一个巧妙的技巧：我们想象在空间的每一点上共存着两个独立的、重叠的连续体。一个代表基质，另一个代表裂缝网络。我们为每个连续体中的每个相求解流动方程。然后，允许这两个连续体相互交换流体，交换速率由它们之间的压力差驱动 [@problem_id:3544943]。这种“双重孔隙/双重渗透率”模型是一个强大的抽象，它使我们能够捕捉这些极其复杂几何结构的基本物理特性，而无需对每一条裂缝进行建模。

但是，像渗透率这样的宏观属性最初是从哪里来的呢？我们能从岩石的微观结构中推导出它们吗？通过模拟，我们可以。我们可以从单个沙粒或岩石颗粒的位置开始。利用计算几何，我们可以构建一个Voronoi diagram，它将空间划分为围绕每个颗粒的单元。该图的对偶是Delaunay triangulation，我们可以将其解释为一个由“孔隙”（三角形）通过“喉道”（共享边）连接而成的网络。然后，我们可以模拟通过这个微观网络的简单流体流动，并对结果进行平均，以计算介质的宏观有效渗透率 [@problem_id:3377013]。这个“升尺度”过程是[多尺度建模](@entry_id:154964)的基石，为孔隙和颗粒的微观世界与Darcy's Law的宏观世界之间提供了直接的、计算上的联系。

### 超越单一答案：与不确定性共存

最后，我们必须解决一个在所有科学领域，尤其是在计算科学中具有深刻重要性的问题。当我们的模拟给出一个答案时，我们应该在多大程度上信任它？模拟是一系列模型的链条：世界的物理模型、物理的数学模型以及数学的数值模型。这个链条中的每个环节都存在不确定性。我们用作输入的物理参数——粘度、密度、[表面粗糙度](@entry_id:171005)——永远无法被完美地知晓；它们来自带有[误差棒](@entry_id:268610)的测量。

这些输入不确定性如何通过我们复杂的[非线性模型](@entry_id:276864)传播并影响输出？这就是不确定性量化（UQ）的领域。想象一下模拟在管道中流动的两[相混合](@entry_id:199798)物。[压降](@entry_id:267492)取决于[流体粘度](@entry_id:267219)和管壁粗糙度等因素。假设我们对粘度和粗糙度的认知都存在一些不确定性。哪一个不确定性对我们预测的压降影响更大？这不是一个学术问题；答案告诉我们应该把钱投到哪里去做更好的测量。使用像[敏感性分析](@entry_id:147555)这样的统计方法，我们可以运行我们的模拟数千次，从输入参数的不确定性[分布](@entry_id:182848)中进行抽样。通过分析输出的[方差](@entry_id:200758)，我们可以定量地确定总不确定性的多大比例是由每个输入参数引起的 [@problem_id:2448383]。

这使我们对模拟的本质有了一个成熟的理解。它不是一个能给出单一、完美答案的水晶球。它是一种探索可能性的科学仪器。它是一个虚拟实验室，我们可以在其中进行那些在现实世界中成本太高、太危险或根本不可能进行的“如果……会怎样”的实验。它不仅使我们能够预测结果，还能理解任何复杂系统中固有的敏感性并管理其中的不确定性。而这，正是其真正的力量所在。