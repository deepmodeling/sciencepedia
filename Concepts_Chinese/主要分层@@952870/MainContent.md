## 引言
在理想世界中，科学实验应当是完美无瑕的。作为研究黄金标准的随机对照试验，理应让我们仅通过比较处理组和[对照组](@entry_id:188599)的结果，就能分离出处理的真实效应。然而，现实世界是复杂的。参与者可能不遵守分配给他们的处理，或者像死亡这样的意外事件可能阻止我们测量结果，从而搅乱了局面，使寻求因果真相的过程变得困难重重。

处理这些随机化后并发症最直观的方法，比如只比较那些实际接受了处理的人和那些没有接受处理的人，通常存在灾难性的缺陷，会引入严重的选择偏倚，从而可能导致完全错误的结论。本文旨在填补一个关键的空白：当我们的实验设计被现实搅乱时，我们如何才能恢复一个有效的因果估计？答案就在于一个被称为“主要分层”的强大概念框架。

本文将对主要分层进行全面概述。首先，在“原理与机制”一章中，我们将剖析该框架的核心逻辑，引入潜在结果和潜在分层的概念，以解决诸如不依从性和生存偏倚等难题。随后，“应用与跨学科联系”一章将展示该框架在不同领域的卓越效用，从医学领域的外科试验和替代终点验证，到气候科学中的事件归因。为了开启我们的旅程，我们必须首先探索使这个框架能够为这个充满缺陷的世界带来清晰度的基本原则。

## 原理与机制

### 有缺陷世界的困境：治疗后的并发症

想象你是一位科学家，正在进行一项完美的实验。你发现了一种新药，相信它能让人更健康，并希望对其进行测试。你知道，黄金标准是随机对照试验。你召集了一大群人，通过为每位参与者投掷一枚宇宙硬币的方式，将他们分配到两组之一：一组服用你的新药，另一组服用外观相同的糖丸（安慰剂）。然后你坐下来，等待，并测量他们的健康状况。因为在实验开始时，由于随机化的魔力，这两组在平均上是相同的，所以最终健康状况的任何差异都必然是由你的药引起的。漂亮，简单，干净。

但现实世界很少如此干净。在你的试验中，你发现处理组中的一些人忘记服药。而安慰剂组中的另一些人因为感觉不适，去看了医生并获得了类似的药物。你实验中清晰的界限现在变得模糊了。这就是**不依从性**（non-compliance）的混乱现实。[@problem_id:4568086]

此时，最诱人、最直观的做法是什么？你可能会想：“我只比较那些*实际服用*了药物的人和所有没有服用的人，无论他们最初属于哪个组。”这被称为“符合方案”（per-protocol）分析，看起来很合理。但这却是一个灾难性的错误。它抛弃了使你的实验如此强大的随机化本身。

可以这样想：那些勤奋服用指定药物的人与那些不这样做的人可能有所不同。他们可能更注重健康，更有条理，或者有更好的支持系统。这样一来，你比较的是自律、积极的人与其他所有人。这就像比较选择去健身房的人和呆在家里的人，然后得出结论说健身房对健康有神奇的效果。也许是这样，但同样可能的是，选择去健身房的人本身就更健康、更有动力。你已经掉进了自己设下的陷阱：**选择偏倚**（selection bias）。

### 窥见矩阵：潜在结果与隐藏世界

为了摆脱这个陷阱，我们需要一种更强大的思维方式。我们需要借用科幻小说中的一个概念：多重宇宙。对于你研究中的每一个人，并非只有一个现实，而是存在多个*潜在的*现实。存在一个他们被分配服用你的药物并产生某种健康结果的现实。也存在另一个他们被分配服用安慰剂并产生（可能不同的）健康结果的现实。所谓的“因果推断的基本问题”是，对于每个人，我们永远只能观察到这些潜在世界中的一个。

现在，让我们将这个强大的想法应用到我们的不依从性问题上。在试验开始之前，每个参与者都有一个隐藏的倾向。我们可以对每个人问两个问题：
1. 如果我们将此人分配到*处理*组，他会怎么做？
2. 如果我们将此人分配到*安慰剂*组，他会怎么做？

这两个问题的答案组合是每个人固有的、预先存在的特征，就像他们的眼睛颜色一样固定。这对简单的潜在行为使我们能够将整个人群分为四个隐藏的组，或称“层”（strata）：

*   **依从者（Compliers）**：他们是遵守规则的人。如果被分配到处理组，他们会服药；如果被分配到安慰剂组，他们会服用安慰剂。在一个提供处理的研究中，他们的潜在行为是（接受，不接受）。我们将其记为 $(D(1), D(0)) = (1, 0)$。[@problem_id:4916896]
*   **始终接受者（Always-Takers）**：他们是热衷者。无论如何他们都会接受处理。即使被分配到安慰剂组，他们也会设法得到真正的药物。他们的行为是 $(D(1), D(0)) = (1, 1)$。
*   **从不接受者（Never-Takers）**：他们是拒绝者。即使你免费给他们药物，他们也不会服用。他们的行为是 $(D(1), D(0)) = (0, 0)$。
*   **违逆者（Defiers）**：他们是逆反者。他们做与被告知的相反的事情。如果被分配到处理组，他们会拒绝。如果被分配到安慰剂组，他们会去寻求处理。他们的行为是 $(D(1), D(0)) = (0, 1)$。[@problem_id:4501606]

这种根据人们对分配的潜在反应将其分入隐藏分层的行为，是**主要分层**（principal stratification）的革命性核心。我们基于一个不受随机化影响的特征对每个人进行了分类。因为这些分层是在“投硬币”*之前*定义的，随机化的魔力仍然有效：依从者、始终接受者、从不接受者和违逆者的比例在处理组和安慰剂组中完全相同。[@problem_id:4917182] 这为我们重建理解提供了一个稳定、不可动摇的基础。

### 偷窥的危险：为什么我们不能只看幸存者

不依从性问题只是科学家们所谓的“治疗后变量”的一个例子。这些变量搅乱了因果推断的清晰度。让我们考虑一个更戏剧性的案例：一项在重症监护室（ICU）中进行的挽救生命的方案的临床试验。该处理不仅可能影响患者的长期健康（如并发症），还可能影响他们当下的生存机会。[@problem_id:4640706]

假设我们想知道该方案是否能减少存活患者的并发症。天真的方法是只看处理组中的幸存者，并将他们与[对照组](@entry_id:188599)中的幸存者进行比较。但这和之前的陷阱一样，只是形式上更为悲惨。

想象一个极其严苛的宇航员培训计划。计划A强度极大，只有身体和精神最强健的候选人才能坚持到最后。计划B则容易得多，让更广泛的候选人能够毕业。如果你随后比较计划A的毕业生和计划B的毕业生在期末考试中的表现，你做的就不是一个公平的比较。你是在比较计划A中的绝对精英和来自计划B的更为平均的群体。

ICU试验也是如此。如果新方案严酷但有效，它可能会挽救那些本会死亡的病人，但也许它只挽救了最强壮的病人。[对照组](@entry_id:188599)可能会有一个不同的、不那么“被筛选过”的幸存者群体。通过比较幸存者与幸存者，你是在比较苹果和橙子。你正在对一个治疗后变量（生存）进行条件化，这引发了深刻的**选择偏倚**。

使用一种称为有向无环图（DAGs）的视觉语言，我们可以清楚地看到这个问题。患者的潜在虚弱程度（$U$）既影响他们的生存机会（$S$），也影响他们的并发症风险（$Y$）。处理（$A$）也影响生存（$S$）。[因果结构](@entry_id:159914)看起来像 $A \rightarrow S \leftarrow U \rightarrow Y$。变量 $S$ 是我们所说的**碰撞因子**（collider）——它有两个箭头指向它。最初，从 $A$ 到 $Y$ 经过 $U$ 的路径是被阻断的。但是，当我们对碰撞因子进行条件化——即只看幸存者（$S=1$）——我们就打开了 $A$ 和 $U$ 之间的一条后门路径，产生了一种虚假的关联。这就是**[碰撞偏倚](@entry_id:163186)**（collider bias）。[@problem_id:4586005]

主要分层是我们的逃生路线。我们不是对*观察到的*生存进行条件化，而是根据*潜在的*生存来定义分层：（如果接受处理的生存情况，如果不接受处理的生存情况）。这定义了一群“始终存活者”（always-survivors）——那些无论在哪一组都会存活下来的人。在这个定义明确的、随机化前的群体中，对并发症的因果效应是一个纯粹的、无混杂的量，称为**幸存者平均因果效应（Survivor Average Causal Effect, SACE）**。[@problem_id:4640706] 我们定义了一个有意义的问题，避免了比较不同类型人群所带来的偏倚。

### 可能性的艺术：找到依从者的秘密

这一切在概念上都很美妙。我们已经在隐藏的人群中定义了这些纯粹、无混杂的因果效应。但如果“始终存活者”或“依从者”这些分层是看不见的，我们又如何能测量这些效应呢？这似乎只是一个没有实际回报的智力游戏。但在这里，一点数学推理揭示了一些非凡的东西。

让我们回到我们的不依从性例子，一个鼓励接种流感疫苗的设计。A组收到一封鼓励信；B组没有。我们测量两组的[流感](@entry_id:190386)发病率。让我们思考一下总体[流感](@entry_id:190386)发病率的差异，$\mathbb{E}[Y | Z=1] - \mathbb{E}[Y | Z=0]$。谁对这个差异有贡献？

*   **始终接受者（Always-Takers）**无论是否收到信都会接种疫苗。他们的处理状态没有改变。因此，平均而言，他们对差异没有贡献。
*   **从不接受者（Never-Takers）**无论是否收到信都不会接种疫苗。他们的处理状态也没有改变。他们对差异没有贡献。
*   **违逆者（Defiers）**是那些*只在不被鼓励时*才接种疫苗的人。他们很奇怪，在许多情况下，比如一个友好的提醒活动，我们可以合理地假设他们不存在。这个假设——即没有人是违逆者——是一个关键的简化步骤，称为**单调性**（monotonicity）。它指出，处理只能帮助或对接受率没有影响，绝不会降低它：对每个人来说 $D(1) \ge D(0)$。[@problem_id:2843853]
*   这就只剩下**依从者（Compliers）**了。他们是唯一行为被鼓励信改变的人！如果被鼓励，他们会接种疫苗；如果不被鼓励，则不会。

因此，两个随机分组之间健康结果的全部差异*仅仅*是由依从者驱动的。观察到的差异实际上是疫苗对依从者的真实效应，只是被稀释在了整个人群中。

为了找到真实效应，我们需要“去稀释”它。怎么做呢？我们可以用人群中依从者的比例来除。但我们如何知道*这个比例*呢？同样的逻辑也适用！两组之间*接种率*的差异，$\mathbb{E}[D | Z=1] - \mathbb{E}[D | Z=0]$，也只由依从者驱动。这个差异恰好就是人群中依从者的比例。

这导出了一个惊人地简单而有力的结果。疫苗对依从者的因果效应是：

$$ \text{CACE} = \frac{\mathbb{E}[Y | Z=1] - \mathbb{E}[Y | Z=0]}{\mathbb{E}[D | Z=1] - \mathbb{E}[D | Z=0]} = \frac{\text{结果差异}}{\text{接受率差异}} $$

这个量通常被称为**依从者平均因果效应（Complier Average Causal Effect, CACE）**或**局部平均处理效应（Local Average Treatment Effect, LATE）**。[@problem_id:4802016] 我们已经使用随机分配作为“工具变量”，为一个隐藏的子群体分离出了纯粹的因果效应，而根本不需要识别谁是依从者。[@problem_id:4568086]

### 一点警示：局部知识的局限性

我们已经取得了一项非凡的成就：在一个混乱、不完美的世界中得到了一个真正的因果估计。但科学的智慧不仅在于找到答案，还在于理解我们回答的确切问题。

CACE/LATE是*针对依从者*的因果效应。它是一种“局部”效应。但是，依从者——那些被一封简单的鼓励信所动摇的人——能代表所有人吗？可能不能。疫苗对“始终接受者”（他们可能更注重健康）或对“从不接受者”（他们可能有不同的潜在健康状况）的效果可能会有所不同。

这对政策有深远的影响。[@problem_id:4621250] 想象一下，我们的鼓励信产生了一个高效的CACE。这是否意味着政府*强制*接种疫苗的政策会同样有效？不一定。强制接种迫使从不接受者接种疫苗。疫苗对这个不同人群的效果可能会好得多，差得多，或者一样。我们的研究得出的CACE并不能告诉我们这一点。我们测量的效应是局限于我们使用的工具（那封信）以及它所影响的人群（依从者）。

主要分层并没有给我们一把解决所有因果问题的万能钥匙。相反，它为我们提供了一台功能异常强大的显微镜。它让我们能够定义，并且在适当的条件下，以惊人的清晰度和严谨性回答非常具体的因果问题，使我们摆脱了困扰朴素分析的混杂偏倚。它的美在于其精确性——那种在有缺陷的世界中航行，并找到纯粹因果真理的精确性。

