## 引言
模拟分子和材料错综复杂的量子行为是计算科学中最艰巨的挑战之一。尽管[经典计算](@article_id:297419)机已取得长足进步，但一类“强关联”系统——在催化和[材料科学](@article_id:312640)等领域至关重要——由于其深奥的量子复杂性，至今在很大程度上仍难以处理。[变分量子本征求解器](@article_id:310736) (Variational Quantum Eigensolver, VQE) 已成为解决这些问题的主要策略，它提供了一种专为含噪声中等规模量子 (Noisy Intermediate-Scale Quantum, NISQ) 硬件的能力而设计的强大方法。作为一种混合[算法](@article_id:331821)，VQE 巧妙地将任务分配给量子处理器和[经典计算](@article_id:297419)机，为探索量子世界开辟了一条务实的途径。

本文将全面概述 VQE [算法](@article_id:331821)，引导您从其理论基础走向实际应用。在第一章**原理与机制**中，我们将剖析 VQE 的核心组成部分，从基础的[变分原理](@article_id:324104)到量子-经典优化循环的机制，以及[贫瘠高原](@article_id:303216)等固有挑战。随后的**应用与跨学科联系**一章将探讨 VQE 如何应用于[量子化学](@article_id:300637)中的开创性问题，其在计算[激发态](@article_id:325164)方面的扩展，以及在当今含噪声的量子硬件上获得有意义结果所需的关键误差缓解技术。我们将从深入研究 VQE 赖以成为近期[量子计算](@article_id:303150)基石的优雅原理开始我们的探索。

## 原理与机制

想象一下，你是一名徒步旅行者，试图在一片广阔、云雾缭绕的山脉中找到绝对最低点。你有一个[高度计](@article_id:328590)，但雾太浓，你只能看到脚下的地面。你会怎么做？你可能会朝某个方向迈出一步，检查你的高度，如果更低，你就继续前进。如果更高，你就退回并尝试另一个方向。你重复这个过程，总是寻找更低的海拔，直到找不到任何可以继续下降的路径。简而言之，这就是[变分量子本征求解器](@article_id:310736) (VQE) 背后的策略。事实证明，大自然的运作方式也与之非常相似。

### 基石：大自然的“懒惰”

VQE 的核心是整个量子力学中最优雅、最强大的思想之一：**变分原理**。其本质是，任何物理系统，比如一个分子，都会自然地稳定在其能量最低的状态，即**[基态](@article_id:312876)**。如果我们去猜测这个状态是什么样子，最好的情况是我们的猜测就是真实的[基态](@article_id:312876)。任何其他猜测，无论多么巧妙，都会对应一个能量更高的状态。

在数学上，如果我们将真实的基态能量称为 $E_0$，并对[量子态](@article_id:306563)做一个猜测，我们称之为 $|\psi(\boldsymbol{\theta})\rangle$，那么我们为这个猜测计算出的能量，我们称之为 $E(\boldsymbol{\theta})$，将总是大于或等于真实的[基态能量](@article_id:327411)：

$$
E(\boldsymbol{\theta}) = \langle \psi(\boldsymbol{\theta}) | H | \psi(\boldsymbol{\theta}) \rangle \ge E_0
$$

在这里，$H$ 是[哈密顿算符](@article_id:309231)，它只是系统总能量的量子力学表达式。这个简单的不等式是 VQE 的基石 [@problem_id:2917666]。它为我们提供了一个下限；我们永远找不到低于真实[基态能量](@article_id:327411)的能量。仅当我们的猜测 $|\psi(\boldsymbol{\theta})\rangle$ 实际上是真实的[基态](@article_id:312876)时，等式 $E(\boldsymbol{\theta}) = E_0$ 才成立。这意味着我们在[能量景观](@article_id:308140)中寻找最低点的过程有一个确定的底部。我们的目标是通过改变参数 $\boldsymbol{\theta}$ 来调整我们的猜测，使能量 $E(\boldsymbol{\theta})$ 尽可能接近 $E_0$。我们能做出的“最佳”猜测将为真实能量提供一个尽可能紧密的**上界**。

### 混合之舞：量子核心与经典大脑

VQE 并非一个纯粹的量子算法。相反，它是[量子计算](@article_id:303150)机和[经典计算](@article_id:297419)机之间的一场优美的二重奏，各自发挥其优势。这种**量子-经典混合**循环使得 VQE 非常适用于当今的含噪声中等规模量子 (NISQ) 设备。

#### 量子部分：构建猜测

“猜测”态 $|\psi(\boldsymbol{\theta})\rangle$ 并非凭空而来。它是在[量子计算](@article_id:303150)机上使用一种称为**[拟设](@article_id:363651) ([ansatz](@article_id:363651))** 的“配方”精心构建的。[拟设](@article_id:363651)是一种[参数化](@article_id:336283)的[量子线路](@article_id:312280)，即一系列量子门，其操作由一组经典参数 $\boldsymbol{\theta}$ 控制。[量子计算](@article_id:303150)机的工作是从一个简单的已知状态（例如所有[量子比特](@article_id:298377)都设置为 $|0\rangle$）开始，然后应用这条线路来制备复杂的试验态 $|\psi(\boldsymbol{\theta})\rangle$。

任何[量子演化](@article_id:377046)，因此也包括任何[量子线路](@article_id:312280)，都必须是**幺正 (unitary)** 的，这是一个关键属性。幺正操作是指保持[量子态](@article_id:306563)矢量长度不变的操作，这只是一个数学上的说法，即所有结果的总概率必须始终为 1。这意味着我们不能随便使用任何数学公式来构建我们的拟设；它必须对应一个有效的、物理上可实现的[量子线路](@article_id:312280)。这就是为什么某些拟设，如**[幺正耦合簇](@article_id:382680) (Unitary Coupled Cluster, UCC)** 方法，在[量子化学](@article_id:300637)中如此受欢迎。[UCCSD](@article_id:377469)（即包含单重和双重激发的[幺正耦合簇](@article_id:382680)）拟设本质上是一种非常成功的经典化学方法的量子原生版本。它由一个形如 $\exp(\hat{T} - \hat{T}^\dagger)$ 的算符生成，这个算符保证是幺正的。这与经典方法如[组态相互作用](@article_id:324030) (Configuration Interaction, CI) 形成鲜明对比，后者的数学形式是一个简单的线性求和，它不是幺正的，因此无法直接且确定性地作为[量子线路](@article_id:312280)来实现 [@problem_id:2452129]。

#### 经典部分：测量并改进猜测

一旦[量子计算](@article_id:303150)机准备好状态 $|\psi(\boldsymbol{\theta})\rangle$，就轮到经典计算机了。但首先，它需要数据。它需要知道当前猜测的能量 $E(\boldsymbol{\theta})$。这就是测量的用武之地，而测量本身就是一门艺术。

我们不能简单地“读出”总能量。分子的哈密顿量 $H$ 是一个极其复杂的对象，通常是成千上万个更简单的项（称为**泡利串 (Pauli strings)**）的总和。例如，一个哈密顿量可能看起来像 $H = c_1 Z_0 I_1 + c_2 X_0 Y_1 + \dots$，其中 $X$、$Y$、$Z$ 和 $I$ 是泡利矩阵。总能量是这些单独泡利串的[期望值](@article_id:313620)的总和： $E = \sum_i c_i \langle P_i \rangle$。

从表面上看，这意味着我们必须为哈密顿量中的每一个 $M$ 个泡利串执行一次单独的实验，这将非常耗时。幸运的是，量子力学提供了一个聪明的捷径：**测量分组 (measurement grouping)**。如果一组泡利串是“兼容的”（即它们在逐个[量子比特](@article_id:298377)的基础上相互对易），我们可以通过*单次*实验运行的数据测量出它们所有的[期望值](@article_id:313620)。

让我们考虑一个简单的双[量子比特](@article_id:298377)哈密顿量：$H = c_0 I + c_1 Z_0 + c_2 Z_1 + c_3 Z_0 Z_1$ [@problem_id:2932509]。有三个非单位项需要测量：$Z_0$、$Z_1$ 和 $Z_0 Z_1$。从表面上看，这需要三次独立的实验。然而，请注意，在第一个[量子比特](@article_id:298377)上，我们只有 $Z$ 或 $I$，在第二个[量子比特](@article_id:298377)上，我们也只有 $Z$ 或 $I$。由于 $Z$ 与自身以及与 $I$ 对易，所有这些项都是兼容的。我们可以通过将测量设备设置为在 $Z$ 基下同时测量两个[量子比特](@article_id:298377)来一次性测量它们。通过一个巧妙的选择，我们将实验工作量减少了三倍！对于真实的分子，这种分组可以将所需测量次数减少几个数量级，从而使一个棘手的问题变得可行。

我们还可以更聪明。哈密顿量中的并非所有项都生而平等。有些项的系数 $c_i$ 很大，因此对最终能量及其不确定性的贡献也更大。在给定的总测量“次数” (shots) $N_{\text{tot}}$ 预算下，我们应该如何将其分配给不同的项（或组）以获得最精确的能量估计？通过解决一个约束优化问题，我们发现对于给定项 $i$，最优的测量次数 $N_i^\star$ 应与其系数的[绝对值](@article_id:308102) $|c_i|$ 及其测量的[标准差](@article_id:314030) $\sigma_i$ 成正比 [@problem_id:2932479]。这种被称为**最优测量分配 (optimal shot allocation)** 的策略确保我们最有效地使用宝贵的测量预算，这是理论洞察力如何提升我们实验工具的又一个绝佳例子。

### 闭合循环：通往最小值之路

有了能量估计值，[经典计算](@article_id:297419)机就扮演起那位聪明的徒步旅行者的角色。它知道当前的海拔 $E(\boldsymbol{\theta})$。为了找到一个更低的点，它需要知道哪条路是下坡路。它需要能量景观的**梯度** $\nabla E(\boldsymbol{\theta})$，这是一个指向最陡峭上升方向的向量。要走下坡路，我们只需朝相反方向迈出一小步。这就是[基于梯度的优化](@article_id:348458)的精髓。

计算这个梯度似乎是一项艰巨的任务，但量子技巧再次派上用场：**参数平移法则 (parameter-shift rule)**。对于许多常见的参数化门类型，能量对参数 $\theta_k$ 的精确解析[导数](@article_id:318324)可以通过在两个平移后的参数值 $\theta_k + s$ 和 $\theta_k - s$ 处评估能量并取其差值来计算 [@problem_id:2398857]。

$$
\frac{\partial E}{\partial \theta_k} = \frac{1}{2} \left[ E(\boldsymbol{\theta} \text{ with } \theta_k \to \theta_k + \frac{\pi}{2}) - E(\boldsymbol{\theta} \text{ with } \theta_k \to \theta_k - \frac{\pi}{2}) \right]
$$

这个非凡的公式允许[量子计算](@article_id:303150)机直接为经典优化器计算出精确梯度的分量。这个过程是一种**线性化**：我们用一个平坦倾斜的平面来局部近似弯曲的[能量景观](@article_id:308140)，而梯度告诉我们这个平面的倾斜度 [@problem_id:2398857]。然后，经典优化器提出对参数的更新，$\boldsymbol{\theta}_{\text{new}} = \boldsymbol{\theta}_{\text{old}} - \alpha \nabla E(\boldsymbol{\theta})$，其中 $\alpha$ 是步长。这组新参数被反馈给[量子计算](@article_id:303150)机，后者制备新的状态 $|\psi(\boldsymbol{\theta}_{\text{new}})\rangle$，然后循环再次开始。这个循环不断进行，在[能量景观](@article_id:308140)上迭代地向“山下”走，直到收敛到一个最小值。

### 穿越险境：现实世界的挑战

这种平滑地下降到能量最小值的理想图景，不幸地只是一个理想。在 NISQ 时代的硬件上运行 VQE 的现实充满了挑战，这些挑战使得优化景观变得更加险恶。

首先是**散粒噪声 (shot noise)**。我们的能量值不是精确的；它是通过有限次数的测量得出的一个估计值。这种统计噪声意味着我们的[高度计](@article_id:328590)读数是[抖动](@article_id:326537)的。一个无偏估计量可能由于统计偶然性而波动，并报告一个低于真实[基态能量](@article_id:327411) $E_0$ 的能量值 [@problem_id:2917666] [@problem_id:2932513]。这并不违反[变分原理](@article_id:324104)（该原理适用于精确的[期望值](@article_id:313620)），但它会严重迷惑优化器，导致它在噪声中“追逐鬼影”。

这种噪声使得**经典优化器**的选择至关重要 [@problem_id:2932446]。像 COBYLA 或 Nelder-Mead 这样只依赖能量值的无梯度方法，可能对[噪声梯度](@article_id:352921)更具鲁棒性，但它们往往非常慢，尤其是在参数很多的情况下。像 Adam 或 [L-BFGS](@article_id:346550)-B 这样的基于梯度的方法通常更快，但如果它们的梯度（或曲率）估计被噪声破坏，其性能可能会灾难性地下降。这催生了对噪声[鲁棒优化](@article_id:343215)器的整个研究领域，包括**[自然梯度下降](@article_id:336606) (natural gradient descent)** 等先进技术，该技术会根据[量子态空间](@article_id:376681)本身的几何结构来调整步进方向。

然而，最强大的障碍也许是**[贫瘠高原](@article_id:303216) (barren plateaus)** 现象 [@problem_id:2797465]。对于大型问题，特别是使用“无结构”或非常深的拟设时，能量景观几乎在任何地方都可能变得近乎完全平坦。梯度不仅变得很小；它们在参数空间中的方差会随着[量子比特](@article_id:298377)数 $n$ 的增加而*指数级*消失。这就像试图在一个宽达数万亿平方英里、平坦度在毫米以内的沙漠中找到最低点一样。[基于梯度的优化](@article_id:348458)器会完全迷失方向，找不到任何可以遵循的方向。这是一个基本的扩展性问题，限制了简单的 VQE 方法在大规模问题上的适用性。

那么，一个给定的问题在当今的硬件上是否能用 VQE 解决？一个问题只有在能够达到微妙的平衡时才是**“适用于 NISQ (NISQ-amenable)”** 的 [@problem_id:2932502]。[拟设](@article_id:363651)线路必须足够深，以具备足够的**表达能力**来近似真实的[基态](@article_id:312876)，但又必须足够浅，以使其输出不会被硬件噪声完全扰乱。所需的测量次数必须足够多，以达到所[期望](@article_id:311378)的[化学精度](@article_id:350249)，但又必须足够少，以便整个实验可以在合理的时间预算内完成。VQE 的成功在于找到这个难以捉摸的“最佳点”。

这凸显了 VQE 的特性：它是一种出色的**启发式**方法，是利用我们今天不完美的机器探索量子世界的强大工具。它可能不具备未来[容错](@article_id:302630)[算法](@article_id:331821)如量子相位估计 (Quantum Phase Estimation, QPE) 那样可证明的有效扩展性 [@problem_id:2823813]。但是，通过其[量子态制备](@article_id:304999)和经典优化的巧妙结合，VQE 为我们提供了一种实用且富有洞察力的方式，让我们开始一次一个变分步骤地揭开分子和材料的秘密。