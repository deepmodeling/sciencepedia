## 引言
我们如何量化两个事物集合之间的差异？无论是比较购物车、生态栖息地还是科学文章，对一种简单、直观的“差异性”度量的需求是普遍存在的。这正是 Jaccard 相异性——一个源自集合论世界的简单而强大的工具——旨在解决的基本问题。它提供了一种优雅的方式，将复杂的比较归结为一个单一、有意义的数字，代表了两个集合之间的非重叠程度。本文旨在帮助读者清晰地理解这一基础度量，它虽然常用，但其内涵并非总能被完全理解。

本次探索分为两个主要部分。第一章“原理与机制”将解构 Jaccard 相异性的数学核心。我们将深入探讨其直观的公式，审视其忽略共同缺失项的关键决策，将其与相关指数进行比较，并确认其作为真正数学“距离”的地位。随后，在“应用与跨学科联系”一章中，我们将展示这一概念卓越的通用性，带领我们从购物篮分析和[文本挖掘](@article_id:639483)，到分子化学和生物[物种分类](@article_id:327103)进行一次跨界之旅。读完本文，您不仅将理解如何计算 Jaccard 相异性，还将领会为何它在如此多不同领域中都是数据分析的基石。

## 原理与机制

想象一下，你和一位朋友去一个巨大、广阔的图书馆，各自收集一批关于物理学的书籍。之后，你们想比较各自的选择。你们的藏书有多大不同？这是一个简单的问题，但答案可能出人意料地深刻。你可以只计算你们都选了多少本书，但这感觉并不完整。只被你选中的书呢？或者只被你朋友找到的书呢？还有图书馆里成千上万本你们都没碰过的书呢？我们如何将所有这些信息编织成一个单一、优雅的数字，来捕捉你们选择的“差异性”？

这正是 Jaccard 相异性旨在解决的那类问题。它是从集合论简单而强大的思想中锻造出的一个优美的工具。

### 比较的本质：计算重要的部分

Jaccard 指数的核心在于计数。让我们将我们的图书馆之行形式化。你的藏书是一个集合，我们称之为 $A$。你朋友的藏书是集合 $B$。要比较它们，我们需要考虑两个基本量：

1.  **交集**，写作 $|A \cap B|$，即你们*都*选择的书的数量。这是你们的共同点。
2.  **并集**，写作 $|A \cup B|$，即你们两人选择的*所有唯一*书籍的总数。如果你们都拿了 *Feynman's Lectures*，在这个总数中它只被计算一次。这是你们在图书馆留下的集体智慧足迹。

**Jaccard 相似性指数** $S_J$ 是可以想象的最直接的比较：它是你们的共同点与你们集体足迹的比率。

$$
S_J = \frac{|A \cap B|}{|A \cup B|}
$$

它给你一个介于 $0$（你们没有选择任何共同的书）和 $1$（你们选择了完全相同的书集）之间的数字。但我们追求的是*相异性*——一种差异的度量。这也同样简单。**Jaccard 相异性** $D_J$ 只是相似性的补集。

$$
D_J = 1 - S_J = 1 - \frac{|A \cap B|}{|A \cup B|} = \frac{|A \cup B| - |A \cap B|}{|A \cup B|}
$$

一点[集合论](@article_id:298234)的魔法揭示，分子 $|A \cup B| - |A \cap B|$ 正是只存在于任一集合中的项目数量——即你选了而你朋友没选的书，加上你朋友选了而你没选的书。经常使用该度量的生态学家们为此有一套非常简洁的表示法 [@problem_id:2470383] [@problem_id:2538304]。他们计算：

-   $a$：在**两个**群落中都存在的物种数量（交集）。
-   $b$：**仅**在第一个群落中存在的物种数量。
-   $c$：**仅**在第二个群落中存在的物种数量。

用这种语言表示， $|A \cap B| = a$ 且 $|A \cup B| = a + b + c$。Jaccard 相异性变为：

$$
D_J = \frac{b+c}{a+b+c}
$$

这是一个非常直观的公式：相异性是总合并集合中*未*共享部分所占的比例。

### 忽略的智慧：为何共同缺失项不计入

让我们回到图书馆。那里有成千上万本书，从化学到历史再到诗歌，你们俩一本都没拿。你们都忽略了 *A History of Pottery* 这一事实，是否应该让你们的物理学藏书看起来更相似？当然不应该。这是不相关的信息。

Jaccard 相异性优雅地捕捉了这种直觉。请注意，公式 $D_J = \frac{b+c}{a+b+c}$ 并未提及第四个量：两个集合中都缺失的项目数量（我们称之为 $d$）。这不是疏忽，而是一个关键的设计特性。

考虑从两个不同宿主的肠道中采样的两个[微生物群落](@article_id:347235) [@problem_id:2806647]。世界上潜在的微生物列表几乎是无限的。它们中的大多数将同时在两个样本中都缺失。如果我们的相异性度量受到这些“共同缺失项”的影响，任何两个样本都会显得几乎完全相似，因为它们都将以共同缺失数百万个物种为特征。这将冲淡实际存在的少数物种之间的有意义的差异。

通过只关注存在项——即并集中的项目——Jaccard 指数充当了一种**非对称指数**。它表明，要判断两个集合是否相似，我们只关心*存在*什么的证据，而不关心那份无穷无尽的*不存在*什么的列表。这一特性使其在比较栖息地中的物种、文档中的词语或购物车中的商品等场景中非常强大，因为在这些场景中，可能性的范围是巨大的，而实际存在的项目是稀疏的。

### 权重问题：Jaccard 与其相关指数的比较

Jaccard 指数并非比较集合的唯一方法。一个与它密切相关的是 **Sørensen-Dice 相异性**，$D_S$。使用相同的生态学表示法，其公式为：

$$
D_S = \frac{b+c}{2a+b+c}
$$

这两个公式看起来惊人地相似，唯一的区别在于分母中变量 $a$ 的系数为 $2$ [@problem_id:2470383]。这个看似微小的变化意味着什么？它改变了比较的整个理念。在 Sørensen 的分母中，共享项目 ($a$) 被有效地计算了两次（因为它出现在每个集合中），而独特项目 ($b$ 和 $c$) 只被计算一次。

你可以这样理解：在计算用于[归一化](@article_id:310343)的“总量”时，Jaccard 为存在于任一集合中的每个唯一项目投一票。Sørensen 则为每个共享项目投两票，为每个唯一项目投一票。通过给予共享项目更多权重，只要至少有一个共享项目和一个唯一项目，Sørensen 指数总会判定两个集合比 Jaccard 指数判定的更相似（或更不相异）。

例如，比较两个群落，其中 $a=2, b=1, c=1$，Jaccard 相异性为 $D_J = \frac{1+1}{2+1+1} = \frac{1}{2}$。而 Sørensen 相异性为 $D_S = \frac{1+1}{2(2)+1+1} = \frac{2}{6} = \frac{1}{3}$。差异完全在于分母的侧重点。这一细微变化也使得 Sørensen 指数在数学上对共享物种数量的变化更为敏感 [@problem_id:2538304]。没有哪个指数是唯一“正确”的；选择取决于你是否想为共同拥有的项目给予额外的加分。

### 它是真正的“距离”吗？三角检验

我们使用了“相异性”这个词，但我们能把 Jaccard 值看作一个真正的“距离”吗？就像地图上两个城市之间的物理距离一样。在数学中，一个度量要成为一个合格的**度量 (metric)**，它必须遵守几个简单的规则。最著名的是**三角不等式**：两点之间的[最短路径](@article_id:317973)总是一条直线。也就是说，对于任意三个点 A、B 和 C，从 A 到 C 的距离必须小于或等于从 A 到 B 的距离加上从 B 到 C 的距离。

$$
d(A, C) \le d(A, B) + d(B, C)
$$

Jaccard 相异性是否通过了这个检验？让我们来看看。想象我们有三个机器学习模型，我们正在比较它们使用的预测性特征集，我们称之为 $F_1$、$F_2$ 和 $F_3$ [@problem_id:1552602]。我们可以计算每对之间的 Jaccard 相异性：$d(F_1, F_2)$、$d(F_2, F_3)$ 以及“直接”路径 $d(F_1, F_3)$。[三角不等式](@article_id:304181)告诉我们，通过模型 $F_2$ 的“绕行”路径不能比直接路径更短。

事实证明，Jaccard 相异性*总是*满足[三角不等式](@article_id:304181)。它是一个真正的度量。这是一个了不起的结果。这意味着我们可以使用 Jaccard 相异性来创建一个项目的几何“空间”。如果我们在比较文档，我们可以将每个文档想象成一个点，Jaccard 相异性就是它们之间的距离。这使我们能够使用强大的几何和[聚类算法](@article_id:307138)，并确信我们对“差异性”的度量在数学上和直觉上都是可靠的。这是集合的抽象世界与几何的具象世界之间一个美丽的联系。

### 房间里的大象：当丰度重要时

Jaccard 指数最大的优点同时也是其最显著的局限：它对丰度不敏感。它作用于**有无数据**。一个物种存在是 `1`；不存在是 `0`。无论是一个个体还是一百万个个体，都只是一个 `1`。

考虑一项关于伐木对森林影响的研究 [@problem_id:1830491]。未受干扰的地块可能有 150 个冠层树种的个体。在旁边的伐木地块中，这些树只剩下 25 棵，该区域现在由 70 个快速生长的[先锋物种](@article_id:300788)的个体主导，而这些物种以前是罕见的。从有无数据的角度来看，可能没有太大变化。如果只有一个物种消失，一个物种新增，那么 Jaccard 相异性会很低。

但森林已经发生了巨大变化！为了捕捉这一点，我们需要一个对丰度敏感的度量，比如 **Bray-Curtis 相异性**。它的逻辑也很直观：它将每个物种计数的绝对差值相加，然后除以两个地块中所有个体的总数。

$$
D_{BC} = \frac{\sum |n_{iA} - n_{iB}|}{\sum (n_{iA} + n_{iB})}
$$

对于伐木情景，Bray-Curtis 值会很高，反映了群落主导者的巨大转变。

这一选择的后果是深远的，尤其是在[聚类分析](@article_id:641498)等领域。想象一下，你有四个生态群落，其[物种丰度](@article_id:357827)如下 [@problem_id:3109568]：

-   群落 A：物种 1：**100**，物种 2：**1**
-   群落 B：物种 1：**1**，物种 2：**100**
-   群落 C：物种 3：**100**，物种 1：**1**
-   群落 D：物种 3：**98**，物种 4：**1**

如果我们使用 Jaccard 相异性对它们进行聚类，它只看到物种列表。群落 A 和 B 都包含{物种 1, 物种 2}。它们的 Jaccard 相异性是 $0$——它们是相同的！它们会最先被聚类在一起。

如果我们使用 Bray-Curtis，它会看到丰度。它会发现 A 和 B 极为不同（$D_{BC} \approx 0.98$），因为它们由完全不同的物种主导。相反，它会发现 C 和 D 非常相似（$D_{BC} = 0.02$），因为两者都绝大多数由物种 3 主导。Bray-Curtis 会将 C 和 D 聚类在一起。

因此，度量的选择不仅仅是一个技术细节。它是一种意图的声明。它回答了这样一个问题：*你关心哪种差异？* 你是对组件的简单清单感兴趣吗？使用 Jaccard。你是对功能结构感兴趣，其中最丰富的组件定义了系统吗？那么像 Bray-Curtis 这样的度量就是你的工具。理解这些原理是正确使用这些强大思想并发现隐藏在数据中真实模式的关键。

