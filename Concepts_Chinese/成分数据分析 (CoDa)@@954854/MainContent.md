## 引言
以比例（即整体的百分比）形式呈现的数据在科学中无处不在，从岩石的成分到我们肠道的微生物构成。这种格式感觉很直观，但它隐藏着一个基本的统计陷阱，可能导致研究人员得出错误的结论。所有部分的总和必须为 100% 这一约束在数学上迫使各组分之间产生一种人为的负相关关系，这一现象长期以来被称为“闭合问题”。这会掩盖真实效应并制造[虚假相关](@entry_id:755254)，使得标准统计分析具有危险的误导性。

本文旨在提供一份全面的指南，通过[成分数据分析](@entry_id:152698) (CoDa) 来理解和克服这一挑战。CoDa 是一个强大的框架，它彻底改变了科学家处理相对数据的方式。在接下来的章节中，您将发现这种变革性方法背后的优雅原理。在“原理与机制”一章中，我们将探讨 CoDa 的理论基础，从[伪相关](@entry_id:755254)问题到 John Aitchison 涉及对数比率变换的开创性解决方案。随后，“应用与跨学科联系”一章将展示 CoDa 影响的惊人广度，介绍其在医学、基因组学、流行病学和地球化学等不同领域中解锁新发现的应用。

## 原理与机制

想象一下，你是一名侦探，正在调查一个复杂的生态系统，比如我们肠道内熙熙攘攘的微生物城市。你的实验室给了你一份报告，列出了其中的居民，但不是以绝对数量，而是以占总人口的百分比。你看到 *Bacteroides* 占 30%，*Prevotella* 占 20%，*Ruminococcus* 占 15%，等等，所有这些加起来正好是 100%。还有什么比这更简单的吗？这感觉像是一幅完整、直观的图景。然而，这种表面的简单性是一种美丽的错觉，是一个能够以最令人惊讶的方式扭曲现实的统计哈哈镜。这就是**[成分数据](@entry_id:153479)**的世界，学会看穿它的扭曲是现代数据分析中最深刻的转变之一。

### 比例的哈哈镜

让我们通过一个思想实验走进这个哈哈镜，这个实验的灵感来自医学领域的一个真实挑战 [@problem_id:4367944]。假设一种新药的疗效取决于一种单一的肠道微生物，我们称之为 *Metabolizerus* A，它能产生一种激活该药物的酶。我们监测一组患者，并追踪他们的药物反应和[肠道微生物组](@entry_id:145456)的百分比构成。

在我们的实验中，发生了一件奇怪的事。每位患者肠道中 *Metabolizerus* A 细胞的*实际数量*保持完全恒定，根本没有变化。然而，还有另一种微生物 *Inerticus* B，由于饮食差异，其种群数量在不同人之间剧烈波动。现在，看看报告中会发生什么。当一个患者吃了大量纤维时，他们的 *Inerticus* B 种群数量激增。由于报告必须显示总和为 100% 的百分比，因此其他每种微生物的*百分比*都必须下降，以便为 *Inerticus* B 腾出空间。这其中就包括我们的主角 *Metabolizerus* A。

因此，在 *Inerticus* B 含量高的患者中，报告显示 *Metabolizerus* A 的百分比较低。而在 *Inerticus* B 含量低的患者中，报告显示的 *Metabolizerus* A 百分比较高。如果我们天真地将 *Metabolizerus* A 的百分比与药物疗效绘制成图，我们可能会发现一个惊人的相关性！我们可能会宣称，这种微生物的比例越高，药物反应就越好。但我们错了。这种相关性只是一个幽灵，是一个由完全不相关的微生物波动所产生的统计假象。真正的致因，即 *Metabolizerus* A 的绝对丰度，根本没有改变。罪魁祸首不是生物学，而是分母。

### 整体的暴政：一个百年难题

这种被称为**闭合问题**的现象是[成分数据](@entry_id:153479)的核心挑战。所有部分必须总和为一个常数（如 1 或 100%）的约束，在数学上迫使它们之间形成负相关关系。这就像一个固定大小的派：一块更大的苹果派*必然*意味着一块更小的樱桃派，即使世界上苹果和樱桃的供应是完全独立的。这种被迫的负相关会掩盖真实的关系，并制造虚假的关系。

这不是一个新发现。伟大的统计学家 Karl Pearson 早在 1897 年就警告过这些“[伪相关](@entry_id:755254)”。近一个世纪以来，使用[成分数据](@entry_id:153479)的科学家——从分析岩石成分的[地球化学](@entry_id:156234)家到研究基因表达的生物学家——都意识到了这个问题，但一个严谨的解决方案仍然遥不可及 [@problem_id:4082581]。对原始比例使用像 Pearson 相关或线性回归这样的标准统计工具，就像试图用直尺测量曲面；你得到的答案是系统性错误的。

### 相对世界的新几何学

突破来自 20 世纪 80 年代，一位名叫 John Aitchison 的苏格兰数学家。他的见解既深刻又优雅：如果一个成分中的绝对值没有意义，只有它们的相对比例才重要，那么信息的基本单位就不是一个组分的值，而是组分之间的**比率**。在我们的实验中，即使百分比变得一团糟，*Metabolizerus* A 与其他一些稳定微生物的比率也会保持不变。

Aitchison 意识到，成分并不存在于我们日常直觉中熟悉的平坦空间（称为欧几里得空间）中。它们生活在一个名为**单纯形**的不同几何对象上——对于三个部分，它是一个三角形；对于四个部分，它是一个四面体。要在这个表面上正确地进行数学运算，我们需要一种新的算术。这个现在被称为**Aitchison 几何**的新框架，建立在两个不可动摇的原则之上：

1.  **[尺度不变性](@entry_id:180291)**：无论我们处理的是原始计数、百分比还是[百万分率](@entry_id:139026)，我们的分析都必须给出相同的结果。唯一重要的是比率。
2.  **子成分[相干性](@entry_id:268953)**：我们关于少数几个组分（比如 *Bacteroides* 和 *Prevotella*）之间关系的结论，不应该因为我们决定从分析中移除第三个组分（*Ruminococcus*）并重新计算剩余部分的百分比而改变 [@problem_id:4841153]。在我们的思想实验中，任何对两种产生短链脂肪酸的细菌之间关系的有效分析，都不应该因为生物信息学家将“其他”类别的微生物细化为一千个新物种而受到影响 [@problem_id:4841153]。原始比例在这个测试中惨败，但 Aitchison 的几何学却完美通过。

### 变换工具：从单纯形到空间

Aitchison 的天才不仅在于定义了问题，还在于提供了解决问题的工具。其策略是将受约束的单纯形“展开”到一个熟悉的、不受约束的欧几里得空间中。这是通过**对数比率变换**来完成的。一旦数据进入这个新空间，我们那些值得信赖的旧统计工具就又能完美地工作了。

#### 中心对数比率 (CLR)：一种民主的[参考标准](@entry_id:754189)

这些工具中最直观的是**中心对数比率 (CLR) 变换**。这个想法很简单：我们不再将一个组分与那个不可靠的“整体”进行比较，而是将其与一个稳定的、民主的参考标准——即该样本中所有同伴的平均值——进行比较。但对于[乘性](@entry_id:187940)的、基于比率的数据，什么样的平均值才是正确的呢？不是算术平均值，而是**几何平均值**。

一个成分 $\mathbf{x} = (x_1, x_2, \dots, x_D)$ 的几何平均值 $g(\mathbf{x})$ 由 $g(\mathbf{x}) = \left(\prod_{i=1}^{D} x_i\right)^{1/D}$ 给出。单个组分 $x_i$ 的 CLR 变换就是其对数相对于几何平均值对数的值 [@problem_id:4527050]：

$$
\mathrm{clr}(x_i) = \ln(x_i) - \ln(g(\mathbf{x})) = \ln\left(\frac{x_i}{g(\mathbf{x})}\right)
$$

这个值告诉我们一个组分是比该特定样本中的“典型”组分更丰富还是更稀少，以及在乘法尺度上相差多少。这种变换具有优美的对称性；它平等地对待所有组分。因为它建立在比率之上，所以它拥有子成分[相干性](@entry_id:268953)的关键属性。事实上，如果我们取两个看似不同的成分，如 $\mathbf{x} = (0.20, 0.30, 0.50)$ 和 $\mathbf{y} = (0.10, 0.15, 0.75)$，我们会发现它们的内部比率结构是相同的（$0.2/0.3 = 0.1/0.15 = 2/3$）。一个天真的分析会认为它们是不同的。但如果我们只分析前两个部分的子成分，两个成分都会重新归一化为完全相同的向量 $(0.4, 0.6)$。基于 CLR 的分析从一开始就正确地识别出它们潜在的相似性 [@problem_id:4565584]。

#### 加性对数比率 (ALR)：一个金标准

有时，我们有一个“金标准”——一个我们认为是不变的或我们知道其数量的组分。一个绝佳的例子是使用合成的 **spike-in（[内参](@entry_id:191033)）** 微生物，在测序前以已知、固定的量添加到每个样本中 [@problem_id:4584543]。在这种情况下，我们可以使用**加性对数比率 (ALR) 变换**，即简单地将其他每个组分与这个已知的参考物取比率。

让我们回到我们的侦探工作。我们有每种微生物 $i$ 的观测计数 $C_i$，并且我们知道真实（但未知）的绝对丰度是 $N_i$。它们之间的联系是一个样本特定的缩放因子 $k$（“测序深度”）：$C_i = k \cdot N_i$。因子 $k$ 在样本之间剧烈变化，是我们问题的根源。但现在考虑使用具有恒定绝对丰度 $N_S$ 的 spike-in 内参 $S$ 进行 ALR 变换：

$$
\mathrm{alr}(i) = \ln\left(\frac{C_i}{C_S}\right) = \ln\left(\frac{k \cdot N_i}{k \cdot N_S}\right) = \ln\left(\frac{N_i}{N_S}\right) = \ln(N_i) - \ln(N_S)
$$

那个捣蛋的缩放因子 $k$ 完全被消掉了！由于 $\ln(N_S)$ 对所有样本来说都是一个常数，所以经过 ALR 变换的值现在与真实绝对丰度的对数 $\ln(N_i)$ 完全成正比。我们已经逃离了哈哈镜，正在看到现实的真实反映。在一个假设的研究中，将此方法应用于数据可以表明，一个在原始计数中看起来减少的分类单元 B 实际上是稳定的，而另一个其变化被测序深度掩盖的分类单元 A 则被揭示出有真实的 10 倍增长 [@problem_id:4584543]。

这些变换，包括一个更抽象但更强大的版本，称为**等距对数比率 (ILR) 变换**，是解锁单纯形的关键，使我们能够将现代统计学的全部力量应用于[成分数据](@entry_id:153479) [@problem_id:5132027]。

### 在成分世界中，“距离”是什么？

一个自然的问题随之而来：两个成分之间有多“不同”？例如，一个病人的微生物组在治疗后改变了多少？简单地减去百分比是具有误导性的。真实、有原则的距离是 **Aitchison 距离**。它的定义非常简单：它就是在两个成分被转换到 CLR 坐标*之后*，它们之间的标准欧几里得距离 [@problem_id:4771999]。这是通过正确的几何透镜感知的“真实”距离。

### 房间里的大象：零值问题

还有一个最后的、至关重要的细节。整个对数比率框架都建立在取对数的基础上，但我们不能对零取对数。而在许多真实世界的数据集中，尤其是在微生物组测序中，零值无处不在。一个微生物可能真的不存在，或者它可能存在但浓度太低，我们的仪器无法检测到。

这是一个深刻而困难的问题。一个常见的实用修补方法是在计算比例之前，给所有的计数加上一个微小的、任意的数字——一个**伪计数**。这消除了零值，使得数学运算可以继续进行。然而，这是一个不完美的解决方案。伪计数的选择并非无足轻重；不同的选择可能导致不同的距离，并可能得出不同的结论，尤其是在处理含有许多稀有分类单元的非常稀疏的数据时 [@problem_id:4562778]。

这凸显了科学是一个不断完善的过程。现在存在更先进、更有原则的方法，通常借鉴贝叶斯统计 [@problem_id:4774935]。这些方法不仅仅是替换零；它们建立了一个明确考虑检测不确定性的模型，将零值不视为确定的缺失，而是视为“低于检测限的计数”。这代表了[成分数据分析](@entry_id:152698)的前沿，我们在这里努力以日益增加的数学和哲学严谨性来处理真实数据的混乱。

