## 应用与跨学科联系

既然我们已经掌握了[期望最大化算法](@article_id:344415)的内部工作原理——这个在猜测缺失部分和提炼模型之间的巧妙两步舞——你可能会想：“这确实是个巧妙的数学技巧，但它到底有什么*用*？”这是我最喜欢的部分。这就像学习一个强大的新动词。一旦你理解了它，你就会开始发现到处都有使用它的机会。事实证明，世界充满了缺失的数据，而EM是我们在此情况下进行推理的最优雅的工具之一。

让我们进行一次小小的巡礼，看看这个[算法](@article_id:331821)在实践中的应用。你会被它的多功能性所震惊。这证明了科学思想的统一性，即完全相同的推理模式可以帮助我们重建生命的历史，计算看不见的动物数量，并引导航天器穿越宇宙。

### 遗传学与生物学：窥探无形的密码

也许没有任何地方比生命密码的研究中信息更关键，也更频繁地不完整。大自然并不总是把它的底牌摆在桌面上，但EM帮助我们推断她手中握着什么。

一个优美而简单的起点是群体遗传学中的一个常见问题。我们从一个群体中抽取样本，并对它们的特定基因进行基因分型。但有时，对少数个体的基因分型过程会失败。我们知道它们存在，但它们的[遗传信息](@article_id:352538)是缺失的。我们该怎么办？我们可以直接丢弃那些样本，但这感觉很浪费。[EM算法](@article_id:338471)为我们提供了一种更有原则的方法。在E步中，我们使用当前对群体中等位基因频率的最佳猜测（在[哈迪-温伯格平衡](@article_id:302422)模型下）来“填补”缺失基因型的[期望计数](@article_id:342285)。在M步中，我们使用这些填补好的“完整”数据来获得对[等位基因频率](@article_id:307289)的更好估计。我们来回往复，直到我们的估计值不再变化。这是一种处理数据收集中实际麻烦的简单而强大的方法[@problem_id:2804180]。

但缺失的信息往往比一次失败的测量更微妙。考虑单倍型的问题。单倍型是在单条[染色体](@article_id:340234)上发现的特定等位基因序列。当我们对一个个体的[二倍体](@article_id:331756)基因组进行测序时，我们了解到他们的基因型——例如，他们在某个位点上是杂合的（比如$Aa$），在另一个位点上也是杂合的（$Bb$）。但这并不能告诉我们哪些等位基因在同一条[染色体](@article_id:340234)上一起传递。他们是遗传了一条带有$A$和$B$等位基因的[染色体](@article_id:340234)（$AB$），而另一条带有$ab$吗？还是他们遗传了$Ab$和$aB$？第一种情况称为“相引相”，第二种称为“相斥相”。原始的基因型数据并不能告诉我们相位；这个信息是潜在的。

这是EM的典型任务！该[算法](@article_id:331821)将这些双杂合个体的未知相位视为[缺失数据](@article_id:334724)。E步使用群体中所有单倍型频率的当前估计值，来计算一个$AaBb$个体是$AB/ab$类型与$Ab/aB$类型的概率。然后M步使用这些概率性分配，通过简单地加权计数来重新计算单倍型频率。这个迭代过程使我们能够估计整个单倍型的频率以及连锁不平衡等重要指标，后者告诉我们某些等位基因被一起遗传的频率——这是[遗传图谱](@article_id:302459)和关联研究的基石[@problem_id:2401311]。

同样的想法可以扩展到[基因组学](@article_id:298572)中最现代的挑战。当我们进行[RNA测序](@article_id:357091)（RNA-seq）来测量基因表达时，我们将数百万个[RNA转录](@article_id:361745)本打碎成微小片段，对它们进行测序，然后试图弄清楚它们来自哪里。问题是，许多基因有多个[剪接](@article_id:324995)变体（亚型），一个短读长可能完美地匹配到其中几个。这个读长到底来自哪个[转录](@article_id:361745)本？读长的真实来源是潜在变量。EM应运而生，将这个问题视为一个巨大的混合模型。在E步中，它根据这些[转录](@article_id:361745)本当前的丰度估计，将每个多重匹配的读长概率性地分配给其可能的来源[转录](@article_id:361745)本。在M步中，它根据这些分配更新丰度估计。这是许多广泛使用的[转录](@article_id:361745)本定量工具背后的引擎[@problem_id:2848909]。几乎完全相同的逻辑也适用于免疫学，其中对[T细胞](@article_id:360929)和[B细胞受体](@article_id:362718)的多样化库进行测序因测序错误而变得复杂。EM可以用来从观测到的计数中“[解卷积](@article_id:300181)”出每个受体[克隆型](@article_id:368668)的真实计数，观测计数是真实信号和错误分配读长的混乱混合物[@problem_id:2886946]。

对隐藏遗传原因的探索甚至更深入。假设我们试图找到一个[数量性状](@article_id:305371)位点（QTL）——一个与身高或疾病风险等性状相关的DNA区域。我们无法直接看到QTL基因型，但我们可以看到它对表型的影响。我们也可以看到附近遗传标记的基因型。QTL基因型是潜在变量，它的状态影响我们观察到的表型的[概率分布](@article_id:306824)（例如，在该位点基因型为$QQ$的个体可能比$qq$的个体平均身高更高）。[EM算法](@article_id:338471)提供了一个称为区间作图的绝妙框架来解决这个问题。E步使用侧翼标记数据和当前模型参数来计算每个个体每种可能QTL基因型的[后验概率](@article_id:313879)。然后M步使用这些概率作为权重，重新估计每种QTL基因型对表型的影响。通过沿着[染色体](@article_id:340234)滑动这个分析，我们可以创建一个“LOD得分”剖面图，在隐藏QTL最可能的位置显示出峰值[@problem_id:2824635]。

### 生、死与种群：计算不可数之物

EM的范围超越了遗传学，延伸到更广泛的生命研究中。在生物统计学和医学领域，一个常见的挑战是[生存分析](@article_id:314403)。想象一项测试新药的[临床试验](@article_id:353944)。研究持续五年。一些患者不幸可能在研究期间去世；对他们，我们有确切的生存时间。但其他患者在研究结束时仍然活着。我们知道他们存活了*至少*五年，但我们不知道他们最终何时会去世。他们的数据是“[右删失](@article_id:344060)”的。我们如何利用这些不完整的信息来估计平均生存率？

EM将删失患者真实但未观察到的生存时间视为潜在变量。如果我们假设生存时间遵循[指数分布](@article_id:337589)，那么该分布的[无记忆性](@article_id:331552)使得E步异常优雅。一个已存活到研究结束的[删失](@article_id:343854)患者，其预期的额外生存时间可以从当前对生存率参数的估计中计算出来。然后M步使用这些“补全”的生存时间（对已故者使用观察到的时间，对存活者使用观察到的时间加上预期的额外时间）来获得一个新的、改进的率参数估计[@problem_id:2388747]。

也许最令人费解的应用是在生态学中，我们常常想知道一些看似不可能的事情：当无法找到所有动物时，一个种群中有多少只动物？在一个标记-重捕研究中，我们捕捉一些动物，标记它们，然后放生。稍后，我们再捕捉另一批，看看有多少是标记过的。但这个简单的模型假设所有动物被捕捉的可能性都相同。如果有些是“易捕获型”，而另一些是“难捕获型”呢？这种异质性会搞乱我们的估计。

我们可以将这种情况建模为两个（或更多）未观察到的动物类别的混合体，每个类别都有自己的捕获概率。然后，[EM算法](@article_id:338471)不仅可以估计捕获概率和每个类别中动物的比例，还可以估计总种群大小$N$。在这里，缺失数据是双重的：首先，对于我们*确实*捕获到的每只动物的类别成员资格（易捕获型或难捕获型）；其次，是我们*从未*捕获到的$N-n$只动物的存在本身！E步概率性地将被捕获的动物分配到一个类别，并且至关重要的是，估计未见动物中可能属于每个类别的数量。然后M步更新所有参数，包括总种群大小$N$。这是一项了不起的统计侦探工作，让我们能够从可见的模式中估计出不可见的大小[@problem_id:2523169]。

### 工程与控制：驯服噪声信号

以免你认为EM只适用于生物学家，让我们转向工程、信号处理和控制理论的世界。在这里，潜在变量通常是一个动态系统真实的、未被观察到的“状态”，只能通过有噪声的测量来访问。想象一下追踪一颗卫星：它真实的位置和速度构成了状态，但我们的雷达读数总是不完美的。

著名的[卡尔曼滤波器](@article_id:305664)是估计线性系统状态的首选工具。但是，如果我们不知道系统本身的属性呢？例如，如果我们不知道扰动[卫星轨道](@article_id:353829)的随机[颠簸](@article_id:642184)（[过程噪声](@article_id:334344)，$Q$）的方差，或者测量误差（$R$）的方差呢？

EM再次提供了解决方案。在这里，整个时间序列的真实状态$x_{0:T}$是[缺失数据](@article_id:334724)。该[算法](@article_id:331821)在其E步中使用了一个更复杂的工具：一个[固定区间平滑](@article_id:380135)器（如[Rauch-Tung-Striebel平滑器](@article_id:302819)），它使用从头到尾的所有测量值来获得每个时间点状态的最佳概率估计。然后，在M步中，这些状态的“平滑”估计被用来计算噪声[协方差矩阵](@article_id:299603)$Q$和$R$的新的[最大似然估计](@article_id:302949)[@problem_id:779262] [@problem_id:2750116]。这种平滑器（用于E步）和EM（用于M步）的组合是[系统辨识](@article_id:324198)的标准技术——也就是说，从观察到的博弈中学习“游戏规则”。

这个框架的美妙之处在于其普适性。当系统是非线性时，[卡尔曼平滑器](@article_id:303826)不再适用。但EM的配方仍然有效！我们只需要一个不同的工具来进行E步。我们可以使用先进的[蒙特卡洛方法](@article_id:297429)，如粒子平滑器，来近似所需的[期望](@article_id:311378)。然后M步继续进行，使用这些基于粒子的近似来更新我们的参数估计。EM和粒子方法的这种结合推动了前沿，使我们能够学习描述从金融市场到天气模式等一切事物的复杂、非[线性随机系统](@article_id:363989)的参数[@problem_id:2990105]。

### 扩展框架：发现结构

到目前为止，我们已经使用EM来估计数值参数——频率、丰度、速率、方差。但它能做的更多吗？它能帮助我们发现*结构*吗？答案是肯定的。

考虑系统发育学的宏大挑战：从现代物种的DNA序列重建生命进化树。[系统发育树](@article_id:300949)不是一个数字；它是一个离散的组合对象，一个*拓扑结构*。模型的参数包括这个拓扑结构、其分支的长度以及DNA[替换模型](@article_id:356723)的参数。潜在变量包括树内部节点上所有早已灭绝的祖先物种的序列。

可以设计一种“结构EM”[算法](@article_id:331821)来解决这个问题。在E步中，我们做我们以前做过的事情：使用当前的树，我们计算预期的祖先状态。但在M步中，我们做一些新的事情。我们不仅优化连续的[分支长度](@article_id:356427)和替换参数，而且还对树的拓扑结构本身进行[局部搜索](@article_id:640744)。例如，我们可能会考虑所有与我们当前树相距一个“最近邻交换”（NNI）的拓扑。对于每个候选拓扑，我们找到最大化我们[目标函数](@article_id:330966)（$Q$函数）的最佳连续参数。然后我们采用[能带](@article_id:306995)来最大改进的新拓扑和参数。通过迭代，我们不仅在参数空间中攀登似然[曲面](@article_id:331153)，而且在参数和树结构的联合空间中攀登。这种强大的泛化将EM从一个单纯的估计器转变为一个结构发现的引擎[@problem_id:2388814]。

### 一场普适的舞蹈

从[染色体](@article_id:340234)的隐藏相位到森林中看不见的居民，从火箭的真实轨迹到生命之树本身的分支模式，[期望最大化算法](@article_id:344415)提供了一种单一、统一的策略。它教会我们在面对不完整信息时如何取得进展。这是一个严谨的想象与修正的过程：根据你当前的信念想象缺失的数据（E步），然后根据那个补全的图像修正你的信念（M步）。这场迭代的舞蹈，一遍又一遍地重复，让我们能够收敛到一个连贯而有力的解释，解释我们能看到的世界，通过系统地推理我们看不到的世界。