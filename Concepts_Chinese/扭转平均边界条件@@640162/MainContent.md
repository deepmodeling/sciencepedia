## 引言
模拟材料的量子行为带来了一个根本性的两难困境：我们如何能用一个有限的[计算模型](@entry_id:152639)来理解一个几乎无限的系统？标准方法是[周期性边界条件](@entry_id:147809)（PBC），它将一个小的模拟单元视为宇宙的重复单元，但这种简化引入了人为的约束。这些约束，即有限尺寸误差，会扭曲计算结果，掩盖材料真实的物理性质，对金属尤其如此。

本文介绍扭转平均边界条件（TABC），这是一种为克服一类关键的有限尺寸误差而设计的优雅而强大的方法。通过阅读本文，您将清楚地理解有限模拟尺寸带来的挑战以及TABC如何提供一个稳健的解决方案。接下来的章节将首先引导您了解“原理与机制”，解释问题的量子力学起源以及解决它的数学“扭转”方法。随后，“应用与跨学科联系”将展示该技术的广泛影响，从其在凝聚态物理和[材料科学](@entry_id:152226)中的应用，到其在[核物理](@entry_id:136661)和[中子星](@entry_id:147259)研究中出人意料的作用。

## 原理与机制

要真正理解科学家如何预测材料的性质——它将是导体还是绝缘体，其强度如何，或者它将如何与其他物质反应——我们必须深入到电子的量子世界。模拟这个世界是一项艰巨的任务。我们不可能计算真实材料中近乎无限数量的电子的行为。取而代之的是，我们采用一种巧妙的技巧：我们模拟一个小的、有代表性的材料盒子，并假设宇宙是由无限个相同的盒子堆叠而成，就像砖块一样。这就是**周期性边界条件（PBC）**的方法。

然而，这种优美的简化是有代价的。我们计算盒子的壁，尽管对于粒子从一侧离开并从另一侧重新进入是“透明的”，却对描述电子的量子波施加了人为的约束。这就是我们所说的**有限尺寸误差**的来源。扭转平均边界条件是我们用来克服一类特别顽固的此类误差的最优雅、最强大的工具之一。

### 有限盒子的束缚

想象一个电子，它不是一个微小的台球，而是在我们的周期性盒子内晃动的波。就像特定长度的吉他弦只能产生一组离散的音符——一个基频及其泛音——在一个长度为$L$的盒子里的电子波也只能有特定的波长。在量子力学中，波长与动量成反比。这意味着，在我们的有限盒子中，电子的动量是**量子化**的；它不能取任何值，而是被限制在一个离散的允许点网格上。我们称这个动量网格为**[k空间](@entry_id:142033)**，网格上点与点之间的间距与$1/L$成正比[@problem_id:3459459]。

为了求得我们系统的总能量，我们必须用电子填充这些离散的动量态，从最低能量开始，直到我们放置了全部$N$个电子。这个过程就像用“水”（电子）填充“桶”（能级）。在金属中，能量最高的电子在[k空间](@entry_id:142033)中占据一个“[费米面](@entry_id:137798)”。在我们的有限模拟中，这个光滑的表面被一组离散的、锯齿状的已占据点所取代。

这就是**[单体](@entry_id:136559)有限尺寸误差**的起源，通常称为**壳层填充效应**。当我们改变系统尺寸$L$或粒子数$N$时，允许的动量点网格会发生移动。一个刚好在[费米面](@entry_id:137798)内的点可能会移动到刚好在费米面外，反之亦然。这导致总能量以一种非物理的方式上下跳跃，围绕着我们在无限系统中会得到的真实值[振荡](@entry_id:267781)[@problem_id:2885593]。这有点像测量一堆橙子的体积；总体积敏感地取决于你添加的最后一个橙子是完成了一个整齐的层面，还是开始了一个新的、不稳定的层面。这些[振荡](@entry_id:267781)纯粹是我们有限盒子的产物，对于金属来说，它们可能大得惊人，从而掩盖了真实的物理现象。

### 巧用“扭转”之法

我们如何摆脱这个离散网格的束缚呢？我们需要一种方法来更平滑地对[动量空间](@entry_id:148936)进行采样，以某种方式填补网格点之间的空白。这就是**扭转**的魔力所在。

[波函数](@entry_id:147440)$\Psi$的标准[周期性边界条件](@entry_id:147809)规定，它在盒子的相对面必须相同：$\Psi(\mathbf{r} + \mathbf{L}) = \Psi(\mathbf{r})$。**扭转平均边界条件（TABC）**通过添加一个相位因子来推广这一点：

$$
\Psi(\ldots,\mathbf{r}_{i}+\mathbf{L},\ldots) = e^{i\boldsymbol{\theta} \cdot \mathbf{L}} \Psi(\ldots,\mathbf{r}_{i},\ldots)
$$

在这里，$\boldsymbol{\theta}$是一个我们可以自由选择的向量，称为**扭转角**或**偏移向量**[@problem_id:2828314]。这个看似微小的改变有什么作用呢？它对允许的动量产生了深远的影响。允许的$\mathbf{k}$向量网格现在被一个与$\boldsymbol{\theta}$成比例的量平移了：

$$
\mathbf{k} = \frac{2\pi}{L}\mathbf{n} \quad \longrightarrow \quad \mathbf{k} = \frac{2\pi}{L}\mathbf{n} + \frac{\boldsymbol{\theta}}{L}
$$

由于我们可以选择扭转$\boldsymbol{\theta}$为任何连续值，我们现在有了无限多个可能的网格！$\boldsymbol{\theta}$的每一种选择都给了我们一个不同的、有效的动量量子化方案和相应的总能量$E(\boldsymbol{\theta})$。这些能量值中没有一个是“正确”的。一个强大的洞见是，无限系统的真实能量可以通过对所有可能的扭转进行*平均*来找到。

其魔力在于一个优美的数学恒等式。通过计算大量随机选择的扭转角对应的能量并对结果进行平均，对离散动量网格的求和就转变成了对整个k空间的光滑积分[@problem_id:3482366]。单个扭转下对已占据态的离散求和是对该积分的一个糟糕近似。但是，对许多扭转进行平均等价于一个复杂的数值积分方案（实际上是[蒙特卡洛积分](@entry_id:141042)），它为无限系统的能量和其他性质提供了一个远为精确的值[@problem_id:2828314] [@problem_id:3469690]。

这就像试图通过用棍子戳探来找出湖的平均深度。如果你只戳一次，你可能会戳到一个深处或一个浅处。如果你在数百个随机位置戳探并平均你的测量值，你将得到一个非常可靠的平均深度估计。每一次扭转都是在布里渊区“戳探”的一个新位置，而这些测量的平均值消除了非物理的壳层填充[振荡](@entry_id:267781)。

### 涨落的性质

这些[能量涨落](@entry_id:148029)的一个奇特而优美的特征是它们不是广延的。也就是说，当你改变扭转$\boldsymbol{\theta}$时能量跳跃的大小并*不*随系统大小$N$增长。总能量的标准差$\mathrm{StdDev}_{\boldsymbol{\theta}}[E(\boldsymbol{\theta})]$是1的量级，即$O(1)$[@problem_id:2828334]。

这是为什么呢？扭转只影响[费米面](@entry_id:137798)周围一个非常薄的壳层中状态的占据情况。深处于[费米海](@entry_id:136725)内的电子离边缘太远，不受网格微小移动的影响。因为“作用”仅限于这个[动量空间](@entry_id:148936)表面，所以总[能量涨落](@entry_id:148029)不依赖于系统的“体积”（即总电子数$N$）。这意味着*每个粒子*的能量误差$e(\boldsymbol{\theta}) = E(\boldsymbol{\theta})/N$实际上随着系统尺寸迅速减小，其[标度关系](@entry_id:273705)为$O(N^{-1})$。这是个好消息，因为它告诉我们，我们试图修正的误差随着我们模拟更大、更真实的系统而变得越来越不重要。

### 高级技巧：更聪明而非更费力地扭转

知道了[能量涨落](@entry_id:148029)主要发生在[k点](@entry_id:168686)穿过费米面时，我们可以设计出更巧妙的策略。与其在整个布里渊区均匀地采样扭转，为什么不把我们的计算精力集中在最重要的地方呢？

这就是**[重要性采样](@entry_id:145704)**扭转的思想。我们可以设计一个采样算法，优先选择那些能使动量网格点靠近[费米面](@entry_id:137798)的扭转角$\boldsymbol{\theta}$。当然，为了得到无偏的结果，我们必须对结果进行重新加权：任何由概率为$p(\mathbf{k}_i)$的扭转采样计算出的能量$E(\mathbf{k}_i)$，在最终平均中必须被赋予一个成比例的较小权重$1/p(\mathbf{k}_i)$。这项技术可以显著减少达到特定精度所需的扭转次数，从而节省宝贵的计算机时[@problem_id:3482376]。

另一个强大的技术是使用**[控制变量](@entry_id:137239)**。我们可以先用一个更简单的理论，如[密度泛函理论](@entry_id:139027)（DFT），进行一次廉价的计算，以找到近似的[能量涨落](@entry_id:148029)$E_{\text{DFT}}(\boldsymbol{\theta})$。这捕捉了扭转依赖性的大部分。然后，我们使用我们昂贵的、高精度的[量子蒙特卡洛方法](@entry_id:753887)来只计算那个小的、平滑的*差值*，$\delta E(\boldsymbol{\theta}) = E_{\text{QMC}}(\boldsymbol{\theta}) - E_{\text{DFT}}(\boldsymbol{\theta})$。通过对这个小修正进行平均，并将其加到DFT能量的精确平均值上，我们能够用少得多的扭转次数使我们的答案收敛[@problem_id:2828334]。

### 了解其局限：扭转平均无法修复的问题

扭转平均是解决k空间采样[单体](@entry_id:136559)问题的绝佳方案。但它并非解决所有有限尺寸误差的万能药。还有另一类误差，称为**两体误差**，它源于我们计算电子间库仑相互作用的方式。

在周期性模拟中，一个电子不仅与主[晶胞](@entry_id:143489)中的其他$N-1$个电子相互作用，还与它们所有的无限周期性映像相互作用。对这些相互作用求和的标准方法是**Ewald求和**[@problem_id:2885567]。由此产生一个微妙的问题：一个电子会非物理地与其自身的**交换关联（XC）空穴**的周期性映像相互作用。XC空穴是由于量子力学（[泡利不相容原理](@entry_id:141850)）和[库仑排斥](@entry_id:181876)，其他电子倾向于在给定电子周围避开的“私人空间”气泡。这个气泡是该电子身份的一部分；它不应该与它自己在相邻盒子中气泡的复制品相互作用。

这种虚假的相互作用是一种两体有限尺寸误差，它不能通过扭转平均来修复[@problem_id:2885593]。要解决这个问题，需要不同的工具。其中一个工具是**模型周期性库仑（MPC）相互作用**。MPC巧妙地修改了Ewald方法。它对平均静电（Hartree）能量使用标准的周期性求和，但对于定义XC空穴的交换关联部分，它本质上在所讨论的两个电子之间使用简单的、[非周期性](@entry_id:275873)的库仑相互作用。这有效地消除了一个电子与其XC空穴映像之间的虚假相互作用，从而显著减少了两体有限尺寸误差[@problem_id:3482430]。

这里的教训在物理学和计算科学中是深刻的。进步来自于清晰地识别误差的不同来源，并为每一种来源设计特定的、巧妙的工具。扭转平均巧妙地处理了单粒子动量的量子化问题，而像MPC这样的其他方法则处理双粒子相互作用的微妙之处。它们共同使我们能够使用我们微小的、有限的模拟盒子来学习关于真实材料的无限、复杂世界的深刻真理。

