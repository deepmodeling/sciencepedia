## 引言
在从医学图像中提取更深层意义的探索中，传统放射组学提供了宝贵的工具。然而，它常常忽略一个关键维度：像素之间、肿瘤不同区域之间，甚至患者之间的复杂关系网络。本文通过引入基于图的放射组学来弥补这一不足，这是一个强大的范式，它通过将[数据建模](@entry_id:141456)为相互连接的网络，重构了医学图像分析。通过将图像不视为像素网格，而看作一个由相互作用的[元素组成](@entry_id:161166)的社会，我们可以解锁以前无法观察到的洞见。这种方法为理解疾病的复杂性提供了一种更为精妙的方式。本文将引导您了解这种变革性的方法论。“原理与机制”一章将奠定基础，解释如何将图像转换为图，并使用谱聚类和标签传播等概念进行分析。随后，“应用与跨学科联系”一章将展示这些原理如何应用于解决现实世界中的挑战，从描绘肿瘤异质性到整合放射学、病理学和基因组学的数据，以实现对疾病真正全面的理解。

## 原理与机制

要真正领会基于图的放射组学的威力，我们必须转变视角。让我们不再将医学图像仅仅看作一个静态的像素网格，一个沉默的数据点集合。相反，让我们把它想象成一个充满活力、熙熙攘攘的社会。每个像素，或在三维空间中的**体素（voxel）**，都是一个个体，其亮度是一个决定性的特征。和任何社会一样，它也有其结构。一些体素是亲密的朋友，是属性几乎完全相同的近邻。另一些则是远房的熟人。如果我们能绘制出这些关系的地图会怎样？这就是我们旅程简单而又深刻的起点：我们将要成为肿瘤隐藏社交网络的制图师。

### 从像素到网络：作为图的图像

第一步是将我们的图像转换成图的语言。这是一个非常直观的过程。我们声明，在感兴趣区域（比如一个肿瘤）内的每一个体素，都是我们网络中的一个**节点（node）**。现在，我们如何决定哪些节点是相连的呢？我们为任意两个节点之间绘制一条**边（edge）**（即连接）设定了两条简单的规则：它们必须是空间上的邻居，并且它们在外观上必须“相似”。[@problem_id:4547796]

但“相似”究竟意味着什么？这是图构建的艺术与科学开始的地方。最简单的相似性度量是强度差异。如果绝对差异低于某个阈值，我们就画一条边。这个简单的规则已经足够强大，可以开始区分不同的区域。但我们可以做得更精细。图像中真正的边界不仅仅是亮度的变化；它可能也是纹理的变化或一个急剧的梯度。我们可以将连接的*强度*——即**边权重（edge weight）**——定义为一个结合了多种证据来源的函数。例如，我们可以定义相邻体素 $p$ 和 $q$ 之间的权重 $w_{pq}$，使得当强度梯度 $g_{pq}$ 和纹理差异 $t_{pq}$ 都很低时，该权重很高。一个常用且有效的选择是指数函数，如 $w_{pq} = \exp(-(\alpha g_{pq} + \beta t_{pq}))$。[@problem_id:4560299] 这个函数有一个优美的特性，它为非常相似的体素分配高权重（强连接），但随着它们变得越来越不相似，权重会迅速下降，从而有效地在一个区域的“内部者”和“外部者”之间创造出清晰的区分。

网络构建好后，我们能用它做什么呢？放射组学中的一个主要任务是**分割（segmentation）**——精确地勾勒出病灶的边界。在我们的图中，这相当于找到将网络切割成两部分的最佳方式：“病灶”和“背景”。一个自然的方法是找到切断最弱连接的切割，即最小化被切断边的总权重。这被称为**[最小割](@entry_id:277022)（minimum cut）**。然而，一个朴素的[最小割](@entry_id:277022)有一个奇怪且令人沮丧的偏好：它喜欢找到微小的、孤立的区域，仅仅因为这些区域有最短的可能边界，从而有“最便宜”的切割。[@problem_id:4560287]

这个难题的解决方案非常优雅。我们不只是最小化切割，而是最小化一个**归一化切割（Normalized Cut）**。这个目标函数引入了一种平衡：它试图找到一个代价低的切割，但同时惩罚那些产生大小不成比例的小[集合的划分](@entry_id:136683)。其代价通过每个生成部分的“体积”进行归一化，这里的体积代表了该部分内所有节点的总连接强度。本质上，我们是在告诉算法：“给我找一个便宜的边界，但绝不能给我一个微不足道的小块。” 这个简单的修改将图割转变为一个用于智能分割的稳健而强大的工具。

### 寻找隐藏的社群：生境与异质性

肿瘤很少是一个均匀的肿块。它是一个复杂的生态系统，有不同的邻域或**生境（habitats）**，其特征在于不同的细胞密度、血液供应和代谢活动。这些生物学差异通常在图像中表现为强度和纹理的变化。我们从图像的像素社会构建的图，掌握着揭示这种**[肿瘤内异质性](@entry_id:168728)（intra-tumor heterogeneity）**的关键。

为了自动找到这些隐藏的社群，我们可以借鉴社交网络研究中的一个强大概念：**模块度（modularity）**。[@problem_id:4547796] 模块度衡量一个网络被划分为多个社群的优劣程度。如果社群*内部*的连接远比随机情况下预期的要密集，而社群*之间*的连接则较为稀疏，那么这个划分就具有高模块度。通过搜索使体素图的模块度得分最大化的划分方式，我们可以通过算法识别出与肿瘤生物学生境相对应的不同空间区域。这为我们提供了肿瘤内部景观的定量地图，是理解其行为和对治疗潜在反应的关键一步。

### 思想之图：超越像素

到目前为止，我们的节点代表了图像中的物理位置。但图形式主义真正的力量和美妙之处正在于此：一个节点可以代表*任何事物*。这种抽象使我们能够提出全新类型的问题。

想象一下，我们有来自数百名患者的数据。对于每位患者，我们都提取了一组丰富的放射组学特征——可能有数千个——描述他们肿瘤的大小、形状和纹理。我们现在可以构建一个图，其中每个**节点是一名患者**。如果两个患者的放射组学特征向量高度相似，我们就在他们之间画一条带权重的边。这不再是单个肿瘤的地图；这是一个跨越整个患者群体的关系地图。我们能用这样的地图做什么呢？我们可以寻找聚类。

一个非常强大的技术是**谱聚类（spectral clustering）**。[@problem_id:4561516] 其背后的数学原理很深，与物理对象的振动有关，但其直觉非常优美。通过分析图的最低频“振动模式”——一个称为**图拉普拉斯矩阵（graph Laplacian）**的特殊矩阵的特征向量——我们可以找到为节点分配数值的最“平滑”的方式。在网络中彼此靠近的点在这些平滑分配中自然会获得相似的值。这些新值提供了一个低维嵌入，一套新的坐标系，在这里聚类变得显而易见。这就像轻轻摇晃一张蜘蛛网，观察哪些部分会同步移动。这些部分就是聚类——在我们的例子中，就是隐藏在高维特征数据中的潜在疾病亚型。

这种抽象的力量不止于此。我们可以创建图，其中**节点是特征本身**。[@problem_id:4552585] 一条边可能代表在所有患者中，一个CT纹理特征和一个PET代谢特征之间的相关性。这个“思想之图”揭示了不同测量和模态之间复杂的相互关系，提供了对疾病的统一视图。我们甚至可以用这个框架来重塑旧的工具。经典的纹理度量通常受限于像素网格的刚性几何结构。通过将问题重塑为图的形式，我们可以将相同的逻辑应用于不规则数据，例如来自数字病理切片的单个细胞位置云，其中图的连接代表物理上的邻近性。[@problem_id:4565951] 无论底层[数据结构](@entry_id:262134)如何，图都成为一种描述关系的通用语言。

### 知识的流动：在图上学习

图不仅仅是静态的地图；它们也可以是信息流动的管道。假设在我们的患者相似性图中，我们知道少数几位患者的临床结局。我们如何利用[网络结构](@entry_id:265673)来预测其他所有人的结局呢？

这引出了一个优雅的概念：**标签传播（label propagation）**。[@problem_id:4532532] 我们可以想象已知的标签——比如用“1”代表不良结局，用“0”代表良好结局——就像金属网格上的固定温度点。然后我们让这些信息在图中“流动”。指导原则是，任何未标记的节点都应该采用其邻居值的加权平均值。这个过程不断迭代，直到整个图上的标签稳定下来，达到一个平衡状态。标签的最终分布是数学家所称的**谐[波函数](@entry_id:201714)（harmonic function）**，这是一种使所有边上的总“能量”或“张力”最小化的状态。这是其最直观形式的[半监督学习](@entry_id:636420)，允许少量知识渗透到整个数据集中，从而做出智能推断。

### 为何这一切行之有效：流形假说

还有一个更深层次的问题。放射组学数据存在于一个数千维的空间中。在如此广阔的空间里，每个点都应该与其他所有点相距甚远；“邻域”和“距离”这些概念本身应该会失效。这就是臭名昭著的**[维度灾难](@entry_id:143920)（curse of dimensionality）**。那么，为什么这些完全建立在局部邻域思想之上的基于图的方法，竟然能够奏效呢？

答案在于一个优美而深刻的概念，即**流形假说（manifold hypothesis）**。[@problem_id:4566635] 它假设，虽然我们的数据嵌入在一个高维空间中，但它并非随机地填充该空间。相反，数据点位于或非常接近一个维度低得多的、平滑弯曲的曲面，即**流形（manifold）**。想象一根长长的线在一个大房间里缠成一团。线本身是一维的，但它上面的每个点都有一个三维坐标。

这就是驯服维度灾难的秘密。由于数据被限制在一个低维流形上，其局部结构是表现良好的。如果你放大看线上的一小段，它看起来几乎像一条直线。类似地，一个 $d$ 维流形的一小块局部看起来像一个平坦的 $d$ 维欧几里得空间。在这些局部区域中，点之间的直接[欧几里得距离](@entry_id:143990)是真实“流形上”距离或**[测地距离](@entry_id:159682)（geodesic distance）**的极佳近似。[@problem_id:4566635]

这正是为什么利用局部性的算法——比如从 k-近邻构建图——能够成功的原因。它们实际上是在发现并利用这个隐藏流形的局部几何结构。这些方法的性能最终不取决于空间的高环境维度，而是取决于流形本身低得多的*内在维度*。我们构建的图，本质上是这个底层流形的离散近似，是一张路线图，让我们能够驾驭数据的隐藏结构并揭示其中的秘密。

