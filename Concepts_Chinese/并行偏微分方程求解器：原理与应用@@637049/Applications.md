## 应用与跨学科联系

我们花了一些时间学习如何将大[问题分解](@entry_id:272624)成可以在并行中解决的、更小、更易于管理的部分。我们讨论了区域、边界和通信。这是“如何做”的问题。但任何科学工具真正令人兴奋的部分不是“如何做”，而是“为什么”和“在哪里”。我们为什么要费这么大劲？这种力量能带我们去向何方？

这不仅仅是一个关于让计算机变得更快的故事。这是一个关于改变我们能向世界提出的问题的本质的故事。通过掌握并行计算的艺术，我们获得了构建虚拟宇宙的能力——模拟星系错综复杂的舞蹈、飓风的混沌狂暴、化学物质在地下微妙的[扩散](@entry_id:141445)，甚至是模糊的不确定性景观本身。让我们穿越其中一些世界，看看我们学到的原理如何变为现实，揭示出物理问题的结构与解决它的算法设计之间美妙而深刻的统一性。

### 宇宙计算：模拟恒星与星系

想象一下模拟一个正在形成的星系的宏伟任务。这是一场由两组截然不同的物理定律编排的宇宙芭蕾。一方面，你有旋转的气体和尘埃，其行为像流体，波和[冲击波](@entry_id:199561)以有限的速度向外传播。另一方面，你有无情、无所不包的[引力](@entry_id:175476)，星系一角的质量变化会*瞬间*被整个星系感知到。

这是一个深刻的区别。气体的运动是一个*双曲型*问题，而[引力势](@entry_id:160378)是一个*椭圆型*问题。可以这样想：如果你在一个巨大的、空旷的大厅里大喊一声，声音会像波一样向外传播。要知道你所在位置发生了什么，你只需要听听你紧邻的邻居。你的世界是局部的。这就是双曲型系统的本质。但如果你打开电灯开关，整个大厅会立刻被照亮。任何地方的变化都会影响到各处的光线。这就是椭圆型系统的本质；它的影响是全局的。

我们的[并行算法](@entry_id:271337)必须尊重这种根本差异[@problem_id:3509207]。当我们将模拟的星系切分成子区域，并将每个子区域分配给不同的处理器时，气体动力学的通信策略可以很简单。每个处理器只需要与其直接邻居交谈，交换一层薄薄的“幽灵单元”，以处理跨越边界的声波。任何更多的重叠或通信都将是浪费的，就像隔着大厅对一个人大喊，而他只需要听到旁边人的声音一样。

但对于[引力](@entry_id:175476)来说，这种局部的交谈是不够的。因为它的影响是全局的，所以子区域必须更深入地协调才能得到正确的答案。一个常见且有效的策略是让子区域重叠。通过让每个处理器都计算一点进入其邻居领地的部分，关于全局[引力场](@entry_id:169425)的信息可以更快速、更有效地共享。这使得我们用于椭圆型问题的迭代求解器能够更快地收敛。以一种奇妙而直接的方式，[并行算法](@entry_id:271337)的设计——是选择最小的幽灵单元还是慷慨的重叠区域——反映了作用力的物理性质。

如果物理变得更加复杂呢？有时，为了稳定性，我们甚至必须用*隐式*方法来求解快速移动的双曲型[气体动力学](@entry_id:147692)问题，这将所有点连接成一个大的代数系统。当我们这样做时，双曲型问题开始呈现出类似椭圆型的特征，重叠区域再次成为我们的朋友，帮助我们控制计算的复杂性。物理决定算法。

### 洞见无形：从[湍流](@entry_id:151300)到地下世界

当我们把目光从天空转向我们自己的[世界时](@entry_id:275204)，[匹配算法](@entry_id:269190)与物理结构的主题再次出现。考虑一下对[湍流](@entry_id:151300)进行[直接数值模拟](@entry_id:149543)（DNS）的挑战——计算流经飞机机翼的空气中每一个[涡流](@entry_id:271366)和漩涡的运动。其中的一个关键部分是求解压[力场](@entry_id:147325)，它像[引力](@entry_id:175476)一样，施加了一个全局约束：流体是不可压缩的。这同样导致了一个椭圆型的泊松方程。

如果我们的模拟是在一个具有周期性边界的盒子中进行的某种理想化的、均匀的[湍流](@entry_id:151300)——即从一侧流出的任何东西都会从另一侧回来——我们可以使用一个强大的数学技巧：快速傅里叶变换（FFT）。FFT 就像计算的“镜厅”；它利用问题的完美对称性以惊人的速度求解泊松方程。

但如果我们模拟的是一个更真实的流动，有明确的入口和出口呢？优美的对称性被打破了。镜厅消失了。在这种情况下，FFT 对我们无能为力，我们必须转向一个更稳健、更通用的工具：多重网格方法。[多重网格求解器](@entry_id:752283)本身就是一种卓越的“分而治之”策略，它在一系列越来越粗的网格上求解问题，以有效地处理各种不同大小的误差。在一个巧妙的转折中，对于具有混合边界的问题——比如在两个方向上是周期性的，但在第三个方向上不是——我们甚至可以构建混合求解器，对周期性维度使用 FFT，对非周期性维度使用另一种方法，从而集两家之所长[@problem_id:3308693]。

这种求解施加全局约束的隐藏场的能力，也是洞察地球内部的关键。在[地震成像](@entry_id:273056)中，[地球物理学](@entry_id:147342)家使用强大的“[振动](@entry_id:267781)车”或水下气枪制造微型、可控的地震。然后，他们用成千上万个传感器记录返回地表的回波。巨大的挑战是反问题：地下的什么结构能够产生我们观测到的精确回波模式？这涉及到运行大量的模拟，以找到一个与数据匹配的地[壳模型](@entry_id:157789)。

在这里，我们遇到了一种非常简单而强大的并行形式。每一次“放炮”——每一次虚拟地震——都是一个独立的实验。它的模拟不依赖于任何其他次放炮。这意味着我们可以把我们成千上万个处理器中的每一个都分配给它自己的放炮任务进行模拟。这被称为“[任务并行](@entry_id:168523)”，有时也被称为“易于并行”，因为劳动分工非常直接。每个处理器独立地处理其任务，只有在最后，它们才会全部“交谈”，将它们的结果相加，以产生一个统一的梯度，指导寻找正确的地球模型[@problem_id:3607389]。这与我们在[星系模拟](@entry_id:749694)中看到的[空间分解](@entry_id:755142)是不同风格的并行性，但它对于解决现实世界的问题同样至关重要。

### 驯服复杂性：拆分物理与[并行化](@entry_id:753104)时间

到目前为止，我们的并行性都是空间性的，划分问题的区域或任务。但算法设计的创造精神并未止步于此。我们也可以根据问题的物理性质本身来划分问题。

想象一下模拟污染物在地下水中[扩散](@entry_id:141445)。这通常涉及耦合具有迥异时间尺度的过程，从而产生一个“刚性”问题。例如，[化学反应](@entry_id:146973)可能几乎是瞬时的，而化学物质的[扩散](@entry_id:141445)则是一个缓慢得多的过程。如果我们对整个模拟使用一个单一的计算时钟（单一的时间步长），我们就会被迫做出一个低效的选择：使用微小的时间步长来捕捉快速的反应，这对于缓慢的[扩散](@entry_id:141445)来说是极大的浪费。

解决方案是一种巧妙的折中，称为隐式-显式（IMEX）方法[@problem_id:2545046]。这就像是一位拥有两台摄像机的电影导演。对于物理的非刚性部分（缓慢的[扩散](@entry_id:141445)），我们可以使用一种简单的、计算成本低的“显式”方法。对于快速、刚性的部分（[化学反应](@entry_id:146973)），我们使用一种计算上更密集但高度稳定的“隐式”方法。我们在同一个时间步内对物理的不同部分区别对待。这使我们能够在时间上迈出大的、高效的步子，而不会牺牲稳定性或准确性。这是一个深刻的想法：我们正在根据物理本身固有的多重时间尺度来定制我们的算法。

这种拆分问题的想法引向了最大胆的目标：我们能并行化时间本身吗？毕竟，时间感觉上是内在串行的。“明天”世界的状态取决于“今天”世界的状态。但即使是这个障碍也可以被挑战。Parareal 算法就是一个试图做到这一点的巧妙方案[@problem_id:3416550]。

想象一下计划一次长途的跨国公路旅行。串行的方式是开第一天的车，看看你到了哪里，然后计划并开第二天的车，依此类推。Parareal 的方法则不同。首先，你使用一张简化的地图为整个旅行制定一个非常快速、粗略的计划（这是“粗传播器”，并且是串行完成的）。然后，你雇佣多个助理团队。你为每个团队分配旅行中的一天。并行地，每个团队根据你为他们那天指定的粗略起点，使用最好的地图和交通数据为那一天制定一个高度详细、准确的计划（这是“精传播器”）。

现在是巧妙的部分。你进行迭代。第一个团队的详细计划为你第二天的行程提供了一个比你最初的粗略猜测好得多的起点。你把这个更新后的起点交给第二个团队的规划师，他会重新运行他们粗略、快速的计划，看看这个初始变化如何影响旅行的其余部分。新的粗略计划和旧的粗略计划之间的差异，加上原始的精细细节，为第二天提供了一个大大改进的计划。这个过程继续下去，沿着时间线传播修正。我们用一个单一、漫长的[串行计算](@entry_id:273887)换来了多个、较短的并行计算，外加一系列快速的串行修正。虽然不是万能药，但打破时间壁垒的想法为我们思考[并行计算](@entry_id:139241)开辟了一条全新的道路。

### 拥抱不确定性：预测的前沿

也许并行计算所带来的最深刻的转变，是从寻求单一、确定性答案转向拥抱和量化不确定性。现实世界不是一个参数完全已知的世界。如果我们的飞机机翼的材料属性不完全是我们想象的那样怎么办？如果大气的初始状态只是近似已知的怎么办？

运行一次模拟只会得到一个答案，而这个答案可能恰恰是错误的。我们真正想要的是理解可能结果的范围。这就是[不确定性量化](@entry_id:138597)（UQ）的领域。这听起来代价高昂得令人难以置信——我们必须进行数千或数百万次模拟，而不是一次。但在这里，[并行算法](@entry_id:271337)再次提供了一条优雅的前进道路。像[多项式混沌展开](@entry_id:162793)（PCE）这样的方法允许我们将不确定的输入表示为我们问题中一组新的“随机维度”。事实证明，这个新的、更高维度的问题具有优美的结构。它创造了一个可以完美并行化的新工作层，使我们能够一次计算许多可能的结果，通常是在同一个硬件核心上使用 GPU 的并行通道[@problem_id:3407930] [@problem_id:3449779]。并行性不仅使我们旧的计算更快；它还允许我们执行全新类型的计算，为我们提供一幅更丰富、更真实的画面，让我们了解我们知道什么，不知道什么。

这个主题在一类算法中找到了它的对应物，这类算法的核心计算是顽固的串行。考虑一下[哈密顿蒙特卡洛](@entry_id:144208)（HMC），这是一种强大的贝叶斯方法，用于找出哪些模型参数最能拟合一组观测数据。HMC 的工作原理是模拟一个粒子在参数景观中的轨迹，而旅程的每一步都依赖于前一步。你无法[并行化](@entry_id:753104)轨迹本身。那么我们该怎么办呢？我们在更高的层次上寻找并行性[@problem_id:3388111]。如果一个探险家必须一步步地走一条路，我们仍然可以通过派出一支探险家大军来绘制整个大陆的地图。我们并行运行数百个独立的 HMC 链。没有任何一个链条能更快地得到答案，但我们每小时收集的总样本数——我们的科学[吞吐量](@entry_id:271802)——乘以了我们拥有的处理器数量。

从恒星的核心到我们自身知识中的不确定性，并行 PDE 求解器的故事就是寻找巧妙方法进行分而治之的故事。它是一种语言，让我们能够以计算机能够理解和大规模执行的形式来表达复杂的物理相互作用。通过学习从这个视角看世界，我们发现，我们算法的结构和自然本身的结构，以一种深刻而优美的统一方式交织在一起。