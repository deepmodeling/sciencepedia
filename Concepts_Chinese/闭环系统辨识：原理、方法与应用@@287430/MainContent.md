## 引言
辨识系统动态——即理解其输入如何影响输出——是科学与工程的基石。在开环设置中，这很简单：我们提供一个已知的输入，并测量其产生的输出。然而，从工业机器人到生物有机体，许多系统都在[反馈控制](@article_id:335749)下运行，形成了一个“闭环”，其中输出被用来持续调整输入。这种[自指](@article_id:349641)的特性带来了一个深远的挑战：输入[信号与系统](@article_id:338146)自身不可预测的噪声变得相关，这会污染数据并使简单的分析方法产生偏差。在闭环世界中，轻率地应用开环技术会导致根本上错误的模型。

本文将直面这一问题，为[闭环系统辨识](@article_id:361129)的原理、方法及其深远应用提供一份指南。首先，在“原理与机制”一章中，我们将剖析反馈引发偏差的核心问题，并探讨为克服该问题而设计的精妙统计策略，包括直接法、间接法和[工具变量法](@article_id:383094)。然后，在“应用与跨学科联系”一章中，我们将超越纯粹的理论，去见证这些原理的实际应用，探索工程师如何改进智能机器，生理学家如何解码身体的内部调节器，以及整个研究工作如何与学习和执行之间普遍存在的权衡联系起来。

## 原理与机制

想象一下，你正试图通过观察车速来理解汽车引擎的工作原理。你踩下油门，车速加快。这很简单。我们称之为**开环**实验：你的行为（输入）直接导致一个结果（输出），你可以研究它们之间的关系。现在，想象你打开了巡航控制。你设定一个[期望](@article_id:311378)速度，然后一个控制器接管，不断为你调整油门以维持该速度，补偿坡度、风和摩擦力的影响。这是一个**闭环**系统。如果你现在试图仅通过观察控制器的行为来理解引擎，你会发现自己进入了一个陌生的新世界，一个充满[自指](@article_id:349641)和混淆效应的世界，很容易让你误入歧途。这正是[闭环系统辨识](@article_id:361129)的核心挑战。

### 镜像问题：反馈与被污染的数据

在[反馈回路](@article_id:337231)中，系统过去的行为会影响其未来的行动。控制器的输出，即我们的被控对象输入信号 $u(k)$，是根据[期望](@article_id:311378)设定点，或称**参考信号** $r(k)$，与测量输出 $y(k)$ 之间的差值计算得出的。问题在于，测量输出绝非完美；它总是被某种形式的噪声或扰动所污染，我们称之为 $v(k)$。这种扰动可以是任何东西，从一阵击中飞机的狂风到电子电路中的随机热噪声。

所以，输出不仅仅是被控对象动态 $G_0$ 的结果，而是一个总和：

$$y(k) = G_0(q)u(k) + v(k)$$

控制器看到这个带噪声的输出后会做出反应。控制律是：

$$u(k) = K(q)(r(k) - y(k))$$

现在让我们仔细看看。如果我们将第一个方程代入第二个方程，我们就能发现问题的核心：

$$u(k) = K(q)\big(r(k) - [G_0(q)u(k) + v(k)]\big)$$

经过一些代数运算，我们可以看到输入 $u(k)$ 部分由参考信号 $r(k)$ 驱动，部分由扰动 $v(k)$ 驱动。这意味着输入信号 $u(k)$ 现在与噪声 $v(k)$ **相关**！[@problem_id:2878962]

为什么这对像[普通最小二乘法](@article_id:297572) (OLS) 这样的简单辨识方法来说是如此灾难性的？OLS 通过寻找能最好地解释输入和输出之间关系的模型来工作。它假设任何剩余的误差都只是[随机噪声](@article_id:382845)，与输入完全无关。但在闭环中，这个假设被打破了。输入被我们试图忽略的噪声本身所“污染”。这就像你试图在一个体重秤上称重，但一个调皮的朋友正在看着读数并按压体重秤来改变它。你再也不能相信测量值仅仅反映了你的体重；它是你的体重和你朋友干预的混合体。在这里应用 OLS 会给你一个有偏的、不正确的体重估计。同样，在闭环系统中，OLS 会给你一个有偏的被控对象模型。[@problem_id:2876751]

### 关键：一位清白的见证者

那么，所有希望都破灭了吗？完全没有。打破这个恶性循环的秘诀在于一个不属于这个共谋的信号：外部参考信号 $r(k)$。我们，作为实验者，创造了这个信号。我们可以随心所欲地设计它，最重要的是，它在本质上与系统内部不可预测的噪声 $v(k)$ **统计独立**。

这个独立的信号是我们“清白的见证者”。它提供了一个干净、已知的原因，我们可以通过系统追踪其影响。通过观察系统如何响应来自 $r(k)$ 的这些已知的“扰动”，我们可以制定巧妙的策略，以区分被控对象的真实行为与由噪声引起的令人困惑的反馈效应。[闭环辨识](@article_id:324138)的全部艺术归结为利用这一个简单事实的不同方法。关于如何做到这一点，主要有三个流派。

### 解开回路的策略

#### 1. 直接法：为整个共谋关系建模

第一种策略是直面问题。如果输入与噪声相关，那么我们的模型必须足够复杂以解释这一点。我们不能只对被控对象 $G_0$ 建模，并假装噪声很简单。我们必须对噪声本身进行建模！[@problem_id:2883929]

这就是**[预测误差法 (PEM)](@article_id:373452)** 背后的哲学。一个强大的 PEM [算法](@article_id:331821)会同时估计被控对象模型 $G(q,\theta)$ 和噪声模型 $H(q,\eta)$ 的参数。通过拥有一个参数化的噪声模型，该[算法](@article_id:331821)可以学习扰动在输出端表现出的“色彩”或统计特征。

这一点至关重要，因为反馈不仅仅是产生相关性；它还动态地塑造噪声。即使物理扰动 $v(k)$ 是简单的“白”噪声（就像收音机里的静电，所有频率的功率都相等），我们在输出端看到的扰动却不是。它已经被闭环动态所滤波，特别是被**[灵敏度函数](@article_id:344512)** $S(q) = (1 + G_0(q)K(q))^{-1}$ 所滤波。输出[噪声谱](@article_id:307456)由 $|S(e^{\jmath\omega})|^2$ 塑造。[@problem_id:2883946] 这意味着一个简单的噪声模型注定会失败。我们需要一个灵活的结构，比如 **Box-Jenkins (BJ) 模型**，它允许被控对象和噪声模型拥有完全独立的动态。使用这样的模型，PEM 就像一个熟练的侦探，将复杂的输出[信号分解](@article_id:306268)为可由输入解释的部分和可由现已理解的噪声解释的部分，从而产生对被控对象的一致估计。[@problem_id:2878962] [@problem_id:2883946]

#### 2. 间接法：巧妙的旁路

第二种策略更像是一条狡猾的迂回路线。它问道：为什么要在相关的信号 $u(k)$ 和 $y(k)$ 上挣扎呢？让我们从一个我们知道是“干净”的关系开始。外部参考信号 $r(k)$ 和输出 $y(k)$ 之间的关系正是如此，因为 $r(k)$ 与噪声是独立的。[@problem_id:2883929]

所以，第一步是执行一个简单的、类似开环的辨识，以找到从 $r(k)$ 到 $y(k)$ 的传递函数。这给了我们对真实的**[互补灵敏度函数](@article_id:329998)** $\hat{T}(q) \approx \frac{G_0(q)K(q)}{1+G_0(q)K(q)}$ 的估计。

现在是精彩的部分。我们已经知道控制器 $K(q)$，因为是我们设计的。有了我们的估计 $\hat{T}(q)$ 和已知的 $K(q)$，恢复未知的被控对象 $G_0(q)$ 只是一个解代数谜题的问题 [@problem_id:2892810]：

$$\hat{G}(q) = \frac{\hat{T}(q)}{K(q)\big(1 - \hat{T}(q)\big)}$$

瞧！我们通过先辨识系统一个不同的、更简单的部分，然后用逻辑推导出我们想要的那一块，从而找到了被控对象模型。我们完全绕过了相关性问题。该方法的其他变体也存在，例如，首先从 $r(k)$ 和误差信号 $e(k) = r(k) - y(k)$ 之间的关系中辨识出[灵敏度函数](@article_id:344512) $S(q)$。[@problem_id:2880150]

#### 3. [工具变量法](@article_id:383094)：寻找一个可信的裁判

我们的第三种方法也许是统计上最优雅的。它被称为**[工具变量](@article_id:302764) (IV) 法**。它首先承认我们的回归量 $\varphi(t)$（用于预测当前输出的过去输入和输出）是“被污染的见证者”，因为它们与噪声相关。

IV 方法找到了一个“裁判”——一个无可指摘的**[工具变量](@article_id:302764)** $z(t)$。要成为一个有效的工具，这个变量必须满足两条黄金法则 [@problem_id:2883860]：

1.  **相关性**：它必须与被污染的回归量 $\varphi(t)$ 相关。毕竟，一个没看比赛的裁判没什么用。
2.  **[外生性](@article_id:306690)**：它必须与系统噪声 $v(t)$ 完全不相关。裁判不能是其中一个选手的朋​​友。

我们知道有什么信号能完美符合这个描述吗？是的！我们的主角，外部参考信号 $r(k)$ 及其延迟版本。由于 $r(k)$ 驱动整个系统，它当然与构成 $\varphi(t)$ 的输入和输出相关。而且由于它是一个外部信号，它与内部噪声不相关。[@problem_id:2876751] [@problem_id:2883860]

IV 估计器随后通过坚持[工具变量](@article_id:302764) $z(t)$ 与最终预测误差在平均意义上不存在相关性来求解模型参数 $\theta$。这强制产生一个从工具的“无偏”角度来看是一致的解，从而有效地消除了由[反馈回路](@article_id:337231)产生的偏差。[@problem_id:2878962]

### 实验的艺术：提出正确的问题

拥有一个巧妙的[算法](@article_id:331821)是一回事，但与任何科学努力一样，结果的质量取决于实验的质量。你不能仅通过被动观察来辨识一个系统。你必须“激励”它——扰动它，看看它如何响应。

用于激励的信号必须是**[持续激励 (PE)](@article_id:368695)** 的。这个技术术语有一个简单的直观含义：信号必须在频率内容上足够“丰富”，能够“摇动”系统的所有内部动态模式。像[正弦波](@article_id:338691)这样的简单信号只“询问”系统在单一频率下的行为；它无法告诉你其他部分的情况。一个不具备足够阶数[持续激励](@article_id:327541)的信号将导致一个[病态问题](@article_id:297518) (ill-posed problem)，其中某些参数组合无法区分，导致估计[算法](@article_id:331821)无法找到一个单一、清晰的答案。[@problem_id:2883888]

在这里我们面临着[控制工程](@article_id:310278)一个美妙的悖论。一个好的、高性能的控制器旨在*抑制*扰动，并保持输出平滑稳定。它积极地抑制了我们为辨识所需要看到的那些变化！这会使被控对象输入 $u(t)$ 缺乏激励，尤其是在控制器的带宽内，导致[数值条件](@article_id:297213)差和估计结果不可靠。[@problem_id:2883881]

解决方案是掌控实验。我们必须仔细设计我们的外部参考信号 $r(t)$。我们不使用系统正常的、缓慢变化的操作[设定点](@article_id:314834)，而是有意地向其添加一个小的、宽带的“[抖动](@article_id:326537)”或探测信号。这个信号，通常是一个伪随机二进制序列，被设计成[持续激励](@article_id:327541)的。它在很宽的频率范围内注入刚好足够的能量，使系统的动态对我们的辨识[算法](@article_id:331821)可见，而不会显著干扰系统的主要任务。[@problem_id:2892819] [@problem_id:2883888]

最终，在闭环中辨识一个系统是一个克服根本挑战的美好故事。它始于一个悖论——反馈混淆了因果。解决方案来自一个关键的洞见：存在一个独立的外部信号。从这个洞见中，涌现出一套优雅的策略——直接法、间接法和[工具变量法](@article_id:383094)——每一种都是利用这一独立真理的不同方式。最后，它又回到了科学的实践艺术：设计正确的实验，提出正确的问题，并恰到好处地扰动系统，以诱使其揭示其秘密。