## 引言
从我们肠道中的微生物物种到岩石中的矿物含量，许多科学数据集都由代表整体各部分的比例组成。这就是所谓的[成分数据](@article_id:313891)，其决定性特征——所有部分之和必须为一个常数——对传统统计分析构成了深远的挑战。忽视这一约束可能导致矛盾的结果和虚假的结论，这是一个可能误导科学探究方向的关键知识缺口。本文为理解和正确分析这类独特数据提供了全面的指南。首先，“原理与机制”一章将剖析为何标准方法会失效，并引入基于比率的分析这一基本概念以及对数比率转换的变革性力量。随后，“应用与跨学科联系”一章将展示这些方法如何在从解码[微生物组](@article_id:299355)相互作用到理解进化过程等不同领域中，提供更清晰、更准确的见解。

## 原理与机制

想象一下，你正在参加一个派对，有一块切成八片的披萨。如果你拿了两片而不是一片，那么其他人能拿的就少了一片。你的所得即是他们的所失。这看似显而易见，但当我们分析代表整体各部分的数据时，这个简单而不可避免的约束却是深刻而有趣挑战的来源。无论我们关注的是你肠道中不同细菌的比例、细胞中基因的相对表达量，还是岩石中矿物的[质量分数](@article_id:298145)，我们都在处理**[成分数据](@article_id:313891)**。这[类数](@article_id:316572)据的决定性特征是其组分并非相互独立；它们必须加起来等于一个常数（如100%或总数1）。这被称为**闭合**约束，它迫使我们的数据存在于一个称为**[单纯形](@article_id:334323)**的受限几何空间中，而不是我们常用统计工具所设计的广阔开放的[欧几里得空间](@article_id:298501)。忽视这一事实可能导致一些非常奇怪和误导性的结论。

### 整体的“暴政”

让我们深入一个来自[微生物学](@article_id:352078)的真实场景。想象一位研究人员正在研究一个包含四种物种的简单[微生物群落](@article_id:347235)。在对照环境中，所有四种物종的数量相等。然后，研究人员加入一种新药。在处理过的环境中，两种原始物种被消灭，第三种完全不受影响，而第四种对药物有抗性的新物种则茁壮成长，数量急剧增加。

现在，一个标准的程序是分析每个物种的*相对*丰度，因为基因测序仪产生的总读数可能因技术原因而变化。那么，那个完全不受药物影响的物种会发生什么呢？它在对照和处理培养瓶中的绝对数量完全相同。然而，当研究人员计算其相对丰度时，它在处理样本中的比例却急剧下降。为什么？因为耐药性物种的大量繁殖显著增加了群落的总规模（即分母），迫使我们那个稳定物种的*相对*份额缩小 [@problem_id:1425876]。

这不是生物学效应，而是一个数学假象。我们那个稳定的物种并未减少；它只是在最终的统计中被“挤”出去了。这就是整体的暴政：成分中一个部分的剧烈变化迫使其他不相关部分发生表面上的变化。这种效应普遍存在。在单细胞生物学中，一个细胞可能会上调少数特定基因的表达。由于闭合效应，这可能使得成千上万个其他独立调控的基因*看起来*被抑制了，从而在一无生物学关联之处制造出一张**[虚假相关](@article_id:305673)**的网络 [@problem_id:1466116]。常数和约束就像一个隐藏的力量，将所有组分耦合在一起，并引发负相关，使我们误以为存在拮抗作用，而实际上只有算术作用 [@problem_id:2806537]。

### 缺失部分的悖论

[成分数据](@article_id:313891)的奇怪行为甚至更加令人困惑。让我们暂时离开生物学，进入一个化学实验室，分析两种盐水样本$S$和$T$的成分。我们测量四种组分的质量分数：$\mathrm{NaCl}$、$\mathrm{KCl}$、$\mathrm{MgCl_2}$和水。

-   样本$S$：$10\%$ $\mathrm{NaCl}$，$5\%$ $\mathrm{KCl}$，$10\%$ $\mathrm{MgCl_2}$，$75\%$ $\mathrm{H_2O}$。
-   样本$T$：$12\%$ $\mathrm{NaCl}$，$12\%$ $\mathrm{KCl}$，$6\%$ $\mathrm{MgCl_2}$，$70\%$ $\mathrm{H_2O}$。

如果我们比较两者，结论很明确：样本$T$（$12\%$）的$\mathrm{NaCl}$[质量分数](@article_id:298145)高于样本$S$（$10\%$）。

但如果我们只对$\mathrm{NaCl}$和$\mathrm{KCl}$组成的盐子系统感兴趣呢？一个自然的做法是忽略其他组分，并将$\mathrm{NaCl}$和$\mathrm{KCl}$的分数重新归一化，使它们*在该子系统内*的总和为$100\%$。让我们看看会发生什么。

-   在样本$S$中，盐水中$\mathrm{NaCl}$与$\mathrm{KCl}$的部分是$10:5$。重新[归一化](@article_id:310343)后，$\mathrm{NaCl}$的新分数为 $\frac{0.10}{0.10 + 0.05} = \frac{2}{3}$。
-   在样本$T$中，$\mathrm{NaCl}$与$\mathrm{KCl}$的部分是$12:12$。重新归一化后，$\mathrm{NaCl}$的新分数为 $\frac{0.12}{0.12 + 0.12} = \frac{1}{2}$。

突然之间，结论反转了！在$\mathrm{NaCl}$-$\mathrm{KCl}$子系统中，样本$S$（$\frac{2}{3}$）的$\mathrm{NaCl}$相对浓度*高于*样本$T$（$\frac{1}{2}$）[@problem_id:2929996]。这个悖论，即我们的结论会根据分析中包含哪些组分而改变，被称为违反**亚成分一致性**。我们通常关于“更多”或“更少”的思维方式在这里失效了。

### 比率的自由

这类难题预示着我们遗漏了图景中的一个基本部分。将这些碎片拼凑起来的科学家是一位名叫John Aitchison的苏格兰数学地质学家。他意识到问题在于我们过于关注比例本身的[绝对值](@article_id:308102)。他认为，在一个成分世界里，唯一稳定、一致且不受这些悖论影响的信息是组分之间的**比率**。

让我们回到盐水的例子。在样本$S$中，$\mathrm{NaCl}$与$\mathrm{KCl}$的比率是$\frac{0.10}{0.05} = 2$。在样本$T$中，比率是$\frac{0.12}{0.12} = 1$。无论我们是考虑完整的四组分成分，还是只考虑两组分的亚成分，“样本$S$中的$\mathrm{NaCl}/\mathrm{KCl}$比率高于样本$T$”这个陈述都是成立的。在一片变幻莫测的比例海洋中，比率是真理的基石 [@problem_id:2929996]。

这是一个深刻的概念转变。我们必须放弃对单个组分值的分析，转而建立一个全新的、完全基于比率的数学框架——一种新的几何学。这个框架现在被称为**Aitchison几何** [@problem_id:2498662]。

### 透过对数“魔镜”看到的新空间

如果我们的世界是一个比率的世界，我们该如何操作？我们标准的统计工具箱——线性回归、PCA、[t检验](@article_id:335931)——是建立在一个加法、减法和欧几里得空间距离的世界上的。连接比率的乘法世界与线性代数的加法世界的桥梁是对数。**对数比率转换**是解锁[单纯形](@article_id:334323)的关键。

其中最直观的是**中心对数比率（CLR）**转换。对于成分中的每个组分，我们不再看它的值$x_i$，而是看它与一个共同参照物比值的对数。我们应该使用什么参照物呢？为了平等对待所有组分，我们使用整个成分的[几何平均数](@article_id:339220)，$g(\mathbf{x}) = (\prod_{i=1}^{D} x_i)^{1/D}$。于是，每个组分$i$的转换就变为：

$$
\mathrm{clr}(x_i) = \ln\left(\frac{x_i}{g(\mathbf{x})}\right) = \ln(x_i) - \frac{1}{D}\sum_{j=1}^{D} \ln(x_j)
$$

这个简单的操作是革命性的。通过取比率，我们使分析独立于原始总量（如[测序深度](@article_id:357491)），实现了[尺度不变性](@article_id:320629)。通过使用对数，我们从单纯形转移到一个熟悉的[欧几里得空间](@article_id:298501)，在这里，距离和相关性又开始变得有意义 [@problem_id:2498591]。当然，我们不能对零取对数，而零在生物数据中很常见。一个pragmatic的第一步通常是在开始前，通过给所有组分加上一个微小的、恒定的“伪计数”来替换掉零值 [@problem_id:2479916]。

一旦我们的数据进入这个CLR空间，我们就可以计算两个样本之间有意义的距离，比如一个健康人和一个病人。这个距离，称为**Aitchison距离**，就是两个CLR转换后向量之间的标准[欧几里得距离](@article_id:304420) [@problem_id:2538313]。它是对成分结构差异的真实度量，摆脱了我们之前看到的那些假象。

### 用平衡构建：一种优雅的构造

CLR转换是一个巨大的飞跃，但它还有一个小小的怪癖。转换后的组分之和总是为零，这意味着它们并非完全独立，而是被约束在一个超平面上。对于一些高级的统计模型来说，这仍然有点麻烦 [@problem_id:2507155]。

这就引出了[成分数据](@article_id:313891)工具箱中最后也可能是最优雅的工具：**[等距](@article_id:311298)对数比率（ILR）**转换。ILR转换将比率的思想更进了一步。ILR不是将每个组分与一个通用的群落整体平均值进行比较，而是允许我们根据组分群组之间特定的、由假设驱动的比较来定义坐标。这些特殊的坐标被称为**平衡（balances）**。

想象一下，我们正在研究[肠道微生物组](@article_id:305880)，并且我们假设关键的生态动态是[发酵](@article_id:304498)[碳水化合物](@article_id:306837)的细菌（[糖酵解](@article_id:302460)性）与分解蛋白质的细菌（[蛋白水解](@article_id:343080)性）之间的竞争。我们可以定义一个精确捕捉这一概念的平衡 [@problem_id:2806562]。这个平衡本质上是糖酵解性菌群的几何平均值与[蛋白水解](@article_id:343080)性菌群的几何平均值之比的缩放对数：

$$
b_{S \mid P} = \sqrt{\frac{rs}{r+s}} \ln\left(\frac{g(\mathbf{x}_{\text{Saccharolytic}})}{g(\mathbf{x}_{\text{Proteolytic}})}\right)
$$

其中$r$和$s$是每个菌群中的物种数量。这个单一的数字$b_{S \mid P}$成了一个新的变量。正值可能意味着食[碳水化合物](@article_id:306837)的细菌占主导地位，而负值则意味着食蛋白质的细菌占上风。我们可以创建一组这样的平衡，它们完全独立（标准正交），并构成一个真正的、无约束的$(D-1)$维欧几里得空间。

这些ILR坐标非常适合用于任何标准的多变量模型，从回归到机器学习 [@problem_id:2507155]。这是[成分数据](@article_id:313891)方法的终极胜利。我们从产生悖论和假象的数据开始。通过重新思考我们测量的本质，我们最终得到了一个不仅解决了悖论，而且提供了一种强大而优雅的方式来构建有意义的变量以直接检验我们科学假设的框架。我们数据中看似的缺陷，实际上是对其结构更深层次、更优美理解的邀请。