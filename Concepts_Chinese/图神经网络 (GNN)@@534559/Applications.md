## 应用与跨学科联系

在窥探了[图神经网络](@article_id:297304)的引擎室并理解了[消息传递](@article_id:340415)的优雅机制之后，我们现在可以退后一步，见证其应用的惊人广度。这是一段将我们从分子的复杂舞蹈带到物理学基本定律的旅程。你可能会认为，预测一种新药的效果和计算热量在金属板中的流动是两个截然不同的世界。但我们即将看到，它们在一种深刻而美妙的方式下，是同一基本原理的回响：复杂行为源于网络上的局部相互作用。GNN 是我们理解这种相互连接语言的通用翻译器。

### 数字化学家：破译分子语言

让我们从化学世界开始，这是一个非常适合基于图的思维的领域。毕竟，一个分子本身*就是*一个图：原子是节点，将它们连接在一起的[化学键](@article_id:305517)是边。几十年来，化学家们已经建立了关于分子结构如何决定其行为的直觉。GNN 提供了一种将这种直觉提炼成强大计算工具的方法。

考虑一个看似简单的性质，比如分子的沸点。在什么温度下它会从液体变成气体？这并非任何单个原子的属性，而是整个分子的*涌现*属性，更微妙的是，它还取决于分子如何与其邻居相互作用。为了预测这一点，GNN 将分子视为一个图，并执行其[消息传递](@article_id:340415)之舞。每个原子节点根据其成键的邻居更新其状态。经过几轮之后，信息已遍及整个结构。最后的“读出”步骤会将所有最终的原子[嵌入](@article_id:311541)聚合为一个单一的数字——沸点的预测值。当然，挑战在于，二维的[化学键](@article_id:305517)图是一种简化。真实的[沸点](@article_id:300339)取决于三维形状和分子间作用力。一个成功的 GNN 必须学会从简单的图拓扑中推断出这些微妙的、高阶的效应，这是一项了不起的学习成就 [@problem_id:2395444]。

同样的原理可以扩展到生物学的巨头：蛋白质。一个蛋白质的功能不仅取决于其自身的氨基酸序列，还取决于它在细胞内与之相互作用的其他蛋白质网络——即其[蛋白质-蛋白质相互作用网络](@article_id:334970)。在这里，GNN 可以实现信息的完美综合。我们可以使用一种[神经网络](@article_id:305336)，即一维[卷积神经网络 (CNN)](@article_id:303143)，来读取线性的氨基酸序列，就像阅读一个句子一样。这个 CNN 对每个蛋白质的输出成为其初始节点特征。然后，GNN 接管，将这个源自序列的信息在相互作用网络中传播。一个蛋白质最终的、具有上下文感知的[嵌入](@article_id:311541)，告诉我们它的功能，因为它整合了其内部构成和其社交环境 [@problem_id:2373327]。

该领域的终极目标是[理性药物设计](@article_id:343204)。想象你有一个新的候选药物，化合物 X。它有什么作用？它与我们体内数千种蛋白质中的哪一种相互作用？一个在庞大的已知药物-靶点相互作用数据库上训练的 GNN 可以充当“[虚拟筛选](@article_id:323263)”引擎。我们给它化合物 X 的图，它计算出该分子的[嵌入](@article_id:311541)。然后，我们可以让训练好的模型预测化合物 X 与我们虚拟蛋白质组中*每一个蛋白质*发生相互作用的概率。结果是一个排序的预测列表——一组可供我们实验室同事验证的可检验假设 [@problem_id:1436703]。这不仅仅是一个单一的预测；这是一个潜在活性的完整*图谱*，是现代多靶点药理学中的一个关键概念，即单一药物可能具有多种[期望](@article_id:311378)（或不[期望](@article_id:311378)）的效果 [@problem_id:2395415]。我们甚至可以将此应用于连接基因、药物和疾病的庞大异构知识图谱，使用 GNN 来推断缺失的链接，并建议，例如，某种已知药物可能被重新用于治疗一种新疾病 [@problem_id:2413805]。

### 无师自通的学习：科学基础模型的兴起

现代人工智能最伟大的革命之一是[自监督学习](@article_id:352490)的力量，模型通过玩一个巧妙设计的“游戏”从海量未标记数据中学习。这是大型语言模型成功背后的秘诀，同样的想法正在改变 GNN 在科学领域的作用。

考虑一下庞大的公共蛋白质结构数据库。对于其中大多数，我们有原始的 3D 坐标，但没有明确的功[能标](@article_id:375070)签。GNN 如何从这个宝库中学习？我们可以发明一个游戏。取一个蛋白质图，掩盖掉一些[残基](@article_id:348682)（节点），然后要求 GNN 根据周围的上下文预测它们的属性——例如，它们的局部[二级结构](@article_id:299398)（它们是螺旋的一部分还是折叠片的一部分？）。为了解决这个难题，GNN 不能只看它的直接邻居（我们也可能把它们掩盖掉！）；它必须学习蛋白质折叠更深层次的“规则”和“语法”。它必须学习哪些远距离相互作用的模式会产生特定的局部结构。这是一个强大的自监督任务，它使 GNN 对蛋白质生物物理学有了深刻的理解，而这一切都无需任何人工提供的标签 [@problem_id:2395460]。

一旦一个 GNN 以这种方式进行了[预训练](@article_id:638349)，它就成为了化学或生物学的“基础模型”。它拥有可以适应新的、更复杂问题的通用知识。假设我们有一个在数百万个小有机分子上[预训练](@article_id:638349)的 GNN。现在，我们想用它来预测像 DNA 这样巨大的[生物聚合物](@article_id:368448)的性质，这些聚合物含有不同的原子，并受不同的[长程力](@article_id:361141)支配。一个天真的应用会失败。但通过巧妙的策略，我们可以迁移知识。我们可以在未标记的[生物聚合物](@article_id:368448)数据上进行第二轮[自监督学习](@article_id:352490)，以使模型适应新领域。我们可以扩展其词汇表以包含新的原子类型。我们甚至可以用理解 3D 几何的新模块来增强其架构，将新的嫁接到旧的之上。这种[预训练](@article_id:638349)和微调的过程使我们能够解决复杂领域中数据稀缺的问题，站在从更简单、更丰富的数据中学到的知识的肩膀上 [@problem_id:2395410]。

当然，我们必须保持谦逊。模型只能学习数据中统计上存在的东西。如果一个蛋白质形成复合物的倾向完全由其[单体](@article_id:297013)结构中不存在的外部因素决定——比如说，细胞中特定离子的浓度——那么任何只看单个[蛋白质结构](@article_id:375528)的 GNN 都无法希望能预测这种行为。预测的可能性从根本上受限于输入和目标之间的互信息 [@problem_id:2420795]。GNN 是一个强大的侦探，但它找不到不存在的线索。

### 物理学的回响：GNN 作为自然世界的模拟器

也许最深刻的联系是在我们将注意力转向物理学和工程学时发现的。在这里，我们发现[消息传递算法](@article_id:325957)并非计算机科学的任意发明，而是大自然一直在做的事情。

让我们从一个由电阻器组成的简单电路开始。我们可以将其表示为一个图，其中节点是结点，边是电阻器。如果我们在源节点 $s$ 注入电流，并在汇节点 $t$ 取出电流，每个节点的电势将稳定在一个由[基尔霍夫定律](@article_id:360183) (Kirchhoff's laws) 决定的平衡状态。我们如何找到这些平衡电势？一种方法是使用迭代法。我们从一个电势的猜测值开始，然后对每个节点，根据其邻居电势的[加权平均](@article_id:304268)值来更新其电势。这个过程不断重复，直到电势不再变化。

现在，仔细看看这个更新规则。它与 GNN 中的一轮[消息传递](@article_id:340415)完全相同！“消息”是相邻节点的电势，“权重”是电阻器的[电导](@article_id:325643)。GNN 的迭代优化过程无非是对电路在达到最低能量状态时物理松弛过程的模拟。这不是一个类比；这是一个数学上的等价。GNN 重新发现了一种用于求解系统物理方程的经典数值方法（[雅可比迭代](@article_id:299683)法，Jacobi iteration） [@problem_id:3131964]。

我们可以将这个想法更进一步。考虑一个更复杂的问题：预测热量如何流过一个由各向异性材料（如碳纤维复合材料）制成的物体，其中热量在一个[方向比](@article_id:346129)另一个方向更容易流动。这由一个涉及[电导率](@article_id:308242)*[张量](@article_id:321604)*的[偏微分方程](@article_id:301773)来描述。我们可以构建一个在物体网格上运行的 GNN，但我们以一种特殊的、“[物理信息](@article_id:312969)”的方式来做。我们设计[消息传递](@article_id:340415)函数，使其明确遵守物理学的基本定律。我们通过确保消息是反对称的（从 $i$ 流向 $j$ 的热量是从 $j$ 流向 $i$ 的热量的负值）来强制执行[能量守恒](@article_id:300957)。我们通过从旋转不变的[张量](@article_id:321604)收缩中构建其计算，来确保模型是客观的——即其预测不会因我们在空间中旋转物体而改变。

这个 GNN 不再只是一个黑箱模式识别器。它是一个受约束、像物理学家一样思考的学习机器。它是一个灵活、可微的模拟器，可以从数据中学习物理模型的复杂参数，同时保证其预测尊重宇宙的[基本对称性](@article_id:321660)和守恒定律 [@problem_id:2502937]。

从微小分子的[沸点](@article_id:300339)到物理[连续体](@article_id:320471)的模拟，[图神经网络](@article_id:297304)提供了一种统一的语言。它揭示了这些迥异问题的核心是相同的：信息通过局部相互作用网络的传播。它证明了自然世界非凡的统一性，也是我们永无止境地探索和理解自然世界的强大新工具。