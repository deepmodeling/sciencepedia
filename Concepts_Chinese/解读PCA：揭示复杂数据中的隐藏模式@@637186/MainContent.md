## 引言
[主成分分析](@entry_id:145395)（PCA）是数据科学中应用最广泛的技术之一，为简化和可视化复杂的[高维数据](@entry_id:138874)集提供了一种强有力的方法。尽管其数学实现在现代软件中随处可见，但真正的挑战并不在于生成PCA图，而在于正确且富有洞察力地解读它。许多研究人员面对着抽象的得分和载荷图，努力将数学输出转化为有意义的科学叙述，并试图避免将统计[方差](@entry_id:200758)误认为生物学重要性等常见陷阱。本文旨在弥合这一差距。文章的结构首先在PCA的“原理与机制”部分打下坚实的基础，解构[方差](@entry_id:200758)、正交性、得分和载荷等概念，并坦率地探讨其局限性。随后，“应用与跨学科联系”一章将带领读者遍览不同科学领域，展示这些原理如何被用于[分类数据](@entry_id:202244)、揭示基本规律和产生新的假说。通过理解其“如何做”与“为何如此”，您将能够将PCA从一个黑箱技术转变为一个透明而强大的发现工具。

## 原理与机制

想象一下，您是一名宇航员，在夜晚俯瞰一座城市。从某个角度看，它是一片混乱、无形的灯光。但当您的航天飞机绕轨飞行时，您找到了一个新的视角，城市的结构豁然开朗：一条明亮笔直的高速公路变得清晰可见，然后是一条与之垂直的商业大道，接着是住宅区独特的网格布局。城市没有改变，但您的新视角揭示了其内在的组织结构。主成分分析（PCA）就是一种在复杂数据集中找到这些揭示性视角的数学工具。

### 拨开迷雾：寻找变化最大的方向

在科学中，一个数据集可以被看作是高维空间中的一团点云。每个点都是一个样本——一个细胞、一个病人、一颗恒星——每个维度都是一个测量变量——一个基因的表达量、一项临床血液测试结果、在特定颜色滤光片下的亮度。PCA的首要任务就是找到穿过这团点云的、点[分布](@entry_id:182848)得最分散的方向。用统计学术语来说，这个方向捕获了最大的**[方差](@entry_id:200758)**。

这个最初、最重要的方向被称为**第一主成分（PC1）**。为什么这很有趣？因为在许多实验中，最重要的现象会引起数据中最大的变异。考虑一个实验，肝细胞用一种新药“化合物-X”处理 [@problem_id:1440844]。如果该药物具有强大且一致的效果，它会将处理过的细胞的基因表达谱推离未处理的对照细胞。整个数据云沿着这个药物反应的轴线伸展。PCA将准确无误地识别出这个“伸展”程度最大的轴作为PC1。如果您发现PC1解释了总[方差](@entry_id:200758)的绝大部分——比如说85%——并且它完美地将处理过的细胞与对照组分开了，那么您就找到了数据中的主要故事：变异的主导来源是对化合物-X的生物学响应。

### 不相关的艺术：正交性与新视角

在识别出主干道（PC1）之后，PCA并没有停止。它会问：下一个最重要的变异方向是什么？但它增加了一条关键规则：这个新方向必须与第一个方向完全独立。这个属性被称为**正交性**。在几何学中，正交意味着垂直（$90^{\circ}$角）。在统计学和数据的语言中，这意味着新的成分是**不相关**的。

想象一下分析手工巧克力的化学特征 [@problem_id:1461624]。PCA可能会发现PC1代表了一个从“温和奶味”到“浓郁苦味”的轴。这个轴解释了所有巧克力风味中最大的变异。然后，PCA找到了PC2。根据正交性规则，PC2必须描述一个与PC1的苦味无关的变异来源。例如，它可能代表一个从“泥土味”到“果香和花香”的轴。PC1和PC2是正交的，这意味着知道一块巧克力在苦味轴上的得分，对于预测它在果香轴上的得分完全没有任何信息。PCA将原始化学测量中错综复杂的网络，转换成了一个新的、简化的[坐标系](@entry_id:156346)，其中主要的变异特征是分离且独立的。这是一种解构复杂性极其强大的方法。

### 解读地图：得分与载荷

这些新轴——即主成分——为我们的数据提供了一张新地图。但是，没有图例和坐标的地图是无用的。在PCA中，图例和坐标就是**载荷（loadings）**和**得分（scores）**。

一个样本的**得分**就是它在某个主成分轴上的坐标。它告诉你该样本在那个新的变异维度上的*位置*。一个在PC1上具有较大正得分的样本，位于该主轴正方向很远的位置。

但是那个方向*意味着*什么呢？这正是**载荷**告诉我们的。载荷是解释[原始变量](@entry_id:753733)（如基因表达量或化学浓度）如何组合成主成分的“配方”。载荷可以是正的也可以是负的。一个具有较大正载荷的变量对该成分的得分有很强的正向贡献，而一个具有较大负载荷的变量则贡献很强但方向相反。

让我们回到香气的世界，这次是咖啡 [@problem_id:1461604]。假设一个PC轴对于一种有“烘焙”香气的化合物有很大的正载荷，而对于一种有“果香”的化合物有很大的负载荷。如果一个新的咖啡豆样本在这个PC上有一个很大的*正得分*，我们就可以立即推断出它的特性。它必须具有高于平均水平的“烘焙”化合物浓度，和/或低于平均水平的“果香”化合物浓度。载荷是罗塞塔石碑，它让我们能够将抽象的PCA轴转换回我们原始系统中具体的、可解释的属性。

### 初见之险：为何[方差](@entry_id:200758)并非一切

在PCA中，人们很容易只关注PC1。它捕获了最多的[方差](@entry_id:200758)，所以它一定是最重要的，对吗？这是数据分析中最常见也最危险的误解之一。

**统计[方差](@entry_id:200758)与生物学（或科学）重要性并非一回事** [@problem_id:2416103]。想象一下，你在一个派对上想进行有意义的对话。房间里声音最大的人（“[方差](@entry_id:200758)”最大的来源）可能只是在大声谈论天气，而真正有见地的讨论正在一个更安静的角落进行。在数据分析中，情况也常常如此。第一主成分有时可能由无趣甚至不希望看到的变异来源主导，例如测量过程中的技术性假象（“[批次效应](@entry_id:265859)”）或样本收集方式的差异 [@problem_id:3321098]。一个谨慎的分析师在假定PC1是感兴趣的信号之前，总会通过将其得分与实验[元数据](@entry_id:275500)进行关联来研究PC1究竟代表了什么。

反之，一个微妙但深刻的发现可能隐藏在一个仅解释了极小部分[方差](@entry_id:200758)的成分中。在一个大型基因表达研究中，一个仅解释4%[方差](@entry_id:200758)的成分可能看起来微不足道。但如果该成分的载荷都是已知是某种罕见[T细胞](@entry_id:181561)标志物的基因，而该成分上的得分完美地识别出了拥有那种罕见细胞群的5%的患者呢？[@problem_id:3321098]。根据其低[方差](@entry_id:200758)就丢弃这个成分，无异于丢掉一个关键的发现。[方差](@entry_id:200758)的大小是指南，而非定论。

这也帮助我们解读“阴性”结果。如果[肠道微生物组](@entry_id:145456)数据的PCA图显示健康个体与患病患者之间没有分离，这并不能证明微生物组与疾病无关 [@problem_id:1428892]。这仅仅意味着在整个群体中，微生物组的*主导变异模式*（可能由饮食、年龄或地理位置驱动）与该疾病不相关。与疾病相关的信号可能仍然存在，但它可能比这些其他因素弱，或者它可能具有PCA不易发现的结构。

### 线性世界的局限

PCA最大的优点——也是其最大的弱点——在于它的简单性。它用直线看待世界。它寻找数据的最佳*线性*投影。当底层结构在广义上也是线性时，这种方法非常有效。但当数据遵循曲线时会发生什么呢？

考虑[细胞周期](@entry_id:140664)，这是一个本质上是循环的[生物过程](@entry_id:164026)：处于分裂后期（[有丝分裂](@entry_id:143192)）的细胞会成为新周期早期（G1期）的细胞。在基因表达的高维空间中，细胞的状态描绘出一个闭环。当要求PCA在二维空间中表示这个环时，它会用它所拥有的工具——直线——尽力而为。它将环的“直径”——[方差](@entry_id:200758)最大的方向——识别为PC1，并将这个圆形“展开”成一个抛物线或一个弧形 [@problem_id:1428903]。在这个PCA图中，周期的起点和终点本应是邻居，现在却被人为地放在了弧的两端。真实的循环特性丢失了。

对于位于螺旋形或“瑞士卷”[流形](@entry_id:153038)上的数据，这个局限性更加明显 [@problem_id:1946258]。PCA从根本上无法执行“展开”这种形状所需的[非线性变换](@entry_id:636115)。它会将沿曲线路径相距很远的点，投影到二维平面上几乎相同的位置，仅仅因为它们恰好落在了数据云的同一侧。PCA提供了数据尽可能好的线性“阴影”，但对于一个复杂、扭曲的物体，这个阴影可能是对物体本身的高度误导性表征。

### 警示：我们使用的工具塑造了我们看到的结果

最后，有两点实际的警告需要注意，因为PCA的结果不仅是您数据的纯粹反映，也是您作为分析师所做选择的产物。

首先，**缩放很重要**。想象一项研究，测量了数千个基因的表达水平（数值高达50,000）和五十种代谢物的浓度（数值高达15.0）。如果您直接对这些原始数据（在其**[协方差矩阵](@entry_id:139155)**上）执行PCA，分析将几乎完全由基因主导。它们巨大的数值幅度意味着它们的[方差](@entry_id:200758)将使代谢物的[方差](@entry_id:200758)相形见绌 [@problem_id:1428921]。代谢物将实际上变得不可见。解决方案是首先对数据进行缩放，使每个变量的[标准差](@entry_id:153618)都为1。这等同于在**[相关矩阵](@entry_id:262631)**上运行PCA。这个简单的步骤确保了所有变量，无论其原始单位或尺度如何，都有平等的机会对主成分做出贡献。

其次，**您的抽样设计可能制造幻象**。您在PCA图中看到的模式是您选择抽样哪些点的函数。在[群体遗传学](@entry_id:146344)中，众所周知，如果您沿着连续的地理海岸线对个体进行抽样，但在抽样中留下了大的间隙，PCA可能会制造出不同、独立的个体[聚类](@entry_id:266727)的假象 [@problem_id:2800638]。这些[聚类](@entry_id:266727)并非真实存在；它们是您抽样方案中空白空间造成的假象。这个教训是普适的：探险家的地图既取决于他们去了哪里，也取决于那里实际有什么。始终要在数据收集方式的背景下解读您的PCA。

