## 应用与跨学科联系

我们花了一些时间探索基于模拟的推断的内部工作原理，这套机制让我们能够将科学模型与现实联系起来。它是一个强大的引擎，但一个引擎的趣味性取决于它能带我们开启怎样的旅程。现在，让我们离开车间，看看这个引擎能带我们去向何方。我想，你会发现这不仅仅是统计学家的专用工具。它是一种新的镜头，一种新的思维方式，正在消融学科之间的界限，让我们能够提出——并回答——那些曾经遥不可及的问题。这是一门在我们的计算机中构建“玩具宇宙”的科学，其目的不是为了玩乐，而是为了理解真实的宇宙。

### 解码无形之物：从模因到分子

基于模拟的推断最直接的用途是扮演侦探。我们有一个复杂的现象，一个“犯罪现场”，以及一个关于可能发生了什么的 模型，但罪魁祸首——我们模型的基本参数——没有留下直接的指纹。数据的[似然](@entry_id:167119)，即观察到我们所见的确切事物的概率，是一个我们无法穿越的数学迷宫。我们该怎么办？我们进行模拟。我们自己成为罪魁祸首。我们用不同的动机（参数）一遍又一遍地重演犯罪过程，直到模拟的犯罪现场在统计上与真实的无法区分。

想象一下，试图理解一条新闻——或一个模因——如何在像 Twitter 这样的社交网络上传播。这个过程是个人决策的混沌级联。我们不可能写下一个特定的、大规模的推文和转推历史的确切概率。但我们可以提出了一个简单、合理的模型：也许任何时刻新推文的数量是由一些基线噪音，加上一个与近期推文数量成正比的“病毒式”分量所驱动的。这是一个生成模型，一个虚拟 Twitter 的配方。我们无法解出直接连接我们模型参数（基线率和“病毒式”[扩散](@entry_id:141445)率）与观察到的推文量时间序列的方程。但我们不需要这样做。我们可以简单地用试验参数来模拟我们的模型，看看模拟数据的*特征*——它的平均水平、它的波动性或自相关性——是否与真实数据相匹配。通过找到能产生最佳匹配的参数，我们就能推断出信息[扩散](@entry_id:141445)的隐藏动态 ([@problem_id:2401832])。

同样的原理将我们从数字世界带入活细胞的核心。思考基因表达的过程。一个基因的[启动子](@entry_id:156503)可以在“开启”和“关闭”状态之间闪烁，这是一个我们看不见的过程。当它“开启”时，它会以随机爆发的方式大量产生信使 RNA (mRNA) 分子。我们既看不到[启动子](@entry_id:156503)的转换，也无法计算每一个 mRNA 分子。我们看到的是附着在 mRNA 上的荧光标签发出的微弱、充满噪声的光芒。潜在的动力学速率——基因开启和关闭的速度 ($k_{\text{on}}$, $k_{\text{off}}$)、它制造 mRNA 的速度 ($k_{\text{syn}}$)——与我们收集到的嘈杂荧光数据之间的联系，被层层随机性所掩盖。然而，模拟再次伸出援手。通过构建一个状态空间模型来模拟这整个事件链——从隐藏的[启动子](@entry_id:156503)状态到 mRNA 数量，再到最终的噪声测量——我们可以使用[粒子滤波](@entry_id:140084)（一种序贯模拟形式）等技术，从细胞发出的光中推断其内部的新陈代谢节律 ([@problem_id:3347837])。

推断的线索延伸至宏大的演化剧场。适应度，作为自然选择的引擎，由[出生率](@entry_id:203658)和死亡率定义。对于微生物，我们现在可以构建谱系树，追踪每一次细胞分裂和死亡。从这个本身就是复杂分支结构的数据中，我们如何推断潜在的适应度？我们可以将种群的增长建模为一个分支过程。对于这个模型的简单版本，我们或许能够直接计算出生死率。但随着我们增加真实性，直接路径就关闭了。然而，基于模拟的方法仍然可行。我们用不同的出生率和死亡率模拟分支过程，并找到那些能最好地解释观察到的树结构的参数，这使我们能够估计选择系数 $s_i = (m_i - m_0)/m_0$，其中 $m$ 是[马尔萨斯适应度](@entry_id:155166)（[出生率](@entry_id:203658)减去[死亡率](@entry_id:197156)）。这使我们能够量化一个突变的演化优势或劣势，并开始描绘生命演化的“适应度景观”的轮廓 ([@problem_id:3307544])。在每一个案例中，从 Twitter 到基因再到演化，故事都是一样的：当从因到果的路径过于复杂而无法写下时，我们通过模拟原因并匹配结果来开辟一条新路。

### 可能性之艺术：设计更好的实验

也许比解释过去更深刻的能力是明智地规划未来。科学不仅仅是分析我们已有的数据；它还关乎决定要收集什么数据。一个侦探不会擦拭整个城市的所有表面；她会仔细思考哪里最有可能找到信息最丰富的线索。基于模拟的思维让我们能够成为那样有策略的侦探。在踏入田野或实验室之前，我们可以在计算机中预演数千种可能的未来，以设计出最强大、最高效的实验。这就是*[功效分析](@entry_id:169032)*的科学。

想象你是一位生态学家，通过寻找环境 DNA (eDNA)——散落到水中的微量遗传物质——在一条河里寻找一种稀有、难以捉摸的鱼。河水的水流将 eDNA 带到下游，它通过[扩散](@entry_id:141445)散开，并慢慢衰减。如果你在下游的一座桥上取样，你应该多久收集一次水样？一小时一次？还是每十分钟一次？如果取样频率太低，你可能完全错过短暂的 DNA 羽流。如果取样频率太高，则会浪费时间和资源。这是一个非常适合用模拟来解决的问题。我们可以基于[平流](@entry_id:270026)、[扩散](@entry_id:141445)和衰变的物理原理建立一个河流的[计算模型](@entry_id:152639)。我们可以模拟一个来自上游鱼类的假设性 eDNA“脉冲”，并观察模拟的羽流漂过我们的取样点。通过加入取样本身的随机性——我们是否碰巧能在我们的 1 升瓶子里捕获到足够的分子？——我们可以对每个潜在的取样方案运行数千次这个虚拟实验。这使我们能够找到所需的最低取样频率，以便在鱼确实存在的情况下，有比如说 90% 的机会检测到它。这不是推断；这是由模拟驱动的理性实验设计 ([@problem_id:2487967])。

这种[范式](@entry_id:161181)是普适的。演化生物学家面临着同样类型的问题。假设我们想检验一个关于“[跨物种多态性](@entry_id:196940)”的假说，即相同的遗传变异在两个物种间通过[平衡选择](@entry_id:150481)维持了数百万年，甚至在物种形成事件中幸存下来。为了找到证据，我们需要从两个物种中取样并进行测序。但是需要多少个呢？每个物种十个？还是一百个？我们可以通过模拟整个演化故事来回答这个问题：祖先种群、[物种形成](@entry_id:147004)事件，以及随后每个后代谱系中的遗传漂变和选择。通过对不同样本量运行这个模拟，我们可以确定需要收集的最小个体数量，以便有很高的概率（统计功效）检测到共享的多态性，如果它真的存在的话 ([@problem_id:2759484])。无论我们是研究果蝇适应性的地理模式 ([@problem_id:2740237]) 还是近期分化的鸟类的遗传学，这种预先进行“计算机模拟”实验的能力正在改变我们做科学的方式，使其更高效、更有针对性，也更有可能成功。

### 在模拟世界中建立信任

现在，我们必须面对一个深刻而重要的问题。如果我们要如此信任这些模拟世界，我们如何确保我们没有在自欺欺人？正如物理学家 [Richard Feynman](@entry_id:155876) 的名言：“首要原则是，你决不能欺骗自己——而你自己是最容易被欺骗的人。” 基于模拟方法的创造者们深刻地意识到了这一点。随着我们构建的模型变得越来越复杂，我们确保其可靠性和我们自身学术诚信的方法也必须随之进步。

首先，我们如何知道我们的推断机器甚至是否工作正常？如果我给你一把尺子，你可能会用一个已知的标准米尺来检查它，看看它是否校准过。我们必须为我们的推断流程做同样的事情。这就是**基于模拟的校准（SBC）**背后的思想。在我们对真实数据使用我们的流程之前，我们先测试它。我们从其先验分布（我们对参数的初始信念）中生成一个“基准真相”参数值。然后，我们用那个参数来模拟一个虚假的数据集。这个数据集是“完美的”，因为我们知道它来自的确切真相。然后，我们将这个虚假数据输入我们的推断机器，看看它是否能平均地恢复真相。一个优美的数学性质告诉我们，如果我们的算法工作正常，那么“真实”参数在我们获得的后验样本中的秩次应该是[均匀分布](@entry_id:194597)的。如果我们这样做数千次，而秩次在两端或中间堆积起来，我们就知道我们的机器是有偏的——它是一把有问题的尺子，我们在用它测量真实世界之前必须修复它 ([@problem_id:2491986])。

其次，我们必须对我们的假设保持诚实。每个模型都有假设，编码在先验中。贝叶斯模拟的一个强大特性是，我们可以*不带数据*运行模拟。这会从[先验预测分布](@entry_id:177988)中抽样，它向我们展示了仅基于其假设，在看到任何证据之前，我们的模型认为世界是什么样子。在像[系统发育](@entry_id:137790)定年这样的领域，我们用化石来校准分子钟，这一点至关重要。我们对植物和动物分化时间的估计，是由遗传数据驱动的，还是几乎完全由我们的化石先验决定的？将[先验分布](@entry_id:141376)与后验分布进行比较，给了我们一个透明的答案，揭示了我们实际上从数据中学到了多少 ([@problem_id:2590809])。

最后，在这个复杂的计算科学新世界里，“发表”的定义本身必须演进。表格中的最终数字不是真正的结果。科学贡献是整个知识大厦：数据、模型以及连接它们的代码。为了使我们的工作可信，它必须是**可复现的**。这意味着分享完整的流程——确切的脚本、软件版本和[随机数生成器](@entry_id:754049)种子——这样其他人不仅可以得到相同的数值答案，还可以“踢踢轮胎”。他们可以进行自己的敏感性分析，改变先验或[隐藏状态](@entry_id:634361)的数量，看看我们的结论是稳健的，还是我们选择的脆弱产物。这种对透明度和稳健性的承诺，是防止我们自欺欺人的最终保障 ([@problem_id:2722624])。

因此，基于模拟的推断远不止是一系列算法。它是 21 世纪的一种科学哲学。它提供了一个统一的框架，让理论模型和混乱的真实世界数据可以相遇。它给了我们一个望远镜来窥探隐藏的世界，一个绘图板来设计更智能的实验，以及一套原则来确保我们所学到的是真实的。通过拥抱模拟的力量，我们并没有脱离现实。事实上，我们比以往任何时候都更接近它。