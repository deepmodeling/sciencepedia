## 引言
在合成生物学领域，科学家们致力于工程化设计新颖的生物系统——从高效酶到能拯救生命的[细胞疗法](@article_id:372387)。然而，这一宏伟目标面临着一个惊人的挑战：生物设计空间的浩瀚无垠。由于可能存在的DNA或[蛋白质序列](@article_id:364232)数量近乎无限，通过试错法寻找最优设计就像在行星大小的海滩上寻找一粒沙子。传统方法往往过于缓慢、昂贵且依赖运气，因此迫切需要一种更智能的方法来应对这种复杂性。

本文旨在填补这一空白，介绍了[贝叶斯优化](@article_id:323401)这一强大的机器学习框架，它将无指导的搜索转变为一个战略性的、数据驱动的发现过程。它扮演着人工智能探险家的角色，从每次实验中学习，从而对下一次突破可能出现的位置做出越来越有根据的猜测。在接下来的章节中，我们将首先深入探讨[贝叶斯优化](@article_id:323401)的核心“原理与机制”，剖析它如何构建生物学景观的内部地图，并平衡利用已知成功与探索未知领域之间的关键权衡。随后，“应用与跨学科联系”一章将展示这一强大方法如何在现实世界中得到应用，以解决蛋白质工程、受约束的基因设计乃至全基因组改造中的复杂挑战，从而彻底改变现代的设计-构建-测试-学习（Design-Build-Test-Learn）循环。

## 原理与机制

想象你是一位16世纪的探险家，被投放到一片广袤而未知的新大陆。你的任务是找到最高峰。但问题在于，你的补给非常有限，每次测量特定地点的海拔——比如通过放飞一个极其昂贵的一次性气象球——都是一项重大任务。你该把第一个气象球送到哪里？第二个呢？几次测量后，你开始勾勒出一张粗略的地图。你看到这里有上升的斜坡，那里有平坦的平原。现在，你该把下一个气象球送到你当前地图上的最高点，以期证实你的最佳猜测吗？还是该把它送到遥远东方那片你一无所知的神秘迷雾区域，那里可能隐藏着传说中的山脉？

这正是合成生物学家所面临的挑战。这片广袤的大陆就是**设计空间**——所有可能的DNA序列或蛋白质结构的集合，其规模大到难以想象。海拔高度是[生物部件](@article_id:334273)的性能——比如一个[启动子](@article_id:316909)驱动基因表达的强度，或一个酶催化反应的效率。而每一个昂贵的“气象球”都是一次真实、耗时且资源密集的实验室实验。这种结构化探索的现代框架被称为**设计-构建-测试-学习（DBTL）循环**，这是一个系统性的闭环，我们设计一个[生物部件](@article_id:334273)，在实验室中构建它，测试其功能，并从结果中学习以指导下一次设计。“学习”和“设计”步骤正是我方的人工智能探险家——[贝叶斯优化](@article_id:323401)——大放异彩的地方[@problem_id:2723634]。它如何决定下一步去哪里探索呢？

### 人工智能的策略：一张活地图和一个智能罗盘

[贝叶斯优化](@article_id:323401)的核心是一种简单而强大的两部分策略。它不断地构建一张设计景观的“地图”，然后用一个“罗盘”来决定下一次测量的位置。

首先是地图。这张地图不是静态的纸质地图，而是一张活的、概率性的地图，称为**[代理模型](@article_id:305860)**。把它想象成一位聪明的统计学家，他利用你收集的少数数据点，不仅画出一条穿过它们的线，而且画出了一整条代表所有可能景观的“模糊带”。其中一个热门工具是**高斯过程（GP）**，这是一个非常灵活的模型，其基本假设是设计空间中相近的点应具有相似的性能——这在生物学中是一个非常自然的假设。对于任何你尚未测试过的设计 $x$，[代理模型](@article_id:305860)会给你两条关键信息：

1.  一个**均值预测**，$\mu(x)$：这是模糊带的中心，代表模型对点 $x$ 处性能的最佳猜测。这是你地图上最可能的“海拔高度”。
2.  一个**[不确定性度量](@article_id:334303)**，$\sigma(x)$：这是模糊带的宽度。它代表了模型对其预测的*不确定*程度。在已测量点附近，不确定性较低；离已知区域越远，不确定性则越大。

有了这张概率地图，我们如何选择下一个实验呢？这就需要罗盘了，这是一种被称为**[采集函数](@article_id:348126)**的数学方法。它的工作是将地图的预测和不确定性转化为每个潜在实验的单一得分，用以表明在该处采样的“[期望](@article_id:311378)程度”。得分最高的点就是我们的获胜者。

这就引出了所有探索中的一个根本矛盾：**[探索-利用权衡](@article_id:307972)**。我们是应该利用现有知识，还是应该探索以获取新知识？一个流行且直观的[采集函数](@article_id:348126)是**上置信界（UCB）**。对于给定的点 $x$，其得分计算如下：

$$
A(x) = \mu(x) + \kappa \sigma(x)
$$

看，这个公式多么简洁优美。$A(x)$ 分数是一个加权和。第一项 $\mu(x)$ 鼓励**利用**——在模型已预测性能良好的区域，该值较高。第二项 $\sigma(x)$ 鼓励**探索**——在模型最不确定的区域，该值较高。参数 $\kappa$ 是一个我们可以调节的旋钮，用以调整平衡。小的 $\kappa$ 会创建一个“谨慎”的探险家，它会固守已知的优质区域；而大的 $\kappa$ 则会创建一个“冒险”的探险家，它会优先探索未知领域[@problem_id:2018127]。通过选择最大化该得分的点 $x$，我们的人工智能巧妙地平衡了对即时回报的渴望与为未来构建更好地图的需求。

### 两种无知：我们不知道什么 vs. 我们无法知道什么

现在，一位物理学家可能会理所当然地问：“这种不确定性，确切来说，*是*什么？”事实证明，并非所有的不确定性都是一样的。在我们的生物设计探索中，我们的人工智能必须应对两种根本不同类型的无知[@problem_id:2749107]。

第一种是**认知不确定性**（epistemic uncertainty）。这是“模型的不确定性”，或者说“模型不知道什么”。它直接源于数据有限。在设计空间中我们实验很少或没有实验的区域，我们的[代理模型](@article_id:305860)非常不确定，认知不确定性就很大。例如，如果我们的训练数据中不包含带有长串‘A’[核苷酸](@article_id:339332)的DNA[启动子序列](@article_id:372597)，那么当被要求预测这类序列的功能时，模型理应报告较高的[认知不确定性](@article_id:310285)。对于探险家来说，这是“好”的不确定性，因为它是*可减少的*。通过在那个区域进行实验，我们获得知识，那里的认知不确定性就会减小。探索就是寻找并减少认知不确定性的过程。

第二种是**[偶然不确定性](@article_id:314423)**（aleatoric uncertainty）。这是系统本身固有的随机性或噪声，即通过单次测量“无法知道什么”。即使我们有一个完美的模型，用完全相同的[启动子序列](@article_id:372597)重复两次相同的生物实验，也可能得到略有不同的荧光读数。这种变异性源于细胞内[基因表达的随机性](@article_id:361428)，或是来自流式细胞仪等实验室设备的[测量噪声](@article_id:338931)。对于任何单次实验而言，这种不确定性是*不可减少的*。再多的关于*其他*序列的训练数据也无法消除测量一个*新*序列时的[固有噪声](@article_id:324909)。我们的模型必须考虑这种噪声，但它不是探索可以“修复”的。

一个设计精良的[贝叶斯优化](@article_id:323401)循环，使用像[贝叶斯神经网络](@article_id:300883)这样的复杂模型，可以区分这两种不确定性。其策略中的探索部分，即UCB中的 $\sigma(x)$ 项，应主要由认知不确定性——即获取新知识的前景——来驱动[@problem_id:2749052]。

### 征服维度灾难

二维地图的简单画面令人感到安慰，但合成生物学的现实要令人生畏得多。一个由100个氨基酸组成的小蛋白质是一个长度为100的序列，其中每个位置可以是20种可能性之一。这个设计空间的总大小是 $20^{100}$，这是一个庞大到令宇宙中原子数量都相形见绌的数字。这就是臭名昭著的**维度灾难**。我们的探险家如何可能在这样一个超乎想象的广阔景观中找到一个高峰呢？

这时，另一个优美的原则出现了。在许多生物系统中，并非所有维度都同等重要。在一个蛋白质的100个位置中，可能只有5到10个对其功能至关重要；改变其他位置影响甚微。问题的真正复杂性不在于完整的环境维度（$L=100$），而在于一个更小的**内在维度** $d_{\text{eff}}$ [@problem_id:2749095]。一个真正智能的[算法](@article_id:331821)应该能发现这一点，并将其搜索集中在少数几个真正起作用的“旋钮”上。像**自动相关性确定（ARD）**这样的技术，当内建于[高斯过程](@article_id:323592)模型中时，正是这样做的。模型为输入空间的每个维度学习一个单独的“长度尺度”。对于不重要的维度，长度尺度会变得非常大，实际上是在告诉模型：“沿着这个轴移动，性能变化不大，所以不用担心它。”它学会了忽略无关的维度，将其建模能力集中在少数几个重要的维度上，从而极大地缓解了维度灾难。

另一个强大的策略是放弃为整个大陆制作一张完美地图的目标。**信赖域[贝叶斯优化](@article_id:323401)（TuRBO）**[算法](@article_id:331821)的工作方式像一个本地勘测员团队[@problem_id:2749058]。它围绕当前已知的最佳设计建立一个“信赖域”——一块更小、更易于管理的景观区域。然后，它在这个局部区域内进行密集优化。如果它不断找到更好的设计，它就会变得自信并扩大信赖域。如果在几次尝试后未能找到改进，它就会断定局部高峰已经找到，于是缩小区域进行微调，或者放弃该区域，在景观的另一个有希望的部分开始一个新的信赖域。这种“分而治之”的方法防止了[算法](@article_id:331821)在试图一次性为整个广阔空间建模时迷失方向。

### 智能设计的前沿

我们所讨论的原则构成了[贝叶斯优化](@article_id:323401)的基础，但该领域正在不断发展，以应对现代生物学的复杂现实。

-   **基于知识的构建：** 我们很少从完全无知开始。数十年的生物化学和[生物物理学](@article_id:379444)研究为我们提供了机理模型，例如，可以根据物理定律预测蛋白质如何折叠。我们不必从一个白板[代理模型](@article_id:305860)（例如，“零均值”GP）开始，而是可以将基于物理的模型作为我们的初始地图！然后，贝叶斯[代理模型](@article_id:305860)学习一个*差异函数*——它利用实验数据来学习简单的物理模型在哪些地方是错误的以及如何修正它。这种优美的结合使得人工智能能够站在现有科学知识的肩膀上，从而实现更高效的优化[@problem_id:2749126]。

-   **并行实验：** 现代实验室不是一次只进行一个实验；它们使用机器人液体处理工作站和微流控芯片并行运行数十或数百个实验。因此，我们的人工智能探险家不仅要提出下一个实验，还要提出一*批*实验。一种天真的方法是只选择得分最高的 $q$ 个点。但一种更聪明的方法，称为**q-[期望](@article_id:311378)提升（q-EI）**，会选择一个包含 $q$ 个实验的多样化组合，这些实验*作为一个整体*，预计将产生最多的信息。它避免了选择十个几乎相同的点，而是选择一组能够同时探测关于景观的不同假设的实验[@problem_id:2749130]。

-   **[安全设计](@article_id:365647)：** 在寻求高峰的征途中，有些路径比其他路径更危险。某些蛋白质设计可能不仅表现不佳，还可能对细胞产生毒性，或聚集成无用的沉淀物。贝叶斯决策理论允许我们将**[风险规避](@article_id:297857)**编码到人工智能的决策过程中。通过使用一种特殊的[目标函数](@article_id:330966)，该函数对灾难性后果施以重罚，我们可以引导[算法](@article_id:331821)避开那些不仅是次优，而且可能具有危险性的设计空间区域，即使它们预测的性能很高但不确定性也很大[@problem_id:2749066]。人工智能不仅成为一个勇敢的探险家，更成为一个睿智而审慎的探险家。

从[探索与利用](@article_id:353165)之间简单而优雅的权衡，到驾驭高维空间和融合先验知识的复杂策略，[贝叶斯优化](@article_id:323401)为自动化科学发现提供了一个强大且有原则的框架。它是驱动现代[DBTL循环](@article_id:345026)的引擎，将生物设计的艺术转变为一门数据驱动的科学，一次一个智能实验。