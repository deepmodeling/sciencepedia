## 引言
我们的基因组是生命之书，但这本书记载的故事有两个截然不同的版本：一个继承自母亲，另一个继承自父亲。几十年来，基因组学领域的挑战一直是独立且准确地读取这两个略有差异的副本——即我们的单倍型。依赖于单一、标准化“参考基因组”的传统方法，实际上是将这两个版本混杂在一起，从而产生一个模糊且常常具有误导性的共识序列。这种对单一图谱的依赖引入了一种系统性误差，即参考偏倚，长期以来阻碍了我们对遗传多样性的理解。本文旨在填补这一根本性空白，介绍一种基因组分析领域的范式转变：**单倍型穿线**。这是一种巧妙的计算策略，它通过一张更具包容性的基因组图谱（称为变异图或[泛基因组](@entry_id:149997)）来重建个体独特的两个单倍型。在接下来的章节中，我们将首先探讨该方法背的核心原理和机制，理解它如何从一个有缺陷的[线性模型](@entry_id:178302)转向一个丰富的[二倍体](@entry_id:268054)表征。随后，我们将揭示其在生命科学领域的变革性应用——从提高临床诊断的准确性到实现真正的[个性化医疗](@entry_id:152668)——展示学会阅读我们遗传之书的两个卷册，是如何彻底改变生物学的。

## 原理与机制

为了真正领会单倍型穿线的精妙之处，我们必须首先踏上一段旅程，就像物理学家探索新大陆一样。我们从一个简单而熟悉的世界模型开始，发现它的局限性，然后被迫建立一个更丰富、更优美的模型。我们的旅程始于“人类基因组”这个概念本身。

### 单一参考基因组的束缚

几十年来，我们拥有的人类基因组图谱一直是一条单一的[线性序](@entry_id:146781)列——著名的**[参考基因组](@entry_id:269221)**。可以把它想象成一座广阔而复杂城市的总蓝图。对于许多任务，比如寻找一个主要地标，这张图谱非常有用。我们可以从某人身上获取一小段DNA序列——一个**读段（read）**——然后在图谱上找到它的位置，这个过程称为比对。

但是，当我们测序的个体其遗传祖源与贡献该总蓝图的少数个体差异巨大时，会发生什么呢？他们所在城市的“街区”可能有不同的街道布局——街道名称的微小变化（[单核苷酸多态性](@entry_id:173601)，即**SNP**），甚至整个街区的缺失或多出几条死胡同（[插入和删除](@entry_id:178621)，即**indel**）。当我们试图将来自这个不同街区的读段强行匹配到我们的总蓝图上时，问题就出现了。比对算法会寻求“最佳匹配”，并将这些差异视为错误。一个差异过多的读段可能会被完全丢弃，或者更糟的是，被映射到错误的位置。

这不是一个随机误差，而是一种被称为**参考偏倚**的系统性误差 [@problem_id:4375961]。想象一下，一个比对算法就像一个非常严格的快递员，试[图匹配](@entry_id:270069)一个地址。来自与参考基因组匹配的单倍型的读段，就像一个完美的地址标签——它能被高[置信度](@entry_id:267904)地送达。但是，一个来自具有许多差异（包括插入等[结构变异](@entry_id:173359)）的单倍型的读段，就像一个有拼写错误和街道名不存在的标签。快递员可能会放弃（读段未映射），或将其送到看起来最相似的错误地址（读[段错误](@entry_id:754628)映射）。

这种来自非参考单倍型的读段的系统性丢失会产生深远的影响。在一个杂合位点，即个体拥有一个参考等位基因和一个非参考等位基因，我们期望看到测序读段呈50/50的比例。但由于参考偏倚，支持非参考等位基因的读段会被优先丢失。观察到的比例可能变成70/30甚至更差，使得这个人看起来像是参考等位基因的纯合子。这并非数据不足的问题；再多的额外测序也无法修[复图](@entry_id:199480)谱本身的系统性偏倚 [@problem_id:4375961]。我们需要一张更好的图谱。

### 新的图谱：变异图

解决方案是放弃单一线性图谱的想法，转而创建一个更丰富、更具包容性的图集。这个新图集就是**变异图**，或称**[泛基因组](@entry_id:149997)** [@problem_id:5067211]。它不再是一条线，而是一个路径网络。

再想象一下我们的城市地图。变异图不仅展示了市中心的主要区域，它还包括了所有不同的街区，并将它们所有独特的街道交织在一起。在对每个人都相同的街道处，图中的路径会合并。在它们出现[分歧](@entry_id:193119)的地方——比如在一个SNP或indel处——图会分裂成一个包含多条平行路径的“气泡”，每条路径代表序列的一个不同版本，然后在序列再次变得相同的地方重新[汇合](@entry_id:148680) [@problem_id:4579458]。

从形式上讲，变异图是一个节点由DNA序列标记、有向边定义这些序列如何连接的结构。一个**单倍型**——即你某条染色体的序列——对应于一条从图的起点到终点的完整路径 [@problem_id:4604788]。通过包含来自不同人群的常见遗传变异，该图不仅代表了一个基因组，而是数千个基因组，并将它们全部整合在一个统一的结构中。

这个巧妙的结构从根本上解决了参考偏倚的问题。当我们比对来自某个个体的读段时，比对器现在可以在图中找到一条与该读段真实序列完全匹配的路径，即使它包含非参考变异。比对分数会很高，[映射质量](@entry_id:170584)也会很高，读段会被正确定位。对非参考等位基因的系统性惩罚就此消失了 [@problem_id:4617244]。对于一个[二倍体](@entry_id:268054)个体，我们现在有了一个公平的竞争环境：来自母源单倍型的读段可以完美地比对到它们的路径上，而来自父源单倍型的读段也可以完美地比对到它们的路径上，从而恢复了预期的50/50平衡 [@problem_id:4376068]。

### 穿针引线：寻找你的路径

变异图带来了一个全新而美妙的挑战。它包含了数量惊人的潜在路径。我们如何找到与我们刚测序的个体那两个单倍型相对应的特定路径对呢？这就是**单倍型穿线**的魔力所在。

单倍型穿线是一种算法策略，它将“群体智慧”与来自个体自身DNA的特定证据相结合，以找到通过图的最可能路径。这个过程是贝叶斯推断在实践中的一个绝佳范例 [@problem_id:4569931]。

首先，我们需要在图中高效地存储和搜索海量的已知单倍型集合。这通过一种名为**图谱[Burrows-Wheeler变换](@entry_id:269666)（GBWT）**的专门[数据结构](@entry_id:262134)来实现。你可以将GBWT看作是每个已知路径的超高效索引，它允许我们提出诸如“有多少已知的单倍型通过这一系列特定的变异位点？”之类的问题 [@problem_id:4569931]。

现在，为了“穿引”一个新样本的单倍型，我们寻求在给定测序读段$R$的情况下，使其**后验概率**最大化的路径$h$。这听起来很复杂，但可以分解为两个直观的组成部分：

1.  **[先验概率](@entry_id:275634), $P(h)$:** 这条单倍型路径本身存在的可能性有多大？我们利用存储在GBWT中的群体知识来回答这个问题。在人群中常见的路径会被赋予更高的[先验概率](@entry_id:275634)。这就是“群体智慧”部分——我们首先倾向于那些已知是常见的解释。

2.  **似然性, $P(R | h)$:** 如果真实的单倍型确实是路径$h$，我们观测到我们这组测序读段$R$的概率是多少？这是“个体证据”部分。我们将[读段比对](@entry_id:265329)到候选路径$h$上。如果读段与路径的序列完美匹配，且错误很少，那么似然性就非常高。如果它们匹配不佳，似然性就很低 [@problem_id:4616864]。

单倍型穿线就是寻找路径$h$的计算过程，该路径具有这两个因素的最佳组合——既在群体中有一定的普遍性，又能为个体的测序数据提供极佳的解释。算法在图中“穿行”，探索路径，并基于先验知识和新证据的强力组合对其进行评分。

对于一个[二倍体](@entry_id:268054)个体，我们执行此过程以找到两个最可能的路径，代表两个单倍型。这比仅仅了解变异更有力；它关乎了解变异如何在一条染色体上连锁在一起——这个过程称为**定相（phasing）** [@problem_id:4376068]。长测序读段和Hi-C等其他技术为此提供了关键信息，它们如同物理的“线”，连接了远距离的变异位点，告诉我们它们必须属于同一条路径 [@problem_id:4552691]。

通过找到最可能的一对单倍型，我们为该个体创建了一个个性化的[二倍体](@entry_id:268054)参考。然后，我们可以将他们所有的读段以近乎完美的准确度映射到这两条特定路径上。这种改进并非微不足道；正确比对的似然性可能比对到一个通用的线性参考高出许多数量级 [@problem_id:4376068]。这种新获得的清晰度是最终目标，它将一个有偏倚且不完整的图像转变为个体基因组的高保真[二倍体](@entry_id:268054)视图。这是一段从有缺陷的“一刀切”模型到拥抱人类多样性核心的美丽、统一框架的旅程。尽管即使是这个先进的模型也有其局限性，例如当一个真正新颖的单倍型根本不在我们的图中时 [@problem_id:4569938]，但它代表了我们在阅读和理解生命之书的能力上的一次巨大飞跃。

