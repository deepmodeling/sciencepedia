## 引言
在探索生命复杂性的过程中，我们面临一个根本性的困境：我们可以识别组织中的每一个单细胞，或者绘制其整体结构，但无法同时做到两者。单细胞技术提供了细胞类型的完整目录，即“是什么”，而[空间组学](@entry_id:156223)则提供了它们大致位置的地图，即“在哪里”。关键的知识鸿沟在于如何融合这两种视角，以创建一个单一的、高分辨率的图谱，揭示细胞如何组装形成功能性组织。本文旨在通过全面概述单细胞和[空间组学](@entry_id:156223)整合来应对这一巨大挑战。首先，我们将探讨核心的“原理与机制”，剖析用于整合不同数据集的各种数学和统计策略，从贝氏解卷积到优雅的最优传输理论。随后，我们将探索“应用与跨学科联系”的广阔领域，发现这些整合图谱如何重塑我们对器官发育、[细胞通讯](@entry_id:148458)以及细胞类型定义的理解。通过连接这两个世界，我们正开始破译生物学的结构蓝图。

## 原理与机制

想象一下，你拥有关于一个宏伟而复杂组织（如发育中的大脑或复杂的肿瘤）的两份不完整信息。第一份信息是一套完整的调色板，包含了该组织内存在的每一种独特细胞类型——一份关于“成纤维细胞”、“神经元”、“免疫细胞”等的生动目录。你知道它们精确的分子身份，就像拥有每种油漆颜色的完美色板一样。但你不知道这些细胞在组织中的位置。这就是**[单细胞RNA测序 (scRNA-seq)](@entry_id:754902)** 提供给我们的信息。

第二份信息是一张模糊的、像素化的组织照片。你可以看到整体结构，但每个像素都是一个粗略的混合物，是碰巧落入其中的所有细胞信号的混合体。你无法分辨单个细胞。这就是**[空间转录组学](@entry_id:270096) (ST)** 提供的信息。

单细胞和[空间组学](@entry_id:156223)整合的巨大挑战在于，利用[scRNA-seq](@entry_id:155798)提供的完美调色板，对空间照片进行数字化“去模糊”，重建一张生动的高分辨率组织图谱。我们如何在這“是什么”（细胞身份）和“在哪里”（它们的空间位置）之间架起一座桥梁呢？答案在于一系列优美的数学和统计原理，每一种都针对我们试图整合的数据的特定性质而量身定制。

### 数据的多样性：为何没有一刀切的方法

我们的第一步是认识到并非所有生物数据都“说”同一种语言。不同的技术以不同的方式测量不同的事物，每种技术都有其特有的“噪音”或“口音”。一个聪明的整合策略必须像一个多语言者，精通每种数据类型的母语 [@problem_id:3320368]。

一些最常见的空间技术包括：

-   **基于斑点的方法（如Visium）：** 这些是我们“模糊像素”的来源。每个斑点捕获一[小群](@entry_id:198763)细胞（通常是5-20个）的遗传物质。数据以分子的**计数**形式出现，但这些计数是出了名的嘈杂。它们不遵循简单的钟形曲线；相反，用**负二项**[分布](@entry_id:182848)来描述更为合适。这一统计事实至关重要，因为它承认了基因表达的变异性通常远大于人们凭直觉预期的程度。处理这些数据的主要挑战是，每个斑点都是一个混合物，一个我们需要识别其成分的生物冰沙。

-   **基于成像的高通量方法（如[smFISH](@entry_id:180372)或[MERFISH](@entry_id:191159)）：** 这些方法就像使用放大镜在单细胞内逐一计算单个RNA分子。因为我们计算的是离散事件，数据完美地遵循**泊松**[分布](@entry_id:182848)，这是计算独立事件的一个基本定律。其代价是，这些方法虽然能提供惊人的单细胞甚至亚细胞分辨率，但通常一次只能测量几百个基因，远不及[scRNA-seq](@entry_id:155798)测量的数万个。

-   **成像质[谱流](@entry_id:146831)式技术 (IMC)：** 该技术使用重金属原子标记蛋白质，为我们提供细胞分辨率下蛋白质丰度的图像。与其他方法不同，数据根本不是计数，而是**连续的强度**。这些信号最好用正连续值的[分布](@entry_id:182848)来建模，例如**对数正态**[分布](@entry_id:182848)。此外，IMC测量蛋白质，而[scRNA-seq](@entry_id:155798)测量RNA。整合它们需要跨越[生物学中心法则](@entry_id:154886)，将信息从转录本的世界转换到蛋白质的世界。

这里传达的核心信息是深刻的：测量的物理过程决定了我们必须使用的数学方法。没有通用的算法。一个成功的整合策略必须像一套定制的西装，根据所涉及的每个数据集独特的分辨率、[多重性](@entry_id:136466)及统计“面料”量身定制 [@problem_id:3320368]。

### 寻找共同语言：标准化与对齐

在我們能夠在數據集之間進行轉換之前，必須確保它們處於可比較的尺度上。這絕非易事。來自一項實驗的細胞可能測序到10,000個總RNA分子，而另一項實驗的另一個細胞可能有50,000個。這是一種稱為“測序深度”的技術人為因素，必须予以校正。

一个简单的方法是直接除以总计数。但一个更微妙的问题潜藏其中：不同技术有不同的灵敏度。对于同一个细胞中的同一个基因，灵敏的[scRNA-seq](@entry_id:155798)检测可能检测到10个分子，而灵敏度较低的空间检测可能只检测到2个，甚至0个（“脱落”）。这种检测效率的差异就像两位摄影师拍摄同一场景，但其中一位的相机在捕捉红光方面系统性地更优越。他们的照片会有不同的色彩平衡。

我们如何纠正这一点？如果我们不能相信[绝对值](@entry_id:147688)，或许我们可以相信相对的**排序**。这就是基于排序的标准化背后的优雅思想 [@problem_id:3320438]。对于一个给定的基因，我们不比较其在不同数据集间的原始表达值，而是比较它的排序。对于该基因，它是否是表达最高的细胞？最低的？还是介于中间？通过将所有表达值转换为排序，然后将它们映射到一个共同的[分布](@entry_id:182848)（如[均匀分布](@entry_id:194597)或[正态分布](@entry_id:154414)），我们以一种对这些复杂的[非线性](@entry_id:637147)扭曲具有鲁棒性的方式对齐了数据集。我们不再是比较苹果和橙子，而是比较它们在各自水果篮中的相对位置。

即使在[标准化](@entry_id:637219)之后，数据集也可能被“批次效应”所扭曲，这就像一个哈哈镜扭曲了数据的几何形状。为了纠正这一点，我们可以使用一个聪明的想法，称为**互近邻 (MNN)** [@problem_id:3320436]。想象你有两组人，每组都是分开拍照的。MNN原理指出，要寻找成对的个体，每张照片中各一个，他们之间有相互的“最好朋友”关系。如果照片1中的A说照片2中的B是其最接近的匹配，*并且*B说A是*其*最接近的匹配，我们就找到了一个MNN对。这种相互的认同是一个非常强的信号，表明这两个个体真正对应于相同的底层身份。这些MNN对充当锚点，创建一个强大的局部地图，使我们能够通过计算“解开”扭曲，并将两个数据集融合成一个单一、连贯的空间。

### 宏观策略I：解卷积，或分离混合物

一旦我们的数据使用共同的语言，我们就可以开始重建。第一个宏观策略，主要用于基于斑点的数据，是**解卷积** [@problem_id:2673487]。这是经典的“解混”问题。空间斑点的表达谱被建模为来自我们[scRNA-seq](@entry_id:155798)参考的纯细胞类型的表达谱的加权平均。在数学上，这看起来很简单：

$$
\text{Expression}_{\text{spot}} = \sum_{\text{types}} \text{Proportion}_{\text{type}} \times \text{Expression}_{\text{type}}
$$

目标是找到未知的比例。现代方法从**贝氏**视角来处理这个问题 [@problem_id:3320367]。它们不是为比例找到一个单一的“最佳”答案，而是计算一个完整的**[后验概率](@entry_id:153467)[分布](@entry_id:182848)**。输出不是“斑点1是50%的A类型和50%的B类型”，而是“斑点1中A类型的比例在45%到55%之间的概率为95%。”这为我们提供了对自己不确定性的一个关键度量，一个对我们能从数据中得出什么和不能得出什么的诚实评估。通过整合空间信息，这些模型可以变得更加强大。例如，我们可以构建一个常识性的先验，即组织中相邻的斑点可能具有相似的细胞类型组成，利用周围的“像素”来帮助去模糊中心的那个 [@problem_id:3320367]。

### 宏观策略II：[矩阵分解](@entry_id:139760)，或发现配方

另一种强大且可替代的策略是使用**[矩阵分解](@entry_id:139760)** [@problem_id:3320406]。这里的思想是，一个细胞的身份不是由单个基因决定的，而是由称为“基因程序”或“因子”的[协调基](@entry_id:747690)因群决定的。我们可以想象存在一套通用的基因程序——成为某种细胞的“配方”——而每个细胞只是以不同的量表达这些配方。

我们可以将我们的基因表达矩阵 $X$ （细胞 $\times$ 基因）分解为两个更小的矩阵：$X \approx L \times S$。

-   $S$ （因子 $\times$ 基因）是配方矩阵。每一行是一个基因程序，指定了哪些基因参与其中以及它们的强度。
-   $L$ （细胞 $\times$ 因子）是用法矩阵。每一行告诉我们一个特定的细胞在多大程度上使用了 $S$ 中的每一种配方。

一个关键的挑战是这种分解不是唯一的。你可以在数学上“旋转”因[子空间](@entry_id:150286)，方程仍然成立，但因子本身会变成无意义的基因混合物。为了找到具有生物学意义的配方，我们必须根据我们对生物学的知识施加约束 [@problem_id:3320406]：

-   **非负性：** 一个细胞不能“负”使用一个基因程序，一个基因也不能“负”参与其中。施加这个简单的约束（$L \ge 0, S \ge 0$）极大地简化了[解空间](@entry_id:200470)，并常常揭示出可解释的、基于部分的因子。
-   **[空间平滑](@entry_id:202768)性：** 对于空间数据，我们可以强制矩阵 $L$ 中相邻斑点的因子用法应该相似。

这种方法不仅仅是分配细胞类型；它发现了单细胞和空间数据中共享的潜在生物学“程序”，从而提供了对组织更深入、更机械的理解。

### 优雅的折衷方案：最优传输

第三种，一种特别优雅的方法，是由**最优传输 (OT)** 理论构建的 [@problem_id:3320381]。想象一下，我们的单细胞是一堆堆的泥土，而我们的空间位置是需要填充的洞。OT找到了将泥土移动以填充洞的最“成本效益”的方式。“成本”是细胞表达谱与位置表达谱之间的不相似性。

OT问题的解不是一个僵硬的[一对一映射](@entry_id:183792)，而是一个“传输计划” ($T$)。这个计划本质上是概率性的。它可能告诉我们，来自我们[scRNA-seq](@entry_id:155798)数据的特定细胞有70%的可能映射到斑点1，30%的可能映射到斑点2。从这个概率地图中，我们可以计算每个细胞的“[重心](@entry_id:273519)”坐标——它在组织中的预期位置，精美地总结了每种细胞类型最可能的空间来源 [@problem_id:3320381]。

### 诚实的答案：拥抱不确定性

在所有这些复杂算法的背后，有一个基本真理：我们的重建永远不可能是完美的。我们能知道的东西有物理上的限制。例如，对于基于斑点的技术，存在一个与斑点大小成比例的内在误差；斑点越大，通过平均丢失的信息就越多 [@problem_id:3320416]。

这就是为什么最先进和最诚实的方法不给我们一个单一的、确定性的答案。它们拥抱不确定性。无论是通过贝氏解卷积的后验分布 [@problem_id:3320367]，还是通过最优传输的概率映射 [@problem_id:3320381]，目标都是描述可能性的范围。结果不是一幅单一、清晰的组织画作的重建，而是一幅略带模糊的画作，其中每个区域的模糊程度精确地告诉我们对预测的信心有多大。这不是方法的失败；而是一个好方法的标志。这是科学能提供的诚实且最终最有用的答案。

