## 引言
几十年来，生物学家通过测量数百万个细胞的平均活性来研究组织，得到的是一张模糊的、平均化的图像，好比一张城市的夜间航拍照片。[单细胞分析](@article_id:338498)的革命改变了这一切，它提供了成千上万个独立的分子画像，让我们能够“身临其境”。然而，这股高分辨率数据的洪流也带来了新的挑战：我们如何对这堆杂乱无章的画像进行分类，以找到潜在的细胞群落？这正是[细胞类型聚类](@article_id:334826)的根本目标，它是一个计算过程，根据细胞的共同特征将其分组为有意义的家族，从而揭示它们的身份和功能。本文为这一关键方法提供了全面的指南。在第一部分“**原理与机制**”中，我们深入探讨“如何做”——探索从杂乱的高维数据到关键步骤（如清洗、[降维](@article_id:303417)和应用[聚类算法](@article_id:307138)）的全过程。然后，我们将在“**应用与跨学科联系**”中探讨“为什么做”，展示[聚类](@article_id:330431)如何被用于构建基础[细胞图谱](@article_id:333784)，解析癌症等[复杂疾病](@article_id:324789)，并建立对细胞定义的多元理解。

## 原理与机制

想象你是一名侦探，试图了解一个复杂城市的运作方式。你可以拍一张夜间航拍照片，它会向你展示城市的整体光亮——一幅美丽但模糊的平均图像。你也许能看到市中心比郊区更亮，但你无法区分一个繁华的餐饮区和一个灯火通明的工厂。这就是**批量分析**（bulk analysis）的世界。几十年来，我们就是这样研究生物学的。我们会磨碎一块组织——比如说一块肝脏——然后测量其中所有基因的平均活性。我们得到的是一张模糊的、平均化的图像。

但是，如果一种新药旨在平息城市里过度活跃的警察部队（免疫细胞），同时不影响面包店和办公室（代谢细胞）呢？你的航拍照片将无济于事。你需要亲临现场，需要逐个调查每栋建筑、每个人。这就是**[单细胞分析](@article_id:338498)**（single-cell analysis）的革命。我们不再得到一个模糊的平均值，而是成千上万个独立的分子画像。但这又带来了一个新问题：我们现在有成千上万张杂乱无章的画像，我们需要对它们进行分类。谁是警察？谁是面包师？这种分类的行为，即在人群中寻找隐藏群落的过程，正是**[细胞类型聚类](@article_id:334826)**（cell type clustering）的根本目标 [@problem_id:1530877] [@problem_id:2350895] [@problem_id:1714816]。其科学目标不仅仅是整理数据，而是根据细胞共享的基因表达模式将其分组为有意义的家族，从而揭示潜在的细胞类型及其功能。

### 一场进入高维空间的旅程

你可能会认为对这些画像进行分类很容易。我们难道不能……看看它们，然后按相似性分组吗？问题在于，每个细胞的“画像”并非由两三个特征构成，而是由大约20000个基因的表达水平绘制而成。我们被要求在一个20000维的空间中寻找模式。我们的大脑为了适应三维世界而进化，对于在如此浩瀚的景观中，“距离”或“接近”究竟意味着什么，我们完全没有直觉。这就是著名的**维度灾难**（curse of dimensionality）。在高维度中，所有东西似乎都与其他所有东西相距甚远，“密集邻域”的概念也随之瓦解。

为了摆脱这个诅咒，我们需要一种方法将这个极其复杂的空间映射到我们能理解的东西上，比如一个二维图。这就是**[降维](@article_id:303417)**（dimensionality reduction）[算法](@article_id:331821)的工作，例如**主成分分析（PCA）**或**[均匀流](@article_id:336471)形逼近与投影（UMAP）**。其主要思想是找到数据中最重要的变异“方向”，并将细胞投影到一个保留其本质关系的低维地图上 [@problem_id:1714794]。可以把它想象成制作一张平面的世界地图。你无法在一张平纸上完美地呈现一个球体而不产生任何扭曲，但一张好的地图（如墨卡托投影或温克尔三重投影）会保留你关心的基本特征，比如大陆的相对位置和形状。同样，UMAP为我们的细胞创建了一个二维“地图”，其中具有相似基因表达谱的细胞会聚集在一起，形成独特的“岛屿”，而这些岛屿可能正是我们的细胞类型。

### 准备画布：数据清洗的艺术

然而，在我们能绘制这幅美丽的地图之前，必须进行一番严肃的整理工作。来自单细胞实验的原始数据是杂乱的，既充满了技术噪音，也包含我们可能不感兴趣的生物信号。一位伟大的艺术家不会随手将颜料泼在肮脏的画布上；他们会一丝不苟地准备画布。

首先，我们进行**质量控制**（quality control）。我们必须毫不留情地丢弃坏数据。例如，在一个典型的实验中，一些“细胞”检测到的基因数量会低得离谱。人们很容易认为这是一种特殊的、安静的细胞类型。但更可能也更平庸的现实是，它们根本不是细胞。它们是技术性假象：一个捕获了周围漂浮的零散RNA的空油滴，或是在样本制备过程中死亡并破裂的细胞，只留下了其破碎的残骸。在分析中保留这些垃圾，就好比试图建立一个包含鬼魂和影子的家谱；它会扭曲整个画面 [@problem_id:1714811]。

接下来，我们必须面对混杂变量。最常见的一个是**[批次效应](@article_id:329563)**（batch effect）。想象两位摄影师为同一群人拍照，但一位使用带深褐色调的古董相机，另一位使用现代智能手机。最终的照片会看起来非常不同，不是因为人变了，而是因为设备变了。同样，当我们在不同日期或使用不同批次的试剂进行实验时，我们会引入一种技术性标记，它可能强大到完全掩盖细胞间微妙的生物学差异。如果我们不小心，我们的[聚类算法](@article_id:307138)会兴高采烈地将细胞分为“批次1”和“批次2”，这是一个统计上合理但生物学上毫无用处的结果。因此，一个关键步骤是在[聚类](@article_id:330431)*之前*应用**[批次校正](@article_id:323941)**（batch correction）[算法](@article_id:331821)。这些智能的统计工具试图对齐数据集，就像照片编辑器调整两位摄影师作品的色彩平衡和对比度，以便我们最终能比较人本身 [@problem_id:2374346]。

但并非所有不想要的变异都是技术性的。有时，生物学本身也会造成干扰。考虑一个发育中的大脑样本，它充满了正在活跃分裂的干细胞。任何两个干细胞之间最显著的差异可能不是它们的最终命运，而是一个正处于静息状态（[细胞周期](@article_id:301107)的G1期），而另一个则在忙于复制其DNA（S期）或分裂成两个（M期）。如果我们不小心，我们的[算法](@article_id:331821)会根据这种短暂的增殖状态对细胞进行分组，创建一个“分裂细胞”簇和一个“静息细胞”簇，从而掩盖了我们寻求的更根本的身份。在这种情况下，我们可以通过计算“回归去除”（regress out）与[细胞周期](@article_id:301107)相关的基因，实质上是告诉[算法](@article_id:331821)忽略这个变异来源，专注于更稳定的身份标记 [@problem_id:2350948]。

最后，有了一个干净的数据集，我们必须选择要关注的特征。在20000个基因中，许多是“管家”基因，它们在每个细胞中都开启，对于区分不同细胞类型几乎不提供信息。标准方法是选择几千个**高变基因（HVGs）**——那些在整个数据集中表达水平变化最大的基因。其逻辑是，这些基因在定义细胞身份方面扮演着有趣的角色。这是一个强大且必要的步骤，但它也带有一个微妙的风险。通过只关注*最*易变的基因，我们可能会错过那些安静的基因。想象两种非常相似的[神经元](@article_id:324093)亚型，它们仅通过少数几个基因表达上微小但持续的差异来区分。这些基因在*整个*数据集中的方差可能不高，并可能被过滤掉，使得[算法](@article_id:331821)永远无法区分这两个关键的亚型 [@problem_id:2350941]。这提醒我们，流程中的每一步都是一个有后果的选择。

### 寻找群落：两种哲学的故事

准备好画布后，我们终于可以让[聚类算法](@article_id:307138)施展它们的魔力了。但事实证明，没有单一的魔杖。不同的[算法](@article_id:331821)体现了关于“簇”是什么的不同哲学。

一类[算法](@article_id:331821)，包括流行的**[t-SNE](@article_id:340240)**和**UMAP**，基于[流形学习](@article_id:317074)。它们假设数据位于高维空间中一个复杂、扭曲的表面（即[流形](@article_id:313450)）上。它们的目标是创建一个保留该表面局部邻域结构的低维地图。它们执着于将朋友们保持在一起。如果细胞A在原始的20000维空间中与细胞B接近，[算法](@article_id:331821)会尽最大努力将它们放在二维地图上的相邻位置。然而，为了实现这一点，它愿意在全局距离上“随心所欲”。在UMAP图上，两个相距遥远的簇之间的距离不一定有意义 [@problem_id:2866331]。

第二种哲学基于图论。像**PhenoGraph**和广泛使用的**Louvain方法**等[算法](@article_id:331821)，首先构建一个细胞的社交网络。每个细胞是一个节点，它与它最亲近的$k$个朋友（其$k$近邻）相连。然后，[算法](@article_id:331821)像社会学家一样，寻找社区：即那些内部连接远比与网络其余部分连接更紧密的细胞群。这些方法擅长寻找密集的、定义明确的社区。

然而，这种方法有其自身的阿喀琉斯之踵，即**[分辨率极限](@article_id:379104)**（resolution limit）。例如，Louvain方法通过尝试最大化一个称为**模块度**（modularity）的分数来工作。当图被划分为密集的社区且社区之间连接稀疏时，模块度就高。问题是，有时通过将一个非常小的、稀有的细胞类型合并到一个大的相邻簇中，可以获得更高的模块度分数。[算法](@article_id:331821)在盲目追求更高模块度分数时，会为了一个“更整洁”的[整体解](@article_id:345303)决方案而牺牲稀有群体的身份。这是一个典型的[优化算法](@article_id:308254)目标与科学家细致入微的目标不完全一致的案例 [@problem_id:2429790]。

### 终极挑战：什么是细胞类型？

这就引出了最深层的问题。我们将数据通过这个复杂的清洗、转换和[聚类](@article_id:330431)流程，最终得到一张带有彩色细胞岛屿的美丽地图。我们给它们贴上“[神经元类型](@article_id:364403)1”、“星形胶质细胞”、“[小胶质细胞](@article_id:309100)”的标签。但我们如何知道这些是*真实*的？我们如何知道我们没有仅仅发现我们所选[算法](@article_id:331821)的产物，或是我们未能校正的批次效应？

要从一个“假定簇”转变为一个稳健的、科学上确立的**细胞类型**，标准必须高得多。一个真正严格的细胞类型定义必须是可[证伪](@article_id:324608)和可重复的 [@problem_id:2705514]。这需要一种新的科学纪律水平。

首先，它要求**跨实验室[可重复性](@article_id:373456)**。如果一个细胞类型只能由一个实验室、使用一台特定机器发现，那它就不是真实的。一个合适的基准测试将涉及多个实验室分析[随机化](@article_id:376988)、盲法的样本，看他们是否能使用预先注册的分析计划和量化的性能阈值（例如，分类器必须以至少$0.9$的曲线下面积，即AUC，来识别该类型）独立发现相同的细胞群体。

其次，它要求**跨平台一致性**。细胞的身份是一种基本的生物状态。因此，测量该状态的不同方式——通过其RNA（**[scRNA-seq](@article_id:333096)**）、通过其DNA的哪些部分是开放的（**sn[ATAC-seq](@article_id:349101)**），或通过其蛋白质含量——都应指向相同的结论。如果“[RNA类型](@article_id:306120)”与“染色质类型”不匹配，我们就没有一个可靠的定义。

这一终极挑战将[细胞类型聚类](@article_id:334826)从一种单纯的[数据分析](@article_id:309490)技术，提升为现代生物学家寻求创建真正的“细胞周期表”——一个全面、基于共识的生命构件目录，一张不仅美丽而且真实的地图——的基础工具。