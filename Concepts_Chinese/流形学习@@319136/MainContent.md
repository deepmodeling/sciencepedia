## 引言
在一个数据量空前增长的时代，从基因组序列到天文勘测，我们面临着一个根本性挑战：我们最有价值的信息往往编码在具有成千上万甚至数百万维度的数据集中。然而，人类的直觉却根植于一个只有三维的世界。我们如何才能理解隐藏在这种高维复杂性中的模式、结构和过程？这正是[流形学习](@article_id:317074)试图解决的核心问题。它基于一个强大的假设：这些看似复杂的数据，实际上常常沿着一个更简单的低维形状——一个“[流形](@article_id:313450)”——展开，而我们可以成功地绘制和可视化这个[流形](@article_id:313450)。

本文旨在为读者介绍这个融合了几何学与[数据科学](@article_id:300658)的迷人领域。我们将首先深入探讨[流形学习](@article_id:317074)的 **原理与机制**。从核心数学思想出发，我们将探索技术从主成分分析（PCA）简单的“投射阴影”式方法，演变到 [t-SNE](@article_id:340240) 和 UMAP 等现代[算法](@article_id:331821)复杂的基于邻域的方法，同时我们也将学习解读其结果时必须注意的关键事项。随后，我们将进入 **应用与跨学科联系** 的世界，展示这些方法不仅是理论上的奇思妙想，更在积极地为生物学构建新的图谱，使科学家能够以惊人的清晰度绘制细胞发育图谱并预测细胞命运。通过这次探索，您将学会如何审视一[团数](@article_id:336410)据点，并看清它所讲述的隐藏故事。

## 原理与机制

想象一下，你在社区里散步。地面看起来完全是平的。你可以用一张简单的平面地图来导航——向北走几个街区，向东走几个街区。在所有实际应用中，你都生活在一个二维平面上。然而，我们都知道这只是一种局部错觉。地球当然是一个球体，一个具有弯曲二维表面的三维物体。你所在城镇的地图很有用，但一张平面的世界地图不可避免地会扭曲各大洲，将格陵兰岛拉伸到荒谬的大小。我们星球局部平坦、全局弯曲的特性，正是对 **[流形](@article_id:313450)** 这一概念的完美介绍。

### 世界是弯曲的，你的数据也是

在数学中，[流形](@article_id:313450)是一个空间，当你对其中任何一点进行足够大的放大时，它看起来都像我们熟悉的[欧几里得空间](@article_id:298501)（一条平直的线、一个平坦的平面或一个平坦的三维空间）。球体的表面是一个[二维流形](@article_id:331153)，因为它的任何一小块都像一个平坦的二维薄片。甜甜圈，或者几何学家所说的环面，也出于同样的原因是一个[二维流形](@article_id:331153)。然而，球体和环面在全局尺度上有着根本的不同。环面有一个洞，而球体没有。你无法在不撕裂球体的情况下将其平滑地挤压成甜甜圈的形状。它们整体形状上的这种差异被称为它们的 **拓扑**。关键在于，物体可以具有相同的局部属性（都是二维的），但却有截然不同的全局结构。

这似乎是一个抽象的几何游戏，但事实证明，它是现代数据科学中最深刻的思想之一。**[流形假设](@article_id:338828)** 提出，我们在现实世界中收集的复杂高维数据——从单个细胞中数千个基因的表达，到数字照片中数百万个像素——并不仅仅是随机地填充其高维空间。相反，有意义的数据点往往位于或接近[嵌入](@article_id:311541)在高维空间中的一个低维[流形](@article_id:313450)上。

想象一个随时间分化的单个细胞。它的状态由 20,000 个基因的表达水平描述，是 20,000 维空间中的一个点。但随着它的发育，它不会随机跳跃，而是遵循一条连续的路径，一条轨迹。这条轨迹，或许有几个分支通向不同的[细胞命运](@article_id:331830)，形成了一个一维或二维的[流形](@article_id:313450)——一条蜿蜒的道路——穿行在广阔的基因空间景观中。再比如一张脸在旋转时的图像。每张图像都是高维像素空间中的一个点，但所有可能旋转的图像集合形成了一个光滑的低维表面。[流形学习](@article_id:317074)就是发现、可视化和理解我们数据中这些隐藏形状的艺术与科学。

### 数学家的保证：看见不可见之物

在我们开始这项探索之前，我们可能会问一个根本性问题：我们保证能成功吗？如果一个数据集具有内在的二维结构，是否总能创建出它的忠实二维图像？答案是肯定的，这非常奇妙。**Whitney [嵌入定理](@article_id:311289)** 是[微分几何](@article_id:306240)的基石，它给了我们这个深刻的保证。该定理指出，任何光滑的 $n$ 维[流形](@article_id:313450)都可以平滑地[嵌入](@article_id:311541)——完美地绘制出来而不会与自身相交——到一个维度为 $2n$ 的[欧几里得空间](@article_id:298501)中。

对于一个[二维流形](@article_id:331153)，这意味着我们保证能够将其绘制在四维空间中。现在，我们虽然无法看见四维空间，但这却是一个强大的理论支持。它告诉我们，我们对低维表示的寻求并非徒劳。该定理提供了一个通用的上界，一个解决方案存在的承诺。通常，特定的[流形](@article_id:313450)可以[嵌入](@article_id:311541)到更低的维度中（我们的二维球体很自然地存在于三维空间中，且 $3  2 \times 2 = 4$）。[流形学习](@article_id:317074)[算法](@article_id:331821)的目标就是找到这样一个高效的、低维的可视化表示，通常仅在 2 维或 3 维中。

### 最简单的工具：用 PCA 投射阴影

那么，我们如何找到这个隐藏的形状呢？工具箱中最经典、最直接的工具是 **[主成分分析 (PCA)](@article_id:352250)**。如果说[流形学习](@article_id:317074)是绘制地图，那么 PCA 就像是投射阴影。想象你有一个复杂的三维物体，你想用二维来表示它。你可以用光照射它，并在墙上描出它的影子。但是应该从哪个方向照射光线呢？PCA 的答案简单而优雅：从能产生最分散、最大影子的方向照射。

在数学上，PCA 找到数据中包含最多 **方差** 的方向。它计算一组新的坐标轴，即 **主成分**，这些坐标轴相互正交（成直角）。第一个主成分 (PC1) 是捕获数据集中最大方差的单一轴。PC2 在剩余方向中捕获最大的方差，以此类推。将数据投影到前两个主成分上，就像将数据的影子投射到由这两个“最重要”方向定义的平面上。

当数据的底层结构也是线性的时候，这种线性的、最大化方差的方法非常有效。假设你测量了一组患者的 20 种不同炎症蛋白（[细胞因子](@article_id:382655)）。很可能在一个炎症严重的患者体内，这些蛋白中的大多数都会升高，而在一个健康的患者体内，它们会很低。这种协同的“上下”波动是变异的主要来源。PCA 会立即将其识别为 PC1。每个患者沿这个 PC1 轴的位置，可以作为一个完美的、单一的、定量的“炎症评分”——它是所有 20 种蛋白的线性组合，并且可以直接解释。同样，如果你的数据包含两类细胞，它们的平均基因表达沿一条直线分开，PCA 将在可视化这种分离方面表现出色。

### 当阴影说谎时：瑞士卷问题

但是，当隐藏的结构不是简单的直[线或](@article_id:349408)平面时会发生什么？如果它是弯曲的呢？在这里，PCA 简单的投射阴影可能会产生灾难性的误导。典型的例子是“瑞士卷”数据集。想象一张二维纸片被卷成螺旋状。这是一个[嵌入](@article_id:311541)在三维空间中的[二维流形](@article_id:331153)。

如果你对这个卷上点的三维坐标应用 PCA，会发生什么？PCA 会找到最大方差的方向——即沿着卷的长度和穿过其直径的方向。当它将影子投射到二维平面上时，它只会将卷压平成一个实心矩形。整个分层结构都丢失了。两个在展开的纸片上位于两端，但恰好在卷的相邻层上的点，将被投影到完全重合的位置。PCA 对沿[流形](@article_id:313450)表面的内在“测地”距离是盲目的；它只看到穿过层间空白空间的“欧氏”捷径。

这不仅仅是一个数学上的奇特现象。在生物学中，一个我们关心但方差较低的过程（如[细胞分化](@article_id:337339)）可能会被一个方差高但生物学上无关紧要的过程（如细胞周期）所掩盖。PCA 追逐方差，会创建一个由细胞周期主导的可视化结果，可能会将整个分化树压缩成一条毫无意义的线。影子在说谎。

### 一种新哲学：相信你的邻居

如果高维空间中的全局距离不可靠，我们能相信什么？现代[流形学习](@article_id:317074)的绝妙洞见是：只相信你的 **局部邻域**。其哲学从全局的、自上而下的视角转变为局部的、自下而上的视角。

想象一下，你试图绘制一条你从未见过的蜿蜒山路。你不会试图从起点到终点画一条直线。相反，你会沿着小路走，每走一步，你只关心面前的几英尺。通过将所有这些局部步骤拼接在一起，你就能重建出整条蜿蜒的路径。

像 Isomap、[t-SNE](@article_id:340240) 和 UMAP 这样的[流形学习](@article_id:317074)[算法](@article_id:331821)就是基于这个原理运作的。它们首先构建一个 **邻域图**。每个数据点只与它在高维空间中的少数几个最近邻相连。这创建了一个网络，一种“连点成线”的谜题，它描绘了数据的内在形状。这种方法之所以强大，是因为它忽略了具有误导性的长程[欧氏距离](@article_id:304420)。它知道瑞士卷相邻层上的点不是真正的邻居，因为沿表面的路径很长。这个图尊重了[流形](@article_id:313450)的真实拓扑。

### 现代艺术家的工具箱：[t-SNE](@article_id:340240) 与 UMAP

一旦我们有了这个高维邻域图，最后的挑战就是将其节点（我们的数据点）[排列](@article_id:296886)在一个二维平面上，同时要尊重图的连接关系。这正是 [t-SNE](@article_id:340240) 和 UMAP 等[算法](@article_id:331821)施展魔法的地方。

**[t-SNE](@article_id:340240)（[t-分布随机邻域嵌入](@article_id:340240)）** 是一种植根于概率论的方法。对于每个点，它将其与邻居的高维距离转换成一组概率——一个描述它选择任何其他点作为其邻居的可能性的分布。然后，它试图在二维地图上[排列](@article_id:296886)这些点，以便能够创建一个相似的[概率分布](@article_id:306824)。其目标是通过最小化一个名为 **Kullback-Leibler (KL) 散度** 的信息论量，使低维邻域概率尽可能地与高维邻域概率相匹配。[t-SNE](@article_id:340240) 包含一个巧妙的技巧：它在低维地图中使用了一个重尾的 **学生t分布**。这使得在高维空间中不相似的点可以在二维空间中相距很远，有助于分离出不同的簇。

**UMAP（均匀流形逼近与投影）** 从一个不同的方向——基于[拓扑数据分析](@article_id:315073)——得出了相似的结果。它也构建了一个邻域图，但它将这个图视为一个“模糊”的拓扑结构。其目标是找到一个具有最相似模糊结构的低维[嵌入](@article_id:311541)，并通过最小化一个称为 **[交叉熵](@article_id:333231)** 的函数来进行优化。虽然数学原理很复杂，但直觉是相同的：保留局部邻域结构。在实践中，UMAP 通常比 [t-SNE](@article_id:340240) 快得多，并因其在保留精细局部关系的同时，能更好地保[留数](@article_id:348682)据的一些较大尺度的全局结构而受到称赞。

### 一点警示：解读大师之作

这些工具可以生成令人惊叹的美丽且富有洞察力的可视化结果，揭示以前看不见的隐藏结构。但它们并非万无一失的真理机器。它们就像艺术家的画笔，而非科学家的标尺。解读它们的输出需要谨慎和健康的怀疑态度。

首先，也是最关键的一点，**[t-SNE](@article_id:340240) 或 UMAP 图中簇的全局[排列](@article_id:296886)不具有定量意义**。分隔良好的簇之间的距离并不代表它们真实的分离程度。[算法](@article_id:331821)的优化过程可以扩展密集的簇并压缩它们之间的空白空间。它们告诉你*哪些*是邻居，但不一定告诉你*事物之间*在全局尺度上*有多远*。

其次，输出依赖于**超参数**。[t-SNE](@article_id:340240) 中的“[困惑度](@article_id:333750)”和 UMAP 中的“邻居数量”是控制在关注局部结构与全局结构之间平衡的旋钮。选择一个非常小的邻居数量可能会导致 UMAP 对数据密度的局部变化过度敏感，有可能在最终的图中将一个连续的生物过程“撕裂”成一组虚假的、不相连的岛屿。

最后，这些[算法](@article_id:331821)可以创造出引人注目但具有**误导性的假象**。考虑一个可以分化成三种不同细胞类型的祖细胞群体，并想象它在高维基因空间中与这三种命运的距离确实是相等的。UMAP 被迫在二维画布上[排列](@article_id:296886)这种对称情况，可能会随意地将祖细胞放置得离其中一种命运比另外两种更近。由此产生的图错误地暗示了一条有偏好或优先的分化路径，而实际上并不存在。发生这种情况是因为该[算法](@article_id:331821)的目标是保留邻域拓扑，而不必保持准确的全局距离，后者常常被压缩。

从一团高维数据云到一张富有洞察力的二维地图的旅程，是现[代数学](@article_id:316869)和计算机科学的一大胜利。通过拥抱[流形](@article_id:313450)的几何思想和发展出信任局部邻域的哲学，我们构建了能够窥探复杂系统隐藏结构的工具。但是，就像任何强大的工具一样，只有当我们——观察者——理解它们的优点和局限性时，才能发挥其最大的潜力，将其输出视为下一个问题的启发性指南，而非最终答案。

