## 引言
现代[材料科学](@entry_id:152226)的核心在于一个基本问题：无数单个原子的集体相互作用如何产生我们观察到和工程应用的宏观性质，例如钢的刚度或流体的粘度？在连续介质力学中，应力被简单地定义为单位面积上的力，但当在原子尺度上观察时，这个概念变得异常复杂，因为在原子尺度上物质大部分是空的空间。维里应力张量是一个优雅的理论框架，它解决了这个悖论，为连接离散的、微观的原子世界与连续的、宏观的材料世界提供了必要的桥梁。

本文将阐释维里[应力张量](@entry_id:148973)的强大功能和广泛适用性。首先，在“原理与机制”部分，我们将探讨其理论基础，从基本原理出发推导该张量，并剖析其动能和[势能](@entry_id:748988)分量。我们还将考察其在计算机模拟中计算的实际精妙之处。然后，在“应用与跨学科联系”部分，我们将遍览其多样化的应用，从预测[材料失效](@entry_id:160997)和工程模拟，到探索生物学和天体物理学的前沿，揭示其作为贯穿现代科学的统一概念。

## 原理与机制

科学理解常常涉及连接不同尺度的描述。我们可以观察一根钢梁，并用[连续介质力学](@entry_id:155125)的概念（如密度和应力）来描述它。但我们知道，钢梁并非连续介质；它是一个由原子组成的熙攘城市，一个由微小、[振动](@entry_id:267781)的粒子稀疏占据的广阔空旷空间，这些粒子被无形的力线维系在一起。一个深刻的问题是：我们如何将这两种图像联系起来？原子的集体舞蹈如何产生我们称之为**应力**的宏观性质？

### 在原子的世界里，什么是应力？

想象一下你正站在一座桥上。你感觉到脚下坚实的地面，但你知道它大部分是空的。这种坚实感来自于原子间巨大的力，抵抗着你体重带来的压缩。在宏观世界中，应力被定义为单位面积上的力。如果我们能用一个数学平面将桥切开，应力就是切面一侧对另一侧施加的力，除以切面的单位面积。

但是，在我们的原子城市中如何定义这个概念呢？一个平面切过它，大部分会切过真空。这时，一个更基本的概念——**动量通量**——为我们提供了解决方案。应力与动量的流动密切相关。再次想象我们的数学平面。动量可以通过两种方式穿过它：

1.  **动能贡献：** 原子可以实际飞越该平面，随身携带其动量 ($m\mathbf{v}$)。这就像冰雹敲打屋顶。冰雹的持续撞击会产生压力。类似地，原子的热运动产生了[应力张量](@entry_id:148973)的动能部分。

2.  **势能贡献：** 力可以跨越该平面作用。想象两个原子位于我们平面的两侧，被一个力连接。这个力在没有任何物质实际穿过平面的情况下，“传递”了动量。这是应力中更微妙、且在凝聚态物质中通常占主导地位的部分。

**维里[应力张量](@entry_id:148973)**正是量化这两种贡献的绝妙数学工具，它连接了原子世界和连续介质世界 [@problem_id:2788719]。

### 揭示维里：虚功原理

有几种方法可以推导出应力公式，但也许最优雅且最具启发性的路径始于一个简单的问题：如果我们轻轻挤压我们的原子盒子，需要做多少功？

这种方法通过**虚功原理**直接与[连续介质力学](@entry_id:155125)中的应力定义相联系。在[连续介质力学](@entry_id:155125)中，使材料发生一个微小的对称[应变张量](@entry_id:193332) $\boldsymbol{\varepsilon}$ 所需的单位体积功为 $\boldsymbol{\sigma} : \boldsymbol{\varepsilon}$，其中 $\boldsymbol{\sigma}$ 是柯西应力张量。因此，一个体积为 $V$ 的系统的总功为 $\delta U = V \boldsymbol{\sigma} : \boldsymbol{\varepsilon}$。

现在，让我们从原子角度来看这个问题。一个均匀应变 $\boldsymbol{\varepsilon}$ 使模拟盒子变形，并将每个位于位置 $\mathbf{r}_i$ 的原子移动一个微小位移 $\delta \mathbf{r}_i = \boldsymbol{\varepsilon} \mathbf{r}_i$。系统[势能](@entry_id:748988)的变化量 $\delta U$ 是克服作用在每个粒子上的力所做的功的总和：

$$
\delta U = \sum_i \mathbf{F}_i \cdot (-\delta \mathbf{r}_i) = - \sum_i \mathbf{F}_i \cdot (\boldsymbol{\varepsilon} \mathbf{r}_i)
$$

其中 $\mathbf{F}_i = -\frac{\partial U}{\partial \mathbf{r}_i}$ 是作用在粒子 $i$ 上的总力。通过一些[张量代数](@entry_id:161671)，$\mathbf{F}_i \cdot (\boldsymbol{\varepsilon} \mathbf{r}_i)$ 这一项可以被重写为一个[张量缩并](@entry_id:193373)，得到：

$$
\delta U = \left( -\sum_i \mathbf{F}_i \otimes \mathbf{r}_i \right) : \boldsymbol{\varepsilon}
$$

这里，$\otimes$ 表示[张量积](@entry_id:140694)或[并矢积](@entry_id:748716)。现在我们得到了同一个功 $\delta U$ 的两个表达式。将它们相等，我们便获得了一个纯粹的洞见时刻：

$$
V \boldsymbol{\sigma} : \boldsymbol{\varepsilon} = \left( -\sum_i \mathbf{F}_i \otimes \mathbf{r}_i \right) : \boldsymbol{\varepsilon}
$$

由于这对于任何微小应变 $\boldsymbol{\varepsilon}$ 都必须成立，并且知道柯西应力 $\boldsymbol{\sigma}$ 必须是对称的，我们得到了一个惊人普适的应力张量构型（[势能](@entry_id:748988)）部分的表达式：

$$
\boldsymbol{\sigma}_{\text{config}} = \frac{1}{V} \text{sym}\left( -\sum_{i=1}^{N} \mathbf{F}_i \otimes \mathbf{r}_i \right) = -\frac{1}{2V} \sum_{i=1}^{N} (\mathbf{F}_i \otimes \mathbf{r}_i + \mathbf{r}_i \otimes \mathbf{F}_i)
$$

$\sum_i \mathbf{F}_i \otimes \mathbf{r}_i$ 这一项与**维里**有关。这个推导之所以优美，是因为我们没有[对力](@entry_id:159909) $\mathbf{F}_i$ 的性质做任何假设 [@problem_id:3413175]。它们可以是简单的对偶力，也可以是反应体系或[机器学习势](@entry_id:183033)中出现的极其复杂的[多体力](@entry_id:146826)。这个公式无论如何都成立 [@problem_id:2648614]。这证明了基本原理的统一力量。

### 应力张量的剖析

让我们来整合完整的图像。总[应力张量](@entry_id:148973)包括动能和势能两部分。在力学中，拉伸为正是一种常见约定，据此我们得到：

$$
\boldsymbol{\sigma} = \frac{1}{V} \left( -\sum_{i=1}^N m_i (\mathbf{v}_i - \bar{\mathbf{v}}) \otimes (\mathbf{v}_i - \bar{\mathbf{v}}) - \frac{1}{2}\sum_{i \neq j} \mathbf{r}_{ij} \otimes \mathbf{F}_{ij} \right)
$$

*等等！* 你可能会在[统计力](@entry_id:194984)学教科书中看到一个不同的公式，通常称为[压力张量](@entry_id:147910) $\mathbf{P}$，其符号是不同的。这是一个源于不同约定的臭名昭著的混淆点。在[热力学](@entry_id:141121)中，压力对于压缩为正，而在[固体力学](@entry_id:164042)中，应力对于拉伸为正。对于一个处于平衡状态的各向同性系统，两者通过 $\boldsymbol{\sigma} = -\langle \mathbf{P} \rangle$ 根本地联系在一起 [@problem_id:3434135]。我们这里将坚持使用力学约定，但必须意识到这种符号差异。

第一项是**动能应力**。负号表示原子的热运动总是产生压力（一种压应力），这在拉伸为正的约定中对应一个负值。这里的 $\mathbf{v}_i - \bar{\mathbf{v}}$ 是原子 $i$ 相对于局部原[子群](@entry_id:146164)[平均速度](@entry_id:267649) $\bar{\mathbf{v}}$ 的特异速度。认为这一项只对气体重要是错误的 [@problem_id:2788719]。在固体中，原子在不断[振动](@entry_id:267781)，这种[振动](@entry_id:267781)——即热运动——携带动量并对应力做出贡献。

第二项是**构型应力**，也称为**维里应力**。我们在这里为常见的对偶中心力情况重写了它，其中 $\mathbf{F}_{ij}$ 是原子 $j$ 对原子 $i$ 的作用力，而 $\mathbf{r}_{ij} = \mathbf{r}_i - \mathbf{r}_j$。这一项是所有相互作用原子对的总和。其贡献的符号取决于力的性质：排斥力（$ \mathbf{r}_{ij} \cdot \mathbf{F}_{ij}  0 $）导致压缩（负应力），而吸[引力](@entry_id:175476)（$ \mathbf{r}_{ij} \cdot \mathbf{F}_{ij} > 0 $）导致拉伸（正应力）。[并矢积](@entry_id:748716) $\mathbf{r}_{ij} \otimes \mathbf{F}_{ij}$ 优雅地捕捉了此应力贡献的方向和大小。对于中心力（沿着连接粒子的直线作用），力矢量 $\mathbf{F}_{ij}$ 平行于位置矢量 $\mathbf{r}_{ij}$。这带来一个奇妙的结果：由此产生的张量 $\mathbf{r}_{ij} \otimes \mathbf{F}_{ij}$ 是对称的，这意味着总[应力张量](@entry_id:148973)也是对称的，正如连续介质力学中[角动量守恒](@entry_id:156798)所要求的那样 [@problem_id:3474236] [@problem_id:3453807]。

一个源于势能[平移不变性](@entry_id:195885)的重要性质是，系统中所有内力的总和为零：$\sum_i \mathbf{F}_i = \mathbf{0}$。一个巧妙的推论是，维里 $\sum_i \mathbf{F}_i \otimes \mathbf{r}_i$ 的值不依赖于我们[坐标系](@entry_id:156346)原点的选择，这使其成为一个物理上稳健的量 [@problem_id:2648614]。

### 物理学家的工具箱：真实模拟中的应力

维里表达式不仅仅是一个理论上的奇珍；它是在几乎每一次分子动力学模拟中计算压力和应力的主力。但在实践中应用它，会揭示出更多的精妙之处和更深层的美。

#### 局域应力：放大观察

如果我们想知道的不是整个盒子里的应力，而只是一个微小区域的应力，比如说在一个纳米级裂纹的尖端，该怎么办？我们不能直接使用上面的公式。我们需要一个局域版本。**Irving-Kirkwood-Hardy 公式**提供了答案 [@problem_id:2788719]。我们定义一个小的数学[控制体](@entry_id:143882)。然后，通过对控制体*内部*所有原子的贡献（对于动能部分）以及至关重要的、所有*穿过*控制体边界的[原子间键](@entry_id:162047)的贡献求和，来计算局域应力。这个方法正确地划分了应力，并允许我们创建材料在纳米尺度上的应力图，这是[纳米力学](@entry_id:185346)的一个强大工具。

#### 力的复杂性

维里应力的准确性完全取决于力 $\mathbf{F}_i$ 的准确性。我们对力所做的任何近似都将反映在应力中。

-   **短程截断：** 对于许多势，力随距离迅速衰减。为了节省计算时间，我们通常会简单地忽略超过某个[截断半径](@entry_id:136708) $r_c$ 的相互作用。但是，如果我们只是突然截断力，就会产生一个非物理的不连续性。这个看似微小的“罪过”会带来严重后果，给计算出的性质（如弹性模量）引入系统误差。一种更精巧的方法是使用一个平滑的[开关函数](@entry_id:755705)，将力和势平缓地降至零，这能得到更准确的结果 [@problem_id:3421096]。

-   **[长程力](@entry_id:181779)：** 那么像 $1/r$ 这样缓慢衰减的静电相互作用呢？我们不能简单地截断它们。物理学家使用一个巧妙的数学技巧，称为**[Ewald 求和](@entry_id:142359)**，它将计算分为在实空间中计算的短程[部分和](@entry_id:162077)在傅里叶波的“倒易”空间中计算的长程部分 [@problem_id:2787433]。维里原理要求我们保持一致：如果力有实空间和倒易空间部分，那么[应力张量](@entry_id:148973)也必须有来自这两部分的贡献。忘记[倒易空间](@entry_id:754151)项是一个常见且严重的错误，会导致不正确的压力和模拟中的假象 [@problem_id:3434135]。

-   **复杂势：** 现代模拟经常使用非常复杂的势，其中相互作用不是固定的。在**[反应力场](@entry_id:637895)**中，两个原子之间的“键级”或每个原子上的[电荷](@entry_id:275494)可以根据局部环境动态变化 [@problem_id:3485021]。人们可能会担心这需要在维里应力中添加复杂的修正项。但在这里，大自然是仁慈的。一个与**Hellmann-Feynman 定理**相关的深刻结果表明，因为这些内部变量（如[电荷](@entry_id:275494)）被持续优化以保持能量最小化，它们的导数不会显式地出现在最终的力表达式中。标准的维里公式，当与正确的总力一起使用时，仍然有效！

-   **[约束力](@entry_id:170052)：** 在模拟聚合物或水时，我们经常将[化学键](@entry_id:138216)建模为固定长度的刚性棒。强制实现这种刚性的力称为**约束力**。它们对应力有贡献吗？绝对有。它们是系统内力的一部分。维里框架可以优雅地扩展以包含它们，其中对应力的贡献可以用施加约束的[拉格朗日乘子](@entry_id:142696)来表示 [@problem_id:2909642]。

因此，维里应力张量是一个深刻而强大的概念。它提供了连接原子和力的微观世界与材料和力学的宏观世界的基本纽带。它展示了无数粒子在物理定律支配下的集体推拉，如何产生了我们日常体验到的世界的稳健性质。它从第一性原理的推导以及对最复杂和现代模拟技术的适应性，是物理学统一性与优雅之美的美丽例证。

