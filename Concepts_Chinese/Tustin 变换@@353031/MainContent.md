## 引言
在工程和物理学的世界里，一个根本性的挑战始终存在：我们如何将优雅、连续的运动和控制定律，转化为数字计算机能够理解的步进式语言？从电路到机器人手臂，支配万物的理论都是用微积分的语言写就的，但它们的实现却发生在只理解离散数值的微处理器中。Tustin 变换，亦称双线性变换，正是连接这两个领域的一座强大而可靠的桥梁。它提供了一种系统化的方法，将[连续时间系统](@article_id:340244)设计转换为可在代码中执行的数字[算法](@article_id:331821)，从而有效地解决了这一关键的转换问题。

本文将分两大部分探讨 Tustin 变换。首先，“**原理与机制**”一章将深入探讨该[变换的核](@article_id:309928)心，解释其背后简单的代换原理。我们将揭示为何这个特定公式如此特殊，重点关注其最著名的特性：保证所得数字系统的稳定性。我们还将正视其主要副作用——频率畸变，以及工程师为克服它而使用的巧妙技巧。随后，“**应用与跨学科联系**”一章将展示该变换的实际应用，演示它如何用于实现数字控制器、设计滤波器，甚至改造用于数字控制的现代[状态空间模型](@article_id:298442)，从而巩固其作为科学与工程领域不可或缺的工具的地位。

## 原理与机制

想象一下，你正试图向两位截然不同的工人下达指令。一位是艺术家，是平滑、连续运动的大师，他的思维方式是流动的曲线和优雅的变化。另一位是建筑工，是数字时代的原住民，他使用离散的砖块，一块接一块地精确堆砌。物理学的模拟世界，以其连续的运动和[微分方程](@article_id:327891)为特征，是艺术家的领域。而计算机的数字世界，以其时钟和有限的步长为特征，则是建筑工的领域。你如何将艺术家的流畅设计，翻译成建筑工能遵循的一套指令？这正是数字控制和信号处理的核心挑战，而 Tustin 变换是我们拥有的最优雅的翻译工具之一。

### 一种巧妙的代换

Tustin 变换（或称双线性变换）的核心是一个异常简单的法则。它提供了一个直接的代换关系，能将连续世界的描述转换为离散世界的描述。如果一个系统的行为是用拉普拉斯变量 $s$ 来描述的，Tustin 变换告诉我们，用以下包含 Z 变换变量 $z$ 的表达式来替换每一个 $s$：

$$
s = \frac{2}{T} \frac{z-1}{z+1}
$$

在这里，$T$ 是[采样周期](@article_id:329180)——即我们的数字系统对世界进行每次“快照”之间的时间间隔。乍一看，这个代换似乎有些随意，像是一种数学上的戏法。但让我们看看它能做什么。

考虑自然界中最基本的构建模块之一：[积分器](@article_id:325289)。在连续世界中，它的传递函数是 $H(s) = 1/s$。积分是事物随时间的累积。应用我们的 Tustin 法则，可以得到它的数字等效形式：

$$
H(z) = \frac{1}{\frac{2}{T} \frac{z-1}{z+1}} = \frac{T}{2}\frac{z+1}{z-1}
$$

这个用 $z$ 语言写成的新表达式，是计算机可以遵循的一组指令。它将当前输出与当前和过去的输入以及过去的输出联系起来。其神奇之处在于，这个离散的法则在许多关键方面与其连续的“祖先”表现得非常相似。这个过程适用于任何系统，无论多么复杂。对于一个更复杂的模型，比如一个科学仪器的模型，代数运算会更复杂，但原理保持不变：代换并化简。但*为什么*是这个特定的代换？是什么让它如此特别？

### 稳定性的守护者

Tustin 变换最深刻、最美妙的特性是它能**保持稳定性**。这是它的黄金法则，也是它声名鹊起的主要原因。

在系统世界里，“稳定性”就是一切。一个稳定的系统，在受到扰动后，最终会平复下来。而不稳定的系统，一经触碰，就会失控，其输出会无限制地增长，直到系统崩溃或饱和。对于工程师来说，确保稳定性是第一要务。

我们如何判断一个系统是否稳定？我们看它的“极点”，也就是其传递函数分母的根。
-   在连续的 $s$ 平面中，如果一个系统的所有极点都位于**[左半平面](@article_id:334428)**（即 $s$ 的实部为负），那么该系统是稳定的。稳定与不稳定的边界是虚轴，$s = j\Omega$。
-   在离散的 $z$ 平面中，如果一个系统的所有极点都位于**[单位圆](@article_id:311954)内部**（即模 $|z|$ 小于 1），那么该系统是稳定的。这里的边界是[单位圆](@article_id:311954)本身，$|z| = 1$。

Tustin 变换完成了一项了不起的壮举：它将 $s$ 平面整个“安全”的左半部分，完美地映射到 $z$ 平面“安全”的[单位圆](@article_id:311954)内部。它通过将一个世界的稳定性边界精确地映射到另一个世界的稳定性边界上来实现这一点。让我们看看它是如何做到的。如果我们取模拟边界上的一个点 $s = j\Omega$，看看它在 $z$ 平面上的落点：

$$
z = \frac{2 + sT}{2 - sT} = \frac{2 + j\Omega T}{2 - j\Omega T}
$$

这个[复数的模](@article_id:352460)是分[子模](@article_id:309341)除以分母模：

$$
|z| = \frac{|2 + j\Omega T|}{|2 - j\Omega T|} = \frac{\sqrt{2^2 + (\Omega T)^2}}{\sqrt{2^2 + (-\Omega T)^2}} = 1
$$

它的值恒为 1！这意味着 $s$ 平面整个无限长的虚轴被完美地缠绕在 $z$ 平面的[单位圆](@article_id:311954)上。一个稳定的模拟系统，其极点安全地位于左半平面，经过变换后将总会成为一个稳定的数字系统，其极点安全地位于[单位圆](@article_id:311954)内部。

考虑一个完美的[振荡器](@article_id:329170)，比如一个理想化的音叉，其极点恰好位于稳定性的边缘，即 $s = \pm j\omega_n$。Tustin 变换会正确地将其数字极点置于[单位圆](@article_id:311954)上，从而得到一个临界稳定的数字[振荡器](@article_id:329170)。这与一些更简单的方法（如前向欧拉近似）形成鲜明对比，后者可能会不慎将这些极点推到[单位圆](@article_id:311954)外，把一个完美的[振荡器](@article_id:329170)变成一个不稳定的、发散的系统。Tustin 变换形式上稍显复杂，但这正是成为稳定性忠实守护者所必需的。

### 不可避免的扭曲：频率畸变

这个奇妙的稳定性保证并非没有代价。我们需要为此付出代价，故事中出现了一个有趣的转折。虽然该变换保留了[频率响应](@article_id:323629)的*特性*（例如，低通、高通），但它扭曲了频率轴本身。这种效应被称为**频率畸变**。

模拟频率 $\Omega$ (rad/s) 与其对应的[数字频率](@article_id:327388) $\omega$ (rad/sample) 之间的关系并非简单的[线性缩放](@article_id:376064)。通过求解我们的[边界映射](@article_id:311582)方程，我们能找到它们之间的确切关系：

$$
\Omega = \frac{2}{T} \tan\left(\frac{\omega}{2}\right)
$$

这个正切函数就是“畸变”的来源。想象一下，你试图将一条无限长的直路（从 $\Omega=0$ 到 $\infty$ 的模拟频率轴）呈现在一块有限的画布上（从 $\omega=0$ 到 $\pi$ 的[数字频率](@article_id:327388)轴）。在你附近（$\Omega \approx 0$），你可以按比例绘制。确实，对于低频，$\tan(x) \approx x$，所以公式简化为 $\Omega \approx \omega/T$，这是一个很好的线性关系。

但当你向路远处看时，为了把所有景象都塞进画布，你必须把视野压缩得越来越厉害。整个无限的模拟频率正半轴被挤压到有限的数字范围 $[0, \pi]$ 内。其后果是高频被急剧压缩。变化率 $\frac{d\omega}{d\Omega}$（它告诉我们一段给定的模拟频率能获得多少[数字频率](@article_id:327388)“空间”）在 $\Omega=0$ 处最大，并随着 $\Omega \to \infty$ 而趋向于零。这意味着一大段极高的模拟频率被压缩到靠近[奈奎斯特频率](@article_id:340109) $\omega = \pi$ 的一个极小的数字[频谱](@article_id:340514)片段中。

### 工程师的反击：[预畸变](@article_id:332053)

了解一个工具的局限性是掌握它的第一步。面对频率畸变问题，工程师们想出了一个绝妙而简单的解决方案：**[预畸变](@article_id:332053)**。

假设你需要设计一个数字滤波器，其精确的截止频率为 $\omega_d$。你知道，如果你设计一个具有相同频率的[模拟滤波器](@article_id:333131)然后使用 Tustin 变换，畸变会使截止频率偏离目标位置。解决方案是反向使用畸变公式，计算出你需要在哪里“起步”。如果你想*最终得到* $\omega_d$，你必须用一个“[预畸变](@article_id:332053)”频率 $\Omega_{pw}$ 来设计你的模拟滤波器：

$$
\Omega_{pw} = \frac{2}{T} \tan\left(\frac{\omega_d}{2}\right)
$$

通过使用这个修正后的频率来设计模拟原型，随后的 Tustin 变换所带来的失真会将这个关键频率正好落在你[期望](@article_id:311378)的数字域位置。这就像弓箭手为了抵消重力影响而稍微向上瞄准一样。这项技术被常规地用于设计高性能[数字滤波器](@article_id:360442)，以使其在关键频率上符合规范，从而将一个潜在的缺点转变为一个可预测的设计参数。

### 深入探究其本质

那么，这个神奇的变换究竟从何而来？连续世界和离散世界之间的精确转换由[指数函数](@article_id:321821) $z = \exp(sT)$ 控制。每一种[离散化方法](@article_id:336243)，本质上都是用一个更易于处理的[有理函数](@article_id:314691)（多项式之比）来近似这个[超越函数](@article_id:335447)的不同方式。

Tustin 变换等价于使用所谓的[指数函数](@article_id:321821)的一阶 Padé 近似：

$$
\exp(sT) \approx \frac{1 + sT/2}{1 - sT/2}
$$

对上式求解 $s$，我们就能得到熟悉的 Tustin 公式。这个近似特别好。对于一个位于 $s=-a$ 的稳定模拟极点，其精确的数字极点位于 $z_{\text{ZOH}} = \exp(-aT)$。Tustin 变换将其置于 $z_{\text{Tustin}} = (1 - aT/2) / (1 + aT/2)$。当 $aT$ 的值很小（即采样速度远快于系统动态）时，这两个表达式几乎完全相同。这解释了为什么该变换在低频时效果如此之好。但与其他简单的近似不同，这个近似具有将[左半平面](@article_id:334428)映射到[单位圆盘](@article_id:351449)的[特殊几何](@article_id:373477)性质，这是它能成为稳定性守护者的关键。它在精度和系统设计的基本要求之间达到了一个优美而实用的平衡。