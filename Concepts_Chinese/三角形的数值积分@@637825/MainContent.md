## 引言
对任意域上的函数进行积分是[应用数学](@entry_id:170283)的基石，但看似简单的三角形却带来了独特的挑战。尽管三角形是工程和[科学模拟](@entry_id:637243)所用网格的基础，但其几何形状却难以直接应用标准的[笛卡尔积](@entry_id:154642)分技术。这一困难提出了一个关键问题：我们如何系统地、准确地计算[三角形单元](@entry_id:167871)上的积分，以确保我们物理模型的可靠性？回答这个问题对于从结构分析到[计算流体力学](@entry_id:747620)的各种模拟的保真度至关重要。

本文为三角形的[数值积分](@entry_id:136578)提供了一份全面的指南。首先，在“原理与机制”部分，我们将深入探讨其数学基础，探索优美的[重心坐标](@entry_id:155488)系以及专为三角形独特对称性设计的[数值积分法则](@entry_id:175061)理论。我们将揭示为何简单地套用正方形的方法是低效且易于出错的，并审视使用不当积分方案的严重后果。随后，“应用与跨学科联系”部分将连接理论与实践。我们将看到这些原理如何在[有限元法](@entry_id:749389)中应用于计算诸如刚度和质量等关键单元属性，积分法则的选择如何影响精度，以及先进技术如何巧妙地操纵积分以解决诸如体积自锁等复杂的物理问题。

## 原理与机制

想象一下，你的任务是计算一块密度随点变化的三角形金属板的总质量。如果这块板是矩形，前进的道路会很清晰：你可以先沿一个轴积分，再沿另一个轴积分。但三角形要棘手一些。沿 y 轴的积分限取决于你在 x 轴上的位置。这是一个简单的形状，但其边界的耦合暗示着它可能不会轻易地泄露其秘密。这就是我们面临的基本挑战：我们如何系统地、准确地计算三角形上的积分？这个问题不仅仅是学术上的好奇心；它位于现代工程模拟的核心，从分析桥梁桁架的应力到预测机翼上的气流。

### 三角形的通用语言：[重心坐标](@entry_id:155488)

在我们设计积分策略之前，我们需要一种自然的方式来描述三角形内的任意点。虽然我们可以使用标准的笛卡尔坐标 $(x,y)$，但它们对于三角形的内在几何来说显得格格不入。它们是由一个网格定义的，而这个网格对三角形顶点的位置一无所知。

一种更优美、更强大的方法是使用**[重心坐标](@entry_id:155488)**。想象我们三角形的顶点位于点 $\mathbf{v}_1$、$\mathbf{v}_2$ 和 $\mathbf{v}_3$。三角形内的任意点 $\mathbf{x}$ 都可以被看作是这些顶点的“混合物”。[重心坐标](@entry_id:155488) $(\lambda_1, \lambda_2, \lambda_3)$ 就是这个混合物中每个顶点的比例：

$$
\mathbf{x} = \lambda_1 \mathbf{v}_1 + \lambda_2 \mathbf{v}_2 + \lambda_3 \mathbf{v}_3
$$

为了使这是一个合理的配方，这些比例的总和必须为一：$\lambda_1 + \lambda_2 + \lambda_3 = 1$。并且，要使点 $\mathbf{x}$ 位于三角形内部，所有比例都必须是非负的。如果一个 $\lambda$ 为零，点就在一条边上；如果两个为零，点就在一个顶点上。对于顶点在 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的标准参考三角形，这些优雅的坐标与笛卡尔坐标有着极其简单的关系：$(\lambda_1, \lambda_2, \lambda_3) = (1-x-y, x, y)$ [@problem_id:3567629]。

[重心坐标](@entry_id:155488)的真正魔力在于它们的**不变性**。如果你拉伸、旋转或移动三角形（一个[仿射映射](@entry_id:746332)），其中一个点的[重心坐标](@entry_id:155488)不会改变 [@problem_id:3567629]。一个曾经是质心的点仍然是[质心](@entry_id:265015)。这意味着我们可以在一个简单的、标准的“参考”三角形上解决问题，而我们的发现将自动适用于我们网格中的*任何*直边三角形。我们为所有三角形找到了一种通用语言。

### 智能采样的艺术：数值积分

有了语言工具，我们回到积分问题上。与其与复杂的解析公式搏斗，我们可以采用一种更实用、更巧妙的方法：**数值积分**。其思想是用函数在少数精心选择的采样点（称为**积分点**或节点）上的值的加权和来代替连续积分。

$$
\int_K f(\mathbf{x}) \, \mathrm{d}A \approx \sum_{q=1}^{N} w_q f(\mathbf{x}_q)
$$

目标是选择点 $\mathbf{x}_q$ 和权重 $w_q$，使得这种近似不仅仅是近似，而是对我们关心的一大类函数——即多项式——*精确*的。如果一个积分法则对于直到总次数为 $m$ 的任何多项式都能给出精确积分，那么它就被称为具有**精确度** $m$ [@problem_id:3364903]。

为什么是多项式？在[有限元法](@entry_id:749389)（FEM）中，我们通过在每个小单元上拼接简单的多项式函数来构建复杂物理问题的解。计算一个单元的属性，比如它的**[刚度矩阵](@entry_id:178659)**或**质量矩阵**，涉及到对这些多项式或其导数的乘积进行积分。例如，如果我们使用 $p$ 次多项式来近似一个解，刚度矩阵的被积函数涉及其梯度的乘积。由于一个 $p$ 次多项式的梯度是 $p-1$ 次，被积函数的次数为 $(p-1) + (p-1) = 2p-2$。为了精确计算[刚度矩阵](@entry_id:178659)，我们需要一个[精确度](@entry_id:143382)至少为 $m = 2p-2$ 的积分法则 [@problem_id:3364903] [@problem_id:2591220]。而[质量矩阵](@entry_id:177093)涉及多项式本身的乘积，需要一个对 $2p$ 次精确的法则 [@problem_id:3286672]。

### 为什么三角形不仅仅是切碎的正方形

一个自然的想法可能是借鉴矩形单元这个已经被充分理解的领域。毕竟，一维的 Gauss-Legendre 积分是效率的奇迹。为什么不直接扩展它呢？

一个幼稚的想法是在三角形上画一个正方形点网格，然后简单地忽略掉落在外面的点 [@problem_id:3546663]。这是极其低效的——你浪费了大约一半的计算——更糟糕的是，它破坏了三角形优美的旋转对称性。你的计算结果会取决于你如何相对于网格定向三角形，从而在你的物理模型中引入人为的偏差。

一种更复杂的方法是使用数学技巧，比如 **Duffy 映射**，将三角形“展开”成一个正方形 [@problem_id:3546663]。这似乎很有希望，但有一个陷阱。这个映射本身在积分中引入了一个[雅可比](@entry_id:264467)项，这使我们需要积分的函数变得复杂。三角形上的一个简单多项式在正方形上变成了一个更高次、更复杂的多项式，迫使我们使用比我们期望的要多得多的积分点。

这里的教训是深刻的：三角形有其独特的几何形状和对称性，必须得到尊重。为正方形的笛卡尔结构设计的法则不能盲目地应用于单纯形。[张量积法则](@entry_id:177156)是为积分形如 $x^i y^j$（其中 $i$ 和 $j$ 分别有界）的多项式空间而设计的，而在三角形上，我们感兴趣的是*总*次数 $i+j$ 有界的空间。这些是根本不同的结构 [@problem_id:3585267] [@problem_id:3402897]。

### 对称的力量

正确的道路是构建源于三角形自身性质的积分法则。一个三角形有一个包含六个对称操作的群（三个旋转，三个反射）。一个好的积分法则应该对这些对称性不敏感；如果我们重新标记顶点，积分的结果不应改变 [@problem_id:3567629]。

这个强大的原则引导我们通过将其[重心坐标](@entry_id:155488)定义的**[轨道](@entry_id:137151)**上的点来构建法则。如果一个坐标为 $(\lambda_1, \lambda_2, \lambda_3) = (a, b, c)$ 的点被包含在内，那么它的所有[排列](@entry_id:136432)——比如 $(b, a, c)$、$(c, b, a)$ 等——也必须被包含，并且它们必须都有相同的权重 [@problem_id:3546663]。这一约束极大地减少了我们需要求解的未知参数数量，使得找到高效且优雅的法则成为可能。像 Dunavant、Xiao 和 Gimbutas 这样的研究人员利用这一原则发现了近乎最少的对称法则，用最少的点数达到了给定的[精确度](@entry_id:143382) [@problem_id:3546663]。

### 变分犯罪与机器中的幽灵

如果我们搞错了会怎样？如果我们偷懒，使用了一个不足以胜任工作的积分法则会怎样？这不仅仅是一个简单的错误；在有限元的世界里，这被称为“**变分犯罪**” [@problem_id:3286672]。通过使用不精确的法则，我们不再是在解决我们最初设定的问题。我们引入了一个**[一致性误差](@entry_id:747725)**，虽然方法可能仍然收敛，但通常会收敛得更慢。

但有时，后果要戏剧性得多。严重的积分不足可能会在“机器中召唤出幽灵”——**[伪零能模式](@entry_id:755267)**。想象一根柔性梁。它对于[刚体运动](@entry_id:193355)（平移和旋转）的刚度为零。现在，想象使用如此少的采样点，以至于系统对某些弯曲形状变得“盲目”。一个多项式可以摆动和弯曲，但如果它恰好在所有积分点上都为零，积分法则将报告其梯度处处为零。这个弯曲模式的数值计算刚度将为零，就好像它是一个[刚体运动](@entry_id:193355)一样！ [@problem_id:3286672]

这不仅仅是不准确；这是模型的灾难性失败。对于一个需要 3 点法则来正确积分其刚度的二次应变三角形（LST），使用 1 点或 2 点法则会引入这种[伪模式](@entry_id:163321) [@problem_id:3569129]。得到的[刚度矩阵](@entry_id:178659)会变得**[秩亏](@entry_id:754065)**，意味着它比物理上应有的[零能模式](@entry_id:172472)更多。由这些单元构成的结构会人为地“松软”，并可能产生剧烈[振荡](@entry_id:267781)、毫无意义的结果。这突显了刚度值的小误差（如果积分权重稍有偏差可能发生）与[矩阵秩](@entry_id:153017)的根本性错误（如果积分点太少则会发生）之间的关键区别 [@problem_id:3569129]。

### 故事的其余部分：超越精确度

对完美积分法则的追求并不止于[精确度](@entry_id:143382)和对称性。还有其他一些微妙但至关重要的属性需要考虑。

其中最重要的一点是拥有**正权重**。一个具有正权重的积分法则的行为就像一个物理测量过程，其中每个样本都对总和做出正贡献。存在负权重的法则，但它们是危险的。负权重可能导致这样的计算：增加更多的东西（比如质量密度）反而导致总质量变小。在数值模拟中，这可能导致非物理的结果，如负动能，并导致整个模拟变得不稳定并崩溃 [@problem_id:3567629]。此外，对于涉及必须为正值的量的问题，如化学浓度或密度，使用具有正权重的积分法则对于确保正函数的单元平均值保持为正至关重要 [@problem_id:3409652]。

最后，还有一个优雅的思想，即**[质量集中](@entry_id:175432)**。对于时间相关问题，如果质量矩阵是对角阵，求解系统会大大简化。一个完整的[质量矩阵](@entry_id:177093)需要在每个时间步求解一个[线性系统](@entry_id:147850)，而一个[对角矩阵](@entry_id:637782)则可以轻易地求逆。如果通过某种美妙的巧合，多项式基所需的点（插值节点）与一个有效积分法则中的点*相同*，就可以实现[对角质量矩阵](@entry_id:173002) [@problem_id:3402884]。对于三角形上的线性单元，这个奇迹发生了：三个顶点构成了一个有效的 3 [节点基](@entry_id:752522)*和*一个 3 [点积](@entry_id:149019)分法则（虽然它只对 1 次精确）。对于更高阶，这种插值和积分的对齐在三角形上变得极其困难，这与四边形上的情况形成鲜明对比 [@problem_id:3402897]。这再次提醒我们，三角形，尽管表面上简单，却是一个具有深刻而微妙数学之美的领域。

