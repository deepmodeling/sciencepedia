## 应用与跨学科联系

在理解了倾向性评分背后的原理之后，我们现在可以踏上一段旅程，去看看它的实际应用。这个想法的真正美妙之处不仅在于其数学上的优雅，更在于其非凡的多功能性。它是一把钥匙，能解开医学、社会学和环境科学等迥异领域中的因果问题。它让我们能够在一个狂野、未驯服的观察性数据世界里，强加一种实验秩序的表象。让我们来探索这个单一而强大的概念如何帮助我们了解世界是如何运作的。

### 医学：追求治愈之道

观察性数据带来的挑战在医学领域表现得最为尖锐。出于伦理和实践原因，我们无法对每一种治疗都进行随机化。医生根据其专业判断和患者的独特特征为患者做出选择。一个年龄较大且有肾脏问题的高血压患者，可能会接受与一个更年轻、更健康的患者不同的药物。如果我们后来观察到第一组的预后更差，是因为药物的原因，还是因为他们一开始就病得更重？这是典型的“适应症混杂”问题，也正是倾向性评分的天然用武之地。

想象一项研究，比较一种标准[利尿剂](@entry_id:155404)与另一种降压药 [@problem_id:4828155]。我们有一个丰富的数据集，包含了在治疗开始*前*测量的患者特征：年龄、性别、基线血压、肾功能等等。我们可以利用这些信息来构建一个倾向性评分模型——一个预测在给定特定特征集的情况下，患者会接受利尿剂的概率的模型。这个评分，一个介于0和1之间的单一数值，完美地总结了医生可能偏好一种药物而非另一种的所有已测量原因。

现在，我们可以用这个评分来创造一个公平的比较。一种流行的方法是逆概率治疗加权（IPTW）。可以把它看作一种“统计学上的平权行动”。在我们的原始数据中，接受利尿剂的组很可能与未接受的组大不相同。但是，通过将每个人的权重设为他们实际接受治疗的概率的倒数，我们可以创建一个“伪群体”。在这个新的、合成的群体中，就好像每种类型的患者都有同等的机会接受任一种药物。[混杂变量](@entry_id:199777)得到了平衡，对两个加权组的平均血压进行简单比较，就能为我们提供一个关于药物真实效果的更公平的估计。

同样的逻辑也适用于更具戏剧性的干预措施，比如手术。考虑在两种减肥手术——袖状胃切除术（SG）和Roux-en-Y胃旁路术（RYGB）——之间的选择 [@problem_id:5086541]。外科医生可能会为患有严重[胃酸](@entry_id:148373)反流的患者推荐RYGB，而这个因素也影响着他们的手术结局。为了将手术的效果与预先存在的疾病状况的效果区分开来，我们可以再次求助于倾向性评分。这里，我们可能尝试使用匹配而非加权。对于每个接受RYGB的患者，我们可以寻找他们的“统计双生子”——一个接受了SG但倾向性评分几乎相同的患者。通过创建一个仅由这些匹配对组成的新数据集，我们实际上制造了一项研究，其中两组在所有已测量的协变量上都达到了精确的平衡。在这个匹配队列中比较结果，现在是对该手术类型因果效应的一个更可信的估计。这个过程是精细的；它需要深厚的临床知识来选择正确的协变量，并进行仔细的诊断以确保“双生子”真正相似。

### 健康的前沿：基因、亚组与生存

倾向性评分的用途延伸到了医学的最前沿。在肿瘤学中，我们可能想比较一种新的免疫疗法与传统的化疗对宫颈癌的疗效 [@problem_id:4453171]。在这里，结果不仅仅是单个测量值，而是随时间变化的生存状况。倾向性评分可以与生存分析方法（如Cox比例风险模型）无缝集成，以估计一种治疗如何影响患者生存的整个轨迹，同时调整从疾病分期到肿瘤上特定生物标志物等一系列混杂因素。

也许最深刻的是，倾向性评分帮助我们驾驭混杂与我们所谓的“效应修饰”之间的复杂相互作用。混杂因素是一种干扰，是我们必须消除的偏倚来源。而效应修饰词则是一项发现——它提示我们一项治疗对不同类型的人效果不同。

考虑抗血小板药物clopidogrel。其有效性依赖于体内一种名为CYP2C19的酶的激活。有些人携带一种使该酶活性降低的基因变异。在研究clopidogrel与另一种药物ticagrelor时，这个基因在我们的故事中扮演了一个引人入胜的角色 [@problem_id:4814015]。了解这一点的医生可能更倾向于给携带“[功能丧失](@entry_id:273810)”基因的患者开ticagrelor。在这个角色中，该基因是一个*混杂因素*。但该基因也直接改变了clopidogrel的工作方式。在这个角色中，它是一个*效应修饰词*。倾向性评分使我们能够处理这两种角色。我们必须将该基因包含在我们的倾向性评分模型中以消除其混杂效应。但一旦我们这样做了，我们能够——也应该——更进一步。我们可以*分别*为携带和不携带该基因变异的患者估计治疗效果。这不再仅仅是问“这个治疗有效吗？”而是“它对谁有效？”

这就是亚组分析的目标。当我们想知道一种新的糖尿病药物在有无慢性肾脏病的患者中效果是否不同时 [@problem_id:4620029]，我们不能只检查整个人群的平衡情况。我们必须确保我们的倾向性评分调整在*有肾病的组内*创造了公平的比较，并在*没有肾病的组内*创造了另一个独立的公平比较。这需要拟合更精细的倾向性评分模型，并且关键的是，要为每个亚组分别进行平衡诊断。这是一种要求更高的分析，但也是我们从群体平均效应走向个性化医疗的方式。

### 超越临床：社会、空间与数据

倾向性评分的逻辑并不仅限于医学。它是任何观察性科学的通用工具。

在流行病学中，我们可能研究接触工业溶剂与工厂工人患皮炎风险之间的联系 [@problem_id:4589718]。一个简单的分析可能会显示，接触溶剂的工人风险更高。但如果接触溶剂的工人主要从事薪水较低、[体力](@entry_id:174230)要求更高的工作，而这些工作特征也增加了皮肤问题的风险呢？工作等级就成了一个典型的混杂因素。通过按工作等级对我们的分析进行分层，或使用倾向性评分，我们可以看到混杂在起作用。在一个精心设计的教学例子中，一旦控制了混杂，一个虚假的关联可能会完全消失，从而揭示该溶剂根本没有效果。

这个概念甚至可以扩展到考虑空间本身。想象一下研究居住在主要公路附近的健康影响 [@problem_id:4620527]。居住在高速公路附近的人可能在很多方面（如收入、种族）与居住在较远地方的人不同。但可能也存在一个未测量的“空间混杂因素”——某个其他环境因素，它随地理位置变化，既影响人们的居住地，也影响他们的健康。为了解决这个问题，研究人员开发了“空间倾向性评分”。预测暴露（居住在高速公路附近）的模型不仅包括个体特征，还包括一个关于个人地理坐标的灵活函数。在匹配阶段，人们可以坚持寻找一个不仅倾向性评分相似，而且地理位置也相近的“统计双生子”。这种统计思维与空间思维的优雅结合，有助于将暴露的影响从环境的复杂织锦中分离出来。

最后，倾向性评分是现代数据科学的基石，帮助我们应对其两大挑战：混乱的数据和有偏倚的数据。

现实世界的数据，特别是来自电子健康记录（EHR）等来源的数据，通常是不完整的 [@problem_id:4612514]。某个患者的特定实验室检测可能缺失。为什么？如果是“[完全随机缺失](@entry_id:170286)”（MCAR）——比如一个试管被打碎了——问题不大。但如果是“[随机缺失](@entry_id:168632)”（MAR）——医生因为患者年轻且看起来健康而没有开具检测？或者更糟，是“[非随机缺失](@entry_id:163489)”（MNAR）——检测结果太惊人以至于记录被隐藏了？倾向性评分分析的有效性，和任何分析一样，都取决于这些假设。理解它们迫使我们批判性地思考我们的数据*为什么*看起来是这个样子。

更值得注意的是，倾向性评分甚至可以用来校正整个数据集的选择偏倚 [@problem_id:4938661]。想象你有一个来自健康应用程序的大型数据集——一个由志愿者组成的“非概率样本”。它信息丰富，但偏倚严重；应用程序用户并不能代表普通人群。另外，你有一个小而精心收集的“概率样本”——一个具有代表性但缺乏详细健康数据的正规全国性调查。通过将两者结合，你可以根据在两个样本中都测量的一组协变量（如年龄和性别），来模拟个体被纳入有偏倚的应用程序样本的倾向性。然后，你可以使用这些倾向性来重新加权应用程序用户，使他们的协变量分布与全国人口的分布相匹配。这种强大的技术使我们能够“消除”大型、方便的数据集的偏倚，这在数据来源激增但往往不具代表性的时代是一项至关重要的任务。当然，这个过程需要仔细的诊断，例如检查各组之间倾向性评分的重叠情况，以确保我们没有进行过度外推，并检查可能使我们的估计不稳定的极端权重 [@problem_id:4549601]。

从医生的决策，到工人的工作场所，再到我们呼吸的空气和数字世界的有偏倚的[数据流](@entry_id:748201)，倾向性评分提供了一种统一的思维方式。它是一种纪律严明、数学化的方法，用以回答那个简单而深刻的问题：“与什么相比？”它不会变魔术——其结论的好坏取决于我们输入的数据和我们做出的假设——但它提供了一个强大的框架，用以在一个复杂的、非随机化的世界里寻求更清晰的真相。