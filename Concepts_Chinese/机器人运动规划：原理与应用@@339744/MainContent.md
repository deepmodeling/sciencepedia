## 引言
运动规划是机器人学中最基本的挑战之一。它解决了一个看似简单的问题：机器人如何从A点到达B点？然而，现实情况是一个复杂的问题，需要在充满障碍、约束和相互竞争目标的世界中进行导航。本文旨在弥合移动的物理行为与智能规划该移动所需的抽象计算框架之间的知识鸿沟。它提供了一种描述机器人世界的形式化语言，以及一个有效导航的数学技术工具箱。

在接下来的两章中，我们将踏上一段从基础理论到广泛应用的旅程。在“原理与机制”一章中，我们将探索机器人如何通过构型空间的视角感知其环境，连续问题如何简化为离散的图，以及我们如何通过优化来定义和找到“最佳”路径。然后，在“应用与[交叉](@article_id:315017)学科联系”一章中，我们将拓宽视野，看看这些核心原理如何超越[机器人学](@article_id:311041)，揭示其与物理学、生物学甚至[计算金融学](@article_id:306278)的深刻联系，展示这些思想的普适力量。

## 原理与机制

要构建一个能够在世界中导航的机器人，我们必须首先教会它如何*看待*这个世界。但机器人的视角与我们不同。它看到的不是椅子和桌子，而是一个充满可能性的数学景观，一个由有效和无效构型组成的世界。我们的任务是理解这片景观：绘制其地形，找到穿越其中的路径，并最终发现定义最优雅、最高效路线的原则。

### 机器[人眼](@article_id:343903)中的世界：构型空间

让我们从一个非常简单的问题开始。如果你是一个在平面上移动的点，你如何描述你的状态？很简单，你只需要两个数，即你的 $(x, y)$ 坐标。但机器人不是一个点。它有身体，有大小和形状。如果一个机器人是正方形，它能穿过一个点状机器人可以穿过的狭窄间隙吗？当然不能。机器人自身的几何形状对其运动施加了约束。

这就是**构型空间**（或C空间）的核心思想。机器人的构型是对机器人上每一点位置的完整规范。对于一个只能在平面上平移而不旋转的简单刚体机器人，其构型可能只是其上一个特定参考点的 $(x, y)$ 位置。对于一个机械臂，其构型则是其所有关节角度的集合。C空间是*所有可能构型*的集合。

现在，在现实世界中存在障碍物。在C空间中，这些障碍物会发生变换。现实世界中的一个障碍物会变成一个“构型空间障碍物”——即C空间中的一个区域，对应于所有机器人会与该现实世界障碍物发生碰撞的构型。

我们如何确定这个C空间障碍物的形状呢？对此有一个优美的几何构造方法。对于一个只平移（滑动而不旋转）的简单机器人，C空间障碍物是现实世界障碍物与机器人形状（绕其参考点反射）的**[闵可夫斯基和](@article_id:355802)**。你可以把它想象成，取机器人的形状，将其翻转，然后在障碍物的边界上“涂抹”一圈。由此产生的“膨胀”形状就是机器人参考点不能进入的区域。例如，如果我们有一个三角形机器人和一个四边形障碍物，这个过程会得到一个新的、更大的多边形，其顶点由机器人和障碍物的组合几何形状决定 [@problem_id:2108109]。

C空间中*不是*障碍物的部分是**自由空间**。这是机器人保证不会发生碰撞的“安全区”。运动规划就是一条从起始构型到目标构型的路径，且该路径完全位于此自由空间内。即使是一条看似简单的直线路径也可能无效。想象一个由半平面定义的安全区，比如所有满足 $y \ge 0$ 的点。该区域内两点之间的直线将始终保持在该区域内，这是凸性的一个美妙结果。但是，一条向下凹陷的路径，比如一条抛物线，就很容易在回到安全区之前进入禁区 [@problem_id:1290964]。确保路径有效需要检查它是否遵守自由空间的所有边界。对于简单的边界，比如一条直线，我们通常只需检查一条直线段的端点，因为线性函数在一个线段上的最小值或最大值必然出现在其端点上 [@problem_id:2150782]。

### 寻找路径：从连续空间到离散图

那么，我们的机器人生活在一个（可能非常高维的）C空间中，它需要找到一条穿过自由空间的路径。它是如何做到的呢？自由空间是连续的，包含无限多条可能的路径。试图对所有路径进行推理是不可能的。一个更实用的方法是通过创建一个路线图来简化世界，也就是我们在数学上所说的**图**。

我们可以在世界上覆盖一个网格，并将每个网格单元表示为图中的一个节点。如果机器人可以在相应的单元格之间移动，那么两个节点之间就存在一条边。这将连续的运动问题转化为了在图中寻找路径的离散问题。现在，我们可以运用[图论](@article_id:301242)的全部力量来解决问题。为了找到移动步数最少的路径，我们可以使用像**[广度优先搜索](@article_id:317036)（BFS）**这样的经典[算法](@article_id:331821)，该[算法](@article_id:331821)从起始节点开始逐层探索图，直到找到目的地 [@problem_id:1532951]。

这种离散化改变了我们对“距离”的概念。在城市网格中，两点之间最短的行车距离不是一条直线，而是水平和垂直距离的总和。这被称为**[出租车度量](@article_id:301568)**或[曼哈顿距离](@article_id:340687)：$d_1((x_1, y_1), (x_2, y_2)) = |x_1 - x_2| + |y_1 - y_2|$。当我们改变衡量距离的方式时，我们实际上改变了空间的几何结构！在我们熟悉的欧几里得世界中，任何旋转都是一种**[等距变换](@article_id:311298)**——它保持距离不变。但在[出租车度量](@article_id:301568)的世界里，一般的旋转会拉伸或缩短距离。只有非常特定的变换，如平移、沿坐标轴的反射以及90度旋转，才是保持出租车距离的等距变换 [@problem_id:1870056]。这是一个深刻的教训：移动的“最佳”方式完全取决于你如何定义移动的成本。

如果机器人的状态更复杂怎么办？假设它可以在地板上的走道之间移动，也可以在升降机上于不同垂直层级之间移动。现在的状态是一个数对：（走道位置，垂直层级）。我们可以将走道建模为一个图 $G_1$，将层级建模为另一个图 $G_2$。那么，完整的[状态空间](@article_id:323449)就是一个新的、更大的图，称为**笛卡尔积** $G_1 \square G_2$。从任何状态 $(u, v)$，机器人既可以水平移动到相邻的走道 $u'$（到达 $(u', v)$），也可以垂直移动到相邻的层级 $v'$（到达 $(u, v')$）。这种优雅的构造方式使我们能够以结构化的方式从简单的组件构建出非常复杂的高维状态空间 [@problem_id:1479130]。

### “最佳”路径的艺术：优化与平滑性

找到*一条*路径是一回事。找到一条*好的*路径则是另一回事。但什么使一条路径“好”呢？是最短的？最快的？最安全的？还是最舒适的？通常，它是所有这些因素的结合。这就是优化的领域。

一条好路径最重要的品质之一是**平滑性**。想象一下乘坐一辆瞬间改变方向或速度的交通工具。这趟旅程会非常不舒服和颠簸。这种颠簸感与**加加速度（jerk）**有关，它是加速度的变化率——位置对时间的三阶[导数](@article_id:318324)，单位是 $\mathrm{m/s^3}$。高加加速度意味着作用在系统上的力会急剧变化。对机器人来说，这意味着对电机和关节的压力；对乘客来说，则意味着令人作呕的乘坐体验。因此，运动规划的一个主要目标通常是生成“加加速度受限”的轨迹 [@problem_id:2384774]。

这种通过最小化某个量来寻找“最佳”路径的思想在物理学中有着深厚的根基。它就像[Fermat原理](@article_id:322540)中光走耗时最少的路径，或者力学中的[最小作用量原理](@article_id:299369)。我们可以将“最平滑”的曲线定义为使其总“弯曲能量”最小化的曲线，这可以由其二阶[导数](@article_id:318324)平方的积分 $\int [u''(x)]^2 dx$ 来建模。利用变分法的强大工具，我们可以证明，在通过一组给[定点](@article_id:304105)的情况下，最小化该能量的函数是分段**三次多项式** [@problem_id:2216716]。这不仅仅是一个数学上的奇趣；它正是三次样条的起源，而三次样条是[计算机图形学](@article_id:308496)和[机器人学](@article_id:311041)中用于生成平滑、自然路径的最基本工具之一。

另一种生成平滑路径的流行方法是使用**[贝塞尔曲线](@article_id:321326)**。这些曲线由一组控制点定义。曲线本身通常不穿过内部的控制点，但这些点以一种直观的方式引导其形状。[贝塞尔曲线](@article_id:321326)有一个极好的性质，即它们总是被包含在其控制点的凸包内。我们可以利用这个性质来强制施加约束。例如，如果我们需要一条路径保持在某个天花板以下，我们可以推导出控制点位置所需满足的精确数学约束，以保证整条曲线都遵守安全限制 [@problem_id:2213773]。

在现实世界中，我们很少只有一个目标。我们想要一条既短又安全的路径。这些目标可能相互冲突。一条较短的路径可能会危险地靠近障碍物。我们如何做出理性的权衡？我们可以定义一个权衡不同目标的**复合[代价函数](@article_id:638865)**。例如，我们可以使用**$L_2$范数**来衡量路径偏离直线的总偏差，这就像是偏差的[均方根](@article_id:327312)平均值。同时，我们可以通过找到路径上最接近障碍物的点，并取该安全距离的倒数来衡量风险。这种最坏情况下的风险是一个**$L_{\infty}$范数**。通过将这两个成本相加，或许赋予它们不同的权重，我们可以定量地比较不同的路径，并做出决定，例如，一条稍长的路径因为明显更安全而更优越 [@problem_id:2389366]。

### 当规划变得困难：[计算复杂性](@article_id:307473)一瞥

我们已经建立了一个优美的数学框架。那么，我们总能找到最佳路径吗？或者甚至任何路径吗？事实证明，答案是“并非总是那么容易”。

考虑一个不仅有墙壁，还有彩色门和钥匙的迷宫。要通过一扇红色的门，你首先需要找到一把红色的钥匙。现在，机器人的状态不仅仅是其位置 $(x, y)$，而是元组 `(x, y, 已收集钥匙的集合)`。对于 $k$ 种类型的钥匙，机器人可能持有的钥匙集合有 $2^k$ 种可能。C空间，即我们的[状态图](@article_id:323413)，其大小呈指数级爆炸！一个简单的BFS或DFS搜索如果记住所有访问过的状态，将需要指数级增长的内存量，即使钥匙数量不多，也很快变得不可行。

这是一个属于计算机科学中被称为**[PSPACE](@article_id:304838)**的“困难”问题类别的问题。虽然找到一个解决方案可能需要难以想象的长的时间，但存在一些巧妙的递归[算法](@article_id:331821)，它们仅使用多项式大小的内存——即可管理的、不会指数级爆炸的内存量——就能确定是否存在路径 [@problem_id:1454881]。这是[理论计算机科学](@article_id:330816)一个惊人的结果：即使在一个天文数字大小的[状态空间](@article_id:323449)中，我们仍然可以通过小心地重用少量内存来导航而不会迷路。

此外，即使我们可以构建一个优化问题来寻找“最佳”路径，解决它也并非易事。像[Karush-Kuhn-Tucker (KKT)条件](@article_id:355460)这样的优化方法帮助我们找到“驻点”——即我们代价函数梯度为零的位置，有点像山谷的底部或山顶。然而，一条局部平稳的路径并不能保证是全局最佳的。我们可能会找到一条局部最优的路径——比其所有直接邻居都好——但在可能性的景观中，可能存在一条位于遥远之处的、好得多的完全不同的路径 [@problem_id:2407291]。

因此，一个机器人从A到B的旅程不仅仅是物理上的，也是计算上的。这是一段穿越高维抽象空间的旅程，由几何、[图论](@article_id:301242)和优化的原则引导。这是一个充满隐藏复杂性和惊人简单性的景观，其中的挑战既在于定义正确的问题，也在于找到答案。