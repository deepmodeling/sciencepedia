## 引言
[单细胞RNA测序](@entry_id:142269)彻底改变了生物学，使我们能够分析单个细胞的基因表达谱，并揭示前所未有的生物学复杂性。然而，这项强大的技术并非没有挑战。样本制备过程本身就会引入技术噪音，这些噪音可能掩盖真实的生物学信号，在数据中制造出“幽灵”。其中一种最普遍的假象就是环境RNA——来自破裂细胞的游离RNA，它污染了完整细胞的测量结果。本文旨在解决一个关键的知识空白，即如何识别并通过计算方法去除这种污染，以确保科学发现的可靠性。

本文将引导您全面了解环境RNA。在第一部分**原理与机制**中，我们将探讨组织制备过程中环境RNA的[生物物理学](@entry_id:154938)来源，并深入研究用于从数据中“驱除”这一幽灵的统计学逻辑。随后，在**应用与跨学科联系**中，我们将看到这些校正方法在实践中如何应用，展示洁净的数据对于在神经科学、微生物学等领域取得可靠发现以及构建可靠的机器学习模型是何等重要。

## 原理与机制

为了理解我们如何能听到单个细胞的低语，我们必须首先认识到它所处的充满噪音的环境。从一个活生生的组织到一个洁净的基因表达数据集，这一过程充满了挑战。制备细胞用于研究的行为本身就引入了一种微妙但普遍的污染形式——数据中的一个“幽灵”，即**环境RNA**。理解这个幽灵——它从何而来，如何困扰我们的测量，以及我们如何驱除它——是生物学、物理学和统计学之间相互作用的一个优美范例。

### 温柔的“拆解”艺术

想象一个组织，比如一块肝脏或一个发育中的肾脏，它不是一个简单的细胞袋，而是一座精心建造的城市。细胞是建筑物，它们通过一个复杂的蛋白质“砂浆”和“脚手架”网络——即**细胞外基质**——连接在一起。为了逐一研究这座城市的居民，我们首先需要把它们弄出来。我们不能只是把它们摇散。我们必须主动拆除将它们结合在一起的结构。

这通常通过一剂酶的混合物来完成，这些酶是强大的分子机器，如**collagenase**和**dispase** [@problem_id:1520817]。可以把它们想象成一支生化拆迁队，任务是溶解蛋白质砂浆以释放单个细胞。这个过程称为**组织解离**，是任何[单细胞分析](@entry_id:274805)必不可少的第一步。没有它，我们得到的将是一个不可分割的组织块，而不是我们可以单独分析的单个细胞悬液。

但拆迁是一项 messy 的工作。它是在蛮力与温柔说服之间的微妙平衡，是效率与保存之间的权衡。而我们的幽灵故事就从这里开始。

### 不可避免的混乱：环境RNA从何而来？

没有完美的拆迁。在将细胞从细胞外基质中解放出来的过程中，一些细胞——特别是脆弱或敏感的细胞——会受损。它们脆弱的外[膜破裂](@entry_id:187431)，其内部物质[溢出](@entry_id:172355)到周围的液体中。这些细胞碎片包含了内部的一切：蛋白质、代谢物，以及对我们的故事最重要的信使RNA (mRNA) 分子。

结果是，我们原始的单细胞悬液变成了一锅“汤”。它包含了数百万个漂亮、完整的单细胞，漂浮在来自它们裂解邻居的游离RNA的污染背景中。这个背景就是我们所说的**环境RNA**。

产生的环境RNA数量关键取决于解离方案的严酷程度，这是一个迷人的应用[生物物理学](@entry_id:154938)问题 [@problem_id:2888876]。方案的选择涉及平衡几个因素：

-   **温度**：根据控制[反应速率](@entry_id:139813)的Arrhenius原理，酶在较暖的温度下工作得更快，例如$37^{\circ}\mathrm{C}$（体温）。然而，这种温暖也会给细胞带来压力，可能改变它们的基因表达或直接杀死它们，从而产生更多的环境RNA。较低的温度，比如$10^{\circ}\mathrm{C}$，则温和得多，能够保持细胞的天然状态，但解离速度较慢，可能需要专门的冷活性酶。

-   **机械力**：为了帮助酶发挥作用，必须对组织进行物理搅动。但是多大的力算过大呢？通过狭窄的吸头进行剧烈吹打会产生巨大的**剪切应力**，这简直可以撕裂[细胞膜](@entry_id:146704)。温和地旋转或颠倒混合则要温和得多，但在打散细胞团块方面可能效果较差。

-   **化学环境**：甚至化学环境也很重要。添加像**DNase I**这样的酶至关重要。当细胞裂解时，它们会释放出长而黏的DNA链，导致完整细胞聚集在一起。这种聚集需要更大的机械力来打散，从而形成一个细胞破坏的恶性循环。DNase I能切断这种黏性DNA，使悬液保持流动，并以最小的力使细胞保持分离。

最终，一定量的细胞裂解是不可避免的。由此产生的环境RNA汤的图谱将是原始组织中最丰富或最脆弱细胞的幽灵般的回响。如果组织中含有血液，这锅汤就会富含[血红蛋白](@entry_id:136885)RNA。如果它含有许多肌肉细胞，它就会富含肌肉特异性RNA。这锅汤就是我们幽灵的起源。

### 机器中的幽灵

现在，让我们跟随这锅汤进入现代[单细胞测序](@entry_id:198847)机器的核心。在最常用的方法，即**基于液滴的scRNA-seq**中，细胞悬液流过一个微流控芯片，该芯片将单个细胞封装到数百万个微小的油滴中。每个液滴都是一个微型实验室，包含一个单细胞和分析其RNA所需的试剂。

这里的关键点是：当一个液滴形成时，它不仅仅捕获一个细胞。它还捕获了周围液体的一小份随机样本——我们的环境RNA汤。测序机器以其优雅的精确性，无法区分哪些RNA理应属于细胞，哪些RNA只是从汤中被动地一同被包裹。它将所有这些RNA都视为源自该液滴。

为了追踪一切，该过程使用两种类型的分子标签 [@problem_id:3311819]：

1.  一个**[细胞条形码](@entry_id:171163)**，这是一个唯一的序列标签，附着在单个液滴内的所有RNA分子上。这就像每个细胞的唯一“地址”。
2.  一个**[唯一分子标识符 (UMI)](@entry_id:265196)**，这是一个在扩增*前*附着在每个单独mRNA分子上的短随机序列。这就像每个分子的唯一“序列号”，使我们能够计算分子的真实数量，而不仅仅是PCR扩增过程中产生的拷贝数。

测序后，我们计算与每个[细胞条形码](@entry_id:171163)相关联的每个基因的唯一UMI数量。但我们测量的并非细胞的真实表达。对于一个基因 $g$ 在一个细胞 $c$ 中观察到的UMI计数，我们称之为 $X_{cg}$，实际上是两个独立贡献的总和：来自细胞内部的真实分子数 ($N_{cg}$) 和来[自环](@entry_id:274670)境汤的污染分子数 ($A_{cg}$)。

$$ X_{cg} = N_{cg} + A_{cg} $$

这是我们幽灵的数学体现。观察到的计数 $X_{cg}$ 被环境计数 $A_{cg}$ 所困扰。对于一个在细胞中确实不存在的基因 ($N_{cg} = 0$)，我们可能仍然观察到一个正计数 ($X_{cg} > 0$)，这纯粹是由于[环境污染](@entry_id:197929)。这可能导致我们相信一个基因是活跃的而实际上不是，或者极大地高估其表达水平。这种幻影表达可以在细胞之间产生虚假的相似性，模糊不同细胞类型之间的界限，甚至创造出完全人为的细胞簇，使科学家们白费功夫 [@problem_id:2646061]。

### 驱除幽灵：去污染的逻辑

我们到底如何解这个方程？我们只有一个测量值 $X_{cg}$，但有两个未知数 $N_{cg}$ 和 $A_{cg}$。这在数学上似乎是不可能的。解决方案是一项优美的统计学侦探工作，依赖于找到巧妙的方法来直接测量这个幽灵。

第一个线索来自测序过程本身。在一个典型的实验中，绝大多数液滴实际上是空的——它们没有捕获到细胞。但它们仍然捕获了那锅汤！通过分析这些**空液滴**的数据，我们可以获得环境RNA池的直接、高保真度的图谱。我们可以测量其平均组成，可以用一个背景速率向量 $\boldsymbol{\lambda}$ 来表示，其中每个元素 $\lambda_g$ 是基因 $g$ 的典型环境速率。

这告诉我们这个幽灵“长什么样”。但我们仍然不知道它在任何一个含细胞的液滴中有多“大”。被捕获的汤量在不同液滴之间可能略有不同。为了估计这一点，我们需要第二个，甚至更巧妙的技巧。

我们寻找那些我们根据生物学确定性知道*不应该*在我们正在研究的细胞类型中表达的基因 [@problem_id:2752197]。想象一下，我们正在分析来自大脑样本的神经元。神经元不制造[血红蛋白](@entry_id:136885)，即[红细胞](@entry_id:138212)中携带氧气的蛋白质。因此，任何血红蛋白基因在神经元中的真实表达必须为零 ($N_{\text{hemoglobin}} = 0$)。如果我们观察到与神经元条形码相关联的任何血红蛋白UMI计数，这些计数*必定*来自环境汤，源于组织血管中存在并在解离过程中裂解的红细胞。

这些“生物学上不可能表达的”基因充当了我们的幽灵检测器。通过将特定液滴中这些标记基因的观察计数与其在环境图谱中的预期速率 ($\lambda_g$) 进行比较，我们可以估计该液滴中[环境污染](@entry_id:197929)的总量。我们称这个液滴特异性污染分数为 $\delta$。

有了这两个信息——环境图谱 $\boldsymbol{\lambda}$（来自空液滴）和污染分数 $\delta$（来自不可能的标记基因）——我们就可以估计该细胞中*每个*基因的环境贡献：

$$ A_{g} \approx \delta \cdot \lambda_{g} $$

现在，我们终于可以进行驱魔了。我们从原始观察值中减去这个估计的环境贡献，以获得真实原生计数的估计值 $\hat{N}_g$：

$$ \hat{N}_{g} = \max(0, X_{g} - \delta \lambda_{g}) $$

我们取这个值与零的最大值，因为真实的表达不能是负数。这个植根于**[最大似然估计](@entry_id:142509)**的程序，使我们能够以计算方式“清洗”数据，逐个细胞、逐个基因地移除幻影计数，揭示出细胞生物学更真实的图景。

### 为何这很重要：区分真实与假象

这个过程不仅仅是统计学上追求整洁的学术练习。它对于做出可靠的生物学发现绝对至关重要。环境RNA只是几种**混杂因素**之一——这些技术性假象会在数据中引起虚假模式，并掩盖我们试图寻找的真实生物学信号 [@problem_id:3314527]。

考虑一个戏剧性的案例研究：一位科学家在一个发育中的肾脏中发现了一种似乎是新的、罕见的祖细胞类型 [@problem_id:2646061]。这个细胞簇表达了正确的谱系标记，但它也显示出高水平的应激基因，并且可疑的是，它只出现在用更严酷的解离方案制备的样本中。这是一个关于脆弱、瞬时细胞状态的突破性发现吗？或者它仅仅是一个假象——一群受应激、垂死的细胞，其数据被邻居的环境RNA严重污染，使它们看起来像它们并非是的东西？

应用环境RNA校正是回答这个问题的关键。如果在校正后这个神秘的簇消失了，我们就可以自信地将其归类为假象，从而节省了本可能浪费在追逐一个幽灵上的无数小时和资源。如果它持续存在，其生物学真实性就得到了加强，它便成为进一步研究的真正候选者。同样的逻辑也适用于在复杂系统（如[脑类器官](@entry_id:202810)）中准确分类细胞类型，在这些系统中，区分真实的细胞身份与双细胞和环境RNA等假象对于模型的有效性至关重要 [@problem_id:2701458]。

最终，环境RNA的故事是现代科学过程的一个完美例证。它展示了对测量物理过程的深刻理解如何揭示我们数据中的幽灵，以及统计学的优雅逻辑如何提供驱除它们的工具。通过仔细清除我们自己干预所产生的假象，我们获得了对生命世界深邃美丽与复杂性更清晰、更诚实的视野。

