## 引言
许多最强大的优化工具，如单纯形法，擅长为问题找到最佳可能解。然而，它们在连续世界中运行，常常得出小数结果，例如“建造 2.5 辆汽车”或“雇佣 3.5 个人”。对于现实世界中解决方案必须是整数的应用来说，这些答案是不切实际的。[连续优化](@article_id:345973)与离散现实之间的这种鸿沟是[整数规划](@article_id:357285)的核心挑战。本文深入探讨了一种经典而优雅的解决方案：[Gomory 切割](@article_id:639258)。它是割平面法的基石，提供了一种严谨的方法，将小数答案精炼为可行的、最优的整数解，而无需诉诸简单且常常不正确的四舍五入。

本文将引导您了解这一里程碑式技术的理论与应用。在“原理与机制”一章中，您将学习到切除小数解背后的几何直觉，以及直接从问题方程中生成这些切割的代数方法。随后，“应用与跨学科联系”一章将探讨该方法如何在金融、工业工程和计算机科学等不同领域应用，展示其在解决具体、现实世界问题中的关键作用。

## 原理与机制

那么，我们已经登上了线性规划的高峰，到达了顶点……却发现自己漂浮在数学的迷雾中。我们的“最优”解，这个[算法](@article_id:331821)优雅的杰作，可能会告诉我们制造 $2.5$ 辆汽车或分配 $3.5$ 个人去完成一项任务。这是一个美丽的答案，但它适用于一个不存在的世界。在我们的世界里，事物都是整数的。我们如何才能回到坚实的地面上，找到一个尊重现实不可分割性的解，同时又不失我们辛苦求得的最优性呢？

答案不在于重新开始，而在于一种极其巧妙的数学“手术”。这就是**割平面法**的世界，而其最锋利的工具就是**[Gomory 切割](@article_id:639258)**。

### 几何学家的策略：切除不可能的区域

想象一下，你的约束集就像一张平面地图上被栅栏围起来的区域——一个多边形。这就是你的**[可行域](@article_id:297075)**。根据[线性规划](@article_id:298637)的规则，最佳可能解必须位于该多边形的一个角点（顶点）上。我们找到了那个角点，但它位于一个小数坐标位置，比如说坐标为 $(x_1, x_2) = (\frac{9}{4}, \frac{15}{4})$ [@problem_id:2211972]。

现在，把*真正的*解——即整数点——想象成这个栅栏区域内一个由等间距点组成的网格。我们的目标是找到这个网格上最好的那个点。我们找到的那个小数角点是*整个*多边形中的最佳点，但它不是一个网格点，而是漂浮在网格点之间的空间里。

由 Ralph Gomory 首创的绝妙想法是：让我们添加一道新的栅栏。我们可以画一条直线——一个新的约束——它会小心地切掉我们小数解所在的那个角。关键在于，画这条线时，它*绝不会*切掉任何有效的整数点。它只移除了连续空间中我们现在知道是无用的一部分，因为这部分包含了我们的小数最优解，但没有任何整数解。

这个新的约束就是**[Gomory 切割](@article_id:639258)**。通过添加它，我们使旧的小数解变得不合法。[可行域](@article_id:297075)缩小了，我们被迫在这个更小、更精炼的形状中寻找一个新的最优角点。这个新的角点将更接近我们寻求的整数解。该过程旨在收紧**[线性规划松弛](@article_id:330819)（LP relaxation）**的可行域，逐步雕琢它，直到其最优角点正好落在一个整数点上 [@problem_id:2443992]。

### 炼金术士的秘密：从分数中锻造约束

这个几何图像令人振奋，但这条神奇直线的方程从何而来？Gomory 的天才之处在于他意识到，构建该切割所需的信息已经隐藏在小数解本身的方程中——具体来说，就是在最终的[单纯形表](@article_id:297239)中。

让我们来看一个最终[单纯形表](@article_id:297239)中给出了小数解的一行。假设一个必须是整数的变量 $x_1$ 被发现其值为 $\frac{12}{5}$。该变量的[单纯形表](@article_id:297239)方程可能看起来是这样的 [@problem_id:2211934]：

$$x_1 + \frac{3}{5}s_2 - \frac{2}{5}s_3 = \frac{12}{5}$$

这里，$s_2$ 和 $s_3$ 是非[基变量](@article_id:309217)，当前等于零。现在，我们来玩一个简单但深刻的游戏。我们将方程中的每个数字分解为其整数部分和分数部分。记住，任何数 $y$ 都可以写成 $y = \lfloor y \rfloor + f(y)$，其中 $\lfloor y \rfloor$ 是不大于 $y$ 的最大整数，而 $f(y)$ 是非负[小数部分](@article_id:338724)。

让我们将此应用于我们的方程：

$$x_1 + \left(0 + \frac{3}{5}\right)s_2 + \left(-1 + \frac{3}{5}\right)s_3 = 2 + \frac{2}{5}$$

让我们重新整理一下，将所有整数部分放在一边，所有分数部分放在另一边：

$$x_1 - s_3 - 2 = \frac{2}{5} - \frac{3}{5}s_2 - \frac{3}{5}s_3$$

现在是关键的洞察。在一个有效的整数解中，所有变量（$x_1$, $s_2$, $s_3$）都必须是整数。因此，方程的整个左侧，$x_1 - s_3 - 2$，必须是一个整数。如果左侧是整数，那么右侧*也必须是整数*。

让我们仔细看看右侧：$\frac{2}{5} - \frac{3}{5}s_2 - \frac{3}{5}s_3$。因为 $s_2$ 和 $s_3$ 必须是非负整数，所以项 $(\frac{3}{5}s_2 + \frac{3}{5}s_3)$ 必须是非负的。这意味着右侧的整个表达式最多为 $\frac{2}{5}$。

所以我们有一个表达式，它必须是整数，并且必须小于或等于 $\frac{2}{5}$。哪些整数符合这个描述？只有 $0, -1, -2, \dots$。在任何情况下，它都必须小于或等于零。

$$\frac{2}{5} - \frac{3}{5}s_2 - \frac{3}{5}s_3 \le 0$$

重新整理这个不等式，我们就得到了我们的战利品：

$$\frac{3}{5}s_2 + \frac{3}{5}s_3 \ge \frac{2}{5}$$

这个不等式就是 [Gomory 切割](@article_id:639258)！它是直接从我们[单纯形表](@article_id:297239)中的数字的小数部分锻造出来的。注意，在小数线性规划解中，$s_2=0$ 且 $s_3=0$，此时不等式变为 $0 \ge \frac{2}{5}$，这是不成立的。我们成功地创建了一个“切除”小数最优解的约束 [@problem_id:2443992]。

这个过程可以被推广。对于任何[单纯形表](@article_id:297239)中的行 $x_B + \sum_{j} a_j x_j = b$，其中 $x_B$ 是一个具有小数值 $b$ 的整数变量，[Gomory 切割](@article_id:639258)就是：

$$\sum_{j} f(a_j) x_j \ge f(b)$$

切割的系数不过是源行中系数的小数部分。这是一个极其简单而强大的方法 [@problem_id:2211985]。

### 高明之切：它会伤害无辜吗？

外科医生的首要准则是“不造成伤害”。这同样适用于我们的切割。一个切割只有在移除掉非整数空间而*不*消除任何有效整数解的情况下才是有用的。让我们来说服自己这是真的。

上面的推导依赖于一个关键事实：对于任何可行的整数解，表达式 $\sum_{j} f(a_j) x_j - f(b)$ 必须是一个整数。我们还知道，由于小数部分 $f(a_j)$ 和变量 $x_j$ 都是非负的，所以项 $\sum_{j} f(a_j) x_j$ 必须是非负的。

因此，我们有 $\sum_{j} f(a_j) x_j - f(b) = \text{整数}$，并且 $\sum_{j} f(a_j) x_j \ge 0$。由于 $f(b)$ 是一个小数部分，$0 \le f(b) \lt 1$，所以我们这个整数的最小可能值是 $0 - f(b)$，它大于 $-1$。大于 $-1$ 的最小整数是 $0$。因此，对于任何整数解，必须满足：

$$\sum_{j} f(a_j) x_j - f(b) \ge 0$$

这正是我们的切割！这个逻辑保证了任何有效的整数解都会满足该切割。例如，在一个问题中，我们推导出了切割 $x_2 \le 1$。一个已知的整数可行点是 $(x_1, x_2) = (1, 1)$。将其代入，我们得到 $1 \le 1$，这是成立的。这个整数点是安全的 [@problem_id:2211941]。切割只切除了没有整数解的区域。

### 策略师的选择：哪个切割最深？

通常，[线性规划松弛](@article_id:330819)会给出一个包含多个小数变量的解。这意味着我们可以选择使用哪一行来生成我们的切割 [@problem_id:2211972]。我们的选择重要吗？

是的，它可能很重要。有些切割比其他切割“更深”。一个更深的切割会切掉不可行区域中更大的一块，可能导致目标函数得到更大的改善，并帮助我们在更少的步骤内达到整数最优解。

考虑一个[线性规划](@article_id:298637)解为 $(x_1, x_2) = (\frac{26}{11}, \frac{21}{11})$ 的情况 [@problem_id:2211932]。我们可以从 $x_1$ 行或 $x_2$ 行生成切割。
- $x_1$ 行产生的切割是 $10s_1 + 4s_2 \ge 4$。
- $x_2$ 行产生的切割是 $3s_1 + 10s_2 \ge 10$。

将这些切割添加回问题并重新优化后，第一个切割将目标值从 $19$ 降至 $18.6$。第二个切割则将其从 $19$ 一直降至 $18$。显然，第二个切割更深，使我们更接近真正的整数最优解。

虽然没有万无一失的方法可以知道从长远来看哪个切割是最好的，但一个常用且有效的[启发式方法](@article_id:642196)是选择对应于具有**最大[小数部分](@article_id:338724)**的[基变量](@article_id:309217)的行 [@problem_id:2211979]。在我们的例子中，$x_2 = \frac{21}{11} \approx 1.909$，小数部分为 $\frac{10}{11}$；而 $x_1 = \frac{26}{11} \approx 2.363$，小数部分为 $\frac{4}{11}$。这个[启发式方法](@article_id:642196)正确地指向了 $x_2$ 行，而它也生成了更深的切割。

### 当刀刃变钝时：关于局限性的说明

最后，我们必须像诚实的科学家一样，承认没有工具是完美的。[Gomory 切割](@article_id:639258)程序会失败吗？在某种意义上，是的。有时它会生成一个平凡为真或平凡为假的切割，不提供任何新信息。

考虑这样一个情况，小数变量 $x_2 = 1.5$ 的源行为 $x_2 = 1.5 - 1 \cdot s_2$ [@problem_id:2166074]。为了构建我们的切割，我们查看系数的小数部分。右侧 $f(1.5)$ 的小数部分是 $0.5$。$s_2$ 的系数为 $1$，其[小数部分](@article_id:338724)为 $f(1) = 0$。得到的“切割”是 $0 \cdot s_2 \ge 0.5$，这简化为荒谬的 $0 \ge 0.5$。这个过程遵循了规则，但刀刃变钝了；它无法做出有意义的切割。这种情况发生在源行中所有非[基变量](@article_id:309217)系数的[小数部分](@article_id:338724)都为零时。这并不意味着问题无解，只是说明这条特定的路径没有带来进展。我们需要尝试另一种类型的切割或更先进的技术。

即使有这些偶尔的小问题，[Gomory 切割](@article_id:639258)仍然是优化理论中的一个里程碑。它证明了这样一个观点：有时，解决难题的方法不是一个全新的工具，而是对我们已有工具更深入、更巧妙的理解。它向我们展示了如何将问题的根源——分数——转化为解决方案的核心。