## 引言
科学界和工业界中许多最具挑战性的问题，从设计金融投资组合到蛋白质折叠，本质上都是优化问题。这些问题涉及在一系列复杂规则下，通过一系列二元选择来达成预期目标。虽然这些问题表面上看起来千差万别，但它们在深层结构上具有相似性。二次无约束二元优化（QUBO）框架通过提供一种通用语言来描述和解决这些问题，从而应对了这一挑战。它将抽象的决策过程转化为一个具体、物理的能量景观概念，其中最优解对应于能量最低的点。

本文将探讨这一强大模型的理论与应用。在第一章“原理与机制”中，我们将深入探讨 QUBO 语言的“语法”。您将学习如何构建表示问题的能量函数，如何使用惩罚项来施加约束，以及如何运用[退火](@article_id:319763)等技术来寻找[基态](@article_id:312876)解。接下来，第二章“一个简单想法的超常效用：QUBO 的实际应用”将带您领略 QUBO 多样化且令人惊奇的应用，展示这个单一框架如何为应对金融、生物学、[材料科学](@article_id:312640)乃至量子物理学本身的挑战提供一个全新的视角。

## 原理与机制

### 能量的通用语言

想象一下，您需要做一个艰难的决定。也许您是一位货运经理，试图在不超过卡车重量限制的情况下，为其装载价值最高的货物；或者您是一位[电路设计](@article_id:325333)师，需要在芯片上布设数千根导线而不让它们[交叉](@article_id:315017)。这些问题表面上看起来截然不同。然而，在深层次上，它们共享一个共同的结构：在一系列规则和目标的支配下（最大化价值、最小化导线长度），做出一系列的二元选择（是否包含某件物品，是否将导线放在这里）。

如果我们能找到一种通用语言来描述所有这些问题呢？一种连大自然本身都能理解的语言？这就是**二次无约束二元优化（QUBO）**背后的核心思想。它是一个框架，能将各种复杂的优化问题转化为一个单一、简单的问题：一个相互作用的粒子系统的最低能量构型是什么？

这种语言中的“句子”是一个数学表达式，即我们的成本函数：
$$
C(\mathbf{x}) = \sum_{i} Q_{ii} x_i + \sum_{i \lt j} Q_{ij} x_i x_j
$$
我们不必被这些符号吓倒。可以这样理解：变量 $x_i$ 代表我们简单的二元决策，取值为 $1$（表示“是”）或 $0$（表示“否”）。系数 $Q$ 代表这些选择的“合意性”。包含单个变量的项 $Q_{ii} x_i$ 为决策 $i$ 本身赋予了成本或回报。包含两个变量的项 $Q_{ij} x_i x_j$ 描述了当我们同时做出决策 $i$ *和* $j$ 时所产生的成本或回报。

目标是为我们所有的 $x_i$ 找到一组“是/否”的选择，使得 $C(\mathbf{x})$ 的总值尽可能小。这种表述的美妙之处在于，它将我们的抽象问题转化为了一个具体、物理的**能量景观**。每一个可能的选择组合都是这个景观中的一个位置，而 $C(\mathbf{x})$ 的值就是该位置的高度。我们的任务，就是找到这整个景观中最低的谷底——**[基态](@article_id:312876)**。

### 塑造景观：[背包问题](@article_id:336113)

让我们把这个概念具体化。考虑经典的 **0-1 [背包问题](@article_id:336113)** [@problem_id:2385346]。您有一组物品，每件物品都有一个重量 $w_i$ 和一个价值 $v_i$。您的背包有最大容量 $C$。您希望选择要装入的物品，以在总重量不超过容量的情况下最大化总价值。

我们如何为此塑造一个[能量景观](@article_id:308140)？我们需要构建一个包含两个不同部分的哈密顿量（即我们的能量函数）。

首先是**目标**。我们希望最大化总价值 $\sum v_i x_i$。然而，大自然倾向于*最小化*能量。这里的技巧非常简单：我们只需翻转符号！我们的能量函数将包含一项 $-\sum v_i x_i$。现在，价值最高的状态自然会拥有最低的能量，从而将系统引向我们[期望](@article_id:311378)的解。

其次是**约束**。我们被禁止超过容量 $C$。在我们的能量景观中，我们需要在 $\sum w_i x_i \gt C$ 的“非法”区域周围建立一道无限高的墙。一个有效的方法是使用**惩罚项**。我们在哈密顿量中添加一项，如果约束得到满足，则该项为零；如果违反约束，则该项变得非常大。一个二次惩罚项的效果很好：
$$
H_{\text{penalty}} = P \left( \sum_{i=1}^{n} w_i x_i - C \right)^2
$$
在这里，$P$ 是一个大的正数，即**惩罚强度**。如果我们的总重量恰好等于 $C$，该项为零。如果小于 $C$，我们可以通过一些巧妙的会计方法，使用“松弛”变量使该项也为零 [@problem_id:2385346]。但如果我们超过容量，括号内的项变为正数，其平方会贡献一个大的正能量。惩罚强度 $P$ 必须谨慎选择——它必须足够大，以确保违反规则的惩罚*总是*比这样做可[能带](@article_id:306995)来的任何潜在回报更严重。

综上所述，我们的总哈密顿量大致如下：
$$
H(\mathbf{x}) = -\sum_{i=1}^{n} v_i x_i + P \left( \text{违反约束} \right)^2
$$
我们现在已经成功地将[背包问题](@article_id:336113)翻译成了物理学的语言。背包的最佳装载方式，实际上就是这个数学-物理系统的[基态](@article_id:312876)。

### [辅助变量](@article_id:329712)的艺术：驯服复杂性

背包问题很简洁，但许多现实世界的问题具有更复杂的逻辑。考虑一个来自 3-[可满足性](@article_id:338525)（3-SAT）问题的子句：“$l_1$ 为真 或 $l_2$ 为真 或 $l_3$ 为真” [@problem_id:113136]。这样一个子句的[成本函数](@article_id:299129)自然会涉及三个变量的乘积，使其成为三次而非二次。看来我们只有成对相互作用的 QUBO 语言，其[表达能力](@article_id:310282)还不够。

这时就需要一点巧思了。我们可以通过引入**[辅助变量](@article_id:329712)**来扩展 QUBO 的词汇量。[辅助变量](@article_id:329712)是一个“助手”或“辅助”的[二元变量](@article_id:342193)，我们纯粹为了技术目的将其添加到系统中。

假设我们有一个棘手的三次项，如 $z_1 z_2 z_3$。我们可以通过引入一个[辅助变量](@article_id:329712) $a$ 并声明我们的意图：令 $a = z_1 z_2$ 来降低其复杂性。如果这个关系成立，我们就可以将 $a$ 代入我们的三次项中，它就变成了 $a \cdot z_3$，一个完美的二次表达式！

当然，我们必须强制[辅助变量](@article_id:329712)遵守我们的声明。我们使用与之前相同的工具：一个[惩罚函数](@article_id:642321)。我们在哈密顿量中添加另一部分，当 $a \neq z_1 z_2$ 时惩罚系统。例如，像 $P(z_1 z_2 - 2z_1 a - 2z_2 a + 3a)$ 这样的项就能实现这个目的 [@problem_id:113136]。

现在，总哈密顿量包括了原始问题变量、[辅助变量](@article_id:329712)、简化后的[目标函数](@article_id:330966)，以及保持[辅助变量](@article_id:329712)一致的惩罚项。正如对 [3-SAT](@article_id:337910) 子句的分析所示，关键的洞见是，惩罚强度 $P$ 不能是任意的。它必须取一个*最小值*，以保证新的、更大的二次系统的[基态](@article_id:312876)能够正确地对应于原始的、更复杂问题的解。如果 $P$ 太小，系统可能会发现让[辅助变量](@article_id:329712)“说谎”以获得更低的总成本在能量上更有利，从而导致错误的答案。这种精妙的平衡行为揭示了，构建一个 QUBO 既是一门艺术，也是一门科学。

### 寻找答案：退火的温和冷却

我们已经成为宏伟而复杂的能量景观的雕塑家，雕刻出完美代表我们问题的山丘和山谷。但是，在一个拥有天文数字般可能位置的景观中，我们如何找到那个唯一的最低点——全局最小值？逐一检查每一个点通常是不可行的。

在这里，我们可以再次借鉴物理学中一个优美的思想：**退火**。铁匠在铸剑时，会先将金属加热至红热状态。这给予原子足够的能量自由移动。然后，通过*缓慢地*冷却，原子有时间沉降到一个高度有序、低能量的[晶格结构](@article_id:364626)中，从而制成一把坚固、稳定的剑。如果剑冷却过快（淬火），原子会被冻结在随机、高能量的位置上，导致材料脆弱易碎。

我们可以对我们的 QUBO 问题做同样的事情。这个过程被称为**[模拟退火](@article_id:305364)**，或者在其量子力学版本中称为**[量子退火](@article_id:302047)**，它提供了一种寻找[基态](@article_id:312876)的机制 [@problem_id:2398464]。

首先，我们通常将变量从 $\{0, 1\}$ 切换到自旋物理学的语言 $\{-1, +1\}$，这是一个简单的映射，通过 $x_i = (1+s_i)/2$。这将我们的 QUBO 转换成了**[伊辛模型](@article_id:299514)**的形式，这是经典的磁性模型。

退火过程始于系统处于一个高能量的“热”状态。在量子版本中，这是通过施加一个强的**[横向场](@article_id:330193)**来实现的。您可以将这个场想象成使整个能量景观变得模糊和不确定。它不仅让[量子自旋](@article_id:298210)能够翻越能量壁垒，还能够直接“隧穿”过去。这种量子隧穿是一个关键特征，它使系统能够比经典粒子更有效地探索景观，因为经典粒子会卡在它发现的第一个山谷（一个局部最小值）中。

然后，我们通过逐渐减弱这个[横向场](@article_id:330193)的强度，来缓慢而平滑地**[退火](@article_id:319763)**系统。随着场强的减弱，能量景观变得清晰起来。量子涨落逐渐平息，自旋开始在景观斜坡的引导下，沉降到最深的可达山谷中。

如果冷却过程足够慢，系统将有时间找到真正的最低谷——[全局最小值](@article_id:345300)。在退火结束时，[横向场](@article_id:330193)为零，自旋被冻结成最终的构型。这个构型，从自旋转换回我们最初的[二元变量](@article_id:342193)后，就是我们优化问题的解。这个过程的成功通常取决于[基态](@article_id:312876)与次低能量态之间的**[能隙](@article_id:331619)**。如果在退火过程中的某个点，这个[能隙](@article_id:331619)变得非常小，系统很容易被“激发”到错误的状态，从而无法找到真正的解。

这就是完整的旅程：我们取一个复杂的人类问题，将其翻译成能量景观这一通用的物理语言，然后使用一个受物理启发的退火过程，温和地引导系统揭示其最低能量状态，而这个状态正是我们从一开始就寻求的最优解。这是计算机科学、数学和物理学之间深刻而美妙的结合。