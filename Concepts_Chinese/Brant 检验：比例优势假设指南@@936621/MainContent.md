## 引言
在许多科学和医学领域，结果不是简单的数字，而是有序的类别，例如将患者的病情评定为“轻度”、“中度”或“重度”。分析这类有序数据带来了独特的挑战：我们如何既能尊重其内在顺序，又不会错误地假设类别之间的距离相等？标准的回归方法存在不足，它们要么忽略了宝贵的排序信息，要么强加了不恰当的线性结构。本文通过探讨一种强大而简洁的解决方案——有序逻辑回归——来解决这个问题。它全面指导读者理解比例[优势模](@entry_id:263463)型的核心原则、其关键假设以及检验这些假设的方法。读者将首先在“原理与机制”一章中深入探讨模型的理论基础和机制。随后，“应用与跨学科联系”一章将展示检验这些假设不仅是一种统计形式，更是在从临床试验到遗传学等领域进行科学发现的关键步骤。

## 原理与机制

在我们认识世界的过程中，自然界呈现给我们的结果往往不是简单的“是/否”二元选项，也不是我们可以简单取平均值的数字。想象一下，医生将患者的病情分为“轻度”、“中度”或“重度” [@problem_id:4819883]，或者研究人员在改良 Rankin 量表上将中风患者的残疾程度从0级评到6级 [@problem_id:4852253]。这些都是**有序**结果：它们具有自然的顺序，但类别之间的“距离”是未知的，而且很可能是不均匀的。“无”与“轻度”之间的差异可能与“中度”与“重度”之间的差异不同。

我们如何建立一个既能尊重这种内在顺序，又不会像简单线性回归那样做出等距的幼稚假设的模型呢？我们又该如何在不丢弃宝贵的排序信息（像名义回归那样）的情况下做到这一点呢？这正是序数逻辑回归所要迎接的美妙挑战。

### 一个绝妙的想法：比例[优势模](@entry_id:263463)型

突破在于转变我们的视角。我们不再问“处于‘中度’类别的概率是多少？”，而是提出一个累积性的问题：“处于‘中度或更轻’的概率是多少？”通过关注这些**累积概率** $\mathbb{P}(Y \le k)$，我们可以将一个多类别问题重新构建为一系列更简单的、嵌套的二元问题：

-   严重程度 $\le 0$ 与 $> 0$ 的优势比是多少？
-   严重程度 $\le 1$ 与 $> 1$ 的优势比是多少？
-   严重程度 $\le 2$ 与 $> 2$ 的优势比是多少？

对于一个有 $J$ 个类别的结果，我们有 $J-1$ 个这样的问题。累积 logit 模型，更著名的名称是**比例[优势模](@entry_id:263463)型**，通过一个线性方程将这些累积事件中每一个的对数优势比与我们的预测变量（如年龄，或患者是否接受了新疗法）联系起来。对于给定的预测变量 $X$，第 $k$ 个分[割点](@entry_id:637448)的模型如下：

$$ \text{logit}[\mathbb{P}(Y \le k \mid X)] = \ln\left(\frac{\mathbb{P}(Y \le k \mid X)}{\mathbb{P}(Y > k \mid X)}\right) = \alpha_k - \beta X $$

注意这两种参数。$\alpha_k$ 值是截距，或称**截点**。$J-1$ 个分[割点](@entry_id:637448)中的每一个都有自己的截距，代表该特定划分的基线[对数优势比](@entry_id:141427)。这些截距必须是有序的（$\alpha_0  \alpha_1  \dots  \alpha_{J-2}$），以确保概率有意义。

但请看斜率 $\beta$。它没有下标 $k$。这就是该模型优雅、强大且核心的假设：**比例优势假设**。它指出预测变量 $X$ 的效应对于每一个累积分割点都是*相同*的 [@problem_id:4579263]。一种能使您处于“轻度或更好”（相对于“中度或更差”）的优势比增加一倍的疗法，也被假设能使您处于“中度或更好”（相对于“重度”）的优势比增加一倍。其效应在整个有序量表上是恒定的，或称“平行的”。

这个假设给了我们一个单一的、极易解释的数字，即**共同累积优势比** $\exp(\beta)$，它将预测变量的效应概括为在结果分布上的一个“全局性移位” [@problem_id:4852253]。其妙处在于，无论您选择观察哪个截点 $c$，预测变量任何变化的优势比都是不变的 [@problem_id:5197938]。

### 隐藏的现实：一个潜变量的故事

我们为什么要相信这样一个方便的假设可能是真的呢？在这里，我们可以讲述一个故事——一个关于表象之下可能发生的事情的强大直观模型 [@problem_id:5197938]。

想象存在一个我们无法直接看到的、真实的、潜在的连续变量。我们称之为 $S$，即潜在的“严重性”。这个[潜变量](@entry_id:143771)受我们的预测变量以一种简单的线性方式影响：

$$ S = \beta_0 + \beta_1 X_1 + \dots + \beta_p X_p + \varepsilon $$

在这里，$\varepsilon$ 只是一些随机噪声，我们假设它遵循特定的（逻辑）分布。

现在，我们观察到的有序类别——“无”、“轻度”、“中度”、“重度”——并非根本性的。它们只是当潜在的连续严重性 $S$ 跨越某些固定阈值时我们贴上的标签。

-   如果 $S \le \tau_1$，我们观察到“无”。
-   如果 $\tau_1  S \le \tau_2$，我们观察到“轻度”。
-   如果 $\tau_2  S \le \tau_3$，我们观察到“中度”。
-   如果 $S > \tau_3$，我们观察到“重度”。

如果这个直观的故事是真实的，那么观察到“等于或低于”类别 $k$ 的结果的概率，就等于[潜变量](@entry_id:143771) $S$ 小于或等于阈值 $\tau_k$ 的概率。通过一些代数运算，这个简单的想法在数学上催生了比例[优势模](@entry_id:263463)型！我们模型中的斜率 $\beta$ 正是预测变量对隐藏[潜变量](@entry_id:143771)的影响。跨类别共享一个共同斜率的假设不再是一个奇怪的数学约束，而是在一个潜在连续现实上单一、一致效应的自然结果。

### 质疑的责任：检验比例优势假设

一个优雅的故事是不够的。在科学中，我们有责任去质疑，去检验我们的假设。比例优势假设对我们的数据来说真的成立吗？这就是正式的[假设检验](@entry_id:142556)，尤其是 **Brant 检验**发挥作用的地方 [@problem_id:4821890, @problem_id:4929777]。

该检验的逻辑是一个经典的科学比较：

1.  **约束模型：** 首先，我们有比例[优势模](@entry_id:263463)型，它*约束*预测变量在所有分[割点](@entry_id:637448)上的效应相同。这是我们的零假设——我们简单而优雅的理论。

2.  **非约束模型：** 然后，我们创建一个更灵活的模型，它*不*作此假设。我们允许预测变量的效应在每个累积分[割点](@entry_id:637448)上都不同，为每个分割点提供独立的系数 $\beta_k$。这相当于为我们的结果的 $J-1$ 个二分法中的每一个拟合一个独立的二元逻辑回归 [@problem_id:4821890]。

3.  **比较：** 然后我们问：这个更复杂的、非约束的模型是否比我们简单的、约束的模型更显著地拟合我们的数据？**似然比（LR）检验**为此提供了一个完美的回答方式 [@problem_id:4819883, @problem_id:4816597]。我们计算检验统计量 $G^2 = 2(\ell_{\text{unconstrained}} - \ell_{\text{constrained}})$。这个值告诉我们复杂模型的[拟合优度](@entry_id:637026)提高了多少。在零假设（即简单模型已足够）下，该统计量服从 $\chi^2$ 分布。

该检验的自由度就是我们在复杂模型中允许的额外参数数量。对于 $p$ 个预测变量和 $J$ 个类别，自由度为 $p \times (J-2)$ [@problem_id:4821890]。例如，如果对单个预测变量的检验在 $J-2=2$ 的自由度上得到一个大的 $\chi^2$ 值，比如我们一个例子中看到的 $19.4$ [@problem_id:4819883]，那么得到的 p 值将非常小。这告诉我们，复杂[模型拟合](@entry_id:265652)度的提升极不可能是由随机机会造成的。我们美好的假设，对于这个预测变量来说，很可能是错误的。

Brant 检验及相关的[得分检验](@entry_id:171353)执行的是同样的基本逻辑 [@problem_id:4579264, @problem_id:4816597]。一个显著的**全局检验**告诉我们模型中某处违反了该假设。然后，**特定于协变量的检验**就像一个诊断工具包，精确定位是哪些预测变量导致了问题 [@problem_id:4929777]。这些正式检验可以通过图形诊断得到有力补充，例如绘制现代**代理残差**图，以直观评估模型可能在何处失效 [@problem_id:4579264]。

### 告别比例性：当假设不成立时该怎么办

发现假设被违反不是失败，而是一种发现。它告诉我们现实比我们最简单的模型更复杂，并引导我们走向更真实的描述。那么，当 Brant 检验结果显著时，我们该怎么办？

#### 外科手术式方法：部分比例[优势模](@entry_id:263463)型

通常，比例优势假设对某些预测变量成立，而对另一些则不成立。例如，一种疗法的效应可能在整个严重性量表上是一致的，而年龄的效应在区分中度和重度疾病时可能比区分无和轻度时更强 [@problem_id:4929777]。

在这种情况下，我们不必抛弃整个模型。我们可以进行统计上的外科手术。我们使用**部分比例优势（PPO）模型**，也称为广义有序 logit 模型 [@problem_id:4579263]。这种[混合模型](@entry_id:266571)是谨慎分析师的主力工具。它*仅对表现不佳的预测变量*放宽平行斜率假设，而对所有其他变量保留简约而优雅的比例优势结构 [@problem_id:4579264]。这让我们两全其美：在需要时保持灵活性，在合理时保持简洁性。

#### 放弃顺序：[多项式模型](@entry_id:752298)

如果该假设对我们大多数或所有预测变量都显著不成立，这可能表明沿有序量表进行简单“移位”的想法本身就有缺陷。在这种情况下，我们可以使用**[多项式逻辑回归](@entry_id:275878)**模型 [@problem_id:4816597]。该模型将结果类别视为纯粹的名义变量（无序），如“红色”、“绿色”和“蓝色”。它为每个类别相对于一个基准类别拟合一套独立的系数。这种方法提供了最大的灵活性，但也有代价：通过忽略排序信息，我们损失了[统计功效](@entry_id:197129)，并且解释系数网络可能比解释单个优势比要复杂得多。

#### 探索其他顺序模型

最后，值得记住的是，累积 logit 并非思考有序结果的唯一方式。还存在其他模型，如**相邻类别 logit 模型**（比较类别 $j$ 与 $j-1$）或**连续比 logit 模型**（建模顺序阶段）。这些模型在不同的概率尺度上有自己的平行性假设，可能更适合某些生物学或社会过程 [@problem_id:4579264]。然而，转换到这些模型并非万能灵药；它们只是改变了必须检验的假设的性质。

从一个简单、优雅的假设到一个更细致、更现实的模型的旅程，正是统计科学的精髓。比例[优势模](@entry_id:263463)型提供了一个强有力的起点，而像 Brant 检验这样的工具则确保我们最终的结论不仅优雅，而且忠实于数据。

