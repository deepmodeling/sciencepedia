## 应用与跨学科联系

在探索了 t-SNE 和 UMAP 错综复杂的机制之后，我们现在来到了我们探索中最激动人心的部分：亲眼见证这些工具的实际应用。就像一台新发明的望远镜，一个强大的理论思想只有当我们将其指向宇宙并看到它揭示了什么时，才能被真正理解。我们讨论的原理不仅仅是抽象的数学；它们是促进发现的强大透镜，其光芒照耀着令人惊叹的科学学科谱系。它们使我们能够从数字表格转向复杂系统的直观可视化地图，将海量数据转化为人类可理解的洞察。

### 两种哲学的故事：局部邻域与全局景观

让我们首先回顾一下其中核心的哲学差异。想象你有一张巨大、褶皱的世界地图。我们之前提到的作为我们主角的更简单的线性近亲——[主成分分析](@entry_id:145395)（PCA），就像把这张地图熨平。它完美地保留了大尺度的关系——比如从欧洲到亚洲的大致方向——但这样做可能会压坏一个城市街道规划的精细细节。

t-SNE 和 UMAP 更像是试图用手解开这张褶皱地图的大师级档案员。它们非常关心局部细节。[t-SNE](@entry_id:276549) 在其最纯粹的形式下，痴迷于创建单个城市的完美地图。它确保相邻的街道仍然是邻居。但在其对局部的极度关注中，它可能会忽略更大的图景，把伦敦的地图放在东京地图旁边，仅仅因为它没有处理大陆板块的指令。UMAP 试图达成一个宏大的妥协。它也珍视局部邻域结构，但试图关注更大范围的[连接线](@entry_id:196944)索，力求在保持大陆板块正确相对位置的同时，仍然尊重其中城市的布局 [@problem_id:4004726]。这个根本性的差异——局部保真度与全局结构之间的权衡——是理解每种方法在何处以及为何能大放异彩的关键。

### 揭示生物学与医学中的隐藏秩序

这些可视化工具的影响在任何地方都没有比在现代生物学中更具革命性。我们生活在一个可以为组织样本中的每一个细胞测量成千上万个特征——基因、蛋白质、可及的 DNA 位点——的时代。由此产生的数据集不仅庞大；它们是天文数字般、难以理解的浩瀚。我们漂浮在数字的海洋中，而 UMAP 和 [t-SNE](@entry_id:276549) 已成为我们的六分仪和指南针。

#### 基因组学与细胞身份图谱

以[单细胞基因组学](@entry_id:274871)领域为例。一项实验可能会给我们一个包含数千个细胞和两万个基因的矩阵——一个在 20,000 维空间中的点云。我们的目标是了解那里有哪些类型的细胞以及它们之间的关系。它们是不同的类型，就像不同种类的鸟，还是一个[连续谱](@entry_id:155477)的一部分，就像蝌蚪发育成青蛙的各个阶段？

在我们开始绘制这个空间之前，我们必须首先清洁我们的镜头。原始基因计数受到技术性伪影的困扰。一个被更有效地捕获和测序的细胞在其所有基因上都会显得“更亮”，这是技术“音量”上的差异，而非生物学“内容”上的差异。直接将像 UMAP 这样的方法应用于这些原始数据将是一个错误；地图将被测序深度主导，而不是[细胞生物学](@entry_id:143618)。我们必须首先应用仔细的归一化，例如 $log(1+\text{CPM})$ 变换，以稳定方差，使所有细胞处于平等地位。这个关键的预处理步骤确保我们之后计算的距离反映的是相对基因表达中的真实生物学差异，而不是技术噪音 [@problem_id:5208977]。

数据准备好后，UMAP 尤其成为了首选工具。为什么？因为[生物过程](@entry_id:164026)通常涉及离散的细胞类型和连续的转变。例如，在分析肿瘤活检时，我们希望看到癌细胞和免疫细胞的清晰聚类。但我们也希望看到[干细胞分化](@entry_id:270116)为成熟癌细胞的连续轨迹。UMAP 平衡保留局部聚类与表示全局谱系路径的能力，使其在这项任务中异常强大。它可以生成一张既显示细胞类型的不同“城市”，又显示连接它们的“高速公路”的地图，这是 t-SNE 由于其倾向于断裂全局路径而难以实现的壮举 [@problem_id:4317360]。

#### 免疫学中追寻流氓细胞

这种绘制细胞景观的能力对医学具有深远的影响。考虑[白血病](@entry_id:152725)的诊断。病理学家传统上通过在蛋白质标记物的二维图上手动“圈选”（gating）来识别癌细胞。他们可能会查看标记物 CD19 与标记物 CD5 的图，画一个圈，然后用这些细胞去看 CD34 与 CD10 的图。

但如果癌细胞群与健康细胞仅有细微差别，这种差别是由十种不同标记物同时发生协调的、微小的变化所定义的呢？这样的细胞群在任何单一的二维投影中几乎都是不可见的，会与健康细胞无可救药地混合在一起 [@problem_id:5226110]。然而，像 UMAP 或 t-SNE 这样的算法，会在完整的高维空间中计算距离。它“看到”所有这些微小差异的总和，这些差异加起来会形成显著的分离。由此产生的二维图可以将癌细胞放置在一个独特的岛屿中，使它们立即对临床医生可见。这是一种计算视觉，超越了我们一次只能看两个标记物的视觉极限。

在寻找微小残留病（MRD）——那些在化疗后存活下来并可能导致复发的少量癌细胞——时，这一点变得更为关键。这些细胞可能只有十万分之一。此外，它们可能已经进化，改变了它们的标记物表达以逃避治疗。基于原始诊断表型的僵化圈选策略可能会完全错过它们。一种数据驱动的方法，使用 UMAP 可视化细胞景观，并用一种算法来发现健康组织中不存在的任何“异常”岛屿，就可以找到这些进化的敌人。这是一种基于检测“异常”而非“预期”的方法，是对抗不断变化的敌人的关键优势 [@problem_id:4408061]。

#### 神经科学：从形态到功能

绘制复杂类型的探索延伸到了大脑。神经元展现出令人眼花缭乱的各种形状和分支模式。如果我们用数十个特征——树突长度、分支点、曲折度——来量化这种形态，我们再次面临一个高维分类问题。我们何时使用哪种工具？答案取决于差异的性质。如果[神经元类型](@entry_id:185169)主要在粗略特征上有所不同，比如整体大小，这些是 PCA 可以很好捕捉的高方差特征，提供了一个简单、可解释的线性变化轴。但如果决定性的差异是微妙的、低方差的特征——比如树突上微小棘突的精细模式——PCA 可能会完全忽略它们。在这里，UMAP 和 t-SNE 的局部关注点变得至关重要，因为它们可以根据这些 PCA 会丢弃的细微差别来分离细胞类型 [@problem_id:4004726]。

我们不仅可以将这些工具应用于神经元的静态形态，还可以应用于它们放电的动态模式。神经群体的集体活动在（一个）高维[状态空间](@entry_id:160914)中描绘出一条轨迹。如果活动是周期性的，比如追踪头部方向的细胞放电，这条轨迹可能会形成一个圆。我们如何验证这种拓扑结构？我们可以将数据通过 UMAP 或 [t-SNE](@entry_id:276549) 运行，并希望看到一个圆。但是，虽然这些方法非常适合可视化和产生假设，但它们带有一个关键警告：它们不提供保留全局拓扑的理论保证。特别是 [t-SNE](@entry_id:276549)，可能会撕裂一个圆，或者在没有圆的地方创造一个。对于严谨的拓扑推断，必须转向具有更强数学基础的方法，例如直接在数据的高维原生空间中应用[持续同调](@entry_id:161156)，或者在使用像 Takens 定理这样的方法嵌入数据后应用，该定理保证保留[吸引子](@entry_id:270989)的拓扑结构 [@problem_id:3979630]。这是一个美好的提醒：一张漂亮的图片是探究的起点，而不是最终的证明。

### 超越生物学：新材料的蓝图

这些几何直觉的力量并不仅限于生命科学。其原理是普适的。想象你是一位正在设计一种新型[高熵合金](@entry_id:141320)的材料科学家。你可以用一个化学和物理性质的向量来描述任何潜在的合金：[价电子浓度](@entry_id:192529)、[原子尺寸](@entry_id:151650)失配、[混合焓](@entry_id:158999)等等。在这个高维的“化学空间”中，某些区域对应于会形成[理想晶体](@entry_id:138314)结构（例如，面心立方）的合金，而其他区域则形成不同的结构（体心立方）。

目标是发现这些区域。就像细胞一样，“化学相似性”的概念本质上是局部的。如果两种合金在这个[特征空间](@entry_id:638014)中很接近，它们就是相似的。因此，一种优先保留局部邻域结构的嵌入方法正是创建一张能将相似化学性质分组的地图所需要的。t-SNE 和 UMAP 都是为此目的而设计的，它们现在正被用来指导发现具有特定性能的新型材料，将特征空间的抽象几何转化为新合金的具体现实 [@problem_id:3741484]。

### 数据科学家的实用指南

鉴于这种能力和广度，一位从业科学家如何选择使用哪种工具？答案一如既往：这取决于目标。没有单一的“最佳”方法，只有一系列的权衡。

人们甚至可以形式化这种权衡。我们可以定义一个目标函数，它结合了全局结构保留的度量（如成对距离的相关性）和局部邻域保留的度量（如可信度）[@problem_id:3321486]。通过对这两个部分加权，我们可以表达我们的优先事项。可能没有单一的方法可以同时最大化两者。相反，我们找到了一组“[帕累托最优](@entry_id:636539)”解——一个最佳可能妥协的前沿。一种方法可能以牺牲一些全局连贯性为代价提供最佳的局部结构，而另一种方法则可能提供最佳的全局图景，但局部细节稍显凌乱。选择取决于你最想讲述数据故事的哪个方面 [@problem_id:3160622]。

最后，我们必须考虑现实世界的限制。研究论文中一张漂亮的 UMAP 图是一回事；部署在医院中的诊断工具是另一回事。方法之间一个关键的、实际的区别是处理新的、未见过的数据的能力。标准的 [t-SNE](@entry_id:276549) 嵌入是“直推式”的——它只为给定的特定数据点学习一个映射。它没有直接、内置的机制来将一个*新*点放置到现有地图上。另一方面，UMAP 和 PCA 是“归纳式”的——它们学习一个可以应用于新数据的显式变换。对于需要对新患者的组织进行分类的临床流程来说，这不是一个次要的细节；这是一个强制性要求。在一个可部署的癌症分级系统的正面比较中，UMAP 可能会被选择，而不是性能稍高的 t-SNE，正是因为它满足了这个基本的工程约束 [@problem_id:4330369]。

### 旅程继续

从单个细胞的内部宇宙到材料科学的前沿，在高维数据中寻找和可视化结构的能力是现代科学的一个统一主题。像 UMAP 和 [t-SNE](@entry_id:276549) 这样的工具不仅仅是制作引人注目图形的算法。它们是直觉的工具。它们让我们作为科学家，能够以一种视觉化的、几乎是触觉的方式与我们的数据互动，构建关于复杂系统的假设，而这些假设是无法仅从电子表格和统计数据中形成的。它们是连接原始测量数据洪流与真正理解火花之间的桥梁，它们帮助我们创建的地图正在为未来无数的发现照亮道路。