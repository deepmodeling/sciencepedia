## 应用与跨学科联系

在探索了驱动科学领域机器学习的原理和机制之后，我们可能感觉自己刚刚学会了一门新语言的语法。但语言不仅仅是为了语法；它是为了讲述故事，构建世界，连接思想。所以现在，我们踏上征途，去看看这门新语言的实际应用。我们将见证这些抽象算法如何成为科学家手中的强大工具，改变药物发现的实践本身。我们的旅程将从原子尺度开始，在那里我们逐个原子地设计分子；然后转向一项多年研究计划的宏大战略；最后，探讨在自动化发现时代中关于信任、伦理和功劳的非常人性化的问题。我希望您能看到，这不仅仅是应用的集合，更是科学内在统一性的优美例证，其中物理、化学、生物学，乃至经济学和伦理学，都通过计算的丝线被编织在一起。

### 分子构建的艺术

从本质上讲，药物发现是一项构建的挑战。目标是设计和建造一个微小、复杂的分子结构，使其能完美地嵌入一个生物锁——即蛋白质靶点——以开启或关闭它。几个世纪以来，这是一个充满艰辛的试错过程。但如果我们能教会机器化学的基本规则和分子设计的美学呢？

最激动人心的前沿之一是*从头*设计（*de novo* design）——从零开始创造全新的分子。现代[生成模型](@entry_id:177561)，特别是被称为**[扩散模型](@entry_id:142185)**（diffusion models）的一类模型，在这一领域展现了惊人的前景。想象一下，从空间中一团随机、不相连的原子云开始。模型随后学习一个“[去噪](@entry_id:165626)”过程，在基本物理定律的引导下，一步步地将这些混乱的组合拉到一起，直到一个有效、稳定且新颖的分子从迷雾中凝聚而成 [@problem_id:4333012]。这里真正的美妙之处在于这些模型能够与物理学深度融合。我们知道，无论你如何在空间中定向一个物体，物理定律都是相同的。一个分[子模](@entry_id:148922)型必须尊重这一点。因此，这些生成模型被构建为**SE(3)等变**（SE(3)-equivariant）的，这是一个花哨的术语，背后却是一个简单而深刻的思想：如果你旋转输入的原子坐标，模型的向量式输出（如作用在原子上的力）会以完全相同的方式旋转。模型不仅仅是学习模式，它是在学习我们宇宙的一个[基本对称性](@entry_id:161256)。

当然，设计分子只是成功的一半。我们还必须预测它的行为。它会与我们的靶蛋白结合吗？这是基于结构的设计领域。在这里，机器学习模型借鉴了自然语言处理领域的思想，正在学习“阅读”[分子相互作用](@entry_id:263767)的语言。一种名为**[交叉注意力](@entry_id:634444)机制**（cross-attention mechanism）的模型架构，因其在 ChatGPT 等系统中的作用而闻名，可以被应用于此问题 [@problem_id:4332987]。模型不是去判断句子中哪些词彼此最相关，而是确定药物分子的哪些原子正在与蛋白质口袋的哪些氨基酸残基“对话”。同样，物理学提供了必要的护栏。必须教会模型，相互作用是局部的，其强度取决于距离和特定方向，并且最终的结合预测必须与我们如何看待整个复合物在空间中的朝向无关——这就是**$E(3)$不变性**（$E(3)$ invariance）的原则。

为了做出这些预测，模型需要数据。但需要什么样的数据？这引出了一个连接机器学习和量子化学的迷人选择 [@problem_id:4332992]。我们可以在来自快速、近似的“经典力场”的数据上训练模型，或者使用来自更准确但计算成本高昂的量子力学计算的数据。一种特别优雅的方法是训练一个模型来预测分子构象的势能，一个单一的标量值，$E(\mathbf{R})$。从这个能量函数出发，每个原子上的力——即控制运动的向量——可以通过简单地取负梯度得到，即 $\mathbf{F}(\mathbf{R}) = -\nabla_{\mathbf{R}} E(\mathbf{R})$。这样做的一个奇妙结果是，得到的力场保证是*保守的*（其旋度为零）。这意味着使用这些力进行的模拟将自动遵守能量守恒这一定律，这是物理学的基本定律，而无需我们另外强制执行。模型通过其自身的构造，不仅学会了模仿数据，还学会了遵守一个深刻的物理原理。

### 化学迷宫的指南针

所有可能的类药分子的空间是惊人地巨大，远超宇宙中的[原子数](@entry_id:746561)量。探索这个“化学空间”就像在一个巨大、黑暗的迷宫中导航。盲目搜索是毫无希望的。我们需要一个策略，一个指南针来引导我们寻找隐藏的宝藏。

这就是**[主动学习](@entry_id:157812)**（active learning）发挥作用的地方。它解决了每个科学家都面临的一个基本困境：**[探索-利用权衡](@entry_id:147557)**（exploration-exploitation trade-off） [@problem_id:4332952]。假设你刚刚发现一个有前景的化合物。你是应该花费有限的资源来制造和测试相似的分子，希望能得到一个稍好一些的（利用）？还是测试一些完全不同的东西，冒险进入化学空间的未知区域，那里可能隐藏着突破性的发现（探索）？一个聪明的机器学习模型不仅给出预测；如果它是一个概率模型，比如[贝叶斯神经网络](@entry_id:746725)，它还会提供一个对其自身*不确定性*的度量。它不仅告诉你它的想法，还告诉你它有多自信。然后可以设计一个“[采集函数](@entry_id:168889)”来结合这两部分信息。例如，**上置信界（UCB）** 策略说：“让我们乐观一点，测试具有最高*可能*活性的化合物”，这里的可能性由平均预测值加上一个不确定性的度量来定义。另一种策略，**[期望提升](@entry_id:749168)（EI）**，计算一个新实验平均预期能比迄今为止发现的最佳结果改进多少。两者都优雅地平衡了利用已知好结果的愿望与减少未知领域无知的需求，从而使实验过程的效率大大提高。

我们甚至可以放眼全局，通过强化学习的视角来看待整个[药物发现](@entry_id:261243)项目 [@problem_id:2446453]。想象整个项目是一场游戏。游戏的“状态”是我们当前的知识库——已经测试了哪些化合物以及结果如何。一个“行动”是选择下一个要合成和测试的化合物。目标是设计一个策略——一个选择行动的策略——在长期内最大化总预期回报（例如，成功发现的药物），并通过一个折扣因子来考虑成本和货币的时间价值。解决此类问题的数学框架是**[马尔可夫决策过程](@entry_id:140981)（MDP）**，[最优策略](@entry_id:138495)可以使用**价值函数迭代**等算法找到。这为在不确定性面前做出理性的、序贯的决策提供了一个有原则的、自上而下的框架，将研究策略的艺术转变为一门科学。

### 生物学巴别塔的罗塞塔石碑

现代生物学使用多种语言。患者的状况由临床症状的语言、其遗传密码（组学）的语言以及我们用于治疗他们的化学物质的语言来描述。要实现真正的个性化医疗，我们必须学会翻译这些语言并将它们整合成一个连贯的整体。

机器学习为这一宏大综合提供了工具。考虑这样一个挑战：预测一名患者是否会对特定药物产生反应。我们可能拥有来自三种不同模态的数据：患者的基因组图谱（$X_o$）、药物的化学结构（$X_c$）以及他们的临床特征（$X_{cl}$） [@problem_id:5173741]。我们如何将它们结合起来？我们可以使用**早期融合**（early fusion），从一开始就将所有原始数据混合在一起。或者我们可以使用**晚期融合**（late fusion），为每种数据类型建立一个独立的预测模型，然后让它们对最终结果进行“投票”。一种更复杂的方法是**中期融合**（intermediate fusion），即系统在组合各种模态之前，首先学习从每种模态中提取最有用的“表示”。这类似于一个专家团队——一个遗传学家、一个化学家和一个临床医生——在召开联席会议做出共同决定之前，各自总结自己的发现。这种多模态方法不仅更强大，而且更稳健，尤其是在现实世界中数据常常杂乱且不完整的情况下。例如，一个晚期融合模型可以通过简单地依赖其他两位“专家”的输出来优雅地处理某位患者缺失的基因组测试数据。

除了原始的患者数据，科学界还以生物医学**知识图谱**的形式积累了大量已确立的知识。这些是巨大的网络，将药物、基因、蛋白质和疾病等实体与“治疗”、“与……相关”和“结合”等关系连接起来。[机器学习模型](@entry_id:262335)可以被训练来“阅读”这个网络，为每个实体学习一个嵌入向量，以捕捉其在生物知识网络中的上下文 [@problem_id:4333001]。然后可以使用一种称为**[多任务学习](@entry_id:634517)**（multi-task learning）的强大技术。模型被训练来同时执行两个任务：（1）预测化合物对靶标的生物活性，以及（2）预测知识图谱中缺失的链接。通过在这些任务之间共享参数，模型被迫学习与特定实验数据和整个既定科学知识体系都一致的蛋白质和化合物的表示。这就像一个学生不仅从自己的实验工作中学习，还通过阅读图书馆里的每一本教科书来学习。

### 机器的良知

随着这些人工智能系统变得越来越强大和自主，我们必须面对一些新的、深刻的问题。我们如何能信任一个“黑箱”的预测？我们如何确保它们被合乎伦理地使用？在一个发现是人与机器合作的世界里，谁应该获得功劳？

**[可解释性](@entry_id:637759)人工智能（[XAI](@entry_id:168774)）** 领域旨在打开这个黑箱。对于化学家来说，模型预测一个分子没有活性是不够的。他们需要知道*为什么*，这样才能改进它。一种优美的方法是寻找**反事实解释**（counterfactual explanations） [@problem_id:5173727]。问题是这样提出的：“我能对这个非活性分子做出什么最小的、化学上现实的改变，来使模型的预测翻转为活性？”答案不仅仅是一个抽象的解释；它是下一个合成周期的具体、可操作的建议。至关重要的是，对这些反事实的搜索必须受到化学现实的约束，确保建议的分子不仅在理论上更优，而且稳定且可合成。

除了解释单个预测，我们还需要为整个科学过程建立一个信任体系。机器学习的灵活性可能是一把双刃剑，会造成统计学家所说的“研究者自由度”——在数据处理、模型设计和分析中的许多选择，如果被滥用，可能导致虚假的发现。为了应对这一点，科学界正在采纳与科学伦理密切相关的透明度实践 [@problem_id:4439817]。**模型卡片**（Model Cards）充当人工智能模型的用户手册，记录其预期用途、性能和局限性。**数据集说明书**（Datasheets for Datasets）就像数据的营养标签，详细说明其来源、收集方法和潜在偏见。而**试验预注册**（trial preregistration）是医学界的一项长期实践，它要求在实验开始前公开为研究计划打上时间戳。这些实践[共同限制](@entry_id:180776)了“分叉路径的花园”，降低了$p$值操纵（$p$-hacking）的风险，使报告的结果更加可信。这直接服务于**善行**（产生可靠知识）、**公正**（确保模型在各子群体中是公平的）和**尊重个人**（尊重数据来源和同意）的伦理原则。

最后，当人工智能成为发现过程中的真正伙伴时，我们该如何分配功劳？如果发现了一个新的生物标志物，谁是发明人：整理数据集的策展人、构建模型的工程师，还是通过实验验证发现的实验科学家？在这里，我们可以求助于合作博弈论的优雅数学。**夏普利值**（Shapley value）是一个源于经济学的概念，它提供了一种可证明的公平方式，根据每个参与者对所有可能子联盟的边际贡献，来分配合作博弈的收益给其参与者 [@problem_id:4428000]。通过将发明创造建模为一场游戏，我们可以朝着一个有原则的框架迈进，用于在这个人机协作的新时代分配功劳，从而连接人工智能、法律和经济学的世界。

从量子泡沫到法庭，机器学习不仅在加速药物发现，更是在重塑它，创造一个更丰富、更整合、更有深刻原则的科学事业。而这段旅程才刚刚开始。