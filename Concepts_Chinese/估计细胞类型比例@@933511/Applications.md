## 应用与跨学科联系

既然我们已经探讨了如何通过计算窥探生物样本内部的原理，那么让我们来问一个最重要的问题：这有什么用？开发一个巧妙的数学工具是一回事，但让这个工具为世界打开新的窗口又是另一回事。正如我们将看到的，估计细胞类型比例不仅仅是数据处理中的一个技术练习；它是我们看待和解释生物数据方式的根本转变。它是一副眼镜，矫正了几乎困扰所有现代生物学的一种普遍存在的误导性幻觉。

想象你有一个组织样本——一小块肿瘤，一滴血，一片脑组织。多年来，分析它的标准方法实际上是把它放进搅拌机里。我们会把它磨碎，提取所有的分子——比如所有的 RNA——并测量每种分子的平均含量。结果是一个“整体”测量值。这就像通过查看最终的营养成分来分析一杯水果冰沙。你可能会发现它富含维生素 C 和糖。但你能分辨出这是因为它由 90% 的橙子和 10% 的菠菜制成，还是 50% 的橙子和 50% 的草莓制成吗？比例很重要。

在生物学中，这并非小事。健康的肝脏和患病的肝脏之间的区别，或者对治疗有反应的肿瘤和抗药的肿瘤之间的区别，往往是一个关于细胞角色阵容变化的故事。问题是，我们的整体测量是一个混合物，是所有存在的细胞类型信号的加权平均值。我们的任务就是解开它。

### 数字病理学家：从混合物到地图

我们新工具最直接的应用是充当“数字病理学家”。病理学家花费数年时间训练，以便在显微镜下识别组织切片中不同细胞的形状和排列。我们的计算方法做了类似的事情。我们取整体基因表达向量，即我们的混合信号 $y$，以及一个纯细胞类型特征的参考“词典”，即我们的矩阵 $S$。目标是找到比例向量 $p$，以解决 $y \approx Sp$ 这个谜题。

当然，现实并非一个纯粹的数学方程。当我们的词典有点模糊时——当两种细胞类型具有非常相似的基因表达特征时会发生什么？我们的方法可能难以区分它们，这是一个称为[共线性](@entry_id:270224)的挑战 [@problem_id:4574619]。如果我们的组织样本包含一个意想不到的客人，一种不在我们参考词典中的细胞类型，会怎样？我们的模型将无法解释整个信号，我们会留下一个大的、结构化的“残差”——模型未能重建的那部分信号。但这就是一个好科学模型的美妙之处！这种失败不是方法的失败，而是一个新的发现。残差是一个路标，指向了需要进一步研究的新的、未被解释的现象 [@problem_id:2967180]。

这个过程为我们的生物样本提供了一份“零件清单”。对于肿瘤活检，我们可以估计[癌变](@entry_id:166361)组织、浸润的免疫细胞和支持性基质组织各占多少比例。这些信息本身就具有巨大的临床价值。它可以是一个强有力的预后指标，我们甚至可以用真正的病理学家训练有素的眼睛来验证我们的计算估计，从而将数字世界与物理世界连接起来，形成一个闭环 [@problem_id:4382154]。在[空间转录组学](@entry_id:270096)领域，我们从组织切片上的微小斑点获得测量值，我们可以将此逻辑应用于每一个斑点。结果是一张完整的、具有空间分辨率的细胞群落地图，一本名副其实的[组织结构图谱](@entry_id:756018)，完全由计算构建 [@problem_id:4382207]。

### 混杂的交响曲：校正生物学的曲调

故事从这里开始变得真正有趣。我们估计的细胞类型比例不仅仅是最终答案。更多时候，它们是回答另一个更深层次问题的关键。

让我们想象一个交响乐团。你坐在观众席上，想知道小提琴手是否在更卖力地演奏他们的部分。一个天真的测量方法是使用麦克风记录舞台上声音的总音量。现在，假设在第一幕和第二幕之间，又有十个小提琴手走上舞台。小提琴的声音会变得响亮得多！但这是否意味着任何单个小提琴手都在更卖力地演奏？完全不是。你的测量被乐团*组成*的变化所混杂。

这种幻觉在生物学中 постоянно发生。一位科学家比较了健康结肠和发炎结肠的整体基因表达。她发现基因 X 在发炎组织中“响亮”得多。直接的结论可能是疾病导致结[肠细胞](@entry_id:149717)“开启”了基因 X。但炎症过程本身会带来大量免疫细胞涌入组织。如果基因 X 只是一个在免疫细胞中一直开启，而在结[肠细胞](@entry_id:149717)中沉默的基因呢？观察到的基因 X 的增加可能*完全*是由于细胞组成的变化，而任何单个细胞内部都没有发生任何变化。基因并没有被开启；只是更多拥有该基因的细胞加入了这场派对 [@problem_id:4373706]。

这就是混杂问题，它是现代生物医学研究中错误和误解最重要的来源之一。但我们并非无助！一旦我们估计了每个样本的细胞类型比例，我们就可以利用统计回归的力量来纠正这种幻觉。我们可以建立一个模型，表示为：

$$
y_s = \beta_{\text{disease}} d_s + \sum_{i=1}^{K} \gamma_i p_{s,i} + \varepsilon_s
$$

在这里，我们将样本 $s$ 中观察到的表达量 $y_s$ 建模为其疾病状态 $d_s$ *和* 其细胞类型比例 $p_{s,i}$ 的函数。回归过程具有能够解开这些效应的奇妙特性。它估计系数 $\beta_{\text{disease}}$——“真实”的疾病效应——同时解释了来自比例的那部分信号。这在数学上等同于能够听到单个小提琴手的演奏，即使管弦乐队的其余部分在他们周围变化。同样强大的逻辑使我们能够在其他分子数据（如 DNA 甲基化）中找到与疾病相关的真实变化，通过将它们与纯粹的细胞组成伪影区分开来 [@problem_id:4334614]。

有趣的是，试图天真地这样做会陷入一个美妙的统计陷阱。因为比例必须总和为一，将所有比例以及一个截距项都包含在模型中会产生一个完美的线性依赖——完美的[多重共线性](@entry_id:141597)——这使得方程无解。优雅的解决方案是简单地将一种细胞类型从模型中排除，将其视为基线参考。这是一个绝佳的提醒，即深刻理解底层数学并非深奥的奢侈品；它是清晰看世界的必备工具 [@problem_id:4373706] [@problem_id:5088422]。

### 超越简单差异：编织[生物网络](@entry_id:267733)

校正组成的原则不仅限于比较两组。许多科学家希望通过构建一个相互作用的“网络”来理解整个系统。例如，如果基因 A 的活性在许多样本中与基因 B 的活性一致地上升和下降，我们可能会推断它们是同一生物回路的一部分。

但在这里，混杂的交响曲再次可能捉弄我们。想象一下，基因 A 是 T 细胞的特异性标记，基因 B 是 B 细胞的标记。在一组患者中，那些拥有更多 T 细胞的人可能拥有更少的 B 细胞，反之亦然。对整体数据的天真分析会揭示基因 A 和基因 B 的表达之间存在强烈的负相关。你可能会忍不住在你的网络图上画一条边，得出基因 A 抑制基因 B 的结论。但这种相互作用可能完全是一个幽灵，一个由两种细胞类型比例变化造成的幻觉，与它们的分子实际相互作用毫无关系 [@problem_id:2956864]。

解决方案非常优雅。对于每个基因，我们首先执行上一节描述的回归来计算残差——每个基因表达中*未被*细胞组成解释的部分。这些残差代表了一个“组成校正后”的表达值。当我们计算*这些残差*之间的相关性时，我们正在寻找在剥离了混杂幻觉*之后*仍然存在的关系。我们可以更加确信我们构建的网络反映了真实的、底层的细胞机制。

### 跨界桥梁：单细胞与整体数据的对话

最后，[反卷积](@entry_id:141233)在两种关键技术之间提供了一座强大的桥梁：整体测序和单细胞测序。整体测序相对便宜，并且已在数百万个存档样本上进行，创造了一个生物学和临床数据的宝库。单细胞测序更新、更昂贵，但为我们提供了对单个细胞的极其高分辨率的视图。我们如何让它们相互对话？

[反卷积](@entry_id:141233)是对话的开启者。单细胞数据提供了我们需要解释大量整体数据档案的高质量参考特征——“罗塞塔石碑”。一个绝佳的例子来自[疫苗学](@entry_id:194147)领域 [@problem_id:2892887]。接种疫苗后，身体的反应涉及两种变化：不同免疫细胞数量的变动（组成变化）和这些细胞内部遗传程序的变化（内在变化）。整体数据将这两种信号混合在一起。通过使用来自配对的单细胞数据的参考，我们可以[反卷积](@entry_id:141233)整体信号并提问：这个人对疫苗的强烈反应主要是因为他们产生了更多分泌抗体的细胞，还是因为他们的每个细胞都变成了更高效的抗体工厂？

还有更复杂的方法来实现这种联合。我们不是采用两步法，而是可以建立一个单一、统一的贝叶斯[统计模型](@entry_id:755400)，该模型假定细胞比例和内在谱具有一个共同的潜在现实。然后，我们要求这个模型找到能够最好地同时解释*单细胞数据*和*整体数据*的参数。这种“联合[生成模型](@entry_id:177561)”确保我们所有的结论在内部都是一致的，并代表了两种数据类型真正深刻的和解 [@problem_id:2892887] [@problem_id:4382241]。

从充当数字病理学家到纠正深刻的统计幻觉，再到连接整个技术领域，估计细胞类型比例远不止一个简单的数据处理步骤。它是一个根本性的透镜，让我们能够以前所未有的清晰度看待复杂、多细胞的生物世界，揭示生命比例中优美而错综复杂的舞蹈。