## 引言
理解纳米尺度上[电荷](@article_id:339187)、自旋和热量的流动是现代物理学和工程学的基石。尽管处于[热平衡](@article_id:318390)状态的系统的物理学已经相当成熟，但当系统被主动驱动时，例如对一个分子晶体管施加电压，这些描述就不再适用。这种非[平衡条件](@article_id:351912)需要一种根本不同的理论方法，一种能够处理远离静止状态的粒子的复杂动力学的方法。[非平衡格林函数](@article_id:380561) (NEGF) 形式理论恰好提供了这样一个强大而通用的框架。本文将揭开 NEGF 的神秘面纱，首先探讨其核心原理和机制，从折叠时间围道的奇特概念到[自能](@article_id:306032)在描述相互作用中的作用。随后，本文将综述 NEGF 的广泛应用和令人惊讶的跨学科联系，展示它如何统一描述[纳米电子学](@article_id:354237)、自旋电子学及其他领域的[输运现象](@article_id:308069)。

## 原理与机制

### 量子二步舞：为何时间必须有去有回

想象一下，你想给一个量子系统拍张快照。在我们的日常世界里，这很简单：你拿起相机，按下快门。那一瞬间世界的状态就是你所得到的。但在量子世界里，“看”这个行为本身就是故事的一部分，为了讲述完整的故事，你不仅要描述如何到达观测的那一刻，还必须描述如何从那一刻返回。

让我们说得更精确一些。某个物理量（比如电子的位置 $\mathcal{O}$）在时间 $t$ 的平均值——即“[期望值](@article_id:313620)”——是通过一个类似这样的公式计算的：
$$
\langle \mathcal{O}(t) \rangle = \mathrm{Tr}\{\hat{\rho}_0 \hat{U}^{\dagger}(t) \hat{\mathcal{O}} \hat{U}(t)\}
$$
别太在意这些符号。我们把这个公式翻译成一个故事。我们从系统在零时刻的某个初始状态开始，这个状态由[密度矩阵](@article_id:300338) $\hat{\rho}_0$ 描述。为了看到在时间 $t$ 发生了什么，我们首先让系统*正向*演化到时间 $t$，这是由算符 $\hat{U}(t)$ 完成的。然后，在时间 $t$，我们进行观测，由算符 $\hat{\mathcal{O}}$ 表示。但是，量子力学计算平均值的规则并未就此结束。为了完成这个数学表达式，我们必须形式上用算符 $\hat{U}^{\dagger}(t)$ 让系统*反向*演化回初始时刻。这是一次“有去有回”的旅程，一曲量子二步舞。

这种正向和反向的演化对我们通常的计算工具构成了严重问题，因为这些工具大多是为处于热平衡宁静态中的系统构建的。对于那些系统，时间只向前行进。但是，当我们把一个系统驱离[平衡态](@article_id:347397)时——比如说，把一个分子连接到电池上——这种时间上的“前向-后向”结构是不可避免的。我们需要一张新的地图，一种新的记录时间的方式。

这张地图就是被称为**Keldysh 围道**的巧妙发明 [@problem_id:2790669]。想象一下，时间不再是一条简单的直线，而是一条从遥远的过去开始，沿着实时间轴前进到遥远的未来，然后掉头，一直跑回起点的路径。这个闭合的环路就是我们的新时间线。我们量子故事的“正向”部分，由 $\hat{U}(t)$ 控制，发生在围道的正向分支上。而“反向”部分，由 $\hat{U}^{\dagger}(t)$ 控制，则发生在反向分支上。通过沿着这条奇特的折叠时间线对事件进行排序，我们可以构建一个令人惊叹的优雅理论，适用于任何非平衡情况。在某些情况下，为了恰当考虑一个初始状态就很热的系统中的初始关联，我们甚至在[虚时间](@article_id:299075)平面上增加一个小的垂直绕行，这是对平衡物理学中强大的 Matsubara 形式理论的致敬 [@problem_id:2997968]。

### 不仅仅是“何时”：格林函数的多种“风味”

现在我们有了特殊的时间线，可以介绍我们故事的主角了：**格林函数**。简单来说，格林函数 $G(t_1, t_2)$ 是一个数学对象，它回答了这样一个问题：“如果我在时间 $t_2$ 向系统中添加一个电子，在稍后的时间 $t_1$ 仍然能找到它的[概率幅](@article_id:311027)是多少？”它告诉我们粒子如何在系统中传播。

Keldysh 方法的魔力在于，通过将“产生”时间 $t_2$ 和“湮灭”时间 $t_1$ 放在围道的不同部分，一个单一的围道序格林函数就优雅地分裂成一个包含四个相关但又截然不同的物理量的家族：

*   **推迟 ($G^R$) 和超前 ($G^A$) [格林函数](@article_id:308216)**：它们描述了粒子传播的*可能*方式。它们由系统的内禀性质决定，比如可用的能级和[量子态](@article_id:306563)。你可以把它们想象成系统的路线图——它们展示了电子*可以*走的所有的公路和小径。它们包含了所有的谱信息，告诉你共振（能级）在哪里。

*   **小 ($G^$) 和大 ($G^>$) 格林函数**：它们描述了那些公路上*实际*的交通状况。[小格林函数](@article_id:301981) $G^$ 与电子的数密度有关——它告诉你哪些路径实际上被占据了。类似地，[大格林函数](@article_id:302577) $G^>$ 则追踪“空”态，即空穴。这些函数包含了所有的分布信息。

这种将“有哪些路”($G^R, G^A$) 与“路上有谁”($G^, G^>$) 分开的方法，是理解[非平衡现象](@article_id:377273)的绝对关键。在处于[热平衡](@article_id:318390)的系统中，事情很简单。交通分布是固定且已知的——就是我们熟悉的 Fermi-Dirac 分布。在这种情况下，“路”和“交通”之间存在一种直接而优美的关系，这一原理被称为**涨落-耗散定理**。它指出，[小格林函数](@article_id:301981)和[大格林函数](@article_id:302577)可以直接由推迟和超前[格林函数](@article_id:308216)确定 [@problem_id:212274] [@problem_id:1196548]。但是当我们施加电压时，交通就乱了套。来自左右电极的电子以不同的能量分布涌入系统。简单的平衡关系被打破，我们必须独立地追踪谱性质和粒子分布。Keldysh 形式理论恰好为我们提供了这样做的工具。

### 量子流水线：Dyson 方程和自能

那么，我们如何为一个复杂的相互作用系统找到这些[格林函数](@article_id:308216)呢？答案在于另一个深邃的概念：**Dyson 方程**。我们来打个比方。想象一个粒子试图穿过一个拥挤的房间。它的旅程由完整的[格林函数](@article_id:308216) $G$ 描述。如果房间是空的，它会沿直线行进；这段无阻碍的旅程由“无相互作用”的[格林函数](@article_id:308216) $g$ 描述。

但房间并非空无一人。粒子可能会撞上东西——其他电子、[振动](@article_id:331484)的原子等等。我们可以把所有这些可能的碰撞和相互作用的影响打包成一个单一的对象，称为**[自能](@article_id:306032)** $\Sigma$。Dyson 方程以一种优美、[自指](@article_id:349641)的方式将这三个量联系起来：
$$
G = g + g \Sigma G
$$
用语言描述就是：完整的旅程 ($G$) 要么是一条直接的路径 ($g$)，要么是一条包含了一段到碰撞点的直接旅程 ($g\Sigma$)，然后是从该点开始的*完整*旅程 ($G$) 的路径。这个方程巧妙地将无穷级数的可能散射事件归纳成一个紧凑的表达式。

当我们用 Keldysh 形式理论的矩阵语言来写这个方程时，它变得异常强大。[格林函数](@article_id:308216)和[自能](@article_id:306032)都变成了 $2 \times 2$ 的矩阵，Dyson 方程对这些矩阵本身也成立。从这个[矩阵方程](@article_id:382321)中，可以得出一个非常简单且物理图像清晰的结果 [@problem_id:1191281]：
$$
G^(E) = G^R(E) \Sigma^(E) G^A(E)
$$
让我们把这个公式从数学语言翻译成物理语言。我们系统中能量为 $E$ 的电子数量 ($G^$)，由该能量下[电子注入](@article_id:334642)系统的速率 ($\Sigma^$) 决定，注入后通过系统传播到观测点（由 $G^R$ 和 $G^A$ 描述）。这是[量子输运](@article_id:299380)的核心方程，一条名副其实的量子[流水线](@article_id:346477)。[自能](@article_id:306032) $\Sigma^$ 是零件（电子）的来源，而推迟和超前[格林函数](@article_id:308216)则是运送它们的传送带。

### 打开[闸门](@article_id:331694)：模拟真实器件

有了这套机制，我们就可以构建一个真实的器件，比如一个夹在两个金属电极——左 (L) 和右 (R)——之间的单个分子。金属电极中浩如烟海的电子是电流的最终源头和汇集处。它们对我们中心分子的全部影响都被提炼到了[自能](@article_id:306032) $\Sigma = \Sigma_L + \Sigma_R$ 中。

那么，电池是如何体现的呢？施加的电压 $V$ 在两个电极的化学势之间设定了一个差值，$\mu_L - \mu_R = eV$。这个差值决定了每个电极试图注入分子的电子的能量分布。这个信息正是通过小[自能](@article_id:306032)和 大[自能](@article_id:306032)进入我们的形式理论的 [@problem_id:2790658]。例如，来自左电极的小[自能](@article_id:306032)形式为 $\Sigma_L^(E) = i f_L(E) \Gamma_L(E)$。这里，$f_L(E)$ 是左电极的 Fermi-Dirac 分布，由 $\mu_L$ 表征。它像一个阀门，控制着能量为 $E$ 的电子流。“展宽”项 $\Gamma_L(E)$ 衡量了分子与电极连接的强度。连接的谱性质，包含在推迟自能 $\Sigma_L^R(E)$ 中，不受电压影响；它们只关心电极和分子之间的物理键合。

把所有这些放在一起，我们就可以计算电流。使用 Meir-Wingreen 公式——我们形式理论的直接推论——我们发现电流由能量的积分给出。这个积分就是著名的**Landauer 公式**。它告诉我们，电流是三样东西的乘积：
1. 在给定能量下，电子可供穿行的通道或“行车线”的数量。
2. 电子从一端成功到达另一端的量子力学[透射概率](@article_id:298392) $\mathcal{T}(E)$。
3. 电流的“驱动力”，即左右电极态占据数的差异，$[f_L(E) - f_R(E)]$。

值得注意的是，NEGF 形式理论为我们提供了一个精确的、微观的[透射概率](@article_id:298392)计算公式：$\mathcal{T}(E) = \mathrm{Tr}\{\Gamma_L G^R \Gamma_R G^A\}$ [@problem_id:2999593]。这直接将抽象的格林函数与一个直观的物理量联系起来。为了建立信心，人们可以将这套复杂的机制应用于最简单的情况：一根完美的一维导线。计算得出的[电导](@article_id:325643)恰好为 $G = \frac{2e^2}{h}$，即著名的[量子电导](@article_id:379665)，与从更简单、更直观的模型得到的结果完全吻合。NEGF 的强大之处在于，它不仅能重现这些理想化的结果，更能让我们走得更远。

### 真实世界是复杂的：相互作用、自洽性和[退相干](@article_id:305582)

世界并非由无相互作用的电子构成。它们相互排斥，在经过时还会使分子中的原子[振动](@article_id:331484)。NEGF 形式理论能够以惊人的优雅来处理这种复杂性。

首先，考虑电子间的静电排斥。电子的分布会产生一个[静电势](@article_id:367497)（“Hartree”势）。这个势反过来又改变了其他电子必须穿行的环境，从而改变了它们的分布。这个“鸡生蛋还是蛋生鸡”的问题通过**[自洽循环](@article_id:298607)**得以解决 [@problem_id:2790673]。我们从一个猜测的电子密度开始，计算出电势，然后用 NEGF 找出电子在这个电势中如何重新[排列](@article_id:296886)，从而得到一个新的密度。我们将这个新密度反馈回去，重复这个循环，直到密度和电势不再改变——直到“演员”（电子）和“舞台”（势）达到一种和谐的自洽状态。这是像 NEGF-DFT 这样强大的模拟方法的核心。

当我们包含相互作用时，必须小心。近似是不可避免的，一个糟糕的近似可能导致荒谬的结果，比如[电荷](@article_id:339187)无中生有或凭空消失。**Ward 恒等式**是数学上的守护者，确保我们的近似遵守[电荷守恒](@article_id:312253)的基本定律 [@problem_id:2790639]。它们强加了一种深层的自洽性：如果你用一个[自能](@article_id:306032) $\Sigma$ 来修正[格林函数](@article_id:308216)以考虑相互作用，你也必须以相应的方式修正你定义电流的方式。这是该理论内部[逻辑一致性](@article_id:642159)的一个优美陈述。

最后，关于非弹性过程，比如电子通过踢一个[分子振动](@article_id:301270)而损失一点能量，该如何处理？这会破坏电子的量子[相位相干性](@article_id:303026)。我们可以用一个非常巧妙的技巧来模拟这个复杂的耗散过程：**Büttiker 探针** [@problem_id:2790688]。我们想象在我们的分子上连接一个虚拟终端——这个探针。该探针充当一个可以吸收和重新发射电子的库。然后我们施加一个关键条件：流入探针的净电流必须为零。探针接收一个电子，打乱其相位和能量，然后将其吐回。它扮演了一个产生熵的散射体的角色，模拟了退相干，同时严格地保持了总电荷守恒。将如此复杂的物理过程如此优雅地融入一个相干量子框架中，证明了格林函数方法的灵活性和天才之处。