## 应用与跨学科联系

在我们了解了对称[秩一更新](@article_id:297994)的原理之后，你可能会产生一个奇怪的想法。我们已经看到 SR1 公式非常简洁，它诞生于用最小的秩一变化来满足[割线条件](@article_id:344282)的纯粹愿望。但我们也看到了它狂野的一面：它可能失去[正定性](@article_id:357428)，其分母可能为零，导致更新飞向无穷大。与始终可靠、保持[正定性](@article_id:357428)的 BFGS 更新相比，SR1 似乎是一个优美但有缺陷的想法。

所以，问题是，何必费心呢？SR1 仅仅是一个课堂上的奇思妙想，还是在科学计算的现实世界中占有一席之地？事实证明，答案是响亮的“是”。SR1 应用的故事是一个美丽的教训，告诉我们一个被认为是弱点的东西如何能成为一种深远的优势。这个故事关乎为工作选择正确的工具，也关乎科学中最有趣的问题往往不是那些简单、光滑的碗状问题。

### 驯服野马：打造稳健[算法](@article_id:331821)

在我们能将 SR1 应用于世界之前，我们必须首先学会驾驭它。它的狂野来自于那个分母，$(y_k - B_k s_k)^T s_k$。如果这个值接近于零，更新就会变得数值不稳定。因此，第一条智慧就是知道何时*不*更新。一个简单而有效的策略是，如果分母相对于所涉及[向量的范数](@article_id:315294)来说太小，就“跳过”更新 [@problem_id:2224550]。我们只是说，“我从这一步得到的信息不可靠或相互矛盾”，然后我们保留当前的世界地图，设置 $B_{k+1} = B_k$。这可以防止[算法](@article_id:331821)基于错误信息采取灾难性的跳跃 [@problem_id:2580787] [@problem_id:2417336]。

一种更复杂的方法，反映了现代[算法设计](@article_id:638525)的实用主义，是创建一种混合方法 [@problem_id:3170237]。可以把它想象成有两匹马：一匹是稳健可靠的役马 (BFGS)，另一匹是敏捷、爱冒险的骏马 (SR1)。在每一步，我们都检查潜在的 SR1 更新的稳定性。如果它看起来稳定且良态，我们就用它来利用其独特的属性。如果它看起来不稳定，我们就回退到永远安全的 BFGS 更新。这样，我们就能两全其美：在安全时获得 SR1 的速度和特殊能力，在不安全时获得 BFGS 的稳健性。

### 超越山谷：探索丰富的优化景观

现在我们有了一个经过驯服的、稳健的 SR1 方法，那么它那特殊的才能——能够变得不定的能力——在何处才能真正大放异彩呢？它在世界不是一个简单的凸谷时大放异彩。

现代优化中最强大的框架之一是**[信赖域方法](@article_id:298841) (trust-region method)**。[信赖域方法](@article_id:298841)不是简单地选择一个方向然后决定走多远（像线搜索那样），而是说：“我要在我当前位置周围画一个小圈，在这个圈里我信任我的二次景观模型。我将找到该圈内的最佳点。”这种方法的美妙之处在于，由 $B_k$ 定义的模型是否是一个完美的碗并不重要。即使 SR1 给了我们一个不定的 $B_k$——一个马鞍形隘口的模型——信赖域框架仍然可以利用它来找到一个有成效的步长，通常是通过沿着信任区域的边界移动 [@problem_id:3193611]。SR1 提供了一张可能更准确、尽管奇怪的地图，而[信赖域方法](@article_id:298841)知道如何智能地解读它。

这个特性在**约束优化 (constrained optimization)** 中至关重要，这是一个应用遍及金融到工程等各个领域的广阔领域。像[序列二次规划](@article_id:356563) (SQP) 这样的方法涉及最小化一个称为[拉格朗日函数](@article_id:353636)的特殊函数。值得注意的是，即使对于一个行为良好的问题，[拉格朗日函数](@article_id:353636)的[海森矩阵](@article_id:299588)在解点也常常是不定的。像 BFGS 这样建立在凸性假设上的方法在这里会遇到困难。然而，SR1 却是天作之合。它不惧怕不定性，并且可以为底层的[拉格朗日函数](@article_id:353636)建立一个更好的模型，这使其成为 SQP 工具箱中的一个宝贵工具 [@problem_id:2202041]。

### 通往科学的桥梁：寻找[关键路径](@article_id:328937)

当我们将这些数学思想与物理世界联系起来时，真正的魔力就发生了。SR1 “思考”非凸问题的能力使我们能够解决对科学和工程至关重要的问题。

#### [计算化学](@article_id:303474)：绘制反应的山隘

SR1 最优雅的应用也许是在化学中寻找**[过渡态](@article_id:313517) (transition states)** [@problem_id:2827008]。[化学反应](@article_id:307389)不是凭空发生的；分子必须扭曲成一种高能构型——过渡态——然后才能稳定为最终产物。在[势能面](@article_id:307856)上，这个[过渡态](@article_id:313517)不是一个最小值（一个稳定的分子）或一个最大值（一个完全不稳定的点）。它是一个*[鞍点](@article_id:303016)*，具体来说是[一阶鞍点](@article_id:344514)。它是一个“山隘”：在所有方向上都是最小值，除了一个方向——反应坐标，沿着这个方向它是一个最大值。

要找到这个山隘，你需要一个能够“看到”隘口的[优化算法](@article_id:308254)。一个只寻找山谷的[算法](@article_id:331821)，比如基于正定 BFGS 近似的[算法](@article_id:331821)，对此是盲目的。它会从隘口滚落到相邻的山谷中（反应物或产物）。SR1 凭借其生成具有一个负[特征值](@article_id:315305)的不定[海森近似](@article_id:350617)的能力，可以创建一个正确捕捉[鞍点](@article_id:303016)几何形状的局部模型。负[特征值](@article_id:315305)对应于沿反应路径的“上坡”方向。在这里，SR1 的“缺陷”成了其最重要的特性。它让化学家能够计算[反应速率](@article_id:303093)和理解反应机理，这是现代化学的基石。对于像生物大分子这样计算嘈杂且复杂的巨大系统，在稳定的 [L-BFGS](@article_id:346550) [预条件子](@article_id:297988)和更具描述性的有限内存 SR1 更新之间进行谨慎选择是一门实践艺术，通常在优化的最后阶段，当反应路径清晰时，会切换到 l-SR1 [@problem_id:2934047]。

#### 计算工程：从梁的弯曲到汽车的碰撞

在**计算工程 (computational engineering)** 的世界里，物体会弯曲、屈曲和碰撞。底层的数学模型通常是高度非线性的。当我们用[有限元法 (FEM)](@article_id:323440) 解决这些问题时，我们本质上是在最小化一个[势能函数](@article_id:345549)。虽然我们希望最终达到一个[稳定平衡](@article_id:333181)（一个最小值），但通往那里的旅程可能充满危险。系统可能会接近一个屈曲点，此时[切线刚度矩阵](@article_id:350027)（即[海森矩阵](@article_id:299588)）变得奇[异或](@article_id:351251)不定。

在这里，SR1 再次扮演了双重角色。它生成[不定矩阵](@article_id:639257)的能力可以作为物理不稳定的一个宝贵信号。然而，如果没有通过像信赖域或仔细的[线搜索](@article_id:302048)这样的稳健全局化策略来妥善处理，它可能会导致非下降方向，从而导致模拟失败，尤其是在像接触问题这样状态突变的复杂情况中 [@problem_id:2580787]。在像全[牛顿法](@article_id:300368)或[高斯-牛顿法](@article_id:352335)这样更广泛的求解器家族中，SR1 提供了一种计算上更便宜的方法来近似二阶信息，这对于在这些要求苛刻的模拟中实现快速收敛至关重要 [@problem_id:2665041]。

#### [数据拟合](@article_id:309426)：面对不确定性时的诚实

最后，考虑**[数据拟合](@article_id:309426)和逆问题 (data fitting and inverse problems)** 的世界。我们通常有一个模型，并希望将其参数拟合到一些观测数据上，通常是通过最小化[最小二乘误差](@article_id:344081)来实现。有时，我们的数据并不能提供关于所有参数的信息。这导致[误差函数](@article_id:355255)的景观在某些方向上是平坦的——即曲率为零的方向。一项有趣的研究表明，在这些情况下，SR1 比 BFGS 更“诚实”[@problem_id:3170196]。当在零曲率方向上迈出一步时，SR1 更新可以正确地了解到曲率为零，并相应地更新其海森模型。相比之下，BFGS 受其对[正曲率](@article_id:332922)的需求所限，可能会跳过更新，在其模型中留下一个虚构的[正曲率](@article_id:332922)。SR1 通过建模零曲率来承认“我不知道”的能力，使其成为探索数据正在告诉我们什么——以及没有告诉我们什么——的更忠实的工具。

### 不定性的智慧

我们与 SR1 的旅程揭示了一个美丽的真理。我们从一个看似危险不稳定的简单、优雅的公式开始。但通过理解它的“缺陷”——它愿意变得不定——我们发现了它真正的力量。这个特性不是一个缺陷；它是一个让我们能够绘制出定义了科学中最有趣问题的复杂、非凸景观的特性。从[化学反应](@article_id:307389)的山隘到钢[梁的屈曲](@article_id:373823)，真实世界并不总是一个简单的山谷。要探索它，我们需要像我们自己一样思想开放、富有冒险精神的工具。SR1，当被谨慎和智慧地使用时，正是这样一个工具。