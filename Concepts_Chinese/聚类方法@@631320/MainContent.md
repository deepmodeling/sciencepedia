## 引言
从整理衣物到布置杂货店，将相似物品分组——即[聚类](@entry_id:266727)——是我们理解世界方式的一个基本组成部分。在大数据时代，这个直观的过程已经转变为一个用于科学发现的强大计算工具。随着[基因组学](@entry_id:138123)、天文学和[材料科学](@entry_id:152226)等领域的数据集变得过于庞大和复杂，以至于人类无法检视，我们依赖算法来揭示其中隐藏的结构和模式。这些方法使我们能够在事先不知道要寻找什么的情况下，发现有意义的群体，无论它们是新型细胞、遥远的星系超星系团，还是独特的客户分群。

本文将深入探讨聚类的世界，不仅将其视为一组统计技术，更将其视为一种思考数据的方式。我们将在“原理与机制”一章开始，剖析驱动不同[聚类算法](@entry_id:146720)的核心理念。您将学习到像 k-means 和 DBSCAN 这样的方法如何定义簇，[距离度量](@entry_id:636073)在塑造结果中的关键作用，以及高维数据带来的固有挑战。随后，“应用与跨学科联系”一章将展示这些工具的实际应用，演示同样抽象的原理如何被应用于解答生物学、物理学等领域的深刻问题，将原始数据转化为科学洞见。

## 原理与机制

### 什么是簇？发现“相似”的艺术

从本质上讲，[聚类](@entry_id:266727)是我们每天凭直觉进行的一种发现行为。当我们将待洗衣物分为浅色和深色，或者当杂货商将农产品分门别类地摆放成水果区和蔬菜区时，我们就是在进行[聚类](@entry_id:266727)：我们根据一种共同的“相似性”概念将对象分组。

在科学和工程领域，这个基本思想被提升为一种在数据中寻找模式的强大工具。想象一个数据集，它不是一张数字电子表格，而是一个充满星辰的浩瀚、黑暗的宇宙。每一颗星都是一个数据点——一个病人、一种材料、一个细胞——它在这个宇宙中的位置由其属性决定。对于一种材料，它的坐标可能是硬度和[耐腐蚀性](@entry_id:183133) [@problem_id:1312336]。对于一个细胞，它的坐标可能是数千种不同基因的表达水平 [@problem_id:1714816]。属性的数量定义了我们宇宙的维度数量。

**聚类**（Clustering）就是向这个宇宙发射探测器以寻找其自然星座的艺术。其主要目标是将这些星星划分成组，即**簇**（clusters），使得单个簇内的星星彼此“接近”，同时又与其它簇中的星星“遥远”。

这个过程的深刻之美在于，我们事先通常不知道这些星座代表什么。当一位生物学家根据胚胎中成千上万个细胞的基因表达谱对其进行[聚类](@entry_id:266727)时，他们不仅仅是在整理数据。他们正在提出一个深刻的假设：这些数学上定义的群体对应于生物学上有意义的类别，例如不同的**细胞类型**或功能状态。在“基因空间”中一个密集的点簇可能是一个神经元的标志；另一个则可能是一个肌肉细胞。算法在其无偏见的探索中，可以揭示生物世界隐藏的分类体系 [@problem_id:1714816]。

### 距离的问题：衡量相似性

整个[聚类](@entry_id:266727)的大厦都建立在一个关键问题之上：我们所说的“近”和“远”是什么意思？为了给这个直观概念赋予数学上的严谨性，我们必须定义一个**[距离度量](@entry_id:636073)**（distance metric）。

最熟悉的是**欧几里得距离**（Euclidean distance），即我们在几何学中学到的两点之间的直线路径。它是“乌鸦飞行”的距离。如果我们的数据点是在硬度对导电率图上绘制的两种材料，它们的[欧几里得距离](@entry_id:143990)直接衡量了它们的总体不相似性。

然而，数据科学中的“距离”是一个比几何学中远为丰富的概念。有时我们更关心的不是属性的[绝对值](@entry_id:147688)，而是它们的模式。考虑两个基因，我们在一系列实验中测量了它们的表达水平。一个基因可能总是在高水平表达，而另一个在低水平表达，但它们在所有实验中完美同步地起伏。它们的量级不同，但“形状”完全相同。在这种情况下，一个更好的相似性度量是基于**[皮尔逊相关](@entry_id:260880)性**（Pearson correlation）的度量。我们可以将不相似性定义为 $1 - r$，其中 $r$ 是相关系数。对于完全相关的基因（$r=1$），不相似性为 $0$；对于完全反相关的基因（$r=-1$），不相似性为 $2$。这使我们能够根据对象轮廓*形状*的相似性进行[聚类](@entry_id:266727)，这是[基因组学](@entry_id:138123)中的常见任务 [@problem_id:2379287]。

对[距离度量](@entry_id:636073)的这种依赖揭示了[聚类](@entry_id:266727)的一个关键弱点。距离计算需要完整的信息。为了找到两个样本向量之间的距离，我们需要这些向量的每一个分量。如果某个特定病患样本中仅有一个基因的表达数据缺失，那么该样本与*所有其他样本*之间的[欧几里得距离](@entry_id:143990)就变得无法确定。这就是为什么妥善处理缺失数据（例如通过插补）不仅仅是一个统计上的细节，而是大多数[聚类分析](@entry_id:637205)的基本先决条件。与计算单个基因的简单平均值（我们可以直接忽略缺失值）不同，[聚类](@entry_id:266727)是一种整体性的、多变量的比较，它可能因单个缺失条目而瘫痪 [@problem_id:1437215]。

### [聚类](@entry_id:266727)的两大理念

虽然有数百种[聚类算法](@entry_id:146720)，但大多数可以被理解为属于几个核心思想流派。它们的区别不仅在于其机制，还在于它们对簇的根本定义。

#### 理念一：基于质心的划分（王国类比）

想象一下，你想把一块新发现的土地划分成 $k$ 个王国。这就是**基于质心的聚类**（centroid-based clustering）的理念，其最著名的实现是 **k-means**。该算法非常简单：

1.  **奠基**：你首先将 $k$ 个被称为**[质心](@entry_id:265015)**（centroids）的总督随机放置在土地上的不同位置。$k$ 的数量是你必须事先做出的关键决定——算法无法为你发现它 [@problem_id:1312336]。
2.  **效忠**：每个公民（数据点）都会审视所有 $k$ 个总督，并向离自己最近的那一个宣誓效忠。这将整个土地划分为 $k$ 个领地。
3.  **重新定位中心**：每个总督都希望处于其新臣民的中心位置，于是移动到其领地内所有公民的精确平均位置，即[质心](@entry_id:265015)。
4.  **重复**：现在总督们移动了位置，一些边界上的公民可能会发现他们现在离另一个总督更近。因此，过程重复：公民重新评估他们的效忠对象，总督们移动到他们的新中心。这个过程持续进行，直到没有公民改变效忠对象，王国稳定下来。

结果是对数据的完美划分；每个点都恰好属于一个簇。然而，这种方法有一个内在的假设：它含蓄地将一个簇定义为空间的凸形、大致球形的区域（一个“团块”）。即使真实的底层结构完全不同，它也会很乐意地将数据切割成 $k$ 个整齐的部分。

#### 理念二：基于密度的[聚类](@entry_id:266727)（群岛类比）

一个完全不同的理念提出了这样一个问题：如果一个簇不是一个王国，而是一个浩瀚海洋中的一座岛屿呢？这就是**基于密度的[聚类](@entry_id:266727)**（density-based clustering）背后的思想，以 **DBSCAN** 算法为代表。

DBSCAN 并不划分所有东西，而是在地貌中探索，寻找密集的群岛。它基于两条简单的规则运作：

1.  如果一个点在一定半径内有足够数量的邻居，它就被认为是一个**[核心点](@entry_id:636711)**（core point）。这些是我们岛屿上繁华的中心。
2.  一个簇是一组相互连接的[核心点](@entry_id:636711)，以及任何作为[核心点](@entry_id:636711)邻居的“边界”点。

任何剩下的——海洋中孤立的点——都不会被强制归入一个簇。它被标记为**噪声**（noise）。这是一个深刻的转变。与 k-means 不同，DBSCAN 不假设簇是球形的。它可以发现任意形状的簇，比如长而蜿蜒的链条或新月形。更重要的是，它有一个内在的离群点概念。

这种差异不仅仅是学术上的。考虑一个蛋白质折叠和展开的模拟 [@problem_id:2098912]。蛋白质可能大部分时间都处于少数几个稳定、明确的形状（密集簇）中，但在它们之间转换时会经过各种瞬态的、稀疏[分布](@entry_id:182848)的形状（过渡路径）。K-means 被迫将每个点都分配到一个簇，会错误地将这些瞬态结构与稳定状态混为一谈。相比之下，DBSCAN 会出色地识别出密集的稳定状态作为其簇，并正确地将短暂的过渡结构标记为噪声，从而给出一个远为符合物理现实的图像。这种让数据定义自身结构，而不受预设几何概念或人类偏见约束的能力，是现代[无监督学习](@entry_id:160566)的一个标志 [@problem_id:2247628]。

### 数据的族谱：[层次聚类](@entry_id:268536)

有时，数据中最有趣的模式不是一组扁平的群体，而是一个嵌套的关系结构——一个层次结构。考虑细胞分化的过程，一个全能干细胞产生中间祖细胞，后者又分化成神经元、皮肤细胞和肝细胞。这里的关系不是截然分开的群体，而是一个族谱。

**[层次聚类](@entry_id:268536)**（Hierarchical clustering）正是为揭示这种结构而设计的。它不是生成数据的单一划分，而是构建一个**[树状图](@entry_id:266792)**（dendrogram），一个展示簇的嵌套[排列](@entry_id:136432)的树形图。这对于像重建发育谱系这样的场景具有独特的[信息价值](@entry_id:185629)，其中树的分支点可以代表生物学中实际的[细胞命运决定](@entry_id:196591) [@problem_id:2281844]。

构建这棵树主要有两种方法：

*   **凝聚式（自下而上）**：这种方法就像从其在世后代开始构建族谱。你从每个数据点都自成一簇开始。然后，你找到两个最接近的簇并将它们合并。你重复这个过程，相继合并下一对最接近的簇，直到所有东西都融合成一个包含所有数据的巨大簇。[树状图](@entry_id:266792)记录了这整个合并的历史。

*   **分裂式（自上而下）**：这就像追溯你的祖先。你从所有数据点都在一个单一的、普遍的簇开始。然后你进行一次分割，将其划分为两个最不相似的子簇。然后你对每个子簇进行递归分割，依此类推，直到每个点都自成一簇。

这两种方法虽然都产生一个层次结构，但可能会产生不同的结果。一个进行局部最优合并的自下而上方法（如[单链接](@entry_id:635417)法）可能容易出现“链接”现象，即两个大簇仅仅因为各自的一个点彼此靠近而被连接起来。而一个进行全局性分割的自上而下分裂方法，可能会优先将一个离群点从主群体中分离出来作为其第一步 [@problem_id:3129053]。策略的选择取决于你认为最重要的结构是由局部成对相似性定义，还是由全局划分定义。

### 高维度的危险与陷阱

聚类似乎是一种神奇的模式发现机器，但它在一个奇怪的世界中运行，尤其是当特征（维度）数量非常大时。在基因组学等领域，一个样本可能由 20,000 个基因表达值来描述，这意味着我们是在一个 20,000 维的空间中对点进行聚类。在这样的空间里，我们低维度的直觉完全失效。这就是**维度灾难**（curse of dimensionality）。

在高维空间中，体积增长得如此惊人，以至于数据点变得异常稀疏。所有东西都离其他所有东西很远。最接近的一对点与最远的一对点之间的距离变得几乎相同。如果所有距离都几乎相等，“最近邻”的概念本身就失去了意义，像 k-means 和[层次聚类](@entry_id:268536)这样的基于距离的算法开始失效。定义簇的少数真正重要特征所发出的信号，被成千上万个不相关特征的噪声所淹没 [@problem_id:2379287]。

如果适用的话，摆脱这种诅咒的一个巧妙方法是转置问题。如果你有 20,000 个基因在仅 100 个样本上的数据，与其在 20,000 维空间中对 100 个样本进行[聚类](@entry_id:266727)，不如在 100 维空间中对 20,000 个基因进行[聚类](@entry_id:266727)，这样[维度灾难](@entry_id:143920)的影响要小得多 [@problem_id:2379287]。

最后，我们必须提出所有问题中最重要的一个：我们能相信我们找到的簇吗？[聚类算法](@entry_id:146720)总会产生一个答案，但这个答案可能只是我们碰巧收集到的特定数据的脆弱产物。一个单一的“毒”数据点，一个被恶意放置在两组之间的离群点，有时会极大地改变像 k-means 这样的算法的最终簇边界，因为其质心对每个点都很敏感 [@problem_id:2379281]。

为了建立对我们结果的信心，我们必须测试它们的**稳定性**（stability）。统计学中一个强大的思想是**[自助法](@entry_id:139281)**（bootstrapping）。我们可以通过对我们自己的数据集进行重采样，来模拟一次又一次地收集我们的数据。我们通过例如在一个从原始数据集中[有放回抽样](@entry_id:274194)得到的数据集上重新运行我们的分析来“搅动数据”。我们这样做数百次。然后我们问：在这些重采样的数据集中，同样的对象群体——同样的基因、同样的细胞——是否始终聚在一起？如果簇结构是稳健的，并且一次又一次地重现，我们就可以更有信心地认为我们发现了世界中一个真实的、潜在的模式。如果簇随着每一次搅动而随机地分解和重组，我们很可能只是在噪声中发现了一个幻影 [@problem_id:3295698]。

