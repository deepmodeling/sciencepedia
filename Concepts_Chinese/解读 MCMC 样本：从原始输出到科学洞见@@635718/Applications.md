## 应用与跨学科联系

于是，庞大的计算机器嗡嗡作响，[马尔可夫链](@entry_id:150828)在广阔的高维可能性景观中漫游之后，带回了一份礼物：一个样本集合。成千上万，也许数百万的点，每个点都代表着我们模型所描述的一个完整的、可能的世界状态。乍一看，这可能像是一堆杂乱的数字。但远非如此。这个集合是一张藏宝图。它是我们知识[状态和](@entry_id:193625)不确定性的具体[数值表示](@entry_id:138287)。它是我们问题的答案，不是一个单一、贫乏的数字，而是一片丰富、有纹理的可能性云。我们现在的任务是学会如何阅读这张地图，将这片点云转化为科学洞见。MCMC 方法的美妙之处在于，一旦你拥有了这些样本，回答各种各样令人惊叹的问题就变得异常简单直接。

### 从点云到信念的度量

让我们从最直接的问题开始：我们关心的某个参数的价值是什么？想象一下你是一位系统生物学家，正在测试一种抑制病原体的新药。这种药物的功效由一个参数捕捉，我们称之为 $\epsilon$。在运行 MCMC 分析后，你没有得到 $\epsilon$ 的单一值；你得到的是一整列值，即你的后验样本。现在，你可以问一个非常实际的问题：该药物将病原体生长速率降低至少 50% 的概率是多少？答案非常简单。你只需要数数。你筛选数千个 $\epsilon$ 的样本值，计算其中满足你标准的比例。这个比例*就是*你估计的概率 [@problem_id:1444204]。没有复杂的积分需要执行；MCMC 已经通过提供样本完成了艰苦的工作。

这片点云就是完整的[后验分布](@entry_id:145605)。我们可以将其可视化，观察其形状。它是一个尖锐、对称的峰，告诉我们我们已经高精度地确定了参数吗？还是它是偏斜的、宽阔的，甚至是多峰的，暗示着一个更复杂的现实？因为我们拥有完整的形状，我们可以做得比仅仅引用一个均值和标准差好得多。我们可以构建*[可信区间](@entry_id:176433)*。一个 95% 的可信区间是一个我们相信以 95% 的概率包含真实参数值的范围。

但是哪个区间呢？对于任何给定的概率，都有无限多个区间。在这里，MCMC 样本给了我们另一个优势。我们可以找到包含 95% 样本的*最短可能*区间。这被称为[最高后验密度区间](@entry_id:169876) (HPDI)，它是我们知识最有效、最诚实的总结。如果我们的信念是偏斜的——也许我们认为一个参数很可能很小，但也可能非常大——HPDI 自然会是不对称的，反映出那种偏斜。找到这个最短区间是一个简单的计算任务：我们只需将一个具有正确概率含量的窗口沿着排序后的样本滑动，并找到宽度最小的那个 [@problem_id:1921027]。

### 传播不确定性：从模型参数到真实世界

通常，我们模型内部的参数并不是我们最终关心的东西。我们关心的是*依赖*于那些参数的真实世界量。一位构建[动态随机一般均衡](@entry_id:141655)（DSGE）模型的经济学家可能有一个描述[经济冲击](@entry_id:140842)持续性的参数 $\rho$。但与政策相关的问题可能是：“这次冲击的[半衰期](@entry_id:144843)是多长？”[半衰期](@entry_id:144843) $h$ 是 $\rho$ 的函数，具体为 $h = -\ln(2) / \ln(\rho)$。

这里就是 MCMC 样本魔力真正闪耀的地方。因为我们有一整片代表我们对 $\rho$ 知识的点云，我们可以将这片云转化为代表我们对 $h$ 知识的新云。我们只需从 MCMC 输出中取出每一个样本 $\rho_i$，并计算相应的半衰期 $h_i = h(\rho_i)$。结果是一个新的样本集合 $\{h_i\}$，它代表了半衰期的完整[后验分布](@entry_id:145605)！然后我们可以通过简单地检查这片新的点云来回答关于 $h$ 的问题——它的[中位数](@entry_id:264877)是多少？它的 95% 可信区间是什么？[@problem_id:2375884]。我们几乎不费吹灰之力，就将不确定性从抽象的模型参数传播到了具体的真实世界量上。

这个原理不限于简单的公式。在许多领域，如[计算核物理](@entry_id:747629)学，连接基本参数与可观测量的“函数”是一个庞大、复杂的计算机模拟，通常被称为“正向求解器”。例如，物理学家可能有一个描述[原子核](@entry_id:167902)内部[光学势](@entry_id:156352)的模型，由一组参数 $\boldsymbol{\theta}$ 描述。他们想预测一个可观测量，比如[反应截面](@entry_id:191218) $\sigma_R$，这是求解散射的 Schrödinger 方程的结果。利用 MCMC，他们获得了一片可能的参数向量云 $\{\boldsymbol{\theta}^{(s)}\}$。为了得到[截面](@entry_id:154995)的预测和不确定性，他们做了和经济学家一样的事情：对于每个样本 $\boldsymbol{\theta}^{(s)}$，他们运行整个复杂的模拟来计算得出 $\sigma_{R}^{(s)}$。所得的集合 $\{\sigma_{R}^{(s)}\}$ 就是可观测量的[后验预测分布](@entry_id:167931)，他们可以从中提取最佳估计和可信带。这就是[不确定性量化](@entry_id:138597)在实践中的应用，是现代计算科学的基石 [@problem_id:3578693]。

### 权衡世界：假设检验与[模型比较](@entry_id:266577)

科学不仅仅是关于估计；它是关于在相互竞争的观点之间做出选择。由 MCMC 驱动的贝葉斯框架提供了一个完整的系统，用于权衡不同假设的证据。

有时假设是一个简单的比较。被子植物（开花植物）的叶绿体是否比[裸子植物](@entry_id:145475)（如[针叶树](@entry_id:268199)）的演化更快？生物学家可以构建一个[系统发育](@entry_id:137790)模型，其中被子植物的平均替换率 $r_A$ 和[裸子植物](@entry_id:145475)的平均替换率 $r_G$ 都是参数。MCMC 将产生样本对 $(r_A^{(s)}, r_G^{(s)})$。为了检验被子植物演化更快的假设，我们再次只需数数。在我们的样本中，$r_A^{(s)} > r_G^{(s)}$ 的比例是多少？如果这个比例是，比如说，0.9，那就意味着在给定我们的模型和数据的情况下，我们有 90% 的信念认为该假设为真。这是一种直接、直观的证据度量 [@problem_id:2590721]。

通常，相互竞争的观点不仅仅是不同的参数值，而是完全不同的世界模型。在演化生物学中，我们可能有系统发育树的样本。每棵树都代表了关于物种间[演化关系](@entry_id:175708)的不同假设。某个特定演化支（clade，一个由一个祖先及其所有后代组成的群体）的后验概率就是我们 MCMC 样本中包含该[演化支](@entry_id:171685)的树所占的比例 [@problem_id:1911287]。

我们可以更进一步，比较根本不同的解释模型。一位系统生物学家可能想知道，一个简单的 Michaelis-Menten 模型是否足以描述[酶动力学](@entry_id:145769)，或者是否需要一个包含底物抑制的更复杂模型。通过为两种模型都运行 MCMC，可以计算出一个叫做离差[信息准则](@entry_id:636495) (DIC) 的量。[DIC](@entry_id:171176) 提供了一种正式的方法来权衡模型的[拟合优度](@entry_id:637026)与其复杂性（由其“有效参数数量”衡量，这是另一个可以从 MCMC 样本中轻松估计的量），有助于[防止过拟合](@entry_id:635166)，并选择提供最佳预测能力的模型 [@problem_id:1444269]。

对于最宏大的问题，我们可以使用一个更强大的工具：[贝叶斯因子](@entry_id:143567)。想象一下，你想知道寄生虫和它们的宿主是否[协同物种形成](@entry_id:147115)，它们的家族树相互映照，还是寄生虫独立演化，从一个宿主跳到另一个宿主。这是两个完全不同的故事，对应于两类不同的数学模型。使用先进的 MCMC 技术（如踏脚石采样），可以估计每个模型的总证据，称为边缘似然。这些证据的比率就是[贝叶斯因子](@entry_id:143567)。它精确地告诉你，数据应该使你对一个模型的信念在多大程度上转向另一个模型。它是一种科学世界观相对于另一种的直接、量化的证据度量 [@problemid:2375028]。

### 见所未见：[边缘化](@entry_id:264637)的力量

也许 MCMC 最深刻的应用是它能够让我们通过对我们不确定的所有其他事物进行平均，从而“看到”隐藏的东西。这就是边缘化的原则。

假设一位[演化生物学](@entry_id:145480)家想要推断一个古老、早已灭绝的祖先的特征——例如，它是温血动物还是[冷血动物](@entry_id:146247)？答案取决于连接它与其现代后代的[演化树](@entry_id:176670)、树枝的长度以及描述该性状如何演化的模型参数。问题是，我们对所有这些事情都不确定！树的拓扑结构、[分支长度](@entry_id:177486)、模型参数——它们都是讨厌变量。

MCMC 以一种 sublime 的优雅处理了这个问题。MCMC 采样器同时探索所有事物的联合后验分布：树、长度、模型参数和祖先状态。如果我们想知道祖先是温血的后验概率，我们只需查看我们的样本，忽略除了那个祖先状态之外的所有东西。通过计算我们样本中该祖先为“温血”的频率，我们实际上已经对所有可能的树、所有可能的[分支长度](@entry_id:177486)以及所有可能的模型参数进行了平均——或积分——每一个都由其后验概率加权。我们已经通过对讨厌变量进行平均“抹去”了其中的不确定性，从而揭示出我们想看到的那个量的稳健图像 [@problem_id:2694211]。

### 最后的警示：地图与疆域

拥有如此强大的力量，我们仍需保持谦逊。我们从 MCMC 样本中得出的美丽的[后验分布](@entry_id:145605)，到底代表什么？关键要记住，[贝叶斯推断](@entry_id:146958)总是*以模型为条件的*。我们运行采样器来探索[后验分布](@entry_id:145605) $p(\text{parameters} | \text{data}, \text{MODEL})$。结果是模型世界的完美指南，但模型并非真实世界。

[材料科学](@entry_id:152226)家可能会使用[参数化](@entry_id:272587)的[原子间势](@entry_id:177673) $U_{\theta}$ 来模拟晶体。这个势是真实、远为复杂的量子力学现实 $U^{\star}$ 的一个近似。当他们运行 MCMC 来找到最佳参数 $\theta$ 时，链并不会收敛到现实的“真实”参数，因为在简化的模型中不存在这样的参数。相反，在一般条件下，[后验分布](@entry_id:145605)将集中在一个“伪真”参数值 $\theta^{\dagger}$ 周围。这个参数使所选模型成为对现实的*最不坏*可能近似，通常是最小化与真实数据生成过程之间 [Kullback-Leibler 散度](@entry_id:140001)的那个参数。

因此，MCMC 样本完美地量化了我们关于*我们所选近似*的最佳参数的[认知不确定性](@entry_id:149866)。它们本身并不量化模型本身的结构性误差或[模型设定错误](@entry_id:170325) [@problem_id:3463574]。我们绝不能忘记地图与疆域的区别。MCMC 为我们提供了一幅我们模型世界的精致详尽、完美渲染的地图。它的效用完全取决于这幅地图与自然界的真实疆域的对应程度。采样器给了我们答案，但提出正确的问题，并对我们提出问题的世界持批判态度，则取决于我们科学家自己。