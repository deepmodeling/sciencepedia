## 引言
从[机器人学](@article_id:311041)到[化学工程](@article_id:304314)等领域，保证系统的安全性或稳定性通常取决于一个基本的数学问题：一个特定的函数在给定的操作区域内是否总是正的？对于单变量函数而言，这个问题很简单，但对于描述现实世界系统的复杂多元多项式来说，它变得异常困难。本文通过探索一个来自[代数几何](@article_id:316707)的强大框架来应对这一挑战，该框架为正性提供了可验证的“证书”。第一章“原理与机制”将介绍平方和 (SOS) 多项的核心概念，解释导致 Positivstellensatz 发展的局限性，并详细说明这些定理如何为约束集上的正性提供计算上易于处理的证明。在这一理论基础之后，第二章“应用与跨学科联系”将展示这些抽象思想如何成为证明稳定性、确保安全性乃至为复杂[系统综合](@article_id:381652)控制器的不可或缺的工程工具，从而在纯粹数学与应用技术之间架起一座桥梁。

## 原理与机制

想象一下，你是一名工程师，正在设计一个复杂的系统——一架[自动驾驶](@article_id:334498)无人机、一个电网或一个[化学反应器](@article_id:383062)。你必须回答一个关键问题：这个系统会稳定吗？它会保持在安全的操作范围内吗？通常，这些问题可以归结为一个看似简单实则复杂的数学挑战：证明某个函数，比如能量函数 $V(x)$，在给定的操作区域内总是正的。

如果 $V(x)$ 是一个简单的单变量抛物线，如 $x^2 + 1$，你会立刻知道它总是正的。但如果它是一个包含多个变量的庞大多项式，如 $V(x_1, x_2, x_3) = x_1^8 + x_2^6 - 2x_1^3 x_2^2 x_3 + 5x_3^4$ 呢？你如何确定它永远不会低于零？你可以测试数百万个点，但这只是收集证据，而非证明。这就是正性难题，其解决方案将带领我们踏上一段穿越代数、几何和计算的美妙旅程。

### 真理的证书：平方和

让我们从一个绝妙而简单的想法开始。如果我们可以将一个复杂的多项式 $p(x)$ 重写为其他多项式的平方和呢？例如，像这样：

$$
p(x) = h_1(x)^2 + h_2(x)^2 + \dots + h_k(x)^2
$$

如果我们能做到这一点，那么 $p(x)$ 的非负性就显而易见了。因为我们处理的是实数，任何数的平方都是非负的。一堆非负项的和也必定是非负的。因此，对于所有可能的 $x$ 值，$p(x) \ge 0$。找到这样的表示形式，就像找到了一个不可否认的、代数上的非负性“证书”。我们称这样的多项式为**平方和**（**sum of squares**），或 **SOS**。

这个证书非常强大，因为它将一个困难的几何问题（函数的图像是否总在坐标轴上方？）替换为一个纯粹的代数问题（该多项式能否以这种特定方式分解？）。

### 细则：当非负不等于平方和

SOS 这个想法看起来如此自然，你可能会猜想*任何*非负多项式都必定是[平方和](@article_id:321453)。对于单变量多项式，这确实是真的。在很长一段时间里，数学家们都在思考这对于多变量是否也成立。1888年，David Hilbert 在他著名的希尔伯特问题列表中提出了这个问题。令人惊讶的是，答案是否定的。

存在这样一些多项式，它们处处非负，但无法写成其他多项式的[平方和](@article_id:321453)。其中最著名的是 **Motzkin 多项式** [@problem_id:2751058]：

$$
M(x_1, x_2) = x_1^4 x_2^2 + x_1^2 x_2^4 - 3x_1^2 x_2^2 + 1
$$

使用一个巧妙的不等式（算术-几何平均不等式），可以证明对于所有实数 $x_1$ 和 $x_2$，$M(x_1, x_2) \ge 0$。然而，我们不可能找到多项式 $h_i(x_1, x_2)$ 使得 $M(x_1, x_2) = \sum_i h_i(x_1, x_2)^2$。这仿佛是多项式由于某种“几何上的巧合”而成为非负，但其[代数结构](@article_id:297503)无法直接以 SOS 形式表达。

这揭示了非负性这一几何性质与作为平方和这一代数性质之间一个迷人而微妙的差距。因此，虽然是 SOS 是非负性的*充分*条件，但它并非*必要*条件 [@problem_id:2751055]。

（顺便一提，Emil Artin 后来解决了希尔伯特第17个问题，他证明了任何非负多项式都可以写成*[有理函数](@article_id:314691)*（即多项式的分式）的[平方和](@article_id:321453)。虽然这在理论上很优美，但引入的分母使得计算变得困难得多 [@problem_id:2751055]。）

### 从困难到“简单”：凸性的魔力

如果 SOS 这个技巧并不完美，为什么它能彻底改变像控制理论这样的领域呢？答案在于计算复杂性。判断一个普通多元多项式是否非负是一个 NP-hard 问题，这意味着在最坏情况下，它在计算上是“困难”的——所需时间可能随问题规模呈指数级增长。在所有实际应用中，这通常是不可能完成的。

与此形成鲜明对比的是，判断一个多项式是否为[平方和](@article_id:321453)却是“简单”的！它可以被转化为一类称为**[半定规划 (SDP)](@article_id:332315)** 的问题，现代计算机可以高效地解决这类问题。其关键思想是**格拉姆矩阵表示** [@problem_id:2751082]。

任何一个作为[平方和](@article_id:321453)的 $2d$ 次多项式 $p(x)$ 都可以写成如下形式：

$$
p(x) = z(x)^\top Q z(x)
$$

在这里，$z(x)$ 是一个包含所有次数不超过 $d$ 的单项式的向量（例如，对于两个变量和次数为1的情况，$z(x) = \begin{pmatrix} 1 & x_1 & x_2 \end{pmatrix}^\top$），而 $Q$ 是一种特殊的常数矩阵：它必须是**[半正定](@article_id:326516)**的。[半正定矩阵](@article_id:315545)是矩阵中与非负数等价的概念，是优化中的核心对象。

为 $p(x)$ 寻找一个 SOS 证书，就变成寻找一个[半正定矩阵](@article_id:315545) $Q$，该矩阵满足通过匹配 $p(x)$ 的系数与 $z(x)^\top Q z(x)$ 展开式的系数而产生的线性方程组。这正是 SDP 的定义：一个带有线性约束和一个[半正定矩阵](@article_id:315545)变量的优化问题。这是一个**凸优化问题**，对于这类问题，我们有可靠且高效的[算法](@article_id:331821)。

因此，通过用更强的 SOS 条件替换非负性条件，我们牺牲了一点数学上的普适性，换来了巨大的计算能力 [@problem_id:2721600]。

### 有界世界中的正性：引入约束

在许多现实世界的问题中，我们不需要一个函数在整个宇宙中都为正。我们只关心一个特定的操作区域，比如无人机保持在离操作员一定距离内，或者机器人手臂在其物理限制内移动。这个区域，我们称之为 $K$，通常可以用一组多项式不等式来描述，如 $g_i(x) \ge 0$。例如，[单位圆](@article_id:311954)的内部由 $g(x) = 1 - (x_1^2 + x_2^2) \ge 0$ 描述。

我们如何证明一个多项式 $p(x)$ 在这个约束集 $K$ 上是非负的呢？我们不能仅仅检查 $p(x)$ 是否是 SOS，因为它可能在 $K$ 外部的某个地方为负。我们需要一个能巧妙地将约束 $g_i(x)$ 融合进去的证书。

这个灵感来自于一个关于二次多项式的经典结果，称为 **S-引理** [@problem_id:2751044]。它指出，对于两个二次函数 $p(x)$ 和 $g(x)$，当 $g(x) \ge 0$ 时 $p(x) \ge 0$ 成立，当且仅当存在一个非负的“调节因子” $\lambda \ge 0$，使得新的多项式 $p(x) - \lambda g(x)$ *处处*非负。这巧妙地将一个有约束的问题转化为了一个无约束的问题。

将这个思想推广到多个非二次多项式，就引出了 **Positivstellensatz**（德语，意为“正性定理”）的核心思想。我们可以使用 SOS 乘子为 $p(x)$ 在集合 $K = \{x \mid g_i(x) \ge 0\}$ 上的非负性构建一个证书。这种证书的一种常见形式是以下恒等式：

$$
p(x) = \sigma_0(x) + \sum_{i=1}^m \sigma_i(x) g_i(x)
$$

其中每个 $\sigma_i(x)$ 都是一个 SOS 多项式。让我们看看这为什么有效。对于我们集合 $K$ 内的任何点 $x$，我们知道每个 $g_i(x)$ 都是非负的。我们还知道每个 $\sigma_i(x)$ 也是非负的，因为它是平方和。因此，等式右边的每一项都是非负的，它们的和 $p(x)$ 也必定是非负的！这个表达式是由约束 $\{g_i\}$ 生成的**二次模**的一个成员 [@problem_id:2751065]。

对于更复杂的集合，我们可能需要一个更复杂的证书，其中包含约束的乘积，如 $\sigma_{12}(x) g_1(x) g_2(x)$。这种更一般的结构称为**预序** [@problem_id:2751061]。

### Putinar 的承诺：紧集上的证书

现在到了关键问题：如果一个多项式 $p(x)$ 在我们的集合 $K$ 上确实是正的，我们是否总能找到这样一个基于 SOS 的证书？

答案同样是“不总是”，但如果集合 $K$ 是“良态的”，我们就可以。Mihai Putinar 的一个里程碑式的结果给出了精确的条件。**Putinar Positivstellensatz** 给了我们一个强有力的保证。它指出，如果一个多项式 $p(x)$ 在 $K$ 上是*严格正*的，那么它就有一个更简单的二次模形式的证书，前提是约束集满足一个被称为**阿基米德**的条件 [@problem_id:2751065]。

这个[阿基米德性质](@article_id:304797)是什么？直观上，它意味着约束不等式 $g_i(x) \ge 0$ 本身就迫使集合 $K$ 是有界的——也就是说，包含在某个巨大的球体内。在代数上，这意味着对于某个大数 $R$，多项式 $R - \|x\|^2$ 可以用基于 $g_i$ 的证书结构来表示。这个性质至关重要，因为它确保了问题是受限的，防止了函数在无穷远处出现奇怪的行为。如果[阿基米德性质](@article_id:304797)成立，它保证了 Lasserre 层级（一种解决[多项式优化](@article_id:342055)问题的强大方法）将收敛到真实答案 [@problem_id:2751113]。如果你的问题是在一个非[紧集](@article_id:307989)上，有时可以通过添加一个大的但冗余的球约束来恢复这个性质，这是一个非常巧妙的实用技巧 [@problem_id:2751113]。

Putinar 的定理是现代[多项式优化](@article_id:342055)的基石。它提供了一种计算上易于处理的方式来证明在约束集上的正性，在[抽象代数](@article_id:305640)与工程和控制中的实际问题之间架起了一座桥梁。在实践中，它比 Schmüdgen 的一个相关结果更受欢迎，后者适用于任何[紧集](@article_id:307989)，但可能需要更复杂的预序证书结构 [@problem_id:2751086]。

### 承诺的代价：高阶证书的挑战

Putinar 的定理是一个承诺：证书是存在的。然而，这有点像一张藏宝图，保证有宝藏存在，但没说你得挖多深。该定理没有告诉我们所需的 SOS 乘子多项式 $\sigma_i(x)$ 的*阶数*。

在一些棘手的情况下，这个阶数可能会高得惊人 [@problem_id:2751071]。考虑一个多项式，它为正，但在靠近集合 $K$ 边界的地方变得非常平坦——以多个零[导数](@article_id:318324)趋近于零。证明这样一个多项式的正性需要极高阶的 SOS 乘子。

这不仅仅是一个理论上的好奇心；它具有深远的实际影响。高阶的 SOS 乘子意味着 SDP 中相应的格拉姆矩阵将非常巨大。这会导致 SDP 不仅求解缓慢，而且在数值上很脆弱，容易出错，甚至可能根本无法收敛。这是一个重大的挑战，也是一个活跃的研究领域。工程师和数学家们正在不断开发新技术，例如使用更受限制但计算成本更低的 SOS 形式，如 DSOS（对角平方和），以在理论保证和实际可解性之间取得平衡 [@problem_id:2751071]。

从一个简单的正性问题到[计算数学](@article_id:313928)的前沿，这段旅程揭示了思想之间美妙的相互作用。Positivstellensatz 提供了一个强大的框架，但其实际应用要求对其强大功能和局限性都有深刻的理解，从而推动我们去寻找更巧妙的方法来解决那些重要的问题。