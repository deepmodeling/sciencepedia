## 引言
从沙丘到工业筒仓，[颗粒材料](@entry_id:750005)无处不在，但其行为却难以简单描述。传统工程学通常将其视为均匀的连续介质，但这种方法忽略了其本质核心：决定其整体强度和流动的、离散的、逐个颗粒间的相互作用。这就提出了一个根本性问题：我们如何才能在单个颗粒的混沌世界与我们观察到的可预测的宏观属性之间架起一座桥梁？

离散元法 (DEM) 通过采用“自下而上”的方法，为此提供了一个强有力的答案。DEM 并非对属性进行平均，而是模拟系统中每一个颗粒的显式运动和相互作用，从简单、基础的物理学原理出发，构建出复杂、大规模的行为。它提供了一台计算显微镜，让我们得以窥视肉眼无法看见的、由[力链](@entry_id:199587)、颗粒旋转和摩擦滑移组成的隐藏世界。

本文探讨了这一变革性方法的理论与应用。第一章 **“原理与机制”** 解构了 DEM 的引擎，解释了牛顿定律如何应用于数百万个颗粒，接触模型在定义其相互作用中的关键作用，以及使这些大规模模拟成为可能的计算策略。其后的 **“应用与跨学科联系”** 一章揭示了 DEM 如何在从岩土力学到[材料科学](@entry_id:152226)等领域中被用作虚拟实验室，不仅用于解决实际工程问题，还用于从第一性原理出发，构建更新、更准确的连续介质理论。

## 原理与机制

为了理解沙堡、山体滑坡，乃至[土星环](@entry_id:157536)，我们有一个选择。我们可以将大量的颗粒集合视为一种连续的、被“抹平”的物质，就像水或钢一样。这是工程学的传统路径，一种强大且通常成功的近似方法。但如果我们觉得在平均过程中丢失了一些本质的东西呢？如果材料的特性——其真正的“颗粒性”——来自于其单个成员之间的碰撞、滑动和撞击呢？离散元法 (DEM) 大胆地宣告了它对第二种观点的支持。它主张：我们不要假装，让我们按照世界的本来面目来建模，一次一个颗粒。

### 回归牛顿：颗粒组成的世界

在其核心，DEM 是经典力学一个直接了当、甚至近乎天真简单的应用。对于我们系统中的每一个颗粒，我们都写下[牛顿运动定律](@entry_id:163846)。每个颗粒有两条定律：一条关于它如何在空间中移动（平动），另一条关于它如何翻滚（转动）。

第一条，关于[平动](@entry_id:187700)，是著名的 $\mathbf{F} = m\mathbf{a}$。更精确地说，作用在质量为 $m$ 的颗粒上的总力 $\mathbf{F}_{\text{total}}$ 决定了其加速度 $\mathbf{a}$：

$$
m\mathbf{a} = \mathbf{F}_{\text{total}}
$$

第二定律控制转动。作用在[转动惯量](@entry_id:174608)为 $I$ 的颗粒上的总力矩 $\mathbf{T}_{\text{total}}$（力的转动等效量）决定了其角加速度 $\boldsymbol{\alpha}$：

$$
I\boldsymbol{\alpha} = \mathbf{T}_{\text{total}}
$$

这些方程源于[线动量](@entry_id:174467)和角动量的基本平衡，是我们模拟的引擎 [@problem_id:3586465]。我们追踪每一个颗粒的位置、速度、方向和角速度。其“魔力”并不在于这些定律本身——它们几个世纪以来一直是物理学的基石。魔力以及所有的复杂性，都来自于计算出作用力 $\mathbf{F}_{\text{total}}$ 和力矩 $\mathbf{T}_{\text{total}}$。而对于颗粒来说，这个故事始于它们相互接触之时。

### 颗粒的社交生活：接触定律

当两颗沙粒相遇时会发生什么？这是[颗粒物理学](@entry_id:750007)的核心问题。在 DEM 中，我们有两种主要的哲学方法来回答这个问题 [@problem_id:3518732]。

#### “软”球哲学

最常见的方法，即所谓的**[软球模型](@entry_id:755009)**，设想我们的颗粒并非无限刚性。当它们被挤压在一起时，它们被允许有微小、几乎难以察觉的重叠。这个重叠量，用 $\delta$ 表示，不一定是真实的物理变形；它是一个巧妙的计算技巧。模拟通过产生一个将颗粒推开的排斥力来“惩罚”这种重叠。它们重叠得越多，推力就越大。

这种相互作用最简单、最直观的模型是**线性弹簧-阻尼器**系统 [@problem_id:3518810]。想象一下，在接触点，我们放置了一个微小的弹簧和一个微小的减震器（阻尼器）。

弹簧提供排斥力。就像压缩一个物理弹簧一样，力的大小与压缩量成正比，这里的压缩量就是重叠量 $\delta$。我们将其写为弹性力 $F_n^{el} = k_n \delta$，其中 $k_n$ 是**法向刚度**，是衡量颗粒“硬度”的指标。

但是，仅有弹簧意味着颗粒会以完美的效率相互反弹，就像[弹力](@entry_id:175665)超强的球一样，能量完全守恒。真实的碰撞并非如此；它们会产生声音，产生热量。它们是“非弹性”的。为了捕捉这种[能量损失](@entry_id:159152)，我们加入了阻尼器。阻尼器产生一个与运动方向相反的力，就像试图在水中奔跑一样。这个粘性力与颗粒的相对法向速度 $v_n$ 成正比。我们将其写为 $F_n^{visc} = -c_n v_n$，其中 $c_n$ 是**阻尼系数**。负号至关重要：如果颗粒正在相互靠近（$v_n  0$），力是正的（排斥力），阻碍靠近。如果它们正在相互分离（$v_n > 0$），力是负的（吸[引力](@entry_id:175476)），阻碍分离。这一项总是从系统中移除能量，确保我们模拟的颗粒最终会像真实颗粒一样稳定下来。

将这两者结合起来，得到总的法向接触力：

$$
F_n = k_n \delta - c_n v_n
$$

这个优美而简单的定律，仅在颗粒实际接触（$\delta > 0$）时才起作用，构成了无数 DEM 模拟的基础。

#### “硬”球哲学

另一种思想流派，称为**[非光滑接触动力学 (NSCD)](@entry_id:752606)**，严肃地对待刚性的概念。它假设颗粒是完全坚硬的，就像用钻石制成的台球。重叠是严格禁止的。接触成为一组绝对的约束条件。当颗粒碰撞时，它们的速度可以*瞬时*改变，产生“跳跃”或[不连续性](@entry_id:144108)。这种方法需要一个更复杂的关于[冲量](@entry_id:178343)和[互补问题](@entry_id:636575)的数学框架，但对于密集、缓慢变形的系统来说，它可能非常高效，因为它不需要解析碰撞的微小时间尺度。

### 不只是推力：摩擦与滚动

到目前为止，我们只考虑了正面推力。但当颗粒试图相互滑过时会发生什么呢？这就是**摩擦**的领域。

我们模拟摩擦的方式非常巧妙 [@problem_id:3504405]。想象一下，当两个颗粒接触时，它们之间会形成一个微小的切向弹簧，抵抗任何剪切运动。当它们试图滑动时，这个弹簧被拉伸，产生一个切向力。然而，这不是一个普通的弹簧。它有一个断裂点。它能施加的最大切向力受到著名的**[库仑摩擦定律](@entry_id:747943)**的限制：$|F_t| \le \mu |F_n|$，其中 $\mu$ 是[摩擦系数](@entry_id:150354)，而 $|F_n|$ 是将颗粒压在一起的法向力的大小。

这就创造了一种“弹性预测，塑性修正”的机制。我们首先假设切向弹簧只是弹性拉伸，计算出一个“试探”切向力。然后，我们检查其大小是否超过了库仑极限。如果超过了，颗粒就会滑移。我们通过将其大小缩减回极限值 $\mu |F_n|$ 来“修正”这个力。这捕捉了静摩擦（抵抗运动）和随后的[动摩擦](@entry_id:177897)（滑动）的真实世界行为。

此外，我们可以添加**[滚动阻力](@entry_id:754415)** [@problem_id:3504405]。让一个颗粒滚动通常比想象的要困难，特别是当颗粒不是完美的球体时。这被建模为一个抵抗两个颗粒之间滚动运动的力矩，从而进一步丰富了它们相互作用的物理内涵。

### 宏大的模拟循环：时间中的宇宙之舞

我们现在已经集齐了所有要素：用于运动的[牛顿定律](@entry_id:163541)和用于力的接触定律。模拟过程就像一场宏大的、在时间中迭代的舞蹈。在模拟时钟的每一个滴答，即一个**时间步长** $\Delta t$ 内，计算机会执行相同的操作序列：

1.  **寻找邻居：** 对每个颗粒，识别出所有与之接触的其他颗粒。
2.  **计算力：** 对每个接触，使用重叠量 $\delta$ 和相对速度 $v_n$，根据我们讨论过的接触定律计算法向力和切向力。将这些力与[体力](@entry_id:174230)（如重力）相加，得到作用在每个颗粒上的总力 $\mathbf{F}_{\text{total}}$ 和总力矩 $\mathbf{T}_{\text{total}}$。
3.  **更新运动：** 在已知力和力矩的情况下，使用[牛顿定律](@entry_id:163541)（$\mathbf{a} = \mathbf{F}_{\text{total}}/m$ 和 $\boldsymbol{\alpha} = \mathbf{T}_{\text{total}}/I$）来计算每个颗粒的加速度。
4.  **信念之跃：** 使用这些加速度来更新所有颗粒的速度和位置，将它们移动到下一个时间步 $t + \Delta t$ 时所在的位置。然后，循环重复。

关键步骤是第4步。我们究竟如何实现时间上的飞跃？一个简单的方法可能是说新速度等于旧速度加上加速度乘以 $\Delta t$。这是“前向欧拉”法，但它以不稳定和不准确而著称。一种好得多，甚至近乎神奇的方案是**显式[中心差分](@entry_id:173198)**法，也称为**蛙跳**积分法 [@problem_id:3507348]。

该方法的精妙之处在于**交错时间**。我们将颗粒位置 $\mathbf{x}$ 定义在整数时间步（$t^n, t^{n+1}, \dots$），而将速度 $\mathbf{v}$ 定义在*半*时间步（$t^{n-1/2}, t^{n+1/2}, \dots$）。更新分两个阶段进行：
1.  首先，我们“踢”一下速度。我们使用在完整步长 $t^n$ 处由力计算出的加速度 $\mathbf{a}^n$ 来将速度从前一个半步更新到下一个半步：
    $$
    \mathbf{v}^{n+1/2} = \mathbf{v}^{n-1/2} + \mathbf{a}^n \Delta t
    $$
2.  然后，我们“漂移”位置。我们使用这个新计算出的半步速度来将位置更新到下一个完整步长：
    $$
    \mathbf{x}^{n+1} = \mathbf{x}^n + \mathbf{v}^{n+1/2} \Delta t
    $$

这种速度和位置的蛙跳式更新非常稳定，并且具有[二阶精度](@entry_id:137876)，这意味着其误差随时间步长的平方而减小。它构成了大多数现代软球 DEM 程序的计算核心。

### 时间步长的束缚

这种显式积分方法功能强大，但有一个严格的规则：时间步长 $\Delta t$ 不能太大。如果在时间上跳跃得太大，颗粒可能会在模拟有机会计算排斥[接触力](@entry_id:165079)之前就直接穿过彼此。模拟会变得不稳定并崩溃。

存在一个硬性限制，即**[临界时间步长](@entry_id:178088)** $\Delta t_{\text{crit}}$，超过这个值，模拟必然会失败。通过一个称为[线性稳定性分析](@entry_id:154985)的过程，可以证明这个[临界时间步长](@entry_id:178088)由系统中的最高自然[振动频率](@entry_id:199185)决定。对于一个简单的[质量-弹簧系统](@entry_id:267496)，这个频率是 $\omega_0 = \sqrt{k/m}$。结果表明，[临界时间步长](@entry_id:178088)与该频率的倒数成正比 [@problem_id:3512661]：

$$
\Delta t_{\text{crit}} = 2\sqrt{\frac{m}{k}}
$$

这是 DEM 中最基本的权衡之一。要模拟非常刚性的材料（大的 $k$）或非常轻的颗粒（小的 $m$），我们必须采用极小的时间步长，这使得模拟的计算成本非常高。稳定性由信息（即机械波）穿过接触面的速度决定，而这个速度由刚度和惯性设定，而不是由能量耗散决定。

### 形状的艺术：超越完美球体

我们的世界不是由完美的弹珠构成的。沙粒有棱角，河卵石光滑但呈椭圆形，而药用粉末可以是针状的。形状对颗粒集合体的行为至关重要。但是我们如何在计算机中表示这些复杂的形状呢？主要有三种策略 [@problem_id:3504420]。

*   **团簇：** 最简单的方法是通过将多个可能重叠的球体“粘合”在一起，来构建复杂的形状。这就像用乐高积木搭建一样。其巨大优势在于，底层的接触检测仍然只是一系列简单的球-球检查。缺点是所得到的表面是“凹凸不平的”，这使得它难以捕捉圆形颗粒的光滑滚动。

*   **多面体：** 对于像沙子或碎石这样的棱角状颗粒，我们可以直接将它们表示为多面体——具有平坦面、直边和尖锐顶点的实体。接触检测更为复杂，通常使用一种称为分离轴定理的方法，但它能完美地捕捉到对面状和互锁的模拟，而这正是棱角[材料强度](@entry_id:158701)的关键。

*   **超[二次曲面](@entry_id:264390)：** 对于光滑但非球形的形状，如椭球体（土豆形状）或圆角立方体，我们可以使用一个单一、强大的数学方程，称为超二次曲面。这些形状具有连续变化的表面[法线](@entry_id:167651)和曲率。这使它们成为[精确模拟](@entry_id:749142)平滑滚动运动的理想选择。付出的代价是，检测两个超二次曲面之间的接触点是一个迭代的数值过程，这在计算上比其他方法更昂贵。

形状的选择是一个至关重要的建模决策，是在物理现实和计算可行性之间不断的权衡。

### 十亿个朋友的现实问题：寻找邻居

如果一个模拟有一百万个颗粒，检查每个颗粒与其他所有颗粒以寻找接触将涉及五千亿对组合——这是一项不可能完成的任务。幸运的是，一个颗粒只与其直接邻居相互作用。挑战在于如何高效地找到这些邻居。

标准解决方案是**单元格链接列表** [@problem_id:2416939]。我们将整个模拟[区域划分](@entry_id:748628)为一个由立方体单元格组成的网格。要找到给定颗粒的邻居，我们不需要搜索整个盒子；我们只需要查看该颗粒所在的单元格及其26个直接相邻的单元格（一个 $3 \times 3 \times 3$ 的区域）。这将搜索范围从与颗粒总数 $N$ 成正比缩小到与局部颗粒密度成正比。

但这有一个问题。这些单元格应该多大？如果它们太小，颗粒可能位于并非直接相邻的相邻单元格中。为了保证不错过任何接触，单元格边长 $a$ 必须至少与系统中*最大颗粒*的直径一样大：$a \ge 2 r_{\text{max}}$。这确保了任何两个接触的颗粒总是位于同一个单元格或相邻的单元格中。使用理论模型，我们甚至可以预测给定颗粒密度和搜索半径下邻居检查的预期次数，这有助于我们理解和优化模拟的性能 [@problem_id:3507320]。

### 见微知著：从颗粒到连续介质量

我们创造了一个细节惊人的虚拟世界，一个由推、滑和滚组成的微观世界。但是，建造大坝的工程师或研究断层的[地质学](@entry_id:142210)家通常想知道宏观属性，如**应力**和**应变**。我们如何从单个颗粒的微观世界跨越到连续介质力学的宏观世界？

DEM 为此提供了一个强大的工具：它充当了一个“虚拟实验室”。我们可以在模拟内部进行在真实实验中无法完成的测量。宏观应力张量 $\Sigma$，一种衡量材料内部[平均力](@entry_id:170826)的量，可以直接从微观[接触力](@entry_id:165079)计算出来。优美而深刻的 **Love-Weber 公式**为我们提供了方法 [@problem_id:3512683]：

$$
\Sigma = \frac{1}{V} \sum_c \mathbf{f}_c \otimes \mathbf{l}_c
$$

不要被张量符号（$\otimes$）吓到。其直观理解是：一个体积 $V$ 内的应力是其中所有接触“[力臂](@entry_id:162693)”的总和。每个接触 $c$ 贡献的一项是其力向量 $\mathbf{f}_c$ 与其“枝向量” $\mathbf{l}_c$ 的乘积，枝向量连接了两个接触颗粒的中心。这是一种精确的平均所有个体相互作用以揭示其集体、大规模效应的方法。

这种将离散颗粒尺度与连续介质属性联系起来的能力是 DEM 最强大的特性之一。它让我们能够问“为什么？”——为什么沙堆具有一定的强度？答案在于其组成颗粒之间的力网络，DEM 可以提供这个答案的精美细节。

最后，这种联系使我们能够构建更强大的模型。在许多问题中，我们只需要在某个小的、关键区域（如土壤中的[剪切带](@entry_id:183352)）使用 DEM 的精细细节，而周围的材料则表现得像一个简单的连续介质。我们可以创建**耦合模拟**，对复杂的颗粒区域使用 DEM，而在其他所有地方使用更高效的连续介质方法，如有限元法 (FEM) [@problem_id:3512630]。物理学本身为我们提供了决定在这两个世界之间划定界限的标准，这些标准基于颗粒尺寸与变形长度尺度的比率，以及“[惯性数](@entry_id:750626)”等量，[惯性数](@entry_id:750626)告诉我们流动是缓慢而密集，还是快速且具有碰撞性。这证明了力学的统一性，即对世界的这些不同描述可以如此无缝地缝合在一起。

