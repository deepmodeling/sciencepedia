## 引言
从患者病情严重程度被评为“轻度”、“中度”或“重度”，到调查问卷中的五星评分，我们的世界充满了有序[分类数据](@entry_id:202244)。虽然这种顺序比简单的标签提供了更多信息，但它也带来了独特的统计挑战：类别之间的距离是未知的，并且通常不相等。一个常见的错误是为这些水平分配数字，然后应用标准线性回归，这种做法违背了核心假设，并可能导致毫无意义的预测。正确的方法需要专门为数据的有序性质设计的模型。

其中最常见的是比例[优势模](@entry_id:263463)型，这是一种优雅的工具，它依赖于一个强大但有局限性的假设，即预测变量的效应在所有结果水平上是统一的。但当现实情况更为复杂时——例如，当一种治疗对严重疾病有很大影响，但对轻度病例影响很小时——会发生什么？忽视这种违背假设的情况会掩盖关键的洞见，并导致错误的结论。本文通过引入广义有序 Logit 模型来解决这个问题，这是一个灵活而稳健的框架，它尊重数据的真实复杂性。

我们将首先探究其**原理与机制**，从较简单方法的局限性开始，逐步介绍比例[优势模](@entry_id:263463)型及其“[平行线](@entry_id:169007)”假设。我们将学习如何检验这一假设，以及当假设不成立时，广义和部分比例[优势模](@entry_id:263463)型如何提供解决方案。然后，在**应用与跨学科联系**部分，我们将看到这些模型的实际应用，探索它们在临床医学、遗传学、流行病学和数据科学等不同领域带来的变革性影响，揭示它们作为科学发现多功能工具的强大力量。

## 原理与机制

### 数字的暴政与对秩序的追求

在我们试图理解世界的过程中，我们喜欢对事物进行分类。有些类别只是标签：例如，药物不良事件的类型可能是胃肠道、神经系统或血液系统。这些类别没有内在的顺序；它们只是不同的分类。我们称之为**名义** (nominal) 数据。但通常，我们的类别具有自然的顺序。患者的病情可能被描述为“无”、“轻度”、“中度”或“重度”。电影评论可能是一星、二星、三星、四星或五星。这就是**有序** (ordinal) 数据——顺序很重要，但水平之间的间距是未知且很可能不均匀的。从“轻度”到“中度”的严重程度跃升是否与从“中度”到“重度”的跃升相同？很可能不是。

一种自然但具有危险误导性的冲动是为这些类别分配数字——比如，用 $0, 1, 2, 3$ 代表疾病严重程度——然后将它们代入标准[线性[回](@entry_id:142318)归模型](@entry_id:163386) $Y = X\beta + \varepsilon$。这一简单行为违背了几个基本原则。线性回归假设结果变量 $Y$ 是连续的，并且值之间的差异是有意义且恒定的。它还假设误差 $\varepsilon$ 服从钟形高斯分布。但我们的结果不是连续的；它是一组离散、有界的类别。这意味着模型可能会做出荒谬的预测，比如严重程度为 $4.7$ 或 $-0.2$，这些在医学上是毫无意义的。此外，误差的方差将不是恒定的，这是该方法的另一个核心假设。对于名义数据，情况甚至更混乱；仅仅重新排列分配的数字（例如，$1, 2, 3$ 对比 $3, 1, 2$）就会产生完全不同且任意的结果 [@problem_id:4976125]。

为了正确地建模这[类数](@entry_id:156164)据，我们需要一个更复杂的工具，一个尊重类别性质的工具。这就是**[广义线性模型 (GLMs)](@entry_id:177658)** 的领域，该框架为处理不同类型的结果变量提供了有原则的方法。

### 概率阶梯：比例[优势模](@entry_id:263463)型

GLM 方法不是对类别的数值*值*进行建模，而是对观察到某个结果的*概率*进行建模。对于有序结果，一个特别优雅的想法是问：处于某个水平*或更低水平*的概率是多少？对于一个有 $K$ 个类别（例如，$1, 2, \dots, K$）的结果变量 $Y$，我们感兴趣的是每个可能的分[割点](@entry_id:637448) $k$ 的**累积概率**，即 $\mathbb{P}(Y \le k)$。

概率是一个介于 $0$ 和 $1$ 之间的数字。为了将其与预测变量的[线性组合](@entry_id:155091)（可以取任何实数值）联系起来，我们需要一个**[连接函数](@entry_id:636388) (link function)**，它能将 $(0, 1)$ [区间映射](@entry_id:194829)到 $(-\infty, \infty)$。最常见的选择是 **logit 函数**，它就是优势 (odds) 的自然对数：
$$
\operatorname{logit}(p) = \ln\left(\frac{p}{1-p}\right)
$$
现在我们可以构建我们的模型。我们将累积 logit 与我们的预测变量联系起来：
$$
\operatorname{logit}\{\mathbb{P}(Y \le k \mid x)\} = \alpha_k - x^{\top}\beta
$$
这就是著名的**累积 logit 模型**，更为人熟知的名字是**比例[优势模](@entry_id:263463)型**。让我们看看它的各个部分。$\alpha_k$ 值是特定于类别的截距，或称为**阈值**。你可以把它们想象成梯子上的横档。为了使模型在逻辑上一致——也就是说，为了使处于任何给定类别的概率为正——这些阈值必须严格有序：$\alpha_1  \alpha_2  \dots  \alpha_{K-1}$ [@problem_id:4988409]。

这个模型最美妙也最具限制性的部分是系数向量 $\beta$。注意它没有下标 $k$。对于每个累积 logit，对于梯子上的每个横档，它都是*相同*的。这就是**比例优势假设**。它意味着预测变量的效应在整个有序量表上是统一的。例如，如果一个预测变量 $x_j$ 的系数 $\beta_j$ 为正，这意味着增加 $x_j$ 会降低处于或低于任何给定水平 $k$ 的概率。换句话说，它将概率质量推向更高的类别，在严重程度量表中表示一个“更差”的结果 [@problem_id:4988409]。

### 平行线之美

比例优势假设在实践中意味着什么？它有一个惊人地简单的几何解释。如果你将累积概率的 logit，即 $\operatorname{logit}\{\mathbb{P}(Y \le k \mid x)\}$，对单个连续预测变量 $x$ 作图，你会得到一系列线——每个分[割点](@entry_id:637448) $k$ 一条。比例优势假设 $\beta_k = \beta$ 意味着所有这些线都具有*完全相同的斜率*。它们是平行的 [@problem_id:4821884]。

任何两条线之间的[垂直距离](@entry_id:176279)，比如说对于分割点 $k_1$ 和 $k_2$，就是 $\alpha_{k_2} - \alpha_{k_1}$，这是一个不依赖于预测变量 $x$ 的常数。这种平行性意味着预测变量的变化对优势比的影响是恒定的，无论我们考虑的是哪个阈值。$x$ 每增加一个单位的优势比是 $\exp(\beta)$，这个值对于从类别 1 变为更高类别的优势，与从类别 2 变为更高类别的优势是相同的，依此类推 [@problem_id:4821884]。这是一个极其优雅和简约的假设。它允许我们用一个单一的数字来概括一个预测变量的效应。

### 当自然拒绝简单

这种效应统一的假设虽然强大，但它真实吗？如果一种治疗在减轻严重症状方面非常有效，但对轻度症状几乎没有影响呢？在这种情况下，治疗的效应在整个有序量表上*不是*统一的。平行线不再平行。比例优势假设被违背了。

我们如何知道呢？我们必须检验这个假设。标准方法是将我们简单的、受约束的比例[优势模](@entry_id:263463)型与一个不施加此约束的更灵活的模型进行比较。这可以通过**似然比检验**来完成，该检验比较了两个模型的拟合优度，或者更常用的是一种称为 **Brant 检验**的 Wald 型检验 [@problem_id:4816597]。Brant 检验既提供了对所有预测变量组合的假设的全局评估，也为每个预测变量提供了单独的检验。这非常有用，因为它可以精确定位是哪些变量导致了违背。

想象一项研究，其中疾病严重程度由年龄、性别和 BMI 预测。Brant 检验可能会揭示整个模型违背了比例优势假设。仔细观察单个检验，我们可能会发现年龄的效应是高度非比例的，而性别和 BMI 的效应则完全符合该假设 [@problem_id:4929777]。年龄的斜率可能随着严重程度等级的上升而变强，表明在区分中度和重度疾病方面，年龄是一个比区分无病和轻度疾病重要得多的风险因素。

### 广义模型：告别平行

忽略对比例优势假设的违背可能会产生严重后果。如果一个预测变量的真实效应在较高的严重性水平上增强，但我们强迫模型使用单一的平均效应，模型将系统地低估最严重结果的风险。在医疗环境中，这可能导致灾难性的临床决策，例如未能识别出有高概率发生严重呼吸衰竭而需要立即进行 ICU 评估的患者 [@problem_id:4976167]。

解决方案是放宽这个假设。这就引出了**广义有序 Logit 模型**，也称为**非比例[优势模](@entry_id:263463)型**。方程看起来几乎一样，但有一个关键的变化：系数向量 $\beta$ 现在有了一个下标 $k$，允许它对每个分割点变化。
$$
\operatorname{logit}\{\mathbb{P}(Y \le k \mid x)\} = \theta_k - x^{\top}\beta_k
$$
这个模型要灵活得多。它实际上相当于为 $K-1$ 个累积分割点中的每一个拟合一个单独的二元 logistic 回归。这种灵活性是以复杂性为代价的；该模型有 $(K-1)(p+1)$ 个回归参数，而比例[优势模](@entry_id:263463)型只有 $(K-1) + p$ 个 [@problem_id:4976173]。

然而，我们不必因噎废食。如果我们的诊断检验（如 Brant 检验）显示，众多预测变量中只有一个违背了假设，那么让*所有*预测变量都具有非比例效应将是一种浪费。这就引出了广义框架最实用和最强大的应用：**部分比例优势 (PPO) 模型**。

在 PPO 模型中，我们将预测变量分为两组：一个向量 $\mathbf{z}$ 用于满足比例优势假设的预测变量，一个向量 $\mathbf{w}$ 用于不满足的预测变量。模型变为：
$$
\operatorname{logit}\{\mathbb{P}(Y \le k \mid \mathbf{z},\mathbf{w})\} = \alpha_k - \mathbf{z}^{\top}\boldsymbol{\beta} - \mathbf{w}^{\top}\boldsymbol{\gamma}_k
$$
在这里，$\mathbf{z}$ 中预测变量的效应由一个单一的、共同的向量 $\boldsymbol{\beta}$ 捕获，而 $\mathbf{w}$ 中预测变量的效应由特定于分[割点](@entry_id:637448)的向量 $\boldsymbol{\gamma}_k$ 捕获 [@problem_id:4821877]。这种混合方法提供了一个美妙的折衷，既提供了准确建模数据所需的灵活性，又在合理的情况下保留了比例优势假设的[简约性](@entry_id:141352)和简单性。

### 一个充满选择的世界

广义有序 logit 模型及其相关模型是用于有序数据的更大家族模型的一部分，每个模型都有不同的理念。例如，**相邻类别 logit 模型**不关注累积概率，而是对处于类别 $k+1$ 与相邻类别 $k$ 的优势比进行建模。这在相邻状态之间的转换是主要关注点时特别有用，例如在调查中从“不同意”转变为“中立” [@problem_id:4929812]。

如果预测变量的效应如此不稳定，以至于结果的顺序对于模型似乎失去了所有意义，我们总是可以退回到**基线类别多项 logistic 回归**，该模型将结果视为纯粹的名义变量，完全忽略其顺序 [@problem_id:4929803]。这是最灵活的模型，但如果存在真实的有序结构，它也是最不强大的。

这揭示了[统计建模](@entry_id:272466)中深刻的统一性。从简单的线性回归到复杂的局部比例[优势模](@entry_id:263463)型的旅程，是一个日益尊重我们数据性质的旅程。通过从一个简单、优雅的假设开始并对其进行严格的检验，我们被引向一系列模型，这些模型使我们能够以准确和优雅的方式捕捉世界的复杂性。艺术不在于找到一个单一的“正确”模型，而在于选择一个其假设最能反映我们数据试图讲述的故事的模型。

