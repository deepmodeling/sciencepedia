## 引言
为了理解个体在疾病与健康之间的复杂历程，研究人员需要一张清晰且可量化的路[线图](@entry_id:264599)。疾病-死亡模型正是提供了这样一个强大的框架，它将疾病的进展简化为一系列明确的状态以及状态之间的转移。然而，要准确地为这一历程建模是具有挑战性的；我们必须考虑竞争事件（如因其他原因死亡），并处理现实世界医学研究中固有的不完整数据。本文旨在揭示疾病-死亡模型的奥秘，为其结构和效用提供一份全面的指南。

第一章“原理与机制”将解构该模型的核心组成部分。我们将探讨状态、转移以及驱动系统运行的转移强度等基本概念。您将了解到不同的“时钟”和时间尺度——从简单的马尔可夫假设到更灵活的半马尔可夫方法——如何让模型能够捕捉疾病进展的微妙现实。随后，“应用与跨学科联系”一章将展示该模型巨大的实际影响力。我们将看到它如何为流行病学提供一种清晰的语言，为处理删失数据的统计学家提供一个强大的工具包，并为从公共卫生到医学心理学等领域的现实模型构建提供一个灵活的支架。

## 原理与机制

为了理解世界，物理学家常常从简化入手。他们可能会想象一个无摩擦的表面或一头完美的球形奶牛。在医学和生物学中，我们也可以做类似的事情。为了理解一个人在疾病与健康之间的复杂历程，我们可以将其简化为几个基本阶段。这正是疾病-死亡模型的核心：它是一张生命历程中各种转移的地图。

### 生命通道图：状态与转移

让我们从绘制这张地图开始。我们可以将一个人的健康状况想象为处于几个不同**状态**之一。对于一种慢性进展性疾病，最简单而有用的地图包含三个状态：状态0（“健康”）、状态1（“患病”）和状态2（“死亡”）。在任何时间点，我们研究中的每个个体都精确地处于这三种状态之一 [@problem_id:5214789]。

但是，一张只有位置的地图用处不大；我们还需要连接它们的道路。这些道路就是**转移**。常识和生物学告诉我们哪些路是通的，哪些是堵的。一个健康的人可能会生病（从 $0 \to 1$ 的转移）。一个患病的人不幸可能会死亡（从 $1 \to 2$ 的转移）。而一个健康的人也可能因为其他原因（如意外事故）死亡，而从未患上我们正在研究的特定疾病（从 $0 \to 2$ 的转移）。

反过来的情况呢？对于一种真正的进展性疾病，不存在康复，因此从“患病”回到“健康”的道路（$1 \to 0$）是关闭的。当然，死亡是一条单行道；没有路可以从“死亡”状态通向别处（$2 \to 0$ 或 $2 \to 1$）。用数学的语言来说，我们称“健康”和“患病”状态为**瞬时**状态——它们是可以经过的地方。而“死亡”状态被称为**吸收**状态，因为一旦进入，就永远无法离开 [@problem_id:4815972]。我们这张由这些逻辑规则支配的简单地图，只有三条单行道：$0 \to 1$、$0 \to 2$ 和 $1 \to 2$。这个优雅而简单的结构构成了我们模型的骨架。

### 变化的引擎：转移强度

现在我们有了一张地图，但是什么使得事物移动呢？是什么驱动个体从一个状态转移到另一个状态？我们模型的引擎是一个称为**转移强度**或**[风险率](@entry_id:266388)**的概念，通常用希腊字母 lambda（$\lambda$）表示。

你可以将 $\lambda$ 理解为一种瞬时的“倾向”或单位时间内的概率。它就像放射性物质的[衰变常数](@entry_id:149530)。如果你有一个放射性原子，你无法知道它何时会衰变。但你知道它的[衰变常数](@entry_id:149530)，这个常数告诉你它在下一个极小时间片内衰变的概率。这里也是同理。对于一个处于状态0的个体，存在一个生病的强度 $\lambda_{01}$ 和一个因其他原因死亡的独立强度 $\lambda_{02}$。

这就引出了一个优美而核心的思想：**[竞争风险](@entry_id:173277)**。在每一刻，一个健康的个体都处在一场竞赛的中心。是通往疾病的道路（$0 \to 1$）会胜出，还是通往死亡的道路（$0 \to 2$）会胜出？$\lambda_{01}$ 和 $\lambda_{02}$ 的相对大小决定了胜算。这场竞赛的一个重要规则是，在任何无穷小的时间段内，只能发生一次转移。离开“健康”状态的总倾向就是所有可能出口的倾向之和：$\lambda_{\text{total exit from 0}} = \lambda_{01} + \lambda_{02}$ [@problem_id:5214772]。这种可加性使得数学处理异常简洁。强度 $\lambda_{01}$ 本身是一个基本参数；它代表了纯粹的、潜在的患病风险，与死亡这一竞争事件的风险是分开的 [@problem_id:5214772]。

### 时钟的支配：时间、记忆与马尔可夫

所以，我们有了状态、转移和速率。但我们的故事里还缺少一个角色：时间。这些速率，这些 $\lambda$ 值，在人的一生中是恒定的吗？

最简单的假设是“是”。一个所有 $\lambda$ 值都恒定的模型被称为**时齐马尔可夫模型**。这会带来一个著名的推论：在任何状态的“等待时间”都服从指数分布。这是一个真正[无记忆过程](@entry_id:267313)的标志。就像我们的放射性原子一样，系统不记得它在当前状态停留了多久。无论它是刚到达还是已经停留了多年，它在下一秒发生转移的几率都是相同的 [@problem_id:4962147]。

但这对于人来说很少成立。你患大多数疾病的风险并不是恒定的，它会随着年龄的增长而变化。这就引导我们走向一个更现实的模型：**时非齐次马尔可夫模型**。在这里，转移强度是时间的函数，例如年龄：$\lambda_{01}(t)$。

这提出了一个深刻的问题。如果转移率随时间变化，这是否意味着过程现在有了“记忆”？如果等待时间不再是[指数分布](@entry_id:273894)，这个过程还是马尔可夫和“无记忆”的吗？答案是一个微妙而优美的“是” [@problem_id:5214790]。这个过程仍然是马尔可夫的，因为未来*仅仅*取决于*当前*状态和*当前*时间。要预测接下来会发生什么，我只需要知道你现在是“健康”的，并且你的年龄是50岁。我不需要知道你保持健康了多久。非指数的等待时间并非源于过程记住了自己的过去，而是因为世界的“规则”（即 $\lambda$ 值）随着主时间时钟的推移而改变。

这个“主时钟”不一定非得是年龄。在流行病学中，我们可以从几种不同的**时间尺度**中选择 [@problem_id:4975737]：
*   **年龄：** 生物学时钟，捕捉自然的衰老过程。
*   **日历时间：** 历史时钟，捕捉外部变化，如新疫苗的引入或新的环境毒素。
*   **自研究入组以来的时间：** 用于临床试验的实用时钟。

这些都是**时钟前进**方案的例子：时钟一旦启动，就不会停止或重置。相对于所选的时钟，模型仍然是马尔可夫的。

### 个人时钟：半马尔可夫思想

但如果最重要的时钟是个人化的呢？想象一个场景，一个病人在医院里感染了。他此后的死亡风险取决于他的年龄吗？也许是。但似乎更有可能取决于*自他感染以来经过了多长时间*。

这一洞见引出了一个强大的推广，称为**半马尔可夫模型** [@problem_id:4975707]。在这里，我们使用一种**时钟重置**方案 [@problem_id:4975737]。当一个个体转移到“患病”状态时，我们为他们启动一个个人秒表。从“患病”到“死亡”的转移强度 $\lambda_{12}(u)$ 现在是那个个人秒表上的时间 $u$ 的函数——也就是自患病以来的时间。

在日历时间或年龄时间尺度上，这不再是一个严格的[马尔可夫过程](@entry_id:160396)，因为要预测未来，你不仅需要知道当前状态和当前年龄，还需要知道个人秒表是何时开始计时的。这种“时钟重置”的思想带来了极大的灵活性。例如，我们可以对一种风险进行建模，它在诊断后立即达到非常高的水平，然后随时间递减，这是许多疾病的常见模式。

### 从原理到概率：讲述生命故事

我们如何将这套优雅的理论机制与混乱的现实患者数据联系起来？这座桥梁由两个关键部分构建：**风险人群**和**似然**。

在任何给定时刻 $t$，谁有可能从“健康”状态转移到“患病”状态？只有那些当前处于“健康”状态且正在被观察的人。这个群体就是针对该特定转移的**风险**人群 [@problem_id:4643087]。在一个极小的时间间隔内，我们预期看到的新发病例总数就是个体速率 $\lambda_{01}(t)$ 乘以这个风险集中的人数。

这引出了该模型最卓越的成就：它能够描述个体整个生命故事的概率。任何观察到的历史——比如在时间 $T_1$ 生病，在时间 $T_2$ 死亡——的概率都可以写成生存概率和瞬时风险的乘积 [@problem_id:4975727, @problem_id:5214772]。

*   保持健康直到 $T_1$ 然后生病的概率是：  
    （在状态0中存活到 $T_1$ 的概率） $\times$ （在 $T_1$ 时的风险 $\lambda_{01}$）。
*   接着从 $T_1$ 到 $T_2$ 保持患病状态然后在 $T_2$ 死亡的概率是：  
    （在状态1中从 $T_1$ 存活到 $T_2$ 的概率） $\times$ （在 $T_2$ 时的风险 $\lambda_{12}$）。

整个生命路径的似然就是这些部分的乘积。通过观察一个真实队列中成千上万个这样的生命故事，我们可以使用统计方法来找到潜在的[强度函数](@entry_id:755508)，即那些使观察到的故事最可能发生的 $\lambda(t)$。一旦我们得到了它们，我们就可以计算出关键的量，比如**累积发生函数**——一个健康的人在某个年龄之前患病的真实世界概率，这个计算正确地考虑了先于患病而死亡的[竞争风险](@entry_id:173277) [@problem_id:5214772]。

### 超越预测：提出“如果...会怎样？”

一个科学模型的真正力量不仅在于描述世界本来的样子，还在于它让我们能够探究如果情况有所不同世界会变成什么样。考虑一种人们可以康复的疾病，这意味着从“患病”回到“健康”的转移（$1 \to 0$）现在是可能的。模型可以轻松处理这种情况；我们只需在地图上开辟一条新路。

但我们可以更进一步。我们可以提出一个因果问题：康复的可能性在多大程度上真正有助于防止死亡？利用我们的模型，我们可以通过在数学上将康复强度 $\lambda_{10}(t)$ 设置为零，来模拟一个康复不可能发生的假想世界。然后，我们可以计算在这个反事实世界中到时间 $t$ 为止的总死亡概率，并将其与真实世界中的死亡概率进行比较。两者之差精确地告诉我们康复途径的净效益 [@problem_id:5214850]。

这是模型效用的终极体现。从一张由状态和转移构成的简单地图出发，由强度引擎驱动，并由不同的时间时钟引导，我们构建了一台机器，它不仅能预测人类生命在健康与疾病间的流动，还允许我们探索改变这种流动的后果。它是一种理解的工具，一个将生命这幅复杂织锦带入清晰、量化焦点的透镜。

