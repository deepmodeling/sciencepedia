## 引言
在理解宇宙的宏伟事业中，天文学家面临一个根本性的限制：我们只有一个宇宙可供观测。我们无法用不同的参数重新进行大爆炸，也无法创建一个对照组来分离变量。为了克服这一困难，宇宙学家们构建了**模拟星系表**——源于我们最佳物理理论和计算能力的详尽的[模拟宇宙](@entry_id:754872)。这些宇宙复制品不仅仅是奇珍异物；它们是[现代宇宙学](@entry_id:752086)不可或ax缺的实验室，让我们能够检验我们的方法，量化我们的不确定性，并解读我们从真实望远镜收集的数据。本文将深入探讨构建和使用这些合成宇宙的艺术与科学。

首先，在“原理与机制”一章中，我们将探索构建模拟星系表的复杂过程，遵循物理学基本定律所设定的配方。我们将从模拟宇宙中不可见的暗物质骨架开始，到为其“描绘”上星系，最后通过一个模仿真实巡天缺陷的虚拟望远镜来“观测”它。然后，在“应用与跨学科联系”一章中，我们将揭示这些模拟星系表的深远价值。我们将看到它们如何成为大型天文巡天的终极彩排，如何充当宇宙学宏大尺度与[星系演化](@entry_id:158840)复杂细节之间的桥梁，并如何助力我们在现实的结构中寻找[新物理学](@entry_id:161802)。

## 原理与机制

要构建一个合成宇宙，我们不能简单地凭空变出星系。我们必须遵循物理定律所奠定的宏伟配方。我们的任务类似于一位神圣的钟表匠，但他不仅要制造钟表的机械结构，还必须重现从特定视角、通过一个真实的、不完美的镜头所看到的时钟外观。这个过程是[引力](@entry_id:175476)理论、天体物理学和[统计建模](@entry_id:272466)之间美妙的 interplay。让我们来逐层揭开这个宇宙构建过程的面纱。

### 宇宙骨架：模拟暗物质

一切始于[引力](@entry_id:175476)。我们所见的宇宙，及其错综复杂的星系与空洞之网，是由一种我们看不见的物质所塑造的：**暗物质**。构建模拟星系表的第一步，也是最关键的一步，是模拟这个不可见的宇宙骨架的形成。

想象一个巨大的、不断膨胀的盒子，里面充满了代表暗物质的粒[子群](@entry_id:146164)。在时间的开端（或接近开端时），这些粒子几乎是完美[均匀分布](@entry_id:194597)的。但“几乎”是宇宙学中最重要的词。原始汤中微小的量子尺度涨落，使得某些区域获得了微不足道的额外质量。[引力](@entry_id:175476)，无情而耐心，开始发挥作用。在数十亿年的时间里，它将物质从稍微空旷的区域拉到稍微稠密的区域。富者愈富，贫者愈贫。这就是**宇宙网**的编织方式：稠密的节点由长长的纤维连接，环绕着巨大的空洞。

为了对此建模，宇宙学家使用强大的**[N体模拟](@entry_id:157492)**。这些是计算领域的巨兽，它们在数千个小的时间步长上计算每个粒子来自所有其他粒子的[引力](@entry_id:175476)。这是精确度的黄金标准，捕捉了[引力](@entry_id:175476)完整、复杂、[非线性](@entry_id:637147)的舞蹈[@problem_id:3477623]。然而，对于许多应用来说，这种细节水平的计算成本高得令人望而却步。科学家们已经开发出巧妙、更快的近似方法，如**COLA（共动拉格朗日加速）**，它对大尺度的推拉作用使用理论捷径，同时将繁重的计算留给那些至关重要的稠密、复杂区域[@problem_id:3477623]。

此类模拟的输出是在宇宙不同时刻的暗物[质粒](@entry_id:263777)子表。但星系并不会在任何地方形成；它们诞生于宇宙网最稠密的节点内，称为**暗物质晕**。因此，我们的下一个任务就是找到这些晕。诸如**朋友的朋友（FOF）**算法将“足够近”的粒子连接在一起，视为同一群体的成员；而其他算法，如**球状超密度（SO）**，则寻找超过某个密度阈值的球形区域。这些方法之间的选择不仅是技术性的；因为它们对晕边界的定义不同，可能导致系统性不同的质量。在一个方法上校准的HOD模型，如果应用于另一个方法，可能会给出有偏的结果，从而影响预测的[星系成团](@entry_id:158300)性[@problem id:3477582]。这提醒我们，即使在虚拟宇宙中，我们的测量选择也会产生后果。

### 从快照到流淌的时间长河：光锥

模拟为我们提供了一系列三维“快照”——在特定宇宙时刻宇宙的完美定格画面。但这并不是我们仰望天空时所看到的景象。因为光以有限的速度传播，所以向外太空看也就是[回溯时间](@entry_id:260844)。仙女座星系距离我们250万光年，所以我们看到的是它250万年前的样子。一个[红移](@entry_id:159945)$z=1$的星系，我们看到的是它在70多亿年前的样子。

因此，一个真实的模拟星系表不能是单一的快照。它必须是一个**过去[光锥](@entry_id:158105)**，一个四维结构，捕捉了位于空间和时间中单一一点（我们，此时此地）的单一观测者所能看到的一切[@problem_id:3512740]。想象一下站在宇宙的中心。你看到的星系并非都处于相同的宇宙年龄。近处的星系年老、成熟，我们看到的是它们“今天”的样子。远处的星系则年轻，我们看到的是它们处于宇宙婴儿期的样子。

为了构建这个[光锥](@entry_id:158105)，我们必须将模拟快照之间的点连接起来。我们从虚拟望远镜出发，沿时间向后追溯光的路径。如果一个星系的轨迹与这条路径相交，它就被放置在光锥上。将观测到的星系红移$z$与其[共动距离](@entry_id:158059)$\chi$（它在膨胀的宇宙网格上的距离）联系起来的基本关系由一个积分给出：

$$
\chi(z) = c \int_{0}^{z} \frac{dz'}{H(z')}
$$

在这里，$H(z')$是[红移](@entry_id:159945)$z'$时的哈勃膨胀率，$c$是光速。这个方程告诉我们一个深刻的故事：要找到一个物体的距离，我们必须将光到达我们这里的旅程中所有微小的步长加起来，同时考虑到空间膨胀是如何拉伸这些步长的[@problem_id:3512740]。

由于我们的模拟仅在离散的时间点提供数据，我们必须在快照之间对粒子的位置和速度进行插值。简单的[线性插值](@entry_id:137092)假设粒子以恒定速度沿直线运动，这是不符合物理现实的——[引力](@entry_id:175476)总是在加速它们。这可能导致人为瑕疵，即粒子路径不正确地[交叉](@entry_id:147634)，导致它们在光锥上出现多次或根本不出现。为避免这种情况，人们使用了复杂的**三次[Hermite插值](@entry_id:168921)**方法。通过同时使用快照中的位置和速度信息，这项技术创造了一个更平滑、更符合物理现实的轨迹，它考虑了加速度，从而大大减少了此类“[壳层穿越](@entry_id:754769)”瑕疵，并确保每个星系在我们的模拟历史书中只出现一次[@problem_id:3477590]。

### 为骨架穿上外衣：向[暗物质晕](@entry_id:147523)填充星系

我们现在有了一个 populated with dark matter halos 的光锥，每个晕都有已知的质量以及在空间和时间中的位置。但是巡天观测的是发光的星系，而不是不可见的[暗物质晕](@entry_id:147523)。下一步是为这个暗物质骨架“描绘”上星系。这是通过一种称为**晕占有数[分布](@entry_id:182848)（HOD）**的统计配方来完成的[@problem_id:3477520]。

HOD框架建立在一个简单而强大的理念之上：一个晕内部星系的属性，在很大程度上由该晕的质量决定。它将星系分为两种类型：

1.  **中心星系：** 每个大质量晕被认为在其[引力](@entry_id:175476)中心拥有一个单一的主导星系。一个质量为$M$的晕拥有一个比某个巡天极限更亮的中心星系的概率，通常用一个平滑的[阶跃函数](@entry_id:159192)来建模，这反映了质量越大的晕越有可能拥有明亮的星系。
2.  **卫星星系：** 质量更大的晕还可以拥有一群较小的卫星星系，它们是其他被捕获和并合的晕的残余。卫星星系的平均数量被建模为晕质量的[幂律](@entry_id:143404)函数。

一个标准的五参数HOD模型提供了一个完整的配方：首先，根据晕的质量决定它是否有一个中心星系。如果有，则从一个泊松分布中抽取一定数量的卫星星系，该[分布](@entry_id:182848)的均值也取决于晕的质量。中心星系被放置在晕的中心，而卫星星系则[分布](@entry_id:182848)在晕内，通常遵循与暗物质本身相同的密度轮廓（一个NFW轮廓）[@problem_id:3477520]。这种统计性的“描绘”过程在再现观测到的、跨越很大尺度范围的[星系成团](@entry_id:158300)性方面非常成功。

### 透过镜子：模仿观测行为

我们的虚拟宇宙现在充满了星系，每个星系都有其固有的亮度和大小，并被正确地放置在空间和时间中。但任务尚未完成。我们现在必须用我们的虚拟望远鏡来“观测”这个宇宙，忠实地模仿真实天文巡天的所有复杂性和不完美之处。

首先，我们必须将模拟星系的内在属性转化为我们实际测量的量：[视星等](@entry_id:158988)（流量）和[角大小](@entry_id:195896)。这需要我们理解在膨胀宇宙中距离是如何运作的。用于确定物体[角大小](@entry_id:195896)（$\theta = \text{size} / D_A$）的距离是**[角直径距离](@entry_id:157817)**$D_A$。用于确定其视亮度（$F = L / (4\pi D_L^2)$）的距离是**[光度距离](@entry_id:159432)**$D_L$。

在我们日常的静态世界里，这些距离是相同的。但在膨胀的宇宙中，它们则不然。由于红移，[光子](@entry_id:145192)会损失能量并以较低的频率到达，使得遥远物体看起来比其几何距离所暗示的要暗得多。这导致了一个优美简单但又深刻的关系，称为**Etherington[互易定理](@entry_id:267731)**：

$$
D_L = (1+z)^2 D_A
$$

这个方程在任何[光子](@entry_id:145192)守恒的[度规引力理论](@entry_id:272070)中都成立，是观测宇宙学的基石。它告诉我们，一个[红移](@entry_id:159945)为$z$的星系看起来比你根据其[视大小](@entry_id:195896)所预期的要暗$(1+z)^2$倍[@problem_id:3477470]。在正确模拟哪些星系足够亮以被我们的巡天探测到时，必须考虑到这一点。我们还必须应用**K改正**，以解释星系的光被[红移](@entry_id:159945)了，因此我们的望远镜观测到的是其静止[坐标系](@entry_id:156346)[光谱](@entry_id:185632)中与近邻星系不同的部分[@problem_id:3512740]。

接下来，我们必须对巡天的局限性进行建模。一个真实的巡天并不会探测到每一个星系。一个给定位置、亮度和[红移](@entry_id:159945)的星系最终进入最终星系表的概率由**选择函数**$S(\vec{\theta}, m, z)$描述[@problem_id:3512715]。这个函数是许多因素的乘积：

*   **巡天足迹：** 望远镜只指向天空的特定部分，明亮恒星周围的区域通常会被遮蔽。
*   **拥挤与碰撞：** 许多[光谱](@entry_id:185632)巡天使用[光纤](@entry_id:273502)同时收集来自多个星系的光。这些[光纤](@entry_id:273502)有物理尺寸，不能放得太近。如果两个目标星系比这个最小间距更近，就只有一个能被观测到——这种现象称为**[光纤](@entry_id:273502)碰撞**。这种效应在天空较稠密的区域更为严重，可以通过计算一个星系在其[禁区](@entry_id:175956)内有“竞争者”的概率来建模[@problem_id:3512787]。
*   **红移成功率：** 即使一个星系被选为目标，它的光可能太暗，或者夜空太亮，以至于无法获得高质量的[光谱](@entry_id:185632)来测量一个可靠的红移。这个**红移成功概率**可以通过计算观测的预期信噪比（SNR）来建模，该信噪比取决于星系的亮度、大小、天空背景以及望远镜的效率[@problem_id:3512787]。

通过应用这个多方面的选择函数，我们“稀疏化”了我们完美的底层星系表，只保留那些真实巡天很可能探测到并正确测量的星系。结果是一个在统计上与真实数据看起来相同的模拟星系表，包括其所有瑕疵。

### 超越牛顿：最宏大尺度上的宇宙

几十年来，[宇宙学模拟](@entry_id:747928)一直基于一个绝妙的简化：它们在广义相对论（GR）规定的平滑膨胀背景下，使用[牛顿定律](@entry_id:163541)来[模拟引力](@entry_id:144870)。这在大多数情况下效果惊人地好。然而，随着我们的巡天探测到越来越大的体积，达到与可观测宇宙[视界](@entry_id:746488)相当的尺度时，这个近似开始出现问题。

在这些超大尺度上，广义相对论揭示出，观测到的星系属性不仅受其局部环境的影响。[时空结构](@entry_id:158931)本身，当它被宇宙网扭曲时，会在光线传播到我们这里的过程中留下印记。观测到的星系红移不仅受到宇宙膨胀及其[本动速度](@entry_id:157964)的贡献，还受到源和观测者处的引力势（**[Sachs-Wolfe效应](@entry_id:161393)**）以及视线路径上变化的引力势的积分效应（**积分[Sachs-Wolfe效应](@entry_id:161393)**）的贡献。星系的视位置因**[引力透镜效应](@entry_id:159000)**而偏转，其观测到的[数密度](@entry_id:268986)也因这些投影效应而改变[@problem_id:3477620]。

标准的牛顿[光锥](@entry_id:158105)忽略了这些微妙但至关重要的广义相对论效应。为了捕捉它们，新一代的模拟星系表正在被开发出来。一些方法对牛顿模拟的输出进行后处理，从密度场计算出GR度规势，然后通过这个受扰动的时空进行光线追迹。另一些方法则使用新颖的**相对论性N体程序**，它们与粒子运动一起求解完整的爱因斯坦场方程[@problem id:3477620][@problem_id:3477620]。这些尖端技术对于正确解释最大尺度上的[星系成团](@entry_id:158300)性至关重要，使我们能够[检验广义相对论](@entry_id:157504)本身，并探测我们宇宙的基本性质。因此，构建模拟星系表不是一个已解决的问题，而是一个不断发展的领域，推动着计算和我们对[引力](@entry_id:175476)理解的边界。

