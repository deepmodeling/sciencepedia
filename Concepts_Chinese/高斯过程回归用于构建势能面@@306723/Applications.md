## 应用与跨学科联系

在理解了[高斯过程](@article_id:323592) (GP) 如何学习[势能面 (PES)](@article_id:323827) 的原理之后，我们现在转向旅程中最激动人心的部分。了解游戏规则是一回事，精通游戏则是另一回事。本章将探讨我们能以何种优美且常常出人意料的方式来*使用*这些学到的[曲面](@article_id:331153)。如果说上一章是关于学习如何绘制一幅详尽的分子世界地图，那么本章就是关于构建能够阅读这幅地图去探索、发现乃至创造的智能机器。

[高斯过程回归](@article_id:339718) (GPR) 的真正威力并不仅仅在于它能够插值数据点以创建平滑[曲面](@article_id:331153)——许多方法都能做到这一点。它的魔力来自于其两个输出的结合：*均值预测*，即我们[对势能](@article_id:381748)面的最佳猜测；以及*后验方差*，即对其自身不确定性的一个有原则的、诚实的度量。它给我们的不仅仅是一张地图，而是一张知道自己边界在哪里、知道哪里地形险恶未知的地图。这种结合将蛮力的计算劳动转变为与我们的自然模型之间智能的、交互式的对话。

### 智能探索的艺术：[主动学习](@article_id:318217)

GPR 最直接、最深刻的应用之一就是指导科学过程本身。生成[势能面](@article_id:307856)上数据点所需的计算通常极其昂贵。我们无法承担用计算点覆盖整个[势能面](@article_id:307856)的代价。我们必须有所选择。但该如何选择呢？

最基本的问题是，我们应该从哪里开始。如果我们只有少数几次初始计算的预算，我们应该将这些计算点放在哪里才能学到最多信息？一个朴素的方法可能是在一个简单的网格上取点。但 GPR 通过其核函数告诉我们一些更深层次的东西。点与点之间的相关性取决于在由核函数长度尺度 $\ell_j$ 缩放的空间中的“距离”。如果能量相对于某个坐标变化迅速，其长度尺度就会很短；如果变化缓慢，长度尺度就会很长。为了最大化[信息量](@article_id:333051)，我们的目标应该是在这个具有物理意义的缩放空间中，而不是在原始坐标空间中，创建一个“空间填充”设计。此外，对于具有对称性的分子——比如水分子，其中两个 O-H 键是相同的——计算在 $(r_1, r_2, \theta)$ 处的能量与在 $(r_2, r_1, \theta)$ 处提供的信息完全相同。一个智能的采样策略必须尊重这种对称性，仅在唯一的、非冗余的区域内放置点。通过结合这些原则——在缩放坐标中进行空间填充设计，限制在唯一的对称域内，并可能预先筛选以避免能量极高的区域——我们可以从一开始就构建一个[信息量](@article_id:333051)最大的初始[训练集](@article_id:640691) [@problem_id:2455982]。

当我们从静态采样转向动态模拟时，这种“[主动学习](@article_id:318217)”的理念才真正焕发生机。想象一下，我们使用 GPR 模型预测的力来运行[分子动力学](@article_id:379244) (MD) 模拟。这个模拟速度很快，因为我们不是在每个飞秒都进行[量子化学](@article_id:300637)计算。但是，当分子漫游到一个远离我们任何训练数据的构型时会发生什么？我们信赖的 GPR 模型，我们的地图，突然变得不可靠了。我们怎么知道的？GPR 会告诉我们！

由于[微分](@article_id:319122)是线性运算，能量上的[高斯过程](@article_id:323592)意味着力（$\mathbf{f} = -\nabla E$）上的[高斯过程](@article_id:323592)。在任何一点 $\mathbf{q}$，我们的模型不仅提供一个均值力矢量 $\boldsymbol{\mu}_f(\mathbf{q})$，还提供一个完整的力[协方差矩阵](@article_id:299603) $\boldsymbol{\Sigma}_f(\mathbf{q})$。这个矩阵的迹 $\operatorname{tr}(\boldsymbol{\Sigma}_f(\mathbf{q}))$ 代表了模型在力矢量上的总预期平方误差。我们可以为这个不确定性设置一个阈值。在 MD 模拟过程中，我们在每一步都监控这个值。如果它超过了我们的容忍度，模拟就会暂停。GPR 实际上举起了手说：“我在这里不再自信了！”然后，我们就在那个精确的几何构型上进行一次昂贵的、高保真度的[量子计算](@article_id:303150)，将新的数据点添加到我们的训练集中，并即时重新训练模型。然后模拟继续进行，现在有了一张在最需要的地方被精确扩展和修正过的地图。这就创建了一个强大的、自我完善的工作流，它只学习与动力学实际相关的[势能面](@article_id:307856)区域 [@problem_id:2455954]。

同样的目标导向搜索原则可以用来寻找[势能面](@article_id:307856)的特定重要特征，例如过渡态或[最小能量路径](@article_id:343030) (MEP)。为了找到过渡态——[势能面](@article_id:307856)上的一个“山口”——我们正在寻找沿着[反应坐标](@article_id:316656)的能量最大值。我们可以设计一个“[采集函数](@article_id:348126)”来引导我们的搜索。这个函数可能是预测能量（我们想往上走，所以对预测能量高的区域感兴趣）和预测不确定性（我们想探索模型不确定的区域）的组合。在每一步，我们都在使这个[采集函数](@article_id:348126)最大化的点上进行一次新的计算。这在利用我们现有知识和探索未知之间取得了平衡，使我们能够快速收敛到[过渡态](@article_id:313517)，而无需绘制整个周围的“景观” [@problem_id:2456010]。类似地，为了找到连接两个“山谷”的[最小能量路径](@article_id:343030)，我们可以使用 GPR 均值[曲面](@article_id:331153)的解析梯度作为真实力的替代品，并将其输入到标准路径寻找[算法](@article_id:331821)中，如[微动弹性带](@article_id:324214) (NEB) 方法。或者，在一种更复杂的方法中，我们可以将搜索构建为一个[泛函优化](@article_id:355092)问题：找到使最大能垒最小化的路径，并利用 GP 的不确定性来指导路径的优化 [@problem_id:2455969]。

### 以更少成本构建更好模型：多保真度与[迁移学习](@article_id:357432)

到目前为止，我们一直将[量子计算](@article_id:303150)视为“基准真相”的来源。但[量子化学](@article_id:300637)本身就存在一个精度和成本的层级体系。我们能否利用大量廉价、低保真度的计算，以某种方式引导我们构建出一个昂贵、高保真度的模型？

这就是 $\Delta$-学习 (Delta-learning) 背后的绝妙思想。假设我们想要一个“金标准”CCSD(T) 理论水平的[势能面](@article_id:307856)，但只能负担得起少数几个这样的计算点。然而，我们可以使用一种便宜得多的方法，如[密度泛函理论 (DFT)](@article_id:365703)，来生成数千个数据点。虽然 DFT [曲面](@article_id:331153)可能有系统性误差，但它通常能正确捕捉真实[势能面](@article_id:307856)的基本形状。关键的洞见在于认识到两者之间的*差异* $\Delta E = E_{\mathrm{CCSD(T)}} - E_{\mathrm{DFT}}$，通常是一个比 $E_{\mathrm{CCSD(T)}}$ 本身更简单、更平滑、[数量级](@article_id:332848)更小的函数。对于 GPR 模型来说，学习这个简单的修正[曲面](@article_id:331153)要容易得多。我们最终的高精度模型就是廉价的、完整的 DFT 势能和 GPR 学到的修正项之和：$E_{\mathrm{High-Fi}} \approx E_{\mathrm{DFT}} + E_{\mathrm{GPR}}^\Delta$。这种方法让廉价方法承担繁重的工作，而 GP 提供关键的、高精度的修正，从而实现了非凡的效率 [@problem_id:2455983]。这个思想的一个更简单的变体是，直接使用 GPR 对由低水平或未收敛计算生成的[势能面](@article_id:307856)进行去噪和平滑，滤除计算噪声以揭示底层的物理信号 [@problem_id:2455970]。

这种利用现有知识的主题可以被进一步推广。如果我们已经投入巨大努力为铜表面上的 CO 构建了一个高质量的[势能面](@article_id:307856)，现在我们需要一个银表面上 CO 的[势能面](@article_id:307856)，情况会怎样？物理性质相似，但并不完全相同。我们必须从头开始吗？当然不必。这是一个*[迁移学习](@article_id:357432)*的问题。我们可以构建[分层贝叶斯模型](@article_id:348718)，其中银表面 GP 的先验是由铜表面 GP 的*后验*构建的。例如，我们可以将[目标函数](@article_id:330966)建模为[源函数](@article_id:321762)的[线性缩放](@article_id:376064)加上一个小的、需要学习的[残差](@article_id:348682)项：$f_{\mathrm{Ag}}(x) = a f_{\mathrm{Cu}}(x) + b + r(x)$。从铜体系获得的知识提供了一个[信息量](@article_id:333051)极大的起点，极大地减少了为银体系获得精确模型所需的新数据量。像这样的有原则的框架，或者更通用的多任务 GP 模型，使我们能够构建一个相互关联的知识网络，其中学习一个化学体系有助于我们学习所有相关的体系 [@problem_id:2456009]。

### 超越分子：高斯过程的统一力量

GPR 框架的优雅之处在于，其核心并非关乎化学，而是关乎从稀疏数据中学习[平滑函数](@article_id:362303)。“[势能面](@article_id:307856)”可以是任何连续的“景观”，其应用范围之广，仅受我们想象力的限制。

首先，让我们回顾一下与基础物理学的深层联系。假设我们已经为 $\mathrm{H}_2\mathrm{O}$ 分子训练了一个 GPR [势能面](@article_id:307856)模型。我们能否将这个模型用于重水 $\mathrm{D}_2\mathrm{O}$？答案是肯定的。在几乎普遍使用的[玻恩-奥本海默近似](@article_id:306672)中，分子的电子能量仅取决于其原子核的位置和[电荷](@article_id:339187)，而*不依赖于它们的质量*。因此，所有[同位素体](@article_id:356985)的[势能面](@article_id:307856)都是相同的。GPR 模型在学习[势能面](@article_id:307856)的过程中，实际上学习了一条与质量无关的物理定律。$\mathrm{H}_2\mathrm{O}$ 和 $\mathrm{D}_2\mathrm{O}$ 之间振动频率的差异，只有在稍后我们使用不同的质量*在同一个[势能面](@article_id:307856)上*求解核运动方程时才会出现。这凸显了我们的 GPR 模型不仅仅是一种统计上的便利工具，它还是一个基本物理对象的表示 [@problem_id:2455980]。如果我们需要更高的精度，我们可以在 GPR 预测的基础上添加小的、依赖于质量的“超越玻恩-奥本海默”修正，同样无需重新训练基础模型。

现在，让我们完全跳出构型空间。考虑确定一种物质[相图](@article_id:351832)的问题。我们想知道在给定的温度 $T$ 和压力 $P$ 下，是固相还是液相更稳定。这取决于[吉布斯自由能](@article_id:307192)差 $\Delta G(T,P)$ 的符号。这个量 $\Delta G$ 是 $T$ 和 $P$ 的一个平滑函数。我们可以将其视为我们的“[曲面](@article_id:331153)”。我们可以在少数几个 $(T, P)$ 点上进行几次昂贵的模拟来计算 $\Delta G$，然后使用 GPR 来学习整个 $\Delta G(T, P)$ [曲面](@article_id:331153)。我们的 GPR 模型随后可以预测[相界](@article_id:352059)（即 $\Delta G = 0$ 的曲线），并且更引人注目的是，可以利用其后验不确定性来给出在任何给定 $(T,P)$ 下物质为液相的*概率* [@problem_id:2456011]。这里的“[势能面](@article_id:307856)”不再是能量对原子坐标的函数，而是一个热力学势对[热力学变量](@article_id:320991)的函数。

最后的飞跃是将整个科学模拟工作流程视为一个待优化的单一“黑箱”函数。想象一下，我们想最大化一个反应器中[化学反应](@article_id:307389)的产率。[产率](@article_id:301843) $Y$ 是操作条件（比如温度 $T$ 和压力 $P$）的一个复杂函数。对于任何给定的 $(T,P)$，我们可能会运行一个包含我们的[势能面](@article_id:307856)、[过渡态理论](@article_id:357578)和动力学建模的大规模模拟，最终得到一个单一的数字：预测[产率](@article_id:301843) $Y(T,P)$。整个流程就是我们那个昂贵且带有噪声的函数。我们可以直接将 GPR 驱动的[贝叶斯优化](@article_id:323401)应用于这个问题。GPR 学习响应[曲面](@article_id:331153) $Y(T,P)$，并使用其[采集函数](@article_id:348126)智能地选择下一组要模拟的操作条件，有效地引导我们找到最大化[产率](@article_id:301843)的最佳温度和压力。在这里，GPR 已经填平了从基础[分子建模](@article_id:351385)到宏观化学过程优化的鸿沟 [@problem_id:2455990]。

从在分子地图上绘制最初的几个点，到指导工业规模的生产过程，[高斯过程回归](@article_id:339718)的应用证明了将有原则的[统计建模](@article_id:336163)与深刻的物理洞见相结合的力量。它提供了一种灵活而强大的语言，用于从数据中学习、量化不确定性，并在面对高昂计算成本时做出智能决策——这是现代计算科学真正的基石。