## 引言
许多我们随时间测量的现实世界现象，从一个国家的经济产出到实验室的温度，其行为并不遵循固定的规则。它们的基本统计特性——平均值、波动性——会发生变化、漂移和演化。这种被称为[非平稳性](@article_id:359918)的特征，对[数据分析](@article_id:309490)提出了深刻的挑战。许多强大的统计工具都建立在[平稳性](@article_id:304207)假设之上，当这一假设被违反时，这些工具可能会严重失效，导致分析师发现本不存在的关系，并构建出根本上有缺陷的模型。本文旨在探讨[非平稳性](@article_id:359918)这一关键概念，填补在假设静态世界与分析动态世界之间的知识鸿沟。

本文将引导您穿越这个变化数据的世界。在第一部分“原理与机制”中，我们将定义[非平稳性](@article_id:359918)，探讨[伪回归](@article_id:299500)的危险假象，并介绍差分和[协整](@article_id:300727)等能让我们驯服游走数据的强大技术。随后，在“应用与跨学科联系”中，我们将跨越从经济学、金融学到生物学、生态学等不同科学领域，了解[非平稳性](@article_id:359918)如何在现实世界中显现，以及认识到它如何能为我们所研究的系统解锁更深层次的理解。

## 原理与机制

想象一下，你正站在海滩上，看着海浪。它们起起落落，拍打又退去，呈现出一场混沌与秩序的美丽舞蹈。但如果你去测量海浪的平均高度，或是浪峰之间的时间间隔，你会发现这些统计数据总体而言，今天和昨天差不多，和明天也差不多。支配海洋行为的根本规则在你观察的这段时间内是恒定的。这种特性，这种统计上的[时间不变性](@article_id:324127)，就是我们所说的**[平稳性](@article_id:304207)**。

现在，将其与观察一棵小树苗在多年间长成参天大树的情景对比。它的高度是不平稳的；其平均值在持续增加。或者考虑一个国家一个世纪以来的国内生产总值（GDP）；它呈上升趋势。在这些情况下，系统的基本统计数据——最明显的是其均值——随时间而变化。游戏规则不是固定的。这就是**[非平稳数据](@article_id:325200)**的世界，数据分析中许多最有趣也最危险的挑战正潜藏于此。

### 不变的游戏规则

更精确地说，一个时间序列——即随时间记录的一系列数据点——如果满足三个条件，就被认为是**弱平稳**的：其均值是恒定的，其方差是恒定的，并且任意两点之间的相关性仅取决于它们之间的时间*间隔*，而与它们在时间上的绝对位置无关。

想一想一个气象站一年中每日的平均湿度。乍一看，它似乎是平稳的——只是围绕某个典型值随机波动。但根据经验我们知道，夏季通常比冬季更潮湿。七月的预期湿度系统性地高于一月。这种季节性变化意味着该过程的均值取决于一年中的时间，违反了我们的第一个条件。因此，每日湿度的时间序列根本上是非平稳的 [@problem_id:1289201]。系统的“规则”随季节而变化。统计学家工具箱中的大多数强大工具都建立在平稳性假设之上。当这一假设被违反时，这些工具可能会以惊人且误导性的方式失效。

### 虚幻的相关性：为何两个醉汉看起来像在结伴而行

当我们将标准分析方法应用于无约束游走的数据时会发生什么？我们会受骗。这就是**[伪回归](@article_id:299500)**的危险所在。

想象两个朋友参加完派对后都迷路了。他们朝着随机的方向蹒跚前行。他们每走一步都与对方无关。我们可以将他们的路径建模为**[随机游走](@article_id:303058)**，这些路径是完全不相关的。[随机游走](@article_id:303058)是一个经典的[非平稳过程](@article_id:333457)：在每一步，你都会将一个随机数加到之前的位置上。你的[期望](@article_id:311378)位置可能还是你开始的地方，但你的方差——你可能位置的分布范围——会随着你走的每一步而增大。你正在离起点越来越远。

现在，假设我们绘制出这两个游走的朋友随时间变化的位置。因为两者都在偏离起点，所以很可能在很长一段时间内，他们看起来是在朝同一个大致方向移动。如果我们天真地进行统计[回归分析](@article_id:323080)，我们常常会发现他们路径之间存在“统计上显著”的相关性，并附带一个很高的**[决定系数](@article_id:347412) ($R^2$)** 和一个有说服力的 **$t$** 统计量。

这不仅仅是一个古怪的思想实验；它在数学上是必然的。两个独立[随机游走](@article_id:303058)样本[协方差](@article_id:312296)的方差是巨大的，并且随着时间序列的长度急剧增长 [@problem_id:1953487]。这种巨大的方差意味着观察到一个巨大但完全无意义的相关性不仅是可能的，而且是很有可能的。我们甚至可以在计算机上模拟这个过程：生成两个独立的[随机游走](@article_id:303058)，并将一个对另一个进行回归，结果常常会让一个毫无戒备的分析师惊呼“有关系！” [@problem_id:2399416]。

这个陷阱不仅限于简单回归。假设你有一个具有明显上升趋势的时间序列，比如一个国家的GDP，你怀疑其中存在某些复杂的混沌动态。如果你对原始的、有趋势的数据应用[混沌理论](@article_id:302454)中的复杂工具，比如时间延迟[嵌入](@article_id:311541)，那你就是在自找麻烦。该[算法](@article_id:331821)本是为寻找一个重复的、平稳的**[吸引子](@article_id:338770)**的几何结构而设计的，但它完全被非平稳的趋势所压倒。它没有揭示出潜在经济动态的复杂形状，而是看到一条从未回到过去的、缓慢弯曲的长线。该方法很可能会报告系统的“维度”为一，仅仅因为被趋势主导的数据看起来像一条线 [@problem_id:1665656]。[非平稳性](@article_id:359918)制造了一个数学假象，掩盖了你试图寻找的真相 [@problem_id:1714147]。

### 驯服游走者：简单差分的力量

如果[非平稳性](@article_id:359918)是如此大的一个问题，我们该如何解决它呢？最常见且非常优雅的解决方案是**[差分](@article_id:301764)**。我们不再关注数据的*值*，而是关注从一个时刻到下一个时刻的*变化*。

让我们回到那两个游走的朋友。他们的位置是非平稳的，但他们每时每刻所走的步子是随机且独立的——一个被称为**白噪声**的[平稳过程](@article_id:375000)。通过计算他们在时间 $t$ 和时间 $t-1$ 位置之间的差值，我们就恢复了他们步子的[平稳序列](@article_id:304987)。

这项技术具有非常强的普适性。考虑一个智能手机每天测量的剩余电量。由于老化，电量百分比会随时间呈下降趋势——一个[非平稳过程](@article_id:333457)。但如果我们观察从一天到下一天的百分比*变化*，$Z_t = Y_t - Y_{t-1}$，我们可能会发现一个围绕某个小的、恒定的负值波动的序列。这个新序列 $Z_t$ 代表了每日的损耗，它很可能是一个我们可以分析和建模的[平稳过程](@article_id:375000) [@problem_id:1925266]。

我们可以用一个简单的模型清楚地看到这一点。如果一个时间序列具有线性趋势，比如 $Y_t = \alpha + \beta t + X_t$，其中 $X_t$ 是某个平稳噪声，那么 $\beta t$ 项使得整个序列非平稳。进行[一阶差分](@article_id:339368)得到：
$$
Z_t = Y_t - Y_{t-1} = (\alpha + \beta t + X_t) - (\alpha + \beta(t-1) + X_{t-1}) = \beta + (X_t - X_{t-1})
$$
那个麻烦的、与时间相关的项 $\beta t$ 消失了！我们得到了一个新的[平稳序列](@article_id:304987)，其均值就是 $\beta$，即原始趋势的斜率 [@problem_id:1897436]。

为了使一个序列变得平稳而需要进行差分的次数被称为其**整合阶数**，在流行的 **ARIMA(p,d,q)** 建模框架中用 $d$ 表示。一个[随机游走](@article_id:303058)需要[差分](@article_id:301764)一次（$d=1$）才能变得平稳。一个具有线性趋势的序列也需要[差分](@article_id:301764)一次。这种观察变化而非水平的简单行为是整个[时间序列分析](@article_id:357805)中最强大的转换之一 [@problem_id:1897454]。

### 一点警示：过度操作的危险

如果[差分](@article_id:301764)一次是好的，那么差分两次会更好吗？这是一个很自然的问题，但在这里，多并不一定好。比必要次数更多地应用[差分](@article_id:301764)算子被称为**过度[差分](@article_id:301764)**，它会制造其自身的一系列问题。

假设我们取一个[随机游走](@article_id:303058) $Y_t$，并对其进行一次[差分](@article_id:301764)。我们得到一个平稳的[白噪声过程](@article_id:307294)，$\epsilon_t = Y_t - Y_{t-1}$。我们完成了！但如果我们出于热情，再[差分](@article_id:301764)一次呢？我们会得到一个新的序列，$X_t = \epsilon_t - \epsilon_{t-1}$。这个序列是平稳的，但它不再是简单的[白噪声](@article_id:305672)。我们人为地在数据中引入了一种误导性的结构。具体来说，这个过度[差分](@article_id:301764)的序列在滞后一期时会有一个显著的负相关。看到这一点的分析师可能会试图拟合一个比必要更复杂的模型，追逐一个他们自己制造出来的幽灵 [@problem_id:1943254]。[时间序列分析](@article_id:357805)的艺术在于恰到好处地进行差分以驯服游走者，但又不过度以至于将其强行套入不自然的紧身衣中。

### 隐藏的交响乐：在[协整](@article_id:300727)中寻找稳定

到目前为止，我们的策略是获取非[平稳序列](@article_id:304987)并对其进行[差分](@article_id:301764)以找到[平稳性](@article_id:304207)。这很有效，但它有代价：通过关注*变化*，我们可能会忽略不同序列水平之间的长期*关系*。这引导我们走向现代计量经济学中最深刻、最美妙的思想之一：**[协整](@article_id:300727)**。

想象一下生咖啡豆的价格和你当地咖啡馆一杯拿铁的价格。几十年来，由于通货膨胀和其他经济力量，两者都可能呈上升趋势。两者都是非平稳的。如果我们对这两个序列都进行差分，我们会得到日价格变化的[平稳序列](@article_id:304987)，然后可以对它们进行分析。

但我们可能会怀疑存在更深层次的联系。拿铁的价格不可能任意地偏离咖啡豆的价格太远。如果咖啡豆价格下跌而拿铁价格不变，竞争者就会以更低的价格削弱这家咖啡馆。如果咖啡豆价格飙升，咖啡馆最终必须提高价格以维持可行的利润率。这两个价格，虽然各自在游走，却被一个长期的[经济均衡](@article_id:298517)关系束缚在一起。

这意味着，虽然 $Y_t$（拿铁价格）和 $X_t$（咖啡豆价格）都是非平稳的，但它们的某个特定[线性组合](@article_id:315155)——比如代表长期加价的 $Z_t = Y_t - \beta X_t$——可能是**平稳的**。这个 $Z_t$ 序列会围绕一个恒定的平均值波动，即使其组成部分永远在漂移。

当两个或多个非[平稳序列](@article_id:304987)之间存在这种平稳关系时，我们说它们是**[协整](@article_id:300727)的**。它们共享一个共同的随机趋势，通过以恰当的方式组合它们，我们可以抵消这个共同的非平稳成分，从而揭示一个隐藏的、稳定的、有意义的经济规律 [@problem_id:1312143]。这就像在起初看似只是噪音的东西中发现了一首秘密的交响乐。这种洞见——稳定的关系可以隐藏在不稳定数据的游走之中——彻底改变了我们对经济和金融系统的理解，也证明了即使在最看似混乱的数据中也能找到美妙的、潜在的统一性。