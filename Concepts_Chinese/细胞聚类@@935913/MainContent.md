## 引言
组织并非均质的团块，而是由数百万个具有独特身份和功能的独立细胞组成的复杂生态系统。要理解健康与疾病，我们首先需要为这个细胞大都会创建一份“零件清单”，但仅凭外观来区分这些细胞往往是不可能的。单细胞RNA测序技术的出现，能够捕获每个细胞独特的基因表达谱，它提供了一种解决方案，但同时也带来了新的挑战：我们如何理解这海量的高维数据？本文为细胞聚类这一解锁此复杂性的计算关键提供了全面的指南。我们将首先深入探讨聚类的“原理与机制”，探索算法如何利用降维和统计验证在细胞的混沌中寻找秩序。随后，“应用与跨学科联系”一章将展示这些方法在实践中如何被用于创建[细胞图谱](@entry_id:270083)、追踪发育路径和剖析疾病机制。

## 原理与机制

设想你是一位自然学家，面对着一个巨大而混乱的鸟群，其中包含来自几十个物种的数千个个体，全都混杂在一起。你会如何着手理解它？你无法追踪每一只鸟，但你可以开始将它们分组。你会寻找“物以类聚”的鸟群——那些在体型、颜色、喙形和鸣叫声上相似的个体。这种分组的直觉行为，即在混沌中寻找结构，正是聚类的本质。

在生物学中，当我们观察一块组织，比如一块大脑或一个肿瘤时，我们面临着类似的挑战。这些并非均质的物质团块；它们是繁华的都市，由数百万或数十亿个具有各自身份和工作的独立细胞组成。其中有神经元、免疫细胞、结构细胞、干细胞等等，所有这些细胞共同生活和工作。为了理解组织在健康时如何运作，或在疾病中如何失效，我们必须首先识别出它的“市民”。但我们如何区分它们呢？

### 在细胞的混沌中寻找秩序

与鸟类不同，我们不能仅仅通过*观察*大多数细胞就知道它们的类型。在培养皿中，一个神经元和一个胶质细胞在未经训练的眼睛看来可能很相似。但每个细胞内部都携带一份动态的身份蓝图：它的**转录组**。可以把细胞的DNA想象成一个巨大的图书馆，包含数万本书（基因）。转录组则是细胞当前借出并正在积极阅读的书籍清单（即表达的基因）。一个细胞的类型及其当前活动——无论是在抗击感染、分裂还是发送信号——都由它“开启”了哪些基因组合所决定。

单细胞RNA测序（[scRNA-seq](@entry_id:155798)）是一项革命性技术，它让我们能够一次性获得成千上万个独立细胞的这份“阅读清单”。将[聚类算法](@entry_id:146720)应用于这些数据的主要目标非常简单：根据细胞基因表达谱的相似性将它们分组。其基本假设是，阅读相似基因书籍的细胞属于同一个“物种”——即相同的细胞类型或功能状态[@problem_id:1714816] [@problem_id:2350895]。这就是我们在脊髓那看似混沌的细胞群中找到[星形胶质细胞](@entry_id:190503)、小胶质细胞和各种神经元亚型的方式。

### 驾驭基因表达的多重宇宙

[scRNA-seq](@entry_id:155798)实验的数据是一个巨大的表格，一个矩阵，其行为基因（通常约20,000个），列为细胞（从数千到数百万个）。因此，每个细胞由一个包含20,000个数字的列表定义——这是20,000维空间中的一个单点。我们习惯于三维世界的人类思维，完全无法想象这个“基因表达的多重宇宙”以寻找细胞群。在如此广阔得令人困惑的空间中，我们该如何定义“相似性”或“距离”呢？

这就需要借助一些数学上的精妙方法，即**[降维](@entry_id:142982)**。其关键洞见在于，并非所有20,000个维度都同等重要。想象一下整理一个图书馆。你不会去读每本书的每个字。相反，你会找到最重要的变异轴：类型、作者、出版年份。一种名为**[主成分分析](@entry_id:145395)（PCA）**的技术正是为我们的细胞数据做了这件事。

PCA是一种寻找数据中最大方差方向的方法。可以把它想象成旋转我们那20,000维的空间，以找到最佳的观察视角。第一个主成分（PC1）是细胞分布最分散的轴；它捕捉了整个数据集中最大的差异，或许能将免疫细胞与上皮细胞分开。PC2是次重要的轴，与第一个主成分正交，可能用于区分不同类型的免疫细胞。通过仅取前10、20或50个主成分，我们就能在一个更易于管理、维度更低的空间中捕捉到绝大多数有意义的变异。现在，每个细胞都有了一套新的、短得多的坐标——它在这些主成分上的“得分”。聚类就在这个被简化、清理过的空间中进行，这里的距离更有意义[@problem_id:4990961]。

### 调谐信号：区分身份与状态

然而，PCA找到的“最大变异”并不总是*生物学上最有趣*的变异。任何细胞群体中的一个主要变异来源是**细胞周期**。一个细胞的基因表达谱会根据它是在静息期（$G_1$期）还是在积极准备分裂（$S/G_2/M$期）而发生巨大变化。如果我们不小心，PCA可能会将细胞周期作为其第一个主成分。我们的[聚类算法](@entry_id:146720)随后就会根据细胞的增殖“状态”而不是其稳定、潜在的身份来进行分类。这就像一个自然学家根据鸟儿是在睡觉还是醒着来分类，把知更鸟和鹰归为一类，仅仅因为它们都在打盹。

为了避免这种情况，科学家们可以执行一个巧妙的预处理步骤：他们识别出与细胞周期相关的基因，并在计算上“回归去除”它们对表达数据的贡献。这种数学上的巧计消除了增殖的压倒性信号，使得与细胞身份相关的更微妙但更根本的差异得以浮现，[并指](@entry_id:276731)导聚类过程[@problem_id:2350948]。

同样，并非所有基因都是生而平等的。许多“看家”基因在所有细胞中都以相似的水平表达。为了集中分析，研究人员通常会选择一个**高变基因（HVGs）**的子集——那些在细胞群体中表达水平差异最大的基因。通过仅对这些基因执行PCA，我们实际上是在告诉算法忽略[看家基因](@entry_id:197045)单调的嗡嗡声，而专注于定义不同细胞类型的可变旋律。这一选择至关重要，因为它从根本上塑造了PCA所探索的协方差结构，将主成分引向我们希望具有生物学意义的变异方向[@problem_id:4990961]。然而，这种方法有其局限性。如果某种状况在大量基因中引起非常微小的变化——一种“弥散”表型——这种策略可能会因过滤掉携带微弱信号的基因而失败[@problem_id:2379631]。这提醒我们，这些强大的方法是工具，而非神谕，需要谨慎、批判性地应用。

### 什么是细胞簇？从分组到生物学洞见

经过这一切，我们的算法为我们呈现了一组细胞簇。但它们是什么？它们是真实的生物学实体，还是仅仅是我们计算过程的产物？这是一个深刻的问题。事实上，统计学家会首先提出一个**零假设**：数据中没有真实结构，所有细胞都来自一个单一的、同质的群体。在此零假设下，观察到的聚类只是由随机噪声和算法划分数据的倾向所造成的幻觉[@problem_id:2410298]。科学家必须使用统计检验来证明他们发现的聚类差异显著，不可能是偶然的结果。

为了建立进一步的信心，我们可以测试我们聚类的**稳定性**。一种巧妙的方法是使用**交叉验证**：我们可以将细胞随机分成两半，在每一半上独立运行整个聚类过程，然后检查结果是否一致。如果一个在第一半中属于聚类1的细胞，在第二半中也落入一个相应的聚类，这就让我们相信这个聚类是稳健的，而不仅仅是数据或算法的偶然产物[@problem_id:2383458]。

一旦我们基本确定我们的聚类是真实的，最激动人心的部分就开始了：给它们命名并赋予意义。我们通过**[差异基因表达](@entry_id:140753)（DGE）**分析来做到这一点。对于每个聚类，我们问：“与所有其他组相比，哪些基因在这个组中是独特或最高表达的？”答案是一份**标记基因**列表。然后我们可以将这份列表与浩瀚的生物学知识库进行比对。如果聚类3的标记基因都已知与产生抗体（如[免疫球蛋白](@entry_id:203467)）有关，我们就可以自信地将该聚类标记为“[B淋巴细胞](@entry_id:165992)”。这是将抽象的、数据驱动的分组转变为具体的生物学身份的神奇一步[@problem_id:1466160]。

### 特征的艺术：提出更尖锐的问题

这个框架的力量在于其灵活性。到目前为止，我们将细胞的“特征”定义为其基因的表达水平。但如果我们的生物学问题不同呢？假设我们假设某些神经元的身份不是由某个基因表达*多少*决定的，而是由该基因的*哪个版本*——即哪个**[剪接异构体](@entry_id:167419)**——被使用所决定的。

要回答这个问题，我们必须改变我们的特征。我们不再使用原始的基因计数，而是首先为每个基因计算其不同异构体的相对比例。这将创建一个总和为1的比例向量。这种类型的数据称为**组成数据**，它存在于一个不同的几何流形（一个单纯形）上，不能用像PCA这样假设欧几里得空间的方法正确分析。我们必须首先使用一种特殊的变换，如**中心对数比变换**，将数据从受限的单纯形转换到一个距离有意义的无约束空间中。只有这样我们才能进行聚类。通过定制我们的[特征空间](@entry_id:638014)，我们可以提出更尖锐、更复杂的生物学问题，从“那里有什么？”转向“它们的内部线路有何不同？”[@problem_id:2379634]。

### 从目录到食谱：揭示调控程序

科学的最终目标不仅仅是为世界编目，而是要理解支配世界的规则。我们不只想得到一份细胞类型列表；我们想知道创造和维持它们的“源代码”，即基因调控程序。

像**SCENIC（单细胞[调控网络](@entry_id:754215)推断与聚类）**这样的先进技术正是为此而生。这种方法代表了思维上的一次巨大飞跃。它首先识别哪些基因与哪些**转录因子**（开启和关闭其他基因的主控蛋白）共表达[@problem_id:2851177]。但共表达可能具有误导性。因此，SCENIC增加了第二个至关重要的证据层：它检查候选目标基因的调控区域是否具有该转录因子的正确DNA结合序列（一个**基序**）。这种共表达和基序证据的结合，让我们高度确信我们找到了一个真正的调控模块，或称**[调控子](@entry_id:199455)**。

最后，我们可以不再基于基因表达来聚类细胞，而是为每个细胞中的每个[调控子](@entry_id:199455)计算一个“活性得分”。这个得分被巧妙地设计为对技术噪声具有稳健性，它告诉我们某个特定调控程序的活跃程度[@problem_id:2851177]。然后我们可以根据细胞活跃的调控程序对它们进行聚类。这不再仅仅是按羽毛对鸟类进行分类。这是根据它们潜在的发育蓝图进行分类。这就像拥有了一本野外指南和拥有生命本身食谱之间的区别。我们从一个静态的细胞目录，转向了对定义它们的规则的动态理解。

