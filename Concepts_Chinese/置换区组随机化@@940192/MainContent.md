## 引言
为了确定一种新的医疗方法是否有效，我们必须以一种公平且无偏倚的方式将其与[对照组](@entry_id:188599)进行比较。实现这一目标的基本原则是随机化——通过机遇来将受试者分配到不同的治疗组。然而，简单的随机化，例如为每个人抛硬币，可能会导致组间样本量或特征的显著不平衡，尤其是在有限的试验中。本文通过探讨置换区组随机化这一旨在强制实现平衡的复杂方法，来应对这一挑战。在接下来的章节中，我们将深入研究该技术的原理和机制，将其与简单随机化进行对比，并探讨其固有的权衡。然后，我们将审视其重要应用和跨学科联系，揭示这种精妙的方法如何为可靠的科学发现提供必要的稳健结构。

## 原理与机制

假设我们有一种新药。我们想知道它是否比旧药效果更好，或者比什么都不用要好。我们如何进行一次公平的测试？挑战在于人与人之间各不相同。有些人年龄较大，有些人病情较重，有些人可能具有不同的基因构成。如果我们只是将新药给一组人，旧药给另一组人，我们看到的任何差异都可能是由于药物本身，也可能仅仅是因为两组人本来就不同。这是因果推断的根本问题，而它的解决方案是所有科学中最美妙的思想之一：随机化。

### 抛硬币的魅力：简单随机化

决定谁接受哪种治疗的最简单、最诚实的方法是什么？为每一位进入试验的受试者抛一枚硬币。正面，他们接受新药；反面，他们接受旧药。这被称为**简单随机化**，其力量在于其优雅的朴素性。[@problem_id:4934222]

因为硬币没有记忆，也不关心患者的年龄、性别或病情严重程度，所以治疗分配在设计上就与患者的所有特征在统计上是独立的。[@problem_id:4934222] 从长远来看，得益于[大数定律](@entry_id:140915)，这种方法能确保两个组——治疗组和[对照组](@entry_id:188599)——在平均水平上看起来非常相似。任何预后因素，无论测量与否，都将[趋于平衡](@entry_id:150414)。这使得我们可以将结果的任何差异主要归因于治疗本身。从这个意义上说，简单随机化是建立无偏倚比较的黄金标准。[@problem_id:5044638]

但这里有一个陷阱，而且是个大陷阱。“从长远来看”，大数定律才能发挥其魔力。而一个真实的临床试验并不是无限长的。它的受试者数量是固定的、有限的。在有限的样本中，纯粹的机遇可能导致令人不安的不平衡。你可能因为一连串的坏运气，最终导致70名患者服用新药，而只有30名患者在[对照组](@entry_id:188599)，这对统计比较而言是低效的。更糟糕的是，你可能会遇到“连续”的情况，即前15名患者都被分配到新药组。如果这些早期入组者与[后期](@entry_id:165003)入组者有系统性差异（也许他们病情更重、更急于求治），你就无意中将时间效应（即**时间顺序偏倚**）与你的治疗效应混淆了。[@problem_id:4628133] 我们本想消除偏倚，但机遇本身却让偏倚悄悄溜了回来。

### 驯服机遇：区组的发明

如果纯粹的、不受约束的机遇是问题所在，那么解决方案必然是约束它。我们需要在固定的时间间隔内强制实现平衡。这就是**置换区组随机化**背后的核心思想。

我们不再将试验视为一长串的抛硬币过程，而是将其分解成更小、更易于管理的小块，称为**区组**。假设我们选择一个大小为四的区组（$b=4$）。我们决定，在这个由四人组成的区组内，我们要保证完美的$1:1$平衡。这意味着，将有两人确切地得到新药（我们称之为'A'），两人得到对照（'B'）。[@problem_id:4944971]

我们该如何做到这一点？我们可以想象在两张卡片上写'A'，在另外两张卡片上写'B'。我们把这四张卡片放进一顶帽子里，把它们洗匀，然后为每一位入组的患者抽出一张。我们可能抽出的序列有AABB、ABAB、ABBA、BAAB、BABA、BBAA。这种唯一序列的数量由[二项式系数](@entry_id:261706) $\binom{b}{b/2}$ 给出，对于$b=4$的情况，即为 $\binom{4}{2}=6$。我们为第一个四人区组随机选择这六种排列中的一种，然后为下一个四人区组再做一次，依此类推，直到试验完成。[@problem_id:4833626]

这种方法的美妙之处在于它约束了机遇的狂野。现在，在每个区组结束时，平衡得到了保证。那种造成各治疗组总人数严重失衡的长时间坏运气，现在已不可能发生。各组之间可能存在的最大不平衡最多是区组大小的一半，即$b/2$。[@problem_id:4844348] [@problem_id:4627400] 如果我们使用小的区组，比如$b=4$，我们知道两组的患者人数差异永远不会超过两个。这是一种在不同时间和不同试验中心维持平衡的强大方法，能给我们带来更强的统计效力，以及更可信的结果。[@problem_id:4628133]

### 控制的无形代价：可预测性与偏倚

在科学中，如同在生活中一样，没有免费的午餐。我们约束了机遇以获得平衡。那么我们放弃了什么？我们失去了一定程度的不可预测性。而这种损失可能是灾难性的。

随机化的整个事业都建立在一个称为**分配隐藏**的原则之上：为患者入组的人员决不能知道即将进行的治疗分配。如果他们知道了，他们可能会有意识或无意识地影响谁在何时入组。这被称为**选择偏倚**，它会彻底破坏试验的公平性。[@problem_id:5044638]

让我们回到那个四人区组（A, A, B, B）的例子，想象你是一位研究者，并且知道区组大小是4。
- 第一位患者入组，得到了'A'。
- 第二位患者入组，得到了'B'。
- 第三位患者入组，得到了'A'。

现在，第四位患者即将入组。你已经看到区组中用掉了两个'A'和一个'B'。既然你知道区组必须包含两个'A'和两个'B'，你就百分之百地确定这最后一位患者必须接受'B'。秘密已经泄露。可预测性为1。[@problem_id:5054015]

这不仅仅是最后一次分配的问题。随着一个区组被填满，下一次分配的概率会变得倾斜。如果你看到的'A'比'B'多，那么下一次分配更有可能是'B'。研究者可能会利用这一点。如果他们认为新药'A'更好，并且看到下一次分配很可能是'B'，他们可能会引导病情较重的患者避开这次试验，等待一个'A'可能性更大的名额。这种选择性的入组会污染整个实验。

我们面临一个艰难的权衡。小的区组大小让我们能严格控制平衡，但会使分配更具可预测性。大的区组大小降低了可预测性，但允许出现更大的临时不平衡。[@problem_id:4627400]

### 欺骗的艺术：一个巧妙的修正方法

我们如何解决这个两难的困境？问题之所以出现，是因为研究者知道区组的大小。那么，我们就把它隐藏起来。

与其使用固定的区组大小4，我们可以决定混合使用不同的区组大小，例如，4、6和8。在每个新区组开始时，中央[随机系统](@entry_id:187663)会秘密地、随机地选择其中一个大小。在实地招募患者的研究者并不知道当前区组是短的还是长的。[@problem_id:4627400]

现在，即使他们观察到不平衡，也无法确定离区组结束还有多远，因此他们无法可靠地计算出下一次分配的概率。这种使用**随机变化的区组大小**的简单做法，巧妙地模糊了底层的模式，在大幅降低可预测性的同时，仍然保留了在每个（现在是秘密的）区组结束时完美平衡的保证。[@problem_id:4571001] 这是一项非常实用的统计工程杰作，让我们能够两全其美：既有良好的平衡性，又有稳健的分配隐藏。

### 更深层次的公平：在分层内进行随机化

置换区组随机化是一个很好的工具，可以保持各组人数的平衡。但是，如果有一个特定的、已知的因素对结果有巨大影响，该怎么办？例如，在一项癌症试验中，如果携带特定基因标记的患者对治疗的反应非常不同，该怎么办？即使使用了置换区组，我们也可能因为偶然，最终导致一个治疗组中标记为阳性的患者比另一个组多。

为了防止这种情况，我们可以增加另一层控制：**分层**。

这个想法简单而直观。在随机化之前，我们首先根据这些关键的预后因素将我们的患者群体分成不同的组，或称**分层**。例如，我们可以创建四个分层：
1. 男性，标记阳性
2. 男性，标记阴性
3. 女性，标记阳性
4. 女性，标记阴性

然后，我们在*每个分层内部*进行独立的置换区组随机化（理想情况下使用可变的区组大小）。[@problem_id:5044638] 这确保了我们不仅在总体上，而且在男性标记阳性组、女性标记阴性组等等内部都获得了良好的治疗分配平衡。

这种强大的组合——**分层置换区组随机化**——是现代临床试验设计的中流砥柱。分层强制在我们已知重要的关键因素上实现平衡，而区组则在这些分层内随时间维持[分配比](@entry_id:183708)例，防止时间顺序偏倚。这是一个多层次的防御系统，设计精巧，旨在保护试验的完整性，使其免受机遇和人性可能引入的各种偏倚的影响。它代表了从简单地抛硬币到为揭示真理而设计的复杂、稳健系统的演进过程。

