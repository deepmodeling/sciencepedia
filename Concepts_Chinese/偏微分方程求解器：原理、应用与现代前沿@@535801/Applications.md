## 应用与跨学科联系

既然我们已经探讨了构建一个用于求解[偏微分方程](@article_id:301773)的数值引擎的基本原理，我们就可以提出最激动人心的问题：“它有什么用？”仅仅说“它能解方程”，就像说望远镜是一堆透镜的集合一样，完全没有抓住要点。这些数值方法是我们理解宇宙的窗口，从星系的流动到吉他弦的[振动](@article_id:331484)。它们是虚拟实验室，我们可以在其中测试新飞机机翼的设计，预测污染物在大气中的[扩散](@article_id:327616)，甚至模拟金融市场的复杂舞蹈。

在本章中，我们将踏上穿越这片广阔而肥沃的土地的旅程。我们将看到我们开发的抽象机制如何在科学和工程中找到深刻而往往优美的应用。你会注意到，反复出现的主题是独创性和统一性——那些用来使我们的求解器更智能、更快速的巧妙技巧，以及同样的核心思想如何在看似不相关的领域中回响。

### 可能性的艺术：构建高效智能的求解器

任何真实世界模拟中的第一个挑战是，自然界是无限复杂的，而我们的计算机是有限的。我们无法使用无限精细的网格来捕捉每一个细节。因此，构建[偏微分方程](@article_id:301773)求解器的大部分艺术在于明智地使用我们有限的计算资源。这不仅仅是优化问题；这是一个关注重点的深层原则。

想象一下，试图在一个有着复杂L形平面图的房间里解决一个问题。我们最好的工具——比如强大的[谱方法](@article_id:302178)——在简单的矩形中表现出色，但在不规则形状上却会遇到困难。我们是放弃，还是变得更聪明？一个优美的方法是创建一个数学映射，将L形房间“展开”成一个简单的矩形 [@problem_id:3277780]。通过改变我们的[坐标系](@article_id:316753)，我们将一个几何上困难的问题转化为了一个我们已经知道如何解决的简单问题。底层的物理学没有改变，但我们的视角改变了，而这带来了天壤之别。

这种改变视角以简化问题的思想非常强大。它的另一个方面出现在多重网格方法中。当一个求解器在细网格上陷入对微小细节的提炼时，它可能会失去对“大局”的把握。多重网格方法通过创建从非常粗到非常细的网格层次结构来解决这个问题。它首先在最粗的网格上解决问题的简化版本，这能迅速捕捉解的广泛、缓慢变化的特征。然后，这个近似解被传递到更细的网格上作为初始猜测，使得该级别的求解器可以专注于更小的细节 [@problem_id:2188699]。这就像在填充眼睛和头发的精细特征之前先勾勒出肖像的轮廓。通过同时在所有尺度上工作，我们能更快地得到正确的答案。

最智能的求解器通过**[自适应网格加密](@article_id:304283)**将这一点更进一步。我们为什么要使用均匀网格呢？例如，一场森林火灾模拟需要在火灾前沿有高分辨率，但在远离火场的广阔未燃烧区域则不需要。自适应求解器会自动在解变化剧烈的地方——即梯度大的地方——加密网格，而在解平滑的地方 coarsens 网格。这确保了计算精力只花在需要的地方。加密的决定可以由基础数学严格指导，比如中值定理，以保证我们不会意外地错过一个隐藏在网格点之间的重要特征，例如一个目标温度[等值线](@article_id:332206) [@problem_id:3145060]。从某种意义上说，这是计算机在学习将注意力集中在问题的有趣部分。

我们也可以从一开始就让网格变得“更智能”。如果我们知道主要活动将集中在边界附近，就像[流体动力学](@article_id:319275)中经常出现的情况一样，我们可以使用**拉伸网格**。这种网格在边界附近有非常小的单元，随着我们远离边界，单元逐渐变大 [@problem_id:3285452]。这种静态的加密方式从一开始就尊重了问题已知的物理特性。

### 尊重物理

一个不尊重底层物理的[数值求解器](@article_id:638707)不仅是错误的，而且常常是剧烈不稳定的。我们求解的方程不是任意的符号；它们是物理定律的数学表达，我们的[算法](@article_id:331821)必须忠实地编码这些定律。

这些定律中最优雅的一条是**叠加原理**。对于由线性方程控制的一大类物理系统——从[静电学](@article_id:300932)到[热传导](@article_id:316327)再到小振幅波——对两个组合源的响应就是对每个源单独响应的总和 [@problem_id:2134262]。如果你在房间里有两个热源，最终的温度分布可以通过分别计算每个热源的分布然后简单相加得到。这个强大的原理使我们能够将极其复杂的问题分解为一系列我们可以解决的简单问题，这是物理世界的线性特性赋予我们的经典分而治之策略。

另一个物理定律是因果关系，或信息流的方向。在一个物质被流体携带（如风中的烟雾）的[对流](@article_id:302247)问题中，某一点上物质的值取决于“上游”发生的情况。一个稳定而准确的数值格式必须尊重这一点。**[迎风格式](@article_id:297756)**明确地使用来自上游方向的信息来计算解的演化，确保[数值方法](@article_id:300571)模仿信息的物理流动 [@problem_id:3285452]。忽视这一点可能导致无意义的[振荡](@article_id:331484)和不稳定性。

最后，我们必须处理计算域的人为现实。当我们在一个盒子中模拟波时，我们创造了人为的墙壁。当波浪撞击这个“世界的边缘”时会发生什么？在现实中，域可能是无限的，但我们的模拟不是。波浪从人为边界反射回来，产生的回声会污染整个解。为了防止这种情况，工程师们开发了一个巧妙的技巧：**海绵层**。在域的边界附近，他们增加一个数学上的阻尼项，其作用就像一个柔软的、吸收性的海滩。当波浪进入这一层时，它们的能量被逐渐耗散，于是它们平静地消失，而不是剧烈地反射 [@problem_id:2399947]。这使我们能够模拟无限世界的一小部分，这是使模拟得以实现的实践智慧的证明。

### 连接世界：[偏微分方程](@article_id:301773)、概率论与机器学习

也许[偏微分方程](@article_id:301773)求解器最深刻的应用是那些在看似迥异的数学世界之间架起桥梁的应用，揭示了科学结构中更深层次的统一性。

其中一个最令人惊叹的联系是确定性[偏微分方程](@article_id:301773)与**[随机过程](@article_id:333307)**的随机世界之间的联系。非线性的[费曼-卡茨公式](@article_id:336126)揭示了，一大类[偏微分方程](@article_id:301773)的解可以用一种完全不同的方式来解释：即作为大量[随机过程](@article_id:333307)的[期望](@article_id:311378)（或平均）结果 [@problem_id:3054601]。想象一个股价根据一个[随机微分方程](@article_id:307037)（SDE）随机波动。一个依赖于此股票的金融期权的价格，可以通过[蒙特卡洛模拟](@article_id:372441)来计算——即对成千上万条这样的随机路径的结果进行平均。令人惊奇的是，同一个期权价格也*可以*通过求解一个完全确定性的[偏微分方程](@article_id:301773)（[布莱克-斯科尔斯方程](@article_id:304942)）来找到。拥有两种独立的方法来解决同一个问题——一种通过[偏微分方程](@article_id:301773)求解器，另一种通过[蒙特卡洛模拟](@article_id:372441)——提供了一个强大的一致性检验，并为了解微观随机世界与宏观确定性世界之间的深层联系打开了一扇窗。

一个更新近的革命是[偏微分方程](@article_id:301773)求解器与**机器学习**的融合。传统上，[神经网络](@article_id:305336)是数据驱动的黑箱。我们向它们展示输入和输出的例子，它们便学习一种映射关系。但是，如果我们也能教给网络物理定律呢？这就是**[物理信息神经网络](@article_id:305653)（PINNs）**背后的思想。

一个PINN的损失函数——它试图最小化的误差度量——有两部分。第一部分是标准的数据不匹配项：网络的预测与可用的实验数据匹配得有多好？但第二部分，也是革命性的部分，是一个*物理[残差](@article_id:348682)*。网络的输出被反馈到控制[偏微分方程](@article_id:301773)中，其[残差](@article_id:348682)——即方程被违反的程度——被加到损失中 [@problem_id:2502969]。因此，网络不仅被训练来拟合数据，而且被训练在任何地方都遵守物理定律。这使我们能够用非常稀疏的数据解决问题，更重要的是，能够处理反问题。例如，给定涡轮叶片中的几个[温度测量](@article_id:311930)值，一个PINN可以推断出整个温度场，*并且*估算出材料未知的[导热系数](@article_id:307691) [@problem_id:2502969]。然而，这种能力并非魔术。人们仍需思考问题是否适定：可用的数据是否包含足够的信息来唯一地确定未知参数？例如，一个[稳态](@article_id:326048)实验可能无法区分导热系数$k$和[热容](@article_id:340019)$\rho c_p$，但一个动态的、随时间变化的实验却可以，因为它以一种分离它们不同物理角色的方式激励系统 [@problem_-id:2502969]。

### 敏感度的力量与新时代的黎明

神经网络与基于物理的建模的融合，是由一个强大的计算工具——**[自动微分](@article_id:304940)（AD）**所促成的。当我们训练一个神经网络时，我们使用反向传播来计算损失函数相对于网络中每个权重的变化。反向传播只是一种特殊、高效的[自动微分](@article_id:304940)形式。

我们可以将这个相同的工具直接应用于我们传统的[偏微分方程](@article_id:301773)求解器。想象一下我们的求解器是一个长而复杂的计算机程序。[自动微分](@article_id:304940)允许计算机自动地、并以[机器精度](@article_id:350567)计算该程序任何输出相对于任何输入的[导数](@article_id:318324) [@problem_id:3207053]。这个[导数](@article_id:318324)是一个*敏感度*。它回答了关键的设计问题：“如果我调整这个边界参数$\theta$，解场$u(x)$会改变多少？”知道这个敏感度$\partial u / \partial \theta$，是迈向优化、控制和智能设计的第一步。

现在我们可以闭合这个循环，创造出所有这些思想的一个真正壮观的综合体。我们可以使用一个神经网络不是来*求解*[偏微分方程](@article_id:301773)，而是来定义一个我们感兴趣的量——一个“损失函数”$L$，它可能，例如，测量[翼型](@article_id:374827)上的阻力。然后我们可以使用反向传播（AD）来计算这个阻力对于域中每一点的解场$u(x)$的敏感度$\partial L / \partial u(x)$ [@problem_id:3100059]。这个敏感度场是一张重要性地图；它精确地告诉我们流场中的哪些区域对最终的阻力影响最大。我们可以用这样一张地图做什么呢？我们可以将它反馈给我们的[自适应网格加密](@article_id:304283)器，指示它不仅在梯度高的地方放置网格点，而且在解对我们关心的量最*有影响*的地方放置网格点。

这将我们带到了计算科学的前沿：智能的、自我引导的求解器，它们将[经典物理学](@article_id:310812)的严谨性与机器学习的数据驱动能力相融合，而这一切都由微积分和[链式法则](@article_id:307837)这一通用语言所统筹。从一个简单的[有限差分格式](@article_id:640572)开始的旅程，已经将我们带到了一个拥有巨大力量和惊人智识之美的地方。我们构建的工具不仅仅是计算器；它们是发现行为中的伙伴。