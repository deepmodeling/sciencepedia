## 引言
人眼能够感知丰富多彩的纹理世界——木材的纹理、织物的编织——但我们如何才能教会机器具备同样直观的理解能力？将纹理的定性体验转化为定量的数字语言是计算机视觉领域的一个核心挑战。灰度游程矩阵（Gray-Level Run-Length Matrix, GLRLM）为这一问题提供了一个优雅的解决方案，它是一种分析和描述图像内部潜在模式的强大方法。本文旨在搭建起纹理概念与其计算测量之间的桥梁。

本文将引导您了解这一基础技术的理论与应用。在第一部分“原理与机制”中，我们将解构GLRLM，从“游程”像素的简单概念入手，进而介绍矩阵本身的构建，最后推导出捕捉纹理精髓的关键统计特征。在第二部分“应用与跨学科联系”中，我们将探索这些特征如何应用于不同领域，从在医学成像中提供定量见解，到在卫星图像中对地貌进行分类，展示了这一简单而强大思想的深远效用。

## 原理与机制

我们是如何看见的？当我们的眼睛注视一个表面时——比如木桌的纹理、织物的编织、石头上复杂的纹路——我们不只是记录颜色。我们感知到的是纹理。我们直观地掌握了粗糙、光滑、条纹状和随机性等概念。这是一种非常复杂的模式识别形式。但我们如何能教会机器做同样的事情呢？我们如何能将这种丰富、定性的人类体验，转化为冷冰冰、硬邦邦的数字语言？这是[计算机视觉](@entry_id:138301)领域的核心挑战之一，而答案，正如科学中常有的情况一样，始于一个出人意料地简单而优雅的想法。

### 游程：一个应对复杂世界的简单想法

想象一下，你正在逐行扫描一幅图像，不是作为一个整体，而是一次一行，就像读书一样。如果你不孤立地看待每个像素，而是关注相同颜色或灰度值的*条纹*，会怎么样？你可能会看到一条短的光灰色条纹，然后是一条长的深灰色条纹，接着又是一条短的。这种“条纹”的简单概念，是一种强大的[纹理分析](@entry_id:202600)方法的基础。

在图像分析的语言中，这种条纹被称为**游程**（run）。游程被正式定义为：在特定预定义方向上，所有像素都具有相同灰度值的最大连续序列 [@problem_id:5221694]。“最大”这个词很重要；它只是意味着这个游程不能再延长了。例如，在序列 `[深, 深, 深, 浅]` 中，“深色”的游程长度为三。它不是更长游程的一部分，因为它被图像的边界或不同灰度值的像素所包围。

这个想法非常简单。我们决定不通过单个像素来描述纹理，而是通过它所包含的同质条纹的长度来描述。

### 游程矩阵：条纹的分类账

现在我们有了游程的概念，我们需要一种方法来系统地组织这些信息。我们可以构建一个简单的表格，或者说一个矩阵，来记录我们找到的所有游程。我们称之为**灰度游程矩阵（GLRLM）**。

其设置非常直接。我们矩阵中的每一行将对应一个不同的灰度级，每一列将对应一个不同的游程长度。位于第 $g$ 行和第 $l$ 列的条目，我们称之为 $R(g,l)$，它就是一个计数：它表示我们观察到灰度级为 $g$、长度恰好为 $l$ 的游程的次数。

让我们用一个简单的例子来具体说明。想象一个小的4x6像素的医学图像块，它已经被简化（量化）为三个灰度级：1、2和3。我们将沿水平（$0^\circ$）方向对其进行分析 [@problem_id:4344356]。

$$
I \;=\;
\begin{pmatrix}
1  & 1  & 1  & 2  & 2  & 3 \\
2  & 2  & 2  & 2  & 3  & 3 \\
1  & 2  & 2  & 2  & 1  & 1 \\
3  & 3  & 1  & 1  & 1  & 2
\end{pmatrix}
$$

让我们逐行扫描：
- **第1行：** 我们发现一个灰度级为 `1` 长度为 `3` 的游程，一个灰度级为 `2` 长度为 `2` 的游程，以及一个灰度级为 `3` 长度为 `1` 的游程。
- **第2行：** 一个灰度级为 `2` 长度为 `4` 的游程，以及一个灰度级为 `3` 长度为 `2` 的游程。
- **第3行：** 一个灰度级为 `1` 长度为 `1` 的游程，一个灰度级为 `2` 长度为 `3` 的游程，以及另一个灰度级为 `1` 长度为 `2` 的游程。
- **第4行：** 一个灰度级为 `3` 长度为 `2` 的游程，一个灰度级为 `1` 长度为 `3` 的游程，以及一个灰度级为 `2` 长度为 `1` 的游程。

现在我们统计这些观察结果来填充我们的GLRLM，$R(g,l)$：

| 灰度级 (g) | 游程长度 (l=1) | l=2 | l=3 | l=4 |
| :---: | :---: | :---: | :---: | :---: |
| **1** | 1 | 1 | 2 | 0 |
| **2** | 1 | 1 | 1 | 1 |
| **3** | 1 | 2 | 0 | 0 |

就这样！我们得到了这个小图像在水平方向上“条纹性”的完整数值摘要。这个矩阵就是我们对纹理的定量描述。

### 从矩阵中提炼精髓：特征的诞生

GLRLM是一个很棒的工具，但它仍然是一整张数字表格。通常更有用的是将其精髓提炼成几个总结性统计数据，或称为**特征**，以捕捉其最重要的特性。这就像用身高、体重和年龄来描述一个人，而不是展示他的完整病历。

#### 粗糙度 vs. 细腻度：强调游程

让我们问一个简单的问题：这个纹理是粗糙且有条纹的，还是细腻且呈颗粒状的？一个粗糙的纹理，比如木纹，会有很多长游程。一个细腻的纹理，比如沙子，会有很多短游程。我们可以设计对这种差异敏感的特征。

诀窍是计算一个加权平均值。为了创造一个强调长游程的特征，我们可以将矩阵中所有的游程计数相加，但给予那些长度 $l$ 较大的计数更多的权重。一个有效的方法是用 $l^2$ 来对每个计数 $R(g,l)$ 进行加权。通过对长度进行平方，我们极大地偏爱了较长的游程。然后我们除以总游程数来得到一个归一化的值。这就得到了**长游程强调（LRE）**特征 [@problem_id:3860059]。

$$ \text{LRE} = \frac{1}{N_r} \sum_{g} \sum_{l} R(g,l) \cdot l^2 $$

其中 $N_r$ 是总游程数。一个高的LRE值告诉我们，纹理主要由长的、同质的条纹构成。

相反，为了强调短游程，我们可以用 $1/l^2$ 来对每个计数进行加权。这会重奖长度为1或2的游程，并严重惩罚较长的游程。这就得到了**短游程强调（SRE）**特征。

$$ \text{SRE} = \frac{1}{N_r} \sum_{g} \sum_{l} R(g,l) \cdot \frac{1}{l^2} $$

一个高的SR[E值](@entry_id:177316)指向一种细粒度的、颗粒状的纹理，其中事物变化迅速 [@problem_id:5221694]。

#### 均匀性与异质性：一种衡量[同质性](@entry_id:636502)的方法

GLRLM还能告诉我们什么？我们可以问关于纹理均匀性的问题。例如，游程是均匀分布在所有不同的灰度级上，还是集中在一两个灰度级上？

要回答这个问题，我们可以看我们矩阵的边缘分布。如果我们将每一行中的计数相加，我们会得到一个直方图，它告诉我们每个灰度级存在多少游程，而不考虑它们的长度。如果我们将每一列中的计数相加，我们会得到一个直方图，它告诉我们每种长度的游程有多少，而不考虑它们的灰度级。

从这些[直方图](@entry_id:178776)中，我们可以定义另外两个特征。**灰度不均匀性（GLNU）**衡量游程在灰度级上的分布有多均匀。如果所有灰度级的游程出现频率相同，那么灰度直方图是平坦的，GLN[U值](@entry_id:151629)就低。如果大多数游程属于单一灰度级，那么直方图是尖峰状的，GLNU值就高。类似地，**游程长度不均匀性（RLNU）**衡量游程在不同长度上的分布有多均匀 [@problem_id:3860039]。

这两个特征捕捉了纹理根本不同的方面。一幅图像的游程可能完美地分布在所有灰度级中（低GLNU），但几乎所有这些游程的长度都可能为一（高RLNU）。这将描述一种有噪声但均衡的纹理。另一幅图像可能以相同的比例拥有各种不同长度的游程（低RLNU），但它们可能都属于单一灰度级（高GLNU），这描述了一种结构多样但色调单调的纹理。

### 纹理的宇宙：GLRLM的背景

计算游程是一个强大的想法，但它不是唯一的。为了真正欣赏其独特的优势，我们必须将它与其在[纹理分析](@entry_id:202600)世界中的“亲戚”进行比较。

#### 游程 vs. 像素对：GLRLM vs. GLCM

另一种方法是完全忽略游程，而只计算像素对。**灰度共生矩阵（GLCM）**记录了在特定距离和方向上，一个灰度级为 $i$ 的像素旁边出现一个灰度级为 $j$ 的像素的频率 [@problem_id:4552601]。

那么哪个更好呢？这取决于你问的问题。想象一下分析一张[纤维化](@entry_id:156331)组织的组织学切片，其特点是长而均匀的胶原蛋白束 [@problem_id:4354414]。一段长的胶原蛋白游程在GLRLM中会被记录为一个单一、强大的条目——例如，“一个长度为20的游程”。相比之下，GLCM会将其记录为19个独立但相同的相邻像素对。虽然GLCM中相同像素对的高计数确实*暗示*了[同质性](@entry_id:636502)，但它并没有直接测量结构的长度。GLRLM在捕捉我们正在寻找的东西——同质游程的长度——方面更为*直接*和明确。

#### 线条 vs. 斑点：GLRLM vs. GLSZM

GLRLM建立在一维概念之上：线性游程。但如果纹理的特征是二维的“斑点”或三维的“区域”呢？为此，我们有另一个工具：**灰度尺寸区域矩阵（GLSZM）**。GLSZM不是寻找线性游程，而是识别具有相同灰度值的连续像素区域（区域），并记录它们的大小（区域中的像素数） [@problem_id:4613003]。

这揭示了一个深刻的哲学差异。GLRLM从根本上是**方向性的**（各向异性）。你必须选择一个方向（$0^\circ, 45^\circ, 90^\circ$等）来寻找游程。而基于连通性拓扑思想的GLSZM则是**方向无关的**（各向同性）。它不关心方向，只关心像素是否连接成一个区域。

这就导致了一个关键的权衡。如果你想知道一个纹理是否有首选的方向（比如木材的纹理），GLRLM是你的工具。但如果你想要一个在图像旋转时保持稳定不变的描述，GLSZM在本质上更具鲁棒性，因为它的定义本身不依赖于方向 [@problem_id:4613003]。

### 从理论到现实：实践中的挑战

到目前为止，我们的旅程一直处在一个干净、理想化的世界里，图像是2D的，像素是完美的正方形。而现实世界，尤其是在医学成像等领域，要混乱得多，也远为有趣。

#### 各向异性问题

像CT或MRI这样的医学扫描通常产生3D图像，其中的体素（3D像素）并非完美的立方体。它们可能是长方体，间距比如说为 $(1, 1, 3)$ 毫米。这被称为**各向异性间距**，它构成了一个严峻的挑战 [@problem_id:4834599]。

想象一个物理结构是完美球形的。如果我们用这些各向异性的体素来采样它，它在我们的[数字图像](@entry_id:275277)中会显得被压扁了。沿着精细分辨率轴（1毫米间距）的5个体素的游程，在物理上比沿着粗糙分辨率轴（3毫米间距）的5个体素的游程要短得多。如果我们天真地基于体素计数来计算我们的GLRLM特征，我们的结果将会有无可救药的偏差。纹理在最粗糙采样方向上会显得人为地“更细腻”（更高的SRE）。

我们如何解决这个问题？有两种绝妙的方法。暴力法是在分析前将整个图像重采样到一个各向同性（立方体）体素的网格中。一个更优雅的解决方案是调整特征计算本身。我们可以计算游程在毫米单位下的真实物理长度，而不是使用以体素为单位的游程长度，并将其用于我们的公式中。这两种方法都旨在恢复被测物体的物理真实性 [@problem_id:4834599]。

#### 旋转问题与加权平均之美

GLRLM的方向性既是优点也是缺点。为了得到一个单一、旋转稳定的3D纹理描述，我们通常会沿着许多方向（例如，一个3x3x3邻域中的13个唯一方向）计算特征，然后对它们进行平均。但简单的平均只有在我们的采样方向在所有可能方向的球面上完全均匀分布时才是正确的。

一个更具原则性的方法是近似于在球体表面上的真实积分。为每个方向计算的特征应该由该方向在我们的采样方案中所代表的[立体角](@entry_id:154756)——即“天空中的一块”——来加权。对于从球面细分生成的一组方向，这个权重就是该方向在球面上的[沃罗诺伊单元](@entry_id:144746)的面积 [@problem_id:4613002]。这是几何学与[数值分析](@entry_id:142637)为解决一个非常实际的问题而进行的美妙结合，确保我们最终的数值是所有方向上的一个真实而公平的平均值。

#### 标准化的需求

有这么多的选择——灰度级的数量、方向的集合、如何处理各向异性、如何汇总结果——科学家们如何才能比较他们的发现？如果两个研究小组分析相同的数据但做出不同的选择，他们会得到不同的结果。这就要求进行标准化。

像**图像生物标志物标准化倡议（IBSI）**这样的倡议为计算这些特征提供了一套严格的“规则手册” [@problem_id:4917094]。IBSI规定了诸如在3D中使用26连通性来定义GLSZM区域，定义GLRLM的13个标准方向，以及阐明了汇总方向性特征的两种不等效方法（在特征计算前平均矩阵，或平均最终的特征值）。通过遵守这样的标准，科学界确保了这些强大的思想能够转化为可重复和可靠的发现和诊断工具。“游程”这个简单的想法已经发展成为一门成熟、标准化的科学，这证明了从最简单的基础上构建复杂知识的力量。

