## 应用与跨学科联系

在我们之前的讨论中，我们揭示了[终端集](@article_id:343296)在[模型预测控制](@article_id:334376)中的优雅作用。我们视其为一个“安全港”，一个保证稳定的区域，在这里，一个简单可靠的局部控制器可以接管，让那个具有远见但计算密集的MPC可以放心，其长期目标是安全的。这个概念，尽管在其理论纯粹性上很美，但可能看起来像一个脆弱的结构，是为只有完美模型和简单目标的理想化世界设计的。

但故事到这里才真正开始。一个科学原理的真正力量和美感，并非体现在其无菌的完美之中，而是在面对现实世界复杂性时的韧性和适应性。[终端集](@article_id:343296)不是一件精致的玻璃雕塑；它是一块可以被塑造成型，并应用于各种极具挑战性、实用性和前沿性问题的万能粘土，一个通用锚点。在本章中，我们将踏上一段旅程，看看这一个简单的思想如何成为一条统一的线索，贯穿于现代控制工程广阔而复杂的领域。

### 驾驭物理世界：约束、延迟和变化的动态

世界并不像我们基本线性模型所暗示的那样简单。执行器有速度限制，信息传输需要时间，系统也常常会改变其基本行为。一个幼稚的MPC控制器会很快在这些暗礁上搁浅。然而，[终端集](@article_id:343296)为驾驭它们提供了一个框架。关键的洞见是，我们通常可以通过丰富我们对系统“状态”的定义来处理复杂性。

想象一下控制一个大型工业阀门。你可以命令它完全打开或完全关闭，但你不能命令它瞬间完成。它有一个最大的移动速率。这种*速率约束*为系统引入了一种记忆形式：阀门明天可达到的位置集合取决于它今天的位置。为了处理这个问题，我们必须采取一个简单但深刻的技巧：我们增广状态。这里的“状态”不再仅仅是我们系统的物理配置（$x_k$），而是我们预测其未来所需知道的一切。在这种情况下，前一个控制输入 $u_{k-1}$ 成为状态的一部分。我们新的增广状态是 $\xi_k = [x_k, u_{k-1}]$。[终端集](@article_id:343296)现在不是在原始状态空间中设计，而是在这个更丰富的增广空间中作为一个安全港，从而在尊重硬件固有物理限制的同时确保稳定性 [@problem_id:2724669]。

[状态增广](@article_id:301312)的原则是一个强大且反复出现的主题。考虑一个有显著*[时间延迟](@article_id:330815)*的系统，比如一个物料必须流经长管道的化工过程。你现在施加的输入 $u_k$ 要在未来某个时间 $d$ 之后才会影响设备。系统在接下来 $d$ 步的演化已经由一个过去的输入队列 $\{u_{k-1}, u_{k-2}, \dots, u_{k-d}\}$ 决定了。我们再次看到，系统的真实状态——其完整的记忆——包括了这个输入队列。通过增广状态以包含这个输入队列，我们将[延迟系统](@article_id:334260)转换为了一个更大但无延迟的系统。然后我们可以为这个增广系统设计一个[终端集](@article_id:343296)，使MPC能够智能地规划其行动，同时充分考虑预定的未来演化 [@problem_id:2736376]。

世界也不是静止的。一个机器人可能有行走和奔跑两种步态；一个[化学反应器](@article_id:383062)可能会在不同的生产阶段之间切换。这些是*混合*或*[切换系统](@article_id:334965)*，其中控制动态，即矩阵 $A$ 和 $B$，会随时间变化。当系统的潮汐和水流可以不可预测地变化时，我们如何定义一个单一的“安全港”呢？解决方案在于找到一个对这些变化具有鲁棒性的[终端集](@article_id:343296)和终端控制器。一个强有力的方法是设计一个对*所有*可能的操作模式都可证明不变的单一[终端集](@article_id:343296)。这意味着无论哪个动态被激活，局部控制器都能保证将状态维持在安全港内。这可能需要找到一个对所有模式都递减的[公共李雅普诺夫函数](@article_id:357868)，或者一个能稳定所有模式的单一控制器 [@problem_id:2711976] [@problem_id:2746576]。[终端集](@article_id:343296)变成了一个普适的条约，一个由系统所有可能的未来版本共同商定的稳定区域。

### 从稳定到愿景：跟踪、经济性和安全性

到目前为止，我们一直将[终端集](@article_id:343296)视为实现稳定性的工具——将系统带到原点静止下来。但我们很少仅仅为了看着复杂机器静止不动而去建造它们。我们希望它们能*做*事：跟踪路径、最大化利润或安全运行。[终端集](@article_id:343296)框架出色地适应了这些更崇高的目标。

除了稳定之外，最常见的目标是*[参考跟踪](@article_id:349843)*。我们不是要将状态驱动到零，而是希望输出 $y_k$ 跟随一个[期望](@article_id:311378)的参考 $r_k$。对于一个恒定的[设定点](@article_id:314834) $r_s$，我们首先求解相应的[稳态](@article_id:326048)目标 $(x_s, u_s)$。然后，整个MPC问题，包括[终端集](@article_id:343296)，都是根据与这个目标的偏差来制定的。[终端集](@article_id:343296)成为一个以[期望](@article_id:311378)目的地 $x_s$ 为中心的安全港。但如果我们的模型不完美，或者存在一个恒定的扰动（比如持续的风或有偏差的传感器），会发生什么？实现参考所需的真实[稳态](@article_id:326048)将不同于我们计算出的 $(x_s, u_s)$。为了解决这个问题，我们援引著名的*内部模型原理*。我们用一个代表未知恒定扰动的状态来增广我们的系统模型。然后，一个观测器在线估计这个扰动。MPC使用这个估计值在每一步计算*正确*的[稳态](@article_id:326048)目标，从而实现无偏跟踪。[终端集](@article_id:343296)仍然是那个锚，但它是一个被智能地重新定位的锚，以适应系统的现实情况，而不仅仅是其理想化模型 [@problem_id:2737789]。

我们可以用*经济MPC*将这个想法推得更远。如果我们没有一个具体的参考点需要跟踪怎么办？如果目标仅仅是尽可能高效地运行一个过程——最小化能耗或最大化生产率呢？在这里，成本函数 $\ell(x,u)$ 不是衡量与设定点距离的指标，而是经济性能的直接度量。问题在于，这个经济成本不一定在稳定的[平衡点](@article_id:323137)处最小化。经济MPC的精妙之处在于利用了*耗散性*（dissipativity）的概念。如果系统满足耗散性属性，我们可以从数学上“旋转”经济成本，定义一个新的辅助成本函数，该函数在经济最优[稳态](@article_id:326048) $(x_s, u_s)$ 处被最小化。这使我们能够将对经济最优性的追求与稳定性的数学联系起来。然后我们围绕这个最高效率点构建我们的[终端集](@article_id:343296)，创造一个“最优性能的安全港”。因此，控制器被驱动到的不是一个任意的[设定点](@article_id:314834)，而是它能找到的最有利可图和可持续的操作点 [@problem_id:2724659]。

也许最关键的现代应用是确保*安全性*。对于一辆[自动驾驶](@article_id:334498)汽车来说，避免碰撞比完美地沿着车道中心线行驶更重要。在这里，我们可以使用*[控制屏障函数](@article_id:356847)*（Control Barrier Function, CBF）在数学上定义一个安全集 $\mathcal{S}$。然后，MPC优化在每一步都被增加一个额外的约束：预测的状态必须保持在安[全集](@article_id:327907)内。为确保这个保证无限期有效，[终端集](@article_id:343296)本身必须是安[全集](@article_id:327907)的子集，即 $\mathcal{X}_f \subseteq \mathcal{S}$。此外，终端控制器必须被证明是一个“安全”的控制器，这意味着从 $\mathcal{X}_f$ 内的任何状态出发，它都不会将系统引出 $\mathcal{S}$。[终端集](@article_id:343296)不再仅仅是一个稳定区域；它是一个*可证明安全的稳定区域*，一个确保MPC的短期优化永远不会危及长期安全的锚点 [@problem_id:2695300]。

### 弥合与现实的差距：观测器与鲁棒性

我们的旅程还有最后一站：我们必须面对两个真相——我们永远无法完美地知道一个系统的状态，并且扰动很少是简单的常数。

在现实世界中，我们无法直接访问状态 $x_k$；我们拥有的是来自传感器的带噪声的测量值 $y_k$。我们使用*观测器*来估计状态 $\hat{x}_k$，并将此估计值提供给MPC控制器。对于无约束的线性系统，著名的*[分离原理](@article_id:326940)*告诉我们，我们可以分开设计控制器和观测器而不会有问题。但在MPC的硬约束下，这个原理失效了。控制器基于其信念 $\hat{x}_k$ 所做的动作，对于名义模型可能是完全有效的，但可能导致*真实*状态 $x_k$ 违反约束。稳定性分析变成了一场在观测器误差（$e_k = x_k - \hat{x}_k$）与控制回路之间的精妙舞蹈。[终端集](@article_id:343296)仍然保证名义MPC回路（“大脑”）的稳定性，但整个系统只有在这个回路足够鲁棒以容忍来自观测器的必然误差时才是稳定的。证明通常依赖于一个*小增益论证*：如果观测器足够快（误差增益小），并且MPC足够鲁棒（对误差的灵敏度增益小），那么互联系统保持稳定 [@problem_id:2884319]。

最后，对于那些不是常数，而只是未知有界的扰动呢？在这里，我们使用*[基于管的MPC](@article_id:357633)*（tube-based MPC）这一强大思想。我们将真实的、受扰动的状态轨迹想象为存在于一个“管”（tube）内，这个管围绕着由MPC计算出的名义无扰动轨迹。[终端集](@article_id:343296)为管中心的名义轨迹提供了稳定性的锚点。为确保真实状态永远不违反约束，我们使用*[约束收紧](@article_id:354017)*（constraint tightening）：我们通过一个至少与管半径一样大的裕度，迫使名义轨迹远离约束边界。这确保了即使扰动将真实状态推到管的边缘，它仍然保持在原始的安全操作区域内。[终端集](@article_id:343296)确保名义[系统收敛](@article_id:368387)，而管则确保真实系统安全地跟随它 [@problem_id:2712869]。

### 一幅统一的画布

从速率限制到输入延迟，从混合系统到经济目标，从安全屏障到噪声传感器，我们一次又一次地看到了同一个基本思想的出现。[终端集](@article_id:343296)是一种机制，通过它，我们将长期、稳定和安全的行为保证[嵌入](@article_id:311541)到有限时域的、短视的优化问题中。它是一个锚点，连接了数学预测的理想世界与物理世界的混乱、受约束和不确定的现实。它展示了一个深刻的工程学原理：通过在短期内明智地约束我们的选择（通过强制预测状态进入[终端集](@article_id:343296)），我们可以解锁一种远为更广阔的自由——保证长期性能和安全的自由。