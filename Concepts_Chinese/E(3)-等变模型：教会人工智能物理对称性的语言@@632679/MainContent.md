## 引言
为物理世界建模是人工智能面临的宏大挑战之一。宇宙遵循着对称的基本定律——无论位置或朝向如何，这些定律的行为方式都相同。然而，标准的[机器学习模型](@entry_id:262335)对这种潜在的几何结构是“盲目”的，它们会将一个旋转过的分子视为一个全新的、不相关的数据点。这种无知造成了巨大的知识鸿沟，导致数据效率低下，并且无法泛化基本的物理原理。

本文探讨了 E(3)-等变模型，这是一类革命性的[神经网](@entry_id:276355)络，它们通过将三维空间的对称性直接构建到其架构中来解决这个问题。这些模型不仅从数据中学习，还从物理学本身的基本规则中学习。首先，在“原理与机制”一章中，我们将解析[不变性](@entry_id:140168)和[等变性](@entry_id:636671)的核心概念，并探索使这些网络能够用几何方式“思考”的数学工具包——从球谐函数到[张量积](@entry_id:140694)。随后，“应用与跨学科联系”一章将展示这种方法的深远影响，揭示这些模型如何在[分子模拟](@entry_id:182701)、[药物发现](@entry_id:261243)和[材料科学](@entry_id:152226)领域开辟新前沿。

## 原理与机制

要构建一个能够理解物理世界的模型，我们必须首先教会它游戏的基本规则。这些规则中最深刻的并非复杂的方程，而是简单而优雅的对称性原理。毕竟，无论我们是在实验室的一角还是另一角进行实验，物理定律都不会改变；它们也不依赖于我们仪器指向的方向。宇宙的本质，并不会因我们选择的[坐标系](@entry_id:156346)而改变。

### 对称的交响曲：[不变性](@entry_id:140168)与[等变性](@entry_id:636671)

三维空间中所有这些[对称操作](@entry_id:143398)的集合——所有可能的平移和旋转——构成了一个称为**欧几里得群**（Euclidean group）或 $E(3)$ 的数学对象。当我们说某个属性遵守这些对称性时，我们可能指两种相关但截然不同的性质之一：不变性或[等变性](@entry_id:636671)。

想象一个孤立水分子的总[势能](@entry_id:748988)。这个能量是一个标量，一个单一的数值，它取决于氢原子和氧原子的相对位置。如果我们拿起整个分子并将它移动到房间的另一端（平移），或者将它上下颠倒（旋转），其内能完全保持不变。能量在 $E(3)$ 群的作用下是**不变的**（invariant）。从数学上讲，如果一个函数 $f$ 代表一个不变属性，而 $g$ 是 $E(3)$ 中的一个变换，那么将变换应用于输入 $X$ 根本不会改变输出 [@problem_id:3464249]：

$$
f(g \cdot X) = f(X)
$$

现在，考虑一个不同的属性，比如作用在每个原子上的力。这些力是矢量，既有大小也有方向。如果我们旋转分子，这些力不会保持指向相同的绝对方向；它们会随分子一起旋转。这个属性不是不变的，但也不是随机的。它以一种可预测的、相应的方式进行变换。这就是**[等变性](@entry_id:636671)**（equivariance）的本质。风向标是一个绝佳的类比：它对风向不是不变的，而是等变的——它会忠实地旋转以指向风吹来的任何方向。

形式上，如果对于一个变换 $g$，对输入进行变换会导致输出发生相应的变换，那么函数 $f$ 就是**等变的**（equivariant）[@problem_id:2784668]。这可以写成：

$$
f(g \cdot X) = \mathcal{D}(g) f(X)
$$

在这里，$\mathcal{D}(g)$ 是群在输出空间上的作用表示。对于标量能量，$\mathcal{D}(g)$ 就是数字 $1$，这将[等变性](@entry_id:636671)简化为不变性。对于像力或偶极矩这样的矢量输出，$\mathcal{D}(g)$ 就是旋转矩阵本身，确保输出矢量与输入系统旋转的方式完全相同。

### 架构师的困境：为何朴[素模型](@entry_id:155161)会失败

我们如何构建一个由数字和矩阵构成的机器学习模型，使其能够理解这些深刻的对称性呢？一种朴素的方法可能是简单地将原子的原始笛卡尔坐标输入到一个标准的[神经网](@entry_id:276355)络中。然而，这样的网络没有内置的三维空间概念。它会把一个分子及其旋转后的副本视为两个完全不同、不相关的输入。为了学习物理学的旋转对称性，它需要看到每种结构的无数个旋转示例，这是一项导致数据效率和泛化能力低下的西西弗斯式任务 [@problem_id:2479779]。

一种更复杂但仍有缺陷的方法是在输入上做文章。我们可以只使用**不变特征**来描述分子——即那些不随旋转而改变的量，比如所有原子间距离的集合。如果我们的目标是预测另一个不变的量，比如总能量，这是一个绝妙的策略 [@problem_id:2784682]。该模型在构造上将是 $E(3)$ 不变的。

但是，如果我们要求这个模型预测一个[等变性](@entry_id:636671)质的量，比如[分子偶极矩](@entry_id:152656)，会发生什么呢？模型的输入对分子的朝向是“盲目”的。因此，它的输出也必须对朝向“盲目”。无论分子如何旋转，模型都会固执地预测同一个矢量。对于一个包含同一分子多种朝向的数据集，不变模型唯一可能学到的自洽预测就是[零矢量](@entry_id:155273)，因为任何非[零矢量](@entry_id:155273)都会被旋转成一个不同的矢量，从而产生矛盾 [@problem_id:2903793]。这揭示了一个根本性的不匹配：你无法从一个纯粹不变的输入中产生一个等变的输出。

### 说几何的语言：等变模型的秘诀

解决方案不是抛弃几何，而是拥抱它。网络内部的“语言”本身必须是几何的。这就是 $E(3)$-等变模型背后的核心思想。这些网络不是处理简单的数字，而是处理**几何张量**——这些对象在旋转下具有明确定义的行为，例如标量（0阶）、矢量（1阶）和更高阶的张量。用群论的语言来说，这些特征作为旋转群的[不可约表示](@entry_id:263310)（irreps）进行变换。

这些模型通常作为图神经网络运行，其中原子是节点，它们之间的连接是边。“消息”从一个原子传递到另一个原子的方式必须以保持[等变性](@entry_id:636671)的方式构建。这是通过一个结合了物理学和数学的优美秘诀实现的 [@problem_id:2648604]：

1.  **解构几何**：两个原子 $i$ 和 $j$ 之间的几何关系是相对位置矢量 $\mathbf{r}_{ij} = \mathbf{r}_j - \mathbf{r}_i$。这个矢量被分解为两部分：它的长度 $r_{ij}$（一个旋转不变的标量）和它的方向 $\hat{\mathbf{r}}_{ij}$（包含了所有的旋转信息）。

2.  **用[球谐函数](@entry_id:178380)编码方向**：方向信息使用**球谐函数** $Y_{lm}(\hat{\mathbf{r}}_{ij})$ 进行编码。这些函数是球面上的自然“[振动](@entry_id:267781)模式”，每一个都对应一种特定类型的[旋转对称](@entry_id:137077)性（一个阶数为 $l$ 的不可约表示）。

3.  **用张量积组合特征**：为了创建一个新特征，模型将原子上的一个现有特征（比如一个类型为 $l_1$ 的张量）与来自[球谐函数](@entry_id:178380)的几何信息（一个类型为 $l_2$ 的张量）相结合。这是通过**张量积**完成的。想象一下将两个音符相乘形成一个和弦；得到的和弦是一个更复杂的对象，但其结构与原始音符直接相关。

4.  **用 Clebsch-Gordan 系数分解**：来自张量积的“和弦”随后使用 **Clebsch-Gordan 系数**被分解回基本“音符”（不可约表示）的总和。这个关键步骤确保新创建的特征也是行为良好的几何张量，具有已知的旋转属性。

此过程中的每个可学习参数都是不变距离 $r_{ij}$ 的[简单函数](@entry_id:137521)，确保它们不会破坏优美的几何结构。通过用这些等变操作逐层构建网络，整个架构从构造上就保证了尊重旋转对称性。这是一个不只是处理数字的系统；它处理的是几何。值得注意的是，这种精密的机制很容易被破坏。例如，对矢量特征的分量应用一个标准的[非线性](@entry_id:637147)函数（如 ReLU 函数），会粉碎其精心保持的[等变性](@entry_id:636671) [@problem_id:2760146]。

### 完善图景：平移、反演与恒等

物理世界的完全对称[性比](@entry_id:172643)单纯的旋转更加丰富。

-   **平移**：处理平移很简单。通过将整个模型建立在相对位置矢量 $\mathbf{r}_{ij}$ 的基础上，网络对整个系统的任何全局平移变得完全不敏感。这是实现[平移等变性](@entry_id:636340)的内置方式 [@problem_id:2648604]。

-   **反演与宇称**：[旋转群](@entry_id:204412) $SO(3)$（[行列式](@entry_id:142978)为 $+1$）是完整[正交群](@entry_id:152531) $O(3)$ 的一个[子群](@entry_id:146164)，后者还包括了反演和[瑕旋转](@entry_id:151532)（[行列式](@entry_id:142978)为 $-1$）。为了处理这些[瑕旋转](@entry_id:151532)，我们必须追踪我们特征的**宇称**（parity）。位置矢量是一个“极性”矢量；它在反演下会变号（$\mathbf{r} \to -\mathbf{r}$）。角动量矢量是一个“轴向”矢量；它则不会。通过为每个特征分配一个宇称标签并强制执行宇称组合规则，模型可以被塑造成完全 $O(3)$-等变的，从而能够正确处理手性（chiral）或“有手性”的系统 [@problem_id:3449477]。

-   **[置换](@entry_id:136432)**：在一个包含多种相同元素的系统中，比如一个[二元合金](@entry_id:160005)，给定种类的原子在物理上是不可区分的。交换分子中的两个碳原子不会改变它的能量。一个有效的模型必须对这类[置换](@entry_id:136432)保持不变。依赖于列表中原子固定顺序的架构将无法通过这个测试。正确的方法是使用一个[置换](@entry_id:136432)不变的操作，比如求和或平均。例如，对于一个由物种 $A$ 和 $B$ 组成的[二元合金](@entry_id:160005)，人们会分别聚合所有 $A$ 原子的特征和所有 $B$ 原子的特征，比如在每个物种内求和，然后再将它们组合以计算跨物种的相互作用 [@problem_id:3449439]。

### 物理上的回报：从几何优雅到[能量守恒](@entry_id:140514)

这些原理的优雅之处不仅仅是美学上的；它具有深远的实际意义。考虑预测原子力的两种主要策略。

**策略 1：保守路径**。我们可以构建一个 $E(3)$-不变模型来预测[标量势](@entry_id:276177)能 $E$。然后，通过取能量相对于原子位置的负梯度，便可以免费获得力：$\mathbf{F}_i = -\nabla_{\mathbf{r}_i} E$。作为矢量微积分的直接推论，如果能量 $E$ 被保证是一个[标量不变量](@entry_id:193787)，那么由它导出的力在数学上就保证是等变矢量 [@problem_id:2479779]。这种方法从构造上就产生了一个**[保守力场](@entry_id:164320)**。

**策略 2：直接路径**。或者，我们可以构建一个完全 $E(3)$-等变模型来直接预测力矢量。虽然这能确保力正确地变换，但它带有一个微妙的陷阱：由此产生的[力场](@entry_id:147325)不保证是保守的。在高维[构型空间](@entry_id:149531)中，该[力场的旋度](@entry_id:174409)可能不为零 [@problem_id:2479779]。

这个区别对于分子动力学模拟至关重要。使用[保守力场](@entry_id:164320)进行的模拟，在配合适当的[数值积分器](@entry_id:752799)的情况下，将在长时间内保持总[能量守恒](@entry_id:140514)。然而，使用[非保守力](@entry_id:163431)场进行的模拟将表现出虚假的、非物理的[能量漂移](@entry_id:748982)，持续地加热或冷却，使其无法用于研究平衡性质 [@problem_id:3449458]。因此，模型架构上的对称性约束与它旨在描述的[物理学中的守恒定律](@entry_id:266475)深度相连——这是[诺特定理](@entry_id:145690)在机器学习世界中的一次优美体现。

