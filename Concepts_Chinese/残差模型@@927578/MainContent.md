## 引言
科学模型是理解复杂现象的强大工具，从[鸟类飞行](@entry_id:276063)到药物在人体内的旅程。然而，这些模型是对充满噪声的现实的简化。在药代动力学中，这种噪声或变异主要有两种形式。第一种是个体间变异，它解释了人与人之间固有的生物学差异。第二种，也是本文的重点，是残差未解释变异（Residual Unexplained Variability, RUV）——即使我们为个体建立了最优模型后仍然存在的“模糊”部分。这种 RUV 可能源于测量不精确、微小的生物波动或模型本身的轻微不完善。

本文探讨了如何数学地描述和解释这种残差变异这一关键挑战。忽视或错误描述它可能导致错误的结论、有偏的预测和虚假的确定感。为了解决这个问题，您将学习为此目的设计的关键统计工具：残差模型。

在接下来的章节中，我们将首先深入探讨三种最常见的残差模型——加性、比例和组合模型的基础“原理和机制”。我们将探索它们的数学基础以及它们对[模型拟合](@entry_id:265652)和诊断的深远影响。随后，在“应用和跨学科联系”部分，我们将看到这些理论概念如何在药物开发的真实世界中应用，从根据实验室仪器特性为模型选择提供信息，到实现稳健的预测，并联系到神经科学等领域的类似挑战。

## 原理和机制

想象一下，你正试图理解一群鸟的飞行。你可能会从描述一只“典型”鸟的“平均”飞行路径开始。这就是科学模型的本质——对复杂现实的简化、优雅的描述。但现实从未如此清晰。并非所有的鸟都完全相同；有些更强壮，有些更年长，有些今天只是想飞得有点不一样。这是变异的一个来源。此外，即使是对于单只鸟，它的路径也会受到随机阵风的冲击，而我们试[图追踪](@entry_id:263851)它时，我们的双筒望远镜可能会晃动。这是第二个、截然不同的变异来源。

在药代动力学领域，当我们追踪药物在体内的浓度随时间变化时，我们面临着完全相同的挑战。我们的模型描述了药物在典型人体内的旅程，但它们也必须解释两种根本不同的随机性世界[@problem_id:4568925]。首先，存在**个体间变异（inter-individual variability, IIV）**：一个简单的事实，即你不是我。你的身体清除药物的能力（$CL$）或药物分布的容积（$V$）可能与我的不同。这就是“一群鸟”的问题。我们通过引入**随机效应**来对此建模，这些数学术语允许每个个体的参数偏离群体平均值[@problem_id:4581432]。

但是，即使我们能够完美地知道一个个体独特的参数，我们的预测也无法与他们测得的药物浓度完全匹配。总会存在一些残留的“模糊”或“噪声”。这是第二个随机性世界，我们称之为**残差未解释变异（Residual Unexplained Variability, RUV）**。这就是“一阵风”的问题。它是一个包罗万象的术语，涵盖了我们模型未能解释的所有其他因素：实验室分析在测量浓度时的固有局限性、瞬间的微小生物波动，甚至是我们的结构模型中的轻微不完善。我们用来描述这种模糊性的数学工具是**残差模型**。理解并选择正确的模型不仅仅是一个统计形式问题；它是构建一个既诚实又有用的模型的关键。

### 误差陈列室：噪声的三副面孔

我们如何描述这种残差噪声呢？事实证明，我们在生物系统中遇到的大多数“模糊”现象都可以用一些简单而优美的思想来表征。这些思想催生了三个主要的残差模型族[@problem_id:3920806]。假设我们的结构模型预测个体 $i$ 在时间 $j$ 的浓度为 $f_{ij}$。实际观测到的浓度是 $y_{ij}$。这些模型描述了 $y_{ij}$ 与 $f_{ij}$ 之间的关系。

#### 加性模型：持续的嗡嗡声

最简单的模型是**加性残差模型**：

$$y_{ij} = f_{ij} + \epsilon_{\mathrm{add},ij}$$

在这里，误差 $\epsilon_{\mathrm{add},ij}$ 是从一个分布（通常是均值为零、方差恒为 $\sigma_{\mathrm{add}}^{2}$ 的高斯分布，即“[钟形曲线](@entry_id:150817)”）中抽取的随机数[@problem_id:4568901]。

可以把这想象成收音机里持续的背景嗡嗡声或静电噪音。静电噪音的音量不取决于音乐的音量。它只是总在那里，给每个信号增加一个固定量的随机噪声。当我们认为测量误差的绝对大小是恒定的，无论我们测量的是高浓度还是低浓度时，这个模型是合适的。这类误差的一个常见来源是分析仪器的“噪声基底”[@problem_id:3920806]。一个关键的推论是，我们观测值的方差是恒定的，并且不依赖于预测浓度：$\operatorname{Var}(y_{ij}) = \sigma_{\mathrm{add}}^{2}$[@problem_id:4568901]。

#### 比例模型：基于百分比的误差

接下来是**比例残差模型**：

$$y_{ij} = f_{ij}(1 + \epsilon_{\mathrm{prop},ij})$$

在这种情况下，误差是乘性的。如果 $\epsilon_{\mathrm{prop},ij}$ 是，比如说，$0.05$，这意味着观测值比预测值高 $5\%$。如果是 $-0.05$，则低 $5\%$。误差是真实值的一个*分数*。

想象一台有问题的复印机，它会随机地将图像放大或缩小一个很小的百分比。对于一张大海报，$1\%$ 的误差是一个比在邮票上 $1\%$ 的误差大得多的绝对污点。这就是比例误差的本质。当*相对*误差在整个测量范围内保持恒定时，该模型是合适的。在这个模型中，观测值的标准差与预测值 $f_{ij}$ 成正比，但**[变异系数](@entry_id:272423)（CV）**——标准差与均值的比值——是一个常数 $\sigma_{\mathrm{prop}}$[@problem_id:4568901]。方差随预测值的平方增长：$\operatorname{Var}(y_{ij}) = f_{ij}^{2}\sigma_{\mathrm{prop}}^{2}$。

处理这种误差结构时常用的一个技巧是对数据进行对数转换。如果我们对比例模型取自然对数，我们得到 $\ln(y_{ij}) = \ln(f_{ij}) + \ln(1 + \epsilon_{\mathrm{prop},ij})$。如果误差 $\epsilon_{\mathrm{prop},ij}$ 很小，我们可以使用近似式 $\ln(1+x) \approx x$。这将原始尺度上的[乘性](@entry_id:187940)误差转换成对数尺度上近似的加性误差[@problem_id:3920806]。这是一个非常方便的数学简化，但重要的是要记住它是一个近似。一个精确的对数正态误差模型，$y_{ij} = f_{ij} \exp(\epsilon_{ij})$，略有不同，并且在不加思考地反向转换时，可能会在预测中引入需要校正的系统性偏差[@problem_id:5046130]。

#### 组合模型：两全其美

那么，到底是哪种情况呢？误差是恒定的嗡嗡声还是百分比税？在许多现实世界的生物分析中，答案是：两者都有。在非常低的浓度下，仪器的背景噪声（加性误差）是误差的主要来源。你无法以零误差测量零浓度。但在高浓度下，恒定的背景嗡嗡声可以忽略不计，而随浓度变化的误差源（如稀释步骤）成为主导。

这一现实催生了**组合加性和比例残差模型**，它简单地融合了这两种思想[@problem_id:4581432]：

$$y_{ij} = f_{ij}(1 + \epsilon_{\mathrm{prop},ij}) + \epsilon_{\mathrm{add},ij}$$

假设加性误差和比例误差分量是独立的，它们的方差简单相加。一个观测值的总方差现在是一个优美的混合体：

$$\operatorname{Var}(y_{ij}) = f_{ij}^{2}\sigma_{\mathrm{prop}}^{2} + \sigma_{\mathrm{add}}^{2}$$

这个优雅的公式表明，当预测值 $f_{ij}$ 非常小时，[方差近似](@entry_id:268585)为常数（$\sigma_{\mathrm{add}}^{2}$）。当 $f_{ij}$ 非常大时，方差随预测值的平方（$f_{ij}^{2}\sigma_{\mathrm{prop}}^{2}$）增长[@problem_id:4568901]。

让我们通过一个假设情景来看看它的实际应用。想象我们测试我们的药物测量分析法，发现在真实浓度为 $0 \, \mathrm{mg/L}$ 时，我们测量的标准差是 $0.05 \, \mathrm{mg/L}$。在 $0.5 \, \mathrm{mg/L}$ 时，它是 $0.08 \, \mathrm{mg/L}$，而在 $5 \, \mathrm{mg/L}$ 时，它是 $0.62 \, \mathrm{mg/L}$[@problem_id:5046130]。
一个纯加性模型立刻就失败了；它预测一个恒定的标准差，但我们的标准差显然在增长。一个纯比例模型也失败了；它预测在零浓度时误差为零，但我们观察到了一个非零的误差基底 $0.05 \, \mathrm{mg/L}$。但是一个加性标准差为 $\sigma_{\text{add}} \approx 0.05 \, \mathrm{mg/L}$ 且比例标准差为 $\sigma_{\text{prop}} \approx 0.124$ 的组合模型可以完美地再现所有这三个经验事实。这就是选择正确模型的力量：它使我们能够在其整个动态范围内准确地描述我们测量系统的行为[@problem_id:5046130]。

### 诚实的代价：为什么正确的模型很重要

选择一个误差模型不仅仅是一个美学上的练习。这一选择对整个建模过程有着深远的影响。当我们将[模型拟合](@entry_id:265652)到数据时，我们实质上是在要求计算机找到使我们观测到的数据“最可能”的参数（如 $CL$ 和 $V$）。这种“可能性”的数学表达式是**似然函数**[@problem_id:4523975]。

至关重要的是，[似然函数](@entry_id:141927)的公式直接依赖于我们残差模型所假设的方差。对于加性模型，[似然函数](@entry_id:141927)对所有浓度下观测值与预测值之间的差异赋予同等的重要性或权重。对于比例模型，似然函数的结构使得正确拟合低浓度数据具有更大的权重[@problem_id:4568901]。

如果我们对模型撒谎会怎样？如果我们使用加性模型而事实是比例模型会怎样？模型将在高浓度下看到预测与观测之间非常大的偏差。由于不明所以，它无法将其归因于关于残差的错误假设。相反，它可能会得出结论：“哇，这个人在这个高浓度下的数据与典型预测相差甚远。这个人一定非常不同！”为了解释这一点，模型可能会夸大其对个体间变异（IIV）的估计。真正属于残差模型的方差被错误地归咎于随机效应。这种现象，一种“方差混淆”，可能导致严重高估人与人之间的差异程度，而这一切都仅仅因为我们选择了错误的镜头来观察残差噪声[@problem_id:4592580] [@problem_id:4523965]。

### 倾听回声：诊断有缺陷的模型

那么，我们如何知道我们的假设是错误的呢？我们进行侦探工作。我们查看“剩余物”——残差——看它们是否包含任何隐藏的模式。对于一个好的模型，残差应该看起来像无聊的、随机的噪声。任何系统性的模式都是数据发出的求救信号，告诉我们我们的模型设定有误。

我们经常使用标准化的残差，如**条件加权残差（CWRES）**，如果模型正确，它们被设计成均值为零、方差为一。我们将这些残差对时间或模型自身的预测作图，并寻找线索[@problem_id:4568867]。

- **虚假的漏斗**：如果我们将残差对预测浓度作图，看到一个“漏斗”或“锥形”，其中残差的散布在较高浓度时变得更宽，这是一个明显的迹象。我们的模型假设方差是恒定的，但数据在尖叫它不是。这是残差[模型设定错误](@entry_id:170325)的典型特征——我们可能在需要比例或组合模型时使用了加性模型[@problem_id:5046114] [@problem_id:4568867]。

- **机器中的幽灵**：如果残差随时间显示出系统性趋势怎么办？例如，它们在给药后立即持续为正（模型低估），然后为负（模型高估），然后在一天晚些时候再次为正。这种模式不是随机噪声；它是我们模型错过的物理学幽灵。它告诉我们我们的*结构模型*——药物时程的基本方程——是错误的。也许我们假设吸收是瞬时的，而实际上存在延迟，或者消除比实际情况要简单。这是一个比残差模型更深层次的问题，再怎么调整误差结构也无法修复它[@problem_id:4568867]。

这些诊断图是我们窥视模型灵魂的窗口。它们让我们能够与数据进行对话，询问我们的假设是否合理，并引导我们走向对现实更诚实的描述。

### 最终的预言：预测与不确定性

最终，我们构建这些模型是为了进行预测。我们希望预测患者未来的药物浓度，以确保他们的剂量是安全有效的。在这里，[模型设定错误](@entry_id:170325)的影响成为生死攸关的问题。

如果我们的结构模型是错误的——比如说，我们使用了一个简单的单室模型，而药物实际上遵循双室行为——我们对未观测情况的预测可能会大错特错。例如，如果我们只有来自晚期“消除”阶段的数据，我们简化的模型可能会严重低估给药后立即出现的真实峰值浓度，这可能导致临床医生认为某个剂量比实际更安全[@problem_id:4523965]。

更微妙的是，一个设定错误的模型会给我们一种虚假的信心。它可能产生不仅有偏而且[预测区间](@entry_id:635786)过于狭窄的预测。模型变得“自信地错误”。这是极其危险的。我们宁愿要一个告诉我们“我不太确定这个预测”的模型，也不愿要一个给出精确但错误的预测的模型。一个忽略了某个变异来源的模型会显得比它应有的更精确，导致预测区间无法捕捉到真实值的频率远超预期[@problem-id:4523965]。

这就是一个名为**视觉预测检验（VPC）**的工具发挥作用的地方。VPC 是一个深刻的现实检验。我们使用我们最终拟合的模型来模拟数千个“假的”临床试验。然后，我们将真实的、观测到的数据叠加在我们的模拟数据分布之上。如果我们的模型能很好地描述现实，那么真实数据应该看起来像是从模拟中合理抽取出来的。VPC 模拟过程本身就是我们模型哲学的美妙体现：对于每个虚拟受试者，我们首先从个体间变异的分布中抽取他们的个体参数，然后使用残差模型生成他们的带噪声的测量值[@problem_id:4601299]。这是对整个系统——结构模型、IIV 和 RUV——的整体测试，也是我们对抗一个美丽但最终错误的理论的愚蠢行为的最后、最好的防线。

