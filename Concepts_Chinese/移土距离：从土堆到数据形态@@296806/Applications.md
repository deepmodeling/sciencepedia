## 应用与跨学科联系

现在我们对[推土机距离](@article_id:373302)的原理有了一些了解，你可能会问：“这到底有什么用？”这是一个合理的问题。拥有一个巧妙的数学工具固然很好，但其价值的真正考验在于它是否能帮助我们以一种新的或更好的方式理解世界。而在这里，EMD 的故事变得真正激动人心。事实证明，这个寻找最省力的方式将一堆土从一种形状变成另一种形状的简单直观想法，不仅仅是一个数学上的奇观。它是一种统一的语言，在众多不同的科学领域中独立地涌现出来。就好像不同实验室的科学家们，研究着从演化的微生物到会思考的机器等各种事物，都发现他们需要完全相同的工具。

让我们进行一次小小的巡礼，看看这同一个想法如何提供一个新的视角来观察宇宙，从单个细胞的尺度到数字数据的浩瀚。

### 生命科学的新视角

自然界似乎充满了各种“分布”——分子的分布、细胞的分布、乃至整个物种的分布——而生物学家们一直在试图比较它们。很长一段时间里，他们只能使用粗糙的工具，比如比较平均值或离散程度。这就像试图仅通过给出平均高度来描述两座不同的山。你错过了全貌！[推土机距离](@article_id:373302)给了我们一种比较整个形状的方法。

想象你是一位研究胚胎如何形成的[发育生物学](@article_id:302303)家。你发现某个特定基因在一个物种的胚胎前端（前部）大量表达，而在一个近亲物种中，它的表达则集中在后端（后部）。这种空间模式的变化是一种经典的进化现象，称为[异位发育](@article_id:324099)（heterotopy）。你如何量化它？你可以只说“它移动了”，但这并不精确。有了 EMD，你可以做一些很漂亮的事情。你将沿着胚胎轴的基因表达谱视为一堆“表达之土”。EMD 随后计算出将第一个物种的表达模式重塑为第二个物种所需的最小“功”——即质量乘以距离。答案不仅仅是一个数字；它是一个具有物理意义的数字。$40\,\mu\mathrm{m}$ 的 EMD 告诉你，平均而言，整个基因表达模式沿着胚胎移动了那么多 [@problem_id:2642158]。你用一个单一、直观的值捕捉到了进化变化的本质。

这种比较整个分布的想法在现代生物学中极其强大，因为现代生物学常常被来自单细胞的数据所淹没。在合成生物学中，工程师设计新的基因回路，比如控制基因活性的[启动子](@article_id:316909)。为了看两个[启动子](@article_id:316909)是否“等效”以便于标准化，他们可能会使用[流式细胞术](@article_id:324076)测量它们在数千个单细胞中产生的荧光。一个[启动子](@article_id:316909)的平均荧光可能稍高，但这有意义吗？他们可以使用 EMD 来比较整个荧光分布，而不是仅仅比较平均值。他们甚至可以通过首先测量*同一[启动子](@article_id:316909)重复实验之间*的 EMD 来建立一个数据驱动的等效性阈值。这为他们提供了一个正常实验噪音的基线。如果两个*不同*[启动子](@article_id:316909)之间的 EMD 在这个基线噪音范围内，它们就可以被自信地宣布为功能等效 [@problem_id:2775692]。这种稳健的方法扩展到许多领域，例如在假设检验中使用 EMD 作为核心统计量，以确定一个突变是否显著改变了基因在群体中的行为 [@problem_id:1438422]。

然而，EMD 真正的灵活性来自于它的“成本”函数。成本不必是物理距离。它可以是你想要的任何东西，只要它能有意义地代表将一件事物与另一件事物匹配的“成本”。

考虑从微生物的质谱“指纹”中识别它们的挑战。质谱是显示在不同质荷比下峰值的图表。有时，由于微小的校准误差，整个谱图可能会略有偏移。那些逐箱比较谱图的简单度量，如[余弦相似度](@article_id:639253)，会因此变得非常困惑。一个从一个箱子移动到相邻箱子的峰，看起来就像一个完全不同的特征。但 EMD 使用质荷比轴作为其地面距离，理解微小的偏移只是微小的变化。它看到将峰从一个箱子“移动”到其邻居的成本非常小，并正确地判断这两个谱图非常相似 [@problem_id:2520916]。

现在是最深刻的转折。如果将土从 A 点移动到 B 点的成本不是米，也不是[道尔顿](@article_id:303321)，而是数百万年的进化呢？研究肠道或海洋中微生物群落的生态学家每天都在做这件事。他们从两个不同的样本中获得物种普查数据（例如，通过 16S rRNA 测序）。这些群落有多大不同？简单的比较可能会说：“样本 A 有物种 X 但没有 Y，而样本 B 有 Y 但没有 X。”但如果 X 和 Y 是进化上的表亲，只是最近才分化呢？如果在另一个比较中，不同的物种位于生命之树的相对两端呢？EMD 让我们能完美地处理这个问题。通过将地面[成本矩阵](@article_id:639144)定义为进化树上物种间的*系统发育距离*，而不是物理距离，我们可以计算出考虑了它们进化关系的群落间距离。由此产生的“phylo-EMD”认为，一个将某种细菌换成其近亲的群落，比将其换成一个完全不相关微生物的群落更为相似 [@problem_id:2426499]。这是一种衡量生态变化的极具洞察力的方式。

### 塑造数字世界：从像素到预测

数字世界是另一个充满分布的领域——像素颜色的分布、词语概率的分布、高维空间中数据点的分布。因此，EMD 成为现代人工智能和计算机科学的基石也就不足为奇了。

在[计算机图形学](@article_id:308496)和视觉领域，一个常见的任务是比较三维形状，这些形状通常表示为点云。你如何衡量两个点云之间的差异？一种流行的方法，倒角距离（Chamfer distance），有点简单化：对于第一个云中的每个点，它在第二个云中找到最近的点，然后将这些距离加起来。这是一种“贪心”的方法。而 EMD 则找到云之间最佳的整体“匹配”，即将一个云变形为另一个云的全局最小成本。这通常能提供一个在感知上和几何上更有意义的形状差异度量，现在 EMD 和倒角距离都被用作训练神经网络生成或重建三维形状的[损失函数](@article_id:638865) [@problem_id:3099768]。

也许 EMD 在人工智能中最著名的应用是在训练[生成对抗网络](@article_id:638564)（GAN）中。GAN 通过让一个创建假图像的“生成器”网络和一个试图区分真假的“评判器”网络来学习创建逼真的数据（如人脸图像）。核心问题是如何衡量真实图像分布和虚假图像分布之间的“距离”，以便为生成器提供有用的改进信号。早期的 GAN 使用的度量不稳定且提供的梯度很差，就像让一个只会说“是”或“否”的评判家来教你画画一样。将[瓦瑟斯坦距离](@article_id:307753)（EMD）作为损失函数引入——创造了 WGAN——彻底改变了这个领域。$W_1$ 距离提供了一个更平滑、更有意义的信号，基本上是告诉生成器它的伪造品*在哪个方向*上是错误的。它避免了困扰其他度量的问题，比如 Fréchet Inception 距离 (FID)，后者可能对[特征空间](@article_id:642306)的某些变换过于敏感。两个分布之间一个微小到几乎无法察觉的差异有时会导致巨大的 FID 分数，而[瓦瑟斯坦距离](@article_id:307753)则保持合理的小，从而提供更稳定的学习信号 [@problem_id:3137263]。

[最优传输](@article_id:374883)的思想现在正融入人工智能架构的结构之中。著名的 [Transformer](@article_id:334261) 模型（为 ChatGPT 等应用提供动力）核心的“注意力”机制，可以被看作是一种传输问题。对于序列中的每个元素，[注意力机制](@article_id:640724)决定对其他每个元素投入多少“注意力”。这会产生一组权重。你可能会想把这看作一个传输方案，但这里有一个问题：标准注意力确保每个*查询*的权重总和为一，但它不保证每个*键*接收到的注意力与某个[期望](@article_id:311378)的分布相匹配。它只满足了真正传输方案两个边缘约束中的一个。但这种联系正在激发新的研究！通过使用[最优传输](@article_id:374883)领域的[算法](@article_id:331821)，如 Sinkhorn 缩放，研究人员正在开发*是*真正传输方案的新型注意力形式。随着这种联系的加深，我们发现，用来寻找最便宜运土方式的数学，正在帮助我们构建更强大、更有原则的人工智能 [@problem_id:3100317]。

这段进入人工智能的旅程也带来了一些重要的教训。作为科学家，我们必须小心，不能只是抓起一个工具就盲目使用。例如，在机器学习中，一种常见的技术是根据距离度量构建一个“核”，用于[支持向量机](@article_id:351259)等[算法](@article_id:331821)中。一个流行的做法是创建一个核 $k(x,y) = \exp(-\gamma d(x,y))$。人们很容易就想把 EMD 代入 $d$。但这是一个错误！这个做法只适用于一类特殊的距离，而 EMD 通常不属于这类。这样做可能导致矩阵缺乏所需的数学属性（正半定性），整个理论大厦就会轰然倒塌。然而，美妙之处在于，对 EMD 结构的更深理解为构建能够捕捉问题几何结构的强大核函数指明了其他有效途径 [@problem_id:3183900]。

最后，EMD 为构建能够适应现实世界复杂性的稳健人工智能提供了一个强大的框架。一个在特定数据集上训练的模型，在部署到数据分布略有不同的环境中时可能会失败。利用“瓦瑟斯坦球”（Wasserstein ball）的概念，我们可以定义一个邻域，包含所有与我们训练数据在某个 EMD 半径内的可能分布。然后，我们可以训练我们的模型不仅在训练数据上表现良好，而且在该邻域内*最坏情况*的分布上也能表现良好。这种被称为[分布鲁棒优化](@article_id:640567)（Distributionally Robust Optimization）的方法，使用 EMD 来创建从根本上更具弹性和更值得信赖的模型 [@problem_id:3173990]。

从胚胎中生命模式的变迁到最先进人工智能的内部运作，[推土机距离](@article_id:373302)为我们提供了一条共同的线索。它证明了一个事实，即科学中有时最深刻的思想也是最直观的。如何以最少的努力移动一堆土这个简单的问题，为我们提供了一个量化进化、工程化生物系统和构建智能机器的工具。这才是科学真正的美妙与统一之处。