## 引言
我们如何计算复杂物体的属性，例如机翼上的气流或发动机部件内的应力？这些量通常由在复杂域上的积分定义，而这些积分无法精确求解。解决方案在于近似，具体来说，是通过一种称为**求积法 (cubature)** 的强大数值技术。该方法用在少数精心选择的点上对函数值进行巧妙的加权求和，取代了不可能完成的精确积分任务。但是，这些点和权重是如何选择的？又是什么让一种选择优于另一种呢？

本文深入探讨了[求积法则](@entry_id:753909)的理论和应用。在第一部分 **“原理与机制”** 中，我们将探索支配其构造的基本概念。我们将揭示定义法则精度的“与多项式的约定”，了解[矩匹配](@entry_id:144382)如何将此概念转化为可解的代数问题，并见证利用积分域的自然对称性是创建高效法则的关键。在第二部分 **“应用与跨学科联系”** 中，我们将看到这些理论原理的实际应用。我们将发现求积法如何构成现代工程中有限元法的计算支柱，以及其影响如何出人意料地延伸到[机器人学](@entry_id:150623)和概率估计领域，为解决复杂的定量问题提供了一个统一的框架。

## 原理与机制

积分挑战的核心是衡量空间的问题。对于简单的形状和函数，我们有优美的公式。但是，对于描述大坝中的复杂应力或机翼上的气流，并在其复杂形状上积分的函数，情况又如何呢？精确解通常是我们无法企及的奢侈品。因此，我们必须进行近似。在二维或多维空间中，这种近似的艺术和科学被称为**求积法 (cubature)**。其核心思想看似简单：我们不再试图对函数在所有位置的值进行求和，而是进行一次巧妙的加权猜测。我们将选取少数几个特殊点，在这些点上计算函数值，然后将结果相加，每个结果都乘以一个特殊的“权重”。

近似式如下所示：
$$
\int_{\Omega} f(\boldsymbol{x})\,\mathrm{d}\boldsymbol{x} \approx \sum_{i=1}^N \omega_i f(\boldsymbol{x}_i)
$$
在这里，积分域 $\Omega$ 是我们进行积分的形状，$\boldsymbol{x}_i$ 是我们选择的**节点**（我们将在这些点上对函数进行采样），而 $\omega_i$ 是相应的**权重**。整个求积法的核心，其全部智力事业，可以归结为一个问题：我们如何选择最佳的积分点和权重？[@problem_id:3527296]

### 与多项式的约定

为了明智地选择我们的点和权重，我们需要一个标准来定义何为“最佳”。我们不能要求我们的法则对每个可以想到的函数都完美适用——那将需要无限多个点。取而代之，我们达成一个约定。我们决定，我们的法则必须对一族函数完美适用，这族函数既简单又在近似其他函数方面异常强大：多项式。

这引出了**精度阶** (degree of exactness) 的关键概念。如果一个[求积法则](@entry_id:753909)对于所有总次数小于或等于 $p$ 的多项式都能给出*精确*的积分结果，我们就说该法则具有 $p$ 阶精度。[@problem_id:2561944] “总次数”就是单项式项中指数的总和。例如，在二维空间中，$x^2y^3$ 的总次数为 $2+3=5$。这是在像三角形这样的通用域上对多项式进行分类的标准方法，与矩形域上可能使用的其他定义（例如分别考虑每个坐标方向的次数）有所区别。[@problem_id:3527296]

因为积分和我们的加权和都是线性运算，所以这个对无限多个多项式都精确的宏大要求，可以被优雅地简化为一个有限且可管理的任务。我们只需要确保该法则对多项式空间的[基函数](@entry_id:170178)——即单项式——是精确的。这被称为**[矩匹配](@entry_id:144382) (moment matching)**。我们的法则必须精确计算 $1$、$x$、$y$、$x^2$、$xy$、$y^2$ 等直到所需精度阶 $p$ 的所有单项式的积分。[@problem_id:2561944] 每个这样的条件都为我们提供一个代数方程。

### 从第一性原理构建法则

让我们来看一个实际例子。假设我们想为三角形 $T$ 构建一个最简单的法则：单点法则。我们应该把点放在哪里，它的权重又该是多少呢？让我们选择最自然的点，即三角形的**形心** $\boldsymbol{c}$，并将未知权重称为 $\omega$。我们的法则就是 $\int_T f(\boldsymbol{x})\,\mathrm{d}A \approx \omega f(\boldsymbol{c})$。

为了找到 $\omega$，我们对最简单的多项式，即次数为 0 的[常数函数](@entry_id:152060)（比如 $f(\boldsymbol{x})=1$），强制执行我们的约定。其精确积分就是三角形的面积 $|T|$。我们的法则给出的结果是 $\omega \cdot 1 = \omega$。为了使法则是精确的，我们不得不得出结论：$\omega = |T|$。这是一个优美的结果：权重就是积分域的面积。对于任何合理的积分法则，这一点都必须成立。

那么，我们的法则有多好呢？让我们用线性多项式（1次）来测试它。结果发现，这个简单的[形心](@entry_id:265015)法则对所有线性多项式也是精确的！这并非偶然；这是因为[形心](@entry_id:265015)是三角形的几何中心，即质心。

但是对于2次多项式呢？让我们在单项式 $x^2$ 上测试它。我们可以在一个简单的参考三角形（比如，顶点在 $(0,0)$、$(1,0)$ 和 $(0,1)$）上进行积分。我们发现 $x^2$ 的精确积分是 $\frac{1}{12}$。然而，我们的法则给出的结果是 $\frac{1}{18}$。它们不匹配！[@problem_id:2561997] 我们与多项式的约定在2次时被打破了。[形心](@entry_id:265015)法则的精度阶恰好为1。这是一个开始，但我们通常需要更高的精度。

### 对效率的追求

为了获得更高的精度阶，我们显然需要更多的点。这引出了一个自然的问题：对于给定的[精度阶](@entry_id:145189) $m$，我们可能需要的绝对最小点数 $N$ 是多少？

我们可以通过一个简单的计数论证找到答案。在二维空间中，为达到 $m$ 阶精度，我们需要匹配的单项式矩的数量是多项式空间的维数，即 $\frac{(m+1)(m+2)}{2}$。这是我们必须满足的方程数量。现在，我们有多少个“旋钮”可以调节呢？对于 $N$ 个点中的每一个，我们可以选择它的位置（两个坐标，$x_i$ 和 $y_i$）和它的权重（$\omega_i$）。这总共给了我们 $3N$ 个自由参数。

要使一个[方程组](@entry_id:193238)有可能有解，变量的数量必须至少与约束条件的数量一样多。这给了我们一个基本的不等式：
$$
3N \ge \frac{(m+1)(m+2)}{2}
$$
这告诉我们，点的数量必须至少为 $N \ge \left\lceil \frac{(m+1)(m+2)}{6} \right\rceil$。我们不可能做得比这更好；效率存在一个理论极限。[@problem_id:2591939] 找到真正达到这个下界的法则是项深刻且具有挑战性的数学问题。

### 对称性的魔力

当我们尝试构建更高阶的法则时，[矩匹配](@entry_id:144382)[方程组](@entry_id:193238)会变得难以徒手解决。成百上千的方程，成百上千的未知数。这似乎毫无希望。但在这里，自然给了我们一个深刻的启示：关注积分域的对称性。

考虑一个正方形。它有许多对称性：你可以旋转它，可以沿其对角线或轴线反射它。一个高效的[求积法则](@entry_id:753909)应该尊重这些对称性。最简单的方法是将其构建为一个好的一维法则的**[张量积](@entry_id:140694)**。著名的1D[高斯-勒让德法则](@entry_id:636900)就是完美的选择。它具有惊人的高[精度阶](@entry_id:145189)（$n$ 个点对应 $2n-1$ 阶）并拥有我们所期望的所有良好属性，包括正权重。通过将这些1D点[排列](@entry_id:136432)成网格，我们创建了一个继承了正方形对称性的2D法则。[@problem_id:3527296]

但是三角形呢？三角形具有一种不同的对称性——其顶点的[置换](@entry_id:136432)。你无法通过两条线的乘积来构成一个三角形。[张量积网格](@entry_id:755861)不尊重其几何形状。我们需要一个新的想法。[@problem_id:3527345]

关键在于用**[重心坐标](@entry_id:155488)**来思考，它将三角形内的任意点描述为其三个顶点的加权平均。三角形上的一个完全对称的法则必须在我们交换任何这些[坐标时](@entry_id:263720)保持不变。这个优美的约束条件如同魔法般起作用。它迫使积分点自行[排列](@entry_id:136432)成称为**[轨道](@entry_id:137151)**的对称模式。一个点可能是唯一的，比如[形心](@entry_id:265015) $(\frac{1}{3}, \frac{1}{3}, \frac{1}{3})$。或者它可能是一个三点族的一部分，比如中线上的一个点。或者它可能是一个六点族的一部分，对于三角形内部的一个一般点。[@problem_id:2561991] [@problem_id:3527357]

其结果是惊人的。首先，单个[轨道](@entry_id:137151)内的所有点都必须具有相同的权重。这极大地减少了我们需要求解的未知权重的数量。其次，代数问题本身也得到了简化。我们不再需要检验每个单项式，而只需检验一小组特殊的[对称多项式](@entry_id:153581)即可。[@problem_id:2561991] 积分域的几何性质已经深入到代数中并将其简化，揭示了两者之间隐藏的统一性。数学家们就是这样为三角形构建高效法则的，例如著名的 Dunavant 法则。

### 现实世界：复杂性与妥协

对最优法则的探索并非没有奇怪的转折和实际困难。

首先，当我们用最少的点数追求更高的精度阶时，我们有时会发现宇宙要求我们做出妥协：一些权重可能会变成负数。这在直觉上是难以理解的。权重本应代表一小块“面积”，它怎么可能是负的呢？对一个三角形上的3阶法则的具体计算揭示了一个解，其中形心点确实必须具有负权重才能满足所有的[矩条件](@entry_id:136365)。[@problem_id:2561925]

这为什么重要？对于许多应用，尤其是在模拟[非线性](@entry_id:637147)物理现象（如[流体动力学](@entry_id:136788)）时，正权重对于整个模拟的[数值稳定性](@entry_id:146550)至关重要。具有正权重的法则满足[詹森不等式](@entry_id:144269)的一个版本，该不等式可用于证明模拟不会“爆炸”。[@problem_id:3425939] 这就产生了一个实际的权衡：有时，使用一个不那么“高效”的法则（对于给定的[精度阶](@entry_id:145189)需要更多的点）如果能保证所有权重为正，反而更好。虽然 Tchakaloff 的一个强有力的定理保证了正权重法则总是存在的，但找到它们完全是另一回事。[@problem_id:3425939]

其次，在工程分析的现实世界中，物体并非由完美的参考三角形构成。它们有弯曲的边。在有限元法（FEM）中，我们通过定义一个从简单[参考单元](@entry_id:168425)（如我们的完美三角形）到弯曲“物理”单元的映射来处理这个问题。这被称为**[等参映射](@entry_id:173239)**。当我们把一个积分从物理单元变换回参考单元时，微积分法则要求我们包含一个转换因子：映射的雅可比[矩阵的[行列](@entry_id:148198)式](@entry_id:142978)，$\det(\boldsymbol{J})$。

症结就在这里。如果映射是非仿射的（即，它会产生弯曲的边），[雅可比行列式](@entry_id:137120)就不是一个常数，而是一个关于参考坐标的多项式！[@problem_id:3527309] 这意味着我们必须在参考三角形上积分的函数，现在是我们原始函数与这个新多项式 $\det(\boldsymbol{J})$ 的乘积。这个新被积函数的总次数可能会高得多。一个通用公式表明，为了在一个由 $r$ 次映射定义的物理单元上精确积分一个 $m$ 次多项式，我们的求积法则必须至少精确到 $t \ge mr + d(r-1)$ 阶，其中 $d$ 是空间维度。[@problem_id:3527309] 这是来自现实的一个清醒提醒：我们参考法则的优雅性必须与我们试图理解的现实世界形状的复杂性相平衡。使用[曲边单元](@entry_id:748117)以获得更高精度，其代价是需要更强大、计算成本也更高的求积法则。

