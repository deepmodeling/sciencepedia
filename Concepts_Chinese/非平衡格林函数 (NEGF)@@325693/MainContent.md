## 引言
电流是如何流过单个分子的？随着电子元件缩小到原子尺度，这个基本问题挑战着经典物理学的边界，并要求我们采用更复杂的量子力学描述。其挑战在于精确地为一个既极其微小又在外加电压驱动下远离热平衡的[系统建模](@article_id:376040)。本文介绍的**[非平衡格林函数](@article_id:380561)（NEGF）**形式理论，就是一个为直面这一挑战而设计的强大理论和计算框架。通过阅读本文，您将对这个现代凝聚态物理和[纳米科学](@article_id:361679)中的重要工具有一个概念性的理解。我们的旅程始于第一章**“原理与机制”**，其中我们将剖析NEGF的核心思想，探索[格林函数](@article_id:308216)如何充当“量子行程单”，以及[自能](@article_id:306032)这一关键概念如何解释器件内部复杂的相互作用。在这一理论基础之上，第二章**“应用与跨学科联系”**将展示该形式理论非凡的通用性，阐明NEGF如何为[纳米电子学](@article_id:354237)、自旋电子学、[热电学](@article_id:303063)，乃至[量子计算](@article_id:303150)的前沿领域提供关键的洞见。

## 原理与机制

我们已经做好了铺垫。我们想要理解微小的电子流是如何通过单个分子的，这是一段由奇特而优美的量子力学定律所支配的旅程。为了实现这一目标，物理学家和化学家们发展出一种极为强大的语言：**[非平衡格林函数](@article_id:380561)（NEGF）**形式理论。这个名字听起来可能令人生畏，但其核心是一个故事——一个关于可能性、布居和传播的故事。让我们来逐层揭开它的面纱。

### 可能性的[传播子](@article_id:313582)：格林函数行程单

想象一下你在预订航班。你想知道从纽约到伦敦有哪些可能的路线。航空公司的电脑可能会向你显示直飞航班、在都柏林中转的航班、有两次中转的航班……它为你提供了所有路线。**[格林函数](@article_id:308216)**就是粒子在量子世界中的“航班计划”。它告诉我们一个粒子在某个[时空](@article_id:370647)点$(x, t)$被创造，之后在另一个[时空](@article_id:370647)点$(x', t')$被发现的量子力学振幅——这是一个复数，其模的平方给出概率。

其中最简单、最直观的是**[推迟格林函数](@article_id:299631)**，记作$G^R(x',t'; x,t)$。“推迟”这个名字仅仅意味着它遵循因果律：到达时间$t'$必须晚于出发时间$t$。结果不能先于原因。这个函数$G^R$回答了这样一个问题：“如果我*此时此地*注入一个电子，它*彼时彼地*出现的振幅是多少？”

但穿越分子的粒子并非处于真空中。它的旅程是复杂的。它可能被两端的金属电极吸引，与原子[振动](@article_id:331484)发生碰撞，或者被其他[电子排斥](@article_id:324540)。我们如何解释所有这些复杂情况呢？这就是**[Dyson方程](@article_id:306666)**的魔力所在。其简化形式为：

$G^R = g^R + g^R \Sigma^R G^R$

这个方程讲述了所有可能的旅程。最终的、完整的“行程单”$G^R$，由一次“直飞”$g^R$（如果分子是孤立且无相互作用的，电子会走的路径）*加上*所有可能的“绕行”构成。这个“绕行规划器”是一个至关重要的对象，称为**[自能](@article_id:306032)**$\Sigma^R$。自能是一个精妙的“包裹”，我们将分[子环](@article_id:314606)境所有有趣的物理现象都塞进了里面。

可以这样理解：电子试图进行它的“直飞”($g^R$)，但接着它遇到了一些“麻烦”($\Sigma^R$)，这导致它被散射，然后它继续它那完整的、复杂的旅程(另一个$G^R$)。该方程总结了所有此类事件的序列。

电子会遇到什么样的“麻烦”呢？
- 它可以尝试逃逸到金属电极（“引线”）中。这会贡献一部分自能，比如左、右电极分别为$\Sigma_L^R$和$\Sigma_R^R$。
- 它可以与分子振动（[声子](@article_id:297589)）发生散射，失去能量和方向感。这是一个非弹性过程。
- 它甚至可能与某些随机涨落发生散射，这个过程我们称之为“退相干”。

这个形式理论的强大之处在于，我们通常可以直接将每个过程的[自能](@article_id:306032)相加 [@problem_id:254390]。例如，由电极和退相干引起的总[自能](@article_id:306032)为$\Sigma^R = \Sigma_L^R + \Sigma_R^R + \Sigma_D^R$。[自能](@article_id:306032)的虚部尤其重要。它常被写作$-i\Gamma/2$，其中$\Gamma$被称为**展宽**或**[衰变率](@article_id:316936)**。一个非零的$\Gamma$意味着电子不会永远停留在其分子态上；它有一个有限的寿命，之后会“衰变”到电极中。根据海森堡不确定性原理，有限的寿命$\Delta t$意味着能量的不确定性$\Delta E \sim \hbar/\Delta t$。这正是$\Gamma$所代表的：它衡量了由于有限寿命而引起的[分子能级](@article_id:318822)的能量展宽。

### 系统的内涵：占据与相干性

[推迟格林函数](@article_id:299631)$G^R$告诉我们可行的*路径*——即能级及其寿命。用物理学的行话来说，它的虚部给出了**[谱函数](@article_id:308042)**$A(E) = -2\,\mathrm{Im}\,G^R(E)$，这就像一张允许的[量子态](@article_id:306563)地图。但这张地图并没告诉我们这些态是否被实际*占据*了。我们量子航班上的座位是满的还是空的？

要回答这个问题，我们需要另一种[格林函数](@article_id:308216)：**小于[格林函数](@article_id:308216)**，$G^<(t,t') = i\langle c_j^{\dagger}(t') c_i(t) \rangle$。这个对象看起来有点抽象，但它的物理意义却非常具体。如果我们看它在相同时间$t=t'$的值，量$-iG^<_{ii}(t,t)$正是轨道$i$上的平均电子数。它就是**布居数**！而非对角元$-iG^<_{ij}(t,t)$描述了轨道$i$和$j$之间的量子**相干性**，告诉我们它们在多大程度上以[同步](@article_id:339180)的、类似波的方式行为 [@problem_id:2790677]。

因此，当$G^R$描述态的*结构*时，$G^<$描述填充这些态的*物质*。

在一个平静的系统中——即处于热平衡状态——结构和物质之间存在一种简单而深刻的关系，称为**涨落-耗散定理**。它表明，谱的占据部分（$G^<$）就是总谱（$A$）乘以普适的[费米-狄拉克分布](@article_id:299357)函数$f(E)$。这个函数简单地说明了低能级座位被填满，高能级座位是空的，在费米能级附近有一个由温度决定的平滑过渡。Keldysh格林函数$G^K$是一个相关的量，它优美地捕捉了这种联系 [@problem_id:1165070]。

但我们的分子又如何呢？它绝非处于平静状态。它连接到两个电压不同甚至温度也可能不同的电极。左电极想根据它的分布$f_L(E)$来填充分子的能态，而右电极则有它自己的意图$f_R(E)$。谁会赢呢？

谁也赢不了！系统会达到一个**非平衡稳态**。这就是小于自能$\Sigma^<$发挥作用的地方。每个电极提供其自己的填充通道，$\Sigma_\alpha^<(E) = i f_\alpha(E) \Gamma_\alpha(E)$ [@problem_id:2790658]。这告诉我们，电极$\alpha$试图根据它自己的布居统计($f_\alpha$)，将[电子注入](@article_id:334642)到分子的可用态($\Gamma_\alpha$)中。总的填充压力就是简单的加和，$\Sigma^<(E) = \Sigma_L^<(E) + \Sigma_R^<(E)$。

分子的最终占据情况$G^<(E)$由一个称为**Keldysh方程**的主平衡调节所决定：

$G^<(E) = G^R(E) \Sigma^<(E) G^A(E)$

这里，$G^A(E)$是“超前”格林函数，是$G^R$的[时间反演](@article_id:361429)孪生兄弟。这个优美的方程表明，分子态的实际占据是一个微妙的折衷，它受到分子自身结构($G^R, G^A$)的过滤，并由电极的竞争影响($\Sigma^<$)所驱动。通过计算$G^<(\omega)$并对所有能量进行积分，可以找到在给定偏压下分子上的总电子数 [@problem_id:1111319]。在[稳态](@article_id:326048)下，即使每秒有数百万个电子飞速穿过，分子上的平均电子数仍保持恒定 [@problem_id:2790677]。

### 输运的交响曲：从格林函数到电流

现在我们拥有了所有的乐器。让我们来演奏音乐吧。最终目标是计算电流$I$。著名的**[Landauer-Büttiker公式](@article_id:302085)**为我们提供了乐谱：电流是**[透射概率](@article_id:298392)**$T(E)$乘以两电极费米函数之差$[f_L(E) - f_R(E)]$的积分。这个差值充当“电压窗口”；只有在电极对占据情况有分歧的能量上，电子才能对净电流做出贡献。

NEGF形式理论为[透射概率](@article_id:298392)提供了一个惊人优美和直观的表达式：

$T(E) = \mathrm{Tr}\left[ \Gamma_L(E) G^R(E) \Gamma_R(E) G^A(E) \right]$

让我们来剖析这颗宝石。迹Tr是对所有不同分子轨道的求和。对于单个能级，这是一个简单的乘积。透射是四项的乘积：
1. $\Gamma_L(E)$：电子从左电极*进入*分子的速率。
2. $G^R(E)$：电子*穿过*分子传播到出口点的振幅。
3. $\Gamma_R(E)$：电子从分子*离开*到右电极的速率。
4. $G^A(E)$：反向传播的振幅，这是形成概率所必需的。

它实际上就是，进入的概率，乘以穿越的概率，再乘以离开的概率。对于一个简单的单能级分子，该公式给出了透射的洛伦兹（或Breit-Wigner）[共振峰](@article_id:334978)形 [@problem_id:254390]。当入射电子的能量$E$与分子的能级$\epsilon_0$匹配时，电流最大。

这个结果是如此核心和优美，值得我们建立对它的信心。人们可以使用一种完全不同的方法，即基于[Lippmann-Schwinger方程](@article_id:303250)的标准散射理论，来推导相同的透射公式，并得到完全相同的结果 [@problem_id:2976720]。这表明NEGF并非某种奇怪的新物理，而是一种描述[量子输运](@article_id:299380)的强大、统一的语言。它也优美地包含了旧有、已确立的物理学作为其极限情况。例如，在[弱耦合](@article_id:301436)极限下，从[自能](@article_id:306032)计算出的[逃逸率](@article_id:378562)$\Gamma/\hbar$与人们用大学一年级量子力学中的[费米黄金定则](@article_id:306659)计算出的速率完全相同 [@problem_id:2683327]。

### 当电子开始“回应”：相互作用的世界

到目前为止，我们主要将电子视为独立的漫游者。但电子是带电粒子；它们相互排斥。在单个分子这样狭小的空间里，这种排斥可能非常显著。正是在这里，NEGF从一个优美的便利工具转变为一个必不可少的工具。

最简单也最引人注目的相互作用效应是**[库仑阻塞](@article_id:298446)**。将第一个电子添加到空分子中需要一定的能量$\epsilon_0$。但要添加*第二个*电子，不仅必须克服[轨道能量](@article_id:318885)，还必须克服来自已存在电子的强[库仑排斥](@article_id:361236)$U$。此时的能量成本是$\epsilon_0 + U$。如果施加的电压不足以支付这个额外的能量成本$U$，第二个电子的流动就会被阻塞。

这在我们的形式理论中是如何体现的呢？任何简单的“静态平均场”理论，如[Hartree-Fock理论](@article_id:320762)，在这里都惨败。这类理论通过让每个电子只感受其他电子的*平均*[电荷](@article_id:339187)来处理排斥。这用一个单一、连续移动的能级取代了两个不同的添加能量，完全抹去了阻塞效应。要捕捉到阻塞效应，我们必须承认相互作用能是动态的。我们需要一个频率依赖的相互作用[自能](@article_id:306032)$\Sigma_{\mathrm{int}}(\omega)$。这样的自能能正确地将分子的[谱函数](@article_id:308042)分裂成两个分别位于$\epsilon_0$和$\epsilon_0+U$附近的不同的"Hubbard峰"，这是强关联的标志性证据 [@problem_id:2790663]。

相互作用也可以是**非弹性**的。电子在穿过时可能会将能量损失给分子振动。在这种情况下，假设电子[能量守恒](@article_id:300957)的简单[Landauer公式](@article_id:308283)就不再适用。这些过程由一个非零的非弹性小于自能$\Sigma^{<}_{\mathrm{int}}$来描述。完整的电流表达式，即**[Meir-Wingreen公式](@article_id:303320)**，更为复杂，包含了说明这些非弹性通道的额外项 [@problem_id:2999565]。

最后，一句忠告。构建这些近似[自能](@article_id:306032)是一门精巧的艺术。宇宙严格遵守[电荷守恒](@article_id:312253)。我们的近似也必须如此！一个称为**[Ward恒等式](@article_id:307416)**的深刻结果提供了确保守恒的数学约束。它要求我们用于[自能](@article_id:306032)$\Sigma$的近似与我们用于顶点（描述电流如何被测量）的近似之间存在根本上的一致性。如果我们使用来自一个花哨自能的“缀饰”[格林函数](@article_id:308216)，但使用一个“裸”顶点，我们就会违反这个恒等式，并得到荒谬的结果，比如电流凭空消失 [@problem_id:2790639]。这是一个深刻的提醒：NEGF这台优美的机器，尽管功能强大，也必须在尊重自然界基本对称性的前提下操作。