## 应用与跨学科联系

所以，我们有了脉动阵列这个奇妙的想法——一台优美、富有节律的机器，数据像心跳一样在一系列处理器中搏动。我们已经探讨了使其运转的原理、其局部通信的优雅简洁性，以及它所释放的巨大并行性。但是，任何科学思想最激动人心的部分不仅仅是其内在的美，而是当它与现实世界相遇时会发生什么。这台机器*擅长*什么？这种计算的节律性脉搏在我们想要解决的各种问题中，在哪里找到了它的节奏？

你可能会感到惊讶。事实证明，脉动阵列表现出色的简单、重复的“乘法和累加”模式，并非某种晦涩的数学奇观。实际上，它是计算的基本旋律之一，出现在各种令人眼花繚亂的领域中。让我们踏上一段旅程，看看这个优雅的架构出现在何处，从我们计算机的人工智能大脑到生命本身的代码。

### 人工智能的心跳

如果说有一个领域被脉动阵列彻底改变，那就是人工智能。现代[神经网](@entry_id:276355)络，特别是那些能够“看”和“听”的网络，是建立在两个关键运算基础上的庞大结构：矩阵乘法和卷积。而事实证明，这些运算与脉动数据流完美匹配。

为什么？秘密在于一个我们可以称之为*算術強度*的概念——这是一个花哨的术语，代表一个简单而深刻的想法：对于你从遥远、缓慢的[主存](@entry_id:751652)世界中获取的每一片数据，你能完成多少有用的工作？一种天真的方法，比如说进行卷积，可能涉及处理器获取一小块图像和一组滤波器权重，将它们相乘，然后……扔掉它们，再去获取下一块图像和权重。这是极其浪费的！这就像一个木匠为每一颗钉子都跑一趟木材厂。处理器大部[分时](@entry_id:274419)间都在等待数据，而不是计算。

脉动阵列彻底改变了这一点。想象一个图像瓦片从阵列的一侧流入，而[神经网](@entry_id:276355)络的权重从另一侧流入。当一个数据片段进入一个处理单元（PE）时，它被用于一次计算。但它不会被丢弃，而是被传递给它的邻居。那个邻居用它进行*自己的*计算，然后再传递下去。一个只从内存中获取一次的数据元素，在它穿越阵列的过程中被一次又一次地重用。结果是算术強度的惊人提升。处理器保持持续繁忙，对它们最初从内存请求的每个字节执行数百次操作。这正是诸如谷歌的张量处理单元（TPU）等架构能够在 AI 工作负载上实现令人难以置信的性能，将更通用的处理器远远甩在身后的原理 [@problem_id:3634476]。

这也不仅仅是针对简单卷积的一个小技巧。人工智能的世界里充斥着种类日益增多的运算。考虑像*[深度可分离卷积](@entry_id:636028)*这样的东西，这是一种在移动和边缘 AI 模型中常见的更高效的层类型。它将问题分解为两个不同的步骤。你如何将这个映射到一个刚性的处理器阵列上？在这里，架构设计的艺术就发挥作用了。你应该使用一个长的一维阵列还是一个方形的二维阵列？事实证明，这个选择对于数据如何被重用以及需要多少片上内存来存储中间结果有着深远的影响。一种布局可能对第一步非常出色，但对第二步很笨拙，而另一种则提供了更好的平衡。为这些任务设计一个领域特定架构（DSA）是在算法的[数据流](@entry_id:748201)和硬件的拓扑结构之间进行的一场微妙的舞蹈，一个在每一步都力求最小化数据移动的谜题 [@problem_id:3636772]。

### 自然与工程的节律

但是，如果认为脉动阵列只适用于 AI，那就错了。同样的计算模式在科学和工程的许多其他角落里回响。

想想[数字信号处理](@entry_id:263660)（DSP），我们数字化的音频和通信世界的基础。一个[有限脉冲响应](@entry_id:192542)（FIR）滤波器，用于从清理嘈杂的音频到塑造无线电信号的各种应用，本质上是一个滑动的[点积](@entry_id:149019)——正是那个“乘法和累加”的模式。因此，脉动阵列能够以惊人的效率执行 FIR 滤波器也就不足为奇了。当我们将一个滤波器映射到这个架构上时，我们看到了同样的原理在起作用：输入信号流跨越阵列，与存储在每个处理器中的静止滤波器系数相互作用。这种联系也迫使我们思考计算的实际问题，例如不同数字格式之间的权衡，比如 DSP 传统的[定点运算](@entry_id:170136)与 AI 中使用的更奇特的 `[bfloat16](@entry_id:746775)` 格式，以及这些选择如何影响我们结果的最终精度 [@problem_id:3634569]。

让我们从电子世界转向生物世界。科学家如何比较 DNA 序列以寻找可能指示[进化关系](@entry_id:175708)或遗传疾病的相似之处？最有力的工具之一是 [Smith-Waterman](@entry_id:175582) 算法，一种来自动态规划世界的方法。它涉及到填写一个大网格，其中每个单元格的值取决于其邻居。如果你仔细观察依赖关系，你会注意到一些奇妙的事情：沿着任何给定的[反对角线](@entry_id:155920)的所有单元格都可以同时计算！它们不相互依赖。这就创造了一个可以扫过整個网格的计算“波前”。

什么样的硬件最适合这个？一个一维脉动阵列！你可以将每个处理器分配给[波前](@entry_id:197956)上的一个单元格。在第一个周期，一个处理器工作。在下一个周期，两个处理器工作。活动波逐渐增长，扫过网格，然后收缩，看起来就像一个扩张和收缩的涟漪。这种算法到架构的完美映射使脉動陣列成为高速[生物信息学](@entry_id:146759)和基因组分析的基石 [@problem_id:3634734]。

或者考虑机器人世界。一个在空间中导航的机器人，一架飞行的无人机，或者一辆自动驾驶汽车，需要不断地确定自己的位置。它通过融合来自各种传感器——摄像头、GPS、[惯性传感](@entry_id:202259)器——的数据来做到这一点，使用的是一种称为[卡尔曼滤波器](@entry_id:145240)的算法。该滤波器的核心是一系列矩阵运算，包括矩阵求逆这个关键步骤。正如我们所见，脉動陣列擅长结构化的[矩阵代数](@entry_id:153824)。但并非所有算法都是生而平等的。试图用像[高斯-若尔当消元法](@entry_id:150406)这样的经典方法来解决这个系统是一个糟糕的选择；它需要在整个阵列上广播数据行，打破了“仅局部通信”的规则，并造成了瓶颈。然而，一种更复杂的方法，如 Cholesky 分解，适用于这个问题中出现的特殊[对称矩阵](@entry_id:143130)，可以分解为一系列三角求解，这些求解可以完美地映射到一个仅有最近邻通信的脉动阵列上。算法和架构的选择是紧密交织的，正确的配对可能意味着一个能够实时反应的机器人和一个不能的机器人之间的区别 [@problem_id:3636733]。

### 不匹配的艺术：当节奏被打破

现在，科学中一个非常重要的教训是，没有任何思想，無論多么聪明，能够解决所有问题。我们也必须问：脉动阵列*不*擅长什么？答案告诉我们一些关于算法本质的深刻道理。

考虑一下[快速傅里叶变换](@entry_id:143432)（FFT），这是有史以来最重要的算法之一。它无处不在，从信号处理到[图像压缩](@entry_id:156609)。它非常快，但它有一个奇特的通信模式。为了计算 FFT，你需要组合输入数组中相距很远的数据点。该算法具有一种“全局”性质。

如果你试图将它映射到一个一维脉动阵列上，处理器只能与它们的直接邻居通信，会发生什么？这是一场灾难。为了将一个数据点从阵列的一端传到另一端，它必须一步一步地通过中间的每一个处理器。通信成本，即仅仅用于移动数据的时间，变得极其高昂，完全超过了实际计算所花费的时间。一维阵列上通信的渐近成本增长为 $\Theta(n^2)$，而计算仅为 $\Theta(n \log n)$。这是一个可怕的不匹配 [@problem_id:3634510]。这就像试图通过在拥挤的体育场里传递一张纸条来 across 进行对话。脉动的节奏被打破了。这教会了我们一个至关重要的教训：[并行架构](@entry_id:637629)的效率取决于其通信拓扑与算法通信图的匹配程度。

### 脉动思维：一种通用[范式](@entry_id:161181)

所以我们看到，脉动阵列是一个特定的硬件，一个*领域特定架构*，它对于某些问题非常出色，而对于其他问题则不适合。但故事就到此为止了吗？完全不是。

也许最深刻的联系是：我们可以将物理的*脉动阵列*的想法与更普遍的*脉动思维*原则分离开来。如果你没有一个特殊的加速器芯片怎么办？如果你只有一个常规的[多核处理器](@entry_id:752266)，带有一个由网络连接的通用核心网格呢？你仍然可以应用脉动思维！

你可以划分你的问题，比如一个大型卷积，将其划分为瓦片，并为每个核心分配一个瓦片。每个核心计算自己的区域，然后将边界数据——“光环”（halo）——与它的邻居通信，就像硬件阵列中的 PE 一样。这种数据流模仿了脉动计算。当然，它不会那么高效。通信是通过通用网络上的软件消息来处理的，其延迟更高，带宽更低，远不如定制芯片中的专用线路。这种通信的开销是显著的 [@problem_id:3660960]。但*原则*是相同的：组织计算以最大化局部数据重用，并创造一个规则的、有节奏的信息流。

最终，这揭示了脉动概念的真正力量和美丽。它不仅仅是硅片的巧妙[排列](@entry_id:136432)。它是并行计算的一个基本[范式](@entry_id:161181)。它教我们不仅要思考操作本身，还要思考*数据在机器中的流动*。它提醒我们，在高性能计算的世界里，你能做的最昂贵的事情不是将两个数字相乘，而是将一个数字从一个地方移动到另一个地方。通过最小化这种移动，通过让数据持续运动并持续工作，脉动的搏动为众多问题带来了深刻的效率，将人工智能、信号处理、[生物信息学](@entry_id:146759)和[机器人学](@entry_id:150623)的世界统一在一个简单而强大的节奏之下。