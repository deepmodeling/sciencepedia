## 引言
几十年来，生物学家可以盘点组织内活跃的基因，但方法却是将其研磨成细胞悬液，这会使其精巧的结构信息荡然无存。这种被称为[批量RNA测序](@entry_id:203183)的方法，就好比知道一幅挂毯中所有丝线的颜色，却看不到它们构成的图画。[空间转录组学](@entry_id:270096)的出现改变了一切，它让我们能够欣赏到细胞“挂毯”的全部辉煌，并提出一个根本性问题：哪些基因是创造我们所见图案的“丝线”？识别这些空间可变基因 (SVGs) 是破译生命蓝图的关键。

然而，将有意义的生物学模式与随机的[细胞噪声](@entry_id:271578)区分开来，是一项艰巨的统计学挑战。这需要我们转变思维方式——从仅仅比较平均基因活性，转向检测复杂的[空间相关性](@entry_id:203497)。本文为SVG的世界提供了一份全面的指南，旨在填补生物学问题与解答这些问题所需的计算方法之间的鸿沟。

这段旅程始于第一章“**原理与机制**”，我们将在这里定义何为空间可变基因，将其与[差异表达](@entry_id:748396)进行对比，并深入探讨用于检测它们的统计学工具箱——从[Moran's I](@entry_id:192667)到复杂的高斯过程模型。随后，“**应用与跨学科联系**”一章将展示SVG分析如何革新神经科学和肿瘤学等领域，指导实验设计，并在生物学、统计学和数学之间建立起强大的联系。我们首先将探索那些能让我们在组织内“聆听”到这些隐藏遗传旋律的核心统计学概念。

## 原理与机制

想象一下，你正在欣赏一幅宏伟的挂毯。从远处看，你看到一幅壮丽的图画——一处风景，一幅肖像。但当你走近时，你会发现这幅画并非绘制而成，而是由成千上万种不同颜色的丝线编织而成。挂毯的精妙之处不仅在于颜色的选择，更在于它们精确的排列。一片蓝色丝线构成了天空，一抹盘旋的绿色形成了一棵树。每一根丝线的位置都至关重要。

生物组织与这幅挂毯颇为相似。它由数百万个细胞组成，每个细胞都是一台织机，活跃地将基因“编织”成蛋白质。几十年来，我们研究这一过程的方式基本上等同于将一块挂毯磨碎，然后列出其中所有丝线的颜色。这就是传统的[批量RNA测序](@entry_id:203183)——功能强大，但对空间组织的杰作却视而不见。空间转录组学首次让我们得以一窥这幅挂毯的全貌。它使我们能够发问：哪些基因是创造我们所见图案的“丝线”？这些就是**空间可变基因 (SVGs)**。

### 有地址的基因

简单来说，**空间可变基因**是指其活性在组织中并非均匀分布的基因。它的表达水平取决于其所在的位置。以脊椎动物的视网膜为例，这是一个如瑞士手表般精密、由不同神经元层构成的结构。如果我们发现一个基因（称之为`NeuroLux`），它在神经节细胞层中异常活跃，但在其上下层中却处于静默状态，那么我们就发现了一个典型的SVG [@problem_id:1467297]。它的表达模式与组织的结构紧密相连。它拥有一个空间地址。

然而，这个简单的想法背后隐藏着一个更深、更强大的概念。如果一个基因的模式并不完全符合我们已知的解剖区域怎么办？如果它形成一个微妙的梯度、一个波浪，或者一个跨越已知边界的斑驳拼布图案呢？要找到这些更难以捉摸的模式，我们需要像物理学家或统计学家那样思考。

### 均值与信息：两种属性的故事

在统计学中，我们常常通过数据的属性来描述它。其中最重要的两个是**均值**（平均值）和**协方差**（数据中不同点之间的相互关系）。理解这两种属性的区别是真正理解SVG的关键。

想象一下，我们有一个来自脑肿瘤的组织样本。我们可以将其分为两个区域：肿瘤核心和周围的健康组织。

如果一个基因的*平均*表达在两个区域之间存在差异，那么它就被称为**[差异表达](@entry_id:748396) (DE) 基因** [@problem_id:4354056]。例如，一个促癌基因在肿瘤核心的平均活性可能是在健康组织的十倍。这是**均值**的变化，统计学家称之为*一阶属性*。这是一个强大且重要的信号，但它并非故事的全部。

现在，考虑另一个不同的基因。它在肿瘤和健康区域的平均表达可能完全相同。简单的均值比较不会发现任何有趣之处。但在肿瘤内部，这个基因的表达形成了一个平滑的梯度，在肿瘤前沿最高，然后向中心逐渐减弱。这是一种与我们开始时预设的标签无关的空间模式。这个基因的表达表现出**[空间自相关](@entry_id:177050)性**——它在一个位置的水平能为你提供其在邻近位置水平的线索。这是**协方差**的属性，一个*二阶属性* [@problem_id:2753010]。

这就是SVG真正且更广泛的定义：一个基因的表达，即使在考虑了已知区域和其他简单因素后，也并非空间随机的。它的表达模式包含了只有通过观察位置*之间*的关系才能理解的信息。检测DE基因好比注意到交响乐团的小提琴部比大提琴部演奏得更响亮。而检测SVG则好比注意到一段优美流畅的旋律在小提琴手之间传递——一种存在于声部内部的模式。

### 统计学家的工具箱：如何聆听模式

为了发现这些隐藏的旋律，科学家们开发了一套精密的统计方法工具箱。所有这些方法都始于同一个基本问题，并将其构建为一个**零假设**。零假设是“怀疑论者的观点”——它假定该基因*不*具有[空间变异性](@entry_id:755146)，我们看到的任何模式都只是随机噪声，即“寂静之声” [@problem_id:4608990]。任何SVG检测方法的目标都是收集足够的证据来确信地拒绝这个零假设，并宣布我们找到了一个真实的空间信号。

#### 简易麦克风：[Moran's I](@entry_id:192667)

最直接的工具是像**[Moran's I](@entry_id:192667)**这样的全局统计量。它提供一个单一的数值，总结了组织中整体的[空间自相关](@entry_id:177050)性。一个正的Moran's $I$意味着，平均而言，相邻位点比远距离位点的表达水平更相似 [@problem_id:4315780]。它就像音乐厅里的一个麦克风；能告诉你观众是否在同步鼓掌，但无法告诉你节拍的细节。

#### 描述平滑性的语言：高斯过程

为了捕捉模式本身的形状，我们需要一种更具[表达能力](@entry_id:149863)的语言。这就是**高斯过程 (GPs)**发挥作用的地方。GP是一个强大的统计学概念，它让我们能够对整个函数进行推理。我们不是对每个位点的表达进行单独建模，而是将整个空间表达模式建模为从一个“函数分布”中抽取的单个函数。像**SpatialDE**这样的方法就建立在这种优雅的思想之上 [@problem_id:2852288]。

GP的核心是它的**[核函数](@entry_id:145324)**。核函数是一条规则，定义了我们对期望看到的模式*类型*的先验假设。它定义了空间中任意两点之间的协方差。选择一个[核函数](@entry_id:145324)就像将收音机调到一个特定的频段，以最好地接收某种信号 [@problem_id:2753054]：
- **[平方指数核](@entry_id:191141)**是一个低通滤波器。它假设模式是无限平滑的，最适合检测宽泛、缓慢变化的梯度。
- **Matérn核**有一个“平滑度”参数。通过调整它，我们可以寻找从平滑波浪到粗糙、斑驳的各种模式，后者包含更多高频内容。
- **周期核**旨在寻找重复的、振荡的模式，例如大脑皮层中发现的独特分层。

核的选择至关重要。如果我们用一个假设平滑性的核去寻找一个斑驳的模式，我们将会损失[统计功效](@entry_id:197129)，就像你很难在一个调到重低音的电台上听到高音长笛一样。

#### 驯服噪声：为计数建模

GP的美妙理论常常遭遇一个混乱的现实：[空间转录组学](@entry_id:270096)数据由分子的*计数*组成。这些计数是整数，并且天生就带有噪声。一个特别棘手的问题是**过离散**：数据通常比一个简单的[统计模型](@entry_id:755400)（如泊松分布）所预测的要多变得多 [@problem_id:5164054]。这可能由多种生物学原因引起，产生了可能淹没信号的额外噪声。

这正是像**SPARK**这类方法大放异彩之处 [@problem_id:2852288]。SPARK不转换计数并假装它们是平滑且呈高斯分布的，而是使用**[广义线性模型 (GLM)](@entry_id:749787)**框架直接对计数进行建模，采用更合适的分布，如能自然处理过离散的负二项分布 [@problem_o_id:5164054]。此外，SPARK巧妙地测试了一整套不同的核——用于平[滑模](@entry_id:263630)式、周期模式等等——并将证据结合起来。这就像同时扫描所有无线电频率，以确保你不会错过任何正在广播的电台 [@problem_id:4608990]。

### 发现的艺术：功效与陷阱

寻找SVG不仅仅是运行一个算法；它关乎理解是什么让发现成为可能，以及什么会让我们误入歧途。一个检验方法找到真实模式的能力是其**统计功效**。有几个因素会影响它 [@problem_id:4385442]：

1. **位点数量 ($N$)：** 更多的数据几乎总是有益的。拥有更多的测量位点能为我们提供更高分辨率的组织视图，使模式更容易被发现。然而，这种好处的回报是递减的；将位点数量加倍并不能使我们的功效加倍。
2. **效应量 ($\delta$)：** 这是空间信号的强度。一个在组织中表达水平变化一百倍的基因，远比一个只有10%微小变化的基因更容易被检测到。
3. **[空间自相关](@entry_id:177050)性（噪声的，$\ell$)：** 这是最微妙也最有趣的因素。如果我们的测量*噪声*也存在[空间相关性](@entry_id:203497)呢？这可能由于实验中的技术假象而发生。这种相关的噪声会产生随机的“山丘”和“山谷”，看起来可能像一个真实的生物学模式，从而掩盖了真实信号，降低了我们的[有效样本量](@entry_id:271661)。这就像试图在一个满是人声嘈杂的房间里听清一段微弱的旋律。

最后，当我们一次性检验20,000个基因时，我们面临着**[多重检验问题](@entry_id:165508)**。纯粹由于偶然，一些完全非空间的基因看起来会像有模式。为避免[假阳性](@entry_id:635878)的泛滥，我们控制**[错误发现率](@entry_id:270240) (FDR)**。但这里有一个陷阱：如果我们的[统计模型](@entry_id:755400)做出了错误的假设——例如，它假设噪声是独立的，而实际上是相关的——我们的计算将出现系统性错误。我们可能以为我们将错误发现控制在5%，而实际上我们30%的“发现”都是虚假的 [@problem_id:2852354]。

优雅的解决方案是使用一个**经验零**模型。我们不是将成千上万的基因与一个完美的、理论上的“无模式”理想状态进行比较，而是观察我们实际实验中的大量基因，以了解在*这个特定数据集*中，带着其所有独特的怪癖和相关性，“无模式”到底是什么样的。这种自适应的方法，被用于现代的局部FDR方法中，使我们的发现更加可靠。这是一种谦逊的承认：自然界总是比我们的模型更复杂，有时，找到信号的最佳方式是首先非常仔细地聆听寂静的本质。

