## 引言
肿瘤的医学图像包含了远超人眼所能感知的丰富信息。放射组学领域旨在解锁这些隐藏数据，将复杂的视觉纹理转化为定量的、客观的生物标志物，从而可能彻底改变临床决策。然而，这种从像素到预后的转化充满了挑战。我们如何才能可靠地捕捉肿瘤纹理的本质？又如何确保我们生成的数值是一致且有意义的？本文通过聚焦于两个基本的放射组学特征——能量和熵，来解决这些问题。在接下来的章节中，我们将首先深入探讨“原理与机制”，探索这些特征如何从图像[直方图](@entry_id:178776)中计算得出，以及它们如何受到图像噪声和重建设置等技术变量的深刻影响。然后，我们将探讨它们的“应用与跨学科联系”，揭示纹理有序与无序背后的生物学意义，并审视在物理学、计算机科学和统计学领域之间建立真正可重复且值得信赖的数字生物标志物所需的关键性合作。

## 原理与机制

想象一下，你手上有一张复杂纹理表面的照片，比如树皮或一片沙地。你会如何通过电话向别人描述它？你可以谈论它的平均颜色，但这会错过其丰富性。你可以提及从最暗的阴影到最亮的高光之间的范围，但这仍然不是全部。纹理的真正特征在于色调的*分布*——有多少暗部，有多少亮部，以及有多少中间色调。

在放射组学中，我们面临同样的挑战，但风险要高得多。“照片”是肿瘤的医学扫描图，而“纹理”可能包含有关其侵袭性、类型或治疗反应的线索。我们的目标是将这种复杂的视觉信息转化为一组精确、有意义的数字。

### 从图像到数字：直方图

这个过程中第一个也是最基本的一步是创建**[直方图](@entry_id:178776)**。直方图是一个极其简单的概念：我们忽略体素（构成扫描图像的三维像素）的空间排列，只计算落入不同强度“组”中的体素数量。想象一下从海滩上取一勺沙子，其中包含许多不同颜色的沙粒。[直方图](@entry_id:178776)就像是根据颜色将所有沙粒分到不同的堆里，并计算每堆中有多少沙粒。你失去了每粒沙子在海滩上位置的信息，但你获得了关于颜色构成的清晰图像。

这种“体素袋”方法定义了**一阶特征**。它们仅从强度分布中计算得出，并且就其本质而言，对于体素的空间排列方式是不变的。如果你像洗牌一样打乱肿瘤感兴趣区域（ROI）内的所有体素，一阶特征将保持完全相同 [@problem_id:5221637]。

从这个本质上是体素强度概率分布的[直方图](@entry_id:178776)中，我们可以计算出熟悉的[统计矩](@entry_id:268545)。**均值**告诉我们肿瘤的平均亮度。**方差**告诉我们这些亮度值的离散程度。我们甚至可以描述直方图形状更细微的方面：**偏度**告诉我们分布是否不对称，即是否存在一个由非常亮或非常暗的体素构成的长尾；**峰度**则告诉我们关于“尾部厚度”的信息——即极端值是否比标准[钟形曲线](@entry_id:150817)分布中更常见或更不常见 [@problem_id:4554313]。例如，如果我们扩大肿瘤掩模以包含边界，可能会纳入不同的组织类型或部分容积效应（即单个体素包含肿瘤和健康组织的混合物）。这会在直方图中引入一个新的“峰”或众数，通常使其变得不对称（改变其偏度）并且更平坦（降低其[峰度](@entry_id:269963)）[@problem_id:4541089]。

### 主角登场：能量与熵

除了这些经典矩之外，从[直方图](@entry_id:178776)的概率分布中还出现了两个特别强大的特征：能量和熵。它们为我们深入了解组织纹理的均匀性和复杂性提供了更深层的视角。

#### 能量：集中度的度量

再想象一下我们那几堆沙粒。如果几乎所有的沙粒都在一堆里（比如说，浅米色），那么纹理就非常均匀，即**同质**。如果沙粒均匀地分布在许多不同颜色的堆里，那么纹理就是多样的，即**异质**。

名为**能量**（有时也称**均匀度**）的放射组学特征量化了这一点。其定义很简单：如果一个体素落入组 $i$ 的概率是 $p_i$，那么能量就是这些概率的平方和：

$$
U = \sum_{i} p_i^2
$$

这为什么有效呢？如果分布高度集中在某个组（比如组 $k$），那么 $p_k$ 将接近 $1$，而所有其他的 $p_i$ 将接近 $0$。将一个接近 $1$ 的数平方后它仍然很大，所以总和 $U$ 会很高。相反，如果概率稀疏地分布在许多组中，每个 $p_i$ 都会很小。将一个小数平方后它变得更小，所以总和 $U$ 会很低。

因此，**高[能量表示](@entry_id:202173)同质性**，**低[能量表示](@entry_id:202173)异质性**。这不仅仅是一个抽象概念，它具有直接的临床相关性。在一个训练数据集中，如果我们发现同质组织总是产生高能量值（比如约 $0.18$），而异质肿瘤产生低能量值（比如约 $0.07$），我们就可以建立一个简单的模型，根据新未知组织的测量能量对其进行分类[@problem_id:4541118]。对于一个概率为 $p = (0, 1/6, 1/3, 0, 1/12, 1/4, 1/6, 0)$ 的玩具直方图，具体计算得出的能量为 $\frac{17}{72}$，这是一个介于完全均匀（能量=1）和最大分散之间的值[@problem_id:4567138]。

#### 熵：意外程度的度量

熵是硬币的另一面。这是一个从信息论中借来的概念，也许理解它的最好方式，是本着 Feynman 的精神，将其理解为**意外程度**的度量。

假设你从肿瘤中随机挑选一个体素。你对其强度值会有多意外？

如果[直方图](@entry_id:178776)呈尖峰状（高能量、同质状态），你几乎可以肯定你挑选的体素将来自那个主导的组。结果是可预测的。几乎没有意外，因此是**低熵**。

如果直方图是平坦且分散的（低能量、异质状态），任何强度值出现的可能性都大致相等。你完全不知道你会得到什么。结果是不可预测的。你会感到极度意外，这对应着**高熵**。

[香农熵](@entry_id:144587)（Shannon entropy）的公式完美地捕捉了这一点：

$$
H = -\sum_{i} p_i \log_b(p_i)
$$

在这里，项 $-\log_b(p_i)$ 表示单个结果的“意外”或信息内容。一个不太可能发生的事件（$p_i$ 很小）具有很大的意外值，而一个非常可能发生的事件（$p_i$ 很大）则具有很小的意外值。熵 $H$ 是所有可能结果的*平均意外程度*。这种函数形式不是任意的；它是满足[不确定性度量](@entry_id:152963)一系列基本公理的唯一数学表达式，例如在均匀分布时达到最大值，以及对于独立系统具有可加性[@problem_id:4541140]。在同一个玩具示例中，能量为 $\frac{17}{72}$，而熵（使用以2为底的对数）计算得出为 $1 + \frac{3}{4}\log_2(3)$，这是对其“无序度”的度量[@problem_id:4567138]。

简而言之，能量和熵是一对强大的组合。它们不关心绝对的亮度值，只关心概率分布的形状。高能量意味着低熵（[同质性](@entry_id:636502)、有序、可预测），而低能量意味着高熵（异质性、无序、意外）。

### 幕后操纵者：为什么特征会改变

故事在这里变得更加复杂和有趣。这些数字——能量、熵、均值、方差——并非刻在石头上的绝对真理。它们是一长串测量和计算链条的结果，而链条中的每一个环节都会影响最终结果。理解这些影响是进行良好、可重复科学研究的关键。

#### 机器中的幽灵：图像噪声

没有测量是完美的，医学图像中总是含有一定量的随机**噪声**。噪声对我们精心构建的直方图有什么影响呢？它会使一个干净、清晰的分布变得“模糊”不清。本应具有相同强度的体素被随机地推向稍高或稍低的值。

想象一个近乎同质的组织，其中几乎所有体素都应落入同一个组中。有了噪声，许多这些体素被推入了相邻的组中。直方[图的中心](@entry_id:266951)峰值会缩小，而周围的组会增高。分布变得更平坦[@problem_id:4541086]。其后果是直接而深刻的：直方图看起来更分散，集中度更低。这意味着**噪声会降低能量并增加熵**。一个完全均匀的组织，仅仅因为用了噪声更大的技术进行成像，就可能看起来是异质的。解决方案？通常必须在计算特征*之前*对图像应用空间[去噪](@entry_id:165626)滤波器，这是确保我们测量的是生物学特性而非噪声的关键步骤[@problem_id:4541086]。

#### 我们使用的镜头：图像重建

甚至在图像生成之前，所做的选择就已经影响了其纹理。在[计算机断层扫描](@entry_id:747638)（CT）中，来自扫描仪的原始数据通过**重建[核函数](@entry_id:145324)**转换成图像。一些[核函数](@entry_id:145324)旨在产生“平滑”的图像，而另一些则是“锐利”的，用以增强边缘。

把它想象成立体声的高音控制器。一个锐利的核函数就像调高高音：它增强了高频部分。在图像中，高频对应着锐利的边缘……以及噪声！锐利的核函数会同时放大两者，导致感兴趣区域内强度[直方图](@entry_id:178776)变宽，其尾部变得更“厚”。其效果与添加噪声惊人地相似：**方差、[峰度](@entry_id:269963)和熵增加**，而**能量减少**。如果过程校准得当，平均强度（即均值）可能基本不受影响，但描述纹理形状的特征可能会发生巨大变化[@problem_id:4545052]。同一个病人的两次扫描可能仅仅因为重建过程中的这一个选择不同，就产生不同的放射组学特征。

#### 我们用于测量的尺子：归一化与离散化

这也许是[可重复性](@entry_id:194541)面临的最微妙但最关键的挑战。为了比较不同患者之间的特征，我们必须确保我们都使用相同的尺子进行测量。

首先，并非所有的强度标度都是一样的。CT强度以**亨氏单位（Hounsfield Units, HU）**测量，已根据水的物理特性（0 HU）和空气的物理特性（-1000 HU）进行了标准化。这赋予了它们固定的物理意义，使得它们可以在不同扫描仪之间进行比较[@problem_id:4541130]。相比之下，磁共振成像（MRI）扫描的原始强度值通常是任意的。同一病人的同一组织在两台不同MRI机器上扫描，可能会产生强度值之间存在缩放和平移关系（$I_2 = a \cdot I_1 + b$）的图像。这意味着来自MRI的原始均值和方差不具有直接可比性，而像[偏度](@entry_id:178163)和峰度这样对这种变换不变的形状度量则更为稳健[@problem_id:4541130]。

这迫使我们对MRI数据进行**归一化**，但如何操作却充满风险。一种称为**固定组数离散化**的常用方法很好地说明了这个问题。假设我们决定总是将每个病人的肿瘤强度范围划分为，比如说，64个组。现在考虑两位病人。病人A的肿瘤强度动态范围很大，从0到3000。病人B的肿瘤范围较小，从0到600。对于病人A，64个组中的每一个都会很宽。对于病人B，每个组的宽度只有病人A的五分之一。一小簇集中的强度值可能全部落入病人A的一个宽组中，从而产生一个带有尖锐峰值的直方图（高能量，零熵）。但是，同样物理特性的强度簇可能会分布在病人B的几个窄组中，从而产生一个分散的[直方图](@entry_id:178776)（能量更低，熵更高）。生物学特性是相同的，但特征值却完全不同，这仅仅是因为我们的“尺子”根据图像的整体背景改变了其刻度[@problem_id:4541136]。

这就是为什么标准化至关重要。**影像生物标志物标准化创议（Image Biomarker Standardization Initiative, IBSI）**是一项全球性的努力，旨在就如何执行和报告这些处理步骤达成共识。为了实现可重复的科学研究，每一个细节都很重要。我们必须准确报告我们如何处理数据：用于计算归一化参数的域（是肿瘤本身，还是整个身体？）、具体的离散化策略（通常倾向于使用固定的物理组宽，而不是固定的组数），以及任何应用于数据的[非线性变换](@entry_id:636115)或裁剪。不说明这些细节就像发布一个只写着“烤至熟透”的食谱。没有温度和时间，没有人能做出同样味道的蛋糕[@problem_id:4541134, 4554313]。

从图像到数字的旅程是强大的，但它是一条需要精确性的道路。像能量和熵这样的特征的美妙之处在于它们能够捕捉纹理的本质，但它们的价值只有在我们掌握了塑造最终结果的噪声、重建和归一化这些幕后操纵者时才能实现。

