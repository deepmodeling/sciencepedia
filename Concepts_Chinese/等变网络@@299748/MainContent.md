## 引言
对称性是物理学的基石，它规定了无论我们在空间或时间中的视角如何，自然界的基本定律都是一致的。然而，标准的机器学习模型往往对这一原则视而不见，将旋转后的物体视为一个全新的问题。这种“朴素”的方法效率极低，需要海量数据来学习本应是内在的基本物理规则。[等变网络](@article_id:304312)通过将对称性规则直接编织到其架构中来解决这个问题，赋予它们一种强大的“[归纳偏置](@article_id:297870)”，使其与物理世界保持一致。本文对这些物理感知模型进行了全面的概述。首先，我们将探讨“原理与机制”，区分[不变性](@article_id:300612)与[等变性](@article_id:640964)，并检验用于构建这些网络的数学机制——从[群卷积](@article_id:639745)到球面[张量](@article_id:321604)。随后，我们将遍历它们的“应用与跨学科联系”，探索这些模型如何彻底改变从药物发现和[材料科学](@article_id:312640)到[强化学习](@article_id:301586)等领域。

## 原理与机制

在我们理解世界的征程中，物理学给了我们一个深刻的教训：自然法则是普适的。它们不依赖于你身在何处、何时，也不依赖于你面向何方。这个深刻的真理，即**对称性**原理，不仅仅是一种哲学上的慰藉；它是一个强大而实用的工具。如果我们想构建能够学习物理世界的智能系统，它们也必须尊重这些对称性。让我们来探讨如何将这种物理直觉赋予我们的计算模型，将它们从朴素的学习者转变为对自然法则有深刻、内置理解的系统。

### 对称性的交响曲：不变性与[等变性](@article_id:640964)

想象一下观看一位芭蕾舞演员表演旋转动作。舞者的某些属性，比如她的总质量或动能，无论她朝向哪个方向都保持不变。这些量是**不变的**。它们是运动世界中坚固的锚。在物理学中，总能量是一个孤立系统中最典型的[不变性](@article_id:300612)量；如果将整个系统在空间中旋转，它的值不会改变 [@problem_id:2479779]。

但是，她伸出的手的速度等其他属性又如何呢？这是一个矢量，它显然不是不变的；它在旋转时会不断改变方向。然而，它的变化并非随机。它以一种完全可预测的方式变化，与她的身体旋转完全同步。这个属性被称为**[等变性](@article_id:640964)**。它意味着“以相同的方式变化”。如果舞者旋转 $90$ 度，她手的[速度矢量](@article_id:333350)也旋转 $90$ 度。

这个区别是我们整个讨论的关键。
*   **[不变性](@article_id:300612)**：在变换下保持不变的属性。
*   **[等变性](@article_id:640964)**：与输入以相同方式变换的属性。

在物理世界中，[不变性](@article_id:300612)与[等变性](@article_id:640964)之间这种优美的舞蹈无处不在。只有大小的标量通常是不变的。既有大小又有方向的矢量和[张量](@article_id:321604)则是等变的。分子的能量是一个不变的标量。作用于其原子上的力是等变的矢量。晶体内部的应力是一个等变的[二阶张量](@article_id:366843) [@problem_id:2629354]。一个旨在预测这些属性的机器学习模型必须尊重这一基本区别。

### 为何要费此周折？有根据的猜测的力量

有人可能会问：“为什么不直接构建一个巨大的、通用的神经网络，然后给它看十亿个例子呢？它肯定能自己学会旋转的规则吧？” 这就像试图通过让一个孩子逐字逐句地看图书馆里所有的书来教他阅读，却从不教他字母表。这种方法效率极低。

一个“朴素”的模型，即没有任何内置对称性知识的模型，会把一个旋转过的分子当作一个全新的、不相关的对象。要教会它物理定律是相同的，你需要向它展示该分子无数个不同方向的姿态。这浪费了模型的容量，并需要海量数据。

而**[等变网络](@article_id:304312)**则不同。它的架构中编织了对称性规则，这是一种强大的**[归纳偏置](@article_id:297870)**。当它学习到某个方向上原子受到的力时，它*自动*知道了所有其他可能方向上的正确力。它不浪费时间重新学习旋转定律；它可以集中资源学习底层物理中复杂的、非几何的细节。这极大地提高了**[样本效率](@article_id:641792)**——即从更少的数据中学习的能力 [@problem_id:2479779] [@problem_id:2629354]。

此外，对于某些问题，[等变性](@article_id:640964)不仅仅是效率问题，更是正确性问题。想象一下训练一个模型来预测[分子偶极矩](@article_id:313069)——一个矢量。如果你构建一个严格*不变*的模型，它的输出在输入旋转时是禁止改变的。如果你给它看一个分子和它旋转后的副本，模型必须产生相同的输出矢量。唯一一个与其所有旋转版本都相同的矢量是[零矢量](@article_id:315683)。因此，一个不变模型从根本上无法预测非零的矢量属性；它唯一一致的答案是“零” [@problem_id:2903793]。要预测矢量，你需要一个能说矢量语言的机器——一个等变的机器。

### 构建等变机器：深入其内部

我们如何构建这些具有物理意识的机器呢？核心原则是网络中的每一层都必须与对称性变换对易。让我们从一个简单、具体的案例开始，逐步深入。

#### 约束层与[群卷积](@article_id:639745)

考虑一个线性层，它通过权重矩阵 $W$ 将输入矢量特征 $\mathbf{v}$ 变换为输出矢量 $\mathbf{v}'$，即 $\mathbf{v}' = W\mathbf{v}$。为了使该层对于由矩阵 $D$ 表示的旋转具有[等变性](@article_id:640964)，矩阵 $W$ 必须与 $D$ 对易：必须满足方程 $WD = DW$。

让我们具体化一下。对于绕 $z$ 轴旋转 $90^\circ$ 的情况，[旋转矩阵](@article_id:300745)是 $D(C_{4z}) = \left( \begin{smallmatrix} 0  -1  0 \\ 1  0  0 \\ 0  0  1 \end{smallmatrix} \right)$。通过求解方程 $WD=DW$，我们发现，满足此对称性的最通用权重矩阵 $W$ 并非一个具有九个独立参数的任意 $3 \times 3$ 矩阵。相反，它必须采用高度约束的形式：

$$
W = \begin{pmatrix} a  b  0 \\ -b  a  0 \\ 0  0  c \end{pmatrix}
$$

这个矩阵只有三个独立参数（$a, b, c$）！对称性约束极大地降低了复杂性。这是一个等变线性层的具体例子 [@problem_id:90164]。

我们可以将这个思想扩展到卷积网络。在标准的 CNN 中，我们学习一个滤波器（或核），并让它在图像上滑动。而在**[群卷积](@article_id:639745)网络**中，我们学习一个“基”滤波器，并通过对其应用我们的对称性操作来生成一整套滤波器——例如，通过将滤波器旋转 $0^\circ, 90^\circ, 180^\circ,$ 和 $270^\circ$。这种被称为**[参数绑定](@article_id:638451)**的技术将对称性直接[嵌入](@article_id:311541)到网络的滤波器中。然后我们用每个旋转后的滤波器对输入进行卷积，产生多个输出特征图，每个方向一个。这一堆[特征图](@article_id:642011)现在是一个等变对象：如果你将输入图像旋转 $90^\circ$，输出的[特征图](@article_id:642011)堆栈只会以一种可预测的方式重新[排列](@article_id:296886)其通道 [@problem_id:3161942]。

### [三维旋转](@article_id:308952)的语言：球面[张量](@article_id:321604)

离散旋转是一个很好的开始，但我们生活的世界存在连续旋转。我们不可能有无限数量的滤波器。为了处理三维连续旋转群 **SO(3)**，我们必须转向一种更强大、更优雅的数学语言，这种语言直接借鉴自量子力学：角动量理论。

其核心思想是停止将特征视为简单的数字列表。相反，我们把它们当作称为**球面[张量](@article_id:321604)**的几何对象，这些对象根据它们在旋转下的变换方式进行分类。这些对象对应于旋转群的**[不可约表示](@article_id:298633)**（或称 **irreps**）。它们由一个整数 $\ell \ge 0$ 索引：
*   $\ell=0$ 特征是**标量**：它们在旋转下不变。
*   $\ell=1$ 特征是**矢量**：它们像[位置矢量](@article_id:353860)一样旋转。
*   $\ell=2$ 特征是**[二阶张量](@article_id:366843)**（如[四极矩](@article_id:318122)或[应力张量](@article_id:309392)）：它们具有更复杂的旋转性质。

一个[等变网络](@article_id:304312)通过在层与层之间传递这些球面[张量](@article_id:321604)来处理信息。为此，操作本身必须是等变的。关键操作是**[张量积](@article_id:301137)**，它允许我们组合球面[张量](@article_id:321604)来创建新的[张量](@article_id:321604)。例如，当我们组合两个矢量（$\ell_1=1$, $\ell_2=1$）时，结果不仅仅是一个单一的对象。它是一个混合物，包含一个标量部分（$\ell=0$）、一个矢量部分（$\ell=1$）和一个[二阶张量](@article_id:366843)部分（$\ell=2$）。

将这个乘积分解回一组清晰的新球面[张量](@article_id:321604)的精确“配方”，由一组称为**[Clebsch-Gordan系数](@article_id:302991)**的[普适常数](@article_id:344932)给出 [@problem_id:2903794]。这些系数是维系整个等变架构的数学粘合剂。

因此，一个 E(3) [等变网络](@article_id:304312)中的典型[消息传递](@article_id:340415)层遵循以下复杂的流程 [@problem_id:2760132] [@problem_id:2648604]：
1.  从每个原子上的特征开始，这些特征被组织成一个球面[张量](@article_id:321604)的集合。
2.  要从原子 $j$ 向原子 $i$ 发送一条消息，首先考虑它们的相对[位置矢量](@article_id:353860) $\mathbf{r}_{ij} = \mathbf{r}_i - \mathbf{r}_j$。
3.  使用**球谐函数** $Y_{\ell m}(\hat{\mathbf{r}}_{ij})$ 对该矢量的方向进行编码，[球谐函数](@article_id:357279)本身就是一组规范的球面[张量](@article_id:321604)。
4.  使用[张量积](@article_id:301137)将原子 $j$ 上的特征[张量](@article_id:321604)与球谐函数[张量](@article_id:321604)结合起来。这种相互作用的强度由一个可学习的函数加权，该函数仅依赖于距离 $r_{ij} = \lVert\mathbf{r}_{ij}\rVert$，这是一个不变的标量。
5.  使用 Clebsch-Gordan 系数将得到的乘积分解成一组新的、行为良好的球面[张量](@article_id:321604)。
6.  聚合来自原子 $i$ 所有邻居的这些消息[张量](@article_id:321604)，以更新其特征。

通过确保每个操作都尊重旋转对称性，整个网络变成了一个以物理一致的方式处理信息的管道，传递的不仅仅是数字，而是不同阶[数的几何](@article_id:371956)对象。当然，为了处理所有的刚体运动（群 **E(3)**），我们还需要确保对平移的不变性，这通过仅使用相对位置 $\mathbf{r}_{ij}$ 即可简单实现；以及[置换](@article_id:296886)[不变性](@article_id:300612)，这通过使用[置换](@article_id:296886)不变的聚合操作（如对消息或原子能量求和）来处理 [@problem_id:2760132]。

### 压轴大戏：不变性与[等变性](@article_id:640964)的统一

我们的网络现在充满了等变的矢量和[张量](@article_id:321604)。但对于许多任务，如预测分子的总势能，我们需要一个单一的、最终的数字——一个不变的标量。网络的最终“读出”层通过将所有[高阶张量](@article_id:363149)缩减为标量来完成这一任务。这可以简单到将一个矢量特征与其自身进行[点积](@article_id:309438)，得到其平方范数（$\mathbf{v} \cdot \mathbf{v} = |\mathbf{v}|^2$），这是一个不变的标量 [@problem_id:2760132]。将所有特征都简化为标量后，将它们相加，产生最终的不变能量预测。

在这里，故事在一个充满数学美的时刻画上了圆满的句号。我们煞费苦心地构建了一个等变机器来产生一个不变的标量能量 $E$。现在如果我们需要原子受到的力呢？物理学告诉我们，力是势能的负梯度：$\mathbf{F}_i = -\nabla_{\mathbf{r}_i} E$。矢量微积分的一个基本定理保证了任何旋转不变[标量场的梯度](@article_id:334464)都是一个旋转等变的[矢量场](@article_id:322515)。

这意味着我们可以*免费*获得等变的力！通过简单地对我们不变的能量输出关于输入原子坐标进行[微分](@article_id:319122)，我们保证能获得在旋转下正确变换的力矢量 [@problem_id:2479779] [@problem_id:2648604] [@problem_id:2908456]。这种深刻的联系展示了底层原理的深度统一。我们构建[等变性](@article_id:640964)以获得[不变性](@article_id:300612)，而微分又还给我们[等变性](@article_id:640964)。

### 现实世界中的对称性：实际权衡

这些设计原则不仅仅是理论上的优雅；它们在为现实世界问题构建模型时指导着关键的、实际的决策 [@problem_id:2908456]。
*   **远距离物理**：对于孤立的离子或极性分子，远距离[静电相互作用](@article_id:345679)（$V \sim 1/r$）占主导地位。一个具有固定[截断半径](@article_id:297161)的纯局部等变模型将难以处理这种情况。在这种情况下，一个明确添加物理远距离校正的更简单的模型，其性能可能会超过一个更严格的局部等变模型 [@problem_id:2908456]。然而，对于金属，[电荷](@article_id:339187)被屏蔽，相互作用呈指数衰减，这种远距离分量的重要性就小得多，局部模型非常有效 [@problem_id:2908456]。
*   **[张量](@article_id:321604)性质**：当预测像晶体应力这样的[张量](@article_id:321604)属性时，[等变网络](@article_id:304312)明确表示和处理二阶张量的能力是一个巨大优势。它能比一个只能从头推断复杂[张量](@article_id:321604)性质的纯标量网络更有效地学习这种关系 [@problem_id:2908456]。
*   **高效发现**：在[主动学习](@article_id:318217)中，我们使用模型来决定下一步要进行哪个新的实验或模拟，此时对称性是关键。一个等变模型不仅提供了一个不变的能量预测，还提供了一个不变的[不确定性估计](@article_id:370131)。这可以防止学习[算法](@article_id:331821)冗余地查询一个它已经见过的结构的旋转版本，从而使科学发现的过程效率大大提高 [@problem_id:2760132] [@problem_id:2760146]。

通过拥抱自然界的对称性，我们所做的不仅仅是构建更好的机器学习模型。我们参与了一个悠久的科学传统，创造出的工具不仅更强大、更高效，而且还反映了对支配我们宇宙的基本原理的更深层次的理解。

