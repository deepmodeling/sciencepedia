## 引言
我们如何才能将物理学家眼中电子作为[离域](@article_id:362635)波的观点，与化学家眼中局域[化学键](@article_id:305517)和轨道的图像统一起来？在固体的量子世界里，这两种观点虽然都正确，但常常看似是两种独立的语言。[离域](@article_id:362635)的[布洛赫波](@article_id:304985)完美地描述了[能带](@article_id:306995)，但却缺乏化学直观性。反之，局域[化学键](@article_id:305517)虽然具体，但有时会感觉像是一种人为的简化。本文将介绍[最大局域化瓦尼尔函数](@article_id:307773) (MLWFs)，这是一个强大的理论和计算框架，它优雅地弥合了这一概念上的鸿沟。它提供了一种[第一性原理方法](@article_id:332255)，可将[量子计算](@article_id:303150)得到的抽象、[离域](@article_id:362635)的[波函数](@article_id:307855)，转换为一组在实空间中最大程度紧凑、具有化学直观性的轨道。

本文将引导您走进 MLWFs 的世界。在“原理与机制”一节中，我们将深入探讨其核心思想，探索最小化实空间“延展”如何克服[布洛赫态](@article_id:307967)的数学模糊性，并揭示其与电子[能带](@article_id:306995)内在几何的深刻联系。随后，“应用与跨学科联系”一节将展示这些局域函数如何作为一种强大工具，用于创建简化模型、计算电极化等宏观性质、研究复杂[磁性材料](@article_id:298402)以及诊断奇异的物质拓扑相。

## 原理与机制

想象一下，您正试图理解晶体中电子所构成的复杂社会。您有两种看待它的方式。一方面是物理学家的视角：电子被视为[离域](@article_id:362635)的波，即**[布洛赫波](@article_id:304985)**，在原子[晶格](@article_id:300090)的完美周期性景观中毫不费力地滑行。这个图像非常强大。它解释了为什么金属能导电而绝缘体不能，为我们带来了[能带](@article_id:306995)和[带隙](@article_id:331619)的完整概念。在这种观点中，电子是整个晶体的公民，其身份弥散在整个集体中。

另一方面是化学家的视角。在这里，电子是高度局域的。它们作为内层电子或孤对电子属于特定的原子，或者被两个原子共享形成[共价键](@article_id:301906)。这个图像植根于我们熟悉的**[原子轨道](@article_id:301262)和分子轨道**语言。它在解释[晶体结构](@article_id:300816)、原子为何处于特定位置以及维系一切的[化学键](@article_id:305517)的性质方面表现出色。

很长一段时间里，这两种图像似乎是用不同的语言描述同一个世界。[布洛赫波](@article_id:304985)是系统的精确能量本征态，在数学上纯粹而正确，但在物理上却感觉飘渺而抽象。[化学键](@article_id:305517)直观而具体，但它们是如何从离域波的海洋中浮现出来的呢？关键问题是：我们能否在这两个世界之间建立一座严谨的数学桥梁？答案是肯定的，而这座桥梁正是用**[瓦尼尔函数](@article_id:306415)**构建的。

### 从 k 空间到实空间的桥梁

[布洛赫波](@article_id:304985) $|\psi_{n\mathbf{k}}\rangle$ 存在于动量（或 **$\mathbf{k}$ 空间**）的抽象领域中。每个波都由一个[能带](@article_id:306995)指数 $n$ 和一个晶体动量 $\mathbf{k}$ 来标记。为了得到实空间图像，我们可以进行一个标准的数学操作：傅里叶变换。通过将给定[能带](@article_id:306995)的所有[布洛赫波](@article_id:304985)在[布里渊区](@article_id:302835)内的所有可能动量上求和，我们可以构建一个在实空间中局域化的新函数。这个新对象 $|w_{n\mathbf{R}}\rangle$ 就是[能带](@article_id:306995) $n$ 的**瓦尼尔函数**，中心位于[晶格](@article_id:300090)位置 $\mathbf{R}$ 处的[原胞](@article_id:319758)中。

从[布洛赫态](@article_id:307967)集合到[瓦尼尔函数](@article_id:306415)集合的一般变换由下式给出：
$$
|w_{n\mathbf{R}}\rangle = \frac{V}{(2\pi)^{d}} \int_{\mathrm{BZ}} d^d\mathbf{k} \, \exp(-i\mathbf{k}\cdot\mathbf{R}) \sum_{m=1}^{N} U_{mn}(\mathbf{k}) |\psi_{m\mathbf{k}}\rangle
$$
这里，我们考虑一组 $N$ 个[能带](@article_id:306995)，并引入了一个神秘的[幺正矩阵](@article_id:299426) $U_{mn}(\mathbf{k})$，它可以在变换前的每个 $\mathbf{k}$ 点“混合”不同的[布洛赫态](@article_id:307967)。现在，让我们暂时忽略它，想象我们只有一个[能带](@article_id:306995)（$N=1$）并设 $U(\mathbf{k})=1$。这个过程似乎很简单：从动量空间变换到实空间。我们已经建好了桥！但我们很快发现，由于我们刚才忽略的那个矩阵，这座桥是一个摇摇欲坠、不稳定的结构。

### [规范自由度](@article_id:320895)的“无政府状态”

症结就在于此。构成我们[能带](@article_id:306995)基础的[布洛赫态](@article_id:307967)不是唯一的。在任何给定的 $\mathbf{k}$ 点，你都可以自由地将[波函数](@article_id:307855) $\psi_{n\mathbf{k}}$ 乘以一个任意的相位因子 $\exp(i\phi_n(\mathbf{k}))$，而任何基本物理性质——能量、[电荷密度](@article_id:305099)、在某处找到电子的概率——都不会改变。如果你处理的是一组与所有其他[能带](@article_id:306995)在能量上孤立的 $N$ 个[能带](@article_id:306995)，你甚至有更大的自由度：你可以在每个 $\mathbf{k}$ 点使用任何 $N \times N$ 的幺正矩阵 $U(\mathbf{k})$ 将它们混合在一起。这就是臭名昭著的[布洛赫态](@article_id:307967)的**规范自由度** [@2484958]。

这种自由度看似一个微不足道的数学细节，却对我们的[瓦尼尔函数](@article_id:306415)产生了巨大的影响。在[布里渊区](@article_id:302835)中每一种不同的相位“旋转”选择——即每一种不同的规范——在傅里叶变换后都会产生一套完全不同的瓦尼尔函数。虽然所有这些函数集在数学上都是有效的（它们构成了该[能带](@article_id:306995)的一个完备[正交基](@article_id:327731)），但它们中的大多数在物理上是无用的。它们产生的是极其[离域](@article_id:362635)、延展的函数，与紧凑的轨道毫无相似之处。一个选择不当的规范，例如一个带有不连续性的规范，会导致瓦尼尔函数随距离缓慢衰减（呈代数长尾），而不是像原子一样被紧密束缚 [@2955796]。

因此，问题不仅仅在于构造瓦尼尔函数，而在于如何在规范自由度的无尽海洋中航行，以找到*唯一*“最佳”的那一套。但“最佳”意味着什么呢？

### “最整洁”原则

“最佳”的实空间表示应该是物理上最直观的那一个。我们想要的轨道应尽可能紧凑和局域，看起来像我们想象中整洁的化学构件。我们可以通过量化“[离域](@article_id:362635)性”或“延展”来使这个想法变得精确。对于每个在原胞中的[瓦尼尔函数](@article_id:306415) $|w_{n\mathbf{0}}\rangle$，我们可以计算其二次延展，这是一个简单的统计方差：
$$
\Omega_n = \langle \mathbf{r}^2 \rangle_n - |\langle \mathbf{r} \rangle_n|^2
$$
总延展 $\Omega$ 只是我们集合中所有瓦尼尔函数延展的总和，即 $\Omega = \sum_n \Omega_n$。

这引出了由 Nicola Marzari 和 David Vanderbilt 提出的一个优美而强大的思想，它构成了现代理论的核心：让我们把这变成一个优化问题。我们可以在所有可能的规范 $U(\mathbf{k})$ 中搜索，找到那个能**最小化总延展** $\Omega$ 的特定规范。通过这个过程得到的函数被称为**[最大局域化瓦尼尔函数](@article_id:307773) (MLWFs)**。这是一个“最整洁”原则：我们要求我们的数学描述在自然允许的范围内尽可能紧凑和简单 [@2484958]。

总延展 $\Omega$ 可以巧妙地分解为两部分：$\Omega = \Omega_I + \Omega_D$。第一部分 $\Omega_I$ 是**规范不变**部分；其值是[能带结构](@article_id:340682)的内在属性，任何平滑的[规范变换](@article_id:323438)都无法改变它。第二部分 $\Omega_D$ 是**规范依赖**部分，而这正是我们可以控制的部分。最小化过程旨在将这个规范依赖部分驱动到尽可能小，理想情况下为零 [@227665]。剩下的是由[能带](@article_id:306995)内在性质所允许的最小延展。

### 电子[能带](@article_id:306995)的隐藏几何

这个最小化过程实际上对[布洛赫态](@article_id:307967)做了什么？它迫使它们在整个布里渊区内形成最平滑的构型。想象一下在 **$\mathbf{k}$ 空间**中行走。在每一步，一个糟糕的规范选择都可能导致[波函数](@article_id:307855)的内部相位发生不规则的扭曲和转动。MLWF 过程找到了消除这种不必要扭曲的规范。用[微分几何](@article_id:306240)的语言来说，它找到了一个遵循**平行输运**规则的基。

这种“扭曲”由一个深刻的数学对象——**[贝里联络](@article_id:297115)** $A_{mn}(\mathbf{k}) = i\langle u_{m\mathbf{k}} | \nabla_{\mathbf{k}} u_{n\mathbf{k}}\rangle$ 来量化。事实证明，最小化实空间延展 $\Omega$ 等价于对 **$\mathbf{k}$ 空间**中这个对象施加一个条件：在新的、旋转后的基中，它必须是对角的 [@2787095]。

这种与[能带](@article_id:306995)几何的深刻联系带来了一个惊人的物理后果。[最大局域化瓦尼尔函数](@article_id:307773)的最终位置不是任意的。例如，对于一维晶体，一个 MLWF 的[电荷中心](@article_id:330769) $\bar{x}$ 直接由[贝里联络](@article_id:297115)在整个[布里渊区](@article_id:302835)上的积分决定。这个积分是一个著名的量，称为**[贝里相位](@article_id:319854)**（在一维情况下为 [Zak 相位](@article_id:305072)）[@2787095]。我们微观轨道的位置是由整个能带结构的全局几何性质决定的！

更值得注意的是，这些瓦尼尔中心的总和直接关系到材料的一个宏观、可测量的性质：其体电极化。这一结果是**[极化现代理论](@article_id:330651)**的基石，它在我们局域轨道的微观位置与晶体的宏观电响应之间建立了牢不可破的联系 [@3024058]。

### 回报：来自第一性原理的化学

那么，在经历了所有这些复杂的数学之后，这些 MLWFs 到底是什么样子的呢？优美的答案是，它们看起来与化学中的图像完全一致。延展的最小化自动发现了[电子结构](@article_id:305583)中最具化学直观性的表示。

-   在像硅这样的共价固体中，四个价带源于原子的 $s$ 和 $p$ 轨道。MLWF 过程返回的不是以原子为中心的 $s$ 和 $p$ 函数，而是产生了四个优美的 $sp^3$ 类[杂化轨道](@article_id:324470)，每一个都完美地位于一个 Si-Si [共价键](@article_id:301906)的中心，随时准备形成四面体网络 [@3024058]。

-   在[离子晶体](@article_id:299046)中，价带的 MLWFs 局域在阴离子位置，看起来就像该离子的原子轨道。

-   如果你从具有[奇宇称](@article_id:354831)（$\phi(-x) = -\phi(x)$）的原子 $p_x$ 轨道构建一个[能带](@article_id:306995)，所得到的 MLWF 将忠实地继承这种对称性，也具有[奇宇称](@article_id:354831) [@1279784]。

-   [Su-Schrieffer-Heeger (SSH) 模型](@article_id:298697)提供了一个绝佳的例证，这是一个具有交替强弱键的[二聚化](@article_id:334813)聚合物链的玩具模型。如果强键位于[原胞](@article_id:319758)*内部*，占据带的 MLWF 会优美地定域在该胞内键的中心。如果你调整参数，使得强键现在位于[原胞](@article_id:319758)*之间*，MLWF 会自动将其中心移动到这个新的、更强的胞间键上！延展最小化和贝里相位的数学自动找到了电子想要形成键的位置 [@3024053]。

### 深入丛林：纠缠、拓扑与对称性

现实世界很少像一组孤立的[能带](@article_id:306995)那样简单。在大多数材料中，尤其是金属，我们感兴趣的[能带](@article_id:306995)（比如[过渡金属](@article_id:298678)的 $d$ 轨道）在能量上与其他[能带](@article_id:306995)（如宽的 $s$ 和 $p$ [能带](@article_id:306995)）**纠缠**在一起。没有一个清晰的[能隙](@article_id:331619)来隔离我们的目标[能带](@article_id:306995)。

为了解决这个问题，一种名为**退纠缠**的杰出两步法被发明出来。首先，一个[算法](@article_id:331821)巧妙地从更大、更混乱的[能带](@article_id:306995)集合中“carving out”（切出）一个光滑的 $N$ 维子空间，旨在捕捉所需的化学特征（例如，$d$ 轨道特征）。这个子空间的构造旨在使其在整个布里渊区内尽可能平滑地变化。其次，标准的延展最小化程序被应用*于*这个光滑的子空间内，以生成 MLWFs [@2955796] [@2801788]。这种强大的技术使我们能够为最复杂的金属生成具有化学意义的局域轨道。

然而，也存在着根本的限制。有时，材料的能带结构是**拓扑非平庸**的。一个著名的例子是具有非零**[陈数](@article_id:300463)**的[能带](@article_id:306995)。在这种情况下，存在一个深刻的数学**阻碍**，使得在整个[布里渊区](@article_id:302835)内为[布洛赫态](@article_id:307967)定义一个平滑、周期的规范变得*不可能*。因此，为该[能带](@article_id:306995)构建一组指数局域化的瓦尼尔函数也是不可能的。人们能达到的最好结果是较慢的[幂律](@article_id:320566)局域化 [@2955796] [@3024058]。拓扑，即[能带](@article_id:306995)的全局结构，决定了局域化的最终极限。

最后，我们可以将晶体的**对称性**作为一个强大的工具来使用。我们可以在最小化问题中添加约束，要求我们最终的 MLWFs 按照晶体的[对称操作](@article_id:303832)进[行变换](@article_id:310184)。这可能会导致稍大的延展（无约束的最小值根据定义是绝对可能的最低值），但它保证了所得到的轨道在物理上是有意义的，并将其中心固定在晶体中的高对称性位置，即 Wyckoff 位置 [@3024026]。

归根结底，[最大局域化瓦尼尔函数](@article_id:307773)提供了一座坚固、优美且极具洞察力的桥梁。它们将物理学家的[离域](@article_id:362635)波与化学家的局域键联系起来，揭示了电子[能带](@article_id:306995)隐藏的几何结构，并使我们能够直接从支配[固体的量子力学](@article_id:368447)定律中提取出具体的化学直觉。