## 引言
我们世界中的许多系统，从弯曲的回形针到活细胞，都拥有对其过去的“记忆”。它们未来的行为不仅由当前可观测的状态决定，还由其历史所塑造的隐藏内部状态决定。这带来了一个根本性的挑战：当关键信息不可见时，我们如何为系统建立预测模型？答案在于强大而统一的**内在变量模型**框架，这是一个为不可见因素赋予数学实质的科学概念。这些模型通过假设存在追踪其历史的隐藏变量来丰富我们对系统的描述，使我们能够理解和预测复杂的、依赖路径的现象。

本文探讨了内在变量模型的原理和深远影响。以下各节将深入探讨其基本概念，探索这些模型如何在工程学中捕捉材料记忆，如何在量子力学中提供隐藏与可见之间的概率性联系，并揭示我们经典直觉的局限性。然后，我们将展示这一思想如何应用于不同领域，从创建材料的“[数字孪生](@entry_id:171650)”到揭示生物学中生命的隐藏驱动力，再到为人工智能中的[生成式设计](@entry_id:194692)提供动力。

## 原理与机制

想象一下，你遇到一个朋友，他外表看起来一切正常，但你知道他刚刚跑完一场马拉松。他的外在表象——身高、衣着——没有改变，但其内部状态的某些根本方面却有所不同。他很疲劳。这种不可观测的“疲劳”内在状态将决定他对你提出的友好赛跑建议的反应。要预测他的行为，你需要考虑这个**内在变量**。

科学在构建世界预测模型的探索中，不断面临同样的挑战。我们能够轻易测量的变量——位置、温度、电压、基因的表达水平——往往不能说明全部情况。系统拥有一个由其过去塑造的“记忆”或[隐藏状态](@entry_id:634361)，它支配着未来的行为。**内在变量模型**的概念是一个强大而统一的思想，它使我们能够窥探这个隐藏的世界，为描述从弯曲的金属和沙土的行为到量子力学的奥秘以及我们自身基因密码中的模式等一切事物提供了一个框架。

### 旅程的记忆：捕捉历史

让我们从一个你几乎能亲手感觉到的东西开始：一个金属回形针。如果你先将它朝一个方向弯曲，然后再试图将其掰回，你会注意到它在反向弯曲时更容易屈服，或者说开始永久变形。这种现象被称为**[包辛格效应](@entry_id:173790)**，是材料记忆的完美例证。回形针“记住”了它第一次被弯曲的方向。

我们如何为这种记忆建立数学模型呢？我们可以尝试追踪每一个原子的位置和[晶格](@entry_id:196752)中所有的微观[位错](@entry_id:157482)，但这将是无可救药的复杂。相反，我们可以更巧妙一些。我们可以假设存在宏观的内在变量，它们捕捉了所有[微观混沌](@entry_id:150007)的*平均*效应。

在塑性理论中，使用了两个关键的内在变量。一个简单的标量，通常表示为 $p$，其作用类似于里程表，追踪材料所经历的塑性（永久）变形总量，而与方向无关 [@problem_id:2693927]。但这还不足以解释[包辛格效应](@entry_id:173790)。两个回形针，一个只向右弯曲，另一个先向右再向左弯曲相同的总变形量，它们可能具有相同的 $p$ 值，但其行为将截然不同。

为了捕捉[方向性](@entry_id:266095)记忆，我们引入了一个更复杂的内在变量，称为**背应力**，通常用张量 $\boldsymbol{\alpha}$ 表示。你可以将背应力想象成一个隐藏的内应力场，它抵抗进一步的变形。当你将回形针向右弯曲时，你会建立一个同样指向右侧的内部背应力。当你随后试图向左弯曲它（在压缩状态下），这个[内应力](@entry_id:193721)会*帮助*你，使其更容易产生新的塑性变形。

金属的状态不再仅仅是其可见的形状；而是它的形状*加上*这些内在变量的值，即 $(\boldsymbol{\alpha}, p)$。这就是内在变量模型的精髓：它丰富了对系统状态的描述，以包含其历史的记忆，使其响应具有[路径依赖性](@entry_id:186326) [@problem_id:2693927] [@problem_id:3531255]。这些变量并非我们可以分离出来的“基本”粒子；它们是绝妙的数学构造，使得复杂的宏观行为变得可以理解和预测。

### 连接隐藏与可见：概率之桥

那么，我们有了这些隐藏变量。但它们如何与我们实际观察到的事物联系起来呢？内部状态与测量结果之间的联系并不总是一种简单的直接关系。量子力学的世界为探索这些联系提供了一个引人入胜的平台。

几十年来，像 Albert Einstein 这样的物理学家一直对量子力学固有的随机性感到困扰。他们推测，这种随机性或许只是一种幻觉，是我们对由“[隐变量](@entry_id:150146)”支配的更深层次现实无知的结果。让我们想象一个粒子有一个单一的[隐变量](@entry_id:150146)，我们称之为 $\lambda$。当我们进行一次测量，得到的结果为 $+1$ 或 $-1$ 时，$\lambda$ 是如何决定结果的呢？

我们可以想象两种联系 [@problem_id:2097065]：

1.  **确定性联系**：在这种情况下，$\lambda$ 的值唯一地决定了结果。例如，一个模型可能会说：“如果 $\lambda$ 在 $0$ 到 $0.5$ 之间，结果总是 $+1$。如果 $\lambda$ 在 $0.5$ 到 $1$ 之间，结果总是 $-1$。”我们所感知的随机性仅仅是因为我们不知道任何给定粒子的 $\lambda$ 的确切值；我们只知道它的[统计分布](@entry_id:182030)。

2.  **随机性联系**：在这种情况下，联系本身是概率性的。$\lambda$ 的值并不确定结果，而是确定每种结果的*概率*。例如，模型可以是：“对于给定的 $\lambda$ 值，得到 $+1$ 的概率等于 $\lambda$ 本身。”所以如果 $\lambda=0.7$，那么有 $70\%$ 的几率测量到 $+1$，有 $30\%$ 的几率测量到 $-1$。

这种区别是根本性的。它为我们构建模型的方式提供了巨大的灵活性。连接隐藏世界与可观测世界的“机制”可以像一个尖锐的阈值一样简单，也可以像一个平滑变化的概率一样微妙。

### 一个思想，多个世界：从金属到基因

内在变量概念的真正美妙之处在于其普适性。让我们从[固体力学](@entry_id:164042)和量子物理学的世界跳跃到生物学和人工智能的前沿。想象你是一位计算生物学家，拥有来自数千个不同细胞的大量基因表达水平数据集。对于每个细胞，你都有 $p$ 个基因的测量值，即一个 $p$ 维空间中的向量 $\mathbf{x}$。这是一个信息量巨大的数据集。

你可能会假设，这种巨大的复杂性实际上是由少数几个潜在的生物学过程或通路驱动的——比如“细胞生长”、“[应激反应](@entry_id:168351)”或“新陈代谢”。这些通路不是直接测量的；它们是隐藏的。它们就是我们的内在变量，我们可以称之为 $\mathbf{z}$。

这正是诸如**[因子分析](@entry_id:165399) (FA)** 和 **概率主成分分析 (PPCA)** 等统计方法背后的思想 [@problem_id:3302588]。这些是[潜变量模型](@entry_id:174856)，它们提出了一个简单的生成故事：观测到的基因表达 $\mathbf{x}$ 是潜在通路活动 $\mathbf{z}$ 的[线性组合](@entry_id:154743)，再加上一些噪声。该模型写作 $\mathbf{x} = \mathbf{W}\mathbf{z} + \boldsymbol{\mu} + \boldsymbol{\epsilon}$。在这里，矩阵 $\mathbf{W}$ 是一个“载荷”矩阵，它充当桥梁，指定了每个隐藏通路 $\mathbf{z}$ 的活动如何影响每个可观测基因 $\mathbf{x}$ 的表达。

正如在我们的量子例子中一样，我们对这个模型中“不可见”部分所做的假设至关重要。PPCA 假设噪声 $\boldsymbol{\epsilon}$ 是简单且均匀的（各向同性），意味着每个基因都受到相同数量的随机[测量误差](@entry_id:270998)的影响。[因子分析](@entry_id:165399)则更灵活；它允许每个基因有其自身的特定噪声水平（异[方差](@entry_id:200758)噪声），通过使用对角噪声[协方差矩阵](@entry_id:139155) $\boldsymbol{\Psi}$ 来实现。这使得 FA 能够更好地捕捉基因特异性的人为因素，但代价是模型拟合起来更复杂。这种权衡——简单性与灵活性——是在构建内在变量模型这门艺术中一个永恒的主题 [@problem_id:3302588]。

### 量子之谜：经典现实的“诡异”极限

试图用[隐变量](@entry_id:150146)解释量子力学的尝试，导致了[物理学史](@entry_id:168682)上最深刻的发现之一。争论的[焦点](@entry_id:174388)是一种被称为**定域性**的属性。正如 Einstein 所论证的，如果你有两个[纠缠粒子](@entry_id:153691)，一个发送给地球上的 Alice，另一个发送给火星上的 Bob，Alice 对她的粒子进行的测量不应瞬时影响 Bob 的测量结果。任何影响都应受限于光速。一个尊重这一原则的模型被称为**定域[隐变量](@entry_id:150146)模型**。

在这样的模型中，Alice 的结果 $A$ 只能取决于她的测量设置 $a$ 和共享的[隐变量](@entry_id:150146) $\lambda$。它不能取决于 Bob 的设置 $b$。对 Bob 来说也必须如此。在数学上，概率必须可以分解：$P(A|a, b, \lambda) = P(A|a, \lambda)$ 和 $P(B|a, b, \lambda) = P(B|b, \lambda)$ [@problem_id:2097087]。这似乎非常合理。这是我们经典直觉的基石。

然而，在 1964 年，物理学家 John Bell 证明了一个惊人的定理。他表明，*任何*遵守定域性原则的模型都无法重现量子力学所预测的所有[统计相关性](@entry_id:267552)。看来，自然比 Einstein 所能接受的要“诡异”得多。自那以后，实验一次又一次地验证了量子力学，表明我们的世界违反了[贝尔不等式](@entry_id:156237)。

这意味着，如果存在[隐变量](@entry_id:150146)，它们必须是非定域的。Bob 的测量结果*必须*以某种方式，瞬时地、跨越遥远距离地，取决于 Alice 选择进行的测量。我们甚至可以构建玩具般的非定域模型，成功地重现量子预测。例如，一个巧妙设计的非定域模型可以精确地复制纠缠对的量子相关性 $E(\vec{a}, \vec{b}) = -\vec{a}\cdot\vec{b}$，这是定域模型被禁止做到的事情 [@problem_id:748986]。简单的、定域的确定性模型无法匹配量子预测的失败变成了一个可量化的误差 [@problem_id:2097033]，证明了量子现实的深层奇异性。

### 建模者的技艺：不可见世界的微妙之处

构建和使用内在变量模型既是一门艺术，也是一门科学，充满了微妙之处，迫使我们深入思考我们实际在建模的是什么。

例如，在我们对金属回形针的塑性模型中，我们使用了一个内部“时钟” $p$ 来追踪塑性应变的累积。但如果另一位科学家决定用不同的方式定义他们的时钟，比如 $\tilde{p} = 2p$ 呢？这仅仅是一种惯例的改变，就像用英尺而不是米来测量距离一样。为了让模型描述相同的物理现实，其参数必须相应地改变。事实证明，与变化*速率*相关的参数（如硬化率）在新的惯例下将具有不同的数值。然而，代表物理极限的量，如材料的最大饱和应力，是这些参数的比值，并保持不变 [@problem_id:2621872]。这给我们一个关键的教训：我们必须区分哪些特征是我们数学描述的人为产物，哪些代表了物理世界客观、可测量的属性。

此外，对于现代人工智能和统计学中的许多复杂系统，内在变量与模型的交织如此错综复杂，以至于精确计算其影响在计算上是不可能的。再考虑一下[基因表达模型](@entry_id:178501)。如果我们想计算观察到某种表达模式的概率 $p(\mathbf{y}|\mathbf{x})$，我们将不得不对隐藏通路 $\mathbf{z}$ 的所有可能配置进行积分——这是一项棘手的任务。在这里，一种来自[近似推断](@entry_id:746496)的强大技术应运而生。我们不试图处理真实、复杂的后验分布 $p(\mathbf{z}|\mathbf{x}, \mathbf{y})$，而是引入一个更简单、更易于处理的近似 $q(\mathbf{z}|\mathbf{x}, \mathbf{y})$。利用这个近似，我们可以为我们真正关心的量推导出一个严格的数学**下界**。通过最大化这个下界，我们可以有效地训练我们的模型并学习隐藏变量的属性 [@problem_id:3134182]。这是当今许多最先进的生成式 AI 模型背后的引擎。

最后，支配内在变量如何随时间或在外部影响下**演化**的规则，是模型动力学的核心。在[地质力学](@entry_id:175967)中，像[亚塑性](@entry_id:750491)这样的模型提出了一个单一、直接的规则，用于说明[应力张量](@entry_id:148973)如何根据当前应力、变形速率和内部状态变量（如孔隙比）发生变化 [@problem_id:3531255]。当这些模型在计算机模拟中实施时，用于将内在变量从一个时间步更新到下一个时间步的精确算法本身就成为模型的一部分，影响着系统预测的刚度和行为 [@problem_id:2547045]。

从金属的记忆到[纠缠粒子](@entry_id:153691)的非定域之舞，再到生命本身的隐藏模式，内在变量提供了一种统一而深刻的语言。它们让我们能够写下不可见世界的规则，将我们的科学好奇心转化为预测能力，并提醒我们，通常，最重要的事情是那些我们看不见的东西。

