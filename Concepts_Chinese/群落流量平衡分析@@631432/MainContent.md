## 引言
[微生物群落](@entry_id:167568)，例如人体肠道中数以万亿计的细菌，构成了极其复杂的代谢经济体。理解并预测它们的集体行为是一项巨大的挑战，因为实时追踪每一个分子间的相互作用在计算上是不可能的。本文介绍群落流量平衡分析（cFBA），这是一个强大的计算框架，通过对这些[微生物生态系统](@entry_id:169904)的主导规则和约束进行建模来弥补这一差距。cFBA 并不追踪动态过程，而是定义了所有可能的[稳态](@entry_id:182458)行为空间，并根据一个既定的生物学目标来预测最可能的结果。在接下来的章节中，我们将首先解构 cFBA 的核心原理和机制，从[质量平衡方程](@entry_id:178786)和[化学计量矩阵](@entry_id:275342)到[目标函数](@entry_id:267263)的关键作用。随后，我们将探讨其多样化的应用和跨学科联系，展示 cFBA 如何被用于工程化合成菌群、解码肠道微生物组，甚至应用博弈论原理来理解微生物的社会困境。

## 原理与机制

想象一个单一的细菌是一个繁忙的化工厂，一个由数千条相互连接的装配线组成的复杂网络。原材料——糖、氨基酸、脂肪——被运入、加工、转化，并用于制造新部件、产生能量和处理废物。现在，想象一个由这些工厂组成的整个城市，比如人类的肠道，里面有来自数百个不同物种的数万亿个细菌。它们共同生活，为一些资源竞争，共享另一些资源，创造了一个动态、互联的经济体。我们怎么可能期望理解，更不用说预测这样一个复杂系统的行为呢？

群落流量平衡分析（cFBA）是一个强大的框架，它让我们能够做到这一点。它不是要实时追踪每一个分子——这项任务在计算上是不可能的。相反，它是要理解主导这个代谢经济体的*规则*和*约束*。通过应用一些基本的物理原理，我们可以描绘出群落所有可能状态的全景图，然后，通过对其“目标”做出有根据的猜测，我们就能预测其最可能的行为。让我们从头开始构建这个概念。

### 生命的法则：质量平衡与[稳态](@entry_id:182458)

我们代谢工厂的第一个也是最不可动摇的法则是**[质量守恒](@entry_id:204015)**。你不能无中生有。对于细胞内的任何给定代谢物——比如说，[丙酮酸](@entry_id:146431)——其由某些反应产生的总速率必须等于其被其他反应消耗的总速率。如果生产超过消耗，细胞会充满丙酮酸而破裂；如果消耗超过生产，细胞会耗尽[丙酮酸](@entry_id:146431)，其装配线也会停顿。

为了使问题易于处理，我们引入了一个强大的简化假设：**准[稳态](@entry_id:182458)** [@problem_id:2538414] [@problem_id:2779562]。我们假设，在我们感兴趣的时间尺度上，这些内部代谢物的浓度是不变的。工厂运行平稳，没有瓶颈或短缺。这意味着对于每一个内部代谢物，方程都变得简单而优美：

$$ \text{总生产速率} - \text{总消耗速率} = 0 $$

这一个假设将一个极其复杂的动态变化问题转化为一个可解的线性方程组，一组定义了所有可能的、可持续的代谢状态领域的约束。

### 代谢的蓝图：[化学计量矩阵](@entry_id:275342)

我们如何一次性写下数千个反应的所有这些生产和消耗规则呢？我们需要一个总蓝图，一个整个细胞的会计总账。在 FBA 中，这个蓝图是一个称为**[化学计量矩阵](@entry_id:275342)**的矩阵，用符号 $S$ 表示。

可以这样想：矩阵中的每一行代表一个独特的代谢物（如葡萄糖-6-磷酸），每一列代表一个独特的[化学反应](@entry_id:146973)（如糖酵解的第一步）。矩阵中的数字，即**[化学计量系数](@entry_id:204082)**，告诉我们在一个给定反应中有多少单位的代谢物被生产或消耗。按照惯例，我们用负数表示反应物（被消耗），用正数表示产物（被生产）。

让我们用一个简单的代谢物转运例子来具体说明这一点，转运只是将物质从一个地方移动到另一个地方的一种特殊反应 [@problem_id:3296351]。想象一个代谢物 $M$ 从一个细菌的[胞质溶胶](@entry_id:175149)（我们称之为区室 `cyt`），穿过其周质（`per`），进入共享环境（`env`），最后进入邻近细菌的[胞质溶胶](@entry_id:175149)（`cyt_B`）。我们可以定义三个转运反应：
1. $T_1$：$M$ 从 `cyt` 移动到 `per`。
2. $T_2$：$M$ 从 `per` 移动到 `env`。
3. $T_3$：$M$ 从 `env` 移动到 `cyt_B`。

如果我们按 $(M_{\text{cyt}}, M_{\text{per}}, M_{\text{env}}, M_{\text{cyt_B}})$ 的顺序[排列](@entry_id:136432)代谢物行，那么我们的[化学计量矩阵](@entry_id:275342)中这三个转运反应的列将如下所示：

$$
T_1 = \begin{pmatrix} -1 \\ +1 \\ 0 \\ 0 \end{pmatrix}, \quad
T_2 = \begin{pmatrix} 0 \\ -1 \\ +1 \\ 0 \end{pmatrix}, \quad
T_3 = \begin{pmatrix} 0 \\ 0 \\ -1 \\ +1 \end{pmatrix}
$$

对于反应 $T_1$，一个单位的 $M$ 从胞质溶胶中被消耗（$-1$），一个单位在周质中被产生（$+1$）。其他区室不受影响（$0$）。现在，如果我们有一个向量 $\mathbf{v}$，它列出了所有反应的速率，或**通量**，我们对所有代谢物的[稳态假设](@entry_id:269399)可以用一个单一、优雅的方程来表示：

$$ S\mathbf{v} = \mathbf{0} $$

这个方程是流量平衡分析的核心。它表明，对于一个可行的、[稳态](@entry_id:182458)的代谢，通量向量 $\mathbf{v}$ 必须在化学计量矩阵 $S$ 的“零空间”中。它必须是能够完美平衡每个内部组分生产和消耗的[反应速率](@entry_id:139813)组合。

### 从个体到生态系统：构建群落模型

到目前为止，我们有了单个细胞的蓝图。我们如何为整个工厂城市——即[微生物群落](@entry_id:167568)——建模呢？关键在于将每个物种视为一个独立的实体，但通过一个共享的环境将它们联系起来。我们不仅仅是把它们所有的蓝图混在一起，形成一个“[超个体](@entry_id:145971)”，因为那样会破坏我们想要研究的相互作用 [@problem_id:2538414]。

相反，我们以一种非常特殊的方式构建一个单一的大型群落化学计量矩阵 $S^{\text{comm}}$ [@problem_id:3296354]。
首先，我们把每个物种的个体矩阵（$S^{(A)}, S^{(B)}, \dots$）沿着我们新的、更大的矩阵的对角线放置。这保留了每个物种独特的代谢特性。非对角线上的区块都用[零填充](@entry_id:637925)，这反映了物种 A 内部的反应不会直接消耗物种 B 内部的代谢物。

$$
S^{\text{comm}} =
\begin{bmatrix}
S^{(A)}  0  \cdots  0  0 \\
0  S^{(B)}  \cdots  0  0 \\
\vdots  \vdots  \ddots  \vdots  \vdots \\
\text{耦合行}  \dots  \dots  \dots  \dots
\end{bmatrix}
$$

神奇之处在于最后几行：**耦合约束** [@problem_id:2779562]。这些行代表共享的细胞外环境中的代谢物。在这里，我们强制执行一个新的[质量平衡](@entry_id:181721)规则：对于任何共享的代谢物，所有物种分泌的总量加上任何外部供应量，必须等于所有物种消耗的总量加上任何外部移除量。

在这里，我们区分了两种至关重要的交换类型 [@problem_id:3296373]。**群落交换反应**在细胞内部和共享环境之间移动代谢物。**边界交换反应**在共享环境和外部世界之间移动代谢物（例如，来自宿主饮食的营养物质进入肠腔）。共享环境中的质量平衡从机理上将所有物种的命运联系在一起。如果物种 A 分泌乳酸而物种 B 消耗它，正是这个共享池的质量平衡确保了乳酸被正确核算。

### 行为的规则：通量边界

我们的 $S\mathbf{v}=\mathbf{0}$ 方程定义了什么是*可能*的，但它没有说明反应的*方向*或*速度限制*。为了增加这一层真实性，我们对每个通量 $v_i$ 施加**边界**。

- **内部反应**：由于[热力学](@entry_id:141121)限制，许多代谢反应实际上是**不可逆的**。例如，葡萄糖的分解是一条单行道。对于这些反应，我们将其通量的下限设置为零（$0 \le v_i \le U$，其中 $U$ 是某个大数）。其他反应则是容易**可逆的**，在接近平衡的状态下运作，我们允许它们的通量为正或负（$-U \le v_i \le U$） [@problem_id:3296445]。

- **交换反应**：交换反应的边界代表了与世界的接口。细胞摄取一种营养物质（负通量）的最大速率受到该营养物质在环境中的可用性和细胞[转运蛋白](@entry_id:176617)能力的限制。环境中不存在的营养物质的摄取边界为零。分泌（正通量）通常只受细胞内部生产该物质的能力限制，因此其上界通常不设限 [@problem_id:3296445]。

这些边界，$l_i \le v_i \le u_i$，从 $S\mathbf{v}=\mathbf{0}$ 的无限[解空间](@entry_id:200470)中雕刻出一个有限的高维形状。这个形状被称为“可[行空间](@entry_id:148831)”，其中的每一个点都代表了群落的一个有效的、可持续的代谢状态。

### 定义目标：目标函数的力量

我们有了一个所有可能行为的空间。但是群落会选择哪一个呢？FBA 做了最后一个关键的假设：[生物系统](@entry_id:272986)已经进化到在*某个方面*达到最优。我们必须定义一个生物**[目标函数](@entry_id:267263)**——一个系统试图最大化或最小化的数学表达式。

最常见的目标是**最大化群落的总生长**，或生物量生产。这与达尔文主义的观念相符，即生命的目的就是创造更多的自己。但事实证明，这个目标的精确定义对预测群落行为有着深远的影响 [@problem_id:2496326]。

让我们考虑一个简单的群落。物种 A 可以吃葡萄糖并高效生长而不产生废物。或者，它可以生长得不那么高效，但分泌乙酸盐作为副产品。物种 B 不能吃葡萄糖，但它可以吃[乙酸](@entry_id:154041)盐并生长。现在，让我们看看当我们应用不同目标时会发生什么：

1. **目标：最大化物种 A 的生长。** 模型预测出一个自私的结果。物种 A 使用其最高效的途径，以最快速度生长，并产生零[乙酸](@entry_id:154041)盐。物种 B 饿死。没有群落。

2. **目标：最大化群落总生长（$v_{\text{biomass,A}} + v_{\text{biomass,B}}$）。** 令人惊讶的是，在许多情况下，结果是相同的！从可用的葡萄糖中制造总生物量的最有效方式仍然是物种 A 保持自私。 “公共利益”并不会自动导致合作。

3. **目标：最大化一个偏向物种 B 的加权总和（例如，$v_{\text{biomass,A}} + 2v_{\text{biomass,B}}$）。** 一切都变了。突然之间，最优策略是物种 A 切换到其“浪费”的代谢方式，牺牲自己的生长来产生大量的乙酸盐。这些[乙酸](@entry_id:154041)盐随后为物种 B 的快速生长提供了燃料。整个群落的生物量可能低于自私情况下的生物量，但这个新目标迫使一种合作的、交叉哺育的相互作用出现。

这是一个惊人的发现。[微生物群落](@entry_id:167568)的性质——自私竞争与复杂合作——可以由定义其“目标”的生态或进化压力来决定。其他目标也是可能的。例如，在一个稳定的、不生长的群落中，目标可能仅仅是**最大化 ATP 生产**以满足维持能量需求并生存 [@problem_id:3296415]。[目标函数](@entry_id:267263)不仅仅是一个数学细节；它是关于生态系统本质的一个假说。

### [涌现行为](@entry_id:138278)：竞争、合作与交叉哺育

在模型完全建立并选择了一个目标之后，我们可以解决这个[优化问题](@entry_id:266749)，并得到一个预测的通量[分布](@entry_id:182848)。通过检查交换通量，模型预测的相互作用便会涌现出来。

- **竞争**：如果两个物种对于同一种外部供应的营养物质（例如，葡萄糖）都有负通量，那么它们就在为该资源竞争 [@problem_id:3296371]。

- **[交叉](@entry_id:147634)哺育**：如果一种代谢物*没有*从外部供应，而物种 A 对它有正通量（分泌），物种 B 对它有负通量（摄取），我们就发现了一个涌现的交叉哺育联系。物种 A 的废物变成了物种 B 的珍宝 [@problem_id:3296371]。

这些都不是我们编入模型的行为。它们是从每个物种个体代谢、质量守恒定律和一个指导性目标原则的相互作用中涌现出来的结果。

### 超越基础：处理模糊性

有时，实现群落目标并非只有一种独特的“最佳”方式。可能存在一整套不同的通量[分布](@entry_id:182848)，它们都能导致完全相同的最大生长速率。这被称为**简并性**。我们如何从这组解中选择最符合生物学现实的解呢？

一个常见的策略是**通量正则化** [@problem_id:3296465]。我们添加一个次要目标：“找到所有实现最大生长的方法，并在其中选择最‘简约’或‘高效’的那一个。”例如，我们可能寻找使所有通量[绝对值](@entry_id:147688)之和（$\|v\|_1$）最小化的解。这倾向于找到使用最少可能活性反应的解，即一个“最稀疏”的代谢状态。或者，我们可以最小化通量的平方和（$\|v\|_2^2$），这倾向于找到将[代谢负荷](@entry_id:277023)更均匀地[分布](@entry_id:182848)在许多途径上的解。

这最后一层精妙之处表明，cFBA 不是一个神奇的黑匣子，而是一个不断发展的科学工具。它是一个强大的透镜，通过将基本原理与可检验的假说相结合，让我们能够窥探微生物群落隐藏的经济世界，并理解主宰它们生命的美丽而复杂的逻辑。

