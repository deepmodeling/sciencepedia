## 引言
从森林地表的斑块状[分布](@entry_id:182848)到城市各处的温度变化，空间模式是我们世界的一个基本特征。虽然我们凭直觉就能理解邻近位置往往比遥远位置更相似，但我们如何超越这一观察，去定量地描述、建模和预测这些关系呢？这就是地统计学的领域——一门分析[空间分布](@entry_id:188271)数据的科学。本文对这一强大的框架进行了全面介绍，旨在满足使用严谨方法来解释科学数据中固有的空间结构的需求。我们的探索始于第一章 **“原理与机制”**，该章节通过探讨半变异函数和[莫兰指数](@entry_id:192667)（[Moran's I](@entry_id:192667)）等工具来奠定理论基础，并最终引出[克里金法](@entry_id:751060)（kriging）的预测能力。随后，第二章 **“应用与跨学科联系”** 展示了地统计学非凡的通用性，说明了这些原理如何应用于解决现实世界的问题，并推动生态学、医学乃至探索[外星生命](@entry_id:172972)等不同领域的发现。

## 原理与机制

想象一下，你正穿行于一片森林。你注意到，在茂密的橡树林冠下，土壤湿润而肥沃；而仅在百米之外，一个阳光充足的南向山坡上，土壤却干燥多沙。又或者，想象一座在夏季热浪中的城市，市中心区域密布着沥青和混凝土，温度要比绿树成荫的郊区公园高出好几度。这个简单而深刻的观察——邻近的事物比遥远的事物更相似——是地统计学的灵魂。它如此基本，以至于拥有一个名字：托伯勒地理学第一定律（Tobler's First Law of Geography）。

但作为科学家，我们不满足于仅仅进行定性观察。我们想要测量。相似多少？这种相关性如何随着距离的增加而衰减？这种模式在所有方向上都相同吗？回答这些问题是地统计学的任务。它为我们提供了一种数学语言，用以描述、建模和预测空间模式。让我们踏上理解这门语言的旅程，从其最基本的词汇开始。

### 两种视角的故事：相似性与相异性

为了量化空间模式，我们可以从两个对立但又完美互补的视角来看待这个问题。我们可以衡量邻近事物的*相似*程度，也可以衡量它们的*相异*程度。地统计学为每种视角都提供了一个主要的工具。

#### 半变异函数：相异性的写照

让我们从相异性开始，因为它或许更直观。如果我们想知道在某个距离上事物的差异有多大，我们可以直接去测量。取相隔距离为 $h$ 的点对，计算它们数值（例如温度或[物种丰富度](@entry_id:165263)）的差异，将其平方以得到正值，然后对结果求平均。

这正是**半变异函数**（semivariogram）所做的事情。对于一个空间场 $Z(\mathbf{s})$，其中 $\mathbf{s}$ 是一个位置，半变异函数 $\gamma(h)$ 定义为在相距为 $h$ 的位置上，数值之差的平方的平均值的一半：

$$
\gamma(h) = \frac{1}{2} \mathbb{E}[(Z(\mathbf{s}) - Z(\mathbf{s}+h))^2]
$$

乘以 $\frac{1}{2}$ 这个因子是一个历史惯例，但其本质在于平[方差](@entry_id:200758)。当我们将 $\gamma(h)$ 对距离 $h$ 作图时，得到的图形就是空间结构的写照。一个典型的变异函数图能讲述一个丰富的故事 [@problem_id:2530863]：

*   **块金（Nugget）：** 如果我们测量彼此极为接近的点（当 $h$ 趋近于零时）的变异函数，我们可能期望其差异为零。但通常并非如此！变异函数在距离为零时趋近的值被称为**块金效应**（nugget effect）。这个微小的跳跃代表了测量误差，或是发生在小于我们分辨能力的微观尺度上的真实变异。它是我们数据中固有的“模糊性”[@problem_id:2752908, @problem_id:2527974]。

*   **基台（Sill）与变程（Range）：** 随着距离 $h$ 的增加，点之间的相关性减弱，其平[均差](@entry_id:138238)异增大。变异函数曲线随之上升。最终，我们会达到一个距离，在此距离上，点与点之间相距太远，实际上是相互独立的。此时变异函数曲线变平，形成一个称为**基台**（sill）的平台。基台值就是数据的总[方差](@entry_id:200758)。达到这个平台时的距离被称为**变程**（range）。变程告诉我们空间模式的“影响范围”或尺度。相隔距离小于变程的点是空间相关的；相隔距离大于变程的点则不相关。

事实上，变异函数与我们更熟悉的用于度量相似性的**协[方差](@entry_id:200758)**函数 $C(h)$ 直接相关。它们的关系非常简单：$\gamma(h) = C(0) - C(h)$，其中 $C(0)$ 是总[方差](@entry_id:200758)（即基台值）。看变异函数图就像看一个倒置的协[方差](@entry_id:200758)图[@problem_id:2530863]。一旦我们从数据中得到经验变异函数，我们就可以为其拟合一个数学模型，如[指数函数](@entry_id:161417)或球状函数模型，从而得到一个能在任何距离上描述空间结构的[连续函数](@entry_id:137361)[@problem_id:2530965]。

#### [莫兰指数](@entry_id:192667)（[Moran's I](@entry_id:192667)）：一种[空间相关性](@entry_id:203497)

现在，让我们转换到相似性的视角。如果我们想到衡量两个不同变量之间[线性关系](@entry_id:267880)的[皮尔逊相关系数](@entry_id:270276)（Pearson's correlation coefficient），我们可能会问：我们能否定义一个变量在空间中*与其自身*的相关性？答案是肯定的，而最常用的工具就是**[莫兰指数](@entry_id:192667) $I$**（Moran's $I$）。

[莫兰指数](@entry_id:192667) $I$ 类似于一个[相关系数](@entry_id:147037)。其计算公式为：

$$
I = \frac{n}{S_0} \frac{\sum_{i=1}^n \sum_{j=1}^n w_{ij}(z_i - \bar{z})(z_j - \bar{z})}{\sum_{i=1}^n (z_i - \bar{z})^2}
$$

这个公式看起来复杂，但其逻辑很简单。分母只是样本[方差](@entry_id:200758)，一个我们熟悉的用于归一化的项。神奇之处在于分子。我们观察点对 $(i, j)$ 及其数值 $z_i$ 和 $z_j$。我们看它们是都高于均值（$\bar{z}$）还是都低于均值。如果它们在均值的同一侧，乘积 $(z_i - \bar{z})(z_j - \bar{z})$ 为正。如果它们在均值的两侧，乘积为负。

但我们并非同等看待所有点对。我们只关心那些互为“邻居”的点对，并使用一个**空间权重矩阵** $W$ 来定义这种邻里关系，其元素为 $w_{ij}$。如果点 $i$ 和 $j$ 是邻居，则 $w_{ij}$ 非零（例如，$w_{ij}=1$）；否则，它为零。项 $S_0$ 就是所有这些权重的总和。

其解释变得清晰：
*   如果相邻的值趋于相似（高值邻近高值，低值邻近低值），那么求和中的大多[数乘](@entry_id:155971)积将为正，[莫兰指数](@entry_id:192667) $I$ 将为**正值**。这表示正[空间[自相](@entry_id:177050)关](@entry_id:138991)或[聚类](@entry_id:266727)。
*   如果相邻的值趋于相异（呈棋盘格模式），那么乘积将为负，[莫兰指数](@entry_id:192667) $I$ 将为**负值**。这表示负[空间自相关](@entry_id:177050)或离散。
*   如果数值是随机[排列](@entry_id:136432)的，那么正负乘积将相互抵消，[莫兰指数](@entry_id:192667) $I$ 将接近其在随机[分布](@entry_id:182848)下的[期望值](@entry_id:153208)，即一个很小的负数 $\frac{-1}{n-1}$ [@problem_id:2530863]。

这两种视角是统一的：一个具有正[空间自相关](@entry_id:177050)的过程，其变异函数会随距离增加而增大，同时其[莫兰指数](@entry_id:192667) $I$ 也为正值[@problem_id:2530863, @problem_id:2816057]。它们是同一枚精美的、具有空间结构硬币的两面。

### 地图的暴政：尺度、支持度与各向异性

当我们面对测量的现实时，我们简单的图景变得异常复杂。我们发现的模式并非绝对真理；它们是透过我们观察的镜头过滤后的结果。

首先，我们所说的“点”是什么意思？在[遥感](@entry_id:149993)或生态学中，一次测量很少是在一个无穷小的点上进行的。它是一个区域的平均值——图像中的一个像素，田野里的一块样方。这个区域被称为测量的**支持**（support）[@problem_id:2527974]。如果我们改变支持——例如，通过平均 $3 \times 3$ 的像素来创建一个更大的像素——我们就会改变统计数据！这是著名的**可变面元问题（MAUP）** 的一部分。聚[合数](@entry_id:263553)据会平滑掉小尺度的变异，这通常会降低总[方差](@entry_id:200758)（变异函数的基台值会下降），并可能使大尺度模式显得更强（[莫兰指数](@entry_id:192667) $I$ 和变异函数的变程通常会增加）[@problem_id:2527974]。你所看到的模式取决于你观察的尺度。

其次，我们一直假设只有距离是重要的。但如果方向也很重要呢？在[淋巴结](@entry_id:191498)中，免疫细胞可能沿着[排列](@entry_id:136432)整齐的基质[导管](@entry_id:274814)移动；在[地质学](@entry_id:142210)中，矿床可能沿着断层线[分布](@entry_id:182848)[@problem_id:2890062]。这就是**各向异性**（anisotropy）：空间相关结构依赖于方向。我们不能再用单一的变异函数 $\gamma(h)$ 来描述它，而是需要方向变异函数。我们可能会发现，沿山谷方向的相关范围是 $500$ 米，而横跨山谷方向仅为 $100$ 米。忽略各向异性就像戴上了一副模糊的眼镜：你将方向性细节平均掉了，最终得到一幅扭曲且不那么有用的现实图景。

### 从描述到预测：[克里金法](@entry_id:751060)的精髓

我们为什么花费如此大的精力仔细地为变异函数建模？最终的回报是**预测**。假设我们在几个位置有测量值，并希望估计一个未测量位置的数值。最简单的方法是取附近点的平均值。但是哪些点呢？我们应该如何加权它们？

**[克里金法](@entry_id:751060)**（Kriging）是地统计学给出的答案。它是一种复杂的加权平均方法，其中的权重由变异函数模型确定。它完美地将我们的直觉形式化[@problem_id:3599961]：
1.  离目标点越近的点权重越大。
2.  聚集在一起的点各自的权重会减小，因为它们提供了冗余信息。这被称为**[屏蔽效应](@entry_id:136974)**（screening effect）：紧邻我们目标点的一个点可以“屏蔽”掉其后方其他点的影响。
3.  权重的选择是为了产生最佳线性无偏预测，这意味着预测结果在平均意义上是正确的，并且具有最小的可能[预测误差](@entry_id:753692)。

此外，[克里金法](@entry_id:751060)不仅提供预测值，还提供预测的*[方差](@entry_id:200758)*。它告诉我们预测的可信度有多高。这一点非常强大，使我们不仅能创建预测值地图，还能创建不确定性地图。高级的克里金方法甚至可以处理物理约束，例如通过对数据进行对数等变换，来确保预测的土壤电导率值始终为正[@problem_id:3599961]。

### 野外地统计学：现代前沿

随着我们在从神经科学到天文学等领域生成海量的空间数据集，地统计学的原理比以往任何时候都更加重要。现代应用正在推动这些经典方法的边界。

在**[空间转录组学](@entry_id:270096)**（spatial transcriptomics）中，我们在组织切片的数千个位置上测量基因表达。这些位置通常是不规则[分布](@entry_id:182848)的，而非位于整齐的网格上。在这里，用于计算[莫兰指数](@entry_id:192667) $I$ 的“邻居”概念不能基于简单的网格邻接关系。相反，我们可以构建一个图，将每个点与其 $k$ 个最近邻（kNN）连接起来，并基于这个图来定义我们的权重。这引入了一个新的拓扑学尺度概念（$k$），它补充了变异函数的度量尺度（$h$）[@problem_id:2752908]。

此外，如果我们自己的坐标本身就有[测量误差](@entry_id:270998)怎么办？一位试图绘制基因表达图谱的生物学家可能在样本制备过程中面临组织变形的问题。测量的坐标并非真实坐标。严谨的地统计学通过**[变量含误差模型](@entry_id:186401)**（error-in-variables models）提供了一条解决途径，这些模型将坐标的[不确定性传播](@entry_id:146574)到我们的最终统计数据中，例如通过使用贝叶斯分层模型或[蒙特卡洛模拟](@entry_id:193493)[@problem_id:2753061]。

最后，地统计学帮助我们避免掉入统计陷阱。想象一下，发现一个物种的基因构成与某个环境变量（如温度）相关。这是一种因果联系吗？也许不是。两者可能只是简单地沿着南北梯度变化，从而产生了一种[伪相关](@entry_id:755254)。在进化生物学等领域检验“[距离隔离](@entry_id:147921)”时，这是一个巨大的问题[@problem_id:2727651]。像**莫兰[特征向量](@entry_id:151813)图（MEM）**这样的高级方法，允许我们将空间结构本身分解为一系列模式，将它们纳入回归模型，然后在*考虑*了潜在的空间混淆效应之后，再检验我们关心的环境变量的影响[@problem_id:2727643]。

从其简单的直觉开端，地统计学分支发展成为一个丰富、强大，有时甚至复杂的框架。它是一门与我们的地图对话的语言，用于理解支配我们周围世界的隐藏结构，从单个细胞的尺度到整个大陆的广袤。它证明了一个简单思想的力量：万物皆有联系，但邻近的事物比遥远的事物联系更紧密。

