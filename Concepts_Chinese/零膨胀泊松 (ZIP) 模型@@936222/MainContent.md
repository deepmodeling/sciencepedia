## 引言
在数据分析的世界里，对事件进行计数是一项基本任务，从顾客购买次数到疾病发病次数皆是如此。几十年来，泊松分布一直是模拟此类计数的经典工具。然而，真实世界的数据常常带来一个简单模型无法应对的挑战：过多的零值。当数据集中零计数的数量远超泊松模型的预测时，这表明背后有更复杂的潜在过程在起作用。这种差异凸显了一个关键的知识空白，即标准方法在此失效，并可能导致误导性结论。

本文将介绍零膨胀泊松 (ZIP) 模型，这是一个针对过量零值问题的优雅而强大的解决方案。通过假设零计数有两个不同的来源——一个是结构性的，另一个是偶然的——ZIP 模型为理解计数数据提供了一个更准确、更具解释性的框架。接下来的章节将引导您了解这一重要的统计学概念。首先，在“原理与机制”一章中，我们将解构该模型以理解其工作原理，探索其如[过度离散](@entry_id:263748)等数学特性，并将其与相关模型进行比较。随后，在“应用与跨学科联系”一章中，我们将涉足生态学、医学和病毒学等不同领域，见证 ZIP 模型如何提供更深刻的见解，并帮助科学家回答更细致入微的问题。

## 原理与机制

想象一下，你是一名城市规划师，任务是了解一个安静十字路口的[交通流](@entry_id:165354)量。你设置了一台摄像机，计算每分钟通过的汽车数量。有些分钟你看到一辆车，有些分钟两辆，偶尔五辆。很多分钟里，你一辆车也没看到。这就是计数的世界，长久以来，我们描述这类随机、[独立事件](@entry_id:275822)的首选工具一直是优雅的**泊松分布**。它告诉我们，在给定平均事件发生率的情况下，观察到任何特定数量事件的概率是多少。它能很好地处理零值；如果平均值较低，看到零事件不仅是可能的，而且是很有可能的。

但现在，让我们换个场景。我们不再是观察汽车，而是作为医学研究人员，追踪一群人在一年内因哮喘相关的急诊室就诊次数[@problem_id:4978301]。我们同样是在计数事件。我们发现研究中有非常多的人一次就诊都没有。这和汽车的情况一样吗？我们简单的泊松模型，根据平均就诊次数进行校准，可能预测大约 45% 的人应该有零次就诊。但当我们查看数据时，却发现高达 70% 的人一次就诊都没有[@problem_id:4852710]。模型与现实之间出现了严重分歧。数据在大声告诉我们：“零太多了”。正是这个难题，引导我们走向一个更优美、更精妙的概念：**零膨胀泊松 (ZIP) 模型**。

### 两种零值的故事：结构性与抽样性

ZIP 模型的精妙之处始于一个简单而深刻的问题：所有的零都是生而平等的吗？当我们在数据中看到一个“零”时，它总是意味着同样的事情吗？思考一下我们的哮喘研究。我们观察的人群可能包含不同个体的混合体。一些是确诊的哮喘患者，而另一些人，或许是因误纳或作为更广泛人口样本的一部分而被纳入，根本没有哮喘。

一个没有哮喘的人*不可能*有哮喘急性发作。对他们来说，与哮喘相关的急诊次数不是偶然为零，而是按定义就是零。这在生物学上是不可能的。我们称之为**结构性零值**[@problem_id:4978301] [@problem_id:4852710]。这些人甚至不“在游戏中”。

另一方面，考虑一个*患有*哮喘的人。他们肯定“在游戏中”，并且有急性发作的风险。然而，在一年中，他们可能很幸运。通过良好的管理、洁净的空气或仅仅是运气，他们可能没有经历任何需要急诊的严重发作。他们的计数也是零，但原因完全不同。这是一个**抽样零值**[@problem_id:4978301]。它源于事件过程本身的随机波动——这是标准泊松分布完全理解的那种零。

简单泊松模型的失败在于它无法区分这两个世界。它试图仅用一种机制——“抽样零值”机制——来解释所有的零，当存在大量的“结构性零值”时，它便不堪重负。[零膨胀泊松模型](@entry_id:166150)为描述这个更丰富的现实提供了语言。

### 构建 ZIP 机器：现实的混合

那么，我们如何构建一个能理解这种二元性的数学机器呢？ZIP 模型通过一种非常直观的装置——**混合模型**——来实现这一点。想象一下，为任何单个人生成一个计数的过程是一个两步游戏[@problem_id:4978296]。

首先，我们抛一枚特殊的、可能不均匀的硬币。假设这枚硬币正面朝上的概率是 $\pi$。

- **如果硬币正面朝上（概率为 $\pi$）：** 游戏结束。此人被确定为结构性零值。其最终计数是且必须是 $0$。模型的这一部分是一个**退化分布**——这是一个花哨的术语，用来描述只有一个可能的、预定结果的过程[@problem_id:4858773]。

- **如果硬币反面朝上（概率为 $1-\pi$）：** 游戏进入第二阶段。此人被确定为“风险人群”，我们现在从一个标准的泊松分布中抽取一个随机数，该分布的平均事件率为 $\lambda$。这个抽取的数可以是 $0, 1, 2,$ 或任何其他非负整数。

我们最终观察到的计数 $Y$ 就是这个两步过程的结果。这个优雅的构造使我们能够写下任何结果的概率。

对于一个正数计数，比如 $Y=y$ 且 $y > 0$，情况很简单。这个人*必须*在抛硬币时得到“反面”（才能进入风险组），然后从泊松过程中抽到数字 $y$。因此，概率是这两个事件的乘积：
$$
\mathbb{P}(Y=y) = (1-\pi) \cdot \frac{\exp(-\lambda)\lambda^{y}}{y!} \quad \text{for } y \in \{1, 2,  3, \dots\}
$$
这个方程告诉我们，正数计数的分布形状就是我们熟悉的泊松分布形状，但按比例缩小了，缩小的比例是首先进入风险组的概率。

但是观察到零的概率呢？在这里，通往零的两条路径结合了。一个人可能因为抛硬币得到“正面”（结构性零值）而得到零计数，或者因为得到“反面”然后从泊松分布中抽到零（抽样零值）而得到零计数。我们将这两个概率相加[@problem_id:4979374]：
$$
\mathbb{P}(Y=0) = \underbrace{\pi}_{\text{结构性零值}} + \underbrace{(1-\pi)\exp(-\lambda)}_{\text{抽样零值}}
$$
这个简单的方程是 ZIP 模型的核心。它明确承认了零的两个来源，赋予模型所需的灵活性，以匹配我们在现实中看到的“过量零值”。

### 机器揭示了什么：[过度离散](@entry_id:263748)与统计幻觉

我们模型中这个看似微小的改变——认识到两种类型的零——带来了深远的影响。我们首先注意到的事情之一是数据均值和方差之间关系的变化。在纯粹的泊松世界里，均值和方差是相同的。如果平均事件数是 $\mu$，方差也是 $\mu$。ZIP 模型打破了这条僵硬的规则。ZIP 分布的方差由以下公式给出[@problem_id:5197894]：
$$
\operatorname{Var}(Y) = \mu + \frac{\pi}{1-\pi}\mu^{2}
$$
其中 $\mu = (1-\pi)\lambda$ 是总体平均计数。由于 $\pi$ 是一个介于 0 和 1 之间的概率，第二项总是正的。这意味着 ZIP 过程的方差总是大于其均值。这种现象被称为**过度离散**，而一个不变的结构性零值群体与一个变化的风险群体的混合，是产生这种现象的自然方式。当发现你的数据方差远大于其均值时，这是一个强烈的暗示，表明简单的泊松模型不是正确的工具[@problem_id:4852710]。

更重要的是，弄清正确的机制可以完全改变我们的科学结论。让我们回到哮喘研究[@problem_id:4978301]。假设研究的“干预”组有 300 人，其中 180 人是非哮喘患者（结构性零值）。“对照”组也有 300 人，但只有 120 人是非哮喘患者。如果我们天真地只使用单一泊松模型，我们实际上是在对所有人平均计算急性发作次数。干预组，由于有大量*不可能*发生事件的人，其平均计数自然会低得多。计算显示，表观率比约为 $0.44$，这表明干预非常有效。

但这是一种统计幻觉，一种**混淆**形式。我们将治疗的效果与两组中风险人群数量的预先存在的差异混为一谈。ZIP 模型通过允许我们分别对“风险”群体建模，从而解决了这种混淆。它专注于我们真正关心的问题：对于那些*可能*发生急性发作的人，干预是否降低了他们的事件率？通过这样做，它揭示了真实的[风险率](@entry_id:266388)比约为 $0.67$。这仍然是一个有益的效果，但远不如天真的估计所显示的那么显著。忽略真实的数据生成机制可能导致我们自欺欺人。

### 替代故事：Hurdle 模型

要真正欣赏 ZIP 模型的故事，将其与一个有着不同叙述的近亲——**Hurdle 模型**——进行比较会很有帮助[@problem_id:4858773] [@problem_id:4826639]。Hurdle 模型也将过程分为两部分，但逻辑不同。

1.  **门槛：** 首先，有一个二元决策：事件是否会发生？是或否。一个人要么“跨过门槛”得到一个正数计数，要么未能跨过门槛，其计数为零。

2.  **计数：** *当且仅当*一个人跨过门槛后，我们才问“他们发生了多少次事件？”事件的数量然后从一个禁止为零的计数分布——一个**零截断**分布——中抽取。

注意关键区别：在 Hurdle 模型中，所有的零都来自单一来源——未能跨过门槛。计数生成过程本身不允许产生零。而在 ZIP 模型中，[计数过程](@entry_id:260664)（泊松部分）*可以*也*确实*会产生“抽样零值”，这些零值与“结构性零值”相加。这种微妙的区别意味着这些模型在问略有不同的科学问题，其参数（尤其是与协变量相关的参数）的解释也相应地发生变化[@problem_id:4826639]。

### 倾听数据：我们如何知道自己是对的

我们如何决定是否需要 ZIP 模型增加的复杂性？我们如何在它和像负[二项模型](@entry_id:275034)这样也能处理[过度离散](@entry_id:263748)的替代方案之间做出选择？统计学家已经开发出强大的工具来“倾听”数据告诉我们什么。

首先，我们可以寻找模型的“足迹”。如果一个简单的泊松模型是错误的，它会在其误差中留下线索。具体来说，它会系统性地低估零的数量。当我们查看**残差**——观测计数与模型预测之间的差异——我们会发现，对于模型无法解释的所有零计数观测值，都存在一大堆大的负残差[@problem_id:5197894]。

其次，我们可以进行一场正式的竞赛。一种有原则的方法是看另一个过度离散模型，如负[二项模型](@entry_id:275034)，是否能完全解释过量的零。我们可以拟合一个 NB 模型并计算它所隐含的零比例。如果该比例仍然低于我们在数据中实际观察到的比例，这就是一个强有力的证据，表明存在一个独立的、结构性的零生成机制，这有利于选择 ZIP 风格的模型[@problem_id:4852710]。最终，像**Vuong 检验**这样的正式[模型比较](@entry_id:266577)工具可以充当裁判，评判哪个模型更好地描述了数据[@problem_id:4978337]。

也许最美妙的是，这个模型被设计成能够自适应。ZIP 模型的参数 $\pi$ 和 $\lambda$ 通常使用**最大似然估计**法来找到。这个过程找到使观测数据最合理的参数值。在一个卓越的原理展示中，如果我们碰巧收集到一个*完全没有零*的数据集，零膨胀概率的[最大似然估计值](@entry_id:165819) $\hat{\pi}$ 将恰好为 $0$ [@problem_id:4922797]。数据告诉模型，没有证据表明存在一个独立的结构性零值类别，ZIP 模型便优雅地自我简化，变成一个标准的泊松模型。它不会在不需要的地方强加复杂性；当数据需要时，它会发现复杂性。这种丰富的理论结构与数据证据之间的相互作用，正是现代统计科学的核心所在。

