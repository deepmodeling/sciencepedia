## 应用与跨学科联系

我们花了一些时间来探索最小二乘法的内部机制，将其视为一种几何投影或代数解法。但一个工具的好坏取决于它能解决的问题。事实证明，这个想法——为一个没有精确解的系统寻找“最佳”近似解——是整个科学工具箱中功能最强大、最通用的工具之一。它不仅仅是一个数学上的奇珍；它是在面对不确定性和复杂性时进行推理的基本原则。让我们踏上一段旅程，看看这个听起来简单的想法将我们带向何方。你可能会对目的地感到惊讶。

### [曲线拟合](@entry_id:144139)的艺术：从直线到生命科学

也许[最小二乘法](@entry_id:137100)最经典的应用是你已经猜到的：在一堆散点数据中画出最佳的直线。但世界很少如此线性。如果我们试图建模的关系更为复杂怎么办？假设我们正在追踪一种新药在患者血液中的浓度随时间的变化。数据可能呈现出一条指数衰减的曲线。物理学家可能在追踪一个阻尼振荡。最小二乘框架的美妙之处在于它不局限于直线。我们可以拟合多项式、指数函数、正弦函数——几乎任何我们能写出的函数形式。

这个过程是实验科学的基础。你有一个理论模型，并且你想找到该模型的参数，使其最能匹配你来之不易的数据。有时，这很简单。如果我们的模型是[基函数](@entry_id:170178)的“线性”组合——就像 $p(x) = c_0 + c_1 x + c_2 x^2$ 是 $1, x, x^2$ 的[线性组合](@entry_id:154743)一样——那么无论最终的曲线多么曲折，问题都会归结为一个线性[最小二乘问题](@entry_id:164198)。

但生活常常给我们带来更具个性的数据。如果我们知道某次测量比其他测量可靠得多怎么办？也许它是由更高级的仪器或在理想条件下进行的。将所有数据点同等对待是愚蠢的。而我们不必这样做！我们可以引入*加权最小二乘*的概念，通过为可靠点的平方误差分配更大的权重，来告诉我们的算法“更关注”这些可信赖的点。这使我们能够将关于[数据质量](@entry_id:185007)的专业知识直接融入数学公式中，从而得到一个更稳健、更精确的[模型拟合](@entry_id:265652) [@problem_id:2194096]。

当模型在其参数上真正[非线性](@entry_id:637147)时，比如函数 $f(x; a, b, c) = a e^{bx} + c$，真正的乐趣才开始。在这里，参数 $a$ 和 $b$ 以一种无法简单线性化设置的方式纠缠在一起。你可能会认为我们需要一个全新的理论。但并非如此！在一个“利用已知知识”的漂亮展示中，我们可以迭代地解决这个问题。我们从一个参数的猜测值开始，然后做一个巧妙的操作：我们用一个在猜测值邻域内有效的*线性*模型来近似我们复杂的[非线性模型](@entry_id:276864)。这将问题简化为一个我们熟悉的线性最小二乘问题，我们求解它来找到对我们参数的一个微小*修正*。我们更新我们的猜测并重复这个过程，每一次都进行线性化和求解，一步步地逼近最佳拟合解。这种强大的技术，作为优化的基石之一，被称为[高斯-牛顿法](@entry_id:173233)，它让我们能够使用我们信赖的线性最小二乘工具来征服广阔的[非线性](@entry_id:637147)问题领域 [@problem_id:2214286] [@problem_id:3223323]。[药代动力学](@entry_id:136480)等领域正是使用这种方法来确定药物如何被身体吸收和排泄，通过将复杂的[指数衰减模型](@entry_id:634765)与浓度数据进行拟合，帮助设计有效的给药方案 [@problem_id:3223193]。

### 超越数据点：泛化、正则化与机器学习

到目前为止，我们一直专注于寻找一条描述现有数据的曲线。但是现代科学，尤其是在“大数据”和机器学习时代，通常更关心*预测*。我们想要一个模型，它不仅能拟合我们已经看到的数据，还能泛化到对我们*未曾*见过的数据做出准确预测。在这里，最小二乘的世界变得更加有趣，我们也开始看到它与计算机科学中一些最前沿思想的联系。

让我们考虑一个看似简单的任务：分类。我们有属于两个类别之一的数据点，比如说，“肿瘤是恶性的”（我们称之为1）或“良性的”（称之为0）。我们能用[最小二乘法](@entry_id:137100)来构建一个预测器吗？一种朴素的方法是对这些数据拟合一个[线性模型](@entry_id:178302)，希望输出对于恶性类别接近1，对于良性类别接近0。但这里有一个陷阱！最小二乘法并不知道我们的输出应该是概率。它是一个无约束的优化器，可以自由地做任何事情来最小化平方误差。结果，它可以愉快地预测一个1.5或-0.2的“概率”，这完全是无稽之谈 [@problem_id:3117134]。这个失败的例子极具启发性：它告诉我们为工作选择正确的工具至关重要。最小二乘的[平方误差损失](@entry_id:178358)不适合[二元结果](@entry_id:173636)的统计特性，这就是为什么像逻辑回归这样的方法被发明出来的原因。

然而，这并不意味着[最小二乘法](@entry_id:137100)出局了。我们可以强制它。我们可以解决一个*约束最小二乘*问题，告诉算法：“找到最佳拟合参数，但在严格的条件下，你对训练数据的所有预测必须位于0和1之间” [@problem_id:3117134] [@problem_id:2429996]。这将我们简单的问题转变为一个更复杂的[优化问题](@entry_id:266749)，称为二次规划，但它尊重了问题的物理现实。这种添加约束的思想是一个强大的主题，它将[最小二乘法](@entry_id:137100)的应用范围扩展到复杂的工程设计和控制领域。

现在来看一些真正现代的东西。流媒体服务如何推荐你可能喜欢的电影？其核心是一个巨大的、大部分为空的矩阵，记录了用户对电影的评分。挑战在于预测缺失的条目。这就是“[矩阵补全](@entry_id:172040)”问题。我们可以通过假设人们的品味不是随机的来解决这个问题；存在一些潜在的因素或“潜在特征”，比如对喜剧、动作片或特定导演的偏好。我们可以尝试将完整的[评分矩阵](@entry_id:172456) $R$ 建模为两个更薄的矩阵 $U$ 和 $V^T$ 的乘积，其中 $U$ 代表用户对这些潜在特征的亲和度，$V$ 代表电影对这些特征的表达。我们如何找到 $U$ 和 $V$？你猜对了：我们建立一个巨大的[最小二乘问题](@entry_id:164198)！我们寻找矩阵 $U$ 和 $V$，使其乘积 $U V^T$ 最佳匹配我们*确实*知道的评分。为了防止模型变得过于复杂而只是“记住”数据，我们添加一个惩罚项——一种 Tikhonov 正则化形式——它使 $U$ 和 $V$ 的条目不会变得太大。这种优雅的公式，最小化平方误差和正则化项的组合，是许多现代推荐系统的核心 [@problem_id:3283971]。

### 找到你的路：最小二乘在[导航与控制](@entry_id:752375)中的应用

让我们换个话题，看看最小二乘法最深刻、最美丽的应用之一：在世界上找到你的路。从你手机里的GPS到在火星表面导航的探测车，问题总是一样的：你有一个关于你如何移动的模型，但它是不完美的。你还有来自传感器的嘈杂测量数据——GPS卫星、星跟踪器、车轮里程计。你如何融合这两股信息流来获得对你真实状态（位置和速度）的最佳估计？

这是卡尔曼滤波器的领域，它是20世纪工程学的最高成就之一。其核心就是一个最小二乘问题。在每个时间点，滤波器对状态有一个*先验*信念，由一个均值和一个协方差矩阵（量化其不确定性）表示。然后，一个新的测量到达。卡尔曼更新步骤无非是解决一个加权最小二乘问题，以找到最能协调先验信念与新测量的状态。要拟合的“数据”是先验[状态和](@entry_id:193625)新测量。 “权重”是它们各自不确定性（协[方差](@entry_id:200758)）的逆 [@problem_id:2912338]。你更确定的信息获得更高的权重。这个小[优化问题](@entry_id:266749)的解为你提供了新的、更新的[状态估计](@entry_id:169668)，这在模型假设下被证明是最佳的估计。这是一个惊人的认识：跟踪和导航的动态、递归过程可以被看作是一系列静态、最优的“最佳妥协”解。这种深刻的联系揭示了[最小二乘原理](@entry_id:164326)不仅是一个曲线拟合器，更是一个用于最优信息融合的基本规则。

这个观点植根于最小二乘的几何学。当我们解 $A\mathbf{x}=\mathbf{b}$ 时，我们将向量 $\mathbf{b}$ 投影到 $A$ 的列空间上。解 $A\hat{\mathbf{x}}$ 是模型空间中离我们数据最近的点。剩下的部分，即残差 $\mathbf{r} = \mathbf{b} - A\hat{\mathbf{x}}$，与该空间正交。这是数据中我们的模型根本无法解释的部分 [@problem_id:1057812]。[卡尔曼滤波器](@entry_id:145240)在某种意义上是在一个统计空间中做同样的事情，找到一个最小化不确定性的投影。

### 一种通用语言

最后，最小二乘的语言甚至不局限于实数。在信号处理和量子力学等领域，我们处理复数。[交流电路](@entry_id:203112)用复数[相量分析](@entry_id:261427)，[量子态](@entry_id:146142)用复数[波函数](@entry_id:147440)描述。[最小二乘原理](@entry_id:164326)无缝地扩展到这个世界，只需将[转置](@entry_id:142115)替换为[共轭转置](@entry_id:147909)即可。这使我们能够使用相同的概念框架解决这些领域中的估计问题 [@problem_id:962339]，再次证明了其核心思想的深刻普适性。

从将一条简单的线拟合到数据，到推荐电影，再到导航航天器，[最小二乘原理](@entry_id:164326)是一条贯穿科学和工程的金线。它远不止是一种[数值算法](@entry_id:752770)；它是一种处理我们所居住的这个混乱、超定和充满噪声的现实的哲学。它为我们提供了一种清晰而强大的方法，从噪声中提取有意义的信号，从有限的数据中做出最佳的推断，并构建有效的模型。它是一个简单而优美的数学思想能够理解复杂世界的有力证明。