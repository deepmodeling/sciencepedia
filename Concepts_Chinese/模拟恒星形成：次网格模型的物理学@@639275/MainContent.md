## 引言
在计算机中模拟整个星系的演化是现代天体物理学的宏大挑战之一。这需要捕捉一系列惊人的宇宙现象，从[星系盘](@entry_id:158624)的优雅旋转到超新星的剧烈爆炸。然而，其中一个最基本的过程——恒星的诞生——却构成了一个巨大的障碍。恒星诞生于致密、紧凑的气体茧中，其尺寸远小于即使最强大的超级计算机在跨越整个星系的模拟中所能解析的尺度。这个巨大的尺度问题意味着我们无法直接模拟气体坍缩成恒星的过程。那么，我们如何在虚拟宇宙中创造恒星呢？

本文通过探索[次网格模型](@entry_id:755601)的世界来填补这一关键的知识空白。[次网格模型](@entry_id:755601)是一套巧妙的物理配方和数值技术，它允许模拟在不“亲眼看见”恒星形成过程本身的情况下形成恒星。接下来的章节将首先剖析这些模型背后的“原理与机制”，从[引力坍缩](@entry_id:161275)的基本物理学到宇宙[湍流](@entry_id:151300)的统计性质。随后，我们将探讨“应用与跨学科联系”，展示这些模型如何与真实观测进行验证，并被用于探索从元素起源到星系与[超大质量黑洞](@entry_id:157796)[共同演化](@entry_id:151915)等各种问题。

## 原理与机制

想象一下，你被赋予为整个地球制作完美[天气预报](@entry_id:270166)的任务。你有一台超级计算机，但有一个难题：你的计算机只能以100公里宽的区块来观察世界。你可以测量每个区块内的平均温度、压力和风速，但你无法看到其中正在酝酿的单个雷暴、龙卷风或微风。你该如何预测哪里会下雨？你无法模拟单个雨滴的形成，但你知道雨来自云，而云是在空气潮湿且上升时形成的。所以，你可能会设计一条规则：“如果一个100公里的区块平均湿度超过90%，并且显示出向上的空气运动，我将预测该区块会有一定量的降雨。”

这正是我们在星系中模拟恒星诞生时所处的困境。星系的跨度达数十万光年，而恒星诞生于尺寸小于一光年的致密尘埃茧中。我们的计算机模拟，即便是最强大的模拟，也必须将星系划分为网格单元或解析单元，这些单元的跨度通常有几十甚至上百光年。我们面临着一个巨大的尺度问题。

### 宇宙尺度的失配：[金斯长度](@entry_id:157888)与解析度极限

要使一团气体云坍缩并形成恒星，其自身的[引力](@entry_id:175476)必须克服其[内压](@entry_id:153696)力。可以将其想象成一场拔河比赛。来自气体粒子随机运动的压力试图使云团膨胀，而[引力](@entry_id:175476)则试图将其全部拉到一起。对于给定的密度 $\rho$ 和温度 $T$（它决定了压力），存在一个临界尺寸，一个长度尺度，超过这个尺度，[引力](@entry_id:175476)就必胜无疑。这被称为**[金斯长度](@entry_id:157888)**（Jeans length），记为 $\lambda_J$。任何大于其[金斯长度](@entry_id:157888)的气体团都注定要坍缩。

让我们看一个模拟星系中的典型场景。我们可能有一个致密、正在形成恒星的气体区域，其特性如氢[原子数](@entry_id:746561)密度为 $n_{\mathrm{H}} = 100 \, \mathrm{cm}^{-3}$，温度为 $T = 100 \, \mathrm{K}$。如果我们进行计算，会发现这里的[金斯长度](@entry_id:157888)约为 $\lambda_J \approx 9 \, \mathrm{pc}$（秒差距）[@problem_id:3491943]。现在，考虑一个顶尖的[宇宙学模拟](@entry_id:747928)。单个解析单元的尺寸，我们称之为 $\Delta x$，可能在 $\Delta x = 50 \, \mathrm{pc}$ 左右。

根本问题就在这里：恒星开始形成的尺度（$\lambda_J \approx 9 \, \mathrm{pc}$）远远小于我们的模拟所能“看到”的最小尺度（$\Delta x = 50 \, \mathrm{pc}$）。引力坍缩的过程发生在单个网格单元内远未被解析的深处。实际上，数值天体物理学家有一条经验法則，称为 **Truelove 判据**：为了正确捕捉[引力坍缩](@entry_id:161275)而避免数值错误导致气体人为碎裂，[金斯长度](@entry_id:157888)必须被至少四个网格单元解析，即我们需要 $\Delta x \le \lambda_J/4$ [@problem_id:3537920]。我们的例子严重违反了这一条件。模拟本身永远无法正确地形成恒星；其数值特性会人为地抑制我们想要研究的坍缩过程。

由于我们无法直接解析这个过程，我们必须将其[参数化](@entry_id:272587)。我们必须创建一个“配方”，将我们*能够*看到的50秒差距盒子中的大尺度、平均属性与我们*无法*看到的小尺度恒星形成联系起来。这就是**[次网格模型](@entry_id:755601)**的世界。

### 配方的艺术：坍缩、效率与观测

如果我们看不到坍缩，次好的办法是什么？我们可以计算它*应该*花多长时间。对于一个密度为 $\rho$、仅靠自身[引力](@entry_id:175476)维持的简单气体球，我们可以使用基本的牛顿力学来计算它坍缩成一个点所需的时间。这就是**自由落体时间**，$t_{\mathrm{ff}}$。事实证明，这个时间仅取决于密度：$t_{\mathrm{ff}} \propto 1/\sqrt{G\rho}$，其中 $G$ 是引力常数 [@problem_id:3491902]。这非常直观：气体越稠密，[引力](@entry_id:175476)越强，坍缩得越快。

因此，对恒星形成配方的第一个猜想可能是：[恒星形成](@entry_id:159940)速率 $\dot{\rho}_\star$ 应与可用的气体量 $\rho$ 成正比，并除以形成它们所需的时间 $t_{\mathrm{ff}}$。但我们知道，恒星形成是一个效率极低的过程。在真实的[分子云](@entry_id:160702)中，只有一个自由落体时间内极小部分的气体能转变为恒星。大部分气体被最先形成的恒星的反馈吹走了。为了解释这一点，我们引入一个关键的“修正因子”——或者更客气地说，一个包含了所有复杂的、未解析的物理过程的参数——称为**每自由落体时间的效率**，$\epsilon_{\mathrm{ff}}$。我们的基本次网格定律变成：

$$ \dot{\rho}_\star = \epsilon_{\mathrm{ff}} \frac{\rho}{t_{\mathrm{ff}}} $$

这个简单的方程异常强大。由于 $t_{\mathrm{ff}} \propto \rho^{-1/2}$，我们可以将其代入，发现我们的模型预测 $\dot{\rho}_\star \propto \rho^{3/2}$ [@problem_id:3491902]。一个局域的三维物理模型对恒星形成速率应如何随气体密度变化做出了具体的预测。

当我们将此与观测联系起来时，奇迹就发生了。天文学家无法轻易测量遥远星系中气体的三维体密度。他们能测量的是二维投影的[表面密度](@entry_id:161889)。几十年来，他们已经知道一个经验关系，称为 **Schmidt-Kennicutt 定律**，该定律指出恒星形成的[表面密度](@entry_id:161889) $\Sigma_{\mathrm{SFR}}$ 与气体[表面密度](@entry_id:161889) $\Sigma_{\mathrm{gas}}$ 通过一个[幂律](@entry_id:143404)关系相关：$\Sigma_{\mathrm{SFR}} \propto \Sigma_{\mathrm{gas}}^N$。我们简单的三维模型，当投影到二维时，可以与这个观测相匹配 [@problem_id:3491942]。观测到的指数 $N$（通常约为1.4）的确切值甚至可以告诉我们关于星系气体盘未被观测到的垂直结构的信息。这是一个美丽的例子，说明一个简单的物理思想如何能弥合微观理论与宏观观测之间的鸿沟。

### 有规则的配方：寻找形成恒星的气体

我们的配方是一个好的开始，但有点天真。它假设模拟单元中的任何气体都可以形成恒星。我们可以通过添加一组气[体元](@entry_id:267802)素在被允许参与恒星形成之前必须满足的标准来做得更好。这就像为我们的降雨预测添加限定条款：空气不仅要潮湿，还要低于一定温度且没有风切变。

-   **密度阈值**：最明显的规则是[恒星形成](@entry_id:159940)于致密气体中。因此，我们可以简单地禁止在密度 $\rho$ 低于某个阈值 $n_{th}$ 的任何单元中形成恒星 [@problem_id:3505148]。这是一种粗糙但有效的方法，确保恒星只在宇宙密度场的峰值处形成。

-   **分子判据**：一个更具物理动机的判据是寻找恒星形成区域的化学特征。恒星诞生于星际介质中最冷、最暗、尘埃最多的部分。这些正是允许氢原子在尘埃颗粒表面相遇并形成**分子氢**（$\mathrm{H}_2$）的条件。在更温暖、屏蔽较少的区域，来自现有恒星的强烈紫外[线辐射](@entry_id:751334)会将这些分子分解。两者之间达到一种平衡，气体中呈分子形态的比例 $f_{\mathrm{H}_2}$ 成为恒星诞生适宜条件的绝佳示踪剂 [@problem_id:3491933]。将[恒星形成](@entry_id:159940)与 $\mathrm{H}_2$ 的存在联系起来，自然而然地引入了对气体化学成熟度（其**金属丰度**，决定了尘埃含量）及其辐射环境的依赖。

-   **稳定性测试**：仅仅因为一团云致密且富含分子，并不能保证它会坍缩。它可能被内部[湍流](@entry_id:151300)吹散或被快速旋转所支撑。我们需要检查[引力](@entry_id:175476)是否真的在赢得这场战争。
    -   在单个云团的尺度上，我们可以使用**维里参数** $\alpha$。这个无量纲数本质上是云团的破坏性动能（来自[湍流](@entry_id:151300)）与其束缚引力势能之比 [@problem_id:3505148]。$\alpha > 2$ 的云团是“超维里”的或非束缚的；其内部运动过于剧烈，它会飞散而不是坍缩。我们的配方应该只适用于 $\alpha  2$ 的束缚气体。
    -   在旋转星系盘的宏大尺度上，稳定性由 **Toomre Q 参数**决定。该参数权衡了[气体压力](@entry_id:140697)和星系旋转的稳定效应与[自引力](@entry_id:271015)的不稳定拉力 [@problem_id:3505148]。$Q > 1$ 的盘是稳定的，就像一个旋转良好并保持形状的披萨面团。如果 $Q  1$，盘是不稳定的，并将碎裂成巨大的团块，这些团块随后成为星团的诞生地。

通过结合这些判据，我们简单的配方演变成一个复杂的决策树，更忠实地模仿了其中复杂的物理过程。

### 单元内的风暴：[湍流统计](@entry_id:200093)的宇宙

在这里，我们进行最深入的探讨。到目前为止，我们谈论的都是模拟单元中的“平均”密度 $\rho$。但我们知道这是不真实的。一个真实的星际气体包裹是超音速[湍流](@entry_id:151300)的漩涡。它不是一种平滑的流体，而是一片由冲击波和[稀疏波](@entry_id:168428)构成的混乱泡沫。我们单个模拟单元内的密度不是一个单一的数字；它横跨许多[数量级](@entry_id:264888)。

我们如何处理这个问题？我们采用统计学方法。理论和高分辨率实验告诉我们，超音速、等温[湍流](@entry_id:151300)中的密度[概率分布](@entry_id:146404)呈现出一种特定的、普适的形状：**[对数正态分布](@entry_id:261888)** [@problem_id:3491830]。其原因有点像中心极限定理，但适用于乘法：一个气体包裹的密度是经过许多连续的、由过往[冲击波](@entry_id:199561)引起的随机压缩和膨胀的结果。将许多随机数相乘，其结果会产生一个对数正態[分布](@entry_id:182848)。

这个密度[分布](@entry_id:182848)的宽度——即涨落的极端程度——由两个数决定：[湍流](@entry_id:151300)**[马赫数](@entry_id:274014)** $\mathcal{M}$（[湍流](@entry_id:151300)速度相对于声速的速度）和一个**强迫参数** $b$，该参数描述了[湍流](@entry_id:151300)是由旋转的、涡旋状的运动（无散强迫）驱动，还是由撞击的、冲击波状的运动（压缩强迫）驱动 [@problem_id:3491830]。[湍流](@entry_id:151300)越剧烈（$\mathcal{M}$ 越高）或强迫越具压缩性（$b$ 越高），密度[分布](@entry_id:182848)就越宽。这意味着更多的气体被推入极低密度的空洞和极高密度的峰值。

这种统计图景提供了一种深刻的统一。我们作为简单“修正因子”引入的[恒星形成](@entry_id:159940)效率 $\epsilon_{\mathrm{ff}}$，现在可以*从第一性原理推导出来*。如果我们假设只有密度高于某个临界密度 $\rho_c$ 的气体才能坍缩并形成恒星，那么 $\epsilon_{\mathrm{ff}}$ 就简单的是我们对数正态概率密度函数中质量超过此阈值的部分随时间的积分 [@problem_id:3491984]。当我们使用[湍流](@entry_id:151300)云的典型参数进行这个计算时，我们发现任何时候只有极小部分的质量足够致密以发生坍缩。这自然而又漂亮地解释了为什么[恒星形成](@entry_id:159940)效率如此之低，以及为什么经验上要求的 $\epsilon_{\mathrm{ff}}$ 值如此之小——通常在 $0.01$ 左右。恒星形成的神秘低效率是超音速[湍流统计](@entry_id:200093)性质的直接结果。

### 从数字气体到数字恒星

我们有了规则和理论。这如何转化为代码？当一个气体单元满足我们所有的[恒星形成](@entry_id:159940)标准时，我们面临最后一个问题：密度应该会失控地趋向无穷大，这将导致模拟崩溃。为了处理这个问题，我们引入了一种名为**汇流粒子**（sink particle）的数值工具 [@problem_id:3491775]。我们从[流体动力学模拟](@entry_id:142279)中移除正在坍縮的气体，并用一个特殊的点质量粒子取而代之。这个汇流粒子继承了它所取代的气体的质量、动量和位置。它继续与其他一切发生[引力](@entry_id:175476)相互作用，并且至关重要的是，它可以继续从周围吸积更多气体，从而使其得以成长。

吸积的规则与形成的规则同样微妙和重要。我们不能只是让汇流粒子吞噬任何靠近的气体。我们必须检查气体是否真的被[引力](@entry_id:175476)束缚于汇流粒子，并且关键是，它是否不是**旋转支撑**的 [@problem_id:3491775]。角动量过大的气体无法直接落到中心物体上；它会陷入[轨道](@entry_id:137151)，形成一个[吸积盘](@entry_id:159973)。忽略这一点将导致[恒星质量](@entry_id:157648)被大大高估，并会抹去宇宙中普遍存在的行星系统和[双星](@entry_id:176254)伴侣的形成。

这些汇流粒子不仅仅是无底洞；它们是恒星和星团的种子。因此，它们也必须是源头。它们必须将能量、动量和[重元素](@entry_id:272514)注入回周围的气体中，模拟[超新星](@entry_id:161773)和[恒星风](@entry_id:161386)的影响。这种**[恒星反馈](@entry_id:755431)**是故事的另一半，它调节着星系的气体供应，并塑造其数十亿年的演化。

整个[次网格物理](@entry_id:755602)学的大厦是一个由相互关联的思想构成的宏伟建筑。它是一个模型，和任何模型一样，它必须经过检验。我们通过进行解析度研究来做到这一点。理想情况下，我们希望我们的结果——比如星系中恒星的总质量——在我们提高模拟解析度的同时保持不变，而我们的次网格参数保持固定。这被称为**强数值收敛**。更常见的情况是，我们发现在每个解析度下都需要稍微调整我们的配方以保持与观测的匹配，这个过程被称为**弱数值收敛** [@problem_id:3475512]。对强收敛的追求不断提醒我们，我们正在进行的是一种近似行为，不断努力使我们的模型更忠实、更稳健、更能预测地反映宇宙的壮丽复杂性。

