## 应用与跨学科联系

所以，我们有了这个奇妙的机器，这个[哈密顿蒙特卡洛](@article_id:304638)。我们已经摆弄过它的引擎，看到了[哈密顿动力学](@article_id:316680)的齿轮如何与 Metropolis-Hastings 校正相结合，从几乎任何我们可以写出的[概率分布](@article_id:306824)中生成样本。我们已经看到它如何巧妙地将一个大到不可能的求和变成一个可处理的粒子在景观上滚动的[物理模拟](@article_id:304746)。它是一个美丽的理论小工具。但陈列在展示柜里的美丽小工具是一种悲剧。真正的乐趣来自于使用它！它*是用来做什么的*？我们能用它*做什么*？

答案原来是，几乎一切。

HMC 的魔力在于，我们虚构的粒子所探索的“势能”景观不必对应于物理势能。它可以是我们能想象的任何世界模型的*合理性*景观。这一概念上的飞跃将 HMC 从物理学家的专业工具转变为在不确定性下进行推理的通用引擎，其应用范围从宇宙最深的奥秘延伸到人工智能的复杂运作。让我们在这些世界中进行一次旅行。

### 回归源头：模拟量子宇宙

我们从 HMC 本身的起源地开始是再合适不过的了：在那个奇异而美妙的量子场论世界。研究[强核力](@article_id:319602)的物理学家，即那种将夸克结合成质子和中子的力，面临着巨大的挑战。这个被称为量子色动力学（QCD）的理论极其复杂，以至于无法进行精确计算。获得答案的唯一方法是在计算机上进行模拟。

但是你如何模拟一个量子场？它是一个概率性的实体，是所有可能构型的叠加，时时刻刻都在剧烈波动。要计算一个属性，比如质子的质量，原则上必须对这个无限的可能性海洋进行平均。这正是 HMC 为解决这类[高维积分](@article_id:303990)而生的。物理学家将[时空](@article_id:370647)离散化为一个四维网格，或称“格点”，量子场在每个点上的值都成为一个变量。理论的“作用量”——一个与给定场构型能量相关的量——定义了势能景观。然后 HMC“感知”这个景观，抽取量子真空的[代表性样本](@article_id:380396)。这正是计算物理学问题中为测试和改进数值方法而处理的简化版宏大理论所提出的挑战，例如 U(1) [格点规范理论](@article_id:299776) [@problem_id:2399512]。HMC 不仅仅是一个聪明的想法；它是为了从我们最基本的自然理论中做出具体预测而必需的发明。

### 通用推理引擎：从星光到[半导体](@article_id:301977)

一旦我们认识到“势能”$U(\boldsymbol{\theta})$ 可以简单地是一组参数 $\boldsymbol{\theta}$ 的[概率分布](@article_id:306824)的负对数，[闸门](@article_id:331694)就打开了。HMC 成为了贝叶斯推断的引擎。贝叶斯推断是根据新证据更新我们信念的艺术。我们从对参数的某种[先验信念](@article_id:328272)开始，将其与数据 confrontation，然后得出一个“后验”信念——一个完整的[概率分布](@article_id:306824)，它不仅告诉我们每个参数的单一*最佳*值，还告诉我们整个合理值的范围及其相对可能性。这个[后验分布](@article_id:306029)*就是*那个景观。

想象你是一名[材料科学](@article_id:312640)家，试图确定一个掺杂原子在[半导体](@article_id:301977)晶体中扩散的速度。你无法直接看到这个原子。相反，你植入一组原子，并在一段时间后测量它们的最终浓度分布。这个最终分布就是你的数据。你的模型是[扩散方程](@article_id:349894)，其关键参数是扩散系数 $D$。使用 HMC，你可以探索 $D$ 的后验分布。该[算法](@article_id:331821)会找到所有[扩散系数](@article_id:307130)的值，当这些值代入[扩散方程](@article_id:349894)时，能产生与你的带噪声测量结果一致的最终状态。这就像一个侦探，不仅找到了最可能的嫌疑人，而且提供了一排所有可能的嫌疑人，每个都附有概率 [@problem_id:2399580]。

同样的原理适用于所有科学领域。在[纳米科学](@article_id:361679)中，人们可能会测量将原子力显微镜探针从表面上拉开所需的微小“拉脱”力。这个力取决于加载速率和材料间的基本粘附能。给定带噪声的力测量值，HMC 可以绘制出未知粘附能的整个后验景观，不仅给我们一个估计值，而且是对我们不确定性的严格量化 [@problem_id:2777678]。

这种联系可以变得更加深刻。在天体物理学中，当分析来自食[双星系统](@article_id:321847)的光变曲线时，模型参数（如食深或食时）的景观具有自然的几何结构。这种几何结构由一个称为 Fisher 信息矩阵的数学对象描述，它本质上告诉我们，根据它们会产生的数据，两组略有不同的参数是多么容易区分。在一个惊人而美丽的思想综合中，我们可以使用这个[信息几何](@article_id:301625)来定义我们 HMC 模拟的“[质量矩阵](@article_id:356046)”。这就创造了一种变体，即黎曼流形 HMC，其中粒子的惯性根据概率空间的局部曲率进行定制，使其能够以极高的效率在景观中导航 [@problem_id:188408]。在这里，力学、统计学和信息论的原理完美和谐地共舞。

### 驾驭复杂性：层次结构、气候和人工智能

当我们面对巨大复杂性和高维问题时，HMC 的真正威力变得无可否认。许多科学问题具有层次结构。想象一下分析来自许多不同医院的临床试验数据。每家医院的患者群体略有不同，导致医院特定的治疗效果（$\theta_i$），但这些效果本身又来自于一个总体的群体分布。这就创建了一个“[分层模型](@article_id:338645)”。在这类模型中，参数通常是[强相关](@article_id:303632)的；总体平均值紧贴着各个医院的平均值，反之亦然。

对于像[吉布斯采样](@article_id:299600)这样的简单 MCMC 方法来说，这种[强相关](@article_id:303632)性是一场噩梦。[吉布斯采样器](@article_id:329375)一次更新一个参数，沿着坐标轴移动。在一个具有长、窄、弯曲山谷（一个“漏斗”）的空间中，它只能采取微小的步骤，导致探索速度慢得令人痛苦。HMC 凭借其动量概念则不同。它不只是走；它滑行。它的轨迹可以沿着山谷的曲线行进，一次跳跃就能跨越景观的巨大距离，抑制了使其他方法瘫痪的[随机游走](@article_id:303058)行为 [@problem_id:2448380]。

这种驾驭高维、相关景观的能力在气候科学等领域至关重要。即使是一个简单的全球温度模型也可能涉及一个基线水平（$\alpha$）、一个线性趋势（$\beta$）和[振荡](@article_id:331484)分量（$\gamma$）。这些参数不是独立的。HMC 允许气候学家将此类模型拟合到历史数据，为每个参数的不确定性提供完整的刻画。它还允许进行复杂的调优，例如使用一个“质量矩阵”为不同参数分配不同的惯性，帮助模拟以同等的便利性探索参数空间的所有方向 [@problem_id:2399589] [@problem_id:2628062]。结果不仅仅是对未来的单一预测，而是一个带有[可信区间](@article_id:355408)的概率性预报——一个关于我们知道什么和我们不知道什么的诚实陈述。

也许 HMC 最令人兴奋的前沿领域是在机器学习和人工智能中。通常，训练一个[神经网络](@article_id:305336)是一个优化问题：我们使用像梯度下降这样的[算法](@article_id:331821)，在巨大的网络权重空间（$\mathbf{w}$）中找到一个最小化[损失函数](@article_id:638865)的点。这给了我们一个模型，它可以进行预测，但对其自身的[置信度](@article_id:361655)没有内在的感觉。

贝叶斯的视角是完全不同的。与其找到单一的最佳权重集，为什么不从所有可能的权重分布中采样呢？这正是[贝叶斯深度学习](@article_id:638257)的目标。而完成这项工作的工具是什么？HMC。势能景观 $U(\mathbf{w})$ 就是我们从标准机器学习中熟悉的损失函数。而驱动我们哈密顿粒子的“力”是什么？它不是别的，正是该[损失函数](@article_id:638865)的负梯度——也就是[反向传播算法](@article_id:377031)高效计算的那个梯度 [@problem_id:2373909]。由[反向传播](@article_id:302452)驱动的 HMC，可以探索所有优秀[神经网络](@article_id:305336)的宇宙，对它们的预测进行平均，并在此过程中，为人工智能的输出提供一个数学上严谨的[不确定性度量](@article_id:334303)。这是构建更稳健、更可靠、更值得信赖的人工智能的关键一步。

### 一个统一的原则

从夸克和胶子的舞蹈到星光的分析，从新材料的属性到数字思维的运作，[哈密顿蒙特卡洛](@article_id:304638)提供了一个单一、强大而优雅的原则。它是“数学不合理的有效性”和物理学惊人统一性的明证。一个源自 19 世纪经典力学，最初用于描述行星运动的思想，被重新用于探索定义 21 世纪科学前沿的概率景观。它提醒我们，有时候，前进的最佳方式是回顾过去那些美丽而持久的思想。