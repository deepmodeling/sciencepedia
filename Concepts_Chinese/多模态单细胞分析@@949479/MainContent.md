## 引言
数十年来，生物学家可以研究细胞的遗传蓝图或其实时活动，但很少能同时研究两者。这种分离在我们理解[细胞潜能](@entry_id:166766)（编码于其DNA中）如何转化为其动态功能方面造成了根本性的鸿沟。多模态[单细胞分析](@entry_id:274805)代表了一次革命性的飞跃，使我们能够同时测量单个细胞内的不同分子层面——例如基因组的可及性及其基因表达。这提供了一个前所未有的、整体性的整合视角，就好比同时观察一个城市的街道地图和交通流量来了解它一样。本文对这一变革性领域进行了全面综述。我们的旅程始于“原理与机制”部分，该部分揭示了那些让我们能够生成和解释这些复杂数据的巧妙实验和计算技术。然后，我们将过渡到“应用与跨学科联系”，展示这一强大的新视角如何被用于揭示发育的精妙编排、破译免疫系统，并开启一个精准医疗的新时代。

## 原理与机制

想象一下试图了解一个繁华的城市。你可以查看它的道路地图——它的结构，它的潜力；或者你可以聆听它交通的嗡嗡声——它的活动，它的现状。两者都很有用，但只有将它们结合起来，你才能真正掌握这个城市的运作方式，即街道布局如何决定交通流量。几十年来，生物学面临着类似的分野。我们可以绘制基因组的结构图，或测量其基因的活性，但很少能在同一个微小的细胞中同时进行。多模态单细胞技术改变了一切。它们让我们能同时以多种“颜色”观察细胞，创造出一幅前所未有的丰富而深刻的图景。但要解读这幅图景，我们首先需要了解它是如何制作的，以及那些让我们能够理解它的巧妙原理。

### 为每个细胞赋予独一无二的地址

要研究一个城市数百万的居民，你首先需要他们的地址。在单[细胞生物学](@entry_id:143618)的世界里，单次实验可能涉及数百万个细胞，首要挑战是为每个细胞赋予一个独特的标签，即**条形码 (barcode)**，这样我们就可以将每次测量追溯到其来源。

一种常用的方法是**基于液滴的条形码技术 (droplet-based barcoding)**，它将单个细胞封装在微小的油滴中，每个油滴内含一个载有数百万个相同独特条形码序列拷贝的微珠。这样，来自特定细胞的所有分子都会被标记上该细胞特有的条形码。但如何生成数百万种*不同*的条形码微珠呢？这时，一个更具可扩展性和更巧妙的想法应运而生：**组合索引 (combinatorial indexing)**。我们不是一步到位地分配一个单一的长条形码，而是在多轮中为细胞编码。在每一轮中，细胞被分配到（比如说）96个不同的孔中，孔中的每个细胞都会获得该轮特定的条形码。然后，这些细胞被汇集、混合，并重新分配到96个孔中进行另一轮条形码标记。

仅经过三轮，一个细胞的身份就由它收到的三个条形码的独特组合来定义。唯一地址的总数不是每轮可用条形码数量的总和，而是它们的乘积：$96 \times 96 \times 96$，接近一百万！通过使用 $R$ 轮条形码标记，每轮使用来自大小为 $A$ 的字母表（对于DNA，$A=4$）的长度为 $L_r$ 的条形码，唯一细胞身份的总数呈指数级增长，为 $A^{\sum_{r=1}^{R} L_{r}}$。这种[组合爆炸](@entry_id:272935)效应使我们能用惊人少量的试剂生成天文数字般的独特标签，从而可以在单次实验中分析数百万个细胞 [@problem_id:4381599]。

### 从生命分子到数字数据

一旦每个细胞都有了它的地址，我们就需要计算其内部的分子数量。这个过程并非完美的普查，而更像是一次部分调查，这是所谓的**捕获效率 (capture efficiency)** 的结果。我们只能“捕获”并测量到细胞中实际存在的一小部分分子。如果我们不小心，这将是一个大问题。例如，当我们扩增捕获的分子以产生可检测的信号时，我们可能会对某些分子的扩增程度高于其他分子，从而产生巨大的偏差。

这时，另一个巧妙的技巧应运而生：**独特分子标识符 (Unique Molecular Identifier, UMI)**。在任何扩增之前，每个被捕获的单个分子——无论是RNA转录本还是DNA片段——都会被标记上一个短的、随机的UMI序列。测序后，我们不计算一个基因的总读数；相反，我们计算*独特UMI*的数量。这将所有扩增的重复序列压缩为单个计数，从而为我们提供了我们所捕获的原始分子的真实数字计数 [@problem_id:4607702]。

这个过程揭示了单细胞数据的基本统计特性。我们观察到的一个基因的计数是该基因在细胞中总分子数的一个随机样本。这个抽样过程可以用泊松分布或二项分布等概率分布完美地描述。这也解释了为什么数据如此**稀疏 (sparse)**：一个基因的计数为零并不一定意味着该基因“关闭”。它可能仅仅意味着，由于偶然，我们未能网罗到它的任何分子。将数据理解为一个稀疏的、随机的抽样过程，是正确分析它的第一步，也是最关键的一步 [@problem_id:4607702] [@problem_id:4389270]。

### 多模态交响乐

为什么要费这么大劲同时测量两样东西，比如基因表达（来自scRNA-seq）和染色质可及性（来自[scATAC-seq](@entry_id:166214)）？可以这样想：RNA图谱是细胞当前的“活动”，是此时正在演奏的歌曲。ATAC图谱是“乐谱”，是*可能*被演奏的潜在歌曲，因为其底层的染色质是开放和可及的。分子生物学的**[中心法则](@entry_id:136612) (Central Dogma)** 告诉我们这两者是相互关联的：可及的DNA被转录成RNA。

因此，多模态整合的目标是学习一种共享的“语言”或一个共同的“地图”，在这里我们可以理解这种联系。我们称这个地图为**共享潜空间 (shared latent space)**。在这个抽象空间中，一个[T细胞](@entry_id:138090)无论我们是看它的乐谱还是听它的歌曲，都应该落在相同的邻域内。形式上，我们的目标是找到数学函数，将每个细胞的高维RNA和ATAC数据映射到这个低维[潜空间](@entry_id:171820)中，使得来自不同模态的同一个细胞的表示能够完美对齐。通过实现这种对齐，我们最终可以把各种线索联系起来：我们可以推断出哪些特定的可及性染色质区域负责调控哪些基因，从而揭示细胞隐藏的调控源代码 [@problem_id:4607729]。

### 充满挑战的雷区

这个完美整合的细胞图景的美好愿景并非轻易能够实现。这条道路上充满了必须被降服的统计学恶龙和技术小妖。

**“苹果与橘子”问题：** 来自scRNA-seq和[scATAC-seq](@entry_id:166214)的数据是根本不同的两种东西。RNA计数具有很宽的动态范围，最好用负二项分布之类的分布来描述。[ATAC-seq](@entry_id:169892)数据则稀疏得多，几乎是二元的（一个区域要么开放要么关闭），更适合用泊松分布或[伯努利分布](@entry_id:266933)来建模。简单地将这两个数据集拼接在一起，就像把苹果和橘子相加；它忽略了它们独特的统计特性以及每种检测方法固有的不同类型的技术噪音 [@problem_id:4389270]。

**平均值的诱惑：** 一个诱人的简化方法是将组织样本中的所有细胞取平均，得到一个“伪批量 (pseudo-bulk)”图谱。这是极其危险的。想象一个假设情景：一种疾病导致某个特定免疫细胞类型中一个基因的表达量翻倍，但同时使该细胞类型在组织中的比例减半。如果你分析整个组织的简单平均值，这两种效应会相互抵消，你会错误地得出结论，认为该基因未受影响。这说明了一个经典的**[偏差-方差权衡](@entry_id:138822) (bias-variance trade-off)**：伪批量平均值具有较低的统计方差，但可能因细胞组成的混杂变化而产生灾难性的偏差。维持单细胞分辨率是我们可靠地穿越这片泥潭的唯一途径 [@problem_id:5062544]。

**机器中的幽灵：批次效应 (Batch Effects)：** 实验是复杂的，并且常常分批进行。试剂、实验室温度或操作时间的微小、不可避免的差异会产生系统性的技术变异，这些变异会伪装成生物学信号。来自A批次的细胞可能因为纯粹的技术原因而看起来与B批次中完全相同的细胞不同。将这种技术的“批次效应”与真实的生物学变异分离开来是一项巨大的挑战。这需要精心的实验设计（例如，确保相同的细胞类型出现在多个批次中）和复杂的[统计模型](@entry_id:755400)，这些模型能够明确地学习并移除批次信号，留下纯粹的生物学状态 [@problem_id:4607731]。

**不速之客：双细胞 (Doublets)：** 在基于液滴的方法中，两个细胞偶尔会被困在同一个液滴中，形成一个具有混合身份的人工细胞，称为**双细胞 (doublet)**。这时，[多模态数据](@entry_id:635386)提供了一个独特而强大的解决方案。因为捕获RNA分子的技术效率可能与捕获可及性DNA片段的效率不同，双细胞的身份在不同模态中可能显得不一致。它的RNA图谱可能看起来像80%的细胞A和20%的细胞B，而其ATAC图谱则看起来像30%的细胞A和70%的细胞B。当我们将这个双细胞投射到我们的共享[潜空间](@entry_id:171820)时，这种冲突会导致其RNA和ATAC表示相距甚远，使其作为异常值脱颖而出，从而可以被识别和移除 [@problem_id:4607782]。

### 集成工具箱一瞥

面对这些挑战，[计算生物学](@entry_id:146988)家们开发了一套卓越的算法工具箱，每种算法都以其独特的理念来驯服[多模态数据](@entry_id:635386)的恶龙。

**[联合概率](@entry_id:266356)建模 (Joint Probabilistic Modeling)：** 一种强大的理念是建立一个单一、统一的[统计模型](@entry_id:755400)——一个生成过程的故事——来描述观测数据是如何产生的。该模型明确包含了共享生物学状态（$z$）、模态特异性噪音和批次效应的变量。通过拟合这个模型，我们可以将这些不同成分分离开来。一些最先进的方法甚至借鉴了人工智能领域的思想，比如**对抗网络 (adversarial networks)**。在这种设置中，模型的一部分（“编码器”）试图创建一个完全不含任何批次信息的生物学表示。与此同时，第二部分（“判别器”）则尽力从该表示中预测出批次。这场对抗性博弈迫使编码器学习到一个纯粹的、未受技术伪影污染的生物学表示 [@problem_id:4389270] [@problem_id:4607744]。

**几何对齐 (Geometric Alignment)：** 另一种理念更偏向几何学。我们可以将我们的RNA和ATAC数据集看作是高维空间中两个不同的“点云 (point clouds)”，其中每个点都是一个细胞。目标是对齐这两个点云。

-   **加权最近邻 (Weighted Nearest Neighbors, WNN)：** 当我们对*相同*的细胞测量了两种模态时，我们可以采用一种极具适应性的策略。我们可以问，对于每个单独的细胞，哪种模态对其局部邻域的信息更丰富？对于某些细胞，RNA可能是最清晰的信号；对于其他细胞，则可能是ATAC。WNN算法为*每一个细胞*的每种模态学习一个特定的权重。然后，它通过取局部加权平均来构建一个统一的细胞景观视图，建立一个细胞的“社交网络”，其中如果连接得到该特定邻域更可靠模态的支持，则连接更强 [@problem_id:5214372]。

-   **最优传输 (Optimal Transport, OT)：** 如果数据是“非配对”的——意味着我们有一组细胞的RNA图谱和从同一组织中取出的另一组细胞的ATAC图谱，情况又如何呢？我们无法再将细胞一一对应。这时，我们求助于优美的最优传输数学。想象一个点云是一堆沙子，另一个是同样形状的坑。OT会找到最“高效”的方式将沙子移动到坑中，以最小化总运输“成本”（例如，总移动距离）。对于我们的数据，成本是[细胞图谱](@entry_id:270083)之间的不相似性。这个过程产生了一个在两个细胞整体分布之间的最优概率映射，正确地对齐了两个数据集中存在的细胞类型，而无需任何直接的[一一对应](@entry_id:143935)细胞关系 [@problem_id:4381625]。

从组合条形码的简约优雅到对抗网络和最优传输的复杂舞蹈，整合多模态单细胞数据是一段揭示生物学、数学和计算机科学深刻统一的旅程。通过学习以多种颜色观察细胞，我们不仅得到了一幅更美丽的图画，而且对支配生命、健康和疾病的复杂机制有了根本上更深的理解。

