## 引言
理解单个细胞如何发育成复杂有机体是生物学的一项基本探索。[单细胞测序](@entry_id:198847)等现代技术以前所未有的高分辨率提供了细胞状态的快照，但这个快照是静态的，捕捉的是某个时刻成千上万个细胞的状态。这就带来了一个重大挑战：我们如何从一堆混乱的静止画面中重建出连续、动态的发育影片？伪时间的概念提供了一种计算解决方案，旨在根据细胞的分子图谱沿其发育进程对细胞进行排序。

本文将深入探讨一种特别强大而精妙的方法：**[扩散](@entry_id:141445)伪时间**。我们将探究该方法如何超越简单的几何假设，捕捉细胞在成熟和分化过程中所遵循的错综复杂、不断分岔的路径。您将了解到，[随机游走](@entry_id:142620)和图上[扩散](@entry_id:141445)的原理如何揭示高维生物数据中隐藏的结构。

第一部分“原理与机制”将剖析其核心理论，从[流形假设](@entry_id:275135)和简单方法的失败讲起。然后，我们将从头开始构建[扩散](@entry_id:141445)[伪时间](@entry_id:262363)的概念，从构建细胞邻域图到定义[扩散](@entry_id:141445)距离。在第二部分“应用与跨学科联系”中，我们将探讨如何应用这一强大工具来描绘发育路径、确定[细胞命运决定](@entry_id:196591)点，并整合各种生物数据，从而揭示一个研究生命动态的统一框架。

## 原理与机制

### 从细胞快照到发育影片

想象一下，你正在看一张大型节日的照片，一张捕捉了成千上万人的快照。你看到了婴儿、幼儿、青少年、成年人和老年人。即使不知道任何人的生日，你的直觉也能让你仅凭观察他们的外貌，就将他们中的一部分人从最年轻到最年长排成一列。你推断出了一个“伪年龄”，一种反映时间流逝的顺序。

这就是**[伪时间](@entry_id:262363)**背后的核心挑战与精妙构想。当生物学家研究发育中的组织，例如正在分化的干细胞群体时，他们通常使用单细胞 RNA 测序等技术。这为成千上万个单个细胞提供了详细的分[子图](@entry_id:273342)谱——一份包含数千个基因活性水平的清单。然而，这只是一个单一的、静态的时间快照。所有细胞都混杂在一起，就像节[日照](@entry_id:181918)片中的人群一样。[伪时间分析](@entry_id:267953)的目标就是通过计算对这些细胞进行重新排序，以重建它们采样自的那个潜在的发育影片 [@problem_id:2637971]。

这个发育故事的舞台不是物理空间，而是一个广阔的高维“基因表达空间”，其中每个维度对应一个基因的活性。每个细胞都是这个空间中的一个点。使重建成为可能的核心原则是**[流形假设](@entry_id:275135)**。该假设指出，细胞在这个空间中并非随机[分布](@entry_id:182848)。随着它们成熟，其基因表达程序会平滑而连续地变化，从而描绘出一条条路径。这些路径——可能是蜿蜒、[分岔](@entry_id:273973)和扭曲的——形成一个低维形状，即**[流形](@entry_id:153038)**，嵌入在广阔的高维空间中 [@problem_id:2848891]。我们的任务是找到这个[流形](@entry_id:153038)隐藏的几何结构，从而揭示连续的发育故事。

### 简单标尺的失效

当细胞[分布](@entry_id:182848)在这个基因表达空间中时，为什么不使用简单的工具来追踪路径呢？第一个直觉可能是使用像**[主成分分析](@entry_id:145395) (PCA)** 这样的线性方法，它非常擅长在数据集中找到“最长”的方向，即主变化轴。然而，[生物过程](@entry_id:164026)很少是直线。

想象一下发育路径像一个‘U’形弯曲。PCA 试图用一条直线捕捉最大的[方差](@entry_id:200758)，它会从‘U’的一端到另一端画一把直尺。如果我们随后将细胞投影到这把尺子上进行排序，那么过程开始和结束时的细胞将完全重叠在一起！正确的顺序完全丢失了。对于一个分岔的‘Y’形轨迹，同样会发生灾难，其中一个[细胞命运决定](@entry_id:196591)创造了两个不同的谱系。PCA 会将两个分支平均化，将它们压缩到一个毫无意义的轴上，从而完全掩盖了分岔点 [@problem_id:3302532]。

第二个直觉可能是测量细胞间的直线[欧几里得距离](@entry_id:143990)。这同样具有欺骗性。就像山间小径曲折盘绕，发育[流形](@entry_id:153038)上的两个点在[环境空间](@entry_id:184743)中可能非常接近（对于一把直尺来说是“短路”），但沿着实际路径却相距甚远。我们需要一种更复杂的方法，一种足够聪明，能够始终沿着[流形](@entry_id:153038)的蜿蜒道路行进的方法。

### [随机游走](@entry_id:142620)的智慧

与其试图从外部强加一个简单的几何结构，不如让我们通过观察数据自身上展开的过程来学习其几何结构。想象一下，我们的细胞是一群岛屿，我们建造小桥，将每个岛屿只与它最近的邻居连接起来。现在，想象一个有点迷路的人，从一个岛屿出发，随机地通过这些桥从一个岛屿走到另一个岛屿。这就是**[随机游走](@entry_id:142620)**。岛屿和桥梁的结构——即我们数据的内在几何结构——将从根本上限制行走者的去向和速度。这个[扩散](@entry_id:141445)开来的过程，很像一滴墨水在水中散开，被称为**[扩散](@entry_id:141445)**。通过观察这个扩散过程，我们可以了解其底层的景观 [@problem_id:2892393]。

为了让这个极具直观性的想法具体化，我们执行两个关键步骤：

1.  **构建邻域图：**我们首先通过将每个细胞与其在基因表达空间中的 $k$ 个最近邻连接起来，来确定其局部环境。这就形成了一个图，作为我们[流形](@entry_id:153038)结构的初步地图。

2.  **定义转移概率：**然后我们为[随机游走](@entry_id:142620)者在任意两个相连细胞之间的跳跃分配一个概率。一种自然的方法是使用**高斯核**，$K_{ij} = \exp(-\|x_i - x_j\|^2 / \varepsilon)$，这使得在非常相似的细胞（距离 $\|x_i - x_j\|$ 很小）之间的跳跃远比在不相似细胞之间的跳跃更有可能。参数 $\varepsilon$，即**核带宽**，是一个至关重要的“调节旋钮”。它就像显微镜的[焦距](@entry_id:164489)：如果 $\varepsilon$ 太小，我们只能看到一堆互不相连的嘈杂点；如果太大，整个优美的结构就会模糊成一个斑点 [@problem_id:3327640]。在对这些值进行归一化之后，我们得到一个**[转移矩阵](@entry_id:145510)** $\mathbf{P}$。这个矩阵是我们[随机游走](@entry_id:142620)的完整数学规则手册，它位于所谓**[扩散算子](@entry_id:136699)**的核心 [@problem_id:3356202]。

### [扩散](@entry_id:141445)距离：一种更自然的邻近性度量

现在我们有了一个在细胞图上进行[随机游走](@entry_id:142620)的框架，这如何帮助我们测量距离呢？我们必须抵制仅仅在图上寻找最短路径的诱惑。[最短路径](@entry_id:157568)就像一条单一、脆弱的道路，很容易被一点噪音扭曲——一个错位的细胞就可能造成一条虚假的捷径。

取而代之，我们定义了一种更深刻、更稳健的度量：**[扩散](@entry_id:141445)距离**。两个细胞 A 和 B 之间的[扩散](@entry_id:141445)距离，是衡量从 A 出发的[随机游走](@entry_id:142620)与从 B 出发的[随机游走](@entry_id:142620)有多大不同。想象一下，我们释放两大群[随机游走](@entry_id:142620)者，一群从细胞 A 开始，另一群从细胞 B 开始。经过一定步数后，每一群都在图上[扩散](@entry_id:141445)开来，形成一个[概率分布](@entry_id:146404)。[扩散](@entry_id:141445)距离就是简单地测量这两个最终的概率模式有多么不同 [@problem_id:2848891]。

如果细胞 A 和 B 在发育[流形](@entry_id:153038)上确实很近，那么从 A 出发的游走者可以轻易到达 B 出发游走者所在的位置，反之亦然。它们最终的[扩散](@entry_id:141445)模式会非常相似，[扩散](@entry_id:141445)距离也会很小。如果它们沿着一条蜿蜒的路径相距很远——即使在环境空间中看起来很近——它们的模式也会非常不同，因为游走被限制在[流形](@entry_id:153038)的结构内。这个精妙的概念通过有效地对细胞间*所有可能的路径*进行平均，捕捉了[全局几何](@entry_id:197506)结构，使其对噪音具有高度的稳健性。这背后的数学同样优美：这个过程由[转移矩阵](@entry_id:145510) $\mathbf{P}$ 的[特征向量](@entry_id:151813)（与**图拉普拉斯算子**的[特征向量](@entry_id:151813)相关）所控制，而这些[特征向量](@entry_id:151813)——即**[扩散](@entry_id:141445)分量**——形成了一个新的、自然的[坐标系](@entry_id:156346)，将扭曲的[流形](@entry_id:153038)“展开”成一个简单、平坦的空间 [@problem_id:2437545]。

### 定义[扩散](@entry_id:141445)伪时间

有了[扩散](@entry_id:141445)距离这个稳健的概念，定义[伪时间](@entry_id:262363)就简单到几乎令人觉得平淡无奇。

首先，我们必须告诉这个过程故事从哪里开始。纯粹的数学是无方向的；它无法区[分时](@entry_id:274419)间上的向前和向后。我们作为科学家，必须利用我们的生物学知识来选择一个我们知道代表最早祖细胞状态的“根”细胞或细胞群 [@problem_id:2967181]。

然后，任何细胞的**[扩散](@entry_id:141445)伪时间 (DPT)** 就是它与所选根节点的[扩散](@entry_id:141445)距离。

就是这样。一个细胞的[伪时间](@entry_id:262363)衡量的是它离过程起点有多“远”，这种“远”不是简单的步数，而是在[扩散](@entry_id:141445)的丰富、综合意义上的距离。对于更倾向于数学的读者来说，这个距离与**平均首次到达时间**密切相关——即一个游走者从根节点首次到达该细胞所需的平均随机步数 [@problem_id:3356202]。

这个框架以自然的优雅处理了复杂的轨迹，比如[分岔](@entry_id:273973)。在分岔之前，公共路径上的所有细胞共享一个[伪时间](@entry_id:262363)进程。分岔之后，[伪时间](@entry_id:262363)只是沿着每个分支分别继续增加。这揭示了一个关键的见解：你不能直接比较分岔后不同分支上两个细胞的伪时间值。分支 1 上伪时间为 $0.8$ 的细胞不一定与分支 2 上[伪时间](@entry_id:262363)为 $0.8$ 的细胞处于相同的发育“阶段”。它们的时间只有在相对于它们分岔前共享的公共路径时才具有可比性 [@problem_id:2967181]。

### 实际应用的艺术与科学

当然，现实世界是复杂的，这个优雅的理论必须面对实际的挑战。

一个主要挑战是**采样密度**。如果我们的实验意外地从一个发育阶段捕获了远多于另一个阶段的细胞怎么办？这会在我们的[流形](@entry_id:153038)上造成“交通堵塞”。一个进入这个高密度区域的[随机游走](@entry_id:142620)者会花费大量时间在密集[排列](@entry_id:136432)的细胞之间进行微小、冗余的移动。从游走者的角度来看，时间变慢了。这会压缩稠密区域推断出的[伪时间](@entry_id:262363)，并人为地扩展稀疏区域的伪时间，从而扭曲我们对发育时钟的看法 [@problem_id:2437515]。幸运的是，存在巧妙的数学修正方法。通过使用**密度归一化**重新加权转移概率，我们可以有效地告诉[随机游走](@entry_id:142620)者忽略交通堵塞，并以反映道路真实几何形状而非其上汽车密度的速度移动 [@problem_id:3356233]。然而，即使这样也无法修复一个根本上有缺陷的地图；如果最初的邻域图构建时包含了分支之间虚假的“短路”连接，那么任何权重的重新调整都无法移除它们 [@problem_id:2437515]。

最后，我们必须始终记住[伪时间](@entry_id:262363)是什么，不是什么。它给了我们事件的正确*顺序*。但是，由于从静态快照中无法得知发育的速率，对时间轴的任何“拉伸”或“挤压”——一种称为**单调变换**的数学运算——都会产生一个同样有效的[伪时间](@entry_id:262363) [@problem_-id:2967181]。我们成功地将电影胶片按正确顺序[排列](@entry_id:136432)好了，但我们不知道帧率。

要将我们的伪时间校准为以小时或天为单位的真实物理时钟，我们需要额外的生物学信息。这可以来自像 **RNA 速度**这样的出色技术，它通过比较未[剪接](@entry_id:181943)和已[剪接](@entry_id:181943)信使 RNA 的水平来估计细胞在基因表达空间中移动的*方向和速度*。或者，它也可以来自巧妙的**遗传条形码**实验，这些实验真正地为每个细胞打上分子时钟的烙印。这些方法使我们能够将[伪时间](@entry_id:262363)的相对顺序锚定到真实时间的绝对尺度上，从而将我们重建的故事变成一部带有运行中时钟的真实发育影片 [@problem_id:2637971]。

