## 应用与跨学科联系

我们花了一些时间欣赏[哈密顿神经网络](@article_id:301139)那优雅的机制，惊叹于它们如何将根深蒂固的[能量守恒](@article_id:300957)定律直接融入其架构本身。学会游戏规则是一回事，真正下场玩则是另一回事。现在，真正的乐趣开始了。我们能用这些尊重物理学的工具来*做*些什么？我们能模拟哪些新的世界，揭示哪些隐藏的规律，又能在看似毫不相关的领域之间建立起哪些惊人的联系？

您将看到，这个想法——构建能说物理学语言的模型——其力量远不止于得出正确答案。它让我们能够创造出与我们自身宇宙行为方式相同的新数字宇宙，从原子的狂热舞蹈到量子领域的微妙私语。它将我们的计算机变成了发现引擎，能够从观测中逆向工程出自然法则。而且，作为对科学思想统一性的终极证明，它提供了一个镜头，让我们得以理解各种复杂系统，即使是那些远离经典力学的系统。让我们踏上这段旅程，看看[哈密顿原理](@article_id:354614)将把我们带向何方。

### 现代炼金术士的工具箱：模拟分子与材料

哈密顿启发的机器学习最直接、或许也是最具影响力的应用在于化学和[材料科学](@article_id:312640)领域。几个世纪以来，我们一直梦想着能够在踏入实验室之前就预测出一种材料的性质或一场[化学反应](@article_id:307389)的结果。实现这一梦想的关键是精确模拟原子间永不停歇的芭蕾，而这支舞蹈由它们之间的力所支配。

原子集合的势能作为其位置的函数，即[势能面](@article_id:307856)（Potential Energy Surface, PES），恰好是系统经典哈密顿量中的势能项 $U(\mathbf{R})$。如果我们能学会这个函数，我们就能模拟这个系统。[神经网络势能面](@article_id:369075)（NN-PES）正是为此而生。这些网络在高精度的量子力学计算数据上进行训练，学习复杂的高维能量景观。一旦训练完成，它们就可以用于分子动力学（MD）模拟，以预测成千上万个原子随时间的运动，其速度比原始的量子方法快数百万倍。

但是，如果一个模拟无法与真实世界联系起来，它又有什么用呢？真正的魔力在于弥合从微观到宏观的鸿沟。在一个设计良好的 NN-PES 模拟中，我们可以测量模拟系统总能量的涨落。根据[统计力](@article_id:373880)学的基本原理，这些微观的[能量涨落](@article_id:308448)与材料的一种可测量的宏观属性——其[热容](@article_id:340019) $C_V$——直接相关。因此，通过分析模拟的输出，我们可以计算出真实的材料属性。当然，这并非没有挑战；神经网络本身会引入微量的预测误差或“噪声”在能量上。一位严谨的研究者必须考虑到这种噪声，以及运行有限尺寸模拟带来的影响，才能得出真正准确的[热容](@article_id:340019)估计值 [@problem_id:2908444]。

然而，要构建一个可靠的NN-PES，必须尊重一些深刻的、不容妥协的原则。想象两个相隔一英里的水分子。组合系统的能量，在所有实际意义上，都应该是两个独立分子能量的总和。这个看似显而易见的属性被称为**[尺寸一致性](@article_id:298652)**。类似地，如果你有一个包含 $M$ 个相同、无相互作用的系统的盒子，总能量应该是单个系统能量的 $M$ 倍。这就是**尺寸广延性**。一个违反这些原则的模型从根本上就是错误的——它会错误地认为遥远的、不发生相互作用的原子会以某种方式相互影响。为了确保我们的模型在物理上是合理的，我们必须以保证这些性质的方式来构建它们。最成功的架构，从开创性的 Behler-Parrinello 网络到现代的[图神经网络](@article_id:297304)，都是通过将总能量构建为单个原子能量贡献的总和来实现的，其中每个原子的能量仅取决于其固定截断距离内的局部原子邻域。这种架构选择并非为了方便；它是对一项基本物理要求的直接实现 [@problem_id:2805720] [@problem_id:2805707]。

宇宙充满了对称性，我们的模型也必须如此。看看你的双手。它们互为镜像，这一特性被称为手性。许多分子也具有这种特性，以“左手”和“右手”版本（称为对映异构体）存在。一个孤立的分子和它的镜像具有完全相同的能量。如果我们的 NN-PES 要可信，它必须为两者分配相同的能量。然而，一个由数字和函数混杂而成的网络，如何能感知像“手性”这样微妙的东西呢？答案再次来自物理学和数学。我们可以设计输入特征或“描述符”，使其对局部几何结构的手性敏感。一种优雅的方法是使用指向三个相邻原子的向量的[标量三重积](@article_id:356421)。这个量与它们形成的四面体的有符号体积有关，它是一个*[赝标量](@article_id:375548)*：如果分子被旋转，它保持不变，但如果分子被镜像反射，它会改变符号。通过包含这样的特征，网络就可以区分[对映异构体](@article_id:309427)。然后，模型的任务就变成了学习能量（一个真标量）必须是这些[赝标量](@article_id:375548)特征的*[偶函数](@article_id:343017)*。这可以通过训练过程来强制执行。在更复杂的场景中，比如一个分子与一个手性表面相互作用，两种[对映异构体](@article_id:309427)的能量*是*不同的，而这些相同的[赝标量](@article_id:375548)特征对于捕捉这种物理上至关重要的差异变得必不可少 [@problem_id:2784638]。

“哈密顿”哲学也可以被推广。在我们的宇宙中，一个自由运动的物体不仅仅是[能量守恒](@article_id:300957)；如果存在摩擦或阻力，它的机械能会*耗散*。在模拟纳米尺度系统时，比如原子力显微镜（AFM）[振动](@article_id:331484)探针的尖端，让我们的模型捕捉到这一点至关重要。我们可以设计一个描述[悬臂梁](@article_id:353154)运动的神经网络，但不是一个纯粹的保守哈密顿系统，而是可以添加一个阻尼项。其精妙之处在于，我们可以对这个项进行参数化——例如，通过使用像 $\mathrm{softplus}$ 这样的函数来确保其系数始终为正——从而使模型在其结构上就*保证*会耗散能量，绝不会自发地获得能量。这是核心思想的一个强大延伸：我们识别出物理学的结构特性（守恒、耗散、有界力），并将它们直接构建到我们网络的数学中 [@problem_id:2777707]。

### 窥探量子领域

哈密顿量是量子世界无可争议的统治者。量子动力学的核心方程——薛定谔方程，正是关于[哈密顿算符](@article_id:309231) $\hat{H}$ 的一个陈述：$i\hbar \frac{\partial \psi}{\partial t} = \hat{H}\psi$。因此，哈密顿启发的机器学习在这里找到一些最深刻的应用，是再自然不过的了。

一种直接的方法是使用[物理信息神经网络](@article_id:305653)（PINN）来求解薛定谔方程本身。PINN 的训练目标是最小化一个损失函数，该函数包含了网络输出满足[微分方程](@article_id:327891)的程度。但存在一种更优雅的方法。如果我们设计的网络，其组件本身就已经是方程的精确解呢？对于一个自由粒子，解是形如 $e^{i(kx - \omega t)}$ 的平面波。我们可以将我们网络的预测构建为这些平面波的[线性组合](@article_id:315155)，其中 $k$ 和 $\omega$ 之间的关系由物理定律（[色散关系](@article_id:300838) $\omega = \frac{1}{2}k^2$）固定。通过这种架构，网络*保证*在任何地方都满足薛定谔方程。复杂的学习问题被巧妙地简化为一个更简单的问题：只需找到这些波的正确组合，以匹配粒子的初始状态 [@problem_id:2427209]。

量子现实通常比单个粒子更复杂。[化学反应](@article_id:307389)，特别是那些由[光引发](@article_id:374210)的反应，可能涉及一个分子在多个相互作用的电子态景观中导航。随着分子中原子的移动，系统可以从一个[势能面](@article_id:307856)“跳跃”到另一个。这被称为[非绝热动力学](@article_id:324095)。对此进行建模是一项艰巨的挑战。为两个能量面分别训练两个独立的神经网络的幼稚方法注定会失败，因为它忽略了它们之间至关重要的物理耦合。一种源自哈密顿观点、功能更强大且物理上更合理的策略是，学习产生这两个表面的基础对象：**非绝热[哈密顿矩阵](@article_id:296687)**。这是一个 $2 \times 2$ 的矩阵，其元素是核几何的函数，由神经网络学习。我们观察到的绝热能量仅仅是这个矩阵的[本征值](@article_id:315305)。通过对学习到的矩阵进行对角化，我们可以同时获得两个能量面*以及*控制它们之间跳跃的[非绝热耦合矢量](@article_id:347035)，所有这些都在一个相互一致的框架内。这是一个绝佳的例子，说明选择正确的物理表示如何将一个难题转化为一个可解的问题 [@problem_id:2456299]。

除了动力学，量子物理学的一个核心任务是找到系统的最低能量构型——其[基态](@article_id:312876)。变分原理提供了一条强有力的途径：我们可以想象的任何[试探波函数](@article_id:303328)，其[能量期望值](@article_id:353094)都将大于或等于真实的基态能量。因此，这个游戏就是猜测一个[波函数](@article_id:307855)，计算其能量，然后调整猜测以降低能量，如此迭代直到能量无法再降低。如果我们的“猜测”是一个[神经网络](@article_id:305336)呢？这就是[神经量子态](@article_id:299943)（NQS）背后的革命性思想。网络的参数成为[波函数](@article_id:307855)拟设的变分参数。通过向网络输入[量子态](@article_id:306563)的描述（比如一个[自旋链](@article_id:300095)的构型），并使用[基于梯度的优化](@article_id:348458)器来最小化哈密顿量的[期望值](@article_id:313620)，我们可以为复杂的[多体量子系统](@article_id:322082)找到极其精确的[基态](@article_id:312876)近似 [@problem_id:2410566]。

### 从物理学到普适原理

一个伟大思想的真正力量在于其普适性。哈密顿框架的核心是一种结构化的思维方式，用于思考动力学、守恒和优化。这种思维方式如此强大，以至于它超越了传统物理学的界限。

在我们迄今为止的旅程中，我们都假设我们知道哈密顿量的形式，并使用神经网络来学习其参数。但如果我们根本不知道支配一个系统的物理定律呢？如果我们只有数据——对系统状态及其如何随时间变化的观测呢？在这里，我们可以反其道而行之。我们可以用数据来发现未知的哈密顿量，而不是用已知的哈密顿量来生成数据。通过设计一个[损失函数](@article_id:638865)，惩罚观测到的动力学与由一个试探哈密顿量（由[神经网络](@article_id:305336)表示）预测的动力学之间的任何不匹配，我们可以训练网络，使其成为系统真实哈密顿量的有效表示。这种方法可以与 Koopman [算子理论](@article_id:300436)等其他数学框架优雅地结合，有效地创造了一台由数据驱动的物理定律“发现机器” [@problem_id:90070]。

最后，谁说哈密顿量必须代表物理能量？哈密顿量可以是我们希望研究或优化的任何函数。考虑一下网络的世界——社交网络、生物网络、互联网。一个常见的任务是找到“社群”，即[密集连接](@article_id:638731)的节点集群。事实证明，这个问题可以用[统计物理学](@article_id:303380)的语言来重新表述。我们可以定义一个称为“模块度”的量，它衡量将[网络划分](@article_id:337489)为两个社群的特定划分的质量。最大化这个模块度在数学上等同于寻找一个我们可以称之为**模块度哈密顿量**的抽象对象的最低能量状态或“[基态](@article_id:312876)”。一个来自计算机科学的问题就这样被映射到了一个来自物理学的问题。然后，我们可以部署完全相同的工具，比如一个训练用来寻找低能量构型的[图神经网络](@article_id:297304)，来解决这个问题并揭示网络中隐藏的结构 [@problem_id:2410587]。

### 结论

我们的旅程结束了。我们从分子和材料的真实世界，到量子波函数的抽象领域，再到[复杂网络](@article_id:325406)的互联之网。自始至终，一条单一、统一的主线引导着我们：[哈密顿原理](@article_id:354614)。

我们已经看到，通过将自然界的基本定律——[能量守恒](@article_id:300957)、对称性、耗散以及量子力学的结构——融入我们机器学习模型的设计中，我们创造出了具有不可思议力量的工具。这些模型不仅仅是黑箱模仿者；它们更准确、更稳健，也更具洞察力。它们不仅学会预测将要发生什么，而且开始以一种与数百年物理定律相一致的语言，捕捉*为什么*会发生。无论我们是在计算新材料的性质，发现磁体的[基态](@article_id:312876)，还是揭示社交网络中的社群，这种物理学与机器学习的融合都代表了一种令人兴奋的科学新[范式](@article_id:329204)。这是一曲模拟与发现的交响乐，而其最华美的乐章尚待谱写。