## 緒論
生物體的基因組中蘊含著以 DNA 語言書寫的豐富歷史紀錄，但如此龐大的數據量也帶來了挑戰。我們如何從散佈於群體中的數百萬個遺傳變異中，提煉出演化的模式？這種複雜性造成了知識上的鴻溝，因此需要強大的總結統計量來理解這些雜訊。位點頻率譜 (SFS) 作為最優雅的解決方案之一應運而生，它提供了一幅揭示群體過往的遺傳變異「畫像」。本文將引導您了解這個基本概念。首先，在「原理與機制」一章中，我們將探討 SFS 的建構方式、其在中性理論下的預期形狀，以及它如何被群體歷史和自然選擇所扭曲。接著，「應用與跨學科連結」一章將展示 SFS 如何作為一種診斷工具，用以區分這些作用力、重建古代歷史，並回答演化生物學中的核心問題。

## 原理與機制

想像您是一位歷史學家，但您研究的文本不是塵封的手稿，而是一個物種活生生的 DNA。這個文本，也就是基因組，代代相傳，但複製過程並非完美無瑕。如同印刷錯誤般的突變會隨著時間累積。這些散佈在群體個體基因組中的突變，是演化的原始材料。但我們該如何閱讀這個龐大而複雜的故事？這似乎是一項不可能的任務，就像試圖透過閱讀圖書館裡每本書每一頁的每一個字母來理解整座圖書館一樣。我們需要一種方法來總結資訊，看見隱藏在雜訊中的模式。位點頻率譜 (SFS) 正是我們為此擁有的最優雅、最強大的工具之一。它能為群體的遺傳變異創造一幅「畫像」，通過研究這幅畫像的特徵，我們便能推斷出該群體的過往歷史。

### 變異的畫像：建構頻譜

讓我們實際操作一下。假設我們從一個生物樣本中收集了 DNA——比如說，像一項遺傳學實驗中的 10 隻水熊蟲 [@problem_id:1975045]。我們專注於牠們 DNA 的某個特定片段。為了理解我們觀察到的變異，我們首先需要一個參考點。在這些突變發生之前，原始的祖先序列是什麼樣子的？要找出答案，我們可以檢視一個近緣物種的 DNA，即**外群** (outgroup)。外群作為我們的歷史基線，讓我們能夠「極化」我們的位點，從而區分原始的**祖先等位基因** (ancestral allele) 與新的**衍生等位基因** (derived allele)（即突變）[@problem_id:2739326]。

現在，對於 DNA 中發生突變的每一個位置（一個「分離位點」），我們只需計算樣本中有多少條染色體攜帶了這個衍生等位基因。如果我們採樣了 $n$ 條染色體，這個計數（我們稱之為 $i$）可以是從 $1$ 到 $n-1$ 的任何數字。（如果計數為 $0$ 或 $n$，那麼這個位點在我們的樣本中就不是變異的）。

**展開的位點頻率譜** (unfolded Site Frequency Spectrum) 其實就是這些計數的直方圖。我們設立一組區間 (bins)，每個區間對應一個可能的計數 $i=1, 2, \dots, n-1$。然後，我們遍歷所有的分離位點，對於每個位點，我們將其計入其衍生等位基因計數所對應的區間。最終結果是一個數值向量 $\xi = (\xi_1, \xi_2, \dots, \xi_{n-1})$，其中 $\xi_i$ 是衍生等位基因出現剛好 $i$ 次的位點總數 [@problem_id:2739326]。

例如，在我們的 10 條水熊蟲染色體樣本中，區間 $\xi_2$ 將包含在十個序列中，突變剛好出現兩次的位點總數 [@problem_id:1975045]。第一個區間 $\xi_1$ 有著特殊地位，它計算的是**單一變異** (singletons)：在整個樣本中只出現一次的衍生等位基因。這些是稀有中的稀有，代表著非常新的突變，或是長時間被維持在低頻率的突變 [@problem_id:1975055]。

一個關鍵細節是：演化作用於基因，而不僅僅是個體。對於像人類這樣的二倍體生物，每個個體攜帶每條染色體的兩個副本，因此 50 個個體的樣本意味著我們有 $2n=100$ 條染色體需要計數。所以，當一位遺傳學家說他們在 50 人的樣本中發現了一個「計數為 8」的變異時，他們的意思是這個變異在 100 條被採樣的染色體中出現了 8 次，而不是在 8 個個體中發現 [@problem_id:1975016]。

如果我們找不到可靠的外群怎麼辦？在不知道祖先狀態的情況下，我們無法判斷哪個等位基因是衍生的。我們被迫建構一個**折疊的 SFS** (folded SFS)。我們不再計算衍生等位基因，而是計算樣本中頻率較低的等位基因——即**次要等位基因** (minor allele)。這意味著我們失去了一項關鍵資訊：我們無法再區分一個位點上的新衍生等位基因是稀有的（例如，在 20 個副本中出現 3 次），還是一個舊的衍生等位基因已變得非常普遍，以至於*祖先*等位基因反而成了稀有的一方（在 20 個副本中出現 3 次）。這兩種情況都會被「折疊」到次要等位基因計數為 3 的同一個區間中 [@problem_id:1975037]。因此，如果可能的話，展開的 SFS 會強大得多。

### 中性的交響曲：來自祖先的回響

現在我們有了這幅畫像。它應該是什麼樣子？讓我們考慮最簡單的情境，一種演化的「虛無假說」。想像一個大小恆定的群體，個體隨機交配，所有新突變都是**中性**的——它們既無益也無害，因此自然選擇看不見它們。在這樣的世界裡，唯一改變等位基因頻率的力量是**遺傳漂變** (genetic drift)，即哪些等位基因能被傳遞給下一代的純粹機率。

在這樣一個理想化的世界中，SFS 具有一個驚人簡單而優美的數學形式。衍生等位基因計數為 $i$ 的位點的[期望](@article_id:311378)數，記作 $\mathbb{E}[\xi_i]$，與 $1/i$ 成正比：
$$
\mathbb{E}[\xi_i] = \frac{\theta}{i}
$$
在這裡，$\theta$ 是群體尺度突變率，一個同時涵蓋群體大小 ($N_e$) 和突變發生頻率 ($\mu$) 的單一數值。這個優雅的方程式 [@problem_id:2816927] 告訴我們，我們應該預期有大量的單一變異（與 $1/1$ 成正比），兩次出現的變異數量是其一半（與 $1/2$ 成正比），三次出現的變異數量是其三分之一（與 $1/3$ 成正比），以此類推，形成一條平滑下降的曲線。

為什麼會有這種特定的 $1/i$ 關係呢？答案在於現代遺傳學中最深刻的思想之一：**溯祖理論** (coalescent theory)。與其順著時間觀察突變的演進，我們可以*回溯*時間，追蹤樣本中基因的祖先。想像一下樣本中基因副本的家譜。當你回溯時，成對的譜系會「合併」到它們的[最近共同祖先](@article_id:297175)。最終，樣本中所有的基因副本都會合併到一個單一的祖先副本。這個分支圖就是基因的譜系。

在中性、恆定大小的模型下，突變隨機散佈在這棵樹的枝條上。落在某個枝條上的突變將被該枝條的所有後代繼承。因此，衍生等位基因計數為 $i$ 的位點數，與樹中所有恰好擁有 $i$ 個後代在我們樣本中的枝條的總長度成正比。

溯祖理論的驚人結果是，支撐恰好 $i$ 個葉節點的枝條的[期望](@article_id:311378)總長度，與 $2/i$ 成比例 [@problem_id:2694952]。這不僅僅是巧合；它是在顆粒性孟德爾遺傳下，合併隨機過程的直接數學結果。我們繼承稱為基因的離散信息包的方式，其結構本身就產生了譜系中的這種 $1/i$ 模式，進而創造了位點頻率譜中的 $1/i$ 模式。這是一首美妙的交響曲，其中祖先的隨機過程穿越時空迴響，塑造了我們今天所見的遺傳變異。

### 解讀線索：群體歷史與選擇

當我們研究真實世界數據如何*偏離*這個簡單的中性預期時，SFS 的真正力量便展現出來。SFS 的形狀是一個靈敏的晴雨表，反映了塑造一個群體的群體歷史和選擇壓力。

#### 群體大小的故事

真實的群體大小並非恆定不變。它們會擴張、縮減、遷徙。這些事件在溯祖樹中留下了顯著的印記，因此也反映在 SFS 中 [@problem_id:2702813]。

-   **群體擴張**：想像一個近期快速增長的群體。回溯時間，由於過去的群體規模龐大，其譜系在近期很難合併。它們在很長一段時間內保持獨立，形成一個看起來像「星狀」的基因樹，具有很長的末端枝條。這些長長的末端枝條為新突變的積累提供了巨大的畫布。這些突變中的每一個都將成為樣本中的單一變異或非常低頻率的變異。結果呢？與中性 $1/i$ 預期相比，SFS 將顯示出顯著的**稀有變異過多**。SFS 直方圖的左側將遠高於預測。

-   **群體收縮（瓶頸效應）**：現在考慮一個經歷了近期嚴重瓶頸的群體。回溯時間，我們樣本中的所有譜系都被迫通過這個狹窄的瓶頸，導致它們非常迅速地合併。由此產生的基因樹具有非常短的末端枝條，但有較長的內部枝條在危機中存活下來。短的末端枝條意味著幾乎沒有時間讓新的、稀有的突變發生。結果是**稀有變異缺乏**。SFS 的左側將會被壓低。同時，較長的內部枝條可能導致中頻和高頻變異的相對過剩。

藉由比較觀察到的 SFS 與中性預期，我們簡直可以從 DNA 中讀出一個群體興衰起落的故事。

#### 選擇的印記

SFS 也能告訴我們關於自然選擇的資訊。突變可能帶來後果。我們可以通過將突變分為不同的功能類別來一窺究竟 [@problem_id:1975052]。

-   **同義**突變不會改變基因編碼的蛋白質序列。通常假定它們是有效中性的。因此，它們的 SFS 應該緊密遵循中性的 $1/i$ 模式，僅反映群體的群體歷史。

-   **非同義**突變則會改變蛋白質序列。由於蛋白質通常是精細調校的機器，大多數隨機改變都是有害的（**deleterious**）。自然選擇會將這些突變從群體中移除，這被稱為**純化選擇** (purifying selection)。有害的等位基因可能通過突變產生，但它們不太可能達到高頻率。它們不斷被清除，因此它們的短暫生命都停留在非常低的頻率。

這對 SFS 有何影響？對於非同義位點，我們預期會看到比中性情況下更為顯著的**稀有變異過多**。SFS 將嚴重向左偏斜，具有一個高聳的單一變異峰值，而高頻率的變異則非常少。通過比較同義和非同義位點的 SFS，我們可以量化作用於整個基因組的純化選擇的強度。

從簡單計算遺傳上的印刷錯誤開始，位點頻率譜因此成為一種精密的診斷工具。它證明了生物學的統一性，其中簡單的遺傳規則和歷史的隨機之舞相結合，描繪出一幅演化在行動中的詳細畫像，而我們才剛剛開始學習如何解讀這幅畫像。