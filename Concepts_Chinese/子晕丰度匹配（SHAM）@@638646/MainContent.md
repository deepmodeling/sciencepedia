## 引言
[现代宇宙学](@entry_id:752086)面临的核心挑战之一，是在构建宇宙的广阔无形的暗物质骨架与我们观测到的发光星系之间建立联系。尽管我们最强大的模拟能够出色地预测暗物质“晕”的[分布](@entry_id:182848)，但星系如何栖居于这张宇宙网中仍然是一个复杂的问题。我们如何将正确的星系放置在正确的位置？子晕丰度匹配（Subhalo Abundance Matching, SHAM）为这个问题提供了一个强大、直观且有物理动机的解决方案，为理论与观测之间提供了关键的纽带。

本文探讨了SHAM框架，这是一个建立在匹配排序列表这一优雅原则上的模型。我们将首先剖析其核心逻辑，审视使其如此成功的物理依据，并详细介绍将此简单想法转变为顶尖宇宙学工具所需的复杂机制。随后，我们将考察其广泛的应用，从其在为主要[星系巡天](@entry_id:749696)创建“模拟宇宙”中的作用，到其在解读[星系成团](@entry_id:158300)性微妙物理学方面的能力，以及其与宇宙学之外学科的惊人联系。

## 原理与机制

想象你是一位大学行政人员，面临一个奇特的难题。你手头有上学期的两份名单。一份名单根据一门严谨物理课程的期末考试成绩对所有学生进行了排名。另一份名单则根据同一批学生在一门高等数学课程中的成绩进行了排名。不幸的是，由于文书错误，名单上的名字被匿名处理了；你只有排序后的分数。你会如何猜测哪个物理分数属于哪个数学分数？你能做出的最简单、最直观的猜测是，这两份名单是对齐的：物理课排名第一的学生也是数学课排名第一的学生，第二名对第二名，依此类推。你会假设存在一种单调关系——一门课成绩好意味着另一门课成绩也好。

这种匹配排序列表的简单行为，是宇宙学中一个非常强大而优雅的思想的哲学核心，这个思想被称为**子晕丰度匹配（Subhalo Abundance Matching）**，或简称**SHAM**。

### 核心原则：按排序匹配

为了构建一个虚拟宇宙，我们宇宙学家从巨大的计算机模拟开始，这些模拟追踪暗物质在[引力](@entry_id:175476)作用下的舞蹈。这些模拟产生了一个充满[引力](@entry_id:175476)束缚的暗物质团块的宇宙网，这些团块被称为**晕（halos）**。其中一些是巨大的、孤立的“宿主”晕，而另一些则是较小的“子晕”，在更大的宿主晕内运行。我们的任务就是用我们在望远镜中看到的星系来填充这个暗物质骨架。SHAM提供了一种极其直接的方式来完成这项任务。

我们有两份列表。一方面，天文学家们煞费苦心地对真实宇宙中的星系进行了计数，创建了一个名为**星系[恒星质量](@entry_id:157648)函数（galaxy stellar mass function）**，即 $\phi(M_\star)$ 的清单。它告诉我们，对于任意给定的[恒星质量](@entry_id:157648) $M_\star$，每单位体积内存在多少个星系。由此，我们可以计算出累积数密度 $n_{\rm gal}(>M_\star)$，它就是每单位体积内质量*大于* $M_\star$ 的星系数量。

另一方面，我们的[暗物质模拟](@entry_id:748169)为我们提供了（子）晕的完整目录。我们可以按某个物理属性对它们进行排序，我们暂时称之为 $X$（我们会发现选择 $X$ 是故事中最重要的部分）。然后我们可以计算这些天体的累积[数密度](@entry_id:268986) $n_{\rm (sub)halo}(>X)$，即每单位体积内属性值大于 $X$ 的（子）晕数量。

SHAM做出了一个大胆而简单的假设：宇宙是公平的。质量大于 $M_\star$ 的星系数量，与属性值大于 $X$ 的（子）晕数量完全相等。在数学上，我们只需将这两个[数密度](@entry_id:268986)设为相等：

$$
n_{\rm gal}(>M_\star) = n_{\rm (sub)halo}(>X)
$$

这一个方程定义了星系[恒星质量](@entry_id:157648)与晕属性 $X$ 之间的[一一对应](@entry_id:143935)的单调映射关系[@problem_id:3492424]。我们观测列表上最大质量的星系被分配给我们模拟列表上排名第一的（子）晕；第二大质量的星系分配给排名第二的（子）晕，依此类推。一旦一个星系被分配给一个（子）晕，它就继承了其位置和速度。就这样，我们得到了一个星系生活在正确位置的[模拟宇宙](@entry_id:754872)。

这种方法与**晕占据[分布](@entry_id:182848)（Halo Occupation Distribution, HOD）**等其他方法有根本的不同。HOD模型问的是一个统计问题：“对于一个质量为 $M_{\rm halo}$ 的宿主晕，它包含 $N$ 个某种类型的星系的概率 $P(N|M_{\rm halo})$ 是多少？”[@problem_id:3475164]。HOD关注的是平均值和总体；而SHAM关注的是直接的、按序对应的关系。这就像是说“一个有30名学生的教室平均会有5名A等生”与“出勤率最高的学生就是期末成绩最高的学生”之间的区别。

### 按什么排序？子晕的[生命物理学](@entry_id:188273)

关键问题立刻变为：我们应该用什么晕属性 $X$ 来进行排序？星系的[恒星质量](@entry_id:157648)是其整个生命历程的反映——它能够冷却多少气体并将其转化为恒星。这个过程主要发生在星系的宿主晕最壮丽的时期，也就是在环境的严酷考验开始之前。

对于**卫星星系（satellite galaxies）**来说尤其如此。卫星星系是指其小暗物质子晕落入一个大得多的宿主晕的[引力](@entry_id:175476)束缚中的星系。当它在这个巨大的结构内部运行时，它会经历巨大的[潮汐力](@entry_id:159188)。这些力与导致地球上[潮汐](@entry_id:194316)的力相同，但在星系尺度上，它们的作用是将子晕外层的、蓬松的暗物质撕裂开来。这个过程称为**[潮汐剥离](@entry_id:160026)（tidal stripping）**，它会随着时间的推移显著减[少子](@entry_id:272708)晕的质量[@problem_id:3492416]。

因此，一个卫星子晕的现时质量 $M(z=0)$，或者它现时的[势阱](@entry_id:151413)深度（通过其最大旋转速度 $V_{\rm max}(z=0)$ 来衡量），可能只是其昔日辉煌的苍白影子。然而，嵌在其核心的星系要密集得多，束缚得更紧。它主要是在被剥离*之前*形成其恒星的。因此，星系的[恒星质量](@entry_id:157648)应该与子晕的“峰值”状态相关联——即它曾经最宏伟的状态。

这种物理洞察力引导我们选择历史属性来为卫星星系排序[@problem_id:3492445]。最成功的 $X$ 选择是以下属性：
- **峰值质量（$M_{\rm peak}$）**：子晕在其整个宇宙历史中曾达到的最大质量。
- **最大旋转速度峰值（$V_{\rm peak}$）**：子晕 $V_{\rm max}$ 的历史最大值，它追踪了其[势阱](@entry_id:151413)曾经达到的最深程度。

通过使用这些“化石记录”属性，我们将星系的[恒星质量](@entry_id:157648)与该[恒星质量](@entry_id:157648)*正在形成时*的晕的大小相匹配。使用像 $V_{\rm max}(z=0)$ 这样的现时属性会给我们的映射带来额外的噪声或“弥散”（scatter）。为什么呢？因为卫星星系经历的[潮汐剥离](@entry_id:160026)量取决于其具体[轨道](@entry_id:137151)——有些会冲过密集的中心而被严重剥离，而另一些则停留在宁静的郊区。这种[轨道](@entry_id:137151)多样性造成了随机的质量损失。通过以 $V_{\rm peak}$ 为条件，我们超越了这种环境效应，连接到最初决定星系大小的更基本的属性上[@problem_id:3492403]。

### 现代模型的机制

虽然核心思想很简单，但要在实践中使其奏效，需要一些复杂的机制。

#### 应对弥散与偏误

自然界并非一个完美整洁的会计师。[恒星质量](@entry_id:157648)与晕大小之间的关系不是一条完美的一一对应直线；它是一团模糊的云。存在着内禀**弥散（scatter）**：一个给定 $V_{\rm peak}$ 的晕可以拥有一个范围内的星系质量。现代SHAM通过将丰度匹配方程推广为一个考虑了这种[统计分布](@entry_id:182030)的积分形式来包含这一点[@problem_id:3492424]。

引入弥散会带来一个微妙但深刻的后果，称为**Eddington偏误**。想象一下你在测量人们的身高。因为中等身高的人数远多于非常高的人，随机[测量误差](@entry_id:270998)更有可能使一个中等身高的人显得高，而不是使一个高个子显得中等。类似地，在宇宙中，小质量晕的数量远多于大质量晕。这意味着弥散更有可能使一个小质量晕“向上弥散”并冒充一个大质量晕，而不是反过来。为了准确地再现观测到的大质量星系数量，一个实用的SHAM算法必须修正这种偏误，通常通过迭代调整平均的 $M_\star-X$ 关系，直到最终经过弥散的星系列表与观测列表相匹配[@problem_id:3492447]。

#### 中心星系、卫星星系与缺失的部分

一个稳健的SHAM模型对**中心星系**（那些生活在自己独立的宿主晕中的星系）和卫星星系的处理方式是不同的。由于中心星系没有被[潮汐剥离](@entry_id:160026)，它们的现时属性是其大小的良好代表，因此我们可以使用 $V_{\rm max}(z=0)$ 对它们进行排序。而卫星星系，正如我们所见，必须通过像 $V_{\rm peak}$ 这样的历史属性来排序。因此，一个先进的SHAM实现会执行两个独立的丰度匹配过程：一个针对中心星系，一个针对卫星星系，分别将它们匹配到各自观测到的布居中[@problem_id:3492447]。

但是，当[潮汐剥离](@entry_id:160026)效率如此之高，以至于子晕的质量被削减到我们模拟的解析度极限以下时，会发生什么呢？我们模拟中的寻晕算法不再能看到它；子晕从我们的目录中消失了[@problem_id:3512790]。然而，它内部致密的星系很可能存活得更久，像一个没有暗物质外衣的幽灵一样运行。这些被称为**孤儿星系（orphan galaxies）**。忽略它们会导致我们低估卫星星系的数目，尤其是在星系团的密集内部区域，并且会抹去小尺度[星系成团](@entry_id:158300)性信号的一个重要部分。

为了解决这个问题，我们必须在我们的机制中为孤儿星系添加一个处方。当一个子晕的轨迹消失时，我们通过模拟其因**动力学摩擦（dynamical friction）**——一种[引力](@entry_id:175476)拖拽力——而发生的[轨道](@entry_id:137151)衰减，来继续追踪孤儿星系的位置，直到它被预测与中心星系合并为止[@problem_id:3492482]。这个补丁是一个完美的例子，说明了一个优雅的物理理论必须如何通过细致的工程来加以增强，以面对我们工具的局限性。

### 一个惊人的成功：星系组装偏误

投入到SHAM中的细致物理推理以意想不到的方式得到了回报。其最大的成功之一，是它能自然地解释一种被称为**星系组装偏误（galaxy assembly bias）**的微妙现象。

观测和模拟表明，在固定的晕质量下，宇宙历史中形成较早的晕比形成较晚的晕更强地成团在一起。星系会在意它们的晕的“生日”吗？事实证明它们会的。SHAM自动地预测了这一点。我们用于匹配的属性，如 $V_{\rm peak}$，与晕的形成时间相关。通过将更亮的星系匹配到具有更高 $V_{\rm peak}$ 的晕，SHAM自然地将这些更亮的星系放置在成团性更强、形成更早的晕中。相比之下，像标准HOD这样更简单的、只依赖于晕质量的模型，则完全抹掉了这种效应[@problem_id:3473073]。这一成功有力地证明了SHAM简单而有物理动机的逻辑捕捉到了关于星系与其暗物质宿主之间联系的深刻真理。这不仅仅是一个匹配游戏；它是我们宇宙中光明与黑暗[共同演化](@entry_id:151915)的一个窗口。

