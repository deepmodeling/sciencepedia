## 引言
在医学研究和公共卫生领域，一个关键挑战是预测特定事件随时间发生的可能性，例如疾病复发或治疗副作用。然而，这种预测常常因**[竞争风险](@entry_id:173277)**（competing risks）的存在而变得复杂——即其他可能阻止目标事件发生的结局。例如，一名正在监测癌症复发的患者可能首先死于心脏病发作。传统的生存分析方法在这些情况下往往难以提供明确的预后答案，从而在理解生物学机制与预测患者实际结局之间造成了巨大的知识鸿沟。本文旨在揭开一个为弥合这一鸿沟而设计的强大统计工具的神秘面纱：**子分布风险**。

本文将引导您深入了解这一基本概念的复杂之处。在第一部分“**原理与机制**”中，我们将探讨传统原因别风险的局限性，并揭示子分布风险和 Fine-Gray 模型所呈现的精妙解决方案。随后，“**应用与跨学科联系**”部分将展示该方法如何在现实世界场景中应用，从肿瘤学和心脏病学中的临床预后，到因果推断和机器学习中的前沿应用，最终说明提出正确的统计学问题如何引出更有意义的答案。

## 原理与机制

在理解世界的旅程中，我们常常从一个看似简单的问题开始。一位肿瘤科医生拿着病人的病历，可能会问：“这位病人五年内复发的概率是多少？”一位心脏病专家在开出一种新药时，可能会想：“这种药能将我的病人十年内死于心脏病的风险降低多少？”这些问题关乎绝对风险，即某一事件在特定时期内发生的真实世界概率。这个概率就是统计学家所称的**累积发生函数（Cumulative Incidence Function, CIF）**。

乍一看，计算这个概率似乎很简单。但大自然很少如此简单。正在接受癌症治疗的患者可能不幸死于中风；有心脏病发作风险的人可能死于无关的感染。这些就是**[竞争风险](@entry_id:173277)**——它们阻止了我们感兴趣的结局发生。这些竞争事件的存在带来了一个微妙但深刻的陷阱，这个陷阱几十年来一直困扰着研究人员，也催生了对更巧妙工具集的需求。

### 第一套工具：原因别风险

让我们想象一下，我们正在研究患者，以确定一种新疗法是否会影响他们的复发风险。一些患者可能会复发（我们关心的事件），而另一些患者可能会死于与癌症无关的原因（竞争事件）。最直观的方法是只关注复发。在任何给定时间点，在仍然存活且尚未复发的患者群体中，复发发生的速率被称为**原因别风险（cause-specific hazard, CSH）**。

在数学上，如果我们将事件发生的时间记为 $T$，原因记为 $K$，那么我们感兴趣的事件（称之为原因 $k$）在时间 $t$ 的原因别风险是该事件发生的瞬时概率，条件是到那时为止仍然存活 [@problem_id:4829094]：
$$
\lambda_k(t) = \lim_{\Delta t \to 0} \frac{\Pr\big(t \le T  t+\Delta t,\, K = k \mid T \ge t\big)}{\Delta t}
$$
这个量是生存分析的主力工具——Cox [比例风险模型](@entry_id:171806)的直接目标。通过对原因别风险进行建模，我们可以提出关于潜在生物学或机制的尖锐、集中的问题。例如，“这种新药是否直接干扰了癌症复发的细胞过程？”从此类模型中得出的风险比为我们解答了这个“病因学”问题 [@problem_id:4576351]。它比较了治疗组与[对照组](@entry_id:188599)的瞬时复发率，但仅限于那些仍在“局中”——即尚未复发或死于其他原因的患者 [@problem_id:4968282]。

### 真正的目标：为何第一套工具力有不逮

这是理解生物学因果关系的宝贵工具。但它能回答我们最初关于患者五年复发概率的问题吗？令人惊讶的是，不能。其原因正是整个竞争风险问题的症结所在。

到时间 $t$ 时实际复发的概率，即 CIF（我们称之为 $F_k(t)$），取决于两件事：复发的[瞬时速率](@entry_id:182981) $\lambda_k(t)$，以及存活足够长时间且未发生任何事件从而处于风险中的概率 $S(t)$。这种基本关系通过一个积分表达出来 [@problem_id:4906443]：
$$
F_k(t) = \int_0^t S(u) \lambda_k(u) du
$$
在这里，$S(t)$ 是总生存函数，即到时间 $t$ 为止未经历*任何*事件（复发或竞争性死亡）的概率。这个总生存概率取决于复发风险*以及*所有竞争事件的风险。

现在，想象一个有趣的悖论。假设我们的新疗法对癌症复发的生物学过程完全没有直接影响，其原因别风险比恰好为 1。然而，这种疗法在预防[竞争风险](@entry_id:173277)——比如治疗相关副作用导致的死亡——方面效果奇佳。会发生什么呢？通过防止竞争性死亡，该疗法提高了总生存率 $S(t)$。在任何给定的时间点，都有更多的患者存活下来并“留在局中”。由于他们仍然面临着未改变的潜在复发风险，随着时间的推移，实际上将有更多的人复发。

结果如何？接受这种新疗法的患者五年复发概率 $F_k(t)$ 实际上可能*增加*。原因别模型会显示没有效果，但预测患者结局的医生会看到更高的复发机会 [@problem_id:5222328]。这不是矛盾；这是从两个不同问题中得出的两个不同事实。原因别风险关注的是幸存者中的瞬时速率，而累积发生率关注的是整个人群中累积的总风险。要回答我们患者的问题，我们需要一个能直接对 CIF 建模的工具。

### 神来之笔：重新定义赛跑

正是在这里，Fine 和 Gray 的工作提供了一个 brilliantly counter-intuitive 的解决方案。如果我们想直接对 CIF 建模，我们需要一种与其有简单关系的新型“风险”。他们称之为**子分布风险（subdistribution hazard, SDH）**。

为了理解它，让我们回到有两个终点的赛跑：“复发”（原因 $k$）和“其他原因死亡”（原因 $\ell$）。原因别风险衡量的是接近“复发”终点的选手的速度，但仅限于那些仍在奔跑的选手。相比之下，子分布风险旨在直接模拟所有起跑选手中最终穿过“复发”终点线的比例。

诀窍在于：Fine 和 Gray 设想了一种新型的风险集。在这个奇怪的新世界里，当一名选手穿过“其他原因死亡”的终点线时，他们不会被移出比赛。相反，他们被视为在赛道上“冻结”了。他们永远无法通过复发来完成比赛，但他们仍然是我们观察的这群选手的一部分。在形式上、数学上，他们永远“处于风险中” [@problem_id:4578270] [@problem_id:4906443]。因此，时间 $t$ 的子分布风险的风险集包括所有尚未复发的人：那些仍在奔跑的人*以及*那些已经在“其他原因死亡”终点线完成比赛的人 [@problem_id:4829094] [@problem_id:4785652]。

为什么要进行这种奇怪的思维实验？因为它在数学上创造了奇迹。这个新定义的风险，即子分布风险 $\tilde{\lambda}_k(t)$，现在与 CIF 之间拥有了我们一直想要的那种简单而优雅的关系 [@problem_id:4975257]：
$$
F_k(t) = 1 - \exp\left(-\int_0^t \tilde{\lambda}_k(u) du\right)
$$
通过重新定义谁“处于风险中”，我们构建了一个能直接模拟我们真正关心的、用于预后和预测的量的工具。其美妙之处不在于它的物理直觉——因一种原因死亡的人不可能再因另一种原因死亡——而在于它解决实际问题的数学力量。

### 解读结果：两种真实

有了这个新工具，我们可以构建一个[回归模型](@entry_id:163386)，即**Fine-Gray 模型**，它看起来与标准的 Cox 模型非常相似：
$$
\tilde{\lambda}_k(t \mid X) = \tilde{\lambda}_{0k}(t) \exp(\gamma^{\top}X)
$$
在这里，$X$ 是我们的协变量集合（如治疗组或生物标志物水平），系数 $\exp(\gamma)$ 是**子分布风险比（SHR）**。它告诉我们一个协变量对累积发生率的累积速率的乘法效应。

现在我们可以清楚地看到为什么这两种方法会给出不同的答案。
*   **原因别风险比（CSHR）**告诉你治疗对当前能够经历事件的人群中事件[瞬时速率](@entry_id:182981)的影响。它是一个**病因学**指标，最适合理解生物学机制。
*   **子分布风险比（SHR）**告诉你治疗对事件随时间累积概率的净效应，考虑了治疗可能如何影响竞争事件。它是一个**预后**指标，最适合预测患者结局和做出临床决策 [@problem_id:4576351]。

CSHR 为 0.80 意味着治疗将仍在风险中的人群中事件的潜在生物学速率降低了 20%。SHR 为 0.90 意味着治疗将决定累积发生率的风险降低了 10%，这更直接地反映了绝对风险的变化 [@problem_id:4968282]。

同样至关重要的是要认识到，这两个比率是不同的概念。随时间恒定的 CSHR 并不意味着 SHR 也会恒定，因为 SHR 是一个复合量，它还取决于总生存率随时间变化的影响 [@problem_id:4991154]。只有在不存在竞争风险的简单情况下，这两个概念才会合并为一体 [@problem_id:4991154]。它们之间的区别是一个绝佳的例子，说明在科学中，你得到的答案完全取决于你提出的问题。

