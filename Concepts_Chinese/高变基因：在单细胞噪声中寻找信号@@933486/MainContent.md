## 引言
在单细胞生物学领域，每个细胞都是一个信息宇宙，成千上万的基因同时进行表达。单细胞 RNA 测序为我们提供了前所未有的关于这一活动的快照，但同时也带来了一个巨大的挑战：我们如何从海量的背景噪声中区分出定义细胞身份的有意义的生物学信号？使用所有可用的遗传信息往往会适得其反，因为普遍存在的管家基因和技术性假象会掩盖那些真正重要的细微变异。这正是高变基因 (HVG) 概念旨在解决的根本问题。

本文将为您提供一份全面的指南，帮助您理解和利用 HVG 这一现代生物信息学的基石。我们将深入探讨那些使我们能够从可预测的技术噪声中分离出真实生物学变异的核心原理。您不仅将学到这些基因是如何被识别出来的，还将了解为何这种方法如此强大有效。

在第一章**原理与机制**中，我们将探讨 HVG 筛选的统计学基础，分解观测方差并对测[序数](@entry_id:150084)据中的[固有噪声](@entry_id:261197)进行建模。随后的**应用与跨学科联系**一章将展示该技术如何应用于绘制[细胞图谱](@entry_id:270083)、重建发育过程，乃至整合来自空间转录组学新领域的数据，同时也会探讨该方法的关键权衡与局限。

## 原理与机制

想象一下，您正试图理解一个庞大交响乐团的复杂运作，但您只能听到所有乐器同时演奏的录音。您将如何开始从大提琴中分辨出小提琴，从铜管乐器中分辨出木管乐器？这正是我们在单细胞生物学中面临的挑战。每个细胞都是一个乐团，数以万计的基因扮演着各自的角色。我们的录音是这一活动的快照——转录组。我们的目标是通过聆听它们奏出的音乐，来识别乐团的不同声部，即不同的细胞类型。

一种简单的方法可能是关注声音最大的部分。但最响亮的声音可能只是低音提琴单调的嗡鸣，或是空调持续的哼声——这些声音音量虽高，却几乎不能告诉我们正在演奏的独特旋律是什么。在我们的细胞乐团中，“声音最大”的基因通常是**管家基因**，它们负责基本的细胞功能。它们在所有细胞中都以高水平表达，虽然由于分子生物学固有的随机性，其表达会闪烁和波动，但这种高表达却无信息量的方差很容易淹没那些由真正定义细胞身份的基因所奏出的更细微、更富旋律的乐章 [@problem_id:1465906]。

为了找到真正的生物学信号，我们需要一种更精细的策略。我们必须学会区分有意义的旋律和背景噪声。这正是识别**高变基因 (HVG)** 的核心目的。

### 分解方差：信号与噪声

关键的洞见在于，我们对任何给定基因观测到的总方差并非一个单一、整体的量。它是一个复合物，是不同贡献的总和。我们可以用一个简单而有力的概念来表达：

$$
\text{总观测方差} = \text{技术方差} + \text{生物学方差}
$$

我们的任务是找到那些“生物学方差”项异常大的基因。但要做到这一点，我们必须首先理解并解释“技术方差”。

技术方差到底是什么？它是一个概括性术语，涵盖了所有非因我们所寻找的特定生物学差异而产生的变异来源。它包括实验过程的随机性——我们恰好捕获并测序了细胞中的哪些分子。这种噪声的一个关键特征是，其大小与基因的平均表达水平内在相关。可以把它想象成“散粒噪声”。如果您在数一小块人行道上落下的雨滴，您会预料到每分钟的雨滴数会有一些波动。如果下的是毛毛细雨（低表达），数量可能在每分钟 1 到 3 滴之间波动。而在倾盆大雨（高表达）中，数量可能在 100 到 130 滴之间波动。即使相对变异相似，倾盆大雨中波动的绝对值也更大。

这种均值-方差关系是计数数据的基本属性。对于像 **Poisson 分布**这样的简单模型，方差等于均值。一个更符合基因计数的现实模型是**负二项 (NB) 分布**，它允许比 Poisson 分布稍多的变异。在这个框架下，一个基因的预期技术方差可以通过一个优美的关系式来建模，该关系式取决于其平均表达量 $\mu$ 和一个量化额外变异的“[离散度](@entry_id:168823)”参数 $\theta$ [@problem_id:3348626]：

$$
\sigma^2_{\text{tech}} \approx \mu + \frac{\mu^2}{\theta}
$$

这个方程是我们的罗塞塔石碑。它为我们提供了一个可预测的趋势：随着基因平均表达量 $\mu$ 的增加，其预期的技术方差 $\sigma^2_{\text{tech}}$ 也会以一种明确的方式增加。如果我们将数据集中每个基因的方差与其均值作图，我们看到的不是一团随机的点云，而是一个结构，一条由分子计数物理学塑造的趋势线。

因此，一个高变基因并不仅仅是一个方差高的基因。它是一个其方差显著*高于*其平均表达量所预期的基因。它是一个离群值，一个远高于技术噪声可预测趋势线的点。这种“多余”的方差就是我们的信号——我们一直在寻找的生物学方差。

### 寻找离群值的艺术

有了这个原理，任务就变成了一项离群值检测的练习。我们如何精确定义技术噪声的趋势并找到那些远超其上的基因呢？

历史上，一种巧妙的方法是使用 **spike-in [内参](@entry_id:191033)**。这是一系列已知浓度的合成 RNA 分子混合物，被添加到每个细胞的裂解液中。由于这些分子是外源的，并以固定量添加，因此其计数中观察到的任何变异*必然*是技术性的。它们充当了一把内置的标尺，使我们能够直接描绘出技术噪声的均值-方差趋势 [@problem_id:3348626]。然后，我们可以通过从每个真实基因的观测方差中减去预期的技术方差，来计算其“生物学方差”。得到较大正值的基因就是我们的候选者 [@problem_id:3348626]。例如，如果两个基因具有相同的平均表达量，但一个的总方差为 9.0，另一个为 5.1，而在该均值下预期的技术方差为 5.25，那么第一个基因是明确的 HVG 候选者（生物学方差为 3.75），而第二个则不是 [@problem_id:3348626]。

更现代的方法已经意识到我们甚至不需要 spike-in 内参。我们可以做出一个简单而有力的假设：*大多数基因在生物学上都不是可变的*。因此，我们数据集中的大部分基因本身就可以定义基线趋势。这催生了稳健的技术，即我们计算所有基因的均值和方差，通常在转换后（例如，对数）的尺度上以稳定这种关系，然后使用如[局部回归](@entry_id:637970)等统计方法，通过点云拟合一条灵活、平滑的曲线 [@problem_id:4608302]。

这个过程变成了一场精细、统计上严谨的搜寻：
1.  对每个基因，计算其在所有细胞中的平均表达量和方差。
2.  拟合一条平滑曲线，以模拟预期方差作为均值的函数。
3.  对每个基因，计算其[标准化残差](@entry_id:634169)——一个量化其方差位于拟合趋势线上方或下方多少个标准差的分数。
4.  得分最高的正值基因即为我们的 HVG。因为我们同时进行数千次检验（每个基因一次），我们会使用如**错误发现率 (FDR) 控制**等统计程序，以确保我们的列表不会被偶然事件所填充 [@problem_id:4608302]。

这个过程有效地将细胞身份的“旋律”从管家基因的“节奏”和技术噪声的“静电噪音”中分离出来。

### 乐池：实践中的复杂性

当然，[统计模型](@entry_id:755400)的纯净世界最终必须面对生物实验的混乱现实。HVG 的选择充满了潜在的陷阱，需要小心应对。

首先，并非所有的生物学变异都是我们寻求的变异。数据集中一些变异最大的基因往往是由细胞的能量工厂——**线粒体**编码的，或是那些构建其蛋白质工厂——**核糖体**的基因。它们的表达常常与细胞的整体代谢率相关，或者更令人担忧的是，与细胞的压力或健康水平相关。一个垂死的细胞可能会失去其细胞质内容物，从而人为地提高了线粒体转录本的比例。如果我们天真地选择 HVG，我们最终得到的列表可能被这些基因主导，我们的分析将会区分健康细胞和病态细胞，而不是 T 细胞和 B 细胞。因此，通常的做法是在寻找 HVG 之前过滤掉这些基因集。然而，这是一种[启发式方法](@entry_id:637904)，而非教条。在像心脏这样由高能量需求定义的组织中，[心肌细胞](@entry_id:150811)中线粒体基因的极高表达是真实的生物学特征，保留它们对于区分它们与其他细胞类型至关重要 [@problem_id:4324356]。

其次，实验假象会产生虚假的变异。一个常见的问题是**双细胞**，即两个细胞被意外地一起封装和测序。由此产生的数据点是两种不同细胞类型的人为混合物。其表达谱是一个中间体，是两个原始细胞表达谱的[线性组合](@entry_id:155091) [@problem_id:4608246]。对于一个作为其中一种细胞类型标记的基因来说，双细胞的存在创造了第三个、中间的表达水平。这夸大了该基因在整个群体中的总方差，导致它被标记为 HVG，不是因为有趣的生物学，而是由于人为的混合 [@problem_id:4608246]。这就是为什么识别和移除双细胞是一个关键的初步步骤。

最后，整个过程必须按正确的顺序进行。我们必须首先校正细胞间测序深度的差异（**归一化**），然后才能有意义地比较它们的方差。如果我们在处理来自不同实验（**批次**）的数据，我们必须小心，不要将[批次效应](@entry_id:265859)误认为是生物学变异。一种稳健的方法是在每个批次内部分别进行 HVG 筛选，以找到持续可变的基因，然后再尝试合并数据集 [@problem_id:4608237]。

### 多少旋律？为何有效？

经过这个细致的过程，我们得到了一份按生物学变异证据排序的基因排名列表。但这引出了最后一个实际问题：我们应该选择多少个？1000个？2000个？还是5000个？这是一个权衡。太少，我们可能错过细胞身份的关键方面。太多，我们又开始重新引入噪声，稀释我们的信号。一种有原则的选择方法是评估 HVG 列表的**稳定性**。我们可以反[复对数](@entry_id:174857)据进行[重采样](@entry_id:142583)，看看顶层基因的列表变化有多大。我们寻找一个[饱和点](@entry_id:754507)——例如，前 2000 个基因可能非常稳定（例如，列表间有 78% 的重叠），而如果我们扩展到 3000 个，稳定性可能会略有下降 [@problem_id:4608260]。这表明排名在 2000-3000 的基因其变异性不那么稳健。

支撑整个过程的是一个深刻而优美的几何学和信息学逻辑。为了区分 $k$ 种不同的细胞类型，我们的数据必须包含至少 $k-1$ 个独立的信号维度 [@problem_id:2379633]。通过选择一个包含 $p$ 个 HVG 的集合，我们是在赌它们所定义的 $p$ 维空间足够丰富，以包含这个 $k-1$ 维的信号。

这种方法的非凡成功并非偶然。通过选择具有“超额方差”的基因，我们实际上是在选择具有高**[信噪比](@entry_id:271196)**的基因。一个基因的总方差可以在数学上分解为细胞类型*内部*的方差（噪声）和细胞类型*之间*的方差（信号）。我们所描述的方法是一种巧妙的[启发式方法](@entry_id:637904)，用于寻找“之间”分量相对于“之内”分量较大的基因。事实证明，这正是[统计决策理论](@entry_id:174152)告诉我们能够最大化我们正确分类细胞能力的量。最大化这个比率可以最小化最优分类器的理论错误率，并进而最大化基因表达数据与真实细胞身份之间的互信息 [@problem_id:4607366]。

最终，寻找高变基因不仅仅是一个数据过滤步骤。它是一种深刻的诠释行为。这是我们如何调整我们的耳朵来聆听细胞交响乐，滤除嘈杂的噪声，以分离出那些定义细胞身份的美丽、独特的旋律。

