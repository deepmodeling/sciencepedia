## 引言
在科学和政策领域，仅仅知道一种治疗或干预措施有效只是成功的一半。真正具有变革性的洞见来自于理解它“为什么”有效——即连接原因与结果的具体因果路径。然而，这个因果关系的“黑箱”，即初始行动与最终结果之间错综复杂的机制网络，是出了名的难以揭示。传统分析或许能告诉我们一个项目的总效应，但它难以分离出其不同组成部分的具体贡献。

本文深入探讨了一个为解决这一难题而设计的强大概念工具：自然间接效应。它提供了一种形式化的语言，不仅能提问“效应是什么？”，还能提问“该效应有多少是通过某一特定机制传导的？”。在第一部分“原理与机制”中，我们将使用[潜在结果框架](@entry_id:636884)来精确定义总效应，并将其代数分解为直接和间接部分，从而揭示这种方法背后的优美逻辑及其所依赖的关键假设。在这一理论基础之上，第二部分“应用与跨学科联系”将展示这一概念非凡的通用性，探索它如何被用于揭示社会流行病学、[表观遗传学](@entry_id:138103)和药理学等不同领域的因果链，将关于机制的抽象问题转化为可量化的答案。

## 原理与机制

在我们探索世界的过程中，我们常常从简单的问题开始。这种新肥料能让植物长得更高吗？这个公共卫生项目能降低感染率吗？这种新药能提高患者的存活率吗？这些都是关于某个原因的**总效应**的问题。但科学的核心，并不满足于仅仅知道某件事物“是否”有效，它渴望知道“为什么”有效。机制是什么？原因是如何引发结果的？要回答这些问题，我们必须深入因果关系的“黑箱”内部。

想象一下一项针对癌症患者的新型[免疫治疗药物](@entry_id:151612)的临床试验 [@problem_id:4557700]。我们将药物治疗称为 $A$，其中 $A=1$ 代表接受药物治疗的患者，$A=0$ 代表接受安慰剂的患者。结果 $Y$ 是患者肿瘤的缩小情况。我们观察到，平均而言，接受药物治疗的患者肿瘤缩小得更多。药物有效！但“如何”起作用的呢？一位生物学家可能会假设，药物通过激活患者的[T细胞](@entry_id:138090)（免疫系统的关键部分）来起作用。我们可以用一个生物标志物来测量这种[T细胞](@entry_id:138090)的激活程度，我们称之为中介变量 $M$。这就给了我们一个想要研究的因果链：药物（$A$）促进[T细胞](@entry_id:138090)激活（$M$），而[T细胞](@entry_id:138090)激活又导致肿瘤缩小（$Y$）。

这个简单的故事，$A \to M \to Y$，隐藏着一种美妙的复杂性。药物可能还对肿瘤有**直接效应**，比如通过切断其血液供应，这条路径与[T细胞](@entry_id:138090)毫无关系。我们的挑战是解开这些路径：药物的总效益中，有多少来自于其*通过*[T细胞](@entry_id:138090)激活产生的效应（**间接效应**），又有多少来自于其其他的直接作用（**直接效应**）？

### 一种用于想象世界的语言

为了精确地谈论这些路径，我们需要一种特殊的语言，一种关于“如果……会怎样”的语言。这就是**[潜在结果框架](@entry_id:636884)**，它有点像在谈论平行宇宙。对于任何一个人，我们都可以想象在不同情景下他/她的结果会是怎样。

让我们用 $Y(a)$ 表示一个个体在接受处理水平 $a$ 时的[潜在结果](@entry_id:753644)。所以，$Y(1)$ 是他/她在一个接受了药物的宇宙中的结果，而 $Y(0)$ 是他/她在接受了安慰剂的宇宙中的结果。药物的平均**总效应**（TE）就是这两个宇宙中平均结果的差异：

$$
\text{TE} = E[Y(1) - Y(0)]
$$

这个公式很优雅，但它没有提到我们的中介变量——[T细胞](@entry_id:138090)生物标志物 $M$。为了把它引入图中，我们需要更具体一些。结果不仅取决于药物，还取决于生物标志物的水平。因此，让我们定义 $Y(a, m)$ 为一个个体在接受处理 $a$ *并且*我们能以某种方式神奇地将其生物标志物水平设定为 $m$ 时的潜在结果。类似地，我们定义 $M(a)$ 为个体在接受处理 $a$ 时其生物标志物的自然水平。

现在我们可以用一个极其简单的规则将这些想法联系起来，这个规则称为**复合原则**：个体在处理 $a$ 下会得到的结果 $Y(a)$，必然是当其生物标志物在该处理下自然发展时所发生的结果。用我们的新语言来说，这意味着：

$$
Y(a) = Y(a, M(a))
$$

利用这个原则，我们可以将总效应重写为两个被完全设定的世界之间的比较：一个世界里，患者接受药物，其生物标志物自然响应；另一个世界里，患者接受安慰剂，其生物标志物也相应地自然响应。

$$
\text{TE} = E[Y(1, M(1)) - Y(0, M(0))]
$$

### 伟大的分解：一个简单的代数技巧

神奇之处就在这里。我们想把这个总效应分解成一个通过 $M$ 的[部分和](@entry_id:162077)一个不通过 $M$ 的部分。这个技巧，一个极其简单而又强大的操作，就是加上再减去一个巧妙构建的混合世界。如果我们给一个患者药物（$A=1$），但通过某种生物工程的壮举，将其[T细胞](@entry_id:138090)生物标志物维持在如果他们接受了安慰剂时本应达到的自然水平（$M(0)$），会发生什么？这是一个奇特的、“跨世界”的情景，由[潜在结果](@entry_id:753644) $Y(1, M(0))$ 来描述。

让我们从总效应方程中加上再减去这个混合世界中的平均结果：

$$
\text{TE} = E[Y(1, M(1)) - Y(1, M(0)) + Y(1, M(0)) - Y(0, M(0))]
$$

因为我们只是加上再减去了同一个量，所以等式仍然成立。但现在，利用期望的和等于和的期望这一简单事实，我们可以对这些项进行分组：

$$
\text{TE} = \underbrace{E[Y(1, M(1)) - Y(1, M(0))]}_{\text{自然间接效应}} + \underbrace{E[Y(1, M(0)) - Y(0, M(0))]}_{\text{自然直接效应}}
$$

这是一个意义深远的结果。它不是一个近似或一个[统计模型](@entry_id:755400)；它是一个完美的、代数上的分解。根据定义，药物的总效应就是这两个组成部分之和 [@problem_id:5203567] [@problem_id:5228004]。让我们给它们起上正式的名称，并理解它们的含义。

第二项，$E[Y(1, M(0)) - Y(0, M(0))]$，是**自然直接效应（NDE）**。仔细看它比较的是什么。在这两种情景中，中介变量都被固定在它在安慰剂下的自然值 $M(0)$。我们实际上阻断了通过中介变量的路径。唯一改变的是处理本身，从 $A=0$ 变为 $A=1$。因此，这一项捕捉了药物通过[T细胞](@entry_id:138090)生物标志物 $M$ *之外*的任何路径所产生的效应。它代表了从 $A$ 到 $Y$ 的直接箭头 [@problem_id:4557700]。

第一项，$E[Y(1, M(1)) - Y(1, M(0))]$，是**自然间接效应（NIE）**。在这里，处理在两种情景中都恒定在“开启”位置（$A=1$）。唯一改变的是中介变量，从它在安慰剂下的水平（$M(0)$）变为它在药物下的水平（$M(1)$）。因此，这一项捕捉了药物效应中*通过*它在[T细胞](@entry_id:138090)生物标志物中引起的变化来传递的那部分。它代表了路径 $A \to M \to Y$ [@problem_id:4541757]。

这些效应被称为“自然的”，因为它们不涉及将中介变量设定为某个对所有人都相同的、固定的水平（那将是**受控直接效应** [@problem_id:4828378]）。相反，它们使用的是在处理组或[对照组](@entry_id:188599)下，每个人会发生的*自然*的中介变量值的分布，这使得它们对于理解真实人群中发生的情况具有深远的现实意义 [@problem_id:4645985]。

### 更深层次的探讨：[交互作用](@entry_id:164533)的交响曲

但是，等等，正如物理学家喜欢说的那样，故事真的这么简单吗？只有一种方法可以分解总效应吗？如果，在我们的代数技巧中，我们加上和减去的是一个不同的混合世界呢？如果我们考虑的是患者接受安慰剂（$A=0$），但我们神奇地将他们的生物标志物设定为在药物下本应达到的水平（$M(1)$），那又会怎样？

让我们试试看。总效应仍然是 $E[Y(1, M(1))] - E[Y(0, M(0))]$。现在让我们加上再减去 $E[Y(0, M(1))]$：

$$
\text{TE} = \underbrace{E[Y(1, M(1)) - Y(0, M(1))]}_{\text{总自然直接效应}} + \underbrace{E[Y(0, M(1)) - Y(0, M(0))]}_{\text{纯自然间接效应}}
$$

看！我们得到了另一个完美的分解 [@problem_id:5203567]。但是这些项看起来不一样了。这不是矛盾，而是一种启示。它告诉我们，在存在**[交互作用](@entry_id:164533)**的情况下，“直接”和“间接”效应的概念本身可以被分解为不同的类型 [@problem_id:4972626]。

让我们来定义我们两个分解式中的所有四个量：
- **纯自然直接效应 (PNDE):** $E[Y(1, M(0)) - Y(0, M(0))]$ (我们最初的 NDE)
- **总自然间接效应 (TNIE):** $E[Y(1, M(1)) - Y(1, M(0))]$ (我们最初的 NIE)
- **总自然直接效应 (TNDE):** $E[Y(1, M(1)) - Y(0, M(1))]$
- **纯自然间接效应 (PNIE):** $E[Y(0, M(1)) - Y(0, M(0))]$

间接效应的两种定义（TNIE 和 PNIE）在什么时候会相同呢？TNIE 是在直接路径“开启”（$A=1$）时的间接效应，而 PNIE 是在直接路径“关闭”（$A=0$）时的间接效应。只有当中介变量对结果的影响，无论患者是否服用药物都相同时，它们才会完全相同。如果药物和生物标志物*相互作用*——例如，如果高水平的生物标志物在服用药物的患者中比在服用安慰剂的患者中更有益——那么 TNIE 和 PNIE 就会不同。[交互作用](@entry_id:164533)的存在创造了一个更丰富的因果故事，而这个“四向分解”给了我们讲述这个故事的语言 [@problem_id:4972626]。

### 从虚拟世界到真实数据

在我们的潜在结果的虚拟世界中，这一切都异常优雅。但我们如何从实际的观测研究中测量这些效应呢？这就是臭名昭著的**识别**难题。我们无法真正看到这些平行宇宙；我们只有一个来自已发生世界的数据集。

有人可能会认为，如果我们随机化处理 $A$，就万事大吉了。随机化对于识别*总效应*来说非常棒，因为它打破了处理与任何先前存在的患者特征之间的联系。但它对路径的第二部分 $M \to Y$ 没有帮助。中介变量不是随机的。生物标志物对药物反应强烈的患者可能与反应微弱的患者在某些方面有所不同，而这些差异会独立地影响他们最终的肿瘤结果。这就是中介-结果关系的**混杂**，它是一个巨大的难题 [@problem_id:4541757]。

为了从观测数据中识别自然直接和间接效应，我们需要满足一系列苛刻的条件，有时被称为**序贯可忽略性** [@problem_id:4545107]：
1.  **无未测量的暴露混杂：**我们必须测量了所有同时影响处理选择（$A$）和结果（$Y$）或中介变量（$M$）的基线协变量 $L$。
2.  **无未测量的中介混杂：**至关重要的是，我们还必须测量了所有同时影响中介变量（$M$）和结果（$Y$）的基线协变量。
3.  **无暴露引起的中介混杂：**这是最微妙的规则。处理（$A$）不能导致某个其他因素，而这个因素*本身*混杂了中介-结果关系 [@problem_id:4570238]。
4.  **正性：**对于任何类型的患者，他们必须都有一定的机会接受处理或对照。

满足这些条件的困难凸显了为什么从观测数据进行因果推断如此之难。例如，如果你只有**[横截面](@entry_id:143872)数据**——即你同时测量用药情况、生物标志物和肿瘤大小——你将面临几乎无法克服的挑战。你如何确定时间顺序？也许是肿瘤大小影响了生物标志物，而不是反过来（$Y \to M$）？如果没有基于外部生物学知识的强有力假设，仅凭数据本身无法告诉你答案，直接和间接效应的分解也就遥不可及 [@problem_id:4583631]。

区分**因果机制（中介作用）**和**统计偏倚（混杂）**是科学中最深刻的挑战之一 [@problem_id:4640726]。自然直接和间接效应的框架为我们提供了清晰、形式化的定义，以便我们能够推理这些问题，即使测量它们很困难。它为我们提供了一个镜头，去看清错综复杂的因果之网，让我们超越黑箱，更深刻地理解世界为何如此运转。

