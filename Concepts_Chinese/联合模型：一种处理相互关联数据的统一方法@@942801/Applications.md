## 应用与跨学科联系

有一个精彩的故事，或许是杜撰的，说的是一群学者试图理解一台复杂的机器。第一位学者拿起一个齿轮，把它擦亮，测量到微米级别，并以精美的细节描述其特性。第二位对弹簧做了同样的事，第三位对杠杆。经过多年的工作，他们拥有了一个图书馆，里面有对每个独立部件的完美描述，但他们仍然不知道机器是如何工作的。他们犯了分析的大忌：他们忘记了部件是被设计来*协同*工作的。

科学在追求简化的过程中，常常陷入这个陷阱。我们为一个过程建立一个模型，然后为第二个过程建立另一个模型，然后试图将它们粘合在一起。结果往往是笨拙、有偏倚，或者干脆就是错误的。它错过了本质要点，即在自然界中，事物很少是独立的。患者 deteriorating 的健康状况既影响其生物标志物水平，也影响其生存前景。电池单元的物理特性决定了其内部状态和材料属性是同一枚硬币的两面。联合模型是一个优美、统一的思想，即我们应该像自然构建世界那样构建我们的模型：从一开始就把所有活动部件连接起来。这是对理解交响乐的承诺，而不仅仅是分析单个音符。

### 生命、死亡与身体的低语

没有什么地方比医学更能体现事物的相互关联性。思考一下开发一种新的[抗癌药物](@entry_id:164413)所面临的挑战 [@problem_id:4993927]。我们给患者用药，并随时间追踪他们血液中的一种分子“药效动力学”（PD）生物标志物。我们还追踪他们的疾病需要多长时间才会进展。一种幼稚的方法是分开分析这两件事：“生物标志物下降了吗？”和“患者活得更长了吗？”但这忽略了整个故事！一个健康状况正在恶化的患者，更有可能同时出现生物标志物趋势恶化和疾病进展事件。此外，他们更有可能退出研究，这意味着他们的生物标志物测量 просто停止了。这两个过程——生物标志物的旅程和临床事件的倒计时——是深度交织的。

联合模型接受了这一点。它不仅仅是将两个分析粘合在一起；它构建了一个单一、统一的框架。模型的一部分描述了每个个体生物标志物的纵向轨迹，考虑了随机波动和测量误差。另一部分描述了随时间推移发生临床事件的风险。魔力在于它们之间的联系。模型为每个人设定了一个隐藏的或“潜在的”变量——你可以把它想象成他们潜在的真实健康状况。这个单一的潜在因素既影响他们生物标志物的路径，也影响他们疾病进展的风险。通过同时估计所有东西，模型可以了解真实、潜在的生物标志物轨迹的变化——而不仅仅是带噪的测量值——如何与临床结果相关联。它正确地理解了，一个停止提供数据的患者之所以这样做是有原因的，这个原因与我们试图建模的东西密切相关。

这个强大的思想不仅限于分子标志物。当我们研究患者自我报告的生活质量（QoL）[@problem_id:4742659]时，同样的原则也适用。患者对自己幸福感的感知，随时间测量，也是一个与其发生重大健康事件风险深刻相关的带噪信号。联合模型让我们能够穿透噪音，提出一个深刻的问题：“一个人生活质量的持续下降是否预示着一场即将到来的临床危机？”

该原则延伸到了疫苗开发的最前沿 [@problemid:2892899]。当我们测试一种新疫苗时，我们想知道它诱导的抗体水平是否真正具有保护作用。仅仅看到接种疫苗的人平均抗体水平更高、感染更少是不够的。我们想把这些点连接起来。联合模型通过同时追踪每个人抗体水平的升降和他们被感染的瞬时风险来做到这一点。这使我们能够量化抗体本身的保护效果，并且更强大的是，能够进行*动态预测*。我们可以问：“对于这个特定的人，考虑到他们到今天为止的抗体历史，未来几周他们的感染风险是多少？”这就是个性化医疗的实践，所有这一切都通过将两个过程作为一个整体来建模而成为可能。

有时，我们希望建模的事件本身就是一个级联。在慢性病中，患者可能会经历复发性事件，如疾病发作，同时还面临着终末事件的风险，如死亡 [@problem_id:4612151]。一个“联合脆弱模型”通过假设每个人都有一个潜在的“脆弱性”——一个未观察到的风险水平——来处理这个问题。这种脆弱性同时增加了他们的发作率和死亡风险。这揭示了一个有趣的微妙之处：即使疾病发作并*不因果地*增加死亡风险，观察到一个经历了多次发作的患者也为我们提供了强有力的证据，表明他们潜在的脆弱性很高。因此，我们对他们死亡风险的预期应该向上修正。该模型从整个事件历史中学习，以理解患者风险的全貌。

### 从数字代码到生命蓝图

联合建模的哲学超越了随时间追踪过程；它是一种解码复杂数据的基本策略。我们寻求的信息常常隐藏在被多个重叠效应混淆的信号中。解开它们的唯一方法就是联合建模。

考虑一下癌细胞中的基因组混乱 [@problem_id:4354753]。根据 Knudson 的“二次打击”假说，一个[肿瘤抑制](@entry_id:199120)基因通常必须失去其两个功能性拷贝才能驱动癌症。患者可能遗传了一个坏拷贝（第一次打击），我们想看看第二个健康的拷贝是否在肿瘤中丢失——这一事件称为[杂合性丢失](@entry_id:184588)（Loss of Heterozygosity, LOH）。当我们对肿瘤活检的 DNA 进行测序时，数据是一团糟。样本是肿瘤细胞和健康正常细胞的不纯混合物。此外，LOH 事件可能是“亚克隆的”，仅存在于一部分肿瘤细胞中。当我们查看来自两个不同等位基因（A 和 B）的读段比例时，信号是模糊的。一个弱信号可能意味着 LOH 是真实的，但肿瘤样本不纯。或者它可能意味着样本是纯的，但 LOH 仅存在于一个小亚克隆中。或者它可能意味着根本没有 LOH！

我们如何解决这个难题？我们寻找另一个线索。LOH 事件通常涉及染色体片段的物理删除。这不仅改变了等位基因比例，还减少了该区域的 DNA *总量*。这两个可观察量——等位基因比例和总[读段深度](@entry_id:178601)——受纯度、亚克隆性和 LOH 特定类型的影响是不同的。一个联合[生成模型](@entry_id:177561)就像一位侦探大师。它创建了一个单一的数学故事，根据纯度、克隆性和拷贝数等基本参数，*同时*预测预期的等位基因比例*和*预期的[读段深度](@entry_id:178601)。通过将这个单一模型同时拟合到两种数据类型，它可以成功地解开混杂因素，并对第二次打击是否真的发生做出稳健的判断。

这种“一次性建模所有数据”的逻辑同样出色地应用于医学成像 [@problem_id:4550692]。想象一位放射科医生试图从 MRI 扫描中分割出肿瘤。为了追踪其生长，他们首先需要将今天的扫描与上个月的扫描对齐——这个过程称为配准。一种常见但有缺陷的方法是序贯流程：首先，运行一个配准算法，*然后*，在对齐的图像上，运行一个分割算法。问题在于，配准步骤中的任何小错误都会被向下传递并固化到分割中，导致有偏倚的结果。

一个联合配准-[分割模](@entry_id:138050)型避免了这个陷阱。它构建了一个单一的目标函数，*同时*评分配准的质量和分割的质量。这两个过程现在可以进行“对话”。分割中一个新兴的、貌似合理的肿瘤形状可以提供信息，帮助 refining 配准。反过来，配准带来的更好对齐，使得分割能够更清晰地贴合肿瘤的边界。通过同时优化两者，模型找到了一个相互一致且不易受传播误差偏倚影响的解决方案。

### 工程世界：从电池到全球气候

联合建模的原则是如此基本，以至于它不仅出现在生物学和数据分析中，也出现在我们理解和控制物理及工程世界的尝试中。

让我们缩小到[锂离子电池](@entry_id:161992)的尺度 [@problem_id:3937375]。工程师们创建了复杂的基于物理的模型来预测电池的性能。这些模型包含固定参数（如锂离子的扩散系数，一种材料属性）和动态内部状态（如电极颗粒内锂的浓度梯度，它不断变化）。为了使模型有用，我们必须从实验数据中识别其参数。但在这里我们面临一个难题。在某些常见的实验条件下，一个参数的影响和一个未知初始状态对测量电压的影响几乎无法区分。较慢的扩散速率（一个参数）可能产生一个[电压降](@entry_id:267492)，看起来与从一个更陡峭的浓度梯度（一个状态）开始所产生的电压降一模一样。这是一场“可识别性”危机。

一种序贯方法——猜测初始状态，然后找到最佳参数——注定会失败。参数估计将会有偏倚，被扭曲以补偿对状态的错误猜测。解决方案是联合估计。我们把*参数*和*状态*都视为待同时估计的未知量。使用像[扩展卡尔曼滤波器](@entry_id:199333)（Extended Kalman Filter）这样的工具，在一个“增强”系统（其中参数只是不随时间改变的状态）上，我们让数据来决定。随着每个新的电压测量值的到来，算法会更新其对当前内部状态*和*真实参数值的信念，正确地划分误差并解开它们的混淆效应。

力学与统计学之间的这种协同作用也是现代药理学的核心 [@problem_id:4561790]。药物在血液中的浓度（药代动力学，PK）与其对身体的影响（药效动力学，PD）之间的关系由一个复杂的生理学网络支配。例如，患者的肝血流量既可能影响药物从体内清除的速度，也可能影响下游酶生物标志物的合成方式。为了对此进行机理建模，我们可以从一个[微分方程组](@entry_id:148215)构建一个联合模型。在这里，一个对每个人都独特的单一潜在“生理变量”——比如代表他们整体代谢能力——可以同时驱动模型中 PK 和 PD 组件的参数。这超越了简单的[统计相关性](@entry_id:267552)；这是一个其联系由物理定律之铁铸就的联合模型。

还有什么比为整个地球预测天气更宏大的应用呢？[@problem_id:4103723] 现代天气模型是通过一个称为 4D-Var 的过程初始化的，该过程旨在找到最能解释近期卫星观测的大气初始状态。但这里有一个复杂问题：卫星看到的东西（[辐射率](@entry_id:174256)）不仅取决于大气状态（温度、湿度），还取决于不确定的参数，如云的特性以及下方陆地和海洋表面的发射率。如果我们假定的表面[发射率](@entry_id:143288)值是错误的，我们对大气温度的估计就会有偏倚。解决方案再次是，联合求解它们。在这个[大规模优化](@entry_id:168142)问题中，控制向量被扩充，不仅包括描述大气初始状态的数百万个变量，还包括观测模型的参数。系统同时调整两者，找到与现实最一致的状态和参数组合。这是行星尺度的联合建模。

从单个细胞到全球气候，一个优美、统一的主题浮现出来。世界不是一系列可以逐一解决的独立问题。它是一个联系丰富的 interconnected 系统。理解它的最有效、最优雅、最真实的方法是建立能反映这一深刻现实的模型——能够看到整体而非仅仅是部分的模型。这就是联合模型的承诺及其深邃的智识满足感。