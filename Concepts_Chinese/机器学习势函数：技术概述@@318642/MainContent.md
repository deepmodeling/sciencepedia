## 引言
模拟原子和分子的行为是科学领域的重大挑战之一，其影响范围从[药物发现](@article_id:324955)延伸到新[材料设计](@article_id:320854)。这一挑战的核心在于[势能面 (PES)](@article_id:323827)——一个极其复杂的高维景观，它决定了所有的[原子间作用力](@article_id:318586)和化学转变。然而，对于除最小系统外的所有体系，使用传统的量子力学方法来绘制该表面在计算上是不可行的，这构成了科学进步的重大瓶颈。本文介绍的[机器学习势](@article_id:362354)函数 (MLPs) 是一种革命性的方法，它将量子物理的精确性与机器学习的效率相结合，从而弥合了这一差距。在接下来的章节中，我们将首先探讨 MLPs 背后的基础“原理与机制”，剖析其如何被构建以遵循自然界的基本定律。随后，我们将深入探讨其“应用与跨学科联系”，展示这些强大的工具如何被用于预测材料性质和模拟复杂现象，从而改变我们理解和设计原子世界的能力。

## 原理与机制

想象你是一个巨人，想要预测在一片广阔无垠的无形地貌上滚动的弹珠的路径。这些弹珠就是原子核，分子世界中的“重量级选手”。它们所穿越的这片无形地貌就是**[势能面 (PES)](@article_id:323827)**。这个表面并非由岩石和土壤构成，而是一个纯粹的[能量景观](@article_id:308140)，由围绕原子核飞速运动的电子所雕琢而成。根据经典的 **Born-Oppenheimer 近似**，由于电子比原子核轻得多、快得多，我们可以想象，对于原子核的任何给定排布，电子都能瞬间调整到其最低能量状态。该[电子排布](@article_id:370572)的能量，加上原子核之间的简单[静电排斥](@article_id:322531)力，*就是*[势能面](@article_id:307856)在这一特定构型下的值。[@problem_id:2784636] 这个[能量景观](@article_id:308140)主宰着一切：分子的稳定构型（山谷）、[化学反应](@article_id:307389)的路径（山口）以及[化学键](@article_id:305517)的[振动](@article_id:331484)（在谷底的摇摆）。

我们的宏大挑战就是要绘制出这个景观。但这里存在一个宇宙级的玩笑：这并非一个简单的三维景观。对于一个包含 $N$ 个原子、每个原子都可以在三维空间中自由移动的体系，该景观存在于一个惊人的 $3N$ 维空间中。即使对于一个简单的水分子 ($\text{H}_2\text{O}$)，我们也需在 9 维空间中导航。对于一个小蛋白质，我们面临的是一个数千维的空间。仅仅尝试通过在网格点上计算能量来绘制这个景观，是一项指数级增长的、毫无希望的任务——即臭名昭著的“维度灾难”。我们需要一种更巧妙、更具物理意义的方法。

### 近视性的力量

第一个直觉上的飞跃是认识到，原子就像拥挤房间里的人一样，主要关心的是它们的直接邻居。单个原子的能量贡献并不取决于宇宙中的所有其他原子，甚至不取决于同一培养皿中的所有其他原子。它最强烈地依赖于与之成键的以及紧邻其周围的原子。这个思想被称为**局域性**（locality）。

这不仅仅是一个方便的猜测，而是量子力学中一个深刻的原理，由诺贝尔奖得主 Walter Kohn 将其形式化为**[近视原理](@article_id:344422)** (principle of nearsightedness)。[@problem_id:2648636] 在电绝缘体或[半导体](@article_id:301977)这类材料中——这些材料具有电子必须跨越才能导电的“[带隙](@article_id:331619)”——电子海洋中的任何局域扰动，比如一个晃动的原子，所产生的涟漪都会以指数形式迅速衰减。该体系在根本上是局域的。对于这些材料，假设一个原子的能量仅取决于某个截断距离内的邻居，是一个极好的近似。

在金属中，情况更为微妙。在零温下，由于没有[带隙](@article_id:331619)，涟漪可以传播得更远，其衰减遵循幂律而非指数律。这种长程的量子“喋喋不休”使得纯局域模型更具挑战性。然而，在任何现实世界的有限温度下，热扰动会模糊掉尖锐的电子特征，从而恢复了指数衰减的局域性。[@problem_id:2648636] 这一深刻的物理洞见为我们提供了所需的凭据：我们可以将绘制一个巨大的、高维景观这一不可能完成的任务，分解成大量小型的、可管理的局域问题。

### 不可违背的游戏规则

在构建模型之前，我们必须尊重自然界的[基本对称性](@article_id:321660)。物理定律不会因为你在纽约或东京，或者你面向北方或南方而改变。我们的[势能面](@article_id:307856)也必须遵循这些相同的对称性。

1.  **[平移和旋转](@article_id:348766)[不变性](@article_id:300612)**：一个孤立分子的能量，无论其在空间中的位置或朝向如何，都是相同的。这意味着能量只能依赖于原子的*相对*位置——即它们之间的距离和角度——而不是它们在空间中的绝对坐标。[@problem_id:2796818]

2.  **[置换](@article_id:296886)不变性**：量子力学告诉我们，[全同粒子](@article_id:313606)是真正不可区分的。如果你有一个水分子 ($\text{H}_2\text{O}$)，并且神奇地交换了它的两个氢原子，宇宙是无法分辨出差异的。其能量必须完全相同。我们的模型必须对我们分配给相同原子的标签“视而不见”。[@problem_id:2796818]

这些不变性不是建议，而是严格的约束。它们带来了一个优美的推论。作用在原子上的力就是[能量景观](@article_id:308140)的斜率（负梯度，$-\nabla E$）。如果能量景观本身是不变的，那么从数学上可以推导出，力必须以一种完美匹配的方式，即**等变** (equivariant) 的方式进[行变换](@article_id:310184)。如果你旋转分子，每个原子上的力矢量也必须旋转完全相同的角度。[@problem_id:2784682] 构建模型最优雅的方式，不是去教它这些规则，而是从结构上就让它想违反都违反不了。

### 架构师的蓝图

那么，我们如何设计一个通过构造就能实现局域性并尊重自然界所有对称性的模型呢？由 Jörg Behler 和 Michele Parrinello 开创的架构，是物理推理的典范之作。[@problem_id:2784673]

首先，我们采用**乐高原理**：体系的总能量就是每个原子各自能量贡献的总和。
$$
E = \sum_{i=1}^{N} \varepsilon_i
$$
这种简单的加和分解非常强大。它自动确保了体系的能量随其尺寸线性增长（**广延性**），这是一个至关重要的属性。它还优雅地处理了[置换](@article_id:296886)[不变性](@article_id:300612)：如果你交换两个相同的原子，比如原子 5 和原子 8，你只是在求和中交换了 $\varepsilon_5$ 和 $\varepsilon_8$ 的顺序，这对总和没有影响。[@problem_id:2648581] [@problem_id:2784673]

接下来，我们规定每个原子能量 $\varepsilon_i$ 是其局域环境的函数。但我们如何以一种内在地对[平移和旋转](@article_id:348766)不变的方式来描述这个环境呢？我们需要一个定量的**“指纹”**或**描述符** (descriptor)。想象一下，为原子 $i$ 周围的邻域拍摄一张快照。描述符的工作就是将这张快照转换成一个定长的数值向量，即使整个分子被移动或旋转，这个向量也保持不变。

一个绝佳的例子是 **Behler-Parrinello [对称函数](@article_id:356066)**。[@problem_id:2784613]
径向对称函数 $G^2$ 就像一系列柔和的声纳脉冲，测量在不同距离处中心原子的邻居密度。其形式可能如下：
$$
G^2_i = \sum_{j \ne i} \exp(-\eta (R_{ij} - R_s)^2) f_c(R_{ij})
$$
其中 $R_{ij}$ 是原子 $i$ 和 $j$ 之间的距离，$f_c$ 是一个平滑的“截断函数”，它使贡献在超过一定范围后变为零。通过使用许多具有不同“探测距离” $R_s$ 的这[类函数](@article_id:307386)，我们构建了一个详细的径向分布图。

角向[对称函数](@article_id:356066) $G^4$ 则捕捉三维排布信息，描述了原子三元组之间的角度 $\theta_{ijk}$。例如：
$$
G^4_i = 2^{1-\zeta} \sum_{j,k \ne i, k>j} (1 + \lambda \cos \theta_{ijk})^{\zeta} \times (\text{radial terms})
$$
由于这些函数是基于距离和角度构建的，它们自动具有[不变性](@article_id:300612)。它们是我们对称性约束的数学体现。

最后，有了每个原子的[不变性](@article_id:300612)指纹 $\mathbf{G}_i$，我们需要一个灵活的学习器来发现这个指纹与原子能量贡献之间的复杂关系。这项工作非常适合一个小型**[人工神经网络](@article_id:301014) (ANN)**。我们为每种化学元素训练一个独立的 ANN，学习该元素独特的化学性质所对应的映射关系：
$$
\varepsilon_i = \text{ANN}^{(Z_i)}(\mathbf{G}_i)
$$
其中 $Z_i$ 是原子 $i$ 的元素类型。这个完整的架构——对所有原子求和，每个原子的能量由作用于[不变性](@article_id:300612)局域指纹的神经网络决定——是许多现代机器学习[势函数](@article_id:332364)的核心。[@problem_id:2784673]

### 从量子神谕中学习

我们从哪里获得“正确”的能量和力来训练我们的[神经网络](@article_id:305336)呢？我们从一个量子“神谕”那里获取：大规模的电子结构计算，最常用的是**[密度泛函理论 (DFT)](@article_id:365703)**。我们对特定的原子排布进行 DFT 计算，以获得高精度的能量和力，然后我们告诉模型：“对于这个指纹，你的输出应该与这个能量相匹配。”

这个过程本身需要小心。用于训练的力必须是我们所建模的能量面的真实梯度。得益于 **Hellmann-Feynman 定理**，我们知道，如果我们的 DFT 计算执行正确——即完全收敛并考虑了所有依赖关系——那么计算出的力确实是 DFT 能量的精确梯度。[@problem_id:2837976] 这保证了我们训练数据的内部一致性。

但这里有个问题。有些[量子计算](@article_id:303150)比其他的更具“神谕”性。存在一整套方法的层级体系，从更快、精度较低的方法，到像 **CCSD(T)** 这样的“金标准”方法，后者极其精确但计算成本极高，只能用于小分子。[@problem_id:2648607] 一种非常实用的策略叫做 **$\Delta$-学习** (Delta-learning)，即不让机器从头学习全部能量，而是学习将廉价的 DFT 计算提升到金标准精度所需的*修正量*。
$$
E_{\text{gold standard}} = E_{\text{cheap DFT}} + \Delta E
$$
修正项 $\Delta E$ 通常是一个让机器学起来更简单、更平滑的函数。我们可以为成千上万个结构计算 $E_{\text{cheap DFT}}$，但只为少数几个结构计算昂贵的 $E_{\text{gold standard}}$，机器就能学习到它们之间的关系。这就像请一位专家，他只需瞥一眼学生作业并提供几处关键修正，而无需重做整个作业。[@problem_id:2648607]

### 洞悉全局：超越[近视](@article_id:357860)性

我们的局域、“近视”模型取得了巨大成功，但其本质也造成了一个盲点：长程力。典型的例子是离子间的[静电相互作用](@article_id:345679)，它以 $1/r$ 的形式缓慢衰减。一个具有有限[截断半径](@article_id:297161)（比如 8 埃）的模型，对于 10 埃以外的离子是完全“看不见”的。

我们不能简单地附加一个标准的长程物理计算（如用于[静电学](@article_id:300932)的 Ewald 求和），因为这会导致**重复计算**。我们的[神经网络](@article_id:305336)在学习局域环境时，已经隐式地学习了该静电相互作用的短程部分。[@problem_id:2648598]

解决方案是[残差学习](@article_id:638496)的又一个优雅应用。我们将参考能量分成两部分：一部分是标准物理模型可以完美处理的（长程静电作用），另一部分是其余的所有内容。
$$
E_{\text{reference}} = E_{\text{long-range physics}} + E_{\text{short-range residual}}
$$
我们训练神经网络*只*学习短程[残差](@article_id:348682)部分。在预测时，我们运行快如闪电的 MLP，并将其结果与解析的长程计算结果相加。这种混合方法让我们两全其美：既有机器学习的速度和局域[化学精度](@article_id:350249)，又有长程物理的严格正确性，且没有重复计算。[@problem_id:2648598] [@problem_id:2648636]

### 成熟的标志：知道自己不知道什么

一个真正智能的模型不仅能给出答案，还知道自己何时可能出错。现代 MLP 正开始通过量化自身的不确定性来做到这一点。这种不确定性有两种。[@problem_id:2784631]

**[认知不确定性](@article_id:310285)**（Epistemic uncertainty，即‘我不知道什么’）是模型因缺乏数据而产生的自我怀疑。如果我们要求模型预测一个与其[训练集](@article_id:640691)中任何构型都大相径庭的构型的能量，它将表现出很高的[认知不确定性](@article_id:310285)。这是可以减少的：通过向模型展示该区域的更多数据，我们可以降低这种不确定性。

**[偶然不确定性](@article_id:314423)**（Aleatoric uncertainty，即‘什么是不可知的’）是训练数据本身固有的模糊性或噪声。如果我们的量子神谕自身存在数值局限性并提供带有轻微噪声的答案，那么这种不确定性就是[偶然不确定性](@article_id:314423)。无论我们从同一个有噪声的神谕中收集多少数据，这种不LEC定性都会存在。

通过报告这些不确定性，[机器学习势](@article_id:362354)函数可以指导自身的改进，在[认知不确定性](@article_id:310285)高的区域请求新的[量子计算](@article_id:303150)。这将模拟从一个被动过程转变为一个[主动学习](@article_id:318217)循环，从而加速科学发现的步伐。这标志着这些模型正从简单的[函数逼近](@article_id:301770)器演变为科学事业中真正的合作伙伴。