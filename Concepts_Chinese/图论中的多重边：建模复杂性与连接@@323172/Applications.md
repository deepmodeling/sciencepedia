## 应用与跨学科联系

在我们完成了对图的基本原理的探索之后，人们可能会倾向于认为简单图——一个由点和单线构成的简洁世界——就是故事的结局。它是一个美丽的抽象，就像一副完美的骨架。但现实世界，以其所有光荣而混乱的复杂性，很少如此简单。自然、工程师，甚至我们自己的社交互动，往往是冗余、分层和多方面的。为了捕捉这种丰富性，我们需要让我们的图骨骼上长出更多的肉。我们必须拥抱**多重边**的概念。

当我们允许两个顶点之间由多于一条边连接时，会发生什么？起初，这似乎只是一个微不足道的复杂化。但通过探索这个简单的泛化会引向何方，我们踏上了一段非凡的旅程。我们将看到，规则中的这一小小的改变，如何让我们能够以更高的保真度为世界建模，从平凡到壮丽。我们将发现它如何迫使我们更深入地思考我们的[算法](@article_id:331821)，而且最美妙的是，它如何揭示了像城市规划、计算机科学、化学，甚至人类大脑研究这些看似不相关的领域之间深刻、意想不到的统一性。

### 为更现实的世界建模

让我们从一个我们可以想象的东西开始：一个城市。如果我们将火车站建模为顶点，轨道建模为边，那么对于一个简单的网络，简单图已经足够好。但是，在一个设计问题中，像 Veridia 这样的繁华都市呢？[@problem_id:1400576] 在中央广场和科技园之间，可能既有本地轨道，也有一条平行的快速轨道。我们如何同时表示两者？根据定义，[简单图](@article_id:338575)禁止这样做；它只能告诉我们连接*存在*，而不能告诉我们有多少种或是什么样的连接。通过允许多重边，我们的图突然变成了一张更忠实的地图。我们可以用一条边表示本地线路，另一条表示快速线路，甚至可以给它们分配不同的属性，比如旅行时间或容量。如果科技园有一条维修轨道，从车站出发又回到同一个车站呢？这是一个“环”，一条连接顶点到自身的边。一个允许多重边和环的图——一个**[伪图](@article_id:337682)**——为我们提供了完美描述这种现实世界基础设施的语言。同样的想法也适用于一栋建筑中由本地电梯和快速电梯连接的两个楼层；它们是并行的交通连接，最好用多重边来表示 [@problem_id:1400583]。

当我们考虑像通信网络这样的动态、有向系统时，对更丰富模型的需求变得更加明显。想象一下，试图绘制一家公司内部的电子邮件流量图 [@problem_id:1494720]。如果我们使用一个简单的[无向图](@article_id:334603)，这个模型是完全不够的。首先，从 Alice 到 Bob 的一封电子邮件与从 Bob 到 Alice 的一封电子邮件是不同的；我们需要*有向*边。其次，如果 Alice 给 Bob 发了三封独立的电子邮件，简单图只能显示一个单一的连接，丢失了所有关于通信量的信息。最后，Alice 可能会给自己发一封邮件作为提醒，这是[简单图](@article_id:338575)无法表示的行为，因为它禁止环。一个**有向[多重图](@article_id:325287)**一次性解决了所有这些问题。从 Alice 到 Bob 的一封邮件是一个有向边 $(A, B)$。三封这样的邮件就是从 $A$到 $B$ 的三条不同的平行边。一封发给自己的邮件就是一个环 $(A, A)$。突然间，我们的抽象图变成了一个强大的工具，安全分析师可以用它来可视化通信流，发现不常有的模式，并理解网络的真实结构。抽象不再是对现实的苍白模仿；它是一个高保真的表示。

### 调整我们的工具：[多重图](@article_id:325287)上的[算法](@article_id:331821)

所以，我们可以构建更现实的模型。但我们还能用它们来解决问题吗？我们许多最强大的图[算法](@article_id:331821)最初都是为简单图设计的。当我们将它们应用于[多重图](@article_id:325287)时会发生什么？这个问题迫使我们更仔细地思考我们[算法](@article_id:331821)的核心逻辑。

考虑这样一个问题：设计一个[光纤](@article_id:337197)网络，以最低成本连接一组数据中心 [@problem_id:1392234]。我们有一个[多重图](@article_id:325287)，其中平行边代表不同供应商在相同两个中心之间铺设电缆的竞争报价，每个报价都有不同的成本。为了找到[最小生成树](@article_id:326182)（MST）——连接所有中心的最便宜[子网](@article_id:316689)络——我们想使用像 Prim [算法](@article_id:331821)这样的经典工具。但标准版本[期望](@article_id:311378)的是一个[简单图](@article_id:338575)。我们该怎么办？答案非常直观。如果中心 A 和中心 B 之间有三个可能的连接，成本分别为 10 万美元、12 万美元和 15 万美元，你会为你的最低成本网络*考虑*哪一个？当然是只考虑最便宜的那一个！其他更昂贵的平行链路与 MST 问题无关。所以，[预处理](@article_id:301646)步骤很简单：对于每一对顶点，我们丢弃除了权重最小的那条平行边之外的所有边。我们还丢弃任何自环，因为它们无助于连接不同的中心。经过这次“清理”后，我们得到了一个简单图，Prim [算法](@article_id:331821)可以在其上完美运行，从而得到原始更[复杂网络](@article_id:325406)的真实 MST。

现在，让我们问一个关于网络的不同问题。我们不考虑成本，而是考虑容量。想象一个数据网络，节点之间存在平行链路，代表不同的物理电缆 [@problem_id:1408940]。我们想找到从源点 $S$ 到汇点 $T$ 的最大数据流。如果从节点 A 到 C 有一条容量为 10 Gb/s 的链路，还有一条容量为 5 Gb/s 的第二条平行链路，那么 A 和 C 之间的总容量是多少？与 MST 问题中我们取最小值不同，在这里我们的直觉正确地告诉我们要将它们**相加**。总可[能流](@article_id:329760)量就是各个容量的总和，即 15 Gb/s。同样，为了使用标准的的[最大流算法](@article_id:638949)，我们可以通过将任意一组平行的有向边替换为一条单一的边来预处理[多重图](@article_id:325287)，该边的容量是各个边容量的总和。

注意这里令人愉快的对比。为了解决一种问题（MST），我们看一组平行边然后说：“给我最好的那一个。”为了解决另一种问题（最大流），我们说：“给我所有这些的总和。”多重边的存在迫使我们超越一刀切的方法，去问：在我试图解决的问题背景下，这些平行连接的物理或逻辑意义是什么？

### 一条统一的线索：从代码到化学再到认知

科学和数学中一个强大概念的真正魔力，不仅在于它能解决为其设计的问题，还在于它在完全不相关的领域中出人意料地出现。[多重图](@article_id:325287)就是这样一条统一线索的绝佳例子。

让我们进入[计算复杂性](@article_id:307473)的抽象世界。[哈密顿路径问题](@article_id:333506)询问图中是否存在一条恰好访问每个顶点一次的路径。对于简单图，这个问题是著名的“[NP完全](@article_id:306062)”问题，意味着它在计算上非常困难；没有已知的有效[算法](@article_id:331821)来解决它 [@problem_id:1457558]。现在，如果我们转向[多重图](@article_id:325287)呢？比如说，我们是一家物流公司，在一些城市之间，我们有多个不同的飞行走廊。拥有更多选项是否更容易找到一条访问每个配送中心的单一路径？答案可能出人意料，是“否”。问题的根本困难仍然没有改变。如果一条[哈密顿路径](@article_id:335457)需要从 A 到 B 的连接，那么在它们之间有一条边或十条平行边同样满足这个要求。边的多重性并没有简化寻找正确顶点序列的核心组合难题。该问题仍然是 NP 完全的。

在类似的[结构洞](@article_id:299099)察力方面，考虑[图着色问题](@article_id:327029) [@problem_id:1495936]。[色多项式](@article_id:330972)告诉我们用 $k$ 种颜色为图的[顶点着色](@article_id:331191)，使得没有两个相邻顶点颜色相同的方法有多少种。如果我们有一个在顶点 $v_1$ 和 $v_2$ 之间有三条边的[多重图](@article_id:325287)，它的[色多项式](@article_id:330972)是什么？第一条边已经迫使 $v_1$ 和 $v_2$ 必须有不同的颜色。第二条和第三条边再次增加了相同的约束。它们是多余的。为这个[多重图](@article_id:325287)着色的方法数与为只包含 $v_1$ 和 $v_2$ 之间一条边的简单图着色的方法数完全相同。对于这个特定的属性，边的[多重性](@article_id:296920)就消失了。

这些理论见解很优雅，但最惊人的联系来自于我们观察物理世界的时候。考虑一个化学反应网络 [@problem_id:2646201]。一组分子，称为“复合物” $y_1$，可以反应形成另一个不同的复合物 $y_2$。但在化学中，同一个转化过程通常可以通过几种不同的微观途径发生，每条途径都有其特有的[速率常数](@article_id:375068)。我们如何模拟从 $y_1$ 到 $y_2$ 的总转化速率？我们将复合物建模为顶点，将每条不同的[反应途径](@article_id:333053)建模为一条有向边。从 $y_1$ 到 $y_2$ 的多条途径就变成了多条平行边。每个反应的速率是其边的权重。总转化速率就是所有平行途径速率的总和。这与我们用于[最大流问题](@article_id:336335)的逻辑完全相同！其底层的数学结构——图的[加权拉普拉斯算子](@article_id:638806)——处理并行[化学反应](@article_id:307389)的方式与处理并行数据管道的方式完全一样。这是科学原理统一性的一个惊人例子。

最后，让我们转向可能是已知最复杂的[多重图](@article_id:325287)：人脑。 “[神经元学说](@article_id:314530)”假定大脑由称为[神经元](@article_id:324093)的离散、独立的细胞组成，它们在称为突触的专门连接处进行通信。我们如何形式化这个错综复杂的布线图，即连接组？有向[多重图](@article_id:325287)提供了一种惊人准确的语言 [@problem_id:2764740]。每个[神经元](@article_id:324093)是一个顶点。从[神经元](@article_id:324093) $i$ 到[神经元](@article_id:324093) $j$ 的每个突触都是一个有向边 $(i, j)$。至关重要的是，两个[神经元](@article_id:324093)之间通常由数十甚至数百个独立的突触连接。这些不是一个连接；它们是许多不同的平行边，每一条都是一个微小的生物机械。一个[神经元](@article_id:324093)与自身形成突触，即“自突触”，是一个自环。这种形式主义不仅仅是近似生物学；它实例化了生物学。[神经元](@article_id:324093)的离散性被顶点的离散性所捕捉。[化学突触](@article_id:307454)处[信息流](@article_id:331691)的有[向性](@article_id:305078)被边的方向所捕捉。多个不同突触接触的存在被平行边的概念完美地捕捉。有向[多重图](@article_id:325287)远非仅仅是一种数学上的好奇心，它已成为神经科学家不可或缺的工具，为他们描述思想结构本身提供了最基本的语法。

从城市规划到驱动我们数字世界的[算法](@article_id:331821)，从分子的舞蹈到心智的架构，允许多个点之间存在多于一个连接这个简单而强大的想法，丰富了我们的理解，并揭示了将宇宙联系在一起的深刻的结构相似性。