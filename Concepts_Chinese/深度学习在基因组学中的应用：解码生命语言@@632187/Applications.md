## 应用与跨学科联系

在探究了深度学习模型工作原理之后，我们现在来到了探索中最激动人心的部分：看它们在实践中的应用。如果说上一章是关于学习一门新语言的语法，那么这一章就是关于阅读它的诗篇、创作我们自己的诗句，甚至揭开它的古老历史。正是在这里，在真实生物学这个纷繁、美丽而复杂的世界里，这些计算工具才真正焕发生机。它们不再是抽象的算法，而是我们探索发现的伙伴——一种能看见无形之物的新型显微镜，一支能编辑生命文本的新型笔，甚至是一台能窥探我们进化过去的新型时间机器。

### 阅读生命之书：从序列到功能

基因组，以其数十亿的字母，是一本规模宏大且内容精妙的书。几十年来，科学家们辛勤地对其进行注释，标记出编码蛋白质的“基因”。然而，这些蛋白质编码区域仅占这本书中极小的一部分——不到2%。其余部分呢？这片广阔而神秘的区域，曾被轻蔑地称为“垃圾DNA”，如今被认为充满了调控指令、非编码基因和功能元件，它们共同指挥着生命复杂的交响乐。我们究竟该如何开始阅读基因组的这片“暗物质”呢？

这正是深度学习的绝佳用武之地。想象一个[卷积神经网络](@entry_id:178973)（CNN）扫描原始DNA序列，即一串A、C、G和T。它的滤波器，就像一双训练有素的眼睛，学习识别代表功能的重复模式，即“基序”。但挑战在于，基因组的语法规则并非总是局部的。一个基因一端的信号可能会影响到遥远另一端的另一个基因。为了捕捉这些[长程依赖](@entry_id:181727)关系，我们可以使用巧妙的架构，例如带有“[空洞卷积](@entry_id:636365)”的网络，它能让网络同时看到多个尺度上的模式，连接相隔数百甚至数千个碱基的特征。通过在已知功能元件（如长[非编码RNA](@entry_id:268179) (lncRNAs) 或[微小RNA](@entry_id:149310)）的样本上进行训练，模型学会了在未知领域中发现它们，直接从序列本身绘制出一幅丰富的功能图谱[@problem_id:2373333]。

但阅读基因组不仅仅是识别各个部分；它关乎理解它们的活动。以[假基因](@entry_id:166016)为例，它们被认为是真实基因的失效、化石化副本。它们都沉寂了吗？还是有些仍然“存活”，被活跃地转录成RNA？[深度学习模型](@entry_id:635298)可以扮演侦探的角色。通过检查[假基因](@entry_id:166016)*两侧*的DNA序列，它可以学会发现活跃调控的微妙信号，例如启动转录的[启动子](@entry_id:156503)基序。然而，这项侦探工作需要极其小心。模型可能会作弊！例如，它可能学会了靠近非常活跃、不相关基因的[假基因](@entry_id:166016)更有可能被转录，这仅仅是由于“通读”效应。为了防止这种混淆因素，我们必须在方法上严谨，例如，在不同的[染色体](@entry_id:276543)上训练和测试模型，以确保它学习的是普遍的生物学规则，而不仅仅是基因组邻域的局部特性[@problem_id:2382352]。

奇妙的是，我们不必为每个新任务都从头教模型整个DNA语言。机器学习的进步为我们提供了一个强大的概念，叫做**[迁移学习](@entry_id:178540)（transfer learning）**。我们可以拿一个巨大的模型，在海量的未标记DNA语料库上进行预训练——比如整个人类基因组。模型在此阶段的任务很简单，有点像“填空”游戏，它学习从上下文中预测被掩盖的[核苷酸](@entry_id:275639)。通过这样做，它建立起对基因组句法和语法的深刻内在理解。这个预训练的或称为“基础”的模型，随后可以仅用少量标记数据，被调整用于一个新的特定任务，例如寻找特定蛋白质的结合位点。这个[适应过程](@entry_id:187710)被称为**微调（fine-tuning）**。

在[进化生物学](@entry_id:145480)中有一个与此完美对应的概念：**功能变异（exaptation）**，即一个为某种目的进化出的性状被挪作他用。羽毛最初可能为保暖而进化，后来才被用于飞行。类似地，我们的模型为理解基因组语言这一通用目的所学习到的特征，被“功能变异”并提炼，用于预测蛋白质结合位点这一特定功能[@problem_id:2373328]。这让我们能站在海量未标记数据的肩膀上，以非凡的效率解决特定的问题。

### 编写生命之书：基因组工程

随着阅读基因组能力的到来，编写它的愿望也随之产生。像[CRISPR-Cas9](@entry_id:136660)这样的技术赋予了我们前所未有的DNA编辑能力，为治疗[遗传性疾病](@entry_id:261959)开辟了革命性的可能性。但这项技术虽然强大，却非完美。我们如何设计出最佳的“指导RNA”来精确地将CRISPR机制引导到基因组的正确位置？我们又如何预测编辑的效率和纯净度？

这是一个预测和设计问题，也是[深度学习](@entry_id:142022)的又一个完美应用。我们可以在数千次过往CRISPR实验的结果上训练一个模型。模型学习指导RNA序列、目标DNA序列与最终编辑效率之间的微妙相互作用。例如，它可以学到某些[核苷酸](@entry_id:275639)组合会使指导RNA比其他组合更有效。这使我们能从试错过程转向理性的、计算机辅助的设计过程[@problem_id:2946981]。

更重要的是，为了使这些模型在实验室中真正有用，它们的预测需要超越简单的排序。一个计划进行大规模筛选的实验者不仅需要知道哪些指导RNA“更好”，还需要知道它们*有多好*。这就要求模型的输出分数被**校准（calibrated）**为真实的概率。一个校准后的0.8分应该意味着该指导RNA确实有大约80%的成功机会。模型抽象分数与具体实验现实之间的这种联系至关重要。例如，如果你需要某个基因的指导RNA中至少有一个能以95%的确定性工作，你可以使用一个校准过的模型来决定是设计四个、五个还是六个指导RNA来达到这个目标灵敏度，$S = 1 - (1-p)^g$，其中$p$是单个指导RNA的成功概率，$g$是指导RNA的数量[@problem_id:2946981]。

技术正从简单的切割发展到“碱基编辑”，这是一种更精确的编辑形式，它能将一个DNA字母化学地改变为另一个，就像查找和替换功能一样。这里的挑战更大。我们不仅要预测编辑的*效率*（多少比例的细胞被编辑），还要预测其*纯度*（多少比例的编辑是正确的，没有不想要的副产物）。为了解决这个问题，我们的模型必须变得更加复杂，整合来自多个来源的信息。它们可以结合局部DNA序列、指导RNA序列以及周围的表观遗传图景——比如[染色质可及性](@entry_id:163510)等特征，它告诉我们该位置的DNA是多么“开放”或“封闭”。通过训练一个多任务模型来同时预测效率和纯度，我们可以设计出不仅强大，而且极其精确的碱基编辑器[@problem_id:2792566]。

### 破译深层语法：从一维序列到三维结构

到目前为止，我们大多将基因组视为一维的字母串。但在细胞微小的细胞核内，这条如果拉直长达两米的细丝，被折叠成一个极其复杂的三维结构。这种“基因组折纸”并非随机；它对功能至关重要。被称为“增[强子](@entry_id:158325)”的调控元件可能与它们控制的基因相距数百万个字母，只有通过在三维空间中形成环路才能找到它们。

预测这些增[强子](@entry_id:158325)-[启动子](@entry_id:156503)相互作用是现代生物学的一大挑战。[深度学习](@entry_id:142022)再次提供了一条前进的道路。我们可以构建整合模型，同时从多种数据类型中学习。一个模型可能使用CNN来“读取”候选增强子和[启动子](@entry_id:156503)的一维序列。然后，它可以整合二维的[表观遗传](@entry_id:186440)数据[轨道](@entry_id:137151)，例如标记活跃区域的组蛋白修饰。最后，它可以从像Hi-C这样的实验提供的三维邻近性数据中获取信息，这些实验绘制了整个基因组的物理[接触图](@entry_id:267441)。通过整合这些一维、二维和三维信息源，模型学会了预测哪些长程连接是功能性的。这项任务的难度因这些连接在不同细胞类型中可能不同而加剧。一个真正强大的模型必须能够泛化，在它从未见过的新细胞类型中预测连接图，这是一个具有巨大复杂性和重要性的“零样本”预测问题[@problem-id:2942957]。

### 扩展工具箱：实用与进化的新视野

强大工具的美妙之处在于其多功能性。除了宏大的挑战，[基因组学](@entry_id:138123)中的深度学习还解决了许多其他引人入胜的问题。

在实践层面，它可以充当质量控制的哨兵。当我们对生物样本进行测序时，有时会混入来自其他生物的污染。我们如何发现这些外来序列？虽然可以将每一条DNA读长与一个巨大的已知基因组数据库进行比对，但CNN可以“免比对”地完成这项工作。它学习目标生物特有的“方言”——即短[核苷酸](@entry_id:275639)词（$k$-mers）的独特频率。来自外来物种的读长，因其方言不同，将被标记为“非目标”，或者更微妙地，会产生低置信度的预测，这标志着一个值得仔细检查的“[分布](@entry_id:182848)外”样本[@problem_id:2382320]。这表明，即使是一个简单的分类器也能执行非常有用的任务。

当然，我们的工具必须随着我们技术的发展而发展。一个在旧的短读长测序仪数据上训练的基因查找程序，在新的长读长技术产生的数据上会表现得非常糟糕，因为后者的错误模式完全不同（主要是在重复的“均聚物”区域出现[插入和删除](@entry_id:178621)）。模型关于序列“应该是什么样子”的内部假设被打破了。唯一符合原则的解决方案是回到源头：用新技术的数据重新训练模型的组件，明确地教会它新类型的错误以及如何处理它们。这是一个至关重要的教训：这些模型并非魔法；它们是统计机器，必须与它们要解释的数据保持同步[@problem_id:2383776]。

也许这些技术最令人叹为观止的应用是它们充当时间机器的能力。我们从化石证据中知道，现代人类曾与像尼安德特人这样的古人类进行过杂交。这些事件的印记写在我们的DNA中。但是“幽灵”种群呢——那些我们没有化石DNA的古老祖先呢？我们能找到他们的踪迹吗？这个想法既优雅又强大。我们使用进化论，编码在一个溯祖模拟中，来生成*本应*由这种古老基因混合事件产生的人工基因组。这些模拟为训练深度学习模型提供了基准数据。模型学习了[幽灵基因渗入](@entry_id:176128)的复杂统计足迹——私有突变和[连锁不平衡](@entry_id:146203)的模式。然后，我们可以将这个训练好的模型应用于真实的现代人类基因组，它就能指出那些可能就是这些失落已久的祖先回声的特定片段，揭示了我们自身起源故事中隐藏的一章[@problem_id:2692255]。

### 反思性类比：进化与学习

在结束这次巡览时，我们很难不被一个深刻而共鸣的类比所打动。在[深度学习](@entry_id:142022)中，我们有一个“损失[曲面](@entry_id:267450)”，这是一个高维景观，我们寻求最低点，对应于性能最佳的模型。我们使用像[随机梯度下降](@entry_id:139134)（SGD）这样的[优化算法](@entry_id:147840)来导航这个景观。在生物学中，我们有一个“适应度景观”，自然选择驱动种群走向高繁殖成功的山峰。

SGD在损失[曲面](@entry_id:267450)上的路径是进化在[适应度景观](@entry_id:162607)上路径的一个好类比吗？在某些方面，是的。在一个大的、简单的种群中，平均基因型沿着适应度梯度的方向移动，很像SGD沿着损失的负梯度方向移动[@problem_id:2373411]。当生物学中的环境发生变化，或机器学习中的数据[分布](@entry_id:182848)发生改变时，景观本身变得非平稳，两个过程都必须追踪一个移动的目标[@problem_id:2373411]。

但这个类比并不完美，其局限性也同样具有启发性。进化几乎总是在一个*种群*的个体上进行，并行地探索景观的许多部分。而单轨的SGD算法则只遵循一条路径。在这个意义上，进化更类似于机器学习中基于群体的[优化方法](@entry_id:164468)[@problem_id:2373411]。此外，有性重组使进化能够混合和匹配来自不同谱系的成功创新，这个操作在标准SGD中没有直接的对应物[@problem_id:2373411]。而且，随机性的来源也不同：SGD中的小批量采样噪声与有限种群中生存和繁殖的偶然性所产生的[遗传漂变](@entry_id:145594)是不同的。

思考这种平行关系——它的优点和缺点——就是触及一种深刻的统一性。生命和“智能”算法都在努力解决同一个根本问题：如何在浩瀚无垠的搜索空间中找到好的解决方案。通过用一个来理解另一个，我们丰富了对两者的看法。我们看到机器中的学习过程不仅仅是一个技术程序，更是对一个在自然界中上演了数十亿年的更深层次、普适的适应逻辑的反映。