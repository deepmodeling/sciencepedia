## 引言
在现代科学中，复杂的模拟被用来模拟从星系形成到基因演化的万事万物。挑战在于如何根据真实世界的数据校准这些模型，而贝叶斯推断是完成此项任务的理想框架。然而，该框架依赖于[似然函数](@entry_id:141927)——即在给定模型参数的情况下观测到数据的概率——而对于这些复杂的模拟，似然函数往往在数学上难以处理或无法计算。这个“[难解似然](@entry_id:140896)”问题构成了一个重大障碍，使得大量科学模型无法进行严格的统计分析。

本文介绍[近似贝叶斯计算](@entry_id:746494)（ABC），这是一种革命性的方法，可以绕过这一挑战。我们将首先深入探讨ABC的**原理与机制**，从其极为简单的拒绝算法以及使其变得实用的近似方法开始。我们将探索如何将[马尔可夫链蒙特卡洛](@entry_id:138779)（MCMC）方法整合进来，以创建高效的ABC-[MCMC算法](@entry_id:751788)，并解决其固有的偏差-方差权衡问题。随后，在**应用与跨学科联系**部分，我们将遍历不同的科学领域，见证ABC如何被用于重建进化历史、校准活体组织模型，甚至在相互竞争的科学理论之间做出裁决。

## 原理与机制

现代科学的核心是一种强大的伙伴关系：我们为描述世界而建立的复杂模型，以及我们从世界本身收集的数据。贝叶斯推断在它们之间架起了一座完美的桥梁，这是一个逻辑框架，用于根据证据更新我们对模型参数的信念。该框架的引擎是[贝叶斯定理](@entry_id:151040)，其本质是说，给定数据时我们参数的概率，正比于给定我们参数时数据的概率，再乘以我们对这些参数的先验信念。

其中一项——给定参数时数据的概率，即**似然**——往往是症结所在。对于许多我们最感兴趣也最现实的模型——如[星系形成](@entry_id:160121)的模拟、疾病的传播、细胞内基因与蛋白质的复杂舞蹈，或晶体中原子的磁性[排列](@entry_id:136432)[@problem_id:3288800]——我们拥有科学家所说的**生成模型**。我们可以输入一组参数，模型就像一个数字西洋镜一样，会生成合成数据。但我们通常*无法*为似然写出一个简洁的数学公式。模型是一个黑箱；我们可以看到输出结果，但无法写出支配它的方程。计算观测到我们特定的真实世界数据的确切概率，简而言之，是难以处理的。

这并非小麻烦，而是一个根本性的障碍。这意味着，对于一大类日益增多的科学问题，经典的贝叶斯统计机制无法直接应用。那么，当正门被锁上时，我们该怎么办？我们寻找另一条路进去。

### 一个绝妙的简单想法：如果无法计算，那就比较

近似贝葉斯计算（ABC）建立在一个非常直观的想法之上，甚至近乎孩童的智慧。如果我们无法计算模型产生我们数据的概率，那么让我们反过来问这个问题。让我们直接运行模型，*看看*它是否能产生*看起来像*我们数据的东西。

想象一个简单的“猜测与检验”游戏。这是ABC最基本的形式，即**拒绝算法**：

1.  **猜测**：为你的[模型选择](@entry_id:155601)一组参数，从你的[先验分布](@entry_id:141376)中抽取。[先验分布](@entry_id:141376)代表了你所有合理的初始猜测。
2.  **模拟**：使用这些参数运行你复杂的黑箱模拟器，生成一份合成的或“假的”数据。
3.  **比较**：观察合成数据和你的真实观测数据。它们完全匹配吗？
4.  **决定**：如果它们完美匹配，你就保留你猜测的参数。你高喊一声“太棒了！”并将其加入你的收藏。如果不匹配，你就丢弃这些参数，再试一次。

如果你玩这个游戏数百万次，你所保留的参数集合将构成一个来自真实后验分布的完美样本。你就在从未写下似然函数的情况下，完成了精确的贝叶斯推斷！你通过观察哪些参数能够生成你实际观测到的世界，从而物理上模拟了似然。

### 从理想到现实：两种近似

当然，这个美好的理想面临着严峻的现实考验。对于任何足够复杂的实验——比如测量蛋白质数量的时间序列，或对基因组进行测序——模拟产生的结果与观测数据在每个细节上都*完全相同*的概率几乎为零[@problem_id:2521316]。纯粹形式的拒绝算法最终会拒绝所有结果。

为了使这个想法变得实用，我们必须引入两种巧妙的近似。

首先，我们不再比较整个（通常是庞大的）数据集，而是比较几个关键特征。我们将数据的精华提炼成少数几个数字，称为**摘要统计量**。对于一项关于鸟类种群历史的研究，这些统计量可能是总体的[遗传多样性](@entry_id:201444)和不同地理群体间的平均遗传距离[@problem_id:2521316]。对于一个磁体模型，自然的统计量将是总磁化强度和相邻原子间的[相互作用能](@entry_id:264333)[@problem_id:3288800]。问题不再是“合成数据是否与真实数据完全相同？”，而是“合成数据的摘要统计量是否*接近*真实数据的摘要统计量？”

其次，我们必须定义“接近”的含义。我们通过选择一个**距离**度量（通常是熟悉的欧氏距离）和一个**容忍度**（一个用希腊字母 $\epsilon$ 表示的小阈值）来实现这一点。如果观测到的和模拟的摘要统计量之间的距离小于或等于 $\epsilon$，我们就认为它们匹配。

这就给了我们主力军ABC拒绝算法：
1. 从先验分布中抽取参数 $\theta$。
2. 使用 $\theta$ 模拟一个数据集 $x$。
3. 计算摘要统计量 $s(x)$。
4. 如果距离 $\rho(s(x), s_{obs}) \le \epsilon$，则接受 $\theta$。否则，拒绝它。

这个过程是“无[似然](@entry_id:167119)”的，因为我们全程没有评估[似然函数](@entry_id:141927)。我们只是用模型来生成数据，将一个计算问题转化为了一个模拟问题。在数学上，我们所做的是从一个近似的后验分布中抽样，这个[分布](@entry_id:182848)不是由似然定义的，而是由一个在摘要统计量之间距离上平滑的[核函数](@entry_id:145324)定义的[@problem_id:3288743]：
$$
p_\epsilon(\theta \mid s_{obs}) \propto p(\theta) \int K_\epsilon\big(\rho(s(x), s_{obs})\big) p(x \mid \theta)\, dx
$$
其中 $K_\epsilon$ 是一个函数（核函数），它为小距离赋予高权重，就像我们拒绝算法中的简单[指示函数](@entry_id:186820)一样。

### 简洁的代价：偏差与偏差-方差权衡

这两种近似虽然使推断成为可能，但也付出了代价：**偏差**。我们的ABC[后验分布](@entry_id:145605)是真实[后验分布](@entry_id:145605)的一个近似，其差异来自两个方面。

1.  **来自非充分统计量的偏差**：如果我们选择的摘要统计量未能捕获数据中包含的关于参数的所有信息，我们就引入了一个不可约的误差。即使我们能设定 $\epsilon=0$，我们推断的也是基于摘要统计量的后验 $p(\theta \mid s_{obs})$，这与基于完整数据的真实后验 $p(\theta \mid y_{obs})$ 是不同的[@problem_id:3288743] [@problem_id:3326892]。信息已经丢失了。ABC的很大一部分艺术在于选择尽可能“充分”的摘要统计量。

2.  **来自非零容忍度的偏差**：容忍度 $\epsilon > 0$ 引入了一个平滑误差。我们接受的是那些能产生*接近*我们观测值的数据的参数，而不仅仅是*完[全等](@entry_id:273198)于*我们观测值的数据。这往往会使得推断出的[后验分布](@entry_id:145605)比应有的更分散、更不确定。好消息是，这种偏差是可控的：当我们将 $\epsilon$ 缩小至零时，这部分误差会消失，在平滑条件下通常与 $\epsilon^2$ 成比例缩放[@problem_id:3326892]。

因此，目标是使 $\epsilon$ 在计算上尽可能小。但在这里我们遇到了一个障碍。随着 $\epsilon$ 变小，接受率急剧下降。我们最终会拒绝几乎每一次模拟，这个过程变得极其低效。这就导致了一个经典的工程困境，即**偏差-方差权衡**[@problem_id:3289345]。小的 $\epsilon$ 给我们低偏差（一个好的近似），但需要大量的模拟才能获得足够多的被接受样本，从而导致我们最终估计的高[方差](@entry_id:200758)。大的 $\epsilon$ 计算成本低（低[方差](@entry_id:200758)），但给出了一个糟糕的、高偏差的近似。

此外，这个问题还被“[维度灾难](@entry_id:143920)”所加剧。接受率大致按 $\epsilon^{d_S}$ 缩放，其中 $d_S$ 是摘要统计量的数量。增加更多的统计量似乎是捕捉更多信息的好主意，但每个新的统计量都会急剧缩小接受区域，迫使我们使用更大的 $\epsilon$ 并接受更多的偏差才能得到任何结果[@problem_id:3326892]。

### 提高效率：ABC-MCMC之舞

暴力拒绝算法丢弃了太多信息。大多数被拒绝的参数被拒绝是有原因的，但其中一些可能“接近”好的参数。我们需要一种更智能的方式来探索参数空间。这就是**[马尔可夫链蒙特卡洛](@entry_id:138779)（MCMC）**方法发挥作用的地方。

**ABC-MCMC**背后的想法是构建一个[马尔可夫链](@entry_id:150828)——一个引导性的[随机游走](@entry_id:142620)——来探索近似后验分布的地貌。我们不再每次都从先验分布中抽取新参数，而是从当前位置迈出小步。[Metropolis-Hastings算法](@entry_id:146870)的巧妙之处在于，它允许我们为这些步骤设计一个接受规则，确保链条大部分时间都停留在高概率区域。

在一个常见的表述中，我们在一个*增广状态*上构建链条，该状态既包括参数 $\theta$，也包括它们产生的模拟数据 $\tilde{y}$。当我们提议移动到一个新参数 $\theta'$ 时，我们也会生成一个新的模拟数据集 $\tilde{y}'$。接受概率巧妙地抵消了难解的似然项，只取决于先验、提议机制以及新旧模拟与观测数据之间的[核加权](@entry_id:637011)距离[@problem_id:3289345] [@problem_id:3400319]。这使得算法能够有效地描绘出近似后验分布，而没有简单拒绝算法的浪费。

### 更深层的统一：与更广阔的MCMC世界的联系

还有一个最终的、优美的洞见，将ABC与一个更广阔的计算方法世界联系起来。ABC-[MCMC算法](@entry_id:751788)可以被看作是一个更通用框架——**伪边缘 MCMC (PMMH)**——的一个特例[@problem_id:3288820]。

PMMH的方案适用于似然函数（我们称之为 $L(\theta)$）难以处理，但我们可以为其生成一个*非负、无偏的估计* $\widehat{L}(\theta)$ 的情况。一个卓越的发现是，如果你将这个有噪声但无偏的估计量代入MCMC的接受率中，所产生的马尔可夫链会收敛到*确切*的目标后验分布。估计中的噪声在链的运行过程中被奇妙地平均掉了。

现在，考虑ABC的[似然](@entry_id:167119)，即模拟结果落在我们观测到的摘要统计量周围$\epsilon$球内的概率。我们可以通过简单地运行$R$次模拟并计算被接受的比例来得到这个概率的[无偏估计](@entry_id:756289)！这意味着，一个每步使用多次模拟的ABC-[MCMC算法](@entry_id:751788)，实际上是*近似*ABC[后验分布](@entry_id:145605)的一个*精确*采样器。

这一认识非常强大。它告诉我们ABC不仅仅是临时拼凑的技巧集合，而是一种具有深厚理论基础、有原则的统计方法。它还使得与竞争方法的比较更加清晰。例如，在模拟基因表达时，可以使用粒子滤波器来获得*真实*似然的[无偏估计](@entry_id:756289)。使用这个估计量的PMMH算法将以*真实*后验为目标，使其在理论上优于ABC。然而，如果[粒子滤波器](@entry_id:181468)计算成本极高，一个调优良好的ABC-MCMC方案可能仍然是更实用、更高效的工具[@problem_id:3289336]。

从一个简单、直观的变通方法来解决一个不可能的计算问题，ABC的原理扩展开来，揭示了近似、效率和现代[计算统计学](@entry_id:144702)基本理论之间丰富的相互作用。这是科学创造力的证明，向我们展示了即使一个问题看起来难以解决，视角的转变也能揭示一条崭新而富有成果的前进道路。

