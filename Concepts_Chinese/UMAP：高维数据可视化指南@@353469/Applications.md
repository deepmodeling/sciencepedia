## 应用与跨学科联系

在前一章中，我们剖析了均匀流形近似与投影（UMAP）的精妙机制。我们看到它如何将一团令[人眼](@article_id:343903)花缭乱的[高维数据](@article_id:299322)，像一位制图大师一样，绘制出一幅简洁、优雅的地图，揭示其隐藏的形态。我们已经学习了原理，现在到了激动人心的部分：我们能用这些图谱做什么？它们能让我们发掘出什么宝藏？在本章中，我们将踏上一段穿越 UMAP 广泛应用的旅程，探索这些抽象的地图如何成为具体科学发现的强大工具，从单个细胞的内部运作到医学的前沿。

### 生物学家的图谱：绘制细胞世界

UMAP 最具革命性的影响或许是在生物学领域，特别是在[单细胞基因组学](@article_id:338564)中。想象一个实验，你取一块组织——比如来自发育中的小鼠胚胎——并测量其成千上万个细胞中每一个细胞里数千个基因的活性。结果是一个极其复杂的数据集。在 UMAP 出现之前，试图理解这一切就像是拿到一个特大城市里每个人的电话簿，然后被要求画出社交网络一样。

有了 UMAP，这项任务变得可行，甚至优美。当我们把这些数据输入[算法](@article_id:331821)时，得到的图谱通常会显示出独立的点状“岛屿”，被空旷空间的“海洋”隔开。这些岛屿是什么？它们是不同的细胞类型。UMAP [算法](@article_id:331821)自动地将具有相似整体基因活性模式的细胞归为一类，有效地将细胞普查划分为其组成群体。

但是我们如何给这些岛屿命名呢？这时，地图就变成了一本交互式图谱。假设我们知道一个名为 *MyoD* 的基因对于肌肉的形成至关重要。我们可以根据每个细胞的 *MyoD* 基因活性水平来为 UMAP 图上的每个细胞着色——高活性细胞用亮红色，低活性细胞用冷灰色。如果我们这样做，可能会看到一个特定的岛屿亮起灿烂的深红色，而所有其他岛屿都保持灰色。我们刚刚找到了发育中的肌肉细胞 [@problem_id:1714785]。这样用来识别一个群体的基因被称为**标记基因** [@problem_id:1520807]。通过对已知的[神经元](@article_id:324093)、皮肤细胞和血细胞标记[基因重复](@article_id:311054)这个过程，我们就可以系统地为我们细胞世界的所有大陆和群岛贴上标签。

那么那些我们无法用已知标记识别的岛屿呢？如果我们发现两个紧挨在一起的簇，并想了解是什么使它们与众不同呢？在这里，我们可以超越可视化，让计算机执行**[差异表达分析](@article_id:330074)**。我们告诉它：“列出所有在岛屿 A 的细胞中比在岛屿 B 的细胞中活性显著更高的基因。”这个列表提供了岛屿 A 独特的分子配方，揭示了赋予其与邻居不同身份和功能的遗传程序 [@problem_id:1714810]。这就是如何鉴定新的、以前未知的细胞亚型。

这种图谱制作的力量远不止于此。有时，我们最初的地图显示一个巨大的大陆，我们将其标记为“星形胶质细胞”，一种脑细胞。它看起来很均匀，但其庞大的形状暗示了隐藏的多样性。它真的是一个同质的群体吗？为了找出答案，我们可以进行“亚[聚类](@article_id:330431)”分析。我们通过计算分离出所有属于星形胶z质细胞大陆的细胞，将它们置于一个新的分析“放大镜”下，然后再次运行 UMAP，这次只针对它们。奇迹再次发生：曾经单一的大陆现在可能会解析为一个由六个更小、更紧凑的岛屿组成的惊人“群岛”，每个岛屿代表一种在脑中具有专门作用的[星形胶质细胞](@article_id:315507)亚型。这种迭代的、“放大”的方法是探索生命深度异质性的标准方法 [@problem_id:2350918]。

### 绘制时间之河：可视化生物过程

UMAP 创建的图谱不仅仅是静态的快照。它们常常揭示生命本身的动态——那些随时间展开的过程，如分化和疾病进展。岛屿之间的空间并非空洞；它们是细胞在改变状态时穿行的河流、高速公路和路径。

考虑一下少突胶质细胞的发育过程，这是一种用[髓鞘](@article_id:309985)包裹[神经元](@article_id:324093)的细胞。利用 UMAP 绘制发育中大脑的[细胞图谱](@article_id:333784)，我们看到的不仅是“前体”、“新形成”和“成熟”[少突胶质细胞](@article_id:315907)的三个独立岛屿。相反，我们看到的是一条连续的细胞流，形成了一条“轨迹”——一条从前体区域流出，穿过中间地带，最终到达成熟状态的河流。通过用已知在不同阶段活跃的基因为图谱着色，我们可以实时观察细胞身份的转变：随着细胞沿路径移动，前体标记逐渐消失，而随着它们接近最终目的地，[髓鞘形成](@article_id:348155)基因则亮起 [@problem_id:2732679]。UMAP 让我们能够将发育过程可视化，不是一系列静态的状态，而是一段流动的、连续的旅程。

我们可以将这个想法推向其令人惊叹的极致。受生物学家 Conrad Waddington 充满隐喻的“[表观遗传景观](@article_id:300233)”启发，科学家们现在正在构建[细胞命运](@article_id:331830)的定量模型。通过将 UMAP 的[细胞状态](@article_id:639295)视图与额外的信息层——如测量 DNA 哪些部分“开放待用”的 [scATAC-seq](@article_id:345532)，以及使用未剪接与已[剪接](@article_id:324995)[转录](@article_id:361745)本的比例来推断每个细胞状态即时未来方向的 RNA 速率——相结合，我们可以超越简单的地图。我们可以重建一个完整的地形景观。在这个景观中，稳定、成熟的细胞类型是深谷，即**[吸引子](@article_id:338770)**。细胞生命中的决策点，即它选择一个谱系而非另一个谱系的地方，是山口，即**[鞍点](@article_id:303016)**。UMAP 提供了构建这些动态预测模型的基础[坐标系](@article_id:316753)，将一个关于发育的美丽比喻转变为一个可计算的、由数据驱动的现实 [@problem_id:2672716]。

### 模式的统一性：超越 RNA 的 UMAP

UMAP 最深刻的一个方面是其数学核心并非特定于生物学或基因表达。它是一个通用的工具，可以在任何[高维数据](@article_id:299322)集中寻找结构。那些基于 RNA 绘制细胞类型图谱的相同原理，也可以用于基于光谱绘制恒星图谱，或基于购买习惯绘制客户画像。

在生物学内部，这种普适性是一种强大的统一力量。例如，免疫学家使用一种名为[质谱流式细胞术](@article_id:365505)（[CyTOF](@article_id:360760)）的技术来测量单个免疫细胞表面 40 多种蛋白质的水平。数据是不同的——蛋白质丰度而非 RNA 丰度——但挑战是相同的：理解高维空间。而 UMAP 同样出色地工作，生成了免疫系统错综复杂景观的令人惊叹的图谱，揭示了数十种协同保护我们身体的细胞类型和激活状态 [@problem_id:2866331]。

此外，UMAP 不仅是探索的终点，它还是现代[系统生物学](@article_id:308968)引擎中的一个关键组成部分。想象一个研究小组正在设计新的基于纳米颗粒的[疫苗](@article_id:306070)。他们用几种不同的纳米颗粒配方处理免疫细胞，然后为每种情况生成一个 UMAP 图。他们还为每个实验提供了一个功能性测量：处理过的细胞激活执行免疫攻击的 T 细胞的效果如何。他们可能会观察到，最成功的[疫苗](@article_id:306070)配方总能诱导 UMAP 图上出现一个新的、特定的细胞簇。通过使用能够将[细胞数](@article_id:313753)据与功能结果联系起来的适当统计模型（同时仔细考虑捐献者之间的差异等混淆因素），他们可以建立一个定量联系：这个新簇中细胞的比例是[疫苗效力](@article_id:373290)的有力预测指标。UMAP 图帮助他们识别了成功免疫反应的细胞生物标志物，这是开发更好药物的关键一步 [@problem_id:2874350]。

### 一点警示：制图师的责任

任何强大的工具都伴随着理解其局限性和假设的责任。地图是现实的表征，而非现实本身。将一个[算法](@article_id:331821)应用于其设计初衷之外的问题，是产生无稽之谈的秘诀。

考虑一下这个思想实验：一位研究人员建议使用“TAD caller”——一种来自基因组学的专门[算法](@article_id:331821)，用于从 Hi-C 接触图中寻找[染色体](@article_id:340234)中的结构域——来分析学生课程注册矩阵，希望能找到“专业”。这个想法从根本上就是有缺陷的。TAD callers 是建立在一个不可动摇的假设之上的：数据是沿着一维[线性聚合物](@article_id:322019)——[染色体](@article_id:340234)——[排列](@article_id:296886)的，其中距离具有物理意义。而大学课程列表没有这种内在的线性顺序。人们可以按字母顺序或按院系排序，但这是任意的。应用该[算法](@article_id:331821)会产生一个答案，但这将是所选任意排序产生的无意义的人为结果。这就像试图用海图在沙漠中导航一样 [@problem_id:2437196]。

这就引出了一个深刻而优美的问题：为什么 UMAP 在单细胞生物学中效果如此之好？答案是，该[算法](@article_id:331821)的数学假设与生命自我组织的物理现实之间存在着深刻的共鸣。UMAP 假设数据位于一个“[流形](@article_id:313450)”上——一个[嵌入](@article_id:311541)在高维空间中的低维形状。生物学上的事实是，细胞身份并非基因表达空间中的随机点。它们受到错综复杂、环环相扣的基因调控网络的支配。这些网络限制了细胞可以占据的可能状态，迫使它们位于一个结构化的、连续的物体上。我们拥有稳定、清晰的细胞类型——如大脑中的 `Pvalb`、`Sst` 和 `Vip` [神经元](@article_id:324093)——这一事实意味着细胞聚集在该[流形](@article_id:313450)的特定、分隔良好的区域。UMAP 之所以如此有效，正是因为它被明确设计用来发现并忠实地表示恰好是这种[流形](@article_id:313450)结构 [@problem_id:2727228]。工具之所以契合问题，是因为[算法](@article_id:331821)的几何学反映了生物学的逻辑。

当我们向前迈进，使用 UMAP 探索新的数据集和新的科学前沿时，我们必须牢记这一教训。UMAP 不是一个神奇的黑匣子，而是一个卓越的制图工具。和所有伟大的制图师一样，我们的成功取决于理解我们的工具，尊重我们所处的领域，并始终寻求我们绘制的地图与其所代表的疆域之间的深刻联系。