## 应用与跨学科联系

既然我们已经掌握了[可微分架构搜索](@article_id:638629)的核心原理——那个将离散的、硬性的选择松弛为一个我们可以用微积分来导航的连续、平滑景观的巧妙技巧——我们就可以提出任何新工具最重要的问题：它有什么用？事实证明，答案非常广泛。我们发现，这个单一的想法不仅仅是学术上的好奇心，更是一个用于实际工程的强大引擎，一个用于平衡复杂权衡的精密工具，甚至是一面反映科学发现本质的镜子。让我们踏上这段应用的旅程，从具体到深刻。

### 自动化工程的艺术：打造高效网络

从本质上讲，设计神经网络是一种工程行为。我们必须选择正确的组件并将它们组装起来以执行任务，同时还要遵守成本、速度和能耗的预算。从历史上看，这是一个由经验和直觉指导的、艰苦的手动过程。[可微分架构搜索](@article_id:638629)（DAS）以一位大师级工匠的身份进入这个领域，能够用数学的精确性来自动化这些决策。

想象一下，你正在构建一个[卷积神经网络](@article_id:357845)，一个用于观察模式的数字眼睛。对于每一层，你都必须选择一个“镜头”，即一个特定尺寸的[卷积核](@article_id:639393)。小[卷积核](@article_id:639393)可能速度快，能看到精细的细节，而大[卷积核](@article_id:639393)可能速度慢，但更擅长把握更广阔的背景。哪个是正确的选择？第一层的正确选择对最后一层仍然适用吗？在像 GoogLeNet 这样复杂的架构中，有几十个这样的选择，问题变成了一个令人眼花缭乱的组合谜题。DAS 提供了一个优雅的解决方案。我们不再强制做出单一选择，而是允许每个潜在的卷积核尺寸提供其“意见”，并使用 softmax 函数来创建一个加权共识。然后，目标函数不仅引导优化朝向准确性，还朝向一个理想的属性，例如惩罚计算成本高的大卷积核。其结果是一个能够为每个任务自动发现正确工具的系统，为网络中的每一个组件平衡性能与成本 [@problem_id:3130778]。

这一原则可以很好地扩展到更复杂的场景。现实世界的工程很少只涉及单一的权衡；它关乎于处理一整套约束条件。考虑设计一个完整的网络蓝图的任务——不仅是[卷积核](@article_id:639393)的大小，还有它的总深度（多少层？）和每个阶段的宽度（多少通道？）。此外，想象一下你对最终网络允许执行的总计算量，即[浮点运算](@article_id:306656)次数（FLOPs），有一个严格的“预算”。这对于在智能手机等[功耗](@article_id:356275)有限的设备上部署模型来说是一个常见要求。

在这里，DAS 展示了其卓越的灵活性。我们可以引入可微分的“门”，来学习是包含还是绕过一个层块，从而有效地学习最优深度。同时，我们可以使用我们的 softmax 技巧来学习每个阶段的最优宽度。最巧妙的是，我们可以将总 FLOPs 数量本身表述为这些架构选择的可微分函数。这使我们能够将预算直接包含在我们的损失函数中——例如，通过添加一个像 $\lambda \cdot \max\{0, \hat{F} - F_{\text{budget}}\}$ 这样的惩罚项，其中 $\hat{F}$ 是我们混合架构的预期 FLOPs。这个惩罚项就像一笔透支费；如果我们在预算内，它什么也不做，但如果我们超出预算，它就会急剧增长，迫使优化器找到一个尊重约束的解决方案。在一个统一的过程中，DAS 设计了一个具有适当深度和宽度且满足不可协商的计算预算的网络 [@problem_id:3198640]。

当我们将抽象的计算模型与物理世界联系起来时，这种工程应用的巅峰就到来了。像 FLOPs 这样的代理指标很有用，但它们并不能捕捉到性能的全貌。网络的真实速度取决于它运行的具体硬件——特定 GPU 的内存访问模式、手机 CPU 的指令集等等。我们能教会我们的搜索算法关于我们特定设备的物理特性吗？

有了 DAS，答案是响亮的“是”。在一个被称为“硬件在环”搜索的策略中，我们可以在目标硬件上预先测量每个可能的架构选择的实际延迟。这些测量数据构成一个简单的查找表。然后，我们将这个测量的延迟直接整合到我们的目标函数中，通常作为与准确性损失的加权和：$\mathcal{L} = \text{AccuracyLoss} + \beta \cdot \text{Latency}$。超参数 $\beta$ 成为工程师的一个调节旋钮。一个小的 $\beta$ 会告诉搜索优先考虑准确性，即使它很慢。一个大的 $\beta$ 则要求尽可能快的网络，即使以牺牲少量准确性为代价。通过转动这个单一的旋钮，工程师可以自动生成一整个系列的优化网络，每个网络都为其特定硬件的准确性-速度谱上的不同点量身定制 [@problem_id:3120093]。

### 更深层次的联系：从工程到科学

DAS 的力量超越了实际的自动化。它触及并提供了一个框架，用于解决优化理论、信息论和[科学方法](@article_id:303666)[交叉](@article_id:315017)点上的更深层次问题。

到目前为止，我们通过一个简单的加权因子将多个目标（如准确性和延迟）组合成一个单一的[损失函数](@article_id:638865)来处理。但是当两个目标存在根本冲突时会发生什么？想象一个场景，在架构空间中，最能提高准确性的方向（由梯度 $\nabla A(\boldsymbol{\alpha})$ 给出）与使训练过程更稳定的方向（由 $\nabla (-L(\boldsymbol{\alpha}))$ 给出）相反。对这些梯度进行简单的求和可能会相互抵消，导致进展缓慢或停滞。

在这里，我们可以从简单的工程转向更具外科手术式的方法，将 DAS 与[多目标优化](@article_id:641712)领域联系起来。我们可以分析这两个梯度向量之间的关系，例如通过计算它们之间夹角的余弦值。负值表示冲突。当冲突发生时，我们可以执行“梯度手术”：我们可以将一个梯度分解为与另一个梯度平行和正交的分量，并简单地移除冲突的平行分量。这使我们能够以一种追求一个目标而不会主动损害另一个目标的方式来更新我们的架构。这是一种在复杂的权衡景观中进行导航的更复杂的方法，是解决相互竞争目标之间拉锯战的外交解决方案 [@problem_id:3158061]。

然而，也许最深刻的联系来自于对整个搜索过程的重新构建。当我们评估一个架构时，我们到底在做什么？我们正在进行一次实验。鉴于这些实验可能极其昂贵，需要数小时或数天的计算，我们应该如何选择接下来要运行哪一个？蛮力或随机的方法就像一个科学家随机混合化学物质，希望能偶然发现一个新发现。一种更智能的方法是设计信息量最大的实验。

这就是[贝叶斯优化](@article_id:323401)实验设计（Bayesian Optimal Experimental Design, BOED）的核心思想，它为我们看待架构搜索提供了一个绝佳的视角。我们可以从一个关于所有可能模型空间的“信念”（由[概率分布](@article_id:306824)表示）开始。我们每一步的目标是选择那个预期能最大程度减少我们不确定性的实验（即，评估那个架构）。这种不确定性的减少通过直接从信息论中借来的**[信息增益](@article_id:325719)**（information gain）概念来量化。我们对每个候选架构提问：“如果我测试你，平均而言，我能对问题的真实性质了解多少？我的无知会减少多少？”然后我们选择那个有望带来最大知识飞跃的架构 [@problem_id:3158085]。

通过采纳这种视角，架构搜索发生了转变。它不再仅仅是寻找一个单一的高性能模型。它变成了一个有原则的、基于信息论的探究过程，一个闭环，其中每一步都是构建知识的最有效的一步。搜索变成了一个自动化的科学家，带着好奇心和严谨性探索一个巨大的[假设空间](@article_id:639835)，并由信息的基本法则引导。

从一个在预算下精心挑选零件的自动化工程师，到一个解决冲突目标的明智谈判者，再到一个进行[信息量](@article_id:333051)最大化实验的自动化科学家，[可微分架构搜索](@article_id:638629)的应用揭示了一个具有非凡深度的工具。它证明了一个单一、优雅的数学思想如何能够向外[扩散](@article_id:327616)，在解决现实世界实际问题的同时，也与优化和科学探究的一些最深刻原理相联系。