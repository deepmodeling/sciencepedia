## 引言
当无法进行像随机对照试验（RCT）这样的完美实验时，我们如何仍然能利用真实世界数据来回答关于健康和医学的关键问题？[观察性研究](@entry_id:174507)提供了丰富的信息，但它们带来了一个根本性挑战：将真实的因果效应与纯粹的统计学关联区分开来。本文旨在填补这一知识鸿沟，为现代[观察性研究](@entry_id:174507)分析的原则和应用提供指南，使读者具备驾驭非实验性数据复杂性的概念工具。

我们的旅程始于“原则与机制”一章，该章通过探讨混杂的“原罪”、时间相关偏倚的欺骗性，以及用于校正的强大统计方法，为全文奠定基础。随后，“应用与跨学科联系”一章展示了这些原则如何付诸实践，从模拟假想试验到利用“自然实验”，再到为高风险的监管决策提供信息。这一探索揭示了严谨的分析如何将杂乱的真实世界数据转化为可靠且能拯救生命的知识。

## 原则与机制

涉足观察性研究的世界，就如同成为一名侦探。犯罪现场就是真实世界中那些杂乱无章、未经筛选的数据。一个完美、纯净的实验——**随机对照试验（RCT）**——并未进行，原因可能是出于伦理、成本或可行性的考量。然而，一个关键问题亟待回答：这种药物能拯救生命吗？这种暴露会造成伤害吗？我们的任务就是重建那个完美的实验*本该*告诉我们什么。这种智力上的重建正是现代观察性研究分析的核心，这一学科被称为**目标试验模拟**（target trial emulation）[@problem_id:4598874]。

想象一下我们希望能够运行的完美试验。我们会细致地定义谁有资格参与、他们接受何种治疗以及如何分配。我们会为随访设定明确的起点和终点，精确定义结局，明确我们要问的因果问题，并提前制定我们的分析计划。这七个组成部分构成了我们“目标试验”的蓝图。我们在观察性研究分析中的全部努力，就是遵循这张蓝图，利用统计学的巧思来克服我们无法使用最强大工具——随机化——这一事实。

### 原罪：混杂

为什么随机化如此强大？因为它能产生两组在平均意义上于所有可想到的方面——无论是已测量的还是未测量的——都完全相同的人，唯一的区别在于他们接受的治疗。这个特性被称为**[可交换性](@entry_id:263314)**（exchangeability）。如果治疗组的结局更好，我们就可以自信地将差异归因于治疗。

在真实世界中，情况几乎从非如此。选择服用某种药物的人可能病情更重，或者更注重健康，或者比不服药的人更富有。这些既与治疗选择相关，又与健康结局相关的其他因素，被称为**混杂因素**（confounders）。一个经典的例子是“健康使用者效应”（healthy user effect）：坚持按处方服药的人通常在其他方面也更健康，这使得药物看起来比实际效果更好[@problem_id:4964305]。

让我们用一种名为**[有向无环图](@entry_id:164045)（DAG）**的工具来描绘这个问题。如果我们正在研究一项治疗（$X$）对一个结局（$Y$）的影响，一个混杂因素（$A$）是两者的[共同原因](@entry_id:266381)：$X \leftarrow A \to Y$。这在 $X$ 和 $Y$ 之间创造了一条非因果的“后门路径”（back-door path）。这是一条纯粹关联的路径，一个可能迷惑我们的统计学幽灵。例如，在一项比较锂盐与丙戊酸盐治疗双相情感障碍的研究中，有酒精使用障碍（AUD）史——这是自杀企图的一个风险因素——的患者可能被优先处方丙戊酸盐。在这里，AUD 是一个混杂因素，它制造了虚假的关联，使得锂盐显得比实际更具保护性[@problem_id:4964305]。

我们对抗混杂的主要武器是**校正**（adjustment）。我们可以使用回归或倾向性得分加权等统计方法，试图做到“同类比较”。我们可以将在患有 AUD 的治疗患者与*同样*患有 AUD 的未治疗患者的结局进行比较。通过对混杂因素进行条件化，我们阻断了后门路径，旨在实现**条件[可交换性](@entry_id:263314)**（conditional exchangeability）：即假设在已测混杂因素的每个层级内，治疗选择实际上是随机的[@problem_id:4846843]。

### 时间的欺骗：不朽时间偏倚

有些偏倚比简单的混杂更微妙、更具欺骗性。其中最令人着迷也最危险的一种是**不朽时间偏倚**（immortal time bias）。这是一个源于我们在[处理时间](@entry_id:196496)上一个简单、看似无辜的错误的陷阱。

想象一项研究，在患者确诊后随访 $T=12$ 个月。一种新疗法问世，但由于后勤原因，只能在第 $s=4$ 个月开始使用。分析师可能会在年底审视数据，将所有曾接受该药物的人标记为“治疗组”，其他人标记为“未治疗组”。然后，他们比较两组在整个 12 个月内的死亡率。这有什么问题呢？

要进入“曾接受治疗”组，患者*必须*存活过前四个月才能接受药物。这四个月的时期对治疗组来说就是“不朽时间”；根据定义，他们在此期间的死亡率为零。而未治疗组则没有这样的保证。这种研究设计上的缺陷在治疗甚至还未开始之前，就给了治疗组一个巨大的、不应得的生存优势[@problem_id:5051589]。

这不仅仅是一个定性问题；我们可以计算它的影响。如果该疗法真实的风险降低度为 $\theta$，那么有偏倚的分析估计出的率比大约为 $\theta \times (1 - \frac{s}{T})$。在我们的例子中，假设真实的风险比为 $\theta=0.70$，有偏倚的分析将报告一个约为 $0.70 \times (1 - \frac{4}{12}) \approx 0.47$ 的率比。这种偏倚制造了一种药物效果强得多的假象！[@problem_id:5051589]。

解决方法是对时间保持一丝不苟的诚实。我们必须为每个人定义一个明确的**索引日期**（index date，即时间零点），这是他们开始处于风险中的时刻。然后，我们随时间推移跟踪他们，承认他们的治疗状态不是固定的，而是一个**时依协变量**（time-dependent covariate）。一个人在接受治疗前贡献未暴露人-时，从接受治疗的那一刻起，他们转换到暴露状态。每个人的随访在他们出现结局、研究结束或我们失去他们的踪迹时结束——这一事件称为**删失**（censoring）[@problem_id:5226239]。这种严谨、具有时间意识的核算方法是斩除不朽时间偏倚这一恶魔的唯一途径。

### 校正的艺术：控制什么，不控制什么

我们已经学到必须对混杂因素进行校正。这可能会引发一种冲动，即对我们手头上的任何其他变量都进行校正。这是一个严重的错误。知道什么*不*应该校正，与知道什么应该校正同样重要。

考虑一个简单的因果链：一项治疗（$X$）通过改变一种生物标志物（$M$）的水平而起作用，而这种生物标志物的改变导致了临床结局（$Y$）的改善。因果图是 $X \to M \to Y$。生物标志物 $M$ 是一个**中介变量**（mediator）——它位于治疗与结局之间的因果路径上。

如果我们对 $M$ 进行“校正”会发生什么？我们实质上是在问：“对于生物标志物水平*相同*的患者，治疗是否带来了差异？”通过在比较中强制生物标志物水平相同，我们阻断了治疗发挥作用的根本路径。我们使自己对治疗的效果视而不见。一个对中介变量进行校正的分析将会产生偏倚，通常是严重地偏向于发现无效果，因为它不再估计治疗的*总因果效应*（total causal effect）[@problem_id:4557753]。这个教训是深刻的：校正是一把手术刀，而不是一把大锤。它必须只用于阻断非因果的“后门”路径，而不是阻断我们希望理解的因果“前门”路径。

### 需要诚实与智慧之时

如果我们怀疑存在无法测量的混杂因素，该怎么办？我们关于条件[可交换性](@entry_id:263314)的假设仅仅是一个假设，是一个信念问题。这正是科学家真正品格的体现之处：既要诚实地承认这种不确定性，又要巧妙地探索其极限。

**敏感性分析**（Sensitivity analysis）是一种诚实的实践。它提问：“我的假设需要错到什么程度，才会改变我的结论？”用于此目的最优雅的工具之一是**[E值](@entry_id:177316)**（E-value）[@problem_id:4846843] [@problem_id:2488889]。假设我们的研究发现，农药暴露与一种[神经发育](@entry_id:170731)问题相关，估计的风险比为 $2.1$。该估计的 E 值为 $3.62$。这个数字有一个美妙的解释：要完全解释掉我们的发现，一个未测量的混杂因素需要与农药暴露*和*[神经发育](@entry_id:170731)问题都相关，且风险比至少为 $3.62$。这为我们判断研究结果的稳健性提供了一个定量标尺。我们可以自问：是否存在任何已知的生物学或社会因素有如此强的作用？其他[敏感性分析](@entry_id:147555)包括检查当使用不同[统计模型](@entry_id:755400)、不同变量定义方式，或排除有影响的离群数据点时，我们的结果是否仍然成立[@problem_id:4359745]。

**工具变量（IV）**分析（Instrumental Variables (IV) analysis）是一种巧妙的实践。它寻找一种“自然实验”——世界上我们可以利用的一种随机性来源。一个有效的[工具变量](@entry_id:142324)（我们称之为 $Z$）具有三个特殊属性[@problem_id:4557727]：
1.  **相关性**（Relevance）：它与治疗选择相关（$Z \to X$）。
2.  **排他性**（Exclusion）：它不通过治疗以外的任何方式影响结局。不存在直接路径 $Z \to Y$。
3.  **独立性**（Independence）：它与困扰治疗-结局关系的任何未测量混杂因素均不相关（$Z \perp U$）。

一个经典的例子是向患者发送一封随机的鼓励信，以促进某种疗法的接受度。信件的随机分配本身不影响健康（排他性和独立性），但它确实推动人们接受治疗（相关性）。这种随机的推动成了一个“工具”，在某些假设下，使我们能够估计该疗法的因果效应，而不受通常的混杂因素污染。

这段从模拟理想试验到与混杂、时间和不确定性搏斗的旅程，揭示了观察性研究深刻的挑战与美。它不仅要求技术技能，更要求对因果关系原则的深刻尊重，对自然界所设圈套的创造性眼光，以及对我们真正能知道什么的根本谦卑。

