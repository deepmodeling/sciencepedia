## 应用与跨学科联系

现在我们已经探索了如何构建 k-近邻图的基本机制，你可能会想，“这有什么用？”这似乎是一个相当简单，甚至近乎琐碎的构造。我们取一堆数据点，为每个点画线连接到它最近的朋友。这有什么深刻之处？答案是，而且是一个美丽的答案：这种识别局部邻域的简单行为是现代数据分析中最强大和最普遍的思想之一。它将一个静态的点集合转变为一个我们可以探索的动态景观、一个关系网。这个图变成了一种罗塞塔石碑，让我们能够将邻近性的语言翻译成结构、过程甚至物理定律的语言，横跨惊人范围的科学学科。让我们踏上旅程，看看它是如何做到的。

### 图作为[流形](@entry_id:153038)：绘制生物学景观

近年来，k-NN 图最引人注目的应用或许是在单细胞生物学领域。想象一下，你测量了一百个千个细胞中每个细胞的两万个基因的表达水平。现在每个细胞都是一个位于两万维空间中的点。这听起来复杂得令人绝望！但生物学并非随机。[生物过程](@entry_id:164026)，比如[干细胞分化](@entry_id:270116)为神经元或肌肉细胞，是连续的旅程。细胞的状态并非随机散布在这个广阔的空间中；它们位于一个错综复杂的、较低维度的表面上——一个“[流形](@entry_id:153038)”。

k-NN 图是我们发现和近似这个隐藏[流形](@entry_id:153038)的主要工具。通过连接在基因表达空间中彼此接近的细胞，我们实际上是在这个景观上绘制道路网络。一旦我们有了这张地图，可能性就变得惊人。我们可以定义一种发育上的“时间”，生物学家称之为*伪时间*，只需[计算图](@entry_id:636350)上从一个指定的起始细胞——一个祖细胞或干细胞——到其他每个细胞的[最短路径距离](@entry_id:754797)。这条路径的长度，即我们近似[流形](@entry_id:153038)上的一条[测地线](@entry_id:269969)，成为衡量细胞发育进程的定量指标 [@problem_id:2892308]。

让我们具体化这个过程。假设我们正在研究反应性星形胶质细胞（一种脑细胞）如何对损伤做出反应。我们假设其中一些细胞首先增殖（分裂），然后分化形成胶质瘢痕。我们可以直接检验这个想法 [@problem_id:2744811]。我们首先构建单细胞数据的 k-NN 图。我们将增殖基因表达最高的细胞确定为过程的“根”。然后我们使用像 Dijkstra 这样的[最短路径算法](@entry_id:634863)计算所有其他细胞的[伪时间](@entry_id:262363)。现在进行检验：瘢痕相关基因的表达是否随着伪时间的增加而增加？增殖基因的表达是否减少？如果是这样，我们就为我们假设的轨迹提供了强有力的证据。k-NN 图使我们能够将一个生物学假设转化为一个可检验的、定量的问题。

这个景观中可能有岔路口——即细胞谱系分裂成两种不同命运的分岔点。我们可以通过分析 k-NN 图的拓扑结构来检测这些点。分支点通常对应于图中简化“骨干”上连接数异常高的节点。通过使用巧妙的统计检验，例如，通过将我们的图与保留局部密度但打乱全局结构的重连版本进行比较，我们可以确定观察到的分岔是真实的生物学事件还是仅仅是噪声的假象 [@problem_id:2652771]。

当然，这张地图并非完美。一个有趣的微妙之处出现在非常罕见的细胞类型上。用于在 k-NN 图上寻找社群或簇的算法通常通过最大化一个名为“模块度”的质量得分来工作。然而，这个得分有一个“[分辨率极限](@entry_id:200378)”，即倾向于偏爱更大、更均匀的社群。一个微小的稀有细胞簇，即使是独特的，也可能被一个大的相邻簇“吞噬”，因为合并它们会产生更高的整体模块度得分。这教给我们一个关键的教训：我们的工具有其自身的偏见，理解这些偏见与使用它们同样重要 [@problem_id:2429790]。

### 图作为通信网络：平滑信号与传播信息

让我们转换一下视角。与其关注图*上*的路径，不如思考图*中*发生的过程。k-NN 图的边定义了一个通信网络。如果两个节点相连，意味着它们相似。因此，我们为它们测量的任何属性也应该相似。我们可以利用这一原理来清理嘈杂的数据。

考虑 RNA 速度的概念，它通过比较未[剪接](@entry_id:181943)和已[剪接](@entry_id:181943)的信使 RNA 的数量来估计细胞的未来状态。单个细胞的这些估计可能非常嘈杂。然而，通过构建 k-NN 图，我们可以为每个细胞创建一个“平滑”的速度，即取其邻居速度的加权平均值。非常近的细胞对平均值的贡献更大，而较远的邻居贡献较小。这种由图介导的局部平均，滤除了噪声，并揭示了细胞在发育景观中的连贯“流动”，使生物过程的方向变得异常清晰 [@problem_id:3346415]。

邻居之间通信的这种思想在机器学习中，特别是在[半监督学习](@entry_id:636420)中，得到了强有力的体现。想象一下，你有一个庞大的数据集，但你只成功标记了其中的一小部分。你如何利用未标记的数据？你在*所有*点上构建一个 k-NN 图，包括已标记和未标记的点。这个图现在充当了一个管道。已知点上的标签可以“传播”或“[扩散](@entry_id:141445)”到它们未标记的邻居。这个过程可以用[图拉普拉斯算子](@entry_id:275190)优雅地形式化，该算子衡量一个函数在图上的“平滑”程度。我们为未标记的点寻找一组标签预测，这组预测既要与已知标签一致，又要在图的结构上尽可能平滑。这个美丽的想法将[图论](@entry_id:140799)与线性代数和优化联系起来，使我们能够用极少的标记数据做出惊人准确的预测 [@problem_id:3135647]。

### 超越抽象空间：现实与概念世界中的图

我们构建 k-NN 图的“空间”不必是抽象的基因表达空间。它可以是物理世界本身。在[空间转录组学](@entry_id:270096)中，我们在组织切片的已知物理位置测量基因表达。我们可以通过连接物理上接近的点来构建图，例如，使用 k-NN 或基于半径的方法。在这里，图代表了直接的细胞间通信的潜力。我们甚至可以做得更复杂：边的权重不仅可以反映物理距离，还可以反映[组织学](@entry_id:147494)边界的存在。如果两点之间的一条线从（比如说）肿瘤区域跨越到健康组织区域，我们可以惩罚该边的权重。由此产生的图成为组织通信架构的高保真模型，同时考虑了邻近性和物理屏障 [@problem_id:3320417]。

这个概念是如此普遍，以至于可以应用于既非生物学也非物理学的世界。考虑一下由一系列文本文档所捕捉的思想世界。我们可以将每个文档表示为一个高维向量（例如，一个 [TF-IDF](@entry_id:634366) 向量），并构建一个 k-NN 图，其中“距离”不是[欧几里得距离](@entry_id:143990)，而是一种语义相似性的度量，比如余[弦距离](@entry_id:170189)。这个[图连接](@entry_id:267095)了讨论相似主题的文档。这是著名的 Isomap [降维](@entry_id:142982)算法的第一步也是最关键的一步。通过计算这个“思想之图”中的最短路径，Isomap 通常可以“展开”一个复杂的主题[流形](@entry_id:153038)，并揭示一个主题在大型语料库中简单的一维演进 [@problem_id:3133675]。

图框架的灵活性也允许优雅地整合不同种类的信息。在另一个生物学例子中，我们可能对每个细胞有两种数据来源：其基因表达和一个来自[谱系追踪](@entry_id:193680)实验的独特遗传“条形码”，后者告诉我们哪些细胞在克隆上是相关的。我们可以像往常一样，基于基因表达相似性构建一个 k-NN 图。但是，然后我们可以使用谱系信息来修改边的权重。我们可以对任何连接两个我们从其条形码中知道没有共同近祖的细胞的边施加重罚。这迫使任何最短路径计算（如[伪时间](@entry_id:262363)）都必须尊重已知的克隆关系，从而提供一个更加受限且生物学上更忠实的轨迹 [@problem_id:2637982]。

### 终极抽象：基础[物理学中的对称性](@entry_id:144576)

要真正体会 k-NN 图的统一力量，我们可以将它带到基础物理学的领域。想象一下分析大型强子对撞机中一次粒子碰撞的后果。该事件由一簇新产生的粒子组成，每个粒子都有测量的动量和能量。我们可以将此事件表示为一个图，其中每个粒子是一个节点。但我们如何连接它们？我们在[粒子探测器](@entry_id:273214)的自然[坐标系](@entry_id:156346)中构建一个 k-NN 图：赝[快度](@entry_id:265131)和[方位角](@entry_id:164011)空间，$(\eta, \phi)$。距离 $\Delta R = \sqrt{(\Delta\eta)^2+(\Delta\phi)^2}$ 衡量粒子之间的角分离。

在这里，一个深刻的原理出现了。我们的分析工具——图——必须尊重物理世界的[基本对称性](@entry_id:161256)。物理定律不关心我们的探测器在空间中如何定向。它们对绕束流轴的旋转和沿束流轴的增强变换是不变的。因此，我们在图的节点或边上定义的任何特征也必须具备这些[不变性](@entry_id:140168)。这意味着我们不能使用像 $\phi$ 这样的绝对坐标，或像能量 $E$ 这样在增强变换下会改变的量。相反，我们必须使用相对量，如角度差 $\Delta \phi_{ij}$ 或[快度](@entry_id:265131)差 $\Delta y_{ij}$，以及[不变量](@entry_id:148850)，如横向动量 $p_T$。我们图的设计本身——其特征的选择——必须编码[洛伦兹不变性](@entry_id:155152)的深层对称性。这是一个惊人的例子，展示了计算工具和基本物理定律如何变得密不可分 [@problem_id:3510625]。

从绘制单个细胞的分化过程，到映射人类思想的概念流，再到在[粒子碰撞](@entry_id:160531)中编码宇宙的基本对称性，k-近邻图证明了它远不止是一种简单的算法。它是一种语言——一种用于描述从局部关系中涌现的结构的通用而直观的语言。通过简单地将点与其朋友连接起来，我们开启了一种看待我们周围复杂世界中隐藏秩序的新方式。