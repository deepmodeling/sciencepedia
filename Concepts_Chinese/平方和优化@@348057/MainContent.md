## 引言
证明一个函数总是非负的，是许多科学领域中的一个基本挑战，从确保机器人的稳定性到验证物理学中的[基态能量](@article_id:327411)。虽然对于基本函数而言这很简单，但对于复杂多元多项式，这项任务几乎变得不可能，因为简单地测试一些点并不能保证其普适的正性。在为复杂系统的安全性和性能提供确定性的“正性证明”方面，这一差距构成了一个关键障碍。

[平方和 (SOS) 优化](@article_id:354352)作为一种强大而优雅的解决方案应运而生。它不是检查无限多的点，而是试图将一个多项式重写为其他多项式的平方和，从而提供一个有限的、代数的非负性证明。本文全面概述了这一技术，引导读者从其基本概念到实际应用。

接下来的“原理与机制”一章将深入探讨其核心理论，解释多项式正性这一抽象问题如何转化为一个可解的矩阵问题——[半定规划 (SDP)](@article_id:332315)。我们将探讨实现这一转化的巧妙的格拉姆矩阵方法，讨论对偶性的深刻概念，并直面该方法固有的局限性，如保守性和“[维度灾难](@article_id:304350)”。在这一理论基础之后，“应用与跨学科联系”一章将展示 SOS 优化的卓越通用性，展示其在解决控制理论、信号处理甚至[计算生物学](@article_id:307404)等领域现实世界问题中的应用。

## 原理与机制

想象一下，你是一名工程师，任务是保证一个复杂的机械臂始终保持在其安全操作区域内；或者你是一名物理学家，希望证明一个系统的能量永远不会低于某个[基态](@article_id:312876)。这些问题的核心是一个出人意料的深层数学挑战：你如何确定一个给定的函数，比如 $P(x_1, x_2, \dots, x_n)$，总是非负的？

对于一个简单的高中抛物线 $f(x) = ax^2 + bx + c$，这很简单。但对于一个包含许多变量的复杂多项式，其[函数图像](@article_id:350787)可能是一个我们甚至无法想象的高维空间中由山峰和山谷构成的崎岖地形。测试一百万甚至十亿个点可能会给我们一些信心，但这并非证明。总可能存在一个微小的、隐藏的山谷，函数值在那里会降到负数。我们需要一个确切的证明，一个无可辩驳的正性证明。

### 对正性的追求

如果我们能在多项式本身内部找到一种[代数结构](@article_id:297503)，从本质上保证其非负性，那会怎样？这就是**[平方和 (SOS) 优化](@article_id:354352)**背后优美而强大的思想。其逻辑简单得近乎骗人：任何数的平方都是非负的。因此，任何平方数之和也都是非负的。

如果我们能将复杂的多项式 $P(x)$ 重写为其他多项式的平方和，比如 $P(x) = \sum_{i} h_i(x)^2$，那么我们就找到了我们的证明。对于任何输入 $x$，等式右边是一系列实数的平方和，永远不可能是负数。因此，$P(x)$ 必须在任何地方都是非负的。这是一个代数证明，一个确定性的印记，对所有可能的输入都有效，无需检查任何一个点。这就是[平方和](@article_id:321453)技术的核心承诺。但这引出了下一个关键问题：我们究竟如何找到那些 $h_i(x)$ 函数呢？

### 罗塞塔石碑：从多项式到矩阵

直接搜索分量多项式 $h_i(x)$ 是一项艰巨的任务。SOS 的神奇之处在于它提供了一块“罗塞塔石碑”，将这个难题转化到一个完全不同且更易于管理的领域：矩阵世界。这种转化是通过**[格拉姆矩阵](@article_id:381935)**方法实现的。[@problem_id:2735054]

让我们通过一个具体例子来一探究竟。假设我们有一个候选的系统能量多项式 $V(x_1, x_2) = x_1^4 + x_2^4 + c x_1^2 x_2^2$，我们想知道参数 $c$ 取何值时，这个“能量”可以通过 SOS 方法被证明是非负的。

首先，我们将多项式分解成其基本构件。由于 $V$ 是一个 4 次多项式，它的“平方根”应该是 2 次多项式。因此，我们创建一个向量，称之为 $z(x)$，包含所有 2 次的单项式构件：
$$
z(x) = \begin{pmatrix} x_1^2 \\ x_1 x_2 \\ x_2^2 \end{pmatrix}
$$
现在，我们假设我们的多项式 $V(x)$ 可以写成一个使用这些构件和一个当前未知的[对称矩阵](@article_id:303565) $Q$（我们称之为[格拉姆矩阵](@article_id:381935)）的二次型形式：
$$
V(x) = z(x)^{\top} Q z(x) = \begin{pmatrix} x_1^2 & x_1 x_2 & x_2^2 \end{pmatrix} \begin{pmatrix} q_{11} & q_{12} & q_{13} \\ q_{12} & q_{22} & q_{23} \\ q_{13} & q_{23} & q_{33} \end{pmatrix} \begin{pmatrix} x_1^2 \\ x_1 x_2 \\ x_2^2 \end{pmatrix}
$$
如果我们把它乘开，会得到一个新多项式，其系数是 $q_{ij}$ 项的[线性组合](@article_id:315155)。通过强制这个新多项式与我们原来的 $V(x)$ 完全相同，我们推导出一组 $Q$ 的元素必须满足的简单[线性方程](@article_id:311903)。对于我们的例子，这会给出像 $q_{11} = 1$、$q_{33} = 1$、$2q_{12} = 0$ 和 $q_{22} + 2q_{13} = c$ 这样的条件。[@problem_id:2735054]

这里的核心联系是：一个多项式是平方和，当且仅当存在一个满足这些[线性方程](@article_id:311903)的**[半正定](@article_id:326516) (PSD)** [格拉姆矩阵](@article_id:381935) $Q$。一个矩阵 $Q$ 是半正定的（写作 $Q \succeq 0$），如果对于任何向量 $y$，数值 $y^\top Q y$ 都是非负的。它是非负数在矩阵中的模拟。

如果我们找到了这样一个 $Q \succeq 0$，我们就有了我们的证明。为什么？因为任何 PSD 矩阵都有一个“[矩阵平方根](@article_id:319334)”，意味着它可以被分解为 $Q = L L^\top$。将此代入我们的表达式中得到：
$$
V(x) = z(x)^\top L L^\top z(x) = (L^\top z(x))^\top (L^\top z(x))
$$
最后的表达式是向量 $L^\top z(x)$ 各元素平方的和。我们明确地找到了[平方和](@article_id:321453)！寻找 SOS 证明的过程已经转化为寻找一个满足[线性约束](@article_id:641259)的 PSD 矩阵。这类问题被称为**[半定规划 (SDP)](@article_id:332315)**，是一类凸优化问题，值得注意的是，我们有高效的[算法](@article_id:331821)来解决它们。[@problem_id:2721600] 我们已将一个关于多项式的棘手问题转化为了一个关于矩阵的可解问题。对于我们的例子多项式，这个机制揭示了它当且仅当 $c \ge -2$ 时是 SOS。[@problem_id:2735054]

### 真实与证明之间的鸿沟

这个机制似乎好得令人难以置信。是否有可能，每一个真正非负的多项式都可以写成[平方和](@article_id:321453)的形式？如果是这样，我们的 SOS 方法将成为一个完美、普适的正性检验方法。

可惜，世界更为微妙。正如 David Hilbert 在 19 世纪末发现的那样，答案是否定的。存在一些在任何地方都非负，但永远无法分解为平方和的多项式。其中最著名的是 **Motzkin 多项式**：[@problem_id:533607]
$$
M(x, y) = x^4 y^2 + x^2 y^4 - 3x^2 y^2 + 1
$$
我们可以用微积分或其他方法证明，对于所有实数 $x$ 和 $y$，$M(x, y) \ge 0$。然而，却无法将其写成 $\sum_i h_i(x,y)^2$ 的形式。

这揭示了*真实*（所有非负多项式的集合）与用 SOS 证明*可证*的内容之间存在根本性的鸿沟。SOS 多项式的集合是非负多项式集合的一个严格子集。[@problem_id:2735058] [@problem_id:2721600] 这意味着，当我们使用 SOS 作为非负性的代理时，我们引入了**保守性**。我们可能会遇到一个完全稳定的系统，其真实的李雅普诺夫函数是非负的但不是 SOS。我们基于 SOS 的搜索将会失败，并报告找不到证明，即使一个（不同类型的）证明是存在的。这是我们为计算上的可行性付出的代价。

### 超越全局真实：被约束的证明

在科学和工程中，我们常常不需要一个在所有可能情况下都成立的保证。我们可能只需要证明一个系统只要其状态保持在某个有界区域 $\mathcal{S}$ 内就是稳定的，例如，在一个代表最大能量水平的椭球体内。二次李雅普诺夫函数，形如 $V(x) = x^\top P x$，只能证明凸的、[椭球](@article_id:345137)形区域的稳定性。但现实世界中的安全集可以有复杂的、非凸的形状。这是高阶 SOS 多项式的灵活性大放异彩的另一个领域。[@problem_id:2735058]

我们如何利用我们这种在任何地方都有效的代数 SOS 机制，来证明一个只需要在特定集合 $\mathcal{S}$ 上成立的性质呢？假设我们的集合是由一个不等式 $g(x) \ge 0$ 定义的。诀窍是巧妙地修改我们试图证明的陈述。

这个想法在一个名为 **Positivstellensatz**（德语，意为“正性定理”）的结果中被形式化。它的一个简单版本是 **S-procedure**。[@problem_id:2715994] 为了证明对于所有满足 $g(x) \ge 0$ 的 $x$ 都有 $P(x) \ge 0$，我们可以寻找一个 SOS 乘子多项式 $\sigma(x)$，使得以下表达式全局上是平方和：
$$
P(x) - \sigma(x) g(x) \quad \text{是 SOS}
$$
让我们看看这为什么有效。我们构建了一个对所有 $x$ 都成立的恒等式。现在，让我们将注意力限制在集合 $\mathcal{S}$ 上，其中 $g(x) \ge 0$。在这个集合上，由于 $\sigma(x)$ 是 SOS，它也是非负的。因此，项 $\sigma(x)g(x)$ 是非负的。我们的 SOS 条件告诉我们 $P(x) - \sigma(x)g(x) \ge 0$，这意味着 $P(x) \ge \sigma(x)g(x)$。由于右侧在 $\mathcal{S}$ 内部是非负的，我们必须有 $P(x) \ge 0$ 在 $\mathcal{S}$ 内部。这是一个漂亮的代数技巧，它使用一个全局证明来证明一个局部性质。

完整的 Positivstellensatz 将这个想法扩展到由多个多项式不等式 $g_i(x) \ge 0$ 定义的集合。它给我们一个强大的定理：在某些条件下（即集合是紧的，或称“阿基米德的”），任何在该集合上*严格*为正的多项式都可以用 SOS 乘子来表示。[@problem_id:2738240] 这里出现了一个微妙之处：该定理保证了对严格正多项式（$P(x) > 0$）的证明，但我们常常想证明非负性（$P(x) \ge 0$）。优雅的解决方案是添加一个微小的正“松弛”项 $\varepsilon$，并证明 $P(x) + \varepsilon$ 在该集合上是正的。这为定理和实际计算之间提供了严谨的联系。[@problem_id:2738240]

### 硬币的两面：对偶性与一个惊人的联系

对 SOS 优化的探索揭示了又一层深刻的美，一个来自优化理论的概念，称为**对偶性**。每个优化问题，我们可以称之为“原问题”，都有一个相应的“[对偶问题](@article_id:356396)”，它对同一个问题提供了不同的视角。

我们寻找多项式 $P(x)$ 最小值的原问题是：
> 找到最大的数 $\gamma$，使得多项式 $P(x) - \gamma$ 是一个平方和。

这为 $P(x)$ 的最小值提供了一个经过验证的下界。那么，它的[对偶问题](@article_id:356396)是什么？对偶问题完全出人意料：[@problem_id:2222633]
> 在 $x$ 的空间上找到一个概率测度，以最小化 $P(x)$ 的[期望值](@article_id:313620)。

“概率测度”是为空间的不同区域分配权重的一种方式。对偶问题试图找到最巧妙的方式来分布这个权重，以使多项式的平均值尽可能小。这个对偶问题中的变量是测度的**矩**——诸如均值、方差和偏度等统计量的抽象。

[弱对偶](@article_id:342496)性的核心原则表明，对偶问题的解总是原问题解的一个下界。对于许多 SOS 问题，更强的**[强对偶性](@article_id:355058)**成立。这意味着代数原问题的最优值与概率对偶问题的最优值*完全相等*。而且很多时候，这个共同的值就是多项式的真正[全局最小值](@article_id:345300)。

但真正的魔力在于，对偶问题的解——最优矩的集合——包含了几何信息。它像一个指纹，记录了最小值在何处取得。从这一串数字中，人们常常可以代数地重构出全局最小化点的坐标 $(x_1, x_2, \dots)$。[@problem_id:2222633] 此外，如果一个 SOS 程序是不可行的，相应的对偶问题会提供一个不可行性的证明，这通常可以解释为空间中一个特定的“反例”点，在该点[期望](@article_id:311378)的正性条件不成立。[@problem_id:2721665] 这种代数、几何和概率之间的相互作用是数学概念统一性的一个惊人例子。

### 力量的代价：维度灾难

所以，我们有了一种“超能力”：一种能够推理无限可能性空间的计算方法。那代价是什么？代价是现代科学中一个熟悉的恶棍：**维度灾难**。

SOS 机制要求我们构建一个[格拉姆矩阵](@article_id:381935)。这个矩阵的大小取决于我们多项式中的变量数量 $n$ 和其次数 $2d$。具体来说，矩阵的边长由组合项 $\binom{n+d}{d}$ 给出。这个数字呈爆炸性增长。[@problem_id:2738194] [@problem_id:2695269] 对于一个 2 变量（$n=2$）的 4 次多项式（$d=2$），矩阵是一个很小的 $3 \times 3$。对于 $n=12$，正如我们一个思想实验中看到的，它已经是一个 $91 \times 91$ 的矩阵。[@problem_id:2695269] 对于一个 10 变量的 10 次多项式，矩阵大小超过 100,000！

计算机解决所得 SDP 所需的时间大约与矩阵大小的立方成正比。这意味着计算成本急剧上升，使得具有许多变量或高次数的问题在这种“稠密”的表述下完全无法处理。这是 SOS 优化的[基本权](@article_id:379571)衡：增加我们多项式证明的次数可以减少保守性并找到更好的解，但代价是惩罚性的[计算成本](@article_id:308397)。[@problem_id:2738194]

这一现实激发了新一轮的研究。实践者使用巧妙的启发式方法，比如从低次多项式开始，在关注计算预算的同时迭代增加次数。[@problem_id:2721665] 他们还使用预处理技巧，比如重新缩放坐标，使数值问题更加稳定。[@problem_id:2721665] 在该领域的前沿，研究人员正在开发更具[可扩展性](@article_id:640905)的方法，利用问题结构（如**稀疏 SOS**），或使用更具限制性但检查速度更快的 SOS 条件的内部近似，例如**[对角占优](@article_id:304046)[平方和](@article_id:321453) (DSOS)**，这可以用更快的[线性规划](@article_id:298637) (LPs) 来检查。[@problem_id:2695269] 这项持续进行的工作延续了这样一个追求：在驯服[维度灾难](@article_id:304350)的同时，驾驭代数确定性的力量。