## 引言
我们如何在不切开物体的情况下，观察其复杂的内部结构？这个基本问题推动了从[医学诊断](@entry_id:169766)到[材料科学](@entry_id:152226)等领域的断层成像技术的发展。单次 X 射线只能提供一个平面的阴影，而从多个角度拍摄的一系列此类图像则包含了通过计算重建三维视图所需的数据。然而，挑战在于求解一个巨大的数学[方程组](@entry_id:193238)，该[方程组](@entry_id:193238)将这些投影测量值与未知的内部密度联系起来。代数重建技术（ART）为这个复杂的[逆问题](@entry_id:143129)提供了一种优雅而强大的迭代解法。

本文将探讨 ART 的理论与实践。在第一部分 **原理与机制** 中，我们将剖析该算法，从其作为[线性方程组](@entry_id:148943)的数学表述开始。我们将揭示 Kaczmarz 方法背后的几何直觉，理解其在真实世界噪声存在时的行为，并了解如何无缝地集成物理约束。在这一理论基础之后，第二部分 **应用与跨学科联系** 将展示 ART 如何应用于关键领域，揭示其在革新医学成像、分子生物学和[流体动力学](@entry_id:136788)方面所扮演的角色。我们首先来审视使这项技术如此高效的核心原理。

## 原理与机制

想象一下，你想在不切开一个精细物体（比如一个水果）的情况下了解其内部结构。单张 X 射线照片是无济于事的；它只是一个阴影，一个失去了所有深度信息的平面投影。它告诉你沿每条视线的总密度，但没有说明该密度位于何处。但是，如果你从许多不同角度拍摄了许多张阴影图片呢？你是否能据此重建该物体的三维形态？这正是断层成像的核心问题，而代数重建技术（ART）为此提供了一个既简洁又强大的答案。

### 从阴影到方程

让我们将这个想法形式化。我们想要成像的物体可以用一个函数 $\mu(\mathbf{r})$ 来表示，该函数给出了空间中每一点 $\mathbf{r}$ 的 X 射线衰减（或密度）。一束沿直线 $\ell_i$ 传播的 X 射[线束](@entry_id:167936)在穿过物体时会变暗。探测器测量到的总衰减（我们称之为 $b_i$）是沿该路径所有衰减的总和。用微积分的语言来说，这是一个线积分：$b_i = \int_{\ell_i} \mu(s) ds$。

为了在计算机上解决这个问题，我们必须将世界数字化。我们将成像区域分割成一个由微小方块或立方体组成的网格，这些单元被称为**像素**（在三维中称为体素）。我们假设在每个像素 $j$ 内部，衰减是恒定的，这个单一的未知值我们称之为 $x_j$。我们那个优美的[连续函数](@entry_id:137361) $\mu(\mathbf{r})$ 现在被这些像素值的集合所近似。当我们将所有这些未知的像素值堆叠成一个长向量 $\mathbf{x}$ 时，这个向量就成为了我们试图寻找的图像的数字表示。

那么，我们的线积分会发生什么变化呢？积分变成了求和。射线 $i$ 的总衰减现在是它所穿过的每个像素贡献的总和。像素 $j$ 的贡献是其未知的衰减值 $x_j$ 乘以射线 $i$ 穿过该特定像素的路径长度。我们称这个相交长度为 $a_{ij}$。因此，我们的测量值变成了一个简单的加权和：

$$
b_i = a_{i1}x_1 + a_{i2}x_2 + \dots + a_{in}x_n = \sum_{j=1}^n a_{ij}x_j
$$

这是一个单一的[线性方程](@entry_id:151487)。如果我们从所有不同的阴影图片中获取成千上万甚至数百万次测量，我们就会得到一个庞大的[线性方程组](@entry_id:148943)，我们可以将其紧凑地写成矩阵形式 $A \mathbf{x} = \mathbf{b}$。[@problem_id:3393597]

向量 $\mathbf{b}$ 是我们的已知量列表——来自探测器的数据。向量 $\mathbf{x}$ 是我们的未知量列表——隐藏图像的像素值。矩阵 $A$ 是“[系统矩阵](@entry_id:172230)”，它不仅仅是数字的抽象集合。它是一个[几何映射](@entry_id:749852)，编码了我们使用的每一束 X 射线的精确路径。每个元素 $a_{ij}$ 都是一个物理量：第 $i$ 条射线与第 $j$ 个像素相交的长度。[@problem_id:2449831] 构建这个矩阵是任何重建问题的第一步。

### 一个（直接）求解过于庞大的问题

我们的问题被框定为 $A \mathbf{x} = \mathbf{b}$。对于一次典型的医学 CT 扫描，未知像素值的数量 $n$ 可能达到数百万。射线测量的数量 $m$ 也可能达到数百万。矩阵 $A$ 是巨大的——如果 $n=1,000,000$，那么 $A$ 理论上可以有 $10^{12}$ 个元素！幸运的是，由于任何给定的射线只穿过总像素中的一小部分，因此 $A$ 中的大多数元素都是零。它是一个**稀疏**矩阵。

尽管如此，求解这个系统仍然是一项艰巨的挑战。教科书式的方法可能是计算一个[最小二乘解](@entry_id:152054)，例如通过求解所谓的**正规方程** $A^\top A \mathbf{x} = A^\top \mathbf{b}$。然而，在实践中这通常是一个糟糕的主意。构建矩阵 $A^\top A$ 的计算成本可能很高，更关键的是，它会使问题对误差变得更加敏感。如果原始矩阵 $A$ 是病态的（意味着数据 $\mathbf{b}$ 的微小变化会导致解 $\mathbf{x}$ 的巨大变化），那么 $A^\top A$ 的条件数是 $A$ 的[条件数](@entry_id:145150)的*平方*。这种平方操作会将一个敏感问题变成一个无可救药的不稳定问题。[@problem_id:3393579] 我们需要一种更巧妙、更温和的方法。

### Kaczmarz 的优雅思想：一次一步

1937年，波兰数学家 Stefan Kaczmarz 提出了一个极其简单的想法。与其试图一次性解决整个庞大的[方程组](@entry_id:193238)，不如我们一次只考虑一个方程？

让我们从几何角度思考。每个[线性方程](@entry_id:151487) $a_i^\top \mathbf{x} = b_i$（我们系统中的第 $i$ 行）在所有可能图像构成的高维空间中定义了一个**超平面**。[超平面](@entry_id:268044)只是二维空间中的直线或三维空间中的平面的推广。“真实”的图像向量 $\mathbf{x}$ 必须满足*所有*方程，这意味着它必须位于*所有*这些超平面的交点上。

作为 ART 核心的 Kaczmarz 方法，并非通过蛮力来寻找这个交点，而是通过在超平面之间“之字形”移动来实现。我们从一个初始猜测 $\mathbf{x}^{(0)}$（可能只是一个均匀的灰色图像）开始。然后，我们选取第一个方程 $a_1^\top \mathbf{x} = b_1$。我们当前的猜测很可能不满足这个方程。因此，我们将 $\mathbf{x}^{(0)}$ [正交投影](@entry_id:144168)到第一个[超平面](@entry_id:268044) $H_1$ 上，得到我们的下一个猜测 $\mathbf{x}^{(1)}$。这个新点是 $H_1$ 上离我们旧猜测最近的点，并且保证满足第一个方程。

接下来，我们取 $\mathbf{x}^{(1)}$ 并将其投影到第二个[超平面](@entry_id:268044) $H_2$ 上，得到 $\mathbf{x}^{(2)}$。然后我们将 $\mathbf{x}^{(2)}$ 投影到 $H_3$ 上，依此类推，重复地循环遍历所有方程。奇迹般地，这一系列投影会收敛到期望的解点——那个同时满足所有测量约束的地方。[@problem_id:3393590]

这个投影的数学公式和其思想本身一样简单。对于第 $i$ 个方程的更新步骤是：

$$
\mathbf{x}^{(k+1)} = \mathbf{x}^{(k)} + \omega \frac{b_i - a_i^\top \mathbf{x}^{(k)}}{\|a_i\|^2} a_i
$$

让我们来分解一下这个公式。项 $b_i - a_i^\top \mathbf{x}^{(k)}$ 是**残差**，它告诉我们当前的猜测距离满足第 $i$ 个方程有多远。我们将这个误差除以行[向量的范数](@entry_id:154882)平方 $\|a_i\|^2$，再乘以向量 $a_i$ 本身（[超平面](@entry_id:268044)的法向量）。整个分数部分就是我们需要沿着垂直于[超平面](@entry_id:268044)的方向移动的步长，以便精确地落在超平面上。参数 $\omega$ 是一个**松弛参数**；设置 $\omega=1$ 即为我们刚才描述的[正交投影](@entry_id:144168)。这种方法属于“行作用”方法族，因为它一次只对系统的一行进行操作。[@problem_id:3393597]

### 收敛的几何学

为什么这种投影之舞会奏效？答案在于超平面的几何结构。迭代[序列收敛](@entry_id:143579)到解的速度取决于超平[面法向量](@entry_id:749211) $a_i$ 之间的夹角。想象两条几乎平行的线（二维空间中的[超平面](@entry_id:268044)）。从一个点投影到一条线上，然后再投影到另一条线上，只会朝着它们遥远的交点迈出一小步。相反，如果两条线是正交的，你只需两步就能到达交点。

这个概念可以用**相干性** $\mu$ 来描述，即任意两个不同行向量之间夹角余弦的[绝对值](@entry_id:147688)的最大值。如果[相干性](@entry_id:268953)高（接近1），超平面就几乎平行，收敛速度就慢。一个两步循环中最差情况下的误差减少量正是由这个[相干性](@entry_id:268953)值决定的。[@problem_id:3393580] 这为断层成像为什么需要从大范围角度进行投影提供了一个优美的几何直觉：我们希望使[系统矩阵](@entry_id:172230)的行向量尽可能不平行（非相干），以确保快速收敛。有趣的是，虽然人们可能认为调整松弛参数 $\omega$ 是关键，但对于 Kaczmarz 方法的[随机化](@entry_id:198186)版本，简单地选择 $\omega=1$ 通常是最佳的。[@problem_id:3266569]

### 驯服噪声：提[早停](@entry_id:633908)止的艺术

在现实世界中，我们的测量值 $\mathbf{b}^\delta$ 会受到[噪声污染](@entry_id:188797)。这意味着我们的[方程组](@entry_id:193238) $A\mathbf{x} = \mathbf{b}^\delta$ 很可能是**不相容的**——超平面不再交于一点，而是形成一个模糊、纠缠的区域。

如果我们让 ART 算法迭代次数过多，它会努力寻找一个尽可能接近所有这些不匹配的[超平面](@entry_id:268044)的点。在此过程中，它开始“拟合噪声”，在重建图像中引入与测量噪声相对应而非与底层物体相对应的虚假伪影。这种现象被称为**[半收敛](@entry_id:754688)**：迭代解首先接近真实解，但随后随着开始对噪声进行建模而发散。

这一观察揭示了一个深刻的联系：对于[不适定问题](@entry_id:182873)，迭代次数 $k$ 本身就充当了**[正则化参数](@entry_id:162917)**。提[早停](@entry_id:633908)止迭代可以防止解被[噪声污染](@entry_id:188797)。这种[迭代正则化](@entry_id:750895)与 Tikhonov 正则化等更经典的方法密切相关。我们甚至可以推导出一个函数 $\alpha(k)$，将迭代次数 $k$ 映射到一个等效的 Tikhonov 参数 $\alpha$，从而统一这两种观点。[@problem_id:3393577]

这就引出了一个关键的实践问题：我们应该何时停止？一个强有力的思想是**偏差原则**。假设我们知道数据中的总体噪声水平 $\delta = \|\eta\|_2$。寻求一个解 $\mathbf{x}$，使其拟合带噪数据 $A\mathbf{x} \approx \mathbf{b}^\delta$ 的误差小于 $\delta$ 本身是没有意义的，因为那将意味着我们在拟合噪声。偏差原则告诉我们，一旦残差 $\|A\mathbf{x}^{(k)} - \mathbf{b}^\delta\|_2$ 与噪声水平 $\delta$ 相当，就应停止迭代。这个优雅的[经验法则](@entry_id:262201)可以[防止过拟合](@entry_id:635166)，并从真实世界数据中产生稳定且有意义的重建结果。[@problem_id:3393630]

### 塑造现实：融入物理知识

ART 基于投影的特性赋予了它最后一个极其强大的特点：灵活性。通常，我们对试图重建的图像拥有先验的物理知识。例如，X 射线衰减图不能有负值。这转化为对我们解的一个约束：对于所有像素 $j$，都有 $x_j \ge 0$。

我们如何强制执行这个约束呢？通过另一次投影！所有具有非负像素值的图像集合 $\mathcal{C} = \{\mathbf{x} \mid \mathbf{x} \ge 0\}$ 是一个闭凸集（非负卦限）。我们可以轻易地将任何[向量投影](@entry_id:147046)到这个集合上，只需将其负分量设置为零即可。

我们可以通过创建一个两步[更新过程](@entry_id:273573)将其整合到 ART 中。首先，我们将当前的迭代解投影到测量[超平面](@entry_id:268044) $H_i$ 上。其次，我们将得到的结果投影到约束集 $\mathcal{C}$ 上。这种**投影 ART** 确保了每次迭代不仅更接近于满足测量值，而且持续尊重问题的基本物理原理。这种交替投影的方法是现代[逆问题](@entry_id:143129)求解的基石，它使我们能够将各种信息——测量数据和物理先验——编织成一幅单一、连贯的现实图景。[@problem_id:3393628]

