## 应用与跨学科联系

物理定律不依赖于你身在何处或面朝何方，这个思想有一种深刻而简洁的美。如果你用乐高积木搭建一个分子模型，无论你是在房间中央还是在角落里搭建，无论你是朝北还是朝东搭建，最终的形状都是一样的。这就是我们所说的[特殊欧几里得群](@article_id:299831)，或 $SE(3)$ 对称性的本质。它是刚体运动——平移和旋转——的对称性。这似乎是显而易见的，一个我们几乎注意不到的基本真理。然而，这个简单的想法不仅仅是一个哲学注脚；它是一个强大而实用的设计原则，目前正在科学和工程领域引发一场悄然的革命。

通过将这一原则直接构建到我们的机器学习模型中，我们创造了所谓的 $SE(3)$ [等变网络](@article_id:304312)。这些模型不仅仅是从数据中学习模式；它们以一种与物理定律结构本身相一致的方式学习。它们天生就理解，一个物体的性质不会仅仅因为它的移动或转向而改变。在本章中，我们将踏上一段旅程，看看这同一个思想——这个几何一致性的通用蓝图——如何在从原子的私密舞蹈到机器人手臂运动的公开展示等各种各样的领域中找到其表达。

### 原子与分子世界：[等变性](@article_id:640964)的天然家园

在原子和分子的世界里，几何一致性原则的体现无出其右。[连接原子](@article_id:342120)的力、储存在这些键中的能量，以及分子摆动和[振动](@article_id:331484)的方式——所有这些都只取决于原子的*相对*位置，而不取决于某个固定在实验室墙壁上的绝对[坐标系](@article_id:316753)。我们的[计算模型](@article_id:313052)必须尊重这一点；如果它们不这样做，它们的预测不仅不准确，而且在物理上是荒谬的。

想象一下[计算化学](@article_id:303474)和[材料科学](@article_id:312640)面临的巨大挑战：预测任何原子构型的总势能 $E$。这个单一的数字几乎告诉了我们需要知道的一切——一个[化学反应](@article_id:307389)是否会发生，一种材料将如何响应应力，或者一个蛋白质将如何折叠。这个能量必须是*不变的*；也就是说，如果我们旋转或平移整个原子系统，总能量必须保持完全相同。然而，每个原子上的力是矢量，它们必须是*等变的*——如果你旋转系统，力矢量必须随之旋转。

一个机器学习模型如何可能同时遵守这两个规则呢？答案是我们在前面讨论过的原则最优雅的应用之一。与其试图直接学习复杂、等变的力，我们可以设计一个 $SE(3)$ 不变的网络来学习简单、不变的[标量势](@article_id:339870)能 $E$。一旦我们有了能量的学习函数 $E_\theta(\\{\mathbf{r}_i\\})$，一个基本的物理定律就免费给了我们力！原子 $i$ 上的力就是能量对其位置的负梯度：$\mathbf{F}_i = -\nabla_{\mathbf{r}_i} E_\theta(\\{\mathbf{r}_i\\})$。通过使用现代深度学习的基石——[自动微分](@article_id:304940)的魔力，一个学习不变能量的模型会自动产生完[全等](@article_id:323993)变的力。这个巧妙的技巧不仅确保了几何一致性，还保证了学习到的力是保守的，意味着它们守恒能量，这是物理学的另一个基本定律 [@problem_id:2765008]。这种方法代表了[深度学习](@article_id:302462)架构与经典力学基石原则的强大融合。

当然，为了预测能量，模型需要“看到”每个原子周围的局部环境。早期的方法通过煞费苦心地手工制作描述符——代表邻居之间所有距离和角度的长串数字——来实现这一点。更现代的方法，如原子位置光滑重叠（SOAP），开发了一种更系统的方式来创建旋转不变的特征。但最直接、最强大的方法是使用 $SE(3)$ [等变网络](@article_id:304312)。这样的网络不需要先将几何信息压缩成不变的描述符而丢弃它。相反，它直接处理三维坐标及其关系，在网络的每一层都保持其几何性质，只在最后才产生一个最终的不变能量。这使得模型能够学习到对于复杂材料的准确预测至关重要的、更丰富和更微妙的几何模式 [@problem_id:2837978]。

这种方法的力量远不止于预测能量和力。许多物理性质不是简单的标量或矢量，而是由更高阶的对象——[张量](@article_id:321604)——来描述。例如，分子与光的相互作用方式，决定了其红外或拉曼光谱，这取决于诸如[分子极化率](@article_id:303800)[张量](@article_id:321604)之类的量——一个描述分子电子云在电场中如何变形的 $3 \times 3$ 矩阵。这个[张量](@article_id:321604)不是不变的；当分子旋转时，它的分量会以一种非常具体的方式改变。一个 $SE(3)$ [等变网络](@article_id:304312)可以被设计成不仅能产生标量或矢量，还能产生任何阶数的、以完全物理保真度进[行变换](@article_id:310184)的[张量](@article_id:321604)。这使我们能够构建可以直接预测这些复杂的、依赖于方向的性质的模型，为[计算设计](@article_id:347223)具有特定光学或电子特性的分子打开了大门 [@problem_id:2898167]。

分子的世界还包含一个更深的几何微妙之处：手性，或“手性”。生命分子，如氨基酸和糖，几乎只以两种可能的镜像形式中的一种存在（例如，L-氨基酸，而不是它们的 [D-氨基酸](@article_id:377536)镜像）。这提出了一个有趣的问题：一个只在天然的 L-氨基酸蛋白质上训练的模型，能否预测出非天然的全 D 蛋白质的结构？一个幼稚的应用会失败，因为模型已经学习了 L-蛋白质的特定几何模式，如右手性 [α-螺旋](@article_id:299730)。该模型是 $SE(3)$ 等变的，但镜像反射不属于 $SE(3)$。然而，对对称性的更深刻理解提供了一个惊人简单的解决方案。在[非手性](@article_id:373039)环境（如水）中，物理定律在反射下是对称的。这意味着 D-蛋白质的稳定结构仅仅是 L-蛋白质结构的镜像。因此，我们可以采用我们的网络预测的 L-型结构，对其所有坐标应用一个简单的数学反射，就可以获得 D-蛋白质的一个物理上合理的结构！这是一个对模型从未见过的分子折叠的“零样本”预测，这是通过理解问题的完整[对称群](@article_id:306504)而实现的 [@problem_id:2387802]。

### 从原子到材料：用对称性进行扩展

支配少数原子舞蹈的相同几何原理，也决定了包含数万亿个原子的块状材料的行为。无论我们是在为喷气发动机设计更坚固的合金，还是在设计更高效的[催化剂](@article_id:298981)，我们都需要能够从原子的微观世界跨越到工程性质的宏观世界的模型。

考虑从材料的三维微观结构图像中预测其刚度——杨氏模量——的任务。这是一个标量性质；如果我们旋转样品，材料的刚度不会改变。我们如何构建一个尊重这一点的模型？可以尝试通过在训练期间向标准的[卷积神经网络](@article_id:357845)（CNN）展示同一微观结构在数千个不同随机方向下的例子来*教*它这种[不变性](@article_id:300612)。但这种方法是近似的且效率低下。一个远为优雅和稳健的解决方案是使用一个通过设计*保证*不变的架构。一个 $SE(3)$ 等变的 CNN 通过在保持几何信息的层中处理三维微观结构，然后使用一个最终的、特殊设计的[池化层](@article_id:640372)来产生一个单一的标量输出，该输出可被证明对输入的朝向是不变的，从而实现这一点 [@problem_id:2656011]。其间的差异是深刻的：这是在多种不同情境下记忆一个事实与真正理解其基本原理之间的差异。

我们可以更进一步。与其预测单一的整体性质，如果我们想模拟材料的完整力学响应呢？当材料变形时，它会产生内部应力，这由[柯西应力张量](@article_id:326933)描述。这个[张量场](@article_id:323850)是等变的；当一块材料旋转时，其内部的应[力场](@article_id:307740)必须相应地旋转。在一项跨学科统一的杰出展示中，研究人员构建了 $SE(3)$ [等变网络](@article_id:304312)，该网络直接学习从一个小区间的原子构型到该点的连续介质应力张量的映射。这些模型通过其架构本身自动满足了客观性（框架无关性）这一基本物理定律，为[原子模拟](@article_id:378714)的离散世界和固体力学的连续世界之间提供了一座无缝且物理上合理的桥梁 [@problem_id:2898860]。

### 运动中的[等变性](@article_id:640964)：[机器人学](@article_id:311041)与控制

机器人所处的物理世界，当然也是[欧几里得几何](@article_id:639229)的同一个三维世界。机器人对其环境及其自身行为的理解不应依赖于其视角。因此，$SE(3)$ [等变性](@article_id:640964)原则在[机器人学](@article_id:311041)和控制理论中与在分子科学中同样至关重要。

想象一个机器人试图确定它对一个物体的抓取是否稳定。抓取的稳定性取决于接触点的几何形状——它们的位置以及它们施加的力（法线）的方向。这个性质是物体和抓取所固有的；它与机器人是在房间的北角还是南角无关。如果我们训练一个通用的神经网络来预测抓取稳定性，它可能在与其训练数据相似的例子上表现良好。但如果我们旋转物体，原始的输入坐标会改变，这个幼稚的网络很可能会给出一个完全不同且错误的答案。它未能泛化。相比之下，一个以 $SE(3)$ [不变性](@article_id:300612)为核心原则构建的模型，无论物体的朝向如何，都会给出完全相同的稳定性得分，因为它理解底层的物理学没有改变 [@problem_id:3106154]。

这一原则带来的不仅仅是鲁棒性；它还带来了惊人的计算效率。机器人学和[计算生物学](@article_id:307404)中的许多问题，比如寻找抓取物体的最佳方式或两种蛋白质如何对接，都涉及到在巨大的三维方向空间中进行搜索。蛮力方法将需要为成千上万个不同的旋转运行复杂的模拟或评估，这是一项计算上令人望而却步的任务。$SE(3)$ [等变网络](@article_id:304312)提供了一条革命性的捷径。因为它们的内部特征在旋转下以一种完全可预测的方式变换，我们只需要处理输入对象*一次*。然后，要看任何其他方向的特征会是什么样子，我们不需要重新运行网络；我们可以简单地对现有特征应用一个已知的数学变换——一个称为“操纵”的操作。这将一个对输入空间的巨大搜索替换为在特征空间中的一个高效的、解析的操作，使得以前难以解决的问题变得可解 [@problem_id:3133493]。这个想法也应用于医学影像，其中[等变网络](@article_id:304312)可以分析三维扫描（如 MRI 或 CT），其方式对患者的位置和方向具有鲁棒性。

最后，$SE(3)$ 对称性的概念对于控制[多智能体系统](@article_id:349509)至关重要，如无人机群或卫星星座。通常，目标不是命令每个智能体到一个特定的、绝对的位置，而是维持一个集体的*队形*或*形状*。目标本身——[期望](@article_id:311378)的智能体间距离集合——对整个群体的[刚体运动](@article_id:329499)是不变的。这意味着没有一个单一的正确构型，而是一个由全局旋转和平移相关联的、连续的正确构型族。理解这种内在的对称性是设计稳定控制律的关键。它精确地告诉我们哪些自由度是“自由的”（整体位置和方向），哪些必须被严格控制（定义形状的相对位置）。群论和不变性的语言为分析这些复杂的、对称的系统的稳定性提供了精确的数学框架 [@problem_id:2726139]。

### 一种通用语言

从分子的量子[势能面](@article_id:307856)到钢梁中的应[力场](@article_id:307740)，从赋予生命的蛋白质的折叠到机器人的稳定抓取，我们都看到了同样的原理在起作用。$SE(3)$ [等变性](@article_id:640964)不是一种聪明的技巧或针对三维数据的利基技术。它是一种物理真理的体现，这种真理如此深刻，以至于我们常常视之为理所当然：自然法则对所有观察者都是相同的。

通过教给我们的[计算模型](@article_id:313052)这种物理学的通用语言，我们所做的比仅仅提高它们在测试集上的准确性更为深刻。我们正在构建能够以结构化、有原则且深度物理的方式“理解”世界的模型。我们正在从黑箱模式识别转向一个“灰箱”建模的新时代，在这个时代，模型本身的架构反映了宇宙的基本对称性。这是创造能够不仅预测，而且能够与自然法则和谐地推理、发现和创造的人工智能的道路。