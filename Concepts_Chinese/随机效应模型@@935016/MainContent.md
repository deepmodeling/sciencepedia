## 引言
在现实世界中，数据很少是扁平的；它自然地组织成组或集群。学生嵌套在教室中，患者嵌套在医院中，对个体的重复测量嵌套在个体内部。忽略这种固有的结构不仅仅是统计上的疏忽，更是错失了更深入理解世界的机会。那些假设每个数据点都独立的传统方法可能会导致误导性的结论和虚假的精确感。这就造成了一个知识鸿沟，我们数据的结构本身蕴含着宝贵信息，而我们却未能捕捉到。

随机效应模型提供了一个强大的框架，专门用于应对这一挑战。它们让我们能够看到、建模并解释现实世界丰富的分层特性。本文旨在介绍这些重要的统计工具。首先，我们将探讨核心的“原理与机制”，深入研究这些模型如何分解变异、固定效应与随机效应之间的关键区别，以及由此产生的不同解释。随后，在“应用与跨学科联系”部分，我们将见证这些模型的实际应用，发现它们在分析从临床试验数据、基因表达到生态系统，再到社会不平等的复杂动态等各种问题时的多功能性。

## 原理与机制

想象你是一位科学家，接手一个看似简单的问题：一种新肥料对[植物生长](@entry_id:148428)有何影响？你在几个温室里进行了一项实验。你测量了数千株植物，一些使用了肥料，一些没有。当然，你可以把所有的测量值都扔进一个大桶里，计算施肥和未施肥植物的平均生长量，然后收工。但总觉得哪里不对劲。你知道每个温室都是它自己的小世界——一个可能稍微暖和些，另一个可能早晨阳光更多，第三个的土壤成分可能不同。同一温室内的植物更像是兄弟姐妹，共享一个共同的环境，而不是像在另一个温室里的远房表亲。

这个简单的观察是通向统计学中一个强大而优雅思想的入口：世界不是平的。数据常常以团块或集群的形式出现——教室里的学生、医院里的病人、对同一个人的多次测量。忽略这种结构不仅是草率的，更是错失良机。这就像试图只通过观察城市的人口密度来了解一个城市，而忽略了其各个社区充满活力、独一无二的特色。[随机效应模型](@entry_id:143279)正是让我们能够看到、理解和建模世界这种丰富分层结构的工具。

### 变异的剖析：分解世界

从本质上讲，[随机效应模型](@entry_id:143279)是关于变异本质的一种陈述。让我们回到温室的例子。一株特定植物的最终高度，我们称之为 $Y_{ij}$（代表温室 $i$ 中的植物 $j$），不仅仅是一个单一的随机数。我们可以把它看作是几个部分的和。首先是所有植物的总平均高度 $\mu$。然后是其所在温室独有的部分 $b_i$，如果这是一个特别好的温室，它可能是一个正数，如果是一个差的温室，则可能是一个负数。最后，还有植物自身的个体差异 $\epsilon_{ij}$，即它相对于其温室平均值的个人偏差。

于是，我们可以写出一个简单而优美的方程式：
$$
Y_{ij} = \mu + b_i + \epsilon_{ij}
$$

这就是**[方差分量](@entry_id:267561)模型** [@problem_id:4788688] 的精髓。我们不只是说“事物会变化”。我们说的是变异本身具有结构。我们看到的总随机性是两种不同随机性的总和：温室*之间*的变异，以及温室*内部*的变异。随机效应模型不仅估计均值，它还估计这些分量的*方差*。我们可以估计[温室效应](@entry_id:159904)的方差 $\sigma_b^2$ 和个体植物效应的方差 $\sigma_\epsilon^2$。然后我们可以提出这样的问题：植物高度的总变异中，有多少是由温室间的差异造成的，又有多少仅仅是植物间的随机差异？我们解剖了随机性本身。

这个思想是可以扩展的。如果我们的温室位于不同的气候带，我们可以增加另一层随机效应：
$$
Y_{ijk} = \mu + z_k + b_{ik} + \epsilon_{ijk}
$$
其中 $z_k$ 是气候带 $k$ 的随机效应。我们可以构建一个反映世界嵌套现实的模型——区域内医院中患者的就诊次数 [@problem_id:4993186] [@problem_id:4788688]。

### 看待分组的两种理念

当我们遇到这些分组——温室、教室或医院——时，我们面临着一个哲学上的选择，这个选择会带来深远的实践后果。我们应该如何思考身处特定分组的“效应”？

一种方法是将每个分组视为一个独特的、单一的实体。我们可以说：“我只对*这五个特定的温室*及其独有属性感兴趣。”然后，我们将为每个温室的效应估计一个单独的参数。这就是**固定效应**方法 [@problem_id:4974588]。它之所以强大，是因为它控制了每个温室所有奇怪的、未测量的、恒定的特征。如果3号温室的屋顶漏水，3号温室的固定效应就会吸收掉这个影响。主要缺点是我们的结论“固定”于我们研究中的分组。我们对我们的五个温室了解很多，但对温室*整体*却说不出太多。此外，我们无法估计在组内保持不变的任何变量的效应，比如整个温室使用的土壤类型 [@problem_id:4585308]。

另一种理念是将在我们研究中的五个温室看作是来自一个庞大的可能温室总体的随机样本。我们对3号温室本身不感兴趣，而是将其作为世界上存在的变异类型的一个例子。这就是**随机效应**方法。在这里，我们不估计3号温室的具[体效应](@entry_id:261475)。相反，我们假设所有[温室效应](@entry_id:159904)，即我们方程中的 $b_i$ 项，都来自一个分布，通常是均值为 $0$、方差为 $\sigma_b^2$ 的正态分布。我们的目标不是估计每个 $b_i$，而是估计方差 $\sigma_b^2$——即组间变异的大小 [@problem_id:4531991]。

### 群体的智慧：借鉴信息

选择随机效应的理念给我们带来了一个显著的好处，一种被称为**收缩**或**[部分池化](@entry_id:165928)**的统计技巧。想象一下，你的一个温室，5号温室，里面只有两株植物。基于仅仅两株植物对该温室平均高度的估计会非常不可靠。随机效应模型体现了一种统计智慧。它会说：“我并不完全相信来自5号温室的数据。它太稀疏了。我要将其估计的效应‘收缩’回所有温室的总平均值。”

收縮的量不是任意的。这是一个 beautifully balanced 的折衷。如果某个温室的数据稀疏且不可靠，其效应就会被大幅度地收缩到总体均值。如果一个温室有数千株植物，它的估计值就会被信任，收缩程度就很小。收缩的程度还取决于温室之间总体的变异程度（即 $\sigma_b^2$ 的大小）。如果所有温室都非常相似，模型会更积极地收缩个体估计值。这种跨组“借鉴信息”的方式可以得到更稳定且通常更准确的估计，尤其是在某些组规模很小的情况下。正是这一特性使得随机效应模型在对我们原始研究之外的*新的*、未见过的组进行预测时如此强大 [@problem_id:4531991]。

### 两种解释的故事

固定效应和随机效应之间的区别引出了现代统计学中最微妙也最重要的概念之一：**条件性（特定于主题）**解释和**边际性（总体平均）**解释之间的差异。

随机效应模型本质上是一个条件模型。当我们看一个[回归系数](@entry_id:634860)时，比如我们肥料的效应，它告诉我们*对于一个给定的温室*，植物高度的预期变化。这是一个特定于主题的解释。我们保持温室的随机效应恒定。

相比之下，边际模型是在所有组上取平均。它问的是：“在植物和温室的整个总体中，肥料的平均效应是什么？”

现在，对于像我们一直在讨论的这种简单的线性混合模型——其中结果是连续的，关系是直线的——会发生一件奇妙的事情。特定于主题的效应和总体平均的效应在数值上是完全相同的！我们的肥料系数，无论我们将其解释为在一个典型温室内的效应，还是跨所有温室的平均效应，其值都是相同的 [@problem_id:4916038]。这是系统优雅线性的结果。

然而，一旦我们踏入非线性世界，这种美妙的简单性就消失了。假设我们的结果不是高度，而是一个二元的“是/否”：植物是否得了某种疾病？[@problem_id:4993186]。为了对此建模，我们使用**广义[线性混合模型](@entry_id:139702) (GLMM)**，通常带有 logistic（或 logit）[连接函数](@entry_id:636388)。在这个世界里，条件效应和[边际效应](@entry_id:634982)不再相同。许多个别S形 logistic 曲线的平均值本身并不是一条漂亮的S形 logistic 曲线——它是一条更平坦、更分散的曲线。这意味着估计出的总体平均效应在数值上会比特定于主题的效应要小（被衰减）。

这不是矛盾，而是更深层次真相的反映。它迫使我们提出一个更尖锐的科学问题：我们是关心一种药物对特定患者的效应（一个条件性问题），还是关心该药物对一个群体的公共健康的平均效应（一个边际性问题）？模型的选择——是随机效应GLMM还是像广义估计方程（GEE）这样的边际模型——取决于你所问的问题 [@problem_id:4949810] [@problem_id:4974588]。

### 随机性的丰富内涵

随机截距的基本思想仅仅是个开始。这个框架极其灵活。如果我们的肥料在阳光充足的温室里比在阴凉的温室里效果更好呢？这意味着肥料的*效应*——关系的斜率——因组而异。我们可以通过在模型中添加一个**随机斜率**来对此建模，允许每个温室对肥料有自己的响应 [@problem_id:4333071]。

我们甚至可以问随机效应是否真的需要。是否有任何证据表明分组之间确实存在差异？这涉及到检验[方差分量](@entry_id:267561)为零的假设，例如 $H_0: \sigma_b^2 = 0$。这 ternyata 是一个引人入胜的统计问题。因为方差不能为负，我们是在其可[能值](@entry_id:187992)的最边缘或*边界*上测试一个参数。这需要特殊的统计工具，比如与分布混合进行比较的似然比检验，或者像[参数化](@entry_id:265163)[自助法](@entry_id:139281)这样的计算方法，才能得到正确的答案 [@problem_id:4989111]。

从对温室植物的一个简单观察出发，我们进入了一个充满结构化变异、哲学选择和深刻统计原理的丰富世界。[随机效应模型](@entry_id:143279)不只是“控制”聚类效应；它们拥抱它、建模它，并用它来描绘一幅更完整、更细致的现实图景。它们向我们展示，通过关注世界的结构，我们可以使我们的推断更强有力，我们的预测更准确，我们的科学理解更深入。

