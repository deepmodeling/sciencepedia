## 应用与跨学科联系

在深入探讨了缺失数据的原理和机制之后，你可能会留下这样的印象：这是一个相当技术性，甚至可能有些枯燥的话题——无非是整理凌乱的电子表格。但事实远非如此！我们观察到的世界充满了空白。从遥远恒星未发出的信号，到历史手稿中遗失的一页；从错过门诊预约的病人，到在风暴中失灵的传感器，不完整并非例外，而是常态。

我们选择如何面对这些空白，是一个深刻的科学和哲学问题。我们是丢弃不完整的证据吗？我们是否试图填补这些空白，如果是，又该如何填补？我们设计的答案不仅仅是统计技巧。它们是强大的透镜，揭示了我们世界隐藏的结构，使我们能够从零碎的线索中重建一幅更完整的图景。我们对这些思想应用的探索之旅，将从地球表面延伸到我们细胞的核心，展示出处理缺失数据的原则是贯穿科学结构的一条统一的线。

### 最简单的路径：绕过空白

面对数据中的空白，最直接的反应自然是忽略它。如果我们正在比较土地温度的卫星测量值和地面观测值，而其中一个地面传感器有一天失灵了，我们可能干脆将那一天的成对数据从分析中排除。这种方法，通常称为**完整案例分析 (complete-case analysis)**，仅使用我们拥有一整套观测值的数据点。当我们计算像[均方根误差](@entry_id:170440)这样的指标来验证气候模型时，我们只对那些完整的数据对的误差平方求和，实际上是假装那些缺失的数据对从未存在过 ([@problem_id:3829069])。

这种方法具有简单性的优点，并且在适当的条件下（当数据是“[完全随机缺失](@entry_id:170286)”时），它不会引入偏差。然而，它的浪费是其致命弱点。在一个包含许多变量的复杂数据集中，任何一个变量中的单个缺失值都可能导致整个观测——可能是一个病人的完整记录——被丢弃。我们冒着因少数分散的空洞而丢弃大量宝贵信息的风险。

我们能否在不“捏造”数据的情况下做得更好？在一些优美的情况下，算法本身可以学会对缺失具有鲁棒性。考虑构建一个决策树来预测医疗结果，比如医院再入院。该算法根据患者数据进行一系列分割——例如，“实验室指标 $X_2$ 是否小于 $7$？”但如果对于一个新病人，$X_2$ 的值是缺失的，该怎么办？

[分类与回归](@entry_id:637626)树（CART）算法没有放弃，而是内置了一个非常巧妙的功能：**替代分割 (surrogate splits)**。在训练期间，当找到像 $X_2$ 这样的变量上的最佳分割后，算法会主动寻找在*其他*变量（比如一个共病评分 $X_3$）上的分割，这些分割能将相同的患者送到相同的子节点。它找到了一个模仿主要规则的“替身”或“替代”规则。如果在预测时主要变量缺失，算法就简单地使用它手头最好的替代方案。这不是[插补](@entry_id:270805)；这是一种内置的应急计划，一种算法上的适应，它优雅地绕过了缺失值，既没有丢弃案例，也没有诉诸于粗略的猜测 ([@problem_id:4910391])。

### 插补的艺术：用结构填补空白

虽然绕过空白有时是可行的，但填补它们的愿望——即插补——是强烈的。但这是一种危险的游戏。简单地用列平均值填充每个空格，会冲淡数据的特性，人为地减少方差并扭曲变量之间的关系。有原则的[插补](@entry_id:270805)不是关于填充一个单元格；它是向整个数据集提问：“鉴于我所知道的关于你的一切，这个洞里最有可能是什么？”答案在于利用数据的内部结构。

#### 低秩结构的力量

许多现实世界的数据集，从临床测量到基因表达谱，并非只是随机的数字集合。它们拥有深刻的内在结构。尽管可能有成千上万个特征，但它们的变化通常是由数量少得多的潜在因素驱动的。例如，成千上万个基因的表达水平可能仅由少数几个活跃的生物通路所调控。这意味着数据矩阵是“低秩”的——它有一个更简单、更紧凑的描述。

这个低秩属性是我们进行插补的黄金门票。它意味着数据矩阵的列和行不是独立的；它们以一种结构化的方式相互关联。于是，缺失数据变成了一个巨大的谜题。我们能否解出一个低秩矩阵，它能[完美匹配](@entry_id:273916)我们*确实*拥有的所有数据点？

这就是**低秩[矩阵补全](@entry_id:172040) (low-rank matrix completion)** 背后的思想。一个实现这一点的优美算法，在两种相互竞争的愿望之间进行迭代的舞蹈。我们从我们的矩阵开始，空洞处用[零填充](@entry_id:637925)。在舞蹈的第一步，我们将我们当前的猜测投影到所有低秩矩阵的“空间”上。Eckart-Young-Mirsky 定理告诉我们如何完美地做到这一点：我们计算奇异值分解（SVD），并只保留前几个[奇异值](@entry_id:171660)，从而有效地滤除“噪声”，只保留主导结构。现在我们的矩阵是优美的低秩了，但它不再匹配观察到的数据。因此，在第二步中，我们修正它：我们将原始的、观察到的值重新插入到它们原来的位置，并保持它们固定。这个新矩阵不再是完美的低秩，但它尊重了证据。我们一遍又一遍地重复这两步——**投影到低秩**，然后**投影回观测**。奇迹般地，这个过程常常会收敛到一个既是低秩又与我们所见数据一致的补全矩阵 ([@problem_id:3275143])。

这个概念是处理带缺失数据的主成分分析（PCA）的现代方法的核心。毕竟，PCA 不过是寻找数据集的最佳低秩近似。当数据缺失时，我们无法直接计算协方差矩阵。相反，我们可以使用像**概率 PCA (PPCA)** 这样的框架，它将 PCA 塑造为一个[生成模型](@entry_id:177561)。一个更通用且功能更强大的工具是**[期望最大化 (EM) 算法](@entry_id:749167)**。EM-PCA 将我们的迭代舞蹈形式化：
1.  **E-步 (Expectation)**：给定我们当前对底层结构（主成分）的模型，我们对缺失值和每个数据点的潜在得分做出最佳猜测。
2.  **M-步 (Maximization)**：使用这个新“补全”的数据，我们更新我们的模型，找到最能解释这些数据的新主成分。

我们在期望和最大化之间交替进行，同时优化我们的插补和对[数据结构](@entry_id:262134)的理解，直到达到一个稳定的解决方案 ([@problem_id:2416111], [@problem_id:4537452])。

#### 用深度学习学习数据的语言

如果底层结构不是线性的呢？如果变量之间的关系更复杂、更曲折呢？这时，我们可以求助于深度学习的力量。想象一下，尝试教一个神经网络你数据的“语言”——支配其模式的复杂语法和词汇。这就是使用**去噪自编码器 (Denoising Autoencoder, DAE)** 进行[插补](@entry_id:270805)的思想。

我们训练自编码器不是在不完整的数据本身上，而是在一个“去噪”任务上。我们取我们*已知*的条目，故意损坏其中一些（例如，将它们设置为零），然后挑战网络重建原始的、未损坏的版本。通过学习修复这种人为的损坏，网络含蓄地学习了定义[数据结构](@entry_id:262134)的深层、非线性规则。

一旦网络精通这个游戏，我们就可以将我们真正不完整的数据集呈现给它。它将缺失值视为另一种它被训练来修复的“损坏”形式。这种方法的美妙之处在于，特别是在[单细胞基因组学](@entry_id:274871)等领域，我们可以根据数据的具体性质定制网络的目标函数——例如，对过度分散的计数数据使用零膨胀负二项[损失函数](@entry_id:136784)，确保插补不仅合理，而且在统计上忠实于数据生成过程 ([@problem_id:2373378])。

### 拓展视野：超越简单矩阵

世界并非总是一个静态、独立的观测集合。数据点可以通过时间相连，或者它们可以代表同一底层系统的不同方面。我们处理缺失的原则必须适应这些更丰富的环境。

#### 时间的节奏

考虑跟踪一种疾病在多个月内的发病率，以评估一项新卫生政策的影响。这是一种**间断时间序列 (Interrupted Time Series, ITS)** 分析。如果几个月的数据缺失，我们不能简单地使用上述方法。为什么？因为三月份的数值并非独立于二月份的数值。数据有记忆，有节奏——趋势、季节性、和[自相关](@entry_id:138991)性。一个简单的[插补](@entry_id:270805)会打破这个时间链，导致无意义的结果。

一个有原则的[插补](@entry_id:270805)必须学习序列的节奏。我们可以使用像**SARIMA（季节性自回归积分[移动平均模型](@entry_id:136461)）**这样的模型，它们专门设计用来捕捉季节性和时间依赖的相关性。我们建立一个[插补模型](@entry_id:169403)，它理解序列的过去和它的季节性心跳，并且我们还告知它关于政策干预的信息。这个模型然后可以为缺失的月份生成 plausible 的值，这些值尊重序列的动态特性。一个更优雅的方法是使用**[状态空间模型](@entry_id:137993)**和**[卡尔曼平滑器](@entry_id:143392) (Kalman smoother)**，它将观察到的时间序列构想为一个隐藏的、演化的“状态”（由其水平、趋势和季节性成分组成）的嘈杂表现。这些算法可以透过噪声和空白，估计出[隐藏状态](@entry_id:634361)最可能的路径，为填补缺失的观测提供一种自然而强大的方法 ([@problem_id:4805123])。

#### 从多条线索中编织一个连贯的故事

在现代生物学中，我们常常对同一组样本测量许多不同的东西：基因活动（[转录组学](@entry_id:139549)）、DNA修饰（甲基化组学）和蛋白质水平（蛋白质组学）。这些数据集或“模态”中的每一个都可能有其自身的缺失值模式。我们可以单独[插补](@entry_id:270805)每一个，但这会错过一个绝佳的机会。生物学的中心法则告诉我们，这些模态不是独立的；它们是同一个生物学故事的不同章节。

这就是**集体分解 (collective factorization)** 的思想发挥作用的地方。我们可以同时对我们所有的数据集——无论是矩阵还是更高阶的张量——进行建模，前提是假设它们共享一个共同的潜在结构。具体来说，我们可以假设它们都共享相同的“样本因子”，这是一个代表每个个体生物学状态的低维签名。

通过将一个单一的、耦合的[模型拟合](@entry_id:265652)到所有模态的所有观测数据上，我们允许信息在它们之间流动。一个病人完整的蛋白质组学数据中的强信号可以帮助我们确定他们的潜在签名，这反过来又使我们能够在他们稀疏的转录组学数据中做出更准确的[插补](@entry_id:270805)。这就像使用一块罗塞塔石碑：通过识别共同的铭文（共享的样本因子），我们可以使用一种语言中的清晰文本来破译另一种语言中的缺失文本 ([@problem_id:4360177], [@problem_id:2379280])。这是一个美丽的例子，说明了如何利用共享结构不仅能填补空白，还能导向对整个系统更统一、更鲁棒的理解。

### 最后的思考：“缺失”意味着什么？

我们以一个来自进化领域的发人深省的例子结束。当我们比对来自不同物种的DNA序列时，我们常常会发现空白，用“-”表示。这个空白表示在一个谱系相对于另一个谱系的历史中发生了**插入或删除 (indel)** 事件。这个空白是“缺失数据”吗？

如果我们将它视为真正的缺失，我们推断进化树的算法将简单地忽略它，对各种可能性进行边缘化处理。推断将仅由核苷酸替换驱动 ([@problem_id:2837150])。我们就失去了来自 indel 事件本身的信息。

如果我们将这个空白视为与 A、C、G 和 T 并列的“第五种字符状态”呢？现在 indel 事件对分析做出了贡献。但我们制造了一个新问题。一个标准的[替换模型](@entry_id:177799)假设任何字符都可以变成任何其他字符。这个模型对于 indel 来说是一个糟糕的拟合，因为它们是截然不同的进化过程。在这个错误指定的模型下，两个物种中两个长的、共享的删除可能被视为它们亲缘关系密切的压倒性证据，即使这只是模型无法理解一个空白真正代表什么的人为产物 ([@problem_id:2837150])。

这个最后的例子揭示了最深刻的教训。缺失数据的问题不仅仅是技术性的；它是概念性的。在我们选择一种方法之前，我们必须首先问：这个空白的本质是什么？是什么过程创造了它？只有通过理解缺失背后的“为什么”，我们才能选择一个有原则的“如何”来解决它。从一个简单的测量遗漏到一个深刻的进化事件，对缺失数据的研究迫使我们更深入地思考世界、我们对世界的模型，以及证据本身的本质。