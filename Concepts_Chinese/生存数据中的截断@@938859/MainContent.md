## 引言
在对从患者诊断后生存期到机器使用寿命等时间-事件现象的研究中，我们力求获得一幅完整的图景。然而，我们收集到的数据往往是支离破碎的，故事的开端常常缺失。这个问题被称为左截断，它发生于我们的观察开始得较晚，导致我们系统性地错过了所有在观察开始前就已发生事件的个体或项目。其结果是一种偏向“幸存者”的扭曲视角，这是一个普遍存在的问题，可能在从医学到经济学等领域导致危险的错误结论。

本文旨在直面左截断的挑战，提供一个清晰的框架来理解和校正这种微妙但至关重要的数据不完整形式。您将学习到区分截断与更为人熟知的删失概念的基本原则，并探索用于调整分析以校正此种偏倚的机制。第一章“原理与机制”将深入解析风险集、不朽时间偏倚以及恢复数据完整性的数学校正方法的核心思想。随后，“应用与跨学科联系”一章将展示这些原则不仅是理论性的，而且是确保众多学科学术研究准确性和诚信度的重要实用工具。

## 原理与机制

想象一下，你是一位历史学家，任务是研究一座被遗忘的古城中建筑物的寿命。你到达遗址，开始进行调查。你可以轻松地确定现存建筑的建造年代以及它们最终倒塌的时间。但问题在于，你的调查只包括了你到达那天仍然屹立的建筑。任何在你到达*之前*建造并倒塌的建筑都完全不在你的记录中。如果你天真地仅根据你所看到的建筑来计算平均寿命，你将不可避免地得出结论：这些建筑异常耐用。这是因为那些寿命短、不坚固的建筑早已消失。你正遭受**幸存者偏倚**的影响。

这就是生存数据中**左截断**的核心挑战。这是一个微妙但深刻的问题，源于我们对一个过程的观察并非从最开始就启动。在流行病学中，当我们组建一个**现患队列**（a prevalent cohort）——即一群已经被诊断出患有某种疾病的患者——而不是**发病（或初始）队列**（an incident (or inception) cohort）——即我们在患者确诊那一刻就将其纳入研究——时，就会发生这种情况 [@problem_id:4578311]。现患队列中缺失了所有那些病程迅速、在我们能够将其纳入研究之前就已经死亡的个体。如果我们不小心，我们的数据将讲述的不是典型患者的故事，而是那些异常坚韧的患者的故事。

### 失踪者案例：截断与删失的对比

为了驾驭这一领域，我们必须首先精确我们的语言。在生存分析中，数据不完整的问题主要有两种：删失和截断。它们并不相同，混淆它们可能导致灾难性的错误结论。

**删失**（Censoring）关乎*已纳入*我们研究的对象的讯息不完整。最常见的形式是**[右删失](@entry_id:164686)**（right-censoring），它发生在研究结束或患者失访时，而我们关心的事件（如死亡或疾病复发）尚未发生。我们知道患者存活到了某个时间点，但不知道他们的最终结局。他们的故事未完待续，但我们有开头和中间部分。一种较罕见的形式是**[左删失](@entry_id:169731)**（left-censoring），即我们知道事件发生在某个时间点*之前*，但不知道确切是何时。例如，在一项HIV研究中，一名参与者可能在第一次检测时就已是血清阳性。我们只知道[血清转化](@entry_id:195698)发生在其感染和第一次检测之间的某个时间，这给了我们一个不确定的区间 [@problem_id:4612166]。在这两种删失情况下，研究对象都在我们的数据集中。

另一方面，**左截断**（Left truncation）关乎那些被系统性地*完全排除*在我们研究之外的对象。一个对象只有当其生存时间 $T$ 大于其进入或“截断”时间 $L$ 时，才会被纳入数据集。如果 $T \le L$，该对象对我们来说是不可见的——一个统计学上的幽灵。只招募诊断后数月或数年仍存活的患者的癌症登记系统是左截断的完美例子 [@problem_id:4612166]。关键区别在于：删失是一个*知晓*的问题，而截断是一个*看见*的问题。

数学形式优美地捕捉了这一区别 [@problem_id:4576803]。一个[左删失](@entry_id:169731)的观测，我们只知道 $T \le L$，它对我们分析的贡献是该事件的概率，即 $P(T \le L) = F(L)$。但对于一个左截断的对象，我们所做的任何观测都是以他们被选入研究为条件的，即以 $T > L$ 为条件。整个概率空间都被这个条件的概率 $P(T > L) = S(L)$ 重新调整。这个分母是理解后续一切的关键。

### 重构乐章：风险集的概念

那么，我们如何校正我们的管弦乐队里充满了迟到的音乐家这一事实呢？我们无法采访那些已经离开的演奏者，但我们可以极其谨慎地计算在场者的时机。这就是**风险集**（risk set）背后的思想。

在生存分析中，任何给定时间 $t$ 的风险集，记作 $R(t)$，是当前所有有资格经历该事件的个体的集合。对于一个从时间零点开始且无截断的简单研究，只要一个人被纳入研究且尚未发生事件或被删失，他就在风险集中。

对于延迟进入的情况，我们必须更加精细。一个个体在进入我们的研究之前，不可能处于“风险”之中。这意味着我们需要为每个个体 $i$ 准备一个三元组数据：$(L_i, X_i, \delta_i)$ [@problem_id:4576982]。

- $L_i$ 是进入时间（左截断时间）。
- $X_i$ 是[退出时间](@entry_id:193122)（事件发生或被删失的时间）。
- $\delta_i$ 是事件指示符（事件为1，删失为0）。

有了这些信息，我们可以用一个简单而强大的规则来定义个体 $i$ 在时间 $t$ 的风险状态。当且仅当该个体处于积极观察下时，他才在风险集 $R(t)$ 中：也就是说，如果他的进入时间已过，而[退出时间](@entry_id:193122)尚未到来。形式上，个体 $i$ 在 $R(t)$ 中，当且仅当 $L_i \le t \le X_i$ [@problem_id:4608383]。

考虑一个简单的例子 [@problem_id:4608383]：
- 个体1在 $L_1 = 2$ 时进入，并在 $X_1 = 5$ 时发生事件。
- 个体2在 $L_2 = 0$ 时进入，并在 $X_2 = 3$ 时被删失。
- 个体3在 $L_3 = 4$ 时进入，并在 $X_3 = 7$ 时发生事件。

在时间 $t=3$ 时，谁处于风险中？
- 个体1？是的，因为 $2 \le 3 \le 5$。
- 个体2？是的，因为 $0 \le 3 \le 3$。
- 个体3？不是，因为他还没进入研究（$L_3 = 4 > 3$）。
所以，风险集 $R(3)$ 只包含个体 {1, 2}。通过正确地排除个体3，我们避免了错误地假设他处于风险中，从而稀释了我们对该时间点事件率的估计。这种严谨的、随时间变化的记录方式是正确应用[Kaplan-Meier](@entry_id:169317)估计或Cox比例风险模型等方法处理[截断数据](@entry_id:163004)的基础 [@problem_id:4612165] [@problem_id:4956026]。

### 不朽时间的危害

如果我们偷懒，忽略了进入时间会怎样？如果我们决定将在第100天开始治疗的患者，从第0天起就当作“治疗组”成员来分析，会怎样？这将导致[观察性研究](@entry_id:174507)中最[隐蔽](@entry_id:196364)的错误之一：**不朽时间偏倚**（immortal time bias）[@problem_id:5228327]。

在患者诊断（时间0）和他们开始接受治疗（比如，时间 $A_i$）之间的时期，对于该治疗组而言是“不朽的”。要被纳入开始接受治疗的患者组，患者*必须*存活过那段时间。根据定义，在此期间死亡是不可能的。

如果我们错误地将这段无事件的不朽时间归类为属于“治疗组”，我们就是在用他们不可能失败的时间来填充他们的生存记录。这会人为地降低计算出的治疗组[风险率](@entry_id:266388)，使得该疗法显得具有虚假的保护作用。这不是一个小的统计调整；这是一个根本性的逻辑缺陷，它创造了一种可能根本不存在的益处幻觉。

要斩除这个幽灵，方法是将暴露视为一个**时依协变量**（time-dependent covariate）。一个患者在开始治疗前，其人-时（person-time）贡献给“未治疗组”的风险集；开始治疗后，则贡献给“治疗组”的风险集。我们那个尊重不同状态进入和退出的严格风险集定义，正是正确处理此问题、驱散不朽时间幽灵所需的精确工具。

### 校正的演算

调整风险集的直观想法在似然理论中有着深刻而优美的数学基础。似然（likelihood）是连接我们的数据与模型参数的表达式；最大化似然可以得到这些参数的最佳估计。

对于一个未被截断的观测，其似然贡献本质上是我们所见情况的概率：如果事件发生，则是事件密度 $f(t)$；如果被删失，则是生存概率 $S(t)$。一种方便的写法是 $h(t)^{\delta} S(t)$，其中 $h(t)$ 是风险函数。

但对于左截断，我们必须考虑抽样的扭曲。正如我们注意到的，每一个观测都是以存活过进入时间 $L_i$ 为条件的。从第一性原理推导出的正确似然贡献，是朴素似然除以这个条件的概率 [@problem_id:4969182] [@problem_id:4968618]：

$$
\mathcal{L}_i = \frac{h(X_i)^{\delta_i} S(X_i)}{S(L_i)}
$$

这个简单的除法意义深远。它是一种重新归一化。它通过对那些能够存活到其进入时间的概率很低（即 $S(L_i)$ 很小）的个体贡献进行加权，来校正选择偏倚。它完美地补偿了那些相似但运气不佳而缺失的个体。

这个公式的美妙之处在一个简单模型中最为明显。假设[风险率](@entry_id:266388) $\lambda$ 是恒定的（指数生存模型）。此时，$S(t) = \exp(-\lambda t)$。将此代入我们的似然公式得到：

$$
\mathcal{L}_i(\lambda) = \frac{(\lambda)^{\delta_i} \exp(-\lambda X_i)}{\exp(-\lambda L_i)} = \lambda^{\delta_i} \exp(-\lambda(X_i - L_i))
$$

看看这个简化是多么优雅！这个个体的似然仅取决于其事件状态 $\delta_i$ 和他们在研究中被实际观察到的总时间 $X_i - L_i$。当我们将所有对象的这些贡献相乘，并找到最大化该总似然的率 $\lambda$ 时，我们得到了一个极其简洁且直观的估计量 [@problem_id:4969182]：

$$
\hat{\lambda} = \frac{\text{事件总数}}{\text{观察到的总人-时}} = \frac{\sum \delta_i}{\sum (X_i - L_i)}
$$

这是大自然最精妙的核算。通过理解过程——谁被看到，谁没被看到——我们能够开发出一种校正我们视野的数学透镜。我们不必假装我们的数据是完美的。相反，我们可以拥抱它的不完美，理解其结构，并利用该结构来揭示其下的真相。这就是统计推理的力量与美。

