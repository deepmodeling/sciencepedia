## 引言
寻找具有特定高性能属性的新型材料是现代科学与工程的基石。然而，这一探索过程常常受到庞大到惊人的设计空间以及合成和测试每种新候选材料高昂成本的阻碍。传统的试错法和暴力[网格搜索](@entry_id:636526)过于缓慢和低效，无法有效地探索这一领域。这迫切需要一种更智能、更具策略性的实验方法。[贝叶斯优化](@entry_id:175791)作为一种强大的解决方案应运而生，它提供了一个数据驱动的框架，将智能搜索的过程形式化。

本文将对这一变革性方法进行全面介绍。首先，我们将深入探讨其核心**原理与机制**，探索它如何构建[概率模型](@entry_id:265150)来描绘未知领域，并就下一步在何处进行实验做出统计上合理的决策。然后，我们将综述其多样化的**应用与跨学科联系**，展示[贝叶斯优化](@entry_id:175791)目前如何为[自驱动](@entry_id:197229)实验室提供动力、解决复杂的设计问题，甚至改进我们对物理世界的基本理解。

## 原理与机制

想象一下，你是一位试图创造世界上最美味蛋糕的厨师。面粉、糖、鸡蛋以及上千种其他奇异配料的可能组合几乎是无限的。烘焙和品尝每一种组合将花费一生的时间。这就是发现过程中的经典困境：可能性空间浩瀚无垠，而每一次实验——无论是烤一个蛋糕，还是合成一种新合金——都成本高昂且耗时。如何在不尝试所有可能性的情况下找到完美的配方？你不会只是随机尝试各种组合。你会运用你的直觉。在尝过一个太干的蛋糕后，你可能会在下一个蛋糕里多加些黄油。如果一丝肉桂的味道很有希望，你可能会再多加一点。你会不断学习，用每一口的体验来更新你脑海中关于配方空间的“地图”。

[贝叶斯优化](@entry_id:175791)正是这种智能搜索的数学体现。它提供了一个形式化的框架，用于在广阔、未知的可能性领域中导航，使其成为[材料发现](@entry_id:159066)的革命性工具。但与人类厨师不同，它的运作不依赖于直觉，而是基于严谨而优雅的[概率论原理](@entry_id:195702)。

### 更智能的搜索：为何暴力搜索会失败

我们首先考虑寻找最优材料最直接的方法：**[网格搜索](@entry_id:636526)**。如果我们要优化一个单一参数，比如钢中的碳含量，我们可以将可能的范围划分为，比如说，1000个步骤，并逐一测试。这很简单，但效率极其低下。对于一种仅有五个可调参数的材料，每个维度上1000步的网格将意味着 $1000^5$——即一千万亿——次实验。这是一项不可能完成的任务。

即使使用强大的[并行计算](@entry_id:139241)，可以同时运行多个实验，这种暴力方法也很快变得难以处理。一种能从每个结果中学习的智能序贯搜索，通常只需一小部[分时](@entry_id:274419)间就能找到更好的解决方案。例如，一次仅包含21个精心选择的实验的[贝叶斯优化](@entry_id:175791)运行，其性能可能超过需要500多次实验的并行[网格搜索](@entry_id:636526)，除非该[网格搜索](@entry_id:636526)能够使用拥有数十个并行节点的大型计算机集群[@problem_id:2156632]。教训是明确的：当实验成本高昂时，思考是廉价的。一个能够利用每一条信息的更智能的策略，不仅仅是一种优势，更是一种必需。

### 构建未知世界的地图：高斯过程

那么，算法是如何“思考”的呢？它从构建一幅地图开始。想象一下，你想要最大化的属性——比如一种合金的抗拉强度——是一片隐藏的地形景观。你的目标是找到最高的山峰。但这片景观笼罩在浓雾之中，你只能在你插上旗帜（即进行了一次实验）的精确点上知道确切的海拔高度。你如何猜测雾中地形的形状？

这正是[贝叶斯优化](@entry_id:175791)的核心所在：一个被称为**[高斯过程](@entry_id:182192)（GP）**的优美统计工具。GP是一个[概率模型](@entry_id:265150)，它定义了可能函数上的一个[分布](@entry_id:182848)。它不局限于为隐藏景观确定一种单一的形状，而是考虑了无穷多种形状，每种形状都有一定的概率。由此，它为设计空间中的任何点 $\mathbf{x}$ 计算出两个关键信息：

1.  **[后验均值](@entry_id:173826) $\mu(\mathbf{x})$**：这是模型对点 $\mathbf{x}$ 处属性真实值的最佳猜测。它是你已进行的测量的加权平均值，其中邻近点的影响比远处点更大。你可以将其视为该位置最可能的海拔高度，从而有效地创建了一幅平滑、“[去噪](@entry_id:165626)”的[地形图](@entry_id:202940)。在整个搜索完成后，为我们提供最优材料真实值的最佳猜测的，是这个去噪后的均值，而不是单个带噪声的测量值 [@problem_id:2156691]。

2.  **后验[方差](@entry_id:200758) $\sigma^2(\mathbf{x})$**：这是[模型不确定性](@entry_id:265539)的度量——也就是雾的浓度。在你已进行测量的点，[方差](@entry_id:200758)非常低（你对那里的海拔高度是确定的）。而在远离任何测量点的地方，[方差](@entry_id:200758)很高，反映了模型对该区域地形的无知。

GP使用一个**[核函数](@entry_id:145324)** $k(\mathbf{x}, \mathbf{x'})$ 来定义点与点之间的相关性。一个常见的选择是[RBF核](@entry_id:166868)，它内含了一个简单直观的假设：在[参数空间](@entry_id:178581)中彼此靠近的点比相距遥远的点更可能具有相似的属性。对于带有噪声的实验数据，新点 $\mathbf{x}$ 的GP[后验均值](@entry_id:173826)和[方差](@entry_id:200758)由优美的矩阵方程给出，这些方程包含了所有先前的观测值、它们的位置以及测量噪声 [@problem_id:3471645]。其结果是一幅持续更新的概率地图，它不仅捕捉了我们已知的一切，同样重要的是，也捕捉了我们未知的一切。

### 下一次猜测的艺术：[采集函数](@entry_id:168889)

手握我们的概率地图——一幅由最佳猜测（$\mu$）构成的地形和由不确定性（$\sigma$）构成的浓雾——我们面临一个关键问题：下一次昂贵的测量应该在哪里进行？这个决策由**[采集函数](@entry_id:168889)**指导，它是我们搜索策略的数学表达。这个函数创建了一片*新*的景观，它描绘的不是预测的材料属性，而是评估每个点的“期望程度”。然后，算法只需找到这片采集景观的峰值，来选择其下一次实验 [@problem_id:1312275]。

该函数的设计取决于一个基本的权衡：**[探索与利用](@entry_id:174107)**。

-   **利用**：这是一种在你认为已经有宝藏的地方挖掘的策略。你专注于[后验均值](@entry_id:173826) $\mu(\mathbf{x})$ 已经很高的区域。这是一个安全的选择，很可能会带来小的、渐进式的改进。
-   **探索**：这是一种勇闯未知领域的冒险策略。你选择一个后验[方差](@entry_id:200758) $\sigma^2(\mathbf{x})$ 很高的点。这是一场赌博；那里的属性可能很差。但它也可能隐藏着一个壮观的、未被发现的高峰。

一次成功的搜索必须平衡这两者。其中两种最流行且优雅的策略是[置信上界](@entry_id:178122)和预期提升。

#### [置信上界](@entry_id:178122)（UCB）

UCB策略基于一个非常简单的思想：“面对不确定性时的乐观主义原则”。它建议我们应该这样行动：假设任何一点的函数值都达到了与我们模型合理一致的最高可能水平。[采集函数](@entry_id:168889)就是[后验均值](@entry_id:173826)加上一个加权的[标准差](@entry_id:153618)贡献[@problem_id:90133]：

$$
a_{\text{UCB}}(\mathbf{x}) = \mu(\mathbf{x}) + \kappa \sigma(\mathbf{x})
$$

这里，$\kappa$ 是一个可调参数，用于控制对风险的偏好。大的 $\kappa$ 会鼓励更多的探索（给予不确定性更大的奖励），而小的 $\kappa$ 则倾向于利用。最大化这个函数会自然地将搜索引向那些要么预测值高（高$\mu$），要么不确定性大（高$\sigma$）的点。

#### 预期提升（EI）

预期提升提出了一个更复杂的问题：“在任意给定点 $\mathbf{x}$，其真实值超过我们目前找到的最佳值 $f_{\text{best}}$ 的*预期量*是多少？”这是一个强大的概念，因为它直接关注于目标：寻找改进。计算过程涉及到在点 $\mathbf{x}$ 的整个高斯可能性[分布](@entry_id:182848)上进行积分。其结果是一个优美的[封闭形式表达式](@entry_id:267458)，完美地概括了探索-利用的平衡 [@problem_id:3471645]：

$$
\text{EI}(\mathbf{x}) = (\mu(\mathbf{x}) - f_{\text{best}}) \Phi(z) + \sigma(\mathbf{x}) \phi(z), \quad \text{where } z = \frac{\mu(\mathbf{x}) - f_{\text{best}}}{\sigma(\mathbf{x})}
$$

这里，$\Phi$ 和 $\phi$ 分别是[标准正态分布](@entry_id:184509)的累积分布函数（CDF）和[概率密度函数](@entry_id:140610)（PDF）。我们不要迷失在符号中；其背后的直觉才是真正美妙之处。这个公式有两个部分：

1.  第一项，$(\mu(\mathbf{x}) - f_{\text{best}}) \Phi(z)$，代表**利用**。当预测均值 $\mu(\mathbf{x})$ 已经显著优于我们当前的最佳值时，这一项会很大。
2.  第二项，$\sigma(\mathbf{x}) \phi(z)$，代表**探索**。当不确定性 $\sigma(\mathbf{x})$ 很高时，这一项会很大，尤其是当均值接近当前最佳值时（这使得改进变得合理）。

EI为我们提供了一种有原则的方法来比较一个安全的选择和一个冒险的尝试。想象一下，我们试图最大化一种合金的抗拉强度，目前我们找到的最佳值是350 MPa。如果一个新的候[选材](@entry_id:161179)料预测均值为360 MPa，标准差为8 MPa，EI会精确计算出我们能从这次“赌博”中期望得到多少“提升”，平衡了高均值的希望与不确定性的风险 [@problem_id:2156694]。当面临多个候[选材](@entry_id:161179)料时，具有最高EI值的那个将被选为下一次实验的对象，因为它为我们的搜索提供了最有希望的前进道路 [@problem_id:3464220]。

### 现实世界是复杂的：高级策略

[贝叶斯优化](@entry_id:175791)的真正力量在于其灵活性。GP模型和[采集函数](@entry_id:168889)的基本框架可以被巧妙地调整，以处理科学发现中混乱的现实情况。

-   **[多目标优化](@entry_id:637420)**：通常，我们不只有一个目标。我们可能想要一种既坚固*又*轻便的材料，而这两个目标常常是相互冲突的。一个简单的方法是将它们组合成一个单一的标量**[效用函数](@entry_id:137807)**，例如，$U = \text{强度} - \text{重量}$。然后，我们可以为这个新的效用函数建立一个GP模型，并运行标准的[贝叶斯优化](@entry_id:175791)程序，以找到提供最佳综合折衷的材料 [@problem_id:2156677]。

-   **约束**：现实世界的设计总是受到约束。一种催化剂不仅要高效，还必须稳定且廉价。我们可以通过为目标（例如，效率）和约束（例如，成本）分别建立GP模型来处理这个问题。然后，[采集函数](@entry_id:168889)（如**约束预期提升 (cEI)**）被修改为只在预测为可行——即可能满足约束条件——的候选者中寻找提升 [@problem_id:73056]。它将标准的EI乘以候选者有效的概率。

-   **并行与成本感知搜索**：现代研究常常是并行进行的。如果我们能一次测试10种材料，我们如何挑选一个好的*批次*？我们不能仅仅挑选EI值最高的前10个单点，因为它们可能都聚集在一起。取而代之的是，像**q-EI**这样的批处理[采集函数](@entry_id:168889)会计算整个提议批次中表现最佳成员的总预期提升，同时考虑到这些点之间的相关性 [@problem_id:73016]。此外，如果不同的实验有不同的成本，我们可以用成本来对[采集函数](@entry_id:168889)进行归一化，以寻求*每美元*的最大提升 [@problem_id:3463943]。

-   **汤普森采样**：最后，还有一种非常直观的策略，叫做**汤普森采样**。我们不计算复杂的[采集函数](@entry_id:168889)，而是简单地从我们的GP模型的函数[分布](@entry_id:182848)中随机抽取一个合理的“幻影景观”。然后，我们找到那个单一幻影景观的最大值。如果我们重复这个过程，我们将自然地平衡[探索与利用](@entry_id:174107)。均值高、[方差](@entry_id:200758)低的区域将持续产生具有高峰值的幻影（利用），而[方差](@entry_id:200758)高的区域偶尔会产生一个具有巨大、投机性峰值的幻影，吸引我们去探索它 [@problem_id:3463943]。

从其核心原理到这些高级的调整，[贝叶斯优化](@entry_id:175791)为讨论和执行智能搜索提供了一种统一而强大的语言。它将导航无限可能性空间的艰巨任务，转变为一系列理性的、有统计依据的决策，从而加速我们发现非凡新材料的旅程。

