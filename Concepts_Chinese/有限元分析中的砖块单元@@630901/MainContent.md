## 引言
在通过计算来理解和预测物理世界的探索中，我们必须首先将复杂的现实分解为更简单、可管理的部分。在工程和物理学领域，有限元方法为这一过程提供了框架，而[六面体单元](@entry_id:174602)（即“砖块”单元）是其最基本的构建模块之一。但是，这样一个简单的立方体形式如何能够用于分析从汽车车身的优雅曲线到混凝土大坝内部的巨大压力等各种问题？答案不在于形状本身，而在于一个优雅的数学框架，它允许我们映射、变形和探究这个单元，从而揭示其内部的物理原理。

本文探讨了砖块单元的理论和应用，旨在弥合其简单外观与强大功能之间的鸿沟。我们将首先深入其“原理与机制”，揭示[等参映射](@entry_id:173239)的数学原理、[数值积分](@entry_id:136578)的挑战，以及可能出现的著名的锁定和沙漏等[病态问题](@entry_id:137067)。随后，“应用与跨学科联系”一章将展示这些单元在现实世界中的应用，从结构和[断裂力学](@entry_id:141480)到先进材料设计和高性能计算，从而证明抽象理论与具体工程创新之间的深刻联系。

## 原理与机制

### 理想砖块与现实世界：[等参映射](@entry_id:173239)

想象你是一位雕塑家，但你唯一的工具是一块完美的方形粘土。要创作一座复杂的雕像，你不会直接雕刻最终形状。相反，你可能会思考如何使这个简单的方块变形——这里拉伸，那里挤压——直到它符合你所设想的形态。这就是**[等参映射](@entry_id:173239)**的核心思想。

在有限元的世界里，我们从一个理想化的、完美的“母”单元开始。对于砖块单元来说，这是一个在[局部坐标系](@entry_id:751394)中定义的立方体，其坐标轴通常为 $(\xi, \eta, \zeta)$，每个坐标的取值范围为 $-1$ 到 $1$。这个纯粹的数学空间就是我们的画布。我们想要模拟的真实的、物理的单元——它在我们的模拟中可能是扭曲的，并以一个奇怪的角度放置——被称为“物理”单元。连接它们的神奇之物是一组**形函数**，记作 $N_i$。

对于一个八节点砖块单元（通常称为 Q1 或 H8 单元），其八个角点中的每一个都有一个对应的形函数。给定角点 $i$ 的形函数 $N_i$ 有一个非常简单的特性：它在该角点的值为 $1$，而在所有其他七个角点的值为 $0$。在这些角点之间，它提供了一个平滑的过渡。对于 Q1 砖块单元，这些函数是三线性的，由每个坐标的线性函数的简单乘积构成 [@problem_id:3570555]：

$$
N_i(\xi, \eta, \zeta) = \frac{1}{8}(1 + \xi_i\xi)(1 + \eta_i\eta)(1 + \zeta_i\zeta)
$$

在这里，$(\xi_i, \eta_i, \zeta_i)$ 是母体立方体中角点 $i$ 的坐标（例如，一个角点为 $(-1, -1, -1)$，另一个为 $(1, -1, -1)$，依此类推）。这些函数充当混合权重。为了找到母体立方体内任意点 $(\xi, \eta, \zeta)$ 对应的物理坐标 $\mathbf{x}$，我们只需使用形函数作为权重，对单元角点的物理坐标 $\mathbf{x}_i$ 进行混合：

$$
\mathbf{x}(\xi, \eta, \zeta) = \sum_{i=1}^{8} N_i(\xi, \eta, \zeta) \mathbf{x}_i
$$

这就是“映射”部分。“等参”部分则是一个天才之举：我们使用*完全相同*的形函数来描述我们感兴趣的物理行为，例如位移场 $\mathbf{u}$：

$$
\mathbf{u}(\xi, \eta, \zeta) = \sum_{i=1}^{8} N_i(\xi, \eta, \zeta) \mathbf{u}_i
$$

这里，$\mathbf{u}_i$ 是节点的位移。这种优雅的对称性——对几何和物理使用相同的函数——是等参列式法的核心。

当然，当我们从理想立方体映射到物理单元时，我们拉伸和扭曲了空间。**[雅可比行列式](@entry_id:137120)** $J$ 是这种局部体积变化的度量。它就像一个放大镜，其放大倍数可以随点的位置而变化。如果物理单元是一个完美的平行六面体（立方体的仿射变换），[雅可比行列式](@entry_id:137120)是恒定的 [@problem_id:3570552]。但如果单元是扭曲或弯曲的，$J$ 就成为 $(\xi, \eta, \zeta)$ 的函数 [@problem_id:3567424]。至关重要的是，我们必须确保在单元内部处处 $J>0$。一个负的雅可比行列式意味着单元被“内外翻转”，这是一种无意义的状态，会破坏我们的计算 [@problem_id:3570552]。

虽然八节点砖块单元很强大，但其直边限制了它[精确模拟](@entry_id:749142)[曲面](@entry_id:267450)的能力。这就是[高阶单元](@entry_id:750328)，如20节点（H20）砖块单元发挥作用的地方。通过在边上增加节点，我们可以使用二次形函数。这使得单元的边可以弯曲成抛物线，从而更好地逼近弯曲的几何形状 [@problem_id:3570552]。

### 探究单元：积分与刚度

现在我们有了描述单元的方法，就可以开始向它“提问”了。在力学中，这些问题通常以积分的形式出现。例如，为了找到单元的刚度矩阵——它告诉我们单元如何抵[抗变](@entry_id:192290)形——我们需要在其体积上对与应力和应变相关的量进行积分。为了找到用于动力学模拟的质量矩阵，我们需要对形函数的乘积进行积分 [@problem_id:3570555]。

这些积分可能很复杂，特别是对于扭曲的单元。幸运的是，我们不必解析地求解它们。我们可以使用一种强大的技术，称为**数值求积**。最常见的类型是**[Gauss-Legendre求积](@entry_id:138201)**，它几乎是神奇的。它告诉我们，不必在成千上万个点上计算函数值再求和，我们只需在几个特殊位置（称为**[高斯点](@entry_id:170251)**）上对其进行采样并进行加权求和，就可以得到某个次数以下任何多项式的*精确*答案。对于一个次数最高为 $2m-1$ 的多项式，我们只需要 $m$ 个[高斯点](@entry_id:170251) [@problem_id:3570586]。

这就引出了设计单元时的一个关键选择：我们应该使用多少个[高斯点](@entry_id:170251)？

-   **完全积分**：这意味着使用足够多的[高斯点](@entry_id:170251)来精确积分单元的刚度矩阵（至少对于简单的矩形形状而言）。对于我们的标准 H8 砖块单元，刚度的被积函数在每个坐标方向上都是二次的，所以我们需要在每个方向上取两个点，从而得到一个 $2 \times 2 \times 2 = 8$ 点的积分法则。这种稳健的方法产生了一个性态良好的单元。其[刚度矩阵](@entry_id:178659)恰好有六个[零能模式](@entry_id:172472)，对应于物体在不发生变形的情况下可以经历的六种[刚体运动](@entry_id:193355)（三个平移和三个转动）。这在物理上是正确的 [@problem_id:3570586]。

-   **[减缩积分](@entry_id:167949)**：这意味着使用比完全积分所需更少的[高斯点](@entry_id:170251)。最极端的情况是仅在单元中心 $(\xi, \eta, \zeta)=(0,0,0)$ 使用一个单点。这在计算上要便宜得多。而且有时，令人惊讶的是，它能给出精确的答案，例如在计算均布体力产生的总力时 [@problem_id:3570586]。但是这种计算上的捷径伴随着风险。通[过采样](@entry_id:270705)更少的信息，我们是否对单元的某些行为“视而不见”了？

完全积分和[减缩积分](@entry_id:167949)之间的这种张力，为[计算力学](@entry_id:174464)领域一些最著名的挑战——以及最巧妙的解决方案——埋下了伏笔。

### [数值病态](@entry_id:169044)：当好单元变坏时

事实证明，在错误的情况下，完全积分和[减缩积分](@entry_id:167949)都可能导致数值“疾病”，使单元的行为表现出极其不符合物理规律的方式。

#### [沙漏现象](@entry_id:164538)：单元的隐藏柔性

假设我们使用单点[减缩积分](@entry_id:167949)，即只在中心处设置一个[高斯点](@entry_id:170251)。现在，单元只能“感受”到其核心处的应变。如果存在一种变形模式，它在[中心点](@entry_id:636820)产生的应变为零，但在其他地方却有明显变形，那会怎样？单元会认为这种变形是“免费”的——即不消耗能量——并且不会对其产生任何抵抗。

这正是**[沙漏现象](@entry_id:164538)**中发生的情况。考虑一种变形，其中顶面和底面朝相反方向扭转，就像拧海绵一样。这种模式可以用类似于 $u_x = \alpha \xi \eta \zeta$ 的位移场来构造 [@problem_id:3555190]。虽然单元明显变形了，但[中心点](@entry_id:636820)的应变恰好为零。单积分点对这种运动是“盲目”的。单元变得不稳定，并可能表现出怪异的、非物理的[振荡](@entry_id:267781)，其形状酷似沙漏，因此得名。这些被称为**[伪零能模式](@entry_id:755267)**，因为它们是我们的数值方法的产物，而非真实的物理现象 [@problem_id:3570586]。

这种病态是**约束不足**的典型案例。其解决方法被称为**[沙漏控制](@entry_id:163812)**，即增加一个微小的、人为的刚度，专门用于惩罚这些沙漏运动，同时不影响单元的物理行为。这就像增加一个特制弹簧，只有当单元试图以非物理方式摆动时才会起作用，从而恢复其稳定性 [@problem_id:3546600]。

#### [体积锁定](@entry_id:172606)：一个纯粹固执的单元

现在来看一个悖论。如果我们使用我们所说的“稳健”方法的完全积分，但将其应用于像橡胶或饱和土这样几乎不可压缩的材料，会发生什么？这些材料的[泊松比](@entry_id:158876) $\nu$ 非常接近 $0.5$，其定义特征是它们强烈抵抗任何体积变化。

物理学要求材料中*每一点*的体积都保持不变（或几乎不变）。当我们使用一个完全的 $2 \times 2 \times 2$ 积分方案时，我们实际上是在试图同时在所有八个[高斯点](@entry_id:170251)上强制执行这个不可压缩约束：$J(\boldsymbol{\xi}_i) \approx 1$，对于 $i=1, \dots, 8$ [@problem_id:2607095]。

问题在于，[H8单元](@entry_id:750117)的简单三线性[位移场](@entry_id:141476)不够复杂，无法在满足八个独立体积约束的同时以复杂的方式弯曲或剪切。这是一个**过度约束**的案例。单元的[运动学](@entry_id:173318)被“锁定”了。为了避免违反体积约束，单元干脆拒绝变形。它变得人为地、荒谬地坚硬。在模拟一个橡胶块弯曲时，被锁定的单元会表现得好像它们是由钢制成的。这种现象被称为**[体积锁定](@entry_id:172606)**，其表现为当 $\nu \to 0.5$ 时，单元计算出的[抗体](@entry_id:146805)积变化能力变得比其抗剪切能力大无穷倍 [@problem_id:3567396]。悖论形成了：我们试图通过使用完全积分来提高精度，结果却使结果变得更糟。

### 解决方法：设计更智能的单元

#### [选择性减缩积分 (SRI)](@entry_id:754659)

对抗锁定的第一个突破是一个极其简单的想法。锁定问题源于应变能的*体积*部分。剪切部分没有问题。那么，为什么要对它们同等对待呢？在**[选择性减缩积分](@entry_id:168281)（SRI）**方法中，我们将单元的内能计算分开处理。我们继续对剪切（偏）部分使用完全积分，以防止[沙漏现象](@entry_id:164538)。但对于棘手的体积部分，我们使用减缩（单点）积分。这巧妙地用一个关于单元总体积变化的单一、平均约束取代了八个刚性约束。现在，只要单元的总[体积保持](@entry_id:141001)不变，它就可以自由地以复杂的方式变形，而这正是物理学所要求的 [@problem_id:2607095]。

#### $\bar{B}$ 方法

一个更通用且强大的解决方案可以在一类称为**增强假设应变（EAS）**方法的技术中找到。其中最著名的是**$\bar{B}$方法**（读作“B-bar”）。

其核心思想是直接解决问题的根源：从位移计算出的性态不良的[体积应变](@entry_id:267252)场。我们不使用这个有问题的场，而是*假设*一个更简单、性態更好的场。最常见的选择是假设[体积应变](@entry_id:267252)在整个单元内是恒定的。我们通过对单元体积上的“真实”体积应变取平均值来计算这个恒定值 [@problem_id:3567431]。

这个“投影”应变，记作 $\bar{\varepsilon}_v$，取代了我们能量计算中有问题的逐点应变。与SRI类似，该方法将多个相互冲突的约束简化为对单元平均体积变化的单个、可管理的约束，从而解决了锁定问题 [@problem_id:2607095]。这些增强单元经过精心设计，对于简单的基准问题（通过所谓的**[分片检验](@entry_id:162864)**）仍然能给出精确解，确保我们对一种“疾病”的治疗没有引入另一种“疾病” [@problem_id:3567431]。

从一个可变形立方体的简单想法出发，我们穿行于一个充满数值技巧的世界，发现了锁定和沙漏等[病态问题](@entry_id:137067)，并发明了像SRI和$\bar{B}$这样优雅的解决方法。这个看似简单的砖块单元不仅仅是一个计算工具；它是物理学、数学和工程创造力之间持续对话的一个缩影。

