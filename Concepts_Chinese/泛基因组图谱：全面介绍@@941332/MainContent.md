## 引言
首个人类基因组的测序为科学界提供了一幅基础图谱——一个用于导航我们遗传密码的线性参考。多年来，这张单一的图谱一直指导着基因组学研究，但其根本局限性已日益凸显：它仅代表了人类巨大遗传多样性的一个版本。对单一参考的依赖造成了“参考偏倚”（reference bias），这是一个系统性问题，导致图谱上不存在的遗传变异被遗漏或错误解读，从而造成关键信息的丢失。这一知识鸿沟阻碍了我们研究人类多样性的能力，甚至可能导致健康差异。

为应对这一挑战，基因组学领域正从单一的线性结构转向一个动态网络：[泛基因组图](@entry_id:165320)谱。本文将探讨这一革命性的新模型。首先，在“原理与机制”一章中，我们将解构[泛基因组图](@entry_id:165320)谱，阐释它如何利用节点和路径来表示从单字母变异到大规模[结构重排](@entry_id:268377)的全部人类遗传变异。接着，我们将看到这一精巧的结构如何直接解决参考偏倚问题。随后，在“应用与跨学科关联”一章中，我们将探讨这一新范式的深远影响，从改变基础基因组学工具和进化生物学，到开创真正的[个性化医疗](@entry_id:152668)，甚至为文本分析和软件工程等截然不同的领域提供新见解。

## 原理与机制

想象一下，首张完整的人类基因组图谱就像是为一块广袤的新发现大陆绘制的第一幅地图集。这是一项巨大的成就，它提供了一个标准的坐标系统，即**线性参考**，我们可以在其上精确定位基因的位置，并开始理解我们自身生物学的图景。多年来，这张单一的图谱一直是我们的指南。当我们测序一个新个体的基因组时，我们实际上得到的是数百万个关于其个人图景的微小卫星片段。基因组学的任务就是将这些被称为**读段**（reads）的片段，在我们的主图谱上找到它们适配的位置。

但这其中存在一个日益明显的问题。那张精美的线性图谱只代表了这块大陆的一个版本。人类具有极其惊人的多样性。我们的基因组图景中充满了微小的变异、替代路线以及主图谱上没有的独特特征。当来自某人基因组的一个读段描述了一个我们参考图谱上不存在的特征——一种替代的遗传拼写——时会发生什么？这个读段要么会丢失，要么无法比对成功，要么被强制安放在一个“适配性差”的位置，就像试图用一张十年前的地图集在一个新建的居民区导航一样。这个根本性问题被称为**参考偏倚**。

这不仅仅是一个小麻烦，而是一种系统性的信息丢失。考虑染色体上的一个单一位置，有些人的核苷酸是腺嘌呤（A），而另一些人则是鸟嘌呤（G）。如果我们的参考图谱只包含“A”版本，那么任何来自携带“G”的个体的读段都会存在一个固有的错配。即便使用高精度的测序技术，每个读段也可能出现少量随机错误。如果一个比对工具允许（比如说）最多 $k=2$ 个错配，那么一个携带“G”变异的读段就已经有了一次“不良记录”。它只需要再出现两个随机测序错误就会被丢弃，而携带“A”变异的读段则需要三个。这个看似微小的差异会累积起来。通过建模可以证明，仅仅因为与我们理想化的参考不匹配，相当一部分来自替代等位基因的完全有效的读段就被丢失了 [@problem_id:4376066]。我们正在系统性地对我们试图研究的变异视而不见。

### 将变异编织入单一结构

如果一张图谱不够，解决方案是什么？我们不可能为地球上的每个人都创建一张独立的地图集。答案是放弃单一线性结构的想法，转而采用一种更丰富、更动态的表示方法：**[泛基因组图](@entry_id:165320)谱**。

不要把它看作一条单一的道路，而应将其视为整个国家复杂而精美的交通网络。这个国家的大部分地区由所有人都会使用的主要高速公路连接——这些是我们基因组中几乎所有人都共享的部分。但在某些区域，存在着代表遗传变异的替代路线、风景岔路和地方道路。[泛基因组图](@entry_id:165320)谱就是这个完整的网络。

在这个图谱中，DNA序列被表示为**节点**（道路），它们之间的连接是**边**（交叉口）。一个个体完整的染色体则是穿过这个网络的一条特定**路径**——一次旅程。这个简单而强大的思想使我们能够在一个统一的结构中编码整个群体的全部多样性 [@problem_id:4391365]。

让我们通过一个简单的例子来看看它是如何工作的 [@problem_id:2818225]。想象一段DNA：

-   **单核苷酸多态性（SNP）：** 这是最简单的变异，就像我们前面提到的“A”与“G”的例子。在图谱中，路径分裂成两条微小的平行轨道。一个节点包含“A”，另一个包含“G”。紧接着，路径重新合并。这形成了一个在图谱中看起来像一个小“气泡”的结构。携带“A”等位基因的个体，其基因组会走“A”轨道；携带“G”等位基因的个体则走“G”轨道。

-   **插入：** 假设某人有一小段额外的DNA。图谱用一个新的环路来表示它，这个环路从主[路径分支](@entry_id:155468)出去，然后在下游不远处重新汇合。主路径代表没有该插入的个体，而选择绕行风景路线的路径则代表拥有该插入的个体。

-   **缺失：** 如果某人缺少一小段DNA呢？在这里，图谱提供了一条捷径。一条边绕过了包含可缺失序列的一个或多个节点，允许路径完全跳过该区段。

这就是[泛基因组图](@entry_id:165320)谱的内在美妙之处：所有这些不同类型的变异——SNP、插入、缺失，甚至更复杂的**结构性变异**——都使用相同的节点、边和路径的简单语言来表示。它们不再是相对于某个参考的错误；它们只是基因组图景中同等地位的替代路线。

### 图谱的语言：流动世界中的坐标

这种新的、流动的表示方法提出了一个深刻的问题：如果基因组不再是一条简单的线，我们如何谈论“位置”？像“3号染色体上第$1,456,789$号碱基”这样的单一坐标概念变得模棱两可。

解决方案是让我们的坐标系统更智能。我们可以通过指定一条路径以及沿该路径的偏移量来定义一个位置，而不是使用单一的数字。一个位置变成了这样一个组合：`(路径, 偏移量)`。例如，我们可以谈论标准参考路径上的一个位置，或者在特定群体中发现的某个替代单倍型路径上的位置 [@problem_id:2818225] [@problem_id:4604816]。

这解决了插入和缺失（indels）会改变后续所有坐标的问题。不同路径上坐标系统之间的关系可以用数学方式描述。想象一下，将坐标从参考路径R映射到一个包含$5$个碱基插入和$10$个碱基缺失的替代单倍型路径H [@problem_id:2818225]。这个映射函数，我们称之为 $f_{R \rightarrow H}$，将是分段的。在插入之前，坐标匹配：$t = x$。插入之后，路径H上的坐标发生偏移：$t = x+5$。缺失之后，它们又被移回：$t = x-5$。参考路径上对应于缺失序列的区域在替代路径上根本没有相应的坐标。这种优雅的数学描述精确地捕捉了生物学的现实。

为了标准化这些复杂的结构，生物信息学家开发了如**图形片段组装（GFA）**格式。在GFA中，图谱被描述为一个文本文件，其中“S-行”定义了携带序列的节点（Segments），而“L-行”定义了它们之间的连接（Links）。至关重要的是，这些连接不仅指定了邻接关系，还指定了**方向** [@problem_id:4579457]。DNA是双链的，图谱必须知道如何将一个片段的起始端（$5'$）或末端（$3'$）连接到另一个片段的起始端或末端。这使其能够成为一个**双向图**，这种结构足够强大，甚至可以表示像倒位这样复杂的重排，即一段DNA被翻转过来 [@problem_id:4554288]。

### 回报：恢[复平衡](@entry_id:204586)与洞见未知

那么，这个优美的理论结构带来了什么实际回报呢？最直接的好处是参考偏倚的显著减少。有了[泛基因组图](@entry_id:165320)谱，一个包含已知变异等位基因的读段现在在图谱上有了一个完美的“归宿”。比对工具看到的不再是一个错配，而是与一条替代路径的[完美匹配](@entry_id:273916)。

让我们回到真实的诊断场景。想象一位患者某个结构性变异呈杂合状态，例如，他们拥有一个带有$300$碱基对插入的基因拷贝和一个没有插入的拷贝。由于他们每种等位基因各有一个，我们预计该区域约$50\%$的测序读段应支持插入，而$50\%$应支持参考。这被称为**等位基因平衡**。

当使用线性参考时，跨越插入断点的读段无处可正确比对。比对工具会看到一个巨大的差异——可能有$30$个或更多的错配碱基 [@problem_id:4397178]。这种比对的可能性与匹配参考的读段相比，低得惊人。因此，这些读段被丢弃，支持插入等位基因的读段计数被人为降低。等位基因平衡可能被扭曲到像$0.44$这样的数值，错误地暗示患者拥有的插入等位基因拷贝数少于实际情况。

使用一个将该插入作为有效路径包含在内的[泛基因组图](@entry_id:165320)谱，那些同样跨越断点的读段现在能够以完美的分数进行比对。它们被正确计数，等位基因平衡也恢复到其真实值，约为$0.5$。这种平衡的恢复不仅仅是学术上的修正；在药物基因组学等领域，药物剂量可能取决于基因的拷贝数，这对于临床决策至关重要。

这种能力远远超出了简单变异的范畴。图谱框架具有惊人的灵活性。它可以表示以前标准方法无法看到的巨大而复杂的结构性变异。它甚至可以模拟像**基因融合**这样极其复杂的事件，即一条染色体上的一个基因断裂并连接到另一条染色体上的一个基因。这只需通过添加一个将1号染色体路径上的节点连接到2号染色体路径上的节点的“Link”即可实现 [@problem_id:2412180]。图谱甚至可以被增强以表示**多倍体**基因组——即每个染色体拥有两个以上拷贝的生物——通过在边上定义一个“流”或“[多重性](@entry_id:136466)”，记录有多少个染色体拷贝穿过每条路径 [@problem_id:2412205]。

### 构建[泛基因组](@entry_id:149997)：一幅集体肖像

这些强大的图谱并非抽象的构造；它们是由真实数据构建的。[泛基因组](@entry_id:149997)的质量直接取决于用于创建它的个体基因组的质量和多样性。**长读长测序**的出现以及**[端粒](@entry_id:138077)到端粒（T2T）组装**等突破——这些技术提供了完整、无间断的染色体序列——是革命性的 [@problem_id:4579457] [@problem_id:4348140]。每一个添加到[泛基因组](@entry_id:149997)中的高质量、单倍型分辨的基因组都贡献其独特的路径，从而丰富了图谱。

随着我们添加更多的基因组，我们捕捉到存在于人[类群](@entry_id:182524)体中稀有变异的概率也随之增加。我们从 $V$ 个可能的位点中捕获到的稀有变异的期望数量 $E$，会随着我们添加 $2m$ 个单倍型而增长，遵循关系 $E = V [1 - (1 - f)^{2m}]$，其中 $f$ 是稀有变异的频率 [@problem_id:4348140]。这说明了[泛基因组](@entry_id:149997)项目的集体性质。它不仅仅是一张图谱，而是一幅不断演化、描绘我们物种所有错综复杂和美丽多样性的集体肖像。

