## 应用与跨学科联系

现在我们已经掌握了边缘[似然](@entry_id:167119)的原理，我们可以问一个最重要的问题：“它有什么用？”简单地说它是一种[模型比较](@entry_id:266577)工具，就像说望远镜是用来观察事物的工具一样。这固然没错，但却忽略了该工具所开启的整个发现宇宙。边缘似然不仅仅是一套统计机器；它是一种深刻的[科学推理](@entry_id:754574)原则的定量表达，一种可以应用于几乎所有探究领域的“万能酸”。它为我们提供了一种形式化的方法来权衡证据，在关于世界的不同故事之间做出选择，甚至理解我们所能知道的极限。

让我们踏上一段旅程，穿越其中一些世界，看看这个原则的实际应用。

### 奥卡姆剃刀，数字铸就

你可能听说过[奥卡姆剃刀](@entry_id:147174)：即在所有其他条件相同的情况下，最简单的解释通常是最好的。这是一个很好的哲学指导方针，但在实践中如何应用呢？什么时候一个解释“更简单”？什么时候“所有其他条件”才真正“相同”？边缘[似然](@entry_id:167119)提供了一个惊人优雅且自动的答案。

想象一下，你正试图为一个简单过程的速率建模——比如说，一个盖革计数器在给定一分钟内探测到的放射性粒子数。你有了一些数据，你怀疑速率 $\lambda$ 不是某个固定的普适常数，而是存在一些不确定性。你可能从一个关于你对 $\lambda$ 的信念的简单模型（模型 $M_1$）开始，也许是一个单一的、钟形的 Gamma [分布](@entry_id:182848)。但接着一位同事提出了一个更复杂的模型 $M_2$：如果速率实际上是两种不同可能性的混合，代表系统的两种不同潜在状态呢？这个模型更灵活；它有更多的参数。它肯定可以被调整得很好地拟合你收集到的数据。

那么，你应该偏好哪个模型呢？是那个能更好地拟合现有数据的更灵活的模型，还是那个更简单的模型？这时，边缘[似然](@entry_id:167119)就作为公正的裁判介入了。它为每个模型计算出观测到你的数据的总概率，这个概率是在模型所有可能的参数值上，根据你的[先验信念](@entry_id:264565)加权平均得出的。

一个简单的模型（$M_1$）做出了一个大胆的预测。它将赌注押在一个狭窄的范围内。如果数据落入该范围，边缘似然就很高——模型因其正确、精确的预测而受到奖励。一个复杂的模型（$M_2$）则更为谨慎。它将赌注分散在更广泛的可能性上。它不太可能完全错误，但也因其正确而获得的赞誉较少，因为它“预测”了各种各样的可能性。边缘似然 $p(D|M)$ 自然地惩罚了过于复杂的模型，因为它缺乏特异性[@problem_id:720083]。这不是事后附加的临时惩罚；这是概率法则的内在结果。[贝叶斯因子](@entry_id:143567)，即两个边缘似然的比率，成为[奥卡姆剃刀](@entry_id:147174)在实践中的定量度量。这个原理是如此基础，以至于它的大样本近似产生了其他常用工具，如[贝叶斯信息准则](@entry_id:142416)（BIC），该准则明确包含一个取决于参数数量和数据集大小的惩罚项[@problem_id:2654930]。

### 在不同世界间做出评判：从物种到[表面力](@entry_id:188034)

这种对拟合度和复杂度的自[动平衡](@entry_id:163330)，使边缘似然成为检验具体科学假说的有力工具。通常，两种理论之间的辩论可以形式化为两种[统计模型](@entry_id:165873)之间的选择。

#### 生命之树

以进化生物学领域为例，科学家们在这里重建生命的历史。在这里，边缘似然已成为不可或缺的工具。

想象你是一名生物学家，正在研究生活在山脉两侧的两个蝴蝶种群。它们看起来略有不同。它们仅仅是单一物种的局部变种，还是正走在独立的进化[轨道](@entry_id:137151)上，正在成为两个不同的物种？这是一个具有现实世界保护意义的基本问题。你可以将其转化为两个模型之间的竞争：一个“合并”模型，其中所有蝴蝶都属于一个单一的遗传家族树；以及一个“分裂”模型，其中它们形成两个独立的家族。在从两个种群中收集 DNA 后，你可以为每个模型计算边缘似然。你问每个模型：“根据你提出的历史，我们实际观测到的遗传数据的可能性有多大？”那个对数据不那么“惊讶”的模型——也就是赋予数据更高概率的模型——就是我们应该偏好的模型。分裂和合并假说之间的[贝叶斯因子](@entry_id:143567)给了我们一个数字，通常是一个非常大的数字，告诉我们遗传数据在多大程度上支持一个物种或两个物种的存在[@problem_id:2760526]。

我们可以更进一步。假设我们知道在某一组植物中，发生了向更短世代时间的转变。更短的生命周期可能合理地导致更快的分子[进化速率](@entry_id:202008)。是这样吗？我们可以在系统发育树上建立两种进化模型。一种是通用的“宽松时钟”模型，它允许速率在整个树上变化。另一种是特定的“[局部时](@entry_id:194383)钟”模型，它只提出两种速率：树的大部分区域的背景速率，以及在发生世代时间转变的那个家族分支上有一个加速的速率。通过比较这两个模型的边缘似然，我们可以问数据是否支持这个具体的、有生物学动机的故事，而不是一个更通用的故事[@problem_id:2590737]。

我们甚至可以问关于遥远过去事件顺序的问题。在陆地植物的进化中，两个主要的创新是异形孢子（产生两种不同类型的孢子，是花粉和胚珠的前身）和[内生孢子](@entry_id:138669)（在旧孢子壁内发育幼小植物）。哪个先出现？我们可以建立两种进化模型：$M_{E\rightarrow H}$，其中从没有这两种性状到同时拥有这两种性状的进化路径必须首先经过[内生孢子](@entry_id:138669)阶段；以及 $M_{H\rightarrow E}$，其中它必须首先经过异形孢子阶段。再一次，我们可以在这些受约束的模型下，计算我们跨越一系列植物物种的性状数据的边缘[似然](@entry_id:167119)。[贝叶斯因子](@entry_id:143567)将告诉我们哪种进化叙事更好地得到了现存证据的支持[@problem_id:2581212]。

在某些情况下，认为只有一个模型是“真实”的可能很天真。也许有几个不同的人口历史模型都从数据中获得了一些支持。与其只选择一个，我们可以使用边缘似然来构建所有模型的加权平均。这种技术，称为[贝叶斯模型平均](@entry_id:168960)，提供了一个对，比如说，人口规模历史的估计，该估计充分考虑了我们不仅在模型*内部*的不确定性，还考虑了*关于*模型本身的不确定性。平均中每个模型的权重就是其后验概率，而这又与其边缘[似然](@entry_id:167119)成正比[@problem_id:2700421]。

#### 塑造物质的力量

同样的原则在物理科学中也同样适用。想象一位物理学家使用[表面力仪](@entry_id:171949)器来测量在液体中两个表面非常靠近时它们之间的微小力。得到的力与距离的曲线很复杂。这位物理学家有一个理论，认为总力是三种不同效应的组合：长程的[范德华吸引力](@entry_id:190626)、中程的静电排斥力，以及非常短程的“水合”力。

这个三部分理论是必要的吗？或者数据是否可以同样好地用一个只有范德华力和静电力的更简单模型来解释？这是一个边缘[似然](@entry_id:167119)的完美任务。物理学家可以拟合一个包含所有三个力分量的模型和一个只包含两个力分量的[嵌套模型](@entry_id:635829)。如果数据强烈要求第三个分量，那么更复杂模型的边缘[似然](@entry_id:167119)将高得多。如果第三个分量只是在“清理”一点随机噪声，[奥卡姆剃刀](@entry_id:147174)就会起作用，边缘似然将偏爱更简单的两分量模型[@problem_id:2791392]。我们本质上是在让数据告诉我们哪些物理过程是真实的，哪些是多余的。

### 更深入的审视：估计与知识的极限

除了在离散模型之间进行选择，边缘似然还为统计推断本身的性质提供了更深刻的见解。

#### 猎人成为猎物：估计超参数

到目前为止，我们一直将边缘似然 $p(\mathbf{y} | M)$ 视为模型 $M$ 的函数。但如果我们固定模型，并将其视为其自身基本假设——所谓的超参数——的函数呢？

考虑一个[材料科学](@entry_id:152226)中的问题，我们测试一种新合金的几个“相同”试样的弹性模量。每次测试都给我们一个该试样真实模量 $E_i$ 的估计值 $\hat{E}_i$，以及一些[测量不确定度](@entry_id:202473) $s_i^2$。我们相信这些试样本身并非完全相同，而是从一个具有平均模量 $\mu$ 和真实试样间[方差](@entry_id:200758) $\tau^2$ 的总体中抽取的。在这个[分层模型](@entry_id:274952)中，$\mu$ 和 $\tau^2$ 是超参数。

为了找到这些超参数，我们可以首先积分掉所有未知的真实模量 $\{E_i\}$。结果是观测值的边缘[似然](@entry_id:167119) $p(\{\hat{E}_i\} | \mu, \tau^2)$。现在我们可以反过来：不再用这个函数来比较模型，而是找到使它*最大化*的 $\mu$ 和 $\tau^2$ 的值。这种方法，被称为第二类[最大似然](@entry_id:146147)或[经验贝叶斯](@entry_id:171034)，利用数据来估计先验本身的参数[@problem_id:2707647]。这是一个强大而实用的想法，但它带有一个警告：当数据稀少时（试样很少），这种方法可能会有偏差并低估真实的总体[方差](@entry_id:200758) $\tau^2$，这提醒我们没有神奇的方法可以替代好的数据。

#### 揭示无法知晓之事

也许边缘似然最深刻的应用之一是告诉我们从给定的实验中我们*无法*知道什么。这就是“可识别性”问题。

想象一个类似的分层实验，但我们只为每个“组”或“试样”进行单次测量。我们想分别估计[组间方差](@entry_id:175044) $\tau^2$ 和组内测量[方差](@entry_id:200758) $\sigma^2$。如果我们写下在积分掉潜在的组特定效应后的边缘似然，我们会发现一些非凡的事情：最终的表达式仅通过它们的和 $\kappa^2 = \tau^2 + \sigma^2$ 来依赖于参数 $\tau^2$ 和 $\sigma^2$[@problem_id:3390177]。

想一想这意味着什么。任何加起来等于相同 $\kappa^2$ 的 $\tau^2$ 和 $\sigma^2$ 组合都会产生完全相同的边缘[似然](@entry_id:167119)。该函数在 $\tau^2 + \sigma^2$ 为常数的线上是完全平坦的。没有峰可爬，没有最大值可寻。数据完全没有任何信息可以区分[组间方差](@entry_id:175044)和[组内方差](@entry_id:177112)。这不是我们算法的失败；这是数学揭示的一个根本限制。如果在某些组内没有重复测量，这两个[方差](@entry_id:200758)来源就完全混淆了。边缘似然以及由它导出的[费雪信息矩阵](@entry_id:750640)，使这个直观的想法在数学上变得精确。

#### 追踪不可见之物

最后，让我们考虑随时间演变的动态系统——卫星的[轨道](@entry_id:137151)、疾病的进展、经济的波动。这些系统通常由一个我们无法直接看到但试图从噪声测量中推断的隐藏“状态”来描述。卡尔曼滤波器是完成此任务的经典工具。它接收一连串的观测值，并递归地更新我们对隐藏状态的信念。

边缘似然在这里扮演什么角色？事实证明，所有观测值的总边缘似然有一个非常直观的形式，称为“[预测误差](@entry_id:753692)分解”。在每个时间步，[卡尔曼滤波器](@entry_id:145240)对下一个观测值做出预测并量化其不确定性。边缘[似然](@entry_id:167119)就是每一步实际预测误差概率的乘积[@problem_id:3388780]。一个好的[系统动力学](@entry_id:136288)模型是能够持续良好地预测下一个观测值的模型；它不会经常感到惊讶。边缘似然是这种预测成功性的累[积度量](@entry_id:637352)。这提供了一种通过最大化模型的整体预测性能来调整动态模型本身参数（如[过程噪声和测量噪声](@entry_id:165587)的协[方差](@entry_id:200758) Q 和 R）的方法。

从生命之树到原子间的作用力，从发现什么是真实的到理解什么是无法知道的，边缘似然都作为一个统一的原则。它是数据的声音，用概率的语言说话，告诉我们关于世界的哪些故事是真实的。