## 引言
准确模拟物理世界——从机翼上的气流到穿越地球的[波的传播](@entry_id:144063)——的探索，从根本上说，是[求解偏微分方程](@entry_id:138485)（PDE）的挑战。几十年来，数值方法一直试图将这些连续的定律转化为计算机能够理解的语言，但许多传统方法都受到对连续性的严格要求的限制，在处理复杂几何形状和诸如激波之类的尖锐、间断解时力不从心。这一局限性造成了重大的知识鸿沟，阻碍了许多关键科学和工程领域的高保真模拟。

本文介绍了间断Galerkin (DG)方法，这是一个功能强大且灵活的框架，它颠覆了传统的约束。通过拥抱间断的自由，DG方法提供了前所未有的适应性和准确性。在接下来的章节中，您将踏上一段理解这项革命性技术的旅程。首先，在“原理与机制”中，我们将解构DG方法背后的核心理念，探索它如何利用[破碎函数空间](@entry_id:746988)和数值通量来实现灵活性和物理一致性。随后，在“应用与跨学科联系”中，我们将领略该方法在不同科学和工程学科中的成功应用，见证其卓越的多功能性。

## 原理与机制

想象一下，你想用一些直边木块来建造一个光滑、弯曲雕像的精确复制品。传统方法，很像许多经典数值方法所采用的方法，会坚持要求每一块木块都必须与相邻木块完美贴合，不能有任何间隙或悬垂。边缘必须完美对齐。这听起来很合理，但却造成了极大的约束。为了捕捉一个细微的曲线，你需要大量无穷小且切割完美的木块。如果你想只给雕像的一小部分增加更多细节，你可能需要重新切割并重新安装所有周围的木块。

间断Galerkin (DG)方法始于一个极其解放、近乎颠覆性的想法：如果我们不强迫这些木块匹配呢？如果我们允许它们是不连续的呢？

### 间断的自由

DG方法的核心是一种“分而治之”的理念。我们将问题域——无论是一个固体、一体积的流体，还是一个[电磁场](@entry_id:265881)——划分为一系列更小、更简单的形状，我们称之为**单元**。在每个单元内部，我们用一个简单的函数来近似我们的解（比如温度或速度），这个函数通常是某个次数为$p$的多项式。

革命性的一步在于我们如何处理这些单元之间的边界。与强制严格整合的连续方法不同，DG方法允许相邻单元中的多项式近似在界面上不一致。这在解的值上产生了一个“跳跃”。我们所使用的函数集合，在每个单元内部是多项式，但可以跨越边界跳跃，这些函数据说存在于一个**[破碎函数空间](@entry_id:746988)**中[@problem_id:3378054]。

我们为什么要接纳这种看似混乱的状态？答案是灵活性。巨大的、实用的灵活性。

因为我们摆脱了整合的束缚，现在我们可以在不同区域使用不同大小的单元，这种技术称为**$h$-自适应**。如果[流体流动](@entry_id:201019)在我们的域的一个小角落里有一个复杂的涡流，我们可以在那里使用非常小的单元来捕捉细节，而在其他均匀流动的区域使用大的、粗糙的单元。更妙的是，DG自然地处理了一个大单元与几个小单元相邻的情况，这会产生所谓的**[悬挂节点](@entry_id:149024)**。对于连续方法来说，这些[悬挂节点](@entry_id:149024)是一场噩梦，需要复杂的约束来将解重新粘合在一起。而对于DG来说，这根本不是问题；跳跃就是跳跃，无论邻居的大小是否相同[@problem-id:3328245]。

这种自由也延伸到了我们构建块的复杂性上。我们可以在某些区域使用简单的低次多项式，而在其他区域使用复杂的高次多项式，以在最重要的地方获得精度。这被称为**$p$-自适应**。两者的结合，即**$hp$-自适应**，为我们提供了一个强大的工具包，可以根据我们试图解决的问题的特征精确地定制我们的近似[@problem_id:3379066]。

但这种自由是有代价的。最初的物理定律，即[偏微分方程](@entry_id:141332)（PDE），描述了宇宙是如何连接的。它告诉我们，一个点的温度与其邻近点的温度相关。如果我们的数值构建块都是断开的，它们怎么可能遵守一个完全关乎连通性的定律呢？单元之间如何进行交流？

### 交流的艺术：[数值通量](@entry_id:752791)

在DG世界里，交流的关键在于一个优美的概念，叫做**[数值通量](@entry_id:752791)**。要理解它，让我们思考一下像热方程或守恒律这样的PDE在物理上代表了什么。它通常是一个衡算原则，一个平衡的陈述。对于任何一个小体积（我们的单元），其内部某个量（如热量或动量）的变化率等于流过其边界的总量。这种跨越边界的流动被称为**通量**。

当我们为一个单元内的多项式近似写下这个平衡定律时，一个称为分部积分的数学过程会自然地将一个涉及单元内部导数的项转化为一个涉及单元边界面上通量的项[@problem_id:3425401]。这就是我们面临难题的地方。在两个单元之间的界面上，我们的间断近似有两个不同的值，一个来自左边，一个来自右边。物理通量取决于解的值，那么我们应该使用这两个值中的哪一个呢？

DG的优雅答案是：我们创造一个规则。我们定义一个特殊的配方，即**数值通量**，它接收来自左侧的状态（$u^-$）和来自右侧的状态（$u^+$），并将它们组合起来，为介导它们之间交换的通量产生一个单一、明确的值。这个数值通量就是通信协议，是让那些孤立的、不连续的单元能够相互对话，并共同近似一个连续物理世界行为的通用翻译器[@problem_id:2679430]。

最简单的DG方法，使用分片常数近似（$p=0$），提供了一个极好的洞见。在这种情况下，DG公式完全简化为众所周知的**有限体积法（FVM）**，其中[数值通量](@entry_id:752791)是一个熟悉的概念，用于计算单元之间的流动[@problem_id:2386826]。因此，DG可以被看作是FVM的高阶推广，它将通量交换的核心思想扩展到更复杂的、基于多项式的近似。

### 双通量记：稳定性与耗散的无形之手

这个数值通量不是一个随意的规则；它是方法的核心，其设计是一门精巧的艺术。一个好的[数值通量](@entry_id:752791)必须满足两个关键属性。

首先，它必须是**相容的**。这是一个简单的合理性检查：如果碰巧解在界面处没有跳跃（$u^-=u^+$），那么我们的[数值通量](@entry_id:752791)必须退化为真实的物理通量[@problem_id:3373459]。

其次，也是更深刻的一点，通量必须确保**稳定性**。让我们考虑一个从左向右传播的简单波。我们应该使用什么样的通量？一个看似公平的选择是**[中心通量](@entry_id:747204)**，它简单地平均了左侧和右侧的物理通量。事实证明，这是一个糟糕的想法。[中心通量](@entry_id:747204)导致了一个完全[能量守恒](@entry_id:140514)的格式。虽然这听起来不错，但它意味着任何小的数值误差，任何微小的摆动或[振荡](@entry_id:267781)，都无法被阻尼掉。它将永远存在，在域中四处反弹，污染整个解。模拟是不稳定的。

现在考虑一个更聪明的选择：**[迎风通量](@entry_id:143931)**。这个规则观察波的移动方向，并简单地选择来自“[迎风](@entry_id:756372)”一侧的值。对于从左向右移动的波，它只使用来自左侧的值，$u^-$。事实证明，这个选择是神奇的。通过引入轻微的偏向，它就像一点点数值“摩擦”或**耗散**。这种耗散正是杀死非物理、高频摆动所需要的。能量分析表明，[迎风通量](@entry_id:143931)保证了数值解的总能量永远不会增长；它只能保持不变或减少[@problem_id:3373459]。这是一个稳定方法的标志。

这个原则是普适的。对于像结构力学这样的[椭圆问题](@entry_id:146817)，稳定性是通过一个“惩罚”通量来实现的，该通量惩罚跳跃，实际上就像一个硬弹簧，将不连续的解拉到一起[@problem_id:2679430]。对于像波传播这样的双曲问题，稳定性是通过像[迎风通量](@entry_id:143931)或**Lax-Friedrichs通量**这样的耗散通量来实现的，它们在需要的地方，即界面处，添加了精确控制量的耗散[@problem_id:3373459]。DG框架的美妙之处在于，这个关键的稳定性机制完全是局部的，包含在每个界面处[数值通量](@entry_id:752791)的设计之中。

### 回报：为何需要这台精美而复杂的机器？

这个由破碎空间和数值通量构成的框架可能看起来抽象而复杂。为什么要费这么多功夫？回报是巨大的，使DG成为现代计算科学与工程中最强大和最流行的方法之一。

-   **超凡的精度：** 对于具有光滑解的问题，DG方法可以达到非常高的[精度阶](@entry_id:145189)。通过简单地增加每个单元内的多项式次数$p$，我们可以使误差以惊人的速度减小。对于固定数量的单元，对于非常光滑（解析）的解，误差可以随$p$呈指数级下降[@problem_id:3406735]。这通常意味着我们可以用比低阶方法少得多的自由度获得一个高精度的答案，从而节省巨大的计算成本。当然，这种能力也是有代价的：更高阶的方法需要更小的时间步长来保持稳定，这一约束由[Courant-Friedrichs-Lewy (CFL) 条件](@entry_id:747986)描述，对于DG，它同时依赖于单元大小$h$和多项式次数$p$（通常为 $\Delta t \propto \frac{h}{p^2}$）[@problem_id:3374444]。

-   **几何灵活性和并行性：** 正如我们所见，DG对间断的容忍使其成为处理具有[非协调网格](@entry_id:752550)的复杂几何的理想选择[@problem_id:3328245]。同样的局部性对于并行计算来说也是一个巨大的优势。当一个问题被分配到数千个计算机处理器上时，唯一需要的通信是在分区边界交换通量数据。需要发送的数据量与[子域](@entry_id:155812)的表面积成正比，而不是其体积。对于使用$p$次多项式的3D模拟，每个共享面上的通信量按$(p+1)^2$比例缩放，而单元内部的计算工作量则按$(p+1)^3$比例缩放。这种有利的[表面积与体积之比](@entry_id:140511)意味着DG方法在最大的超级计算机上具有出色的[可扩展性](@entry_id:636611)[@problem_id:3401265]。

-   **激波和间断的王者：** DG最大的成就或许是在模拟带有尖锐移动锋面的问题，例如[超音速喷气机](@entry_id:165155)尾气中的激波。全局近似方法在遇到间断时倾向于“振铃”，将虚假的[振荡](@entry_id:267781)（[吉布斯现象](@entry_id:138701)）[扩散](@entry_id:141445)到整个域。DG的局部性，结合其固有的耗散数值通量，将这种现象控制在局部。间断被清晰地捕捉为跨越单元界面的尖锐但稳定的跳跃，而不会污染流动的光滑部分[@problem_id:3417204]。现代DG方法变得更加智能，采用了**问题单元指示器**，其作用类似于局部传感器。这些指示器通过例如测量[多项式系数](@entry_id:262287)衰减的速度来检测激波的存在。在被标记为“有问题”的单元中，该方法可以自动应用更鲁棒的、起稳定作用的限制器。在“良好”的单元中，它继续发挥其全部高阶能力。这使得该方法既能做到如剃刀般锋利，又能如磐石般稳固，根据解的性质动态地调整其特性[@problem-id:3425717]。

从一个简单、反直觉的想法——间断的自由——中，涌现出一个丰富而强大的框架。通过发明一种巧妙的通信协议——数值通量——并以对稳定性和耗散的深刻理解来设计它，我们创造了一台具有卓越灵活性、准确性和鲁棒性的机器。这就是间断[Galerkin方法](@entry_id:260906)的故事：一段从局部混乱到全局和谐的旅程。

