## 引言
我们如何在分子中定义原子？这个化学中的基本问题带来了一个重大挑战，因为分子并非以离散的球棍模型存在，而是以一团无缝的电子密度云形式存在。要将部分电荷等性质赋予单个原子，我们需要在自然界未提供任何边界的地方划定界限。在哪里划定这些界限并非一个发现问题，而是一个发明问题——即创造一个其价值在于预测能力和化学直觉的模型。本文深入探讨了解决这一难题的最优雅、最稳健的方案之一：[Hirshfeld分析](@article_id:365072)。

我们将在“原理与机制”一章中探索这种“股东原则”的理论基础，理解它如何克服早期方法的缺陷并如何加以改进以提高准确性。随后，在“应用与跨学科联系”一章中，我们将看到这一强大概念如何应用于预测化学反应性、定义原子性质，并为[材料科学](@article_id:312640)和生物化学领域的高级物理模型奠定基础。

## 原理与机制

我们如何谈论分子内部的原子？这似乎是一个简单的问题，但它却是化学中最令人愉悦的棘手难题之一。分子不是由微小、坚硬的球体通过棍棒连接而成的集合。它是一个模糊、充满活力的实体，一个统一的电子密度“云”，原子核嵌于其中。当我们试图将[部分电荷](@article_id:346450)等性质分配给单个原子时，我们实际上是在这片无缝的云中划定一个边界。但具体在哪里划线呢？自然界没有提供任何路标。

答案是，没有唯一“正确”的方法。[部分原子电荷](@article_id:335800)不像质量或温度那样是可直接测量的物理量。它是一个*模型*——一个我们为了理解和预测化学行为而发明的概念。任何模型的价值都在于其一致性、直观性和预测能力。这正是Hirshfeld方法的天才之处：它为“分子中的原子”提供了一个定义，不仅在数学上优雅，而且非常稳健且具有物理意义。

### 一个有缺陷的记账教训

要欣赏Hirshfeld思想的优雅之处，首先看看一个揭示了劣质定义缺陷的更古老、更简单的方法会很有帮助。几十年来，一种常见的方法是**[Mulliken布居分析](@article_id:343952)**。本质上，Mulliken分析不是基于电子云本身，而是基于用于构建它的数学函数——**原子轨道**——来划分电子云。可以这样想：你不是根据土地本身的勘测来划分一块土地，而是根据那些重叠且有时令人困惑的地契来划分。

该方案最明显的缺陷在于它处理“重叠”区域的方式，即来自两个不同原子的基函数同时存在的区域。Mulliken的简单规则是将这个重叠区域的电子布居在两个原子之间精确地对半分配。这就像是说，任何共同拥有的资产都应平分，而不管谁的贡献更大或谁实际在使用它。[@problem_id:1382569]

这条武断的规则可能导致荒谬的结果。在现代[量子化学](@article_id:300637)中，我们使用庞大而灵活的数学函数集（[基组](@article_id:320713)）来获得对电子云的精确描述。有时，一个中心在原子A上的非常弥散的函数，对于描述物理上位于原子B附近的电子密度来说，在变分上是最优的。Mulliken方案对物理空间视而不见，只看到与原子A相关的“地契”，便尽职地将该密度的一半分配回A，即使该密度“居住”在B处。这可能导致[电荷](@article_id:339187)变得毫无意义，极度依赖所选的[基组](@article_id:320713)，有时甚至会导致某个原子上的电子布居数为负，这在物理上是不可能的。[@problem_id:2936185] [@problem_id:2921449] 这是一个典型的简单记账规则对于复杂现实过于天真的案例，也因此推动了人们去寻找更好的方法。

### 股东原则：更公平地分享电子云

这时，Fred Hirshfeld带着一个极具直觉性的想法登场了，这个想法并非源于抽象数学，而是借鉴了经济学：**股东原则**。

想象一下分子的电子密度$\rho(\mathbf{r})$是公司在空间每一点上的总利润。原子们就是股东。在某个位置的利润应该如何分配呢？Hirshfeld提出，应该按照每个股东在该位置的初始投资比例来分配。

原子的“初始投资”是什么？是它自身的、孤立的电子密度——即如果它是一个自由、中性原子时所拥有的电子云。我们称之为**前原子密度**，$\rho_A^0(\mathbf{r})$。

因此，在分子中的任何一点$\mathbf{r}$，我们观察每个前原子在该精确位置对密度的贡献是多少。分配给原子$A$的*实际*分子密度$\rho(\mathbf{r})$的份额，就是它在这一“前分子”参考密度中所占的份额。这为每个原子$A$定义了一个优美、平滑的权重函数：

$$
w_A(\mathbf{r}) = \frac{\rho_A^0(\mathbf{r})}{\sum_B \rho_B^0(\mathbf{r})}
$$

在这里，分子是原子$A$在点$\mathbf{r}$的“投资”，分母是所有原子($B$)在同一点的总投资。分配给原子$A$的电子布居数就是真实分子密度$\rho(\mathbf{r})$乘以该[权重函数](@article_id:355029)在全空间的积分。

这个定义因其内在属性而强大。根据其构造，所有原子在空间每一点的权重之和恰好为1：$\sum_A w_A(\mathbf{r}) = 1$。这保证了电子云的每一点都被计算在内。总[电荷](@article_id:339187)完全守恒，这是并非所有划分方案都能夸耀的特性。[@problem_id:2770785]

最重要的是，Hirshfeld划分作用于真实的物理电子密度$\rho(\mathbf{r})$。随着我们改进计算方法，计算出的密度越来越接近真实密度，Hirshfeld[电荷](@article_id:339187)会收敛到一个稳定、明确的值。它们在很大程度上对严重困扰Mulliken方法的[基组](@article_id:320713)任意选择不敏感。[@problem_id:2936307] 这种稳健性使Hirshfeld成为比较不同分子或不同环境中电荷分布的可靠工具，例如在生物化学的复杂QM/MM模拟世界中或涉及晶体的[材料科学](@article_id:312640)计算中。[@problem_id:2664150] [@problem_id:2475318]

### 模型与现实：[电荷](@article_id:339187)与氧化态

至关重要的是要理解这些计算出的Hirshfeld[电荷](@article_id:339187)代表什么。它们是实数值，如$-0.43$或$+0.81$，反映了电子云连续而模糊的性质。它们不应与化学家在入门课程中学到的整数**[氧化态](@article_id:309375)**（如$-1$或$+2$）相混淆。

氧化态是另一种模型——一种形式化的记账系统。它假定对于每个[化学键](@article_id:305517)，所有的成键电子都完全给予电负性更强的原子。它是一种“赢家通吃”的、基于整数的模型。[Hirshfeld分析](@article_id:365072)以及其他实空间方法，如**Bader的分子中原子量子理论（QTAIM）**——该理论将原子定义为电子密度景观中的“分水岭”——提供了对电子被共享而非简单得失的现实更为细致的看法。[@problem_id:2954866] 这些方法提供了对[电荷](@article_id:339187)极化的连续度量，这与[氧化态](@article_id:309375)的离散模型是一个根本不同的概念。

### 从中性到自洽：迭代改进

尽管原始的Hirshfeld方案十分优雅，但它包含了一个任意性因素：参考态的选择。它假设“初始投资”来自**中性**的前原子。这是一个合理的起点，但对于像氟化锂（LiF）这样的分子呢？我们知道这个[化学键](@article_id:305517)是极强的[极性键](@article_id:305845)；锂几乎是$\text{Li}^+$，氟几乎是$\text{F}^-$。基于中性的Li和F原子作为参考来判断它们在最终电子密度中的份额真的公平吗？这感觉就像根据几十年前的种子资金来评估一家公司，而忽略了它当下的现实。[@problem_id:2770796]

这就是**迭代Hirshfeld**方法（或**Hirshfeld-I**）背后的动机。这是一个简单而巧妙的改进，将分析过程变成了一个自我修正的反馈循环。

1.  从中性前原子开始，计算第一组Hirshfeld[电荷](@article_id:339187)，比如说Li为$+0.8$，F为$-0.8$。
2.  这些结果告诉我们，我们最初的中性参考是错误的。在第二步中，我们使用一个好得多的参考：一个$\text{Li}^{+0.8}$离子和一个$\text{F}^{-0.8}$离子的前原子密度。
3.  我们用这个新的、更现实的参考重新计算Hirshfeld[电荷](@article_id:339187)。结果可能略有不同，比如说$+0.85$和$-0.85$。
4.  我们重复这个过程——将一步的输出[电荷](@article_id:339187)作为下一步的输入参考——直到[电荷](@article_id:339187)不再变化。系统达到了**自洽**。

这个迭代过程消除了该方法中主要的任意选择。它找到了与最终划分最一致的参考态。由此产生的Hirshfeld-I[电荷](@article_id:339187)的[绝对值](@article_id:308102)通常比标准Hirshfeld[电荷](@article_id:339187)更大，并且往往能为极性分子中的[电荷分布](@article_id:304828)提供更符合化学直觉的图像。[@problem_id:2770796] [@problem_id:2954866]

### 连锁效应：为何更好的定义能构建更好的物理学

人们可能会问：这种数学上的改进真的重要吗？这只是追逐小数点后几位的游戏吗？答案是响亮的*是的，它很重要*，其原因揭示了物理学相互关联的美。一个关于原子[电荷](@article_id:339187)的更好定义，会导向一个关于物理世界的更好模型。

一个绝佳的例子来自于计算那些维系分子在一起的、微妙却普遍存在的作用力：**伦敦色散力**。这些力的强度部分取决于每个原子的**极化率**——即其电子云被扭曲的难易程度。而[极化率](@article_id:303946)又取决于该原子在分子中的有效大小或体积。

现在我们看到了这其中的联系链条。Hirshfeld划分方案为我们提供了一种定义[原子体积](@article_id:363049)的方法。更准确的Hirshfeld-I方法正确地捕捉到，在[极性键](@article_id:305845)中，获得电子的原子（阴离子）变得更大、更易极化，而失去电子的原子（阳离子）变得更小、更不易极化。标准的Hirshfeld方案由于低估了[电荷转移](@article_id:310792)，因而错误地计算了这些体积变化，从而也错误地计算了[极化率](@article_id:303946)。

当这些来自Hirshfeld-I的更准确的[原子极化率](@article_id:322030)被输入到现代[色散](@article_id:376945)理论中，如Tkatchenko-Scheffler（TS）模型，其结果便是对分子间[相互作用能](@article_id:328040)的更准确预测。[@problem_id:2768862] 一个看似抽象的、关于如何划分电子云的改进，通过理论产生连锁效应，让我们能够更好地把握那些控制液体沸腾和蛋白质折叠的实在作用力。这是科学中一个好想法的终极考验：它不仅整理了我们的概念，还让我们对现实的洞察更加敏锐。