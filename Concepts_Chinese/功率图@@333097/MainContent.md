## 引言
“哪个最近？”这个简单的问题催生了几何学中最优美的结构之一：Voronoi 图，它是一种根据邻近性来划分空间的镶嵌图形。然而，这个模型假设所有感兴趣的点都是平等的。当它们不平等时会发生什么呢？本文通过探索功率图来解决这一局限性。功率图是一种深刻的推广，它包含了每个点的“权重”或“影响力”。通过从简单的距离转向更复杂的度量，功率图为无数现实世界场景提供了更符合实际的模型。在接下来的章节中，我们将首先阐明“原理与机制”，追溯从 Voronoi 图的[最近邻规则](@article_id:638186)到功率图的加权影响力的演变。随后，“应用与跨学科联系”一节将展示这一个几何思想如何提供一种统一的语言，用以描述从固态物理学到[量子化学](@article_id:300637)等不同领域的结构。

## 原理与机制

想象一下，你正站在一座城市里，想要找到最近的图书馆。这是一个简单的问题，但如果你要为城市[地图着色](@article_id:339064)，将每个点都涂上其最近图书馆的颜色，你将创造出一个既美观又具有深厚数学意义的对象。这种基于“哪个最近”来划分空间的简单想法，是通往一个迷人的几何结构世界的大门，而我们即将探索这个世界。我们将从最简单的规则开始，通过提出“如果……会怎样？”的问题，揭示出一些令人惊讶且优美的推广，这些推广在从[材料设计](@article_id:320854)到复杂网络分析等领域都有着深远的应用。

### 领地游戏：[最近邻规则](@article_id:638186)

让我们将图书馆问题形式化。假设我们有一组特殊的点，我们称之为**站点**，散布在一个平面上。这些点可以是我们的图书馆、手机信号塔，甚至是晶体中的原子位置。对于平面上的任何一个位置，我们可以问：它离哪个站点最近？

所有比其他任何站点更接近某个特定站点（比如站点 $A$）的点集合，构成了站点 $A$ 的“领地”。这个领地被称为 $A$ 的 **Voronoi [晶胞](@article_id:303922)**。如果你对每个站点都这样做，你就会将整个平面划分成由这些晶胞组成的镶嵌图案。这个美丽的镶嵌图案就是 **Voronoi 图**。[@problem_id:2540771]

这些领地的边界是什么样的呢？只考虑两个站点，$A$ 和 $B$。与 $A$ 和 $B$ [等距](@article_id:311298)的所有点的集合构成一条直线——连接它们的线段的[垂直平分线](@article_id:342571)。由于 Voronoi 晶胞的边界是由与两个（或更多）站点[等距](@article_id:311298)这一条件定义的，因此 Voronoi 图的边都是直线段。每个[晶胞](@article_id:303922)都是一个[凸多边形](@article_id:344371)，一个由其中心站点统治的王国。

这个原理无处不在。它描述了晶体的生长模式、动物的领地以及相互竞争的商店的市场区域。这是大自然根据邻近性划分空间的方式。

### 镜中世界：对偶性与空圆

现在，让我们看看我们的 Voronoi [晶胞](@article_id:303922)地图，并提出一个不同的问题。哪些站点是“邻居”？一个自然的定义是，如果两个站点的 Voronoi 晶胞共享一条公共边界，那么它们就是邻居。如果我们画一条线连接每一对相邻的站点，一幅新的图景就会从旧图景中浮现出来。我们会得到一个覆盖我们站点的三角形网络。这个新的网络就是 **[Delaunay 三角剖分](@article_id:329901)**。

这种关系是**[几何对偶](@article_id:383057)性**的一个经典例子。它就像从两个完全互补的角度看同一个物体。一个图的特征与另一个图的特征直接对应[@problem_id:2540771]：

- 每个**站点**（[Delaunay 三角剖分](@article_id:329901)中的一个顶点）对应 Voronoi 图中的一个**[晶胞](@article_id:303922)**。

- [Delaunay 三角剖分](@article_id:329901)中连接两个站点的每条**边**对应它们在 Voronoi 图中共享的**边**。事实上，Delaunay 边与 Voronoi 边完全垂直。

- [Delaunay 三角剖分](@article_id:329901)中的每个**三角形**对应 Voronoi 图中的一个**顶点**——即三个对应晶胞相交的点。

有一个隐藏的规则支配着哪些三角形可以在 [Delaunay 三角剖分](@article_id:329901)中出现，这被称为**空圆特性**。如果你画一个穿过任何 Delaunay 三角形三个顶点的圆，该圆的内部将不包含任何其他站点。这个“空圆”的圆心恰好位于对应的 Voronoi 顶点，即三个领地交汇之处。这个优雅的特性不仅仅是一种奇特的现象；它也是 [Delaunay 三角剖分](@article_id:329901)在为模拟创建高质量网格时如此有用的原因，因为它们倾向于避免又长又细的三角形。

### 改变规则：当尺寸很重要时

我们简单的模型假设所有站点都是生而平等的。但如果它们不是呢？如果一个图书馆是巨大的多层国家档案馆，而另一个是小型的移动图书车呢？简单的“最近距离”规则似乎无法捕捉它们影响力的差异。我们需要一种新的衡量“吸引力”的方法，以解释站点的内在“能力”或“大小”。

让我们将站点从无量纲的点升级为圆，每个圆都有一个中心 $\mathbf{c}_i$ 和一个半径 $r_i$ [@problem_id:2383833]。半径可以代表站点的大小、影响力或其他一些内在权重。现在，我们如何定义任意点 $\mathbf{x}$ 到这些圆站点之一的“距离”？

我们引入一种新的度量，称为**功率距离**。对于一个点 $\mathbf{x}$ 和一个站点 $i$（一个中心为 $\mathbf{c}_i$、半径为 $r_i$ 的圆），功率距离定义为：

$$
\pi_i(\mathbf{x}) = \lVert \mathbf{x} - \mathbf{c}_i \rVert^2 - r_i^2
$$

这看起来可能有点抽象，但它有一个优美的几何意义。如果点 $\mathbf{x}$ 在圆外，$\pi_i(\mathbf{x})$ 是正的，并且恰好是从 $\mathbf{x}$ 到该[圆的切线](@article_id:352466)长度的平方。如果 $\mathbf{x}$ 在圆上，功率为零。如果 $\mathbf{x}$ 在圆内，功率为负。所以，这并不是通常意义上的距离（它可以是负数！），但它是一个极好的衡量点与圆关系的度量。我们可以将项 $w_i = r_i^2$ 视为站点的**权重**。

### 功率图：一种新的影响力地图

有了我们的新规则——功率距离——我们可以再次玩同样的领地游戏。对于任何点 $\mathbf{x}$，我们找到与它有*最小功率距离*的站点。对站点 $i$ “忠诚”的点的区域就是它的功率晶胞。所有这些[晶胞](@article_id:303922)的集合就是**功率图**。

第一个美妙的惊喜来了。这些新的功率[晶胞](@article_id:303922)之间的边界是什么样子的？让我们找到与两个站点 $i$ 和 $j$ 具有相等功率距离的点集 $\mathbf{x}$：

$$
\pi_i(\mathbf{x}) = \pi_j(\mathbf{x})
$$

$$
\lVert \mathbf{x} - \mathbf{c}_i \rVert^2 - r_i^2 = \lVert \mathbf{x} - \mathbf{c}_j \rVert^2 - r_j^2
$$

如果我们展开平方范数项（例如，$\lVert \mathbf{x} - \mathbf{c}_i \rVert^2 = (\mathbf{x} - \mathbf{c}_i) \cdot (\mathbf{x} - \mathbf{c}_i) = \lVert \mathbf{x} \rVert^2 - 2 \mathbf{x} \cdot \mathbf{c}_i + \lVert \mathbf{c}_i \rVert^2$），你会注意到方程两边的 $\lVert \mathbf{x} \rVert^2$ 项相互抵消了。剩下的是一个关于 $\mathbf{x}$ 坐标的线性方程。这意味着边界仍然是一条直线！这是非同寻常的。通过仔细选择我们的“距离”函数，我们已经将问题推广到包含加权站点，同时保留了边界简单的线性性质。

和以前一样，这个功率图也有一个对偶。如果我们连接所有功率[晶胞](@article_id:303922)共享边界的站点的中心，我们会得到一个称为**正规[三角剖分](@article_id:335950)**或加权 [Delaunay 三角剖分](@article_id:329901)的[三角剖分](@article_id:335950)[@problem_id:2540786]。“空圆”特性也得到了推广。一个由站点 $(i, j, k)$ 构成的三角形存在于正规[三角剖分](@article_id:335950)中，当且仅当存在一个特殊的圆，它与这三个站点圆都成直角（正交）相交，并且没有其他站点到这个[正交圆](@article_id:354568)中心的功率距离更小[@problem_id:2383833]。

### 机器中的幽灵：隐藏站点与功率的几何学

这个新的功率游戏有一个在简单的 Voronoi 世界中不可能出现的奇怪而迷人的转折。在常规的 Voronoi 图中，每个站点都保证拥有*一些*领地，无论它被邻居包围得多么紧密。但在功率图中，情况并非如此。一个站点可以有一个空的晶胞——它可以拥有零领地！[@problem_id:2540786]

想象一个小的圆（一个低权重站点）被更大、更有影响力的圆包围。它的影响力可能完全被邻居所掩盖，以至于平面上没有任何一个点是它最“强大”的。它的功率晶胞是一个[空集](@article_id:325657)。这样的站点被称为**隐藏站点**。它存在，但没有自己的王国。这是改变我们距离规则的一个深远后果；它引入了一个竞争方面，一些站点可能被完全排挤出去。

我们如何能确定这一切？我们如何能将这种权重和距离之间复杂的相互作用可视化？有一个惊人优雅的技巧，一个经典的数学洞察。我们可以通过将问题提升到更高维度来理解这一切。想象我们的二维平面是一个三维房间的地板。我们可以将每个站点的中心 $\mathbf{c}_i$ 提升到三维空间中的一个点，其坐标为 $(\mathbf{c}_i, \lVert \mathbf{c}_i \rVert^2 - w_i)$。每个提升点的高度取决于它的位置和权重。

现在，想象在所有这些提升点下方拉伸一张橡胶薄膜。这张橡胶薄膜形成的形状就是这些点的“下[凸包](@article_id:326572)”。如果你现在从上方俯视，看看橡胶薄膜接触到了哪些提升点，将这些点以及它们之间的连接投影回二维地板上，*正是正规[三角剖分](@article_id:335950)*！[@problem_id:2540786]

这种“提升映射”提供了一个统一的视角。标准的 [Delaunay 三角剖分](@article_id:329901)只是所有权重 $w_i$ 都为零的特殊情况。它为隐藏站点提供了一个优美的直观理解：如果一个站点的提升点不在[凸包](@article_id:326572)的下边界上，而是“漂浮”在内部的某个地方，完全被其更强大的邻居之间伸展的橡胶薄膜从下方屏蔽，那么这个站点就变成了隐藏站点。这个优美的几何构造将一个复杂的代数问题变成了一个简单、可视的问题，揭示了 Voronoi 图及其强大“表亲”世界背后深刻的统一性与优美性。