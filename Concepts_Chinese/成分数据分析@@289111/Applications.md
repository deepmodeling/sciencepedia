## 应用与跨学科联系

现在我们已经掌握了[成分数据](@article_id:313891)的原理，我们可能感觉自己像是刚戴上了一副新眼镜。曾经模糊不清、充满潜在幻象的百分比和比例世界，正开始变得清晰。但是，我们能用这种新的清晰度*做*什么呢？这场对数比之旅将我们引向何方？事实证明，答案是：无处不在。从我们细胞的内部运作到生态系统的宏伟织锦，成分分析的原理不仅是一种学术上的好奇心；它们是现代发现的基本工具包。

让我们想象一下，你正在用一台带自动音量控制的收音机听交响乐。如果铜管乐器组突然演奏一段极强音（fortissimo），收音机的压缩器会调低整体音量以保护你的扬声器。结果，木管乐器组，即使它们的力度根本没有改变，听起来也会更安静。如果你不知道这个自动音量控制功能，你可能会错误地认为木管乐器组决定演奏得更轻柔。这就是成分约束在起作用。收音机固定的“总音量”迫使一部分的变化影响到所有其他部分的感知音量。我们的对数比变换就是让我们能够禁用这个自动压缩器，听到每个声部真实、独立的动态的工具。现在，让我们走进科学的音乐厅，看看我们能听到什么。

### 现代生物学家的工具包：从基因到生态系统

或许，成分思维在任何领域都没有比在生命科学中更具革命性。高通量测序的出现为生物学带来了海量本质上是成分性的数据。我们很少能计算出每一个分子或微生物；相反，我们从一个复杂的混合物中取样，得到一个比例列表。

#### 破译生命蓝图

考虑使用[RNA测序](@article_id:357091)（RNA-seq）分析基因表达。这项技术通过计算信使RNA（mRNA）[转录](@article_id:361745)本的数量，为我们提供了细胞中哪些基因处于活跃状态的快照。一个常见的目标是比较处理组与[对照组](@article_id:367721)，看哪些基因被“上调”或“下调”。天真地，人们可能只是比较每个基因的读数比例。但这是一个陷阱！

想象一个实验，其中一种处理导致一个高表达的基因活性增加了十倍。这个单一基因现在占据了细胞中总mRNA池中更大的份额。当我们对这个池进行测序时，那个基因也将占据我们测序读数的更大份额。因为总比例必须为一，*其他每一个基因*的相对丰度都必须下降，即使它们每个细胞的绝对mRNA分子数量保持不变。一个天真的分析会报告成千上万的基因被下调，这是由那个单一的“优等生”造成的假象。这种成分偏差不是一个小错误；它是测量过程中的一个根本性假象 [@problem_id:2494908]。

这正是我们的新工具展示其威力的地方。通过应用对数比变换，例如中心对数比（CLR），我们重新对数据进行中心化。我们不再在一个变化的尺度上比较处理组中的基因$g$与[对照组](@article_id:367721)中的基因$g$，而是将其与*自身样本内*所有基因的几何平均值进行比较。当我们随后观察处理组和对照组中变换后值的差异时，那个由总mRNA池变化引起的共同偏差项神奇地抵消了。我们得到的是该基因相对于平均趋势的真实变化，这是一个更诚实、更易于解释的度量。

一旦数据进入这个对数比空间，整个[经典统计学](@article_id:311101)的世界就向我们敞开了。我们可以使用像[韦尔奇t检验](@article_id:339355)这样的标准检验来严格评估两组基因——比如说，衰老免疫系统中的幼稚[T细胞](@article_id:360929)与[记忆T细胞](@article_id:314280)——的比率变化是否具有[统计显著性](@article_id:307969) [@problem_id:2268251]。我们可以为差异丰度分析构建完整、稳健的流程：添加一个小的伪计数来处理零值，应用CLR或ILR变换，对每个特征运行统计检验，然后对同时[检验数](@article_id:354814)千个假设进行校正。这个有原则的工作流程现在是该领域的黄金标准 [@problem_id:2371664]。

#### 体内交响曲：[微生物组](@article_id:299355)

如果说单个细胞是一个交响乐团，那么人类[肠道微生物组](@article_id:305880)就是一个繁华的都市，充满了成千上万种细菌、[古菌](@article_id:308120)和真菌。当我们通过测序研究[微生物组](@article_id:299355)时，我们再次面临着最高阶的[成分数据](@article_id:313891)。我们不知道细菌的绝对数量，只知道它们DNA在我们样本中的相对比例。

假设我们想找到特定微生物与某种疾病之间的联系。一种常见但有缺陷的方法是简单地将该微生物的相对丰度与疾病进行相关性分析。但这注定会失败。正如我们所见，常数和约束将数据的协方差结构束缚在紧身衣中。在任何成分中，一个组分与所有其他组分（包括其自身）的[协方差](@article_id:312296)之和必须为零 [@problem_id:2507239]。这意味着，即使所有微生物都完全独立生活，闭合操作也会诱导出一张伪负相关的网络。

要解开这张网，我们必须再次求助于对数比。通过使用等距对数比（ILR）变换对数据进行转换，我们可以从我们的$D$个分类单元中创建一组$D-1$个新的变量，或称“平衡”。这些平衡在数学上是独立的（正交的），并且存在于一个标准的、无约束的[欧几里得空间](@article_id:298501)中。它们是下游统计模型的完美输入，使我们能够正确地检验微生物特征与宿主特征（如GWAS类研究中的遗传变异）之间的关联，而不会陷入[共线性](@article_id:323008)或[伪相关](@article_id:305673)的陷阱 [@problem_id:2394705]。

这个框架延伸到[微生物生态学](@article_id:323869)中最令人兴奋的目标之一：推断微生物的“社交网络”。谁与谁合作？谁与谁竞争？简单地将丰度相关联是具有误导性的。现代方法是估计*条件*依赖网络。问题不是“当Faecalibacterium减少时，Bacteroides是否增加？”而是“当*所有其他微生物保持不变时*，Faecalibacterium减少，Bacteroides是否增加？”这个问题由**[逆协方差矩阵](@article_id:298898)**或[精度矩阵](@article_id:328188)来回答。

这个流程既优雅又强大：使用CLR转换[成分数据](@article_id:313891)，估计协方差矩阵（使用某种形式的[正则化](@article_id:300216)来处理高维性和固有的奇异性），然后将其求逆得到[精度矩阵](@article_id:328188)。该矩阵中的非零项揭示了我们[生态网络](@article_id:370901)中的边，即合作或竞争的直接联系 [@problem_id:2479901] [@problem_id:2507239]。这种方法是先进机器学习流程的核心，这些流程可以根据一个人的微生物组预测疾病状态，前提是所有步骤，包括对数比变换，都在[交叉验证](@article_id:323045)框架内正确执行，以防止[信息泄露](@article_id:315895) [@problem_id:2806578]。在这些复杂的分析中，我们绝不能忘记大规模实验的现实问题，例如[批次效应](@article_id:329563)。幸运的是，成分思维在这里也提供了一条清晰的路径：我们对对数比变换后的数据进行[批次校正](@article_id:323941)，仔细保留感兴趣的生物信号，同时去除技术噪声 [@problem_id:2374374]。

#### 进化与生态的宏大剧目

成分分析的效用远远超出了微观世界。考虑一个生态学家研究一种捕食三种猎物的捕食者。捕食者的饮食是一种成分。为了解捕食者是否会“转换”以偏爱更丰富的猎物——一种关键的生态行为——人们可能会试图将饮食中猎物的比例与环境中其比例联系起来。同样，这因成分约束而变得复杂。但通过对饮食和环境成分都应用ILR变换，一个优美简单的线性关系浮现出来，其斜率直接揭示了捕食者的转换行为 [@problem_id:2525236]。

同样的逻辑也适用于进化生物学。想象一下，我们正在比较不同哺乳动物物种乳汁中[脂肪酸](@article_id:305838)的组成，以了解其进化。乳汁组成是一个性状，但物种本身并非独立的数据点——它们通过[系统发育树](@article_id:300949)相关联。要进行[系统发育](@article_id:298241)比较分析，我们必须同时考虑这两种非独立性的来源。解决方案是顺序性的：首先，我们使用对数比变换（如ILR）将成分性的乳汁[数据转换](@article_id:349465)为一组无约束的实值性状。*然后*，在这些表现良好的新变量上，我们可以应用像[系统发育独立比较](@article_id:353066)法（PICs）这样的标准系统发育工具来研究它们在[生命之树](@article_id:300140)上的进化 [@problem_id:1761321]。

### 在工程与科学中解混信号

成分思维的力量并不仅限于生物学。从本质上讲，它是一种理解混合物的工具。考虑一个合成生物学问题，我们使用[CRISPR](@article_id:304245)[基因组编辑](@article_id:314217)来修饰一个细胞。编辑过程可能导致几种不同的结果：[期望](@article_id:311378)的精确编辑（HDR），或各种类型的错误（[插入缺失](@article_id:360526)、删除）。测序实验的原始输出是这些结果中每一种的计数向量——一个成分。

我们可能对不同潜在[DNA修复途径](@article_id:315388)（c-NHEJ、MMEJ等）的“纯”结果分布有很好的模型。那么问题就变成了：是这些途径的何种混合产生了我们观察到的最终结果成分？这是一个“[解卷积](@article_id:300181)”或“解混”问题。通过将其构建为估计混合权重的问题——这些权重应用于纯途径特征时能最好地解释观察到的结果成分——我们可以使用[最大似然](@article_id:306568)法来推断细胞基本修复机制的活性 [@problem_id:2743174]。同样的原理也可以应用于解混地质沉积物成分、[化学反应](@article_id:307389)产物，或任何我们观察到的数据是明确定义来源的混合物的其他现象。

### 一种稳健科学的哲学

最后，理解[成分数据分析](@article_id:313110)将我们提升到了一个更高的科学实践水平。在任何复杂的分析中，都有几十个选择要做：使用哪个伪计数，哪个对数比变换，调整哪些协变量。这个“分叉路径的花园”可能导致不同的研究人员从相同的数据中得出不同的结论。

我们如何能确定一个发现是真实的，而不仅仅是某个特定分析流程的产物？最稳健的方法是进行“多重宇宙分析”。我们必须首先预先注册我们的假设和成功标准。然后，我们故意使用各种科学上合理的流程重新分析数据——不同的去噪方法，不同的成分变换，不同的统计模型。如果某个发现，比如说微生物与疾病之间的关联，在这些绝大多数不同的分析世界中，其方向和显著性都保持一致，那么我们就可以更加自信地认为我们发现了一块真实的现实 [@problem_id:2806576]。

[成分数据分析](@article_id:313110)并不能给我们*那个*唯一的正确答案。相反，它给了我们*一套*我们可以对数据提出的有效问题。它提供了一个有原则的框架，帮助我们区分合理的分析选择和有缺陷的选择。它是一种严谨的哲学，一种驯服复杂性的工具，也是一种确保我们讲述的关于世界的故事尽可能真实的方法。归根结底，它是[科学方法](@article_id:303666)本身这本书中至关重要的一章。