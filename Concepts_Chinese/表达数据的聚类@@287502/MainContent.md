## 引言
在现代生物学中，我们被数据的海洋所淹没，尤其是来自测量成千上万个单细胞中成千上万个基因表达水平的实验。这股信息洪流掌握着细胞身份、疾病进展和发育的秘密，但其原始形式却是一片难以理解的混乱。核心挑战在于，通过识别有意义的模式和隐藏的结构，从这种混乱走向理解。我们如何在这份复杂性中找到秩序，让数据自己讲述它的故事？

本文深入探讨聚类，这是一套强大的计算方法，是驾驭这一高维景观的主要工具。我们将探索这些方法的工作原理，不将它们视为黑箱，而是看作一种可根据特定生物学问题进行调整的探索性显微镜。接下来的章节将引导您完成这一过程。在“原理与机制”中，我们将剖析聚类的核心概念，从定义“相似性”这门至关重要的艺术，到为您的生物学问题选择正确的[算法](@article_id:331821)。然后，在“应用与跨学科联系”中，我们将看到这些原理的实际应用，说明如何使用[聚类](@article_id:330431)来构建全面的[细胞图谱](@article_id:333784)、重建[组织结构](@article_id:306604)，甚至预测未知基因的功能。

## 原理与机制

想象一下，你是一位考古学家，刚刚从一个前所未知的文明中发掘出大量古钱币。成千上万枚钱币混杂在一起。你的首要任务不是破译上面的铭文，而仅仅是为这片混乱带来一些秩序。你会如何开始呢？你可能会根据它们的大小进行分类。或许是根据它们的重量。或是根据它们由什么金属制成——金、银、青铜。又或者，你会根据上面印刻的图像进行分组——统治者的侧面像、神话中的野兽、一艘船。

这些分类策略中的每一种都是一种**[聚类](@article_id:330431)**。你在根据某种“相似性”的定义对物体进行分组。你的发现完全取决于你选择的规则。按金属分类可能会告诉你该文明的经济和贸易情况。按图像分类可能会揭示其政治历史或宗教信仰。没有一种“正确”的分类方法；只有或多或少有见地的方法，这取决于你提出的问题。

在现代生物学中，我们面临着类似的挑战，但其规模之大几乎超乎想象。我们拥有的不是钱币，而是来自成千上万个单细胞、患者或基因的数据。我们测量的也不是大小或金属，而是成千上万个基因的同时活动水平——即“表达”。对这些数据进行聚类的目标与处理钱币时相同：在混乱中寻找有意义的模式，发现支配系统的隐藏组织原则 ([@problem_id:1714816], [@problem_id:1476392])。这是让数据本身告诉我们它希望如何被分组。

### 定义“相似”的艺术

聚类的核心是相似性的概念。但这个在日常语言中如此简单的词，在[数据分析](@article_id:309490)中变得异常复杂和强大。你如何衡量相似性——你的数学“标尺”——是你将做出的最重要的决定，因为它从根本上塑造了你可能发现的东西。

让我们来看一个简单的假设案例，有四个基因，我们在四种不同条件下测量了它们的活性。可以把这些条件想象成“清晨”、“中午”、“傍晚”和“午夜”。

-   基因 $g_1$：活性在一天中稳步上升：$[2, 4, 6, 8]$
-   基因 $g_2$：也稳步上升，但水平高得多：$[10, 12, 14, 16]$
-   基因 $g_3$：在一天中稳步下降：$[8, 6, 4, 2]$
-   基因 $g_4$：也稳步上升，但水平甚至更高：$[20, 22, 24, 26]$

现在，哪些基因“最相似”？答案取决于你的标尺。

一个常见的标尺是**欧几里得距离**。这是你在几何课上学到的直线距离，并延伸到多维空间。它问的是：“这些基因的绝对活性水平相距多远？” 使用这个度量，基因 $g_1$ 实际上比基因 $g_2$ 更接近基因 $g_3$。为什么？因为它们的绝对活性水平（2到8之间的数字）处于相似的范围内。它们生活在同一个数值邻域，尽管它们的行为方式相反。如果你对在相似丰度水平上运作的基因感兴趣，这个标尺很有用。

但如果我们感兴趣的是那些被共同调控、遵循相同脚本的基因，而不管它们表达的“声音”有多大呢？为此，我们需要一个不同的标尺，一个基于**皮尔逊相关性**的标尺。相关性忽略绝对水平，只衡量数据*形状*或*模式*的相似性。它问的是：“这些基因是否一起上升和下降？”

使用相关性，一幅完全不同的图景出现了。基因 $g_1$、基因 $g_2$ 和基因 $g_4$ 都是完全相关的 ($r=1$)。它们的表达向量只是彼此的平移版本。它们唱着同一支曲子，只是音量不同。然而，基因 $g_3$ 与其他基因完全*反相关* ($r=-1$)；它反向唱着这支曲子。因此，基于相关性的[聚类](@article_id:330431)会将 $g_1$、$g_2$ 和 $g_4$ 分组为一个“共调控模块”，并将 $g_3$ 作为行为不同者排除在外。

如你所见，两种不同的标尺导致了两种完全不同但同样有效的分组 ([@problem_id:2406415])。一个讲述了关于绝对丰度的故事；另一个讲述了关于共享调控的故事。没有哪个是普遍“更好”的——正确的选择完全取决于你希望回答的生物学问题。

### 在千维空间中观察

那么，为什么我们需要复杂的计算机[算法](@article_id:331821)来做这件事呢？生物学家不能仅仅通过查看数据就看到模式吗？

问题在于维度的数量实在太多。我们的大脑非常擅长在二维甚至三维空间中发现模式。但是一个现代的单细胞实验可能会为每个细胞测量45种不同的蛋白质标记 ([@problem_id:2247628]) 或20,000个基因的表达。试图在一个20,000维的空间中把握细胞间的关系不仅困难；对于人类心智来说，这根本上是不可能的。

传统的方法，称为“手动圈门”，就像试图仅通过观察复杂雕塑投射在不同墙壁上的影子来理解它。免疫学家可能会查看标记A与标记B的二维散点图，并在他们识别出的一团细胞周围画一个圈。然后他们将这些细胞根据标记C与标记D进行绘图，并画另一个圈。这个过程缓慢、主观，并且极易受到研究者已知和[期望](@article_id:311378)发现的东西的偏见影响。关键是，一个在45维空间中形成清晰云团的细胞群，在研究者选择查看的任何二维“影子”中可能完全不可见。你很容易错过那些你不知道如何去寻找的新型细胞。

这就是**[无监督聚类](@article_id:347668)**[算法](@article_id:331821)大放异彩的地方。它们在完整的高维空间中运作。它们不只是每次看两个基因或标记；它们同时考虑所有基因或标记。[算法](@article_id:331821)“看到”每个细胞与所有其他细胞在所有维度上的距离，识别出我们永远无法凭直觉发现的密集点云。这不仅仅是自动化；它是我们感官的延伸，让我们能够在一个数学上真实但超出我们直接直觉的世界中感知模式。它是一个发现引擎，能够找到意想不到的东西。

### 观星前先擦亮镜头

然而，有一个至关重要的警告。这些强大的[算法](@article_id:331821)也异常敏感。它们会[聚类](@article_id:330431)数据中任何最显著的变异，无论这变异是美丽的生物学现象还是无聊的技术噪音。如果你通过一个肮脏、有污迹的镜头用望远镜观察星星，你将得到一幅美丽而详细的污迹地图，而不是星星的地图。

在基因表达实验中，有两种“污迹”特别常见。第一种是**文库大小**。在[单细胞测序](@article_id:377623)中，一些细胞被捕获和测量的效率就是比其他细胞高。这导致一个细胞可能检测到总共10,000个[转录](@article_id:361745)本分子，而其邻近细胞只有2,000个。如果你将这些原始计数数据输入[聚类算法](@article_id:307138)，它将完全被这种技术差异所主导。[算法](@article_id:331821)会忠实地将所有“高计数”细胞分在一组，将所有“低计数”细胞分在另一组，而不管它们的生物学身份如何。这是毫无意义的。因此，必不可少的第一步是**归一化**，这是一种统计调整，用于校正文库大小的差异，使我们能够在平等的基础上比较细胞的相对基因表达谱 ([@problem_id:2268229])。

第二种污迹是**[批次效应](@article_id:329563)**。生物学实验通常很复杂，并且分阶段进行。也许一组样本是在一月份处理的，而另一组作为重复的样本是在十二月份处理的 ([@problem_id:1530944])。即使有最谨慎的操作流程，微小的差异——一批新的化学试剂、稍微不同的室温、重新校准的测序仪——都可能引入一种系统性的特征，影响一个批次中的所有样本。当你随后分析合并的数据时，最大的变异来源通常是“批次1 vs. 批次2”。[聚类算法](@article_id:307138)会轻易地发现这种模式，完美地根据处理日期将你的样本分开，完全掩盖了你试图研究的微妙生物学效应（例如，药物组 vs. 对照组）。校正这些批次效应是分析工作中至关重要但又棘手的一部分，以确保我们[聚类](@article_id:330431)的是生物学信号，而不是实验噪音。

### 不同问题，不同工具：家族树 vs. 分箱

一旦数据清理完毕，并且你选择了你的标尺，仍然需要决定使用哪种[聚类算法](@article_id:307138)。就像木匠有不止一种锯子一样，[数据分析](@article_id:309490)师也有不止一种聚类工具。其中最常见的两种是K-均值[聚类](@article_id:330431)和[层次聚类](@article_id:640718)，它们体现了两种不同的理念。

**K-均值聚类**就像一个有固定数量箱子的邮件分拣机。你预先告诉[算法](@article_id:331821)，“我想找到 $k$ 个簇”（例如，$k=3$）。然后，[算法](@article_id:331821)会不断移动数据点，直到找到将它们精确划分为 $k$ 组的最佳方式，使得每个组内的项目尽可能相似。当你有一个强烈的假设，认为你的数据属于特定数量的离散类别时，这是一个绝佳的选择，例如，将患者分为几种已知的疾病分子亚型 ([@problem_id:1440822])。

另一方面，**[层次聚类](@article_id:640718)**不需要你指定簇的数量。相反，它构建了一个类似于家谱或**[树状图](@article_id:330496)**的结构。它从每个数据点作为其自身的簇开始，然后迭代地合并最接近的对，接着是合并最接近的新簇，依此类推，直到所有东西都在一个巨大的簇中。最终生成的树显示了所有尺度上的关系。你可以看到哪些微小的簇合并形成更大的簇，以及哪些大的分支长时间保持分离。当底层生物学本身就是分层的时候，这种方法具有独特的强大功能。想象一下追踪[干细胞分化](@article_id:333817)的过程。它们开始时是一个群体，然后做出决定，分化成两个主要谱系之一。其中一个谱系可能随后再次分裂成三个亚型。[层次聚类](@article_id:640718)的[树状图](@article_id:330496)可以完美地反映这种生物学现实，显示出发育过程中嵌套的关系和[分支点](@article_id:345885)，这是K-均值那种扁平、离散的箱子根本无法捕捉的 ([@problem_id:2281844])。

### 知道何时收起箱子

使用任何工具的最高境界是了解其局限性——知道何时*不*使用它。[聚类](@article_id:330431)的整个理念建立在你的数据由离散、可分离的群体组成的假设之上。它想把东西放进箱子里。但如果底层的现实不是一堆箱子，而是一个平滑、连续的斜坡呢？

考虑一个单细胞类型随时间成熟的过程，或者一个祖细胞平滑地转变为单一最终状态的过程。你样本中的细胞并非以“不成熟”和“成熟”两种状态存在，中间没有任何过渡。相反，它们形成了一个连续的状态谱。如果你对这些数据应用[聚类算法](@article_id:307138)，它仍然会给你一个答案。它会在某个地方画一条线，称一边为“簇1”，另一边为“簇2”。但这个边界是完全任意的，就像宣布波长低于520纳米的颜色是“绿色”，而高于520纳米的是“蓝色”，却忽略了它们之间美丽、无缝的过渡。像轮廓系数这样的聚类质量度量会正确地告诉你，你的[聚类](@article_id:330431)效果很差，因为边界上的细胞与邻近簇的距离和与自己簇的距离一样近 ([@problem_id:2371680])。

在这些情况下，生物学问题不是“细胞类型有哪些？”，而是“这个过程的[连续路径](@article_id:366519)是什么？”。将数据强行塞入簇中是错误的模型。相反，我们使用一套不同的工具，专为**[轨迹推断](@article_id:323427)**而设计，旨在将细胞沿着一条连续路径（“[伪时间](@article_id:326072)”）排序，并模拟基因如何沿此路径平滑变化。这是一个深刻的概念飞跃：认识到一些生物学故事不是关于不同的终点，而是关于旅程本身。

因此，聚类并非万能灵药。它是一台探索性显微镜。当深思熟虑地使用时——用正确的相似性定义，在干净的数据上，用与生物学问题相匹配的[算法](@article_id:331821)——它可以在生命的复杂性中揭示出惊人的隐藏秩序。它可以向我们展示新的细胞类型、新的疾病亚型，以及新的共调控基因家族 ([@problem_id:1440790])。但像任何强大的工具一样，它的发现并非金科玉律；它们是假说。它们是新实验和更深层次问题的起点，是从混沌到理解之旅的第一步 ([@problem_id:1440822])。