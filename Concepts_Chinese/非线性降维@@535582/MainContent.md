## 引言
现代科学技术正以前所未有的规模产生数据，从成千上万个单细胞的基因表达，到数百万张图像的像素值。这些高维数据蕴藏着复杂系统的秘密，但其巨大的体量使人类思维无法直接把握。我们常常像高维世界中的探险家，试图通过研究其简单的投影（影子）来理解它的形状。经典方法主成分分析（PCA）擅长寻找最大、信息最丰富的投影，但当数据的内在结构是弯曲、扭曲或卷起时——这在生物学和现实世界系统中很常见——它就从根本上失效了。这一局限性造成了一个关键的知识鸿G：我们如何才能看到数据的真实、复杂的形状，而不仅仅是其扁平化的投影？

本文介绍[非线性降维](@article_id:638652)（NLDR），这是一套旨在应对这一挑战的强大技术。通过超越线性投影，这些方法旨在“展开”数据通常所在的复杂[流形](@article_id:313450)，从而创建更忠实的低维映射。在接下来的章节中，我们将首先探讨 NLDR 背后的核心“原理与机制”，将 [t-SNE](@article_id:340240) 和 UMAP 等现代[算法](@article_id:331821)与传统方法进行对比，并就如何解读其抽象的可视化结果提供关键指南。然后，我们将通过其“应用与跨学科联系”，见证这些工具的革命性影响，探索它们如何被用于绘制生物学图景、增强人工智能，甚至揭示物理学的基本定律。

## 原理与机制

想象一下，你是一个来自二维世界的探险家，就像 Edwin Abbott 的《平面国》中的居民一样。你遇到了一个神秘的三维物体——比如一卷盘绕的花园水管。你理解它的唯一工具就是用光照射它并研究它的影子。如果你从正上方照射，影子是一个简单的实心圆。如果你从侧面照射，影子是一个长方形。这两个影子都没有告诉你全部真相：这个物体是一根长的、连续的、中空的管子，被卷了起来。你捕捉到了它的一些特征——它的总宽度、总长度——但你完全失去了其本质的*连通性*，即其内在的一维特性。

这就是当我们面对一个包含 15,000 个细胞、每个细胞有 20,000 个基因测量值的电子表格时所面临的挑战 [@problem_id:1465894]。我们就是那些平面国居民，而这个 20,000 维的数据集就是我们的花园水管。我们怎么可能指望看到它的真实形状呢？

### 超越投影：线性视觉的局限

处理这个问题的经典方法是一种名为**主成分分析（PCA）**的巧妙技术。在我们的比喻中，PCA 就像一个非常有条理的平面国居民，他会尝试所有可能的手电筒角度，以找到“最有趣”的影子。它找到数据云分布最广的方向，并称之为**主成分 1 (PC1)**。然后，它找到与第一个方向完全垂直的下一个分布最广的方向，称之为**主成分 2 (PC2)**，以此类推。将你的数据沿着 PC1 和 PC2 绘制出来，就像将高维云投影到一个能捕捉原始数据最大方差（或分布）的二维“投影平面”上。

这是一个非常强大和有用的工具。如果你的数据云形状像一个橄榄球（一个椭球体），PCA 是完美的。它会清晰地向你展示最长、最宽和最厚的部分。但如果数据不是一个简单的团块呢？如果它的形状像一个“瑞士卷”——一张卷成螺旋状的蛋糕片 [@problem_id:2416056]？PCA 在其寻求最大全局分布方向的过程中，会投射出一个看起来像实心矩形的影子。它将蛋糕卷的各层完全压扁在一起。那些沿着蛋糕表面走很远（大的**[测地距离](@article_id:320086)**）但在三维空间中很近（小的**欧几里得距离**）的点，在投影中会完全重叠。PCA 本质上是线性的；它只能创建平面的投影。它没有能力“展开”蛋糕卷。

这不仅仅是一个几何上的奇特现象。在生物学中，这种情况时常发生。想象一[小群](@article_id:377544)癌细胞对某种药物产生反应，微妙地改变了少数几个基因。在整个数据集的广阔背景中，这个变化是一个微小的、局部化的效应。变异的主要来源可能是细胞周期或[细胞大小](@article_id:299527)的简单差异。PCA 痴迷于寻找最大规模的全局方差，它会忠实地报告细胞周期的情况。而那个微小的药物效应，由于对总方差贡献很小，将被淹没在噪声中。处理组和未处理组在 PCA 图中看起来会完全混合在一起。然而，我们知道差异是存在的 [@problem_id:1428887]。我们需要一个更好的手电筒。

### 数据中的[流形](@article_id:313450)：隐藏的形状

突破来自于一个简单而深刻的想法：**[流形假设](@article_id:338828)**。这个假设提出，尽管我们的数据可能由成千上万个变量来描述（高维的*[环境空间](@article_id:363991)*），但数据点本身并不仅仅是随机地填充这个空间。相反，它们通常位于或接近一个维度低得多的、可能是弯曲的表面——一个**[流形](@article_id:313450)**。

想想地球的表面。要指定一个位置，我们生活在一个三维世界中，可以使用从地心出发的 $(x, y, z)$ 坐标。但这不必要地复杂。我们知道，地球表面在所有实际应用中都是一个[二维流形](@article_id:331153)。所以我们使用一个二维[坐标系](@article_id:316753)：纬度和经度。**[非线性降维](@article_id:638652)**的目标就是为我们的数据发现这个“纬度和经度”——找到它所在[流形](@article_id:313450)的内在[坐标系](@article_id:316753)。这是一种尝试，试[图展开](@article_id:309359)瑞士卷，将地球仪平铺成地图，看清花园水管那长而连续的管状本质。

### 绘制迷宫：关注局部邻域

那么，你如何展开一个你甚至看不见的[流形](@article_id:313450)呢？现代[算法](@article_id:331821)如**[t-分布随机邻域嵌入](@article_id:340240)（[t-SNE](@article_id:340240)）**和**[均匀流](@article_id:336471)形近似与投影（UMAP）**背后的巧妙见解是，至少在开始时，忘记全局，专注于局部邻域。

其逻辑是这样的：如果两个细胞，比如细胞 A 和细胞 B，在 20,000 个基因中的表达谱非常相似，那么它们应该被认为是[流形](@article_id:313450)上的“邻居”。它们“穿过[环境空间](@article_id:363991)”的距离可能具有误导性，但它们的接近性告诉我们它们在底层表面上是相连的。该[算法](@article_id:331821)大致按以下方式工作：

1.  **构建邻域图：** 想象每个数据点（每个细胞）都是拥挤房间里的一个人。[算法](@article_id:331821)首先让每个人识别出他们最亲密的朋友——他们的 $k$-近邻。这就创建了一个社交网络，一个连接原始高维空间中相近点的图。这个图是底[层流](@article_id:309877)形的一个粗略草图。它正确地连接了瑞士卷螺旋上的点，忽略了那些诱人但错误的、穿过层间空白空间的捷径。

2.  **在二维中[排列](@article_id:296886)图：** [算法](@article_id:331821)接着将这个高维网络尝试绘制在一张二维纸上。它通过一种[物理模拟](@article_id:304746)来实现这一点。想象网络中的每个连接都是一根弹簧，将邻居拉在一起。同时，每对*不是*朋友的人之间会感到一种轻微的排斥力，将他们推开。[算法](@article_id:331821)搅动这个系统，让它稳定到一个低能量状态。这些点在纸上的最终位置就构成了 UMAP 或 [t-SNE](@article_id:340240) 图。

正是这种对局部关系的关注，赋予了这些方法强大的力量。它们可以检测到我们之前例子中那一小群经过药物处理的细胞 [@problem_id:1428887]。即使这些细胞对全局方差贡献不大，[算法](@article_id:331821)也会注意到它们形成了一个紧密的邻域——它们彼此非常相似——并将它们作为一个独特的岛屿放置在二维地图上，与未处理细胞的海洋分离开来 [@problem_id:2268294]。

### 两全其美：强大的伙伴关系

这样看来，我们似乎应该完全放弃 PCA。但一个美妙的转折是，现代[数据分析](@article_id:309490)中最强大和常见的工作流程之一，恰恰是在运行 UMAP 之前*先用 PCA 做第一步* [@problem_id:1465894]。我们为什么要用一个线性方法来为非线性方法[预处理](@article_id:301646)数据呢？有三个极好的理由：

1.  **[去噪](@article_id:344957)：** 在一个典型的基因表达数据集中，并非所有 20,000 个维度都同等重要。PCA 产生的前几十个主成分通常捕捉了主要的生物学趋势（如细胞类型身份或发育过程），而剩下的数千个成分通常代表随机的生物学或技术噪声。通过运行 PCA 并只保留前 50 个左右的成分，我们实际上是在过滤掉噪声，为 UMAP 提供一个更清晰的信号。

2.  **计算速度：** 构建邻域图是 UMAP 中[计算成本](@article_id:308397)最高的部分。在 20,000 维中计算距离和寻找邻居，比在 50 维中慢得多。PCA 作为一个高效的压缩步骤，极大地减少了生成最终绘图所需的时间和内存。

3.  **克服[维度灾难](@article_id:304350)：** 在非常高的维度空间中，我们的几何直觉会失灵。“维度灾难”描述了一系列奇怪的现象，其中之一是“最近邻”的概念变得不那么有意义。在高维空间中，几乎所有的点都彼此相距遥远。通过首先用 PCA 将数据投影到一个更易于管理的子空间（例如 50 维），点与点之间的距离变得更规整，从而可以更稳健、更有意义地构建邻域图。

### 解惑指南：如何阅读新地图

你已经遵循了流程，屏幕上出现了一张漂亮、多彩的图，上面有优雅的漩涡和清晰的点簇。将其解读为字面意义上的地图或照片的诱惑是巨大的，但你必须抵制这种诱惑。这些是抽象的表示，解读它们需要一种特殊的素养。以下是基本规则：

1.  **[聚类](@article_id:330431)之间的距离没有意义。** 假设你看到了三个[聚类](@article_id:330431)：T 细胞、癌细胞和成纤维细胞。在你的 [t-SNE](@article_id:340240) 图上，成纤维细胞与癌细胞的距离看起来比 T 细胞与癌细胞的距离远得多。据此断定成纤维细胞与癌细胞的“差异更大”是完全错误的 [@problem_id:1428861]。[算法](@article_id:331821)的任务是表示这些[聚类](@article_id:330431)是不同的。为此，它会将它们推开。它们之间相距多远是优化过程的偶然结果，而不是它们实际差异程度的度量。可以把它想象成一张地铁线路图：图上两个站点之间的距离并不能告诉你真实的乘车时间，它只告诉你站点的顺序。在 PCA 中则不同：PCA 图上的距离*确实*反映了原始空间中[聚类](@article_id:330431)的全局分离程度 [@problem_id:1428930]。

2.  **聚类的大小和密度没有意义。** 你看到了两个[聚类](@article_id:330431)。一个很小且紧密，另一个很大且分散。据此断定第一个[聚类](@article_id:330431)代表一种更同质、[转录](@article_id:361745)变异更小的细胞类型是错误的 [@problem_id:1428920]。UMAP 和 [t-SNE](@article_id:340240) 可以拉伸和压缩空间以满足其保留局部邻域的主要目标。原始数据中一个大的、高方差的聚类可能会在二维图中被挤压成一个小的、密集的点云，反之亦然。视觉上的密度是一种人为现象，而非特征。

3.  **坐标轴没有意义。** 在 PCA 中，坐标轴是主成分。PC1 是“最重要的方向”，PC2 是第二重要的，它们是原始基因在数学上精确的[线性组合](@article_id:315155)。你可以检查“载荷”来看哪些基因对 PC1 有贡献，并常常能为其赋予生物学意义，比如一个“[耐药性](@article_id:325570)轴” [@problem_id:1428895]。在 UMAP 和 [t-SNE](@article_id:340240) 中，水平和垂直坐标轴**没有任何意义**。它们是优化过程中产生的任意[坐标系](@article_id:316753)。整个图可以旋转或上下翻转，而其解释不会有任何改变，因为[算法](@article_id:331821)唯一关心的是点相对于其邻居的相对位置。

### [细胞图谱](@article_id:333784)：选择你的指南针

如果 [t-SNE](@article_id:340240) 和 UMAP 都基于相似的原理，你应该使用哪一个？多年来，[t-SNE](@article_id:340240) 是可视化单细胞数据的黄金标准。如今，UMAP 更受青睐，尤其是在创建包含数百万细胞的整个生物体的[细胞图谱](@article_id:333784)这样的大型项目中 [@problem_id:1428882]。这种转变主要有两个原因。

首先，UMAP 的速度明显更快，计算可扩展性也更强。但其次，也许更重要的是，UMAP 在保留局部邻域的同时，通常能更好地保[留数](@article_id:348682)据的**全局结构**。[t-SNE](@article_id:340240) 倾向于将连续的[流形](@article_id:313450)打碎成不相连的岛屿，而 UMAP 则更努力地展示这些岛屿是如何连接的。

一个精彩的思想实验是，想象来自细胞的数据，其状态由两个独立的周期性循环控制，比如[细胞周期](@article_id:301107)和昼夜节律。这个[数据流形](@article_id:640717)的真实形状是一个环面——一个甜甜圈。当投影到二维时，PCA 只能看到它的影子：一个实心圆或矩形。[t-SNE](@article_id:340240) 由于其对局部邻居的极度关注，可能会感到困惑，将连续的表面分解成几个团块。然而，UMAP 通常能成功捕捉到全局拓扑结构，生成一个清晰的环形或[圆环](@article_id:343088)形状 [@problem_id:1428873]。它“学习”到数据在一个维度上是循环的，并利用这一点来组织最终的布局。它给出了对底层连续生物学过程更忠实的表示，一张这个隐藏世界更真实的地图。

通过超越简单的投影，学习绘制和阅读这些新型地图，我们终于可以开始看到隐藏在数据中那些复杂、美丽且常常令人惊讶的形状。

