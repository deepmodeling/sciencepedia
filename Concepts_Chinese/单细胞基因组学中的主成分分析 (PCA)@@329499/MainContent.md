## 引言
[单细胞基因组学](@article_id:338564)产生了海量数据集，其中每个细胞都由数以万计的基因表达值描述，创造了一个人类无法直接解读的高维空间。我们如何能在这惊人的复杂性中找到有意义的模式，例如不同的细胞类型或分化路径？本文通过聚焦[主成分分析 (PCA)](@article_id:352250) 来应对这一根本挑战。PCA 是[单细胞分析](@article_id:338498)工具箱中最基本、应用最广泛的工具之一，它是从看似混沌的数据中解锁生物学见解的万能钥匙。

本文将引导您了解 PCA 在[单细胞分析](@article_id:338498)背景下的核心概念和实际应用。在第一章“原理与机制”中，我们将深入探讨 PCA 的工作原理，为什么[数据预处理](@article_id:324101)是一门对其成功至关重要的艺术，以及它如何像侦探一样揭示隐藏的实验问题。随后，“应用与跨学科联系”一章将探讨 PCA 如何从一个抽象的[算法](@article_id:331821)转变为构建[细胞图谱](@article_id:333784)、检验假设、甚至设计下一代生物实验的实用工具。

## 原理与机制

想象一下，你接手了一个拥有成千上万册图书的图书馆。每本书都是一个单细胞，书中的文本是其独特的基因表达模式——一个包含数万个“词”（基因）以及每个词使用频率的列表。你的任务是整理这个图书馆。你希望将主题相似的书籍放在同一个书架上，比如所有生物学教科书、所有奇幻小说、所有诗集。问题在于，你事先并不知道这些主题。你该从何下手呢？你不可能读完每本书的每一个字。你需要一个策略来找到区分书籍的最重要模式。这正是[单细胞分析](@article_id:338498)所面临的挑战，而**[主成分分析 (PCA)](@article_id:352250)** 是我们解决这个问题最值得信赖和最基础的工具之一。

### 寻找主要的变异轴

PCA 就像一位负责这项宏大整理任务的图书管理员。它不关心情节或文采，而是采用一种极其简单却强大的数学策略：找到整个文库中变异最大的那个方向。可以把这看作是基因表达多维空间中的一个“轴”。这个首要且最重要的轴被称为**主成分1 (PC1)**。例如，它可能完美地将非虚构类书籍与虚构类书籍分开，因为这代表了图书馆中最大的“主题”差异。

在确定了这个主要主题后，PCA 会寻找下一个最重要的变异轴，但有一个关键约束：这个新轴，即**主成分2 (PC2)**，必须与第一个轴完全独立（即正交）。如果 PC1 分开了虚构类和非虚构类，PC2 则可能将非虚构类书籍分为科学和历史。它会继续这个过程，找到 PC3、PC4 等等，每个主成分都捕捉剩余变异中越来越小的部分，并且都与之前的所有主成分正交。

PCA 的魔力在于它将来自数万个基因的令人困惑的信息浓缩到少数几个主成分中。我们不再需要在 20,000 维空间中比较细胞，现在通常只需观察前几个 PC 就能看到数据的主要结构。

然而，我们绝不能忘记这个工具的根本性质。PCA 本质上是一种**线性**方法。它在数据点云中找到最佳拟合的*直线*或*平面*。如果真实的生物学故事是弯曲或分支的——比如细胞周期的连续循环或[细胞分化](@article_id:337339)的 Y 形岔路——PCA 会给出最佳的[线性近似](@article_id:302749)，但这将是一个扭曲的近似。它会把圆形压扁，把“Y”形的分支混在一起。产生的主成分不会是底层生物学的完美反映，而是其在一个更简单的线性子空间上的投影 [@problem_id:2416133]。这不是 PCA 的缺陷，而是其定义性特征，理解这一点是明智使用它的关键。

### 准备的艺术：引导 PCA 找到正确的信号

我们的图书管理员 PCA 虽然出色，但也有其怪癖。它对数据的呈现方式极为敏感。如果我们只是把来自细胞文库的原始“词频”交给它，它很容易被误导。为了得到一个有生物学意义的[组织结构](@article_id:306604)，我们必须首先仔细准备，或称**[预处理](@article_id:301646)**数据。这与其说是一个严格的方案，不如说是一门艺术，由我们对生物学和统计学的理解共同指导。

#### 驯服最响亮的声音：对数转换

在任何语言中，像“和”、“的”或“是”这样的一些词都非常常见。在我们的细胞中，**[看家基因](@article_id:375883)**（维持基本生存所需的基因）也是如此。它们在几乎每个细胞中都以非常高的水平表达。由于它们的表达计数高，即使是微小的比例波动也会导致巨大的绝对方差。PCA 痴迷于方差；这正是它被设计来最大化的目标。没有任何指导，PCA 很可能会将其 PC1 设定为代表这些常见但[信息量](@article_id:333051)不大的[看家基因](@article_id:375883)变异的轴，从而完全忽略了那些真正定义细胞类型的更微妙信号 [@problem_id:1465860]。

为了解决这个问题，我们应用**对数转换**，通常形式为 $c \mapsto \ln(c + 1)$，其中 $c$ 是基因计数。这种转换有一个至关重要的作用：它稳定了方差。它抑制了高表达基因的影响，压缩了它们的方差，使它们不会主导分析。它迫使 PCA 更多地关注那些表达水平可能较低但其变异更能指示真实生物学差异的基因，比如定义一个稀有细胞类型的关键[转录因子](@article_id:298309) [@problem_id:1714838]。这就像告诉图书管理员要听所有的词，而不仅仅是最响亮的那些。

#### 创造公平的竞争环境：[数据缩放](@article_id:640537)

对数转换后，还存在另一个问题。不同基因的表达范围仍然不同。一个基因可能在 10 到 100 之间变化，而另一个更稳定的基因可能只在 1 到 2 之间变化。同样，PCA 追逐方差的本性意味着它会被第一个基因吸引，仅仅因为其数值上的方差更大。

为了纠正这一点，我们对数据进行**缩放**（标准化）。这个标准流程调整每个基因的表达，使其在所有细胞中的均值为 0，方差为 1。这使得每个基因在 PCA 开始前都处于同等地位。这就像确保我们图书馆里的每个“词”都以相同的字号打印。现在，一个基因对 PCA 的影响取决于它与其他基因的相关模式及其区分细胞群的能力，而不是其任意的初始方差 [@problem_id:1465860]。

#### 聚焦信号：选择高变基因

最后的准备步骤是认识到并非所有基因都提供信息。许多基因的表达水平非常低，或者其波动非常随机，以至于它们基本上是生物学噪音。将它们纳入分析就像要求我们的图书管理员根据书页上尘埃的位置来整理图书馆——这增加了随机性，并可能掩盖真正的主题。

因此，一个关键步骤是通过识别**高变基因 (HVGs)** 来进行**[特征选择](@article_id:302140)**。这些基因在细胞群体中显示的变异比根据其平均表达水平随机预期的要大。通过将我们的数据集过滤到只包含这些 HVGs（通常是几千个），我们主动地富集了信号并移除了噪音。我们递给图书管理员一份精心策划的“关键词”列表，并要求它将精力集中在这些词上。这极大地提高了 PCA 找到与真实生物异质性而非技术噪音相对应的主成分的能力 [@problem_id:1465906]。

### PCA 作为诊断侦探

数据准备妥当后，PCA 就可以开始工作了。虽然它的主要工作是[降维](@article_id:303417)，但它也常常扮演着同等重要的诊断工具角色——一个揭示我们实验中隐藏问题的侦探。因为它非常有效地找到*最大*的变异来源，它会立即指出数据中可能潜伏的任何主要技术性人为因素。

一个经典的例子是**批次效应**。如果你在周一处理一批细胞（批次1），在周二处理另一批细胞（批次2），这两次实验之间不可避免地会存在微小的技术差异。如果这些技术差异是你数据中最大的变异来源，那么 PC1 将不会按生物学类型来区分细胞，而是按批次来区分。当你绘制细胞图时，你会看到批次1和批次2的完美分离。这不是 PCA 的失败！而是一种成功。PCA 正确地诊断出你的生物信号被技术性人为因素所淹没。这告诉你，在相信任何下游的生物学结论之前，你必须进行**[批次校正](@article_id:323941)** [@problem_id:1465876]。

同样，PCA 也可以检测细胞质量问题。在单细胞实验中，一些细胞在分离过程中会受到压力或死亡。这些垂死的细胞通常具有独特的分子特征，例如[细胞膜](@article_id:305910)渗漏导致细胞质 RNA 逸出，从而增加了线粒体 RNA 的相对比例。如果你有大量细胞质量不佳，这种“垂死信号”可能成为变异的主要来源。当你运行 PCA 时，你可能会发现 PC1 与线粒体读取的百分比密切相关。同样，PCA 在扮演你的质量控制侦探，指出了你样本中一个需要解决的重大问题，通常通过过滤掉这些低质量细胞来解决 [@problem_id:1466141]。

### 解读指南针并选择路径

一旦我们得到了主成分，我们该如何使用它们？第一步是决定其中有多少个是有意义的。一个常用的工具是**[碎石图](@article_id:303830) (scree plot)**，它显示了每个连续的 PC 所解释的方差量。有时，这张图会显示一个明显的“肘部”：前几个 PC 解释了大量方差，然后曲线变平。这表明数据的核心结构可以仅由那前几个成分捕捉。

然而，在复杂的生物系统中，我们经常看到不同的情况：一个“平坦的高原”，其中许多 PC（可能是前 10 或 20 个）每个都贡献了少量但相似的方差。这不是失败或噪音的迹象，而是复杂性的标志。它表明，并不存在一两个占主导地位的生物学过程，而是许多强度相当的独立过程——细胞周期、代谢状态、免疫反应、分化——都在同时发生。为了完全捕捉生物学信息，我们可能需要为下游分析保留更多数量的这些 PC [@problem_id:2416071]。

一种更严谨的选择 PC 数量的方法是直接检验它们的生物学相关性。我们可以使用统计模型来对每个 PC 提问：“即使在我们考虑了我们想要忽略的任何技术因素（例如批次、细胞质量）之后，这个成分是否与已知的生物学因素（例如细胞类型、处理条件）显著相关？” 这种有原则的方法使我们能够选择一组在统计上富集了我们关心的生物信号的 PC，为进一步的分析提供了坚实的基础 [@problem_id:2379649]。

最后，回到第一个原则至关重要：PCA 是线性的。它寻找全局的方差模式。这使其成为去噪和初步探索的出色工具。但如果我们寻找的信号不是全局的，而是局部的呢？想象一个巨大、熙熙攘攘的人群，在一个小角落里，有一[小群](@article_id:377544)人 huddled together in a quiet, intense conversation。PCA 从“直升机视角”俯瞰整个人群，寻找最大、最广泛的移动趋势，很可能会错过这个微妙的、局部的聚集。

这就是**[t-SNE](@article_id:340240)** 和 **UMAP** 等[非线性降维](@article_id:638652)方法发挥作用的地方。它们更像实地勘测员，根据每个细胞的直接邻居来构建地图。它们擅长保留局部结构。因此，它们可以识别出一个小而紧密的细胞簇，而如果这个簇对*全局*方差贡献不大，PCA 可能会忽略它 [@problem_id:1428887]。这就是为什么[单细胞分析](@article_id:338498)中一个标准且强大的工作流程是首先使用 PCA——不是为了可视化，而是作为一个稳健的[去噪](@article_id:344957)和[数据压缩](@article_id:298151)步骤。我们选择前 10、20 甚至 50 个 PC，这些 PC 现在代表了主要的、清理过的变异轴，然后将*它们*作为像 UMAP 这样的非[线性算法](@article_id:356777)的输入。这种协同作用结合了两者的优点：PCA 的全局、方差最大化和[去噪](@article_id:344957)能力，以及 UMAP 的复杂的、保留局部结构的能力 [@problem_id:1466130]。这个两步过程让我们最终能够生成那个组织精美的图书馆，揭示写在每个单细胞内的隐藏主题和叙事。