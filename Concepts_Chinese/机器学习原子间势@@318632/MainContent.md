## 引言
逐原子地模拟材料的行为是现代科学的基石，有望解锁从下一代电池到新型药物的一切。作为准确性的黄金标准，量子力学为这些原子相互作用提供了精确的描述，但其[计算成本](@article_id:308397)极其高昂，使得模拟规模仅限于数百个原子，且模拟时间极短。这在我们想要模拟的目标和我们能够计算的现实之间造成了巨大的鸿沟。我们如何才能跨越这一鸿沟，以极小的成本实现量子级别的精度呢？

答案是[机器学习原子间势](@article_id:344521) (MLIPs)，一种将物理学与人工智能融合的革命性方法。本文将全面概述这项强大的技术。在第一章**“原理与机制”**中，我们将深入探讨 MLIPs 的核心概念，探索定域性和对称性原理如何让我们驾驭原子世界惊人的复杂性。我们将学习如何使用一种数学语言来描述原[子环](@article_id:314606)境，并教会神经网络如何“阅读”它。接下来的**“应用与跨学科联系”**一章将展示这些[势函数](@article_id:332364)如何被验证并部署为可信赖的工具，以应对重大的科学挑战，从设计新材料到模拟原子的量子性质。我们的旅程将从理解支配所有原子运动的那个“地貌”开始。

## 原理与机制

想象一下，试图通过追踪每一个空气分子的运动来预测整个地球的天气模式。这个任务似乎复杂得不可能完成，就像无数相互作用的粒子在进行一场混乱的舞蹈。在原子层面模拟分子和材料也面临着类似的挑战。一种材料的性质——无论是[脆性](@article_id:376963)还是柔性，是导体还是绝缘体——都源于其组成原子之间极其复杂的芭蕾舞。而这场芭蕾舞的“乐谱”由一个深刻的概念决定：**[势能面](@article_id:307856)**。我们的目标就是写出这个“乐谱”。

### 世界如地貌：[势能面](@article_id:307856)

原子由沉重、行动迟缓的原子核和轻盈、灵活的电子组成。由于电子的质量小得多，它们对原子核的任何运动几乎都能瞬时做出反应。这一见解在**[玻恩-奥本海默近似](@article_id:306672)**中被形式化，是解开这个问题的关键。它让我们能够想象，对于任何固定的原子核排布，电子都会稳定在其最低能量状态，形成一种“电子胶水”将原子核固定在一起。

这种“胶水”的能量并非恒定不变，它取决于所有原子核的精确位置 $\mathbf{R}$。这种依赖关系定义了一个巨大的高维地貌：**[势能面](@article_id:307856)**（Potential Energy Surface, PES），表示为 $V(\mathbf{R})$。你可以把原子想象成正在探索山脉的徒步者。任何一点的海拔就是势能，而地形的陡峭程度决定了拉动原子的力，使它们“滚”向能量更低的构型。这个[势能面](@article_id:307856) $V(\mathbf{R})$ 是我们希望学习的根本对象。它纯粹是原子位置的函数，是一个不同于自由能等[热力学](@article_id:359663)量的力学势，后者还考虑了温度和熵 [@problem_id:2784636]。学习这个地貌是任何[原子间势](@article_id:356603)的核心目标。

### “近视”原理：定域性与加性

描绘一个拥有数十亿维度的地貌似乎是天方夜谭。一个原子的能量怎么可能取决于一块材料中所有其他原子的位置？在这里，物理学通过**近视性**原理提供了一个巨大的简化。一个给定原子的[电子结构](@article_id:305583)，从而其能量，绝大多数情况下只受其近邻原子的影响，而与系统中远处的原子无关。就像你的心情更容易受同处一室的人影响，而不是遥远国度的人一样，一个原子的能量状态主要是一个局部事务。

这个“近视”原理让我们能够实现一个突破性的飞跃。我们可以假设一个系统的总能量 $E_{total}$ 只是每个原子 $i$ 的能量贡献 $\varepsilon_i$ 的简单加和：

$$
E_{total} = \sum_{i=1}^{N} \varepsilon_i
$$

其中，每个原子能量 $\varepsilon_i$ 只依赖于一个小的局部环境内的原子排布，这个环境通常由一个**[截断半径](@article_id:297161)** $r_c$ 定义。这种从一个针对整个系统的、极其复杂的单一函数，转变为一系列小的、可管理的局部函数之和的概念性转变，是现代机器学习势的架构基础。

这种局部分解优雅地保证了一个关键的物理性质：**尺寸广延性**。两个不相互作用的水分子的势能应该恰好是一个水分子能量的两倍。一个构建为局部能量之和的模型自然满足这一点；当分子相距很远（距离超过[截断半径](@article_id:297161)）时，一个分子中原子的能量贡献完全不受另一个分子的影响，总能量就是简单的加和 [@problem_id:2805720]。我们可以直观地想象：如果我们有一组原子，然后轻轻推动原子“A”，远处原子“B”的局部能量将完全保持不变，只要它们之间的距离大于[截断半径](@article_id:297161) $r_c$。这个推动的影响是严格局域化的，正如我们的假设所规定的一样 [@problem_id:2457450]。

### 不可违背的法则：对称性

[势能面](@article_id:307856)并非任意随机的地貌，它必须服从宇宙的基本对称性。这些不是建议，而是不可违背的法则。我们可以将这些法则直接构建到模型中，使其效率和准确性得到极大提升。

1.  **[平移和旋转](@article_id:348766)[不变性](@article_id:300612)**：物理定律在任何地方都是相同的。一个分子的能量不能因为我们仅仅把它从实验室的一边移到另一边（**平移不变性**）或把它倒置（**[旋转不变性](@article_id:298095)**）而改变。总能量 $\mathcal{E}(\mathbf{R})$ 必须是一个**不变的**标量。

2.  **[置换](@article_id:296886)[不变性](@article_id:300612)**：全同粒子是真正完全相同的。如果一个水分子有两个氢原子，那么并不存在“氢原子#1”和“氢原子#2”之分。交换它们的位置不会改变任何事情。能量必须对全同原子的**[置换](@article_id:296886)**保持不变。

那么力 $\mathbf{F}_i = -\nabla_{\mathbf{r}_i} \mathcal{E}(\mathbf{R})$ 呢？它们不是不变的。如果你旋转一个分子，作用在其原子上的力矢量必须随之旋转。这种变换性质被称为**[等变性](@article_id:640964)** [@problem_id:2784682]。通过设计一个保证能够预测不变能量的模型，由它导出的力将自动具有[等变性](@article_id:640964)。这些对称性是强大的**[归纳偏置](@article_id:297870)**——预先编程的物理知识——它们引导我们的模型走向正确的解，而无需从零开始学习这些规则 [@problem_id:2648619]。

### 一种用于描述环境的语言：不变性描述符

我们如何向机器描述一个原子的环境，同时又能内在地尊重这些对称性呢？直接喂给它邻近原子的原始[笛卡尔坐标](@article_id:323143)列表是行不通的，因为这些坐标会随每次旋转而改变。我们需要发明一种新的语言，一种被称为**描述符** $\mathcal{D}_i$ 的数学“指纹”，它能够唯一地表征原子 $i$ 的局部化学环境，同时对平移、旋转和[置换](@article_id:296886)保持天然不变。

解决方案是从本身就不变的几何量构建这个指纹：原子间的**距离**、**角度**和**[二面角](@article_id:314447)**。此外，为了使这个描述符有用，它必须是**可微的**，这样我们才能计算平滑的力；并且是**唯一的**，意味着两个不同的环境应该产生两个不同的指纹 [@problem_id:2475277]。

一个著名且广泛使用的例子是 **Behler-Parrinello [对称函数](@article_id:356066)**。这些函数就像探测局部环境的探针。例如，一个简单的*径向*[对称函数](@article_id:356066)可能会问：“原子 $i$ 在距离 $R_s$ 附近有多少个邻居？”其数学形式可以是 [@problem_id:2784613]：

$$
G^2_i = \sum_{j \ne i} \exp(-\eta (R_{ij} - R_s)^2) f_c(R_{ij})
$$

这里，高斯项 $\exp(-\eta (R_{ij} - R_s)^2)$ 在距离 $R_s$ 处达到峰值。平滑的截断函数 $f_c(R_{ij})$ 确保其贡献在[截断半径](@article_id:297161) $r_c$ 处平滑地降至零。请注意这个构造的精妙之处：因为它只依赖于距离 $R_{ij}$，所以它自动对全局平移和旋转保持不变。又因为它是一个对所有邻居 $j$ 的*求和*，所以我们考虑它们的顺序无关紧要，这使其对[置换](@article_id:296886)保持不变。我们还可以构建更复杂的*角向*函数来描述三体关联（即键角）。通过使用一组具有不同参数的此类函数，我们可以构建一个丰富、不变的描述符向量，捕捉局部环境的基本几何特征。

### 学习机器：从描述符到能量

有了不变的描述符向量 $\mathcal{D}_i$ 在手，我们就有了一种合适的数学语言来描述原子的局部世界。最后一步是学习这种描述与原子对总能量的贡献 $\varepsilon_i$ 之间的联系。这就是机器学习登场的时刻。我们假设存在一个映射关系：
$$
\varepsilon_i = f_\theta(\mathcal{D}_i)
$$

函数 $f_\theta$ 通常是一个**神经网络**，它是一种灵活的[函数逼近](@article_id:301770)器，其可调参数用 $\theta$ 表示。对于一个包含碳和氧的系统，我们会为所有碳原子使用一个[神经网络](@article_id:305336)，为所有氧原子使用另一个。网络学习一个通用的、可迁移的概念，例如，“一个以线性构型与两个氧原子成键的碳原子”意味着什么。

整个系统的总能量就是这些原[子网](@article_id:316689)络输出的总和：$E = \sum_i \varepsilon_i$。由于每个网络的输入（描述符）是通过构造保证不变的，其输出（原子能量）也是不变的，因此总能量也是不变的。我们成功地构建了一台尊重游戏基本规则的机器。

这种由 Behler 和 Parrinello 开创的方法使用固定的、手工制作的描述符。这一思想的最新发展体现在**[图神经网络](@article_id:297304) (GNNs)** 中，其中描述性特征本身不是预先固定的，而是从数据中学习得来，这提供了更大的灵活性，但潜在的代价是需要更多的数据来训练 [@problem_id:2648619]。

### 教学的艺术：基于能量和力进行训练

现在我们已经构建了我们的机器，该如何教它呢？我们需要给它看一些例子。通过昂贵的量子力学计算，我们可以获得一个原子构型的数据集，每个构型都带有参考能量，以及至关重要的、每个原子上的参考力。

有人可能会尝试只向网络展示每个构型的总能量来训练它。但这种方法效率极低。这就像仅仅通过知道几个零散点的海拔高度，就想了解整个山脉的形状一样。一种更强大的方法是同时使用力。力是能量地貌的负梯度（即斜率）。知道每个点的斜率会给你提供关于地形形状的更多信息。

这就是**力匹配**的精髓。我们定义一个**[损失函数](@article_id:638865)**——一个误差的度量——它同时惩罚模型预测的能量与参考能量之间的差异，以及模型预测的力与参考力之间的差异 [@problem_id:2759514]。一个典型的损失函数可能如下所示：

$$
L(\boldsymbol{\theta}) = \sum_{k=1}^{K} \left[ w_E \left(E_{\boldsymbol{\theta}}^{(k)} - E_{ref}^{(k)} - b \right)^2 + w_F \frac{1}{3N_k} \sum_{i=1}^{N_k} \left\| \mathbf{F}^{\boldsymbol{\theta}}_{i,k} - \mathbf{F}_{\text{ref},i,k} \right\|^2 \right]
$$

这个方程虽然看起来可能令人望而生畏，但它体现了几个关键的物理和统计思想。权重为 $w_E$ 的项处理能量误差，其中我们包含一个可训练的偏移量 $b$ 来解释绝对能量具有任意零点的事实。权重为 $w_F$ 的项处理力误差，并且它正确地比较了完整的力*矢量*，而不仅仅是它们的模。权重因子可以根据[量纲分析](@article_id:300702)和统计学原理选择，通常通过将力项按原子数量[归一化](@article_id:310343)，来平衡来自单个能量值的信息与每个结构可用的 $3N$ 个力分量的信息 [@problem_id:2648589]。通过最小化这个损失函数，[神经网络](@article_id:305336)可以以惊人的保真度学习[势能面](@article_id:307856)的细微形状。

### 了解局限：长程力与不确定性

我们的“近视”机器是完美的吗？当然不是。它的优势——定域性——也正是它的主要弱点。

一些物理相互作用本质上是非局域的。最著名的例子是**[静电相互作用](@article_id:345679)**。带电粒子之间的库仑力以 $1/r^2$ 的形式衰减，这是一个非常缓慢的衰减过程。一个离子的电场会被系统中*所有其他离子*感受到，无论它们多远。一个具有有限[截断半径](@article_id:297161)的模型从根本上对这些长程相互作用是“盲目”的，这对于模拟离子材料、水或极性分子来说是一个致命的缺陷。克服这一问题需要创建[混合模型](@article_id:330275)，将短程[机器学习势](@article_id:362354)与用于[长程静电相互作用](@article_id:300301)的、基于物理的显式[算法](@article_id:331821)相结合 [@problem_id:2648601]。

此外，一个值得信赖的科学仪器不仅要给出预测，还必须给出其[置信度](@article_id:361655)的评估。我们的[机器学习势](@article_id:362354)能告诉我们它何时在“猜测”吗？这是**[不确定性量化](@article_id:299045)**的前沿领域。我们可以考虑两种不确定性 [@problem_id:2648582]：
- **[认知不确定性](@article_id:310285)**是模型自我承认的无知。它反映了由于构型空间某个区域的训练数据稀疏而导致的知识缺乏。这是可以减少的：通过使用巧妙的**[主动学习](@article_id:318217)**策略，我们可以命令模型在其最不确定的区域请求新的量子力学计算，从而迭代地自我完善。
- **[偶然不确定性](@article_id:314423)**是数据或模型前提中固有的、不可减少的随机性。例如，如果我们的参考数据是由一种有噪声的方法生成的，或者如果我们构建一个粗粒度模型，其中被忽略的原子的运动对我们看到的原子产生了一种随机的“踢动”，这就会表现为无法通过增加数据量来消除的噪声。

通过构建能够意识到这些规则、局限和不确定性的模型，我们不仅仅是在创造[黑箱函数](@article_id:342506)逼近器。我们正在设计智能的、基于物理的工具，以扩展我们探索原子世界这个广阔而美丽地貌的能力。