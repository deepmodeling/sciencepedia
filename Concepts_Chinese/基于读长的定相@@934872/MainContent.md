## 引言
我们的基因组是生命的说明书，但我们拥有的并非仅有一份副本——我们有两份，一份继承自父亲，一份继承自母亲。这两个版本，或称单倍型，几乎完全相同，但包含一些称为遗传变异的微小差异。标准的[DNA测序](@entry_id:140308)会同时读取这两卷书，将它们撕碎成一堆混杂的片段，使我们不确定哪个变异来自哪个亲本。这种模糊性在遗传学中构成了一个重大挑战，因为变异在染色体上的精确排列方式可能意味着健康与疾病之别。

本文探讨了**定相**（phasing）的艺术与科学——即从这些混合数据中重建两个原始亲本基因组的过程。我们将深入探讨这一基本基因组技术的核心概念和现实世界中的影响。“原理与机制”部分将解释什么是定相、为何它如此重要，以及像基于读长的定相这样的直接方法如何利用DNA片段的物理证据来解开这个谜题，并将其与间接的统计方法进行对比。随后的“应用与跨学科联系”一章将展示定相如何在生物学和医学领域提供深刻的见解，从诊断[遗传性疾病](@entry_id:273195)、个性化药物处方，到揭示癌症和表观遗传学中新的复杂层次。

## 原理与机制

### 你的两卷“天书”

想象一下，你的基因组，这份制造你的完整说明书，是一部庞大的百科全书。关于这部百科全书有一个奇特的事实：你并非只有一份，而是有两份。一份继承自你的母亲，另一份来自你的父亲。这两卷书——我们称之为M卷和F卷——几乎完全相同。它们有相同的章节（基因），以相同的顺序排列在相同的页面（染色体）上。但其中散布着微小的差异，就像不同的拼写或词语选择。这些就是你的遗传变异。

每一卷书，连同其特定的变异序列，被称为一个**单倍型**（haplotype）。M卷是你的母系单倍型，F卷是你的父系单倍型。

现在，假设我们想阅读你的百科全书。最常见的方法，即使用标准测序技术，有点像把两卷书都撕碎成数百万个微小的句子片段，然后将它们全部混在一个巨大的堆里。我们的测序仪读取这些片段，给我们一份所有句子的完整列表。对于任何存在“拼写错误”或变异的位置，我们知道它的存在。例如，我们可能会发现在某个位置，一个版本的句子使用了“参考”这个词，而另一个版本使用了“备选”。在遗传学术语中，我们可以将参考等位基因标记为'0'，备选等位基因标记为'1'。我们知道你两者都有，这种状态我们称之为杂合（heterozygous），我们用`0/1`表示这种未定相的基因型。斜杠`/`表示我们的无知：我们知道'0'和'1'都存在，但我们不知道是'0'来自M卷、'1'来自F卷，还是反之亦然[@problem_id:4554246]。

**定相**（phasing）的艺术与科学，就是要解决这个问题的宏大挑战。它是将那堆混杂的句子片段拿来，并将每一个正确地归还到其原始卷宗的过程。目标是重建M卷和F卷的完整原文。当我们成功时，我们可以说基因型已经定相，表示为`0|1`。竖线`|`是一种知识的陈述：它告诉我们哪个等位基因在哪条染色体上，解决了这种模糊性[@problem_id:4554246]。

### 两种缺陷的故事：为何定相事关生死

你可能会想，这是否只是一种追求整洁的学术练习。一个变异来自哪一卷书真的那么重要吗？在某些情况下，这至关重要。

考虑一种常染色体隐性遗传病。当某个特定的“配方”（一个基因）在你百科全书的*两个*副本中都损坏时，这些疾病就会出现，使你没有任何功能性指令。假设我们在一个关键基因中发现了两个不同的罕见变异，$v_1$和$v_2$，两者都已知是致病的——它们会破坏这个配方。你对这两个变异都是杂合的。这两种缺陷的排列方式有两种可能[@problem_id:4388603]：

1.  **顺式构型**（Cis Configuration）：两个变异$v_1$和$v_2$都位于同一卷书中，比如M卷。这意味着你母亲的基因副本受到了双重损害。然而，你的F卷，即父亲的副本，是完全正常的。它仍然可以产生功能性蛋白质，你很可能完全健康。

2.  **反式构型**（Trans Configuration）：变异位于相对的卷书中。变异$v_1$在M卷中，而$v_2$在F卷中。现在，没有一卷书包含一个正确、功能性的配方副本。这种情况，被称为**复合杂合性**（compound heterozygosity），会导致疾病。

惊人的结论是，完全相同的两个变异既可能导致完全健康，也可能导致严重的[遗传性疾病](@entry_id:273195)。唯一的区别是它们的相态——它们在染色体上的排列方式。没有定相，遗传学家只能猜测。这就是为什么定相不仅仅是为了数据整洁；它是现代诊断医学的基石。

### 跨越界线读取：物理证据的力量

那么我们如何解开这个谜题呢？最直接的方法叫做**基于读长的定相**（read-based phasing）。其原理异常简单。正如[@problem_id:5163229]所述，我们依赖一个基本事实：每一条测序读长都来自一个*单一的、物理的DNA分子*。这意味着在该条读长上观察到的任何变异都必定来自同一个原始卷宗——同一个单倍型。

如果我们想知道两个变异$v_1$和$v_2$的相态，我们只需要找到一条足够长的测序读长，能够物理上跨越它们两个的位置。如果我们找到一条读长，它包含$v_1$的备选等位基因和$v_2$的参考等位基因，我们就抓住了它们的现行！我们有了直接的物理证据，证明这种组合存在于其中一条染色体上。

这立即揭示了旧的短读长测序技术的局限性。如果两个变异相隔（比如说）800个碱基对，但我们的测序技术只能产生约350个碱基对的片段，那么物理上就不可能找到一个能同时覆盖这两个位点的片段[@problem_id:4388603]。我们需要的证据根本无法触及。

这就是**[长读长测序](@entry_id:268696)**的魔力所在。像[PacBio](@entry_id:264261) SMRT或Oxford Nanopore这样的技术可以产生数万个碱基对长的读长。对于这些技术来说，跨越800甚至8,000个碱基对的间隙是轻而易举的[@problem_id:5163229]。通过简单地“跨越界线读取”，它们可以直接揭示远距离变异的相态。一项较新的发明，**关联读长测序**（linked-read sequencing），通过一个巧妙的技巧达到了类似的效果：它为来自同一个原始长DNA分子的所有短读长片段加上条形码。通过按条形码对读长进行分组，我们可以在计算上将原始分子上相隔数万个碱基的变异联系起来，有效地创建了一个“虚拟”的长读长[@problem_id:5016478]。

当然，这是一个概率游戏。我们的技术*能够*产生长读长，并不保证我们能捕获到我们需要的特定区域。成功与否取决于几个关键因素[@problem_id:5163229]：
*   **读长（$L$）与变异距离（$d$）**：你无法捕捉到你够不着的东西。我们绝对需要$L > d$。
*   **覆盖度（$C$）**：这是每个碱基被测序的平均次数。更高的覆盖度就像买更多的彩票——它增加了我们捕获到那条幸运的跨越读长的机会。
*   **错误率（$e$）**：读长并非完美。我们需要确信我们在跨越读长上看到的等位基因是真实的，而不仅仅是测序错误。

令人惊讶的是，我们可以将所有这些因素都融入一个精确的数学模型中。例如，我们可以计算出，在给定变异距离和技术错误率的情况下，成功对两个变异进行定相所需达到的99%概率的最低覆盖度$C$。这将定相从猜测转变为可预测的定量科学[@problem_id:5163229]。

### 群体的智慧：统计定相

当变异之间的距离非常巨大时——比如相隔数十万个碱基，就像[全外显子组测序](@entry_id:141959)数据中被长[内含子](@entry_id:144362)隔开的不同外显子中的变异一样，会发生什么？[@problem_id:4393857]。目前没有技术能产生那么长的单条读长。我们失败了吗？

不完全是。我们可以转向一种完全不同的间接策略：**统计定相**。这里的想法是利用“群体的智慧”[@problem_id:4579378]。科学家们已经对来自不同群体的数千个个体进行了测序，并确定了他们的单倍型。这个已知单倍型的集合作为一个参考面板。其指导原则是**[连锁不平衡](@entry_id:146203)（LD）**，即邻近位点上的等位基因并非独立遗传，而是倾向于在世代间以“单倍型区块”的形式黏在一起。

统计定相的工作方式如下：对于你未定相的基因型，算法会搜索整个参考面板，并询问：“这个群体中的哪一对已知单倍型最有可能组合成我在这个个体中看到的基因型？”这是一种强大的方法，可以在基于读长的方法失效的巨大基因组距离上推断相态。

然而，这种强大功能带有一个关键的警告。它是基于群体平均值的有根据的猜测，而不是对*你*特定染色体的直接测量。如果出现以下情况，其准确性可能会受到影响：
*   你的祖源在参考面板中没有得到很好的代表[@problem_id:4346156]。
*   你携带非常罕见甚至是*de novo*（全新的）变异，这些变异在参考面板中不存在[@problem_id:4393857]。

当算法被迫猜测时，它可能会犯错，从正确的母系单倍型切换到父系单倍型。这被称为**转换错误**（switch error）。我们可以通过转换错误率来衡量定相算法的准确性：即相邻变异对中被错误定相的比例[@problem_id:5067213]。这些错误在长距离上的累积可能导致对整体顺式/反式构型的完全错误结论[@problem_id:4346156]。

### 统一视角：贝叶斯侦探

所以我们有两种强大但不完美的策略。基于读长的定相为我们提供了直接的物理证据，但受距离限制。统计定相可以跨越巨大的距离，但提供的是间接的、概率性的证据。我们应该相信哪一个？

最优雅的答案是：我们两者都信，通过一种有原则的方式来权衡它们的证据。这就是贝叶斯推断的领域，一个在面对新证据时更新我们信念的数学框架[@problem_id:4355737]。

把它想象成一个侦探破案。侦探开始时有一个基于对嫌疑人的一般知识的**[先验信念](@entry_id:264565)**——这就是我们的统计定相。它根据群体数据告诉我们，顺式构型还是反式构型更有可能。然后，侦探找到了新的、确凿的物理证据——一个指纹，一根纤维。这就是我们的基于读长的数据。这个证据的强度取决于跨越读长的数量及其质量。

侦探不会抛弃最初的评估，而是用新证据来更新它。在定相中，我们使用读长数据（**似然性**）来更新基于群体的先验。结果是一个**后验概率**——我们最终的、综合了所有信息的信念。这种最大化后验概率的方法，被证明是整合这两种互补信息来源并最小化我们错误几率的最佳方式[@problem_id:4355737]。

这种综合代表了基因组学中一种美妙的统一。我们共同人类历史的群体层面模式（LD）与来自个体DNA分子的精确物理测量在一个单一、连贯的数学框架中结合起来。这种方法与[统计物理学](@entry_id:142945)有深刻的联系，其中找到最可能的单倍型排列问题在数学上等同于找到一个相互作用的自旋系统的最低能量状态，这是一个被称为[伊辛模型](@entry_id:139066)（Ising model）的经典问题[@problem_id:4539412]。从临床需求到基础物理，理解我们生命的两卷书的旅程揭示了科学深刻而相互关联的本质。

