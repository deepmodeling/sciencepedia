## 引言
我们宇宙中绝大多数的物质是不可见的。这种“暗物质”塑造了宇宙，形成了星系赖以建立的[引力](@entry_id:175476)支架，但其基本性质仍然是现代科学中最巨大的谜团之一。为了解开这个谜团，科学家们开发了一种强大的工具：宇宙学暗物质模拟。这些数字宇宙使我们能够根据观测到的宇宙结构来检验我们的宇宙学和[粒子物理学](@entry_id:145253)理论。但是，要有效地运用如此强大的工具，我们必须首先了解它是如何构建的，其固有的局限性，以及它与几乎所有物理学领域的深刻联系。

本文将带领读者深入这些宇宙实验室的核心。在第一部分“原理与机制”中，我们将揭开在计算机内部构建宇宙的幕后过程。我们将探讨其基本概念，从创造一个有限但无边界的宇宙，到设定反映时间之初的[初始条件](@entry_id:152863)，并审视驱动宇宙演化的复杂算法。我们还将直面“机器中的幽灵”——每个模拟研究者都必须学会驯服的数值赝象。随后的“应用与跨学科联系”部分将展示这些模拟令人难以置信的科学影响力。我们将看到它们如何超越了创造宇宙网的精美图像，成为解读[星系巡天](@entry_id:749696)、检验暗物质本质以及指导我们在地球上最灵敏的实验中寻找这种难以捉摸的物质的不可或缺的工具。

## 原理与机制

[模拟宇宙](@entry_id:754872)是一项相当大胆的尝试。我们试图在一个盒子里构建一个宇宙，一个我们自己宇宙的数字回响，并由相同的物理定律支配。这样的壮举怎么可能实现呢？这并非通过蛮力，而是通过一系列巧妙的原理和机制，每一项都证明了我们对宇宙宏伟设计的理解。让我们踏上创造这样一个数字世界的旅程，从它的最初时刻到其成熟、结构化的状态。

### 宇宙舞台：盒子里的宇宙

第一个、也是最突出的问题是，宇宙实际上是无限的。然而，我们的计算机是有限的。我们如何可能捕捉一个无限的广袤空间呢？我们从宇宙本身得到启示。在最大尺度上，宇宙在任何地方、任何方向上看起来都是相同的。这就是**[宇宙学原理](@entry_id:158425)**，一个深刻的宇宙谦逊宣言：我们在宇宙中并不占据特殊的位置。

为了模拟这一点，我们不模拟一个有硬边界的盒子。相反，我们使用一个巧妙的技巧，称为**[周期性边界条件](@entry_id:147809)（PBC）**。想象宇宙被我们模拟盒子的无限个相同副本所平铺。一个从盒子右侧离开的粒子不会撞到墙上；它会立即从左侧重新进入，就像经典街机游戏中的角色环绕屏幕一样。这种数学上的巧妙手法创造了一个没有边缘、没有中心的空间，一个有限的区域，完美地模仿了真正均匀宇宙的平移不变性。[@problem_id:3494821]

当然，这个漂亮的技巧也有其局限性。通过将自己限制在一个边长为$L$的盒子里，我们对任何大于盒子本身的宇宙结构波都是盲目的。我们的模拟有一个对应于波长$L$的“[基本模式](@entry_id:165201)”；所有更长的模式都根本不存在。这意味着我们模拟的这片宇宙，根据其构造，其平均密度将恰好等于宇宙的平均密度。然而，一个同样大小的真实区域会有其自身的轻微过密或欠密，这是由这些缺失的长波模式引起的涨落。这种“有限盒子效应”是不确定性的一个根本来源，提醒我们我们总是在观察一个无限拼图的有限碎片。[@problem-id:3494821]

### 布景：初始条件

随着我们的宇宙舞台搭建完毕，我们必须决定如何安排演员。我们不能简单地随机撒播暗物[质粒](@entry_id:263777)子。我们今天看到的宇宙是从其婴儿期存在的无限小的[密度涨落](@entry_id:143540)中成长起来的，这些结构种子的印记在宇宙微波背景中仍然可见。这些初始涨落的“配方”是一个称为**功率谱**的统计描述，记为$P(k)$。它告诉我们不同物理尺度上密度变化的幅度，从微小的涟漪到广阔的宇宙波。

但是，我们如何从一个抽象的统计配方转变为在我们的盒子中放置具体的粒子呢？在这里，我们使用优雅的**[Zel'dovich近似](@entry_id:139227)**。在宇宙早期的[线性区](@entry_id:276444)域，结构的增长很简单。粒子们还没有开始它们那复杂、旋转着汇入星系的舞蹈；它们大多只是随着哈勃膨胀而相互远离。[Zel'dovich近似](@entry_id:139227)为每个粒子提供了“行动指令”，计算出其偏离一个完美均匀网格的微小初始位移。这些位移被精心设计，使得最终的[粒子分布](@entry_id:158657)在统计上平均恰好具有[功率谱](@entry_id:159996)$P(k)$所描述的正确属性。这是连接原始宇宙的理论描述与我们模拟的第一个快照的惊人直接的联系。[@problem_id:892837]

这个位移场告诉粒子*从哪里*开始。但它们移动的速度如何呢？对于标准的**[冷暗物质](@entry_id:158219)（CDM）**，其热运动被假定为可以忽略不计，这就足够了。但如果暗物质并非完全冷呢？像**[温暗物质](@entry_id:160015)（WDM）**这样的候选者会拥有其从原始等离子体中退耦时残留的[热速度](@entry_id:755900)。这不仅仅是一个小细节；这些初始的“踢动”可能产生深远的影响，因为快速移动的粒子可以从小的[密度涨落](@entry_id:143540)中流出，抹去最小星系的种子。

为了模拟这一点，我们必须给我们的粒子一个从适当的统计分布中采样的初始速度——在这种情况下，对于[费米子](@entry_id:146235)遗迹，是**[费米-狄拉克分布](@entry_id:138909)**。通过从该[分布](@entry_id:182848)计算预期的[均方根](@entry_id:263605)速度，我们可以为我们的模拟粒子赋予正确的热运动量，确保我们的初始设置忠实地代表了我们希望测试的特定暗物质模型。[@problem_id:3489256] 这突显了一个关键主题：模拟的设置本身就是一个物理假设。

### 创造的引擎：演化宇宙

场景已经布置好，粒子各就各位。现在，我们说“要有[引力](@entry_id:175476)！”，然后观察我们的宇宙演化。但这是在一个相当奇特的环境中的[引力](@entry_id:175476)：一个膨胀的空间。为了描述运动，我们不使用熟悉的物理坐标。相反，我们使用**[共动坐标](@entry_id:271238)**，这就像在一个气球上画一个网格，然后看着网格点随着气球膨胀而分开。一个粒子的运动随后被分成两部分：总体的哈勃膨胀（网格的拉伸）和它相对于网格的“奇特”运动。

当我们在该[共动参考系](@entry_id:266800)中从牛顿定律推导运动方程时，出现了一个引人入胜的新项：一个“哈勃阻力”。这是一个[摩擦力](@entry_id:171772)，与粒子的奇特速度成正比，作用是减缓其相对于宇宙网格的速度。它在传统意义上不是一个“真实”的力；它是我们共动视角的结果，一个像科里奥利力一样的[虚拟力](@entry_id:165088)，代表了随着宇宙膨胀动量的[红移](@entry_id:159945)。完整的[运动方程](@entry_id:170720)优美地将这种宇宙摩擦与密度涨落产生的我们所熟悉的[引力](@entry_id:175476)结合在一起。[@problem_id:3489262]

求解这些方程是最大的计算障碍。我们数十亿个粒子中的每一个都感受到来自其他每一个粒子的[引力](@entry_id:175476)拖拽。直接逐个粒子地求和力将是一个$O(N^2)$的计算，一个计算上的噩梦，完成它需要比宇宙年龄还长的时间。物理学家们，作为聪明的生物，已经开发出两种主要的变通方法。

*   **粒子-网格（PM）方法**：这种方法效率极高。我们不计算单个粒子之间的力，而是首先将[质量分布](@entry_id:158451)的“模糊图像”描绘到一个规则的网格上。一旦质量在网格上，我们就可以使用一种称为快速傅里叶变换（FFT）的数学工具，几乎瞬间解出[泊松方程](@entry_id:143763)以得到[引力势](@entry_id:160378)。这种方法在计算温和、长程的[引力](@entry_id:175476)时表现出色，但就其本质而言，它在描述邻近粒子之间尖锐、细致的力时是模糊且不准确的。[@problem_id:3500350]

*   **树方法**：这种方法采用分层的方式。为了计算作用在某个粒子上的力，它将一个遥远的粒子团簇不视为数千个个体，而是一个单一的大物体。它将所有粒子组织成一个树状数据结构，其中邻近的粒子被分组到小的“叶”节点中，而更大的群体被捆绑到“枝”节点中。这个近似，由一个决定一个群体是否足够远以便被视为一个整体的“张角”控制，是高度准确的，并且捕捉到了PM方法遗漏的关键的[短程力](@entry_id:142823)。[@problem_id:3500350]

在实践中，许多最先进的模拟使用混合的**Tree-PM**方法，利用快速的PM方法处理[长程力](@entry_id:181779)，利用准确的树方法处理[短程力](@entry_id:142823)，从而兼得两者的优点。

### 细节中的魔鬼：驯服数值赝象

模拟是一种近似，一个好的科学家必须了解他们工具的局限性。在构建我们的袖珍宇宙时，我们被迫引入一些“非物理”的成分，以使计算易于处理。其艺术在于确保这些成分不会毒害最终结果。

其中一个成分是**[引力软化](@entry_id:146273)**。在真实世界中，暗物质是一种光滑的流体。在我们的模拟中，它由离散的粒子代表。如果两个这样的粒子发生非常近的相遇，它们之间$1/r^2$的[引力](@entry_id:175476)将急剧飙升，将它们以荒谬的高速抛出，并使模拟陷入停顿。为了防止这种情况，我们在非常小的尺度上修改[引力](@entry_id:175476)，使相互作用“软化”。力不再发散，而是在零分离时平滑至零。然而，这个必要的修正有其后果。它阻止了暗物质晕预测中应有的尖锐中央密度“尖峰”的形成，反而创造了人为的恒定密度“核心”。当我们分析我们模拟的暗晕时，我们必须小心区分这些数值核心和可能存在的真实物理核心，并在我们的测量中考虑软化引入的偏差。[@problem_id:3490327]

一个相关的赝象是**双体弛豫**。我们大质量的模拟粒子可以通过[引力](@entry_id:175476)相互散射，而真实暗物质那种几乎无碰撞的、细粒度的流体则不会。这种虚假的散射可以人为地“加热”系统，使暗晕的核心膨胀，并且最有害的是，扰乱较小子暗晕的[轨道](@entry_id:137151)，可能摧毁它们。我们可以估计这种数值加热变得显著的时间尺度，即**[弛豫时间](@entry_id:191572)**，$t_r$。一个稳健的模拟必须被设计——通过仔细选择粒子质量和[软化长度](@entry_id:755011)——以确保这个[弛豫时间](@entry_id:191572)远远长于宇宙的年龄，从而保证我们的结果不被这种数字摩擦所污染。[@problem_id:3507095]

最后，我们必须选择我们的**时间步长**，$\Delta t$。在两次计算之间，我们可以跳跃多长的时间？规则很简单：在单一步长内，任何粒子的移动都不能太远。我们必须选择一个足够小的$\Delta t$来精确追踪在最紧密束缚区域[内移](@entry_id:265618)动最快的粒子的路径。这在模拟WDM时尤其苛刻，因为粒子开始时就有很大的[热速度](@entry_id:755900)，迫使模拟采取极小的初始步长来跟上。[@problem_id:3489262]

### 聚焦镜头：新技术与新物理

虽然我们的“盒子里的宇宙”是一个强大的工具，但它在各处的分辨率都是均匀的。如果我们只对单个星系感兴趣，但希望以极高的细节观察它呢？用如此高的精度模拟整个宇宙体积将是一种浪费。

这就是**放大模拟**的用武之地。我们首先运行一个大宇宙体积的低分辨率模拟，以确定一个感兴趣的暗晕将形成的区域。然后，我们只对该区域重新进行模拟，但使用高得多的分辨率。高分辨率区域中的[粒子质量](@entry_id:156313)要小得多，我们使用更精细的网格或更小的[软化长度](@entry_id:755011)来捕捉更多细节。这种技术，通常用**自适应网格加密（[AMR](@entry_id:204220)）**实现，就像在宇宙的某一部分放置了一个[计算显微镜](@entry_id:747627)。为了确保高低分辨率边界处的物理是一致的，我们必须遵循严格的[标度律](@entry_id:139947)。当我们将分辨率提高一个因子$r$时，粒子质量必须减少$r^3$，[软化长度](@entry_id:755011)必须减少$r$，这是一个优美的结果，直接源于我们对采样质量和解析力的要求一致性。[@problem_targ_id:3503453]

模拟不仅仅是为了证实我们的标准模型；它们是我们测试新思想的主要实验室。如果暗物质不仅仅是一个[引力](@entry_id:175476)上的旁观者呢？在**[自相互作用暗物质](@entry_id:158619)（SIDM）**模型中，粒子可以像台球一样碰撞和散射。我们可以将这种物理添加到我们的模拟中。在每个时间步长的[引力](@entry_id:175476)计算之外，我们搜索附近的粒子对。根据[相互作用截面](@entry_id:161790)决定的概率，我们让它们发生散射。要正确地做到这一点，我们必须执行一个经典的教科书物理计算：跳入粒子对的[质心系](@entry_id:168444)，根据期望的散射角旋转它们的相对速度矢量，然后再跳回模拟[参考系](@entry_id:169232)。这确保了碰撞中动量和能量都完美守恒，使我们能够准确预测这种相互作用会产生的独特特征——比如在暗晕中形成真实的物理核心。[@problem_id:3488350]

### 收获：寻找并编目暗晕

在我们的模拟运行了模拟的138亿年后，我们得到了一张包含数十亿个点的快照。我们如何从这个数字星云中提取科学信息呢？第一步是找到已经形成的[引力](@entry_id:175476)束缚结构——承载星系的**[暗物质晕](@entry_id:147523)**。

这是**暗晕寻找器**的工作。最常见的类型之一是**球形过密度（SO）寻找器**。该算法在概念上很简单：它找到一个局部密度峰值，并在其周围生长一个球体，计算所包含的质量。它继续增长球体，直到内部的平均密度下降到一个特定的阈值，例如，宇宙临界密度的200倍，$\rho_c$。达到这个条件的半径，$R_{200}$，和所包含的质量，$M_{200}$，定义了这个暗晕。这个阈值并非任意的；它受到优美的**球形塌缩模型**的启发，这是一个简单的解析理论，表明一个均匀的球形过密度将会塌缩并在大约这个密度值上达到[维里化](@entry_id:161222)。[@problem_id:3507106] [@problem_id:3490327] 通过在我们的最终[粒子分布](@entry_id:158657)上运行这些寻找器，我们可以生成庞大的暗晕目录，记录它们的质量、大小、形状和子结构。这个目录是我们模拟的最终产品，是连接我们的“盒子里的宇宙”和我们用望远镜观测到的真实星系宇宙的桥梁。

