## 引言
假如你不仅能预测一台机器*是否*会出故障，或一名患者*是否*会康复，还能预测*何时*发生？这个问题正是生存分析的领域，这是一个强大的统计框架，它将我们的关注点从简单的结果转向事件发生的时间。传统方法常常失灵，因为现实世界的数据是混乱和不完整的；研究结束了，患者搬走了，留给我们的是未完成的故事。这种“删失”数据的问题——我们只知道某个事件在特定时间之前尚未发生——使得简单的平均值具有误导性，需要一种更复杂的方法。本文为这一重要方法提供了全面的指南。

在第一章“原理与机制”中，我们将探讨生存分析得以运作的核心概念，包括删失、生存函数与风险函数的优雅语言，以及该方法如何理清复杂的现实世界问题和统计偏倚。随后的“应用与跨学科联系”一章将揭示这些思想惊人的多功能性，展示其在生死攸关的医疗决策、可靠工程[系统设计](@entry_id:755777)，乃至搜寻遥远世界中的应用。

## 原理与机制

要真正掌握生存分析，我们必须像讲故事的人一样思考，但要具备物理学家的严谨。我们讲述的故事是关于时间的——直到某事发生的时间。这个“某事”可以是一台机器的故障、一名患者的康复、一种疾病的复发，甚至是根管治疗后一颗牙齿的存活 [@problem_id:4715966]。核心问题不仅仅是事件*是否*会发生，而是*何时*发生。这个看似简单的视角转变，从“是否”到“何时”，开启了一个丰富而迷人的统计推理世界。

### 未完的故事：删失

想象一下，你正在追踪一群试图登上一座险峻山峰的登山者。一些人到达了顶峰（事件），一些人中途折返，还有一些人仍在攀登时，一场暴风雪迫使你放弃观察哨。对于那些仍在攀登的人，你不知道他们的最终结果。你只知道他们在暴风雪来临之前还活着。这种不完整的信息是生存分析中的核心挑战，被称为**删失**（censoring）。

像计算平均登顶时间这样的简单方法完全失效了。如果你只平均成功登山者的时间，就忽略了那些用时更长、仍在山上的人，从而造成一种过于乐观的景象。如果你将他们排除在外，你就在丢弃有价值的信息。生存分析正是正确倾听这些未完故事所蕴含信息的艺术。

最常见的类型是**[右删失](@entry_id:164686)**（right-censoring），就像我们的登山者例子一样。当一个受试者的随访时间在他们经历事件之前结束时，就会发生这种情况。这可能是因为研究结束、患者搬家，或者他们因与结果无关的原因退出 [@problem_id:4486564]。关键在于，我们知道事件发生在某个特定时间*之后*。

其他形式的删失虽然不那么常见，但同样重要。**[左删失](@entry_id:169731)**（left-censoring）发生在我们开始观察之前，感兴趣的事件已经发生。例如，如果一个传感器只能在某个阈值时间 $L$ 之后检测到机器故障，那么在 $L$ 之前发生的任何故障都只被记录为在 $L$ 或之前发生 [@problem_id:3107161]。**[区间删失](@entry_id:636589)**（interval-censoring）发生在我们只知道事件发生在某个特定时间窗口内，例如两次预定检查之间。例如，一件工业设备可能在月度检查中被发现已经发生故障；我们只知道它的报废发生在上次成功检查和本次检查之间的某个时间点 [@problem_id:4069733]。

使生存分析得以运作的基本原则是**非信息性删失**（non-informative censoring）的假设。这意味着删失行为本身不应提供任何关于个体未来风险的线索。例如，如果感觉病情更重的患者更有可能退出研究，那么这种删失就是信息性的，我们的标准方法将产生偏倚 [@problem_id:4715966]。

### 风险的语言：生存与风险

为了处理删失数据，我们需要一种新的语言。生存分析提供了两个基本概念来描述风险随时间变化的动态：**生存函数**和**风险函数**。

**生存函数**，记为 $S(t)$，是最直观的。它简单地回答了这个问题：到时间 $t$ 为止，事件*尚未*发生的概率是多少？该函数从 $S(0) = 1$ 开始（在开始时每个人都未经历事件），随着时间的推移和更多事件的发生，逐渐向 0 递减。它是一条描绘原始群体随时间衰减的曲线。

**风险函数**，$h(t)$ 或 $\lambda(t)$，是一个更微妙、更强大的概念。它表示在时间 $t$ 发生事件的瞬时风险，*前提是事件尚未发生*。可以把它看作是“当下”的风险。如果生存函数告诉你活到 50 岁生日的几率，那么风险函数告诉你*在* 50 岁生日那天死亡的风险，前提是你已经活到了那天。它可以呈现任何形状：可能是恒定的（就像公平抛硬币的风险），可能增加（就像汽车零件因磨损而失效的风险），也可能减少（我们稍后会看到）。

这两个函数是同一枚硬币的两面。任何时间 $t$ 的生存率都由截至该时间点累积的总风险决定。在数学上，这种优美的关系表示为 $S(t) = \exp\left(-\int_{0}^{t} h(u)\,du\right)$。积分 $\int_{0}^{t} h(u)\,du$ 是**累积风险**，表示到时间 $t$ 为止吸收的风险总量。累积风险越高，生存的概率就越低。这个优雅的框架使我们能够结合来自经历事件的个体（他们告诉我们那一刻的风险信息）和被删失的个体（他们告诉我们风险不足以在他们的删失时间之前引起事件）的信息。

### 现实世界中的复杂情况

现实世界很少像一个简单的模型那样干净。生存分析已经发展出复杂的工具来处理各种混乱但引人入胜的复杂情况。

#### 有偏倚的起点（截断）

有时，我们并非从一个队列的真正起点开始观察。想象一项始于 2000 年的发电厂退役研究。它包括了 20 世纪 70 年代建造的电厂，但前提是它们在 2000 年*仍在运行*。那些在 70 年代建造但在 90 年代失效的电厂不在此数据集中。这被称为**左截断**（left-truncation）或**延迟进入**（delayed entry）[@problem_id:4069733]。我们是从一个预先筛选出的幸存者群体中抽样。为了获得资产寿命的无偏估计，我们的分析必须在数学上考虑这种条件限制，通过将在研究开始时存活足够长时间以便被纳入的概率，来有效调整观察到事件的可能性 [@problem_id:4985887]。

#### 岔路口（[竞争风险](@entry_id:173277)）

当个体可能经历几种不同且[互斥](@entry_id:752349)的事件之一时会发生什么？在一项针对侵袭性癌症患者的研究中，患者可能死于癌症进展，也可能死于治疗的毒性 [@problem_id:4325673]。死于毒性不是一个删失事件；它是一个确定的结局，*排除*了将来死于癌症的可能性。这些被称为**[竞争风险](@entry_id:173277)**（competing risks）。

将竞争事件视为简单的[右删失](@entry_id:164686)是一个严重的错误。这样做以最极端的方式违反了非信息性删失的假设：死于毒性的患者将来死于癌症的几率为 0%，而一个真正被删失的患者则被假设与仍在观察中的其他人具有相同的未来风险。这种错误会导致对感兴趣事件发生概率的估计出现无意义且系统性的夸大。相反，我们必须使用能够同时对所有事件类型的发生率进行建模的方法，例如原因特异性风险模型或多状态模型，这些模型能在其竞争者存在的情况下正确计算每个特定结局的概率 [@problem_id:4325673]。

#### 移动目标（时依协变量）

风险不是静止的。患者的生物标志物水平，作为其疾病活动性的衡量标准，会随时间变化。当我们想了解这样一个移动目标与生存之间的关系时，我们处理的就是**时依协变量**（time-dependent covariate）[@problem_id:4796107]。

在*外部*（external）和*内部*（internal）协变量之间存在着关键的区别。外部协变量像是每日的空气污染；其路径不受个体影响。而内部协变量，如血压读数或生物标志物水平，是个体生理学的一部分。它既是风险的预测因子，也是潜在疾病过程的结果。其轨迹因事件本身而终止。在生存模型中轻率地使用此类协变量充满了风险。观察到的值通常带有测量误差，并且它们的存在本身就依赖于患者保持无事件状态。这些反馈循环和依赖关系需要先进的技术，例如**联合模型**（joint models），该模型同时对生物标志物的轨迹和生存结局进行建模，以厘清两者之间的真实关系 [@problem_id:4796107]。

### 进步的幻象：揭示统计偏倚

统计学最大的功用之一就是检验我们有缺陷的直觉。生存分析提供了强大的工具来揭示那些在没有进步的地方制造出进步幻象的偏倚。

#### 领先时间偏倚：抢先起步

想象一种新的筛查测试，它能比症状出现早几年检测出一种致命癌症。在一个没有有效治疗方法的世界里，死亡时间由肿瘤的生物学特性决定，且保持不变。然而，生存时间是从诊断到死亡来衡量的。通过提前 3 年诊断癌症，我们仅仅是将“生存时钟”提前了 3 年。测得的生存时间将延长 3 年，尽管这个人的生命并未延长一天 [@problem_id:4874698]。例如，如果一个患者本应在 64 岁时被诊断，并在 66 岁时去世（2 年生存期），筛查可能会导致在 61 岁时诊断。他们仍然在 66 岁去世，但他们测得的生存期现在是 5 年。5 年生存率可能从 0% 跃升至 100%，而人群的实际死亡率保持不变。这就是**领先时间偏倚**（lead-time bias），一个纯粹的统计假象。

#### 分期迁移：威尔·罗杰斯现象

伟大的美国幽默家 Will Rogers 有句名言：“当俄克拉荷马州人离开俄克拉荷马搬到加利福尼亚时，他们提高了两个州的平均智力水平。”同样的悖论，被称为**分期迁移**（stage migration），也可能发生在医学领域。

假设一家医院得到了一台更灵敏的成像扫描仪。它现在可以检测到以前漏掉的微小转移灶。考虑一组之前被分类为“早期”的患者和另一组“晚期”的患者。现在，一些“早期”组中病情最严重的患者（那些有先前未检测到的微转移灶，因此预后较差的患者）被重新划分到“晚期”组 [@problem_id:4856989]。

结果如何？“早期”组失去了病情最重的成员，因此其平均生存期上升了。“晚期”组增加了一些相对健康的成员（他们仍然比原来“晚期”组的平均患者更健康），所以其平均生存期*也*上升了。两个分期的生存统计数据似乎都有所改善，然而没有一个患者的寿命延长了一天。整个队列的总生存期完全保持不变。我们仅仅通过重新标记患者，就在纸上创造了一个奇迹 [@problem_id:4856989]。

### 隐藏变量：群体异质性

让我们用一个优美而反直觉的观点来结束。想象一个装满灯泡的大盒子。每个灯泡都有一个简单的、恒定的烧毁风险。但是，这些灯泡来自不同的工厂；一些是精心制造的（“健壮的”），一些是次品（“脆弱的”）。这种未被观察到的变异性就是我们所说的**异质性**（heterogeneity）或**脆弱性**（frailty）[@problem_id:4958778]。

盒子里所有灯泡的总风险率是多少？在开始时，风险是所有单个灯泡风险的平均值。但随着时间的推移，奇妙的事情发生了。那些脆弱的、具有高内在风险的灯泡倾向于先烧坏。这个**选择性耗竭**（selective depletion）的过程意味着存活下来的灯泡群体中，越来越富集那些更健壮的灯泡。

因为存活下来的群体平均而言变得更强健，所以该群体的整体[风险率](@entry_id:266388)会随时间*下降*。尽管每个灯泡自身的风险仍然是恒定不变的，这种情况依然会发生！群体风险的结构仅仅因为其隐藏的多样性而改变了。这阐明了一个深刻的原则：一个异质群体的行为不仅仅是其各部分的总和。选择和生存的动态创造了涌现属性，只有通过将群体作为一个整体来思考才能理解。正是在揭示这些复杂、隐藏的动态中，生存分析展现了其真正的力量与美。

