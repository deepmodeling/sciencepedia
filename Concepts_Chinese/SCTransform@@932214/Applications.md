## 应用与跨学科联系

在上一章中，我们拆解了SCTransform的引擎，审视了它的齿轮和活塞——正则化负二项回归、皮尔逊残差，以及使其与众不同的整个统计机制。这是一项优美的理论工作。但科学家从不满足于纯粹的理论。真正的乐趣来自于看到引擎的实际运作，见证一个简洁而强大的思想如何推动在广阔而崎岖的领域中的发现。现在，我们将踏上这段旅程。我们将探讨这个单一、优雅的框架如何不仅仅是归一化数据的技术修复，更是一种革命性的工具，重塑了我们探索细胞世界的方式。

### 一种新的基因表达语言

多年来，处理单细胞间测序深度巨大差异的标准方法是一个两步过程：将每个细胞中的计数除以其总数，然后应用对数（一种常被称为“对数归一化”的方法）。这很直观。如果一个细胞的测序深度是另一个的十倍，我们只需将其计数按比例缩小十倍。这就像把一个音量大的扬声器调低以匹配一个安静的扬声器。

问题是，这并不完全奏效。想象一个房间里有些人大声喊叫，有些人窃窃私语。对数归一化就像一个压缩器，减少了整体音量差异，但大喊者的声音在本质上仍然具有不同的特性——它们更持续可闻，更不容易消失在背景噪音中。同样地，即使在调整了“音量”之后，表达量非常高的基因（“大喊者”）在统计学上的行为也与表达量低的基因（“私语者”）不同。这种挥之不去的、被称为[异方差性](@entry_id:136378)的技术特征，意味着声音最大的基因不成比例地影响我们的分析，常常掩盖了更微妙的生物学信号。

SCTransform提供了一个更深刻的解决方案。它不仅仅是调整音量，而是对房间底层的“声学特性”进行建模。它学习基因平均表达与其变异性之间的关系，然后使用这个模型将原始计数转换为一种新的语言：皮尔逊残差 [@problem_id:4385438]。残差不是计数或比例；它是一种*意外程度*的度量。它告诉我们一个基因的表达与我们基于细胞测序深度和该基因典型行为所*预期*的表达偏离了多少。

结果是神奇的。这些残差的方差在整个基因表达范围内变得稳定。大喊者和私语者终于站在了平等的地位上，它们的表达值现在使用一种共同的、同方差的语言进行交流 [@problem_id:2890020]。这带来了深远的影响：这意味着像主成分分析 (PCA) 这样的下游工具——它们依赖于[欧几里得距离](@entry_id:143990)并假设这种均匀方差——现在可以在一个公平的竞争环境中运行，捕捉真实的生物学变异，而不是被技术噪声误导 [@problem_id:3330207]。它甚至指导我们选择更高级的工具；这些残差的特性使得[皮尔逊相关](@entry_id:260880)性（它衡量这些“意外”信号的协变性）成为比较细胞最自然的度量标准 [@problem_id:3330211]。通过从一个更好的测量过程模型开始，我们最终得到了对生物学本身更忠实的表述。

### 绘制身体地理图：助力[空间组学](@entry_id:156223)

在革命性的[空间转录组学](@entry_id:270096)领域，SCTransform建模框架的灵活性尤为关键，该技术直接在组织切片内测量基因表达。这里的一个主要挑战是，载玻片上的每个测量点可能捕获不同数量的细胞。一个位于密集肿瘤区域的点可能包含三十个细胞，而邻近的疤痕组织中的点可能只包含五个。

一个简单的归一化方法将完全被混淆。它会看到密集点中的总计数很高，并得出结论说那里的所有基因都高表达，而实际上这只是一个更拥挤的区域。这是一个典型的生物学变量（细胞密度）与技术变量（基因计数）纠缠在一起的案例。

这就是[广义线性模型 (GLM)](@entry_id:749787)——SCTransform的引擎——真正力量的体现。[回归模型](@entry_id:163386)就是为了扩展而构建的。如果我们有关于每个点中细胞数量的信息——也许来自配对的显微镜图像——我们可以简单地将其作为另一个解释变量添加到我们的模型中 [@problem_id:5164045]。然后，模型会学习区分影响基因计数的三个独立效应：其内在表达水平、点的[测序深度](@entry_id:178191)以及点中的细胞数量。通过回归掉后两个效应，我们可以推导出代表真正*单细胞*表达水平的残差，即使在密度差异巨大的点之间也是如此。这使得我们可以在例如淋巴结中密集的生发中心与周围较稀疏的组织之间公平地比较细胞活性，这项任务对于免疫诊断至关重要 [@problem_id:5164045]。更高级的“空间感知”模型甚至可以整合每个点的 $(x, y)$ 坐标，让模型能够区分真实的生物学梯度和可能在载玻片上平滑变化的技术性人为因素。

### 协调细胞交响乐：数据整合与批次校正

科学是一项集体事业。波士顿的一位生物学家可能会生成一份来自健康捐赠者的免疫细胞数据集，而东京的另一位科学家则在疾病背景下研究相同的细胞。为了获得新的发现，我们必须能够比较和组合这些数据集。问题在于，每个实验都有其独特的怪癖——即“批次效应”。试剂批次、测序仪甚至执行实验的技术人员的差异都可能引入与生物学无关的系统性变异。一个测序更深的批次自然会比一个较浅的批次有更少的零计数，这种差异很容易被误认为是生物学现象 [@problem_id:2374377]。

在这里，SCTransform的建模框架再次提供了解决方案。就像我们可以为空间数据模型添加“细胞计数”一样，我们可以添加一个“批次”指示符作为协变量。模型为每个批次学习一个特定的系数，捕捉其独特的技术特征，然后在计算残差[时移](@entry_id:261541)除这种效应。与那些丢弃数据或对噪声性质做出不正确假设的粗糙方法相比，这是一种在原理上更合理、更强大的方法 [@problem_id:2374377]。

这种协调数据的能力是现代基因组学中最强大应用之一——构建[细胞图谱](@entry_id:270083)——的基础。通过使用SCTransform对数十甚至数百个实验进行归一化，我们可以将它们全部投影到一个共同的、经过批次校正的空间中。在这个共享空间中，我们可以识别“锚点”——来自不同实验的细胞对，它们是彼此的最近邻，代表着一种共享的生物学状态 [@problem_id:2837420]。这些锚点形成一个支架，使我们能够将所有数据集拼接成一个单一、全面的参考图谱。然后，这个图谱可以用来在任何新实验中自动分类细胞，这个过程被称为“标签转移”，极大地加速了研究并规范了我们对整个科学界细胞类型的理解。

### 统一组学：多模态生物学的框架

细胞生物学的最终前沿是不仅通过基因，而是通过一个能够同时捕捉其所有分子层的统一视角来理解细胞。一个单细胞就是一个信息宇宙：其可及的染色质（“[表观基因组](@entry_id:272005)”，即哪些基因*可以*表达），其RNA转录本（“转录组”，即哪些基因*正在*表达），以及其蛋白质（“蛋白质组”，即功能性机器）。这就是多组学的世界。

整合这些不同的“组学”层是一项巨大的挑战，因为每种数据类型都有其独特的统计特性。RNA计数是过度离散的整数。来自抗体的蛋白质测量值是连续且具有成分性的。[染色质可及性](@entry_id:163510)数据极其稀疏，几乎是二元的 [@problem_id:3330211] [@problem_id:5214387]。你不能简单地将这些数字混合在一起。

SCTransform的哲学提供了统一的原则。对于每种模态，我们必须首先建立一个尊重其原生生成过程的[统计模型](@entry_id:755400)，使我们能够将技术噪声与生物学[信号分离](@entry_id:754831)开来。对于RNA，我们使用SCTransform的正则化负[二项模型](@entry_id:275034)。对于[蛋白质组学](@entry_id:155660)，我们可能会使用中心对数比 (CLR) 变换，这适用于[成分数据](@entry_id:153479)。对于[ATAC-seq](@entry_id:169892)，[词频-逆文档频率](@entry_id:634366) ([TF-IDF](@entry_id:634366)) 变换是一种常见且有效的选择 [@problem_id:5062692] [@problem_id:5214387]。

这个原则——基于模型的归一化——是如此基础，以至于它构成了当今用于数据整合的最先进深度学习方法的概念核心。像scVI和multiVI这样的工具使用复杂的[变分自编码器](@entry_id:177996)，但它们的核心是为RNA数据采用零膨胀负二项 (ZINB) 似然——这是SCTransform中使用模型的直接扩展。它们明确地将文库大小作为协变量来考虑，就像SCTransform所做的那样 [@problem_id:5214387] [@problem_id:5062692]。从某种意义上说，这些强大、包罗万象的模型是SCTransform的直接思想后裔。

从一个简单、优雅的计数[统计模型](@entry_id:755400)出发，我们的旅程向[外延](@entry_id:161930)伸。我们已经看到这一个思想如何让我们为基因表达创造一种新的、更忠实的语言，绘制我们组织错综复杂的地理图，协调全球科学界的工作，并最终为统一存在于单个细胞内的多样分子世界提供概念支架。这就是一个强大科学思想的内在美：它能从复杂性中创造出清晰和统一。