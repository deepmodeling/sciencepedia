## 引言
[单细胞RNA测序 (scRNA-seq)](@entry_id:754902) 为我们探索错综复杂的生物学世界打开了一扇新窗，使我们能够以前所未有的规模分析单个细胞的基因表达谱。然而，这项强大的技术也带来了固有的技术挑战。细胞间的[测序深度](@entry_id:178191)差异和组成偏差会产生显著的噪声，扭曲数据，使我们难以从纯粹的技术性人为因素中辨别出真实的生物学差异。虽然存在一些简单的归一化方法，但它们往往效果不佳，甚至会引入自身的[统计偏差](@entry_id:275818)，从而误导分析。本文旨在填补这一关键空白，深入探讨SCTransform这一现代而稳健的归一化框架。在接下来的章节中，我们将首先探讨SCTransform的**原理与机制**，解构其统计学基础，以理解它如何有效地建模并去除技术噪声。随后，我们将通过一览其**应用与跨学科联系**来审视其变革性影响，展示这一优雅的方法如何推动[空间组学](@entry_id:156223)、数据整合等前沿研究。

## 原理与机制

要真正理解一个细胞的运作方式，我们必须首先学会倾听它。[单细胞RNA测序](@entry_id:142269)就是我们的麦克风，它将细胞的内心独白——即其基因表达——转化为我们可以分析的数据。但这支麦克风并不完美。想象一下，你想欣赏一场交响乐，但录音设备的音量会为每位音乐家随意地调整。一个小提琴手的声音可能震耳欲聋，而一个大提琴手的声音却微弱得几乎听不见，这并非因为他们的演奏水平，而是由于技术性人为因素。这就是[单细胞分析](@entry_id:274805)中**测序深度**的挑战：每个细胞被“测序”的深度不同，从而产生不同总数的转录本分子，即**[唯一分子标识符 (UMI)](@entry_id:265196)**。一个拥有10,000个UMI的细胞，其大多数基因的计数自然会比一个只有2,000个UMI的细胞高，即便它们的内在生物学状态完全相同 [@problem_id:3348625]。

使问题进一步复杂化的是一个更微妙的问题，称为**组成偏差**。如果一个细胞中的少数基因异常活跃——例如，一个细胞的免疫应答基因处于超负荷工作状态——它们可能会消耗大部分的测序“带宽”。这会导致在简单的归一化之后，所有其他基因的表达看起来都降低了，即便它们的真实表达水平并未改变。这是诸如“每百万计数”(CPM) 这类基本缩放方法的一个根本局限，这些方法假定技术缩放因子对每个基因都相同，并且不受少数几个显性基因的影响 [@problem_id:4381636, 2967167]。因此，我们的首要任务是开发一种能够解释这些失真的“倾听”方法，让我们能够听到细胞真实的音乐。

### 简单对数变换的诱惑与缺陷

解决[测序深度](@entry_id:178191)问题最直观的方法是将每个基因的计数除以其所在细胞的总计数，然后取对数，这个过程通常被称为**对数归一化**。一个典型的公式是 $y = \ln(1 + \frac{\text{count}}{\text{total count}} \times \text{scale factor})$。这看起来很合理；它考虑了测序深度，并且对数函数可以“驯服”基因表达的巨大尺度差异，防止高表达基因在分析中占据主导地位。

然而，这个看似优雅的解决方案背后隐藏着一个统计陷阱。测序行为是一个随机抽样过程，这意味着一个基因计数的变异性（或方差）与其平均值（或均值）内在地联系在一起。对于计数非常低的基因——这在单细胞数据中很常见——其方差也很低。不幸的是，对数函数在零附近的曲线非常陡峭。当应用于这些低计数基因时，它会人为地夸大它们相对于高表达基因的方差 [@problem_id:4991035]。结果是，我们细胞交响乐中最安静的乐器听起来却成了最嘈杂的，这可能会误导我们寻找真实的生物学差异 [@problem_id:2268240]。这种方法只是治标不治本，未能解决数据根本的统计学特性问题。

### 模拟计数的真实本质

与其简单地转换现有数据，一种更深刻的方法是建立一个模型来描述数据最初是如何生成的。什么样的统计过程会产生UMI计数呢？

第一个猜测可能是**泊松分布**，它描述了在固定区间内，如果事件以已知的恒定平均速率发生，那么发生给定数量事件的概率。这捕捉了测序的随机抽样特性。然而，当我们观察真实数据时，我们发现方差几乎总是大于均值，这种现象称为**[过度离散](@entry_id:263748)**。一个简单的泊松模型（其中方差等于均值）根本不适用。

这种额外方差的来源是生物学本身。一个基因在细胞中的“真实”表达水平不是一个固定的、静态的数字；它会因[转录爆发](@entry_id:156205)、细胞周期效应和其他随机生物过程而波动。一个巧妙的捕捉方式是想象一个两步过程，通常称为**泊松-伽马混合**模型 [@problem_id:2851238]。首先，大自然从一个连续的可能性分布（伽马分布）中为基因选择一个“速率”。然后，我们的测序仪根据该速率对转录本进行抽样（泊松过程）。这个复合过程的结果是另一种分布，即**负二项 (NB) 分布**。

负[二项模型](@entry_id:275034)的美妙之处在于其方差函数 $\mathrm{Var}(Y) = \mu + \frac{\mu^2}{\theta}$ 能够自然地捕捉[过度离散](@entry_id:263748)。方差是一个类泊松项 ($\mu$) 和一个额外项 ($\frac{\mu^2}{\theta}$) 的和，后者代表由基因特异性**离散参数** $\theta$ 控制的生物学和技术变异性。通过使用负二项分布，我们不仅仅是在操纵数字，更是在接纳一个更忠实于细胞的统计学故事 [@problem_id:4991035, 3339429]。

### SCTransform：构建模型以剥离噪声

这就是 **SCTransform** 发挥作用的地方。它不仅仅是一个归一化公式，而是一个为每个基因构建[统计模型](@entry_id:755400)的框架。其目标简单而强大：对基因表达中可由技术因素预测的部分进行建模，而剩下的部分——模型*无法*解释的部分——就是我们感兴趣的生物学变异。

对于每个基因，SCTransform 拟合一个**[广义线性模型 (GLM)](@entry_id:749787)**。你可以把GLM看作是[数据拟合](@entry_id:149007)直线的一个复杂版本。在这里，我们不是将直线拟合到计数本身，而是拟合到其[期望值](@entry_id:150961)的对数。对于细胞 $i$ 中的基因 $g$，其模型形式如下：

$$
\ln(\mu_{gi}) = \beta_{g0} + \beta_{g1} \ln(\text{depth}_i)
$$

此处，$\mu_{gi}$ 是我们试图预测的[期望计数](@entry_id:162854)。细胞的测序深度是预测变量。该模型对每个基因有两个关键参数：$\beta_{g0}$ 代表基因的基线表达水平，而 $\beta_{g1}$ 则捕捉了该特定基因的检测如何随测序深度敏感地变化 [@problem_id:3339429, 4339924]。一个关键的创新是，SCTransform 为每个基因学习一个独特的 $\beta_{g1}$，承认并非所有基因都以相同的方式受[测序深度](@entry_id:178191)影响。这相比于那些隐含地假设所有基因都具有通用缩放关系 ($\beta_g = 1$) 的简单方法，是一个重大进步 [@problem_id:4381636]。

### 残差之美：分离生物学信号

一旦我们有了这个模型，我们就可以纯粹基于测序深度来预测任何给定细胞中一个基因的[期望计数](@entry_id:162854)。*观测*到的计数与这个*期望*的技术计数之间的差异就是**残差**。这个残差本质上就是我们一直在寻找的生物学信号，现在已从技术噪声中解脱出来。

然而，原始残差 ($y_{gi} - \hat{\mu}_{gi}$) 仍然受均值-方差依赖性的影响。对于一个[期望计数](@entry_id:162854)为2的基因来说，5个计数的残差远比对于一个[期望计数](@entry_id:162854)为100的基因来说更为显著。为了解决这个问题，SCTransform 计算**皮尔逊残差**。其公式非常优雅：

$$
r_{gi} = \frac{y_{gi} - \hat{\mu}_{gi}}{\sqrt{\widehat{\mathrm{Var}}(y_{gi})}} = \frac{y_{gi} - \hat{\mu}_{gi}}{\sqrt{\hat{\mu}_{gi} + \frac{\hat{\mu}_{gi}^2}{\hat{\theta}_g}}}
$$

简单来说，我们是用原始残差除以模型对该观测值预测的标准差来进行缩放 [@problem_id:4608298]。这个操作的神奇之处在于，无论基因的平均表达水平如何，所得到的皮尔逊残差的方差都稳定在约等于1的水平 [@problem_id:4382144]。例如，对于一个细胞中的某个基因，我们观测到18个UMI，而我们的模型预测为14.9，那么原始残差为3.1。用模型估计的标准差4.7进行缩放后，我们得到最终的归一化值，即皮尔逊残差，约为0.66 [@problem_id:2851238]。这些残差就是SCTransform的最终输出：干净、方差稳定的值，可直接用于下游分析。

### 群体的智慧：通过正则化增强稳健性

这个优雅的拼图还有最后一块。当为每一个基因拟合模型时，我们会遇到一个问题：对于那些只在少数细胞中检测到的基因该怎么办？这些稀疏基因的参数估计可能充满噪声且不可靠。

SCTransform 通过**正则化**解决了这个问题，这是一种巧妙的统计技术，可以被描述为“跨基因[借力](@entry_id:167067)” [@problem_id:4339924]。SCTransform 并非孤立地处理每个基因，而是首先观察所有基因中某个参数（如离散参数 $\theta$ 或斜率 $\beta_1$）与基因平均丰度之间的总体关系，学习出一个平滑、稳定的趋势。然后，对于每个单独的基因，它会计算一个直接估计值，但会将其“收缩”到这个全局趋势上。这个过程减少了低表达基因[参数估计](@entry_id:139349)中的噪声，防止模型对技术噪声“[过拟合](@entry_id:139093)”，并确保最终的归一化在整个[转录组](@entry_id:274025)中都是稳健和可靠的 [@problem_id:4608298]。

### 眼见为实：真实性检验

我们如何知道这种复杂的建模方法真的比简单方法更好呢？我们可以利用基因组本身设计一个对照实验。科学家们确定了两组基因：**[看家基因](@entry_id:197045)**，它们被期望在大多数细胞中稳定表达；以及生物学上可变的基因，如**细胞周期基因**。

归一化后，[看家基因](@entry_id:197045)理想情况下应表现出接近零的方差，并且与测序深度没有相关性——任何剩余的变异都可能是未校正的技术噪声。另一方面，细胞周期基因应保留高方差，以反映其真实的生物学作用。当进行这项测试时，结果是惊人的。像对数归一化这样的方法通常会在[看家基因](@entry_id:197045)的表达与测序深度之间留下明显的残余相关性。相比之下，SCTransform对这些相同基因的残差是平坦的，与测序深度几乎没有相关性。同时，它保留了细胞周期基因的高方差。这表明该模型成功地完成了它的工作：将技术的嘈杂声与生物学的交响乐分离开来，让我们最终能够听到细胞真实的音乐 [@problem_id:2967167]。

