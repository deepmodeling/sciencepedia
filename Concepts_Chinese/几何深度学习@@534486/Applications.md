## 应用与跨学科联系

我们花了一些时间来理解[几何深度学习](@article_id:640767)的运作机制，即这个关于[消息传递](@article_id:340415)和局部聚合的优雅[范式](@article_id:329204)。这是一套优美的理论。但任何科学思想的真正考验，那件真正激动人心的事情，不仅在于其内在的优雅，更在于它描述我们周围世界的力量。我们可以在哪里*应用*这些思想？它们能打开哪些新的窗口？

事实证明，世界充满了各种各样的图，而我们讨论的这些原理并非某个特定问题的“小众”工具。对于现代科学家和工程师来说，它们简直就是一把名副其实的瑞士军刀。我们即将开始一段短暂的旅程——从分子的无形之舞到支撑我们社会的庞大网络——在每一站，我们都将看到我们熟悉的朋友——[消息传递](@article_id:340415)神经网络——以一种全新而令人惊讶的方式展现其效用。

### 分子与物质的语言

也许最自然的起点是化学，这门研究原子如何连接形成我们所见物质的科学。分子*就是*一个图。原子是节点，[化学键](@article_id:305517)是边。这简直是天作之合！我们可以将这个图输入GNN，来预测分子的性质，比如它的稳定性、颜色，或者它是否会成为一种有用的药物。

但一个简单的连接图并不能说明全部问题。考虑两种著名的分子：苯（benzene）和环己烷（cyclohexane）。如果你只画出节点（碳原子）和它们的连接，它们看起来是一样的：一个由六个节点组成的简单环，每个节点有两个邻居。一个天真的、对[化学键](@article_id:305517)性质一无所知的GNN会认为它们是相同的，并预测出相同的性质。但化学家会告诉你，具有交替单双键的苯是一个扁平、稳定、芳香性的分子，而环己烷则是一个可扭曲的非[芳香性](@article_id:304929)环。它们天差地别！

这个简单的例子揭示了一个深刻的道理：重要的不仅是你与*谁*相连，还有你*如何*相连。因此，一个复杂的GNN不仅要能读取节点，还必须能读取*边*。通过为边分配特征——在本例中是“[单键](@article_id:367684)”或“双键”的标签——网络可以学习到在不同类型的[化学键](@article_id:305517)上传递不同的消息。突然之间，对称性以一种具有化学意义的方式被打破，GNN便能区分苯和环己烷，从而解锁了预测那些依赖于[化学键合](@article_id:298665)精妙艺术的属性的能力 [@problem_id:3189893]。

凭借这种读取[分子结构](@article_id:300554)的能力，我们可以应对医学领域的一大挑战：药物发现。寻找一种新药就像在一个宇宙尺度上解决一个配对问题。你体内有一个导致疾病的目标蛋白质，你需要找到一个能够完美结合并使其失活的小分子（即药物）。

GNN如何提供帮助？我们可以构建一个多模态架构。模型的一部分，可能是一个一维[卷积神经网络](@article_id:357845)，可以处理蛋白质的氨基酸序列。另一部分，一个GNN，可以处理候选药物的分子图。每个模型都学习生成一个紧凑的数字“指纹”——一个代表蛋白质和分子基本特征的向量。最后一步就是简单地比较这两个指纹，以预测它们的结合亲和力，即它们连接的强度 [@problem_id:1426763]。我们甚至可以将其扩展到*多靶点药理学 (polypharmacology)*的问题，即同时测试一种药物分子对数百种不同蛋白质靶点的效果，从而创建其潜在效果和副作用的全面档案 [@problem_id:2395415]。

### 从分子到组织：生命的蓝图

让我们把视野拉远。如果说分子是字母，那么组织和器官就是小说。一项名为*[空间转录组学](@article_id:333797) (spatial transcriptomics)*的新技术让生物学家能够取下一片组织——比如说，从小鼠大脑中——并在数千个不同的微观位置测量数千个基因的活性。结果是一张细节惊人的基因活动图谱，但这只是一片数据的海洋。真正的目标是识别不同的功能区域，比如皮层的不同层次。

在这里，图再次提供了完美的视角。我们可以将数据集建模为一个巨大的图，其中每个空间位置是一个节点，并附有其基因表达数据的向量。我们用边连接相邻的节点。当我们应用GNN时，[消息传递](@article_id:340415)机制就像一个自然的[扩散过程](@article_id:349878)。一个位点的基因表达谱会“[渗透](@article_id:361061)”到其邻居中。如果大脑的某个区域具有一致的功能，其各个位点的基因表达模式就会相似。GNN的扩散过程会将它们平均在一起，强化它们的共同特性，使整个区域更加均一。

这个过程完美地突显了区域之间的边界，因为在边界处传递的“消息”非常不同。当然，这里也存在一个危险。如果我们让扩散进行太多步——即堆叠太多GNN层——我们就会遇到*过平滑*的问题。信息[扩散](@article_id:327616)得太远，以至于整个图谱模糊成一个单一、均匀的平均值，所有宝贵的解剖学细节都丢失了。在获取广阔背景和保留局部细节之间的这种权衡，是GNN设计中的一个根本性挑战。更先进的模型甚至使用*注意力机制 (attention mechanisms)*来学习忽略来自似乎属于不同区域的邻居的消息，从而有效地学习尊重这些边界 [@problem_id:2752979]。

### 社会结构：人、产品与思想的网络

现在，让我们从生物学跨越到社会学。一个社交网络不就是一个由人（节点）和他们的友谊（边）构成的图吗？信息的传播——无论是一个有趣的猫咪视频、一个政治谣言，还是一场营销活动——都是一个在这个图上传播的信号。我们可以使用GNN来模拟这个过程，把网络看作一个“宏观分子” [@problem_id:2395418]。通过在少数节点上播种一条信息，我们可以运行[消息传递算法](@article_id:325957)来预测最终会有多少人接收到它。

这一原则一个既有趣又具有巨大商业价值的应用是[推荐系统](@article_id:351916)，这些是驱动在线购物和流媒体服务的引擎。我们可以构建一个包含两类节点的*二分图 (bipartite graph)*：用户和物品。如果一个用户购买、观看或喜欢了某个物品，那么该用户和该物品之间就存在一条边。

当我们将GNN应用于这个图时，[消息传递](@article_id:340415)就变成了一种强大的自动化推理形式，称为[协同过滤](@article_id:638199)。经过一步[消息传递](@article_id:340415)，一个物品的表示会根据喜欢它的用户的信息进行更新。一个用户的表示会根据他们喜欢的物品的信息进行更新。经过第二步，一个用户的表示会受到喜欢*相同物品*的*其他用户*的影响。再经过第三步，该用户又会受到那些其他用户喜欢的物品的影响。这种“品味”在网络中的传播，使得系统能够推荐用户从未见过、但相似用户却很喜欢的物品。这就像是自动化的、大规模的口碑传播 [@problem_id:3167496]。

### 工程化我们的世界：从电网到动态系统

GNN的应用范围甚至延伸到支撑我们现代生活的物理基础设施。考虑一个国家的电网。它是一个由发电站和变电站（节点）通过输电线路（边）连接而成的图。我们可以使用GNN来监控这个电网的健康状况，预测可能导致连锁性大停电的过载风险。每个节点的特征可能是当前的电力负荷，而GNN则学习扰动如何在系统中传播。

有趣的是，这与经典的图[算法](@article_id:331821)联系在了一起。一些[GNN架构](@article_id:641692)，如Approximate Personalized Propagation of Neural Predictions (APPNP)，在数学上与最初驱动谷歌搜索引擎的著名[PageRank算法](@article_id:298840)有关。这些GNN中的迭代更新就像在[图上的随机游走](@article_id:337381)，但带有一个“传送”概率，不断地将信息[拉回](@article_id:321220)到其起始节点。这可以防止信号[扩散](@article_id:327616)得太远——这正是我们在脑组织分析中看到的过平滑问题，现在通过一个来自网络搜索的技巧得以解决，以确保电网稳定性预测保持局部化和相关性 [@problem_id:3106169]。

最后，对于那些并非静态的系统呢？社交网络在演变，交通模式在变化，金融市场在波动。真实世界是动态的。通过引入时间，GNN可以被扩展来处理这种情况。可以为边赋予时间戳，而[消息传递](@article_id:340415)函数可以学习赋予近期交互比陈旧交互更高的权重，例如使用[指数时间](@article_id:329367)衰减。这使得GNN能够对一个不断变化的系统当前的状态进行建模，并基于最新的可用信息做出预测 [@problem_id:3106150]。

从最小的分子到最大的社会结构，世界是由一张关系网编织而成的。[几何深度学习](@article_id:640767)为我们提供了一种强大而统一的语言来理解这种互联性。它证明了一个观点：一个单一、优美的数学原理可以阐明各种各样令[人眼](@article_id:343903)花缭乱的难题，揭示出支配我们宇宙的隐藏几何秩序。