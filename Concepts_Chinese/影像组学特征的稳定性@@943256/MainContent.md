## 引言
影像组学，即从医学图像中高通量提取定量特征，有望揭示关于患者潜在生物学特性的海量信息，可能在诊断、预后和治疗计划方面带来革命性变革。然而，这一前景建立在一个关键假设之上：我们测量的特征反映的是患者本身，而不是测量过程。任何影像组学模型的预测能力都从根本上受到特征不稳定性的威胁。这是一个严峻的挑战，即特征值会因扫描仪设置、患者体位或[图像处理](@entry_id:276975)选择等技术因素而变化，而非因真实的生物学变化。一个建立在不稳定特征之上的模型如同纸牌屋，一旦应用于新数据便注定会崩塌。

本文旨在解决这一根本性问题，为理解、测量和确保影像组学特征的稳定性提供全面指南。我们将探讨如何在可靠且可重复的测量基石上构建定量模型。以下各节将引导您了解核心概念及其实际重要性。在“原理与机制”部分，我们将解构不稳定性的来源，从图像形成的物理学到用于量化稳定性的统计工具，如组内[相关系数](@entry_id:147037)（ICC）。接下来，在“应用与跨学科联系”部分，我们将阐明为什么稳定性是在多中心研究、临床试验中成功应用影像组学，并最终构建可安全部署以改善患者护理的可信赖医学人工智能的必要条件。

## 原理与机制

想象一下，你是一位正在研究一块奇特岩石的地质学家。你拍了一张高分辨率照片来分析其错综复杂晶体图案。然后，你把这块岩石交给一位同事，他也用自己的相机拍了一张照片。当你们比较这两张照片时，发现它们并不完全相同。光线略有不同，焦点不完全一致，角度也有些微偏差。虽然两张照片都清楚地显示了同一块岩石，但这些细微的差异意味着你进行的任何测量——比如平均亮度或晶体边缘的锐度——都会略有不同。

这正是影像组学面临的核心挑战。**影像组学特征**是我们从医学图像（如肿瘤的[CT扫描](@entry_id:747639)）中计算出的一个或一组数字。我们希望这个数字能告诉我们关于肿瘤生物学特性的信息——它的侵袭性、基因构成、对治疗的可能反应。但就像那两张岩石照片一样，对同一个肿瘤的两次扫描永远不会完全相同。如果我们计算出的特征值从一次扫描到下一次扫描发生剧烈变化，那它更多地反映了相机而非岩石的信息。这样的特征如同建立在沙滩上的数字，无法用于做出可靠的预测。对**影像组学特征稳定性**的追求，就是寻找那些能告诉我们关于岩石而非相机信息的特征。

### 物理学家眼中的图像

要理解为什么特征会不稳定，我们必须首先理解医学图像的真正含义。它并非现实的完美照片。一个更准确的描述，借鉴自物理学和工程学领域，如下所示 [@problem_id:4558036] [@problem_id:4405437]：

$$
g(\mathbf{r}) = (h * f)(\mathbf{r}) + n(\mathbf{r})
$$

我们不必被这个数学公式吓倒；它讲述了一个简单而直观的故事。

$f(\mathbf{r})$ 项是我们试图观察的“真相”——在空间中每一点 $\mathbf{r}$ 处患者组织的实际物理特性。对于[CT扫描](@entry_id:747639)，这将是不同组织吸收X射线情况的图谱。这是我们所追求的生物学信息。

$h(\mathbf{r})$ 项是**点扩散函数 (PSF)**。可以把它看作是成像系统固有的“模糊度”。每一台相机、每一台扫描仪的清晰度都有其极限。这就像用一个稍微失焦的镜头拍照。这种[模糊化](@entry_id:260771)是一个物理过程，即卷积（用 $*$ 符号表示），它将邻近的点平均在一起。更宽的PSF意味着更强的模糊效果。这实际上可能会产生令人惊讶的效果：通过平滑图像，它可以减少随机噪声的影响，从而可能使某些特征*更加*稳定。然而，这样做的代价是抹去了我们可能感兴趣的非常精细的细节和纹理 [@problem_id:4558036]。这是一个经典的**偏倚-方差权衡**：我们用一些真实性（偏倚）来换取更高的稳定性（更少的方差）。

最后，$n(\mathbf{r})$ 是**噪声**，即困扰任何测量的随机静电干扰。它从何而来？在CT扫描仪中，它源于光的量子性质。扫描仪本质上是在计数穿过身体的X射线光子。这个[计数过程](@entry_id:260664)遵循**泊松统计**，意味着存在固有的随机性。如果你拥有的光子非常少（低剂量扫描），随机性会更加明显，**[信噪比 (SNR)](@entry_id:271861)** 也就很低。在MRI中，噪声来自不同的来源——患者和电子设备中的[热波](@entry_id:167489)动——并且它遵循不同的统计模式，通常用**莱斯分布**来描述 [@problem_id:4531324]。无论哪种情况，这种噪声都会给图像增添虚假的随机模式，从而可能人为地抬高衡量复杂性或异质性的特征值（如纹理特征），使其可靠性降低 [@problem_id:4558036]。

为了完整地描绘这幅图景，这个连续的物理现实随后被采样并分割成离散的图像元素网格，即**体素**。如果体素不是完美的立方体——例如，如果切片厚度远大于平面内像素尺寸——我们得到的便是一幅**各向异性**的图像。这会拉伸和扭曲几何形状，使我们试图计算的任何3D特征产生偏倚 [@problem_id:4558036]。

### 稳定性的词汇

既然我们了解了图像可能独立于患者生物学特性而变化的多种方式，我们就可以更精确地定义我们的术语。影像组学界借鉴测量科学的词汇，使用一套特定的术语来描述稳定性 [@problem_id:4538485]。

**可重复性 (Repeatability)** 回答了这样一个问题：如果我在几分钟内用*同一台扫描仪*对同一位患者进行扫描，特征值的一致性如何？这是一个“测试-再测试”实验。这里变异的主要来源是随机噪声 $n(\mathbf{r})$。

**[可再现性](@entry_id:151299) (Reproducibility)** 则提出了一个更难的问题：如果我用*不同的扫描仪*，或许在不同的医院，对同一位患者进行扫描，特征值的一致性如何？现在，我们不仅要处理随机噪声，还要应对扫描仪模糊度 ($h(\mathbf{r})$) 和其他采集设置的系统性差异。一个特征可能具有很高的可重复性（对噪声稳定），但如果它对扫描仪的具体品牌和型号敏感，其[可再现性](@entry_id:151299)可能很差。

**稳健性 (Robustness)** 是一个更宽泛、更实用的术语。它指的是一个特征对一系列小的、现实的扰动不敏感：患者体位的轻微移动、扫描仪校准的微小差异，或感兴趣区域绘制方式的细微变化。本质上，一个稳健的特征是不会被现实世界临床实践中不可避免的混乱所影响的特征。

### 如何衡量稳定性：ICC

为了从概念走向实践，我们需要一个数字——一个能告诉我们特征稳定程度的度量标准。最强大且被广泛使用的度量标准是**组内[相关系数](@entry_id:147037) (Intraclass Correlation Coefficient, ICC)**。

ICC背后的思想非常简单。想象一下我们有一组来自测试-再测试研究的特征数据。我们在这些数字中观察到的总变异来自两个来源：
1. **受试者间方差** ($\sigma^2_{\text{between-subject}}$): 这是“好的”变异。它反映了患者之间真实的、真正的生物学差异。这是我们想要测量的信号。
2. **受试者内方差** ($\sigma^2_{\text{within-subject}}$): 这是“坏的”变异。它反映了测量误差，即同一患者测试和再测试扫描之间的随机波动。这是我们想要最小化的噪声。

ICC 就是好的变异与总变异的比率 [@problem_id:4558825] [@problem_id:4545725]：

$$ \text{ICC} = \frac{\sigma^2_{\text{between-subject}}}{\sigma^2_{\text{between-subject}} + \sigma^2_{\text{within-subject}}} $$

ICC 的值在 $0$ 和 $1$ 之间。ICC 为 $1$ 意味着所有变异都源于受试者之间的真实差异（零测量误差），表明具有完美的稳定性。ICC 为 $0$ 意味着所有变异都只是随机噪声，该特征毫无用处。在实践中，影像组学研究人员通常寻找 ICC 值为 $0.85$ 或更高的特征。例如，如果一个特征的受试者间方差为 $\sigma^2_{\text{between-subject}}=4.0$，受试者内方差为 $\sigma^2_{\text{within-subject}}=1.0$，其可靠性为 $\text{ICC} = 4.0 / (4.0+1.0) = 0.80$，这被认为是良好的 [@problem_id:4558825]。

但这里有一个微妙而重要的细节。如果一台扫描仪产生的特征值始终比另一台扫描仪高出，比如说，4个单位，该怎么办？患者的排序可能完全保持不变，但绝对值却不同。这种情况应该被视为不佳吗？这引出了两种类型的ICC [@problem_id:4547477]：
- **一致性ICC (ICC for Consistency)**：此版本忽略了数值上的系统性偏移。它只关心患者是否按相同的顺序排列。在我们那个存在4个单位恒定偏移的例子中，一致性ICC将是完美的 $1.0$。
- **绝对一致性ICC (ICC for Absolute Agreement)**：此版本会对系统性偏移进行惩罚。它要求数值本身也必须相同。在我们的例子中，绝对一致性ICC将小于 $1.0$。

为了使一个影像组学特征在临床模型中有用，无论使用哪种扫描仪，其值都应具有相同的含义。因此，我们几乎总是关心**绝对一致性**。

### 不稳定性的链条

不稳定性并非源于单一之处。它是一条潜在错误的链条，从患者躺在扫描床上开始，到最终的特征值结束。

**1. 分割（划定边界）：** 在我们计算特征之前，专家——放射科医生——或算法必须在感兴趣区域（ROI），如肿瘤周围，划定一个边界。这个过程称为**分割**，是变异性的一个巨大来源。没有哪两位专家会画出完全相同的边界线。我们如何量化这种不一致性？我们使用两个主要指标 [@problem_id:4567851]：
- **Dice相似系数 (DSC)** 衡量两个分割区域之间的重叠百分比。DSC为 $0.82$ 可能听起来不错，表明有 $82\%$ 的重叠。
- 但**[豪斯多夫距离](@entry_id:152367) (HD)** 讲述了一个更具警示性的故事。它衡量的是*最坏情况*下的不一致性——即一个边界上的某个点到另一个边界上最近点的最大距离。你可能有一个良好的整体重叠（高DSC），但一个单一的、大的局部不一致却导致巨大的HD，比如 $12\,\mathrm{mm}$。这种大的局部误差会对依赖于边界形状或边缘附近纹理的特征造成严重破坏。

**2. 图像处理（数字暗房）：** 临床图像在[特征提取](@entry_id:164394)前通常需要进行处理。这些步骤是另一个变异来源。
- **重采样：** 由于许多CT扫描是各向异性的，一个常见的首要步骤是将图像[重采样](@entry_id:142583)到一个各向同性的网格上。但你如何填充新的体素值呢？**插值**方法的选择至关重要。使用最近的现有体素（**最近邻**插值）速度快，但会产生块状伪影。使用邻近体素的加权平均（**线性插值**）更平滑、更稳定。使用更复杂的方法，如**三次[B样条](@entry_id:172303)**插值，可以进一步提高稳定性，但存在过度模糊图像以至于抹去真实生物纹理的风险 [@problem_id:4569131]。
- **归一化和离散化：** 纹理特征通常是在将体素强度分组到固定数量的区间后计算的。你如何预先归一化强度以及这些区间的宽度，都会产生显著影响。矛盾的是，某些处理步骤可以*增加*稳定性。例如，在每次扫描内部对强度进行标准化（z-score归一化）并使用较粗的[区间划分](@entry_id:264619)，可以消除扫描仪特定的偏倚并抑制噪声。这可能会使受试者内方差 ($\sigma^2_{\text{within-subject}}$) 的减少程度远大于受试者间方差 ($\sigma^2_{\text{between-subject}}$) 的减少，从而导致更高、更好的ICC [@problem_id:4545725]。

### 稳健性的秘诀

那么，我们如何才能构建一个可以信赖的影像组学特征签名呢？我们必须使用经过严格稳定性测试的特征来构建它。这个过程就像对一种新的工程材料进行“压力测试”[@problem_id:4531372]。

1. **标准化：** 首先将所有图像[重采样](@entry_id:142583)到一个统一的、各向同性的网格上。仔细考虑你的插值选择（例如，对图像使用[平滑方法](@entry_id:754982)如[三次样条插值](@entry_id:146953)，但对分割掩模使用最近邻插值以保留其标签）。

2. **扰动：** 为每位患者的图像创建一组略微改动的副本。这些扰动应该很小，并模仿现实世界中的变异。它们应以物理单位（毫米和度）而不是体素来定义，以便在不同分辨率下保持一致。
    -   应用小的平移（$\pm 2$ mm）和旋转（$\pm 3^\circ$）来模拟患者体位的轻微变化。
    -   应用细微的强度[抖动](@entry_id:262829)（例如，缩放$\pm 5\%$，增加$\pm 10$ Hounsfield Units的偏移）来模拟扫描仪校准漂移。

3. **测量：** 在[原始图](@entry_id:262918)像和所有扰动副本上计算你的候选影像组学特征。

4. **评估：** 对每个特征，计算原始值和扰动值集合的ICC。这个单一的数字告诉你该特征在压力测试中受到的影响有多大。

通过仅选择那些以高ICC（例如，$\ge 0.85$）通过此测试的特征，我们就可以确信我们测量的是生物学特性，而不是噪声。这一严谨的过程是高质量影像组学研究的基石，并得到了像TRIPOD这样的报告指南的倡导 [@problem_id:4558825]。它确保了最终的模型不仅仅是一次性的奇特发现，而是在应用于新医院的新患者时有希望真正有效和有益——毕竟，这才是最终目标 [@problem_id:4405437]。稳定性不仅仅是一个技术细节；它是医学人工智能中科学有效性和伦理责任的基石。

