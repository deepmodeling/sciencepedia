## 应用与跨学科联系

既然我们已经探索了 Zuker [算法](@article_id:331821)那精美的钟表般的工作机制，你可能会以为我们的旅程已经结束。我们有了一台机器，它输入一串字母，通过[动态规划](@article_id:301549)的魔力，输出那个独一无二、最稳定的结构。这是一个对明确定义问题的优雅解决方案。但是，朋友们，这并非终点，而是起点。

真正的乐趣始于我们不再将[算法](@article_id:331821)视为僵化的配方，而是开始将其看作一个极具灵活性的工具——一个我们可以打磨、修改并与其他工具结合使用的透镜，用以探究关于生命世界更深层次的问题。我们学到的原理不仅是为找到一个结构；它们是通往理解 RNA 分子完整的、动态的生命历程，其功能、进化，以及其与细胞机器之间复杂舞蹈的大门。现在，让我们来探索这片更广阔的图景。

### 完善游戏规则：走向更真实的物理学

我们最初的模型，即每个允许的碱基对都贡献一个固定的能量，有点像说所有人类的友谊都有相同的强度。这是一个有用的初步近似，但我们知道现实更为微妙。我们的[动态规划](@article_id:301549)框架的美妙之处在于，我们可以轻松地教会它这些细微差别。

例如，[分子生物学](@article_id:300774)家几十年来一直知道，鸟嘌呤（G）和尿嘧啶（U）之间的所谓“摆动”配对是一种真实且重要的相互作用，但它在[热力学](@article_id:359663)上比经典的 G-C 对要弱。我们的[算法](@article_id:331821)能处理这个吗？当然可以！我们只需为 G-U 对分配一个与 G-C 或 A-U 对不同的、能量上不那么有利的值。[算法](@article_id:331821)的逻辑——通过尝试所有可能性找到最小能量——保持不变。它只是在一套更精细的规则下工作，从而得到更准确的预测 [@problem_id:2427192]。

这个原理的应用远不止于单一的配对类型。最先进的“最近邻”能量模型，被用于顶尖软件中，不仅仅为单个碱基对分配能量。它们为两个相邻碱基对的*堆积*分配能量，因为相邻碱基对的种类会强烈影响稳定性。我们基本的动态规划逻辑可以轻松适应这种增加的复杂性；这只意味着一个堆积对的能量项，$V(i,j) = E_{\mathrm{stack}} + V(i+1, j-1)$，变得依赖于[核苷酸](@article_id:339332) $(i, j)$ 和 $(i+1, j-1)$ 的具体种类。[最优子结构](@article_id:641370)的核心思想依然成立。

### 倾听分子：整合实验数据

一个纯理论模型，无论多么优雅，最终都必须面对实验现实的检验。我们如何检查预测的结构是否正确？更好的是，我们能否利用实验数据来*改进*我们的预测？

这时，一种名为 SHAPE（选择性 [2'-羟基](@article_id:331317)酰化引物延伸分析法）的卓越技术应运而生。从本质上讲，SHAPE 化学使我们能够探测一个 RNA 分子并测量每个[核苷酸](@article_id:339332)的“柔性”。位于松散单链区域的[核苷酸](@article_id:339332)反应强烈，而那些被锁定在刚性双螺旋中的[核苷酸](@article_id:339332)反应微弱。这为我们提供了序列中每个位置的“反应性得分”——这是关于 RNA 结构的直接实验线索。

现在，我们如何将这条线索与我们的能量模型融合呢？我们可以将 SHAPE 数据转化为物理学家所说的“伪能量”项。如果位置 $i$ 的[核苷酸](@article_id:339332)具有高 SHAPE 反应性 $r_i$，这强烈表明它是未配对的。因此，如果我们的[算法](@article_id:331821)试图形成一个涉及该[核苷酸](@article_id:339332)的配对，我们可以用一个额外的能量成本 $\Delta G_{\mathrm{SHAPE}}(i)$ 来惩罚它。一种常见的方法是使用一个简单的线性关系，$\Delta G_{\mathrm{SHAPE}}(i) = m \cdot r_i + b$，其中 $m$ 和 $b$ 是参数 [@problem_id:2848657]。这个惩罚被加到任何涉及[核苷酸](@article_id:339332) $i$ 的配对的能量中，从而使[算法](@article_id:331821)偏向于与实验数据一致的结构。

这个想法引出了与机器学习领域更强大的联系。斜率 $m$ 和截距 $b$ 的“最佳”值是什么？我们可以让数据来决定！我们可以尝试一系列不同的 $(m,b)$ 值，并对每一对值预测一个结构，然后测量其与 SHAPE 数据的一致性。产生最佳一致性的参数集就是我们选择的。通过这种方式，我们不仅在使用数据来约束一个模型；我们还在使用数据来*学习模型本身的参数* [@problem_id:2426772]。这种计算模型与高通量实验之间的协同作用是现代生物信息学的核心。

### RNA 世界并不孤单：相互作用与奇特结构

RNA 分子并非孤独的壁花；它们不断地与其他[分子相互作用](@article_id:327474)，甚至可以采取超出我们迄今为止所考虑的简单无[交叉](@article_id:315017)结构的形状。我们多功能的[动态规划](@article_id:301549)[算法](@article_id:331821)可以扩展到模拟这些现象。

一个绝佳的例子是**核糖开关**，这是一种 RNA 序列，当它与一个小分子（配体）结合时会改变其形状，从而作为开关来开启或关闭基因。我们如何模拟这个过程？想象一下，我们知道某个具有特定序列的[发夹环](@article_id:377571)构成了配体的结合口袋。我们可以修改我们的[算法](@article_id:331821)来识别这个基序。当它考虑形成那个确切的[发夹环](@article_id:377571)时，我们给它一个很大的、有利的能量*奖励*，$-\Delta G_{\mathrm{ligand}}$，代表配体结合带来的稳定化作用 [@problem_id:2406108]。然后，[算法](@article_id:331821)将正确预测，在配体存在的情况下，包含这个发夹[环的结构](@article_id:311324)更有可能形成。这为我们将[算法](@article_id:331821)用于合成生物学——[从头设计](@article_id:349957)定制的 RNA 开关——打开了大门。

此外，RNA 结构的“字母表”比我们最初想象的要丰富。一些富含 G 的序列可以折叠成一种完全不同类型的结构，称为 **G-四链体**，它涉及由四个鸟嘌呤碱[基组](@article_id:320713)成的堆叠平面。这些结构在调控基因表达中至关重要。我们的[算法](@article_id:331821)能否处理在规范二级结构和 G-四链体之间的选择？可以！动态规划的原理就是从一组可能性中做出最优选择。我们可以扩展这个集合。在序列的每一点，[算法](@article_id:331821)可以被设计为询问：在这里最好的做法是什么？让这个[核苷酸](@article_id:339332)不成对？将它与另一个配对？或者，也许，启动一个 G-四链体块的形成？[算法](@article_id:331821)只需计算每个选项的能量并选择最小值，从而将这个新的结构可能性无缝地整合到其寻找最稳定整体构象的搜索中 [@problem_id:2426849]。

### 从结构到功能：遗传学的语言

也许 RNA 结构预测最深远的应用在于将其与生命的核心过程联系起来：基因表达为蛋白质。遗传密码具有众所周知的简并性；例如，有六种不同的[密码子](@article_id:337745)都编码亮氨酸。很长一段时间里，人们认为这些“同义”[密码子](@article_id:337745)是可以互换的。我们现在知道这远非事实，而 RNA 结构是其主要原因之一。

将一个[密码子](@article_id:337745)从，比如说，CUU 改变为 CUG，不会改变最终的蛋白质，但它*确实*改变了 mRNA 序列。这种改变可以对局部的 mRNA 二级结构产生巨大影响。一个关键区域是**核糖体结合位点（RBS）**，即[核糖体](@article_id:307775)启动翻译的着陆平台。如果这个位点被锁在一个稳定的[发夹环](@article_id:377571)中，[核糖体](@article_id:307775)就无法结合，蛋白质也就永远不会被制造出来。

我们可以使用我们的折叠[算法](@article_id:331821)来量化这种效应。我们可以计算一个 mRNA 序列的[最小自由能](@article_id:348293)，$G_{\mathrm{MFE}}$。然后，我们可以再次运行该[算法](@article_id:331821)，但这次有一个约束：RBS 中的[核苷酸](@article_id:339332)被禁止配对。这会得到一个新的最小能量，$G_{\mathrm{open}}$。差值 $\Delta G_{\mathrm{open}} = G_{\mathrm{open}} - G_{\mathrm{MFE}}$ 就是“融化”RBS 处结构所需的能量成本。一个大的、正的 $\Delta G_{\mathrm{open}}$ 意味着 RBS 天然地被隔离在一个稳定的结构中，[翻译起始](@article_id:308544)可能很弱 [@problem_id:2768376]。这在同义密码子选择、mRNA 结构和最终的蛋白质合成速率之间提供了一个直接的物理联系 [@problem_id:2697501]。同样的结构原理甚至可以帮助解释更复杂的现象，作为预测如[程序性核糖体移码](@article_id:315564)等事件的更大模型中的一个关键组成部分 [@problem_id:2380302]。

### 系综视角与现代前沿：从单一结构到多种结构

到目前为止，我们一直专注于寻找具有*单一*[最小自由能](@article_id:348293)的结构。但这有点像物理学家的善意谎言。一个在给定温度下的分子是一个[热力学系统](@article_id:367854)；它不仅仅停留在其最低能量状态。它会波动，探索整个结构系综，在更稳定的结构中花费更多时间。MFE 结构是数量最多的状态，但其他稍不稳定的结构也可能数量众多，并且可能具有生物学重要性。

为了捕捉这个更丰富、更现实的画面，我们必须从最小化能量转向计算**配分函数**，$Z$。配分函数是*所有可能结构*的总和，其中每个结构 $S$ 都由其[玻尔兹曼因子](@article_id:301496) $\exp(-\beta E(S))$ 加权，其中 $\beta = 1/(k_B T)$。
$$
Z = \sum_{\text{all structures } S} \exp(-\beta E(S))
$$
这似乎是一个不可能完成的求和！但是，令人惊讶的是，对我们的[动态规划](@article_id:301549)[算法](@article_id:331821)进行巧妙的修改（由 John McCaskill 首次提出），可以在多项式时间内精确计算这个总和。

一旦我们有了[配分函数](@article_id:371907)，$Z$，一个全新的世界就此打开。我们可以计算系统处于任何给定状态的概率。更重要的是，我们可以计算特定碱基 $i$ 与特定碱基 $j$ 配对的概率，甚至只是碱基 $i$ 与*任何*其他碱基配对的总概率 [@problem_id:2426805]。这为我们提供了一个“配对[概率矩阵](@article_id:338505)”，它通常比单个 MFE 结构更可靠、信息更丰富。如果一个配对的概率为 $0.99$，我们可以非常有信心地认为它存在。如果它的概率为 $0.05$，它可能只是一个短暂、无足轻重的相互作用。

这把我们带到了绝对的前沿：利用人工智能设计新的生物系统。假设我们想训练一个深度神经网络来生成能折叠成特定目标结构的 RNA 序列。为了训练网络，我们需要一个“损失函数”——一个可微的度量，衡量我们生成的序列离目标有多远。MFE 是一个糟糕的选择，因为 `min` 函数在其能量景观中有尖锐的拐角，这会混淆[基于梯度的优化](@article_id:348458)器。但是配分函数，作为一个由[指数函数](@article_id:321821)构成的巨大平滑总和，是完美可微的！

这意味着我们可以基于[配分函数](@article_id:371907)构建一个损失函数——例如，一个基于目标结构的玻尔兹曼概率的惩罚项 [@problem_id:2749068]。然后我们可以计算这个损失的梯度，并将其*通过整个动态规划[算法](@article_id:331821)*反向传播回[神经网络](@article_id:305336)的参数中。这使得人工智能能够通过梯度下降来学习如何调整其[序列生成](@article_id:639866)规则，以产生在[热力学](@article_id:359663)上被编程为按需折叠的 RNA。这是经典[统计物理学](@article_id:303380)与[现代机器学习](@article_id:641462)的绝妙结合，所有这些都建立在我们最初那个简单而强大的[最优子结构](@article_id:641370)思想之上。从一个简单的折叠规则开始的旅程，已经将我们带到了设计生命本身的前沿。