## 引言
我们的基因组是一个由两卷书写成的故事，每一卷分别遗传自父母一方。虽然这两卷书几乎完全相同，但它们之间的细微差异——即等位基因，正是我们遗传独特性的来源。单条染色体上等位基因的完整序列被称为单倍型。确定哪些变异属于哪个亲本卷册——这一过程称为单倍型定相——是遗传学中的一个根本性挑战，具有深远的医学意义。错误地判断两个变异是在同一条染色体上（*顺式*）还是在不同染色体上（*反式*），可能导致[遗传病](@entry_id:273195)的误诊。本文探讨了一种旨在解决这一难题的强大技术：基于读长的定相。它超越了统计推断，转而使用来自 DNA 测序的直接物理证据。在接下来的章节中，我们将剖析基于读长的定相的“原理与机制”，将其与统计方法进行对比，并探索使其成为可能的技术。之后，我们将探讨其变革性的“应用与交叉学科联系”，揭示该方法如何解决诊断难题、揭示癌症动态，并深化我们对人类基因组的理解。

## 原理与机制

想象一下，你的基因组是一部关于“你”的、浩瀚的两卷本百科全书。第一卷遗传自你的父亲，第二卷遗传自你的母亲。它们讲述的故事大体相同，但有细微差异——这里改了一个词，那里换了一种拼写。这些变异就是让你在遗传上独一无二的等位基因。现在，假设我们把两卷书都撕碎，把书页混在一起，然后把这一堆交给你。对于任何给定的页码（一个遗传位点），你都拥有该页的两个版本（等位基因），但你丢失了一个关键信息：哪一页属于哪一卷？

这个谜题就是**单倍型定相**的本质。**单倍型**是指一对染色体中某一条上等位基因的完整、有序序列——它是一卷书的全文。从这堆杂乱的书页中重建出这两卷原书的过程就是定相。这不仅仅是一项学术活动；知道两个特定变異是在同一卷（*顺式*）还是不同卷（*反式*），可能关系到健康与[遗传病](@entry_id:273195)诊断之间的区别。那么，我们如何解开这个宏大的谜题？大自然给了我们线索，而人类的智慧设计出了两种精妙的策略来解读它们。

### 两条通往真相的路径：统计定相 vs. 基于读长的定相

第一种策略是利用群体的智慧。可以把它看作是**统计定相**。如果你想重建一部经典小说的两个略有不同的版本，你可以去一个巨大的图书馆——在遗传学术语中称为**参考面板**——那里藏有数千份来[自相似](@entry_id:274241)人群的、正确组装的版本。你会很快注意到，某些印刷错误（等位基因）往往以惊人的一致性在同一版本中同时出现。基因组上等位基因的这种非随机关联是[群体遗传学](@entry_id:146344)的一个基石，被称为**[连锁不平衡](@entry_id:146203)（LD）** [@problem_id:5016478]。通过观察这些模式，我们可以做出有力的、有根据的猜测。如果我们图书馆里 99% 含有印刷错误 'A' 的书，在几页之后也含有印刷错误 'B'，而你那堆混杂的书页中同时包含这两种错误，你就可以很有信心地推断它们属于同一卷。

这种方法非常强大，可以让我们对整个染色体进行定相。但它有一个致命弱点。如果你的个人百科全书包含一个全新的、独特的变异——一个**个体特有或新生（de novo）突变**——而这个变异以前从未见过，会怎么样？我们的参考面板库将毫无帮助。由于该变异在参考面板中不存在，没有预先存在的[连锁不平衡](@entry_id:146203)信息可以指导我们。在这些情况下，尤其是在理解罕见病时，统计定相只能猜测，其正确率通常不比 50/50 的机会高 [@problem_id:4328173] [@problem_id:4393857]。

这就是第二种策略大放异彩的地方：**基于读长的定相**。我们不再求助于群体，而是更仔细地审视自己手中的证据。还记得那些被撕碎的书页吗？想象一下，其中一些没有被完全撕开，我们发现了一些由两三页仍然物理粘连在一起的小纸团。这些纸团就是我们现代测序的“读长”（reads）。一条测序读长来源于单个 DNA 分子，这意味着它要么来自第一卷，要么来自第二卷，但绝不会同时来自两者。如果一条读长足够长，能够覆盖两个不同的变异位点，它就为我们提供了原书的一个直接、物理上明确无误的片段 [@problem_id:5067213]。这就是基于读长的定相的核心机制：利用 DNA 的物理连续性来直接观察哪些等位基因共同存在。

### 读取片段的力量与数学原理

读取这些片段的能力已经因测序技术而发生了革命性变化。早期的“短读长”测序给我们的片段太小，就像单个单词一样——除非是紧邻的变异，否则很少能长到足以跨越我们感兴趣的两个变异位点。对相隔数千个碱基对的变异进行定相，就像试图用单个词语重建一个章节；你知道这些词，但不知道它们的顺序。

**长读长测序**的出现改变了游戏规则。这些技术能在单条读长中为我们提供完整的段落，甚至是整页内容。一条例如长 20,000 个碱基的读长可以轻松跨越相距 12,000 个碱基的两个变异，瞬间揭示它们的定相关系 [@problem_id:4328173]。

我们甚至可以用一个简单而优雅的模型来描述这种能力。想象一下，杂合变异沿着染色体分布，就像蛋糕里的葡萄干，遵循一个随机的**泊松过程**。一条长读长就像切下一片蛋糕。我们切下的这片蛋糕是“定相信息丰富”的概率是多少，也就是说，它至少包含两颗葡萄干？该过程的数学原理表明，长度为 $L$ 的读长所捕获的变异数量也遵循泊松分布。捕获至少 $k$ 个变异的概率可以被精确计算，并且它明确地表明，随着读长 $L$ 的增加，我们获得信息丰富切片的机会急剧上升 [@problem_id:4382914]。

当然，一片可能不够。如果我们犯了“读取错误”（测序错误）怎么办？解决方法是多切几片。我们对同一位点进行测序的次数被称为**测序深度**或覆盖度。比如说，如果我们有 30 条读长都跨越了相同的两个变异，我们可以采取多数表决的方式。即使有几条读长因错误而出错，大多数读长的一致意见也会高置信度地揭示出真实的定相。更深的覆盖度意味着更多的投票，这不仅可以纠正错误，还增加了发现更远距离变异之间联系的机会，从而使我们能够将小的已定相区块连接成染色体规模的单倍型 [@problem_id:4380771]。

### 整合的艺术：一个贝叶斯侦探故事

那么，哪个更好：群体的统计智慧还是来自读长的直接物理证据？最深刻的答案是，我们应该两者都用。在这里，定相变成了一场优美的[贝叶斯推理](@entry_id:165613)实践，就像一位侦探为了破案而权衡不同种类的线索。

来自群体参考面板的信息提供了我们的**[先验信念](@entry_id:264565)**。单倍型库告诉我们，在普通人群中哪些定相构型是常见的，哪些是罕见的。这是我们的起始假设 [@problem_id:4355737]。

然后，我们从我们的样本中收集证据：基于读长的数据。这提供了**似然性**。这是直接物理证据的声音，告诉我们在*这个特定个体*的 DNA 分子上观察到了什么。

贝叶斯定理为结合这两个信息源提供了完美的框架。它精确地告诉我们如何根据新证据更新我们的先验信念，以得出一个最终的**后验概率**。在一个引人入胜的情景中，我们可能根据群体数据有一个非常强的[先验信念](@entry_id:264565)，认为两个变异是*顺式*的。然而，如果我们收集到少数几条长读长，它们都一致地显示这两个变异是*反式*的，那么来自这个直接证据的似然性可能会非常强大，以至于完全推翻我们最初的信念 [@problem_id:5170219]。这种对群体数据和个体数据的正式整合是可证明的最[优化方法](@entry_id:164468)，能够最大限度地减少定相错误，使我们能够做出尽可能自信的判断。

### 衡量成败：转换错误

我们如何评估我们的定相性能？最常用的指标是**转换错误率**。想象一下，你正在正确地重建父源染色体的等位[基因序列](@entry_id:191077)。你正确地确定了前几个位点，但在第 10 个位点时，你错误地分配了母源等位基因。你可能会在接下来的几个位点继续使用母源等位基因，然后才“转换”回正确的父源染色体。在两个真实单倍型之间的这种来回切换就是一次转换错误。转换错误率就是这些不正确转换的次数除以相邻位点的总数，从而为我们提供了局部定相准确性的衡量标准 [@problem_id:5067213]。通过利用基于读长的定相的力量，尤其是在贝叶斯框架下进行整合时，与仅依赖统计方法相比，我们可以显著减少这些转换错误 [@problem_id:4355737]。

### 现实世界中的定相：错综复杂

我们讨论的原理是优雅的，但真实的生物世界却是美妙地混乱。应用这些方法需要应对一系列实际挑战。

- **基因组丛林与海市蜃楼：** 我们的基因组并非一成不变的景观。它充满了重复区域，就像由几乎相同的树木组成的丛林，被称为**片段重复**。来自这样一个区域的测序读长可能会模糊地比对到多个位置。比对工具会用**低[比对质量](@entry_id:170584)（MAPQ）**来标记这种不确定性。依靠这样的读长进行定相，就像信任一个不确定自己身在何处的目击者。这些模糊的读长会产生虚假的定相信号，导致我们得出错误的结论 [@problem_id:5134725] [@problem_id:4393857]。

- **比对幻象：** 在插入、删除或简单的**同聚物**（如 AAAAAAAA）区域附近，短读长比对算法可能会感到困惑。这可能会产生像**链偏好性**这样的假象，即一个定相模式持续出现在来自一条 DNA 链的读长上，但在另一条链上却缺失或相矛盾。一位谨慎的科学家不会将这种模式视为证据，而是将其视为一个警示潜在幻象的红旗 [@problem_id:5134725]。

- **技术的交响曲：** 短读长的局限性激发了一系列捕捉长程信息的创新技术。例如，**关联读长**技术不使用单一条长读长。取而代之的是，它们对所有来自同一个原始长 DNA 分子（可能长达 50,000 个碱基或更长）的短读长进行独特的“条形码”标记。通过将具有相同条形码的读长分组，我们可以在计算上连接相距甚远的变异。其他方法如 **Hi-C** 和 **Strand-seq** 利用染色体的三维折叠或 DNA 复制的机制，提供兆碱基尺度上的定相信息，连接遥远的外显子并构建染色体长度的单倍型 [@problem_id:4569453]。

- **癌症基因组的演化：** 在[癌症基因组学](@entry_id:143632)中，挑战达到了顶峰。肿瘤不是一个静态实体；它是一个由**亚克隆**组成的动态演化生态系统，每个亚克隆都有其独特的遗传特性。来自肿瘤的测序样本是正常细胞和多个不同肿瘤亚克隆 DNA 的混合物。这会产生一系列相互冲突的单倍型信号，从而混淆标准的定相算法。在这个**[体细胞嵌合](@entry_id:172498)**的复杂世界里，定相需要更复杂的方法。我们可以构建“克隆感知”的[统计模型](@entry_id:755400)，同时估计肿瘤纯度、每个亚克隆的比例及其独特的单倍型 [@problem_id:4569485]。或者，我们可以通过**[单细胞测序](@entry_id:198847)**完全绕过[混合问题](@entry_id:634383)，物理上分离单个肿瘤细胞，逐一读取它们的单倍型，从而解开癌症错综复杂的演化历史。

从单个分子上共现的简单而优雅的原理出发，基于读长的定相已成长为现代基因组学的基石，使我们能够以越来越高的准确性重建我们基因组的两个故事，并解决医学领域一些最复杂的问题。

