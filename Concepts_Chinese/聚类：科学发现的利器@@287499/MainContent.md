## 引言
在现代科学数据的汪洋大海中，从复杂的基因组编码到单个细胞内错综复杂的信号，寻找有意义的模式是一项至关重要的挑战。我们如何在看似混沌的状态中发现秩序，尤其是在我们不知道要寻找什么的时候？这正是[聚类](@article_id:330431)所要解决的核心问题，[聚类](@article_id:330431)是无监督机器学习核心中的一项强大计算技术。与依赖预先存在标签的监督方法不同，聚类允许我们让数据自己揭示其内在结构。本文将揭开[聚类](@article_id:330431)这门艺术与科学的神秘面纱。第一章 **原理与机制** 将深入探讨其核心思想，对比[无监督学习](@article_id:320970)与[监督学习](@article_id:321485)，探索如何处理[高维数据](@article_id:299322)，并权衡不同[聚类](@article_id:330431)方法之间的关键选择。在此基础上，**应用与跨学科联系** 一章将展示聚类的实际应用，阐明它如何作为不可或缺的透镜，在从基因组学到神经科学等领域中促进发现。通过这次探索，您将不仅理解[聚类](@article_id:330431)的工作原理，还将学会如何将其作为一种科学探究的工具来运用。

## 原理与机制

想象一下，你拿到一个装有有史以来所有乐高积木的巨大箱子。你的任务是把它整理好。你会如何开始呢？你可能会先按颜色分类，堆出红色、蓝色和黄色的积木堆。或者，你可能会按形状分类：所有2x4的积木放在这里，所有扁平的砖块放在那里。又或者按大小分类。这些策略中的每一种都是一种[聚类](@article_id:330431)形式：你根据物体的内在属性将它们分组，而这些物体上没有任何预先存在的标签。这就是**[无监督学习](@article_id:320970)**的精髓。没有老师告诉你“这是一块红色的積木”。相反，你看着这一堆杂乱的集合，然后问：“这里面存在哪些自然的分组？”

这与**[监督学习](@article_id:321485)**形成鲜明对比，后者的任务更像一个拿着一副抽认卡的学习者。你看到一块积木及其正确的标签（“红色2x4”），你的任务是学习将物体与其名称联系起来的规则。在看过足够多的例子后，你就能自信地为你从未见过的新积木贴上标签。

这种区别并不仅仅是学术上的；它触及了科学发现的核心。思考一下生物学最基本的概念之一：“物种”。“物种”这个概念是我们试图附加到生物体上的一个预定义标签（监督任务），还是应该从遗传数据中自行浮现出的一个自然分组（无监督任务）？如果我们的目标仅仅是构建一个能够根据形态学分配与分类学专家几十年来所使用的相同标签的机器，那么我们就在[监督学习](@article_id:321485)的世界里。我们有我们的数据（基因组 $X_i$）和我们的标签（专家的物种名称 $L_i$），然后我们学习从前者到后者的映射。

但如果我们相信“物种”是一个更基本的属性，它被写入了DNA的结构之中，那该怎么办？这时我们可能会转向[无监督聚类](@article_id:347668)。我们会采集数千种生物的遗传数据，然后让计算机去：“找出这里面最自然的分组。”我们希望浮现出的聚类能与物种相对应。然而，正如生物学的复杂性所显示的，事情并非如此简单。不同的[聚类算法](@article_id:307138)，凭借其对“群组”的不同数学定义，可能会给出不同的答案。此外，生物学本身也提供了多种物种的定义——一种基于外观，另一种基于产生可育后代的能力。一个著名的例子是“环状种”，其中A种群可以与B种群繁殖，B种群可以与C种群繁殖，但A和C种群却不能。这个生物学现实违背了大多数[聚类算法](@article_id:307138)所产生的简洁的[传递性](@article_id:301590)（即如果A与B在同一簇中，B与C在同一簇中，那么A必须与C在同一簇中）。这揭示了一个深刻的真理：[无监督聚类](@article_id:347668)并非一根能揭示绝对“真理”的魔杖。它是一种强大的**[探索性数据分析](@article_id:351466)**工具——一种让数据展示其结构的方式，而科学家必须在深厚的领域知识背景下对其进行解读 [@problem_id:2432862]。

### 在多维空间中观察

我们的大脑擅长在二维或三维空间中寻找模式。我们扫一眼散点图，就能立刻看到一个团块、一条线或几个不同的点云。但当每个数据点不是由两个或三个特征描述，而是由45个或一千个特征描述时，会发生什么呢？这就是现代科学的现实。

想象一位免疫学家正在研究肿瘤内部繁忙的细胞生态系统。使用一种称为**质[谱流](@article_id:307248)式细胞技术**的方法，他们可以测量每个细胞表面45种不同蛋白质的水平。现在，每个细胞都是一个45维空间中的点。我们怎么可能指望在这种令人眩晕的复杂性中找到细胞类型呢？传统的方法，即**手动圈门**，就像试图通过观察一系列二维阴影来理解一座雕塑。科学家看着蛋白质1与蛋白质2的图，在一群细胞周围画一个圈，然后说：“这些是[T细胞](@article_id:360929)。”然后，只取这些细胞，他们再绘制蛋白质3与蛋白质4的图，并画出另一个边界。这个过程是序列性的、费力的，而且最重要的是，它受到科学家已有知识的偏见影响。他们只寻找他们已经知道存在的细胞类型，沿着他们已经认为重要的轴进行分析。他们可能完全错过一种新型免疫细胞，这种细胞只有在同时观察蛋白质7、18和32时才能被区分出来 [@problem_id:2247628]。

这就是[无监督聚类](@article_id:347668)成为不可或缺工具的地方。像FlowSOM或PhenoGraph这样的[算法](@article_id:331821)不会一次只看两种蛋白质。它会获取每个细胞完整的45维描述，并基于其*所有*特征一次性计算其与所有其他细胞的相似度。然后，它根据这种整体相似性对细胞进行分组。通过在完整的高维空间中操作，这些[算法](@article_id:331821)可以识别出在任何人类可能选择观察的二维投影中都完全不可见的细胞群体。它将我们从三维直觉的束缚中解放出来，让数据揭示其自身通常令人惊讶的结构。

### 扁平结构还是家族树？选择正确的视角

那么，我们决定使用一种[聚类算法](@article_id:307138)。但应该用哪一种呢？事实证明，要求[算法](@article_id:331821)“寻找群组”有点像要求艺术家“画一幅画”——结果完全取决于他们使用的工具和风格。两种最基本的聚类“风格”是划分[聚类](@article_id:330431)和[层次聚类](@article_id:640718)。

**划分[聚类](@article_id:330431)**，其中K-均值是最著名的例子，就像将那些乐高积木分拣到预定数量的箱子里。你预先决定，“我想找到三个组（$k=3$）。”然后，[算法](@article_id:331821)会不断移动数据点，直到找到将它们划分为恰好三个不重叠组的最佳方式。当你有很强的假设时，这非常有用。例如，如果临床研究表明某种癌症恰好有四种不同的分子亚型，你可以使用K-均值（$k=4$）将新的患者样本分到这些已知的类别中 [@problem_id:2281844]。

另一方面，**[层次聚类](@article_id:640718)**不需要你预先选择[聚类](@article_id:330431)的数量。相反，它构建了一个嵌套关系的结构，通常被可视化为一种称为**[树状图](@article_id:330496)**的[树状图](@article_id:330496)表。你可以把它想象成在为你的数据构建一棵家族树。在最底部是单个的数据点。[算法](@article_id:331821)会逐渐将最相似的点合并成小的家族群组，然后将这些小家族合并成更大的宗族，依此类推，直到所有点都属于一个共同的祖先。

在这些方法之间做出选择并非品味问题；这是一个科学决策，取决于你正在研究的问题的性质。想象一下你正在追踪干细胞的分化过程。一个全能干细胞可能首先变成一个多能祖细胞，然后它有选择地变成一个[神经元](@article_id:324093)或一个皮肤细胞。这个过程本质上是分层的。如果你使用K-均值，你会得到扁平的、不相连的标签：“干细胞”、“祖细胞”、“[神经元](@article_id:324093)”。你会丢失[神经元](@article_id:324093)和皮肤细胞都是祖细胞的“后代”，而祖细胞本身又是干细胞的“后代”这一关键信息。然而，来自[层次聚类](@article_id:640718)的[树状图](@article_id:330496)会优美地重建这个谱系。树的[分支点](@article_id:345885)将对应于[细胞命运](@article_id:331830)的决[定点](@article_id:304105)，为发育过程本身提供了一张地图。在这种情况下，[树状图](@article_id:330496)不仅仅是一种可视化；它是一个生物学现象的模型 [@problem_id:2281844]。

### 科学家的最危险工具：假设

[聚类算法](@article_id:307138)功能强大，但它们也很天真。它们会完全按照你告诉它们的方式去做，并且会在你给它们的任何数据中找到模式。它们没有常识，没有生物学直觉。它们对数据抱有盲目的信任。这就引出了所有数据分析的第一条戒律：垃圾进，垃圾出。一个[聚类](@article_id:330431)的意义仅取决于定义它的数据。

设想一个学生正在分析一个[蛋白质数据库](@article_id:373781)，希望根据蛋白质在细胞中的位置（例如，“细胞核”、“细胞质”）来寻找功能群组。对于许多蛋白质，这个信息是缺失的，所以数据库将其位置列为“未知”。这个学生，在一个看似无害的举动中，将“未知”视为另一个位置，就像“细胞核”一样，并运行了一个[聚类算法](@article_id:307138)。结果，[算法](@article_id:331821)发现了一个巨大的、统计上稳健的“未知”蛋白质簇！这是一个突破吗？不，这是一场灾难。该[算法](@article_id:331821)并未发现一个新的细胞区室。它只是将我们共同无知的所有蛋白质归为一类。这些蛋白质并不共享一个生物学特性；它们共享的是信息的缺失。由此产生的[聚类](@article_id:330431)完全是伪影，任何基于它得出的生物学结论都纯属虚构 [@problem_id:1437189]。

这个问题比简单的错误标记更深。[聚类](@article_id:330431)的数学基础在面对缺失数据时非常脆弱。大多数[聚类算法](@article_id:307138)都建立在**距离**的概念之上。为了判断两个患者样本是否相似，[算法](@article_id:331821)会在高维基因表达空间中计算它们之间的距离。一个常见的方法是使用欧几里得距离，你可能在几何课上学过，并将其扩展到多维：$d(j,k) = \sqrt{\sum_{g} (X_{gj} - X_{gk})^2}$，其中你对每个基因$g$的平方差进行求和。

现在，如果样本$j$的基因$X_{g'j}$的表达值缺失了会怎样？项$(X_{g'j} - X_{g'k})^2$就无法计算。整个距离公式都失效了。样本$j$和样本$k$之间的距离概念本身就变得不确定了。这与计算单个基因的平均表达量这类更简单的任务有根本的不同。如果少数样本的该基因值缺失，你只需在计算平均值时忽略它们，仍然可以得到一个合理的估计。但[聚类](@article_id:330431)依赖于一个完整的、定义明确的所有样本间成对距离矩阵。几个缺失值就可能在这个矩阵上打出洞，损害整个分析的结构 [@problem_id:1437215]。这就是为什么数据清洗和**插补**（对缺失值进行仔细估计）不仅仅是繁琐的杂务；它们是确保我们发现的美丽聚类反映的是自然结构，而非我们自身不完整知识所造成的伪影的基础步骤。