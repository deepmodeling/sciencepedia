## 应用与跨学科联系

在前面的讨论中，我们煞费苦心地构建了用于构造[预测分布](@article_id:345070)的机制。我们已经看到，它们是如何在先验知识和观测数据之间优雅的相互作用中产生的，这是一场由概率规则编排的舞蹈。但要真正领会这个概念的力量，我们必须提出任何务实的科学家或工程师都会问的典型问题：“那又怎样？”这些分布*有何用处*？

答案是，正如我们将看到的，它们几乎适用于所有涉及对未知事物进行推理的领域。[预测分布](@article_id:345070)是我们能对未来事件做出的最诚实、最完整的陈述。它不仅仅是一个简单的点预测；它是一个可能性的全景图，高峰代表最可能的结果，低谷代表不大可能的结果。它是我们从仅仅解释已见世界转向对未见世界做出定量、有原则且有用的陈述的主要工具。本章将带领我们游历这个非凡思想的广阔应用领域，展示其在科学、工程乃至更广阔领域中的统一力量。

### 预测、决策与估值

[预测分布](@article_id:345070)最直接的用途或许就是预测。想象你是一位研究间歇泉的公园管理员。你拥有关于喷发间隔的历史数据。通过建立一个简单的统计模型——例如，假设喷发过程有一个未知的潜在速率——并用你的数据来更新它，你可以为*下一次*的等待时间生成一个[后验预测分布](@article_id:347199)。这个分布是你洞察不久未来的完整指南。你可以用它来计算你预期的平均等待时间，但也可以回答更丰富的问题：“等待时间的第90百分位数是多少，超过这个时间喷发就变得异常晚了？”或者“下一次喷发在一小时内发生的概率是多少？”这使你能够向游客提供细致入微的概率信息，远非一个简单且可能错误的[点估计](@article_id:353588)所能比拟 [@problem_id:2375942]。

然而，预测通常只是通往更复杂目标的第一步：做出决策。考虑一家公司必须决定生产多少单位的新产品。生产过剩会导致库存成本浪费，而生产不足则会导致利润损失。关键的未知数是未来的需求。贝叶斯方法允许公司采纳其对市场的初始信念，用调查数据更新它们，并为需求生成一个[后验预测分布](@article_id:347199)。该分布代表了所有 plausible 的销售数字及其概率。这个框架的美妙之处在于，该分布可以直接与库存过剩和不足的经济成本相结合。最优的生产数量是使*[期望](@article_id:311378)损失*最小化的数量，该[期望](@article_id:311378)损失是在未来可能性的整个景观上平均计算的。因此，[预测分布](@article_id:345070)成为理性决策引擎的直接输入，将不确定性转化为最优行动 [@problem_id:691475]。

这一原则延伸到更复杂的领域，如现代金融和经济学。想象一下，试图根据卫星图像和天气数据预测一个国家的农[作物产量](@article_id:345994)。可以建立一个[贝叶斯线性回归](@article_id:638582)模型来将这些因素与产量联系起来。给定过去季节的数据和即将到来的季节的预测变量值，该模型不仅给出一个单一的数字，它还会为未来的产量生成一个[后验预测分布](@article_id:347199)。这个分布有一个均值，可以解释为最可能的预测。在某些理想化的经济假设下，这个预测均值代表了该作物期货合约的“公平价格”。但同样重要的是，该分布有一个方差，这是对预测周围风险或不确定性的定量度量。[预测分布](@article_id:345070)同时包含了经济结果的[期望值](@article_id:313620)和风险，为农民、保险公司和商品交易员提供了重要信息 [@problem_id:2375530]。

### 科学工作流程的引擎

除了实际的预测，[预测分布](@article_id:345070)还融入了科学方法本身的结构中。它们是我们用来了解世界和处理数据不可避免的缺陷的工具。

一个经典的科学工作流程包括一个两步过程：推断和预测。想象一位[材料科学](@article_id:312640)家试图确定[杨氏模量](@article_id:300873) $E$，这是一个描述[材料刚度](@article_id:318794)的基本参数。她进行了一系列应力-应变实验。使用[贝叶斯框架](@article_id:348725)，她可以将她对材料的先验知识与带噪声的实验数据相结合，从而获得参数 $E$ 的*后验分布*。这个分布代表了她对这个世界隐藏属性的更新知识状态。

现在，假设她想预测在一个新的、未经测试的应变水平下她会观察到的应力。她使用 $E$ 的[后验分布](@article_id:306029)来为新的应力测量生成一个*[后验预测分布](@article_id:347199)*。这里出现了一个美妙的洞见：她预测的不确定性（[预测分布](@article_id:345070)的宽度）来自两个不同的来源。一部分来自她测量设备的内在噪声。但另一部分，更有趣的部分，来自她对 $E$ 真实值（$E$ 的[后验分布](@article_id:306029)宽度）的剩余不确定性。[预测分布](@article_id:345070)自动且正确地将这两个不确定性来源组合成一个单一、诚实的预测。这是科学的基本循环：了解世界不可观察的参数，然后利用这些知识对新的观察做出可检验的预测 [@problem_id:2707423]。

[预测分布](@article_id:345070)还为科学中一个普遍存在的问题——[缺失数据](@article_id:334724)——提供了一个强大的解决方案。实验很少能完美进行。当传感器发生故障或样本丢失时我们该怎么办？一个简单的方法可能是丢弃整个实验或填入一个简单的平均值。贝叶斯方法要复杂得多。通过建立一个将缺失值与我们*确实*观察到的数据相关联的模型，我们可以为缺失的数据点生成一个[后验预测分布](@article_id:347199)。例如，在一个[系统生物学](@article_id:308968)实验中，如果我们测量了激酶的活性但未能记录其底物的相应磷酸化水平，我们可以使用成功的测量来预测缺失的那个可能是什么。我们得到的不是一个单一的数字；我们得到一个捕捉我们不确定性的分布。这使得不完整的实验仍然能以一种有原则的方式为我们的分析做出贡献，而我们不必假装知道我们不知道的事情 [@problem_id:1437168]。

### 模型构建的艺术

科学不仅仅是使用一个模型；它是关于构建、批判和在众多模型中进行选择。[预测分布](@article_id:345070)是这种“元科学”活动的核心。

我们如何知道我们的模型是否好？一个概率模型的最终检验是其做出良好校准的预测的能力。这就引出了一个用于[模型验证](@article_id:638537)的极其深刻的想法。对于任何实验，我们的模型都会产生一个[预测分布](@article_id:345070)。然后我们进行实验并得到一个实际结果。我们可以问：我们的结果落在我们[预测分布](@article_id:345070)的哪个位置？是在均值附近吗？还是在尾部？[概率积分变换](@article_id:326507)（Probability Integral Transform, PIT）告诉我们，如果我们的[模型校准](@article_id:306876)正确，那么我们观察到的结果序列，当在其各自[预测分布](@article_id:345070)的累积尺度上定位时，应该与一组从0到1之间均匀抽取的随机数无法区分。如果我们的模型总是预测出过窄的分布，我们就会过于频繁地感到惊讶，我们的观测值就会堆积在尾部。如果我们的预测太宽，我们的观测值就会聚集在中心附近。PIT[直方图](@article_id:357658)的“平坦度”是检验我们模型预测诚实性的一个优美而强大的诊断工具 [@problem_id:2707583]。一个相关的想法是后验预测检验，它要求我们的模型从[预测分布](@article_id:345070)中生成复制数据集，并检查这些“假”数据集是否与我们的真实数据相似，这是一种让模型“检查自己工作”的方式 [@problem_id:694074]。

当我们有多个相互竞争的模型，并且不确定哪个是正确的时，会发生什么？这是一个常见的困境，从理论化学中不同的[势能面](@article_id:307856)可能解释一个反应，到机器学习中不同的[算法](@article_id:331821)可能用于建模一个数据集。[贝叶斯框架](@article_id:348725)提供了一个优雅的解决方案：[贝叶斯模型平均](@article_id:348194)（Bayesian Model Averaging, BMA）。我们不是选择一个“最佳”模型并丢弃其余的模型——这种傲慢的行为忽略了我们的[模型不确定性](@article_id:329244)——而是可以计算给定数据下每个模型的[后验概率](@article_id:313879)。最终的复合[预测分布](@article_id:345070)就是每个单独模型[预测分布](@article_id:345070)的[加权平均](@article_id:304268)，其中权重正是这些后验模型概率。

结果是一个更稳健、更诚实的预测，它考虑到了我们在模型层面上的不确定性。如果两个人工智能模型提供相互矛盾的建议，BMA提供了一种有原则的方式来组合它们的预测，给予更好地解释了过去数据的模型更多的权重 [@problem_id:2018077]。同样，在基础物理学中，来自多个合理理论的预测可以被组合成一个单一、统一的预报，以[对冲](@article_id:640271)我们对哪个理论最终是正确的无知 [@problem_id:2828666]。这是谦逊与严谨的实践。这个[混合分布](@article_id:340197)的复合方差由全方差定律给出，它优美地结合了单个模型方差的平均值（“模型内”不确定性）和模型均值之间的方差（“模型间”不确定性）。
$$
\mathrm{Var}(y | D) = \sum_i P(M_i|D) \mathrm{Var}(y | M_i, D) + \sum_i P(M_i|D) (\mathbb{E}[y|M_i,D] - \mathbb{E}[y|D])^2
$$

### 闭合循环：主动指导发现

到目前为止，我们的应用大多是被动的：我们观察世界并预测接下来可能发生什么。但[预测分布](@article_id:345070)最令人兴奋的应用在于闭合循环，利用它们来*主动*和*智能地*指导我们寻找新发现。

这是[贝叶斯优化](@article_id:323401)的领域，它是从药物发现到[材料科学](@article_id:312640)和合成生物学等领域现代人工智能驱动的[实验设计](@article_id:302887)的关键引擎。想象一下，你正在尝试设计一个[合成启动子](@article_id:363590)以最大化基因表达。合成和测试每个可能的DNA序列都非常昂贵。接下来应该测试哪一个？

[贝叶斯优化](@article_id:323401)[算法](@article_id:331821)首先根据迄今为止测试过的序列，建立一个“[适应度景观](@article_id:342043)”的[代理模型](@article_id:305860)（通常是[高斯过程](@article_id:323592)）。对于任何新的、未经测试的序列 $x$，该模型为其性能 $f(x)$ 提供一个[预测分布](@article_id:345070)，该分布由均值 $\mu(x)$ 和方差 $\sigma^2(x)$ 表征。均值告诉我们模型对性能的最佳猜测，而方差告诉我们它对该猜测有多不确定。

为了决定接下来测试哪个序列，我们计算一个“[采集函数](@article_id:348126)”。其中最成功的一个是[期望](@article_id:311378)提升（Expected Improvement, EI）。相对于迄今为止的最佳值 $f_{\text{best}}$ 的提升是 $\max(0, f(x) - f_{\text{best}})$。EI 是这个量的[期望值](@article_id:313620)，在[预测分布](@article_id:345070)上进行平均。一段非凡的数学推导表明，这可以以[闭合形式](@article_id:336656)计算：
$$
\text{EI}(x) = (\mu(x) - f_{\text{best}}) \Phi\left(\frac{\mu(x) - f_{\text{best}}}{\sigma(x)}\right) + \sigma(x) \phi\left(\frac{\mu(x) - f_{\text{best}}}{\sigma(x)}\right)
$$
仔细观察这个优美的公式 [@problem_id:2749128]。第一项偏爱均值预测 $\mu(x)$ 高的点（利用——追求确定的胜利）。第二项与预测不确定性 $\sigma(x)$ 成正比，偏爱模型非常不确定的点（探索——学习新东西）。EI 优雅地平衡了利用已知良好区域的愿望与探索未知领域的需要。通过始终在 EI 最高的点选择下一个实验，该[算法](@article_id:331821)智能地在搜索空间中导航，迅速收敛到最优设计。在这里，[预测分布](@article_id:345070)不再仅仅是一个预测；它是一个自主发现机器的引擎。

### 统一的视角

从预测间歇泉到为[金融衍生品定价](@article_id:360913)，从填补[缺失数据](@article_id:334724)到验证复杂模拟，从组合相互竞争的理论到设计新颖的蛋白质，[预测分布](@article_id:345070)一次又一次地出现。它是一个统一的概念，为在不确定性下进行推理和决策提供了一种单一、连贯的语言。它是科学方法的实际操作体现，使我们能够从过去中学习，量化我们的无知，并对未来做出有原则、智能的赌注。简而言之，它是所有科学中最优美、最有用的思想之一。