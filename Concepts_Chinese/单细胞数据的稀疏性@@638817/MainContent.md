## 引言
[单细胞测序](@entry_id:198847)技术彻底改变了生物学，使我们能够以前所未有的分辨率分析单个细胞。然而，这些强大的技术也带来了一个核心悖论：它们产生的海量数据集绝大多数是空的。这种现象被称为[数据稀疏性](@entry_id:136465)，其中超过 90% 的测量值可能为零，是[单细胞分析](@entry_id:274805)中最显著的特征和挑战。核心问题在于，这些零值并非完全相同；它们是真实生物学缺失和技术性测量失败的混合体。如果未能正确区分这些来源或解释其影响，我们对[细胞生物学](@entry_id:143618)的看法就可能被扭曲，从而对细胞身份、功能和动态得出错误的结论。

本文旨在探讨稀疏性带来的挑战与机遇。第一章“原理与机制”剖析了零值的双重来源，并介绍了为处理这些零值而开发的基础计算策略，从归一化到插补。随后的“应用与跨学科联系”一章则展示了这些专门方法如何促成复杂的分析，使我们能够重建动态过程并整合不同类型的数据，以构建一幅完整的细胞图景。通过理解支配这种结构化空缺的原理，我们可以将一个技术障碍转化为更深层生物学洞见的来源。

## 原理与机制

想象一下，你试图通过拍摄一张短暂的快照来理解一个繁华都市的复杂运作。但有一个问题：你的相机只能捕捉到百分之一的活动。有些街道看起来空无一人，并非因为无人使用，而仅仅是因为你在错误的时间进行了观察。你拍摄的中央大图书馆的照片可能显示没有《白鲸记》(Moby Dick) 的副本，这并非因为图书馆没有这本书，而是因为你那微小的快照错过了它。这正是我们窥探单个细胞[世界时](@entry_id:275204)所面临的挑战。我们得到的结果，一张巨大的基因活性表，充满的却是矛盾的“无”。高达 90% 甚至更多的数据点都是零。这种现象被称为**[稀疏性](@entry_id:136793)**，它不仅仅是一个技术上的麻烦，更是单[细胞生物学](@entry_id:143618)的一个基本特征，迫使我们发明全新的观察方式。

### 虚无的丰盛：[稀疏性](@entry_id:136793)的来源

那么，为什么我们的数据如此空洞？单细胞数据集中的零值源于两种截然不同的来源：一种是生物学的，另一种是技术性的。将两者混为一谈，就等于误解了细胞试图告诉我们的故事。

首先是**生物学现实**。你的身体包含数百种特化的细胞类型——神经元不是肝细胞，肝细胞也不是皮肤细胞。每种细胞类型通过开启一组特定的基因，并同样重要地，关闭其他基因来获得其独特的身份。神经元没有理由产生[消化酶](@entry_id:163700)，因此编码这些酶的基因是沉默的。我们数据中的这些“零值”是真实且意义深远的；它们是细胞身份的遗传体现 [@problem_id:1465917]。此外，基因表达并非一个稳定的嗡鸣，而是一个动态的、“脉冲式”的过程。一个基因可能活跃转录几分钟，然后沉默一个小时。当我们分离一个细胞进行测序时，我们将其冻结在时间的某一瞬间。我们可能恰好在一个基因的静默期捕捉到它，从而得到一个合理的生物学零值，即使该基因对细胞功能很重要 [@problem_id:1465917]。

其次是我们测量的**技术限制**。从一个微观的单细胞中捕获遗传信息（信使 RNA，或 mRNA）的过程极其精细且效率低下。我们从数千个 mRNA 分子开始，但我们的“渔网”是有漏洞的。我们只能成功捕获、转换和测序其中的一小部分。对于一个起始 mRNA 拷贝数就很少的基因来说，我们很可能一个也捕获不到。这就在我们的数据集中产生了一个零值，不是因为基因沉默，而是因为我们的测量未能检测到它。这种技术性假象通常被称为 **dropout (脱落)** [@problem_id:1465917]。这不是基因的失败，而是捕获的失败。

这种极度[欠采样](@entry_id:272871)（undersampling）的挑战并不仅限于 RNA。当我们使用一种名为 [scATAC-seq](@entry_id:166214) 的技术研究基因组的哪些部分是物理上“开放”且可及的时，问题变得更加尖锐。一个细胞每条[染色体](@entry_id:276543)最多只有两个物理拷贝。在基因组中数十万个潜在可及区域中，单次实验可能只采样到几千个片段。由此产生的数据矩阵比 RNA 数据更为稀疏，这鲜明地说明了我们始终在利用全部可能信息中的一小部分进行工作 [@problem_id:2417499]。理解这些零值的双重性质——一些是真实的，一些是虚假的——是理解数据的第一步。

### 驯服零值：归一化与转换的艺术

一旦我们得到稀疏的计数矩阵，便立即面临一系列难题。第一个难题出奇地基础。一个高度活跃基因的读数（reads）可以达到数万，而一个弱活跃基因可能只有寥寥几个。为了使这些数字具有可比性，生物学家喜欢使用对数，它能将这个巨大的动态范围压缩到一个更易于管理的尺度。但是，零的对数是多少？这个问题没有答案；该函数在数学上是无定义的。一个朴素地对数据进行对数转换的尝试，会在分析开始之前就使其崩溃 [@problem_id:1425909]。

解决方案是一个优雅的小技巧：**伪计数**。在取对数之前，我们简单地在整个数据集的每个计数上加上一个小数（通常是 1）。转换变为 $y = \log(x + 1)$。对于一个计数为零的基因，我们现在计算 $\log(0 + 1) = \log(1)$，这是一个表现完美的 0。对于所有其他基因，增加的“1”对其已经很大的值影响微乎其微。这个简单而务实的步骤驯服了零值，使我们的分析得以继续。

但我们只解决了第一个难题。一个更微妙的问题潜藏其中：我们从每个细胞中捕获的分子总数——即其**文库大小**——可能差异巨大。我们从细胞 A 捕获了 10,000 个分子，而从细胞 B 只捕获了 1,000 个，是因为细胞 A 的生物学活性是细胞 B 的十倍，还是我们的“渔网”对细胞 A 的效率恰好高了十倍？这是一个将真实的生物学信号与技术性假象分离开来的关键问题 [@problem_id:3301297] [@problem_id:2429782]。

这正是**归一化**的工作。最直接的想法是将每个细胞中的计数转换为比例，即用每个基因的计数除以该细胞的总文库大小。这看起来很合理，但它隐藏着一个致命缺陷。想象一下比较一个正常细胞和一个[浆细胞](@entry_id:164894)，后者已将其大部分资源用于生产单一的[抗体](@entry_id:146805)基因。这一个基因的计数将是巨大的，从而极大地夸大了总文库大小。当我们用这个巨大的总数去除所有其他基因时，它们都会显得表达水平较低，即使它们的真实活性并未改变。这是一种**组成效应**，即一个组分的巨大变化使得所有其他组分看起来都在缩小 [@problem_id:3301297]。

为了克服这一点，科学家们开发了更巧妙的归一化方案。一种方法是假设*绝大多数*基因的表达在细胞间*不*发生变化。通过仅基于这个稳定的多数计算缩放因子，我们可以在不被少数异常值基因迷惑的情况下校正文库大小。另一种巧妙的方法涉及汇集来自相似细胞组的计数以获得更可靠的估计，然后使用数学[反卷积](@entry_id:141233)将正确的因子分配回每个单个细胞 [@problem_id:3301297]。

有时，最好的想法来自于从一个全新的角度看待问题。一些研究人员在一个看似无关的领域——自然语言处理——中找到了一个美妙的类比。他们建议将每个细胞视为一个“文档”，每个基因（或可及的 DNA 峰）视为一个“词”。在这个类比中，一个在几乎每个细胞中都活跃的基因就像“的”这个词——它很常见，但对于区分文档来说[信息量](@entry_id:272315)不大。然而，一个只在特定细胞类型中活跃的基因，就像一个罕见的专业术语——它信息量极高。这促使人们采用了一种名为**[词频-逆文档频率](@entry_id:634366) ([TF-IDF](@entry_id:634366))** 的方法。这种方法系统地降低常见“管家”基因的权重，并提高定义细胞独特身份的稀有、特异性标记基因的权重，从而提供了一种透过噪声看本质的强大方式 [@problem_id:1425905]。

### 填充与否：关于[插补](@entry_id:270805)的争论

既然我们知道许多零值是技术性假象 (dropout)，一个诱人的想法随之产生：为什么不尝试将它们填补起来呢？如果我们看到一个细胞表达了几乎所有已知的 T 细胞标记，但一个关键标记为零，那么这极有可能是 dropout。我们可以查看数据集中其他相似的 T 细胞，并使用它们的平均表达水平来“插补”一个更现实的值。

这个**[插补](@entry_id:270805)**的过程功能强大，但也十分危险。它就像试图修复一幅褪色或受损的古典大师的画作。如果修复者技艺高超，对艺术家的风格有深刻的理解，他们可以填补缺失的部分，重现画作最初的辉煌。但一次拙劣的修复可能会制造出一件赝品，添加了从未存在过的细节，并摧毁了原作。

[插补](@entry_id:270805)也是如此。这些模型通常通过对数据集中一个细胞最近的“邻居”的表达谱进行平均来工作。如果这些邻居确实属于同一种细胞类型，这种局部平均可以完美地[平滑技术](@entry_id:634779)噪声，使潜在的生物学信号得以显现。但如果由于高噪声和稀疏性，算法错误地将不同类型的细胞识别为邻居呢？在这种情况下，平均过程不仅降低了噪声，还主动模糊了细胞类型之间真实的生物学差异。一个 T 细胞和一个 B 细胞的[插补](@entry_id:270805)后图谱会被拉得更近，人为地使它们看起来比实际更相似。在最坏的情况下，这可能完全抹去两个不同细胞群体之间的差异，导致我们错过一个发现，或者更糟的是，得出实际上存在差异时却不存在的结论 [@problem_id:2379659]。

一个更具原则性、也更诚实的思考该问题的方式来自贝叶斯视角。我们不应试图猜测一个*单一*的正确值来替换零，而应尝试估计真实值可能是什么的整个*[概率分布](@entry_id:146404)*。对于一个观察到的零计数，其背后的真相取决于上下文。如果这个零发生在我们[测序深度](@entry_id:178191)很深（文库大小很大）的细胞中，我们拥有大量信息，可以相当自信地认为真实的表达水平确实非常低。但如果这个零来自一个总读数很少的细胞，我们的测量就远不那么确定。真实的表达水平可能是零，也可能中等偏高，而我们只是因为那个有漏洞的“渔网”而运气不佳 [@problem_id:3349816]。

这种方法的美妙之处在于它拥抱了不确定性。我们不是用一个看似精确的单一数字替换零，而是将这种不确定性带入我们的下游分析中。这可以防止我们基于实际上高度不确定的数据做出自信的断言。这是处理我们数据中幽灵的统计学上诚实的方式，确保我们不会将自己插补的假设误认为是生物学现实 [@problem_id:3349816]。

### 稀疏之美

乍一看，[稀疏性](@entry_id:136793)似乎是单细胞数据中的一个致命缺陷——一片令人沮丧的缺失信息海洋。但正如我们所见，它的意义远不止于此。理解和建模稀疏性的努力已经成为创造力和洞察力的巨大引擎。

我们数据中的零值并非一片均匀的虚空；它们是一种结构化的空缺。生物学上的零是细胞身份的基础，而技术上的零则讲述了在技术极限下测量的概率性质的故事。这种二元性迫使我们构建复杂的统计模型，如**零膨胀负二项分布 (ZINB)**，它明确地解释了零值产生的两种不同方式：一次“dropout”事件或仅仅是缺乏表达 [@problem_id:3316073]。

稀疏性的挑战迫使我们成为更好的科学家。我们学到了朴素的统计方法，如简单的 t 检验，在这种数据上会惨败，因其忽略了数据的层级结构和复杂的噪声模式而产生大量假阳性 [@problem_id:2429782]。我们从其他领域借鉴了强大的思想，并创造了全新的方法。与天然“密集”的数据类型，如质谱流式细胞术 ([CyTOF](@entry_id:186311)) 的对比，清晰地表明：分析测[序数](@entry_id:150084)据的工具之所以特殊，恰恰是因为它们是在稀疏性的熔炉中锻造出来的 [@problem_id:2379613]。

我们数据矩阵中的空格并非失败的标志。它们是一个路标，指向对生命逻辑和测量艺术更深层次的理解。在学习解读虚无中的模式时，我们也在学习解读细胞本身。

