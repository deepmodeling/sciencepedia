## 应用与跨学科联系

知晓“是什么”是科学的伟大成就。基于“是什么”去知晓“将是什么”，似乎带有一丝奇迹的色彩。这就是[预测建模](@entry_id:166398)的世界，一个横跨宇宙的学科，从行星的轨道到股票市场的波动。在探索了这些数学水晶球的构建原理之后，让我们现在踏上一段旅程，去看看它们在自然栖息地中的样子。我们会发现，构建模型是一门精巧的技艺，而明智地使用它则需要深刻理解一个关键的区别：看到未来与改变未来之间的差异。

### 预言的两面：[相关与因果](@entry_id:141440)

想象你是一个正与污染问题作斗争的城市的公共卫生官员。一项新政策，即低排放区（LEZ），被提了出来。你求助于你的数据科学家，他们基于来自不同城市的历史数据建立了一个预测模型。模型给出了一个惊人的预测：在实施了 LEZ 的城市，住院率平均而言比没有实施的城市*更高*。幼稚的结论是，这项政策是一个有害的失败。

但事实果真如此吗？深入观察揭示了一个典型的陷阱。这类政策通常在哪些社区实施？是那些污染最严重、居民健康状况最差的地区！模型并未发现政策的缺陷；它重新发现了政策旨在解决的原始问题。政策与更高的住院率*相关*，因为它被部署在高风险地区。这是将相关性与因果关系“混淆”了。

一个真正的健康影响评估不只是问什么与政策相关联；它问的是*如果我们在这里，在我们的城市，实施这项政策*，与不实施相比，结果会是什么。它寻求一个反事实，即两个平行世界的比较。通过仔细调整基线污染水平——比较实施政策的高污染地区与其他未实施政策的高污染地区，同样也比较低污染地区——我们可以分离出政策的真正效果。在一次这样的分析中，正是那些暗示政策有害的同样数据，揭示了它实际上*导致*了住院率的显著降低（[@problem_id:4596166]）。幼稚的预测看到了每$10{,}000$人增加$2.0$次住院，而因果分析揭示了真实的减少量是$1.9$次。这其中的差异不仅仅是数量上的；它关系到整个故事的走向。

同样的情景也发生在医生的诊室里。一个基于大量医院记录训练的临床人工智能模型可能会观察到，接受某种激进疗法的患者比不接受的患者死亡率更高。如果被要求预测死亡率，模型会将该疗法与不良结果联系起来。但医生的工作不是被动预测，而是*干预*。这种疗法是给病情最危重的病人的。一项因果分析——通过比较接受与未接受治疗的相似患者，或许通过调整“严重性评分”——可以揭示，这种疗法虽然有风险，但与无所作为的替代方案相比，实际上是能拯救生命的（[@problem_id:4411437]）。一个基于相关性进行预测的模型，$P(Y \mid A)$，与一个为决策提供信息的模型是不同的工具，后者需要估计因果效应，$P(Y \mid \mathrm{do}(A))$。将两者混淆并非统计上的小过失；它可能是一个致命的错误。被动预测与主动干预之间的这种分裂是应用预测模型中最重要的一课。

### 建模者的技艺：从原始数据到精致的水晶球

知道目的地——一个可靠的预测——是一回事；导航通往那里的路径是另一回事。构建一个好的模型是一门由科学原理指导的艺术。

它始于细致的思考，而非花哨的算法。考虑构建一个预测乳腺癌患者预后的模型（[@problem_id:4439229]）。建模者不仅仅是向机器输入一堆数字。他们必须像生物学家一样行事，区分肿瘤本身的特征（如其[激素受体](@entry_id:141317)状态）和患者或“宿主”的特征（如年龄或绝经状态）。他们必须像统计学家一样行事，知道年龄是一个连续变量，将其强行划入如“年轻”和“年老”这样的任意区间会丢掉宝贵的信息。一个好模型的架构反映了对其试图代表的现实的深刻理解。

模型一旦建成，就迎来了关键时刻。假设生态学家创建了一个优美的模型，根据国家公园中鹿的历史种群数量，可以完美地“预测”1990年到2020年每一年的狼群数量。他们成功了吗？还没有。这是“后报”——解释过去。预测模型的唯一真正考验是它预测未来的能力。下一个合乎逻辑的步骤，也是唯一重要的步骤，是使用该模型和2021年的鹿群数量，为2022年的狼群数量生成一个具体的、可证伪的预测，然后走出去，数狼的数量，看看你是否正确（[@problem_id:1891142]）。一个未在新的、未见过的数据上验证过的模型，充其量是一个假说，最坏的情况下，是一场精心设计的拟合噪声的练习。

即使模型做出了预测，它的工作也并未完成。它所犯的错误不是垃圾，而是宝藏。想象一个用来预测学生随时间变化的考试成绩的模型（[@problem_id:2448037]）。如果我们观察模型的错误——其预测与实际分数之间的“残差”——并发现它们是完全随机的，就像收音机里的静电噪音，我们就可以感到满意了。这种“白噪声”表明模型已经捕捉了所有可预测的模式。但是如果错误本身有模式——例如，如果模型在每个春季学期都持续过于乐观——这就是一个迹象，表明我们的模型是不完整的。它遗漏了故事的某一部分，某个它尚未理解的系统性因素。一个大师级的建模者学会倾听残差中的低语，以不断完善他的创造。

此外，我们可以将我们对世界最深刻的知识直接构建到我们的模型中。在经济学中，人们常常观察到两个量，如原油价格和汽油价格，可能会暂时偏离，但最终被一条无形的经济纽带束缚在一起。它们有一个稳定的长期关系。一个明确包含这种“[协整](@entry_id:140284)”关系的预测模型，将比一个只关注短期、看似随机波动的幼稚模型做出远为优越的预测（[@problem_id:2380056]）。这是一个普遍的原则：将已知的物理、生物或经济[约束编码](@entry_id:197822)到模型的结构中，就像给了它一本规则手册，从而带来更智能、更稳健的预测。

### 行动中的预测：从洞察到干预

掌握了这些匠心独运的原则，我们现在可以以真正卓越的方式运用我们的模型，从简单地看见未来转向主动地塑造未来。

这一点在控制理论中表现得最为生动。想象你正在操作一个复杂的化工厂或一架灵活的无人机。你需要不断进行调整以使其保持在正轨上。在[模型预测控制](@entry_id:146965)（MPC）中，系统使用自身动力学模型来展望未来几秒钟。它基于*现在*可以采取的不同控制动作，模拟数千条可能的未来路径，选择导致最佳预测结果的动作，执行那一个动作，然后立即重复整个过程（[@problem_id:2724684]）。这是一个与自身预测的未来处于持续反馈循环中的系统。当然，内部模型永远不是现实的完美复制品。如果真实系统比模型认为的要稍“快”或“慢”怎么办？为了防止[误差累积](@entry_id:137710)并导致系统偏离轨道，控制器内置了稳健性。它在一个安全的“管”内规划其轨迹，收紧自身的约束，以确保即使现实偏离预测，它仍能安全地保持在期望的路径上。

这种基于预测采取行动的能力正在彻底改变医学。个性化医疗的梦想是为*你*量身定制治疗方案，而非为普通患者。考虑他汀类药物，一类常见的降胆[固醇](@entry_id:173187)药物。一小部分患者会经历一种名为肌病的痛苦副作用。我们能预测谁有风险吗？一个复杂的风险模型正是为此而生，它整合了患者的基因构成（如影响肝脏处理药物方式的 *SLCO1B1* 基因变异）、他们正在服用的其他药物（可能会抑制药物分解）、他们的年龄以及肾功能（[@problem_id:5042745]）。但构建这样一个模型揭示了另一层微妙之处。模型仅仅善于将患者从低风险到高风险排序（这一特性称为**区分度**，通常用 [AUROC](@entry_id:636693) 等指标衡量）是不够的。模型还必须经过**校准**——它的预测概率必须是诚实的。如果模型说一个患者有 $30\%$ 的风险，那么在一大群此类患者中，肌病的真实发生率最好接近 $30\%$。一个模型可以有完美的排序能力但校准度极差，告诉每个人他们的风险是实际的两倍。当一个模型从它被训练的医院转移到一个拥有不同患者群体的新医院时，必须对其进行检查并常常重新校准，调整其内部参数以在其新环境中如实地表达。

最后，即使有了完美的预测，我们的工作也并未结束。如果智能电网运营商的模型预测下午3点[电力](@entry_id:262356)需求将出现巨大激增，他们会立即问：“为什么？”（[@problem_id:4082631]）。一个没有解释的预测往往无法付诸行动。这催生了解释性人工智能这一新兴领域。像 Shapley 值这样的技术，借鉴自合作博弈论，为回答这个问题提供了一种数学上合理的方式。对于任何单一预测，它们允许我们将功劳（或责任）公平地分配给各种输入。模型可能会得出结论：“预测值比平均值高出 $50$ MW。我将其中 $+35$ MW 归因于异常高的温度，$+15$ MW 归因于这是一个工作日，而 $0$ MW 归因于风速。”这种解释预测背后“推理”的能力对于建立信任、调试模型和做出明智决策至关重要。

### 前沿：预测涌现与演化

这段旅程将在何处结束？或许它永无止境。[预测建模](@entry_id:166398)的雄心日益增长，从预测明确定义的数字转向预测复杂的、涌现的系统。

思考一下宏伟的演化织锦。[共同演化的地理镶嵌理论](@entry_id:136528)描述了一个世界，在这个世界里，物种间的进化军备竞赛——捕食者与猎物，植物与其传粉者——在不同地方以不同速度展开。一些地方是“[共同演化](@entry_id:151915)热点”，[相互选择](@entry_id:164859)压力激烈，而其他地方则是“冷点”。我们能预测明天的热点将出现在哪里吗？这就是前沿。为了解决这个问题，科学家们必须构建极其复杂的模型（[@problem_id:2719761]）。这些模型必须整合描述性状如何演化的[数量遗传学](@entry_id:154685)方程，以及决定物种在何处共存的[种群动态](@entry_id:136352)模型，所有这一切都由改变[适应度景观](@entry_id:162607)本身的未来气候变化预测所驱动。这不是简单的回归分析。这是对生态-演化过程本身的机械模拟。

这样的努力让我们回到了原点。它们提醒我们，最强大的预测并非来自“黑箱”的相关性，而是来自将我们对世界最深刻、最机械的理解编码成数学语言。这些模型不仅仅是预测工具；它们是我们知识的熔炉，考验并磨砺我们对现实复杂机制的理解。在它们之中，我们看到的不仅是世界可能是什么样子的反映，也是我们目前对它理解程度的反映。因此，我们的责任是以谨慎之心构建它们，以严谨之态测试它们，并以智慧之心使用它们，从而知晓观察世界与改变世界之间的区别。