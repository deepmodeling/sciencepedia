## 应用与跨学科联系

我们已经花了一些时间探讨[线性混合模型](@article_id:300149)的理论，审视了它们的结构和支撑其的数学基础。这有点像学习一门新语言的语法。但仅有语法并不能构成诗篇。这门语言的真正美妙之处在于它让我们能够讲述关于自然世界的故事。[线性混合模型](@article_id:300149)不只是一个抽象的统计工具；它们是一个多功能的透镜，用以观察生物学中无处不在的复杂、嵌套和相关的结构。在本章中，我们将穿越不同的科学领域，看看这个单一的框架如何提供一种统一的方式来提出——并回答——一些最微妙和有趣的问题。

### 从家族到基因：解释[亲缘关系](@article_id:351626)

让我们从最直观的非独立性形式开始：家庭。您与您的兄弟姐妹比与街上的一个随机的人更相似。这不是巧合；这是共享基因和共享环境的结果。现在，想象您是一位遗传学家，正在研究为什么不同的人体内一种关键的[凝血](@article_id:347483)蛋白——von Willebrand 因子（vWF）——水平不同。您有一个假设，即经典的遗传性状 ABO 血型在其中起作用。您收集数据并注意到 O 型血的人往往有较低的 vWF 水平。

但这里存在一个复杂情况。您的数据来自几个不同家庭的个体。如果您只是简单地将所有 O 型血个体与所有非 O 型血个体进行比较，您可能会被误导。一个恰好有很多 O 型血成员的家庭，也可能由于不相关的遗传或环境原因，倾向于具有较低的 vWF。您的简单比较会错误地将这种家庭层面的效应归因于 ABO 基因本身。

[线性混合模型](@article_id:300149)优雅地解决了这个问题。它允许我们建立一个 vWF 水平的模型，其中包含 ABO 基因型的固定效应——我们想要回答的特定问题——同时为每个家庭包含一个随机效应。这个随机效应吸收了一个家庭内部所有未指明的、共享的变异，无论是遗传的还是环境的。这就像告诉模型：“看，我知道这些兄弟姐妹不是独立的数据点。请考虑他们共有的“家庭性”，无论其来源如何，这样我就可以得到一个关于 ABO 效应本身的干净、无偏的估计。”通过这样做，我们可以将 ABO 位点的影响与家族相关的背景噪音分离开来，从而得到一个更清晰、更可信的答案 [@problem_id:2789245]。

### 个体即群体：追踪内部变化

“群体”的概念非常抽象。它不必是一个家庭。它可以是一个被反复测量的单一的个体。想象一位[行为生态学](@article_id:313674)家正在研究鸣禽的攻击性。为了解是什么使一只鸟具有攻击性，她可能会在模拟领地入侵前测量其睾酮水平，并记录它是否发起攻击。她对许多鸟重复这个过程。

这里的数据点不是独立的。一只天生具有攻击性的鸟在多次试验中都会倾向于表现出攻击性，无论其在那一刻的睾酮水平如何。一只更胆小的鸟则会倾向于保持胆小。[混合模型](@article_id:330275)通过为每只鸟分配一个随机截距来完美地处理这种情况 [@problem_id:2778889]。这个术语代表了鸟自身潜在的、基线的攻击性水平。通过考虑这种稳定的个体差异，我们可以提出一个更精细的问题：对于任何给定的鸟，其相对于自身基线的[睾酮](@article_id:312960)水平波动是否会改变其攻击的可能性？这种将混合模型扩展到[二元结果](@article_id:352719)的方法，被称为广义[线性混合模型](@article_id:300149)（GLMM），功能极其强大，使我们能够逐时剖析行为的原因。

同样地，这一原则在[分子生物学](@article_id:300774)领域也同样适用。当科学家使用[质谱法](@article_id:307631)测量细胞中蛋白质的含量时，他们不是直接看到蛋白质。他们检测到的是它的片段，称为肽段。来自同一蛋白质的不同肽段具有不同的化学性质，并以不同的效率被检测到——有些肽段天生就比其他肽段“更响亮”。为了估计蛋白质在两种条件（例如，健康与患病）之间的丰度变化，[混合模型](@article_id:330275)将蛋白质视为“个体”，将其肽段视为“重复测量”。它为每个肽段包含一个随机效应，以解释其固有的响亮度，从而可以精确估计适用于整个蛋白质的单一、共同的变化。这远优于简单的平均，因为它能适当地加权信息，并优雅地处理在某些样本中肽段缺失的常见问题 [@problem_id:2961290]。无论是在鸟类还是蛋白质的研究中，[混合模型](@article_id:330275)都通过首先考虑静态的、潜在的身份，来让我们看到动态的变化。

### 建模[亲缘关系](@article_id:351626)的织锦

简单的分组是有效的，但现实更为微妙。你的兄弟姐妹与你的关系比你的表亲更近，而你的表亲又比一个陌生人更近。我们能否不把“家庭”当作一个简单的桶，而是模拟这种连续的[亲缘关系](@article_id:351626)织锦呢？是的，这正是混合模型变得真正深刻的地方。

在[数量遗传学](@article_id:315097)中著名的“[动物模型](@article_id:365113)”中，随机遗传效应不仅仅是一个简单的分组。它的[协方差](@article_id:312296)结构直接由谱系指定，或者更精确地说，由从全基因组 DNA 标记计算出的基因组关系矩阵（GRM）指定。这个矩阵详细说明了每对个体之间精确的、测量的基因共享程度。

这使我们能够提出非常具体的问题。例如，在基因组印记理论中，一些基因的表达会根据它们是从母亲还是父亲那里遗传而有所不同。可以构建一个[线性混合模型](@article_id:300149)来明确区分这些[亲源效应](@article_id:357342)。它为每个个体包含两个不同的随机遗传效应：一个用于从其母亲那里遗传的一组基因，另一个用于从其父亲那里遗传的一组基因。两个亲属之间母源效应的协方差则由他们从共同的母系祖先那里遗传到相同基因的可能性决定，父源效应亦然。这使我们能够估计可归因于母源和父源基因组的独立方差，揭示了在表型中上演的隐藏的亲代冲突 [@problem_id:2819000]。

这种对[亲缘关系](@article_id:351626)的精细控制对于将单个基因的效应与构成基因组背景的数千个其他基因的效应分离开来也至关重要。想象一下测试一个“绿胡须基因”——这是一个迷人而罕见的进化现象，即一个基因使其携带者既展示一个信号（“绿胡须”），又优先帮助具有相同信号的其他人。共享此基因与帮助行为之间的简单相关可能是一种幻象；可能仅仅是因为亲属更有可能共享该基因，也因为其他原因（[亲缘选择](@article_id:299543)）而互相帮助。一个强大的[混合模型](@article_id:330275)可以同时将候选基因共享的效应作为固定效应来考虑，同时使用由全基因组关系矩阵构建的随机效应来模拟帮助亲属的背景倾向。这手术般地将特定的“绿胡须”效应与亲属关系的一般效应分离开来 [@problem_id:2720628]。

### 解构自然：一种[方差分量](@article_id:331264)的世界观

到目前为止，我们主要使用随机效应来控制无关变异。但我们可以反过来，让随机效应成为主角。我们不再问“在考虑了亲缘关系后，X 的效应是什么？”，而是问“一个性状的总变异有多少是*由于*[亲缘关系](@article_id:351626)造成的？”。这是遗传力的经典问题。

混合模型框架为这一思想提供了一个根本性的扩展。我们可以在同一个模型中包含多个随机效应，每个效应都有其自己的“关系”矩阵，从而将总[表型方差](@article_id:338175)划分为其组成来源。这开辟了全新的研究领域。

例如，我们越来越意识到，我们不仅仅是我们的基因；我们是生态系统。生活在我们肠道中的庞大[微生物群落](@article_id:347235)——[微生物组](@article_id:299355)——影响着我们的发育、健康和行为。使用[混合模型](@article_id:330275)，我们可以同时模拟宿主遗传学（使用基因组关系矩阵）和[微生物组](@article_id:299355)（使用从微生物群落组成中派生的“[微生物组](@article_id:299355)相似性矩阵”）的效应。然后，模型估计出两个独立的[方差分量](@article_id:331264)：$\sigma_g^2$，即[加性遗传方差](@article_id:314570)，和 $\sigma_m^2$，即可归因于微生物组的方差。每项解释的总方差比例，分别被称为遗传力（$h^2$）和新创造的词“[微生物遗传](@article_id:347225)力”（microbiability, $m^2$），可以直接进行比较，为我们提供一个量化的答案：这个性状更多地是由宿主的基因还是其微生物伙伴塑造的？[@problem_id:2630916]。

同样的逻辑也适用于基因组“之上”的调控层：[表观遗传学](@article_id:298552)。像 DNA 甲基化这样的表观遗传标记可以在不改变 DNA 序列本身的情况下改变基因的表达方式。通过构建一个“甲基化相似性矩阵”和遗传关系矩阵，我们可以拟合一个混合模型，将性状的方差划分为遗传分量和[表观遗传](@article_id:304236)分量。这使我们能够检测[表观遗传](@article_id:304236)的迹象——即通过 DNA 序列以外的机制传递性状 [@problem_id:2568101]。这是统计生物学最强大的应用，利用 LMM 解构生物体身份的本质。

### 基因与环境之舞

基因的效应很少是固定的；它常常取决于环境。这种相互作用被称为[基因型-环境互作](@article_id:381975)（$G \times E$），而混合模型是研究这场舞蹈的完美舞台。

想象一位研究植物入侵的生态学家。她可能会在两种不同的环境，比如低氮和高氮环境中，种植来自入侵谱系和本地谱系的植物。她的问题不仅仅是入侵者是否长得更大，而是它是否对高氮环境更*具响应性*——这是适应性[表型可塑性](@article_id:310165)的一个标志。混合模型可以包含谱系、环境以及至关重要的它们之间的互作项的固定效应。这个互作项的显著性直接检验了“[反应规范](@article_id:323404)”——连接低氮和高氮环境中表型的线——对于两个谱系是否具有不同的斜率。该模型还可以为每个谱系内的不同源种群包含随机效应，从而恰当地考虑了实验的层次结构 [@problem_id:2541167]。

我们可以将这个概念提升到一个更复杂的层次。在[全基因组关联分析](@article_id:327912)（GWAS）中，我们可能不仅想测试一个特定的[遗传变异](@article_id:302405)（SNP）是否对一个性状有[主效应](@article_id:349035)，还想测试其效应是否随着[环境梯度](@article_id:362614)的变化而改变。可以构建一个“随机回归”混合模型，其中包含被测 SNP 的固定互作项，同时也将整个背景多基因效应建模为既有恒定分量又有依赖于环境的分量（随机斜率）。这种强大的模型使我们能够将被测 SNP 的特定 GxE 互作与整个基因组特有的背景 GxE 分离开来。这需要仔细的[实验设计](@article_id:302887)，因为我们必须在不同环境中观察相关的个体，才能识别这些独立的[方差分量](@article_id:331264)，但它为遗传结构的复杂性提供了无与伦比的视角 [@problem_id:2718903]。

### 最终的统一：从遗传空间到物理空间

也许[线性混合模型](@article_id:300149)统一力量的最美妙例证是它们向地理学的扩展。用于模拟个体之间基于其[遗传相关](@article_id:323420)性的协方差的相同数学机制，同样可以用于模拟地点之间基于其物理邻近性的[协方差](@article_id:312296)。

想象你是一位生态学家，正在研究不同物种在景观中的分布。你发现一个物种在某些环境中更为丰富，这种效应被称为“[物种筛选](@article_id:313175)”。但你也注意到，彼此靠近的地点其[物种丰度](@article_id:357827)比仅凭环境所预期的更相似。这种“[空间自相关](@article_id:356007)”可能是由于未测量的环境因素，或者更有趣的是，由于生态过程如扩散限制——一个物种仅仅是还没有到达一个合适的、遥远的地点。

空间广义[线性混合模型](@article_id:300149)（spatial GLMM）可以优雅地剖析这些模式。它可以将[物种丰度](@article_id:357827)建模为已测环境变量的函数（固定效应，代表[物种筛选](@article_id:313175)）。同时，它可以包含一个[潜空间](@article_id:350962)[随机场](@article_id:356868)作为随机效应。这个随机场是一个[随机过程](@article_id:333307)，其中任意两点之间的[协方差](@article_id:312296)是它们之间距离的递减函数。这个项捕捉了任何残留的空间结构，这是[扩散](@article_id:327616)驱动过程或未测量的、具有空间格局的变量的统计特征。这使我们能够区分哪些可以由我们*所知*的环境来解释，哪些空间格局暗示着我们*所不知*的，或是在景观中展开的动态过程，如[扩散](@article_id:327616) [@problem_id:2507857]。

同一个核心思想——在指定[残差](@article_id:348682)的结构化协方差的同时对均值进行建模——能够解决基于家庭的遗传学、[行为生态学](@article_id:313674)、蛋白质组学、[表观遗传学](@article_id:298552)和[空间生态学](@article_id:369040)中的问题，这证明了[线性混合模型](@article_id:300149)框架深刻的统一性。它是一种用以描述嘈杂世界中结构的语言，一个揭示联系、划分复杂性，并最终加深我们对广泛生物现象理解的工具。