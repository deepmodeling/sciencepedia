## 引言
哪些整数可以写成两个完全平方数的和？这个源于数论早期历史的简单问题，提出了一个奇妙的谜题。虽然像 5 ($2^2+1^2$) 和 8 ($2^2+2^2$) 这样的数可以，但像 3 和 6 这样的数却顽固地拒绝合作。这种不一致性暗示着背后存在一种更深层次的、隐藏的结构，决定了哪些数能以这种方式表示。最初的模式难以捉摸，简单的规则似乎不足以解释，这暗示着我们需要超越反复试验的方法来弥补知识上的差距。

本文将踏上一段旅程，揭开这个数学之谜。它不仅会陈述两数[平方和](@article_id:321453)问题的最终定理，还将从头开始构建理解该定理所需的概念工具。你将学到一个视角的转变如何揭示数学不同领域之间深刻而美丽的联系。第一章“原理与机制”将引导你了解其核心逻辑，并介绍[高斯整数](@article_id:309967)这一强大的框架，它将彻底改变这个问题。随后，“应用与跨学科联系”一章将展示这个看似抽象的定理如何产生深远的影响，在计算机科学、抽象代数和数学物理等不同领域中回响。

## 原理与机制

那么，我们面临着这个来自数学童年时期的迷人问题：哪些整数可以写成两个完全平方数的和？你可以自己试试。$1$ 很容易，$1=1^2+0^2$。$2$ 也很容易，$2=1^2+1^2$。但 $3$ 似乎不可能。接着，$4=2^2+0^2$，$5=2^2+1^2$。$6$ 和 $7$ 似乎又很顽固。但 $8=2^2+2^2$ 却可以。一个模式似乎潜伏在阴影中，但并非一目了然。有些数可以，有些数不行。为什么？为了解开这个谜团，我们不会只罗列事实；我们将像伟大的数学家们那样踏上一段旅程，并发现这个简单的问题是通往一幅壮丽数学思想图景的门户。

### 平方数中的奇妙模式

让我们像优秀的物理学家或数学家一样，更系统化一些。当面对一个涉及整数的谜题时，一个强有力的技巧是看它们在只关心被某个小数除后的余数时表现如何。让我们试试除以 $4$。这通常被称为“模 4 运算”。

一个平方数除以 4 可能的余数是什么？
- 如果整数 $x$ 是偶数，其形式为 $2k$。它的平方是 $(2k)^2 = 4k^2$，除以 $4$ 余 $0$。我们记为 $x^2 \equiv 0 \pmod{4}$。
- 如果整数 $x$ 是奇数，其形式为 $2k+1$。它的平方是 $(2k+1)^2 = 4k^2 + 4k + 1 = 4(k^2+k)+1$。这会余 $1$。所以，$x^2 \equiv 1 \pmod{4}$。

就是这样。任何平方数除以 4，余数必然是 0 或 1。那么，两个平方数之和呢，比如 $n=a^2+b^2$？我们只需将可能的余数相加：
- $0+0 = 0$
- $0+1 = 1$
- $1+0 = 1$
- $1+1 = 2$

所以，任何*能*表示为两数[平方和](@article_id:321453)的数，在除以 4 时，余数必然是 0、1 或 2。它*永远*不可能余 3。这给了我们一条强有力的“排除法则” [@problem_id:1788976]。任何形如 $4k+3$ 的数都不能写成两个平方数之和。这立即解释了为什么 3、7、11、15、19、23 等数会出现在我们的“不可能”数列表中。

这是极好的第一步，但这并非全部。那数字 $6$ 呢？$6 \equiv 2 \pmod{4}$，所以它通过了我们的检验。然而，无论你怎么尝试，都找不到两个整数的平方和等于 6。我们的规则告诉我们哪些数*不能*是两数平方和，但它没有完全解释哪些数*可以*。要更深入地挖掘，我们需要一个新的视角，一个概念上的转变，从而在一个全新的光芒下揭示这个问题。

### 一个全新的数世界

方程 $n = a^2 + b^2$ 有一种熟悉的感觉。它看起来像[勾股定理](@article_id:351446)。它也带有一丝复数的味道。伟大的 Carl Friedrich Gauss 发现，关键在于将这两个想法融合起来。他注意到我们可以使用虚数单位 $i = \sqrt{-1}$ 来分解这个表达式：

$$n = a^2 + b^2 = (a+bi)(a-bi)$$

突然之间，我们关于整数 $\mathbb{Z}$ 中[平方和](@article_id:321453)的问题，被转化为了在一个新的数集——**高斯整数**（记作 $\mathbb{Z}[i]$）中的因数分解问题。这些数是所有形如 $a+bi$ 的数，其中 $a$ 和 $b$ 是整数。

不要仅仅将它们看作一些抽象的符号。想象一下！一个高斯整数 $a+bi$ 就是平面上的一个点 $(a,b)$。所有[高斯整数](@article_id:309967)的集合构成了一个美丽的、规则的网格，或称**格点** (lattice) [@problem_id:3088520]。我们熟悉的整数就是水平轴上的点。

这个新世界有自己的算术。两个高斯整数相加就像在平面上添加向量。但乘法才是真正神奇的地方。将一个数乘以，比如说，$1+i$，相当于将格点上的每个点旋转 $45^\circ$ 并将其与原点的距离拉伸 $\sqrt{2}$ 倍。通常，乘以一个[高斯整数](@article_id:309967) $w = a+bi$ 是一种[线性变换](@article_id:376365)，它将整个平面旋转 $w$ 的角度，并将所有距离按其模长 $|w| = \sqrt{a^2+b^2}$ 进行缩放 [@problem_id:3088520]。

表达式 $a^2+b^2$ 在这里也有其自然的意义：它是从原点到点 $(a,b)$ 的距离的平方。我们称之为高斯整数 $a+bi$ 的**范数** (norm)，记作 $N(a+bi) = a^2+b^2$。因此，我们最初的问题“整数 $n$ 是两个平方数之和吗？”完[全等](@article_id:323993)价于新问题：“$n$ 是某个[高斯整数的范数](@article_id:315830)吗？” [@problem_id:3088492]。

### 素数的秘密生活

为了理解哪些数是范数，我们转向算术的基石：素数。在我们熟悉的系统中，《[算术基本定理](@article_id:306840)》表明每个整数都可以唯一地分解为素数的乘积。事实证明，[高斯整数](@article_id:309967)也有自己的“[高斯素数](@article_id:317176)”和唯一因子分解性质 [@problem_id:3090028]。

但转折点在于：当我们普通的，或称“有理”素数进入这个新世界时，会发生什么？它们还保持素数身份吗？让我们来看看。

-   素数 $2$：在 $\mathbb{Z}[i]$ 中，我们发现 $2=(1+i)(1-i)$。数字 $2$ 分解成了两个新的实体！在这里它不再是素数。请注意，$N(1+i) = 1^2+1^2=2$。其因子的范数是 $2$。这种分解是几何事实 $2=1^2+1^2$ 的代数投影。

-   像 $5$ 和 $13$ 这样的素数（它们 $\equiv 1 \pmod{4}$）：在 $\mathbb{Z}[i]$ 中，$5 = (2+i)(2-i)$。它分解了！看，$N(2+i)=2^2+1^2=5$。对于 $13$，我们有 $13 = (3+2i)(3-2i)$，且 $N(3+2i)=3^2+2^2=13$。一个模式出现了。这些能写成两数[平方和](@article_id:321453)的素数，恰好是在高斯整数中分解或**分裂** (split) 的素数。在和 $p = a^2+b^2$ 中的整数 $a$ 和 $b$ ，不过是范数为 $p$ 的[高斯素数](@article_id:317176)因子 $a+bi$ 的分量 [@problem_id:3088550]。寻找两数[平方和](@article_id:321453)与在这个更大的世界里寻找素数的因子是同一回事！

-   像 $3$ 和 $7$ 这样的素数（它们 $\equiv 3 \pmod{4}$）：我们试着将 $3$ 分解为 $(a+bi)(c+di)$。对两边取范数得到 $N(3) = 3^2 = 9 = N(a+bi)N(c+di)$，即 $9 = (a^2+b^2)(c^2+d^2)$。要使之成为一个非平凡分解，我们需要 $a^2+b^2=3$。但我们从简单的模 4 规则中已经知道这是不可能的。分解 $3$ 的唯一方法是使用称为**单位** (units) 的平凡因子（范数为 1 的高斯整数：$1, -1, i, -i$）。所以，$3$ 无法被分解。它在 $\mathbb{Z}[i]$ 中保持素数。我们说它是**惰性** (inert) 的 [@problem_id:1788976]。

素数的秘密生活被揭示了：一个有理素数 $p$ 是两数平方和，当且仅当它在高斯整数的世界里不再是素数。

### 等价链：统一线索

我们已经收集了几条线索，现在我们可以将它们组合成一个单一、强大的互联声明。对于任何奇素数 $p$，以下这些看似来自完全不同数学分支的陈述，实际上是[逻辑等价](@article_id:307341)的——如果其中一个为真，那么所有都为真 [@problem_id:3093730]。

1.  **$p$ 可以写成两个平方数之和。**（$p = a^2+b^2$）
    这是一个关于特定方程整数解存在性的问题，属于[丢番图分析](@article_id:324781)的范畴。

2.  **$p$ 是一个[高斯整数的范数](@article_id:315830)。**（$p = N(a+bi)$）
    这将问题用[高斯整数](@article_id:309967)的几何和代数语言重新表述 [@problem_id:3093730] [@problem_id:3093730]。

3.  **$p$ 在[高斯整数环](@article_id:310013)中不是一个素数。**
    这是一个关于我们新数系[代数结构](@article_id:297503)的陈述。

4.  **[同余](@article_id:336894)方程 $x^2 \equiv -1 \pmod{p}$ 有整数解。**
    这是一个来自[模算术](@article_id:304132)的陈述。它为什么是相关的呢？因为如果存在这样一个 $x$，那么 $p$ 整除 $x^2+1 = (x+i)(x-i)$。但 $p$ 显然不能在 $\mathbb{Z}[i]$ 中整除 $x+i$ 或 $x-i$（如果可以，那么 $1/p$ 将必须是一个整数！）。既然 $p$ 整除其乘积而不整除任一因子，那么它在 $\mathbb{Z}[i]$ 中不可能是素数 [@problem_id:3088492]。这就是连接模算术与高斯分解的深层机制。

5.  **$p$ 模 4 余 1。**（$p \equiv 1 \pmod{4}$）
    这个简单的分类是解开一切的关键。利用一个称为欧拉准则的结果，可以证明 $x^2 \equiv -1 \pmod p$ 有解当且仅当 $p \equiv 1 \pmod 4$ [@problem_id:3088791]。

这条美丽的链条揭示了数学深刻的统一性。一个关于[平方和](@article_id:321453)的简单问题，与格点的几何学、抽象[环的结构](@article_id:311324)以及[模算术](@article_id:304132)的精妙之处联系在了一起。

### 从素数到所有数

现在我们可以处理任何正整数 $n$。从素数到合数的桥梁是一个卓越的恒等式，称为**[婆罗摩笈多-斐波那契恒等式](@article_id:638192)** (Brahmagupta-Fibonacci identity)：
$$(a^2+b^2)(c^2+d^2) = (ac-bd)^2 + (ad+bc)^2$$
这个公式表明，如果两个数都是两数[平方和](@article_id:321453)，它们的积也是两数平方和。用我们的新语言来说，这只是一个简单的陈述，即范数是乘性的：$N(\alpha)N(\beta) = N(\alpha\beta)$。

这意味着我们可以通过查看任何数 $n$ 的[素因数分解](@article_id:312472)来分析它。
-   素数 $2$ 是两数平方和（$1^2+1^2$）。
-   任何素数 $p \equiv 1 \pmod 4$ 都是两数[平方和](@article_id:321453)。
-   这些数的任意组合的乘积也将是两数平方和。

那些捣乱者，即[惰性素数](@article_id:375201) $q \equiv 3 \pmod 4$ 呢？假设这样一个素数 $q$ 出现在 $n$ 的分解中。如果 $n = a^2+b^2$，那么我们有 $a^2+b^2 \equiv 0 \pmod q$。正如我们所见，这只有在 $a$ 和 $b$ 本身都是 $q$ 的倍数时才可能。这意味着 $a=qa'$ 和 $b=qb'$，所以 $n = (qa')^2 + (qb')^2 = q^2(a'^2+b'^2)$。这告诉我们两件事：首先，$q^2$ 必须整除 $n$；其次，$n/q^2$ 这个数也必须是两数[平方和](@article_id:321453)。如果我们继续应用这个逻辑，我们会发现 $q$ 在 $n$ 的[素因数分解](@article_id:312472)中的总幂次必须是偶数 [@problem_id:3081207]。

于是，我们得出了完整而宏伟的定理：

**一个正整数 $n$ 可以写成两个平方数之和，当且仅当在其[素因数分解](@article_id:312472)中，每个形如 $4k+3$ 的素因数都以偶数次幂出现。** [@problem_id:3090028]

这完全解释了我们对数字 $6$ 的观察。它的分解是 $2 \times 3$。素数 $3$ 是 $4k+3$ 的形式，它的指数是 $1$，是奇数。因此，$6$ 不能是两数[平方和](@article_id:321453)。另一方面，$18 = 2 \times 3^2$。这里，素数 $3$ 以指数 $2$ 出现，是偶数。所以，$18$ *必然*是两数平方和，事实也确实如此：$18 = 3^2+3^2$。

### 唯一性问题

还剩最后一个问题。当一个数可以写成两数平方和时，这种写法是唯一的吗？对于 $5$，我们有 $1^2+2^2$。当然，我们也可以写成 $2^2+1^2$，或使用负数如 $(-1)^2+2^2$。这些本质上是不同的吗？

不完全是。它们都属于同一个家族。在高斯整数的世界里，这些“平凡”的变体对应于乘以四个单位 $\{\pm 1, \pm i\}$，以及取[复共轭](@article_id:353729) [@problem_id:3021530]。例如，表示 $(\pm 1, \pm 2)$ 和 $(\pm 2, \pm 1)$ 构成了一个包含 8 对数的“轨道”，对应于[高斯整数](@article_id:309967) $\pm 1 \pm 2i$ 和 $\pm 2 \pm i$。

对于一个素数 $p \equiv 1 \pmod 4$，事实证明总是恰好有*一个*这样的解族 [@problem_id:3021530]。例如，$13$ 是 $2^2+3^2$，这基本上就是唯一的表示法。这种唯一性反映了 $13$ 分解为一对唯一的[共轭](@article_id:312168)[高斯素数](@article_id:317176) $(3+2i)$ 和 $(3-2i)$ 的事实。

对于合数，情况更加丰富。将 $n$ 写成两数[平方和](@article_id:321453)的“本质”方法的数量，与它形如 $4k+1$ 的素因子的指数有关。如果 $n = \prod p_i^{e_i}$（忽略因子 2 和 $\equiv 3 \pmod 4$ 的素数），那么方法的数量与数字 $(e_i+1)$ 的乘积有关 [@problem_id:3021530]。例如，$65 = 5 \times 13$。两者都是 $\equiv 1 \pmod 4$ 的素数。我们发现 65 有两种本质上不同的表示法：$65 = 1^2+8^2$ 和 $65=4^2+7^2$。

一个始于简单算术谜题的问题，引领我们进入了一个拥有自身几何和素数的新数系，揭示了一种深刻而出乎意料的和谐，它将我们用于计数的整数与我们绘制的[复平面](@article_id:318633)联系起来。这就是数学之美：简单的问题往往拥有最深刻、最优雅的答案。

