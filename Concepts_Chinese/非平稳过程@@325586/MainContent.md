## 引言
在时间序列研究中，[平稳性](@article_id:304207)——即均值和方差等统计特性不随时间变化的性质——为分析提供了坚实的基础。然而，大多数现实世界的现象，从一个国家的GDP到一个物种的基因构成，都不符合这一理想状态。它们会增长、演化并经历结构性转变。这种动态行为是[非平稳过程](@article_id:333457)的标志，理解它们对于准确解读我们周围的世界至关重要。其核心挑战在于，许多经典的统计工具是为平稳世界设计的，将它们轻率地应用于[非平稳数据](@article_id:325200)可能导致根本性的错误结论。

本文将全面介绍[非平稳性](@article_id:359918)的概念。第一章“原理与机制”将通过探讨其两种主要形式来揭开[非平稳性](@article_id:359918)的神秘面纱：可预测的确定性趋势和被称为单位根的不可预测的随机漂移。它还将揭示忽略[非平稳性](@article_id:359918)的巨大风险，如[伪相关](@article_id:305673)的幻觉，并引入优雅的差分解决方法。第二章“应用与跨学科联系”将阐释这些概念的至关重要性，展示它们如何为我们洞察从经济关系、[金融市场](@article_id:303273)波动到演化生物学机制等一切事物提供见解。读完本文，您将拥有一个强大的框架，用于识别、理解和分析定义我们世界的各种变化过程。

## 原理与机制

想象一下，你正站在海滩上观赏海浪。大海波涛汹涌，没有两朵浪花是完全相同的。然而，在某种程度上，这幅景象又是恒定的。平均水位保持不变，而波浪的“颠簸”程度——即其方差——在你观察的几分钟内似乎也保持一致。如果你记录下浪高并分析其统计特性，你可能会发现这些特性不随时间变化。你刚刚邂逅了**[平稳性](@article_id:304207)**的核心思想。如果一个过程的统计“个性”在所有时间点都保持不变，那么它就是平稳的。它的均值、方差以及其数值在不同时间滞后上的相关方式都是恒定不变的特征。

平稳性这一概念是[时间序列分析](@article_id:357805)的基石。它是一个强大的简化假设。但当我们从理想化的海滩转向周围的[世界时](@article_id:338897)，会发现这种美妙的简单性通常只是——一个理想。经济在增长，气候在变化，病人的心跳在压力下改变。大多数有趣的现实世界过程实际上是**非平稳**的。它们的统计特性在演变。游戏规则在游戏进行中发生着改变。要理解这些过程，我们不能仅仅给它们贴上“非平稳”的标签然后放弃。我们必须本着物理学的精神，对一个过程可以违背平稳性的不同*方式*进行分类和理解。

### 可预测的与[随机游走](@article_id:303058)的

让我们从一个问题开始：什么会导致一个过程变得非平稳？我们可以将原因大致分为两类：可预测的确定性变化和不可预测的随机性漂移。

想象一位经济学家正在为一个国家的国内生产总值（GDP）建模。很明显，几十年来，GDP倾向于增长。一个简单的模型可能会将GDP表示为一个稳定的线性增长趋势和围绕该趋势的一些随机经济波动的组合，如下所示：$Y_t = a + bt + X_t$。这里，$X_t$ 代表平稳的商业周期波动，但确定性项 $a+bt$ 意味着GDP的均值 $\mathbb{E}[Y_t] = a + bt$ 在不断增加。这个过程被拴在一条上升的直线上。因为它的均值依赖于时间 $t$，所以该过程是非平稳的 [@problem_id:1283528]。

这种[非平稳性](@article_id:359918)不仅限于线性趋势。考虑来自某个电子设备的信号。它可能由一个真实的、潜在的平稳噪声过程组成，但被来自60赫兹交流电源线的微弱嗡嗡声所干扰。我们可以将其建模为 $X_t = Z_t + A \cos(\omega t + \phi)$，其中 $Z_t$ 是平稳噪声，余弦项是嗡嗡声。这个过程的均值 $\mathbb{E}[X_t] = A \cos(\omega t + \phi)$ 以一种完全可预测的周期性方式[振荡](@article_id:331484)。由于均值不是常数，该过程是非平稳的 [@problem_id:1335184]。这类具有确定性趋势（线性的、周期性的或其他形式）的过程有时被称为**趋势平稳**过程，因为如果我们能够完美地识别并减去确定性趋势，剩下的部分将是平稳的。

但还存在一种更深刻、更微妙的[非平稳性](@article_id:359918)。想象一个悬浮在水中的微小花粉粒，被水分子不断碰撞。它的运动，即布朗运动，是一个经典的**[随机游走](@article_id:303058)**。每一步的移动都是随机的，但每个新位置都建立在上一位置的基础上。粒子不会试图返回其起点；它只是四处游荡。从股票价格到[觅食](@article_id:360833)动物的位置，许多现象都可以用这种方式建模。一个简单的[随机游走](@article_id:303058)由方程 $Y_t = Y_{t-1} + \varepsilon_t$ 描述，其中 $\varepsilon_t$ 是在时间 $t$ 的一个随机冲击。

为什么这是非平稳的？关键在于要看到这个过程具有一种不可磨灭的记忆。通过反复代入，我们可以将时间 $t$ 的位置写成所有过去冲击的总和：$Y_t = Y_0 + \sum_{i=1}^t \varepsilon_i$。假设我们从 $Y_0=0$ 开始。其均值可能是恒定的（如果冲击的均值为零，则均值为零），但方差呢？独立冲击之和的方差等于它们各自方差的和。如果每次冲击的方差为 $\sigma^2$，那么粒子在时间 $t$ 的位置方差为 $\text{Var}(Y_t) = t\sigma^2$ [@problem_id:1964421]。方差随时间线性增长！过程运行的时间越长，其位置就越不确定。它会扩散，散布在一个越来越宽的可能性范围内。这是对[平稳性](@article_id:304207)的根本违反。

这类过程非常重要，以至于它有一个特殊的名字：**单位根过程**。这个名字来源于它与表现良好的自回归（AR）模型 $X_t = \phi X_{t-1} + \varepsilon_t$ 的联系。只有当系数 $|\phi| \lt 1$ 时，这个AR过程才是平稳的，这确保了过去冲击的影响最终会消失。[随机游走](@article_id:303058)对应于 $\phi=1$ 的边界情况 [@problem_id:1283576]。当 $\phi=1$ 时，冲击不会被衰减；它们的影响永久持续，在过程的历史中累积，并导致方差不断增长。这是一种纯粹由随机性驱动的非平稳形式，其驱动力不是可预测的外部趋势，而是过程本身的内部动态。

### [差分](@article_id:301764)的魔力

因此，我们有两种类型的非平稳行为：一种由可预测的趋势驱动，另一种由[随机游走](@article_id:303058)的累积记忆驱动。我们怎么可能用为[平稳过程](@article_id:375000)的稳定世界构建的工具来分析它们呢？答案在于一个极其简单却又强大的思想：关注变化量，而非水平值。

考虑一只股票的每日价格。正如我们所见，它可能表现得像一个[随机游走](@article_id:303058)，$Y_t = Y_{t-1} + \varepsilon_t$，因此是非平稳的。但是，从一天到下一天的价格*变化*呢？让我们定义一个新过程，$R_t = Y_t - Y_{t-1}$。代入 $Y_t$ 的模型，我们得到 $R_t = (Y_{t-1} + \varepsilon_t) - Y_{t-1} = \varepsilon_t$。每日回报的过程就是随机冲击的序列！这是一个**白噪声**过程，是平稳简单性的极致定义 [@problem_id:1282980]。

这种被称为**[差分](@article_id:301764)**的转换是我们的关键。通过取连续观测值之间的差，我们剥离了非平稳的“游走”行为，揭示出一个平稳的核心。这类似于一个以随机速度运动的物体；它的位置是非平稳的，但它的速度可以是平稳的。差分在数学上等同于将我们的焦点从位置转移到速度。

这个思想在**ARIMA**（自回归整合[移动平均](@article_id:382390)）框架中得到了形式化。ARIMA中的“I”代表**整合**（Integrated），这只是说该过程是非平稳的，但可以通过差分来修正。*整合的阶数*，记为 $d$，是我们为达到[平稳性](@article_id:304207)需要进行差分操作的次数 [@problem_id:1897454]。一个[随机游走](@article_id:303058)是一阶整合的，或称为I(1)。某些过程，比如一个受随机力撞击的物体的加速度，可能需要[差分](@article_id:301764)两次才能变得平稳；它们是I(2)。这为我们提供了一种语言来分类和驯服不同程度的[随机游走](@article_id:303058)。

### 机器中的幽灵：忽略[非平稳性](@article_id:359918)的危险

如果我们不小心会发生什么？如果我们使用为平稳时间序列设计的工具来分析[非平稳时间序列](@article_id:344840)会怎样？其后果不仅仅是微小的不准确；它们可能导致荒谬的错误结论。

#### 看见不存在的模式

这是所有统计学中最危险的陷阱之一：**[伪相关](@article_id:305673)**。以两个学生为例，每人都在抛硬币。假设正面为 `+1`，反面为 `-1`。我们可以追踪每个学生随时间变化的累积分数。这是两个完全独立的[随机游走](@article_id:303058)。现在，将一个学生的累积分数对另一个学生的累积分数作图。令人惊讶的是，你很可能会看到一个看似强烈的关系。也许在前50次抛掷中，两个学生碰巧都得到更多的正面，所以他们的分数都一起向上漂移。这看起来就像一个学生的“成功”导致了另一个学生的“成功”。

这不是侥幸。这是一个数学上的必然。因为[随机游走](@article_id:303058)不回归于均值，它们可以自由地游荡。纯粹出于偶然，两个独立的游走可能会在很长一段时间内向同一方向游荡。形式化的分析表明，两个独立[随机游走](@article_id:303058)之间测得的[协方差](@article_id:312296)的方差是巨大的，并且随着序列长度 $N$ 的增加而迅速增长。这意味着观察到大的、“统计上显著的”相关性不是例外，而是常态 [@problem_id:1953487]。你正在发现机器中的幽灵——这些模式是由[非平稳性](@article_id:359918)这一共同属性制造的幻觉。这一个陷阱已经导致了无数错误的科学结论，从经济学到生态学。

#### 失效的工具与有缺陷的逻辑

问题还远不止于此。我们用来理解过程的工具本身也可能失灵。其中一个工具是**[遍历性](@article_id:306881)**的概念。对于一个同时也是遍历的[平稳过程](@article_id:375000)，一个足够长的[样本路径](@article_id:323668)包含了关于整个过程的所有统计信息。来自一个实现的时间平均值与跨越许多不同实现的系综平均值相同。这是一个美妙的性质；它意味着我们可以通过长时间观察海滩上的一个点来了解整个“海洋”的一切。

但这个性质从根本上依赖于平稳性。如果一个过程是非平稳的，它的统计特性就在变化。一个增长中经济的单一路径只告诉你那一个特定的历史轨迹；它无法告诉你所有可能经济体的全部故事，因为其底层规则在演变 [@problem_id:1755494]。时间平均值不再等于系综平均值。

我们的[频率分析](@article_id:325961)工具也失效了。经典的**[功率谱密度](@article_id:301444)（PSD）**告诉我们一个信号的功率是如何分布在不同频率上的。它是根据[自相关函数](@article_id:298775)计算的，对于[平稳过程](@article_id:375000)，[自相关函数](@article_id:298775)只依赖于时间滞后。但是，一个增长中的GDP的频率内容是什么？这个问题本身就提得不恰当。不同频率上的功率*随时间变化*。单一、不随时间变化的[频谱](@article_id:340514)概念是无意义的。要分析这样的信号，我们需要更复杂的工具，如**演化谱**，$S_x(\omega, t)$，它给出了频率 $\omega$ 在*时间* $t$ 的功率 [@problem_id:2892461]。这表明，[非平稳性](@article_id:359918)迫使我们重新发明我们最基本的分析方法，从静态的图片转向动态的电影。

最后，一句忠告。在我们担心平稳性之前，必须确保我们的模型具有物理意义。一个提出的数学模型可能看起来很优雅，但如果它意味着一个信号的方差可以是负的，那么它在根本上是有缺陷的，并且描述不了任何可能的现实 [@problem_id:1311035]。我们对[非平稳性](@article_id:359918)复杂性的探索之旅必须始终植根于逻辑和现实世界的约束。宇宙是微妙的，但它不是恶意的，而且它肯定没有负方差。