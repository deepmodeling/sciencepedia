## 引言
在[计算流体力学](@entry_id:747620) (CFD) 中，数学模型是对现实至关重要但又不完美的近似。虽然模拟可以产生看似精确的结果，但一个关键的知识鸿沟常常存在：我们对这些预测的置信度有多高？本文通过全面介绍不确定性量化 (UQ) 来应对这一挑战。UQ 是一门理解和表征计算模型固有不确定性的科学。它超越了简单地获得答案，转而评估该答案的可靠性。读者将首先探索基础的“原理与机制”，区分 UQ 与[验证和确认](@entry_id:170361)，并研究核心传播技术，如 Monte Carlo 方法和随机配置。随后，“应用与跨学科联系”部分将展示这些原理如何应用于解决实际问题，从确认湍流模型到做出风险知情的工程决策。

## 原理与机制

在我们用数学描述物理世界的探索中，我们不可避免地会创建模型。无论是宏伟的、控制流体流动的 [Navier-Stokes](@entry_id:276387) 方程，还是简化的[湍流模型](@entry_id:190404)，我们始终在处理现实的近似。计算科学的核心挑战不仅在于从我们的模型中获得答案，还在于理解我们对这个答案的信任程度。这就是不确定性量化 (UQ) 的核心。但在我们能够量化预测中的不确定性之前，我们必须首先领会笼罩在我们通往世界的计算窗口之上的所有潜在错误和未知因素。

### 不确定性的全景：我们是在正确地求解方程，还是在求解正确的方程？

想象一下，我们写下了一套优美的[偏微分方程](@entry_id:141332)，比如用以描述[翼型](@entry_id:195951)上的空气流动。然后我们用计算机来寻找一个解。我们计算出的数字与真实物理现实之间的差异可以分解为几个不同的部分。这有点像一个侦探故事；我们必须识别出所有的嫌疑人。

首先，是我们自己造成的误差，即数值误差。我们的计算机无法处理连续介质的无限细节，所以我们将方程离散化到有限大小的网格上。这引入了**离散误差**：我们连续方程的精确解与我们实际放在计算机上求解的离散方程的精确解之间的差异 [@problem_id:3385672]。然后，我们的代数求解器通常是迭代工作的，当答案“足够接近”时便停止，这会留下一个微小的**迭代求解器误差**。最后，每次计算都使用有限精度的数字完成，会累积微小的**[浮点舍入](@entry_id:749455)误差**。追查和估计这些数值误差的过程称为**验证 (Verification)**。它回答了那个根本问题：*我们是否在正确地求解方程？* 我们必须确保我们的代码没有错误，并且我们的数值解是我们着手求解的数学模型的忠实近似 [@problem_id:3385653]。

但是，即使是一个经过完美验证的代码——一个能够以极高精度求解其给定方程的代码——仍可能给出完全错误的答案。为什么？因为方程本身可能有缺陷。我们可能使用了一个不适用于我们特定流动状态的[湍流模型](@entry_id:190404)，或者忽略了我们认为很小的某些物理效应。这就引出了一个更深层次的问题，由**确认 (Validation)** 过程来解决：*我们是否在求解正确的方程？* 确认是一项科学活动。它要求我们将模型的预测与精心进行的物理实验进行比较，同时考虑模拟和测量中的不确定性 [@problem_id:3385653]。

最后，我们来到了**不确定性量化 (UQ)** 的领域。UQ 承认，即使我们“正确”的方程及其输入也永远无法被完美地知晓。流体的粘度、入口的温度、表面的粗糙度、我们湍流模型中的经验常数——所有这些都存在一定程度的不确定性。UQ 是一个严谨的、端到端的过程，它识别这些不确定性，用概率的语言来表征它们，并追踪它们如何通过我们的模拟传播以影响最终答案。它是一门科学，不仅告诉我们“[阻力系数](@entry_id:276893)是 0.05”，而且告诉我们“[阻力系数](@entry_id:276893)是 0.05，我们有 95% 的信心它位于 0.048 和 0.052 之间。”

### “如果……会怎样”的游戏：传播不确定性

在其核心，[不确定性传播](@entry_id:146574)是一个系统的“如果……会怎样”游戏。想象一下我们的 CFD 求解器是一个黑箱。我们输入一组参数——[雷诺数](@entry_id:136372)、入口温度等等——它就会输出一个答案，即我们的关注量 (QoI)，比如[扩散](@entry_id:141445)器两端的[压降](@entry_id:267492)或管道中的传热 [@problem_id:2497421]。UQ 问题在于，我们对每个输入并非只有一个单一的值；我们有一系列可能性，或许可以用一个[概率分布](@entry_id:146404)来描述。例如，制造[公差](@entry_id:275018)可能意味着管道的直径不完全是 $1\,\mathrm{cm}$，而是一个以 $1\,\mathrm{cm}$ 为中心、具有小[方差](@entry_id:200758)的[随机变量](@entry_id:195330)。

在给定输入[分布](@entry_id:182848)的情况下，我们如何找到输出的[分布](@entry_id:182848)呢？挑战在于，这个“黑箱”是一个高度复杂、[非线性](@entry_id:637147)的函数。我们不能简单地将输入的均值代入，就期望得到输出的均值。这种关系要微妙得多。我们需要一种方法，将整个输入可能性的云图映射到相应的输出可能性的云图。

### 蛮力路径：[Monte Carlo](@entry_id:144354) 方法的简单之美

最直观且至关重要的[不确定性传播](@entry_id:146574)方法是 **[Monte Carlo](@entry_id:144354) (MC) 方法**。其思想异常简单：如果你不知道哪些输入值是“正确”的，那就尝试大量的值！你根据指定的[概率分布](@entry_id:146404)，抽取一组包含 $N$ 个输入参数的样本 $\{\mathbf{X}_i\}_{i=1}^N$。对于每个样本，你运行一次昂贵的 CFD 求解器，将其视为一个确定性的黑箱，并收集输出的 QoI，$Q(\mathbf{X}_i)$。为了估计输出的均值，你只需计算所有结果的平均值 [@problem_id:3385629]。

让我们将 QoI 的评估值称为 $Y_i = Q(\mathbf{X}_i)$。真实均值 $\mu = \mathbb{E}[Y]$ 的 MC 估计量就是样本均值：
$$
\hat{\mu} = \frac{1}{N} \sum_{i=1}^N Y_i
$$
这个估计量是无偏的，意味着平均而言，它能给你正确的答案。MC 方法的威力在于其稳健性。[中心极限定理](@entry_id:143108)告诉我们，这个估计量的[统计误差](@entry_id:755391)——其[均方根误差](@entry_id:170440)——以与 $1/\sqrt{N}$ 成正比的速率减小。
$$
\text{RMSE}(\hat{\mu}) = \frac{\sigma}{\sqrt{N}}
$$
其中 $\sigma$ 是输出 QoI 的标准差。这个 $O(N^{-1/2})$ 的收敛速率是出了名的慢。为了多获得一位小数的精度，你需要 100 倍的样本量！然而，这个速率有一个神奇的特性：它不依赖于不确定输入参数的数量（$\mathbf{X}$ 的维度），也不依赖于关系 $Q(\mathbf{X})$ 的平滑或复杂程度。对于有几十个不确定参数或输出奇异、“扭结”的问题，简单、可靠、即使缓慢的 [Monte Carlo](@entry_id:144354) 方法通常是唯一有效工具 [@problem_id:3348340]。

### 未知因素的众生相：参数、物理学和物理实在性

为了执行 UQ，我们必须首先通过分类来驯服“未知因素”。在**[参数不确定性](@entry_id:264387)**和**[模型形式不确定性](@entry_id:752061)**之间存在着一个关键的区别 [@problem_id:3385626]。

**[参数不确定性](@entry_id:264387)**指的是我们对所选模型中出现的常数的认知不完整。例如，在广泛使用的 $k-\epsilon$ 湍流模型中，有少数几个经验系数，如 $C_\mu, C_{\epsilon 1}$ 和 $C_{\epsilon 2}$。这些系数是根据一系列经典流动进行调整的，但它们并非自然的[普适常数](@entry_id:165600)。将它们视为以其“标准”值为中心的[随机变量](@entry_id:195330)，是表示[参数不确定性](@entry_id:264387)的一种常见方式。

另一方面，**[模型形式不确定性](@entry_id:752061)**是一个更深层次、更困难的问题。它承认我们模型的结构本身就是一种近似。例如，大多数简单的 RANS 模型使用线性涡粘假设，该假设假定[湍流](@entry_id:151300)[雷诺应力](@entry_id:263788)与平均应变率张量是共线的。众所周知，这一假设在具有强曲率或旋转的流动中会失效。[模型形式不确定性](@entry_id:752061)是即使我们完美地知道了所有模型参数后仍然会存在的误差。量化它通常涉及扰动模型方程本身，例如，通过添加数据驱动的差异项或扰动预测的[雷诺应力张量](@entry_id:270803)的[特征值](@entry_id:154894)和[特征向量](@entry_id:151813) [@problem_id:3385626]。

即使我们引入了不确定性，我们的模型仍必须遵守基本的物理定律。这就是**[可实现性](@entry_id:193701) (realizability)** 的概念。例如，[雷诺应力张量](@entry_id:270803) $R_{ij} = \overline{u'_i u'_j}$，根据其定义，是速度脉动的协方差矩阵。因此，它必须是对称且半正定的。这其中就意味着，[湍动能](@entry_id:262712) $k = \frac{1}{2} \mathrm{Tr}(R)$ 永远不能为负。同样，[耗散率](@entry_id:748577) $\epsilon$ 必须为正。任何针对湍流模型的 UQ 框架都必须在每一个样本上强制执行这些约束，以避免产生不符合物理实际的结果 [@problem_id:3385626]。

### 更智能的采样：追求效率

当每个样本都需要数小时或数天的 CFD 模拟时，Monte Carlo 方法 $1/\sqrt{N}$ 的[收敛速度](@entry_id:636873)代价高昂。这推动了对更高效方法的探索。关键的洞见是，如果输出 $Q(\boldsymbol{\xi})$ 是输入参数 $\boldsymbol{\xi}$ 的一个平滑函数，我们应该能够利用这种平滑性来做得比[随机采样](@entry_id:175193)更好。这催生了一系列所谓的**谱方法**，如[多项式混沌展开](@entry_id:162793)和随机配置。

首先，必须做一个关键的实践区分：我们的方法是**侵入式**还是**非侵入式**的？[@problem_id:3348321]。非侵入式方法将现有的 CFD 求解器视为一个不可变的黑箱。它只是像 [Monte Carlo](@entry_id:144354) 方法一样，用不同的输入重复运行求解器。其“智能”之处全在于一个外部包装器，它巧妙地选择采样点并对结果进行后处理。相比之下，侵入式方法需要修改 CFD 求解器本身的源代码。例如，随机 Galerkin 方法会重新构建控制方程，以直接求解多项式展开的系数，从而产生一个更大、更复杂的耦合系统。尽管可能非常高效，但这种“侵入性”是实施的主要障碍，因为它需要对物理和代码库都有深入的专业知识。因此，非侵入式方法在实践中远为流行。

最强大的非侵入式方法之一是**随机配置 (Stochastic Collocation, SC)**。SC 不进行[随机采样](@entry_id:175193)，而是在特定的“智能”位置——配置节点——选择输入参数值。这些节点，就像高斯求积中使用的点一样，是为构建一个插值真实输入输出函数的多项式而最优选择的。其思想是建立一个计算成本低廉的代理模型，$\mathcal{I}[Q](\boldsymbol{\xi}) = \sum_{j=1}^{M} Q(\boldsymbol{\xi}^{(j)}) \ell_j(\boldsymbol{\xi})$，其中 $\ell_j$ 是基于在节点 $\boldsymbol{\xi}^{(j)}$ 处的 $M$ 次求解器评估的[拉格朗日多项式](@entry_id:142463) [@problem_id:3348407]。这个代理模型的存在性和唯一性取决于节点的正确选择，这一性质被称为单解性 (unisolvence)。一旦这个多项式代理模型建立起来，我们就可以通过对多项式进行积分，几乎瞬间计算出均值和[方差](@entry_id:200758)等统计量，或者可以以零额外成本对其进行数百万次采样。

### 伟大的赛跑：为任务选择正确的工具

我们现在有了一个包含根本不同方法的工具箱。我们应该选择哪一个？答案关键取决于问题的两个特征：输出 QoI 的**平滑度**和不确定输入空间的**维度** [@problem_id:3345831] [@problem_id:3348340]。

#### 平滑度为王

考虑模拟[翼型](@entry_id:195951)上的阻力。如果流动是附着的，并且随着我们改变某个输入参数而平缓变化，那么[阻力系数](@entry_id:276893) $C_D$ 将是该输入的一个非常平滑的解析函数。在这种情况下，像随机配置或[多项式混沌展开](@entry_id:162793) (PCE) 这样的谱方法快得惊人。它们可以实现**谱收敛**，这意味着误差随着[配置点](@entry_id:169000)数量或多项式阶数的增加而呈指数级下降。这远远优于 Monte Carlo 方法缓慢的代数爬行。

然而，[流体动力学](@entry_id:136788)的现实世界往往不那么平滑。入口[湍流](@entry_id:151300)强度的一个微小增加可能突然触发[边界层](@entry_id:139416)从[层流](@entry_id:149458)过渡到[湍流](@entry_id:151300)，或者一个分离的流动重新附着。这可能导致输出函数发生突然、急剧的变化——一个“扭结” [@problem_id:3345831]。试图用一个单一的全局多项式去拟合一个带有扭结的函数是一场灾难。多项式会在扭结附近剧烈[振荡](@entry_id:267781)（一种类[吉布斯现象](@entry_id:138701)），美妙的谱收敛性也随之丧失。在这种非平滑的情况下，SC/PCE 的收敛性会退化为仅仅是代数级的，有时甚至比老实的 Monte Carlo 方法还要慢。

#### 维度灾难

第二个主要因素是不确定参数的数量 $d$。想象一下，试图绘制一个一维函数——几个点可能就足够了。在二维空间，你需要一个点的网格。在十维空间，一个[张量积网格](@entry_id:755861)会变得大得无法想象。这种复杂性的指数级增长就是臭名昭著的**维度灾难**。基于张量网格的标准 SC 方法仅适用于少量不确定参数（例如，$d  5$）的情况。

这正是 [Monte Carlo](@entry_id:144354) 方法的超能力回归之处：其 $O(N^{-1/2})$ 的[收敛率](@entry_id:146534)完全独立于维度 $d$。对于一个有 100 个不确定参数的问题，MC 的运行方式与只有一个参数时完全相同，这使其成为处理非常高维问题的首选方法。

在 MC 和 SC 之间的一个巧妙折衷是**拟 Monte Carlo (Quasi-[Monte Carlo](@entry_id:144354), QMC) 方法**。QMC 使用确定性的、特殊构造的“低差异”点序列（如 Sobol 或 Halton 序列），这些序列比随机点更均匀地填充[参数空间](@entry_id:178581)。对于具有中等正则性（例如，[有界变差](@entry_id:139291)）的函数，QMC 可以实现接近 $O(N^{-1})$ 的[收敛率](@entry_id:146534)，显著快于 MC，并且对于中高维度（$d$ 高达 20-30）也可能有效，特别是如果问题具有某种潜在的低维结构 [@problem_id:3348340]。

因此，选择变成了一个策略性的问题：
- **低维度 ($d  5$) 且 QoI 平滑？** 使用随机配置（理想情况下在[稀疏网格](@entry_id:139655)上）以获得[指数收敛](@entry_id:142080)。
- **非常高维度 ($d > 50$) 或 QoI 不平滑？** 使用 Monte Carlo 以获得其无与伦比的稳健性。
- **中等维度 ($5  d  50$) 且 QoI 行为良好？** 拟 [Monte Carlo](@entry_id:144354) 通常是最佳选择。

### 现代前沿：稀疏性、[压缩感知](@entry_id:197903)与奇异结果

“维度灾难”并不总是像听起来那么可怕。在许多复杂的物理系统中，会出现一种被称为**效应稀疏性**的显著现象：在数十个或数百个不确定参数中，实际上只有少数几个及其低阶[交互作用](@entry_id:176776)对输出有显著影响。这引出了**[有效维度](@entry_id:146824)**的概念，它可能远小于问题的名义维度 [@problem_id:3385677]。

这种稀疏性是我们可以利用的。如果我们的 QoI 的[多项式混沌展开](@entry_id:162793)是稀疏的（意味着其大多数系数为零或接近于零），那么找到那少数几个重要系数就成为主要目标。这将 UQ 问题转化为一个[稀疏恢复](@entry_id:199430)问题，这是现代信号处理核心的一个主题。像**压缩感知 (Compressive Sensing)** 这样的技术可以被使用。通过使用 $\ell_1$ 正则化（也称为 LASSO），我们可以用比传统方法建议的少得多的 CFD 模拟次数来求解稀疏系数向量——有时甚至比我们正在寻找的未知系数的数量还少！这是一个深刻的思想：通过假设答案是简单的（稀疏的），我们可以用很少的信息找到它 [@problem_id:3385677]。

最后，我们必须记住，[流体动力学](@entry_id:136788)的[非线性](@entry_id:637147)会玩一些奇怪的把戏。一个简单的、对称的、单峰的输入参数[分布](@entry_id:182848)可能会被 CFD 求解器扭曲成一个奇异的、倾斜的，甚至是**多峰**的输出[分布](@entry_id:182848) [@problem_id:3345850]。这可能发生在具有[分岔](@entry_id:273973)或多个稳定状态的系统中，如流体开关或[扩散](@entry_id:141445)器中的流动。对于一组输入参数，流动可能“决定”附着在一堵墙上或另一堵墙上，导致[压降](@entry_id:267492)出现两种截然不同的可能结果。诊断这种情况需要的不仅仅是计算均值和标准差；它需要正式的统计检验（如 Anderson-Darling 或 Hartigan's dip 检验）来检查与正态性的偏差，并检测输出数据中是否存在多个峰值。这提醒我们，UQ 的最终目标不仅仅是一个[误差棒](@entry_id:268610)，而是对我们预测不确定性的完整特征的真正理解。

