## 引言
量化相似性和相异性的基本需求是科学探究的基石。从比较生态系统到患者档案，我们需要一种清晰的数学语言来表达两个实体的差异程度。Jaccard 距离为此任务提供了一种优雅、直观且强大的方法。本文探讨 Jaccard 距离，解释其核心原理并展示其广泛的实用性。

首先，在“原理与机制”一节中，我们将深入探讨 Jaccard [指数和](@entry_id:199860)距离背后的简单公式，探索它如何量化集合之间的重叠。我们将揭示为什么其决定性特征——忽略共同缺失——在许多情况下是一个显著的优势。此外，我们将把这个单一的数值分解为其组成部分：更替和嵌套，从而揭示差异概念本身更深层次的解剖结构。

然后，在“应用与跨学科联系”一节中，我们将跨越不同领域，见证 Jaccard 距离的实际应用。我们将看到这个简单的思想如何成为一条统一的线索，使我们能够在生态学中测量生物多样性，在生物信息学中快速比较基因组，在数据科学中找到客户原型，以及在现代医学中理解患者的相似性。通过这些例子，我们将领会到一个简单的工具如何能够揭示我们世界隐藏结构中的深刻见解。

## 原理与机制

我们如何衡量两件事物之间的差异？这个问题听起来简单，却是无数科学研究的核心。无论我们是在比较两个肿瘤的基因构成、两个森林的树种，还是两个患者的用药方案，我们都需要一种清晰的数学方式来说明“它们有多相似”或“它们有多不同”。复杂的大自然为我们提供了许多进行这种比较的方法。其中最优雅和最基本的一种就是 **Jaccard 距离**。

### 重叠问题

让我们从一个简单而熟悉的概念开始。想象一下，你和一位朋友各自列出了五部最喜欢的电影。要看你们的品味有多相似，可以计算两份清单上都出现的电影数量。这就是你们两个喜爱集合的**交集**。假设你们有三部共同的电影。你们的品味相似度是“3”吗？单凭这个数字提供的信息并不多。如果你们一个列了5部电影，另一个列了50部呢？共享三部电影的意义就会大不相同。

为了得到一个有意义的度量，我们不仅需要考虑你们共享的部分，还需要考虑你们选择的总范围。最直观的方法是将共享项目的数量视为你们之间提到的*唯一项目总数*的一部分。这就是 **Jaccard 指数**背后简单而精妙的思想。

对于两个集合，我们称之为 $A$ 和 $B$，Jaccard 指数 $J(A, B)$ 定义为它们交集的大小除以它们**并集**的大小：

$$J(A, B) = \frac{|A \cap B|}{|A \cup B|}$$

并集 $|A \cup B|$ 是两个集合中所有唯一项目的总和。因此，Jaccard 指数就是“共享部分”在所有“总考虑部分”中所占的比例。它的值在 0（无重叠）和 1（集合完全相同）之间。

在科学中，我们通常更倾向于讨论距离或相异性，而不是相似性。这只是同一枚硬币的另一面。如果相似性是共同程度，那么相异性就是不共同程度。因此，**Jaccard 距离** $d_J$ 定义为 1 减去 Jaccard 指数：

$$d_J(A, B) = 1 - J(A, B) = 1 - \frac{|A \cap B|}{|A \cup B|} = \frac{|A \cup B| - |A \cap B|}{|A \cup B|}$$

分子 $|A \cup B| - |A \cap B|$ 就是各自集合中独有项目的数量——即你们*不*共同拥有的东西。因此，Jaccard 距离代表了在所有项目的总池中，非共享项目所占的比例。它是对不一致性的直接度量。[@problem_id:2470383]

### 缺失的力量

一个简单的科学工具的真正天才之处，通常不在于它测量了什么，而在于它选择忽略了什么。为了理解这一点，让我们考虑一种不同的比较。想象遗传学家通过检查一组12个基因的突变情况来分析两个肿瘤。我们可以将每个肿瘤表示为一个二进制向量——一个由0和1组成的字符串——其中‘1’表示[基因突变](@entry_id:166469)，‘0’表示基因正常。[@problem_id:4558139]

Tumor X: `(1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0)`
Tumor Y: `(1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0)`

比较这类向量的一种常用方法是**[汉明距离](@entry_id:157657)（Hamming distance）**，它计算符号不同的位置数量。在这里，两个向量仅在第9个位置上不同，所以它们的[汉明距离](@entry_id:157657)是1。

但如果我们使用 Jaccard 距离，我们必须首先从集合的角度思考。自然的选择是创建*存在*的项目集合——在这里，就是突变的基因。

Set $X = \{\text{gene 1, gene 4, gene 9}\}$
Set $Y = \{\text{gene 1, gene 4}\}$

交集是 {gene 1, gene 4}（大小为2），并集是 {gene 1, gene 4, gene 9}（大小为3）。Jaccard 指数是 $\frac{2}{3}$，而 Jaccard 距离是 $1 - \frac{2}{3} = \frac{1}{3}$。

请注意这个关键区别。[汉明距离](@entry_id:157657)考虑了所有12个位置。它看到两个肿瘤都有‘0’的九个位置，并将这种“共同缺失”视为一种一致。而 Jaccard 距离通过仅从‘1’构建集合，完全忽略了两者都为‘0’的位置。

这不是一个缺陷，而是一个深刻而强大的特性。想象一下，从一个包含一百万件商品的超市目录中比较两个购物清单。我们俩都*没有*购买相同的999,990件商品这一事实，是完全没有信息的。一个类似[汉明距离](@entry_id:157657)的度量会被这片共同的零的海洋所淹没，即使我们买的东西完全不同，我们的清单看起来也几乎完全相同。Jaccard 距离巧妙地回避了“共同缺失问题”。它专注于提供信息的事件——那些实际被选择的项目。这使其成为基因组学和生物信息学等领域不可或缺的工具，在这些领域中，我们经常在[稀疏数据](@entry_id:636194)中寻找模式，而这些数据中“存在”是罕见的，“缺失”才是常态。[@problem_id:4558139]

### 质量，而非数量

Jaccard 距离根本上是关于*什么*存在，而不是*有多少*。它是一个**定性**度量，关注的是集合的成员资格。当我们将其与考虑丰度的**定量**度量进行对比时，这一点变得尤为清晰。

让我们跟随一位生态学家在森林中散步，他正在比较两块土地。地块A是未经触碰的原始森林，而地块B在多年前被选择性采伐过。[@problem_id:1830491] 在地块A，他们数到150棵雄伟的娑罗双树（*Shorea robusta*）。在被采伐的地块B，同一物种只剩下25棵。

对于 Jaccard 距离来说，重要的是 *Shorea robusta* 在两个地块中都存在。数量——150对25——是无关紧要的。它将物种的存在视为一个简单的“是”或“否”问题。

但另一个度量，例如 **Bray-Curtis 相异性**，就是专门为看到这种数量上的差异而设计的。Bray-Curtis 关注每个物种计数的绝对差异，并用两个地块中计数的个体总数对其进行归一化。从150到25的巨大下降极大地影响了 Bray-Curtis 的得分，这标志着群落发生了重大的结构性变化。而 Jaccard 距离只会记录一个更小的变化，也许只注意到被采伐地块中出现而原始地块中没有的一两种[先锋物种](@entry_id:140345)。[@problem_id:4584503]

没有哪个度量“更好”；它们只是回答了不同的问题。Jaccard 问的是：“物种*列表*变化了多少？” Bray-Curtis 问的是：“整个群落*结构*，包括物种的相对优势度，变化了多少？” 工具的选择必须与研究的性质相匹配。当你在比较成员列表，而你拥有的唯一信息——或者你唯一关心的信息——是存在与否时，Jaccard 就是正确的工具。

### 差异的剖析：更替与嵌套

到目前为止，Jaccard 距离似乎只是一个衡量不一致性的简单指标。但我们可以看得更深。就像物理学家用棱镜分解光线一样，我们可以将这个单一的数字分解成更基本的组成部分，告诉我们两个集合*为什么*不同。

再来考虑我们最喜欢的电影清单。两种截然不同的情况可能导致相异性：

1.  **嵌套（Nestedness）：** 我的清单是 {A, B, C}。你的清单是 {A, B, C, D, E}。这种相异性是因为我的清单是你清单的一个更小的、“嵌套”的子集。差异纯粹是丰富度或大小的问题。

2.  **更替（Turnover）：** 我的清单是 {A, B, D, E}。你的清单是 {A, B, F, G}。我们都喜欢四部电影，所以我们的丰富度是相等的。差异来自于我们“替换”或“更替”了两部电影。差异纯粹是身份的问题。

大多数现实世界的比较是两者的混合。Jaccard 框架的美妙之处在于，我们可以将总相异性精确地划分为这两种现象：一个由纯**更替**（替换）引起的组分，以及一个由**嵌套**（丰富度差异导致的子集模式）产生的组分。[@problem_id:2507818] [@problem_id:2470374]

让我们用一个口腔微生物学的例子来探讨这个问题，科学家们在该领域比较患者口腔中不同部位的细菌群落。[@problem_id:4743984] 假设部位1的细菌分类单元为 $S_1 = \{A, B, C, D\}$，部位2的为 $S_2 = \{A, C, D, E\}$。

为了分析这一点，我们可以定义三个量：$a$ 是共享的分类单元数量，$b$ 是部位1独有的数量，$c$ 是部位2独有的数量。
-   共享分类单元 ($a$): $\{A, C, D\}$。所以 $a=3$。
-   部位1独有 ($b$): $\{B\}$。所以 $b=1$。
-   部位2独有 ($c$): $\{E\}$。所以 $c=1$。

总的 Jaccard 相异性是 $\frac{b+c}{a+b+c} = \frac{1+1}{3+1+1} = \frac{2}{5}$。

现在，请注意一个关键特征：两个部位具有相同的丰富度（4个分类单元）。不存在一个部位是另一个部位子集的“嵌套”模式。差异完全是由于替换造成的：部位1中的分类单元B被“换成”了部位2中的分类单元E。在这种丰富度相等的情况下，整个相异性*必定*是由更替引起的。嵌套组分可证明为零。

实际上，Jaccard 相异性的数学分解表明，更替组分 $\beta_{jtu}$ 捕获了这种平衡的替换，而嵌套产生的组分 $\beta_{jne}$ 则捕获了不平衡。对于 Jaccard 族度量，它们通常定义为：

$$\beta_{jtu} = \frac{2 \min(b,c)}{a+b+c} \quad \text{and} \quad \beta_{jne} = \frac{|b-c|}{a+b+c}$$

将此应用于我们的例子：
-   更替：$\beta_{jtu} = \frac{2 \min(1,1)}{3+1+1} = \frac{2}{5}$。
-   嵌套：$\beta_{jne} = \frac{|1-1|}{3+1+1} = 0$。

正如预测的那样，$\frac{2}{5}$ 的总相异性完全由更替构成。通过分解 Jaccard 距离，我们获得了更深刻的理解。我们不仅测量了差异有*多大*，还诊断了该差异的*性质*。这个源于计算重叠项目的简单分数，揭示了“差异”这一概念背后隐藏的解剖结构。这使得科学家们——无论他们是在研究我们口中的细菌、开给患者的药物 [@problem_id:4558158]，还是整个大陆上生态系统的构成 [@problem_id:2477266]——能够超越简单的测量，开始理解在自然界中产生多样性和相异性的机制。

