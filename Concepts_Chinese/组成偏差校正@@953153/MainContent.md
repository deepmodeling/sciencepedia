## 引言
现代科学数据浩如烟海，但正确解读数据却是一项艰巨的挑战。在基因组学和[宏基因组学](@entry_id:146980)等由高通量测序驱动的领域，我们很少测量绝对数量，而是测量比例——属于每个基因或微生物的测序读段所占的百分比。这个看似无伤大雅的细节造成了一个根本性问题，即组成偏差（compositional bias），这是一种统计错觉，可能导致研究人员看到虚假的关联，并完全错过真实的生物学信号。本文直面这一挑战，揭开组成数据的神秘面纱，阐明为看透其失真而开发的方法。

旅程始于第一章“原理与机制”，我们将通过简单的类比剖析核心问题，并探讨困扰朴素分析的统计谬误。我们将揭示为何直观的归一化方法常常失败，并阐明提供更真实视角的现代解决方案背后优雅的逻辑。随后，“应用与跨学科联系”一章将拓宽我们的视野，展示同样的组成挑战如何以惊人的多样性出现在各种科学领域——从重建[生命之树](@entry_id:139693)、诊断疾病到绘制地球地质图——揭示其作为数据分析中一个统一的原则。

## 原理与机制

要真正理解一个科学思想，我们必须将其剥离至本质。我们必须将其视为对自然提出的一个根本挑战的回应，而非食谱和公式的集合。组成偏差的挑战是现代生物学中最微妙、最普遍的挑战之一，理解它就像学会在数据中看到一个隐藏的维度。我们的旅程并非始于高科技实验室，而是一场简单的百乐餐晚宴。

### 百乐餐的比喻

想象你正在参加一个大型社区百乐餐。你的目标是弄清楚邻居们的厨艺是进步了还是退步了。你无法看到他们的厨房，也无法测量他们准备的食物的绝对量。你所拥有的只是你自己的盘子，你从一张大的公用餐桌上取食。你的盘子大小和餐桌大小都是固定的。

去年，餐桌上的菜肴搭配均衡：一些砂锅菜、一些沙拉、一些面包、一些甜点。今年，一位厨艺天才邻居带来了一只硕大无比、引人注目的烤火鸡。它如此华丽，占据了半张餐桌。自然，每个人，包括你，都在盘子里放了一大块火鸡。

现在，看看你的盘子。因为火鸡占据了太多空间，其他所有东西——砂锅菜、沙拉、面包——的比例都比去年小得多。如果你仅根据盘子中各道菜所占的比例来评判邻居们的厨艺，你会得出结论：几乎所有人的厨艺都变差了！你甚至可能认为做砂锅菜和做沙拉的人私下约定好少带食物，因为它们的比例都下降了。

这就是**组成数据**（compositional data）的核心错觉。餐桌的固定大小（实验中的**[测序深度](@entry_id:178191)**）以及所有菜肴的比例之和必须为100%这一约束，创造了一个相互依赖的网络。一个组分的急剧增加会迫使所有其他组分出现表观上的减少，即使它们的绝对数量根本没有改变。这就是混淆我们测量的**组成偏差**（compositional bias）。

### 比例的世界：组成的锁链

这个百乐餐的比喻直接对应了当今许多最强大的生物学技术。当我们进行RNA测序（RNA-seq）来测量基因表达时，我们并不是在计算细胞中每一个RNA分子。相反，我们是对细胞的RNA进行取样，将其打碎成片段，然后对其中巨大但有限数量的片段进行测序——比如五千万个读段。结果不是每个[基因转录](@entry_id:155521)本的绝对计数，而是映射回每个基因的总读段的*比例* [@problem_id:4562817]。

[宏基因组学](@entry_id:146980)也是如此，我们用它来研究微生物群落。我们从环境中（例如，你的肠道）取一份DNA样本，并对一个特定的标记基因（如16S rRNA）进行测序。我们得到的数据是属于每个细菌分类单元的读段比例。我们得到的是一个百分比列表，而不是细菌的绝对普查结果 [@problem_id:2405519]。

在所有这些情况下，数据都是**组成的**（compositional）：每个测量值都是整体的一部分，并且各部分之和被约束为一个总量（1，或100%，或总文库大小）。这个数学约束，通常被称为**闭合**（closure），是我们麻烦的根源。它意味着各组分不是独立的。基因A的丰度并不独立于基因B，因为如果基因A的比例上升，所有其他比例的总和*必然*会下降。

这导致了奇异的假象，比如伟大的统计学家Karl Pearson早在1897年就注意到的**[伪相关](@entry_id:755254)**（spurious correlations）。在我们的百乐餐比喻中，砂锅菜和沙拉的比例都因为火鸡而下降了。如果你在多次百乐餐中绘制它们的比例，你可能会发现一个负相关，并错误地得出结论，认为做砂锅菜和做沙拉的人是竞争对手。在[宏基因组学](@entry_id:146980)中，一个细菌物种的暴增会造成另外两个物种之间存在负相关的假象，而这两个物种的绝对种群数量可能完全是独立变化的 [@problem_id:2405519]。我们观察到的不是生物学现象，而是一个数学假象。

### 简单方法的诱惑及其失败

当面对来自不同样本的数据时，最直观的方法是通过对总量进行归一化来使它们具有可比性。对于[RNA-seq](@entry_id:140811)，这可能意味着通过除以文库中的总读段数，将原始读段计数转换为每百万计数（Counts Per Million, CPM）。这似乎很合理——就像将我们的百乐餐观察结果标准化为“每桌份量”。

但现在我们看到了陷阱。如果两个样本具有相同的总读段数（餐桌大小相同），但一个样本有一个被大规模上调的“火鸡基因”，这种归一化并不能解决问题。它会尽职地报告所有其他未改变的基因看起来被下调了 [@problem_id:5157604] [@problem_id:4562817]。“火鸡基因”的真实、巨大的增加也会显得比实际要小。这种方法没有消除组成偏差；它完全被其所迷惑。

另一种看似复杂的方法，**[分位数归一化](@entry_id:267331)**（quantile normalization），也因一个不同但同样深刻的原因而失败。它强制所有样本的值的统计分布完全相同。这假设分布的任何差异都是技术假象。但如果巨大的火鸡是一个真实的、大规模的生物学事件，比如免疫反应的激活呢？[分位数归一化](@entry_id:267331)会通过压低免疫基因的高值并抬高其他基因的值来“校正”这一点，从而抹去我们试图发现的生物学真相 [@problem_id:5157604]。这就像坚持每场百乐餐的菜肴分布必须完全相同，从而错过了年度大戏——那只华丽的火鸡。

最后，我们还有像[每百万转录本](@entry_id:170576)（Transcripts Per Million, [TPM](@entry_id:170576)）这样的度量。虽然TPM巧妙地考虑了基因长度，使其非常适合比较*单个样本内不同基因*的表达，但它仍然将丰度表示为整体的一个比例。它将数据重新锁回了组成的牢笼。对于比较*不同样本间的单个基因*，它遭受同样的组成偏差，并且与用于[差异表达分析](@entry_id:266370)的统计计数模型不兼容 [@problem_id:4333098]。

### 群体的智慧：寻找稳定锚点

那么，如果总量不可信，我们能相信什么呢？答案异常简单：我们相信群体。现代归一化方法背后的关键洞见是**大多数不受影响的假设**（majority-unaffected assumption）。我们假设虽然少数基因可能会发生巨大变化，但绝大多数基因在不同条件间的表达量不会改变 [@problem_id:4556303]。这些安静、稳定的基因可以作为我们的锚点。

我们不再将每个基因与不可靠的总量进行比较，而是将其与它的同伴们进行比较。在[DESeq2](@entry_id:167268)软件中著名的“比率[中位数](@entry_id:264877)”（median-of-ratios）方法就是这一思想的美好体现 [@problem_id:4317837]。过程很优雅：

1.  **创建一个假设的“平均”基因**：对于每个基因，我们计算它在所有样本中的几何平均值。使用几何平均值是因为数据是乘性的（一个基因的计数约等于 `（样本的测序深度）×（基因的生物学丰度）`）。这创建了一个伪参考样本，代表了每个基因的典型表达水平。

2.  **计算比率**：对于每个样本，我们接着计算每个基因的计数与这个伪参考的比率。对于绝大多数稳定基因，这个比率应该大致恒定——它应该只反映该样本的整体[测序深度](@entry_id:178191)。

3.  **找到稳健的中心**：少数真正发生巨大变化的“火鸡基因”将具有极端异常的比率。为了获得该样本的单个、可靠的缩放因子，我们取所有这些比率的*中位数*。[中位数](@entry_id:264877)是一个稳健的统计量；它是中间的值，完全忽略了异常值的极端影响。

由此产生的缩放因子源自稳定基因的“沉默的大多数”。它是一种对测序深度的度量，对少数高表达异常值造成的组成混乱视而不见。当我们使用这个因子来归一化我们的样本时，错觉就消失了。未改变的基因现在显示出稳定的表达，而火鸡基因变化的真实幅度也得以揭示 [@problem_id:5157604] [@problem_id:4556303]。另一种创建锚点的方法是物理添加一个：向每个样本中添加已知数量的外部RNA**[内参](@entry_id:191033)对照**（spike-in controls），提供了一个不受内源RNA群体变化影响的绝对参考点 [@problem_id:4562817]。

### 一个激进的想法：比率的自由

地质学家John Aitchison开创了一种更深刻的处理组成数据的哲学。他认为，如果整体是问题所在，那么就应该干脆拒绝使用它。组分的绝对值是不可知的，它们的比例具有误导性。你唯一能真正信任的是**任意两个组分之间的比率**。

在你的百乐餐盘子里，砂锅菜与沙拉的比率是一个有意义的量，它不受你取了多少火鸡的影响。Aitchison证明，通过处理这些比率的对数（**对数比率**），人们可以摆脱“总和为一”的约束，将数据移动到一个熟悉的、无约束的欧几里得空间中，在这个空间里，标准的统计方法（如相关性）又能正常工作了 [@problem_id:2405519]。这是现代**组成数据分析**（Compositional Data Analysis, CoDA）的基础。例如，它使我们能够构建微[生物相互作用](@entry_id:196274)网络，而这些网络不受早期研究中困扰的[伪相关](@entry_id:755254)的影响。

### 生命语言中的组成幽灵

这个原则是如此根本，以至于它的幽灵出现在生物信息学的完全不同的领域。考虑使用像BLAST这样的工具在庞大的[蛋白质数据库](@entry_id:194884)中进行搜索。为了判断一个匹配是否显著，BLAST会计算一个**[期望值](@entry_id:150961)（E-value）**，它告诉你仅凭纯粹的偶然，期望能找到多少个具有该分数的匹配。这个计算依赖于一个统计[零模型](@entry_id:181842)，即Karlin-Altschul框架，该框架假设你的查询序列和数据库序列都是从典型的氨基酸频率背景分布（例如，亮氨酸常见，色氨酸罕见）中抽取的随机字符串 [@problem_id:2387461]。

但如果你的查询蛋白具有偏向的组成呢？例如，它可能是一个富含带正电荷的赖氨酸的[DNA结合蛋白](@entry_id:180925)，或者是一个充满疏水性残基的[跨膜蛋白](@entry_id:175222)。它的组成与模型所假设的“典型”蛋白质完全不同。当你用这个有偏向的查询进行搜索时，你将不可避免地找到其他同样富含这些相同残基的蛋白质，这纯粹是出于偶然。由于[零模型](@entry_id:181842)被错误设定，BLAST会认为这些匹配极不可能发生，并给它们分配虚假的显著E-value。你会被[假阳性](@entry_id:635878)所淹没，这是组成偏差造成的又一个错觉 [@problem_id:2387461] [@problem_id:3863071]。

解决方案在概念上与我们在[RNA-seq](@entry_id:140811)中看到的完全相同：你调整背景模型以[匹配数](@entry_id:274175)据。BLAST的**基于组成的得分调整**（composition-based score adjustment）正是这样做的。它根据你的查询序列的实际组成，动态地重新计算替换得分。两个赖氨酸残基之间的匹配不再被认为是一个罕见的、显著的事件；它是在预料之中的。虚高的分数下降，真正的同源序列浮出水面 [@problem_id:4379493]。

同样的幽灵甚至困扰着我们重建生命之树的尝试。用于估计物种间进化距离的模型通常假设四种DNA碱基（A、C、G、T）的频率相等。如果一个基因组有很强的**组成偏斜**（compositional skew）（例如，它是富含GC的），使用忽略这一点的模型将导致对进化时间的估计出现偏差。解决方案再次是使用一个更复杂的模型，该模型明确考虑了观察到的碱基组成，从而使校正更符合数据的实际情况 [@problem_id:2837143]。

从基因表达到微生物生态学，从序列搜索到[系统发育学](@entry_id:147399)，教训都是一样的。自然常常以比例而非绝对值的形式向我们呈现数据。要清晰地透过这层透镜看世界，需要我们认识到系统的约束并相应地调整我们的工具。我们必须要么将我们的测量锚定在大多数的安静稳定性上，要么将我们的视角转换为比率的世界。这样做，我们在统计思维中上了一堂深刻而优美的课：要找到真相，你必须首先确保你对世界的模型本身不是一个幻觉。

