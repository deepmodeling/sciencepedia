## 引言
几个世纪以来，优化领域一直建立在一个优雅的思想之上：沿着梯度下降，就像一个球沿着光滑的山坡滚下以找到最低点。这种方法对于表现良好、可微的函数非常有效。然而，科学和工程领域中许多最关键的问题并非光滑的山丘，而是崎岖的山脉，充满了尖角和扭结，在这些地方，梯度的概念不再适用。这些出现在机器学习、力学甚至纯数学中的[非光滑函数](@entry_id:175189)，可能导致我们最先进的优化工具停滞甚至完全失效。

本文旨在应对这一根本性挑战，探讨如何驾驭[非光滑函数](@entry_id:175189)的“狂野世界”。文章全面概述了为探索这些复杂数学景观而发展的各种策略。第一章“原理与机制”将深入探讨处理这些扭结的数学艺术，对比两种核心理念：一是通过 Moreau 包络等强大的[平滑技术](@entry_id:634779)将其“磨圆”，二是通过[近端算子](@entry_id:635396)等专用工具接纳其结构。在这一理论基础之上，第二章“应用与跨学科联系”将展示这些方法在不同领域的卓越影响力，揭示驾驭非光滑性如何解决实际问题并开启深刻的理论洞见。

## 原理与机制

想象一个完美光滑、连绵起伏的山丘。如果你将一个球放在山坡上，它会径直滚下。在每一点上，最速下降的方向都是明确的，数学家们用**梯度**来捕捉这一概念。几个世纪以来，我们的优化工具——用于寻找任何山谷中最低点的工具——都建立在沿着[梯度下降](@entry_id:145942)这一简单而优雅的思想之上。从 Newton 的方法到驱动现代机器学习的算法，我们设计的机器都是沿着光滑山丘滚动的专家。

但如果地貌不是平缓的山丘呢？如果它是一个崎岖的山脉，充满了尖锐的山脊、陡峭的山峰和险峻的悬崖呢？在悬崖的边缘，“向下”是哪个方向？在圆锥的[奇点](@entry_id:137764)上，没有单一的[最速下降](@entry_id:141858)方向，而是存在一系列可能的方向。这就是**[非光滑函数](@entry_id:175189)**的世界，在这个世界里，我们经典的基于梯度的直觉失效了。这些“扭结”和“尖角”不仅仅是数学上的奇特现象，它们是科学和工程领域一些最重要问题的核心。

### 扭结带来的麻烦

让我们考虑一个最简单的[非光滑函数](@entry_id:175189)：[绝对值函数](@entry_id:160606) $f(x) = |x|$。它的图像是一个完美的“V”形，在 $x=0$ 处有一个[尖点](@entry_id:636792)。在其他任何地方，梯度都定义得非常清楚：对于所有 $x  0$，梯度是 $-1$；对于所有 $x > 0$，梯度是 $+1$。但在最底部的 $x=0$ 点，梯度是未定义的。该函数的斜率发生了一个瞬时的、不连续的跳跃。

这一个未定义的点足以对我们最精良的优化工具造成严重破坏。像著名的 BFGS 方法这样用于光滑优化的主力算法，依赖于一个“[割线条件](@entry_id:164914)”，该条件根据梯度的变化来近似[函数的曲率](@entry_id:173664)。但是，如果梯度不是平滑变化的——或者更糟，如果算法的步长落在一个梯度恒定然后突然跳跃的区域——其基本假设就会崩溃。算法可能会停滞、采取不稳定的步骤或完全失败，因为它再也无法构建一个合理的地形图 [@problem_id:3264841]。

这不是一个孤立的问题。这些麻烦的扭结无处不在：
- 在机器学习中，用于支持向量机的**合页损失** (hinge loss)，$\ell(z) = \max(0, 1-z)$，有一个尖角，这个尖角对于定义[决策边界](@entry_id:146073)至关重要 [@problem_id:3143198]。
- 在数据科学和信号处理中，**$\ell_1$ 范数** $\|x\|_1 = \sum_i |x_i|$ 是寻找稀疏解的关键——[稀疏解](@entry_id:187463)是指大部分分量都恰好为零的解。它的威力直接来源于[绝对值函数](@entry_id:160606)在每个坐标轴上的非光滑特性 [@problem_id:3470509]。
- 在工程学和[地质力学](@entry_id:175967)中，描述土壤或金属等材料何时开始塑性变形的模型——例如 Mohr-Coulomb 和 Tresca 准则——由具有尖锐边缘和角落的[屈服面](@entry_id:175331)定义。在这些角落处，[塑性流动](@entry_id:201346)的方向不是唯一的，这是不可微点的一种物理表现 [@problem_id:3539958] [@problem_id:2678260]。

面对一个充满扭结的地形，我们有两种主要理念。第一种，也许是最直观的，是找到一种方法来“填平裂缝”。

### 平滑的艺术：填平裂缝

如果尖角是问题所在，我们能否简单地将它们磨圆？这就是平滑的核心思想。我们创建一个表现良好、无限可微的代理函数，它能紧密地模仿我们原始的[非光滑函数](@entry_id:175189)。有几种绝妙的方法可以做到这一点，但其中两种因其优雅和强大而脱颖而出。

#### Moreau 包络：一种全局视角

平滑一个函数最深刻的方法之一来自一种被称为 **Moreau-Yosida 包络**的构造。想象一下我们 V 形的[绝对值函数](@entry_id:160606) $f(y) = |y|$。现在，想象我们有一个微小的、完美光滑的抛物线杯子，由函数 $\frac{1}{2\mu}(y-r)^2$ 描述。对于 x 轴上的任意点 $r$，我们将这个杯子放在 $|y|$ 的图像上方，让它尽可能向下滑动。杯子最低点的高度就成为我们新的平滑函数在 $r$ 处的值。

在数学上，这个“下确界卷积”写作：
$$
M_{\mu}(r) = \min_{y \in \mathbb{R}} \left\{ |y| + \frac{1}{2\mu}(y - r)^2 \right\}
$$
参数 $\mu > 0$ 控制我们抛物线杯子的“宽度”；较小的 $\mu$ 意味着一个更尖、更窄的杯子，而较大的 $\mu$ 意味着一个更宽、更平缓的杯子。神奇的是，为 $f(y)=|y|$ 解决这个看似抽象的最小化问题会得到一个具体而优雅的结果 [@problem_id:3511476]：
$$
M_{\mu}(r) =
\begin{cases}
\frac{r^2}{2\mu}  \text{if } |r| \le \mu \\
|r| - \frac{\mu}{2}  \text{if } |r| \gt \mu
\end{cases}
$$
这就是著名的 **Huber 损失**函数。我们从 $|r|$ 中的一个尖锐扭结开始，通过 Moreau 包络，将其转换为一个在零点附近是完美的二次函数、在远离零点处是线性函数的函数。这些区域之间的过渡是连续可微的。我们成功地用一个由 $\mu$ 控制宽度的光滑二次片“填平”了扭结。同样的过程可以应用于其他函数，如合页损失，总能得到一个光滑、表现良好的近似 [@problem_id:2294837]。

#### 局部近似：Softplus 技巧

另一种方法是从头开始构建一个光滑的近似。许多[非光滑函数](@entry_id:175189)是使用 `max` 运算构建的，例如，合页损失 $f(t) = \max(0, 1-t)$ 或[神经网](@entry_id:276355)络中的[修正线性单元](@entry_id:636721) (ReLU) $f(u) = \max(0, u)$。函数 $\max(0, z)$ 就是造成扭结的原因。我们可以用一个称为 **softplus** 函数的光滑版本来替代它：
$$
\text{softplus}_\mu(z) = \mu \ln(1 + \exp(z/\mu))
$$
当平滑参数 $\mu \to 0$ 时，该函数成为 $\max(0, z)$ 的完美复制品。但对于任何 $\mu > 0$，它都是无限可微的。将此应用于合页损失，我们得到一个平滑版本 $S_{\mu}(t) = \mu \ln(1 + \exp((1-t)/\mu))$。这个函数与机器学习中逻辑回归的基石——**逻辑损失** $\ln(1 + \exp(-z))$ 密切相关 [@problem_id:3511476] [@problem_id:3094577]。这揭示了一种深刻而美妙的统一性：逻辑损失可以被看作是合页损失的平滑版本，这种联系乍一看并非显而易见。

### 平滑的代价与回报

平滑是一个强大的思想，但它并非没有代价。它伴随着一系列明确的权衡。

回报是巨大的。通过将非光滑问题转化为光滑问题，我们解锁了一系列更快、更强大的优化算法。对于一个普通的非光滑凸函数，标准的**[次梯度法](@entry_id:164760)**以最坏情况下 $O(1/\sqrt{k})$ 的缓慢速度逼近解。但对于一个光滑[凸函数](@entry_id:143075)，**Nesterov 加速梯度法**可以积累“动量”，利用过去步骤的信息以更快的速度收敛，速率为 $O(1/k^2)$ [@problem_id:3143198]。这种差异是巨大的：为了获得 100 倍的精度，[次梯度法](@entry_id:164760)可能需要 10,000 倍的迭代次数，而加速方法仅需要 10 倍。如果我们还能确保平滑后的目标函数是**强凸的**（例如，通过添加一个 $L_2$ 正则化项），我们甚至可以实现更快的**[线性收敛](@entry_id:163614)速率**，此时误差在每一步都按一个恒定因子缩小 [@problem_id:3143198]。

我们为这种速度付出的代价是双重的：偏差和精细性。
1.  **偏差：** 平滑函数是一个近似。它的最小值接近但并不完全等于原始[非光滑函数](@entry_id:175189)的最小值 [@problem_id:3415775]。例如，平滑 $\ell_1$ 范数会产生一个包含许多微小非零值的解，而不是真正[稀疏性](@entry_id:136793)所要求的精确零值 [@problem_id:3415775]。
2.  **精细性：** 为了减少这种偏差，我们需要让平滑参数 $\mu$ 非常小。然而，当 $\mu \to 0$ 时，我们的平滑函数变得更“尖”且曲率更大。这种病态条件迫使标准梯度下降法为了保持稳定而采取极小的步长，因为步长受限于一个与 $1/(L_f + 1/\mu)$ 成比例的项，其中 $L_f$ 是我们问题原始光滑部分的 Lipschitz 常数 [@problem_id:3415775]。微小的 $\mu$ 导致微小的步长，算法会因此停滞不前。

那么我们如何兼得两者的优点呢？答案是**延续策略**。我们不使用固定的平滑量，而是使用一个计划表。我们以一个较大的平滑参数 $\mu$ 值开始优化。这给了我们一个非常光滑的地形，让我们的算法能够朝着解的大致区域迈出自信的大步，轻松滑过恼人的局部扭结 [@problem_id:3167932]。然后，随着迭代的进行，我们逐渐减小平滑参数。地形慢慢变回原始的、崎岖的样子，但因为我们的迭代点已经在正确的山谷中，它可以通过微调位置找到一个高度精确的解而不会被卡住。这种在求解过程中自适应地改变问题本身的优雅思想是优化中的一个深刻原理，出现在接触力学的平滑增广拉格朗日等先进方法中 [@problem_id:2541802]。

### 另一种哲学：接纳扭结

平滑是为了改变问题以适应我们的算法。但还有另一种更现代的哲学：改变算法以适应问题。如果我们能设计出不畏惧扭结的算法呢？

第一步是推广梯度的概念。在一个非光滑点上，虽然可能没有单一的[梯度向量](@entry_id:141180)，但存在一组有效的“下坡”方向。这个集合被称为**[次微分](@entry_id:175641)**。对于我们的[绝对值函数](@entry_id:160606)在 $x=0$ 处，[次微分](@entry_id:175641)是整个区间 $[-1, 1]$。对于力学中[屈服面](@entry_id:175331)上的一个角点，它是**[法锥](@entry_id:272387)**，即从该角点向外指向的一簇向量 [@problem_id:3539958] [@problem_id:2678260]。

这个思想催生了**[复合优化](@entry_id:165215)**这一强大框架。许多现实世界的问题可以分为两部分：$\phi(x) = f(x) + g(x)$，其中 $f(x)$ 是光滑的（如二次数据拟合项），而 $g(x)$ 是非光滑但具有特殊、简单结构的（如 $\ell_1$ 范数） [@problem_id:3470509]。我们不是平滑 $g(x)$，而是在一个算法步骤中分别处理每一部分。
1.  我们对光滑部分 $f(x)$ 进行一个标准的梯度步。
2.  然后，我们使用一种称为**[近端算子](@entry_id:635396)**的工具，对非光滑部分 $g(x)$ 应用一个特殊的校正步骤。

[近端算子](@entry_id:635396) $\operatorname{prox}_{\tau g}(v)$ 是一个功能极其多样的概念。它能找到一个点 $x$，在保持靠近输入点 $v$ 和使[非光滑函数](@entry_id:175189) $g(x)$ 变小之间达到完美平衡。对于许多关键的[非光滑函数](@entry_id:175189)，该算子都有一个简单的[闭式](@entry_id:271343)解：
- 对于 $\ell_1$ 范数 $g(x) = \lambda \|x\|_1$，[近端算子](@entry_id:635396)是一个简单的**[软阈值](@entry_id:635249)**函数，它将值向零收缩，并将小值设为*恰好*为零。这使得像[近端梯度下降](@entry_id:637959)这样的算法能够产生真正的[稀疏解](@entry_id:187463)，这是[平滑方法](@entry_id:754982)永远无法做到的 [@problem_id:3415775]。
- 对于一个在集合 $C$ 内部为零、外部为无穷大的约束函数 $g(x)$，[近端算子](@entry_id:635396)就是到集合 $C$ 上的**欧几里得投影**。这使我们能够在每次迭代中完美、精确地处理硬约束 [@problem_id:3415775]。

这种结合了梯度步和近端步的“分裂”方法，让我们兼得两者的优点。我们对问题中表现良好的部分使用熟悉的梯度，对非光滑部分使用专门的、精确的工具，从而避免了[平滑方法](@entry_id:754982)固有的偏差和精细的参数调整。

最终，在平滑一个函数和接纳其非[光滑性](@entry_id:634843)之间进行选择，是一种策略选择。平滑改变了地形，使其更易于导航。近端方法则构建了一种更复杂的“交通工具”，能够在原始崎岖的地形中航行。两者都是数学家和科学家如何学会驾驭[非光滑函数](@entry_id:175189)的“狂野世界”，将数学问题转化为实际解决方案的美妙体现。

