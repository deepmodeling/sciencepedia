## 引言
规划任何科学探索，无论是新药的临床试验，还是工程上的压力测试，都会面临一个基本的悖论。为了确定所需资源——即患者或样本的数量——我们必须计算研究的[统计功效](@entry_id:197129)。然而，这个计算却要求我们假设一个单一、特定的“真实”效应量，而这恰恰是实验旨在发现的量。这种对单一、通常不确定的猜测的依赖，使得传统的规划成为一种不稳定的赌博。本文介绍贝叶斯保证，一个通过拥抱而非忽视不确定性来解决这一困境的强大范式。在接下来的章节中，您将发现一种更全面的预测实验成功的方法。“原理与机制”一章将首先阐释保证的核心概念，解释它如何通过对我们的无知进行平均，来提供一个单一、现实的成功概率。随后，“应用与跨学科联系”一章将展示这一优雅的理论如何付诸实践，以在从医学到工程等领域设计出更智能、更高效、更合乎伦理的研究。我们首先探索那些使保证成为在面对未知时做出决策的变革性工具的基本原理。

## 原理与机制

### 规划者的困境：已知中的不确定性

想象一下，你正在规划一次探险。你需要决定打包多少食物和水。这个决定，即你的物资“样本量”，关键取决于你无法确切知道的事情：旅程将持续多久？地形会有多艰险？解决这个问题的经典方法是选择一个单一、特定的情景——比如说，一次“具有挑战性但貌似合理”的10天行程——然后正好为此打包足够的物资。这就是传统**[统计功效](@entry_id:197129)**的本质。在设计一项科学研究时，我们选择一个单一、假设的“真实”效应量 $\theta^{\star}$，然后计算出需要多大的样本量才能有高概率（通常是80%或90%）检测到它。这个概率，以效应恰好是 $\theta^{\star}$ 的那一个特定现实为条件，就是研究的功效。

但如果真实效应稍微小一点，或者大一点呢？如果我们做出的其他假设略有偏差呢？为一个单一情景优化的计划可能是脆弱的。考虑一项临床试验，计划测试一种预防手术感染的新策略 [@problem_id:4855398]。所需患者数量不仅取决于新策略的预期益处，还取决于标准护理下的基线感染率 $p_C$。如果我们假设基线率为 $15\%$，我们可能每组需要大约900名患者。但如果真实率更接近 $35\%$（根据历史数据，这也是合理的），我们实际上需要超过1800名患者才能达到相同的统计功效！将一个耗资数百万美元的试验建立在对 $p_C$ 的单一猜测之上，突然感觉非常不稳定。

解决这个问题的一个常用方法是进行**敏感性分析**：你尝试几种不同的情景（例如，低、中、高基线率），看看所需的样本量如何变化。然后你可能会选择最大的、“最坏情况”下的样本量以求安全 [@problem_id:4855398]。这就像为最长的可能行程打包。这是一种务实但略显粗糙的处理不确定性的方式。它没有优雅地整合我们拥有的所有信息，也没有告诉我们跨越所有可能性的总体成功概率。它只是为少数选定世界中的最坏情况做准备。有没有一种更全面、更优美的方式来思考这个问题呢？

### 对无知进行平均：保证的诞生

贝叶斯的视角提供了一种深刻的思维转变。它不是挑选一个或几个可能的现实，而是直面我们的不确定性。如果我们不知道像效应量 $\theta$ 或基线率 $p_C$ 这样的参数的真实值，我们可以用一个**[先验概率](@entry_id:275634)分布** $p(\theta)$ 来表示我们对它的信念，而不是一个单点。这个分布为每个可能的值赋予一定的可信度，反映了我们从过去的研究、科学合理性或专家意见中获得的既有知识。

有了这个工具，我们可以定义一个非常直观的概念：**贝叶斯保证**，有时也称为**先验预测功效**。想法很简单：让我们计算研究成功（即功效）在未知参数的*每个可[能值](@entry_id:187992)*下的概率，然后将所有这些概率加权平均，权[重根](@entry_id:151486)据我们的[先验分布](@entry_id:141376)认为每个参数值的合理性而定 [@problem_id:4979697]。

在数学上，如果一项研究对于给定效应量 $\theta$ 的功效是 $\text{Power}(\theta)$，那么保证就是它在先验分布上的期望：

$$
\text{Assurance} = E_{p(\theta)}[\text{Power}(\theta)] = \int \text{Power}(\theta) p(\theta) d\theta
$$

这个单一的数字代表了我们的研究将产生“成功”结果的总体、无[条件概率](@entry_id:151013)，它是在我们收集任何数据*之前*计算出来的。这是我们对成功机会的最佳猜测，因为它诚实而正式地考虑了我们所有预先存在的不确定性。这不仅是一个实用的工具，也是一种哲学宣言。它承认我们的无知，并将其直接纳入我们的预测。现实世界是许多可能性的叠加，而保证是在这整个可能性景观上平均的成功概率。

这种方法可以很容易地扩展到同时处理多个参数的不确定性。如果我们对效应量 $\delta$ 和数据方差 $\sigma^2$ 都不确定，我们可以简单地定义一个联合[先验分布](@entry_id:141376) $\pi(\delta, \sigma^2)$，并在两个未知数上对功效函数进行平均。这使我们能够以一种连贯的方式，将所有不确定性来源传播到我们的最终预测中 [@problem_id:4778489]。

### 构建模块：计算如何进行

让我们通过一个现代例子来揭开保证计算的神秘面纱：验证一个旨在提醒医生注意败血症的AI算法 [@problem_id:5219898]。假设计划是在 $n=100$ 个已知败血症病例上测试该AI，如果AI正确标记了至少90个病例，则试验“成功”。AI的真实但未知的灵敏度（正确标记一个病例的概率）是参数 $\theta$。

1.  **[功效函数](@entry_id:166538)**：首先，我们需要知道对于任何*给定*的灵敏度 $\theta$，成功的概率是多少。如果真实灵敏度是 $\theta$，那么在 $100$ 次试验中的成功次数遵循[二项分布](@entry_id:141181)。获得90次或更多成功的概率，$P(X \ge 90 | \theta)$，就是**功效函数** $\pi(\theta)$。它是一个函数，告诉我们如果我们知道世界的真实状态，我们成功的机会有多大。

2.  **先验分布**：我们不知道 $\theta$。但根据AI的开发数据，我们可能认为它在 $0.92$ 左右，尽管它可能稍好或稍差。我们可以用一个[先验分布](@entry_id:141376)来捕捉这种信念。Beta分布常用于像 $\theta$ 这样是概率的参数。它提供了一种灵活的方式来描述我们在0到1区间上的不确定性 [@problem_id:5219898]。

3.  **积分（平均）**：现在，我们把这两部分结合起来。我们将每个可能的 $\theta$ 的功效 $\pi(\theta)$ 乘以该 $\theta$ 的可信度 $p(\theta)$，然后在所有可能性上求和（或积分）。结果就是保证。这个计算给出了我们成功的先验预测概率，在本例中，它来自一个称为Beta-[二项分布](@entry_id:141181)的分布 [@problem_id:5219898]。

需要理解的一个关键点是，这与简单地计算先验均值处的功效是不同的。也就是说，$E[\pi(\theta)]$ 通常不等于 $\pi(E[\theta])$ [@problem_id:5219898]。[功效函数](@entry_id:166538)通常是S形（非线性）的，对非线性函数求平均与求均值的函数值是不同的。通过在整个先验上积分，保证正确地考虑了这样一个事实：$\theta$ 的极低或极高值，即使可能性较小，也可能对成功概率产生巨大影响。

### 现实世界中的保证：混合设计与贝叶斯目标

保证最优雅的特性之一是其灵活性。它可以作为贝叶斯世界和频率主义世界之间的桥梁，也可以在纯贝叶斯框架中使用。

-   **混合设计**：在许多受监管的领域，如医学，一项研究可能用贝叶斯原则来设计，但必须使用传统的频率主义检验（例如，[t检验](@entry_id:272234)的[p值](@entry_id:136498)）进行分析。保证对此非常适用。我们可以使用标准的频率主义功效函数作为我们的 $\text{Power}(\theta)$，并在我们对参数的[先验信念](@entry_id:264565)上对其进行平均。这使我们能够使用一种更现实、考虑不确定性的方法来为一项最终将由经典指标评判的试验选择样本量 [@problem_id:4579196]。

-   **完全贝叶斯设计**：或者，我们可以设计一个目标本身就是贝叶斯的研究。我们可能不追求小的p值，而是宣布成功，如果数据为正效应提供了强有力的证据——例如，如果效应量 $\theta$ 大于零的**后验概率**至少为95%，即 $P(\theta > 0 | \text{data}) \ge 0.95$ [@problem_id:4787110]。保证于是就成为满足此贝叶斯准则的先验预测概率。这就创造了一个设计哲学和分析哲学完美对齐的连贯过程。

### 细微之处：保证能教给我们什么

深入探究，保证的概念揭示了一些关于实验设计的微妙而深刻的真理。

-   **怀疑的代价（先验与似然的冲突）**：假设我们希望证明一种新药具有有意义的效应（$\delta > 0.2$），但我们基于过去证据的[先验信念](@entry_id:264565)集中在一个非常小的效应上（$m_0 \approx 0$）。当我们计算保证时，我们是在反复模拟实验，而“真实”效应大多是从我们悲观的先验中抽取的。毫不奇怪，在大多数这些模拟现实中，实验未能显示出强烈的效应。保证的计算量化了这种张力。它可能会揭示，无论我们招募多少患者，我们都无法达到目标保证，因为我们的先验信念与我们乐观的目标直接冲突。保证作为一个关键的现实检验，迫使我们调和我们所相信的与我们希望实现的 [@problem_id:5219843]。

-   **优化分析本身**：在[贝叶斯分析](@entry_id:271788)中，分析先验的选择是方法的一部分。这就提出了一个有趣的问题：我们能否选择一个能最大化我们成功机会的分析先验？利用保证，我们可以做到。我们可以固定我们对世界的*真实*信念（“设计先验”），然后从数学上探索哪个“分析先验”能给出最高的保证。这可能会揭示，例如，在一项寻找小效应的研究中，使用一个更具怀疑性的分析先验（方差较小的先验）有时可以增加发现阳性结果的概率，这是一个不明显但强大的洞见 [@problem_id:4196372]。

-   **通往完整决策理论的垫脚石**：保证，在其典型形式中，将成功视为一个简单的[二元结果](@entry_id:173636)（通过/失败）。但这是一种简化。一个更完整的图景会考虑我们决策的细微后果。正确批准一种伟大的新药的社会效益是什么？错误批准一种无效药物的成本是什么？以及进行试验本身的货币成本是多少？贝叶斯决策理论为此提供了一个框架，使用一个**[效用函数](@entry_id:137807)** $U(d, \theta, \text{action})$ 来捕捉所有这些成本和收益。目标于是变成选择能最大化*期望效用*的设计 $d$（例如，样本量），该期望效用是在关于 $\theta$ 和未来数据的所有不确定性上平均的。保证可以被看作是这个宏伟框架的一个特殊、简化的案例，其中效用对于“成功”的研究仅为1，对于“失败”的研究为0。它是迈向一个统一、理性的不确定性下决策理论的强有力的第一步 [@problem_id:4941264]。

归根结底，贝叶斯保证不仅仅是一个公式。它是在不确定性下进行规划的范式。它迫使我们明确我们的信念，考虑所有可能性，并欣赏我们所知、所不知以及我们希望发现的东西之间错综复杂的舞蹈。

