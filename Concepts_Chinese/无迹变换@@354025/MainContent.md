## 引言
估计动态系统的状态——即了解某物的位置及其未来走向——是贯穿科学与工程领域的一个根本性挑战。虽然[线性系统](@article_id:308264)已得到充分理解，但现实世界绝大多数是非线性的，在这样的世界里，简单的预测会失效，不确定性以复杂、违反直觉的方式演化。传统方法，如[扩展卡尔曼滤波器](@article_id:324143)（EKF），在这种环境中常常举步维艰，它们依赖的[线性近似](@article_id:302749)可能导致严重错误，甚至使整个滤波器完全失效。本文将介绍一种更鲁棒、更优雅的解决方案：[无迹变换](@article_id:342633)（UT）。我们将探讨这项强大技术如何通过巧妙地近似不确定性而非动力学本身，来避开[线性化](@article_id:331373)的陷阱。这段旅程始于第一章“原理与机制”，我们将在这里解析UT的工作原理，将其与EKF进行直接比较，并讨论其在实际应用中的成本与考量。随后，第二章“应用与跨学科联系”将展示UT卓越的通用性，从跟踪航空航天飞行器的运动到推断活细胞的生物物理参数。

## 原理与机制

想象你是一名空中交通管制员，对一架飞机的位置和速度有一个相当准确的了解。你可以将这个“了解”想象成天空中一小团模糊的可能性云——我们称之为**[概率分布](@article_id:306824)**。这团云的中心是你最好的猜测（即**均值**），云的大小和形状则代表了你的不确定性（即**[协方差](@article_id:312296)**）。现在，你需要预测一分钟后这团云的位置。如果飞机在没有风的情况下沿直线飞行，计算会很简单；这团云只是平移而已。

但世界很少如此简单。如果飞机正穿过一个有着旋转气流和变化空气密度的复杂[天气系统](@article_id:381985)呢？这个过程不再是一条直线，而是**非线性**的。简单地将你的不确定性云向前推进是行不通的。这团云会被拉伸、扭曲和变形。精确追踪这片新的、复杂云团的形状是一项几乎不可能完成的任务。这就是非线性世界中估计问题的根本挑战。

### 朴素的方法：一种会导致“失明”的近似

经典的工程方法，如在**[扩展卡尔曼滤波器](@article_id:324143)（EKF）**中使用的方法，是耍了点小聪明。它认为：“我处理不了这整个复杂、旋转的过程。所以，我只看我不确定性云的中心，并假装在该点上这个过程是一条简单的直线。”这被称为**线性化**。我们用一条笔直的切线来近似这条弯曲的路径。

对许多问题来说，这是一个不错的技巧。但有时，它会惨败。考虑一个简单但富有启发性的场景：我们正在追踪一个值 $x$，我们认为它以零为中心，并具有一定的不确定性，比如 $x \sim \mathcal{N}(0, 1)$。我们对这个值的测量不是 $x$ 本身，而是它的平方，$h(x) = x^2$ [@problem_id:2756731]。那么，我们对测量值的最佳猜测是什么？EKF在对 $x$ 的最佳猜测值（即均值 $\mu=0$）处对函数 $h(x)=x^2$ 进行线性化。$x^2$ 在 $x=0$ 处的[导数](@article_id:318324)为零。因此，EKF的近似是一条平坦的水平线。它预测测量值将是 $0^2=0$，更糟糕的是，它预测不确定性根本不会改变！滤波器实际上变得“失明”，断定测量没有提供任何新信息。

但我们知道得更清楚！既然 $x$ 是一个围绕零的可能性云（例如，从-1到1），$x^2$ 就必须是一个正数云。真实的平均值不是零；对于均值为0、方差为1的高斯分布， $x^2$ 的真实平均值恰好是1 [@problem_id:2705954]。EKF的预测不仅仅是有些偏差，而是根本性错误，因为它完全忽略了函数的*曲率*。这就像试图只看抛物线的顶点来描述整条抛物线一样。

### 更巧妙的策略：[无迹变换](@article_id:342633)

这时，一个真正优美的思想应运而生——**[无迹变换](@article_id:342633)（UT）**。UT的理念是：**如果路径过于复杂以至于难以近似，那我们干脆就不去近似它。相反，我们用几个精心挑选的点来近似不确定性云，然后将这些点通过*真实*的、弯曲的路径进行传播。**

再次想象我们的不确定性云。我们不再试图计算整个云团如何扭曲，而是挑选几个具有[代表性](@article_id:383209)的“侦察”粒子。我们观察这些侦察粒子在真实的非线性过程推动下会落在何处。然后，根据这些落点的位置，我们重构出新的、更新后的不确定性云。这些确定[性选择](@article_id:298874)的侦察粒子就是我们所说的**sigma点**。

其精妙之处在于我们*如何*选择它们。目标是选择一个最小的点集，使其[完美匹配](@article_id:337611)我们原始不确定性云的基本属性：它的均值（[质心](@article_id:298800)）和[协方差](@article_id:312296)（分布范围和方向）。事实证明，对于一个 $n$ 维的状态，我们只需要 **$2n+1$ 个sigma点**就能出色地完成这项工作 [@problem_id:2886771]。其方法出奇地简单：

1.  将一个sigma点放置在均值 $\hat{x}$ 处。
2.  对于不确定性云的 $n$ 个[主方向](@article_id:339880)（轴）中的每一个，在均值两侧沿该方向各放置一个点，向[外延](@article_id:322333)伸。

这些点形成一个对称的[星形图](@article_id:335255)案，体现了我们原始分布的前两阶矩。

![一个二维高斯分布的sigma点，展示了一个点在均值处，另外两个点沿[协方差](@article_id:312296)椭圆的每个[主轴](@article_id:351809)分布。](https_latex_images_unscented_transform_sigma_points.png)
*图1：一个二维分布的$2n+1=5$个sigma点。选择这些点是为了匹配原始不确定性椭圆的均值和协方差。*