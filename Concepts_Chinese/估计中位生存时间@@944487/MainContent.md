## 引言
一个过程会持续多久？这个基本问题出现在从医学到工程的无数领域中。虽然简单的平均值（均值）通常是我们的第一反应，但在研究[事件发生时间数据](@entry_id:165675)时，它却显得力不从心。研究常常在每个受试者都经历事件之前就结束了——病人仍在缓解期，或者某个部件仍在正常工作。这种常见情况被称为右删失，它使得计算真实均值变得不可能，并凸显了简单分析中的一个关键知识空白。

为了克服这一挑战，我们转向一个更稳健、更真实的度量标准：[中位生存时间](@entry_id:634182)。它代表着组内半数受试者经历事件的时间点。本文为理解和估计这一关键值提供了全面的指南。为了充分掌握其强大之处，我们首先深入探讨其核心原理和机制，解释像 [Kaplan-Meier](@entry_id:169317) 估计量这样的方法如何让我们在数据不完整的情况下进行计算。随后，“应用与跨学科联系”一章将展示这些统计工具如何在关键的现实世界情境中应用，从拯救生命的临床试验到机器学习的前沿领域。

## 原理与机制

它会持续多久？这是我们对几乎任何事物都能提出的最基本的问题之一。一种新的心脏病药物需要多久才能显示效果？一颗卫星的电池能用多久？一位处于缓解期的病人何时会复发？我们 sürekli地面临关于*事件发生时间*的问题。

第一反应可能是计算一个平均值，即我们熟悉的*均值*时间。但这个简单的工具在现实世界中常常失效。想象一下，你是一位材料科学家，正在测试一种新型的超耐用聚合物复合材料。你将十个样本置于压力下，等待它们失效。数月后，六个已经失效，但当你的项目经费耗尽时，还有四个仍然完好无损。那么，平均[疲劳寿命](@entry_id:182388)是多少？你无法计算，因为你不知道其中四个样本的最终失效时间。它们的故事尚未结束。这就是**[右删失](@entry_id:164686)**的根本挑战，它并非数据的缺陷，而是研究随时间变化的事件时 inherent 的一个特征。

### [中位数](@entry_id:264877)：一种更真实的衡量“多久”的方式

除了均值，我们可以转向一个更稳健且通常信息更丰富的度量：**[中位生存时间](@entry_id:634182)**。这很简单，就是指组内一半成员经历事件的时间点。它是该群体的“半衰期”。如果接受新疗法的患者的[中位生存时间](@entry_id:634182)是五年，这意味着五年后，我们预期 50% 的患者仍然存活。

[中位数](@entry_id:264877)具有极好的普适性。它不易受极端异常值的影响——一个奇迹般地永远持续下去的组件不会扭曲结果。更重要的是，我们无需等待每个人都经历事件就能计算它。一旦跨过 50% 的标记，我们就可以确定中位数，即使许多受试者仍在继续。这使其成为从临床试验到[可靠性工程](@entry_id:271311)等各个领域不可或abeilles的工具[@problem_id:4853781]。

### 未完故事之谜：删失

那么，我们如何处理那些未完的故事——即删失的观测数据？我们不能简单地忽略它们。这就像只统计阵亡士兵而忽略那些在日落时仍在战斗的士兵来撰写一场战役的历史。这会给我们一个对生存情况 artificially 悲观的看法。同样，我们也不能把它们当作在失去追踪的那一刻就失效了；那又会过于乐观[@problem_id:4545940]。

删失数据点包含着宝贵的信息。一个聚合物样本在测试停止前承受了 14 万次循环，这告诉我们它的[疲劳寿命](@entry_id:182388)*至少*是 14 万次循环[@problem_id:1949188]。一个病人在搬到另一个城市前三个月内没有复发，这告诉我们他们成功地生存了那三个月[@problem_id:4545940]。诀窍在于找到一种方法，既能尊重地纳入这段已知的生存期信息，又不对未知的未来做错误的假设。

### 让数据说话：[Kaplan-Meier](@entry_id:169317) [阶梯图](@entry_id:263049)

这就是统计学中最优雅的思想之一发挥作用的地方：**Kaplan-Meier 估计量**。它是一种**非参数**方法，这个花哨的说法意味着我们不强迫数据去拟合一个预设的数学形状。我们让数据自己描绘出生存的图景。

其核心直觉是把生存看作一系列有条件的障碍。Kaplan-Meier 曲线是逐步构建的，仅在事件发生的确切时刻发生变化。在每个事件时间点，我们问一个简单的问题：“在所有存活至今的个体中，有多大比例的人在此次特定事件中存活了下来？”

公式如下：
$$ \hat{S}(t) = \prod_{i: t_i \le t} \left(1 - \frac{d_i}{n_i}\right) $$

让我们来分解一下。$\hat{S}(t)$ 是我们估计的存活超过时间 $t$ 的概率。大写的 $\Pi$ 符号表示我们将一系列项相乘。每一项，$(1 - \frac{d_i}{n_i})$，代表在事件时间 $t_i$ 的“危险点”存活下来的概率。这里，$d_i$ 是在时间 $t_i$ 经历事件的个体数量，$n_i$ 是在那一刻之前“处于风险中”（即存活且尚未被删失）的总个体数量[@problem_id:4545940]。

想象一个只有五名患者的小型肿瘤学研究[@problem_id:4806039]。
- 开始时（$t=0$），所有 5 人都处于风险中，生存概率为 $1.0$。
- 在 $t=2$ 个月时，一名患者发生事件。处于风险中的人数为 $n_1=5$，事件数为 $d_1=1$。生存概率降至 $S(2) = (1 - 1/5) = 0.8$。
- 在 $t=4$ 个月时，又发生一次事件。现在，只有 4 名患者处于风险中。所以，$S(4) = S(2) \times (1 - 1/4) = 0.8 \times 0.75 = 0.6$。
- 在 $t=5$ 个月时，一名患者被删失（搬走了）。生存曲线没有变化！但这名患者不再处于风险集中。他们贡献了 5 个月的生存信息，然后 gracefully 地退出了。现在只有 2 名患者处于风险中。
- 在 $t=9$ 个月时，第三次事件发生。处于风险中的人数为 2 人（在最初的 5 人中，1 人在 $t=2$ 时发生事件，1 人在 $t=4$ 时发生事件，1 人在 $t=5$ 时被删失）。所以，$S(9) = S(4) \times (1 - 1/2) = 0.6 \times 0.5 = 0.3$。

得到的曲线是一个[阶梯图](@entry_id:263049)。它保持平坦，然后在每个事件时间点垂直下降。每次下降的高度取决于那一刻有多少人处于风险中。这就是该方法的美妙之处：每个个体在被观察的整个期间都对分母（$n_i$）做出贡献，从而正确地加权了每一步的[条件概率](@entry_id:151013)。

### 寻找群体的半衰期

一旦我们有了 Kaplan-Meier [阶梯图](@entry_id:263049)，找到[中位生存时间](@entry_id:634182)就变得很简单。我们只需寻找生存曲线首次降至或低于 0.5 的时间点。

因为曲线是一系列的阶梯，它可能不会精确地落在 0.5 上。例如，在一项关于微动开关可靠性的研究中，生存估计值可能在 680 小时为 0.5625，然后在 900 小时降至 0.45[@problem_id:1961443]。中位数是多少？为了解决这个问题，我们使用一个精确的定义：[中位数](@entry_id:264877)是生存概率小于或等于 0.5 的*[下确界](@entry_id:140118)*（或最早时间）。在微动开关的例子中，[中位数](@entry_id:264877)是 900 小时，即跨过 50% 阈值的那个时刻。这个约定提供了一个唯一的答案，即使曲线“跳过”了 0.5 这条线[@problem_id:4985924]。在我们上面那个小小的肿瘤学例子中，生存概率在 $t=9$ 个月时从 0.6 降至 0.3，所以[中位生存时间](@entry_id:634182)是 9 个月。

### 另一个视角：当自然遵循规律时

Kaplan-Meier 方法之所以强大，是因为它不做任何假设。但有时，我们有充分的理由相信失效过程遵循一个更简单的 underlying 规律。这就是**参数**方法。

最基本的模型假设**[风险率](@entry_id:266388)恒定**。这意味着瞬时失效风险在任何时刻都是相同的，无论受试者已存活多久。这就是著名的**[无记忆性](@entry_id:201790)**。放射性元素的原子是一个完美的例子；它在下一秒衰变的几率是恒定的，无论它是全新的还是已存在十亿年。

恒定的风险率，$h(t) = \lambda$，导致生存率呈指数衰减，由优美的简单函数 $S(t) = \exp(-\lambda t)$ 描述。由此，我们可以直接计算[中位生存时间](@entry_id:634182)为 $t_{\text{med}} = \frac{\ln(2)}{\lambda}$ [@problem_id:4562457]。这与用于计算放射性半衰期的公式相同，揭示了看似迥异的领域之间深刻的联系。

当然，并非所有事物都是无记忆的。汽车零件随着老化越来越可能失效（风险增加），而一些电子元件可能有很高的“[婴儿死亡率](@entry_id:271321)”，随后该比率会随时间降低。**[威布尔分布](@entry_id:270143)**是一个更灵活的参数模型，可以捕捉这些行为。其风险函数为 $h(t) = \lambda k t^{k-1}$。[形状参数](@entry_id:270600) $k$ 是关键：如果 $k>1$，风险随时间增加（耗损）；如果 $k1$，风险随时间减少；如果 $k=1$，我们又回到了无记忆的指数模型。这为描述失效物理学提供了更丰富的语言，并且仍然为我们提供了一个简洁的[中位数](@entry_id:264877)公式：$t_{\text{med}} = (\frac{\ln(2)}{\lambda})^{1/k}$ [@problem_id:5228311]。

### 知其所不知：观测的局限

[Kaplan-Meier](@entry_id:169317) 曲线是一个卓越的工具，但理解其局限性很重要。如果我们的研究结束时，最后几个受试者被删失，而生存曲线仍高于（比如说）0.6，会发生什么？在这种情况下，曲线从未达到 0.5 的线。我们无法计算出有限的[中位生存时间](@entry_id:634182)。我们唯一能诚实地说的是，[中位数](@entry_id:264877)*大于*我们最长的观测时间。

这揭示了一个更深层的问题，即**尾部不可识别性**。因为在最后一次观测到的事件之后没有事件发生，我们没有数据告诉我们接下来会发生什么。Kaplan-Meier 曲线只是在其最后一个值处永远保持平坦，但我们知道*真实*的生存曲线最终必须降至零。数据对于这种情况如何以及何时发生是沉默的[@problem_id:4989542]。

这就是为什么我们通常无法非参数地估计*均值*生存时间；计算它需要知道整个曲线，包括不可观测的尾部。一个巧妙的解决方法是使用**限制性平均生存时间 (RMST)**。我们不计算所有时间内的平均生存时间，而是计算*截至某个特定时间点*（比如五年）的平均生存时间。这其实就是 Kaplan-Meier 曲线在该时间点之前的曲线下面积，这个值总是可以从数据中计算出来，并提供了一个有意义的总结：“平均而言，该组患者在最初五年的随访期中有 X 年是无事件的”[@problem_id:4989542]。

最后，我们从数据中计算出的任何数字——无论是[中位数](@entry_id:264877)还是 RMST——都只是一个估计值。不同的样本会得出略有不同的答案。我们对我们的估计有多大信心？**[自助法](@entry_id:139281) (Bootstrap)** 是一个强大的、由计算机驱动的方法，帮助我们回答这个问题。我们将我们的样本视为一个迷你宇宙，并从中（有放回地）抽取新的样本。对于每个新的“自助样本”，我们重新计算[中位数](@entry_id:264877)。在重复这个过程数千次后，我们收集到的[中位数](@entry_id:264877)的分布直接衡量了我们原始估计的不确定性，使我们能够构建一个[置信区间](@entry_id:138194)[@problemid:4948655]。这是一个绝佳的示范，展示了如何利用数据本身不仅告诉我们最可能的结果，还告诉我们其自身合理的不确定性范围。

