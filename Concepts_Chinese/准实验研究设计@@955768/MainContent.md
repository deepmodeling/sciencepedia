## 引言
探索因果关系是科学探究的一个根本目标，它让我们能够理解一项新政策或干预措施是否真正有效。虽然随机对照试验（RCTs）是建立因果关系的金标准，但其应用常常受到伦理、实践或法律的限制，导致在许多最重要的社会问题上存在关键的知识空白。本文旨在应对这一挑战，探索准实验研究设计的世界——这是一个从真实世界数据中进行因果推断的强大工具箱。在接下来的章节中，您将首先深入探讨“原理与机制”，了解[双重差分法](@entry_id:636293)和中断时间序列等设计如何巧妙地构建反事实，以估计干预措施的影响。随后，“应用与跨学科联系”一章将展示这些方法的实际应用，证明它们在从公共衛生和医学到生态学和社会政策等领域的效用。

## 原理与机制

要真正理解世界，要超越纯粹的相关性，把握因果关系的脉络，这是科学的终极目标。如果我们想知道一种新疫苗能否预防疾病，一项新法律能否减少犯罪，或者一种新肥料能否提高[作物产量](@entry_id:166687)，我们就是在问一个关于因果关系的问题。但这个问题隐藏着一个令人沮gà的悖论。要想确切地知道你的头痛是因为你吃了阿司匹林才消失的，你需要看到在另一个平行宇宙中，你在完全相同的时间点*没有*吃阿司匹林会发生什么。这个无法观测的平行世界，就是科学家所说的**反事实**（counterfactual），而无法看到它，正是因果推断的根本问题。

### 随机化的精妙之处

我们如何才能窥探这个反事实世界？很长一段时间以来，最精妙且最有力的答案一直是**随机对照试验（RCT）**。这个想法的 simplicity 堪称天才。如果我们想测试一种新药，我们不能只把它给一群病人，然后看他们是否好转。他们可能本来就会好转。相反，我们召集一大群人，通过像抛硬币一样盲目而公平的过程，将他们分成两组。一组服用药物，另一组服用安慰剂。

借助随机化的魔力，这两组在平均意义上，在所有可以想象的方面都是相同的——年龄、基因、生活方式、疾病严重程度，你能想到的都有。无论是已测量的还是未测量的因素，都得到了平衡。一组变成了另一组的统计学分身。因此，[对照组](@entry_id:188599)成为了一个活生生的、代表反事实世界的替身。它向我们展示了如果治疗组没有接受治疗会发生什么。现在，两组之间结果的任何差异，都可以极有信心地归因于药物本身。

RCT 之所以是金标准，是有其原因的。它是我们能做到的最接近创造一个真实实验的方法，甚至满足了建立因果关系最严格的标准，例如 Bradford Hill 关于因果关系的著名观点中的**实验标准** [@problem_id:4509107]。但当现实世界构成阻碍时会怎样？如果将一项可能挽救生命的政策从[对照组](@entry_id:188599)中剔除是不道德的呢？如果将一些县随机分配适用一项新法律而另一些县不适用，在法律上是不可能的呢？或者，如果随机实施一项全国性的税收政策在物理上就是不可能的呢？[@problem_id:4562304] [@problem_id:4491466] 对于这些庞大、复杂且通常最重要的问题，我们必须成为侦探。我们必须寻找世界在其混乱运行中为我们进行的实验。这就是**准实验研究设计**的领域。

### 大自然的自身实验

准实验是一项无需随机分配，用以估计干venc措施因果影响的经验性研究。其核心思想是找到一个**自然实验**，即外部力量——政策变化、法律裁决、地理边界——创造了一种“如同”随机分配到治疗组的情境 [@problem_id:4748446]。科学家的工作不是创造随机分组，而是要足够聪明地在世界提供这些分组时识别出它们。这不是实验室里干净、受控的环境；这是在野外进行的因果推断。

这些设计与简单的描述性报告（如**病例系列**）有着根本的不同。病例系列可能会描述30名感染患者的特征，但无法告诉你一场旨在减少该感染的运动是否真的奏效。而准实验，即便是像前后研究这样简单的设计，也是一种*分析性*设计；它试图创造一个比较来估计效果，无论这个比较多么不完美 [@problemid:4518810]。其艺术和科学在于让这种比较尽可能可信。为此，我们有一个强大的设计工具箱，每种设计都建立在一种不同且巧妙的方法之上，以构建一个可信的反事实。

### 因果侦探的工具箱

想象一下，你是一名公共卫生官员，在一个医院病房（A病房）实施了一项新的、强化的手部卫生计划，但在另一个病房（B病房）没有实施。你想知道这是否减少了感染。你没有随机分配病房，只是选择了一个。这是一个经典的准实验 [@problem_id:2063931]。你如何确定A病房感染率的任何下降都是由于你的计划，而不是其他原因？你需要一个好的反事实。以下是构建反事实的几把万能钥匙。

#### 平行世界法：双重差分

也许最直观、应用最广的准实验设计是**[双重差分法](@entry_id:636293)（Difference-in-Differences, DiD）**。其逻辑如下：我们无法通过随机化为我们的治疗组（A病房）创造一个同卵双胞胎。因此，让我们寻找次优选择：一个非同卵双胞胎，至少到现在为止，其步调与治疗组保持一致。我们找到一个比较组（B病房），并观察其随时间变化的数据。如果我们能证明，在干预前的几年里，A病房和B病房的感染率平行变动——同步上升和下降——我们就拥有了一个强有力的论据。

这就是著名的**[平行趋势假设](@entry_id:633981)**：即断言如果我们的计划*没有*在A病房实施，其感染率会继续以与B病房相同的方式发展 [@problem_id:4844521] [@problem_id:4842159]。B病房的趋势成为了A病房的反事实。

“双重差分”这个名字来源于一个简单的计算：
1.  计算治疗组结果的变化（“第一重差分”）：$Y_{post}^{A} - Y_{pre}^{A}$。
2.  计算[对照组](@entry_id:188599)结果的变化（“第二重差分”）：$Y_{post}^{B} - Y_{pre}^{B}$。
3.  从第一重差分中减去第二重差分。这个差分的差分，$\Delta_{DiD}$，就是我们对因果效应的估计。它分离出了治疗组中超越[对照组](@entry_id:188599)所捕捉到的长期趋势之外的“额外”变化。

这种方法曾被著名地用于评估州级医疗补助计划（Medicaid）扩张对健康结果的影响。扩大医疗补助计划的州是治疗组，而未扩大的州作为[对照组](@entry_id:188599)，研究人员仔细检查了政策变化前结果的平行趋势 [@problem_id:4748446] [@problem_id:4491466]。

#### 中断时间法：时间序列分析

但是，如果你没有[对照组](@entry_id:188599)怎么办？如果一项新政策在所有地方同时实施呢？此时，DiD方法就失效了。替代方案是**中断时间序列（Interrupted Time Series, ITS）**设计。在这种情况下，反事实不是另一个组，而是治疗组*自身的过去*。

如果我们有一个关于我们结果的长期数据点序列——比如说，一个学区三年来每月的肠胃炎发病率——我们就可以建立一个稳定的趋势。然后，干预发生——一个新的洗手计划启动了 [@problem_id:2063895]。这个时刻就是我们时间序列中的“中断点”。我们接着继续追踪结果。因果效应被估计为序列中的“断裂”。感染水平是否突然下降？趋势的下降斜率是否变得更陡峭？

ITS的核心假设是，如果没有干预，原先存在的趋势会持续不变 [@problem_id:4842159]。最大的威胁是**混淆事件**（confounding event），或称“历史”威胁：如果在洗手计划开始的同时，该市的供水系统也进行了升级，那会怎样？将所有变化都归因于该计划将是一个错误。然而，通过增加一个来自未实施该计划的学区的控制序列，我们可以加强设计，有效地创造出ITS和DiD的强大混合体 [@problem_id:4844521]。

#### 完美嵌合体法：合成控制

[合成控制法](@entry_id:635599)是DiD方法一个优美而现代的扩展。当你找不到任何一个具有良好平行预处理趋势的单一比较组时，该怎么办？也许你的处理单元——比如，某个通过了一项独特法律的州——与任何其他单一的州都太不相同了。解决方案是：构建一个更好的比较组。

**[合成控制法](@entry_id:635599)（SCM）**通过对多个未处理单元进行加权平均来构建一个“合成”[对照组](@entry_id:188599)。一个算法以某种方式选择权重，创造出一个反事实的科学怪人：一个复合单元，其干预前结果趋势和其他特征几乎[完美匹配](@entry_id:273916)处理单元 [@problem_id:4842159] [@problem_id:4562304]。

这个论点非常直观。如果这个合成对照，这个数据驱动的[嵌合体](@entry_id:264354)，在法律通过*之前*的几年里完美地追踪了我们的处理州，那么它在法律通过*之后*的轨迹就是我们对该处理州在没有该法律的情况下会发生什么的最合理的猜测。真实值与合成值之间的差异就是干预的估计效应。

#### 工具箱中的更多工具

这个领域的创造力是巨大的。在**阶梯-楔形设计**中，一项干预措施会随着时间的推移顺序推广到不同的群体，这意味着在任何给定的时间点，一些群体已接受治疗，而另一些则在等待，这提供了丰富的比较数据，可以控制潜在的时间趋势 [@problem_id:2063895]。在**回归断点设计**中，我们利用一个明确的截止点（比如获得住房券的收入门槛）创造自然实验的情境，因为刚好低于截止点的人很可能与刚好高于它的人几乎完全相同 [@problem_id:4748446]。

### 怀疑的艺术：关于犯错

这些设计的美妙之处在于其巧妙，但其可信度取决于我们作为严谨怀疑者的能力。因为我们并非身处RCT的纯净世界，我们必须不断担心对**内部效度**的威胁——即我们的因果结论在多大程度上是合理的。

一项好的准实验研究是侦探工作的实践，需要排除其他的可疑对象。主要的嫌疑对象总是**混淆**：是否有其他未观察到的因素导致了我们看到的变化？对于DiD，这意味着要严格检验[平行趋势假设](@entry_id:633981)。对于ITS，这意味着要详尽地搜索在同一时间发生过的其他事件。

其他威胁也潜伏着。**污染**（Contamination）发生于你的[对照组](@entry_id:188599)接触到了干预措施，也许是因为干预病房的员工与对照病房的朋友分享了他们学到的东西。这会稀释观察到的效果，使你的项目看起来没有它真实的效果那么好 [@problem_id:5112657]。或者考虑**测量偏倚**：如果“之后”时期评估结果的人比“之前”时期的人技能更高或使用了更好的工具，你可能会发现一个“效果”，而这个效果纯粹是由于更换了测量工具造成的假象 [@problem_id:5112657]。

### 证据织锦

最终，没有一项研究是完美的。科学界建立信心不是靠一项完美无瑕的研究，而是通过将许多具有不同优缺点研究的证据编织成一张织锦。这就是为什么我们有**证据等级**（hierarchy of evidence）[@problem_id:4525677]。许多RCTs的meta分析位居顶端。但一项精心设计的准实验远比一个只能调整其可测量混淆因素的简单观察性研究更有力。

最终，设计的选择取决于问题。一项解释性RCT非常适合回答关于**功效**（efficacy）的问题：一种药物在理想的实验室条件下是否有效？但一项大型准实验可能更适合回答关于**效果**（effectiveness）的问题：一项复杂、真实的卫生政策在推广到一个多样化人群中时，是否真的有效？ [@problem_id:4525677]

从相关到因果的旅程是科学中最重要的旅程之一。虽然随机化提供了一条美丽笔直的道路，但我们并非总能走上这条路。准实验设计提供了蜿蜒、通常更具挑战性但最终可以通行的路线。它们代表了在现实世界的约束下，智慧和严谨的胜利，使我们能够回答重要的问题，并以合理的信心程度理解究竟是什么导致了变化。这个严谨的、检查假设的框架是如此强大，以至于它甚至可以满足法庭上专家证据的严格标准 [@problem_id:4491466]。它证明了我们如何能够从生命本身这场宏大、不受控制的实验中，可靠地、科学地学习。

