## 引言
在许多科学领域，通过对其组分进行平均来简化复杂系统是一种强大的技术。然而，当一个组成部分的特定位置和局部相互作用不仅仅是细节，而是现象的本质时，这种方法往往会失效。这一局限性揭示了一个基本真理：空间至关重要。本文介绍了空间计算，这是一种将空间结构置于首位的计算范式，旨在弥补传统模型的不足，这些模型忽略了在现实世界系统中占主导地位的丰富的、相关的涨落。

在接下来的章节中，我们将首先深入探讨空间计算的“原理与机制”，探索为何简单的平均化会失败，以及如何受人脑启发构建人造系统以维持对空间的动态感知。随后，“应用与跨学科联系”一章将展示这些原理如何应用于不同领域，从绘制疾病暴发图、模拟天气模式，到揭示生命本身隐藏的结构。

## 原理与机制

### 为何我们不能简单地将一切平均化

在物理学乃至许多科学领域，我们都有一种强烈的简化本能。如果一个系统有数十亿个相互作用的部分——无论它们是气体中的原子还是人群中的个体——我们通常会试图通过观察*平均*部分来理解其行为。我们想象一个单一的、具有代表性的粒子，并认为它经历着由所有其他[粒子产生](@entry_id:158755)的有效“平均场”。这就是[平均场论](@entry_id:145338)的核心，它是一个出色的工具，让我们得以初步窥探磁性等复杂现象。

但这里有一个深刻的陷阱。当每个粒子都与其他所有粒子相连，或者当我们生活在高维世界时，这种将一切平均化的技巧效果很好。但在我们实际居住的世界——一个具有一、二或三维空间的世界里——这种近似可能会彻底失败。在[临界点](@entry_id:142397)附近，比如磁铁失去磁性的温度点，系统在所有尺度上都充满了活动。取向一致的自旋小团簇形成又消散，这反过来又影响更大的团簇。这些就是**涨落**：对平均行为的偏离。在低维空间中，这些涨落变得如此剧烈，并且在很长的距离上相互关联，以至于它们完全主导了“平均”图像。[平均场近似](@entry_id:144121)由于其本质而忽略了这些涨落，因此错失了[相变过程](@entry_id:147919)中真实而丰富的物理学 [@problem_id:1972140]。

这种失败不是一个缺陷，而是我们现实世界的一个特征。这是大自然给出的一个线索：*空间至关重要*。一个粒子的具体位置及其与近邻的关系不仅仅是可以被平均掉的细节，它们往往是现象的本质。要理解这些系统，我们需要一种将空间置于核心位置的思维方式和计算模式。这就是**空间计算**的世界。

### 最初的空间计算机：你的大脑

在构建空间计算机之前，让我们先看看有史以来最精密的空间计算机：人脑。想象一位右脑中风的病人。他们的视力可能完全正常——如果你在他们左侧展示一个物体，他们的眼睛可以检测到它。他们的大脑初级视觉皮层，即接收来自视网膜的初始“像素数据”的部分，工作正常。然而，他们的行为可能表现得好像整个左侧世界根本不存在一样。他们可能只吃盘子右侧的食物，或者只画出钟面的右半部分。这种奇怪而引人入胜的病症被称为**视觉空间忽略**。

问题出在哪里？问题不在于原始的感官输入，而在于大脑内部的空间*模型*。我们的大脑有专门处理视觉信息的通路。一条“腹侧通路”通向颞叶，负责弄清楚一个物体*是什*么——它是一张脸、一个杯子，还是一只老虎？但另一条独立的**背侧通路**则通向顶叶，专门负责弄清楚物体*在哪里*以及如何与之互动。它维护着一个关于我们周围世界的动态的、以自我为中心的地图。患有忽略症的病人，其背侧“何处”通路受到了损伤。他们内部的空间模型被撕裂成了两半 [@problem_id:4693351]。

这揭示了一个基本原则。空间感知不仅仅是被动的感知，它是一种主动的计算。你的大脑在不断地构建、维护和更新一个空间状态，该状态整合了你所看到的、你所在的位置以及你打算做什么。这是空间计算的原型。

### 为空间构建一个“人造心智”

我们如何构建一个能够模仿这种能力的人工系统？让我们考虑一个高风险的应用：一个用于指导外科医生的增强现实 (AR) 系统。其目标是将术前[CT扫描](@entry_id:747639)创建的患者血管三维模型，在手术过程中通过外科医生的头戴设备直接叠加到患者身上。

这是一个典型的空间计算问题 [@problem_id:4863072]。它不是一次单一的计算，而是要在三个拥有各自坐标系的不同世界之间，维持一种精细、持续的协调：

1.  **模型世界 ($\mathcal{F}_M$)：** 血管的数字三维模型。
2.  **物理世界 ($\mathcal{F}_P$)：** 躺在手术台上的真实患者。
3.  **观察者世界 ($\mathcal{F}_H$)：** 外科医生头戴设备不断移动的视角。

空间计算机的核心任务是持续计算正确的变换，将一个点从模型世界映射到外科医生显示器上的一个像素，从而使虚拟血管看起来完美地锚定在真实患者身上。这个过程有几个关键要素：

-   **配准：** 这是模型与现实之间的初始“握手”。它是计算一个单一的[刚性变换](@entry_id:140326) $T_{PM}$，将模型的坐标系 $\mathcal{F}_M$ 与患者的坐标系 $\mathcal{F}_P$ 对齐。

-   **追踪：** 这是这项工作中持续不断的实时部分。外科医生的头部总是在移动。系统必须在每一刻追踪头戴设备相对于患者的位置和方向 $\mathcal{F}_H$。这会产生一个随时间变化的变换 $T_{HP}(t)$。

-   **渲染：** 在每一帧，系统都必须组合这些变换。要将模型中的一个点 $\mathbf{x}$ 投影到外科医生的视野中，它需要计算映射 $g(t,\mathbf{x}) = \Pi(T_{HP}(t) T_{PM} \mathbf{x})$，其中 $\Pi$ 是从三维空间到二维显示器的投影。

这是一个**闭环系统**。外科医生的感知提供反馈。如果叠加层出现漂移，外科医生可以提供新的信息——例如，通过触摸患者身上的一个标志点——来精化配准。该系统必须不断对抗现实世界中的难题：导致追踪不完美的传感器噪声，以及意味着所显示的图像总是基于外科医生头部几毫秒前位置的延迟。

因此，空间计算是**对空间状态进行持续的、基于传感器的维护**。这是一个动态的过程，旨在将数字信息与物理世界对齐，管理不确定性和时间延迟，以创造两者稳定而有用的融合。

### 局部性的语言

空间计算的核心是**局部性**思想——即空间中某一点发生的事情受其直接环境的影响最大。但我们如何将这种直觉转化为计算语言呢？

#### 何时可以忽略空间：集总世界

首先，我们必须知道什么时候空间*不*重要。想象一下一种代谢物在一小块组织中扩散。如果控制该代谢物浓度的过程在整个组织中变化非常缓慢，我们或许可以使用一个更简单的模型。我们可以定义一个**空间[相关长度](@entry_id:143364)** $\ell_c$，它是在该特征距离内两点浓度密切相关的度量。如果这个[相关长度](@entry_id:143364)远大于组织本身的尺寸 $L$，那么浓度在各处几乎是均匀的。在这种情况下，我们可以将整个系统视为一个单一的“集总块”，忽略其空间结构，并用一个简单的[常微分方程](@entry_id:147024)来描述其动力学 [@problem_id:3898594]。这就是**[集总参数模型](@entry_id:267078)**。

#### 尺度问题

选择集总模型还是空间模型，是一个尺度问题。现实世界是多尺度的，正确的描述取决于你的视角 [@problem_id:4106565]。
-   在**[变压器铁芯](@entry_id:202966)**内部，磁场被限制在薄金属叠片中。如果叠片厚度远小于磁[趋肤深度](@entry_id:270307)（磁场穿透的距离），我们可以将铁芯的磁特性视为集总的。
-   现在考虑一条200公里的**输电线**。在60赫兹的工作频率下，电磁波长超过3000公里。你可能认为这条线路相对较短，可以被视为一个集总块。但一次雷击可能会沿着线路发送一个波长仅为数米的高频脉冲。要对此进行建模，你绝对必须将该线路视为一个由描述行波的[偏微分](@entry_id:194612)方程（PDE）控制的空间[分布式系统](@entry_id:268208)。
-   进一步放大到**区域电网**。它是一个由节点（发电厂、变电站）和边（输电线）组成的离散网络。但如果我们关心的是缓慢的、跨越大陆的振荡，并且如果节点之间的平均距离远小于这些振荡的[相关长度](@entry_id:143364)，我们可以再次“模糊我们的视野”，将整个电网建模为一个连续场，用[偏微分](@entry_id:194612)方程来描述。

这里的教训是，没有唯一的“真实”模型。是否进行空间计算的选择，是你的系统大小与你所关心现象的[特征长度尺度](@entry_id:266383)之间的一场对话。

#### 定义“邻居”

当我们确实要考虑空间时，计算就变成了关于局部相互作用。一个系统在某一点的状态是根据其邻居的状态来更新的。但什么定义了邻居呢？
-   在像图像像素这样的规则网格上，答案很简单。一个像素有四个或八个直接邻居。这种简单的结构可以产生惊人强大的计算。想象一下培养皿中一个工程菌菌落，其中每个细菌都能感应到其邻居产生的化学物质。可以在每个细胞内设计一个简单的[基因回路](@entry_id:201900)，遵循这样的规则：“我的输出 = 我的输入 - 我的邻居总输入的一部分。” 当整个菌落执行这个简单的局部规则时，它计算出**[拉普拉斯算子](@entry_id:262740)**（$\nabla^2$）的离散版本。[拉普拉斯算子](@entry_id:262740)测量曲率，因此整个菌落充当了一个边缘检测器，突显出化学输入模式中的边界 [@problem_id:2719076]。这是非同寻常的：一个复杂的数学运算从数百万个细胞执行微不足道的局部计算中涌现出来。

-   如果你的数据不在一个整齐的网格上，比如从散布在组织样本中的单个细胞获得的[基因表达测量](@entry_id:196387)值，该怎么办？我们可以*构建*一个邻域。对于每个细胞，我们可以找到它的*k*-近邻（KNN）并建立连接，形成一个**邻域图** [@problem_id:5084483]。这个图为我们的计算定义了局部通信的通道。

-   在最高抽象层次上，这种邻域结构可以直接编码到我们对世界的[统计模型](@entry_id:755400)中。在一个**[高斯马尔可夫随机场](@entry_id:749746)（GMRF）**中，我们不是用协方差矩阵（它告诉我们每个点如何与其他所有点相关）来描述一个空间场，而是用它的[逆矩阵](@entry_id:140380)，即**[精度矩阵](@entry_id:264481)** $Q$。[精度矩阵](@entry_id:264481)的神奇之处在于它是稀疏的，并且其零元素对应于条件独立性。如果 $Q_{ij} = 0$，这意味着在给定所有其他点的情况下，位置 $i$ 和 $j$ 之间没有任何信息可以相互提供。$Q$ 的非零项直接定义了邻域图。当我们想要更新点 $i$ 的值的估计时，我们只需要听取那些满足 $Q_{ij} \neq 0$ 的点 $j$ 的信息——即它的马尔可夫毯邻域 [@problem_id:4359370]。在这里，假定的空间结构*就是*计算的结构。

### 涌现的魔力

我们已经看到了如何表示空间和定义局部规则。最后，也是最美妙的一步，是看看当我们让这些局部规则运行时会发生什么。

首先，我们可以使用这些结构来发现已经存在的模式。一旦我们有了[空间转录组学](@entry_id:270096)数据的邻域图，我们就可以问：相邻细胞的基因表达是否比随机细胞对更相似？一个名为**[Moran's I](@entry_id:192667)**的统计量正是做了这件事。它测量[空间自相关](@entry_id:177050)，给我们一个单一的数字，告诉我们数据中是否存在有意义的空间模式，或者只是随机的椒盐噪声 [@problem_id:5084483]。

但真正的魔力并非来自发现模式，而是来自创造模式。考虑一个包含两种化学物质 $u$ 和 $v$ [均匀混合物](@entry_id:146483)的培养皿。它们根据简单的规则进行反应：$u$ 被持续送入系统，并在与 $v$ 的反应中被消耗。该反应产生更多的 $v$，但 $v$ 也被缓慢地移除。这就是**Gray-Scott 模型**。在一个充分混合的烧杯中，不会发生太多事情。但现在，让我们把它放在一个培养皿里，让化学物质扩散。并且让我们做一个关键的调整：“抑制剂”化学物质 $u$ 的扩散速度比“激活剂”化学物质 $v$ 快得多。

发生的是[自组织](@entry_id:186805)的奇迹。从完全均匀的初始状态，涌现出复杂而美丽的模式：斑点、条纹、旋转的螺旋和错综复杂的迷宫状结构。这就是**[图灵斑图](@entry_id:268595)** [@problem_id:2655687]。一个微小的随机涨落就足够了。激活剂 $v$ 的一个小编动会消耗掉局部的抑制剂 $u$。因为 $v$ 扩散缓慢，它会停留在原地并增长。但是快速扩散的抑制剂 $u$ 在局部被耗尽，并从周围区域涌入，在生长的斑点周围形成一条抑制的“护城河”，阻止它占领一切，并允许其他斑点在附近形成。

这是最纯粹形式的空间计算。没有中央控制器。没有蓝图。只有简单的、局部的反应和扩散规则在空间中上演。模式，以其全部复杂性，从系统自身涌现。这是一个强有力的提醒，有时，最复杂的设计不是自上而下施加的，而是自下而上生长的，由空间本身的简单、局部逻辑编织而成。从贝壳上的图案到宇宙中的星系，大自然是空间计算的大师。

