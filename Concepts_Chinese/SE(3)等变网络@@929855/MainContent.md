## 引言
物理定律受一个深刻而优雅的原则支配：对称性。一个实验的结果不应依赖于其在空间中的位置或朝向。这一基本规则由[特殊欧几里得群](@entry_id:139383) SE(3) 描述，是宇宙的底层编排。随着机器学习成为科学发现不可或缺的工具，一个关键的挑战随之出现：我们如何构建能够理解并尊重这种深刻对称性的模型？标准神经网络对此力不从心，需要海量数据才能低效地学习这些几何规则，而更简单的对称特征又常常无法捕捉到全貌。

本文将介绍 SE(3) [等变网络](@entry_id:143881)，这是一类革命性的模型，它通过将对称性直接织入其架构中来解决这个问题。这些网络被构建为用几何的语言来“思考”，从而在效率、准确性和物理真实性方面取得了前所未有的提升。我们将探讨这些模型的工作原理及其在整个科学领域产生的影响。首先，在“原理与机制”部分，我们将解析不变性和等变性的核心概念，深入探讨驱动这些网络的数学机制，并讨论它们与基本守恒定律的联系。然后，在“应用与跨学科联系”部分，我们将纵览它们在现实世界中的影响，从模拟分子和材料中原子的舞蹈，到设计下一代拯救生命的药物。

## 原理与机制

想象一下观看一场芭蕾舞。舞者们以优雅和精准的动作移动，他们的动作受制于一套底层的编舞。物理定律与这套编舞非常相似，它们是支配原子和星系之舞的规则。而其中最深刻、最美丽的规则或许就是**对称性**。如果你做一个实验，然后将整个实验室搬到另一个城市，或者将它旋转一个朝向，物理定律——也就是那套编舞——将保持完全不变。你的实验结果将完全相同。这个简单而直观的想法却有着巨大的影响。

在物理学中，我们有一种精确的语言来讨论这些对称性：群论。三维空间中所有可能的刚体运动——平移和旋转——的集合被称为**[特殊欧几里得群](@entry_id:139383)**，或称 **SE(3) **。当我们说物理定律在 **SE(3)** 下是对称的，我们是在做一个强有力的陈述：宇宙没有特殊的“中心”，也没有偏好的“向上”方向。对于一个漂浮在太空中的分子，它的能量是一个标量，不取决于它在哪里或如何取向。交换两个相同的原子，一种**[置换对称性](@entry_id:185825)**，同样不会改变能量 [@problem_id:3886551]。这就是对称的交响曲，而我们的任务是教会机器去聆听它。

### 从不变性到等变性：两种对称性的故事

我们如何构建一个能理解这些基本规则的神经网络呢？一种天真的方法是简单地将原子的原始 $x, y, z$ 坐标输入标准网络，但这种方法会惨败。网络将不得不为分子的每一种可能朝向重新学习物理学，这是一项艰巨且低效的任务。一个稍好的想法是**数据增强**：向网络展示每个分子的数千个随机旋转的副本。但这就像通过背字典来学习一门语言，而不是掌握其语法。网络可能会接近正确，但永远无法达到自然界所拥有的那种精确、完美的对称性 [@problem_id:3777047] [@problem_id:3886551]。

一个更优雅的解决方案是设计本身就具有对称性的输入。我们可以不使用笛卡尔坐标，而是向网络输入那些本身就**不变**的量——即在旋转或平移下不会改变的量。两个原子之间的距离就是一个完美的例子，原子三元组之间的夹角也是。通过从这些几何不变量构建特征，我们可以保证网络对能量的预测也是不变的 [@problem_id:3736651] [@problem_id:3789433]。这就是诸如使用[原子中心对称函数](@entry_id:174796)（ACSF）或原子位置光滑重叠（SOAP）等“基于描述符”模型背后的原理。

但这只是故事的一半。虽然能量是标量，应该是 不变的，但许多其他物理性质却不是。考虑作用在原子上的力。力是矢量；它们既有大小也有方向。如果你旋转一个分子，作用在其原子上的力必须随之旋转。它们不是不变的，而是**等变的**。

这个区别至关重要 [@problem_id:3842265]。一个函数 $f$ 是**不变的**，如果对输入进行变换后，输出保持不变：
$f(\text{变换后的输入}) = f(\text{原始输入})$。

一个函数 $f$ 是**等变的**，如果对输入进行变换会导致输出发生相应的变换：
$f(\text{变换后的输入}) = \text{变换后的 } f(\text{原始输入})$。

让我们具体说明。如果我们用矩阵 $R$ 表示旋转，用向量 $t$ 表示平移，那么对于能量函数 $E$ 和力函数 $\mathbf{F}$：

-   **不变性（能量）：** $E(R\mathbf{r} + t) = E(\mathbf{r})$
-   **[等变性](@entry_id:636671)（力）：** $\mathbf{F}(R\mathbf{r} + t) = R\mathbf{F}(\mathbf{r})$

一个[等变网络](@entry_id:143881)就是将其架构中融入了这种属性的网络。它不仅学习标量，它还理解矢量、张量，以及它们在宇宙对称性的编舞下如何表现。这种内置的知识充当了一种强大的“归纳偏见”，使网络能够比简单的 不变模型 更高效、更准确地学习底层的物理学，尤其是在预测像力这样的矢量量时 [@problem_id:3789433]。

### 与守恒定律的美妙联系

偏好这种方法还有一个更深层次的物理原因。在经典力学中，[对称性与守恒](@entry_id:154858)定律之间存在着深刻的联系，这一定理最初由伟大的数学家 [Emmy Noether](@entry_id:155198) 阐明。我们可以在我们的模型中看到这一定理的美妙回响。

如果我们设计一个模型来预测一个单一、光滑、不变的标量能量 $E$，我们便可以通过取能量的负梯度来计算每个原子上的力：$\mathbf{F}_i = -\nabla_{\mathbf{r}_i} E$。根据微积分的法则，如果能量 $E$ 是不变的，那么由它导出的力将自动地、完美地是等变的 [@problem_id:2479740]！此外，任何作为[势的梯度](@entry_id:268447)的力场，根据定义，都是一个**[保守力场](@entry_id:164320)**。这意味着当我们在[分子动力学模拟](@entry_id:160737)中使用这些力时，系统的总能量会随时间守恒，从而防止系统自发加热或冷却等不符合物理规律的漂移现象。

与此相反，一个试图直接预测等变力而不先通过能量势的模型则不同。虽然为此构建一个等变架构是可能的，但没有内置的保证来确保最终的力场是保守的。学习过程中的微小误差可能会引入一个非保守分量，导致在模拟中违反能量守恒——这对于模拟物理系统来说是一个致命的失败 [@problem_id:3449458]。通过围绕一个不变的能量来构建我们的模型，我们不仅强制执行了正确的对称性，还将物理学中最基本的守恒定律之一融入其中。

### 机器内部：对称的语言

那么，我们如何构建一个能够用矢量和张量的语言来“思考”的网络呢？秘密在于群表示的数学。我们可以根据任何物体在旋转下的变换方式对其进行分类。这给了我们一个[特征类](@entry_id:160596)型的层次结构，用一个非负整数 $\ell$ 来标记，物理学家会从[量子力学中的角动量](@entry_id:142408)理论中认出它。

-   $\ell=0$：**标量**。这些是不变的数，比如能量或温度。当你旋转它们时，它们完全不改变。
-   $\ell=1$：**矢量**。这些物体，比如力或速度，有方向，并且像三维空间中的箭头一样旋转。
-   $\ell=2$：**张量（四极）**。这些描述了更复杂的方向属性，比如[电子轨道](@entry_id:157718)的形状。
-   ……对于更高的 $\ell$ 也是如此。

这些是我们对称性字母表中的“字母”。一个[等变网络](@entry_id:143881)通过在相邻原子之间传递“消息”来处理信息。但这些不是普通的消息；它们是由这些标量、矢量和张量集合而成的特征向量。网络层被设计成以一种尊重对称性语法的方式来组合这些特征。

如果你想将一个类型为 $\ell_1$ 的特征与一个类型为 $\ell_2$ 的特征结合起来，你不能简单地逐元素相加或相乘。你必须使用一个特殊的操作，称为**张量积**，它由 **Clebsch-Gordan 系数** 控制。这可能听起来很深奥，但这与量子力学中如何将两个角动量源相加的数学是相同的 [@problem_id:3449548]。例如，结合两个矢量（$\ell=1 \otimes \ell=1$）可以产生一个标量（$\ell=0$，与点积相关）、另一个矢量（$\ell=1$，与叉积相关）和一个张量（$\ell=2$）。[网络架构](@entry_id:268981)使用这些固定的、不可学习的系数来保证，如果你结合两个等变特征，结果也同样是完美等变的。

通过传递这些结构化的、有方向性的消息并堆叠多个层，网络可以学习到一个分子丰富的、多体的几何结构。单层网络可能只能学习到成对的相互作用。但是两层网络允许信息从一个原子传递到它的邻居，然后再到第三个原子。这使得模型能够学习**键角**，一种三体相互作用。更多的层允许它学习**二面角**（四体）以及更复杂的关联，所有这些都完美地尊重了物理学的基本对称性 [@problem_id:3777047]。

### 前沿与细微之处

这个框架非常强大，但大自然总是有更多的微妙之处。

其中一个微妙之处是**手性**，或称“利手性”。你的左手和右手互为镜像；它们不能仅通过旋转就重合。许多分子也表现出同样的属性。一个标准的 SE(3) 等变模型，只考虑[正常旋转](@entry_id:141831)，无法区分一个分子和它的镜像。它会为两者预测相同的能量。然而，某些物理性质，比如偏振光的旋转，对手性很敏感，并且对于一个分子和它的镜像对映异构体具有相反的符号。这样的性质被称为**[伪标量](@entry_id:196696)**。为了学习它们，网络不仅要意识到旋转，还要意识到反射。这需要将其对称性扩展到完整的**[正交群](@entry_id:152531) O(3)**，并整合本身是宇称奇性的特征——即在反射下会翻转符号的特征 [@problem_id:3449546]。

另一个主要挑战是尺度问题。[等变网络](@entry_id:143881)，像大多数分子[机器学习模型](@entry_id:262335)一样，通常是**局域的**。它们在一个固定的截断半径内操作。这对于描述形成[化学键](@entry_id:145092)的[短程力](@entry_id:142823)来说没有问题。然而，自然界中一些最重要的力，比如[静电相互作用](@entry_id:166363)，是**长程的**，以 $1/r$ 的形式缓慢衰减。一个纯粹的局域模型永远无法完全捕捉这些效应 [@problem_id:3449555]。

这里的解决方案证明了融合新旧物理学的力量。我们可以创建**混合模型**。[等变网络](@entry_id:143881)负责学习短程范围内的复杂量子力学相互作用。对于长程部分，我们使用经过时间考验的解析方法，如 [Ewald 求和](@entry_id:142359)法或[快速多极子方法](@entry_id:140932)。网络甚至可以学习预测输入到长程求解器中的物理参数，比如每个原子上的[部分电荷](@entry_id:167157)。整个[混合系统](@entry_id:271183)可以进行端到端的训练，创建一个结合了深度学习的[表达能力](@entry_id:149863)和经典物理学的严谨非局域准确性的模型。

通过构建能够说出物理定律的母语——对称性语言的网络，我们正在创造具有前所未有能力和准确性的工具。这些模型不仅仅是拟合数据；它们封装了对宇宙底层编舞的深刻理解，使我们能够以前所未有的保真度来模拟和发现新的材料与分子。

