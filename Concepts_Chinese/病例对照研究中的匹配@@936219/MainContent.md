## 引言
在[观察性研究](@entry_id:174507)中，建立真实的因果关系常常因难以进行公平比较而受阻。这个问题被称为混杂，当第三个因素同时与暴露和结局相关联，从而产生虚假联系时，就会出现混杂。病例对照研究为调查疾病原因提供了一种高效的设计，而匹配是其中一种强有力的技术，旨在从研究一开始就直接解决混杂问题。通过有意地选择在关键特征上与病例相似的对照，研究人员可以创建一个更具可比性的基线。本文将深入探讨匹配的艺术与科学。“原则与机制”一章将以现代因果理论为指导，为选择哪些变量进行匹配以及避免哪些陷阱奠定基本规则。随后，“应用与跨学科联系”一章将展示这些原则如何在现实世界的流行病学调查中应用，从医院感染控制到大规模药物安全性研究。

## 原则与机制

在我们探寻世界的过程中，我们不断地进行比较。这种肥料能让植物长得更高吗？这种药能治愈某种疾病吗？要回答这些问题，我们必须比较使用肥料和不使用肥料的情况。在科学和生活中，巨大的挑战在于确保我们进行的是公平的比较。如果我们将在阳光下施肥的植物与置于阴凉处未施肥的植物进行比较，我们无法了解肥料的任何信息。这就像是在比较苹果和橙子。在流行病学中，这种不公平比较的问题被称为**混杂**，它是我们在探寻真相过程中必须克服的最持久的挑战之一。

病例对照研究是寻找疾病原因的一种特别巧妙的方法。我们找到一群患有该疾病的人（**病例**）和一群没有患病的人（**对照**），然后回顾过去，看某种暴露在病例中是否更常见。但如果我们的病例平均年龄比对照大呢？我们发现的任何暴露差异可能仅仅反映了年龄的差异，而非疾病的真正原因。年龄差异就是一个混杂因素，一个搅浑水的第三方因素。

**匹配**是一种非常直接和具体的方法，旨在从研究的设计阶段就解决这个问题。它是一种比较的艺术。其思想很简单：为你招募的每一个病例，你都有意地寻找一个在关键方面与之相似的对照。如果你有一个65岁的女性病例，你就招募一个65岁的女性对照。你在物理上构建一个[对照组](@entry_id:188599)，使其在这些关键因素上成为病例组的镜像。

这意味着一个匹配的[对照组](@entry_id:188599)并非整个人群的缩影。通过[随机抽样](@entry_id:175193)，我们或许能得到一个能代表总人口的[对照组](@entry_id:188599)，但它对于我们*特定*的病例组而言，可能不是一个好的比较对象。匹配放弃了这种广泛的代表性，以换取一个更有价值的奖品：有针对性的可比性。我们刻意限制谁能成为对照，以确保他们是病例有效的“反事实”对应者[@problem_id:4610256]。这可以做到极其精确，如**个体匹配**，即每个病例与一个或多个特定的对照配对（形成一个匹配集）；也可以更宽泛地通过**频率匹配**来完成，即我们确保，例如，50多岁男性在病例组和[对照组](@entry_id:188599)中的总体百分比是相同的[@problem_id:4610304]。

### 因果罗盘：选择匹配对象

如果说匹配是建立公平比较的工具，那么接下来最关键的问题是：我们应该在哪些变量上进行匹配？选择正确的变量至关重要。选择错误的变量不仅无用，甚至可能是灾难性的，会引导我们得出错误的结论。为了驾驭这片险恶的地形，我们需要一张地图——一张因果地图。在现代流行病学中，这张地图就是**[有向无环图](@entry_id:164045)（DAG）**，它用简单的图形展示了我们对因果关系的假设。有了这张地图，我们就可以推导出一些异常清晰的行动规则。

**规则1：在混杂因素上匹配**

**混杂因素**是暴露和疾病的[共同原因](@entry_id:266381)。在DAG中，它看起来是这样的：$Exposure \leftarrow Confounder \rightarrow Disease$。例如，在一项关于酒精（暴露）与心脏病（疾病）的研究中，社会经济地位可能是一个混杂因素，因为它可能同时影响饮酒习惯和潜在的健康状况。这种结构创造了一条非因果的关联“后门路径”。在混杂因素上进行匹配就像是阻断了这条后门路径，切断了[虚假相关](@entry_id:755254)的来源。这是匹配最经典也是最重要的原因。[@problem_id:4610231]

**规则2：绝不在中介因素上匹配**

**中介因素**是位于暴露与疾病之间因果路径上的变量。其结构为：$Exposure \rightarrow Mediator \rightarrow Disease$。例如，如果我们研究慢性农药暴露（$E$）对[帕金森病](@entry_id:150368)（$D$）的影响，并且我们知道农药会导致[嗅觉](@entry_id:168886)损伤（$M$），而嗅觉损伤是疾病过程的早期阶段（$E \rightarrow M \rightarrow D$），那么在[嗅觉](@entry_id:168886)损伤上进行匹配将是一个灾难性的错误[@problem_id:4638793]。

想象一下，你想知道吸烟对肺癌的总效应。如果你通过只比较肺部焦油含量*完全相同*的吸烟者和非吸烟者来进行“匹配”，你很可能会发现吸烟没有效果。你故意对自己视而不见，忽略了原因产生效果的机制本身——焦油的积累！当我们想知道暴露的*总*效应时，我们必须保持因果路径的完整。在中介因素上匹配会阻断一条因果路径，这必然会导致我们低估暴露的真实效应[@problem_id:4610300]。

**规则3：绝不在对撞因素上匹配**

这条规则揭示了我们欺骗自己的一种最微妙和迷人的方式。**对撞因素**是另外两个变量的共同*效应*。想象一个场景，农药暴露（$E$）和某种未测量的遗传易感性（$U$）都独立地导致人们参加一个特殊的筛查诊所（$M$）。遗传因素$U$也独立地导致[帕金森病](@entry_id:150368)（$D$）。诊所就诊的[因果结构](@entry_id:159914)是 $E \rightarrow M \leftarrow U$。

变量$M$是一个对撞因素。在总人口中，暴露$E$和遗传因素$U$是独立的。但如果你在诊所就诊上进行匹配——也就是说，你只从那些去过诊所的人中选择病例和对照——你就在$E$和$U$之间*在这个选定的人群中*引入了一种奇怪的、虚假的关联。为什么？可以这样想：如果一个人在诊所里，但你知道他*没有*暴露于农药，那么他更有可能是因为有遗传易感性才来这里的。相反，如果他暴露了，他拥有该基因的可能性就较小。在共同效应上进行条件限制，会在其原因之间创造一种虚幻的关系。因为$U$是疾病的一个真正原因，这种虚幻关系会在暴露和疾病之间产生一种虚幻的关联。这被称为**对撞分层偏倚**，是一种自我造成的伤害。在对撞因素上匹配，会创造一条原本不存在的后门路径[@problem_id:4610231] [@problem_id:4610300]。

当然，我们的地图的好坏取决于我们的知识。如果我们为了控制年龄的混杂效应而在年龄上匹配，但存在一个未测量的遗传因素，它既导致疾病又与暴露相关，那么我们在年龄上的匹配将无法解决这个残余混杂的问题[@problem_id:4610265]。

### 精确的代价：过度匹配与效率

那么，在混杂因素上匹配总是个好主意吗？不一定。像任何强大的工具一样，它也有权衡。我们在这里交易的货币是**[统计功效](@entry_id:197129)**——即我们的研究在效应真实存在时检测到它的能力。

在一个匹配的病例对照研究中，关于暴露效应的信息完全来自于**[不一致对](@entry_id:166371)**。这些是指病例暴露而其对照未暴露，或反之亦然的配对。如果一个配对中病例和对照都暴露了，或者都未暴露，那么这个配对对于暴露所造成的*差异*，什么也告诉不了我们。它们是完美平衡的，因此是完全无信息的。

这就把我们引向了**过度匹配**这个危险的问题。

首先，考虑在一个与*暴露*强相关但不是疾病原因（因此不是混杂因素）的变量上进行匹配[@problem-id:4610239]。假设我们正在研究一种只发生在一个社区的罕见暴露。如果我们按社区对病例和对照进行匹配，我们就会确保对于每个来自A社区的病例（暴露者），我们都会找到一个来自A社区的对照（也是暴露者）。对于每个来自B社区的病例（非暴露者），我们也会得到一个来自B社区的对照（也是非暴露者）。我们的研究中充满了这种一致的、无信息的配对。我们花费了高昂的时间和金钱，使我们的组别变得如此完美相似，以至于我们抹去了我们本想研究的暴露差异。我们的统计功效急剧下降。在一个假设场景中，对这样一个变量进行匹配，可能将有用配对的比例从$0.5$降低到$0.32$，这意味着你需要大约$1.56$倍的受试者才能重新获得相同量的信息[@problem_id:4633048]。这就是破坏**效率**的过度匹配。

但这里有一个美妙的反直觉。如果我们匹配一个与*疾病*强相关但与暴露完全无关的变量呢？例如，按出生队列进行匹配，这会影响基线疾病风险。这似乎毫无意义，因为它不是混杂因素。然而，这可能是一个绝妙的举动。通过强制你的病例组和[对照组](@entry_id:188599)在这个强大的疾病原因上保持平衡，你正在消除一个主要的“噪音”或随机变异来源。这就像试图在嘈杂的工厂里听到耳语。在主要的噪音源上进行匹配，就像关闭了最响的机器。暴露效应的微弱耳语就变得更容易听到了。这种类型的匹配实际上可以*增加*[统计效率](@entry_id:164796)和功效[@problem-id:4633048] [@problem_id:4610239]。

### 解锁数据：分析须随设计

最后一个关键原则：匹配不是一个“一劳永逸”的武器。你不能简单地在设计阶段进行匹配，然后就像处理两个独立的随机样本一样分析数据。这样做是这类研究中最常见也是最危险的错误之一。

当你进行匹配时，你是在做出一个承诺。你故意以一种有偏倚的方式构建你的[对照组](@entry_id:188599)，使其与你的病例组具有可比性。你必须在分析中兑现这个承诺。如果你进行了个体$1:1$匹配，创造了一个个由一个病例和一个[对照组](@entry_id:188599)成的微观世界，你的分析就必须尊重这种结构。正确的方法通常是**条件逻辑回归**，它本质上是逐对分析数据，提出问题：“在这个匹配对中，是什么解释了为什么是病例而不是对照得了病？”比较是在匹配集*内部*进行的[@problem_id:4610304]。

如果你使用了频率匹配，你仍然必须通过将匹配变量包含在一个标准的（非条件）逻辑[回归模型](@entry_id:163386)中来对它们进行调整。对于任何你通过匹配控制的混杂因素，它也必须在分析中得到控制[@problem_id:4924672]。

这个原则是不可侵犯的：**分析必须遵循设计**。匹配是一个强大的策略，但它重塑了你的数据。要正确解释它，你必须使用理解你所创造的新形状的分析工具。否则，你将冒着找到一个有偏倚答案的风险，这个答案通常比真相更接近于“无效应”。

