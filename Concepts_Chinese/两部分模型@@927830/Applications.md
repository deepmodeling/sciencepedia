## 应用与跨学科联系

在理解了两部分模型的机制之后，我们现在可以踏上一段旅程，去看看它们存在于何处，以及它们的作用。你可能会倾向于认为它们是一种小众的统计工具，是为解决数据分析师“零值过多”头痛问题的巧妙修复。但这就像说望远镜只是为了解决“东西太远”的问题一样。实际上，望远镜是一种看待宇宙的新方式。两部分模型也是如此。它是一个镜头，揭示了无数过程中固有的两幕结构，从自然界中生命与死亡的宏大戏剧，到人类选择的微妙经济学，再到人工智能的复杂逻辑。

### 两幕剧中的自然世界

让我们从田野里开始，观察一种简单的多年生植物。从进化的角度来看，它的最终目标是传递其基因。我们可以通过其终身[繁殖成功率](@entry_id:166712)（Lifetime Reproductive Success），即 $W$，来衡量这一点。是什么决定了这种成功？植物面临两个基本的、相继的挑战。首先，它必须在严冬、干旱和疾病中存活下来。这是一个[二元结果](@entry_id:173636)：存活（$S=1$）或死亡（$S=0$）。其次，*如果*它存活下来，它必须产生种子。这是它的[繁殖力](@entry_id:181291)（fecundity），$F$，一个可以是零、一或许多的计数。植物的总成功是这两幕的产物：$W = S \times F$。如果它在第一幕中失败了（$S=0$），无论它在第二幕中有多大潜力，它的成功都为零。
一个幼稚的[统计模型](@entry_id:755400)可能会试图用植物的性状——比如它的高度或叶子大小——一步预测 $W$。但这个模型会对底层的生物学视而不见。它会把帮助植物度过冬天的性状和帮助它将能量分配给种子生产的性状混为一谈。而两部分模型，以其自身的结构，尊重了这一生物学现实 ([@problem_id:2519788])。它构建了一个两幕模型。第一部分使用[逻辑斯谛回归](@entry_id:136386)来提问：哪些性状预测了存活概率 $p(\mathbf{z})$？第二部分，只看存活者，使用一个计数模型来提问：在存活下来的植物中，哪些性状预测了它们产生的种子数量 $\mu(\mathbf{z})$？总的预期成功率就变得非常简单：进入第二幕的概率，乘以在第二幕中的预期表现，$E[W|\mathbf{z}] = p(\mathbf{z}) \mu(\mathbf{z})$。这不仅是一个拟合得更好的模型，更是一个更真实的模型，反映了生命本身的序列逻辑。
同样的逻辑也适用于我们。考虑一下健康经济学领域。为什么有些人频繁看医生，而另一些人根本不去？我们再次看到了一个两幕剧 ([@problem_id:4575899])。第一幕是首先决定寻求医疗服务。你有交通工具去诊所吗？费用能负担得起吗？你有保险吗？这些因素决定了你是否能克服进入医疗系统的最初“障碍”。第二幕涉及医疗服务的强度。一旦你成为病人，你需要多少次就诊？这可能更多地取决于你潜在的健康状况。两部分模型允许公共卫生官员理清这些效应。他们可以看到哪些健康的社会决定因素是*获取服务*（第一部分）的障碍，而哪些因素驱动了那些已经获得服务的人的*使用率*（第二部分）。这种区分对于设计有效和公平的卫生政策至关重要。
该框架不仅限于计算就诊次数。想象一下尝试对年度医疗费用进行建模 ([@problem_id:5054556])。在某一年里，大部分人口可能没有任何费用。而对于那些有费用的人来说，金额是一个连续的、非负的数字，并且通常高度有偏——少数有严重疾病的个体可能会有极高的费用。试图用单一的[线性回归](@entry_id:142318)来对此建模是徒劳的；模型在零值堆和正成本[长尾](@entry_id:274276)之间被撕裂。两部分模型优雅地解决了这种紧张关系。第一部分：一个[逻辑斯谛模型](@entry_id:268065)，用于处理产生*任何*费用与*无*费用的二元问题。第二部分：对于那些有正费用的人，我们使用一个更合适的工具，比如 Gamma [广义线性模型](@entry_id:171019)。Gamma 分布天然适合像成本这样右偏的正值数据，而对数连接 $g(\mu) = \log(\mu)$ 确保我们对成本的预测总是正的。结果是一个合理、稳健的模型，它尊重了数据的双重性质。

### 两部分逻辑在数字与因果世界中的应用

到目前为止，我们已经看到两部分模型是处理自然分两阶段产生的结果的一种方式。但“两部分”这个想法更为根本。它是一种思考链式依赖关系、将复杂[问题分解](@entry_id:272624)为更易处理部分的方式。这种逻辑远远超出了零膨胀数据的范畴。
考虑一下自动驾驶汽车中人工智能系统的任务。为了让汽车对行人做出反应，其[视觉系统](@entry_id:151281)必须首先*检测*到有一个感兴趣的物体，并将其与背景噪音区分开来（如果检测到则 $Z=1$，否则 $Z=0$）。其次，它必须将该物体*分类*为行人（如果是行人则 $C=1"，否则 $C=0$）。一个正确的、可操作的识别需要这两个步骤都成功；最终结果又是一个乘积，$Y = Z \cdot C$。这在结构上与植物的生存和繁殖完全相同。通过将此分析为一个两阶段过程，工程师可以分解系统的不确定性 ([@problem_id:3197126])。我们的总不确定性中，有多少来自检测器失败，又有多少来自分类器失败？这种分解对于构建更安全、更可靠的人工智能系统至关重要。它告诉我们应该在哪里集中精力以提高性能。
这种思维的灵活性使我们能够以令人惊讶的方式应用它。在现代药物微生物组学中，科学家研究我们肠道中数以万亿计的微生物如何影响我们对药物的反应。为了测试一种特定细菌是否影响血液中的药物浓度，他们面临一个熟悉的问题：该细菌可能存在于某些人的肠道中，但在另一些人中则完全不存在。两部分逻辑可以应用于*预测变量*本身 ([@problem_id:4368051])。我们可以问两个独立的问题：1）该细菌的纯粹*存在与否*是否有影响？2）在拥有该细菌的人群中，其相对*丰度*是否有影响？这比简单地将一个丰度值（包含许多零）代入单一模型，能获得更丰富的科学理解。
也许这种“两阶段”思维最深刻的延伸是在因果推断领域。在观察性研究中，我们不断受到混淆的困扰——这是“相关不等于因果”的经典问题。想象一下，我们想知道一个新社区健康项目 ($\bar{A}_c$) 的真实因果效应，但采纳该项目的社区与未采纳的社区存在系统性差异 ([@problem_id:4639104])。简单的比较是有偏的。为了解决这个问题，计量经济学家和流行病学家开发了一类强大的“两阶段”方法，例如[工具变量分析](@entry_id:166043)和[控制函数](@entry_id:183140)法 ([@problem_id:4819458])。
在第一阶段，他们使用一个“工具变量”——一个影响项目采纳但对健康结果没有其他影响的变量——来分离出项目实施中“干净”或“外生”的变异来源。在第二阶段，他们仅使用这种干净的变异来估计项目对健康结果的影响。虽然其数学原理与我们的[零膨胀模型](@entry_id:756817)不同，但精神是相同的。这是将一个难题（从混乱数据中估计因果效应）分解为两个阶段：首先，分离出一个干净的信号；其次，使用该信号找到答案。这展示了统计推理中一种美妙的统一性：无论我们是在为[植物繁殖](@entry_id:273199)、医疗成本还是公共政策的效果建模，将一个过程分解为其基本序列部分是我们拥有的最强大工具之一。

### 一个提供更深刻视角的镜头

我们的探索从一个简单的数据特征——过多的零值——带我们走向了科学和工程领域的一个深刻的组织原则。两部分模型不仅仅是一个统计技巧。它是一个镜头，鼓励我们去寻找周围世界中的潜在结构。它要求我们思考事件的顺序、必须跨越的障碍，以及连接一个结果与下一个结果的依赖关系。通过这样做，它不仅提供了更准确的预测，而且为我们试图解释的现象提供了更深刻、更令人满意的理解。