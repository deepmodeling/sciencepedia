## 引言
几十年来，基因组学通过测序基因组为生命提供了一份卓越的“零件清单”。然而，知道存在哪些零件与理解它们如何组装成一个功能性有机体是两码事。传统方法能告诉我们组织中*哪些*基因是活跃的，但无法告诉我们它们*在哪里*活跃，这在我们的知识中留下了一个关键的空白。一份简单的基因清单并非蓝图。分子图谱通过创建一张高分辨率地图来应对这一根本性挑战，该地图能逐个细胞地精确定位基因活动，从而提供了理解生物学功能至关重要的空间背景。

本文将探索分子图谱的世界。首先，我们将深入探讨“原理与机制”，审视那些为每个分子分配“邮政编码”的巧妙技术，以及不同绘图策略之间的基本权衡。随后，“应用与跨学科关联”部分将展示这些详细的蓝图如何被用于绘制发育图谱、理解疾病，并在遗传学、神经科学和进化生物学等领域之间建立强大的联系，从而改变我们解读生命语言的能力。

## 原理与机制

想象一下，你有一份制造汽车所需全部零件的完整清单——发动机缸体、活塞、火花塞、车轮。这份清单就像基因组，是生物体拥有的所有基因的库存。现在，再想象一下，你还统计了某一天某个特定工厂使用的每一个零件的数量。这就像传统的[RNA测序](@article_id:357091)实验；它告诉你*哪些*基因是活跃的以及*活跃程度*，但完全没有告诉你它们*在哪里*。火花塞是正在安装到发动机里，还是存放在仓库里？用于座椅的皮革是在内饰车间，还是被错误地送到了喷漆房？要了解工厂*实际上*如何运作，你需要的不仅仅是一份简单的库存清单，你需要一张蓝图。你需要知道所有零件的空间组织。

分[子图](@article_id:337037)谱正是生物组织的这样一张蓝图。它是一张地图，能逐个细胞地告诉我们，在整个器官的景观中，哪些基因被开启。但是，你究竟是如何创建这样一张地图的呢？你如何给像信使RNA（mRNA）这样转瞬即逝且微小无比的分子贴上“邮政编码”？这是现代生物学中最巧妙的挑战之一，其解决方案是化学、工程学、物理学和计算机科学的完美融合。

### 探寻分子邮政编码

大多数空间转录组学方法背后的核心技巧是**[空间条形码](@article_id:331698)**。把它想象成一个独特的地址标签。如果我们能根据每个mRNA分子的来源位置，为其附上一个独特的地址标签，那么我们就可以收集所有这些分子，读取它们自身的序列（以了解它是哪个基因）和附带的地址标签（以了解它来自哪里），然后通过计算重建出这张地图。该技术的核心在于如何分配这些地址标签。事实证明，有两种宏大的策略可以实现这一点。

### 两大策略：捕获法与原位法

第一种策略可称为**“捕获并标记”**。想象一下，将一张分子捕蝇纸铺在你的组织切片上。这张“捕蝇纸”实际上是一块玻璃载玻片或一层微珠床，上面覆盖着数百万个特殊的“捕获探针”。当你轻轻溶解[细胞膜](@article_id:305910)时，mRNA分子会漂出并粘附在它们正下方的探针上。巧妙之处在于，每个探针都已包含一个预制好的[空间条形码](@article_id:331698)。因此，当一个mRNA分子被捕获时，它就与一个编码特定 $(x, y)$ 坐标的条形码物理连接起来。然后，组织被洗去，载玻片上只剩下带有条形码的[转录](@article_id:361745)本。这些[转录](@article_id:361745)本被转化为更稳定的互补DNA（cDNA），然后被收集并由[DNA测序](@article_id:300751)仪读取。测序仪读出一长串配对：[基因身份，[空间条形码](@article_id:331698)]。

在这个基于捕获的家族中，有两种精巧的工程解决方案来制造带条形码的表面 [@problem_id:2673499]：

1.  **有序网格：** 像10x Genomics的Visium这样的技术使用预制的点阵，非常像城市网格。每个点的位置以及该点上独特的条形码序列都是*先验*已知的——它们是制造设计的一部分。你只需将你的组织图像与这个已知网格对齐，就能将生物结构与你的数据联系起来。

2.  **随机[散布](@article_id:327616)：** 其他技术，如[Slide-seq](@article_id:327700)，则采用不同的方法。它们制造数百万个微珠，每个微珠都携带自己独特的条形码。然后将这些微珠随机撒在载玻片上，形成一层致密、连续的毯子。在这种情况下，条形码到位置的映射是*事先*未知的。解决方案是在主实验*之前*执行一个“解码”步骤：科学家使用显微镜和巧妙的多步[化学反应](@article_id:307389)，读取载玻片上每一个微珠的条形码，并记录其 $(x, y)$ 位置。这就构建了条形码到坐标的映射 $f: b \mapsto (x, y)$，之后便可用它将测[序数](@article_id:312988)据放回空间中 [@problem_id:2673499]。

第二大策略则截然不同。我们可以称之为**“原位标记”**，即 **in situ**（源自拉丁语，意为“在原始位置”）。这种方法不是让分子漂移到捕获表面，而是将它们化学固定，锁在细胞内的天然位置。然后，科学家派入分子侦探——荧光标记的探针——去寻找并结合特定的mRNA序列。接着，一台高倍显微镜就像一颗卫星，拍摄组织的照片，精确定位每个[发光探针](@article_id:308672)的确切位置。

为了同时识别许多不同的基因，像[MERFISH](@article_id:370191)或10x的Xenium平台这样的方法，采用了一种组合条形码的形式。在第一轮成像中，它们可能用红光标记基因A和B，用绿光标记基因C和D。然后，它们洗掉这些探针，在第二轮中，用蓝光标记基因A和C，用黄光标记基因B和D。一个在第一轮是红色而在第二轮是蓝色的分子，必然是基因A。通过使用多轮成像和不同的颜色组合，科学家可以唯一地识别成百上千种不同的基因，每种基因都以显微镜的精度进行定位 [@problem_id:2852376]。

在这种基于成像的世界里，空间坐标不是来自载玻片上的合成条形码，而是直接从[显微镜视场](@article_id:342494)中荧光点的像素位置测量得出的。

### 巨大的权衡：基因组学里没有免费的午餐

那么，哪种策略更好呢？正如物理学家[Richard Feynman](@article_id:316284)肯定会欣赏的那样，天下没有免费的午餐。每种方法都受到基本物理极限的制约，在分辨率、通量和灵敏度之间形成了经典的工程权衡 [@problem_id:2673469]。

**基于捕获的方法**（如Visium和[Slide-seq](@article_id:327700)）是马拉松选手。它们通常是**全[转录组](@article_id:337720)**的，意味着它们有可能捕获*任何*活跃的基因，为你提供一个无偏的全景视图。它们还能相对快速地覆盖大面积的组织。然而，它们的致命弱点是**分辨率**。空间精度受到两个主要因素的限制：捕获点的大小（例如，Visium约为$55$微米，覆盖多个细胞）以及更根本的**[分子扩散](@article_id:315007)**。mRNA分子并不仅仅是垂直下落；在细胞被打开后的短暂瞬间，它们会四处摆动。这种通常在几微米量级的扩散会使信号变得模糊，因为一个[转录](@article_id:361745)本可能被距离其起始位置一两个点之外的地方捕获 [@problem_id:2852376]。这使其更像是卫星图像：非常适合看整个国家，但当你试图寻找一辆特定的汽车时就会模糊不清。此外，捕获过程是概率性的；并非每个释放的mRNA分子都会被捕获。你[期望](@article_id:311378)在单个捕获点中找到的不同[转录](@article_id:361745)本的数量取决于多种因素，如捕获点的面积、局部细胞密度、每个细胞的mRNA分子数量以及整体的**捕获效率**（$\eta_{capture}$） [@problem_id:2304534]。

**基于成像的方法**（如[MERFISH](@article_id:370191)和Xenium）是肖像画大师。它们提供令人惊叹的**亚细胞分辨率**。由于分子被固定在原位，扩散不是问题。分辨率的限制转而来自光学的基本定律——特别是**[光的衍射](@article_id:357167)极限**，它决定了两个发光点之间可分辨的最小距离（通常约为$200-300$纳米）。这不仅让你能看到一个基因在哪个细胞里，还能看到它在细胞的*哪个位置*。权衡是什么？**通量**。这些方法是*靶向性*的，意味着你必须事先决定要寻找哪些基因，并为它们设计特定的探针。你无法用这种方法发现一个全新的基因。更重要的是，它们速度慢。要获取覆盖大块组织所需的多轮高倍率图像可能需要数天时间。这就像拍摄一百万张高分辨率照片来拼凑一幅全景图，而不是只拍一张广角照片。

### 从平面地图到三维世界

这些令人惊叹的技术通常从单个薄组织切片生成2D地图。但器官是3D的。为了构建一个真正的图谱，科学家们执行一个简单而强大的程序：他们取一个器官，比如说一个胚胎大脑，将它切成数百个连续的、纸一样薄的切片。然后，他们对系列中的每个切片进行[空间转录组学分析](@article_id:352848)。通过在计算上将这些2D地图重新堆叠并对齐，他们可以重建整个器官的三维基因表达结构，这很像CT扫描仪通过一系列2D [X射线](@article_id:366799)图像构建身体的3D模型 [@problem_id:1715315]。

### 作为参考的图谱：生物学的GPS

一旦建成，分[子图](@article_id:337037)谱不仅仅是一张漂亮的图片。它成为一个标准参考，一个“生物学的谷歌地图”，可以用来导航和解释新的实验。一些最激动人心、计算上最深刻的原理正是在这里发挥作用。

想象一下，你有一个来自新实验的低分辨率空间图，也许是关于患病组织的。你图上的每个点都是许多细胞的混合物。你如何能弄清楚每个点中存在哪些细胞类型？你可以使用高分辨率图谱作为字典。被称为**[反卷积](@article_id:301675)**的计算方法可以处理你点中的混合信号，并通过与参考图谱中纯净的单细胞“特征”进行比较，来估计存在的每种细胞类型的比例 [@problem_id:2889953]。为了稳健地做到这一点，这些[算法](@article_id:331821)必须足够聪明，能够校正“批次效应”——即不同实验之间不可避免的技术差异——同时小心地保留真实的生物学信号 [@problem_id:2753070]。例如，一个复杂的模型可能会使用一种像条件[变分自编码器](@article_id:356911)（cVAE）这样的技术，来学习一个明确地对样本来源不敏感，但仍能预测所有样本共享的生物学结构的基因表达表示 [@problem_id:2753070]。

图谱还可以作为其他类型数据的[坐标系](@article_id:316753)。假设你使用一种名为组织透明化的技术，使整个小鼠大脑变得透明，从而可以对表达特定[荧光蛋白](@article_id:381491)的每一个[神经元](@article_id:324093)的位置进行成像。你现在有了一个细胞的3D点云。要知道这些细胞是*什么类型*，你必须将这个新的大脑图像与参考图谱对齐。这是通过一个称为**微分同胚配准**的过程完成的，这是一种强大的数学技术，可以找到一个平滑、连续的“扭曲”场 ($\boldsymbol{\phi}$)，以最佳方式拉伸和挤压你的样本图像，使其与图谱的解剖结构相匹配 [@problem_id:2768642]。

真正美妙的是，这个过程还能告诉我们映射的确定性有多高。配准从来都不是完美的。扭曲的不确定性，由协方差矩阵 $\boldsymbol{\Sigma}(\mathbf{x})$ 表示，意味着你样本中位置 $\mathbf{x}$ 处的一个细胞可能映射到图谱中一个小的可能位置云。如果这个不确定性云完全落在一个定义明确的大脑区域内，你的细胞类型分配就是可信的。但如果这个云跨越了两个区域的边界，该方法可以通过计算所得细胞类型概率的熵，来精确地告诉你这个分配的模糊程度。这种严谨地传播和[量化不确定性](@article_id:335761)的能力，是成熟科学仪器的标志，它将我们的分子地图从静态图片转变为用于发现的动态、概率性指南 [@problem_id:2768642]。