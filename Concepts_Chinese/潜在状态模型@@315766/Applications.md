## 应用与跨学科联系

我们花了一些时间来熟悉潜在状态模型的机制，玩弄概率和推断的齿轮与杠杆。这是一个优美的理论构造。但一台机器的好坏取决于它能完成的工作。现在是时候把这个新引擎带出工作室，看看它在现实世界中能做些什么了。它将向我们展示一个何其广阔的世界！我们会发现，这一个理念——在观察到的事实背后寻找隐藏的故事——是一把万能钥匙，能解开整个科学界的秘密，从我们细胞内的微观编排，到进化历史的宏大画卷，甚至触及物理现实的边缘。

### 解码生命之书

让我们从生命的蓝图开始：基因组。它是一串极其长的字母序列，对我们人类来说有数十亿个。但它不是一串可以从头读到尾的简单字符串。细胞不像读小说那样阅读它；它像阅读一个巨大的卷轴图书馆，其中一些卷轴是打开的，随时可以阅读，而另一些则被紧紧地包装在化学盒子里并封存起来。这些不同的包装状态被称为“[染色质状态](@article_id:369136)”——例如，开放、活跃的区域称为“常染色质”，而致密、沉默的区域称为“异染色质”。

现在，你不能仅仅看着一段DNA就能看出它是开放还是关闭的。但你可以看到它的指纹。[分子生物学](@article_id:300774)家已经发展出巧妙的技术来寻找与这些不同状态相关的标志性化学标记：这里的某个[组蛋白修饰](@article_id:323623)，那里的少许DNA甲基化，那边的一个可及性迹象。我们最终得到一个庞大的数据集：对于基因组的每一个小片段，我们都有一份观察到的化学标记列表。我们如何将此转化为一张简单而有意义的开放和关闭区域地图？

这是隐马尔可夫模型（HMM）的完美工作。我们可以把我们的HMM想象成一个侦探，沿着[染色体](@article_id:340234)一步一步地走，一次一个片段。在每一步，侦探都不能直接看到隐藏的状态（这个区域是“常染色质”还是“异染色质”？），但他们可以看到线索——观察到的[表观基因组](@article_id:335702)标记。基于这些线索的模式，模型对其隐藏状态做出最佳猜测。通过学习隐藏状态与它们倾向于产生的标记模式之间的统计联系，HMM可以自动将整个基因组分割成一张连贯的功能区域图 [@problem_id:2808614]。曾经令人困惑的数据洪流变成了一张简单、优美且功能强大的[基因组注释](@article_id:327590)图，揭示了[细胞组织](@article_id:308080)其自身说明书的隐藏逻辑。

这种逻辑并非一成不变。一个单一的受精卵发育成大脑、肝脏、肌肉——一个完整的人。这个发育过程是最伟大的奇迹之一。利用单细胞技术，我们现在可以对一个发育中的胚胎进行快照，并获得数千个单个细胞的基因表达谱。这就像走进一个拥挤的舞厅拍照；你看到各个年龄段的人，但他们都混杂在一起。我们如何将他们分类，以重建从孩童到成人的过程？

在这里，[潜变量模型](@article_id:353890)再次伸出援手。我们可以假设，当一个[细胞分化](@article_id:337339)时——比如从一个神经祖细胞到一个成熟的[神经元](@article_id:324093)——它的基因表达会沿着一条发育路径平滑地变化。我们快照中的细胞都处于这个隐藏时间线上的不同点。[潜变量模型](@article_id:353890)可以处理这团杂乱的细胞云，通过在高维基因表达空间中找到连接它们的最平滑路径，从而推断出一个隐藏的一维坐标：“[伪时间](@article_id:326072)”。选择一个起始细胞，一个已知的祖细胞，来确定这个轴的方向，突然之间，这副被打乱的细胞牌组就[排列](@article_id:296886)成了一部连续的发育电影 [@problem_id:2654689]。我们揭示了一个从未被直接测量的时间顺序，一个一直存在、编织在[数据结构](@article_id:325845)中的隐藏维度。

### 重建历史，从物种到生态系统

看过了这些模型如何揭示单个基因组的隐藏逻辑和单个生物体发育的隐藏时间线，让我们把视野拉远。它们能告诉我们关于我们整个物种历史的一些事情吗？

你的基因组不是一个故事，而是两个。你有一套来自母亲的[染色体](@article_id:340234)和一套来自父亲的。如果我们比较这两套[染色体](@article_id:340234)，我们会发现它们几乎完全相同，但点缀着微小的差异。通过观察一个给定区域中这些差异的密度，我们可以估计这两段DNA共享一个共同祖先以来已经过去了多长时间。这个时间，被称为“[最近共同祖先时间](@article_id:377198)”（[TMRCA](@article_id:353958)），由于世代间的重组洗牌，在整个基因组中并非处处相同。

所以我们有了一个想法：让我们建立一个“行走”在[染色体](@article_id:340234)上的隐马尔可夫模型。每一步的*观察值*是两条[染色体](@article_id:340234)之间差异的局部密度。*[隐藏状态](@article_id:638657)*是该基因组片段的[TMRCA](@article_id:353958)。通[过拟合](@article_id:299541)这样一个模型，我们可以推断出沿基因组的隐藏[TMRCA](@article_id:353958)值序列。这个序列是一份化石记录！它包含了我们祖先所生活的人口规模的信息。一个小种群意味着祖先在更近的时期被找到，而一个大种群则将共同祖先推向更久远的过去。通过分析这些推断出的[隐藏状态](@article_id:638657)的分布，我们可以重建一个延伸数万年的人类种群规模的详细历史，仅凭一个现代个体的DNA就揭示了古代的瓶颈和扩张。这是一台用统计学和遗传学建造的时间机器 [@problem_id:2755675]。

这种重建隐藏历史的能力延伸到整个[生命之树](@article_id:300140)。进化中的一个经典难题是趋同进化：为什么[亲缘关系](@article_id:351626)遥远的物种有时会进化出非常相似的性状？鸟类和蝙蝠都进化出了翅膀，但并非来自一个有翅膀的[共同祖先](@article_id:355305)。这是同功性，而非同源性。我们常常怀疑这种趋同是由对相似的、未被观察到的生态压力的适应所驱动的。

我们可以用潜在状态模型来检验这个想法。我们可以在一个[系统发育树](@article_id:300949)上模拟一个性状（例如，有翅膀或无翅膀）的进化。但我们可以增加一个转折：我们可以提出存在一个*隐藏的生态状态*（比如说，“[生态位](@article_id:296846)A”和“[生态位](@article_id:296846)B”），它也沿着树的枝干进化。然后我们允许获得或失去可观察性状的速率依赖于隐藏的生态状态。如果一个带有这个隐藏层的模型比一个更简单的模型能更好地拟合数据，并且我们发现性状的获得绝大多数与进入比如隐藏的“[生态位](@article_id:296846)A”的谱系相关联，我们就为同功进化找到了强有力的证据。我们发现了隐藏的[选择压力](@article_id:354494)以可预测的方式在生命之树上驱动进化的印记 [@problem_id:2706041] [@problem_id:2778868]。

从进化的时间尺度，我们可以放大到森林生命中一年的时间尺度。整个森林都在“呼吸”。它通过光合作用吸入二氧化碳（总[初级生产力](@article_id:311694)，或GPP），并通过呼吸作用（$R$）呼出二氧化碳。我们可以用伸出树冠的塔轻松测量的是这种呼吸的净结果，即净生态系统交换（NEE）。但这个单一的数字隐藏了构成它的两个巨大的、相反的通量。我们如何将吸入与呼出分离开来？一个状态空间模型可以做到。通过模拟光合作用如何响应光照以及呼吸作用如何响应温度，我们可以将GPP和R视为两个独立的、连续的潜在“状态”，它们随时间演变。模型然后使用单一的观测NEE时间序列来推断这两个隐藏组分通量的动态，从而让我们对森林的新陈代谢及其在[全球碳循环](@article_id:359578)中的作用有更深的理解 [@problem_id:2508913]。

### 探究健康与疾病的内在世界

让我们再次潜入细胞的世界，但这次带着医学的视角。我们的免疫系统有记忆，这就是为什么[疫苗](@article_id:306070)会起作用。这种记忆众所周知地储存在[抗体](@article_id:307222)和专门的记忆细胞中。但近年来，我们发现了一种更古老、更微妙的记忆形式，称为“[训练免疫](@article_id:300211)”，在这种形式中，像[巨噬细胞](@article_id:360568)这样的细胞可以被一种刺激“重新编程”，以便在稍后对第二种不同的刺激做出更强的反应。这种记忆被认为储存在细胞的[表观遗传](@article_id:304236)状态——即[染色质](@article_id:336327)包装——中。

我们如何为这种隐藏的记忆建立一个定量模型？我们可以提出一个状态空间模型，其中细胞的内部“记忆”是一个[潜变量](@article_id:304202)$z_t$。一个初始刺激（如$\beta$-葡聚糖）改变了这个状态，然后这个状态会随时间持续存在。当第二个刺激（如LPS）到来时，可观察到的反应——细胞分泌的[细胞因子](@article_id:382655)蛋白的数量——的大小取决于隐藏记忆状态$z_t$的值。通过测量随时间变化的[细胞因子](@article_id:382655)输出，像[卡尔曼滤波器](@article_id:305664)这样的[状态空间模型](@article_id:298442)可以反向工作，推断出[隐藏状态](@article_id:638657)的轨迹，为我们提供一个关于[细胞记忆](@article_id:301328)如何获得和表达的动态、定量的图景 [@problem_id:2901136]。

这种推断免疫系统[隐藏状态](@article_id:638657)的想法对[个性化医疗](@article_id:313081)具有深远的影响。[癌症治疗](@article_id:299485)的一个重大突破是“[免疫检查点阻断](@article_id:313352)”，这种疗法“释放了”[T细胞](@article_id:360929)的“刹车”，让它们能够攻击肿瘤。但它只对一部分患者有效。为什么？主流理论是，它在那些肿瘤已经是“热”或“发炎”的患者中效果最好——也就是说，这些患者已经存在一个被抑制的[T细胞反应](@article_id:360630)。

这种“[免疫激活](@article_id:382093)”是一种生物学状态，一个[潜变量](@article_id:304202)。我们不能用一个单一的数字直接测量它。但我们可以通过许多不同的窗口看到它的效果。“热”肿瘤在整体组织中会有某种基因表达特征（$x_i$），并且它的[T细胞](@article_id:360929)群体将由少数几个扩增的克隆主导，导致高的TCR克隆性（$y_i$）。这两个测量值$x_i$和$y_i$是对同一潜在生物过程的嘈杂且不完美的读数。[潜变量模型](@article_id:353890)优美地形式化了这种“共同原因”结构。它假定一个单一的潜在“[免疫激活](@article_id:382093)分数”$z_i$是基因表达模式和TCR克隆性的共同原因。通过整合这些多种数据类型，模型可以推断出一个比单独从任何一种测量中获得的更稳健、更准确的隐藏激活状态估计。事实证明，这个潜在分数能更好地预测哪些患者会对治疗产生反应 [@problem_id:2855798]。

数据整合的挑战是现代生物学中最大的挑战之一。我们现在可以从单个患者身上生成海量数据集：转录组学、蛋白质组学、[代谢组学](@article_id:308794)等等。问题不在于缺乏数据，而在于缺乏综合。而且数据是杂乱的，具有不同的噪声特性，并且至关重要的是，有很多缺失值。潜在[因子模型](@article_id:302320)提供了一个强大且有原则的解决方案。像[多组学](@article_id:308789)[因子分析](@article_id:344743)这样的模型可以同时观察所有这些不同的数据类型。它被设计用来处理块状缺失（即一个患者有数据类型A和B，而另一个有B和C）以及每种数据类型的不同统计特性。它学习一小组潜在的因子——你可以把它们想象成系统中活跃的基本“生物学程序”。这些因子捕捉了贯穿所有不同数据类型的共享变异模式。这就像听交响乐，能够分离出弦乐携带的旋律、木管乐器中的和声以及打击乐的节奏。这些推断出的因子为患者的生物学状态提供了一个低维、可解释的总结，可用于预测他们对[疫苗](@article_id:306070)或药物的反应 [@problem_id:2892921]。这是寻找隐藏故事的终极行为，一个用多种语言同时讲述的故事。

### 隐藏现实的局限性

到目前为止，我们已经看到潜在状态模型作为理解复杂系统的一个极其强大的工具。它们让我们能够推断基因组、细胞、生态系统和疾病的[隐藏状态](@article_id:638657)。它们似乎代表了关于科学探究的一个深刻真理：我们的观察往往是一个更丰富、更深层次现实的不完整体现。这自然引出了一个深刻的问题：这个原则能一直适用到底层吗？那个充满概率和“鬼魅般的超距作用”的奇异量子力学世界，是否仅仅是对一个更深层次、隐藏的现实的统计描述？

这是 Einstein 和其他一些人的希望，他们对量子理论的奇异性质感到不安。他们推测，粒子可能携带隐藏信息——“[隐变量](@article_id:310565)”——这些信息预先决定了测量的结果。在这种观点下，量子概率仅仅反映了我们对这些[隐变量](@article_id:310565)的无知，就像抛硬币看起来是随机的，仅仅因为我们不知道精确的初始条件一样。

这不仅仅是一个哲学辩论。这是一个可检验的科学假说。我们可以构建这些[隐变量理论](@article_id:368501)的明确数学版本，看看它们是否能重现量子力学的预测。其中一类模型，受到 A. J. Leggett 工作的启发，提出粒子具有由隐藏向量描述的确定属性。当我们测量两个[纠缠粒子](@article_id:314103)之间的相关性时，我们得到的结果是这些隐藏向量分布的平均值。

现在是精彩的部分。这一整类听起来合理的模型，尽管相当复杂，却做出了一个具体、可证伪的预测。它预测了在粒子之间能够观察到的相关性强度有一个严格的上限。对于一组特定的测量，该理论预测$|T_{xx}| + |T_{yy}| + |T_{zz}| \le 1$。这个不等式是现实的一个边界，*如果*现实是由这样的[隐变量](@article_id:310565)所描述的话。

但量子力学不以为然。对于一对充分纠缠的粒子，标准的量子力学计算预测，相关性将*强于*这个极限。它预测$|T_{xx}| + |T_{yy}| + |T_{zz}|$可以达到$\sqrt{3}$ [@problem_id:449027]。

这是一次直接的对抗。[隐变量理论](@article_id:368501)在沙滩上划下了一条线，而量子力学漫不经心地跨了过去。实验已经进行，并一次又一次地证实，量子力学是正确的。自然界的相关性比这一整类[隐变量理论](@article_id:368501)所能允许的更强，“更鬼魅”。

因此，我们以一个悖论结束。我们为在生物学和生态学中寻找隐藏现实而开发的工具，当应用于宇宙的基本结构时，却揭示了可能根本不存在更深层次、类似经典的隐藏现实。用[潜变量](@article_id:304202)来“解释掉”量子力学之谜的尝试，只会使这个谜团更加尖锐和深刻。我们观察到的故事，连同其所有的量子怪诞性，可能就是唯一存在的故事。