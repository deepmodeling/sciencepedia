## 引言
[新一代测序](@entry_id:141347)技术使我们能够以前所未有的规模读取DNA和RNA，但它们产生了数十亿个短小、不连续的序列片段的洪流。根本的挑战在于如何重新拼合这个巨大的基因组拼图。读段比对正是解决这一问题的计算方法，它通过确定每个短序列（即“读段”）在参考基因组中的精确来源位置。这一过程是现代基因组学的基石，将原始测序数据转化为有意义的生物学见解。

本文探讨了读段比对的精妙原理和强大应用。它解决了我们如何能够顶住测序错误、遗传变异和三十亿个碱基长度的参考序列等挑战，准确高效地映射这些片段的核心问题。通过理解这一过程，您将深入了解科学家和临床医生如何分析遗传信息。

以下章节将引导您了解这个复杂的主题。首先，**“原理与机制”**将解析使比对成为可能的算法、评分系统和计算策略，同时还将探讨这些方法如何处理剪接后的RNA和[重复DNA](@entry_id:274410)等挑战。随后，**“应用与跨学科联系”**将展示读段比对如何作为一种强大的透镜，在[个性化医疗](@entry_id:152668)中检测致病突变，到监测全球生态系统等不同领域中发挥作用。

## 原理与机制

想象一下，你的任务是重新拼凑一部被撕碎的百科全书。你有数十亿个微小的纸片，每个纸片上只有几个词。更糟糕的是，碎纸机工作时有些马虎，所以一些纸片上的词语变得模糊不清（测序错误），而且你正在重组的这部百科全书并非你书架上那部母版参考书的精确副本——它是一个略有不同的版本，各处都有一些独特的句子（遗传变异）。这就是**读段比对**所面临的巨大挑战。参考基因组是你的母版百科全书，而来自测序仪的数十亿个短DNA序列（即**读段**）则是你那些被撕碎的纸片。比对的主要目标是确定每个读段在参考基因组中的精确来源位置，从而使我们能够重建个体的独特遗传文本，并在RNA测序的情况下，量化每个基因被“读取”或表达的程度[@problem_id:1530945]。

### 判断拟合优劣的艺术

我们如何决定一个片段属于哪里？它很少是[完美匹配](@entry_id:273916)的。因此，我们需要一个系统来评估一个读段与特定位置的*拟合*程度。这是**比对算法**的工作。该算法寻找读段序列与[参考基因组](@entry_id:269221)片段之间最佳的对应关系。这种对应关系通过**比对分数**来量化，这是一个由奖励和惩罚组成的精妙系统。读段中的碱基与参考序列中的碱基匹配会为分数增加一个正值。而**错配**，即碱基不同，则会减去一个值。

但如果读段中含有一个参考序列所没有的碱基，或者缺少一个参考序列所拥有的碱基，该怎么办？这些是**插入**或**缺失**——统称为**插入缺失（indels）**——它们在比对中形成了一个**缺口**。比对工具会对缺口进行罚分，但其方式非常巧妙，能够反映生物学现实。它们通常不为缺口中的每个碱基施加统一的罚分，而是使用**仿射罚分**。这包括一个较大的罚分用于*打开*一个缺口，以及一个较小的罚分用于*延伸*它。为什么？从生物学上讲，一个单一的突变事件可能会插入或删除一段含有多个碱基的序列。仿射罚分完美地模拟了这一点：代价高昂的事件是[插入缺失](@entry_id:173062)的起始，而延伸它的代价相对“便宜”[@problem_id:3310809]。在某些关于插入缺失如何发生的[概率模型](@entry_id:265150)下，这种评分方案不仅仅是一个方便的技巧；它是表示此类事件可能性的数学上自然的方式。

此外，我们必须决定我们正在比对什么。我们是试图将整个读段强制匹配到一段基因组（**[全局比对](@entry_id:176205)**），还是在读段和基因组中寻找最佳匹配的*子串*（**[局部比对](@entry_id:164979)**）？对于短读段，我们几乎总是对[局部比对](@entry_id:164979)感兴趣。我们将一个微小的拼图块*放在*一个巨大的拼图板上的*某个位置*，而不是将这个拼图块拉伸以覆盖整个拼图板。著名的**[Smith-Waterman算法](@entry_id:179006)**是寻找最优[局部比对](@entry_id:164979)的经典方法，它被巧妙地设计用来忽略匹配不佳的末端，并专注于最佳的相似性区域[@problem_id:3310809]。

### 化不可能的搜索为可能

人类基因组是一部包含三十亿个字符的文本。天真地将每个150个字符的读段与每个可能的位置进行比对，将耗费无穷无尽的时间。为了使这在计算上可行，比对工具需要一个“技巧”——一个基因组索引，它像书的索引一样工作，但速度快得不可估量。

一种常见且非常直观的策略被称为**种子-延伸**。比对工具首先在读段和参考序列之间识别出非常短的、完全相同的匹配序列（例如，20个碱基长）。这些被称为**种子**。这个播种步骤可以使用预先计算好的基因组索引（如一个将所有可能的短序列映射到其位置的[哈希表](@entry_id:266620)）来极快地完成。一旦一个种子提供了一个候选位置——一个“命中”——比对工具就会在该种子附近执行更仔细、计算成本更高的[局部比对](@entry_id:164979)，以“延伸”匹配并计算完整的比对分数。这就像在一块拼图上找到了一个独特的窗角，然后检查窗框的其余部分是否与之契合[@problem_id:4341268]。

更现代的比对工具采用了一种更优美、更抽象的数学工具：**[Burrows-Wheeler变换](@entry_id:269666)（BWT）**。BWT是文本中字符的一种可[逆排列](@entry_id:268925)。它本身似乎将基因组打乱成了无意义的序列。但当与一个名为**FM-索引**的辅助数据结构结合使用时，它创建了一个基因组的压缩版本，该版本具有一个非凡的特性：你可以在只与你要查找的序列长度成正比的时间内找到任何序列的位置，而与整个基因组的大小无关。这种“魔力”使得像BWA和Bowtie2这样的比对工具能够以惊人的速度和效率找到种子匹配，从而使群体规[模的基](@entry_id:156416)因组学成为现实[@problem_id:4341268]。

### 生命复杂性的回响

现实世界的生物学引入了一些引人入胜的复杂情况，比对算法必须加以处理。参考基因组并非完美的蓝图；它是一个标准化的、具有代表性的图谱。

#### 两只猫的故事：优质参考序列的重要性
比对的成功从根本上取决于读段与参考序列之间的相似性。想象一下，你发现了一个新的野猫物种，并想研究它的基因。如果你将其读段与小鼠基因组进行比对，巨大的进化距离意味着基因序列将高度分化。大多数读段将会有太多的错配，无法自信地比对。然而，如果你将它们与老虎基因组——一个亲缘关系更近的物种——进行比对，[序列相似性](@entry_id:178293)将会大得多，从而导致更高的成功率。参考序列的选择至关重要；“拼图块”与“拼图盒上的图画”越相似，组装效果就越好[@problem_id:1740551]。

#### 内含子问题：读取剪接后的信息
使用[RNA测序](@entry_id:178187)研究基因表达时，最深刻的挑战之一随之而来。在真核生物中，基因被分割成称为**外显子**的蛋白质编码区和称为**[内含子](@entry_id:144362)**的非编码插入区。当一个基因表达时，内含子被剪接掉，外显子被拼接在一起形成成熟的[信使RNA](@entry_id:262893)（mRNA）。[RNA测序](@entry_id:178187)的读段就来源于这个最终的、经过剪接的信息。

现在，考虑一个跨越两个外显子连接处的读段。在成熟的mRNA中，这两个片段是相邻的。但在参考基因组中，它们可能被一个长达数千个碱基的[内含子](@entry_id:144362)隔开。一个标准的DNA比对工具，被设计为期望只有小缺口的连续比对，会将这看作是一个大得不可能的缺失，从而无法映射该读段。这就是为什么使用标准的DNA比对工具时，很大一部分[RNA测序](@entry_id:178187)读段会比对失败的原因[@problem_id:2336595]。为了解决这个问题，生物信息学家开发了**[剪接感知比对](@entry_id:175766)工具**。这些工具专门设计用来检测这些大的缺口，并检查它们是否与已知的内含子-外显子边界相对应，从而使它们能够正确地拼凑出剪接后的比对。另一种方法是将读段比对到**参考[转录组](@entry_id:274025)**——一个只包含已知成熟mRNA序列的数据库。这样做速度快得多，因为内含子问题消失了，但它也带来了显著的偏倚：你只能量化你已经知道的基因。你样本中的任何新基因或未注释的剪接变体都将是不可见的，因为它们的序列根本不存在于你的转录组参考中[@problem_id:2417818]。

#### 重复序列的迷雾：当一个片段适用于任何地方
当一个拼图块只是一片均匀的蓝色天空时会发生什么？它可能适合很多地方。基因组中充满了这样的区域：大段的重复序列和由古老复制事件产生并保留非常相似序列的**[旁系同源基因](@entry_id:263736)**家族。源自这样一个区域的读段可能会同样好地比对到基因组的多个位置。这被称为**多重比对**。在某些情况下，当两个基因组区域在比读段本身更长的片段上完全相同时，*从信息论上讲*，仅凭其序列来确定读段的真实来源是不可能的[@problem_id:5088485]。比对工具通过报告所有可能的位置并分配一个**[比对质量](@entry_id:170584)（MAPQ）**分数来处理这种不确定性，该分数代表所选比对是正确的概率。一个低的MAPQ分数是一个明确的警示信号：比对工具对这个位置没有信心。当一个读段的末端不能完美匹配时，也许是由于文库制备中残留的接头序列，比对工具可以执行**软剪切**，即标记未匹配的碱基，但将它们保留在记录中，承认它们是读段的一部分，但不属于与参考序列的比对部分[@problem_id:5088485]。

### 协同的线索：[双端测序](@entry_id:272784)的力量

到目前为止，我们一直将每个读段视为独立的拼图块。但是，如果我们知道两个特定的拼图块虽然没有连接，但来自拼图的同一个小区域呢？这就是**[双端测序](@entry_id:272784)**背后的思想。在这种技术中，一个较大的DNA片段（例如，500个碱基长）的两端都被测序，生成一对读段。我们现在有两条关键信息：两个读段的序列，以及它们应该以大约500个碱基的距离映射到参考基因组上，并且方向是特定的朝内方向。

这种关系信息在解决模糊性和“看到”基因组更大结构方面非常强大。考虑检测一个大的**倒位**，即一个10,000个碱基对的染色体片段被翻转了。一个映射在倒位片段内部的单端读段可能看起来很正常。但是，如果一个读段*对*其原始DNA片段跨越了倒位的断点之一，情况就大不相同了。当映射回未翻转的参考基因组时，这些读段将呈现出一种奇异的配置：它们可能映射到相距数千个碱基的位置，或者两者都朝向同一方向，或者彼此背离。这种“不一致”的比对特征是确凿的证据，为大规模结构重排提供了决定性的证明[@problem_id:2062764]。[双端读段](@entry_id:176330)将比对从仅仅放置读段转变为主动重建基因组结构。

### 超越平面图谱：克服内在偏倚

还有一个最终的、微妙而深刻的挑战：参考基因组本身就是偏倚的来源。标准的人类[参考基因组](@entry_id:269221)是由少数个体的DNA拼接而成的马赛克；它在任何一个[多态性](@entry_id:159475)位点只代表了一组可能的等位基因（基因的版本）中的一个。

这导致了**参考偏倚**。假设参考基因组在某个位置有一个‘G’等位基因，但你测序的个体一条染色体上有‘G’，另一条有‘A’。携带‘A’等位基因的读段在比对到参考序列时会出现错配，从而受到分数惩罚。而携带参考‘G’等位基因的读段则会[完美匹配](@entry_id:273916)。这个小小的惩罚使得携带‘A’的读段更有可能被丢弃或以低[质量比](@entry_id:167674)对，导致我们系统性地低估非参考等位基因的数量。一个实验可能会显示出G:A读段的比例为70:30，这并非生物学现实所致，而是比对假象造成的[@problem_id:4375993]。这种偏倚可以通过使用分子条形码（UMIs）来与PCR偏倚等实验假象区分开，并且不能用随机测序错误来解释。决定性的证据来自于当我们将这些读段重新比对到一个同时知晓两种等位基因的参考序列上时；偏倚消失了，比例校正为杂合位点预期的50:50 [@problem_id:4375993]。

读段比对的未来在于通过摆脱单一的线性参考来解决这个问题。解决方案是**变异图**。变异图不是一个扁平的一维序列，而是一个数学结构，它将参考序列*和*已知的变异编码成一个路径网络。在一个具有‘G’/‘A’[多态性](@entry_id:159475)的位置，图会分裂成两条路径——一条为‘G’，一条为‘A’——然后重新汇合。携带‘A’等位基因的读段现在可以在图中找到一条[完美匹配](@entry_id:273916)的路径，而不会受到任何惩罚。通过表示一个群体的已知多样性，变异图为所有读段提供了一个无偏的坐标系统，无论它们携带哪种等位基因。这就是前沿领域：将读段比对从将片段匹配到单一、有缺陷的地图，转变为在人类[泛基因组](@entry_id:149997)的丰富、动态表示中导航[@problem_id:4375981]。

