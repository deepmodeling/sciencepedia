## 引言
单细胞技术的爆炸式发展为生物学家提供了前所未有的视角，来观察组织中复杂的[异质性](@entry_id:275678)。然而，这种高分辨率数据也带来了一个根本性的统计挑战：[伪重复](@entry_id:176246)。在分析来自多个供体的数据时，将成千上万个细胞中的每一个都视为独立的数据点，会造成统计功效的危险假象，导致大量假阳性结果。我们如何才能在保持统计完整性的同时，利用单细胞分辨率的强大功能呢？

本文介绍了伪批量分析，一个强大而简洁的框架，用以解决此问题。通过将细胞数据聚合到生物学重复（即供体）的层面，它为科学发现提供了稳健的基础。我们将首先在 **原理与机制** 一章中探讨其核心统计概念，揭示为何聚合并非一种妥协，而是一种统计上合理有效的策略，以及它与更复杂模型的关系。随后，**应用与跨学科联系** 一章将展示这个简单的理念如何充当通用转换器，将单细胞数据与[数量遗传学](@entry_id:154685)、[空间转录组学](@entry_id:270096)以及海量的现有生物学知识连接起来。

## 原理与机制

### 群体的错觉：为什么细胞越多功效未必越强

想象一下，你想回答一个简单的问题：男性的平均身高是否高于女性？一位热情但天真的研究者提出了一个研究方案。他找来一个男人和一个女人。为了做到“彻底”，他测量了那个男人身高一千次，也测量了那个女人身高一千次。他自豪地带着2000个数据点回来，并使用标准的统计检验，以极大的置信度宣布了他的发现。

你当然会笑。他没有2000个[独立样本](@entry_id:177139)；他只有两个。他对同一个人的重复测量并不是关于总人群的新信息，而只是高度相关的数据点，以极高的精度告诉了他*那个特定男人和女人的身高*。他的结论对于普遍意义上的男性和女性毫无意义。

这种将同一受试者的多次测量误认为是独立生物学重复的错误，有一个专门的名称：**[伪重复](@entry_id:176246)**。这是实验科学中最基本的谬误之一，也是广阔的单[细胞生物学](@entry_id:143618)领域为粗心者设下的陷阱。当我们分析来自多个供体的单细胞数据时，供体就是我们类比中的“人”，而来自每个供体的数千个细胞就是“重复测量”。来自同一供体的细胞并非独立的；它们共享相同的遗传背景、环境和技术处理过程，这引入了相关性。将每个细胞视为一个独立的数据点，就是犯了[伪重复](@entry_id:176246)的错误 [@problem_id:3301304]。

为什么这如此糟糕？因为它制造了统计功效的危险假象。统计检验的置信度取决于两件事：你测量的效应大小和你的估计值的[方差](@entry_id:200758)。通过错误地假设数千个细胞是独立的，你会极大地低估真实[方差](@entry_id:200758)。这种细胞在供体内的聚集效应可以用一个称为**设计效应**的术语来量化，通常写作 $D = 1 + (m - 1)\rho$，其中 $m$ 是每个供体的细胞数，而 $\rho$ 是**组内相关性**——衡量来自同一供体的细胞彼此相似程度的指标 [@problem_id:3301304]。如果你每个供体有1000个细胞，即使相关性仅为中等的 $\rho = 0.1$，你的[方差](@entry_id:200758)也会被低估约100倍！这会导致[检验统计量](@entry_id:167372)被极度夸大，并引发大量的[假阳性](@entry_id:197064)结果。你的检验可能会告诉你某个基因是“显著”的，而实际上，你观察到的仅仅是在你实际研究的少数几个供体中出现的偶然现象。

### 平均的智慧：伪批量解决方案

我们如何摆脱这个陷阱？我们采取诚实的做法。在我们的身高类比中，我们会取那个男人1000次测量的平均值，以获得一个良好、稳定的身高估计值，对那个女人也做同样的操作。然后，我们会基于这两个高质量的数据点进行分析，承认我们的真实样本量是2。

这就是**伪批量分析**背后优美而简单的思想。我们不再迷失于细胞的群体中，而是将来自单个供体的所有细胞数据进行聚合，以创建一个汇总的图谱。这就是我们的“伪批量”样本。我们可以通过对基因计数求和或取平均值来实现这一点。通过这样做，我们将成千上万个相关的细胞水平测量值压缩为每个供体的一个更稳定的数据点。我们的分析单元现在与重复单元——即供体——正确地匹配了 [@problem_id:3301304, @problem_id:2892383]。

当我们使用这些伪批量图谱比较不同条件时，我们是在比较供体组，而不是细胞组。这个框架恰当地考虑了个体之间的生物学变异，而这几乎总是我们真正感兴趣的量。这种简单的聚合操作巧妙地回避了[伪重复](@entry_id:176246)问题，使我们的统计分析与实验设计重新保持一致，确保我们的发现声明建立在坚实的基础之上。它远非一种粗略的简化，而是一种稳健、可靠且被广泛推荐的，用于多供体单细胞研究中[差异表达分析](@entry_id:266370)的默认策略 [@problem_id:2892383]。

### 这仅仅是一种妥协吗？揭示隐藏的等价性

此时，一个持怀疑态度的人可能会问：“通过对所有这些细胞取平均，我们难道不是在丢弃有价值的信息吗？一个更复杂的模型，能够分析每个单细胞，同时正确地考虑供体水平的相关性，肯定会更好吧？” 这是一个极好的问题，其答案揭示了统计学中一个惊人而深刻的统一性。

这种“更复杂”的方法是一种被称为**[线性混合模型](@entry_id:139702) (LMM)** 的统计工具。这些模型正是为这种层次化数据设计的，可以同时对每个细胞的表达进行建模，并包含解释每个供体共享的“随机效应”的项。这听起来像是一个完美的、包罗万象的解决方案。

美妙之处在于：在平衡的实验设计下——即每个供体贡献相同数量的细胞——简单、直观的伪批量分析与复杂、计算成本高昂的LMM，在估计条件间的差异时，给出了*完全相同的估计值* [@problem_id:2810285]。它们的估计量在代数上是等价的。这意味着伪批量方法不是一种妥协；它是通往统计最优答案的一条极其高效的捷径。它提取了回答关于供体水平差异问题所需的基本信息，而没有陷入对与主要假设无关的细胞间变异细微差别的建模中。即使当每个供体的细胞数量变得非常大时，这两种方法也会[渐近等价](@entry_id:273818) [@problem_id:3301664]。

### 应对现实世界：非平衡与细微差别

当然，现实世界的实验很少如此完美平衡。常见的情况是，一些供体贡献了数千个细胞，而另一些可能只产生了数百个。在这种情况下，简单的伪批量方法是否仍然有效？

当出现非平衡时，我们的[统计功效](@entry_id:197129)可能会降低。想象一个有六个供体的研究，但其中一个供体贡献了90%的细胞。直觉上我们知道，这不如一个所有六个供体都贡献均等的研究。我们可以用**[有效样本量](@entry_id:271661)**的概念来将其形式化。由于非平衡，我们的六个供体组可能只具有一个完美平衡的、比如说四或五个供体组的[统计功效](@entry_id:197129) [@problem_id:3348593]。

这就是伪批量和完整LMM之间权衡变得更加微妙的地方。
-   当供体*之间*的变异是噪声的主要来源时（高组内相关性），一个供体就是一个供体，拥有更多的细胞所带来的回报会迅速递减。在这种情况下，伪批量和LMM分析的功效主要受供体数量的限制，两种方法的表现非常相似 [@problem_id:2752248]。
-   当一个供体*内部*细胞的变异非常高时（低组内相关性），拥有更多的细胞可以为该供体的平均表达提供更精确的估计。在这种情况下，LMM可能具有理论上的优势，因为它可以智能地给予那些提供了更多细胞的“高信息量”供体更大的权重。而一个未加权的伪批量分析则会效力较低 [@problem_id:2752248]。

然而，这种理论上的优势伴随着实际的代价。LMM是复杂的机器。在许多研究中，供体数量通常很少（例如，每组少于10个），估计它们的参数，特别是供体间的[方差](@entry_id:200758)，是出了名的困难。对这个[方差](@entry_id:200758)的不稳定估计可能导致模型不稳定、功效丧失，甚至错误的[误差控制](@entry_id:169753)。更简单的伪批量方法通过回避这个棘手的估计步骤，在实践中常常被证明更加稳健和可靠，巩固了其作为一种强大且值得信赖的主力方法的地位 [@problem_id:2752248, @problem_id:2892383]。

### 超越平均：规避悖论与尊重结构

聚合思维的力量不仅仅局限于比较两个组。它为剖析更复杂的生物学现象提供了一个框架。考虑一种处理，它出乎意料地似乎*降低*了组织中某个基因的总体表达。一个简单的伪批量分析，聚合所有类型的所有细胞，会证实这一点。但是，如果我们仔细观察，发现该基因的表达在每一种细胞类型内部实际上都*增加*了，这又该如何解释呢？

这不是一个假设性的矛盾；这是一个真实存在的统计陷阱，被称为**[辛普森悖论](@entry_id:136589)**。如果处理在改变基因表达的同时，也改变了组织的细胞组成——例如，导致从高表达细胞类型向低表达细胞类型的转变——就可能发生这种情况。[边际效应](@entry_id:634982)，或称总体效应，是真实表达变化和细胞比例变化的一种误导性混合 [@problem_id:3301275]。

解决方案是更精确地应用我们的伪批量原则：**分层伪批量分析**。我们不再为每个供体创建一个伪批量样本，而是为*每个供体内的每种细胞类型*创建一个。这使我们能够提出一个更精细的问题，例如“处理对[T细胞](@entry_id:181561)中这个特定基因有什么影响？”通过以细胞类型为条件进行分析，我们从统计上阻断了由组成变化造成的混杂路径，并揭示了真实的、细胞类型特异性的生物学效应 [@problem_id:3301275]。

这个核心原则——尊[重数](@entry_id:136466)据的层次结构——是普适的。它甚至适用于所谓的“无假设”方法，如[置换检验](@entry_id:175392)。为了给一个假设检验生成一个有效的[零分布](@entry_id:195412)，必须在独立重复的层面上对条件标签进行[置换](@entry_id:136432)。在我们的案例中，这意味着[置换](@entry_id:136432)**供体**的标签，而不是细胞的标签 [@problem_id:3301293]。在忽略细胞来自哪个供体的情况下打乱细胞标签，违背了可交换性的基本原则，并会导向与[伪重复](@entry_id:176246)相同的错误。供体，自始至终，都是重复的单元，而伪批量框架的精妙之处在于它诚实而有力地坚守着这一简单真理。

