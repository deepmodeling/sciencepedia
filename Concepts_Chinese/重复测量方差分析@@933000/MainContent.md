## 引言
在研究事物如何随时间变化时——无论是病人对治疗的反应、儿童的学习过程，还是生态系统的恢复——我们常常会在多个时间点从同一受试者身上收集数据。这种重复测量的行为带来了一个统计学上的挑战：观测数据之间并非相互独立。一个人周二的健康指标内在地与他周一的指标相关。像普通方差分析（ANOVA）这样的标准统计检验无法处理这种相关性，可能导致错误的结论。

本文介绍的重复测量[方差分析](@entry_id:275547)（Repeated Measures ANOVA）是一种经典而强大的统计方法，专为应对这一挑战而设计。它提供了一个框架，用于分析被试内部的变化，同时恰当地考虑了数据中的依赖性。在接下来的章节中，我们将剖析这一重要工具。“原理与机制”部分将分解该方法如何划分变异，解释其关键且常被误解的球形性假设，并详述当此假设不成立时所采用的校正措施。随后，“应用与跨学科联系”部分将把该方法置于更广阔的背景中，与 M[ANOVA](@entry_id:275547) 和[非参数检验](@entry_id:176711)等替代方法进行比较，并最终展示其原理如何为更现代、更灵活的技术（如线性混合效应模型）铺平道路。

## 原理与机制

要真正领会重复测量方差分析的精妙之处，我们必须首先理解它旨在解决的问题。这个问题出现在我们对同一受试者——无论是人、病人、细胞培养物，还是遥远的恒星——进行多次观测时。为何这种看似简单的“再次观察”行为需要一种特殊的统计工具呢？

### “自我”的挑战：为何普通方差分析会失效

想象一下，你是一名医学研究者，正在测试一种旨在降低血压的新药。你招募了一组患者，在基线时测量他们的血压，然后在开始治疗后的一个月、两个月和三个月时再次测量。你的问题很简单：血压是否随时间变化？

你的第一反应可能是使用标准的方差分析（[ANOVA](@entry_id:275547)）。毕竟，你有一个连续测量值（血压）和一个分类因子（时间，有四个水平）。但标准[方差分析](@entry_id:275547)有一个至关重要的假设：所有观测值必须是**独立**的。而在这里，这个假设被彻底违反了。

患者 A 在一个月时的血压读数与她两个月时的读数并非独立。这两个测量值都来自患者 A，她有自己独特的生理机能、生活方式和遗传倾向。她的测量值彼此之间的相似度很可能高于与患者 B 的测量值的相似度。这种受试者内部固有的相关性是问题的核心。将这些测量值视为独立，就好比假装一个人周二的情绪与周一的情绪毫无关联——这显然是谬论。

这不仅仅是一个可以被忽略的统计学上的麻烦。这种相关性包含了宝贵的信息。通过认识到我们数据中的部分变异源于个体*之间*稳定的、根本性的差异，我们就可以将其分离出来。这使我们能够更清晰、更有力地观察到每个个体*内部*随时间发生的变化。这正是重复测量方差分析所要做的。

### 切分变异这块“蛋糕”

广义上讲，[方差分析](@entry_id:275547)的精妙之处在于它能够将数据集中的总变异分解或“切分”成不同的来源。重复测量方差分析执行一种特别巧妙的两阶段分解。它首先将总变异分成两大块 [@problem_id:4948307]：

1.  **被试间变异 (Between-Subjects Variation)**：这种变异来自个体之间稳定的、平均的差异。想象一场烘焙比赛，有些面包师的技艺就是比别人高超，他们的蛋糕在各项评分上平均得分会更高。这个变异来源反映了*面包师之间*的差异。在我们的医学研究中，这对应于一些患者的血压天然就比其他人高或低，无论治疗随时间产生的效果如何。用于检验此层面效应（例如，比较药物组与安慰剂组）的误差项是基于个体在各自组内的变异程度。

2.  **被试内变异 (Within-Subjects Variation)**：这种变异发生在单个受试者*内部*，贯穿不同的条件或时间点。如果我们的一位明星面包师尝试了四种不同的糖霜配方，这四块蛋糕得分的差异就代表了被试内变异。在我们的研究中，这正是我们感兴趣的地方：单个患者的血压是如何从一个月到下个月波动的？

然后，这块被试内的“蛋糕”会被进一步切分。我们可以将部分变异归因于我们关心的因子（**时间**效应），其余部分则被视为**被试内误差**。这个误差不仅仅是随机噪声；它代表了时间趋势在不同人之间的随机变化。它成为我们衡量主要效应的标尺。但要使这个标尺公平，一个隐藏的假设必须得到满足。

### 隐藏的假设：“球形性”问题

标准F检验对被试内效应（如我们的时间效应）的有效性取决于一个微妙但至关重要的假设，称为**球形性**（sphericity）。暂时忘掉这个令人生畏的名字，专注于其直观含义。

[F检验](@entry_id:274297)通过汇集所有不同时间点的变异信息来创建一个单一的误差项。为了使这种汇集合法，数据必须表现出一种特定的平衡。理解这种平衡的最简单方法是考虑测量值之间的*差异* [@problem_id:4965565] [@problem_id:4546892]。球形性要求任意两个时间点之间差值的方差是相同的。

在我们的研究中，这意味着从第 1 个月到第 2 个月血压变化的方差，应该与从第 1 个月到第 3 个月变化的的方差相同，也应与从第 2 个月到第 3 个月变化的方差相同，以此类推，对于所有可能的时间点对都是如此。

理解球形性*不是*什么至关重要 [@problem_id:4948286]。
- 它**不等同于[方差齐性](@entry_id:167143)**（homoscedasticity，即每个时间点的方差相等）。你可能遇到在第 1 个月和第 3 个月的血压方差不同的情况，但球形性条件仍然成立。
- 它**不等同于独立性**（independence，即时间点之间[零相关](@entry_id:270141)）。重复测量的本质就是相关的。球形性是关于这种相关性的特定模式。
- 它是一个比**复合对称性**（compound symmetry, CS）更弱、更一般的条件。复合对称性是完美的情况，即所有时间点的方差相同，且所有时间点对的协方差也相同 [@problem_id:4919615]。这种简单、统一的结构总是满足球形性。然而，一个协方差结构可以更复杂但仍然满足球形性，就像一块晶体可以缺乏完美的对称性但仍具有潜在的结构平衡。其基本思想是，当从时间点之间“差异的子空间”来看时，协方差矩阵（$\Sigma$）的行为就像[单位矩阵](@entry_id:156724)的一个简单的标量倍数 [@problem_id:4948342]。

### 当“球体”变形时：违反假设的后果

当这种平衡的假设被打破——当球体变形时——会发生什么？这在现实世界的数据中是常见情况。例如，时间上更接近的测量值（第 1 个月和第 2 个月）通常比相距更远的测量值（第 1 个月和第 4 个月）具有更高的相关性。这种模式通常会违反球形性。

当违反球形性时，F检验中的合并误差项就不再是一个公平的标尺。它往往会低估真实误差，从而人为地夸大了 F 统计量。这使得检验变得**宽泛**（liberal）——它变得过于急于宣布结果显著 [@problem_id:4546892]。我们开始看到“机器里的幽灵”，找到了实际上不存在的效应，导致我们的 I 类错误率增加。

统计学家为此假设开发了一种正式的检验，称为**Mauchly 球形性检验**。Mauchly 检验的显著结果（例如，$p \lt 0.05$）是一个警示信号，警告我们 F 检验可能过于宽泛，若不进行某种形式的校正，其结果将不可信 [@problem_id:4951167]。然而，Mauchly 检验自身也存在问题：在小样本中，它通常不够强大以检测到违规；而在大样本中，它可能对微不足道的违规过于敏感。因此，我们不能盲目依赖它。

### 校正的艺术：为 F 检验恢复公平

那么，我们的假设被违反了。我们是否要放弃分析？完全不必。我们只需调整游戏规则。这就是 **Greenhouse-Geisser (GG)** 和 **Huynh-Feldt (HF)** 校正的精妙之处 [@problem_id:4546761]。

这些校正做的事情非常直观。它们不改变 F 统计量本身，而是调整用于评估该统计量的**自由度**。可以把自由度看作是你的数据所包含的“独立信息片段的数量”。违反球形性意味着不同时间点之间的比较比假设的更加纠缠和冗余；我们所拥有的真正独立的信息片段并没有我们想象的那么多。

这些校正通过计算一个称为 **epsilon** ($\hat{\epsilon}$) 的因子来运作，该因子衡量了偏离完美球形性的程度。
- 如果完美满足球形性，$\hat{\epsilon} = 1$。
- 如果违反球形性，$\hat{\epsilon} \lt 1$。违规越严重，$\hat{\epsilon}$ 的值越小（其理论最小值为 $\frac{1}{t-1}$，其中 $t$ 是时间点的数量）。

校正后的自由度就是原始自由度乘以 $\hat{\epsilon}$。例如，如果我们的研究有 $t=6$ 个时间点，未校正的[分子自由度](@entry_id:175192)为 $t-1=5$。如果我们发现严重违规并计算出 $\hat{\epsilon} = 0.58$，GG 校正告诉我们，我们的检验表现得好像它只有“有效的” $0.58 \times 5 = 2.9$ 个自由度 [@problem_id:4948301]。自由度的减少使得 F 检验更加保守（即，它需要更强的证据才能宣布结果显著），从而抵消了因违规造成的宽泛偏倚，保护了我们的 I 类错误率。

在实践中，Greenhouse-Geisser 校正以更保守著称，而 Huynh-Feldt 校正则不那么保守。一个常见的经验法则是，当 GG 的估计值小于约 0.75 时使用它，否则使用 HF，这样可以在控制错误和维持[统计功效](@entry_id:197129)之间取得良好平衡 [@problem_id:4546761]。

### 超越[方差分析](@entry_id:275547)：现代方法一瞥

重复测量[方差分析](@entry_id:275547)是一个经典而强大的工具，它阐明了[统计建模](@entry_id:272466)的核心原则。然而，统计学的世界在不断发展，了解这种方法在现代背景下的位置非常重要。

经典方差分析框架有一个主要的实际缺点：它要求完整的数据。如果在我们的研究中，单个患者错过了第 4 个月的预约，那么该患者的所有数据都将从分析中被丢弃。这不仅是浪费，而且如果缺失的原因与结果相关（一种称为[随机缺失](@entry_id:168632)，或 MAR 的情况），还可能导致有偏倚的结果。

这就是**线性混合效应模型 (LMMs)** 发挥作用的地方 [@problem_id:4951167] [@problem_id:4546761]。LMMs 是一种更灵活、更稳健的替代方案。它们在 MAR 假设下能够优雅地处理缺失数据，利用每个受试者的所有可用信息。此外，它们完全回避了球形性问题。LMMs 不是假设一个僵化的协方差结构然后对其进行检验和校正，而是允许你直接对最适合你数据的协方ar差结构进行建模。无论是复合对称性、自回归结构（相关性随时间衰减），甚至是完全非结构化的矩阵，你都可以选择最有意义的模型。

通过理解重复测量[方差分析](@entry_id:275547)的原理，从其巧妙的方差分解到球形性假设及其校正的微妙之美，我们不仅获得了一个宝贵的分析工具，而且对从这些基础思想发展而来的更通用、更强大的方法（如 LMMs）有了更深的欣赏。

