## 引言
在科学和工业领域，我们经常遇到有序但并非真正数值型的数据。从患者疼痛评级的“轻度”、“中度”、“重度”，到调查问卷的回答“不同意”、“中立”、“同意”，这些有序类别，即**[定序数据](@entry_id:163976)**，无处不在。挑战在于如何正确分析这些数据：将类别视为数字会强加一种虚假的结构，而忽略其固有顺序则会丢弃宝贵的信息。当数据是集群的时，例如患者按医院分组或学生按学校分组，这个问题就变得更加复杂。累积链接[混合模型](@entry_id:266571)（CLMMs）为这一普遍存在的统计挑战提供了一个优雅而强大的解决方案。本文旨在作为理解和应用这些模型的综合指南。在第一部分**原理与机制**中，我们将剖析模型的理论基础，探讨[潜变量](@entry_id:143771)、链接函数、比例优势假设以及随机效应的引入等概念。随后，**应用与跨学科联系**部分将展示 CLMMs 在现实世界中的应用，从革新临床试验和心理计量学，到为遗传学甚至人工智能的研究提供信息。

## 原理与机制

自然界充满了渐变。患者的疼痛并非简单地存在或不存在；它从轻度到中度再到重度不等。一项临床试验可能不会将毒性简单地衡量为“是”或“否”，而是使用从0级到4级的量表。这些都是**[定序数据](@entry_id:163976)**：拥有自然、逻辑顺序的类别，但它们之间的“距离”是未知且很可能不相等的。“轻度”疼痛到“中度”疼痛的跨越不一定等同于“中度”到“重度”的跨越。

那么，我们如何建立一个既尊重这种固有顺序，又不对间距做错误假设的数学模型呢？将类别视为数字（$1, 2, 3, \dots$）并运行标准线性回归是一个常见的错误，因为它强加了一种数据很少具备的僵化、均匀间隔的结构 [@problem_id:4993145]。另一方面，用于纯粹无序的**名义**数据的模型——比如疫苗产生的不同类型的不良事件——则丢弃了顺序所提供的宝贵信息 [@problem_id:4929803]。累积链接混合模型（CLMM）的精妙之处在于它对这个问题的优雅解决方案。它提供了一种有原则的方法来处理有序类别，特别是当我们的数据嵌套在群体中时，比如不同医院里的患者。

### [潜变量](@entry_id:143771)：一个隐藏的严重性连续体

让我们从一个强大的想法开始，这是一个应用于统计学的一点物理直觉。如果在我们笨拙的可观察类别背后，存在一个隐藏的、连续的现实呢？想象一个我们称之为**潜在严重性**或**倾向性**的、未被观察到的、平滑变化的量，我们称之为$Z$。我们观察到的定序结果，比如$Y$，只是受试者在这个潜在量表上位置的粗略反映。如果他们真实的潜在严重性$Z$在某个范围内，我们观察到$Y=\text{"mild"}$；如果$Z$越过一个边界进入下一个范围，我们观察到$Y=\text{"moderate"}$，依此类推 [@problem_id:4922380] [@problem_id:4993145]。

这个潜在量表上的边界被称为**阈值**或**[切点](@entry_id:172885)**。对于一个有$K$个类别的量表，我们需要$K-1$个阈值，我们可以称之为$\theta_1, \theta_2, \dots, \theta_{K-1}$，它们必须是有序的（$\theta_1  \theta_2  \dots  \theta_{K-1}$）才有意义 [@problem_id:4976188] [@problem_id:4965214]。
- 如果$Z \le \theta_1$，我们观察到类别1。
- 如果$\theta_1  Z \le \theta_2$，我们观察到类别2。
- ...以此类推。

这一个概念上的飞跃是深刻的。它将建模有序类别的棘手问题转化为建模连续变量$Z$这个我们熟悉得多的问题。现在我们所需要的，只是一个将我们的预测变量——比如患者的年龄或治疗组——与这个[潜变量](@entry_id:143771)联系起来的方法。

### 链接函数：从潜在分数到可观察概率

对[潜变量](@entry_id:143771)$Z$进行建模的最自然的方式是使用[线性方程](@entry_id:151487)，就像我们在标准回归中所做的那样。我们假设一个人的潜在分数是其特征效应（**固定效应**，如治疗或年龄）与一些捕捉了所有未测量变异的随机噪声$\varepsilon$的简单总和：

$$
Z = (\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \dots) + \varepsilon
$$

现在，观察到结果在类别$k$或更低的概率，就是潜在分数$Z$小于或等于阈值$\theta_k$的概率：

$$
\Pr(Y \le k) = \Pr(Z \le \theta_k) = \Pr((\text{linear predictor}) + \varepsilon \le \theta_k) = \Pr(\varepsilon \le \theta_k - (\text{linear predictor}))
$$

这个方程告诉我们，累积概率是由误差项$\varepsilon$的累积分布函数（CDF）决定的。为这个误差项选择的分布定义了模型的**链接函数**——这是连接我们的线性预测器与我们可观察概率的数学桥梁 [@problem_id:4922380]。

-   **Logit 链接（逻辑斯蒂回归）：** 如果我们假设误差$\varepsilon$遵循**[标准逻辑](@entry_id:178384)斯蒂分布**，其CDF就是逻辑斯蒂函数。这个CDF的反函数就是著名的**logit**函数，$\log(\frac{p}{1-p})$。这就产生了**累积logit模型**，这是最常见的定序回归类型。

-   **Probit 链接（Probit 回归）：** 如果我们假设误差$\varepsilon$遵循**标准正态分布**，其CDF就是标准正态CDF，$\Phi$。其反函数是**probit**函数，$\Phi^{-1}(p)$，这导致了**累积probit模型**。

在实践中，logit和probit模型非常相似，产生的预测几乎完全相同。然而，logit链接在优势比方面有一个特别方便的解释 [@problem_id:3922046]。还值得注意的是，我们无法同时估计误差项$\varepsilon$的方差和回归系数；它们是混淆的。按照惯例，我们固定$\varepsilon$的方差（对于[标准逻辑](@entry_id:178384)斯蒂分布，固定为$\pi^2/3$；对于[标准正态分布](@entry_id:184509)，固定为$1$），这使得系数可以被识别 [@problem_id:3922046]。

### 比例优势假设：一种“平行”规则

现在我们来看一个极大地简化模型并赋予其力量的假设：**比例优势**假设，也称为**平行线**假设 [@problem_id:4797949]。

在我们的[潜变量](@entry_id:143771)世界里，这个假设意味着一个协变量（比如一种新药）的作用是*平移整个潜在严重性分数$Z$的分布*，而不改变其形状或离散程度 [@problem_id:4965214]。这种效应是恒定的；无论我们是在看“轻度”和“中度”之间的界限，还是“中度”和“重度”之间的界限，都无关紧要。药物带来的“推动力”在任何地方都是相同的。

这对模型方程有一个直接而强大的后果：我们协变量的系数向量$\boldsymbol{\beta}$对于所有的累积logit（$k=1, \dots, K-1$）都是*相同*的。

$$
\log\left(\frac{\Pr(Y \le k \mid x)}{\Pr(Y > k \mid x)}\right) = \theta_k - \boldsymbol{\beta}^{\top}x
$$

一个系数，比如$\beta_j$的解释变得非常一致。如果我们对其取指数，$\exp(\beta_j)$，我们得到**公共累积优势比**。这意味着，对于预测变量$x_j$每增加一个单位，处于或低于*任何*类别$k$（相对于高于它）的优势将乘以这个常数因子$\exp(\beta_j)$ [@problem_id:4967390]。

这里还有一个更深层次的结构。当这个假设成立时，一个正的系数$\beta_j$意味着增加协变量$x_j$会导致$Y$的整个累积分布向下移动。这是一个被称为**一阶随机优势**的强大属性。它意味着$x_j$值的增高会系统性地使整个量表上更高类别结果的可能性增加，这是一种优美统一的单调效应 [@problem_id:4821919]。

### “混合”元素：考虑组群和集群

到目前为止，我们有了一个处理[定序数据](@entry_id:163976)的强大工具。但现实世界的数据往往是杂乱和集群的。患者在不同的医院接受治疗，学生在不同的学校上课，测量在同一个人身上重复进行。忽略这种结构就像假装所有这些观察都是独立的，而事实并非如此。同一家医院的患者共享共同的方案、员工和环境，这使得他们的结果比来自不同医院的患者更相似。

这就是**累积链接混合模型（CLMMs）**中“混合”一词的由来。我们可以通过向模型中添加**随机效应**来解释这种集群效应。这个想法简单而深刻：我们给每个集群（例如，每家医院）一个它自己的个人截距项，代表其与总体平均值的独特偏差 [@problem_id:4976188]。我们的[潜变量](@entry_id:143771)方程扩展为：

$$
Z_{ij} = (\text{Fixed Effects}) + u_j + \varepsilon_{ij}
$$

在这里，$Z_{ij}$是医院$j$中患者$i$的潜在分数。“固定效应”部分是我们熟悉的[线性预测](@entry_id:180569)器$(\boldsymbol{\beta}^{\top}x_{ij})$。新项$u_j$是医院$j$的**随机截距**。它捕捉了那家医院所有未测量的、独特的特征，这些特征以类似的方式影响其所有患者 [@problem_id:4965214]。

我们不是试图将每个$u_j$估计为一个固定的数值，而是做一个“随机”的假设：我们假设它们都来自一个共同的分布，通常是一个均值为$0$、方差为$\sigma^2_u$的正态分布。然后模型会估计这个方差$\sigma^2_u$，它本身也变成了一个有趣的量：它告诉我们医院之间在潜在严重性量表上存在多大的异质性 [@problem_id:4976188]。这种“混合”方法，结合了固定效应和随机效应，赋予了模型名称及其处理现实世界结构化数据的灵活性。

### 两种解释的故事：条件效应与[边际效应](@entry_id:634982)

将随机效应引入非线性模型（如logit或probit模型）会引出最后一点，这一点微妙但至关重要：固定效应系数$\boldsymbol{\beta}$的解释 [@problem_id:4957360]。

在我们的CLMM中，系数$\beta_j$具有**条件**（或**特定于受试者**）的解释。它代表协变量$x_j$在*特定集群*中的效应（例如，保持某家医院的随机效应$u_j$恒定）。它是对“在一家典型的医院内部，治疗的效果是什么？”这个问题的回答。

但我们通常想知道**边际**（或**总体平均**）效应。这是对“在人群中所有医院的平均水平上，治疗的效果是什么？”这个问题的回答。

在一个简单的*线性*[混合模型](@entry_id:266571)中，这两种效应是相同的。但由于CLMM中的非线性链接函数，这不再成立。对随机效应的分布进行平均的过程改变了尺度。与条件效应相比，[边际效应](@entry_id:634982)被系统性地“衰减”或缩小到更接近零。例如，对于probit模型，其关系近似为：

$$
\beta_{\text{marginal}} \approx \frac{\beta_{\text{conditional}}}{\sqrt{1+\sigma^2_u}}
$$

随着医院间变异性（$\sigma^2_u$）的增加，总体平均效应变成了院内效应的一个更稀释的版本 [@problem_id:4957360]。这不是一个缺陷；当效应是非线性的且群体间存在变异性时，这是现实的一个基本属性。理解这种区别是掌握这些强大模型的最后一步——它确保我们不仅是在拟合一个模型，而且是以精确和清晰的方式提出和回答我们的科学问题。

