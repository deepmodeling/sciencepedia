## 引言
科学和工程领域的许多基本挑战都可以归结为一个看似简单却异常困难的问题：我们如何能确定一个多项式函数总是非负的？这个问题虽然陈述简单，但对于复杂的高维函数来说，通常是难以解决的，这使其成为从机器人学到理论物理学等领域的一个重要障碍。本文探讨[平方和 (SOS) 优化](@article_id:354352)，这是一个强大而优雅的计算框架，为此提供了实用的解决方案。它通过寻找一种代数上的非负性“凭证”，回避了直接验证的棘手难题。

在接下来的章节中，我们将踏上一段理解这一非凡工具的旅程。第一章**原理与机制**将揭示 SOS 分解的核心概念，解释如何将其转化为可解的[半定规划 (SDP)](@article_id:332315)，并讨论计算易解性与数学完备性之间的关键权衡。第二章**应用与跨学科联系**将展示该方法的深远影响，介绍其在保证[控制系统稳定性](@article_id:349675)、验证机器人安全性、解决困难的优化问题，甚至探索量子世界奥秘方面的能力。

## 原理与机制

在科学与工程领域的许多艰巨问题核心——从证明机器人不会碰撞到寻找复杂[能量景观](@article_id:308140)的真正最小值——都隐藏着一个看似简单的问题：我们如何确定一个给定的多项式函数，比如 $p(x)$，永远不会是负数？多项式仅仅是变量的整数次幂的组合，例如 $x_1^4 - 6x_1^2 + 5x_2^2 - 2x_1 x_2 + 10$。我们似乎应该能够解决这个问题。但随着变量数量和幂次的增加，这些函数的行为变得惊人地复杂。在所有可能的输入上检查非负性，通常是一个难以解决的问题。你不能简单地测试每一个点，因为点有无穷多个。

因此，我们需要一种不同的方法。与其进行详尽的搜索，我们是否能找到一个确凿的非负性*证明*或**凭证**？这就是平方和 (Sum-of-Squares, SOS) 优化这个简单而优美的思想登场的地方。

### 凭证的力量：从难到易

想象一下，我给你一个多项式，问它是否总是非负的。你可能会感到棘手。但如果我告诉你，这个多项式可以重写成这样：

$$ p(x) = (x^2 - 3)^2 + (2x - 1)^2 $$

答案立刻就显而易见了！这个表达式是平方项的和。由于任何实数的平方都是非负的，它们的和也必须是非负的。这是一个无可辩驳的凭证。一个可以表示为其他多项式平方之和的多项式，被称为**平方和 (SOS) 多项式**。

这提供了一个绝妙的策略：要证明一个多项式 $p(x)$ 是非负的，我们可以尝试*找到*它的 SOS 分解。如果我们成功了，我们就得到了证明。令人难以置信的飞跃在于，虽然检查非负性是困难的，但检查一个多项式是否为 SOS 在计算上是*容易的*。这里的“容易”是指即使对于非常复杂的多项式，计算机也可以高效地解决。这将一个不可能的问题转化为了一个可管理的问题。

这个魔法是如何实现的？它是通过矩阵语言重新构建问题来完成的。假设我们有一个次数为 $2d$ 的多项式 $p(x)$。我们可以构造一个向量，称之为 $z(x)$，它包含所有次数不超过 $d$ 的单项式。对于一个简单的四次单变量多项式（因此 $d=2$），这个向量将是 $z(x) = \begin{pmatrix} 1 & x & x^2 \end{pmatrix}^T$。$p(x)$ 是平方和的条件等价于能够找到一个特殊类型的矩阵 $Q$，使得：

$$ p(x) = z(x)^T Q z(x) $$

对 $Q$ 的特殊要求是它必须是**[半正定](@article_id:326516) (positive semidefinite, PSD)**的。如果对于任何向量 $v$，[二次型](@article_id:314990) $v^T Q v$ 都是非负的，那么[对称矩阵](@article_id:303565) $Q$就是半正定的。你可以将 PSD 矩阵看作是非负数的矩阵等价物。就像一个非负数有实数平方根一样，一个 PSD 矩阵 $Q$ 可以被“开方”成 $L^T L$ 的形式。将此代入我们的方程得到 $p(x) = z(x)^T L^T L z(x) = (Lz(x))^T (Lz(x))$。这就是向量 $Lz(x)$ 的分量的[平方和](@article_id:321453)！

通过将 $p(x)$ 的系数与 $z(x)^T Q z(x)$ 的展开式进行匹配，我们得到了关于 $Q$ 元素的一个线性方程组。寻找 SOS 凭证的任务就变成了寻找一个既是半正定又满足这些[线性约束](@article_id:641259)的矩阵 $Q$。这类问题被称为**[半定规划](@article_id:323114) (Semidefinite Program, SDP)**，是一类计算机可以非常高效求解的特定[凸优化](@article_id:297892)问题 [@problem_id:2721600]。这就是驱动 SOS 优化的计算引擎 [@problem_id:2751032]。

### 必要的牺牲：非负与 SOS 之间的差距

这是一个美好的故事，但自然界有一个微妙的转折。我们已经确定，如果一个多项式是 SOS，它必须是非负的。但是反过来也成立吗？是否每个非负多项式都是[平方和](@article_id:321453)？

对于单变量多项式，答案是肯定的。但正如伟大的数学家 David Hilbert 在一个多世纪前发现的，在更高维度中，答案是出人意料的“否定的”。存在一些在任何地方都非负但*不能*写成平方和的多项式。

一个经典的例子是 **Motzkin 多项式** [@problem_id:2751105]：

$$ m(x, y) = x^4 y^2 + x^2 y^4 - 3x^2 y^2 + 1 $$

你可以证明（例如，使用算术-几何平均不等式）这个多项式永远不为负。然而，它却不是平方和。这揭示了一个根本性的差距。SOS 多项式的集合是非负多项式集合的一个[真子集](@article_id:312689)。

这个差距是我们为计算易解性付出的代价。它给我们的方法带来了**保守性**。如果我们为一个像 Motzkin 多项式这样的多项式搜索 SOS 凭证，我们的程序将会失败。它找不到凭证，因为凭证根本不存在。这并不意味着该多项式是负的；这只意味着我们的*[证明方法](@article_id:308241)*不够强大。这个局限性至关重要。一个基于 SOS 的分析可能会无法证明一个系统是稳定的，不是因为它不稳定，而是因为证明其稳定性的[李雅普诺夫函数](@article_id:337681)是非负的但不是 SOS [@problem_id:2695582] [@problem_id:2751105]。

### 寻找谷底：全局优化

这种机制最直接的应用之一是寻找一个复杂多项式函数 $p(x)$ 的[全局最小值](@article_id:345300)。这是另一个众所周知的难题，因为函数可以有许多局部最小值，这些局部最小值会困住简单的优化算法。

SOS 提供了一种优美的方法来解决这个问题。全局最小值 $p^*$ 是使得多项式 $p(x) - \gamma$ 对所有 $x$ 都非负的最大数值 $\gamma$。我们不能直接检查这一点，所以我们松弛该问题：找到最大的 $\gamma$ 使得 $p(x) - \gamma$ 是一个平方和。

$$ \text{maximize } \gamma \quad \text{subject to} \quad p(x) - \gamma \text{ is SOS} $$

由于 SOS 条件可以转化为一个 SDP，我们可以高效地解决这个问题。得到的 $\gamma$ 为我们提供了一个可证明的真实全局最小值的下界。在许多情况下，这个界不仅仅是一个界——它就是确切的答案！例如，对于简单的多项式 $p(x) = x^4 + ax^2 + 1$，对于参数 $a$ 的任何值，这种方法都能完美地恢复真实的全局最小值 [@problem_id:2751032]。

### 从另一面看：对偶性与矩

在优化世界里，每个问题都有一个“对偶”问题，这是对同一个问题的不同视角，就像从不同角度看一个物体的影子。SOS 问题（寻找凭证的“原问题”）的[对偶问题](@article_id:356396)是一个关于**矩**的问题。

对偶方法不是从下至上寻找一个代数凭证来证明非负性，而是试图从上至下找到一个反例。它问道：我能否在 $x$ 的空间上构建一个“伪”[概率分布](@article_id:306824)，使得 $p(x)$ 的[期望值](@article_id:313620)尽可能低？这个分布由其矩序列表示，这些矩是单项式的“[期望值](@article_id:313620)”，例如，$y_\alpha = \mathbb{E}[x^\alpha]$。

对这些矩的约束是，它们的行为必须像来自一个真实[概率分布](@article_id:306824)的矩，这个条件令人惊奇地转化为要求一个“矩矩阵”是半正定的。对偶问题就变成了在所有有效的矩序列上最小化 $p(x)$ 的[期望值](@article_id:313620)。

[弱对偶](@article_id:342496)性是优化中的一个基本定理，它保证了这个对偶矩问题的最优值总是小于或等于原 SOS 问题的最优值。当[强对偶性](@article_id:355058)成立时（在此背景下通常如此），它们的值是相等的。

更重要的是，[对偶问题](@article_id:356396)的解——最优矩——包含了丰富的信息。它实际上可以告诉你[全局最小值](@article_id:345300)*位于何处*。通过分析最优矩序列，人们可以提取出最小值点必须满足的[代数方程](@article_id:336361)，从而有效地在图中精确定位它们 [@problem_id:2222633]。这种对偶视角不仅仅是学术上的好奇心；它是一个极其强大的工具。

### 驯服荒野：集合上的非负性

到目前为止，我们一直关注全局属性。但在许多现实世界的应用中，我们只关心在特定区域内发生的事情。例如，机器人手臂的关节角度有物理限制，或者[化学反应器](@article_id:383062)有安全操作温度。我们需要一种方法来证明一个多项式仅在一个给定的**半代数集**上非负，这个集合由多项式不等式定义，如 $\mathcal{K} = \{ x \mid g_i(x) \ge 0 \}$。

在这里，我们使用一个技巧，它是拉格朗日用于[等式约束](@article_id:354311)方法的一个推广，通常称为 **S-procedure**。为了在集合 $g(x) \ge 0$ 上证明 $p(x) \ge 0$，我们寻找一个“辅助”多项式 $s(x)$，我们知道它在该集合上是非负的，并尝试证明多项式 $p(x) - s(x)g(x)$ 是全局非负的。如果我们能做到这一点，那么对于任何满足 $g(x) \ge 0$ 的 $x$， $s(x)g(x)$ 和 $p(x) - s(x)g(x)$ 都必须是非负的，这也就迫使 $p(x)$ 也是非负的。

这个思想的 SOS 松弛是寻找一个本身是[平方和](@article_id:321453)的乘子 $s(x)$，并要求 $p(x) - s(x)g(x)$ 也是一个[平方和](@article_id:321453)。强大的定理，如 **Putinar's Positivstellensatz**，为我们提供了这种方法保证奏效的条件 [@problem_id:2751106]。具体来说，如果集合 $\mathcal{K}$ 是紧的（即有界[闭集](@article_id:296900)），并且 $p(x)$ 在 $\mathcal{K}$ 上是*严格*为正的，那么这样的 SOS 凭证就保证存在 [@problem_id:2738240]。定理要求严格为正 ($>0$) 与实际需要证明非负性 ($\ge 0$) 之间的轻微不匹配，可以通过为某个微小的正数 $\epsilon$ 证明 $p(x) + \epsilon$ 的非负性来优雅地处理 [@problem_id:2738240]。

### 攀登高峰：让 SOS 变得实用

我们讨论的原理构成了一个强大计算工具的基础。但要将其应用于现代工程中庞大而复杂的系统，必须克服几个实际障碍。这正是当今该领域最活跃的地方。

**松弛层次：** 正如我们所见，固定我们 SOS 凭证中多项式的次数会引入保守性。一个自然的想法是创建一个松弛的**层次结构**。我们可以从低次多项式开始。如果失败，我们可以增加次数再试一次。当我们允许凭证中使用越来越高次的多项式时，我们的近似变得更加准确，保守性更低，在某些条件下最终会收敛到真实答案 [@problem_id:2715972]。

**数值稳定性：** 简单的单项式基 $\{1, x, x^2, \dots\}$ 很直观，但从数值角度看却是灾难性的。随着次数的增长，这些[基函数](@article_id:307485)在像 $[-1, 1]$ 这样的区间上变得几乎无法区分，导致极端病态的矩阵，这对计算机来说是一场噩梦。解决方案是使用**正交多项式**基，如切比雪夫或勒让德多项式。这些多项式经过量身定制，具有良好的数值行为，确保我们求解的 SDP 是稳定的并给出可靠的答案 [@problem_id:2751041]。

**利用[稀疏性](@article_id:297245)：** SOS 的最大挑战是“维度灾难”。Gram 矩阵 $Q$ 的大小随变量数量和次数的增加而爆炸性增长。一个有十几个变量的问题可能在计算上变得不可能。这里的突破是利用**[稀疏性](@article_id:297245)**。在许多大型系统中，并非所有变量都直接相互作用。通过分析这种相互作用模式（**相关[稀疏图](@article_id:325150)**），我们可以将一个大到不可能的矩阵[问题分解](@article_id:336320)为一个由许多更小、可管理的矩阵问题组成的耦合系统。这是通过沿着变量交互图的“团”分解问题来完成的，这种技术使得 SOS 方法能够扩展到以前被认为遥不可及的问题 [@problem_id:2751116]。

从一个简单的想法——平方永远不为负——一个丰富而强大的理论就此展开，连接了代数、几何和优化。这是一段旅程，它带我们从数学凭证的抽象之美，走向设计稳定控制系统和解决困难优化问题的实用艺术，展示了数学思想非凡的统一性。