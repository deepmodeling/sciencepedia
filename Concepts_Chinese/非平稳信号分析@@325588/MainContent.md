## 引言
从心跳的节律到股票市场的波动，现实世界中的大多数信号都处于持续变化的状态。它们的基本属性并非恒定不变。这些信号被称为[非平稳信号](@article_id:326546)，理解其动态特性是一项重大挑战。几十年来，信号处理的主力工具都建立在一个方便但往往不正确的假设之上——平稳性，即信号的特性在时间上是恒定的。将这些经典工具应用于动态的真实世界数据，就像试图通过将一首乐曲的所有音符平均在一起来理解它一样；旋律、节奏和故事都将完全丧失。

本文旨在填补这一根本性空白，为[非平稳信号分析](@article_id:372731)领域提供一份全面的指南。我们将首先探讨[非平稳性](@article_id:359918)的原理和机制，精确阐释为何傅里叶变换等传统方法在处理演变的数据时会产生误导性甚至荒谬的结果。您将了解一套强大的现代技术，它们专为捕捉变化而设计，从[短时傅里叶变换](@article_id:332448)的[加窗](@article_id:305889)方法，到小波变换的自适应、多分辨率能力，再到经验[模态分解](@article_id:642017)的数据驱动理念。随后，我们将见证这些工具的实际应用，揭示它们如何在众多跨学科领域中解锁新的洞见，从精确定位地震、追踪生物钟，到驾驭变幻莫测的[金融市场](@article_id:303273)。

## 原理与机制

想象一下，你正试图描述一首乐曲。你会把从头到尾演奏的每一个音符都拿出来，扔进一个桶里，然后描述其平均音高吗？当然不会。那样你会失去旋律、节奏、静谧的段落和激昂的渐强。音乐的故事，即它随时间演变的方式，将荡然无存。你最终得到的将是一个毫无意义、混乱不堪的和弦。

这个简单的类比恰恰是**[非平稳信号](@article_id:326546)**所带来挑战的核心。如果一个信号的基本特性——其平均值、波动性、频率成分——随时间保持不变，则该信号被称为**平稳**信号。想象一下电力[变压器](@article_id:334261)稳定不变的嗡嗡声，它是可预测的，其统计特性是恒定的。大多数经典[信号分析](@article_id:330154)工具都是建立在这种方便的平稳性假设之上的。

但现实世界很少如此规矩。我们关心的几乎每一个信号都是非平稳的。语音是一系列频率变化的元音和辅音。[心电图](@article_id:313490)（ECG）显示的是复杂的心跳模式，而非稳定的波形。股票市场资产的价格会不可预测地漂移和跳跃。这些信号都有一个故事要讲述，一个随时间展开的故事。对[非平稳信号](@article_id:326546)使用假设其平稳的工具，就像用那个“装满音符的桶”来分析一首交响乐。你可能会得到一个数学上正确的数字，但你将完全错过音乐本身。

### 平均值的幻象

让我们把这一点说得更具体些。假设我们有一个信号，在所有负数时间里，它是一个振幅为$A$的纯余弦波；在所有正数时间里，它是另一个振幅为$B$、频率不同的余弦波[@problem_id:1752048]。如果我们计算这个信号在全部时间（从负无穷到正无穷）上的“[平均功率](@article_id:335488)”，我们会得到一个定义完美的数值：$\frac{A^2 + B^2}{4}$。这仅仅是前半部分功率与后半部分功率的平均值。

这个数学计算很简洁，但结果告诉了我们什么呢？它描述了一个从未存在过的现实。在任何时间点上，信号的实际功率都不是这个平均值。它在变化前的功率是$\frac{A^2}{2}$，变化后是$\frac{B^2}{2}$。这种全局的、[时间平均](@article_id:331618)的测量方法抹平了信号最重要的特征：它*发生过变化*这一事实。

当我们观察频率内容时，这种抹平效应变得更加明显。如果我们取一个由两个不同[平稳过程](@article_id:375000)拼接而成的信号——比如说，一个具有“红色”谱（低频功率较多），另一个具有“白色”谱（所有频率功率均等）——并计算其总的功率谱密度（PSD），结果仅仅是两个独立谱的长度[加权平均](@article_id:304268)[@problem_id:2429038]。我们得到一个既非红色也非白色的“紫色”谱。分析告诉了我们总共存在*哪些*频率，但完全抹去了*何时*出现的关键信息。

### 傅里叶变换的暴政

这个故事中的主要“罪魁祸首”是科学界最强大、最优雅的工具之一：**傅里叶变换**。傅里叶变换就像一个完美的[棱镜](@article_id:329462)，它接收一个复杂的信号，并将其分解为一系列简单的、纯粹的正弦频率。它告诉我们信号中每种频率的“含量”是多少。对于平稳信号而言，这是一个完整而优美的描述。

但傅里叶变换本质上是全局性的。它必须审视信号的整个历史，从绝对的开始到最终的结束，才能生成其[频谱](@article_id:340514)。它在一个深刻的假设下运作：信号的频率内容是永恒不变的。当面对一个频率会变化的信号时，傅里叶变换被迫给出一个单一的、[时间平均](@article_id:331618)的答案。

考虑一个“啁啾”（chirp）信号，这是一种频率随时间平滑增加的声音，就像救护车驶近又远去的警报声——“weeeooooop”。一个纯音，比如长笛吹奏的一个持续音符，其傅里叶谱会有一个尖锐的单峰。但[啁啾信号](@article_id:325926)呢？在任何给定瞬间，它的频率都是一个特定的值。但傅里叶变换一次性审视整个事件，看到了[啁啾信号](@article_id:325926)经过的所有频率。结果不是一个尖峰，而是在一个宽频率带上能量的宽泛、连续的涂抹[@problem_id:1764323]。关于频率随时间变化轨迹的信息已经丢失，被平均成了一个单一的、信息量不足的模糊团块。

### 当好工具出错时

当我们使用更复杂的、其理论基础中就植入了[平稳性](@article_id:304207)假设的分析技术时，问题会变得更深。将它们用于[非平稳数据](@article_id:325200)不仅会给出平均结果，还可能产生完全无意义的东西。

想象一位分析师试图从一个时间序列中测量一个混沌系统的“复杂性”。他们使用标准[算法](@article_id:331821)计算**[相关维度](@article_id:324049)**，该维度应能揭示[系统动力学](@article_id:309707)演化的几何对象（即**[吸引子](@article_id:338770)**）的维度。然而，他们的数据除了混沌之外，还有一个简单的、稳定的上升趋势——也许是某颗缓慢变暖的行星的温度。这个[算法](@article_id:331821)假设数据会不断返回到“相空间”的同一区域，因此被完全欺骗了。它看到数据点描绘出一条长而细、从不重复的路径，该路径由趋势主导。[算法](@article_id:331821)自信地报告说，系统的维度是1，即一条线的维度[@problem_id:1665656]。这个结果是[伪结](@article_id:347565)果；它反映的是趋势的维度，而不是潜在的[混沌动力学](@article_id:303006)。分析师将旅程误认为是目的地。

这种失败源于一个深层的理论假设。像**[Takens'定理](@article_id:322477)**这样的方法，为从单个时间序列重构系统动力学提供了基础，它要求系统的轨迹被限制在一个*固定的、紧致的[吸引子](@article_id:338770)*上[@problem_id:1714147]。一个带有趋势的[非平稳信号](@article_id:326546)，比如一个国家不断增长的GDP，从根本上违反了这一点。它的轨迹总是在向新的、更高的值移动，从不返回形成一个封闭的、重复的对象。应用这种工具就像试图绘制一个行星的稳定轨道，而你实际追踪的却是一艘永远离开太阳系的火箭飞船。

### 时间之窗：谱图

那么，我们如何解决这个问题呢？我们如何捕捉到信号变化的过程？这个想法既简单又巧妙：如果一次性观察整个信号是问题所在，那么我们就通过一个小窗口来观察它。

这就是**[短时傅里叶变换](@article_id:332448)（STFT）**的原理。我们不再对整个信号进行一次大的傅里叶变换，而是沿着信号滑动一个更短的“分析窗”，并仅对窗内可见的信号片段进行傅里叶变换。通过在滑动窗口时重复此过程，我们建立起一个二维图，显示在哪个时间点存在哪些频率。这个图被称为**谱图**（spectrogram）。

让我们回到那个频率从$f_1$突变为$f_2$的信号。全局傅里叶分析显示了两个频率峰值，但没有告诉我们它们是按顺序发生的。然而，STFT讲述了整个故事。当它的窗口在前半部分移动时，谱图在$f_1$处显示一个强能量带。当窗口穿过中点时，它看到两者的混合。而当它在后半部分移动时，它在$f_2$处显示一个强能量带。“何时”的信息被恢复了！此外，通过只关注信号中某个频率活跃的部分，STFT能正确识别其局部功率。而[全局分析](@article_id:367423)由于在整个时长（包括该频率不存在的部分）上取平均，会报告一个低得多、被稀释的峰值功率[@problem_id:1730328]。

然而，这一胜利伴随着一个著名的权衡，这是海森堡不确定性原理的直接结果。一个非常窄的时间窗能给你极好的时间定位（你确切地知道*何时*发生了某事），但[频率分辨率](@article_id:303675)很差（你不太确定它*是什么频率*）。一个宽窗能给你极好的[频率分辨率](@article_id:303675)，但会模糊时间点。天下没有免费的午餐。

### 自适应透镜：[小波变换](@article_id:356146)

STFT使用一种“一刀切”的窗口。对于包含快速高频事件和慢速低频事件的信号来说，这是一个问题。要捕捉一个短暂、尖锐的“嘀”声，你需要一个非常短的时间窗。但同样短的窗口又太短，无法准确测量一个长时、低频“嗡”声的频率。

**[小波变换](@article_id:356146)**提供了一个优雅的解决方案。它不使用固定的分析窗，而是使用一个自适应的窗。它使用一个“[母小波](@article_id:380630)”（一个短暂的、波状的形状）来分析信号，这个[母小波](@article_id:380630)可以被拉伸或压缩。为了寻找高频特征，它使用压缩的、持续时间短的[小波](@article_id:640787)，提供良好的时间分辨率。为了寻找低频特征，它使用拉伸的、[持续时间](@article_id:323840)长的小波，提供良好的频率分辨率。

这种**[多分辨率分析](@article_id:339661)**非常适合许多自然信号。考虑一个复杂的声学信号，它由一个低频嗡嗡声、一个加速的啁啾声和一个尖锐的高频嘀声组成[@problem_id:1731145]。小波变换可以生成一幅清晰无比的时频图。它会为嗡嗡声显示一条位于低频处的长水平线；为啁啾声显示一条上升的能量轨迹；为嘀声显示一个位于高频处的紧凑、局域的能量点。每个事件都以适合其自身尺度的分辨率被捕捉到。

### 消除趋势：[差分](@article_id:301764)的简单力量

有时，[非平稳性](@article_id:359918)具有非常简单的形式，比如我们之前看到的导致诸多问题的线性趋势。在这些情况下，一个异常简单的技巧通常可以使信号变得平稳。这个技术叫做**[差分](@article_id:301764)**。

我们不分析信号$Y_t$本身，而是分析相邻点之间的变化，$Z_t = Y_t - Y_{t-1}$。如果原始信号有一个线性趋势，比如说$Y_t = \alpha + \beta t + X_t$，其中$X_t$是平稳的，那么差分后的序列就变成$Z_t = (\alpha + \beta t + X_t) - (\alpha + \beta(t-1) + X_{t-1}) = \beta + (X_t - X_{t-1})$。那个随时间增长的项$\beta t$消失了！新的序列$Z_t$现在有一个恒定的均值（$\beta$）和只依赖于滞后长度的[协方差](@article_id:312296)，使其变得平稳，并适用于经典分析工具[@problem_id:1897436]。

这个技巧很强大，但需要精细操作。多应用一次——这个过程称为**过度[差分](@article_id:301764)**——可能会在数据中引入人为的模式，从而以新的方式误导分析。例如，对一个[随机游走](@article_id:303058)（一次差分即可使其平稳）进行二次[差分](@article_id:301764)，会创造出一个具有非常特定的、非随机相关结构的过程，而这个结构原本并不存在[@problem_id:1943254]。

### 超越棱镜：让信号自己说话

到目前为止讨论的所有方法——傅里叶、STFT和小波——都共享一个共同的理念：它们将信号投影到一组预定义的构建模块上，无论是[正弦波](@article_id:338691)、[加窗](@article_id:305889)[正弦波](@article_id:338691)还是[小波](@article_id:640787)。但如果信号固有的[振荡](@article_id:331484)模式看起来不像这些形状中的任何一种呢？

这个问题引出了一个根本不同且更激进的方法：**经验[模态分解](@article_id:642017)（EMD）**。该[算法](@article_id:331821)不使用任何预定义的基函数。相反，它自适应地“筛选”数据，逐层剥离出最快的[振荡](@article_id:331484)，然后是次快的，依此类推，直到只剩下一个缓慢的、单调的趋势。这些被剥离出来的每一层被称为**[本征模](@article_id:323366)[态函数](@article_id:301553)（IMF）**。这个分解过程完全由数据自身驱动[@problem_id:2868972]。

根据构造，每个IMF都表现得像一个行为良好的[调幅](@article_id:333435)-[调频](@article_id:322990)（AM-FM）信号，其振幅和频率都可以随时间变化。这使我们能够对每个IMF应用**[希尔伯特变换](@article_id:301569)**来定义一个具有物理意义的**[瞬时频率](@article_id:324021)**[@problem_id:2868972]。由此产生的时频表示，称为**[希尔伯特谱](@article_id:360387)**，不受基于傅里叶方法的分辨率权衡的限制，并且能够以惊人的清晰度揭示信号频率成分的演变[@problem_id:2868972]。

从经典工具令人沮丧的失败，到EMD的自适应、数据驱动理念，对[非平稳信号](@article_id:326546)的研究是一段尊重信号时间演化的旅程。这是一种视角的转变：从询问一个信号是由哪些固定的频率“构成”的，转而询问它的[振荡](@article_id:331484)特性是如何在每一刻生生不息、变化的。