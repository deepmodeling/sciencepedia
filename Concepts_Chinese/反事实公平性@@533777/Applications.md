## 应用与跨学科联系：透过反事实视角看世界

现在我们已经体验了因果关系和公平性的机制，让我们把它带出去兜兜风。我们实质上是打造了一种新的镜头来看待世界。我们可以将它指向何方？我们会看到什么新事物？事实证明，[反事实公平性](@article_id:641081)原则——即追问“如果情况有所不同，结果会有何不同？”——不仅仅是为有偏见的[算法](@article_id:331821)打补丁。它是一种强大的、统一的思想，为从人工智能的内部运作到[环境可持续性](@article_id:373555)的宏大挑战等一系列惊人的问题带来了清晰的思路。

我们的旅程将从你可能预料到的地方开始，在计算机内部，看这一原则如何让我们塑造出不仅智能而且负责任的[算法](@article_id:331821)。然后，我们将看到这种对公平的追求如何与对理解的追求——即让我们复杂的模型变得透明——建立起一种美好而必要的联系。最后，我们将远涉代码领域之外，去发现同样的原则在帮助我们核算我们对地球本身的影响。

### 塑造更公平的[算法](@article_id:331821)：从惩罚到[主动学习](@article_id:318217)

你如何教一台机器变得公平？你不能简单地告诉它“忽略”像种族或性别这样的敏感属性。世界是一个错综复杂的相关性网络，一个足够聪明的[算法](@article_id:331821)通常也足够聪明地找到代理变量。一个看不到“种族”的模型可能仍然使用“邮政编码”来达到同样的效果，从而延续历史偏见。这就是代理歧视问题。

反事实的视角为我们提供了更锐利的工具。我们不是告诉模型*不*要看什么，而是告诉它它的行为应该*是*什么。我们要求，即使我们想象一个反事实的世界，其中个体的敏感属性不同，其预测也应保持稳定。我们可以将这一要求直接融入模型的学习过程。在训练期间，除了做出准确预测的常规目标外，我们还可以为“反事实不稳定性”添加一个惩罚。每当模型对一个人 $x$ 和其反事实对应物 $x_{\text{text{cf}}}$ 的输出出现偏差时，它就会受到一次小小的惩戒，形式为损失惩罚。通过调整这个惩罚的大小，我们可以在纯粹的准确性和[反事实公平性](@article_id:641081)之间进行权衡，迫使模型找到那些稳健且不依赖于敏感特征或其代理变量的预测模式 [@problem_id:3145414]。

这种创建反事实的想法也可以应用于数据本身。我们模型中的许多偏见仅仅是我们提供给它们的数据中偏见的反映。例如，在自然语言中，一个模型可能仅仅通过观察文本中的历史频率，就学会将“女人”与“护士”等职业联系起来，而将“男人”与“工程师”联系起来。一种名为**反事实[数据增强](@article_id:329733)（Counterfactual Data Augmentation, CDA）**的强大技术直面了这个问题。对于训练数据中的每一句“这个男人是一位出色的工程师”，我们都创建并添加它的反事实对应句：“这个女人是一位出色的工程师。”通过向模型展示这两种现实，并告诉它核心含义（在这种情况下，是情感）是相同的，我们教会它[人口统计学](@article_id:380325)词汇不是决定性因素。这种平衡训练数据叙事世界的简单直观行为，有助于消除那些否则会被学习和放大的偏见 [@problem_id:3102498]。

到目前为止，我们一直在纠正已经产生偏见的模型。但如果我们能更主动地引导学习过程呢？这就是**[主动学习](@article_id:318217)（Active Learning）**的目标，该领域致力于智能地选择为哪些数据点获取标签，以便最有效地训练模型。传统上，人们可能会请求模型最*不确定*的数据点的标签。但反事实的视角提出了一种新策略：如果我们请求模型最*不公平*的数据点的标签会怎样？我们可以识别出那些模型预测在事实与反事实案例之间表现出最大分歧的样本。通过优先处理这些高反事实[分歧](@article_id:372077)的点，我们精确地将数据收集工作集中在模型公平性最薄弱的地方，从一开始就引导它走向对世界更公平的理解 [@problem_id:3095072]。

### 公平与理解的结合

一个完全是黑箱的公平模型，其可信度只有一半。我们还希望能够问它*为什么*做出了某个特定的决定。一个显著而令人欣喜的巧合是，我们用来实施[反事实公平性](@article_id:641081)的工具，通常也会带来更透明、更可解释的模型。这两项追求是深度交织的。

想象一下，我们用一个公平性惩罚训练了一个模型，该惩罚不鼓励它使用敏感属性。如果训练成功，我们[期望](@article_id:311378)两件事：首先，当我们翻转敏感属性时，模型的输出不应有太大变化（它具有[反事实公平性](@article_id:641081)）。其次，如果我们要求一个解释工具高亮显示某个决策的最重要特征，敏感属性不应该排在列表前列。

这正是所发生的情况。实验表明，随着我们增加公平性[正则化](@article_id:300216)，迫使敏感属性上的权重缩小，模型生成的解释自然会将其焦点从该属性上移开。该特征的归因分数——衡量其对结果重要性的指标——与[反事实公平性](@article_id:641081)的提高同步减少。换句话说，让模型的行为更公平，也使其推理过程*看起来*更公平 [@problem_id:3153155]。

因果框架使我们能够更深入地推动这种联系。有时，一个敏感属性可能对预测有“不公平”的直接影响，但也有通过其他合法变量流动的“间接”影响。例如，一个人的生活环境（敏感属性）可能会影响他们的教育水平（一个中间变量），而教育水平又会影响贷款申请的结果。解开这些路径对于实现细致的公平至关重要。利用世界的因果图，我们可以进行一种“[算法](@article_id:331821)手术”。我们可以使用像**特定路径SHAP（path-specific SHAP）**这样的高级解释方法来剖析单个预测，并精确量化其中有多少是由于直接、不公平的路径，又有多少是由于间接路径。这为我们提供了对偏见极其精细的理解，使我们不仅能看到一个模型*是否*不公平，还能看到它对特定个体*如何*以及*为何*不公平 [@problem_id:3132623]。

这种分离影响的思想是一个强有力的主题。在像[变分自编码器](@article_id:356911)（Variational Autoencoders, VAEs）这样更高级的模型中，我们可以训练模型学习一个“[解耦](@article_id:641586)的”世界内部表示，其中其抽象思维空间的一个维度对应于敏感属性，而其他维度对应于与任务真正相关的信息。通过构建一个只“听取”非敏感维度的预测器，我们可以通过设计实现公平，从一开始就控制信息的流动 [@problem_id:3116910]。

### 超越[算法](@article_id:331821)：一种通用的核算原则

你可能认为这完全是关于计算机和代码。但反事实推理的原则——即追问“否则会发生什么？”——是一种用于清晰思考的通用工具，其范围远超我们的数字世界。当我们将其应用于我们实体经济和环境的复杂、混乱的系统时，它的力量或许最引人注目地显现出来。

考虑一个现代生物精炼厂，这是一个工程奇迹，它吸收生物质，并生产出不止一种，而是多种有价值的产品——比如，[生物燃料](@article_id:354840)、富含蛋白质的动物饲料，以及用于温室的纯二氧化碳。这家工厂和任何其他工厂一样，有其环境足迹：它消耗能源并释放污染物。现在，一个关键问题出现了：总污染中有多大比例应归因于生物燃料？这不是一个学术难题；答案决定了该[生物燃料](@article_id:354840)是否能被认证为“绿色”。

幼稚的方法是发明一个随意的规则。我们应该根据每种产品的质量来分配污染吗？或者根据它们的经济价值？这些方法很简单，但它们从根本上是无原则的，并且可以给出大相径庭的答案。

反事实的视角通过迫使我们提出正确的问题来消除困惑。目标不是分割一份静态的污染清单。目标是理解我们决策的后果。正确的问题是：“如果我们决定多生产一加仑这种[生物燃料](@article_id:354840)，整个世界系统的污染*净变化*是多少？”

回答这个问题迫使我们思考什么被替代了。联合生产的动物饲料意味着在其他地方，一个农民不需要种植那么多的大豆粕。捕获的二氧化碳意味着一个温室不需要燃烧天然气来自己生成。我们这一加仑[生物燃料](@article_id:354840)的真实[环境影响](@article_id:321710)是精炼厂新增的污染*减去*因不种植那些大豆和不燃烧那些天然气而避免的污染。这种方法，在[生命周期评估](@article_id:310401)（Life Cycle Assessment, LCA）领域被称为**系统扩展**，是处理副产品最严谨的方式。而它的思想基础是什么？它不是别的，正是反事实推理 [@problem_id:2521874]。

这揭示了一种深刻的统一性。我们用来判断一个贷款[算法](@article_id:331821)是否公平的逻辑，与我们用来判断一种[生物燃料](@article_id:354840)是否可持续的逻辑是*完全相同*的。在这两种情况下，我们都在进行可以称之为“反事实核算”的操作。我们通过比较现实世界与一个精心构建的可能世界，来严谨地为结果分配责任。无论我们是评估[算法](@article_id:331821)中一个特征的影响，还是工厂中一个产品的影响，通往清晰的道路是相同的。[反事实公平性](@article_id:641081)只是这个通用原则的一个优美应用。