## 引言
现代对宇宙的理解揭示了一个由一种无形[物质主导的宇宙](@entry_id:158254)：暗物质。这种暗物质形成了一个巨大而复杂的“宇宙网”，由纤维状结构、节点和空洞组成，为我们能看到的一切提供了[引力](@entry_id:175476)支架。然而，我们的望远镜看到的不是暗物质，而是星系发出的璀璨光芒。宇宙学中的一个根本挑战是弥合这种无形结构与可见星系群体之间的鸿沟。我们如何确定哪个星系居住在哪个暗物质晕中？这种联系又如何塑造了我们观测到的宇宙？

子晕丰度匹配（Subhalo Abundance Matching, SHAM）为这个问题提供了一个优雅且非常强大的答案。它通过提出一个简单直观的“宇宙分院帽”规则来解决这一知识鸿沟：最亮的星系栖息在最重的[暗物质晕](@entry_id:147523)中，第二亮的星系栖息在第二重的[暗物质晕](@entry_id:147523)中，以此类推。这个简单的前提构成了一个复杂框架的基础，该框架用于将星系填充到[宇宙学模拟](@entry_id:747928)中，从而将理论上的[暗物质分布](@entry_id:161341)图转化为可与观测数据直接比较的真实[模拟宇宙](@entry_id:754872)。

本文将分两部分探讨子晕丰度匹配框架。首先，我们将深入探讨其核心的“原理与机制”，审视丰度匹配的基本方程、选择特定[暗物质晕](@entry_id:147523)属性的物理动机，以及为解释[潮汐剥离](@entry_id:160026)和模拟限制等现实复杂性而发展的先进技术。其次，我们将考察该模型的各种“应用与跨学科联系”，探索SHAM如何被用于预测[星系成团](@entry_id:158300)性、称量暗物质晕的质量、探究跨越宇宙时间的[星系演化](@entry_id:158840)，甚至在其他科学领域中发现其惊人的回响。

## 原理与机制

想象一下，你有两大堆物体。一堆包含了我们在宇宙一大片区域内能看到的所有星系，按亮度或者更精确地说，按[恒星质量](@entry_id:157648)（$M_\star$）排序。另一堆包含了在超级计算机对同一片天空的模拟中发现的所有暗物质晕和子晕，按它们的某种“大小”度量（我们称之为属性 $X$）排序。我们如何决定哪个星系住在哪个[暗物质晕](@entry_id:147523)里？这就是子晕丰度匹配（SHAM）旨在回答的核心问题。

### 宇宙分院帽：一个简单而强大的想法

你能想到的最简单也最强大的想法，就是一种宇宙分院帽。你宣布，宇宙中最重的星系必须居住在最重的暗物质晕中。第二重的星系居住在第二重的暗物质晕中，以此类推，贯穿整个列表。这就是SHAM的核心：星系和[暗物质晕](@entry_id:147523)之间直接的、按序[排列](@entry_id:136432)的对应关系。

我们可以更正式、更强有力地陈述这一点。我们可以分组匹配，而不是逐一匹配。我们说，质量大于某个值 $M_\star$ 的星系的*数量*必须完全等于属性 $X$ 大于某个相应值的（子）晕的*数量*。这就是SHAM的基本方程：

$$
n_{\rm gal}(>M_\star) = n_{\rm (sub)halo}(>X)
$$

在这里，$n(>...)$ 是**累积数密度**——这是一个用来表示“单位体积内大于这个值的东西有多少？”的花哨术语。所以，如果你告诉我一个[恒星质量](@entry_id:157648)，比如 $10^{11}$ 个太阳质量，这个方程就能让我找到一个精确的[暗物质晕](@entry_id:147523)属性 $X$ 的值，使得大于该值的物体的数量与星系数量相同。这就创建了星系质量和[暗物质晕](@entry_id:147523)属性之间一个完美的、单调的映射关系 [@problem_id:3492424]。

现在，出现了一个有趣的细微之处。我们的暗物质家园列表应该只包括那些巨大的、孤立的“宿主”晕，还是也应该包括那些在其中运行的较小的“子晕”？当我们将子晕添加到列表中时，我们为星系准备的潜在家园库变得更大、更拥挤。为了匹配相同数量的星系，我们必须将我们的截断值移至一个更高的 $X$ 值。这意味着，在一个包含子晕的更完整的模型中，任何给定的星系都会被分配到一个比原来更“精英”或更高 $X$ 值的暗物质晕中。竞争更加激烈了！这种效应对质量较小的星系最为显著，因为在这些星系中，子晕的数量最多 [@problem_id:3492485]。

### 何为“重”？宇宙潮汐的挑战

这就引出了我们的第一个主要难题。我们应该用什么暗物质晕属性 $X$ 来进行排序呢？最显而易见的选择可能是暗物质晕的当前质量。但这被证明是一个非常糟糕的想法，特别是对于**卫星星系**——那些已经落入一个更大宿主晕[引力](@entry_id:175476)束缚中的星系。

当一个卫星星系绕行时，它会受到其宿主巨大[潮汐力](@entry_id:159188)的冲击。这些宇宙[潮汐](@entry_id:194316)会从卫星的外部区域剥离恒星和暗物质，这个过程称为**[潮汐剥离](@entry_id:160026)**。一个曾经质量巨大的子晕可能会被剥离得只剩下其昔日辉煌的苍白影子。它当前的质量几乎不能告诉我们它曾经拥有的宏伟[势阱](@entry_id:151413)——那个负责聚集气体以形成其恒星的[势阱](@entry_id:151413)。

解决方案是使用一个不受这种落入后过程影响的暗物质晕属性。我们可以使用它首次被吸积时的质量或另一个属性，而不是它当前的质量，甚至更好的是，使用该属性在其整个历史中达到的*峰值*。常见的选择包括历史峰值质量（$M_{\rm peak}$），或者更可靠地，峰值最大[圆周速度](@entry_id:161552)（$V_{\rm peak}$）。最大[圆周速度](@entry_id:161552)，$V_{\rm max} = \max_r \sqrt{G M(<r)/r}$，是衡量暗物质晕[引力势](@entry_id:160378)阱深度的指标，并且对容易被剥离的蓬松外部区域不太敏感。使用其历史峰值，$V_{\rm peak}$，给我们提供了一个从暗物质晕最辉煌时期“冻结”下来的数值，就在[潮汐剥离](@entry_id:160026)开始产生影响之前 [@problem_id:3492445]。

通过一个简单的模型，我们可以看到这为什么如此重要。想象一个星系的[恒星质量](@entry_id:157648) $M_\star$ 与其[暗物质晕](@entry_id:147523)的 $V_{\rm peak}$ 有着根本的联系。现在，假设我们试图用它*当前*的 $V_{\rm max}$ 来预测其[恒星质量](@entry_id:157648)。由于[潮汐剥离](@entry_id:160026)，当前的 $V_{\rm max}$ 只是原始 $V_{\rm peak}$ 的一部分，而这个比例取决于卫星的具体[轨道](@entry_id:137151)——一个俯冲[轨道](@entry_id:137151)比一个宽阔、平缓的[轨道](@entry_id:137151)会引起更多的剥离。这种[轨道](@entry_id:137151)的多样性给两者关系引入了一层额外的不确定性，即**弥散**。如果我们直接使用 $V_{\rm peak}$，我们就能绕过这种环境噪声，揭示出星系与其暗物质家园之间一个更紧密、更根本的联系 [@problem_id:3492403]。

### 拥抱复杂性：弥散与现实世界的复杂性

当然，自然界从来不像一个完美的一对一映射那么简单。即使是两个峰值质量完全相同的暗物质晕，也可能有略微不同的形成历史，导致它们形成的星系具有略微不同的[恒星质量](@entry_id:157648)。这被称为**内禀弥散**。

SHAM通过[模糊化](@entry_id:260771)完美的单调关系来纳入这一点。我们不再说一个属性为 $X$ 的[暗物质晕](@entry_id:147523)*总是*拥有一个质量为 $M_\star$ 的星系，而是说它拥有一个具有*[分布](@entry_id:182848)*的可能质量的星系，通常是一个以简单映射值为中心的对数正态分布。在数学上，这涉及到一个卷积，它正确地解释了这样一个事实：陡峭的[质量函数](@entry_id:158970)意味着更多的小天体会向上弥散到高质量区域，而不是大天体向下弥散 [@problem_id:3492424]。

在实践中，实现这一点需要一个巧妙的技巧。首先从暗物质晕开始，计算它们的“理想”星系质量，然后加入一些随机弥散，接着……发现得到的星系[质量分布](@entry_id:158451)与观测到的不完全匹配！解决方案是重新排序。你将带有弥散星系质量的[暗物质晕](@entry_id:147523)列表进行排序。你也取一个从观测[分布](@entry_id:182848)中[完美抽样](@entry_id:753336)的星系质量列表并进行排序。然后，你将目标列表中的第一名星系[质量分配](@entry_id:751704)给你弥散列表中的第一名[暗物质晕](@entry_id:147523)，第二名对第二名，以此类推。这个非凡的过程，一种[逆变换采样](@entry_id:139050)的形式，让你两全其美：它通过构造完美地强制执行了观测到的星系数量，同时保留了单个星系和[暗物质晕](@entry_id:147523)之间物理上合理的、按序[排列](@entry_id:136432)的联系（带有弥散） [@problem_id:3492452]。

### 从简单规则到真实宇宙

SHAM的基本原理很优雅，但要应用它们来构建一个真正真实的宇宙模型，还需要面对更多层次的复杂性。

#### 王与臣：中心星系与卫星星系

一个安然坐落在自己巨大暗物质晕中心（一个**中心星系**）的星系，与一个被其宿主冲击的卫星星系所处的境况截然不同。它们的形成和演化是不同的，所以在我们的模型中分别处理它们是合理的。现代SHAM正是这样做的：它将观测到的[中心星系和卫星星系](@entry_id:747202)群体分别与模拟中的宿主晕和子晕群体进行匹配。对于中心星系，像 $V_{\rm max}$ 这样的当前属性就足够了。对于卫星星系，像 $V_{\rm peak}$ 这样的历史属性至关重要。这种双管齐下的方法允许一个在物理上更详细、更准确的模型 [@problem_id:3492447]。有趣的是，因为SHAM将星系与已知和形成时间相关的[暗物质晕](@entry_id:147523)属性（如与 $V_{\rm max}$ 相关的密集度）联系起来，它自然地包含了一个微妙但重要的成团效应，即**[星系形成偏向](@entry_id:749692)**，这是更简单的模型经常会忽略的一个特征 [@problem_id:3473073]。

#### 机器中的幽灵：孤儿星系解决方案

我们的计算机模拟，尽管功能强大，但其分辨率是有限的。一个模拟是由质量为 $m_p$ 的离散粒子组成的，我们通常要求一个子晕至少有 $N_{\rm min}$ 个粒子才能被可靠地识别。这就施加了一个最小可分辨质量，$M_{\rm min} = N_{\rm min} m_p$ [@problem_id:3512790]。问题在于，一个真实的子晕可能会因[潮汐剥离](@entry_id:160026)而使其质量低于这个极限，并从我们的[模拟星表](@entry_id:752048)中消失，尽管它那密集的、充满恒星的星系很可能还会存活数十亿年。这种数值上的过度并合在[星系团](@entry_id:160919)的密集内部区域最为严重。如果我们不小心，我们的[模拟星表](@entry_id:752048)将会缺失大量的内部卫星星系，这将完全破坏我们对小尺度上星系[分布](@entry_id:182848)和成团性的预测。

解决方案是另一个闪耀着科学智慧光芒的杰作：**孤儿星系**处理方法。当一个子晕的轨迹在模拟中因低于[分辨率极限](@entry_id:200378)而消失时，我们并不会放弃它的星系。我们继续将其作为一个“幽灵”或孤儿来追踪。我们利用**动力学摩擦**的物理原理来模拟其随后的[轨道](@entry_id:137151)衰减，当卫星穿过其宿主晕中的暗物[质粒](@entry_id:263777)子海洋时，动力学摩擦就像一个刹车。我们跟踪这个孤儿，直到动力学摩擦模型预测它最终应与中心星系合并，此时我们才将其从我们的星表中移除。这个过程使我们能够“复活”那些因模拟限制而被过早摧毁了其子晕家园的星系，从而描绘出一幅更准确的宇宙图景 [@problem_id:3492482]。

### 动态宇宙：跨越时间的丰度匹配

将所有这些部分——中心/卫星星系划分、历史代理属性、弥散和孤儿星系追踪——结合在一起，使我们能够构建出极其复杂的模型。SHAM不仅仅是当今宇宙的一幅静态图景。通过使用来自许多不同宇宙时期的模拟输出，并将它们与每个时期观测到的星系群体进行匹配，我们可以创建一个完全动态的模型。我们可以在高[红移](@entry_id:159945)时用星系填充暗物质晕，并跟踪它们的后代，追踪卫星星系被吸积、剥离并最终合并的过程。这使我们能够将我们在宇宙时间长河中看到的不断演变的星系织锦，与潜在的、不断演变的暗物质宇宙网联系起来 [@problem_id:3492413]。

从一个简单的分院帽规则开始，SHAM已经发展成为一个内容丰富、物理动机明确且功能强大的框架。它证明了一个简单、直观的想法，在面对宇宙的复杂现实和我们工具的局限性时，如何能演变成一种理解我们宇宙起源的精密仪器。

