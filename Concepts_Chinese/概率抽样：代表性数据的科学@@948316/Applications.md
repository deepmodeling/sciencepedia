## 应用与跨学科联系

我们花了一些时间讨论概率抽样的原理，即那些让我们通过观察一小部分就能对整个总体做出可靠推断的、清晰的数学思想。但它有什么用呢？它在现实世界中真的重要吗？答案是响亮的“是”。我们讨论的这些原则不仅仅是抽象的练习；它们是现代科学赖以建立的基础。它们是我们用来不偏不倚地审视世界的工具，从一个国家的健康状况到一片森林的结构，从疾病的起因到写在微生物基因组中的流行病史。

让我们穿越几个不同的科学领域，看看这些思想是如何变为现实的。你会看到同样的基本挑战和同样优雅的解决方案以你可能从未预料到的形式出现。

### 公共卫生：描绘一个国家健康的真实图景

想象一下，你是一位卫生部长，需要了解像乙型肝炎这样的疾病在你的国家的患病率。你如何找出答案？一个想法可能是使用医院实验室剩下的血液样本。这既便宜又容易。另一个想法可能是检测前来产前检查的孕妇。这也同样方便。但这两种方法能给你真实的图景吗？

当然不能。去医院并需要做实验室检测的人群，根据定义，就与普通人群不同；他们更有可能是生病的。孕妇样本排除了所有男性和非孕妇，并且仅限于特定年龄组。这些都是*[方便抽样](@entry_id:175175)*，它们遭受着我们所说的*[选择偏差](@entry_id:172119)*的影响。它们可能会告诉你一些关于其特定群体的有趣事情，但几乎肯定会给你一个关于整个总体的扭曲的、有偏的估计[@problem_id:4591950]。

为了获得一个无偏的视角，你必须给总体中的每个人一个已知的、非零的被选中机会。这是一项*基于总体的概率调查*的核心。它是“金标准”。这可能涉及走访家庭，创建一份居民名册，并随机选择个体参与。这更困难、更昂贵，但这是获得你能够信任的数字的唯一方法。

即使在这里，现实情况也会介入。在一个村庄里访问30户人家通常比在整个省份分散访问30户人家要容易。这被称为*整群抽样*。但为这种便利是要付出代价的。同一个村庄的人们往往比不同村庄的人更相似——他们共享暴露因素、遗传背景和生活方式。这种*组内相关性*意味着你在一个村庄里抽样的第30个人提供的新信息，要比你从一个遥远的城镇随机挑选一个人所提供的信息少一点。这种信息损失由*设计效应*（$DEFF$）来量化。如果一个整群设计的 $DEFF$ 为（比如说）1.58，这意味着你1200人的样本只具有与一个仅有 $1200 / 1.58 \approx 760$ 人的简单随机样本相同的统计功效。你用[统计效率](@entry_id:164796)换取了后勤上的便利——这是现实世界中一个常见且完全合理的权衡，但你必须将其考虑在内[@problem_id:4591950]。

### 在前线：工作场所和诊所的抽样

让我们从国家的尺度缩小到单个工厂。假设我们需要确定工人是否暴露在超过法定限值的危险溶剂中。我们应该如何对空气进行抽样？奇妙的是，答案取决于我们的目标[@problem_id:4553687]。

如果我们的目标是*检测违规行为*——找出是否*有任何人*被过度暴露——我们最好的选择是“最坏情况”抽样策略。我们会利用我们的专业知识来确定最有可能具有最高暴露水平的任务和工人，并将抽样重点放在那里。这是一种*有目的的*、非概率的样本。它对于发现问题非常高效，但对于所有工人的*平均*暴露水平，它会给出一个有严重偏差（高估）的看法。

相反，如果我们的目标是估计全体工人的真实*平均暴露水平*，我们就必须回到概率抽样。对工人-任务组合进行*简单随机抽样*将提供均值的[无偏估计](@entry_id:756289)。然而，如果一个高暴露任务很罕见，一个小规模的随机样本可能会完全错过它，从而未能检测到真正的危险。一种更复杂的方法是*[分层抽样](@entry_id:138654)*。如果我们知道不同的任务（比如说，混合、清洁和装配）有不同的暴露水平，我们可以将每个任务视为一个层。通过从每个任务组中抽样，我们可以确保所有活动都得到代表，并且通过巧妙地组合结果，通常可以用相同总样本量获得对[总体均值](@entry_id:175446)更精确的估计[@problem_id:4553687]。策略的选择不在于哪个是“正确”的，而在于哪个适合目的。

这种为创造公平比较而抽样的思想是医学研究的基石。在*病例对照研究*中，我们试图通过比较一组患有某种疾病的人（病例）和一组没有患病的人（对照）来找出病因。如果我们的病例平均年龄比[对照组](@entry_id:188599)大，我们可能会错误地得出结论，认为在老年人中常见的某种暴露会导致该疾病，而实际上罪魁祸首只是年龄。为了防止这种情况，我们可以使用*匹配*。对于每个病例，我们刻意选择一个年龄和性别相同的对照。这实际上是一种[分层抽样](@entry_id:138654)的形式，每个病例都定义了自己微小的层[@problem_id:4610256]。通过在设计阶段强制实现这种可比性，我们可以更清晰地分离出我们真正感兴趣的暴露因素的影响。在更复杂的队列研究中，这种匹配甚至可以随时间动态发生，即对于在特定时刻生病的每个人，我们从在同一时刻健康且处于风险中的所有人集合中抽样对照[@problem_id:4614199]。

### 矫正我们的视野：当[完美抽样](@entry_id:753336)不可能时

到目前为止，我们一直在谈论从头开始设计研究。但如果数据已经被收集，并且抽样存在偏差怎么办？我们注定要失败吗？不一定。如果我们了解偏差的*机制*并能够量化抽样概率，我们通常可以利用概率抽样的原理来矫正我们的视野。

想象一下，我们正在用一种新的、廉价的诊断工具与一种“金标准”测试进行比较，后者昂贵且具有侵入性。由于成本原因，我们可能决定只对一小部分参与者应用金标准。但是哪些人呢？一个常见（且有缺陷）的做法是优先验证那些在廉价工具上测试呈阳性的人。这被称为*验证偏倚*。如果我们天真地从这个有偏的验证样本中计算灵敏度和特异度，我们会得到错误的答案。具体来说，因为我们过抽样了廉价测试的阳性结果，我们会高估真实的灵敏度并低估真实的特异度[@problem_id:4832443]。

解决方案是*[逆概率](@entry_id:196307)加权* (IPW)。如果我们知道测试呈阳性的个体被抽样的概率为（比如说）0.40，而测试呈阴性的个体被抽样的概率仅为0.05，我们就可以对此进行校正。在我们的分析中，我们给验证样本中每个测试呈阴性的个体一个权重 $1/0.05 = 20$，给每个测试呈阳性的个体一个权重 $1/0.40 = 2.5$。通过分析加权数据，我们有效地重建了原始无偏队列的特征，从而使我们能够计算出真实的灵敏度和特异度[@problem_id:4832443]。我们用概率来修复有偏抽样造成的损害。

然而，我们也必须小心。有时，一个看似的偏差对于当前的问题而言并非偏差。假设一个遗传学诊所对某个[拷贝数变异 (CNV)](@entry_id:150333) 感兴趣，并且招募该CNV携带者的可能性是非携带者的5倍。如果我们使用该诊所的数据，我们对普通人群中CNV*患病率*的估计将会被严重高估。但如果我们的问题不同呢？如果我们想知道*[外显率](@entry_id:275658)*——即*在是携带者的条件下*患病的概率——该怎么办？如果诊所在携带者群体内的招募与疾病状态无关，那么*在诊所中*观察到的携带者中患病个体的比例就是对人群中真实外显率的无偏估计。[抽样偏差](@entry_id:193615)与这个特定的条件性问题无关[@problem_id:5012829]。这教给我们一个微妙但关键的教训：总是精确地思考你试图估计的概率。

### 绘制世界地图：从地景到基因组

抽样原理的适用范围之广令人惊叹。考虑一下绘制整个地景的挑战。一颗卫星为我们提供了一幅图像，一个由像素组成的网格，其中每个像素的颜色可能与某种东西相关，比如总[初级生产力](@entry_id:151277) (GPP)，这是衡量[植物生长](@entry_id:148428)的指标。为了使这张地图有用，我们必须用“地面真实”测量来校准它。但我们应该在哪里进行我们有限数量的实地测量呢？

如果我们只是[随机抽样](@entry_id:175193)，我们可能会完全错过一种罕见但生态上至关重要的生境，比如仅占该区域1%的泥炭沼泽。这将使我们地图的一个关键部分未经校准。解决方案与我们在其他情境中看到的一样：*[分层抽样](@entry_id:138654)*。我们使用卫星图像本身作为初步地图，将地景划分为不同的层（森林、农田、城市、泥炭沼泽）。然后我们可以采用*不成[比例分配](@entry_id:634725)*，在罕见的泥炭沼泽层中刻意进行比其面积所暗示的更多的抽样，确保它在我们的训练数据中得到充分代表[@problem_id:3860417]。

但还有另一层复杂性。土地覆盖具有*[空间自相关](@entry_id:177050)性*——森林中的一个点很可能被更多的森林所包围。如果我们相隔十米取两个地面样本，它们告诉我们的信息几乎是相同的。这是低效的。为了从我们宝贵的实地样本中最大化获取信息，我们应该将它们分散开。这就是*空间均衡抽样*背后的思想。与可能导致样本不幸聚集的纯粹随机性不同，像GRTS（广义[随机镶嵌](@entry_id:202718)分层）这样的设计确保我们的样本点在整个地景中均匀分布，从而以最少的努力为我们提供最多的信息[@problem_id:4528053]。

真正非凡的是，这套完全相同的思想也适用于看似遥远的人类基因组学世界。在[全基因组](@entry_id:195052)关联研究 (GWAS) 中，我们寻找与疾病相关的遗传变异。如果一个研究群体中85%是欧洲血统，15%是非洲血统，那么一个简单的随机样本将几乎没有能力检测到一个仅在非洲血统群体中与疾病相关的遗传变异。这个代表性不足的群体就像那个罕见的泥炭沼泽。解决方案是相同的：*过抽样*。我们可以有意地招募更高比例的来自代表性不足血统群体的个体。这增强了我们做出与他们相关的发现的[统计功效](@entry_id:197129)。当然，就像土地覆盖图一样，我们随后必须使用统计校正——如逆概率加权或分层分析——来确保我们的总体结论对于总人口是无偏的[@problem_id:4348565]。无论是绘制森林地图还是人类基因组图谱，同样深刻的原理确保了公平的代表性。

### 重建历史：跨越时间与疾病的抽样

也许[抽样理论](@entry_id:268394)最现代、最令人费解的应用是重建过去。当一种[传染病](@entry_id:182324)传播时，它会在病原体的基因组中留下一串突变的痕迹。通过对不同患者的病原体分离株进行测序，我们可以构建一个[系统发育树](@entry_id:140506)，它代表了疫情的传播历史。但是那棵树的形状对我们如何抽样是极其敏感的。

想象一场疫情，最初我们只对最严重病例——那些最终进入重症监护室（ICU）的病例——的病原体分离株进行测序。重症通常在感染后延迟出现。这意味着我们的样本系统性地在感染后期采集。我们完全错过了那些在早期传播疾病的无症状或轻症病例。这就好比试图通过只读每章的最后一页来理解整个故事。结果是一段被扭曲的历史。系统发育树看起来有更深的根（更古老的[共同祖先](@entry_id:175919)），传播链显得支离破碎、互不相连，因为我们错过了所有的中间环节[@problem_id:4647275]。

纠正这一点需要的不仅仅是更好的抽样；它需要一种新的思维方式。现在，*[系统动力学](@entry_id:136288)*中最先进的方法明确地对抽样过程本身进行建模。观察到遗传数据的可能性被理解为既依赖于传播的生物学过程，也依赖于人类的抽样过程。我们可以为重症病例、轻症病例甚至环境宿主指定不同的抽样概率或速率。通过用来自定植患者和环境的序列来扩充我们的数据集，并通过包含一个对此有偏的、随时间变化的抽样过程的模型，我们可以重建一幅关于疫情如何真实展开的更准确的图景[@problem_id:4647275]。

从一次简单的调查到重建一场流行病复杂历史，贯穿其中的线索是相同的。概率抽样不仅仅是一种技术；它是一种思维方式。它是从一部分了解整体、为不完美的视角进行校正、并确保在我们追求知识的过程中，我们能看到世界以及其中所有人的真实面貌的严谨艺术。