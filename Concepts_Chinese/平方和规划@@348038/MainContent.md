## 引言
在许多科学和工程的关键领域，从保障飞机安全到确保机器人系统稳定，都会出现一个根本性挑战：我们如何能确定一个复杂的多项式函数永远不会取负值？直接检查每个可能的输入是一项不可能完成的任务，这在数学模型和可证明的现实世界保证之间造成了巨大的鸿沟。本文介绍了[平方和](@article_id:321453)（SOS）规划，这是一种强大的计算技术，巧妙地弥合了这一鸿沟。它提供了一种可行的证明多项式正性的方法，将一个无限的几何问题转变为一个计算机可解的有限代数问题。接下来的章节将首先深入探讨SOS规划的核心“原理与机制”，解释它如何将非负多项式与半正定规划联系起来，其固有的局限性以及强大的扩展。随后，“应用与跨学科联系”一章将展示这种方法惊人的通用性，探讨其对控制理论、信号处理乃至理论计算机科学的深远影响。

## 原理与机制

在本质上，科学的进步往往是通过找到巧妙的方法，用更容易的问题来回答困难的问题。如果你想知道一个未知生物是否是哺乳动物，你可以对其解剖结构和遗传学进行漫长的研究。或者，你可以问一个更简单的问题：“它有毛发吗？”如果答案是肯定的，你几乎可以肯定你看到的是一只哺乳动物。这并非一个完美无缺的测试——鲸鱼的毛发并不明显——但它是一个非常高效且强大的捷径。

平方和（SOS）规划正是这样一种巧妙的捷径，它被应用于一个出了名难的数学问题：你如何能确定一个多项式函数永远不会低于零？这个问题不仅仅是学术上的好奇心；它是证明飞机安全、电网稳定或机器人可靠性的基础。

### 伟大的飞跃：从几何到代数

想象一个复杂的多项式函数 $p(x)$，一个在多维空间中延伸的山丘和山谷景观。我们希望保证这个景观永远不会降到海平面以下，即对于其变量 $x$ 的所有可能值，$p(x) \ge 0$。这是一个几何问题。检查每一个点都是不可能的。我们如何能确定没有错过某个隐藏的、深深的山谷呢？

平方和技术从这个无限的几何问题到有限的代数问题，实现了一次惊人的飞跃。它提出了一个不同的、更简单的问题：“我们能否将多项式 $p(x)$ 写成其他多项式平方的和？”

$$ p(x) = \sum_{i=1}^{k} h_i(x)^2 $$

如果我们能找到这样的表示，$p(x)$ 的非负性便不言而喻。一个实数的平方永远不可能是负数，而非负数之和也永远不可能是负数。检查无限多个点的问题被代数操作的问题所取代。

但我们如何找到这样的分解呢？这就是线性代数的魔力所在。任何偶数次（比如 $2d$ 次）的多项式 $p(x)$ 都可以写成以下形式：

$$ p(x) = v_d(x)^T Q v_d(x) $$

在这里，$v_d(x)$ 是一个包含所有次数最高为 $d$ 的单项式的向量（例如，对于两个变量且 $d=1$ 的情况，它将是 $\begin{pmatrix} 1 & x & y \end{pmatrix}^T$）。矩阵 $Q$ 是一个系数对称矩阵，称为**格拉姆矩阵（Gram matrix）**。找到这个矩阵是直接的。真正深刻的见解在于：**一个多项式是平方和，当且仅当其格拉姆矩阵可以选择为半正定的**（$Q \succeq 0$）。

一个[半正定矩阵](@article_id:315545)是指，当它作用于任何向量 $z$ 时，在[二次型](@article_id:314990) $z^T Q z \ge 0$ 中永远不会产生负结果。关键在于：检查一个矩阵是否为[半正定](@article_id:326516)是凸优化中一个可以被高效解决的标准问题，称为**半正定规划（SDP）**。突然之间，我们棘手的问题已经转变为计算机可以稳健解决的问题。

例如，在分析[非线性系统的稳定性](@article_id:328275)时，我们可能寻找一个[李雅普诺夫函数](@article_id:337681) $V(x,y)$，其[导数](@article_id:318324) $\dot{V}(x,y)$ 恒为负。通过要求 $-\dot{V}(x,y)$ 是一个[平方和](@article_id:321453)，我们可以将稳[定性分析](@article_id:297701)转化为寻找一个[半正定矩阵](@article_id:315545)，这是一项计算机可以处理的任务[@problem_id:1584541]。

### 陷阱：关于非负多项式和白乌鸦

所以，我们有了一个强大的工具。但它完美吗？是否每个非负多项式都是[平方和](@article_id:321453)？在19世纪末，伟大的数学家David Hilbert将此作为他的第17个问题提出。答案出人意料，是**否定**的。

对于单变量多项式，或任何二次多项式（2次），非负性和身为[平方和](@article_id:321453)确实是同一回事。这是一个极好的结果，因为它意味着对于使用二次[李雅普诺夫函数](@article_id:337681)分析线性系统，我们的SOS捷径是精确的——它完全没有引入任何保守性[@problem_id:2751117] [@problem_id:2751106]。

然而，对于更复杂的情况，例如一个二元六次多项式，存在“白乌鸦”——那些处处非负但不能写成多项式平方和的多项式。最著名的例子是**Motzkin多项式**：

$$ M(x, y) = x^4 y^2 + x^2 y^4 - 3x^2 y^2 + 1 $$

你可以验证 $M(x,y)$ 永不为负，但它不是平方和。这意味着，如果我们正在寻找一个稳定性证书，而真正的证书恰好是像Motzkin多项式那样的，我们的SOS测试将会失败。它会报告找不到证书，尽管一个（非SOS的）证书是存在的。所有非负多项式的集合与更小、更易于处理的SOS多项式集合之间的这种差距被称为**保守性**[@problem_id:2751117] [@problem_id:2751055]。我们的捷径是充分的，但并非总是必要的。

Artin 后来解决了 Hilbert 的第17个问题，他证明了任何非负多项式都可以写成*有理函数*（多项式的比率）的平方和。虽然这在理论上很美，但对我们的计算探索没有直接帮助，因为寻找未知的分母会导致难以解决的非凸问题[@problem_id:2751055]。

### 面向现实世界的证书：有约束的正性

在许多工程应用中，我们不需要一个在整个 $\mathbb{R}^n$ 上都成立的保证。我们关心的是一个特定的操作区域：在一个“安[全集](@article_id:327907)”$\mathcal{C}$内部，低于某个能量水平，或者在机器人关节的物理限制之内。假设我们的安全集由一个多项式不等式定义，$\mathcal{C} = \{x \mid g(x) \ge 0\}$。我们如何证明另一个多项式 $p(x)$ 仅在 $\mathcal{C}$ 内部的 $x$ 上是非负的？

这正是代数方法真正威力闪耀的地方，通过一组被称为**Positivstellensätze**（德语，意为“正性轨迹定理”）的定理。它们为集合上的正性提供代数“证明”或**证书**。最简单的版本，通常称为S-procedure，其工作方式如下：如果我们能找到一个[平方和](@article_id:321453)多项式 $\sigma(x)$ 使得 $p(x) - \sigma(x)g(x)$ 是一个[平方和](@article_id:321453)，那么我们就有一个证书，证明当 $g(x) \ge 0$ 时 $p(x) \ge 0$。为什么呢？项 $\sigma(x)g(x)$ 在 $\mathcal{C}$ 上是非负的（因为 $\sigma$ 是SOS，且 $g \ge 0$），我们又加上了另一个SOS多项式（它总是非负的）。结果必须是非负的。这使我们能够证明仅在局部成立的性质，从而极大地减少了保守性。

Schmüdgen 和 Putinar 的更高级的定理将这一思想扩展到由多个不等式 $g_i(x) \ge 0$ 定义的集合。他们证明，如果一个多项式在一个紧集上严格为正，那么它可以写成 $g_i$ 与SOS乘子的组合[@problem_id:2751086] [@problem_id:2751061]。例如，在 $g_1(x) \ge 0$ 且 $g_2(x) \ge 0$ 的集合上证明 $p(x) \ge 0$ 的证书，可能需要寻找SOS多项式 $\sigma_1, \sigma_2, \sigma_{12}$，使得 $p(x) - \sigma_1(x)g_1(x) - \sigma_2(x)g_2(x) - \sigma_{12}(x)g_1(x)g_2(x)$ 本身是一个[平方和](@article_id:321453)[@problem_id:2751061]。Putinar的版本特别受欢迎，因为它使用了更简单的证书结构，[计算效率](@article_id:333956)更高[@problem_id:2751086]。

一个微妙之处在于，这些强大的定理只保证在多项式在集合上*严格*为正（$>0$）时存在证书。如果我们只需要证明非负性（$\ge 0$），就像在稳[定性分析](@article_id:297701)中常见的那样，该怎么办？解决方案非常简单：我们只需添加一个微小的正“扰动”$\epsilon$。我们不去证明 $-\dot{V}(x) \ge 0$，而是去证明对于某个非常小的 $\epsilon > 0$，有 $-\dot{V}(x) + \epsilon > 0$。这个稍强条件的SOS证书，可以作为原始非严格不等式的一个完全有效的证明[@problem_id:2751035] [@problem_id:2738240]。

### [维数灾难](@article_id:304350)与前进之路

尽管SOS方法十分优雅，但它有一个强大的对手：**[维数灾难](@article_id:304350)**。我们需要检查的格拉姆矩阵 $Q$ 的大小随着变量数量 $n$ 和多项式次数 $d$ 的增加而爆炸性增长。仅仅为了验证一个 $n=12$ 个变量的简单4次多项式，格拉姆矩阵的大小就已经达到 $91 \times 91$。对于 $n=20$，它将是 $231 \times 231$。对于大规模系统而言，所涉及的SDP的计算成本变得望而却步[@problem_id:2695269]。

但智慧总能找到出路。研究人员已经开发了几种技术来克服这种复杂性：

1.  **[稀疏性](@article_id:297245)：** 如果一个系统具有自然的结构——例如，变量只与它们的“邻居”相互作用——那么需要认证的多项式将是稀疏的。稀疏SOS技术利用这种结构将一个巨大的SDP分解为一组小得多且相互耦合的SDP，从而使问题再次变得易于处理[@problem_id:2695269]。

2.  **更严格的松弛：** 我们可以选择在SOS锥的一个更小但计算上更简单的子集中进行搜索。**[对角占优](@article_id:304046)[平方和](@article_id:321453)（DSOS）**和**缩放[对角占优](@article_id:304046)[平方和](@article_id:321453)（SDSOS）**是两种这样的内近似。它们不要求格拉姆矩阵是半正定的（一个SDP问题），而是要求它是[对角占优](@article_id:304046)的，这个条件可以用速度快得多的线性规划（LP）或[二阶锥规划](@article_id:344862)（SOCP）来检查。这引入了更多的保守性——我们可能会找不到一个完整的SOS搜索本可以找到的证书——但计算上的节省通常是值得的。重要的是，如果找到了DSOS或SDSOS证书，它仍然是一个完全有效的非负性证明[@problem_id:2695269]。

### 窥探对偶世界：矩和测度

故事还有最后一个美妙的转折。每个优化问题都有一个“对偶”，一个提供不同视角的影子问题。寻找多项式非负性的SOS证书的对偶问题是寻找一个可以解释其值的概率测度。这就是**矩问题**。

我们不必直接尝试证明 $p(x) - p^\star \ge 0$，而是可以问：“是否存在一个[概率分布](@article_id:306824) $\mu$，其支撑集仅位于 $p(x)$ 的全局最小化点上？”SOS机制提供了一种方法来构建一系列“伪分布”（矩序列），这些序列越来越接近于回答这个问题。一个被称为**平坦扩展定理**的卓越结果给出了一个条件——对一个“矩矩阵”的秩的检查——它告诉你你的伪分布何时实际上是一个支撑在有限数量点上的真实概率测度。当这个条件满足时，它不仅证明了你已经找到了真正的全局最小值 $p^\star$，而且还能精确地告诉你所有最小化点的位置[@problem_id:2431363]。

代数（[平方和](@article_id:321453)）与分析（测度）之间的这种对偶性是现代数学中一个深刻而强大的主题。它揭示了我们检查平方和的“简单”捷径与关于几何和概率的深奥思想相联系，在它们之间架起了一座计算的桥梁。从认证机器人的安全性到揭示复杂函数的隐藏最小值，[平方和规划](@article_id:353798)证明了提出正确、更简单问题的力量。