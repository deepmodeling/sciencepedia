## 引言
在群体遗传学领域，理解一个物种的历史就如同解读一部用DNA写成的古老手稿。[位点频率谱](@article_id:343099)（SFS）是完成这项任务最基本的工具之一，它提供了群体内[遗传变异](@article_id:302405)的统计摘要——一个[直方图](@article_id:357658)。理想的分析需要知道每个遗传变异的祖先状态，以构建“展开的”SFS，从而清晰地展示[演化过程](@article_id:354756)。然而，确定这个祖先状态常常是不可能的，特别是对于非[模式生物](@article_id:340017)或古老样本，这给研究人员带来了重大的知识鸿沟。

本文通过关注一个稳健且广泛使用的替代方法来应对这一挑战：[折叠的位点频率谱](@article_id:354205)。我们将探讨这种巧妙的修改如何让遗传学家在信息不全的情况下也能继续他们的工作。接下来的章节将引导您了解这一基本概念。首先，在“原理与机制”中，我们将审视什么是折叠SFS，它是如何从其展开的对应物构建而来的，以及在[信息损失](@article_id:335658)和稳健性增益之间的关键权衡。之后，“应用与跨学科联系”将展示折叠SFS如何应用于真实世界数据，以测量[遗传多样性](@article_id:324201)、重建群体的历史，甚至[检测自然选择](@article_id:345838)的微妙足迹。

## 原理与机制

想象你是一位历史语言学家，试图追溯一个词的演变。你理想的工具将是一台完美的“时间机器”——一部古籍，告诉你这个词的原始、祖先形式。有了这个，你就能自信地描绘出导致其现代变体的每一次变化、每一次“突变”。在[群体遗传学](@article_id:306764)中，我们有类似的任务：理解我们自己DNA的历史。[位点频率谱](@article_id:343099)（SFS）是我们阅读这段历史的主要手稿。它是一个简单却极其强大的工具——一个对群体内[遗传变异](@article_id:302405)进行分类的[直方图](@article_id:357658)。

### 理想视角：遗传时间机器与展开谱

要构建信息最丰富的SFS，我们首先需要那台语言学上的时间机器。在遗传学中，这以**外群**（outgroup）的形式出现：一个[亲缘关系](@article_id:351626)密切的物种，我们可以用其基因组作为参考。通过将我们群体的序列与外群进行比较，我们可以推断出等位基因的**祖先状态**（我们远古祖先拥有的版本）和**衍生状态**（由突变产生的新版本）。

有了这些知识，我们就可以构建一个**展开的SFS**。过程很简单：对于基因组中的每个变异位点，我们计算样本中有多少个体携带*衍生*等位基因。如果我们有一个包含 $n$ 条[染色体](@article_id:340234)的样本，衍生等位基因可能出现一次、两次、三次，一直到 $n-1$ 次。（我们忽略0和 $n$ 的情况，因为这些位点在我们的样本中不是变异的）。展开的SFS只是一个条形图，显示了有多少遗传位点属于这些类别中的每一种。

那么，这个图表应该是什么样子？如果我们观察**中性**突变——即那些不影响生物体生存或繁殖的突变——理论给出了一个惊人简单的预测。衍生等位基因数量为 $i$ 的位点[期望](@article_id:311378)数与 $1/i$ 成正比 ([@problem_id:1975044])。这就形成了一个特有的“L形”：大量的位点上衍生等位基因极其罕见（一大堆数量为 $i=1$ 的“单倍体型”），随着等位基因变得越来越普遍，位点数量迅速减少。

这个直觉非常优美。每个新突变在群体中都以单倍体型的形式诞生。这些新来者中的绝大多数在几代之内就因随机机会（一个称为**遗传漂变**的过程）而丢失。它们就像彩票；大多数都毫无价值。只有一个微小的、幸运的部分会存活下来，并最终上升到更高的频率。SFS是这个持续过程的快照：一群新生儿和几个饱经风霜的幸存者。这个 $1/i$ 分布是[中性演化](@article_id:351818)的基本基线，是我们用来与所有真实世界观察结果进行比较的[零假设](@article_id:329147)。

### 当时间机器失灵：折叠的艺术

但是，当我们的时间机器坏了会怎么样？对于许多新研究的生物体，一个可靠的外群根本不存在，或者它与研究对象的[亲缘关系](@article_id:351626)太远以至于比较毫无意义 ([@problem_id:1975037])。我们在时间中迷失了方向。在一个变异位点上，我们看到两种等位基因，比如'A'和'T'，但我们无法知道哪个是祖先形式，哪个是新突变。我们无法计算衍生等位基因的数量。

我们能做什么？我们可以采用一种更保守但仍然非常有用的计算方法。我们不再计算衍生等位基因，而是计算**少数等位基因**——即在我们的样本中较不常见的版本 ([@problem_id:1974998])。例如，如果我们抽样20条[染色体](@article_id:340234)，发现15条有等位基因'A'，5条有等位基因'T'，那么少数等位基因就是'T'，其数量是5。

这个过程被称为**折叠SFS**。想象一下，展开的SFS是一把刻度为1到19的衍生等位基因计数尺（对于一个包含20个样本）。一个衍生等位基因计数为3的位点在一端。一个衍生等位基因计数为17（意味着祖先等位基因计数为3）的位点在另一端。如果我们不知道尺子的哪一端是“祖先”端，这两个位点就变得无法区分。在这两种情况下，我们都只看到一个少数等位基因计数为3的变异。我们实际上所做的就是将这把尺子在其中点对折。展开谱上的每个条目 $i$ 都与其对应的条目 $n-i$ 合并 ([@problem_id:1975034])。数学上，折叠SFS第 $j$ 个区间的位点数 $\eta_j$ 是展开SFS第 $j$ 个和第 $(n-j)$ 个区间的位点数 $\xi_j$ 和 $\xi_{n-j}$ 之和 ([@problem_id:2739397])。这意味着我们的新的、折叠的SFS的类别数量大约减少了一半，为我们提供了一幅分辨率较低的变异图景 ([@problem_id:1975010])。

### 重大的权衡：得与失

折叠行为代表了一种经典的科学权衡。我们失去了关键信息，但获得了针对某种错误的稳健性。

首先，是损失。消失的最重要的信息是区分稀有衍生等位基因和常见衍生等位基因的能力 ([@problem_id:1975037])。一个刚刚开始其旅程的新突变，看起来与一个已经接近固定的古老突变完全相同。如果我们想研究**正选择**，这是一个巨大的打击。当一个[有益突变](@article_id:356629)出现时，自然选择可以迅速将其推向高频。这个过程，称为**[选择性清除](@article_id:323187)**，在基因组中留下一个独特的印记：在有益基因周围区域出现过量的*高频衍生*等位基因。这在展开SFS的高频端表现为一个“凸起”。折叠通过将高频衍生等位基因与低频等位基因合并，完全抹去了这个信号。旨在检测这种信号的强大统计量，如[Fay and Wu's H](@article_id:362849)，在应用于折叠SFS时实际上变得毫无用处 ([@problem_id:2739338])。

但我们得到了什么？确定性。如果我们的时间机器——外群——有缺陷怎么办？这是一个真实存在的问题，称为**祖先状态错误定向**。如果我们错误地交换了祖先和衍生的标签，一个真实衍生计数为 $j$ 的位点将被错误地记录为计数为 $n-j$。这将完全扭曲展开的SFS，将计数从低频端移动到高频端，反之亦然。但请注意折叠的魔力：它本身的设计就是将区间 $j$ 和 $n-j$ 的计数相加！因此，折叠的SFS对这种对称的错误定向误差**完全免疫** ([@problem_id:2739338], [@problem_id:2750235])。无论我们弄错祖先状态的频率有多高，最终的折叠直方图都保持不变。我们用看到演化方向的能力，换来了我们*确实*看到的模式并非由错误参考造成的假象这一确定性。

### 解读折叠谱：探寻群体历史的线索

即使分辨率较低，折叠SFS也远非无用。谱的整体*形状*仍然包含着关于群体历史——其扩张、收缩和迁徙的故事——的丰富线索。为了解读这些线索，我们通常用统计量来概括SFS，其中最著名的是对比两种不同的[遗传多样性测量](@article_id:374801)方法 ([@problem_id:2732620])：

1.  **Watterson's Estimator ($\hat{\theta}_W$)**：这是从会计师的角度看待多样性。它直接根据变异位点的总数 $S$ 计算得出。它简单直观，但它平等对待所有变异位点，无论变异是单倍体型还是存在于一半的群体中。

2.  **[核苷酸多样性](@article_id:343944) ($\pi$)**：这是从概率论者的角度看待多样性。它提问：“如果我从样本中随机抽取两条[染色体](@article_id:340234)，它们在某个特定位点上拥有不同等位基因的概率是多少？”一个处于中等频率（比如50%）的变异对这个指标的贡献远大于一个罕见的单倍体型，因为它更有可能在一个随机配对中被发现。

这两个衡量标准之间的[张力](@article_id:357470)由**[Tajima's D](@article_id:346248)**捕捉，这是一个与差值 $\pi - \hat{\theta}_W$ 成比例的统计量。令人惊讶的是，这个强大的工具在折叠SFS上也能完美工作。原因是，一个位点对 $\pi$ 的贡献取决于两种[等位基因频率](@article_id:307289)的乘积，$p$ 和 $q$。这个乘积 $p \times q$ 无论哪个等位基因是哪个，都是相同的，因此它不受我们对祖先状态无知的影响 ([@problem_id:1975037])。由于 $\pi$ 和 $\hat{\theta}_W$ 都可以从折叠SFS计算得出，[Tajima's D](@article_id:346248) 也可以。

[Tajima's D](@article_id:346248) 的正负号讲述了一个故事。快速的[种群增长](@article_id:299559)历史往往会产生过量的新生、稀有突变。这使得位点数 $S$ 的增加幅度超过了成对多样性 $\pi$ 的增加幅度，从而导致**负的[Tajima's D](@article_id:346248)**。相反，一个经历过严重瓶颈（规模急剧缩小）的种群会失去大部分稀有变异，留下处于中等频率的变异。这使得 $\pi$ 相对于 $S$ 增加，从而导致**正的[Tajima's D](@article_id:346248)**。因此，即使从一个折叠谱中，我们也可以推断出我们群体过去的戏剧性历史。

### 驾驭现实世界：数据、噪音与发现

这个理论框架是现代[群体遗传学](@article_id:306764)的基石，但其在真实世界数据中的应用才是真正的技艺所在。真实数据是杂乱、不完整且充满噪音的。

一个常见的问题是**数据缺失**。由于测序技术的限制，我们常常无法在每个位点上为每个个体获得可靠的基因型。这意味着样本大小可能因位点而异。简单地将这些位点混合在一起，就像用不同尺子测量的结果取平均值。为了解决这个问题，[群体遗传学](@article_id:306764)家开发了优雅的统计方法，将样本量较大的位点的数据**投影**到一个共同的、较小的样本量上，从而确保可以从零散的数据中构建一个一致的SFS ([@problem_id:2800342])。

一个更隐蔽的问题是**测序错误**。读取DNA碱基时的随机错误可以创造一个实际不存在的“幻影”变异。这些错误几乎总是以单倍体型的形式出现在数据中。这种虚假单倍体型的泛滥会人为地造成负的[Tajima's D](@article_id:346248)，完美地模仿了种[群扩张](@article_id:373965)或[选择性清除](@article_id:323187)的信号 ([@problem_id:2822069])。要区分一个真正的生物学发现和一个技术假象，需要对SFS的预期形状有深入的理解，并对错误过程进行仔细建模。

那么我们通过折叠丢失的信息呢？它永远消失了吗？不一定。在某些情况下，我们可以尝试用统计学方法重建我们的时间机器。通过对错误定向[过程建模](@article_id:362862)并估计错误率 $\epsilon$，先进的方法可以尝试在数学上“展开”SFS，恢复对真实衍生[等位基因频率](@article_id:307289)的概率性估计，并恢复我们[检测自然选择](@article_id:345838)微妙信号的能力 ([@problem_id:2750235])。这项持续的努力表明，SFS这个简单的概念如何提供一个持久而灵活的框架，将基因组时代的嘈杂、复杂的数据转化为清晰的演化历史叙事。