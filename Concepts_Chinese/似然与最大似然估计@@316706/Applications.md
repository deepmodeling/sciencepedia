## 应用与跨学科联系

我们花了一些时间来研究[似然](@article_id:323123)的机制，但一台机器的好坏取决于它能建造什么。这个[最大似然](@article_id:306568)原理仅仅是统计理论中一个优雅的部分，一个数学家的玩具吗？事实，正如科学中常有的那样，远比这更令人惊讶和美丽。[似然](@article_id:323123)原理不是玩具；它是一把万能钥匙。它解开了隐藏在原子[抖动](@article_id:326537)、股票市场混乱舞动、我们自身 DNA 错综复杂的模式，甚至远古灾变微弱回响中的秘密。

在本章中，我们将踏上一段跨越科学领域的旅程，一次又一次地看到这一个强大的思想在起作用。在每一个新的领域，我们都会发现科学家们在问同一个简单而深刻的问题：“在我们所有可能讲述的故事中，哪一个使我们实际看到的数据最有可能发生？”

### 让不可见的世界变得可见

让我们从一个看似简单的问题开始：什么是温度？你可能会说它是温度计的读数。但它*是*什么？我们知道，气体是一群狂乱的小粒子，一场微观碰撞的混乱芭蕾。事实证明，温度不是单个粒子的属性。你不能问一个分子的温度，就像你不能问一个水分子的“湿润度”一样。温度是整个集体的统计属性；它是粒子[平均动能](@article_id:306773)的度量。

但我们看不到“真实”的温度。我们无法采访每个粒子并询问其速度。那么我们怎么可能知道它呢？假设一位实验者成功地捕获了一小份气体样本，并测量了少数几个粒子的速度。测量结果可能五花八门。用这份速度列表能做些什么呢？这正是[似然](@article_id:323123)登上舞台的地方。物理定律，特别是[麦克斯韦-玻尔兹曼分布](@article_id:304675)，提供了一个数学故事，说明在任何给定的温度 $T$ 下，粒子速度应该如何分布。对于高温，故事预测了宽范围的高速。对于低温，它预测了一簇较慢的速度。

我们测量的速度列表，只是这本故事书中撕下的一页。最大似然原理告诉我们，尝试所有可能的温度值 $T$，并对每一个值，计算观察到我们特定速度列表的概率或似然。使我们的数据最貌似合理的 $T$ 值就是我们的最佳估计。这是宇宙通过我们的数据向我们低语的温度。值得注意的是，当你完成数学推导时，这个温度的[最大似然估计](@article_id:302949)值结果与所测速度平方的平均值成正比——这优美地证实了温度与粒子平均动能相关的思想 [@problem_id:352609]。通过这种方式，[似然](@article_id:323123)使我们能够通过对微观世界的几次瞥见，来推断不可见的宏观整体的一个基本属性。

### 解码生命的蓝图

现在让我们从物理世界跳到生物学的核心。在每个活细胞内，都有一套指令库——基因组——写在称为[染色体](@article_id:340234)的长分子上。似然如何帮助我们阅读这个库的故事，是现代科学最伟大的胜利之一。

遗传学中的一个基本问题是关于位置。如果两个基因在同一条[染色体](@article_id:340234)上靠得很近，它们往往会一起被遗传。如果它们相距很远，一个称为重组的过程可以交换[染色体](@article_id:340234)的片段，使它们看起来像是独立遗传的。这种交换的概率，即重组率 $r$，是基因之间距离的度量。要构建基因组图谱，我们需要估计这些距离。

这是如何做到的呢？在一个经典的实验中，我们可以进行“测交”，繁殖生物体并简单地计算不同类型的后代。一些后代将具有亲本的性状组合，而另一些将是“重组型”的。每个后代都是一次掷骰子，得到重组型的概率是 $r$。给定重组型和亲本型后代的数量，我们对距离 $r$ 的最佳估计是什么？你可能会猜，它就是你所看到的重组后代的比例，而你是对的。但*为什么*这是正确的答案？最大似然为我们提供了严谨的基础。我们将观察到特定计数的[似然](@article_id:323123)写成 $r$ 的函数，而使这个似然最大化的 $r$ 值，确实就是重组数与总数之比这个简单、直观的比率 [@problem_id:2842612]。

但科学很少如此简单。如果我们感兴趣的基因——比如说，一个影响疾病易感性的基因——本身是不可见的怎么办？我们无法直接看到它。这就是寻找[数量性状](@article_id:305371)位点 (QTL) 的问题。然而，我们可能在[染色体](@article_id:340234)附近有可见的“路标”，称为遗传标记。这种情况就像试图在两个已知地标之间找到一个隐藏的宝藏。在这里，似然通过一种称为[期望最大化](@article_id:337587) (EM) [算法](@article_id:331821)的计算策略，施展了一个真正优美的技巧。我们从对模型参数的一个大胆猜测开始。

1.  **“E”步（[期望](@article_id:311378)）：** 给定我们当前的猜测，我们为每个个体计算其隐藏基因属于某种类型的概率。这是一种“软”分配，而不是一个硬性选择。对于个体＃1，我们可能会说，“其隐藏基因为 A 型的概率是 0.7，为 B 型的概率是 0.3。”
2.  **“M”步（最大化）：** 然后，我们通过寻找具有最大似然值的模型参数来更新它们，假设我们在 E 步中的概率分配是正确的。

我们重复这两个步骤，E-M-E-M...，在每次迭代中，我们保证会向着[似然](@article_id:323123)之巅攀登得更高，最终收敛到遗传效应的最佳估计，即使我们从未亲眼见过那个基因 [@problem_id:2824635]。这是一台由似然引擎驱动的“有根据的猜测”机器。

当然，找到一个可能的位置是一回事；对其有信心是另一回事。我们如何知道我们不仅仅是被随机性愚弄了？同样，[似然](@article_id:323123)以假设检验的形式提供了答案。我们比较两个故事：故事 A 说基因是不连锁的（$r=0.5$），故事 B 说它们以我们估计的距离（$\hat{r}$）连锁。似然比 $L(\hat{r})/L(0.5)$ 告诉我们，在故事 B 下，我们的数据比在故事 A 下要可能多少倍。出于历史和实践原因，遗传学家取这个比率的以 10 为底的对数，得到一个“LOD 得分”（优势对数）。在[人类遗传学](@article_id:325586)中，3.0 的 LOD 得分是一个长期存在的基准，它意味着在连锁的假设下，数据出现的可能性要高出 $10^3=1000$ 倍。这不仅仅是一个任意的数字；这是一个明智的惯例，旨在防止科学家在广阔的基因组中追逐幽灵，因为那里的错误线索比比皆是 [@problem_id:2863926]。

这个原理可以扩展到生物学中最宏大的问题。当我们比较不同物种的性状时——比如说，哺乳动物的大脑大小与身体大小——我们面临一个新问题：物种不是独立的数据点。人类和黑猩猩比人类和袋鼠更相似，因为它们共享一个更近的[共同祖先](@article_id:355305)。它们在“生命之树”上共享的历史造成了统计上的非独立性。[似然](@article_id:323123)框架足够强大，可以处理这个问题。我们不再假设数据点是独立的，而是建立一个模型，其中它们之间的[协方差](@article_id:312296)本身是它们在系统发育树上共享的演化历史的函数。然后，[似然](@article_id:323123)不仅允许我们估计大脑和身体大小之间的关系，还允许我们估计“[系统发育信号](@article_id:328822)”本身的强度——这个参数告诉我们共享的祖先关系对性状的影响有多强。这就是[系统发育广义最小二乘法](@article_id:638712) (PGLS)，现代演化生物学的基石，它使我们能够在尊重生命深刻、相互关联的历史的同时，正确解释生命的模式 [@problem_id:2742945]。

### 驯服混沌

从演化静谧的展开，让我们转向支配我们世界实时运转的、充满活力的过程。

思考一下股票市场。股票价格似乎是一场“[随机游走](@article_id:303058)”，一段令人眼花缭乱且不可预测的旅程。其中能找到任何秩序吗？在金融学中，一个常见的股票价格模型是[几何布朗运动](@article_id:297849)，它用两个隐藏的参数来描述价格的演变：一个漂移 $\mu$，代表平均趋势或增长率；一个波动率 $\sigma$，代表随机波动或“风险”的大小。两者都不能直接看到。我们所拥有的只是一系列过去的价格。通过观察[对数回报率](@article_id:334538)（价格的百分比变化）序列，我们可以根据 $\mu$ 和 $\sigma$ 写出观测数据的[似然函数](@article_id:302368)。找到使这个[似然](@article_id:323123)最大化的参数，就给了我们对该资产潜在趋势和风险的最佳估计，将一段混乱的历史转化为可行的洞见 [@problem_id:2397891]。

这种利用似然来洞察动态系统内部的想法具有极强的普适性。想象生态学家正在研究捕食者与猎物（如狐狸和兔子）的经典“共舞”。他们可以写下一个简单的数学模型——一组[微分方程](@article_id:327891)——来描述种群数量应如何随时间变化，这取决于[出生率](@article_id:382285)、[死亡率](@article_id:375989)以及狐狸吃兔子的速率。但这些速率是未知的。他们收集的数据——也许是每年对每种动物的计数——是稀疏且充满噪声的。他们如何找到其[生态模型](@article_id:365304)的潜在参数？他们可以使用[似然函数](@article_id:302368)将他们理想化的模型与混乱的数据联系起来。对于任何一组参数，他们的模型都会预测一个“完美”的种群轨迹。[似然函数](@article_id:302368)计算的是，在给定那个完美轨迹的情况下，看到实际的、充满噪声的数据的概率。通过搜索使这个[似然](@article_id:323123)最大化的参数，他们找到了能最好地解释现实世界的故事版本 [@problem_id:2524780]。完全相同的逻辑也适用于化学工程师为大桶中的[化学反应建模](@article_id:350703) [@problem_id:2654882]，或药理学家为药物在人体内的处理过程建模。

也许这个想法最引人注目的应用是在制导与控制领域。想象一下试图导航一艘航天器到火星。你有一个基于牛顿定律的模型，告诉你航天器*应该*在哪里。你还有来自地球上天线的充满噪声的传感器读数，告诉你航天器*似乎*在哪里。著名的卡尔曼滤波器是一种[算法](@article_id:331821)，它出色地结合了这两部分信息，以产生对航天器真实状态的最优、持续更新的估计。但似然在其中扮演什么角色呢？联系是深刻的。在每一步，滤波器都会做出一个预测。这个预测与下一个噪声测量值之间的差异称为“新息”。[卡尔曼滤波器](@article_id:305664)表明，这些新息在统计上是独立的。因此，*整个测量序列*的[似然](@article_id:323123)可以分解为每个单独新息的似然的乘积。为了找到底层模型的参数（如太阳风的影响或推进器的效率），人们可以最大化这个由卡尔曼滤波器本身即时计算出的似然。最初作为静态估计工具的东西，现在变成了在一个动态世界中进行跟踪、学习和导航的实时系统的核心 [@problem_id:2996505]。

### 在故事之间做出选择

到目前为止，我们已经使用[似然](@article_id:323123)来估计一个单一故事、一个单一世界模型中的未知数。但它的力量远不止于此：它还能帮助我们在完全不同的故事之间做出选择。

让我们回到过去，回到地球上一次巨大的灾难——二叠纪[末期](@article_id:348702)的[大灭绝](@article_id:298246)，它消灭了超过90%的海洋物种。[古生物学](@article_id:312102)家挖掘化石，并利用[地质年代](@article_id:382935)测定方法，估计许多不同物种的最后一次出现时间。每个日期都有一定程度的不确定性。一个核心问题是关于灭绝的*节奏*。它是一次单一的、灾难性的事件，比如一次巨大的小行星撞击（一个“单脉冲”模型）？还是一个更复杂的、旷日持久的过程，伴随着多波死亡，可能来自大规模的火山爆发（一个“双脉冲”模型）？

这是两个截然不同的故事。我们如何让数据告诉我们它更偏爱哪个故事？我们可以使用[似然](@article_id:323123)。对于单脉冲模型，我们找到使观察到的化石日期的[似然](@article_id:323123)最大化的单个[灭绝时间](@article_id:329768) $\tau$。对于双脉冲模型，它是一种混合模型，我们找到两个[灭绝时间](@article_id:329768) $\tau_1$ 和 $\tau_2$（以及它们的相对重要性 $\pi$），它们共同使似然最大化。

很自然，双脉冲模型因为更复杂，几乎总能更好地拟合数据。它有更多的旋钮可以调节。这种拟合度的提高是真实的，还是模型只是在“[过拟合](@article_id:299541)”噪声？这正是基于[似然](@article_id:323123)的工具——赤池[信息准则](@article_id:640790) (AIC) 发挥作用的地方。AIC 定义为 $\mathrm{AIC} = 2k - 2\ln(\hat{L})$，其中 $\hat{L}$ 是最大化的[似然](@article_id:323123)，而 $k$ 是模型中的参数数量。AIC 奖励模型获得高似然分数，但对它使用的每个参数进行惩罚。这是一种有原则的奥卡姆剃刀。我们可以为单脉冲故事和双脉冲故事计算 AIC。AIC 值较低的故事是以最少的复杂度提供最多解释力的那个故事 [@problem_id:2730629]。通过这种方式，[似然](@article_id:323123)使我们能够对生命史本身进行一种法医科学般的分析，权衡我们星球过去相互竞争的叙事的证据。

从亚原子粒子的短暂存在到地球生命史的宏大史诗，从我们基因的隐藏逻辑到我们机器中的引导智能，[似然](@article_id:323123)原理为在不确定性面前进行推理提供了一个单一、连贯且极其优美的框架。它是[科学推断](@article_id:315530)的引擎，持续不断地将原始观测转化为真正的理解。