## 引言
我们如何教计算机“看见”纹理？人类对“粗糙”或“平滑”的主观感知需要一种定量的数学语言，才能在科学分析中发挥作用。将定性的外观转化为数值数据，是图像处理领域的一大核心挑战，因为简单的度量标准往往无法捕捉复杂的结构信息。本文将通过探索一种基于“游程”（即一段连续的相似像素）这一简单概念的强大方法，来应对这一挑战。

本文将引导您了解游程分析的原理。在第一章“原理与机制”中，我们将解析灰度游程矩阵 (GLRLM) 是如何构建的，以及像短游程强调 (SRE) 这样的特征是如何被推导出来以捕捉特定纹理属性的。在第二章“应用与跨学科联系”中，我们将看到 SRE 的实际应用，探索其在医学和材料科学中的用途，并讨论那些使其成为稳健科学工具的关键考量因素。

## 原理与机制

我们如何描述我们所看到的东西？如果我向您展示两种织物，一种是光滑的丝绸，另一种是粗糙的花呢，您能立刻分辨出它们。您的大脑处理了每种材料的“纹理”。但您如何向计算机解释这种差异呢？您不能只说“这个很粗糙”。计算机，以其逻辑为本，需要的是数字。因此，我们的任务是成为翻译者，将视觉纹理这个丰富、定性的世界，转化为精确、定量的数学语言。

思考纹理最直观的方式之一是寻找重复的模式。想象一下，您的目光扫过花呢织物。您会看到一小段一种颜色，然后是另一种，接着又变回来——一种断续、不规则的模式。相比之下，丝绸则呈现出大片连续、均匀的颜色和光泽。这种“游程”——即同一事物在一条直线上的连续延伸——的简单概念，就是关键所在。这个概念是如此基础，以至于我们可以在其上构建一个强大的分析工具。

### 游程矩阵：纹理的记账员

为了量化纹理，我们首先需要做一些记录工作。让我们想象一下，我们的图像已经被简化。我们不再处理数百万种不同的颜色，而是将其量化为少数几个离散的“灰度级”，比如从 1 级（最暗）到 $G$ 级（最亮）。这就像将一堆各种色调的鹅卵石，根据颜色分到几个不同的桶里。

现在，我们选择一个方向——比如说，正右方（$0^\circ$ 方向）。我们逐行扫描图像，就像您阅读一行文字一样。每当我们遇到一段所有像素都具有相同灰度级的连续区域，我们就找到了一个**游程**。我们记下它的灰度级和长度。我们对整个图像逐行进行此操作。

我们如何处理所有这些信息呢？我们将它们整理成一个表格，一个矩阵。我们可以称之为**灰度游程矩阵 (Gray-Level Run-Length Matrix, GLRLM)**。让我们将这个矩阵称为 $R$。矩阵的行对应于灰度级（$g = 1, 2, ..., G$），列对应于游程长度（$l = 1, 2, ...$）。我们放在第 $g$ 行第 $l$ 列单元格中的数字，我们记作 $R(g,l)$，就是一个计数：它表示我们找到灰度级为 $g$、长度恰好为 $l$ 像素的游程的次数[@problem_id:5221694]。

让我们把这个概念具体化。考虑这个微小的 4x4 图像块，它已被量化为两个灰度级，1 和 2 [@problem_id:4613014]：
$$
I = \begin{pmatrix}
1  1  1  2 \\
2  2  1  1 \\
1  2  2  2 \\
2  2  1  1
\end{pmatrix}
$$

让我们来当记账员，计算水平方向的游程：
-   **第 1 行：** 一个灰度级为 1、长度为 3 的游程。一个灰度级为 2、长度为 1 的游程。
-   **第 2 行：** 一个灰度级为 2、长度为 2 的游程。一个灰度级为 1、长度为 2 的游程。
-   **第 3 行：** 一个灰度级为 1、长度为 1 的游程。一个灰度级为 2、长度为 3 的游程。
-   **第 4 行：** 一个灰度级为 2、长度为 2 的游程。一个灰度级为 1、长度为 2 的游程。

现在我们来构建我们的 GLRLM，$R(g,l)$。我们有两个灰度级 ($g=1, 2$)，可能的游程长度为 1、2 或 3。

-   **对于灰度级 1：** 我们找到了一个长度为 1 的游程，两个长度为 2 的游程，以及一个长度为 3 的游程。所以，$R(1,1)=1$, $R(1,2)=2$, $R(1,3)=1$。
-   **对于灰度级 2：** 我们找到了一个长度为 1 的游程，两个长度为 2 的游程，以及一个长度为 3 的游程。所以，$R(2,1)=1$, $R(2,2)=2$, $R(2,3)=1$。

我们的 GLRLM 表格如下所示：

| 长度 (l) → | 1 | 2 | 3 |
| :----------: |:-:|:-:|:-:|
| **灰度 (g) ↓** |   |   |   |
| **1**        | 1 | 2 | 1 |
| **2**        | 1 | 2 | 1 |

这个矩阵是图像在水平方向上纹理的数值指纹。换一个方向，比如垂直方向，很可能会产生一个完全不同的矩阵。纹理通常是具有方向性的。

### 矩阵精炼：强调长度

这个矩阵是一个很好的总结，但它仍然是一个数字表格。对于许多应用，我们希望将其精髓提炼成一个单一的、具有揭示性的数字。我们如何概括游程长度信息呢？

我们可以提出一个加权问题。我们不平等地对待所有游程，而是给某个长度的游程更多的重要性——更多的“强调”，会怎么样？这正是**游程强调**特征所做的事情。它们本质上是加权平均值，从第一性原理出发设计，旨在突出特定的纹理属性[@problem_id:3860059]。

假设我们想要一个对于“细粒度”或“斑驳”纹理值较大的特征。这类纹理充满了短游程。我们可以设计一个奖励短游程的度量。我们称之为**短游程强调 (Short Run Emphasis, SRE)**。对于我们找到的每个长度为 $l$ 的游程，我们给它一个 $1/l^2$ 的分数。长度为 1 的游程得满分 1 分。长度为 2 的游程只得 $1/4$ 分。长度为 10 的游程只得到微不足道的 $1/100$ 分。这种加权方案极大地偏爱短游程。最终的 SRE 值是图像中所有游程分数的平均值。

$$
\text{SRE} = \frac{1}{N_r} \sum_{g=1}^{G} \sum_{l=1}^{L_{\max}} \frac{R(g,l)}{l^2}
$$

这里，$N_r$ 是图像中总的游程数量，也就是我们 GLRLM 表中所有计数的总和。

反之，如果我们寻找的是“粗糙”或“条纹状”的纹理呢？这些纹理的特点是长的、同质的游程。我们可以定义一个**长游程强调 (Long Run Emphasis, LRE)** 特征来奖励长度。这一次，我们给每个长度为 $l$ 的游程一个 $l^2$ 的分数。长度为 1 的游程得 1 分，但长度为 10 的游程能得到高达 100 分！对于由长游程主导的图像，LRE 的值会很大。

$$
\text{LRE} = \frac{1}{N_r} \sum_{g=1}^{G} \sum_{l=1}^{L_{\max}} R(g,l) \cdot l^2
$$

对于我们那个 4x4 的例子矩阵，总游程数是 $N_r = 1+2+1+1+2+1 = 8$。我们可以计算 SRE 和 LRE，看看这两个互补的度量是如何描述纹理的[@problem_id:4613014]：
-   $\text{SRE} = \frac{1}{8} \left[ \left(\frac{1}{1^2} \cdot 1 + \frac{1}{2^2} \cdot 2 + \frac{1}{3^2} \cdot 1\right) + \left(\frac{1}{1^2} \cdot 1 + \frac{1}{2^2} \cdot 2 + \frac{1}{3^2} \cdot 1\right) \right] = \frac{29}{72} \approx 0.403$
-   $\text{LRE} = \frac{1}{8} \left[ \left(1^2 \cdot 1 + 2^2 \cdot 2 + 3^2 \cdot 1\right) + \left(1^2 \cdot 1 + 2^2 \cdot 2 + 3^2 \cdot 1\right) \right] = \frac{9}{2} = 4.5$

这些数字告诉我们，虽然图像混合了不同长度的游程，但较长的游程（长度为 2 和 3）对整体纹理的贡献比非常短的游程（长度为 1）更为显著，这一点由相对较高的 LRE 值所表明。

### SRE 的实际应用：短游程的惊人力量

一个科学工具的真正魅力在于它向我们展示了意想不到的东西时才得以显现。SRE 就有这种力量。

考虑一个由完美的垂直条纹组成的合成图像，条纹在两个灰度级之间交替，每个条纹的宽度恰好为 3 个像素[@problem_id:5221707]。如果我们水平分析这个图像，会发现什么？每一行中的每一个游程，其长度都恰好为 3。没有任何变化。游程长度的分布完[全集](@entry_id:264200)中在 $l=3$。SRE 的值将是 $1/3^2 = 1/9$（为简单起见，忽略归一化因子）。它正确地捕捉了水平纹理的短而均匀的特性。

现在来看一个更深刻的案例。想象一个大的二值图像，就像老式电视屏幕上的雪花，每个像素以极小的概率 $p$ 成为黑色，否则为白色[@problem_id:4564415]。由于黑色像素很罕见，图像绝大部分是白色的。一个简单的纹理度量，如**对比度**，它关注相邻像素对之间的差异，其值会非常接近于零。大多数相邻对都是白-白，所以几乎没有“对比度”。图像看起来是同质的。

但 SRE 会告诉我们什么？让我们思考一下游程。罕见的黑色像素几乎总是孤立的，像孤独的斑点一样出现。这些是长度为 $l=1$ 的黑色游程。它们之间大片的白色像素将形成非常长的游程。现在，SRE 是*每个游程*的平均值。在这个随机的景观中，每当一个黑色游程开始时，一个白色游程也必须开始。所以，短的黑色游程和长的白色游程数量大致相等。

当我们计算 SRE 时，大量的长度为 1 的黑色游程贡献了 $1/1^2 = 1$ 的分数。而大量的，比如说，长度为 100 的白色游程贡献了微不足道的 $1/100^2$ 的分数。因此，平均值被短的黑色游程所主导！当黑色像素的概率 $p$ 变得无限小时，SRE 值并不会趋于零。它接近于 $1/2$。为什么？因为一半的游程（黑色的）长度为 1，贡献分数为 1，而另一半（白色的）长度近乎无限，贡献分数为 0。平均值是 $1/2$。

这是一个了不起的结果。SRE 正确地识别了纹理的“斑点”性质，这是简单的对比度度量完全忽略掉的关键信息。这表明 SRE 捕捉了超越简单成对像素关系的高阶结构信息。

### 来自现实世界的警示

这种新获得的力量伴随着责任。因为 SRE 对短游程如此敏感，我们必须小心处理我们的图像。一个看似无害的[图像处理](@entry_id:276975)步骤可能会产生巨大且有时是意想不到的后果。

假设我们有一张带有锐利边缘的图像，比如医学扫描中组织类型之间的边界。如果我们使用**[线性插值](@entry_id:137092)**将图像[重采样](@entry_id:142583)到更精细的网格，我们会创造出新的像素，其值是其原始邻居的平均值[@problem_id:4564396]。在一个暗区和亮区之间的锐利边界上，新的插值像素将具有一个中间的灰度级。如果这个新的灰度级落入其自己独特的量化区间，我们就把一个边界分成了两个，并且在它们之间，我们创造了一个长度为 1 的新游程！这一个简单的操作就会向图像中引入大量的短游程，从而人为地夸大 SRE。一个不了解此机制的分析师可能会将这个被夸大的 SRE 误解为一个真实的生物学特征，而它仅仅是他们预处理流程的产物。

我们也可以利用这种敏感性为我们服务。在一种称为**数学形态学**的技术中，一种名为“开运算”的操作类似于打磨图像中物体的轮廓。它会移除小岛并断开细长的连接，或“瓶颈”[@problem_id:4564419]。当应用于纹理时，这个过程通过在最薄弱的点切断长的、线状的游程来系统地瓦解它们。结果呢？长游程被分割成多个较短的游程。LRE 值骤降，因为它所依赖的长游程消失了。而 SRE 值反过来通常会上升，反映了新产生的较短游程片段的群体。

这段旅程，从观察纹理的简单行为到短游程强调的微妙而强大的洞见，揭示了科学的一个核心原则。我们从直觉开始，用数学将其形式化，并在此过程中创造出工具，这些工具不仅证实了我们已知的事物，还揭示了关于我们试图测量的世界更深层次、非显而易见的真理。数字不仅仅是数字；它们是一个故事，而 SRE 则是讲述这个故事中用短游程语言书写的那一部分的方式。

