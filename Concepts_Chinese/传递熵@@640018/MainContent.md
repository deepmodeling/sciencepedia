## 引言
在探索复杂系统的过程中，一个根本性的挑战在于超越简单的相关性，以识别真正的因果影响。虽然观察到两个事件同时发生很容易，但判断一个事件是否真正引导了另一个事件，则是一个简单[统计关联](@entry_id:172897)无法解决的深层次问题。在生物学和经济学等领域，这种知识鸿沟尤为巨大，因为在这些领域中，相互作用 rarely 是线性的，并且常常隐藏在嘈杂的动态环境中。我们如何才能严格地检测到贯穿这些系统的有向信息流呢？

本文介绍了传递熵，一个源[自信息](@entry_id:262050)论的强大而普适的概念，旨在精确回答这一问题。它为衡量预测性信息传递提供了一个形式化的框架，为传统方法提供了一个稳健的替代方案。读者将学习到这种无模型方法如何揭示其他方法所忽略的隐藏联系。本文首先探讨传递熵的核心“原理与机制”，详细说明其定义方式以及为何在简单模型失效之处取得成功。随后，“应用与跨学科联系”一章将展示这一强大工具如何革[新物理学](@entry_id:161802)、神经科学、生态学等领域的研究，让科学家能够描绘出支配我们世界的无形影响网络。

## 原理与机制

在我们理解世界的征程中，我们不断地寻找联系。我们观察到一件事发生，接着另一件事随之而来。但我们如何知道第一个事件是否真正*影响*了第二个？古老的智慧告诫我们，**相关性不意味着因果关系**。冰淇淋的日销量可能与鲨鱼袭击的数量密切相关，但认为其中一个导致了另一个是愚蠢的。它们都是由一个隐藏的第三方驱动的：温暖的夏日天气。那么，我们如何才能超越简单的相关性，找到贯穿自然画卷的真正影响之线呢？

### 从预测到信息流

让我们从一个更 refined 的想法开始。如果一个过程，我们称之为$X$，真正影响了另一个过程$Y$，那么了解$X$的历史应该能帮助我们更好地预测$Y$的未来。这是一个飞躍。我们不再仅仅关注两件事同时发生；我们正在利用一个过程的过去来预测另一个过程。这正是现代[时间序列分析](@entry_id:178930)的基石——**[格兰杰因果关系](@entry_id:137286)**概念的精髓。[@problem_id:2586846]

但这个想法虽然强大，却有一个微妙的缺陷。想象一下，你正在尝试预测旧金山（$Y$）的天气。你注意到它的天气模式非常持久；如果今天有雾，明天也很可能有雾。现在，邻近城市奥克兰（$X$）的一位朋友提出要给你发送他们的天气历史。你可能会发现奥克兰的过去天气也能很好地预测旧金山的未来天气，仅仅因为两个城市的天气相似，并且都受到相同的大尺度大气系统驱动。奥克兰的天气是真正*影响*了旧金山，还是仅仅在回响旧金山自身历史已经提供的信息？

为了分離出真正的影响，我们必须提出一个更尖锐的问题：$X$的历史是否为我们提供了关于$Y$未来的任何*新*信息，而这些信息是我们无法仅从$Y$自身历史中获得的？这是关键的一步。我们正在寻找一种**信息传递**。这正是**传递熵**旨在回答的问题。

传递熵由物理学家 Thomas Schreiber 构思，它用信息论的语言重新阐述了预测性影响的问题，信息论是由 Claude Shannon 为量化通信而开创的领域。让我们将信息视为“不确定性的减少”，或者通俗地讲，是“惊喜”。

想象我们在离散的时间点 $t$ 观察一个系统。我们对于目标系统 $Y$ 在下一个时刻 $Y_t$ 的状态的不确定性， given that we know its entire past history, $Y_{t^-} = \{Y_{t-1}, Y_{t-2}, \dots \}$，可以写成一个**[条件熵](@entry_id:136761)**，$H(Y_t \mid Y_{t^-})$。这个项代表了即使在我们用 $Y$ 自身的历史来预测它之后，$Y$ 中仍然存在的内在不可预测性或“惊喜”。

现在，假设我们也被给予了潜在源系统 $X$ 的过去历史，$X_{t^-} = \{X_{t-1}, X_{t-2}, \dots \}$。我们对 $Y_t$ 的不确定性，given both histories，现在是 $H(Y_t \mid Y_{t^-}, X_{t^-})$。

从 $X$ 到 $Y$ 的传递熵，记为 $T_{X \to Y}$，就是我们不确定性的减少量：

$$
T_{X \to Y} = H(Y_t \mid Y_{t^-}) - H(Y_t \mid Y_{t^-}, X_{t^-})
$$

根据定义，这个量是一个**[条件互信息](@entry_id:139456)**，$I(X_{t^-}; Y_t \mid Y_{t^-})$。它精确地衡量了我们最初要找的东西：源的过去 $X_{t^-}$ 为目标的现在 $Y_t$ 提供了多少信息，而这些信息是*不*存在于目标自身的过去 $Y_{t^-}$ 中的。[@problem_id:3293152] 如果了解 $X$ 的历史在预测 $Y$ 时没有给我们带来任何新的优势，那么 $T_{X \to Y}$ 为零。如果有帮助，$T_{X \to Y}$ 则为正。它是一个内在有向且不对称的度量；从 $X$ 到 $Y$ 的信息流通常与从 $Y$ 到 $X$ 的信息流不同。[@problem_id:3293122]

看待这个问题的另一个优美方式是将其视为[对数似然比](@entry_id:274622)的平均值：

$$
T_{X \to Y} = \mathbb{E}\left[\log \frac{p(y_t \mid y_{t^-}, x_{t^-})}{p(y_t \mid y_{t^-})}\right]
$$

这个比率比较了两个概率：在给定 $Y$ 自身过去和 $X$ 的过去的情况下观察到 $Y$ 的下一个状态的概率，与仅给定 $Y$ 自身过去的情况下的概率。平均而言，传递熵告诉我们，来自 $X$ 的新信息使我们对 $Y$ 的结果的信心增加了多少。[@problem_id:3293152]

### 无模型方法的威力

传递熵真正的优雅之处在于其通用性。它不对相互作用的*性质*做任何假设。与依赖特定模型的方法（如线性相关性或标准[格兰杰因果关系](@entry_id:137286)）相比，这是一个深远的优势。

考虑一个简单的[基因调控网络](@entry_id:150976)，其中基因 $Y$ 的活性由前一个时间步的[转录因子](@entry_id:137860) $X$ 浓度的平方驱动，关系类似于 $Y_t = b X_{t-1}^2 + \text{noise}$。如果你去计算 $X_{t-1}$ 和 $Y_t$ 之间的简单[线性相关](@entry_id:185830)性，你会发现它为零！[线性模型](@entry_id:178302)对二次关系是盲目的。标准的线性[格兰杰因果关系](@entry_id:137286)同样会失效，结论是没有影响。[@problem_id:3331720] [@problem_id:3320050] 然而，传递熵会检测到一个强大的、正向的信息流。它不在乎关系是线性的、二次的，还是更复杂的；它只问知道 $X_{t-1}$ 是否减少了关于 $Y_t$ 的不确定性。如果是，就存在信息传递。

这种“无模型”的特性使得传递熵特别适用于生物学、神经科学和经济学等复杂、[非线性](@entry_id:637147)的世界。此外，传递熵拥有一个优美的不变性。如果你测量一个变量 $X$，然后对其应用任何可逆的[一对一变换](@entry_id:148028)（例如，取其对数或立方根），计算出的到另一个变量 $Y$ 的传递熵保持不变。[@problem_id:3331720] [@problem_id:3320050] 这是因为潜在的信息内容被保留了下来。线性方法不具备这种稳健性；它们的结果会根据测量尺度或单位的不同而发生巨大变化。

这种通用性并不意味着传递熵与旧方法相对立。事实上，它统一了它们。对于那些真正线性且具有简单[高斯噪声](@entry_id:260752)的系统——这是线性[格兰杰因果关系](@entry_id:137286)效果最好的理想世界——传递熵给出的结果与[格兰杰因果关系](@entry_id:137286)度量成正比。[@problem_id:3320050] [@problem_id:3293117] 这是一个绝佳的例子，说明了一个更普适的理论在适当的极限下如何优雅地简化为一个更简单、已确立的理论，就像 Einstein 的相对论在低速下简化为 Newton 定律一样。

### 面对复杂性时的谦卑

尽管传递熵功能强大，但它并非能够仅凭观测数据就明确揭示所有因果联系的魔杖。明智地使用它需要对其局限性有所 appreciation。

首先是古老的**未观测到的[混淆变量](@entry_id:199777)**问题。如果一个未测量的过程 $Z$（如夏日的太阳）同时驱动我们测量的过程 $X$（冰淇淋销售）和 $Y$（鲨魚襲擊），双变量分析仍然可能发现一个虚假的信息流 $T_{X \to Y} > 0$。以 $Y$ 的过去为条件会有所帮助，但它无法完全消除来自隐藏[共同原因](@entry_id:266381)的混淆。[@problem_id:3331720] [@problem_id:3293122] 我们可以将该方法扩展为多变量形式，计算以其他*观测到*的变量为条件的**部分传递熵**，但*未观测到*的[混淆变量](@entry_id:199777)的幽灵总是存在。

其次，传递熵的标准定义衡量的是从*过去*到*现在*的信息流。如果一个效应是**瞬时**的，发生的速度快于我们的采样间隔怎么办？想象一下自动化交易系统中的两只股票，其中一只的变化在微秒内引发另一只的变化。如果我们只每秒采样一次它们的价格，这个效应看起来会像是同时发生的（在零延迟时）。标准的传递熵依赖于严格的过去信息，它将对这种影响视而不见。[@problem_id:3293135] 我们的工具和我们的定义塑造了我们所能看到的东西。

最后，存在巨大的实践**估计**挑战。为了计算熵，必须从数据中估计[概率分布](@entry_id:146404)。这是众所周知的困难，需要大量数据，特别是当我们考虑的“过去”涉及许多变量或长时间滞后时——这个问题被称为**[维度灾难](@entry_id:143920)**。对于有限的数据，我们对传递熵的估计不可避免地是嘈杂的，并且可能存在系统性偏差。[@problem_id:3293105] 选择正确的方式来表示系统的“过去”——一个称为**[状态空间重构](@entry_id:271769)**的过程——本身就是一门精细的艺术，需要仔细的方法来选择正确的时间延迟和[嵌入维度](@entry_id:268956)，以“展开”系统的动力学，而不引入人为 artifacts。[@problem_id:3293127] 此外，某些数据类型，如[基因组学](@entry_id:138123)中常見的 compositional data，其中相对频率之和必须为一，在应用这些工具之前需要特殊的变换，以免我们将数学约束误认为[生物相互作用](@entry_id:196274)。[@problem_id:2545319]

总之，传递熵提供了一种严谨而 beautifully general 的方法来量化有向信息流。它将我们从相关性的模糊世界带入到 predictive information 的更有纪律的领域。它为我们提供了一个镜头，以窥探支配复杂系统（从神经元的放电到金融市场的波动）的错综复杂的影响网络。但它是一个镜头，而不是神谕。使用它时必须理解其假设，意识到其局限性，并保持所有优秀科学核心的坚定不移的怀疑精神。

