## 引言
要理解细胞动态的生命过程，仅仅了解其遗传蓝图是不够的；我们还需要知道在任何特定时刻哪些基因是活跃的。这便是转录组的角色——作为细胞活跃劳动力的全套 RNA 转录本。RNA 测序 (RNA-seq) 已成为一项革命性技术，能够全面地捕捉这种活动的快照。然而，从生物样本到有意义的基因表达数据的过程充满了挑战，从实验可变性到[计算复杂性](@entry_id:204275)。本文旨在引导读者穿越这一复杂过程。第一部分“原理与机制”将揭示 RNA 测序工作流程的核心概念，涵盖从稳健的实验设计、分子文库制备到精确的计算定量等所有方面。随后的“应用与跨学科联系”部分将展示这些原理如何付诸实践，揭示 RNA 测序如何彻底改变从基础生物学、[医学遗传学](@entry_id:262833)到[癌症免疫疗法](@entry_id:143865)和系统生物学等领域。

## 原理与机制

想象一下，为了解一个巨大、繁华都市的经济状况，你试图进行一次人口普查。你不仅想知道有多少人，还想知道他们都在*做什么*。有多少是医生，多少是面包师，多少是艺术家？这正是我们在一个生物细胞内面临的挑战。细胞就是我们的都市，其居民是数量惊人的各种分子。我们感兴趣的“职业”由基因编码，而活跃的“工作者”则是**信使 RNA (mRNA)** 分子——这些遗传蓝图的瞬时副本，将指令携带到细胞的蛋白质制造工厂。RNA 测序就是我们的人口普查，一项强大的技术，通过对这些 mRNA 分子进行计数，让我们能够捕捉到细胞在特定时刻的“劳动力”快照。

但如何准确地进行这样一次微观普查呢？从活细胞到计算机屏幕上有意义的数字，这段旅程是分子生物学和计算科学的奇迹，充满了巧妙的技巧和潜在的陷阱。让我们跟随这段旅程，揭示使其成为可能的美妙原理。

### 可靠普查的挑战：实验设计

在我们接触试管之前，就必须像统计学家一样思考。单次观察可能只是侥幸；一个稳健的结论需要周密的计划。

一个常见的错误是混淆[精确度](@entry_id:143382)与准确度。假设你想测试一种名为“Regulin”的新化合物是否会改变肝细胞中的基因活性。你处理了一瓶细胞，提取了 RNA，并且为了谨慎起见，你将这个 RNA 样本测量了三次。所有三次测量结果都完全一致，显示出巨大的变化。这是一次胜利吗？不完全是。你所证明的只是你的测量设备是稳定的。这些是**技术重复**，它们测试的是你方法的可靠性。你并没有了解到“Regulin”是否*普遍*具有这种效果，或者仅仅是那一瓶特定的细胞有什么异常。要提出真正的生物学主张，你需要**生物学重复**：独立地处理三*瓶不同*的细胞。这是区分真实生物学效应与随机生物学变异的唯一方法 [@problem_id:1530922]。

当我们处理这些多个样本时，挑战会加深。想象一下，我们“[对照组](@entry_id:188599)”的三瓶细胞是由一位心情愉快的技术员在一个晴朗的周一制备的，而“处理组”的三瓶细胞则是由一位疲惫的技术员在一个下雨的周五制备的。如果我们观察到差异，这是由于我们的化合物，还是由于日期、天气、技术员，或是使用的不同批次的化学品？这种与分组处理样本相关的不希望出现的系统性技术变异被称为**批次效应** [@problem_id:4605835]。这些效应是我们数据中潜伏的“小恶魔”，它们制造出的模式与我们想要研究的生物学毫无关系。一个设计良好的实验会巧妙地将样本随机化——将处理组和[对照组](@entry_id:188599)的样本混合在不同的日期、由不同的技术员、使用不同的试剂批次进行处理——以确保生物学因素，而非实验环境，是各组之间唯一一致的差异。

### 从细胞到测序仪：捕获信息

有了稳健的实验设计，我们第一个实际步骤是捕获感兴趣的分子。这就像试图在一场震耳欲聋的摇滚音乐会上录下悄声的交谈。“悄声”是我们关心的 mRNA，而“摇滚音乐会”则是**核糖体 RNA (rRNA)**。虽然 mRNA 分子是动态的信使，但 rRNA 构成了核糖体（细胞的蛋白质工厂）的静态结构。在一个典型的细胞中，rRNA 可占总 RNA 质量的 80% 以上。如果我们对所有东西进行测序，我们绝大部分的努力将浪费在计数无处不在的 rRNA 上，从而淹没了来自 mRNA 的微弱但珍贵的信号 [@problem_id:1530941]。因此，大多数 RNA 测序方案中一个关键的首要步骤是去除 rRNA，可以通过特异性地降解它，或者选择性地富集 mRNA。

这一富集步骤揭示了“RNA 测序”并非单一方法，而是一个为不同问题量身定制的技术家族。虽然真核生物中的大多数 mRNA 都有一条长的“聚[腺苷](@entry_id:186491)酸”尾巴，这是一种我们可以抓住的分子“把手”（一种称为 **poly(A) 筛选** 的方法），但许多其他有趣的 RNA 分子却没有。RNA 的世界简直是一个物种多样的动物园：有调控其他基因的**长链非编码 RNA (lncRNA)**，有作为基因表达分子调光器的微小 **microRNA ([miRNA](@entry_id:149310))**，甚至还有形成闭环的奇异**环状 RNA ([circRNA](@entry_id:191128))**。为了捕获这整个“动物园”，科学家必须使用不同的策略。为了找到 [miRNA](@entry_id:149310)，我们可能会筛选非常小的分子。为了获得最全面的视图，包括那些缺少 poly(A) 尾的 [lncRNA](@entry_id:194588) 和 [circRNA](@entry_id:191128)，我们会使用 **rRNA 去除** 方法，该方法能去除核糖体噪音，但保留其他所有成分 [@problem_id:5157647]。方法的选择从根本上决定了我们能观察到细胞经济的哪个部分。

一旦我们捕获了所需的 RNA，我们又面临另一个问题：RNA 是一种内在不稳定的分子，就像写在可溶纸上的信息。我们用于复制和读取遗传信息的强大工具——即**[聚合酶链式反应](@entry_id:142924) (PCR)** 和大多数测序仪——是为更具化学稳定性的 DNA 设计的。解决方案是一项精妙的分子生物学技术，一种名为**[逆转录酶](@entry_id:137829)**的酶。这种酶的作用正如其名：它读取 RNA 模板[并合](@entry_id:147963)成一条相应的 DNA 链。这种**互补 DNA (cDNA)** 是细胞瞬时 RNA 信息的稳定、持久的记录，创建了一个可以储存、扩增和分析的细胞活动“文库” [@problem_id:1520775]。

### 从分子到数字：计数的艺术

有了稳定的 cDNA 文库，我们需要生成足够的材料供测序仪读取。我们通过使用 PCR 扩增文库来做到这一点。然而，PCR 并非一个完全公平的过程；由于随机机会或其化学性质，一些分子比其他分子更容易被复制。这种**扩增偏好**对我们的人口普查来说是一个严重的问题。如果一个面包师的信息被复制了 10,000 次，而一个医生的信息只被复制了 100 次，我们最终的计数将严重失真，导致我们相信面包师主导着城市的经济，而实际上可能并非如此。

解决这个问题的方法是一个极其巧妙的技巧：**[唯一分子标识符 (UMI)](@entry_id:265196)**。在扩增之前，我们文库中的每个 cDNA 分子都被标记上一个短的、独特的、随机的核苷酸序列——一个分子名牌。现在，我们可以随心所欲地扩增文库。测序后，我们不只是计算读段。相反，我们的软件会根据 UMI 对所有读段进行分组。一千个读段可能共享同一个 UMI，但因为它们都来自同一个原始分子，所以它们被合并计为一次。这个去重复过程使我们能够直接计算原始分子，完全绕过了 PCR 扩增的偏好 [@problem_id:2045433]。这是一个绝佳的例子，展示了巧妙的分子记账方法如何解决一个深远的[测量问题](@entry_id:189139)。

完成所有这些之后，我们终于得到了原始计数。但是，一个基因的原始计数“500”本身是毫无意义的。它必须被标准化。首先，不同样本的测序“深度”不同——一个样本可能产生 2000 万条总读段，另一个则有 4000 万条。其次，在许多实验设置中，较长的基因自然会比较短的基因产生更多的片段。为了解决这个问题，像**[每百万转录本](@entry_id:170576) ([TPM](@entry_id:170576))** 这样的方法被开发出来。[TPM](@entry_id:170576) 的逻辑是首先用基因长度对每个基因的计数进行标准化，然后再用总[测序深度](@entry_id:178191)进行标准化。这将原始计数转换为一个比例——即该基因在总“转录组”中所占的份额。因为一个样本中所有 TPM 值的总和总是一百万，它为跨不同样本比较基因比例提供了一个稳定的度量 [@problem_id:4611316]。

但在这里我们看到了过程的深层统一性。分析必须始终遵循实验方法。如果我们使用了 UMI，我们计算的是*分子*，而不是片段。在这种情况下，转录本的长度是无关紧要的——一个长转录本和一个短转录本都只是一个分子。将像 [TPM](@entry_id:170576) 这样的长度标准化方法应用于 UMI 数据将是一个错误；它会人为地对较长的基因进行惩罚，扭曲我们试图揭示的真相 [@problem_id:4591078]。

### 从读段到基因：计算侦探工作

测序仪为我们提供了数百万个短的遗传密码串——即读段。现在，计算侦探工作开始了：找出每个读段的来源。为此，我们需要两个关键项目：一张地图和一个图例。**参考基因组**是我们的主地图，即该生物体的完整 DNA 序列。**[基因注释](@entry_id:164186)文件**（通常是 GTF 格式）是我们的图例，告诉我们地图上所有已知基因、外显子和其他特征的坐标 [@problem_id:2336623]。

有几种策略可以用于比对我们的读段：
*   **基因组比对：** 这是最彻底的方法。一个可识别剪接的比对工具就像一名侦探，煞费苦心地尝试将每个读段放置到基因组图谱上。由于真核生物中的基因被不编码的内含子打断，一个读段可能会跨越两个外显子。比对工具足够聪明，能够“分割”读段，并将其各部分映射到基因组上两个不同的位置，从而揭示剪接点。这种方法计算量很大，但它是发现新的、未注释的基因或剪接变体的唯一途径。
*   **转录组比对：** 这是一种更快但探索性较差的方法。我们不使用整个基因组，而是将[读段比对](@entry_id:265329)到所有已知转录本序列的预编译列表上。这就像根据一个已知的目录匹配地址。它对于定量来说快速高效，但根据定义，它无法发现任何目录中没有的东西。
*   **伪比对：** 这是定量中的“速度之王”。它是一种“免比对”方法，将读段分解为称为 $k$-mers 的 DNA 短词。它使用一个巧妙的索引来快速确定一个读段不只是精确映射到哪里，而是与哪*组*转录本兼容。通过分析这些兼容性集合，它能以极快的速度估算转录本丰度，尽管它牺牲了真实比对的碱基水平分辨率和发现潜力 [@problem_id:5037017]。

巧妙之处不止于此。DNA [双螺旋](@entry_id:136730)有两条链，基因可以朝相反的方向运行，有时甚至重叠。这就产生了一个[歧义](@entry_id:276744)：如果一个读段映射到一个重叠区域，它来自哪个基因？**链特异性 RNA 测序**方案解决了这个难题。在文库制备过程中，会根据读段是来自 cDNA 的第一条链还是第二条链，施加一个化学标记。例如，在广泛使用的 dUTP 方法中，我们知道一对读段中的 Read 2 将总是映射到与原始 RNA 分子相同的链上。这个信息就像一个指南针，让我们能够明确地将读段分配给其来源基因，将一个混乱的重叠变成一个已解决的案例 [@problem_id:3311837]。

### 确保旅程可重复：可追溯性原则

我们已经完成了从细胞到计数的旅程。但科学不是一次私人的旅行；它是一场公共的对话。一个结果只有在另一位研究者，在给予相同起始材料的情况下，能够遵循我们的步骤并到达相同目的地时，才真正具有科学性。对于像 RNA 测序这样复杂的多步骤分析，这提出了一个巨大的挑战。这就是**计算[可重复性](@entry_id:194541)**的原则。

为了确保这一点，我们必须捕获分析的**可追溯性**（provenance）——一份其沿袭的完整记录。仅仅说我们使用了“人类基因组”和“STAR 比对工具”是不够的。我们必须记录所使用的基因组和注释文件的确切版本，并通过加密校验和进行验证。我们必须记录每个软件工具的精确版本，以及使用的*每一个参数*。并且我们必须捕获计算环境本身——操作系统及其所有依赖项——通常使用像 [Docker](@entry_id:262723) 容器这样的工具。这份完整、明确的“计算配方”是使科学可验证和可信赖的原因 [@problem_id:5088481]。它是现代科学家的实验记录本，确保我们的发现之旅不是昙花一现的幻象，而是一条可靠的路径，用以构建对生命世界累积而持久的理解。

