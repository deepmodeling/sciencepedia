## 引言
求解多相互作用电子系统的薛定谔方程是现代化学、物理学和[材料科学](@article_id:312640)的基石。然而，精确的确定性解法面临着“维度灾难”：计算成本随系统规模呈指数增长，使得除最小的系统外，所有系统都变得难以处理。这造成了巨大的知识鸿沟，限制了我们准确预测[电子相关性](@article_id:303092)强的复杂分子和材料性质的能力。本文介绍[全组态相互作用量子蒙特卡洛](@article_id:362990)（[FCIQMC](@article_id:370947)），这是一种通过随机方法重构问题来回避指数墙的革命性方法。[FCIQMC](@article_id:370947)并不存储大到不可能的[波函数](@article_id:307855)，而是释放出一群虚拟的“行走子”，它们共同对[波函数](@article_id:307855)进行采样，通过一套简单的概率规则找到[基态](@article_id:312876)。在接下来的章节中，您将学习[FCIQMC](@article_id:370947)背后的核心原理，从其对[虚时间](@article_id:299075)的使用到其行走子布居的迷人动力学。然后，我们将探讨其强大的应用，从[化学键](@article_id:305517)的断裂到其与更广泛的量子模拟方法生态系统的联系。

## 原理与机制

### 虚时投影算符：通往[基态](@article_id:312876)之旅

量子力学的核心是著名的薛定谔方程，它支配着系统如何随[时间演化](@article_id:314355)。但如果我们不关心演化本身，而只关心系统最稳定的构型，即其**[基态](@article_id:312876)**呢？[基态](@article_id:312876)是能量最低的状态，也是所有[自然系统](@article_id:347844)在冷却后最终会达到的状态。为了找到这个状态，我们可以采用一个巧妙的数学技巧。我们取薛定谔方程，并进行一个简单的替换：我们用虚时间 $\tau = it/\hbar$ 来代替实时间 $t$。

这看起来可能像一个抽象、不符合物理的戏法。但它的作用是把薛定谔方程中类似波的[振荡](@article_id:331484)特性转变为一个类似扩散的方程：
$$
\frac{\partial}{\partial\tau} |\Psi(\tau)\rangle = -\hat{H} |\Psi(\tau)\rangle
$$
该方程的解涉及一个算符 $\exp(-\hat{H}\tau)$。让我们想象一下这个算符对一个任意的初始[波函数](@article_id:307855) $|\Psi(\tau=0)\rangle$ 会做什么。我们可以将任何状态看作是由系统的基本“音符”——[能量本征态](@article_id:312568) $|\phi_n\rangle$（其能量为 $E_n$）——组成的“和弦”。当我们应用虚时算符时，和弦中的每个音符都会被一个因子 $\exp(-E_n\tau)$ 衰减。

对于任何正的虚时间 $\tau$，能量 $E_n$ 越高，该分量的衰减就越严重。当 $\tau$ 变得很大时，对应于最高能量的分量几乎被完全抹去。次高的分量也会被抹去，但程度稍轻。这个过程沿着能量阶梯向下延续，直到只剩下一个分量，其衰减速度比所有其他分量都慢：这就是[基态](@article_id:312876) $|\phi_0\rangle$，其能量为最小的 $E_0$。这个[虚时演化](@article_id:343834)就像一个普适的过滤器，或者说**投影算符**，它不可阻挡地提纯任何初始态，最终只留下纯粹的[基态](@article_id:312876)。这在数学上等同于一个系统冷却到绝对[零度](@article_id:316692)。

### [维度灾难](@article_id:304350)与随机方法的飞跃

这种投影方法在原理上非常强大。然而在实践中，我们很快就遇到了障碍。为了在计算机上实现它，我们必须在一个选定的[基组](@article_id:320713)中表示我们的[波函数](@article_id:307855)。对于一个多相互作用电子系统，自然的[基组](@article_id:320713)是所有可能的将 $N$ 个电子排布在 $M$ 个可用单电子态（或称“[自旋轨道](@article_id:349245)”）上的方式的集合。每一种遵循[泡利不相容原理](@article_id:302291)的排布方式都是一个**[斯莱特行列式](@article_id:299482)** $|D_i\rangle$。

我们那个优美而抽象的方程，就变成了一个关于每个[行列式](@article_id:303413)系数 $C_i$ 的庞大的耦合[线性微分方程组](@article_id:315707)。这个方程中的矩阵是哈密顿量 $\mathbf{H}$，它描述了所有[行列式](@article_id:303413)之间的相互作用。问题就在这里：[行列式](@article_id:303413)的数量，也就是这个矩阵的维度，随着电子和轨道数量的增加而组合式增长。根据第一性原理推导，这个空间的规模简直是天文数字 [@problem_id:2803756]。即使对于一个像水这样大小适中的分子，使用一个不错的[基组](@article_id:320713)，[行列式](@article_id:303413)的数量也可能轻易超过地球上的原子数量。这就是臭名昭著的**[维度灾难](@article_id:304350)**。存储[波函数](@article_id:307855)向量，更不用说将其与巨大的[哈密顿矩阵](@article_id:296687)相乘，对于除最小系统之外的所有系统来说，在计算上都是不可能的。确定性方法在开始之前就已经失败了。

这正是[全组态相互作用量子蒙特卡洛](@article_id:362990)（[FCIQMC](@article_id:370947)）做出革命性且卓越突破的地方。如果我们无法写下[波函数](@article_id:307855)，也许我们根本就不需要这么做。如果我们不将这个长得无法想象的系数向量 $\mathbf{c}$ 表示为内存中的数字，而是表示为一个由离散、点状实体组成的动态、波动的布居呢？我们称这些实体为**行走子**。

每个行走子都是一个带符号的整数（$+1$ 或 $-1$），它“居住”在某个特定的斯莱特行列式 $|D_i\rangle$ 上。该[行列式](@article_id:303413)上的[波函数](@article_id:307855)振幅 $C_i$ 被认为与当前居住在那里的行走子的净符号布居 $N_i$ 成正比。[波函数](@article_id:307855)不再是一个静态、庞大的向量，而是一个由成千上万、甚至数百万个不断移动、复制和死亡的行走子组成的活生生的群体。问题是，我们能否为这个群体定义一套规则，使其集体的平均行为能精确地再现虚时投影？答案惊人地是肯定的。

### 游戏规则：行走子的一生

[FCIQMC](@article_id:370947)的核心是一个简单的随机博弈，其规则是虚时薛定谔方程中各项的直接转换。在一个小的时间步长 $\Delta\tau$ 内，精确[波函数](@article_id:307855)系数 $C_i$ 的变化由下式给出：
$$
C_i(\tau+\Delta\tau) \approx C_i(\tau) - \Delta\tau \sum_j H_{ij} C_j(\tau) + \Delta\tau S C_i(\tau)
$$
在这里，$S$ 是一个关键参数，称为**漂移值**，我们用它来控制总布居数。我们的目标是为行走子设计一个博弈，使得布居数 $N_i$ 的*[期望](@article_id:311378)*变化与这个确定性方程相匹配 [@problem_id:2803746]。这个博弈包含三个基本步骤：

1.  **派生（非对角元素的舞蹈）：** 项 $-\Delta\tau H_{ij}C_j$（其中 $j \neq i$）将一个[行列式](@article_id:303413) $|D_j\rangle$ 与另一个[行列式](@article_id:303413) $|D_i\rangle$ 连接起来。这是哈密顿量的“相互作用”部分。在我们的行走子博弈中，这意味着位于 $|D_j\rangle$ 上的行走子可以在 $|D_i\rangle$ 上创造后代。我们通过概率方式实现这一点。对于 $|D_j\rangle$ 上的每个行走子，我们尝试在与之相连的[行列式](@article_id:303413) $|D_i\rangle$ 上**派生**一个新的行走子。该事件的概率与[耦合强度](@article_id:339210)的大小 $\Delta\tau |H_{ij}|$ 成正比。派生出的子行走子的符号至关重要：它的符号是父行走子的符号与 $-\mathrm{sgn}(H_{ij})$ 的乘积。因为电子是[费米子](@article_id:306655)，许多 $H_{ij}$ 矩阵元是负的，这个规则使得模拟能够探索正负振幅，这是[描述化学](@article_id:309129)键和[磁相](@article_id:321776)互作用所必需的特性。

2.  **死亡与克隆（对角元素的戏剧）：** 项 $-\Delta\tau(H_{ii} - S)C_i$ 只涉及单个[行列式](@article_id:303413) $|D_i\rangle$ 上的布居。这代表了[波函数](@article_id:307855)振幅的局部增长或衰减。我们将其建模为 $|D_i\rangle$ 上每个行走子的生死事件。一个事件以概率 $p = \Delta\tau|H_{ii} - S|$ 发生 [@problem_id:2893663]。如果量 $(H_{ii} - S)$ 是正的，行走子就有可能被移除（**死亡**）。这发生在对角能量高的[行列式](@article_id:303413)上。如果 $(H_{ii} - S)$ 是负的，行走子就有可能在同一[行列式](@article_id:303413)上创造一个自己的精确副本（**克隆**）。漂移值 $S$ 就像是环境的“承载能力”。通过仔细调整 $S$，我们可以鼓励增长或衰减，以防止行走子总布居数爆炸或消失。在一个成功的模拟结束时，为维持稳定布居所需的 $S$ 值会漂亮地收敛到精确的[基态能量](@article_id:327411) [@problem_id:2893668]。

3.  **湮灭（秘方）：** 在一个给定的时间步长内，所有派生、死亡和克隆事件完成后，我们执行最后的清算步骤。在每个[行列式](@article_id:303413)上，我们对所有存在的行走子——幸存者、克隆体和新派生的行走子——的符号求和。如果一个[行列式](@article_id:303413)上有，比如说，五个正行走子和三个负行走子，它们会成对地**湮灭**，留下两个正行走子的净布居。这一步是[FCIQMC](@article_id:370947)的关键创新。它就像物质与[反物质](@article_id:313843)的湮灭，也是我们对抗[符号问题](@article_id:315624)的主要武器。这是一个作用于行走子场的深刻非线性过程，但值得注意的是，因为我们只是对带符号的数进行求和，它不会在布居的*[期望值](@article_id:313620)*中引入任何偏差 [@problem_id:2803746]。其唯一且至关重要的目的是减少模拟中的统计噪声或方差。

为了看清这些抽象规则如何运作，让我们跟随一个微小的双[行列式](@article_id:303413)系统在一个假设模拟中的单步时间演化 [@problem_id:2803677]。我们开始时，[行列式](@article_id:303413) $|D_0\rangle$ 上有布居 $N_0=+2$（三个正行走子，一个负行走子），[行列式](@article_id:303413) $|D_1\rangle$ 上有布居 $N_1=-1$。给定[哈密顿矩阵元](@article_id:380603)和一串随机数。
-   **派生：** 我们为每个行走子“掷骰子”。$|D_0\rangle$ 上的一个正行走子成功地在 $|D_1\rangle$ 上派生了一个子行走子。由于 $H_{10}$ 是正的，派生出的行走子符号为负。$|D_0\rangle$ 上的负行走子也派生了，在 $|D_1\rangle$ 上创造了一个正行走子。
-   **死亡/克隆：** 我们再次掷骰子。在 $|D_0\rangle$ 上，量 $(H_{00}-S)$ 是负的，所以行走子可以被克隆。一个正行走子被随机数选中，创造了一个自己的副本。在 $|D_1\rangle$ 上，$(H_{11}-S)$ 是正的，所以它唯一的负行走子面临死亡的风险，但它的随机数使它得以存活。
-   **湮灭：** 现在我们清点。在 $|D_0\rangle$ 上，我们有最初幸存的3个正行走子和1个负行走子，外加一个新克隆的正行走子，总共有4个正行走子和1个负行走子。它们湮灭后留下净布居 $N_0^{\text{之后}} = +3$。在 $|D_1\rangle$ 上，我们有那个幸存的负行走子，加上一个新派生的负行走子和一个新派生的正行走子。它们湮灭后留下 $N_1^{\text{之后}} = -1$。
在一个由概率支配的步骤中，布居发生了演化。通过追踪像能量这样的可观测量，我们可以看到它在波动，并在许多步骤后，收敛到正确答案。

### [符号问题](@article_id:315624)与序的涌现

使用带符号的行走子来表示[费米子](@article_id:306655)[波函数](@article_id:307855)的正负波瓣是必需的，而这也是[量子蒙特卡洛](@article_id:304811)方法中最深层挑战的根源：即**[符号问题](@article_id:315624)**。派生过程是不加区分的；一个处于正确符号区域的行走子很容易在一个振幅应为相反符号的区域派生出一个“错误符号”的子代。如果不加以控制，模拟很快就会衰变为正负布居数相等的噪声混合体，这是一种**符号不相干**状态，物理信号完全被淹没。

湮灭是唯一的防御手段。这是一场持续的战斗：派生创造符号不相干，而湮灭摧毁它。然而，派生是一个“[单体](@article_id:297013)”过程（单个行走子可以创造一个子代），而湮灭是一个“二体”过程（两个相反符号的行走子必须在同一个[行列式](@article_id:303413)上相遇）。这导致了一个迷人的动力学。在行走子布居较低时，行走子稀疏，湮灭效率低下。派生创造错误符号行走子的速度可能比它们被移除的速度还要快。由克隆驱动的行走子总布居的增长，被湮灭造成的损失所抵消，导致布居停滞不前。这就是臭名昭著的**[FCIQMC](@article_id:370947)平台期** [@problem_id:2803730]。

这个平台期的高度是对给定系统[符号问题](@article_id:315624)难度的物理度量。一个简单的物理模型预测，平台期布居数 $W_p$ 与希尔伯特空间中重要区域的大小（$M$）和哈密顿量固有的“[符号问题](@article_id:315624)性”（$f$）成正比。为了找到[基态](@article_id:312876)，模拟必须积累足够的行走子以“突破”平台期，达到一个湮灭占主导地位且高效的密度。对于困难的系统，这可能需要非常大量的行走子。这正是像**发起者近似**（i-[FCIQMC](@article_id:370947)）这样的巧妙改进变得至关重要的地方。通过限制来自稀疏布居区域的噪声派生事件，发起者方法有效地降低了平台期的高度，使得艰巨的计算变得可行，代价是引入一个微小且易于理解的偏差 [@problem_id:1212437]。

一旦行走子布居超过临界平台期密度，一个显著的[相变](@article_id:297531)就会发生。湮灭开始赢得这场战斗。它主动地提纯[波函数](@article_id:307855)表示，刻画出正确的[节面](@article_id:309773)——正负区域之间的边界。行走子通过它们简单的局域相互作用，[自组织](@article_id:323755)成一个全局结构化的状态。一个**符号相干**的相出现了，其中每个[行列式](@article_id:303413)上的行走子布居的符号与真实[基态](@article_id:312876)[波函数](@article_id:307855)的符号正确匹配 [@problem_id:2803713]。这是一个复杂[涌现行为](@article_id:298726)的惊人例子，其中一群随机行走子集体“找到”了薛定谔方程的解。

### 博弈的回报

在穿越了险峻的平台期并达到符号相干后，行走子布居代表了对真实[基态](@article_id:312876)[波函数](@article_id:307855)的高保真度随机快照。我们如何提取最终的答案，即能量呢？虽然漂移值 $S$ 会收敛到能量值，但它可[能带](@article_id:306995)有噪声。一个更稳健、更优雅的方法是**投影能量估计量** [@problem_id:2893664]。我们选择一个参考[行列式](@article_id:303413) $|D_0\rangle$（通常是容易计算的Hartree-Fock态），并通过以下比率计算能量：
$$
E_p = \frac{\langle D_0|\hat{H}|\Psi\rangle}{\langle D_0|\Psi\rangle} \equiv \frac{\sum_j H_{0j}N_j}{N_0}
$$
这种形式之所以巧妙有几个原因。首先，当 $|\Psi\rangle$ 是精确[基态](@article_id:312876)时，它保证给出精确能量 $E_0$。其次，因为它是一个比率，它完全不受行走子总数的影响；[波函数](@article_id:307855)的总[归一化](@article_id:310343)因子被消掉，使得估计值对布居波动保持稳定。最后，在模拟的固[定点](@article_id:304105)（即收敛时），分子和分母在平均意义上都变得平稳，从而得到一个稳定、可靠的能量测量值 [@problem_id:2893664]。

也许对这整个随机事业最深刻的验证是，它尊重了许多其他计算方法所违反的一项基本物理原理：**广延性**。在模拟两个不相互作用的分子时，比如两个相距很远的[氦原子](@article_id:310662)，组合系统的能量必须等于单个[氦原子](@article_id:310662)能量之和。[FCIQMC](@article_id:370947)在平均意义上自然而正确地满足了这一要求 [@problem_id:2805752]。这不是一个临时的修正；它是随机博弈的一种[涌现性质](@article_id:309725)。它强有力地证明了这场由随机数引导的、复杂的派生、死亡和湮灭之舞，不仅仅是一个巧妙的计算技巧。它是对底层量子力学现实的深刻而忠实的模拟。