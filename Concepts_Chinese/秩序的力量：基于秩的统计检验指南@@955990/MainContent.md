## 引言
科学探究的核心常涉及测量与比较。但如果我们的测量工具——我们的量表和数字——并不完美，该怎么办？这个问题挑战了许多经典统计方法的基础，因为这些方法假设我们的数据是在一个完美校准的等距量表上记录的。传统的检验，如 t 检验，也依赖于关于数据分布形状的假设，通常要求数据遵循一个规整的钟形曲线。然而，在从心理学到基因组学的各个领域，真实世界的数据很少符合这些理想情况，这可能导致在误用这些工具时得出误导性的结论。本文探讨了一种强大而优雅的解决方案：基于秩的统计检验。我们的旅程始于揭示这些方法背后的基本逻辑。在“原则与机制”一章中，我们将探讨使用秩而非原始值如何提供对尺度的不变性以及对异常值的稳健性。然后，在“应用与跨学科联系”一章中，我们将看到这种从分布假设中获得的自由如何让我们能够处理从临床试验到高通量生物学等广泛科学领域中的复杂研究问题。这次探索将揭示，一个简单的视角转变——从数值到顺序——如何为我们理解世界提供一种更具韧性且往往更富洞察力的方式。

## 原则与机制

在我们理解世界的旅程中，我们不断地测量事物：患者疼痛的严重程度、化学物质的浓度、恒星的亮度。我们为这些观察结果赋予数字，然后使用数学工具进行比较。但这些数字的真正含义是什么？当赋值本身更像一门艺术而非科学时，会发生什么？我们的故事就从这里开始，一个看似简单的问题揭示了统计学核心中一个深刻而优美的原则。

### 尺度的暴政

想象一下，在一项临床试验中，我们正在测试一种新的止痛药。我们要求患者在一个量表上评价他们的疼痛程度：“无”、“轻度”、“中度”、“重度”、“极重度”。为了分析这些数据，一个自然的第一步可能是赋值：给“无”赋值 $1$，给“轻度”赋值 $2$，依此类推，直到给“极重度”赋值 $5$ [@problem_id:4834009]。现在我们有了数字，可以用它们做一些事情，比如计算服用新药的患者与服用安慰剂的患者的平均疼痛分数。t 检验作为[经典统计学](@entry_id:150683)的主力工具，正是为此设计的——比较平均值。

但等一下。通过计算平均值，我们做出了一个默然但影响深远的假设。我们假设了任意两个相邻类别之间的“距离”是相等的。我们假设从“无”到“轻度”的跃迁与从“重度”到“极重度”的跃迁代表了相同程度的疼痛。这真的正确吗？似乎不太可能。这种我们知道顺序但区间不一定相等的测量类型，被称为**定序量表**（ordinal scale）。

问题在于，平均值对我们选择的数字高度敏感。如果我们把这些类别标记为 $1, 2, 3, 10, 20$ 会怎么样？顺序是相同的，但平均分数现在会大相径庭。我们的 t 检验结论将取决于我们任意的标记选择，而不是患者疼痛的潜在现实。在这种情况下，均值是我们测量尺度的产物，而不是我们所测量事物的属性 [@problem_id:4834009]。

这与**等距量表**（interval scale）形成鲜明对比，例如摄氏温度。从 $10^\circ \text{C}$ 到 $20^\circ \text{C}$ 的变化代表的热能增加量与从 $30^\circ \text{C}$ 到 $40^\circ \text{C}$ 的变化相同。在这里，差异是有意义的，求平均值在物理上是合理的操作。t 检验是为等距量表的世界，一个拥有完美、均匀间隔的尺度的世界而构建的。但世界的大部分——从经济学到心理学再到生物学——并非如此整洁。

### 秩的自由

那么，当我们的尺度扭曲时，我们能做什么呢？解决方案既优雅又强大：我们不再关注数值本身，而只关注它们的顺序。这就是**基于秩的检验**的核心思想。

想象一下，我们有来自药物组和安慰剂组的所有疼痛分数。我们不计算平均值，而是首先将所有分数汇集在一起，从最小到最大排序。然后，我们分配秩次：最小的分数获得秩 1，次小的获得秩 2，依此类推。如果存在结（ties）（例如，有几个人都报告了“中度”疼痛），我们通常将它们所占秩次的平均值赋给它们。

现在，我们对这些秩次进行分析。例如，一个简单的检验可能是将药物组中每个人的秩次相加，然后看这个总和与随机情况下的[期望值](@entry_id:150961)相比是否出奇地低或高。

这就是神奇之处。秩次对我们扭曲的尺度问题免疫。回到我们的疼痛量表。无论我们将其编码为 $\{1, 2, 3, 4, 5\}$ 还是 $\{1, 2, 3, 10, 20\}$，疼痛“最轻”的人的分数总是低于疼痛“中度”的人。*顺序*得以保留。而且由于秩次仅依赖于顺序，秩次本身不会改变。

这个属性被称为**单调变换不变性**。单调变换是任何能一致保留顺序的函数（一个严格递增函数）。例如，对一组正数取对数就是一种单调变换。如果我们有高度偏态的生物标志物数据，我们可能会考虑分析 $\ln(x)$ 而不是 $x$。t 检验对这两种分析会给出不同的结果，因为对数不是简单的线性重缩放。但对于基于秩的检验，结果将是完全相同的 [@problem_id:4946663]。$x$ 的秩次与 $\ln(x)$ 的秩次相同。

这种不变性是一种超能力。它让我们摆脱了在定序量表上任意选择数字的困扰。它让我们不再担心是否要对数据进行对数转换。基于秩的检验给出相同的答案，因为它在问一个更基本、与尺度无关的问题 [@problem_id:4933876]。这就是为什么这些方法被称为**非参数**方法——它们的有效性不依赖于特定数据分布的参数（如均值）。它们在设计上就是稳健的。

### 我们真正要问的是什么？

如果[秩检验](@entry_id:178051)不是在比较均值，那么它在比较什么？这个问题引导我们对“处理效应”的含义有了更精炼、也更优美的理解。

一个常见的答案是[秩检验](@entry_id:178051)比较**[中位数](@entry_id:264877)**。[中位数](@entry_id:264877)是将数据一分为二的值，是一种比均值更稳健的[集中趋势度量](@entry_id:168414)。这通常是正确的。最简单的[秩检验](@entry_id:178051)，即**[符号检验](@entry_id:170622)**，正是如此。对于配对数据（例如，前后测量值），它只计算差值为正与为负的数量，这直接检验了[中位数](@entry_id:264877)差异是否为零 [@problem_id:4933887]。稍微复杂一点的 **Wilcoxon 符号[秩检验](@entry_id:178051)** 在我们可以假设差异分布对称时是有效的，在这种条件下，均值和[中位数](@entry_id:264877)是一致的 [@problem_id:4933936]。

然而，最普适和优雅的解释是，[秩检验](@entry_id:178051)评估的是**随机优势**（stochastic dominance）。Mann-Whitney U 检验（也称为 Wilcoxon [秩和检验](@entry_id:168486)）本质上是在问：*如果我从治疗组和[对照组](@entry_id:188599)中各随机挑选一个人，治疗组的人得分更高的概率是多少？* 这被称为**优势概率**（probability of superiority） [@problem_id:4546676]。在无效应的原假设下，这个概率是 $0.5$。如果检验得出的概率是，比如说，$0.7$，这意味着在 70% 的随机配对中，接受治疗的个体会获得更好的结果。这是一个非常直观且通常比“均值差异为 2.3 分”更具临床意义的陈述。它描述的是整个分布的一致性偏移，而不仅仅是某个汇总统计量的变化。

这连接到一个更深层次的原则：**随机化**。在随机试验中，*设计上*唯一随机的是谁进入治疗组，谁进入[对照组](@entry_id:188599)。在无效应的原假设下，无论一个人最终分到哪个组，其结果都将是相同的。他们的组标签只是一个随机的标记。理论上，我们可以为这些标签的每一种可能的排列组合计算我们的检验统计量，以观察我们实际的结果有多么不寻常。这是一种**[置换检验](@entry_id:175392)**。事实证明，一个精确的基于秩的检验*就是*一个在数据秩次上执行的[置换检验](@entry_id:175392) [@problem_id:4538514]。实验设计的核心逻辑——随机化——为检验提供了数学上的正当性。这是一个优美且自洽的推理闭环。

### 效率的艺术

此时，你可能想知道这里面是否有陷阱。如果我们丢弃实际数值，只保留秩次，我们是否会失去检测真实效应的功效（power）？

让我们考虑一家医院研究两种治疗方案的住院时长。大多数患者可能只住几天，但少数人可能会出现严重并发症并住院数月。这些极端的异常值会将其所在组的平均住院时长大幅拉高，使得均值成为一个充满噪声且不稳定的度量。依赖均值的 t 检验很容易被这些异常值误导。其检测真实差异的统计“功效”会因此减弱 [@problem_id:4808592] [@problem_id:4834090]。

这可以通过**[影响函数](@entry_id:168646)**的概念来形式化，该函数衡量单个数据点对统计量的影响有多大。对于均值，影响是无界的——一个离谱的异常值可以任意改变均值。但对于基于秩的检验，影响是有界的。一个异常值可能会获得最高的秩次，但它的影响仅此而已；它只是众多秩次中的一个。这使得[秩检验](@entry_id:178051)非常稳健，并且在存在异常值或[重尾分布](@entry_id:142737)的情况下，其功效通常*高于* t 检验 [@problem_id:4808592]。

如果数据表现得非常完美，符合一个漂亮的钟形正态分布呢？这是 t 检验的主场，理论上它是功效最高的检验。然而，即便在这种情况下，简单的 Wilcoxon [秩和检验](@entry_id:168486)也表现得惊人地好。其功效大约是 t 检验的 95.5%。这意味着在理想情况下你牺牲的非常少，但却获得了针对真实世界数据混乱性的一份巨大保险。这是一笔非常划算的交易。

但故事并未就此结束。我们可以更加巧妙。标准的 Wilcoxon 检验为其秩次使用简单的线性分数（$1, 2, 3, \dots$）。但这只是一种选择。我们可以设计其他具有不同评分系统的[秩检验](@entry_id:178051)，以针对不同情况优化我们的功效 [@problem_id:4946662]：

-   如果我们怀疑数据来自一个大致正态的分布，我们可以使用模仿正态分布间距的分数。这些**正态分数**（用于 van der Waerden 检验）给予极端秩次更大的权重，从而创造出一种在其主场上功效几乎与 t 检验相当的检验。

-   如果我们正在寻找生存时间的差异，其效应可能是“[比例风险](@entry_id:166780)”，我们可以使用**指数分数**（用于 Savage 检验），这种分数对分布尾部的差异特别敏感。

没有一个单一的“最佳”[秩检验](@entry_id:178051)，就像没有一个工具适用于所有工作一样。这个框架的美妙之处在于其灵活性。通过选择一个[分数函数](@entry_id:164520)，我们含蓄地声明了我们正在寻找什么样的差异，从而为手头的具体科学问题量身定制我们的统计显微镜。

从一个关于给疼痛赋值的简单难题出发，我们踏上了一段旅程，深刻领会了不变性、随机优势以及随机化与推断之间优雅的联系。基于秩的检验不是一种妥协或“次优”选择。它们代表了一种不同的，且在许多方面更稳健、更基本的世界观——一种崇尚秩序而非任意测量，并在优雅的简洁中发现力量的世界观。

