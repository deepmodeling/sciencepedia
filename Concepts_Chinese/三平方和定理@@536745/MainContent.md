## 引言
是什么决定了一个整数能否写成三个平方数之和？这个看似简单的问题最早由古[代数学](@article_id:316869)家探索，并引出了数论中最优雅的结果之一。虽然像3（$1^2+1^2+1^2$）和6（$2^2+1^2+1^2$）这样的数很容易构成，但其他数如7和15却顽固地无法表示。这并非因为我们不够努力，而是标志着一条深刻的、隐藏的定律在支配着整数的结构。本文将揭示这一数学奥秘，填补从简单观察到深刻理论理解之间的知识鸿沟。

在接下来的章节中，您将踏上一段旅程，去理解这部分优美的数学。在“原理与机制”一章中，我们将通过探索[模算术](@article_id:304132)和强大的[局部-整体原则](@article_id:309667)的世界，揭示这个被称为[勒让德三平方和定理](@article_id:365803)的完整规则。随后，“应用与跨学科联系”一章将展示该定理出人意料且影响深远的意义，说明一个纯粹的数论概念如何为计算机[算法](@article_id:331821)提供了蓝图，规定了量子物理的定律，并开启了通往现[代数学](@article_id:316869)统一景观的大门。

## 原理与机制

我们已经接触到一个看似简单的问题：哪些整数可以写成三个平方数之和？有些数字似乎轻而易举。例如，$1=1^2+0^2+0^2$，$2=1^2+1^2+0^2$，以及$3=1^2+1^2+1^2$。感觉上我们似乎能用这种方式得到所有数字。但让我们像优秀的物理学家——或者在这种情况下，数学家——一样，来检验这个想法。我们来试试构造数字7。我们可以使用$1^2=1$和$2^2=4$。我们可以尝试$1+1+1=3$，或$4+1+1=6$，或$4+4+1=9$。无论我们如何组合，都无法得到7。这仅仅是因为我们尝试得不够努力，还是有更深层次的原因？是否存在某种隐藏的定律，阻止7成为三个平方数之和？

### 八之筛：一条隐藏的规则

事实证明，*确实*存在一条隐藏的定律，而且是一条异常简洁而优雅的定律。要发现它，我们无需关注数字本身，而是要看它们在除以8时的“风味”或特性。这就是[模算术](@article_id:304132)的世界，一个揭示数字中隐藏模式的强大透镜。

让我们取任意一个整数，将其平方，然后看看它除以8的余数是多少。

- 如果这个数是偶数，比如说$2k$：它的平方是$4k^2$。如果$k$也是偶数（$k=2m$），则平方是$4(4m^2) = 16m^2$，余数为$0$。如果$k$是奇数（$k=2m+1$），则平方是$4(2m+1)^2 = 4(4m^2+4m+1) = 16(m^2+m)+4$，余数为$4$。
- 如果这个数是奇数，比如说$2k+1$：它的平方是$(2k+1)^2 = 4k^2+4k+1 = 4k(k+1)+1$。现在，有一个奇妙的小事实：任意两个连续整数的乘积$k(k+1)$总是偶数。所以，$4k(k+1)$必定是8的倍数。这意味着任何奇数的平方除以8的余数都恰好是$1$。

所以，我们新游戏的第一个规则是：**任何完全平方数，当除以8时，其留下的余数必定是0、1或4** [@problem_id:3089640] [@problem_id:1841633]。没有其他可能性。

现在，当我们把这三个平方数加在一起时会发生什么？我们只是在相加三个数，而在这个“8的世界”里，每个数必须是0、1或4。我们能得到哪些可能的总和？

- $0+0+0 = 0$
- $1+0+0 = 1$
- $1+1+0 = 2$
- $1+1+1 = 3$
- $4+0+0 = 4$
- $4+1+0 = 5$
- $4+1+1 = 6$
- $4+4+0 = 8 \equiv 0$
- $4+4+1 = 9 \equiv 1$
- $4+4+4 = 12 \equiv 4$

将它们全部列出，我们发现三个平方数之和模8只能是$0, 1, 2, 3, 4, 5,$或$6$。

看看漏掉了什么！数字7。这是不可能的。我们发现了一个根本性的障碍：**三个整数平方之和永远不可能模8[同余](@article_id:336894)于7**。我们试图将7写成三个平方数之和的失败，并非想象力的失败，而是由数字本身的结构决定的不可能性。同样的情况也适用于15、23、31以及任何其他形式为$8b+7$的数字[@problem_id:3089640]。它们都被这个“八之筛”过滤掉了。

### 四的欺骗性力量

所以，我们有了一个强大的规则：如果一个数的形式是$8b+7$，它就被排除了。这就是全部的故事吗？如果一个数*不*是$8b+7$的形式，它就总能表示为三个平方数之和吗？

让我们来检验这个假设。考虑数字$n=28$。当我们将28除以8时，得到余数4（$28 = 3 \times 8 + 4$）。所以，28通过了我们的“八之筛”。我们的规则表明它应该能表示为三个平方数之和。但无论你怎么尝试，都找不到一个解。我们错过了什么？

罪魁祸首是数字4。假设一个数$n = x^2+y^2+z^2$可以被4整除。这意味着$x^2+y^2+z^2 \equiv 0 \pmod 4$。回想一下平方数的性质，这次是模4：偶数的[平方同余](@article_id:640203)于0，奇数的[平方同余](@article_id:640203)于1。要使三个各为0或1的数相加等于4的倍数，唯一的可能是它们都是0。

所以，$x^2 \equiv 0 \pmod 4$，$y^2 \equiv 0 \pmod 4$，以及$z^2 \equiv 0 \pmod 4$。这反过来意味着$x, y,$和$z$必须都是偶数[@problem_id:3089660]。我们可以将它们写成$x=2x'$, $y=2y'$, 和 $z=2z'$。让我们将此代回我们的方程：

$n = (2x')^2 + (2y')^2 + (2z')^2 = 4(x'^2+y'^2+z'^2)$

这揭示了一件美妙的事情。如果一个4的倍数$n$是三个平方数之和，那么$n/4$这个数也必须是三个平方数之和。就好像“能表示为三个平方数之和”这个性质在我们除以4时被向下继承了。这给了我们一个强大的下降机制[@problem_id:3089642]。

现在我们可以解开28的谜团了。如果28是三个平方数之和，那么$28/4 = 7$也必须是。但我们已经知道7被我们的“八之筛”禁掉了！线索就此中断。因此，28不能是三个平方数之和。

### 勒让德定律：完整的图景

法国数学家Adrien-Marie Legendre将这两个洞见——“八之筛”和“四之降”——结合成数论中最优雅的分类定理之一。

**[勒让德三平方和定理](@article_id:365803)：**一个正整数$n$可以写成三个平方数之和，当且仅当它*不*具有$4^a(8b+7)$的形式，其中$a$和$b$为任意非负整数[@problem_id:3089642]。

这个紧凑的公式就是完整的定律。它告诉我们，首先要从我们的数字$n$中“剥离”掉所有的因子4。如果剩下的“核心”是禁忌的$8b+7$形式，那么原始数字$n$就不能表示为三个平方数之和。否则，就可以。

让我们用一个更复杂的数字$n=320$来看看它的实际作用[@problem_id:3089681]。我们可以写出$320 = 64 \times 5 = 4^3 \times 5$。这里，$a=3$。这个数的“核心”是5。5是$8b+7$的形式吗？不，$5 \equiv 5 \pmod 8$。所以，勒让德定律预测320*可以*被写成三个平方数之和。（实际上，$320 = 16^2 + 8^2 + 0^2$）。此外，下降论证告诉我们更深层的东西。因为我们必须剥离$4^3$，所以320的任何解$(x,y,z)$都必须来自5的一个解。这迫使$x, y,$和$z$都必须是$2^3=8$的倍数，意味着$\gcd(x,y,z)$必须是8的倍数。对于$n=320$，$\gcd$总是恰好为8，这是该结构的一个惊人推论。

### 破碎的对称性：为何三是特例

这一切可能看起来有点复杂。为什么对于三个平方数存在禁忌数，而拉格朗日[四平方和](@article_id:382092)定理却著名地指出*每个*正整数都是四个平方数之和？[费马平方和定理](@article_id:376884)又有它自己看起来不同的规则。为什么三是那个困难的数字？

原因在于一种破碎的对称性。对于二平方和与[四平方和](@article_id:382092)，存在优美的代数恒等式，表明两个这[类数](@article_id:316572)的乘积仍然是同类型的数。对于二[平方和](@article_id:321453)，恒等式是$(a^2+b^2)(c^2+d^2) = (ac-bd)^2+(ad+bc)^2$。对于[四平方和](@article_id:382092)，Euler发现了一个更复杂的恒等式。这些恒等式意味着，可表示为二或[四平方和](@article_id:382092)的数集在乘法下是封闭的。

但对于[三平方和](@article_id:641929)，情况并非如此。这个集合在乘法下不封闭。考虑数字3和5。
$3 = 1^2 + 1^2 + 1^2$
$5 = 2^2 + 1^2 + 0^2$
两者都是三个平方数之和。那么它们的乘积$15$呢？我们知道，$15 = 8(1)+7$，所以$15 \equiv 7 \pmod 8$。它落入了禁忌类别，不能写成三个平方数之和[@problem_id:3089672]。这种乘法恒等式的缺失是[三平方和](@article_id:641929)问题复杂性与优美性的深层原因。

### 从上而观：一个局部到整体的故事

还有最后一种现代的方式来看待整个故事，它将勒让德的卓越发现置于一个更宏大的背景中。这被称为**[局部-整体原则](@article_id:309667)**[@problem_id:3089676]。

其思想是，通过检查一个方程在各种“局部”数系中是否有解，来判断它是否有整数解（一个“全局”性质）。这些局部系统包括我们熟悉的实数$\mathbb{R}$，也包括奇特而强大的$p$-进数$\mathbb{Z}_p$，每个素数$p$对应一个。如果我们甚至在其中一个局部系统中都找不到解，那么我们肯定找不到整数解。

这对我们的问题$n = x^2+y^2+z^2$意味着什么？
- **实数($\mathbb{R}$):** 要存在解，$n$必须是非负的。这是一个显而易见的局部条件。
- **奇素数$p$的$p$-进数:** 事实证明，对于任何奇素数$p$，解总是存在的。这里没有障碍。
- **2-进数($\mathbb{Z}_2$):** 这才是关键所在。在2-进整数中存在解的条件*恰好*是$n$不具有$4^a(8b+7)$的形式。我们的“八之筛”和“四之降”只是这个更深的2-进结构的初等投影。

所以，唯一可能出现障碍的地方是在实数中（如果$n  0$）和在2-进数中。对于[三平方和](@article_id:641929)问题，一件壮丽的事情发生了：这就是全部的故事。如果一个数$n$在局部处处有表示（即，在$\mathbb{R}$和每个$\mathbb{Z}_p$中），那么它就保证有一个全局的整数表示。这个[局部-整体原则](@article_id:309667)并非对所有方程都成立，但它在这里的正确性使得勒让德定理如此完备。它表明，我们发现的简单同余规则并非巧合；它们是阻碍一个数成为[三平方和](@article_id:641929)的全部且唯一的障碍。这就是为什么一个纯粹的几何论证，比如来自[闵可夫斯基定理](@article_id:378212)的论证，无法为$n=7$找到解；它在$\mathbb{R}^3$的“全局”世界中运作，对存在于2-进世界中的“局部”障碍视而不见[@problem_id:3081209]。算术是绝对的。

