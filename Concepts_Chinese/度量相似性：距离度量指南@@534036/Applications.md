## 应用与跨学科联系

在深入理解了距离的原理之后，我们可能会觉得我们刚刚磨好了一件工具。现在，是时候使用它了。我们将要看到，“距离度量”这个抽象概念并不仅仅是一个数学上的奇思妙想；它是一种强大、实用且出人意料地具有创造性的工具，在整个科学领域解锁了各种发现。我们选择如何测量距离，正是我们审视数据的镜头。它是我们将关于“相似性”的直觉转化为一个定量问题的方式。你将要发现的是，选择正确的度量——甚至发明一种新的度量——是科学探究的一项基本行为。

### 为特定任务选择正确的度量：在生物学中洞见未见

让我们从现代生物学这个熙熙攘攘的世界开始我们的旅程。想象你是一名研究人体肠道内庞大复杂细菌生态系统的生物学家。你手头有来自两个不同人的数据，你想知道他们的[肠道微生物群](@article_id:302493)是否不同。但“不同”意味着什么？是指它们拥有完全不同的物种？还是物种相同，但比例不同？你得到的答案完全取决于你提出的问题，而距离度量就是你提问的方式。

这个问题在宏基因组学领域确实存在（[@problem_id:1502999]）。研究人员使用像 [UniFrac](@article_id:370115) 距离这样的度量来比较微生物群落。该度量的 **非加权** 版本只关注细菌谱系的 *存在与否*。它对稀有物种极其敏感；你肠道中的一个独特细菌就会让你看起来与缺少它的人不同。相比之下，该度量的 **加权** 版本则考虑了这些谱系的相对丰度。它关心的是主要角色。如果你和我的肠道都以 *拟杆菌属* 为主，那么在加权度量下，我们看起来会非常相似，即使我们体内有不同种类的稀有背景物种。令人惊奇的是：仅仅通过从非加权距离切换到加权距离，研究人员就可以在两个不同的生物学问题之间切换。我们是在寻找可能预示着新生疾病的独特稀有生物，还是在描绘健康微生物群的稳定、主导核心？度量定义了搜索的方向。

这个原则——度量必须与问题相匹配——在革命性的单细胞生物学领域甚至更为关键。在这里，科学家可以测量成千上万个单细胞中数千个基因的活性。他们的首要目标通常是简单地识别样本中存在哪些类型的细胞：它们是[神经元](@article_id:324093)、免疫细胞还是皮肤细胞？方法是对它们进行[聚类](@article_id:330431)；我们假设相同类型的细胞会有相似的基因活性模式。但问题又来了，什么是“相似”？

这些实验中的一个主要挑战是，测量过程本身会引入噪声。有些细胞可能仅仅因为我们捕获了更多的细胞物质，而不是因为它们在生物学上有所不同，就表现出整体上更高的基因活性（[@problem_id:2752186]）。如果我们将每个细胞表示为一个长长的基因活性向量，并使用标准的[欧几里得距离](@article_id:304420)，这些在“量级”或“文库大小”上的差异可能会产生误导。一个低活性的[神经元](@article_id:324093)可能看起来比一个完全相同类型的高活性[神经元](@article_id:324093)更接近一个低活性的免疫细胞。

解决方案是选择一个对这些整体量级效应不敏感的度量。例如，**[余弦距离](@article_id:639881)** 或 **[相关距离](@article_id:639235)**，并不测量向量端点之间的直线距离。相反，它测量它们之间的 *夹角*。通过这样做，它专注于基因表达的 *模式*——即相对而非绝对的活性水平。两个细胞如果开启和关闭的基因比例相同，即使其中一个整体上“更亮”，它们的[余弦距离](@article_id:639881)也会非常小。通过选择一个对已知技术噪声源具有鲁棒性的度量，科学家可以剥离实验的假象，揭示潜在的生物学真相（[@problem_id:2429795]）。在非常真实的意义上，正确的度量清理了数据。

一旦我们有了一种可靠的方法来识别“邻近”细胞，我们能做的就不仅仅是聚类。我们可以构建细胞关系网络，甚至利用一个细胞邻居的属性来填补我们数据集中的缺失信息，这种技术被称为 k-NN 插补（[@problem_id:1437193]）。一个好的距离度量的力量在于，它为我们提供了一个相似性的基础，我们可以在此之上构建出令人惊讶的复杂分析。

### 超越常规：绘制复杂世界

到目前为止，我们一直在一个相对简单、平坦的空间里思考距离。但是，当我们的数据所在的世界是弯曲的、扭曲的，甚至有洞时，会发生什么呢？这不仅仅是一个几何幻想；对于许多类型的数据来说，这都是现实。

考虑一个简单而优美的例子：周期性数据，比如圆上的角度（[@problem_id:3190448]）。想象你有一组代表风向的点。$1^\circ$ 的角度非常接近 $359^\circ$ 的角度。但如果你把这些角度当作一条直线上的数字并使用欧几里得距离，它们看起来几乎是相距最远的！你把一个圆，因为用了错误的尺子，切开并拉成了一条线。像 UMAP 这样的[算法](@article_id:331821)，它从这些局部距离中构建对数据形状的理解，会完全被愚弄。它会看到一个线段，而不是一个圆。解决方法是使用一个理解世界是圆的度量：一种 **环形距离**，它知道从 $359^\circ$ 到 $1^\circ$ 的[最短路径](@article_id:317973)是跨越 $0^\circ$ 边界。通过将空间的已知拓扑结构编码到我们的度量中，我们引导[算法](@article_id:331821)得出正确的结论。

这个想法可以扩展到更复杂的情景。在一个非凡的生物过程中，一个单一的祖细胞可以成熟并分化成多种完全不同的细胞类型。如果我们追踪这些发育路径上细胞的基因表达，我们会发现它们在基因的高维空间中描绘出复杂的、弯曲的轨迹。像 PCA 这样的线性技术可能会将这条弯曲的路径投射到一个平坦的子空间上，从而造成灾难性的扭曲（[@problem_id:1465866]）。沿着蜿蜒的发育路径相距很远的细胞——比如一个早期的中间细胞和一个完全成熟的细胞——可能会被投射到彼此的顶部。在这种扁平化的空间中使用[欧几里得距离](@article_id:304420)，就会画出一条“生物学上不可能”的连接，暗示一种不存在的相似性。

这揭示了一个深刻的局限性：有时候，没有任何现成的度量能胜任。我们工作的空间本身就是问题所在。该领域的前沿是使用先进的技术，如[变分自编码器](@article_id:356911)（VAEs），来学习数据的一个新的、非线性的“地图”。目标是创建一个新的表示——一个新的潜在空间——在这个空间里，复杂的、弯曲的轨迹变得更简单，而标准的欧几里得距离再次成为衡量真实“生物学”距离的有意义的度量。这是这个概念的终[极体](@article_id:337878)现：当面对一个对你的尺子来说过于复杂的[世界时](@article_id:338897)，你不仅仅是换一把新尺子——你学会了如何构建一个全新的世界。

### 从分子到星辰：一种通用语言

距离度量的力量远远超出了生物学。它是一种用于比较的通用语言，在几乎每个定量领域都占有一席之地。

在 **化学** 领域，寻找新药的研究人员需要在巨大的分子库中搜索，以找到与已知活性化合[物相](@article_id:375529)似的分子。在这里，相似性可以用不同的方式定义。一种方法可能将分[子表示](@article_id:301536)为一组[特征化](@article_id:322076)学子结构，并使用 **杰卡德距离**——一种基于集合重叠的度量——来寻找共享相同构建块的其他分子（[@problem_id:3109635]）。或者，可以使用机器学习将每个分子转换为一个抽象的向量[嵌入](@article_id:311541)。然后，可以使用 **[余弦距离](@article_id:639881)** 来寻找其[嵌入](@article_id:311541)指向相似方向的分子，捕捉一种更整体但解释性较弱的功能相似性概念。

在 **高能物理** 领域，当粒子以接近光速的速度碰撞时，它们会产生称为“喷注”的新粒子射流。为了理解碰撞，物理学家必须将出射的粒子分组到正确的喷注中。他们使用基于距离度量的序列重组[算法](@article_id:331821)来做到这一点（[@problem_id:219475]）。但这并非普通度量。它被巧妙地设计，融入了量子色动力学的物理原理。两个粒子之间的距离被定义为，如果它们以几乎相同的方向飞行（共线）或者其中一个能量非常低（软），则距离很小。这是因为理论预测，这些是源自同一量子层面事件的粒子的特征。在这里，距离度量不仅仅是用于聚类的工具；它*就是*一种物理理论，用几何的语言来表达。

回到更贴近生活的例子，如果我们对一个物体有多种不同类型的信息呢？考虑 **空间转录组学**，我们既有细胞的基因表达信息，又有它在组织中的物理 $(x,y)$ 位置（[@problem_id:2379623]）。我们如何定义一个同时尊重这两者的距离？我们不能只是简单地将基因向量和[坐标向量](@article_id:313731)拼接在一起；它们的尺度和单位完全不同。解决方案需要一种有原则的方法。我们必须仔细地缩放和加权每种模态，以平衡它们的贡献，创建一个复合[特征空间](@article_id:642306)，使[欧几里得距离](@article_id:304420)有意义。更先进的方法甚至使用 **[马氏距离](@article_id:333529)**，它考虑了数据的相关性和不同尺度，来创建一个统计上鲁棒的相似性度量。这是数据工程的最佳体现：构建一个自定义度量，将不同的信息源融合成一个单一、连贯的整体。

确实，度量的选择并不总是欧几里得和曼哈顿之间的简单选择。[算法](@article_id:331821)的输出对这种选择的敏感性可能是深远的（[@problem_id:3132592]）。一个稍有不同的距离概念可能导致一组不同的“最近邻”，这可能会级联导致不同的最终预测或[聚类](@article_id:330431)。这凸显了理解我们的工具并将度量的选择视为我们模型的一个关键参数的重要性。

从在生物学中提出正确的问题，到尊重我们数据的几何形状，再到编码物理定律和融合多模态信息，不起眼的距离度量证明了它是科学中最基本和最通用的概念之一。它是我们定性直觉和定量分析之间的桥梁，也是一个简单数学思想所具有的统一力量的证明。