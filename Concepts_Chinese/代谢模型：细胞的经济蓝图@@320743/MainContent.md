## 引言
一个活細胞的代谢是一个由数千个化学反应组成的令人眼花缭乱的[复杂网络](@entry_id:261695)。要理解这个系统，我们需要的不仅仅是一个简单的零件清单；我们需要一张能够预测细胞行为的功能地图。代谢模型就提供了这样一张地图，将生物学的复杂性转化为一个可解的数学框架。这些模型解决了理解生物体基因型如何产生其代谢表型这一根本性挑战。本文将引导您进入[代谢建模](@entry_id:273696)的世界。首先，在“原理与机制”一章中，您将学习这些模型是如何从零开始构建的，从[化学计量矩阵](@entry_id:275342)和[稳态假设](@entry_id:269399)入手，逐步建立起像流通平衡分析 (FBA) 这样强大的预测方法。然后，“应用与跨学科联系”一章将揭示这一理论框架如何被应用于解决现实世界的问题，从工程改造微生物和设计药物，到理解进化，甚至重建古代生态系统。

## 原理与机制

要理解活细胞内部那个繁忙的都市，那里有数千个化学反应同时进行，我们需要的不仅仅是一份零件清单。我们需要一张地图和一套规则。我们需要一种方法来觀察整个系统如何协同工作。这就是代谢模型的目标：创建一个[细胞代谢](@entry_id:144671)的数学 caricature（漫画式简化模型），它足够简单以便于处理，同时又足够强大，能对生命本身做出惊人准确的预测。让我们从头开始，探寻实现这一目标的核心原理。

### 细胞的账本：化学计量矩阵

想象一下试图理解一个庞大的化工厂。你会注意到两种基本的东西：正在被处理的材料，我们称之为**代谢物**，以及转化它们的机器或过程，我们称之为**反应**。一个关键的观察是，材料不会神奇地变成其他材料；它们必须经过一个过程。而过程不会作用于其他过程；它们的行为是通过它们共享的材料来介导的。

这个简单的逻辑——连接只存在于代谢物和反应之间——告诉我们，[代谢网络](@entry_id:166711)具有一种特殊的结构。用数学语言来说，它是一个**二分图**，有两个不同的节点集（代谢物和反应），而边只连接一个集合中的节点与另一个集合中的节点 [@problem_id:5002370]。

这种结构可以完美地记录在一个简单的表格中，也就是我们所说的**化学计量矩阵**，用符号 $S$ 表示。可以把它看作是整个细胞的总账本。这个矩阵的每一行对应一个特定的代谢物。每一列对应一个特定的反应。矩阵中任意给定单元格的数字 $S_{ij}$ 是**[化学计量系数](@entry_id:204082)**：它告诉我们反应 $j$ 产生或消耗了多少单位的代谢物 $i$。

按照惯例，我们用负数表示反应物（被消耗的代谢物），用正数表示产物（被产生的代谢物）。如果一种代谢物没有参与某个反应，其系数就是零。例如，如果一个反应将一个分子 $M_1$ 和一个分子 $M_3$ 转化为两个分子 $M_2$（即 $M_1 + M_3 \to 2 M_2$），那么矩阵中代表这个反应的列，在 $M_1$ 对应的行会有 -1，在 $M_2$ 对应的行会有 +2，在 $M_3$ 对应的行会有 -1 [@problem_id:5002370]。这个矩阵 $S$ 是[细胞代谢](@entry_id:144671)能力的静态蓝图。

### 平衡之舞：[稳态假设](@entry_id:269399)

静态蓝图很有用，但我们想看到工厂运作起来的样子。我们想知道所有反应的速率——它们的**通量**。让我们将网络中所有的通量表示为一个向量 $\mathbf{v}$。我们怎样才能 figuring out $\mathbf{v}$ 应该是什么呢？

一个活细胞，尤其是在稳定环境中生长的微生物，是动态平衡的奇迹。虽然内部活动纷繁复杂，但大多数内部代谢物的浓度却保持着惊人的恒定。这就是我们模型的基石：**[准稳态假设](@entry_id:273480)**。这意味着对于任何内部代谢物，其总产生速率必须等于其总消耗速率。没有净积累或耗尽。

这个简单的物理原理有一个极其简洁的数学表达式：
$$
S\mathbf{v} = \mathbf{0}
$$
这一个方程是[基于约束的建模](@entry_id:173286)跳动的心脏 [@problem_id:5002473]。它表明，当你将细胞的整个蓝图 ($S$) 乘以其所有[反应速率](@entry_id:185114)的向量 ($\mathbf{v}$) 时，结果是一个零向量。这为每一个代谢物强制执行了完美的质量平衡。所有满足这个条件的可能通量向量 $\mathbf{v}$ 的集合，就是数学家所说的矩阵 $S$ 的**[零空间](@entry_id:171336)**。它是细胞工厂在平衡、自洽状态下所有可能运作方式的空间。

### 开放的对话：边界条件与交换反应

方程 $S\mathbf{v} = \mathbf{0}$ 描述的是一个完全封闭、自给自足的系统。但当然，细胞不是封闭系统。它们必须摄食、呼吸和排泄废物才能生存。为了使我们的模型更 realistic，我们需要为它打开通向外部世界的门窗。

我们通过添加称为**交换反应**的特殊伪反应来实现这一点 [@problem_id:3917860]。这些反应是我们的模型与其环境的接口，允许特定的代谢物穿过[系统边界](@entry_id:158917)。对于细胞可以消耗的每一种营养物质（如葡萄糖或氧气）和它可以分泌的每一种副产品（如乳酸或乙醇），我们都添加一个交换反应。

通过这些交换反应的通量由我们施加的**边界条件**（即下限和上限）所决定。符号约定至关重要：负通量代表**吸收**（细胞从环境中获取物质），正通量代表**分泌**（细胞向环境中释放物质）。想要模拟富含葡萄糖的培养基？我们将葡萄糖交换通量的下限设置为一个很大的负数，以允许充足的吸收。模拟无氧（anaerobic）环境？我们将氧气交换通量的上下限都设置为零 [@problem_id:3917860]。这些边界以及[化学计量关系](@entry_id:144494)，共同定义了细胞代谢的“竞技场”。

对于某些普遍存在的分子，如细胞的主要能量货币 ATP，会出现一个关键的微妙之处。有人可能会问，为什么不直接允许细胞通过交换反应从环境中“吸收” ATP 呢？原因很深刻。这样做就像给我们的模型一个神奇的、无限的自由能源来源——一台[永动机](@entry_id:184397) [@problem_id:1445726]。实际上，细胞必须通过燃烧葡萄糖等燃料来 painstakingly地生成每一个 ATP 分子。为了强制执行这一基本的[热力学约束](@entry_id:755911)，像 ATP 和[氧化还原](@entry_id:138446)载体 NADH 这样的**通货代谢物**被视为純粹的内部物质。它们的产生和消耗必须像任何其他内部代谢物一样完美平衡为零。在细胞经济学中没有免费的午餐。

### 生命所為何事？目标函数与 FBA

现在我们有了一个系统 ($S\mathbf{v} = \mathbf{0}$) 和一套规则（通量边界），它们共同定义了一个包含所有可行代谢状态的空间。但这个空间通常是巨大的；细胞可以有无数种方式来平衡其账目。细胞究竟选择了哪一种呢？

在这里，我们必须对细胞的目的做一个假设。借鉴[进化论](@entry_id:177760)，一个普遍的假设是微生物的主要目标是尽可能快地生长和分裂。为了将这种生物驱动力转化为数学目标，我们引入了另一个绝妙的合成工具：**生物质方程** [@problem_id:2045126]。这是一个特殊的“需求”反应，它以构建一个新细胞所需的确切比例消耗所有必要的组成模块——氨基酸、用于 DNA/RNA 的[核苷](@entry_id:195320)酸、用于细胞膜的脂质以及必需的辅因子。它还考虑了这种合成的能量成本，例如聚合所需的 ATP。生物质方程巧妙地将数十个 disparate 的[生物合成途径](@entry_id:176750)耦合到一个统一的目标上：增殖。

现在我们可以陈述完整的问题了。这个方法被称为**流通平衡分析 (FBA)**。它是一个优化问题：
*给定[化学计量矩阵](@entry_id:275342) $S$ 和通量边界，找到一个通量向量 $\mathbf{v}$，该向量 (1) 满足[稳态](@entry_id:139253)条件 $S\mathbf{v} = \mathbf{0}$，(2) 遵守所有通量边界，并且 (3) 最大化通过生物质方程的通量* [@problem_id:5002473]。

这个问题可以使用一种叫做线性规划的数学技术来高效求解。解给我们一个预测：在给定环境条件下，当细胞尽其所能生长时，其所有[代谢通量](@entry_id:268603)的完整快照。然后我们可以在实验室中检验这些预测。

### 从蓝图到工厂：基因的角色

我们有了工厂的地图 ($S$) 和它运作的规则 (FBA)。但是地图本身从何而来？它来自生物体的基因组，即其遗传蓝图。基因与它们催化的反应之间的联系是通过**[基因-蛋白质-反应 (GPR) 关联](@entry_id:749777)**建立的 [@problem_id:1434466]。

对于我们模型中的每一个反应，我们使用基因组和生物化学数据库来识别编码执行该反应的酶的基因。这个逻辑通过简单的布尔规则来捕捉：
-   如果需要多个基因来形成一个功能性的酶复合物，它们通过 `AND` 运算符连接。所有基因都必须存在，反应才能激活。
-   如果几个不同的基因编码的酶可以独立催化同一个反应（[同工酶](@entry_id:171985)），它们通过 `OR` 运算符连接。这些基因中的任何一个都足够。

GPR 提供了一座强大的桥梁，连接了生物体的基因型和其代谢表型。通过解读基因组，我们可以构建网络地图。更重要的是，我们可以模拟[基因突变](@entry_id:166469)的效果。如果我们在模型中“敲除”一个基因，GPR 规则会告诉我们哪些反应被禁用了。然后我们可以在修改后的网络上运行 FBA，以预测该突变将如何影响细胞的生长或其产生某种化合物的能力。

### 效率的艺术：简约与稀缺

FBA 找到的解给出了*最大可能*的生长速率。然而，可能存在许多不同的通量分布——即许多不同的代谢物在网络中的路由方式——它们都可以达到这个相同的最优生长速率。所有这些解都同样合理吗？

也许不是。考虑两种制造产品的方式：一种是短而直接的途径，另一种是漫长曲折的迂回路线。两者都可能完成任务，但长路径需要更多的总酶机器来维持相同的[吞吐量](@entry_id:271802)。假设进化会偏爱效率似乎是合理的。这就是**简约 FBA (pFBA)** 背后的思想 [@problem_id:1456658]。这是一个两步优化：首先，像标准 FBA 一样找到最大生长速率。其次，在将生长速率固定在这个最大值的同时，找到实现它但最小化所有反应通量之和的通量分布。pFBA 假设细胞不僅是一个优化者，还是一个节俭的优化者，用最少的代谢努力实现其目标。

代谢中的成本与价值这一概念引出了另一个优美的概念，它借鉴自经济学：**影子价格** [@problem_id:4399361]。在任何约束优化问题中，每个约束都有一个相关的影子价格，它告诉你如果该约束能放宽一个单位，目标函数会改善多少。对于我们 FBA 问题中的一个代谢物，其影子价格就是它对生长的边际价值。一个具有高正影子价格的代谢物是一个严重的瓶颈；细胞“渴望”得到它，获得更多将显著促进生长。一个影子价格为零或负的代谢物则处于过剩状态。这不仅仅是数学上的好奇心；它是对代谢稀缺性的定量预测，是一个可能驱动[基因调控](@entry_id:143507)进化的信号。

### 机器的代价：整合表达成本

我们的模型已经变得相当复杂，但我们仍然免费获得了一些东西：酶本身。实际上，运行代谢工厂的蛋白质机器的构建和维护成本高得惊人。细胞的大部分能量和资源都用于合成其基因编码的蛋白质。

下一代代谢模型，被称为**代谢与表达 (ME) 模型**或**资源平衡分析 (RBA) 模型**，明确地考虑了这些成本 [@problem_id:4394023] [@problem_id:3324701]。它们扩展了[化学计量矩阵](@entry_id:275342)，以包括转录和翻译过程。模型现在必须通过花费核苷酸和氨基酸前体来“支付”酶的费用。

在这些模型中，一个反应的通量 $v_j$ 不再仅仅是受限的；它通过一个催化能力约束，如 $v_j \le k_j e_j$，与其相应酶的量 $e_j$ 显式耦合。此外，细胞可以制造的蛋白质总量受到全局资源预算的限制（例如，总[蛋白质组](@entry_id:150306)质量或核糖体的有限数量）。这创造了一个深刻的反馈循环：为了实现高[代谢通量](@entry_id:268603)，细胞需要大量的酶；但制造大量的酶会消耗本可用于生长的资源。模型现在必须解决最终的资源分配问题：如何在其有限的资源中分配，以制造代谢酶和制造新细胞的所有其他组件。这使我们更近一步地迈向对生命中物质与能量的复杂之舞的真正整体性、全细胞的理解。

