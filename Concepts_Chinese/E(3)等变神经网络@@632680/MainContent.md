## 引言
机器学习彻底改变了数据分析，但标准[神经网](@entry_id:276355)络常常难以处理物理世界中的一个基本概念：对称性。一个在特定分子上训练的模型，当该分子被简单旋转后，可能就无法识别出是同一个分子。这一局限性使得它们在科学应用中效率低下且不可靠。本文探讨了解决方案：E(3)[等变神经网络](@entry_id:137437)。这是一类在架构中就內建了物理定律的模型。通过內在地理解三维空间的对称性，这些网络实现了卓越的数据效率和物理真实感。首先，我们将深入探讨**原理与机制**，解析[不变性](@entry_id:140168)和[等变性](@entry_id:636671)的核心概念，并探索构成网络基础模块的数学工具，如几何张量和[球谐函数](@entry_id:178380)。然后，我们将遍历其多样化的**应用与跨学科联系**，了解这些具备对称性感知的模型如何改变从[计算化学](@entry_id:143039)、[材料科学](@entry_id:152226)到生物学和核物理学的各个领域。

## 原理与机制

### 物理学家的北极星：对称性

想象一下，你正身处一艘远离任何恒星或行星的宇宙飞船中，看到一个完美的球体漂浮在面前。你闭上眼睛，你的朋友偷偷旋转了这个球体。当你睁开眼睛时，你能分辨出有什么变化吗？当然不能。无论你怎么转动，球体还是那个球体。这个简单的想法——一个物体或一条物理定律的描述不应依赖于你的观察视角——是所有科学中最强大、最深刻的原则之一。物理学家称这个原则为**对称性**。

几个世纪以来，这一直是我们的北极星。支配分子之舞、[行星运动](@entry_id:170895)和星系结构的物理定律，无论你今天还是明天测试（时间对称性），在这里还是在宇宙的另一端测试（空间对称性），以及对我们的故事至关重要的，无论你面朝北还是面朝东测试（方向对称性），都是相同的。

对应我们日常空间经验的变换群被称为**欧几里得群**，或 $E(3)$。它包含了所有可以在不拉伸或弯曲一个刚体的情况下移动它的方式：
*   **平移**：在不改变物体方向的情况下移动其位置。
*   **旋转**：围绕一个点转动物体。
*   **反射**：在镜子中看物体。

任何支配原子系统（如分子）的物理定律都必须遵守这种 $E(3) $ 对称性。例如，一个水分子的总能量绝不可能取决于它是在你的实验室里，还是在遥远的星云中，也不取决于它是朝上还是朝下。如果我们要建立真实的世界模型，就必须将这种对称性融入其灵魂深处[@problem_id:2784668]。

### 教计算机像物理学家一样观察

现在，假设我们想构建一个机器学习模型——一个[神经网](@entry_id:276355)络——来根据原子位置预测分子的能量。“朴素”的方法是简单地将每个原子的 $x, y, z$ 坐标输入一个大型、强大的网络，并让它学习这些数字与能量之间的联系。

这种方法会彻底失败。

想象一下，用成千上万个铅笔竖直立在桌子上的例子来训练这样一个网络。它可能会在预测竖直铅笔的属性方面变得非常出色。但是，当你给它看一张*完全相同*但横放的铅笔的图片时，会发生什么呢？对于这个朴素的网络来说，这是一个全新的物体。它接收到的坐标列表完全不同，并且它没有任何先验知识告诉它这只是它已经见过物体的旋转版本。它将不得不从头开始学习关于横放铅笔的知识。这是极其低效的。这就像每次书本倾斜时都必须重新学习如何阅读一样。

这揭示了构建智能模型时的一个根本选择。我们是希望模型足够聪明，能从海量数据中*学习*到对称性，还是将对称性直接构建到其架构中？后一种方法被称为施加**[归纳偏置](@entry_id:137419)**。通过将视角和旋转的规则硬编码到模型中，我们赋予了它对世界的“常识性”理解。这样的模型数据效率极高，其预测的泛化能力也更好，因为它知道旋转后的铅笔仍然是铅笔[@problem_id:2629354]。

### 对称性的语言：[不变性](@entry_id:140168)与[等变性](@entry_id:636671)

为了将这种对称性构建到我们的模型中，我们首先需要一种精确的语言来描述它。这种语言区分了两个相关概念：[不变性](@entry_id:140168)（invariance）和[等变性](@entry_id:636671)（equivariance）。

#### 不变性：当没有任何改变时

一些物理量是简单的数字，或称**标量**，它们没有[方向性](@entry_id:266095)。分子的总[势能](@entry_id:748988)就是一个完美的例子。如果我们旋转分子，它的能量不会改变。我们说能量在旋转下是**不变的**。对于我们群 $E(3)$ 中的任何变换 $g$（如旋转或平移），一个预测不变性的函数 $f$ 必须满足：

$$
f(g \cdot X) = f(X)
$$

其中 $X$ 代表原子坐标集，而 $g \cdot X$ 代表变换后的坐标。输出是完全相同的[@problem_id:3463901]。

#### [等变性](@entry_id:636671)：和谐地变换

然而，其他量确实有方向。想想作用在每个原子上的**力**。这些是**矢量**。如果我们旋转一个分子，作用在其原子上的力矢量必须随之和谐地旋转。它们不会保持不变（那将是错误的！），但它们也不会随机变化。它们*随*系统一起变换。这个属性被称为**[等变性](@entry_id:636671)**。对于一个预测矢量集的函数 $f$，条件是：

$$
f(g \cdot X) = \rho(g) f(X)
$$

这里，$\rho(g)$ 是变换 $g$ 的“表示”，它告诉我们一个矢量应该如何变化。如果 $g$ 是由矩阵 $\mathbf{R}$ 描述的旋转，那么 $\rho(g)$ 就是 $\mathbf{R}$。这个方程说明，先对输入进行变换再应用函数，与先应用函数再对输出进行变换，结果是相同的[@problem_id:2784668][@problem_id:3422804]。

这种区分不仅仅是数学上的吹毛求疵；它对于构建物理上正确的模型至关셔重要。一个预测力是*不变的*模型将是荒谬的——这意味着无论你如何转动分子，其原子上的力总是指向同一个绝对方向，这在物理上是不可能的[@problem_id:3422804]。

自然界为我们提供了一条优美而强大的捷径。事实证明，如果你能构建一个模型来计算**不变的**标量能量 $E$，那么力就可以通过其负梯度得到，$\mathbf{F}_i = -\nabla_{\mathbf{r}_i} E$。矢量微积分的一个基本定理保证了这些力将自动是**等变的**！通过专注于正确计算不变的能量，我们免费获得了等变的力[@problem_id:2784682][@problem_id:2648604]。

### [等变网络](@entry_id:143881)的构建模块

那么，我们如何构建一个能讲这种对称性语言的网络呢？我们可以把分子中的原子看作图中的节点，网络的任务是在它们之间传递信息，以了解每个原子的局部环境。

**简单部分：平移**

处理平移对称性很简单。物理相互作用取决于原子的*相对*位置，而不是它们在空间中的绝对位置。因此，我们的网络将只使用原子对之间的[位移矢量](@entry_id:262782) $\mathbf{r}_{ij} = \mathbf{r}_j - \mathbf{r}_i$，而不是原始坐标 $\mathbf{r}_i$。如果我们整个系统平移一个矢量 $\mathbf{t}$，这些[位移矢量](@entry_id:262782)保持不变：$(\mathbf{r}_j + \mathbf{t}) - (\mathbf{r}_i + \mathbf{t}) = \mathbf{r}_j - \mathbf{r}_i$。通过完全基于这些相对输入构建我们的网络，我们自动实现了对所有平移的不变性[@problem_id:2898815][@problem_id:2648604]。

**旋转的魔力：几何张量**

处理旋转则更为精妙，并且是[等变网络](@entry_id:143881)的核心。我们不能简单地将[位移矢量](@entry_id:262782)的 $x, y, z$ 分量用于标准网络层，因为这会以破坏[旋转对称](@entry_id:137077)性的方式将它们混在一起。

解决方案是，将我们网络中的所有特征表示为定义明确的几何对象——**张量**，而不仅仅是简单的数字列表。这些张量携带了关于它们在旋转下应该如何变换的信息。这是一个深刻的转变。网络操作的不再是数字，而是矢量、矩阵和其他高阶对象。

为此，我们借鉴了量子力学中一个优美的数学框架：**[球谐函数](@entry_id:178380)**。这些是在球面上定义的一组[特殊函数](@entry_id:143234)。可以把它们看作是球体的基本“[振动](@entry_id:267781)模式”。至关重要的是，它们在旋转下的变换方式非常简单且结构化。我们可以通过类型 $\ell$ 来对我们的特征进行分类，它对应于[旋转群](@entry_id:204412) $SO(3)$ 的一个[不可约表示](@entry_id:263310)。
*   类型 $\ell=0$ 的特征是**标量**：它在旋转下不发生改变。
*   类型 $\ell=1$ 的特征是**矢量**：它的旋转方式与三维空间中的普通矢量完全相同。
*   类型 $\ell=2$ 的特征是**[四极张量](@entry_id:276086)**，以此类推 [@problem_id:2648604]。

我们网络的层由遵守这些变换规则的操作构成。主要的操作是**[张量积](@entry_id:140694)**。当我们组合两个几何对象时——比如，一个原子上类型为 $\ell_1$ 的特征与代表其邻居方向的类型为 $\ell_2$ 的特征——我们得到一个新的、更复杂的对象。

这就是魔力所在。一组固定的、不可学习的数，称为**[Clebsch-Gordan系数](@entry_id:142551)**，为将这个复杂对象分解回不可约对象（新的标量、矢量等）的简单总和提供了精确的配方。这个过程在数学上与物理学家计算两个量子粒子结合时总角动量的方式完全相同。通过使用这些系数作为不可训练的骨架，我们保证了如果一个层的输入是合适的几何张量，其输出也同样如此。[等变性](@entry_id:636671)在每一步都得到完美保持[@problem_id:3449548]。

然后网络逐层进行，组合这些等变特征，以建立对原[子环](@entry_id:154194)境的更丰富、更复杂的描述。为了得到最终的不变能量，网络只需产生一个标量输出——一个类型为 $\ell=0$ 的特征。这是通过以保证[旋转不变性](@entry_id:137644)的方式缩并所有张量特征来实现的[@problem_id:3449548]。

### 扩展交响乐

这个强大的框架可以被扩展，以捕捉物理世界中更多微妙的对称性。

*   **宇称与手性**：那么反射呢？纯旋转群是 $SO(3)$。如果我们包含反射（就像照镜子），我们得到完整的[正交群](@entry_id:152531) $O(3)$。一些被称为手性分子的分子，与其镜像不同，就像我们的左手和右手。通过为我们的特征分配一个“宇称”标签，网络可以区分[极性矢量](@entry_id:184542)（如力，在镜子中会反向）和轴向矢量（如角动量，不会反向）。这使得模型能够正确处理手性，这是化学和生物学中至关重要的属性[@problem_id:3449477]。

*   **[置换](@entry_id:136432)与不可区分性**：在水分子中，两个氢原子是相同的。如果我们交换它们的标签，一个物理上正确的模型不应改变其预测。这种[置换对称性](@entry_id:185825)是通过使用与顺序无关的操作来强制实现的。例如，我们可以简单地将特征相加，而不是将它们连接成一个列表[@problem_id:3449439]。

*   **周期性与晶体**：对于像晶体这样的材料，它由重复的原子[晶格](@entry_id:196752)组成，邻居的概念可以通过[周期性边界条件](@entry_id:147809)来扩展。通过使用“[最小镜像约定](@entry_id:142070)”来寻找邻居，我们可以应用完全相同的等变消息传递机制来预测无限晶体固体的性质，为[计算材料发现](@entry_id:747624)打开了大门[@problem_id:3463901]。

通过将自然的这些基本对称性构建到我们[神经网](@entry_id:276355)络的架构中，我们超越了脆弱的[模式识别](@entry_id:140015)。我们创造了融入物理学家直觉的模型，使其能够以卓越的效率和准确性学习原子世界复杂而优美的定律。

