## 引言
几十年来，理解[基因序列](@article_id:370112)与其功能之间错综复杂的关系一直是一个极其缓慢的过程，通常仅限于一次研究一个突变。这种经典方法对于广阔而复杂的领域只能提供一些零星的见解。[深度突变扫描](@article_id:375069)（DMS）代表了一种[范式](@article_id:329204)转变，它是一种高通量方法，使科学家能够同时测量成千上万甚至数百万个突变的功能性后果。它将一系列孤立的问题转变为一个宏大而全面的实验，为蛋白质的功能世界提供了一幅前所未有的地图。

本文旨在解决将[基因型与表型](@article_id:303120)联系起来的可扩展方法这一根本需求。它为这项强大的技术提供了指南，解释了其理论基础和革命性影响。接下来的章节将首先在“原理与机制”中解析这项技术背后的精妙逻辑，详细说明试管中的“遗传学奥运会”如何与现代测序技术相结合，揭示每个突变的精确适应度分数。随后，“应用与跨学科联系”将探讨被DMS改变的各个领域，从设计更好的蛋白质和抗变异[疫苗](@article_id:306070)，到绘制进化本身的结构。

## 原理与机制

那么，这台奇妙的机器是如何工作的呢？我们如何能在一个宏大的实验中，为一个蛋白质绘制出十万个不同突变的后果图谱？这不是魔法，而是遗传学、[种群生物学](@article_id:314075)和计算机科学思想的完美结合。其逻辑如物理定律般清晰而强大。让我们来逐步了解其原理。

### 试管中的遗传学奥运会

想象一下，你想在一个国家里找到跑得最快的人。你可以为每个人单独进行计时赛，一个接一个。这既费时又费力，而且成本高昂。这正是研究突变的经典方法。或者，你可以让所有人站在一条巨大的起跑线上，让他们同时赛跑。最先冲过终点线的少数人显然是最快的。

[深度突变扫描](@article_id:375069)（DMS）采用的是第二种方法。我们不是在各自孤立的孔中一次研究一个蛋白质变体，而是创建一个巨大且多样的变体文库——成千上万，甚至数百万个——并将它们全部放入一个“池”中[@problem_id:2761240]。这个池可能是一瓶细菌或酵母培养物，也可能是一个病毒群体。这是一场遗传学奥运会，比赛即将开始。

为了使这场比赛有意义，有两件事是绝对必要的。首先，编码特定蛋白质变体的基因——其**基因型**（genotype）——必须与蛋白质本身——其**表型**（phenotype）——物理上相连。对细菌来说，这很简单：基因在其[染色体](@article_id:340234)中，它制造的蛋白质在同一个细胞内发挥作用。其次，蛋白质的功能必须与一个“可选择的”结果相关联。例如，如果我们研究一种帮助细菌消化特定营养物的酶，我们可以在以该营养物为唯一食物来源的培养基中培养整个池。拥有更优酶的细胞会生长得更快，繁殖得更多。而[酶功能](@article_id:351675)失调的细胞则会饿死并消失。蛋白质的性能与其宿主的生存和繁殖直接挂钩[@problem_id:2761240]。这就是实验的引擎：自然选择，被压缩在实验室的几天之内。

### 用[DNA测序](@article_id:300751)仪统计终点选手

让比赛进行一段时间后——可能是几个小时或几天，相当于几代生长的时间——我们如何知道谁赢了？我们无法观察数百万个细胞中的每一个。解决方案是DMS的第二个关键支柱：**高通量DNA测序**。

我们在文库中创建的每个变体都有一个独特的DNA序列，一种遗传“条形码”。在竞赛开始前，我们从池中取样，并使用DNA测序仪进行普查。我们只需计算每个条形码出现的次数。这为我们提供了每个竞争者的起始频率，我们称之为变体 $i$ 的 $f_i^{\mathrm{pre}}$。然后，我们让选择发生——即比赛。之后，我们再取另一个样本，做完全相同的事情，通过测序得到选择后的频率 $f_i^{\mathrm{post}}$ [@problem_id:2701213]。

其核心思想是，测序读数计数与群体中每个变体的丰度成正比[@problem_id:2761240]。在选择中表现出色的变体将会增殖，因此其在选择后池中的频率将高于其起始频率。表现不佳的变体则会被淘汰，其频率会下降。通过简单比较“之前”和“之后”的频率，我们就能同时得知每个变体的比赛结果。这就是汇集式方法的威力所在。

### 适应度的物理学：将计数转化为分数

现在，我们必须更精确一些。我们如何将这些原始计数转化为一个有意义的**适应度分数**？一个读数从100增加到200的变体，与一个读数从1000增加到2000的变体，它们的适应度是否相同？直观上看，是的。两者相对于总体的丰度都增加了一倍。这表明，比例才是关键。

变体 $i$ 相对于整个群体平均水平的表现由其**[富集分数](@article_id:356387)**（enrichment score）来体现，该分数即为其选择后频率与选择前频率的比值：

$$
\text{富集分数}_i = \frac{f_i^{\mathrm{post}}}{f_i^{\mathrm{pre}}}
$$

这解决了起跑线问题：一个一开始就遥遥领先（初始频率高）的变体不会被不公平地奖励。我们只关心其频率*相对于其自身起点*的变化[@problem_id:2834109]。

为了数学上的优美和统计上的便利，我们对这个[富集分数](@article_id:356387)取自然对数。这将乘性适应度效应转化为一个加性尺度，处理起来更为方便。这个**对数[富集分数](@article_id:356387)**，通常表示为 $\ell_i$，是DMS的标准度量单位：

$$
\ell_i = \ln\left( \frac{f_i^{\mathrm{post}}}{f_i^{\mathrm{pre}}} \right)
$$

正分表示该变体是有益的（其增长速度快于群体平均水平）。负分表示它是有害的。接近零的分数则表示它是中性的。如果你在多个时间点追踪群体，你会观察到一个变体频率与参照物频率的对数比值随世代呈线性变化，这条线的斜率便为你提供了一个精确校准的[选择系数](@article_id:315444)[@problem_id:2689224]。

在实践中，我们使用测序计数来估计真实频率 $f_i$。如果 $n_i^{\mathrm{pre}}$ 是变体 $i$ 在选择前文库中的读数计数，而 $N^{\mathrm{pre}}$ 是该文库的总读数，那么其频率估计为 $f_i^{\mathrm{pre}} \approx n_i^{\mathrm{pre}} / N^{\mathrm{pre}}$。为避免因某个变体碰巧获得零读数而导致除以零，我们为每个计数添加一个微小的“伪计数”。最终的分数通常相对于野生型（WT）变体进行计算，以抵消普遍性效应，从而得出一个基于“双重比率”计数的美丽而稳健的公式[@problem_id:2701213]：

$$
\ell_i = \ln\left( \frac{n_i^{\mathrm{post}}/n_i^{\mathrm{pre}}}{n_w^{\mathrm{post}}/n_w^{\mathrm{pre}}} \right) = \ln\left(\frac{n_i^{\mathrm{post}} n_w^{\mathrm{pre}}}{n_i^{\mathrm{pre}} n_w^{\mathrm{post}}}\right)
$$

这个简单的表达式源于种群遗传学的基本原理，是[深度突变扫描](@article_id:375069)的数学核心。

### 定义“正常”：内部对照的精妙之处

现在我们有了一个分数。但是，一个分数需要多大才能被认为是“真实的”？-0.5的分数听起来可能很差，但如果实验噪音本身就经常产生-0.6到+0.6之间的分数呢？我们需要一个衡量“中性”的标准。

这就是DMS最巧妙的方面之一。DNA编码是冗余的。有64种可能的三字母[密码子](@article_id:337745)，但只有20种氨基酸。例如，`CUU`、`CUC`、`CUA`和`CUG`这几个[密码子](@article_id:337745)都编码亮氨酸。将`CUU`变为`CUC`的突变被称为**同义突变**。它改变了DNA序列，但最终的蛋白质是完全相同的。

作为一阶近似，这些同义变体在功能上应与野生型完全相同。它们是我们实验中内置的完美“安慰剂”或[对照组](@article_id:367721)[@problem_id:2799946]。通过测量我们文库中所有同义变体的适应度分数，我们可以构建一个**经验性零分布**。这个分布通常是一个以零为中心的[正态分布](@article_id:297928)曲线，它向我们展示了纯粹由实验噪音和DNA变化本身（如对[mRNA稳定性](@article_id:301208)的影响）所产生的次要生物学效应所导致的分数范围。

一旦我们有了这个分布，我们就可以描述其均值和[标准差](@article_id:314030)。现在，我们有了一种统计上严格的方法来分类任何其他突变。如果一个**[错义突变](@article_id:298071)**（即*确实*改变了氨基酸的突变）的分数，比如说，比我们同义“零”分布的均值低三个标准差以上，我们就可以自信地称其为有害的。如果它远高于此，它就是有益的。如果它落入那个噪音的中心带内，我们就称之为近中性的[@problem_id:2799920] [@problem_id:2851569]。这是一种美妙的、数据驱动的方法，用以区分信号和噪音。

### 精度的前沿：优化图景

基本原理为我们提供了一个强大的工具，但对科学真理的追求是对更高精度的追求。现代DMS分析融合了多层统计复杂性，以创建尽可能精确的图谱。

首先，并非所有的测量都生而平等。一个在“前”和“后”池中都有数千个读数的变体，其适应度分数的测量精度要远高于只有少数读数的变体。先进的统计方法通过在合并重复实验数据时，给予更高精度的测量值更大的“权重”来解决这个问题。这被称为**反方差加权**[@problem_id:2799920]。

其次，如果我们的文库不完整怎么办？有时，制造出每一个变体是不可行的。在这些数据稀疏的情况下，我们可以使用一种称为**正则化**的原则性统计怀疑方法。我们从一个“先验”信念开始，即大多数突变几乎没有影响。只有在有压倒性的强有力数据支持时，模型才会为一个突变赋予大的适应度效应。这有助于防止从仅有一两个变体的噪声测量中得出错误的巨大适应度估计[@problem_id:2851656]。

最后，任何复杂实验中最大的潜在误差来源或许是科学家自己。面对数百万个数据点，人们可能会倾向于调整分析参数，直到出现预期或有趣的结果——这种现象被称为**[p值操纵](@article_id:323044)**（[p-hacking](@article_id:323044)）。对此的解药是**预注册**。在实验开始之前，研究人员可以公开发布他们完整的分析计划：哪些变体是主要假设，数据将如何过滤和[归一化](@article_id:310343)，以及将使用哪些统计检验。这种“预先声明”的行为锁定了分析计划，确保验证性结果是以完全统计诚实的方式获得的。之后对数据的任何进一步探索都将被明确标记为“探索性的”，需要独立的验证[@problem_id:2851622]。

### 结果：一幅描绘进化可能性的地图

当一切尘埃落定后，我们创造了什么？我们生成了一个**[适应度景观](@article_id:342043)**。可以把它想象成一张地形图。每一个可能的基因型都是地图上的一个坐标，其测得的适应度分数就是该点的高度。有益的突变是通往适应度“山峰”的上坡路。有害的突变则通向适应度“山谷”的下坡路。

借助DMS，我们可以创建这片景观前所未有的详尽局部地图。我们可以测量从一个起始蛋白质出发的每一个氨基酸替换的适应度，揭示蛋白质的哪些部分是刚性约束的，哪些可以容忍变化。尽管可能性的数量是巨大的——对于一个仅含100个氨基酸的普通蛋白质，其多突变变体的数量比宇宙中的原子还多——这意味着我们永远无法绘制出*整个*景观，但DMS让我们能够以精妙的细节绘制出我们所处的局部区域[@problem_id:2705804]。

这张地图不仅仅是学术上的好奇心。通过向我们展示高适应度的路径，它可以帮助我们预测病毒如何进化以逃逸[抗体](@article_id:307222)[@problem_id:2834109]，或指导我们为工业应用设计新的酶。在非常真实的意义上，它是一份关于进化过程本身的备忘单。