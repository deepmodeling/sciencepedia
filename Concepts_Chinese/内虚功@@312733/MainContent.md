## 引言
当我们想到“功”时，我们通常会想象一个外力移动一个物体，就像推一个箱子穿过地板。但是，当箱子在载荷下变形时，其*内部*发生的功又是怎样的呢？这种无形的功分布在材料的整个构造中，被称为内功。准确地描述这种复杂的内部状态是力学中的核心挑战之一，也是预测任何结构——从微芯片到摩天大楼——将如何表现的关键。内[虚功原理](@article_id:299197)为这个问题提供了一个极其优雅而强大的解决方案。

本文将探讨固体力学的这一基石。首先，在“原理与机制”部分，我们将通过一系列“如果”思想实验来剖析理论本身，揭示应力、应变和能量之间的基本关系。我们将发现为什么只有变形而非[刚体转动](@article_id:332325)对内功有贡献，以及该原理如何将牛顿平衡定律作为一种特殊情况包含在内。随后，“应用与跨学科联系”部分将展示该原理巨大的实际应用能力，说明它如何作为有限元法的引擎，帮助预测结构失效，甚至推动高速计算仿真的未来发展。

## 原理与机制

### 功的内部世界

在我们的日常经验中，功很简单：你推一个箱子，你做的功就是你施加的力乘以箱子移动的距离。这是一个直观的概念。但是箱子*内部*发生的功呢？当你推它时，箱子会轻微地被挤压变形。其内部纤维受力，并相互之间发生相对移动。这种内部力与内部变形之间错综复杂的相互作用也构成**功**。这就是**[内虚功](@article_id:351405)**的领域，它不仅是一个学术上的好[奇点](@article_id:298215)，更是我们建立对结构和[材料行为](@article_id:321825)理解的基石。

想象一块果冻。如果你戳它，你的手指施加了一个外力。但作为回应，整块果冻都会晃动和变形。应力在其内部各处产生。这些内应力在材料重组自身时所做的功就是内功。为了分析像桥梁、飞机机翼，甚至生物细胞这样的复杂结构，我们需要一种方法来描述这种巨大且分布广泛的内部作用。

### 一个“如果”实验：虚的威力

正是在这里，物理学家和工程师们采用了一个非常巧妙的技巧，这个想法如此强大，以至于感觉像是在作弊。我们不追踪在真实的、耗时的过程中所做的*实际*功，而是进行一个思想实验。我们问：“如果我给系统一个微小的、瞬时的、假想的推动会怎样？”这个假想的推动被称为**[虚位移](@article_id:348023)**，用符号$\delta\boldsymbol{u}$表示。它不是一个随时间发生的真实运动；它是物体构型的一个假设性变化，且与物体的约束条件相符（例如，如果一端被固定，我们的[虚位移](@article_id:348023)就不能移动那一端）。

这引出了力学中最为优雅和强大的陈述之一：**虚功原理（PVW）**。它指出，如果一个物体处于平衡状态（意味着它没有加速），那么对于你所能想到的*任何*容许的[虚位移](@article_id:348023)，所有力（包括外力和内力）所做的总[虚功](@article_id:371793)之和必须为零。

$$ \delta W_{\text{ext}} + \delta W_{\text{int}} = 0 $$

想一想这意味着什么。这是一个深刻的平衡表述。它说，对于系统任何可以想象的微小变动，外加载荷所做的功与[内应力](@article_id:369929)场所做的功完全抵消。外力试图使物体变形，而内应力则在抵抗。在平衡状态下，它们处于完美的对峙状态。这个原理远比简单地说“力之和为零”要普遍得多，因为它将整个物体上的力和几何效应整合进了一个单一、紧凑的表述中。

### 变形的剖析：为何只有应变做功

现在让我们聚焦于[内虚功](@article_id:351405)$\delta W_{\text{int}}$。我们可能会天真地认为，[内虚功](@article_id:351405)密度就是应力张量$\boldsymbol{\sigma}$与虚[位移梯度](@article_id:344697)$\nabla \delta\boldsymbol{u}$的缩并。毕竟，应力是单位面积上的[内力](@article_id:346879)，而[位移梯度](@article_id:344697)描述了变形如何随点变化。因此，[内虚功](@article_id:351405)将是这个乘积在体积上的积分：$\int_{\Omega} \boldsymbol{\sigma} : \nabla\delta\boldsymbol{u} \, \mathrm{d}V$。

这很接近，但它忽略了一个美妙的精微之处。任何局部变形，由[张量](@article_id:321604)$\nabla\delta\boldsymbol{u}$描述，都可以唯一地分解为两部分：纯粹的拉伸和剪切，以及纯粹的转动[@problem_id:2676278]。在数学上，这是一个[张量分解](@article_id:352463)为其对称[部分和](@article_id:322480)反对称部分。

对称部分，$\delta\boldsymbol{\varepsilon} = \frac{1}{2}(\nabla\delta\boldsymbol{u} + (\nabla\delta\boldsymbol{u})^T)$，是**虚应变张量**。它捕捉了材料微元体形状和尺寸的变化——这部分变形实际上使材料产生应力。

反对称部分，$\delta\boldsymbol{\omega} = \frac{1}{2}(\nabla\delta\boldsymbol{u} - (\nabla\delta\boldsymbol{u})^T)$，是**虚[自旋张量](@article_id:366504)**。它代表了该材料微元体的无限小[刚体转动](@article_id:332325)，而其形状没有任何改变。

神奇之处在于此。经典[连续介质力学](@article_id:315536)的一个基石，源自[角动量平衡](@article_id:361208)，即**[Cauchy应力张量](@article_id:326933)$\boldsymbol{\sigma}$必须是对称的**。这意味着材料不能对其自身的无限小体积施加净扭转力矩。现在，[张量代数](@article_id:322075)的一个基本结论是，一个[对称张量](@article_id:308511)（如$\boldsymbol{\sigma}$）与一个[反对称张量](@article_id:370125)（如$\delta\boldsymbol{\omega}$）的缩并恒为零。

$$ \boldsymbol{\sigma} : \delta\boldsymbol{\omega} = 0 $$

其物理含义是惊人的：[虚位移](@article_id:348023)的转动部分对[内应力](@article_id:369929)不做功！只有那部分实际使[材料变形](@article_id:348581)的运动——即应变——才能对[内虚功](@article_id:351405)做出贡献[@problem_id:2676278] [@problem_id:2609703]。因此，[内虚功](@article_id:351405)的表达式优美地简化为：

$$ \delta W_{\text{int}} = \int_{\Omega} \boldsymbol{\sigma} : \delta\boldsymbol{\varepsilon} \, \mathrm{d}V $$

这告诉我们，应力$\boldsymbol{\sigma}$和应变$\boldsymbol{\varepsilon}$通过功的概念从根本上联系在一起。它们是一个**[功共轭](@article_id:373853)对**。内功是使材料产生应变的能量代价。你可以通过考虑一个简单的、预定的变形，比如均匀膨胀，来观察这一点。所做的功与该膨胀产生的应力以及你施加的虚应变直接相关[@problem_id:2591229]。

### 终极试金石：刚体运动

如果我们的[虚位移](@article_id:348023)是一个纯粹的[刚体运动](@article_id:329499)——比如说，我们将整个物体平移一个恒定量$\delta\boldsymbol{c}$并让它旋转一个微小角度$\boldsymbol{\delta\omega}$，会怎么样[@problem_id:2591190]？根据定义，刚体运动不涉及任何形状的改变。这就像移动一根钢梁而不使其弯曲或拉伸。

如果没有形状改变，就没有应变。直接计算证实，对于一个虚[刚体运动](@article_id:329499)$\delta\boldsymbol{u}_{\text{rb}} = \delta\boldsymbol{c} + \boldsymbol{\delta\omega} \times \boldsymbol{x}$，产生的虚应变张量$\delta\boldsymbol{\varepsilon}$在任何地方都精确为零[@problem_id:2591169] [@problem_id:2591190]。

这为我们的理论提供了一个至关重要的一致性检验。如果$\delta\boldsymbol{\varepsilon} = \mathbf{0}$，那么[内虚功](@article_id:351405)$\int_{\Omega} \boldsymbol{\sigma} : \mathbf{0} \, \mathrm{d}V$必须为零。这在物理上是显而易见的：如果物体只是刚性移动而不变形，那么没有内能被储存或释放。

但请记住虚功原理：$\delta W_{\text{ext}} + \delta W_{\text{int}} = 0$。如果我们将它应用于一个虚刚体运动，我们刚刚证明了$\delta W_{\text{int}} = 0$，那么$\delta W_{\text{ext}}$也必须为零。通过要求外[虚功](@article_id:371793)对于任意虚平移和任意虚转动都为零，我们便恢复了[静力学](@article_id:344615)的[全局平衡方程](@article_id:335987)：所有外力之和必须为零，所有外力矩之和也必须为零[@problem_id:2591190]！通过这种方式，虚功原理优雅地将牛顿平衡定律作为一种特殊情况囊括其中。

### 更深层次的联系：功、能量与材料的构造

那么，当材料弹性变形时，内功去了哪里？它以势能的形式储存起来，就像拉伸的弹簧中储存的能量一样。这被称为**应变能**。对于[超弹性材料](@article_id:369306)，我们可以定义一个[应变能密度函数](@article_id:378253)$W(\boldsymbol{\varepsilon})$，它告诉我们在给定的应变状态下，单位体积内储存了多少能量。

与我们关于功的讨论的联系来自热力学定律。对于一个可逆的（弹性的）、等温的过程，对材料做的任何功都必须直接转化为其储存能量的增加。单位体积的做功速率是$\boldsymbol{\sigma} : \dot{\boldsymbol{\varepsilon}}$（其中点表示“随时间的变化率”），而[能量储存](@article_id:328573)的速率是$\dot{W}$。对于这样的过程，我们必须有：

$$ \dot{W} = \boldsymbol{\sigma} : \dot{\boldsymbol{\varepsilon}} $$

这个等式必须对我们能想象的任何变形过程都成立。因此，我们可以用我们的虚变量替换时间变化率，得到$\delta W = \boldsymbol{\sigma} : \delta\boldsymbol{\varepsilon}$。这是一个深刻的结果。它表明，[内虚功](@article_id:351405)密度无非是储存[应变能](@article_id:342133)的变化[@problem_id:2591209]。

从微积分我们知道，一个函数的变化与其[导数](@article_id:318324)有关。这意味着一个极其优雅的[本构定律](@article_id:357811)：

$$ \boldsymbol{\sigma} = \frac{\partial W}{\partial \boldsymbol{\varepsilon}} $$

[超弹性材料](@article_id:369306)中的应力就是应变能对应变的[导数](@article_id:318324)。这个单一的方程定义了材料的力学响应。因此，[虚功原理](@article_id:299197)不仅是力平衡的陈述，也是关于系统总势能驻定性的陈述[@problem_id:2580658]。

### 超越能量：[虚功](@article_id:371793)的真正普适性

与势能的联系是优美的，但它只适用于**[保守系统](@article_id:323146)**。如果我们有不能从势函数导出的力，比如摩擦力，或者随着物体变形而改变方向的奇特“随动荷载”，那该怎么办？

例如，考虑一根柔性[悬臂梁](@article_id:353154)，其尖端绑着一个喷气发动机，推力始终沿着弯曲梁的切线方向推动[@problem_id:2676326]。这是一个非保守的随动荷载。你无法为这个载荷写出一个简单的[势能函数](@article_id:345549)。基于能量的[平衡解](@article_id:353693)释失效了。

然而，[虚功原理](@article_id:299197)仍然成立！$\delta W_{\text{int}} = \delta W_{\text{ext}}$这一陈述仍然是平衡的不可动摇的基础，即使没有全局[能量泛函](@article_id:349508)可供最小化。虚功原理只是简单地平衡了[内应力](@article_id:369929)所做的功与这些奇怪的外力所做的功，无论它们的性质如何。这种稳健性使得虚功原理成为固[体力](@article_id:353281)学中最先进理论的首选出发点，特别是在处理非保守效应常见的非线性问题的计算方法中[@problem_id:2580658] [@problem_id:2676326]。

### 从抽象原理到具体计算

这一切可能看起来相当抽象，但它正是驱动着广阔的计算力学领域和**有限元法（FEM）**的引擎。为了模拟一个真实世界的结构，我们将其分解成一个由小的、简单的“单元”组成的网格。在每个单元内部，我们对位移场进行近似。

然后将虚功原理应用于这个离散化的系统。[内虚功](@article_id:351405)变成每个单元上积分的总和。让我们看一下一个简单[单元刚度矩阵](@article_id:299817)的被积函数：它通常看起来像$\mathbf{B}^T \mathbf{C} \mathbf{B}$，其中$\mathbf{C}$是材料的[本构矩阵](@article_id:344276)（关联应力和应变），$\mathbf{B}$是“应变-位移”矩阵，它包含[单元形函数](@article_id:377667)的[导数](@article_id:318324)。

对于一个具有良好、平行边几何形状的简单四节点[四边形单元](@article_id:355896)，这个被积函数结果是一个关于单元[自然坐标](@article_id:355571)的简单二次多项式[@problem_id:2591200]。我们如何计算这个积分？我们不需要手动计算。我们使用一种称为**高斯积分**的数值技术，它在几个特殊点上评估函数值并取其加权和。这种方法的美妙之处在于，对于给定阶数的多项式，我们可以选择特定数量的点来得到积分的*精确*值。对于我们的二次被积函数，一个$2 \times 2$的[高斯点](@article_id:349449)网格就足以得到精确的[内虚功](@article_id:351405)。这是一个完美的例子，说明了一个抽象的物理原理如何转化为一个精确、高效且准确的计算[算法](@article_id:331821)。

### 大变形世界一瞥

我们的讨论主要假设了小变形。但是，当物体发生剧烈的拉伸、扭曲和弯曲，就像一根橡皮筋或一块软组织时，会发生什么？[虚功](@article_id:371793)（或[虚功](@article_id:371793)率）的基本原理仍然存在，但数学语言必须随之演变。

小[应变张量](@article_id:372284)$\boldsymbol{\varepsilon}$已不再足够。我们引入了更复杂的度量，如**[Green-Lagrange应变张量](@article_id:366888)（$E$）**。当我们这样做时，我们发现[功共轭应力](@article_id:361422)不再是熟悉的[Cauchy应力](@article_id:348185)（$\boldsymbol{\sigma}$），而是一种称为**[第二Piola-Kirchhoff应力](@article_id:352268)[张量](@article_id:321604)（$S$）**的不同度量[@problem_id:1549744]。[功共轭](@article_id:373853)对变成了（$S, E$）。

或者，我们可以在当前的、变形后的构型中建立问题，这在计算方法中很常见。在这里，我们仍然可以使用[Cauchy应力](@article_id:348185)$\boldsymbol{\sigma}$，但它的[功共轭](@article_id:373853)伙伴变成了**变形率[张量](@article_id:321604)（$d$）**，即[空间速度梯度](@article_id:366361)的对称部分[@problem_id:2609703]。

应力和应变度量的领域变得更加丰富和复杂，但中心思想保持不变：[内虚功](@article_id:351405)始终是适当选择的[应力度量](@article_id:377578)与其相应的[功共轭](@article_id:373853)应变度量的缩并。原理本身是普适的；是我们的变形描述必须适应我们希望捕捉的物理现象。