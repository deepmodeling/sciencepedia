## 应用与跨学科联系

我们人类是识别相似性的大师。我们在人群中认出熟悉的面孔，在新歌中听到童年旋律的回响，我们会说某个政治局势与另一个时代的某个情景“如出一辙”。这种对“亲近性”、“关联性”或“类比”的直观感觉是我们智能的核心。但它到底*是*什么？我们能将这种直觉提炼成一种形式化的数学语言吗？如果可以，这又会赋予我们什么样的力量？

本章正是对这一问题的探索之旅。我们将发现，通过将“相似性”这个概念形式化，我们创造了一种通用语言，使我们能够在表面上看起来毫无共同之处的领域中，提出并回答深刻的问题。我们将看到一种“亲近度演算”如何成为一把万能钥匙，在生物学、生态学、人工智能甚至道德哲学中解锁秘密。其美妙之处在于其惊人的简洁性和不可思议的多功能性。

### 解构生命蓝图

让我们从生命的基本机器——蛋白质——的层面开始。蛋白质就像由称为结构域的模块化部件构成的极其复杂的机器。当生物学家发现一种新蛋白质时，一个自然而然的问题是：“它与什么相似？”但“相似”可以有很多含义。为了取得进展，我们必须精确。我们可以问：

-   两种蛋白质是否包含相同*类型*的结构域？（关于内容的问题）
-   它们每种结构域的*数量*是否相同？（关于数量的问题）
-   这些结构域是否以相同的*顺序*排列？（关于结构的问题）

这些问题中的每一个都探究了相似性的不同方面。我们可以设计特定的数学工具，比如 Jaccard 相似性指数的变体，来分别量化每一个方面。这使我们能够从一个模糊的相似性概念，转向对[蛋白质结构](@entry_id:140548)进行精确、多方面的比较，这对于理解蛋白质如何进化和发挥功能至关重要。

然而，在比较蛋白质之前，我们必须首先识别它们。想象一下，一名法医科学家试图通过一枚指纹来识别一个人。在[蛋白质组学](@entry_id:155660)领域，一种称为[质谱法](@entry_id:147216)的技术让我们能做类似的事情。我们可以取一个蛋白质，将其分解成碎片，并测量这些碎片的质荷比。结果是一张谱图——该蛋白质的独特指纹。为了识别我们的未知样品，我们将其谱图指纹与一个庞大的已知指纹库进行比较。但谱图从来都不是完美的；它们充满噪声。简单的一对一比较会失败。

一种更稳健的方法是将每个谱[图表示](@entry_id:273102)为高维空间中的一个向量，其中每个维度对应一个特定的[质荷比](@entry_id:195338)“区间”（bin）。我们的问题就从匹配杂乱的谱图转变为测量向量之间的几何关系。余弦相似度，即测量两个向量之间夹角的余弦值，是完成这项任务的完美工具。如果我们的样本向量与库中某个向量之间的夹角非常小，那么它们在这个抽象的“谱图空间”中几乎指向同一个方向，这表明匹配度很高。通过找到具有最高余弦相似度的库谱图，我们就能自信地识别出我们的蛋白质。这种方法非常可靠，我们甚至可以使用一个由不存在的[蛋白质组](@entry_id:150306)成的“诱饵”库，来统计估算我们的匹配纯属偶然的概率。

从更宏观的视角看，蛋白质及其编码基因并非孤立运作。它们形成了巨大而复杂的相互作用网络。可以把这想象成基因的“社交网络”。我们可以测量任意两个基因之间的“功能相似性分数”，以表示它们角色的关联程度。这就给了我们一个图，其中基因是节点，相似性分数是连接它们的边的权重。要理解这个系统的核心运作结构，我们可能希望找到一个能连接所有基因且没有任何冗余环路的最强连接集合。这是图论中的一个经典问题：寻找[最大生成树](@entry_id:271772)（Maximum Spanning Tree）。其结果是一张清晰的“功能连锁图”，它揭示了[遗传网络](@entry_id:203784)的关键骨架，而这张图完全是基于最大化相似性原则构建的。

我们可以将这个网络概念更进一步，比较不同物种间的网络。在酵母中协同执行某项功能的一[组蛋白](@entry_id:196283)质，在人类中是否有可识别的对应物？通过比对两个物种的[蛋白质相互作用网络](@entry_id:165520)，我们可以寻找“[保守模块](@entry_id:747717)”——即在数百万年的进化中被保存下来的子网络。这种对图之间结构相似性的探索可以揭示深刻的、共同的生物学原理，就像在两种截然不同的生物体的蓝图中，找到一个古老的、共享的机器部件一样。

### 从生态系统到艾字节

相似性度量的力量远远超出了分子世界。让我们走出实验室，来到一片经过恢复的高草草原。我们想知道我们的恢复工作是否奏效。我们恢复的地块与一个原始、未受干扰的参照群落有多相似？

同样，答案取决于我们所说的“相似”是什么意思。我们可以简单地列出两个地点都存在的所有动植物物种，并计算共享物种占总物种的比例。这就是 Jaccard 相似度，一种衡量组成重叠度的指标。但如果参照地点有数十种物种，数量均衡，构成一幅丰富的织锦，而我们恢复的地点99%都是一种入侵草，其他物种都只有一个个体呢？如果物种列表重叠显著，Jaccard 指数可能会说它们非常相似。它对丰度是盲目的。

如果我们关心群落的相对平衡，就需要一个不同的工具。例如，Bray-Curtis 相似性指数会考虑每个物种的丰度。它会正确地得出结论：这两个地点非常不同。在 Jaccard 和 Bray-Curtis 之间的选择不仅仅是一个技术细节，它是对我们生态目标的声明。我们是仅仅试图重新引入物种，还是试图重建一个健康、平衡的生态系统？我们选择的度量既反映也塑造了我们的科学探究。

同样这个挑战——选择如何表示世界以及如何在该表示中测量距离——在驾驭数字世界时也至关重要。考虑一下将患者的医疗记录与可能挽救生命的临床试验相匹配的关键任务。患者的记录和试验的资格标准都只是非结构化文本。机器如何能理解描述“心脏病发作”（heart attack）的记录与针对“心肌梗死”（myocardial infarction）患者的试验在语义上是接近的？

第一步是将文本转换为向量。经典方法 [TF-IDF](@entry_id:634366) 创建巨大的向量，其中每个维度代表词汇表中的一个词。更现代的方法使用“嵌入”（embeddings），它将单词和句子映射到一个更小、更密集的“意义空间”中，其中同义词被放置得很近。一旦我们有了这些[向量表示](@entry_id:166424)，问题就再次变成了几何问题。我们可以使用余弦相似度来找到描述向量与患者向量夹角最小的试验，或者我们可以使用欧几里得距离来找到向量端点最接近的试验。最佳方法通常是复杂表示（如嵌入）与合适的相似性度量（如余弦相似度）的结合，它们共同可以穿透人类语言的混乱，找到最相关的信息。

### 智能的引擎

在现代人工智能的世界里，相似性不仅是分析的工具，它往往是学习本身的核心引擎。机器如何能从原始数据（如卫星图像）中学会理解世界，而无需人类来标记所有东西？

其中一个最强大的范式是“[对比学习](@entry_id:635684)”（contrastive learning）。我们可以通过玩一个简单的游戏来教AI。我们向它展示一组“三元组”图像：一个“锚点”（anchor，特定时间的某块土地），一个“正例”（positive，几分钟后的同一块土地），和一个“负例”（negative，一块完全不同的土地）。AI的唯一目标是调整其内部参数，使其对锚点和正例的表示变得更相似，而对锚点和负例的表示变得更不相似。它试[图优化](@entry_id:261938)的目标函数就是直接由这些相似度分数构建的。

通过重复这个游戏数百万次，AI会自行学习哪些视觉变化是重要的，哪些不是。它学会了太阳角度的变化或飘过的云朵不应过多改变其表示（因为它被迫将这些视为“正例”对），而森林被住宅区取代则是一个关键差异（因为这些会出现在“负例”对中）。相似性度量成为了老师，引导模型学习那些对干扰因素不敏感，同时对有意义的语义变化保持敏感的表示。

一旦AI模型学习完成，我们面临另一个挑战：信任。在像医学这样的高风险领域，一个只提供诊断而无解释的“黑箱”是不可接受的。相似性为实现透明度提供了一条路径。一个可解释的AI可以不说“90%的恶性概率”，而是说：“我做出这个判断，是因为这次扫描的特征与恶性肿瘤的教科书式原型高度相似。”通过使用像余弦相似度这样的简单度量，将患者数据（表示为向量）与一个原型向量库进行比较，AI可以将其抽象的决策建立在具体、人类可理解的类比之上。

我们甚至可以将伦理原则直接融入这个框架。来自AI的原始相似度分数只是一个数字；它不一定是一个经过良好校准的风险。此外，我们必须坚持我们的AI以一种非欺骗性的方式行事。例如，我们可以强制执行一个严格的[单调性](@entry_id:143760)约束：一个与病理原型*更*相似的案例，*绝不能*被赋予*更低*的风险评分。这个伦理规则可以通过诸如保序回归（isotonic regression）等技术在数学上强制执行，该技术在将AI的原始相似度分数校准为有意义的概率的同时，保证了这种单调、可信赖的行为。

### 良知的演算

这个诞生于几何学和统计学的数学框架，真的能对伦理学这个独特的人类领域有所贡献吗？答案是肯定的，而且出人意料地响亮。

思考一下决疑论（casuistry），或称基于案例的伦理推理。当伦理学家或临床医生面临一个新颖而复杂的困境时，他们常常通过类比推理，将当前情况与过去理解透彻的“范例案件”进行比较。我们可以将这个过程形式化。一个案例可以由其伦理学上显著特征的向量来表示——例如，自主权受限的严重性、潜在临床益处的大小以及对患者隐私的风险。

新案例与范例案件之间的“距离”便告诉我们哪些先例最为相关。但在伦理学中，并非所有维度都是平等的。在“自主权”维度上的微小差异，可能远比在另一个维度上的巨大差异更为重要。我们可以将这些伦理优先级编码到一个权重矩阵 $W$ 中，并使用一个加权度量（例如马氏距离（Mahalanobis distance），它是一种由 $d^2(x, y) = (x-y)^T W (x-y)$ 定义的平方距离）来衡量伦理上的“距离”。在这个加[权空间](@entry_id:195741)中找到最近的范例案件，可以让AI检索到最相关的伦理先例，从而为人类决策者突显出核心的道德权衡。

这将我们的旅程带回了原点——一个患有神秘罕见病的儿童。这个孩子表现出的不是单一的实验室数值，而是一系列症状和体征的组合——他们独特的表型。诊断的漫漫长路，就是在寻找一个其已知功能效应与这一临床图像相匹配的基因。利用庞大的人类表型本体（Human Phenotype Ontology），我们可以将孩子的表型和每个候选基因的已知效应都表示为结构化的术语集合。挑战在于计算它们之间的“[语义相似度](@entry_id:636454)”。

简单的关键词匹配是不够的。匹配到一个高度特异和罕见的症状，远比匹配到一个普遍和普通的症状更具信息量。通过融合信息论的原理，我们可以设计一个相似性度量，对这些罕见、特异的匹配给予更高的权重。找到具有最高[语义相似度](@entry_id:636454)的基因，不仅仅是数据匹配的技术操作，更是一种深刻的诠释行为，它将一个孩子的独特痛苦与整个人类遗传学的图景联系起来，为诊断、理解和希望照亮了一条道路。

从蛋白质的微观舞蹈到生态系统的宏观健康，从机器智能的逻辑到道德推理的细微差别，相似性的概念提供了一种强大而统一的语言。它证明了科学技术中一些最深刻的工具，源于对我们最基本、最根深蒂固的直觉的严谨数学化。