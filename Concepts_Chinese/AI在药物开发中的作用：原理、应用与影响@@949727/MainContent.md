## 引言
发现新药的探索是人类最重大的挑战之一，这是一段穿越近乎无限的化学宇宙的缓慢而昂贵的旅程。几个世纪以来，成功一直依赖于科学直觉、机缘巧合和详尽实验的结合。今天，我们正站在一个新时代的门槛上，人工智能（AI）提供了一套革命性的工具，以前所未有的速度和精度来驾驭这种复杂性。然而，要发挥其全部潜力，我们必须超越炒作，理解那些赋予机器对生物学和化学进行推理能力的基本原理。本文旨在弥合AI的前景与其在实践中遵循原则的应用之间的知识鸿沟，全面概述了AI如何从根本上重塑[药物开发](@entry_id:169064)。在接下来的章节中，我们将首先探讨“原理与机制”，揭示AI如何学习分子的语言、预测其效果并生成新的候选分子。随后，我们将在“应用与跨学科联系”中拓宽视野，审视这些强大的计算工具如何影响现实世界的实验室策略、监管科学、法律框架以及关键的伦理考量，揭示一项不仅在发现药物，也在重塑科学实践本身的技术。

## 原理与机制

创造一种新药的宏伟挑战是一段穿越规模惊人的化学宇宙的旅程。在我们可能合成的无数分子中，只有极小一部分既安全又有效地治疗某种疾病。几个世纪以来，这段旅程一直依赖于深刻的化学直觉、机缘巧合和艰苦的试错。人工智能为这场探索提供了新的指南针和地图，但它并非魔法。它的力量源于计算机科学、统计学以及物理和化学基本定律的美妙结合。要理解AI如何革新药物发现，我们必须首先理解让机器能够“思考”分子的核心原理。

### 分子的语言：AI如何看待化学

在AI能够对分子进行推理之前，它需要一种语言来描述它。这个问题比初看起来更为深刻，因为语言的选择塑造了AI“看待”世界的方式以及它能学到什么。化学家已经开发出几种与计算机交流分子的方式，每种方式都有其自身的优缺点。[@problem_id:5173730]

想象一下，你想描述一个像乙醇这样的简单分子。你可以将它写成一行简单的文本，一段代表原子及其连接方式的代码。这就是**简化[分子线](@entry_id:198003)性输入规范（SMILES）**背后的思想。对于乙醇，一个SMILES字符串可以是`CCO`。这非常紧凑，但它有一个特点：根据你从哪个原子开始，你也可以写成`OCC`。对于计算机来说，这些是不同的字符串，但它们代表的是同一个分子。这种模糊性——即当你仅仅重新排列原子（一种称为**排列**的数学操作）时表示法会改变——意味着标准的SMILES并不是一种基础语言。它是一种方便的简写，但它不是唯一的。

一种更基础的表示是**分[子图](@entry_id:273342)**。可以把它看作是分子的基本蓝图。原子是图的节点（顶点），[化学键](@entry_id:145092)是连接它们的线（边）。这种[图表示](@entry_id:273102)法捕捉了核心的拓扑结构——谁与谁相连——而没有任何关于起点的模糊性。至关重要的是，这个蓝图也独立于分子在三维空间中的位置或朝向。无论分子是漂浮在试管中还是锁定在蛋白质中，它的图都是相同的。这使得分[子图](@entry_id:273342)对[旋转和平移](@entry_id:175994)（数学群$SE(3)$的作用）等物理操作具有**不变性**。正是这个特性，使得一类名为**[图神经网络](@entry_id:136853)（GNNs）**的AI模型在化学领域变得如此强大；它们被专门设计用来以图的语言“思考”。

最后，还有完整的**三维坐标表示**。这是一个包含每个原子$(x, y, z)$坐标的列表，就像一个精确的三维模型。这是物理学的语言。如果我们想模拟一个分子将如何物理上适配并与蛋白质相互作用，我们就需要这些坐标。但这种表示带回了一个熟悉的挑战。如果你旋转或移动分子，列表中的所有坐标都会改变，尽管分子本身是完全相同的。坐标矩阵不是不变的。相反，它是**等变的**：它在[旋转和平移](@entry_id:175994)下以一种可预测的方式变化。专为三维[药物设计](@entry_id:140420)而设计的现代AI架构必须学会尊重这种物理对称性，确保它们的预测不会因为观察分子的角度不同而改变。

选择正确的语言——文本、蓝图或三维模型——是构建用于药物发现的智能系统的第一个关键步骤。

### 结合之舞：预测分子的效力

一旦我们的AI能够理解分子*是*什么，我们通常会问的第一个问题是：它会起作用吗？对于大多数药物来说，“起作用”始于一个分子与体内的特定蛋白质靶点结合，就像一把钥匙插入一把锁。药物研发者的主要目标是设计一把能紧密适配的钥匙。“适配的紧密程度”是一个物理量，为了预测它，AI必须利用[热力学](@entry_id:172368)的基本定律。

配体（$L$）与受体（$R$）结合形成复合物（$RL$）是一个可逆平衡：$R + L \rightleftharpoons RL$。这种相互作用的强度通常用**解离常数（$K_d$）**来描述，它告诉我们在什么浓度下一半的受体被占据。较小的$K_d$意味着更紧密的结合，这通常是我们想要的。但是什么决定$K_d$呢？答案在于能量与熵的微妙舞蹈，这由统计力学所支配。

在微观层面，每个分子都是振动的原子和环绕的电子组成的旋风。所有这些可能状态的集体行为被一个称为**[配分函数](@entry_id:140048)**的数学对象所捕捉。在物理化学中最优美的成果之一中，可以证明宏观上可测量的$K_d$与结合反应的**吉布斯自由能（$\Delta G$）**变化直接相关，而吉布斯自由能又源于这些微观的[配分函数](@entry_id:140048)。这一关系被优雅地总结在著名的方程式中：
$$
\Delta G = -R T \ln K_d
$$
其中$R$是气体常数，$T$是温度。[@problem_id:5173692] 这个方程式是连接两个世界的桥梁：它将单个分子的统计混沌与支配生命的可预测的[热力学](@entry_id:172368)行为联系起来。

几十年来，[计算化学](@entry_id:143039)家一直试图使用近似 underlying 物理原理的“打分函数”来预测$\Delta G$。AI采取了不同的方法。**机器学习打分函数（MLSF）**不是预先编程近似的物理定律，而是直接从实验数据中学习分子结构与其[结合亲和力](@entry_id:261722)之间的关系。它学习了自己版本的这个基本方程，创建了一个从我们前面讨论的分[子表示](@entry_id:141094)到预测的结合能的映射。

### 创造性的化学家：AI作为分子生成器

预测一个已有分子的质量是一回事；发明一个全新的分子则是另一回事。这就是AI从分析师转变为创造性伙伴的地方。将这个创造过程形式化的最优雅的方法之一是通过**强化学习（RL）**的视角，这项技术曾被用来精通像国际象棋和围棋这样的游戏。

我们可以将*从头*分子设计框架化为一个游戏。[@problem_id:5173693]
-   游戏的**状态**是你当前正在构建的分子，可能从一个小片段开始。
-   你可以采取的**动作**是化学上有效的编辑：在这里添加一个原子，在那里形成一个环，改变一个键的类型。
-   **奖励**是每次编辑后给予你的新分子的分数。这个奖励是精心调配的理想性质组合：对靶标的高预测[结合亲和力](@entry_id:261722)，以及良好的“ADMET”性质（吸收、分布、代谢、排泄和毒性），以确保分子能够安全地在体内穿行。

AI代理的目标是学习一种**策略**——一种选择进行何种编辑的策略，以最大化总奖励并最终得到一个有前景的候选药物分子。这个过程由**[马尔可夫性质](@entry_id:139474)**所支配，这是一个强大的简化假设，它指出最佳的下一步行动仅取决于分子的当前状态，而与它的整个构建历史无关。这将探索所有可能分子的不可能完成的复杂任务，转变为一个可管理的、逐步的优化过程。通过这种方式，AI模拟了人类[药物化学](@entry_id:178806)家的迭代设计-测试-学习循环，但速度大大加快。

### 水晶球：如何信任AI的预测

随着AI模型预测性质并生成新的候选药物，一个关键问题出现了：我们应该在多大程度上信任它们？在[药物发现](@entry_id:261243)中，一个错误的预测可能导致数百万美元和数年努力的浪费。评估一个AI模型本身就是一门科学，其中有许多微妙之处，很容易误导粗心的人。

#### 我们在测试正确的东西吗？

想象一下，你训练一个AI模型来识别新的[激酶抑制剂](@entry_id:175252)，这是一类主要的[抗癌药物](@entry_id:164413)。你向它输入一个包含数千种已知抑制剂的数据库。你如何测试它？最天真的方法是**随机拆分**：你保留10%的随机数据作为测试集。模型很可能会表现出色。但这就像为一场考试而学习，而考试题目只是家庭作业问题的轻微变体。模型可能没有学到激[酶抑制](@entry_id:136530)的深层原理；它可能只是在记忆你数据集中特定化学家族的特征。

一个更严格、更现实的测试是**骨架拆分**。分子的**骨架**是其核心结构框架。在骨架拆分中，你要确保[测试集](@entry_id:637546)中存在的整个分子骨架在训练集中完全不存在。这迫使模型**外推**到新的化学领域，而不仅仅是在熟悉的例子之间**内插**。这是对真实世界药物发现的一个好得多的替代指标，因为在真实世界中，目标是找到真正新颖的药物类别。[@problem_id:5173710]

随机拆分和骨架拆分之间的性能差距揭示了模型的**[适用域](@entry_id:172549)**：即其预测可靠的化学空间区域。如果我们让一个只在[激酶抑制剂](@entry_id:175252)上训练过的模型去评估一个用于蛋白酶（一种完全不同类型的酶）的候选分子，这个新分子可能远远超出了模型的训练经验范围，以至于预测毫无意义。我们甚至可以使用统计量（如[马氏距离](@entry_id:269828)）来量化这种“新颖性”，它告诉我们一个新分子距离训练数据核心有多少个标准差。高新颖性指数是一个[危险信号](@entry_id:195376)，警告我们正在走出模型的专业领域。[@problem-id:2131617]

#### 超越“对”与“错”

即使一个模型看起来很准确，像“90%的准确率”这样的单一数字也可能隐藏着关键的缺陷。我们需要更仔细地剖析模型的性能。考虑一个预测化合物是否有毒的模型。[@problem_id:4439848]

-   **区分度**：模型擅长*排序*吗？它能否持续地给有毒化合物比安全化合物赋予更高的风险评分？这个特性，通常用**ROC曲线下面积（AUC）**来衡量，对于为进一步筛选的候选物列表确定优先级至关重要。一个高AUC的模型是一个好的“分诊”工具。

-   **校准度**：预测的概率在*数值上有意义*吗？如果模型预测一组化合物有20%的毒性风险，那么这组化合物中是否真的有大约20%最终被证明是有毒的？这个特性，被称为**校准度**或可靠性，可以用**期望校准误差（ECE）**等指标来衡量。[@problem_id:4563969]一个校准良好的模型对于沟通风险至关重要，例如，在临床试验中向患者沟通。一个模型可以有完美的区分度（AUC = 1.0），但校准得很差（例如，对所有有毒化合物预测90%的风险，对所有安全化合物预测10%的风险，而真实风险是99%和1%）。这些是独立且同等重要的优点。

#### 知道你所不知道的

也许一个智能系统最重要的品质是了解其自身知识的局限性。一个预测仅仅准确是不够的；我们需要一个对其不确定性的可靠估计。**保形预测（CP）**是一个非常优雅的统计框架，恰好提供了这一点。[@problem_id:5173705]

在不对数据的分布或模型的正确性做出强假设的情况下，CP可以获取任何AI模型的预测，并将它们包裹在具有数学上保证覆盖率的预测区间内。例如，它可以为一个预测的[结合亲和力](@entry_id:261722)生成一个范围，并保证从长远来看，真实值落在此范围内的频率至少为90%。

这个强大的保证取决于一个简单的假设：**[可交换性](@entry_id:263314)**。这意味着用于校准不确定性模型的数据必须与它将要测试的新数据“相似”。在现实世界中，这个假设往往是脆弱的。我们筛选的化学库会变化（**协变量漂移**），或者我们使用的实验分析方法会随时间漂移（**概念漂移**）。当可交换性被打破时，CP的美妙保证就消失了。这教给我们一个深刻的教训：统计保证的强度仅取决于其潜在假设。聪明的自适应策略，比如在最近数据的滑动窗口上重新[校准模型](@entry_id:180554)，可以帮助在变化的世界中维持近似的覆盖率，但它们是用数学上的确定性来换取实践中的适应性。

#### 回答“为什么”的问题

最后，即使一个模型是准确的，其不确定性也被很好地量化了，我们常常还是想知道它*为什么*做出某个特定的预测。要从一个“黑箱”转变为一个真正的科学伙伴，AI必须能够解释其推理过程。**反事实解释**提供了一种强大而直观的方式来做到这一点。[@problem_id:5173727]

一个反事实解释回答了这样一个问题：“我能对这个分子做出什么样的最小改变来翻转模型的预测？”对于一个非活性分子，AI可能会建议，用一个更小的、给电子的氰基取代一个庞大的、吸电子的硝基就足以使其变得有活性。这种寻找最小有效编辑的过程可以被框架为一个约束优化问题：找到对分[子图](@entry_id:273342)的最小改变，使其预测跨越[决策边界](@entry_id:146073)，同时遵守化学价和合成可及性的硬性约束。这种类型的解释对于[药物化学](@entry_id:178806)家来说是立即可操作的，将AI的预测转化为具体的设计假说。

### 学习生命的动态

到目前为止，我们的讨论都集中在预测分子的静态性质上。但人体是一个动态系统。药物的旅程包括吸收到血液中、分布到组织、被酶代谢，以及最终排泄。**药代动力学（PK）**领域对这些过程进行建模，传统上使用简单的[微分](@entry_id:158422)方程。

在这里，AI通过**神经[微分](@entry_id:158422)方程（Neural ODEs）**提供了另一个范式转变。[@problem_id:4563938]神经[微分](@entry_id:158422)方程不是假设一个简单的、固定的方程来描述药物浓度随时间的变化（例如，简单的指数衰减），而是让一个神经网络直接从浓度-时间数据中*学习控制[微分](@entry_id:158422)方程本身*。就好像AI在发现该药物在人体复杂环境中的独特“运动定律”。这代表了从模拟分子*是什么*到模拟它们随时间*做什么*的飞跃，为更个性化和预测性地理解药物行为打开了大门。

从化学的语言到[热力学](@entry_id:172368)的舞蹈，从博弈的逻辑到统计保证的严谨，AI在[药物发现](@entry_id:261243)背后的原理证明了跨学科科学的力量。AI不是一个神奇的预言家，而是一系列强大工具的集合，每一种工具都建立在深刻而优雅的思想基础上，旨在帮助我们驾驭创造新药的巨大复杂性。

