## 引言
数十年来，数值模拟一直追求无缝连接，即用必须完美拼接在一起的片段来构建解。例如，标准的有限元法就依赖于这种强制的连续性，这是一个强大但往往死板的约束。间断 Galerkin (DG) 方法通过提出一个简单的问题，提供了一种革命性的替代方案：如果我们接纳间断性会怎样？本文深入探讨 DG 格式，这是一个用无与伦比的灵活性换取完美连续性的框架，使我们能够更轻松、更准确地模拟科学和工程中一些最具挑战性的问题。

本文的探索分为两个主要部分。首先，在“原理与机制”中，我们将揭示 DG 的核心思想，研究它如何使用称为[数值通量](@article_id:305599)的数学工具，让不相连的单元能够相互通信并施加物理定律。我们将剖析一个关键的 DG 变体——对称内部罚函数 Galerkin (SIPG) 方法，以理解一致性、对称性和罚项如何协同作用，共同创建一个稳定而强大的系统。随后，在“应用与跨学科联系”中，我们将见证这一理论的实际应用。我们将看到，DG 从连续性束缚中解放出来的自由，如何在[流体动力学](@article_id:319275)、固体力学和[电磁学](@article_id:363853)等领域提供决定性优势，以及它如何通过简化复杂几何和[自适应网格](@article_id:343762)的使用，彻底改变了实际的工程任务。

## 原理与机制

要真正领会间断 Galerkin (DG) 方法，我们必须首先摒弃一个根深蒂固的本能：对完美连续性的追求。几十年来，在计算机上求解物理方程的方法，如标准的连续 Galerkin (CG) 有限元法，一直建立在无缝连接的基础上。它们设想的解由许多小的多项式片段构成，但坚持这些片段必须完美地连接在一起，没有任何间隙或跳跃。这就像用切割完美的石头建造拱门，每块石头都必须与相邻的石头严丝合缝。这种方法虽然优雅，但可能既死板又要求苛刻。

DG 方法始于一个极具解放性的问题：如果我们不必如此完美会怎样？如果我们用允许在公共边界上存在[分歧](@article_id:372077)的片段——即单元——来构建解会怎样？想象一下，用粗糙的砖块砌墙，然后用砂浆来填充缝隙并将它们粘合在一起。这种自由正是 DG 思想的核心。它带来了令人难以置信的灵活性：我们可以使用复杂的[非匹配网格](@article_id:347799)，可以轻松地在不同区域改变解的复杂度（这一特性称为 [p-自适应](@article_id:298956)），还可以设计出特别适合现代并行超级计算机的[算法](@article_id:331821)。

但这种自由也带来了严峻的挑战。如果单元之间是断开的，它们如何通信？如果一个单元右边缘的温度是 $20^\circ\text{C}$，而其相邻单元左边缘的温度是 $22^\circ\text{C}$，那么交界面上的“真实”温度是多少？更重要的是，像热量守恒这样的物理定律如何跨越这个间隙而成立？答案在于一个精妙的数学机制，它扮演着我们间断砖块之间的“砂浆”角色：**[数值通量](@article_id:305599)**。

### 单元的议会

通向 DG 格式的旅程，与计算力学中的许多方法一样，始于控制物理定律（一个[偏微分方程](@article_id:301773)，或 PDE）和[分部积分](@article_id:296804)的巧妙应用 [@problem_id:2698865]。在传统的 CG 方法中，我们将 PDE 乘以一个测试函数，然后在整个区域上一次性积分。在分部积分过程中，由于[函数的连续性](@article_id:372684)，单元之间交界面上出现的边界项会奇迹般地相互抵消。

在 DG 中，我们采取了不同的路径。我们在每个单元上*独立*地进行[分部积分](@article_id:296804)。这样一来，每个单元都成了一座孤岛，并且每个单元都留下了[分部积分](@article_id:296804)产生的边界积分。当我们试图通过将所有单元级方程相加来构建全局图像时，我们发现交界面项*不会*抵消。单元 $K^{-}$ 会看到一个涉及其迹值的边界项，而其相邻单元 $K^{+}$ 则会看到另一个涉及其自身迹值的不同边界项。这不是问题，这恰恰是关键所在！这些遗留的交界面项正是岛屿之间进行通信的通道。

DG 方法的核心是用一个单一、明确的规定来取代这些模棱两可、具有两个值的交界面项：[数值通量](@article_id:305599)。[数值通量](@article_id:305599)，记作 $\widehat{F}$，是一个“配方”，它接受来自交界面两侧的两个冲突值 $u^{-}$ 和 $u^{+}$，并指定通过它们之间的单一物理通量。这个通量必须满足两个基本性质：

1.  **一致性**：如果解在某个交界面上恰好是连续的（即 $u^{-} = u^{+}$），[数值通量](@article_id:305599)必须简化为真实的物理通量。这确保了如果我们的方法得到了精确解，它能识别出这个解 [@problem_id:2586153]。
2.  **守恒性**：离开单元 $K^{-}$ 的通量必须等于进入单元 $K^{+}$ 的通量。这在人为的间断处强制施加了物理守恒定律，确保在间隙中没有质量、动量或能量的损失 [@problem_id:2586153]。

### 通量的艺术：SIPG 剖析

设计[数值通量](@article_id:305599)的方法有很多种，每种都有其独特的特点，从而形成了一个庞大的 DG 方法家族。在处理[扩散](@article_id:327616)或弹性（椭圆问题）等问题时，最优雅且应用最广泛的方法之一是**对称内部[罚函数](@article_id:642321) Galerkin (SIPG)** 方法。让我们剖析其格式，以理解其中的原理。

对于像 $- (k u')' = f$ 这样的扩散问题，SIPG 耦合单元的“配方”是在每个内部交界面上，为弱形式添加三种特定类型的项 [@problem_id:2440329] [@problem_id:2543104]。为了描述它们，我们需要两个简单的工具。对于交界面上的任意量 $w$，**平均值**为 $\{w\} = \frac{1}{2}(w^{-} + w^{+})$，**跳跃值**为 $[w] = w^{-} - w^{+}$。

代表系统能量的 SIPG [双线性形式](@article_id:300638)由标准的单元内部项加上以下交界面项构成：
$$
a_h(u_h, v_h) = \sum_{K} \int_K k u_h' v_h' \, dx - \sum_{F} \int_F \Big( \{k u_h'\}[v_h] + \{k v_h'\}[u_h] \Big) \, dS + \sum_{F} \int_F \frac{\sigma k}{h_F} [u_h][v_h] \, dS
$$

1.  **一致性项 ($-\{k u_h'\} [v_h]$)**：此项确保方法与原始 PDE 一致。它使用物理通量的平均值 $\{k u_h'\}$，并将其与[测试函数](@article_id:323110)的跳跃值 $[v_h]$ 耦合。

2.  **对称性项 ($-\{k v_h'\} [u_h]$)**：此项是第一项的镜像。添加它是为了使最终的方程组对称。对称性不仅仅是一种美学选择；它与底层物理的能量最小化性质密切相关，并且通常对于证明数值方法能够最优地收敛到正确答案至关重要 [@problem_id:2553995]。

3.  **罚项 ($+\frac{\sigma k}{h_F} [u_h][v_h]$)**：这是强制执行者。它规定解的任何跳跃 $[u_h]$ 都是有代价的。该项为系统的“能量”增加一个正值，该值与跳跃值的平方成正比。通过惩罚这种不一致，该方法迫使间断的解保持“接近”连续。此项对于方法的**稳定性**绝对是必不可少的 [@problem_id:2679430]。没有它，数学系统将是“松散的”，可能产生剧烈[振荡](@article_id:331484)、毫无意义的结果。**罚参数** $\sigma$ 必须选择得足够大以提供这种稳定性，其值需要根据物理性质 ($k$)、多项式次数 ($p$) 和单元尺寸 ($h_F$) 仔细确定 [@problem_id:2543104]。

一个简单的计算可以使这一点具体化。对于一个用两个单元建模的杆和一个给定的间断解 $u_h$，总能量可以计算为 $a(u_h,u_h) = 4 - 12 + 36\sigma$ [@problem_id:2698865]。'$4$' 来自单元内部的标准刚度。'$-12$' 源于一致性项和对称性项，反映了在间断交界面上所做的功。而 '$+36\sigma$' 是罚能量，是一种稳定力，随着我们要求单元之间更严格的一致性而增长。

### 更深层次的基础

这种新的思维方式需要一种新的数学语言。按照构造，DG 空间中的函数不在标准的 Sobolev 空间 $H^1(\Omega)$ 中，后者是[二阶偏微分方程](@article_id:354346)解的自然归宿。一个间断函数的[导数](@article_id:318324)在跳跃处包含 delta 函数，这些函数不是平方可积的，这意味着 $H^1(\Omega)$ 范数是无穷大的 [@problem_id:2389376]。

那么，我们如何衡量一个间断函数的误差或能量呢？我们发明了一把新的标尺。**破碎 $H^1$ 范数**通过简单地将每个单元上的标准 $H^1$ 范数相加来衡量函数的正则性。
$$
\|v\|_{1,h}^2 := \sum_{K \in \mathcal{T}_h} \|v\|_{H^1(K)}^2
$$
这捕捉了每个单元*内部*的行为，但忽略了跳跃。为了得到全貌，我们将其扩充为**DG [能量范数](@article_id:338659)**，其中包含了对所有交界面上跳跃的加权度量。正是罚项使得这个组合范数变得可控，也正是相对于这个范数，DG 方法的稳定性和收敛性才得以被严格证明 [@problem_id:2389376]。

这个框架也阐明了我们在每个单元内部使用的多项式基函数的作用。像**单位分解**（所有[基函数](@article_id:307485)之和为一）这样的性质只需要在每个单元上*局部*成立，这确保了[常数函数](@article_id:312474)可以在该单元内被完美表示 [@problem_id:2586125]。不需要全局的单位分解或全局的节点到自由度的映射。解的全局一致性是通过[数值通量](@article_id:305599)施加的弱耦合动态产生的，而不是通过在基函数本身中预先强制施加连续性。这与连续有限元法的思想相比，是一个深刻而强大的转变。

### 一个丰富多样的家族

对称内部罚方法只是 DG 家族中一个杰出的成员。单元级操作和[数值通量](@article_id:305599)耦合的原理是如此基本，以至于它们催生了各种各样的不同格式，每种都有其自身的优势。

-   **局部间断 Galerkin (LDG)** 方法巧妙地将二阶问题重构为一个一阶方程组，这是物理学中一种常见的策略。这改变了[信息交换](@article_id:349808)的方式，导致了数学上等价但计算结构不同的形式。SIPG 只将一个单元与其直接的面邻居耦合，而 LDG 则创建了一个更广泛的通信“模板”，将一个单元与其邻居的邻居也耦合起来 [@problem_id:2552248]。

-   **Bassi-Rebay 2 (BR2)** 方法提供了另一种替代罚项的方法，使用称为“提升算子”的数学构造来实现稳定性。

-   对于由守恒律（[双曲型偏微分方程](@article_id:305058)）控制的问题，如[流体动力学](@article_id:319275)或[波的传播](@article_id:304493)，**[迎风通量](@article_id:304361)**是一个自然的选择。它们利用[信息流](@article_id:331691)动的方向（“风”）来决定交界面上的两个值中哪一个应该占主导地位，从而提供一种具有物理动机的稳定化方法 [@problem_id:2679430] [@problem_id:2586153]。

将这个多样化的家族联系在一起的是其核心思想：为了灵活性和功能而接纳间断性，然后通过优雅而通用的[数值通量](@article_id:305599)语言系统地重建必要的物理连接。这证明了应用数学的创造力，表明有时，构建一个连续整体最强大的方法，恰恰是从破碎的片段开始。