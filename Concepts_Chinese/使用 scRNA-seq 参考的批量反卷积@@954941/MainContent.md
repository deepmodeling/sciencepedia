## 引言
研究复杂的生物组织，例如一块大脑或一个肿瘤，带来了一个根本性的挑战：它不是一个均质的实体，而是一个由多种细胞类型组成的充满活力的生态系统。几十年来，诸如批量 RNA 测序等标准技术只能提供整个生态系统中基因活动的平均视图，这很像只在音乐厅外听交响乐团的声音。这种批量测量掩盖了关键细节，造成了一个知识鸿沟，我们无法轻易区分整体信号的变化是由于细胞改变了其行为，还是组织本身的细胞构成发生了变化。我们如何才能通过计算方式窥探这种混合物，以了解其各个组成部分？

本文探讨了一种强大的计算方法，称为批量[反卷积](@entry_id:141233)，它利用单细胞数据的力量来解决这个问题。它提供了一种数字显微镜，可以在不进行物理分离的情况下剖析复杂的生物样本。通过以下章节，您将深入了解这项变革性技术。“原理与机制”部分将解析核心数学模型，解释单细胞 RNA 测序的革命如何为拆解批量信号提供了所需的“乐谱”。随后，“应用与跨学科联系”部分将展示该方法的深远影响，揭示它如何被用于解决[癌症生物学](@entry_id:148449)、免疫学、遗传学等领域的奥秘。

## 原理与机制

### 远听交响乐：[细胞异质性](@entry_id:262569)的挑战

想象一下，您正站在一个宏伟的音乐厅外，聆听着一支交响乐团的演奏。您可以听到音乐的整体——一个单一、复杂的声波。您可以判断整个乐曲是响亮还是轻柔，是快还是慢。但从您的位置，您能分辨出刚才听到的突然渐强是由于小提琴部演奏得更有激情，还是因为十位小提琴手悄悄走上舞台加入了演奏？这正是生物学家在研究复杂组织时面临的困境。

一块组织，无论是来自大脑、肝脏还是肿瘤，都不是一个均质的整体。它是一个由多种细胞类型组成的繁华生态系统，一个“细胞交响乐团”，每种细胞都扮演着自己独特的角色。几十年来，我们研究基因活动的主要工具，如**批量 RNA 测序**，就像音乐厅外的那支麦克风。我们会将一块组织研磨，提取所有的信使 RNA (mRNA) 分子，并测量数千个基因的平均活动水平。这给了我们一个“批量”测量值——一个综合了原始样本中所有不同细胞的平均表达谱。

这种平均化虽然强大，却掩盖了大量关键细节。它造成了一种根本性的模糊性。以[帕金森病](@entry_id:150368)的悲剧性进展为例，该病涉及大脑一个名为[黑质](@entry_id:150587)的区域中产生多巴胺的神经元的持续丧失。随着这些神经元的死亡，一种名为胶质细胞的支持细胞通常会增殖，这个过程称为胶质增生。如果我们对该区域进行批量测量，我们会看到一个关键的神经元特异性基因，如[酪氨酸羟化酶](@entry_id:162586) ($TH$)，其表达量急剧下降。一种天真的解释可能是，剩余的神经元生病了，并“下调”了这个基因。但现实更为直接：制造 $TH$ 的细胞根本就消失了。我们测量的变化不是细胞行为的变化，而是组织细胞组成的变化。仅凭批量分析无法区分*细胞状态*的变化和*细胞比例*的变化[@problem_id:4424477]。

这个**[细胞异质性](@entry_id:262569)**问题甚至可以在没有稳定性的地方制造出稳定的假象。想象一个基因，在女性中，它在神经元中高度活跃，但在另一种脑细胞类型小胶质细胞中活性很低。如果在这个假设场景中，男性的情况正好相反——在神经元中活性低，在小胶质细胞中活性高——那么就可能发生一些引人注目的事情。如果这两种细胞类型的比例恰到好处，相反的效应可以在批量测量中完美地相互抵消。最终的平均信号将显示男性和女性之间没有差异，从而掩盖了组织内部发生的剧烈的、细胞特异性的差异[@problem_id:2751187]。这就好比小提琴部演奏得更轻柔，而铜管乐部演奏得更响亮——从外面听，总音量可能听起来没有变化，但却隐藏了乐团内部的重组。

### 混合的通用方程

为了突破这一僵局，我们必须首先用优美而简洁的数学语言来描述这个问题。我们从乐团听到的总声音，非常简单，就是每个声部产生的乐音的总和。同样地，一个基因的批量表达量 $E_{\text{bulk}}$，可以被建模为该基因在每种细胞类型中表达量的加权平均值。

假设我们的组织是 T 细胞、癌细胞和成纤维细胞的混合物，其比例分别为 $p_{\text{T-cell}}$、$p_{\text{cancer}}$ 和 $p_{\text{fibroblast}}$。设某个基因在每种*纯*细胞类型中的表达量分别为 $E_{\text{T-cell}}$、$E_{\text{cancer}}$ 和 $E_{\text{fibroblast}}$。我们测量的批量表达量遵循一个**线性混合模型**：

$$
E_{\text{bulk}} = (p_{\text{T-cell}} \cdot E_{\text{T-cell}}) + (p_{\text{cancer}} \cdot E_{\text{cancer}}) + (p_{\text{fibroblast}} \cdot E_{\text{fibroblast}})
$$

这个优雅的方程既是问题的核心，也是解决方案的核心。在典型的实验中，我们只能测量 $E_{\text{bulk}}$。等号右边的所有项——比例（$p$）和纯细胞类型表达谱（$E$）——都是未知的。这就像一个方程有多个变量；不可能唯一求解。为了找出我们乐团中每种乐器的比例，我们需要一个关键信息：我们需要知道每种乐器单独听起来是什么样的。

### 寻找乐谱：单细胞革命

多年来，获取每种细胞类型的“乐谱”——即其纯净、未混合的基因表达谱——是极其困难的。这需要使用复杂的分选技术物理上分离每种细胞类型，这个过程通常不完美，并且可能会改变细胞的自然状态。

随着**单细胞 RNA 测序 ([scRNA-seq](@entry_id:155798))** 的出现，情况发生了彻底的改变。这项革命性的技术好比在乐团中的每一位音乐家面前都放置了一个微型麦克风。我们第一次能够从单个组织样本中同时捕获数千个单个细胞的完整基因表达谱。

通过分析这些单个表达谱，我们可以使用计算方法将细胞聚类成不同的类型，就像音乐鉴赏家能够区分小提琴、大提琴和喇叭的声音一样。一旦我们将所有属于单一类型的细胞（比如，所有的细胞毒性 T 淋巴细胞）分组，我们就可以通过平均它们的表达谱来创造出它们明确的“歌曲”。我们计算该类型所有细胞中每一个基因的平均表达水平。这个平均表达谱就是**细胞类型特征**。

通过对我们组织中识别出的所有 $K$ 种细胞类型重复此过程，我们可以组装一个**特征矩阵**，我们称之为 $S$。这是一个表格，其中每一列是一种细胞类型的完整基因表达特征，每一行对应一个基因[@problem_id:4321263] [@problem_id:4373728]。这个矩阵就是我们梦寐以求的乐谱。它不仅仅是一个标记基因列表；它是数千个基因的*绝对*表达水平的定量概况，提供了每种细胞类型表达程序的特征中心。一个相对变化的矩阵，比如来自[差异表达分析](@entry_id:266370)的[对数倍数变化](@entry_id:272578)，在我们的混合方程中是行不通的[@problem_id:4321263]。

一个关键的细节在于这种平均是如何进行的。基因表达数据通常会进行对数转换以便于统计分析和可视化。然而，我们的[混合模型](@entry_id:266571)是线性的。为了构建一个正确的特征矩阵，我们必须在线性尺度上（例如**[每百万转录本](@entry_id:170576)**，或 TPM）进行平均。我们可以使用对数来帮助我们识别细胞簇，但在平均之前必须恢复到线性值。在[对数空间](@entry_id:270258)中平均然后转换回来，与在线性尺度上平均是不同的，这会给我们的珍贵乐谱引入系统性误差[@problem_id:4321252]。

### [反卷积](@entry_id:141233)的艺术：拆解信号

有了我们的两个关键信息——批量测量值（$y$）和特征矩阵（$S$）——我们现在可以回到我们的线性混合方程，其矩阵形式写作：

$$
y \approx S p
$$

在这里，$y$ 是我们从批量组织中测得的基因表达值向量。$S$ 是我们新构建的特征矩阵（乐谱），而 $p$ 是我们想要找出的细胞类型比例向量。这现在是一个定义明确的数学问题。我们要求计算机解出 $p$。

求解这个方程的过程称为**[计算反卷积](@entry_id:270507)**。它是一种“拆解”算法。我们问计算机：“给定 $S$ 中的参考特征，当它们混合在一起时，什么样的比例组合（$p$）能够最好地重建我们观察到的批量信号（$y$）？” 这通常使用回归技术来解决。

此外，我们可以施加一些现实世界的物理约束来指导算法。我们知道细胞比例不能为负，而且如果我们考虑组织中的所有细胞类型，它们的比例总和必须为 100%（或 1）。通过添加这些约束（对于所有细胞类型 $k$，$p_k \ge 0$，且 $\sum p_k = 1$），我们确保了解是具有物理意义的[@problem_id:4373728] [@problem_id:5088408]。该算法，通常是一种约束[最小二乘回归](@entry_id:262382)，会找到能最好地满足这些条件的比例向量 $\hat{p}$。

最终的输出 $\hat{p}$ 是一列数字：我们原始组织样本中 T 细胞、癌细胞、成纤维细胞等的估计比例。我们成功地窥探了音乐厅的内部，利用巧妙的实验技术和数学推理的结合，弄清了乐团的构成。

### 警示：解释的局限性

这种[反卷积](@entry_id:141233)方法非常强大，但它不是魔法。其准确性完全取决于参考特征矩阵的质量和适用性。“垃圾进，垃圾出”的原则在这里完全适用。

一个主要挑战是**[共线性](@entry_id:270224)**。如果两种细胞类型非常相似，具有几乎相同的表达特征怎么办？例如，两种密切相关的免疫细胞亚型。它们在特征矩阵 $S$ 中的列将高度相关。这使得算法在数学上难以区分它们各自的贡献。批量测量中微小的噪声或误差可能导致算法在其估计中产生巨大的、不稳定的错误，可能会极大地高估一种细胞类型而低估另一种[@problem_id:4551920]。为了使[反卷积](@entry_id:141233)效果良好，组成细胞类型必须在其表达谱上具有足够的区别。

参考特征本身也可能包含偏差。例如，[scRNA-seq](@entry_id:155798) 中的“dropout”现象可能导致某些基因的表达被人为地记录为零。这可能导致在特征矩阵中低估真实的平均表达。当算法试图将这个减弱的特征与批量数据匹配时，它可能会系统性地低估该细胞类型的比例，这个问题对于稀有细胞群体可能尤其严重[@problem_id:4551920]。

这就是为什么科学过程并不止于算法的创建。科学家们通过创建人工“伪批量”样本来严格验证这些方法，这些样本来自单细胞数据，其中真实比例是已知的。然后他们测试算法是否能准确地恢复这些已知比例，评估在各种条件下的偏差和精度[@problem_id:4382282]。正是通过这种创新、建模和严格验证的不断循环，我们才建立起对我们计算能力窥探细胞复杂而美丽交响曲的信心。

