## 引言
我们如何才能解读隐藏在生物体DNA中的迁徙、瘟疫和适应的史诗故事？海量的遗传数据可能令人不知所措，但一个强大的统计工具——[位点频率谱](@entry_id:163689)（Site Frequency Spectrum，SFS），能让我们将这种复杂性提炼成一幅易于理解的演化历史图景。SFS如同一份基因组的化石记录，为群体内的遗传变异提供了量化总结。通过理解塑造它的力量，我们可以揭示一个物种的深层历史以及自然选择作用于其基因的印记。本文将为这一群体遗传学的基本概念提供指引。

第一章 **“原理与机制”** 将通过解释SFS是什么以及如何构建它来奠定基础。我们将探讨作为基准的“中性”SFS，然后观察群体历史变迁和自然选择等强大力量如何以可预测的方式扭曲其形状，留下群体过往不可磨灭的印记。第二章 **“应用与跨学科联系”** 将展示SFS在实践中的强大作用。我们将看到它如何被用于重建人类历史、寻找受选择的基因、指导濒危物种的保护工作，甚至为现代精准医疗提供信息，从而说明一个简单的遗传差异计数如何能讲述关于生命历史的深刻故事。

## 原理与机制

### 遗传变异的普查

想象你是一位基因组的制图师。但你绘制的不是山川河流，而是群体内遗传变异的景观。某些特征——在这里是[遗传突变](@entry_id:166469)——非常罕见，如同微小的、隐藏的泉眼。另一些则很常见，如同遍布整个大陆的广阔平原。你如何创作一幅能够捕捉这片景观精髓的有意义的地图？你需要一种系统性的方法来统计和分类这些特征。这正是**[位点频率谱](@entry_id:163689)**（Site Frequency Spectrum，简称SFS）的工作。

SFS的核心是一个简单而强大的工具：它是一个[直方图](@entry_id:178776)。在横轴上，我们有特定遗传变异的频率。在纵轴上，我们有基因组中发现该频率变异的位点数量。它回答了一个优雅的问题：在我们观察到的所有遗传差异中，它们是如何从稀有到常见分布的？

要进行这项普查，我们首先需要收集数据，通常是通过对样本个体的DNA进行测序。现在，这里有一个关键而微妙的点。假设我们正在研究一个二倍体生物群体，比如美丽的透翅蝶（*Greta oto*）。如果我们取样50只蝴蝶，我们拥有多少份基因组拷贝？答案不是50，而是100。每只蝴蝶，和我们一样，携带两套染色体——一套遗传自父本，一套遗传自母本。遗传信息的真正载体，即代代相传的实体，是这些单个的染色体。因此，SFS计算的不是有多少*个体*携带一个突变，而是有多少条*染色体*携带它。如果我们发现一个SFS条目显示某个变异的计数为8，这意味着在我们抽样的100条染色体中，该特定突变恰好出现在其中的八条上[@problem_id:1975016]。这可能意味着八只蝴蝶各有一份拷贝，或者四只蝴蝶各有两份拷贝，或者其他某种组合。通过关注染色体，我们关注的是遗传的[基本单位](@entry_id:148878)。

### 揭示过去：观察[频率谱](@entry_id:276824)的两种方式

要描绘一个“新”突变——遗传学家称之为**衍生等位基因**（derived allele）——的兴起，我们必须首先知道“旧”版本，即**祖先等位基因**（ancestral allele），是什么样子。但我们如何能窥探过去呢？诀窍是使用一个生物学的时间机器：一个**外群**（outgroup），它是一个与我们研究的群体的祖先在遥远的过去分化的近缘物种。如果外群物种在某个特定位置上是‘A’，而我们研究的群体既有‘A’也有‘G’，我们就可以推断‘A’是祖先状态，而‘G’是新的衍生等位基因。

当我们能自信地确定祖先状态时，我们就可以构建一个**非[折叠SFS](@entry_id:175180)**（unfolded SFS）。对于一个包含$n$个二倍体个体（即$2n$条染色体）的样本，我们创建一个有$2n-1$个组（bin）的直方图。从1到$2n-1$的每个组，统计的是衍生等位基因恰好出现在那么多条染色体上的位点数量。这为我们提供了一幅高分辨率的画面，描绘了新突变从作为单一变异诞生到可能在群体中变得普遍的旅程[@problem_id:1975010]。

但如果过去模糊不清，我们找不到一个可靠的外群怎么办？一切都还没有失去。我们仍然可以构建一个**[折叠SFS](@entry_id:175180)**（folded SFS）。我们不再追踪衍生等位基因，而是简单地识别一个可变位点上的两个等位基因，并计算其中较不常见的那个——即**次要等位基因**（minor allele）。例如，如果我们正在研究鳞足螺（*Chrysomallon squamiferum*），在一个位点上发现，在抽样的20条染色体中，一个等位基因出现了15次，另一个出现了5次，那么我们[折叠SFS](@entry_id:175180)的计数就是5[@problem_id:1974998]。我们把[频率谱](@entry_id:276824)“折叠”了一半。我们不再知道哪个等位基因是新的，哪个是旧的，但我们保留了关于变异平衡的关键信息。这种稳健性的代价是分辨率的损失；一个[折叠SFS](@entry_id:175180)只有$n$个组而不是$2n-1$个，虽然压缩了一些信息，但仍然提供了一个强大的总结[@problem_id:1975010]。

### 中性交响曲：演化的基准节律

现在我们知道了如何构建SFS，那么我们应该期望它是什么样子的呢？让我们首先想象一个从演化角度来看“极其平淡”的世界。考虑一个群体，它数量庞大，亿万年来保持稳定，并且所有突变都是**中性**的——也就是说，它们对生物体的生存和繁殖能力没有影响。在这个世界里，一个新突变的命运完全由机遇的偶然性决定，这个过程被称为**[遗传漂变](@entry_id:145594)**（genetic drift）。

当一个新突变首次出现时，它出现在单条染色体上。它是一个单体（singleton），是可能的最稀有的变异。在遗传的大抽奖中，它最可能的命运是什么？是丢失。每一代，携带这个突变的个体很有可能不会将其遗传下去，或者继承了它的后代不会繁殖。一个新突变要能在这场随机的考验中幸存下来，并漂变到更高的频率，需要巨大的运气。

其结果是一种优美、简单而深刻的模式。一个中性的、[稳定群](@entry_id:153436)体的SFS将由稀有变异主导。将会有大量的单体，较少数量的“双体”（doubletons），以此类推，更高频率的变异数量会迅速减少。具有衍生等位基因计数为$i$的位点的期望数量与$1/i$成正比。这创造了一个典型的“L形”分布。这是[中性演化](@entry_id:172700)的基准交响曲，一个可预测的节律，我们可以以此为背景来探测群体历史中更具戏剧性的事件[@problem_id:1972594]。

### 历史的回响：DNA中的群体历史

SFS真正的魔力在于我们观察到谱图*偏离*了这种简单的中性节律。SFS就像一个基因组的地震仪，将群体过去的灾难性事件——它的繁荣与萧条——作为回响记录在DNA中。

想象一个群体最近经历了快速而爆炸性的增长，也许是扩张到一个新大陆或在一次接近灭绝的事件后恢复过来[@problem_id:1974996]。这种增长的爆发创造了一个星状的家族树（或称**谱系**，genealogy），无数新谱系向外辐射，其长长的分支尚未有时间与[共同祖先](@entry_id:175919)[汇合](@entry_id:148680)。突变沿着这些分支累积，就像树上的闪电一样。长分支意味着有更多的时间发生突变。由于这些是树最外层的“末端”分支，任何在这里发生的突变对于单个谱系来说都是独一无二的，在我们的样本中表现为单体。结果是SFS出现显著的偏斜：大量极为稀有的低频变异，远多于稳定大小的中性模型所预测的数量[@problem_id:5037124]。SFS的L形变得更加明显，在计数为1处出现一个巨大的峰值。这种特定模式正是驱动另一个著名统计量——**[Tajima's D](@entry_id:166949)**——变得非常负的原因，揭示了这些不同看待遗传数据方式之间的深层统一性[@problem_id:1975059]。

现在，考虑相反的情景：一个群体经历了一场严重的**瓶颈效应**（bottleneck），其数量急剧减少，就像被隔离在山地草甸中的金斗篷地松鼠（golden-mantled ground squirrels）[@problem_id:1975029]。在瓶颈期间，[遗传漂变](@entry_id:145594)不再是温和的微风，而是一场狂暴的飓风。群体失去了大量的遗传变异。稀有变异尤其脆弱，常常被完全清除。少数幸存下来的变异更有可能偶然被推向中等频率。SFS将这一事件记录为稀有变异的显著缺失和[频谱](@entry_id:276824)中段变异的相应“凸起”或过量。L形消失了，取而代之的形状甚至可能看起来像一个[钟形曲线](@entry_id:150817)。这是一个曾被挤压通过群体历史瓶颈的群体留下的明确无误的伤疤。

### 选择之手

群体历史不是塑造SFS的唯一力量。**自然选择**（natural selection）这只无情的手在基因组上留下了它自己独特的印记。

让我们看一个对生存至关重要的基因，比如生活在多变环境中的深海细菌的[热休克蛋白](@entry_id:165917)基因[@problem_id:1975031]。这个基因中的大多数新突变都将是有害的，会损害其功能。这就是**[纯化选择](@entry_id:170615)**（purifying selection，或负选择）发挥作用的地方。它像一个警惕的编辑，不断地从群体中清除这些有害突变。然而，这个过程不是瞬时的。一个新的[有害突变](@entry_id:175618)会出现，以非常低的频率徘徊几代，然后被消除。这样一个基因的SFS将展示这个过程的动态：大量极为稀有的变异，甚至比中性情况下还要多。这个高耸的单体峰代表了持续不断的、短暂的新[有害突变](@entry_id:175618)流，它们“试图”进入群体，但很快就被选择所清除。

相比之下，当一个稀有突变被证明是有益的时，**[正选择](@entry_id:165327)**（positive selection）可以迅速提高其频率，这个过程称为**[选择性清除](@entry_id:169307)**（selective sweep）。这次清除到高频或固定的过程会留下一个非常不同的印记，通常会清除所选位点及其周围的变异。另一种选择形式，**平衡选择**（balancing selection），可以长期维持多个等位基因处于中等频率（例如，在与免疫相关的基因中）。这创造了一个与纯化选择和群体增长都相反的印记：SFS中段出现一个明显的变异峰值。通过将观察到的SFS与中性期望进行比较，我们简直可以在基因组中读出选择的故事。

### 一点提醒：[观察者效应](@entry_id:186584)

最后，本着真正的实验主义精神，说一句提醒的话。在科学中，测量的行为有时会影响结果。在遗传学中，这被称为**确认偏误**（ascertainment bias），这是一个必须避免的关键陷阱。

许多遗传变异研究不使用[全基因组测序](@entry_id:169777)，而是依赖于**[SNP芯片](@entry_id:183823)**，这些芯片检测一组预先选定的已知可变位点。想象一个场景，一个[SNP芯片](@entry_id:183823)的设计首先是在一个欧洲人群中发现常见变异。因此，这个芯片是有偏见的；它优先包含在欧洲人中频率中等的SNP。现在，假设我们使用这个芯片来研究一个东亚人群[@problem_id:1975018]。

因为人[类群](@entry_id:182524)体有着深厚的共同历史，等位基因频率在全球范围内是相关的。然而，许多在东亚人中稀有的变异在欧洲人中也同样稀有（或不存在）。由于我们的芯片被特意设计为*排除*在欧洲人中稀有的变异，它也将无意中排除许多在东亚人中稀有的变异。当我们用这些有偏见的数据构建SFS时，我们会看到低频变异的人为缺失和中频变异的过量。这个SFS看起来就好像东亚人群经历了一次近期的瓶颈效应，即使其真实历史是爆炸性增长！这揭示了一个深刻的原则：理解我们工具的局限性与理解生物系统本身同样重要。SFS是洞察过去的一面强大的透镜，但我们必须时刻注意我们是如何透过它来观察的。

