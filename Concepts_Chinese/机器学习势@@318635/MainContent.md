## 引言
在原子层面模拟材料的行为是现代科学的一大挑战。任何系统——从一滴水到复杂的蛋白质——的性质和动力学都由一个被称为[势能面](@article_id:307856)（PES）的复杂高维景观所决定。尽管量子力学为这一景观提供了精确的规则，但其计算成本高得令人望而却步，无法应用于与现实世界相关的大系统和长时间尺度。量子理论的精确性与实际问题的尺度之间的这种差距，长期以来一直是计算发现的障碍。

本文探讨了一种弥合这一差距的革命性解决方案：[机器学习势](@article_id:362354)（MLP）。这些强大的工具直接从量子力学数据中学习原子位置与能量之间的复杂关系，从而创建出高度精确且计算高效的模型。在接下来的章节中，我们将从基本理论走向前沿应用。第一章“原理与机制”将解构MLP的工作原理，从如何为机器表示分子，到学习的核心理念、数据生成的挑战以及物理定律的关键整合。第二章“应用与跨学科联系”将展示这些势如何被用于解决[材料科学](@article_id:312640)、化学和物理学中的艰巨问题，从而彻底改变我们模拟和预测物质行为的能力。

## 原理与机制

想象一下，试图预测一滴水中数万亿个原子的复杂舞蹈。每个原子都遵循量子力学所规定的一套复杂规则，相互推拉。要在计算机上模拟这一点，我们需要知道“舞蹈的规则”——即对于原子所有可能的[排列](@article_id:296886)方式，系统的能量是多少。这种从原子位置到单一能量值的映射关系，被称为**[势能面](@article_id:307856)**（PES）。所有化学和[材料科学](@article_id:312640)都在这个高维景观上展开。

我们之所以能够定义这样一个静态的景观，得益于 **Born-Oppenheimer 近似**。该近似明智地指出，轻盈灵活的电子会几乎瞬间地围绕着沉重迟缓的原子核重新[排列](@article_id:296886)。对于原子核位置$\mathbf{R}$的任何固定快照，电子会稳定在其最低能量状态，从而在[势能面](@article_id:307856)上定义一个点$E(\mathbf{R})$。每个原子受到的力就是这个景观的下坡斜率，即$\mathbf{F}(\mathbf{R}) = -\nabla_{\mathbf{R}} E(\mathbf{R})$。**[机器学习势](@article_id:362354)（MLP）**的目标雄心勃勃得令人惊叹：从少数示例数据点中学习这个极其复杂的高维景观的整个形状。

但这个景观并非任意的。它继承了物理定律的[基本对称性](@article_id:321660)。如果你在空间中平移或旋转整个原子系统，能量不能改变。如果你有两个相同的原子，比如两个氢原子，然后交换它们的标签，能量也必须保持不变。任何成功的MLP都必须从一开始就尊重这些基本的[不变性](@article_id:300612)[@problem_id:2648581]。

### 如何向机器描述一个分子？

在机器能够学习之前，它需要能够“看见”。我们如何将一个分[子表示](@article_id:301536)成计算机可以处理的数字向量，而不是一堆模糊的球和棍？这就是**表示**的关键问题，它远非小事。表示必须是每种分子几何构型的唯一指纹，而且正如我们所见，它必须对平移、旋转和相同原子的[置换](@article_id:296886)保持不变。

一个早期优雅的尝试是**库仑矩阵**[@problem_id:2903792]。想象一个包含$N$个原子的分子，对应一个对称的$N \times N$矩阵。非对角元素$M_{ij}$就是原子$i$和原子$j$的原子核之间的[库仑排斥](@article_id:361236)能，$Z_i Z_j / r_{ij}$。对角元素$M_{ii}$被选择用来表示原子本身的能量，例如，作为核[电荷](@article_id:339187)的[多项式拟合](@article_id:357735)，$M_{ii} = \frac{1}{2} Z_i^{2.4}$。这个矩阵自动对平移和旋转保持不变，因为它只依赖于原子间距离$r_{ij}$。

但是[置换](@article_id:296886)呢？如果我们交换原子1和原子2，矩阵的行和列就会被打乱。矩阵本身改变了！这是个问题。我们如何创建一个唯一的指纹呢？一个想法是强制执行一个规范的排序。例如，我们可以根据某个规则（比如行范数的大小）对矩阵的行和列进行排序。这给出了一个唯一的矩阵，但它引入了一个可怕的缺陷：不连续性。想象一下两个范数几乎相同的行。一个微小的[振动](@article_id:331484)可能导致它们的顺序翻转，从而在表示中产生一个突然的大跳跃。学习[算法](@article_id:331821)会对此感到完全困惑。

另一个更复杂的想法是使用本质上具有[置换](@article_id:296886)[不变性](@article_id:300612)的特征。对于任何矩阵，其[特征值](@article_id:315305)集合（其谱）在行和列被打乱时保持不变。使用库仑矩阵的[特征值](@article_id:315305)作为描述符，漂亮且连续地解决了[置换](@article_id:296886)问题。然而，它引入了一个新的、更微妙的问题：原则上，两种不同的分子几何构型可能拥有具有完全相同[特征值](@article_id:315305)集合的库仑矩阵（这种现象被称为“同谱”）。虽然罕见，但这意味表示并非完全唯一。这段从简单的物理想法到其实现中微妙挑战的历程表明，构建一个好的描述符是创建MLP过程中的一个深刻且核心的challenge[@problem_id:2903792]。

### 局域与全局：两种学习哲学

一旦我们能够描述一个分子，我们该如何构建学习机器本身呢？两种主要的哲学已经出现，它们都植根于物理相互作用的结构[@problem_id:2648581]。

**全局方法**是最直接的：它试图一次性学习整个系统的完[整函数](@article_id:355218)$E(\mathbf{R})$。虽然概念上简单，但随着原子数$N$的增长，这变成了一项艰巨的任务，因为景观的维度（$3N$）会爆炸式增长。

**局域方法**是一种更巧妙的“分而治之”策略。它做出了一个极其简单而强大的假设：一个系统的总能量仅仅是每个独立原子贡献的总和。

$E_{total} \approx \sum_{i=1}^{N} \varepsilon_i$

每个原子的能量$\varepsilon_i$被假定仅取决于其在某个**[截断半径](@article_id:297161)**$r_c$（通常只有几埃）内的直接邻居的构型。这在直觉上是合理的——化学键合主要是一种局域现象。这种局域分解具有深远的优势。它确保能量自然地随系统大小缩放（这一性质称为**尺寸广延性**），并且[计算成本](@article_id:308397)随原子数量[线性缩放](@article_id:376064)，即$\mathcal{O}(N)$。这是解锁数百万[原子模拟](@article_id:378714)的关键，远远超出了用于生成训练数据的量子力学方法的范围。

### 成分：为学习机器提供燃料

机器学习模型的好坏取决于其训练数据。但对于MLP来说，什么样的数据才算是“好”数据呢？这不仅仅是数量问题；关键在于要覆盖模型将来看可能遇到的所有情况。[训练集](@article_id:640691)必须是[势能面](@article_id:307856)相关部分的代表性图集[@problem_id:2784625]。

如果我们想让M[LP模](@article_id:349941)拟水，它需要看到水作为固体（冰）、液体和气体（蒸汽）的例子。它需要看到不同温度和压力下的水。一个只在冰上训练的模型将不知道如何描述液态水。

此外，标准的模拟大部[分时](@article_id:338112)间都停留在低能盆地中。它很少（如果不是从不）自发地采样到决定[化学反应](@article_id:307389)的高能**过渡态**。对于一个能量壁垒仅为$0.6$ eV的反应，室温下的模拟将不得不等待永恒的时间才能看到一次成功的跨越。如果我们希望我们的模型能够描述反应，我们不能靠运气。我们必须使用**偏置采样**技术来迫使系统越过壁垒，并沿着反应路径收集数据。

这就是**[主动学习](@article_id:318217)**概念作为一个绝妙策略的用武之地。我们不是盲目地生成数百万个数据点，而是从一个小的、多样化的种子集开始。我们训练一个初步模型，然后用它来运行模拟。我们让模型自己告诉我们它在哪些地方最不确定（我们稍后会看到如何做到这一点）。然后，我们只对那些少数的、[信息量](@article_id:333051)大的构型执行昂贵的高保真度[量子计算](@article_id:303150)，并将它们添加到我们的[训练集](@article_id:640691)中。这个反馈循环使我们能够以最高的效率构建一个全面而准确的[训练集](@article_id:640691)[@problem_id:2784625]。

为不同目的构建的数据集之间存在着鲜明的差异。像QM9这样的早期数据集包含数千个小型有机分子，但仅限于它们单一的、弛豫的、低能的几何构型。它们非常适合训练用于预测平衡性质的模型，但对于训练用于分子动力学的势来说毫无用处。相比之下，像ANI系列这样的现代数据集是专门为训练稳健的势而设计的。它们包含数百万个非平衡、高能和扭曲的构型——这正是一个系统在动态模拟中探索的那种“不快乐”的分子——而且至关重要的是，它们包含了每个构型的原子作用力[@problem_id:2903773]。

### 机器运转：守恒与漂移

好了，我们已经构建了一个漂亮的MLP。我们用它来进行分子动力学模拟，根据牛顿定律$F=ma$来推进原子的运动。任何此类模拟的一个基本检验是总能量的守恒。当力来自MLP时，[能量守恒](@article_id:300957)会发生什么？

一个常见的担忧是，如果模型只在能量上进行训练，那么由它派生出的力可能不准确并破坏[能量守恒](@article_id:300957)。这是一个微妙但深刻的误解[@problem_id:2457457]。关键在于**[保守力](@article_id:323223)**的概念。如果一个力是某个势的梯度，那么它就是保守的。在我们的MLP中，力不是独立近似的；它们是作为MLP学习到的能量函数$\mathbf{F}_{MLP} = -\nabla E_{MLP}$的精确解析[导数](@article_id:318324)来计算的。这意味着，从其构造上讲，[力场](@article_id:307740)相对于势$E_{MLP}$是保守的。

因此，在连续时间的理想世界中，MLP*自身*的总能量$E_{total} = K + E_{MLP}$是完全守恒的。该模型是内部自洽的。我们在真实模拟中看到的任何微小波动或能量漂移，都来自于我们没有精确求解牛顿方程，而是使用了具有有限时间步长$\Delta t$的数值积分器（如velocity [Verlet算法](@article_id:311290)）。误差在于[数值积分](@article_id:302993)，而不在于MLP本身的原理。

然而，还有一个更深层次的麻烦来源。如果我们的MLP虽然内部自洽，但其学习到的景观与真实的物理景观相比存在微小但系统的*误差*怎么办？假设MLP的力有一个微小的、有偏的误差，$\tilde{\mathbf{F}} = \mathbf{F}_{true} + \delta \mathbf{F}$。这个误差就像一个“幽灵力”一样，不断地推动系统。随着系统的移动，这个幽灵力做功，$\dot{\mathbf{q}} \cdot \delta \mathbf{F}$，系统地向系统中注入或从中抽取能量。结果是总能量随时间线性漂移。而且至关重要的是，这种漂移是模型不准确性的内在属性。减小模拟时间步长会使模拟更忠实于*错误*的动力学，但不会消除漂移[@problem_id:2903799]。这给我们一个重要的教训：内部自洽性不等于物理准确性。

### 延伸更远：长程物理的挑战

局域的“分而治之”方法，尽管威力强大，但有一个致命弱点。物理并不总是局域的。考虑模拟盒子两端的两个离子。它们感受到一个随$1/r$衰减的[库仑力](@article_id:353641)。或者考虑两个中性但可极化的分子。它们感受到一个随$1/r^6$衰减的范德华[色散力](@article_id:313615)。这些相互作用是**长程的**。一个原子感受到来自系统中*所有*其他[电荷](@article_id:339187)的集体静电场，而不仅仅是那些在比如6 Å这样的小[截断半径](@article_id:297161)内的[电荷](@article_id:339187)[@problem_id:2648601]。

一个严格局域的MLP在其截断范围之外是“盲目”的。对于相距超过$r_c$的两个分子，模型会认为它们的[相互作用能](@article_id:328040)完全为零。这显然是错误的，并导致无法描述无数现象，从离子[液体的结构](@article_id:310584)到蛋白质的折叠。

那么，我们该如何解决这个问题呢？最优雅的解决方案不是强迫MLP去做它根本不适合做的事情，而是构建一个**混合模型**，结合两者的优点[@problem_id:2796824]。我们将[能量分解](@article_id:372528)为：

$E_{total} = E_{MLP-short} + E_{physics-long}$

MLP凭借其巨大的灵活性，负责学习定义[化学键](@article_id:305517)和空间排斥的复杂、量子力学的[短程相互作用](@article_id:306102)。对于长程部分，我们使用我们已经知道是正确的、明确的、源于物理的方程，比如用于静电的库仑定律和用于[色散](@article_id:376945)的$C_6/r^6$形式。为了避免重复计算，这些物理项在短距离处被平滑地“阻尼”，由MLP接管。

更妙的是，长程物理的参数，比如每个原子的[电荷](@article_id:339187)或其极化率，不必是固定的。它们本身可以由一个响应原子局域化学环境的机器学习模型来预测。这使得[电荷](@article_id:339187)能够流动，[极化率](@article_id:303946)能够随着键的形成和断裂而改变，通过学习到的模式和已建立的物理定律之间美妙的协同作用来捕捉复杂的物理现象[@problemid:2796824]。

### 知道你所不知道的：不确定性的智慧

没有模型是完美的。一个成熟的科学工具的一个关键方面不仅是其准确性，还有其报告自身[置信度](@article_id:361655)的能力。对于一个MLP从未见过的分子，我们应该在多大程度上相信它的预测？这就引出了两种[基本类](@article_id:318739)型的不确定性[@problem_id:2648582]。

**[认知不确定性](@article_id:310285)**是“模型的不确定性”。它源于知识的缺乏，通常是由于构型空间特定区域的训练数据稀疏。如果你让一个MLP预测一个奇异、扭曲的、与其[训练集](@article_id:640691)中任何分子都不同的分子的能量，它本质上是在猜测。一个估计这种不确定性的强大方法是训练一个模型的**系综**。如果系综中的所有模型对一个新的构型给出大相径庭的预测，这清楚地表明存在高的认知不确定性——它们正在外推到未知领域。这正是[主动学习](@article_id:318217)中用来请求新数据点的信号。因为它源于知识的缺乏，认知不确定性是可减少的：我们可以通过增加更多数据来降低它。

**[偶然不确定性](@article_id:314423)**是“数据的不确定性”。它代表了数据生成过程中固有的随机性或噪声。例如，如果我们的参考能量来自像[量子蒙特卡洛](@article_id:304811)这样的随机方法，每次计算都有一个[统计误差](@article_id:300500)棒。这种噪声是我们测量工具的一个基本属性。无论我们收集多少数据或我们的模型有多灵活，我们都无法消除这种内在的随机性。[偶然不确定性](@article_id:314423)是不可减少的。

理解这种区别对于构建稳健的模型、知道何时信任它们的预测以及何时保持怀疑至关重要[@problem_id:2648582] [@problem_id:2784625]。

### 当舞台本身崩塌时：超越单一[势能面](@article_id:307856)

我们把整个图景建立在Born-Oppenheimer近似的基础上——即存在一个单一、连续的[势能面](@article_id:307856)的想法。但当这个基础破裂时会发生什么？

在某些情况下，特别是在[光化学](@article_id:301376)（分子与光的相互作用）中，两个不同的电子态可能具有相同的能量。这些[交叉](@article_id:315017)点被称为**锥形交叉**[@problem_id:2648577]。在这些特殊点上，[Born-Oppenheimer近似](@article_id:306672)急剧失效。单一[势能面](@article_id:307856)的景观不再平滑；它出现一个尖锐的尖点，就像一个圆锥的顶点。力变得不连续，而允许系统在不同[势能面](@article_id:307856)之间“跳跃”的[非绝热耦合](@article_id:371212)变得无穷大。

一个标准的MLP，通常是一个[平滑函数](@article_id:362303)，不可能表示这样一个[尖点](@article_id:641085)。用一个平[滑模](@article_id:327337)型去拟合一个尖点会将其“磨圆”，完全错误地表示了支配[超快化学](@article_id:352471)过程（如人眼中的视觉或DNA的[光稳定性](@article_id:376113)）的物理学。

解决方案需要一种更复杂的方法。我们不能只教机器学习一个标量能量$E(\mathbf{R})$，而必须教它学习一个小的能量和[耦合矩阵](@article_id:370768)，称为**透热表示**。这个矩阵的元素是MLP可以轻松学习的[平滑函数](@article_id:362303)。然后，通过动态计算这个学习到的矩阵的[特征值](@article_id:315305)，可以得到具有特征性[尖点](@article_id:641085)的物理绝热能量。这个漂亮的策略将数学[奇点](@article_id:298215)从被学习的对象转移到了使用它的[算法](@article_id:331821)上，使我们能够模拟即使是那些单一、简单景观概念失效的最复杂的量子现象[@problem_id:2648577]。这种持续的相互作用——在不断尊重潜在的、有时甚至是奇怪的量子物理定律的同时，推动可学习范围的边界——正是使[机器学习势](@article_id:362354)的发展成为一场激动人心的科学冒险的原因。