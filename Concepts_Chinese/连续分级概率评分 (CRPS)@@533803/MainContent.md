## 引言
在科学和预报领域，我们追求准确性，但单点预测——例如特定的温度或股价——只讲述了故事的一半。它忽略了不确定性这一关[键维度](@article_id:305230)。一个真实、诚实的预测不是一个单一的数字，而是一个完整的[概率分布](@article_id:306824)，一个充满各种可能性的图景。这种从确定性到概率性的转变带来了一个根本性挑战：我们如何衡量一个分布形式的预测与一个单一、确定事实的结果之间的质量？像均方误差 (MSE) 这样的标准指标是不够的，因为它们只评判预测的均值，而忽略了其所表达的不确定性。

本文介绍了连续分级概率评分 (CRPS)，这是一种专为此目的设计的优雅而强大的工具。它提供了一种正常的评分规则，奖励那些既准确又具有适当置信度的预测。我们将探讨 CRPS 如何对预测性能进行整体评估，将直观概念与形式化数学联系起来。首先，“原理与机制”一节将剖析 CRPS，揭示其简单的解释、与平均绝对误差等熟悉指标的关系，以及其向多维的推广。随后，“应用与跨学科联系”一节将带领读者穿梭于各个领域——从[空间天气](@article_id:363241)和气候学到人工智能——以展示 CRPS 如何作为验证模型和促进科学发现的通用仲裁者。

## 原理与机制

在我们理解世界的旅程中，我们通常从做出一个单一、确定的猜测开始。“水的[沸点](@article_id:300339)是 $100^{\circ}\text{C}$。”“这支股票明天将达到 $150。”“选举将以 52% 对 48% 的结果获胜。”然后，我们通过猜测与事实的接近程度来衡量我们的成功。如果我们预测温度为 20°C，而实际温度为 22°C，我们可能关心的是平方误差 $(22-20)^2 = 4$，或是绝对误差 $|22-20|=2$。这些是我们熟悉的衡量标准——均方误差 (MSE) 和平均绝对误差 (MAE)。它们具有某种简单的吸引力。在多次猜测中，最小化平方误差会引导你预测平均结果（均值），而最小化绝对误差则引导你预测中心结果（中位数）[@problem_id:3175122]。

但自然界很少如此确定。要真正捕捉现实，一个单一的数字是不够的。当气象学家预报最高气温为 25°C 时，他们并非在发布神谕，而是在表达一种中心趋势。真正的问题，那个能帮助我们决定是否带外套的问题，是关于可能性的*范围*。他们是确定温度将在 24°C 和 26°C 之间，还是更像一个模糊的猜测，15°C 到 35°C 之间的任何温度都是可能的？一个单一的数字隐藏了关于不确定性的这一关键信息。一个真实、诚实的预测不是一个点，而是一个概率分布——一个充满各种可能性的图景，每种可能性都有其自身的似然。

从单一猜测到全谱概率的这一飞跃提出了一个新的挑战：我们如何衡量这种预测的质量？我们如何将一个充满“可能”的完整图景与实际发生的单一、确定的事实进行比较？这就是我们旧的度量标准，如 MSE，显得力不从心的地方。MSE 只关注我们预测图景的均值，而忽略了其广度、形状及其本质 [@problem_id:3186333]。我们需要一种新的标尺，一种能够欣赏概率预测完整艺术性的标尺。

### 度量不确定性的标尺：连续分级概率评分

什么使概率预测成为“好”的预测？我们可以想象两种相互竞争的美德。首先，预测应该是**校准的**或可靠的；它应忠实地表示事件的真实可能性。如果它说有 30% 的下雨机会，那么在多次此类预测中，大约有 30% 的时间应该会下雨。其次，预测应该是**尖锐的**；可能性的分布应尽可能集中。一个预测说温度将在 0°C 到 40°C 之间，这是校准良好的，但毫无用处。一个预测说温度在 24.9°C 到 25.1°C 之间，这非常尖锐，但如果持续错误，那就是灾难性的。一个好的预测是这两者巧妙的平衡。

于是，**连续分级概率评分 (CRPS)** 应运而生。它是我们完成这项任务最优雅、最强大的工具之一。我们不从其形式化且颇为吓人的定义开始，而是从一个极其简单且具有物理直观性的解释入手 [@problem_id:3166283] [@problem_id:3147850]。

想象一下，你的预测不是一条数学曲线，而是一片由百万个微小粒子组成的云，每个粒子代表一个可能的结果，根据你的预测概率进行分布。我们称从这片云中随机抽取的一个粒子为 $X$。真实的结果，即实际发生的事情，是 $y$。CRPS 可以理解为：

$$
\mathrm{CRPS}(F, y) = \mathbb{E}[|X-y|] - \frac{1}{2}\mathbb{E}[|X-X'|]
$$

让我们剖析这个优美的表达式。$F$ 是我们的预测分布，$X$ 和 $X'$ 是从该云中独立抽取的两个粒子。

第一项 $\mathbb{E}[|X-y|]$ 是我们预测云中随机粒子与实际结果 $y$ 之间的平均距离。这是**准确性**项。它衡量我们这片可能性的云，平均而言，与展开的现实相距多远。自然，我们希望这个距离尽可能小。

第二项 $\frac{1}{2}\mathbb{E}[|X-X'|]$ 是衡量预测内部分散程度的指标。它是从我们*自己的*预测云中随机抽取的任意两个粒子 $X$ 和 $X'$ 之间平均距离的一半。这是**尖锐度**项。一个弥散、分散的云，其粒子间的平均距离会很大，从而导致更大的惩罚。一个集中、尖锐的预测则惩罚较小。

因此，CRPS 是准确性与尖锐度之间的一场竞赛。要获得低分（分数越低越好，就像高尔夫球一样），你必须生成一个预测云，它在平均意义上接近最终的现实（良好的准确性），并且本身也是紧密聚集的（良好的尖锐度）。它将我们所期望的美德完美地封装在一个单一的数字中。

### CRPS 的多面性

一个科学基本概念的真正天才之处，往往体现在看待它的多种不同但等价的方式上。CRPS 也不例外。

#### 从概率到误差

如果我们的预测变得无限尖锐会发生什么？想象一下，我们这片可能性的云坍缩成一个单点 $\hat{y}$。这是一个**确定性预测**。在这种情况下，每个粒子 $X$ 和 $X'$ 都只是 $\hat{y}$。尖锐度项 $\frac{1}{2}\mathbb{E}[|\hat{y}-\hat{y}|]$ 变为零。准确性项 $\mathbb{E}[|\hat{y}-y|]$ 则简化为绝对误差 $|\hat{y}-y|$。

因此，对于确定性预测，**CRPS 简化为平均绝对误差 (MAE)** [@problem_id:3168826] [@problem_id:3175122]。这是一个关键的见解。CRPS 并非什么陌生的概念；它是一个我们熟悉指标的自然推广。它优雅地将绝对误差的概念扩展到了概率领域。这也凸显了它与均方误差 (MSE) 的区别。虽然 MAE 和 MSE 对点预测都是合理的，但 CRPS 本质上是一个类似 MAE 的指标，它对误差进行线性而非二次惩罚。这使得它对偶尔出现的、令人意外的大误差更具稳健性——这在处理自然界的变幻莫测时很常见 [@problem_id:3143210]。这种联系也巧妙地揭示了像决定系数 $R^2$ 这类指标的局限性。由于 $R^2$ 基于平方误差，它对预测的不确定性部分是盲目的。两个预测者可以通过预测相同的均值获得相同的 $R^2$ 分数，但其中一个可能对不确定性的感知严重失准。能够看到整个分布的 CRPS 则能轻易地区分他们 [@problem_id:3186333]。

#### 对所有问题的总和

现在让我们看一下 CRPS 的原始、形式化的定义。它看起来相当不同：

$$
\mathrm{CRPS}(F,y) = \int_{-\infty}^{\infty} \big(F(z) - \mathbf{1}\{z \ge y\}\big)^2 \, dz
$$

在这里，$F(z)$ 是你预测的累积分布函数 (CDF)，给出结果小于或等于 $z$ 的概率。函数 $\mathbf{1}\{z \ge y\}$ 是一个简单的阶跃函数：如果 $z  y$，它为 $0$；如果 $z \ge y$，它为 $1$。它代表“真实”的 CDF，一个在观测结果 $y$ 处精确地从 0 跳到 1 的阶跃。

为了理解这个积分，让我们换一种说法。对于数轴上的任何值 $z$，我们可以提出一个二元问题：“结果会小于或等于 $z$ 吗？”你的预测以概率 $F(z)$ 作答。现实则以明确的是 ($1$) 或否 ($0$) 作答，这正是 $\mathbf{1}\{y \le z\}$（或等价地，$\mathbf{1}\{z \ge y\}$）所给出的。你的概率性答案与现实的二元答案之间的平方差 $(F(z) - \mathbf{1}\{y \le z\})^2$，是一个众所周知的量，称为 **Brier 分数**。这是为是/否事件的单一概率预测评分的经典方法。

因此，CRPS 是**在所有可能的阈值 $z$ 上对 Brier 分数的积分** [@problem_id:3143210]。这就好像我们不是在一个问题上，而是在一个无限连续的问题上对我们的预测进行问责。“温度会低于 0°C 吗？低于 1°C 吗？低于 1.1°C 吗？”通过在所有可以想象的阈值上汇总性能，CRPS 确保了预测分布的*整个*形状都得到评估。这是一次非常彻底的交叉检验。本着类似的精神，它也可以被证明是**pinball 损失**（用于为分位数预测评分的函数）在所有可能分位数上的聚合 [@problem_id:3175122]。无论从哪个角度看，CRPS 都是对你预测的一次全面体检。

### 超越一维：能量评分的和谐

如果我们不是预测单个量，而是一次预测多个量呢？想象一下预测飓风的登陆点，它有纬度和经度。或者预测风速*和*风向。一种天真的方法可能是计算纬度的 CRPS 和经度的 CRPS，然后将它们相加。但这将是一个严重的错误。

为什么？因为它完全忽略了变量之间的**相关性**。也许预测的位置是一个圆形的不确定性云，而真实位置在该圆的边缘。纬度和经度的边际（一维）预测本身可能看起来相当不错，但二维预测显然是错误的。或者，一个预测可能正确预测了风速和风向的范围，但未能捕捉到在特定风暴系统中强风几乎总是来自东北方向这一事实 [@problem_id:3147850]。将各个分数相加，就像只见音符不见交响乐。

这就是 CRPS 背后原理展现其全部威力的地方。我们可以用最自然的方式将其推广到多维，从而创造一个名为**能量评分**的新指标 [@problem_id:3166283]。我们只需将一维的绝对值 $|\cdot|$ 替换为多维的欧几里得距离 $\|\cdot\|$:

$$
\mathrm{ES}(F, \mathbf{y}) = \mathbb{E}[\|\mathbf{X}-\mathbf{y}\|] - \frac{1}{2}\mathbb{E}[\|\mathbf{X}-\mathbf{X}'\|]
$$

在这里，$\mathbf{X}$ 和 $\mathbf{y}$ 现在是向量。逻辑是相同的。该分数平衡了预测云到观测结果向量的距离（准确性）与预测云自身的内部分散程度（尖锐度）。但现在，由于距离是同时在多个维度中计算的，该分数对整个多元结构都敏感，包括所有关键的相关性。它评估的是预测云作为一个整体的形状和位置，而不仅仅是它的一维投影。

从一个评判[天气预报](@article_id:333867)的简单愿望出发，我们被引向了一个具有非凡深度和普适性的原理。CRPS 及其多元表亲——能量评分，提供了一种“正常”的方式来为概率性预测评分，奖励对不确定性的诚实。它们与[绝对误差](@article_id:299802)和 Brier 分数等熟悉的概念深度关联，但又在其基础上构建了一个对概率世界观的完整、丰富结构敏感的工具。它们教导我们，在预报中，如同在科学中，目标不仅仅是正确，更是要知道自己有多正确。

