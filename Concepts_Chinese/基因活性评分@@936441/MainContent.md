## 引言
基因组包含了生命的完整蓝图，但细胞在任何特定时刻只使用其中的一小部分信息。理解哪些基因是活跃的，或处于待激活状态，是现代生物学的核心挑战之一。虽然测量[信使RNA](@entry_id:262893) (mRNA) 可以提供当前基因表达的快照，但它无法揭示编码在我们[DNA结构](@entry_id:143641)中的潜在调控潜力。本文旨在填补这一空白，介绍了**基因活性评分**这一强大的计算概念，它将基因组的物理状态转化为对基因功能的预测性度量。通过阅读本文，您将对这一统一性原则获得全面的理解。我们将首先探讨计算基因活性评分背后的核心“原理与机制”，从简单的想法开始，逐步构建整合了基因组物理学和[统计学习](@entry_id:269475)的复杂模型。随后，在“应用与跨学科联系”部分，我们将揭示该评分如何成为整合不同生物学数据的关键桥梁，从而在单细胞生物学、系统生物学乃至[精准医疗](@entry_id:152668)中挽救生命的临床决策中实现突破。

## 原理与机制

想象一下，基因组是一座巨大的图书馆，每本书都是一个基因。这些书中的文字包含了构建和运作一个活细胞的指令。几十年来，我们已经能够阅读整个图书馆——对整个基因组进行测序。然而，了解文本内容并不等同于知晓此刻正在讲述的故事。一个细胞不会同时阅读所有的书。它会有选择性地打开某些书，划出关键段落，并朗读它们来协调其生命活动。朗读基因的过程称为转录，即DNA被复制成信使RNA (mRNA)。RNA测序等技术可以告诉我们哪些书正在被阅读，以及阅读的声音有多大。但这只给了我们一个当下的快照。我们能做得更好吗？我们能否穿过图书馆，仅仅通过观察哪些书被摊开在桌上，哪些段落被划了下划线，就预测出细胞*打算*讲述的下一个故事？正是这一探索，引领我们走向了**基因活性评分**这个优雅的概念。

### 从开放染色质到基因评分：初次尝试

要预测一个基因的活性，我们需要一种方法来衡量其调控“意图”。在细胞核中，DNA并非裸露的链条；它缠绕在称为[组蛋白](@entry_id:196283)的蛋白质上，形成一种名为染色质的复合物。这种包装可以是紧实的，将基因锁起来，也可以是松散“开放”的，使它们能够被读取基因的细胞机器所接触。现代技术，如**使用测序技术的[转座酶](@entry_id:273476)可及[染色质分析](@entry_id:203722) ([ATAC-seq](@entry_id:169892))**，使我们能够在整个基因组中绘制这些开放区域，或称为**峰** (peaks)。

一个基因起跑线——即其**[转录起始位点](@entry_id:263682) (TSS)**——附近的开放染色质峰，就像看到一本书摊开在桌上。这是一个强烈的暗示，表明该基因要么是活跃的，要么正准备被激活。一个自然而然的初步想法是量化这一点：对于每个基因，为什么不简单地将所有附近峰的可及性信号相加呢？这个总和就是我们第一个简单的**基因活性评分**。这是一个直观的尝试，旨在将开放染色质的图景转化为每个基因的一个预测性数字。

然而，这种简单的方法很快就遇到了问题。想象两个细胞。一个细胞的测序过程可能更高效，或者它可能只是一个更大的细胞，含有更多的DNA，从而导致ATAC-seq读数的总数更高。这种细胞特异性的**文库大小**效应意味着其原始可及性计数会整体偏高。我们的简单求和会错误地暗示其所有基因都更活跃。为了进行公平比较，我们必须首先进行**归一化**。正如你不会通过学生写的总字数来评判其知识水平，而是通过其文章的实质内容，我们也必须校正这些技术差异。一种标准方法是将每个峰的可及性除以该细胞的总可及性，通常再乘以一个大数，如一百万（每百万计数值，Counts Per Million）。这确保了我们比较的是每个区域的*相对*开放度，而不是原始信号 [@problem_id:4362758]。

### 基因组的物理学：为何距离如此重要

我们的评分现在已经归一化，但还需要进一步完善。一个紧邻基因起始位点的峰，与一个数千碱基对之外的峰，其重要性是否相同？直觉上，我们会说不。邻近性应该很重要。这种直觉深深植根于基因组的物理现实。DNA不是一根刚性棒；它是一种在细胞核内不断摆动和折叠的柔性聚合物。为了让一个遥远的调控元件（如**增[强子](@entry_id:198809)**）影响一个基因，它必须与该基因的启动子发生物理接触。[聚合物物理学](@entry_id:145330)原理告诉我们，一条链上的两点相互碰撞的概率随着它们之间沿链距离的增加而减小 [@problem_id:4381552]。

这一生物物理现实启发我们根据每个峰与基因TSS的距离对其贡献进行加权。但是这种权重应该采取什么样的数学形式呢？是线性衰减？还是一个急剧的截断？在这里，我们可以诉诸一个优美而简单的原则。想象一个调控影响沿着DNA从一个峰向一个基因传播。这种影响“幸存”下一个小步距离的几率，不应取决于它已经传播了多远。这被称为**无记忆性**。满足这一性质的唯一连续函数是指数函数。这引导我们得出**指数衰减核** [@problem_id:4362758]：

$$
K(d) = \exp\left(-\frac{d}{\lambda}\right)
$$

在这里，$d$ 是峰与TSS之间的基因组距离，而 $\lambda$ 是一个“[特征长度尺度](@entry_id:266383)”，决定了影响衰减的速度。对于基因 $g$ 在细胞 $i$ 中的基因活性评分 $A_{g,i}$，现在变成了一个加权和：

$$
A_{g,i} = \sum_{p} X_{p,i} \cdot \exp\left(-\frac{|c_p - t_g|}{\lambda}\right)
$$

其中 $X_{p,i}$ 是峰 $p$ 在细胞 $i$ 中的归一化可及性，而 $|c_p - t_g|$ 是峰中心到基因TSS的距离 [@problem_id:3330201]。参数 $\lambda$ 并非随意设定；我们可以通过测试哪个值产生的基因活性评分与实际测量的mRNA表达水平相关性最好来调整它。本质上，我们是让数据本身告诉我们所研究系统中[基因调控](@entry_id:143507)的特征尺度 [@problem_id:4381552]。

### 完善评分：倾听细胞间的对话

我们的评分现在优美地融合了可及性和基因组物理学。但我们可以让它变得更智能。从ATAC-seq创建基因活性评分的全部目的在于进行**特征关联**：在染色质峰的世界和表达基因的世界之间建立一座理性的桥梁 [@problem_id:5034010]。到目前为止，我们的桥梁是建立在纯粹的结构假设——邻近性——之上的。我们能否增加一个功[能层](@entry_id:160747)？

当然可以。我们拥有来自数千个单细胞的数据。对于任何给定的峰和任何给定的基因，我们可以观察所有这些细胞，并提问：这个峰的可及性是否倾向于与这个基因的表达协同升降？如果它们表现出强烈的正**相关性**，这就是一个功能性调控联系的有力证据。我们可以通过将这种相关性加入我们的加权方案来利用这一点。如果一个峰既靠近一个基因，*并且*其活性模式与该基因的表达相关，那么它对该基因活性评分的贡献就会被放大 [@problem_id:4377539]。我们甚至可以为启动子和增[强子](@entry_id:198809)分配不同的基线权重。

这种精炼后的评分不再仅仅是一个结构模型；它是一个动态的、数据驱动的推断，它“倾听”细胞自身在染色质和转录输出之间的对话。正确建立这种关联的重要性不容小觑。在一些思想实验中，如果我们故意打乱峰到基因的连接，那些为整合[ATAC-seq](@entry_id:169892)和[RNA-seq](@entry_id:140811)而设计的计算方法会灾难性地失败。数据整合和生物结构的衡量指标会急剧下降，这表明基因活性评分是将这两种模态缝合在一起的关键线索 [@problem_id:3330175]。它是将染色质的语言翻译成基因语言的词典。

### 超越显而易见：一个统一的原则

从结构性基因组数据中推导出“活性评分”的想法具有惊人的强大功能和通用性。它体现了*结构反映功能*这一生物学原则。

考虑使用**游离DNA (cfDNA)** 进行[癌症诊断](@entry_id:197439)——这些是垂死细胞脱落到血液中的微小DNA片段。在癌症患者中，许多这些片段来自肿瘤细胞。当我们对这些cfDNA进行测序时，我们实际上是在对肿瘤进行“[液体活检](@entry_id:267934)”。正如我们所知，活跃基因在其启动子处有一个**[核小体](@entry_id:153162)耗竭区 (NDR)**。由于[核小体](@entry_id:153162)保护DNA不被切割，这个NDR在cfDNA池中的代表性会偏低。这在活跃基因的TSS处造成了一个特征性的测序覆盖度*下降*。我们可以根据这个耗竭槽相对于其两侧核小体峰的深度来定义一个基因活性评分。更深的槽意味着更开放的启动子和更活跃的基因 [@problem_id:4322522]。这与之前的原则相同——从染色质结构推断活性——只是应用于一种完全不同类型的数据，用于一个意义深远的临床目的。

这个概念甚至可以进一步延伸到**药物基因组学**领域。在这里，“活性评分”不是从表观遗传学中得出，而是从患者自身的遗传密码中得出。对于像 *DPYD* 这样的基因，它编码分解常用化疗药物[5-氟尿嘧啶](@entry_id:268842)的酶，不同的遗传变异（等位基因）具有不同的功能能力。“野生型”等位基因的活性系数可能为 $1$，而功能减弱的等位基因系数为 $0.5$，无功能（无效）等位基因的系数为 $0$。患者的总基因活性评分就是其两个等位基因系数的总和。一个拥有一个野生型和一个功能减弱型等位基因的人，其评分为 $1 + 0.5 = 1.5$。这个评分直接预测了他们相对于正常人（评分为 $1+1=2$）的[酶功能](@entry_id:172555)，并被用于做出关于药物剂量的挽救生命的临床决策 [@problem_id:5227792]。

在这种情况下，利害关系是直接的。为一个 *DPYD* 变异假设一个不正确的活性系数可能导致悲剧性后果。高估患者的[酶活性](@entry_id:143847)（例如，假设一个有缺陷的等位基因有50%的功能，而实际上只有25%）会导致剂量过高，从而引发严重甚至致命的毒性。低估它则会导致剂量不足和潜在的治疗失败 [@problem_id:4313028]。

从预测单个细胞的转录到为癌症患者确定化疗剂量，基因活性评分展示了其作为一个统一概念的力量。它证明了我们能够将复杂、多层次的生物信息提炼成一个单一、可解释且具有预测性的量——一个弥合了我们基因组中记载的内容与我们生活中发生的事情之间鸿沟的数字。

