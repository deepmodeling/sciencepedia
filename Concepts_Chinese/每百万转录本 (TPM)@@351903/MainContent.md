## 导言
测量基因活性是现代生物学的基石，然而，来自 RNA 测序 (RNA-seq) 实验的原始数据可能具有很强的误导性。仅仅计算比对到某个基因上的序列“读数”，就好像试图在一个小型地方图书馆和美国国会图书馆之间比较书籍的受欢迎程度，而没有考虑到它们在规模和书籍长度上的巨大差异。这种原始数据受到两个基本偏差的扭曲：[基因转录](@article_id:315931)本的长度和实验中的读数总数（[测序深度](@article_id:357491)）。如果不校正这些因素，在样本内部或样本之间比较基因表达就成了一件不可靠、无法类比的事情。

本文剖析了针对此问题最优雅的解决方案之一：[每百万转录本](@article_id:349764) (TPM)。它解决了从获取原始测序计数到推导出具有生物学意义的表达值之间的知识鸿沟。通过阅读，您将清楚地了解 RNA-seq 归一化的原理，以及为什么 TPM 已成为该领域的标准。以下章节将引导您了解核心概念。首先，“原理与机制”将阐释归一化背后的逻辑，比较有缺陷的 RPKM 方法与更稳健的 TPM，并解释使 TPM 更优越的数学和概念上的转变。然后，“应用与跨学科联系”将拓宽视野，揭示 TPM 背后的比例思维如何应用于[基因组学](@article_id:298572)以外的领域，并且是癌症免疫疗法等前沿领域的关键工具，同时也会阐明该方法的重要局限性。

## 原理与机制

想象一下，你是一名图书管理员，肩负着一项不可能完成的任务：在两个差异巨大的图书馆——一个乡镇社区图书馆和美国国会图书馆——之间比较每本书的受欢迎程度。你开始统计一个月内每本书被借阅的次数。你发现《War and Peace》在社区图书馆被借阅了 50 次，而一本关于当地历史的短篇小册子也被借阅了 50 次。它们的受欢迎程度相同吗？当然不是。你的直觉告诉你有些不对劲。

这正是一位生物学家在查看 RNA 测序实验数据时面临的困境。与某个基因匹配的序列“读数”的原始数量——即**原始计数**——就像借阅次数一样。它是一个起点，但其本身具有很强的误导性。为了真正了解一个基因的活性，我们需要像那位图书管理员一样，校正两个基本的偏差。

### 两种偏差的故事：为何计数还不够

第一个偏差是**[转录](@article_id:361745)本长度**。一个长的基因，就像《War and Peace》，比一个短的基因（那本小册子）要大得多。在典型的测序实验中，长的 RNA 分子被分解成更小的片段。即使细胞中每种分子的数量完全相同，一个长的[转录](@article_id:361745)本自然会产生比短的[转录](@article_id:361745)本更多的片段，从而产生更多的读数。比较长基因和短基因的原始计数，就像拿苹果和橘子作比较。

第二个偏差是**[测序深度](@article_id:357491)**，或称**文库大小**。这就是社区图书馆和美国国会图书馆之间的区别。一个产生 5000 万总读数的实验（一个“深度”文库）会比一个只产生 1000 万读数的实验为*每个*基因产生更多的读数，就像美国国会图书馆的总借阅量会更多一样。为了比较一个基因在两个不同实验中的活性，我们必须考虑到不同的总产出。

让我们看看实际情况。假设我们对一个样本进行测序，发现三个不同的[转录](@article_id:361745)本——A、B 和 C——它们的原始计数都是 1000 个读数。然而，它们的长度却大不相同：[转录](@article_id:361745)本 A 是 2000 个碱基对 (bp)，B 是 1000 bp，而 C 只有 500 bp 长。如果我们只看原始计数，它们似乎同样丰富。但我们的直觉尖叫着说有些不对劲。对于相同数量的读数，微小的 500 bp [转录](@article_id:361745)本 C 在细胞中的丰度肯定远远高于庞大的 2000 bp [转录](@article_id:361745)本 A。原始计数虽然是我们测量的基础，但并非故事的全部 [@problem_id:2967170]。

### “足够好”的修正：RPKM 的兴起

我们如何解决这个问题？第一个合乎逻辑的尝试是一个名为 **RPKM** 的指标，它代表**每千碱基[转录](@article_id:361745)本每百万映射读数** (Reads Per Kilobase of transcript per Million mapped reads)。这个名字本身就告诉了你它的计算方法。

1.  **“每千碱基[转录](@article_id:361745)本”**：为了解决长度偏差，我们将原始读数计数 ($C_i$) 除以基因长度（以千碱基为单位，$L_i$）。一千碱基是 1000 个碱基对。这将原始计数转化为每单位长度的读数“率”。
2.  **“每百万映射读数”**：为了解决文库大小偏差，我们将其除以整个实验中的总读数，并按一百万进行缩放 ($R/10^6$)。

完整的公式看起来有点吓人，但逻辑很简单，就是除法：
$$
\mathrm{RPKM}_{i} = \frac{10^9 \cdot C_{i}}{L_{i} \cdot R}
$$
（这里的 $10^9$ 只是一个比例因子，因为它使用了以碱基对为单位的长度和总读数，而不是千碱基和百万读数）。对于[双末端测序](@article_id:336480)，同样的逻辑也适用，但该指标被称为 **FPKM** (Fragments Per Kilobase...)。

这似乎完美地解决了两个问题。确实，如果你对一个样本进行测序，并且只是将[测序深度](@article_id:357491)加倍，使得每个基因的读数计数都翻倍，那么每个基因的 RPKM 值将保持完全相同 [@problem_id:2424961]。在这种简单情况下，它成功地对[测序深度](@article_id:357491)进行了[归一化](@article_id:310343)。它也明确地解决了长度问题；随着基因长度 ($L_i$) 趋于无穷大，其 RPKM 趋近于零，这完全合乎情理 [@problem_id:2424941]。

### 组成陷阱：RPKM 结构中的一个缺陷

有一段时间，RPKM 曾是王者。但一个微妙而深刻的缺陷潜伏在表面之下。问题不在于 RPKM 做了什么，而在于它*是*什么。RPKM 是一个**组成**性度量。这意味着任何单个基因的 RPKM 不仅仅取决于该基因；它还取决于*样本中表达的所有其他基因*。

想象一下比较大脑和肝脏中的基因表达。肝脏就像一个工厂。它有一些“超级明星”基因，比如白蛋白 (albumin)，它会大量生产。这些超级明星基因可以占到肝细胞中所有 RNA 分子的巨大比例——比如 30% 或 40%。而大脑则拥有一套更加多样化且分布更均匀的表达基因。

现在，让我们考虑一个普通的基因，Gene X，它执行基本的“管家”功能，并且在大脑和肝脏的每个细胞中都以完全相同的拷贝数存在。当你对肝脏文库进行测序时，白蛋白基因的读数将占据 RPKM 公式中“每百万映射读数”分母的巨大一部分。这个超级明星基因实际上“窃取”了分母的一部分，人为地压低了包括我们稳定的 Gene X 在内的所有其他基因的 RPKM 值。而在大脑样本中，由于没有这样占主导地位的超级明星，分母的分布更加均匀，Gene X 的 RPKM 会显得更高。

结果是什么？你会错误地得出结论，认为 Gene X 在肝脏中的表达低于在大脑中的表达，尽管它的绝对丰度是完全相同的。RPKM 值的变化不是因为 Gene X 变了，而是因为文库其余部分的*组成*发生了变化 [@problem_id:2424978]。这个“组成陷阱”使得跨不同组织或条件比较 RPKM 值成为一项危险的活动。

### 视角的转变：[每百万转录本](@article_id:349764) (TPM) 的天才之处

为了摆脱组成陷阱，我们需要转变视角。这就是**[每百万转录本](@article_id:349764) (TPM)** 的天才之处。TPM 并非一次性对长度和文库大小进行[归一化](@article_id:310343)，而是通过一个巧妙的两步过程来完成，这从根本上改变了该指标的性质 [@problem_id:2417793]。

1.  **第一步：首先对长度进行[归一化](@article_id:310343)。** 对于每个基因，我们首先将其读数计数 ($C_i$) 除以其长度 ($L_i$)。这给了我们一个每碱基对的读数“率”，即 $\frac{C_i}{L_i}$。你可以把这想象成创造了一个假设的世界，在这个世界里我们已经拉平了竞争环境，计算出如果每个基因都是标准长度，它会有多少读数。

2.  **第二步：对文库大小进行[归一化](@article_id:310343)。** 现在，我们对样本中*所有*基因的这些率进行求和 ($\sum_j \frac{C_j}{L_j}$)。这个总和代表了样本中的总“[转录](@article_id:361745)活动”。然后，我们将每个基因的单独率表示为该总和的一部分，并乘以一百万 ($10^6$)。

TPM 的公式是：
$$
\mathrm{TPM}_{i} = \left( \frac{\frac{C_i}{L_i}}{\sum_{j} \frac{C_j}{L_j}} \right) \cdot 10^6
$$

这个看似微小的运算顺序上的改变，却带来了神奇的结果。因为我们是根据样本中*所有*贡献的总和来缩放每个基因的贡献，所以根据定义，单个样本中所有 TPM 值的总和总是恰好为 $10^6$ [@problem_id:2579641]。

这就是关键。RPKM 值的总和在不同样本之间可能差异巨大，而 TPM 值的总和却是恒定的。这意味着 TPM 值是一个真正的百分比。一个基因的 TPM 值为 10，意味着来自该基因的[转录](@article_id:361745)本分子在该细胞的 RNA 池中占每百万个[转录](@article_id:361745)本中的 10 个。这使你能够以一种更有意义的方式比较一个基因在不同样本间的表达*比例* [@problem_id:2811869]。事实上，可以证明一个基因的 TPM 值是其在总 mRNA 分子中所占真实比例的直接估计，只是缩放到了百万分之一。这两个指标之间的关系是如此清晰，以至于如果你拥有一个样本的所有 RPKM 值，你唯一需要将它们全部转换为 TPM 的另一个数字就是这些 RPKM 值的总和 [@problem_id:2424946]。

### 原理而非处方：适应与打破规则

TPM 的美妙之处在于其基本原理，而不仅仅是其公式。公式中的“L”代表长度，但这并非神圣不可侵犯。实际上，由于重复序列的存在，并非基因的所有部分都能被测序读数同等地“作图”。更准确的[归一化](@article_id:310343)可能会使用基因的*有效*或**可作图长度**，而不是其注释长度。我们可以通过将可作图长度代入 TPM 公式，轻松创建一个“eTPM”（有效 TPM）。逻辑保持不变，但结果更准确 [@problem_id:2424934]。

此外，理解 TPM 的原理也教会我们何时*不*使用它。考虑一个研究环状 RNA ([circRNA](@article_id:370162)) 的实验。为了富集这些分子，科学家通常用一种叫做 [RNase R](@article_id:374729) 的酶处理他们的样本，这种酶能摧毁大多数线性 RNA，但保留环状 RNA。如果你比较一个处理过的样本和一个未处理的样本，你是在比较两个组成截然不同的文库。处理过的样本中的 RNA“蛋糕”几乎完全是环状 RNA，而未处理样本中的蛋糕则主要是线性 RNA。在这里应用标准的 TPM 公式将是一场灾难，因为它的分母——总[转录](@article_id:361745)活动——在两个样本之间将完全不同且不可比较。在这种情况下，需要一种不同的归一化策略，例如，使用在处理前添加到两个样本中的已知数量的合成“掺入”RNA [@problem_id:2799246]。这是一个至关重要的教训：没有工具是万能的，你必须始终理解你所做的假设。

### 展望未来：归一化的不朽逻辑

未来会怎样？想象一种技术——使用[长读长测序](@article_id:332398)和[唯一分子标识](@article_id:323939)符 (UMI)——让我们能够直接计算样本中的每一个 RNA 分子，而无需片段化。长度偏差就这样消失了！我们还需要 TPM 吗？

答案揭示了归一化优美而模块化的逻辑。TPM 公式实际上执行了两个独立的工作：
1.  校正长度偏差 ($\frac{C_i}{L_i}$)。
2.  校正文库大小偏差（除以总和并缩放到 $10^6$）。

有了我们未来的技术，第一项工作就不再必要了。我们是在计算分子，所以一个长分子和一个短分子都算作“1”。应用长度校正将是错误的。然而，我们仍然有第二个问题：一个实验可能捕获 100 万个总分子，而另一个实验可能捕获 500 万个。为了比较它们，我们仍然需要考虑文库大小的这种差异。

所以，在未来，TPM 的部分逻辑仍然存在。我们仍然会将原始分子计数转换为总捕获分子的比例，并以“每百万”为单位进行缩放。即使技术使得公式的其他部分过时，对抽样深度进行[归一化](@article_id:310343)的原则依然存在 [@problem_id:2424940]。这是一个强有力的提醒：在科学复杂的公式和术语背后，存在着一些简单、优雅且永恒的原则。