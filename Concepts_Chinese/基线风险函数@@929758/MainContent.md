## 引言
从医学到工程等领域，一个核心挑战不仅在于理解事件*是否*会发生，还在于理解其*何时*发生。这正是生存分析的范畴。生存分析致力于解决一个根本性问题：如何将与个体特定特征（如患者的健康状况）相关的风险，同仅仅因时间流逝而变化的普遍风险分离开来。Cox [比例风险模型](@entry_id:171806)通过一个名为基线[风险函数](@entry_id:166593)的核心概念，为此提供了一个优雅的解决方案。基线风险通常被视为一个纯粹的统计麻烦，但实际上，它是一个强大的理念，掌握着解读风险和做出具体预测的关键。

本文将基线[风险函数](@entry_id:166593)从一个技术细节提升为一个核心角色。在接下来的章节中，您将对这一至关重要的概念获得深刻而直观的理解。在“原理与机制”一章中，我们将剖析 Cox 模型，探究基线风险如何捕捉“时间的节律”，以及[偏似然](@entry_id:165240)的魔力如何让我们通过巧妙地忽略基线风险来估计个人风险因素。随后，在“应用与跨学科联系”一章中，我们将探索其实际功用，了解它在预测绝对结果、讲述[生物过程](@entry_id:164026)故事以及让我们的模型适应复杂多变的世界方面不可或缺的作用。

## 原理与机制

想象一下，您正试图理解为什么有些灯泡会比其他灯泡更快烧坏。您怀疑这与它们的制造工艺（如灯丝厚度）和使用情况（如电压波动）有关。但还有另一个因素在起作用：时间本身。一个已经亮了 1000 小时的灯泡，其本质上就不同于一个全新的灯泡。[老化](@entry_id:198459)的过程本身就改变了它发生故障的倾向。无论是对于灯泡、人的生命，还是客户忠诚度，核心挑战都在于将普遍的、随时间变化的风险与个体的特定风险因素分离开来。

Cox [比例风险模型](@entry_id:171806)为此提供了一个异常优雅的解决方案。它提出，风险——即在事件尚未发生的情况下，*立刻*发生的瞬时风险——可以被分解为两个不同的部分。该模型著名的公式是：

$$h(t | X) = h_0(t) \exp(\boldsymbol{\beta}'X)$$

让我们用应有的直觉来解读这个公式。

### 伟大的分离：时间的节律与个体风险

您可以将 $h_0(t)$ 想象成事件随时间变化的基本节律或脉搏。这是研究中所有受试者共同经历的旅程。对于术后恢复的患者来说，这个“基线风险”最初可能非常高，然后随时间推移而降低。对于一个群体中的人来说，死亡风险在年轻时较低，然后缓慢上升，到老年时则加速增长。对于一个机器部件，它可能遵循一条“浴盆曲线”：新的时候故障风险高（早期失效），然后是一段长期的低而稳定的风险期，最后随着磨损风险逐渐上升。这个函数 $h_0(t)$ 捕捉了风险随时间变化的整个动态形态。至关重要的是，这是一个假想的“参考”个体的风险，该个体所有测量的风险因素都为零 [@problem_id:1911764] [@problem_id:1911772]。

第二部分 $\exp(\boldsymbol{\beta}'X)$ 是一个单一的数字，充当个人风险乘数。$\boldsymbol{\beta}'X$ 这一项是个体特定特征（即协变量 $X$）的加权和。如果您吸烟、有高血压等等，这个和就会更大。如果您有保护性因素，它可能会更小。使用[指数函数](@entry_id:161417) $\exp(\cdot)$ 的原因虽然简单但至关重要：它确保这个乘数始终为正，因为风险率永远不可能是负数 [@problem_id:1911763]。

因此，如果您的个人风险乘数是 $2.5$，那么您在任何给定时间 $t$ 的风险恰好是同一时间基线风险的 $2.5$ 倍。如果其他人的风险乘数是 $0.5$，他们的风险就始终是基线风险的一半。这就是“比例风险”假设：任意两个个体之间的风险比率随时间保持恒定。这个比率，称为**风险比 (Hazard Ratio)**，仅取决于他们的特征，而与时间无关 [@problem_id:4823999]。其美妙的结果是，模型将风险中普遍的、随时间变化的部分 $h_0(t)$，与不随时间变化的、个人化的乘数 $\exp(\boldsymbol{\beta}'X)$ 分离开来 [@problem_id:4823999]。

### 解码基线：风险的普遍脉搏

基线风险 $h_0(t)$ 是[模型灵活性](@entry_id:637310)的灵魂所在。与那些可能强迫您假设风险恒定或线性增加的简单模型不同，Cox 模型对 $h_0(t)$ 的形状*不作任何*假设。它可以是任何非负函数。这就是为什么该模型被称为**半[参数化](@entry_id:265163) (semiparametric)** 模型：协变量部分 $\exp(\boldsymbol{\beta}'X)$ 具有固定的（[参数化](@entry_id:265163)）形式，但基线风险 $h_0(t)$ 则完全未指定（非[参数化](@entry_id:265163)）[@problem_id:4906339]。这种灵活性使其能够适应数据中真实的、潜在的风险模式，无论该模式为何。

重要的是要记住 $h_0(t)$ 的物理意义。它是一个速率，单位是事件/单位时间（例如，`死亡数/年`或 $months^{-1}$）[@problem_id:1911733]。它不是一个概率，而是一个瞬时可能性。

此外，“参考个体”的定义也很重要。基线风险是所有协变量编码为零的人的风险。如果我们研究吸烟（`1`=吸烟者，`0`=非吸烟者）和年龄（以年为单位）的影响，那么基线风险适用于一个新生儿非吸烟者。这可能不是一个非常有趣的人！统计学家通常会对协变量进行中心化处理，例如，从每个人的年龄中减去平均年龄。这样，在新系统中 `age=0` 的人实际上是平均年龄的人。这改变了 $h_0(t)$ 的数值和解释，但这种改变是完全一致的。对于任何特定个体，其估计的风险是基线风险和其风险乘数的乘积，这个值保持完全不变。改变的只是我们的参考框架，而不是物理现实 [@problem_id:4823999]。

### [偏似然](@entry_id:165240)的魔术：忽略时间来[估计风险](@entry_id:139340)

这一切都引向一个深奥的谜题。如果我们不知道 $h_0(t)$ 的形状，我们怎么可能估计出系数 $\boldsymbol{\beta}$ 呢？这似乎是一个有两个未知数的方程。

David Cox 爵士以天才之举提出的解决方案是一种名为**[偏似然](@entry_id:165240) (partial likelihood)** 的方法。他没有试图对每个事件的确切时间进行建模，而是提出了一个更微妙的问题。在事件发生的那一刻，观察所有仍处于“风险中”的个体（即他们尚未发生事件且未退出研究）。假定*其中一个*人发生了事件，那么这个事件发生在我们观察到的特定个体身上的概率是多少？

这个概率就是该个体的风险除以风险集中所有人的风险总和。对于在时间 $t_{(i)}$ 发生事件的个体 $i$，这个概率是：

$$ \frac{h(t_{(i)} | X_i)}{\sum_{j \in \text{Risk Set}} h(t_{(i)} | X_j)} = \frac{h_0(t_{(i)}) \exp(\boldsymbol{\beta}'X_i)}{\sum_{j \in \text{Risk Set}} h_0(t_{(i)}) \exp(\boldsymbol{\beta}'X_j)} $$

魔术就发生在这里。未知的基线风险项 $h_0(t_{(i)})$ 是分子和分母求和中每一项的公因子。它可以被完美地约掉！

$$ \frac{\cancel{h_0(t_{(i)})} \exp(\boldsymbol{\beta}'X_i)}{\cancel{h_0(t_{(i)})} \sum_{j \in \text{Risk Set}} \exp(\boldsymbol{\beta}'X_j)} = \frac{\exp(\boldsymbol{\beta}'X_i)}{\sum_{j \in \text{Risk Set}} \exp(\boldsymbol{\beta}'X_j)} $$

最终的表达式仅依赖于协变量和未知的系数 $\boldsymbol{\beta}$。基线风险已经消失了。通过将所有观测事件的这些概率相乘来构建一个“[似然函数](@entry_id:141927)”，我们就可以找到使该函数最大化的 $\boldsymbol{\beta}$ 值，从而得到我们对相对风险的估计。这种方法巧妙地回避了我们对时间风险真实形态的无知，使我们能够孤立地[估计风险](@entry_id:139340)因素的影响 [@problem_id:1911762] [@problem_id:4985451]。

### 审慎科学家的两难选择：稳健性与效率

基线风险的抵消不仅仅是数学上的便利；它也是 Cox 模型非凡**稳健性 (robustness)** 的来源。想象一下，你试图猜测基线风险的形状。也许你假设它是恒定的（指数模型）或遵循特定的曲线（Weibull 模型）。如果你的猜测是正确的，你可以使用“全似然”方法，该方法利用了更多信息，并将为你提供一个稍微更精确（更高效）的 $\boldsymbol{\beta}$ 估计 [@problem_id:4969223]。

但如果你的猜测是错误的呢？如果真实的基线风险是一个复杂的、凹凸不平的形状呢？基于错误形状的全似然模型将产生有偏且不一致的 $\boldsymbol{\beta}$ 估计。你在模型中引入了一个谬误，它会污染一切。

[偏似然](@entry_id:165240)通过“承认对基线风险形状的无知”，对这个问题免疫。只要[比例风险](@entry_id:166780)的核心假设成立，无论真实的基线风险是简单还是极其复杂，Cox 模型都将为你提供一个一致的 $\boldsymbol{\beta}$ 估计 [@problem_id:4969223] [@problem_id:4906425]。这是一个深刻的权衡：Cox 模型牺牲了少量潜在的效率，换来了稳健性的巨大提升。在科学领域，自然界的真实形态鲜为人知，这几乎总是一笔明智的交易。

### 整合一切：重构时间的形态

在我们利用[偏似然](@entry_id:165240)的魔力估计出系数 $\hat{\boldsymbol{\beta}}$ 之后，一个自然而然的问题随之而来：我们现在能否回头去估计那个被我们巧妙忽略的基线风险 $h_0(t)$ 呢？

答案是肯定的。我们无法直接估计 $h_0(t)$，但我们可以估计它的积分，即**累积基线风险 (cumulative baseline hazard)** $H_0(t) = \int_0^t h_0(u)du$。这个函数表示截至时间 $t$ 累积的总基线风险。一种常见的方法是使用 **Breslow 估计量 (Breslow estimator)**。其逻辑非常简单。在每个事件发生的时间 $t_j$，我们观察到一定数量的事件，比如说 $d_j$。我们还可以利用新估计出的系数，计算出那一刻风险集中所有个体的总预期风险：$\sum_{k \in \mathcal{R}(t_j)} \exp(\hat{\boldsymbol{\beta}}'X_k)$。在那一刻，累积基线风险的微小跳跃被估计为观测到的事件数与总风险的比率：

$$ \text{Jump at } t_j = \frac{d_j}{\sum_{k \in \mathcal{R}(t_j)} \exp(\hat{\boldsymbol{\beta}}'X_k)} $$

通过将截至时间 $t$ 的所有事件时间的这些微小跳跃相加，我们可以构建一个阶梯函数，用于估计整个累积基线风险曲线 $\widehat{H}_0(t)$ [@problem_id:4640279]。

这便完成了 Cox 模型的“两幕剧”。在第一幕中，我们忽略基线风险来寻找相对风险。在第二幕中，我们利用这些相对风险来重构基线风险本身的形态。这个两阶段过程对于预测绝对风险至关重要。要预测一名患者的 5 年生存概率，我们既需要从其协变量中得到的相对风险 ($\hat{\boldsymbol{\beta}}$)，也需要从基线中得到的 5 年累积的基础风险 ($\widehat{H}_0(5)$)。使用像 Breslow 这样稳健的非[参数估计](@entry_id:139349)量是至关重要的，因为即使 $\hat{\boldsymbol{\beta}}$ 是正确的，仅仅猜测基线的[参数形式](@entry_id:176887)也可能导致非常错误的预测 [@problem_id:4906425]。

当模型的所有假设都成立时，这个过程运作得非常完美。例如，如果真实数据来自 Weibull 模型（它是一种特定类型的[比例风险模型](@entry_id:171806)），Cox 模型能够正确识别 Weibull 的基线风险形状并提取出正确的系数，从而证明其捕捉潜在现实的能力 [@problem_id:1911724]。因此，基线[风险函数](@entry_id:166593)不仅仅是一个数学上的麻烦；它是生存故事中的一个核心角色，代表着不可阻挡、共同分享的时间洪流，我们的个人生活和风险都在其上展开。

