## 引言
纵向研究代表了科学探究中的一次强大转变，从对群体的单一快照转变为对个体变化的连续影片。通过随时间追踪相同的受试者，从医学到生态学等领域的研究人员可以揭示增长、衰退和反应的动态过程。然而，这种强大的设计却受到一个持续挑战的困扰：[缺失数据](@entry_id:271026)。参与者退出研究、错过预约、传感器失灵，这些都会在叙述中留下空白，如果处理不当或被忽略，可能导致有偏的结果和错误的科学结论。这个“机器中的幽灵”威胁着研究的根本完整性。本文为理解并与这个幽灵搏斗提供了一份原则性指南。它首先探讨纵向数据的核心统计概念和缺失的分类法，然后转向详细考察为解决此问题而开发的各种方法，从优雅的基于似然的方法到应对最棘手[缺失数据](@entry_id:271026)情景所需的稳健框架。

## 原理与机制

### 时间之舞：我们为何要追踪个体的一生

想象你是一位天文学家。你可以拍摄一张壮丽的夜空快照。你会看到无数星系，每个都是独特的星之岛屿，你可以用一生时间来分类它们在大小、形状和亮度上的差异。这是对宇宙的**横断面**视角——时间长河中的一个切片，富含关于物体*之间*差异的信息。

但如果你想了解星系如何演化呢？它们如何碰撞、融合和改变？为此，一张快照是不够的。你需要一部电影，一系列在数百万年间拍摄的图像。这便是**纵向研究**的精髓。我们不再仅仅比较不同个体在某一时刻的情况，而是随时间追踪*相同*的个体，观察他们个人故事的展开。在医学上，这使我们能够追踪患者对治疗的反应、疾病的进展或生物标志物在数月或数年内的轨迹。

从快照到电影的转变是深刻的。它使我们能够提出一个根本不同且通常更强大的问题。我们可以从“你我之间有何不同？”转向“你随时间*如何变化*？”。这种方法的统计之美在于它能够分离两种截然不同的变异来源。例如，在临床试验中，患者起始的基线疾病严重程度范围很广；这是**受试者间变异**。但治疗的效果是一种**受试者内变化**。

一个名为**线性混合效应模型**的绝妙工具使我们能够将其形式化。设想一个关于患者生物标志物水平 $y$ 随时间 $t$ 变化的简单模型：
$$ y_{it} = \beta t + b_i + \epsilon_{it} $$
这里，$t$ 是时间，$i$ 标记个体。项 $\beta t$ 代表了所有人的平均趋势——变化的主线故事。但每个人都是独特的。项 $b_i$ 是一个个人偏移量，一个**随机效应**，它捕捉了患者 $i$ 的基[线与](@entry_id:177118)平均水平的差异。最后，$\epsilon_{it}$ 只是测量的随机噪声。通过明确地为每个人赋予他们自己的起点 $b_i$，我们可以更精确地估计平均变化 $\beta$。我们正在使用每个人作为自己的对照，滤除人与人之间差异的嘈杂声，以听到他们内部微弱的变化信号 [@problem_id:4531976]。

### 机器中的幽灵：[缺失数据](@entry_id:271026)问题

这幅追踪个体穿越时间的美好图景存在一个问题，一个困扰着几乎所有真实世界纵向研究的幽灵：数据很少是完整的。电影中出现了缺失的帧。患者错过预约。他们搬家了。在临床试验中，他们可能因为治疗无效而退出，或者矛盾的是，因为治疗效果太好以至于他们感觉痊愈了而退出。这种参与者永久离开研究的现象称为**脱落**（attrition） [@problem_id:4733309]。

这些缺失的帧不仅仅是麻烦事；如果我们不小心，它们会毒害我们的整个分析，导致我们得出完全错误的结论。要理解原因，我们必须了解缺失的“个性”。伟大的统计学家Donald Rubin将[缺失数据](@entry_id:271026)分为三大类，这一分类法构成了现代分析的基石。

**[完全随机缺失](@entry_id:170286)（Missing Completely At Random, MCAR）**：这是最良性、也是最罕见的情景。数据缺失的原因与个体或其测量值完全无关。比如血液样本掉在地上；机器随机发生故障；参与者因为汽车抛锚而错过访视。数据缺失的概率与一切都完全独立。观测到的数据仍然是整体的一个完美的随机子样本。[@problem_id:4733309] [@problem_id:4924226]

**[随机缺失](@entry_id:168632)（Missing At Random, MAR）**：这是一个更微妙且普遍得多的情况。这个名字有点误导。“[随机缺失](@entry_id:168632)”并*不*意味着缺失是随机的。它意味着数据缺失的概率*仅依赖于我们已观测到的数据*，而不依赖于[缺失数据](@entry_id:271026)本身。例如，在一项关于[认知能力下降](@entry_id:191121)的研究中，年长的患者可能更容易错过一次随访。只要我们测量了他们的年龄，我们就可以对此进行解释。或者，在访视1时血压较高的患者可能更容易错过访视2。由于我们观测到了访视1的血压，缺失的原因是已知的。关键在于，在给定已观测历史的条件下，缺失不依赖于未观测到的值。如果我们那位在访视1时血压高的患者错过了访视2，MAR假设意味着原因与那个*已观测到的*高血压有关，而不是与他们在访视2时本应出现的、未被观测到的突然飙升有关。[@problem_id:4733309] [@problem_id:4924226]

**[非随机缺失](@entry_id:163489)（Missing Not At Random, MNAR）**：这是噩梦般的情景。数据缺失的概率取决于未观测到的数据本身。一位抑郁症研究的患者退出，*因为*他们在那周感到特别抑郁。一位减肥研究的参与者跳过一次称重，*因为*他们知道自己体重增加了。在这里，缺失行为本身就包含了关于未见值的信息。机器中的幽灵不再是被动的；它在主动隐藏我们最需要看到的证据，从而造成系统性偏倚。[@problem_id:4733309] [@problem_id:4915701]

### 与幽灵搏斗：处理缺失数据的方法

我们如何对付这个幽灵？最简单的想法往往最诱人，也最错误。人们可能倾向于只分析**完整病例**——那一小部分行为良好、没有任何[缺失数据](@entry_id:271026)的参与者。但如果病情更重的人更有可能退出（一个典型的MNAR或MAR情景），这个“完整病例”组就会比原始样本更健康，我们的结论就会有偏。

一个更具欺骗性的“解决方案”是**末次观测值结转（Last Observation Carried Forward, LOCF）**。这种方法通过简单地复制最后一次观测到的值来填补缺失值。如果一个患者在退出试验时肿瘤大小为 $2\text{ cm}$，LOCF会假设它永远保持在 $2\text{ cm}$。这在物理上和生物学上都是荒谬的。如果肿瘤正在生长，它会继续生长；如果它在缩小，它可能会继续缩小。LOCF忽略了系统的动态性，系统性地偏倚了治疗效果的比较，并产生无效的统计检验 [@problem_id:5063590]。这是一种已被广泛质疑的方法，但其简单性使其顽固地存在。

为了做得更好，我们需要更具原则性的工具。

#### [似然原则](@entry_id:162829)：一种更优雅的武器

一种远为强大和优雅的方法植根于**最大似然（Maximum Likelihood, ML）**原则。ML不是粗暴地填补空白，而是提出了一个更深刻的问题：“给定我们*已观测到*的数据，关于生成这些数据的底层过程，最合理的故事（即模型参数集）是什么？”似然函数就是这种合理性的数学表达。

当数据为MAR时，基于似然的方法（如我们前面遇到的混合效应模型）的真正魔力就显现出来了。在此条件下，[缺失数据机制](@entry_id:173251)是**可忽略的（ignorable）**。这并不意味着我们忽略了数据缺失的事实。它意味着我们不需要为缺失过程本身建立一个独立的数学模型。[似然函数](@entry_id:141927)仅基于观测数据，通过对未观测值的所有可能性进行积分（并由模型加权），自动且正确地解释了[缺失数据](@entry_id:271026) [@problem_id:4924226]。这是一个优美而深刻的结果。

在存在缺失数据的情况下，驱动ML估计的引擎通常是**[期望最大化](@entry_id:273892)（Expectation-Maximization, EM）算法**。这是一个优雅的、迭代的两步舞：
1.  **E步（期望）：** 基于我们当前对模型参数的最佳猜测，我们不只是用一个数字来填补缺失值。相反，我们计算*完整数据[对数似然](@entry_id:273783)的[期望值](@entry_id:150961)*，在缺失值的合理范围内进行平均。这一步实质上创建了一个“模糊”的完整数据集。
2.  **[M步](@entry_id:178892)（最大化）：** 然后，我们更新模型参数，使其成为最能解释这个模糊、完整数据的参数。

这个E-M之舞不断重复，每一步都在观测数据似然的“山坡”上爬得更高一些，直到我们收敛到顶峰：[最大似然估计](@entry_id:142509) [@problem_id:4973827]。这就是为什么诸如重复测量混合模型（Mixed Model for Repeated Measures, MMRM）等方法在临床试验中成为标准；它们是基于似然的，并在合理的MAR假设下提供有效的结果 [@problem_id:5063590]，[@problem_id:4556916]。

#### [多重插补](@entry_id:177416)：创造一个充满可能性的宇宙

一个并行且同样强大的思想是**[多重插补](@entry_id:177416)（Multiple Imputation, MI）**。如果说ML是寻找唯一最佳的故事，那么MI就像一位富有创造力的作家，生成了多个不同但都合理的完整故事版本。这个过程在概念上异常简单：

1.  **[插补](@entry_id:270805)（Impute）：** 通过从基于观测数据的[预测分布](@entry_id:165741)中进行[随机抽样](@entry_id:175193)，创建 $m$ 个（例如20或50个）完整数据集来填补缺失值。每个完整数据集都是一个略有不同的合理现实。
2.  **分析（Analyze）：** 使用如果没有[缺失数据](@entry_id:271026)时你会使用的标准完整数据方法，对这 $m$ 个数据集分别进行分析。你会得到 $m$ 个不同的结果。
3.  **合并（Pool）：** 使用Rubin提出的一套规则，将这 $m$ 个结果合并成一个最终答案。这个关键步骤确保了最终的不确定性不仅反映了每个数据集内的统计噪声，还反映了*关于插补本身*的不确定性。

MI的美妙之处在于其灵活性。但其中也蕴含着深刻的统一性。当[插补模型](@entry_id:169403)与分析模型兼容（或“congenial”）时，MI和ML是表兄弟，是同一枚硬币的两面。随着插补次数的增加，一个合适的MI的结果将收敛于ML的结果。它们是通往同一个严谨、原则性答案的两条不同路径 [@problem_id:5034680]。

### 揭开面纱：直面MNAR的噩梦

当MAR假设被违反时会发生什么？如果我们的数据是MNAR，而那个幽灵正在主动向我们隐藏证据，又该怎么办？这时，我们那些优雅的“可忽略”方法就会失效。标准的混合模型或[多重插补](@entry_id:177416)将产生偏倚。退出的原因与我们希望测量的结果纠缠在一起，我们再也不能忽略缺失过程了。

这引出了一个根本性的哲学问题：**不可识别性（non-identifiability）**。如果一个患有慢性疼痛的病人退出研究，我们仅凭观测数据无法知道他们是因为疼痛变得稍微严重还是急剧恶化而退出的。关于MNAR过程的不同“故事”可以导致相同的观测数据，但却得出截然不同的结论。

既然数据无法给我们一个唯一的答案，我们必须进行**敏感性分析**。我们问：“如果MNAR过程的真相是这样……或这样……或那样，我的结论会有多大改变？”我们探索一系列合理的MNAR情景，看我们的科学结论是稳健的还是脆弱的。存在两种主要框架用于这种探索。

1.  **选择模型（Selection Models）：** 在这里，我们直接将退出的[概率建模](@entry_id:168598)为协变量和（关键地）未观测结果的函数。例如，我们可能指定一个模型，其中退出的概率随着患者（未观测的）肿瘤尺寸的增加而增加。这种关系的强度是一个我们可变的**敏感性参数**。对于每个选定的值，我们可以使用**逆概率加权（Inverse Probability Weighting, IPW）**等技术，给予那些与已退出者相似的被观测个体更多的权重，从而创建一个“伪群体”，以统计方式重建完整的队列 [@problem_id:4915701] [@problem_id:4781814]。

2.  **[模式混合](@entry_id:197206)模型（Pattern-Mixture Models）：** 这种方法另辟蹊径。它根据退出模式（例如，完成者、第4周退出者、第8周退出者）将数据分片。它为每种模式的数据分布分别建模。当然，问题在于，对于退出组，我们只能对他们提供的数据进行建模，而不能对之后的情况建模。解决方案是做一个明确的、无法检验的假设，将退出者的未见轨迹与一个参考组（通常是完成者）的已见轨迹联系起来，再加上一个代表“均值偏移”的**敏感性参数** $\boldsymbol{\Delta}$。然后我们可以问，“如果退出者的结果平均比我们根据完成者预测的要差 $\boldsymbol{\Delta}$ 个单位，会怎样？”通过改变 $\boldsymbol{\Delta}$，我们探索了MNAR可能性的空间 [@problem_id:4976508]。

最后，在某些情况下，我们可以构建一个更全面的现实模型，将MNAR问题转化为可管理的问题。考虑这样一种情景：退出是由于疾病进展，而进展本身是由我们正在测量的生物标志物驱动的。这是MNAR。**联合模型（Joint Model）**提供了一个惊人优雅的解决方案。它同时对两个过程进行建模：生物标志物的纵向轨迹（使用混合效应模型）和直到退出的时间（使用生存模型）。关键在于这两个模型是相互关联的；它们共享相同的患者特定随机效应。本质上，该模型阐明了患者的个人轨迹（$b_i$）会影响他们退出的风险。通过明确地对此关联进行建模，我们解释了信息性退出，并且在这个更大、更现实的模型中，我们可以再次获得对治疗效果的[无偏估计](@entry_id:756289) [@problem_id:4556916]。这是一个美丽的示范，展示了我们如何通过拥抱复杂性来获得清晰性。

