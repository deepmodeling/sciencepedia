## 引言
研究疾病如何随时间消长是公共卫生的基础，它提供的见解可以指导干预措施和衡量进展。然而，解读这些时间趋势充满了复杂性。图表上的一条简单曲线背后可能隐藏着无数故事，而疾病率的表观变化可能只是[人口结构](@entry_id:148599)变迁、诊断实践演变或其他混杂因素造成的假象。流行病学家面临的核心挑战是超越表面观察，对人群中疾病的真实潜在动态建立严谨的理解。

本文为驾驭这一复杂领域提供了指南。它揭开了用于分析时间数据的各种方法的神秘面纱，展示了如何从统计噪音和分析陷阱中分离出真实信号。在各个章节中，您将学习解读时间序列数据所讲述故事的基本概念。第一部分**“原理与机制”**奠定了基础，解释了如何将趋势分解为其核心组成部分，介绍了可能导致错误结论的数据中的“幽灵”，并讨论了年龄标化和年龄-时期-队列框架等基本技术。第二部分**“应用与跨学科联系”**则将这些原理付诸实践，展示了如何利用它们解决现实世界的问题，从评估历史上卫生改革的影响到构建现代的实时疾病监测系统。

## 原理与机制

观察疾病随时间的消长，就像观看一场宏大而复杂的舞蹈。我们图表上的数据点不仅仅是数字；它们是一个动态过程的足迹，一个在人、地点和时间维度上展开的故事。要读懂这个故事，理解其节奏并预测其下一步动向，我们必须首先学习这场舞蹈的原理。我们必须成为时间的侦探，用工具来区分真实信号和误导性回声，区分风险的真实变化和由人口统计学变迁或我们自身观察视角变化所造成的幻象。

### 时间中的数据之舞：快照与电影

作为时间侦探，我们的首要选择是如何观察。我们有两种基本视角，两种捕捉人群健康状况的方式。

想象一下，你想描绘一个熙熙攘攘的城市广场。你可以拍一张照片。这张单一的照片，一个**横断面**视图，为你提供了某一瞬间的完美快照。你可以数出有多少人戴着帽子，有多少人坐在长椅上，以及他们聚集在哪里。在流行病学中，这就像在单一时间点 $t_0$ 进行一次调查。它告诉你一种状况的**患病率**——即*当下*有多少比例的人患有此病 [@problem_id:4585787]。它以静态画面的形式回答了“谁有病？”和“病在哪里？”的问题。但是，一张照片，无论多么详细，都无法告诉你人们要去哪里，或者他们到达的速度有多快。它无法捕捉生命的流动。

要看到运动，你需要一台电影摄像机。**纵向**视角记录了从 $t_1$ 到 $t_2$ 这段时间内的事件。它不仅向你展示谁在广场上，还向你展示谁正在进入广场。在流行病学中，这正是疾病监测登记系统所做的事情：它记录新发病例。这使我们能够测量**发病率**，即新病例出现的速度 [@problem_id:4585787]。正是有了这部电影，这份随时间变化的发病率记录，我们才能开始研究时间趋势。这部电影让我们能够提出“新病例何时出现？”、“发病率是增加还是减少？”以及“这种变化有规律吗？”等问题。要理解时间趋势，我们必须拥有这部电影。

### 解码节奏：三种基本模式

一旦我们开始观看随时间变化的发病率电影，我们就会注意到数据节奏中的模式。就像一首由贝斯线、旋律和重复副歌组成的音乐一样，疾病率的时间序列通常可以分解为三个基本组成部分。

首先是**长期趋势**。这是多年间贝斯线的缓慢、长程漂移。它是疾病的宏大叙事。总体来看，它是在增加、减少还是保持平稳？一种呼吸道感染在引入新疫苗后15年内持续下降，这就是一个长期趋势 [@problem_id:4585733]。这些趋势反映了深刻、缓慢变动的力量：公共卫生干预的广泛成功、社会行为的转变、营养和卫生条件的改善，或人口本身的结构变化。

其次，我们听到**季节性**的重复副歌。这是在单个日历年内发生的可预测波动。流感和其他呼吸道感染在冬季的年度高峰是季节性的经典例子 [@problem_id:4585733]。这种节奏通常与自然周期相关——温度和湿度影响病毒的存活——也与我们自己的社交日历相关，例如学年使孩子们密切接触。这是一种非常有规律的模式，以至于我们常常可以预测它的到来。

最后，是更神秘的**周期性**旋律。这些是持续时间超过一年、振幅和持续时间常常变化的振荡。一种疾病可能看似消失了几年，然后又以巨大的浪潮形式回归。对于许多传染病来说，这种萦绕不去的旋律是由病原体与人群免疫力之间的相互作用驱动的。一次大流行使大量人群获得免疫，耗尽了易感个体的储备。传播速度减慢。但在接下来的几年里，随着新的、无免疫力的个体出生以及其他人的免疫力减弱，易感人群的储备逐渐得到补充。最终，这个储备变得足够大，足以支持下一次大流行，循环重新开始 [@problem_id:4585733]。这就是群体免疫的美丽而时而悲壮的舞蹈。

### 清晰洞察的艺术：将趋势与季节性分离

区分这些组成部分不仅仅是目测的问题；这是一门需要精确工具的艺术。我们如何从数学上将缓慢移动的长期趋势与季节性的急促起伏分离开来？关键在于从频率的角度思考。长期趋势是低频信号；它在很长一段时间内缓慢变化。季节性是高频信号；它在短时间内快速振荡。我们的任务是滤除高频，以看到其下的低频信号 [@problem_id:4642146]。

一种方法是使用**[移动平均](@entry_id:203766)**。想象一下，你透过一块磨砂玻璃窗看你的时间序列，这块玻璃模糊了剧烈的每周波动。例如，一个中心[移动平均](@entry_id:203766)，用每个数据点自身及其邻近点在特定窗口内的平均值来替换该数据点。如果我们使用的窗口覆盖一到两个完整的季节周期（例如，对于月度数据使用12或24个月的窗口），该窗口内的季节性高峰和低谷会相互抵消，从而有效地被平均掉。剩下的是一条平滑的曲线，揭示了潜在的长期趋势 [@problem_id:4642146]。

一种更复杂的方法是**统计建模**。我们可以设计一个模型，使用不同类型的函数来捕捉不同的组成部分。对于缓慢移动的长期趋势，我们可以使用一个高度受限的平滑函数，比如带有很少“节点”（允许曲线弯曲的点）的自然[三次样条](@entry_id:140033)。例如，将这些节点每三到五年设置一个，可以创建一个足够灵活以捕捉[长期漂移](@entry_id:172399)，但在物理上无法上下摆动以跟随季节变化的函数。同时，我们在模型中包含专门设计用于捕捉高频季节性节奏的单独项，例如周期为12个月的正弦和余弦函数。然后，模型会智能地划分数据中的变异，将缓慢的变化分配给样条函数，将年度的起伏分配给正弦曲线 [@problem_id:4642146]。这种方法功能强大，但需要谨慎。为趋势使用过于灵活的函数，比如高次多项式，是一个常见的错误。这样的函数会扭曲自己以适应一切——趋势、季节性，甚至随机噪音——从而模糊了我们试图作出的区分 [@problem-id:4642146]。

### 流行病学家的幽灵：萦绕我们数据的幻象

现在我们进入了侦探的领域。我们有了工具，也识别出了模式，但一个好的科学家总是持怀疑态度。我们看到的趋势是真实的吗？还是它们是幽灵——是由我们收集和看待数据的方式本身造成的幻象？

#### 变化的叙述者

想象一下，你正在分析17和18世纪的伦敦死亡公报（London Bills of Mortality）等历史记录，以研究“热病”死亡的趋势。你可能会发现某个时间点死亡率突然下降。但如果就在那一刻，记录者引入了一个新的、独立的类别“天花”，而天花的受害者之前通常被归入“热病”类别呢？[@problem_id:4599291]。你观察到的变化不是热病的真正下降，而是由定义变化引起的**时间序列结构性断裂**——一种**错误分类**。叙述者改变了词语的含义。这一个变化可以扭曲一切。因为天花的季节模式与其他热病不同，忽略这一变化会导致你错误估计热病的真实季节性。因为被错误分类的病例数量随着天花流行病的起伏而变化，这种偏倚不是恒定的；它是差异性的，并且可以系统地扭曲你试图测量的任何关联，例如温度与死亡率之间的联系 [@problem_id:4599291]。

#### 变动的人群

也许最微妙也最强大的幽灵是构成变化。假设你正在追踪一场疫情，并绘制了一张堆积[流行曲线](@entry_id:172741)，显示每周的新增病例总数。你看到总病例数在第4周达到顶峰，然后开始下降。胜利了！疫情正在减弱。但真的是这样吗？

让我们仔细看看，按年龄分层。你可能会发现一个惊人的事实：虽然在庞大的年轻人群体中病例确实在下降，但在人数较少的老年人群体中，发病率实际上在飙升 [@problem_id:4590027]。总体下降是一种假象，是因为年轻人群体的大幅下降在数学上掩盖了老年人群体的危险增长。这是一个深刻的教训：总体趋势可能具有极大的误导性。总体是一个混合体，而混合体的故事可能与其组成部分的故事截然相反。

这种现象是**[辛普森悖论](@entry_id:136589)**的一种形式，之所以出现，是因为总体率是其子群体率的加权平均值。一个由低风险组（$L$）和高风险组（$H$）组成的人群的总体率 $R$ 为 $R = (1-w)r_L + w \cdot r_H$，其中 $r_L$ 和 $r_H$ 是各组的风险，$w$ 是高风险组在总人口中的比例 [@problem_id:4618266]。现在，考虑一个随时间变化的情景。假设由于医学进步，*两个*组内的疾病风险都下降了。但同时，由于人口老龄化，高风险组的人口比例 $w$ 急剧增加。权重 $w$ 变化的影响完全有可能如此强大，以至于压倒了组内的风险降低，导致总体率 $R$ 上升！这不仅仅是一个理论上的奇谈；它是在解释老龄化人群健康趋势时的一个关键挑战。

#### 不变的标尺

那么，我们如何驱除变动人群的幽灵呢？我们需要一把不变的标尺。这就是**年龄标化**背后的原理。当我们比较2000年和2020年的粗死亡率时，如果人口显著老龄化，使得更多人处于高风险的老年年龄组，那么这个比较就是不公平的。2020年的粗死亡率可能更高，仅仅是因为人口更老，即使年龄别风险保持不变甚至下降了 [@problem_id:4587040]。

为了进行公平比较，我们使用直接标化法来计算，如果这两年都拥有一个选定的“标准人口”的相同年龄结构，那么每年的总死亡率*本应*是多少。通过将同一组年龄组权重应用于每年的年龄别率，我们创造出可比较的标化率。它们之间剩下的任何差异都不能归因于[年龄结构](@entry_id:197671)的变化；它必须反映潜在年龄别风险的真实变化。粗死亡率告诉我们当前卫生系统的实际负担，但标化率告诉我们疾病的潜在风险是否真的在随时间变化 [@problem-id:4587040]。

### 无形的结构：解开年龄、时期和队列之谜

有时，塑造时间趋势的力量交织得更深。想象一下，试图理解一种慢性病的长期趋势。你今天在一个60岁的人身上看到的风险，是三种截然不同且相互交织的时间影响的产物。

1.  **年龄效应**：这是老龄化的普遍过程。随着年龄增长，我们的生理机能发生变化，累积暴露于各种风险的程度也增加。这是作为一名60岁老人的效应，无论你出生在何时 [@problem_id:4585433]。
2.  **时期效应**：这是当前历史时刻的影响。一种新的医疗方法、诊断技术的改变，或一场全国性的公共卫生运动都是时期效应。它们影响着在那个特定时间点活着的所有人，无论老少 [@problem_id:4585433]。
3.  **队列效应**：这是你出生时代留下的持久印记。你成长过程中是否有广泛的抗生素可用？你的队列在青春期是否经历过独特的环境暴露？这些共同的经历在不同代际之间造成了贯穿其一生的差异 [@problem_id:4585433]。

这里存在着流行病学中最美丽也最令人沮丧的谜题之一：这三种效应被一个简单而牢不可破的恒等式从根本上混杂在一起：
$$ \text{Age} = \text{Period} - \text{Birth Cohort} $$
这不是一个统计上的巧合；这是一个算术真理。由于这种完全的[线性依赖](@entry_id:185830)关系，[统计模型](@entry_id:755400)无法仅凭数据唯一地分离这三种效应的线性趋势。你可以将一个看起来是队列效应的风险随时间线性增加的趋势，在数学上重新表述为一个增加的年龄效应和一个减少的时期效应的组合，模型对数据的拟合将完全相同。数据中不包含任何信息来告诉你，在无限多种可能的组合中，哪一种是“真实”的 [@problem_id:4585433]。

这就是**APC识别问题**。要解决它，我们必须施加一个假设；我们必须帮助数据讲述故事。一种有原则的方法是重新[参数化](@entry_id:265163)模型。我们可以设计模型来充分估计年龄、时期和队列效应的非线性“曲度”，这些是可以识别的。然后，我们只剩下一个无法归因的线性“漂移”，这是我们无法在三个来源之间完美划分的总体时间趋势的度量 [@problem_id:4576391]。这是关于推断局限性的一个有力教训，也提醒我们，我们的模型的好坏取决于我们构建其中所依据的假设。

### 不完美的镜头：现实世界中的数据

最后，我们必须承认，我们观察现实的镜头——监测数据本身——是不完美的。我们分析的数字是一个复杂人类系统的产物，有其自身的延迟、缺口和偏倚。

当你查看一个正在发生的疫情的实时仪表盘时，你几乎总会看到最近一两周的病例数低于前一周。这常常造成疫情正在减弱的假象。其原因是报告延迟导致的**右删失**。最近发生的病例还没有足够的时间被诊断、记录和报告给卫生部门。在任何给定时刻，数据集对于近期的数据都是不完整的；它在右侧被截断，我们离现在越近，它就越不完整 [@problem-id:4585650]。

同样，我们对过去的看法也可能受限。当一个监测系统在特定时间启动时，它会造成**[左删失](@entry_id:169731)**；我们没有那个时间点之前的系统性数据。这也可能导致一种更微妙的偏倚：**生存者偏倚**。我们今天研究的人群是由存活到现在的个体组成的。如果我们感兴趣的疾病的风险因素也与死亡率有关，那么我们研究的群体可能系统性地比其最初来源的队列更健康，从而扭曲我们对疾病负担的估计 [@problem_id:4585650]。

有时，我们的视野不仅是被截断的，而且是**删失的**。出于隐私原因，卫生部门可能会隐藏小数目，将“2例”这样的值替换为更模糊的“少于5例”。我们知道真实值在一个界限内，但我们不知道确切值 [@problem_id:4585650]。

理解这些不完美之处并非绝望的理由。它是一门成熟科学的标志。它提醒我们，分析时间趋势不是在图上画点的简单行为。这是一项法医般的练习，一种需要我们理解数据性质、预见机器中的幽灵、并以智慧和谦逊选择工具的谨慎重建行为。只有这样，我们才能真正希望听到时间告诉我们的故事。

