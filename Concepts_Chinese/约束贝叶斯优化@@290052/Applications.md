## 应用与跨学科联系

既然我们已经窥探了[约束贝叶斯优化](@article_id:376069)的原理和机制，一个自然而令人兴奋的问题随之而来：这个优美的数学机器在世界上何处能找到它的用武之地？你会很高兴地听到，答案是：无处不在。它适用于任何一个曾面临在相互竞争的愿望、有限的资源和对后果的深刻不确定性中做出最佳选择这一普遍挑战的人。简而言之，它是一种驾驭智能妥协艺术的[算法](@article_id:331821)。

想象你是一位[材料科学](@article_id:312640)家，任务是发明一种革命性的新型固态电池。你的愿望清单既长又苛刻。你需要一种具有极高[离子电导率](@article_id:316808)的材料，以便离子能轻松穿梭其中。但它也必须化学稳定，在一侧与高反应性的金属阳极接触，另一侧与高压阴极接触时不会降解。它还必须具有机械鲁棒性，并且对真实工厂环境中的空气和湿气不敏感。问题在于，那些能赋予材料高[电导率](@article_id:308242)的物质特性——通常是具有弱结合、可极化原子的“软”原子[晶格](@article_id:300090)——也常常是导致化学不稳定的原因([@problem_id:2526616])。看来，大自然不会提供免费的午餐。你不能简单地将所有东西都最大化。

这是一个经典的多目标问题。对于任何提议的材料，你可以计算或测量其属性，给它一张记分卡。有些材料是优秀的导体，但极不稳定。另一些则坚如磐石，但像交通堵塞一样困住离子。我们所能[期望](@article_id:311378)的最好结果是发现*[帕累托前沿](@article_id:638419)*——一组“冠军”材料，对于这些材料，任何单一属性的改进都必然会使另一属性变差。这些是最佳的权衡，是大自然允许的最佳妥协。因此，重大的挑战在于，如何有效地搜索近乎无限的可能化学成分空间来找到这个前沿。蛮力搜索是不可能的。我们需要一个向导。这正是[约束贝叶斯优化](@article_id:376069)及其相关方法发挥作用的地方，它们作为我们穿越广阔、未知的可能性景观的智能向导。

### 驯服生命的狂野复杂性

也许没有什么比生命科学领域更能体现驾驭复杂、未知景观的挑战了。生物系统是数十亿年进化的产物，而非洁净室工程的杰作。它们的行为通常是非线性的，充满了[反馈回路](@article_id:337231)，而且极其难以预测。当我们试图对它们进行工程改造时，我们常常是半盲飞行。

思考一下在培养皿中培育“类器官”——人脑或肠道等器官的微型、[自组织](@article_id:323755)版本——这一惊人壮举。为了诱导干细胞形成这些复杂的结构，科学家必须遵循一个精确的配方，一个涉及十几个或更多参数的方案：各种[生长因子](@article_id:638868)的确切浓度、施加时间、它们生长的凝胶的硬度等等。一个参数的微小变化可能对最终结果产生连锁的、意想不到的影响。每次尝试培育新一批都极其昂贵和耗时，需要数周或数月。我们如何找到最佳配方？

传统的[网格搜索](@article_id:640820)，即测试所有参数组合，是可笑地不切实际的。仅用10个参数，每个参数3个设置，你就需要 $3^{10}$——将近60,000次——实验，这个任务将耗尽一个博士生的一生和一个国家的研究预算。简单的“一次一个变量”的方法也好不到哪里去，因为它会错过参数之间关键的相互作用，即上位性。这正是那种高维、昂贵且充满噪声的问题，也正是[贝叶斯优化](@article_id:323401)大放异彩的地方([@problem_id:2622457])。通过建立一个质量景观的概率性“地图”，并用它来决定下一步探索哪里，我们可以显著提高我们的[样本效率](@article_id:641792)，将我们宝贵的实验预算集中在最有希望和信息最丰富的配方上。

让我们更具体一些。想象我们正在设计一种酶，一种[生物催化剂](@article_id:300944)，用来分解聚[对苯二甲酸](@article_id:371796)乙二醇[酯](@article_id:367058)（PET），也就是构成我们许多瓶子和容器的塑料。我们的目标是找到一种已知的PET降解酶的突变体，它具有更高的催化活性。然而，有一个约束条件：这种酶还必须具有足够的[热稳定性](@article_id:317879)，才能在真实世界的生物反应器中发挥作用，而该反应器可能会在稍高的温度下运行。任何在最低温度 $S_{\min}$ 以下就解折叠并失效的酶，无论其活性有多高，都是失败品。

这里，我们有一个主要目标（最大化活性 $A$）和一个关键约束（稳定性 $S \ge S_{\min}$）。当我们使用[贝叶斯优化](@article_id:323401)来建议一个新的突变进行测试时，我们受一个[采集函数](@article_id:348126)的引导。*约束*[贝叶斯优化](@article_id:323401)的天才之处在于它如何构建这个函数。一个未经测试的新突变的“可取性”不仅仅是其高活性的潜力，而是*活性的预期改进*乘以*稳定性约束将被满足的概率*([@problem_id:2736968])。如果我们的[代理模型](@article_id:305860)对一个突变体的稳定性高度不确定，或者预测它很可能不稳定，那么可行性概率项就会很小，从而严重惩罚该候选者，即使其预测活性非常出色。该[算法](@article_id:331821)会智能地避开高风险的赌注，在对目标的乐观与对约束的健康尊重之间取得平衡。

这种构建和平衡目标与约束的逻辑是任何设计问题的第一步，也是至关重要的一步。在[算法](@article_id:331821)运行之前，我们必须将我们人类的愿望转化为其数学语言。例如，在设计一种[治疗性蛋白质](@article_id:369133)时，我们可能希望最大化其治疗效果，同时确保其[免疫原性](@article_id:344179)低（这样病人的免疫系统就不会攻击它），并严格禁止某些已知有问题的[氨基酸序列](@article_id:343164)([@problem_id:2749129])。这直接转化为一个正式的优化程序：最大化治疗效果的[采集函数](@article_id:348126)，同时受到免疫原性分数的非[等式约束](@article_id:354311)，以及一系列迫使禁用序列指示符为零的[等式约束](@article_id:354311)。这种数学语法的清晰性使我们能够以完美的精度陈述我们的设计目标。

这些方法的力量甚至延伸到生命最基本的方面。在合成生物学最宏伟的目标之一中，科学家们正试图重写遗传密码本身。通过重新分配某些三字母[密码子](@article_id:337745)的含义，他们希望创造出对所有病毒都有抵抗力的生物体，因为病毒依赖标准密码进行复制。可能的遗传密码的搜索空间不是连续的，而是巨大且组合的。改变一个[密码子](@article_id:337745)含义的影响在很大程度上取决于进行了哪些其他改变——这个景观是崎岖和[上位性](@article_id:297028)的。在这里，智能搜索算法，如[贝叶斯优化](@article_id:323401)（使用专门的[核函数](@article_id:305748)来衡量密码之间的“距离”）或相关的代理[辅助进化](@article_id:381198)[算法](@article_id:331821)，是探索生命操作系统这一新前沿的唯一可行方法([@problem_id:2768338])。

### 设计我们周围的世界：从纳米尺度到新药研发

指导新[酶设计](@article_id:369373)的相同原则也可以指导新机器或新材料的设计。考虑设计一种微观[表面纹理](@article_id:364490)以最小化摩擦的“逆问题”。润滑系统中的摩擦取决于两个表面之间间隙的几何形状。我们不必模拟无数种纹理来看哪种效果最好，而是可以颠倒问题：我们定义我们想要的属性——低摩擦，但具有支撑一定载荷的能力——然后让计算机发明一种能实现这一目标的纹理([@problem_id:2777638])。

实现这一点的一个强大方法是构建一个物理过程的*可微代理模型*，通常是一个神经网络，它能从表面的数学描述中预测摩擦和载荷。因为该模型是可微的，我们可以利用微积分的力量来计算梯度，这个梯度告诉我们如何改变表面以最好地改善其性能。这是[贝叶斯优化](@article_id:323401)的近亲，共享着使用廉价评估的代理模型来指导昂贵模拟的物理过程优化的核心理念。这是另一个美丽的例子，说明我们如何使用模型将盲目试错的过程转变为定向、智能的设计过程。

这种平衡多个不同目标的思想在考虑发现的经济学时找到了一个特别优雅的表达。想象你正在寻找一种新的药物分子。一个计算模型给你一个它与其靶蛋白[结合自由能](@article_id:345329)的估计值 $\Delta G_{\text{bind}}$——这是衡量其效果的指标。$\Delta G_{\text{bind}}$ 越负越好。但另一个模型，可能基于化学和市场数据，给你一个合成该分子的估计成本 $c$。一种效果极佳但生产成本高到无法承受的药物是无用的。你如何结合这两个分数？

这似乎是在混合苹果和橙子——能量和金钱。然而，至少有两种深刻的方式来证明创建一个单一分数如 $S = \Delta G_{\text{bind}} + \lambda c$ 是合理的，其中 $\lambda$ 是一个权衡参数([@problem_id:2458202])。从决策理论家或经济学家的角度来看，这是[约束优化](@article_id:298365)问题的[拉格朗日函数](@article_id:353636)。你想在平均预算约束下最小化 $\Delta G_{\text{bind}}$，而 $\lambda$ 作为拉格朗日乘子出现，即该预算的“影子价格”。

但从物理学家的角度来看，还有另一种方式。[分子结合](@article_id:379673)的概率与其[玻尔兹曼权重](@article_id:297966) $e^{-\beta \Delta G_{\text{bind}}}$ 相关，其中 $\beta = 1/(k_B T)$。我们可以合理地将分子“合成可及性”的概率建模为其成本的指数衰减函数，$p_{\text{avail}}(c) \propto e^{-\alpha c}$。成功的总概率是这两个概率的乘积：$e^{-\beta \Delta G_{\text{bind}}} e^{-\alpha c}$。为了最大化这个值，我们必须最小化它的负对数，这给了我们一个分数 $\beta \Delta G_{\text{bind}} + \alpha c$。除以 $\beta$（这不改变排名）得到分数 $\Delta G_{\text{bind}} + (k_B T \alpha)c$。同样的线性形式出现了，但现在权衡参数 $\lambda$ 有了与温度和我们对成本的假设相关的物理解释。两种如此不同的推理路线——一种来自经济学，一种来自统计物理学——汇聚于同一种数学形式，这是对理性思维深层统一性的美丽例证。

### 结论：发现的[算法](@article_id:331821)

我们已经看到[贝叶斯优化](@article_id:323401)在设计酶、材料和药物方面的应用。让我们以一个更具哲学性的问题结束。科学发现的整个过程——理解宇宙的宏大、混乱、充满人性的努力——能否被视为一种[算法](@article_id:331821)？它能否是[贝叶斯优化](@article_id:323401)的一种形式？([@problem_id:2438836])

要使这个类比成立，必须满足几个条件。首先，必须有一个可能理论的空间 $\Theta$。这个空间是巨大的，包含从对现有模型的微小变动到激进的新[范式](@article_id:329204)的一切。其次，必须存在某个（未知的）标量“科学效用”函数 $U(\theta)$，它为每个理论赋予一个价值。这个效用可能衡量一个理论对新数据的预测准确性，并根据其复杂性进行惩罚——这是[奥卡姆剃刀](@article_id:307589)的形式化。至关重要的是，我们只能通过进行困难、昂贵且充满噪声的实验来评估这种效用。

如果我们接受这些前提，那么科学过程就开始看起来非常像一个序贯[搜索算法](@article_id:381964)。在每个阶段，科学界都持有一种特定的“信念”，由关于所有理论效用的后验分布表示，该分布基于迄今为止收集的所有证据。决定资助哪个实验，或测试哪个理论，是一种最大化隐性[采集函数](@article_id:348126)的行为。我们是选择“利用”，进行一个实验来完善一个已建立的、高效用的理论？还是选择“探索”，测试一个狂野、不确定但可能具有革命性的新想法？

这种观点并不会削弱人类科学家的创造力和直觉。相反，它为描述他们集体事业的逻辑提供了一种强大的、抽象的语言。它表明，同样的核心原则——智能地管理信念和不确定性，以指导在广阔可能性空间中寻找“最佳”——既是设计一种更好的降解塑料的酶的基础，也是我们人类物种在探求知识道路上蹒跚、踉跄但最终前进的动力。智能妥协的艺术，事实证明，可能就是发现本身的引擎。