## 应用与跨学科联系

在了解了 `node2vec` 的原理，从其有偏[随机游走](@entry_id:142620)到 skip-gram 模型的巧妙优化之后，我们可能觉得自己已经对“如何做”有了扎实的掌握。但一个科学工具的真正魅力不仅在于其内在的优雅，更在于它让我们能够看到新世界，以及它赋予我们提出新问题的能力。现在，我们来探究“为什么做”，探索这些学习到的[向量表示](@entry_id:166424)，这些高维空间中的抽象点，如何成为发现的强大透镜，尤其是在错综复杂的生物学宇宙中。

我们已经将网络离散的、蛛网般的结构转变为一个连续的、几何的景观。在这个新的景观中，我们能*做*什么？事实证明，我们能做的很多。我们可以导航、测量、分类，甚至执行一种惊人地反映现实世界关系的“[向量代数](@entry_id:152340)”。

### 细胞的社交网络

想象一个细胞，不是一袋化学物质，而是一个熙熙攘攘的大都市。蛋白质是它的市民，它们之间的相互作用构成了一个复杂的社交网络。一些蛋白质在紧密结合的群体或“模块”中工作，以执行特定任务，就像一个建筑团队建造一个细胞结构。另一些则扮演着有影响力的中介角色，连接着不同的群体。一个蛋白质的功能在很大程度上由其社交环境定义：它与谁交谈，它的朋友是谁，以及它在社区中扮演什么角色。这正是 `node2vec` 开始大放异彩的地方。

通过为蛋白质-蛋白质相互作用（PPI）网络中的每个蛋白质学习嵌入，我们[实质](@entry_id:149406)上是为每个蛋白质提供了一组在“社交空间”中的坐标。在这个空间中彼此靠近的蛋白质，在某种意义上是相似的。然后，我们可以使用标准的机器学习工具来探索这个空间。例如，通过应用[聚类算法](@entry_id:146720)，我们可以识别出密集的点云，这些点云对应于那些紧密的[功能模块](@entry_id:275097)或生物通路。与其他方法（如谱嵌入）相比，`node2vec` 通常在生成更连贯、分离得更好的、与我们的生物学“金标准”更匹配的簇方面表现出色，这证明了它捕捉有意义的局部网络结构的能力 [@problem_id:3331381]。

我们可以更进一步。假设我们知道少数几个蛋白质与某种特定疾病有关。是否存在其他“像”它们的蛋白质也可能参与其中？这是一个监督学习问题。我们可以将已知的疾病蛋白质标记为“正例”，其他蛋白质标记为“反例”，然后基于它们的 `node2vec` 嵌入训练一个分类器（如逻辑回归）来区分它们。这创建了一个强大的疾病[基因优先级排序](@entry_id:262030)流程，使我们能够根据网络中每个蛋白质与该疾病相关的可能性对其进行排序。当然，构建这样的流程需要非常小心，以避免实验偏差和数据泄露，并需要严格的评估协议来确保预测是真正有意义的 [@problem_id:3331371]。

但两个蛋白质“相似”究竟意味着什么？在这里，`node2vec` 提供了非凡的控制度。通过调整其游走参数 $p$ 和 $q$，我们可以选择我们想要捕捉的相似性类型。
如果我们设置参数以鼓励局部的、类似[广度优先搜索](@entry_id:156630)（BFS）的探索（低 $p$，高 $q$），游走将局限于一个小邻域。由此产生的嵌入会将共享同一直接社区的蛋白质聚集在一起——这一原则称为*[同质性](@entry_id:636502) (homophily)*。这非常适合找到我们前面提到的那些[功能模块](@entry_id:275097)。
然而，如果我们设置参数以偏好全局的、类似[深度优先搜索](@entry_id:270983)（DFS）的探索（高 $p$，低 $q$），游走将被鼓励进行远距离的穿行。现在，嵌入将把具有相似*结构角色*的[蛋白质聚集](@entry_id:176170)在一起，即使它们在网络中相距很远。例如，它可能会识别出所有连接不同社区的“桥梁”蛋白质，或者所有位于星形模体中心的“枢纽”蛋白质。这两类蛋白质具有非常不同的功能，而 `node2vec` 给了我们一个旋钮来决定我们是在寻找同一俱乐部的成员还是具有相同职位头衔的个体 [@problem_id:3331387]。

### 演化网络与隐藏层

我们的细胞大都市不是静态的；它在不断变化。新的[蛋白质相互作用](@entry_id:271521)被发现，调控回路被重新布线。我们的模型能预测未来吗？通过将 `node2vec` 应用于过去某个时间点的 PPI 网络快照，我们可以学习捕捉当时其结构的嵌入。然后，我们可以训练一个模型来预测哪些当前未连接的蛋白质对最有可能在未来形成连接。这需要一个严格的、尊重时间的评估框架，即我们在时间 $t_0$ 之前的数据上进行训练，并根据在 $t_0$ 和更晚的时间 $t_1$ 之间发现的新相互作用来测试我们的预测。这将 `node2vec` 变成一个预测工具，而不仅仅是一个描述性工具，帮助生物学家将他们的实验集中在最有希望的未发现的相互作用上 [@problem_id:3331410]。

此外，一个蛋白质的社会生活是多方面的。一个蛋白质可以是一个物理复合物的一部分（PPI 网络），但它也可能是一个调节其他基因的[转录因子](@entry_id:137860)（[基因调控网络](@entry_id:150976)）。这些是不同类型的关系，形成了一个*多重网络*——一个在同一组节点上具有多层连接的图。`node2vec` 可以被巧妙地改编以适应这一现实。一种方法是构建一个“[超图](@entry_id:270943)”，其中每个蛋白质在每一层都有一个不同的节点，并通过特殊的“层间”边将一个蛋白质在不同层中的自身连接起来。现在，[随机游走](@entry_id:142620)可以在 PPI 层内移动，在调控层内移动，并偶尔在它们之间跳跃。由此产生的嵌入捕捉了一个蛋白质跨越其多个社会背景的身份 [@problem_id:3331415]。

这些网络中许多也是*有向的*。一个[转录因子](@entry_id:137860)调控一个基因；影响是单向的。简单地将网络视为无向的，就好比说听演讲和发表演讲是一回事。为了尊重这种[方向性](@entry_id:266095)，`node2vec` 可以被修改为为每个蛋白质学习两种[向量表示](@entry_id:166424)：一个当它作为调控者时的“源”嵌入，和一个当它被调控时的“目标”嵌入。这种非对称模型正确地捕捉了相互作用的有向性，从而产生更忠实、更强大的表示 [@problem_id:3331391]。

### 惊人的发现代数

也许这些学习到的嵌入最令人惊讶的方面是，[向量空间](@entry_id:151108)内的几何关系常常对应于现实世界中的逻辑和功能关系。但首先，我们如何能确定这个空间在生物学上是有意义的？一种方法是进行[富集分析](@entry_id:175827)。我们可以取一个基因，使用像余弦相似度这样的度量找到它在[嵌入空间](@entry_id:637157)中的最近邻居，然后问：“这些邻居有什么共同点？”使用像[超几何检验](@entry_id:272345)这样的统计工具，我们可以检查这个基因邻域是否在某个特定生物学功能上显著富集，例如一个特定的[基因本体论](@entry_id:274671)（GO）术语。当我们发现一个参与“[核糖体生物合成](@entry_id:175219)”的基因的邻居本身也绝大多数参与同一过程时，这让我们相信我们的几何空间不是数学虚构，而是生物学的真实反映 [@problem_id:3331413]。

有了这种信心，我们甚至可以执行更大胆的壮举。考虑一个连接药物、其蛋白质靶点以及它们治疗的疾病的三分网络。在为所有三种类型的节点在一个共享空间中学习嵌入后，我们可以开始执行向量算术。向量 `v_drug + v_disease` 可能代表什么？直观上，它结合了药物的“本质”和疾病的“问题”。如果这种药物尚不知能治疗这种疾病，这个复合向量可能会指向[嵌入空间](@entry_id:637157)中的一些蛋白质，这些蛋白质可能成为将该药物*重定位*以治疗新疾病的新靶点。这个听起来像科幻小说的想法，将[药物发现](@entry_id:261243)从一个暴力搜索转变为在一个有意义的语义空间中的引导式导航，展示了[表示学习](@entry_id:634436)的深远力量 [@problem_id:3331423]。

最后，旅程不必止于[网络结构](@entry_id:265673)。蛋白质和基因还有其他特征——基因表达水平、[序列模体](@entry_id:177422)、亚细胞定位。这些可以表示为属性向量。我们可以为 `node2vec` 设计一个[联合学习](@entry_id:637118)目标，推动嵌入同时做两件事：预测网络邻居（像往常一样），并重构节点自身的属性向量。这迫使嵌入成为一个丰富的、整体性的表示，既编码其关系背景又编码其内在属性。这种属性感知的嵌入构建了一座桥梁，将[网络科学](@entry_id:139925)的世界与广阔的其他生物数据类型融合到一个统一、强大的表示中 [@problem_id:3331422]。

从将蛋白质[聚类](@entry_id:266727)到功能家族，到预测[网络演化](@entry_id:260975)的未来，再到执行[药物重定位](@entry_id:748682)的代数运算，`node2vec` 的应用有力地说明了一个更深层次的原理。通过将一个复杂的、离散的系统映射到一个连续的几何空间，我们为探索、推理和最终的发现解锁了一套全新的工具。