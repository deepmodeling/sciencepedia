## 引言
宇宙被编织成一张巨大的宇宙网，这是一个宏伟的结构，其无形的脚手架由暗物质暗晕构成。正是在这些[引力](@entry_id:175476)摇篮中，星系得以诞生、成长和相互作用。但是，我们如何解开这些暗晕——以及它们所承载的星系——复杂的生命故事呢？关键在于理解它们的等级形成历史，一个跨越数十亿年、包含无数次并合与吸积的叙事。本文介绍了并合树，一个强大的计算工具，它记录了这段历史，弥合了黑暗、不可见的宇宙与我们观测到的发光星系之间的鸿沟。在接下来的章节中，我们将首先深入探讨“原理与机制”，探索宇宙学家如何定义暗晕，通过模拟追踪其演化，并将它们组装成一个连贯的树状结构。随后，在“应用与跨学科联系”中，我们将发现这些树如何充当模拟[星系形成](@entry_id:160121)、重建[黑洞](@entry_id:158571)传记以及理解宇宙环境深远影响的蓝图。

## 原理与机制

要理解宇宙的宏伟架构——由星系、星系团和空洞组成的宇宙网——我们必须首先理解构建它的无形脚手架：广阔的暗物质暗晕。这些暗晕是星系诞生和成长的[引力](@entry_id:175476)摇篮。并合树便是一个暗晕的生命故事，一幅[谱系图](@entry_id:636481)，通过宇宙[并合](@entry_id:147963)与相遇的历史，将其血统追溯到时间之初。但我们如何书写这个故事呢？我们如何解读宇宙结构中留下的线索，并拼凑出一个连贯的叙事？其原理是物理学与巧妙侦探工作的完美结合。

### 宇宙脚手架：什么是暗晕？

想象一下在一个宇宙模拟中飞行。你会看到暗物质聚集在致密的节点中，由流动的纤维状结构连接，并被广阔的空洞包围。这些节点就是暗物质暗晕。一个直接的、近乎哲学性的问题随之产生：暗晕的边界在哪里？与固体不同，暗晕没有清晰的边界；它的密度只是逐渐融入背景。为了研究它们，我们需要一个一致的定义。

宇宙学家们采用了一个优雅的解决方案：**球形过密度（SO）判据**。我们不寻找物理上的“边界”，而是通过一个密度阈值来定义暗晕的边界。我们在一个团块的中心画一个球体，并将其扩大，直到球体内的平均密度达到某个普适参考密度的特定倍数 $\Delta$。这很像定义一个城市不是通过其政治边界，而是通过人口密度降至（比方说）每平方英里200人的半径来定义。

但是应该使用哪个参考密度呢？宇宙提供了两个自然的选择。第一个是**临界密度**，$\rho_{\mathrm{crit}}(z) = \frac{3 H^2(z)}{8\pi G}$。这是一个在给定红移 $z$ 时，一个完美平坦的欧几里得宇宙所应具有的精确密度。第二个是**平均物质密度**，$\rho_m(z) = \Omega_m(z)\,\rho_{\mathrm{crit}}(z)$，它就是那个时代所有物质的平均密度。这导致了暗晕质量的不同“方言”。一个标记为 $M_{200c}$ 的质量意味着其边界是在其平均密度为其时代临界密度的200倍处定义的。一个标记为 $M_{200m}$ 的质量意味着参考的是平均物质密度的200倍[@problem_id:3468894]。

虽然像200这样的固定数字很方便，但物理学提供了一个更深刻的选择。**球形塌缩**理论提供了一个优美而自然的定义。想象一下早期宇宙中一个比平均密度略高的区域。这个过密区域在自身[引力](@entry_id:175476)作用下，会比宇宙其他部分膨胀得更慢，最终停止膨胀，转而塌缩成一个[引力](@entry_id:175476)束缚的天体。力学中的**[维里定理](@entry_id:146441)**告诉我们这个塌缩的天体何时会稳定下来，达到一个平衡状态——这个过程我们称之为[维里化](@entry_id:161222)。在这个特殊时刻，暗晕的密度与宇宙临界密度相比，为我们提供了一个有物理动机的过密度 $\Delta_{\mathrm{vir}}(z)$。在一个简单的、只有物质的宇宙中，这个值是一个常数：$\Delta_{\mathrm{vir}} = 18\pi^2 \approx 178$。在我们真实的宇宙中，由于存在神秘的[暗能量](@entry_id:161123)，这个值会随红移而变化，但它可以从[第一性原理计算](@entry_id:198754)出来。由此得到的质量 $M_{\mathrm{vir}}$，可以说是暗晕最有物理意义的定义[@problem_id:3468894]。

这种定义上的微妙之处导致了一个有趣的后果，即所谓的**伪演化**。因为宇宙的参考密度 $\rho_{\mathrm{crit}}(z)$ 和 $\rho_m(z)$ 随着宇宙膨胀而减小，我们对暗晕的定义边界也在缩小。这意味着，一个物理结构完全静态的暗晕，可能会因为我们的度量标准在变化而表现出随时间损失质量的现象。将这种人为效应与真实的[质量吸积](@entry_id:163137)区分开来，是准确记录暗晕成长史的关键一步[@problem_id:3490391]。

### 暗晕宇宙：主暗晕、子暗晕与战争迷雾

一旦我们能识别暗晕，我们立刻会注意到一个等级结构。宇宙网是一个丛林，大暗晕会通过[引力](@entry_id:175476)捕获并“吃掉”小暗晕。这给我们带来了两个主要角色：**主暗晕**和在其中运行的较小的**子暗晕**。构建[并合](@entry_id:147963)树的一个关键任务是正确识别这些结构，并将每个暗物[质粒](@entry_id:263777)子归属于其合法的所有者。

这比听起来要难。一个深处于子暗晕内部的粒子可能同时受到子暗晕和其更大主暗晕的[引力](@entry_id:175476)束缚。谁有权拥有它呢？基本原则是**[引力](@entry_id:175476)束缚**：一个粒子只有在它的总能量（动能加势能）为负时，即它不具备逃逸速度时，才属于一个结构。为了区分开子暗晕成员和主暗晕成员，宇宙学家采用了几种巧妙的技术。

一种方法是基于嵌套球体的思想。我们首先识别所有被束缚于主暗晕的粒子。然后，在主暗晕的领域内，我们寻找更小的、自束缚的团块。为了定义这样一个子暗晕的边界，我们使用**潮汐半径** $r_t$ 的概念。这是指主暗晕的潮汐力——在地球上产生[海洋潮汐](@entry_id:194316)的那种拉伸力——超过子暗晕自身[引力](@entry_id:175476)的点。任何超出此半径的物质都注定会被剥离并被主暗晕同化。这个过程的物理学可以被一个非常简洁优美的公式所捕捉，它告诉我们，一个质量为 $m$ 的子暗晕在质量为 $M$ 的主暗晕内部以距离 $R$ 运行，其[潮汐](@entry_id:194316)半径 $r_t$ 近似为 $r_t \approx R \left( \frac{m}{3 M} \right)^{1/3}$ [@problem_id:3468967]。通过仅将那些既被[引力](@entry_id:175476)束缚于子暗晕又位于其[潮汐](@entry_id:194316)半径内的粒子分配给它，我们可以稳健地将其与其主暗晕分离开来[@problem_id:3468929]。

一种更复杂的方法认识到宇宙并非总是整洁和球形的。在剧烈的并合过程中，暗晕可能会被拉伸、扭曲，变得一团糟。在这些情况下，仅仅观察位置是不够的。我们还必须考虑速度。这就是**相空间搜寻器**背后的思想。它们在位置和速度 $(\boldsymbol{x}, \boldsymbol{v})$ 构成的六维世界中操作。两组粒子可能在空间上交织在一起，但如果它们的运动方向不同，相空间[聚类算法](@entry_id:146720)就能将它们识别为不同的实体。这就像区分两群互相穿过的蜜蜂；在三维空间中它们是混合的，但它们独特的运动模式暴露了它们。这种技术在纠正简单算法产生的假象方面特别强大，例如当搜寻器错误地将两个邻近但不同的暗晕连接成一个虚假的巨大天体时发生的“桥接”现象[@problem_id:3468933] [@problem_id:3468929]。

### 连接点滴：构建并合树

在模拟的每个快照中都识别出一系列暗晕后，下一步就是将它们按时间顺序连接起来。我们如何知道时刻 $t_1$ 的暗晕 A 是稍后时刻 $t_2$ 暗晕 B 的前身呢？

最直接、物理上最稳健的方法是**直接追踪粒子本身**。如果构成暗晕 A 的很大一部分粒子后来在暗晕 B 中被发现，那么可以肯定 A 演化成了 B（或并合成为了 B 的一部分）。这是基本的连接机制[@problem_id:3480850]。当一个后代暗晕，比如暗晕 D，包含了来自多个早期暗晕（P1, P2, P3...）的粒子时，我们就见证了一次**并合**。然后我们可以识别出**主前身**——即贡献了最多粒子的那个——并追溯其历史，形成[并合](@entry_id:147963)树的“主支”。

为了使连接过程更加可靠，我们可以增加一层物理一致性。我们可以利用[运动学](@entry_id:173318)。根据一个暗晕在一个快照中的速度，我们可以用简单的运动定律 $d\boldsymbol{x}/dt = \boldsymbol{v}_{\mathrm{pec}}/a$ 预测它在下一个快照中的位置，其中 $\boldsymbol{v}_{\mathrm{pec}}$ 是暗晕相对于宇宙膨胀的[本动速度](@entry_id:157964)。然后我们在预测的位置搜索后代[@problem_id:3513843]。此外，我们知道暗晕不会凭空出现或消失。它们的质量应该平滑演化。我们可以施加一个**质量连续性**约束，确保快照之间的任何质量变化都是物理上合理的，并且不超过由暗晕自身的**动力学时标** $t_{\mathrm{dyn}} \sim R/V$——即暗晕内部发生事件的[特征时间尺度](@entry_id:276738)——所决定的速率[@problem_id:3513843]。

### 机器中的幽灵：孤儿暗晕与观测极限

当一个在巨大主暗晕深处运行的子暗晕受到潮汐力的冲击时会发生什么？它会失去质量，变得更小、更暗。最终，它的粒子数量可能会降到我们的暗晕搜寻器能够识别一个天体的最低数量之下，或者它的密度反衬可能会融入主暗晕的背景噪声中。从暗晕搜寻器的角度看，这个子暗晕就消失了。但它是否被完全摧毁了？

答案往往是否定的。一个致密、紧密束缚的内核可以存活得更久，即使在我们的算法无法探测到它之后，它仍会继续其[轨道](@entry_id:137151)舞蹈。如果一个星系，以其自身的深[势阱](@entry_id:151413)，位于子暗晕的中心，情况尤其如此。这些幸存但未被探测到的天体被诗意地称为**孤儿暗晕**[@problem_id:3468934]。

这深刻地揭示了科学测量的本质：我们对现实的描绘总是受到我们仪器（在此案例中是我们的暗晕搜寻器）灵敏度的限制。为了创造一部更忠实的历史，我们必须考虑到这些“幽灵”。当一个子暗晕从目录中消失时，我们不是简单地终止它在树中的分支。相反，我们将其作为一个孤儿继续向前追踪。我们取其最后已知的位置和速度，并继续用解析方法追踪其[轨道](@entry_id:137151)。但我们还必须包含一个最终将决定其命运的力量：**动力学摩擦**。

动力学摩擦是一个优美的概念。当一个大质量物体穿过一片由较轻粒子组成的海洋时，它的[引力](@entry_id:175476)将背景粒子拉向自己，在身后形成一个致密的尾迹。这个过密的尾迹随后会对物体施加自身的[引力](@entry_id:175476)，使其减速。这就像一艘船被自己激起的尾流拖慢一样。对于一个子暗晕来说，这种[引力](@entry_id:175476)拖拽使其[轨道](@entry_id:137151)衰减，不可逆转地螺旋式地朝向其主暗晕的中心。著名的 Chandrasekhar [并合](@entry_id:147963)时标公式 $t_{\mathrm{df}}$ 揭示了，这个过程对于质量越大的卫星效率越高；它们产生更大的尾迹，下沉得更快。该公式可以近似为 $t_{\mathrm{df}} \propto \frac{M_{\mathrm{host}}}{M_{\mathrm{sat}}} t_{\mathrm{dyn}}$ [@problem_id:3468935] [@problem_id:3468934]。通过模拟这个过程，我们可以准确预测孤儿最终何时会与主暗晕中心合并，完成它的旅程。

### 从树木到森林：星系的故事

我们为何要费尽周折为这些无形的暗物质暗晕构建如此复杂的家族树呢？因为它们是可见宇宙的蓝图。这些并合树构成了星系形成、演化和并合的宇宙脚手架。这些树提供了[引力](@entry_id:175476)骨架；然后我们再“涂上”更复杂的重子物理学——构成气体、恒星和行星的普通物质。这种方法被称为**[半解析模型](@entry_id:754676)（SAMs）**。

SAMs 的整个哲学建立在一个关键的[时间尺度分离](@entry_id:149780)之上。当气体落入一个暗物质暗晕时，它会被激波加热到暗晕的维里温度。对于像我们银河系这样的大质量暗晕，这些气体变得极热且稀薄，以至于其冷却时间 $t_{\mathrm{cool}}$ 远长于暗晕的动力学时标 $t_{\mathrm{dyn}}$ [@problem_id:3486145]。这意味着热气体可以形成一个稳定的准静态大气（一个“热晕”），需要数十亿年才能冷却和凝聚。这个缓慢的冷却过程为中心恒星形成盘的形成提供燃料。相比之下，在较小的暗晕中，气体冷却非常迅速，导致剧烈的恒星形成爆发。

这种[尺度分离](@entry_id:270204)，加上“不确定性的层级”——即我们对[引力](@entry_id:175476)的理解远胜于我们对[恒星形成](@entry_id:159940)和[黑洞](@entry_id:158571)反馈等复杂过程的理解——证明了 SAM 方法的合理性。我们使用稳健计算出的[并合](@entry_id:147963)树作为基础，然后添加描述气体流动、恒星诞生以及[超新星](@entry_id:161773)和[超大质量黑洞](@entry_id:157796)注入能量的解析“配方”[@problem_id:3486145] [@problem_id:3468935]。

从定义一个简单的团块到模拟[星系演化](@entry_id:158840)的完整图景，这段旅程证明了物理原理的力量。这个领域是一个充满活力的领域，有许多不同的算法用于寻找暗晕和构建并合树。为了确保进展，学术界开发了[标准化](@entry_id:637219)的基准测试来比较这些方法，量化它们在错误连接率或质量历史准确性等指标上的优缺点[@problem_id:3468920]。这个严谨的、自我修正的过程不仅揭示了宇宙的结构，也揭示了科学探究本身的美丽结构。

