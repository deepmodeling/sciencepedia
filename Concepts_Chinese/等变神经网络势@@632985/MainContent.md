## 引言
模拟原子的舞蹈是现代科学的核心目标之一，是发现新材料、设计药物和理解生命本身的关键。尽管量子力学定律提供了精确的描述，但其巨大的计算成本使其仅适用于最小的系统。这催生了[机器学习势](@entry_id:183033)的发展，它有望以极低的成本达到量子级别的精度。然而，一个关键的挑战依然存在：我们如何确保这些数据驱动的模型尊重物理世界的[基本对称性](@entry_id:161256)？任何未能认识到物理定律与观察方向或位置无关的模型，不仅是不准确的，更是违背物理原理的。

本文深入探讨了[等变神经网络](@entry_id:137437)势（ENNPs），这是一类革命性的模型，它们从一开始就建立在[几何对称性](@entry_id:189059)原理之上。我们将探索这些网络是如何被精心构建以使用物理学的语言进行表达的。第一章“**原理与机制**”剖析了[等变性](@entry_id:636671)的数学和物理基础，解释了群论的概念如何被嵌入到网络架构中，以保证物理上一致的预测。随后，“**应用与跨学科联系**”一章展示了这种方法的变革性影响，从实现大规模分子动力学模拟和粗粒化建模，到其在[材料科学](@entry_id:152226)和[核物理](@entry_id:136661)等不同领域的惊人效用。

## 原理与机制

想象一下，你正在计算机中构建一个宇宙。你想模拟构成物质的原子之舞，从简单的水分子到复杂的晶体。你必须遵守的最基本规则是什么？在你编写任何一行代码之前，物理学就给了你一条黄金法则，一个美妙而简洁的原则：自然法则不依赖于你身在何处或看向何方。一个孤立的氢原子在你实验室中的行为与它在遥远星系中的行为相同；如果你转过头，它的性质不会改变。这就是**欧几里得对称性**原理，它是构建任何忠实物理世界模型的基石。

### 不可动摇的对称性定律

三维空间中所有这些[刚性运动](@entry_id:170523)——平移、旋转和反射——的群被称为**欧几里得群**，或 $E(3)$。当我们构建一个机器学习模型来预测原子系统的[势能](@entry_id:748988)时，这一原则施加了严格的约束。总能量是一个标量，它在任何 $E(3) $变换下都必须是**不变的**。如果你旋转或移动整个系统，能量必须保持完全相同。

然而，原子上的力是矢量，它们有方向。如果你旋转系统，力矢量必须随之旋转。它们不是不变的，而是**等变的**。一个等变函数是与群的作用“可交换”的函数：先变换输入再应用函数，与先应用函数再变换输出得到的结果相同。形式上，对于一个从原子构型 $X$ 预测某种性质的函数 $f$ 和一个群变换 $g \in E(3)$，条件是：

$$
f(g \cdot X) = \mathcal{D}(g) f(X)
$$

在这里，$g \cdot X$ 表示变换后的原子构型，而 $\mathcal{D}(g)$ 是描述输出应如何变换的表示。对于标量能量，$\mathcal{D}(g)$ 就是数字 1（[不变性](@entry_id:140168)）。对于力，$\mathcal{D}(g)$ 是旋转力矢量的[旋转矩阵](@entry_id:140302)。任何未能通过此测试的模型不仅是不准确的，而且从根本上是违背物理原理的 [@problem_id:2784668]。

但是，我们如何教会一个[神经网](@entry_id:276355)络——一个复杂的[非线性](@entry_id:637147)函数网络——去尊重这样一个深刻而精确的对称性呢？实现这一点主要有两种理念。

### 通往对称模型的两条路径

第一条路径是一条巧妙的间接路线。它认为：如果我们能从一开始就对网络隐藏所有旋转信息，为什么还要费心教它关于旋转的知识呢？这就是**不变描述符方法**。我们不是将原子的原始三维笛卡尔坐标输入网络，而是首先将它们转换成一组本质上对[旋转和平移](@entry_id:175994)不变的数字。这些描述符可以是所有原子对之间的距离、三元组之间的角度，或是更复杂的关于局域原[子环](@entry_id:154194)境的函数 [@problem_id:2784682]。由于网络的输入已经是不变的，它学习到的任何函数——无论多么复杂——也将产生一个不变的输出。我们就得到了一个不变的能量，正如所要求的那样。

那么力怎么办呢？在这里，我们借助了微积分的美妙工具。一个基本定理指出，如果你对一个在旋转下不变的[标量场](@entry_id:151443)求梯度，得到的矢量场会自动地在相同的旋转下是等变的。因此，通过构建一个不变的能量，然后通过取其解析负梯度（$\mathbf{F}_i = -\nabla_{\mathbf{r}_i} E$）来计算力，我们“免费”获得了完全等变的力 [@problem_id:3422804]。这种优雅的方法是诸如[Behler-Parrinello](@entry_id:177243)势和[高斯近似势](@entry_id:749744)（GAP）等非常成功的模型的基础 [@problem_id:2784682]。

然而，这种方法有一个潜在的缺点。通过在一开始就将丰富的[三维几何](@entry_id:176328)信息简化为一列[标量不变量](@entry_id:193787)，我们可能丢弃了关键信息。这就像试图通过只看雕塑表面点之间的一系列距离来理解它一样——你失去了对其形状的直接感觉。

这就引出了第二条路径，一条更直接、可以说也更深刻的路径：**等变方法**。我们不是让模型对几何“视而不见”，而是教它用几何的语言来*思考*。我们构建一个网络，其中的特征本身不仅仅是数字，而是几何对象——标量、矢量和[高阶张量](@entry_id:200122)——它们知道如何在旋转下正确地变换。

### 几何的语言：[等变性](@entry_id:636671)的构建模块

要构建这样一个网络，我们必须借鉴物理学和数学中一种强大的语言，即[群表示论](@entry_id:141930)的语言。这种语言为我们提供了旋转对称性的基[本构建模](@entry_id:183370)块。

关键组成部分是**球谐函数**，记作 $Y_{lm}(\hat{\mathbf{r}})$。这些是定义在球面上的[特殊函数](@entry_id:143234)集，它们充当角度信息的“[傅里叶级数](@entry_id:139455)”。正如任何声音都可以分解为纯音（正弦和余弦）的总和一样，三维中的任何方向关系都可以描述为球谐函数的总和。

这些函数构成了所谓的[旋转群](@entry_id:204412) $SO(3)$ 的**不可约表示**（irreps）的基础。一个[不可约表示](@entry_id:263310)是一种基本的、不可分割的对称“类型”。每个不可约表示都由一个非负整数 $\ell = 0, 1, 2, \dots$ 标记。
*   **$\ell=0$** 代表**标量**：在旋转下完全不变的量。
*   **$\ell=1$** 代表**矢量**：像空间中的箭头一样旋转的量。
*   **$\ell=2$** 代表**[四极张量](@entry_id:276086)**，它们具有更复杂的方向特性，就像原子[d轨道](@entry_id:261792)的形状一样。

在一个[等变神经网络](@entry_id:137437)中，每个特征都是一个**球张量**，它是由 $2\ell+1$ 个数字组成的集合，作为一个整体，它根据类型 $\ell$ 的[不可约表示](@entry_id:263310)进行变换。当原子系统旋转时，这些数字会以一种精确、明确定义的方式相互混合，这种方式由一组称为**[Wigner D-矩阵](@entry_id:187739)**的旋转矩阵 $D^{(\ell)}(R)$ 描述 [@problem_id:3468381]。网络架构被精心设计，使得每个操作都保持这种变换属性。

### 等变机器：张量的交响乐

在其核心，一个[等变神经网络](@entry_id:137437)是一种**[消息传递](@entry_id:751915)**架构。原子与其邻居通信，根据它们收到的消息更新其内部状态。但与标准图网络不同，这些消息不仅仅是数字，它们是球张量的集合。

两个原子 $i$ 和 $j$ 之间的相互作用取决于两件事：它们的内在属性和它们的几何关系。
1.  **距离**：相互作用的强度随距离衰减。我们用**径向基**来建模，这是一组仅依赖于距离 $r_{ij} = |\mathbf{r}_i - \mathbf{r}_j|$ 的函数。为了符合物理原理，这些函数通常被选择为基本物理方程（如Helmholtz方程）的解，并被约束为表现良好且在选定的截断距离处平滑地消失 [@problem_id:3449460]。
2.  **方向**：方向性由归一化方向矢量 $\hat{\mathbf{r}}_{ij} = (\mathbf{r}_j - \mathbf{r}_i) / r_{ij}$ 的[球谐函数](@entry_id:178380) $Y_{lm}$ 捕获。

神奇之处在于我们将原子 $i$ 的张量特征与其邻居 $j$ 的几何信息结合起来。这是通过**张量积**完成的，这是一种类似于乘法但适用于几何对象的操作。例如，将原子 $i$ 上的一个矢量特征（$\ell_1=1$）与指向原子 $j$ 的矢量（$\ell_2=1$）相结合，会创建一个新的、更复杂的对象。

然而，这个新对象不是一个简单的球张量。它是一个[可约表示](@entry_id:137110)——一个包含多种基本[对称类](@entry_id:137548)型的“袋子”。这就是量子力学中最美妙的思想之一发挥作用的地方：**Clebsch-Gordan耦合**。正如耦合两个电子的角动量会得到一系列可能的总角动量一样，两个[不可约表示](@entry_id:263310) $\ell_1$ 和 $\ell_2$ 的张量积可以分解为一系列新的[不可约表示](@entry_id:263310)的 čistý súčet，其类型 $\ell$ 的范围从 $|\ell_1 - \ell_2|$ 到 $\ell_1 + \ell_2$ [@problem_id:3449548]。**[Clebsch-Gordan系数](@entry_id:142551)**是执行这种分解的固定的、普适的常数。它们被硬编码到网络中，形成一个不可训练的脚手架，在每一步都严格强制对称性。网络通过调整缩放这些正确形成的等变通道的权重来进行学习 [@problem_id:3449548]。

通过重复应用这些等变消息传递和耦合操作，网络构建出越来越复杂和抽象的几何特征，同时完美地保持了底层的 $E(3)$ 对称性。当我们想计算最终能量时，我们只需将所有原子的标量（$\ell=0$）特征相加。结果是一个保证不变的标量。这种强大的构造确保了这些模型不仅仅是受限的玩具；它们是**通用近似器**，能够以任意精度表示任何连续的[对称函数](@entry_id:177113) [@problem_id:2908414]。

### 从理论到现实：实践中的改进

构建一个真正实用的势需要解决一些更微妙的问题。

**手性和宇称**：[旋转群](@entry_id:204412) $SO(3)$ 不包括反射。那么镜像分子（[对映异构体](@entry_id:149008)）怎么办？为了处理这些情况，我们必须考虑完整的[正交群](@entry_id:152531) $O(3)$，它包括反演（$\mathbf{r} \mapsto -\mathbf{r}$）。这引入了**宇称**的概念。张量被分为“极性”（如位置或力，在反演下变号）或“轴性”（如角动量，不变号）。一个 $O(3)$-[等变网络](@entry_id:143881)必须跟踪其特征的宇称，以区分一个系统和它的镜像，这对于模拟手性材料至关重要 [@problem_id:3449477]。

**多种类原子**：真实的材料不是由一种原子构成的。我们如何处理例如铜和锌的混合物？不可区分性原则要求，如果我们交换两个铜原子，能量不应改变，但如果我们用一个锌原子换一个铜原子，能量肯定会改变。一个简单地按任意索引排序原子的幼稚模型将会失败。正确的方法是以尊重*每种原子内部*的[置换对称性](@entry_id:185825)的方式构建特征并进行聚合。一种常见且稳健的方法是在将所有给定类型的原子的特征相加以模拟跨[物种相互作用](@entry_id:175071)之前，先将它们求和 [@problem_id:3449439]。

**[截断半径](@entry_id:136708)的暴政**：也许最大的挑战是消息传递的局域性。根据设计，一个原子只从有限[截断半径](@entry_id:136708)内的邻居接收信息。但一些物理力不是局域的。静电[库仑相互作用](@entry_id:747947)，以其 $1/r$ 的长程尾巴而闻名。在一个离子晶体中，一个原子感受到整个晶体中所有其他离子的拉力，而不仅仅是其直接邻居。一个纯粹局域的ENNP将完全忽略这种长程物理。

解决方案不是放弃ENNP，而是将其与[经典物理学](@entry_id:150394)结合在一个**混合方案**中。我们让ENNP做它最擅长的事情：模拟复杂的、量子力学的[短程相互作用](@entry_id:145678)。对于[长程静电作用](@entry_id:139854)，我们使用像**Ewald求和**或**粒[子网](@entry_id:156282)格Ewald（PME）**算法这样经过时间考验的解析方法。这些方法能正确计算周期性系统中的长程能量。总能量是ENNP的短程贡献和解析长程部分的总和。通过使整个流程可[微分](@entry_id:158718)，我们可以计算出正确考虑了系统局域和全局物理的力 [@problem_id:3449555]。

通过这种方式，[等变神经网络](@entry_id:137437)势代表了深刻物理原理与现代机器学习的综合。它们不仅仅是拟合数据的“黑箱”，而是根据空间本身的[基本对称性](@entry_id:161256)构建的，为探索原子世界提供了一种强大且有原则的新工具。

