## 应用与跨学科联系

在上一章中，我们熟悉了似然的形式化机制。我们视其为一种估计参数的数学工具，一个逆向工程过程，我们提问：“根据我们收集到的数据，按照我们的模型，世界最合理的版本是什么？”但如果止步于此，就好比学会了国际象棋的规则却从未下过一盘棋。似然原理真正的力量和美感不在于其定义，而在于其应用。它是解决大量科学问题的万能溶剂，是那些在其他方面可能看似毫无关联的领域研究人员所共用的一种语言。

在本章中，我们将踏上一段旅程，亲眼见证这一原理的实际应用。我们将看到这个单一而优雅的思想如何让我们能够构建更丰富、更真实的模型——这些模型能够处理真实数据的杂乱、复杂和不完整的特性。我们将看到它不仅提供答案，而且为[科学推理](@entry_id:754574)提供了一个完整的框架，从比较相互竞争的思想到跨越从相关性到因果关系的巨大鸿沟。

### 驾驭复杂性的艺术：处理相依数据

许多统计学入门课程中的一个简化假设是，我们的数据点是*[独立同分布](@entry_id:169067)*的——就像一系列的硬币抛掷，一个结果对下一个没有任何影响。当然，现实世界很少如此整洁。观测数据常常纠缠在复杂的依赖网络中，忽略这些联系不仅是草率的，更可能导致大错特错的结论。基于似然的推断提供了一种强大而原则性的方法来模拟这种相互依赖性，并将其写入我们模型所讲述的故事中。

考虑一项针对新药的现代临床试验。我们不只对患者进行一次测量；我们会在数周或数月内跟踪他们的反应。对同一个人进行的这些重复测量显然不是独立的。第一周反应良好的患者在第二周很可能也比平均水平要好。他们的测量值是相关的。如果一个幼稚的分析将每次测量都视为一个独立的数据点，那将是愚蠢的——它会高估我们拥有的信息量，并产生具有误导性的小[误差范围](@entry_id:169950)。

一种更复杂的方法，由似然框架所实现，是使用所谓的**[线性混合模型](@entry_id:139702)（LMM）**。我们不只是对平均反应随时间的变化进行建模，而是写下一个更丰富的、由两部分组成的故事。一部分描述了所有患者的平均趋势，另一部分则描述了每个患者的轨迹如何围绕该平均值变化。这些个体差异被建模为“随机效应”。通过写下这个两部分故事的完整似然函数，我们可以同时估计总体治疗效果和受试者内部相关性的性质。这种方法尊重了数据的真实结构，为我们提供了对药物效果最精确和准确的估计。这是广义[高斯-马尔可夫定理](@entry_id:138437)的直接应用，确保了我们的估计量在一大类估计量中是最佳的 [@problem_id:4998779]。

同样的原理从时间上的依赖关系延伸到空间上的依赖关系。想象一位生态学家正在研究一条新路对整个景观中鸟类丰度的影响。一个地点的丰度很少与其邻近地点无关。有利的条件可能会延伸到整片森林，从而产生正向的**[空间自相关](@entry_id:177050)**。同样，一个简单的[回归分析](@entry_id:165476)将是无效的。但是我们可以使用似然来指定一个模型，其中一个位置的未观测误差明确地是其邻近位置误差的函数。像空间自回归（SAR）或条件自回归（CAR）模型正是这样做的。它们使用一个*空间权重矩阵*（$W$）来定义哪些地点是邻居，并且似然函数包含一个量化这种空间依赖强度的参数。在拟合这个模型时，我们不仅可以对道路的影响进行有效检验，还能了解到生态过程的空间尺度 [@problem_id:2468515]。

依赖关系甚至可以更加抽象。想一想最宏大的依赖关系：[生命之树](@entry_id:139693)。物种不是独立的实体；它们通过共同的进化历史联系在一起。现代[系统发育学](@entry_id:147399)使用似然来重建这段历史。在这种情况下，**最大似然**方法涉及计算观察到当今物种DNA序列的概率，给定一个提议的进化树和一个关于DNA如何随时间变异的随机模型。似然是在整个树上计算的，对所有可能的、未观察到的祖先序列的概率进行求和。最大化这个似然的[树拓扑](@entry_id:165290)和[分支长度](@entry_id:177486)代表了我们关于这些物种如何进化和相互关联的最佳假说。从微生物学 [@problem_id:2521936] 到动物学 [@problem_id:2604320]，似然使我们能够将[序列数据](@entry_id:636380)转化为关于深层时间的故事，这一切都通过明确地模拟进化中固有的依赖关系来实现。

### 战胜不完美：处理[缺失数据](@entry_id:271026)

现实世界的科学是一场与不完美的斗争，而最常见的不完美之一就是[缺失数据](@entry_id:271026)。患者退出研究，设备发生故障，调查对象跳过问题。一种幼稚的反应是简单地分析“完全案例”，即扔掉任何哪怕只有一个缺失值的受试者。这不仅是浪费，而且可能导致灾难性的偏误。

在这里，基于似然的推断再次提供了一个异常优雅的解决方案。关键在于数据*为何*缺失的原因。在许多情况下，缺失是我们所说的**[随机缺失](@entry_id:168632)（MAR）**。这并不意味着数据是无缘无故缺失的；它意味着一个值缺失的概率可能依赖于我们*已经*观察到的其他信息，但不是依赖于未观察到的值本身。例如，在临床试验中，如果患者先前测量的健康状况较差，他可能更容易错过一次随访。

在MAR假设下，基于似然的方法如同魔法般有效。因为[似然函数](@entry_id:141927)是从受试者数据的完整[联合分布](@entry_id:263960)模型中推导出来的，我们可以只为我们观察到的部分写下[似然函数](@entry_id:141927)，而这个“观测数据似然”就足够了。最大化它能为我们的参数提供有效、无偏且一致的估计，而无需明确地对缺失机制本身建模 [@problem_id:4998779]。该模型有效地利用了它从完整数据者身上学到的关系，在存在退出者的情况下做出了统计上有效的推断。

这一特性是现代生物统计学的基石，它允许对有退出者的纵向研究进行有效分析 [@problem_id:4541354]。这是对指定一个完整概率模型力量的深刻展示。当然，MAR假设本身可能是错误的。如果患者因为*那一刻*感觉非常糟糕（一个我们未能记录的值）而退出研究怎么办？这被称为[非随机缺失](@entry_id:163489)（MNAR）。即使在这里，似然框架也提供了一条前进的道路。它成为**[敏感性分析](@entry_id:147555)**的基础，我们可以构建包含MNAR效应的显式参数（一个 $\delta$-调整）的模型，并观察当改变我们关于偏离MAR程度的假设时，我们的结论会如何变化 [@problem_id:4541354]。

### 超越估计：一个[科学推理](@entry_id:754574)的框架

似然的力量远不止是简单地找到参数的最佳值。它为科学探究提供了一套全面的工具包。

首先，它以**[似然比检验](@entry_id:268070)（LRT）**的形式为我们提供了一种比较相互竞争的科学假说的通用方法。假设我们有一个简单的世界模型和一个更复杂的模型，后者将前者作为特例包含在内。增加的复杂性是否合理？LRT提供了一个直接的答案。我们计算两个模型的[最大似然](@entry_id:146147)。这两个似然的比值告诉我们，在更复杂的模型下，数据变得多么更合理。这个比值可以转化为一个检验统计量，在简单模型为真的原假设下，该统计量服从一个已知的 $\chi^2$ 分布。这使我们能够做出一个有原则的决定。例如，生态学家可以利用此方法检验两个区域的[物种更替](@entry_id:185522)率（$\beta$多样性）是否不同，通过比较一个强制两区域相同的模型与一个允许它们不同的模型 [@problem_id:2470389]。

其次，似然框架包含了自我批判的种子。任何模型都建立在假设之上——例如，一种环境毒素的效应随其浓度线性增加。但如果效应是U形的呢？一个好的统计框架应该给我们提供检查假设的工具。似然正是这样做的。*[得分函数](@entry_id:164520)*，即[对数似然](@entry_id:273783)的导数，可用于构建强大的**[模型诊断](@entry_id:136895)**。这些检验可以检测到模型假设的细微偏差，例如协变量的函数形式不正确，从而使我们能够构建更好、更准确的模型。在流行病学领域分析来自巢式病例对照研究的[匹配数](@entry_id:274175)据时，这是一种至关重要的实践 [@problem_id:4614258]。

最后，也许是最深刻的，基于似然的模型是追求从纯粹关联走向**因果推断**的不可或缺的引擎。一个估计给定处理 $T$ 和协变量 $X$ 下结果 $Y$ 的概率（即 $p(Y|X,T)$）的模型，其本身纯粹是关联性的。它不能也无法告诉我们 $T$ *导致*了 $Y$ [@problem_id:5226615]。然而，在一个建立在因果假设（如条件[可交换性](@entry_id:263314)和正定性）之上的更大逻辑框架内，这类模型成为至关重要的工具。在现代流行病学和医学数据科学中，似然模型被用来估计**[倾向得分](@entry_id:635864)**——即给定患者特征下接受治疗的概率。然后，这些得分被用于诸如逆概率加权等方法，以创建一个已消除混杂的伪人群，从而可以从观测数据中估计因果效应，就像边际结构模型所做的那样 [@problem_id:4581116]。在直接建立在似然之上的贝叶斯范式中，[先验分布](@entry_id:141376)可用于正式编码因果知识——例如，通过强制将一个已知是治疗后碰撞因子的变量系数设为零，从而以有原则的方式将其从模型中排除 [@problem_id:5226615]。

### 当完整故事过于复杂时

当数据中的依赖网络如此错综复杂，以至于写下完整、正确的[似然函数](@entry_id:141927)在计算上不可能或理论上难以处理时，该怎么办？这是高维空间数据或遗传数据面临的常见挑战。此时，似然原理一个卓越而务实的扩展向我们伸出了援手：**复合似然**。

其思想是通过将数据中更小、重叠且更易于处理的部分的似然相乘，来构建一个伪[似然函数](@entry_id:141927)。例如，我们可能不使用一个受试者身上所有1000个测量值的[联合似然](@entry_id:750952)，而是将所有可能的测量对的二元似然相乘。这个乘积不是一个真正的似然，因为这些配对不是独立的。然而，最大化这个复合似然仍然可以得到一致的估计量。与完整（但不可用）的[最大似然估计量](@entry_id:163998)相比，我们损失了一些[统计效率](@entry_id:164796)，但获得了可处理性。复合似然为广义估计方程（GEE）等方法提供了一个稳健的替代方案，当人们希望“自动”处理MAR数据（这是似然方法的特点），但又不想承担指定完整、复杂[联合分布](@entry_id:263960)的负担时，它可能更受欢迎 [@problem_id:4810159]。

### 统一的视角

我们的旅程即将结束。我们从似然作为一个简单的参数估计工具开始。我们见证了它发展成为一种建模哲学。我们目睹了它驾驭了在我们身体内、跨越景观、贯穿浩瀚进化时间中发现的复杂依赖关系。我们看到了它从不完整数据中提供有效推断的近乎神奇的能力。我们看到它作为检验假说、诊断我们自己模型的严谨框架，以及作为探索因果理解的关键组成部分。从病床边到[生物圈](@entry_id:183762)，似然原理为从数据中学习提供了一种统一、强大且极富美感的语言。它让我们能够讲述关于世界日益真实和细致入微的故事，并知道应该在多大程度上相信它们。