## 引言
我们的基因组由两套拷贝组成——一套遗传自父亲，一套遗传自母亲。这两套拷贝几乎完全相同，但包含一些被称为遗传变异的微小差异。虽然标准的测序技术可以识别这些变异，但它通常只是将它们呈现为一个简单的、无序的列表，未能指明哪个变异属于哪条亲本染色体。等位基因定相解决了这一根本性挑战，它是一个重建两套独立的亲本基因组（即单倍型）的过程。解决这种模糊性不仅仅是一个技术细节，它对于理解遗传功能和疾病至关重要。例如，了解两个与疾病相关的变异是位于同一条染色体上还是位于相对的染色体上，其结果可能是一个人完全健康与被诊断出严重疾病之间的天壤之别。

本文将对这一关键过程进行全面概述。在第一部分**原理与机制**中，我们将探讨定相的核心概念，并详细介绍为实现定相而开发的各种巧妙方法，从基于家系分析的黄金标准，到长读长测序的技术威力，再到基于群体推断的统计优雅。随后，在**应用与跨学科联系**部分，我们将深入探讨那些正被这一知识改变的各个领域，展示定相如何在[临床遗传学](@entry_id:260917)、药物基因组学、癌症研究乃至[微生物生态系统](@entry_id:169904)研究中提供关键见解。

## 原理与机制

想象一下，你的基因组是一部庞大的、分为两卷的生命百科全书——一卷遗传自你的母亲，另一卷遗传自你的父亲。这两卷几乎一模一样，但又不完全相同。书中散布着微小的差异，有些是被称为**单[核苷](@entry_id:195320)酸变异（SNVs）**的单字母“拼写错误”，有些是被称为**结构变异（SVs）**的较大段落重排。几十年来，我们的主要测序技术在一件事上表现出色：生成你百科全书中所有“拼写错误”的完整列表。但它们给你的这个列表是杂乱无章的，没有告诉你哪个错误属于哪一卷。你是遗传了第一卷同一页上的两个错误，而第二卷完好无损？还是第一卷有一个错误，第二卷有另一个错误？

这就是**等位基因定相**的核心难题。定相是一门将每个变异分配到其来源染色体的艺术与科学——重建你母本和父本基因组中书写的独特故事。其结果是两条截然不同、有序的等位[基因序列](@entry_id:191077)，称为**单倍型**。没有定相，我们得到的是一个未定相的**基因型**，一份简单的变异清单。在遗传学文件的语言中，一个未定相的杂合变异通常表示为 $0/1$ ，这意味着我们知道存在一个参考等位基因（$0$）和一个备选等位基因（$1$），但它们的亲本归属是未知的。定相解决了这种模糊性，将 $0/1$ 转换为像 $0|1$ 这样的已定相基因型，它明确告诉我们参考等位基因在第一条单倍型上，而备选等位基因在第二条上 [@problem_id:4554246]。

但这为什么重要？对于许多常染色体隐性遗传病来说，这决定了一切。这类疾病仅在某个基因的*两个*拷贝都无功能时才会发生。如果一个基因中的两个不同的致病变异位于同一条染色体上——一种称为**顺式（cis）**的构型——那么另一条染色体仍然携带一个功能完备的基因拷贝，这个人通常是健康的携带者。然而，如果这两个变异位于相对的染色体上——即**反式（trans）**构型——那么这个基因的两个拷贝都无法正常工作。这种状态被称为**复合杂合性**，它会导致疾病 [@problem_id:4356741]。知道定相信息，就意味着健康无虞与毁灭性诊断之间的区别；它甚至可以指导革命性的治疗策略，如等位基因特异性[基因编辑](@entry_id:147682) [@problem_id:5041252]。那么，我们如何分别阅读这两卷生命之书呢？遗传学家设计了两大策略：一种是直接读取分子，另一种是通过倾听群体的声音来破译故事。

### 物理定相：直接读取分子

解决定相难题最直接的方法是找到将变异连接在同一条染色体上的直接物理证据。这可以通过生物学或技术手段实现。

#### 黄金标准：利用家系进行定相

最可靠的定相形式来自对父母的研究。这被称为**基于家系三重体（trio）的定相**。根据孟德尔遗传定律，你从每位亲本那里恰好接收一条单倍型。假设一个先证者（被研究的人）有两个变异 V1 和 V2。如果我们发现他/她的母亲携带 V1 但不携带 V2，而他/她的父亲携带 V2 但不携带 V1，那么问题就解决了。该先证者必定是从母亲那里遗传了一条带有 V1 的染色体，并从父亲那里遗传了一条带有 V2 的染色体。这些变异明确处于反式构型 [@problem_id:5041252]。

这种方法是黄金标准，因为它是确定性的，并且同时解决了一个相关但不同的问题：**亲本来源分配**。它不仅告诉我们哪些等位基因在一起，还告诉我们该单倍型是来自母亲还是父亲 [@problem_id:5091061]。

#### 技术飞跃：基于测序读段的定相

如果无法获得父母的 DNA 怎么办？我们可以尝试直接读取个体的 DNA。挑战在于，标准的“短读长”测序技术会将基因组切成几百个碱基对的微小片段。如果两个变异相隔数千个碱基对，没有任何单个读段（read）足够长到能同时“看到”它们俩，这使得它们之间的联系成为一个谜 [@problem_id:4328173]。

这时，技术创新提供了一个惊人的解决方案。**[长读长测序](@entry_id:268696)**技术可以产生长达数万个碱基对的单个连续读段。如果两个变异相距（比如说）$12,000$ 个碱基对，一个 $20,000$ 个碱基对的长读段可以轻易地跨越整个距离，在同一个物理 DNA 分子上捕获这两个变异。这为它们的定相提供了直接、明确的证据。在有足够[测序深度](@entry_id:178191)的情况下，即使对于相距很远的变异，我们也可以对定相结果充满信心 [@problem_id:4328173] [@problem_id:5016478]。

即使使用短读长技术，巧妙的技巧也是可行的。**关联读长（Linked-reads）**技术在测序前为来自单个长 DNA 分子的所有片段添加独特的条形码。通过按条形码对短读段进行分组，我们可以在广阔的基因组距离上重建定相信息。在某些情况下，即使是标准的[双末端测序](@entry_id:272784)读段也能跨越较短的间隙。如果两个变异的间隔距离恰到好处——远到无法位于一个读段上，但又近到可以落在同一个 DNA 片段的两端——我们就可以对它们进行定相。这对于确定*新发*突变（de novo mutation，即在父母中均未发现的新突变）的亲本来源尤其强大，方法是将其与一个附近已知亲本来源的信息性 SNP 联系起来 [@problem_id:4393831]。

### 统计定相：从群体中学习

当家系数据和长读长测序不可用时，遗传学家可以转向一种更微妙、更精妙复杂的方法：**统计定相**。这种方法依赖于群体的一个深层属性，称为**[连锁不平衡](@entry_id:146203)（LD）**。

想象一下，单倍型不是随机的字母串，而是一种语言中的单词和短语。经过数千代，突变创造了新的变异，而重组则将它们打乱。然而，重组更可能发生在距离较远的变异之间，而不是距离较近的变异之间。结果，物理上相近的等位基因倾向于作为一个区块被共同遗传，形成常见的“短语”或单倍型片段。连锁不平衡就是这种非随机关联的度量。对于两个等位基因 $A$ 和 $B$，它是它们的单倍型频率 $p_{AB}$ 与它们独立时预期频率 $p_A p_B$ 之间的偏差。度量 $D = p_{AB} - p_A p_B$ 捕捉了这种协方差，其平方[相关系数](@entry_id:147037) $r^2$ 将其归一化到 $0$ 和 $1$ 之间，表示关联的强度 [@problem_id:5016478]。

统计定相算法利用 LD，使用一个**参考面板**——一个包含来自大型群体的数千个预定相单倍型的庞大文库。然后，算法查看个体的未定相基因型，并提出问题：“这个文库中的哪一对单倍型最有可能产生我所看到的基因型？” 这通常通过使用**[隐马尔可夫模型](@entry_id:141989)（HMM）**来完成，该模型优雅地将个体的两条单倍型建模为从参考面板单倍型中复制的不同片段的**镶嵌体** [@problem_id:4352579]。模型可以从复制一个参考单倍型“跳转”到另一个，模拟历史重组事件的影响。

这种方法非常强大，使我们能够以高准确度对整个基因组进行定相。然而，其强大功能也伴随着关键的局限性 [@problem_id:5042980]：

1.  **祖源依赖性：** 当个体的遗传祖源与参考面板的祖源匹配时，该方法效果最佳，因为不同群体拥有不同的常见单倍型“词汇表”。
2.  **概率性：** 结果是统计推断，而非直接观察。可能会发生错误，称为**转换错误**，即定相被错误地翻转，尤其是在 LD 较低的基因组区域（[重组热点](@entry_id:163601)）或参考面板稀疏的区域。
3.  **阿喀琉斯之踵：稀有变异：** 统计定相对于非常稀有或私有（新发）的变异无效。如果一个变异不存在于参考面板中，就没有 LD 信息可以利用。算法只能对其定相进行近乎随机的猜测。这恰恰解释了为什么使用长读长进行物理定相对于稀有病诊断是一个颠覆性的改变，因为在这些疾病中，致病变异通常是单个家庭所特有的 [@problem_id:4328173]。

### 超越单字母：定相的前沿

定相的原理不仅限于简单的单字母变异。我们的基因组还包含大规模的**[结构变异](@entry_id:173359)（SVs）**，如缺失、插入以及基因拷贝数的变化，即**[拷贝数变异](@entry_id:176528)（CNVs）**。对这些复杂变异进行定相是一个主要的前沿领域。一个多等位基因 CNV，其中一个基因可以以 $0, 1, 2, 3$ 或更多拷贝存在，打破了标准定相算法的简单二元框架。现在的“基因型”是一个总拷贝数，它可能来自多种不同的定相构型（例如，总共 3 个拷贝可能是在母本染色体上有 1 个，在父本染色体上有 2 个，或者反之）。这需要全新的模型，超越简单的等位基因，并整合来自测序[读段深度](@entry_id:178601)的信息，为下一代基因组分析创造了一个引人入胜的挑战 [@problem_id:4569465]。

从家系遗传的清晰逻辑到群体遗传学的统计交响乐，等位基因定相为我们提供了对个人遗传蓝图更深、更完整的视角。它将一份简单的变异列表转变为一个关于两条染色体的故事，揭示了我们[双亲遗传](@entry_id:273869)遗产之间错综复杂的相互作用，最终塑造了我们的生物学特性。

