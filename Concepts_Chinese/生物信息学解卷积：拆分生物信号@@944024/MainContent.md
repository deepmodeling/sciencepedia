## 引言
在高通量测序时代，我们能够从生物组织中生成海量的分子数据。然而，一个根本性的挑战依然存在：组织样本很少是均一的实体。相反，它是一个由多种细胞类型组成的复杂生态系统，每种细胞都有其独特的分子图谱。当我们分析这样的样本时，得到的“批量”数据只提供了一个平均信号，掩盖了其中细胞的个体贡献。这造成了关键的知识鸿沟，使得理解健康、疾病和发育过程中的细胞动态变得困难。

生物信息学解卷积为这一问题提供了强大的计算解决方案。它提供了一个数学框架，以数字方式剖析这些混合信号，估计潜在组分的比例乃至其特征。本文旨在为这项关键技术提供一份指南。在第一章 **原理与机制** 中，我们将深入探讨使解卷积成为可能的核心数学思想，从简单的[线性混合模型](@entry_id:139702)到[独立成分分析](@entry_id:261857)的精妙逻辑。接着，我们将在第二章 **应用与跨学科联系** 中探索其在现实世界中的影响，展示解卷积如何被用于绘制组织图谱、纠正统计假象，以及理解癌症和感染的异质性。

## 原理与机制

想象你有一杯成分复杂的水果冰沙。通过品尝，你能尝出它的甜味和一丝绿色蔬菜的味道，但你能确定它的确切配方吗？你能否自信地说出它是由50%的香蕉、30%的草莓和20%的菠菜混合而成？这本质上就是 **生物信息学解卷积** 所面临的挑战。一份生物组织样本，如肿瘤活检，是许多不同细胞类型的混合物：癌细胞、各种免疫细胞、[结缔组织](@entry_id:143158)细胞等等。当我们使用现代测序技术分析这个组织时，我们得到的是一个“整体”信号——所有细胞中所有基因或蛋白质的平均测量值。解卷积就是一门艺术和科学，它接收这个混杂的整体信号，并通过计算将其拆分，以找出原始的“配方”——其中存在哪些细胞类型，以及它们的比例是多少。

这一挑战的核心是一个异常简洁而强大的思想：线性混合原理。

### 基本配方：线性混合

让我们思考一下测序机实际上在做什么。它在计数分子——在[转录组学](@entry_id:139549)中是RNA链，在基因组学中是DNA片段。如果我们的组织样本是癌细胞和[T细胞](@entry_id:138090)的混合物，那么对于一个特定基因（我们称之为 *基因X*）的RNA分子总数，就等于来自癌细胞的 *基因X* 分子数加上来自[T细胞](@entry_id:138090)的分子数。这个系统在很大程度上是 **可加的**。

这种可加性是解卷积的基石。我们可以用一个出人意料地优雅的方程来将其形式化，即 **[线性混合模型](@entry_id:139702)** [@problem_id:4321250]。假设我们测量了批量组织样本中数千个基因的表达水平。我们可以将其表示为一个向量 $y$。这个向量就是我们观测到的冰沙风味。我们可以将这个向量建模为各个纯细胞类型的特征表达图谱——即“特征”——的加权总和。

如果我们有一个 **特征矩阵**，我们称之为 $S$，其中每一列代表一种纯细胞类型的表达图谱（例如，“纯香蕉”风味），以及一个比例向量 $p$，它告诉我们混合物中每种细胞类型的分数（即配方），那么模型就是：

$y = Sp + e$

在这里，乘积 $Sp$ 根据特征及其比例，通过数学计算得出混合图谱。末尾的小向量 $e$ 代表误差或残差——所有那些让模型不完全精确的测量噪声和生物变异。这个方程是大多数解卷积方法的基本假设。它假定整体是其各部分之和。这就是为什么，例如，在解卷积前对表达数据简单地取对数可能是一个错误；一个和的对数不等于对数的和，这样做会破坏这个基本的可加性假设 [@problem__id:4321250]。

### 遵循食谱：基于参考的解卷积

线性模型 $y = Sp + e$ 给我们带来了一个逆问题。我们已经测量了 $y$，并且想要找出 $p$。但是 $S$ 呢？在最常见的方法中，即 **基于参考的解卷积**，我们假设我们有一个“食谱”——特征矩阵 $S$ 是预先已知的 [@problem_id:4373728]。

这个食谱从何而来？它通常是根据参考数据集构建的，在这些数据集中，纯细胞类型已经被分离并单独分析，例如使用[荧光激活细胞分选](@entry_id:193005)，或者最近通过汇总单细胞RNA测序实验的数据。有了 $y$ 和 $S$ 在手，寻找比例向量 $p$ 就变成了一个回归问题。我们寻找能使 $Sp$ 尽可能接近我们观测数据 $y$ 的向量 $p$。

当然，这里存在物理规则。细胞类型的比例不能是负数，并且它们必须总和为100%（或1）。因此，我们不能只用简单的最小二乘法；我们需要使用 **约束回归** 方法，如 **[非负最小二乘法](@entry_id:170401) (NNLS)**，它能在遵循这些物理现实的同时找到最佳拟合解 [@problem_id:2805471] [@problem_id:4373728]。一些方法甚至更进一步，对那些测量结果更可靠（即方差较低）的基因给予更大的权重，这种技术被称为[加权最小二乘法 (WLS)](@entry_id:170850)，以获得更稳健的估计 [@problem_id:2805471]。

### 一个微妙的区别：细胞丰度 vs. 纯度

“比例”这个概念似乎很简单，但在生物学中，细节至关重要。让我们看看[癌症基因组学](@entry_id:143632)。当我们对来自肿瘤的DNA进行测序时，我们的“混合物”同时包含肿瘤细胞和正常细胞。癌细胞所占的比例被称为 **细胞丰度** (cellularity)。然而，癌细胞通常是 **非整倍体**，意味着它们的[染色体数目异常](@entry_id:261469)。一个癌细胞可能拥有3套或4套基因组，而一个正常细胞则正好有2套。

当我们测序DNA时，我们采样的是DNA分子，而不是细胞。一个拥有4套基因组的癌细胞对DNA池的贡献将是一个正常细胞的两倍。因此，直接决定我们混合信号的量是来自肿瘤的 *DNA* 的比例，这个概念被称为 **肿瘤纯度** (tumor purity) [@problem_id:4549087]。细胞丰度 ($p$) 和纯度 ($\phi$) 是相关的，但并不相同。它们之间的关系取决于肿瘤细胞（**肿瘤倍性** $C_T$）和正常细胞（$C_N=2$）中的平均染色体组数。纯度由DNA含量的比例给出：

$\phi = \frac{p C_T}{p C_T + (1-p) C_N}$

这个区别至关重要。观测到的癌症突[变频](@entry_id:196535)率，即变异等位基因频率 (VAF)，直接取决于肿瘤纯度 $\phi$，而不仅仅是细胞丰度。这表明，对底层生物学的深刻理解对于正确应用简单的数学[混合模型](@entry_id:266571)至关重要。

### 成分相似的问题：多重共线性

当参考特征具有显著差异时，基于参考的解卷积效果很好。但如果我们的食谱中有两种细胞类型非常相似，会发生什么？想象一下，试[图解卷积](@entry_id:266185)一杯由两种非常相似的覆盆子品种制成的冰沙。几乎不可能分辨出每种用了多少。

在解卷积中，这就是 **多重共线性** 问题 [@problem_id:4321254]。当两种或多种细胞类型的[特征图](@entry_id:637719)谱高度相关时，就会发生这种情况。例如，静息[T细胞](@entry_id:138090)和活化[T细胞](@entry_id:138090)就可能出现这种情况，它们的基因表达模式在很大程度上是重叠的。在数学上，这意味着特征矩阵 $S$ 的列向量几乎是[线性相关](@entry_id:185830)的。

其后果是精度的灾难性损失。在求解回归问题中起核心作用的矩阵 $S^{\top}S$ 会变得“病态”或近乎奇异。这体现在它的一个或多个特征值非常接近于零。我们估计的比例的方差——衡量其不确定性——与这些特征值成反比。如果一个特征值 $\lambda_i$ 非常小，那么相应方向上的方差就会以 $\sigma^2/\lambda_i$ 的形式急剧增大。这意味着我们的比例估计变得极不稳定和不可靠。[多重共线性](@entry_id:141597)告诉我们，根据我们现有的数据，我们根本无法自信地区分那些相似的细胞类型。

### 无食谱的解卷积：无监督挑战

对参考“食谱”的依赖是一个主要限制。如果我们正在研究一个包含未知细胞类型的组织，而这些细胞类型没有现成的参考，该怎么办？或者，如果我们组织中的细胞状态（例如，在疾病中）与参考中的健康细胞状态不同，又该怎么办？

这就引出了 **无监督解卷积**，一个更困难但更强大的想法。在这里，我们不知道特征矩阵 $S$。我们只有批量样本矩阵 $X$。目标是通过分解数据矩阵来发现特征（$A$）及其在每个样本中的丰度（$S$）：$X \approx AS$ [@problem_id:5062767]。这就像试图仅通过品尝许多不同的冰沙来推断出纯水果的风味和配方。

### ICA的魔力：通过非高斯性寻找结构

我们怎么可能从一个已知量 $X$ 中解出两个未知量 $A$ 和 $S$ 呢？**[独立成分分析](@entry_id:261857) (ICA)** 是解决这个问题最卓越的技术之一。ICA通过一个强大的假设来解决这个看似不可能的问题：底层的源信号是 **统计独立的** [@problem_id:4572752]。

ICA背后的逻辑是信号处理中最优美的思想之一。它建立在著名的 **[中心极限定理](@entry_id:143108) (CLT)** 之上 [@problem_id:4572793]。CLT告诉我们，当你将一堆独立的随机信号混合在一起时，它们的总和将比原始信号更趋向于“高斯”（钟形曲线）分布。我们观察到的批量样本正是如此——是底层生物源的混合物。因此，观察到的信号比源信号“更具高斯性”。

ICA巧妙地颠覆了这一逻辑。为了拆分信号，它寻找一种能使恢复出的成分尽可能 **非高斯** 的变换。通过最大化非高斯性，它能够恢复出原始的、独立的源信号！

### 附加条款：当假设至关重要时

ICA的这种“魔力”只有在某些规则被严格遵守时才有效。首先，源信号必须确实是统计独立的。这个假设在生物学中可能很脆弱。例如，全身性免疫反应可能导致多个细胞类型发生协同变化，使它们的信号变得相互依赖 [@problem_id:4572744]。同样，一个样本中细胞比例必须总和为1这一事实，也在它们之间引入了数学上的依赖性 [@problem_id:4572744]。当这些假设被违反时，ICA的性能可能会下降。

其次，为了使ICA正常工作，最多只能有一个源信号是高斯分布的。正是非高斯性提供了分离源信号所需的信息 [@problem_id:4572793]。最后，混合过程本身不能丢失信息。在数学上，这意味着混合矩阵必须具有 **[满列秩](@entry_id:749628)** [@problem_id:4572810]。如果不是这样（例如，如果两种不同的细胞类型具有完全[共线性](@entry_id:270224)的特征），那么不同的源组合可能会产生完全相同的观测信号，使得问题从根本上无法解决。

最终，解卷积不仅仅是一套算法，它更是一种思维框架。它迫使我们正视生物组织的复合性质，并提供了一个数学透镜来窥探混合物的内部，揭示隐藏在简单批量测量表面之下的美丽而复杂的细胞生态系统。

