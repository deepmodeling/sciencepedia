## 引言
许多来自金融、经济甚至自然科学领域的时间序列似乎都在[随机游走](@article_id:303058)，没有可预测的路径。这些非[平稳序列](@article_id:304987)给分析带来了重大挑战，因为比较它们可能导致误导性的“伪”相关，即在没有真实关系的地方发现了关系。但是，如果这些游走的路径中有一些被一种[长期均衡](@article_id:299491)关系秘密地束缚在一起呢？我们如何区分一种有意义的、稳定的联系和一种纯粹的统计幻觉？

这就是[协整](@article_id:300727)概念和被称为[约翰森检验](@article_id:305314)的强大统计程序所要解决的核心问题。[协整](@article_id:300727)提供了一个优雅的框架，用于在看似混乱的数据中发现隐藏的、稳定的长期关系，在随机的海洋中提供了一座可预测的岛屿。本文将分两个关键部分探讨[约翰森检验](@article_id:305314)。首先，在“原理与机制”部分，我们将揭示[协整](@article_id:300727)的核心思想，探索描述向均衡“[拉回](@article_id:321220)”的向量[误差修正模型](@article_id:303367)，并理解[约翰森检验](@article_id:305314)如何利用线性代数找到这些隐藏的联系。随后，在“应用与跨学科联系”部分，我们将看到这些原理的实际应用，考察该检验如何用于验证经济理论和研究自然生态系统的稳定性。读完本文，您不仅会理解[约翰森检验](@article_id:305314)的“如何做”，更会理解其“为何如此”，并欣赏它作为揭示我们周围动态世界结构的基本工具所扮演的角色。

## 原理与机制

想象一下，看着两个醉酒的水手在码头上蹒跚而行。他们每个人都沿着一条随机、不可预测的路径踉跄前进。如果你只观察其中一个，他在未来任何时刻的位置似乎都几乎无法猜测。他的路径就是我们可能称之为“[随机游走](@article_id:303058)”的东西。用计量经济学的语言来说，这样的序列是**一阶单整**的，或记为 $I(1)$。它没有回归到平均值的趋势；它在游走。现在，如果这两个水手之间牵着一根绳索呢？这根绳索的长度是固定的。虽然每个水手仍然在随机地踉跄，但他们不能无限地远离对方。如果一个向左猛冲，绳索就会把另一个也拉过去。他们之间存在一种由绳索长度决定的“[长期均衡](@article_id:299491)关系”。他们之间的距离是稳定的——或者说是**平稳**的（$I(0)$）——尽管他们各自的位置并不平稳。

这在本质上就是**[协整](@article_id:300727)**这个优美的思想。它不是单个水手的属性，而是由绳索连接的水手*系统*的属性。它描述了两个或更多[非平稳时间序列](@article_id:344840)被一个稳定的长期关系联系在一起的情况。尽管单个序列可能会永远自由地游走，但它们的某个特定[线性组合](@article_id:315155)却不会。这是一个深刻的概念，因为许多经济理论都与均衡关系有关：收入与消费之间、不同市场价格之间，或者汇率与利率之间。[协整](@article_id:300727)给了我们一个工具，在一个充满混乱、游走的数据世界中找到这些经验上的“绳索”。说一组变量是[协整](@article_id:300727)的，就等于在随机的海洋中找到了一个稳定的岛屿。正如我们的一个基础练习所强调的，[协整](@article_id:300727)的定义——存在一个向量 $\boldsymbol{\beta}$ 使得组合 $\boldsymbol{\beta}' Y_t$ 变得平稳——本身就涉及系统的联合行为，使其不可能归因于任何单个序列 [@problem_id:2380058]。

### “[拉回](@article_id:321220)”机制：向量[误差修正模型](@article_id:303367)

那么，我们如何用数学方式描述绳索的这种“[拉回](@article_id:321220)”作用呢？这就引出了**向量[误差修正模型](@article_id:303367)**（Vector Error Correction Model, VECM）。VECM 是一种审视 $I(1)$ 变量系统的方法，它明确地包含了它们的长期[协整](@article_id:300727)关系。

假设我们有一个变量向量 $Y_t$。一种标准的建模方式可能是[向量自回归](@article_id:303654)（VAR），即用过去的变动来解释 $Y_t$ 的变动。但如果这些变量是[协整](@article_id:300727)的，这种模型就忽略了故事最有趣的部分！VECM 通过引入一个**误差修正项**来重构模型。其最简单的形式大致如下：

$$
\Delta Y_t = \boldsymbol{\Pi} Y_{t-1} + \text{(短期动态)} + \boldsymbol{\varepsilon}_t
$$

在这里，$\Delta Y_t$ 是我们的变量相对于上一期的变化。魔力在于矩阵 $\boldsymbol{\Pi}$。这个矩阵包含了所有关于长期关系的信息。如果变量是[协整](@article_id:300727)的，我们可以将这个矩阵分解为 $\boldsymbol{\Pi} = \boldsymbol{\alpha}\boldsymbol{\beta}'$。

$\boldsymbol{\beta}' Y_{t-1}$ 这一项代表了[协整](@article_id:300727)关系——那些“绳索”。在上一期，如果 $\boldsymbol{\beta}' Y_{t-1}$ 不为零，就意味着水手们没有处于彼此相对的均衡位置；绳索是拉紧的。这种偏离均衡的状态就是“误差”。矩阵 $\boldsymbol{\alpha}$ 包含了**[调整系数](@article_id:328317)**。它描述了每个变量对这个“误差”的反应强度。它就是“[拉回](@article_id:321220)”的力量。因此，$\boldsymbol{\alpha}(\boldsymbol{\beta}' Y_{t-1})$ 告诉我们系统在当前这一期如何调整，以修正上一期的不均衡状态。

独立的绳索数量，即[协整](@article_id:300727)关系的数量，是矩阵 $\boldsymbol{\Pi}$ 的**秩**（rank），用 $r$ 表示。如果秩为零，就没有绳索；变量之间没有[协整](@article_id:300727)关系，各自独立游走。如果秩为一，就有一条绳索。如果秩为 $K$（变量的数量），则意味着所有原始变量本身就是平稳的，我们从一开始就不需要这个框架！因此，核心挑战就在于确定这个秩 $r$。

### 寻找“绳索”：[约翰森检验](@article_id:305314)的核心

这正是 Søren Johansen 的杰出程序发挥作用的地方。[约翰森检验](@article_id:305314)是一种确定[协整](@article_id:300727)秩 $r$ 的方法。其背后的直觉是寻找那些最“稳定”或最可预测的变量线性组合。

该方法基本上涉及两组回归。首先，我们尝试仅使用短期动态（滞后的变化量）来预测当前的变化量 $\Delta Y_t$。剩下的部分——[残差](@article_id:348682)——就是 $\Delta Y_t$ 中无法被短期波动解释的部分。其次，我们对滞后的水平量 $Y_{t-1}$ 做同样的操作。我们也清除掉它们的短期动态。

现在我们得到了两组“净化”后的变量：当前变化量的未解释部分，以及上一期水平量的未解释部分。然后，[约翰森检验](@article_id:305314)提出了一个关键问题：净化后的水平量的何种[线性组合](@article_id:315155)，与净化后的变化量的某个线性组合的相关性最强？这个概念被称为**典型相关分析**。

在这里找到[强相关](@article_id:303632)性将是非同寻常的。这意味着我们变量水平量的某个特定组合，对于它们将如何变化具有很强的预测能力，即使在我们已经考虑了所有无关紧要的短期依赖关系之后。这正是误差修正机制的标志！这些关系的强度由一组[特征值](@article_id:315305) $\hat{\lambda}_1 \ge \hat{\lambda}_2 \ge \dots \ge \hat{\lambda}_K$ 来捕捉。每个非零[特征值](@article_id:315305)对应一个有效的[协整](@article_id:300727)关系。

[约翰森检验](@article_id:305314)产生的**迹统计量**就是基于这些[特征值](@article_id:315305)构建的。为了检验不存在[协整](@article_id:300727)关系（$r=0$）的原假设，该统计量的计算公式为：

$$
\lambda_{\text{trace}}(0) = -T \sum_{i=1}^{K} \ln(1 - \hat{\lambda}_i)
$$

这个公式汇总了所有可能关系的“证据”。如果任何一个[特征值](@article_id:315305) $\hat{\lambda}_i$ 很大（接近1），那么 $\ln(1 - \hat{\lambda}_i)$ 这一项将是一个很大的负数，从而使整个统计量变大。然后我们将这个统计量与一个预先计算好的临界值进行比较。如果我们的统计量更大，我们就拒绝无[协整](@article_id:300727)的原假设，并断定至少存在一条“绳索”。然后我们可以继续检验 $r \le 1$、$r \le 2$ 等，直到我们无法拒绝原假设为止。正如一个详细的练习所示，其数学过程涉及从数据中构建特定的[样本矩](@article_id:346969)矩阵，并求解一个[广义特征值问题](@article_id:312028)——这是线性代数在揭示经济结构方面的一个优美应用 [@problem_id:851778] [@problem_id:2407883]。

### 一支舞，多位舞者：为何系统视角至关重要

有人可能会问：为什么要费这么大劲？难道我们不能一次只检验两个变量吗？较早的**[恩格尔-格兰杰检验](@article_id:301109)**（Engle-Granger test）就是这样做的。它将一个 $I(1)$ 变量对另一个进行回归，然后检验该单一回归的[残差](@article_id:348682)是否平稳。这很简单直观，但可能会忽略更大的图景。

想象一个由三个变量 $X_1$、$X_2$ 和 $X_3$ 组成的系统。正如在一个精心构建的模拟中所探讨的 [@problem_id:2380101]，可能没有任何一对变量是[协整](@article_id:300727)的，但像 $X_1 + X_2 - X_3$ 这样的关系却是完全平稳的。这就像观看一个三人舞蹈团。如果你只看舞者1和2，他们的动作可能看起来毫无关联。如果你只看2和3，也是同样的结果。但如果你同时观察所有三个人，你就会意识到他们正在表演一支协调同步的舞蹈。

[恩格尔-格兰杰检验](@article_id:301109)通过只考察一个方程（一次一对），就像只看两位舞者一样。它将无法发现这个[协整](@article_id:300727)关系。而[约翰森检验](@article_id:305314)则是一种**系统方法**。它同时分析所有变量及其所有潜在关系。它能看到整支舞蹈，并能识别出连接所有三个变量的那个单一[协整](@article_id:300727)关系。这有力地证明了系统的统一性，以及为何整体性方法常常是必要的。

### 现实世界的地图绘制：趋势、常数项和其他选择

将这些强大的工具应用于现实世界的数据需要仔细思考，就像制图师决定在地图上包含哪些特征一样。

其中最关键的选择之一是如何处理**确定性趋势**。这些变量是围绕一个固定的常数游走，还是随着时间的推移而向上漂移（如GDP或价格水平）？在模型中包含一个线性时间趋势并不仅仅是一个次要的技术细节；它从根本上改变了我们愿意考虑的均衡的性质，并且至关重要地，它改变了我们检验统计量的统计分布 [@problem_id:2447543]。将确定性趋势误认为是随机趋势（反之亦然）可能导致完全错误的结论。约翰森框架提供了一个包含五种情况的全面菜单来处理常数项和趋势，迫使研究人员明确他们对所建模世界的假设。

最后，值得注意的是，约翰森的序贯[假设检验](@article_id:302996)并非选择[协整](@article_id:300727)秩的唯一方法。另一种植根于模型选择的方法是使用[信息准则](@article_id:640790)，如**[贝叶斯信息准则](@article_id:302856)（BIC）**。在这里，我们不是进行一系列是/否的决策，而是为每个可能的秩（$r=0, 1, 2, ...$）拟合一个VECM，并计算一个BIC得分。BIC奖励那些能很好地拟合数据的模型，但会因其复杂性（参数过多）而对其进行惩罚。“最佳”的秩就是那个导致BIC得分最低的秩 [@problem_id:2410477]。这提供了一个不同的哲学视角，不再将问题视为通过[假设检验](@article_id:302996)寻找一个唯一的“真实”秩，而是从一组候选模型中务实地选择最佳近似模型。

归根结底，[约翰森检验](@article_id:305314)及相关方法提供了一个严谨而优美的框架，用于揭示在经济和[金融时间序列](@article_id:299589)的表面混乱中创造秩序的、隐藏的[长期均衡](@article_id:299491)结构。它们让我们能够找到将我们醉酒的水手们捆绑在一起的无形绳索。