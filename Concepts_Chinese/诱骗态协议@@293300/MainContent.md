## 引言
[量子密钥分发](@article_id:298519)（QKD）为安全通信提供了终极承诺，其安全性由物理学的基本定律保证。然而，在发送单个、不可分割的[光子](@article_id:305617)的理论理想与使用衰减激光器的实际情况之间存在着巨大差距，后者可能在无意中一次发射多个[光子](@article_id:305617)。这种差异造成了一个关键漏洞，使得技术高超的窃听者能够在不留痕迹的情况下截获部分密钥。本文旨在解决这一关键问题，全面概述了[诱骗态协议](@article_id:374305)——一种巧妙而有效的应对策略。在接下来的章节中，我们将首先探讨该协议背后的原理和机制，从它所应对的威胁——[光子](@article_id:305617)数分离攻击——开始，并详细说明它如何利用[统计分析](@article_id:339436)来恢复安全性。随后，我们将研究其应用和跨学科联系，讨论在现实世界的[量子网络](@article_id:304950)中部署该技术所涉及的实际权衡和工程挑战。我们的探索将从催生这一巧妙解决方案的核心问题开始。

## 原理与机制

在此前的探索中，我们已为[量子密钥分发](@article_id:298519)的优雅承诺所折服：一个由物理学法则保障通信机密的世界。但正如我们将优美的理论思想带入混乱的实验室现实时常遇到的情况一样，我们总会碰到一些障碍。最初的[BB84协议](@article_id:299096)所梦想的完美的、[按需单光子源](@article_id:377050)，目前还只是一个梦想。取而代之的是一种实用的主力工具：激光器。而这个简单的替代，却在我们坚固的安全堡垒上打开了一道虽小但影响深远的裂缝。

### “漏水的水龙头”问题

想象一下，你试图通过将水滴一滴一滴地滴入长管来发送秘密消息。理想情况是每个信息比特恰好对应一滴水。但如果你的水龙头有点旧而且漏水呢？有时它滴下一滴水，有时是一小簇两三滴，有时则一滴也没有。这正是我们在QKD中使用激光器时所面临的情形。

标准激光器在衰减到极低功率时，会产生所谓的**弱相干脉冲**。任何给定脉冲中的[光子](@article_id:305617)数都不是一个固定值，而是遵循由**[泊松分布](@article_id:308183)**描述的随机模式：$P(n) = e^{-\mu}\frac{\mu^n}{n!}$，其中 $\mu$ 是每个脉冲的平均[光子](@article_id:305617)数。我们可以将 $\mu$ 设得非常小，比如0.5，以增加发送单[光子](@article_id:305617)的机会。但问题在于：发送两个、三个甚至更多[光子](@article_id:305617)的概率虽然很小，却永远不为零。

你可能会问：“那又怎样？多几个[光子](@article_id:305617)有什么害处？”害处在于，这给了潜在的窃听者（我们称之为Eve）可乘之机。如果一个脉冲只含有一个[光子](@article_id:305617)，Eve就束手无策了。作为[量子力学基](@article_id:367705)石的不可克隆定理禁止她制造出一个完美的副本。如果她测量[光子](@article_id:305617)以获知其状态，她必然会扰动它，而这种扰动会被合法用户Alice和Bob检测到。但如果一个脉冲包含两个或更多相同的[光子](@article_id:305617)，情况就完全不同了。

### Eve的策略：[光子](@article_id:305617)数分离攻击

面对多[光子](@article_id:305617)脉冲，一个聪明的Eve可以执行一种极其简单却破坏性极强的策略，称为**[光子](@article_id:305617)数分离（PNS）攻击**。想象一个包含两个[光子](@article_id:305617)的脉冲，它们都被编码了相同的[量子态](@article_id:306563)，从Alice飞向Bob。Eve可以拦截这个脉冲，将其“分离”，自己保留一个[光子](@article_id:305617)，然后将另一个[光子](@article_id:305617)继续发送给Bob。

Bob收到了一个[光子](@article_id:305617)，在他看来，一切正常。他和Alice随后比较他们的[基矢](@article_id:378298)选择并生成密钥。但对于每一次这样的[光子](@article_id:305617)分离事件，Eve都持有一个[量子比特](@article_id:298377)的完美副本。她可以将她的[光子](@article_id:305617)储存在“[量子存储器](@article_id:305069)”中，等到Alice和Bob公开宣布他们的测量[基矢](@article_id:378298)。然后，她只需在正确的[基矢](@article_id:378298)下测量她的[光子](@article_id:305617)，就能100%准确地获知该密钥比特，且不会引入任何会惊动Alice和Bob的错误。

这不仅仅是理论上的担忧。让我们通过一个思想实验来量化这种危险[@problem_id:473235]。想象一个全能的Eve，她可以测量每个脉冲的[光子](@article_id:305617)数而不扰动它。她的策略是：如果一个脉冲恰好有两个[光子](@article_id:305617)，她就完美地分离它，储存一个，并将另一个发送给Bob。如果[光子](@article_id:305617)数是其他数量，她就直接阻断该脉冲。Eve能知道Bob最终密钥的多大一部分？答案取决于信源的统计特性和[信道](@article_id:330097)的效率，但可怕的结论是，密钥的很大一部分都可能被泄露。例如，如果Alice使用平均[光子](@article_id:305617)数为 $\mu_s$ 的典型光源，Bob端的探测事件中将不可避免地有一部分来自这些被窃取的双[光子](@article_id:305617)态[@problem_id:143377]。Alice发送的多[光子](@article_id:305617)脉冲越多，Eve的机会窗口就越大。

这种攻击之所以阴险，是因为它可以是无形的。Eve只攻击多[光子](@article_id:305617)脉冲，而从Bob的角度看，这些脉冲的行为与单[光子](@article_id:305617)脉冲完全一样。比特错误率可能保持在很低水平，让Alice和Bob误以为他们的[信道](@article_id:330097)是安全的，而Eve却在悄悄地窃取他们“秘密”密钥的副本。我们似乎陷入了僵局。如果我们甚至不知道密钥的哪些部分可能被克隆了，又怎能信任它呢？

### 反制策略：诱骗态大军

解决方案是一个以其人之道还治其人之身的绝佳例子，或者更准确地说，是用已知的[量子统计](@article_id:304246)学来对抗未知的[量子攻击](@article_id:300948)。这就是所谓的**[诱骗态协议](@article_id:374305)**。这个想法非常巧妙而简单。

如果Alice只发送一种强度的脉冲（比如，她的“信号”态强度 μ），她就无法知道Eve是如何处理不同[光子](@article_id:305617)数脉冲的。例如，Eve可以阻断所有单[光子](@article_id:305617)脉冲，只放行她已经分离过的多[光子](@article_id:305617)脉冲。从Alice和Bob的角度看，他们只会观察到一个损耗非常大的[信道](@article_id:330097)；他们不会知道这种损耗是选择性地针对他们最安全的信号！

为了反击，Alice决定变得不可预测。她为自己的“秘密行动”做准备，在她的“士兵”——**信号态**——中随机混入“间谍”——**诱骗态**。这些诱骗态只是用不同（通常更低）的平均[光子](@article_id:305617)数制备的脉冲，比如 ν，为了更周全，还会加入一个强度为0的“真空”态。Alice发送一个由这些随机选择的信号态、诱骗态和真空态脉冲组成的长序列。传输结束后，她和Bob公开宣布哪些脉冲是信号态，哪些是诱骗态，哪些是真空态。

这为什么有效？因为Eve事先不知道传入的脉冲是信号态还是诱骗态。一个平均[光子](@article_id:305617)数为 μ 的脉冲和一个平均[光子](@article_id:305617)数为 ν 的脉冲都包含单[光子](@article_id:305617)、双[光子](@article_id:305617)等成分的混合。Eve的攻击策略，无论是什么，都只取决于脉冲中实际的[光子](@article_id:305617)数，而不是Alice*意图*使用的强度设置。因此，一个双[光子](@article_id:305617)脉冲成功传输到Bob的概率必须是相同的，无论它来自信号态的发射还是诱骗态的发射。这是至关重要的一环。

通过比较Bob在每种强度设置下接收到的统计数据，Alice和Bob可以扮演侦探的角色。

### 估算之术：揭露攻击

让我们更正式一些，因为这才是其真正美妙之处。我们需要两个关键概念：

1.  **增益（$Q_\lambda$）**：这是当Alice发送一个平均[光子](@article_id:305617)数为 $\lambda$ 的脉冲时，Bob获得一次“响应”（即探测）的总概率。这是一个实验量，Alice和Bob可以通过简单地将响应次数除以该强度下发送的脉冲总数来直接测量。

2.  **[产率](@article_id:301843)（$Y_n$）**：这是一个条件概率，指Alice发送的一个 $n$ [光子](@article_id:305617)脉冲导致Bob端产生一次响应的概率。这是我们想要了解的隐藏变量。它包含了关于[信道](@article_id:330097)的一切信息——自然损耗加上Eve的任何干涉。例如，如果Eve阻断了所有单[光子](@article_id:305617)脉冲，那么 $Y_1 = 0$。

这两个量通过光源的[泊松统计](@article_id:344013)联系起来：
$$Q_\lambda = \sum_{n=0}^{\infty} Y_n P(n|\lambda) = \sum_{n=0}^{\infty} Y_n e^{-\lambda} \frac{\lambda^n}{n!}$$

这个单一的方程看起来无法求解；我们有一个方程，却有无限个未知的[产率](@article_id:301843)（$Y_0, Y_1, Y_2, \dots$）。但有了诱骗态，我们就不只有一个方程了。我们有了一个方程组，我们使用的每种强度都对应一个方程！对于我们的信号态（μ）、诱骗态（ν）和真空态（0），我们有：

$$Q_\mu = Y_0 P(0|\mu) + Y_1 P(1|\mu) + Y_2 P(2|\mu) + \dots$$
$$Q_\nu = Y_0 P(0|\nu) + Y_1 P(1|\nu) + Y_2 P(2|\nu) + \dots$$
$$Q_0 = Y_0 P(0|0) + Y_1 P(1|0) + \dots = Y_0$$

最后一个方程是白送的：真空态的增益直接给出了 $Y_0$，它代表了Bob探测器的暗计数加上任何背景噪声。知道了 $Y_0$ 之后，我们剩下两个方程和仍然无限多的未知数。这似乎还是不可能！

但在这里，我们不需要求出*每一个* $Y_n$。最终密钥的安全性主要取决于单[光子](@article_id:305617)脉冲，因为它们对PNS攻击免疫。我们所需要做的就是安全地表征 $n=1$ 分量的行为。具体来说，我们需要找到单[光子](@article_id:305617)[产率](@article_id:301843) $Y_1$ 的一个可靠的**下界**，以及这些单[光子](@article_id:305617)探测的错误率的一个**上界**。

通过一些巧妙的数学方法，并仅利用[产率](@article_id:301843)不能为负（$Y_n \ge 0$）这一物理约束，我们可以结合 $Q_\mu$ 和 $Q_\nu$ 的方程来分离出 $Y_1$。这个过程有效地将所有多[光子](@article_id:305617)项（$n \ge 2$）视为一个单一的无关变量，然后将其消去。该过程仅根据实验测量的增益 $Q_\mu$、$Q_\nu$、$Q_0$ 以及已知的强度 μ 和 ν，得出了单[光子](@article_id:305617)[产率](@article_id:301843)的一个紧凑下界 $Y_1^{\text{lower}}$ [@problem_id:714893] [@problem_id:122785]。利用测量的错误率也可以进行类似的分析，以找到单[光子](@article_id:305617)分量相[位错](@article_id:299027)误率的上界。通过这种统计上的技巧，我们可以估算例如源于双[光子](@article_id:305617)态的探测所占的比例，并观察其是否高得可疑 [@problem_id:715048]。

如果Eve篡改了[信道](@article_id:330097)——例如，通过阻断单[光子](@article_id:305617)来选择性地传递多[光子](@article_id:305617)——她将不可避免地改变产率 $Y_n$。这种改变将表现为观测到的增益 $Q_\mu$ 和 $Q_\nu$ 与诚实[信道](@article_id:330097)预期值之间的不匹配。Alice和Bob的公式会揭示这一点：计算出的 $Y_1$ 下界会下降，或者错误率上界会上升，从而表明存在窃听者。

本质上，[诱骗态方法](@article_id:307595)迫使Eve摊牌。为了获取信息，她必须与多[光子](@article_id:305617)脉冲相互作用。但她的相互作用总会在[产率](@article_id:301843)上留下统计“指纹”，Alice和Bob通过比较信号态和诱骗态的观测增益就能探测到这些指纹。通过牺牲一部分传输来发送这些诱骗态，他们获得了在不可观测的单[光子](@article_id:305617)层面上表征[信道](@article_id:330097)行为的能力，从而恢复了他们通信的安全性。这完美地证明了，在量子世界里，你看不见的东西和你看见的东西同样重要——以及一点点随机性和巧妙的统计学如何能揭穿即使是最老练的间谍。