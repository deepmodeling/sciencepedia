## 应用与跨学科联系

在掌握了像素和体素的基本原理之后，我们现在可以开始一段旅程，看看这些简单的想法将我们带向何方。毫不夸张地说，这种对空间的数字表示方法已经彻底改变了整个科学和工程领域。体素不仅仅是世界的一幅静态图画；它是一个行动的舞台。它是一块画布，我们可以在上面进行测量、检验假设、构建智能，甚至创造物理物质。其应用的故事，是一个从观察到理解，再从理解到创造的故事。

### 看见无形：体素作为洞察生物学与医学的窗口

现代科学，特别是生物学，致力于在三维空间中随时间观察事物的发生。想象一下，试图理解一个发育中胚胎的复杂舞蹈。光片显微镜可以捕捉到这场舞蹈，但数据成本惊人。一个单一的实验可能涉及每秒两次对一个$512 \times 512 \times 200$体素的体积进行成像。每个体素的亮度用16位信息记录。快速计算表明，这会产生每秒超过$1.6$吉比特的数据洪流，这条数据“消防水管”必须由相机管理，传输到计算机，并写入存储，不能丢失任何一个比特 [@problem_id:2648241]。这就是现代成像的原始现实：抽象的体素网格转化为工程和数据科学中巨大的实际挑战。我们看见无形之物的能力不仅受限于我们的光学系统，也受限于我们处理描述它的海量数字的能力。

但是这些数字——这些体素值——到底意味着什么？在医学成像中，它们不仅仅是任意的亮度级别；它们是物理属性的测量值。在[计算机断层扫描](@entry_id:747638)（CT）中，每个体素的值以亨斯菲尔德单位（Hounsfield Units）计量，对应于材料衰减X射线的能力。这是一个至关重要的见解。它告诉我们，从几何意义上说，并非所有的体素都是生而平等的。临床扫描仪通常采集具有高平面内分辨率（例如，$0.7 \times 0.7$毫米）但切片较厚（可能为$2.0$毫米）的图像。由此产生的体素不是完美的立方体，而是被拉伸的“砖块”。对于放射科医生来说，这通常没有问题，但对于计算机算法来说，这是一个陷阱。一个在自然图像上预训练的[深度学习](@entry_id:142022)网络，其中像素代表世界的一个方形小块，会被这些各向异性体素完全搞糊涂。为了使数字表示与物理现实相匹配，一个关键的预处理步骤是将整个体积重新采样成一个由各向同性的立方体体素组成的网格。这种几何上的协调确保了$3 \times 3 \times 3$的体素邻域在任何地方都对应于相同的物理体积，从而使算法能够学习到具有物理意义的特征 [@problem_id:4568514]。

通常，单一类型的图像并不能说明全部情况。[CT扫描](@entry_id:747639)擅长显示骨骼等致密结构。磁共振（MR）成像在软组织中提供了极佳的对比度。[正电子发射断层扫描](@entry_id:165099)（PET）揭示了代谢活动，突显了肿瘤侵略性的能量消耗。每种模态都为我们提供了一个配准好的体素网格，每个网格都是现实的一个不同“层面”。图像融合的艺术就是将这些层面结合起来，形成一个单一、更丰富的理解 [@problem_-id:4891112]。这可以在几个抽象层面上完成。在**像素级**，我们可以简单地将彩色编码的PET数据叠加到灰度MR图像上，这是临床上的常见做法。在更复杂的**特征级**，我们可能会从每幅图像中提取边缘图——CT的骨骼边缘、MR的软组织边界和PET的代谢边界——并将它们组合起来，创建一个用于勾画肿瘤的主图。在最高的**决策级**，我们可以训练独立的算法对每种模态进行概率性的“肿瘤”判断，然后使用一个逻辑规则——例如，“如果PET高度活跃且MR显示相应的异常组织，则判定为肿瘤”——来得出一个最终的、更可信的诊断。

从二维像素到三维体素的这一旅程并非没有风险。一个多世纪以来，病理学家一直在显微镜下研究薄薄的二维组织切片——即像素平面。这样一张切片能告诉我们关于三维结构的什么信息呢？Delesse[立体学](@entry_id:201931)原理为某些属性给出了一个极其优雅的答案：在一个随机的二维切片上，某个特征的面积分数是其在三维中[体积分数](@entry_id:756566)的无偏估计量。因此，测量组织学切片上骨骼面积的比例可以很好地估计骨骼的整体孔隙度。然而，这种优雅隐藏着一个陷阱。如果你试图通过计算单个切片上每单位面积的圆形轮廓来计数对象，比如每单位体积的[骨重塑](@entry_id:152341)单位（骨单位），你将被系统性地误导。单个二维切片不提供关于第三维度的任何信息，如果没有像使用两个平行切片的“切割器”（disector）这样的方法，估计对象数量就充满了偏差。从二维像素世界到三维体素世界的转变，正如微型CT等技术所提供的，使我们能够摆脱这些偏差，直接测量组织真实、复杂的三维微观结构 [@problem_id:5088029]。

### 教会机器去看：像素、体素与人工智能

一旦我们用体素对世界有了丰富、定量的描述，我们就可以让计算机为我们解读它。最基本的任务是分割：为每个体素分配一个标签。但这个简单的目标分裂成两个截然不同的问题 [@problem_id:4332648]。在**[语义分割](@entry_id:637957)**中，我们问：“这个体素是什么类型的组织？”我们可能会将每个体素标记为‘肿瘤’、‘健康组织’或‘背景’。在**[实例分割](@entry_id:634371)**中，我们问一个更难的问题：“这个体素属于哪个特定的对象？”想象一张载玻片上有两个相互接触的肿瘤细胞。语义模型会正确地将属于这两个细胞的所有体素标记为‘肿瘤’，将它们合并成一个单一的斑点。但是要计算细胞数量或测量它们的个体属性，我们需要一个[实例分割](@entry_id:634371)模型，它能理解即使它们相互接触，也是两个独立的对象。实现这一点需要远比简单的像素级分类复杂得多的模型。

向三维“思考”的飞跃在计算上是巨大的。考虑一个$128 \times 128 \times 128$体素的医学图像体积。可以用“旧”方法来分析它，即对128个切片中的每一个独立应用一个二维[卷积神经网络](@entry_id:178973)（CNN）。或者，可以使用一个真正的三维CNN，一次性处理整个体积。虽然三维方法功能强大得多，因为它可以学习跨切片的特征，但成本是天文数字。在训练期间，存储三维CNN网络激活所需的内存，在这种情况下，是逐片二维方法的整整$128$倍 [@problem_id:4834593]。这一个数字有力地说明了迫使研究人员在模型性能和计算可行性之间做出艰难权衡的实际限制。

有了如此强大——且昂贵——的模型，我们如何知道它们是否正确？我们需要严谨、客观的度量标准。如果我们的任务是将一个体素体积与另一个对齐（配准），我们可以测量**目标配准误差（TRE）**：对齐后相应解剖标志点之间的距离。至关重要的是，这些标志点必须独立于用于计算对齐的那些标志点，以确保无偏评估 [@problem_id:4313247]。如果我们的任务是分割，我们会比较机器标记为‘肿瘤’的体素集合（$A$）与人类专家标记的集合（$B$）。**戴斯相似系数（DSC）**测量重叠度，定义为$\frac{2|A \cap B|}{|A| + |B|}$，得分从0（无重叠）到1（完美一致）。为了测量边界对齐的好坏，我们可以使用**[豪斯多夫距离](@entry_id:152367)**，它找出两个边界之间的最大差异。由于这个指标对单个离群体素很敏感，所以通常首选更稳健的度量，如**95百分位[豪斯多夫距离](@entry_id:152367)（HD95）** [@problem_id:2351658] [@problem_id:4313247]。这些度量标准是定量验证的基石，使我们能够信任算法的输出。

医学人工智能的最终目标不仅仅是复制人类的任务，而是看到人类无法看到的东西。这就是**放射组学**的领域。我们不仅仅是识别肿瘤，而是可以从其内部的体素中计算数百个“手工制作的特征”，量化其纹理、形状和强度模式。其中一族特征来自**灰度区域大小矩阵（GLSZM）**。在这里，我们识别出所有共享相同强度水平的连通“区域”体素。GLSZM是一个矩阵，它统计了具有特定大小和强度的区域有多少个。由此，我们可以计算出像“大面积强调”这样的特征，如果肿瘤包含大片、连续的均匀强度斑块，该特征会得到高分。这些没有简单视觉关联的抽象特征，可以出人意料地成为预测肿瘤遗传学或其对治疗可能反应的强大指标，将体素网格变成了预测预后的水晶球 [@problem_id:5221629]。

### 从数字比特到物理原子：制造业中的体素

到目前为止，我们一直使用体素来分析世界。但是我们可以用它们来构建世界吗？答案是响亮的“是”，这也是[增材制造](@entry_id:160323)（或称[3D打印](@entry_id:187138)）背后的原理。在像数字光处理（DLP）这样的工艺中，来自[计算机辅助设计](@entry_id:157566)（CAD）程序的连续三维模型首先被转换为体素网格。然后，打印机逐层构建对象，使用投影仪将光图案照射到液态光敏聚合物树脂槽中，将其固化成一个固体层 [@problem_id:4713522]。

这个**体素化**过程是离散化的直接体现，并伴随着一种典型的伪影。连续[CAD](@entry_id:157566)模型中的倾斜或弯曲表面在最终打印的对象中变成了一系列微小的台阶——即臭名昭著的“[阶梯效应](@entry_id:755345)”。每个台阶都直接对应于体素的尺寸。你可能会认为这是数字到模拟转换中不可避免的缺陷。

但在这里，自然与工程学联手，产生了一个绝妙的解决方案。树脂的聚合是一个阈值过程；只有当它接收到一定的最低光能剂量时才会固化。DLP打印机可以逐像素地调节光的强度，创造出“灰度”曝光。对于楼梯边缘的一个体素，打印机不是用全强度的光来固化一整块树脂，而是可以使用强度较低的灰光。这种减少的剂量意味着固化阈值仅在体素体积的*一部分*中被跨越。因此，固体的有效边界可以被移动到一个亚体素的位置！通过仔细调整物体边界处像素的灰度值，可以平滑楼梯台阶的尖角，从而生产出更忠实地再现原始连续设计的最[终对象](@entry_id:151050)。这是一个美丽的例子，说明了理解离散数字网格与光和化学的连续物理世界之间的相互作用，如何让我们克服离散化的固有局限性 [@problem_id:4713522]。

### 普适的网格

我们的旅程带领我们从观察一个活体胚胎的发育，到预测癌症的预后，再到制造定制的外科工具。在这一切之中，小小的像素及其三维表亲——体素，一直是我们不变的伴侣。我们发现的是一个具有非凡和统一力量的概念。这个简单的想法——将空间表示为数字网格——充当了一种通用语言。它是我们最先进的仪器用来描述自然世界的语言，是我们用来教导机器理解那个世界的语言，也是我们用来指示打印机在其中构建新对象的语言。体素不仅仅是一个小立方体；它是连接信息数字领域与现实物理领域的一座根本性的桥梁。