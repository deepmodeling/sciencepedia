## 应用与跨学科联系

在遍历了[主成分分析](@article_id:305819)（PCA）和均匀流形逼近与投影（UMAP）的数学核心之后，我们可能会留有一种抽象的满足感。我们有了一套优雅的工具，但它们是*用来做什么*的？没有钉子的锤子，或者没有观察对象的透镜，又有什么用呢？现在，我们将注意力从“如何做”转向“为什么做”，探索这些不同的数据观察方式如何让我们在整个科学领域提出并常常回答深刻的问题。

我们可以将 PCA 和 UMAP 想象成两种不同的透镜，用于窥探复杂的数据宇宙。PCA 就像一台强大的望远镜，旨在寻找宏大的、组织性的原则——那些在全局尺度上构建一个系统的、笔直的方差之线。相比之下，UMAP 就像一个微距镜头，以令人难以置信的精度聚焦于每个数据点的局部邻域，揭示定义其局部群落的错综复杂、蜿蜒的纹理和关系。科学的艺术和乐趣常常在于知道选择哪种透镜，以及如何解读它们揭示的惊人图像。

### 直线世界：PCA 作为信号解混器

让我们从一个非常直观的应用开始。想象你正在一个拥挤的派对上。两个人正在说话，他们的声音混合在一起。然而，你的大脑有一种非凡的能力，可以专注于一个声音而忽略另一个。它“解混”了听觉信号。以一种惊人相似的方式，PCA 可以用来解混物理科学中的信号。

考虑一下化学计量学领域，科学家使用[光谱学](@article_id:298272)来鉴定物质的化学成分。一个样品可能包含几种纯化学物质的混合物，其测得的光谱将是这些纯组分光谱的[线性组合](@article_id:315155)。如果我们测量许多不同的样品，每个样品中纯化学物质的比例都不同，我们如何在不知道混合比例的情况下恢复原始的纯光谱？

这是 PCA 的完美任务。如果化学物质的比例在不同样品间变化，那么我们数据集中最大的变异来源将直接对应于纯组分本身的光谱。通过对混合光谱集合应用 PCA，我们要求它找到最大方差的轴。由此产生的主成分——特别是定义这些轴的“载荷”向量（loading vectors）——结果是我们要寻找的“纯”信号的非凡近似 [@problem_id:3161294]。PCA 本质上是倾听混合信号的嘈杂声，并分离出独特的“声音”。

当然，这个魔术有其局限性。如果派对上的两个说话者总是完美同步地说话，一起提高或降低音量，我们的大脑将很难区分他们。同样，如果我们样品中两种化学物质的浓度总是完全相关，PCA 会将它们视为单一的变异来源，而无法将它们分开。自然，如果派对太吵——即测量被噪声淹没——信号就会丢失。此外，为了区分 $k$ 个不同的说话者，我们需要至少听 $k$ 个不同的对话片段；从数学上讲，如果我们的样本数 $n$ 少于组分数 $k$，PCA 不可能重建底层的信号，因为数据不包含足够的信息。这些局限性不是 PCA 的失败，而是关于解决问题所需信息的深刻真理。

### 揭示隐藏秩序：PCA 在基因组中的应用

现在，让我们将这个强大的“解混”思想从相对直接的化学信号世界带到生命本身惊人复杂的机制中。在混合物中找到纯光谱的相同原理，可以用来发现我们整个基因组的一个[基本组织](@article_id:297010)原则。

在我们每个细胞的细胞核内，两米长的 DNA被压缩在一个比针尖小一千倍的空间里。这不是一个随机的缠结；这是一个高度组织化的结构，对于调控哪些基因被开启或关闭至关重要。科学家可以使用一种名为 Hi-C 的技术来绘制这种三维结构，该技术生成一个巨大的矩阵，告诉我们基因组的任意两部分物理上紧密接触的频率。这个矩阵是巨大而令人困惑的。我们怎么可能理解它呢？

我们再次求助于 PCA。通过从 Hi-C 数据中计算[相关矩阵](@article_id:326339)并找到其第一主成分（$PC1$），我们不再是解混化学信号，而是“解混”物理相互作用的模式 [@problem_id:2943043]。结果是一个启示。该分析为基因组的每一段产生一个单一的数字，即其在 $PC1$ 上的得分。结果发现，所有得分为正的片段都优先与彼此相互作用，而所有得分为负的片段也是如此。基因组被划分为两个巨大的、自我关联的“区室”（compartments）。

更引人注目的是，这种数学划分直接对应于功能。区室“A”（比如说，正 $PC1$ 得分）充满了活跃、繁忙的基因组区域，开放营业并充满基因表达。区室“B”（负 $PC1$ 得分）则包含沉默、锁定的区域，即广阔的非活性 DNA 领地。通过一个单一、优雅、线性的操作，PCA 将一个极其复杂的物理接触矩阵转变为一个简单的一维基因组活动标尺。这是一个简单工具在生物系统中揭示隐藏的全局秩序的惊人例子。

### 当直线失效时：在生命的[流形](@article_id:313450)中导航

PCA 在发现这些宏大的线性原则方面表现出色。但世界的大部分，尤其是生物世界，并非建立在直线上。它充满了曲折、转弯、分支和循环。当我们寻找的结构更像一条蜿蜒的乡间小路或一棵分枝的树，而不是一条笔直的高速公路时，会发生什么？

这就是 PCA 的全局、基于方差的世界观可能误导我们的地方。让我们考虑一下单[细胞生物学](@article_id:304050)的现代挑战。使用像单细胞 [ATAC-seq](@article_id:349101) 这样的技术，我们可以在数万个单个细胞中测量数万个潜在基因组控制开关的活性。我们的数据变成了一个巨大的矩阵，其中一个细胞是 100,000 维空间中的一个点。该数据的一个关键特征是其极端[稀疏性](@article_id:297245)：对于任何给定的细胞，其超过 99% 的坐标都是零 [@problem_id:1428883]。

如果我们要求 PCA 为我们绘制这些细胞的二维地图，它会产生无意义的结果。原因是 PCA 的逻辑基于[欧几里得距离](@article_id:304420)，即我们熟悉的“直线”距离。在这个巨大、空旷的高维空间中，这个度量变得毫无意义。因为每个细胞的向量几乎完全是零，任意两个细胞之间的欧几里得距离主要由它们都为零的数百万个位置决定。它们可能共享生物学上有意义的活动模式的几百个位置被淹没了。PCA 的第一主成分最终往往指向的不是细胞类型之间的生物学差异，而是一个技术伪影，比如“每个细胞的非零条目数”。

这时我们必须从望远镜切换到微距镜头。UMAP 采用了一种根本不同且更为局部的方法。它不问，“全局的变异轴是什么？”它向每一个细胞提出一个更亲密的问题：“谁是你最近的邻居？”它识别出最相似的其他细胞的小簇，基于有意义的*共享活动*模式，有效地忽略了绝大多数共享的零。在为所有细胞建立了这个局部关系的“社交网络”之后，UMAP 随后精心地绘制一张二维地图，以尽可能忠实地保留这种网络结构。通过关注局部拓扑而非全局几何，UMAP 精美地解析了 PCA 渲染成无法解释的一团的、不同的细胞类型簇。

### 制图的艺术：绘制发育地图

凭借 UMAP 精湛的制图能力，我们可以进行更雄心勃勃的探索。我们不仅可以尝试绘制静态状态，还可以绘制动态过程。发育生物学是研究生命最伟大奇迹之一的学科：一个单细胞如何产生一个完整、复杂的有机体。利用[单细胞测序](@article_id:377623)，我们可以捕捉成千上万个处于这一旅程不同阶段的细胞快照。我们的工具能帮助我们连接这些点并重建发育路径吗？

这就是拟[时序分析](@article_id:357867)（pseudotime analysis）的目标。想象我们收集了发育[中肾](@article_id:327040)脏的细胞，我们的 UMAP 图整齐地将祖细胞与两种不同类型的成熟、分化的细胞分离开来 [@problem_id:1714806]。然后我们让一个[算法](@article_id:331821)追踪从起点到终点的最可能路径。但[算法](@article_id:331821)返回了一个生物学上荒谬的结果：它声称一种成熟细胞类型变成了另一种，而不是两者都源于共同的祖细胞。

哪里出错了？错不在[算法](@article_id:331821)，也不在 UMAP 图。问题出在数据本身。我们有一张漂亮的地图，但地图上有一个巨大的洞。在我们的实验中，我们未能捕获到代表关键决策时刻的稀有、短暂的细胞，即祖细胞决定走向一种或另一种命运的岔路口。面对数据中的这一空白，轨迹[算法](@article_id:331821)为了寻找一条连续的路径，只能做它唯一能做的事：它从祖细胞跳到最近的密集细胞簇，然后从那里追踪一条无意义的路径。

这给了我们一个关于科学谦逊的重要教训。这些强大的[降维](@article_id:303417)方法不是水晶球。它们是制图师。它们绘制你所提供数据的地图，如果你的数据不完整——如果你勘测的区域有洞——地图就会产生误导。最美丽的地图也无法揭示一条原本就不存在的道路。

### 最后的警告：警惕机器中的幽灵

我们以最关键的一课结束，这个警告适用于任何[数据分析](@article_id:309490)。在我们为我们的透镜似乎揭示的生物学结构感到兴奋之前，我们必须绝对确定我们不只是在看我们自己测量设备的反映。这就是普遍存在的混杂和[批次效应](@article_id:329563)问题。

想象一个实验室报告了一项激动人心的发现：随着年轻[神经元](@article_id:324093)的成熟，一种特定的基因被强烈上调，并且这些[神经元](@article_id:324093)的存活率随时间显著增加 [@problem_id:2745965]。但仔细查看他们的实验记录本会发现一个致命缺陷。所有“年轻”的细胞都是在周一的实验中处理的，使用了一批试剂和一台显微镜。所有“成熟”的细胞都是在周二处理的，使用了新的一批试剂和另一台更灵敏的显微镜。

这个激动人心的发现烟消云散了。基因表达的明显变化不过是一种被称为[辛普森悖论](@article_id:297043)（Simpson's paradox）的统计幻觉，它是由汇集来自两个不同“批次”的数据造成的，其中一个批次不仅细胞组成不同，*而且*测量灵敏度也不同。增加的“存活率”仅仅是第二台显微镜更善于检测存活细胞的结果。观察到的效应并非存在于生物学中；它们是机器中的幽灵。

PCA 和 UMAP 尽管功能强大，但也很天真。它们会勤奋而忠实地找到你数据中最大的变异来源。如果最大的单一变异来源是你一半的样本在周一处理，另一半在周二处理，那么它们展示给你的就正是这个。第一主成分将不是一个深刻的生物学轴；它将是“周一 vs. 周二”轴。作为严谨的科学家，我们的工作是设计不产生混杂的实验，并使用能够看穿这些技术伪影、发现其下真实现象的统计方法。

从解混化学物质到绘制基因组图谱，从在单细胞的地形中导航到描绘发育的进程，[降维](@article_id:303417)工具已成为现代科学不可或缺的透镜。它们在压倒性的复杂性中揭示了惊人美丽和简洁的模式。然而，只有当我们明智地、带着健康的怀疑态度，并深刻理解我们所提出的问题、我们收集的数据以及这些工具本身的抽象、优雅逻辑之间的对话时，它们的真正力量才能被释放。