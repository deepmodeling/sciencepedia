## 应用与跨学科联系

在上一章中，我们深入探讨了均匀流形逼近与投影 (UMAP) 背后的巧妙数学原理。我们看到它如何将数千维空间中令人困惑的数据云——一个你根本无法在脑海中想象的数据集——投影到一张简单的二维地图上。我们了解到，该[算法](@article_id:331821)就像一位细心的地图绘制师，尽最大努力确保在高维“[超空间](@article_id:315815)”中相近的点，在我们的二维纸质地图上仍然是近邻。

但一张地图的好坏取决于它所促成的旅程。现在我们有了这张地图，我们用它来*做什么*呢？它能解锁哪些发现？拥有一张天体图是一回事，用它来导航、发现新世界、理解支配其运动的法则则是另一回事。本章讲述的就是这段旅程。我们将探讨科学家如何使用这些 UMAP 生成的地图，不仅是观察他们的数据，更是*审视*数据，揭示隐藏的生物学故事，并在看似不相关的科学领域之间建立联系。

### 从点到群体：解读[细胞图谱](@article_id:333784)

想象一下，你刚刚对一块组织进行了一次单细胞 RNA 测序实验。现在你拥有了，比如说，50,000 个单细胞的基因表达谱。每个细胞都是 20,000 维空间中的一个点！运行 UMAP 后，你面前出现了一张包含 50,000 个点的图。你看到了什么？

通常，你首先会注意到这些点并不仅仅是随机的涂抹。它们聚集在一起，形成独特的“岛屿”或[聚类](@article_id:330431)。这些[聚类](@article_id:330431)是 UMAP 图谱带来的第一个，也是最深刻的启示：它们代表了不同的细胞群体。就像世界地图有不同的大陆一样，你的 UMAP 图谱也有不同的细胞类型或细胞状态。

但哪个大陆是哪个呢？一团点是匿名的，直到我们能给它贴上标签。真正的侦探工作从这里开始。如果我们有一个假设——例如，某个特定的聚类可能是一种参与疾病的炎症细胞群体——我们可以直接在地图上验证它。我们可以不按聚类，而是根据我们已知的与那些炎症细胞相关的特定基因（比如 *S100A8* 基因）的表达水平来为图上的每个细胞着色。如果我们的其中一个[聚类](@article_id:330431)突然亮起明亮的黄色，我们就有了答案。我们刚刚在视觉上将我们抽象地图上的一个位置与一个具体的生物学功能关联了起来。这种简单而强大的技术被称为生成“特征图” (feature plot) [@problem_id:1466142]。

点亮特定聚类的基因被称为**标志基因 (marker genes)**。它们像灯塔一样，让我们能够自信地标记我们的聚类：“这是 T 细胞”，“这是[巨噬细胞](@article_id:360568)”，“这是成纤维细胞”。通过系统地叠加已知的标志基因，我们可以将一幅抽象的散点图转变为一份我们组织内细胞群落的带标签的图谱 [@problem_id:1520807]。一旦有了这些标签，我们还可以更进一步。我们可以让计算机对两个相邻的[聚类](@article_id:330431)——比如说，两种 T 细胞亚型——进行统计比较，并生成一份它们之间所有差异表达基因的完整列表。这种“差异表达”分析为我们提供了使一种细胞类型与另一种细胞类型截然不同的完整分子配方，揭示了支配其身份和功能的潜在遗传程序 [@problem_id:1714810]。

### 超越静态岛屿：绘制生命之河

如果所有细胞都固定成不可改变的类型，那将是一个整洁但相当无聊的世界。现实要动态得多。细胞会出生、成熟、改变功能、响应环境。生物学是一个关于过程而非仅仅是状态的故事。在这一点上，UMAP 提供了其最美妙的洞见之一。

有时，UMAP 图谱显示的不是一堆不相连的岛屿，而是揭示了细胞[排列](@article_id:296886)成一条[连续流](@article_id:367779)动的“河流”或轨迹。这种模式意味着什么？这意味着实验捕捉到了一个正在进行中的生物过程！如果我们正在研究[干细胞分化](@article_id:333817)为心肌细胞的过程，我们不仅有干细胞和心肌细胞，还有一整个谱系的细胞被捕捉到正在转变的过程中——每一个都比上一个在发育路径上更进了一步。UMAP 按顺序[排列](@article_id:296886)这些细胞，创建了一个分化过程的可视化时间轴。这个推断出的时间轴通常被称为“拟时序 (pseudotime)”，这是一个强大的概念，让我们能够从单一快照中研究发育的动态过程 [@problem_id:1421299]。我们可以沿着 UMAP 上的这条路径“行走”，逐个基因地观察细胞在改变其命运时其分子机制是如何被重新编程的 [@problem_id:2350906]。

这些路径甚至可以分叉。在发育过程中，一个祖细胞常常会到达一个“岔路口”，必须在两种或多种可能的命运之间做出选择。例如，一个血液祖细胞可能需要选择成为[巨噬细胞](@article_id:360568)还是中性粒细胞。如果我们的数据集捕捉到了这个决策之前、之中和之后的细胞，UMAP 通常会产生一个惊人的“Y”形模式。一股祖细胞流向前，然后分裂成两个不同的分支，每个分支都导向一个最终分化的细胞类型。UMAP 图谱不仅是一张地图，它还是一张关于决策的地图 [@problem_id:1428904]。

### 地图绘制师的职责：发现幻影与伪影

任何现实世界的测量都是不完美的。一张好的地图不仅应显示大陆，还应标出海怪、幽灵岛和危险的暗礁。UMAP 是一种非常出色的科学质量控制工具，帮助我们发现并移除那些可能误导我们的伪影。

例如，任何单细胞实验都不可避免地会包含一些受压、垂死或死亡的细胞。这些细胞不能代表健康的生物学状态。幸运的是，它们有一个非常独特且不健康的基因表达谱：它们的[细胞器](@article_id:314982)正在崩溃，因此 RNA 分子总量非常少，而剩余的分子中不成比例地高的一部分来自线粒体（细胞的能量工厂，在细胞压力下会超负荷运转）。由于所有这些垂死细胞都共享这种共同的、人为的特征，它们在高维空间中彼此非常相似。因此，UMAP 会很方便地将它们全部扫到一起，形成一个独立的“死亡之岛”，通常远离健康细胞的[聚类](@article_id:330431)。然后，我们可以通过其特有的迹象轻松识别这个[聚类](@article_id:330431)，并将其从我们的分析中移除 [@problem_id:1428912]。

一种更微妙的伪影是“双细胞 (doublet)”——一个技术错误，即两个不同的细胞粘在一起被当作一个来测量。由此产生的数据点是一个奇怪的混合体，其基因表达谱是其两个亲本的混合。UMAP 将这个嵌合体放在哪里？答案是 UMAP 逻辑的一个完美例证。在高维空间中，这个双细胞位于连接聚类 A 的一个细胞和[聚类](@article_id:330431) B 的一个细胞的直线上。因此，它的最近邻居是来自这两个[聚类](@article_id:330431)的细胞的混合。为了满足这些邻域关系，UMAP 将双细胞放置在地图上连接聚类 A 和聚类 B 的“桥梁”上。通过发现这些在原本分离良好的大陆之间的孤独旅行者，我们可以将它们识别并标记为可能的双细胞，从而清理我们的地图以获得更准确的解释 [@problem_id:2429781]。

### 新工具、新世界、新联系

为什么 UMAP 通常比[主成分分析 (PCA)](@article_id:352250) 等旧方法更强大？原因是 PCA 是*线性*的。它寻找能捕捉数据中最大变异的直线。但生物学很少是线性的；它充满了曲折、转弯和复杂的折叠。一个罕见但重要的细胞亚群——比如一小群耐药的癌细胞——可能对整体变异贡献不大，并且可能位于数据中一个复杂的非线性折叠上。PCA 凭借其线性投影，会直接忽略它，这些罕见的细胞将继续隐藏在主要群体中。而 UMAP 作为一种专注于保留局部邻域的非线性方法，可以“展开”这种复杂的[数据结构](@article_id:325845)，并将这个罕见的群体显示为一个独特的、独立的聚类。这不仅仅是一幅更漂亮的图；它可能是在找到关键药物靶点和完全错过它之间的区别 [@problem_id:1428885]。

此外，UMAP 的逻辑并不局限于[基因组学](@article_id:298572)。它可以应用于任何[高维数据](@article_id:299322)。在免疫学中，研究人员使用一种名为 [CyTOF](@article_id:360760) 的技术来测量数百万个单细胞表面 40 种或更多蛋白质的水平。UMAP 可以利用这些高维蛋白质数据创建一张免疫系统的地图。这使得免疫学家能够发现新的细胞类型并理解复杂的现象。例如，他们可能会发现一个 T 细胞[聚类](@article_id:330431)，它同时与三种不同的肽-MHC [分子结合](@article_id:379673)——一种来自病毒，一种来自细菌，一种来自机体自身组织。这是对 TCR [交叉反应性](@article_id:366092)的直接可视化，这是免疫学中的一个基本概念，即单个 T 细胞受体能识别多个不同的靶标，这一发现是通过绘制细胞蛋白质水平的真实情况而成为可能的 [@problem_id:2259142]。

最令人兴奋的应用往往来自于将 UMAP 与其他强大的思想相结合。我们目前讨论的 UMAP 图谱都是静态地图。但如果我们能让它们动起来呢？一种名为 **RNA 速度 ([RNA velocity](@article_id:313111))** 的技术正是这样做的。通过分析每个细胞中未[剪接](@article_id:324995)（新合成）与已剪接（成熟）RNA 的比例，它可以推断出该细胞未来发展的方向和速度。当我们将这些“速度向量”作为小箭头叠加在我们的 UMAP 图谱上时，整个地图就活了过来。我们不再只看到分化的河流；我们还能看到水流的方向，预测每个细胞的下一步走向 [@problem_id:1426480]。

最后，尽管 UMAP 功能强大，但它有一个主要局限性：它创建了一个抽象的关系地图，但在此过程中，它丢弃了细胞在原始组织中的物理位置。生物学中的一个巨大挑战是将这两者联系起来。研究的前沿现在涉及将 UMAP 与**[空间转录组学](@article_id:333797)**相结合，这是一种在组织切片上已知位置测量基因表达的技术。一种有原则的做法是创建一个新的、统一的距离度量。任意两个细胞之间的距离现在是它们转录组距离*和*它们在组织中物理距离的组合。通过从这个组合度量中构建 UMAP 地图，我们可以生成一个既尊重细胞分子相似性又尊重其解剖位置的可视化，从而创建一个真正将基因与组织联系起来的综合图谱 [@problem_id:2429839]。

从一堆杂乱的点中，UMAP 给了我们一张地图。有了这张地图，我们可以识别细胞类型的大陆，绘制发育的河流，绕开危险的伪影，甚至预测未来。它不仅仅是一个可视化工具；它是一个发现的工具，一种新型的显微镜，用以观察细胞高维世界中隐藏的结构、逻辑和深邃之美。