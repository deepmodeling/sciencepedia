## 应用与跨学科联系

我们已经穿越了图的形式化领域，定义了两个结构相同或不同的含义。这起初可能看起来像是一种枯燥的抽象练习，一场[排列](@article_id:296886)点和线的游戏。但事实远非如此。区分图的问题——[图同构问题](@article_id:325565)——不仅仅是一个数学难题；它是一个关于识别结构的基本问题，其回响在各种各样的科学领域中都能听到。它迫使我们一次又一次地追问：两个事物“相同”究竟*意味着*什么？正如我们将看到的，答案在很大程度上取决于提问者是谁。

### 化学家的分子与程序员的捷径

让我们从一个非常具体的问题开始。想象你是一名[计算化学](@article_id:303474)家，正在设计一种新药。你的计算机包含一个拥有数百万已知[分子结构](@article_id:300554)的庞大数据库。你的目标是查找一种新合成的分子是否已存在于此数据库中。从本质上讲，一个无环分子就是一个图：原子是顶点，它们之间的[化学键](@article_id:305517)是边。两个分子在结构上是相同的，当且仅当它们的图是同构的。

现在，对你的新分子与数据库中数百万个其他分子进行全面的同构测试，在计算上是极其庞大的任务。“[图同构](@article_id:303507)”问题虽然尚未被证明是[NP完全问题](@article_id:302943)，但因缺乏已知的、针对一般情况的高效（多项式时间）[算法](@article_id:331821)而闻名。我们需要一条捷径。与其进行全面、昂贵的比较，我们可以先检查一个更简单的属性，即**[图不变量](@article_id:326437)**——一个对于[同构图](@article_id:335567)必须相同的“指纹”。如果指纹不匹配，我们就知道这两个图是不同的，可以放弃比较。什么才是一个好的初步筛选指纹呢？你可能会检查原子（顶点）或[化学键](@article_id:305517)（边）的数量，但许多不同的分子都共享这些属性。一个更具区分性、但仍然易于计算的指纹是**度序列**：即每个原子拥有的[化学键](@article_id:305517)数量的列表。如果两个分[子图](@article_id:337037)具有不同的度序列，它们就不可能同构，我们就节省了大量工作。[生物信息学](@article_id:307177)和化学信息学等领域的这种实际需求，是寻找简单有效的、用以区分[非同构图](@article_id:337723)的[不变量](@article_id:309269)的强大驱动力 [@problem_id:1393437]。

### 指纹的局限性

像度序列这样的简单[不变量](@article_id:309269)的成功，立即引出了一个问题：是否存在一个*完美*的指纹？一个单一的、可计算的[不变量](@article_id:309269)，能够唯一地识别每个图（直到同构的意义下）？对这种“完备”[不变量](@article_id:309269)的探寻一直是[图论](@article_id:301242)的圣杯，其结果也极具启发性。

有史以来设计出的最强大、信息最丰富的[不变量](@article_id:309269)之一是**[Tutte多项式](@article_id:332883)**。这是一个双变量多项式，它编码了关于图结构的大量数据，包括[生成树的数量](@article_id:329422)、[连通分量](@article_id:302322)的数量等等。曾有一段时间，人们可能希望这个复杂的对象就是我们所寻求的完备[不变量](@article_id:309269)。可惜，它不是。存在一些在结构上根本不同——可证明是不同构的——图对，它们却共享完全相同的[Tutte多项式](@article_id:332883) [@problem_id:1547714]。类似地，相关的、源于[网络分析](@article_id:300000)的[不变量](@article_id:309269)如**流多项式**，也未能成为完备[不变量](@article_id:309269)。人们可以构造出两个图，其中一个包含访问每个顶点的路径（[哈密顿回路](@article_id:334785)），而另一个则没有——这是一个深刻的结构差异——然而它们的流多项式却可能完全相同 [@problem_id:1507602]。

这是一个至关重要的教训。这些“Tutte等价”或“流等价”的[非同构图](@article_id:337723)对的存在告诉我们，区分图的问题是极其微妙的。使得两个图不同的信息，可以以一种连非常复杂的多项式[不变量](@article_id:309269)都无法察觉的方式隐藏起来。没有简单的公式，没有单一的魔法多项式，能够捕捉图的形状本质。

### “相同”与否，见仁见智

当我们意识到“相同性”会根据上下文或我们应用的变换而改变时，故事变得更加有趣。从一个角度看不同的事物，从另一个角度看可能变得完全相同。

考虑画在平面上的图。每个这样的图都有面，包括外围的无限面。我们可以创建一个新的图，即**对偶图**，方法是在每个面中放置一个顶点，如果它们对应的面在原图中共享一条边，就在这两个新顶点之间画一条边。这种对偶性是平面图理论的基石。现在，在这种变换下，同构性会发生什么变化？当然，如果两个图不同，它们的对偶图也必定不同吧？出人意料的是，并非如此。人们可以构造出两个简单的、不同构的平面图，它们的[对偶图](@article_id:324914)却是完全同构的 [@problem_id:1528858]。一个看似能捕捉图的几何本质的变换，实际上却可以抹去使原始图截然不同的那些特征。

我们可以将抽象再推进一步。一个图不仅仅是顶点和边的集合；它也是环的集合。**[拟阵理论](@article_id:336193)**是一个优美的领域，它从线性代数和图论中推广了独立性的概念。从任何图中，我们都可以提取其**环[拟阵](@article_id:336818)**，它只关心哪些[边集](@article_id:330863)构成一个简[单环](@article_id:309663)。我们再次提出问题：如果两个图有同构的环[拟阵](@article_id:336818)，它们就必须是同构的吗？答案再次是否定的。一个路径图和一个相同顶点数的[星形图](@article_id:335255)显然是不同构的（例如，它们的[度序列](@article_id:331553)就不同）。然而，由于两者都是树，它们都没有任何环。因此，它们的环[拟阵](@article_id:336818)是平凡同构的——它们都是“空的”。这告诉我们，如果我们观察图的“镜头”只关心环结构，我们可能会忽略底层的顶点[排列](@article_id:296886) [@problem_id:1379103]。

但关于情境依赖等价性的最惊人例子来自一个完全不同的科学领域：量子力学。在一种[量子计算](@article_id:303150)模型中，**[图态](@article_id:303284)**是一个由[图表示](@article_id:336798)的纠缠[量子比特](@article_id:298377)系统。顶点是[量子比特](@article_id:298377)，边则决定了哪些对是纠缠的。一个关键问题是：何时两个看起来不同的[图态](@article_id:303284)具有相同的计算能力？在这个世界里，等价性不是[图同构](@article_id:303507)，而是一种称为“局域克利福德（LC）等价”的东西。如果一个状态可以通过对单个[量子比特](@article_id:298377)应用[量子门](@article_id:309182)变换成另一个状态，那么这两个状态就是LC等价的。一个惊人的定理是，两个[图态](@article_id:303284)是LC等价的，当且仅当它们底层的图可以通过一系列称为**局域补**的操作相互转换。事实证明，这种操作可以连接不同构的图。例如，简单的4顶点路径图可以通过局域补变换成一个4环——这两个图显然是不同构的。然而，从[量子计算](@article_id:303150)机的角度来看，它们代表了等价的资源 [@problem_id:652637]。在这里，物理定律本身提供了一种新的、更粗略的“相同性”概念，它完美地适应了其自身的目的。

### 驯服海量数据：计数与近似

如果区分两个特定的图都如此困难，或许我们可以解决一个不同的问题。我们能否不比较两个图，而是计算出给定大小的所有可能的图结构？这就是**枚举[组合学](@article_id:304771)**的领域。对于少数顶点，比如说4个，人们可以尝试画出所有情况。但这很快就会变得一团糟。这两幅画真的不同，还是只是同一图的顶点重新[排列](@article_id:296886)？

在这里，群论的语言提供了一个威力惊人且优雅的工具。所有可能的顶点[置换](@article_id:296886)的集合构成一个群。这个群“作用”在所有可能的边配置的集合上。不同构的图恰好是这个[群作用](@article_id:332514)的**轨道**——即那些可以通过相互变换得到的标记图的集合。著名的**[轨道计数](@article_id:302843)引理**（或[伯恩赛德引理](@article_id:307186)）给了我们一个计算这些轨道的公式，将一个看似不可能的枚举任务简化为对群的对称性的[系统分析](@article_id:339116)。利用这个引理，我们可以精确地计算出有4个顶点的不[同构图](@article_id:335567)恰好有11个，5个顶点的有34个，依此类推 [@problem_id:1379129] [@problem_id:819933]。当通过群论的视角来看待非同构问题时，它变成了一个计算对称性的问题。

那么另一个极端呢？不是小图，而是像所有Facebook用户或万维网这样大到无法想象的图。在这里，询问两个如此巨大的图是否同构通常是无意义的。相反，我们想了解它们的[大尺度结构](@article_id:319394)。**Szemerédi正则性引理**是现代[图论](@article_id:301242)中的一个里程碑式的成果，它正能帮助我们做到这一点。粗略地说，它指出任何巨大的、稠密的图都可以被一个更小的、加权的“摘要”图，即**简约图**来近似，后者的结构要简单得多。这就像为一张精细的照片创建一幅低分辨率的像素化图像。但这种简化是有代价的。就像我们其他的变换一样，这种近似过程可能会掩盖细节。完全有可能存在两个巨大的、不同构的图，在应用正则性引理后，会产生同构的简约图，即使[密度参数](@article_id:328751)几乎完全相同 [@problem_id:1537323]。这为大数据时代提供了一个重要的教训：我们用来简化和总结大规模网络的方法可能会制造出结构上的幻觉，使不同的事物看起来相同。

### 现代前沿：机器能否学会“看”？

这把我们带到了技术的前沿：人工智能。**[图神经网络](@article_id:297304)（GNNs）**是一类专门设计用于处理图结构数据的[深度学习](@article_id:302462)模型。它们被用于从预测分子性质到在社交媒体上推荐朋友等各种任务。GNN通过在相邻节点之间传递信息来“看”一个图，根据其局部邻域迭代地更新每个节点的表示。经过几轮之后，理论上，网络已经学习到了图结构的丰富表示。

你可能会认为，一个强大的GNN可以学会成为最终的[图同构](@article_id:303507)测试器。但这里存在一个深刻而美丽的、与我们经典理论的联系。GNN区分两个图的能力——其**[表达能力](@article_id:310282)**——是受到根本限制的。已经证明，最常见的GNN类型的能力，充其量等同于一种简单的、经典的[图同构](@article_id:303507)[启发式算法](@article_id:355759)，即上世纪60年代的**一维Weisfeiler-Leman（1-WL）测试**。这意味着，如果1-WL测试无法区分两个图，那么标准的GNN也无法做到，无论它接受了多少数据训练，也无论它有多“深”！ [@problem_id:2395464] 这些网络的架构本身就赋予了它们一个计算上的盲点，这个盲点恰好对应于理论计算机科学中一类已知的难以区分的图。因此，设计更强大的GNN的探索，与如何超越WL测试局限性的深层理论问题，是密不可分的。

[图非同构](@article_id:334986)问题，源于点和线的简单谜题，如今已融入现代科学的肌理之中。它是一个挑战我们直觉的概念，连接了从量子物理到人工智能的 disparate 领域，并仍然是深刻、优美且极其困难问题的源泉。它提醒我们，识别模式这一简单的行为，是宇宙中最深远的挑战之一。