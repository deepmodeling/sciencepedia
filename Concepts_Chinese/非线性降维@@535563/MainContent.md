## 引言
[高维数据](@article_id:299322)是现代科学的标志，从单细胞的基因表达，到分子模拟中的原子位置。然而，高维空间中的原始数字往往掩盖了支配系统的真实、更简单的模式。这些数据常常存在于一个被称为[流形](@article_id:313450)的复杂[曲面](@article_id:331153)上，标准的分析工具在此时可能会产生误导。本文要解决的核心挑战和知识空白，是如何在不扭曲其内在结构的情况下将其可视化。像主成分分析（PCA）这样的简单线性投影方法可能会惨败，投下一个令人困惑的阴影，恰好压垮了我们希望看到的结构。

本文为[非线性降维](@article_id:638652)（或称[流形学习](@article_id:317074)）这一强大技术提供了一份指南，这些技术旨在将这些复杂的数据结构“展开”到一张平面图上。在“原理与机制”部分，我们将探讨Isomap、[t-SNE](@article_id:340240)和UMAP等方法背后的直观思想，对比它们的理念，并为正确解读最终的可视化结果、避免常见陷阱提供一份至关重要的用户指南。随后，“应用与跨学科联系”部分将展示这些方法如何给生物学、[材料科学](@article_id:312640)、人工智能等领域带来革命性变化，使研究人员能够绘制动态过程图谱，并揭示复杂系统的隐藏原理。

## 原理与机制

想象你是一只生活在二维世界里的蚂蚁。你可以向前、向后、向左、向右爬行。现在，假设你的世界不是一个广阔的平面，而是一张揉皱的纸的表面——用数学家的语言来说，就是一个“瑞士卷”[@problem_id:2416056]。你站在纸卷的一层上。在你的正“下方”，纸的下一层上，有一小块糖屑。在这张纸所处的三维世界里，那块糖屑离你非常近。如果你会飞，一瞬间就能到达。但你是一只蚂蚁，只能沿着纸面爬行。对你来说，通往糖屑的道路漫长而曲折，需要你爬到纸卷的边缘，再沿着下一层爬回来。

这个小故事抓住了[非线性降维](@article_id:638652)试图解决的核心挑战。我们从世界上收集的数据——比如来自生物组织的数千个细胞的基因表达谱——通常就像那个瑞士卷。每个细胞都是一个拥有数千个维度（每个基因一个维度）的空间中的一个点。虽然这些点生活在一个高维的“环境”空间中，但它们有意义的关系可能沿着一个更简单、更低维但弯曲的表面——一个**[流形](@article_id:313450)**——展开。“两点之间直线最短”的距离，即**欧几里得距离**，可能会非常具有误导性。两个细胞在这个高维空间中看似很近，可能仅仅是因为它们所在的[流形](@article_id:313450)恰好折叠了回来，就像我们的瑞士卷的层与层一样。真正的生物学“距离”是沿着[流形](@article_id:313450)的路径，即**[测地线](@article_id:327811)距离**——也就是我们那只蚂蚁必须爬行的路径。

### 从简单的阴影到展开[流形](@article_id:313450)

我们究竟如何才能将这样一个复杂的高维结构可视化呢？一个简单而直观的想法是直接投影。想象一下，用一束强光照射瑞士卷，并观察它在墙上的影子。这正是经典的线性技术**主成分分析（PCA）**所做的事情。PCA找到数据分布最广的方向（方差最大的方向），然后将数据投影到一个由这些方向定义的平面上。

如果你从侧面用光照射瑞士卷，它的影子会像一个矩形。如果你从末端照射，影子会是一个圆形。无论哪种情况，投影都会把所有的层都压在一起。我们的蚂蚁和糖屑，本来在纸卷的不同层上，在影子中却会落在几乎相同的位置。PCA由于依赖环境空间中的[欧几里得距离](@article_id:304420)，完全错过了纸张内在的、展开的结构[@problem_id:2416056]。如果我们细胞数据的PCA图只显示了一大团无差别的云，我们不应该放弃希望。这可能只是我们看到了一个瑞士卷的影子。真正的结构可能仍然存在，等待着一个更好的工具来揭示它[@problem_id:1428905]。

这就是[非线性降维](@article_id:638652)技术，或称**[流形学习](@article_id:317074)器**，大显身手的地方。它们的目标不是投下一个简单的影子，而是小心翼翼地将瑞士卷*展开*到平坦的桌面上，这样我们就能看到它真正的二维本质。它们通过不同但同样巧妙的理念来实现这一目标。

### [流形学习](@article_id:317074)器的工具箱：不同的理念

[流形学习](@article_id:317074)[算法](@article_id:331821)就像专业的地图绘制师，每个都有自己独特的策略，将一个复杂、弯曲的世界绘制到一张平坦的纸上。

最早也是最直观的策略之一是**[等距](@article_id:311298)映射（Isomap）**。Isomap本质上是像我们的蚂蚁一样思考。它首先通过将每个数据点（每个细胞）与其在高维空间中最近的邻居连接起来，构建一个简单的图。然后，它通过寻找网络中任意两点之间的最短路径来近似[测地线](@article_id:327811)距离。最后，它使用一种称为多维缩放（MDS）的经典技术来绘制一张地图，使得地图上点与点之间的距离尽可能接近计算出的[测地线](@article_id:327811)距离[@problem_id:2416056]。这是一种全局方法：它试图保留整个几何景观。

更现代且广泛使用的技术，如**[t-分布随机邻域嵌入](@article_id:340240)（[t-SNE](@article_id:340240)）**和**均匀流形逼近与投影（UMAP）**，采用了略有不同、更关注局部的理念。它们认为，完美地还原全局几何结构极其困难，甚至可能不是最重要的目标。如果我们专注于一个更适中但可能更关键的任务呢？即：确保在高维空间中是邻居的点在我们的二维地图上仍然是邻居。

我们可以从两个方面来衡量地图的质量[@problem_id:3117945]。首先，我们不希望产生虚假的邻域关系。如果两个点在我们的地图上相邻，但它们在原始[流形](@article_id:313450)上其实相距很远，这就是一次“入侵”。我们希望有高的**可信度**——我们希望相信在地图上看到的邻居是真实的邻居。其次，我们不希望丢失真实的邻域关系。如果两个点在[流形](@article_id:313450)上是邻居，但在我们的地图上最终相距很远，这就是一次“排除”。我们希望有高的**局部连续性**——我们希望原始的局部结构在我们的地图上是连续的。

*   **[t-SNE](@article_id:340240)**将这个问题构建成一个概率游戏。对于每个细胞，它计算选择任何其他细胞作为其邻居的概率，距离越近的细胞获得越高的概率。然后，它尝试在二维空间中[排列](@article_id:296886)这些点，使得这些邻域概率与原始概率尽可能相似。它执着于保留这些局部关系[@problem_id:2773290]。

*   **UMAP**使用来自拓扑学的复杂数学框架来达到类似的目标。它将[数据建模](@article_id:301897)为一个“模糊”的连接网络，然后尝试绘制一个在结构上尽可能相似的二维网络。它在这方面表现得异常出色，通常能生成具有高可信度和连续性的地图。UMAP还有一个巧妙的特性：虽然它的主要焦点是局部结构，但它比[t-SNE](@article_id:340240)更努力地保留一些更大尺度的全局结构，从而提供一个更好的“全局”视图[@problem_id:2773290]。

差异是显著的。PCA可能只显示一个单调的团块，而UMAP可以处理相同的数据，并将其展开成一幅由不同岛屿组成的美丽星座图，揭示出PCA的线性投影完全错过的、隐藏的细胞类型异质性[@problem_id:1428905]。

### 用户读图指南

这些地图功能极其强大，但就像古代的藏宝图一样，它们充满了容易被误解的符号和惯例。从[t-SNE](@article_id:340240)或UMAP图中得出错误的结论是现代数据科学中最常见的陷阱之一。

#### 基础知识：点和岛屿
首先，是简单的部分。地图上的每一个点都代表一个独立的数据点——在我们的例子中，就是一个单细胞完整的、高维的基因表达谱[@problem_id:2350897]。当你看到一群密集的点形成一个清晰的“岛屿”或簇时，它表示一组细胞在基因表达上彼此非常相似。在生物学中，这是一个独特的细胞类型或细胞状态的经典标志[@problem_id:1520808]。

#### 陷阱：此处有恶龙
现在是警告部分。这些地图的美丽是有代价的。为了保留至关重要的局部邻域关系，[算法](@article_id:331821)必须在全局图景上做出取舍。

1.  **“距离”的含义**：在PCA图中，距离是有意义的。因为它是线性投影，两个簇中心之间的巨大距离对应于原始高维空间中巨大的平[均差](@article_id:298687)异。但对于[t-SNE](@article_id:340240)和UMAP则不然。这些[算法](@article_id:331821)会像拉太妃糖一样拉伸和压缩空间，以使局部邻域看起来更好。它们会在簇之间制造巨大的、空旷的鸿沟，只是为了明确它们是不同的。这个鸿沟的大小是一种[算法](@article_id:331821)产物。它**不**是衡量簇之间差异有多大的定量指标[@problem_id:1428930]。可以把它想象成地铁图：地图上两个站点之间的距离并不能告诉你实际的旅行时间或路程。它只告诉你站点的顺序。同样，UMAP图上的簇间距离告诉你“这些细胞类型是不同的”，而不是“*有多*不同”[@problem_id:1465908]。

2.  **“大小”和“密度”的含义**：你在UMAP图上看到两个簇。一个簇小而紧凑，另一个大而松散。人们极易得出结论，认为紧凑簇中的细胞更均一，[转录](@article_id:361745)变异性比松散簇中的细胞小。这是不正确的。簇的表观面积和密度也是优化过程的产物。[算法](@article_id:331821)可能为了把一组细胞塞进去而将其紧密打包，而为了给邻居腾出空间而将另一组细胞铺开。视觉上的密度并不是衡量簇内方差的可靠指标[@problem_g_id:1428920]。

3.  **“坐标轴”的含义**：在PCA中，坐标轴（PC1, PC2）是基础。PC1是捕获整个数据集中最大变异的单一直线。我们可以查看该轴上的“载荷”，以了解哪些基因正在将细胞推向一个或另一个方向，这通常能揭示一个连续的生物过程。而在[t-SNE](@article_id:340240)和UMAP中，通常标记为`UMAP_1`和`UMAP_2`的坐标轴**没有内在含义**。整个图可以被旋转、翻转或轻微扭曲，它仍然是一个同样有效的表示。[算法](@article_id:331821)的最终输出取决于一个随机的起始位置，最终的方向是任意的。试图将UMAP图的x轴解释为一个生物学上的“谱系”是对地图创建方式的根本误解[@problem_id:1428895]。

### 实践交响曲：两全其美

鉴于线性方法的局限性和非线性方法在解读上的怪癖，你可能会想知道该选择哪一个。答案，正如科学中常有的情况一样，是“两者都用”。事实上，现代生物学中一个标准且高效的工作流程，就包含了PCA和UMAP之间美妙的协同作用[@problem_id:1465894]。

这个过程通常从对数据先运行PCA开始，但不是为了生成最终的图。相反，它是作为一个准备步骤。为什么呢？主要有三个原因：

*   **去噪**：[高维数据](@article_id:299322)中的大部分变异只是随机噪声。PCA非常擅长在其前几个主成分中捕获主要的、协调的变异趋势，而将嘈杂的、不相关的[抖动](@article_id:326537)归入后面的主成分。通过只保留前（比如）50个主成分，我们创建了一个数据的“去噪”版本，强调了真实的生物信号。

*   **计算速度**：在一个有20,000个维度的空间中寻找最近邻居在计算上是极其残酷的。在50维的主成分空间中进行同样的计算，速度要快上几个数量级，并且需要的内存也少得多。

*   **克服诅咒**：在非常高的维度中，距离这个概念本身变得很奇怪。这就是臭名昭著的“**[维度灾难](@article_id:304350)**”。随着维度数量的增加，任何两个随机点之间的距离几乎变得相同。这使得定义“最近邻居”都变得困难。通过首先将数据投影到一个更易于管理的50维PCA空间，UMAP所依赖的距离计算变得更加稳定和有意义。

这个工作流程就像一位雕塑大师在工作。PCA是那把大锤，首先用来敲掉大块无趣的大理石（噪声），显露出雕像的粗略轮廓。然后，UMAP是那把精细的凿子，用来小心翼翼地雕刻出隐藏在石块中的复杂细节——不同的细胞类型以及它们之间微妙的关系。这是线性思维和非线性思维的完美结合，使我们能够构建出既稳健又精细的细胞世界地图。

