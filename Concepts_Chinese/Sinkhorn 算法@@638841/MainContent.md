## 引言
在无数科学与工程学科中，一个根本性挑战是如何有意义地比较、对齐或转换复杂的数据集。最优传输 (Optimal Transport, OT) 为此任务提供了一个强大且几何上直观的框架，将其概念化为将“质量”[分布](@entry_id:182848)从一种配置移动到另一种配置的最有效方式。然而，数十年来，解决经典 OT 问题的巨大计算成本限制了其实际应用，特别是对于现代研究中常见的大规模数据集。这个计算瓶颈在 OT 的理论吸[引力](@entry_id:175476)与其实际应用之间造成了巨大鸿沟。

本文探讨了 Sinkhorn 算法，这是一种优雅且极其高效的方法，它彻底改变了最优传输的应用。通过引入物理学中的一个概念——[熵正则化](@entry_id:749012) (entropic regularization)——该算法找到了一个稍微“模糊”但计算上可行得多的解。我们将首先深入探讨该算法背后的**原理与机制**，从经典的 OT 问题入手，揭示添加熵项如何导出一个与[统计力](@entry_id:194984)学有深层联系的简单迭代解。随后，**应用与跨学科联系**一章将展示该算法的变革性影响，揭示其在机器学习、计算生物学和数值工程等不同领域中扮演的关键角色。

## 原理与机制

### 经典困境：搬运沙堆

想象一下，你有一大堆沙子，由[分布](@entry_id:182848) $a$ 描述，你需要将其移动来填满一个特定形状的坑，该坑由[分布](@entry_id:182848) $b$ 描述。你想以最小的总功耗来完成这项工作。这就是**最优传输**问题的核心，一个自 18 世纪 Gaspard Monge 首次提出以来就一直吸引着数学家们的问题。

让我们把问题具体化。假设你的沙堆由位于 $i=1, \dots, m$ 的离散沙丘组成，而坑则有位于 $j=1, \dots, n$ 的离散凹陷。每个沙丘的沙量为 $a_i$，每个凹陷的容量为 $b_j$。我们可以定义一个**[成本矩阵](@entry_id:634848)** $M$，其中每个条目 $M_{ij}$ 代表从沙丘 $i$ 搬运一铲沙子到凹陷 $j$ 所需的[功耗](@entry_id:264815)（例如，距离的平方）。你的任务是创建一个**传输方案**，即一个矩阵 $P$，其中 $P_{ij}$ 是你从 $i$ 移动到 $j$ 的沙子数量。

这个方案必须满足两条符合常识的规则：
1.  每个沙丘 $i$ 的所有沙子都必须被搬走：$\sum_{j=1}^n P_{ij} = a_i$。
2.  每个凹陷 $j$ 都必须刚好被填满至其容量：$\sum_{i=1}^m P_{ij} = b_j$。

你的方案的总[功耗](@entry_id:264815)或成本为 $\sum_{i,j} P_{ij} M_{ij}$。经典最优传输的目标是找到使该总成本最小化的方案 $P$。这是一个线性规划问题，多年来，寻找其精确解一直是一项计算要求很高的任务。对于拥有数百万个“沙丘”和“凹陷”的大型问题——这在数据科学和机器学习中很常见——像匈牙利算法这样的传统方法，其运算量级可达 $O(n^3)$，实在是太慢了 [@problem_id:3096877]。这个计算瓶颈阻碍了最优传输的广泛应用长达数十年之久。人们需要一种新的思维方式。

### 物理学的触碰：[最大熵原理](@entry_id:142702)

让我们不要像寻求单一完美解的纯粹数学家那样思考，而是像物理学家一样来处理这个问题。在自然界中，系统倾向于向**熵**最大化或无序度最大化的状态演化。一个高度“固执”的传输方案——例如，将沙丘 1 的所有沙子全部搬到凹陷 5——是一种非常有序的低熵状态。而一个将每个沙丘的沙子都分散一点到许多不同凹陷的方案，则是一个无序得多的高熵状态。

如果我们修改一下目标会怎样？我们不再是*仅仅*最小化成本，而是鼓励方案变得更“混乱”或“模糊”一点。我们可以通过在[目标函数](@entry_id:267263)中加入一个熵项来实现这一点。新问题就变成了寻找一个方案 $P$ 来最小化：

$$ \text{总成本} - \epsilon \times \text{熵}(P) $$

这被称为**[熵正则化](@entry_id:749012)**。项 $\epsilon > 0$ 是一个[正则化参数](@entry_id:162917)，我们可以将其视为一种**温度**。它控制着在最小化[功耗](@entry_id:264815)和最大化无序度之间的权衡。

-   当 $\epsilon$ 非常接近于零（低温）时，我们又回到了原始问题。此时成本是唯一重要的因素，我们会得到一个清晰、集中的方案。
-   当 $\epsilon$ 非常大（高温）时，熵项占主导地位。方案会忽略成本，并试图尽可能地分散。在此极限下，传输方案仅反映源[分布](@entry_id:182848)和目标分布的独立性，即 $P_{ij} \approx a_i b_j$ [@problem_id:3131723]。

这个小小的改变带来了深远的影响。原始问题可能有多个最优解。而正则化问题，由于熵项的[严格凸性](@entry_id:193965)，对于任何 $\epsilon > 0$ 都有一个**唯一解**。此外，该解总是**稠密的**，意味着每个 $P_{ij}$ 都是严格为正的 [@problem_id:3188422] [@problem_id:3131723]。通过注入一点关于随机性的物理直觉，我们将一个可能棘手的问题转变为一个性质良好且具有单一稳定答案的问题。

### 解的形式：一个普适定律

那么，这个唯一的、模糊的解是什么样的呢？我们可以使用[拉格朗日乘子法](@entry_id:176596)来找到它的结构，这是物理学和工程学中用于[约束优化](@entry_id:635027)问题的标准工具。我们希望在遵守那两条关于搬走所有沙子和正确填满坑的规则的同时，最小化我们的新目标函数。

推导 [@problem_id:1424947] 的结果惊人地简单和熟悉。最优传输方案 $P_{ij}$ 必须具有以下形式：

$$ P_{ij} = u_i v_j \exp\left(-\frac{M_{ij}}{\epsilon}\right) $$

这是一个**吉布斯-玻尔兹曼分布**，[统计力](@entry_id:194984)学的基石！它告诉我们，一个系统处于某个特定状态的概率与其负能量的指数相关。在这里，成本 $M_{ij}$ 扮演着从 $i$ 传输质量到 $j$ 的“能量”角色，而我们的参数 $\epsilon$ 正是“温度”。高成本的路径被指数级地抑制了。

量 $u_i$ 和 $v_j$ 是正的缩放因子，它们源于用于强制执行我们约束的拉格朗日乘子。目前，它们是未知的。让我们定义矩阵 $K_{ij} = \exp(-M_{ij}/\epsilon)$ 为**吉布斯核**。这是一个“可能性”矩阵，其中成本已被转化为可行性的度量。我们的最优方案现在具有优雅的结构 $P = \mathrm{diag}(u) K \mathrm{diag}(v)$，其中 $\mathrm{diag}(u)$ 和 $\mathrm{diag}(v)$ 是由我们的缩放向量构成的[对角矩阵](@entry_id:637782)。

### 算法的诞生：一场简单而优雅的舞蹈

我们已经知道了解决方案的形式，但仍需找到缩放向量 $u$ 和 $v$ 的具体值。定义它们的约束条件也为我们提供了计算它们的方法。

让我们看一下行约束：$\sum_j P_{ij} = a_i$。代入我们新的 $P_{ij}$ 形式：

$$ \sum_{j=1}^n u_i K_{ij} v_j = u_i \left( \sum_{j=1}^n K_{ij} v_j \right) = a_i $$

这个方程可以重新整理，用 $v$ 来求解 $u_i$。在[向量表示](@entry_id:166424)法中，这变成了一个非常简洁的表达式：$u = a / (Kv)$，其中除法是逐元素执行的 [@problem_id:495481]。

类似地，列约束 $\sum_i P_{ij} = b_j$ 给了我们一个用 $u$ 表示 $v$ 的方法：$v = b / (K^\top u)$ [@problem_id:2892437]。

现在我们有两个耦合方程。我们无法同时解出 $u$ 和 $v$，但我们可以做一些更简单的事情：我们可以迭代。

1.  从对 $v$ 的一个猜测开始（例如，一个全为 1 的向量）。
2.  使用公式 $u = a / (Kv)$ 计算一个新的 $u$。
3.  使用这个新的 $u$，用 $v = b / (K^\top u)$ 计算一个新的 $v$。
4.  重复步骤 2 和 3。

这个极其简单、来回往复的过程就是 **Sinkhorn 算法**。它无非是交替缩放吉布斯核 $K$ 的行和列，直到行和与 $a$ 匹配，列和与 $b$ 匹配。在非常普遍的条件下，这种迭代的舞蹈保证能收敛到唯一的正确答案 [@problem_id:3552913]，这一结果依赖于非负矩阵的深层数学结构。

### 更广阔的视角：统一性与应用

Sinkhorn 算法的真正魅力不仅在于其优雅，更在于其强大的功能以及它在不同科学领域之间揭示的联系网络。

#### 速度为王

Sinkhorn 算法在现代重新兴起的主要原因是其惊人的速度。迭代的每一步主要由矩阵-向量乘法构成，这在现代计算机上，尤其是 GPU 上，运行得非常快。这意味着，虽然找到精确的最优传输解可能需要 $O(n^3)$ 的时间，但 Sinkhorn 算法可以在接近 $O(n^2)$ 的时间内生成一个高质量的近似解。对于拥有数百万个点的数据集，这意味着计算时间从数年缩短到数分钟 [@problem_id:3096877]。我们为了在计算可行性上获得巨大收益，在最优性上做出了一个小的、可控的牺牲——即由熵引入的、与 $\epsilon$ 成正比的“偏差”。

#### 统一看似迥异的领域

该算法不仅仅是最优传输的一个技巧。在数值线性代数中，这个精确的迭代过程几十年来一直被称为 **Sinkhorn-Knopp 算法**，用于**[矩阵均衡](@entry_id:751751)**。其目标是取一个非负矩阵，找到[对角缩放](@entry_id:748382)矩阵 $D_r$ 和 $D_c$，使得 $D_r A D_c$ 具有预设的行和与列和（例如，全部等于 1，使其成为双随机矩阵）。这被用于诸如预处理[线性系统](@entry_id:147850)以使其更易求解等任务 [@problem_id:3552913]。我们看到的是一种深刻的统一性：一个源于经济学和物流学的问题（最优传输）和一个源于数值计算的问题（[矩阵均衡](@entry_id:751751)），在其核心上是相同的。

这种联系网络还在延伸。整个过程可以被看作一个**[凸凹博弈](@entry_id:637275)** [@problem_id:3131723]。一个参与者选择传输方案 $P$ 以最小化成本，而一个“对偶”参与者则选择势（与我们的缩放向量 $u$ 和 $v$ 相关）以最大化一个不同的目标。Sinkhorn 算法可以被解释为一种简单策略，即参与者轮流做出最佳移动——这个过程被称为块坐标上升——从而将博弈推向其唯一的均衡点。甚至可以证明，Sinkhorn 算法是一个强大的优化框架——**交替方向乘子法 ([ADMM](@entry_id:163024))** 的一个特例，但前提是标准的二次惩罚被一个基于熵的惩罚所取代 [@problem_id:3096718]。这揭示了熵不仅仅是一个附加项；它定义了问题空间本身的几何结构。

#### 适应真实世界

其核心思想也异常灵活。如果在运输过程中我们的沙堆可以增多或减少呢？例如，在计算生物学中，我们可能追踪一个可以增殖（[质量生成](@entry_id:161427)）或死亡（质量销毁）的细胞群体。通过稍微修改更新规则，Sinkhorn 算法可以被推广来处理这种**非均衡最优传输**，允许方案的总质量与源[分布](@entry_id:182848)或目标分布的总质量不同 [@problem_id:3335646]。这个强大的扩展使我们能够建模更丰富的一类动态过程，同时保留算法的优雅和效率。

从一个关于搬运沙子的简单问题出发，我们穿越了物理学、线性代数和博弈论中的概念，最终得到了一个简单、强大且通用的算法，它正在推动整个现代科学的创新。这是对数学思想背后统一性及其解决现实世界问题之力量的美好证明。

