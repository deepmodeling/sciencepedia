## 引言
在数据分析的世界里，对事件进行计数似乎是一项直截了当的任务。从栖息地中的物种数量到患者的门诊次数，计数数据无处不在。长期以来，统计学家一直依赖泊松分布等模型来理解这些计数。然而，一个常见且令人困惑的问题是，数据中包含的零值远比这些标准模型预测的要多——这种现象被称为“零值过多”或“零膨胀”。这不仅仅是一个统计异常，它是一个信号，表明背后有一个更丰富的故事有待讲述，一个区分不同种类“无”的故事。

本文旨在作为一份全面的指南，帮助读者理解和应用专为应对这一挑战而设计的模型。通过探索零膨胀框架的概念和实践基础，本文解决了传统计数模型留下的关键知识空白。首先，在“原理与机制”部分，我们将剖析零值过多的问题，介绍结构性零值和抽样零值的关键概念，并详细阐述[零膨胀模型](@entry_id:756817)和跨栏模型这两种优雅的叙事。然后，在“应用与跨学科联系”部分，我们将穿越不同的科学领域——从生态学到基因组学——看看这些模型如何在实践中被用来揭示更深刻、更细致的见解。读完本文，您不仅会理解这些模型的机制，还会领会到，通过对数据中的零值提出正确的问题，可以获得多么强大的分析能力。

## 原理与机制

### 过多零值的难题

想象一下，你是一位正在计数的科学家。计数的对象可以是任何东西：工厂批次中的次品数量、一个小时内通过某个安静十字路口的汽车数量，或者在一个更严肃的场景中，一位患者在医院获得的感染次数。计数似乎很简单，而且很长一段时间以来，统计学家们都有一个非常优雅的工具来处理这个问题：**泊松分布**。它是独立发生且[平均速率](@entry_id:147100)恒定的事件的自然法则。如果你知道事件的平均数，比如说 $\mu$，泊松分布就能告诉你观察到恰好 $0, 1, 2,$ 或任何其他数量事件的概率。

但有时，自然界并不遵循如此简单的规则。当我们收集数据时，会发现一些奇怪的现象。让我们来看一个来自医院感染追踪研究的真实案例 [@problem_id:4852710]。研究人员发现，每位患者的平均感染次数很低，大约为 $0.8$ 次。根据这个平均值，一个简单的泊松模型会预测大约 45% 的患者应该没有感染，这个数值是按 $\exp(-0.8)$ 计算出来的。然而，当他们查看自己的数据时，高达 70% 的患者没有感染。这个模型错得离谱。它无法解释这片巨大的空白，这种“无”的过度丰裕。

这不仅仅是一个数值错误；它表明我们关于计数如何产生的简单故事缺少了关键的一章。数据在向我们低语一个秘密：并非所有的零都是生而平等的。

### 两种“无”

解决这个难题所需的概念飞跃是认识到，我们数据中的“零”结果可能来自两个完全不同的来源。统计学家为这些来源起了非常直观的名字：**结构性零值**和**抽样零值**。

**结构性零值**是一个由于某种根本性的、确定性的原因而为零的结果。它是一个*必然*为零的“零”。而**抽样零值**则是一个纯粹偶然发生的零。事件*本可以*发生，但在我们的观察窗口内恰好没有发生。

想象一项关于儿童哮喘急性发作的研究 [@problem_id:4993585]。研究中的一些儿童可能根本没有哮喘。对于这些儿童来说，哮喘发作的次数根据定义就是零。他们不可能发作。这是一个结构性零值。研究中的另一些儿童确实患有哮喘，并且处于风险之中。然而，由于有效的药物治疗、很少接触触发因素，或者仅仅是运气好，他们可能在整个研究期间没有一次急性发作。他们的计数也是零，这是一个抽样零值。他们有可能发作，但他们没有。

我们简单的泊松模型之所以失败，是因为它只理解一种“无”：抽样零值。为了讲述一个更真实的故事，我们需要能够同时驾驭这两种“空”的语言的模型。这引导我们走向两个优美而强大的框架：[零膨胀模型](@entry_id:756817)和跨栏模型。

### 故事一：混合世界（[零膨胀模型](@entry_id:756817)）

**[零膨胀模型](@entry_id:756817)**讲述了一个关于由两个截然不同的潜在群体组成的总体的故事。想象一下，你研究中的每个个体都面临一个岔路口。

-   **路径1：** 以某个概率，我们称之为 $\pi$，个体属于一个“永不发生事件”组。对于这个组，结果总是且结构性地为零。这些是没有哮喘的儿童，或者是那些从未真正面临特定感染风险的住院患者 [@problem_id:4993542]。

-   **路径2：** 以剩余的概率 $1-\pi$，个体属于一个“风险”组。对于这个组，事件的数量由一个传统的[计数过程](@entry_id:260664)决定，比如我们熟悉的、均值为 $\mu$ 的泊松分布。

现在，如果我们观察到一个零，它可能来自哪里？它可能来自走路径1的个体（这以概率 $\pi$ 发生）。或者，它可能来自走路径2但其泊松过程碰巧产生零的个体（这以概率 $(1-\pi) \times \exp(-\mu)$ 发生）。

综合来看，在一个零膨胀泊松（ZIP）模型中观察到零的总概率是这两条路径之和 [@problem_id:4960728]：
$$
P(Y=0) = \underbrace{\pi}_{\text{路径1：结构性零}} + \underbrace{(1-\pi)\exp(-\mu)}_{\text{路径2：抽样零}}
$$
任何正数计数，比如 $k > 0$，只能来自路径2。所以，它的概率就是：
$$
P(Y=k) = (1-\pi) \frac{\exp(-\mu)\mu^k}{k!} \quad \text{当 } k > 0
$$
这种两部分结构赋予了模型所需的灵活性，使其能够“膨胀”零类别以匹配现实。这是两个世界的混合：一个确定性的世界（总是零）和一个随机性的世界（泊松过程）。当我们将[模型拟合](@entry_id:265652)到数据时，它的任务是找出混合概率 $\pi$ 和事件率 $\mu$ 最可能的值。在一个优美的逻辑展示中，如果我们给模型输入完全没有零的数据，它会正确地推断出没有证据表明存在“结构性零”组，并估计 $\hat{\pi}=0$，从而退化为一个简单的泊松模型 [@problem_id:4922797]。

### 故事二：门前的跨栏（跨栏模型）

**跨栏模型**讲述了一个略有不同但同样引人入胜的故事。它不是关于两种类型的人，而是关于每个人都要经历的一个两步过程。

-   **步骤1：跨栏。** 首先，有一个隐喻性的门或“跨栏”。每个个体都必须决定是否要越过它。这是一个二元选择：要么你有一个非零的计数，要么你有一个零的计数。假设零计数（未能越过跨栏）的概率是 $\phi$。

-   **步骤2：计数。** 当且仅当一个个体越过跨栏（以概率 $1-\phi$），他们才会进入一个“计数”阶段。这里的关键区别在于，这个[计数过程](@entry_id:260664)被禁止产生零。它是一个**零截断**分布。计数必须是 1、2、3 或更多。

在这个故事中，所有的零都是在步骤1一次性产生的。该模型优雅地将“是否”发生事件的问题与“发生多少次”事件的问题分离开来 [@problem_id:4905382]。

一个完美的例子是为慢性疼痛患者的阿片类药物处方配药次数建模 [@problem_id:4993542]。所有患者都可能处于风险之中，但他们必须首先做出是否开始治疗的决定。这个决定就是跨栏。如果他们不开始，配药次数为零。如果他们确实开始，配药次数必须至少为一。产生零的过程与产生正计数的过程在根本上是不同的。

一段令人惊讶而优雅的数学揭示了这两个故事之间的深刻联系。在观察到正计数（$Y>0$）的条件下，[零膨胀模型](@entry_id:756817)和跨栏模型都以完全相同的方式描述这些正计数的分布：使用一个零截断计数分布 [@problem_id:4993542]。这两个框架的全部区别归结于它们如何构建零的概率。

### 剧情深入：过离散

为了让我们的侦探故事更有趣，还有另一个可能导致零值过多的“罪魁祸首”：**过离散**。这是一个通用术语，指数据中的方差远大于均值，这直接违反了泊松模型的核心假设（方差 = 均值）[@problem_id:3124073]。

零膨胀是过离散的一个原因，但不是唯一的原因。另一个主要原因是**未观测到的异质性**。这意味着即使在“风险”组中，个体也并非完全相同。有些人可能天生事件发生率高，而另一些人则天生事件发生率低。这种个体间隐藏的变异性拉伸了分布，增加了方差，同时也顺便增加了零计数的概率。

处理这种情况的经典模型是**负二项（NB）模型**。与 ZIP 模型不同，NB 模型并不提出两种不同类型的人。相反，它讲述了一个单一总体的故事，其中每个人都有自己的个人事件率，而这些率本身遵循一个分布。

这就提出了一个真正的挑战。当我们看到过多的零和高方差时，哪个故事是正确的？是“风险”和“非风险”个体的混合（一个 ZIP 故事）？还是一个具有不同风险水平的“风险”个体组成的单一总体（一个 NB 故事）？[@problem_id:4852710]。

### 选择正确的叙事

选择正确的模型既是一门科学，也是一门艺术。它关乎找到一个不仅在统计上合理，而且在科学上可信的叙事。

首先，我们听从科学。在[零膨胀模型](@entry_id:756817)和跨栏模型之间的选择应由潜在机制指导。如果你认为你的数据中包含一个对事件具有结构性免疫的群体（比如寄生虫研究中未被感染的个体），那么零膨胀的故事就很自然地契合。如果你认为在任何事件发生之前都需要一个激活或启动步骤（比如开始药物治疗），那么跨栏的故事就更有说服力 [@problem_id:4993542]。

其次，我们让数据说话。我们可以使用统计工具正式比较这些不同的、非嵌套的故事。我们可以同时拟合 NB 模型和 ZIP 模型，看看哪一个能更好地解释观察到的零的比例 [@problem_id:4852710]。我们可以使用更正式的方法，如**Vuong 检验**，它让两个模型相互竞争，看哪一个更接近真相 [@problem_id:4978337]，或者使用**AIC**和**BIC**等[信息准则](@entry_id:636495)，它们奖励拟合数据好的模型，但惩罚过于复杂的模型 [@problem_id:4815044]。

这项细致工作的最终回报是对世界更丰富的理解。一个简单的泊松回归可能会告诉你一种新药降低了感染率。但一个[零膨胀模型](@entry_id:756817)可能会揭示更深层次的东西 [@problem_id:4967732]。它可能会显示该药物有两种效果：它降低了患者易受感染的概率（通过改变 $\pi$ 参数），*并且*它减少了那些确实易感人群的感染次数（通过改变 $\mu$ 参数）。通过选择一个讲述正确故事的模型，我们从仅仅描述发生了什么，转向了理解它为什么发生的根本机制。

