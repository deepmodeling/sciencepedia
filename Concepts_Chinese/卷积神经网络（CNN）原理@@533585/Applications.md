## 应用与跨学科联系

如果说[物理学史](@article_id:347926)给我们带来了一条教训，那就是大自然常常反复使用同样简单而优雅的思想。支配苹果下落的[万有引力](@article_id:317939)定律，同样也维系着行星的轨道。[波动力学](@article_id:345574)的原理既能描述电子，也能描述[光子](@article_id:305617)。正是这种对统一原理的探寻，构成了科学探索的核心。在人工智能的世界里，[卷积神经网络](@article_id:357845)（CNN）就代表了这样一种原理。

CNN的核心建立在一个极其简单而强大的思想之上：复杂的模式可以通过首先识别简单的局部特征，然后将它们组装成越来越复杂的整体来理解。CNN学习识别人脸，不是通过一次性记住整张脸，而是首先学习发现边缘，然后将这些边缘组合成纹理、曲线以及像眼睛和鼻子这样的简单形状，最后将这些部分[排列](@article_id:296886)成一张脸。这种层次化的、从局部到全局的策略不仅仅是一个巧妙的编程技巧；它反映了我们自身视觉皮层的工作方式。

真正非凡之处，也是我们本章将要探讨的，是这个思想——这种“局部模式的语言”——并不仅限于猫和狗的图片。它是一种我们正在广泛得惊人的科学学科中发现的通用语言。从窥探人体内部、解码我们基因的语言，到理解时间的节奏和计算的基本限制，不起眼的CNN提供了一个强大而统一的视角。让我们踏上一段旅程，看看这一个简单的思想[能带](@article_id:306995)我们走多远。

### 窗中世界：视觉及其超越

我们旅程最自然的起点是计算机视觉，这是CNN首次取得惊人成功的领域。当你看着一幅图像时，你的大脑能毫不费力地识别出其中的物体。对计算机来说，这是一项艰巨的任务。CNN通过在图像上滑动小的“窗口”（即滤波器）来解决这个问题，寻找特定的局部模式。

但如果你想找到一个大的物体，比如一辆公共汽车呢？一个寻找轮胎纹理或车窗反光的小滤波器是看不到整辆车的。网络需要一个足够大的**[感受野](@article_id:640466)**——它在输入图像上的视野——才能看到物体的全貌。如果感受野比公共汽车小，网络就像一个人试图透过邮寄用的纸筒来识别一头大象，他能看到褶皱的皮肤，却无法把握整个动物。

这引出了一个关键的设计原则：[网络架构](@article_id:332683)必须与它需要找到的物体的尺度相匹配。一种在不导致计算成本成比例爆炸的情况下扩大[感受野](@article_id:640466)的巧妙方法是使用**[扩张卷积](@article_id:640660)**。扩张滤波器不是观察相邻的像素，而是观察间隔开的像素，从而有效地“拉伸”了它的视野。这使得网络仅用几层就能获得一个大的[感受野](@article_id:640466)，使其能够更好地检测和定位大型物体 [@problem_id:3160462]。

这种分析[空间模式](@article_id:360081)的思想自然地从单个图像扩展到图像序列——视频。视频仅仅是一堆增加了时间维度的图像。通过将我们的二维滤波器（高、宽）“膨胀”为三维滤波器（高、宽、时间），CNN不仅可以学习检测空间中的模式，还可以检测运动中的模式。它可以学会识别挥手的姿势或抛出球的弧线。当然，这个额外的维度代价高昂。处理视频的计算密集度远超处理图像。为了使其可行，工程师们采用了诸如使用时间步长之类的策略，即网络不处理每一帧，而是跳过几帧，从而在不陷入每个细节的情况下捕捉运动的要点 [@problem_id:3198671]。

### 窥探内部：从医学扫描到细胞机器

让CNN能够看到我们周围世界的同样原理，也让它能够看到人体内部。医学图像，无论是来自CT扫描仪、MRI还是[X射线](@article_id:366799)，本质上都只是像素值的网格。CNN可以学习扫描这些图像，以发现疾病的细微特征——肺部肿瘤的微弱阴影，或脑萎缩的典型模式。

许多医学数据集，如CT扫描，本身就是三维的。这就提出了一个有趣的架构选择。我们应该将数据作为二维切片的堆栈来处理（[计算成本](@article_id:308397)更低），还是应该使用能够一次性处理整个体积的真正三维CNN？答案取决于数据本身。如果切片之间的分辨率非常低（一种称为**各向异性**的现象），那么一次只看一个切片的二维网络就无法获得相邻切片中发生的情况的信息。在试图精确定位边界的三维位置时，它可能会犯下大错。然而，一个真正的三维网络可以跨切片观察。它的滤波器可以学会在低分辨率维度上“[插值](@article_id:339740)”信息，从而达到更高的准确度 [@problem_id:3136240]。这是一个绝佳的例子，说明了成像设备的物理特性和数据的结构必须如何为网络设计提供信息。

当我们推动[医学成像](@article_id:333351)的边界时，我们会遇到现实世界中的实际限制。一张高分辨率的医学图像可能太大，无法装入即使是功能强大的图形处理单元（GPU）的内存中。这是否意味着我们必须放弃？完全不是。巧妙的工程设计提供了前进的道路。我们可以在大图像的较小随机图块上训练网络。然后，在测试时，我们将训练好的网络在整个图像上滑动，一次为一个图块生成预测，并将它们拼接在一起形成一张完整的图。然而，这引入了一个新问题：**拼接伪影**，即图块边缘的预测不完全匹配。两种有原则的解决方案应运而生：一种是处理重叠的图块并仔细混合重叠区域的预测；另一种是处理一个更大的图块，但只保留预测的“有效”中心部分，在这里[感受野](@article_id:640466)没有看到任何人为边界 [@problem_id:3198588]。理论模型与硬件限制之间的这种相互作用，正是深度学习成为一门真正工程学科的地方。

### 时间与生命的节奏：一维卷积的力量

发现局部模式的思想并不仅限于图像和体积的二维或三维空间。当应用于一维序列时，它同样强大，而一维序列在自然界中无处不在。

考虑一个时间序列，比如一段音频录音或一首音乐。是什么让音乐听起来像音乐？是模式：构成旋律的直接音符序列，以及赋予一首作品情感弧线的更长程的和声进行。一个简单的CNN可能能捕捉到局部的旋律，但会错过和声。为了捕捉这些[长程依赖](@article_id:361092)关系，我们需要一个非常大的感受野。最优雅的解决方案之一是使用**因果、扩张一维卷积**。“因果”意味着在时间$t$的预测只能依赖于过去（$\leq t$）的输入。通过每层指数级地增加扩张因子，网络的[感受野](@article_id:640466)可以指数级增长。一个只有几层的网络，就可以将现在播放的音符与数百或数千个时间步之前出现的音符联系起来，同时保持计算效率 [@problem_id:3175434] [@problem_id:3175363]。这一架构突破是生成逼真人类语音和音乐的关键。

也许最深刻的序列是编码生命本身的序列：基因组。DNA序列是一条由四种字母组成的字母表$\{A, C, G, T\}$写成的长字符串。在这个字符串中有基序——短的、重复的模式，作为细胞机器的信号：“从这里开始读取”，“在这里结合蛋白质”，“这是一个基因”。一维CNN是基因组学的天然工具；它的滤波器可以学习充当“基序检测器”，沿着基因组滑动，并在发现感兴趣的模式时激活。

我们甚至可以设计多分支架构，灵感来自Inception网络，其中具有不同核大小的并行卷积可以同时寻找不同长度的基序 [@problem_id:3130781]。一个小核可以找到一个3个字母的起始密码子，而一个大核可以发现一个10个字母的蛋白质结合位点。这个思想直接扩展到蛋白质组学，其中可以训练CNN沿着蛋白质的[氨基酸序列](@article_id:343164)滑动，并根据是否存在适合被药物靶向的某些结构基序来计算“可成药性”得分 [@problem_id:2382331]。

但生物学可能会增加一些挑战我们简单模型的复杂性。例如，DNA中的字母'C'（胞嘧啶）可以被化学修饰（甲基化）成一种[新形式](@article_id:378361)'5mC'，这可以极大地改变基因的调控方式。如果我们希望我们的网络理解这一点，我们必须将我们的字母表从4个字母扩展到5个字母。这不仅仅是增加一个输入通道。它可能会破坏基本的对称性。“反向互补性”规则（$A \leftrightarrow T, C \leftrightarrow G$），一个通常被构建到基因组CNN中的关键生物学对称性，不再作为一个简单的[一对一映射](@article_id:363086)成立，因为$C$和$5mC$都与$G$互补。这需要更复杂的[网络设计](@article_id:331376)，再次表明深入的领域知识对于构建有意义的模型至关重要 [@problem_id:2382323]。

### 统一原理：效率与基本限制

随着我们将CNN应用于日益复杂和资源受限的问题，我们被迫更深入地思考效率以及我们工具的基本限制。我们不能永远简单地构建越来越大的网络。

这导致了一种更具原则性的网络设计方法。以在低功耗可穿戴设备上分析心电图（ECG）信号的挑战为例。我们需要高准确性，但我们也有严格的电池预算。我们如何构建最好的网络？我们不必猜测是让网络更深、更宽，还是使用更高的输入分辨率（采样率），而是可以使用**[复合缩放](@article_id:638288)**。这涉及到以一种平衡、协调的方式缩放所有三个维度——深度、宽度和分辨率。通过这样做，我们可以找到一个在给定能量预算下最大化性能的最优架构。这种方法优美地综合了来自深度学习、信号处理（如规定了最小采样率的奈奎斯特定理）和现实世界硬件约束的原理 [@problem_id:3119642]。

最后，让我们反思一下局部性这一核心原理本身。CNN的力量来自于其局部操作。其固有的局限性是什么？想象一下试图教一个CNN解决一个迷宫。网络被给予迷宫的图像，其任务是确定是否存在一条从起始单元格$S$到目标单元格$G$的路径。为了让位置$G$的最终[神经元](@article_id:324093)做出正确决策，信息必须从单元格$S$一直传播过来。由于标准CNN在每层只在相邻单元格之间传递信息，所需的层数必须至少是迷宫中$S$和$G$之间最短路径的长度。要为*任何*两点解决这个问题，网络深度必须与迷宫的**直径**——迷宫中任意两点之间最长最短路径——相关。这在[网络架构](@article_id:332683)和问题的内在几何复杂性之间提供了一个惊人而直观的联系，揭示了用纯局部规则处理信息的基本限制 [@problem_id:3175416]。

从视觉到基因组学，从医学到音乐，[卷积神经网络](@article_id:357845)已经证明自己是一种功能惊人多样的工具。它在如此多不同领域的成功，证明了一个简单、统一思想的力量：在一个复杂的世界里，通过局部寻找模式并层级化地建立理解，可以理解很多东西。这是自然本身似乎偏爱的一个原理的计算回响，它的故事还远未结束。