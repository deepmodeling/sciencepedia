## 应用与跨学科联系

既然我们已经熟悉了化学信息学的基本原理——即把分子编码成计算机能理解的语言的艺术——我们就可以开始一段旅程，去看看这些思想在实践中的应用。正是在这里，指纹和相似性分数的抽象之美转化为切实的进展，彻底改变了从医学到分子生物学的各个领域。我们将看到，化学信息学不仅仅是一门描述性科学；它是一个创造性和预测性的引擎，让我们能够有目的、有洞察力地在广阔无垠、近乎无限的可能分子宇宙中航行。

我们将追随一种现代疗法的生命周期，从它在计算机中的最初构想到其安全性和有效性的严格评估。在此过程中，我们将见证这些工具如何赋予科学家力量，使他们能够做出更明智、更快速、更理性的决策。最后，我们将把目光投向药学之外，看看化学信息学的核心理念是何等普适，以至于它们正在帮助我们解码生命本身的蓝图。

### 以相似性为指引：导航化学宇宙

化学信息学中最基本的公理是*相似性-属性原理*：结构相似的分子很可能表现出相似的生物和物理性质。这个简单而深刻的思想是我们导航化学空间的指南针。但要使用指南针，我们需要一张地图和一种测量距离的方法。正如我们所学到的，像ECFP这样的[分子指纹](@entry_id:172531)充当我们地图上的坐标，而像Tanimoto系数这样的度量标准则提供了“距离”（或者更准确地说，相似性）的量度。

想象一下[药物重定位](@entry_id:748682)（[老药新用](@entry_id:748683)）的任务——为现有的、已批准的药物寻找新的用途。这是一个有吸[引力](@entry_id:189550)的策略，因为这些分子已经在人体中被证明是安全的。但是，我们如何从成千上万种已批准的药物中猜测哪一种可能对一种新疾病有效呢？我们可以从一个已知对我们的疾病靶点有活性的分子开始，然后在现有药物库中搜索结构相似的化合物。Tanimoto系数给了我们一个数字，一个对这种相似性的定量度量 [@problem_id:5011481]。一个非常高的分数（例如，$T_c \gt 0.85$）可能表示一个紧密的类似物，也许是来自同一药物类别的分子。但真正的魔力往往发生在中等相似性区间。一个例如0.5到0.7的分数可能是一个“甜蜜点”，表明两个分子共享与靶点结合所必需的关键药效团特征，但拥有不同的核心结构或“骨架”。这就是**骨架跃迁**的精髓：一种发现结构新颖但保留了所需生物活性的化合物的策略，这可能带来新的专利或改进的性质 [@problem_id:5011481]。

同样的原理也帮助我们管理[高通量筛选](@entry_id:271166)（HTS）活动产生的大量输出。一个HTS实验可以测试数百万种化合物，产生数千个初始“命中物”。不可能对所有命中物进行研究。我们如何对这个列表进行分类，以挑选出几百个进行后续研究？我们必须选择一个不仅有效而且结构多样的子集。我们不想把资源浪费在来自同一化学家族的十个几乎完全相同的分子上。在这里，化学信息学提供了一个合理的工作流程。通过用指纹表示每个命中物，我们可以计算一个Tanimoto[距离矩阵](@entry_id:165295)（$d = 1 - T_c$），并使用[层次聚类](@entry_id:268536)将命中物分组为结构相似的家族。然后，我们可以从每个聚类中选择几个代表——也许是活性最强的成员和一个结构上居中的“中心点”（medoid）——以确保我们选择的子集覆盖了广泛的化学骨架。这个策略通过智能地平衡化学多样性的探索和初始活性数据的利用，最大化了我们找到成功候选药物的机会 [@problem_id:4938907]。

### 神谕的崛起：化学中的[预测建模](@entry_id:166398)

超越简单的相似性搜索，我们可以构建复杂的机器学习模型，充当“神谕”，直接从[分子结构预测](@entry_id:268149)其性质。这个领域被称为[定量构效关系](@entry_id:175003)（QSAR）建模。给定一组具有已知活性的分子，我们可以训练一个模型来学习[分子指纹](@entry_id:172531)与其生物效应之间错综复杂的联系。

然而，一位明智的科学家，就像任何神谕的明智使用者一样，必须问：“我何时可以信任这个预测？”一个[机器学习模型](@entry_id:262335)只有在其“[适用域](@entry_id:172549)”（AD）——即由其训练数据定义的化学空间区域——内才是可靠的。要求一个仅在小的、类似阿司匹林的分子上训练的QS[AR模型](@entry_id:189434)来预测一个大的、复杂的类固醇的性质，是一种盲目信仰的行为，是对未知领域的外推。我们可以量化这种信任度。对于任何新分子，我们可以计算它与模型[训练集](@entry_id:636396)中最近邻居的平均Tanimoto相似度。如果这个“适用性分数”太低，就表明该分子是一个异常值，模型的预测应谨慎对待，或者根本不应使用。定义和尊重[适用域](@entry_id:172549)是负责任建[模的基](@entry_id:156416)石，它能防止我们被听起来自信但毫无根据的预测所误导 [@problem_id:3854361]。

当我们将多个目标结合起来时，[预测建模](@entry_id:166398)的真正威力才得以体现。一种完美的药物不仅要能与其靶点结合，还必须是可溶的、代谢稳定的、无毒的等等。这是一个[多目标优化](@entry_id:637420)问题。化学信息学使我们能够构建优雅的复合[评分函数](@entry_id:175243)来捕捉这种复杂性。我们可以设计一个评分，它奖励与我们靶蛋白的三维药效团良好匹配的分子，同时惩罚与已知有毒化合物数据库过于相似的分子。通过调整这些奖励和惩罚项的权重，我们可以理性地引导我们寻找在功效和安全性之间达到最佳平衡的分子 [@problem_id:2414197]。

### 铸造更优良的工具：与人工智能的协同作用

正在进行的人工智能革命，特别是[深度学习](@entry_id:142022)的革命，为化学信息学注入了强大的新能力。分子不仅可以表示为指纹，还可以表示为序列（SMILES字符串），或者最自然地，表示为用于[图神经网络](@entry_id:136853)（GNNs）的图。

在使用基于文本的SMILES字符串时，出现了一个有趣的挑战。一个单一的分[子图](@entry_id:273342)可以写成许多不同但同样有效的SMILES字符串。我们如何教神经网络这些不同的字符串都指向同一个对象？答案在于[数据增强](@entry_id:266029)。在训练期间，我们不只为每个分子向模型展示一个“规范”的SMILES，而是可以展示多个随机生成的、有效的SMILES，所有这些都与相同的活性标签配对。这个简单的技巧迫使模型学习到，重要的是底层的分子结构，而不是[文本表示](@entry_id:635254)的具体选择。这个过程可以通过机器学习的Vicinal Risk Minimization原理得到优雅的解释，它使最终的模型更具鲁棒性，也更具化学意识 [@problem_id:4602679]。此外，得益于像[詹森不等式](@entry_id:144269)这样的数学原理，我们甚至可以在测试时通过对查询分子的几个随机化SMILES的输出进行平均，来改善模型的预测。

[图神经网络](@entry_id:136853)提供了一种更自然的范式，直接将分子视为它们本来的图结构。这开启了一个新的理论探究层面。例如，我们应该构建包含所有原子（包括氢原子）的显式分子图吗？还是使用“隐式”表示就足够了，即氢原子仅作为每个重原子上的一个特征来计数？在GNN的某些常见条件下，比如使用求和聚合，可以证明这两种表示在[表达能力](@entry_id:149863)上理论上是等价的。一个精心设计的、使用更简单的隐式氢原[子图](@entry_id:273342)的GNN，可以学会完美模仿使用更复杂的显式图的模型的行为 [@problem_id:2395470]。这是一个计算优雅之美的绝佳例子，表明更复杂的表示并不总是更好。

深度学习的一个主要批评是“黑箱”问题。幸运的是，我们可以设计方法使这些模型具有[可解释性](@entry_id:637759)。如果一个GNN预测某个异构体比另一个更易溶，我们可以问它*为什么*。通过计算特定的基于图的度量，我们可以将模型的推理转化为化学直觉。例如，我们可以测量最大的连续非极性碳基碎片的尺寸——作为“疏水性区域”的代理——或者极性杂原子到分子外围的平均距离——作为“溶剂暴露”的代理。如果更易溶的异构体具有更小的疏水性区域和更多暴露的极性基团，我们就得到了一个化学上合理的解释。我们甚至可以使用归因方法来计算GNN“最关注”哪些原子，以确认其推理是否与我们的化学理解一致 [@problem_id:2395452]。

### 警惕的守护者：确保分子安全

也许化学信息学最关键的作用是确保新化学实体的安全性。不安全的药物就不是药。

不良反应的一个主要来源是“脱靶”结合，即药物与其预期靶点之外的蛋白质发生相互作用。[相似性原理](@entry_id:753742)提供了一个强大的早期预警系统。如果一个有前途的候选药物在结构上与已知会引起特定副作用的另一化合物相似，我们就应该提高警惕。我们可以使用概率语言来形式化这种怀疑。与一个已知的脱靶结合物具有高Tanimoto相似度提供了强有力的证据，通过[贝叶斯更新](@entry_id:179010)，这会增加我们的候选药物也具有这种不良特性的后验概率。这使我们能够在发现过程的早期标记并降低风险化合物的优先级，从而节省大量时间和资源 [@problem_id:5036593]。

[药物发现](@entry_id:261243)中另一个普遍存在的问题是存在“滋扰”化合物，它们通过非特异性机制（如聚集或[化学反应性](@entry_id:141717)）在许多分析中表现出活性。这些泛分析干扰化合物（PAINS）是筛选活动的祸根，常使研究人员走入代价高昂的死胡同。化学信息学提供了工具，可以充当警惕的守护者，防范这些捣乱分子。通过对已知PAINS和良性分子的大型数据库进行统计分析，我们可以识别出在PAINS集合中显著过表达的特定子结构。使用像Fisher[精确检验](@entry_id:178040)这样的严格方法，并通过像[Benjamini-Hochberg](@entry_id:269887)方法这样的程序对数千个子结构的测试进行校正，我们可以建立一个经过统计验证的“PAINS警报”库 [@problem_id:3847992]。然后，这个库可以用来过滤我们的HTS命中物列表或生成模型的输出，去除含有这些问题碎片的化合物。这种过滤必须智能地进行，通常作为一个优化问题来处理，以最大化去除潜在的PAINS，同时最小化整体化学多样性的损失 [@problem_id:4938907] [@problem_id:3847992]。

### 药盒之外：跨学科前沿

化学信息学的概念工具箱是如此强大和基础，以至于其影响力远远超出了[药物发现](@entry_id:261243)的范畴。ECFP的核心策略——通过枚举其局部的、规范化的子结构来表征一个对象——是科学中一个反复出现的模式。

让我们考虑一个来自看似遥远的领域的问题：基因组学。增[强子](@entry_id:198809)是DNA上的一段短区域，蛋白质可以与之结合，从而增加特定基因转录的可能性。我们如何识别增[强子](@entry_id:198809)DNA序列中能够预测其活性的“基因组子结构”？我们可以与化学信息学做一个直接的类比。DNA序列是一个一维图。“局部子结构”是一个短的、重叠的子序列，即*k*-mer。正如我们必须将分子子结构规范化以处理对称性一样，我们也必须将我们的*k*-mer规范化，以考虑DNA的双链性质（即，一个序列与其反向互补序列是等价的）。

通过使用“*k*-mer包”表示法对大量DNA序列进行指纹分析，并训练一个[线性模型](@entry_id:178302)，我们可以发现哪些*k*-mer与高增[强子](@entry_id:198809)活性相关。学习到的模型权重直接指向这些关键的基因组基序。这是将ECFP哲学从原子和[化学键](@entry_id:145092)的语言，优美而直接地转化到[核酸](@entry_id:164998)语言中的一个范例，使我们能够建立可解释的[基因调控模型](@entry_id:749822) [@problem_id:2399996]。

这个强有力的类比揭示了科学思想潜在的统一性。同样一个抽象的思想——即复杂对象可以通过其组成部分的统计数据来理解——为解开合成分子世界和我们自身遗传密码世界的秘密提供了一把钥匙。因此，化学信息学不仅仅是化学家的工具；它是一种思维方式，丰富了我们对宇宙分子结构的理解。