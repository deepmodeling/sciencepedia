## 引言
[全基因组](@entry_id:195052)关联研究（GWAS）的出现曾预示着将解开复杂性状的遗传蓝图，然而最初的发现却令人困惑。对于像身高这样具有高遗传力的性状，已识别出的遗传变异仅能解释预期遗传影响中极小的一部分，这催生了著名的“[遗传力缺失](@entry_id:175135)”问题。这一难题迫使遗传学领域发生了一次范式转变，人们开始认识到，大多数复杂性状是高度多基因的，受到成千上万个遗传变异的微小、集体效应的影响，而非少数几个主要变异。为了捕捉这种分布式的遗传结构，[SNP遗传力](@entry_id:148453)的概念应运而生。

本文探讨了[SNP遗传力](@entry_id:148453)的理论、方法和意义。在第一部分**原理与机制**中，我们将解构[遗传力](@entry_id:151095)本身的概念，区分其与传统的基于谱系的估计值，并探索为估计所有常见SNP的总遗传贡献而设计的创新统计方法——GCTA/LMM和LD分数回归。我们还将直面这些方法的关键挑战和局限性，例如群体结构造成的混杂。第二部分**应用与跨学科联系**将展示[SNP遗传力](@entry_id:148453)如何用于获得生物学见解，从绘制整个基因组的遗传结构、发现不同疾病间的共享遗传学，到其在构建多基因风险评分中的作用以及随之而来的深远伦理考量。

## 原理与机制

要真正掌握[SNP遗传力](@entry_id:148453)的含义，我们必须首先踏上一段旅程，就像物理学家为理解光的本质所做的那样——光有时看起来像粒子，有时又像波。遗传力也是如此，根据你观察它的方式，它会呈现出不同的面貌。我们的旅程将从家族相似性的简单概念，走向驱动现代基因组学的复杂统计机器，不仅揭示答案，更揭示问题本身的美妙之处。

### 性状的灵魂：解构遗传力

为什么子女会像父母？简单的答案是“基因”。但是，是哪些基因，又是如何作用的？让我们想象一个性状，比如身高。我们在一个群体中看到的身高总变异，即我们所说的**[表型方差](@entry_id:274482)（$V_P$）**，是遗传影响（$V_G$）和环境因素（$V_E$）的复杂组合。

乍一看，人们可能会将[遗传力](@entry_id:151095)定义为变异中由遗传决定的比例：$H^2 = V_G / V_P$。我们称之为**[广义遗传力](@entry_id:267885)**。它告诉我们个体间的遗传差异在多大程度上导致了他们的表型差异。尽管这听起来很全面，但它在预测方面有一个关键的局限性。总遗传方差$V_G$本身是一个复合体。它包括简单的**加性效应（$V_A$）**，即每个基因变异对性状贡献一个微小、可预测的量。但它也包括更复杂的非加性效应，如**显性效应（$V_D$）**（同一基因上的[等位基因相互作用](@entry_id:142611)）和**上位性效应（$V_I$）**（不同基因上的[等位基因相互作用](@entry_id:142611)）。

可以这样想：加性效应就像单个的乐高积木。如果父母遗传下来一块“高”的积木，它就能可靠地为孩子增加一点身高。然而，显性和上位性效应则像是特定的、复杂的乐高作品。父母体内一种精美的积木组合可能会产生很大的效应，但由于这些组合在繁殖过程中被拆分和重组，这个特定的作品并不会作为一个整体遗传下来。只有单个的积木会被遗传。

这就是为什么数量遗传学家执着于一个不同的量：**[狭义遗传力](@entry_id:262760)（$h^2$）**，其定义为仅由*加性*遗传方差引起的[表型方差](@entry_id:274482)比例：

$$h^2 = \frac{V_A}{V_P}$$

这个量才真正捕捉了亲属间可预测的相似性，并决定了群体对选择的反应。在预测意义上，它是遗传力中“可遗传”的部分。当我们构建像多基因风险评分（PRS）这样的工具来预测疾病风险，或者讨论全基因组关联研究（GWAS）能够找到的遗传成分时，我们基本上谈论的都是$h^2$ [@problem_id:5071830]。[双生子研究](@entry_id:263760)通过比较共享100%基因的同卵双胞胎与共享约50%基因的异卵双胞胎，可以估计总的遗传贡献$H^2$。但现代基因组学的追求，主要是在寻找加性方差$V_A$。

### [遗传力缺失](@entry_id:175135)之谜

随着21世纪初GWAS的出现，科学家们欣喜若狂。我们终于有了工具来寻找与[复杂性状](@entry_id:265688)相关的特定DNA变异——[单核苷酸多态性](@entry_id:173601)（SNP）。最初的策略很简单：找到统计关联最强的SNP，即“最显著的关联位点”，然后看它们能解释多少[遗传力](@entry_id:151095)。

结果令人困惑。对于像身高这样的性状，家族研究早已表明其[狭义遗传力](@entry_id:262760)（$h^2$）约为0.80。然而，当科学家们计算最初发现的少数几个与身高相关的SNP的贡献时，它们仅解释了方差的极小一部分——也许是5%。这个巨大的差异后来以“**[遗传力缺失](@entry_id:175135)**”问题而闻名。

我们可以用一个简单的假设性例子来说明这一点。假设一个性状的谱系遗传力为0.65。一项GWAS识别出三个SNP。使用单个SNP贡献方差的标准公式——$V_{A,i} = 2p_i(1-p_i)\alpha_i^2$，其中$p_i$是[等位基因频率](@entry_id:146872)，$\alpha_i$是其效应量——我们可能会发现，这三个最显著的SNP，即使效应相对较大，总共也只解释了约6%的总[表型方差](@entry_id:274482)。“缺失”的部分将是一个惊人的$0.65 - 0.06 = 0.59$ [@problem_id:1934960]。另外90%的遗传故事可能藏在哪里呢？

这个难题促使思想发生了深刻的转变。最初的模型——复杂性状由少数具有大效应的常见变异驱动——显然是错误的。答案必须更加微妙。也许遗传力根本没有“缺失”，而是如此稀疏地分布在整个基因组中，以至于我们的方法无法看到它。也许它是成千上万变异的集体低语，而非少数几个变异的呐喊。

### 集体努力：来自[全基因组](@entry_id:195052)的[遗传力](@entry_id:151095)

这一新视角催生了**[SNP遗传力](@entry_id:148453)（$h^2_{\mathrm{SNP}}$）**的概念：即并非由少数几个显著的SNP，而是由基因分型芯片上*所有*常见SNP共同解释的[表型方差](@entry_id:274482)比例。其基础理论是**[无穷小模型](@entry_id:181362)**，该模型假定对于一个[复杂性状](@entry_id:265688)，存在成千上万个致病变异，每个变异的效应都微乎其微。为了估计这个量，人们发明了两种主要的统计方法，每种方法都有其精妙的逻辑。

#### 我们都是（远房）亲戚：GCTA/LMM方法

第一种方法，通常称为GCTA或GREML，建立在一个简单而深刻的理念上：即使是群体中“无亲缘关系”的个体，也因共同的远祖而共享基因组片段。我们可以利用数十万个SNP，为任意一对个体计算出他们整体遗传相似度的[精确度](@entry_id:143382)量。这被记录在一个**基因组关系矩阵（GRM）**中，我们称之为$G$。

其逻辑非常直接：如果一个性状是可遗传的，那么两个恰好在遗传上更相似（在GRM中有更高的值）的个体，在表型上也应该更相似。[线性混合模型](@entry_id:139702)（LMM）通过将总[表型方差](@entry_id:274482)（$V_P$）划分为两个部分来形式化这一点：

1.  一个遗传成分$\sigma_g^2$，其在群体中的协方差结构由GRM，$G$，来描述。
2.  一个环境成分$\sigma_e^2$，它被假定为随机噪声（其协方差是[单位矩阵](@entry_id:156724)，$I$）。

表型向量$y$的总协方差变为$V = \sigma_g^2 G + \sigma_e^2 I$。通过观察实际的表型相似性模式，并将其与$G$中的遗传相似性模式进行比较，该方法可以估计出$\sigma_g^2$和$\sigma_e^2$的值。[SNP遗传力](@entry_id:148453)则简单地是这个比率 [@problem_id:2838203]：

$$\widehat{h}^2_{\mathrm{SNP}} = \frac{\widehat{\sigma}_g^2}{\widehat{\sigma}_g^2 + \widehat{\sigma}_e^2}$$

这种方法实质上是进行了一次[全基因组](@entry_id:195052)范围的回归，将所有SNP的聚合效应视为一个单一的随机变量，其影响由研究中所有个体之间的遗传关系所介导。

#### 因关联而定论：LD分数回归方法

第二种方法，**连锁不平衡（LD）分数回归（LDSC）**，在某些方面甚至更为神奇，因为它仅使用GWAS的汇总统计数据（如Z-score或$\chi^2$统计量）就可以估计[SNP遗传力](@entry_id:148453)，而无需访问个体水平的遗传数据。

这里的洞见更为精妙。在GWAS中，一个SNP的关联统计量（$\chi^2$）可能很大，原因有二：（1）它确实是一个致病变异，或者（2）它本身不是致病变异，但由于**[连锁不平衡](@entry_id:146203)（LD）**——即邻近位点上的等位基因倾向于一同遗传——而位于一个致病变异附近并“搭上”其信号的便车。

LDSC用一个称为**LD分数（$\ell_j$）**的数值来量化每个SNP的这种“搭便车”潜力。SNP $j$的LD分数是通过将其与基因组邻域中所有其他SNP的平方相关性（$r^2$）相加计算得出的：$\ell_j = \sum_k r_{jk}^2$。位于“高LD”区域、与许多其他SNP相关的SNP将具有较高的LD分数。

这里的关键思想是：在一个多基因模型下，成千上万的致病变异散布在整个基因组中，一个具有较高LD分数的SNP仅仅是更有可能与这些致病变异中的一个或多个处于LD状态。因此，平均而言，我们期望它的GWAS关联统计量会更高。这导出了一个优美简洁的线性关系 [@problem_id:5041660]：

$$E[\chi_j^2] = \left(\frac{N h^2_{\mathrm{SNP}}}{M}\right) \ell_j + \text{截距}$$

其中$N$是研究规模，$M$是SNP的数量。通过将GWAS中观察到的$\chi^2$统计量对每个SNP预先计算的LD分数进行回归，直线的斜率就直接给出了[SNP遗传力](@entry_id:148453)的估计值！

### 科学家的怀疑：可能会出什么问题？

这些方法功能强大，但像任何测量工具一样，它们有其局限性，并且可能被误导。一个好的科学家必须总是问：“我的假设是什么？当它们被违反时会发生什么？”

#### 祖源的阴影

困扰遗传学研究的最大幽灵之一是**群体结构**。想象一下，在一个同时有大量欧洲和东亚血统人群的城市里研究糖尿病。假设东亚人群由于环境或文化原因，其饮食对糖尿病有保护作用。他们与欧洲人群相比，许多SNP的频率也不同。在这个混合样本中进行的GWAS会发现无数与糖尿病相关的SNP，不是因为它们在生物学上是致病的，而仅仅是因为它们与祖源相关，而祖源又与真正的致病因素（饮食）相关。

这是一种混杂形式，我们的[遗传力](@entry_id:151095)估计方法必须面对它。有趣的是，GCTA/LMM和LDSC以不同的方式处理这个问题 [@problem_id:2394658]。

*   **GCTA/LMM**通过在模型中包含明确的协变量来直接解决这个问题，这些协变量通常是通过基因型矩阵的前几个主成分来衡量的祖源。这试图“吸收”掉任何由广泛的祖源差异引起的[表型方差](@entry_id:274482)，只留下剩余的方差被划分为遗传和环境成分 [@problem_id:5034209]。

*   **LDSC**采用了一种更巧妙、间接的方法。其逻辑是，来自群体结构的混杂应该会以相似的程度夸大*所有*SNP的关联统计量，而不管它们的LD分数如何。然而，真正的多基因信号与LD分数成正比。在方程$E[\chi_j^2] = (\text{斜率}) \ell_j + (\text{截距})$中，混杂被吸收进了截距！因此，LDSC分析中的高截距是一个警示信号，表明存在未校正的群体分层或其他形式的混杂。

#### 仍然存在的差距

即使使用了这些复杂的方法，一个差距通常仍然存在：从双生子和家族研究中估计的遗传力（$h^2_{\text{pedigree}}$）通常高于[SNP遗传力](@entry_id:148453)（$h^2_{\mathrm{SNP}}$）。例如，对于重度抑郁症，谱系研究可能发现$h^2_{\text{ped}} \approx 0.37$，而基于SNP的方法得出的结果是$h^2_{\mathrm{SNP}} \approx 0.18$ [@problem_id:4743151]。为什么这个现代的“[遗传力](@entry_id:151095)差距”会存在？

主要有两个原因。首先，**$h^2_{\mathrm{SNP}}$是$h^2$的下界**。[SNP遗传力](@entry_id:148453)只捕捉了基因分型芯片上存在的常见变异所贡献的方差。它遗漏了来自更稀有的变异、结构变异（如拷贝数变异）以及芯片上SNP未能很好标记的变异的贡献。尽管存在具有大个体效应的稀有变异，但它们对总群体方差的贡献可能非常小，因为根据定义，它们是稀有的 [@problem_id:4531191] 。$2pqa^2$公式表明，随着等位基因频率$p$变得非常小，即使效应量$a$很大，方差贡献也会骤降。

其次，**$h^2_{\text{pedigree}}$可能被高估了**。基于家族的研究可能会被共同的环境或其他模仿遗传的非遗传因素所混淆。例如，父母的基因可以影响孩子的环境（一种称为“遗传抚育”的现象），这在谱系研究中可能被错误地归因于孩子自己的基因。我们可以实际观察到这种效应：从普通人群中估计的[SNP遗传力](@entry_id:148453)（$h^2_{\mathrm{SNP}} \approx 0.18$）通常略高于从同一家庭内兄弟姐妹比较中得出的估计值（$h^2_{\mathrm{SNP-within}} \approx 0.14$）。这一差异（$0.04$）直接估计了由这些家庭间混杂因素导致的基于人群的估计值的膨胀程度 [@problem_id:4743151]。

### [超越标准模型](@entry_id:161067)：完善我们的理解

旅程并未在此结束。“无穷小”模型虽然强大，但仍是一种简化。一个性状的真实遗传结构可能更为复杂。例如，自然选择可能导致具有大效应的变异维持在低频率。这意味着一个变异的效应量与其[等位基因频率](@entry_id:146872)并非独立。

*   **建模遗传结构**：像**LDAK**和**SumHer**这样的先进方法放宽了简单的无穷小假设。它们建立的模型中，一个SNP对[遗传力](@entry_id:151095)的预期贡献可以取决于其属性，例如其[等位基因频率](@entry_id:146872)和其局部LD环境。例如，这些模型可能会降低高LD区域中SNP的贡献权重，理由是它们是冗余的。如果真正的致病变异，例如，富集在基因组的低LD部分，标准的LDSC实际上可能会低估[遗传力](@entry_id:151095)。这些更精细的模型提供了更准确的估计，并且对于下一步的精细定位至关重要，后者旨在从候选列表中精确定位特定的致病变异 [@problem_id:4341922]。

*   **疾病的[遗传力](@entry_id:151095)**：当我们研究像疾病（病例vs对照）这样的二元性状时，会出现另一个微妙之处。我们直接从0/1数据中估计的[遗传力](@entry_id:151095)，即**观测尺度[遗传力](@entry_id:151095)（$h^2_{\mathrm{obs}}$）**，取决于研究的设计——特别是病例和对照的比例。为了得到一个可以在不同研究间进行比较的、稳定的生物学参数，我们将这个估计值转换到一个假设的、未观测的**易感性尺度（$h^2_{\mathrm{liab}}$）**上。这是一种数学校正，考虑了研究的病例比例和疾病在总人口中的患病率，确保我们始终在讨论相同的潜在数量 [@problem_id:4594779]。

从对家族相似性的简单观察出发，我们穿越了一片由复杂思想构成的景观——方差成分、[连锁不平衡](@entry_id:146203)、[群体结构](@entry_id:148599)以及遗传结构的[统计模型](@entry_id:755400)。每一步都让我们更接近于对我们共同遗传的定量理解，将“[遗传力](@entry_id:151095)”这个抽象概念转变为一个可测量、可完善、并最终更有用的科学工具。

