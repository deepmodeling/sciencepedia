## 引言
几十年来，生物学家只能通过分析成千上万个细胞的平均活动来研究组织，只能听到“群体的喧嚣”，却错过了“个体的声音”。这种批量分析掩盖了作为生命基本单位的单个细胞的关键多样性和功能。早期分离单个细胞的尝试既费力又缺乏理解复杂器官或疾病所需的大规模。挑战在于找到一种方法，能高效、大规模地为每个细胞都安上一个“麦克风”。

基于液滴的测序技术应运而生，成为这个问题的革命性答案。本文将探讨这项巧妙的技术，它让科学家能够将生命分割成数百万个微小、可分析的液滴。在接下来的章节中，你将全面了解这一变革性方法。“原理与机制”一章将剖析微流控芯片、分子条形码和统计学原理如何协同作用，以生成高质量的单细胞数据。随后的“应用与跨学科联系”一章将展示该技术如何用于创建[细胞图谱](@entry_id:270083)、整合多层生物信息以及主动探索基因功能，从而重塑我们对生物学、医学及其他领域的研究方法。

## 原理与机制

想象一下，你试图通过只听人群的嘈杂声来了解一个繁华城市的复杂社会。你可能会感受到整体情绪——比如一场体育胜利后的兴奋，或是高峰时段的交通嗡鸣——但你会错过那些真正定义城市生活的个人对话、故事、辩论和低语。几十年来，我们就是这样研究生物学的。通过将一块组织磨碎并测量其基因的平均活性——一种称为批量测序的技术——我们只听到了群体的喧嚣。我们对构成生命复杂结构的单个细胞的独特声音充耳不闻。

梦想是给每个细胞一个“麦克风”。早期的一种方法是煞费苦心地：科学家会手动挑选出单个细胞，将它们一个一个地放入微型塑料板的孔中，就像为一场私人对话将客人安排在数百个单独的餐桌上一样。这种方法，通常被称为**基于平板的测序**，对于进行深入、详细的“交谈”非常有效。你可以捕获每个细胞表达基因的很大一部分，甚至对它们进行全长测序以研究微妙的变异 [@problem_id:2967127]。但这种方法速度慢、费力，而且扩展性不佳。如果你坚持要把每个人都安排在单独的桌子上，你就无法举办一个数万人的派对。

为了真正绘制整个器官的[细胞图谱](@entry_id:270083)，或者在大量健康细胞中追踪稀有的癌细胞，我们需要一场革命。我们需要一种能够动态创建数百万个微小的“私人派对房间”的方法。这就是**基于液滴的测序**背后极其巧妙的想法。

### 液滴工厂与“口香糖球问题”

这项技术的核心是一个被称为微流控芯片的工程奇迹。它是一小块玻璃或塑料，上面蚀刻着微观通道。可以把它想象成一个为小虫子设计的管道系统。在这个系统中，我们让两种不相溶的液体流动：一股连续的油相流，以及一股含有我们解离的细胞和一系列特殊微珠的水相流。在一个精确的交汇点，油相流的压力会“夹断”水相流，形成一连串像机关枪一样发射出的数百万个完全均一、纳升级别的微水滴，每个水滴都被油包裹着。每个液滴都是一个独立的微型试管。

目标是在每个液滴中精确地放入一个细胞和一个微珠。然而，这是一个概率游戏。细胞被包裹进液滴是一个[随机过程](@entry_id:159502)，可以用描述雨滴落在铺路石上的数量或一分钟内呼叫总机电话次数的相同数学方法——**泊松分布**——完美地描述 [@problem_id:3321400]。想象一下，你站在一条移动的传送带上方，传送带上是空的罐子（液滴），你随机地向里面扔口香糖球（细胞）。如果你扔得太稀疏，大多数罐子会是空的。如果你为了确保大多数罐子至少有一个而扔得太多，那么许多罐子最终会装有两个、三个或更多。

在[单细胞测序](@entry_id:198847)的世界里，一个含两个或更多细胞的液滴被称为**双细胞**（或多细胞体）。这不仅仅是一个小麻烦；它是一个关键的混淆来源。想象一下，你在同一个液滴中捕获了一个肌肉细胞（表达“肌肉基因”）和一个神经元（表达“神经元基因”）。测序数据看起来会像来自一个奇异的混合细胞，它同时是肌肉细胞和神经元。这种人为的细胞，即**异型双细胞**，可能会让科学家们进行一番徒劳无功的追寻，使他们相信自己发现了一种实际上并不存在的新细胞类型 [@problem_id:1466152]。

幸运的是，我们可以控制这一点。通过仔细控制我们加载到芯片上的细胞浓度，我们调整了每个液滴的平均细胞数，这个比率称为 $\lambda$。我们特意保持较低的 $\lambda$（例如，小于0.1），以最大限度地减少形成双细胞的机会，即使这意味着许多液滴会是空的。得到一个麻烦的双细胞的概率可以用这个优雅的公式精确计算：$P(\text{doublet}) = 1 - (1+\lambda)e^{-\lambda}$ [@problem_id:3321400]。这是一个完美的例子，说明了定量的物理原理如何让我们能够设计和控制一个生物学实验。

### 分子锁、钥匙和地址标签

现在，让我们放大到其中一个成功的液滴——一个包含单个细胞和单个特殊微珠的液滴。此时，液滴缓冲液中的一种洗涤剂会裂解细胞，其所有的信使RNA（mRNA）分子——从细胞活性基因转录而来的工作蓝图——都会溢出。

这才是魔法真正发生的地方。微珠不仅仅是一个被动的占据者；它是一个微型数据收集装置，表面包被着数百万个专门设计的称为[引物](@entry_id:192496)的DNA分子。每个[引物](@entry_id:192496)都像一条复杂的钓鱼线，有三个关键部分 [@problem_id:2350880] [@problem_id:2837390]。

首先，在线的最末端是“钩子”：一段重复的[胸腺](@entry_id:182637)嘧啶（T）碱基序列，称为**poly-T尾**。真核细胞中的大多数mRNA分子末端都带有一长串腺嘌呤（A）碱基。我们引物上的poly-T钩会自然地与mRNA的poly-A尾结合，“捕获”它。这是反转录的第一步，其中一种酶会将RNA蓝图复制成更稳定的DNA分子（cDNA）。

其次，也是整个操作的关键，是**[细胞条形码](@entry_id:171163)（CB）**。这是一段短而独特的DNA碱基序列。关键规则是：*单个微珠上*的数百万个[引物](@entry_id:192496)都共享*完全相同*的[细胞条形码](@entry_id:171163)。然而，这个微珠上的[细胞条形码](@entry_id:171163)与实验中所有其他微珠上的条形码都不同。它就像一个独特的邮政编码，或液滴的地址标签。当来自我们单个细胞的每个mRNA被转化为cDNA时，它就会被盖上这个独特的地址标签 [@problem_id:1520799]。

为了理解[细胞条形码](@entry_id:171163)的重要性，想象一下如果它未能附着会发生什么。一旦液滴内的反应完成，我们将所有液滴打破，并将来自成千上万个液滴的内容物汇集到一个试管中进行测序。如果cDNA分子没有地址标签，那将是一团无法理解的混乱。我们将得到一大堆遗传信息，但无法知道哪个分子来自哪个细胞。实验将从一个漂亮的[单细胞分析](@entry_id:274805)崩溃为一个混乱的、平均的“批量”测量，完全违背了初衷 [@problem_id:1520781]。[细胞条形码](@entry_id:171163)就像一根线，让我们能够在计算上将混乱重新整理成单个的[细胞图谱](@entry_id:270083)。

第三，还有一个分子天才的设计：**独特分子标识符（UMI）**。除了共享的[细胞条形码](@entry_id:171163)，微珠上*每个单独的[引物](@entry_id:192496)分子*还有一个自己的短的、*随机的*碱基序列——一个独特的序列号。为了测序我们从一个细胞中获得的微量cDNA，我们必须首先使用一种称为PCR的过程制造数百万个拷贝。然而，PCR就像一个有故障的复印机；它可能将一页复印100份，而另一页只复印10份，从而造成巨大的偏差。如果我们只是简单地计算所有最终测序的读数，我们计算的将是复印件，而不是原始文件。UMI解决了这个问题。因为每个原始的mRNA分子在扩增*之前*就被标记了一个独特的UMI，所以它所有的后续PCR拷贝都将携带相同的UMI。通过在计算上合并所有共享相同[细胞条形码](@entry_id:171163)、相同基因序列和相同UMI的读数，我们只对每个原始分子计数一次。这为我们提供了细胞中存在的分子真实、无偏的数字计数 [@problem_id:2848949]。

### 生命的美妙[稀疏矩阵](@entry_id:138197)

有了这个由[细胞条形码](@entry_id:171163)（地址）和UMI（[序列号](@entry_id:165652)）组成的优雅系统，我们现在可以把来自所有细胞的汇集[cDNA文库](@entry_id:262174)一起测序，然后用计算机进行分类。对于每个测序读数，计算机会说：“好的，[细胞条形码](@entry_id:171163)告诉我这来自5821号细胞。基因序列告诉我这是*Actin*基因的转录本。而UMI告诉我这是我们在这个细胞中看到的第15个独特的*Actin*分子。”

最终的输出是一个巨大的数字表格：一个**[基因-细胞矩阵](@entry_id:172138)**。行代表基因组中的每个基因（对于人类或小鼠约有20,000个），列代表我们成功捕获的每个单细胞（可能有10,000个或更多）。表格中每个单元格的数字，比如在第*i*行和第*j*列，是基因*i*在细胞*j*中的UMI计数。

当你第一次看到这个矩阵时，一个特征会非常突出：它几乎完全被零填充。这个属性被称为**稀疏性**。这不是一个错误，也不意味着实验失败了。[基因-细胞矩阵](@entry_id:172138)的[稀疏性](@entry_id:136793)深刻地反映了生物学和技术两方面的原因 [@problem_id:2350932]。

首先是**生物学稀疏性**。把基因组想象成一个巨大的食谱库。任何一个特定的细胞，比如一个神经元，都是一个专业的厨师。它只使用可用食谱的一小部分——那些用于制造[神经递质](@entry_id:140919)、构建突触等的食谱。它不需要制造肌纤维或消化酶的食谱。因此，对于任何一个给定的神经元来说，20,000个基因中大多数的表达量确实是零。

其次是**技术性[稀疏性](@entry_id:136793)**。捕获mRNA分子的过程效率不高。即使对于一个正在表达的基因，如果细胞中只有少数几个mRNA拷贝，我们的分子“钓鱼线”很可能无法捕获到任何一个。这是一个抽样问题：我们没有检测到所有存在的分子。因此，我们矩阵中的许多零代表的不是真正的生物学缺失，而是技术上的检测失败。这种生物学现实和技术局限性的结合，使得单细胞数据具有典型的[稀疏性](@entry_id:136793)特征。

### 机器中的幽灵

与任何强大的技术一样，基于液滴的测序也有它自己的“幽灵”——我们必须理解和处理的微妙人为误差。分析中的一个关键步骤是质量控制，这在很大程度上是为了发现并驱除这些幽灵。

一个主要的幽灵是**环境RNA**。当我们首次准备组织样本时，一些细胞不可避免地会破裂，将其RNA内容物溢出到细胞悬浮液中。这会形成一种自由漂浮的RNA“汤”。这种环境“汤”可以进入任何液滴，包括那些未能捕获细胞的空液滴。这导致了低水平的背景污染，我们可能在一个神经元的图谱中检测到几个肝脏特异性基因的分子，不是因为神经元表达了它，而是因为它被“汤”污染了 [@problem_id:3348591]。我们可以通过分析空液滴的内容物来巧妙地检测到这一点。这些检测到基因很少（`nFeatures`）的“细胞”的图谱，是我们对环境RNA的最佳描绘。这正是为什么分析的第一个标准步骤是过滤掉任何基因计数可疑地低的“细胞”——它们不是真正的静息细胞，而很可能是空液滴或垂死的细胞，它们的数据只会增加噪音 [@problem_id:1465882]。

另一个挑战是测序错误。[细胞条形码](@entry_id:171163)中一个单碱基对的错误可能导致来自一个细胞的读数被丢弃或错误分配。UMI中的一个错误可能使一个PCR拷贝看起来像一个新分子，从而人为地增加了我们的计数。但在这里，计算再次伸出援手。由于我们知道实验中使用的有效[细胞条形码](@entry_id:171163)的完整列表（“白名单”），我们可以将损坏的条形码校正为最接近的有效匹配项。而且由于一个真实的UMI会在许多PCR拷贝上出现，而一个由错误产生的UMI会很罕见，我们可以使用基于丰度的[聚类](@entry_id:266727)将包含错误的UMI合并回其父UMI中 [@problem_id:2848949]。

这种巧妙的分子工程与复杂的计算校正之间的持续对话，是现代基因组学的真正标志。它使我们能够构建机器，以前所未有的规模窥探单个细胞的私密生活，从而改变我们对生命基本单位的理解。

