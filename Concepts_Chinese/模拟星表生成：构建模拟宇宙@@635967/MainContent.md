## 引言
在我们探索宇宙的征途中，我们面临一个根本性的限制：我们只有一个宇宙可供观测，且无法让时间倒流或对其进行实验。那么，我们如何才能自信地检验我们的宇宙演化理论，或验证用于解读望远镜数据的复杂分析工具呢？答案在于在计算机中构建我们自己的宇宙。这些被称为**[模拟星表](@entry_id:752048)**的合成宇宙，已成为现代宇宙学不可或缺的“飞行模拟器”，让科学家能够在一个受控的数字实验室中练习技术、量化不确定性，并探索“如果……会怎样”的情景。

本文全面概述了[模拟星表](@entry_id:752048)生成背后的科学与方法论，旨在填补原始理论模拟与现实观测数据之间的关键知识鸿沟，解释我们如何将两者联系起来。读者将对从基本原理到前沿应用的整个过程获得深刻理解。

第一章**“原理与机制”**将引导您完成构建[模拟星表](@entry_id:752048)的技术之旅。我们将探讨如何将静态的模拟快照拼接成动态的过去[光锥](@entry_id:158105)，如何识别不可见的[暗物质晕](@entry_id:147523)，以及如何使用不同的“配方”将我们看到的星系填充到这些暗晕中。第二章**“应用与跨学科联系”**将展示这些[模拟宇宙](@entry_id:754872)在实践中的强大威力。我们将看到[模拟星表](@entry_id:752048)如何被用来锻造发现的工具， refining 我们对星系-暗晕关系的理解，以及对抗那些挑战我们追求宇宙学精度的系统误差。

## 原理与机制

为了理解我们的宇宙，我们必须能够用观测来检验我们的理论。但是，当我们只有一个宇宙可看，且无法让时光倒流时，我们如何检验一个宇宙演化理论呢？答案是在计算机中构建我们自己的宇宙。这些被称为**[模拟星表](@entry_id:752048)**的合成宇宙不仅仅是为了制作漂亮的图片；它们是[现代宇宙学](@entry_id:752086)不可或缺的实验室。它们使我们能够演练测量技术，[量化不确定性](@entry_id:272064)，并探索在真实宇宙中无法探究的“如果……会怎样”的情景。从原始的[引力模拟](@entry_id:750044)到看起来与望远鏡所見完全一樣的模擬星表，這段旅程是物理學與數據科學的傑作，揭示了我們的理論模型与時空結構之間的深層統一性。

### 宇宙舞台：从快照到光锥

[模拟星表](@entry_id:752048)的故事始于[宇宙学模拟](@entry_id:747928)。这些模拟通常在一个膨胀的宇宙中追踪数十亿乃至数万亿个暗物[质粒](@entry_id:263777)子在[引力](@entry_id:175476)无情牵引下的演化。这类模拟的原始输出是一系列**快照**：在宇宙时间的特定离散时刻，宇宙的3D立方体。[红移](@entry_id:159945)为零的快照向我们展示了“今天”的宇宙网，而更高[红移](@entry_id:159945)的快照则向我们展示了一个更年轻、结构化程度更低的宇宙。

但我们永远无法将宇宙看作单一的快照。今晚到达我们眼睛的来自仙女座星系的星光是250万年前发出的。来自遥远类星体的光可能已经传播了超过100亿年。由于光速是有限的，向外太空看等同于回望过去。天文学家观测到的不是空间的一个3D切片；他们观测的是时空中一个称为**过去[光锥](@entry_id:158105)**的4D表面。这个表面包含了所有光线刚好现在到达我们的物体，从不久前所见的邻近星系，到宇宙婴儿期所见的最遥远天体。

要构建[模拟星表](@entry_id:752048)，我们必须从我们的模拟快照中构建这个光锥。这意味着我们不能只取一个模拟数据盒。相反，我们必须想象自己处于中心，并从不同的快照中收集粒子，这些快照对应于它们正确的“[回溯时间](@entry_id:260844)”。这个过程的基本规则手册是一个物体的观测[红移](@entry_id:159945)（$z$），即其光因宇宙膨胀而被拉伸的程度，与其[共动距离](@entry_id:158059)（$\chi$），即它在膨胀的宇宙网格上与我们的距离，之间的关系。对于一个[平坦宇宙](@entry_id:183782)，这种映射由膨胀历史决定，并 encapsulated 在哈勃参数 $H(z)$ 中：

$$
\chi(z) = c \int_{0}^{z} \frac{dz'}{H(z')}
$$

这个方程是将一系列静态快照转变为单个观测者所见的动态、演化宇宙景观的关键 [@problem_id:3512740]。它是回望过去的数学体现。

这种映射也揭示了宇宙学中的“距离”并非单一概念。我们需要不同的度量来满足不同的目的。**[光度距离](@entry_id:159432)**（$D_L$）告诉我们一个已知光度的物体看起来会有多暗，而**[角直径距离](@entry_id:157817)**（$D_A$）则告诉我们一个已知物理尺寸的物体看起来会有多大。这两者并不相同！它们通过宇宙学中最优雅、最深刻的关系之一——**距离[二元关系](@entry_id:270321)**——联系在一起：

$$
D_L = (1st+z)^2 D_A
$$

这不仅仅是一个方便的公式；它是关于我们[宇宙几何](@entry_id:159804)的深刻陈述。它直接源于[引力](@entry_id:175476)由度规理论（如广义相对论）描述，且[光子](@entry_id:145192)沿[零测地线](@entry_id:158803)传播且其数量守恒的原理。值得注意的是，即使在我们这个充满团块、非均匀的宇宙中，光线因引力透镜效应而弯曲，这个关系依然成立 [@problem_id:3477470]。任何物理上忠实的[模拟星表](@entry_id:752048)都必须遵守这一关系。

### 为星系寻找家园：暗晕及其特性

我们的模拟主要是针对暗物质，这种看不见的支架构成了宇宙中约85%的物质。我们实际看到的發光示蹤物——星系，被认为是在我们称为**暗晕**的致密、[引力](@entry_id:175476)束缚的暗物质茧中形成和存在的。因此，在放置星系之前，我们必须首先在我们的[粒子模拟](@entry_id:144357)中找到这些暗晕。

但是，你如何在一个包含数十亿个点的[分布](@entry_id:182848)中定义一个“团块”呢？这个看似简单的问题具有深远的影响。两种最常见的方法在哲学上截然不同：

-   **友邻算法（Friends-of-Friends, FOF）**是一种简单的“连点成线”方法。它将任何两个距离小于指定[连接长度](@entry_id:747697)（通常是平均粒子间距的20%）的粒子连接在一起。任何一组相互连接的粒子就形成一个暗晕。这是一种无需假设特定形状就能找到过密区域的直观方法。

-   **球形过密度（Spherical Overdensity, SO）**算法更具物理动机。简单的引力坍缩模型表明，当一个结构的密度达到背景密度的某个倍数时，它就成为一个独特的、束缚住的物体。SO方法找到粒[子集](@entry_id:261956)中区域，并在其周围生长球体，直到球体内的平均密度达到预定义的阈值，例如宇宙[临界密度](@entry_id:162027)的200倍。这个球体内的质量随后被定义为暗晕质量，记为 $M_{200\mathrm{c}}$。

至关重要的是，这两种方法不会给出相同的结果。FOF作为一种[渗流](@entry_id:158786)方法，以将邻近但独立的暗晕“桥接”成单个物体而闻名，并且其边界是由比典型SO暗晕更低的密度阈值定义的。因此，对于同一个物体，FOF质量通常大于 $M_{200\mathrm{c}}$ 质量 [@problem_id:3512729]。这不仅仅是一个技术细节；暗晕的数量随着质量的增加而急剧下降。在一个用 $M_{200\mathrm{c}}$ 校准的模型中使用FOF质量，将导致对大質量星系团的严重过高预测，从而使从该模拟中得出的任何科学结论产生偏差 [@problem_id:3512729]。选择何种暗晕寻找器是一个根本性的建模决策，它塑造了整个星表。

### 星系-暗晕关系：填充[模拟星表](@entry_id:752048)

在我们过去光锥上构建了暗物质晕星表之后，我们终于可以开始添加星系了。从第一性原理出发，模拟[星系形成](@entry_id:160121)的复杂物理过程——气体冷却、恒星形成、超新星爆发、[黑洞](@entry_id:158571)反馈——对于大体积来说计算成本过高。因此，我们使用巧妙的“配方”来建立**星系-暗晕关系**。

-   一种流行的配方是**暗晕占据[分布](@entry_id:182848)（Halo Occupation Distribution, HOD）**。这是一种统计方法。我们不试图模拟物理过程，而是问一个更简单的问题：对于一个给定质量为 $M$ 的暗晕，它拥有 $N$ 个亮度高于某一阈值的星系的概率 $P(N|M)$ 是多少？一个标准的HOD模型假定，一个暗晕有机会拥有一个中心星系，然后拥有若干卫星星系，其数量遵循一个简单的[统计分布](@entry_id:182030)（如泊松分布），其平均值随暗晕质量的增加而增加。然后调整该模型的参数，直到模拟星系的统计特性（如它们的成团性）与真实宇宙相匹配 [@problem⚫️_id:3512720]。

-   另一个强大的想法是**子暗暈豐度匹配（Subhalo Abundance Matching, SHAM）**。该方法建立在一个 beautifully simple 的假设上：质量最大的星系应该位于质量最大的[暗物质晕](@entry_id:147523)中。人们只需将观测到的按[恒星质量](@entry_id:157648)（或光度）排序的星系列表，与按质量排序的模拟暗晕（和子暗晕）列表进行一对一匹配。为了使之更稳健，人們通常不按暗暈的當前質量排序（因為潮汐剝離可能會減小質量），而是按其历史峰值质量 $M_{\mathrm{peak}}$ 排序。这为暗暈的原始大小，以及推测其形成大星系的能力，提供了一个更稳定的指标 [@problem_id:3512720]。

这些方法代表了两种弥合暗物质与光之间鸿沟的不同哲学，各有其长处。HOD是一个灵活的统计工具，而SHAM则是一个直接、有物理动机的假设。这两种方法之间的持续张力与协同作用，极大地推动了我们对星系如何填充宇宙网的理解。

### 眼见为实：创造逼真的[可观测量](@entry_id:267133)

至此，我们有了一个包含星系位置和宿主暗晕的星表。但是天文学家看到的不是位置；他们看到的是天空中的角度、[红移](@entry_id:159945)和[视星等](@entry_id:158988)。模拟生成的最后关键步骤涉及将我们的“真实”物理星表转换为逼真的“观测”星表。

一个星系的观测红移并不仅仅是由宇宙的平滑膨胀引起的。它还包括了来自星系自身**[本动速度](@entry_id:157964)**的[多普勒频移](@entry_id:158041)。这种被称为**[红移空间畸变](@entry_id:157636)（Redshift-Space Distortion, RSD）**的效应，系统性地改变了我们对宇宙网的感知。在大尺度上，流向大质量[星系团](@entry_id:160919)的星系在我们视线方向上会显得更密集，使星系团看起来被压扁了。在小尺度上，在一个星系团内部，星系在暗晕深邃的[引力势](@entry_id:160378)阱中随机 buzzing。这些由[维里定理](@entry_id:146441)支配的随机运动，为观测到的红移增加了一个大的随机分量。这会使星系团沿视线方向被抹开，形成一个被称为**上帝之指（Finger-of-God, FoG）**的细长结构，仿佛指向观测者 [@problem_id:3477480]。一个逼真的[模拟星表](@entry_id:752048)必须包含这些速度效应，以再现真实巡天中看到的各向异性成团性。

接下来，我们必须计算每个星系看起來有多亮。一个星系的內禀顏色和亮度由其**谱能量[分布](@entry_id:182848)（Spectral Energy Distribution, SED）**描述，即其光度隨波長的函數。要找到它在给定滤光片中的[视星等](@entry_id:158988)，我们必须考虑其[光度距离](@entry_id:159432) $D_L$。但我们还必须考虑红移会移动整个SED。一个最初在紫外波段发射的[光谱](@entry_id:185632)特征，可能会被红移到望远镜滤光片敏感的蓝色[光谱](@entry_id:185632)部分。这种效应被**K-校正**所捕捉，它是一个依赖于[红移](@entry_id:159945)和SED的项，确保我们在将星系的观测[星等](@entry_id:161778)与其内禀[绝对星等](@entry_id:157959)联系起来时，是在比较同类事物 [@problem_id:3512756]。

最后，没有任何观测是完美的。一次巡天在天空中有一个有限的足迹（其**[窗函数](@entry_id:139733)**），并且无法探测到太暗的物体。望远镜硬件可能会失灵，天空条件可能会变化。所有这些不完美之处都被捆绑在**选择函数** $S(\vec{\theta}, m, z)$ 中。这是一个主函数，给出了一个位于给定天空位置 $\vec{\theta}$、[视星等](@entry_id:158988)为 $m$、[红移](@entry_id:159945)为 $z$ 的星系被成功探测并包含在最终星表中的概率。为了创建最终的[模拟星表](@entry_id:752048)，我们将这个概率性过滤器应用于我们的理想化星表，将其“稀疏化”以模仿天文观测混乱的现实 [@problem_id:3512715]。

### [模拟星表](@entry_id:752048)动物园：保真度的[光谱](@entry_id:185632)

从高分辨率的**全[N体模拟](@entry_id:157492)**创建一个黄金标准的[模拟星表](@entry_id:752048)是一项巨大的计算任务。对于许多应用，例如估计宇宙学测量的[统计不确定性](@entry_id:267672)（或“协[方差](@entry_id:200758)”），我们需要的不是一个，而是成千上万个[模拟星表](@entry_id:752048) [@problem_id:3477491]。这催生了各种更快、近似的[模拟星表](@entry_id:752048)生成技术。

像**COLA**和**PINOCCHIO**这样的方法使用[拉格朗日微扰理论](@entry_id:751116)的近似来快速预测大尺度结构和暗晕位置，牺牲了小尺度精度以换取巨大的速度提升。更快的是纯粹的统计方法，如**对数正态模拟**，它生成一个随机密度场，该密度场通过构造具有正确的两点统计量，而完全不模拟任何[引力](@entry_id:175476)动力学 [@problem_t_id:3477623]。选择使用哪种工具是物理保真度与计算成本之间的经典权衡，并且完全取决于所要研究的科学问题。

### 推进前沿：宇宙边缘的广义相对论

基于[牛顿引力](@entry_id:159796)在平滑膨胀背景上的标准[模拟星表](@entry_id:752048)生成图像非常成功。然而，对于旨在绘制整个可观测[宇宙的未来](@entry_id:159217)巡天来说，这种近似在边缘开始失效。在接近[宇宙学视界](@entry_id:271390)的尺度上，通常可以忽略的广义相对论（GR）效应变得重要起来。

来自最遥远星系的光不仅穿过一个膨胀的空间；它还必须爬进爬出超[星系团](@entry_id:160919)和宇宙空洞的引力势阱。这会印上额外的[红移](@entry_id:159945)（[Sachs-Wolfe效应](@entry_id:161393)和积分[Sachs-Wolfe效应](@entry_id:161393)），并通过引力透镜效应扭曲星系的表观大小和[数密度](@entry_id:268986)。标准的牛顿模拟完全忽略了这些微妙的大尺度GR特征 [@problem_id:3477620]。

[模拟星表](@entry_id:752048)生成的前沿是构建包含这些效应的星表。这既可以通过“后处理”牛顿模拟——从密度场重建GR势并对其进行[光线追踪](@entry_id:172511)——来实现，也可以使用下一代**相对论N体代码**，这些代码与粒子运动一起求解广义相对论的全套方程。这些先进的[模拟星表](@entry_id:752048)不仅仅是改进；它们是在最宏大的尺度上检验爱因斯坦理论、将我们的模拟宇宙转变为基础物理实验室的必要工具。

