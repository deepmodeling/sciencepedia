## 应用与跨学科联系

在我们完成了对学习原理的探索之后，我们来到了一个关键问题：这条路通向何方？“捷径学习”这个抽象概念在现实世界中是什么样子的？您将看到，答案是：它无处不在。就像一个顽皮的影子，它跟随着我们最强大的创造物进入它们所触及的每一个领域。但通过追踪这个影子，我们能更多地了解那道光——我们旨在构建的真正的、鲁棒的智能。这不是一个关于失败的故事，而是一个关于发现的故事，它将我们从高风险的医学界带到物理定律的基石。

### 聪明但懒惰的医学生

想象你正在培养一个年轻、聪明但有点懒惰的医学生。这个学生是一个[机器学习模型](@entry_id:262335)，它的工作是从胸部X光片中诊断肺炎。你给它成千上万的例子，它很快就学会了以惊人的准确率区分患病和健康的病人。你正准备庆祝一项突破！但随后，你把它带到一家新医院，它的表现就崩溃了。它突然之间不比抛硬币好多少。发生了什么？

你发现，在你原来的医院里，病情较重的病人（他们通常是躺着的）的X光片是从一个特定的角度——“AP”视角——拍摄的，而较健康的病人通常是从另一个角度——“PA”视角——拍摄的。你那聪明的学生，没有学习肺部肺炎的微妙迹象，而是简单地学会了阅读“AP/PA”标记。它找到了一个捷径。它没有在当放射科医生；它只是在读一个标签 [@problem_id:4894596]。这个简单而深刻的失败揭示了一个根本性的挑战。模型在一个数据集上的成功可能完全是一种幻觉，建立在一个一旦环境改变就消失的[伪相关](@entry_id:755254)性之上。

我们如何抓住这样一个聪明的作弊者？我们必须成为侦探。我们不能只看最终成绩；我们必须检查学生的推理过程。假设一个模型被设计用来预测脓毒症风险。我们可能会发现它表现出色，但深入观察后发现，它过度关注了图像上一个标识其来源医院的模糊水印。由于不同医院有不同的患者群体，水印本身就成了风险的预测因子，一个与患者实际生理状况无关的捷径。

为了揭示这一点，我们可以进行复杂的审问。我们可以建立一个[统计模型](@entry_id:755400)，看看在考虑了所有合法的临床变量*之后*，医院ID是否还能增加预测能力。或者，更强有力的是，我们可以进行一个数字实验：如果我们拿一张图片，通过算法将一家医院的水印换成另一家的会怎么样？如果模型对该患者的风险评分发生巨大变化，我们就抓住了它的现行，证明它依赖的是伪影，而不是医学 [@problem_id:4849738]。最严格的测试莫过于将AI像对待任何其他科学假说一样：我们设计一个随机对照试验。我们可以取一组图像，对随机的一半，我们以数字方式移除一个可疑的捷径特征（比如X光片上特定的边界伪影）。对另一半，我们什么都不做。如果模型真正在学习病理学，它在两组中的表现应该几乎相同。如果当捷径被移除时它的表现崩溃，我们就有了证据 [@problem_id:4411282]。

但检测虽然至关重要，却是被动的。一个更好的方法是从一开始就成为一个更好的老师。我们可以设计课程本身，让捷径变得不那么有吸[引力](@entry_id:189550)。在训练一个用于医学图像对齐（一个称为配准的过程）任务的模型时，我们可以使用激进的数据增强。我们可以随机改变强度，轻[微旋转](@entry_id:184355)和扭曲图像，等等。通过不断改变“肤浅”的方面，我们迫使模型学习更深层次的、不变的解剖结构 [@problem_-id:4582094]。这延伸到了[自监督学习](@entry_id:173394)的前沿，模型在这里从无标签数据中学习。在教模型从组织切片中理解癌症病理学时，学习任务的定义本身至关重要。我们必须教它，同一肿瘤中两个不同染色但相邻的斑块是“相似的”，而来自切片不同部分的两个斑块是“不同的”。一个朴素的设置可能导致模型仅仅学会通过其独特的颜色色调来区分切片，这是一个无用的捷径。精心设计这些“正”和“负”样本对于学习真正的生物学至关重要 [@problem_id:4321358]。

### 超越图像：语言、分子与生命密码

捷径问题并不仅限于机器所能看到的东西。它在机器所阅读和合成的内容中同样普遍。思考一下教机器理解医生写的复杂、充满行话的笔记这一挑战。这些笔记富含医学实体、缩写和微妙的关系。一个标准的语言模型可能会通过利用简单的模式来学习预测一个被掩盖的词，比如一个缩写词后面通常跟着它在括号中的全称。为了迫使它从周围的临床语境中学习缩写词“MI”的*含义*，而不仅仅是从文本“myocardial infarction (MI)”中学习，我们必须设计一个更智能的训练方案。我们可以优先掩盖重要的医学术语，甚至创建反事实的例子，在其中我们将一个实体与一个来自医学[本体](@entry_id:264049)的相似但不同的实体交换，从而迫使模型学习细粒度的语义 [@problem_id:5220121]。

当我们进入分子生物学的世界时，挑战进一步加深。例如，免疫系统遵循“锁和钥匙”的原则。一个T细胞受体（TCR）只有在由一个称为HLA的特定分子（锁）呈现时，才能识别一个特定的病原肽（钥匙）。如果我们想训练一个AI来预测哪些TCR识别哪些肽，我们必须极其小心地构建我们的训练数据。一个朴素的方法可能是将一个已知的反应性TCR-肽对（一个“正”样本）与一个TCR和一个*随机选择*的非反应性肽（一个“负”样本）配对。但这是一个陷阱！模型可能会学到微不足道的捷径。它可能会注意到所有正样本都涉及特定长度的肽或由特定HLA类型呈现的肽。它会学会成为一个“长度检查器”或“HLA检查器”，而不是一个“TCR-肽相互作用”模型。迫使模型学习分子识别的真正、微妙语法的唯一方法是创建“困难负样本”：由*相同*HLA呈现、具有*相同*长度、并来自*相同*生物环境（供体）的负肽，仅在TCR必须检查的序列上有所不同 [@problem_id:5280538]。我们必须问模型不是“这是*任何*锁的有效钥匙吗？”而是“这是*这把特定*锁的*正确*钥匙吗？”

### 物理定律与对不变性的追求

这就把我们带到了物理科学领域，在这里，捷径问题找到了它最优雅的表达和最深刻的解决方案。在药物发现中，科学家使用计算机来预测一个潜在的药物分子（“配体”）将如何与一个目标蛋白结合。可以训练一个[机器学习模型](@entry_id:262335)来区分一个正确的结合姿态和一个不正确的“诱饵”姿态。然而，用来生成这些诱饵姿态的程序常常会留下微妙的统计伪影。例如，诱饵的物理化学性质可能平均而言与真正的活性配体略有不同。

一个强大的模型，其任务是最小化误差，会抓住这个微弱的统计信号。它可以学会在不学习[蛋白质-配体相互作用](@entry_id:203093)的复杂物理学的情况下，仅基于这些配体自身的特征来区分活性物和诱饵。它用错误的原因得到了正确的答案。结果是一个在有偏见的[测试集](@entry_id:637546)上表现出色，但在一个诱饵被更仔细选择的真实筛选活动中灾难性失败的模型 [@problem_id:4333005] [@problem_id:5260085]。解决方案再次是更好的教学：我们必须精心策划我们的数据集，以确保这些混淆属性在正负样本之间是平衡的，让模型别无选择，只能学习真正的、基于几何的信号。

也许这个原理最美的例证来自基础物理学。想象我们正在教一台机器识别[伊辛模型](@entry_id:139066)（一个经典的磁体“玩具模型”）中的物相。我们向它展示自旋构型的快照，并将它们标记为“铁磁性”（有序）或“顺磁性”（无序）。我们不知道的是，我们的数据管道有一个小故障：它在所有[铁磁性](@entry_id:137256)样本的角落里盖上了一个微小的人工“水印”。一个深度学习模型将不可避免地发现这个水印，并将其用作一个完美的捷径，达到100%的准确率，同时对物理学一无所知。

我们该如何解决这个问题？我们可以尝试清理数据，但有一种更强大、更根本的方法。我们从物理学中知道，伊辛模型的性质——它的相、它的能量——在某些变换下是不变的。你可以将[晶格](@entry_id:148274)旋转90度，可以对其进行反射，还可以将每一个自旋从上翻到下，物理性质保持不变。这些是系统的*对称性*。教机器的正确方法是直接将这些对称性构建到学习过程中。我们可以通过向模型展示一个构型及其所有对称变换，并告诉它所有这些的标签都是相同的，来增强我们的训练数据。通过强迫模型的预测在[哈密顿量](@entry_id:144286)的已知对称群下保持不变，我们使它无法依赖于一个特定位置的水印。我们迫使它学习那些像真正的物理序参量一样，尊重系统基本定律的特征 [@problem_id:5293510]。

于是，我们跨学科的旅程画上了句号。构建[鲁棒人工智能](@entry_id:637173)的追求不仅仅是数据和算法的技术挑战。它是一项反映我们自身的科学事业。它迫使我们深入思考因果关系，设计巧妙的实验，警惕[混淆变量](@entry_id:199777)，并最终识别和嵌入我们所研究领域的基本、不变的原理。捷径问题提醒我们，简单的答案很少是正确的答案，而真正的理解，无论是对人还是对机器，都不是在肤浅的相关性中找到的，而是在世界深刻、对称和因果的结构中找到的。