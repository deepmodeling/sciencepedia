## 引言
对事件发生前持续时间的建模——无论是组件的故障、患者的康复，还是疾病的发生——都是科学和工程领域的一项基本挑战。这种“事件时间”数据带来了独特的统计难题，最突出的是存在不完整或“删失”的观测值，即在研究期结束时事件尚未发生。参数生存模型为此挑战提供了一个强大的框架，它不仅描述了过去的事件，还提供了一种结构化的方法来预测未来的概率。本文将作为这些基本工具的指南。首先，“原理与机制”一章将揭示生存分析的核心原则，解释生存函数和风险函数的基本概念、对删失问题的巧妙解决方案，以及用于描述不同风险随时间变化模式的模型库。随后，“应用与跨学科联系”一章将展示这些数学结构如何应用于解决从医学、卫生经济学到工程学和伦理学等领域的关键现实问题。

## 原理与机制

要真正理解世界，无论是星系的舞蹈还是疾病的微妙进展，我们首先需要一种描述它的语言。在研究生命及其终结的过程中，我们的主角是时间。但不是任意时间，而是指特定事件——康复、复发，或不幸的是，死亡——发生前的持续时间。我们如何谈论这个“事件时间”？我们如何构建模型，不仅能描述我们所见，还敢于预测我们未见？让我们踏上征途，揭开参数生存模型的原理，这是一种讲述时间故事的强大语言。

### 两种函数的传说：生存函数与风险函数

想象一下，你正走过一片田野，并且知道其中隐藏着危险。我们可以用两种基本方式来描述你的旅程。

首先，我们可以问：在任意时间 $t$，你仍然在行走，尚未遇到危险的概率是多少？这就是**生存函数**，记为 $S(t)$。它从 $S(0) = 1$ 开始（在开始时你肯定是“存活”的），并随着时间推移而减少，因为发生事件的机会在增加。这是一个关于耐力的故事。

其次，我们可以问一个更直接，也许更令人恐惧的问题：在此时此刻 $t$，鉴于你已经走到现在，事件* 바로 지금 *发生的瞬时风险是多少？这就是**[风险函数](@entry_id:166593)**，$h(t)$。它不是一个概率，而是一个率——事件发生的瞬时可能性。高风险意味着在那一刻田野非常危险；低风险则意味着相对安全。

这两个函数并非独立；它们是同一枚硬币的两面，从不同角度讲述同一个故事。它们之间的关系是该领域中最优雅的数学之一。时间 $t$ 的生存率与截至该点累积的总风险精妙地联系在一起。如果我们将累积风险定义为 $H(t) = \int_{0}^{t} h(u)\,du$，它代表了你从开始到时间 $t$所面临的风险总和，那么生存函数就是：

$$S(t) = \exp(-H(t))$$

这个优美的公式告诉我们，你的生存概率随着你所暴露的累积总风险呈指数级下降 [@problem_id:4984926]。这一关系是所有生存分析构建的基石。

### 未见的数据：删失之谜

当我们进行研究时，我们很少能看到每个人的完整故事。想象一个为期五年的临床试验，追踪患者情况。有些患者可能在试验期间发生了我们感兴趣的事件。对他们来说，我们知道确切的事件时间。但其他人呢？

-   一些患者可能在五年期满时仍未发生事件。他们的故事尚未结束，但我们的观察结束了。
-   一些人可能搬家了，导致失访。
-   一些人可能因个人原因退出了研究。

这些都是**右删失**观测的例子。我们知道他们至少“存活”到了某个时间点，但不知道之后发生了什么。我们只有一个不完整的故事 [@problem_id:4531972]。我们该怎么办？忽略他们就如同扔掉了我们大部分的数据；这将系统性地使我们的结果偏向于较短的生存时间。

生存分析的天才之处在于它处理这个难题的方式。它使用了我们拥有的*所有*信息。对于在时间 $t_i$ 发生事件的患者，他们对我们理解的贡献是在那一瞬间发生事件的概率，这由概率密度函数 $f(t_i)$ 捕捉。对于在时间 $t_i$ 被删失的患者，他们的贡献是我们知道他们*至少*存活到那个时间，这由生存函数 $S(t_i)$ 捕捉。

为了建立模型，我们将这些信息片段结合起来。对于一组独立的个体，观察到我们整个数据集的总似然是这些个体贡献的乘积。如果我们使用一个指示符 $\delta_i$，当发生事件时为 $1$，删失时为 $0$，我们可以用极其简洁的方式写出 [@problem_id:4985929]：

$$
L(\theta) = \prod_{i=1}^{n} [f(t_i; \theta)]^{\delta_i} [S(t_i; \theta)]^{1-\delta_i}
$$

在这里，$\theta$ 代表我们模型的参数。这个似然函数是生存分析的引擎。通过找到使我们观察到的数据最有可能的参数值 $\theta$（这个过程称为**最大似然估计**），我们就可以拟合我们的模型，即使数据中混合了完整和不完整的故事 [@problem_id:4969345]。

### 生命故事库：参数模型动物园

现在我们到达了问题的核心。要使用我们的似然引擎，我们需要定义 $f(t)$ 和 $S(t)$。**参数模型**通过为[风险函数](@entry_id:166593) $h(t)$ 假设一个特定的数学形式，一个“故事”来做到这一点。这是一个大胆的举动。我们正在提出一个支配事件发生时间的定律。但作为这种大胆的回报，我们获得了巨大的力量。让我们来看看这个故事库中几个最著名的故事。

#### 指数模型：无记忆的时间

可以讲述的最简单的故事是风险是恒定的。[风险函数](@entry_id:166593)就是 $h(t) = \lambda$，其中 $\lambda$ 是一个正常数。这意味着事件的瞬时风险在任何时候都是相同的，无论个体已经存活了多久。这是“无记忆”过程的标志。它很适合描述放射性原子衰变这类事件，或者可能是一种不会磨损但会受到随机冲击的组件的故障。相应的生存函数是 $S(t) = \exp(-\lambda t)$ [@problem_id:4853736]。

#### 威布尔模型：关于[老化](@entry_id:198459)和初期的故事

自然界很少如此简单。事物会磨损。或者，有时，一个初期的高风险期之后会跟着一个稳定期。**威布尔模型**用一个额外的参数，即“形状”参数 $k$，捕捉了这些更丰富的情节。其[风险函数](@entry_id:166593)是一个幂律：

$$h(t) = \frac{k}{\lambda^k} t^{k-1}$$

威布尔模型的美在于对 $k$ 的解释 [@problem_id:4853736]：
-   如果 $k > 1$，风险随时间增加。这是[老化](@entry_id:198459)或磨损的经典故事，即某物使用时间越长，故障风险越大。
-   如果 $k  1$，风险随时间减少。这可以描述一次高风险手术后的生存情况，即危险在手术后立即达到最高，然后随着患者康复而降低。
-   如果 $k = 1$，风险是恒定的，威布尔模型优雅地简化为指数模型。

这展示了一种美丽的统一性：一个更复杂的模型将更简单的模型作为其特例包含在内。

#### 对数正态和对数逻辑斯蒂模型：风险的起落

有些故事不是单调的。风险可能会上升到一个峰值然后下降。想象一下手术后感染的风险；它可能会在细菌繁殖的几天内增加，然后随着免疫系统或抗生素发挥作用而减少。威布尔模型无法讲述这个故事。为此，我们需要其他模型，如**对数正态**或**对数逻辑斯蒂**分布。

这些模型允许非单调或“单峰”的风险形状。例如，可以证明对数逻辑斯蒂模型的风险在一个特定时间 $t^{\star} = \lambda (\kappa-1)^{1/\kappa}$（这仅适用于[形状参数](@entry_id:270600) $\kappa > 1$）达到峰值，然后下降 [@problem_id:5228314]。这种灵活性使我们能够模拟更广泛的现实世界生物和机械过程，为我们描述事件随时间展开的多种方式提供了更丰富的词汇。

### 预测的力量：为什么参数模型至关重要

此时，你可能会问：为什么非要假设一个故事呢？有些著名的“半参数”方法，比如 **Cox [比例风险模型](@entry_id:171806)**，之所以强大，正是因为它们*不*假设基线风险 $h_0(t)$ 的形状 [@problem_id:4531972]。为什么不总是使用它呢？

答案非常实际：**外推**。

临床试验几乎总是有限的。它们运行两年或五年，然后停止。但在现实世界中，尤其是在**卫生技术评估 (HTA)** 等领域，我们需要根据终生成本和收益来做决策。要计算一种新药预期增加的生命年，我们需要对生存曲线从零到无穷大进行积分：$\mathbb{E}[T] = \int_{0}^{\infty} S(t)\,dt$ [@problem_id:4984926]。

生存的非[参数估计](@entry_id:139349)，比如著名的 [Kaplan-Meier](@entry_id:169317) 曲线，只是一组描述我们所见数据的[阶梯图](@entry_id:263049)。它对于研究中最后一个患者被观察到之后发生的事情一无所知。它只是变平了。Cox 模型，尽管 brilliant，其基线风险也有同样的局限性。你无法从一个在数据之外就沉默的模型中获得终生估计。

这就是参数模型变得不可或缺的地方。通过为风险假设一个函数形式——一个故事——我们定义了从 $t=0$ 到 $t=\infty$ 的整个时间范围内的生存曲线。我们使用试验数据来拟合我们故事的参数（比如威布尔模型的 $\lambda$ 和 $k$）。一旦我们有了这些参数，模型就为我们提供了一条完整的曲线，我们可以沿着它走向未来，远远超出原始研究的范围。这使我们能够估计对制定理性的长期医疗保健决策至关重要的终生收益和成本 [@problem_id:4984926]。

### 选择你的叙事：[模型选择](@entry_id:155601)的艺术

如果我们有一个包含不同参数故事的库——指数、威布尔、对数正态等等——我们如何为我们的数据选择正确的一个？这是统计建模中的一个核心问题。

仅仅选择最贴合观测数据的模型是不够的。一个有很多参数的非常复杂的模型总是可以被塑造成完美追踪数据的样子，就像一个离奇的阴谋论可以被编造来解释任何一套过去的事件一样。但这样的模型通常是“过拟合”的；它在记忆我们特定数据集中的噪音，而不是捕捉潜在的信号。它将是一个糟糕的未来预测器。

我们需要一个原则来平衡[拟合优度](@entry_id:637026)与简洁性。这就是**[信息准则](@entry_id:636495)**的作用，如**[赤池信息准则 (AIC)](@entry_id:193149)** 和**[贝叶斯信息准则 (BIC)](@entry_id:181959)**。公式很简单：
-   $\mathrm{AIC} = 2k - 2 \ell$
-   $\mathrm{BIC} = k \ln(n) - 2 \ell$

在这里，$\ell$ 是最大化[对数似然](@entry_id:273783)值（衡量[模型拟合](@entry_id:265652)数据程度的指标），$k$ 是模型中的参数数量（衡量其复杂性的指标），$n$ 是样本大小。

把它看作一个评分系统。我们寻找 AIC 或 BIC 得分*最低*的模型。$-2\ell$ 项奖励拟合良好的模型。惩罚项——AIC 为 $2k$，BIC 为 $k \ln(n)$——惩罚过于复杂的模型。对于更大的样本量，BIC 的惩罚更严厉，因此它比 AIC 更倾向于选择更简单的模型。通过使用这些准则，我们可以比较不同的参数模型，并选择一个为我们的数据提供最有说服力和最简约的故事的模型 [@problem_id:4928643] [@problem_id:4558566]。

然而，需要注意的是，这种比较仅在模型处于公平竞争环境中才有效。似然必须是同一类型。这意味着我们可以用 AIC 来比较威布尔模型和[对数正态模型](@entry_id:270159)（两者都使用“全”似然），但我们不能用它来直接将它们中的任何一个与标准的 Cox 模型（使用“部分”似然）进行比较 [@problem_id:4985124]。

### 当故事变得复杂时

参数生存模型的世界不是静止的。它不断发展以讲述越来越复杂的故事。
-   **非比例风险**：如果药物的效果随时间减弱怎么办？简单模型中恒定风险比的假设就被违反了。现代**灵活的参数模型**使用[样条](@entry_id:143749)（有点像统计学家的复杂曲线板），可以模拟随时间平滑变化的风险比，从而提供一个更现实的画面 [@problem_id:4991143]。
-   **未观测到的异质性**：为什么即使考虑了所有已知因素后，一家医院的患者比另一家医院的患者表现更好？可能存在实践质量或患者群体中未被观察到的差异。**脆弱模型**通过包含随机效应来扩展参数模型，以捕捉这种聚类现象，承认我们的模型并非无所不知 [@problem_id:4985124]。
-   **数据的局限性**：最后，我们必须谦虚。如果我们的数据稀疏，特别是由于重度删失而导致事件非常少时，区分一个故事与另一个故事会变得极其困难。数据可能不包含足够的信息来分别识别模型的形状和尺度，导致估计值不稳定、不确定。一个模型的好坏取决于为其提供信息的数据 [@problem_id:4985929]。

总而言之，参数生存模型不仅仅是数学公式。它们是科学叙事的工具包。它们提供了一种语言来描述随时间变化的基本过程，一种从不完整信息中学习的原则性方法，以及一个窥探未来的大胆框架。通过理解它们的原理，我们能更好地倾听我们数据试图讲述的故事。

