## 引言
从 RNA 测序（[RNA-seq](@entry_id:140811)）数据中量化基因表达是现代生物学的基石，然而原始数据却具有欺骗性的复杂性。仅仅计算映射到每个基因的序列片段数量，并不能提供其活性的无偏且可靠的图像。这是因为较长的基因自然会产生更多的片段，而不同的测序实验产生的总读数数量也不同。面对这些扭曲，我们如何才能进行公平的比较？本文通过深入探讨一种最常见的归一化方法：[每百万转录本](@entry_id:170576)数（[TPM](@entry_id:170576)），来应对这一根本性挑战。

本文将引导您理解 TPM 的精妙逻辑，揭示它如何解决这些关键的[测量问题](@entry_id:189139)。第一章“原理与机制”将详细介绍计算 [TPM](@entry_id:170576) 的分步方法，解释其直观的解读方式，并揭示其最重大的陷阱——组分数据陷阱。随后，“应用与跨学科联系”一章将探讨 TPM 背后的核心思想如何从基因组学延伸到经济学等领域，以及对其原理的深入理解如何为生物学中的高级实验设计（从单细胞研究到临床诊断）提供信息。

## 原理与机制

要真正理解**每百万转录本数 (TPM)** 是什么，我们必须首先认识到它旨在解决的问题。想象一下，你正试图在一条巨大的、无限长的公路上对所有不同类型的汽车进行普查，但你唯一的工具是一台视野极窄、对准单一车道的相机。你看不到完整的汽车，只能看到从你镜头前经过的碎片。你如何才能估算出，比如说，紧凑型轿车与豪华轿车的比例？这正是 **RNA 测序 ([RNA-seq](@entry_id:140811))** 中面临的挑战。我们希望量化一个细胞中每种信使 RNA (mRNA) 转录本的丰度，但我们的测序机器只能“看到”这些转录本的短片段。仅仅计算每个基因的片段数是不够的；这是一次有偏好的普查。

### 两大偏好：长度与深度

我们的公路普查面临两个明显的问题。首先，一辆长长的豪华轿车远比一辆短小的紧凑型轿车更有可能被你的相机看到，即使公路上两者都只有一辆。这就是**长度偏好**。在 [RNA-seq](@entry_id:140811) 中，一个更长的基因转录本为片段的采样提供了更多的“空间”。因此，一个低表达的长基因可能产生与一个高表达的短基因同样多的片段。为了在*同一个样本内*对“豪华轿车”基因和“紧凑型轿车”基因进行公平比较，我们必须首先校正这种长度偏好。最简单的方法是将我们为每个基因计数的片段数除以该基因的长度。这给了我们一个单位长度的片段“速率”，这是对实际转录本丰度更好的一个替代指标。

第二个问题是观察时间。如果你观察公路五分钟，你看到的汽车片段会比观察一小时少得多。这就是**文库大小**偏好（也称为测序深度）。在 RNA-seq 中，一个样本可能产生 2000 万个片段读数，而另一个样本则产生 5000 万个。第二个样本中的一个基因可能有更多的读数，仅仅是因为测序运行更深，而不是因为该基因更活跃。为了比较这两个样本*之间*的表达水平，我们必须对每个文库中的总读数数量进行归一化。

### TPM 计算方法：一种基于比例的视图

归一化方法就是为校正这些偏好而设计的计算方法。一种早期的方法，RPKM（每千碱基每百万读数），试图一次性解决这两个问题，但其方式存在一些细微问题。[TPM](@entry_id:170576)，即[每百万转录本](@entry_id:170576)数，通过改变操作顺序，提供了一个更优雅、更直观的解决方案。让我们一步步地遵循 TPM 的计算方法 [@problem_id:2579641] [@problem_id:4589994]：

1.  **首先校正基因长度：** 对于样本中的每个基因，取其原始片段计数值（$c_i$），然后除以该基因的长度（$L_i$），长度通常以千碱基（数千个碱基）为单位。这样就得到了每个基因的“每千碱基读数”（RPK）值。这一步将所有基因等同化，就好像它们具有相同的长度，从而解决了我们的豪华轿车与紧凑型轿车的问题。
    $$ RPK_i = \frac{c_i}{L_i} $$

2.  **估算总转录本池：** 现在，将样本中所有基因的 RPK 值相加。这个总和，我们称之为 $S$，代表了你文库中经过长度归一化的总读数。你可以把它看作是样本中所有转录本总数的一个替代指标。
    $$ S = \sum_{j} RPK_j = \sum_{j} \frac{c_j}{L_j} $$

3.  **计算比例：** 将每个基因各自的 RPK 值除以这个总和 $S$。这个计算，$\frac{RPK_i}{S}$，得出了属于基因 $i$ 的总转录本池的*比例*。这就是 TPM 的精妙之处。它回答了这样一个问题：“在这个细胞的所有转录本中，有多大比例来自这个特定的基因？”

4.  **缩放到“每百万”值：** 比例通常是小数，为了方便，我们将这个分[数乘](@entry_id:155971)以一百万。结果就是 [TPM](@entry_id:170576) 值。
    $$ TPM_i = \left( \frac{RPK_i}{S} \right) \times 10^6 = \left( \frac{c_i/L_i}{\sum_{j} (c_j/L_j)} \right) \times 10^6 $$

这种方法的美妙之处在于，根据其构造，如果你将单个样本中所有基因的 [TPM](@entry_id:170576) 值相加，你将总是得到恰好 $1,000,000$ [@problem_id:2579641] [@problem_id:4611316]。这意味着 TPM 值有一个非常清晰的解释：如果一个基因的 [TPM](@entry_id:170576) 为 120，就表示从该细胞中每采样一百万个转录本（在校正长度偏好后），其中将有 120 个来自该基因。它将基因的表达表示为其在总[转录组](@entry_id:274025)中所占的比例份额 [@problem_id:1740502]。

### 组分陷阱：两个披萨的故事

这种比例视图非常有用，但它隐藏着一个微妙而危险的陷阱。因为一个样本中的 [TPM](@entry_id:170576) 值总和必须为一个常数，它们代表了一个封闭的、零和的系统。这个属性被称为**组分性**。让我们把公路的比喻换成披萨。

想象一下，你分析一个披萨，并通过其表面积被各种配料覆盖的百分比来描述它：50% 意大利辣香肠，40% 蘑菇，10% 橄榄。这是披萨 A 的“[TPM](@entry_id:170576)”画像。

现在，考虑披萨 B。它的蘑菇和橄榄的绝对量与披萨 A 完全相同。然而，你的一位意大利辣香肠狂热爱好者朋友在上面多加了一大堆意大利辣香肠，现在它覆盖了 80% 的面积。由于总面积必须是 100%，蘑菇和橄榄发生了什么变化？它们的百分比*必须*减少。披萨 B 的画像现在可能是 80% 意大利辣香肠，15% 蘑菇，5% 橄榄。

如果你比较这些百分比值，你会错误地得出结论，认为披萨 B 的蘑菇和橄榄比披萨 A 少。但从绝对量上看，它们是相同的！一个组分的大幅增加人为地“压缩”了所有其他组分的比例表示。这就是**组分陷阱**。

这种情况在 RNA-seq 中完全相同。让我们考虑一个基于思想实验的鲜明数值例子 [@problem_id:4591012]。我们有三个基因，长度分别为 $L_1=1.0$、$L_2=2.0$ 和 $L_3=1.0$ kb。

-   **样本 A（正常细胞）：** 计数值为 $c_1^A = 100$、$c_2^A = 100$、$c_3^A = 100$。根据我们的计算方法，我们发现 $TPM_1^A \approx 400,000$。

-   **样本 B（癌细胞 - 情景 1）：** 基因 1 上调。计数值为 $c_1^B = 200$、$c_2^B = 100$、$c_3^B = 100$。此时，$TPM_1^B \approx 571,428$。TPM 的[倍数变化](@entry_id:272598)为 $\frac{571,428}{400,000} \approx 1.43$。[TPM](@entry_id:170576) 值如预期般上升了。

-   **样本 B'（癌细胞 - 情景 2）：** 现在，想象基因 1 的计数值上调到 200，但一个致[癌基因](@entry_id:138565)——基因 2——被*大规模*上调。计数值为 $c_1^{B'} = 200$、$c_2^{B'} = 800$、$c_3^{B'} = 100$。基因 1 的计数值仍然与情景 1 中的 200 相同。但是因为基因 2 是“额外的意大利辣香肠”，它极大地膨胀了总转录本池。当我们在这种情况下计算基因 1 的 TPM 时，我们发现 $TPM_1^{B'} \approx 285,714$。

这是一个惊人的悖论。基因 1 的原始计数值从样本 A 到样本 B' 翻了一番，但其 [TPM](@entry_id:170576) 值却*减半*了。[倍数变化](@entry_id:272598)现在是 $\frac{285,714}{400,000} \approx 0.71$。基于 TPM，你会得出基因 1 被下调的结论，而实际上它的转录本数量上升了。基因 1 的生物学信号被另一个基因的变化完全扭曲了。这表明 [TPM](@entry_id:170576) 对于转录组组成的变化并不稳健 [@problem_id:4591068]。

### 为正确的工作选择正确的工具

这并不意味着 TPM 是一个“坏”的指标。这意味着我们必须用它来回答它被设计来解决的问题。

-   **在单个样本内部**，TPM 非常出色。如果你想知道在这个样本中基因 X 还是基因 Y 的表达水平更高，TPM 是正确的工具，因为它校正了长度，从而允许公平的比较。

-   **在不同样本之间**，正如我们所见，TPM 可能会产生误导。在进行**[差异表达](@entry_id:748396)**分析——即寻找在不同条件（例如，肿瘤 vs. 正常）之间发生变化的基因——时，我们的主要问题是关于单个基因在样本间的变化。对于一个给定的基因，它的长度是恒定的，所以长度校正不是主要问题 [@problem_id:2385488]。真正的问题是组分偏好。

因此，像 [DESeq2](@entry_id:167268) 或 edgeR 这样统计上稳健的[差异表达](@entry_id:748396)方法是使用**原始计数**的。它们采用更复杂的样本间归一化策略（如 TMM 或[中位数](@entry_id:264877)比值法），这些策略旨在找到不受少数高表达“异常”基因影响的稳定缩放因子。它们实质上是在归一化披萨的其余部分时，试图忽略那些“额外的意大利辣香肠”。将预先计算的 [TPM](@entry_id:170576) 值用于这些工具在统计上是不合适的，因为它违反了它们基于整数计数建立的底层模型，并引入了这些工具旨在避免的组分偏好 [@problem_id:4333098] [@problem_id:2424929]。

最终，TPM 是一个强大的概念，它优雅地解决了长度和文库大小的核心偏好，提供了一个清晰的、比例化的转录组视图。它的美在于其简单性和清晰的解释。但理解其固有的组分性质是明智使用它的关键，也是理解为什么寻求完美的“基因表达单位”的探索促使科学家们开发出一个多样化的工具包，其中每个工具都为一项非常具体的工作而打磨。

