## 引言
[材料科学](@article_id:312640)和[纳米技术](@article_id:308656)的核心存在一个根本性挑战：不仅要能看到材料的原子结构，还要能定量测量主导其行为的无形作用力。传统的电子显微镜虽然能提供纳米世界令人惊叹的图像，但在高精度绘制内部应变、电势或[磁场](@article_id:313708)等关键物理属性方面往往力不从心。这种“看见”与“测量”之间的差距，限制了我们为先进技术理解和设计材料的能力。

四维扫描透射[电子显微学](@article_id:307280) ([4D-STEM](@article_id:364288)) 已成为填补这一鸿沟的革命性[范式](@article_id:329204)。通过在探测的每一个点上捕获散射电子的完整图谱，该技术将[电子显微镜](@article_id:322064)从一个简单的相机转变为一个定量的测量实验室。本文将对这一强大的方法进行全面概述。

我们将首先探讨[4D-STEM](@article_id:364288)的核心**原理与机制**，从电子探针与材料之间的量子相互作用，到利用丰富的四维数据重建图像的叠层衍射成像 (ptychography) 计算魔法。随后，我们将探寻其多样的**应用与跨学科联系**，展示[4D-STEM](@article_id:364288)如何用于创建应变的定量图谱、可视化[电场和磁场](@article_id:325058)，并解决从半导体物理到电化学等领域的实际挑战。

## 原理与机制

想象一下，你身处一个漆黑的房间，想要了解中间一座复杂雕塑的形状。你可以在它上面打一束宽广的漫射光，然后拍一张照片。你会对它的形态、阴影和轮廓有一个大致的了解。这是传统的方法。但如果你有一支激光笔呢？你可以用光束追踪雕塑表面的每一平方英寸。在每一个点上，你都可以绕着房间走动，观察激光如何向各个方向散射——你照亮的每一个点都会产生独特的光斑。

第二种方法正是**四维扫描透射[电子显微学](@article_id:307280) ([4D-STEM](@article_id:364288))**的精髓。我们用一束精细聚焦的电子束代替激光笔，用仅有原子厚度的材料样品代替雕塑。我们在每个扫描位置拍摄的“照片”不是一张简单的图像，而是一幅完整的**衍射图谱**——一张描绘电子在“接触”材料该精确位置后如何散射的图。这给了我们一个极其丰富的四维数据集：二维用于探针在样品上的位置（$x$和$y$），另外二维用于探测器上的坐标，这些[坐标映射](@article_id:316912)了电子的散射角。

### 量子握手：波、探针与势

要真正理解正在发生什么，我们必须记住，电子不仅仅是一个微小的台球；它是一种波。它的行为由一个复值[波函数](@article_id:307855)来描述，我们称之为$\psi(\mathbf{r})$，其中$\mathbf{r}$表示空间中的一个位置。显微镜中精密的[磁透镜](@article_id:364711)将这些电子波的相干流塑造成一个聚焦的**探针**，一个我们可以标记为$\psi_{0}(\mathbf{r})$的[波前](@article_id:376761)。

当这个探针波穿过我们的薄材料样品时，它主要与原子核及其周围电子云产生的静电势相互作用。你可以把样品想象成一个由无形的势的“山丘”和“山谷”构成的景观。当电子波穿过这个景观时，它的相位会发生偏移。对于薄样品，这种相互作用非常简单：样品将入射探针波乘以一个**透射函数**，$T(\mathbf{r}) = \exp[i\sigma V_{p}(\mathbf{r})]$。这里，$V_{p}(\mathbf{r})$是材料的投影势（沿电子束方向平均的[势景观](@article_id:334694)），而$\sigma$是一个取决于电子能量的常数。

因此，从样品另一侧出现的波——**出射波**——是探针和样品透射函数的乘积：
$$
\psi_{\text{exit}}(\mathbf{r}, \mathbf{R}) = \psi_{0}(\mathbf{r}-\mathbf{R}) \, T(\mathbf{r})
$$
其中$\mathbf{R}$是我们扫描探针的位置。这个方程是我们量子握手的核心。它告诉我们，离开样品的波携带了关于我们测量工具（探针，$\psi_{0}$）和我们测量对象（样品，$T(\mathbf{r})$）的信息。

那么，我们实际测量的是什么？我们看不到出射波本身。相反，显微镜的透镜执行了一项非凡的自然计算：它们进行了一次物理上的**傅里叶变换**。到达我们远场探测器的波是出射波的傅里叶变换，我们称之为$\Psi(\mathbf{q}, \mathbf{R})$。探测器作为一个简单的粒子计数器，只能记录强度，也就是这个复数波的模的平方：
$$
I(\mathbf{q}, \mathbf{R}) = |\Psi(\mathbf{q}, \mathbf{R})|^2 = \left|\mathcal{F}\left\{\psi_{0}(\mathbf{r}-\mathbf{R}) \exp[i\sigma V_{p}(\mathbf{r})]\right\}\right|^{2}
$$
这就是[4D-STEM](@article_id:364288)的**正向模型**[@problem_id:2490491]。它是一个数学公式，预测了在任何给定的探针位置下我们应该在探测器屏幕上看到的图谱。请注意一个关键点：当我们将波进行平方以获得强度时，我们丢弃了它的相位。这个“[相位问题](@article_id:307182)”困扰了成像科学家一个世纪。但正如我们将看到的，我们数据集的四维特性为我们提供了一种巧妙的方法来恢复它。

你可能会问：“如果你只是移动探针，根据傅里叶变换的位移定理，不就只是增加一个简单的相位因子，而强度图谱$I$不会改变吗？” 这是一个很好的问题，其答案揭示了其中的奥秘。位移定理仅在被变换的*整个函数*都发生位移时才适用。在这里，只有探针$\psi_{0}(\mathbf{r}-\mathbf{R})$移动；样品$T(\mathbf{r})$保持不动。正是移动的、有结构的探针与静止的、有结构的样品之间的干涉，导致衍射图谱在我们扫描时以丰富且[信息量](@article_id:333051)大的方式发生变化[@problem_id:2490491]。

### 解码电磁波：从衍射到发现

那个四维的衍射图谱堆栈是一个宝箱。问题是，我们如何打开这把锁？事实证明有好几把钥匙，每一把都能解开关于材料的不同秘密。

#### 感受力：看见电场

让我们从一件惊人的事情开始。在我们的日常世界里，电场是看不见的。我们知道它们存在——它们使我们的马达转动，让我们的手机充电——但我们*看不见*它们。[4D-STEM](@article_id:364288)让我们能够做到这一点。

根据定义，电场是静电势的负梯度，$\mathbf{E}_p(\mathbf{r}) = -\nabla V_p(\mathbf{r})$。它代表了施加在带电粒子上的力。当我们的电子探针穿过一个有电场的区域时，电子束会发生偏转，就像彗星被太阳的引力偏转一样。

这种偏转在我们的数据中是如何体现的呢？实空间中电子束的偏转对应于[倒易空间](@article_id:300367)中整个衍射图谱的位移。如果我们计算每个探针位置的衍射图谱的**[质心](@article_id:298800) (COM)**，我们会发现一个优美而直接的关系：[质心](@article_id:298800)的位移$\Delta \langle \mathbf{k} \rangle(\mathbf{R})$与探针下平均的投影电场$\mathbf{E}_p(\mathbf{R})$成正比[@problem_id:161944]。
$$
\Delta \langle \mathbf{k} \rangle(\mathbf{R}) \propto -\int |\psi_0(\mathbf{r}-\mathbf{R})|^2 \nabla V_p(\mathbf{r}) d^2\mathbf{r} \approx \mathbf{E}_p(\mathbf{R})
$$
通过简单地追踪我们扫描探针时衍射图谱的“摆动”，我们就可以创建一幅材料内部电场的直接矢量图。我们可以观察到场在[半导体](@article_id:301977)p-n结处的集中情况，或者它们是如何由[铁电材料](@article_id:337542)中的极化产生的。这种技术，通常被称为**微分[相衬](@article_id:318112) (DPC)**，将无形化为有形。甚至还有更复杂的方法，例如计算相邻探针位置图谱之间的互相关，可以提供关于场结构的精细信息[@problem_id:127005]。

#### 解开谜题：叠层衍射成像的力量

测量平均场已经很了不起了，但如果我们想要更多呢？如果我们想以原子级分辨率重建*整个*样品透射函数$T(\mathbf{r})$呢？那探针又该怎么办？我们的探针形成透镜从来都不是完美的；它们存在**[像差](@article_id:342869)**（如球差$C_s$或[像散](@article_id:353428)$A_1$），这些[像差](@article_id:342869)会扭曲探针的形状，模糊我们的视野。

这就是**叠层衍射成像 (ptychography)**（源自希腊语*ptyche*，意为“折叠”）技术发挥作用的地方。它是一种计算显微镜，可以解析四维数据集，从而同时求解物函数和探针函数。关键在于**重叠**。我们以网格方式扫描我们的探针，其中每个被照亮的圆盘都与其相邻的圆盘有实质性的重叠。这意味着样品的同一部分会从多个扫描位置被探针的不同部分照亮。这种信息共享创造了一个巨大且高度冗余的数学难题。

叠层衍射成像[算法](@article_id:331821)是一个迭代过程。它从物函数和探针的初始猜测开始。使用正向模型，它计算出*应该*产生的衍射图谱。它将此与*实际*测量的图谱进行比较，并用差异来更新其对物函数的猜测。然后它移动到下一个扫描位置，使用更新后的物函数来更新其对探针的猜测。它在所有扫描位置之间循环，交替地在物函数和探针估计之间“折叠”信息，直到计算出的数据收敛并与实验数据匹配。

真正非凡的是，这种“盲”[算法](@article_id:331821)可以以惊人的精度求解探针的像差。我们不需要一个完美的显微镜来获得一个完美的图像！数据本身就包含了关于显微镜缺陷的信息，而[算法](@article_id:331821)可以将物函数从成像它的[透镜像差](@article_id:353956)中[解耦](@article_id:641586)出来[@problem_id:2490541]。通过将重建的探针相位拟合到一组像差多项式，我们可以精确测量像$C_s$和$A_1$这样的系数。我们用实验来校准自身。

### 拨开迷雾：丰富数据的力量

为什么要费这么大劲进行计算呢？因为带有叠层衍射成像的[4D-STEM](@article_id:364288)使我们能够解决传统显微镜无法解决的问题。

想象一下，对厚水层中的[生物分子](@article_id:342457)或充满液体的[电化学电池](@article_id:324173)中的[催化剂](@article_id:298981)纳米颗粒进行成像。在传统显微镜中，图像会变得一片模糊。电子在厚厚的液体中发生多次散射，包括[弹性散射](@article_id:312566)和非弹性散射（损失能量）。这会冲淡传统方法所依赖的精细相位衬度[@problem_id:2492577]。

然而，叠层衍射成像是一种基于模型的技术。如果我们的简单正向模型不再有效，我们可以简单地将其换成一个更强大的模型。我们可以使用**多层切片[算法](@article_id:331821)**，它将厚样品视为一叠薄片，并让电子波逐一穿过它们，同时考虑所有多次散射事件。叠层衍射成像[算法](@article_id:331821)在这种更复杂的物理模型下同样有效，使其能够在计算上穿透多次散射的“迷雾”，重建出内部物体的清晰图像。

此外，[4D-STEM](@article_id:364288)具有极高的**剂量效率**。在显微学中，我们用来形成图像的每一个电子也会损伤样品。对于脆弱的材料来说，这是最终的限制。在[4D-STEM](@article_id:364288)中，每一个穿过样品并击中我们像素化探测器的电子都被记录下来并用于重建。信息分布在四维数据集中的数十万个像素上。叠层衍射成像使用一种统计上最优的方法（基于[电子计数](@article_id:314471)的[泊松统计](@article_id:344013)）来从这些数据中榨取每一比特的信息[@problem_id:2492577]。这意味着我们能以比以往任何时候都更少的样品损伤获得更高质量的图像。

即使对于固体晶体，四维数据的丰富性也是革命性的。在一个小纳米晶体的正常衍射图谱中，由于电子束的会聚和晶体本身的有限尺寸，斑点不是完美的点；它们被展宽成圆盘[@problem_id:2484410]。利用完整的四维数据集，我们可以解开这些效应，对不同取向进行平均，并产生比以往任何时候都更清晰、更容易解释的数据，从而彻底改变我们解析新材料原子结构的方式[@problem_id:2484419]。

最后，[4D-STEM](@article_id:364288)不仅仅是一种成像技术，它更是一种新的[范式](@article_id:329204)。通过在每个点捕获完整的散射波场，我们从简单地拍摄照片，转变为在每个像素点上进行全面的光学实验，从而解锁一个关于场、势和[原子结构](@article_id:297641)的定量信息世界，这些信息塑造了我们的物质世界。