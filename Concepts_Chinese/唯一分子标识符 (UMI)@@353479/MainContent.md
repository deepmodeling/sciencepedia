## 引言
在[分子生物学](@article_id:300774)领域，精确计算 DNA 或 RNA 等分子的数量是一项基础而又异常艰巨的任务。样本中（尤其是来自单个细胞的样本）的物质含量极微，必须使用聚合酶链式反应 (PCR) 等技术进行扩增。然而，PCR 并非完美的复印机；它以不同的效率产生拷贝，引入了显著的偏好，可能扭曲生物学结论。这提出了一个关键问题：当测量工具本身引入如此多的噪声时，我们如何能信任我们的数据？本文介绍了一种强大的解决方案：[唯一分子标识](@article_id:323939)符 (UMI)。我们将首先深入探讨 UMI 的“原理与机制”，解释这些分子“序列号”如何校正扩增偏好，以及必须克服的计算障碍。随后，“应用与跨学科联系”一章将展示这一精妙方法如何彻底改变了从癌症研究到生态学等多个领域，开启了[定量生物学](@article_id:324809)的新纪元。

## 原理与机制

想象一下，你是一名图书馆员，任务是清点一座巨大而神奇的图书馆里每一本独特的书籍。问题是，这个图书馆里有个拿着复印机的淘气小精灵。每当你从书架上拿下一本书准备清点时，小精灵就会把它抢走，随机复印出若干份——有时一份，有时一千份——然后把整叠书塞还给你。如果你只计算经手的书籍总数，你的计数会因小精灵的任性而变得毫无希望地偏斜。一本被大量复印的书，看起来可能比一百本只被复印了几次的不同的书更为普遍。

这本质上就是[分子生物学](@article_id:300774)家面临的挑战。当我们想要计数分子时，比如代表活性基因的信使 RNA (mRNA) [转录](@article_id:361745)本，我们的起始材料量非常少。为了获得足够用于分析的量，我们使用一种名为**[聚合酶链式反应](@article_id:303359) (PCR)** 的技术，也就是我们的分子复印机。不幸的是，PCR 有点像那个小精灵：它不会以相同的效率扩增每一个分子。某些分子由于其序列或结构的原因，比其他分子更容易被复制。如果计算最终的 DNA 序列数量——即来自测序仪的“读数” (reads)——我们将得到一个对原始分[子群](@article_id:306585)体极其扭曲的看法 [@problem_id:2045433]。

我们如何智胜这个小精灵呢？解决方案既简单又巧妙。在让小精灵靠近我们的书之前，我们先拿出一支笔，在每一本*原始*书籍的扉页上写下一个独一无二的序列号。现在，无论产生了多少副本，我们都可以忽略其庞大的数量。我们只需收集所有的书，列出我们看到的所有唯一序列号，然后对这个列表进行计数。唯一序列号的总数就是原始书籍的真实数量。

这正是**[唯一分子标识](@article_id:323939)符 (UMI)** 背后的原理。

### 分子序列号

UMI 是一段短的随机[核苷酸](@article_id:339332)序列（DNA 的 A、C、G、T 构建模块），在实验过程的最开始，即在 PCR 复印机启动*之前*，通过化学方式连接到每个原始分子上——比如一个 mRNA [转录](@article_id:361745)本。这个标签成为分子不可分割的一部分。由 PCR 产生的每一个拷贝都将携带其亲本分子的 UMI 的相同副本 [@problem_id:2754114]。

在测序了数百万条读数后，我们得到了一个庞大的数据集。为了得到真实的计数，我们执行一个称为**去重 (deduplication)** 的过程。我们将所有来自同一基因的读数分组。然后，在该组内，我们查看它们的 UMI。所有共享完全相同 UMI 序列的读数都被视为源自单个起始分子的重复。我们将这整个组合并，只计为一。

让我们看一个简单的例子。假设我们正在研究一个名为 GRA 的基因，并从中获得了九条测序读数，它们的 UMI 如下 [@problem_id:2336573]：

- 读数 1 UMI: `AGTCG`
- 读数 2 UMI: `CCTAG`
- 读数 3 UMI: `AGTCG`
- 读数 4 UMI: `GATAC`
- 读数 5 UMI: `CCTAG`
- 读数 6 UMI: `AGTCG`
- 读数 7 UMI: `GATAC`
- 读数 8 UMI: `TGCGC`
- 读数 9 UMI: `CCTAG`

粗略的计数会告诉我们有 9 个分子。但如果我们计算*不同*的 UMI 序列，我们只发现四种：`AGTCG`、`CCTAG`、`GATAC` 和 `TGCGC`。UMI `AGTCG` 出现了三次，`CCTAG` 出现了三次，`GATAC` 出现了两次，`TGCGC` 出现了一次。通过计算唯一的标签，我们校正了小精灵的工作，并得出结论：我们的原始样本仅包含 4 个 GRA [转录](@article_id:361745)本分子。最终的读数计数与分子计数无关；重要的是标签的多样性。

### 穿透噪声：双基因的故事

这种校正的力量不仅限于学术层面；它能完全改变我们的生物学结论。想象一个单细胞实验，我们测量两个基因——基因 Alpha 和基因 Beta 的活性 [@problem_id:1520802]。测序后，原始数据如下：

-   **基因 Alpha**：总共 12,000 条测序读数。
-   **基因 Beta**：总共 3,000 条测序读数。

基于此，你可能会得出基因 Alpha 的活性（表达水平）是基因 Beta 四倍的结论。但让我们看看 UMI 数据：

-   **基因 Alpha**：12,000 条读数仅对应 **150 个不同的 UMI 序列**。
-   **基因 Beta**：3,000 条读数对应 **600 个不同的 UMI 序列**。

UMI 计数是我们对原始分子数量的最佳估计。事实与原始读数所显示的相反：基因 Beta 的丰度实际上是基因 Alpha 的四倍 ($600 / 150 = 4$)！

发生了什么？基因 Alpha 是 PCR 小精灵的最爱。平均而言，其 150 个原始分子中的每一个都被复制以产生 $12000 / 150 = 80$ 条读数。基因 Beta 就没那么幸运了；其 600 个分子中的每一个只产生了 $3000 / 600 = 5$ 条读数。UMI 让我们能够看穿这种**扩增偏好**，测量真实的生物学情况。

### 各有其用的条形码：UMI 与样本索引

UMI 的工作是为*单个样本内*的每个分子提供一个独特的身份。但现代生物学追求规模化。我们常常希望一次性分析数百甚至数千个样本——例如，分析来自不同患者的细胞，或者甚至在一次实验中分析数千个单个细胞 [@problem_id:2837390]。为了做到这一点而不把所有东西搞混，我们需要另一层标记。

这就是**样本索引 (sample index)** 的工作，它通常被称为**样本条形码 (sample barcode)**。在将不同样本混合在一起之前，来自特定样本的每个分子都会被标记上*相同*的样本索引。对于单细胞实验，这是一种**[细胞条形码](@article_id:350328) (cell barcode)**，即一个对每个细胞内容物都唯一的标签。

把它想象成一个庞大的[文件系统](@article_id:642143) [@problem_id:2754114]。
-   **样本索引**或**[细胞条形码](@article_id:350328)**是文件柜抽屉外部的标签。它告诉你正在查看哪个样本（例如，“患者 A”或“细胞 #582”）。
-   **UMI** 是盖在那个抽屉*内部*每张纸上的唯一序列号。

在对混合文库进行测序后，计算机会首先读取每个序列上的样本索引，将数据分拣回正确的数字“抽屉”中（这个过程称为 demultiplexing）。然后，在每个抽屉*内部*，它使用 UMI 来计算原始文档的真实数量。这两种条形码协同工作，但用途完全不同：一种用于将读数分配给样本，另一种用于计算该样本内的唯一分子 [@problem_id:2886927]。

### 追求完美的风险：当好标签变坏时

UMI 的概念很美好，但现实世界是混乱的。可能会出现两种我们必须巧妙处理的主要并发症：碰撞和错误。

#### 试管中的生日派对

如果纯粹偶然地，两个不同的原始分子被分配了完全相同的 UMI，会发生什么？这被称为 **UMI 碰撞 (UMI collision)**。当这种情况发生时，我们无法再区分这两个分子；它们及其所有的 PCR 复制品将被合并在一起，错误地计为一个分子，从而导致计数偏低。

这是一个经典的概率谜题，类似于著名的“[生日问题](@article_id:331869)”：在一群人中，两个人同一天生日的概率是多少？即使人数相对较少，这个概率也会变得出奇地高。同样，UMI 碰撞的概率取决于两个因素：你标记的分子数量 $M$ 和你的 UMI 池的大小 $K$。如果你的 UMI 是一个长度为 $L$ 的随机序列，那么池的大小为 $K = 4^L$。

如果你尝试用一个 8 [核苷酸](@article_id:339332)的 UMI 标记 $M = 200,000$ 个分子，UMI 池的大小仅为 $K = 4^8 = 65,536$。你的分子比标签还多，因此根据鸽巢原理，碰撞不仅是可能的，而且是必然的！一个 8-mer UMI 完全不足以胜任这项任务。如果我们使用 12-mer UMI 会怎样？UMI 池的大小会激增至 $K = 4^{12} \approx 1670$ 万。虽然好得多，但至少发生一次碰撞的概率仍然接近 100%，预计会发生超过一千次碰撞 [@problem_id:2754114]。因此，对于高复杂度的实验，需要更长的 UMI，或者必须使用统计方法来估计和校正碰撞次数。

#### 序列号中的拼写错误

第二个并发症是分子标签本身可能会出现“拼写错误”。测序仪并非完美无瑕，在读取 UMI 序列时可能会出错。如果一个真实的 UMI，比如 `ACGTACGT`，有 100 个 PCR 拷贝，其中一些拷贝可能会被测序仪误读为 `ACGTACGA`（一个字母的差异） [@problem_id:2579686] [@problem_id:2848942]。

如果我们天真地计算每个独特的字符串，我们会将 `ACGTACGT` 计为一个分子，而将错误的 `ACGTACGA` 计为*第二个*虚假分子。这会夸大我们的计数。结果是在[序列空间](@article_id:313996)中，围绕着真实的、高计数的 UMI，形成了一个错误 UMI 的“家族”。

我们如何解决这个问题？生物信息学家已经开发出巧妙的[算法](@article_id:331821)。一个简单的想法是**邻近合并 (adjacency collapsing)**：你找到所有非常相似的 UMI（例如，仅[相差](@article_id:318112)一个[核苷酸](@article_id:339332)，即汉明距离为 1），并将它们全部分为一组。这种方法可能过于激进，因为它可能会错误地合并两个真实但看起来相似的 UMI。

一种更复杂的方法是**定向合并 (directional collapsing)** [@problem_id:2848942]。该方法认识到错误是从高计数的 UMI 产生低计数的 UMI。因此，它仅在稀有 UMI 与常见 UMI 相似，*并且*稀有 UMI 的计数足够低，可以解释为是常见 UMI 测序错误的可能结果时，才将稀有 UMI 合并到常见 UMI 中。例如，如果 UMI `A` 有 100 条读数，而一个相似的 UMI `B` 只有 2 条读数，[算法](@article_id:331821)会将 `B` 定向合并到 `A` 中。但如果 `A` 有 100 条读数，而 `B` 有 25 条，那么 `B` 仅仅是错误的可能性就较小，因此它们会被分开处理。这展示了为获得准确计数所需的分子生物学、概率论和计算机科学之间美妙的相互作用。

### [收益递减](@article_id:354464)法则：UMI 饱和曲线

考虑到所有这些，任何实验的一个关键问题是：我的测序量*足够*吗？如果我们[测序深度](@article_id:357491)不够，我们可能会完全错过一些原始分子，特别是那些扩增效果不佳的分子。

我们可以用 **UMI 饱和曲线**来可视化这个过程 [@problem_id:2890007]。这条曲线描绘了你发现的唯一 UMI 数量与你测序的总读数之间的关系。最初，曲线急剧上升。你测序的几乎每一个新读数都会揭示一个你以前没见过的 UMI。但随着你继续测序，你会越来越多地重复采样到已经计数的 UMI。曲线开始变平，接近一个平台期。这个平台期代表了你文库中原始、已标记分子的总数。

这条曲线的形状可以用一个优美而简单的方程来描述：$S(n) = 1 - \exp(-c)$，其中 $S(n)$ 是在 $n$ 次读取后你所观察到的总 UMI 的比例，而 $c$ 是你文库中每个原始分子平均被测序的读数。如果这条曲线仍在陡峭上升，你需要进行更多的测序。如果它已经趋于平缓，你就可以确信已经捕获了大部分的多样性，更多的测序将产生递减的回报。

### 了解其局限性

UMI 是一种革命性的工具，但它并非魔法。它们旨在解决一个特定的主要问题：PCR 扩增带来的偏好。至关重要的是要记住它们*无法*修复什么。UMI 是在 RNA 从细胞中提取并转化为其 DNA 拷贝 (cDNA) *之后*附加的。在此步骤之前发生的任何偏好对 UMI 来说都是不可见的 [@problem_id:2579686] [@problem_id:2886927]。例如，如果某些 RNA 分子更难提取或转化为 cDNA 的效率较低，那么它们从一开始就会被低估。UMI 会忠实地计算到达标记阶段的分子，但它无法告诉你那些在过程中丢失的分子。

理解我们工具的强大功能及其局限性是优秀科学的标志。[唯一分子标识](@article_id:323939)符源于一个简单而优雅的想法，它提供了一个强大的透镜，让我们能够穿透扩增的扭曲迷雾，以前所未有的清晰度来计数生命分子。