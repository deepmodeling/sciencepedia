## 引言
在追求科学理解的过程中，Bayes 定理提供了一个强大的框架，用以根据新证据更新我们的信念。这一过程依赖于[似然函数](@entry_id:141927)——一座连接理论模型与观测数据的数学桥梁。然而，随着科学模型变得日益复杂，从模拟星系形成到基因的复杂互动，这座桥梁常常会崩塌。对于许多现代的、基于模拟器的模型而言，似然函数根本无法写出，这在我们最前沿的理论与我们用现实检验它们的能力之间留下了一道鸿沟。

这正是[近似贝叶斯计算](@entry_id:746494)（ABC）所要解决的挑战。它是一种革命性的、概念上优雅的方法，重新建立了这种联系。ABC通过采用一种由仿真驱动的“猜测与检验”哲学，绕过了对似然函数的需求。它主张，如果一个模型能够很好地描述现实，那么它应该能够生成与我们实际观测到的数据相似的数据。本文将揭开这一强大技术的神秘面纱。

首先，在 **原理与机制** 部分，我们将探讨ABC的工作原理，从其简单的核心思想到使其可行的涉及总结统计量和容忍度阈值的实际近似方法。我们还将审视对于稳健推断至关重要的挑战和验证方法。随后，**应用与跨学科联系** 部分将带您领略ABC在科学领域的影响，展示它如何被用于揭示生物学中的进化历史、表征工程学中的材料特性，以及探索宇宙学中我们宇宙的基本参数。

## 原理与机制

想象你是一名试图侦破一桩复杂案件的侦探。你有一组线索——即数据——和一众嫌疑人，每个人都有自己的故事——即一个可能发生事件的模型，其中包含可调整的细节，称为**参数**。你的工作是找出哪个嫌疑人的故事最能解释这些线索。在科学中，这个过程被一个名为 Bayes 定理的优美逻辑形式化了。它告诉我们如何根据证据来更新我们对嫌疑人的信念（**先验**概率），从而得出最终的判断（**后验**概率）。

这个过程的核心，也就是连接你的模型和数据的桥梁，是一个被称为**[似然函数](@entry_id:141927)**的概念。对于任何给定的嫌疑人（一组参数 $\theta$），似然 $p(\text{data} \mid \theta)$ 告诉你观测到你实际发现的线索的概率。高[似然](@entry_id:167119)意味着嫌疑人的故事让线索显得合情合理；低似然则意味着这个故事让线索看起来像一个离奇的巧合。整个现代统计学和[科学推断](@entry_id:155119)的引擎都构建在这座桥梁之上。

但如果这座桥梁崩塌了呢？

### 当桥梁崩塌时：难以处理的[似然函数](@entry_id:141927)

在许多科学前沿领域，我们对世界的模型已经变得惊人地复杂。我们可能在[模拟宇宙](@entry_id:754872)学中星系的形成 [@problem_id:3489611]，或一个种群中基因在数千年间的复杂互动 [@problem_id:2618227]，或[化学反应](@entry_id:146973)中分子的混沌嘶嘶声 [@problem_id:2628054]。这些模型不再是你可以写在黑板上的简单方程。它们是精密的计算机程序，是**[生成模型](@entry_id:177561)**，一步步地模拟一个过程。我们可以给模拟器一组参数（比如宇宙中暗物质的数量），它就会为我们生成一个可供观察的合成宇宙。我们*可以*做到这一点。我们可以从我们的模型中生成数据。

但问题在于：对于许多这样的模拟器，我们无法写出[似然函数](@entry_id:141927)。我们可以让故事向前发展，但我们无法计算某个特定结局的概率。为什么？原因很深奥，但直觉却出奇地简单。想象一台机器，设计用来将一粒沙子滴落在一块大画布上。如果这台机器非常复杂，它的输出可能会受到一些微妙的约束。例如，它可能只能沿着一条错综复杂、无限细的线滴下沙子。这条线在画布上的总面积为零。沙粒落在任何*不*在线上的点的概率都是零。但是，它落在该线上某个特定点的概率*密度*是多少呢？是无限大！一个行为良好的[概率密度函数](@entry_id:140610)，即似然函数的概念，就这样失效了。这就是数学家所说的**[奇异测度](@entry_id:191565)**，它是复杂模拟器的一个共同特征，这些模拟器的输出具有隐藏的、刚性的结构 [@problem_id:3489611] [@problem_id:3429464]。

当[似然函数](@entry_id:141927)难以处理时，理论与数据之间的经典桥梁便不复存在。我们只剩下一个强大但沉默的神谕：一个能够向我们展示我们理论预测结果的模拟器，却无法告诉我们任何特定结果的可能性有多大。我们该如何进行科学研究呢？

### 一个带有深刻转折的儿童游戏

这正是[近似贝叶斯计算](@entry_id:746494)（ABC）登场之处，其想法如此简单而优雅，近乎儿戏。如果你无法计算你的理论与数据匹配的似然，为什么不直接试试看呢？

想象一下这个想法的最基本版本。这是一个简单的“猜测与检验”游戏：

1.  从你的先验信念中，为你的模型随机挑选一组参数，比如一个[突变率](@entry_id:136737)和一个种群大小。
2.  使用这些参数运行你的复杂计算机模拟，生成一个合成数据集。
3.  将你的合成数据与真实的、观测到的数据进行比较。如果它们*完全*匹配，你就保留你猜测的参数。如果不匹配，你就丢弃它们。
4.  将这个过程重复数百万次。

你最终保留下来的参数集合，惊人地，是来自真实贝叶斯后验分布的完美样本！你没有碰触似然函数就完成了贝叶斯推断。你建造了一座新的桥梁。

当然，这里有一个障碍。对于任何现实的科学问题——从DNA序列到天文图像——数据都非常复杂，以至于模拟结果与其*完全*匹配的概率实际上为零 [@problem_id:2521316]。你就算把计算机运行到宇宙终结，也可能永远不会接受任何一个参数。这个优美而简单的想法，在其纯粹形式下，是完全不切实际的。

### 使其可行的两个近似

为了把这个不可能的游戏变成一个革命性的工具，我们需要放宽规则。我们引入了两个“近似”，这赋予了ABC它的名字和力量。

#### 近似1：不比较所有内容，只比较关键部分

我们不再要求整个庞大的模拟数据集与真实数据集完全匹配，而是比较几个关键特征。这些特征被称为**总结统计量**。对于遗传学家来说，他们可能不会逐个碱基比较两个基因组，而是比较遗传差异的总数，或者一个显示种群中不同突变出现频率的图表（**[位点频率谱](@entry_id:163689)**） [@problem_id:2521316] [@problem_id:2618227]。

这是第一个近似。通过将一个丰富的数据集简化为少数几个数字，我们不可避免地会丢弃一些信息。ABC的艺术与科学在于选择能够捕捉到我们所关心参数的最相关信息的总结统计量。如果一个参数的主要影响体现在DNA的长程结构上，而我们的总结统计量只测量局部属性，那么无论我们其余的分析多么巧妙，我们的推断都将对该参数视而不见 [@problem_id:2618227]。理想的情况，即**充分统计量**，是一种不丢失任何信息的总结。虽然这是一个优美的理论概念，但对于那些最需要ABC的复杂模型来说，充分统计量几乎是无法获得的 [@problem_id:3429464]。

#### 近似2：不要求完全匹配，只要“足够接近”

第二个近似是放宽“匹配”的定义。我们不再要求总结统计量完全相同，而是当模拟的总结量 $S_{sim}$ 与观测的总结量 $S_{obs}$ “足够接近”时，就接受它。我们用两个要素来定义“足够接近”：一个用于衡量总结量之间差距的**距离函数** $\rho(S_{sim}, S_{obs})$，以及一个**容忍度** $\epsilon$。如果距离小于我们的容忍度，我们就接受该参数。

因此，实用的ABC拒绝算法如下所示 [@problem_id:2521316]：

1.  从[先验分布](@entry_id:141376)中抽取参数 $\theta$。
2.  从模型 $p(x \mid \theta)$ 中模拟数据 $x'$。
3.  计算总结统计量 $S(x')$。
4.  如果 $\rho(S(x'), S_{obs}) \le \epsilon$，则接受 $\theta$。否则，拒绝它。
5.  返回第1步并重复。

被接受的 $\theta$ 值集合构成了我们的近似后验分布。我们用一个可以计算的东西取代了难以处理的似然 $p(S_{obs} \mid \theta)$：即生成一个落在我们观测总结量周围小气泡内的模拟的概率 [@problem_id:3288743]。

### 细节决定成败：校准你的ABC机器

这个简单的算法功能极其强大，但它不是一个神奇的黑匣子。这两个近似引入了我们必须掌握的微妙之处。

首先，存在一个涉及容忍度 $\epsilon$ 的根本性权衡。如果你选择一个非常大的 $\epsilon$，你的接受气泡就会很大，你会很快接受参数。但你的近似会很粗糙，模糊了后验分布的特征。当你将 $\epsilon$ 缩小至零时，你的近似会越来越精确，收敛到基于你所选总结统计量的精确后验。然而，你的接受率——即落入气泡内的模拟比例——会急剧下降 [@problem_id:3286901]。

随着你增加更多的总结统计量，这个问题会变得更加严重。这就是臭名昭著的**[维度灾难](@entry_id:143920)**。想象你的总结统计量只是一个数字。你的接受区域是一条线上的一个小区间。现在想象它是两个数字。接受区域是平面上的一个小圆。如果是三个，它就是空间中的一个小球。这个接受区域的“体积”随着你增加维度而呈指数级缩小 [@problem_id:3326892] [@problem_id:3429464]。为了在高维总结空间中获得任何接受的样本，你被迫使用一个大的 $\epsilon$，但这又违背了近似的目的。因此，ABC的艺术在于一个精妙的平衡：选择一小组[信息量](@entry_id:272315)极大的总结统计量。

其次，**距离函数** $\rho$ 的选择至关重要。它定义了你的接受气泡的形状，并决定了你最关心哪些差异。假设你的一个总结统计量天然就有很大的噪声和[方差](@entry_id:200758)，而另一个则非常精确。一个简单的欧几里得（“直线”）距离将完全被那个带噪声的统计量所主导。你最终会接受那些匹配噪声但忽略信号的模拟 [@problem_id:2400312]。一个更好的方法是对总结量进行缩放，给予更精确的统计量更大的权重。一个更复杂的方法是使用**[马氏距离](@entry_id:269828)**（Mahalanobis distance），它同时考虑了总结量之间的[方差](@entry_id:200758)和相关性，从而有效地学习接受气泡的最佳形状。

### 我们如何知道我们不是在自欺欺人？

鉴于所有这些近似——总结量、容忍度——我们如何能相信ABC分析得出的最终[后验分布](@entry_id:145605)？我们是否只是在拟合噪声？这就是[科学方法](@entry_id:143231)向内反思的地方，我们测试我们自己的工具。

验证像ABC这样的贝叶斯方法的黄金标准是一个称为**基于仿真的校准 (SBC)** 的程序 [@problem_id:2628054]。其逻辑简单而深刻：如果我们的推断机器工作正常，它在平均意义上应该是无偏的。如果我们用它来分析我们已经知道正确答案的数据，它应该能恢复那个答案。

SBC循环的工作方式如下：
1.  想象你是“自然之神”。通过从[先验分布](@entry_id:141376)中抽样，为你的模型挑选一组“真实”参数。这是你隐藏的基准真相。
2.  使用这些真实参数运行你的完整模拟，生成一个合成的“观测”数据集。
3.  现在，戴上你的“侦探”帽子。假装你不知道真实参数，并使用你完整的ABC流程来分析你刚刚创建的合成数据集。这将给你一个近似的[后验分布](@entry_id:145605)。
4.  检查“真实”参数（你在第1步中知道的）在你刚刚计算出的后验分布中的位置。它是在最低的10%？最高的5%？还是中间？计算它的秩次。
5.  将整个过程重复数千次，每次都使用一个新的“真实”参数和一个新的合成数据集。

如果你的ABC流程校准良好，“真实”参数应该以相等的频率落在它们各自后验分布的每个[分位数](@entry_id:178417)中。所有模拟的秩次图应该是一条平坦的线，就像一个[均匀分布](@entry_id:194597)。如果图是U形的，说明你的[后验分布](@entry_id:145605)太窄（过于自信）。如果它是驼峰形的，说明它们太宽（不够自信）。如果它是偏斜的，说明你的估计有偏差。SBC是一个强大的诊断工具，它让我们在将推断机器应用于真实数据之前对其进行调试，确保我们实际上没有在自欺欺人。

最终，[近似贝叶斯计算](@entry_id:746494)不仅仅是一种巧妙的算法。它是一种哲学宣言。它断言，如果你能写下一个关于数据如何产生的生成性故事，即使你无法在数学上对其进行逆向推导，你仍然可以进行严谨、有原则的[贝叶斯推断](@entry_id:146958)。它将统计推理的力量带到了现代科学中复杂的、基于模拟的前沿，让我们能够用数据的判断来面对我们最宏大的理论。

