## 应用与跨学科联系

我们已经看到，“围绕中心点划分”（PAM）[算法](@article_id:331821)是一个极其直接的想法：从数据集中找到一组最佳的代表，或称“[中心点](@article_id:641113)”（medoids），作为簇的中心。然而，它的美不仅在于其简单性，还在于其深远的通用性。[算法](@article_id:331821)本身对其数据*是什么*漠不关心；它只要求一件事——距离的概念。只要我们能定义一个有意义的函数 $D(x_i, x_j)$ 来告诉我们两个对象“相距多远”，PAM 就能开始工作。

这个简单的要求就像一把万能钥匙，在众多领域中解锁了应用。通过改变我们对“距离”的定义，我们可以将这单一的[算法](@article_id:331821)带上一段旅程，从商业分析的具体世界到[网络科学](@article_id:300371)和[机器学习理论](@article_id:327510)的抽象前沿。让我们踏上这段旅程，看看它打开了哪些大门。

### 从购物者到基因：表格数据的世界

聚类最直观的应用或许在于数据表的世界，其中行是对象，列是它们的特征。

思考一下一家现代企业试图了解其客户所面临的挑战 [@problem_id:3135274]。一家公司可能有一个客户数据库，每个客户由混合的数值数据（年龄、月度支出）和[分类数据](@article_id:380912)（偏好邮件，是/否）描述。目标是找到自然的客户群体以定制营销活动。简单的欧几里得距离不适合处理这类混合数据。但我们可以设计一个更智能的距离函数——比如 Gower 距离——它能适当地处理每种特征类型，对数值特征进行缩放，并对分类特征的不匹配进行惩罚。通过将这个自定义的距离矩阵输入到 PAM [算法](@article_id:331821)中，我们可以对客户群进行划分。最终得到的中心点不是抽象的平均值，而是*真实的客户*，他们作为其所在群体的原型：例如“年轻、高消费的邮件爱好者”，或“年长、不常购物的顾客”。这使得企业能够超越一刀切的营销，设计出与每个簇的特定特征产生共鸣的定向策略，并衡量响应的“提升”效果。

现在，让我们将同样的想法从会议室转移到生物实验室 [@problem_id:3135248]。我们不再有客户，而是一组生物样本，也许是来自不同患者的组织。我们不再有购买习惯，而是成千上万个基因的表达水平。数据仍然构成一个表格，但我们对“距离”的概念必须改变。我们通常对基因表达的绝对水平不那么感兴趣，而更关心整体的*模式*或*轮廓*。两个样本是否显示出相似的基因“开启”或“关闭”的趋势？为此，**[相关距离](@article_id:639235)**是完美的。距离 $d(\mathbf{x}, \mathbf{y}) = 1 - \rho(\mathbf{x}, \mathbf{y})$，其中 $\rho$ 是皮尔逊[相关系数](@article_id:307453)，如果两个基因表达向量高度相关，则距离很小，无论它们的基线水平如何。当 PAM 使用[相关距离](@article_id:639235)对这些样本进行[聚类](@article_id:330431)时，中心点就成为[代表性](@article_id:383209)的生物状态。我们可能会发现三个不同的簇，其[中心点](@article_id:641113)分别对应于“健康”状态、“A型”疾病状态和“B型”疾病状态。这是[计算生物学](@article_id:307404)中发现疾病亚型、识别药物靶点和理解生命复杂机制的基本工具。

### 导航网络：在图上[聚类](@article_id:330431)

如果我们的数据并不存在于一个简单的表格中呢？如果它是一个网络，一个由边连接的节点的集合呢？

把万维网想象成一个巨大的有向图，其中网页是节点，超链接是边 [@problem_id:3135243]。我们如何找到相关页面的簇？一个网页不是一个数字向量，但我们可以在图本身上定义一个距离。最直接的是**最短路径距离**：从页面 A 到页面 B 所需的最少点击次数。在计算了所有页面对的这个距离之后，我们就得到了一个距离矩阵。PAM 随后可以接收这个矩阵，并识别出 $k$ 个中心点，这些中心点是真实的网页，充当了网络上不同主题或社区的“重心”。一个中心点可能是一个主要的新闻中心、一个关键的学术门户，或是一个粉丝社区中的核心页面。

我们可以做得更复杂。除了简单的[最短路径](@article_id:317973)，我们还可以使用更能捕捉图整体结构的距离。**通勤时间距离**是一个优美的例子，它借鉴了电路和[随机游走](@article_id:303058)的类比 [@problem_id:3135240]。想象图是一个[电阻网络](@article_id:327537)。两个节点之间的“[有效电阻](@article_id:336025)”是它们连接性的一个鲁棒度量，它考虑了它们之间所有可能的路径，而不仅仅是最短的一条。这个电阻与通勤时间成正比：一个[随机游走](@article_id:303058)者从节点 A 到节点 B 再返回所需的平均步数。如果节点位于图中各自独立的、有瓶颈的区域，这个距离就很大。通过使用通勤时间距离，PAM 可以揭示出更微妙、更鲁棒的[社区结构](@article_id:314085)，这些结构对少数零散边的增减不那么敏感。这揭示了聚类、线性代数（通过[图拉普拉斯算子](@article_id:338883)）和物理学概念之间的深刻联系。

### 数据的真实形态：在[流形](@article_id:313450)上聚类

通常，[高维数据](@article_id:299322)有一个秘密：它可能看起来很复杂，但实际上它存在于一个更简单、更低维的、被扭曲和弯曲的表面上。这被称为[流形](@article_id:313450)（manifold）。一个经典的例子是“瑞士卷”数据集 [@problem_id:3135283]。在卷起的纸上，有些点在它们所处的 3D 空间中可能非常接近（通过“穿透”各层），但如果你必须沿着表面行走，它们可能非常遥远。

在这种数据上使用标准的欧几里得距离进行聚类是灾难性的；它会将来自卷的不同层的点分到一组。关键是找到*[测地距离](@article_id:320086)*——即沿着[流形](@article_id:313450)表面的距离。ISOMAP [算法](@article_id:331821)提供了一种绝佳的方法来近似这个距离：首先，构建一个邻域图，将每个点连接到其最近的邻居。然后，[测地距离](@article_id:320086)被近似为该图内的[最短路径](@article_id:317973)距离。

一旦我们有了这个[测地距离](@article_id:320086)矩阵，剩下的就容易了。我们把它交给 PAM。现在，[算法](@article_id:331821)正在使用“尊重[流形](@article_id:313450)”的距离进行工作，它正确地识别出沿着卷曲路径的簇。这展示了一个关键原则：PAM 的力量不仅在于[算法](@article_id:331821)本身，还在于它与有意义的距离度量的合作。找到正确的距离测量方法，你就能揭示出数据的真实、内在结构。

### 超越空间中的点：抽象应用

当我们将其应用于根本不是空间中点的对象时，PAM 灵活性的真正威力才得以显现。

如果我们的数据由**排名或偏好**组成呢 [@problem_id:3135226]？想象一下，调查人们对五部电影的排名。每个人提供一个电影的[排列](@article_id:296886)。我们如何找到品味相似的人群？我们可以定义两个排名之间的距离，例如**肯德尔 tau 距离**，它计算相对顺序不同的电影对的数量。有了这个距离度量，PAM 就可以对排名进行聚类。每个簇的[中心点](@article_id:641113)是一个真实的调查反馈，它充当了该群体“共识排名”的角色，这是社会选择理论和[推荐系统](@article_id:351916)中的一个强大概念。

我们可以通过**[核技巧](@article_id:305194)**（kernel trick）将这种抽象更进一步 [@problem_id:3135217]。假设我们有复杂的对象——比如文本文档、[蛋白质结构](@article_id:375528)或图像——为它们定义[向量表示](@article_id:345740)很困难，但定义一个成对的*相似性*函数 $K(x, y)$ 却很容易。这个函数被称为核。值得注意的是，我们可以使用[核函数](@article_id:305748)来计算对象在一个非常高维的“特征空间”中的平方距离，而无需真正进入那个空间：$d^2(x,y) = K(x,x) + K(y,y) - 2K(x,y)$。通过计算所有对的这个距离，我们仅使用核矩阵就可以运行 PAM。这种“核 k-medoids”是一种极其强大的技术，允许我们对几乎任何能想出有意义相似性度量的对象类型进行[聚类](@article_id:330431)。

最后，我们甚至可以将该[算法](@article_id:331821)应用于机器学习实践本身。在构建模型时，我们必须选择其“超参数”。尝试所有组合在计算上是昂贵的。我们可以转而评估一个大的设置网格，为每个设置获得一个性能向量。然后，我们可以使用 PAM 对这些性能向量进行[聚类](@article_id:330431)，并选择中心点作为一小组有[代表性](@article_id:383209)的超参数配置进行进一步研究 [@problem_id:3135244]。这是一个元应用：用一个[算法](@article_id:331821)来优化另一个[算法](@article_id:331821)。

### 一个新视角：找出异类

到目前为止，我们都专注于簇本身。但是那些不属于*任何*簇的点呢？这种简单的视角转变将 PAM 变成了一个强大的**[异常检测](@article_id:638336)**工具 [@problem_id:3135289]。

这个想法很优雅。我们首先在一组“正常”观测值的数据集上运行 PAM。得到的[中心点](@article_id:641113)定义了正常行为的核心区域。然后，对于任何新点，我们可以将其**异常分数**定义为它到最近[中心点](@article_id:641113)的距离。如果一个点靠近某个中心点，那么它就属于正常的范畴。如果它离*所有*[中心点](@article_id:641113)都很远，它就位于簇之间的未知领域——它是一个潜在的异常。

这种方法比简单地寻找远离全局平均值的点要鲁棒得多。它捕捉到了正常性可以是多模态的这一事实；可以有几种不同“类型”的正常。为了使这一点更严谨，我们甚至可以将[极值理论](@article_id:300529)（EVT）的工具应用于异常分数的分布，以设定一个统计上合理的阈值来判断什么算作“太远”。这将 PAM 从一个描述性工具转变为一个预测性工具，在欺诈检测、工业监控和医疗诊断中具有关键应用。

从市场营销和[基因组学](@article_id:298572)到图论和数据的抽象几何，PAM [算法](@article_id:331821)的旅程证明了一个单一、优美思想的力量。通过简单地重新定义我们对“距离”的概念，我们几乎可以在任何可以想象的领域中探索隐藏的结构。