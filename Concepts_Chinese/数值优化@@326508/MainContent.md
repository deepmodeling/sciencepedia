## 引言
[数值优化](@article_id:298509)的核心是做出最佳决策的科学。从寻找新分子的最稳定构型到确定金融投资组合的最优策略，科学与工程领域的许多最具挑战性的问题都可以被框定为在广阔的可能性空间中寻找最优解。然而，这些“搜索空间”往往过于复杂，无法进行穷尽式探索，从而带来了巨大的计算挑战。本文旨在引导读者了解为高效导航这些复杂景观而开发出的基本策略。

我们的旅程将从“原理与机制”一章开始，在这一章中，我们将用一个简单的类比来揭开梯度下降法、[动量法](@article_id:356782)以及强大的牛ton法等核心[算法](@article_id:331821)的神秘面纱。我们将探讨它们面临的挑战以及用于克服这些挑战的巧妙技巧。随后，“应用与跨学科联系”一章将展示这些抽象[算法](@article_id:331821)如何成为不可或缺的工具，解决[计算化学](@article_id:303474)、数据科学以及合成生物学等前沿领域的实际问题。读完本文，您不仅将清楚地了解[优化算法](@article_id:308254)*做什么*，还将理解它们*如何*为跨学科的发现与创新提供动力。

## 原理与机制

想象一下，你是一名徒步者，迷失在一片被浓雾笼罩的广阔丘陵地带。你的目标是找到整个区域的绝对最低点。你看不见完整的地图，但能感觉到脚下的地面。你的策略是什么？这个简单的类比抓住了[数值优化](@article_id:298509)的精髓。这片景观就是我们的“成本函数”——一个我们希望最小化的量的数学表示，例如分子的能量、机器学习模型的误差或物流网络的财务成本。找到最低点是我们的目标。因为对于许多现实世界的问题，景观极其复杂，以至于在计算上不可能找到真正的全局最小值——这类问题被称为NP难问题——我们必须发明巧妙而高效的策略来导航这片地形 [@problem_id:1426650]。我们需要能够在合理时间内找到一个非常低的点（如果不是最低点的话）的[算法](@article_id:331821)。

### 下山之术

对于我们身处迷雾中的徒步者来说，最直观的策略是感受地面的坡度，并朝着最陡峭的下坡方向迈出一步。这正是最基本的[优化算法](@article_id:308254)之一——**最速下降法**（更广为人知的名称是**[梯度下降法](@article_id:302299)**）背后的逻辑。用数学术语来说，函数的**梯度** $\nabla V$ 是一个指向最陡峭*上坡*方向的向量。要下坡，我们只需朝着与梯度*相反*的方向迈出一小步。如果我们当前的位置是[坐标向量](@article_id:313731) $\mathbf{r}_i$，我们的下一个位置 $\mathbf{r}_f$ 就是沿着 $-\nabla V$ 方向移动一小段距离得到的：

$$
\mathbf{r}_{f} = \mathbf{r}_i - \lambda \nabla V(\mathbf{r}_i)
$$

其中 $\lambda$ 是一个称为**步长**或**[学习率](@article_id:300654)**的小数值，它控制我们每一步迈出的距离。通过重复这个过程，我们迭代地“下山”，直到无法再下降，最终停在一个山谷中——即一个局部最小值 [@problem_id:1388030]。

这听起来万无一失，但有一个陷阱。想象我们的徒步者不是在一个圆形的丘陵上，而是在一个狭长的峡谷里。最陡峭的下山路不是沿着峡谷底部平缓的斜坡，而是 резко 地朝向最近的峡谷壁。徒步者迈出一步，结果靠近了对面的峡谷壁，现在最陡峭的方向又指回了峡谷的另一边。他们最终在峡谷两侧来回Z字形移动，沿着峡谷主轴的前进速度慢得令人沮丧。这种Z字形行为是病态问题的典型标志，此时函数景观在某些方向上被拉伸或挤压。对于其中一些函数，一种每次只优化一个坐标的更简单方法，在单步中取得的进展甚至可能比“复杂”的[最速下降路径](@article_id:342384)更大 [@problem_id:2162623]。这种低效率是寻找更智能导航方法的主要动机。

### 获得动量

让我们回到徒步者的例子。如果他们不仅仅考虑当前位置的坡度，而是像一个沿地形滚动的重球一样行动呢？滚动的球具有**动量**。它不会轻易改变方向；它过去的路徑会影响未来的轨迹。这就是**[动量法](@article_id:356782)**背后精妙的思想。

在这些[算法](@article_id:331821)中，我们不仅更新位置，还更新一个“速度”向量 $\mathbf{v}$。这个速度累积了过去梯度方向的[移动平均](@article_id:382390)值。更新规则变成一个两步过程：首先，通过加上新的梯度方向来更新速度，然后根据这个新速度移动位置。

$$
\mathbf{v}_{k+1} = \beta \mathbf{v}_k - \eta \nabla f(\mathbf{x}_k)
$$
$$
\mathbf{x}_{k+1} = \mathbf{x}_k + \mathbf{v}_{k+1}
$$

在这里，$\beta$ 是一个“摩擦”参数，决定了我们保留多少过去的速度信息。在我们的狭窄峡谷中，导致Z字形移动的梯度横向分量在每一步都趋于指向相反方向，因此它们在速度项中相互抵消。与此同时，指向峡谷底部的分量则持续累加，从而在正确的方向上建立起速度。这使得[动量法](@article_id:356782)能够冲过山谷，平滑[振荡](@article_id:331484)，并比简单[梯度下降法](@article_id:302299)快得多地收敛 [@problem_id:2187770]。

但高速也伴随着高风险。如果动量参数 $\beta$ 或步长 $\eta$ 太大，我们的“球”可能会冲过谷底，滚上另一侧的[山坡](@article_id:379674)。它甚至可能获得过多的能量以至于其路径发散，飞向无穷大。完全有可能出现这样一种情况：简单的[梯度下降法](@article_id:302299)缓慢但確実に找到最小值，而参数看似合理的[动量法](@article_id:356782)却变得不稳定并完全失败 [@problem_id:2187798]。这凸显了[数值优化](@article_id:298509)中的一个深刻道理：没有万能的[算法](@article_id:331821)，参数的选择是一门微妙的艺术。

### 看见曲率

到目前为止，我们的徒步者只使用了关于地面*坡度*的信息——即一阶[导数](@article_id:318324)。如果他们也能感受到*曲率*——即二阶[导数](@article_id:318324)呢？他们就能判断自己是在一个完美的碗状山谷中，还是在一个穹顶上，或是在一个薯片状的[鞍点](@article_id:303016)上。这是从[一阶方法](@article_id:353162)到**二阶方法**的飞跃，其中最著名的是**牛顿法**。

这些方法使用**Hessian矩阵** $H$，它是函数所有可能的二阶[导数](@article_id:318324)的集合。Hessian矩阵描述了函数景观在各个方向上的局部曲率。有了这些信息，我们能做的就远不止是向下迈出一小步。我们可以在当前位置对函数景观拟合一个完美的二次曲面（一个多维抛物面），然后一步到位，直接跳到该拟合[曲面](@article_id:331153)的底部。

对于一个真正是简单二次碗形的函数，牛顿法只需一步就能找到精确的最小值。它的威力惊人。但如果我们不在一个漂亮的碗形中会怎样呢？如果我们在一个[鞍点](@article_id:303016)上，局部的[二次近似](@article_id:334329)就没有最小值。为确保[算法](@article_id:331821)稳定，我们必须保证我们的步长总是朝向一个最小值。这意味着我们的局部[二次模型](@article_id:346491)必须是“碗形的”，或者用数学术语来说，Hessian矩阵必须是**正定的**。如果真实的Hessian矩阵不是正定的，一个常用而优雅的技巧是通过数学方法对其进行“微调”，即给它加上一个微小的完美碗形（[单位矩阵](@article_id:317130)的倍数，$\mu I$）。这种[正则化](@article_id:300216)确保我们总是用一个具有明确最小值的形状来建[模函数](@article_id:316137)景观，从而引导我们的步伐朝着富有成效的方向前进 [@problem_id:2215343]。

当牛顿法起作用时，它以惊人的速度收敛，这一特性被称为[二次收敛](@article_id:302992)。每一步的误差大约是前一步误差的平方；如果你有0.1的误差，下一步就会有大约0.01，然后是0.0001，依此类推。然而，这种威力是脆弱的。该方法的致命弱点再次是病态条件。对于一个高度拉伸的景观，虽然在最小值附近的最终收敛*速率*仍然是二次的，但这种超快收敛实际发生的*区域*可能会急剧缩小。此外，牛顿法的核心涉及求解一个包含Hessian矩阵的[线性方程组](@article_id:309362)。如果[Hessian矩阵](@article_id:299588)是病态的，在精度有限的真实计算机上求解这个方程组会在数值上变得不稳定，计算出的步长可能会严重失准。这就是理论之美与计算现实碰撞的地方 [@problem_id:2378369]。

### 穿越迷宫

所有这些方法——梯度下降法、[动量法](@article_id:356782)、[牛顿法](@article_id:300368)——都是为了找到我们*已身处其中*的山谷的底部。它们是**局部优化**方法。但如果景观是一片有无数山谷的广阔山脉呢？找到一个**局部最小值**很容易，但最终的奖赏是**[全局最小值](@article_id:345300)**——整张地图上的最低点。

最直接的全局优化方法是**多起点搜索**。我们只需将徒步者随机放置在景观的多个位置，让他们从每个起点开始进行[局部搜索](@article_id:640744)。之后，我们比较他们找到的所有局部最小值，并挑选出最好的一个。这是一种暴力方法，但往往出奇地有效，并且可以在单一[局部搜索](@article_id:640744)因起点不佳而陷入次优山谷的情况下取得成功 [@problem_id:2176775]。

存在更复杂的策略。与其在找到局部最小值时就放弃，如果我们的[算法](@article_id:331821)能够“隧道穿越”山脉找到一个新的、未被探索过的吸引盆地呢？这就是**隧道[算法](@article_id:331821)**的核心思想。在找到一个局部最小值 $\mathbf{x}^*$ 后，[算法](@article_id:331821)会转换[目标函数](@article_id:330966)本身，实质上是用一个数学惩罚项“填满”它刚刚找到的山谷。这使得点 $\mathbf{x}^*$ 及其周围对优化器产生排斥。随后的搜索则被驱动去寻找一个新的点 $\mathbf{x}_{\text{new}}$，该点位于不同区域，但其函数值不高于刚刚找到的值。这个新点成为新一輪[局部搜索](@article_id:640744)的起始种子，希望能下降到一个更深的山谷中 [@problem_id:2176797]。

### 当景观有尖锐边缘时

我们的旅程已经穿越了平滑起伏的山丘，在这些地方，“坡度”和“曲率”等概念总是有明确的定义。但许多现代优化问题，特别是在[数据科学](@article_id:300658)和[信号恢复](@article_id:324029)领域，呈现出一种不同的景观：一种带有尖锐折痕、角落和边缘的景观。考虑这样一个问题：找到一个方程组的“最简单”或“最稀疏”的解，这项任务通常涉及最小化**[L1范数](@article_id:348876)** ($\|x\|_1 = \sum |x_i|$)。[绝对值函数](@article_id:321010) $|x_i|$ 在 $x_i=0$ 处有一个尖角，这意味着我们的函数景观是不可微的。

在这些[尖点](@article_id:641085)上，梯度没有定义。我们熟悉的[梯度下降法](@article_id:302299)和[牛顿法](@article_id:300368)工具箱失效了。**[非光滑优化](@article_id:346855)**的这一挑战需要一套新工具。我们必须推广梯度的概念。在光滑点，只有一个[梯度向量](@article_id:301622)指向上坡。在角落处，则有整整一*套*可能的“上坡”方向，这个概念由**[次梯度](@article_id:303148)**捕捉。像**[近端梯度法](@article_id:639187)**这样的[算法](@article_id:331821)就是为这个世界设计的。它们巧妙地将[问题分解](@article_id:336320)为一个光滑[部分和](@article_id:322480)一个非光滑部分，前者可以用类似梯度的步骤处理，后者则用一个名为**[近端算子](@article_id:639692)**的特殊工具来解决。这个算子通常能为问题的非光滑部分找到精确的最小值。这个强大的框架将“下山”这一直观思想扩展到了一个更广阔、更迷人的复杂景观宇宙中 [@problem_id:2208386]。

