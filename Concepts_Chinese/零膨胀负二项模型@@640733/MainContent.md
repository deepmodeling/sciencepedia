## 引言
在数据分析的世界里，计数是一项基本任务。从购买产品的顾客到细胞中的分子，这些计数通常是理解复杂系统的关键。然而，这种看似简单的数据常常带来两个棘手的挑战：其变异性远大于标准模型的预测（[过度离散](@entry_id:263748)），并且包含数量惊人的零值。这些“过量零值”带来了一个统计学难题：它们是偶然的结果，还是代表了一种根本不同的状态？正是在传统建模的这一空白处，零膨胀负二项 (ZINB) 模型提供了一个强大的解决方案。

本文从基本原理到前沿应用探讨 ZINB 模型。在接下来的章节中，您将学习该模型的构造方式及其参数的含义。**原理与机制**一章将揭开[过度离散](@entry_id:263748)等概念的神秘面纱，并区分“结构性”零和“抽样”零，从而从零开始构建 ZINB 模型。随后，**应用与跨学科联系**一章将展示这一统计工具如何革新生物学、电子商务和人工智能等领域，为解读充满零值的数据提供更清晰的视角。

## 原理与机制

要真正理解一个模型，我们必须从头开始构建它，不是从方程开始，而是从一个谜题开始。我们的谜题来自现代生物学领域，科学家们可以在这里窥视单个活细胞，并计算特定基因的信使 RNA (mRNA) 分子的数量。这种被称为**单细胞 RNA 测序 (scRNA-seq)** 的技术，就像试图在广阔的田野中，一次一小块地对萤火虫进行普查 [@problem_id:3348609]。我们的发现既迷人又令人困惑。

### 消失分子的谜题

让我们想象一下，我们正在数这些分子萤火虫。如果它们的出现是一个完全随机、独立的过程——就像雨点落在人行道的方砖上一样——我们会[期望计数](@entry_id:162854)遵循一个简单而优雅的定律：**泊松分布**。这个[分布](@entry_id:182848)是计数随机事件的基石。它有一个显著的特性：其[方差](@entry_id:200758)等于其均值。如果你知道一个方块中雨点的平均数量，你就知道了这个数量在不同方块之间变化的全部信息 [@problem_id:3314531]。

但是，当我们观察真实的 scRNA-seq 数据时，大自然给我们出了个难题。我们总是发现两种奇怪的模式。首先，计数的[方差](@entry_id:200758)几乎总是远*大于*均值。这种现象被称为**[过度离散](@entry_id:263748)** [@problem_id:2400336]。就好像我们田野里的某些地块莫名其妙地容易出现大群的萤火虫，而其他地块则很昏暗，从而产生了超出预期的变异性。其次，我们发现了数量惊人的零萤火虫地块——远超泊松模型所能预测的数量。这被称为**零膨胀**。这是一个关于消失分子的谜题。为什么数据噪声这么大，这些零值又是从哪里来的？

### 两种随机性来源的故事：负二项分布

谜题的第一部分，即[过度离散](@entry_id:263748)，暗示了我们关于“闪烁”速率单一且恒定的简单假设是错误的。如果田野的每一块（即每个细胞）都有其固有的亮度呢？有些天生充满活力，有些则很安静。这在生物学中正是如此。即使是基因上相同的细胞也不是完全相同的机器。它们在大小、年龄和代谢状态上都有所不同，所有这些都造成了**外在[异质性](@entry_id:275678)** [@problem_id:3348609]。

为了捕捉这一点，我们可以想象一个更复杂的过程。对于任何给定的细胞，分子计数仍然遵循泊松过程，但该过程的*速率* ($\lambda$) 不是一个固定的数字。相反，速率本身是一个[随机变量](@entry_id:195330)，从一个描述[细胞间变异性](@entry_id:261841)的[分布](@entry_id:182848)中抽取。一个非常方便的速率[分布](@entry_id:182848)选择是**伽马[分布](@entry_id:182848)**。这引出了一个优美的概念：**伽马-泊松混合**。

当我们将这两种随机性来源——跨细胞的伽马[分布](@entry_id:182848)速率和每个细胞内的泊松抽样——混合在一起时，得到的计数[分布](@entry_id:182848)就不再是[泊松分布](@entry_id:147769)了。它变成了**负二项 (NB) [分布](@entry_id:182848)** [@problem_id:3301621][@problem_id:2400336]。NB [分布](@entry_id:182848)有两个关键参数：一个均值 $\mu$，即我们期望的平均计数；以及一个**离散参数**（通常表示为 $\theta$ 或 $\phi$）。这个离散参数是神奇的成分；它明确地模拟了*超出*均值的那部分[方差](@entry_id:200758)。在一种常见的[参数化](@entry_id:272587)表示中，[方差](@entry_id:200758)由 $\mathrm{Var}(Y) = \mu + \phi \mu^2$ 给出 [@problem_id:3321433]。第二项 $\phi \mu^2$ 就是[过度离散](@entry_id:263748)。离散参数 $\phi$ 越大，变异性就越大。

这种额外的变异性不仅仅是一个统计学上的现象；它反映了深层的生物学原理。基因表达通常不是一个稳定的嗡嗡声，而是以随机爆发的形式发生——这个过程被称为**[转录爆发](@entry_id:156205)** [@problem_id:3348609]。一个基因可以在一段时间内处于“开启”状态，产生一波 mRNA 分子，然后又切换到“关闭”状态。这些爆发在细胞群体中的随机时间和大小自然会造成[过度离散](@entry_id:263748)，而 NB 模型恰好非常适合描述这种情况 [@problem_id:2424240]。

### 遍地零值：结构性零 vs. 抽样零

负[二项模型](@entry_id:275034)凭借其处理[过度离散](@entry_id:263748)的灵活性，在解决我们的谜题方面大有帮助。事实上，一个高度离散的 NB [分布](@entry_id:182848)可以自然地产生大量的零计数。如果一个基因的平均表达水平较低且其表达非常具有爆发性，那么在任何给定时刻，很有可能许多细胞都处于“关闭”状态，真实计数为零。这是一个**抽样零**——即作为 NB [计数过程](@entry_id:260664)自然一部分的零值 [@problem_id:3349866]。

然而，有时即使是强大的 NB 模型也不够。我们可能仍然观察到零的比例过高，无法单靠[过度离散](@entry_id:263748)来解释。这表明存在另一种完全不同的机制在产生零值。这些被称为**结构性零**。它们不属于基因表达正常波动的一部分；它们代表了一种更根本的“关闭”状态。

在 scRNA-seq 的背景下，结构性零可能来自两个主要来源 [@problem_id:3301621][@problem_id:2424240]：

1.  **生物学沉默**：在某些细胞中，作为其发育程序的一部分，基因可能被永久沉默。表达该基因所需的细胞机制被打包收起，无法接触。在这种情况下，计数是真正意义上的生物学零。

2.  **技术性失败**：mRNA 分子可能存在于细胞中，但我们的测量设备未能检测到它。也许它没有被捕获，或者在实验的众多步骤中丢失了。这通常被称为**脱扣**（dropout）事件。计数并非生物学上的零，但由于技术限制而被记录为零。

区分这些类型的零对于做出正确的生物学推断至关重要。

### 打开大门：[零膨胀模型](@entry_id:756817)

为了同时解释抽样零和结构性零，我们需要一个明确承认这两种可能性的模型。这就把我们带到了我们主题的核心：**零膨胀负二项 (ZINB) 模型**。

想象这个过程是一个由守门人控制的两阶段游戏 [@problem_id:3301621]。对于每个细胞和每个基因，守门人首先抛一枚有偏的硬币。假设正面的概率是 $\pi$。

-   如果硬币正面朝上（概率为 $\pi$），守门人就宣布计数为零，游戏结束。这代表一个**结构性零**。
-   如果硬币反面朝上（概率为 $1-\pi$），守门人打开大门，计数由我们熟悉的**负二项分布**决定。这个计数可能是正数，也可能恰好是一个**抽样零**。

这个两部分结构定义了 ZINB 模型。它是一个在零点的点质量和一个完整的 NB [分布](@entry_id:182848)的混合体。因此，观察到零的概率是两种可能性的总和：出现结构性零的概率，或出现非结构性事件但从 NB 分量中得到抽样零的概率。在数学上，这写作 $P(Y=0) = \pi + (1-\pi)P_{\mathrm{NB}}(0)$ [@problem_id:3301267][@problem_id:3321433]。

这个优雅的结构为我们提供了一个具有三个可解释参数的模型 [@problem_id:2424240]：
-   $\boldsymbol{\pi}$ (pi)：**零膨胀概率**。这是获得结构性零的概率，反映了技术性脱扣或真实生物学沉默的速率。
-   $\boldsymbol{\mu}$ (mu)：**NB 分量的均值**。这代表了基因的平均表达水平，但*仅限于那些通过了守门人检测的细胞*——也就是说，在那些基因活跃且被成功测量的细胞中。
-   $\boldsymbol{\theta}$ 或 $\boldsymbol{\phi}$：**NB 分量的离散度**。这量化了细胞间的变异性（即“爆发性”），同样，*仅限于活跃且被测量的细胞*。

### 膨胀还是不膨胀？

手握如此强大的模型，人们很容易想把它应用到任何地方。但科学和统计学的一个核心原则是简约性：我们不应该使用比必要更复杂的模型。“膨胀”部分总是必需的吗？

答案是响亮的“不”。通过现代、高质量的基于 UMI 的测序，技术性脱扣率可以很低。在许多情况下，为一个基因观察到的高比例零值可以完全由一个简单的负[二项模型](@entry_id:275034)来解释，前提是其离散参数被正确估计。一个低表达、高爆发性的基因自然会产生许多零，而不需要一个额外的“膨胀”参数 [@problem_id:3314531][@problem_id:3349866]。事实上，如果我们分析一个恰好不含零且存在[欠离散](@entry_id:183174)（[方差](@entry_id:200758)小于均值）的数据集，强行套用 ZINB 模型将是毫无意义的；一个更简单的模型，如泊松模型，甚至可能是最佳选择 [@problem_id:2851188]。

这突显了一个深刻的真理：数据必须指导我们选择模型。我们不能凭空决定。通过比较不同模型对数据的拟合程度，我们可以决定 ZINB 模型增加的复杂性是否合理。这通常通过[信息准则](@entry_id:636495)来完成，例如**[赤池信息准则 (AIC)](@entry_id:193149)**，它奖励[拟合优度](@entry_id:637026)，但惩罚参数数量 [@problem_id:2851188]。

对于零值的建模也存在其他哲学。例如，**关卡模型 (Hurdle model)** 更清晰地[解耦](@entry_id:637294)了零值的生成过程。它提出两个独立的问题：首先，基因是否表达（是否越过了零的“关卡”）？这被建模为一个简单的[二元结果](@entry_id:173636)。其次，*如果它表达*，表达量是多少？这使用一个只能取正值的截断 NB [分布](@entry_id:182848)来建模。虽然在数学公式和解释上略有不同，但它代表了解决同一难题的另一种有效而优美的方法 [@problem_id:3301267]。

最后，你可能会想，我们怎么可能区分结构性零和抽样零呢？它们在数据中看起来一模一样！这就是统计推断的魔力所在。虽然我们无法标记任何一个单独的零，但我们可以估计每种零的比例。关键在于 NB 分量的参数（$\mu$ 和 $\theta$）不仅由零值决定，还由*正*计数的整个[分布](@entry_id:182848)决定。通过观察非零数据的形状，我们可以估计底层 NB 过程的参数。一旦我们有了这些参数，我们就可以计算这个过程应该产生多少“抽样零”。任何*超出*该数量的观测零值都可以归因于零膨胀分量 $\pi$。这使我们能够在一项非凡的统计侦探工作中解开不同的参数，而这一切都是通过观察数据的全部丰富性才得以实现的 [@problem_id:3321433]。

