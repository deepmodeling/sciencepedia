## 引言
[偏微分方程](@entry_id:141332)（PDEs）是描述自然世界的数学语言，从热流到[波的传播](@entry_id:144063)，无所不包。对这些方程进行数值求解，尤其是涉及二阶或更高阶导数的方程，是一项重大挑战。局部不连续伽辽金（[LDG](@entry_id:751395)）方法是应对这一挑战的一种特别优雅而强大的方法。它通过巧妙地重构问题本身，解决了在不连续的构建块上表示导数的困难。

本文全面概述了[LDG方法](@entry_id:751397)。您将学习到这项技术如何将一个困难的方程转化为一个更简单的一阶[方程组](@entry_id:193238)，以及它如何利用“[数值通量](@entry_id:752791)”的概念来确保稳定性和物理一致性。以下章节将引导您了解其核心概念和广泛用途。第一章**“原理与机制”**将解析其基本思想，从定义辅助变量到设计稳定[数值通量](@entry_id:752791)的技巧。随后的**“应用与跨学科联系”**一章将展示该方法在物理和工程领域的通用性，揭示其处理复杂现象的能力，并揭示其与其他数值技术的深层联系。

## 原理与机制

物理学和工程学中的每一个伟大理论似乎都通过[微分方程](@entry_id:264184)的语言来表达。从热量的优雅[扩散](@entry_id:141445)到[电磁场](@entry_id:265881)的复杂舞蹈，这些方程描述了变化的基本规律。通常，自然界最深刻的表述都涉及[二阶导数](@entry_id:144508)——变化率的变化率——就像经典的扩散方程一样，它描述了“物质”如何[扩散](@entry_id:141445)：

$$
-\nabla \cdot (\kappa \nabla u) = f
$$

这里，$u$可以是温度、化学浓度或其他感兴趣的量；$\kappa$是[扩散](@entry_id:141445)系数，告诉我们它[扩散](@entry_id:141445)的难易程度；$f$是源或汇。项$\nabla u$是$u$的梯度，即其陡峭程度。算子$\nabla \cdot$是散度，它衡量梯度在某一点上“发散”的程度。因此，这个方程将物理场的*曲率*与存在的源联系起来。

数值求解这样一个方程提出了一个引人入胜的挑战。我们希望用一系列简单的、局部的构建块来近似[连续函数](@entry_id:137361)$u$，例如在我们的域的小块（或“单元”）上定义的多项式。问题在于，如果我们允许我们的构建块是不连续的——即从一个单元跳到下一个单元——那么求两次导数就成了一件棘手的事情。一个跳跃的一阶导数是一个尖峰（一个狄拉克δ函数），而一个尖峰的导数则更加难以处理。

### 一个诀窍：将一个难题转化为两个简单问题

我们如何驯服这个[二阶导数](@entry_id:144508)？局部不连续伽辽金（[LDG](@entry_id:751395)）方法的起点是一个既简单又强大的天才之举：如果一个二阶方程太难，就把它变成一个一阶[方程组](@entry_id:193238)。这是数学中一个历史悠久的技巧。

我们不再一次性处理$-\nabla \cdot (\kappa \nabla u)$，而是将其分解。我们给第一部分，即$u$的梯度，起一个自己的名字。我们称之为$\boldsymbol{q}$。于是，我们定义一个**辅助变量**$\boldsymbol{q} = \nabla u$。突然之间，我们那个单一、困难的二阶方程就转化成了一对优雅的一阶耦合方程[@problem_id:3396323]：

$$
\boldsymbol{q} - \nabla u = 0
$$
$$
-\nabla \cdot (\kappa \boldsymbol{q}) = f
$$

这就是[LDG](@entry_id:751395)的基本思想。我们用两个未知量$u$和$\boldsymbol{q}$换来了一个未知量$u$，但新系统要友好得多。现在，我们只需要处理一阶导数。这使我们能够用简单、不连续的分片多项式函数来近似*我们的主变量$u$和新的通量变量$\boldsymbol{q}$。例如，我们可以为$u$在每个单元上选择$p$次多项式空间，为$\boldsymbol{q}$选择一个向量值空间，其中每个分量也是$p$次多项式。这种平衡的选择是“自然的”，因为它为表示我们主变量的梯度提供了足够丰富的空间，同时保持了一个简单、对称的结构[@problem_id:3396330]。

### 搭建桥梁：数值通量的艺术

通过允许我们的多项式近似是不连续的，我们实际上将我们的域分解成了一系列孤立的岛屿（即单元）。在每个岛上，我们的多项式解愉快地存在着，但它不知道邻近岛屿上发生了什么。我们如何让它们进行交流？我们如何强制执行潜在的物理定律，例如，从一个区域流出的热量必须流入下一个区域？

这就是不[连续伽辽金方法](@entry_id:747805)的第二个关键概念发挥作用的地方：**[数值通量](@entry_id:752791)**。

想象我们正处于一个单元$K$上。为了推导离散方程，我们使用标准的伽辽金程序：我们将方程乘以一个“测试函数”并在单元上积分。然后是关键步骤：我们使用分部积分（[格林公式](@entry_id:173118)）。这是该方法的主力。它允许我们将导数算子从我们的未知函数$u_h$和$\boldsymbol{q}_h$转移到光滑的测试函数上。经过这个操作后，单元内部曾经麻烦的导数消失了，但它们留下了一个印记：一个在单元边界$\partial K$上的积分。

这些边界积分涉及我们函数在岛屿边缘的值。但是是哪个值呢？如果单元$K_L$在某个面的左侧，而$K_R$在右侧，我们的[不连续函数](@entry_id:143848)$u_h$在那里有两个相互竞争的值：$u_L$和$u_R$。这是该方法必须解决的核心模糊性。

[LDG方法](@entry_id:751397)的答案是用一个仅在面上定义的新的单值函数来替换边界上的多值迹：[数值通量](@entry_id:752791)，表示为$\widehat{u}$和$\widehat{\kappa \boldsymbol{q} \cdot \boldsymbol{n}}$。这些通量是我们岛屿之间的桥梁。它们是精心设计的配方，告诉我们如何结合一个面两侧的信息，以创建一个单一、一致的值，从而将单元耦合在一起[@problem_id:3401201]。

### 稳定性的秘密：巧妙的交替设计

设计这些桥梁是一门精细的艺术。一个设计拙劣的通量可能导致[数值格式](@entry_id:752822)不稳定——它可能会爆炸或产生完全无意义的结果。一个好的通量必须首先是**相容的**：如果你将原始[偏微分方程](@entry_id:141332)的精确、光滑解代入该格式，[数值通量](@entry_id:752791)应该简单地返回该精确解的值。这确保我们正在解决正确的问题。

但真正的天才之处在于为**稳定性**而设计。通量的构造方式必须使最终的数值格式尊重原始方程的物理特性，例如扩散过程中的[能量耗散](@entry_id:147406)。

[LDG](@entry_id:751395)最优雅的设计之一是**交替通量**[@problem_id:3405525]。这个想法非常简单。在一个面上，为了计算通量$\widehat{u}$，我们只取$u_h$一侧的值，比如“左”侧的$u_L$。然后，对于另一个通量$\widehat{\kappa \boldsymbol{q} \cdot \boldsymbol{n}}$，我们取$\kappa \boldsymbol{q}_h \cdot \boldsymbol{n}$*另一*侧，即“右”侧的值。

为什么要这样奇怪的交替选择？当我们在分析方法的能量平衡时，它会导致一个漂亮的抵消。当对所有单元面求和时，这种特定的配对神奇地产生了与解的跳跃平方成正比的项，$[u_h]^2 = (u_L - u_R)^2$。在$\boldsymbol{q}$的通量中，我们通常会增加一个小的“惩罚”项，形式为$\tau [u_h]$。这个项增强了效果。完整的能量恒等式表明，单元内部耗散的能量被面上这些平方跳跃的总和所平衡。

$$
\text{能量耗散} \sim \sum_{\text{面上}} \tau [u_h]^2
$$

这就是L[DG稳定性](@entry_id:748375)的秘密[@problem_id:3420955]。该方法之所以稳定，是因为它内在地惩罚大的不连续性。惩罚项就像连接单元的无形弹簧，允许它们保持分离但防止它们漂移得太远。这些弹簧的刚度由**稳定化参数**$\tau$控制。如果我们设置$\tau=0$，弹簧就会消失，结构可能会变得摇晃和不稳定。

### 顿悟时刻：从伽辽金到有限差分

让我们把这个抽象的机制带回现实。考虑最简单的情况：在一维均匀网格上，热方程为$u_t = \nu u_{xx}$，我们用最简单的多项式——分片常数（$p=0$次）来近似$u$和$q=u_x$[@problem_id:3376782]。我们遵循[LDG](@entry_id:751395)的步骤：在一个单元上写出[弱形式](@entry_id:142897)，进行[分部积分](@entry_id:136350)，并代入交替数值通量$\hat{u} = u^{-}$和$\hat{q} = q^{+}$。

经过几行直接的代数运算以消去辅助变量$q_j$后，我们得到了单元$j$中值$u_j$的半离散方程：

$$
\frac{d u_j}{dt} = \frac{\nu}{h^2} (u_{j+1} - 2u_j + u_{j-1})
$$

这是一个美妙的顿悟时刻！右边是经典的用于[二阶导数](@entry_id:144508)的三点[有限差分格式](@entry_id:749361)。我们这个复杂的、不连续的、基于伽辽金的框架，在它最简单的设置下，精确地恢复了[求解热方程](@entry_id:755055)最古老、最直观的方法之一。这表明这些看似不同的数值哲学是深度关联的，是同一个底层数学结构的不同侧面。

我们甚至可以更深入地探究，这个[数值格式](@entry_id:752822)在多大程度上模仿了真实的物理过程。对于连续热方程，波数为$k$的[正弦波](@entry_id:274998)以$\nu k^2$的速率衰减。通过对我们的L[DG格式](@entry_id:178043)进行[傅里叶分析](@entry_id:137640)，我们发现数值衰减率为$\frac{4\nu}{h^2} \sin^2(kh/2)$。因此，数值衰减率与精确衰减率之比为[@problem_id:3420963]：

$$
R(kh) = \frac{4 \sin^2(kh/2)}{(kh)^2} = \left( \frac{\sin(kh/2)}{kh/2} \right)^2
$$

这个非凡的公式告诉我们关于该格式精度的所有信息。对于长波（小的$kh$），这个比率非常接近1，意味着模拟非常精确。对于几乎不能被网格解析的短波（大的$kh$），该比率偏离1，精确地告诉我们[数值格式](@entry_id:752822)在最小尺度上如何扭曲物理过程。

### 宏伟架构：守恒性、灵活性与隐藏的联系

[LDG方法](@entry_id:751397)还具有其他一些使其如此强大的优美特性。

首先，它在构造上是**局部守恒的**。如果我们在单个单元$K$上选择测试函数为'1'，那么方程$-\nabla \cdot (\kappa \boldsymbol{q}) = f$的[弱形式](@entry_id:142897)就简化为一个简单的陈述：从单元边界流出的总通量$\int_{\partial K} \widehat{\kappa \boldsymbol{q} \cdot \boldsymbol{n}} \, dS$，精确地平衡了单元内部的总源$\int_K f \, dV$。这个性质直接从物理学中继承而来，对于那些必须守恒质量或能量等量的问题至关重要[@problem_id:3377363]。

其次，引入$\boldsymbol{q}$似乎使我们的未知量数量翻了一番，从而使计算工作量也翻了一番。然而，还有另一个聪明的技巧。方程的结构使得一个单元上的辅助变量$\boldsymbol{q}_h$可以纯粹用该单元及其紧邻单元上的$u_h$来表示。这允许我们对每个单元上的$\boldsymbol{q}_h$进行“预求解”，并将其代回到全局系统中。这个过程称为**[静态凝聚](@entry_id:176722)**，最终得到一个只涉及原始变量$u_h$的全局系统[@problem_id:3365028]。得到的矩阵具有与其他从未引入辅助变量的DG方法（如[对称内部罚](@entry_id:755719)伽辽金（SIPG）方法）完全相同的[稀疏结构](@entry_id:755138)。事实上，通过精心选择数值通量，可以证明[LDG方法](@entry_id:751397)在代数上等价于SIPG，揭示了不[连续伽辽金方法](@entry_id:747805)家族内部深刻的统一性[@problem_id:3377363]。

### 一点警示：极值原理的幽灵

尽管标准[LDG方法](@entry_id:751397)非常优雅，但它也有自己的一些微妙之处。[扩散方程](@entry_id:170713)最基本的性质之一是**极值原理**：在没有源的情况下，房间里的最高温度不会自发地出现在中心；它必须是初始就存在，或者在边界上找到。

标准的[LDG](@entry_id:751395)，特别是在使用高阶多项式（$p \ge 1$）时，并不能自动保证该原理的离散版本。在尖锐层或其他困难特征附近，解可能会出现小的、非物理的过冲或下冲[@problem_id:3396385]。发生这种情况是因为线性通量机制虽然能确保整体能量稳定，但其强度不足以强制执行更严格的[单调性](@entry_id:143760)条件。[系统矩阵](@entry_id:172230)的非对角线项不能保证具有正确的符号。

为高阶L[DG格式](@entry_id:178043)恢复[极值原理](@entry_id:138611)是数值分析前沿的一个引人入胜的挑战。这通常需要引入[非线性](@entry_id:637147)的、依赖于解的通量修正，这些修正作为“限制器”仅在需要抑制[振荡](@entry_id:267781)时才起作用。这是一个完美的提醒：在科学中，即使是我们最美丽的工具也有其局限性，而理解这些局限性是构建更好工具的第一步。

