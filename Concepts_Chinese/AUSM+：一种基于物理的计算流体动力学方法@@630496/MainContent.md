## 引言
在模拟复杂流体运动的探索中，[计算流体动力学](@entry_id:147500)（CFD）依赖数值方法将物理学的控制定律转化为预测。其挑战在于创造出的方法不仅要准确，还要足够稳健，以处理流体可能展现的各种现象——从微风拂面到剧烈的激波。在最成功的方法中，[平流](@entry_id:270026)上游分裂格式（Advection Upstream Splitting Method, AUSM）族格式因其坚实的物理直觉基础而备受赞誉。AUSM并非将控制方程视为一个纯粹的数学问题，而是优雅地将其解构为基本的物理分量。

本文深入探讨AUSM+格式的原理和威力。我们将探究它所解决的知识空白：需要一种通用的求解器，既能高保真地捕捉激波和接触面等尖锐特征，又能在极大的速度范围内保持稳定和准确。通过理解其设计，您将看到物理洞察力如何带来卓越的数值性能。

首先，在“原理与机制”一章中，我们将剖析[通量分裂](@entry_id:637102)的核心思想，揭示流体中的信息流如何被分离为[对流](@entry_id:141806)分量和压力驱动分量。随后，“应用与跨学科联系”一章将展示该方法非凡的多功能性，演示同样的基本逻辑如何让我们能够模拟从飞机机翼、火箭发动机到遥远[黑洞](@entry_id:158571)的天体物理射流等一切事物。

## 原理与机制

要真正领会像平流上游分裂格式（AUSM）这样一种方法的精妙之处，我们不能只看最终的方程。我们必须追溯其发现之旅，从它试图描述的物理现象本身开始。想象我们正在观察一条河流。我们同时看到两件事在发生：水本身在向下游流动，携带着树叶和嫩枝；同时，涟漪在水面上传播，携带着关于扰动的信息。AUSM的核心思想是认识到[流体运动](@entry_id:182721)定律包含这两种截然不同的现象，并构建一个能分别处理这两种现象的数值方法。

### 分裂的艺术：[对流](@entry_id:141806)与压力

无粘、[可压缩流体](@entry_id:164617)（即摩擦可忽略不计的气体或液体）的运动由一套优美的原理——**[欧拉方程](@entry_id:177914)**所支配。在其[守恒形式](@entry_id:747710)下，欧拉方程指出，一个体积内某个量的变化率等于该量穿过该体积边界的净流量，即**通量**。对于[一维流](@entry_id:269448)动，这可以写为 $\partial_{t}\mathbf{U}+\partial_{x}\mathbf{F}(\mathbf{U})=0$。

在这里，$\mathbf{U}$ 是流体的状态，一个包含密度（$\rho$）、动量（$\rho u$）和总能（$\rho E$）的向量。向量 $\mathbf{F}$ 是通量，描述了这些量的输运。它看起来是这样的 [@problem_id:3292934]：

$$
\mathbf{F}(\mathbf{U})=\begin{pmatrix}\rho u\\ \rho u^{2}+p\\ u(\rho E+p)\end{pmatrix}
$$

乍一看，这似乎是一堆杂乱的项。但借助一些物理直觉，我们可以将其理清。AUSM方法的精妙之处在于，它看到这个通量实际上是两个不同物理过程的总和。

首先，是流体运动并携带其自身属性的简单行为。这就是**[对流](@entry_id:141806)**。如果流体以速度 $u$ 运动，它就携带着自身的质量、动量和能量。我们可以将这个[对流通量](@entry_id:158187)写成速度 $u$ 乘以一个包含密度、动量和[总焓](@entry_id:197863) $H=E+p/\rho$ 的向量。[总焓](@entry_id:197863)是随流体[自然对流](@entry_id:197869)的量：

$$
\mathbf{F}_{c} = u \begin{pmatrix}\rho \\ \rho u \\ \rho H \end{pmatrix} = \begin{pmatrix}\rho u\\ \rho u^{2}\\ u(\rho E+p)\end{pmatrix}
$$

其次，是**压力** $p$ 的效应。压力是一种[内力](@entry_id:167605)；它是流体微团相互推挤的方式。这个压力通量只包含压力力，仅影响动量方程：

$$
\mathbf{F}_{p} = \begin{pmatrix}0\\ p\\ 0\end{pmatrix}
$$

如果将这两部分相加，$\mathbf{F}_{c} + \mathbf{F}_{p}$，就能完美地恢复原始的欧拉通量 $\mathbf{F}$。这种分解是AUSM在概念上的核心 [@problem_id:3292934]。这不仅仅是一个数学技巧，而是基于物理现象的分离。$\mathbf{F}_{c}$ 描述了流体的整体输运，而 $\mathbf{F}_{p}$ 则代表了压力力。

### 倾听流体：[平流](@entry_id:270026)波与声波

为什么这种物理分裂如此强大？因为它完美地反映了信息在流体中传播的两种方式。欧拉方程是双曲型的，这意味着信息以有限的速度作为波进行传播。当我们分析其数学性质时，会发现恰好存在两种类型的波 [@problem_id:3292939]。

1.  **平流模式**：这种波以当地[流体速度](@entry_id:267320) $u$ 传播。它携带温度和密度（在恒定压力下）等属性的变化，但不携带压力信号。可以把它想象成风中的一缕烟；它只是随气流漂移。该模式直接对应于我们的[对流通量](@entry_id:158187) $\mathbf{F}_{c}$。

2.  **[声学模](@entry_id:263916)式**：这些是声波。它们相对于流体以声速 $a$ 传播。从静止的观察点看，它们的移动速度为 $u+a$（下游）和 $u-a$（上游）。这些波是压力变化在流体中传播的机制。在某一点的突然推动会产生一个向外传播的压力波。该模式直接对应于我们的压力通量 $\mathbf{F}_{p}$。

通过将[通量分裂](@entry_id:637102)为[对流](@entry_id:141806)和压力部分，我们已将数值问题分解为两个更简单、物理上截然不同的部分。现在我们可以设计策略来独立处理流体属性的“漂移”和压力波的“传播”。

### 马赫数如同指挥棒

在数值模拟中，世界被分解成离散的单元。为了计算流体如何变化，我们需要确定两个可能具有不同状态（左侧L和右侧R）的单元之间的界面通量。决定使用哪一侧的信息的过程称为**迎风**。

[AUSM格式](@entry_id:746578)使用**马赫数** $M = u/a$ 作为主控制器——一根指挥棒——来协调这个过程。界面通量通过构建界面质量通量 $\dot{m}$ 和界面压力 $p^{\ast}$ 来建立。

对于[对流](@entry_id:141806)部分，逻辑很简单。质量通量应由“[迎风](@entry_id:756372)”状态决定。AUSM族格式使用[马赫数](@entry_id:274014)[分裂函数](@entry_id:161308) $M^{+}(M)$ 和 $M^{-}(M)$ 来构建它。对于从左到右的流动，我们期望界面马赫数 $M^{\ast}$ 由左侧状态决定，反之亦然。组合后的界面[马赫数](@entry_id:274014)为 $M^{\ast} = M^{+}(M_L) + M^{-}(M_R)$ [@problem_id:3292941]。

对于压力部分，逻辑遵循声波。
*   在**超声速**流 ($|M| \ge 1$) 中，所有的波都被扫向一个方向。信息只能来自上游。因此，界面压力应完全取自上游状态。例如，如果 $M_L > 1$，则 $p^{\ast} = p_L$。
*   在**亚声速**流 ($|M| \lt 1$) 中，声波可以向两个方向传播。因此，界面压力是左侧和右侧压力的混合。确切的混合由压力[分裂函数](@entry_id:161308) $\mathcal{P}^{+}(M)$ 和 $\mathcal{P}^{-}(M)$ 控制，使得 $p^{\ast} = \mathcal{P}^{+}(M_L)p_L + \mathcal{P}^{-}(M_R)p_R$ [@problem_id:3292941]。

这种分离处理正是该方法如此稳健的原因。物理学中仅涉及漂移的部分通过简单的质量迎风处理，而涉及复杂波相互作用的部分则通过一种复杂的、感知马赫数的压力混合来处理。

### 完善多项式：AUSM+中的“加号”

最初的AUSM是一个绝妙的想法，但用于亚声速混合的特定数学函数被发现存在微小缺陷。在非常具有挑战性的情况下，如近停滞流或非常强的激波处，它们可能会导致微小的不准确性或[振荡](@entry_id:267781)。

**AUSM+** 的发展是一个精炼的过程，其指导思想是追求数学上的优雅和物理上的完美。设计者们问道：这些[混合函数](@entry_id:746864)必须具备的理想属性是什么？他们推断，从亚声速到超声速的过渡应该是完全平滑的。这意味着不仅函数的值，而且其斜率在音速点（$M = \pm 1$）也必须匹配。这被称为确保 $C^1$ 连续性。

当这些简单而优雅的平滑性约束被施加于所需最小阶数的多项式上时，一个唯一的解便应运而生。例如，对于马赫数分裂，亚声速区域（$|M| \le 1$）中 $M^+$ 分量的多项式为 $\frac{1}{4}(M+1)^2$ [@problem_id:3292954]。这个公式并非任意的；它是要求一个行为良好的格式所带来的数学结果。

此外，AUSM+引入了一个关键的新特性：**目标压力耗散** [@problem_id:3320921]。激波是一个剧烈的、极薄的区域，流体属性在此发生跳跃。在数值上，这可能引起[振荡](@entry_id:267781)。AUSM+增加了一个微小的、“智能的”耗散项，该项与跨越单元界面的压力跳跃成正比。这个项就像一个微型减震器，仅在激波处激活，以保持其稳定和清晰。关键是，这种耗散在其他任何地方都会消失，因此它不会模糊或“涂抹”流动的其他精细特征。这种智能设计优雅地解决了诸如“奇偶[解耦](@entry_id:637294)”等棘手的数值问题，这是一种可能困扰激[波模拟](@entry_id:176523)的棋盘状不稳定性 [@problem_id:3292953]。

### 物理直觉的硕果

这种对物理原理的细致关注带来了显著的实际好处，使AUSM族格式在众多方法中脱颖而出。

其最受称赞的成功之一是能够以极高的清晰度捕捉**接触间断** [@problem_id:3292960]。接触间断是一个界面，在该界面上压力和速度是恒定的，但密度和温度发生跳跃（想象一层氦气坐在一层空气上）。因为AUSM的压力通量是由压力差驱动的，所以在接触面上它看不到任何作用对象，不会引入人为的[扩散](@entry_id:141445)。与此同时，[对流通量](@entry_id:158187)只是以正确的速度输运密度跳跃。结果是一个完美的、不被涂抹的清晰接触面，这是许多其他格式难以实现的。

另一个深远的优势是其“全速”能力。许多可压缩流求解器在[低马赫数](@entry_id:751528)（$M \to 0$）时会变得非常不准确 [@problem_id:3316244]。它们固有的[数值耗散](@entry_id:168584)通常以声速 $a$ 来衡量，而声速可能比[流体速度](@entry_id:267320) $u$ 大数千倍。这就像试图用一台为卡车设计的秤来称量一根羽毛的重量——测量值淹没在噪声中。AUSM族格式如AUSM+及其后继者（AUSM+-up, SLAU2）巧妙地使其耗散与[马赫数](@entry_id:274014)本身成比例 [@problem_id:3292938]。随着流动减慢，数值耗散自动减小，使得该格式能够对从通风房间中空气的轻微流动到航天器的高超声速再入等各种情况都保持其准确性。

最终，即使是最复杂的格式也必须遵守一个基本的速度限制以保持稳定。要运行一个模拟，所选的时间步长 $\Delta t$ 必须足够小，以使移动最快的波不会在一步之内跳过整个网格单元。这就是Courant–Friedrichs–Lewy（CFL）条件。对于[欧拉方程](@entry_id:177914)，最快的波以 $|u| + a$ 的速度传播。因此，时间步长必须满足 $\Delta t \le \frac{\Delta x}{|u| + a}$ [@problem_id:3292940]。

总之，AUSM族格式是一个由物理洞察力驱动的[算法设计](@entry_id:634229)的优美典范。通过将[流体运动](@entry_id:182721)的复杂舞蹈解构为其基本步骤——[对流](@entry_id:141806)和压力功——并通过马赫数来协调它们的数值处理，它在极其广泛的物理体系中实现了准确性、稳健性和效率的罕见结合。它证明了这样一个理念：最强大的工具往往是那些最仔细倾听其所描述物理现象的工具。

