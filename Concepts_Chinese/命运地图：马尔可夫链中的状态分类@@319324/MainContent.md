## 引言
从粒子的[随机游走](@article_id:303058)到种群中基因频率的波动，科学和自然界中的许多过程都带有随机性。马尔可夫链为模拟这些系统提供了一个强大的框架，在这些系统中，未来仅取决于当前状态。但我们如何预测这样一个过程的长期命运呢？它会漫无目的地游走，返回其起点，还是会陷入一个无法返回的点？回答这些问题的关键在于对链的状态进行分类，从而绘制出一幅名副其实的“命运地图”，描绘出系统的最终归宿。本文为这种分类提供了全面的指南，旨在填补观察随机性与预测其长期结构之间的基本知识鸿沟。在接下来的章节中，我们将首先探讨用于区分不同类型状态的核心原则和机制。然后，我们将遍览各种应用和跨学科联系，揭示这一单一理论框架如何统一我们对众多科学领域现象的理解。

## 原理与机制

想象一下，你是一位在从未到过的城市中漫步的游客。在每个十字路口，你都随机选择一条街道前行。有些路口可能会把你带到一个古雅的死胡同，你必须原路返回。另一些路口可能位于一条通往城外的单行高速公路上，让你一去不复返。还有些街区可能联系得非常紧密，一旦进入，你所有的时间都会在那里度过。如果我们能了解每个路口和街区的性质，我们就能预测你旅程的最终命运。这正是我们在对[马尔可夫链](@article_id:311246)的状态进行分类时所做的事情。我们正在为我们的[随机游走](@article_id:303058)者绘制一张命运地图。

在引言之后，我们准备好卷起袖子，探索支配这种分类的核心原则。我们将逐个状态地剖析链的结构，以揭示其秘密。

### 重大分野：暂态与[常返态](@article_id:340659)

对于任何状态，我们能问的最基本问题是：“如果我离开，我*保证*会回来吗？”这个问题的答案将所有状态分为两大族。

如果一个状态在离开后，你绝对确定会返回，那么它被称为**[常返态](@article_id:340659)**。返回的概率恰好为1。可以把它想象成你的大本营。无论你游荡多远，宇宙中的路径都会[合力](@article_id:343232)最终将你带回。

如果一个状态存在非零的概率让你离开后永不返回，那么它被称为**暂态**。它是一个中途站，是漫长旅途中的一个停靠点。你可能会访问它，甚至可能访问几次，但你有可能在某一天最后一次离开它。

一个状态如何会是暂态呢？最清楚的方式之一是它有一扇“单向门”。假设你处于状态 $i$，并且有一条以正概率通往另一个状态 $j$ 的路径。然而，一旦你进入状态 $j$，就根本没有路径能回到 $i$。如果你从 $i$ 迈出那决定性的一步到 $j$，你就永远离开了 $i$。因此，状态 $i$ 必定是暂态，因为存在这种永久离开的非零概率 [@problem_id:1288860]。

一个绝佳的具体例子是一个让你逐级闯关的街机游戏 [@problem_id:1288866]。想象一下第1、2、3关。你可以在它们之间移动——也许从第1关前进到第2关，但也可能从第2关被击退回第1关。它们看起来是相互关联的。然而，从第3关有一条通往第4关“游戏结束”画面的路径。一旦你到达第4关，你将永远停留在那里；它是一个**吸收**态。因为总存在一系列幸运的操作（$1 \to 2 \to 3 \to 4$）将你带到这个无法返回的点，所以每个初始关卡都是暂态的。你最终注定会输掉游戏。你在早期关卡的时间是短暂的，是不可避免的结局来临前的一个临时阶段。

### 数学家的试金石

直觉是很好的向导，但科学要求严谨。我们如何从数学上检验一个状态是“大本营”还是“中途站”？关键的洞见是停止思考单次返回，而开始计算在无限时间内*访问的总次数*。

如果一个状态是常返的——一个真正的大本营——你会一次又一次地回来，永无止境。所以，如果你要计算访问次数，这个计数将会增长到无穷大。

如果一个状态是暂态的，你可能会访问几次，但最终你会离开并且永不返回。总访问次数将是某个有限的数字。

这引导我们得出一个强有力的判据。假设 $E_i[N_i]$ 是在从状态 $i$ 出发的情况下，我们将访问状态 $i$ 的[期望](@article_id:311378)次数。

- 如果 $E_i[N_i] = \infty$，则状态 $i$ 是**常返的**。
- 如果 $E_i[N_i]  \infty$，则状态 $i$ 是**暂态的**。

这个[期望值](@article_id:313620)可以通过不同方式计算。在一种情况下，我们可能通过解一个方程组发现它是一个有限数，比如 $\frac{7}{5}$，这立即告诉我们该状态是暂态的 [@problem_id:1288862]。在另一种情况下，我们可能会发现经过 $n$ 步后返回状态 $i$ 的概率之和，即 $\sum_{n=0}^{\infty} p_{ii}^{(n)}$，收敛于一个有限值。这个和恰好是[期望](@article_id:311378)访问次数 $E_i[N_i]$，因此它的收敛性是暂态性的确切证明 [@problem_id:1288930] [@problem_id:1347285]。

### 团结一致：互通类

现在，一个优美的简化出现了。状态不是孤立的岛屿；它们被连接成“邻里”。我们说两个状态 $i$ 和 $j$ **互通**，如果你可以从 $i$ 到达 $j$，也可以从 $j$ 到达 $i$。这种关系，记作 $i \leftrightarrow j$，是一种等价关系，这意味着它将整个[状态空间划分](@article_id:331724)为不相交的集合，称为**互通类**。

关键在于：常返性和暂态性是**类性质**。一个互通类中的所有状态共享相同的命运。它们要么全部是常返的，要么全部是暂态的。一个暂态不可能与一个[常返态](@article_id:340659)互通。为什么？因为如果你能从一个常返的“大本营” $i$ 到一个暂态的“中途站” $j$ 再返回，那么 $j$ 的暂态性（永远离开它的可能性）将会“感染”$i$，使得返回 $i$ 的保证变得不可能。这个逻辑是无懈可击的。

这个原则非常有用。如果你能证明一个类中只有一个状态是暂态的，你就证明了它们全是暂态的 [@problem_id:1347285]。

这也为任何具有**有限**数量状态的链提供了一个深刻的结果。在一个有限系统中，根本没有地方可以永远“逃脱”。至少必须有一个状态是常返的。现在，如果我们有一个**不可约**的有限链（意味着它由一个单一的互通类组成，其中任何状态都可以到达其他任何状态），这意味着*所有*状态都必须是常返的。你不能有混合状态，也不能全是暂态，所以它们必须全是常返的 [@problem_id:1288914]。即使链有奇怪的规则，比如不能连续两步停留在同一个状态（$P_{ii}=0$），这一点也成立。有限性和不可约性才是关键 [@problem_id:1329949]。

### 常返的不同色度：[正常返](@article_id:338838)与[零常返](@article_id:340629)

所以，在一个[常返态](@article_id:340659)中，我们保证会返回。但这个保证背后隐藏着一个微妙而迷人的细节：平均需要*多长时间*才能返回？这个问题的答案揭示了常返的两种不同色度。

如果[期望返回时间](@article_id:332366)是**有限的**，那么一个[常返态](@article_id:340659)是**[正常返](@article_id:338838)**的。你不仅会回来，而且你返回的[平均等待时间](@article_id:339120)是一个具体的数字。对于任何有限、不可约的马尔可夫链，所有状态不仅是常返的，而且是[正常返的](@article_id:374033)。

如果[期望返回时间](@article_id:332366)是**无限的**，那么一个[常返态](@article_id:340659)是**[零常返](@article_id:340629)**的。这是一个令人费解的想法。你以概率1保证会返回。然而，可能的等待时间被拉伸得如此之长，以至于它们的平均值是无限的。这种奇怪的行为只能发生在具有无限数量状态的链中。

区分这两者的关键是**[平稳分布](@article_id:373129)**的概念。[平稳分布](@article_id:373129)，通常用 $\pi$ 表示，是状态上的一个[概率分布](@article_id:306824)，它随时间推移保持不变。如果你用这个行走者分布来启动链，那么一步之后，行走者的总体分布完全相同。它代表了一种完美的平衡。

这是该领域最优雅的定理之一：一个不可约的[马尔可夫链](@article_id:311246)是[正常返的](@article_id:374033)，当且仅当它有一个唯一的平稳分布 [@problem_id:2993144]。

- 如果你能找到一个[平稳分布](@article_id:373129)，那么链就是[正常返的](@article_id:374033)。例如，如果转移矩阵是**双随机**的（行和与列和都为1），那么[均匀分布](@article_id:325445)就是一个平稳分布，这立即证明了有限、[不可约链](@article_id:331664)的[正常返](@article_id:338838)性 [@problem_id:1288883]。
- 如果你能证明不存在平稳分布，那么链不可能是[正常返的](@article_id:374033)。

这让我们想到了一个经典例子：在无限整数格 $\mathbb{Z}^d$ 上的[随机游走](@article_id:303058)。这样的游走不可能是[正常返的](@article_id:374033)。为什么？一个平稳分布必须为无限网格中的每一点分配相同的概率，但是不可能为无限多个点分配正概率，并使总概率和为1 [@problem_id:2993144]。因此，著名的一维[随机游走](@article_id:303058)（醉汉在一条线上行走）是常返的——他保证会回到他出发的路灯柱——但他是**[零常返](@article_id:340629)**的。他蹒跚着走回来的[期望](@article_id:311378)时间是无限的！

### 链的节奏：周期性

最后，我们还有最后一个属性要考虑：链的节奏。当你返回一个状态时，返回的时间是任意的，还是遵循严格的节拍？

如果返回只能在某个整数 $d > 1$（称为**周期**）的倍数步数时发生，那么这个状态是**周期的**。想象一下国际象棋棋盘上的象；它总是停留在相同颜色的格子上。如果它的起始格是“白色”，那么任何返回该格的移动都必须花费偶数步。它的状态周期为2。

如果返回可以以不规则的间隔发生，那么一个状态是**非周期的**。形式上，所有可能返回行程长度的最大公约数（GCD）为1。

和常返性一样，周期性也是一个类性质。一个互通类中的所有状态都有相同的周期。

有一个非常简单的[非周期性](@article_id:339566)测试。如果一个状态有**自环**——也就是说，如果 $p_{ii} > 0$——它就自动是非周期的。原因很简单：在1步内返回是可能的。由于1在可能的返回时间集合中，所有这些时间的[最大公约数](@article_id:303382)必须是1 [@problem_id:1281638]。一个有一定概率重新加载当前页面而不是点击链接的网络机器人，即使链接本身形成一个完美的循环，也会创建一个非周期系统。

通过结合这些原则——暂态与常返、[正常返](@article_id:338838)与[零常返](@article_id:340629)，以及周期性——我们可以为任何[马尔可夫链的长期行为](@article_id:336020)构建一幅完整而详细的画像，将一片随机数的海洋转变为一个具有可预测结构和命运的世界。