## 应用与跨学科联系

在阐明了机器如何学习化学语言的原理之后，我们现在面临一个激动人心的问题：我们能用这种新获得的能力来*做*什么？如果说上一章是关于学习分子世界的语法和词汇，那么这一章就是关于创作诗歌和散文——即应用这些工具来解决实际问题，揭示新的科学，并梦想实现对所有物质的统一计算理解。

人们最初可能认为[机器学习模型](@entry_id:262335)是一个“黑箱”，一个聪明但终究不透明的[数据插值](@entry_id:142568)器。然而，这种观点有极大的局限性。一个精心设计的、基于物理原理的模型，不是黑箱，而是一种新的透镜，通过它我们可以用不同的眼光看待宇宙。它成为我们理论工具箱的一部分。例如，想象一个模型被训练来预测分子中电子态之间的量子力学相互作用。一旦我们有了这个模型，工作并没有结束。我们可以利用它的输出——一个从数据中学到的[有效哈密顿量](@entry_id:748813)——并对其应用成熟的物理学机制。我们可以对它进行[微分](@entry_id:158718)，以计算驱动光化学反应的力，即所谓的[非绝热耦合](@entry_id:198018)矢量，它控制着分子在光影响下的舞蹈[@problem_id:90964]。机器并没有取代物理学家，而是给了物理学家一个强大的新构件来进行创造。

### 表示的艺术：机器需要“看见”什么

在机器能够学习物理学之前，必须先教会它如何*看见*一个物理系统。这就是表示的艺术，也正是在这里，计算机科学与物理直觉得到了最紧密的结合。想一想[计算机视觉](@entry_id:138301)任务。[卷积神经网络](@entry_id:178973)（CNN）使用“滤波器”在图像上滑动，识别边缘、纹理和形状等局部模式。材料中原子的[排列](@entry_id:136432)，无论是无序的玻璃还是完美的晶体，都非常像一种纹理。我们可以做出一个直接而美妙的类比：许多[机器学习势](@entry_id:183033)中使用的“[对称函数](@entry_id:177113)”正是这些滤波器的化学等价物[@problem_id:2456307]。它们描述了每个原子周围的局部环境——它有多少邻居，距离多远，角度如何。

然而，至关重要的是，原子环境并非像素化的图像。一个漂浮在空间中的分子没有固定的朝向或绝对位置。如果我们旋转或平移一个分子，它的能量必须保持不变。这是物理学的一项[基本对称性](@entry_id:161256)。一个简单地将原子的原始[笛卡尔坐标](@entry_id:167698)作为输入的幼稚模型将会彻底失败，因为它会把一个旋转后的分子看作一个全新的物体[@problem_id:2456477]。这就是为什么这些表示的设计如此关键。通过从原子*之间*的关系——距离和角度——来构建我们的描述符，我们将这些基本的[旋转和平移](@entry_id:175994)对称性直接融入到模型的世界观中。机器从一开始就学习到，能量是分子内部结构的函数，而不是其在空间中位置的函数。

但即便如此也还不够。化学的语言是精妙而精确的。思考一下DNA标志性的双螺旋结构。这个梯子的“梯级”是碱基对：腺嘌呤与胸腺嘧啶（A-T）以及鸟嘌呤与胞嘧啶（G-C）。一个A-T对由两个[氢键](@entry_id:142832)维系，而一个G-C对则由三个[氢键](@entry_id:142832)维系。从能量角度看，这是一个至关重要的差异。要让机器“看到”这种区别，它的表示必须足够敏锐。一个只计算特定距离内原子数量的描述符，将无法识别这些[氢键](@entry_id:142832)特定的[方向性](@entry_id:266095)。为了区分它们，模型不仅需要知道附近有*什么*原子（化学物种：氧、氮、氢），还需要知道它们精确的几何[排列](@entry_id:136432)（它们之间的角度）。只有结合了元素和角度的分辨率，模型才能学会化学这门精妙的艺术[@problem_id:2456310]。

### 从原子到物质：预测大大小小的性质

一旦我们有了一种稳健的方法来描述原[子环](@entry_id:154194)境，我们就可以开始预测性质了。其应用横跨化学和生物学的整个领域。在局部层面，我们可以解决具有巨大实际重要性的问题，例如预测药物分子在体内将如何代谢。利用图神经网络，模型可以学会“读取”分[子图](@entry_id:273342)，在相邻原子之间传递信息。一个原子的最终“得分”——它成为代谢位点的可能性——是其自身身份及其局部化学邻域的函数，这个计算过程完美地反映了化学直觉[@problem_id:2395393]。

然而，这些模型的真正力量在于它们能够弥合原子微观世界与我们所体验的材料宏观世界之间的鸿沟。例如，气体的性质——其压力和温度——是其组成粒子之间无数次相互作用的涌现结果。第二维里系数是描述[真实气体](@entry_id:136821)与理想气体行为首次偏离的项，它是两个粒子间相互作用势的积分。通过训练一个简单的[神经网](@entry_id:276355)络来模仿[Lennard-Jones势](@entry_id:143105)——一个描述惰性气体原子相互作用的经典模型——我们可以用该模型计算这个系数，并预测一个宏观[热力学](@entry_id:141121)里程碑：[玻意耳温度](@entry_id:141835)，在该温度下排斥力和吸[引力](@entry_id:175476)有效抵消。这提供了一个直接的、定量的联系：我们的[机器学习势](@entry_id:183033)越精确地捕捉到真实的微观物理，它就越能准确地预测物质的宏观性质[@problem_id:2456330]。

### 超越插值：[量子化学](@entry_id:140193)的新前沿

我们现在正进入一个新领域，在这里，机器学习不仅仅是加速旧的计算，而是在催生全新的科学。模拟由光驱动的[化学反应](@entry_id:146973)——[光化学](@entry_id:140933)——是计算化学的重大挑战之一。它需要在[电子激发](@entry_id:190531)态的复杂能量景观中进行导航。[机器学习势](@entry_id:183033)现在能够从[量子计算](@entry_id:142712)中学习这些多态景观，并且正如我们前面所见，它们可以用来计算控制态间跃迁的耦合[@problem_id:90964]。这为光合作用或有机LED运作等过程的常规、大规模模拟打开了大门，而这些现象以前正处于计算可行性的边缘。

也许最深远的应用在于对我们如何求解薛定谔方程本身进行彻底反思。几十年来，主流方法一直是将电子[波函数](@entry_id:147440)表示为预定义原子[基函数](@entry_id:170178)的组合。但如果[基函数](@entry_id:170178)本身可以被学习呢？一种革命性的新方法使用[神经网](@entry_id:276355)络不是为了学习能量，而是为了*成为*[波函数](@entry_id:147440)。该网络将电子的坐标作为输入，并输出分子[轨道](@entry_id:137151)的值。然后，网络的参数直接使用[变分原理](@entry_id:198028)进行优化——这是量子力学的基石，它指出真实的基态能量是任何试探波函数可能得到的最低能量。在一个美妙的理论闭环时刻，网络[反向传播](@entry_id:199535)更新规则所需的梯度，结果是直接来自[量子化学](@entry_id:140193)教科书的一个量：一个涉及[Fock算符](@entry_id:139887)的[期望值](@entry_id:153208)，它是[Hartree-Fock理论](@entry_id:160358)核心的有效单[电子哈密顿量](@entry_id:177588)[@problem_id:369837]。在这里，机器学习不是一个附加组件，它被编织进了量子理论的结构之中。

### 宏伟挑战：迈向通用化学心智

最终的梦想是为化学建立一个单一的“通用”模型——一个能够理解物理定律并能将其应用于任何系统（从小的药物分子到蛋白质，再到周期性晶体）的“基础模型”。这是一项艰巨的任务，充满了挑战，将计算机科学和物理学的边界推向极限[@problem_id:2395467]。

首先，如何高效地收集训练这样一个模型所需的海量数据？最精确的[量子计算](@entry_id:142712)极其昂贵。我们不能简单地计算所有东西。解决方案是要巧妙，即使用**主动学习**。想象一个工作流程，模型在训练过程中能够识别出它最不确定的构型。然后，它只请求对那些点进行高精度[量子计算](@entry_id:142712)，从而最大限度地利用宝贵的计算资源。设计这些异步、事件驱动的系统是一项复杂的工程挑战，需要仔细管理数据队列和模型版本，以确保一致性并最大化吞吐量[@problem_id:2760147]。

其次，我们不应该为每个新问题都从头开始。就像人类建立在先验知识之上一样，我们的模型也应该如此。这就是**[迁移学习](@entry_id:178540)**（Transfer Learning）的领域。一个在庞大、通用的有机分子数据集上预训练过的模型，可以在一个更小、更具体的数据集（如某个特定的候选药物家族）上进行“微调”。挑战在于如何在学习特定任务的同时不发生“[灾难性遗忘](@entry_id:636297)”——即擦除通用知识。像弹性权重固化（EWC）这样的技术，从贝叶斯视角严格推导出来，对[神经网](@entry_id:276355)络的参数施加“软”约束，锚定那些对原始任务最重要的参数，同时允许其他参数适应新任务[@problem_id:2903813]。

最后，对通用模型的追求迫使我们面对最深层次的挑战。这样一个模型必须尊重三维空间的基本对称性，包括手性（handedness）这一微妙但至关重要的属性[@problem_id:2395467, A]。它必须找到捕捉[长程相互作用](@entry_id:140725)（如[静电相互作用](@entry_id:166363)）的方法，这些相互作用在[生物分子](@entry_id:176390)中至关重要，但标准的基于图的模型难以处理[@problem_id:2395467, B]。当用于生成新分子时，它必须遵守化学的基本规则，如化合价[@problem_id:2395467, G]。而且，它很可能会建立在**[自监督学习](@entry_id:173394)**（Self-Supervised Learning）的基础上，模型通过执行预测缺失原子或对三维结构去噪等任务来学习底层物理，从数据本身的结构中获取知识，而无需明确的标签[@problem_id:2395467, E]。

这段从表示单个原子到构建通用化学心智的旅程才刚刚开始。这是一场宏大的智力冒险，它不仅有望彻底改变我们发现药物和设计材料的方式，而且还将加深我们对支配分子世界的复杂而美丽法则的理解。