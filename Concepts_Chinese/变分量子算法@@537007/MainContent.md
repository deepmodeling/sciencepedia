## 引言
[变分量子算法](@article_id:638973)（VQA）是利用当今嘈杂中等规模量子（NISQ）计算机能力的最有前景的策略之一。这些混合[算法](@article_id:331821)在我们当前的量子能力与我们旨在解决的经典上难以处理的问题（特别是在[量子化学](@article_id:300637)和优化等领域）之间架起了一座桥梁。它们解决的核心挑战是如何从规模仍然有限且易受错误影响的量子处理器中提取有用的计算结果。VQA 通过将[量子计算](@article_id:303150)机独特的处理能力与[经典计算](@article_id:297419)机强大的优化能力相结合，提供了一个优雅的解决方案。

本文对这一强大的计算[范式](@article_id:329204)进行了全面概述。我们将首先深入探讨使这些[算法](@article_id:331821)得以运作的基础概念。然后，我们将探索它们可以应用的各种问题及其与其他科学领域的联系。

旅程始于**“原理与机制”**一章，我们将在此揭示[变分原理](@article_id:324104)——保证该方法有效性的物理定律。我们将剖析量子-经典混合反馈循环，理解[量子态](@article_id:306563)是如何被制备和引导的，并考察由复杂的优化景观和硬件噪声带来的挑战。随后，**“应用与跨学科联系”**一章将展示 VQA 如何被应用于模拟分子、解决复杂的优化问题，甚至改进它们所运行的[量子计算](@article_id:303150)机，揭示了物理学、计算机科学和化学之间丰富的相互作用。

## 原理与机制

任何伟大探索的核心都有一个简单而指导性的原则。对水手来说，它是北极星。对[变分量子算法](@article_id:638973)而言，它是量子力学中一个深刻而优雅的真理，被称为**变分原理**。理解这一原理是解开这些[算法](@article_id:331821)工作逻辑全貌的关键。

### 指路之星：自然的[变分原理](@article_id:324104)

想象一下，你正试图在一片广阔而隐秘的山谷中找到最低点。你无法看到整个地貌，但你可以向你选择的任何位置空投一个探测器，让它报告其海拔高度。变分原理给了你一个至关重要、不可动摇的保证：无论你的探测器降落在哪里，它的海拔*永远不会*低于山谷底部的真正最低海拔。

在量子力学中，“山谷”是所有可[能量子](@article_id:305960)态的空间，而“海拔”是与每个态相关的能量。[哈密顿算符](@article_id:309231) $H$ 是为每个态指定能量的规则。任何态可能拥有的最低能量是**[基态能量](@article_id:327411)**，我们称之为 $E_0$。变分原理指出，对于你可能构造的*任何*试探[量子态](@article_id:306563)，我们称之为 $|\psi\rangle$，该态的哈密顿量[期望值](@article_id:313620)（或[平均能量](@article_id:306313)）$\langle E \rangle = \langle\psi|H|\psi\rangle$，将总是大于或等于真实的基态能量：

$$
\langle\psi|H|\psi\rangle \ge E_0
$$

等式仅在您足够幸运，制备出的态 $|\psi\rangle$ *就是*一个[基态](@article_id:312876)时才成立。这一个不等式是[变分量子本征求解器](@article_id:310736)（VQE）的引擎。我们的任务是找到 $E_0$，而该原理告诉我们，通过制备各种试探态并测量它们的能量，我们可以系统地寻找可能的最低值。每一次测量都为我们的目标提供了一个上界，通过最小化这个测量的能量，我们越来越接近真实的基态能量 [@problem_id:2917666]。

### 混合之舞：驾驭[量子态](@article_id:306563)

我们如何制备这些试探态并引导它们走向最小值呢？这正是[量子计算](@article_id:303150)机与[经典计算](@article_id:297419)机之间美妙合作的用武之地。

首先，我们设计一个带有一组可调“旋钮”的[量子线路](@article_id:312280)。这些旋钮是参数，通常是线路门中的旋转角度，我们可以用向量 $\boldsymbol{\theta}$ 来表示。这种[参数化](@article_id:336283)的线路被称为 **ansatz**。当我们在一个初始[参考态](@article_id:311881)（如 $|00\cdots0\rangle$）上运行我们的线路时，它会产生一个试探态 $|\psi(\boldsymbol{\theta})\rangle$。我们的 ansatz 的[表达能力](@article_id:310282)决定了我们能够探索[状态空间](@article_id:323449)“山谷”的范围有多大。目标不是在每一步都制备出哈密顿量的[精确本征态](@article_id:299068)——那将等同于已经解决了问题！相反，ansatz 提供了一种灵活的方式来塑造一个我们希望可以被塑造成接近[基态](@article_id:312876)的试探态 [@problem_id:2917666]。

接下来，[量子计算](@article_id:303150)机的工作是测量这个试探态的能量，$E(\boldsymbol{\theta}) = \langle\psi(\boldsymbol{\theta})|H|\psi(\boldsymbol{\theta})\rangle$。然后，这个能量值被传递给一台经典计算机。

经典计算机扮演着导航员的角色。利用报告的能量，它运行一个[优化算法](@article_id:308254)来决定如何调整旋钮 $\boldsymbol{\theta}$ 以进行下一次尝试。为了高效地做到这一点，它需要知道最陡下降的方向——它需要[能量景观](@article_id:308140)的**梯度**，$\nabla_{\boldsymbol{\theta}} E(\boldsymbol{\theta})$。

有人可能会认为，计算这个梯度需要用对 $\boldsymbol{\theta}$ 的无穷小变化来探测景观，这个过程在量子设备上既困难又容易出错。但在这里，量子力学提供了一个非凡而优雅的捷径，称为**参数平移法则**。对于许多常见的量子门，比如旋转 $U(\theta) = \exp(-i\theta G/2)$，其中 $G$ 是一个泡利算符，一个[期望值](@article_id:313620)的精确解析[导数](@article_id:318324)可以通过在两个平移点上评估相同的[期望值](@article_id:313620)来找到。对于单个参数 $\theta$，该法则通常具有一个简单的形式：

$$
\frac{\partial E(\theta)}{\partial \theta} = c \left[ E(\theta + s) - E(\theta - s) \right]
$$

其中系数 $c$ 和平移量 $s$ 由门的生成元 $G$ 决定。对于一个标准的单[量子比特](@article_id:298377)旋转，平移量是 $s=\pi/2$，系数是 $c=1/2$。这意味着我们可以通过简单地将我们的[量子线路](@article_id:312280)再运行两次——一次将旋钮向前转90度，一次向后转90度——来找到我们当前位置能量景观的精确斜率 [@problem_id:2119189]。无需微小且充满噪声的步骤！这为经典优化器提供了它所需要的稳健的方向信息，以迭代地更新参数并引导[量子态](@article_id:306563)沿着能量[山坡](@article_id:379674)下降。

### 测量之谜：我们究竟在计算什么？

一个现实世界问题（如[量子化学](@article_id:300637)中的分子）的哈密顿量 $H$ 并不是一个单一、简单的算符。它是成千上万甚至数百万个单独项的巨大总和，每一项都对应着物理相互作用，如电子的动能或它们之间的静电排斥。对于一个 $n$ [量子比特](@article_id:298377)的系统，这些项被表示为加权的**泡利串**——作用于不同[量子比特](@article_id:298377)的[泡利算符](@article_id:304491)（$I, X, Y, Z$）的张量积。

因为这些单独的泡利串通常不对易（意味着它们不能被同时测量），我们无法在单次测量中测量总能量 $E(\boldsymbol{\theta})$。相反，总能量是通过分别测量每个泡利串（或一组泡利串）的[期望值](@article_id:313620)，然后在[经典计算](@article_id:297419)机上将它们与其相应的权重相加来重构的。

这就是[算法](@article_id:331821)与问题物理直接联系的地方。在[量子化学](@article_id:300637)中，哈密顿量的项对应于单电子和双电子相互作用，由积分 $h_{pq}$ 和 $v_{pqrs}$ 描述。在[量子计算](@article_id:303150)机上测量相应的泡利串，等同于估计**单粒子和双粒子[约化密度矩阵](@article_id:306735)**（[1-RDM](@article_id:362482) 和 [2-RDM](@article_id:360880)）的元素，我们可以称之为 $\gamma_{pq}$ 和 $\Gamma_{pq,rs}$。总能量则由这些基本组成部分拼接而成：

$$
E = \sum_{pq} h_{pq} \gamma_{pq} + \frac{1}{2} \sum_{pqrs} v_{pqrs} \Gamma_{pq,rs}
$$

测量可能数百万个项的过程听起来令人望而生畏。确实如此！测量次数是 VQA 的一个主要瓶颈。然而，我们可以更聪明一些。如果一组泡利串是“兼容的”——意味着它们在同一组基底下都是[对角化](@article_id:307432)的（这一性质被称为**逐[量子比特](@article_id:298377)对易**）——那么我们就可以通过单次实验测量它们所有的[期望值](@article_id:313620)。例如，算符 $Z \otimes I$、$I \otimes Z$ 和 $Z \otimes Z$ 都对易。这三者都可以通过制备态 $|\psi(\boldsymbol{\theta})\rangle$ 并在 $Z$ 基底下测量两个[量子比特](@article_id:298377)来测量。通过这种方式分组项，我们可以显著减少所需的实验次数，使[算法](@article_id:331821)更具实用性 [@problem_id:2932509]。

### 险恶的地形：通往[基态](@article_id:312876)之路的挑战

通往能量最小值的旅程充满了危险。[能量景观](@article_id:308140) $E(\boldsymbol{\theta})$ 不是一个简单、光滑的碗。它通常是一个复杂、崎岖的地形，有许多特征会困住一个不小心的优化器。

- **局部最小值：** 景观中可能有很多“山谷”并非真正的、最深的[基态](@article_id:312876)山谷。一个[基于梯度的优化](@article_id:348458)器很容易陷入其中一个**局部最小值**，找到一个能量低于其周围环境但仍显著高于真实[基态](@article_id:312876) $E_0$ 的状态 [@problem_id:2917666]。

- **[贫瘠高原](@article_id:303216)：** 比局部最小值更险恶的是**[贫瘠高原](@article_id:303216)**——景观中一个广阔的、指数级大的、几乎完全平坦的区域。在这些区域，梯度[几乎处处](@article_id:307050)为零。这种现象通常发生在“深”的或非结构化的 ansatz 线路中。直觉上，如果线路过于复杂和混乱，它会非常有效地扰乱[量子信息](@article_id:298172)，以至于对单个早期参数的微小改变对最终状态的影响微乎其微且看似随机。结果是，梯度的方差随着[量子比特](@article_id:298377)数 $n$ 的增加而指数级消失，$\mathrm{Var}[\partial_{\theta} E] \sim O(2^{-n})$ [@problem_id:2797465]。在[贫瘠高原](@article_id:303216)上的优化器就像一个在完全平坦、没有任何地标的沙漠中的徒步者——没有路径可循。

- **噪声：** 真实的[量子计算](@article_id:303150)机并非教科书中完美、理想化的机器。它们是**有噪声的**。构成我们 ansatz 的量子门可能是不完美的。例如，在一次双[量子比特](@article_id:298377) CNOT 门操作期间，[量子比特](@article_id:298377)之间可能会发生一个微小、不希望有的“串扰”相互作用，可以用一个寄生项如 $\lambda Z_1 X_2$ 来建模 [@problem_id:102972]。这种**[相干误差](@article_id:300808)**会系统性地使计算产生偏差，导致测量的能量偏离理想值。此外，与环境的相互作用可能导致[量子态](@article_id:306563)失去其精妙的相干性。这种噪声会冲刷掉能量景观的特征，进一步阻碍优化。

### 更智能的路径与更广阔的前景

尽管存在这些挑战，该领域仍在不断创新，寻找更智能的方式来导航景观，并拓宽这些[算法](@article_id:331821)所能达成的视野。

其中一个最令人兴奋的想法是让 [ansatz](@article_id:363651) 本身具有适应性。[算法](@article_id:331821)如 **ADAPT-VQE** 不再从一开始就固定一个可能不佳的线路结构，而是一次一个门地增长 [ansatz](@article_id:363651)。在每一步，[算法](@article_id:331821)会考虑一个可能的门池，并计算哪个门能提供最陡的瞬时能量下降。这是通过为池中每个候选算符 $\tau$ 计算梯度分量 $\langle \psi | [H, \tau] | \psi \rangle$ 来确定的。梯度最大的算符随后被永久添加到 [ansatz](@article_id:363651) 中，然后重复此过程 [@problem_id:2797530]。通过这种方式，[算法](@article_id:331821)利用问题本身的结构来发现一个紧凑而高效的线路，避免了导致[贫瘠高原](@article_id:303216)的通用、非结构化线路。这就像是为手头的工作打造一个定制工具，而不是使用一个通用工具。

此外，[变分原理](@article_id:324104)的力量不仅限于寻找基态能量。**Hellmann-Feynman 定理**在能量和其他物理性质之间提供了一个强大的联系。它指出，如果你已经找到了真实的[基态](@article_id:312876)，能量相对于哈密顿量中某个参数（如原子的位置）的[导数](@article_id:318324)，就是哈密顿量本身[导数](@article_id:318324)的[期望值](@article_id:313620)。虽然 VQE 态不是精确的[基态](@article_id:312876)，但如果它是一个好的近似，这种关系就近似成立。这使我们能够计算原子上的力，从而进行[几何优化](@article_id:351508)（寻找分子最稳定的形状）、计算[振动频率](@article_id:330258)以及探索[化学反应](@article_id:307389)路径 [@problem_id:2823870]。

一个[变分量子算法](@article_id:638973)的历程本身就是科学过程的一个缩影：我们从一个指导原则开始，建立一个工具来检验我们的假设，面对意想不到的挑战，并发明更聪明的工具来克服它们，最终扩展我们探索和理解世界的能力。

