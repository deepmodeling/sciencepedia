## 引言
在基因组学领域，[微阵列](@entry_id:270888)技术一直是一项革命性的工具，它能同时提供成千上万个基因活动状态的快照。然而，这种强大的能力也伴随着一个重大挑战：[微阵列](@entry_id:270888)产生的原始数据并非对生物学现象的直接、纯净的测量。相反，它充满了技术噪声和系统性失真，这些失真源于实验过程的每一步，从染料标记到图像扫描。这些噪声很容易掩盖或模仿真实的生物信号，导致错误的结论。[微阵列](@entry_id:270888)预处理这项关键而常被低估的任务，旨在通过在任何生物学分析开始之前对数据进行计算清理和校正，来解决这一知识鸿沟。

本文是这一基本过程的综合指南。在第一章**“原理与机制”**中，我们将深入探讨用于转换原始数据的核心技术，探索[背景校正](@entry_id:200834)、归一化和汇总的概念。随后，**“应用与跨学科联系”**一章将拓宽我们的视野，揭示预处理的选择如何促成复杂的生物学分析，并借鉴物理学、统计学和计算机科学等不同领域的见解。我们的旅程将从扮演一名数据修复师开始，任务是揭开隐藏在层层技术污垢之下的细胞活动杰作。

## 原理与机制

想象你是一位艺术品修复师，刚接手一幅无价的画作。不幸的是，它在一个布满灰尘的阁楼里存放了一个世纪。画布上满是污垢，有屋顶漏水留下的条痕，颜色也褪得不均匀。在你开始欣赏艺术家的作品之前，你必须一丝不苟地清洁和修复它。这正是我们在[微阵列](@entry_id:270888)预处理中的任务。来自[微阵列](@entry_id:270888)扫描仪的原始数据就是我们那幅布满污垢的画作；它描绘了一幅美丽的细胞活动图景，但被技术噪声和系统性失真所掩盖。我们的工作就是成为数据修复师，小心翼翼地去除污垢，而不改变下面的杰作。

这个修复过程是一段有几个关键站点的旅程。在每一站，我们都必须理解我们试图修复的伪影的性质，并选择正确的工具来完成任务。让我们踏上这段旅程，将原始的发光点转化为一幅清晰、可信的基因表达图谱。

### 从发光点到原始数值：初窥门径

[微阵列](@entry_id:270888)玻片被扫描后，我们得到的第一份数据是一幅[数字图像](@entry_id:275277)，一个由荧光点组成的星系，背景是黑色的。然后，图像分析软件会进行初步工作，识别每个点并测量两样东西：点本身的荧[光强度](@entry_id:177094)（**前景**）和其紧邻周围区域的强度（**背景**）。

我们马上就遇到了第一个问题。背景并非空无一物。玻片本身可能有一些自然荧光，一些荧光染料可能非特异性地粘附在表面，而不是与它们预期的DNA探针杂交。这种背景辉光就像一种低水平的噪声嗡嗡声，污染了我们的真实信号。为了得到更纯净的测量结果，我们的第一步是**[背景校正](@entry_id:200834)**。

对于我们所测量的东西，最简单的模型是一个加性模型：我们观察到的总强度是来自特异性杂交的真实信号和这种不必要的背景信号的总和，外加一些随机噪声。我们的目标是估计这个背景“嗡嗡声”，并从前景测量中减去它，以获得对真实信号的更好估计[@problem_id:1476366]。这听起来简单，但这是一个精细的操作。如果我们对背景的估计不佳，我们可能会留下噪声，或者更糟的是，过度减除并人为地扭曲弱表达基因的信号。这第一步已经向我们表明，预处理是一门估计和假设的科学，而不仅仅是简单的算术。

### 巴别塔问题：让阵列说同一种语言

有了经过[背景校正](@entry_id:200834)的强度值，你可能会认为我们可以开始比较样本间的基因表达了。例如，在一项癌症研究中，我们可以观察一个肿瘤样本和一个健康样本中的某个基因，看看哪个更亮。但别那么快！我们已经清理了单个的点，但现在我们面临一个更大的问题：每个[微阵列](@entry_id:270888)玻片，甚至单个玻片上的每个通道，都像一个说独特方言的人。一个阵列上的“亮”信号可能与另一个阵列上的“亮”信号意义不同。这些系统性的、非生物学的差异被称为**偏倚**或**伪影**，它们可能完全误导我们的分析。

想象一个双色[微阵列](@entry_id:270888)实验，比较药物处理过的样本（用红色染料标记）和对照样本（用绿色染料标记）。扫描后，我们可能会注意到，在整个阵列上，红色信号系统性地比绿色信号更亮。这是否意味着药物引起了大规模、全基因组范围的基因上调？几乎可以肯定不是。更有可能的是，红色染料本身荧光性更强，在标记反应中掺入效率更高，或者扫描仪对红色波长更敏感[@problem_id:1476378]。这是一种**染料偏倚**。如果我们不加以校正，我们就会从一个简单的技术怪癖中得出一个宏大的生物学结论。

这个问题不仅限于染料。有时，伪影局限于阵列的特定区域。也许不均匀的洗涤使得玻片的一个角落稍微干净一些，或者一个指纹弄脏了另一个角落。这导致了**空间伪影**，即该区域的所有基因都显得人为地更亮或更暗[@problem_id:2312675]。这就像试图阅读一本书，而一束阳光照在书页的一角——你不能把眩光误认为是重要的文字。

也许最危险和最具欺骗性的伪影是**批次效应**。实验往往太大，无法一次性完成。样本可能由不同的技术人员、在不同的日期、或使用不同批次的化学试剂进行处理。这些“批次”中的每一个都可能在数据上引入其独特的系统性印记。在一个设计不当的实验中，这些[批次效应](@entry_id:265859)可能与我们关心的生物学现象纠缠在一起，或者说**混杂**。例如，如果你所有的对照样本都在周一处理，而你所有的处理样本都在周二处理，你怎么能确定你看到的差异是由于处理而不是“周一的[化学反应](@entry_id:146973)”和“周二的[化学反应](@entry_id:146973)”之间的某些细微变化呢？[@problem_id:1426088]。当我们对这[类数](@entry_id:156164)据进行可视化时，我们常常看到样本按其处理日期[聚类](@entry_id:266727)，而不是按我们试图研究的生物学条件聚类。这在数据分析中是最高级别的警报，表明我们的技术变异完全淹没了真实的生物学信号。

### 归一化的艺术：一个追求公平的工具箱

为了解决这个“巴别塔问题”，我们需要应用一套称为**归一化**的程序。归一化的目标是调整阵列内部和阵列之间的测量值，以消除这些系统性偏倚，确保任何剩余的差异都尽可能归因于真实的生物学现象。

一个关键的准备步骤是改变我们对数据本身的看法。我们几乎总是应用**对数转换**（通常是底为2的对数），而不是使用原始强度比（例如，$I_{\text{treated}}/I_{\text{control}}$）。这样做的原因在其简单性中显得非常深刻。想象一个基因上调了2倍，其比值为$2$。如果它下调了2倍，其比值为$\frac{1}{2}$，即$0.5$。在线性尺度上，这些变化看起来是不对称的：上调距离“无变化”值$1$的距离是$1$，而下调的距离只有$0.5$。通过取$\log_{2}$，2倍上调变为$\log_{2}(2) = 1$，2倍下调变为$\log_{2}(0.5) = -1$。现在，相同幅度的变化在新“无变化”点$0$周围是完全对称的[@problem_id:1476377]。这个简单的数学技巧使数据在可视化上更直观，在统计学上也表现得更好。

将数据置于适当的对数尺度上后，我们可以使用诊断工具来检查我们阵列的健康状况。其中最著名的是**MA图**。对于一个双色阵列，该图在y轴上显示两个通道的对数比（'M'值，代表减去 Minus），在x轴上显示通道的平均对数强度（'A'值，代表平均 Average）。由于我们预期大多数基因的表达*不会*改变，因此在归一化之后，此图应显示一个围绕$M=0$线水平居中的点云。然而，在归一化之前，染料偏倚可能会显示为一条曲[线或](@entry_id:170208)“香蕉”形状，表明偏倚取决于基因的强度[@problem_s_id:2805343]。看到这种香蕉形状就像医生发现了一个症状；它准确地告诉我们需要应用哪种药物——哪种归一化算法。

归一化工具箱包含几种工具：
-   **LOESS归一化**：这是一种强大的技术，旨在修复我们在MA图中看到的那种强度依赖性偏倚。它的工作原理是通过MA图中的点云拟合一条灵活、平滑的曲线（LOESS是局部加权散点平滑的缩写），然后减去这一趋势。其效果是“拉直”数据，迫使点云在所有强度上都以$M=0$线为中心。这是校正染料和空间偏倚的一种常用且有效的方法[@problem_id:1476378] [@problem_id:2312675]。

-   **[分位数归一化](@entry_id:267331)**：这是一种更激进、也非常流行的方法，用于在多个阵列之间进行归一化（例如，在单色实验中）。这里的理念很大胆：它假设每个样本中基因表达值的总体[统计分布](@entry_id:182030)应该是相同的。它通过用新值完全替换观测值来强制执行这一假设。该过程在概念上很优雅：对于每个阵列，你将其数千个基因表达值从低到高排序。然后，对于每个秩次（例如，第100个最低值），你计算所有阵列中该秩次值的平均值。最后，你回到原始数据，用与其秩次相对应的平均值替换每个基因的值[@problem_id:3339411]。结果是一个数据集中每个阵列的值[分布](@entry_id:182848)都完全相同。这是一种非常有效的方法，可以消除多种技术变异，但它建立在一个可能并不总是成立的非常强的假设之上。

### 从多个探针到一个答案：汇总的艺术

在许多[微阵列](@entry_id:270888)平台上，单个基因不是由一个点来测量的，而是由一整套不同的探针来测量的。这提供了一种内置的复制和稳健性形式。但这也意味着我们需要最后一步：将来自这些多个探针的信息**汇总**成每个基因的单个表达值。

这是另一个不同理念和[统计模型](@entry_id:165873)相互竞争的领域。汇总方法的选择通常与特定的[背景校正](@entry_id:200834)和归一化策略捆绑在一起，形成全面的[预处理](@entry_id:141204)“软件包”。比较Affymetrix阵列的三种经典方法，揭示了这种思想的多样性[@problem_id:2805324]：

-   **MAS5**：这种较老的方法非常直观。它试图通过在每个“[完美匹配](@entry_id:273916)”（PM）探针旁边使用一个“错配”（MM）探针来估计背景，并基本上从PM信号中减去MM信号。然后，它通过简单的缩放进行归一化，并使用稳健平均值来汇总多个探针值。

-   **RMA（稳健多阵列平均）**：该方法代表了一个重大的转变。其支持者认为MM探针在背景估计方面不可靠。RMA忽略了它们，使用一个复杂的统计模型来仅校正PM探针的背景。然后，它应用强大的[分位数归一化](@entry_id:267331)，并使用另一个称为中位数平滑（median polish）的模型来汇总对数转换后的值。

-   **GCRMA**：该方法建立在RMA之上。它认识到[非特异性结合](@entry_id:190831)并非随机——它是[化学反应](@entry_id:146973)。具有不同[核苷酸](@entry_id:275639)碱基序列（特别是其鸟嘌呤-胞嘧啶或[GC含量](@entry_id:275315)）的探针将具有不同的“粘性”。GCRMA将此序列信息纳入其[背景校正](@entry_id:200834)模型，使其比RMA的模型更具物理真实性。

这里的教训不是说某一种方法总是最优越的，而是说即使是合并几个数字这最后一步，也充满了关于底层物理和统计测量的假设。

### 未言明的假设：坚实的地基还是纸牌屋？

我们已经从原始图像走到了一个干净、可供分析的数据表。感觉我们已经建立了一个坚实的基础。但是一个好的科学家，像Feynman一样，总会问：我们一路走来都假设了什么为真？从细胞中mRNA分子的数量到我们最终的表达值，这个推断链条出奇地长，并且充满了假设[@problem_id:2805452]。

我们假设荧光标记的DNA量与起始mRNA的量成正比。我们假设这种DNA与玻片上探针的杂交以一种良好的线性方式发生（实际上并非如此；它在高浓度时会饱和）。我们假设扫描仪的检测器是完全线性的。我们假设背景噪声纯粹是加性的，并且可以被干净地减去。我们假设我们的归一化策略在消除技术偏倚的同时没有扭曲真实的生物信号。我们还假设像探针意外结合到错误基因（**交叉杂交**）这样棘手的问题是可以忽略不计的。

这个清单并非意在令人沮丧，而是为了培养一种健康的科学怀疑精神。它揭示了我们的“测量”实际上是一个复杂模型的输出。高质量的[预处理](@entry_id:141204)是使该模型中的假设尽可能合理，并敏锐地意识到它们可能失效的条件的艺术。

### 终极[预处理](@entry_id:141204)步骤：良好的实验设计

这把我们带到了最后一个，也是最重要的原则。我们有一个强大的计算工具箱来清理杂乱的数据。但有一种混乱是任何算法都无法可靠修复的：有缺陷的实验设计。

再考虑一下[批次效应](@entry_id:265859)问题。如果你在周一处理所有对照样本，在周二处理所有处理样本，那么你正在寻找的生物学效应就与技术[批次效应](@entry_id:265859)完全混杂了[@problem_id:3339386]。你的[统计模型](@entry_id:165873)面临着一个不可能完成的任务。它看到了两组之间的差异，但它无法决定是将该差异归因于“处理”标签还是“周二”标签。生物学参数和批次参数在数学上是不可识别的。

我们能在计算机上修复这个问题吗？有一些像`ComBat`这样的英勇方法试图这样做，但它们依赖于强有力的假设，并且是在打一场上坡战[@problem_id:1426088]。真正的解决方案要简单得多，并且必须在实验开始之前就发生。终极的预处理步骤是**良好的实验设计**。

解决方案是**随机化**。你必须确保来自不同生物学条件的样本[分布](@entry_id:182848)在不同的处理批次中。在周一的批次中放一些对照样本和一些处理样本，在周二的批次中也放一些。通过打破混杂，你为你的统计模型提供了区分两种变异来源所需的信息[@problem_id:3339386]。没有任何计算魔法可以替代这一科学研究的基本原则。这提醒我们，在大数据时代，精心、深思熟虑的实验这一永恒规则比以往任何时候都更加重要。

