## 应用与跨学科联系

在深入了解 t-SNE 的数学核心之后，我们可能会倾向于将其视为一种巧妙的计算机器，一种整理混乱数据的工具。但这样做就像将显微镜描述为仅仅是透镜的排列。一个伟大的科学工具的真正奇妙之处不在于其构造，而在于它让我们能够看到的新世界。在本章中，我们将穿越其中一些世界，探索 t-SNE 如何成为 21 世纪的一种新型显微镜，揭示了生物学、化学乃至科学哲学等不同领域中隐藏的结构。我们将看到，[t-SNE](@entry_id:276549) 不仅仅是一种可视化算法；它是一种思维方式，一种描述高维现实错综复杂织锦的新语言。

### 绘制生物学宇宙图谱

也许 [t-SNE](@entry_id:276549) 的影响在任何地方都没有像在生物学中那样具有革命性，尤其是在单细胞技术出现之后。想象一下，通过分析由一个繁华城市所有居民混合而成的冰沙来了解这个城市。这就是几十年来基因组学的状态。单细胞 RNA 测序改变了一切，使我们能够一次性分析成千上万个单个细胞的基因表达。结果是一个维度惊人的数据集，其中每个细胞都是一个具有两万或更多维度的空间中的一个点。我们如何才能理解这一切呢？

这正是 t-SNE 提供其第一个伟大洞见的地方。它将这个庞大到无法想象的“基因表达空间”投影到一张二维地图上。在这张地图上，具有相似基因表达谱的细胞——以相似方式“交谈”的细胞——被放置在一起。结果往往令人叹为观止。我们看到的不是一片均匀的迷雾，而是一个由不同岛屿组成的群岛。每个岛屿都是一个细胞簇，通过检查每个簇内活跃的基因，生物学家通常可以识别出它们是已知的细胞类型——这里是一簇产生胰岛素的内分泌细胞，那里是一簇制造[消化酶](@entry_id:163700)的腺泡细胞。

但真正的兴奋始于我们发现一个未知的岛屿。想象一张发育中的胰腺图谱，揭示了已知的细胞类型，但也显示了一个小的、紧凑且分离良好的第四个簇。通过“审问”这个新岛屿的细胞，生物学家可能会发现它们表达了一组独特的转录因子，即细胞身份的主开关。这不是一个计算上的幻影；这是一个发现。这张地图刚刚揭示了一个以前未知的细胞类型或一个短暂的祖细胞状态，这是器官发育故事中一个以前看不见的关键角色 [@problem_id:1443743]。

然而，地图不仅显示静态的岛屿。有时，它揭示了它们之间流动的变化之河。当研究像祖细胞分化为成熟神经元这样的过程时，[t-SNE](@entry_id:276549) 图可能不会显示两个独立的簇。相反，它可能会揭示一条连续、蜿蜒的轨迹。一端是祖细胞，另一端是成熟神经元。而 sepanjang 路径上的所有细胞，都是在旅途中被捕获的中间细胞。[t-SNE](@entry_id:276549) 图可视化了“成为”的过程；它以地理形式展示了一个发育连续体，这个概念如此强大，以至于它有了自己的名字：伪时间（pseudotime） [@problem_id:1466158]。

### 友情提醒：地图绘制的艺术

每个地图制作者都知道，地图是一种表现形式，而不是完美的复制品，它有自己的扭曲，需要仔细解读。对于 [t-SNE](@entry_id:276549) 来说，这一点同样深刻地成立。

首先，地图的质量完全取决于测量员的准备工作。如果生物学家直接将 [t-SNE](@entry_id:276549) 应用于原始基因计数数据，得到的图像将是一片混乱。景观将不再由生物学中微妙的丘陵和山谷主导，而是由技术伪影的巍峨山脉和深邃峡谷主导——主要是“文库大小”，即从每个细胞捕获了多少分子。得到的图将显示这个技术因素的梯度，而真正的生物细胞类型则 hopelessly jumbled 在一起。只有经过仔细的归一化——相当于计算上考虑测量员的海拔高度——真正的生物学景观才能显现出来 [@problem_id:2429837]。

其次，这是一个关键点，**t-SNE 保留局部邻域是以牺牲全局距离为代价的**。想象一张世界地图，你所在城市的街道布局被完美保留，但大陆被拉伸和挤压，以至于巴黎和东京之间的距离与巴黎和伦敦之间的距离相同。这就是 t-SNE 的工作方式。它擅长告诉你谁是你的邻居，但它给出了一个关于大规模关系的误导性画面。在分析来自不同环境的[微生物群落](@entry_id:167568)时，像[主成分分析](@entry_id:145395)（PCA）这样的方法可能会显示盐沼群落是远离森林和草地群落的异常值。然而，同样数据的 [t-SNE](@entry_id:276549) 图可能会显示所有三个簇大致等距。这是一种人为产物。t-SNE 算法专注于保留每个簇的内部结构，在此过程中，它扭曲了[微生物生态系统](@entry_id:169904)的全局“地图” [@problem_id:1428881]。[t-SNE](@entry_id:276549) 图上簇之间的距离告诉你它们是不同的，但它*并不*告诉你它们*有多*不同。

最后，[t-SNE](@entry_id:276549) 可以充当“悄声放大器”，这既是优点也是需要谨慎的原因。想象一个数据集，其中 99% 的变异仅由两个主成分解释，可能对应于某个主导但无趣的[生物过程](@entry_id:164026)。PCA 图只会显示这个主导趋势。然而，隐藏在剩余 1% 方差中的可能是定义十个不同生物亚型的微妙差异。旨在捕捉“最响亮”信号（最大方差）的 PCA 将完全错过这一点。[t-SNE](@entry_id:276549) 通过专注于保留局部邻域，可以捕捉到这些“悄声”并将其放大，将十个亚型呈现为分离优美的簇。这非常强大，但这也意味着 t-SNE 图上看起来是主要分离的东西，可能对应于高维现实中非常细微的差异 [@problem_id:2416116]。

### 超越生物学：一种通用的结构语言

t-SNE 揭示高维数据结构的能力不仅限于生物学。它是一种通用语言。

在化学领域，研究人员通过探索分子结构与其活性之间的关系（一个称为 QSAR 的领域）来设计新药。这涉及到将每个候选分[子表示](@entry_id:141094)为高维“化学描述符空间”中的一个点。就像细胞一样，[t-SNE](@entry_id:276549) 可以绘制这个空间，将具有相似性质的分子聚类。这种可视化可以帮助化学家在浩瀚的可能化合物景观中导航，识别有前途的邻域，并理解为什么有些分子有活性而另一些没有。同样的解释注意事项也适用：地图是一个指南，而不是化学相似性的定量[精确度](@entry_id:143382)量 [@problem_id:4602670]。

也许最深刻的联系是与基础物理学的联系。研究分子行为的物理学家和化学家正在应对一种极端的[维度灾难](@entry_id:143920)。即使是一个简单蛋白质的状态，也由数千个原子的位置来描述，这是在一个天文数字般巨大的空间中的一个点。系统的行为由其[自由能景观](@entry_id:141316)控制，这是这个空间中的一个曲面，其山峰和山谷对应于不稳定和稳定的状态。直接绘制这个景观在计算上是不可能的。降维至关重要。虽然像 PCA 这样的技术可以找到最大规模的运动，但 t-SNE 可以提供对景观复杂拓扑的直观一瞥——多个稳定盆地（簇）的存在以及它们之间的路径。在这里，与地图绘制的类比也至关重要：[t-SNE](@entry_id:276549) 提供了地形的优美定性图像，但因为它扭曲了密度和全局距离，所以不能用于定量测量状态之间能量壁垒的高度。为此，需要植根于统计力学的其他方法 [@problem_id:3749637]。

### 从静态地图到动态科学工具

t-SNE 图本身不是目的；它是科学探究的开始。它揭示的簇和轨迹是需要严格检验的假设。例如，当我们在图上看到 T 细胞激活过程时，它代表的是一个连续、平滑的过渡，还是在一系列离散、稳定状态之间的跳跃？仅凭对 t-SNE 图的视觉检查不足以回答这个问题，因为算法可能会人为地制造或夸大间隙。为了真正区分连续体和离散状态，科学家必须部署一整套更先进的工具：分析底层数据图的连通性（谱分析）、测试簇在扰动下的稳定性，甚至使用 RNA 速度计算细胞变化的“流”。在这种现代科学工作流程中，t-SNE 是发现有趣地形的出色侦察兵，然后由专家团队进行细致的勘测 [@problem_id:2371663]。

这凸显了一个实际的局限性：标准的 [t-SNE](@entry_id:276549) 地图是静态的。它是为固定的数据集创建的。如果一家医院根据临床数据为其患者生成了一张 [t-SNE](@entry_id:276549) 地图，而一个新病人来了怎么办？没有内置的方法可以将新病人放置在现有地图上，除非重新运行整个计算成本高昂的分析，这会移动所有旧的点。这就是“样本外”问题。虽然存在诸如“[参数化](@entry_id:265163) t-SNE”之类的变通方法——训练一个神经网络来学习映射——但这是其他算法（如 UMAP）具有天然优势的关键领域 [@problem_id:5208948]。这些工具的开发是一个动态的领域，不断发展以应对新的科学挑战。

### 一种新的观察方式

让我们以退一步的方式结束，思考 t-SNE 真正代表了什么。在 18 世纪，Carolus Linnaeus 在“类型学[本质主义](@entry_id:170294)”的哲学基础上创立了现代[分类学](@entry_id:172984)。他相信每个物种都由一个固定的、不可改变的“本质”定义，[分类学](@entry_id:172984)家的工作是找到定义这种理想类型的最小字符集。分类是一个将个体生物与预定义的抽象规则进行衡量的过程。

现在考虑一下 [t-SNE](@entry_id:276549) 中嵌入的世界观。它没有提到理想类型。它不问一个细胞是否拥有一套最小的基本特征。相反，它从测量*每个个体与所有其他个体*之间的相似性开始。簇，即 [t-SNE](@entry_id:276549) 图上的“物种”，不是由自上而下的规则定义的；它们是整个群体内成对关系网络的涌现属性。分类是关系性的和上下文相关的，而不是绝对的。

即使 [t-SNE](@entry_id:276549) 图以令传统[分类学](@entry_id:172984)家满意的方式完美地分开了物种，其哲学基础也截然不同。Linnaeus 会拒绝它，不是因为它在经验上失败了，而是因为它的逻辑本身——将类别建立在群体范围的相似性上，而不是建立在与固定本质的接近程度上——与他的世界观格格不入 [@problem_id:1915585]。

在这里，我们看到了 t-SNE 最深层的美。它不仅仅是一个算法。它是科学范式转变的计算体现，从柏拉图式的理想转向[群体思维](@entry_id:170930)。它为我们提供了一种观察和推理世界的方式，这个世界不是由僵硬的类别定义的，而是由连续、复杂而美丽的关系织锦定义的。从最真实的意义上说，这是一种新的观察方式。