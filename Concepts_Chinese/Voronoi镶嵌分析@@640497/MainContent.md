## 引言
我们如何在一个散布着点的场中明确地定义一个“邻域”？答案在于一个优美而简单的几何概念：Voronoi镶嵌。这个方法源于“哪个最近？”这一直观问题，为划分空间、定义局部结构和理解邻近性提供了一种强大而通用的语言。然而，其优雅的背后是在众多科学领域中的深远效用。在从[材料科学](@entry_id:152226)到宇宙学的各个领域，研究人员都面临着从一组离散点——无论是原子、星系还是数据中心——中解读其底层结构的共同挑战。Voronoi镶嵌为这个基本问题提供了一个稳健、无参数的解决方案。本文旨在探讨这一不可或缺的分析工具的原理及其广泛应用。

这段旅程始于“原理与机制”一章，我们将在此解构Voronoi镶嵌的基本规则。我们将从基本的“最近点”原则开始，了解它如何引出[理想晶体](@entry_id:138314)中[Wigner-Seitz原胞](@entry_id:137574)等概念。然后，我们将揭示更多微妙的细节，例如用于分类局部几何的Voronoi指数，以及使分析适应热运动和颗粒尺寸变化等现实世界复杂性的方法。随后，“应用与跨学科联系”一章将展示该方法的卓越通用性。我们将从原子尺度出发，看它如何帮助识别晶体缺陷和预测玻璃形成；然后进入广阔的宇宙，看它如何绘制宇宙空洞；最后进入计算科学的世界，看它如何促成物理现象的复杂模拟。

## 原理与机制

### 各得其所：划分空间的最简单法则

想象你正在一个节日上，几个冰淇淋摊位散布在一片大场地上。如果你想吃冰淇淋，你会去哪个摊位？答案显而易见：你会去离你最近的那个。现在，让我们把这个问题变得更正式一些。对于场地中的每一个点，我们都可以确定哪个冰淇淋摊位是最近的。如果我们绘制一张地图，根据每个点指定的摊位为其着色，我们会发现场地被分割成一系列不同的区域。每个区域都包含一个摊位，囊括了该摊位是最近选择的所有位置。这种直观划分空间的方式，正是我们所说的**Voronoi镶嵌**的核心。

这个简单的“最近点”法则为我们提供了一种强大而明确的方式来定义给定集合中每个点的个人空间，即**Voronoi原胞**。一个点（我们称之为 $P$）的[原胞](@entry_id:159354)，是空间中所有离 $P$ 比离集合中任何其他点都更近的位置的集合。这张完整的地图，即所有这些[原胞](@entry_id:159354)无间隙、无重叠地铺满空间的集合，就是Voronoi镶嵌。

宇宙是如何绘制这些边界的呢？其几何结构出人意料地优雅。只考虑两个点，$P_1$ 和 $P_2$。它们领地之间的边界是与两者等距的点集。这无非是连接它们的线段的**[垂直平分线](@entry_id:163148)**——在二维空间中是一条线，在三维空间中则是一个平面。因此，任何单个点的Voronoi[原胞](@entry_id:159354)都是一个[凸多边形](@entry_id:165008)（二维）或[凸多面体](@entry_id:170947)（三维），其壁面由它与所有近邻的[垂直平分线](@entry_id:163148)构成。这是你通过用所有其他点的主张将其包围起来，而为一个点建造的堡垒。[@problem_id:2979373]

### 从随机点到理想晶体：[Wigner-Seitz原胞](@entry_id:137574)

Voronoi镶嵌的概念是完全普适的；它适用于任何点的集合，无论这些点是随机散布的还是精心[排列](@entry_id:136432)的。这正是它在科学中变得极其强大的地方。如果我们的“点”是[理想晶体](@entry_id:138314)中的原子，会发生什么呢？

在理想晶体中，原子以一种惊人规整、重复的模式[排列](@entry_id:136432)，称为**Bravais[晶格](@entry_id:196752)**。如果我们将Voronoi构造应用于Bravais[晶格](@entry_id:196752)的点，得到的原胞有一个特殊的名字：**[Wigner-Seitz原胞](@entry_id:137574)**。根据定义，这个[原胞](@entry_id:159354)是[晶格](@entry_id:196752)的一个原胞；也就是说，你可以通过每个[晶格矢量](@entry_id:161583)平移这个单一形状，来完美地铺满整个空间。它的体积是[晶体结构](@entry_id:140373)的一个基本属性，等于人们可以定义的任何其他[原胞](@entry_id:159354)的体积。[@problem_id:2979373] 因为Bravais[晶格](@entry_id:196752)具有反演对称性（如果[晶格](@entry_id:196752)点在矢量$\mathbf{R}$处，那么在$-\mathbf{R}$处也存在一个），[Wigner-Seitz原胞](@entry_id:137574)总是[中心对称](@entry_id:144242)的。它是[晶格](@entry_id:196752)本身独一无二的基本几何指纹，与我们选择如何描述[晶格矢量](@entry_id:161583)无关。[@problem_id:2979373]

在二维空间中，简单三角[晶格](@entry_id:196752)——平面上最[密堆积](@entry_id:139822)圆的方式——的[Wigner-Seitz原胞](@entry_id:137574)是一个正六边形。每个原子有六个最近邻，而Voronoi[原胞](@entry_id:159354)也忠实地通过拥有六个面来反映这一点。在这里，直觉得到了完美的印证：近邻数等于面数。[@problem_id:2475661]

### 一个美丽的陷阱：当近邻不仅仅是最近的

人们可能很容易推广，认为Voronoi原胞的面数*总是*等于最近邻的数量。然而，自然界比这更微妙、更有趣。这是简单直觉必须被修正的一个关键点。

考虑**[体心立方](@entry_id:151336)（BCC）**[晶格](@entry_id:196752)，这是像铁这样的金属常见的结构。位于立方体中心的原子有8个最近邻，它们位于该立方体的角上。但它还有6个次近邻，位于相邻立方体的中心。当我们构建[Wigner-Seitz原胞](@entry_id:137574)时，一件奇妙的事情发生了。来自8个最近邻*和*6个次近邻的垂直平分面共同雕刻出最终的形状。最终形成的[多面体](@entry_id:637910)是一个宏伟的**[截角](@entry_id:197363)八面体**，一个有14个面的形状！其中八个是对应于最近邻的六边形面，另外六个是对应于次近邻的较小的正方形面。[@problem_id:2979373] [@problem_id:2475641] [@problem_id:2475690]

这个例子是一个深刻的教训。Voronoi镶嵌识别的是**拓扑近邻**——即共享一个公共边界的原子，无论它们的确切距离如何。而最近邻的数量，通常称为**配位数**，是一个纯粹基于距离的**度量**概念。这两个概念并不总是一样的。Voronoi构造通过包含所有几何上“暴露”于中心原子的近邻，给出了对局部环境更完整、无参数的描述。

### 局部几何的语言：Voronoi指数

BCC的例子表明，仅仅计算面数是不够的。为了捕捉局部几何的全部丰富性，我们需要一种更具描述性的语言。**Voronoi指数**，通常写作 $\langle n_3, n_4, n_5, n_6, \dots \rangle$，正提供了这样一种语言。它是一个签名，其中每个数字 $n_k$ 告诉你Voronoi原胞中有多少个面是 $k$ 边多边形。

这个指数就像是局部原子[排列](@entry_id:136432)的指纹。让我们看一些常见的12配位结构：
- **面心立方（FCC）：** Voronoi原胞是一个菱形十二面体，它有12个相同的四边形面。其指数为 $\langle 0, 12, 0, 0 \rangle$。
- **二十面体有序：** 一个中心原子被12个位于二十面体顶点的近邻包围。这是玻璃和[过冷液体](@entry_id:158222)中的一个关键基元。这里的Voronoi[原胞](@entry_id:159354)有12个相同的五边形面。其签名为 $\langle 0, 0, 12, 0 \rangle$。
- **体心立方（BCC）：** 正如我们所见，[截角](@entry_id:197363)八面体有6个正方形（四边形）面和8个六边形面。其指数为 $\langle 0, 6, 0, 8 \rangle$。[@problem_id:3450314]

这一串简单的数字让计算机能够即时区分那些在其他方面可能看起来相似的高度对称的局部环境。在有限温度下，原子[振动](@entry_id:267781)会使这些完美的形状轻微扭曲。一个二十面体团簇可能会因为一个五边形面短暂变形而暂时呈现出 $\langle 0, 1, 10, 1 \rangle$ 的指数。这种拓扑签名及其微小变化，提供了一种即使在液体的混乱中也能稳健追踪结构基元的方法。[@problem_id:3450341]

### 拥抱现实：缺陷、[振动](@entry_id:267781)和不同尺寸

一个科学工具的真正力量，在于它被应用于现实世界的混乱而非纯净的理想化模型时所展现出的能力。

- **缺陷与不完美：** 当一个原子缺失（一个**空位**）时会发生什么？其原近邻的Voronoi[原胞](@entry_id:159354)会膨胀以填补空隙，它们的形状会扭曲，面数也会改变。镶嵌自然而优雅地适应，显示出局部几何是如何被缺陷扰动的。在一个二维三角[晶格](@entry_id:196752)中，制造一个单位空位会使系统中[配位数](@entry_id:143221)的总和精确地减少12，这是网络拓扑的一个奇特但精确的后果。[@problem_id:2475661]

- **热[振动](@entry_id:267781)与噪声：** 任何高于绝对[零度](@entry_id:156285)的材料中的原子都在不停地运动。这种随机的[振动](@entry_id:267781)会使我们精确的几何构造变得无用吗？恰恰相反。Voronoi指数是一个拓扑属性。就像甜甜圈上的孔数一样，它不会因微小变形而改变。一个原子可以在其局部笼中相当大地[振动](@entry_id:267781)，而其Voronoi指数将保持完全恒定。只有当波动足够大，导致“近邻交换”事件发生时，指数才会离散地改变。这使得该指数成为描述底层结构的稳健描述符，能够过滤掉无关的[热噪声](@entry_id:139193)。为了获得更高的稳健性，可以通过共享Voronoi面的面积来对近邻的贡献进行加权；当一个近邻因热运动被“挤出”时，其面积极平滑地缩小至零，从而防止计算属性的突变。[@problem_id:3430964] [@problem_-id:3450341]

- **不同尺寸的原子：** “最近点”法则隐含地假设所有点都是平等的。但在像盐（NaCl）这样的离子晶体或复杂的[钙钛矿](@entry_id:186025)中，钠阳离子比氯阴离子小得多。用一条恰好在中间的平分线来划分它们之间的空间公平吗？一种更符合物理实际的方法是**根式Voronoi镶嵌**，或称**幂图**。这种构造将边界平面移向较小的原子，实际上是给了较大的原子更多的空间。这种精细化的方法对于正确识别含有不同尺寸原子的系统中相互接触的近邻至关重要，解决了标准方法所产生的模糊性。[@problem_id:2475641] [@problem_id:2930970]

### 不只是近邻：体积、密度与对偶性

Voronoi镶嵌的馈赠不止于识别近邻。一个原子的Voronoi[原胞](@entry_id:159354)的**体积** $V_i$，是它所占据的局部空间的直接度量。因此，该体积的倒数 $1/V_i$ 可用作一个强大的、无参数的**局部数密度**估计器。通过为分子模拟中的每个原子计算这个值，我们可以生成液体中或复杂分子周围[密度涨落](@entry_id:143540)的详细图谱。

这里也存在一种微妙的统计之美。虽然这个Voronoi密度场在整个模拟盒子上的*[空间平均](@entry_id:203499)值*总是精确等于总密度 $N/V$，但一个简单的粒子平均值 $\frac{1}{N}\sum_i (1/V_i)$ 将系统地*高于*真实密度。这是数学中[Jensen不等式](@entry_id:144269)的直接后果，该不等式指出，对于像 $f(x)=1/x$ 这样的凸函数，函数的平均值大于平均值的函数（$\mathbb{E}[1/V] > 1/\mathbb{E}[V]$）。这优美地提醒我们，深刻的数学原理是如何在物理系统的分析中浮现的。[@problem_id:3450304]

最后，这里还有一个深刻而优雅的**对偶性**在起作用。对于每一个Voronoi镶嵌，都存在一个称为**Delaunay三角剖分**的对偶结构。如果你连接所有作为Voronoi近邻的点对，你会得到一个由三角形（二维）或四面体（三维）组成的网络。这个Delaunay图自身有一个优美的性质：其任何一个四面体的外接球都不包含集合中的任何其他点。这两个结构紧密相连：一个Voronoi顶点是一个Delaunay四面体的[外心](@entry_id:174510)。一条Voronoi边垂直于它所穿过的Delaunay面。这种正交性不仅仅是一个几何上的奇观；它构成了强大的数值方案的基础，例如有限体积法，用于在复杂几何上求解控制热流、[扩散](@entry_id:141445)和[流体动力学](@entry_id:136788)的基本物理方程。[@problem_id:3376996]

从一个“谁是最近的？”的简单问题，诞生了一个丰富、优美且极其有用的数学框架。Voronoi镶嵌为我们提供了一种描述局部结构的语言，一个分析真实和不完美材料的工具，以及一个模拟物理世界的基础，揭示了物质复杂性背后隐藏的几何秩序。

