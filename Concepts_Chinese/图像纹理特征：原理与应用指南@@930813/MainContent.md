## 引言
视觉世界充满了各种模式——木材的粗糙纹理、织物的精致编织、多云天空的结构化混沌。我们直观地将这种特性感知为纹理。但是，我们如何教会计算机“看见”并量化图像的这一基本属性呢？超越简单的颜色和亮度，[纹理分析](@entry_id:202600)提供了一种[计算显微镜](@entry_id:747627)，用以解码像素的空间排布，从而解锁那些肉眼常常无法看到的信息。这种能力具有深远的影响，使我们能够探究医学扫描中疾病的微观结构，或通过卫星图像对广阔的景观进行分类。

然而，从视觉模式到有意义、鲁棒的数字的旅程充满了挑战。捕获图像的行为本身就会引入噪声和伪影，而不同的设备可能产生截然不同的结果，从而在我们看到的纹理与我们分析的数据之间造成鸿沟。本文通过提供一份关于图像纹理特征的综合指南来弥合这一差距。它首先揭开核心概念的神秘面纱，探索如何通过统计学和频率分析的视角来定义纹理。然后，它详细介绍了用于捕捉这些模式的特征构建方法。随后，本文将进入现实世界，展示[纹理分析](@entry_id:202600)在医学和遥感领域的变革性影响，并直面构建不仅准确，而且鲁棒、可泛化且值得信赖的模型的先进机器学习挑战。

## 原理与机制

### 什么是纹理？漫步于模式之地

环顾四周。你桌上的木纹，椅子上的织物编织，天空中云朵的波纹图案。所有这些事物都拥有一种我们直观地称之为**纹理**的特质。这是一种结构感、重复感、变化感。它关乎的不是一个物体的整体颜色或亮度，而是其色调和阴影的空间排布。我们如何教会计算机“看见”这种特质呢？

在图像世界中，纹理是像素强度的空间组织。单个像素告诉我们的信息很少；纹理的魔力在于一个像素与其邻居之间的关系。对于物理学家或统计学家来说，图像不仅仅是一幅画，而是一个**[随机场](@entry_id:177952)**的实现，一个巨大的网格，其中每个点的值都是一个随机变量。理解纹理的关键在于认识到这些随机变量并非相互独立。

想象一下一台没有信号的老式电视机，只显示“雪花”或静电。这是一个**白噪声**场的良好近似。每个像素的强度都是完全出人意料的；它与其邻居没有任何相关性。如果我们计算一个像素值与其邻居值之间的关系，我们会发现没有任何关系。更正式地说，其**[自协方差](@entry_id:270483)**函数 $C(\tau_x, \tau_y)$——用于衡量由空间滞后 $(\tau_x, \tau_y)$ 分隔的像素之间的协方差——对于任何非零滞后都为零。所有的统计“活动”都集中在原点 $(\tau_x, \tau_y)=(0,0)$，这仅代表像素本身的方差。

现在，将其与一堵砖墙的图像进行对比。如果你知道一个像素是红色砖块的一部分，你就可以相当肯定它的近邻也是同一块红色砖块的一部分。这里存在着强烈的局部相关性。这种“记忆”或空间依赖性是纹理的本质。对于有纹理的图像，[自协方差](@entry_id:270483) $C(\tau_x, \tau_y)$ 在一定范围的滞后内是非零的。该函数随着滞后增加而衰减的方式告诉我们纹理的特征尺度。一个缓慢衰减的函数表明这是一个粗糙、大尺度的模式，而一个快速衰减的函数则表明这是一个精细、密集的纹理。某些纹理，如重复的壁纸图案，甚至可能具有振荡的[自协方差函数](@entry_id:262114) [@problem_id:4612969]。

### 透过不同视角看纹理：频域

还有另一种极其优雅的方式来思考模式。Jean-Baptiste Joseph Fourier 的伟大洞见在于，任何复杂的信号都可以被描述为不同频率的简单、纯粹的正弦和余弦波的总和。图像也是如此。我们可以将复杂的纹理分解为不同尺度和方向的简单波浪模式的组合。这就是**傅里叶变换**的世界，它将我们从空间域（$x$ 和 $y$ 坐标的图像）带到频域。

频域告诉我们关于纹理的什么信息呢？一个名为**[维纳-辛钦定理](@entry_id:188017)**的卓越结果提供了桥梁：图像的[功率谱密度](@entry_id:141002)，或称**[功率谱](@entry_id:159996)**，就是其[自协方差函数](@entry_id:262114)的傅里叶变换 [@problem_id:4612969]。[功率谱](@entry_id:159996) $S(u,v)$ 告诉我们，在每个[空间频率](@entry_id:270500) $(u,v)$ 处，图像中存在多少“能量”或变化。

让我们以一个自动化纺织品质控系统的实际例子来说明 [@problem_id:1729766]。想象一下一块具有强烈垂直纹理的织物图像，比如灯芯绒。当你水平穿过织物（穿过灯芯绒的条纹）时，强度值会发生变化，但当你垂直移动（沿着条纹）时，强度值几乎保持不变。它的功率谱会是什么样子？由于所有的变化都在水平（$x$）方向，频域中的能量将集中在水平频率轴（$u$轴）上。[频谱](@entry_id:276824)中某个特定 $u$ 值的尖峰将对应于条纹的特征间距。

现在，考虑另一种具有**各向同性**纹理的织物，比如简单的亚麻织品，它在所有方向上看起来都一样。它没有优选方向。它的功率谱会反映这种对称性。能量会像投入平静池塘的石子产生的涟漪一样，在原点周围的同心圆中分布。不会有特定的集中轴。这种双重视角——将纹理视为[空间相关性](@entry_id:203497)或频域中的能量分布——是我们工具库中的一个强大工具。

### 如何计数模式：手工特征的艺术

虽然[自协方差函数](@entry_id:262114)和[功率谱](@entry_id:159996)是优美的理论构造，但我们通常需要将一个区域的纹理浓缩为少数几个描述性数字，即**特征**，以供[机器学习模型](@entry_id:262335)使用。这就是创造**手工特征**的艺术。

最简单的方法是完全忽略空间信息，只看感兴趣区域内像素强度的分布。这些是**一阶统计量**，源自**强度[直方图](@entry_id:178776)**。平均强度告诉我们平均亮度，方差告诉我们整体对比度，而偏度和[峰度](@entry_id:269963)描述了强度分布的形状。在医学成像中，对于像CT这样经过校准的扫描仪，肿瘤的平均强度可能直接与其物理密度相关，这是一个具有物理解释的量 [@problem_id:4538119]。

但纹理的真正本质在于空间关系，这需要**二阶**或**[高阶统计量](@entry_id:193349)**。其中最著名的是**灰度共生矩阵 (GLCM)**。这个想法简单而强大。想象一下，你是一只微小的蚂蚁，在一张已被简化为只有几个灰度级的灰度图像上行走。GLCM 是一张记分表。对于给定的偏移量，比如说“向右一步”，每当你从灰度级为 $i$ 的像素走到灰度级为 $j$ 的像素时，你就在记分表的相应方框中做一个标记 [@problem_id:4532526]。

在遍历整个区域后，这张计数矩阵在归一化后，会告诉你以该特定空间偏移观察到任何一对灰度级的概率。一个平滑、均匀的区域，其GLCM条目将大部分聚集在主对角线（$i=j$）上。一个混乱、高对比度的区域，其条目将远离对角线分布。从这个单一的矩阵中，我们可以计算出大量的特征：

*   **对比度**：该特征对强度差异大的像素对（远离GLCM对角线的条目）赋予更高的权重。它衡量纹理的“局部锯齿状程度”。
*   **能量**（或角二阶矩）：这是GLCM中概率的平方和。当纹理非常有序和重复，只有少数几种像素对占主导地位时，该值会很高。
*   **[同质性](@entry_id:636502)**（或逆差矩）：该特征与对比度相反，对相似的像素对赋予更高的权重。高[同质性](@entry_id:636502)表示纹理更平滑。

GLCM仅仅是个开始。存在着一整个特征家族的“动物园”，每个家族都旨在捕捉纹理的不同方面。**灰度游程长度矩阵 (GLRLM)** 特征测量具有相同强度的连续像素“游程”的长度，捕捉“条纹性”。**灰度区域大小矩阵 (GLSZM)** 特征量化相同强度的连通“区域”的大小，捕捉“斑块性”或区域[同质性](@entry_id:636502)。**邻域灰度差分矩阵 (NGTDM)** 特征通过将每个像素与其局部邻域的平均值进行比较来捕捉纹理的“粗糙度” [@problem_id:4538119]。虽然这些高阶特征提供了丰富的模式描述，但它们的值通常不像密度或温度那样能映射回单一、直接的物理意义；它们是图像模式本身的统计描述符。

### 物理学家的困境：测量并非现实

提取这些特征似乎是一项直接的计算任务。但在这里，我们遇到了一个来自物理学的深刻教训：测量是一种相互作用，测量的行为会影响结果。图像不是一个完美的数学对象；它是一个物理测量，受制于噪声、硬件的怪癖以及采集的具体参数。

**噪声问题**：每个成像系统都有噪声。在**[计算机断层扫描 (CT)](@entry_id:747639)**中，噪声源于光子探测的量子统计。在短时间间隔内到达探测器的光子数量遵循泊松分布。在高光子计数（更高的辐射剂量）下，这种噪声的行为非常像[高斯噪声](@entry_id:260752)，其方差与剂量成反比。在**[磁共振成像 (MRI)](@entry_id:139464)**中，噪声来自患者身体和扫描仪电子设备的[热波](@entry_id:167489)动。在复数值的原始数据中，这种噪声是[高斯噪声](@entry_id:260752)。然而，我们通常处理的是[幅度图](@entry_id:272555)像，其中噪声遵循**莱斯分布**。在低**[信噪比 (SNR)](@entry_id:271861)**下，这种莱斯噪声不仅使图像看起来有颗粒感；它还会引入一个正向偏差，使暗区看起来比应有的更亮。对于任何成像模态，低[信噪比](@entry_id:271196)都会降低我们特征的可靠性，使它们在重复扫描中的[可复现性](@entry_id:151299)变差 [@problem_id:4531324]。

**不可比性问题**：想象一下在两台不同的MRI扫描仪上对同一个人进行扫描。即使解剖结构完全相同，生成的图像也可能看起来惊人地不同。这是因为MRI信号强度不像千克或米那样是绝对的物理单位。给定组织的信号非线性地依赖于其内在特性（$T_1$、$T_2$[弛豫时间](@entry_id:191572)）和一系列扫描仪特定参数（$TR$、$TE$、翻转角）。更糟糕的是，信号被任意的供应商缩放因子和由接收线圈的灵敏度分布引起的空间变化的**偏置场**所乘。线圈中心的体素会比边缘的相同体素显得更亮 [@problem_id:4550111]。这就是为什么严格的**预处理**不仅仅是可选的“图像清理”；它是测量过程的一个基本部分。我们必须进行**偏置场校正**以去除缓慢的强度漂移，并应用**强度归一化**来尝试将不同的图像置于一个共同的强度尺度上。

**尺度问题**：假设我们想分析大约 $3$ 毫米大小的纹理模式。如果一台[CT扫描](@entry_id:747639)仪生成 $0.5$ 毫米像素的图像，而另一台使用 $1.5$ 毫米像素，我们不能简单地在两者上分析一个固定大小的像素邻域（例如，$5 \times 5$ 像素）。这将对应于在第一台扫描仪上分析一个 $2.5$ 毫米的区域，而在第二台扫描仪上分析一个 $7.5$ 毫米的区域！为了进行有物理意义的比较，我们的分析必须调整到相同的物理尺度。这是**尺度空间理论**的领域。一种有原则的方法是使用**高斯拉普拉斯 (LoG) 滤波器**对图像进行预滤波。该滤波器的高斯部分平滑图像，其标准差 $\sigma$ 可以在物理单位（例如，毫米）中设置，以定义分析的尺度。然后，拉普拉斯部分增强大小与 $\sigma$ 相关的斑点状结构。通过应用具有相同物理尺度 $\sigma$ 的滤波器（根据每个扫描仪的分辨率将其转换为适当的像素数），我们可以提取反映在一致物理尺寸下的纹理的特征，使它们对采集差异更具鲁棒性 [@problem_id:5221685]。

### 确保信任：鲁棒性与标准化

即使在与图像采集物理学搏斗之后，我们对可靠纹理特征的追求也尚未结束。我们必须在我们的测量中建立信任。

首先，特征必须是**鲁棒的**。一个主要的变异来源是初始分割，即手动或自动勾勒出感兴趣的区域（例如，肿瘤）。如果边界的绘制仅有一个像素的差异会怎样？一个脆弱的特征可能会使其值发生巨大变化，而一个鲁棒的特征将相对稳定。我们可以通过测量在对掩模应用一像素**膨胀**（扩大边界）和**侵蚀**（缩小边界）后特征值的百分比变化来量化这一点 [@problem_id:4612967]。对这些微小扰动高度敏感的特征不那么值得信赖。

其次，在汇集来自多家医院数据的大型研究中，我们面临着**[批次效应](@entry_id:265859)**的挑战。由扫描仪制造商、重建软件或采集方案引起的系统性差异，可能会在特征分布中产生非生物学上的变异。如果一家医院恰好治疗病情更重的患者，并且也使用了不同供应商的扫描仪，那么[批次效应](@entry_id:265859)可能会在纹理特征和临床结果之间造成[伪相关](@entry_id:755254) [@problem_id:5221639]。这种混杂效应必须通过统计协调技术仔细处理。

最后，面对数十个特征家族及其定义的细微差别，研究人员如何确保他们都在说同一种语言？一个软件包计算的“GLCM对比度”可能与另一个软件包的不同。这就是标准化变得至关重要的地方。**图像生物标志物标准化倡议 (IBSI)** 的成立旨在建立科学共识，为数百个影像组学特征提供精确、无[歧义](@entry_id:276744)的数学定义和参考值 [@problem_id:4567855]。遵守IBSI标准就像同意使用公制单位一样。它极大地减少了特征值中由实现引入的方差（$\sigma^2_{\mathrm{impl}}$），确保测量之间的差异反映的是真实的生物学，而不是软件的怪癖。这种对透明度和[可复现性](@entry_id:151299)的承诺是良好科学的基石，并得到了像**影像组学质量评分 (RQS)**这样的框架的认可。

从对模式的直观欣赏，到测量的复杂物理学，再到标准化的共同努力，量化图像纹理的旅程是科学过程本身的一个缩影：一个在复杂而嘈杂的世界中寻找鲁棒、有意义信号的持续努力。

