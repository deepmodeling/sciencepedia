## 应用与跨学科联系

在理解了零膨胀负二项 (ZINB) 模型的机制之后，我们现在可以踏上一段旅程，看看它在实践中的应用。你可能会惊讶地发现，这个模型的故事并不仅限于统计理论的尘封角落。相反，它是一个强大的镜头，我们可以通过它来观察和解决从在线商务、分子生物学到生态学等截然不同领域中的难题。我们学到的原理揭示了我们在思考包含“过多零值”的数据时，方式上存在着一种美妙的统一性。

### 缺失的剖析：从网站浏览者到基因

让我们不从实验室开始，而是从一个更为熟悉的地方：一个在线商店。一家电子商务公司的数据科学家想要了解顾客的购买行为。他们收集了每位访客购买商品数量的数据。一个奇怪的模式出现了：大量的访客什么也没买。这个比例远超于如果每个人都是潜在买家，只是碰巧选择了零件商品时所预期的数量。

这是怎么回事？常识告诉我们，访问网站的人有两种。一种是“潜在买家”，他们有购买的意图；另一种是“浏览者”，他们只是四处看看，没有任何购买意图。浏览者*总是*会购买零件商品。这是一个**结构性零值**。另一方面，潜在买家*可能*会购买零件商品（也许他们没找到想要的），或者他们可能购买一件、两件或更多。来自这个群体的零是一个**抽样零值**。

要对此建模，像泊松或负二项分布这样的简单[分布](@entry_id:182848)是不够的。它只描述了“潜在买家”群体的行为。然而，ZINB 模型非常适合这项工作。它是一个[混合模型](@entry_id:266571)，认为访客有一定概率 $\pi$ 属于“浏览者”群体，导致一个确定的零；或者有 $1-\pi$ 的概率属于“潜在买家”群体，他们的购买数量遵循[负二项分布](@entry_id:262151)。这种优雅的结构使数据科学家能够分别估计浏览人群的规模和购买人群的购买习惯，从而得出更准确的预测和商业洞见[@problem_id:1321173]。

现在，让我们从在线购物的世界进入一个活细胞的内部宇宙。在现代生物学中，我们拥有单细胞 RNA 测序 ([scRNA-seq](@entry_id:155798)) 等革命性技术，使我们能够计算单个细胞内每个基因的信使 RNA (mRNA) 分子的数量。这为我们提供了前所未有的关于细胞身份和功能的视角。但这些数据带来了一个与我们的电子商务问题非常相似的挑战：我们观察到大量的零。

对于细胞中的任何一个给定基因，零计数可能由两个原因产生。首先，基因可能确实是“关闭”的，没有作为细胞生物学程序的一部分进行表达。这是一个生物学零值，类似于潜在买家的抽样零值。其次，基因可能在低水平表达，但我们的测量技术未能捕获其任何 mRNA 分子。这种技术失败被称为 **dropout**。它是一个结构性零值，与只浏览的访客完全类似。

ZINB 模型已成为单细胞生物学的基石，正是因为它提供了一种有原则的方法来处理零的双重性质[@problem_id:2417833]。通过拟合 ZINB 模型，我们可以估计 dropout 概率 $\pi$ 和负二项分量的基础表达水平 $\mu$。这使我们能够提出深刻的问题，例如：鉴于我们观察到一个基因的计数为零，它由技术性 dropout 引起的[后验概率](@entry_id:153467)与由真实生物学沉默引起的后验概率分别是多少？回答这个问题是清除数据噪声以更清晰地观察生物学现象的第一步。同样的原理也从 RNA 扩展到其他单细胞测量，比如分析染色质景观以了解基因组的哪些部分是活跃的[@problem_id:2938945]。

### 超越拟合：利用模型获得更深洞见

一个好模型的真正力量不仅在于它描述数据的能力，还在于它能促成更深入的分析和发现。在单细胞生物学中，一个主要目标是创建所有细胞的“地图”，将相似的细胞分组到不同的簇中（例如，T 细胞、B 细胞、神经元），并理解它们之间的关系。这通常是通过计算每对细胞之间的“距离”并找到近邻来完成的。

一种简单的方法可能是对原始计数进行转换（例如，使用对数），然后使用像主成分分析 (PCA) 这样的标准方法。但这就像试图用一张不知道道路封闭信息的地图在城市中导航一样。技术性 dropout 是单细胞数据的“道路封闭”；它们在实际上生物学相似的细胞之间制造了虚假的差异。

这就是 ZINB 模型成为构建更好地图的工具的地方。我们可以使用 ZINB 模型为每个细胞中的每个基因计算“残差”，而不是使用原始或粗略转换的计数。残差告诉我们，在模型预期的基础上，一个观测值有多么令人意外。关键的洞见是，在 ZINB 模型下，观察到的零被认为比在简单的负[二项模型](@entry_id:275034)下*更不令人意外*，因为 ZINB 模型“知道”零可能纯粹出于技术原因而发生[@problem_id:3356224]。通过在这个模型感知的残差空间中计算细胞间的距离，我们有效地降低了技术性零值的贡献。由此产生的[细胞图谱](@entry_id:270083)受技术噪声的扭曲更小，使得真实的生物学结构——比如稀有免疫细胞亚群之间的分离——能够更清晰地显现出来[@problem_id:2888901] [@problem_id:3356224] [@problem_id:2888901]。

这个思想是生物学领域先进[深度学习](@entry_id:142022)方法（如[变分自编码器](@entry_id:177996) VAEs）的核心。这些模型学习每个细胞的低维表示。VAE 的“解码器”部分是一个[生成模型](@entry_id:177561)，试图从这个[潜变量](@entry_id:143771)表示中重构原始数据。选择[重构损失](@entry_id:636740)函数至关重要。使用简单的均方误差等同于假设数据是高斯分布的，这与离散的、[过度离散](@entry_id:263748)的计数数据不匹配。相反，通过使用 ZINB 对数似然作为[重构损失](@entry_id:636740)，VAE 被迫学习一个尊[重数](@entry_id:136466)据真实统计性质的表示，包括其零膨胀和均值-[方差](@entry_id:200758)关系[@problem_id:2439817]。

此外，ZINB 框架并非静态的；它是一个灵活的[广义线性模型 (GLM)](@entry_id:749787)。这意味着我们可以建模参数 $\pi$ 和 $\mu$ 如何依赖于其他已知因素。例如，基因组学中的一个主要问题是校正“[批次效应](@entry_id:265859)”，即在不同日期进行的实验所产生的技术差异可能会掩盖真实的生物学现象。通过在我们的 ZINB 模型中包含批次协变量，我们可以同时估计和校正批次对平均基因表达和 dropout 率的影响，从而能够在不同实验之间对细胞进行更清晰的比较[@problem_id:1418452]。

### 跨越自然尺度的统一原则

科学的一个显著特点是，同一个数学思想可以阐明在截然不同尺度上的模式。我们已经看到 ZINB 模型描述了单个细胞内的现象。现在，让我们放大到整个生态系统的尺度。

研究[物种分布](@entry_id:271956)的生态学家面临着一个熟悉的问题。当他们调查一个景观时，他们在许多不同的地点计算一个物种的个体数量。他们经常发现该物种在许多地点都不存在。就像我们其他的例子一样，这种缺失可能意味着两件事。物种可能存在，但调查团队未能检测到它（抽样零值）。或者，该地点可能从根本上就是不适宜的栖息地——缺乏合适的食物、气候或庇护所——物种根本无法在那里生存（结构性零值）。

通过将 ZINB [分布](@entry_id:182848)纳入[物种丰度](@entry_id:178953)的分层模型中，生态学家可以区分因栖息地不适宜而导致的真实缺失与未检测到的情况。这使得他们能更准确地理解一个物种的生态位以及支配其在景观中[分布](@entry_id:182848)的因素[@problem_id:2816090]。生态学中的“不适宜的栖息地”与[基因组学](@entry_id:138123)中的“技术性 dropout”以及电子商务中的“浏览顾客”是完美的类比。

这个统一的框架不仅限于静态快照。在为[生物时间序列](@entry_id:746825)建模时——比如神经元的放电或生理测量的变化——我们经常使用像[循环神经网络](@entry_id:171248) (RNNs) 这样的强大序列模型。构建这样一个模型时的一个关键选择是观测[似然](@entry_id:167119)——即 RNN 输出所参数化的[统计分布](@entry_id:182030)。通过检查数据的属性（均值、[方差](@entry_id:200758)、零的比例），我们可以做出有原则的选择。对于连续数据，[高斯分布](@entry_id:154414)可能就足够了。对于[过度离散](@entry_id:263748)的计数，[负二项分布](@entry_id:262151)是一个好的开始。但是，当我们遇到具有严重[过度离散](@entry_id:263748)且零比例甚至连 NB 模型都无法解释的数据时，ZINB 模型就成为正确捕捉动态的必要工具[@problem_id:3344958]。

### 从模型到发现：检验一个进化假说

我们以最后一个例子结束，这个例子展示了这种精细建模的最终目的：回答基本的科学问题。考虑一对由远古祖先的基因复制事件产生的基因。这两个基因是如何演化的？一种可能性是“[亚功能化](@entry_id:276878)”，即两个拷贝将祖先的功能分配开来。例如，如果祖先基因在三种细胞类型中表达，一个后代基因现在可能只在细胞类型 1 中表达，而另一个则在细胞类型 2 和 3 中表达。它们在不同细胞类型中的表达模式将是互补的。

我们如何使用 scRNA-seq 数据来检验这个假说？一个查看原始计数的简单方法将不可避免地被技术噪声所混淆。但是我们可以利用我们的 ZINB 框架从第一性原理出发构建一个解决方案。

策略如下：首先，我们为每个基因拟合一个复杂的 ZINB 模型，其中包含细胞类型和文库大小的[协变](@entry_id:634097)量。这使我们能够为每个基因和每种细胞类型估计潜在的*生物学活性*概率，这是一个已经清除了技术性 dropout 影响的量。其次，有了这些可靠的概率，我们可以设计一个自定义的统计量来衡量这两个基因在不同细胞类型中表达谱的互补性。如果表达谱相同，该统计量将接近 0；如果它们是完全互补的（互斥的），则为 1。最后，我们可以使用像[参数化](@entry_id:272587)自举这样的统计程序来确定观察到的互补性水平是否显著高于在两个基因具有相同表达模式的偶然情况下所预期的水平。

这套完整的流程——从原始的、充满噪声的数据集到对进化假说的严格统计检验——之所以成为可能，是因为 ZINB 模型能够将信号与噪声分离。它代表了一个优秀[统计模型](@entry_id:165873)所能达到的顶峰：它透过数据的迷雾提供了一个清晰的窗口，让我们能够提出——并回答——关于自然世界运作的深刻问题[@problem_id:2712822]。