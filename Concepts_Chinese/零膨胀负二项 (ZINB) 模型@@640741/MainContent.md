## 引言
在探求理解复杂系统（从细胞内部运作到人类行为）的过程中，我们依赖统计模型来解读数据。对于由计数组成的数据——例如基因表达水平、物种种群数量或购买的商品数量——简单的模型往往力不从心。现代生物学数据，特别是来自单细胞 RNA 测序的数据，提出了双重挑战：计数的[方差](@entry_id:200758)通常远大于其平均值（[过度离散](@entry_id:263748)），并且数据中包含惊人数量的零值。这些问题使得传统模型不够用，从而在我们区分真实生物信号与[测量噪声](@entry_id:275238)的能力上造成了关键的空白。

本文全面概述了零膨胀负二项 (ZINB) 模型，这是一个为解决这些问题而设计的强大统计工具。通过以下章节，您将对其理论基础和实际效用有一个清晰的理解。“原理与机制”一章将解构该模型，从基本的[泊松分布](@entry_id:147769)开始，逐步构建到 ZINB 模型，解释每个组成部分如何解决特定的统计挑战。随后，“应用与跨学科联系”一章将展示该模型的多功能性，演示如何使用相同的核心原理来解决单细胞生物学、电子商务、生态学等领域的问题，最终促成更深层次的科学发现。

## 原理与机制

为了理解世界，我们构建模型。不是用木头和金属丝制作的物理模型，而是用数学和概率构建的概念模型。这些模型是我们窥探自然复杂机器的镜头。在单细胞生物学的世界里，我们测量成千上万个单细胞中成千上万个基因的活性，我们的数据是数字的洪流——具体来说，是计数。零膨胀负二项 (ZINB) 模型的故事，就是一段打造合适镜头来理解这些计数的旅程，一段从天真简单到更丰富、更细致入微的真理的旅程。

### 计数的世界及其不均匀性

让我们从最简单的起点开始。想象一下你在计算随机事件——落在人行道一方块上的雨滴，或者一小时内总机接到的电话。如果这些事件是独立的，并以一个恒定的平均速率发生，那么任何给定区间内的事件数量都遵循一个优美而简单的定律：**泊松分布**。泊松世界的一个关键特征，几乎可以说是它的标志，就是[方差](@entry_id:200758)（一种[离散程度的度量](@entry_id:178320)）等于均值（平均值）。如果你预期有 5 滴雨，你的计数的[方差](@entry_id:200758)也将是 5。

很长一段时间里，生物学家试图将这个优雅的模型应用于基因表达计数。但很快就清楚了，生物学并没有那么整洁。当我们观察一群看似相同的细胞中单个基因的表达时，我们发现[方差](@entry_id:200758)几乎总是远大于均值。这种现象被称为**[过度离散](@entry_id:263748)**。就好像有些细胞处于转录狂热状态，而另一些则近乎休眠。基因表达的平均“速率”在细胞之间并非恒定。简单的泊松镜头太过僵硬；它无法捕捉生命中块状的、异质性的本质。[@problem_id:3301621]

### 用负二项分布驯服噪声

为了处理[过度离散](@entry_id:263748)，我们需要一个更灵活的模型。于是**负二项 (NB) [分布](@entry_id:182848)**登场了。NB 模型的美妙之处不仅在于其数学形式，还在于它讲述的关于[生物噪声](@entry_id:269503)来源的优雅故事。它源于一个称为**伽马-泊松混合**的概念。

想象一下，每个细胞对于一个基因都有其内在的“表达速率”，我们可以称之为 $\lambda$。在泊松世界里，我们假设 $\lambda$ 对每个细胞都是相同的。NB 世界做出了一个更现实的假设：$\lambda$ 本身就是一个[随机变量](@entry_id:195330)，每个细胞都不同，它从一个由伽马[分布](@entry_id:182848)描述的可能性景观中抽取。我们实际在一个细胞中观察到的计数，是在该细胞特定速率 $\lambda$ 下进行的泊松抽样。当我们退后一步，观察整个细胞群体中的计数[分布](@entry_id:182848)时，我们实际上是在对所有这些不同的泊松过程进行平均。这种混合的结果不是[泊松分布](@entry_id:147769)，而是负二项分布。[@problem_id:3301621] [@problem_id:3349866]

这为[过度离散](@entry_id:263748)提供了一个绝佳的机理解释：它是细胞间异质性的自然结果。NB [分布](@entry_id:182848)有两个关键参数：反映群体平均表达水平的均值 $\mu$，以及一个**[离散度](@entry_id:168823)参数** $\theta$。这个参数 $\theta$ 是我们把握生物学“不均匀性”的把手。一个非常大的 $\theta$ 意味着低[离散度](@entry_id:168823)，此时所有细胞行为相似，NB [分布](@entry_id:182848)会优雅地简化回[泊松分布](@entry_id:147769)。然而，一个小的 $\theta$ 则意味着高离散度——剧烈的、细胞间的变异性，这是“脉冲式”基因转录的标志。[@problem_id:2424240]

### 空盒之谜

NB [分布](@entry_id:182848)是一个巨大的飞跃。它为我们提供了一个强大的工具来模拟生物学固有的噪声。但是，当单细胞技术的革命到来时，一个新的谜题出现了。在单细胞 RNA 测序 (scRNA-seq) 中，我们经常观察到惊人数量的零。对于许多基因来说，大多数细胞记录的计数都是零。即使是我们灵活的 NB 模型，也常常无法预测如此大量的空值。这种“过多”的零，被称为**零膨胀**，表明我们的故事仍不完整。

为了解开这个谜题，我们必须认识到，数据中的“零”可能并不意味着我们所想的那样。事实上，有两种截然不同的方式可以得到零计数：

-   **生物学零值（稀疏性）：** 这是一个真实的零。在给定的细胞中，于测量瞬间，该基因处于转录沉默状态。工厂关闭了。NB 模型可以很好地解释这些零；如果一个基因的平均表达量（$\mu$）非常低，或者其表达是高度脉冲式的（$\theta$ 很小），我们自然会预期看到许多零。这是一个真实的生物学信号。[@problem_id:3316073]

-   **技术性零值（Dropout）：** 这是一种假象。基因实际上在表达，细胞中也存在 mRNA 分子，但我们的测量过程未能检测到它们。分子可能在文库制备过程中丢失，或者未能扩增。这是一种技术故障，是我们仪器的盲点。就像一张有坏点的照片——黑点是由于相机造成的，而不是场景本身。[@problem_id:2424240] [@problem_id:3349834]

### 具有双重身份的模型：ZINB

我们如何构建一个承认零值双重身份的模型？我们创建一个**混合模型**，一个为每个细胞讲述两个可能故事的模型。这就是零膨胀负二项 (ZINB) 模型巧妙的核心。对于每个细胞中的每个基因，该模型上演一出两幕剧。

**第一幕：Dropout 硬币。** 首先，模型抛掷一枚隐喻性的硬币。以概率 $\pi$，硬币落在“Dropout”一面。如果是这样，故事就结束了。我们简单地记录一个零，不再追问。这就是我们的技术性零值。[@problem_id:3316073]

**第二幕：生物学过程。** 如果硬币没有落在“Dropout”上（这以 $1-\pi$ 的概率发生），我们进入第二幕。在这里，我们从我们可靠的负二项分布中生成一个计数，该[分布](@entry_id:182848)忠实地代表了潜在的生物学过程。这个生成的计数可能是正数，也可能恰好是一个生物学零值。[@problem_id:3301621]

ZINB 模型优雅地将这两个叙事编织在一起。观察到零的总概率是这两条不同路径概率的总和：技术性 dropout 的机会，*加上*一个非 dropout 事件最终产生生物学零值的机会。这就给了我们 ZINB 模型中零概率的著名公式：

$P(Y=0) = \pi + (1-\pi) \times P_{NB}(Y=0)$

其中 $P_{NB}(Y=0)$ 是仅从 NB 部分得到零的概率。[@problem_id:3301267] [@problem_id:3301621] 这引入了我们第三个关键参数 $\pi$，即**零膨胀概率**。现在我们的工具包完整了：$\mu$ 捕捉“活跃”细胞中的平均表达水平，$\theta$ 量化生物学变异性，而 $\pi$ 则解释了技术失败率。

### 区分现实与假象

这个由两部分组成的故事虽然优雅，但却提出了一个深刻的问题：如果一个零可以来自两个不同的来源，我们怎么可能将它们区分开来？是否有可能将 dropout 率 $\pi$ 与生物学参数 $\mu$ 和 $\theta$ 分开估计？这就是所谓的**可识别性问题**。

幸运的是，答案是肯定的，这要归功于一段优美的统计逻辑。关键在于不同的参数有不同的任务。dropout 参数 $\pi$ 只影响零与非零的比例。然而，NB 参数 $\mu$ 和 $\theta$ 决定了*正*计数的整个[分布](@entry_id:182848)*形状*——看到 1、2、3 等的相对频率。通过仔细检查正数据的景观，我们可以首先了解潜在生物学过程（NB 部分）的特征。然后，我们可以计算这个生物学过程本身应该产生多少个零。如果我们数据中实际观察到的零的数量显著更高，这个“多余”的部分就可以归因于技术性 dropout，并由此估计出 $\pi$。[@problem_id:3321433]

我们甚至可以设计巧妙的实验来证实这一点。一种强大的技术是在我们的单细胞样本中加入已知数量的人工 RNA 分子，称为 **ERCC spike-ins**。由于这些分子并非细胞内源性的，我们观察到的任何关于它们的零计数*必须*是技术性 dropout。它们充当了地面实况，使我们能够直接测量技术失败率，并验证我们的 ZINB 模型是否正确地捕捉了这一过程。[@problem_id:3349834]

### 为工作选择合适的工具

一个优秀的科学家知道，最复杂的工具未必是最好的。ZINB 模型功能强大，但并非总是必要。在科学中，我们必须始终为复杂性提供正当理由。

例如，如果我们碰巧分析一个**离散不足**（[方差](@entry_id:200758)小于均值）且没有零值的数据集，尝试拟合 ZINB 模型是毫无意义的。像 Akaike [信息准则](@entry_id:636495) (AIC) 这样的统计原理会因为 ZINB 模型不必要的复杂性而对其进行重罚，并会正确地偏向一个更简单的模型，甚至可能是朴素的泊松模型。[@problem_id:2851188]

更重要的是，即使在稀疏的单细胞数据中，一个简单的 NB 模型也常常足够。如果一个基因的表达量非常低（低 $\mu$）或者其表达极具脉冲性（低 $\theta$），NB 模型本身就可以预测出非常高比例的零，而无需任何额外的“膨胀”成分。[@problem_id:3349866] 在采用 ZINB 模型之前，人们应始终询问更简单的 NB 模型是否足够好。我们可以使用正式的统计程序，如**[似然比检验](@entry_id:268070)**，来判断数据是否为那个额外的 dropout 参数 $\pi$ 的存在提供了强有力的证据。[@problem_id:3349834]

### 关于近亲模型：跨栏模型的说明

为了完善我们的理解，了解 ZINB 的一个近亲模型——**跨栏模型 (hurdle model)** 是有益的。这个模型也使用一个由两部分组成的故事。第一部分是一个二元问题：基因是否表达？如果答案是“否”，我们记录一个零。如果是“是”，我们进入第二部分，从一个仅包含正值的[分布](@entry_id:182848)（特别是零截断 NB [分布](@entry_id:182848)，它不能产生零）中抽取一个计数。[@problem_id:2410274]

关键区别在于零的来源。在跨栏模型中，只有一种方式得到零：基因必须未能越过表达的初始“跨栏”。在 ZINB 模型中，则有两种方式：技术性 dropout 或生物学上的“关闭”状态。这种双路径结构使得 ZINB 模型在概念上对于单细胞数据如此强大，因为我们有充分的理由相信这两种现象都在起作用。[@problem_id:3301267] 两者之间的选择，是关于我们相信什么在生成数据的选择，这是[统计建模](@entry_id:272466)如何成为我们的假设与数据现实之间对话的一个完美例子。

