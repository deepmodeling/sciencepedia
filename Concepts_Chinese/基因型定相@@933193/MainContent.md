## 引言
尽管现代遗传学使我们能够以惊人的精度读取我们的DNA，但它提供的信息往往并不完整。我们每个人都遗传了两套基因组，分别来自父母双方，但标准的基因检测只是给出了一个混合列表，列出了两者之间的遗传差异。这留下了一个关键问题悬而未决：哪些变异是在同一条染色体上被共同遗传的？这种模糊性并非单纯的学术细节；它可能掩盖疾病的遗传基础，并限制[个性化医疗](@entry_id:152668)的效力。为解决这一难题而设计的过程称为基因型定相，这是一套强大的技术，可以重建我们两条不同的亲本遗传故事，即单倍型。本文将深入探讨基因型定相的世界。接下来的章节将首先探讨核心的“原理与机制”，详细说明为何定相如此关键，以及为实现它而开发的精妙科学方法。随后，我们将审视“应用与跨学科联系”，揭示这一基本概念如何彻底改变从临床诊断到[癌症基因组学](@entry_id:143632)等多个领域。

## 原理与机制

我们的基因组常被描述为“生命之书”，是一套构建人体的完整指令。但这个比喻虽然有力，却隐藏了一个美妙的精微之处。我们并非只有一本生命之书，而是有两本。对于我们的22对非性染色体，我们从母亲那里继承一个完整副本，从父亲那里继承另一个。这两个副本极为相似，但并非完全相同。它们点缀着微小的差异——称为**变异**的单字母变化——这些差异使我们每个人都独一无二。

想象一下，你有两套巨大的百科全书，分别来自你的父母。标准的基因检测就像派一位勤奋但略带困惑的图书管理员去比较它们。这位图书管理员回来时带着一份清单：“在第1045页，一本书上写着‘color’，另一本写着‘colour’。在第8932页，一本写着‘analyze’，另一本写着‘analyse’。”这份在特定位点上的差异列表被称为你的**基因型**。对于一个给定的变异，如果你有一个参考等位基因（我们称之为`0`）和一个备选等位基因（`1`），你的基因型就是杂合的。在遗传学家使用的标准[变异调用格式](@entry_id:756453)（VCF）中，这被写作 $0/1$。斜杠`/`是我们无知的象征；它告诉我们每种等位基因各有一个，但我们不知道哪个变异在哪本书里。

沿着这些染色体之一的完整、有序的变异序列——即单个亲本的副本——被称为**单倍型**。确定哪些变异共同属于同一条染色体的巨大挑战被称为**基因型定相**。当我们成功时，我们可以用一个明确的竖线`|`取代模糊的斜杠`/`。一个经过定相的基因型，写作 $0|1$，讲述了一个更清晰的故事：`0`等位基因在第一条染色体上，而`1`在第二条上 [@problem_id:4554246]。因此，定相就是将一个简单的差异列表转化为两个完整、连贯的叙事——你所继承的两个故事——的艺术。

### 事关生死的定相重要性

你可能会想，这是否只是为了遗传学的整洁而进行的一项工作。事实并非如此。两个变异位于同一条染色体上与位于不同染色体上之间的区别，可能就是健康与毁灭性疾病之间的区别。

在**常染色体隐性遗传病**的背景下，这一点变得至关重要。对于这类疾病，只有当一个人特定基因的两个拷贝都无功能时，他才会生病。让我们回到百科全书的比喻。想象一个基因是一份至关重要的配方，比如说，用于制造一种清除脑细胞废物的蛋白质。一个[致病性变异](@entry_id:177247)就像一个关键的印刷错误，毁掉了这个配方。如果你从父母双方都继承了这份充满印刷错误的配方，那么你对该变异就是纯合的，结果很明确：你无法制造这种蛋白质。

但如果你是一个**复合杂合子**呢？这意味着你在同一个基因中有两个*不同*的致病性变异，$v_1$ 和 $v_2$ [@problem_id:5053443]。现在，一切都取决于它们的[连锁相](@entry_id:201938)。

如果变异 $v_1$ 和 $v_2$ 都在同一条染色体上——这种构型被称为**顺式 (cis)**——那么那个配方副本就被双重破坏了。然而，从另一位亲本遗传的另一条染色体是完全正常的。它包含一个可用的配方，你的细胞仍然可以产生必需的蛋白质。你是一个健康的携带者。

但如果这些变异位于相对的染色体上——即**反式 (trans)**——情况就严峻了。来自一位亲本的配方被 $v_1$ 破坏，而来自另一位亲本的配方被 $v_2$ 破坏。现在，*两个*基因拷贝都无功能了。你无法产生这种蛋白质。这是一种双等位基因[功能丧失](@entry_id:273810)的状态，它会导致疾病。

没有定相，临床医生看到一个基因中有两个变异的患者，无法区分健康携带者和受影响的个体。其影响超出了诊断，延伸到医学的前沿。想象一下，试图使用像CRISPR这样的基因编辑工具来修复其中一个变异。如果变异是反式的，仅修复其中一条染色体上的一个变异，就会创造一个功能完整的基因拷贝，从而可能治愈疾病。这是一个可行的策略，但只有在你了解[连锁相](@entry_id:201938)的情况下才能设计它 [@problem_id:5041252]。

那么，我们如何进行这项关键的侦探工作呢？科学已经设计出三种优美而强大的策略：研究家系、研究群体，以及直接研究分子本身。

### 方法一：家系关系的精妙之处

解决遗传之谜最直接、最可靠的方法是追溯源头：父母。这种方法，被称为**孟德尔定相**或基于家系的定相，是简单而无可辩驳的逻辑之美的应用。

考虑一个三口之家：母亲、父亲和他们的孩子。假设我们对父亲的两个连锁变异感兴趣。他是一个双杂合子：在第一个位点他的基因型是 $A/a$，在第二个位点是 $B/b$。他的单倍型可能是 $A-B$ 和 $a-b$（顺式或[连锁相](@entry_id:201938)），也可能是 $A-b$ 和 $a-B$（反式或[互斥](@entry_id:752349)相）。到底是哪一种呢？

仅凭他自己的基因组，这是不明确的。但现在让我们看看母亲。假设她在两个位点上都是纯合的：$a/a$ 和 $b/b$。这意味着，根据[孟德尔分离定律](@entry_id:149761)，她产生的任何卵细胞都必须携带单倍型 $a-b$。她没有其他等位基因可以传递。

最后，我们看孩子，他的基因型是 $A/a$ 和 $B/b$。既然我们确定孩子从母亲那里得到了一个 $a-b$ 单倍型，那么剩余的等位基因——$A$ 和 $B$——必定来自父亲。而且由于这些等位基因是在一个精子细胞中一起传下来的，它们必定共同存在于父亲的一条染色体上。父方配子是 $A-B$。

通过这一简单的推断，谜题就解决了。父亲传递了一个 $A-B$ 单倍型。因此，他的另一个单倍型必须由他没有传递的等位基因组成：$a-b$。他的[连锁相](@entry_id:201938)被明确确定为 $A-B / a-b$ [@problem_id:5069950]。这种利用信息丰富的亲本基因型——即一位亲本是杂合的，另一位是纯合的——的方法提供了一个确定性的答案。

这种方法有一个独特的超能力：它不仅能解析单倍型，还能同时实现**亲源分配**。我们不仅知道孩子有一个 $A-B$ 和一个 $a-b$ 单倍型；我们还知道 $A-B$ 是父源的，而 $a-b$ 是母源的。因此，基于三口之家的定相是临床遗传学的金标准，提供了最高的可信度和最完整的遗传图景 [@problem_id:5091061]。

### 方法二：群体的智慧

如果我们无法获取亲本的DNA（这种情况很常见），该怎么办？我们就束手无策了吗？在很长一段时间里，答案基本上是肯定的。但随着大规模基因组学的出现，我们发现可以通过咨询“群体的智慧”——即整个群体的集体遗传历史——来解决这个难题。这种方法被称为**统计定相**。

其背后的关键原理是**连锁不平衡（LD）**。这听起来很拗口，但概念很直观。当一个新突变出现时，它发生在一个特定的染色体上，周围有一组特定的预先存在的变异。这个共同遗传的变异块就是一个单倍型块。经过许多代，一个称为[减数分裂重组](@entry_id:155590)的过程像洗牌一样搅乱我们的染色体，打断这些块。然而，重组是一个[随机过程](@entry_id:268487)。对于染色体上物理位置彼此靠近的变异，在任何一代中它们之间发生重组事件的几率都很低。因此，这些邻近的等位基因倾向于在许多代中共同遗传，其频率远高于随机预期的水平。它们处于“不平衡”状态。

统计定相算法利用了这一事实。它们使用一个**参考面板**——一个包含数千个来自某个群体（如1000基因组计划或单倍型参考联盟）的高质量、已定相单倍型的庞大数据库。然后，个体的单倍型被建模为一个由该参考面板中常见的单倍型块拼接而成的马赛克或拼布被 [@problem_id:4352579]。

一种流行且强大的实现方式是使用**[隐马尔可夫模型](@entry_id:141989)（HMM）**。想象一下算法沿着个体的染色体对“行走”。在每个[遗传标记](@entry_id:202466)处，其隐藏状态是一个猜测：“我认为1号染色体目前是参考单倍型#534的拷贝，而2号染色体是参考单倍型#2119的拷贝。”然后，算法查看个体的实际基因型数据。如果数据与单倍型#534和#2119上的等位基因一致，模型就会感到满意。这是**发射概率**。接着，它移动到下一个标记。它可以继续使用相同的参考单倍型，也可以“跳”到新的单倍型。跳跃的概率是**转移概率**，它由重组率决定——下一个标记越远，历史上发生重组事件的可能性就越大，跳跃的可能性也就越大 [@problem_id:5042951]。通过在整个基因组中找到最可能的隐藏状态路径，该算法为个体重建了最可能的一对单倍型。

这种方法很巧妙，但它本质上是概率性的。其准确性取决于一个区域[连锁不平衡](@entry_id:146203)的强度（可以用 $D = p_{AB} - p_A p_B$ 和 $r^2 = D^2 / (p_A p_a p_B p_b)$ 等指[标量化](@entry_id:634761) [@problem_id:5016478]），以及至关重要的是，参考面板与个体祖源的匹配程度。它最大的弱点在于**稀有变异**。根据定义，这些变异在群体中不常见，因此在参考面板中的代表性很差，甚至根本没有。根本没有足够的“群体智慧”来可靠地推断它们的[连锁相](@entry_id:201938) [@problem_id:5053443]。此外，这种方法可以告诉你很可能拥有单倍型H1和H2，但它无法知道哪个来自你的母亲，哪个来自你的父亲 [@problem_id:5091061]。

### 方法三：恰到好处的暴力破解

几十年来，家系研究和统计推断是定相的主要支柱。但近年来，出现了第三种方法，一种由技术革命驱动、具有优美的直接性和力量的方法。如果我们不是推断故事，而是能直接阅读它呢？

传统的“二代”测序技术通过将基因组切成数十亿个小片段并读取这些短片段（通常为150-300个碱基长）来工作。这就像通过把百科全书撕成五彩纸屑，然后试图重新拼凑文本来阅读它。如果两个变异相隔数千个碱基，任何单个纸屑都无法同时跨越它们。你知道这些变异存在，但你没有将它们联系起来的物理证据 [@problem_id:5016478]。

**[长读长测序](@entry_id:268696)**应运而生。像单分子实时（SMRT）测序这样的技术可以读取长达数万甚至数十万个碱基的连续DNA片段。它们从*单个、完整的DNA分子*中读取信息。

定相的逻辑变得异常简单。如果一个源自单条染色体的长读长同时包含变异 $v_1$ 和 $v_2$，那么它们必定是**顺式**的。不存在任何[歧义](@entry_id:276744)。如果在测序了许多分子后，我们发现一些读长带有 $v_1$，另一些带有 $v_2$，但从未有单个读长同时带有两者，那么它们必定是**反式**的 [@problem_id:5053443]。这就是**基于测序读长的定相**。它不是推断；它是一种直接的物理测量。如果一个读长覆盖了至少两个杂合位点，它就被认为是“定相信息丰富的”，因为它在这些位点之间建立了物理联系 [@problem_id:4382914]。

这种方法完全绕过了统计定相的局限性。它不依赖于群体数据或祖源。它对最稀有的变异和对常见变异一样强大。对于一个涉及两个相距7500个碱基的稀有变异的潜在复合杂合性临床病例，统计定相将是一场赌博。但对于中位长度为12000个碱基的[长读长测序](@entry_id:268696)，许多读长将轻松跨越两个位点，提供一个明确的、诊断性的答案 [@problem_id:5053443]。

这个优雅的生物学解决方案背后还有一个深刻的数学潜流。将所有测序读长划分为两个自洽的单倍型组的任务，可以被构建为图论中的一个著名问题。我们可以构建一个图，其中每个读长是一个点（一个顶点）。我们在任何两个冲突的读长之间画一条线（一条边）——即它们覆盖了相同的变异位点但显示了不同的等位基因。这条线我们画得越“重”，它们冲突的位点就越多。定相问题就等同于找到将这个图切成两部分的最佳方式，以最大化被切断的边的总权重。这被称为**[最大割](@entry_id:271899) (Max-Cut)** 问题，是计算机科学中的一个经典挑战，揭示了生物学、信息论和数学之间深刻的统一性 [@problem_id:2412155]。

从孟德尔定律的纯粹逻辑，到群体历史的统计力量，再到分子水平读取的暴力破解式优雅，基因型定相的科学提供了一套极其巧妙的工具包。通过拼凑我们两个亲本的故事，我们解锁了对个人生物学的更深层次理解，从我们的疾病风险到写在我们DNA中的祖先的古老旅程。

