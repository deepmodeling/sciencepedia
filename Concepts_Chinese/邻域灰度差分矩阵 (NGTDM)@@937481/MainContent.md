## 引言
以数值方式描述图像纹理——即其色调的空间排列——是图像分析领域的一项根本性挑战。像直方图这样的简单统计工具无法捕捉这些关键的空间关系，使其无法区分精细、繁忙的图案和粗糙、平滑的图案。这一局限性造成了知识鸿沟，尤其是在[医学影像](@entry_id:269649)等领域，因为组织纹理可以揭示潜在的病理状况。为解决此问题，我们不仅要问一个像素的数值是多少，更要问它的数值与其邻域像素的关系如何。

本文将介绍邻域灰度差分矩阵 (NGTDM)，这是一种为回答上述问题而设计的优雅而强大的方法。在接下来的章节中，我们首先将深入探讨其“原理与机制”，探索 NGTDM 是如何基于局部差异构建的，以及其特征如何转化为如粗糙度和复杂度这类直观概念。随后，“应用与跨学科联系”一章将展示 NGTDM 如何作为一种变革性工具在放射组学中应用，为疾病研究提供新见解，并将医学影像世界与[网络理论](@entry_id:150028)的普适原理联系起来。

## 原理与机制

想象一下，你正在看一张照片。你可以轻易地描述它的整体亮度或主色调。但它的纹理呢？是平静湖面光滑如镜的表面，是古树粗糙混乱的树皮，还是织物精细规整的图案？这种特性——明暗色调的空间排列——就是我们所说的**纹理**。这是一个我们的眼睛和大脑能瞬间领会的概念，但用数字来描述它却出奇地具有挑战性。

我们如何教会计算机识别纹理？这是图像分析中最引人入胜的问题之一，其答案将我们带出简单统计学的范畴，深入空间关系的核心。

### 超越直方图：纹理的问题

描述图像数值的初次尝试可能是创建一个**[直方图](@entry_id:178776)**。我们可以简单地计算从纯黑到纯白每种灰度下的像素数量。这能告诉我们图像的整体色调构成，但完全无法说明这些色调是如何排列的。

思考两张简单的图像 [@problem_id:4566002]。图像 A 是一个完美的黑白方格棋盘。图像 B 沿垂直方向分割，左半部分为纯黑，右半部分为纯白。如果两张图像拥有相同数量的黑色和白色像素，它们的直方图将完全相同。然而，在我们的眼中，它们截然不同。棋盘格是“繁忙”且“精细”的，而分割图像则是“平滑”且“粗糙”的。[直方图](@entry_id:178776)由于忽略了空间位置，对纹理是“视而不见”的。

要捕捉纹理，我们必须提出一个不同的问题：不只是“一个像素的数值是多少？”，而是“一个像素的数值*与其邻域像素的关系*是怎样的？”

### 像素及其邻域：一个简单想法的诞生

这就引出了**邻域灰度差分矩阵 (NGTDM)** 核心的美妙而简单的思想。让我们看看棋盘格中的一个像素。如果它是白色的，它所有的直接邻居都是黑色的。如果它是黑色的，它所有的邻居都是白色的。该像素总是与其局部环境形成巨大反差。现在再看我们分割图像中黑色区域深处的一个像素。它的所有邻居也都是黑色的。它完美地融入了背景。

我们可以量化这一点。对于任何给定的像素，我们可以计算其邻域的平均灰度级。让我们在该像素周围定义一个小邻域，比如说，以它为中心的 $3 \times 3$ 像素方框（但不包括该像素本身）。这八个邻居的平均灰度级给了我们一种对局部“氛围”的感知。然后，我们只需取该像素自身的灰度级与这个邻域平均值之间的绝对差。我们可以称之为**局部差异**。

$$
\text{局部差异} = | \text{像素自身灰度级} - \text{其邻域的平均灰度级} |
$$

对于棋盘格中的一个像素，这个差异会很大。对于均匀黑色区域中的一个像素，这个差异将为零。我们找到了一个能够开始捕捉图像中单点“繁忙度”的数字。

### 从局部差异到全局画像：构建 NGTDM

现在我们有了图像中每个像素的局部差异值。为了进行总结，我们不能简单地将它们全部平均——那样会丢失太多信息。相反，NGTDM 执行了一种巧妙的分组操作 [@problem_id:4565919]。

假设我们的图像已被量化为 $G$ 个可能的灰度级，从 $1$ 到 $G$。NGTDM 方法会逐一处理每个灰度级。

1.  首先，它找到图像中所有灰度级为 $i$ 的像素。假设有 $n_i$ 个这样的像素。
2.  对于这 $n_i$ 个像素中的每一个，它计算其局部差异 $|i - \bar{I}_k|$，其中 $\bar{I}_k$ 是该特定像素 $k$ 的邻域平均值。
3.  然后，它将该组像素的所有这些局部差异相加。这个总和被称为 $s_i$。
    $$
    s_i = \sum_{\text{所有灰度级为 } i \text{ 的像素 } k} |i - \bar{I}_k|
    $$

在对从 $i=1$ 到 $G$ 的每个灰度级都完成此操作后，我们得到了一组值：计数 $\{n_1, n_2, \dots, n_G\}$ 和差异总和 $\{s_1, s_2, \dots, s_G\}$。这些数字的集合*就是* NGTDM。尽管名为矩阵，但它并非传统意义上的单个矩阵，而是对图像局部色调变化的强大总结，按灰度级进行组织。

### 解读画像：粗糙度、复杂度与纹理的“感觉”

这个总结告诉了我们什么？通过以不同方式组合 $n_i$ 和 $s_i$ 值，我们可以推导出与我们对纹理的直观感知相对应的特征。

一个关键特征是**粗糙度 (Coarseness)**。粗糙度的计算公式被构造成与局部差异成反比 [@problem_id:4565868]。这乍一看可能有些反直觉，但逻辑是合理的。当局部差异非常小（像素与其邻域融为一体）时，纹理在视觉上是平滑和均匀的，就像一个抛光的表面。NGTDM 算法称之为“粗糙”纹理，意为“粗粒度”或由大块均匀的斑块构成。当局部差异很大（像素很突出）时，纹理是繁忙且快速变化的，就像砂纸一样。这被称为“精细”纹理。

这不仅仅是一个抽象的定义。例如，在[医学影像](@entry_id:269649)中，CT 扫描中健康、同质的肝脏组织区域将表现出较小的局部差异，因此具有*高*的**粗糙度**值。而一个病变的、带有散布血管和肿瘤的斑驳区域将具有较大的局部差异和*低*的**粗糙度**值，这对应于其精细、异质的结构 [@problem_id:4565868]。

另一个强大的特征是**复杂度 (Complexity)**。一个纹理如果具备两个特征，则被认为是复杂的：拥有包含许多不同灰度级的丰富色调，以及在它们之间存在巨大且快速变化的局部差异。想象一个熙熙攘攘的市场场景。它之所以复杂，是因为各种颜色和形状都杂乱地混合在一起。相比之下，平静的沙漠景观是简单的。NGTDM 复杂度特征被设计为对于具有许多高局部偏差灰度级的纹理（例如具有多种混合组织类型的异质性肿瘤）值较高，而对于更均匀的区域值较低 [@problem_id:4565948]。

### 视角问题：方向性与各向同性的力量

NGTDM 只是衡量纹理的众多方法之一。为了理解其独特性，将其与另一种著名的方法——**灰度[共生](@entry_id:142479)矩阵 (GLCM)** 进行比较会很有帮助 [@problem_id:4558053]。

GLCM 的工作原理是计算像素对。它会问：“灰度级为 $i$ 的像素出现在灰度级为 $j$ 的像素旁边的频率是多少？”但它必须被赋予一个特定的空间关系，例如，“右侧一个像素”。这使得 GLCM 具有内在的**方向性**。如果你为一个具有强烈水平边缘的图像计算 GLCM，那么根据你是在寻找垂直像素对还是水平像素对，结果会大不相同 [@problem_id:4565915]。如果你旋转图像，GLCM（对于一个固定的方向，如“向右”）将完全改变，因为曾经的水平关系现在变成了垂直关系 [@problem_id:4565916]。

相比之下，NGTDM 通常使用对称或**各向同性**的邻域来定义，例如 2D 中的 $3 \times 3$ 方块或 3D 中的 $3 \times 3 \times 3$ 立方体。通过对这个对称区域内的所有邻居进行平均，它失去了任何优先方向感。它衡量的是像素周围的整体“繁忙度”。如果你旋转一个图像，用各向同性邻域计算的 NGTDM 将保持不变 [@problem_id:4565916]。

这两种方法没有“优劣”之分——它们只是衡量不同的事物。GLCM 非常适合检测有方向性的纹理，比如木材的纹理。而 NGTDM 则擅长表征纹理的整体平滑度或繁忙度，无论其方向如何。

### 科学家的技艺：现实世界的挑战与关于尺度的说明

像任何强大的工具一样，使用 NGTDM 必须具备技巧并意识到其局限性。优美的数学抽象与[数据采集](@entry_id:273490)的混乱现实在此相遇。

首先，**邻域的尺度至关重要**。你选择的邻域半径 $r$——无论是 1 个像素、2 个像素还是更多——定义了你测量纹理的物理尺度。小半径测量的是非常精细的局部纹理，而大半径测量的则是更广泛的区域纹理。选择正确的尺度是科学过程中的关键部分 [@problem_id:4565868]。

其次，**体素并不总是完美的立方体**。在 3D [医学影像](@entry_id:269649)中，一个体素可能代表一个物理空间，例如，$0.5 \text{ mm} \times 0.5 \text{ mm} \times 3.0 \text{ mm}$。这是一个**各向异性**的体素。如果我们将邻域定义为一个 $3 \times 3 \times 3$ 的体素立方体，我们实际上分析的是一个高度拉长的物理空间。这引入了深刻的偏倚。解决方法是在分析前，首先将图像**[重采样](@entry_id:142583)**到一个各向同性体素（完美的立方体）的网格上，以确保我们的测量工具不会失真 [@problem_id:4536954] [@problem_id:4565871]。

第三，**图像必须被量化**。NGTDM 在一组离散的灰度级上操作，但物理测量（如 CT 扫描中的亨斯菲尔德单位）是连续的。将连续值转换为固定数量的区间，即**量化**，是一个至关重要的步骤。为了使科学结果在不同扫描仪和研究之间具有可重复性，这种[分箱](@entry_id:264748)策略必须标准化。一种稳健的方法是定义具有固定物理单位宽度的分箱，确保相同的物理组织对比度转化为相同的灰度级差异，而不管扫描仪的具体设置如何 [@problem_id:4613030]。

最后，我们必须考虑**我们世界的边缘**。位于我们分析区域最边界的像素怎么办？它们没有完整的邻居集合。为了避免引入数学伪影，标准方法是简单地将这些边界像素从 NGTDM 计算中排除 [@problem_id:4612949]。

这些实际考虑并没有削弱 NGTDM 的优雅。相反，它们凸显了定义所有科学探究的理论概念与实验现实之间的相互作用。从一个关于像素如何与其邻居相关的简单、直观的问题出发，我们构建了一个复杂的工具，它可以表征世界上错综复杂的纹理，从一张树皮的照片到人体内疾病的微妙迹象。

