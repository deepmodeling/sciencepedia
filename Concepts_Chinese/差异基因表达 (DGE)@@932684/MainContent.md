## 引言
每个活细胞都基于一个动态的遗传程序运作，选择性地读取其 DNA 来生产蛋白质。在任何特定时刻，细胞内活跃的基因“蓝图”（mRNA）集合，即转录组，为我们提供了细胞状态和功能的快照。生物学中的一个基本问题是，这种活动如何响应疾病、药物或环境变化等刺激而改变。要回答这个问题，就需要一种稳健的方法来识别哪些基因被上调或下调，而这正是[差异基因表达](@entry_id:140753) (DGE) 分析的核心任务。

本文对 DGE 进行了全面的概述。第一章“原理与机制”将揭示核心的统计学概念，从标准化和生物学重复的必要性，到负[二项模型](@entry_id:275034)在处理生物学噪声方面的强大能力。随后的“应用与跨学科联系”一章将展示 DGE 如何作为一个强大的透镜，被用于识别疾病通路、绘制细胞类型图谱，并与其他数据整合，以建立对生命系统层面的理解。通过探索这些统计学基础和实际应用，读者将深刻领会我们如何将原始的基因计数转化为有意义的生物学故事。

## 原理与机制

### 核心问题：解读生命秘方

从本质上讲，活细胞是一个动态的、自我调节的奇迹。它通过执行精确的遗传程序来响应环境、与邻近细胞交流并执行其指定功能。这个程序写在它的 DNA 中，但并非一次性全部读取。相反，细胞将特定的[基因转录](@entry_id:155521)成临时的信息——称为**信使 RNA (mRNA)** 的分子——然后这些分子作为蓝图，用于构建细胞的“主力军”——蛋白质。在特定时刻，所有这些 mRNA 信息的集合就是细胞的**[转录组](@entry_id:274025)**，它为我们提供了一张快照，展示了遗传秘方中的哪些部分正在被积极使用。

我们通常想问的基本问题是：当条件改变时，细胞的活动如何改变？如果我们将癌细胞暴露于新药，或将寄生虫置于免疫反应中，它会开启或关闭哪些基因来应对？回答这个问题就是**[差异基因表达](@entry_id:140753) (DGE)** 分析的目标。我们取两组或多组样本——比如来自处理组和未处理组——测量它们的[转录组](@entry_id:274025)，并试图找出那些活性水平发生显著变化的基因。这就像是当一名侦探，窃听细胞的内部对话，以弄清其策略。

### 计数分子的实际挑战

我们进行这种“窃听”的主要工具是 **RNA 测序 ([RNA-seq](@entry_id:140811))**。本质上，我们捕获一个样本中的所有 mRNA，将其打碎成数百万个微小片段，读取每个片段的序列，然后，就像拼凑一份被撕碎的文件一样，使用计算机将这些读数（reads）比对回它们来源的基因。最终的输出是一个巨大的计数表格：对于每个基因，在每个样本中，我们看到了多少个片段？

但这种简单的计数想法立即遇到了实际的挑战。首先，细胞中的 RNA 不仅仅是 mRNA。事实上，细胞中绝大多数的 RNA——通常超过 80%——是**核糖体 RNA (rRNA)**，它们是细胞蛋白质构建机器的结构组分。如果我们对总 RNA 进行测序，大部分资源将用于计算这些无处不在的分子，而对动态的 mRNA 信息知之甚少。这就像对一个城市的阅读习惯进行调查，结果发现 80% 的印刷品都是电话簿。为了获得有意义的数据，我们必须首先进行 **rRNA 去除**，这一步骤旨在特异性地移除这些分子，从而富集我们关心的 mRNA。如果某些样本的这一步骤失败，将产生灾难性后果：大量的测序能力被转移，导致我们获得的 mRNA 有效数据减少。这可能会造成一种误导性的假象，即基因普遍下调，而这仅仅是因为 mRNA 信号被淹没了 [@problem_id:2385512]。

第二个挑战是，我们从测序仪上获得的总读数，通常称为**文库大小**，可能因纯粹的技术原因而在样本间有所不同。一个样本可能产生 5000 万个读数，而另一个则产生 1 亿个。将第一个样本中某个基因的 200 个原始计数与第二个样本中的 400 个计数进行比较是毫无意义的；这种差异很可能仅仅是由于测序深度更深。我们不能直接比较绝对计数；我们必须找到一种方法使比较变得公平。这就是**标准化**的任务。

### 同类比较：标准化的精妙艺术

那么，我们如何调整这些文库大小的差异呢？一个朴素的方法可能是简单地将每个基因的计数除以其所在样本的总读数，得到一个比例（通常表示为每百万计数值，即 CPM）。这看起来很合理，但它隐藏着一个微妙而危险的缺陷。想象一个场景，我们的处理导致少数几个丰度极高的基因变得*更加*丰富。这少数几个基因可能突然占据了总读数的更大部分。由于总比例之和必须为一，这将迫使所有其他未改变基因的比例*下降*，从而造成一种普遍的、看似下调的假象。总计数并不是一个稳定的参考点。

现代 DGE 方法采用了一种更聪明、更稳健的策略。它基于一个简单而强大的假设：*大多数基因都不是[差异表达](@entry_id:748396)的*。在这个假设下，我们可以找到一个样本特异性的缩放因子，或称**规格因子 (size factor)**，使得这些稳定的、不变的基因的计数在所有样本中对齐。实现这一目标的一个优雅方法是“比率中位数”法 [@problem_id:4774893]。对于每个基因，我们计算它与一个伪参考（该基因在所有样本中表达量的[几何平均数](@entry_id:275527)）的比率。对于一个不变的基因，这个比率应该其所在样本真实规格因子的一个带有噪声的估计。对于一个真正差异表达的基因，这个比率将是一个异常值。通过取一个给定样本中所有这些比率的*[中位数](@entry_id:264877)*，我们得到了该样本规格因子的估计值，这个估计值以沉默的大多数基因为锚点，并且对少数异常值的影响具有稳健性。[中位数](@entry_id:264877)是一个稳健的统计量——它可以容忍高达 50% 的数据是异常值而不会偏离轨道。

区分*比较同一基因在不同样本间的表达*（DGE 的目标）和*比较不同基因在单一样本内的表达*也至关重要。对于 DGE，由于一个基因的长度在所有样本中都是相同的，它在计算[倍数变化](@entry_id:272598)时作为一个常数被抵消了。因此，我们可以直接使用原始计数和我们精心计算的规格因子。然而，如果我们想问基因 X 是否比基因 Y 在*同一样本内*更丰富，我们必须考虑到一个更长的基因自然会产生更多的片段。这就是像**[每百万转录本](@entry_id:170576)的计数值 ([TPM](@entry_id:170576))** 这类指标发挥作用的地方，它们同时对文库大小和基因长度进行标准化。但这些指标通过将每个样本的值强制转化为一种组成形式（例如，总和为一百万），扭曲了底层的计数数据，使其不适用于 DGE 所使用的复杂[统计模型](@entry_id:755400) [@problem_id:4556293]。寻找差异表达基因的信条很明确：对原始计数进行建模。

### 从噪声中提取信号：拥抱生物学变异

一旦我们有了标准化的计数，我们可能会倾向于将任何在组间平均计数不同的基因都声明为“差异表达”。但这忽略了任何生物学实验中最有趣、最重要的变异来源：生命本身。没有两个个体是完全相同的。即使是在实验室中培养的两瓶遗传上完全相同的细胞，它们的基因表达模式也会表现出自然的、随机的波动。这就是**生物学变异性**。

这引出了实验设计的一个关键原则：**生物学重复**的绝对必要性。假设我们想测试一种药物的效果。如果我们只对一个处理样本和一个对照样本进行测序，我们看到的任何差异都将是无可救药地混淆的。这是药物引起的吗？还是那个特定的对照个体本身就与处理个体存在天然差异？我们无从知晓。这是一个生物学样本量为 $n=1$ 的实验，从中无法得出任何可推广的结论 [@problem_id:2385533] [@problem_id:2385514]。

为了做出有效的统计推断，我们必须测量每个组*内部*的生物学变异，这样我们才能判断组*之间*的差异是否具有显著性。这要求每个条件都有多个独立的生物学重复（例如，三个独立的药物处理培养物和三个独立的对照培养物）。这与**技术重复**不同，后者涉及对一个生物样本进行多次测序。技术重复可以告诉你测序机器的噪声，但它们无法告诉你对于假设检验至关重要的生物学变异 [@problem_id:2336621]。一个每个条件只有一个生物样本，每个样本又被分成三个技术重复的实验，是**[伪重复](@entry_id:176246)**的一个例子——它造成了样本量增大的假象，但其真实的生物学样本量仍然是 $n=1$，这使得正式的统计检验无效。

### 生命彩票的模型：[负二项分布](@entry_id:262151)

那么，我们如何正式地为这些既包含抽样噪声又包含生物学变异的计数建模呢？最简单的计数数据模型是泊松分布。然而，泊松分布的一个关键特性是其均值等于其方差。在真实的 RNA-seq 数据中，我们几乎普遍观察到**[过度离散](@entry_id:263748)**：方差大于均值。这种额外的方差就来自于我们刚才讨论的生物学变异性。

这就是**负二项 (NB) 分布**发挥作用的地方。NB 分布可以被看作是泊松分布的一个“增强版”。它有两个参数：一个均值 $\mu$ 和一个**离散参数** $\alpha$。它的方差由一个简单而优美的关系式给出：
$$ \operatorname{Var}(Y) = \mu + \alpha \mu^2 $$
当 $\alpha = 0$ 时，方差等于均值，NB 分布退化为泊松分布。但当 $\alpha > 0$ 时，方差随均值呈二次方增长，这种模式与真实的生物学计数数据非常吻合。离散参数 $\alpha$ 是我们用来数学上把握每个基因生物学“噪声”程度的工具 [@problem_id:4805867]。

估计这个离散参数本身就是一个挑战，因为我们通常只有很少的生物学重复（例如，每组三个）。从仅仅几个数据点来估计一个类似方差的参数是出了名的不可靠。解决方案再次显得巧妙而优美：我们**在基因间共享信息**。基于一个观察，即平均表达水平相似的基因往往具有相似的[离散度](@entry_id:168823)，各种方法可以拟合出一条[离散度](@entry_id:168823)相对于平均表达量的趋势线，这条趋势线贯穿了成千上万个基因。然后，对于每个单独的基因，其充满噪声的原始[离散度](@entry_id:168823)估计值会被“收缩”到这条稳定的趋势线上。这种[经验贝叶斯方法](@entry_id:169803)为我们提供了更稳健、更可靠的[离散度](@entry_id:168823)估计，这是进行准确统计检验的基石。

### 超越“或多或少”：[基因调控](@entry_id:143507)的丰富画卷

我们建立的这个框架——使用来自重复实验的标准化计数来拟合负[二项模型](@entry_id:275034)——非常强大。但[基因调控](@entry_id:143507)的故事远比这更丰富。标准的 DGE 分析将每个基因视为一个单一的单位，要么“开”要么“关”，要么“上调”要么“下调”。但生物学更加微妙。

许多基因可以经历**[可变剪接](@entry_id:142813)**，这是一个过程，其中单个基因的初始转录本可以以不同的方式被剪切和粘贴，从而产生多种不同的 mRNA **亚型**。这些亚型又可以被翻译成具有不同结构和功能的蛋白质。这开辟了一个全新的调控维度。细胞可能不是通过改变基因的总产量来应对刺激，而是通过改变它产生的亚型的*比例*。这被称为**差异转录本使用 (DTU)**。

想象一个基因，其总表达水平在两种条件下保持完全恒定。标准的 DGE 分析将一无所获。然而，在表面之下，可能正在发生一个完全的“亚型转换”，即在条件 A 中的主要亚型被条件 B 中的另一种亚型所取代。这可能会产生巨大的功能性后果，例如蛋白质失去一个与药物结合所必需的结构域，从而产生耐药性 [@problem_id:4333094]。这凸显了需要进行能够识别亚型的分析，以捕捉完整的图景。

我们甚至可以考虑空间因素，从而进一步拓宽我们的视野。在组织中，细胞不仅仅是一盘散沙；它们被组织成复杂的结构。一个基因的表达可能不是均匀的，而是可能形成特定的模式或梯度。这就引出了**空间可变 (SV) 基因**的概念 [@problem_id:4354056]。如果一个基因在组织中邻近位置的表达水平比在远处位置更相似，那么它就被认为是空间可变的。这与[差异表达](@entry_id:748396)是一个根本不同的概念。一个基因在健康组织和患病组织中的平均表达可能完全相同，但在患病组织中，其空间模式可能从弥散状变为形成独特的病理集群。检测这一点需要一套完全不同的统计工具，它不再是比较均值，而是分析**空间协方差**。

从计算分子到为生物学噪声建模，再到欣赏剪接和空间组织的微妙之处，[差异表达分析](@entry_id:266370)的原理揭示了生物学、技术和统计推理之间美妙的相互作用。这是一段破译基因组动态语言的旅程，这段旅程持续不断地揭示着生命复杂性中更深层次的奥秘。

