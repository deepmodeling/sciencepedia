## 应用与跨学科联系

既然我们已经摆弄了我们[随机游走](@article_id:303058)的机器，让我们看看它能做什么。我们已经构建了一个非常通用的工具，用于在我们的无知图景中导航。这段旅程[能带](@article_id:306995)我们去哪里？事实证明，从后验分布中抽取样本的能力不仅仅是一种计算技巧；它是一种在不确定性下进行推理的通用语言，与科学发现的最深层原理有着深刻的联系。

我们之前提到的与[统计力](@article_id:373880)学的类比，不仅仅是一种诗意的便利。它是一种深刻的、形式上的对应关系。当我们从[后验分布](@article_id:306029) $\pi(\mathbf{x})$ 中采样时，我们可以想象我们正在观察一个物理系统探索其可能的构型。后验概率 $\pi(\mathbf{x})$ 就像一个玻尔兹曼分布，$\pi(\mathbf{x}) \propto \exp(-\beta U_{\mathrm{eff}}(\mathbf{x}))$，其中我们定义了一个*有效势能* $U_{\mathrm{eff}}(\mathbf{x}) = -\ln \pi(\mathbf{x})$（为简单起见，设 $\beta=1$）。我们的 MCMC [算法](@article_id:331821)是一种[随机动力学](@article_id:367007)——不一定是物理的，但在数学上是合理的——它驱动我们的参数系统达到“[热平衡](@article_id:318390)”。在平衡状态下，我们的采样器访问的状态忠实地代表了后验分布。这意味着，我们沿 MCMC 轨迹测量的任何量的长期平均值将等于后验上的真实“系综平均值”。因此，MCMC [算法](@article_id:331821)是我们模拟知识平衡状态的方式 [@problem_id:2462970]。有了这个强大的思想，让我们来探索它所开启的世界。

### 揭示生命密码中的隐藏结构

大自然充满了隐藏的信息。例如，一个生物体的基因组是一篇浩瀚的文本，其中[散布](@article_id:327616)着一些简短而关键的序列——称为模体（motif）——它们像开关一样控制基因的开启和关闭。寻找这些模体就像在不知道密码本身的情况下寻找一个秘密代码。我们有一组我们怀疑共享一个共同开关的 DNA 序列，但我们不知道这个开关长什么样，也不知道它在每个序列中的位置。

这是一个非常适合后验采样的问题。我们可以建立一个模型，其中包含用于每个序列中模体未知起始位置的潜在（隐藏）变量，以及用于模体本身未知序列模式的参数（例如，一个描述模体每个位置上看到每个 DNA 碱基概率的[位置权重矩阵](@article_id:310744)，或 PWM）。我们的[后验分布](@article_id:306029)涵盖了所有这些未知量：模体的位置和模体的模式。

一个 [Gibbs 采样器](@article_id:329375)非常适合这项任务 [@problem_id:2479895]。这个过程是一场优美的迭代之舞。想象一下，你对模体的样子有一个粗略的了解。然后，你可以扫描每个 DNA 序列，并计算模体在每个可能位置开始的概率。你使用这些概率对该序列中的位置做出一个随机猜测。现在，固定这些新位置，你查看所有你刚刚标记的 DNA 片段，并更新你对模体样貌的看法。有了这个精炼的模体图像，你再回去重新评估起始位置。

你一次又一次地重复这个循环：给定模式，采样位置；然后给定位置，采样模式。起初，你的猜测到处都是。但随着[算法](@article_id:331821)的运行，一个一致的故事开始浮现。采样器稳定在一个“热平衡”状态，此时采样的位置和推断的模体模式彼此之间以及与数据都和谐一致。通过收集这个“预烧期”之后的样本，我们不仅得到了关于模体序列的后验分布，还得到了它在任何给定序列的任何给定位置存在的概率——一个完全表达我们知识状态的完整解决方案。

### [贝叶斯奥卡姆剃刀](@article_id:375408)：在不同世界间选择

科学往往是相互竞争的解释之间的一场竞赛。[单分子反应动力学](@article_id:365741)最好由更简单的 Lindemann-Hinshelwood 模型描述，还是需要更复杂的 Troe 增宽模型？这两种理论似乎都能合理地拟合数据，那么我们该如何选择呢？

在这里，贝叶斯推断提供了一个极其优雅的原则：[贝叶斯奥卡姆剃刀](@article_id:375408)。它不仅为我们提供了*给定*模型的最可能参数；它还能告诉我们模型作为一个整体的合理性。这是通过计算*[边际似然](@article_id:370895)*或*[模型证据](@article_id:641149)*来完成的，即在给定模型的情况下观测到数据的概率，该概率是在所有可能的参数值上，按其先验概率[加权平均](@article_id:304268)得到的。

想象两个模型。模型 A 很简单，参数很少。模型 B 很复杂，参数很多。因为模型 B 有更多的参数，它有更大的“灵活性”，可以拟合更广泛的可能数据集。然而，这意味着它的先验概率更稀疏地分布在它广阔的参数空间上。如果观测到的数据可以被简单的模型 A 很好地解释，那么证据将支持它。复杂的模型 B 因其不必要的复杂性而受到惩罚；它只有在数据只能由模型 B 提供的额外机制来解释时才会获胜。

后验采样技术是这一过程的关键。虽然直接计算证据通常是难以处理的，但我们可以使用 MCMC 生成的后验样本来近似它（使用[热力学积分](@article_id:316728)或 Laplace 近似等方法）。例如，在分析动力学数据时，[贝叶斯分析](@article_id:335485)不仅可以揭示[速率系数](@article_id:362609)的[后验分布](@article_id:306029)，还可以提供一个[贝叶斯因子](@article_id:304000)——即证据的比率——它定量地告诉我们，在给定数据的情况下，我们应该在多大程度上更相信 Troe 模型而不是 Lindemann 模型 [@problem_id:2693164]。这提供了一种自动、有原则的方法来平衡[拟合优度](@article_id:355030)与模型复杂性，防止我们将理论“[过拟合](@article_id:299541)”到数据中的噪声。同样的原则也允许我们在从遗传数据构建[系统发育树](@article_id:300949)时比较不同的进化模型 [@problem_id:2483730]。

### 摇曳的[生命之树](@article_id:300140)：拥抱结构不确定性

有时，我们的不确定性不仅仅是关于几个数值参数，而是关于我们模型的整个结构。一个经典的例子来自进化生物学。当我们研究一组物种中两个性状——比如脑质量和代谢率——的协同进化时，我们必须考虑到[亲缘关系](@article_id:351626)较近的物种不是独立的数据点。它们共同的祖先必须用一个[系统发育树](@article_id:300949)来建模。

但真正的树是什么？生物学家可以从遗传数据中推断出合理的树，但总有不确定性。不同的数据集或推断方法可能会产生略有不同、具有不同分支模式或分支长度的树。简单地选择“最佳”树，然后像它是绝对真理一样进行我们的分析，将是忽略这种不确定性，并冒着得出脆弱结论的风险。

这正是后验采样大放异彩的地方。贝叶斯[系统发育分析](@article_id:323287)不只给出一棵树；它产生了一个包含数千棵合理树的[后验分布](@article_id:306029) [@problem_id:1940589]。然后，我们可以将我们的[协同进化](@article_id:362784)分析整合到这整片可能性的森林中。在实践中，这非常简单：我们从后验中随机抽取（比如说）1000 棵树。对于每一棵树，我们进行我们的分析（例如，计算系统发育独立对比之间的相关性）并记录结果。我们的最终结论不是基于单一的分析，而是基于所有 1000 次分析结果的分布。如果我们样本中 99% 的树都显示出显著的正相关，我们就可以对我们的结论非常有信心。如果只有 60% 的树显示出，我们可能仍然会得出存在关系的证据，但我们被迫诚实地承认，我们的结论在某种程度上对进化历史的细节敏感。通过从树的[后验分布](@article_id:306029)中采样，我们使我们的科学更加稳健，结论更加诚实。

### 预测的艺术与诚实的自我批判

科学中最重要的任务之一是对未来做出预测。对于渔业科学家来说，这可能意味着根据当前产卵种群的规模来预测明年鱼类种群的规模（即“补充量”）[@problem_id:2535833]。一个简单的模型可能会给出一个单一的数字，但这是一种危险的误导性虚构。我们的预测是不确定的，原因有二：我们不知道关联种群与补充量的生物学模型的*确切*参数（[参数不确定性](@article_id:328094)），而且即使我们知道了，自然界本身也是随机的（过程不确定性）。

后验采样提供了捕捉这两种不确定性的完美工具。我们首先运行一个 MCMC 来获得模型参数的联合[后验分布](@article_id:306029)。然后，为了生成一个单一的预测，我们执行一个两步模拟：
1.  从我们的后验样本中抽取一组参数。这考虑了[参数不确定性](@article_id:328094)。
2.  使用这组特定的参数，从模型的过程方程中模拟一个随机结果。这考虑了过程不确定性。

通过重复数千次，我们得到的不是一个单一的数字，而是明年补充量的完整*[后验预测分布](@article_id:347199)*。这个分布是我们对预期结果的诚实陈述，显示了所有合理结果的范围以及每种结果的概率。

但是我们怎么知道我们的模型一开始是否好用呢？在这里，同样的预测机制可以反过来用于模型本身，这个过程称为*后验预测检验* [@problem_id:2715843]。这个想法简单而强大：如果我们的模型是对现实的一个良好描述，那么从模型中模拟出的数据应该与我们实际观测到的真实数据相似。我们使用我们的后验样本生成数百个重复数据集。然后我们将这些“假”数据集与我们的真实数据集进行比较。它们有相同的均值吗？相同的方差吗？相同数量的零吗？如果真实数据看起来像是模拟数据云中的一个 plausibility 较低的离群点，这就是一个[危险信号](@article_id:374263)，表明我们的模型缺少了现实的某些关键方面。这是一种内置的“健全性检查”，迫使我们面对我们假设的缺点，是[科学建模](@article_id:323273)过程中至关重要的一部分。

### 前沿之旅

后验采样的力量延伸到科学和技术的最前沿，在那里，我们模型的图景变得真正奇特而宏伟。

考虑推断像磁性的 Ising 模型这样的系统的物理性质 [@problem_id:2376025]。在这里，我们可能面临一个“双重难解”的问题。[似然函数](@article_id:302368)——即给定像温度这样的参数下我们观测数据的概率——本身包含一个难以处理的[归一化常数](@article_id:323851)（[配分函数](@article_id:371907)，$Z$），更糟糕的是，这个常数还依赖于我们正试图推断的那个参数！标准的 MCMC 方法会失效。这就像试图在一个读数取决于一个随你体重变化的校准常数的秤上称重一样。解决方案是一种极具创造力的[算法](@article_id:331821)，称为伪边际 MCMC。它使用一个辅助模拟来产生一个有噪声但无偏的[似然比](@article_id:350037)估计，从而使难以处理的常数能够抵消掉。这使我们即使在这些看似不可能的图景上也能进行有原则的[随机游走](@article_id:303058)。

这种在广阔、复杂的参数空间[上采样](@article_id:339301)的思想，在现代机器学习中得到了极致的体现。一个深度神经网络可以有数百万甚至数十亿个权重。标准训练找到一组最佳权重。而一个*贝叶斯*神经网络则将每一个权重都视为一个具有不确定性的参数。网络的“[损失函数](@article_id:638865)”定义了一个极其高维的[势能面](@article_id:307856)。我们可以使用受物理学启发的 MCMC 方法，如 Langevin 动力学，来探索这个表面并从网络权重的[后验分布](@article_id:306029)中抽取样本 [@problem_id:2453049]。结果不是一个单一的网络，而是一个由 plausible 网络组成的完整系综。当我们要求这个系综进行预测时，它们答案的变化为我们提供了一个关于[模型不确定性](@article_id:329244)的有原则的度量——这对于科学或医学等应用至关重要，因为在这些领域，知道“我不知道”与给出正确答案同样重要。

最后，我们可以将从被动推断到[主动学习](@article_id:318217)的循环闭合。在合成生物学或药物发现等领域，我们希望找到最佳的分子或 DNA 序列来实现某个目标，但每次实验都很昂贵。[贝叶斯优化](@article_id:323401)提供了一个解决方案 [@problem_id:2749080]。我们根据已经完成的实验，建立一个关于适应度图景的概率[代理模型](@article_id:305860)（如高斯过程）。这个模型为我们尚未测试的任何候选设计的结果提供了一个[后验预测分布](@article_id:347199)。然后，我们使用一个*[获取函数](@article_id:348126)*——它基于这个后验构建——来决定下一步要执行哪个实验。一些函数，如[期望](@article_id:311378)提升（Expected Improvement），巧妙地平衡了利用已知的优良区域与探索不确定区域。最优雅的策略之一是 Thompson 采样：只需从你对世界的后验信念中随机抽取一个函数，然后测试对那个幻想世界来说最优的点。通过迭代这个过程，我们使用我们的[后验分布](@article_id:306029)来智能地引导我们的搜索，使发现效率大大提高。

从解码基因组到设计新生物，从在物理理论之间做出选择到确保人工智能了解其自身局限，从后验分布中采样的原则已成为一条统一的线索。它为[科学方法](@article_id:303666)本身提供了一个计算框架：建立模型，根据数据更新你的信念，做出预测，并批判性地检查你自己的假设，所有这一切都同时诚实地、定量地拥抱发现核心处的不确定性。