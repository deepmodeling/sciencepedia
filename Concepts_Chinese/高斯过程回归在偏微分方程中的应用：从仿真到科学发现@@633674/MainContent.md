## 引言
[偏微分方程](@entry_id:141332)（PDE）是描述自然世界的数学语言，从流体流动到[生物模式形成](@entry_id:199027)，无所不包。然而，高保真地求解这些方程通常需要巨大的计算能力，这为科学探索和工程设计带来了巨大的瓶颈。这一挑战催生了[科学机器学习](@entry_id:145555)的兴起，该领域旨在构建计算成本低廉且精确的代理模型，以替代这些昂贵的模拟。在这些方法中，[高斯过程回归](@entry_id:276025)（GPR）以其优雅、强大以及对不确定性的系统性处理而脱颖而出。本文探讨了 GPR 在 PDE 背景下的双重角色：首先是作为已知系统的强大仿真器，其次是作为科学发现本身的工具。我们将深入探讨 GPR 的核心原理，然后遍览其多样化的应用，揭示它如何重塑科学进程。

## 原理与机制

物理学所描述的世界是一首由[微分方程](@entry_id:264184)谱写的交响曲。从抛出小球的优美弧线到河流的湍急奔涌，从金属棒中热量的[扩散](@entry_id:141445)到细胞内错综复杂的生化[反应网络](@entry_id:203526)，这些方程都是自然的语言。为了理解这些现象，我们常常求助于计算机，让它们求解或*模拟*这些方程。但这有一个难题。[高保真度模拟](@entry_id:750285)，特别是对于像机翼上的气流这样的复杂系统，其成本可能高得惊人，有时在超级计算机上运行一个场景就需要数天或数周。如果我们需要探索数千种场景，以设计一架新飞机或量化测量中的不确定性如何影响我们的预测，该怎么办？我们将束手无策。

这正是[科学机器学习](@entry_id:145555)艺术的用武之地。我们试图为昂贵的模拟构建一个计算成本低廉的替代品。这个替代品从原始模拟中精心挑选的少数几个例子中学习，是我们通往快速探索、设计和发现的门户。

### 替代的艺术：仿真器与代理模型

让我们精确地描述我们正在构建的东西。我们有一个复杂的计算机模型——一个用于[求解偏微分方程](@entry_id:138485)（PDE）的高保真求解器，比如用于流体流动的纳维-斯托克斯方程。该模型接收一些输入参数 $\boldsymbol{\xi}$（可能是雷诺数或物体的形状），并产生一个我们感兴趣的输出 $Q(\boldsymbol{\xi})$（比如机翼上的升力）。映射 $\boldsymbol{\xi} \mapsto Q(\boldsymbol{\xi})$ 的计算成本很高。我们希望用一个更廉价的近似 $\hat{Q}(\boldsymbol{\xi})$ 来替代它。

这类近似方法的世界丰富多彩。任何此类廉价模型的通用术语是**代理模型**。这是一个宽泛的概念。代理模型中一个重要的类别是**降阶模型（ROM）**。降阶模型是一个“内部人士”。它窥探高保真求解器的内部机制，获取控制方程，并巧妙地将它们投影到一组更小、更易于管理的[基函数](@entry_id:170178)上。它仍然直接植根于原始方程的物理原理。

但如果我们不能或不想修改求解器怎么办？如果它是一个专有的黑箱呢？那么我们需要一个“外部人士”，一个纯粹从示例中学习输入-输出映射的模型。在这里，我们发现了另一类引人入胜的模型：**仿真器**。仿真器不仅给出一个预测，它给出一个*概率性*的预测。它告诉我们它的最佳猜测，以及它对这个猜测的不确定性有多大。在最优雅和最强大的仿真器中，**[高斯过程](@entry_id:182192)（GP）** [@problem_id:3369120] 占有一席之地。高斯过程并不将未知的、昂贵的函数 $Q(\boldsymbol{\xi})$ 视为一个固定的、确定性的东西，而是将其视为从一个无限的可能函数“宇宙”中的一次随机抽取。我们的任务是利用数据来缩小范围，确定哪个函数才是正确的。

### 函数的宇宙：[高斯过程](@entry_id:182192)先验

那么，将一个函数视为一次“随机抽取”意味着什么？让我们从熟悉的东西开始：一个单一的[随机变量](@entry_id:195330)，比如说一个人的身高。如果我们说这个身高是“[高斯分布](@entry_id:154414)的”，我们的意思是它遵循一个钟形曲线，由一个均值和一个[方差](@entry_id:200758)描述。高斯*过程*只是将这个概念从一个单一的数字扩展到一个完整的函数。

**[高斯过程](@entry_id:182192)**是[随机变量](@entry_id:195330)的集合，每个可能的输入点 $\boldsymbol{\xi}$ 对应一个[随机变量](@entry_id:195330)，并且具有一个特殊属性：这些变量的任何有限集合都具有[联合高斯](@entry_id:636452)（钟形曲线）[分布](@entry_id:182848)。一个 GP 完全由两样东西定义：

1.  一个**[均值函数](@entry_id:264860)**，$m(\boldsymbol{\xi})$。这是在看到任何数据之前，我们对函数在任意点 $\boldsymbol{\xi}$ 处值的初始最佳猜测。通常，为简单起见，我们只假设均值处处为零。

2.  一个**[协方差函数](@entry_id:265031)**，或称**[核函数](@entry_id:145324)**，$k(\boldsymbol{\xi}, \boldsymbol{\xi}')$。这是高斯过程真正的核心和灵魂。它告诉我们函数在两个不同点 $\boldsymbol{\xi}$ 和 $\boldsymbol{\xi}'$ 的值是如何相关的。它为我们函数宇宙中的函数定义了一种“相似性”或“家族相似性”的概念。如果 $k(\boldsymbol{\xi}, \boldsymbol{\xi}')$ 很大，意味着函数值 $Q(\boldsymbol{\xi})$ 和 $Q(\boldsymbol{\xi}')$ 预计会强相关——如果一个值高，另一个也可能高。如果核函数值接近于零，那么这两点基本上是独立的。

均值和[核函数](@entry_id:145324)共同定义了一个**函数上的先验分布**。这是一个惊人的想法：我们拥有的[概率分布](@entry_id:146404)不是针对数字，而是针对一个无限维的函数空间。核函数塑造了这个函数宇宙，偏爱某些形状而非其他形状。如果我们想为一个光滑的物理[过程建模](@entry_id:183557)，我们应该选择一个赋予[光滑函数](@entry_id:267124)高概率、赋予锯齿状、含噪声函数低概率的核函数。

### 机器的灵魂：由物理学锻造的核函数

这就引出了一个问题：我们如何选择一个好的核函数？我们可以随便选一个通用的，但在这里，我们发现了科学中一个深刻而统一的美妙时刻。我们可以从我们希望建模的物理学本身中锻造我们的[核函数](@entry_id:145324)。

考虑[热方程](@entry_id:144435) $\partial_t u = \Delta u$，它描述了热量如何在空间中[扩散](@entry_id:141445)。如果我们在 $t=0$ 时刻在位置 $\mathbf{x}'$ 处注入一个热点，那么在稍后的时间 $t > 0$ 的温度[分布](@entry_id:182848)由该方程的基本解给出，这是一个被称为**热核**的高斯形状函数：
$$
k_t(\mathbf{x},\mathbf{x}') = (4\pi t)^{-d/2} \exp\left(-\frac{\|\mathbf{x}-\mathbf{x}'\|^2}{4t}\right)
$$
这个函数具备了一个优秀[协方差核](@entry_id:266561)的所有属性。它是对称的，其值仅取决于 $\mathbf{x}$ 和 $\mathbf{x}'$ 之间的距离，这使其成为一种自然的邻近度量。最重要的是，它满足一个称为**[正定性](@entry_id:149643)**的数学条件，这是任何有效[协方差函数](@entry_id:265031)的先决条件 [@problem_id:3183886]。

更重要的是，这个受物理启发的[核函数](@entry_id:145324)让我们对光滑性的概念有了直观的把握。热核中的“时间”参数 $t$ 就像一个平滑旋钮。如果 $t$ 非常小，热量集中在初始点周围的一个尖峰上。如果 $t$ 很大，热量已经广泛[扩散](@entry_id:141445)，形成一个非常光滑、宽广的温度[分布](@entry_id:182848)。用高斯过程的语言来说，$t$ 对应一个**长度尺度**参数。通过选择一个具有大长度尺度的[核函数](@entry_id:145324)，我们实际上是在设定一个先验信念，即我们未知的函数非常光滑。

通过在[频域](@entry_id:160070)中观察，这种联系可以变得更加精确。函数的[光滑性](@entry_id:634843)与其高频分量的衰减速度有关。一个包含大量高频内容的函数是锯齿状且粗糙的；一个光滑的函数则由低频主导。与我们的核函数相关的[再生核希尔伯特空间](@entry_id:633928)（RKHS）的数学理论表明，一个函数的“成本”或“范数”涉及一个积分，该积分对其高频内容进行指数级惩罚。对于更大的长度尺度（$t$），这种惩罚更强，迫使我们先验宇宙中的函数变得异常光滑 [@problem_id:3183886]。

### 从数据中获取智慧：贝叶斯顿悟

我们有了先验——一个由[核函数](@entry_id:145324)塑造的函数宇宙。现在，我们进行几次昂贵的模拟，得到少数几个真实的数据点 $\{(\boldsymbol{\xi}_i, Q_i)\}$。我们如何更新我们的信念？这正是贝叶斯推断的魔力所在。

这个过程在概念上很简单：我们从广阔的先验函数宇宙中，丢弃掉每一个不经过（或者在有噪声数据的情况下，不是非常接近）我们观测数据点的函数。剩下的函数构成了我们新的、更小、更智能的可能性宇宙。这个新的集合被称为**后验过程**。

这个后验过程是什么样子的？值得注意的是，它也是一个[高斯过程](@entry_id:182192)！
-   它的**[后验均值](@entry_id:173826)**函数是我们对昂贵模拟输出的新最佳猜测。它是一条优美地插值我们数据点的曲线。
-   它的**后验[方差](@entry_id:200758)**代表我们更新后的不确定性。在我们拥有数据的位置，[方差](@entry_id:200758)降为零——我们确信函数在该处的值。当我们远离数据点时，[方差](@entry_id:200758)会增加，优雅地表明我们的预测变得不那么确定。这种对不确定性的诚实说明是 GP 框架的一大超能力。

还有另一种看待这个问题的方式。寻找既能拟[合数](@entry_id:263553)据又“光滑”（由核函数定义）的最佳函数的问题，可以被构建为一个称为**[核岭回归](@entry_id:636718)**的[优化问题](@entry_id:266749)。事实证明，这个[优化问题](@entry_id:266749)的解与[高斯过程](@entry_id:182192)的[后验均值](@entry_id:173826)*完全相同* [@problem_id:3183886]。这种概率性贝叶斯观点和确定性优化观点之间的二元性是现代机器学习的基石，揭示了同一个深层数学结构的两个方面。

### 巨人之战：全局多项式 vs. 局部相关性

这种 GP 方法与其他方法相比如何？一个主要的替代方法，尤其是在工程领域，是**[多项式混沌展开](@entry_id:162793)（PCE）**。GP 基于由核函数定义的局部相关性来构建模型，而 PCE 则试图将未知函数表示为*全局*[基函数](@entry_id:170178)的和——具体来说，是一系列选择来匹配输入参数[概率分布](@entry_id:146404)的正交多项式 [@problem_id:3348398]。例如，如果你的输入不确定性是[高斯分布](@entry_id:154414)，你就使用 Hermite 多项式；如果是[均匀分布](@entry_id:194597)，你就使用 Legendre 多项式。

为了确定这个多项式级数的系数，你需要运行的模拟次数至少等于[基函数](@entry_id:170178)的数量。对于一个在 $d$ 维空间中总阶为 $p$ 的 PCE，这个数量是 $\binom{p+d}{d}$ [@problem_id:3478376]。这个数字随着维度和多项式阶数的增加而灾难性地增长，这是**[维度灾难](@entry_id:143920)**的一种表现。另一方面，GP 可以用任意数量的点来构建，尽管它们最终也会受到维度灾难的影响，因为高维空间本质上是稀疏的 [@problem_id:2502979]。

但在理念上有一个更根本的区别，当底层物理行为不那么完美时，这一点变得很清楚。考虑一个简单的机械系统：一根杆拉伸直到碰到一个刚性挡块 [@problem_id:2707477]。力-位移关系在接触瞬间之前是线性的，接触后位移突然变为常数。由此产生的输入-输出映射有一个“扭折”——它是连续的，但其导数不连续。

对于一个全局多项式基，试图逼近这个扭折是一场噩梦。光滑的多项式在扭折附近剧烈摆动（一个经典的[吉布斯现象](@entry_id:138701)），并且逼近收敛得非常慢。这就像试图用光滑的乐高积木搭建一个尖角。然而，GP 要灵活得多。其基于核的、局部相关性的性质使其能够更优雅地适应这种非光滑特征，通常用少得多的数据点就能实现更好的逼近。许多现实世界中的物理系统，从材料失效到[相变](@entry_id:147324)，都表现出这种非光滑行为，这给了 GP 一个明显的优势。

这种灵活性也与另一种强大的方法——**物理信息神经网络（PINN）**——形成了对比。PINN 通过最小化一个组合[损失函数](@entry_id:634569)来学习一个函数：一部分衡量与数据的失配度，另一部分衡量函数违反控制 PDE 的程度 [@problem_id:3410663]。这可以看作是有一个“数据项”和一个“物理项”。GP 框架可以说更加整合：数据由似然处理，而物理（或者至少是我们对其光滑性和相关性的假设）则通过[核函数](@entry_id:145324)编码在先验中。两者通过[贝叶斯法则](@entry_id:275170)的逻辑无缝地结合在一起。

### 从模仿到洞见：发现自然方程

到目前为止，我们讨论了使用 GP 作为仿真器——替代*已知*物理定律的模拟。但我们能否从模仿上升到真正的科学洞见？我们能否使用这个框架来*发现*物理定律本身？

想象一下我们是研究基因调控网络的生物学家。我们有一些[蛋白质浓度](@entry_id:191958)随时间变化的稀疏、含噪声的测量值 $X(t)$。我们相信这个系统由一个[微分方程](@entry_id:264184) $\dot{X} = f(X)$ 控制，但我们不知道函数 $f$ 是什么 [@problem_id:3349392]。这是科学中的一个核心挑战：从数据中寻找自然法则的数学结构 [@problem_id:3353727]。

一个主要的障碍是，为了找到 $f$，我们需要知道导数 $\dot{X}$。但对含噪声数据进行[数值微分](@entry_id:144452)是一个众所周知的不稳定且易于出错的过程。这正是 GP 成为不可或缺的科学仪器的地方。
1.  我们用 GP 拟合我们含噪声的浓度数据 $X(t)$。GP 不仅仅是连接数据点；它提供了一个对底层真实轨迹的稳健、光滑的估计，有效地滤除了噪声。
2.  因为 GP 是一个光滑的解析对象，我们可以计算它的导数。一个 GP 的导数是另一个 GP！这意味着我们不仅得到了导数 $\dot{X}(t)$ 的估计，还得到了对该估计不确定性的系统性度量。
3.  有了这些干净的导数估计，我们就可以使用像 **[SINDy](@entry_id:266063)（[非线性动力学的稀疏辨识](@entry_id:276479)）** 这样的方法。[SINDy](@entry_id:266063) 执行一种特殊的回归。它接收导数数据和一个候选函数库（例如，常数项、线性项、二次项，如 $1, X, X^2, X^3, \sin(X), \ldots$），并找到能够重构导数的这些函数的最*稀疏*组合。结果是一个简单、可解释的[微分方程](@entry_id:264184)。

在这个过程中，我们对核函数的选择再次至关重要。如果我们施加一个过于光滑的先验——例如，通过使用一个具有非常大长度尺度的核函数——我们可能会“平滑掉”真实的动力学，低估导数，导致 [SINDy](@entry_id:266063) 发现错误的、过于简化的定律。通过选择一个其[光滑性](@entry_id:634843)假设与问题物理特性相匹配的核函数（例如，一个具有有限可微性的 **Matérn 核**），我们可以最小化这种偏差，让真实的动力学得以显现 [@problem_id:3349392]。

这是[高斯过程回归](@entry_id:276025)在科学领域的终极承诺。它最初只是一个构建代理模型的谦卑工具，一种使昂贵计算变得可行的方法。但通过其与物理学的深层联系和对不确定性的系统性处理，它变成了一种强大的发现工具，帮助我们更清晰地倾听数据，并解码支配我们世界的根本方程。

