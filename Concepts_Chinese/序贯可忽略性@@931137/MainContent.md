## 引言
从随时间演变的数据中得出因果结论是一项重大的科学挑战。与[静态分析](@entry_id:755368)不同，纵向研究涉及一种复杂的反馈舞蹈，其中处理会影响未来的状态，而这些状态反过来又会影响未来的处理。这种动态性产生了一个被称为时变混杂的复杂分析问题，即一个变量同时是未来处理的混杂因素和过去处理的中介因素，这使得标准的统计调整产生偏倚。要解开这个结，需要一个更强的理论基础。

本文探讨了序贯可忽略性原理，这一基石性假设使得在此类动态环境中进行因果推断成为可能。通过在每个时间点上将“仿佛随机”实验的想法形式化，这个概念为从观测性纵向数据中揭示因果真相提供了钥匙。在接下来的章节中，您将深入探讨该原理的核心，探索其假设以及它所促成的巧妙统计策略。“原理与机制”一节将解析逆概率加权和 g-估计等方法的逻辑。随后，“应用与跨学科联系”一章将展示序贯可忽略性如何在不同领域中应用，从重症监护室的[个性化医疗](@entry_id:152668)到设计更智能的实验，甚至为人工智能提供理论基础。

## 原理与机制

踏入随时间演变的因果世界，就如同面对一幅极其复杂的景象。生活不像一张简单的、单时刻的照片，而是像一部电影一样展开。今天的行动会产生涟漪，塑造明天的环境，而明天的环境又会影响我们接下来的行动。医生治疗病人；病人的病情发生变化；这一变化又指导着医生的下一个决定。这种复杂的反馈舞蹈是纵向数据的决定性特征，它对任何试图区分因果与相关的科学家都构成了严峻的挑战。

### 时变混杂的纠结之结

让我们想象一下，我们是在重症监护室 (ICU) 的科学家，试图了解每日用药对患者生存几率的影响。在第 1 天，医生根据患者的病情严重程度评分 $L_1$ 给予一个剂量 $A_1$。到第 2 天，患者的严重程度变为 $L_2$，部分是由于疾病的自然病程，部分是由于 $A_1$ 的效果。医生观察到这个新的严重程度 $L_2$，决定了新的剂量 $A_2$。这个过程日复一日地重复。[@problem_id:4365645]。

如果我们尝试用经典的统计工具来分析这个问题，我们立刻会发现自己陷入了一个概念上的死结。假设我们想了解第 2 天剂量 $A_2$ 的因果效应。患者在第 2 天的严重程度 $L_2$ 是一个典型的**混杂因素**：它影响了医生对 $A_2$ 的选择，并且肯定会影响最终的结局。任何基础统计学课程都会告诉我们，我们*必须*对 $L_2$ 进行统计调整，以阻断这条“后门”混杂路径。

但转折点在这里。第 2 天的严重程度 $L_2$ 也是第 1 天处理 $A_1$ 的结果。它直接位于从 $A_1$ 到最终结局的因果路径上。它是 $A_1$ 效应的**中介因素**。我们的统计学课程也曾明确警告我们，绝不要对位于我们感兴趣的因果路径上的变量进行调整，因为这样做会阻断我们想要测量的部分效应。

这就是**时变混杂**的戈尔迪之结 [@problem_id:4933654]。变量 $L_t$ 同时是其后处理（$A_t$）的混杂因素，也是其前处理（$A_{t-1}$）的中介因素。像[多元回归](@entry_id:144007)这样的标准方法，它同时调整所有变量，根本无法解决这个困境。它要么无法调整混杂，要么错误地阻断了因果路径。无论哪种情况，它都会得出有偏倚的答案。要解开这个结，我们需要一种新的思维方式，一种能让我们在时间的钢丝上行走的原则。

### 可识别性的三大支柱

要从随时间演变的数据中做出因果声明，我们需要一个坚实的基础。这个基础建立在三个关键假设之上，这三大支柱如果成立，就能让我们弥合观测数据与“如果怎样”的反事实世界之间的鸿沟。[@problem_id:4145198] [@problem_id:5191575]。

1.  **一致性 (Consistency)：** 这是最直观的支柱。它简单地陈述为，我们为某个个体观测到的结局，就是对应于他们实际接受的处理的潜在结局。如果一个病人接受了治疗方案 $\bar a$，那么我们观测到的存活状况就确切是他们在方案 $\bar a$ 下的潜在存活状况。它将数据的世界与假设的世界联系起来。

2.  **正性 (Positivity)：** 这是经验主义的支柱。它要求对于我们观察到的任何患者历史，接受任一处理的几率都非零。例如，如果我们数据集里病情最重的患者*总是*接受某种药物，那么我们从根本上就不可能从数据中得知如果他们没有接受该药物会发生什么。没有可供学习的信息。我们必须在观测世界中拥有一些多样性和实验性，才能对未观测到的情况做出声明。

3.  **序贯可忽略性 (Sequential Ignorability)：** 这是最核心、最强大、也是最大胆的支柱。它是“仿佛随机”这一理想情况的正式名称。该假设陈述为，在每个时间点 $t$，给予处理 $A_t$ 的决定，在考虑了过去所有处理和协变量的完整历史记录 ($H_t$) 后，与所有潜在结局 ($Y^{\bar a}$) 是独立的。在数学上，我们写成：

    $$ A_t \perp Y^{\bar a} \mid H_t $$

    通俗地说，这就是**无未测量混杂**的假设在时间上的序贯应用 [@problem_id:4961033]。它意味着，在时间点 $t$ 指导医生决策的、并且也可能独立影响患者最终结局的每一条信息，都必须被记录在我们的数据集 $H_t$ 中。如果医生根据一种微妙的直觉或电子健康记录中未记载的信息——他们的“临床医生格式塔”——来做决定，而这种直觉也能预测患者的命运，那么这个假设就被违反了 [@problem_id:5226923]。但如果该假设成立，它就给了我们一把解开时变之结的钥匙。

### 解结的两种策略

在我们的基础假设就位后，科学家们设计出了非常巧妙的策略来估计时变处理的效果。让我们来探索两种最著名方法背后的优美逻辑 [@problem_id:5226931]。

#### 重加权策略：构建一个伪人群

第一种策略，被**边际结构模型 (MSMs)** 所使用，是承认我们的观测数据存在混杂，并将其数字化地转换成一个没有混杂的数据集。这种方法被称为**逆概率加权 (IPW)**。

其直觉是这样的：在我们的 ICU 数据中，我们可能会注意到病情更重的患者更有可能接受高剂量的药物。这造成了一种虚假的相关性。为了打破它，我们可以想象在计算机上创建一个新的“伪人群”。在这个新的人群中，我们给那些做了出人意料之事的个体更大的权重。一个病情很重但偶然接受了*低*剂量的患者，是宝贵信息的来源；在我们的伪人群中，我们通过赋予他们一个大的权重来多次“克隆”他们。相反，一个病情很重且接受了预期的高剂量的患者，则不那么令人意外；我们给他们一个较小的权重。

通过计算每个人的观测处理历史的概率，并给他们分配一个等于该概率倒数的权重，我们创建了一个新的、加权的数据集。这个过程的神奇之处在于，在得到的伪人群中，处理不再与测量的协变量相关联。这就好像我们从一个大型的、序贯随机试验中创建了一个数据集。在这个新世界里，混杂消失了，我们可以直接测量任何处理策略的因果效应。

#### 相减策略：寻找因果“脉冲”

第二种同样优美的策略被**结构嵌套均值模型 (SNMMs)** 所使用，称为 **g-估计**。该方法不是对人进行重加权，而是转换结局。

其逻辑类似于调试一个反馈消除系统 [@problem_id:5226934]。想象一下，我们对每一步处理的因果效应大小有一个假设——即“因果脉冲”。对于任何一个病人，我们可以取他们观测到的最终结局，然后在我们的计算机上，数字化地减去他们接受的最后一次处理的假设效应。结果就是我们对如果他们没有接受那次处理，他们的结局*本该是*什么的最好猜测。

现在，我们援引我们的关键假设：序贯可忽略性。如果我们关于因果效应的假设是正确的，那么这个新的、“脉冲下调”的结局，在考虑了患者的历史之后，应该与实际给予的处理没有关系。如果仍然存在残余关联，那么我们的假设必定是错误的。

因此，g-估计变成了一个搜索过程。我们“转动一个旋钮”，调整我们对因果效应参数（$\psi$）的估计，直到找到那个能使“脉冲下调”的结局与处理之间的关联消失的精确值。实现这种神奇抵消的 $\psi$ 值就是我们对真实因果效应的估计。这是一个惊人优雅的想法：[条件独立性](@entry_id:262650)的假设为我们提供了一个检验我们因果模型的标准。

### 当假设受到挑战时

这些方法的优雅之处建立在序贯可忽略性的假设之上。但在科学的混乱现实中，我们必须始终质疑我们的假设。如果*确实*存在一个未测量的混杂因素，比如那位临床医生的格式塔 [@problem_id:5226923]？整个大厦会因此崩塌吗？

并不会。一个成熟的科学框架会提供用于质疑的工具。

首先，g-估计的数学机制为我们提供了一种探查假设裂缝的方法。通过指定比我们待估计参数更多的“[矩条件](@entry_id:136365)”，我们可以进行**过度识别检验**。这就像是检查对同一数量的多次独立计算是否得出相同答案。如果答案不一致，就是一个危险信号，表明我们的核心假设之一——要么是我们的因果模型，要么是序贯可忽略性本身——很可能是错误的。

其次，我们可以进行**[敏感性分析](@entry_id:147555)** [@problem_id:4756878]。我们可以问，“一个未测量的混杂因素需要多强才能改变我的结论？”我们可以计算一个特定强度的假设混杂因素所引起的偏倚。这使我们能够做出这样的陈述：“只有当存在一个强度是任何已知混杂因素两倍的未测量因素时，我们关于该药物有效的发现才会被推翻。”这并不能证明我们的假设是正确的，但它为我们的不确定性设定了严格的界限。

最后，如果我们认为序贯可忽略性确实被违反了，我们有时可以转向一种完全不同的魔法：**[工具变量法](@entry_id:204495) (IV)** [@problem_id:5226877]。工具变量是一个能够推动处理决策，但与结局没有其他联系的变量。它可能是一家医院的处方偏好，或者是随机分配给有不同习惯的临床医生。这个变量在一个原本是观测性的世界里提供了一小片随机性。通过只关注由工具变量“诱导”的处理变异，我们即使在存在未测量混杂因素的情况下也能分离出因果效应。这需要另一套强有力的假设，但当序贯可忽略性的假设不再成立时，它为通往因果真理提供了一条强有力的替代路径。

