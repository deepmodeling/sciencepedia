{"hands_on_practices": [{"introduction": "The Flory-Huggins theory not only describes the free energy of mixing but also provides a powerful framework for predicting when a homogeneous solution will become unstable and phase-separate. This critical point is located by analyzing the curvature of the free energy function, where the system is on the verge of demixing. This exercise [@problem_id:2026105] offers fundamental practice in applying mathematical stability conditions to the Flory-Huggins free energy expression. By exploring the theoretical limit of infinitely long polymer chains, you will derive a classic result of polymer physics and deepen your understanding of how chain length ($N$) and interaction energy ($\\chi$) govern miscibility.", "problem": "In the study of polymer thermodynamics, the Flory-Huggins theory provides a foundational model for the Gibbs free energy of mixing a polymer with a solvent. The Gibbs free energy of mixing per lattice site, in units of $k_B T$ where $k_B$ is the Boltzmann constant and $T$ is the absolute temperature, is given by the expression:\n$$\n\\frac{\\Delta G_m}{k_B T} = (1-\\phi) \\ln(1-\\phi) + \\frac{\\phi}{N} \\ln \\phi + \\chi \\phi(1-\\phi)\n$$\nHere, $\\phi$ is the volume fraction of the polymer, $N$ is the degree of polymerization (the number of monomer units in a single polymer chain, which can be treated as a continuous variable in this model), and $\\chi$ is the Flory-Huggins interaction parameter, which quantifies the enthalpy of interaction between polymer segments and solvent molecules.\n\nThe stability of this mixture against spontaneous phase separation into a polymer-rich and a polymer-poor phase is determined by the shape of the $\\Delta G_m$ versus $\\phi$ curve. The critical point, which marks the threshold for this phase separation, corresponds to the specific state $(\\phi_c, \\chi_c)$ at which the system is on the verge of instability. Mathematically, this critical point is found by simultaneously satisfying the conditions that the second and third partial derivatives of the Gibbs free energy of mixing with respect to the polymer volume fraction $\\phi$ are equal to zero.\n\nConsider the theoretical scenario of a polymer with an extremely high degree of polymerization. Calculate the exact value of the critical interaction parameter, $\\chi_c$, in the limit where the polymer chain becomes infinitely long (i.e., as $N \\to \\infty$). Express your answer as a single real number.", "solution": "Let $f(\\phi)$ denote the dimensionless Gibbs free energy of mixing per lattice site:\n$$\nf(\\phi) = (1 - \\phi)\\ln(1 - \\phi) + \\frac{\\phi}{N}\\ln \\phi + \\chi \\phi(1 - \\phi).\n$$\nThe critical point is determined by the simultaneous conditions $f''(\\phi_{c})=0$ and $f'''(\\phi_{c})=0$.\n\nCompute the derivatives. First,\n$$\nf'(\\phi) = -\\ln(1 - \\phi) - 1 + \\frac{1}{N}(\\ln \\phi + 1) + \\chi(1 - 2\\phi).\n$$\nThen,\n$$\nf''(\\phi) = \\frac{1}{1 - \\phi} + \\frac{1}{N\\phi} - 2\\chi,\n$$\nand\n$$\nf'''(\\phi) = \\frac{1}{(1 - \\phi)^{2}} - \\frac{1}{N\\phi^{2}}.\n$$\n\nSet $f'''(\\phi_{c})=0$:\n$$\n\\frac{1}{(1 - \\phi_{c})^{2}} = \\frac{1}{N\\phi_{c}^{2}}\n\\;\\;\\Longrightarrow\\;\\;\n(1 - \\phi_{c})^{2} = N\\phi_{c}^{2}.\n$$\nTaking the positive root (since $0<\\phi_{c}<1$ implies $1-\\phi_{c}>0$),\n$$\n1 - \\phi_{c} = \\sqrt{N}\\,\\phi_{c}\n\\;\\;\\Longrightarrow\\;\\;\n\\phi_{c} = \\frac{1}{1 + \\sqrt{N}}.\n$$\n\nNow impose $f''(\\phi_{c})=0$:\n$$\n0 = \\frac{1}{1 - \\phi_{c}} + \\frac{1}{N\\phi_{c}} - 2\\chi_{c}.\n$$\nUsing $\\phi_{c} = \\frac{1}{1 + \\sqrt{N}}$, compute\n$$\n1 - \\phi_{c} = \\frac{\\sqrt{N}}{1 + \\sqrt{N}},\n\\quad\n\\frac{1}{1 - \\phi_{c}} = \\frac{1 + \\sqrt{N}}{\\sqrt{N}},\n\\quad\n\\frac{1}{N\\phi_{c}} = \\frac{1 + \\sqrt{N}}{N}.\n$$\nTherefore,\n$$\n2\\chi_{c} = \\frac{1 + \\sqrt{N}}{\\sqrt{N}} + \\frac{1 + \\sqrt{N}}{N}\n= \\frac{(1 + \\sqrt{N})^{2}}{N}\n= 1 + \\frac{2}{\\sqrt{N}} + \\frac{1}{N},\n$$\nso\n$$\n\\chi_{c} = \\frac{1}{2} + \\frac{1}{\\sqrt{N}} + \\frac{1}{2N}.\n$$\n\nIn the limit $N \\to \\infty$, the terms $\\frac{1}{\\sqrt{N}}$ and $\\frac{1}{2N}$ vanish, yielding the exact limiting value\n$$\n\\lim_{N \\to \\infty} \\chi_{c} = \\frac{1}{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2026105"}, {"introduction": "While the Flory-Huggins interaction parameter, $\\chi$, is central to the theory, it is often treated as a phenomenological fitting parameter. For predictive engineering and materials design, we need methods to estimate its value from the intrinsic properties of the polymer and solvent. This can be accomplished by bridging the Flory-Huggins model with regular solution theory, which links mixing enthalpy to the cohesive energy densities of the pure components, quantified by their Hildebrand solubility parameters ($\\delta$). This practice [@problem_id:2641151] challenges you to derive this vital relationship, connecting two cornerstone thermodynamic models and enabling a first-principles estimation of polymer-solvent compatibility.", "problem": "A polymer solution is modeled using the mean-field lattice framework of Flory-Huggins theory and regular solution thermodynamics. Consider polystyrene (polymer $1$) dissolved in cyclohexane (solvent $2$) at temperature $T = 313.15\\,\\mathrm{K}$. The Hildebrand solubility parameters are $\\delta_{1} = 18.6\\,\\mathrm{MPa}^{1/2}$ for polystyrene and $\\delta_{2} = 16.8\\,\\mathrm{MPa}^{1/2}$ for cyclohexane at this temperature. The solvent (cyclohexane) has molar mass $M_{2} = 84.16\\,\\mathrm{g}\\,\\mathrm{mol}^{-1}$ and mass density $\\rho_{2} = 0.759\\,\\mathrm{g}\\,\\mathrm{cm}^{-3}$ at $T = 313.15\\,\\mathrm{K}$. Assume the reference lattice-site volume $v_{0}$ equals the molecular volume of the solvent, i.e., $v_{0} = V_{m,2}/N_{A}$ with $V_{m,2} = M_{2}/\\rho_{2}$.\n\nStarting from (i) the definition of the solubility parameter $\\delta_{i} \\equiv \\sqrt{(\\Delta E/V)_{i}}$ as the square root of the cohesive energy density, (ii) the regular solution approximation for the enthalpy of mixing per unit volume, and (iii) the Flory-Huggins mean-field free energy in which the enthalpic contribution is proportional to the product of volume fractions, derive an expression that relates the Flory-Huggins interaction parameter $\\chi$ to $\\delta_{1}$, $\\delta_{2}$, $v_{0}$, $k_{B}$, and $T$. Then use it to estimate $\\chi$ for the given system.\n\nUse the following constants and unit relations: $N_{A} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$, $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$, $1\\,\\mathrm{MPa} = 10^{6}\\,\\mathrm{J}\\,\\mathrm{m}^{-3}$, and $1\\,\\mathrm{cm}^{3} = 10^{-6}\\,\\mathrm{m}^{3}$. Carefully convert all quantities to International System of Units before computing.\n\nFinally, briefly identify the core physical assumptions that underlie mapping the regular solution description onto the Flory-Huggins interaction parameter and comment on their plausibility for this polymer-solvent pair at the stated temperature.\n\nExpress your final value of $\\chi$ as a pure number (dimensionless), rounded to three significant figures.", "solution": "The objective is to establish a relationship between the Flory-Huggins interaction parameter, $\\chi$, and the Hildebrand solubility parameters, $\\delta_i$. This is accomplished by equating the expressions for the enthalpy of mixing, $\\Delta H_{mix}$, from Regular Solution Theory and Flory-Huggins Theory.\n\nFirst, we consider Regular Solution Theory. The enthalpy of mixing per unit volume, $\\frac{\\Delta H_{mix}}{V}$, for a binary mixture is given by the Scatchard-Hildebrand equation:\n$$\n\\frac{\\Delta H_{mix}}{V} = (\\delta_1 - \\delta_2)^2 \\phi_1 \\phi_2\n$$\nwhere $\\phi_1$ and $\\phi_2$ are the volume fractions of the polymer (component $1$) and solvent (component $2$), respectively. The solubility parameters $\\delta_1$ and $\\delta_2$ are defined as the square root of the cohesive energy density, $\\delta_i = \\sqrt{(\\Delta E/V)_i}$. This expression for $\\Delta H_{mix}$ is derived assuming a random mixture, no volume change on mixing, and that the interaction energy between unlike species can be approximated by the geometric mean of the like-species interaction energies.\n\nNext, we consider the Flory-Huggins lattice model. The Gibbs free energy of mixing, $\\Delta G_{mix}$, is given by:\n$$\n\\frac{\\Delta G_{mix}}{k_B T} = n_1 \\ln \\phi_1 + n_2 \\ln \\phi_2 + \\chi n_{sites} \\phi_1 \\phi_2\n$$\nHere, $n_1$ and $n_2$ are the number of polymer and solvent molecules, $k_B$ is the Boltzmann constant, $T$ is the absolute temperature, and $n_{sites}$ is the total number of lattice sites. The first two terms represent the combinatorial entropy of mixing for molecules of disparate sizes, and the third term represents the enthalpy of interaction. The parameter $\\chi$ is a dimensionless quantity that characterizes the interaction energy per solvent molecule, measured in units of $k_B T$.\n\nThe enthalpic contribution to the free energy of mixing in the Flory-Huggins model is $\\Delta H_{mix} = \\chi k_B T n_{sites} \\phi_1 \\phi_2$. The total volume of the system is $V = n_{sites} v_0$, where $v_0$ is the volume of a single lattice site. Therefore, the enthalpy of mixing per unit volume is:\n$$\n\\frac{\\Delta H_{mix}}{V} = \\frac{\\chi k_B T n_{sites} \\phi_1 \\phi_2}{n_{sites} v_0} = \\frac{\\chi k_B T}{v_0} \\phi_1 \\phi_2\n$$\nBy equating the two expressions for the enthalpy of mixing per unit volume, we obtain:\n$$\n(\\delta_1 - \\delta_2)^2 \\phi_1 \\phi_2 = \\frac{\\chi k_B T}{v_0} \\phi_1 \\phi_2\n$$\nFor a non-trivial solution where $\\phi_1 \\neq 0$ and $\\phi_2 \\neq 0$, we can divide both sides by $\\phi_1 \\phi_2$ to find the relationship for $\\chi$:\n$$\n\\chi = \\frac{v_0}{k_B T} (\\delta_1 - \\delta_2)^2\n$$\nThis is the desired expression. We now proceed to calculate the numerical value of $\\chi$ for the given system.\n\nFirst, all quantities must be converted to the International System of Units (SI).\nThe reference volume, $v_0$, is taken as the molecular volume of the solvent (cyclohexane).\n$$\nv_0 = \\frac{V_{m,2}}{N_A} = \\frac{M_2}{\\rho_2 N_A}\n$$\nThe given values are:\n$M_2 = 84.16\\,\\mathrm{g}\\,\\mathrm{mol}^{-1} = 84.16 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$\n$\\rho_2 = 0.759\\,\\mathrm{g}\\,\\mathrm{cm}^{-3} = 0.759 \\times \\frac{10^{-3}\\,\\mathrm{kg}}{(10^{-2}\\,\\mathrm{m})^3} = 0.759 \\times 10^3\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n$N_A = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$\n\nThe molar volume of the solvent is:\n$$\nV_{m,2} = \\frac{M_2}{\\rho_2} = \\frac{84.16 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}}{0.759 \\times 10^3\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}} \\approx 1.1088 \\times 10^{-4}\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\n$$\nThe reference lattice volume is:\n$$\nv_0 = \\frac{1.1088 \\times 10^{-4}\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}}{6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}} \\approx 1.8412 \\times 10^{-28}\\,\\mathrm{m}^3\n$$\nNext, we calculate the term involving the solubility parameters:\n$\\delta_1 = 18.6\\,\\mathrm{MPa}^{1/2}$ and $\\delta_2 = 16.8\\,\\mathrm{MPa}^{1/2}$.\nUsing the conversion $1\\,\\mathrm{MPa} = 10^6\\,\\mathrm{J}\\,\\mathrm{m}^{-3}$:\n$$\n(\\delta_1 - \\delta_2)^2 = (18.6 - 16.8)^2 \\, \\mathrm{MPa} = (1.8)^2 \\, \\mathrm{MPa} = 3.24\\,\\mathrm{MPa} = 3.24 \\times 10^6\\,\\mathrm{J}\\,\\mathrm{m}^{-3}\n$$\nThe thermal energy is:\n$T = 313.15\\,\\mathrm{K}$\n$k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$\n$$\nk_B T = (1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1})(313.15\\,\\mathrm{K}) \\approx 4.3235 \\times 10^{-21}\\,\\mathrm{J}\n$$\nNow, substitute these values into the expression for $\\chi$:\n$$\n\\chi = \\frac{v_0 (\\delta_1 - \\delta_2)^2}{k_B T} = \\frac{(1.8412 \\times 10^{-28}\\,\\mathrm{m}^3)(3.24 \\times 10^6\\,\\mathrm{J}\\,\\mathrm{m}^{-3})}{4.3235 \\times 10^{-21}\\,\\mathrm{J}}\n$$\n$$\n\\chi \\approx \\frac{5.9655 \\times 10^{-22}}{4.3235 \\times 10^{-21}} \\approx 0.13798\n$$\nRounding to three significant figures, the estimated value is $\\chi = 0.138$.\n\nFinally, we address the core physical assumptions underlying this mapping. The derivation equates an enthalpic term from regular solution theory with the interaction term in Flory-Huggins theory. The primary assumptions are therefore those of the Scatchard-Hildebrand regular solution model:\n1. The volume of mixing is zero, $\\Delta V_{mix} = 0$. This is an approximation; small volume changes often occur but are typically negligible.\n2. The excess entropy of mixing is zero. This means the Flory-Huggins parameter $\\chi$ is assumed to be purely enthalpic in origin, varying as $1/T$. In reality, $\\chi$ often contains a significant entropic component, usually represented as an constant term, $\\chi = A + B/T$. Our derivation effectively sets $A=0$. This is a major simplification, as specific interactions or conformational changes can contribute to a non-combinatorial entropy of mixing.\n3. The interaction energy between unlike species ($1$-$2$) is the geometric mean of the interaction energies of the pure species ($1$-$1$ and $2$-$2$). This approximation is most valid for nonpolar systems where intermolecular forces are dominated by London dispersion forces.\n\nFor the system of polystyrene in cyclohexane, both components are predominantly nonpolar. Therefore, the geometric mean approximation is plausible. The given temperature, $T=313.15\\,\\mathrm{K}$ ($40\\,\\mathrm{^\\circ C}$), is above the theta temperature for this system (which is approximately $307.65\\,\\mathrm{K}$ or $34.5\\,\\mathrm{^\\circ C}$). At the theta temperature, $\\chi=0.5$. A value of $\\chi \\approx 0.138 < 0.5$ correctly indicates that at $40\\,\\mathrm{^\\circ C}$, cyclohexane is a good solvent for polystyrene, which is physically consistent. While ignoring the entropic component of $\\chi$ is a simplification, the regular solution approach provides a reasonable and physically intuitive first-order estimate for the enthalpic contribution to the interaction parameter.", "answer": "$$\n\\boxed{0.138}\n$$", "id": "2641151"}, {"introduction": "Beyond macroscopic theories like the regular solution model, modern computational chemistry provides a direct route to understanding the molecular origins of the $\\chi$ parameter. By simulating the microscopic arrangement of polymer segments and solvent molecules on a lattice, we can count the energetic interactions between them. This exercise [@problem_id:2641153] guides you to connect this microscopic information to the macroscopic $\\chi$ parameter by deriving it from first principles based on contact energies and counts. This advanced practice bridges the gap between statistical mechanics, molecular simulation, and mean-field theories, showcasing how computational data can be used to parameterize and validate thermodynamic models.", "problem": "You are asked to formalize how to estimate the Flory-Huggins interaction parameter for polymer solutions by counting unlike contacts in a lattice-based molecular simulation and to implement the resulting computation. You must begin from a fundamental energetic description of a binary mixture on a coordination lattice and from the definition of mixing enthalpy, and you must not assume any shortcut formulas. Your derivation must proceed from first principles to a computable expression for an effective composition- and temperature-dependent interaction parameter. Then you must implement this expression to evaluate a specified test suite.\n\nConsider a binary mixture of species $A$ and $B$ occupying a lattice of $N$ sites with coordination number $z$ (each site has $z$ neighbors). Let $N_A$ and $N_B$ be the numbers of $A$ and $B$ sites, with $N_A + N_B = N$, and volume fractions $\\phi_A = N_A/N$ and $\\phi_B = N_B/N$. Define pair interaction energies per nearest-neighbor contact as $\\varepsilon_{AA}$, $\\varepsilon_{BB}$, and $\\varepsilon_{AB}$ (in Joules). At a given absolute temperature $T$ (in Kelvin), the Boltzmann constant is $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$. Suppose a molecular simulation on such a lattice (for example, a Monte Carlo simulation) at equilibrium has produced the total count $n_{AB}$ of unlike $A$â€“$B$ nearest-neighbor contacts in the mixture. The simulation box is large and periodic, and $n_{AB}$ is measured over the whole box; it is understood that $n_{AA}$ and $n_{BB}$ are the corresponding like-like contact counts and that $n_{AA} + n_{BB} + n_{AB} = zN/2$ accounts for undirected contacts.\n\nTask:\n1) Starting solely from (i) the definition of the internal energy of a nearest-neighbor lattice mixture expressed in terms of the contact counts and pair energies and (ii) the definition of the enthalpy (internal energy) of mixing between separated pure phases and the mixture, derive an explicit expression for the mixing enthalpy per site in terms of $n_{AB}$ and appropriate parameters. Then, by identifying the enthalpic contribution in the Flory-Huggins free energy of mixing per site, derive a computable expression for an effective interaction parameter $\\chi_{\\mathrm{eff}}(\\phi_A,\\phi_B,T)$ in terms of $n_{AB}$, $N$, $\\phi_A$, $\\phi_B$, $T$, and the pair energies. Your derivation must be self-contained and must not assume any pre-known final formulas for $\\chi$.\n\n2) Implement a program that evaluates $\\chi_{\\mathrm{eff}}$ for the following test suite. In every case, $N$, $z$, $T$, $\\varepsilon_{AA}$, $\\varepsilon_{BB}$, $\\varepsilon_{AB}$, and $n_{AB}$ are provided. Use $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$. Report $\\chi_{\\mathrm{eff}}$ as a dimensionless float for each case, rounded to $6$ decimal places. The volume fractions must be computed from the provided $\\phi_B$ as $\\phi_A = 1 - \\phi_B$. All energies are per contact in Joules, temperatures are in Kelvin, and counts are integers. You must not introduce any additional fitting parameters.\n\nTest suite:\n- Case $1$: $N = 100000$, $z = 6$, $T = 400$, $\\phi_B = 0.3$, $\\varepsilon_{AA} = -2.5\\times 10^{-21}$, $\\varepsilon_{BB} = -2.0\\times 10^{-21}$, $\\varepsilon_{AB} = -2.2\\times 10^{-21}$, $n_{AB} = 126000$.\n- Case $2$: Same as Case $1$ but with $n_{AB} = 113400$.\n- Case $3$: $N = 200000$, $z = 6$, $T = 298$, $\\phi_B = 0.02$, $\\varepsilon_{AA} = -2.0\\times 10^{-21}$, $\\varepsilon_{BB} = -2.0\\times 10^{-21}$, $\\varepsilon_{AB} = -2.2\\times 10^{-21}$, $n_{AB} = 23520$.\n- Case $4$: Same as Case $1$ but with $T = 800$ and $n_{AB} = 126000$.\n\nOutput requirements:\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above. For example, the output must look like $[\\chi_1,\\chi_2,\\chi_3,\\chi_4]$ where each $\\chi_i$ is rounded to $6$ decimal places.\n- All outputs are dimensionless numbers. No units must be printed.", "solution": "**Part 1: Derivation of the Effective Interaction Parameter, $\\chi_{\\mathrm{eff}}$**\n\nThe derivation proceeds from the definitions of internal energy and enthalpy of mixing for a lattice-based binary mixture.\n\n**Step 1: Internal Energy of the Mixture**\nConsider a lattice of $N$ total sites, occupied by $N_A$ particles of species $A$ and $N_B$ particles of species $B$, where $N = N_A + N_B$. The system is characterized by nearest-neighbor pair interaction energies $\\varepsilon_{AA}$, $\\varepsilon_{BB}$, and $\\varepsilon_{AB}$. Let $n_{AA}$, $n_{BB}$, and $n_{AB}$ be the total counts of undirected $A-A$, $B-B$, and $A-B$ contacts in the mixture at equilibrium. The total internal energy of the mixture, $U_{\\text{mix}}$, is the sum of all pair interaction energies:\n$$U_{\\text{mix}} = n_{AA}\\varepsilon_{AA} + n_{BB}\\varepsilon_{BB} + n_{AB}\\varepsilon_{AB}$$\n\n**Step 2: Internal Energy of the Pure Components**\nBefore mixing, the system consists of two separate, pure phases: one with $N_A$ particles of $A$ and another with $N_B$ particles of $B$.\nIn a pure $A$ phase on $N_A$ sites, each site has $z$ neighbors, leading to a total of $zN_A$ \"bond halves\". Since each $A-A$ bond connects two $A$ particles, the total number of $A-A$ contacts is $\\frac{zN_A}{2}$. The internal energy of the pure $A$ phase is:\n$$U_{A, \\text{pure}} = \\left(\\frac{zN_A}{2}\\right) \\varepsilon_{AA}$$\nBy analogy, the internal energy of the pure $B$ phase is:\n$$U_{B, \\text{pure}} = \\left(\\frac{zN_B}{2}\\right) \\varepsilon_{BB}$$\nThe total internal energy of the unmixed system, $U_{\\text{pure}}$, is the sum of the energies of the pure components:\n$$U_{\\text{pure}} = U_{A, \\text{pure}} + U_{B, \\text{pure}} = \\frac{zN_A}{2}\\varepsilon_{AA} + \\frac{zN_B}{2}\\varepsilon_{BB}$$\n\n**Step 3: Enthalpy of Mixing**\nFor condensed-phase systems, the change in volume upon mixing is often negligible, so the enthalpy of mixing, $\\Delta H_{\\text{mix}}$, is well approximated by the change in internal energy, $\\Delta U_{\\text{mix}}$.\n$$\\Delta H_{\\text{mix}} \\approx \\Delta U_{\\text{mix}} = U_{\\text{mix}} - U_{\\text{pure}}$$\nSubstituting the expressions for $U_{\\text{mix}}$ and $U_{\\text{pure}}$:\n$$\\Delta U_{\\text{mix}} = (n_{AA}\\varepsilon_{AA} + n_{BB}\\varepsilon_{BB} + n_{AB}\\varepsilon_{AB}) - \\left(\\frac{zN_A}{2}\\varepsilon_{AA} + \\frac{zN_B}{2}\\varepsilon_{BB}\\right)$$\nTo express $\\Delta U_{\\text{mix}}$ in terms of the given observable $n_{AB}$, we must eliminate $n_{AA}$ and $n_{BB}$. We establish relationships for the number of contacts by considering a 'bond balance' for each species. The total number of bond halves originating from all $A$ particles is $zN_A$. These bond halves participate in either $A-A$ or $A-B$ contacts. Each $A-A$ contact involves two such bond halves, and each $A-B$ contact involves one. Thus:\n$$zN_A = 2n_{AA} + n_{AB} \\implies n_{AA} = \\frac{1}{2}(zN_A - n_{AB})$$\nSimilarly, for species $B$:\n$$zN_B = 2n_{BB} + n_{AB} \\implies n_{BB} = \\frac{1}{2}(zN_B - n_{AB})$$\nNow, substitute these expressions for $n_{AA}$ and $n_{BB}$ into the equation for $\\Delta U_{\\text{mix}}$:\n$$\\Delta U_{\\text{mix}} = \\left[\\frac{1}{2}(zN_A - n_{AB})\\varepsilon_{AA} + \\frac{1}{2}(zN_B - n_{AB})\\varepsilon_{BB} + n_{AB}\\varepsilon_{AB}\\right] - \\left(\\frac{zN_A}{2}\\varepsilon_{AA} + \\frac{zN_B}{2}\\varepsilon_{BB}\\right)$$\nExpanding the terms:\n$$\\Delta U_{\\text{mix}} = \\left(\\frac{zN_A}{2}\\varepsilon_{AA} - \\frac{n_{AB}}{2}\\varepsilon_{AA}\\right) + \\left(\\frac{zN_B}{2}\\varepsilon_{BB} - \\frac{n_{AB}}{2}\\varepsilon_{BB}\\right) + n_{AB}\\varepsilon_{AB} - \\frac{zN_A}{2}\\varepsilon_{AA} - \\frac{zN_B}{2}\\varepsilon_{BB}$$\nThe terms involving $z$ cancel out, leaving:\n$$\\Delta U_{\\text{mix}} = n_{AB}\\varepsilon_{AB} - \\frac{n_{AB}}{2}\\varepsilon_{AA} - \\frac{n_{AB}}{2}\\varepsilon_{BB}$$\nFactoring out $n_{AB}$ yields the total enthalpy of mixing in terms of the number of unlike contacts:\n$$\\Delta H_{\\text{mix}} = n_{AB} \\left( \\varepsilon_{AB} - \\frac{\\varepsilon_{AA} + \\varepsilon_{BB}}{2} \\right)$$\nThe enthalpy of mixing per lattice site is therefore:\n$$\\frac{\\Delta H_{\\text{mix}}}{N} = \\frac{n_{AB}}{N} \\left( \\varepsilon_{AB} - \\frac{\\varepsilon_{AA} + \\varepsilon_{BB}}{2} \\right)$$\nThis completes the first part of the required derivation.\n\n**Step 4: Identification with Flory-Huggins Theory**\nThe Flory-Huggins theory for the Gibbs free energy of mixing per site, $\\frac{\\Delta G_{\\text{mix}}}{N}$, for a simple binary mixture (polymerization degree of $1$ for both species) is:\n$$\\frac{\\Delta G_{\\text{mix}}}{N k_{\\mathrm{B}} T} = \\phi_A \\ln(\\phi_A) + \\phi_B \\ln(\\phi_B) + \\chi \\phi_A \\phi_B$$\nwhere $\\phi_A = N_A/N$ and $\\phi_B = N_B/N$ are the volume fractions, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $T$ is the absolute temperature. The term $\\chi \\phi_A \\phi_B$ represents the dimensionless enthalpic contribution to the free energy of mixing. Thus, the enthalpy of mixing per site can be expressed as:\n$$\\frac{\\Delta H_{\\text{mix}}}{N} = \\chi k_{\\mathrm{B}} T \\phi_A \\phi_B$$\nThe problem asks for an effective parameter, $\\chi_{\\mathrm{eff}}$, that is consistent with the simulated contact number $n_{AB}$. By equating our derived expression for the mixing enthalpy per site with the one defined in the Flory-Huggins framework, we obtain:\n$$\\frac{n_{AB}}{N} \\left( \\varepsilon_{AB} - \\frac{\\varepsilon_{AA} + \\varepsilon_{BB}}{2} \\right) = \\chi_{\\mathrm{eff}} k_{\\mathrm{B}} T \\phi_A \\phi_B$$\nSolving for $\\chi_{\\mathrm{eff}}$ yields the desired computable expression. Note that since the given $n_{AB}$ is a result of a specific state (at a given $T$ and composition), the resulting $\\chi_{\\mathrm{eff}}$ is an effective parameter for that state.\n$$\\chi_{\\mathrm{eff}}(\\phi_A, \\phi_B, T) = \\frac{n_{AB}}{N \\phi_A \\phi_B} \\frac{1}{k_{\\mathrm{B}} T} \\left( \\varepsilon_{AB} - \\frac{\\varepsilon_{AA} + \\varepsilon_{BB}}{2} \\right)$$\nThis completes the derivation.\n\n**Part 2: Calculation for the Test Suite**\n\nThe derived formula will be implemented to compute $\\chi_{\\mathrm{eff}}$ for each test case.\n- For Case $1$: $\\chi_{\\mathrm{eff}} = 0.054322$\n- For Case $2$: $\\chi_{\\mathrm{eff}} = 0.048890$\n- For Case $3$: $\\chi_{\\mathrm{eff}} = -0.291673$\n- For Case $4$: $\\chi_{\\mathrm{eff}} = 0.027161$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates the effective Flory-Huggins interaction parameter\n    for a binary mixture on a lattice based on simulated contact counts.\n    \"\"\"\n    \n    # Define the Boltzmann constant\n    k_B = 1.380649e-23  # J/K\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary of parameters.\n    test_cases = [\n        {\n            \"N\": 100000, \"z\": 6, \"T\": 400, \"phi_B\": 0.3,\n            \"eps_AA\": -2.5e-21, \"eps_BB\": -2.0e-21, \"eps_AB\": -2.2e-21,\n            \"n_AB\": 126000\n        },\n        {\n            \"N\": 100000, \"z\": 6, \"T\": 400, \"phi_B\": 0.3,\n            \"eps_AA\": -2.5e-21, \"eps_BB\": -2.0e-21, \"eps_AB\": -2.2e-21,\n            \"n_AB\": 113400\n        },\n        {\n            \"N\": 200000, \"z\": 6, \"T\": 298, \"phi_B\": 0.02,\n            \"eps_AA\": -2.0e-21, \"eps_BB\": -2.0e-21, \"eps_AB\": -2.2e-21,\n            \"n_AB\": 23520\n        },\n        {\n            \"N\": 100000, \"z\": 6, \"T\": 800, \"phi_B\": 0.3,\n            \"eps_AA\": -2.5e-21, \"eps_BB\": -2.0e-21, \"eps_AB\": -2.2e-21,\n            \"n_AB\": 126000\n        }\n    ]\n\n    results = []\n    \n    # Formula for chi_eff:\n    # chi_eff = (n_AB / (N * phi_A * phi_B)) * (eps_AB - (eps_AA + eps_BB) / 2) / (k_B * T)\n\n    for case in test_cases:\n        N = case[\"N\"]\n        T = case[\"T\"]\n        phi_B = case[\"phi_B\"]\n        eps_AA = case[\"eps_AA\"]\n        eps_BB = case[\"eps_BB\"]\n        eps_AB = case[\"eps_AB\"]\n        n_AB = case[\"n_AB\"]\n\n        # Calculate volume fraction of A\n        phi_A = 1.0 - phi_B\n\n        # Calculate the exchange energy\n        delta_eps = eps_AB - (eps_AA + eps_BB) / 2.0\n\n        # Calculate the thermal energy\n        k_B_T = k_B * T\n\n        # Calculate the prefactor related to contact numbers\n        contact_prefactor = n_AB / (N * phi_A * phi_B)\n        \n        # Calculate the effective interaction parameter\n        chi_eff = contact_prefactor * delta_eps / k_B_T\n        \n        results.append(chi_eff)\n\n    # Format the results for output\n    # Each result is rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2641153"}]}