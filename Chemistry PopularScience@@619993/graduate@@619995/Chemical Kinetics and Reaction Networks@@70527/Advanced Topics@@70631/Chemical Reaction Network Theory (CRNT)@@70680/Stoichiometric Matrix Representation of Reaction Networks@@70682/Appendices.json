{"hands_on_practices": [{"introduction": "The first step in analyzing any reaction network is to translate its chemistry into a precise mathematical object. This exercise guides you through the foundational process of constructing the stoichiometric matrix, $N$. You will practice converting a list of reactions into the columns of the matrix and justify the essential convention of splitting reversible reactions, which ensures that the reaction rate vector is componentwise non-negative and thus physically meaningful [@problem_id:2679078].", "problem": "Consider a well-mixed isothermal reaction network involving $3$ chemical species $\\{A,B,C\\}$ in a constant volume reactor. The network consists of the following reactions at fixed temperature, each following the law of mass-action kinetics:\n\n(i) $A + B \\rightleftharpoons C$,\n\n(ii) $C \\rightleftharpoons B$,\n\n(iii) $B \\to A$.\n\nTo represent the network using a stoichiometric matrix, adopt the convention that each reversible reaction is represented as two distinct irreversible reactions, one in the forward direction and one in the backward direction. Let the species ordering be $(A,B,C)$ and choose the reaction ordering to be ($R_{1}^{+}: A+B \\to C$, $R_{1}^{-}: C \\to A+B$, $R_{2}^{+}: C \\to B$, $R_{2}^{-}: B \\to C$, $R_{3}: B \\to A$).\n\nUse only the following fundamental base:\n\n- The stoichiometric matrix $N$ has entries $N_{i j} = \\nu_{i j}^{\\text{prod}} - \\nu_{i j}^{\\text{reac}}$, where $\\nu_{i j}^{\\text{prod}}$ and $\\nu_{i j}^{\\text{reac}}$ are the stoichiometric coefficients of species $i$ as product and reactant in reaction $j$, respectively.\n- Under mass-action kinetics, the reaction rate for an irreversible reaction $j$ is $v_{j}(\\boldsymbol{x}) = k_{j} \\prod_{i} x_{i}^{\\nu_{i j}^{\\text{reac}}}$ with $k_{j} \\ge 0$ and $x_{i} \\ge 0$, and the species dynamics satisfy $\\frac{d\\boldsymbol{x}}{dt} = N \\boldsymbol{v}(\\boldsymbol{x})$.\n- A reversible reaction written as a single net step may be conceived as the difference of two nonnegative one-way rates, which motivates the splitting into two irreversible reactions so that each column of $N$ is paired with a nonnegative scalar flux.\n\nTasks:\n\n(a) Construct the stoichiometric matrix $N \\in \\mathbb{R}^{3 \\times 5}$ for the network under the stated convention and orderings. Show each column as the net stoichiometric change vector for the corresponding irreversible reaction.\n\n(b) Justify, from first principles and the given base, why splitting a reversible reaction into two irreversible reactions is essential for a representation in which the reaction rate vector $\\boldsymbol{v}(\\boldsymbol{x})$ is componentwise nonnegative and the dynamics $\\frac{d\\boldsymbol{x}}{dt} = N \\boldsymbol{v}(\\boldsymbol{x})$ hold with physically interpretable one-way fluxes. Your justification should explain how signs are handled in $N$ and why nonnegativity of $\\boldsymbol{v}(\\boldsymbol{x})$ would be violated if a single net reversible step were used as one column.\n\n(c) Compute the dimension of the right nullspace of $N$, that is, $\\dim(\\ker N)$. Provide this single integer as your final answer. No rounding is needed and no units are required.", "solution": "The problem is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard exercise in chemical reaction network theory, providing all necessary definitions and constraints for a unique and verifiable solution. Therefore, the problem is valid.\n\n(a) Construction of the Stoichiometric Matrix $N$.\nThe system involves $3$ species, ordered as $(A,B,C)$, and $5$ irreversible reactions ordered as ($R_{1}^{+}: A+B \\to C$, $R_{1}^{-}: C \\to A+B$, $R_{2}^{+}: C \\to B$, $R_{2}^{-}: B \\to C$, $R_{3}: B \\to A$). The stoichiometric matrix $N$ is an element of $\\mathbb{R}^{3 \\times 5}$, where the rows correspond to the species and the columns to the reactions. Each entry $N_{ij}$ is the net change in the amount of species $i$ due to reaction $j$, calculated as $N_{i j} = \\nu_{i j}^{\\text{prod}} - \\nu_{i j}^{\\text{reac}}$.\n\nWe construct the matrix column by column. Each column is a vector representing the net stoichiometric change for its corresponding reaction.\n\nFor a species vector $\\boldsymbol{x} = [x_A, x_B, x_C]^T$, the change vectors are:\n1.  Reaction $R_1^{+}: A + B \\to C$. The stoichiometric coefficients as reactants are $\\nu_{A,1}^{\\text{reac}} = 1$, $\\nu_{B,1}^{\\text{reac}} = 1$, $\\nu_{C,1}^{\\text{reac}} = 0$. The coefficients as products are $\\nu_{A,1}^{\\text{prod}} = 0$, $\\nu_{B,1}^{\\text{prod}} = 0$, $\\nu_{C,1}^{\\text{prod}} = 1$. The first column of $N$ is therefore $\\boldsymbol{n}_1 = [\\nu_{A,1}^{\\text{prod}}-\\nu_{A,1}^{\\text{reac}}, \\nu_{B,1}^{\\text{prod}}-\\nu_{B,1}^{\\text{reac}}, \\nu_{C,1}^{\\text{prod}}-\\nu_{C,1}^{\\text{reac}}]^T = [0-1, 0-1, 1-0]^T = [-1, -1, 1]^T$.\n\n2.  Reaction $R_1^{-}: C \\to A + B$. The coefficients are $\\nu_{A,2}^{\\text{reac}}=0$, $\\nu_{B,2}^{\\text{reac}}=0$, $\\nu_{C,2}^{\\text{reac}}=1$ and $\\nu_{A,2}^{\\text{prod}}=1$, $\\nu_{B,2}^{\\text{prod}}=1$, $\\nu_{C,2}^{\\text{prod}}=0$. The second column is $\\boldsymbol{n}_2 = [1-0, 1-0, 0-1]^T = [1, 1, -1]^T$.\n\n3.  Reaction $R_2^{+}: C \\to B$. The coefficients are $\\nu_{A,3}^{\\text{reac}}=0$, $\\nu_{B,3}^{\\text{reac}}=0$, $\\nu_{C,3}^{\\text{reac}}=1$ and $\\nu_{A,3}^{\\text{prod}}=0$, $\\nu_{B,3}^{\\text{prod}}=1$, $\\nu_{C,3}^{\\text{prod}}=0$. The third column is $\\boldsymbol{n}_3 = [0-0, 1-0, 0-1]^T = [0, 1, -1]^T$.\n\n4.  Reaction $R_2^{-}: B \\to C$. The coefficients are $\\nu_{A,4}^{\\text{reac}}=0$, $\\nu_{B,4}^{\\text{reac}}=1$, $\\nu_{C,4}^{\\text{reac}}=0$ and $\\nu_{A,4}^{\\text{prod}}=0$, $\\nu_{B,4}^{\\text{prod}}=0$, $\\nu_{C,4}^{\\text{prod}}=1$. The fourth column is $\\boldsymbol{n}_4 = [0-0, 0-1, 1-0]^T = [0, -1, 1]^T$.\n\n5.  Reaction $R_3: B \\to A$. The coefficients are $\\nu_{A,5}^{\\text{reac}}=0$, $\\nu_{B,5}^{\\text{reac}}=1$, $\\nu_{C,5}^{\\text{reac}}=0$ and $\\nu_{A,5}^{\\text{prod}}=1$, $\\nu_{B,5}^{\\text{prod}}=0$, $\\nu_{C,5}^{\\text{prod}}=0$. The fifth column is $\\boldsymbol{n}_5 = [1-0, 0-1, 0-0]^T = [1, -1, 0]^T$.\n\nCombining these column vectors, we obtain the stoichiometric matrix $N$:\n$$\nN = \\begin{pmatrix}\n-1 & 1 & 0 & 0 & 1 \\\\\n-1 & 1 & 1 & -1 & -1 \\\\\n1 & -1 & -1 & 1 & 0\n\\end{pmatrix}\n$$\n\n(b) Justification for Splitting Reversible Reactions.\nThe representation of reaction network dynamics as $\\frac{d\\boldsymbol{x}}{dt} = N \\boldsymbol{v}(\\boldsymbol{x})$ is fundamentally based on the principle that each elementary process has a corresponding one-way flux, or rate, that is inherently non-negative. This is reflected in the structure of the rate vector $\\boldsymbol{v}(\\boldsymbol{x})$, where each component $v_j(\\boldsymbol{x})$ must be greater than or equal to zero.\n\nThe law of mass-action kinetics for an irreversible reaction $j$ is given by $v_j(\\boldsymbol{x}) = k_j \\prod_{i} x_i^{\\nu_{ij}^{\\text{reac}}}$. Since the rate constant $k_j$ and species concentrations $x_i$ are non-negative quantities, the resulting rate $v_j(\\boldsymbol{x})$ is also non-negative. Each $v_j(\\boldsymbol{x})$ represents the number of reaction events per unit time per unit volume, a quantity which cannot be negative.\n\nNow, consider a reversible reaction, for example, $A+B \\rightleftharpoons C$. This process is physically the result of two opposing elementary reactions: a forward reaction $A+B \\to C$ with rate $v^+ = k^+ x_A x_B$, and a backward reaction $C \\to A+B$ with rate $v^- = k^- x_C$. The *net rate* of conversion is $v_{net} = v^+ - v^- = k^+ x_A x_B - k^- x_C$.\n\nIf we attempted to represent this reversible reaction with a single column in the stoichiometric matrix, say $\\boldsymbol{n}_{net} = [-1, -1, 1]^T$ corresponding to the net consumption of $A$ and $B$ to produce $C$, the corresponding entry in the rate vector would have to be $v_{net}$. However, the sign of $v_{net}$ depends on the relative magnitudes of $v^+$ and $v^-$, which in turn depend on the species concentrations. The value $v_{net}$ can be positive, negative, or zero. A negative value for a component of the rate vector $\\boldsymbol{v}(\\boldsymbol{x})$ would violate the fundamental premise of the model, which interprets $v_j$ as a non-negative one-way flux. The signs, indicating the direction of species change, are meant to be encoded exclusively within the stoichiometric matrix $N$, not in the rate vector $\\boldsymbol{v}(\\boldsymbol{x})$.\n\nSplitting the reversible reaction into two irreversible steps resolves this contradiction. We define two separate reactions, $R_1^+: A+B \\to C$ and $R_1^-: C \\to A+B$. Their corresponding rates, $v_1^+(\\boldsymbol{x}) = k_1^+ x_A x_B$ and $v_1^-(\\boldsymbol{x}) = k_1^- x_C$, are both non-negative. The stoichiometric vectors are $\\boldsymbol{n}_{1} = [-1, -1, 1]^T$ and $\\boldsymbol{n}_{2} = [1, 1, -1]^T = -\\boldsymbol{n}_1$. The total contribution of this reaction pair to the system dynamics is $\\boldsymbol{n}_1 v_1^+(\\boldsymbol{x}) + \\boldsymbol{n}_2 v_1^-(\\boldsymbol{x}) = \\boldsymbol{n}_1 v_1^+(\\boldsymbol{x}) - \\boldsymbol{n}_1 v_1^-(\\boldsymbol{x}) = \\boldsymbol{n}_1(v_1^+(\\boldsymbol{x}) - v_1^-(\\boldsymbol{x})) = \\boldsymbol{n}_1 v_{net}(\\boldsymbol{x})$. This formulation correctly captures the net chemical change while preserving the componentwise non-negativity of the rate vector $\\boldsymbol{v}(\\boldsymbol{x}) = [v_1^+, v_1^-, \\dots]^T$. This ensures that the mathematical framework is consistent with the physical interpretation of reaction rates as non-negative fluxes.\n\n(c) Computation of the Dimension of the Right Nullspace of $N$.\nThe dimension of the right nullspace of $N$, denoted $\\dim(\\ker N)$, is also known as the nullity of $N$. According to the rank-nullity theorem, for a matrix with $m$ columns, its rank and nullity sum to $m$: $\\text{rank}(N) + \\dim(\\ker N) = m$.\nIn our case, the matrix $N$ has $m=5$ columns. Thus, $\\dim(\\ker N) = 5 - \\text{rank}(N)$. To find $\\dim(\\ker N)$, we must first compute the rank of $N$. We can do this by reducing $N$ to its row echelon form using Gaussian elimination.\n\nThe matrix is:\n$$\nN = \\begin{pmatrix}\n-1 & 1 & 0 & 0 & 1 \\\\\n-1 & 1 & 1 & -1 & -1 \\\\\n1 & -1 & -1 & 1 & 0\n\\end{pmatrix}\n$$\nLet the rows be $R_1$, $R_2$, and $R_3$.\nStep 1: Perform the operation $R_2 \\leftarrow R_2 - R_1$.\n$$\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & -1 & -2 \\\\\n1 & -1 & -1 & 1 & 0\n\\end{pmatrix}\n$$\nStep 2: Perform the operation $R_3 \\leftarrow R_3 + R_1$.\n$$\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & -1 & -2 \\\\\n0 & 0 & -1 & 1 & 1\n\\end{pmatrix}\n$$\nStep 3: Perform the operation $R_3 \\leftarrow R_3 + R_2$.\n$$\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & -1 & -2 \\\\\n0 & 0 & 0 & 0 & -1\n\\end{pmatrix}\n$$\nThe matrix is now in row echelon form. We can identify the number of non-zero rows, which is equal to the rank of the matrix. There are $3$ non-zero rows. Therefore, $\\text{rank}(N) = 3$.\n\nUsing the rank-nullity theorem, we find the dimension of the kernel:\n$$\n\\dim(\\ker N) = 5 - \\text{rank}(N) = 5 - 3 = 2\n$$\nThe dimension of the right nullspace of the stoichiometric matrix $N$ is $2$. These nullspace vectors correspond to steady-state flux vectors $\\boldsymbol{v}_{ss}$ for which $N\\boldsymbol{v}_{ss} = \\boldsymbol{0}$, meaning the net production of all species is zero. The two basis vectors of this nullspace correspond to the two reversible reaction pairs, $R_1$ and $R_2$, operating at a net zero flux (i.e., forward rate equals backward rate).", "answer": "$$\n\\boxed{2}\n$$", "id": "2679078"}, {"introduction": "Beyond simply encoding reaction stoichiometries, the algebraic structure of the matrix $N$ reveals deep physical principles governing the network, such as conservation laws. This practice challenges you to use the matrix to verify or falsify an asserted conserved quantity, a quantity represented by a linear combination of species concentrations $y^{\\top} x$. Mastering this test, which connects a physical invariant to the left nullspace of $N$ (i.e., vectors $y$ satisfying $y^{\\top} N = \\mathbf{0}^{\\top}$), is a fundamental skill for identifying constraints on a system's dynamics [@problem_id:2679141].", "problem": "Consider a closed reaction network with $m$ chemical species and $r$ reactions, with concentration vector $x(t) \\in \\mathbb{R}_{\\ge 0}^{m}$ governed by an ordinary differential equation (ODE) of the form $\\frac{dx}{dt} = N \\, v(x)$, where $N \\in \\mathbb{R}^{m \\times r}$ is the stoichiometric matrix and $v(x) \\in \\mathbb{R}_{\\ge 0}^{r}$ is the vector of reaction rates consistent with the network. A linear conserved total is an asserted invariant of the form $y^{\\top} x(t)$ for a fixed coefficient vector $y \\in \\mathbb{R}^{m}$.\n\nStarting from first principles, explain how to test whether a given asserted conserved total $y^{\\top} x$ is implied by the stoichiometric matrix $N$ (meaning that it is invariant for all permissible reaction rate functions consistent with $N$). If the asserted conserved total is not implied by $N$, provide a certificate demonstrating its failure.\n\nConcretely, analyze the network with $m=4$ species and $r=5$ reactions having stoichiometric matrix\n$$\nN \\;=\\;\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & -2 \\\\\n-2 & 1 & 1 & -1 & 0 \\\\\n1 & -1 & 0 & 0 & 0 \\\\\n0 & 0 & -1 & 1 & 1\n\\end{pmatrix},\n$$\nwhose columns are the stoichiometric change vectors $n_{1},\\dots,n_{5}$, and the asserted conserved total with coefficient vector\n$$\ny \\;=\\; \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\nIf the asserted conserved total is not implied by $N$, use the following notion of certificate: choose the smallest reaction index $j^{\\star} \\in \\{1,2,3,4,5\\}$ such that $y^{\\top} n_{j^{\\star}} \\neq 0$ and report the scalar $y^{\\top} n_{j^{\\star}}$.\n\nExpress the final answer as an exact integer equal to $y^{\\top} n_{j^{\\star}}$.", "solution": "The problem asks for a validation of an asserted conserved total in a chemical reaction network, grounded in the properties of the stoichiometric matrix. This is a fundamental exercise in chemical kinetics and systems theory. We will first establish the general principle and then apply it to the specific case provided.\n\nA quantity is conserved if and only if its rate of change over time is identically zero. The asserted conserved total is the linear combination of concentrations $C(t) = y^{\\top}x(t)$, where $y \\in \\mathbb{R}^{m}$ is a fixed vector of coefficients and $x(t) \\in \\mathbb{R}_{\\ge 0}^{m}$ is the time-varying vector of species concentrations.\n\nThe time evolution of the concentration vector is given by the ordinary differential equation $\\frac{dx}{dt} = N v(x)$, where $N \\in \\mathbb{R}^{m \\times r}$ is the stoichiometric matrix and $v(x) \\in \\mathbb{R}_{\\ge 0}^{r}$ is the vector of reaction rates.\n\nTo test for conservation, we differentiate $C(t)$ with respect to time $t$:\n$$\n\\frac{dC(t)}{dt} = \\frac{d}{dt} \\left( y^{\\top} x(t) \\right)\n$$\nSince $y$ is a constant vector, we can apply the product rule for differentiation of vector quantities:\n$$\n\\frac{dC(t)}{dt} = y^{\\top} \\frac{dx(t)}{dt}\n$$\nNow, we substitute the governing differential equation for the reaction network:\n$$\n\\frac{dC(t)}{dt} = y^{\\top} \\left( N v(x) \\right) = \\left( y^{\\top} N \\right) v(x)\n$$\nThe problem demands that the conserved total be \"implied by the stoichiometric matrix $N$\". This means the conservation must hold for *all* permissible, non-negative reaction rate functions $v(x)$. The expression $(y^{\\top} N) v(x)$ is a scalar product between the row vector $y^{\\top} N$ and the column vector $v(x)$. For this product to be zero for any arbitrary vector $v(x)$ with non-negative components, it is a necessary and sufficient condition that the constant vector multiplying it must be the zero vector.\n\nTherefore, the condition for $y^{\\top} x$ to be a conserved total is:\n$$\ny^{\\top} N = \\mathbf{0}^{\\top}\n$$\nwhere $\\mathbf{0}^{\\top}$ is the zero row vector of dimension $r$. In the language of linear algebra, this means the vector $y$ must lie in the left null space of the matrix $N$, i.e., $y \\in \\ker(N^{\\top})$.\n\nIf $y^{\\top} N \\neq \\mathbf{0}^{\\top}$, then the asserted total is not conserved for all possible kinetics. There must be at least one reaction $j$ such that the $j$-th component of the row vector $y^{\\top}N$ is non-zero. This component is calculated as $y^{\\top}n_j$, where $n_j$ is the $j$-th column of $N$. A non-zero value $y^{\\top}n_j \\neq 0$ serves as a \"certificate of failure,\" because if we imagine a scenario where only reaction $j$ proceeds (i.e., $v_j(x) > 0$ and $v_k(x) = 0$ for all $k \\neq j$), the rate of change of the asserted total would be $\\frac{dC}{dt} = (y^{\\top} n_j) v_j(x) \\neq 0$.\n\nWe now apply this formal test to the given problem. We are provided with:\n$$\nN \\;=\\;\n\\begin{pmatrix}\n-1 & 1 & 0 & 0 & -2 \\\\\n-2 & 1 & 1 & -1 & 0 \\\\\n1 & -1 & 0 & 0 & 0 \\\\\n0 & 0 & -1 & 1 & 1\n\\end{pmatrix}\n\\quad \\text{and} \\quad\ny \\;=\\; \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nWe must compute the product $y^{\\top}N$ and check if it equals the zero vector. The transpose of $y$ is $y^{\\top} = \\begin{pmatrix} 1 & 2 & 0 & 1 \\end{pmatrix}$.\n\nThe columns of $N$ are denoted $n_1, n_2, n_3, n_4, n_5$. We are instructed to find the smallest reaction index $j^{\\star} \\in \\{1,2,3,4,5\\}$ such that $y^{\\top} n_{j^{\\star}} \\neq 0$ and report this non-zero value. We proceed sequentially.\n\nFor $j=1$:\nThe stoichiometric vector for the first reaction is $n_1 = \\begin{pmatrix} -1 & -2 & 1 & 0 \\end{pmatrix}^{\\top}$. We compute the inner product:\n$$\ny^{\\top} n_1 = \\begin{pmatrix} 1 & 2 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -2 \\\\ 1 \\\\ 0 \\end{pmatrix} = (1)(-1) + (2)(-2) + (0)(1) + (1)(0) = -1 - 4 + 0 + 0 = -5\n$$\nThe result is $-5$, which is not equal to $0$. Thus, the condition for conservation is violated. The asserted conserved total is not an invariant of the system.\n\nAccording to the problem's definition for the certificate of failure, we have found the smallest index $j^{\\star}=1$ where the condition fails. The value to be reported is $y^{\\top} n_{j^{\\star}}$. For $j^{\\star}=1$, this value is $-5$.", "answer": "$$\\boxed{-5}$$", "id": "2679141"}, {"introduction": "A powerful application of reaction network theory is to determine if a network is \"stoichiometrically consistent,\" meaning it admits a conservation law where all contributing species can have positive mass. This advanced exercise bridges theory and computation by tasking you with formulating this consistency test as a Linear Program (LP). By deriving and implementing this LP, you will gain hands-on experience with a robust technique for analyzing the fundamental physical viability of complex biochemical models [@problem_id:2679061].", "problem": "You are given the task of testing stoichiometric consistency of reaction networks using the stoichiometric matrix representation. Let the stoichiometric matrix be denoted by $N \\in \\mathbb{R}^{m \\times r}$, where $m$ is the number of species and $r$ is the number of reactions. By definition, the entry $N_{ij}$ is the net stoichiometric coefficient of species $i$ in reaction $j$ (products minus reactants). A network is stoichiometrically consistent if there exists a strictly positive vector of species masses $w \\in \\mathbb{R}_{>0}^{m}$ such that $w^{\\top} N = 0^{\\top}$. Equivalently, there exists $m \\in \\mathbb{R}_{>0}^{m}$ such that $N^{\\top} m = 0$.\n\nStarting from the fundamental law of conservation of mass (mass is neither created nor destroyed) and the definition of the stoichiometric matrix, derive a decision procedure that reduces the consistency test to a single Linear Program (Linear Programming (LP) problem). The derivation must not use any pre-packaged formula for the decision; it must be obtained from first principles. Your LP must decide whether there exists a strictly positive vector $m \\in \\mathbb{R}_{>0}^{m}$ satisfying $N^{\\top} m = 0$. To avoid the trivial scaling ambiguity in $m$, incorporate a normalization constraint. To enforce strict positivity via a linear model, introduce an auxiliary scalar $t \\in \\mathbb{R}$ and design the LP so that maximizing $t$ pushes all entries of $m$ away from zero.\n\nYour program must implement the LP you derive and return, for each test matrix $N$, the computed optimal value $t^{\\star}$, interpreted as follows:\n- If the LP is infeasible, return $-1.000000$.\n- If the LP is feasible, return the optimal value $t^{\\star}$ rounded to six decimal places. In this construction, the network is stoichiometrically consistent if and only if $t^{\\star} > 0$; if $t^{\\star} = 0$, the LP is feasible but no strictly positive conservation vector exists, which indicates inconsistency because at least one species would be forced to have zero mass.\n\nYour implementation must solve the LP numerically for each test case and output the results in a single line as a comma-separated list enclosed in square brackets.\n\nTest suite:\n- Case $1$ (strongly consistent reversible pair with two species):\n  $$N_1 = \\begin{bmatrix} -1 & 1 \\\\ 1 & -1 \\end{bmatrix}.$$\n- Case $2$ (feasible with $t^{\\star} = 0$ due to a reaction that creates mass in one species):\n  $$N_2 = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}.$$\n- Case $3$ (infeasible because $N^{\\top} m = 0$ forces $m = 0$):\n  $$N_3 = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}.$$\n- Case $4$ (three-species reversible associationâ€“dissociation system):\n  $$N_4 = \\begin{bmatrix} -1 & 1 \\\\ -1 & 1 \\\\ 1 & -1 \\end{bmatrix}.$$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[$x_1,x_2,x_3,x_4$]\").\n- Each numeric entry must be a floating-point number rounded to six decimal places.\n- Use the exact numeric sentinel $-1.000000$ to denote an infeasible LP.\n\nNo physical units are required for this problem. All angles, if any, must be in radians, but none are involved here. No percentages are involved; all numeric outputs must be decimals. The answer must be fully determined by the given matrices and the LP you derive, and your program must not read any input.", "solution": "The problem requires the derivation and implementation of a decision procedure to test for stoichiometric consistency in a chemical reaction network. A network is defined as stoichiometrically consistent if there exists a vector of strictly positive species masses, which we shall denote as a column vector $m \\in \\mathbb{R}_{>0}^{m}$, that is conserved across all reactions. The procedure must be formulated as a single Linear Programming (LP) problem derived from the fundamental principle of mass conservation.\n\nLet the set of chemical species be $\\{S_1, S_2, \\ldots, S_m\\}$ and the set of reactions be $\\{R_1, R_2, \\ldots, R_r\\}$. The structure of the network is encoded in the stoichiometric matrix $N \\in \\mathbb{R}^{m \\times r}$, where the entry $N_{ij}$ represents the net change in the quantity of species $S_i$ due to one occurrence of reaction $R_j$.\n\nThe foundational principle is the law of conservation of mass. For any given reaction $R_j$, the total mass of the reactants must equal the total mass of the products. Let $m = [m_1, m_2, \\ldots, m_m]^{\\top}$ be the column vector of molecular masses for species $S_1, \\ldots, S_m$. Since mass must be a positive physical quantity, we require $m_i > 0$ for all $i=1, \\ldots, m$. The net change in total mass for reaction $R_j$ is given by $\\sum_{i=1}^{m} N_{ij} m_i$. For mass to be conserved, this change must be zero for every reaction $j=1, \\ldots, r$.\nThis gives a system of $r$ linear equations:\n$$ \\sum_{i=1}^{m} N_{ij} m_i = 0 \\quad \\text{for } j=1, \\ldots, r $$\nThis system can be expressed in matrix form. The term $\\sum_{i=1}^{m} N_{ij} m_i$ is the $j$-th element of the product of the transposed stoichiometric matrix $N^{\\top} \\in \\mathbb{R}^{r \\times m}$ and the mass vector $m \\in \\mathbb{R}^{m \\times 1}$. Thus, the condition for mass conservation across all reactions is:\n$$ N^{\\top} m = 0 $$\nwhere $0$ is the zero vector in $\\mathbb{R}^r$.\n\nThe problem of determining stoichiometric consistency is therefore equivalent to establishing the existence of a vector $m$ that satisfies the following two conditions:\n1.  $N^{\\top} m = 0$ (Conservation of mass)\n2.  $m_i > 0$ for all $i=1, \\ldots, m$ (Strict positivity of masses)\n\nWe must formulate this existence problem as a Linear Program. A standard LP formulation involves linear equality and non-strict inequality constraints ($ \\leq $ or $ \\geq $), but not strict inequalities ($ > $). To address the condition $m_i > 0$, we introduce an auxiliary scalar variable $t \\in \\mathbb{R}$ and impose the set of non-strict inequalities $m_i \\geq t$ for all $i$. If we then maximize $t$ and find an optimal solution $(m^{\\star}, t^{\\star})$ where $t^{\\star} > 0$, it directly implies that $m_i^{\\star} \\geq t^{\\star} > 0$ for all $i$, satisfying the strict positivity requirement.\n\nThe preliminary LP formulation is therefore:\n$$ \\text{maximize } t $$\n$$ \\text{subject to:} $$\n$$ N^{\\top} m = 0 $$\n$$ m_i \\geq t \\quad \\text{for } i=1, \\ldots, m $$\n\nThis formulation is deficient because the objective function $t$ is unbounded. If a solution $(m, t)$ with $t>0$ exists, then for any positive scalar $\\alpha > 0$, the scaled vector $(\\alpha m, \\alpha t)$ is also a valid solution. By choosing an arbitrarily large $\\alpha$, we can make the objective function value $\\alpha t$ arbitrarily large. This scaling ambiguity arises because the equation $N^{\\top}m=0$ is homogeneous.\n\nTo rectify this, we must introduce a normalization constraint on the vector $m$. Since we are searching for a strictly positive vector $m$, its components sum to a positive value. We can, without loss of generality, normalize this sum to unity. If a solution $m^*$ exists, then the vector $m' = m^* / (\\sum_{i=1}^m m_i^*)$ also satisfies $N^{\\top}m'=0$ and has components that sum to $1$. The normalization constraint is:\n$$ \\sum_{i=1}^{m} m_i = 1 $$\nAdditionally, since masses cannot be negative, we must enforce the constraint $m_i \\geq 0$ for all $i$. While the condition $m_i \\geq t$ combined with a search for $t > 0$ would imply positivity, explicitly adding $m_i \\geq 0$ makes the feasible set more constrained and is physically correct.\n\nThe final, complete Linear Programming formulation is as follows:\n\n-   **Variables**: A column vector $x = [m_1, \\ldots, m_m, t]^{\\top} \\in \\mathbb{R}^{m+1}$.\n-   **Objective**: Maximize $t$. This is equivalent to minimizing $-t$. Thus, the objective function is $c^{\\top}x$ with $c = [0, \\ldots, 0, -1]^{\\top}$.\n-   **Constraints**:\n    1.  **Mass Conservation**: $N^{\\top}m = 0$. This is a set of $r$ linear equality constraints.\n    2.  **Normalization**: $\\sum_{i=1}^{m} m_i = 1$. This is one linear equality constraint.\n    3.  **Positivity Enforcement**: $m_i \\geq t$ for all $i=1, \\ldots, m$. These can be rewritten as $t - m_i \\leq 0$. This is a set of $m$ linear inequality constraints.\n    4.  **Physical Bounds**: $m_i \\geq 0$ for all $i=1, \\ldots, m$. The variable $t$ is unbounded, $t \\in (-\\infty, \\infty)$.\n\nThe solution of this LP determines stoichiometric consistency:\n-   If the LP is feasible and the optimal value is $t^{\\star} > 0$, a strictly positive mass vector $m$ exists. The network is stoichiometrically consistent.\n-   If the LP is feasible and the optimal value is $t^{\\star} = 0$, a non-negative mass vector $m$ (with at least one zero component) exists, but no strictly positive one does. The network is not stoichiometrically consistent.\n-   If the LP is infeasible, no non-negative mass vector satisfying the conservation and normalization constraints exists. The network is not stoichiometrically consistent.\n\nThis LP formulation provides a rigorous decision procedure derived from first principles. It will now be implemented to analyze the provided test cases.", "answer": "[0.500000,0.000000,-1.000000,0.250000]", "id": "2679061"}]}