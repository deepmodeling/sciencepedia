{"hands_on_practices": [{"introduction": "The isotropic harmonic oscillator is a cornerstone of quantum mechanics, providing exact solutions that serve as a foundation for understanding more complex systems. This exercise will guide you through a fundamental demonstration of two powerful theorems. You will first use the Heisenberg equation of motion to derive the virial relation for this system, which connects the average kinetic energy $\\langle T \\rangle$ to the average potential energy $\\langle V \\rangle$. Then, by applying the Hellmann-Feynman theorem, you will explicitly calculate these expectation values, confirming the virial relation and deepening your understanding of how energy derivatives relate to system properties [@problem_id:2930792].", "problem": "Consider a nonrelativistic particle of mass $m$ in three spatial dimensions subject to an isotropic harmonic confining potential. The Hamiltonian is\n$$\n\\hat{H} \\;=\\; \\hat{T} + \\hat{V} \\;=\\; \\frac{\\hat{\\boldsymbol{p}}^{2}}{2m} \\;+\\; \\frac{1}{2} m \\omega^{2} \\hat{\\boldsymbol{r}}^{2},\n$$\nwhere $\\hat{\\boldsymbol{r}}=(\\hat{x},\\hat{y},\\hat{z})$, $\\hat{\\boldsymbol{p}}=(\\hat{p}_{x},\\hat{p}_{y},\\hat{p}_{z})$, and the canonical commutation relations are $[\\hat{x}_{i},\\hat{p}_{j}]= i\\hbar \\delta_{ij}$. Let $\\lvert n_{x},n_{y},n_{z}\\rangle$ denote a stationary energy eigenstate with energy $E_{n_{x},n_{y},n_{z}}=\\hbar \\omega \\big(n_{x}+n_{y}+n_{z}+\\frac{3}{2}\\big)$, where $n_{x},n_{y},n_{z}\\in\\{0,1,2,\\dots\\}$.\n\nStarting from the time-independent Schrödinger equation $\\hat{H}\\lvert \\psi \\rangle = E \\lvert \\psi \\rangle$ and the canonical commutation relations (and without assuming any virial result a priori), derive the virial relation specialized to this system, and use it to establish, for any stationary state, the equality of the expectation values $\\langle \\hat{T} \\rangle = \\langle \\hat{V} \\rangle$. Then, using only fundamental principles and well-tested theorems such as the Heisenberg equation of motion and the Hellmann-Feynman theorem, compute the explicit value of $\\langle \\hat{T} \\rangle$ in terms of $\\hbar$, $\\omega$, and the quantum numbers $n_{x},n_{y},n_{z}$.\n\nProvide your final answer as a single closed-form analytic expression for $\\langle \\hat{T} \\rangle$ in terms of $\\hbar$, $\\omega$, $n_{x}$, $n_{y}$, and $n_{z}$. Do not include units in the final boxed answer.", "solution": "The problem as stated is well-posed, scientifically sound, and internally consistent. It poses a standard, albeit fundamental, question in quantum mechanics concerning the properties of the isotropic harmonic oscillator. We shall proceed with a rigorous derivation based on first principles.\n\nThe task is partitioned into two parts. First, we must derive the virial relation for the specified system, which is $\\langle \\hat{T} \\rangle = \\langle \\hat{V} \\rangle$ for any stationary state. Second, we must compute the explicit value of the expectation value of the kinetic energy, $\\langle \\hat{T} \\rangle$.\n\nTo derive the virial relation, we consider an arbitrary operator $\\hat{A}$ and a stationary state $\\lvert \\psi \\rangle$, which is an eigenstate of the Hamiltonian $\\hat{H}$ with energy $E$. The expectation value $\\langle \\hat{A} \\rangle = \\langle \\psi \\lvert \\hat{A} \\rvert \\psi \\rangle$ for a stationary state must be constant in time. According to the Heisenberg equation of motion, the time derivative of the expectation value is given by $\\frac{d}{dt}\\langle \\hat{A} \\rangle = \\frac{1}{i\\hbar}\\langle [\\hat{A}, \\hat{H}] \\rangle$. For a stationary state, this time derivative is zero, which implies $\\langle [\\hat{A}, \\hat{H}] \\rangle = 0$.\n\nWe select the specific operator $\\hat{A} = \\hat{\\boldsymbol{r}} \\cdot \\hat{\\boldsymbol{p}} = \\sum_{k=1}^{3} \\hat{x}_{k} \\hat{p}_{k}$. The condition for a stationary state is thus $\\langle [\\sum_{k} \\hat{x}_{k} \\hat{p}_{k}, \\hat{H}] \\rangle = 0$. Let us compute the commutator.\nThe Hamiltonian is $\\hat{H} = \\hat{T} + \\hat{V} = \\frac{\\hat{\\boldsymbol{p}}^2}{2m} + \\frac{1}{2}m\\omega^2\\hat{\\boldsymbol{r}}^2$. We evaluate the commutator with the kinetic and potential energy terms separately.\nFirst, the kinetic term:\n$$\n\\left[\\sum_{i} \\hat{x}_{i} \\hat{p}_{i}, \\frac{1}{2m}\\sum_{j} \\hat{p}_{j}^{2}\\right] = \\frac{1}{2m} \\sum_{i, j} \\left( \\hat{x}_{i} [\\hat{p}_{i}, \\hat{p}_{j}^{2}] + [\\hat{x}_{i}, \\hat{p}_{j}^{2}] \\hat{p}_{i} \\right)\n$$\nSince $[\\hat{p}_{i}, \\hat{p}_{j}] = 0$, the term $\\hat{x}_{i} [\\hat{p}_{i}, \\hat{p}_{j}^{2}]$ vanishes. We use the identity $[\\hat{A}, \\hat{B}^2] = [\\hat{A}, \\hat{B}]\\hat{B} + \\hat{B}[\\hat{A}, \\hat{B}]$ to evaluate $[\\hat{x}_{i}, \\hat{p}_{j}^{2}]$. With the canonical commutation relation $[\\hat{x}_{i}, \\hat{p}_{j}] = i\\hbar \\delta_{ij}$, we find:\n$$\n[\\hat{x}_{i}, \\hat{p}_{j}^{2}] = [\\hat{x}_{i}, \\hat{p}_{j}]\\hat{p}_{j} + \\hat{p}_{j}[\\hat{x}_{i}, \\hat{p}_{j}] = i\\hbar\\delta_{ij}\\hat{p}_{j} + \\hat{p}_{j}(i\\hbar\\delta_{ij}) = 2i\\hbar\\delta_{ij}\\hat{p}_{j}\n$$\nSubstituting this back into the commutator for the kinetic part:\n$$\n\\frac{1}{2m} \\sum_{i,j} (2i\\hbar\\delta_{ij}\\hat{p}_{j})\\hat{p}_{i} = \\frac{i\\hbar}{m}\\sum_{i} \\hat{p}_{i}^{2} = 2i\\hbar \\left( \\frac{\\hat{\\boldsymbol{p}}^2}{2m} \\right) = 2i\\hbar \\hat{T}\n$$\nNext, we evaluate the commutator with the potential term:\n$$\n\\left[\\sum_{i} \\hat{x}_{i} \\hat{p}_{i}, \\frac{1}{2} m \\omega^{2}\\sum_{j} \\hat{x}_{j}^{2}\\right] = \\frac{1}{2} m\\omega^2 \\sum_{i,j} \\left( \\hat{x}_{i} [\\hat{p}_{i}, \\hat{x}_{j}^{2}] + [\\hat{x}_{i}, \\hat{x}_{j}^{2}] \\hat{p}_{i} \\right)\n$$\nSince $[\\hat{x}_{i}, \\hat{x}_{j}] = 0$, the term $[\\hat{x}_{i}, \\hat{x}_{j}^{2}] \\hat{p}_{i}$ vanishes. We evaluate $[\\hat{p}_{i}, \\hat{x}_{j}^{2}]$:\n$$\n[\\hat{p}_{i}, \\hat{x}_{j}^{2}] = [\\hat{p}_{i}, \\hat{x}_{j}]\\hat{x}_{j} + \\hat{x}_{j}[\\hat{p}_{i}, \\hat{x}_{j}] = (-i\\hbar\\delta_{ij})\\hat{x}_{j} + \\hat{x}_{j}(-i\\hbar\\delta_{ij}) = -2i\\hbar\\delta_{ij}\\hat{x}_{j}\n$$\nSubstituting this into the potential part of the commutator:\n$$\n\\frac{1}{2} m\\omega^2 \\sum_{i,j} \\hat{x}_{i} (-2i\\hbar\\delta_{ij}\\hat{x}_{j}) = -i\\hbar m\\omega^2 \\sum_{i} \\hat{x}_{i}^{2} = -2i\\hbar \\left(\\frac{1}{2}m\\omega^2 \\hat{\\boldsymbol{r}}^2\\right) = -2i\\hbar \\hat{V}\n$$\nCombining the two parts, the full commutator is $[\\hat{\\boldsymbol{r}} \\cdot \\hat{\\boldsymbol{p}}, \\hat{H}] = 2i\\hbar \\hat{T} - 2i\\hbar \\hat{V} = 2i\\hbar(\\hat{T} - \\hat{V})$. The condition for a stationary state, $\\langle [\\hat{\\boldsymbol{r}} \\cdot \\hat{\\boldsymbol{p}}, \\hat{H}] \\rangle = 0$, thus yields $2i\\hbar(\\langle \\hat{T} \\rangle - \\langle \\hat{V} \\rangle) = 0$, which unequivocally proves the virial relation for this system:\n$$\n\\langle \\hat{T} \\rangle = \\langle \\hat{V} \\rangle\n$$\n\nFor the second part of the problem, we must compute the explicit value of $\\langle \\hat{T} \\rangle$. We shall employ the Hellmann-Feynman theorem. This theorem states that for a Hamiltonian $\\hat{H}(\\lambda)$ dependent on a parameter $\\lambda$, the derivative of an energy eigenvalue $E(\\lambda)$ with respect to $\\lambda$ is given by $\\frac{dE(\\lambda)}{d\\lambda} = \\left\\langle \\frac{\\partial \\hat{H}(\\lambda)}{\\partial \\lambda} \\right\\rangle$. We choose the angular frequency $\\omega$ as our parameter $\\lambda$.\nThe given energy eigenvalue is $E(\\omega) = \\hbar \\omega (n_{x}+n_{y}+n_{z}+\\frac{3}{2})$. Its derivative with respect to $\\omega$ is:\n$$\n\\frac{dE}{d\\omega} = \\hbar \\left(n_{x}+n_{y}+n_{z}+\\frac{3}{2}\\right)\n$$\nThe Hamiltonian as a function of $\\omega$ is $\\hat{H}(\\omega) = \\frac{\\hat{\\boldsymbol{p}}^{2}}{2m} + \\frac{1}{2} m \\omega^{2} \\hat{\\boldsymbol{r}}^{2}$. Its partial derivative with respect to $\\omega$ is:\n$$\n\\frac{\\partial \\hat{H}}{\\partial \\omega} = \\frac{\\partial}{\\partial \\omega} \\left(\\frac{1}{2} m \\omega^{2} \\hat{\\boldsymbol{r}}^{2}\\right) = m \\omega \\hat{\\boldsymbol{r}}^{2}\n$$\nApplying the Hellmann-Feynman theorem:\n$$\n\\frac{dE}{d\\omega} = \\left\\langle \\frac{\\partial \\hat{H}}{\\partial \\omega} \\right\\rangle \\implies \\hbar \\left(n_{x}+n_{y}+n_{z}+\\frac{3}{2}\\right) = \\langle m \\omega \\hat{\\boldsymbol{r}}^{2} \\rangle = m\\omega \\langle \\hat{\\boldsymbol{r}}^{2} \\rangle\n$$\nWe can relate this to the expectation value of the potential energy, $\\langle \\hat{V} \\rangle = \\frac{1}{2}m\\omega^2 \\langle \\hat{\\boldsymbol{r}}^2 \\rangle$. From the expression above, we have $m\\omega \\langle \\hat{\\boldsymbol{r}}^{2} \\rangle = \\frac{2}{\\omega} \\langle \\hat{V} \\rangle$.\nTherefore:\n$$\n\\frac{2}{\\omega} \\langle \\hat{V} \\rangle = \\hbar \\left(n_{x}+n_{y}+n_{z}+\\frac{3}{2}\\right)\n$$\nSolving for $\\langle \\hat{V} \\rangle$:\n$$\n\\langle \\hat{V} \\rangle = \\frac{1}{2} \\hbar \\omega \\left(n_{x}+n_{y}+n_{z}+\\frac{3}{2}\\right)\n$$\nFrom the virial relation derived in the first part, we have established that $\\langle \\hat{T} \\rangle = \\langle \\hat{V} \\rangle$ for any stationary state. Consequently, the expectation value of the kinetic energy is:\n$$\n\\langle \\hat{T} \\rangle = \\frac{1}{2} \\hbar \\omega \\left(n_{x}+n_{y}+n_{z}+\\frac{3}{2}\\right)\n$$\nThis result is logical, as the total energy $E = \\langle \\hat{H} \\rangle = \\langle \\hat{T} \\rangle + \\langle \\hat{V} \\rangle = 2\\langle \\hat{T} \\rangle$, meaning the expectation value of the kinetic energy is exactly half the total energy, a characteristic feature of the harmonic oscillator.", "answer": "$$\n\\boxed{\\frac{1}{2}\\hbar\\omega\\left(n_{x} + n_{y} + n_{z} + \\frac{3}{2}\\right)}\n$$", "id": "2930792"}, {"introduction": "The elegant simplicity of the Hellmann-Feynman theorem can sometimes conceal its underlying assumptions. This practice is designed to explore one of its most important subtleties: the requirement of a parameter-independent domain. By examining a particle in a one-dimensional box whose size $L$ is a tunable parameter, you will discover that a naive application of the theorem leads to an incorrect result. This counterexample is highly instructive, as it forces you to identify the missing 'boundary term' and provides a much deeper insight into the theorem's formal structure and limitations [@problem_id:2930785].", "problem": "Consider a single, structureless quantum particle of mass $m$ confined to a one-dimensional infinitely deep potential well whose right wall is located at $x=L$, with $L>0$ regarded as an external, tunable parameter. The Hamiltonian $H(L)$ acts as the kinetic operator $-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$ on the open interval $(0,L)$, with Dirichlet boundary conditions $\\psi(0;L)=\\psi(L;L)=0$ that define the operator domain. Thus the operator domain depends on the parameter $L$. Throughout, assume normalized stationary states.\n\nYour tasks are:\n- Using only the standard time-independent Schrödinger equation and the boundary conditions, obtain the normalized eigenfunctions $\\psi_{n}(x;L)$ and corresponding eigenvalues $E_{n}(L)$ for $n\\in\\mathbb{N}$.\n- Compute the exact derivative $\\frac{dE_{n}}{dL}$.\n- Evaluate the “naive parameter-derivative expectation” $\\langle \\psi_{n}(\\cdot;L)\\,|\\,\\frac{\\partial H}{\\partial L}\\,|\\,\\psi_{n}(\\cdot;L)\\rangle$ by treating $H(L)$ as $-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$ on $(0,L)$ and differentiating only the explicit parameter dependence of the differential operator while holding the domain fixed. Explain your reasoning for the value you obtain.\n- By comparing your two derivatives, identify the additional “domain-derivative” term $\\Delta_{n}(L)$ that must be added to the naive parameter-derivative expectation to recover $\\frac{dE_{n}}{dL}$ in this example, i.e., the quantity defined by\n$$\n\\frac{dE_{n}}{dL} \\;=\\; \\Big\\langle \\psi_{n}(\\cdot;L)\\,\\Big|\\,\\frac{\\partial H}{\\partial L}\\,\\Big|\\,\\psi_{n}(\\cdot;L)\\Big\\rangle \\;+\\; \\Delta_{n}(L).\n$$\n\nExpress your final result for $\\Delta_{n}(L)$ as a closed-form analytic expression in terms of $n$, $m$, $\\hbar$, and $L$. The final answer must be a single analytic expression. Do not include units in the final answer box.", "solution": "The problem as stated is subjected to validation.\n\n**Step 1: Extract Givens**\n-   Particle: single, structureless, mass $m$.\n-   Potential: one-dimensional infinitely deep potential well.\n-   Boundaries: Left wall at $x=0$, right wall at $x=L$. $L>0$ is a tunable parameter.\n-   Hamiltonian: $H(L) = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$ on the open interval $(0,L)$.\n-   Boundary Conditions: Dirichlet conditions, $\\psi(0;L)=\\psi(L;L)=0$.\n-   States: Normalized stationary states $\\psi_n(x;L)$ with eigenvalues $E_n(L)$ for $n\\in\\mathbb{N}$.\n-   Task Definition: A specific quantity $\\Delta_{n}(L)$ is defined by the equation:\n    $$\\frac{dE_{n}}{dL} = \\Big\\langle \\psi_{n}(\\cdot;L)\\,\\Big|\\,\\frac{\\partial H}{\\partial L}\\,\\Big|\\,\\psi_{n}(\\cdot;L)\\Big\\rangle + \\Delta_{n}(L)$$\n    where the expectation value term is to be computed \"naively\" by differentiating only the explicit parameter dependence of the differential operator form of $H(L)$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem deals with the particle in a one-dimensional box, a canonical model in quantum mechanics. It explores the subtleties of the Hellmann-Feynman theorem when boundary conditions depend on the parameter of differentiation. This is a standard and well-understood topic in quantum chemistry and physics. The problem is free of any scientific or factual unsoundness.\n-   **Well-Posed:** The problem is clearly structured as a sequence of four specific tasks. All necessary information (Hamiltonian, boundary conditions) is provided. The requested quantities are unambiguously defined. A unique, stable solution exists.\n-   **Objective:** The language is formal, precise, and entirely objective.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, objective, and self-contained. It is a valid problem that requires rigorous application of fundamental quantum mechanical principles. I will proceed with the full solution.\n\nThe solution is constructed by following the four tasks outlined in the problem statement.\n\nFirst, we determine the stationary state eigenfunctions $\\psi_{n}(x;L)$ and their corresponding energy eigenvalues $E_{n}(L)$. The time-independent Schrödinger equation for this system is:\n$$H(L)\\psi(x;L) = E(L)\\psi(x;L)$$\n$$-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}\\psi(x;L) = E(L)\\psi(x;L)$$\nThis can be rewritten in the standard form of a second-order ordinary differential equation:\n$$\\frac{d^{2}\\psi}{dx^{2}} + k^{2}\\psi = 0, \\quad \\text{where} \\quad k^{2} = \\frac{2mE}{\\hbar^{2}}$$\nThe general solution is $\\psi(x) = A\\sin(kx) + B\\cos(kx)$. We apply the boundary conditions. The condition $\\psi(0)=0$ requires $A\\sin(0) + B\\cos(0) = 0$, which implies $B=0$. The solution form is thus $\\psi(x) = A\\sin(kx)$.\nThe second boundary condition, $\\psi(L)=0$, requires $A\\sin(kL)=0$. For a non-trivial solution ($A \\neq 0$), we must have $kL = n\\pi$, where $n$ is a positive integer, $n \\in \\mathbb{N} = \\{1, 2, 3, \\ldots\\}$. The case $n=0$ is excluded as it leads to the trivial wavefunction $\\psi(x)=0$.\nThis quantizes the wave number: $k_{n} = \\frac{n\\pi}{L}$.\nSubstituting this into the definition of $k^2$ gives the quantized energy eigenvalues:\n$$E_{n}(L) = \\frac{\\hbar^{2}k_{n}^{2}}{2m} = \\frac{\\hbar^{2}}{2m}\\left(\\frac{n\\pi}{L}\\right)^{2} = \\frac{\\hbar^{2}\\pi^{2}n^{2}}{2mL^{2}}$$\nTo find the constant $A_n$, we normalize the eigenfunctions $\\psi_{n}(x;L) = A_{n}\\sin(\\frac{n\\pi x}{L})$. The normalization condition is $\\int_{0}^{L} |\\psi_{n}(x;L)|^{2} dx = 1$.\n$$\\int_{0}^{L} A_{n}^{2}\\sin^{2}\\left(\\frac{n\\pi x}{L}\\right) dx = 1$$\n$$A_{n}^{2} \\int_{0}^{L} \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right) dx = 1$$\n$$A_{n}^{2} \\frac{1}{2} \\left[x - \\frac{L}{2n\\pi}\\sin\\left(\\frac{2n\\pi x}{L}\\right)\\right]_{0}^{L} = 1$$\n$$A_{n}^{2} \\frac{1}{2} (L - 0) = 1 \\implies A_{n}^{2}\\frac{L}{2} = 1$$\nWe choose the real, positive root $A_{n} = \\sqrt{\\frac{2}{L}}$. Thus, the normalized eigenfunctions are:\n$$\\psi_{n}(x;L) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\nSecond, we compute the exact derivative $\\frac{dE_{n}}{dL}$ using the expression for $E_{n}(L)$.\n$$E_{n}(L) = \\frac{\\hbar^{2}\\pi^{2}n^{2}}{2m}L^{-2}$$\nDifferentiating with respect to $L$, we obtain:\n$$\\frac{dE_{n}}{dL} = \\frac{d}{dL}\\left(\\frac{\\hbar^{2}\\pi^{2}n^{2}}{2m}L^{-2}\\right) = \\frac{\\hbar^{2}\\pi^{2}n^{2}}{2m}(-2L^{-3}) = -\\frac{\\hbar^{2}\\pi^{2}n^{2}}{mL^{3}}$$\n\nThird, we evaluate the \"naive parameter-derivative expectation\" $\\langle \\psi_{n}|\\frac{\\partial H}{\\partial L}|\\psi_{n}\\rangle$. The problem explicitly instructs us to differentiate only the explicit parameter dependence of the operator expression $H(L) = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$. This expression contains the constants $\\hbar$ and $m$, and the differential operator $\\frac{d^{2}}{dx^{2}}$. It does not contain the parameter $L$ in its explicit form. The dependence on $L$ is entirely through the domain of the operator, which is ignored in this \"naive\" calculation. Therefore, under this interpretation:\n$$\\frac{\\partial H}{\\partial L} = \\frac{\\partial}{\\partial L}\\left(-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}\\right) = 0$$\nThe operator $\\frac{\\partial H}{\\partial L}$ is the zero operator. The expectation value of the zero operator is necessarily zero:\n$$\\left\\langle \\psi_{n}(\\cdot;L)\\,\\left|\\,\\frac{\\partial H}{\\partial L}\\,\\right|\\,\\psi_{n}(\\cdot;L)\\right\\rangle = \\langle \\psi_{n} | 0 | \\psi_{n} \\rangle = 0$$\nThis result highlights that the standard form of the Hellmann-Feynman theorem, $\\frac{dE}{d\\lambda} = \\langle \\psi | \\frac{\\partial H}{\\partial \\lambda} | \\psi \\rangle$, is not applicable when the domain of the Hamiltonian depends on the parameter $\\lambda$, if one naively computes $\\frac{\\partial H}{\\partial \\lambda}$ while ignoring the domain change.\n\nFourth, we identify the \"domain-derivative\" term $\\Delta_{n}(L)$ using the relation provided in the problem statement:\n$$\\frac{dE_{n}}{dL} = \\left\\langle \\psi_{n}(\\cdot;L)\\,\\left|\\,\\frac{\\partial H}{\\partial L}\\,\\right|\\,\\psi_{n}(\\cdot;L)\\right\\rangle + \\Delta_{n}(L)$$\nSubstituting the results from the previous steps into this equation:\n$$-\\frac{\\hbar^{2}\\pi^{2}n^{2}}{mL^{3}} = 0 + \\Delta_{n}(L)$$\nThis immediately yields the expression for the correction term $\\Delta_{n}(L)$:\n$$\\Delta_{n}(L) = -\\frac{\\hbar^{2}\\pi^{2}n^{2}}{mL^{3}}$$\nThis term accounts for the change in energy due to the change in the size of the domain of confinement, a contribution missed by the naive application of the Hellmann-Feynman theorem. It can be related to the force exerted by the particle on the wall of the potential well.", "answer": "$$\\boxed{-\\frac{\\hbar^{2}\\pi^{2}n^{2}}{mL^{3}}}$$", "id": "2930785"}, {"introduction": "Beyond their theoretical elegance, the Hellmann-Feynman and related theorems are workhorses in modern computational chemistry. This hands-on coding exercise demonstrates how the theorem underpins the 'finite-field' method for calculating molecular properties. You will compute the static polarizability tensor for an anisotropic harmonic oscillator by numerically differentiating the ground-state energy, a task that connects directly to the Hellmann-Feynman principle. By comparing your results with the traditional sum-over-states expression from perturbation theory, you will gain practical experience in implementing and validating these foundational quantum chemical concepts [@problem_id:2930776].", "problem": "Consider a single active electron moving in an anisotropic three-dimensional harmonic confining potential under a spatially uniform, static electric field. Work in atomic units, so that the elementary charge, reduced Planck constant, and electron mass satisfy $e = \\hbar = m_e = 1$. The Hamiltonian for a field $\\boldsymbol{\\mathcal{E}} = (\\mathcal{E}_x,\\mathcal{E}_y,\\mathcal{E}_z)$ is\n$$\n\\hat{H}(\\boldsymbol{\\mathcal{E}}) \\;=\\; \\sum_{i\\in\\{x,y,z\\}}\\left[\\frac{\\hat{p}_i^2}{2} + \\frac{\\omega_i^2 \\hat{r}_i^2}{2}\\right] \\;-\\; \\sum_{i\\in\\{x,y,z\\}} \\mathcal{E}_i\\, \\hat{r}_i,\n$$\nwith axis frequencies $\\omega_i > 0$ and $\\hat{r}_i$ the position operators along Cartesian axes. Let $E(\\boldsymbol{\\mathcal{E}})$ denote the exact ground-state energy of $\\hat{H}(\\boldsymbol{\\mathcal{E}})$.\n\nYour task is to obtain the static electric-dipole polarizability tensor components $\\alpha_{ij}$ at zero field by two independent routes grounded in first principles:\n\n- Finite-field route based on the Hellmann-Feynman theorem (finite differences of total energy): use the definition $\\alpha_{ij} = -\\left.\\dfrac{\\partial^2 E}{\\partial \\mathcal{E}_i \\partial \\mathcal{E}_j}\\right|_{\\boldsymbol{\\mathcal{E}}=\\mathbf{0}}$, and approximate the second derivative with a symmetric fourth-order central finite-difference stencil. For a single Cartesian component $i$, define $f(\\epsilon) = E(\\epsilon\\,\\hat{\\mathbf{e}}_i)$ and use\n$$\nf''(0) \\;\\approx\\; \\frac{-f(2h) + 16 f(h) - 30 f(0) + 16 f(-h) - f(-2h)}{12 h^2},\n$$\nwith step size $h>0$ in atomic units of electric field. Then set $\\alpha_{ii}^{(\\mathrm{FF})} = - f''(0)$. By symmetry of the model, the off-diagonal elements $\\alpha_{ij}$ with $i\\neq j$ vanish; you only need to compute the diagonal entries.\n\n- Time-independent perturbation theory route: starting from the time-independent Schrödinger equation for $\\hat{H}(\\boldsymbol{\\mathcal{E}})$ and treating the field coupling as a perturbation about $\\boldsymbol{\\mathcal{E}}=\\mathbf{0}$, derive from first principles the appropriate second-order, static, time-independent perturbation expression for $\\alpha_{ij}$ in terms of unperturbed eigenstates and matrix elements of $\\hat{r}_i$. Implement that expression to obtain $\\alpha_{ii}^{(\\mathrm{PT})}$.\n\nNumerical realization requirement. For the finite-field route, you must evaluate $E(\\epsilon\\,\\hat{\\mathbf{e}}_i)$ by solving the one-dimensional eigenproblem along axis $i$ in a truncated harmonic-oscillator Fock basis of size $N$, with\n$$\n\\hat{H}_i(\\epsilon) \\;=\\; \\omega_i\\left(\\hat{a}_i^\\dagger \\hat{a}_i + \\tfrac{1}{2}\\right) \\;-\\; \\epsilon\\, \\hat{r}_i,\\quad \\hat{r}_i \\;=\\; \\sqrt{\\frac{1}{2\\omega_i}}\\left(\\hat{a}_i + \\hat{a}_i^\\dagger\\right),\n$$\nso that the ground-state energy for the axis factor is the smallest eigenvalue of the $N\\times N$ matrix representation. For the perturbation-theory route, you must use the same truncated unperturbed basis to assemble the needed matrix elements of $\\hat{r}_i$ and energy differences. All reported polarizabilities must be in atomic units of volume $a_0^3$.\n\nAngle units are not involved. No percentages are involved.\n\nTest suite. Your program must implement both routes and evaluate them for the following parameter sets, each provided as a tuple $\\big((\\omega_x,\\omega_y,\\omega_z),\\,h,\\,N\\big)$:\n- Case A: $\\big((0.7,\\,1.1,\\,1.4),\\,10^{-3},\\,14\\big)$\n- Case B: $\\big((2.5,\\,2.5,\\,2.5),\\,10^{-2},\\,10\\big)$\n- Case C: $\\big((0.2,\\,1.0,\\,1.8),\\,5\\times 10^{-4},\\,22\\big)$\n\nFor each case, compute the three diagonal components by both methods and the maximum absolute discrepancy over the diagonal entries,\n$$\n\\Delta_{\\max} \\;=\\; \\max_{i\\in\\{x,y,z\\}} \\left|\\alpha_{ii}^{(\\mathrm{FF})} - \\alpha_{ii}^{(\\mathrm{PT})}\\right|.\n$$\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Concatenate, in order for Case A, then Case B, then Case C, the seven floats\n$$\n\\big[\\alpha_{xx}^{(\\mathrm{FF})},\\;\\alpha_{xx}^{(\\mathrm{PT})},\\;\\alpha_{yy}^{(\\mathrm{FF})},\\;\\alpha_{yy}^{(\\mathrm{PT})},\\;\\alpha_{zz}^{(\\mathrm{FF})},\\;\\alpha_{zz}^{(\\mathrm{PT})},\\;\\Delta_{\\max}\\big],\n$$\nall in atomic units. Do not include any additional text and do not round; use the default string conversion of the floating-point results produced by your program.", "solution": "The user-provided problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **System**: A single electron in an anisotropic 3D harmonic potential with a uniform static electric field $\\boldsymbol{\\mathcal{E}} = (\\mathcal{E}_x, \\mathcal{E}_y, \\mathcal{E}_z)$.\n- **Units**: Atomic units ($\\hbar = m_e = e = 1$).\n- **Hamiltonian**: $\\hat{H}(\\boldsymbol{\\mathcal{E}}) = \\sum_{i\\in\\{x,y,z\\}}\\left[\\frac{\\hat{p}_i^2}{2} + \\frac{1}{2}\\omega_i^2 \\hat{r}_i^2}\\right] - \\sum_{i\\in\\{x,y,z\\}} \\mathcal{E}_i\\, \\hat{r}_i$, with axis frequencies $\\omega_i > 0$.\n- **Objective**: Compute the diagonal static electric-dipole polarizability tensor components $\\alpha_{ii}$.\n- **Method 1 (Finite-Field, FF)**:\n    - Definition: $\\alpha_{ij} = -\\left.\\dfrac{\\partial^2 E}{\\partial \\mathcal{E}_i \\partial \\mathcal{E}_j}\\right|_{\\boldsymbol{\\mathcal{E}}=\\mathbf{0}}$.\n    - Numerical Approximation: A symmetric fourth-order central finite-difference stencil for the second derivative, with step size $h$. For $f(\\epsilon) = E(\\epsilon\\,\\hat{\\mathbf{e}}_i)$, $f''(0) \\approx \\frac{-f(2h) + 16 f(h) - 30 f(0) + 16 f(-h) - f(-2h)}{12 h^2}$.\n- **Method 2 (Perturbation Theory, PT)**:\n    - Derive and implement the second-order, static, time-independent perturbation theory expression for $\\alpha_{ii}$.\n- **Numerical Implementation Details**:\n    - The problem is solved in a truncated harmonic-oscillator Fock basis of size $N$.\n    - The 1D Hamiltonian along axis $i$ is $\\hat{H}_i(\\epsilon) = \\omega_i\\left(\\hat{a}_i^\\dagger \\hat{a}_i + \\tfrac{1}{2}\\right) - \\epsilon\\, \\hat{r}_i$.\n    - The position operator is $\\hat{r}_i = \\sqrt{\\frac{1}{2\\omega_i}}\\left(\\hat{a}_i + \\hat{a}_i^\\dagger\\right)$.\n    - The ground-state energy for the FF route is the smallest eigenvalue of the $N \\times N$ matrix representation of $\\hat{H}_i(\\epsilon)$.\n- **Test Cases**:\n    - A: $\\big((\\omega_x, \\omega_y, \\omega_z)=(0.7, 1.1, 1.4), h=10^{-3}, N=14\\big)$\n    - B: $\\big((\\omega_x, \\omega_y, \\omega_z)=(2.5, 2.5, 2.5), h=10^{-2}, N=10\\big)$\n    - C: $\\big((\\omega_x, \\omega_y, \\omega_z)=(0.2, 1.0, 1.8), h=5\\times 10^{-4}, N=22\\big)$\n- **Comparison**: Compute $\\Delta_{\\max} = \\max_{i\\in\\{x,y,z\\}} \\left|\\alpha_{ii}^{(\\mathrm{FF})} - \\alpha_{ii}^{(\\mathrm{PT})}\\right|$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is based on the quantum harmonic oscillator perturbed by an electric field, a canonical model in quantum physics. The methods proposed—the Hellmann-Feynman theorem via finite differences and time-independent perturbation theory—are standard, fundamental techniques in quantum chemistry and physics.\n- **Well-Posedness**: The problem is mathematically well-defined. The Hamiltonian is separable, justifying the independent treatment of each Cartesian coordinate and the assertion that off-diagonal polarizabilities $\\alpha_{ij}$ ($i \\neq j$) are zero. All parameters for the numerical calculation ($N, h, \\omega_i$) are provided. A unique solution is expected.\n- **Objectivity**: The problem is stated in precise, objective, and mathematical language, free from ambiguity or subjective content.\n- **Conclusion**: The problem is scientifically sound, self-contained, and well-posed. It is a valid and standard exercise in computational quantum mechanics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe total Hamiltonian $\\hat{H}(\\boldsymbol{\\mathcal{E}})$ is separable into contributions from each Cartesian axis: $\\hat{H}(\\boldsymbol{\\mathcal{E}}) = \\sum_{i \\in \\{x,y,z\\}} \\hat{H}_i(\\mathcal{E}_i)$, where $\\hat{H}_i(\\mathcal{E}_i) = \\frac{\\hat{p}_i^2}{2} + \\frac{1}{2}\\omega_i^2 \\hat{r}_i^2 - \\mathcal{E}_i \\hat{r}_i$. The total ground-state energy is $E(\\boldsymbol{\\mathcal{E}}) = \\sum_i E_i(\\mathcal{E}_i)$, where $E_i$ is the ground-state energy of $\\hat{H}_i$. Consequently, the polarizability tensor is diagonal, with $\\alpha_{ij} = -\\frac{\\partial^2 E}{\\partial \\mathcal{E}_i \\partial \\mathcal{E}_j}\\big|_{\\mathbf{0}} = -\\frac{d^2 E_i}{d \\mathcal{E}_i^2}\\big|_0 \\delta_{ij}$. We need only compute the diagonal components $\\alpha_{ii}$ for each axis independently.\n\n**1. Perturbation Theory (PT) Route**\nWe treat the electric field term, $\\hat{V}_i = -\\mathcal{E}_i \\hat{r}_i$, as a perturbation to the 1D harmonic oscillator Hamiltonian $\\hat{H}_i^{(0)}$. The energy of the ground state $|0\\rangle$ perturbed to second order in $\\mathcal{E}_i$ is $E_i(\\mathcal{E}_i) \\approx E_0^{(0)} + \\mathcal{E}_i E_i^{(1)} + \\mathcal{E}_i^2 E_i^{(2)}$.\nThe Taylor expansion of energy relates to polarizability as $E_i(\\mathcal{E}_i) = E_i(0) - \\mu_i \\mathcal{E}_i - \\frac{1}{2}\\alpha_{ii} \\mathcal{E}_i^2 + \\dots$.\nBy comparison, $\\alpha_{ii} = -2 E_i^{(2)}$.\nThe second-order energy correction for the ground state $|\\psi_0\\rangle$ is given by the sum-over-states formula:\n$$\nE_i^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle \\psi_0 | (-\\hat{r}_i) | \\psi_k \\rangle|^2}{E_0 - E_k} = \\sum_{k \\neq 0} \\frac{|\\langle \\psi_0 | \\hat{r}_i | \\psi_k \\rangle|^2}{E_0 - E_k}\n$$\nwhere $|\\psi_k\\rangle$ and $E_k$ are the unperturbed eigenstates and eigenenergies of $\\hat{H}_i^{(0)}$. These are the Fock states $|k\\rangle$ with energies $E_k = \\omega_i(k + \\frac{1}{2})$. The ground state is $|0\\rangle$ with energy $E_0 = \\frac{1}{2}\\omega_i$.\nThe position operator $\\hat{r}_i = \\sqrt{\\frac{1}{2\\omega_i}}(\\hat{a}_i + \\hat{a}_i^\\dagger)$ only connects states that differ by one quantum, i.e., $\\langle k'|\\hat{r}_i|k\\rangle \\neq 0$ only if $k' = k \\pm 1$. For the ground state $|0\\rangle$, the only non-zero matrix element is with the first excited state $|1\\rangle$.\n$$\n\\langle 0 | \\hat{r}_i | 1 \\rangle = \\sqrt{\\frac{1}{2\\omega_i}} \\langle 0 | (\\hat{a}_i + \\hat{a}_i^\\dagger) | 1 \\rangle = \\sqrt{\\frac{1}{2\\omega_i}} (\\langle 0 | \\hat{a}_i | 1 \\rangle + \\langle 0 | \\hat{a}_i^\\dagger | 1 \\rangle) = \\sqrt{\\frac{1}{2\\omega_i}} (1 + 0) = \\frac{1}{\\sqrt{2\\omega_i}}\n$$\nThe energy difference is $E_0 - E_1 = \\frac{1}{2}\\omega_i - \\frac{3}{2}\\omega_i = -\\omega_i$.\nSubstituting into the formula for $\\alpha_{ii}$:\n$$\n\\alpha_{ii}^{(\\mathrm{PT})} = -2 E_i^{(2)} = -2 \\frac{|\\langle 0 | \\hat{r}_i | 1 \\rangle|^2}{E_0 - E_1} = -2 \\frac{(1/\\sqrt{2\\omega_i})^2}{-\\omega_i} = -2 \\frac{1/(2\\omega_i)}{-\\omega_i} = \\frac{1}{\\omega_i^2}\n$$\nThis is an exact result for the model. The numerical implementation using a truncated basis of size $N \\ge 2$ will also yield this exact value, as only the state $|1\\rangle$ contributes to the sum.\n\n**2. Finite-Field (FF) Route**\nThis route uses the definition $\\alpha_{ii} = -\\frac{d^2 E_i}{d\\mathcal{E}_i^2}|_0$ directly. We compute the ground-state energy $E_i(\\mathcal{E}_i)$ by numerical diagonalization and then approximate the second derivative using the provided fourth-order finite-difference formula.\nThe matrix representation of the 1D Hamiltonian $\\hat{H}_i(\\mathcal{E}_i) = \\hat{H}_i^{(0)} - \\mathcal{E}_i \\hat{r}_i$ is constructed in a truncated Fock basis $\\{|n\\rangle\\}_{n=0}^{N-1}$. The matrix elements are:\n- $\\langle m | \\hat{H}_i^{(0)} | n \\rangle = \\omega_i(n + \\frac{1}{2})\\delta_{mn}$\n- $\\langle m | \\hat{r}_i | n \\rangle = \\sqrt{\\frac{1}{2\\omega_i}} (\\langle m|\\hat{a}_i|n \\rangle + \\langle m|\\hat{a}_i^\\dagger|n \\rangle) = \\sqrt{\\frac{1}{2\\omega_i}}(\\sqrt{n}\\delta_{m,n-1} + \\sqrt{n+1}\\delta_{m,n+1})$\nThe ground-state energy $E_i(\\mathcal{E}_i)$ is the lowest eigenvalue of this $N \\times N$ matrix. We compute this energy for field strengths $\\mathcal{E}_i \\in \\{0, h, 2h\\}$.\nSince the potential is symmetric with respect to a coordinate shift and a sign change of the field, the energy is an even function of the field, $E_i(\\mathcal{E}_i) = E_i(-\\mathcal{E}_i)$. The finite-difference formula simplifies:\n$$\n\\frac{d^2 E_i}{d\\mathcal{E}_i^2}\\bigg|_0 \\approx \\frac{-E_i(2h) + 16 E_i(h) - 30 E_i(0) + 16 E_i(-h) - E_i(-2h)}{12 h^2} = \\frac{-E_i(2h) + 16 E_i(h) - 15 E_i(0)}{6 h^2}\n$$\nThe polarizability is then $\\alpha_{ii}^{(\\mathrm{FF})} = -\\left(\\text{the above approximation}\\right)$.\nFor this specific problem, the exact energy is $E_i(\\mathcal{E}_i) = \\frac{1}{2}\\omega_i - \\frac{\\mathcal{E}_i^2}{2\\omega_i^2}$, which is a quadratic polynomial in $\\mathcal{E}_i$. The finite-difference formula is exact for polynomials of degree up to 5, so the finite-difference error is zero. Any deviation of $\\alpha_{ii}^{(\\mathrm{FF})}$ from the exact PT result $\\frac{1}{\\omega_i^2}$ is solely due to the basis set truncation error (finite $N$).", "answer": "```python\nimport numpy as np\n\ndef get_ground_state_energy(epsilon, omega, N):\n    \"\"\"\n    Calculates the ground-state energy of a 1D harmonic oscillator in an electric field.\n\n    The calculation is performed by diagonalizing the Hamiltonian matrix in a\n    truncated Fock basis of size N.\n\n    Args:\n        epsilon (float): The electric field strength.\n        omega (float): The angular frequency of the harmonic oscillator.\n        N (int): The size of the truncated Fock basis.\n\n    Returns:\n        float: The ground-state energy (smallest eigenvalue).\n    \"\"\"\n    # Matrix for the unperturbed Hamiltonian H0 = omega * (a_dag*a + 1/2*I)\n    # The number operator a_dag*a is diagonal in the Fock basis.\n    n_op = np.diag(np.arange(N))\n    h0_matrix = omega * (n_op + 0.5 * np.identity(N))\n\n    # Matrix for the position operator r = sqrt(1/(2*omega)) * (a + a_dag)\n    # The annihilation operator 'a' has non-zero elements on the first super-diagonal.\n    # a_mn = <m|a|n> = sqrt(n) * delta_{m, n-1} (using 0-based indexing for m,n)\n    # This corresponds to a_op[m, m+1] = sqrt(m+1)\n    a_op_superdiag = np.sqrt(np.arange(1, N))\n    a_op = np.diag(a_op_superdiag, k=1)\n    \n    # The creation operator 'a_dag' is the adjoint of 'a'.\n    a_dag_op = a_op.T\n\n    r_matrix = np.sqrt(1 / (2 * omega)) * (a_op + a_dag_op)\n\n    # Full Hamiltonian matrix H = H0 - epsilon * r\n    h_matrix = h0_matrix - epsilon * r_matrix\n\n    # Find eigenvalues of the Hermitian matrix H.\n    # np.linalg.eigh returns sorted eigenvalues.\n    eigenvalues = np.linalg.eigh(h_matrix)[0]\n\n    # The ground-state energy is the smallest eigenvalue.\n    return eigenvalues[0]\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the final result.\n    \"\"\"\n    test_cases = [\n        ((0.7, 1.1, 1.4), 1e-3, 14),\n        ((2.5, 2.5, 2.5), 1e-2, 10),\n        ((0.2, 1.0, 1.8), 5e-4, 22),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        omegas, h, N = case\n        case_results = []\n        alpha_ff_list = []\n        alpha_pt_list = []\n\n        # Iterate over the three Cartesian axes (x, y, z)\n        for i in range(3):\n            omega = omegas[i]\n\n            # Perturbation Theory (PT) route\n            # The analytical result is exact for this model.\n            alpha_pt = 1.0 / (omega**2)\n            \n            # Finite-Field (FF) route\n            # Calculate ground state energies at different field strengths\n            e0 = get_ground_state_energy(0.0, omega, N)\n            e_h = get_ground_state_energy(h, omega, N)\n            e_2h = get_ground_state_energy(2 * h, omega, N)\n\n            # Use the fourth-order central finite-difference formula for the second derivative.\n            # The formula simplifies due to E(eps) = E(-eps) symmetry.\n            # f''(0) ~= (-f(2h) + 16f(h) - 15f(0)) / (6h^2)\n            g_double_prime = (-e_2h + 16 * e_h - 15 * e0) / (6 * h**2)\n            \n            # alpha = -f''(0)\n            alpha_ff = -g_double_prime\n\n            case_results.extend([alpha_ff, alpha_pt])\n            alpha_ff_list.append(alpha_ff)\n            alpha_pt_list.append(alpha_pt)\n\n        # Calculate the maximum absolute discrepancy for the current case\n        delta_max = np.max(np.abs(np.array(alpha_ff_list) - np.array(alpha_pt_list)))\n        case_results.append(delta_max)\n        \n        all_results.extend(case_results)\n    \n    # Print the concatenated results in the required format\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2930776"}]}