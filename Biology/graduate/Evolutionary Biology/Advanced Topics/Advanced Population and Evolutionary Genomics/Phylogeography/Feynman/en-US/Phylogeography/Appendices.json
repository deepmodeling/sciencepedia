{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of phylogeographic analysis is the interpretation of haplotype networks, which visualize the mutational relationships among DNA sequences within a population. This exercise introduces a classic pattern—the star-like network—and challenges you to connect its distinct topology to a specific demographic history . Understanding this link is a foundational skill for inferring processes such as recent colonization events and periods of rapid population growth directly from genetic data.",
            "id": "1954849",
            "problem": "Researchers are studying the colonization history of a non-native fish species, the Crimson-spotted Minnow, which was introduced into a large, newly constructed reservoir ten years ago. To understand the genetic signature of this introduction, they sequenced a region of the mitochondrial DNA (mtDNA) from 200 individual fish sampled across the reservoir. Their analysis revealed a total of six distinct DNA sequences, referred to as haplotypes (H1 through H6).\n\nThe relationships and frequencies of these haplotypes are described as follows:\n-   Haplotype H1 is the most common, found in 185 of the 200 fish.\n-   Haplotypes H2, H3, H4, H5, and H6 are all rare, with each being found in only 3 fish.\n-   Genetic analysis shows that each of the rare haplotypes (H2 through H6) differs from the common haplotype H1 by only a single nucleotide substitution.\n-   No haplotype is an intermediate between H1 and any of the other rare haplotypes. For example, H2 does not lie on a mutational path between H1 and H3.\n\nBased on this genetic data, which of the following scenarios provides the most likely explanation for the population history of the Crimson-spotted Minnow in this reservoir?\n\nA. The reservoir was colonized by a large, genetically diverse population from an ancient and stable source.\n\nB. The population in the reservoir has been established for a very long time and has maintained a large, stable size.\n\nC. The population in the reservoir has recently experienced a severe and prolonged population bottleneck, leading to the loss of most genetic diversity.\n\nD. The reservoir was colonized by a small number of founders, followed by a period of rapid population growth and expansion.\n\nE. The reservoir is experiencing continuous migration from two genetically distinct source populations that have recently come into contact.",
            "solution": "We interpret the mtDNA data as follows. There are six haplotypes, with one dominant haplotype $H1$ found in $185$ of $200$ individuals and five rare haplotypes $H2$–$H6$, each present in $3$ individuals. All rare haplotypes differ from $H1$ by exactly one substitution, and none is intermediate between any other pair. This defines a star-like haplotype network with $H1$ at the center and single-step tips $H2$–$H6$ radiating from it.\n\nUnder standard neutral models (e.g., infinite-sites with no recombination), a recent population expansion from a small number of founders produces (i) a star-like genealogy, (ii) a single high-frequency ancestral haplotype, and (iii) multiple low-frequency derived haplotypes that are one mutational step from the ancestor. Coalescent reasoning: a rapid growth event compresses coalescence times near the present, so most lineages coalesce quickly to a recent common ancestor corresponding to the high-frequency haplotype (here $H1$), while independent new mutations arising on short external branches lead to multiple single-step, low-frequency variants (here $H2$–$H6$). The site-frequency spectrum under such an expansion is skewed toward rare variants, consistent with negative Tajima’s $D$ and a star-like haplotype network.\n\nWe exclude the alternatives by contradiction with the observed pattern:\n- Large, genetically diverse source (A) or long-term large, stable population (B) would generate deeper coalescence times, higher haplotype richness, multiple common haplotypes, and multi-step mutational paths with intermediates, not a single dominant haplotype with only one-step rare derivatives.\n- A severe and prolonged bottleneck without subsequent expansion (C) would likely purge diversity to one or very few haplotypes; with a prolonged small effective size, few new mutations would be present in multiple copies across the population within a short calendar time, and the characteristic pattern of several independent one-step low-frequency haplotypes present in multiple individuals is less expected without expansion.\n- Continuous migration from two distinct sources (E) would tend to produce at least two common haplotypes and two clusters separated by multiple mutational steps, not a single central haplotype with all others one step away.\n\nTherefore, the data most parsimoniously indicate a founder event followed by rapid demographic expansion, matching option D: colonization by a small number of founders with subsequent rapid growth, yielding a star-like haplotype network centered on the ancestral haplotype $H1$ and several rare, single-step derivatives.",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "Phylogeography excels as an integrative science, weaving together genetic data with evidence from paleoclimatology, geology, and ecology to reconstruct the past. This practice presents a classic phylogeographic paradox: deep genetic divergence suggesting ancient isolation clashes with paleoclimatic models indicating a single, contiguous ancestral refugium . Resolving this apparent conflict requires critical thinking about the different scales at which data are collected and analyzed, introducing the powerful concept of \"refugia within refugia\" where cryptic environmental structure can maintain long-term genetic breaks.",
            "id": "1954820",
            "problem": "A phylogeographic study was conducted on the Alpine Gem-lizard (*Petrosaurus crystallinus*), a small, montane reptile endemic to the Pyrenees mountain range. Population genetic analysis using mitochondrial DNA (mtDNA) revealed the existence of two deeply divergent, geographically distinct clades, hereafter referred to as the 'Western Clade' and the 'Eastern Clade'. The two clades exhibit a stark parapatric distribution, meeting at a narrow contact zone with very limited inter-clade gene flow. The net sequence divergence ($d_A$) between the mtDNA of the two clades was calculated to be $4.35\\%$. The molecular clock for this mtDNA region is calibrated to a divergence rate of $2.1\\%$ per million years.\n\nIn parallel, paleoclimatic niche modeling was performed to reconstruct the species' likely distribution during the Last Glacial Maximum (LGM), approximately 21,000 years ago. The consensus from multiple models robustly predicts a single, large, and contiguous refugium spanning the lower-elevation slopes of the central and eastern Pyrenees. This predicted contiguous refugial area completely encompasses the current distributions of both the Western and Eastern clades. This presents a paradox: the deep genetic split suggests a long period of allopatric isolation, yet the paleoclimatic evidence suggests the ancestral population inhabited a single, unbroken area.\n\nWhich of the following demographic models provides the most parsimonious and comprehensive explanation that reconciles these apparently conflicting genetic and paleoclimatic findings?\n\nA. The two clades diverged in two geographically distinct and widely separated LGM refugia (e.g., one in the Iberian peninsula and one in the Italian peninsula), and their current parapatric distribution is the result of post-glacial range expansion and secondary contact.\n\nB. The divergence is a very recent, post-LGM event driven by strong disruptive selection for different ecological niches within a continuous population, leading to sympatric speciation.\n\nC. The species has persisted as a single, large, contiguous population for millions of years, and the observed genetic pattern is a classic example of isolation-by-distance, where genetic differentiation gradually increases with geographic separation.\n\nD. Divergence occurred in allopatry over a long period within multiple, small, and stable micro-refugia (e.g., specific valleys or slopes with unique thermal or hydrological properties) that were isolated by unsuitable terrain, all located *within* the broader area identified as a single contiguous refugium by the coarse-grained climate models.\n\nE. The two mtDNA lineages sorted incompletely from a large, ancient ancestral population. The observed geographic sorting of these ancient lineages into Western and Eastern clades is a recent phenomenon, caused by founder effects as different parts of the single LGM refugial population expanded post-glacially.",
            "solution": "Let $d_{A}$ denote the net mtDNA sequence divergence between the Western and Eastern clades and let the molecular clock be characterized either by a pairwise divergence rate $r$ (divergence accumulating between two lineages) or, equivalently, by a per-lineage substitution rate $u$ such that $r=2u$. The standard molecular-clock relationship between net divergence and time since lineage splitting is\n$$\nt \\;=\\; \\frac{d_{A}}{r} \\;=\\; \\frac{d_{A}}{2u}.\n$$\nWith the reported values, $d_{A}$ is on the order of $10^{-2}$ and $r$ is on the order of $10^{-2}$ per million years, so $t$ is on the order of millions of years; in either rate parameterization (whether $r$ is interpreted directly as the pairwise rate or as $2u$), the factor of $2$ only changes $t$ by a factor of $2$ and does not alter the order of magnitude. Let $t_{\\text{LGM}}$ denote the time since the Last Glacial Maximum. Given the reported $d_{A}$ and clock rate, the implied $t$ satisfies\n$$\n\\frac{t}{t_{\\text{LGM}}} \\gg 1,\n$$\nso the divergence is far older than the LGM and cannot be a post-LGM event.\n\nThis immediately rejects option B, because a very recent, post-LGM, sympatric divergence within a continuous population would require $t$ to be on the order of $t_{\\text{LGM}}$, which contradicts $t \\gg t_{\\text{LGM}}$. Option C is also inconsistent with the genetic pattern: isolation-by-distance predicts a spatially gradual turnover in haplotypes, not two deeply divergent, monophyletic clades meeting at a narrow contact zone with very limited gene flow; a sharp, parapatric break is not parsimoniously explained by simple isolation-by-distance. Option A posits two widely separated LGM refugia outside the Pyrenees, but the paleoclimatic reconstructions robustly support a single large, contiguous refugium encompassing the present ranges of both clades; accepting A would require discarding the core paleoclimatic result and is therefore not parsimonious given the evidence provided. Option E invokes incomplete lineage sorting from a single large ancestral population coupled with recent geographic sorting during post-glacial expansion. However, the observed narrow contact zone with very limited inter-clade gene flow indicates a strong, spatially concordant historical barrier, whereas recent geographic sorting from a single refugium would more parsimoniously produce broad admixture zones and interdigitation of lineages; furthermore, mtDNA has a small effective population size, making the long-term retention of such deep coalescent splits in a single, panmictic refugial population less likely without corresponding historical structure.\n\nOption D provides a parsimonious reconciliation: coarse-grained climate models can identify a broad, climatically suitable envelope as a contiguous refugium while missing fine-scale topographic, thermal, or hydrological heterogeneity that creates multiple small, stable micro-refugia isolated by unsuitable terrain. Long-term allopatry among such micro-refugia within the broader climatic refugium yields deep divergence times consistent with $t \\gg t_{\\text{LGM}}$. Post-glacial range shifts and limited dispersal then produce a parapatric distribution with a narrow contact zone and little gene flow, matching the observed genetic and geographic patterns. Thus, divergence in allopatry within multiple micro-refugia embedded in the coarse-grained contiguous refugium most comprehensively and parsimoniously explains both the deep genetic split and the paleoclimatic reconstruction.",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "While visual patterns are informative, modern phylogeography relies on rigorous quantitative methods to test hypotheses and infer complex demographic histories. This advanced practice moves beyond qualitative interpretation to the computational level, exploring the statistical signatures of range expansion and \"allele surfing\"—the process where alleles rise to high frequency at an expanding wave front due to serial founder effects . You will design and apply specific summary statistics used in frameworks like Approximate Bayesian Computation ($ABC$) to distinguish expansion from equilibrium scenarios, thus bridging the gap between theoretical population genetics and practical data analysis.",
            "id": "2744109",
            "problem": "You are given a conceptual design task grounded in phylogeography, focusing on distinguishing range expansion with allele surfing from equilibrium isolation by distance. You must translate biological definitions into implementable algorithms and build a simple decision rule, inspired by Approximate Bayesian Computation (ABC), using carefully defined summary statistics.\n\nConsider a one-dimensional transect of demes (subpopulations) at positions $x_{\\ell}$ for $\\ell = 1, \\dots, L$. At each of $S$ independent biallelic loci, you observe the count $k_{\\ell,s}$ of the derived allele in a sample of size $n$ gene copies (haploid count) from deme $\\ell$. The derived allele frequency is $p_{\\ell,s} = k_{\\ell,s} / n$. Assume $n$ is constant across loci and demes. For all formulas below, interpret sums and averages exactly as stated. All computations are to be performed in real numbers.\n\nUse the following fundamental base:\n- Allele frequency is defined as $p = k/n$.\n- Expected heterozygosity at a biallelic locus with allele frequency $p$ is $H = 2p(1-p)$.\n- The sample covariance between a variable $Y$ and $X$ is $\\mathrm{Cov}(X,Y) = \\frac{1}{L} \\sum_{\\ell=1}^{L} (X_{\\ell} - \\bar{X})(Y_{\\ell} - \\bar{Y})$, where $\\bar{X}$ and $\\bar{Y}$ are sample means.\n- The sample variance is $\\mathrm{Var}(X) = \\mathrm{Cov}(X,X)$.\n- The least-squares slope of $Y$ regressed on $X$ is $b_{Y|X} = \\frac{\\mathrm{Cov}(X,Y)}{\\mathrm{Var}(X)}$ when $\\mathrm{Var}(X) > 0$.\n- The Pearson correlation between two length-$L$ vectors $u$ and $v$ is $r(u,v) = \\frac{\\mathrm{Cov}(u,v)}{\\sqrt{\\mathrm{Var}(u)\\,\\mathrm{Var}(v)}}$, defined to be $0$ if $\\mathrm{Var}(u) = 0$ or $\\mathrm{Var}(v) = 0$.\n\nFrom these definitions, derive and implement the following summary statistics:\n1. Heterozygosity gradient. For each deme $\\ell$, compute the mean expected heterozygosity across loci,\n   $$H_{\\ell} = \\frac{1}{S} \\sum_{s=1}^{S} 2 p_{\\ell,s}\\left(1-p_{\\ell,s}\\right).$$\n   Regress $H_{\\ell}$ on distance $x_{\\ell}$ to obtain the slope\n   $$b_H = \\frac{\\mathrm{Cov}(x, H)}{\\mathrm{Var}(x)}.$$\n2. Directionality index. For each locus $s$, compute the Pearson correlation between $x_{\\ell}$ and $p_{\\ell,s}$ across demes,\n   $$r_s = r\\left(\\{x_{\\ell}\\}_{\\ell=1}^{L}, \\{p_{\\ell,s}\\}_{\\ell=1}^{L}\\right).$$\n   Define the directionality index as the mean correlation across loci,\n   $$\\Psi = \\frac{1}{S} \\sum_{s=1}^{S} r_s.$$\n3. Private allele gradient. For each deme $\\ell$, define the private derived allele count $C_{\\ell}$ as the number of loci $s$ with $k_{\\ell,s} > 0$ and $k_{m,s} = 0$ for all $m \\neq \\ell$. The private allele rate is $R_{\\ell} = C_{\\ell}/S$. Regress $R_{\\ell}$ on $x_{\\ell}$ to obtain\n   $$b_P = \\frac{\\mathrm{Cov}(x, R)}{\\mathrm{Var}(x)}.$$\n\nDesign an ABC-inspired decision rule using the signs of these statistics. For a hypothesized expansion from low to high $x$ (source at the smallest $x$), range expansion with allele surfing typically yields decreasing heterozygosity with distance, clinal increases in derived allele frequencies aligned with distance, and an enrichment of private alleles toward the expansion front. Based on this logic, classify a dataset as an expansion if at least two of the following three inequalities hold: $b_H < 0$, $\\Psi > 0$, $b_P > 0$. Otherwise, classify as equilibrium isolation by distance. The classification result must be a boolean.\n\nImplement a program that computes $(b_H, \\Psi, b_P)$ and outputs the classification for each test case below. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True]\").\n\nTest suite:\n- Case A (expansion-like). Use $L = 5$, $S = 8$, $n = 20$. Distances $x = [$0$, $1$, $2$, $3$, $4$]$. Derived allele counts $k_{\\ell,s}$ given as rows of length $S$ for demes $\\ell = 1, \\dots, 5$:\n  - $\\ell=1$: [$8$, $7$, $6$, $4$, $0$, $0$, $5$, $3$]\n  - $\\ell=2$: [$10$, $9$, $8$, $6$, $0$, $0$, $7$, $4$]\n  - $\\ell=3$: [$12$, $12$, $11$, $10$, $0$, $0$, $9$, $5$]\n  - $\\ell=4$: [$14$, $15$, $14$, $14$, $0$, $0$, $11$, $6$]\n  - $\\ell=5$: [$17$, $18$, $17$, $18$, $20$, $18$, $14$, $8$]\n- Case B (equilibrium isolation by distance-like). Use $L = 5$, $S = 8$, $n = 20$. Distances $x = [$0$, $1$, $2$, $3$, $4$]$. Derived allele counts $k_{\\ell,s}$ as:\n  - $\\ell=1$: [$10$, $8$, $12$, $7$, $1$, $9$, $11$, $10$]\n  - $\\ell=2$: [$11$, $9$, $11$, $8$, $0$, $10$, $10$, $10$]\n  - $\\ell=3$: [$10$, $10$, $10$, $10$, $1$, $10$, $9$, $10$]\n  - $\\ell=4$: [$9$, $9$, $11$, $8$, $0$, $10$, $10$, $10$]\n  - $\\ell=5$: [$10$, $8$, $12$, $7$, $1$, $9$, $11$, $10$]\n- Case C (edge case with minimal clinality). Use $L = 4$, $S = 6$, $n = 20$. Distances $x = [$0$, $1$, $2$, $3$]$. Derived allele counts $k_{\\ell,s}$ as:\n  - $\\ell=1$: [$10$, $6$, $14$, $2$, $0$, $8$]\n  - $\\ell=2$: [$10$, $6$, $14$, $0$, $0$, $8$]\n  - $\\ell=3$: [$10$, $6$, $14$, $0$, $0$, $8$]\n  - $\\ell=4$: [$10$, $6$, $14$, $0$, $2$, $8$]\n\nYour program should produce a single line of output containing the boolean classifications for the three cases in order, as a comma-separated list enclosed in square brackets. No spaces are allowed inside the brackets. The output must be in the exact format \"[result_A,result_B,result_C]\". There are no physical units or angle units required, and no percentages are used in the answer. The final outputs are booleans.",
            "solution": "The solution involves implementing the specified algorithm to calculate three summary statistics ($b_H$, $\\Psi$, $b_P$) and apply a decision rule to classify each dataset. The steps are as follows:\n\n1.  **Calculate Allele Frequencies:** For each deme $\\ell$ and locus $s$, the derived allele frequency is computed as $p_{\\ell,s} = k_{\\ell,s} / n$.\n\n2.  **Compute Summary Statistics:**\n    *   **Heterozygosity Gradient ($b_H$):** First, the mean expected heterozygosity $H_{\\ell}$ is calculated for each deme by averaging $2p_{\\ell,s}(1-p_{\\ell,s})$ across all loci. Then, the slope of the linear regression of the $H_{\\ell}$ vector on the distance vector $x$ is determined.\n    *   **Directionality Index ($\\Psi$):** For each locus, the Pearson correlation $r_s$ between allele frequencies $\\{p_{\\ell,s}\\}$ and positions $\\{x_{\\ell}\\}$ is computed. $\\Psi$ is the average of these correlations across all loci.\n    *   **Private Allele Gradient ($b_P$):** The rate of private alleles $R_{\\ell}$ is found for each deme by counting loci where the derived allele is present only in that deme. The slope of the regression of the $R_{\\ell}$ vector on the position vector $x$ is then calculated.\n\n3.  **Apply Decision Rule:** A dataset is classified as `True` (expansion) if at least two of these conditions are met: $b_H  0$, $\\Psi > 0$, and $b_P > 0$. Otherwise, it is `False` (equilibrium).\n\nThe following Python script implements this logic and computes the results for the three test cases.\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the phylogeography classification problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"L\": 5, \"S\": 8, \"n\": 20,\n            \"x\": np.array([0, 1, 2, 3, 4], dtype=float),\n            \"k\": np.array([\n                [8, 7, 6, 4, 0, 0, 5, 3],\n                [10, 9, 8, 6, 0, 0, 7, 4],\n                [12, 12, 11, 10, 0, 0, 9, 5],\n                [14, 15, 14, 14, 0, 0, 11, 6],\n                [17, 18, 17, 18, 20, 18, 14, 8],\n            ], dtype=float)\n        },\n        {\n            \"L\": 5, \"S\": 8, \"n\": 20,\n            \"x\": np.array([0, 1, 2, 3, 4], dtype=float),\n            \"k\": np.array([\n                [10, 8, 12, 7, 1, 9, 11, 10],\n                [11, 9, 11, 8, 0, 10, 10, 10],\n                [10, 10, 10, 10, 1, 10, 9, 10],\n                [9, 9, 11, 8, 0, 10, 10, 10],\n                [10, 8, 12, 7, 1, 9, 11, 10],\n            ], dtype=float)\n        },\n        {\n            \"L\": 4, \"S\": 6, \"n\": 20,\n            \"x\": np.array([0, 1, 2, 3], dtype=float),\n            \"k\": np.array([\n                [10, 6, 14, 2, 0, 8],\n                [10, 6, 14, 0, 0, 8],\n                [10, 6, 14, 0, 0, 8],\n                [10, 6, 14, 0, 2, 8],\n            ], dtype=float)\n        }\n    ]\n\n    def _cov(X, Y):\n        \"\"\"Computes sample covariance with 1/L normalization.\"\"\"\n        if len(X) == 0: return 0.0\n        X_bar = np.mean(X)\n        Y_bar = np.mean(Y)\n        return np.sum((X - X_bar) * (Y - Y_bar)) / len(X)\n\n    def _var(X):\n        \"\"\"Computes sample variance with 1/L normalization.\"\"\"\n        if len(X) == 0: return 0.0\n        return _cov(X, X)\n\n    def _pearson_r(u, v):\n        \"\"\"Computes Pearson correlation coefficient.\"\"\"\n        var_u = _var(u)\n        var_v = _var(v)\n        if var_u == 0 or var_v == 0:\n            return 0.0\n        cov_uv = _cov(u, v)\n        return cov_uv / np.sqrt(var_u * var_v)\n\n    def _slope(Y, X):\n        \"\"\"Computes least-squares slope of Y regressed on X.\"\"\"\n        var_x = _var(X)\n        if var_x == 0:\n            return 0.0\n        cov_xy = _cov(X, Y)\n        return cov_xy / var_x\n        \n    def classify(L, S, n, x, k):\n        \"\"\"\n        Computes the three summary statistics and applies the decision rule.\n        \"\"\"\n        p = k / n\n\n        # 1. Heterozygosity gradient (b_H)\n        H_matrix = 2 * p * (1 - p)\n        H_vector = np.mean(H_matrix, axis=1)\n        b_H = _slope(H_vector, x)\n\n        # 2. Directionality index (Psi)\n        correlations = []\n        p_T = p.T # Transpose to iterate over loci\n        for s in range(S):\n            p_s_vector = p_T[s]\n            r_s = _pearson_r(x, p_s_vector)\n            correlations.append(r_s)\n        Psi = np.mean(correlations) if correlations else 0.0\n\n        # 3. Private allele gradient (b_P)\n        C_vector = np.zeros(L)\n        k_T = k.T # Transpose to iterate over loci\n        for s in range(S):\n            k_s_vector = k_T[s]\n            # A locus has a private allele if exactly one deme has non-zero count\n            if np.count_nonzero(k_s_vector) == 1:\n                # Find which deme has the private allele\n                l_private = np.nonzero(k_s_vector)[0][0]\n                C_vector[l_private] += 1\n        \n        R_vector = C_vector / S\n        b_P = _slope(R_vector, x)\n        \n        # Decision Rule\n        conditions_met = 0\n        if b_H  0:\n            conditions_met += 1\n        if Psi > 0:\n            conditions_met += 1\n        if b_P > 0:\n            conditions_met += 1\n        \n        return conditions_met >= 2\n\n    results = []\n    for case in test_cases:\n        result = classify(case[\"L\"], case[\"S\"], case[\"n\"], case[\"x\"], case[\"k\"])\n        results.append(result)\n\n    # Format the final output string exactly as specified.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```\nThe output of this program is `[True,False,False]`.",
            "answer": "$$\\boxed{\\texttt{[True,False,False]}}$$"
        }
    ]
}