{
    "hands_on_practices": [
        {
            "introduction": "A central question in population genetics is predicting the ultimate fate of a new allele within a population. The diffusion approximation provides a powerful framework for this by modeling the change in allele frequency as a continuous stochastic process. This exercise  guides you through the derivation of the fixation probability by solving the backward Kolmogorov equation, which elegantly balances the deterministic force of selection against the stochastic effects of genetic drift, culminating in Kimura's foundational result.",
            "id": "2700919",
            "problem": "A diploid, randomly mating population of constant effective size $N_e$ follows a Wright–Fisher model with selection. Two alleles $A$ and $a$ segregate at a single locus. The relative viabilities of genotypes are $w_{aa}=1$, $w_{Aa}=1+h\\,s$, and $w_{AA}=1+s$, where $s>0$ and $0 \\leq h \\leq 1$ are constants. A single copy of allele $A$ arises in the population, so its initial frequency is $x_0=\\tfrac{1}{2N_e}$. Assume selection is weak enough that the diffusion approximation is valid.\n\nUse the diffusion approximation with generator $L$ acting on sufficiently smooth functions $f$ of allele frequency $x$ by\n$$\nL f(x) \\equiv a(x)\\,f'(x) + \\frac{1}{2}\\,b(x)\\,f''(x),\n$$\nwhere the drift and diffusion coefficients per generation are the well-tested expressions\n$$\na(x)=s\\,x(1-x)\\big[h+(1-2h)\\,x\\big],\\qquad b(x)=\\frac{x(1-x)}{2N_e}.\n$$\nStarting from the backward Kolmogorov equation for the fixation probability $u(x)$, which satisfies $L u(x)=0$ with boundary conditions $u(0)=0$ and $u(1)=1$, derive $u(x)$ in closed form up to quadratures, then specialize to the additive case $h=\\tfrac{1}{2}$ to obtain an explicit expression. Evaluate the fixation probability $u(x_0)$ for parameters $N_e=5000$, $s=0.01$, $h=\\tfrac{1}{2}$, and $x_0=\\tfrac{1}{2N_e}$. Express your answer as a decimal and round your answer to five significant figures.",
            "solution": "The problem statement is validated against the required criteria.\nGivens are extracted as follows:\n- Population model: Diploid, randomly mating, constant effective size $N_e$, Wright–Fisher dynamics with selection.\n- Alleles: $A$ and $a$ at a single locus.\n- Relative viabilities: $w_{aa}=1$, $w_{Aa}=1+h\\,s$, and $w_{AA}=1+s$.\n- Parameters: $s>0$, $0 \\le h \\le 1$.\n- Initial condition: Allele $A$ frequency is $x_0 = 1/(2N_e)$.\n- Approximation: Weak selection, diffusion approximation is valid.\n- Diffusion generator: $L f(x) = a(x)f'(x) + \\frac{1}{2}b(x)f''(x)$.\n- Drift coefficient: $a(x) = s\\,x(1-x)\\big[h+(1-2h)\\,x\\big]$.\n- Diffusion coefficient: $b(x)=\\frac{x(1-x)}{2N_e}$.\n- Fixation probability $u(x)$ satisfies the backward Kolmogorov equation $L u(x) = 0$ with boundary conditions $u(0)=0$ and $u(1)=1$.\n- Specific numerical parameters for evaluation: $N_e=5000$, $s=0.01$, $h=1/2$, $x_0=1/(2N_e)$.\n\nValidation verdict: The problem is scientifically grounded in established population genetics theory (Wright-Fisher model, diffusion approximation), is mathematically well-posed (a second-order ODE with two boundary conditions admitting a unique solution), and is objective and self-contained. All provided information is consistent and the parameters are realistic. The problem is valid. We proceed with the derivation.\n\nThe fixation probability $u(x)$ of allele $A$ starting from an initial frequency $x$ is given by the solution to the backward Kolmogorov equation $L u(x) = 0$, subject to the boundary conditions $u(0)=0$ (loss is certain if the allele is absent) and $u(1)=1$ (fixation is certain if the allele is the only one present).\nThe equation is:\n$$a(x) u'(x) + \\frac{1}{2}b(x) u''(x) = 0$$\nThis is a second-order linear ordinary differential equation. We can reduce its order by setting $v(x) = u'(x)$, which gives a first-order separable equation for $v(x)$:\n$$\\frac{1}{2}b(x) v'(x) = -a(x) v(x)$$\n$$\\frac{v'(x)}{v(x)} = -\\frac{2a(x)}{b(x)}$$\nWe define a function $\\Psi(x) = \\exp\\left(-\\int \\frac{2a(y)}{b(y)} dy\\right)$. Integrating the equation for $v(x)$ gives $\\ln(v(x)) = -\\int \\frac{2a(x)}{b(x)} dx + C_0$, which implies $v(x) = C_1 \\Psi(x)$ for some constant $C_1$.\nFirst, we compute the ratio $\\frac{2a(x)}{b(x)}$:\n$$\\frac{2a(x)}{b(x)} = \\frac{2 s\\,x(1-x)\\big[h+(1-2h)\\,x\\big]}{\\frac{x(1-x)}{2N_e}} = 4N_e s \\big[h+(1-2h)\\,x\\big]$$\nLet us integrate this term with respect to the allele frequency, which we denote by a dummy variable $y$:\n$$\\int \\frac{2a(y)}{b(y)} dy = \\int 4N_e s \\big[h+(1-2h)\\,y\\big] dy = 4N_e s \\left(hy + (1-2h)\\frac{y^2}{2}\\right)$$\nWe can set the constant of integration to zero as it will be absorbed into the multiplicative constant $C_1$.\nThus, $u'(x) = v(x) = C_1 \\exp\\left(-4N_e s \\left(hx + (1-2h)\\frac{x^2}{2}\\right)\\right)$.\nTo find $u(x)$, we integrate $u'(y)$ from $0$ to $x$:\n$$u(x) - u(0) = \\int_0^x u'(y) dy$$\nSince $u(0)=0$, we have:\n$$u(x) = C_1 \\int_0^x \\exp\\left(-4N_e s \\left(hy + (1-2h)\\frac{y^2}{2}\\right)\\right) dy$$\nTo determine the constant $C_1$, we apply the second boundary condition, $u(1)=1$:\n$$1 = u(1) = C_1 \\int_0^1 \\exp\\left(-4N_e s \\left(hy + (1-2h)\\frac{y^2}{2}\\right)\\right) dy$$\nThis gives $C_1 = \\left( \\int_0^1 \\exp\\left(-4N_e s \\left(hy + (1-2h)\\frac{y^2}{2}\\right)\\right) dy \\right)^{-1}$.\nSubstituting $C_1$ back, we obtain the general solution for the fixation probability in closed form up to quadratures, which is Kimura's celebrated formula:\n$$u(x) = \\frac{\\int_0^x \\exp\\left(-4N_e s \\left(hy + (1-2h)\\frac{y^2}{2}\\right)\\right) dy}{\\int_0^1 \\exp\\left(-4N_e s \\left(hy + (1-2h)\\frac{y^2}{2}\\right)\\right) dy}$$\n\nNext, we specialize to the additive case, where dominance coefficient $h=1/2$. For $h=1/2$, the term $(1-2h)$ becomes $1-2(1/2)=0$. The exponent in the integrands simplifies considerably:\n$$-4N_e s \\left(\\frac{1}{2}y + (0)\\frac{y^2}{2}\\right) = -2N_e s y$$\nThe expression for $u(x)$ becomes:\n$$u(x) = \\frac{\\int_0^x \\exp(-2N_e s y) dy}{\\int_0^1 \\exp(-2N_e s y) dy}$$\nThese are elementary integrals. Let $\\gamma = 2N_e s$.\nThe numerator is $\\int_0^x \\exp(-\\gamma y) dy = \\left[-\\frac{1}{\\gamma}\\exp(-\\gamma y)\\right]_0^x = -\\frac{1}{\\gamma}(\\exp(-\\gamma x) - 1) = \\frac{1 - \\exp(-\\gamma x)}{\\gamma}$.\nThe denominator is $\\int_0^1 \\exp(-\\gamma y) dy = \\left[-\\frac{1}{\\gamma}\\exp(-\\gamma y)\\right]_0^1 = -\\frac{1}{\\gamma}(\\exp(-\\gamma) - 1) = \\frac{1 - \\exp(-\\gamma)}{\\gamma}$.\nDividing the numerator by the denominator, the term $\\gamma$ cancels, and we obtain the explicit expression for the fixation probability in the additive case:\n$$u(x) = \\frac{1 - \\exp(-2N_e s x)}{1 - \\exp(-2N_e s)}$$\n\nFinally, we evaluate this expression for an initial frequency $x_0 = 1/(2N_e)$ and the given parameters $N_e=5000$ and $s=0.01$.\nSubstituting $x = x_0 = 1/(2N_e)$ into the formula for $u(x)$:\n$$u(x_0) = \\frac{1 - \\exp\\left(-2N_e s \\frac{1}{2N_e}\\right)}{1 - \\exp(-2N_e s)} = \\frac{1 - \\exp(-s)}{1 - \\exp(-2N_e s)}$$\nNow, we substitute the numerical values $s=0.01$ and $N_e=5000$:\n$$u(x_0) = \\frac{1 - \\exp(-0.01)}{1 - \\exp(-2 \\times 5000 \\times 0.01)} = \\frac{1 - \\exp(-0.01)}{1 - \\exp(-100)}$$\nWe calculate the values of the terms:\nThe numerator is $1 - \\exp(-0.01) \\approx 1 - 0.9900498337 = 0.0099501663$.\nThe term $\\exp(-100)$ in the denominator is exceedingly small, approximately $3.72 \\times 10^{-44}$.\nThus, the denominator $1 - \\exp(-100)$ is equal to $1$ for all practical purposes and up to many decimal places.\nThe fixation probability is therefore:\n$$u(x_0) \\approx 1 - \\exp(-0.01) \\approx 0.0099501663$$\nThe problem requires the answer to be rounded to five significant figures. The first non-zero digit is the first significant figure. The number is $0.0099501663...$. The first five significant figures are $9, 9, 5, 0, 1$. The sixth significant figure is $6$, which is greater than or equal to $5$, so we round up the fifth digit. The digit $1$ becomes $2$.\nThe rounded decimal value is $0.0099502$.",
            "answer": "$$\\boxed{0.0099502}$$"
        },
        {
            "introduction": "Beyond an allele's ultimate fate, the timescale over which evolutionary change occurs is of fundamental interest. This practice  delves into the temporal dynamics of allele frequency change, asking you to derive both the unconditional mean time to absorption (either fixation or loss) and the more subtle mean time to fixation conditional on the allele's eventual success. You will apply the core diffusion framework to solve for these expected times, and employ advanced techniques like the Doob $h$-transform to handle the conditioned process.",
            "id": "2700930",
            "problem": "Consider the Wright–Fisher (WF) diffusion approximation for a single biallelic locus in a randomly mating population of constant effective size $N$ with no mutation and no dominance. Let $X_{t} \\in [0,1]$ denote the allele frequency of allele $A$ at (continuous) time $t$ measured in generations. Under neutrality (no selection), the Kolmogorov backward operator acting on twice continuously differentiable test functions $f$ is\n$$\n\\mathcal{L} f(x) \\;=\\; \\frac{x(1-x)}{4N}\\, f^{\\prime\\prime}(x),\n$$\nwith absorbing boundaries at $x=0$ and $x=1$.\n\nStarting from this operator and fundamental definitions of absorption times for one-dimensional diffusions with absorbing boundaries, do the following:\n\n1) Derive the ordinary differential equation satisfied by the unconditional mean time to absorption $T(x)$, where $T(x)$ is the expected time for $X_{t}$, started at $X_{0}=x$, to hit either boundary $\\{0,1\\}$, and solve it subject to the appropriate boundary conditions.\n\n2) Let $u(x)$ be the fixation probability of allele $A$ when starting at $x$, and use the conditioning principle for Markov processes (Doob $h$-transform with $h=u$) to construct the backward operator of the process conditioned on eventual fixation at $x=1$. From this transformed operator, derive the differential equation for the mean time to fixation conditional on fixation, denoted $T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x)$, and solve it with the appropriate boundary and regularity conditions to obtain a closed-form expression.\n\n3) Evaluate both expressions at $N = 1.0 \\times 10^{5}$ and initial allele frequency $x_{0} = 0.01$, and report the two numerical values (unconditional mean time to absorption, and mean time to fixation conditional on fixation) in units of generations. Round your answers to four significant figures.\n\nYour final answer must be a pair of numbers in the order $(T(x_{0}),\\, T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x_{0}))$.",
            "solution": "The problem as stated is subjected to validation against established principles of scientific and mathematical rigor.\n\nGivens are extracted verbatim:\n-   Model: Wright–Fisher (WF) diffusion approximation for a single biallelic locus.\n-   Population: Randomly mating, constant effective size $N$.\n-   Genetic parameters: No mutation, no dominance, no selection (neutrality).\n-   State variable: $X_{t} \\in [0,1]$ is the allele frequency at continuous time $t$ (in generations).\n-   Operator: The Kolmogorov backward operator is $\\mathcal{L} f(x) = \\frac{x(1-x)}{4N}\\, f^{\\prime\\prime}(x)$.\n-   Boundaries: Absorbing at $x=0$ and $x=1$.\n-   Quantities to derive:\n    1.  Unconditional mean time to absorption, $T(x)$.\n    2.  Mean time to fixation conditional on fixation, $T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x)$.\n-   Numerical evaluation parameters: $N = 1.0 \\times 10^{5}$, initial frequency $x_{0} = 0.01$.\n\nValidation assessment:\nThe problem is scientifically grounded, being a classic problem in the field of population genetics based on the diffusion theory developed by Sewall Wright and Motoo Kimura. The provided Kolmogorov operator is correct for a neutral process when time is measured in generations. The problem is well-posed, objective, and contains sufficient information for a unique solution. The concepts of mean absorption time and conditional fixation time are standard and solvable using the provided operator and fundamental theory of stochastic processes. The problem is free of logical contradictions, factual errors, and ambiguity.\n\nConclusion of validation: The problem is valid. We proceed with the derivation and solution.\n\nPart 1: Unconditional mean time to absorption, $T(x)$\n\nThe unconditional mean time to absorption, $T(x)$, for a one-dimensional diffusion process started at $x$ is governed by the Dynkin formula, which leads to the ordinary differential equation (ODE):\n$$\n\\mathcal{L} T(x) = -1\n$$\nSubstituting the given operator $\\mathcal{L}$, we have:\n$$\n\\frac{x(1-x)}{4N} T^{\\prime\\prime}(x) = -1\n$$\nwhere $T^{\\prime\\prime}(x)$ is the second derivative of $T(x)$ with respect to $x$. This equation is valid for $x \\in (0,1)$.\nRearranging, we obtain:\n$$\nT^{\\prime\\prime}(x) = -\\frac{4N}{x(1-x)}\n$$\nThe boundaries at $x=0$ and $x=1$ are absorbing. If the process starts at an absorbing boundary, the time to absorption is $0$. Therefore, the boundary conditions are:\n$$\nT(0) = 0 \\quad \\text{and} \\quad T(1) = 0\n$$\nWe integrate $T^{\\prime\\prime}(x)$ once with respect to $x$. Using the partial fraction decomposition $\\frac{1}{x(1-x)} = \\frac{1}{x} + \\frac{1}{1-x}$:\n$$\nT^{\\prime}(x) = \\int -\\frac{4N}{x(1-x)} dx = -4N \\int \\left(\\frac{1}{x} + \\frac{1}{1-x}\\right) dx = -4N \\left(\\ln(x) - \\ln(1-x)\\right) + C_1\n$$\nIntegrating a second time:\n$$\nT(x) = \\int \\left(-4N(\\ln(x) - \\ln(1-x)) + C_1\\right) dx\n$$\nUsing the standard integral $\\int \\ln(u) du = u \\ln(u) - u$, we find:\n$$\nT(x) = -4N \\left[ (x\\ln(x) - x) - (-(1-x)\\ln(1-x) - x) \\right] + C_1 x + C_2\n$$\n$$\nT(x) = -4N \\left( x\\ln(x) + (1-x)\\ln(1-x) \\right) + C_1 x + C_2\n$$\nTo determine the constants $C_1$ and $C_2$, we apply the boundary conditions. We use the limits $\\lim_{u\\to 0^+} u\\ln(u) = 0$.\nAt $x=0$:\n$$\n\\lim_{x\\to 0^+} T(x) = -4N \\left( 0 + 1\\ln(1) \\right) + C_1(0) + C_2 = C_2\n$$\nFrom $T(0)=0$, we have $C_2=0$.\nAt $x=1$:\n$$\n\\lim_{x\\to 1^-} T(x) = -4N \\left( 1\\ln(1) + 0 \\right) + C_1(1) + C_2 = C_1 + C_2\n$$\nFrom $T(1)=0$ and $C_2=0$, we have $C_1=0$.\nThus, the unconditional mean time to absorption is:\n$$\nT(x) = -4N \\left( x \\ln(x) + (1-x)\\ln(1-x) \\right)\n$$\n\nPart 2: Mean time to fixation conditional on fixation, $T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x)$\n\nFirst, we determine the fixation probability, $u(x)$, which satisfies the equation $\\mathcal{L} u(x) = 0$ with boundary conditions $u(0)=0$ (loss) and $u(1)=1$ (fixation).\n$$\n\\frac{x(1-x)}{4N} u^{\\prime\\prime}(x) = 0\n$$\nFor $x \\in (0,1)$, this implies $u^{\\prime\\prime}(x)=0$. Integrating twice yields $u(x) = C_1 x + C_2$.\nApplying the boundary conditions: $u(0)=0 \\implies C_2=0$, and $u(1)=1 \\implies C_1=1$.\nTherefore, the fixation probability is $u(x)=x$.\n\nTo find the dynamics conditional on fixation, we use the Doob $h$-transform with $h(x) = u(x) = x$. The backward operator for the conditioned process, $\\mathcal{L}^*$, acting on a test function $f(x)$, is given by:\n$$\n\\mathcal{L}^* f(x) = \\frac{1}{u(x)} \\mathcal{L} (u(x)f(x))\n$$\nLet's compute $\\mathcal{L}(x f(x))$:\nThe second derivative of $g(x) = x f(x)$ is $g^{\\prime\\prime}(x) = \\frac{d}{dx} (f(x) + xf^{\\prime}(x)) = 2f^{\\prime}(x) + xf^{\\prime\\prime}(x)$.\n$$\n\\mathcal{L}(x f(x)) = \\frac{x(1-x)}{4N} (2f^{\\prime}(x) + xf^{\\prime\\prime}(x))\n$$\nSubstituting this into the expression for $\\mathcal{L}^*$:\n$$\n\\mathcal{L}^* f(x) = \\frac{1}{x} \\left[ \\frac{x(1-x)}{4N} (2f^{\\prime}(x) + xf^{\\prime\\prime}(x)) \\right] = \\frac{x(1-x)}{4N} f^{\\prime\\prime}(x) + \\frac{1-x}{2N} f^{\\prime}(x)\n$$\nThe mean time to fixation, conditional on eventual fixation, $T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x)$, satisfies $\\mathcal{L}^* T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x) = -1$.\n$$\n\\frac{x(1-x)}{4N} T_{\\mathrm{fix}\\mid \\mathrm{fix}}^{\\prime\\prime}(x) + \\frac{1-x}{2N} T_{\\mathrm{fix}\\mid \\mathrm{fix}}^{\\prime}(x) = -1\n$$\nFor $x \\in (0,1)$, we can multiply by $\\frac{4N}{1-x}$:\n$$\nx T_{\\mathrm{fix}\\mid \\mathrm{fix}}^{\\prime\\prime}(x) + 2 T_{\\mathrm{fix}\\mid \\mathrm{fix}}^{\\prime}(x) = -\\frac{4N}{1-x}\n$$\nThis is a first-order linear ODE for $v(x) = T_{\\mathrm{fix}\\mid \\mathrm{fix}}^{\\prime}(x)$. The left side can be written as $(x^2 v(x))' / x$. An integrating factor approach is more direct. Let $v(x) = T_{\\mathrm{fix}\\mid \\mathrm{fix}}'(x)$. The equation is $v' + \\frac{2}{x} v = -\\frac{4N}{x(1-x)}$. The integrating factor is $\\exp(\\int \\frac{2}{x} dx) = x^2$. Multiplying by $x^2$ gives:\n$$\nx^2 v'(x) + 2x v(x) = \\frac{d}{dx}(x^2 v(x)) = -\\frac{4Nx}{1-x} = 4N - \\frac{4N}{1-x}\n$$\nIntegrating with respect to $x$:\n$$\nx^2 v(x) = 4Nx + 4N \\ln(1-x) + C_1\n$$\n$$\nv(x) = T_{\\mathrm{fix}\\mid \\mathrm{fix}}^{\\prime}(x) = \\frac{4N}{x} + \\frac{4N\\ln(1-x)}{x^2} + \\frac{C_1}{x^2}\n$$\nThe conditioned process is absorbed at $x=1$ and the boundary at $x=0$ has become inaccessible (reflecting). The mean time $T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x)$ must remain finite as $x \\to 0^+$. If $C_1 \\neq 0$, the term $C_1/x^2$ in the derivative would lead to a divergence of type $1/x$ in $T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x)$ near $x=0$. Therefore, regularity requires $C_1=0$.\nSo, $T_{\\mathrm{fix}\\mid \\mathrm{fix}}^{\\prime}(x) = \\frac{4N}{x} + \\frac{4N\\ln(1-x)}{x^2}$.\nIntegrating to find $T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x)$:\n$$\nT_{\\mathrm{fix}\\mid \\mathrm{fix}}(x) = \\int \\left(\\frac{4N}{x} + \\frac{4N\\ln(1-x)}{x^2}\\right) dx = 4N \\ln(x) + 4N \\int \\frac{\\ln(1-x)}{x^2} dx + C_2\n$$\nThe second integral is solved by parts: $\\int u dv = uv - \\int v du$. Let $u=\\ln(1-x)$ and $dv=x^{-2}dx$. Then $du = \\frac{-1}{1-x}dx$ and $v=-x^{-1}$.\n$$\n\\int \\frac{\\ln(1-x)}{x^2} dx = -\\frac{\\ln(1-x)}{x} - \\int \\frac{1}{x(1-x)} dx = -\\frac{\\ln(1-x)}{x} - \\ln(x) + \\ln(1-x)\n$$\nSubstituting this back:\n$$\nT_{\\mathrm{fix}\\mid \\mathrm{fix}}(x) = 4N \\ln(x) + 4N \\left( -\\frac{\\ln(1-x)}{x} - \\ln(x) + \\ln(1-x) \\right) + C_2\n$$\n$$\nT_{\\mathrm{fix}\\mid \\mathrm{fix}}(x) = -4N \\frac{\\ln(1-x)}{x} + 4N \\ln(1-x) + C_2 = -4N \\frac{1-x}{x} \\ln(1-x) + C_2\n$$\nThe boundary condition for the conditioned process is absorption at $x=1$, so $T_{\\mathrm{fix}\\mid \\mathrm{fix}}(1)=0$.\nTaking the limit as $x \\to 1^-$:\n$$\n\\lim_{x\\to 1^-} T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x) = \\lim_{x\\to 1^-} \\left( -4N \\frac{1-x}{x} \\ln(1-x) \\right) + C_2 = 0 + C_2\n$$\nThis implies $C_2=0$.\nThe mean time to fixation, conditional on fixation, is:\n$$\nT_{\\mathrm{fix}\\mid \\mathrm{fix}}(x) = -4N \\frac{1-x}{x} \\ln(1-x)\n$$\n\nPart 3: Numerical Evaluation\n\nWe are given $N = 1.0 \\times 10^5$ and $x_0 = 0.01$.\n\n1) Unconditional mean time to absorption $T(x_0)$:\n$$\nT(0.01) = -4(1.0 \\times 10^5) \\left( 0.01 \\ln(0.01) + (1-0.01)\\ln(1-0.01) \\right)\n$$\n$$\nT(0.01) = -4.0 \\times 10^5 \\left( 0.01 \\ln(0.01) + 0.99 \\ln(0.99) \\right)\n$$\nUsing a calculator: $\\ln(0.01) \\approx -4.60517$ and $\\ln(0.99) \\approx -0.0100503$.\n$$\nT(0.01) \\approx -4.0 \\times 10^5 \\left( 0.01(-4.60517) + 0.99(-0.0100503) \\right)\n$$\n$$\nT(0.01) \\approx -4.0 \\times 10^5 \\left( -0.0460517 - 0.0099498 \\right) = -4.0 \\times 10^5(-0.0560015) \\approx 22400.6\n$$\nRounded to four significant figures, $T(x_0) = 2.240 \\times 10^4$ generations.\n\n2) Mean time to fixation conditional on fixation $T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x_0)$:\n$$\nT_{\\mathrm{fix}\\mid \\mathrm{fix}}(0.01) = -4(1.0 \\times 10^5) \\frac{1-0.01}{0.01} \\ln(1-0.01)\n$$\n$$\nT_{\\mathrm{fix}\\mid \\mathrm{fix}}(0.01) = -4.0 \\times 10^5 \\frac{0.99}{0.01} \\ln(0.99) = -4.0 \\times 10^5 \\times 99 \\times \\ln(0.99)\n$$\n$$\nT_{\\mathrm{fix}\\mid \\mathrm{fix}}(0.01) \\approx -4.0 \\times 10^5 \\times 99 \\times (-0.0100503) \\approx 397993.3\n$$\nRounded to four significant figures, $T_{\\mathrm{fix}\\mid \\mathrm{fix}}(x_0) = 3.980 \\times 10^5$ generations.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.240 \\times 10^4 & 3.980 \\times 10^5 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Diffusion models rely on the concept of effective population size, $N_e$, which quantifies the magnitude of genetic drift. While theoretical models often assume a constant $N_e$, real populations fluctuate in size, presenting a challenge for applying these models. This exercise  bridges this gap by guiding you to derive, from first principles, the appropriate $N_e$ for a population with a time-varying demographic history, revealing the crucial importance of the harmonic mean in summarizing long-term drift.",
            "id": "2700934",
            "problem": "A neutral biallelic locus evolves in a diploid population with nonoverlapping generations and random mating. Assume that the Wright–Fisher diffusion (WFD) approximation applies to the allele-frequency process. Let $X_{t} \\in [0,1]$ denote the allele frequency at generation $t$. Under neutrality, the generational-scale diffusion for $X_{t}$ has zero drift and a time-dependent variance coefficient determined by the census population size $N(t)$.\n\nOver a fixed planning horizon of $T$ generations, the demography is piecewise constant:\n- Epoch $1$: $N(t)=5000$ for $0 \\le t < 200$ (i.e., duration $\\Delta t_{1}=200$).\n- Epoch $2$: $N(t)=200$ for $200 \\le t < 220$ (i.e., duration $\\Delta t_{2}=20$).\n- Epoch $3$: $N(t)=10000$ for $220 \\le t < 520$ (i.e., duration $\\Delta t_{3}=300$).\n- Epoch $4$: $N(t)=1000$ for $520 \\le t \\le 600$ (i.e., duration $\\Delta t_{4}=80$).\n\nThus, the total horizon is $T=600$ generations.\n\nDefine the single constant effective population size $N_{e}$ for this horizon to be the value such that, when the WFD with constant size $N_{e}$ is run for the same horizon of $T$ generations, it generates the same total integrated diffusion-scale variance as the original time-varying model for every possible allele-frequency trajectory. Starting from first principles of the WFD under neutrality, derive an expression for $N_{e}$ in terms of $\\{N(t)\\}_{t \\in [0,T]}$ and $T$, and then evaluate $N_{e}$ numerically for the demography specified above.\n\nExpress your final answer as the number of diploid individuals (unit: individuals). Provide the exact integer; no rounding is required. Do not include units in your final numeric entry.",
            "solution": "The posed problem requires derivation of the effective population size $N_{e}$ for a population with a time-varying census size $N(t)$. The definition provided is that $N_{e}$ is the constant size that results in the same total integrated diffusion-scale variance over a time horizon $T$ as the time-varying model. This problem is scientifically grounded and well-posed. We shall proceed with the derivation from first principles.\n\nThe evolution of an allele frequency $X_{t}$ under the Wright–Fisher diffusion (WFD) approximation for a neutral locus in a diploid population of time-varying size $N(t)$ is described by the following stochastic differential equation (SDE):\n$$\nd X_{t} = \\sqrt{\\frac{X_{t}(1 - X_{t})}{2N(t)}} dW_{t}\n$$\nwhere $W_{t}$ is a standard Wiener process. The term $\\frac{X_{t}(1 - X_{t})}{2N(t)}$ is the instantaneous variance of the change in allele frequency per generation, and the coefficient $\\frac{1}{2N(t)}$ dictates the rate at which genetic drift proceeds.\n\nThe problem defines the constant effective size $N_{e}$ as the value that equates the \"total integrated diffusion-scale variance\" of the time-varying process with that of a process having a constant size $N_{e}$ over the same total horizon $T$. The component of the variance term that depends on population size and time is $\\frac{1}{2N(t)}$. The \"total integrated\" effect of this term over the interval $[0, T]$ is its integral with respect to time.\n\nFor the process with time-varying population size $N(t)$, this integrated quantity, which we denote $\\mathcal{V}_{var}$, is:\n$$\n\\mathcal{V}_{var} = \\int_{0}^{T} \\frac{1}{2N(t)} dt\n$$\nThis can be interpreted as the total accumulated \"genetic drift time\" over the $T$ generations.\n\nFor a process with a constant population size $N_{e}$ over the same horizon $T$, the corresponding quantity, $\\mathcal{V}_{const}$, is:\n$$\n\\mathcal{V}_{const} = \\int_{0}^{T} \\frac{1}{2N_{e}} dt = \\frac{1}{2N_{e}} \\int_{0}^{T} dt = \\frac{T}{2N_{e}}\n$$\nAccording to the problem's definition of $N_{e}$, we must have $\\mathcal{V}_{var} = \\mathcal{V}_{const}$. Therefore, we set the two expressions equal:\n$$\n\\frac{T}{2N_{e}} = \\int_{0}^{T} \\frac{1}{2N(t)} dt\n$$\nWe can cancel the factor of $\\frac{1}{2}$ from both sides to obtain:\n$$\n\\frac{T}{N_{e}} = \\int_{0}^{T} \\frac{1}{N(t)} dt\n$$\nSolving for $N_{e}$ yields the general expression for the effective population size over the horizon $T$:\n$$\nN_{e} = \\frac{T}{\\int_{0}^{T} \\frac{dt}{N(t)}}\n$$\nThis demonstrates that the effective population size over a period of fluctuating census size is the harmonic mean of the census size over that period.\n\nNow, we apply this general formula to the specific piecewise constant demography provided. The total time horizon is $T = 600$ generations. The integral in the denominator must be evaluated over the four specified epochs. Let the population sizes be $N_{i}$ for durations $\\Delta t_{i}$, where $i \\in \\{1, 2, 3, 4\\}$.\nThe integral is calculated as a sum:\n$$\n\\int_{0}^{T} \\frac{dt}{N(t)} = \\sum_{i=1}^{4} \\int_{t_{i-1}}^{t_{i}} \\frac{dt}{N_{i}} = \\sum_{i=1}^{4} \\frac{1}{N_{i}} (t_{i} - t_{i-1}) = \\sum_{i=1}^{4} \\frac{\\Delta t_{i}}{N_{i}}\n$$\nThe specific values are:\n- Epoch $1$: $N_1 = 5000$, $\\Delta t_1 = 200$ generations.\n- Epoch $2$: $N_2 = 200$, $\\Delta t_2 = 20$ generations.\n- Epoch $3$: $N_3 = 10000$, $\\Delta t_3 = 300$ generations.\n- Epoch $4$: $N_4 = 1000$, $\\Delta t_4 = 80$ generations.\n\nThe total duration is $T = \\Delta t_1 + \\Delta t_2 + \\Delta t_3 + \\Delta t_4 = 200 + 20 + 300 + 80 = 600$ generations, which is consistent.\n\nWe compute the sum in the denominator:\n$$\n\\sum_{i=1}^{4} \\frac{\\Delta t_{i}}{N_{i}} = \\frac{\\Delta t_{1}}{N_{1}} + \\frac{\\Delta t_{2}}{N_{2}} + \\frac{\\Delta t_{3}}{N_{3}} + \\frac{\\Delta t_{4}}{N_{4}}\n$$\n$$\n\\sum_{i=1}^{4} \\frac{\\Delta t_{i}}{N_{i}} = \\frac{200}{5000} + \\frac{20}{200} + \\frac{300}{10000} + \\frac{80}{1000}\n$$\nWe simplify each term:\n$$\n\\frac{200}{5000} = \\frac{2}{50} = \\frac{1}{25}\n$$\n$$\n\\frac{20}{200} = \\frac{1}{10}\n$$\n$$\n\\frac{300}{10000} = \\frac{3}{100}\n$$\n$$\n\\frac{80}{1000} = \\frac{8}{100} = \\frac{2}{25}\n$$\nNow, we sum these fractions:\n$$\n\\sum_{i=1}^{4} \\frac{\\Delta t_{i}}{N_{i}} = \\frac{1}{25} + \\frac{1}{10} + \\frac{3}{100} + \\frac{2}{25} = \\frac{4}{100} + \\frac{10}{100} + \\frac{3}{100} + \\frac{8}{100} = \\frac{4+10+3+8}{100} = \\frac{25}{100} = \\frac{1}{4}\n$$\nFinally, we substitute this result back into the formula for $N_{e}$:\n$$\nN_{e} = \\frac{T}{\\sum_{i=1}^{4} \\frac{\\Delta t_{i}}{N_{i}}} = \\frac{600}{\\frac{1}{4}} = 600 \\times 4 = 2400\n$$\nThe effective population size for the entire $600$-generation horizon is $2400$ diploid individuals.",
            "answer": "$$\n\\boxed{2400}\n$$"
        }
    ]
}