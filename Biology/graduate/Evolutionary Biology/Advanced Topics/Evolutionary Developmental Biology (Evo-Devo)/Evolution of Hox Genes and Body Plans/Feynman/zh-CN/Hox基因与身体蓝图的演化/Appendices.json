{
    "hands_on_practices": [
        {
            "introduction": "Hox基因簇的一个显著特征是共线性，即基因在染色体上的位置与其在胚胎中的表达区域相对应。一个相关的进化假说提出，这种物理顺序也反映了基因的序列进化过程。本练习将引导你使用一种基础的统计方法，来检验一个关于Hox基因簇内基因组位置与进化距离之间关联的假设，为你提供量化分析进化模式的实践经验。",
            "id": "1685840",
            "problem": "在发育生物学中，Hox基因是转录因子的一个家族，对沿前后轴建立体制至关重要。在许多动物中，这些基因在染色体上以基因簇的形式进行物理排列。一个被称为共线性的显著现象描述了基因在簇中的位置与其在发育胚胎中的表达域之间的关系：位于簇3'端的基因在前部区域表达，而位于5'端的基因在后部区域表达。\n\n一个进化假说提出了第二种形式的共线性：即Hox基因的基因组顺序也反映了它们的序列进化。具体来说，该假说认为，在基因簇内位置更近的基因，其序列相似性要高于位置较远的基因，这表明基因簇是通过局部基因复制逐步进化而来的。\n\n为了检验这一假说，我们提供了一个假想脊椎动物物种的数据。该物种拥有一个单一的Hox基因簇，包含四个基因，从3'端到5'端依次排列为`Hox-1`、`Hox-2`、`Hox-3`和`Hox-4`。每对基因的蛋白质产物之间的进化距离是根据其高度保守的同源异型结构域区域中的氨基酸差异数量计算得出的。两两之间的距离如下：\n\n-   距离(`Hox-1`, `Hox-2`): 10\n-   距离(`Hox-1`, `Hox-3`): 18\n-   距离(`Hox-1`, `Hox-4`): 25\n-   距离(`Hox-2`, `Hox-3`): 12\n-   距离(`Hox-2`, `Hox-4`): 20\n-   距离(`Hox-3`, `Hox-4`): 9\n\n你的任务是量化基因在染色体上的物理间隔与其进化距离之间的关联强度。将“基因组间隔”定义为基因数字标识符的绝对差（例如，`Hox-1`和`Hox-3`之间的间隔为 $3 - 1 = 2$）。\n\n计算基因组间隔与进化距离之间的斯皮尔曼等级相关系数 $\\rho$。将你的最终答案四舍五入到四位有效数字。",
            "solution": "给定一个单一Hox基因簇，其中有四个基因，按Hox-1、Hox-2、Hox-3、Hox-4的顺序排列。对于每个无序基因对，将基因组间隔定义为其索引的绝对差，并使用给定的进化距离。这六个基因对及其数值如下：\n- $(\\text{Hox-1},\\text{Hox-2})$: 间隔 $s=|1-2|=1$, 距离 $d=10$。\n- $(\\text{Hox-1},\\text{Hox-3})$: $s=|1-3|=2$, $d=18$。\n- $(\\text{Hox-1},\\text{Hox-4})$: $s=|1-4|=3$, $d=25$。\n- $(\\text{Hox-2},\\text{Hox-3})$: $s=|2-3|=1$, $d=12$。\n- $(\\text{Hox-2},\\text{Hox-4})$: $s=|2-4|=2$, $d=20$。\n- $(\\text{Hox-3},\\text{Hox-4})$: $s=|3-4|=1$, $d=9$。\n\n斯皮尔曼等级相关系数 $\\rho$ 是间隔 $s$ 和距离 $d$ 的等级的皮尔逊相关系数。对 $s$ 进行等级排序（对相同值取平均等级），并对 $d$ 进行等级排序（所有值均不相同）：\n- 间隔 $s$ 的值为 $1,1,1,2,2,3$。它们的等级分别为 $2,2,2,4.5,4.5,6$。\n- 距离 $d$ 的值为 $9,10,12,18,20,25$，其等级分别为 $1,2,3,4,5,6$。\n\n按照上面列出的基因对顺序对齐，得到等级向量\n$$r_{s}=(2,\\,4.5,\\,6,\\,2,\\,4.5,\\,2),\\qquad r_{d}=(2,\\,4,\\,6,\\,3,\\,5,\\,1).$$\n令 $\\bar{r}_{s}$ 和 $\\bar{r}_{d}$ 表示均值。由于等级是从1到6，两个均值均为\n$$\\bar{r}_{s}=\\bar{r}_{d}=\\frac{1+2+3+4+5+6}{6}=\\frac{21}{6}=3.5.$$\n计算协方差的分子以及离差平方和：\n$$\\sum_{i=1}^{6}(r_{s,i}-\\bar{r}_{s})(r_{d,i}-\\bar{r}_{d})=15,$$\n$$\\sum_{i=1}^{6}(r_{s,i}-\\bar{r}_{s})^{2}=15,\\qquad \\sum_{i=1}^{6}(r_{d,i}-\\bar{r}_{d})^{2}=17.5=\\frac{35}{2}.$$\n因此，\n$$\\rho=\\frac{\\sum_{i}(r_{s,i}-\\bar{r}_{s})(r_{d,i}-\\bar{r}_{d})}{\\sqrt{\\left[\\sum_{i}(r_{s,i}-\\bar{r}_{s})^{2}\\right]\\left[\\sum_{i}(r_{d,i}-\\bar{r}_{d})^{2}\\right]}}=\\frac{15}{\\sqrt{15\\cdot \\frac{35}{2}}}=\\frac{15}{\\sqrt{\\frac{525}{2}}}=\\frac{3\\sqrt{2}}{\\sqrt{21}}=\\frac{\\sqrt{42}}{7}.$$\n数值上，四舍五入到四位有效数字，\n$$\\rho\\approx 0.9258.$$",
            "answer": "$$\\boxed{0.9258}$$"
        },
        {
            "introduction": "Hox基因的精确调控不仅依赖于其邻近的增强子，还涉及到在三维空间中与大型调控域（如拓扑关联域，TADs）的动态相互作用。本练习模拟了一个前沿的研究场景，要求你设计一个结合高通量染色体构象捕获（Hi-C）和捕获-C（Capture-C）技术的实验方案，以量化HoxD基因簇在肢体发育过程中的调控转换。这项实践旨在培养你作为一名研究生的实验设计能力，将抽象的进化发育生物学概念与具体的基因组学数据分析策略联系起来。",
            "id": "2636272",
            "problem": "您正在研究HoxD基因簇的三维染色体结构在肢体发育过程中如何在两个调控域之间切换。HoxD基因簇位于一个端粒侧调控域 (T-DOM) 和一个着丝粒侧调控域 (C-DOM) 之间的边界上，每个调控域都形成一个拓扑关联域 (TAD; Topologically Associating Domain)。您已经从发育中的肢芽中获得了多个发育阶段（从早期到晚期）带有生物学重复的群体原位高通量染色体构象捕获 (Hi-C; High-throughput Chromosome Conformation Capture) 和启动子捕获-C (Capture-C; promoter-focused Chromosome Conformation Capture) 数据集。您的目标是量化HoxD基因簇与T-DOM和C-DOM之间接触的时间切换过程，并明确如何在时间上以及沿着HoxD基因簇的基因组轴线上检测到转换点。\n\n基于以下经过充分验证的事实：(i) 增强子-启动子调控依赖于细胞核内的物理邻近性；(ii) Hi-C 提供的接触计数与接触概率成正比，并具有强烈的距离依赖性衰减；(iii) Capture-C 富集了来自选定视点的接触；(iv) TAD 边界与绝缘分数的局部最小值以及接触方向性的变化相吻合，请选择一个最佳的实验-计算设计方案，该方案能够提供切换过程的量化指标，并能客观、有统计学支持地检测到转换点。您的设计必须考虑到 Hi-C 数据中的偏差、接触概率的距离依赖性衰减以及重复样本间的生物学变异。\n\n哪个选项最能满足这些标准？\n\nA. 进行深度测序的原位 Hi-C (分辨率 $\\leq 5\\,\\mathrm{kb}$ bins) 和以 Hoxd9–Hoxd13 为视点的启动子 Capture-C，涵盖至少 $3$ 个发育阶段，每个阶段 $\\geq 2$ 个生物学重复。使用迭代校正和特征向量分解 (ICE; Iterative Correction and Eigenvector decomposition) 对 Hi-C 数据进行归一化，以获得每个阶段 $t$ 的 $N_{ij}^{(t)}$，然后通过将每个 $N_{ij}^{(t)}$ 除以在基因组距离 $d=|i-j|$ 处所有配对的阶段特异性平均值，来计算距离分层的观察值/期望值 $O/E$。定义端粒侧 bins $T$、着丝粒侧 bins $C$ 和 HoxD 锚定 bins $H$。对于每个阶段，量化一个 HoxD 切换分数\n$$\nS^{(t)}=\\log_2\\left(\\frac{\\sum_{h\\in H}\\sum_{j\\in T} (O/E)_{hj}^{(t)}}{\\sum_{h\\in H}\\sum_{j\\in C} (O/E)_{hj}^{(t)}}\\right),\n$$\n并通过累积和分割来检验时间变化点 $\\hat{\\tau}$\n$$\n\\hat{\\tau}=\\arg\\max_{1<\\tau<T}\\left|\\sum_{t=1}^{\\tau}\\left(S^{(t)}-\\bar{S}\\right)\\right|,\n$$\n在一个线性混合模型中，将阶段作为固定效应，将重复作为随机效应，以评估显著性。在 Capture-C 数据中，经过文库大小因子归一化后，类似地计算每个视点的 $S_h^{(t)}$，并将基因组转换点 $\\hat{h}$ 检测为 HoxD 上 $S_h^{(t)}$ 穿过零点的位置，该位置与方向性指数 (DI; Directionality Index) 的变化一致，\n$$\nDI(i)=\\frac{\\sum_{j>i} (O/E)_{ij}-\\sum_{j<i} (O/E)_{ij}}{\\sum_{j\\neq i} (O/E)_{ij}},\n$$\n并通过 bootstrap 方法计算置信区间。将非肢体组织作为阴性对照，并验证当使用从 T-DOM 切换到 C-DOM 时，HoxD 边界处的绝缘最小值在位置上保持稳定。\n\nB. 生成分辨率为 $1\\,\\mathrm{Mb}$ 的标准 Hi-C 数据，不进行归一化，通过 HoxD 与染色体 p 臂和 q 臂的总原始接触数的比率来量化切换。将该比率首次超过 $1$ 的阶段定义为转换点，并忽略 Capture-C，因为 Hi-C 已经覆盖了整个基因组。\n\nC. 仅使用 RNA 测序来检测端粒侧基因（例如 Hoxd9–Hoxd11）和着丝粒侧基因（例如 Hoxd12–Hoxd13）之间表达的时间切换。基于转录切换意味着接触切换的假设，将这两组基因之间 $\\log_2$ 倍数变化穿过 $0$ 的阶段推断为转换点，并跳过任何三维染色体构象分析。\n\nD. 在所有阶段中，从分辨率为 $40\\,\\mathrm{kb}$ 的 Hi-C 数据计算绝缘分数，并将绝缘最小值的位点从 HoxD 的端粒侧移动到其着丝粒侧的阶段定义为转换点。使用这种位置上的移动作为接触已发生切换的证据。省略 Capture-C，因为绝缘分数已经可以识别 TAD 的行为。\n\nE. 在每个阶段进行 Hi-C 实验，并计算全基因组 A/B 区室的主成分 1 (PC1)。将 HoxD 区域上 PC1 的符号发生翻转的阶段确定为转换点。辅以转座酶可及性染色质测序 (ATAC-seq; Assay for Transposase-Accessible Chromatin using sequencing) 来确认增强子激活，并放弃 Capture-C，因为区室反映的是大规模的接触变化。",
            "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n-   **生物系统**：肢体发育过程中 HoxD 基因簇的三维染色体结构。\n-   **关键结构**：一个端粒侧调控域 (T-DOM) 和一个着丝粒侧调控域 (C-DOM)，每个都形成一个拓扑关联域 (TAD)。HoxD 基因簇位于这两个 TAD 的边界。\n-   **过程**：HoxD 基因簇所形成的接触在发育过程中发生时间上的切换，从与 T-DOM 接触转为与 C-DOM 接触。\n-   **可用数据**：群体原位高通量染色体构象捕获 (Hi-C) 和启动子捕获-C 数据集。数据跨越多个发育阶段（从早期到晚期）并包括生物学重复。\n-   **目标**：\n    1.  量化 HoxD 基因簇与 T-DOM 和 C-DOM 之间接触的时间切换过程。\n    2.  开发一种方法来检测时间（发育阶段）上的转换点。\n    3.  开发一种方法来检测沿 HoxD 基因簇基因组轴线上的转换点。\n-   **基本事实**：\n    -   (i) 增强子-启动子调控需要物理上的邻近。\n    -   (ii) Hi-C 产生的接触计数与接触概率成正比，并有强烈的距离依赖性信号衰减。\n    -   (iii) Capture-C 富集了来自特定基因组视点的接触。\n    -   (iv) TAD 边界与绝缘分数的局部最小值和接触方向性的变化相关联。\n-   **设计约束**：所提出的解决方案必须：\n    -   是一个实验-计算设计。\n    -   提供切换现象的量化度量。\n    -   客观且有统计学支持地检测转换点。\n    -   校正 Hi-C 数据中固有的偏差。\n    -   考虑接触概率的距离依赖性衰减。\n    -   考虑重复样本间的生物学变异。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述具有科学依据、提法恰当且客观。\n1.  **科学依据**：该问题设置在 3D 基因组学和发育生物学这一成熟的框架内。HoxD 基因簇的调控动态是一个经典的模式系统，已被该领域的领军人物（例如 Duboule 实验室）广泛研究。所有提到的技术（Hi-C、Capture-C）和概念（TADs、绝缘子、增强子）都是现代分子生物学的基础。基本事实是正确的。\n2.  **提法恰当性**：目标表述清晰，具有具体的、可衡量的结果（量化切换过程，检测转换点）。列出了可用数据和约束条件，为设计解决方案提供了完整的基础。\n3.  **客观性**：语言技术性强且精确，没有歧义或主观性陈述。它明确要求一个“客观的、有统计学支持的”解决方案。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。它在定量和计算生物学领域提出了一个复杂但可解决的挑战，该挑战基于可靠的科学原理和真实的实验场景。我现在将开始评估所提出的选项。\n\n**逐项分析选项**\n\n**选项 A**：\n该选项提出了一个全面且方法学上严谨的设计。\n-   **实验**：高分辨率 Hi-C ($\\leq 5\\,\\mathrm{kb}$) 适用于解析基因簇水平的相互作用。包含针对 $Hoxd9–Hoxd13$ 的启动子 Capture-C 为以启动子为中心的相互作用提供了必要的深度。使用多个阶段和重复对于时间分析和统计评估至关重要，满足了考虑变异性的需求。使用非肢体组织作为对照是良好实验设计的标志。\n-   **数据处理**：它正确地指明了使用迭代校正和特征向量分解 (ICE) 来归一化 Hi-C 偏差，以及计算观察值/期望值 ($O/E$) 矩阵来校正接触概率的基因组距离依赖性衰减。这些是解决问题核心约束的最先进程序。\n-   **量化**：切换分数 $S^{(t)}$ 是一个直接的、定量的度量，用于衡量 HoxD 基因簇对 T-DOM 与 C-DOM 的相对接触偏好。$\\log_2$ 标度是生物学中表示比率的标准方法。\n-   **时间转换点检测**：使用累积和 (CUSUM) 分割是一种正式的统计方法，用于在一个时间序列 ($S^{(t)}$) 中进行变化点检测，为识别 $\\hat{\\tau}$ 提供了一种客观的方式。所提出的线性混合模型正确地将阶段视为固定效应，将重复视为随机效应，从而恰当地模拟了数据结构并考虑了生物学变异性。\n-   **基因组转换点检测**：使用每个视点的分数 $S_h^{(t)}$ 来分析 Capture-C 数据是合适的，可以识别哪个 HoxD 基因起到了枢轴作用。将该分数穿过零点的基因定义为转换点 $\\hat{h}$ 是一个合乎逻辑的标准。将此与方向性指数 (DI) 进行交叉引用，并通过 bootstrap 计算置信区间，增加了多层统计验证。\n-   **对照**：验证一个稳定的绝缘最小值，证实了这是调控切换的模型，而非大规模结构重组。\n\n该选项系统地解决了问题陈述的每一项要求，使用了恰当、复杂且统计上稳健的方法。它代表了该领域的当前最佳实践。\n**结论：正确**\n\n**选项 B**：\n此选项存在根本性缺陷。\n-   **分辨率**：$1\\,\\mathrm{Mb}$ 的分辨率远远不够。整个 HoxD 基因簇（约 $100\\,\\mathrm{kb}$）及其侧翼的 TADs（每个约 $1\\,\\mathrm{Mb}$）将被模糊到几个数据点中，使得无法分析所需的特定相互作用。\n-   **归一化**：明确省略归一化（“不进行归一化”）是一个严重错误。原始 Hi-C 数据主要受实验偏差和距离效应的影响，使其不适用于长程相互作用的定量比较。\n-   **生物学目标**：对于这个问题，将接触与整个 p 臂和 q 臂进行比较在生物学上是无稽之谈。T-DOM 和 C-DOM 是位于同一染色体臂上的相邻结构域。\n-   **统计学**：通过原始比率超过 $1$ 来定义转换点是一个随意的、非统计学的阈值。\n\n这种方法很幼稚，表明对生物学背景和 Hi-C 数据分析原理都存在误解。\n**结论：错误**\n\n**选项 C**：\n这个选项回避了核心问题。\n-   **方法**：问题要求量化三维“接触”和“染色体结构”。该选项建议仅使用 RNA 测序，它测量的是基因表达，即调控结构的下游*结果*。虽然相关，但转录并非物理接触的直接度量。\n-   **假设**：它依赖于一个强烈但并非总是正确的假设，即转录切换完美地反映了接触切换。染色质接触可以是抑制性的，其动态可能与 mRNA 水平的变化不完全同步。\n-   **数据使用**：它明确建议“跳过任何三维染色体构象分析”，从而忽略了提供的主要数据（Hi-C、Capture-C）和问题的核心。\n\n这个选项将问题从一个生物物理学和基因组学的问题，变成了一个转录组学的问题。\n**结论：错误**\n\n**选项 D**：\n这个选项误解了生物学现象。\n-   **度量**：它关注的是标志着 TAD 边界的绝缘最小值的*位置*。问题是关于从 HoxD 基因簇到边界*两侧*结构域的*接触频率的切换*。一个稳定的边界伴随接触模式的变化是一种已知的调控机制，而此选项并未测试这一点。选项 A 正确地将边界稳定性检查作为一项对照。\n-   **推断**：绝缘分数最小值的移动是接触模式变化的间接代理指标，而不是对特定区域（HoxD 和 T-DOM/C-DOM）之间接触的直接量化。\n-   **数据使用**：它排除了 Capture-C，这是获取特定启动子相互作用高分辨率信息的最强大工具，其依据是绝缘分数足以识别 TAD 行为这一不正确的前提。\n\n这个选项将边界与其调控的活动混淆了。\n**结论：错误**\n\n**选项 E**：\n这个选项在错误的基因组尺度上操作。\n-   **方法**：主成分1 (PC1) 分析用于定义 A/B 区室，它们是兆碱基尺度上的结构，代表了基因组到活性和非活性染色质的粗粒度划分。T-DOM 和 C-DOM 是 TADs，是区室*内部*的组织单位。\n-   **分辨率**：A/B 区室分析缺乏剖析两个相邻 TAD 之间调控动态所需的分辨率。T-DOM 和 C-DOM 之间相互作用偏好的切换，可以在该区域的大尺度区室状态没有任何变化的情况下发生，并且通常就是如此。\n-   **补充数据**：虽然 ATAC-seq 提供了有关染色质可及性的有用信息，但与 RNA-seq 一样，它是一种间接的调控状态度量，并不能量化三维接触。\n-   **数据使用**：它放弃了 Capture-C，再次丢弃了用于解决以启动子为中心的问题的最具体的数据。\n\n这种方法使用的工具不适合所需的细节水平。这就像用望远镜去检查一个细菌细胞。\n**结论：错误**\n\n**总结**\n选项 A 提供了唯一一个全面、技术上合理、统计上严谨，并直接解决了研究问题所有方面的设计。它正确地整合了多种数据类型（Hi-C、Capture-C），并在从数据归一化到时空转换点检测的每个分析阶段都采用了恰当的计算和统计方法，同时包含了必要的对照。它是一个稳健科学计划的典范。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "动物体型蓝图的演化在很大程度上是由基因调控的演化驱动的，而这又归结于顺式调控元件（如增强子）的改变。本练习提供了一个量化模型，用于探索在稳定选择压力下，增强子内部转录因子结合位点的增删过程。通过构建并分析这个模型，你将深入理解突变、选择和遗传漂变等微观进化力量如何共同塑造发育控制基因的调控元件结构，从而将群体遗传学理论与分子进化机制紧密结合。",
            "id": "2708691",
            "problem": "考虑一个控制同源异形盒 (Hox) 基因的顺式调控增强子的简化进化模型。该增强子最多包含 $K$ 个非重叠、功能等效的转录因子结合位点（“基序”），这些位点冗余地影响转录因子的占据概率。令 $k \\in \\{0,1,\\dots,K\\}$ 表示当前功能性基序的数量。基序的增加和丢失通过点突变在弱突变模式下发生，使得种群在任何时候都有效处于单态，并通过能使 $k$ 改变 $\\pm 1$ 的罕见替换进行演化。假设如下：\n\n1. 突变机会和速率：\n   - 存在 $K - k$ 个增加一个基序的机会，每个机会的速率为 $\\mu_b$（产生）。\n   - 存在 $k$ 个丢失一个基序的机会，每个机会的速率为 $\\mu_d$（死亡）。\n   - 视 $\\mu_b$ 和 $\\mu_d$ 为不随 $k$ 和时间变化的常数，且 $\\mu_b > 0$ 和 $\\mu_d > 0$。\n\n2. 表达模型：\n   - $k$ 个基序对标准化表达量的贡献是饱和的：$E(k) = 1 - e^{-a k}$，其中 $a \\ge 0$ 是一个与结合/占据相关的生物物理尺度参数。\n\n3. 稳定选择下的适应度：\n   - 最优表达量为 $E^\\star \\in [0,1]$，偏离最优值的惩罚以 Malthus 单位表示，服从高斯稳定选择：$m(k) = \\ln W(k) = - S \\left(E(k) - E^\\star\\right)^2$，其中 $S \\ge 0$ 是选择强度，$W(k)$ 是 Wrightian 适应度。\n\n4. 种群遗传学模式：\n   - 假设在一个有效种群大小为 $N_e$ 的 Wright–Fisher 种群中，演化遵循强选择、弱突变模式，因此替换事件是罕见的，关于 $k$ 的稳态分布存在，并且相对于突变不对称性（机会数量）和适应度差异遵循细致平衡。\n\n任务：\n- 对于下方测试套件中的每一组参数，计算由上述假设得到的关于 $k \\in \\{0,\\dots,K\\}$ 的稳态分布 $\\pi(k)$。\n- 使用该分布，计算：\n  1. 基序数量的稳态均值，$\\mathbb{E}[k] = \\sum_{k=0}^{K} k \\, \\pi(k)$。\n  2. 表达状态落在指定容差 $\\delta$ 范围内的稳态概率质量，即 $P_\\delta = \\sum_{k: |E(k) - E^\\star| \\le \\delta} \\pi(k)$。\n\n输出规范：\n- 你的程序必须输出一行，包含一个由方括号括起的逗号分隔列表。对于每个测试用例，按顺序输出两个数字：稳态基序数量均值 $\\mathbb{E}[k]$ 和概率 $P_\\delta$。将每个数字四舍五入到六位小数。最终输出按顺序连接所有用例，例如：`\"[x_1,y_1,x_2,y_2,\\dots]\"`。\n\n测试套件（每个用例为 $(K,\\mu_b,\\mu_d,a,E^\\star,S,N_e,\\delta)$）：\n- 用例 A（理想路径，中等饱和度，强稳定选择）：$(10,\\, 1 \\times 10^{-8},\\, 1 \\times 10^{-8},\\, 0.7,\\, 0.8,\\, 50,\\, 1 \\times 10^{5},\\, 0.05)$。\n- 用例 B（中性基准，不对称突变，无选择）：$(12,\\, 1 \\times 10^{-8},\\, 3 \\times 10^{-8},\\, 0.5,\\, 0.6,\\, 0,\\, 1 \\times 10^{5},\\, 0.10)$。\n- 用例 C（有利于增加的突变偏好，中等强度选择）：$(8,\\, 5 \\times 10^{-8},\\, 1 \\times 10^{-8},\\, 0.4,\\, 0.6,\\, 10,\\, 5 \\times 10^{4},\\, 0.02)$。\n- 用例 D（简并的调控效应，对 $k$ 无功能依赖性）：$(6,\\, 2 \\times 10^{-8},\\, 2 \\times 10^{-8},\\, 0,\\, 0.2,\\, 1000,\\, 1 \\times 10^{5},\\, 0.01)$。\n\n要求和说明：\n- 假设在所述模式下，稳态分布存在且唯一。\n- 所有计算都是无量纲的；不需要物理单位。\n- 不涉及角度计算。\n- 在计算 $\\pi(k)$ 时，对于较大的 $N_e S$ 值，应在适当之处使用对数变换以确保数值稳定性。\n- 你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 `\"[result_1,result_2,\\dots]\"`），每个数字四舍五入到六位小数。",
            "solution": "问题陈述已经过评估，被认为是有效的。它基于种群遗传学和分子进化的既定原则，具有科学依据，在数学上是适定的，并以客观、正式的方式呈现。所有必需的参数都已提供，该模型构成了理论生物学中的一个可解问题。\n\n该问题要求计算增强子区域中功能性转录因子结合位点数量 $k$ 的稳态分布 $\\pi(k)$。$k$ 的状态空间是整数集合 $\\{0, 1, \\dots, K\\}$。系统的演化被建模为一个代表结合位点增加和丢失的一维生灭过程。\n\n对于一个有限状态空间上的连续时间马尔可夫过程，如果该过程是不可约的，则其稳态分布存在且唯一。此条件在此处得到满足，因为在任何相邻状态 $k$ 和 $k \\pm 1$ 之间（对于 $0 < k < K$）的转移都是可能的，并且边界条件阻止了转移出状态空间。稳态分布 $\\pi(k)$ 必须满足细致平衡条件：\n$$ \\pi(k) q_{k \\to k+1} = \\pi(k+1) q_{k+1 \\to k} $$\n其中 $q_{i \\to j}$ 是从状态 $i$ 到状态 $j$ 的转移速率。这意味着以下比率关系：\n$$ \\frac{\\pi(k+1)}{\\pi(k)} = \\frac{q_{k \\to k+1}}{q_{k+1 \\to k}} $$\n\n转移速率是突变供给率与固定概率的乘积。\n增加一个基序（从状态 $k$ 变为 $k+1$）的突变供给率等于增加一个位点的机会数 $K-k$ 乘以每个机会的速率 $\\mu_b$。因此，突变供给率为 $M_{k \\to k+1} = (K-k)\\mu_b$。\n类似地，丢失一个基序（从状态 $k+1$ 变为 $k$）的突变供给率为 $M_{k+1 \\to k} = (k+1)\\mu_d$。\n\n在一个有效种群大小为 $N_e$ 的 Wright-Fisher 种群中，一个新突变的固定概率取决于其选择系数 $s$。Malthus 适应度由 $m(k) = -S(E(k) - E^\\star)^2$ 给出。从 $k$ 到 $k+1$ 的突变的选择系数 $s_k$ 是 Malthus 适应度的差值：$s_k = m(k+1) - m(k)$。对于反向突变，选择系数为 $-s_k$。\n\n在单倍体 Wright-Fisher 模型中，选择系数为 $s$ 的突变体的固定概率由 Kimura 的公式给出：\n$$ P_{\\text{fix}}(s) = \\frac{1 - e^{-2s}}{1 - e^{-2N_e s}} $$\n正向（$k \\to k+1$）和反向（$k+1 \\to k$）突变的固定概率之比为：\n$$ \\frac{P_{\\text{fix}}(s_k)}{P_{\\text{fix}}(-s_k)} = \\frac{(1 - e^{-2s_k})/(1 - e^{-2N_e s_k})}{(1 - e^{2s_k})/(1 - e^{2N_e s_k})} = \\frac{1 - e^{-2s_k}}{1 - e^{2s_k}} \\cdot \\frac{1 - e^{2N_e s_k}}{1 - e^{-2N_e s_k}} $$\n这可以精确地简化为：\n$$ \\frac{P_{\\text{fix}}(s_k)}{P_{\\text{fix}}(-s_k)} = e^{2(N_e - 1)s_k} $$\n结合突变供给率和固定概率之比，我们得到稳态分布的递归关系：\n$$ \\frac{\\pi(k+1)}{\\pi(k)} = \\frac{(K-k)\\mu_b}{(k+1)\\mu_d} \\exp\\Big[2(N_e - 1)\\big(m(k+1) - m(k)\\big)\\Big] $$\n\n该递归关系允许通过设置 $\\tilde{\\pi}(0) = 1$ 并从 $k=0$ 到 $K-1$ 进行迭代来计算未归一化的概率 $\\tilde{\\pi}(k)$：\n$$ \\tilde{\\pi}(k+1) = \\tilde{\\pi}(k) \\cdot \\frac{(K-k)\\mu_b}{(k+1)\\mu_d} \\exp\\Big[2(N_e - 1)\\big(m(k+1) - m(k)\\big)\\Big] $$\n项 $(N_e-1)S$ 可能很大，导致数值上溢或下溢。为确保稳定性，计算在对数空间中进行。令 $\\ln\\tilde{\\pi}(k)$ 为未归一化概率的对数。\n$$ \\ln\\tilde{\\pi}(0) = 0 $$\n$$ \\ln\\tilde{\\pi}(k+1) = \\ln\\tilde{\\pi}(k) + \\ln\\left(\\frac{(K-k)\\mu_b}{(k+1)\\mu_d}\\right) + 2(N_e - 1)\\big(m(k+1) - m(k)\\big) $$\n在计算出所有 $\\ln\\tilde{\\pi}(k)$ 后，使用 log-sum-exp 技巧对概率进行归一化。令 $L_{\\max} = \\max_k \\{ \\ln\\tilde{\\pi}(k) \\}$。归一化后的稳态分布为：\n$$ \\pi(k) = \\frac{\\exp(\\ln\\tilde{\\pi}(k) - L_{\\max})}{\\sum_{j=0}^{K} \\exp(\\ln\\tilde{\\pi}(j) - L_{\\max})} $$\n一旦获得 $\\pi(k)$，即可计算所需的量：\n1. 基序数量的稳态均值：$\\mathbb{E}[k] = \\sum_{k=0}^{K} k \\cdot \\pi(k)$。\n2. 表达量在最优值 $E^\\star$ 的容差 $\\delta$ 范围内的稳态概率质量：$P_\\delta = \\sum_{k: |E(k) - E^\\star| \\le \\delta} \\pi(k)$。\n\n提供的 Python 代码为每个测试用例实现了此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the stationary distribution of motif counts and derived statistics\n    for a given set of evolutionary parameters.\n    \"\"\"\n\n    # Test suite: (K, mu_b, mu_d, a, E_star, S, N_e, delta)\n    test_cases = [\n        # Case A: happy path, moderate saturation, strong stabilizing selection\n        (10, 1e-8, 1e-8, 0.7, 0.8, 50, 1e5, 0.05),\n        # Case B: neutral benchmark, asymmetric mutation, no selection\n        (12, 1e-8, 3e-8, 0.5, 0.6, 0, 1e5, 0.10),\n        # Case C: mutation bias favoring gains, intermediate selection\n        (8, 5e-8, 1e-8, 0.4, 0.6, 10, 5e4, 0.02),\n        # Case D: degenerate regulatory effect, no functional dependence on k\n        (6, 2e-8, 2e-8, 0, 0.2, 1000, 1e5, 0.01),\n    ]\n\n    all_results = []\n    \n    for params in test_cases:\n        K, mu_b, mu_d, a, E_star, S, N_e, delta = params\n\n        k_vals = np.arange(K + 1, dtype=float)\n        \n        # Vectorized computation of expression and Malthusian fitness\n        E_vals = 1.0 - np.exp(-a * k_vals)\n        m_vals = -S * (E_vals - E_star)**2\n\n        # Compute log unnormalized probabilities iteratively\n        log_pi_tilde = np.zeros(K + 1)\n        for k in range(K):\n            delta_m = m_vals[k + 1] - m_vals[k]\n            \n            # Log of mutational bias term\n            log_mut_ratio = np.log(K - k) + np.log(mu_b) - (np.log(k + 1) + np.log(mu_d))\n            \n            # Log of selection term from the ratio of fixation probabilities\n            selection_term = 2.0 * (N_e - 1.0) * delta_m\n            \n            log_pi_tilde[k + 1] = log_pi_tilde[k] + log_mut_ratio + selection_term\n\n        # Normalize probabilities using log-sum-exp trick for numerical stability\n        log_pi_tilde -= np.max(log_pi_tilde)\n        pi_tilde = np.exp(log_pi_tilde)\n        pi_dist = pi_tilde / np.sum(pi_tilde)\n\n        # Calculate stationary mean number of motifs\n        mean_k = np.sum(k_vals * pi_dist)\n\n        # Calculate stationary probability mass within the specified tolerance\n        condition_mask = np.abs(E_vals - E_star) <= delta\n        P_delta = np.sum(pi_dist[condition_mask])\n\n        all_results.extend([round(mean_k, 6), round(P_delta, 6)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}