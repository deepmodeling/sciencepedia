{
    "hands_on_practices": [
        {
            "introduction": "A core challenge in evolutionary biology is that different developmental pathways can lead to similar-looking adult forms, a phenomenon known as convergent evolution. This exercise explores this ambiguity within the context of heterochrony, specifically how paedomorphosis (the retention of juvenile traits in the adult) can arise from either an earlier cessation of development (progenesis) or a slowing of the developmental rate (neoteny). By working through this problem analytically, you will derive the conditions under which these two distinct processes produce identical adult phenotypes and, more importantly, discover how examining the developmental process itself, not just the final outcome, allows us to distinguish between them . This practice sharpens your ability to think critically about the relationship between developmental process and evolutionary pattern.",
            "id": "2722132",
            "problem": "In an ontogenetic framework, let a single scalar trait $y(t)$ be a strictly increasing and continuously differentiable function of chronological age $t \\geq 0$, with baseline maturation at age $T > 0$ and corresponding adult phenotype $y(T)$. Consider two canonical heterochronic transformations applied to this baseline trajectory, each yielding an adult form:\n\n- Progenesis: adult maturation occurs earlier at a new age $T_{p} \\in (0, T)$ while the developmental rate function is unchanged, so the realized adult phenotype is $y(T_{p})$.\n- Neoteny: the developmental rate is globally slowed by a constant factor $r \\in (0,1)$ (i.e., a uniform dilation of developmental time) while adult maturation age remains $T$, so that the neotenic trajectory is $y_{n}(t) = y(r t)$ and the realized adult phenotype is $y_{n}(T) = y(r T)$.\n\nAssume $y(t)$ is strictly monotonic increasing on $[0,T]$. \n\nTask 1 (adult equivalence): Starting only from the definitions above and the fact that strict monotonicity implies injectivity of $y(t)$ on $[0,T]$, derive the condition on $r$ (in terms of $T$ and $T_{p}$) such that progenesis and neoteny produce the same adult phenotype.\n\nTask 2 (juvenile discrimination principle): Using the chain rule for derivatives and the definitions above, propose a quantitative criterion based on juvenile data at a fixed age $t_{0} \\in (0,T_{p})$ that can distinguish neoteny from progenesis when the adult phenotypes are matched by the condition from Task 1. Concretely, define the diagnostic ratio\n$$\nR(t_{0}) \\equiv \\frac{\\left.\\frac{d}{dt} y_{n}(t)\\right|_{t=t_{0}}}{\\left.\\frac{d}{dt} y(t)\\right|_{t=t_{0}}}\n$$\nand derive it in closed form in terms of $y'(t)$, $r$, and $t_{0}$.\n\nTask 3 (model-based evaluation): Suppose the trait follows a power-law trajectory $y(t) = \\alpha t^{\\beta}$ with constants $\\alpha > 0$ and $\\beta > 0$. Using your results from Tasks 1–2, compute $R(t_{0})$ for $T = 100$ days, $T_{p} = 80$ days, $t_{0} = 20$ days, and $\\beta = 2$. Express your final numerical answer as a unitless number rounded to four significant figures.",
            "solution": "The problem statement is a valid, well-posed exercise in applying differential calculus to a formal model of heterochrony, a concept in evolutionary developmental biology. It is scientifically grounded, logically consistent, and all necessary information is provided. We will proceed with a systematic, step-by-step derivation for each task.\n\nFirst, we address Task 1: determination of the condition for adult equivalence.\nThe problem defines two heterochronic processes leading to a paedomorphic, or juvenile-like, adult form.\nThe baseline developmental trajectory is given by a strictly increasing, continuously differentiable function $y(t)$ for age $t \\ge 0$.\nProgenesis results in an adult phenotype $y(T_p)$, where maturation is truncated at an earlier age $T_p$, with $0 < T_p < T$.\nNeoteny results in an adult phenotype $y_n(T) = y(rT)$, where the developmental rate is slowed by a factor $r \\in (0, 1)$.\nThe condition for these two processes to produce the same adult phenotype is the equality of their adult trait values:\n$$\ny(T_p) = y_n(T)\n$$\nSubstituting the definition of the neotenic phenotype, we have:\n$$\ny(T_p) = y(rT)\n$$\nThe problem states that $y(t)$ is a strictly monotonic increasing function on the interval $[0, T]$. A fundamental property of strictly monotonic functions is that they are injective (one-to-one). This means that if $y(a) = y(b)$ for $a$ and $b$ in the domain of strict monotonicity, then it must be that $a=b$. The arguments of the function $y$ in our equation are $T_p$ and $rT$. Given that $T_p \\in (0, T)$ and $r \\in (0, 1)$, both $T_p$ and $rT$ fall within the interval $[0, T]$. Therefore, we can apply the property of injectivity to conclude:\n$$\nT_p = rT\n$$\nThe task requires the condition on $r$ in terms of $T$ and $T_p$. Solving for $r$, we obtain:\n$$\nr = \\frac{T_p}{T}\n$$\nThis is the necessary condition for progenesis and neoteny to be phenotypically indistinguishable at the adult stage. The given constraints $0 < T_p < T$ ensure that $r$ will be in the required range $(0, 1)$.\n\nNext, we address Task 2: derivation of a juvenile discrimination principle.\nWe are asked to find a criterion to distinguish between the two processes by observing their developmental rates at a juvenile age $t_0 \\in (0, T_p)$. The diagnostic ratio is defined as:\n$$\nR(t_0) \\equiv \\frac{\\left.\\frac{d}{dt} y_{n}(t)\\right|_{t=t_{0}}}{\\left.\\frac{d}{dt} y(t)\\right|_{t=t_{0}}}\n$$\nThe denominator is the developmental rate of the baseline (and thus, progenetic) trajectory at time $t_0$. Let us denote the derivative of $y(t)$ with respect to its argument as $y'(\\cdot)$. The denominator is simply $y'(t_0)$.\nThe numerator is the developmental rate of the neotenic trajectory, $y_n(t) = y(rt)$, evaluated at $t=t_0$. To find this derivative, we must apply the chain rule. Let $u(t) = rt$. Then $y_n(t) = y(u(t))$, and its derivative is:\n$$\n\\frac{d}{dt} y_n(t) = \\frac{dy}{du} \\cdot \\frac{du}{dt} = y'(u(t)) \\cdot r = r \\cdot y'(rt)\n$$\nEvaluating this derivative at $t = t_0$, we get:\n$$\n\\left.\\frac{d}{dt} y_{n}(t)\\right|_{t=t_{0}} = r \\cdot y'(rt_0)\n$$\nNow we can assemble the ratio $R(t_0)$:\n$$\nR(t_0) = \\frac{r \\cdot y'(rt_0)}{y'(t_0)}\n$$\nThis expression provides the diagnostic ratio in terms of the rate factor $r$, the observation time $t_0$, and the functional form of the developmental rate $y'(t)$. This is the closed-form result for Task 2. It shows that the ratio of developmental rates at any juvenile time $t_0$ is not generally equal to $1$, providing a basis for discrimination.\n\nFinally, we address Task 3: model-based evaluation.\nWe are given a specific power-law model for the developmental trajectory:\n$$\ny(t) = \\alpha t^{\\beta}\n$$\nwhere $\\alpha > 0$ and $\\beta > 0$. We are also provided with numerical values: $T = 100$ days, $T_p = 80$ days, $t_0 = 20$ days, and $\\beta = 2$.\n\nFirst, we use the result from Task 1 to compute the slowing factor $r$ that ensures adult equivalence.\n$$\nr = \\frac{T_p}{T} = \\frac{80}{100} = 0.8\n$$\nNext, we use the result from Task 2. For this, we need the derivative of $y(t)$:\n$$\ny'(t) = \\frac{d}{dt}(\\alpha t^{\\beta}) = \\alpha \\beta t^{\\beta-1}\n$$\nNow, we substitute this functional form for $y'(t)$ into our expression for the diagnostic ratio $R(t_0)$:\n$$\nR(t_0) = \\frac{r \\cdot y'(rt_0)}{y'(t_0)} = \\frac{r \\cdot [\\alpha \\beta (rt_0)^{\\beta-1}]}{\\alpha \\beta t_0^{\\beta-1}}\n$$\nWe can simplify this expression. The constants $\\alpha$ and $\\beta$ cancel, as they are non-zero.\n$$\nR(t_0) = \\frac{r \\cdot (r t_0)^{\\beta-1}}{t_0^{\\beta-1}} = \\frac{r \\cdot r^{\\beta-1} t_0^{\\beta-1}}{t_0^{\\beta-1}}\n$$\nSince $t_0 \\in (0, T_p)$, we have $t_0 > 0$, so the term $t_0^{\\beta-1}$ can also be canceled. The expression simplifies to:\n$$\nR(t_0) = r \\cdot r^{\\beta-1} = r^{1 + (\\beta-1)} = r^{\\beta}\n$$\nThis is a remarkably simple result. For a power-law growth model, the diagnostic ratio is independent of the observation time $t_0$ and the scaling constant $\\alpha$. It depends only on the rate factor $r$ and the power-law exponent $\\beta$.\n\nWe can now compute the numerical value of $R(t_0)$ using the given parameters. We have $r = 0.8$ and $\\beta = 2$.\n$$\nR(t_0) = (0.8)^2 = 0.64\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nR(t_0) = 0.6400\n$$\nThis result means that at any juvenile age, the rate of development in the neotenic organism is only $64\\%$ of the rate in the progenetic organism, even though they are destined to reach the same adult phenotype. This provides a clear, quantitative way to distinguish between the two evolutionary pathways.",
            "answer": "$$\n\\boxed{0.6400}\n$$"
        },
        {
            "introduction": "Beyond changes in developmental timing (heterochrony), evolutionary innovation is frequently driven by changes in the spatial location of developmental events, a mechanism known as heterotopy. This practice shifts our focus from the 'when' to the 'where' of development, using a realistic scenario involving the expression of the critical limb-patterning gene *HoxD13*. You will learn how to normalize developmental data to make meaningful comparisons between species of different sizes and connect a measured shift in gene expression territory to a predictable change in adult morphology . This exercise provides a quantitative framework for analyzing one of the most powerful mechanisms for generating morphological diversity.",
            "id": "2722088",
            "problem": "A comparative study of limb development investigates the spatial heterotopy of distal Homeobox D13 (HoxD13) expression along the proximal–distal axis of the forelimb bud in two taxa, denoted species $A$ and species $B$. Let the proximal–distal axis be parameterized by a coordinate $s$ with $s=0$ at the proximal base and $s=L$ at the distal tip, where $L$ is the total limb bud length at a homologous developmental stage established by transcriptomic staging. The posterior HoxD13 expression domain in the forelimb bud is distal, occupying $s \\ge s^{\\ast}$, where $s^{\\ast}$ is the measured boundary position for the onset of HoxD13 expression along the proximal–distal axis.\n\nYou are given the following measurements:\n- Species $A$: total limb bud length $L_{A} = 1.80$ millimeters and HoxD13 boundary position $s_{A}^{\\ast} = 1.26$ millimeters.\n- Species $B$: total limb bud length $L_{B} = 2.50$ millimeters and HoxD13 boundary position $s_{B}^{\\ast} = 1.50$ millimeters.\n\nTo compare boundary positions across species with different limb bud sizes, define the dimensionless boundary position $p = s^{\\ast}/L$ for each species, and then map the interspecific difference back onto a standardized limb of length $L_{\\mathrm{std}}$ by the displacement\n$$\n\\Delta x_{\\mathrm{std}} = \\left(p_{B} - p_{A}\\right) L_{\\mathrm{std}},\n$$\nwith the sign convention that $\\Delta x_{\\mathrm{std}} > 0$ indicates a more distal boundary in species $B$ relative to species $A$.\n\nAdditionally, for evolutionary interpretation under a morphogen-threshold model of patterning (French flag model), the distal autopod proportion in the adult, denoted $R$, is observed to be $R_{A} = 0.31$ for species $A$ and $R_{B} = 0.42$ for species $B$. Assume only general principles: the HoxD13-positive distal domain corresponds to the prospective autopod territory and, under first-order approximation near these stages, the adult autopod proportion $R$ increases monotonically with the fractional extent of the HoxD13-positive domain along the proximal–distal axis.\n\nTask:\n- Compute the signed standardized displacement $\\Delta x_{\\mathrm{std}}$ using $L_{\\mathrm{std}} = 2.00$ millimeters. Express your answer in millimeters and round your answer to three significant figures.\n\nNote: You should base your reasoning on core definitions (dimensionless normalization, mapping across scales) and widely accepted facts of morphogen-threshold patterning without invoking any unprovided shortcut formulas. The final reported value must be a single real number.",
            "solution": "We begin by clarifying the coordinate system and definitions. For each species, the proximal–distal axis is represented by $s \\in [0,L]$, where $L$ is the limb bud length at the staged time point. The HoxD13-expressing domain occupies $s \\ge s^{\\ast}$, with $s^{\\ast}$ denoting the boundary location of the onset of expression. To compare boundary positions across species with different limb bud sizes, we first non-dimensionalize the boundary position by forming the fraction\n$$\np \\equiv \\frac{s^{\\ast}}{L}.\n$$\nThis step removes the influence of absolute size, retaining only the relative position along the limb. The spatial heterotopic displacement on a standardized limb of length $L_{\\mathrm{std}}$ is then defined as\n$$\n\\Delta x_{\\mathrm{std}} = \\left(p_{B} - p_{A}\\right) L_{\\mathrm{std}},\n$$\nwith $\\Delta x_{\\mathrm{std}} > 0$ meaning species $B$ has a more distal (larger $s^{\\ast}$ relative to $L$) HoxD13 boundary compared to species $A$.\n\nCompute $p_{A}$ and $p_{B}$ from the given data:\n- For species $A$, $L_{A} = 1.80$ millimeters and $s_{A}^{\\ast} = 1.26$ millimeters. Therefore,\n$$\np_{A} = \\frac{s_{A}^{\\ast}}{L_{A}} = \\frac{1.26}{1.80} = 0.70.\n$$\n- For species $B$, $L_{B} = 2.50$ millimeters and $s_{B}^{\\ast} = 1.50$ millimeters. Therefore,\n$$\np_{B} = \\frac{s_{B}^{\\ast}}{L_{B}} = \\frac{1.50}{2.50} = 0.60.\n$$\n\nNow compute the standardized displacement using $L_{\\mathrm{std}} = 2.00$ millimeters:\n$$\n\\Delta x_{\\mathrm{std}} = \\left(p_{B} - p_{A}\\right) L_{\\mathrm{std}} = \\left(0.60 - 0.70\\right) \\times 2.00 = (-0.10) \\times 2.00 = -0.20 \\text{ millimeters}.\n$$\n\nInterpretation in the context of heterotopy and morphological differences: Under the morphogen-threshold (French flag) model, a boundary at $s^{\\ast}$ demarcates the distal domain fate. The length of the HoxD13-positive domain is $L - s^{\\ast}$, so the distal (autopod) proportion is\n$$\nR = \\frac{L - s^{\\ast}}{L} = 1 - \\frac{s^{\\ast}}{L} = 1 - p.\n$$\nThis general relationship follows directly from the definition of $R$ as the fraction of the limb corresponding to the HoxD13-positive domain. Consequently, a decrease in $p$ implies an increase in $R$. In the measured data, $p_{B} - p_{A} = -0.10 < 0$, so we expect $R_{B} - R_{A} > 0$. The observed adult values $R_{A} = 0.31$ and $R_{B} = 0.42$ are consistent with this prediction, indicating that the proximal shift of the HoxD13 boundary in species $B$ is associated with an increased autopod proportion, as expected for a heterotopic change affecting distal limb morphology.\n\nFinally, we report the requested signed standardized displacement. Rounding $-0.20$ millimeters to three significant figures yields $-0.200$ millimeters.",
            "answer": "$$\\boxed{-0.200}$$"
        },
        {
            "introduction": "To truly understand evolutionary mechanisms, we must move beyond qualitative descriptions and build quantitative models that can be tested against empirical data. This final practice provides a hands-on introduction to this model-based approach, using the dramatic elongation of bat wing digits as a classic example of peramorphosis (extended development). You will formalize two competing heterochronic hypotheses—an increase in growth rate versus an extension of the growth period—into mathematical models and use a statistical criterion to determine which model better explains the observed data . This exercise simulates a common research task in modern evolutionary biology, equipping you with the computational skills to rigorously evaluate alternative evolutionary scenarios.",
            "id": "2722110",
            "problem": "Consider modeling peramorphic digit elongation under heterochrony using a minimal proliferative growth framework grounded in exponential cell population dynamics. Assume the proliferative cell population in the growth zone follows the ordinary differential equation $dN/dt = r N$, where $N$ is cell number and $r$ is the per-capita proliferation rate. If digit length $L$ at time $t$ is proportional to $N(t)$ through a constant of proportionality $k$ that is specific to a given digit bud, then $L(t) = k N_{0} e^{r t}$, where $N_{0}$ is the initial cell number at the onset of the elongation phase. For a focal digit $i$ in a reference species (mouse), let the mouse parameters be $r_{i}$ (in $\\text{day}^{-1}$), $T_{i}$ (in $\\text{days}$), and observed final length $L^{\\mathrm{mouse}}_{i}$ (in $\\text{mm}$). For a derived species (bat), the peramorphic length $L^{\\mathrm{bat}}_{i}$ (in $\\text{mm}$) is observed for the same digit $i$.\n\nTwo competing heterochronic hypotheses are to be evaluated across digits $i$:\n- Rate-shift model: $r^{\\mathrm{bat}}_{i} = \\alpha\\, r^{\\mathrm{mouse}}_{i}$ with a single rate multiplier $\\alpha \\geq 1$ and the same duration $T_{i}$.\n- Duration-shift model: $T^{\\mathrm{bat}}_{i} = T^{\\mathrm{mouse}}_{i} + \\Delta t$ with a single extension $\\Delta t \\geq 0$ (in $\\text{days}$) and the same rate $r_{i}$.\n\nUnder the proportionality assumption, the ratio $R_{i} = L^{\\mathrm{bat}}_{i} / L^{\\mathrm{mouse}}_{i}$ satisfies $\\ln R_{i} = (\\alpha - 1)\\, r_{i} T_{i}$ for the rate-shift model and $\\ln R_{i} = r_{i} \\Delta t$ for the duration-shift model. Given observed pairs $\\{L^{\\mathrm{mouse}}_{i}, L^{\\mathrm{bat}}_{i}\\}$ and known $\\{r_{i}, T_{i}\\}$, fit each model by Least Squares (LS) in log space to obtain $\\alpha$ and $\\Delta t$ that minimize the sum of squared residuals in $\\ln R_{i}$. Constrain $\\alpha \\geq 1$ and $\\Delta t \\geq 0$ by projecting the unconstrained LS estimates onto these domains.\n\nYour task is to write a program that, for each test case, decides which model better explains the observed peramorphic lengths by comparing the log-space sum of squared errors. If the absolute difference in the sums of squared errors is less than or equal to a tolerance $\\tau = 10^{-8}$, declare a tie.\n\nUse the following units: $L$ in $\\text{mm}$, $r$ in $\\text{day}^{-1}$, and $t$ and $T$ in $\\text{days}$. Angles are not involved. All outputs are unitless decision codes.\n\nFor each test case, you are given arrays for digits $2$ through $5$: mouse lengths $L^{\\mathrm{mouse}}_{i}$, mouse rates $r_{i}$, mouse durations $T_{i}$, and bat lengths $L^{\\mathrm{bat}}_{i}$. The test suite is:\n\n- Test case $1$ (rate-shift generated, distinct $T_{i}$):\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,13.0,\\,12.0,\\,11.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,25.324,\\,29.240,\\,24.900,\\,28.404\\,]$ $\\text{mm}$\n\n- Test case $2$ (duration-shift generated, distinct $r_{i}$):\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,13.0,\\,12.0,\\,11.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,19.921,\\,21.030,\\,20.387,\\,24.952\\,]$ $\\text{mm}$\n\n- Test case $3$ (boundary condition with identical $T_{i}$ that yields an exact tie when data match either model consistently):\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,12.0,\\,12.0,\\,12.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,12.327,\\,13.538,\\,13.666,\\,14.838\\,]$ $\\text{mm}$\n\n- Test case $4$ (noisy rate-shift generated, distinct $T_{i}$):\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,13.0,\\,12.0,\\,11.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,19.973,\\,21.322,\\,19.971,\\,20.503\\,]$ $\\text{mm}$\n\nFor each test case, your program must:\n- Compute $R_{i} = L^{\\mathrm{bat}}_{i} / L^{\\mathrm{mouse}}_{i}$ and $y_{i} = \\ln R_{i}$ for all digits $i$.\n- Fit the rate-shift model by LS in log space to estimate $\\alpha$ using $y_{i} \\approx (\\alpha - 1)\\, x_{i}$ with $x_{i} = r_{i} T_{i}$. The unconstrained LS estimate is $\\widehat{\\alpha}_{\\mathrm{unc}} = 1 + \\frac{\\sum_{i} x_{i} y_{i}}{\\sum_{i} x_{i}^{2}}$. Enforce the peramorphic constraint by setting $\\widehat{\\alpha} = \\max\\{1, \\widehat{\\alpha}_{\\mathrm{unc}}\\}$.\n- Fit the duration-shift model by LS in log space to estimate $\\Delta t$ using $y_{i} \\approx r_{i} \\Delta t$. The unconstrained LS estimate is $\\widehat{\\Delta t}_{\\mathrm{unc}} = \\frac{\\sum_{i} r_{i} y_{i}}{\\sum_{i} r_{i}^{2}}$. Enforce the peramorphic constraint by setting $\\widehat{\\Delta t} = \\max\\{0, \\widehat{\\Delta t}_{\\mathrm{unc}}\\}$.\n- Compute the sum of squared residuals in log space for each model,\n  $$\\mathrm{SSE}_{\\mathrm{rate}} = \\sum_{i} \\left(y_{i} - (\\widehat{\\alpha} - 1)\\, x_{i}\\right)^{2}, \\quad \\mathrm{SSE}_{\\mathrm{duration}} = \\sum_{i} \\left(y_{i} - r_{i} \\widehat{\\Delta t}\\right)^{2}.$$\n- Decide the better model using tolerance $\\tau = 10^{-8}$: output decision code $0$ if $\\mathrm{SSE}_{\\mathrm{rate}} + \\tau < \\mathrm{SSE}_{\\mathrm{duration}}$, code $1$ if $\\mathrm{SSE}_{\\mathrm{duration}} + \\tau < \\mathrm{SSE}_{\\mathrm{rate}}$, and code $2$ otherwise.\n\nFinal output format: Your program should produce a single line of output containing the decisions for the $4$ test cases as a comma-separated list enclosed in square brackets (for example, $[0,1,2,0]$). The program must not read any input and must not print anything else.",
            "solution": "The supplied problem is scientifically sound and mathematically well-posed. We will proceed with a solution.\n\nThe objective is to discriminate between two competing models of peramorphic evolution, a rate-shift model and a duration-shift model, based on observed digit lengths in a reference species (mouse) and a derived species (bat). The foundation for both models is an exponential growth law for digit length, $L(t) = L_{0} e^{r t}$, where $L_{0}$ is an initial length at the start of the growth phase ($t=0$), $r$ is the per-capita proliferation rate, and $t$ is time. The final length after a growth duration $T$ is $L=L_0 e^{rT}$.\n\nAssuming the initial condition parameters $L_0$ are conserved for a homologous digit $i$ between the two species, the ratio of final lengths $R_{i} = L^{\\mathrm{bat}}_{i} / L^{\\mathrm{mouse}}_{i}$ is given by:\n$$\nR_{i} = \\frac{L_{0, i} e^{r^{\\mathrm{bat}}_i T^{\\mathrm{bat}}_i}}{L_{0, i} e^{r^{\\mathrm{mouse}}_i T^{\\mathrm{mouse}}_i}} = e^{r^{\\mathrm{bat}}_i T^{\\mathrm{bat}}_i - r^{\\mathrm{mouse}}_i T^{\\mathrm{mouse}}_i}\n$$\nTaking the natural logarithm yields the core equation for our analysis:\n$$\n\\ln(R_{i}) = r^{\\mathrm{bat}}_i T^{\\mathrm{bat}}_i - r^{\\mathrm{mouse}}_i T^{\\mathrm{mouse}}_i\n$$\nLet us denote the observable log-ratio as $y_{i} = \\ln(R_{i})$, and the reference parameters as $r_{i} = r^{\\mathrm{mouse}}_i$ and $T_{i} = T^{\\mathrm{mouse}}_i$.\n\nThe two heterochronic hypotheses can be formulated as linear models in log-space:\n\n1.  **Rate-shift model**: This model posits that the evolutionary change is due to an acceleration of the growth rate by a factor $\\alpha \\ge 1$, while the duration remains unchanged. The parameters are related by $r^{\\mathrm{bat}}_i = \\alpha r_i$ and $T^{\\mathrm{bat}}_i = T_i$. Substituting these into the log-ratio equation gives:\n    $$\n    y_{i} = (\\alpha r_i) T_i - r_i T_i = (\\alpha - 1) r_i T_i\n    $$\n    This is a linear model of the form $y_{i} = \\beta_{\\mathrm{rate}} x_{i}$, where the predictor variable is $x_{i} = r_{i} T_{i}$ and the slope is $\\beta_{\\mathrm{rate}} = \\alpha - 1$. The constraint $\\alpha \\ge 1$ implies $\\beta_{\\mathrm{rate}} \\ge 0$.\n\n2.  **Duration-shift model**: This model posits that the change is due to an extension of the growth duration by an amount $\\Delta t \\ge 0$, while the rate remains constant. The parameters are related by $r^{\\mathrm{bat}}_i = r_i$ and $T^{\\mathrm{bat}}_i = T_i + \\Delta t$. Substitution yields:\n    $$\n    y_{i} = r_i (T_i + \\Delta t) - r_i T_i = r_i \\Delta t\n    $$\n    This is a linear model of the form $y_{i} = \\beta_{\\mathrm{duration}} z_{i}$, where the predictor variable is $z_{i} = r_{i}$ and the slope is $\\beta_{\\mathrm{duration}} = \\Delta t$. The constraint $\\Delta t \\ge 0$ implies $\\beta_{\\mathrm{duration}} \\ge 0$.\n\nTo estimate the parameters $\\alpha$ and $\\Delta t$, we employ the method of Ordinary Least Squares (LS) for a linear model with a zero intercept ($y = \\beta u$). The LS estimator for the slope $\\beta$ that minimizes the sum of squared residuals $\\sum (y_i - \\beta u_i)^2$ is given by:\n$$\n\\widehat{\\beta} = \\frac{\\sum_{i} u_{i} y_{i}}{\\sum_{i} u_{i}^{2}}\n$$\nApplying this to our models, we obtain the unconstrained estimates:\nFor the rate-shift model, with $u_{i} = x_{i} = r_{i}T_{i}$ and $\\widehat{\\beta}_{\\mathrm{rate, unc}} = \\widehat{\\alpha}_{\\mathrm{unc}} - 1$:\n$$\n\\widehat{\\alpha}_{\\mathrm{unc}} - 1 = \\frac{\\sum_{i} (r_{i}T_{i}) y_{i}}{\\sum_{i} (r_{i}T_{i})^{2}} \\implies \\widehat{\\alpha}_{\\mathrm{unc}} = 1 + \\frac{\\sum_{i} (r_{i}T_{i}) y_{i}}{\\sum_{i} (r_{i}T_{i})^{2}}\n$$\nFor the duration-shift model, with $u_{i} = z_{i} = r_{i}$ and $\\widehat{\\beta}_{\\mathrm{duration, unc}} = \\widehat{\\Delta t}_{\\mathrm{unc}}$:\n$$\n\\widehat{\\Delta t}_{\\mathrm{unc}} = \\frac{\\sum_{i} r_{i} y_{i}}{\\sum_{i} r_{i}^{2}}\n$$\nThe peramorphic constraints ($\\alpha \\geq 1$ and $\\Delta t \\geq 0$) are enforced by projecting these estimates onto their valid domains:\n$$\n\\widehat{\\alpha} = \\max\\{1, \\widehat{\\alpha}_{\\mathrm{unc}}\\}\n$$\n$$\n\\widehat{\\Delta t} = \\max\\{0, \\widehat{\\Delta t}_{\\mathrm{unc}}\\}\n$$\nThe goodness-of-fit for each model is quantified by its Sum of Squared Errors (SSE) in log-space, calculated using the constrained parameter estimates:\n$$\n\\mathrm{SSE}_{\\mathrm{rate}} = \\sum_{i} \\left( y_{i} - (\\widehat{\\alpha} - 1) r_{i} T_{i} \\right)^{2}\n$$\n$$\n\\mathrm{SSE}_{\\mathrm{duration}} = \\sum_{i} \\left( y_{i} - \\widehat{\\Delta t} r_{i} \\right)^{2}\n$$\nThe model with the lower SSE is considered the better explanation for the data. A decision rule with a tolerance $\\tau = 10^{-8}$ is used to handle cases of near-equal performance:\n- If $\\mathrm{SSE}_{\\mathrm{rate}} + \\tau < \\mathrm{SSE}_{\\mathrm{duration}}$, the rate-shift model is preferred (decision code $0$).\n- If $\\mathrm{SSE}_{\\mathrm{duration}} + \\tau < \\mathrm{SSE}_{\\mathrm{rate}}$, the duration-shift model is preferred (decision code $1$).\n- Otherwise, the models are considered to perform equally well (decision code $2$).\n\nThe provided algorithm automates this entire procedure for each test case, starting from the raw length, rate, and duration data.",
            "answer": "```python\n# The final and complete solution is a self-contained Python program.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the heterochrony model comparison problem for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (rate-shift generated)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 13.0, 12.0, 11.0]),\n            \"L_bat\": np.array([25.324, 29.240, 24.900, 28.404])\n        },\n        # Test case 2 (duration-shift generated)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 13.0, 12.0, 11.0]),\n            \"L_bat\": np.array([19.921, 21.030, 20.387, 24.952])\n        },\n        # Test case 3 (boundary condition for tie)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 12.0, 12.0, 12.0]),\n            \"L_bat\": np.array([12.327, 13.538, 13.666, 14.838])\n        },\n        # Test case 4 (noisy rate-shift generated)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 13.0, 12.0, 11.0]),\n            \"L_bat\": np.array([19.973, 21.322, 19.971, 20.503])\n        }\n    ]\n\n    results = []\n    tolerance = 1e-8\n\n    for case in test_cases:\n        L_mouse, r, T, L_bat = case[\"L_mouse\"], case[\"r\"], case[\"T\"], case[\"L_bat\"]\n\n        # Compute the response variable y_i = ln(R_i)\n        R_i = L_bat / L_mouse\n        y_i = np.log(R_i)\n\n        # Fit the rate-shift model\n        # Predictor variable x_i = r_i * T_i\n        x_i = r * T\n        # Unconstrained estimate for alpha\n        alpha_unc = 1.0 + np.dot(x_i, y_i) / np.dot(x_i, x_i)\n        # Constrained estimate, alpha >= 1\n        alpha_hat = np.maximum(1.0, alpha_unc)\n        \n        # Fit the duration-shift model\n        # Predictor variable is r_i\n        # Unconstrained estimate for Delta_t\n        delta_t_unc = np.dot(r, y_i) / np.dot(r, r)\n        # Constrained estimate, Delta_t >= 0\n        delta_t_hat = np.maximum(0.0, delta_t_unc)\n\n        # Compute Sum of Squared Errors (SSE) for each model\n        # SSE for rate-shift model\n        y_pred_rate = (alpha_hat - 1.0) * x_i\n        SSE_rate = np.sum((y_i - y_pred_rate)**2)\n        \n        # SSE for duration-shift model\n        y_pred_duration = delta_t_hat * r\n        SSE_duration = np.sum((y_i - y_pred_duration)**2)\n\n        # Decide which model is better based on SSE with tolerance\n        if SSE_rate + tolerance < SSE_duration:\n            decision_code = 0  # Rate-shift is better\n        elif SSE_duration + tolerance < SSE_rate:\n            decision_code = 1  # Duration-shift is better\n        else:\n            decision_code = 2  # Tie\n        \n        results.append(decision_code)\n\n    # Print the results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}