{
    "hands_on_practices": [
        {
            "introduction": "The first step in any directed evolution experiment is the creation of genetic diversity. A crucial aspect of this process is controlling the mutation rate; too few mutations limit the exploration of the fitness landscape, while too many can lead to non-functional proteins. This practice  guides you through the derivation of the Poisson distribution as a model for mutation events in a library, a fundamental tool for predicting the fractions of unmutated, single-mutant, and multi-mutant clones. Mastering this statistical model is essential for designing effective mutagenesis strategies.",
            "id": "2701249",
            "problem": "In a single round of library generation for directed evolution of a deoxyribonucleic acid (DNA) gene, you mutagenize a coding sequence of length $L=1000$ nucleotides using error-prone Polymerase Chain Reaction (PCR). Assume that each nucleotide independently acquires a point mutation during this round with probability $\\mu$ and that multiple hits at the same nucleotide within this round are negligible. Let $K$ denote the total number of mutated sites in a clone after this round.\n\nStarting only from the following fundamental bases:\n1. Independence of per-site mutation events across the $L$ sites, each modeled as a Bernoulli trial with mutation probability $\\mu$.\n2. The distribution of the sum of independent and identically distributed Bernoulli trials is binomial.\n3. The classical limit in which a binomial distribution with many trials and a small success probability converges to a Poisson distribution when the mean is held fixed,\n\nderive the limiting distribution of $K$ as $L \\to \\infty$ and $\\mu \\to 0$ with $\\lambda \\equiv \\mu L$ held constant, and then use this model to obtain the explicit analytic expressions for the expected fractions of clones bearing $0$, $1$, and $2$ total mutations when $L=1000$. Express your final answer as a single row vector containing the three fractions in terms of $\\mu$ only, with no units and no rounding.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extracted Givens**\n- Length of coding sequence: $L=1000$ nucleotides.\n- Probability of point mutation per nucleotide per round: $\\mu$.\n- Mutations at each nucleotide site are independent events.\n- Multiple mutations at a single site within one round are considered negligible.\n- $K$ is the random variable representing the total number of mutated sites in a clone.\n- The derivation must be based on three principles:\n    1. Per-site mutation is a Bernoulli trial with success probability $\\mu$.\n    2. The distribution of $K$, the sum of $L$ independent and identically distributed (i.i.d.) Bernoulli trials, is binomial.\n    3. The binomial distribution converges to a Poisson distribution in the limit where $L \\to \\infty$ and $\\mu \\to 0$, with the mean $\\lambda \\equiv \\mu L$ held constant.\n- The final objective is to provide explicit analytic expressions for the expected fractions of clones with $0$, $1$, and $2$ mutations, using the derived limiting distribution for the case $L=1000$. The result must be a row vector in terms of $\\mu$.\n\n**Step 2: Validation**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard and fundamental model in molecular evolution and population genetics—the use of a Poisson distribution to approximate the number of rare, independent events (mutations) over a large number of trials (nucleotide sites). The premises are consistent and provide a complete basis for a unique, meaningful solution. There are no violations of scientific principles, no ambiguities, and no missing information. The problem is a formal exercise in statistical mechanics applied to biology.\n\n**Step 3: Verdict**\nThe problem is valid. A solution will be furnished.\n\nThe derivation proceeds as instructed. Let the event of a mutation at a specific nucleotide site $i$, where $i \\in \\{1, 2, \\dots, L\\}$, be modeled as a Bernoulli trial. We define a random variable $X_i$ for each site:\n$$\nX_i = \\begin{cases} 1 & \\text{if a mutation occurs at site } i \\\\ 0 & \\text{if no mutation occurs at site } i \\end{cases}\n$$\nThe probability of a mutation is given as $P(X_i=1) = \\mu$, and consequently, the probability of no mutation is $P(X_i=0) = 1-\\mu$.\n\nThe total number of mutated sites, $K$, in a sequence of length $L$ is the sum of these independent and identically distributed Bernoulli random variables:\n$$ K = \\sum_{i=1}^{L} X_i $$\nAs stated in the problem's fundamental bases, the sum of $L$ i.i.d. Bernoulli trials follows a binomial distribution. Therefore, the exact distribution of $K$ is $K \\sim \\text{Binomial}(L, \\mu)$. The probability mass function (PMF) for observing exactly $k$ mutations is given by:\n$$ P(K=k) = \\binom{L}{k} \\mu^k (1-\\mu)^{L-k} $$\nwhere $\\binom{L}{k} = \\frac{L!}{k!(L-k)!}$.\n\nWe are instructed to derive the limiting distribution as $L \\to \\infty$ and $\\mu \\to 0$ such that the mean number of mutations, $\\lambda = \\mu L$, remains constant. We begin with the binomial PMF and substitute $\\mu = \\lambda/L$:\n$$ P(K=k) = \\frac{L!}{k!(L-k)!} \\left(\\frac{\\lambda}{L}\\right)^k \\left(1-\\frac{\\lambda}{L}\\right)^{L-k} $$\nWe now analyze the behavior of each term in the limit $L \\to \\infty$.\nFirst, consider the combinatorial term:\n$$ \\frac{L!}{k!(L-k)!} = \\frac{L(L-1)(L-2)\\cdots(L-k+1)}{k!} $$\nAs $L \\to \\infty$, for a fixed $k$, the numerator is a polynomial in $L$ of degree $k$. Its leading term is $L^k$. Thus, the expression is asymptotically equivalent to $\\frac{L^k}{k!}$.\n$$ \\lim_{L\\to\\infty} \\frac{L(L-1)\\cdots(L-k+1)}{L^k} = 1 $$\nSo we can write:\n$$ \\frac{L!}{k!(L-k)!} \\approx \\frac{L^k}{k!} \\quad \\text{for large } L $$\nNext, consider the term $\\left(\\frac{\\lambda}{L}\\right)^k = \\frac{\\lambda^k}{L^k}$.\nFinally, analyze the term $\\left(1-\\frac{\\lambda}{L}\\right)^{L-k}$:\n$$ \\left(1-\\frac{\\lambda}{L}\\right)^{L-k} = \\left(1-\\frac{\\lambda}{L}\\right)^L \\left(1-\\frac{\\lambda}{L}\\right)^{-k} $$\nUsing the fundamental limit definition of the exponential function, $\\lim_{n\\to\\infty} (1 + x/n)^n = e^x$, we have:\n$$ \\lim_{L\\to\\infty} \\left(1-\\frac{\\lambda}{L}\\right)^L = e^{-\\lambda} $$\nAnd for the second part:\n$$ \\lim_{L\\to\\infty} \\left(1-\\frac{\\lambda}{L}\\right)^{-k} = (1-0)^{-k} = 1 $$\nCombining these results, the limiting form of the PMF is:\n$$ \\lim_{L\\to\\infty, \\mu\\to 0, \\mu L=\\lambda} P(K=k) = \\left(\\frac{L^k}{k!}\\right) \\left(\\frac{\\lambda^k}{L^k}\\right) (e^{-\\lambda}) (1) = \\frac{\\lambda^k e^{-\\lambda}}{k!} $$\nThis is the PMF of the Poisson distribution with mean $\\lambda$. The limiting distribution of $K$ is therefore $K \\sim \\text{Poisson}(\\lambda)$.\n\nThe problem now requires us to use this Poisson model to find the expected fractions of clones with $k=0$, $k=1$, and $k=2$ mutations. The fraction of clones with $k$ mutations is given by $P(K=k)$. We are given $L=1000$, and the mean is $\\lambda = \\mu L = 1000\\mu$.\n\nFor $k=0$ mutations (wild-type or unmutated sequence):\nThe fraction is $P(K=0) = \\frac{\\lambda^0 e^{-\\lambda}}{0!}$. Since $\\lambda^0=1$ and $0!=1$, this simplifies to:\n$$ P(K=0) = e^{-\\lambda} = \\exp(-1000\\mu) $$\n\nFor $k=1$ mutation (single-mutant clones):\nThe fraction is $P(K=1) = \\frac{\\lambda^1 e^{-\\lambda}}{1!}$. This simplifies to:\n$$ P(K=1) = \\lambda e^{-\\lambda} = 1000\\mu \\exp(-1000\\mu) $$\n\nFor $k=2$ mutations (double-mutant clones):\nThe fraction is $P(K=2) = \\frac{\\lambda^2 e^{-\\lambda}}{2!}$. This simplifies to:\n$$ P(K=2) = \\frac{\\lambda^2}{2} e^{-\\lambda} = \\frac{(1000\\mu)^2}{2} \\exp(-1000\\mu) = \\frac{1000000\\mu^2}{2} \\exp(-1000\\mu) = 500000\\mu^2 \\exp(-1000\\mu) $$\n\nThese three expressions represent the required fractions, expressed solely in terms of $\\mu$. They are to be presented as a single row vector.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\exp(-1000\\mu) & 1000\\mu \\exp(-1000\\mu) & 500000\\mu^2 \\exp(-1000\\mu) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A successful directed evolution experiment hinges on a well-defined relationship between a molecular trait and organismal fitness. This problem  explores a concrete example of such a genotype-phenotype-fitness map, where an enzyme's catalytic efficiency ($k_{\\text{cat}}/K_M$) directly influences the growth rate of the host cell. By calculating the relative fitness of two enzyme variants under a scenario with a physiological ceiling, you will practice translating molecular data into the currency of evolution: selective advantage.",
            "id": "2701222",
            "problem": "In a continuous directed evolution experiment in a turbidostat, host cell growth is tightly coupled to the flux provided by an engineered enzyme that converts a limiting precursor into an essential metabolite. At subsaturating substrate concentrations, the effective enzyme activity per enzyme molecule is proportional to the catalytic efficiency, so that increasing the ratio of turnover number to Michaelis constant increases the rate at which metabolite is supplied. The population Malthusian growth rate (per unit time) is modeled as a linear function of catalytic efficiency up to a physiological ceiling, reflecting global resource limitations. Specifically, the fitness map is\n$$\nr = \\min\\!\\big(r_0 + \\beta \\,(k_{\\text{cat}}/K_M), \\, r_{\\max}\\big),\n$$\nwhere $r$ is the Malthusian growth rate in $\\mathrm{h}^{-1}$, $r_0$ is the baseline growth rate in the absence of functional enzyme, $\\beta$ is a proportionality constant that converts catalytic efficiency to growth rate, and $r_{\\max}$ is the maximal achievable growth rate in the given environment. Here $(k_{\\text{cat}}/K_M)$ is understood in units of $\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$ so that $\\beta$ has units $\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}$ and $r$ has units $\\mathrm{h}^{-1}$.\n\nTwo variants, $\\mathrm{A}$ and $\\mathrm{B}$, have the following kinetic parameters measured under the assay conditions used in selection:\n- Variant $\\mathrm{A}$: $k_{\\text{cat},\\mathrm{A}} = 120\\,\\mathrm{s}^{-1}$, $K_{M,\\mathrm{A}} = 60\\,\\mu\\mathrm{M}$.\n- Variant $\\mathrm{B}$: $k_{\\text{cat},\\mathrm{B}} = 400\\,\\mathrm{s}^{-1}$, $K_{M,\\mathrm{B}} = 50\\,\\mu\\mathrm{M}$.\n\nThe environmental parameters are $r_0 = 0.15\\,\\mathrm{h}^{-1}$, $\\beta = 0.20\\,\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}$, and $r_{\\max} = 0.80\\,\\mathrm{h}^{-1}$.\n\nUsing the definition of relative fitness in continuous time as the ratio of Malthusian growth rates, $w_{\\mathrm{A}/\\mathrm{B}} = r_{\\mathrm{A}}/r_{\\mathrm{B}}$, compute the relative fitness of variant $\\mathrm{A}$ compared to variant $\\mathrm{B}$. Express your final answer as a dimensionless decimal number rounded to four significant figures.",
            "solution": "The problem statement is parsed and validated. The givens are:\nThe fitness map for the Malthusian growth rate $r$ in units of $\\mathrm{h}^{-1}$:\n$$\nr = \\min\\!\\big(r_0 + \\beta \\,(k_{\\text{cat}}/K_M), \\, r_{\\max}\\big)\n$$\nParameters for variant $\\mathrm{A}$:\n$k_{\\text{cat},\\mathrm{A}} = 120\\,\\mathrm{s}^{-1}$\n$K_{M,\\mathrm{A}} = 60\\,\\mu\\mathrm{M}$\n\nParameters for variant $\\mathrm{B}$:\n$k_{\\text{cat},\\mathrm{B}} = 400\\,\\mathrm{s}^{-1}$\n$K_{M,\\mathrm{B}} = 50\\,\\mu\\mathrm{M}$\n\nEnvironmental parameters:\n$r_0 = 0.15\\,\\mathrm{h}^{-1}$\n$\\beta = 0.20\\,\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}$\n$r_{\\max} = 0.80\\,\\mathrm{h}^{-1}$\n\nThe definition of relative fitness is given as $w_{\\mathrm{A}/\\mathrm{B}} = r_{\\mathrm{A}}/r_{\\mathrm{B}}$.\n\nThe problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. The units are internally consistent: the product $\\beta \\cdot (k_{\\text{cat}}/K_M)$ has units of $(\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}) \\cdot (\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}) = \\mathrm{h}^{-1}$, which is consistent with the units of $r$, $r_0$, and $r_{\\max}$. The problem is therefore valid, and we proceed to the solution.\n\nThe solution requires the calculation of the Malthusian growth rate for each variant, $r_{\\mathrm{A}}$ and $r_{\\mathrm{B}}$, according to the provided fitness map. This first involves determining the catalytic efficiency, defined as the ratio $k_{\\text{cat}}/K_M$.\n\nFor variant $\\mathrm{A}$, the catalytic efficiency is:\n$$\n\\left(\\frac{k_{\\text{cat}}}{K_M}\\right)_{\\mathrm{A}} = \\frac{k_{\\text{cat},\\mathrm{A}}}{K_{M,\\mathrm{A}}} = \\frac{120\\,\\mathrm{s}^{-1}}{60\\,\\mu\\mathrm{M}} = 2.0\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}\n$$\nThe potential growth rate is then calculated using the linear part of the fitness map:\n$$\nr_{0} + \\beta \\left(\\frac{k_{\\text{cat}}}{K_M}\\right)_{\\mathrm{A}} = 0.15\\,\\mathrm{h}^{-1} + (0.20\\,\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}) \\cdot (2.0\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}) = 0.15\\,\\mathrm{h}^{-1} + 0.40\\,\\mathrm{h}^{-1} = 0.55\\,\\mathrm{h}^{-1}\n$$\nThe actual growth rate $r_{\\mathrm{A}}$ is the minimum of this value and the physiological maximum $r_{\\max}$.\n$$\nr_{\\mathrm{A}} = \\min(0.55\\,\\mathrm{h}^{-1}, 0.80\\,\\mathrm{h}^{-1}) = 0.55\\,\\mathrm{h}^{-1}\n$$\n\nNext, we perform the same calculation for variant $\\mathrm{B}$. The catalytic efficiency is:\n$$\n\\left(\\frac{k_{\\text{cat}}}{K_M}\\right)_{\\mathrm{B}} = \\frac{k_{\\text{cat},\\mathrm{B}}}{K_{M,\\mathrm{B}}} = \\frac{400\\,\\mathrm{s}^{-1}}{50\\,\\mu\\mathrm{M}} = 8.0\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}\n$$\nThe potential growth rate is then:\n$$\nr_{0} + \\beta \\left(\\frac{k_{\\text{cat}}}{K_M}\\right)_{\\mathrm{B}} = 0.15\\,\\mathrm{h}^{-1} + (0.20\\,\\mathrm{h}^{-1}\\,\\mu\\mathrm{M}\\,\\mathrm{s}) \\cdot (8.0\\,\\mu\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}) = 0.15\\,\\mathrm{h}^{-1} + 1.60\\,\\mathrm{h}^{-1} = 1.75\\,\\mathrm{h}^{-1}\n$$\nThe actual growth rate $r_{\\mathrm{B}}$ is the minimum of this value and the physiological maximum $r_{\\max}$. In this case, the calculated linear growth rate exceeds the ceiling.\n$$\nr_{\\mathrm{B}} = \\min(1.75\\,\\mathrm{h}^{-1}, 0.80\\,\\mathrm{h}^{-1}) = 0.80\\,\\mathrm{h}^{-1}\n$$\n\nFinally, the relative fitness of variant $\\mathrm{A}$ compared to variant $\\mathrm{B}$ is the ratio of their Malthusian growth rates.\n$$\nw_{\\mathrm{A}/\\mathrm{B}} = \\frac{r_{\\mathrm{A}}}{r_{\\mathrm{B}}} = \\frac{0.55\\,\\mathrm{h}^{-1}}{0.80\\,\\mathrm{h}^{-1}} = \\frac{0.55}{0.80}\n$$\nThis calculation yields a dimensionless value:\n$$\nw_{\\mathrm{A}/\\mathrm{B}} = 0.6875\n$$\nThe problem requires the answer to be expressed to four significant figures. The calculated value $0.6875$ has exactly four significant figures, so no further rounding is necessary.",
            "answer": "$$\n\\boxed{0.6875}\n$$"
        },
        {
            "introduction": "Understanding the temporal dynamics of selection is vital for planning and interpreting directed evolution experiments. This exercise  simulates a Phage-Assisted Continuous Evolution (PACE) system to model how a beneficial variant outcompetes its wild-type ancestor over time. You will derive and solve the underlying logistic growth equation to predict the 'time to fixation', providing a quantitative framework for estimating the duration of a continuous selection campaign and appreciating the power of deterministic population genetics models.",
            "id": "2701202",
            "problem": "Consider a simplified deterministic model of Phage-Assisted Continuous Evolution using a phagemid system (PACEmid), an implementation related to Phage-Assisted Continuous Evolution (PACE). In a continuous culture, two competing lineages are present: a beneficial variant and a wild type. Let $x_v(t)$ and $x_w(t)$ denote their absolute abundances at time $t$, and let $p(t) = \\dfrac{x_v(t)}{x_v(t) + x_w(t)}$ denote the frequency of the beneficial variant. Assume exponential growth with dilution, so that each lineage $i \\in \\{v,w\\}$ obeys\n$$\n\\frac{dx_i}{dt} = m_i(\\sigma)\\, x_i,\n$$\nwhere $m_i(\\sigma) = r_i(\\sigma) - D$ is the net Malthusian growth rate, $r_i(\\sigma)$ is the intrinsic replication rate, $D$ is the dilution rate of the lagoon, and $\\sigma \\ge 0$ is a scalar selection stringency parameter controlled by the experimenter. The variant’s replication depends on $\\sigma$ as\n$$\nr_v(\\sigma) = r_0 + k\\,\\sigma,\n$$\nwhereas the wild type has\n$$\nr_w(\\sigma) = r_0,\n$$\nwith $r_0 > 0$ and $k > 0$ constants. Assume that mutation and stochastic drift are negligible on the timescales considered and that the system is well-mixed.\n\nStarting from the fundamental definitions above, derive the ordinary differential equation governing $p(t)$ and the corresponding closed-form time it takes for the variant’s frequency to reach a preset target $p^\\star$ from an initial frequency $p_0$, expressed as a function of $\\sigma$. Then implement a program that, for a given set of $\\sigma$ values, both (i) numerically simulates the enrichment trajectory $p(t)$ using a fixed-step explicit Euler integrator and (ii) computes the closed-form time to reach $p^\\star$; the program should finally output only the closed-form times for a specified test suite.\n\nUse the following parameterization, which is scientifically plausible for a continuous evolution setting:\n- Basal replication rate: $r_0 = 0.6$ per hour.\n- Selection gain coefficient: $k = 0.2$ per hour per unit $\\sigma$.\n- Dilution rate: $D = 0.5$ per hour.\n- Initial variant frequency: $p_0 = 10^{-4}$ (dimensionless).\n- Fixation threshold: $p^\\star = 0.99$ (dimensionless), interpreted as practical fixation.\n- Time unit: all times must be reported in hours.\n- Simulation integrator step size: $\\Delta t = 0.01$ hours.\n- Maximum simulated time horizon: $T_{\\max} = 10000$ hours.\n\nTasks:\n- Derive, from the given growth laws, the exact differential equation in $p(t)$ and the closed-form expression for the time to reach $p^\\star$ from $p_0$ as a function of $\\sigma$. Do not assume any shortcut formulas that are not derived from the given definitions.\n- Implement a program that, for each $\\sigma$ in the test suite below, does the following:\n  - Simulates the enrichment trajectory $p(t)$ using the derived $p(t)$ dynamics with the explicit Euler method and detects the first time $t$ where $p(t) \\ge p^\\star$ (if this occurs within $T_{\\max}$). Use linear interpolation within the final step to refine the estimated hitting time.\n  - Computes the closed-form time using your derived formula.\n  - Uses the closed-form times as the final answers for the test suite.\n- If, for a given $\\sigma$, the selection on the variant is not favorable (so that the variant is neutrally selected or disadvantaged in frequency space), define the time to fixation as $-1.0$ (a sentinel value indicating no fixation in the model).\n\nTest suite (selection stringency values):\n- $\\sigma = 0.0$\n- $\\sigma = 0.1$\n- $\\sigma = 0.5$\n- $\\sigma = 1.0$\n- $\\sigma = 2.0$\n- $\\sigma = 5.0$\n\nOutput specification:\n- Your program should produce a single line of output containing the closed-form times to reach $p^\\star$ from $p_0$ for the test suite, in order, as a comma-separated list enclosed in square brackets.\n- Times must be rounded to $3$ decimals and reported in hours. For cases where fixation is impossible under the model, output exactly $-1.0$ (with one decimal) in place of the time.\n- Example format: `[t_1,t_2,t_3,t_4,t_5,t_6]`, where each $t_i$ is a float as specified above.\n\nYour solution must be universally applicable and self-contained, relying only on the mathematical and algorithmic logic as stated. No external input is provided to the program; it must internally use the test suite specified above.",
            "solution": "The problem requires the derivation of the population dynamics for a beneficial variant in a continuous culture system and the subsequent calculation of the time required for this variant to reach a specified frequency. We will first derive the governing ordinary differential equation (ODE) for the variant's frequency, $p(t)$, and solve it to find the closed-form expression for the time to fixation. Then, we will describe the implementation of a program to compute this time for a given set of parameters.\n\nFirst, we derive the differential equation for the frequency of the beneficial variant, $p(t)$. The frequency is defined as:\n$$\np(t) = \\frac{x_v(t)}{x_v(t) + x_w(t)}\n$$\nwhere $x_v(t)$ and $x_w(t)$ are the absolute abundances of the variant and wild-type lineages, respectively. To find the rate of change of $p(t)$, we differentiate with respect to time $t$ using the quotient rule:\n$$\n\\frac{dp}{dt} = \\frac{\\frac{dx_v}{dt}(x_v + x_w) - x_v\\left(\\frac{dx_v}{dt} + \\frac{dx_w}{dt}\\right)}{(x_v + x_w)^2}\n$$\nThe problem states that the abundances follow exponential growth with dilution: $\\frac{dx_i}{dt} = m_i(\\sigma) x_i$ for $i \\in \\{v, w\\}$, where $m_i(\\sigma)$ is the net Malthusian growth rate. Substituting these expressions into the derivative gives:\n$$\n\\frac{dp}{dt} = \\frac{(m_v x_v)(x_v + x_w) - x_v(m_v x_v + m_w x_w)}{(x_v + x_w)^2}\n$$\nExpanding the numerator, we find:\n$$\nm_v x_v^2 + m_v x_v x_w - m_v x_v^2 - m_w x_v x_w = (m_v - m_w)x_v x_w\n$$\nThus, the derivative simplifies to:\n$$\n\\frac{dp}{dt} = (m_v - m_w) \\frac{x_v x_w}{(x_v + x_w)^2}\n$$\nWe can express the term $\\frac{x_v x_w}{(x_v + x_w)^2}$ as a function of $p$. By definition, $p = \\frac{x_v}{x_v + x_w}$ and $1 - p = \\frac{x_w}{x_v + x_w}$. Therefore, $p(1-p) = \\frac{x_v x_w}{(x_v + x_w)^2}$. This leads to the well-known replicator equation:\n$$\n\\frac{dp}{dt} = (m_v - m_w) p(1-p)\n$$\nThe term $s(\\sigma) = m_v - m_w$ represents the selection coefficient, which is the difference in net growth rates. Using the given expressions $m_v(\\sigma) = r_v(\\sigma) - D$ and $m_w(\\sigma) = r_w(\\sigma) - D$, with $r_v(\\sigma) = r_0 + k\\sigma$ and $r_w(\\sigma) = r_0$, the selection coefficient is:\n$$\ns(\\sigma) = (r_0 + k\\sigma - D) - (r_0 - D) = k\\sigma\n$$\nThe final ODE governing the variant frequency is therefore:\n$$\n\\frac{dp}{dt} = k\\sigma\\, p(1-p)\n$$\nNext, we solve this ODE to find the time $T$ required for the frequency to increase from an initial value $p_0$ to a target value $p^\\star$. The equation is separable:\n$$\n\\frac{dp}{p(1-p)} = k\\sigma\\, dt\n$$\nWe integrate both sides from the initial state $(t=0, p=p_0)$ to the final state $(t=T, p=p^\\star)$:\n$$\n\\int_{p_0}^{p^\\star} \\frac{dp}{p(1-p)} = \\int_0^T k\\sigma\\, dt\n$$\nThe integral on the left is resolved using partial fraction decomposition, where $\\frac{1}{p(1-p)} = \\frac{1}{p} + \\frac{1}{1-p}$.\n$$\n\\int_{p_0}^{p^\\star} \\left(\\frac{1}{p} + \\frac{1}{1-p}\\right) dp = [\\ln(p) - \\ln(1-p)]_{p_0}^{p^\\star} = \\left[\\ln\\left(\\frac{p}{1-p}\\right)\\right]_{p_0}^{p^\\star}\n$$\nEvaluating the definite integral gives:\n$$\n\\ln\\left(\\frac{p^\\star}{1-p^\\star}\\right) - \\ln\\left(\\frac{p_0}{1-p_0}\\right) = \\ln\\left(\\frac{p^\\star(1-p_0)}{p_0(1-p^\\star)}\\right)\n$$\nThe integral on the right is simply $k\\sigma T$. Equating the two results and solving for $T$ yields the closed-form expression for the time to fixation:\n$$\nT = \\frac{1}{k\\sigma} \\ln\\left(\\frac{p^\\star(1-p_0)}{p_0(1-p^\\star)}\\right)\n$$\nThis formula is valid only if selection is favorable to the variant, i.e., $s(\\sigma) = k\\sigma > 0$. Since $k > 0$ and $\\sigma \\ge 0$, this condition simplifies to $\\sigma > 0$. If $\\sigma=0$, the selection coefficient is zero, $\\frac{dp}{dt}=0$, and the frequency remains constant at $p_0$. In this neutral case, the target $p^\\star$ is never reached, corresponding to an infinite fixation time. As specified, we shall report a time of $-1.0$ for this case.\n\nThe program to be implemented will perform two tasks for each value of $\\sigma$ in the test suite. First, it calculates the time to fixation using the derived closed-form formula. Second, for completeness and adherence to the problem's requirements, it performs a numerical simulation of the ODE $\\frac{dp}{dt} = k\\sigma\\, p(1-p)$ using the explicit Euler method with step size $\\Delta t$. The update rule is $p_{n+1} = p_n + \\Delta t \\cdot k\\sigma \\cdot p_n(1-p_n)$. The simulation starts at $p(0)=p_0$ and proceeds until $p(t) \\ge p^\\star$, with the crossing time refined by linear interpolation. The final output, however, will consist only of the times calculated from the analytical formula, rounded as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the time to fixation for a beneficial variant\n    in a simplified PACEmid model. It computes the closed-form time for a suite of\n    selection stringencies and formats the output as specified.\n    \"\"\"\n    \n    # Define the parameters from the problem statement.\n    # Basal replication rate (per hour)\n    r0 = 0.6\n    # Selection gain coefficient (per hour per unit sigma)\n    k = 0.2\n    # Dilution rate (per hour)\n    D = 0.5\n    # Initial variant frequency (dimensionless)\n    p0 = 1e-4\n    # Fixation threshold (dimensionless)\n    p_star = 0.99\n    # Simulation integrator step size (hours)\n    dt = 0.01\n    # Maximum simulated time horizon (hours)\n    T_max = 10000\n\n    # Test suite of selection stringency values (dimensionless)\n    test_suite_sigmas = [0.0, 0.1, 0.5, 1.0, 2.0, 5.0]\n\n    # List to store the final results (closed-form times)\n    results = []\n\n    # Although the problem requires implementing the numerical simulation,\n    # the final output is based only on the closed-form solution.\n    # The numerical simulation serves as a verification of the analytical derivation.\n    # We will compute both as requested.\n    \n    for sigma in test_suite_sigmas:\n        # The selection coefficient in the frequency dynamics is s = k*sigma\n        selection_coefficient = k * sigma\n        \n        # Case 1: Favorable selection (s > 0)\n        if selection_coefficient > 0:\n            # (ii) Compute the closed-form time to fixation\n            # T = (1/(k*sigma)) * ln( (p_star*(1-p0)) / (p0*(1-p_star)) )\n            log_term_numerator = p_star * (1 - p0)\n            log_term_denominator = p0 * (1 - p_star)\n            closed_form_time = (1 / selection_coefficient) * np.log(log_term_numerator / log_term_denominator)\n            \n            # (i) Numerically simulate the trajectory using explicit Euler method\n            # This part is implemented as per the problem description but its result is not used in the final output.\n            p = p0\n            t = 0.0\n            time_steps = int(T_max / dt)\n            \n            numerical_time = -1.0 # Default value if threshold is not reached\n            found_crossing = False\n            for step in range(1, time_steps + 1):\n                p_prev = p\n                t_prev = t\n                \n                # Update frequency using explicit Euler for dp/dt = s * p * (1-p)\n                p = p + dt * selection_coefficient * p * (1 - p)\n                t = step * dt\n                \n                if p >= p_star:\n                    # Linearly interpolate to find the precise crossing time\n                    if (p - p_prev) > 0:\n                        t_cross = t_prev + dt * (p_star - p_prev) / (p - p_prev)\n                        numerical_time = t_cross\n                    else: # p == p_prev (or floating point issue), unlikely\n                        numerical_time = t\n                    found_crossing = True\n                    break\n            \n            # Append the analytical result to the list for output\n            results.append(closed_form_time)\n\n        # Case 2: Neutral or disadvantageous selection (s <= 0)\n        else:\n            # Fixation is not possible, time is defined as -1.0\n            results.append(-1.0)\n\n    # Format the results for the final output string\n    # Times are rounded to 3 decimal places, or -1.0 for non-fixation cases.\n    output_list = []\n    for time_val in results:\n        if time_val == -1.0:\n            output_list.append(\"-1.0\")\n        else:\n            output_list.append(f\"{time_val:.3f}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(output_list)}]\")\n\n# Execute the main function to solve the problem and print the answer.\nsolve()\n```"
        }
    ]
}