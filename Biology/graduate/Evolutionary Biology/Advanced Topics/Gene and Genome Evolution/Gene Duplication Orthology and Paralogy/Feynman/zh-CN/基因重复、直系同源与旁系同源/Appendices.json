{
    "hands_on_practices": [
        {
            "introduction": "在比较基因组学中，快速鉴定直系同源基因是一项基本任务。最佳相互匹配（Best Reciprocal Hit, BRH）是一种广泛应用的启发式方法，但它并非万无一失。本练习将通过一个精心设计的思想实验，揭示进化速率不对称如何导致BRH方法错误地将旁系同源基因鉴定为直系同源基因，从而帮助您深入理解常用生物信息学工具背后的假设和局限性 。",
            "id": "2715922",
            "problem": "给定以下背景事实作为推理的基础。直系同源基因（Orthologs）是指在不同物种中的一对基因，它们的最近共同祖先是一个物种形成事件（Fitch 定义）；而旁系同源基因（paralogs）是指其最近共同祖先是一个基因重复事件的一对基因。在序列演化速率同质的情况下，较高的序列相似性（例如，较高的比特分数或较低的$E$值）大致反映了两个序列之间较短的演化路径（即每位点的预期替换数较少）。两个物种间的相互最佳匹配（best reciprocal hit, BRH）启发式方法被广泛用于通过成对相似性搜索来鉴定推定的直系同源基因。\n\n假设有一位不知名的研究者声称，在比较两个物种时，BRH总能检索到真正的直系同源基因，且速率不对称性不会导致错误。你希望通过选择一个选项来评估这一主张，该选项需要同时满足 (i) 正确定义BRH启发式方法，以及 (ii) 提供一个具体的、科学上合理的反例，在该反例中，速率不对称性导致BRH未能检索到真正的直系同源基因。\n\n哪个选项最能同时满足 (i) 和 (ii)？\n\nA. BRH定义：对于两个物种 $S_1$ 和 $S_2$，基因 $g \\in S_1$ 和 $h \\in S_2$ 构成一个BRH对，当且仅当 $h = \\arg\\max_{x \\in S_2} f(g,x)$ 且 $g = \\arg\\max_{y \\in S_1} f(y,h)$，其中 $f$ 是一个相似性得分，如比特分数或$E$值的负数。反例：一个祖先基因在时间 $t_d = 1.5$ （以与分支长度相同的时间单位计量）时发生重复，产生复制体 $X$ 和 $Y$。随后在时间 $t_s = 1.0$ 发生物种形成，产生物种 $A$ 和 $B$。物种 $A$ 只保留了 $X$（称之为 $a$）。物种 $B$ 同时保留了 $X$（称之为 $b_X$）和 $Y$（称之为 $b_Y$）。替换速率（每位点每单位时间）如下：物种形成后，$A$ 的 $X$ 谱系上的速率为 $\\mu_{A,X} = 1.0$；$B$ 的 $X$ 谱系上的速率为 $\\mu_{B,X} = 2.0$（加速）；$B$ 的 $Y$ 谱系上的速率为 $\\mu_{B,Y} = 0.1$（减速）；在重复到物种形成之间的祖先分支上，速率为 $\\mu_{\\text{anc}} = 0.5$。在泊松模型下，$a$ 和 $b_X$（直系同源基因）之间的预期成对分歧度为 $d(a,b_X) = \\mu_{A,X} t_s + \\mu_{B,X} t_s = 1.0 \\cdot 1.0 + 2.0 \\cdot 1.0 = 3.0$。$a$ 和 $b_Y$（远源旁系同源基因，最近共同祖先在重复事件处）之间的预期分歧度为 $d(a,b_Y) = \\mu_{A,X} t_s + \\mu_{B,Y} t_s + 2 \\mu_{\\text{anc}} (t_d - t_s) = 1.0 \\cdot 1.0 + 0.1 \\cdot 1.0 + 2 \\cdot 0.5 \\cdot (1.5 - 1.0) = 1.6$。因为 $1.6 < 3.0$，所以 $f(a,b_Y) > f(a,b_X)$，因此 $a$ 在 $B$ 中的最佳匹配是 $b_Y$。在从 $B$ 到 $A$ 的反向搜索中，$b_X$ 和 $b_Y$ 在 $A$ 中的最佳匹配都是 $a$，但只有 $b_Y$ 与 $a$ 形成了相互最佳匹配。因此，BRH返回了 $(a,b_Y)$，它们是远源旁系同源基因，从而由于速率不对称性而未能检索到真正的直系同源基因 $(a,b_X)$。\n\nB. BRH定义：两个物种之间的BRH对是在移除谱系特异性旁系同源基因后，在两个蛋白质组中具有最高总体相似性的两个基因。反例：一个基因在物种形成时间 $t_s = 1.0$ 之后在物种 $B$ 中发生重复，产生 $b_1$ 和 $b_2$，其速率分别为 $\\mu_{B,1} = 2.0$ 和 $\\mu_{B,2} = 0.1$，而物种 $A$ 有一个单一的直系同源基因 $a$，其速率为 $\\mu_{A} = 1.0$。因为 $b_2$ 演化缓慢，所以相互最佳匹配是 $(a,b_2)$，它们是旁系同源基因而非直系同源基因；因此，BRH由于速率不对称性而失败。\n\nC. BRH定义：来自不同物种的两个基因，如果在固定的计分方案下，它们是彼此得分最高的局部比对，则它们是相互最佳匹配。反例：物种形成前的一次重复导致 $A$ 中有 $X$，$B$ 中有 $X$ 和 $Y$，物种形成后速率相等，为 $\\mu_{A,X} = \\mu_{B,X} = \\mu_{B,Y} = 1.0$，且 $\\mu_{\\text{anc}} = 0.5$，$t_d = 1.5$，$t_s = 1.0$。直系同源分歧度 $d(a,b_X) = 2.0$，旁系同源分歧度 $d(a,b_Y) = 3.0$。因为 $d(a,b_X) < d(a,b_Y)$，相互最佳匹配找到了直系同源基因，这表明BRH在速率不对称性下会失败。\n\nD. BRH定义：在三物种比较中，如果三个基因使得成对相似性的三角不等式最大化，则它们是BRH。反例：系统发育树重建过程中的长枝吸引现象导致错误的叶节点聚在一起，因此BRH也必定会因为同样的机制性偏差而失败，无论速率或重复时间如何。",
            "solution": "对问题陈述进行验证。\n\n**1. 提取已知条件：**\n- 直系同源基因的定义：不同物种中的基因，其最近共同祖先是一个物种形成事件。\n- 旁系同源基因的定义：基因，其最近共同祖先是一个基因重复事件。\n- 相似性与距离的关系：较高的序列相似性反映了较短的演化路径（较少的预期替换数）。\n- 相互最佳匹配（BRH）：一种通过成对相似性搜索来鉴定推定直系同源基因的启发式方法。\n- 问题假设了一位研究者声称BRH是绝对可靠的，并且不受速率不对称性导致的错误影响。\n- 任务是选择一个满足两个标准的选项：(i) 提供了BRH启发式方法的正确定义，以及 (ii) 提出了一个科学上合理的反例，其中速率不对称性导致BRH未能鉴定出真正的直系同源基因。\n\n**2. 验证：**\n- **科学依据：** 直系同源和旁系同源的定义是在分子演化中使用的标准 Fitch 定义。序列相似性与演化距离之间的反比关系是生物信息学的基石。BRH可能会失败的论点，特别是由于不对称的演化速率导致对远源旁系同源基因的错误鉴定（这种现象有时被称为“隐藏的旁系同源性”），是计算生物学中有据可查的问题。因此，该问题在科学上是合理的。\n- **适定性：** 该问题是适定的（well-posed）。它要求确定一个满足两个清晰且不同标准的选项。待评估的场景——基因重复、物种形成、差异性基因丢失和速率不对称性——是研究此特定问题的经典模型。\n- **客观性：** 问题陈述客观，并使用了演化生物学领域的精确、标准术语。\n\n**3. 结论：**\n问题陈述有效。它科学严谨，问题适定，并直接解决直系同源基因检测中的一个关键概念性挑战。我们可以着手求解。\n\n**求解推导：**\n任务是根据两个标准评估每个选项：相互最佳匹配（BRH）启发式方法的正确定义，以及一个有效的反例，用以说明其因速率不对称性而失败。一个有效的反例必须描述这样一个场景：由于基因重复和物种形成后不均等的演化速率，导致BRH对由远源旁系同源基因组成，而不是真正的直系同源基因。\n\n这种失败的经典场景涉及一个共同祖先中的基因重复，随后是物种形成，然后在后代谱系中发生差异性基因丢失和速率异质性。假设存在一个祖先基因，在时间 $t_d$ 重复成拷贝 $X$ 和 $Y$。一个物种形成事件在稍后的时间 $t_s < t_d$ 发生，产生了物种 $S_1$ 和 $S_2$。假设 $S_1$ 丢失了源自 $Y$ 的拷贝，只保留了基因 $a$（来自 $X$）。假设 $S_2$ 保留了两个拷贝，$b_X$（来自 $X$）和 $b_Y$（来自 $Y$）。\n- 真正的直系同源基因是 $(a, b_X)$，因为它们的最近共同祖先是物种形成事件。\n- 基因 $a$ 和 $b_Y$ 是远源旁系同源基因，因为它们的最近共同祖先是重复事件。\n- 演化距离 $d$ 是基因树中连接两个基因的路径上预期替换的总数。$d \\propto \\sum (\\text{速率} \\times \\text{时间})$。\n- 相似性 $f$ 与距离成反比：如果 $d_1 < d_2$，则 $f_1 > f_2$。\n- 如果BRH将 $(a, b_Y)$ 鉴定为直系同源基因，则BRH失败。这种情况发生在 $b_Y$ 是 $a$ 在 $S_2$ 中的最佳匹配（即 $f(a, b_Y) > f(a, b_X)$），并且 $a$ 是 $b_Y$ 在 $S_1$ 中的最佳匹配（如果 $a$ 是唯一的基因，这一点自然成立）。该条件简化为 $d(a, b_Y) < d(a, b_X)$。\n\n直系同源基因 $(a, b_X)$ 之间的距离是从物种形成节点开始的两个谱系上的分歧度之和：\n$$d(a, b_X) = \\mu_{1,X} t_s + \\mu_{2,X} t_s$$\n远源旁系同源基因 $(a, b_Y)$ 之间的距离是从 $a$ 到重复节点再回到 $b_Y$ 的路径上的分歧度之和：\n$$d(a, b_Y) = \\mu_{1,X} t_s + 2 \\mu_{\\text{anc}} (t_d - t_s) + \\mu_{2,Y} t_s$$\n其中 $\\mu_{i,G}$ 是物种 $i$ 中基因 $G$ 在物种形成后的速率，$\\mu_{\\text{anc}}$ 是重复和物种形成之间的祖先分支上的速率。如果真正直系同源基因的高速率（例如，大的 $\\mu_{2,X}$）和远源旁系同源基因的低速率（例如，小的 $\\mu_{2,Y}$）导致 $d(a, b_Y) < d(a, b_X)$，则BRH失败。\n\n**选项评估：**\n\n**A. BRH定义：对于两个物种 $S_1$ 和 $S_2$，基因 $g \\in S_1$ 和 $h \\in S_2$ 构成一个BRH对，当且仅当 $h = \\arg\\max_{x \\in S_2} f(g,x)$ 且 $g = \\arg\\max_{y \\in S_1} f(y,h)$，其中 $f$ 是一个相似性得分，如比特分数或$E$值的负数。反例：一个祖先基因在时间 $t_d = 1.5$ （以与分支长度相同的时间单位计量）时发生重复，产生复制体 $X$ 和 $Y$。随后在时间 $t_s = 1.0$ 发生物种形成，产生物种 $A$ 和 $B$。物种 $A$ 只保留了 $X$（称之为 $a$）。物种 $B$ 同时保留了 $X$（称之为 $b_X$）和 $Y$（称之为 $b_Y$）。替换速率（每位点每单位时间）如下：物种形成后，$A$ 的 $X$ 谱系上的速率为 $\\mu_{A,X} = 1.0$；$B$ 的 $X$ 谱系上的速率为 $\\mu_{B,X} = 2.0$（加速）；$B$ 的 $Y$ 谱系上的速率为 $\\mu_{B,Y} = 0.1$（减速）；在重复到物种形成之间的祖先分支上，速率为 $\\mu_{\\text{anc}} = 0.5$。在泊松模型下，$a$ 和 $b_X$（直系同源基因）之间的预期成对分歧度为 $d(a,b_X) = \\mu_{A,X} t_s + \\mu_{B,X} t_s = 1.0 \\cdot 1.0 + 2.0 \\cdot 1.0 = 3.0$。$a$ 和 $b_Y$（远源旁系同源基因，最近共同祖先在重复事件处）之间的预期分歧度为 $d(a,b_Y) = \\mu_{A,X} t_s + \\mu_{B,Y} t_s + 2 \\mu_{\\text{anc}} (t_d - t_s) = 1.0 \\cdot 1.0 + 0.1 \\cdot 1.0 + 2 \\cdot 0.5 \\cdot (1.5 - 1.0) = 1.6$。因为 $1.6 < 3.0$，所以 $f(a,b_Y) > f(a,b_X)$，因此 $a$ 在 $B$ 中的最佳匹配是 $b_Y$。在从 $B$ 到 $A$ 的反向搜索中，$b_X$ 和 $b_Y$ 在 $A$ 中的最佳匹配都是 $a$，但只有 $b_Y$ 与 $a$ 形成了相互最佳匹配。因此，BRH返回了 $(a,b_Y)$，它们是远源旁系同源基因，从而由于速率不对称性而未能检索到真正的直系同源基因 $(a,b_X)$。**\n\n- **定义分析：** 所提供的定义，$h = \\arg\\max_{x \\in S_2} f(g,x)$ 且 $g = \\arg\\max_{y \\in S_1} f(y,h)$，是相互最佳匹配启发式方法的精确、形式化定义。该定义是正确的。\n- **反例分析：** 该场景符合BRH失败的经典模型。真正的直系同源基因是 $(a, b_X)$，远源旁系同源基因是 $(a, b_Y)$。演化距离的计算是根据所提供的参数正确执行的。\n  - 直系同源基因距离：$d(a, b_X) = \\mu_{A,X} t_s + \\mu_{B,X} t_s = (1.0 \\times 1.0) + (2.0 \\times 1.0) = 3.0$。\n  - 远源旁系同源基因距离：$d(a, b_Y) = \\mu_{A,X} t_s + \\mu_{B,Y} t_s + 2\\mu_{\\text{anc}}(t_d - t_s) = (1.0 \\times 1.0) + (0.1 \\times 1.0) + 2(0.5)(1.5 - 1.0) = 1.0 + 0.1 + 1.0(0.5) = 1.6$。\n计算是正确的。由于 $d(a, b_Y) = 1.6 < d(a, b_X) = 3.0$，相似性 $f(a, b_Y)$ 将大于 $f(a, b_X)$。因此，$a$ 在物种 $B$ 中的最佳匹配是远源旁系同源基因 $b_Y$。从 $B$ 中的任何基因反向搜索到 $A$ 的单基因蛋白质组，将总是返回 $a$ 作为最佳匹配。因此，$(a, b_Y)$ 构成一个BRH对。这是一个直系同源关系的假阳性。该失败是由速率不对称性直接引起的：直系同源基因 $b_X$ 演化得快（$\\mu_{B,X} = 2.0$），而旁系同源基因 $b_Y$ 演化得慢（$\\mu_{B,Y} = 0.1$），使得旁系同源基因看起来关系更近。该反例是具体的、科学上合理的，并且在数学上是健全的。\n- **结论：** 正确。\n\n**B. BRH定义：两个物种之间的BRH对是在移除谱系特异性旁系同源基因后，在两个蛋白质组中具有最高总体相似性的两个基因。反例：一个基因在物种形成时间 $t_s = 1.0$ 之后在物种 $B$ 中发生重复，产生 $b_1$ 和 $b_2$，其速率分别为 $\\mu_{B,1} = 2.0$ 和 $\\mu_{B,2} = 0.1$，而物种 $A$ 有一个单一的直系同源基因 $a$，其速率为 $\\mu_{A} = 1.0$。因为 $b_2$ 演化缓慢，所以相互最佳匹配是 $(a,b_2)$，它们是旁系同源基因而非直系同源基因；因此，BRH由于速率不对称性而失败。**\n\n- **定义分析：** 这个定义不正确且混乱。BRH鉴定的是多个配对，而不是具有“最高总体相似性”的“那个”配对。在搜索*之前*移除旁系同源基因的指令是循环论证，因为区分直系同源和旁系同源正是其目标。\n- **反例分析：** 该场景描述了一个物种形成后的重复事件。物种 $A$ 中的基因 $a$ 与物种 $B$ 中的 $b_1$ 和 $b_2$ 都是共同直系同源的（co-orthologous）；基因 $b_1$ 和 $b_2$ 是近源旁系同源基因（in-paralogs）。声称 $(a, b_2)$ 是“旁系同源而非直系同源基因”是一个根本性错误。它们的最近共同祖先是物种形成节点，因此根据定义，它们是直系同源基因。BRH正确地鉴定了一个直系同源关系 $(a, b_2)$。这里的问题是BRH无法完全捕捉到的一对多直系同源关系，而不是未能区分直系同源和旁系同源基因。\n- **结论：** 错误。\n\n**C. BRH定义：来自不同物种的两个基因，如果在固定的计分方案下，它们是彼此得分最高的局部比对，则它们是相互最佳匹配。反例：物种形成前的一次重复导致 $A$ 中有 $X$，$B$ 中有 $X$ 和 $Y$，物种形成后速率相等，为 $\\mu_{A,X} = \\mu_{B,X} = \\mu_{B,Y} = 1.0$，且 $\\mu_{\\text{anc}} = 0.5$，$t_d = 1.5$，$t_s = 1.0$。直系同源分歧度 $d(a,b_X) = 2.0$，旁系同源分歧度 $d(a,b_Y) = 3.0$。因为 $d(a,b_X) < d(a,b_Y)$，相互最佳匹配找到了直系同源基因，这表明BRH在速率不对称性下会失败。**\n\n- **定义分析：** 这个定义虽然非正式但可以接受，因为它抓住了使用BLAST或类似工具的BRH程序的精髓。\n- **反例分析：** 这个例子明确使用了*相等*的物种形成后速率，而不是速率不对称。因此，它未能解决问题的一个关键要求。此外，其逻辑是自相矛盾的。它计算出（存在一个错误，正确的 $d(a,b_Y)$ 是 $2.5$）直系同源基因更相似（$d(a,b_X) < d(a,b_Y)$），并指出BRH正确地找到了它们，但随后却得出结论这“表明BRH失败了”。这种推理毫无意义。\n- **结论：** 错误。\n\n**D. BRH定义：在三物种比较中，如果三个基因使得成对相似性的三角不等式最大化，则它们是BRH。反例：系统发育树重建过程中的长枝吸引现象导致错误的叶节点聚在一起，因此BRH也必定会因为同样的机制性偏差而失败，无论速率或重复时间如何。**\n\n- **定义分析：** 这个定义完全不正确。BRH是一种针对两个物种的成对方法。该描述指的是一种不同的、多物种的启发式方法，并且误用了“三角不等式”这一术语。\n- **反例分析：** 这不是一个具体的反例，而是一个有缺陷的类比论证。长枝吸引是系统发育树重建方法的一种机制性偏差（artifact），其机制与BRH的成对比较逻辑不同。虽然它们都与速率异质性这一共同原因有关，但一个并不能以这种方式直接推导出另一个。声称这“无论速率如何”都会发生是错误的；这些失败严重依赖于特定的速率配置。\n- **结论：** 错误。\n\n**最终结论：**\n选项A是唯一一个既提供了BRH启发式方法的正确、形式化定义，又提供了一个有效的、具体的、计算正确的反例，证明了BRH由于演化速率不对称而无法区分远源旁系同源基因和真正直系同源基因的失败情况。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理论知识的最终目的是应用于实际研究。这个案例研究将您置于一个真实的研究场景中：一项已发表的研究报告了某个基因家族存在正选择，但您怀疑这可能是由“隐藏的旁系同源”问题导致的假阳性信号 。本练习要求您设计一个严谨的分析流程来诊断并纠正这个问题，这能锻炼您批判性地评估科学文献以及在复杂的基因家族中进行可靠进化分析的实践能力。",
            "id": "2715891",
            "problem": "一项已发表的比较研究测试了一个单拷贝基因家族 $G$ 在多个物种间的非同义替换率是否高于同义替换率，并报告了存在正选择的证据。作者们采样了 $S=8$ 种哺乳动物，使用基础局部比对搜索工具（BLAST；相互最佳匹配(RBH)标准，$E<10^{-5}$）通过相互最佳匹配方法鉴定了推定的直系同源基因，每个物种保留一个序列（总共 $n=8$），生成了密码子比对，并估算了非同义与同义替换率之比 $\\omega=d_{N}/d_{S}$。一项似然比检验（LRT）报告 $\\hat{\\omega}=1.3$ 和 $p$ 值 $p=0.01$。随后的基因组检查表明，在 $S=8$ 个物种中的 $k=3$ 个物种里，存在 $2$ 个 $G$ 的串联重复拷贝，它们之间相隔不到 $10$ 千碱基，并且 RBH 过程似乎在不同物种间对这些重复拷贝的选择不一致。\n\n从分子进化和系统发育基因组学的核心定义出发——即直系同源基因（orthologs）是通过物种形成相关的同源基因，旁系同源基因（paralogs）是通过基因重复相关的同源基因，且当 $\\omega<1$ 时 $\\omega=d_{N}/d_{S}$ 被解释为纯化选择，当 $\\omega\\approx 1$ 时为中性选择，当 $\\omega>1$ 时为正选择——请提出你将如何诊断最初报告的正选择信号是否可由隐藏的旁系同源性解释，以及在重新检验选择之前你将如何校正该分析。你的计划应基于直系同源推断和密码子模型分析的公认实践，并且应避免在基因重复背景下无效的假设。\n\n以下哪个（些）选项最恰当地诊断和纠正了此背景下的隐藏旁系同源性，以便重新检验正选择？选择所有适用选项。\n\nA. 构建一个基因树，包括来自所有 $S=8$ 个物种的 $G$ 的所有检测到的拷贝，并加上至少一个外群来为树定根；将此基因树与一个整理过的物种树进行协调，以推断和确定重复事件的时间；通过排除从推断的重复节点产生的谱系分支，识别并修剪出一个 $1-1$ 直系同源基因的进化支；使用密码子感知比对器重新比对保留的直系同源基因，并使用仅限于该直系同源进化支的分支-位点模型重新估计 $\\omega$。\n\nB. 保留原始的 $n=8$ 个序列集和比对不变；将密码子模型替换为具有跨位点 $\\Gamma$ 分布速率变异的核苷酸替换模型，以解释异质性，并在不改变直系同源分配的情况下重新运行相同的似然比检验。\n\nC. 对于有 $2$ 个重复拷贝的物种，选择与人类的成对同义差异 $d_{S}$ 最小的那个拷贝，对于单拷贝物种，保留原始的 RBH 选择，然后汇集这 $n=8$ 个序列，并像以前一样重新估计 $\\omega$。\n\nD. 检查跨物种 $G$ 周围 $\\pm 10$ 个基因的基因组邻域中的保守共线性，以定义共线的推定 $1-1$ 直系同源基因；使用基因树-物种树协调法交叉验证该集合，以确认所选进化支内不存在重复节点；将选择分析限制在这个经过验证的直系同源基因集上，并且如果测试多个分支或模型，则应用适当的多重检验校正。\n\nE. 将每个物种的所有旁系同源拷贝连接成一个单一的超序列，以保留所有替换，然后重新比对，并重新拟合密码子模型，这在避免直系同源决策的同时，增加了检测选择的效力。",
            "solution": "问题陈述描述了这样一种情况：一项初步分析报告称，在一个包含 $S=8$ 个哺乳动物物种的基因家族 $G$ 中，存在正选择（$\\hat{\\omega} = d_{N}/d_{S} = 1.3$）。这一结论基于一组使用相互最佳匹配（RBH）方法识别的推定直系同源基因。然而，随后的调查显示，在其中 $k=3$ 个物种中，基因 $G$ 并非单拷贝基因；这些物种拥有串联重复。RBH 过程是一种成对比较方法，众所周知，在存在基因重复和差异性基因丢失的情况下，该方法并不可靠，而在本案例中，据称它在旁系同源基因之间的选择存在不一致。这是一个关键缺陷。\n\n核心问题是**隐藏的旁系同源性**。原始分析中使用的 $n=8$ 个序列集并不是真正的直系同源基因（由物종形成事件相关的基因）集合，而是直系同源基因和旁系同源基因（由基因重复事件相关的基因）的混合体。基因重复后，产生的旁系同源基因之一可能会受到宽松的纯化选择或经历正选择以获得新功能（新功能化）。当一个物种中这样一个快速进化的旁系同源基因被错误地与另一个物种中保守的直系同源基因进行比较时，非同义替换率可能会被人为地抬高。这会夸大整个基因树的 $\\omega$ 估计值，常常导致正选择的假阳性信号。这是分子进化研究中一个有据可查的人为误差。\n\n因此，有效的校正必须放弃有缺陷的成对 RBH 方法，转而使用基于系统发育原则的方法来区分直系同源和旁系同源。实现这一目标最标准且最可靠的方法是重建整个基因家族的进化史。关键步骤如下：\n1.  从 $S=8$ 个物种中收集基因 $G$ 所有可检测到的同源序列，并包含至少一个外群物种。\n2.  基于这些序列的多重序列比对，为该基因家族构建一个系统发育树。需要一个外群来为树定根，以确立进化的方向。\n3.  将有根的基因树与已知的物种系统发育进行协调。该过程涉及将基因树映射到物种树上，以推断基因树中的哪些节点代表物种形成事件，哪些代表基因重复事件。\n4.  基于协调后的树，识别出一组真正的“一对一”（$1-1$）直系同源基因。这通常是基因树的一个子进化支，其中每个物种恰好包含一个基因，并且该进化支内的所有分叉都是物种形成事件。任何从重复节点衍生出的谱系都必须被修剪，以获得这样一个纯净的集合。\n5.  使用这个经过验证的直系同源基因集合，重新进行选择分析。这包括创建一个新的密码子比对，并拟合适当的基于密码子的进化模型（例如，分支-位点模型）来检验正选择，此时已不受旁系同源性的混淆效应影响。\n\n基于这种有原则的方法，我们可以评估所提供的选项。\n\n**A. 构建一个基因树，包括来自所有 $S=8$ 个物种的 $G$ 的所有检测到的拷贝，并加上至少一个外群来为树定根；将此基因树与一个整理过的物种树进行协调，以推断和确定重复事件的时间；通过排除从推断的重复节点产生的谱系分支，识别并修剪出一个 $1-1$ 直系同源基因的进化支；使用密码子感知比对器重新比对保留的直系同源基因，并使用仅限于该直系同源进化支的分支-位点模型重新估计 $\\omega$。**\n该选项细致地遵循了解决隐藏旁系同源性问题的标准、可靠且公认的系统发育工作流程。它正确地规定了(1)收集所有同源基因，(2)构建有根的基因树，(3)协调基因树和物种树以识别重复，(4)修剪以获得纯净的 $1-1$ 直系同源基因集合，以及(5)在校正后的数据集上重新运行恰当的选择分析（使用密码子感知比对器和强大的分支-位点模型）。该程序直接解决了问题的根本原因。\n**结论：正确。**\n\n**B. 保留原始的 $n=8$ 个序列集和比对不变；将密码子模型替换为具有跨位点 $\\Gamma$ 分布速率变异的核苷酸替换模型，以解释异质性，并在不改变直系同源分配的情况下重新运行相同的似然比检验。**\n这个选项根本上是错误的。其主要错误在于“保留原始的 $n=8$ 个序列集”，而已知该序列集受到旁系同源基因的污染。没有任何统计模型，无论多么复杂，能够纠正一个歪曲了真实进化关系的数据集。此外，将密码子模型替换为核苷酸替换模型不适合用于检验蛋白质功能所受的正选择，因为关键指标 $\\omega = d_{N}/d_{S}$ 是密码子进化的属性，而非核苷酸进化。$\\Gamma$ 分布的速率变异考虑了位点间的速率异质性，但不能解决包含不正确序列（旁系同源基因）的问题。\n**结论：不正确。**\n\n**C. 对于有 $2$ 个重复拷贝的物种，选择与人类的成对同义差异 $d_{S}$ 最小的那个拷贝，对于单拷贝物种，保留原始的 RBH 选择，然后汇集这 $n=8$ 个序列，并像以前一样重新估计 $\\omega$。**\n该选项提出了一种基于成对序列差异的启发式方法。虽然可能比随机选择要好，但它不是一种有原则的系统发育方法。它武断地使用“人类”作为参考，这可能不合适，并且“真正的”直系同源基因具有较低 $d_S$ 的假设并不能保证为真。该方法仍然回避了构建完整基因树以同时可视化和解决所有关系的关键步骤。它是另一种形式的成对分析，就像RBH一样，容易受到其自身一系列错误的影响。它不被认为是用于明确直系同源分配的可靠或公认的做法。\n**结论：不正确。**\n\n**D. 检查跨物种 $G$ 周围 $\\pm 10$ 个基因的基因组邻域中的保守共线性，以定义共线的推定 $1-1$ 直系同源基因；使用基因树-物种树协调法交叉验证该集合，以确认所选进化支内不存在重复节点；将选择分析限制在这个经过验证的直系同源基因集上，并且如果测试多个分支或模型，则应用适当的多重检验校正。**\n该选项描述了一种出色且非常严谨的方法。它使用了一条独立的证据线——保守共线性（基因顺序）——来提出推定的直系同源基因。真正的直系同源基因比旁系同源基因（特别是近期的串联重复）更有可能位于保守的基因组环境中。关键是，它不仅依赖于共线性，还使用强大的基因树-物种树协调方法来“交叉验证”这一假设。这种基因组位置和序列系统发育的结合为直系同源性提供了非常强的证据。后续步骤将分析限制在经过验证的集合上，并应用适当的统计校正，也是正确的。这代表了现代系统发育基因组学中的一种黄金标准方法。\n**结论：正确。**\n\n**E. 将每个物种的所有旁系同源拷贝连接成一个单一的超序列，以保留所有替换，然后重新比对，并重新拟合密码子模型，这在避免直系同源决策的同时，增加了检测选择的效力。**\n这个程序在生物学上是荒谬的。连接旁系同源基因会产生一个自然界中不存在的人工嵌合序列，它没有连贯的进化历史。所有系统发育和分子进化模型的假设都将被违反。这种“超序列”的比对将是无意义的，任何由此产生的 $\\omega$ 估计值都将是无法解释的垃圾。这种方法并没有“避免”直系同源问题；它完全误解了这个问题，导致了致命的分析缺陷。声称这会“增加效力”是毫无根据的。\n**结论：不正确。**",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "理解基因重复的后果之后，一个更根本的问题是如何从原始测序数据中检测到这些事件。串联重复在基因组中会留下独特的信号，即可读段深度（read depth）的增加和预示着新连接点的分裂可读段（split reads） 。本练习将指导您从第一性原理出发，构建一个计算决策规则，通过整合这两种证据来识别近期的串联重复，从而让您亲身体验如何将高层次的进化事件与其在原始数据中的底层信号联系起来。",
            "id": "2715859",
            "problem": "从机制上定义不等姐妹染色单体交换，然后从第一性原理出发，构建一个计算决策规则，该规则通过结合读取深度证据和分割读取断点证据，来检测短读长重测序数据中的近期串联重复。从以下基础且被广泛接受的依据开始：(i) 对于均匀抽样的读长，读取深度与基础脱氧核糖核酸（DNA）拷贝数之间的比例关系，(ii) 固定宽度窗口内读取计数的泊松模型，以及 (iii) 在一个二倍体基因组中，串联重复预期会将局部拷贝数从 $2$ 增加到 $3$，并产生可被检测为分割读取比对的头尾连接断点。解释此类重复如何产生旁系同源拷贝，以及这些拷贝在概念上与跨物种的直系同源关系有何不同。您的决策规则必须从这些依据明确推导得出，而非直接断言。\n\n您的程序必须实现推导出的规则，并采用以下形式化和固定的校准选择，以使结果可被测试：\n\n- 对于每个基因组窗口，设 $x$ 为观测到的读取计数，设 $\\mu$ 为在经过适当归一化（例如，通过全基因组覆盖度和可比对性）后，基线二倍体拷贝数为 $2$ 时该窗口的预期读取计数。在零假设（无重复）下，模型为 $x \\sim \\mathrm{Poisson}(\\mu)$。在一个二倍体中的单拷贝串联重复下，备择假设的均值模型为 $\\mu_{1} = \\frac{3}{2}\\mu$。\n- 定义对数比率 $L = \\log_{2}\\!\\left(\\frac{x+\\epsilon}{\\mu+\\epsilon}\\right)$，其中 $\\epsilon = 10^{-6}$ 以避免除以零。\n- 使用泊松方差近似，定义标准化残差 $z = \\frac{x - \\mu}{\\sqrt{\\mu}}$。\n- 定义分割读取支持度 $s$ 为与窗口内或其边界处的头尾串联重复断点一致的分割读取比对的数量。\n- 当且仅当以下所有条件同时成立时，将一个窗口标记为近期串联重复：\n  1. 深度升高：$L \\ge \\tau_{L}$，其中 $\\tau_{L} = \\log_{2}(1.3)$。\n  2. 深度显著性：$z \\ge z_{\\min}$，其中 $z_{\\min} = 3.5$。\n  3. 断点支持度：$s \\ge s_{\\min}$，其中 $s_{\\min} = 3$。\n为确保确定性，本次练习中这些阈值是固定的；您的推导应证明为何结合比例性、泊松变异性和断点证据是符合原理的。\n\n测试套件。您的程序必须评估以下六种情况，每种情况由一个三元组 $(\\mu, x, s)$ 表示：\n- 情况 A: $(1000, 1500, 6)$\n- 情况 B: $(1000, 980, 0)$\n- 情况 C: $(1000, 1500, 0)$\n- 情况 D: $(1000, 1000, 5)$\n- 情况 E: $(400, 560, 4)$\n- 情况 F: $(40, 60, 3)$\n\n对于每种情况，输出一个布尔值，指示该规则是否将该情况判定为近期串联重复。\n\n最终输出格式。您的程序应生成单行输出，其中包含从 A 到 F 的结果，格式为方括号内以逗号分隔的列表（例如，“[trueA,trueB,...]”但使用 Python 布尔字面量）。不需要物理单位。不涉及角度。不得使用百分比；所有比较都是对 $L$、$z$ 和 $s$ 的直接数值阈值比较。",
            "solution": "所述问题在科学上是合理的，内部一致且定义明确。它建立在分子生物学和统计基因组学的既定原则之上。构建和测试计算规则所需的所有参数和定义均已提供。因此，可以推导出一个严谨的解决方案。\n\n首先，我们来讨论其概念基础。\n\n**I. 机制与同源性**\n\n基因重复是进化创新的基本驱动力。产生串联重复（即基因组片段的一个拷贝被插入到原始位置旁）的一个主要机制是**不等姐妹染色单体交换 (unequal sister chromatid exchange, USCE)**。在有丝分裂或减数分裂期间，姐妹染色单体（一个复制后染色体的两个相同拷贝）会为了DNA修复等过程进行同源重组。如果基因组中含有重复序列（例如，转座元件），可能会发生错位，即一条染色单体与其姐妹染色单体上的非等位但同源的重复序列配对。随后的交换事件将导致遗传物质的不等交换。一条染色单体将获得一个重复片段，而另一条则会发生相应的缺失。\n\n这种重复事件产生了**旁系同源基因 (paralogous genes)**。为了精确起见，我们必须区分不同类型的同源性：\n- **同源体 (Homologs)** 是指共享一个共同进化祖先的基因。\n- **直系同源体 (Orthologs)** 是存在于不同物种中的同源体，它们起源于最后一个共同祖先中的单个祖先基因。它们由物种形成事件产生，通常保留等效功能。\n- **旁系同源体 (Paralogs)** 是同一物种内的同源体，起源于重复事件（如 USCE）。重复之后，两个旁系同源拷贝可以发生分化。一个拷贝可能维持原有功能，而另一个则可以自由积累突变，可能导致新功能（新功能化，neofunctionalization）、功能细分（亚功能化，subfunctionalization），或成为无功能的假基因（假基因化，pseudogenization）。\n\n本问题关注的是近期串联重复的检测，这种重复会产生新生的旁系同源拷贝。\n\n**II. 决策规则的第一性原理推导**\n\n所提出的决策规则是一个逻辑构造，它整合了三个正交的证据线索，每个线索都基于测序数据分析的一个基本原则。我们为规则的每个组成部分推导其合理性。\n\n**原则A：读取深度与DNA拷贝数的比例关系**\n第一个原则是，对于一个理想的、具有均匀随机抽样的短读长测序实验，映射到某个基因组区域的读取数量与样本中该区域DNA的拷贝数成正比。\n\n设 $C_0$ 为一个二倍体生物的基线拷贝数，即 $C_0 = 2$。设 $\\mu$ 为这样一个区域在经过局部可比对性和全局测序通量等因素归一化后的预期读取计数（或“深度”）。\n\n一个近期的杂合串联重复意味着，在两条同源染色体中的一条上，该片段以两个拷贝的形式存在，而在另一条上，它仍然是单个拷贝。因此，新的总拷贝数 $C_1$ 为 $C_1 = 1 + 2 = 3$。\n\n根据比例性原则，重复区域的预期读取计数 $\\mu_1$ 与基线预期 $\\mu$ 通过拷贝数比率相关联：\n$$ \\mu_1 = \\mu \\times \\frac{C_1}{C_0} = \\mu \\times \\frac{3}{2} $$\n这个推导为备择假设的均值 $\\mu_1 = \\frac{3}{2}\\mu$ 提供了理论基础。因此，观测到的读取计数 $x$ 应围绕二倍体预期的 $1.5$ 倍波动。\n\n**原则B：读取计数的泊松模型**\n第二个原则是，对固定宽度基因组窗口进行测序和读取比对的过程可以被建模为一个泊松过程。一个窗口内的读取计数 $x$ 是一个遵循泊松分布的随机变量，$x \\sim \\mathrm{Poisson}(\\lambda)$，其中 $\\lambda$ 是预期计数。泊松分布的方差等于其均值，即 $\\mathrm{Var}(x) = \\lambda$。\n\n我们建立一个假设检验框架：\n- **零假设 ($H_0$):** 该区域是二倍体（无重复）。预期读取计数为 $\\mu$。因此，$x \\sim \\mathrm{Poisson}(\\mu)$。\n- **备择假设 ($H_1$):** 该区域有一个杂合的串联重复。预期读取计数为 $\\mu_1 = \\frac{3}{2}\\mu$。因此，$x \\sim \\mathrm{Poisson}(\\frac{3}{2}\\mu)$。\n\n从这两个原则出发，我们推导出两个基于读取深度的标准：\n\n1.  **深度升高标准 ($L$):** 我们需要检验观测数据是否与 $\\frac{3}{2} = 1.5$ 的预期倍数变化一致。我们使用对数比率 $L = \\log_{2}\\!\\left(\\frac{x+\\epsilon}{\\mu+\\epsilon}\\right)$。使用对数是为了稳定方差，并使倍数变化在 $0$ 附近对称。小常数 $\\epsilon = 10^{-6}$ 是一个标准的计算技巧，用以防止当 $x$ 或 $\\mu$ 为零时出现未定义的结果。阈值设为 $\\tau_L = \\log_2(1.3)$，这要求观测到的倍数变化至少为 $1.3$。这是一个保守值，低于理论值 $1.5$，以考虑可能抑制观测信号的测量噪声和比对效率低下。\n\n2.  **统计显著性标准 ($z$):** 高倍数变化可能偶然发生，尤其是在低覆盖度（小 $\\mu$）区域。例如，如果 $\\mu = 2$，观测到 $x=3$ 会得到 $1.5$ 的倍数变化，但这是一个常见的随机波动。我们必须评估与零假设预期的偏差是否具有统计显著性。我们使用标准化残差 $z = \\frac{x - \\mu}{\\sqrt{\\mu}}$。该量度量了观测计数 $x$ 与零假设预期 $\\mu$ 之间的差异，以零假设下的标准差单位（$\\sqrt{\\mathrm{Var}(x)} = \\sqrt{\\mu}$）表示。对于足够大的 $\\mu$，$z$ 近似服从标准正态分布。$z_{\\min} = 3.5$ 的阈值是一个严格的要求。它对应一个非常小的p值，意味着如果零假设为真，观测到 $z \\ge 3.5$ 的事件是极不可能偶然发生的。该标准可防止由低覆盖度区域的随机噪声驱动的假阳性。\n\n**原则C：来自分割读取的结构证据**\n第三个原则是，串联重复会创建一个独特的分子结构——一个新颖的头尾连接点——这是可以直接检测到的。读取深度证据是定量的，但不是结构性的；深度的增加也可能是由分散重复或实验假象引起的。\n\n一个跨越串联重复新断点的读长无法作为一个单一、连续的序列比对到参考基因组上。相反，一个合适的比对算法会将其分成两部分：一部分比对到重复片段末端之前的序列，另一部分比对到其起始点之后的序列。这类“分割读取”(split reads) 的数量 $s$ 为特定的串联重复结构提供了直接的物理证据。\n\n3.  **断点支持度标准 ($s$):** 为了将真实的生物学事件与随机比对错误或嵌合测序假象区分开，我们要求支持该断点的独立读长达到一个最小数量。条件 $s \\ge s_{\\min} = 3$ 确保了结构证据在至少 $3$ 个独立的DNA片段上是可重复的。这为串联重复结构提供了强有力的确认，且该证据与拷贝数证据是正交的。\n\n**综合**\n最终的决策规则，要求所有三个条件（$L \\ge \\tau_L$，$z \\ge z_{\\min}$ 和 $s \\ge s_{\\min}$）同时满足，是一个稳健且有原则的设计。它结合了对预期变化幅度的检验（$L$）、对这一变化统计显著性的检验（$z$），以及对事件特定分子结构的检验（$s$）。通过要求来自这三个正交证据来源的一致意见，该规则有效地最小化了假阳性，并确保了对近期串联重复的高置信度检测。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Applies a decision rule to detect recent tandem duplications based on\n    read depth and split-read evidence.\n    \"\"\"\n    # Define the fixed parameters and thresholds for the decision rule.\n    epsilon = 1e-6\n    tau_L = np.log2(1.3)\n    z_min = 3.5\n    s_min = 3\n\n    # Define the test cases from the problem statement as tuples of (mu, x, s).\n    # mu: expected read count (diploid)\n    # x: observed read count\n    # s: split-read support count\n    test_cases = [\n        (1000, 1500, 6),  # Case A\n        (1000, 980, 0),   # Case B\n        (1000, 1500, 0),  # Case C\n        (1000, 1000, 5),  # Case D\n        (400, 560, 4),    # Case E\n        (40, 60, 3),      # Case F\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, x, s = case\n\n        # 1. Calculate depth elevation (log-ratio L)\n        # L = log2((x + epsilon) / (mu + epsilon))\n        # Condition: L >= tau_L\n        log_ratio = np.log2((x + epsilon) / (mu + epsilon))\n        cond1_depth_elevation = log_ratio >= tau_L\n\n        # 2. Calculate depth significance (standardized residual z)\n        # z = (x - mu) / sqrt(mu)\n        # Condition: z >= z_min\n        # Ensure mu is not zero to avoid division error, though problem cases are safe.\n        if mu > 0:\n            std_residual = (x - mu) / np.sqrt(mu)\n            cond2_depth_significance = std_residual >= z_min\n        else: # Handle mu=0 case, though not present in test suite\n            cond2_depth_significance = False\n\n        # 3. Check breakpoint support (split-read count s)\n        # Condition: s >= s_min\n        cond3_breakpoint_support = s >= s_min\n\n        # A window is called as a tandem duplication if and only if\n        # all three conditions hold simultaneously.\n        is_duplication = cond1_depth_elevation and cond2_depth_significance and cond3_breakpoint_support\n        results.append(is_duplication)\n\n    # Format the final output as a single line: a comma-separated list of\n    # boolean values, enclosed in square brackets.\n    # e.g., [True,False,False,False,True,False]\n    print(f\"[{','.join(map(str, results)).lower()}]\")\n\nsolve()\n```"
        }
    ]
}