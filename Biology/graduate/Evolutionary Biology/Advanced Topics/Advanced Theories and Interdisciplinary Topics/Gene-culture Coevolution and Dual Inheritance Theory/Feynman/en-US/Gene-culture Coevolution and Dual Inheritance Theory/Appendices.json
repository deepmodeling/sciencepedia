{
    "hands_on_practices": [
        {
            "introduction": "A central concept in Dual Inheritance Theory is cultural niche construction, where cultural practices modify the selective environment experienced by genes. This exercise provides a hands-on exploration of this feedback loop using a simple but elegant dynamical system. By analyzing the coupled dynamics of a genetic allele and a cultural practice, you will determine the conditions under which culture not only substitutes for a genetic adaptation but actively selects against it .",
            "id": "2716335",
            "problem": "Consider a well-mixed, large population with a single biallelic genetic locus and a single binary cultural trait, analyzed under the framework of Dual Inheritance Theory (DIT). Let the genetic alleles be $A$ (a physiological adaptation) and $a$ (wild-type), with allele $A$ at frequency $p \\in [0,1]$. Let the cultural trait be a costly protective practice $P$ versus non-practice $N$, with the frequency of $P$ denoted $x \\in [0,1]$. Assume weak selection and weak cultural forces so that mean-field, continuous-time approximations are valid.\n\nFundamental assumptions:\n- Genetic selection: In the absence of the cultural practice ($x=0$), allele $A$ has a baseline Malthusian selection advantage $s_0 > 0$ over allele $a$. The cultural practice substitutes for the genetic adaptation at rate $\\alpha > 0$ per unit cultural prevalence, so the instantaneous selection coefficient on allele $A$ when the cultural practice is at frequency $x$ is $s_A(x) = s_0 - \\alpha x$.\n- Cultural transmission: The cultural practice $P$ carries a per-generation direct cost $c \\ge 0$ and enjoys a content-bias advantage (prestige or payoff-based bias) of strength $\\beta \\ge 0$ that is independent of the genetic state and constant in time. Under weak selection and mean-field imitation, the net adoption propensity difference is $\\pi_P - \\pi_N = \\beta - c$.\n\nUse the standard weak-selection replicator approximations for two-type dynamics as the fundamental base:\n- Cultural dynamics: $\\dot{x} = x(1-x)\\,(\\pi_P - \\pi_N)$.\n- Genetic dynamics: $\\dot{p} = p(1-p)\\,s_A(x)$.\n\nExtend this model to include the cultural cost $c$ as described above and determine the parameter region in $(\\beta, c, \\alpha, s_0)$-space where the cultural practice persists while the genetic adaptation does not, in the following precise sense: the unique stable cultural equilibrium is $x^{\\star} = 1$ and, evaluated at that equilibrium, the genetic selection coefficient satisfies $s_A(x^{\\star}) < 0$ so that allele $A$ cannot persist.\n\nAnswer specification:\n- Derive the maximal admissible cultural cost $c^{\\star}$ such that $x^{\\star} = 1$ is stable, and derive the genetic non-invasion margin $\\Delta \\equiv -s_A(x^{\\star})$ as explicit expressions of $(\\beta, c, \\alpha, s_0)$.\n- Report your final answer as the row matrix $(c^{\\star}, \\Delta)$, with no units.\n- No numerical evaluation is required; provide exact symbolic expressions. Do not express your answer as inequalities or equations. No rounding is needed.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It poses a standard question in the field of theoretical evolutionary biology, specifically within the framework of gene-culture coevolution. All parameters and dynamical equations are clearly defined. Therefore, the problem is valid, and a solution will be provided.\n\nThe analysis begins with the cultural dynamics, which are governed by the equation:\n$$\n\\dot{x} = x(1-x)(\\pi_P - \\pi_N)\n$$\nwhere $x$ is the frequency of the cultural practice $P$. We are given that the net adoption propensity difference is $\\pi_P - \\pi_N = \\beta - c$, where $\\beta \\ge 0$ is the content-bias advantage and $c \\ge 0$ is the direct cost. Substituting this into the dynamic equation yields:\n$$\n\\dot{x} = x(1-x)(\\beta - c)\n$$\nThe equilibria of this system are found by setting $\\dot{x}=0$. This occurs when $x=0$, $x=1$, or if $\\beta - c = 0$.\n\nThe problem requires that the unique stable cultural equilibrium is $x^{\\star} = 1$. Let us analyze the stability of the equilibria $x=0$ and $x=1$. Let the right-hand side of the differential equation be $f(x) = x(1-x)(\\beta-c)$. The local stability of an equilibrium $x^{\\star}$ is determined by the sign of the derivative $f'(x^{\\star})$. The derivative is:\n$$\nf'(x) = \\frac{d}{dx}[x(1-x)(\\beta-c)] = (1-2x)(\\beta-c)\n$$\nFor the equilibrium $x^{\\star}=1$ to be stable, we require $f'(1) < 0$. Evaluating the derivative at $x=1$:\n$$\nf'(1) = (1 - 2(1))(\\beta-c) = -(\\beta-c)\n$$\nThe condition $f'(1) < 0$ thus implies $-(\\beta-c) < 0$, which simplifies to $\\beta - c > 0$, or $\\beta > c$.\n\nFor $x^{\\star}=1$ to be the *unique* stable equilibrium, the other boundary equilibrium, $x=0$, must be unstable. This requires $f'(0) > 0$. Evaluating the derivative at $x=0$:\n$$\nf'(0) = (1 - 2(0))(\\beta-c) = \\beta-c\n$$\nThe condition $f'(0) > 0$ also implies $\\beta - c > 0$.\nIf $\\beta - c = 0$, then $\\dot{x}=0$ for all $x \\in [0,1]$, and there is no unique stable equilibrium. Therefore, the strict inequality $\\beta > c$ is the necessary and sufficient condition for $x^{\\star}=1$ to be the unique stable cultural equilibrium.\n\nThe problem asks for the maximal admissible cultural cost, denoted $c^{\\star}$, for which $x^{\\star} = 1$ is stable. The condition for stability is $c < \\beta$. The set of admissible costs is $c \\in [0, \\beta)$. The supremum or the boundary of this set of admissible costs is $\\beta$. Thus, the maximal admissible cost is:\n$$\nc^{\\star} = \\beta\n$$\nFor any cost $c \\ge c^{\\star}$, the cultural practice $P$ no longer spreads to fixation.\n\nNext, we analyze the genetic dynamics evaluated at the cultural equilibrium $x^{\\star}=1$. The dynamics for the frequency $p$ of allele $A$ are given by:\n$$\n\\dot{p} = p(1-p)s_A(x)\n$$\nwhere the selection coefficient is $s_A(x) = s_0 - \\alpha x$. At the cultural equilibrium $x^{\\star}=1$, the selection coefficient becomes:\n$$\ns_A(1) = s_0 - \\alpha (1) = s_0 - \\alpha\n$$\nThe problem requires that the genetic adaptation $A$ does not persist. This means that allele $A$ is selected against when it is rare, which requires its selection coefficient to be negative at the cultural equilibrium. The condition for this is:\n$$\ns_A(1) < 0 \\implies s_0 - \\alpha < 0\n$$\nThis condition ensures that the equilibrium $p=0$ (absence of allele $A$) is stable.\n\nThe problem defines the genetic non-invasion margin as $\\Delta \\equiv -s_A(x^{\\star})$. We can now compute this quantity using our established results:\n$$\n\\Delta = -s_A(1) = -(s_0 - \\alpha) = \\alpha - s_0\n$$\nThe condition for the non-persistence of allele $A$, $s_A(1) < 0$, is equivalent to the condition $\\Delta > 0$, confirming that $\\Delta$ represents the margin by which the genetic adaptation is disfavored.\n\nIn summary, the maximal admissible cost for the cultural trait is $c^{\\star} = \\beta$, and the genetic non-invasion margin is $\\Delta = \\alpha - s_0$. The problem asks for these two quantities as a row matrix $(c^{\\star}, \\Delta)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\beta & \\alpha - s_0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "To move from theoretical possibilities to empirical realities, we need tools to quantify the contributions of genes and culture to evolutionary change. The Price equation is an exceptionally powerful and general framework for this purpose, allowing us to partition phenotypic change into its constituent parts. This problem challenges you to apply the Price equation's logic to a hypothetical dataset, calculating the precise contribution of cultural change to the overall evolution of a trait .",
            "id": "2716419",
            "problem": "A research team studying Dual Inheritance Theory (DIT) in a large, age-structured human population has recorded, over one discrete generation, individual-level data on reproductive output and a scalar phenotype that is additively composed of genetic and cultural components. Let the phenotype be $z_{i} = g_{i} + c_{i}$ for individual $i$, where $g_{i}$ is the additive genetic value and $c_{i}$ is the culturally acquired value. Let $w_{i}$ denote the absolute fitness (expected number of offspring) of individual $i$. The team provides the following empirically estimated, generation-aggregated quantities:\n- Mean fitness $\\bar{w} = $ $1.25$ offspring per parent.\n- Genetic selection covariance $\\mathrm{Cov}(w,g) = $ $0.08$ (trait-unit$\\cdot$offspring).\n- Cultural selection covariance $\\mathrm{Cov}(w,c) = $ $0.15$ (trait-unit$\\cdot$offspring).\n- Genetic transmission term $\\mathbb{E}(w\\,\\Delta g) = $ $-0.0125$ (trait-unit$\\cdot$offspring).\n- Cultural transmission term $\\mathbb{E}(w\\,\\Delta c) = $ $-0.0250$ (trait-unit$\\cdot$offspring).\n\nStarting from the standard Price equation for a scalar phenotype and the additive decomposition $z_{i} = g_{i} + c_{i}$, derive the additive decomposition of the expected one-generation change in the mean phenotype, $\\Delta \\bar{z}$, into its genetic selection, cultural selection, genetic transmission, and cultural transmission components. Using your decomposition, compute the contribution of culture to phenotypic change over one generation for this dataset.\n\nExpress your final numerical answer in trait units per generation and round to four significant figures.",
            "solution": "The problem requires the derivation of the additive decomposition of phenotypic change using the Price equation and a subsequent calculation of the cultural contribution to this change. The problem is scientifically grounded, well-posed, and provides all necessary information for a unique solution.\n\nThe starting point is the general form of the Price equation for the change in a mean phenotype $\\bar{z}$ over one generation:\n$$ \\bar{w} \\Delta \\bar{z} = \\mathrm{Cov}(w, z) + \\mathbb{E}(w \\Delta z) $$\nHere, $\\bar{w}$ is the mean fitness of the population, $w$ is individual fitness, $z$ is the individual phenotypic value, $\\mathrm{Cov}(w, z)$ is the covariance between fitness and phenotype (the selection term), and $\\mathbb{E}(w \\Delta z)$ is the fitness-weighted average change in phenotype between parent and offspring (the transmission term).\n\nThe phenotype $z_i$ for an individual $i$ is given as an additive composition of a genetic value $g_i$ and a culturally acquired value $c_i$:\n$$ z_i = g_i + c_i $$\nWe substitute this decomposition into the Price equation.\n\nFirst, consider the covariance term, $\\mathrm{Cov}(w, z)$. Using the property of bilinearity of covariance:\n$$ \\mathrm{Cov}(w, z) = \\mathrm{Cov}(w, g + c) = \\mathrm{Cov}(w, g) + \\mathrm{Cov}(w, c) $$\nThe term $\\mathrm{Cov}(w, g)$ represents the effect of selection acting on the genetic component of the phenotype, and $\\mathrm{Cov}(w, c)$ represents the effect of selection acting on the cultural component.\n\nNext, consider the transmission term, $\\mathbb{E}(w \\Delta z)$. The change in phenotype $\\Delta z_i$ is the average difference between the phenotype of offspring of parent $i$ and the phenotype of parent $i$. Given $z = g+c$, this change can be decomposed as $\\Delta z = \\Delta g + \\Delta c$. We substitute this into the transmission term and use the linearity of the expectation operator:\n$$ \\mathbb{E}(w \\Delta z) = \\mathbb{E}(w(\\Delta g + \\Delta c)) = \\mathbb{E}(w \\Delta g) + \\mathbb{E}(w \\Delta c) $$\nThe term $\\mathbb{E}(w \\Delta g)$ represents the effect of non-Mendelian transmission and mutation on the genetic component, while $\\mathbb{E}(w \\Delta c)$ represents the effect of biased cultural transmission (e.g., imperfect learning, guided variation).\n\nCombining these expanded terms, the full Price equation for the composite phenotype becomes:\n$$ \\bar{w} \\Delta \\bar{z} = \\mathrm{Cov}(w, g) + \\mathrm{Cov}(w, c) + \\mathbb{E}(w \\Delta g) + \\mathbb{E}(w \\Delta c) $$\nTo find the total change in the mean phenotype, $\\Delta \\bar{z}$, we divide the entire equation by the mean fitness, $\\bar{w}$:\n$$ \\Delta \\bar{z} = \\frac{\\mathrm{Cov}(w, g)}{\\bar{w}} + \\frac{\\mathrm{Cov}(w, c)}{\\bar{w}} + \\frac{\\mathbb{E}(w \\Delta g)}{\\bar{w}} + \\frac{\\mathbb{E}(w \\Delta c)}{\\bar{w}} $$\nThis is the required additive decomposition of the total phenotypic change into four components: genetic selection, cultural selection, genetic transmission, and cultural transmission.\n\nThe total change in the mean phenotype $\\Delta \\bar{z}$ is the sum of the change in the mean genetic value, $\\Delta \\bar{g}$, and the change in the mean cultural value, $\\Delta \\bar{c}$.\n$$ \\Delta \\bar{z} = \\Delta \\bar{g} + \\Delta \\bar{c} $$\nBy grouping the genetic and cultural terms from our decomposition, we can identify expressions for $\\Delta \\bar{g}$ and $\\Delta \\bar{c}$:\n$$ \\Delta \\bar{g} = \\frac{\\mathrm{Cov}(w, g) + \\mathbb{E}(w \\Delta g)}{\\bar{w}} $$\n$$ \\Delta \\bar{c} = \\frac{\\mathrm{Cov}(w, c) + \\mathbb{E}(w \\Delta c)}{\\bar{w}} $$\nThe problem asks for the \"contribution of culture to phenotypic change\". This corresponds to the total change in the mean cultural value, $\\Delta \\bar{c}$.\n\nWe are given the following empirical values:\n- Mean fitness $\\bar{w} = 1.25$\n- Cultural selection covariance $\\mathrm{Cov}(w,c) = 0.15$\n- Cultural transmission term $\\mathbb{E}(w \\Delta c) = -0.0250$\n\nWe use these values to compute $\\Delta \\bar{c}$:\n$$ \\Delta \\bar{c} = \\frac{\\mathrm{Cov}(w, c) + \\mathbb{E}(w \\Delta c)}{\\bar{w}} $$\nSubstituting the numerical values:\n$$ \\Delta \\bar{c} = \\frac{0.15 + (-0.0250)}{1.25} $$\n$$ \\Delta \\bar{c} = \\frac{0.15 - 0.025}{1.25} $$\n$$ \\Delta \\bar{c} = \\frac{0.125}{1.25} $$\n$$ \\Delta \\bar{c} = 0.1 $$\nThe question requires the answer to be rounded to four significant figures. Therefore, the value $0.1$ must be written as $0.1000$. The units are trait units per generation, as $\\Delta \\bar{c}$ has the same units as the phenotype $c$.",
            "answer": "$$\\boxed{0.1000}$$"
        },
        {
            "introduction": "The true power of gene-culture coevolutionary theory is revealed when we build and explore models of specific historical processes. This final practice is a capstone exercise in computational modeling, tasking you with implementing a simulation of the canonical example of lactase persistence and dairying. By coding the coupled dynamics of genetic selection and payoff-biased cultural transmission, you will gain first-hand experience in exploring how different parameters, grounded in archaeological evidence, can generate the coevolutionary patterns seen in human populations .",
            "id": "2716366",
            "problem": "You are to implement a complete, runnable program that simulates a Dual Inheritance Theory (DIT) model for the coevolution of a genetic trait (lactase persistence) and a cultural trait (dairying). Your design must begin from a valid base in evolutionary biology and derive the coupled gene-culture dynamics in discrete time. The biological population is assumed panmictic, with discrete non-overlapping generations. The genetic trait is encoded by a single locus with two alleles, and the cultural trait is a socially transmitted practice whose adoption dynamics depend on payoffs.\n\nStart from these foundational bases only:\n- Hardy–Weinberg proportions given random mating and a single locus with two alleles in a large population.\n- Deterministic viability selection in discrete time.\n- Replicator-type social learning dynamics with frequency-dependent adoption due to payoff differences.\n- Archaeologically plausible timelines for the emergence and spread of dairying in the Holocene, with a generation time of $25$ years. Use a total simulation horizon of $T=400$ generations (corresponding to $10{,}000$ years).\n\nConstruct the model with the following components and definitions.\n- Genetic state: let $p_t \\in [0,1]$ denote the frequency of the lactase-persistence allele in generation $t$, with $t \\in \\{0,1,\\dots,T\\}$. Assume dominance of lactase persistence for fitness effects under dairying in that generation.\n- Cultural state: let $q_t \\in [0,1]$ denote the frequency of dairying (adopters) in generation $t$.\n- Fitness environment: the fitness effect of lactase persistence is conditional on dairying in the same generation; let the selection coefficient per generation be $s \\ge 0$, such that adopters of dairying in generation $t$ impose an advantage on carriers of the lactase-persistence allele proportional to $q_t$.\n- Cultural environment: adoption of dairying proceeds by payoff-biased social learning with rate $r > 0$, and the payoff difference favoring adoption in generation $t$ is $[(b_0 + b_1\\,p_t) - c]$, where $b_0 \\ge 0$ is a baseline benefit of dairying independent of genotype, $b_1 \\ge 0$ captures gene-culture complementarity (extra benefit increasing in the lactase-persistence allele frequency), and $c \\ge 0$ is the cost of dairying.\n- Onset timing: define the dairying onset as occurring $\\Omega$ generations before the present. With the total horizon $T$, the onset index in forward simulation is $g_{\\mathrm{on}} = T - \\Omega$. Before $t = g_{\\mathrm{on}}$, dairying is unavailable and $q_t$ is constrained to $0$. At $t = g_{\\mathrm{on}}$, dairying is introduced at a small seed frequency $q_\\varepsilon \\in (0,1)$.\n\nYour program must implement the following discrete-time process exactly:\n- Initialization at $t=0$: set $p_0$ to the case-specific initial allele frequency, and $q_0 = 0$.\n- For each generation $t \\in \\{0,1,\\dots,T-1\\}$:\n  - If $t < g_{\\mathrm{on}}$, set $q_t = 0$.\n  - If $t = g_{\\mathrm{on}}$, replace $q_t$ by $\\max(q_t, q_\\varepsilon)$ to seed dairying.\n  - Cultural update to obtain $q_{t+1}$ from $q_t$ and $p_t$ by a payoff-biased replicator step:\n    $$q_{t+1} = \\mathrm{clip}\\Big(q_t + r\\,q_t\\,(1-q_t)\\,\\big[(b_0 + b_1\\,p_t) - c\\big]\\Big)$$\n    where $\\mathrm{clip}(x)$ projects $x$ to $[0,1]$ by truncation at the interval boundaries.\n  - Genetic update to obtain $p_{t+1}$ from $p_t$ and $q_t$ by deterministic viability selection under Hardy–Weinberg and dominance of lactase persistence in that generation’s environment. Use the standard discrete-time selection update implied by these assumptions.\n- Record the first generation index (an integer) at which $p_t$ reaches or exceeds a specified threshold $p^\\star$, and similarly the first index at which $q_t$ reaches or exceeds $q^\\star$. If the threshold is never reached up to and including $t = T$, record $-1$. Thresholds are to be evaluated on the sequence $\\{p_t\\}_{t=0}^{T}$ and $\\{q_t\\}_{t=0}^{T}$ as generated by the above rules.\n\nAll times must be expressed in generations (integers). All frequencies must be expressed as decimals in $[0,1]$.\n\nImplement the simulation for the following test suite of parameter sets, chosen to reflect archaeologically plausible onsets and to span qualitatively distinct dynamical regimes. For all cases, use $T = 400$, $p^\\star = 0.6$, $q^\\star = 0.8$, and generation length $25$ years (context only; do not convert units).\n\n- Case A (early onset, strong coupling):\n  - Initial allele frequency $p_0 = 0.01$.\n  - Selection coefficient $s = 0.02$.\n  - Social learning rate $r = 0.15$.\n  - Baseline cultural benefit $b_0 = 0.02$.\n  - Gene-culture complementarity $b_1 = 0.10$.\n  - Cultural cost $c = 0.01$.\n  - Dairying onset $\\Omega = 360$ generations before present (approximately $9{,}000$ years), hence $g_{\\mathrm{on}} = 40$.\n  - Seed frequency $q_\\varepsilon = 0.02$.\n\n- Case B (later onset, moderate coupling):\n  - $p_0 = 0.01$.\n  - $s = 0.015$.\n  - $r = 0.10$.\n  - $b_0 = 0.02$.\n  - $b_1 = 0.08$.\n  - $c = 0.012$.\n  - $\\Omega = 240$ (approximately $6{,}000$ years), so $g_{\\mathrm{on}} = 160$.\n  - $q_\\varepsilon = 0.02$.\n\n- Case C (no coupling, no genetic selection; culture rises independently):\n  - $p_0 = 0.05$.\n  - $s = 0.00$.\n  - $r = 0.12$.\n  - $b_0 = 0.02$.\n  - $b_1 = 0.00$.\n  - $c = 0.005$.\n  - $\\Omega = 360$, so $g_{\\mathrm{on}} = 40$.\n  - $q_\\varepsilon = 0.01$.\n\n- Case D (bistability-prone, difficult takeoff):\n  - $p_0 = 0.01$.\n  - $s = 0.02$.\n  - $r = 0.10$.\n  - $b_0 = 0.00$.\n  - $b_1 = 0.05$.\n  - $c = 0.02$.\n  - $\\Omega = 240$, so $g_{\\mathrm{on}} = 160$.\n  - $q_\\varepsilon = 0.02$.\n\nYour program must compute, for each case, the following four outputs:\n- The final allele frequency $p_T$ (rounded to six decimal places).\n- The final cultural frequency $q_T$ (rounded to six decimal places).\n- The earliest generation index at which $p_t \\ge p^\\star$ (an integer, or $-1$ if never).\n- The earliest generation index at which $q_t \\ge q^\\star$ (an integer, or $-1$ if never).\n\nFinal output format requirement:\n- Your program should produce a single line of output containing all case results concatenated in order A, B, C, D, as a comma-separated list enclosed in square brackets. The order per case must be $[p_T, q_T, t_{p^\\star}, t_{q^\\star}]$. For example, a valid shape of the final line is\n  $$[\\text{A}_{p_T},\\text{A}_{q_T},\\text{A}_{t_{p^\\star}},\\text{A}_{t_{q^\\star}},\\text{B}_{p_T},\\dots,\\text{D}_{t_{q^\\star}}]$$\nAll frequencies must be decimals in $[0,1]$ rounded to six decimal places, and all times must be integers in generations.",
            "solution": "The problem presented is a request to construct and implement a simulation model of gene-culture coevolution, based on the principles of Dual Inheritance Theory (DIT). The specific case is the coevolution of lactase persistence (a genetic trait) and dairying (a cultural trait).\n\n### Problem Validation\n\nFirst, I must validate the problem statement.\n\n**Step 1: Extract Givens**\n\n*   **Model Framework**: Dual Inheritance Theory (DIT) in discrete time for $T=400$ generations.\n*   **Genetic System**: A single locus with two alleles. Frequency of the lactase persistence allele is $p_t \\in [0,1]$. Dominance of the lactase persistence allele is assumed for fitness effects.\n*   **Cultural System**: A single cultural trait (dairying). Frequency of adopters is $q_t \\in [0,1]$.\n*   **Gene-Culture Interaction**:\n    *   **Genetic update**: Selection on the lactase persistence allele is conditional on the frequency of dairying, $q_t$. The selection coefficient is $s \\ge 0$. The update follows deterministic viability selection under Hardy-Weinberg conditions.\n    *   **Cultural update**: Adoption of dairying follows payoff-biased social learning (replicator dynamics) with rate $r > 0$. The payoff difference is $\\Delta_{\\pi} = (b_0 + b_1 p_t) - c$.\n*   **Simulation Timeline**:\n    *   Total horizon: $T = 400$ generations.\n    *   Onset of dairying: $\\Omega$ generations before present, at simulation time $g_{\\mathrm{on}} = T - \\Omega$.\n    *   For $t < g_{\\mathrm{on}}$, $q_t=0$.\n    *   At $t = g_{\\mathrm{on}}$, dairying is seeded at frequency $q_\\varepsilon > 0$.\n*   **Update Equations**:\n    *   Cultural: $q_{t+1} = \\mathrm{clip}\\Big(q_t + r\\,q_t\\,(1-q_t)\\,\\big[(b_0 + b_1\\,p_t) - c\\big]\\Big)$, where $\\mathrm{clip}(x)$ projects $x$ onto $[0,1]$.\n    *   Genetic: Standard discrete-time selection update implied by dominance and fitness conditional on $q_t$.\n*   **Output Requirements**:\n    *   Final frequencies $p_T, q_T$.\n    *   First generation indices $t_{p^\\star}, t_{q^\\star}$ where frequencies reach thresholds $p^\\star=0.6$ and $q^\\star=0.8$.\n*   **Parameters for Test Cases**: Four distinct parameter sets (A, B, C, D) are provided with specific values for $p_0, s, r, b_0, b_1, c, \\Omega, q_\\varepsilon$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria.\n\n*   **Scientific Grounding**: The model is based on established, standard frameworks in evolutionary biology: Dual Inheritance Theory, Hardy-Weinberg equilibrium, deterministic selection, and replicator dynamics. The application to lactase persistence and dairying is a canonical example in this field. The specified parameters and timescales are plausible. The problem is scientifically sound.\n*   **Well-Posedness**: The problem describes a system of coupled, first-order, nonlinear difference equations. The initial conditions and update rules are specified. The genetic update rule, while not given as a final formula, is unambiguously specified by the principles of \"deterministic viability selection under Hardy–Weinberg and dominance.\" This standard derivation, detailed below, leads to a unique formula. The system is well-defined, and a unique solution exists for the given initial state and parameters.\n*   **Objectivity**: The problem is stated in precise, mathematical terms, free of ambiguity, subjectivity, or non-scientific claims.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is a well-posed, scientifically grounded problem in computational biology. I will now proceed to construct the solution.\n\n### Model Derivation and Algorithmic Design\n\nBefore implementing the simulation, we must finalize the mathematical form of the update equations as specified.\n\n**1. Cultural Update Dynamics**\nThe update rule for the frequency of dairying, $q_t$, is provided directly:\n$$q_{t+1} = \\mathrm{clip}\\left(q_t + r\\,q_t\\,(1-q_t)\\,\\left[\\left(b_0 + b_1\\,p_t\\right) - c\\right]\\right)$$\nHere, $q_t(1-q_t)$ represents the variance of the cultural trait in the population, and the term in brackets is the payoff difference between adopting dairying and not adopting. The parameter $r$ is the social learning rate, scaling the speed of cultural change. The $\\mathrm{clip}$ function ensures $q_{t+1}$ remains within the interval $[0,1]$.\n\n**2. Genetic Update Dynamics**\nThe update rule for the allele frequency, $p_t$, must be derived from the stated principles.\nLet $A$ be the lactase persistence allele (frequency $p_t$) and $a$ be the non-persistence allele (frequency $1-p_t$). Under random mating (panmixia), the genotype frequencies at conception are given by Hardy-Weinberg proportions:\n*   $f(AA) = p_t^2$\n*   $f(Aa) = 2p_t(1-p_t)$\n*   $f(aa) = (1-p_t)^2$\n\nDominance of allele $A$ means genotypes $AA$ and $Aa$ share the same phenotype (lactase persistence). The problem states that a selective advantage is conferred upon these individuals, proportional to the frequency of dairying, $q_t$. We define the relative fitness (viability) of each genotype as follows:\n*   $w_{AA} = 1 + s\\,q_t$\n*   $w_{Aa} = 1 + s\\,q_t$\n*   $w_{aa} = 1$\nThe parameter $s$ is the maximum selection coefficient, realized when $q_t=1$.\n\nThe average fitness of the population in generation $t$, $\\bar{w}_t$, is the weighted average of the genotype fitnesses:\n$$\\bar{w}_t = f(AA)w_{AA} + f(Aa)w_{Aa} + f(aa)w_{aa}$$\n$$\\bar{w}_t = p_t^2(1+s\\,q_t) + 2p_t(1-p_t)(1+s\\,q_t) + (1-p_t)^2(1)$$\nFactoring out the term $(1+s\\,q_t)$:\n$$\\bar{w}_t = (p_t^2 + 2p_t(1-p_t))(1+s\\,q_t) + (1-p_t)^2$$\nThe frequency of lactase-persistent genotypes is $p_t^2 + 2p_t(1-p_t) = 2p_t - p_t^2$. Substituting this gives:\n$$\\bar{w}_t = (2p_t-p_t^2)(1+s\\,q_t) + (1-p_t)^2 = (2p_t-p_t^2) + s\\,q_t(2p_t-p_t^2) + 1 - 2p_t + p_t^2$$\n$$\\bar{w}_t = 1 + s\\,q_t(2p_t-p_t^2)$$\n\nThe frequency of allele $A$ in the next generation, $p_{t+1}$, is the frequency of allele $A$ in the gene pool after selection. This is found by weighting the allele's contribution from each genotype by its post-selection frequency:\n$$p_{t+1} = \\frac{p_t^2 w_{AA} + p_t(1-p_t)w_{Aa}}{\\bar{w}_t}$$\n$$p_{t+1} = \\frac{p_t^2(1+s\\,q_t) + p_t(1-p_t)(1+s\\,q_t)}{\\bar{w}_t} = \\frac{p_t(p_t + 1-p_t)(1+s\\,q_t)}{\\bar{w}_t}$$\n$$p_{t+1} = \\frac{p_t(1+s\\,q_t)}{\\bar{w}_t}$$\nSubstituting the expression for $\\bar{w}_t$, we obtain the final genetic update equation:\n$$p_{t+1} = \\frac{p_t(1+s\\,q_t)}{1 + s\\,q_t(2p_t - p_t^2)}$$\n\n**3. Simulation Algorithm**\n\nThe simulation will proceed for $T=400$ generations for each test case.\n1.  Initialize two arrays, `p` and `q`, of length $T+1$ to store the state histories.\n2.  Set the initial condition: `p[0] = p_0` and `q[0] = 0`.\n3.  The dynamics are quiescent until the onset of dairying. For all generations $t$ from $0$ to $g_{\\mathrm{on}}-1$, the state remains $(p_0, 0)$. We can computationally skip this period and set `p[t] = p_0` and `q[t] = 0$ for $t \\in \\{1, \\dots, g_{\\mathrm{on}}-1\\}$.\n4.  At generation $t=g_{\\mathrm{on}}$, the cultural trait is introduced: set `q[g_on] = q_\\varepsilon`. The genetic state is still `p[g_on] = p_0`.\n5.  Iterate for $t$ from $g_{\\mathrm{on}}$ to $T-1$:\n    a. Retrieve the current state $(p_t, q_t)$ from the history arrays: `p_t = p[t]`, `q_t = q[t]`.\n    b. Calculate the next state $(p_{t+1}, q_{t+1})$ using the derived update equations.\n    c. Store the new state in the history arrays: `p[t+1] = p_{t+1}`, `q[t+1] = q_{t+1}`.\n6.  After completing the loop, the full histories $\\{p_t\\}_{t=0}^{T}$ and $\\{q_t\\}_{t=0}^{T}$ are generated.\n7.  The final values $p_T$ and $q_T$ are read from `p[T]` and `q[T]`.\n8.  The threshold crossing times, $t_{p^\\star}$ and $t_{q^\\star}$, are found by searching the completed `p` and `q` arrays for the first index where the respective threshold ($p^\\star=0.6$, $q^\\star=0.8$) is met or exceeded. If a threshold is never reached, the value is recorded as $-1$.\n\nThis procedure is deterministic and will be implemented for each of the four specified test cases.",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(p0, s, r, b0, b1, c, g_on, q_epsilon, T, p_star, q_star):\n    \"\"\"\n    Runs a single simulation of the gene-culture coevolution model.\n\n    Args:\n        p0 (float): Initial frequency of lactase persistence allele.\n        s (float): Selection coefficient.\n        r (float): Social learning rate.\n        b0 (float): Baseline cultural benefit.\n        b1 (float): Gene-culture complementarity benefit.\n        c (float): Cultural cost.\n        g_on (int): Generation index for the onset of dairying.\n        q_epsilon (float): Seed frequency for dairying.\n        T (int): Total number of generations.\n        p_star (float): Threshold for allele frequency.\n        q_star (float): Threshold for cultural frequency.\n\n    Returns:\n        tuple: (p_T, q_T, t_p_star, t_q_star)\n    \"\"\"\n    # Initialize history arrays for genetic and cultural frequencies\n    p = np.zeros(T + 1)\n    q = np.zeros(T + 1)\n\n    # Set initial conditions at t=0\n    p[0] = p0\n    q[0] = 0.0\n\n    # Main simulation loop\n    # The state (p, q) is updated from generation t to t+1.\n    for t in range(T):\n        p_t = p[t]\n        q_t = q[t]\n\n        # Apply special rule for seeding culture at onset generation g_on\n        # According to the problem, \"If t = g_on, replace qt by max(qt, q_epsilon)\".\n        # Since q[g_on] would be 0 from the steps before, this is equivalent to setting it.\n        if t == g_on:\n            q_t = max(q_t, q_epsilon)\n        \n        # Another rule \"If t < g_on, set qt = 0\". With q[0]=0 and the update\n        # equation for q having a q_t factor, q will remain 0 until seeded.\n        # This rule is naturally satisfied.\n\n        # Cultural update to get q_{t+1}\n        payoff_diff = (b0 + b1 * p_t) - c\n        delta_q = r * q_t * (1 - q_t) * payoff_diff\n        q_t_plus_1 = q_t + delta_q\n        q[t+1] = np.clip(q_t_plus_1, 0.0, 1.0)\n\n        # Genetic update to get p_{t+1}\n        # Only perform selection if s > 0 and q_t > 0 to avoid division by zero/no-op\n        if s > 0 and q_t > 0:\n            mean_fitness = 1.0 + s * q_t * (2 * p_t - p_t**2)\n            p[t+1] = (p_t * (1.0 + s * q_t)) / mean_fitness\n        else:\n            p[t+1] = p_t\n            \n        # The problem statement says \"evaluate thresholds on the sequence {qt} as generated\".\n        # This implies we should use the post-seeding q_t value for the threshold check at t=g_on.\n        # So we update our history array `q` within the loop to reflect the seeded value.\n        if t == g_on:\n            q[t] = q_t\n\n    # After the loop, we have the complete trajectories p[0...T] and q[0...T]\n    \n    # Extract final frequencies\n    p_T = p[T]\n    q_T = q[T]\n\n    # Find first generation index where thresholds are met or exceeded\n    p_reach_indices = np.where(p >= p_star)[0]\n    t_p_star = int(p_reach_indices[0]) if len(p_reach_indices) > 0 else -1\n\n    q_reach_indices = np.where(q >= q_star)[0]\n    t_q_star = int(q_reach_indices[0]) if len(q_reach_indices) > 0 else -1\n\n    return p_T, q_T, t_p_star, t_q_star\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Global parameters\n    T = 400\n    p_star = 0.6\n    q_star = 0.8\n\n    # Test suite of parameter sets\n    test_cases = {\n        'A': {\n            'p0': 0.01, 's': 0.02, 'r': 0.15, 'b0': 0.02, 'b1': 0.10, 'c': 0.01,\n            'omega': 360, 'q_epsilon': 0.02\n        },\n        'B': {\n            'p0': 0.01, 's': 0.015, 'r': 0.10, 'b0': 0.02, 'b1': 0.08, 'c': 0.012,\n            'omega': 240, 'q_epsilon': 0.02\n        },\n        'C': {\n            'p0': 0.05, 's': 0.00, 'r': 0.12, 'b0': 0.02, 'b1': 0.00, 'c': 0.005,\n            'omega': 360, 'q_epsilon': 0.01\n        },\n        'D': {\n            'p0': 0.01, 's': 0.02, 'r': 0.10, 'b0': 0.00, 'b1': 0.05, 'c': 0.02,\n            'omega': 240, 'q_epsilon': 0.02\n        }\n    }\n\n    results = []\n    case_order = ['A', 'B', 'C', 'D']\n\n    for case_id in case_order:\n        params = test_cases[case_id]\n        g_on = T - params['omega']\n        \n        p_T, q_T, t_p_star, t_q_star = run_simulation(\n            params['p0'], params['s'], params['r'], params['b0'],\n            params['b1'], params['c'], g_on, params['q_epsilon'],\n            T, p_star, q_star\n        )\n        \n        # Format results as specified\n        results.append(f\"{p_T:.6f}\")\n        results.append(f\"{q_T:.6f}\")\n        results.append(str(t_p_star))\n        results.append(str(t_q_star))\n\n    # Print the final output in the required single-line format\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}