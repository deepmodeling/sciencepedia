{
    "hands_on_practices": [
        {
            "introduction": "从序列比对的原始差异出发，我们如何量化进化速率？本练习将指导你使用分子进化领域最基础的Nei-Gojobori (NG86) 方法，结合Jukes-Cantor (JC) 模型，来估算非同义替换率($d_N$)、同义替换率($d_S$)及其比值$\\omega$。通过进一步构建置信区间，你将学会评估这些估算值统计不确定性的重要技能 。",
            "id": "2757639",
            "problem": "两个直系同源编码序列的成对比对显示出低度分化。您将使用 Jukes–Cantor (JC) 模型下的 Nei–Gojobori (NG86) 方法，估计每个非同义位点的非同义替换率 ($dN$)、每个同义位点的同义替换率 ($dS$) 以及它们的比值 $\\omega \\equiv dN/dS$。然后，通过将差异计数近似为泊松分布，为 $\\omega$ 构建一个保守的置信区间。\n\n假设存在以下科学上合理的设置和数据。\n\n- 编码区长度为 $L = 100$ 个密码子（$300$ 个核苷酸），无空位，无内部终止密码子，且适用标准遗传密码。在标准遗传密码下，通过 NG86 方法逐个密码子计数，得出该基因中共有 $S = 78.0$ 个同义位点和 $N = 222.0$ 个非同义位点。\n- 在整个比对中，由 NG86 方法分类的观测到的单核苷酸差异总数为 $X_{S} = 3$ 个同义差异和 $X_{N} = 2$ 个非同义差异。碱基组成近似相等，因此 JC 模型适合作为对多次替换的一阶校正。\n- 在带有 JC 的 NG86 方法下，令 $\\hat{p}_{S} \\equiv X_{S}/S$ 和 $\\hat{p}_{N} \\equiv X_{N}/N$ 分别为每个位点观测到的同义和非同义差异的比例。JC 校正通过 Jukes–Cantor 模型下的一个单调变换，将观测到的差异比例 $p$ 与进化距离 $d$（每个位点的替换数）联系起来。\n\n任务：\n\n1. 从 $d$ 是每个位点的期望替换数这一核心定义出发，并使用 Jukes–Cantor 模型作为一个经过充分检验的替换模型，从 $\\hat{p}_{S}$ 和 $\\hat{p}_{N}$ 推导出 NG86 估计量 $\\hat{d}_{S}$ 和 $\\hat{d}_{N}$，并为给定数据计算 $\\hat{d}_{S}$、$\\hat{d}_{N}$ 和 $\\hat{\\omega} \\equiv \\hat{d}_{N}/\\hat{d}_{S}$ 的数值。\n2. 使用一个保守近似，其中 $X_{S}$ 和 $X_{N}$ 分别被视为均值为 $\\lambda_{S}$ 和 $\\lambda_{N}$ 的独立泊松计数，为 $\\lambda_{S}$ 和 $\\lambda_{N}$ 构建精确的双侧 Garwood $95\\%$ 置信区间。通过分别除以 $S$ 和 $N$，将这些区间映射为 $p_{S}$ 和 $p_{N}$ 的区间，然后将每个端点变换到经过 JC 校正的 $d$ 尺度，以获得保守的 $95\\%$ 区间 $[d_{S}^{L}, d_{S}^{U}]$ 和 $[d_{N}^{L}, d_{N}^{U}]$。\n3. 根据变换的单调性，将 $\\omega$ 的保守 $95\\%$ 置信区间构造为 $[\\omega^{L}, \\omega^{U}] = [d_{N}^{L}/d_{S}^{U},\\ d_{N}^{U}/d_{S}^{L}]$。\n\n提供上端点 $\\omega^{U}$ 作为您的最终报告值。将您的最终答案四舍五入到三位有效数字。无需单位。",
            "solution": "在尝试做出任何解答之前，首先将对所提出的问题进行严格的验证程序。\n\n从问题陈述中逐字提取的给定条件如下：\n- 编码区长度为 $L = 100$ 个密码子（$300$ 个核苷酸）。\n- 无空位，无内部终止密码子。\n- 适用标准遗传密码。\n- 同义位点总数（由 NG86 计数）：$S = 78.0$。\n- 非同义位点总数（由 NG86 计数）：$N = 222.0$。\n- 观测到的同义差异总数：$X_{S} = 3$。\n- 观测到的非同义差异总数：$X_{N} = 2$。\n- 将使用 Jukes-Cantor (JC) 模型。\n- 观测到的同义差异比例：$\\hat{p}_{S} \\equiv X_{S}/S$。\n- 观测到的非同义差异比例：$\\hat{p}_{N} \\equiv X_{N}/N$。\n- 进化距离 $d$ 通过 Jukes–Cantor 模型下的一个单调变换与观测到的差异比例 $p$ 相关联。\n- 任务 1：使用 JC 模型从 $\\hat{p}_{S}$ 和 $\\hat{p}_{N}$ 推导出 NG86 估计量 $\\hat{d}_{S}$ 和 $\\hat{d}_{N}$，并计算 $\\hat{d}_{S}$、$\\hat{d}_{N}$ 和 $\\hat{\\omega} \\equiv \\hat{d}_{N}/\\hat{d}_{S}$ 的数值。\n- 任务 2：通过将 $X_S$ 和 $X_N$ 视为泊松计数并使用 Garwood 区间来计算泊松均值，为 $d_S$ 和 $d_N$ 构建保守的 $95\\%$ 置信区间。\n- 任务 3：将 $\\omega$ 的保守 $95\\%$ 置信区间构造为 $[\\omega^{L}, \\omega^{U}] = [d_{N}^{L}/d_{S}^{U},\\ d_{N}^{U}/d_{S}^{L}]$，并提供 $\\omega^{U}$ 作为最终答案。\n\n该问题已根据验证标准进行审查。它具有科学依据，植根于标准的分子进化理论，特别是 Nei-Gojobori 方法和 Jukes-Cantor 替换模型。问题是良定的，提供了所有必要的数据和清晰的、导向唯一解的逻辑任务序列。语言精确且客观。所提供的数据对于一个低分化度的短基因比对是合理的。该问题不违反任何基本原则，不是不完整或矛盾的，也并非无足轻重。因此，该问题被认为是有效的，并将提供完整的解答。\n\n**任务 1：替换率及其比值的点估计**\n\n首先，我们推导 Jukes-Cantor (JC69) 校正。JC69 模型假设核苷酸频率相等（$1/4$），且任意两种不同核苷酸之间的替换率 $\\alpha$ 也相等。一个核苷酸 $i$ 在时间 $t$ 内变为核苷酸 $j$ 的概率 $P_{ij}(t)$ 受主方程支配。一个位点未发生变化的概率 $P_{ii}(t)$ 遵循以下微分方程：\n$$ \\frac{dP_{ii}(t)}{dt} = -3\\alpha P_{ii}(t) + \\alpha \\sum_{j \\neq i} P_{ji}(t) $$\n由于模型的对称性，对于任何 $j, k \\neq i$，有 $P_{ji}(t) = P_{ki}(t)$。并且，$\\sum_{k} P_{ik}(t) = 1$，这意味着 $P_{ii}(t) + 3P_{ji}(t) = 1$。将 $3P_{ji}(t) = 1 - P_{ii}(t)$ 代入该微分方程，得到：\n$$ \\frac{dP_{ii}(t)}{dt} = -3\\alpha P_{ii}(t) + \\alpha (1-P_{ii}(t)) = \\alpha - 4\\alpha P_{ii}(t) $$\n在初始条件 $P_{ii}(0)=1$ 下，解为：\n$$ P_{ii}(t) = \\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha t) $$\n在一个位点上观测到差异的概率 $p$ 是 $1 - P_{ii}(t)$：\n$$ p(t) = 1 - \\left( \\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha t) \\right) = \\frac{3}{4} \\left( 1 - \\exp(-4\\alpha t) \\right) $$\n进化距离 $d$ 定义为每个位点的期望替换数。在 JC 模型中，任何核苷酸的替换率均为 $3\\alpha$，所以 $d = 3\\alpha t$。将 $4\\alpha t = \\frac{4}{3}d$ 代入 $p(t)$ 的方程，得到：\n$$ p = \\frac{3}{4} \\left( 1 - \\exp(-\\frac{4}{3}d) \\right) $$\n将此方程反转，以可观测的差异比例 $p$ 来求解 $d$，即可得到 JC 校正：\n$$ d = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}p\\right) $$\n此关系在 $p < 3/4$ 时成立。\n\n现在，我们将此应用于给定数据。\n观测到的差异比例为：\n$$ \\hat{p}_{S} = \\frac{X_{S}}{S} = \\frac{3}{78.0} \\approx 0.03846 $$\n$$ \\hat{p}_{N} = \\frac{X_{N}}{N} = \\frac{2}{222.0} \\approx 0.009009 $$\n使用 JC 校正，我们估计每个位点的替换率：\n$$ \\hat{d}_{S} = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}\\hat{p}_{S}\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\cdot \\frac{3}{78.0}\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{78.0}\\right) \\approx 0.03948 $$\n$$ \\hat{d}_{N} = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3}\\hat{p}_{N}\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\cdot \\frac{2}{222.0}\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{8}{666.0}\\right) \\approx 0.009064 $$\n比值 $\\omega = d_N/d_S$ 的点估计为：\n$$ \\hat{\\omega} = \\frac{\\hat{d}_{N}}{\\hat{d}_{S}} \\approx \\frac{0.009064}{0.03948} \\approx 0.2296 $$\n\n**任务 2：替换率的置信区间**\n\n我们将差异计数 $X_S$ 和 $X_N$ 视为独立的泊松随机变量。对于给定的观测值 $x$，泊松均值 $\\lambda$ 的精确 $100(1-\\alpha)\\%$ Garwood 置信区间为 $[\\lambda_L, \\lambda_U]$，其中：\n$$ \\lambda_L = \\frac{1}{2} \\chi^2_{\\alpha/2, 2x} \\quad \\text{and} \\quad \\lambda_U = \\frac{1}{2} \\chi^2_{1-\\alpha/2, 2(x+1)} $$\n这里，我们构建 $95\\%$ 置信区间，所以 $\\alpha=0.05$，$\\alpha/2=0.025$，以及 $1-\\alpha/2=0.975$。$\\chi^2_{q, \\nu}$ 是具有 $\\nu$ 自由度的卡方分布的分位数函数。\n\n对于同义差异，$X_S=3$：\n$$ \\lambda_{S}^{L} = \\frac{1}{2} \\chi^2_{0.025, 2(3)} = \\frac{1}{2} \\chi^2_{0.025, 6} \\approx \\frac{1}{2}(1.2373) = 0.6187 $$\n$$ \\lambda_{S}^{U} = \\frac{1}{2} \\chi^2_{0.975, 2(3+1)} = \\frac{1}{2} \\chi^2_{0.975, 8} \\approx \\frac{1}{2}(17.5345) = 8.7673 $$\n对于非同义差异，$X_N=2$：\n$$ \\lambda_{N}^{L} = \\frac{1}{2} \\chi^2_{0.025, 2(2)} = \\frac{1}{2} \\chi^2_{0.025, 4} \\approx \\frac{1}{2}(0.4844) = 0.2422 $$\n$$ \\lambda_{N}^{U} = \\frac{1}{2} \\chi^2_{0.975, 2(2+1)} = \\frac{1}{2} \\chi^2_{0.975, 6} \\approx \\frac{1}{2}(14.4494) = 7.2247 $$\n接下来，我们通过除以位点数 $S$ 和 $N$ 将这些区间映射到比例 $p_S$ 和 $p_N$ 的区间：\n$$ [p_{S}^{L}, p_{S}^{U}] = [\\frac{\\lambda_{S}^{L}}{S}, \\frac{\\lambda_{S}^{U}}{S}] = [\\frac{0.6187}{78.0}, \\frac{8.7673}{78.0}] \\approx [0.007932, 0.1124] $$\n$$ [p_{N}^{L}, p_{N}^{U}] = [\\frac{\\lambda_{N}^{L}}{N}, \\frac{\\lambda_{N}^{U}}{N}] = [\\frac{0.2422}{222.0}, \\frac{7.2247}{222.0}] \\approx [0.001091, 0.03254] $$\n最后，我们将单调递增的 JC 变换 $d(p) = -\\frac{3}{4} \\ln(1 - \\frac{4}{3}p)$ 应用于这些区间的端点，以获得 $d_S$ 和 $d_N$ 的置信区间：\n$$ d_{S}^{L} = d(p_{S}^{L}) = -\\frac{3}{4} \\ln(1 - \\frac{4}{3} \\cdot 0.007932) \\approx 0.007975 $$\n$$ d_{S}^{U} = d(p_{S}^{U}) = -\\frac{3}{4} \\ln(1 - \\frac{4}{3} \\cdot 0.1124) \\approx 0.1218 $$\n$$ d_{N}^{L} = d(p_{N}^{L}) = -\\frac{3}{4} \\ln(1 - \\frac{4}{3} \\cdot 0.001091) \\approx 0.001092 $$\n$$ d_{N}^{U} = d(p_{N}^{U}) = -\\frac{3}{4} \\ln(1 - \\frac{4}{3} \\cdot 0.03254) \\approx 0.03328 $$\n$d_S$ 的 $95\\%$ 置信区间约为 $[0.007975, 0.1218]$，$d_N$ 的置信区间约为 $[0.001092, 0.03328]$。\n\n**任务 3：$\\omega$ 的置信区间**\n\n$\\omega = d_N/d_S$ 的一个保守 $95\\%$ 置信区间是通过取使比值最大化和最小化的区间端点之比来构建的：\n$$ [\\omega^{L}, \\omega^{U}] = \\left[\\frac{d_{N}^{L}}{d_{S}^{U}}, \\frac{d_{N}^{U}}{d_{S}^{L}}\\right] $$\n代入计算出的值：\n$$ \\omega^{L} = \\frac{0.001092}{0.1218} \\approx 0.008966 $$\n$$ \\omega^{U} = \\frac{0.03328}{0.007975} \\approx 4.173 $$\n得出的 $\\omega$ 保守 $95\\%$ 置信区间约为 $[0.00897, 4.173]$。点估计值 $\\hat{\\omega} \\approx 0.23$ 位于此区间内，该区间很宽，这与观测到的差异计数极低的情况相符。\n问题要求提供此区间的上端点 $\\omega^{U}$，并四舍五入到三位有效数字。\n$$ \\omega^{U} \\approx 4.173 $$\n四舍五入到三位有效数字得到 $4.17$。",
            "answer": "$$\\boxed{4.17}$$"
        },
        {
            "introduction": "真实世界的核酸替换过程远比简单的模型复杂，例如转换（transition）和颠换（transversion）的速率往往不同。本练习在前一练习的基础上，引入了更符合生物学实际的Kimura双参数(K80)模型来修正替换偏差。你需要从一个具体的密码子序列比对开始，亲手完成差异分类、位点计数和速率估算的全过程，从而获得更精确的$\\omega$值 。",
            "id": "2757616",
            "problem": "给定您一个在标准遗传密码下演化的两个直系同源基因之间的密码子配对对齐。您的任务是使用 Nei–Gojobori $1986$ 框架（NG86; Nei–Gojobori $1986$），并结合 Kimura 双参数模型（K80; Kimura $1980$）来分别校正转换和颠换的多次击中，从而估计每位点的非同义替换与同义替换的比率。具体来说，计算经 Kimura 双参数（K80）校正的同义距离 $d_S$ 和非同义距离 $d_N$，然后计算比率 $\\omega = d_N/d_S$。请使用以下假设和数据：\n\n- 使用标准遗传密码来识别同义和非同义变化。\n- 根据嘌呤-嘌呤或嘧啶-嘧啶的变化（转换）与嘌呤-嘧啶的变化（颠换）的定义来处理转换和颠换。\n- 遵循 Nei–Gojobori 的定义，计算每个密码子的同义位点数和非同义位点数：对于每个密码子位置，统计其 $3$ 种可能的单核苷酸变化中属于同义变化的数量；将三个位置的该数量相加，得到此密码子的同义位点数；该密码子的非同义位点数则为 $3$ 减去同义位点数。对两个序列分别进行此计算，然后取其平均值，从而得到整个对齐的总同义位点数 $S$ 和总非同义位点数 $N$。\n- 逐个密码子统计两个序列间的观察差异。此对齐的构建方式使得每对存在差异的密码子都恰好只相差一个核苷酸（没有密码子对存在多个核苷酸差异），这使得每个差异的分类都明确无误。\n- 对于 K80 校正，在同义类别中使用观察到的同义转换比例 $P_S$ 和同义颠换比例 $Q_S$（均用 $S$ 归一化），在非同义类别中使用观察到的非同义转换比例 $P_N$ 和非同义颠换比例 $Q_N$（均用 $N$ 归一化）。然后计算：$$d_S \\text{ from } P_S, Q_S \\quad \\text{and} \\quad d_N \\text{ from } P_N, Q_N \\text{ using K80.}$$\n- 最后计算 $\\omega = d_N/d_S$。\n- 将您的最终答案四舍五入至 $4$ 位有效数字。将 $\\omega$ 作为无量纲量报告。\n\n长度为 $10$ 个密码子的密码子对齐（序列 $1$ vs 序列 $2$）如下：\n\n$1.$ $\\text{GCT}$ vs $\\text{GCC}$\n\n$2.$ $\\text{GGT}$ vs $\\text{GGA}$\n\n$3.$ $\\text{ACT}$ vs $\\text{ATT}$\n\n$4.$ $\\text{CCT}$ vs $\\text{CAT}$\n\n$5.$ $\\text{GTT}$ vs $\\text{GAT}$\n\n$6.$ $\\text{TTT}$ vs $\\text{TTC}$\n\n$7.$ $\\text{TCC}$ vs $\\text{TCT}$\n\n$8.$ $\\text{GCA}$ vs $\\text{GTA}$\n\n$9.$ $\\text{ACC}$ vs $\\text{ACA}$\n\n$10.$ $\\text{GGC}$ vs $\\text{AGC}$\n\n在此 NG86+K80 流程下，$\\omega = d_N/d_S$ 的值是多少？将您的答案四舍五入至 $4$ 位有效数字。",
            "solution": "该问题在科学和数学上是有效的。它要求针对给定的密码子对齐，使用 Nei–Gojobori (NG86) 方法进行位点计数，并使用 Kimura 双参数 (K80) 模型进行多次击中校正，来计算非同义与同义替换率之比 $\\omega = d_N/d_S$。\n\n该过程分五个步骤执行：\n1.  计算同义位点数（$S$）和非同义位点数（$N$）。\n2.  对观察到的替换类型进行分类和计数。\n3.  计算同义和非同义位点的转换和颠换替换比例。\n4.  应用 K80 校正计算同义距离（$d_S$）和非同义距离（$d_N$）。\n5.  计算最终比率 $\\omega = d_N/d_S$。\n\n**第 1 步：计算同义（$S$）和非同义（$N$）位点**\n\n根据标准遗传密码，给定密码子的同义位点数（$s$）计算为 $s = \\sum_{i=1}^{3} f_i$，其中 $f_i$ 是第 $i$ 个位置上导致同义变化的单核苷酸变化的比例。非同义位点数是 $n = 3 - s$。对齐的总位点数 $S$ 和 $N$ 是两个序列位点数的平均值。该对齐长度为 $10$ 个密码子，总计 $30$ 个核苷酸位点。\n\n对于序列 1：\n- 密码子 GCT、GGT、ACT、CCT、GTT、TCC、GCA、ACC、GGC（共 $9$ 个密码子）各有 $s=1$ 和 $n=2$。这些密码子在第三位上是四重简并的。\n- 密码子 TTT 有 $s=1/3$ 和 $n=8/3$。它对于 Phe（苯丙氨酸）是二重简并的（TTC 是同义的，TTA/TTG 是非同义的）。\n序列 1 的总同义位点数：$S_1 = 9 \\times 1 + 1/3 = 28/3$。\n序列 1 的总非同义位点数：$N_1 = 30 - S_1 = 30 - 28/3 = 62/3$。\n\n对于序列 2：\n- 密码子 GCC、GGA、TCT、GTA、ACA（共 $5$ 个密码子）各有 $s=1$ 和 $n=2$。\n- 密码子 ATT 有 $s=2/3$ 和 $n=7/3$。\n- 密码子 CAT、GAT、TTC、AGC（共 $4$ 个密码子）各有 $s=1/3$和$n=8/3$。\n序列 2 的总同义位点数：$S_2 = 5 \\times 1 + 1 \\times (2/3) + 4 \\times (1/3) = 5 + 6/3 = 7$。\n序列 2 的总非同义位点数：$N_2 = 30 - S_2 = 30 - 7 = 23$。\n\n该对齐的平均位点数是：\n$$ S = \\frac{S_1 + S_2}{2} = \\frac{28/3 + 7}{2} = \\frac{(28+21)/3}{2} = \\frac{49/3}{2} = \\frac{49}{6} $$\n$$ N = \\frac{N_1 + N_2}{2} = \\frac{62/3 + 23}{2} = \\frac{(62+69)/3}{2} = \\frac{131/3}{2} = \\frac{131}{6} $$\n检验：$S+N = 49/6 + 131/6 = 180/6 = 30$。这是正确的。\n\n**第 2 步：观察到的替换的分类和计数**\n\n将 $10$ 对有差异的密码子对中的每一个都分类为同义或非同义变化，以及转换（Ti）或颠换（Tv）。\n1.  GCT(Ala) $\\rightarrow$ GCC(Ala): 同义，T$\\rightarrow$C (Ti)。\n2.  GGT(Gly) $\\rightarrow$ GGA(Gly): 同义，T$\\rightarrow$A (Tv)。\n3.  ACT(Thr) $\\rightarrow$ ATT(Ile): 非同义，C$\\rightarrow$T (Ti)。\n4.  CCT(Pro) $\\rightarrow$ CAT(His): 非同义，C$\\rightarrow$A (Tv)。\n5.  GTT(Val) $\\rightarrow$ GAT(Asp): 非同义，T$\\rightarrow$A (Tv)。\n6.  TTT(Phe) $\\rightarrow$ TTC(Phe): 同义，T$\\rightarrow$C (Ti)。\n7.  TCC(Ser) $\\rightarrow$ TCT(Ser): 同义，C$\\rightarrow$T (Ti)。\n8.  GCA(Ala) $\\rightarrow$ GTA(Val): 非同义，C$\\rightarrow$T (Ti)。\n9.  ACC(Thr) $\\rightarrow$ ACA(Thr): 同义，C$\\rightarrow$A (Tv)。\n10. GGC(Gly) $\\rightarrow$ AGC(Ser): 非同义，G$\\rightarrow$A (Ti)。\n\n观察到的差异总结：\n- 同义转换数（$S_{ti}$）：$3$\n- 同义颠换数（$S_{tv}$）：$2$\n- 非同义转换数（$N_{ti}$）：$3$\n- 非同义颠换数（$N_{tv}$）：$2$\n\n**第 3 步：计算比例（$P, Q$）**\n\n分别为同义和非同义位点计算观察到的转换比例（$P$）和颠换比例（$Q$）。\n对于同义位点：\n$$ P_S = \\frac{S_{ti}}{S} = \\frac{3}{49/6} = \\frac{18}{49} $$\n$$ Q_S = \\frac{S_{tv}}{S} = \\frac{2}{49/6} = \\frac{12}{49} $$\n对于非同义位点：\n$$ P_N = \\frac{N_{ti}}{N} = \\frac{3}{131/6} = \\frac{18}{131} $$\n$$ Q_N = \\frac{N_{tv}}{N} = \\frac{2}{131/6} = \\frac{12}{131} $$\n\n**第 4 步：$d_S$ 和 $d_N$ 的 K80 校正**\n\nKimura 双参数距离由公式 $d = -\\frac{1}{2} \\ln(1 - 2P - Q) - \\frac{1}{4} \\ln(1 - 2Q)$ 给出。\n\n对于同义距离 $d_S$：\n对数内的项为：\n$$ 1 - 2P_S - Q_S = 1 - 2\\left(\\frac{18}{49}\\right) - \\frac{12}{49} = 1 - \\frac{36}{49} - \\frac{12}{49} = \\frac{49 - 48}{49} = \\frac{1}{49} $$\n$$ 1 - 2Q_S = 1 - 2\\left(\\frac{12}{49}\\right) = 1 - \\frac{24}{49} = \\frac{25}{49} $$\n因此，同义距离为：\n$$ d_S = -\\frac{1}{2} \\ln\\left(\\frac{1}{49}\\right) - \\frac{1}{4} \\ln\\left(\\frac{25}{49}\\right) = \\frac{1}{2} \\ln(49) - \\frac{1}{4} (\\ln(25) - \\ln(49)) $$\n$$ d_S = \\ln(7) - \\frac{1}{4} (2\\ln(5) - 2\\ln(7)) = \\ln(7) - \\frac{1}{2}\\ln(5) + \\frac{1}{2}\\ln(7) = \\frac{3}{2}\\ln(7) - \\frac{1}{2}\\ln(5) $$\n数值上，$d_S \\approx 2.114146$。\n\n对于非同义距离 $d_N$：\n对数内的项为：\n$$ 1 - 2P_N - Q_N = 1 - 2\\left(\\frac{18}{131}\\right) - \\frac{12}{131} = 1 - \\frac{36}{131} - \\frac{12}{131} = \\frac{131 - 48}{131} = \\frac{83}{131} $$\n$$ 1 - 2Q_N = 1 - 2\\left(\\frac{12}{131}\\right) = 1 - \\frac{24}{131} = \\frac{107}{131} $$\n因此，非同义距离为：\n$$ d_N = -\\frac{1}{2} \\ln\\left(\\frac{83}{131}\\right) - \\frac{1}{4} \\ln\\left(\\frac{107}{131}\\right) $$\n$$ d_N = -\\frac{1}{2}(\\ln(83)-\\ln(131)) - \\frac{1}{4}(\\ln(107)-\\ln(131)) = \\frac{3}{4}\\ln(131) - \\frac{1}{2}\\ln(83) - \\frac{1}{4}\\ln(107) $$\n数值上，$d_N \\approx 0.278770$。\n\n**第 5 步：计算 $\\omega = d_N/d_S$**\n\n最后，计算比率 $\\omega$：\n$$ \\omega = \\frac{d_N}{d_S} = \\frac{\\frac{3}{4}\\ln(131) - \\frac{1}{2}\\ln(83) - \\frac{1}{4}\\ln(107)}{\\frac{3}{2}\\ln(7) - \\frac{1}{2}\\ln(5)} $$\n$$ \\omega \\approx \\frac{0.278770}{2.114146} \\approx 0.13185966 $$\n四舍五入到 $4$ 位有效数字，得到 $\\omega = 0.1319$。",
            "answer": "$$\\boxed{0.1319}$$"
        },
        {
            "introduction": "在现代进化分析中，我们通常使用基于似然的统计模型来检验正选择的存在。本练习模拟了系统发育分析中一个核心的步骤：使用似然比检验（LRT）来比较嵌套的密码子模型（例如，M7与M8模型）。你将学习如何根据模型拟合的对数似然值计算检验统计量，并确定其自由度，特别是理解当参数估计位于边界时对检验的理论影响 。",
            "id": "2757644",
            "problem": "给定一个场景，其中一个编码序列的比对和一个固定的系统发育树在两个嵌套的密码子替换模型下进行分析，以通过非同义替换率与同义替换率之比（表示为 $dN/dS$，通常写作 $\\omega$）来检验正选择。模型 $M7$ 假设位点特异性的 $\\omega$ 值从一个限制在区间 $(0,1)$ 内的 Beta 分布中抽取，这涵盖了中性选择和纯化选择。模型 $M8$ 在 $M7$ 的基础上增加了一个额外的位点类别，允许 $\\omega \\ge 1$，从而使一部分位点能够经历正选择。似然比检验（LRT）比较这些模型的最大化似然值，以评估正选择的证据。\n\n对于每个测试用例，您将获得模型 $M7$ 下的最大化对数似然值（记为 $\\ell_{7}$）和模型 $M8$ 下的最大化对数似然值（记为 $\\ell_{8}$）。您还将获得特定于位点模型部分的额外自由参数数量：$M7$ 的为 $k_{7}$，$M8$ 的为 $k_{8}$。两个模型完全共享的参数（例如分支长度以及共享的核苷酸或密码子可置换性参数，如果有的话）不包含在 $k_{7}$ 或 $k_{8}$ 中，因此在比较中被抵消。此外，您将获得一个非负整数 $b$，它表示在 $M8$ 的最大似然估计处有效激活的边界约束数量。当 $M8$ 的估计值位于零假设边界上时（例如 $\\omega=1$ 或混合比例为零），这会减少有效自由度。将有效自由度视为由边界减少量调整后的自由参数之差。\n\n您对每个测试用例的任务是：\n- 使用提供的最大化对数似然值计算似然比检验统计量。\n- 使用提供的参数数量和边界减少量计算有效自由度。\n- 如果由于数值不精确导致计算出的检验统计量为负，则将其设置为 $0.0$。\n- 报告检验统计量（四舍五入到恰好 $4$ 位小数）和自由度（作为整数）。\n\n测试套件：\n1. 用例 A：$\\ell_{7} = -1234.56$，$\\ell_{8} = -1227.78$，$k_{7} = 2$，$k_{8} = 4$，$b = 0$。\n2. 用例 B：$\\ell_{7} = -987.65$，$\\ell_{8} = -987.60$，$k_{7} = 2$，$k_{8} = 4$，$b = 1$。\n3. 用例 C：$\\ell_{7} = -1500.00$，$\\ell_{8} = -1500.00$，$k_{7} = 2$，$k_{8} = 4$，$b = 0$。\n4. 用例 D：$\\ell_{7} = -200.1234$，$\\ell_{8} = -200.1235$，$k_{7} = 2$，$k_{8} = 4$，$b = 0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表的列表形式的结果，无空格，格式为\n$[[t_{A},df_{A}],[t_{B},df_{B}],[t_{C},df_{C}],[t_{D},df_{D}]]$\n其中 $t_{X}$ 是用例 $X$ 的四舍五入后的检验统计量，$df_{X}$ 是相应的整数自由度。例如，一个有效的输出可能看起来像 $[[1.2345,2],[0.0000,1],[0.0000,2],[0.5678,2]]$。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n**步骤 1：提取给定信息**\n以下数据和定义均按原文提供：\n- 背景：一个编码序列的比对和一个系统发育树在两个嵌套的密码子替换模型下进行分析，以通过非同义替换率与同义替换率之比（表示为 $dN/dS$ 或 $\\omega$）来检验正选择。\n- 模型 $M7$：假设位点特异性的 $\\omega$ 值从一个限制在区间 $(0,1)$ 内的 Beta 分布中抽取。\n- 模型 $M8$：在 $M7$ 的基础上增加了一个额外的位点类别，允许 $\\omega \\ge 1$。\n- $\\ell_{7}$：模型 $M7$ 下的最大化对数似然值。\n- $\\ell_{8}$：模型 $M8$ 下的最大化对数似然值。\n- $k_{7}$：$M7$ 位点模型部分特有的额外自由参数数量。\n- $k_{8}$：$M8$ 位点模型部分特有的额外自由参数数量。\n- $b$：一个非负整数，表示在 $M8$ 的最大似然估计处有效激活的边界约束数量。\n- 测试用例：\n  1. 用例 A：$\\ell_{7} = -1234.56$，$\\ell_{8} = -1227.78$，$k_{7} = 2$，$k_{8} = 4$，$b = 0$。\n  2. 用例 B：$\\ell_{7} = -987.65$，$\\ell_{8} = -987.60$，$k_{7} = 2$，$k_{8} = 4$，$b = 1$。\n  3. 用例 C：$\\ell_{7} = -1500.00$，$\\ell_{8} = -1500.00$，$k_{7} = 2$，$k_{8} = 4$，$b = 0$。\n  4. 用例 D：$\\ell_{7} = -200.1234$，$\\ell_{8} = -200.1235$，$k_{7} = 2$，$k_{8} = 4$，$b = 0$。\n\n**步骤 2：使用提取的给定信息进行验证**\n该问题具有科学依据，提法明确且客观。它正确地描述了在进化生物学中用于比较嵌套模型的标准似然比检验（LRT），特别是像 PAML 等程序中实现的位点模型 $M7$ 和 $M8$。模型 $M7$（零假设：中性选择和纯化选择）嵌套在模型 $M8$（备择假设：允许正选择）内的前提是准确的。所提供的参数（$\\ell_{7}$、$\\ell_{8}$、$k_{7}$、$k_{8}$ 和 $b$）正是执行 LRT 所需的输入。包含边界约束参数 $b$ 正确地处理了一个已知的统计复杂性问题，即零假设的参数值位于参数空间的边界上，这导致了 chi-bar-square 零分布。该问题是自包含的，没有矛盾，其术语的定义足够精确，可以得到唯一解。\n\n**步骤 3：结论与行动**\n该问题被判定为有效。将构建一个完整的解决方案。\n\n基本任务是为每个指定用例计算似然比检验统计量（我们将其表示为 $t$）和有效自由度 $df_{eff}$。\n\n核心原理是似然比检验，它适用于比较两个嵌套统计模型的拟合优度。零模型 $M_{0}$ 必须是备择（或通用）模型 $M_{1}$ 的一个特例。这对模型 $M7$ 和 $M8$ 是成立的，其中 $M7$ 作为零假设。检验统计量 $t$ 定义为备择模型的最大化对数似然值与零模型的最大化对数似然值之差的两倍。\n$$t = 2 \\times (\\ell_{1} - \\ell_{0})$$\n在此问题的背景下，公式为：\n$$t = 2 \\times (\\ell_{8} - \\ell_{7})$$\n理论上，由于 $M7$ 是 $M8$ 的一个约束版本，因此 $M8$ 的最大化似然值不能小于 $M7$ 的。因此，$\\ell_{8} \\ge \\ell_{7}$。问题正确地指明，如果由于数值不精确导致 $t$ 值为负，应将其视为 $0$，这反映了模型拟合度没有改善。\n\n对于服从卡方分布的 LRT 统计量，其自由度 $df$ 是两个模型自由参数数量之差。\n$$df = k_{1} - k_{0}$$\n对于给定的问题，这最初是 $k_{8} - k_{7}$。然而，问题提供了一个因子 $b$ 来考虑边界约束。这类约束会减少有效自由度。因此，有效自由度 $df_{eff}$ 计算如下：\n$$df_{eff} = (k_{8} - k_{7}) - b$$\n\n现在将这些原理应用于测试套件。\n\n**用例 A：**\n给定：$\\ell_{7} = -1234.56$，$\\ell_{8} = -1227.78$，$k_{7} = 2$，$k_{8} = 4$，$b = 0$。\n检验统计量 $t_{A}$ 计算如下：\n$$t_{A} = 2 \\times (-1227.78 - (-1234.56)) = 2 \\times (6.78) = 13.56$$\n四舍五入到 $4$ 位小数，$t_{A} = 13.5600$。\n自由度 $df_{A}$ 为：\n$$df_{A} = (4 - 2) - 0 = 2$$\n结果：$[13.5600, 2]$。\n\n**用例 B：**\n给定：$\\ell_{7} = -987.65$，$\\ell_{8} = -987.60$，$k_{7} = 2$，$k_{8} = 4$，$b = 1$。\n检验统计量 $t_{B}$ 为：\n$$t_{B} = 2 \\times (-987.60 - (-987.65)) = 2 \\times (0.05) = 0.1$$\n四舍五入到 $4$ 位小数，$t_{B} = 0.1000$。\n自由度 $df_{B}$ 为：\n$$df_{B} = (4 - 2) - 1 = 1$$\n结果：$[0.1000, 1]$。\n\n**用例 C：**\n给定：$\\ell_{7} = -1500.00$，$\\ell_{8} = -1500.00$，$k_{7} = 2$，$k_{8} = 4$，$b = 0$。\n检验统计量 $t_{C}$ 为：\n$$t_{C} = 2 \\times (-1500.00 - (-1500.00)) = 2 \\times (0) = 0$$\n该值为精确值，所以 $t_{C} = 0.0000$。\n自由度 $df_{C}$ 为：\n$$df_{C} = (4 - 2) - 0 = 2$$\n结果：$[0.0000, 2]$。\n\n**用例 D：**\n给定：$\\ell_{7} = -200.1234$，$\\ell_{8} = -200.1235$，$k_{7} = 2$，$k_{8} = 4$，$b = 0$。\n检验统计量 $t_{D}$ 的初始计算得出：\n$$t_{raw} = 2 \\times (-200.1235 - (-200.1234)) = 2 \\times (-0.0001) = -0.0002$$\n由于该值为负，根据问题规则必须将其设置为 $0.0$。\n$$t_{D} = 0.0$$\n四舍五入到 $4$ 位小数，$t_{D} = 0.0000$。\n自由度 $df_{D}$ 为：\n$$df_{D} = (4 - 2) - 0 = 2$$\n结果：$[0.0000, 2]$。\n\n将所有结果汇总成所需的最终格式。",
            "answer": "[[13.5600,2],[0.1000,1],[0.0000,2],[0.0000,2]]"
        }
    ]
}