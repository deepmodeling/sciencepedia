{
    "hands_on_practices": [
        {
            "introduction": "中性理论的一个核心预测是，中性突变以一个恒定的速率被固定，这个速率等于突变率本身($\\mu$)。这一深刻的见解使得我们可以将分子序列的分歧程度用作“分子钟”来推断物种分化的时间。本练习将通过一个经典场景——利用假基因（一类通常被认为不受选择压力影响的DNA序列）的数据，来实践这一原理，从而估算进化研究中的一个基本参数：中性突变率 。",
            "id": "1527865",
            "problem": "一个分子进化学家团队正在研究两种特有于偏远岛屿的不会飞的鸟类。他们假设这两个物种是在一次单一的定殖事件后发生分化的。为了构建分子钟，他们对一个假基因位点进行了测序——这是一个脱氧核糖核酸（DNA）的非编码区域，据推测该区域不受自然选择压力的影响，呈中性演化。\n\n这两个物种的该假基因的比对序列长度为1200个碱基对。直接比较显示，它们之间存在36个核苷酸差异。对岛屿上火山岩层的地质分析表明，祖先种群被隔离，导致这两个物种在大约600万年前发生分化。\n\n假设分子进化的中性理论适用于该假基因，计算中性突变的平均速率。将您的答案以“突变/位点/年”为单位，用科学记数法表示，并四舍五入到两位有效数字。",
            "solution": "设 $L$ 为序列长度，$D$ 为观察到的差异数，$t$ 为分化时间，$\\mu$ 为每位点每年的中性突变（取代）速率。根据中性理论和分子钟，每个谱系以速率 $\\mu$ 累积中性取代，因此在时间 $t$ 之后，两个谱系之间每个位点的预期分歧为\n$$\nK = 2 \\mu t.\n$$\n观察到的每位点分歧为\n$$\nK = \\frac{D}{L}.\n$$\n令二者相等，可得\n$$\n\\frac{D}{L} = 2 \\mu t \\quad \\Rightarrow \\quad \\mu = \\frac{D}{2 t L}.\n$$\n将 $D=36$，$L=1200$ 及 $t=6.0 \\times 10^{6}$ 年代入：\n$$\n\\mu = \\frac{36}{2 \\times \\left(6.0 \\times 10^{6}\\right) \\times 1200}.\n$$\n计算分母：\n$$\n2 \\times \\left(6.0 \\times 10^{6}\\right) \\times 1200 = \\left(12.0 \\times 10^{6}\\right) \\times 1200 = \\left(1.2 \\times 10^{7}\\right) \\times \\left(1.2 \\times 10^{3}\\right) = 1.44 \\times 10^{10}.\n$$\n因此，\n$$\n\\mu = \\frac{36}{1.44 \\times 10^{10}} = \\frac{3.6 \\times 10^{1}}{1.44 \\times 10^{10}} = \\left(\\frac{3.6}{1.44}\\right) \\times 10^{1-10} = 2.5 \\times 10^{-9}.\n$$\n用科学记数法表示并四舍五入至两位有效数字，中性突变的平均速率为 $2.5 \\times 10^{-9}$ 次突变/位点/年。",
            "answer": "$$\\boxed{2.5 \\times 10^{-9}}$$"
        },
        {
            "introduction": "尽管非同义替换率 ($K_a$) 与同义替换率 ($K_s$) 的比值是检测自然选择的有力工具，但对其结果的解读必须十分谨慎。此练习探讨了一种非适应性的进化力量——GC偏向性基因转换（gBGC），它能够在没有功能性选择的情况下，产生通常与正选择相关联的信号（$K_a/K_s > 1$）。通过这个精心设计的假想情景，你将学会批判性地评估分子演化信号，并考虑那些可能混淆视听的非选择性解释 。",
            "id": "1527859",
            "problem": "一个分子进化学家团队正在研究一个植物基因组中一对近期重复的基因。他们假设这些基因的进化受中性理论支配，即所有突变，无论是同义突变还是非同义突变，相对于蛋白质的功能都是选择性中性的。然而，他们怀疑一种已知的分子驱动机制，即GC偏向性基因转换 (gBGC)，是活跃的。该过程与重组相关，倾向于支持鸟嘌呤 (G) 和胞嘧啶 (C) 核苷酸的固定，而非腺嘌呤 (A) 和胸腺嘧啶 (T)。\n\n为了量化这种效应，该团队将替换过程建模如下。他们将碱基分为“弱碱基”(W)（即A或T）或“强碱基”(S)（即G或C）。在没有任何偏向的情况下，任何位点的基线中性替换率是一个常数 $\\rho_0$。gBGC过程根据突变的类型修改此速率：\n- 将W碱基变为S碱基的突变，其有效替换率为 $B \\times \\rho_0$。\n- 将S碱基变为W碱基的突变，其有效替换率为 $\\frac{1}{B} \\times \\rho_0$。\n- 不改变W/S状态（即W到W或S到S）的突变，其有效替换率保持在基线速率 $\\rho_0$。\n\n该团队分析了基因的编码序列，并根据遗传密码和氨基酸序列，对突变的潜力进行了划分。他们确定了其中一个基因拷贝的以下属性：\n- 非同义位点的总数是 $N_a = 700$。\n- 同义位点的总数是 $N_s = 200$。\n\n通过仔细的逐位点分析，非同义位点根据其允许的突变类型被进一步分类：\n- 替换构成W到S变化的非同义位点数：$N_{a, W \\to S} = 350$。\n- 替换构成S到W变化的非同义位点数：$N_{a, S \\to W} = 50$。\n- 替换构成W/S中性变化的非同义位点数：$N_{a, neut} = 300$。\n\n同样地，同义位点也被分类：\n- 替换构成W到S变化的同义位点数：$N_{s, W \\to S} = 50$。\n- 替换构成S到W变化的同义位点数：$N_{s, S \\to W} = 50$。\n- 替换构成W/S中性变化的同义位点数：$N_{s, neut} = 100$。\n\n该团队估计gBGC偏向因子为 $B=5.0$。\n\n假设该模型正确，并且所有突变在功能上都是中性的，计算每个非同义位点的非同义替换率 ($K_a$) 与每个同义位点的同义替换率 ($K_s$) 的期望比值。将最终答案四舍五入到三位有效数字。",
            "solution": "在给定的gBGC模型下，每个潜在替换的有效速率等于基线中性速率 $\\rho_{0}$ 乘以一个取决于变化是 $W \\to S$、$S \\to W$ 还是W/S中性的偏向因子。因此，每个类别中每个位点的期望替换率是相应位点上这些有效速率的平均值。\n\n将每个位点的非同义和同义替换率分别定义为 $K_{a}$ 和 $K_{s}$。那么\n$$\nK_{a}=\\frac{1}{N_{a}}\\left(N_{a,W \\to S}\\,B\\rho_{0}+N_{a,S \\to W}\\,\\frac{\\rho_{0}}{B}+N_{a,neut}\\,\\rho_{0}\\right),\n$$\n$$\nK_{s}=\\frac{1}{N_{s}}\\left(N_{s,W \\to S}\\,B\\rho_{0}+N_{s,S \\to W}\\,\\frac{\\rho_{0}}{B}+N_{s,neut}\\,\\rho_{0}\\right).\n$$\n因此，比值为\n$$\n\\frac{K_{a}}{K_{s}}=\\frac{N_{a,W \\to S}\\,B+N_{a,S \\to W}\\,B^{-1}+N_{a,neut}}{N_{a}}\\cdot \\frac{N_{s}}{N_{s,W \\to S}\\,B+N_{s,S \\to W}\\,B^{-1}+N_{s,neut}}.\n$$\n代入 $N_{a}=700$、$N_{a,W \\to S}=350$、$N_{a,S \\to W}=50$、$N_{a,neut}=300$、$N_{s}=200$、$N_{s,W \\to S}=50$、$N_{s,S \\to W}=50$、$N_{s,neut}=100$ 和 $B=5$，我们得到\n$$\n\\frac{K_{a}}{K_{s}}=\\frac{350\\cdot 5+50\\cdot \\frac{1}{5}+300}{700}\\cdot \\frac{200}{50\\cdot 5+50\\cdot \\frac{1}{5}+100}\n=\\frac{1750+10+300}{700}\\cdot \\frac{200}{250+10+100}.\n$$\n化简后得到\n$$\n\\frac{K_{a}}{K_{s}}=\\frac{2060}{700}\\cdot \\frac{200}{360}=\\frac{103}{63}\\approx 1.634920635,\n$$\n四舍五入到三位有效数字，结果是 $1.63$。",
            "answer": "$$\\boxed{1.63}$$"
        },
        {
            "introduction": "中性理论最有力的应用之一，是将其作为检测自然选择作用的零假设。McDonald-Kreitman（MK）检验通过比较种内多态性与种间分歧，将这一思想形式化。这个高级练习将指导你如何使用MK检验的数据来计算适应性替换的比例($\\alpha$)，从而对正选择在蛋白质演化中的驱动作用进行定量估计，这是群体基因组学研究的一项核心技能 。",
            "id": "2859585",
            "problem": "一项比较群体基因组学研究收集了一个焦点物种及其近缘外群的 $8$ 个基因的编码序列数据。对于每个基因 $i$，数据包括焦点物种内部在非同义位点 ($P_{N,i}$) 和同义位点 ($P_{S,i}$) 的分离多态性位点计数，以及焦点物种与外群之间在非同义位点 ($D_{N,i}$) 和同义位点 ($D_{S,i}$) 的固定差异计数。分子进化的中性理论主张，长期替换速率等于中性突变速率，并且在中性条件下，在对突变机会进行适当标准化后，非同义与同义变化的比率在物种内多态性和物种间分化两个时间尺度上预期是相同的。在 McDonald–Kreitman (MK) 框架中，将适应性非同义替换的比例 $\\alpha$ 定义为无法由物种内非同义与同义多态性比率推断出的中性期望所解释的非同义固定差异部分。\n\n仅使用上述原理和定义，完成以下任务：\n- 从第一性原理出发，推导一个依赖于汇总计数 $P_{N}=\\sum_{i=1}^{8} P_{N,i}$、$P_{S}=\\sum_{i=1}^{8} P_{S,i}$、$D_{N}=\\sum_{i=1}^{8} D_{N,i}$ 和 $D_{S}=\\sum_{i=1}^{8} D_{S,i}$ 的 $\\alpha$ 的估计量。\n- 使用所提供的各基因数据，计算 $\\alpha$ 的点估计值。\n- 概述一种通过重抽样基因来评估估计量不确定性的非参数自助法策略，并推导一个用自助法重复估计值表示的自助法标准误的闭式表达式。\n\n各基因的 MK 计数如下：\n- 基因 $1$：$P_{N,1}=5$, $P_{S,1}=22$, $D_{N,1}=12$, $D_{S,1}=20$。\n- 基因 $2$：$P_{N,2}=3$, $P_{S,2}=24$, $D_{N,2}=15$, $D_{S,2}=22$。\n- 基因 $3$：$P_{N,3}=7$, $P_{S,3}=21$, $D_{N,3}=18$, $D_{S,3}=29$。\n- 基因 $4$：$P_{N,4}=4$, $P_{S,4}=26$, $D_{N,4}=20$, $D_{S,4}=34$。\n- 基因 $5$：$P_{N,5}=6$, $P_{S,5}=28$, $D_{N,5}=25$, $D_{S,5}=36$。\n- 基因 $6$：$P_{N,6}=2$, $P_{S,6}=23$, $D_{N,6}=14$, $D_{S,6}=29$。\n- 基因 $7$：$P_{N,7}=8$, $P_{S,7}=20$, $D_{N,7}=23$, $D_{S,7}=30$。\n- 基因 $8$：$P_{N,8}=3$, $P_{S,8}=26$, $D_{N,8}=18$, $D_{S,8}=20$。\n\n以小数形式报告 $\\alpha$ 的数值点估计值，并将您的答案四舍五入到四位有效数字。无需单位。",
            "solution": "### 解答推导与计算\n\n**第一部分：$\\alpha$ 估计量的推导**\n\n分子进化的中性理论假设，分子水平上绝大多数的进化变化是由选择中性突变体的随机遗传漂变引起的。一个关键预测是，如果所有突变都是中性的，那么非同义替换与同义替换的比率随时间应保持不变。这意味着，在考虑了每种突变类型的可用位点数后，在物种内部观察到的非同义 ($N$) 与同义 ($S$) 变化的比率（多态性, $P$）应与在物种之间观察到的比率（分化, $D$）相同。\n\n中性期望可以正式表述为：\n$$ \\frac{D_{N, \\text{neutral}}}{D_S} = \\frac{P_N}{P_S} $$\n此处，$D_{N, \\text{neutral}}$ 表示在所有非同义突变均为中性的情况下预期的非同义固定差异数。$D_S$ 是同义固定差异数，通常被假定为中性并作为基线。$P_N$ 和 $P_S$ 分别是非同义和同义多态性数，它们反映了当前的突变输入，并被假定为大部分是中性或弱有害的。\n\n观察到的总非同义固定差异数 $D_N$ 是中性固定的部分 ($D_{N, \\text{neutral}}$) 和因正选择而适应性固定的部分 ($D_{N, \\text{adaptive}}$) 的总和：\n$$ D_N = D_{N, \\text{neutral}} + D_{N, \\text{adaptive}} $$\n\n根据中性期望，我们可以解出预期的中性非同义固定差异数：\n$$ D_{N, \\text{neutral}} = D_S \\frac{P_N}{P_S} $$\n\n问题将 $\\alpha$ 定义为适应性的非同义固定差异所占的比例。在数学上，这表示为：\n$$ \\alpha = \\frac{D_{N, \\text{adaptive}}}{D_N} $$\n\n将 $D_{N, \\text{adaptive}} = D_N - D_{N, \\text{neutral}}$ 代入 $\\alpha$ 的表达式，得到：\n$$ \\alpha = \\frac{D_N - D_{N, \\text{neutral}}}{D_N} = 1 - \\frac{D_{N, \\text{neutral}}}{D_N} $$\n\n最后，代入基于中性期望的 $D_{N, \\text{neutral}}$ 表达式，我们得到 $\\alpha$ 的估计量：\n$$ \\hat{\\alpha} = 1 - \\frac{D_S P_N}{D_N P_S} $$\n这就是从第一性原理推导出的所需估计量。\n\n**第二部分：$\\alpha$ 点估计值的计算**\n\n首先，我们必须根据这 $8$ 个基因的各基因数据计算汇总计数。\n$$ P_N = \\sum_{i=1}^{8} P_{N,i} = 5 + 3 + 7 + 4 + 6 + 2 + 8 + 3 = 38 $$\n$$ P_S = \\sum_{i=1}^{8} P_{S,i} = 22 + 24 + 21 + 26 + 28 + 23 + 20 + 26 = 190 $$\n$$ D_N = \\sum_{i=1}^{8} D_{N,i} = 12 + 15 + 18 + 20 + 25 + 14 + 23 + 18 = 145 $$\n$$ D_S = \\sum_{i=1}^{8} D_{S,i} = 20 + 22 + 29 + 34 + 36 + 29 + 30 + 20 = 220 $$\n\n现在，将这些汇总计数代入 $\\alpha$ 的估计量中：\n$$ \\hat{\\alpha} = 1 - \\frac{(220)(38)}{(145)(190)} = 1 - \\frac{8360}{27550} $$\n计算该分数：\n$$ \\frac{8360}{27550} \\approx 0.303448275... $$\n因此，$\\alpha$ 的点估计值为：\n$$ \\hat{\\alpha} \\approx 1 - 0.303448275... = 0.696551724... $$\n按要求四舍五入到四位有效数字：\n$$ \\hat{\\alpha} \\approx 0.6966 $$\n\n**第三部分：非参数自助法策略与标准误表达式**\n\n为了评估估计量 $\\hat{\\alpha}$ 的不确定性，采用通过重抽样基因的非参数自助法程序是合适的。重抽样的单位是整个基因，因为单个基因的计数（$P_N, P_S, D_N, D_S$）不是独立的。\n\n策略如下：\n$1$. 原始数据集包含 $N=8$ 个观测值，其中每个观测值 $i$ 是一个包含四个计数的向量：$\\text{gene}_i = (P_{N,i}, P_{S,i}, D_{N,i}, D_{S,i})$。\n\n$2$. 通过从原始基因集中有放回地抽样 $N=8$ 个基因来生成一个自助法重复数据集。设第 $b$ 个自助法样本为 $\\{\\text{gene}_1^{(b)}, \\text{gene}_2^{(b)}, ..., \\text{gene}_8^{(b)}\\}$。\n\n$3$. 对于每个自助法重复样本 $b$，通过对重抽样出的基因求和来计算汇总计数：\n$$ P_N^{(b)} = \\sum_{j=1}^{8} P_{N,j}^{(b)}, \\quad P_S^{(b)} = \\sum_{j=1}^{8} P_{S,j}^{(b)}, \\quad D_N^{(b)} = \\sum_{j=1}^{8} D_{N,j}^{(b)}, \\quad D_S^{(b)} = \\sum_{j=1}^{8} D_{S,j}^{(b)} $$\n\n$4$. 为该重复样本计算 $\\alpha$ 的自助法重复估计值：\n$$ \\hat{\\alpha}^{(b)} = 1 - \\frac{D_S^{(b)} P_N^{(b)}}{D_N^{(b)} P_S^{(b)}} $$\n\n$5$. 重复步骤 2-4 大量次数， $B$ 次（例如，$B \\ge 1000$），以获得自助法估计值的分布 $\\{\\hat{\\alpha}^{(1)}, \\hat{\\alpha}^{(2)}, ..., \\hat{\\alpha}^{(B)}\\}$。\n\n自助法标准误 $SE_{\\text{boot}}(\\hat{\\alpha})$ 是该自助法估计值分布的标准差。用自助法重复估计值表示的该标准误的闭式表达式由样本标准差公式给出：\n$$ SE_{\\text{boot}}(\\hat{\\alpha}) = \\sqrt{\\frac{1}{B-1} \\sum_{b=1}^{B} (\\hat{\\alpha}^{(b)} - \\bar{\\alpha}_{\\text{boot}})^2} $$\n其中 $\\bar{\\alpha}_{\\text{boot}}$ 是自助法重复估计值的平均值：\n$$ \\bar{\\alpha}_{\\text{boot}} = \\frac{1}{B} \\sum_{b=1}^{B} \\hat{\\alpha}^{(b)} $$\n该表达式为点估计值 $\\hat{\\alpha}$ 提供了所要求的统计不确定性度量。",
            "answer": "$$\\boxed{0.6966}$$"
        }
    ]
}