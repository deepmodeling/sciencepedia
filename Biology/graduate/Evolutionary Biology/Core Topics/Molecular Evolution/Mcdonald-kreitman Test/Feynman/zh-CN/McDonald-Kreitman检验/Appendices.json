{
    "hands_on_practices": [
        {
            "introduction": "理论知识需要通过实践来巩固。第一个练习旨在提供一个直接应用麦当劳-克雷特曼（MK）检验核心公式的机会 。通过处理一组给定的多态性和分歧数据，您将亲自计算关键统计量，例如比值比和适应性替换比例 ($\\hat{\\alpha}$)。掌握这一基本计算是利用 MK 检验解释真实数据的关键第一步。",
            "id": "2731810",
            "problem": "在一个物种内调查了一个单拷贝核基因，并与一个姐妹种进行了比较。种内分离位点被分为非同义多态性和同义多态性，而种间固定差异被分为非同义分化和同义分化。假设位点间相互独立，测序错误可忽略不计，且种内样本足够大，可将观测到的计数视为有效精确值。您将使用麦当劳-克雷特曼（McDonald-Kreitman, MK）框架，其理论中性基线是，非同义与同义变化的相对速率在种内和种间是相同的。您还将对相关的2x2列联表（其边缘固定）使用 Fisher 精确检验（Fisher’s exact test）。\n\n观测到的计数如下：\n- 非同义多态性：$P_n = 40$。\n- 同义多态性：$P_s = 100$。\n- 非同义固定差异：$D_n = 120$。\n- 同义固定差异：$D_s = 200$。\n\n仅使用中性基线下的列联表基本原理定义和 Fisher 精确检验的精确超几何抽样，执行一个单一、内部一致的工作流程以：\n1. 计算比值比（odds ratio），该比值比用于比较分化类别中非同义与同义的比值（odds）与多态性类别中非同义与同义的比值。\n2. 计算双侧 Fisher 精确检验的 $p$ 值，其零假设为该列联表与中性基线一致（即行和列的分类是独立的）。\n3. 根据与中性基线的偏差，推断由正选择驱动的非同义替换的估计比例，记为 $\\hat{\\alpha}$。\n\n最后，仅以小数形式报告 $\\hat{\\alpha}$ 的数值，保留四位有效数字。不要报告百分比；报告一个没有单位的纯数字。",
            "solution": "该问题陈述已经过评估，被认为是有效的。它在科学上基于分子进化的原理，数据充分、问题提出得当，且表述客观。我们将继续进行解答。\n\n该问题要求基于 McDonald-Kreitman (MK) 检验框架进行分析。所提供的数据可以整理成一个 $2 \\times 2$ 列联表，这是此检验的标准表示方法。行代表核苷酸替换的类型（非同义或同义），列代表变异的类别（物种内的多态性或物种间的固定差异）。\n\n观测到的计数如下：\n- 非同义多态性：$P_n = 40$\n- 同义多态性：$P_s = 100$\n- 非同义固定差异（分化）：$D_n = 120$\n- 同义固定差异（分化）：$D_s = 200$\n\n因此，列联表为：\n$$\n\\begin{array}{c|cc|c}\n & \\text{多态性} & \\text{分化} & \\text{总计} \\\\\n\\hline\n\\text{非同义} & P_n=40 & D_n=120 & 160 \\\\\n\\text{同义} & P_s=100 & D_s=200 & 300 \\\\\n\\hline\n\\text{总计} & 140 & 320 & 460\n\\end{array}\n$$\nMK 检验的零假设（$H_0$）是中性进化。在严格中性条件下，非同义与同义变化的比率对于物种内的多态性和物种间的固定差异应该是相同的。这意味着变化的分类（行）与进化时间尺度（列）之间存在统计独立性。用数学公式表示为：\n$$ \\frac{P_n}{P_s} = \\frac{D_n}{D_s} $$\n问题要求计算三个量。我们按逻辑顺序进行处理。\n\n1.  **比值比（Odds Ratio, $\\text{OR}$）**\n    比值比定义为分化类别中变化为非同义的比值（odds）与多态性类别中变化为非同义的比值的比率。\n    分化类别的比值为 $\\frac{D_n}{D_s}$。\n    多态性类别的比值为 $\\frac{P_n}{P_s}$。\n    因此，比值比为：\n    $$ \\text{OR} = \\frac{D_n / D_s}{P_n / P_s} = \\frac{D_n P_s}{D_s P_n} $$\n    代入给定值：\n    $$ \\text{OR} = \\frac{120 \\times 100}{200 \\times 40} = \\frac{12000}{8000} = 1.5 $$\n    大于 $1$ 的比值比表明，与由多态性类别设定的中性预期相比，分化类别中的非同义变化存在超出现象。\n\n2.  **Fisher 精确检验的 $p$ 值**\n    Fisher 精确检验评估了与零假设偏差的统计显著性。给定列联表的固定边缘总计（行总计 $R_1 = 160$, $R_2 = 300$；列总计 $C_1 = 140$, $C_2 = 320$；总计 $N = 460$），在零假设下观察到特定列联表配置的概率遵循超几何分布。观察到恰好有 $P_n=k$ 个非同义多态性的概率是：\n    $$ P(P_n=k) = \\frac{\\binom{R_1}{k} \\binom{R_2}{C_1-k}}{\\binom{N}{C_1}} = \\frac{\\binom{160}{k} \\binom{300}{140-k}}{\\binom{460}{140}} $$\n    观测到的列联表有 $P_n = 40$。期望值为 $E[P_n] = \\frac{R_1 C_1}{N} = \\frac{160 \\times 140}{460} \\approx 48.7$。\n    双侧 $p$ 值是所有与观测到的列联表同样极端或更极端的列联表的概率之和。虽然计算该值对于完整的统计报告是必要的，但对于计算 $\\hat{\\alpha}$（最终要求的量）并非必需。问题的结构表明，我们应假设偏差是有意义的，并继续量化其大小。\n\n3.  **适应性驱动的替换比例（$\\hat{\\alpha}$）**\n    量 $\\hat{\\alpha}$ 代表物种间由正选择固定的非同义固定差异的估计比例。其逻辑是计算中性条件下预期的非同义固定数量，并将其从观测数量中减去。余下的部分归因于适应性进化。\n    中性预期是，非同义与同义分化的比率等于多态性的比率：\n    $$ \\left( \\frac{D_n}{D_s} \\right)_{\\text{neutral}} = \\frac{P_n}{P_s} $$\n    预期的中性非同义固定差异数量 $D_{n, \\text{neutral}}$ 是：\n    $$ D_{n, \\text{neutral}} = D_s \\times \\frac{P_n}{P_s} $$\n    适应性非同义固定数量 $D_{n, \\text{adaptive}}$ 是观测总数减去中性预期：\n    $$ D_{n, \\text{adaptive}} = D_n - D_{n, \\text{neutral}} = D_n - D_s \\frac{P_n}{P_s} $$\n    比例 $\\hat{\\alpha}$ 是适应性固定数量与非同义固定总数的比率：\n    $$ \\hat{\\alpha} = \\frac{D_{n, \\text{adaptive}}}{D_n} = \\frac{D_n - D_s \\frac{P_n}{P_s}}{D_n} = 1 - \\frac{D_s P_n}{D_n P_s} $$\n    此公式等价于 $1 - \\frac{1}{\\text{OR}}$。\n    将给定的数值代入 $\\hat{\\alpha}$ 的公式中：\n    $$ \\hat{\\alpha} = 1 - \\frac{200 \\times 40}{120 \\times 100} = 1 - \\frac{8000}{12000} = 1 - \\frac{8}{12} = 1 - \\frac{2}{3} $$\n    $$ \\hat{\\alpha} = \\frac{1}{3} $$\n    问题要求此值为小数，并保留四位有效数字。\n    $$ \\hat{\\alpha} \\approx 0.333333... $$\n    保留四位有效数字得到 $0.3333$。这一结果意味着，在这些物种间固定的非同义替换中，估计有 $33.33\\%$ 是由正选择驱动的。",
            "answer": "$$\\boxed{0.3333}$$"
        },
        {
            "introduction": "在掌握了基本计算之后，理解 MK 检验的内在假设和潜在的混淆因素至关重要。第二个练习  提出了一个在基因组演化中常见的复杂情况：旁系同源基因之间的基因转换。这个练习将挑战您批判性地思考，在一个功能受约束的基因上进行的 MK 检验，其结果如何被来自一个假基因的序列片段所影响，从而产生一个可能被误解的选择信号。",
            "id": "1971652",
            "problem": "一位演化生物学家正在研究两种亲缘关系很近的果蝇（*Drosophila alpha* 和 *Drosophila beta*）中的一个基因家族。一个我们称之为 `Anc-G` 的基因，在一个遥远的共同祖先中发生了重复，产生了两个旁系同源基因 `G1` 和 `G2`，这两个基因都存在于这两个物种中。\n\n根据之前的实验，已知 `G1` 基因的产物对胚胎发育至关重要，并处于强大的功能限制之下，这意味着它受到强烈的纯化选择。相比之下，`G2` 基因在这两个谱系中都已成为一个无功能的假基因。作为一个假基因，数百万年来，`G2` 一直以中性速率累积同义和非同义突变。\n\n研究人员对来自20个 *D. alpha* 个体和1个 *D. beta* 个体的 `G1` 基因的编码区进行了测序。然后，他们进行了一项麦当劳-克雷特曼（MK）检验，以分析作用于 `G1` 的选择模式。MK检验比较了物种内的非同义与同义多态性之比（$P_n/P_s$）和物种间的非同义与同义固定差异之比（$D_n/D_s$）。该检验的一个关键假设是，在所研究的基因座上，突变是独立发生的。\n\n然而，在这个基因家族中，已知存在低频率的非等位基因转换，这是一个来自 `G2` 假基因的DNA序列偶尔替换功能性 `G1` 基因的同源序列的过程。这些转换后的片段随后作为新的等位基因在 *D. alpha* 种群中分离。\n\n鉴于此场景，以下哪种说法最准确地描述了来自假基因 `G2` 的基因转换对功能受限的 `G1` 基因的MK检验解释所产生的预期混淆效应？\n\nA. 该过程将大量来自 `G2` 的有害非同义变异引入 `G1` 基因库。这相对于 $P_s$ 夸大了 $P_n$ 的计数，而作用于 `G1` 的强纯化选择阻止了这些变异达到固定，使 $D_n$ 保持在较低水平。结果是比率 $(P_n/P_s) / (D_n/D_s) > 1$，产生了一个平衡选择或多样化选择的伪信号。\n\nB. 基因转换事件将主要增加物种间的固定差异数量（$D_n$和$D_s$），因为相同的转换事件不太可能在两个谱系中都发生。这导致MK检验统计量的分母膨胀，模拟了强纯化选择的特征。\n\nC. 转换过程从多样化的 `G2` 基因库中引入了有利的非同义变异。这些变异在 `G1` 基因中被迅速推向固定。这夸大了 $D_n$ 的计数，导致比率 $(P_n/P_s) / (D_n/D_s) < 1$，并产生了一个正向（定向）选择的伪信号。\n\nD. 基因转换同时引入了同义和非同义突变，但由于 `G1` 基因受到强纯化选择，所有这些新等位基因都将过快地从种群中被清除，以至于无法被检测为多态性或固定。因此，基因转换对MK检验结果没有显著影响。\n\nE. 该过程将同等地夸大非同义和同义位点的多态性和分化，因为基因转换机制本身没有歧视性。这将按比例增加所有四个计数（$P_n, P_s, D_n, D_s$），使得总的检验统计量 $(P_n/P_s) / (D_n/D_s)$ 接近1，从而导致中性解释。",
            "solution": "我们分析来自一个退化假基因的非等位基因转换如何影响作用于一个功能性、强约束基因的麦克唐纳-克雷特曼（MK）框架的各个组成部分。\n\n首先，MK检验比较了物种内的多态性比率 $P_n/P_s$ 与物种间的分化比率 $D_n/D_s$。在中性及突变来源独立的条件下，这些比率预期是相似的，因此检验统计量 $(P_n/P_s)/(D_n/D_s)$ 预期接近于 $1$。\n\n在当前系统中，$G1$ 受到强纯化选择，而 $G2$ 是一个假基因，它以大致中性的速率累积了同义和非同义替换。非等位基因转换偶尔会将 $G2$ 的一段序列复制到 $G1$ 中，一次性引入多个差异。由于 $G2$ 已经累积了许多在 $G1$ 的功能背景下会有害的非同义变化，因此预期转换片段会向 $G1$ 的等位基因库中引入过量的非同义变异。\n\n这些转换后的等位基因通常：\n- 作为多态性进入 $G1$ 种群，增加了 $P_n$（以及在较小程度上增加了 $P_s$），因为引入的片段通常包含多个变化，其中许多在编码区是非同义的。\n- 被作用于 $G1$ 的纯化选择有效清除，这阻止了这些非同义变异达到固定；因此，$D_n$ 不会相应增加。\n- 不会系统地增加 $D_s$ 到足以抵消 $P_n/P_s$ 升高的程度，因为同义差异可以漂变，但在一个典型片段内，相对于有害非同义变化的负荷，其数量较少，并且有害片段任何部分的固定都会因连锁的非同义位点上的选择而不利。\n\n因此，物种内的比率 $P_n/P_s$ 被夸大，而物种间的比率 $D_n/D_s$ 对 $G1$ 来说保持相对较低，从而产生\n$$\n\\frac{P_n/P_s}{D_n/D_s} > 1,\n$$\n这模拟了一种通常被解释为平衡选择或多样化选择的信号，即使真正的作用力是纯化选择加上来自 $G2$ 的类似基因渗入的有害变异输入。这构成了对MK检验关于突变在 $G1$ 内独立产生的假设的混淆性违背。\n\n因此，与这些预期最匹配的描述是，说明来自 $G2$ 的基因转换因纯化选择而夸大了 $P_n$ 同时保持 $D_n$ 较低，产生了 $(P_n/P_s)/(D_n/D_s) > 1$ 和一个伪非中性信号。\n\n这对应于选项A，而选项B、C、D和E则错误地描述了在纯化选择下转换变异的命运，或错误描述了对多态性与分化效应的对称性。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "最后一个练习将带您进入该领域的前沿，探索经典 MK 检验的理论局限性 。标准 $\\hat{\\alpha}$ 估计值的一个核心问题是其对种群中普遍存在的弱有害突变的敏感性，这些突变不成比例地增加了多态性水平，从而导致对正选择的低估。通过这个练习，您将从第一性原理出发，推导当考虑更现实的适应度效应分布 (DFE) 时，$\\hat{\\alpha}$ 估计值中产生的偏差，从而深刻理解驱动现代基于DFE的方法发展的理论基础。",
            "id": "2731698",
            "problem": "一个有效大小恒定为 $N_e$ 的二倍体种群在基因选择下演化，其突变率较低，因此新突变是罕见的且互不干扰。考虑一个具有 $L_s$ 个同义位点和 $L_n$ 个非同义位点的基因，其每个位点的突变率分别为 $\\mu_s$ 和 $\\mu_n$。同义突变是中性的。非同义突变以三峰分布的形式出现：一部分比例为 $p_b$ 的突变是有益的，一部分比例为 $p_0$ 的是有效中性的，剩余比例为 $q = 1 - p_b - p_0$ 的是有害的，其具有一个在负选择系数上支撑的连续的适合度效应分布（DFE）。假设有益突变清除得很快，因此在抽样的时间尺度上，它们对现有多态性的贡献可以忽略不计，但它们相对于中性突变的固定概率被一个恒定因子 $\\rho_b > 1$ 提高（即，每个突变相对于中性突变的固定概率乘以 $\\rho_b$）。对于有害的非同义突变，定义两个相对于中性的、经DFE平均的无量纲衰减因子：\n- $c_p \\in (0,1)$：一个有害非同义突变相对于一个中性突变对预期多态性的平均贡献，通过在有害效应的DFE上积分得到。\n- $c_d \\in (0,1)$：一个有害非同义突变相对于一个中性突变对预期分化（固定）的平均贡献，通过在有害效应的DFE上积分得到。\n\n在 McDonald–Kreitman 框架内进行分析，该框架通过比较非同义与同义多态性和分化的比率来推断适应性非同义替换的比例。仅使用基本原理：(i) 类别 $x \\in \\{s,n\\}$ 的预期多态性与 $4 N_e \\mu_x L_x$ 成比例，再乘以一个特定于类别、依赖于选择的因子，该因子在中性条件下平均为 $1$；(ii) 类别 $x$ 的预期分化与 $\\mu_x L_x$ 成比例，再乘以一个特定于类别、依赖于选择的固定因子，该因子在中性条件下等于 $1$，对于有益变化大于 $1$，对于有害变化小于 $1$；(iii) 混合物中每个组分对多态性或分化的贡献由其混合比例加权。\n\n1. 以 $p_b$、$p_0$、$q$、$c_p$、$c_d$ 和 $\\rho_b$ 为参数，推导预期比率 $P_n/P_s$ 和 $D_n/D_s$ 的符号表达式，其中 $P_x$ 和 $D_x$ 分别表示在类别 $x$ 的预期多态位点数和固定差异数。\n2. 使用这些表达式和 McDonald–Kreitman 方法的标准比率之比逻辑，写出忽略有害 DFE 的朴素估计量 $\\hat{\\alpha}_{\\mathrm{naive}}$（即，将所有非同义多态性都视为由中性突变引起），并与之对比，写出真实的适应性比例 $\\alpha_{\\mathrm{true}}$，其定义为所有非同义固定中适应性非同义固定的比例。\n3. 以 $p_b$、$p_0$、$q$、$c_p$、$c_d$ 和 $\\rho_b$ 为参数，推导偏差 $B = \\hat{\\alpha}_{\\mathrm{naive}} - \\alpha_{\\mathrm{true}}$ 的封闭形式表达式。尽可能地简化。\n4. 对于参数集 $p_b = 0.02$，$p_0 = 0.18$，$q = 0.80$，$c_p = 0.50$，$c_d = 0.01$ 和 $\\rho_b = 10$，计算 $B$ 的值。提供 $B$ 的最终数值答案，四舍五入到四位有效数字。将最终答案表示为纯数（无量纲）。",
            "solution": "我们从第一性原理出发，探讨在一个突变率低的大型恒定种群中，多态性和分化如何随选择和突变而变化。\n\n设 $P_x$ 表示在标准化样本中观察到的类别 $x \\in \\{s,n\\}$ 的预期多态位点数（或率），设 $D_x$ 表示在标准化分化时间内累积的预期固定差异数（或率）。在具有罕见突变的无限位点近似下，我们有：\n\n- 预期多态性与以下表达式成比例\n$$\nP_x \\propto 4 N_e \\mu_x L_x \\times \\Phi_x,\n$$\n其中 $\\Phi_x$ 是一个无量纲因子，对于中性突变等于 $1$，对于受选择的突变则减小（在我们的设定中，有益突变由于清除迅速，对现有多态性的贡献可以忽略不计）。\n\n- 预期分化与以下表达式成比例\n$$\nD_x \\propto \\mu_x L_x \\times F_x,\n$$\n其中 $F_x$ 是一个无量纲的固定因子，对于中性突变等于 $1$，对于有益突变大于 $1$，对于有害突变小于 $1$。\n\n由于 McDonald–Kreitman (MK) 方法使用比率 $P_n/P_s$ 和 $D_n/D_s$，许多常数项会抵消。我们现在通过将非同义贡献分解到不同的效应混合中来表达这些比率。\n\n同义类别 ($s$)：根据假设，所有同义突变都是中性的。因此，\n$$\n\\Phi_s = 1, \\quad F_s = 1.\n$$\n\n非同义类别 ($n$)：该混合物有三个组分：\n\n- 有益部分 $p_b$：对多态性的贡献可以忽略不计，因此其多态性因子近似为 $0$。对于分化，相对于中性的固定因子为 $\\rho_b > 1$。\n\n- 中性部分 $p_0$：对多态性和分化都有完全贡献，因子均为 $1$。\n\n- 有害部分 $q = 1 - p_b - p_0$：对多态性的贡献平均因子为 $c_p \\in (0,1)$，对分化的贡献平均因子为 $c_d \\in (0,1)$，每个因子都是通过在负效应的 DFE 上对适当的依赖于选择的权重进行积分得到的。\n\n因此，除去特定于类别的突变-位点常数，非同义因子为：\n$$\n\\Phi_n = p_0 \\cdot 1 + q \\cdot c_p + p_b \\cdot 0 = p_0 + q c_p,\n$$\n$$\nF_n = p_0 \\cdot 1 + q \\cdot c_d + p_b \\cdot \\rho_b = p_0 + q c_d + p_b \\rho_b.\n$$\n\n因此，预期的 MK 比率为\n$$\n\\frac{P_n}{P_s} = \\frac{4 N_e \\mu_n L_n \\, \\Phi_n}{4 N_e \\mu_s L_s \\, \\Phi_s} = \\frac{\\mu_n L_n}{\\mu_s L_s} \\left(p_0 + q c_p\\right),\n$$\n$$\n\\frac{D_n}{D_s} = \\frac{\\mu_n L_n \\, F_n}{\\mu_s L_s \\, F_s} = \\frac{\\mu_n L_n}{\\mu_s L_s} \\left(p_0 + q c_d + p_b \\rho_b\\right).\n$$\n\n标准的 MK 逻辑通过比较这些比率来构建适应性非同义替换比例的估计量。忽略有害 DFE 的朴素估计量将非同义多态性视为仅由中性突变引起。在比率之比的形式中，朴素估计量为\n$$\n\\hat{\\alpha}_{\\mathrm{naive}} \\;=\\; 1 \\;-\\; \\frac{P_n/P_s}{D_n/D_s} \\;=\\; 1 \\;-\\; \\frac{p_0 + q c_p}{p_0 + q c_d + p_b \\rho_b},\n$$\n其中特定于类别的常数 $\\mu_x L_x$ 被抵消。\n\n根据定义，非同义固定中的真实适应性比例是适应性非同义固定在所有非同义固定中所占的比例：\n$$\n\\alpha_{\\mathrm{true}} \\;=\\; \\frac{\\text{适应性非同义固定}}{\\text{所有非同义固定}}\n\\;=\\; \\frac{p_b \\rho_b}{p_0 + q c_d + p_b \\rho_b}.\n$$\n\n我们现在推导偏差\n$$\nB \\;=\\; \\hat{\\alpha}_{\\mathrm{naive}} - \\alpha_{\\mathrm{true}} \\;=\\; \\left[1 - \\frac{p_0 + q c_p}{p_0 + q c_d + p_b \\rho_b}\\right] \\;-\\; \\frac{p_b \\rho_b}{p_0 + q c_d + p_b \\rho_b}.\n$$\n将各项合并到共同分母 $T = p_0 + q c_d + p_b \\rho_b$ 上：\n$$\nB \\;=\\; 1 \\;-\\; \\frac{p_0 + q c_p + p_b \\rho_b}{T} \\;=\\; \\frac{T - \\left(p_0 + q c_p + p_b \\rho_b\\right)}{T}.\n$$\n由于 $T = p_0 + q c_d + p_b \\rho_b$，分子简化为\n$$\n\\left(p_0 + q c_d + p_b \\rho_b\\right) - \\left(p_0 + q c_p + p_b \\rho_b\\right) \\;=\\; q \\left(c_d - c_p\\right).\n$$\n因此，偏差的封闭形式为\n$$\nB \\;=\\; \\frac{q \\left(c_d - c_p\\right)}{p_0 + q c_d + p_b \\rho_b}.\n$$\n因为对于有害突变，$c_p > c_d$（它们对多态性的贡献相对大于对分化的贡献），所以分子 $q(c_d - c_p)$ 为负，因此 $B < 0$。因此，忽略有害的 DFE 会使朴素估计量产生向下的偏差。\n\n最后，使用指定的参数 $p_b = 0.02$，$p_0 = 0.18$，$q = 0.80$，$c_p = 0.50$，$c_d = 0.01$ 和 $\\rho_b = 10$ 计算 $B$ 的值：\n$$\n\\text{分子} = q(c_d - c_p) = 0.80 \\times (0.01 - 0.50) = 0.80 \\times (-0.49) = -0.392.\n$$\n$$\n\\text{分母} = p_0 + q c_d + p_b \\rho_b = 0.18 + 0.80 \\times 0.01 + 0.02 \\times 10 = 0.18 + 0.008 + 0.20 = 0.388.\n$$\n因此，\n$$\nB = \\frac{-0.392}{0.388} = -\\frac{392}{388} = -\\frac{98}{97} \\approx -1.010309278\\ldots\n$$\n四舍五入到四位有效数字，结果是 $-1.010$。",
            "answer": "$$\\boxed{-1.010}$$"
        }
    ]
}