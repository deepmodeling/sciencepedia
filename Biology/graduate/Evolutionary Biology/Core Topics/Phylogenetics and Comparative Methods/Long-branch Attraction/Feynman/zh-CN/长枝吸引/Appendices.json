{
    "hands_on_practices": [
        {
            "introduction": "这项实践将带领我们深入长枝吸引现象的数学核心。通过在一个简化的演化模型下进行推导，我们将精确计算出一个因趋同演化而错误地支持不正确系统发育树拓扑的位点模式所出现的概率。这个练习旨在从第一性原理出发，让我们定量地理解同形择优（homoplasy）是如何产生并积累虚假的系统发育信号的。",
            "id": "2729155",
            "problem": "考虑一个无根的 $4$-分类单元树，其真实拓扑为 $((A,B),(C,D))$，在具有均匀平稳分布的 Cavender–Farris–Neyman (CFN) 双态对称连续时间马尔可夫模型下演化。设通往分类单元 $A$ 和 $C$ 的两个外部支为长度相等的长枝，长度为 $t_{L}$；通往分类单元 $B$ 和 $D$ 的两个外部支为长度相等的短枝，长度为 $t_{S}$；单一内部边的长度为 $t_{I}$。所有边都以相同的瞬时替换速率 $\\lambda>0$ 演化。在 CFN 模型下，对于长度为 $t$ 的边，其转移矩阵的元素为\n$$\nP(\\text{same} \\mid t) \\;=\\; \\frac{1+\\exp(-2\\lambda t)}{2}, \n\\qquad\nP(\\text{different} \\mid t) \\;=\\; \\frac{1-\\exp(-2\\lambda t)}{2}.\n$$\n由于长枝上的多次替换而产生的同源异形，可以产生一种简约信息性的 $2$–$2$ 位点模式，其中 $A$ 和 $C$ 共享一种状态，而 $B$ 和 $D$ 共享相反的状态。在最大简约法下，这种模式会错误地支持不正确的分割 $A\\!C \\mid B\\!D$，这是长枝吸引现象的一种表现。\n\n仅从上述定义和树上的马尔可夫性质出发，推导在该模型下一个随机演化的位点产生 $A\\!C \\mid B\\!D$ 类型（即 $A=C\\neq B=D$）的简约信息性模式的每位点概率的闭式解析表达式，该表达式是关于 $t_{L}$、$t_{S}$、$t_{I}$ 和 $\\lambda$ 的函数。将您的最终答案表示为关于 $t_{L}$、$t_{S}$、$t_{I}$ 和 $\\lambda$ 的单一简化表达式。不需要进行数值计算，也无需报告单位。",
            "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- **模型**：Cavender–Farris–Neyman (CFN) 双态对称连续时间马尔可夫模型。\n- **平稳分布**：均匀分布，每个状态的概率为 $\\pi_i = \\frac{1}{2}$。\n- **拓扑**：无根四分类单元树，真实拓扑为 $((A,B),(C,D))$，这意味着存在一条中心边将分类单元集合 $\\{A,B\\}$ 与 $\\{C,D\\}$ 分开。\n- **支长**：\n    - 通往 $A$ 和 $C$ 的外部支长度为 $t_{L}$。\n    - 通往 $B$ 和 $D$ 的外部支长度为 $t_{S}$。\n    - 单一内部边长度为 $t_{I}$。\n- **速率参数**：所有边共享一个瞬时替换速率 $\\lambda > 0$。\n- **转移概率**：对于长度为 $t$ 的边：\n    - 不发生变化（或偶数次替换）的概率：$P(\\text{same} \\mid t) = \\frac{1+\\exp(-2\\lambda t)}{2}$。\n    - 发生变化（或奇数次替换）的概率：$P(\\text{different} \\mid t) = \\frac{1-\\exp(-2\\lambda t)}{2}$。\n- **目标**：推导观察到位点模式 $A=C\\neq B=D$ 的每位点概率的闭式解析表达式，该表达式是关于 $t_{L}$、$t_{S}$、$t_{I}$和$\\lambda$的函数。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题具有科学依据。CFN 模型是演化生物学中的一个基本模型，而长枝吸引是系统发育推断中一个有据可查的人工产物。该问题要求在此既定框架内进行严格的数学推导。\n- **良定性**：该问题是良定的。模型、其参数、树拓扑和支长都已明确定义。目标是计算一个特定的概率，对此应该存在唯一解。\n- **客观性**：语言精确、技术性强，没有主观或含糊的术语。\n\n**步骤3：结论与行动**\n该问题是有效的。这是理论系统发育学中一个标准的、非平凡的问题，需要从第一性原理进行推导。我将继续进行解答。\n\n拓扑为 $((A,B),(C,D))$ 的无根树有两个内部节点。我们将其表示为 $U$ 和 $V$。分类单元 $A$ 和分类单元 $B$ 连接到节点 $U$。分类单元 $C$ 和分类单元 $D$ 连接到节点 $V$。内部边连接节点 $U$ 和 $V$。因此，支长为：$t_{AU} = t_{L}$，$t_{BU} = t_{S}$，$t_{CV} = t_{L}$，$t_{DV} = t_{S}$ 以及 $t_{UV} = t_{I}$。\n\n我们希望计算位点模式为 $A=C$ 且 $B=D$，但 $A \\neq B$ 的概率。设两种状态为 $0$ 和 $1$。所求事件是两个不相交的基本事件的并集：$\\{S_A=0, S_C=0, S_B=1, S_D=1\\}$ 和 $\\{S_A=1, S_C=1, S_B=0, S_D=0\\}$，其中 $S_X$ 是分类单元 $X$ 处的状态。\n\n由于 CFN 模型的对称性，状态之间的转移速率相等且平稳分布是均匀的，所以这两个基本事件的概率是相同的。因此，我们可以计算其中一个事件的概率，然后乘以 $2$。\n设 $P_{pattern} = P(S_A=C \\neq S_B=D) = 2 \\times P(S_A=0, S_C=0, S_B=1, S_D=1)$。\n\n为了计算这个联合概率，我们使用全概率定律，对内部节点 $U$ 和 $V$ 的所有可能状态进行边缘化。设 $S_U$ 和 $S_V$ 是这些节点处的状态。\n$$P(S_A=0, S_C=0, S_B=1, S_D=1) = \\sum_{i \\in \\{0,1\\}} \\sum_{j \\in \\{0,1\\}} P(S_A=0, S_C=0, S_B=1, S_D=1, S_U=i, S_V=j)$$\n假设该过程处于平衡状态。因此，我们可以将树在任意节点定根来计算联合概率。让我们在节点 $U$ 处定根。根据树上的马尔可夫性质，给定内部节点的状态，叶节点的状态是条件独立的。联合概率变为：\n$$P(S_A=0,...) = \\sum_{i,j} P(S_U=i) P(S_A=0|S_U=i) P(S_B=1|S_U=i) P(S_V=j|S_U=i) P(S_C=0|S_V=j) P(S_D=1|S_V=j)$$\n平稳分布是均匀的，所以对于 $i \\in \\{0,1\\}$，$P(S_U=i) = \\frac{1}{2}$。\n我们定义 $p(t) = P(\\text{same} | t) = \\frac{1+\\exp(-2\\lambda t)}{2}$ 和 $q(t) = P(\\text{different} | t) = \\frac{1-\\exp(-2\\lambda t)}{2}$。\n\n构型 $(S_A=0, S_C=0, S_B=1, S_D=1)$ 的总概率是四项之和：\n第1项 ($S_U=0, S_V=0$):\n$\\frac{1}{2} P(S_A=0|S_U=0) P(S_B=1|S_U=0) P(S_V=0|S_U=0) P(S_C=0|S_V=0) P(S_D=1|S_V=0)$\n$= \\frac{1}{2} p(t_L) q(t_S) p(t_I) p(t_L) q(t_S) = \\frac{1}{2} p(t_L)^2 q(t_S)^2 p(t_I)$。\n\n第2项 ($S_U=0, S_V=1$):\n$\\frac{1}{2} P(S_A=0|S_U=0) P(S_B=1|S_U=0) P(S_V=1|S_U=0) P(S_C=0|S_V=1) P(S_D=1|S_V=1)$\n$= \\frac{1}{2} p(t_L) q(t_S) q(t_I) q(t_L) p(t_S)$。\n\n第3项 ($S_U=1, S_V=0$):\n$\\frac{1}{2} P(S_A=0|S_U=1) P(S_B=1|S_U=1) P(S_V=0|S_U=1) P(S_C=0|S_V=0) P(S_D=1|S_V=0)$\n$= \\frac{1}{2} q(t_L) p(t_S) q(t_I) p(t_L) q(t_S)$。\n\n第4项 ($S_U=1, S_V=1$):\n$\\frac{1}{2} P(S_A=0|S_U=1) P(S_B=1|S_U=1) P(S_V=1|S_U=1) P(S_C=0|S_V=1) P(S_D=1|S_V=1)$\n$= \\frac{1}{2} q(t_L) p(t_S) p(t_I) q(t_L) p(t_S) = \\frac{1}{2} q(t_L)^2 p(t_S)^2 p(t_I)$。\n\n将这四项相加得到 $P(S_A=0, S_C=0, S_B=1, S_D=1)$：\n$$ \\frac{1}{2} \\left[ p(t_I) (p(t_L)^2 q(t_S)^2 + q(t_L)^2 p(t_S)^2) + q(t_I) (2 p(t_L) q(t_L) p(t_S) q(t_S)) \\right] $$\n该模式的总概率是这个值的两倍：\n$$P_{pattern} = p(t_I) (p(t_L)^2 q(t_S)^2 + q(t_L)^2 p(t_S)^2) + q(t_I) (2 p(t_L) q(t_L) p(t_S) q(t_S))$$\n为了简化，令 $X = p(t_L)q(t_S)$ 和 $Y = q(t_L)p(t_S)$。表达式变为 $p(t_I)(X^2+Y^2) + q(t_I)(2XY)$。\n令 $E_t = \\exp(-2\\lambda t)$。那么 $p(t) = \\frac{1+E_t}{2}$ 且 $q(t) = \\frac{1-E_t}{2}$。\n表达式为 $\\frac{1+E_I}{2}(X^2+Y^2) + \\frac{1-E_I}{2}(2XY) = \\frac{1}{2}[(X^2+Y^2+2XY) + E_I(X^2+Y^2-2XY)] = \\frac{1}{2}[(X+Y)^2 + E_I(X-Y)^2]$。\n\n现在我们计算 $X+Y$ 和 $X-Y$：\n$X+Y = p(t_L)q(t_S) + q(t_L)p(t_S) = \\frac{1+E_L}{2}\\frac{1-E_S}{2} + \\frac{1-E_L}{2}\\frac{1+E_S}{2} = \\frac{1}{4}[(1-E_S+E_L-E_LE_S) + (1+E_S-E_L-E_LE_S)] = \\frac{2-2E_LE_S}{4} = \\frac{1-E_LE_S}{2} = q(t_L+t_S)$。\n\n$X-Y = p(t_L)q(t_S) - q(t_L)p(t_S) = \\frac{1}{4}[(1-E_S+E_L-E_LE_S) - (1+E_S-E_L-E_LE_S)] = \\frac{2E_L-2E_S}{4} = \\frac{E_L-E_S}{2}$。\n\n将这些代回到 $P_{pattern}$ 的表达式中：\n$$P_{pattern} = \\frac{1}{2} \\left[ (q(t_L+t_S))^2 + E_I \\left(\\frac{E_L-E_S}{2}\\right)^2 \\right]$$\n现在，代入 $q$、$E_I$、$E_L$ 和 $E_S$ 的定义：\n$q(t_L+t_S) = \\frac{1-\\exp(-2\\lambda(t_L+t_S))}{2}$。\n$E_I = \\exp(-2\\lambda t_I)$，$E_L = \\exp(-2\\lambda t_L)$，$E_S = \\exp(-2\\lambda t_S)$。\n$$P_{pattern} = \\frac{1}{2} \\left[ \\left(\\frac{1-\\exp(-2\\lambda(t_L+t_S))}{2}\\right)^2 + \\exp(-2\\lambda t_I) \\left(\\frac{\\exp(-2\\lambda t_L) - \\exp(-2\\lambda t_S)}{2}\\right)^2 \\right]$$\n简化表达式：\n$$P_{pattern} = \\frac{1}{2} \\cdot \\frac{1}{4} \\left[ (1-\\exp(-2\\lambda(t_L+t_S)))^2 + \\exp(-2\\lambda t_I) (\\exp(-2\\lambda t_L) - \\exp(-2\\lambda t_S))^2 \\right]$$\n$$P_{pattern} = \\frac{1}{8} \\left[ (1-\\exp(-2\\lambda(t_L+t_S)))^2 + \\exp(-2\\lambda t_I) (\\exp(-2\\lambda t_L) - \\exp(-2\\lambda t_S))^2 \\right]$$\n这就是所求概率的最终闭式表达式。",
            "answer": "$$\\boxed{\\frac{1}{8} \\left[ \\left(1 - \\exp(-2\\lambda(t_{L} + t_{S})) \\right)^{2} + \\exp(-2\\lambda t_{I}) \\left(\\exp(-2\\lambda t_{L}) - \\exp(-2\\lambda t_{S})\\right)^{2} \\right]}$$"
        },
        {
            "introduction": "在我们理解了同形择优信号的来源之后，本练习将探讨为何不同的系统发育推断方法对此信号的反应截然不同。我们将分析一个经典的“Felsenstein区”情景，旨在对比最大简约法（Maximum Parsimony）和最大似然法（Maximum Likelihood）的渐近行为。这项实践对于掌握统计一致性这一关键概念，并据此在研究中有依据地选择推断方法至关重要。",
            "id": "2729158",
            "problem": "考虑一个在 Jukes–Cantor 1969 (JC69) 模型下生成的无根四元树 $T^{\\star} = ((A,B),(C,D))$，其瞬时速率为 $\\mu > 0$，所有位点独立同分布 (i.i.d.)，且分支长度如下：与分类单元 $A$ 和 $C$ 相连的悬垂分支长度为 $t_{L} > 0$（长），与分类单元 $B$ 和 $D$ 相连的悬垂分支长度为 $t_{S} > 0$（短），唯一的内部分支长度为 $t_{I} > 0$（短）。假设该过程是稳态且时间同质的。在 JC69 模型下，对于任意长度为 $t$ 的分支，其转移概率为\n$$\nP_{ii}(t) = \\tfrac{1}{4} + \\tfrac{3}{4} e^{-4\\mu t/3}, \\quad P_{ij}(t) = \\tfrac{1}{4}\\left(1 - e^{-4\\mu t/3}\\right) \\ \\text{for} \\ i \\neq j,\n$$\n并且在长度为 $t$ 的分支上发生任意变化的概率为 $p(t) = \\tfrac{3}{4}\\left(1 - e^{-4\\mu t/3}\\right)$，而不发生变化的概率为 $q(t) = 1 - p(t) = \\tfrac{1}{4} + \\tfrac{3}{4} e^{-4\\mu t/3}$。令 $n$ 表示位点数，并考虑 $n \\to \\infty$ 的渐近状态。\n\n系统发育学中的四元树范式通过首先为每 $\\binom{N}{4}$ 个四元组推断一个无根拓扑，然后通过一个超级树算法合并得到的四元树，来重建一个包含 $N$ 个分类单元的大树。两种四元树推断方法很常见：最大简约法 (MP)，它选择能使观测位点所隐含的总变化数最小化的拓扑；以及最大似然法 (ML)，在 JC69 模型下，它选择能使模型下位点的联合似然最大化的拓扑和分支长度。\n\n当 $t_{L}$ 足够大且 $t_{I}$ 足够小（即 Felsenstein 区）时，以下哪项陈述最能描述 MP 和 ML 在四元树 $T^{\\star}$ 上的渐近行为，及其对基于四元树重建更大树木的影响？\n\nA. 存在 $t_L$ 足够大且 $t_I$ 足够小（$t_I>0$）的情况，使得当 $n \\to \\infty$ 时，MP 收敛到将长分支 $A$ 和 $C$ 组合在一起的错误四元树，而使用正确指定的 JC69 模型的 ML 对于真实四元树 $T^{\\star}$ 仍然是统计一致的。因此，使用 MP 作为四元树预言机可能会使超级树在实例化此类四元树的大树部分偏向于错误的解析。\n\nB. 当 $n \\to \\infty$ 时，由于同塑模式被平均掉，MP 在四元树上的长分支吸引现象消失，因此无论 $t_{L}$ 和 $t_{I}$ 如何，MP 和 ML 在 $T^{\\star}$ 上都是统计一致的。\n\nC. 在 Felsenstein 区，MP 和 ML 在 JC69 模型下的四元树上都是统计不一致的，因为趋同替换占主导地位，使得树拓扑对于任何方法都变得不可识别。\n\nD. 在四元树范式下，MP 和 ML 之间的选择在渐近意义上是无关紧要的：即使四元树预言机在某些四元树上是统计不一致的，$\\binom{N}{4}$ 个四元树之间的冗余性也确保了超级树在 $n \\to \\infty$ 时是统计一致的。",
            "solution": "首先将对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n- **模型**：Jukes–Cantor 1969 (JC69)。\n- **演化过程**：瞬时替换速率 $\\mu > 0$，位点独立同分布 (i.i.d.)，过程稳态且时间同质。\n- **树拓扑**：一个无根四元树 $T^{\\star} = ((A,B),(C,D))$。\n- **分支长度**：\n  - 与分类单元 $A$ 和 $C$ 相连的悬垂分支：长度 $t_{L} > 0$（长）。\n  - 与分类单元 $B$ 和 $D$ 相连的悬垂分支：长度 $t_{S} > 0$（短）。\n  - 内部分支：长度 $t_{I} > 0$（短）。\n- **转移概率 (JC69)**：对于长度为 $t$ 的分支：\n  - 在一个位点，特定核苷酸不发生替换的概率：$P_{ii}(t) = \\tfrac{1}{4} + \\tfrac{3}{4} e^{-4\\mu t/3}$。\n  - 在一个位点，发生特定替换 $i \\to j$ 的概率：$P_{ij}(t) = \\tfrac{1}{4}(1 - e^{-4\\mu t/3})$，其中 $i \\neq j$。\n- **衍生概率**：\n  - 在长度为 $t$ 的分支上发生任意变化的概率：$p(t) = \\tfrac{3}{4}(1 - e^{-4\\mu t/3})$。\n  - 在长度为 $t$ 的分支上不发生变化的概率：$q(t) = 1 - p(t) = \\tfrac{1}{4} + \\tfrac{3}{4} e^{-4\\mu t/3}$。\n- **渐近状态**：位点数 $n \\to \\infty$。\n- **推断背景**：基于四元树的超级树重建。\n- **推断方法**：\n  - 最大简约法 (MP)：选择能使数据所隐含的总替换数最小化的拓扑。\n  - 最大似然法 (ML)：选择在指定模型 (JC69) 下能使观测位点数据的联合概率（似然）最大化的拓扑和分支长度。\n- **问题**：描述 MP 和 ML 在“Felsenstein 区”（$t_L$ 大，$t_I$ 小）下对四元树 $T^{\\star}$ 的渐近行为（$n \\to \\infty$），及其对基于四元树的超级树方法的影响。\n\n### 步骤2：使用提取的已知条件进行验证\n根据科学和逻辑原则评估问题陈述。\n1.  **科学依据**：该问题建立在分子系统发育学的基础概念之上：Jukes-Cantor 模型、最大简约法、最大似然法以及长分支吸引 (LBA) 现象。所有定义和方程都是标准的且事实正确。\n2.  **问题的适定性**：问题询问的是两种明确定义的估计方法 (MP 和 ML) 在一个精确指定的概率模型和渐近状态下的统计一致性。这种结构允许基于已建立的理论得出一个唯一且有意义的解。\n3.  **客观性**：语言正式、精确，没有主观或模糊的术语。\n4.  **完整性与一致性**：问题提供了分析渐近行为所需的所有必要信息（模型、树结构、参数、方法）。问题陈述本身没有内部矛盾。选项不属于此验证步骤。\n5.  **相关性**：问题集中于长分支吸引，这是演化生物学中的一个关键课题。\n\n### 步骤3：结论与行动\n问题陈述在科学上是合理的、适定的且内部一致。因此，它是**有效的**。可以进行分析。\n\n---\n\n### 推导\n\n该问题的核心概念是统计一致性。如果随着位点数 $n$ 趋于无穷大，推断出真实拓扑的概率收敛于 $1$，那么该树拓扑的估计方法就是统计一致的。我们将分析在指定条件下最大简约法 (MP) 和最大似然法 (ML) 的一致性。\n\n真实的树是 $T^{\\star} = ((A,B),(C,D))$。由于通向分类单元 $A$ 和 $C$ 的长分支 $t_L$，长分支吸引现象可能导致推断方法错误地将分类单元 $A$ 和 $C$ 聚合在一起，从而得到拓扑 $T_{AC} = ((A,C),(B,D))$。\n\n**最大简约法 (MP) 分析**\n\n最大简约法通过选择需要最少数量的性状状态变化来解释观测数据的树拓扑。在 $n \\to \\infty$ 的渐近极限下，MP 将收敛到由最多简约信息位点支持的拓扑。\n\n如果一个位点至少有两种不同的性状状态，并且每种状态至少出现两次，那么对于一个四元组来说，该位点就是简约信息位点。例如，跨分类单元 $(A,B,C,D)$ 的位点模式 `GAGA` 是信息位点。对于此模式，拓扑 $((A,C),(B,D))$ 只需要一次变化，而另外两种拓扑 $((A,B),(C,D))$ 和 $((A,D),(B,C))$ 至少需要两次变化。因此，此模式支持 $((A,C),(B,D))$。\n\nFelsenstein 区由分支长度定义，其中 $t_L$ 大而 $t_I$ 小。\n- 长分支上发生变化的概率是 $p(t_L) = \\frac{3}{4}(1 - e^{-4\\mu t_L/3})$。当 $t_L \\to \\infty$ 时，$p(t_L) \\to 3/4$。\n- 短内部分支上发生变化的概率是 $p(t_I) = \\frac{3}{4}(1 - e^{-4\\mu t_I/3})$。当 $t_I \\to 0$ 时，$p(t_I) \\to 0$。\n\n让我们考虑支持真实树与支持错误地聚合长分支的树的位点的期望数量。\n- **对真实树 $T^{\\star} = ((A,B),(C,D))$ 的支持**：此拓扑最直接的证据来自支持分支 (A,B) 或 (C,D) 的共有衍征。这需要在内部分支 $t_I$ 上发生一次替换。此类事件的概率与 $p(t_I)$ 成正比。\n- **对错误树 $T_{AC} = ((A,C),(B,D))$ 的支持**：这棵树由同塑性支持，特别是平行或趋同替换。例如，在真实树 $T^{\\star}$ 上，可以通过两次独立的替换（一次在通向 $A$ 的分支上，一次在通向 $C$ 的分支上）来生成支持 $T_{AC}$ 的位点模式。这种联合事件的概率与 $p(t_L) \\times p(t_L) = p(t_L)^2$ 相关。\n\n在 Felsenstein 区，$t_L$ 大而 $t_I$ 小。因此，$p(t_L)$ 很大（接近 $3/4$），而 $p(t_I)$ 很小（接近 $0$）。Felsenstein (1978) 证明，存在一个参数空间区域，其中由于同塑性而支持错误树 $T_{AC}$ 的位点期望数超过了由于共有衍征而支持真实树 $T^{\\star}$ 的位点期望数。在此区域中，$E[\\text{支持 } T_{AC} \\text{的位点}] > E[\\text{支持 } T^{\\star} \\text{的位点}]$。\n\n根据大数定律，当 $n \\to \\infty$ 时，观测到的位点模式频率将收敛到其期望频率。因此，MP 将选择错误的拓扑 $T_{AC}$。这表明 MP 在这些条件下是统计不一致的。\n\n**最大似然法 (ML) 分析**\n\n最大似然法，当演化的生成模型被正确指定时（如此处使用 JC69 模型的情况），是一种统计一致的方法。如果模型是可识别的，则一致性得到保证，这意味着不同的树拓扑不能产生完全相同的位点模式概率分布。\n\n对于无根四分类单元树上的 JC69 模型，其拓扑是可识别的。这意味着对于真实树 $T^{\\star}$ 和任何不正确的树 $T' \\neq T^{\\star}$，不存在一组用于 $T'$ 的分支长度，能够使得数据在 $(T', \\text{lengths}')$ 下的似然在期望上等于数据在 $(T^{\\star}, \\text{true lengths})$ 下的似然。\n\nML 的原理是基于最大化全局似然函数。对数似然的期望值在真实参数值（拓扑和分支长度）处达到最大。当 $n \\to \\infty$ 时，样本对数似然函数收敛于其期望值。因此，最大化样本似然的拓扑将依概率收敛于真实的拓扑 $T^{\\star}$。ML 正确地考虑了长分支上的多重替换，并且不会像 MP 那样被同塑性误导。因此，即使在 Felsenstein 区，ML 也是统计一致的。\n\n**对基于四元树重建的影响**\n\n四元树范式依赖于一个“四元树预言机”来推断拓扑，然后将这些拓扑组装成一个超级树。如果这个预言机是统计不一致的，它将产生系统性偏差的结果。\n- 在真实树中具有 Felsenstein 区几何结构的区域使用 MP 作为预言机，将导致 MP 一致地报告错误的四元树拓扑 $((A,C),(B,D))$。\n- 这不是一个可以被平均掉的随机误差，而是一个系统误差。当超级树算法从跨越这部分树的所有四元树中接收到一致但错误的信号时，它将被偏向于，或被迫重建一个反映长分支聚合的错误大树。\n\n### 逐项分析\n\n**A. 存在 $t_L$ 足够大且 $t_I$ 足够小（$t_I>0$）的情况，使得当 $n \\to \\infty$ 时，MP 收敛到将长分支 $A$ 和 $C$ 组合在一起的错误四元树，而使用正确指定的 JC69 模型的 ML 对于真实四元树 $T^{\\star}$ 仍然是统计一致的。因此，使用 MP 作为四元树预言机可能会使超级树在实例化此类四元树的大树部分偏向于错误的解析。**\n- `MP 收敛到错误的四元树...`：如上所述，这是对 MP 因 LBA 而不一致的正确描述。\n- `ML... 仍然是统计一致的...`：如上所述，这也是正确的。\n- `因此，使用 MP 作为四元树预言机可能会使超级树偏向...`：这是使用系统性偏差方法进行子问题分析的正确逻辑后果。这些误差是系统性的，会破坏最终的超级树。\n- **结论：正确。**\n\n**B. 当 $n \\to \\infty$ 时，由于同塑模式被平均掉，MP 在四元树上的长分支吸引现象消失，因此无论 $t_{L}$ 和 $t_{I}$ 如何，MP 和 ML 在 $T^{\\star}$ 上都是统计一致的。**\n- `当 n -> infinity 时，MP 的长分支吸引现象消失...`：这根本上是错误的。LBA 正是一种渐近现象；它描述了当数据量趋于无穷时 MP 收敛到的错误拓扑。同塑模式不会“被平均掉”，而是会系统地误导该方法。\n- `无论 t_L 和 t_I 如何，MP 和 ML 都是统计一致的...`：这是错误的。MP 通常不具有一致性。\n- **结论：不正确。**\n\n**C. 在 Felsenstein 区，MP 和 ML 在 JC69 模型下的四元树上都是统计不一致的，因为趋同替换占主导地位，使得树拓扑对于任何方法都变得不可识别。**\n- `MP 和 ML 都是统计不一致的`：错误。使用正确模型的 ML 是一致的。\n- `使得树拓扑不可识别`：错误。四元树上的 JC69 模型是可识别的。高替换率使推断变得困难（即需要更多数据），但它们不会使拓扑对于一致的方法从根本上无法恢复。问题在于推断标准（简约法），而不在于模型固有的可识别性。\n- **结论：不正确。**\n\n**D. 在四元树范式下，MP 和 ML 之间的选择在渐近意义上是无关紧要的：即使四元树预言机在某些四元树上是统计不一致的，$\\binom{N}{4}$ 个四元树之间的冗余性也确保了超级树在 $n \\to \\infty$ 时是统计一致的。**\n- `MP 和 ML 之间的选择在渐近意义上是无关紧要的`：错误。它们的渐近行为根本不同（不一致 vs. 一致）。这个选择至关重要。\n- `冗余性... 确保了超级树是统计一致的`：错误。由 LBA 引起的误差是系统性的，而非随机的。如果在真实的 N 分类单元树中存在一个诱发 LBA 的特定几何结构，那么所有抽样到这些分支的四元树都将以相同的方式被错误推断。这种冗余性强化了系统误差，导致了一个不一致的超级树方法。\n- **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "最后的这项实践将理论应用到一个常见的分析挑战中：为系统发育树选择合适的根。我们将通过一个思想实验，评估不同外类群（outgroup）选择策略对长枝吸引风险的影响。这个练习旨在巩固我们的认知，即如何通过缜密的实验设计（如此处的选择近缘或多个外类群），来主动规避或减轻长枝吸引这一著名的人为误差（artifact）所带来的影响。",
            "id": "2729142",
            "problem": "您正在分析一个数据集，该数据集包含 $N$ 个在 Jukes and Cantor 替换模型 (JC$69$) 下生成的独立同分布的核苷酸位点，该模型具有相等的碱基频率和均一、平稳的过程。考虑一个由 $3$ 个分类单元 $\\{A,B,C\\}$ 组成的内群，其真实有根历史为 $((A,B),C)$，并且具有以下枝长（每个位点的期望替换数）：末端枝 $t_A = 0.10$、$t_B = 0.10$、$t_C = 1.80$，以及一个短的内群内部枝 $t_I = 0.05$。您必须选择如何使用外群为该内群定根，然后使用最大简约法 (MP) 推断其有根拓扑。根据定义，MP 会选择蕴含最小总替换数的拓扑，并且当 $N \\to \\infty$ 时，其会收敛于期望的简约分数。\n\n考虑以下三种连接在内群根节点处的外群取样策略：\n\n- 策略 $O_1$：从内群根节点到外群末端的单个远缘外群末端，枝长为 $t_{O_1} = 2.00$。\n- 策略 $O_2$：从内群根节点到外群末端的单个近缘外群末端，枝长为 $t_{O_2} = 0.15$。\n- 策略 $O_3$：两个近缘外群 $O_2$ 和 $O_3$ 形成一个分支：一个长度为 $t_S = 0.05$ 的短主干枝连接着两个末端外群枝，其长度分别为 $t_{O_2} = 0.15$ 和 $t_{O_3} = 0.15$。\n\n假设唯一的模型错误设定来源是在 JC$69$ 生成的数据上使用 MP；不存在位点间速率变异和成分异质性。长枝吸引 (LBA) 在此定义为：由于趋同替换，MP 倾向于将两个长而不相邻的枝组合在一起，通过将 $C$ 与外群联合而不是恢复真实的内群分支 $(A,B)$，从而导致错误的根位置。\n\n在这些条件下，当 $N \\to \\infty$ 时，关于外群选择和定根谬误的以下哪项陈述是正确的？\n\nA. 在策略 $O_1$ 下，MP 的一致性得到保证；较长的外群枝增加了无歧义共衍征的数量，因此最小化了 LBA 风险。\nB. 在策略 $O_2$ 下，相对于 $O_1$，缩短外群枝降低了 LBA 驱动的错误定根风险，因为它减少了 $C$ 和外群之间独立相似性（MP 会将其计为共享衍生状态）的出现速率。\nC. 在策略 $O_3$ 下，使用两个形成分支的近缘外群，通过将外群侧路径分解为多个短枝，进一步降低了 LBA 风险（相比于单个近缘外群），从而减少了通往 $C$ 的长内群枝与外群发生伪联合的机会。\nD. 对无根内群树（无外群）进行中点定根法消除了 LBA，因为将根置于最长路径的中心会自动校正谱系间的速率变异。\nE. 即使使用 JC$69$ 数据且 $N \\to \\infty$，在这种枝长配置下，MP 与策略 $O_1$ 也可能在统计上不一致，通过将 $C$ 与外群组合而不是恢复 $(A,B)$ 作为内群分支，从而错误地放置根的位置。",
            "solution": "对用户提供的问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- 位点数：$N$，独立同分布。\n- 演化模型：Jukes and Cantor $1969$ (JC$69$)，具有等碱基频率，均一且平稳的过程。\n- 真实有根内群拓扑：$((A,B),C)$。\n- 内群枝长（每个位点的期望替换数）：\n    - 通向 A 的末端枝：$t_A = 0.10$。\n    - 通向 B 的末端枝：$t_B = 0.10$。\n    - 通向 C 的末端枝：$t_C = 1.80$。\n    - 内群内部枝：$t_I = 0.05$。\n- 推断方法：最大简约法 (MP)。\n- 数据量：渐近极限，$N \\to \\infty$。\n- 用于定根的外群策略：\n    - 策略 $O_1$：单个远缘外群末端，从内群根节点起的枝长为 $t_{O_1} = 2.00$。\n    - 策略 $O_2$：单个近缘外群末端，从内群根节点起的枝长为 $t_{O_2} = 0.15$。\n    - 策略 $O_3$：两个近缘外群 $O_2$ 和 $O_3$ 组成一个分支，具有一个主干枝 $t_S = 0.05$ 和两个长度分别为 $t_{O_2} = 0.15$ 和 $t_{O_3} = 0.15$ 的末端枝。\n- 长枝吸引 (LBA) 的定义：MP 错误地将长而不相邻的枝组合在一起的倾向，导致将分类单元 C 与外群联合而不是恢复真实的内群分支 $(A,B)$ 的错误定根。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据充分**：该问题基于分子系统发育学的基本原理，即 JC$69$ 替换模型、最大简约法以及有充分文献记录的长枝吸引谬误。\n- **问题定义明确**：该问题在数学和概念上定义明确。它提供了真实的树、数据生成模型、特定的推断方法和精确的参数，从而允许对该方法的一致性进行严格分析。\n- **客观性**：该问题以精确、客观的语言陈述。术语 LBA 在该语境下有明确定义。\n\n**第 3 步：结论与行动**\n该问题是有效的。它提出了一个经典的“Felsenstein 区”情景，旨在测试对系统发育推断中统计不一致性的理解。有必要进行全面分析。\n\n**推导与选项分析**\n\n该问题要求分析最大简约法 (MP) 在无限数据 ($N \\to \\infty$) 极限下的性能，这是一个统计一致性的问题。如果给定足够的数据，MP 收敛于真实拓扑，则它是一致的。如果它收敛于不正确的拓扑，则它是不一致的。\n\nMP 不一致的主要原因是长枝吸引 (LBA)。在像 JC$69$ 这样的简单模型下，在长度为 $t$ 的枝上发生碱基替换的概率为 $p(t) = \\frac{3}{4}(1 - e^{-4t/3})$。对于长枝（大的 $t$），这个概率接近 $\\frac{3}{4}$，意味着枝末端的性状状态相对于起始端的状态几乎是随机的。当两个长枝在真实树中不相邻时，每个枝上大量独立的、趋同的替换可能被 MP 误解为共享衍生性状（共衍征），导致算法错误地将这两个枝组合在一起。\n\n真实有根树是 $(((A,B),C), \\text{外群})$。对于四个分类单元 $\\{A, B, C, O\\}$ 的情况，其无根拓扑是 $((A,B),(C,O))$。这个无根树的内部枝长度为 $t_I = 0.05$，它将 $\\{A,B\\}$ 的祖先节点与 $\\{C,O\\}$ 的祖先节点分开。分类单元 $A$ 和 $B$ 位于短的末端枝上（$t_A=0.10, t_B=0.10$），而分类单元 $C$ 位于一个非常长的末端枝上（$t_C=1.80$）。如果外群枝也很长，这是一个极易受 LBA 影响的非对称树。\n\n**选项 A 评估**\nA. 在策略 $O_1$ 下，MP 的一致性得到保证；较长的外群枝增加了无歧义共衍征的数量，因此最小化了 LBA 风险。\n\n策略 $O_1$ 引入了一个位于非常长的枝上的外群 $O_1$，$t_{O_1} = 2.00$。现在我们在真实树中有两个长而不相邻的枝：通向 $C$ 的枝（$t_C=1.80$）和通向 $O_1$ 的枝（$t_{O_1}=2.00$）。它们被一个非常短的内部枝（$t_I=0.05$）分开。这是诱发 LBA 的典型配置。在通向 $C$ 和 $O_1$ 的枝上大量随机、平行的变化将产生一个强大的、误导性的信号，该信号会淹没由短内部枝上少量变化所承载的真实系统发育信号。该策略非但不能保证一致性，反而几乎肯定会导致不一致。声称较长的外群枝有帮助是对 LBA 的根本误解。\n该陈述是**不正确**的。\n\n**选项 B 评估**\nB. 在策略 $O_2$ 下，相对于 $O_1$，缩短外群枝降低了 LBA 驱动的错误定根风险，因为它减少了 $C$ 和外群之间独立相似性（MP 会将其计为共享衍生状态）的出现速率。\n\n策略 $O_2$ 使用一个具有短枝长的近缘外群，$t_{O_2} = 0.15$。与策略 $O_1$ 相比，这从诱发 LBA 的组合中移除了两个长枝之一。虽然通向 $C$ 的枝仍然很长（$t_C=1.80$），但没有其他长枝可以“吸引”它。外群枝现在很短，因此其上的随机替换数量很少，从而大大降低了 $C$ 谱系和外群谱系之间发生趋同变化的可能性。所提供的推理——即减少枝长会降低 MP 误解的独立相似性（同塑性）的速率——是完全正确的。这是缓解由远缘外群引起的 LBA 的标准教科书解决方案。\n该陈述是**正确**的。\n\n**选项 C 评估**\nC. 在策略 $O_3$ 下，使用两个形成分支的近缘外群，通过将外群侧路径分解为多个短枝，进一步降低了 LBA 风险（相比于单个近缘外群），从而减少了通往 $C$ 的长内群枝与外群发生伪联合的机会。\n\n策略 $O_3$ 使用两个近缘外群 $(O_2, O_3)$ 形成一个分支。这是提高定根稳健性的标准技术。相比于单个外群末端，可以更有信心地推断外群分支下节点的祖先性状状态。这能稳健地“锚定”根节点。通过更准确地极化内群基部的性状变化，它减少了长 $C$ 枝上的同塑性状态被误解的机会。陈述中说该策略“打断外群侧的路径”并且“相对于单个近缘外群进一步降低 LBA 风险”，是对使用多个近缘相关外群优势的正确描述。这是一个优于 $O_2$ 的策略。\n该陈述是**正确**的。\n\n**选项 D 评估**\nD. 对无根内群树（无外群）进行中点定根法消除了 LBA，因为将根置于最长路径的中心会自动校正谱系间的速率变异。\n\n中点定根法是一种将根置于无根树上任意两个分类单元之间最长路径中点的方法。该方法关键地假设了分子钟（即所有谱系的演化速率相等）。问题设置公然违反了这一假设：通向 $C$ 的枝（$t_C=1.80$）远比通向 $A$ 和 $B$ 的枝（从根到A的总路径为 $t_I+t_A = 0.15$）长得多。内群树 $\\{A,B,C\\}$ 中最长的路径位于 $C$ 和 $A$（或 $B$）之间，长度为 $t_C+t_I+t_A = 1.80+0.05+0.10 = 1.95$。中点定根法会将根置于通向 $C$ 的枝上，距离 $C$ 为 $1.95/2=0.975$。这导致了不正确的有根拓扑 $(C,(A,B))$，而真实的拓扑是 $((A,B),C)$。声称该方法“自动校正谱系间速率变异”是错误的；实际上，它对这种变异高度敏感并会被其误导。虽然它（通过不使用外群）避免了与外群相关的 LBA，但它引入了其自身的严重错误。\n该陈述是**不正确**的。\n\n**选项 E 评估**\nE. 即使使用 JC$69$ 数据且 $N \\to \\infty$，在这种枝长配置下，MP 与策略 $O_1$ 也可能在统计上不一致，通过将 $C$ 与外群组合而不是恢复 $(A,B)$ 作为内群分支，从而错误地放置根的位置。\n\n该陈述正确地总结了在策略 $O_1$ 下应用 MP 的结果。如选项 A 的分析所示，两个长的非姐妹枝（$C$ 和 $O_1$）被一个短的内部枝（$t_I$）分开的配置，是经典的 Felsenstein 区，在该区域中 MP 可被证明是不一致的。当 $N \\to \\infty$ 时，MP 不会收敛于真实拓扑 $((A,B),(C,O_1))$，而是会收敛于一个错误地将长枝组合在一起的不正确拓扑，例如 $((A,C),(B,O_1))$。在指定的外群 $O_1$ 上对这个不正确的无根树进行定根，会导致根位置错乱和一组推断出的错误关系，其中内群不是单系的。该陈述是对这种情景下 LBA 谬误的精确和准确描述。\n该陈述是**正确**的。",
            "answer": "$$\\boxed{BCE}$$"
        }
    ]
}