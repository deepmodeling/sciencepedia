{
    "hands_on_practices": [
        {
            "introduction": "The Euler–Lotka equation is a cornerstone of demography, connecting an organism's age-specific survival ($l_x$) and fecundity ($m_x$) to its population's long-term intrinsic rate of increase, $r$. This practice focuses on numerically solving this foundational equation, a critical skill for any evolutionary biologist studying life histories. By applying a root-finding algorithm to different life-history schedules, you will gain a practical understanding of how traits like iteroparity and semelparity translate into fitness, which is measured here by $r$ .",
            "id": "2728440",
            "problem": "Consider an age-structured population with discrete ages and time steps. Let $l_x$ denote survivorship to exact age $x$ and $m_x$ denote expected female offspring produced by an individual at age $x$, for $x \\in \\{0,1,\\dots,A\\}$. Assume that the population asymptotically grows as $N(t) \\propto e^{rt}$, where $r$ is the Malthusian growth rate. Under the standard stable-age approximation and renewal equation for births, the growth rate $r$ is defined by the continuous-time Euler–Lotka equation\n$$\\sum_{x=0}^{A} e^{-r x} \\, l_x \\, m_x \\;=\\; 1.$$\nYou must compute $r$ numerically for each of the parameter sets below.\n\nFundamental base for the derivation you must use:\n- The renewal equation equates births at time $t$ to the sum over ages of past births weighted by survivorship and fecundity.\n- Under asymptotic exponential growth with rate $r$, births satisfy $B(t) \\propto e^{rt}$, leading to the Euler–Lotka condition shown above.\n- Survivorship is age-specific and non-increasing in age, with $l_0 = 1$, and fecundity is non-negative.\n\nAll scenarios below use the parametric survivorship model $l_x = s^x$ with a specified survival parameter $s \\in (0,1)$ and a maximum age $A \\in \\mathbb{N}$. Fecundity $m_x$ is given explicitly for certain ages, and $m_x = 0$ for ages not listed. Angles and physical units do not apply here, and all values are dimensionless. You must approximate $r$ for each case by solving the Euler–Lotka equation numerically and then report the value rounded to three decimals (as a real number, not a percentage).\n\nTest suite (compute one $r$ for each case):\n- Case $1$: $s = 0.8$, $A = 5$, fecundities: $m_2 = 1$, $m_3 = 2$, $m_4 = 1$, $m_5 = 0.5$.\n- Case $2$: $s = 0.9$, $A = 7$, fecundities: $m_3 = 1.5$, $m_4 = 1.5$, $m_5 = 1.5$, $m_6 = 1.0$, $m_7 = 0.5$.\n- Case $3$: $s = 0.6$, $A = 4$, fecundities: $m_4 = 5$ (semelparous).\n- Case $4$: $s = 0.85$, $A = 10$, fecundities: $m_x = 0.3$ for $x \\in \\{2,3,4,5,6,7,8\\}$.\n\nComputational requirements:\n- For each case, numerically find the unique real root $r$ of $g(r) = \\sum_{x=0}^{A} e^{-r x} l_x m_x - 1 = 0$. Use a robust root-finding method that does not rely on closed-form solutions.\n- Guarantee convergence by bracketing a sign change of $g(r)$ before applying a bracketing method. Ensure the numerical tolerance is sufficient to correctly round to three decimals.\n\nFinal output format:\n- Your program should produce a single line of output containing the four rounded results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4]$, where each $r_i$ is rounded to three decimals.",
            "solution": "We begin from the renewal equation for an age-structured population in discrete ages and continuous time. Let $B(t)$ denote the number of births at time $t$. Births at time $t$ are contributed by individuals born at times $t-x$ that have survived to age $x$ and reproduce with age-specific fecundity. With survivorship $l_x$ to age $x$ and fecundity $m_x$ at age $x$, the renewal equation is\n$$\nB(t) \\;=\\; \\sum_{x=0}^{A} B(t-x)\\, l_x\\, m_x.\n$$\nAssuming asymptotic exponential growth with Malthusian parameter $r$, we have $B(t) = B_0 e^{rt}$ for some $B_0 > 0$. Substituting yields\n$$\nB_0 e^{rt} \\;=\\; \\sum_{x=0}^{A} B_0 e^{r(t-x)}\\, l_x\\, m_x\n\\;=\\; B_0 e^{rt} \\sum_{x=0}^{A} e^{-r x} l_x m_x.\n$$\nDividing both sides by $B_0 e^{rt}$ gives the Euler–Lotka equation\n$$\n\\sum_{x=0}^{A} e^{-r x} l_x m_x \\;=\\; 1.\n$$\nThis equation defines $r$ implicitly as the unique real root of\n$$\ng(r) \\;=\\; \\sum_{x=0}^{A} e^{-r x} l_x m_x - 1.\n$$\nWe now state properties that guarantee existence and uniqueness and motivate a numerical algorithm:\n- Monotonicity: For non-negative $l_x m_x$, the function $g(r)$ is strictly decreasing in $r$, because\n$$\n\\frac{d}{dr} g(r) \\;=\\; -\\sum_{x=0}^{A} x\\, e^{-r x} l_x m_x \\;<\\; 0\n$$\nwhenever there exists at least one age $x>0$ with $l_x m_x > 0$.\n- Limits: As $r \\to +\\infty$, $e^{-r x} \\to 0$ for all $x>0$, so $g(r) \\to l_0 m_0 - 1$. In our test suite $m_0 = 0$, thus $g(r) \\to -1$. As $r \\to -\\infty$, $e^{-r x} \\to +\\infty$ for any $x>0$ with $l_x m_x > 0$, thus $g(r) \\to +\\infty$.\n- Existence and uniqueness: By the intermediate value theorem and strict monotonicity, there is exactly one real root.\n\nAlgorithmic design:\n1. For each case, construct $l_x = s^x$ for $x \\in \\{0,\\dots,A\\}$ and the given $m_x$ vector with zeros on unspecified ages.\n2. Define $g(r) = \\sum_{x=0}^{A} e^{-r x} l_x m_x - 1$.\n3. Bracket a root by finding $r_{\\text{low}}$ and $r_{\\text{high}}$ such that $g(r_{\\text{low}}) > 0$ and $g(r_{\\text{high}}) < 0$. A robust strategy uses the known limits by expanding $r_{\\text{low}}$ negatively and $r_{\\text{high}}$ positively until the respective inequalities are met.\n4. Apply a bracketing method such as bisection. Initialize $(a,b) = (r_{\\text{low}}, r_{\\text{high}})$ and iterate:\n$$\nc \\leftarrow \\frac{a+b}{2}, \\quad\n\\text{if } g(c) > 0 \\text{ set } a \\leftarrow c, \\text{ else } b \\leftarrow c.\n$$\nBecause $g$ is continuous and strictly decreasing, this converges to the unique root. Iterate until $|b-a|$ is below a small tolerance that guarantees correct rounding to three decimals, for example a tolerance less than $10^{-6}$.\n5. Round the resulting $r$ to three decimals.\n\nSanity checks for the test suite:\n- Case $1$ has net reproductive rate at $r=0$ given by $R_0 = \\sum_x l_x m_x = \\sum_x s^x m_x$, which evaluates to a value greater than $1$, implying $r>0$.\n- Case $2$ similarly has $R_0 > 1$, implying $r>0$.\n- Case $3$ has reproduction only at $x=4$ with $s=0.6$, giving $R_0 = 5 \\cdot 0.6^4 = 5 \\cdot 0.1296 = 0.648 < 1$, implying $r<0$.\n- Case $4$ is constructed with $R_0$ close to $1$, implying $r$ is close to $0$ (slightly negative because $R_0$ is slightly less than $1$).\n\nThe program implements this algorithm for all four cases and outputs a single line with the four rounded values in the specified list format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport math\n\ndef euler_lotka_root(s, A, m_list, tol=1e-12, max_iter=200, expand_limit=100):\n    # Build survivorship l_x = s^x\n    l = [s**x for x in range(A + 1)]\n    # Ensure m_list length matches A+1\n    if len(m_list) != A + 1:\n        raise ValueError(\"m_list length must be A+1\")\n    # Define g(r) = sum e^{-r x} l_x m_x - 1\n    # Avoid numerical underflow issues by using math.exp\n    def g(r):\n        total = 0.0\n        for x in range(A + 1):\n            mx = m_list[x]\n            if mx == 0.0:\n                continue\n            total += math.exp(-r * x) * l[x] * mx\n        return total - 1.0\n\n    # Bracket the root: find low with g(low) > 0 and high with g(high) < 0\n    # Start with reasonable bounds and expand if necessary\n    low = -10.0\n    high = 10.0\n    glow = g(low)\n    ghigh = g(high)\n\n    # Expand low negatively until g(low) > 0 (since g -> +inf as r -> -inf)\n    expand_count = 0\n    while glow <= 0.0 and expand_count < expand_limit:\n        low *= 2.0  # more negative\n        glow = g(low)\n        expand_count += 1\n\n    # Expand high positively until g(high) < 0 (since g -> -1 as r -> +inf when m0=0)\n    expand_count = 0\n    while ghigh >= 0.0 and expand_count < expand_limit:\n        high *= 2.0  # more positive\n        ghigh = g(high)\n        expand_count += 1\n\n    if not (glow > 0.0 and ghigh < 0.0):\n        # As a fallback, try scanning a range to locate a sign change\n        # This should not trigger for the provided test cases\n        scan_points = [i * 0.5 for i in range(-200, 201)]\n        prev_r = scan_points[0]\n        prev_g = g(prev_r)\n        found = False\n        for r in scan_points[1:]:\n            gr = g(r)\n            if prev_g * gr <= 0.0:\n                low, high = (prev_r, r) if prev_g > 0 else (r, prev_r)\n                glow, ghigh = g(low), g(high)\n                found = True\n                break\n            prev_r, prev_g = r, gr\n        if not found:\n            raise RuntimeError(\"Failed to bracket the root\")\n\n    # Bisection\n    a, b = low, high\n    fa, fb = glow, ghigh\n    for _ in range(max_iter):\n        c = 0.5 * (a + b)\n        fc = g(c)\n        if abs(b - a) < tol:\n            return c\n        # Since g is decreasing, sign test is straightforward\n        if fc > 0.0:\n            a, fa = c, fc\n        else:\n            b, fb = c, fc\n    return 0.5 * (a + b)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (s, A, m_list)\n    test_cases = [\n        # Case 1: s=0.8, A=5, m2=1, m3=2, m4=1, m5=0.5\n        (0.8, 5, [0.0, 0.0, 1.0, 2.0, 1.0, 0.5]),\n        # Case 2: s=0.9, A=7, m3=1.5, m4=1.5, m5=1.5, m6=1.0, m7=0.5\n        (0.9, 7, [0.0, 0.0, 0.0, 1.5, 1.5, 1.5, 1.0, 0.5]),\n        # Case 3: s=0.6, A=4, m4=5.0\n        (0.6, 4, [0.0, 0.0, 0.0, 0.0, 5.0]),\n        # Case 4: s=0.85, A=10, m2..8=0.3\n        (0.85, 10, [0.0, 0.0, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.0, 0.0]),\n    ]\n\n    results = []\n    for s, A, m_list in test_cases:\n        r = euler_lotka_root(s, A, m_list)\n        # Round to three decimals for output formatting\n        results.append(f\"{r:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "While age is a useful descriptor, many organisms are better classified by developmental or size-based stages (e.g., juvenile, subadult, adult). Stage-structured matrix models provide a powerful and flexible framework for analyzing these more complex life cycles. In this exercise, you will dissect a stage-based projection matrix to compute its fundamental properties: the population growth rate ($\\lambda$), the stable stage distribution ($w$), and the vector of reproductive values ($v$). Mastering these calculations is essential for understanding the dynamics of structured populations and forms the basis for more advanced evolutionary analyses .",
            "id": "2728442",
            "problem": "A vertebrate species exhibits three discrete life-history classes that capture a trade-off between survival and reproduction: juveniles (class $1$), subadults (class $2$), and adults (class $3$). Individuals in classes $2$ and $3$ reproduce, with fecundities $F=[0,\\,1.2,\\,1.5]$, while survival transitions between classes are given by $P=[0.5,\\,0.6,\\,0.7]$. Assume a discrete-time linear projection with a Leslie–Lefkovitch structure: the projection matrix $\\mathbf{A}$ has fecundities in the first row, survival transitions on the subdiagonal, and stasis in the final class, i.e.,\n$$\n\\mathbf{A} \\;=\\; \\begin{pmatrix}\n0 & 1.2 & 1.5 \\\\\n0.5 & 0 & 0 \\\\\n0 & 0.6 & 0.7\n\\end{pmatrix}.\n$$\nStarting only from the standard definitions that (i) the dominant eigenvalue $\\lambda$ of $\\mathbf{A}$ is the long-run multiplicative population growth rate, (ii) the stable age (stage) distribution $\\mathbf{w}$ is the right eigenvector of $\\mathbf{A}$ associated with $\\lambda$, normalized so that $\\sum_i w_i = 1$, and (iii) the reproductive value vector $\\mathbf{v}$ is the left eigenvector associated with $\\lambda$, normalized so that $\\mathbf{v}^{\\top}\\mathbf{w} = 1$, do the following:\n\n1. Derive the characteristic polynomial of $\\mathbf{A}$ and compute the dominant eigenvalue $\\lambda$.\n2. Derive the corresponding stable age distribution $\\mathbf{w}$ symbolically up to a scalar and then normalize it to sum to $1$.\n3. Derive the corresponding reproductive value vector $\\mathbf{v}$ symbolically up to a scalar and then normalize it so that $\\mathbf{v}^{\\top}\\mathbf{w} = 1$.\n\nReport your final numerical answer as the value of $\\lambda$, with no units, rounded to four significant figures. You must carry out the derivations for $\\mathbf{w}$ and $\\mathbf{v}$ as described, but only report $\\lambda$ as your final numerical answer.",
            "solution": "The problem statement is evaluated and found to be valid. It is a well-posed problem in mathematical population biology, grounded in the established principles of life-history theory and linear algebra. All data are provided, and the definitions are standard and unambiguous. We proceed with the solution.\n\nThe problem requires the derivation of the dominant eigenvalue $\\lambda$, the stable stage distribution $\\mathbf{w}$, and the reproductive value vector $\\mathbf{v}$ for a population structured into three classes, governed by the projection matrix $\\mathbf{A}$.\n\nThe given projection matrix is:\n$$\n\\mathbf{A} = \\begin{pmatrix}\n0 & 1.2 & 1.5 \\\\\n0.5 & 0 & 0 \\\\\n0 & 0.6 & 0.7\n\\end{pmatrix}\n$$\n\n**1. Derivation of the Characteristic Polynomial and Dominant Eigenvalue $\\lambda$**\n\nThe eigenvalues $\\lambda$ of the matrix $\\mathbf{A}$ are the roots of the characteristic equation, given by $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$, where $\\mathbf{I}$ is the identity matrix.\n\nThe characteristic determinant is:\n$$\n\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = \\begin{vmatrix}\n-\\lambda & 1.2 & 1.5 \\\\\n0.5 & -\\lambda & 0 \\\\\n0 & 0.6 & 0.7-\\lambda\n\\end{vmatrix} = 0\n$$\n\nWe expand the determinant along the first column:\n$$\n(-\\lambda) \\begin{vmatrix} -\\lambda & 0 \\\\ 0.6 & 0.7-\\lambda \\end{vmatrix} - (0.5) \\begin{vmatrix} 1.2 & 1.5 \\\\ 0.6 & 0.7-\\lambda \\end{vmatrix} + (0) \\begin{vmatrix} 1.2 & 1.5 \\\\ -\\lambda & 0 \\end{vmatrix} = 0\n$$\n$$\n(-\\lambda) \\left( (-\\lambda)(0.7-\\lambda) - (0)(0.6) \\right) - (0.5) \\left( (1.2)(0.7-\\lambda) - (1.5)(0.6) \\right) = 0\n$$\n$$\n(-\\lambda)(-\\lambda(0.7-\\lambda)) - (0.5)(0.84 - 1.2\\lambda - 0.9) = 0\n$$\n$$\n\\lambda^2(0.7-\\lambda) - (0.5)(-0.06 - 1.2\\lambda) = 0\n$$\n$$\n0.7\\lambda^2 - \\lambda^3 + 0.03 + 0.6\\lambda = 0\n$$\nMultiplying by $-1$ and rearranging the terms gives the characteristic polynomial in standard form:\n$$\n\\lambda^3 - 0.7\\lambda^2 - 0.6\\lambda - 0.03 = 0\n$$\nThis is the Euler-Lotka equation for this stage-structured model. The dominant eigenvalue $\\lambda$ is the long-run population growth rate. According to the Perron-Frobenius theorem for non-negative, irreducible, and primitive matrices, there exists a unique, simple, positive real eigenvalue that is greater in magnitude than all other eigenvalues. The matrix $\\mathbf{A}$ is primitive because it is irreducible and has a positive entry on the main diagonal ($a_{33} = 0.7 > 0$). This positive real root is the dominant eigenvalue $\\lambda$.\n\nThis cubic equation must be solved for its roots. A numerical solution yields one positive real root and two complex conjugate roots. The positive real root is:\n$$\n\\lambda \\approx 1.214436\n$$\nRounding to four significant figures, as required for the final answer, gives $\\lambda = 1.214$.\n\n**2. Derivation of the Stable Stage Distribution $\\mathbf{w}$**\n\nThe stable stage distribution $\\mathbf{w}$ is the right eigenvector corresponding to the dominant eigenvalue $\\lambda$, satisfying $\\mathbf{A}\\mathbf{w} = \\lambda\\mathbf{w}$, or $(\\mathbf{A} - \\lambda\\mathbf{I})\\mathbf{w} = \\mathbf{0}$. We write this as a system of linear equations:\n$$\n\\begin{pmatrix}\n-\\lambda & 1.2 & 1.5 \\\\\n0.5 & -\\lambda & 0 \\\\\n0 & 0.6 & 0.7-\\lambda\n\\end{pmatrix}\n\\begin{pmatrix} w_1 \\\\ w_2 \\\\ w_3 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThis gives the system:\n1.  $-\\lambda w_1 + 1.2 w_2 + 1.5 w_3 = 0$\n2.  $0.5 w_1 - \\lambda w_2 = 0$\n3.  $0.6 w_2 + (0.7-\\lambda) w_3 = 0$\n\nFrom equation (2), we express $w_2$ in terms of $w_1$:\n$$ w_2 = \\frac{0.5}{\\lambda} w_1 $$\nFrom equation (3), we express $w_3$ in terms of $w_2$:\n$$ w_3 = -\\frac{0.6}{0.7-\\lambda} w_2 = \\frac{0.6}{\\lambda-0.7} w_2 $$\nSubstituting the expression for $w_2$:\n$$ w_3 = \\frac{0.6}{\\lambda-0.7} \\left( \\frac{0.5}{\\lambda} w_1 \\right) = \\frac{0.3}{\\lambda(\\lambda-0.7)} w_1 $$\nThe eigenvector $\\mathbf{w}$ is thus proportional to a vector where we can set $w_1=1$ to define its an unnormalized form, $\\mathbf{w}'$:\n$$\n\\mathbf{w}' = \\begin{pmatrix} 1 \\\\ \\frac{0.5}{\\lambda} \\\\ \\frac{0.3}{\\lambda(\\lambda-0.7)} \\end{pmatrix}\n$$\nThe problem requires normalization such that the components sum to $1$, i.e., $\\sum_i w_i = 1$. Let $S_w = 1 + \\frac{0.5}{\\lambda} + \\frac{0.3}{\\lambda(\\lambda-0.7)}$. The normalized vector is $\\mathbf{w} = \\frac{1}{S_w}\\mathbf{w}'$.\n$$\n\\mathbf{w} = \\frac{1}{1 + \\frac{0.5}{\\lambda} + \\frac{0.3}{\\lambda(\\lambda-0.7)}} \\begin{pmatrix} 1 \\\\ \\frac{0.5}{\\lambda} \\\\ \\frac{0.3}{\\lambda(\\lambda-0.7)} \\end{pmatrix}\n$$\n\n**3. Derivation of the Reproductive Value Vector $\\mathbf{v}$**\n\nThe reproductive value vector $\\mathbf{v}$ is the left eigenvector corresponding to $\\lambda$, satisfying $\\mathbf{v}^{\\top}\\mathbf{A} = \\lambda\\mathbf{v}^{\\top}$. This is equivalent to $\\mathbf{A}^{\\top}\\mathbf{v} = \\lambda\\mathbf{v}$, or $(\\mathbf{A}^{\\top} - \\lambda\\mathbf{I})\\mathbf{v} = \\mathbf{0}$.\n\nThe transpose of $\\mathbf{A}$ is:\n$$\n\\mathbf{A}^{\\top} = \\begin{pmatrix}\n0 & 0.5 & 0 \\\\\n1.2 & 0 & 0.6 \\\\\n1.5 & 0 & 0.7\n\\end{pmatrix}\n$$\nThe system of equations is:\n$$\n\\begin{pmatrix}\n-\\lambda & 0.5 & 0 \\\\\n1.2 & -\\lambda & 0.6 \\\\\n1.5 & 0 & 0.7-\\lambda\n\\end{pmatrix}\n\\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n1.  $-\\lambda v_1 + 0.5 v_2 = 0$\n2.  $1.2 v_1 - \\lambda v_2 + 0.6 v_3 = 0$\n3.  $1.5 v_1 + (0.7-\\lambda) v_3 = 0$\n\nFrom equation (1), we express $v_2$ in terms of $v_1$:\n$$ v_2 = \\frac{\\lambda}{0.5} v_1 = 2\\lambda v_1 $$\nFrom equation (3), we express $v_3$ in terms of $v_1$:\n$$ v_3 = -\\frac{1.5}{0.7-\\lambda} v_1 = \\frac{1.5}{\\lambda-0.7} v_1 $$\nBy convention, we set $v_1=1$ to obtain the unnormalized reproductive value vector, $\\mathbf{v}'$:\n$$\n\\mathbf{v}' = \\begin{pmatrix} 1 \\\\ 2\\lambda \\\\ \\frac{1.5}{\\lambda-0.7} \\end{pmatrix}\n$$\nThe problem demands normalization such that $\\mathbf{v}^{\\top}\\mathbf{w} = 1$. Let $\\mathbf{v} = k\\mathbf{v}'$ for some scalar $k$. The condition becomes $k\\mathbf{v}'^{\\top}\\mathbf{w} = 1$, so the normalization constant is $k = (\\mathbf{v}'^{\\top}\\mathbf{w})^{-1}$.\n\nThe dot product $\\mathbf{v}'^{\\top}\\mathbf{w}$ is:\n$$\n\\mathbf{v}'^{\\top}\\mathbf{w} = \\begin{pmatrix} 1 & 2\\lambda & \\frac{1.5}{\\lambda-0.7} \\end{pmatrix} \\left( \\frac{1}{S_w} \\begin{pmatrix} 1 \\\\ \\frac{0.5}{\\lambda} \\\\ \\frac{0.3}{\\lambda(\\lambda-0.7)} \\end{pmatrix} \\right)\n$$\n$$\n= \\frac{1}{S_w} \\left( 1\\cdot 1 + 2\\lambda \\cdot \\frac{0.5}{\\lambda} + \\frac{1.5}{\\lambda-0.7} \\cdot \\frac{0.3}{\\lambda(\\lambda-0.7)} \\right)\n$$\n$$\n= \\frac{1}{S_w} \\left( 1 + 1 + \\frac{0.45}{\\lambda(\\lambda-0.7)^2} \\right) = \\frac{1}{S_w} \\left( 2 + \\frac{0.45}{\\lambda(\\lambda-0.7)^2} \\right)\n$$\nThe normalization constant is therefore $k = \\frac{S_w}{2 + \\frac{0.45}{\\lambda(\\lambda-0.7)^2}}$.\nThe fully normalized reproductive value vector is $\\mathbf{v} = k\\mathbf{v}'$:\n$$\n\\mathbf{v} = \\frac{1 + \\frac{0.5}{\\lambda} + \\frac{0.3}{\\lambda(\\lambda-0.7)}}{2 + \\frac{0.45}{\\lambda(\\lambda-0.7)^2}} \\begin{pmatrix} 1 \\\\ 2\\lambda \\\\ \\frac{1.5}{\\lambda-0.7} \\end{pmatrix}\n$$\nThis completes the required derivations. The final numerical answer is the value of $\\lambda$ rounded to four significant figures.",
            "answer": "$$\\boxed{1.214}$$"
        },
        {
            "introduction": "To understand life-history evolution, we must determine which traits have the greatest impact on fitness. Elasticity analysis is a powerful form of prospective analysis that quantifies the proportional effect of a small change in a vital rate (like survival or fecundity) on the population growth rate, $\\lambda$. This practice challenges you to use elasticities to predict which of two vital rates is under stronger selection in different life-history scenarios, illustrating how trade-offs shape evolutionary trajectories .",
            "id": "2728457",
            "problem": "Consider a stage-structured population with three discrete stages: juveniles ($1$), subadults ($2$), and adults ($3$). Dynamics at low density are assumed to be density independent, so the long-term per-capita growth rate (fitness proxy) is given by the dominant eigenvalue $\\,\\lambda\\,$ of the stage-structured population projection matrix. Vital rates are parameterized as follows: juveniles can remain juveniles with probability $g_{1}$ or mature to subadults with probability $m_{1}$ in one time step; subadults can remain subadults with probability $g_{2}$ or mature to adults with probability $m_{2}$; adults survive and remain adults with probability $g_{3}$; adults produce $F$ newborns that enter the juvenile stage.\n\nTwo life histories differ in juvenile survival and adult fecundity, while retaining identical subadult and adult transitions:\n- Life history $1$: $g_{1} = 0.05$, $m_{1} = 0.30$, $g_{2} = 0.30$, $m_{2} = 0.50$, $g_{3} = 0.60$, $F = 6$.\n- Life history $2$: $g_{1} = 0.40$, $m_{1} = 0.30$, $g_{2} = 0.30$, $m_{2} = 0.50$, $g_{3} = 0.60$, $F = 2$.\n\nThus, the population projection matrices are\n$$\n\\mathbf{A}_{1} \\;=\\; \n\\begin{pmatrix}\n0.05 & 0 & 6 \\\\\n0.30 & 0.30 & 0 \\\\\n0 & 0.50 & 0.60\n\\end{pmatrix},\n\\qquad\n\\mathbf{A}_{2} \\;=\\; \n\\begin{pmatrix}\n0.40 & 0 & 2 \\\\\n0.30 & 0.30 & 0 \\\\\n0 & 0.50 & 0.60\n\\end{pmatrix}.\n$$\n\nStarting from core definitions in structured population theory, do the following for each life history:\n1. Compute the dominant eigenvalue $\\,\\lambda\\,$ and the associated right eigenvector $\\,\\mathbf{w}\\,$ (stable stage distribution) and left eigenvector $\\,\\mathbf{v}\\,$ (reproductive value vector), normalized only insofar as needed to evaluate sensitivities.\n2. Using the formal definition of elasticity as a proportional sensitivity of $\\,\\lambda\\,$ to proportional changes in a vital rate (matrix element), compute the elasticities of $\\,\\lambda\\,$ to adult fecundity $F$ (i.e., the element $a_{13}$) and to juvenile stasis $g_{1}$ (i.e., the element $a_{11}$). Denote these $e_{F}$ and $e_{g_{1}}$ for each life history.\n3. Based on the elasticities, predict which vital rate change (a small proportional increase in $F$ versus a small proportional increase in $g_{1}$) would be most strongly favored by selection at low density for each life history, under the standard assumption that selection increases $\\,\\lambda\\,$ most rapidly along the direction of greatest elasticity when costs are measured on a proportional scale.\n\nFinally, report the single numerical value\n$$\nR \\;=\\; \\frac{e_{F}^{(1)}}{e_{g_{1}}^{(1)}},\n$$\nwhere the superscript $(1)$ denotes Life history $1$. Round your reported value of $R$ to four significant figures. Express the final answer as a pure number with no units.",
            "solution": "The problem requires an analysis of two life histories using stage-structured population projection matrices. The core of this analysis relies on the properties of eigenvalues and eigenvectors of these matrices.\n\nLet $\\mathbf{A}$ be a population projection matrix where the element $a_{ij}$ represents the per-capita contribution of individuals in stage $j$ to stage $i$ in one time step. The long-term, density-independent population dynamics are described by the dominant eigenvalue $\\lambda$ and its corresponding right and left eigenvectors, $\\mathbf{w}$ and $\\mathbf{v}$.\n$$ \\mathbf{A} \\mathbf{w} = \\lambda \\mathbf{w} \\quad \\text{and} \\quad \\mathbf{v}^T \\mathbf{A} = \\lambda \\mathbf{v}^T $$\nHere, $\\lambda$ is the asymptotic population growth rate, $\\mathbf{w}$ is the stable stage distribution (the proportional abundance of individuals in each stage), and $\\mathbf{v}$ is the reproductive value vector (the relative contribution of an individual in each stage to future population growth).\n\nThe sensitivity of the population growth rate $\\lambda$ to a change in a matrix element $a_{ij}$ is given by\n$$ s_{ij} = \\frac{\\partial \\lambda}{\\partial a_{ij}} = \\frac{v_i w_j}{\\langle \\mathbf{v}, \\mathbf{w} \\rangle} $$\nwhere $\\langle \\mathbf{v}, \\mathbf{w} \\rangle = \\sum_k v_k w_k$ is the scalar product of the left and right eigenvectors. Elasticity, $e_{ij}$, is the proportional sensitivity, which measures the proportional change in $\\lambda$ for a proportional change in $a_{ij}$:\n$$ e_{ij} = \\frac{a_{ij}}{\\lambda} \\frac{\\partial \\lambda}{\\partial a_{ij}} = \\frac{a_{ij}}{\\lambda} \\frac{v_i w_j}{\\langle \\mathbf{v}, \\mathbf{w} \\rangle} $$\nElasticities are used to assess the relative importance of different vital rates to population growth. Selection at low density will most strongly favor changes in vital rates with the highest elasticity.\n\nThe general form of the population projection matrix for this three-stage system is\n$$ \\mathbf{A} = \\begin{pmatrix} g_1 & 0 & F \\\\ m_1 & g_2 & 0 \\\\ 0 & m_2 & g_3 \\end{pmatrix} $$\nThe characteristic equation is $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$, which expands to:\n$$ (g_1 - \\lambda)(g_2 - \\lambda)(g_3 - \\lambda) + F m_1 m_2 = 0 $$\n$$ (\\lambda - g_1)(\\lambda - g_2)(\\lambda - g_3) = F m_1 m_2 $$\n\nWe will now apply this framework to each life history.\n\n**Analysis of Life History 1**\nThe matrix is\n$$ \\mathbf{A}_{1} = \\begin{pmatrix} 0.05 & 0 & 6 \\\\ 0.30 & 0.30 & 0 \\\\ 0 & 0.50 & 0.60 \\end{pmatrix} $$\nThe parameters are $g_1 = 0.05$, $m_1 = 0.30$, $g_2 = 0.30$, $m_2 = 0.50$, $g_3 = 0.60$, and $F = 6$. The characteristic equation is\n$$ (\\lambda - 0.05)(\\lambda - 0.30)(\\lambda - 0.60) = (6)(0.30)(0.50) = 0.9 $$\n$$ \\lambda^3 - 0.95\\lambda^2 + 0.225\\lambda - 0.909 = 0 $$\nSolving this cubic equation numerically for the dominant (largest positive real) root yields $\\lambda_1 \\approx 1.30896$.\n\nTo find the right eigenvector $\\mathbf{w}^{(1)}$, we solve $(\\mathbf{A}_1 - \\lambda_1 \\mathbf{I})\\mathbf{w}^{(1)} = \\mathbf{0}$. We set $w_1 = 1$:\nFrom the second row: $0.30 w_1 + (0.30 - \\lambda_1) w_2 = 0 \\implies w_2 = \\frac{0.30}{\\lambda_1 - 0.30} w_1 = \\frac{0.30}{1.30896 - 0.30} \\approx 0.29734$.\nFrom the third row: $0.50 w_2 + (0.60 - \\lambda_1) w_3 = 0 \\implies w_3 = \\frac{0.50}{\\lambda_1 - 0.60} w_2 = \\frac{0.50}{1.30896 - 0.60} (0.29734) \\approx 0.20969$.\nSo, $\\mathbf{w}^{(1)} \\propto \\begin{pmatrix} 1 \\\\ 0.29734 \\\\ 0.20969 \\end{pmatrix}$.\n\nTo find the left eigenvector $\\mathbf{v}^{(1)}$, we solve $\\mathbf{v}^{(1)T}(\\mathbf{A}_1 - \\lambda_1 \\mathbf{I}) = \\mathbf{0}^T$. We set $v_1=1$:\nFrom the first column: $(0.05 - \\lambda_1) v_1 + 0.30 v_2 = 0 \\implies v_2 = \\frac{\\lambda_1 - 0.05}{0.30} v_1 = \\frac{1.30896 - 0.05}{0.30} \\approx 4.19653$.\nFrom the second column: $(0.30 - \\lambda_1) v_2 + 0.50 v_3 = 0 \\implies v_3 = \\frac{\\lambda_1 - 0.30}{0.50} v_2 = \\frac{1.30896 - 0.30}{0.50} (4.19653) \\approx 8.46823$.\nSo, $\\mathbf{v}^{(1)T} \\propto \\begin{pmatrix} 1 & 4.19653 & 8.46823 \\end{pmatrix}$.\n\nThe scalar product is:\n$$ \\langle \\mathbf{v}^{(1)}, \\mathbf{w}^{(1)} \\rangle = (1)(1) + (4.19653)(0.29734) + (8.46823)(0.20969) \\approx 1 + 1.24783 + 1.77573 \\approx 4.02359 $$\n\nThe elasticities are:\n$e_{F}^{(1)} = e_{13}^{(1)} = \\frac{a_{13}^{(1)}}{\\lambda_1} \\frac{v_1^{(1)} w_3^{(1)}}{\\langle \\mathbf{v}^{(1)}, \\mathbf{w}^{(1)} \\rangle} = \\frac{6}{1.30896} \\frac{(1)(0.20969)}{4.02359} \\approx 4.5835 \\times 0.05212 \\approx 0.23891$.\n$e_{g_1}^{(1)} = e_{11}^{(1)} = \\frac{a_{11}^{(1)}}{\\lambda_1} \\frac{v_1^{(1)} w_1^{(1)}}{\\langle \\mathbf{v}^{(1)}, \\mathbf{w}^{(1)} \\rangle} = \\frac{0.05}{1.30896} \\frac{(1)(1)}{4.02359} \\approx 0.03819 \\times 0.24853 \\approx 0.009492$.\n\nSince $e_{F}^{(1)} (0.23891) > e_{g_1}^{(1)} (0.009492)$, a small proportional increase in adult fecundity $F$ would be more strongly favored by selection than such an increase in juvenile stasis $g_1$.\n\n**Analysis of Life History 2**\nThe matrix is\n$$ \\mathbf{A}_{2} = \\begin{pmatrix} 0.40 & 0 & 2 \\\\ 0.30 & 0.30 & 0 \\\\ 0 & 0.50 & 0.60 \\end{pmatrix} $$\nThe characteristic equation is $(\\lambda - 0.40)(\\lambda - 0.30)(\\lambda - 0.60) = (2)(0.30)(0.50) = 0.3$.\n$$ \\lambda^3 - 1.3\\lambda^2 + 0.54\\lambda - 0.372 = 0 $$\nThe dominant eigenvalue is $\\lambda_2 \\approx 1.11538$. Following similar calculations as for Life History 1:\n$\\mathbf{w}^{(2)} \\propto \\begin{pmatrix} 1 \\\\ 0.3680 \\\\ 0.3570 \\end{pmatrix}$, $\\mathbf{v}^{(2)T} \\propto \\begin{pmatrix} 1 & 2.3846 & 3.8893 \\end{pmatrix}$.\nThe scalar product is $\\langle \\mathbf{v}^{(2)}, \\mathbf{w}^{(2)} \\rangle \\approx 3.2657$.\nThe elasticities are:\n$e_{F}^{(2)} = e_{13}^{(2)} = \\frac{2}{1.11538} \\frac{(1)(0.3570)}{3.2657} \\approx 0.1962$.\n$e_{g_1}^{(2)} = e_{11}^{(2)} = \\frac{0.40}{1.11538} \\frac{(1)(1)}{3.2657} \\approx 0.1098$.\nSince $e_{F}^{(2)} (0.1962) > e_{g_1}^{(2)} (0.1098)$, selection would again more strongly favor a proportional increase in fecundity $F$.\n\n**Final Calculation of R**\nThe problem asks for the ratio $R = \\frac{e_{F}^{(1)}}{e_{g_{1}}^{(1)}} = \\frac{e_{13}^{(1)}}{e_{11}^{(1)}}$.\nUsing the definition of elasticity:\n$$ R = \\frac{\\frac{a_{13}^{(1)}}{\\lambda_1} \\frac{v_1^{(1)} w_3^{(1)}}{\\langle \\mathbf{v}^{(1)}, \\mathbf{w}^{(1)} \\rangle}}{\\frac{a_{11}^{(1)}}{\\lambda_1} \\frac{v_1^{(1)} w_1^{(1)}}{\\langle \\mathbf{v}^{(1)}, \\mathbf{w}^{(1)} \\rangle}} = \\frac{a_{13}^{(1)}}{a_{11}^{(1)}} \\frac{w_3^{(1)}}{w_1^{(1)}} = \\frac{F_1}{g_1^{(1)}} \\frac{w_3^{(1)}}{w_1^{(1)}} $$\nThis expression avoids the need to calculate the left eigenvector $\\mathbf{v}$ and the scalar product. From the first row of the eigenvector equation $\\mathbf{A}_1 \\mathbf{w}^{(1)} = \\lambda_1 \\mathbf{w}^{(1)}$:\n$$ a_{11}^{(1)} w_1^{(1)} + a_{13}^{(1)} w_3^{(1)} = \\lambda_1 w_1^{(1)} \\implies F_1 w_3^{(1)} = (\\lambda_1 - g_1^{(1)}) w_1^{(1)} $$\nSubstituting this into the expression for $R$:\n$$ R = \\frac{1}{g_1^{(1)}} \\left( F_1 \\frac{w_3^{(1)}}{w_1^{(1)}} \\right) = \\frac{1}{g_1^{(1)}} (\\lambda_1 - g_1^{(1)}) = \\frac{\\lambda_1 - g_1^{(1)}}{g_1^{(1)}} $$\nThis provides a direct and more robust way to compute $R$, using only the dominant eigenvalue $\\lambda_1$ and the parameter $g_1^{(1)}$.\nUsing the accurately computed value $\\lambda_1 \\approx 1.30896$:\n$$ R = \\frac{1.30896 - 0.05}{0.05} = \\frac{1.25896}{0.05} = 25.1792 $$\nRounding to four significant figures, the result is $25.18$.\nThis value is consistent with the ratio from the full elasticity calculation: $R \\approx \\frac{0.23891}{0.009492} \\approx 25.17$.",
            "answer": "$$\\boxed{25.18}$$"
        }
    ]
}