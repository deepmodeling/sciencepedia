{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个实践练习将回到性别比理论的基石：Fisher原理。虽然该原理常被简化为预测1:1的性别比，但其核心思想是关于均等的“投入”。本练习要求您从第一性原理出发，推导在产生雄性（成本为 $c_m$）和雌性（成本为 $c_f$）的成本不同时，演化稳定策略下的性别比，从而巩固对频率依赖性选择基本逻辑的理解。",
            "id": "2709671",
            "problem": "一个大型、随机交配、有性繁殖的种群，其初级性别比由母体控制。初级性别比定义为受孕时合子中雄性的比例。假设同性个体间的交配机会均等，出生后除了特定性别的生产成本外，没有存活率或繁殖力的差异，并且母体投入是唯一的限制性资源。设生产一个儿子的成本为 $c_m$，生产一个女儿的成本为 $c_f$，成本以相同的资源单位计量。每位母亲拥有固定的预算 $B$，并可以将其预算的一部分 $x$ 持续分配给儿子，剩余的 $1-x$ 分配给女儿。假设在给定的种群性别比条件下，特定性别的后代在预期存活率和未来交配成功率上是相同的，并且通过儿子和女儿的基因传递是对称的，因此任何恒定的孟德尔遗传因子在两性间的比较中都会被抵消。\n\n请仅使用基本定义和经过充分检验的事实，包括（i）随机交配意味着给定性别个体的平均交配成功率与其性别频率成反比，以及（ii）在进化稳定策略（ESS）下，单位投资的边际适应度回报在不同投资选择间是均等的，从第一性原理推导一个条件，使得留存种群的按数量计的初级性别比 $p$ 成为一个 ESS。然后，计算当 $c_m=2$ 且 $c_f=1$ 时，按数量计的 ESS 初级性别比。你的最终答案必须是一个数字。如果你选择近似计算，请四舍五入到四位有效数字；否则，请提供一个未经近似的精确值。不要包含单位。",
            "solution": "该问题要求推导进化稳定策略（ESS）下按数量计的初级性别比（记为 $p$）的条件，并根据生产雄性和雌性的特定成本计算该比率。分析将基于进化博弈论的原理。\n\n一位母亲的进化适应度与其孙代总数成正比。在一个二倍体、有性繁殖的种群中，每个后代都由一个雄性配子和一个雌性配子融合而成。因此，一代中所有雄性的总繁殖价值必须等于所有雌性的总繁殖价值。设 $N_m$ 为繁殖年龄种群中雄性的总数， $N_f$ 为雌性的总数。设单个雄性的平均繁殖价值为 $v_m$，单个雌性的平均繁殖价值为 $v_f$。总繁殖价值的相等性意味着 $N_m v_m = N_f v_f$。由此可知，个体的繁殖价值与其性别在种群中的频率成反比，这与问题陈述中的事实（i）一致。具体来说，$v_m \\propto \\frac{1}{N_m}$ 且 $v_f \\propto \\frac{1}{N_f}$。\n\n问题陈述，一位母亲有固定预算 $B$，将比例 $x$ 分配给儿子， $1-x$ 分配给女儿。生产一个儿子的成本是 $c_m$，生产一个女儿的成本是 $c_f$。一位母亲生产的儿子数量为 $n_m = \\frac{xB}{c_m}$，女儿数量为 $n_f = \\frac{(1-x)B}{c_f}$。她的适应度 $W$ 是其后代繁殖价值的总和：\n$$W = n_m v_m + n_f v_f = \\left(\\frac{xB}{c_m}\\right)v_m + \\left(\\frac{(1-x)B}{c_f}\\right)v_f$$\n$v_m$ 和 $v_f$ 的值由整个种群的性别比决定，该性别比由留存策略设定，而非单个（可能是突变的）母亲的策略。\n\n根据事实（ii），当单位投资的边际适应度回报在所有可能的投资选择间均等时，即达到 ESS。这里的选择是在儿子和女儿之间进行投资。对儿子的投资是预算部分 $xB$，对女儿的投资是 $(1-x)B$。\n\n投资于儿子的边际适应度回报是来自儿子的适应度分量 $n_m v_m$ 对儿子投资额 $I_m = xB$ 的导数。\n$$\\frac{\\partial (n_m v_m)}{\\partial I_m} = \\frac{\\partial}{\\partial (xB)} \\left(\\frac{xB}{c_m}v_m\\right) = \\frac{v_m}{c_m}$$\n同样，投资于女儿的边际适应度回报是来自女儿的适应度分量 $n_f v_f$ 对女儿投资额 $I_f = (1-x)B$ 的导数。\n$$\\frac{\\partial (n_f v_f)}{\\partial I_f} = \\frac{\\partial}{\\partial ((1-x)B)} \\left(\\frac{(1-x)B}{c_f}v_f\\right) = \\frac{v_f}{c_f}$$\n在 ESS 处，这些边际回报必须相等：\n$$\\frac{v_m}{c_m} = \\frac{v_f}{c_f}$$\n代入比例关系 $v_m \\propto \\frac{1}{N_m}$ 和 $v_f \\propto \\frac{1}{N_f}$（其中比例常数对两者相同），我们得到：\n$$\\frac{1}{c_m N_m} = \\frac{1}{c_f N_f}$$\n这简化为 ESS 种群状态的核心条件，即著名的费雪原理（Fisher's principle）：\n$$c_m N_m = c_f N_f$$\n该条件表明，在 ESS 状态下，种群中对儿子的总亲代投资必须等于对女儿的总亲代投资。\n\n问题要求的是按数量计的初级性别比 $p$ 的条件。根据定义，$p = \\frac{N_m}{N_m + N_f}$，雌性比例为 $1-p = \\frac{N_f}{N_m + N_f}$。我们可以用 $p$ 和总种群数量 $N_{tot} = N_m + N_f$ 来表示 $N_m$ 和 $N_f$：\n$$N_m = p N_{tot}$$\n$$N_f = (1-p) N_{tot}$$\n将这些表达式代入 ESS 条件 $c_m N_m = c_f N_f$ 中：\n$$c_m (p N_{tot}) = c_f ((1-p) N_{tot})$$\n由于 $N_{tot}$ 不为零，可以从两边消去，得到留存种群初级性别比 $p$ 成为 ESS 的条件：\n$$c_m p = c_f (1-p)$$\n这是所需推导的第一部分。\n\n为了计算给定成本下的 ESS 初级性别比，我们求解这个关于 $p$ 的方程：\n$$c_m p = c_f - c_f p$$\n$$c_m p + c_f p = c_f$$\n$$p(c_m + c_f) = c_f$$\n$$p = \\frac{c_f}{c_m + c_f}$$\n这是按数量计的 ESS 初级性别比的通用表达式。\n\n问题给出了具体成本 $c_m = 2$ 和 $c_f = 1$。将这些值代入 $p$ 的表达式中：\n$$p = \\frac{1}{2 + 1} = \\frac{1}{3}$$\n这就是按数量计的 ESS 初级性别比。种群在受孕时应由三分之一的雄性和三分之二的雌性组成。这个结果具有直观意义：因为生产儿子的成本是女儿的两倍，所以种群稳定在一个儿子数量是女儿数量一半的点上，从而使对两性的总亲代投资相等。答案是一个精确的有理数。",
            "answer": "$$\\boxed{\\frac{1}{3}}$$"
        },
        {
            "introduction": "在建立了随机交配下的基准模型后，我们现在来探讨一个关键的例外情况：本地配偶竞争 (Local Mate Competition, LMC)。这个思想实验将您置于一个兄弟间为争夺配偶而竞争的场景中，这在许多物种中都很常见。通过确定一个奠基雌性应该产生的最佳雄性数量，您将看到种群结构如何能够戏剧性地改变演化结果，使其偏离Fisher的预测，从而产生高度偏向雌性的性别比。",
            "id": "2709690",
            "problem": "一个结构化种群由多个亚种群构成。每一代，每个亚种群都由单个受精雌性建立，因此交配在其后代扩散之前完全在后代内部进行。这是局部配偶竞争（Local Mate Competition, LMC）的经典案例。令 $B \\in \\mathbb{N}$ 且 $B \\ge 2$ 表示雌性奠基者产生的有限仔代规模（窝卵数）。她将这 $B$ 个后代中的 $S \\in \\{0,1,2,\\ldots,B\\}$ 个分配为雄性，其余 $B-S$ 个为雌性。假设雄性不扩散，也不在出生亚种群之外繁殖，且每个雄性都具有无限的交配能力。所有雌性后代在扩散前都在亚种群内部交配，并且只有交配过的雌性后代才会扩散并为下一代做出贡献。假设在有配偶可用的条件下，同胞之间随机配对，因此当 $S \\ge 1$ 时，所有 $B-S$ 个雌性后代都能交配；当 $S=0$ 时，没有雌性后代能交配。\n\n请仅使用这些假设和雄性后代预期交配机会的定义（即，当 $S \\ge 1$ 时，在同胞随机匹配的情况下，每个雄性后代的预期交配次数等于 $\\frac{B-S}{S}$；当 $S=0$ 时，预期交配次数为 $0$），从第一性原理推导出使奠基者雌性的预期受精雌性后代数量最大化的整数 $S$，从而也最大化其通过雌性后代实现的预期基因传递。请明确说明作为 $B$ 的函数的最优雄性后代整数数量，并基于雄性后代的预期交配机会给出清晰的论证。你的最终答案必须是该最优整数。无需四舍五入，也无需单位。",
            "solution": "问题要求推导，在一个规模固定为 $B$ 的仔代中，雌性奠基者应产下的能使其预期受精雌性后代数量最大化的雄性后代数量 $S$。仔代规模 $B$ 是一个满足 $B \\ge 2$ 的整数，雄性后代的数量 $S$ 是集合 $\\{0, 1, 2, \\ldots, B\\}$ 中的一个整数。\n\n令 $N_d(S)$ 表示作为雄性后代数量 $S$ 的函数的预期受精雌性后代数量。仔代中的雌性后代数量为 $B-S$。问题陈述提供了雌性后代受精的条件：\n1.  如果 $S=0$，仔代中没有雄性，因此没有雌性后代可以交配。所以，$N_d(0) = 0$。\n2.  如果 $S \\ge 1$，则至少有一个雄性存在。鉴于雄性具有无限的交配能力且同胞间随机交配，仔代中所有的 $B-S$ 个雌性后代都将受精。因此，对于 $S \\in \\{1, 2, \\ldots, B\\}$，$N_d(S) = B-S$。\n\n结合这两个条件，需要最大化的目标函数是：\n$$\nN_d(S) = \\begin{cases} 0 & \\text{if } S = 0 \\\\ B-S & \\text{if } S \\in \\{1, 2, \\ldots, B\\} \\end{cases}\n$$\n我们的目标是找到在定义域 $\\{0, 1, \\ldots, B\\}$ 内使 $N_d(S)$ 最大化的整数 $S$。\n\n我们首先比较 $S=0$ 和 $S=1$ 时的结果。\n当 $S=0$ 时，$N_d(0) = 0$。\n当 $S=1$ 时，$N_d(1) = B-1$。\n根据题目所给条件，$B \\ge 2$，这意味着 $B-1 \\ge 1$。\n因此，$N_d(1) = B-1 > 0 = N_d(0)$。这表明，产下一个雄性后代是比不产雄性后代严格更优的策略。因此，$S$ 的最优值必须大于或等于 $1$。\n\n接下来，我们在受限定义域 $S \\in \\{1, 2, \\ldots, B\\}$ 上分析函数 $N_d(S)$。在此范围内，函数为 $N_d(S) = B-S$。这是一个关于 $S$ 的线性函数，斜率为 $-1$。因此，当 $S \\ge 1$ 时，$N_d(S)$ 是一个关于 $S$ 的严格递减函数。\n这意味着对于满足 $1 \\le S_1 < S_2 \\le B$ 的任意两个整数 $S_1$ 和 $S_2$，以下不等式成立：\n$$N_d(S_1) = B - S_1 > B - S_2 = N_d(S_2)$$\n因此，在定义域 $S \\in \\{1, 2, \\ldots, B\\}$ 内，函数 $N_d(S)$ 在 $S$ 的最小可能整数值处取得其最大值，即 $S=1$。\n\n因为当 $S \\ge 1$ 时 $S=1$ 使 $N_d(S)$ 最大化，并且我们已经证明在 $S=1$ 处的值大于在 $S=0$ 处的值，所以我们得出结论：$N_d(S)$ 在整个定义域 $S \\in \\{0, 1, \\ldots, B\\}$ 上的全局最大值出现在 $S=1$ 处。\n\n从雄性后代预期交配机会的角度来看，其论证如下。雌性奠基者在将其固定的繁殖投入 $B$ 分配给雄性和雌性后代时面临一种权衡。她的目标是最大化受精雌性后代的数量。\n产下第一个雄性后代（即选择 $S=1$ 而非 $S=0$）是至关重要的。它将结果从 $0$ 个受精雌性后代转变为 $B-1$ 个受精雌性后代。这单个雄性后代不面临来自其他雄性的竞争，预期将获得仔代中所有可用的交配机会，其数量为 $B-1$。这个雄性后代的预期交配次数为 $\\frac{B-1}{1} = B-1$。\n\n现在，考虑产下第二个雄性后代的边际效应（将 $S$ 从 $1$ 增加到 $2$）。这个分配决策的直接代价是减少一个雌性后代，使雌性后代的数量从 $B-1$ 降至 $B-2$。因此，受精雌性后代的数量也减少到 $B-2$。就其陈述的目标而言，这第二个雄性后代没有给雌性奠基者带来任何额外的好处，因为根据无限交配能力的假设，第一个雄性后代就已经足以使所有可用的雌性后代受精。相反，第二个雄性后代的存在引入了竞争。这两个雄性后代现在必须分享 $B-2$ 个可用的交配机会，每个雄性后代的预期交配次数下降到 $\\frac{B-2}{2}$。\n\n总的来说，对于任何 $S \\ge 1$，每额外产下一个雄性后代，都以牺牲一个雌性后代为代价。这直接导致受精雌性后代的数量减少一个，从 $B-S$ 降至 $B-(S+1)$。额外的雄性后代只会加剧兄弟之间为争夺不断缩小的姐妹群体而进行的局部配偶竞争的强度，这反映在随着 $S$ 增加，每个雄性后代的预期交配次数 $\\frac{B-S}{S}$ 的值不断减小上。由于目标是严格最大化受精雌性后代的数量，而任何超出第一个的雄性后代都对实现此目标有害，因此雌性奠基者的最优策略是产下确保受精所需的绝对最少数量的雄性后代。这个数量恰好是1。\n\n因此，雄性后代的最优整数数量是 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "最后，我们研究驱动性别比演化的另一个强大因素：本地资源竞争 (Local Resource Competition, LRC)。在这种情境下，竞争并非为了配偶，而是为了资源，并且主要发生在某一性别内部。本练习将让您模拟雌性后代间的资源竞争（由参数 $k$ 描述）如何影响母亲的最优投资策略，从而揭示为何即使在随机交配的条件下，偏向雄性的投资也可能演化出来。",
            "id": "2709735",
            "problem": "考虑一个大型、随机交配且种群动态稳定的群体，其中每个母体的固定繁殖资源预算被归一化为$1$。她将此预算的一部分 $x \\in [0,1]$ 分配给产生雌性后代，剩余部分 $1 - x$ 分配给产生雄性后代。假设如下：\n\n- 单位投资的线性回报：在没有任何性别特异性修饰因子的情况下，投资于任一性别的单位资源为母体带来相同的基线繁殖价值。\n- 由交配竞争驱动的频率依赖性繁殖成功率：在一个充分混合的种群中，一个性别的单位繁殖成功率与全种群对该性别的总投资成反比。如果种群对雌性后代的平均投资为$y$，那么雄性后代的实现单位繁殖成功率与$1/(1 - y)$成比例，雌性后代的实现单位繁殖成功率与$1/y$成比例。\n- 仅在雌性后代间存在局部资源竞争：雌性后代会对母体适应度造成一个额外的局部竞争成本，该成本由参数$k > 0$描述，而雄性后代则没有。在线性回报下，将此竞争建模为对雌性后代繁殖价值的一个乘性贬值，贬值因子为$1/(1 + k)$，且与$x$和$y$无关。也就是说，单位对雌性后代的投资所产生的回报，是在没有局部竞争成本情况下本应获得的基线实现回报的$1/(1+k)$倍。\n\n在这些假设下，一个位于平均投资为$y$的定居种群中的焦点母体，其适应度为\n$$\nW(x \\mid y) \\propto x \\cdot \\frac{1}{(1+k)\\,y} \\;+\\; (1-x) \\cdot \\frac{1}{1-y},\n$$\n其中比例常数代表基线繁殖价值单位，在比较中可以消去。\n\n使用演化稳定策略（ESS）性别比的定义，即一种投资策略$y^{\\ast}$，使得任何偏离该策略的稀有突变体$x$都无法增加其频率（也就是说，在$x = y = y^{\\ast}$时，对$x$的选择梯度为零），推导出投资于雌性后代的ESS比例$r^{\\ast}(k)$，并表示为关于$k$的闭式表达式。最终答案以无单位的解析表达式形式给出。",
            "solution": "问题陈述已经过验证，被认为是有效的。它提出了一个适定且有科学依据的演化博弈论问题，具体涉及局部资源竞争下性别比的演化。所有定义和参数均已提供，整个设定内部一致且没有歧义。\n\n目标是确定母体分配给雌性后代的繁殖资源的演化稳定策略（ESS）比例。对于一个焦点母体，该投资比例用$x \\in [0,1]$表示，而种群的平均投资比例为$y$。繁殖预算被归一化为$1$。在一个平均策略为$y$的种群中，一个策略为$x$的母体的适应度由下式给出：\n$$ W(x \\mid y) \\propto x \\cdot \\frac{1}{(1+k)\\,y} \\;+\\; (1-x) \\cdot \\frac{1}{1-y} $$\n此处，$k > 0$ 是一个衡量雌性后代间局部资源竞争强度的参数。项 $\\frac{1}{(1+k)y}$ 代表通过雌性后代获得的单个体适应度回报，该回报因局部竞争（因子 $1+k$）而贬值，并依赖于种群中雌性后代的频率（因子 $1/y$）。类似地，项 $\\frac{1}{1-y}$ 是通过雄性后代获得的单个体适应度回报。\n\n一个ESS，我们记为$y^{\\ast}$，是这样一种策略：如果整个种群都采用它，任何具有不同策略 $x \\neq y^{\\ast}$ 的稀有突变体都无法入侵。对于本问题给出的策略线性回报模型，当投资于两种性别的边际适应度回报相等时，存在一个内部ESS（$0 < y^{\\ast} < 1$）。这等同于找到这样一个种群策略 $y = y^{\\ast}$，在该策略下，对个体策略$x$的选择梯度为零。\n\n选择梯度 $S(y)$ 衡量适应度景观的斜率，定义为个体适应度对其自身策略的偏导数：\n$$ S(y) = \\frac{\\partial W(x \\mid y)}{\\partial x} $$\n比例常数可以忽略，因为它不影响导数的符号或零点。我们计算关于$x$的导数：\n$$ \\frac{\\partial}{\\partial x} \\left[ x \\cdot \\frac{1}{(1+k)y} + (1-x) \\cdot \\frac{1}{1-y} \\right] = \\frac{1}{(1+k)y} - \\frac{1}{1-y} $$\n通过将此选择梯度设为零来找到ESS $y^{\\ast}$：\n$$ S(y^{\\ast}) = \\frac{1}{(1+k)y^{\\ast}} - \\frac{1}{1-y^{\\ast}} = 0 $$\n该方程表示在ESS处，通过雌性后代和雄性后代获得的边际适应度回报相等。为求$y^{\\ast}$，我们解此方程：\n$$ \\frac{1}{(1+k)y^{\\ast}} = \\frac{1}{1-y^{\\ast}} $$\n通过交叉相乘，我们得到：\n$$ 1 - y^{\\ast} = (1+k)y^{\\ast} $$\n展开右侧：\n$$ 1 - y^{\\ast} = y^{\\ast} + k y^{\\ast} $$\n然后，我们将所有包含$y^{\\ast}$的项移到等式的一边：\n$$ 1 = y^{\\ast} + y^{\\ast} + k y^{\\ast} $$\n$$ 1 = 2y^{\\ast} + k y^{\\ast} $$\n提出因子$y^{\\ast}$：\n$$ 1 = y^{\\ast}(2+k) $$\n解出$y^{\\ast}$，我们得到对雌性后代的ESS投资比例：\n$$ y^{\\ast} = \\frac{1}{2+k} $$\n问题要求将此表达式记为$r^{\\ast}(k)$。因此，对雌性后代的ESS投资比例为：\n$$ r^{\\ast}(k) = \\frac{1}{2+k} $$\n为确保此均衡是稳定的，我们必须验证二阶条件。对于一个ESS，这要求该均衡是收敛稳定的。这意味着，如果种群策略$y$轻微偏离$y^{\\ast}$，选择压力应使其恢复。如果选择梯度对种群策略的导数在ESS处为负，即 $\\frac{d S(y)}{dy}\\big|_{y=y^{\\ast}} < 0$，则该条件成立。\n$S(y)$的导数是：\n$$ \\frac{dS(y)}{dy} = \\frac{d}{dy}\\left(\\frac{1}{(1+k)y} - \\frac{1}{1-y}\\right) = -\\frac{1}{(1+k)y^2} - \\frac{1}{(1-y)^2} $$\n由于$k > 0$且$y \\in (0,1)$，分母 $(1+k)y^2$ 和 $(1-y)^2$ 均为正。因此，导数中的两项均为负，从而对于所有$y \\in (0,1)$，$\\frac{dS(y)}{dy}$ 恒为负。这证实了 $y^{\\ast} = \\frac{1}{2+k}$ 是一个连续稳定策略，因此是一个有效的ESS。",
            "answer": "$$\\boxed{\\frac{1}{2+k}}$$"
        }
    ]
}