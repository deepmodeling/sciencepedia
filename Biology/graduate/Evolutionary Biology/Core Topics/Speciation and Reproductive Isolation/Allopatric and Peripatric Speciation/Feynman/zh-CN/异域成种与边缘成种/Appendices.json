{
    "hands_on_practices": [
        {
            "introduction": "异域物种形成的一个核心原则是，生殖隔离使得种群能够独立地进行遗传分化。本练习将演示如何量化这种分化，并将其与种群分化的时间联系起来。我们将运用溯祖理论来推导两个种群之间的预期遗传分化度（$d_{XY}$），这个基础方程 $d_{XY} = 2\\mu T + \\theta_{A}$ 将分化度与分化时间（$T$）、突变率（$\\mu$）以及祖先种群大小（$\\theta_A$）联系起来。通过完成这个推导并将其应用于假设数据 ，你将在分子定年方面获得实践技能，并对种群历史如何编码于基因组数据中形成更深的直觉。",
            "id": "2690475",
            "problem": "考虑两个异域种群 $X$ 和 $Y$，它们在 $T$ 代前从一个有效种群大小恒定为 $N_{eA}$ 的祖先泛交种群中分化而来。假设一个中性无限位点突变模型，每位点每代的突变率为 $\\mu$，分化后无基因流，且没有选择改变中性突变率。设从种群 $X$ 中抽取的一个单倍体基因组与从种群 $Y$ 中抽取的一个单倍体基因组之间的每位点预期成对差异表示为 $d_{XY}$。祖先种群常用的群体遗传学参数为 $\\theta_{A} = 4 N_{eA} \\mu$。\n\n任务：\n1) 从溯祖推断和谱系上的泊松突变过程（在无限位点模型下）出发，推导从异域分化了 $T$ 代的种群 $X$ 和 $Y$ 中抽取的两个谱系的预期差异 $d_{XY} = 2 \\mu T + \\theta_{A}$。\n\n2) 你对来自种群 $X$ 的一个单倍体基因组和来自种群 $Y$ 的一个单倍体基因组进行测序，比对 $L$ 个独立、中性演化的位点，计算成对差异数 $D$，并使用 $\\hat{d}_{XY} = D/L$ 作为 $d_{XY}$ 的估计量。假设你有一个祖先参数 $\\theta_{A}$ 的独立估计值，并且 $\\mu$ 已知。请用 $\\hat{d}_{XY}$、$\\theta_{A}$ 和 $\\mu$ 推导分化时间 $T$ 的估计量 $\\hat{T}$。\n\n3) 将你的估计量应用于以下数据，以获得分化时间的数值估计。使用 $L = 3.0 \\times 10^{6}$ 个位点，$D = 6.6 \\times 10^{4}$ 个成对差异，$\\mu = 1.0 \\times 10^{-8}$ 每位点每代，以及 $\\theta_{A} = 2.0 \\times 10^{-3}$。用“代”作为单位表示最终的 $T$ 的估计值，并将答案四舍五入到三位有效数字。",
            "solution": "所提出的问题是溯祖理论和群体遗传学中的一个标准练习。它具有科学依据，问题阐述清晰，并且客观。其表述没有缺陷。我们将按要求进行推导和计算。\n\n问题分为三个部分。我们将依次解决每个部分。\n\n第1部分：预期成对差异 $d_{XY}$ 的推导。\n我们考虑两个单倍体基因组，一个从种群 $X$ 抽样，一个从种群 $Y$ 抽样。我们向后追溯这两个谱系的祖先。种群 $X$ 和 $Y$ 已经隔离了 $T$ 代。在此期间，这两个谱系存在于不同的种群中，不能发生溯祖合并。在异域分化阶段，这两个谱系经历的总时间是来自 $X$ 的谱系 $T$ 代，以及来自 $Y$ 的谱系 $T$ 代，总计为 $2T$ 代的独立演化。\n\n在过去的 $T$ 代时，两个谱系都进入了共同的祖先种群，该种群具有恒定的有效大小 $N_{eA}$。在标准的二倍体种群 Wright-Fisher 模型下，任意一代中随机选择的两个谱系发生溯祖合并的概率是 $\\frac{1}{2N_{eA}}$。溯祖合并发生前的时间 $T_c$ 是一个几何分布的随机变量，其成功概率为 $p = \\frac{1}{2N_{eA}}$。因此，在这个祖先种群中发生溯祖合并的预期时间是 $E[T_c] = \\frac{1}{p} = 2N_{eA}$ 代。\n\n从现在到两个抽样谱系的最近共同祖先（MRCA）的总预期时间 $E[T_{MRCA}]$，是在不同种群中度过的时间与在祖先种群中发生溯祖合并的预期时间之和：\n$$E[T_{MRCA}] = T + E[T_c] = T + 2N_{eA}$$\n\n连接两个谱系的谱系总长度，从末端（现在）到它们的最近共同祖先，是到最近共同祖先时间的两倍。设此总预期分支长度为 $E[L_{total}]$。\n$$E[L_{total}] = 2 \\times E[T_{MRCA}] = 2(T + 2N_{eA}) = 2T + 4N_{eA}$$\n\n在无限位点模型下，突变以每位点每代 $\\mu$ 的恒定速率，沿着谱系的分支作为泊松过程累积。每位点的预期替换数 $d_{XY}$，是总预期分支长度与突变率的乘积。\n$$d_{XY} = E[L_{total}] \\times \\mu = (2T + 4N_{eA})\\mu = 2\\mu T + 4N_{eA}\\mu$$\n\n问题将祖先种群遗传学参数定义为 $\\theta_A = 4N_{eA}\\mu$。将此定义代入我们关于 $d_{XY}$ 的表达式中：\n$$d_{XY} = 2\\mu T + \\theta_{A}$$\n这完成了第一部分要求的推导。\n\n第2部分：分化时间 $T$ 的估计量的推导。\n我们从第1部分推导出的关系式开始：\n$$d_{XY} = 2\\mu T + \\theta_A$$\n我们的目标是用其他参数来表示 $T$。这是一个简单的代数重排。\n$$d_{XY} - \\theta_A = 2\\mu T$$\n$$T = \\frac{d_{XY} - \\theta_A}{2\\mu}$$\n为了构建 $T$ 的估计量，记为 $\\hat{T}$，我们用其经验估计值 $\\hat{d}_{XY}$ 替换理论量 $d_{XY}$。值 $\\hat{d}_{XY}$ 的计算方法是观察到的成对差异数 $D$ 除以比对的总位点数 $L$。参数 $\\theta_A$ 和 $\\mu$ 作为已知常数给出。\n因此，分化时间的估计量是：\n$$\\hat{T} = \\frac{\\hat{d}_{XY} - \\theta_A}{2\\mu}$$\n其中 $\\hat{d}_{XY} = \\frac{D}{L}$。这完成了第二部分。\n\n第3部分：分化时间 $T$ 的数值估计。\n我们得到以下数据：\n-   比对的位点数，$L = 3.0 \\times 10^{6}$。\n-   成对差异数，$D = 6.6 \\times 10^{4}$。\n-   每位点每代突变率，$\\mu = 1.0 \\times 10^{-8}$。\n-   祖先种群参数，$\\theta_A = 2.0 \\times 10^{-3}$。\n\n首先，我们计算成对差异的估计值 $\\hat{d}_{XY}$：\n$$\\hat{d}_{XY} = \\frac{D}{L} = \\frac{6.6 \\times 10^{4}}{3.0 \\times 10^{6}} = 2.2 \\times 10^{-2}$$\n\n接下来，我们将 $\\hat{d}_{XY}$ 以及 $\\theta_A$ 和 $\\mu$ 的给定值代入我们的 $T$ 估计量中：\n$$\\hat{T} = \\frac{\\hat{d}_{XY} - \\theta_A}{2\\mu} = \\frac{(2.2 \\times 10^{-2}) - (2.0 \\times 10^{-3})}{2 \\times (1.0 \\times 10^{-8})}$$\n\n我们进行计算。分子是：\n$$2.2 \\times 10^{-2} - 2.0 \\times 10^{-3} = 0.022 - 0.002 = 0.020 = 2.0 \\times 10^{-2}$$\n分母是：\n$$2 \\times (1.0 \\times 10^{-8}) = 2.0 \\times 10^{-8}$$\n现在我们计算最终的比率：\n$$\\hat{T} = \\frac{2.0 \\times 10^{-2}}{2.0 \\times 10^{-8}} = 1.0 \\times 10^{6}$$\n估计的分化时间是 $1,000,000$ 代。问题要求答案四舍五入到三位有效数字。用科学记数法表示，这是 $1.00 \\times 10^{6}$。",
            "answer": "$$ \\boxed{1.00 \\times 10^{6}} $$"
        },
        {
            "introduction": "周域物种形成通常涉及在小型、孤立的建立者种群中独特的演化动态。本实践探讨了一种强大的机制：遗传漂变在固定那些在大型种群中会受到选择淘汰的等位基因中的作用。我们将研究一个亚显性染色体倒位的演化命运，这种倒位在杂合子中具有劣势（$s_h > 0$）。利用扩散理论的近似方法 ，我们可以确定遗传漂变克服这种负选择并将倒位驱动至固定的条件，从而形成显著的生殖屏障。这个练习阐明了遗传漂变在小种群中的“创造性”力量，这是周域物种形成模型的基石，并展示了它如何能导致生殖隔离的快速演化。",
            "id": "2690538",
            "problem": "一个大陆种群经历范围扩张，在一个离岸岛屿上形成了一个小的奠基者种群，从而产生了一个周域隔离种群。假设在定殖之后，该岛屿种群与大陆之间的基因流可以忽略不计，并且可以被模拟为一个具有恒定有效种群大小（$N_e$）的 Wright-Fisher 种群。岛上出现了一个新的单拷贝染色体倒位。该倒位是杂合子劣势的：与两种纯合子相比，杂合子具有相对适合度劣势 $s_h>0$，因此当该倒位稀有时，它会经历阻止其频率增加的定向选择。\n\n使用针对 Wright-Fisher 种群中选择-漂变动态的扩散近似法，以及一个经过充分检验的中性基线，即单个新等位基因的固定概率为 $1/(2N_e)$。在轻度杂合子劣势和初始频率较小的情况下，普遍观察到有害变异的固定概率相对于中性情况呈指数级抑制，其抑制程度与乘积 $N_e s_h$ 成正比。在这种周域隔离的背景下，定义“漂变可推动杂合子劣势的倒位走向固定”的条件为：其在岛上的固定概率至少是中性固定概率的 $r$ 倍。\n\n推导在此条件下漂变可推动倒位走向固定的、关联 $N_e$、$s_h$ 和 $r$ 的解析条件，然后计算当 $N_e = 500$ 且 $r = 0.2$ 时，仍满足此条件的最大杂合子劣势 $s_h^{\\ast}$。将 $s_h^{\\ast}$ 报告为一个纯数（无单位），并将您的答案四舍五入到四位有效数字。",
            "solution": "首先对问题陈述进行验证。\n\n逐字提取给定条件：\n- 一个大陆种群在一个离岸岛屿上形成了一个奠基者种群（周域隔离种群）。\n- 该岛屿种群的基因流可以忽略不计，并被模拟为一个 Wright-Fisher 种群。\n- 恒定的有效种群大小为 $N_e$。\n- 出现了一个新的单拷贝染色体倒位。\n- 该倒位是杂合子劣势的：杂合子具有相对适合度劣势 $s_h > 0$。\n- 单个新等位基因的中性基线固定概率为 $\\frac{1}{2N_e}$。\n- 有害变异的固定概率相对于中性情况呈指数级抑制，其抑制程度与乘积 $N_e s_h$ 成正比。\n- “漂变可推动杂合子劣势的倒位走向固定”的条件被定义为：其固定概率至少是中性固定概率的 $r$ 倍。\n- 用于计算的数值：$N_e = 500$ 和 $r = 0.2$。\n- 目标是推导关联 $N_e$、$s_h$ 和 $r$ 的解析条件，然后计算在给定数值下满足此条件的最大杂合子劣势 $s_h^{\\ast}$，并四舍五入到四位有效数字。\n\n验证结论：\n该问题具有科学依据，提法明确，且客观。它描述了理论群体遗传学中的一个经典场景，使用了诸如 Wright-Fisher 过程和扩散近似等标准模型。由于遗传漂变，杂合子劣势等位基因在小种群中固定的前提是演化生物学中一个有效且重要的概念，尤其是在物种形成模型中。所提供的信息是自洽的，足以推导出唯一解。因此，该问题被认定为有效。\n\n解：\n设 $P_{neutral}$ 为一个新中性等位基因的固定概率。根据问题描述，此概率为：\n$$ P_{neutral} = \\frac{1}{2N_e} $$\n这对应于一个新突变以单拷贝形式出现，在一个有效大小为 $N_e$ 的二倍体种群中，其初始频率为 $p_0 = \\frac{1}{2N_e}$。\n\n设 $P_{fix}(s_h)$ 为该杂合子劣势倒位的固定概率。问题指出，当该倒位稀有时是有害的，并且其固定概率相对于中性情况呈指数级抑制。抑制因子与乘积 $N_e s_h$ 成正比。这可以用数学方式表示为：\n$$ P_{fix}(s_h) = P_{neutral} \\cdot \\exp(-k N_e s_h) $$\n其中 $k$ 为某个比例常数。对于一个具有恒定选择系数 $s$ 的轻度有害等位基因，其固定概率的既定扩散近似为 $P_{fix}(s) \\approx P_{neutral} \\exp(-2 N_e s)$。在一个杂合子劣势等位基因的案例中，若杂合子适合度为 $1-s_h$（相对于野生型纯合子适合度为 $1$），当该等位基因稀有时，它主要存在于杂合子中。因此，它经历的有效选择系数大小为 $s_h$。我们因此采用比例常数为 $k=2$ 的标准近似。该倒位固定概率的模型为：\n$$ P_{fix}(s_h) = \\frac{1}{2N_e} \\exp(-2 N_e s_h) $$\n问题定义的“漂变可推动倒位走向固定”的条件是其固定概率至少为中性概率的 $r$ 倍。我们可以将其写成一个不等式：\n$$ P_{fix}(s_h) \\ge r \\cdot P_{neutral} $$\n代入概率的表达式，得到：\n$$ \\frac{1}{2N_e} \\exp(-2 N_e s_h) \\ge r \\left( \\frac{1}{2N_e} \\right) $$\n由于 $N_e$ 是种群大小，所以它是正数，因此 $\\frac{1}{2N_e}$ 也是正数。我们可以在不等式两边同乘以 $2N_e$ 而不改变不等号的方向：\n$$ \\exp(-2 N_e s_h) \\ge r $$\n为了求解包含 $s_h$ 的关系式，我们对两边取自然对数。自然对数是一个单调递增函数，所以不等号的方向保持不变：\n$$ \\ln(\\exp(-2 N_e s_h)) \\ge \\ln(r) $$\n$$ -2 N_e s_h \\ge \\ln(r) $$\n为了分离出 $s_h$，我们必须除以 $-2 N_e$。由于 $N_e > 0$，$-2N_e$ 是一个负数。不等式两边同除以一个负数会使不等号的方向反转：\n$$ s_h \\le \\frac{\\ln(r)}{-2 N_e} $$\n$$ s_h \\le -\\frac{\\ln(r)}{2 N_e} $$\n这就是关联 $N_e$、$s_h$ 和 $r$ 的解析条件。它也可以写成 $s_h \\le \\frac{\\ln(1/r)}{2 N_e}$。由于 $r$ 是一个满足 $0 < r \\le 1$ 的分数，$\\ln(r)$ 是非正数，因此右侧是非负数，这与给定条件 $s_h > 0$（对于 $r < 1$）相符。\n\n问题的第二部分要求计算当 $N_e = 500$ 和 $r = 0.2$ 时，满足此条件的最大杂合子劣势，我们记为 $s_h^{\\ast}$。$s_h$ 的最大值出现在不等式取等号时：\n$$ s_h^{\\ast} = -\\frac{\\ln(r)}{2 N_e} $$\n代入给定值：\n$$ N_e = 500 $$\n$$ r = 0.2 $$\n我们计算 $s_h^{\\ast}$：\n$$ s_h^{\\ast} = -\\frac{\\ln(0.2)}{2 \\cdot 500} = -\\frac{\\ln(0.2)}{1000} $$\n$0.2$ 的自然对数是 $\\ln(0.2) = \\ln(\\frac{1}{5}) = -\\ln(5)$。\n$$ s_h^{\\ast} = -\\frac{-\\ln(5)}{1000} = \\frac{\\ln(5)}{1000} $$\n使用数值 $\\ln(5) \\approx 1.609437912$：\n$$ s_h^{\\ast} \\approx \\frac{1.609437912}{1000} = 0.001609437912 $$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$6$、$0$ 和 $9$。其后的数字是 $4$，小于 $5$，因此我们向下舍入。\n$$ s_h^{\\ast} \\approx 0.001609 $$\n这是在有效种群大小为 $500$ 的情况下，杂合子劣势倒位的固定概率至少为中性固定概率 $20\\%$ 时，杂合子劣势所能达到的最大值。",
            "answer": "$$\\boxed{0.001609}$$"
        },
        {
            "introduction": "当异域分化的种群再次相遇（二次接触）时，预先存在的合子后隔离（例如，杂种不育或不活）可以驱动合子前隔离的演化。这个过程被称为“强化”（reinforcement）。本问题要求你从第一性原理出发建立一个适应度模型，以确定一个促进选型交配的等位基因何时会扩散。你将需要推导出选择性行为成本（$c^*$）的关键阈值，并将其与避免产生不适应杂种的收益进行权衡 。通过推导这个条件，你将理解支配强化过程的精细权衡，并领会选择如何通过阻止代价高昂的杂交来最终完成物种形成的过程。",
            "id": "2690459",
            "problem": "两个异域种群进入次级接触。它们之间的杂交后代相对于同种后代，其生存力遭受幅度为 $s \\in (0,1)$ 的比例性下降。在目标种群中，一个稀有的等位基因 $A$ 按如下方式增加选择性交配：在其携带者中，比例为 $\\alpha \\in (0,1)$ 的本会发生的异种交配被避免，转而进行同种交配。等位基因 $A$ 的携带者每次交配都会付出大小为 $c \\in (0,1)$ 的直接增殖性繁殖力代价，该代价与交配对象类型无关。设 $p \\in (0,1)$ 表示随机遇到的一个潜在交配对象是异种的概率。假设每次繁殖机会有一次交配尝试，在生存力选择前的基准繁殖力为单位1，并且选择性回避将被避免的异种交配转化为同种交配，除了直接代价 $c$ 之外没有额外的生存力惩罚。\n\n使用自然选择入侵的定义（当一个性状稀有时，如果其携带者的期望绝对适合度超过非携带者，则该性状会增加），从第一性原理出发，以闭合形式推导出代价阈值 $c^{*}$，作为 $s$、$p$ 和 $\\alpha$ 的函数，使得增强（有利于增加选择性交配的选择）加强合子前隔离的条件是当且仅当 $c < c^{*}$。将您的最终结果表示为 $c^{*}$ 的单一解析表达式，不带单位。最终答案中不要提供不等式。",
            "solution": "该问题要求在一个增强模型中，推导出一个促进选择性交配的等位基因被自然选择所偏好的代价阈值 $c^{*}$。稀有等位基因 $A$ 入侵的条件是其携带者的期望绝对适合度 $W_A$ 超过非携带者（等位基因 $a$ 的野生型纯合子）的期望绝对适合度 $W_a$。阈值 $c^{*}$ 是指当这两个适合度值相等（即 $W_A = W_a$）时的代价 $c$ 的值。\n\n首先，我们必须构建非携带者的绝对适合度 $W_a$ 的表达式。携带野生型等位基因 $a$ 的个体随机交配。它不支付与等位基因 $A$ 相关的繁殖力代价 $c$。\n遇到同种交配对象的概率是 $1-p$。其产生的后代是同种的，具有归一化的生存力 $1$。\n遇到异种交配对象的概率是 $p$。其产生的后代是杂交的，生存力有比例为 $s$ 的下降，因此它们的相对生存力是 $1-s$。\n由于基准繁殖力为 $1$，期望绝对适合度 $W_a$ 是这两种交配类型带来的适合度贡献之和，并按其概率加权：\n$$W_a = (1-p) \\times 1 + p \\times (1-s)$$\n简化此表达式可得：\n$$W_a = 1 - p + p - ps = 1 - ps$$\n\n接下来，我们构建稀有等位基因 $A$ 携带者的绝对适合度表达式，记为 $W_A$。等位基因 $A$ 的携带者每次交配尝试都支付一个增殖性繁殖力代价 $c$。因此，其整个适合度表达式将乘以一个因子 $(1-c)$。$A$ 携带者的交配结果因选择性交配偏好而改变。\n遇到同种交配对象的概率是 $1-p$。这次相遇导致同种交配，产生生存力为 $1$ 的后代。\n遇到异种交配对象的概率是 $p$。对于等位基因 $A$ 的携带者，这些潜在异种交配中的比例 $\\alpha$ 被避免并转化为同种交配。因此，这些交配产生生存力为 $1$ 的后代。剩余的比例 $1-\\alpha$ 的异种相遇则按异种交配进行，产生生存力为 $1-s$ 的杂交后代。\n\n在考虑代价 $c$ 之前，存活后代的总期望数是所有可能相遇结果的总和：\n$$ \\text{Fecundity}_{\\text{pre-cost}} = \\underbrace{(1-p) \\times 1}_{\\text{conspecific encounter}} + \\underbrace{p \\left[ \\alpha \\times 1 + (1-\\alpha)(1-s) \\right]}_{\\text{heterospecific encounter}} $$\n让我们简化代价前的繁殖力表达式：\n$$ \\text{Fecundity}_{\\text{pre-cost}} = 1 - p + p\\alpha + p(1-\\alpha)(1-s) $$\n$$ = 1 - p + p\\alpha + p - ps - p\\alpha + p\\alpha s $$\n$$ = 1 - ps + p\\alpha s $$\n绝对适合度 $W_A$ 是这个代价前的繁殖力乘以繁殖力代价因子 $(1-c)$：\n$$ W_A = (1-c)(1 - ps + p\\alpha s) $$\n\n如果 $W_A > W_a$，等位基因 $A$ 的频率将会增加，从而发生增强。定义了对该等位基因有利选择和不利选择之间界限的阈值条件是 $W_A = W_a$。我们令两个适合度表达式相等以求出阈值代价 $c^*$：\n$$ (1-c^*)(1 - ps + p\\alpha s) = 1 - ps $$\n我们可以解出 $c^*$。由于 $p, s, \\alpha \\in (0,1)$，项 $1 - ps + p\\alpha s = (1-ps) + p\\alpha s > 0$，因此我们可以无误地用它来除。\n$$ 1 - c^* = \\frac{1 - ps}{1 - ps + p\\alpha s} $$\n现在，我们分离出 $c^*$：\n$$ c^* = 1 - \\frac{1 - ps}{1 - ps + p\\alpha s} $$\n为了合并这些项，我们通分：\n$$ c^* = \\frac{(1 - ps + p\\alpha s) - (1 - ps)}{1 - ps + p\\alpha s} $$\n$$ c^* = \\frac{1 - ps + p\\alpha s - 1 + ps}{1 - ps + p\\alpha s} $$\n简化分子可得出代价阈值的最终表达式：\n$$ c^* = \\frac{p\\alpha s}{1 - ps + p\\alpha s} $$\n如果偏好等位基因的代价 $c$ 小于这个阈值，即 $c < c^*$，则增强会加强合子前隔离。",
            "answer": "$$\\boxed{\\frac{p \\alpha s}{1 - ps + p \\alpha s}}$$"
        }
    ]
}