{
    "hands_on_practices": [
        {
            "introduction": "为了定量研究邻域物种形成，我们首先需要一种数学语言来描述等位基因频率的空间变化，即基因渐渗带（cline）。双曲正切函数为此类基因渐渗带提供了一个广泛使用且优美的模型。本练习将让你推导该模型的关键属性，特别是其梯度，该梯度直接对应于遗传过渡带的陡峭程度，从而增强你的数学分析能力 。",
            "id": "2740352",
            "problem": "在一个一维的邻域接触区中，考虑一个由扩散和空间变化的自然选择之间的平衡所维持的等位基因频率渐变群。一个广泛使用且得到经验支持的、作为位置$x$函数的平衡等位基因频率的近似是双曲正切渐变群\n$$\np(x) \\;=\\; \\frac{1}{2}\\Big[1+\\tanh\\!\\Big(\\frac{2(x-c)}{w}\\Big)\\Big],\n$$\n其中，$c$是渐变群中心（即$p(x)=\\frac{1}{2}$的空间位置），$w>0$是由扩散和选择决定的宽度参数。仅使用微积分的基本定义以及双曲函数$\\sinh$、$\\cosh$和$\\tanh$，推导空间梯度$\\frac{dp}{dx}$的精确解析表达式，并确定其在渐变群中心的最大值。根据双曲函数的性质，清楚地证明为什么最大值出现在中心位置。\n\n将你的最终答案以一个行矩阵的形式给出，其中第一个条目是$\\frac{dp}{dx}$关于$x$、$c$和$w$的精确表达式，第二个条目是渐变群中心处梯度的精确最大值。无需数值四舍五入，也无需单位。你的答案必须以精确的封闭形式表达式给出。",
            "solution": "问题陈述在科学上是合理的，提法恰当，并包含了所有必要的信息。它是在群体遗传学中一个著名模型上应用微分学的标准练习。双曲正切渐变群是一个正确且广泛使用的近似，它源于更复杂的反应-扩散模型。因此，该问题是有效的，并将提供一个解决方案。\n\n等位基因频率作为空间位置$x$的函数由下式给出\n$$\np(x) = \\frac{1}{2}\\left[1+\\tanh\\left(\\frac{2(x-c)}{w}\\right)\\right]\n$$\n其中$c$是渐变群中心，$w > 0$是宽度。\n\n目标是推导空间梯度$\\frac{dp}{dx}$，并确定其最大值。我们将使用链式法则进行微分。设双曲正切的参数为$u(x) = \\frac{2(x-c)}{w}$。则$p(x) = \\frac{1}{2}(1 + \\tanh(u(x)))$。\n\n$p(x)$关于$x$的导数是\n$$\n\\frac{dp}{dx} = \\frac{dp}{du} \\frac{du}{dx}\n$$\n\n首先，我们求内函数$u(x)$关于$x$的导数：\n$$\n\\frac{du}{dx} = \\frac{d}{dx}\\left(\\frac{2(x-c)}{w}\\right) = \\frac{d}{dx}\\left(\\frac{2x}{w} - \\frac{2c}{w}\\right) = \\frac{2}{w}\n$$\n接着，我们求$p$关于$u$的导数。这需要$\\tanh(u)$的导数。根据定义，$\\tanh(u) = \\frac{\\sinh(u)}{\\cosh(u)}$。使用商法则，我们有：\n$$\n\\frac{d}{du}(\\tanh(u)) = \\frac{\\frac{d}{du}(\\sinh(u))\\cosh(u) - \\sinh(u)\\frac{d}{du}(\\cosh(u))}{\\cosh^2(u)}\n$$\n使用基本定义$\\frac{d}{du}(\\sinh(u)) = \\cosh(u)$和$\\frac{d}{du}(\\cosh(u)) = \\sinh(u)$，这变成：\n$$\n\\frac{d}{du}(\\tanh(u)) = \\frac{\\cosh^2(u) - \\sinh^2(u)}{\\cosh^2(u)}\n$$\n应用基本双曲恒等式$\\cosh^2(u) - \\sinh^2(u) = 1$，我们简化表达式：\n$$\n\\frac{d}{du}(\\tanh(u)) = \\frac{1}{\\cosh^2(u)}\n$$\n现在，我们可以求出$\\frac{dp}{du}$：\n$$\n\\frac{dp}{du} = \\frac{d}{du}\\left(\\frac{1}{2}(1 + \\tanh(u))\\right) = \\frac{1}{2}\\left(0 + \\frac{d}{du}(\\tanh(u))\\right) = \\frac{1}{2 \\cosh^2(u)}\n$$\n使用链式法则结合这些结果，得到空间梯度的表达式：\n$$\n\\frac{dp}{dx} = \\frac{dp}{du} \\frac{du}{dx} = \\left(\\frac{1}{2 \\cosh^2(u)}\\right) \\left(\\frac{2}{w}\\right) = \\frac{1}{w \\cosh^2(u)}\n$$\n将$u(x)$的表达式代回，我们得到答案的第一部分，即空间梯度：\n$$\n\\frac{dp}{dx} = \\frac{1}{w \\cosh^2\\left(\\frac{2(x-c)}{w}\\right)}\n$$\n为了找到该梯度的最大值，我们分析这个表达式。参数$w$是一个正常数。因此，当$\\cosh^2\\left(\\frac{2(x-c)}{w}\\right)$项最小时，$\\frac{dp}{dx}$的值最大。\n\n最大值位置的论证是基于双曲余弦函数的基本性质。函数$\\cosh(z)$在$z=0$处有全局最小值，为$\\cosh(0)=1$。对于任何非零实数$z$，$\\cosh(z) > 1$。因此，函数$\\cosh^2(z)$在$z=0$处也有其全局最小值$1^2 = 1$。\n\n在我们的例子中，参数是$z = \\frac{2(x-c)}{w}$。为了使分母最小化，我们必须将此参数设为零：\n$$\n\\frac{2(x-c)}{w} = 0\n$$\n由于$w \\neq 0$，这意味着$x-c=0$，即$x=c$。这证明了最大梯度恰好出现在渐变群中心$x=c$处。\n\n为了求梯度的最大值，我们将$x=c$代入$\\frac{dp}{dx}$的表达式中：\n$$\n\\left(\\frac{dp}{dx}\\right)_{\\text{max}} = \\frac{1}{w \\cosh^2\\left(\\frac{2(c-c)}{w}\\right)} = \\frac{1}{w \\cosh^2(0)}\n$$\n由于$\\cosh(0)=1$，最大值为：\n$$\n\\left(\\frac{dp}{dx}\\right)_{\\text{max}} = \\frac{1}{w \\cdot 1^2} = \\frac{1}{w}\n$$\n这是答案的第二部分。两个结果分别是梯度的表达式及其最大值。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{w \\cosh^{2}\\left(\\frac{2(x-c)}{w}\\right)} & \\frac{1}{w} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理论模型描述了基因渐渗带的理想形态，但实际研究则需要从野外采集的遗传数据中估计其特征。最大似然估计（Maximum likelihood estimation, MLE）是完成此任务的强大统计框架，它使我们能够找到最能解释观测数据的参数值（例如基因渐渗带的中心和宽度）。本实践将指导你为基因渐渗带数据建立似然函数，这是分析空间遗传模式的研究人员必须掌握的一项基本技能 。",
            "id": "2740240",
            "problem": "一个一维杂交带在经历邻域物种分化的分化种群之间的接触带形成，沿着一个线性样带坐标 $x \\in \\mathbb{R}$ 产生等位基因频率的空间过渡。考虑一个具有等位基因 $A$ 和 $a$ 的单位点、双等位基因座。假设在位置 $x$ 处，等位基因 $A$ 的频率由逻辑渐变线模型建模\n$$\np(x)=\\frac{1}{1+e^{-4(x-c)/w}},\n$$\n其中 $c \\in \\mathbb{R}$ 是渐变线中心，$w \\in \\mathbb{R}_{>0}$ 是渐变线宽度。在 $I$ 个采样点，其坐标为 $\\{x_i\\}_{i=1}^I$，你观察到基因型计数 $\\{n_{AA,i}, n_{Aa,i}, n_{aa,i}\\}$，总数为 $m_i=n_{AA,i}+n_{Aa,i}+n_{aa,i}$。假设在每个位点，个体都处于 Hardy–Weinberg 平衡 (HWE) 状态，且样本在个体间和位点间是独立的。以 HWE 和独立性所蕴含的多项式抽样模型以及最大似然 (ML) 的定义为基本依据，从基因型计数中推导出 $(c,w)$ 的对数似然函数形式，通过对 $p(x_i)$ 应用链式法则获得得分函数，并阐述一种有原则的计算策略来获得 ML 估计值及其近似标准误。\n\n哪个选项正确地指定了所有以下与所述假设一致的元素：(i) 给定基因型计数的 $(c,w)$ 的有效对数似然函数，(ii) 对 $p_i=p(x_i)$ 的导数 $\\partial p_i/\\partial c$ 和 $\\partial p_i/\\partial w$，以及 (iii) 一种适当的 ML 估计策略，包括参数约束和标准误量化？\n\nA. 联合对数似然函数为\n$$\n\\ell(c,w)=\\sum_{i=1}^I\\Big[2\\,n_{AA,i}\\ln p_i+n_{Aa,i}\\ln\\big(2\\,p_i(1-p_i)\\big)+2\\,n_{aa,i}\\ln(1-p_i)\\Big],\n$$\n其中 $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$。导数为\n$$\n\\frac{\\partial p_i}{\\partial c}=-\\frac{4}{w}\\,p_i(1-p_i),\\qquad \\frac{\\partial p_i}{\\partial w}=-\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i).\n$$\n得分分量通过链式法则获得，\n$$\n\\frac{\\partial \\ell}{\\partial \\theta}=\\sum_{i=1}^I\\left[\\frac{2n_{AA,i}+n_{Aa,i}}{p_i}-\\frac{2n_{aa,i}+n_{Aa,i}}{1-p_i}\\right]\\frac{\\partial p_i}{\\partial \\theta},\\quad \\theta\\in\\{c,w\\}.\n$$\n使用诸如 Newton–Raphson 或拟牛顿法等二次可微优化器，在强制 $w>0$ 的条件下（例如，通过重新参数化 $w=e^{\\gamma}$）对 $\\ell(c,w)$ 进行数值最大化。从观测信息的逆，即在最大化点处的 $\\ell(c,w)$ 的负 Hessian 矩阵的逆矩阵，获得近似标准误。\n\nB. 似然函数仅基于杂合子计数，对数似然函数为\n$$\n\\ell(c,w)=\\sum_{i=1}^I n_{Aa,i}\\ln\\big(2\\,p_i(1-p_i)\\big),\n$$\n且 $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$。导数为\n$$\n\\frac{\\partial p_i}{\\partial c}=+\\frac{4}{w}\\,p_i(1-p_i),\\qquad \\frac{\\partial p_i}{\\partial w}=+\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i).\n$$\n通过将导数设为零获得封闭形式的 ML 估计值，得到 $\\hat{c}$ 等于 $n_{Aa,i}$ 最大位点的均值，$\\hat{w}$ 等于这些位点的范围。\n\nC. 将基因型合并为等位基因计数 $K_i=2n_{AA,i}+n_{Aa,i}$，并建模 $K_i\\sim\\mathrm{Binomial}(m_i,p_i)$，得到\n$$\n\\ell(c,w)=\\sum_{i=1}^I\\Big[K_i\\ln p_i+(m_i-K_i)\\ln(1-p_i)\\Big],\n$$\n其中 $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$。导数为\n$$\n\\frac{\\partial p_i}{\\partial c}=-\\frac{4}{w}\\,p_i(1-p_i),\\qquad \\frac{\\partial p_i}{\\partial w}=+\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i).\n$$\n对 $(c,w)$ 使用无约束的 Newton–Raphson 方法，并从曲率矩阵报告标准误。\n\nD. 将观测到的等位基因频率 $y_i=\\dfrac{2n_{AA,i}+n_{Aa,i}}{2m_i}$ 视为均值为 $p_i$、方差为 $\\sigma^2/m_i$ 的高斯分布，并通过最小化以下表达式来估计 $(c,w)$\n$$\n\\sum_{i=1}^I m_i\\big(y_i-p_i\\big)^2\n$$\n其中 $p_i=\\dfrac{1}{1+e^{-4(x_i-c)/w}}$。标准误遵循线性回归公式，并且不需要对 $w$ 施加约束，因为在解附近，平方和在 $(c,w)$ 中是凸的。",
            "solution": "问题陈述提出了一个群体遗传学中的标准最大似然估计任务。在继续之前，我们必须验证其组成部分。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   在位置 $x$ 的等位基因 $A$ 的频率模型是逻辑渐变线：$p(x)=\\frac{1}{1+e^{-4(x-c)/w}}$。\n-   待估计的参数是渐变线中心 $c \\in \\mathbb{R}$ 和渐变线宽度 $w \\in \\mathbb{R}_{>0}$。\n-   数据是在 $I$ 个采样点（坐标为 $\\{x_i\\}_{i=1}^I$）的基因型计数 $\\{n_{AA,i}, n_{Aa,i}, n_{aa,i}\\}$。\n-   位点 $i$ 的个体总数为 $m_i=n_{AA,i}+n_{Aa,i}+n_{aa,i}$。\n-   假设1：在每个位点 $i$，个体都处于 Hardy–Weinberg 平衡 (HWE) 状态。\n-   假设2：样本在个体间和位点间是独立的。\n-   任务是推导 $(c,w)$ 的对数似然函数、得分函数，以及一种获得最大似然 (ML) 估计值及其标准误的计算策略。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据。逻辑渐变线是描述杂交带中等位基因频率过渡的典型模型。在每个空间位置上 HWE 的假设是此类模型中的标准简化假设。基于每个位点独立多项式样本的抽样模型在统计上是常规的。问题阐述清晰，要求推导似然函数及其相关的估计机制，这是统计推断中的一个教科书式问题。术语精确、客观。设置是自洽和一致的；约束 $w>0$ 具有物理意义，因为宽度不能为负。没有违反科学原理、逻辑不一致或含糊不清之处。\n\n**步骤3：结论和行动**\n问题陈述有效。我将继续进行推导并评估所提供的选项。\n\n### 推导与选项分析\n\n**1. 对数似然函数的推导**\n\n在每个位点 $i$ 均处于 Hardy–Weinberg 平衡的假设下，基因型 $AA$、$Aa$ 和 $aa$ 的期望频率分别为 $p_i^2$、$2p_i(1-p_i)$ 和 $(1-p_i)^2$，其中 $p_i = p(x_i)$。对于样本量为 $m_i$ 的个体，观察到的计数 $\\{n_{AA,i}, n_{Aa,i}, n_{aa,i}\\}$ 服从多项式分布。单个位点 $i$ 的似然函数，作为通过 $p_i$ 表达的参数 $(c,w)$ 的函数，由多项式概率质量函数给出：\n$$ L_i(c,w) = \\frac{m_i!}{n_{AA,i}!n_{Aa,i}!n_{aa,i}!} (p_i^2)^{n_{AA,i}} (2p_i(1-p_i))^{n_{Aa,i}} ((1-p_i)^2)^{n_{aa,i}} $$\n由于各站点样本的独立性，总似然是每个站点似然的乘积：$L(c,w) = \\prod_{i=1}^I L_i(c,w)$。对数似然 $\\ell(c,w) = \\ln L(c,w)$ 是各个对数似然之和：\n$$ \\ell(c,w) = \\sum_{i=1}^I \\ln L_i(c,w) = \\sum_{i=1}^I \\left( \\ln\\left(\\frac{m_i!}{n_{AA,i}!n_{Aa,i}!n_{aa,i}!}\\right) + n_{AA,i}\\ln(p_i^2) + n_{Aa,i}\\ln(2p_i(1-p_i)) + n_{aa,i}\\ln((1-p_i)^2) \\right) $$\n为了对 $(c,w)$ 进行最大化，我们可以舍去常数项，得到对数似然的核心部分：\n$$ \\ell(c,w) \\propto \\sum_{i=1}^I \\left( 2n_{AA,i}\\ln p_i + n_{Aa,i}\\ln(2p_i(1-p_i)) + 2n_{aa,i}\\ln(1-p_i) \\right) $$\n这个表达式是一个有效的对数似然函数。它可以被简化。使用对数的性质：\n$$ \\ell(c,w) \\propto \\sum_{i=1}^I \\left( 2n_{AA,i}\\ln p_i + n_{Aa,i}(\\ln 2 + \\ln p_i + \\ln(1-p_i)) + 2n_{aa,i}\\ln(1-p_i) \\right) $$\n再次舍去常数项 $\\sum_i n_{Aa,i}\\ln 2$：\n$$ \\ell(c,w) \\propto \\sum_{i=1}^I \\left( (2n_{AA,i} + n_{Aa,i})\\ln p_i + (n_{Aa,i} + 2n_{aa,i})\\ln(1-p_i) \\right) $$\n这是一组独立二项式试验的对数似然，其中对于每个位点 $i$，我们观察到在 $2m_i$ 个总等位基因中有 $K_i = 2n_{AA,i} + n_{Aa,i}$ 个等位基因 $A$ 的拷贝。在 HWE 下，等位基因计数是 $p_i$ 的充分统计量。\n\n**2. 得分函数分量的推导**\n\n得分函数是对数似然的梯度。对于参数 $\\theta \\in \\{c,w\\}$，我们使用链式法则：$\\frac{\\partial \\ell}{\\partial \\theta} = \\sum_{i=1}^I \\frac{\\partial \\ell}{\\partial p_i} \\frac{\\partial p_i}{\\partial \\theta}$。\n从对数似然的二项式形式，第一项是：\n$$ \\frac{\\partial \\ell}{\\partial p_i} = \\frac{2n_{AA,i} + n_{Aa,i}}{p_i} - \\frac{n_{Aa,i} + 2n_{aa,i}}{1-p_i} $$\n接下来，我们需要 $p_i = p(x_i) = (1+e^{-z_i})^{-1}$ 的导数，其中 $z_i = 4(x_i-c)/w$。逻辑函数的导数是 $\\frac{dp}{dz} = p(1-p)$。\n$z_i$ 的偏导数是：\n$$ \\frac{\\partial z_i}{\\partial c} = \\frac{\\partial}{\\partial c} \\left(\\frac{4(x_i-c)}{w}\\right) = -\\frac{4}{w} $$\n$$ \\frac{\\partial z_i}{\\partial w} = \\frac{\\partial}{\\partial w} \\left(4(x_i-c)w^{-1}\\right) = -4(x_i-c)w^{-2} = -\\frac{4(x_i-c)}{w^2} $$\n对 $\\partial p_i / \\partial \\theta$ 应用链式法则：\n$$ \\frac{\\partial p_i}{\\partial c} = \\frac{dp_i}{dz_i} \\frac{\\partial z_i}{\\partial c} = p_i(1-p_i) \\left(-\\frac{4}{w}\\right) = -\\frac{4}{w} p_i(1-p_i) $$\n$$ \\frac{\\partial p_i}{\\partial w} = \\frac{dp_i}{dz_i} \\frac{\\partial z_i}{\\partial w} = p_i(1-p_i) \\left(-\\frac{4(x_i-c)}{w^2}\\right) = -\\frac{4(x_i-c)}{w^2} p_i(1-p_i) $$\n\n**3. ML 估计的计算策略**\n\n对数似然函数在参数 $(c,w)$ 中是非线性的，因此需要数值优化来找到最大似然估计值 $(\\hat{c}, \\hat{w})$。参数 $w$ 被约束为正，$w>0$。处理这种约束的一个标准方法是重新参数化，例如，通过设置 $w = e^{\\gamma}$ 并在 $(c, \\gamma) \\in \\mathbb{R}^2$ 上执行无约束优化。适用于平滑函数的算法包括二阶导数方法，如 Newton-Raphson 或拟牛顿法（例如 L-BFGS-B，它也可以直接处理 $w$ 上的箱形约束）。\n\n根据标准 ML 理论，MLE 的方差-协方差矩阵可以通过 Fisher 信息矩阵的逆来近似。该矩阵可以通过观测信息矩阵来估计，即在 MLE 处评估的对数似然的 Hessian 矩阵（二阶偏导数矩阵）的负数：\n$$ \\mathrm{Cov}(\\hat{c}, \\hat{w}) \\approx \\left( - \\mathbf{H}_{\\ell}(\\hat{c}, \\hat{w}) \\right)^{-1} = \\begin{pmatrix} -\\frac{\\partial^2 \\ell}{\\partial c^2} & -\\frac{\\partial^2 \\ell}{\\partial c \\partial w} \\\\ -\\frac{\\partial^2 \\ell}{\\partial w \\partial c} & -\\frac{\\partial^2 \\ell}{\\partial w^2} \\end{pmatrix}_{(\\hat{c},\\hat{w})}^{-1} $$\n该逆矩阵对角线元素的平方根提供了 $\\hat{c}$ 和 $\\hat{w}$ 的近似标准误。\n\n### 选项评估\n\n**选项 A：**\n-   **(i) 对数似然函数**：给出的形式 $\\ell(c,w)=\\sum_{i=1}^I\\Big[2\\,n_{AA,i}\\ln p_i+n_{Aa,i}\\ln\\big(2\\,p_i(1-p_i)\\big)+2\\,n_{aa,i}\\ln(1-p_i)\\Big]$，是正确的完整多项式对数似然函数，保留了杂合子的 $\\ln 2$ 项。这是有效的。\n-   得分函数的一般形式也是正确的，使用链式法则从对数似然函数推导得出：$\\frac{\\partial \\ell}{\\partial \\theta}=\\sum_{i=1}^I\\left[\\frac{2n_{AA,i}+n_{Aa,i}}{p_i}-\\frac{2n_{aa,i}+n_{Aa,i}}{1-p_i}\\right]\\frac{\\partial p_i}{\\partial \\theta}$，这与我的推导 $\\sum_i (\\partial \\ell/\\partial p_i) (\\partial p_i/\\partial \\theta)$ 相符。\n-   **(ii) 导数**：导数 $\\frac{\\partial p_i}{\\partial c}=-\\frac{4}{w}\\,p_i(1-p_i)$ 和 $\\frac{\\partial p_i}{\\partial w}=-\\frac{4(x_i-c)}{w^2}\\,p_i(1-p_i)$ 都如上推导所示，是正确的。\n-   **(iii) 估计策略**：所提出的策略——使用 Newton-Raphson 或拟牛顿法进行数值最大化，通过重新参数化强制 $w>0$，并使用观测信息矩阵的逆（负 Hessian 矩阵的逆）来计算标准误——是解决此问题的标准、正确且有原则的方法。\n\n**选项 A 的结论：正确。**\n\n**选项 B：**\n-   **(i) 对数似然函数**：此选项仅使用杂合子计数。这丢弃了大量存在于纯合子计数中的信息，并且不符合应用于完整数据集的最大似然原理。这是一种不正确且低效的方法。\n-   **(ii) 导数**：导数 $\\partial p_i/\\partial c$ 和 $\\partial p_i/\\partial w$ 的正号都是错误的。\n-   **(iii) 估计策略**：提出了一个不存在的封闭解和临时凑合的估计量。这从根本上是错误的；该问题需要数值优化。\n\n**选项 B 的结论：不正确。**\n\n**选项 C：**\n-   **(i) 对数似然函数**：此选项正确地指出问题可以简化为基于等位基因计数 $K_i=2n_{AA,i}+n_{Aa,i}$ 的二项式似然。然而，它错误地将“失败”次数指定为 $m_i-K_i$ 而不是正确的 $2m_i-K_i$，因为等位基因的总数是 $2m_i$。这是似然函数公式中的一个关键错误。\n-   **(ii) 导数**：导数 $\\partial p_i/\\partial w$ 的正号是错误的。\n-   **(iii) 估计策略**：它提出了无约束优化，这是不正确的，因为它未能强制执行必要的约束 $w>0$。\n\n**选项 C 的结论：不正确。**\n\n**选项 D：**\n-   **(i) 似然/模型**：此选项放弃了问题陈述中指定的多项式抽样模型，转而采用加权非线性最小二乘法，假设观测到的等位基因频率呈高斯误差。这是一个不同的统计模型，是一种近似方法，不符合题目要求。\n-   **(iii) 估计策略**：它错误地声称不需要对 $w$ 进行约束，并且目标函数是凸的。该问题是非凸的，且约束 $w>0$ 对参数的物理意义至关重要。声称标准误可以从“线性回归公式”中获得是明显错误的，因为这是一个非线性模型。\n\n**选项 D 的结论：不正确。**\n\n基于此分析，只有选项 A 提供了问题所要求的对数似然函数、必要导数以及适当的估计和推断统计程序的完整且正确的描述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "观察和拟合基因渐渗带是至关重要的第一步，但最终目标是理解产生它的演化过程。一个S形的基因渐渗带模式可能由截然不同的情景产生，例如简单的选择梯度、基因流屏障或分化种群间的次级接触。这个高级思想实验挑战你综合所学知识，设计一个多方面的研究策略，以凭经验区分这些相互竞争的假说，从而实现从模式描述到因果推断的跨越 。",
            "id": "2740355",
            "problem": "一个生态过渡带横跨一个坐标为 $x \\in \\mathbb{R}$ 的线性景观，从 $x=-\\infty$ (生境 A) 到 $x=+\\infty$ (生境 B)。一个目标物种在此连续分布，其扩散特征为每代均方位移 $\\sigma^{2}$、局域普查密度 $N(x)$ 和局域有效种群大小 $N_{e}(x)$。在位置 $x$ 处，非生物环境由一个标量指数 $E(x)$ 概括，该指数在整个生态过渡带上从低到高平滑单调变化，在 $x=0$ 附近变化最陡峭。沿一条样带，在多个 $x$ 位置观测了 $L$ 个非连锁基因座的全基因组单核苷酸多态性 (SNPs)，其中一部分基因座是响应 $E(x)$ 的局域适应候选位点。\n\n考虑三种可以产生S型等位基因频率梯度（跨越 $x$ ）的替代过程模型：\n\n- 模型 $\\mathrm{S}$ (选择梯度)：分歧选择随环境变化，因此一部分基因座在生态过渡带两侧经历相反的选择机制。设 $s(x)$ 表示在给定基因座上，等位基因 $A$ 相对于 $a$ 的选择系数；对于环境相关基因座，$s(x)$ 在 $x=0$ 两侧变号。由于方差为 $\\sigma^{2}$ 的扩散，基因流是连续的。不假设存在历史隔离。\n\n- 模型 $\\mathrm{B}$ (种群屏障)：在以 $x=0$ 为中心的狭窄区域内，有效迁移存在局域性下降，相当于一个对基因流部分渗透的屏障。环境不对目标基因座施加分歧选择，任何梯度都主要由受限的基因流叠加在距离隔离效应之上产生。\n\n- 模型 $\\mathrm{C}$ (次级接触与张力区)：两个在异域分化的谱系在 $x=0$ 处相遇，形成一个杂交带，该杂交带通过在多个基因座上对杂种的选择而维持。这种选择可能源于内在不亲和性或外在多基因座适应不良。该梯度是一个张力区，其位置可能受到 $N(x)$ 和 $\\sigma^{2}$ 空间变异的影响。\n\n从基因流、选择和连锁不平衡的核心定义出发，并且不预先假设任何特定的参数化梯度公式，推导出能够区分这些模型的定性预测，这些预测涉及以下方面：\n\n- 跨基因座的梯度中心和宽度的一致性。\n- 梯度中心与环境剖面 $E(x)$ 之间的关系。\n- 梯度中心附近非连锁基因座间的连锁不平衡模式。\n- 在时间 $t$ 和 $t+\\Delta t$ 重复取样下，梯度位置和宽度的时间动态。\n- 在 $x=0$ 两侧及跨越该点的中性遗传多样性和距离隔离模式。\n\n您可以使用以下数据类型：沿 $x$ 的 $L$ 个非连锁基因座的全基因组等位基因频率、环境测量值 $E(x)$、局域密度估计值 $N(x)$、标记-重捕估算的 $\\sigma^{2}$，以及经过 $\\Delta t$ 代后的时间重采样数据。根据这三个过程的第一性原理预测，在单项研究中，以下哪种检验策略最有可能区分模型 $\\mathrm{S}$、$\\mathrm{B}$ 和 $\\mathrm{C}$？\n\nA. 对所有基因座拟合S型梯度，并仅在先验确定为与环境相关的基因座中检验中心和宽度的一致性；当这些梯度在 $E(x)$ 最陡峭变化处共享一个共同中心时，判定为模型 $\\mathrm{S}$；当这些相同的基因座具有不同的中心时，判定为模型 $\\mathrm{B}$；当仅这些基因座在梯度内显示出较窄的宽度和过度的杂合子亏损时，判定为模型 $\\mathrm{C}$。不分析非连锁基因座之间的连锁不平衡，不包括中性基因座，也不使用时间数据。\n\nB. 联合进行：(i) 对所有基因座拟合梯度，并分别为中性基因座和环境相关基因座量化其梯度中心和宽度的离散度；检验梯度中心与最大 $|dE/dx|$ 位置的对齐情况；(ii) 估计局域内非连锁基因座之间的连锁不平衡作为 $x$ 的函数，并检验在 $x=0$ 附近是否存在峰值；(iii) 通过比较两侧的距离隔离斜率与有效的跨屏障连通性，来估计在 $x=0$ 处的基因流屏障指数；(iv) 量化复合梯度中心在 $\\Delta t$ 时间内的移动及其与 $N(x)$ 或 $\\sigma^{2}$ 空间变异的关联。如果环境相关基因座一致且集中在环境断点上，而中性基因座缺乏一致性且全基因组非连锁连锁不平衡较低，则推断为模型 $\\mathrm{S}$；如果中性基因座和受选择基因座都显示出与 $E(x)$ 无关的一致中心和宽度，且非连锁连锁不平衡较低并有强烈的屏障指数，则推断为模型 $\\mathrm{B}$；如果许多基因座共享一个共同中心，并在 $x=0$ 附近存在过度的非连锁连锁不平衡和哈迪-温伯格偏离，并且梯度向 $N(x)$ 较低的区域表现出时间漂移，则推断为模型 $\\mathrm{C}$。\n\nC. 仅使用环境关联的全基因组扫描来对基因座进行分类，然后计算生态过渡带两侧在固定窗口大小内的 $F_{ST}}$；如果环境相关基因座具有高 $F_{ST}$，则判定为模型 $\\mathrm{S}$；如果中性基因座具有高 $F_{ST}$，则判定为模型 $\\mathrm{B}$；如果两者都具有高 $F_{ST}$，则判定为模型 $\\mathrm{C}$。忽略空间梯度拟合、连锁不平衡和时间动态。\n\nD. 对来自生态过渡带两侧的混合样本应用溯祖种群统计推断，以估计分化时间和迁移率；如果推断出非零的分化时间，则判定为模型 $\\mathrm{C}$；如果跨生态过渡带的迁移率低于同侧内部的迁移率，则判定为模型 $\\mathrm{B}$；否则判定为模型 $\\mathrm{S}$。不分析空间显性的等位基因频率变异、连锁不平衡或环境-梯度对齐。\n\n选择唯一的最佳选项。",
            "solution": "问题陈述在科学上是合理的、阐述清晰且客观的。它提出了群体遗传学中梯度变异的三个典型模型——选择梯度 (S)、种群屏障 (B) 和次级接触/张力区 (C)——并要求使用一套现实的生态学和基因组学数据来设计一个区分它们的策略。该问题是理论演化生物学中的一个有效练习。我们现在将从第一性原理出发，推导区分这些模型的预测。\n\n设 $p(x,t)$ 为在空间坐标 $x$ 和时间 $t$ 处一个等位基因的频率。$p(x,t)$ 的动态由一个反应-扩散-平流方程控制，其一般形式解释了由扩散 (基因流)、选择和漂变引起的变化。\n\n基因流项，在扩散近似下，是 $\\frac{\\sigma^2}{2} \\frac{\\partial^2 p}{\\partial x^2}$，其中 $\\sigma^2$ 是亲代-子代均方扩散距离。该项的作用是使等位基因频率在空间上均一化。\n选择项对于一个简单的共显性基因座是 $s(x) p(1-p)$，其中 $s(x)$ 是局域选择系数。\n漂变是一个随机项，其方差与 $p(1-p)/(2N_e(x))$ 成正比，其中 $N_e(x)$ 是局域有效种群大小。\n\n我们基于这些原理分析每个模型的定性预测。\n\n**模型 S：选择梯度**\n该模型假定梯度是由空间变化的性状选择与均一化基因流之间的平衡来维持的。\n- 原理：分歧选择作用于特定基因座。在平衡状态下，对于单个基因座，等位基因频率的变化为零：$\\frac{\\sigma^2}{2} \\frac{d^2 p}{dx^2} + s(x)p(1-p) = 0$。选择系数 $s(x)$ 是环境 $E(x)$ 的函数，并在环境过渡处改变符号，即 $s(x=0) \\approx 0$。\n- **1. 梯度一致性：** 梯度将仅在受选择的基因座上形成，即 $L$ 个基因座中的一个子集。中性基因座 ($s(x)=0$) 不会形成陡峭的梯度，但会因距离隔离 (IBD) 而表现出平缓的梯度。对于受选择的基因座，它们的梯度中心将高度一致，因为它们都“锚定”在相同的环境转变点。梯度宽度与强选择下的 $\\sigma/\\sqrt{s}$ 成正比，如果各个基因座的选择强度 $s$ 不同，则其宽度也会有所不同。\n- **2. 梯度中心 vs. $E(x)$：** 每个梯度的中心由选择改变符号的点决定，即 $s(x)=0$。这对应于一个特定的环境值，并预计与最陡峭的环境梯度位置对齐，在该位置 $|dE/dx|$ 为最大值。\n- **3. 非连锁基因座间的连锁不平衡 (LD)：** 因为基因流是连续的，且基因座不连锁，重组会有效地打破等位基因之间的关联。因此，非连锁基因座之间的LD预计可以忽略不计，仅因混合来自不同位置的种群而短暂出现，并迅速衰减。\n- **4. 时间动态：** 梯度由外部环境框架 $E(x)$ 稳定。只要环境是静态的，梯度的位置就是稳定的，不会移动。\n- **5. 中性多样性与IBD：** 中性多样性应在整个景观中相对连续。IBD模式应反映连续的基因流，导致遗传距离与地理距离之间存在线性关系，在生态过渡带上没有突变或斜率变化。\n\n**模型 B：种群屏障**\n该模型假定梯度是由跨越一个固定空间位置的受限基因流与遗传漂变共同作用的结果。\n- 原理：在 $x=0$ 处，有效迁移存在局域性的外源性减少。选择不是维持梯度的主要力量 ($s(x) \\approx 0$)。梯度的存在是因为屏障两侧的漂变导致分化，而屏障阻止了均一化。\n- **1. 梯度一致性：** 屏障同等地阻碍了*所有*基因座的基因流。因此，任何在屏障两侧漂变到不同频率的等位基因都会形成一个梯度。我们预计整个基因组（包括中性基因座和受选择基因座）的梯度中心具有高度一致性，都集中在 $x=0$ 的屏障处。梯度宽度也应相似，由屏障的强度决定。\n- **2. 梯度中心 vs. $E(x)$：** 梯度中心由物理或种群屏障的位置决定。任何与环境梯度 $E(x)$ 的对齐都将是巧合，而非因果关系。\n- **3. 非连锁LD：** 与模型S一样，没有机制能产生非连锁基因座之间显著的LD。主要过程是漂变和受限迁移，两者都不会产生必要的多基因座关联。\n- **4. 时间动态：** 屏障被假定为景观的一个固定特征。因此，它维持的梯度位置预计随时间是稳定的。\n- **5. 中性多样性与IBD：** 我们预计IBD模式会出现一个明显的断点。对于跨越屏障的种群对，遗传距离与地理距离的斜率将远大于在同一侧的种群对。这是基因流屏障的决定性特征。\n\n**模型 C：次级接触与张力区**\n该模型假定梯度是在两个先前异域分化的谱系相遇点形成的。\n- 原理：梯度由针对杂种的内源性选择维持。这种选择源于在两个谱系中已分化的基因座之间的负上位性相互作用（遗传不亲和性）。该区域作为基因流的内源性屏障。\n- **1. 梯度一致性：** 针对杂种的选择同时作用于许多基因座，使其动态相互耦合。这创造了一个“张力区”，其中许多基因座（包括导致不亲和性的基因座以及与它们连锁或被屏障效应捕获的中性基因座）的梯度在位置上将重合，并且宽度通常也一致。这导致了大部分基因组的高度一致性。\n- **2. 梯度中心 vs. $E(x)$：** 接触区的初始位置是一个历史偶然性问题。它不是由环境 $E(x)$ 决定的。然而，该区域的位置不一定是稳定的。理论预测它会向种群密度或规模较低的区域移动，因为它被来自较密集种群的更高种群压力“推动”。因此，其中心可能不与环境断点对齐，但可能位于一个种群汇（低 $N(x)$）中。\n- **3. 非连锁LD：** 这是最关键和独特的预测。两个分化的亲本基因组在杂交区混合，随后对重组基因型进行选择，这会在来自同一亲本种群的等位基因之间产生强烈的LD，即使这些等位基因位于不同染色体上（非连锁）。非连锁LD的峰值是张力区的标志。这也可能表现为哈迪-温伯格不平衡（因瓦伦德效应导致的杂合子亏损）。\n- **4. 时间动态：** 如前所述，张力区可以自由移动。时间重采样可以揭示梯度位置在 $\\Delta t$ 代内的移动。预测移动方向是朝向有效种群大小 $N_e(x)$（或以普查大小 $N(x)$ 为代理）较低的区域。\n- **5. 中性多样性与IBD：** 异域分化的历史将是显而易见的。溯祖分析将推断出非零的分化时间。与模型B一样，张力区作为一个屏障，因此IBD模式将显示一个明显的断点。然而，与B不同，这个屏障是内源性的，并与高LD相关。\n\n**选项评估**\n\n**A. 对所有基因座拟合S型梯度，并仅在先验确定为与环境相关的基因座中检验中心和宽度的一致性；当这些梯度在 $E(x)$ 最陡峭变化处共享一个共同中心时，判定为模型 S；当这些相同的基因座具有不同的中心时，判定为模型 B；当仅这些基因座在梯度内显示出较窄的宽度和过度的杂合子亏损时，判定为模型 C。不分析非连锁基因座之间的连锁不平衡，不包括中性基因座，也不使用时间数据。**\n- 该策略存在缺陷。它错误地预测模型 B 中受选择的基因座会显示出不同的中心；在模型 B 中，所有基因座都应在屏障处显示一致的中心。它关键性地提出“不分析非连锁基因座之间的连锁不平衡”，“不包括中性基因座”，以及“不使用时间数据”，从而抛弃了区分模型 C 与 S 和 B（非连锁LD，时间移动）以及模型 B 与 S（中性基因座的一致性）所需的最有力证据。\n- **结论：不正确。**\n\n**B. 联合进行：(i) 对所有基因座拟合梯度，并分别为中性基因座和环境相关基因座量化其梯度中心和宽度的离散度；检验梯度中心与最大 $|dE/dx|$ 位置的对齐情况；(ii) 估计局域内非连锁基因座之间的连锁不平衡作为 $x$ 的函数，并检验在 $x=0$ 附近是否存在峰值；(iii) 通过比较两侧的距离隔离斜率与有效的跨屏障连通性，来估计在 $x=0$ 处的基因流屏障指数；(iv) 量化复合梯度中心在 $\\Delta t$ 时间内的移动及其与 $N(x)$ 或 $\\sigma^{2}$ 空间变异的关联。如果环境相关基因座一致且集中在环境断点上，而中性基因座缺乏一致性且全基因组非连锁连锁不平衡较低，则推断为模型 S；如果中性基因座和受选择基因座都显示出与 $E(x)$ 无关的一致中心和宽度，且非连锁连锁不平衡较低并有强烈的屏障指数，则推断为模型 B；如果许多基因座共享一个共同中心，并在 $x=0$ 附近存在过度的非连锁连锁不平衡和哈迪-温伯格偏离，并且梯度向 $N(x)$ 较低的区域表现出时间漂移，则推断为模型 C。**\n- 该策略是全面的，并系统地应用了关键的理论预测。\n- (i) 正确地使用梯度一致性和环境对齐来识别模型 S 的特征。\n- (ii) 正确地使用非连锁 LD 的峰值作为模型 C 的主要诊断依据。\n- (iii) 正确地使用 IBD 模式来诊断屏障效应，该效应存在于 B 和 C 中，但不存在于 S 中。\n- (iv) 正确地使用时间移动作为模型 C 的验证性检验。\n- 为每个模型提供的推断逻辑与从第一性原理推导出的预测完全匹配。这种多管齐下的方法利用了所有可用的数据类型，以最大化区分能力。\n- **结论：正确。**\n\n**C. 仅使用环境关联的全基因组扫描来对基因座进行分类，然后计算生态过渡带两侧在固定窗口大小内的 $F_{ST}}$；如果环境相关基因座具有高 $F_{ST}$，则判定为模型 S；如果中性基因座具有高 $F_{ST}$，则判定为模型 B；如果两者都具有高 $F_{ST}$，则判定为模型 C。忽略空间梯度拟合、连锁不平衡和时间动态。**\n- 该策略过于简单化。$F_{ST}$ 是一个汇总统计量，它丢失了关键的空间信息。在模型 B 和模型 C 中都预计有高的中性 $F_{ST}$，因此它无法区分它们。高的受选择 $F_{ST}$ 也可能在模型 C 中出现。忽略空间模式、LD和时间动态是一个致命的缺陷，因为这些现象包含了最具诊断性的信息。\n- **结论：不正确。**\n\n**D. 对来自生态过渡带两侧的混合样本应用溯祖种群统计推断，以估计分化时间和迁移率；如果推断出非零的分化时间，则判定为模型 C；如果跨生态过渡带的迁移率低于同侧内部的迁移率，则判定为模型 B；否则判定为模型 S。不分析空间显性的等位基因频率变异、连锁不平衡或环境-梯度对齐。**\n- 这种方法对于这个问题来说是根本上被误导的。它将样本混合，从而对定义梯度的关键空间信息进行了平均化和破坏。其推断逻辑也很薄弱：模型 B（如果种群已分离一段时间）和模型 C 都会显示非零的分化时间。两者都会显示较低的跨生态过渡带迁移率。因此，这种方法无法区分 B 和 C。通过排除法来判定模型 S 并非一种严谨的方法。\n- **结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}