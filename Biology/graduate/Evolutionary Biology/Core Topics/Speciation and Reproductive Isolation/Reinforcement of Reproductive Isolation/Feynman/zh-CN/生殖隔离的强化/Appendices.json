{
    "hands_on_practices": [
        {
            "introduction": "要透彻理解生殖隔离的强化过程，第一步是掌握其核心的进化权衡。本练习将通过一个经典的数学模型，引导您推导出强化发生的临界条件。通过量化选择成本与收益，您将亲手揭示决定新偏好等位基因能否成功入侵的关键因素，从而为更复杂的真实世界情景建立坚实的理论基础 。",
            "id": "2748821",
            "problem": "考虑一个具有两个亚群（deme）的种群，其世代离散且不重叠，并存在对称迁移。在每一代中，每个亚群中有比例为 $m$ 的个体是来自另一个亚群的迁移者，交配发生在迁移之后，并在各个亚群内部进行。个体的特征由谱系身份决定，该身份决定了交配是同谱系（conspecific，相同谱系）还是异谱系（heterospecific，不同谱系）。同谱系交配产生的后代相对生存力为 $1$，而异谱系交配产生的杂交后代相对生存力为 $1 - s$，其中 $s \\in [0,1]$ 是针对杂交后代的选择系数。假设谱系身份得以可靠表达，因此，在迁移之后，任一亚群中潜在交配对象里异谱系的比例是 $m$，同谱系的比例是 $1 - m$。\n\n此外，还有一个偏好基因座，它有两个等位基因：一个非选择性等位基因，与可用的伴侣随机交配；一个选择性等位基因，强制进行完美的选型交配（即只与同谱系个体交配），但会产生一个繁殖力代价 $c \\in [0,1)$，该代价会以乘法方式减少产生的合子数量。假设选择性等位基因初始时是稀有的，并且不改变交配池的组成。假设适应度由交配成功率、繁殖力和后代生存力等多个成分以乘法方式共同决定。\n\n如果稀有的选择性等位基因具有边际适应度优势，则称生殖隔离的增强（reinforcement）过程会发生。请仅使用上述假设和定义，推导出临界阈值 $s^\\ast$ 作为 $m$ 和 $c$ 的函数，使得增强过程发生的条件为当且仅当 $s > s^\\ast$。请用 $m$ 和 $c$ 的闭合形式解析表达式来表达您的最终答案。无需进行数值评估。",
            "solution": "该问题要求推导合子后隔离的临界阈值 $s^\\ast$，当选择强度高于此阈值时，一个促进选型交配的等位基因将成功入侵种群。这是一个增强（reinforcement）问题，通过比较稀有的“选择性”等位基因的适应度与固有的“非选择性”等位基因的适应度来分析。如果选择性等位基因的边际适应度更高，它就会入侵。\n\n我们根据个体在偏好基因座上携带的等位基因来定义其相对适应度 $W$。根据问题陈述，适应度由繁殖力和所产生后代的平均生存力的乘积效应决定。我们考虑的是选择性等位基因稀有的情况。\n\n首先，我们计算固有的非选择性等位基因的适应度，记作 $W_{NC}$。携带该等位基因的个体与亚群中可用的伴侣随机交配。迁移后，潜在的同谱系交配对象的比例是 $1-m$，潜在的异谱系交配对象的比例是 $m$。非选择性等位基因不承担直接的繁殖力代价，因此其相对繁殖力为 $1$。\n\n非选择性个体的平均后代生存力是基于其交配遭遇的加权平均值：\n-   比例为 $1-m$ 的交配是同谱系交配，产生的后代相对生存力为 $1$。\n-   比例为 $m$ 的交配是异谱系交配，产生的杂交后代相对生存力为 $1-s$。\n\n因此，平均后代生存力 $V_{NC}$ 为：\n$$V_{NC} = (1-m) \\cdot 1 + m \\cdot (1-s) = 1 - ms$$\n非选择性等位基因的总相对适应度 $W_{NC}$ 是其相对繁殖力与平均后代生存力的乘积：\n$$W_{NC} = 1 \\cdot V_{NC} = 1 - ms$$\n\n接下来，我们计算稀有的、入侵的选择性等位基因的适应度，记作 $W_{C}$。该等位基因强制进行完美的选型交配，意味着携带它的个体只与同谱系个体交配。因为该等位基因是稀有的，我们假设它不会耗尽可用的同谱系交配对象库，并且总能找到配偶。因此，所有后代都来自同谱系交配，相对生存力为 $1$。\n\n然而，选择性等位基因会产生一个繁殖力代价 $c$，使产生的合子数量减少一个因子 $1-c$。因此，选择性等位基因的相对繁殖力为 $1-c$。\n\n选择性等位基因的总相对适应度 $W_{C}$ 是其降低的繁殖力与（最大的）后代生存力的乘积：\n$$W_{C} = (1-c) \\cdot 1 = 1-c$$\n\n如果选择性等位基因在稀有时能够扩散，则生殖隔离的增强过程就会发生。这种情况发生的条件是其适应度大于固有的非选择性等位基因的适应度，即 $W_{C} > W_{NC}$。我们可以将此条件表示为以下不等式：\n$$1-c > 1-ms$$\n这个不等式代表了增强过程中的基本权衡：选择性的内在代价 $c$ 必须小于因不产生适应度低的杂交后代而避免的适应度损失。对于随机交配的个体，由杂交产生的预期适应度损失是杂交率 $m$ 和针对杂交后代的选择代价 $s$ 的乘积。\n\n为了找到关于 $s$ 的条件，我们解这个不等式。两边同时减去 $1$ 得到：\n$$-c > -ms$$\n两边乘以 $-1$ 会使不等号反向：\n$$c < ms$$\n假设迁移存在（$m > 0$），我们可以两边除以 $m$ 来分离出 $s$：\n$$s > \\frac{c}{m}$$\n这个不等式指明了增强过程发生的条件。临界阈值 $s^\\ast$ 是使得两种等位基因的适应度相等（$W_C = W_{NC}$）时的 $s$ 值。增强过程发生的条件为当且仅当 $s > s^\\ast$。因此，临界阈值由下式给出：\n$$s^\\ast = \\frac{c}{m}$$",
            "answer": "$$\\boxed{\\frac{c}{m}}$$"
        },
        {
            "introduction": "进化并非在真空中发生，一个物种为解决某个问题而演化出的性状，可能会在更广泛的生态群落中引发意想不到的后果。这个练习引入了“强化溢出效应”这一复杂而有趣的概念，即为了避免与一个物种杂交而演化出的新信号，却无意中导致了与第三个物种的杂交。通过构建一个涉及三种鸟类的模型，您将计算阻止新信号传播所需的杂交成本，这有助于我们理解进化路径如何受到多物种相互作用的塑造 。",
            "id": "1959874",
            "problem": "在一个热带生态系统中，三种密切相关、同域共存的鸣禽物种（物种A、B和C）相互作用。它们的相对种群丰度由频率 $f_A$、$f_B$ 和 $f_C$ 描述，满足 $f_A + f_B + f_C = 1$。这些物种的交配是由一种特定的鸣唱模式介导的。\n\n最初，物种B的整个种群都使用一种祖先的鸣唱模式，“Signal 1”。这种鸣唱模式由单一基因座遗传决定，所有个体都是 $T_1$ 等位基因的纯合子。不幸的是，物种A的雄性也会产生Signal 1，这导致了代价高昂的杂交。物种B的雌性与物种A的雄性交配产生的后代，其相对适应度与纯物种B配对相比，会降低 $s_A$。\n\n一个罕见的突变等位基因 $T_2$ 在物种B中出现。$T_2$ 等位基因对 $T_1$ 是显性的。任何拥有至少一个 $T_2$ 等位基因的个体（即基因型为 $T_1T_2$ 或 $T_2T_2$）会产生并偏好一种新的鸣唱模式，“Signal 2”。基因型为 $T_1T_1$ 的个体则继续产生并偏好Signal 1。这一变化使得 $T_2$ 等位基因的携带者能够避免与物种A交配。\n\n然而，这产生了一个新问题：物种C的雄性恰好也会产生Signal 2。这种为避免与一个物种杂交而进行的选择，无意中导致与另一个物种相互作用的现象，被称为强化溢出效应。物种B的雌性与物种C的雄性交配会导致适应度降低 $s_C$。物种B任意两个个体之间的交配被认为是成功的同种交配，其基准相对适应度为1。\n\n假设雌性的偏好是绝对的：她只会从产生她所偏好的鸣唱模式的雄性群体中选择配偶。在该群体中，她随机选择配偶，选择的概率与可得雄性类型的相对丰度成正比。\n\n计算与物种C杂交的成本 $s_C$ 的最小值，该值将阻止新的 $T_2$ 等位基因在物种B的种群中入侵和传播。用 $s_A$、$f_A$ 和 $f_B$ 的符号表达式来表示你的答案。",
            "solution": "问题要求计算与物种C杂交的最低适应度成本 $s_C$，该成本能阻止 $T_2$ 等位基因在物种B中入侵。如果 $T_2$ 等位基因的初始携带者的适应度小于或等于原有个体的适应度，那么它就无法入侵。由于 $T_2$ 等位基因是罕见且显性的，其初始携带者绝大多数将是杂合子 ($T_1T_2$)。现有种群由纯合子 ($T_1T_1$) 组成。因此，阻止入侵的条件是 $W_{12} \\leq W_{11}$，其中 $W_{12}$ 是 $T_1T_2$ 基因型的适应度，$W_{11}$ 是 $T_1T_1$ 基因型的适应度。$s_C$ 的最小值出现在阈值 $W_{12} = W_{11}$ 处。我们需要在 $T_2$ 等位基因罕见的情况下计算这些适应度值。\n\n设 $p$ 为物种B中 $T_1$ 等位基因的频率，$q$ 为 $T_2$ 等位基因的频率，且 $p+q=1$。对于入侵情景，我们考虑极限情况 $q \\to 0$ 且 $p \\to 1$。\n\n**步骤1：计算原住纯合子 $W_{11}$ 的适应度。**\n基因型为 $T_1T_1$ 的个体产生并偏好Signal 1。产生Signal 1的雄性群体包括物种A的所有雄性（相对丰度为 $f_A$）和物种B中基因型为 $T_1T_1$ 的雄性（相对丰度为 $f_B p^2$）。\n这个受偏好的雄性群体中的总丰度是 $f_A + f_B p^2$。\n$T_1T_1$ 雌性从这个群体中选择配偶。\n与物种A雄性交配的概率为 $P(\\text{A}) = \\frac{f_A}{f_A + f_B p^2}$。这种交配的适应度为 $(1-s_A)$。\n与同种（$T_1T_1$ B雄性）交配的概率为 $P(\\text{B}) = \\frac{f_B p^2}{f_A + f_B p^2}$。这种交配的适应度为 1。\n$W_{11}$ 的总适应度是加权平均值：\n$$W_{11} = P(\\text{A}) \\cdot (1-s_A) + P(\\text{B}) \\cdot 1 = \\frac{f_A (1-s_A) + f_B p^2}{f_A + f_B p^2}$$\n在 $T_2$ 罕见的极限情况下，$p \\to 1$。因此，原住纯合子的适应度变为：\n$$W_{11} \\to \\frac{f_A (1-s_A) + f_B}{f_A + f_B}$$\n\n**步骤2：计算入侵杂合子 $W_{12}$ 的适应度。**\n一个基因型为 $T_1T_2$ 的个体拥有显性的 $T_2$ 等位基因，因此她产生并偏好Signal 2。产生Signal 2的雄性群体包括物种C的所有雄性（相对丰度为 $f_C$）和物种B中携带 $T_2$ 等位基因的雄性（基因型为 $T_1T_2$ 或 $T_2T_2$）。这些雄性的丰度是 $f_B(2pq + q^2)$。\n这个受偏好的雄性群体中的总丰度是 $f_C + f_B(2pq + q^2)$。\n$T_1T_2$ 雌性从这个群体中选择配偶。\n与物种C雄性交配的概率为 $P(\\text{C}) = \\frac{f_C}{f_C + f_B(2pq + q^2)}$。这种交配的适应度为 $(1-s_C)$。\n与同种（拥有Signal 2的B雄性）交配的概率为 $P(\\text{B}) = \\frac{f_B(2pq + q^2)}{f_C + f_B(2pq + q^2)}$。这种交配的适应度为 1。\n$W_{12}$ 的总适应度是：\n$$W_{12} = \\frac{f_C (1-s_C) + f_B(2pq + q^2)}{f_C + f_B(2pq + q^2)}$$\n现在，我们取 $T_2$ 等位基因变得罕见的极限，即 $q \\to 0$。当 $q \\to 0$ 时，项 $2pq + q^2$ 也趋于 0。\n$$W_{12} \\to \\frac{f_C (1-s_C) + f_B(0)}{f_C + f_B(0)} = \\frac{f_C (1-s_C)}{f_C} = 1 - s_C$$\n这一结果意味着，一个具有新偏好的罕见雌性几乎永远找不到具有相同新信号的同种雄性，因此她实际上被迫与物种C的雄性交配，从而承担适应度成本 $s_C$。\n\n**步骤3：求解 $s_C$ 的阈值。**\n当 $W_{12} \\le W_{11}$ 时，$T_2$ 等位基因的入侵被阻止。阻止开始的阈值由等式 $W_{12} = W_{11}$ 定义。\n使用在 $q \\to 0$ 极限下推导出的适应度表达式：\n$$1 - s_C = \\frac{f_A (1-s_A) + f_B}{f_A + f_B}$$\n现在，我们求解 $s_C$：\n$$s_C = 1 - \\frac{f_A (1-s_A) + f_B}{f_A + f_B}$$\n为了简化，找到一个公分母：\n$$s_C = \\frac{(f_A + f_B) - (f_A(1-s_A) + f_B)}{f_A + f_B}$$\n$$s_C = \\frac{f_A + f_B - f_A + f_A s_A - f_B}{f_A + f_B}$$\n分子中的项 $f_A$、$-f_A$、$f_B$ 和 $-f_B$ 相互抵消，剩下：\n$$s_C = \\frac{f_A s_A}{f_A + f_B}$$\n此表达式代表了 $s_C$ 的最小值，该值会使入侵杂合子的适应度等于（或小于）原住纯合子的适应度，从而阻止 $T_2$ 等位基因的传播。这是溢出效应的选择成本，它恰好平衡了避免与物种A杂交的选择优势。",
            "answer": "$$\\boxed{\\frac{f_A s_A}{f_A + f_B}}$$"
        },
        {
            "introduction": "在进化生物学中，观察到的模式往往可以由多种不同的过程来解释。例如，在同域分布区观察到的更强的合子前隔离，可能是强化作用的结果，也可能是生态性状置换的副产品。本练习将带您从理论建模走向实证检验，运用贝叶斯因子比较法这一现代统计工具，根据给定的综合数据来评估两种竞争性假说的相对证据强度。这项实践旨在训练您如何量化地检验进化假说，这是所有现代进化生物学研究者的核心技能 。",
            "id": "2748801",
            "problem": "在一个两种近缘昆虫物种的次级接触带中，给定关于许多种群对的生殖隔离屏障模式的两个独立定量总结。第一个总结，记为 $S_{1}$，是同域和异域间合子前隔离的标准化差异（正值表示同域中的合子前隔离更强）。第二个总结，记为 $S_{2}$，是同域和异域间性状-环境耦合的 Fisher $z$ 变换差异（正值表示同域中更强的生态性状匹配）。假设 $S_{1}$ 和 $S_{2}$ 在给定其潜在效应参数的条件下是条件独立的，并且它们的抽样误差近似服从标准差已知的正态分布。\n\n需要使用贝叶斯因子比较两个竞争性的进化假说：生殖隔离的强化（模型 $\\mathcal{R}$）和生态性状置换（模型 $\\mathcal{E}$）。针对这些总结，假定存在以下生成模型：\n\n- 在模型 $\\mathcal{R}$（强化）下：\n  - $S_{1} \\mid \\delta \\sim \\mathcal{N}(\\delta, \\sigma_{1}^{2})$，其中 $\\delta \\sim \\mathcal{N}(\\mu_{\\delta \\mathcal{R}}, \\tau_{\\delta}^{2})$ 且 $\\mu_{\\delta \\mathcal{R}} = 0.8$，\n  - $S_{2} \\mid \\theta \\sim \\mathcal{N}(\\theta, \\sigma_{2}^{2})$，其中 $\\theta \\sim \\mathcal{N}(\\mu_{\\theta \\mathcal{R}}, \\tau_{\\theta}^{2})$ 且 $\\mu_{\\theta \\mathcal{R}} = 0$。\n\n- 在模型 $\\mathcal{E}$（生态性状置换）下：\n  - $S_{1} \\mid \\delta \\sim \\mathcal{N}(\\delta, \\sigma_{1}^{2})$，其中 $\\delta \\sim \\mathcal{N}(\\mu_{\\delta \\mathcal{E}}, \\tau_{\\delta}^{2})$ 且 $\\mu_{\\delta \\mathcal{E}} = 0$，\n  - $S_{2} \\mid \\theta \\sim \\mathcal{N}(\\theta, \\sigma_{2}^{2})$，其中 $\\theta \\sim \\mathcal{N}(\\mu_{\\theta \\mathcal{E}}, \\tau_{\\theta}^{2})$ 且 $\\mu_{\\theta \\mathcal{E}} = 0.9$。\n\n假设先验标准差在两个模型间共享，为 $\\tau_{\\delta} = 0.5$ 和 $\\tau_{\\theta} = 0.5$，抽样标准差为 $\\sigma_{1} = 0.35$ 和 $\\sigma_{2} = 0.30$。观测到的总结值为 $S_{1} = 1.10$ 和 $S_{2} = 0.85$。\n\n从贝叶斯定理和贝叶斯因子作为边缘似然比的定义出发，计算支持强化模型相对于生态性状置换模型的贝叶斯因子 $BF_{\\mathcal{R},\\mathcal{E}}$。将 $S_{1}$ 和 $S_{2}$ 视为在给定模型参数下是独立的，并在各模型下显式地通过积分消去潜效应参数。将最终答案四舍五入到四位有效数字。",
            "solution": "支持模型 $\\mathcal{R}$ 相对于模型 $\\mathcal{E}$ 的贝叶斯因子定义为它们边缘似然的比值：\n$$BF_{\\mathcal{R},\\mathcal{E}} = \\frac{p(S_1, S_2 | \\mathcal{R})}{p(S_1, S_2 | \\mathcal{E})}$$\n鉴于在每个模型下 $S_1$ 和 $S_2$ 的生成过程是独立的，模型 $\\mathcal{M}$的联合边缘似然可以分解为：\n$$p(S_1, S_2 | \\mathcal{M}) = p(S_1 | \\mathcal{M}) p(S_2 | \\mathcal{M})$$\n因此，贝叶斯因子可以写为：\n$$BF_{\\mathcal{R},\\mathcal{E}} = \\frac{p(S_1 | \\mathcal{R}) p(S_2 | \\mathcal{R})}{p(S_1 | \\mathcal{E}) p(S_2 | \\mathcal{E})}$$\n我们必须计算每个模型下每个数据总结的边缘似然。对于一个通用的总结 $S$、一个潜参数 $\\lambda$ 和一个模型 $\\mathcal{M}$，其结构如下：\n似然： $S \\mid \\lambda \\sim \\mathcal{N}(\\lambda, \\sigma^2)$\n先验： $\\lambda \\sim \\mathcal{N}(\\mu, \\tau^2)$\n边缘似然 $p(S|\\mathcal{M})$ 通过对潜参数 $\\lambda$ 进行积分得到：\n$$p(S|\\mathcal{M}) = \\int_{-\\infty}^{\\infty} p(S \\mid \\lambda) p(\\lambda | \\mathcal{M}) d\\lambda$$\n这是一个高斯-高斯共轭模型的标准结果。$S$ 的边缘分布也是正态分布：\n$$S \\sim \\mathcal{N}(\\mu, \\sigma^2 + \\tau^2)$$\n边缘似然是这个得到的正态分布的概率密度函数（PDF），在观测值 $S$ 处求值：\n$$p(S|\\mathcal{M}) = \\frac{1}{\\sqrt{2\\pi(\\sigma^2 + \\tau^2)}} \\exp\\left(-\\frac{(S - \\mu)^2}{2(\\sigma^2 + \\tau^2)}\\right)$$\n\n让我们定义 $S_1$ 和 $S_2$ 的总方差：\n对于 $S_1$：$V_1 = \\sigma_1^2 + \\tau_\\delta^2 = (0.35)^2 + (0.5)^2 = 0.1225 + 0.25 = 0.3725$。\n对于 $S_2$：$V_2 = \\sigma_2^2 + \\tau_\\theta^2 = (0.30)^2 + (0.5)^2 = 0.09 + 0.25 = 0.34$。\n\n现在我们可以写出四个边缘似然项：\n在模型 $\\mathcal{R}$ 下：\n$p(S_1 | \\mathcal{R}) = \\frac{1}{\\sqrt{2\\pi V_1}} \\exp\\left(-\\frac{(S_1 - \\mu_{\\delta\\mathcal{R}})^2}{2V_1}\\right)$\n$p(S_2 | \\mathcal{R}) = \\frac{1}{\\sqrt{2\\pi V_2}} \\exp\\left(-\\frac{(S_2 - \\mu_{\\theta\\mathcal{R}})^2}{2V_2}\\right)$\n\n在模型 $\\mathcal{E}$ 下：\n$p(S_1 | \\mathcal{E}) = \\frac{1}{\\sqrt{2\\pi V_1}} \\exp\\left(-\\frac{(S_1 - \\mu_{\\delta\\mathcal{E}})^2}{2V_1}\\right)$\n$p(S_2 | \\mathcal{E}) = \\frac{1}{\\sqrt{2\\pi V_2}} \\exp\\left(-\\frac{(S_2 - \\mu_{\\theta\\mathcal{E}})^2}{2V_2}\\right)$\n\n将这些代入贝叶斯因子的表达式中，归一化常数 $\\frac{1}{\\sqrt{2\\pi V_1}}$ 和 $\\frac{1}{\\sqrt{2\\pi V_2}}$ 会消去：\n$$BF_{\\mathcal{R},\\mathcal{E}} = \\frac{\\exp\\left(-\\frac{(S_1 - \\mu_{\\delta\\mathcal{R}})^2}{2V_1}\\right) \\exp\\left(-\\frac{(S_2 - \\mu_{\\theta\\mathcal{R}})^2}{2V_2}\\right)}{\\exp\\left(-\\frac{(S_1 - \\mu_{\\delta\\mathcal{E}})^2}{2V_1}\\right) \\exp\\left(-\\frac{(S_2 - \\mu_{\\theta\\mathcal{E}})^2}{2V_2}\\right)}$$\n这可以简化为：\n$$BF_{\\mathcal{R},\\mathcal{E}} = \\exp\\left( -\\frac{1}{2} \\left[ \\frac{(S_1 - \\mu_{\\delta\\mathcal{R}})^2 - (S_1 - \\mu_{\\delta\\mathcal{E}})^2}{V_1} + \\frac{(S_2 - \\mu_{\\theta\\mathcal{R}})^2 - (S_2 - \\mu_{\\theta\\mathcal{E}})^2}{V_2} \\right] \\right)$$\n现在我们代入数值：\n$S_1 = 1.10$，$S_2 = 0.85$。\n$\\mu_{\\delta\\mathcal{R}} = 0.8$，$\\mu_{\\delta\\mathcal{E}} = 0$。\n$\\mu_{\\theta\\mathcal{R}} = 0$，$\\mu_{\\theta\\mathcal{E}} = 0.9$。\n$V_1 = 0.3725$，$V_2 = 0.34$。\n\n我们来计算方括号内的项。\n对于 $S_1$ 分量：\n$$\\frac{(1.10 - 0.8)^2 - (1.10 - 0)^2}{0.3725} = \\frac{(0.3)^2 - (1.1)^2}{0.3725} = \\frac{0.09 - 1.21}{0.3725} = \\frac{-1.12}{0.3725}$$\n对于 $S_2$ 分量：\n$$\\frac{(0.85 - 0)^2 - (0.85 - 0.9)^2}{0.34} = \\frac{(0.85)^2 - (-0.05)^2}{0.34} = \\frac{0.7225 - 0.0025}{0.34} = \\frac{0.72}{0.34}$$\n这两个分量之和是：\n$$\\frac{-1.12}{0.3725} + \\frac{0.72}{0.34} \\approx -3.0067114 + 2.1176471 = -0.8890643$$\n最后，我们计算贝叶斯因子：\n$$BF_{\\mathcal{R},\\mathcal{E}} = \\exp\\left( -\\frac{1}{2} (-0.8890643) \\right) = \\exp(0.44453215) \\approx 1.559773$$\n四舍五入到四位有效数字，结果是 $1.560$。这个值表明，在强化模型（$\\mathcal{R}$）下，观测数据出现的可能性大约是在生态性状置换模型（$\\mathcal{E}$）下的 $1.56$ 倍。",
            "answer": "$$\\boxed{1.560}$$"
        }
    ]
}