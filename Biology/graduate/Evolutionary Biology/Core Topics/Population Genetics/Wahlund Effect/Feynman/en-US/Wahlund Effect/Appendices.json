{
    "hands_on_practices": [
        {
            "introduction": "This initial exercise walks you through the foundational calculation of the Wahlund effect. By comparing the average within-deme heterozygosity ($H_S$) with the heterozygosity expected in a hypothetical panmictic total population ($H_T$), you will directly quantify the heterozygote deficit that arises from population subdivision. This practice  solidifies the core mechanism behind the effect.",
            "id": "2762872",
            "problem": "A diploid species is subdivided into $2$ demes of equal census size, labeled deme $1$ and deme $2$. At a single biallelic locus with alleles $A$ and $a$, the allele $A$ has frequency $p_1=0.2$ in deme $1$ and $p_2=0.8$ in deme $2$. Assume random mating within each deme and no selection, mutation, or migration within a generation, so that each deme individually satisfies Hardy–Weinberg equilibrium (HWE). Let $H_S$ denote the within-deme expected heterozygosity averaged across demes using equal weights, and let $H_T$ denote the expected heterozygosity computed from the pooled allele frequency as if the total population were panmictic. Starting from the Hardy–Weinberg principle and the definition of heterozygosity as the expected fraction of heterozygotes, compute $H_S$ and $H_T$ from first principles, and then determine the Wahlund-effect heterozygote deficit $H_T - H_S$.\n\nProvide your final answer as the single quantity $H_T - H_S$, expressed as an exact fraction. Do not round. Do not include any units.",
            "solution": "The problem statement has been validated and found to be scientifically grounded, well-posed, and complete. We shall proceed with the derivation from first principles.\n\nThe foundation of this problem is the Hardy–Weinberg principle for a diploid species at a biallelic locus. Let the alleles be $A$ and $a$, with frequencies $p$ and $q$ respectively, such that $p+q=1$. In a population under Hardy–Weinberg equilibrium (HWE)—that is, assuming random mating, no selection, no mutation, and no gene flow—the expected frequencies of the genotypes $AA$, $Aa$, and $aa$ are $p^2$, $2pq$, and $q^2$, respectively. The expected heterozygosity, denoted $H$, is the expected frequency of the heterozygous genotype $Aa$, which is given by the expression $H = 2pq$.\n\nThe problem specifies a population subdivided into $2$ demes of equal census size. We are given the frequencies of allele $A$ in each deme.\nIn deme $1$, the frequency of allele $A$ is $p_1 = 0.2$. Consequently, the frequency of allele $a$ is $q_1 = 1 - p_1 = 1 - 0.2 = 0.8$.\nIn deme $2$, the frequency of allele $A$ is $p_2 = 0.8$. Consequently, the frequency of allele $a$ is $q_2 = 1 - p_2 = 1 - 0.8 = 0.2$.\n\nFirst, we calculate the average within-deme heterozygosity, $H_S$. Each deme is stated to be in HWE. Therefore, we can calculate the expected heterozygosity for each deme individually.\nFor deme $1$, the expected heterozygosity is $H_1 = 2p_1q_1$.\nFor deme $2$, the expected heterozygosity is $H_2 = 2p_2q_2$.\n\n$H_S$ is defined as the average of these heterozygosities, weighted by deme size. Since the demes are of equal size, the weights are equal ($1/2$ for each deme):\n$$H_S = \\frac{1}{2}H_1 + \\frac{1}{2}H_2 = \\frac{1}{2}(2p_1q_1) + \\frac{1}{2}(2p_2q_2) = p_1q_1 + p_2q_2$$\nSubstituting the given numerical values:\n$$H_S = (0.2)(0.8) + (0.8)(0.2) = 0.16 + 0.16 = 0.32$$\n\nNext, we calculate the total expected heterozygosity, $H_T$. This is the expected heterozygosity that would exist if the two demes were pooled into a single, panmictic population. To compute this, we must first determine the pooled allele frequencies for the total population. Let $\\bar{p}$ and $\\bar{q}$ be the frequencies of alleles $A$ and $a$ in the total population, respectively. Since the demes are of equal size, the pooled frequencies are the arithmetic means of the individual deme frequencies:\n$$\\bar{p} = \\frac{p_1 + p_2}{2}$$\n$$\\bar{q} = \\frac{q_1 + q_2}{2} = 1 - \\bar{p}$$\nSubstituting the given values for $p_1$ and $p_2$:\n$$\\bar{p} = \\frac{0.2 + 0.8}{2} = \\frac{1.0}{2} = 0.5$$\nThus, the pooled frequency for allele $a$ is $\\bar{q} = 1 - 0.5 = 0.5$.\n\nNow, we calculate $H_T$ using the pooled allele frequencies, assuming the total population behaves as a single unit in HWE:\n$$H_T = 2\\bar{p}\\bar{q}$$\nSubstituting the calculated pooled frequencies:\n$$H_T = 2(0.5)(0.5) = 0.5$$\n\nFinally, the problem asks for the heterozygote deficit due to the Wahlund effect, which is the difference $H_T - H_S$. This quantity measures the reduction in heterozygosity caused by population subdivision, compared to the expectation under panmixia.\n$$H_T - H_S = 0.5 - 0.32 = 0.18$$\nThe problem requires this result to be expressed as an exact fraction.\n$$0.18 = \\frac{18}{100} = \\frac{9}{50}$$\nThis deficit, $H_T - H_S$, is a direct consequence of the variance in allele frequencies among subpopulations, $\\text{Var}(p)$. For $k_d$ demes of equal size, the general relationship is $H_S = H_T - 2\\text{Var}(p)$, or $H_T-H_S = 2\\text{Var}(p)$. In this specific case with $2$ demes, $\\text{Var}(p) = \\frac{(p_1 - \\bar{p})^2 + (p_2 - \\bar{p})^2}{2} = \\frac{(0.2 - 0.5)^2 + (0.8 - 0.5)^2}{2} = \\frac{(-0.3)^2 + (0.3)^2}{2} = \\frac{0.09 + 0.09}{2} = 0.09$. Thus, $H_T - H_S = 2(0.09) = 0.18$, which confirms our direct calculation.",
            "answer": "$$\\boxed{\\frac{9}{50}}$$"
        },
        {
            "introduction": "Building on the biallelic case, this problem demonstrates that the Wahlund effect is a general principle not limited to two-allele systems. You will apply the fundamental definition of heterozygosity, $H = 1 - \\sum p_i^2$, to a more complex scenario involving three alleles across two demes. This exercise  reinforces the universality of the concept and its application to realistic, multi-allelic loci.",
            "id": "2762914",
            "problem": "A locus has three alleles with frequencies that differ between two demes of a structured metapopulation. In deme $1$, the allele frequency vector is $(0.6, 0.3, 0.1)$, and in deme $2$, it is $(0.2, 0.5, 0.3)$. Equal numbers of gene copies are sampled from each deme and then pooled. Assume Hardy–Weinberg equilibrium (HWE) within each deme and random union of gametes in the pooled population.\n\nStarting from the definition that the expected heterozygosity at a locus equals the probability that two gene copies drawn without replacement from the same population are of different allelic type under Hardy–Weinberg equilibrium (HWE), and that the total expected heterozygosity in the pooled population is defined analogously from the pooled allele frequencies, compute the following quantities:\n\n- $H_S$: the mean expected heterozygosity within demes (averaged over demes with equal weights),\n- $H_T$: the expected heterozygosity in the pooled population,\n- $H_T - H_S$: the absolute magnitude of the Wahlund effect.\n\nProvide exact decimal values (do not round). State your final answer in the order $(H_S, H_T, H_T - H_S)$.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a complete and unique solution. We shall proceed with the analysis.\n\nLet the three alleles at the locus be denoted $A_1$, $A_2$, and $A_3$. The problem provides the allele frequencies for two demes.\n\nFor deme $1$, the allele frequency vector is $\\mathbf{p}_1 = (p_{1,1}, p_{1,2}, p_{1,3})$, where $p_{1,1} = 0.6$, $p_{1,2} = 0.3$, and $p_{1,3} = 0.1$.\nFor deme $2$, the allele frequency vector is $\\mathbf{p}_2 = (p_{2,1}, p_{2,2}, p_{2,3})$, where $p_{2,1} = 0.2$, $p_{2,2} = 0.5$, and $p_{2,3} = 0.3$.\n\nThe expected heterozygosity, $H$, at a locus with $k$ alleles with frequencies $p_i$ (for $i=1, \\dots, k$) under Hardy-Weinberg equilibrium (HWE) is the probability that two randomly drawn gene copies are different. This is equivalent to $1$ minus the probability that they are the same (i.e., the expected homozygosity). The expected homozygosity is the sum of the squared allele frequencies.\nTherefore, the expected heterozygosity is given by the formula:\n$$H = 1 - \\sum_{i=1}^{k} p_i^2$$\n\nFirst, we calculate the expected heterozygosity within each deme, assuming HWE holds within each.\n\nFor deme $1$, with $k=3$ alleles:\n$$H_1 = 1 - \\sum_{i=1}^{3} p_{1,i}^2 = 1 - (p_{1,1}^2 + p_{1,2}^2 + p_{1,3}^2)$$\n$$H_1 = 1 - (0.6^2 + 0.3^2 + 0.1^2) = 1 - (0.36 + 0.09 + 0.01) = 1 - 0.46 = 0.54$$\n\nFor deme $2$, with $k=3$ alleles:\n$$H_2 = 1 - \\sum_{i=1}^{3} p_{2,i}^2 = 1 - (p_{2,1}^2 + p_{2,2}^2 + p_{2,3}^2)$$\n$$H_2 = 1 - (0.2^2 + 0.5^2 + 0.3^2) = 1 - (0.04 + 0.25 + 0.09) = 1 - 0.38 = 0.62$$\n\nNext, we compute $H_S$, the mean expected heterozygosity within demes. The problem specifies averaging over demes with equal weights. Let the weights for deme $1$ and deme $2$ be $c_1$ and $c_2$, respectively. Since there are two demes with equal weights, $c_1 = c_2 = 0.5$.\n$$H_S = c_1 H_1 + c_2 H_2 = (0.5)H_1 + (0.5)H_2$$\n$$H_S = 0.5 \\times (0.54 + 0.62) = 0.5 \\times 1.16 = 0.58$$\n\nNow, we compute $H_T$, the expected heterozygosity in the pooled population. This requires calculating the pooled allele frequencies, $\\bar{\\mathbf{p}}$. The pooled frequency for each allele is the weighted average of its frequencies across the demes.\nThe pooled frequency for allele $A_i$, denoted $\\bar{p}_i$, is:\n$$\\bar{p}_i = c_1 p_{1,i} + c_2 p_{2,i}$$\nFor allele $A_1$:\n$$\\bar{p}_1 = (0.5 \\times 0.6) + (0.5 \\times 0.2) = 0.3 + 0.1 = 0.4$$\nFor allele $A_2$:\n$$\\bar{p}_2 = (0.5 \\times 0.3) + (0.5 \\times 0.5) = 0.15 + 0.25 = 0.4$$\nFor allele $A_3$:\n$$\\bar{p}_3 = (0.5 \\times 0.1) + (0.5 \\times 0.3) = 0.05 + 0.15 = 0.2$$\nThe vector of pooled allele frequencies is $\\bar{\\mathbf{p}} = (0.4, 0.4, 0.2)$. We verify that the frequencies sum to $1$: $0.4 + 0.4 + 0.2 = 1.0$.\n\nUsing these pooled frequencies, we calculate $H_T$:\n$$H_T = 1 - \\sum_{i=1}^{3} \\bar{p}_i^2 = 1 - (\\bar{p}_1^2 + \\bar{p}_2^2 + \\bar{p}_3^2)$$\n$$H_T = 1 - (0.4^2 + 0.4^2 + 0.2^2) = 1 - (0.16 + 0.16 + 0.04) = 1 - 0.36 = 0.64$$\n\nFinally, we compute the absolute magnitude of the Wahlund effect, which is the difference $H_T - H_S$. This difference quantifies the deficit of heterozygotes in a subdivided population relative to the expectation under panmixia (i.e., if the pooled population formed a single random-mating unit).\n$$H_T - H_S = 0.64 - 0.58 = 0.06$$\n\nThe required quantities are $H_S = 0.58$, $H_T = 0.64$, and the Wahlund effect $H_T - H_S = 0.06$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.58 & 0.64 & 0.06 \\end{pmatrix}}$$"
        },
        {
            "introduction": "This final practice advances your skills from manual calculation to computational analysis, a critical competency in modern population genetics. By developing a program to quantify the Wahlund effect, you will create a flexible tool for exploring how factors like subpopulation size and the magnitude of allele frequency differences impact the observed heterozygote deficit. This computational approach  enables rapid investigation of the parameter space that governs this important evolutionary phenomenon.",
            "id": "2396530",
            "problem": "Develop a complete program that quantifies the Wahlund effect for a single bi-allelic locus when two subpopulations, each individually in Hardy–Weinberg equilibrium (HWE), are pooled. Consider a diploid locus with alleles $A$ and $a$. For subpopulation $i \\in \\{1,2\\}$, let $n_i$ denote the number of diploid individuals and let $p_i$ denote the frequency of allele $A$; let $q_i = 1 - p_i$. Assume that each subpopulation is exactly in Hardy–Weinberg equilibrium (HWE), meaning its genotype frequencies are those implied by its allele frequencies. Treat the subpopulations as deterministic systems that follow the expected genotype frequencies implied by HWE, not as outcomes of stochastic sampling. After pooling the two subpopulations without any post-pooling mating, the observed heterozygosity of the pooled set is defined as the proportion of heterozygous individuals among all individuals. Separately, define the pooled allele frequency as $\\bar{p}$, the total-number-weighted average of $p_1$ and $p_2$. The heterozygosity expected under panmixia at the pooled allele frequency is the heterozygosity that would arise if a single randomly mating population with allele frequency $\\bar{p}$ were in HWE. Define the Wahlund effect $W$ as the difference between the expected heterozygosity under panmixia at $\\bar{p}$ and the observed heterozygosity in the pooled set. Report $W$ as a decimal (not a percentage).\n\nYour program must compute $W$ for each of the following five independent test cases, where each test case is given as $(n_1, p_1, n_2, p_2)$:\n- Test case A: $(100, 0.4, 100, 0.7)$\n- Test case B: $(50, 0.5, 200, 0.5)$\n- Test case C: $(120, 0.0, 80, 1.0)$\n- Test case D: $(10, 0.2, 1000, 0.21)$\n- Test case E: $(1, 1.0, 1, 1.0)$\n\nAll $n_i$ are counts of individuals (unitless). All allele frequencies $p_i$ must be treated as decimals in the closed interval $[0,1]$. There are no physical units involved. For each test case, compute the single value $W$ and round it to exactly six digits after the decimal point.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases A through E. For example, the required format is $[w_A,w_B,w_C,w_D,w_E]$, where each $w_{\\cdot}$ is the rounded decimal described above.",
            "solution": "The problem statement is submitted for validation.\n\n### Step 1: Extract Givens\n- **Topic**: Wahlund effect for a single bi-allelic locus ($A$, $a$).\n- **Subpopulations**: Two subpopulations, indexed by $i \\in \\{1, 2\\}$.\n- **Parameters for subpopulation $i$**:\n    - $n_i$: number of diploid individuals.\n    - $p_i$: frequency of allele $A$.\n    - $q_i = 1 - p_i$: frequency of allele $a$.\n- **Core Assumption**: Each subpopulation $i$ is exactly in Hardy–Weinberg equilibrium (HWE). Genotype frequencies are deterministic based on $p_i$.\n- **Process**: The two subpopulations are pooled. There is no mating after pooling.\n- **Definitions**:\n    - **Observed heterozygosity of the pooled set**: The proportion of heterozygous individuals ($Aa$) in the total pooled population.\n    - **Pooled allele frequency ($\\bar{p}$)**: The total-number-weighted average of $p_1$ and $p_2$.\n    - **Expected heterozygosity under panmixia**: The HWE heterozygote frequency for a population with allele frequency $\\bar{p}$, i.e., $2\\bar{p}(1-\\bar{p})$.\n    - **Wahlund effect ($W$)**: Defined as the difference between the expected heterozygosity under panmixia and the observed heterozygosity in the pooled set. $W = H_{exp} - H_{obs}$.\n- **Test Cases**: Five cases provided as $(n_1, p_1, n_2, p_2)$:\n    - A: $(100, 0.4, 100, 0.7)$\n    - B: $(50, 0.5, 200, 0.5)$\n    - C: $(120, 0.0, 80, 1.0)$\n    - D: $(10, 0.2, 1000, 0.21)$\n    - E: $(1, 1.0, 1, 1.0)$\n- **Output Requirement**: For each case, compute $W$, rounded to exactly six decimal places. The final output is a single-line string: `[w_A,w_B,w_C,w_D,w_E]`.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is a classic formulation from population genetics. The Wahlund effect, Hardy-Weinberg equilibrium, and the concepts of pooled populations are standard and fundamental principles in this field. The \"deterministic\" assumption is a standard simplification for an introductory theoretical problem.\n- **Well-Posed**: The problem is well-posed. All required variables ($n_i$, $p_i$) are provided. All terms ($H_{obs}$, $H_{exp}$, $\\bar{p}$, $W$) are explicitly and unambiguously defined. A unique solution exists for each test case.\n- **Objective**: The problem statement is strictly mathematical and objective. It contains no subjective claims or opinions.\n\nThe problem exhibits none of the invalidating flaws. It is scientifically sound, formally structured, complete, and verifiable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be formulated and provided.\n\n### Derivation of the Solution\nThe objective is to derive a closed-form expression for the Wahlund effect, $W$, and then apply it to the given test cases. We proceed from first principles.\n\nLet the alleles be $A$ and $a$. For subpopulation $i$, the frequency of allele $A$ is $p_i$ and the frequency of allele $a$ is $q_i = 1 - p_i$. The size of subpopulation $i$ is $n_i$.\n\n**1. Genotype counts in subpopulations:**\nAs each subpopulation is in Hardy-Weinberg equilibrium, the genotype frequencies for $AA$, $Aa$, and $aa$ in subpopulation $i$ are $p_i^2$, $2p_iq_i$, and $q_i^2$, respectively. The number of heterozygous individuals ($Aa$) in subpopulation $i$ is therefore:\n$$ N_{Aa, i} = n_i \\cdot (2p_iq_i) = 2n_i p_i (1-p_i) $$\n\n**2. Observed heterozygosity in the pooled population ($H_{obs}$):**\nWhen the subpopulations are pooled, the total number of individuals is $N_{total} = n_1 + n_2$. The total number of heterozygotes is the sum of heterozygotes from each subpopulation:\n$$ N_{Aa, pooled} = N_{Aa, 1} + N_{Aa, 2} = 2n_1 p_1 (1-p_1) + 2n_2 p_2 (1-p_2) $$\nThe observed heterozygosity, $H_{obs}$, is the proportion of these heterozygotes in the total pooled population:\n$$ H_{obs} = \\frac{N_{Aa, pooled}}{N_{total}} = \\frac{2n_1 p_1 (1-p_1) + 2n_2 p_2 (1-p_2)}{n_1 + n_2} $$\n\n**3. Pooled allele frequency ($\\bar{p}$):**\nThe total number of $A$ alleles in the diploid population is the sum of $A$ alleles from each subpopulation. In subpopulation $i$, there are $2n_i$ total alleles, of which a fraction $p_i$ are $A$. Thus, the count of $A$ alleles is $2n_ip_i$.\nThe total count of $A$ alleles in the pooled population is $2n_1p_1 + 2n_2p_2$. The total number of all alleles is $2N_{total} = 2(n_1+n_2)$.\nThe pooled allele frequency, $\\bar{p}$, is:\n$$ \\bar{p} = \\frac{2n_1p_1 + 2n_2p_2}{2(n_1 + n_2)} = \\frac{n_1p_1 + n_2p_2}{n_1 + n_2} $$\nThis confirms the definition given in the problem statement. This is simply the weighted average of the subpopulation allele frequencies, where the weights are the relative sizes of the subpopulations. Let $c_1 = \\frac{n_1}{n_1+n_2}$ and $c_2 = \\frac{n_2}{n_1+n_2}$. Then $\\bar{p} = c_1p_1 + c_2p_2$.\n\n**4. Expected heterozygosity under panmixia ($H_{exp}$):**\nIf this pooled population were to mate randomly (panmixia), it would form a single gene pool with allele frequency $\\bar{p}$. The expected heterozygosity under HWE for this panmictic population is:\n$$ H_{exp} = 2\\bar{p}(1-\\bar{p}) $$\n\n**5. The Wahlund Effect ($W$):**\nThe Wahlund effect is defined as $W = H_{exp} - H_{obs}$.\nSubstituting the expressions for $H_{exp}$ and $H_{obs}$:\n$$ W = 2\\bar{p}(1-\\bar{p}) - \\frac{2n_1 p_1 (1-p_1) + 2n_2 p_2 (1-p_2)}{n_1 + n_2} $$\nWe can simplify this expression. Note that $H_{obs}$ is the weighted average of the within-subpopulation heterozygosities: $H_{obs} = c_1(2p_1q_1) + c_2(2p_2q_2) = 2(c_1p_1q_1 + c_2p_2q_2)$. So,\n$$ W = 2\\bar{p}(1-\\bar{p}) - 2(c_1p_1(1-p_1) + c_2p_2(1-p_2)) $$\n$$ W = 2 \\left[ (\\bar{p} - \\bar{p}^2) - (c_1p_1 - c_1p_1^2 + c_2p_2 - c_2p_2^2) \\right] $$\n$$ W = 2 \\left[ (c_1p_1+c_2p_2) - (c_1p_1+c_2p_2)^2 - (c_1p_1+c_2p_2) + (c_1p_1^2 + c_2p_2^2) \\right] $$\n$$ W = 2 \\left[ (c_1p_1^2 + c_2p_2^2) - (c_1p_1 + c_2p_2)^2 \\right] $$\nThe term inside the brackets is the variance of the allele frequency $p$ across the subpopulations, $\\text{Var}(p) = E[p^2] - (E[p])^2$.\nSo, $W = 2 \\text{Var}(p)$. Let us expand this:\n$$ \\text{Var}(p) = (c_1p_1^2 + c_2p_2^2) - (c_1^2p_1^2 + 2c_1c_2p_1p_2 + c_2^2p_2^2) $$\n$$ \\text{Var}(p) = (c_1-c_1^2)p_1^2 + (c_2-c_2^2)p_2^2 - 2c_1c_2p_1p_2 $$\nSince $c_1+c_2=1$, we have $c_1-c_1^2 = c_1(1-c_1) = c_1c_2$ and $c_2-c_2^2 = c_2(1-c_2) = c_1c_2$.\n$$ \\text{Var}(p) = c_1c_2p_1^2 + c_1c_2p_2^2 - 2c_1c_2p_1p_2 = c_1c_2(p_1^2 - 2p_1p_2 + p_2^2) = c_1c_2(p_1-p_2)^2 $$\nTherefore, the Wahlund effect $W$ has the elegant and compact form:\n$$ W = 2 c_1 c_2 (p_1 - p_2)^2 $$\nSubstituting the definitions of $c_1$ and $c_2$:\n$$ W = 2 \\left(\\frac{n_1}{n_1+n_2}\\right) \\left(\\frac{n_2}{n_1+n_2}\\right) (p_1 - p_2)^2 = \\frac{2 n_1 n_2}{(n_1+n_2)^2} (p_1 - p_2)^2 $$\nThis final formula is computationally efficient and will be used to solve the test cases. It demonstrates that the Wahlund effect is non-negative and is only zero if the allele frequencies in the subpopulations are identical ($p_1=p_2$).\n\n### Computations for Test Cases\n- **Case A**: $(n_1, p_1, n_2, p_2) = (100, 0.4, 100, 0.7)$\n$W = \\frac{2(100)(100)}{(100+100)^2} (0.4 - 0.7)^2 = \\frac{20000}{40000} (-0.3)^2 = 0.5 \\times 0.09 = 0.045$. Rounded: $0.045000$.\n\n- **Case B**: $(n_1, p_1, n_2, p_2) = (50, 0.5, 200, 0.5)$\n$p_1 - p_2 = 0.5 - 0.5 = 0$. Thus, $W=0$. Rounded: $0.000000$.\n\n- **Case C**: $(n_1, p_1, n_2, p_2) = (120, 0.0, 80, 1.0)$\n$W = \\frac{2(120)(80)}{(120+80)^2} (0.0 - 1.0)^2 = \\frac{19200}{40000} (-1)^2 = 0.48 \\times 1 = 0.48$. Rounded: $0.480000$.\n\n- **Case D**: $(n_1, p_1, n_2, p_2) = (10, 0.2, 1000, 0.21)$\n$W = \\frac{2(10)(1000)}{(10+1000)^2} (0.2 - 0.21)^2 = \\frac{20000}{1010^2} (-0.01)^2 = \\frac{20000}{1020100} (0.0001) = \\frac{2}{1020100} \\approx 0.00000196$. Rounded: $0.000002$.\n\n- **Case E**: $(n_1, p_1, n_2, p_2) = (1, 1.0, 1, 1.0)$\n$p_1 - p_2 = 1.0 - 1.0 = 0$. Thus, $W=0$. Rounded: $0.000000$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Wahlund effect for several test cases of pooled subpopulations.\n    \"\"\"\n    # Define the test cases from the problem statement as a list of tuples.\n    # Each tuple is in the format (n1, p1, n2, p2).\n    test_cases = [\n        (100, 0.4, 100, 0.7),    # Test case A\n        (50, 0.5, 200, 0.5),    # Test case B\n        (120, 0.0, 80, 1.0),    # Test case C\n        (10, 0.2, 1000, 0.21),  # Test case D\n        (1, 1.0, 1, 1.0),       # Test case E\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case.\n        n1, p1, n2, p2 = case\n\n        # The Wahlund effect (W) is calculated using the derived formula:\n        # W = 2 * c1 * c2 * (p1 - p2)^2\n        # where c1 = n1 / (n1 + n2) and c2 = n2 / (n1 + n2).\n        # This simplifies to W = (2 * n1 * n2 / (n1 + n2)^2) * (p1 - p2)^2.\n\n        n_total = n1 + n2\n        \n        # Guard against division by zero, although not present in test data.\n        if n_total == 0:\n            w = 0.0\n        else:\n            # Calculate the two components of the formula.\n            size_component = (2 * n1 * n2) / (n_total**2)\n            freq_component = (p1 - p2)**2\n            \n            # Combine components to get the Wahlund effect.\n            w = size_component * freq_component\n        \n        # Format the result to exactly six decimal places and append to the list.\n        results.append(f\"{w:.6f}\")\n\n    # Final print statement in the exact required format: [w_A,w_B,w_C,w_D,w_E]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}