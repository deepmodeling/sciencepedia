{
    "hands_on_practices": [
        {
            "introduction": "Understanding how linkage disequilibrium (LD) changes over time is fundamental to population genetics. In the absence of other evolutionary forces, meiotic recombination is the primary mechanism that breaks down statistical associations between loci. This exercise guides you through the process of deriving the classic equation for the exponential decay of LD from first principles, providing a quantitative grasp of how physical distance between genes, represented by the recombination fraction $r$, governs the speed at which genetic shuffling erodes LD .",
            "id": "2728798",
            "problem": "Consider a large, randomly mating population with non-overlapping generations evolving under no selection, no mutation, and no migration. Two diallelic loci, denoted by $A/a$ and $B/b$, lie on the same chromosome with recombination fraction $r$ between them, where $0 < r < \\tfrac{1}{2}$. Let the haplotype frequencies in generation $t$ be $p_{AB,t}$, $p_{Ab,t}$, $p_{aB,t}$, and $p_{ab,t}$, which sum to $1$. Let the allele frequencies be $p_{A,t} = p_{AB,t} + p_{Ab,t}$ and $p_{B,t} = p_{AB,t} + p_{aB,t}$. Define the two-locus Linkage Disequilibrium (LD) coefficient as $D_t = p_{AB,t} - p_{A,t} p_{B,t}$.\n\nStarting only from these definitions and Mendelian recombination with recombination fraction $r$, first derive the recursion for the haplotype frequency $p_{AB,t+1}$ in terms of $p_{AB,t}$, $p_{Ab,t}$, $p_{aB,t}$, $p_{ab,t}$, and $r$. Then use it to obtain a closed-form expression for $D_t$ as a function of $t$, $r$, and $D_0$.\n\nFinally, for $r = 0.02$, compute the minimal integer number of generations $t_{\\tfrac{1}{2}}$ required so that $|D_t| \\leq \\tfrac{1}{2} |D_0|$. Report $t_{\\tfrac{1}{2}}$ as an integer (no units).",
            "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It represents a fundamental exercise in classical population genetics. We shall proceed with the derivation and calculation.\n\nThe problem contains three parts. First, we must derive the recursion for the haplotype frequency $p_{AB,t+1}$. Second, we must derive a closed-form expression for the linkage disequilibrium coefficient $D_t$. Third, we must compute the half-life of linkage disequilibrium for a specific recombination rate.\n\nPart 1: Derivation of the recursion for $p_{AB,t+1}$\n\nWe consider a large, randomly mating population. The frequency of any haplotype in the gamete pool of generation $t+1$ is determined by the frequencies in generation $t$ and the process of meiosis, which includes recombination. A haplotype $AB$ in generation $t+1$ can be formed in one of two ways:\n\n1. It is a direct copy of a parental $AB$ haplotype that was transmitted without recombination. The frequency of $AB$ haplotypes in the generation $t$ gamete pool is $p_{AB,t}$. The probability that such a haplotype does not undergo recombination between the $A$ and $B$ loci is $(1-r)$. Therefore, the contribution from non-recombinant gametes to the frequency of $AB$ in the next generation is $(1-r)p_{AB,t}$.\n\n2. It is newly formed by a recombination event. In a randomly mating population, the two homologous chromosomes that undergo meiosis in an individual are drawn independently from the gamete pool of the previous generation. A new $AB$ haplotype is formed if one parental chromosome carries allele $A$ and the other carries allele $B$, and a crossover occurs between them. The probability of drawing a chromosome with allele $A$ is $p_{A,t}$, and the probability of drawing one with allele $B$ is $p_{B,t}$. Due to random mating, the frequency of zygotes formed from gametes containing these alleles (in any combination on the two chromosomes) provides the pool for recombination. The overall frequency with which recombination brings an $A$ allele from one chromosome and a $B$ allele from the homologous chromosome together onto a single new chromosome is given by the product of the recombination fraction $r$ and the frequencies of the respective alleles in the population, $p_{A,t}$ and $p_{B,t}$. This contributes $r p_{A,t} p_{B,t}$ to the frequency of $AB$ in the next generation.\n\nCombining these two possibilities, the total frequency of haplotype $AB$ in generation $t+1$ is the sum of these two contributions:\n$$p_{AB, t+1} = (1-r)p_{AB,t} + r p_{A,t} p_{B,t}$$\nThis is the required recursion for the haplotype frequency $p_{AB,t+1}$.\n\nPart 2: Derivation of a closed-form expression for $D_t$\n\nThe linkage disequilibrium coefficient in generation $t$ is defined as $D_t = p_{AB,t} - p_{A,t} p_{B,t}$. We seek an expression for $D_t$ in terms of $D_0$, $r$, and $t$.\n\nFirst, we establish that under the given conditions (no selection, mutation, or migration), allele frequencies are constant across generations. The frequency of allele $A$ in generation $t+1$ is $p_{A,t+1} = p_{AB,t+1} + p_{Ab,t+1}$. A similar recursion as the one derived for $p_{AB,t+1}$ holds for $p_{Ab,t+1}$:\n$$p_{Ab, t+1} = (1-r)p_{Ab,t} + r p_{A,t} p_{b,t}$$\nwhere $p_{b,t} = 1 - p_{B,t}$.\nSubstituting these into the expression for $p_{A,t+1}$:\n$$p_{A,t+1} = \\left( (1-r)p_{AB,t} + r p_{A,t} p_{B,t} \\right) + \\left( (1-r)p_{Ab,t} + r p_{A,t} p_{b,t} \\right)$$\n$$p_{A,t+1} = (1-r)(p_{AB,t} + p_{Ab,t}) + r p_{A,t}(p_{B,t} + p_{b,t})$$\nUsing the definitions $p_{A,t} = p_{AB,t} + p_{Ab,t}$ and $p_{B,t} + p_{b,t} = 1$:\n$$p_{A,t+1} = (1-r)p_{A,t} + r p_{A,t}(1) = p_{A,t} - r p_{A,t} + r p_{A,t} = p_{A,t}$$\nThus, the allele frequency $p_A$ is constant over time. By identical logic, $p_B$ is also constant. We can therefore drop the time subscript for allele frequencies: $p_A \\equiv p_{A,t}$ and $p_B \\equiv p_{B,t}$ for all $t \\ge 0$.\n\nNow, let's write the recursion for $D_t$.\n$$D_{t+1} = p_{AB,t+1} - p_{A,t+1} p_{B,t+1} = p_{AB,t+1} - p_A p_B$$\nSubstitute the expression for $p_{AB,t+1}$:\n$$D_{t+1} = \\left( (1-r)p_{AB,t} + r p_A p_B \\right) - p_A p_B$$\n$$D_{t+1} = (1-r)p_{AB,t} - (1-r)p_A p_B$$\n$$D_{t+1} = (1-r)(p_{AB,t} - p_A p_B)$$\nBy definition, $D_t = p_{AB,t} - p_A p_B$. So, we have the simple geometric recursion:\n$$D_{t+1} = (1-r)D_t$$\nThis relationship shows that linkage disequilibrium decays by a factor of $(1-r)$ each generation. Applying this recursion $t$ times from an initial state $D_0$ yields the closed-form expression:\n$$D_t = (1-r)^t D_0$$\n\nPart 3: Calculation of the half-life of LD\n\nWe are asked to find the minimal integer number of generations $t_{\\frac{1}{2}}$ required for the magnitude of linkage disequilibrium to be reduced to at most half of its initial magnitude. This is expressed by the inequality:\n$$|D_t| \\le \\frac{1}{2} |D_0|$$\nSubstituting the expression for $D_t$:\n$$|(1-r)^t D_0| \\le \\frac{1}{2} |D_0|$$\nIf $D_0 \\neq 0$, we can divide by $|D_0|$:\n$$|(1-r)^t| \\le \\frac{1}{2}$$\nThe problem states $0 < r < \\frac{1}{2}$, which implies $0 < 1-r < 1$. For any non-negative integer $t$, $(1-r)^t$ is positive, so the absolute value is redundant.\n$$(1-r)^t \\le \\frac{1}{2}$$\nTo solve for $t$, we take the natural logarithm of both sides.\n$$\\ln((1-r)^t) \\le \\ln\\left(\\frac{1}{2}\\right)$$\n$$t \\ln(1-r) \\le -\\ln(2)$$\nSince $0 < 1-r < 1$, its logarithm $\\ln(1-r)$ is a negative number. Dividing the inequality by this negative number reverses the inequality sign:\n$$t \\ge \\frac{-\\ln(2)}{\\ln(1-r)} = \\frac{\\ln(2)}{-\\ln(1-r)}$$\nWe are given $r = 0.02$. Substituting this value:\n$$t \\ge \\frac{\\ln(2)}{-\\ln(1-0.02)} = \\frac{\\ln(2)}{-\\ln(0.98)}$$\nNumerically, $\\ln(2) \\approx 0.693147$ and $\\ln(0.98) \\approx -0.020203$.\n$$t \\ge \\frac{0.693147}{-(-0.020203)} \\approx 34.309$$\nSince $t$ must be an integer number of generations, the minimal integer value for $t$ that satisfies this condition is the smallest integer greater than or equal to $34.309$.\n$$t_{\\frac{1}{2}} = \\lceil 34.309 \\ldots \\rceil = 35$$\nTherefore, it takes $35$ generations for the linkage disequilibrium to decay to half or less of its original value.",
            "answer": "$$\\boxed{35}$$"
        },
        {
            "introduction": "While the linkage disequilibrium coefficient $D$ is a fundamental measure of non-random association, its value is constrained by the allele frequencies at the loci in question, making it difficult to compare the strength of LD across different populations or genomic regions. This practice introduces several standardized measures, including $D'$ and the squared correlation coefficient $r^2$, which normalize for allele frequencies and provide a more robust toolkit for interpreting and comparing patterns of LD . By calculating these different metrics for the same dataset, you will develop a nuanced understanding of what each measure reveals.",
            "id": "2728701",
            "problem": "Consider two diallelic loci with alleles $A/a$ and $B/b$ in a randomly mating population. Let the haplotype frequencies be $f_{AB}$, $f_{Ab}$, $f_{aB}$, and $f_{ab}$, which satisfy $f_{AB} + f_{Ab} + f_{aB} + f_{ab} = 1$ and are all nonnegative. Let the allele frequencies be $p_A = f_{AB} + f_{Ab}$, $p_a = 1 - p_A$, $p_B = f_{AB} + f_{aB}$, and $p_b = 1 - p_B$. Linkage disequilibrium is defined by $D = f_{AB} - p_A p_B$.\n\nYour tasks are:\n1. Starting only from the constraints that the four haplotype frequencies are nonnegative and sum to $1$, derive the tight bounds that $D$ must satisfy as functions of $p_A$ and $p_B$. From these bounds, obtain the theoretical maximum magnitude of $D$ achievable given $p_A$ and $p_B$ when $D>0$ and when $D<0$. Then define the normalized linkage disequilibrium $D'$ as $D$ divided by that theoretical maximum in the appropriate sign case.\n2. Treat the presence of allele $A$ as a Bernoulli random variable $X \\in \\{0,1\\}$ with $\\Pr(X=1)=p_A$ and the presence of allele $B$ as a Bernoulli random variable $Y \\in \\{0,1\\}$ with $\\Pr(Y=1)=p_B$. Using the definition of correlation from probability theory, express the Pearson correlation coefficient $r$ between $X$ and $Y$ in terms of $D$, $p_A$, $p_a$, $p_B$, and $p_b$, and define $r^2$.\n3. Using the definition of mutual information from information theory, write the mutual information $I(X;Y)$ between the two loci in terms of the haplotype and allele frequencies. Use the natural logarithm $\\ln$ and express the mutual information in nats.\n4. Now suppose the observed haplotype frequencies are $f_{AB} = 0.32$, $f_{Ab} = 0.18$, $f_{aB} = 0.28$, and $f_{ab} = 0.22$. Compute $p_A$, $p_B$, $D$, and then use your derivations to calculate $D'$, $r$, $r^2$, and $I(X;Y)$ for these data.\n5. Briefly explain the interpretational differences between $D$ and $D'$ in terms of scale, comparability across allele-frequency regimes, and what values near their extrema signify under realistic recombination dynamics in a randomly mating population without other forces.\n\nReport only the four numerical values $D'$, $r$, $r^2$, and $I(X;Y)$, in that order, rounded to four significant figures. Express the mutual information in nats. Your final reported answer must be a single row matrix containing these four values in the specified order.",
            "solution": "**Part 1: Derivation of Bounds on D and Definition of D'**\nThe four haplotype frequencies can be expressed in terms of allele frequencies and the linkage disequilibrium parameter $D$.\nFrom the definitions $p_A = f_{AB} + f_{Ab}$ and $p_B = f_{AB} + f_{aB}$, and $D = f_{AB} - p_A p_B$, we derive:\n$f_{AB} = p_A p_B + D$\n$f_{Ab} = p_A - f_{AB} = p_A - (p_A p_B + D) = p_A(1 - p_B) - D = p_A p_b - D$\n$f_{aB} = p_B - f_{AB} = p_B - (p_A p_B + D) = p_B(1 - p_A) - D = p_a p_B - D$\nSince the frequencies must sum to $1$, the fourth frequency is:\n$f_{ab} = 1 - f_{AB} - f_{Ab} - f_{aB} = 1 - (p_A p_B + D) - (p_A p_b - D) - (p_a p_B - D) = 1 - p_A(p_B+p_b) - p_a p_B + D = 1 - p_A - p_a p_B + D = p_a - p_a p_B + D = p_a(1-p_B) + D = p_a p_b + D$.\n\nThe fundamental constraint is that all frequencies must be non-negative ($f_{ij} \\ge 0$). Applying this to each of the four expressions:\n1. $f_{AB} \\ge 0 \\implies p_A p_B + D \\ge 0 \\implies D \\ge -p_A p_B$\n2. $f_{Ab} \\ge 0 \\implies p_A p_b - D \\ge 0 \\implies D \\le p_A p_b$\n3. $f_{aB} \\ge 0 \\implies p_a p_B - D \\ge 0 \\implies D \\le p_a p_B$\n4. $f_{ab} \\ge 0 \\implies p_a p_b + D \\ge 0 \\implies D \\ge -p_a p_b$\n\nCombining these inequalities provides the tight bounds for $D$:\nThe lower bound is $D \\ge \\max(-p_A p_B, -p_a p_b) = -\\min(p_A p_B, p_a p_b)$. Let this be $D_{\\min}$.\nThe upper bound is $D \\le \\min(p_A p_b, p_a p_B)$. Let this be $D_{\\max}$.\nThus, the tight bounds are $D_{\\min} \\le D \\le D_{\\max}$.\n\nThe normalized linkage disequilibrium, $D'$, is defined by dividing $D$ by its theoretical maximum magnitude for the given allele frequencies.\nIf $D > 0$, the maximum possible value is $D_{\\max}$. Thus, $D' = \\frac{D}{D_{\\max}} = \\frac{D}{\\min(p_A p_b, p_a p_B)}$.\nIf $D < 0$, the minimum possible value is $D_{\\min}$, so the maximum magnitude is $|D_{\\min}| = -D_{\\min}$. Thus, $D' = \\frac{D}{|D_{\\min}|} = \\frac{D}{\\min(p_A p_B, p_a p_b)}$.\nIf $D = 0$, $D'$ is $0$.\n\n**Part 2: Pearson Correlation Coefficient r**\nThe Pearson correlation coefficient is $r = \\frac{\\text{Cov}(X,Y)}{\\sigma_X \\sigma_Y}$.\nThe means of the Bernoulli random variables $X$ and $Y$ are $E[X] = p_A$ and $E[Y] = p_B$.\nThe expectation of their product is $E[XY] = \\Pr(X=1, Y=1) = f_{AB}$.\nThe covariance is $\\text{Cov}(X,Y) = E[XY] - E[X]E[Y] = f_{AB} - p_A p_B = D$.\nThe variances of Bernoulli variables are $\\sigma_X^2 = p_A(1-p_A) = p_A p_a$ and $\\sigma_Y^2 = p_B(1-p_B) = p_B p_b$.\nThe standard deviations are $\\sigma_X = \\sqrt{p_A p_a}$ and $\\sigma_Y = \\sqrt{p_B p_b}$.\nSubstituting these into the formula for $r$:\n$$r = \\frac{D}{\\sqrt{p_A p_a p_B p_b}}$$\nThe squared correlation coefficient, $r^2$, is a common measure of linkage disequilibrium:\n$$r^2 = \\frac{D^2}{p_A p_a p_B p_b}$$\n\n**Part 3: Mutual Information I(X;Y)**\nMutual information between two discrete random variables $X$ and $Y$ is given by:\n$$I(X;Y) = \\sum_{x,y} \\Pr(x,y) \\ln\\left(\\frac{\\Pr(x,y)}{\\Pr(x)\\Pr(y)}\\right)$$\nIn this context, the joint probabilities $\\Pr(x,y)$ are the haplotype frequencies $f_{ij}$, and the marginal probabilities $\\Pr(x)$ and $\\Pr(y)$ are the allele frequencies $p_i$ and $p_j$. The summation is over all four haplotypes.\n$$I(X;Y) = f_{AB} \\ln\\left(\\frac{f_{AB}}{p_A p_B}\\right) + f_{Ab} \\ln\\left(\\frac{f_{Ab}}{p_A p_b}\\right) + f_{aB} \\ln\\left(\\frac{f_{aB}}{p_a p_B}\\right) + f_{ab} \\ln\\left(\\frac{f_{ab}}{p_a p_b}\\right)$$\nThis is measured in nats, as the natural logarithm is used.\n\n**Part 4: Numerical Computations**\nGiven haplotype frequencies: $f_{AB} = 0.32$, $f_{Ab} = 0.18$, $f_{aB} = 0.28$, $f_{ab} = 0.22$.\n1. Compute allele frequencies:\n$p_A = f_{AB} + f_{Ab} = 0.32 + 0.18 = 0.50$\n$p_a = 1 - p_A = 0.50$\n$p_B = f_{AB} + f_{aB} = 0.32 + 0.28 = 0.60$\n$p_b = 1 - p_B = 0.40$\n\n2. Compute $D$:\n$D = f_{AB} - p_A p_B = 0.32 - (0.50)(0.60) = 0.32 - 0.30 = 0.02$\n\n3. Compute $D'$:\nSince $D = 0.02 > 0$, we use $D' = \\frac{D}{\\min(p_A p_b, p_a p_B)}$.\n$p_A p_b = (0.50)(0.40) = 0.20$\n$p_a p_B = (0.50)(0.60) = 0.30$\n$D_{\\max} = \\min(0.20, 0.30) = 0.20$\n$D' = \\frac{0.02}{0.20} = 0.1$\n\n4. Compute $r$ and $r^2$:\n$r = \\frac{D}{\\sqrt{p_A p_a p_B p_b}} = \\frac{0.02}{\\sqrt{(0.50)(0.50)(0.60)(0.40)}} = \\frac{0.02}{\\sqrt{0.06}} \\approx 0.081649658$\n$r^2 = \\frac{D^2}{p_A p_a p_B p_b} = \\frac{(0.02)^2}{0.06} = \\frac{0.0004}{0.06} = \\frac{1}{150} \\approx 0.0066666...$\n\n5. Compute $I(X;Y)$:\n$I(X;Y) = 0.32 \\ln\\left(\\frac{0.32}{0.5 \\times 0.6}\\right) + 0.18 \\ln\\left(\\frac{0.18}{0.5 \\times 0.4}\\right) + 0.28 \\ln\\left(\\frac{0.28}{0.5 \\times 0.6}\\right) + 0.22 \\ln\\left(\\frac{0.22}{0.5 \\times 0.4}\\right)$\n$I(X;Y) = 0.32 \\ln\\left(\\frac{0.32}{0.30}\\right) + 0.18 \\ln\\left(\\frac{0.18}{0.20}\\right) + 0.28 \\ln\\left(\\frac{0.28}{0.30}\\right) + 0.22 \\ln\\left(\\frac{0.22}{0.20}\\right)$\n$I(X;Y) \\approx 0.32(0.0645385) + 0.18(-0.1053605) + 0.28(-0.0689928) + 0.22(0.0953102)$\n$I(X;Y) \\approx 0.0206523 - 0.0189649 - 0.0193180 + 0.0209682 \\approx 0.0033376$ nats.\n\nRounding the results to four significant figures:\n$D' = 0.1000$\n$r = 0.08165$\n$r^2 = 0.006667$\n$I(X;Y) = 0.003338$\n\n**Part 5: Interpretational Differences**\nThe measure $D$ is the fundamental covariance between the presence of alleles at two loci. However, its value is constrained by the allele frequencies of the population. The range $[D_{\\min}, D_{\\max}]$ is often asymmetric and its width depends heavily on $p_A$ and $p_B$. For example, if one allele is rare, the maximum possible value of $D$ is small. This makes it impossible to compare the strength of linkage disequilibrium between populations or loci with different allele frequencies using $D$ alone.\n\nThe normalized measure $D'$ corrects for this dependency. By scaling $D$ to its maximum possible value given the allele frequencies, $D'$ always ranges from $-1$ to $1$. A value of $D'=-1$ or $D'=1$ represents complete linkage disequilibrium, where at least one of the four haplotypes is absent. This normalization renders the metric comparable across different systems. In a randomly mating population, recombination breaks down associations, driving $D$ and $D'$ toward $0$. A value of $|D'|$ near $1$ therefore signifies that recombination has been ineffective at breaking down the non-random association between alleles. This can be due to very tight physical linkage (low recombination rate), a recent event such as mutation or population admixture, or strong natural selection favoring certain haplotype combinations.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.1000 & 0.08165 & 0.006667 & 0.003338 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Theoretical exercises often begin with known haplotype frequencies, but real-world genetic data typically consists of unphased genotypes, where the cis/trans configuration of alleles in double heterozygotes is unknown. This presents a critical challenge for estimating LD from empirical data. This final practice delves into the statistical solution to this 'phasing problem' by exploring the Expectation-Maximization (EM) algorithm, a powerful iterative method used to find maximum likelihood estimates of haplotype frequencies from genotype counts .",
            "id": "2728773",
            "problem": "A diploid population is sampled at $2$ biallelic loci with alleles $A/a$ and $B/b$. Genotypes are unphased, and the observed counts across the $9$ two-locus genotype classes are\n$n_{AABB}$, $n_{AABb}$, $n_{AAbb}$, $n_{AaBB}$, $n_{AaBb}$, $n_{Aabb}$, $n_{aaBB}$, $n_{aaBb}$, $n_{aabb}$, with total $n = \\sum n_{\\cdot}$. Let the unknown haplotype frequencies be $p_{AB}$, $p_{Ab}$, $p_{aB}$, $p_{ab}$, which sum to $1$. The goal is to estimate the haplotype frequencies and the linkage disequilibrium (LD) parameter $D$ from the unphased counts by maximum likelihood under random mating, assuming Hardy–Weinberg equilibrium (HWE) at the haplotype level, no genotyping error, and no segregation distortion.\n\nExpectation–Maximization (EM) is used because phasing is unknown in double heterozygotes ($Aa,Bb$). The complete-data are haplotype pairs (diplotypes), whose expected counts can be computed from current haplotype frequencies and the observed unphased genotypes; the maximization step then updates haplotype frequencies by normalized expected haplotype counts. The LD parameter can be computed from the updated haplotype frequencies as a function of the four $p_{\\cdot}$.\n\nWhich option correctly specifies the EM E-step allocation for the ambiguous double heterozygotes and the M-step updates for $p_{AB}$, $p_{Ab}$, $p_{aB}$, $p_{ab}$ and $D$?\n\nA. E-step: For each $Aa,Bb$ individual, the posterior probability of diplotype $AB\\mid ab$ is\n$$x^{(t)} \\;=\\; \\frac{p_{AB}^{(t)}\\,p_{ab}^{(t)}}{p_{AB}^{(t)}\\,p_{ab}^{(t)} \\;+\\; p_{Ab}^{(t)}\\,p_{aB}^{(t)}},$$\nand of $Ab\\mid aB$ is $1 - x^{(t)}$. M-step: Let $n = \\sum n_{\\cdot}$. Update haplotype frequencies by normalized expected haplotype counts,\n$$p_{AB}^{(t+1)} \\;=\\; \\frac{2\\,n_{AABB} \\;+\\; n_{AABb} \\;+\\; n_{AaBB} \\;+\\; x^{(t)}\\,n_{AaBb}}{2n},$$\n$$p_{Ab}^{(t+1)} \\;=\\; \\frac{2\\,n_{AAbb} \\;+\\; n_{AABb} \\;+\\; n_{Aabb} \\;+\\; \\bigl(1 - x^{(t)}\\bigr)\\,n_{AaBb}}{2n},$$\n$$p_{aB}^{(t+1)} \\;=\\; \\frac{2\\,n_{aaBB} \\;+\\; n_{AaBB} \\;+\\; n_{aaBb} \\;+\\; \\bigl(1 - x^{(t)}\\bigr)\\,n_{AaBb}}{2n},$$\n$$p_{ab}^{(t+1)} \\;=\\; \\frac{2\\,n_{aabb} \\;+\\; n_{Aabb} \\;+\\; n_{aaBb} \\;+\\; x^{(t)}\\,n_{AaBb}}{2n},$$\nand compute\n$$D^{(t+1)} \\;=\\; p_{AB}^{(t+1)}\\,p_{ab}^{(t+1)} \\;-\\; p_{Ab}^{(t+1)}\\,p_{aB}^{(t+1)}.$$\n\nB. E-step: For each $Aa,Bb$ individual, assign diplotype $AB\\mid ab$ with probability\n$$x^{(t)} \\;=\\; \\frac{p_{AB}^{(t)}}{p_{AB}^{(t)} \\;+\\; p_{ab}^{(t)}},$$\nand $Ab\\mid aB$ otherwise. M-step: Update\n$$p_{AB}^{(t+1)} \\;=\\; \\frac{2\\,n_{AABB} \\;+\\; n_{AABb} \\;+\\; n_{AaBB} \\;+\\; 2\\,x^{(t)}\\,n_{AaBb}}{2n},$$\nwith analogous formulas for the other haplotypes, and $D^{(t+1)} \\;=\\; p_{AB}^{(t+1)} \\;-\\; p_{A}^{(t)}\\,p_{B}^{(t)}$.\n\nC. E-step: For each $Aa,Bb$ individual, set\n$$x^{(t)} \\;=\\; \\frac{\\bigl(p_{AB}^{(t)}\\bigr)^{2}}{\\bigl(p_{AB}^{(t)}\\bigr)^{2} \\;+\\; \\bigl(p_{ab}^{(t)}\\bigr)^{2}},$$\nand $1-x^{(t)}$ for $Ab\\mid aB$. M-step: Update\n$$p_{AB}^{(t+1)} \\;=\\; \\frac{2\\,n_{AABB} \\;+\\; n_{AABb} \\;+\\; n_{AaBB} \\;+\\; x^{(t)}\\,n_{AaBb}}{n},$$\nwith analogous updates for the others, and $D^{(t+1)} \\;=\\; p_{AB}^{(t+1)} \\;-\\; p_{A}^{(t+1)} \\;-\\; p_{B}^{(t+1)}$.\n\nD. E-step: For each $Aa,Bb$ individual,\n$$x^{(t)} \\;=\\; \\frac{p_{AB}^{(t)}\\,p_{ab}^{(t)}}{p_{AB}^{(t)}\\,p_{ab}^{(t)} \\;+\\; p_{Ab}^{(t)}\\,p_{aB}^{(t)}},$$\nand $1-x^{(t)}$ for $Ab\\mid aB$. M-step: Update\n$$p_{AB}^{(t+1)} \\;=\\; \\frac{2\\,n_{AABB} \\;+\\; 2\\,n_{AABb} \\;+\\; 2\\,n_{AaBB} \\;+\\; 2\\,x^{(t)}\\,n_{AaBb}}{2n},$$\nwith analogous expressions for the others, and\n$$D^{(t+1)} \\;=\\; p_{AB}^{(t+1)}\\,p_{ab}^{(t+1)} \\;+\\; p_{Ab}^{(t+1)}\\,p_{aB}^{(t+1)}.$$",
            "solution": "To determine the correct option, we will derive the update equations for the Expectation-Maximization (EM) algorithm as applied to this problem of estimating haplotype frequencies from unphased genotype data. The EM algorithm is an iterative procedure for finding maximum likelihood estimates when data is incomplete. Here, the \"incomplete\" aspect is the unknown phase of the $n_{AaBb}$ double heterozygotes.\n\nAn individual with genotype $AaBb$ can have one of two diplotypes: $AB/ab$ (coupling phase) or $Ab/aB$ (repulsion phase). Assuming Hardy-Weinberg equilibrium at the haplotype level, the expected frequencies of these diplotypes are $2 p_{AB} p_{ab}$ and $2 p_{Ab} p_{aB}$, respectively.\n\nThe EM algorithm proceeds in two steps at each iteration $t$:\n\n**E-Step (Expectation):**\nGiven the current estimates of haplotype frequencies $p^{(t)} = (p_{AB}^{(t)}, p_{Ab}^{(t)}, p_{aB}^{(t)}, p_{ab}^{(t)})$, we calculate the posterior probability that an individual with genotype $AaBb$ has the $AB/ab$ diplotype. Let this probability be $x^{(t)}$. Using Bayes' theorem:\n$$ x^{(t)} = \\text{Pr}(AB/ab \\mid AaBb, p^{(t)}) = \\frac{\\text{Pr}(AaBb \\mid AB/ab) \\cdot \\text{Pr}(AB/ab \\mid p^{(t)})}{\\text{Pr}(AaBb \\mid p^{(t)})} $$\nSince $\\text{Pr}(AaBb \\mid AB/ab) = 1$, $\\text{Pr}(AB/ab \\mid p^{(t)}) = 2 p_{AB}^{(t)} p_{ab}^{(t)}$, and $\\text{Pr}(AaBb \\mid p^{(t)}) = 2 p_{AB}^{(t)} p_{ab}^{(t)} + 2 p_{Ab}^{(t)} p_{aB}^{(t)}$, this simplifies to:\n$$ x^{(t)} = \\frac{2 p_{AB}^{(t)} p_{ab}^{(t)}}{2 p_{AB}^{(t)} p_{ab}^{(t)} + 2 p_{Ab}^{(t)} p_{aB}^{(t)}} = \\frac{p_{AB}^{(t)} p_{ab}^{(t)}}{p_{AB}^{(t)} p_{ab}^{(t)} + p_{Ab}^{(t)} p_{aB}^{(t)}} $$\nThe probability of the alternative diplotype, $Ab/aB$, is $1 - x^{(t)}$. This matches the E-step in options A and D.\n\n**M-Step (Maximization):**\nWe update the haplotype frequency estimates by counting the expected number of each haplotype and dividing by the total number of haplotypes in the sample ($2n$).\n\nThe new estimate for $p_{AB}$ is found by summing the contributions from each genotype:\n- $AABB$ individuals ($n_{AABB}$) each contribute two $AB$ haplotypes.\n- $AABb$ individuals ($n_{AABb}$) each contribute one $AB$ haplotype.\n- $AaBB$ individuals ($n_{AaBB}$) each contribute one $AB$ haplotype.\n- From the $n_{AaBb}$ individuals, an expected $n_{AaBb} \\cdot x^{(t)}$ have the $AB/ab$ diplotype, each contributing one $AB$ haplotype.\nSumming these contributions and dividing by $2n$ gives the update rule:\n$$ p_{AB}^{(t+1)} = \\frac{2 n_{AABB} + n_{AABb} + n_{AaBB} + x^{(t)} n_{AaBb}}{2n} $$\nBy analogous counting for the other three haplotypes:\n$$p_{Ab}^{(t+1)} = \\frac{2 n_{AAbb} + n_{AABb} + n_{Aabb} + (1-x^{(t)}) n_{AaBb}}{2n}$$\n$$p_{aB}^{(t+1)} = \\frac{2 n_{aaBB} + n_{AaBB} + n_{aaBb} + (1-x^{(t)}) n_{AaBb}}{2n}$$\n$$p_{ab}^{(t+1)} = \\frac{2 n_{aabb} + n_{Aabb} + n_{aaBb} + x^{(t)} n_{AaBb}}{2n}$$\nThese M-step update equations for haplotype frequencies match those in Option A.\n\nFinally, the linkage disequilibrium parameter $D$ is calculated from the updated haplotype frequencies using its standard definition, $D = p_{AB} p_{ab} - p_{Ab} p_{aB}$. The updated estimate is:\n$$ D^{(t+1)} = p_{AB}^{(t+1)} p_{ab}^{(t+1)} - p_{Ab}^{(t+1)} p_{aB}^{(t+1)} $$\nThis also matches the formula for $D$ in Option A.\n\n**Evaluation of Options:**\n- **Option A:** All parts—the E-step, the M-step updates for all four haplotypes, and the calculation of $D$—are correct according to our derivation.\n- **Option B:** The E-step formula for $x^{(t)}$ is incorrect. The M-step update for $p_{AB}$ incorrectly counts two $AB$ haplotypes from each expected $AB/ab$ individual.\n- **Option C:** The E-step formula is incorrect. The M-step updates incorrectly use $n$ instead of $2n$ in the denominator. The formula for $D$ is completely wrong.\n- **Option D:** While the E-step is correct, the M-step update equations incorrectly weight the contributions from heterozygous genotypes. The formula for $D$ is also incorrect (it has a plus sign instead of a minus sign).\n\nTherefore, Option A is the only one that correctly specifies the EM algorithm for this problem.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}