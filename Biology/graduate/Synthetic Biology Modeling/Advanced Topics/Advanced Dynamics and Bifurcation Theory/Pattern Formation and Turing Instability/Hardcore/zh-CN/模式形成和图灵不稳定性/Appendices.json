{
    "hands_on_practices": [
        {
            "introduction": "图灵模式的形成需要多种物质间的复杂相互作用。但一个根本性的问题是：单一物质自身能否通过反应和扩散形成稳定的空间图案？本练习将引导你通过线性稳定性分析，从根本上揭示为何单组分反应扩散系统无法满足图灵失稳的两个互斥条件，从而深刻理解为何激活-抑制等相互作用机制是自组织模式涌现的必要前提。",
            "id": "1697104",
            "problem": "在发育生物学中，反应-扩散系统被用来模拟空间模式的形成，例如斑马的条纹或豹的斑点。这种模式形成的一个基本要求，被称为 Turing 不稳定性，是指化学物质（形态发生素）的初始均匀浓度仅在存在扩散的情况下变得不稳定。\n\n考虑最简单的反应-扩散模型，该模型涉及单个形态发生素，其在位置 $x$ 和时间 $t$ 的浓度 $u(x,t)$ 由以下方程控制：\n$$\n\\frac{\\partial u}{\\partial t} = f(u) + D \\frac{\\partial^2 u}{\\partial x^2}\n$$\n此处，$f(u)$ 代表形态发生素的局域产生和降解动力学，$D$ 是其正扩散系数 ($D0$)。为简单起见，该系统在一维空间中进行考虑。\n\n当且仅当两个条件同时满足时，才会出现 Turing 图案：\n1.  **局域稳定性：** 在没有扩散（$D=0$）的情况下，一个空间均匀稳态 $u_0$（其中 $f(u_0) = 0$）必须是稳定的。这意味着对 $u_0$ 的小的、均匀的扰动必须随时间衰减。\n2.  **扩散驱动不稳定性：** 当存在扩散（$D0$）时，同一个稳定的均匀稳态对于小的、空间变化的扰动必须变得不稳定。这意味着某些空间模式会增长，而均匀状态会衰减。\n\n基于这些原则，以下哪个陈述正确描述了此单组分系统形成静态 Turing 图案的潜力？\n\nA. 如果稳态处的反应是局域不稳定的，即导数 $f'(u_0)$ 为正，则可以形成 Turing 图案。\nB. 如果系统足够大以支持长波扰动，则可以形成 Turing 图案。\nC. 此单组分系统不可能形成 Turing 图案，因为两个必要条件是相互排斥的。\nD. 如果扩散系数 $D$ 非常大，允许系统不同部分之间进行远程通信，则可以形成 Turing 图案。\nE. 可以形成 Turing 图案，但前提是反应动力学项 $f(u)$ 至少是 $u$ 的三次函数。",
            "solution": "我们考虑标量反应-扩散方程\n$$\n\\frac{\\partial u}{\\partial t} = f(u) + D \\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\n其中 $D0$。令 $u_{0}$ 为一个满足 $f(u_{0})=0$ 的空间均匀稳态。为了评估其稳定性，我们在 $u_{0}$ 附近进行线性化，即令 $u(x,t)=u_{0}+v(x,t)$，其中 $|v|\\ll 1$。将 $f(u_{0}+v)=f(u_{0})+f'(u_{0})v+\\mathcal{O}(v^{2})$ 展开并只保留线性项，得到线性化方程\n$$\n\\frac{\\partial v}{\\partial t} = f'(u_{0})\\,v + D \\frac{\\partial^{2} v}{\\partial x^{2}}.\n$$\n\n首先，在没有扩散（$D=0$）的情况下，演化方程简化为\n$$\n\\frac{\\partial v}{\\partial t} = f'(u_{0})\\,v,\n$$\n其解为 $v(t)=v(0)\\,\\exp\\!\\big(f'(u_{0})\\,t\\big)$。因此，当且仅当\n$$\nf'(u_{0})0\n$$\n时，均匀稳态是局域稳定的。\n\n接下来，在有扩散（$D>0$）的情况下，我们通过简正模来检验对空间变化扰动的稳定性。在一个支持拉普拉斯算子特征函数（例如，周期性或无通量边界）的区域上，考虑以下形式的模\n$$\nv(x,t)=\\hat{v}\\,\\exp\\!\\big(\\mathrm{i}k x + \\lambda t\\big),\n$$\n其中 $k$ 是与区域兼容的实波数，$\\lambda$ 是时间增长率。代入线性化方程并使用 $\\frac{\\partial^{2}}{\\partial x^{2}}\\exp(\\mathrm{i}k x)=-k^{2}\\exp(\\mathrm{i}k x)$，得到色散关系\n$$\n\\lambda(k)=f'(u_{0}) - D k^{2}.\n$$\n由此得出两个关键推论。首先，在所有 $k$ 上的最大增长率在 $k=0$ 处达到：\n$$\n\\max_{k}\\lambda(k)=\\lambda(0)=f'(u_{0}).\n$$\n其次，对于任何非零波数，扩散都严格减小增长率，因为 $-Dk^{2}\\leq 0$，且仅在 $k=0$ 时等号成立。\n\n因此：\n- 如果均匀稳态在没有扩散时是局域稳定的，即 $f'(u_0)  0$，那么对于所有的 $k$，都有\n$$\n\\lambda(k)=f'(u_{0})-Dk^{2}0,\n$$\n因此每个扰动都会衰减，不会出现不稳定性；扩散不能使该状态失稳。\n- 如果 $f'(u_{0})0$，那么 $k=0$（空间均匀）模具有最大的增长率且增长最快，这违反了无扩散时局域稳定性的要求，并且不会产生扩散驱动的（Turing）不稳定性。扩散不会创造一个在无扩散时稳定、有扩散时不稳定的非零 $k$ 模态带；它只会降低增长率。\n\n因此，在单组分反应-扩散系统中，两个 Turing 条件（无扩散时的局域稳定性和有扩散时某些空间模态的不稳定性）不能同时满足。这种不可能性与 $f(u)$ 的具体非线性形式或区域的大小无关；线性判据仅取决于 $f'(u_{0})$ 和扩散项 $-Dk^{2}$。\n\n评估各个陈述：\n- A 是错误的，因为 $f'(u_{0})0$ 与所要求的局域稳定性相矛盾，并且 $k=0$ 模主导了增长。\n- B 是错误的，因为当稳态是局域稳定时，没有任何系统尺寸的选择可以推翻 $\\lambda(k)\\leq f'(u_0)  0$。\n- C 是正确的：对于单个形态发生素，这两个条件是相互排斥的；Turing 不稳定性至少需要两种相互作用的物质。\n- D 是错误的，因为增加 $D$ 会使 $k\\neq 0$ 时的 $\\lambda(k)$ 更负，从而增强稳定性。\n- E 是错误的，因为线性稳定性完全由 $f'(u_{0})$ 决定；高阶非线性项在单物种情况下不会产生扩散驱动的线性不稳定性。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "既然单组分系统无法形成图灵斑图，我们自然转向多组分系统。对于一个经典的双组分“激活-抑制”模型，其能否产生图案，取决于反应动力学和扩散速率之间的精妙平衡。本练习将让你扮演合成生物学家的角色，利用线性稳定性分析，为一个给定的反应动力学系统推导出现图灵失稳所需的扩散系数比值的临界条件，这是设计和预测图案形成基因回路的核心分析技能。",
            "id": "3925833",
            "problem": "一个工程化的双基因激活-抑制回路被实现在一个汇合的单层细胞中。激活物浓度 $u$ 和抑制物浓度 $v$ 的细胞内反应动力学由光滑函数 $f(u,v)$ 和 $g(u,v)$ 建模，而细胞间运输主要由扩散主导。在一个空间均匀稳态 $(u^{\\ast},v^{\\ast})$ 附近，小扰动遵循由偏微分方程（PDEs）给出的线性化反应-扩散描述：\n$$\n\\frac{\\partial}{\\partial t}\\begin{pmatrix}\\delta u \\\\\\delta v\\end{pmatrix}\n= J \\begin{pmatrix}\\delta u \\\\\\delta v\\end{pmatrix}\n+ \\begin{pmatrix}D_{u}  0\\\\ 0  D_{v}\\end{pmatrix} \\nabla^{2}\\begin{pmatrix}\\delta u \\\\\\delta v\\end{pmatrix},\n$$\n其中 $J$ 是 $(f,g)$ 在 $(u^{\\ast},v^{\\ast})$ 处求值的雅可比矩阵，其元素为 $J=\\begin{pmatrix}a  b\\\\ c  d\\end{pmatrix}$，且 $D_{u}0$，$D_{v}0$ 是扩散系数。\n\n在 $(u^{\\ast},v^{\\ast})$ 附近的实验性扰动-响应测量得到了雅可比矩阵元素的以下估计值（单位为一致的逆时间）：$a=1$，$b=-3$，$c=1$，$d=-2$。\n\n假设充分混合（无扩散）不动点是线性稳定的。仅使用反应-扩散系统的线性稳定性分析的第一性原理（线性化偏微分方程的傅里叶模态分解，以及增长率与依赖于模态的系统矩阵特征值之间的关系），确定所需的最小扩散系数比 $D_{v}/D_{u}$，使得存在一个非空的空间波数带，在此波数带内扰动具有正的时间增长率（即，存在一个扩散驱动的不稳定带）。\n\n将扩散系数比报告为精确的简化表达式。如果必须近似，则四舍五入到四位有效数字。将最终比率表示为无单位的纯数。",
            "solution": "扩散驱动不稳定性（也称为图灵不稳定性）的分析，是通过检查系统对空间扰动的稳定性来进行的。我们考虑扰动 $(\\delta u, \\delta v)$ 的单一傅里叶模态，其形式为：\n$$\n\\begin{pmatrix}\\delta u(\\mathbf{x}, t) \\\\\\delta v(\\mathbf{x}, t)\\end{pmatrix} = \\begin{pmatrix}\\tilde{u} \\\\\\tilde{v}\\end{pmatrix} \\exp(i\\mathbf{k} \\cdot \\mathbf{x} + \\lambda t)\n$$\n其中 $\\mathbf{k}$ 是空间波矢，$t$ 是时间，$\\begin{pmatrix}\\tilde{u} \\\\\\tilde{v}\\end{pmatrix}$ 是该模态的恒定振幅向量，而 $\\lambda$ 是时间增长率。拉普拉斯算子作用于此空间模态，得到 $\\nabla^2 \\exp(i\\mathbf{k} \\cdot \\mathbf{x}) = -|\\mathbf{k}|^2 \\exp(i\\mathbf{k} \\cdot \\mathbf{x}) = -k^2 \\exp(i\\mathbf{k} \\cdot \\mathbf{x})$，其中 $k = |\\mathbf{k}|$ 是空间波数。\n\n将此形式代入控制偏微分方程组，得到关于增长率 $\\lambda$ 的代数特征值问题：\n$$\n\\lambda \\begin{pmatrix}\\tilde{u} \\\\\\tilde{v}\\end{pmatrix} = J \\begin{pmatrix}\\tilde{u} \\\\\\tilde{v}\\end{pmatrix} - k^2 \\begin{pmatrix}D_{u}  0\\\\ 0  D_{v}\\end{pmatrix} \\begin{pmatrix}\\tilde{u} \\\\\\tilde{v}\\end{pmatrix}\n$$\n这可以写成：\n$$\n\\left( J - k^2 D - \\lambda I \\right) \\begin{pmatrix}\\tilde{u} \\\\\\tilde{v}\\end{pmatrix} = \\begin{pmatrix}0 \\\\0\\end{pmatrix}\n$$\n其中 $D = \\begin{pmatrix}D_{u}  0\\\\ 0  D_{v}\\end{pmatrix}$ 且 $I$ 是单位矩阵。为使非平凡解存在，该矩阵的行列式必须为零。我们定义给定波数 $k$ 的稳定性矩阵为 $M(k^2) = J - k^2 D$。\n$$\nM(k^2) = \\begin{pmatrix}a - k^2 D_u  b\\\\ c  d - k^2 D_v\\end{pmatrix}\n$$\n特征值 $\\lambda(k^2)$ 是特征方程 $\\det(M(k^2) - \\lambda I) = 0$ 的根，即：\n$$\n\\lambda^2 - \\text{tr}(M(k^2)) \\lambda + \\det(M(k^2)) = 0\n$$\n\n图灵不稳定性需要两个条件：\n1.  在没有扩散的情况下（当 $k=0$ 时），空间均匀稳态必须是稳定的。\n2.  对于一定范围的非零波数（$k^2  0$），扩散必须使系统不稳定。\n\n**条件1：均匀态的稳定性 ($k=0$)**\n对于 $k=0$，稳定性矩阵就是雅可比矩阵 $J$。如果 $J$ 的所有特征值都具有负实部，则系统是稳定的。对于一个 $2 \\times 2$ 系统，这要求 $\\text{tr}(J)  0$ 和 $\\det(J)  0$。\n给定的雅可比矩阵元素为 $a=1$，$b=-3$，$c=1$，$d=-2$。我们来验证这些条件：\n$$\n\\text{tr}(J) = a+d = 1 + (-2) = -1\n$$\n由于 $\\text{tr}(J) = -1  0$，第一个稳定性条件得到满足。\n$$\n\\det(J) = ad-bc = (1)(-2) - (-3)(1) = -2 + 3 = 1\n$$\n由于 $\\det(J) = 1  0$，第二个稳定性条件也得到满足。因此，问题陈述中关于充分混合不动点是线性稳定的说法与所提供的数据是一致的。\n\n**条件2：扩散驱动的不稳定性 ($k^2  0$)**\n为使系统对某些 $k^2  0$ 不稳定，至少一个特征值 $\\lambda(k^2)$ 必须有正实部，即 $\\text{Re}(\\lambda(k^2))  0$。特征值由二次求根公式给出：\n$$\n\\lambda_{\\pm}(k^2) = \\frac{\\text{tr}(M(k^2)) \\pm \\sqrt{\\text{tr}(M(k^2))^2 - 4\\det(M(k^2))}}{2}\n$$\n我们来分析 $M(k^2)$ 的迹：\n$$\n\\text{tr}(M(k^2)) = (a - k^2 D_u) + (d - k^2 D_v) = (a+d) - k^2(D_u + D_v) = \\text{tr}(J) - k^2(D_u + D_v)\n$$\n由于 $\\text{tr}(J) = -1  0$，且 $D_u, D_v, k^2$ 均为正，因此对于任何 $k^2 \\ge 0$，$\\text{tr}(M(k^2))$ 总是负的。\n如果特征值是复共轭的，它们的实部是 $\\frac{1}{2}\\text{tr}(M(k^2))$，这也是恒为负的。因此，不稳定性不可能由复特征值引起（即，螺旋模态不能增长）。\n只有当特征值为实数且至少一个为正时，才可能发生不稳定性。由于它们的和 $\\lambda_+ + \\lambda_- = \\text{tr}(M(k^2))$ 是负的，如果一个特征值为正，则另一个必须为负。这意味着它们的乘积必须为负。特征值的乘积是行列式：\n$$\n\\lambda_+ \\lambda_- = \\det(M(k^2))\n$$\n因此，不稳定的条件是对于某个 $k^2  0$ 的范围，有 $\\det(M(k^2))  0$。\n\n我们来计算 $M(k^2)$ 的行列式：\n$$\n\\det(M(k^2)) = (a - k^2 D_u)(d - k^2 D_v) - bc\n$$\n$$\n\\det(M(k^2)) = ad - k^2(aD_v + dD_u) + k^4 D_u D_v - bc\n$$\n$$\n\\det(M(k^2)) = (ad-bc) - (aD_v + dD_u)k^2 + (D_u D_v)k^4\n$$\n令 $K = k^2$。该行列式是 $K$ 的一个二次函数：\n$$\nP(K) = (D_u D_v)K^2 - (aD_v + dD_u)K + \\det(J)\n$$\n我们需要找到使 $P(K)  0$ 对某些 $K  0$ 成立的条件。$P(K)$ 是一个关于 $K$ 的开口向上的抛物线。在 $K=0$ 处，$P(0)=\\det(J)=1  0$。为了让该抛物线在 $K0$ 时降到水平轴以下，它必须在某个 $K_{min}  0$ 处有一个最小值，并且在该最小值处的值 $P(K_{min})$ 必须为负。\n\n抛物线的顶点（最小值）出现在：\n$$\nK_{min} = \\frac{aD_v + dD_u}{2D_uD_v}\n$$\n为了使 $K_{min}  0$，我们要求分子为正：\n$$\naD_v + dD_u  0\n$$\n如果二次方程 $P(K)=0$ 有两个不同的实根，则抛物线在其最小值处的值为负。其条件是二次函数 $P(K)$ 的判别式为正：\n$$\n\\Delta_K = (aD_v + dD_u)^2 - 4(D_u D_v)\\det(J)  0\n$$\n现在我们引入比率 $\\mathcal{R} = D_v/D_u$ 并应用推导出的两个条件。\n\n1.  从 $aD_v + dD_u  0$，我们代入 $a=1, d=-2$：\n    $1 \\cdot D_v - 2 \\cdot D_u  0 \\implies D_v  2 D_u \\implies \\frac{D_v}{D_u}  2$。\n    所以，$\\mathcal{R}  2$。\n\n2.  从 $(aD_v + dD_u)^2 - 4D_uD_v\\det(J)  0$，我们代入已知值：\n    $(1 \\cdot D_v - 2 \\cdot D_u)^2 - 4D_uD_v(1)  0$\n    将不等式两边同除以 $D_u^2  0$：\n    $$\n    \\left(\\frac{D_v}{D_u} - 2\\right)^2 - 4\\frac{D_v}{D_u}  0\n    $$\n    代入 $\\mathcal{R} = D_v/D_u$：\n    $$\n    (\\mathcal{R}-2)^2 - 4\\mathcal{R}  0\n    $$\n    $$\n    \\mathcal{R}^2 - 4\\mathcal{R} + 4 - 4\\mathcal{R}  0\n    $$\n    $$\n    \\mathcal{R}^2 - 8\\mathcal{R} + 4  0\n    $$\n    为了解这个二次不等式，我们使用二次求根公式找到对应方程 $\\mathcal{R}^2 - 8\\mathcal{R} + 4 = 0$ 的根：\n    $$\n    \\mathcal{R} = \\frac{-(-8) \\pm \\sqrt{(-8)^2 - 4(1)(4)}}{2(1)} = \\frac{8 \\pm \\sqrt{64 - 16}}{2} = \\frac{8 \\pm \\sqrt{48}}{2}\n    $$\n    简化 $\\sqrt{48} = \\sqrt{16 \\times 3} = 4\\sqrt{3}$：\n    $$\n    \\mathcal{R} = \\frac{8 \\pm 4\\sqrt{3}}{2} = 4 \\pm 2\\sqrt{3}\n    $$\n    抛物线 $\\mathcal{R}^2 - 8\\mathcal{R} + 4$ 开口向上，因此当 $\\mathcal{R}$ 在根之外时，不等式成立：\n    $$\n    \\mathcal{R}  4 - 2\\sqrt{3} \\quad \\text{或} \\quad \\mathcal{R}  4 + 2\\sqrt{3}\n    $$\n    为了得到最终条件，我们必须同时满足两个推导出的约束。我们需要 $\\mathcal{R}  2$ 并且（$\\mathcal{R}  4 - 2\\sqrt{3}$ 或 $\\mathcal{R}  4 + 2\\sqrt{3}$）。\n    我们来近似计算根的值：\n    $\\sqrt{3} \\approx 1.732$\n    $4 - 2\\sqrt{3} \\approx 4 - 2(1.732) = 4 - 3.464 = 0.536$\n    $4 + 2\\sqrt{3} \\approx 4 + 3.464 = 7.464$\n    条件 $\\mathcal{R}  2$ 与 $\\mathcal{R}  4 - 2\\sqrt{3} \\approx 0.536$ 不相容。\n    条件 $\\mathcal{R}  2$ 与 $\\mathcal{R}  4 + 2\\sqrt{3} \\approx 7.464$ 相容。这两个条件的交集就是：\n    $$\n    \\mathcal{R}  4 + 2\\sqrt{3}\n    $$\n    这个不等式定义了可以发生扩散驱动不稳定性的扩散系数比 $D_v/D_u$ 的范围。问题要求存在这样一个不稳定带所需的最小比率。这对应于允许比率集合的下确界，即边界值。\n\n因此，所需的最小比率是 $4+2\\sqrt{3}$。",
            "answer": "$$\n\\boxed{4+2\\sqrt{3}}\n$$"
        },
        {
            "introduction": "理论分析为我们指明了图灵模式形成的条件，但亲眼见证图案从随机噪声中“生长”出来，能带来更深刻的直观理解。这个计算实践任务将引导你使用数值方法模拟一个著名的反应扩散模型（Schnakenberg模型），并实现一套自动化流程来“识别”生成的图案。你不仅将生成斑点或条纹等复杂图案，还将学习如何运用傅里叶变换和空间自相关等图像处理技术来量化分析这些图案的特征，从而连接数学模型与可观测的实验结果。",
            "id": "3925879",
            "problem": "考虑一个在边长为 $L$ 且具有周期性边界条件的二维方形域上的激活子-抑制子基因回路的双物种反应扩散模型。令 $u(x,y,t)$ 表示激活子，$v(x,y,t)$ 表示抑制子。假设全文使用无量纲变量和参数。控制方程为\n$$\n\\frac{\\partial u}{\\partial t} = D_u \\nabla^2 u + f(u,v), \\quad \\frac{\\partial v}{\\partial t} = D_v \\nabla^2 v + g(u,v),\n$$\n其中 $D_u$ 和 $D_v$ 是扩散系数，局部反应动力学遵循 Schnakenberg 模型，\n$$\nf(u,v) = a - u + u^2 v, \\quad g(u,v) = b - u^2 v,\n$$\n其中参数 $a0$ 和 $b0$。该动力学的均匀稳态 $(u^*, v^*)$ 满足\n$$\nu^* = a + b, \\quad v^* = \\frac{b}{(a+b)^2}.\n$$\n图灵不稳定性以扩散驱动的图样形成为特征：均匀稳态在局部反应下是稳定的，但在存在扩散的情况下，对于一段非零空间波数的频带会变得不稳定。为了算法化地绘制出产生自组织空间图样的参数区域，您必须实现一次参数扫描，并使用两种图像处理度量来自动检测图样：功率谱峰和空间自相关。\n\n仿真和检测规范：\n\n- 域和离散化：使用一个边长为 $L=10$ 的方形域，在 $N=64$ 的 $N \\times N$ 均匀网格上进行离散化。令空间网格间距为 $dx = L/N$。使用周期性边界条件和 $dt = 0.2$ 的前向时间步长，积分 $n_{\\mathrm{steps}} = 800$ 步，总仿真时间为 $T = dt \\cdot n_{\\mathrm{steps}} = 160$。通过对均匀稳态 $(u^*, v^*)$ 添加振幅为 $10^{-3}$ 的小量零均值随机噪声来初始化 $t=0$ 时的 $u$ 和 $v$。\n\n- 离散拉普拉斯算子：在周期性边界条件下，使用二阶有限差分模板实现离散拉普拉斯算子 $\\nabla^2$。网格点 $(i,j)$ 处的拉普拉斯算子应使用其在网格上的四个最近邻点来计算。\n\n- 功率谱峰度量：使用快速傅里叶变换 (FFT) 计算最终场 $u(x,y,T)$ 的二维离散傅里叶变换 (DFT)。将其功率谱 $P(k_x,k_y)$ 计算为复数 DFT 幅度的平方。在波数空间中对 $P$ 沿圆形壳层进行径向平均，以获得作为标量波数 $k = \\sqrt{k_x^2 + k_y^2}$ 的函数 $S(k)$。将峰值显著性度量定义为\n$$\nM_{\\mathrm{peak}} = \\frac{\\max_{k0} S(k)}{\\mathrm{median}\\{S(k): k0\\}},\n$$\n即，最大非零波数径向谱值与所有非零波数谱值的中位数之比。使用检测阈值 $\\tau_{\\mathrm{peak}} = 4.0$。\n\n- 空间自相关度量：通过对零均值场的功率谱进行逆 FFT，利用 Wiener–Khinchin 定理计算 $u(x,y,T)$ 的空间自相关函数 $C(\\Delta x, \\Delta y)$。对自相关函数进行径向平均，以获得作为空间延迟 $r = \\sqrt{\\Delta x^2 + \\Delta y^2}$ 的函数 $C(r)$。令 $C(0)$ 表示零延迟自相关。将自相关峰比度量定义为\n$$\nM_{\\mathrm{ac}} = \\frac{\\max_{r0} C(r)}{C(0)},\n$$\n并使用检测阈值 $\\tau_{\\mathrm{ac}} = 0.1$。\n\n分类规则：\n\n- 当且仅当 $M_{\\mathrm{peak}}  \\tau_{\\mathrm{peak}}$ 和 $M_{\\mathrm{ac}}  \\tau_{\\mathrm{ac}}$ 同时满足时，一个参数集被分类为“形成图样”。\n\n测试组：\n\n为以下每个参数集（表示为 $(a,b,D_u,D_v)$）仿真该系统：\n\n1. $(0.2, 1.3, 10^{-4}, 10^{-2})$\n2. $(0.2, 1.3, 10^{-4}, 3 \\times 10^{-3})$\n3. $(0.2, 1.3, 10^{-2}, 10^{-2})$\n4. $(1.0, 1.0, 10^{-4}, 10^{-2})$\n5. $(0.1, 0.9, 10^{-4}, 5 \\times 10^{-3})$\n\n输出规范：\n\n- 对于每个测试用例，输出一个布尔值，指示是否根据上述分类规则检测到图样。最终程序输出必须是单行文本，即一个用方括号括起来的、由逗号分隔的布尔值列表，例如，“[True,False,True,False,True]”。所有量都是无量纲的，因此输出中不需要物理单位。",
            "solution": "### 解决方案设计\n\n该解决方案以算法方式实现指定的 Schnakenberg 反应扩散系统的仿真和分析。\n\n**1. 数值仿真**\n该偏微分方程组在二维网格上进行数值求解。\n- **域和状态：** 边长为 $L=10$ 的空间域被离散化为一个 $N \\times N$ 的网格，其中 $N=64$。激活子和抑制子的浓度 $u(x,y,t)$ 和 $v(x,y,t)$ 由两个 $N \\times N$ 的矩阵表示。\n- **初始化：** 对于每个参数集 $(a, b, D_u, D_v)$，计算稳态浓度 $(u^*, v^*)$。用于 $u$ 和 $v$ 的仿真矩阵被初始化为这些稳态值，并用小振幅 ($10^{-3}$) 的零均值随机噪声进行扰动。\n- **时间积分：** 系统使用前向欧拉法，以时间步长 $dt=0.2$ 演化 $n_{\\mathrm{steps}}=800$ 步。对于每一步：\n  - **扩散项：** 使用二阶五点有限差分模板计算 $u$ 和 $v$ 场的拉普拉斯算子 $\\nabla^2$。周期性通过使用循环数组移位来高效处理。网格点 $(i,j)$ 处的离散拉普拉斯算子由下式给出：\n    $$ \\nabla^2 \\phi_{i,j} \\approx \\frac{\\phi_{i+1,j} + \\phi_{i-1,j} + \\phi_{i,j+1} + \\phi_{i,j-1} - 4\\phi_{i,j}}{dx^2} $$\n  - **反应项：** 对当前的 $u$ 和 $v$ 矩阵逐元素计算 Schnakenberg 动力学 $f(u,v) = a - u + u^2 v$ 和 $g(u,v) = b - u^2 v$。\n  - **更新：** 根据前向欧拉公式更新 $u$ 和 $v$ 场：\n    $$ u_{t+dt} = u_t + dt \\left( D_u \\nabla^2 u_t + f(u_t, v_t) \\right) $$\n    $$ v_{t+dt} = v_t + dt \\left( D_v \\nabla^2 v_t + g(u_t, v_t) \\right) $$\n\n**2. 图样检测分析**\n在仿真于时间 $T=160$ 结束后，使用两种度量对最终的激活子场 $u(x,y,T)$ 进行分析。\n\n- **$M_{\\mathrm{peak}}$ (功率谱峰):** 该度量量化了特征波长的显著性。\n  1. 使用快速傅里叶变换 (FFT) 算法计算最终 $u$ 场的二维离散傅里叶变换 (DFT)。\n  2. 功率谱计算为 DFT 的幅度平方：$P(k_x, k_y) = |\\mathrm{DFT}(u)(k_x, k_y)|^2$。\n  3. 将二维功率谱进行径向平均，生成一维谱 $S(k)$，其中 $k = \\sqrt{k_x^2 + k_y^2}$ 是标量波数。这是通过根据对应的 $k$ 对 $P(k_x, k_y)$ 的值进行分箱并在每个箱内求平均来实现的。直流分量 ($k=0$) 在此过程中被排除。\n  4. 度量 $M_{\\mathrm{peak}}$ 计算为分箱谱 $S(k)$ 的最大值与其所有值的中位数之比。高比率表示存在一个与主导空间频率相对应的强峰。\n\n- **$M_{\\mathrm{ac}}$ (空间自相关):** 该度量测量图样的空间周期性。\n  1. 使用 Wiener–Khinchin 定理计算空间自相关函数 $C(\\Delta x, \\Delta y)$。计算零均值激活子场 $u' = u - \\langle u \\rangle$ 的功率谱，其逆 FFT 产生自相关函数。\n  2. 将二维自相关函数进行径向平均，生成一维函数 $C(r)$，其中 $r = \\sqrt{\\Delta x^2 + \\Delta y^2}$ 是空间延迟。此分箱过程类似于用于功率谱的过程。\n  3. 度量 $M_{\\mathrm{ac}}$ 是非零延迟的径向平均自相关的最大值 $\\max_{r0} C(r)$ 与零延迟自相关 $C(0)$ 的比值。高比率表明该场在一个特征距离上强相关，这是图样的一个标志。\n\n**3. 分类**\n对于每个测试的参数集，将计算出的度量 $M_{\\mathrm{peak}}$ 和 $M_{\\mathrm{ac}}$ 与它们各自的阈值 $\\tau_{\\mathrm{peak}} = 4.0$ 和 $\\tau_{\\mathrm{ac}} = 0.1$ 进行比较。当且仅当两个条件 $M_{\\mathrm{peak}} > \\tau_{\\mathrm{peak}}$ 和 $M_{\\mathrm{ac}} > \\tau_{\\mathrm{ac}}$ 都满足时，才赋予“形成图样”(True) 的分类。否则，分类为“未形成图样”(False)。\n\n以下是实现此过程的 Python 代码：\n\n```python\nimport numpy as np\nfrom scipy.stats import binned_statistic\n\ndef run_simulation(a, b, Du, Dv, L, N, dt, n_steps, noise_amp):\n    \"\"\"\n    Simulates the Schnakenberg reaction-diffusion system.\n    \"\"\"\n    dx = L / N\n    dx2 = dx**2\n\n    # Steady state\n    u_star = a + b\n    # Ensure denominator is not zero\n    if u_star == 0:\n        # This case is not expected with a0, b0, but handle robustly.\n        v_star = 0.0\n    else:\n        v_star = b / (u_star**2)\n\n    # Initialization with random noise\n    # Use a fixed seed for reproducibility of the random noise.\n    np.random.seed(42)\n    u = u_star + noise_amp * (2 * np.random.rand(N, N) - 1)\n    v = v_star + noise_amp * (2 * np.random.rand(N, N) - 1)\n\n    # Time integration loop (Forward Euler)\n    for _ in range(n_steps):\n        # Laplacian operator with periodic boundary conditions\n        lap_u = (np.roll(u, 1, axis=0) + np.roll(u, -1, axis=0) +\n                 np.roll(u, 1, axis=1) + np.roll(u, -1, axis=1) - 4 * u) / dx2\n        lap_v = (np.roll(v, 1, axis=0) + np.roll(v, -1, axis=0) +\n                 np.roll(v, 1, axis=1) + np.roll(v, -1, axis=1) - 4 * v) / dx2\n\n        # Reaction terms\n        u2v = u**2 * v\n        f = a - u + u2v\n        g = b - u2v\n\n        # Update fields\n        u += dt * (Du * lap_u + f)\n        v += dt * (Dv * lap_v + g)\n        \n    return u\n\ndef calculate_m_peak(u, L, N):\n    \"\"\"\n    Calculates the power spectrum peak metric M_peak.\n    \"\"\"\n    dx = L / N\n    \n    # Power spectrum via FFT\n    power_spectrum = np.abs(np.fft.fft2(u))**2\n\n    # Wavenumber grid\n    kx = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n    ky = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n    Kx, Ky = np.meshgrid(kx, ky)\n    K_mag = np.sqrt(Kx**2 + Ky**2)\n\n    # Isolate non-zero wavenumber components\n    k_gt_0_mask = K_mag > 0\n    k_values_flat = K_mag[k_gt_0_mask]\n    power_values_flat = power_spectrum[k_gt_0_mask]\n\n    if k_values_flat.size == 0:\n        return 0.0\n\n    # Radially average the spectrum S(k) using binning\n    nbins = N // 2\n    s_k, _, _ = binned_statistic(k_values_flat, power_values_flat, statistic='mean', bins=nbins)\n\n    # Filter out NaNs from empty bins\n    s_k_valid = s_k[~np.isnan(s_k)]\n\n    if s_k_valid.size == 0:\n        return 0.0\n\n    max_s = np.max(s_k_valid)\n    median_s = np.median(s_k_valid)\n\n    if median_s == 0:\n        return np.inf\n\n    m_peak = max_s / median_s\n    return m_peak\n\ndef calculate_m_ac(u, L, N):\n    \"\"\"\n    Calculates the spatial autocorrelation metric M_ac.\n    \"\"\"\n    dx = L / N\n\n    # Autocorrelation via Wiener-Khinchin theorem on zero-mean field\n    u_zm = u - np.mean(u)\n    power_spectrum_zm = np.abs(np.fft.fft2(u_zm))**2\n    autocorr_raw = np.fft.ifft2(power_spectrum_zm)\n    autocorr = np.fft.fftshift(autocorr_raw.real)\n    \n    # Zero-lag autocorrelation C(0)\n    c0 = autocorr[N // 2, N // 2]\n    if c0 == 0:\n        return 0.0\n\n    # Spatial lag grid\n    lag_coords = dx * np.arange(-N // 2, N // 2)\n    Dx, Dy = np.meshgrid(lag_coords, lag_coords)\n    R_lag = np.sqrt(Dx**2 + Dy**2)\n\n    # Isolate non-zero lag components\n    r_gt_0_mask = R_lag > 0\n    r_values_flat = R_lag[r_gt_0_mask]\n    autocorr_values_flat = autocorr[r_gt_0_mask]\n    \n    if r_values_flat.size == 0:\n        return 0.0\n\n    # Radially average the autocorrelation C(r)\n    nbins = N // 2\n    c_r, _, _ = binned_statistic(r_values_flat, autocorr_values_flat, statistic='mean', bins=nbins)\n    \n    c_r_valid = c_r[~np.isnan(c_r)]\n\n    if c_r_valid.size == 0:\n        return 0.0\n    \n    max_c_r_positive = np.max(c_r_valid)\n    \n    m_ac = max_c_r_positive / c0\n    return m_ac\n\n# This part is for demonstration and would be executed to get the answer.\n# def solve():\n#     \"\"\"\n#     Main function to run the test suite and classify patterns.\n#     \"\"\"\n#     # ... (code as provided)\n# if __name__ == '__main__':\n#     solve()\n```",
            "answer": "[True,True,False,False,True]"
        }
    ]
}