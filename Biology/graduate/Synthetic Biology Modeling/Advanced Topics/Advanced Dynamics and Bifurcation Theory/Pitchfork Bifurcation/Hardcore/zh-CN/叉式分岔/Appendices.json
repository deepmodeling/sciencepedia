{
    "hands_on_practices": [
        {
            "introduction": "本练习将我们的理解建立在动力系统的基本原理之上。通过计算叉式分岔的典范范式模型的平衡点的稳定性()，你将直接应用雅可比矩阵和特征值的概念来确定系统如何响应微小扰动，从而区分稳定与不稳定状态。",
            "id": "3919636",
            "problem": "考虑一个均匀组织中双稳态细胞命运决定的最小对称破缺模型，其中标量状态变量 $x$ 表示谱系特异性转录因子活性相对于对称点的一个无量纲、有符号的偏差。在对称点附近，描述在控制参数 $\\mu$（与一个无量纲的形态发生素驱动成正比）作用下双稳态出现的最低阶范式是一维常微分方程（ODE）\n$$\n\\frac{dx}{dt} = f(x) = \\mu x - x^{3},\n$$\n其中 $\\mu$ 是实数。该模型在生物医学系统建模中被广泛用于表示由对称基因调控相互作用产生的超临界干草叉分岔的局部范式。\n\n假设 $\\mu > 0$。仅使用一维动力系统中平衡点和线性稳定性的基本定义，从第一性原理出发：\n- 识别平衡点 $x^{\\ast}$，\n- 计算在每个平衡点处求值的雅可比行列式（$f$ 关于 $x$ 的导数），以及\n- 从雅可比行列式的符号推断每个平衡点的线性稳定性。\n\n将你的最终答案表示为一个单行矩阵，其中包含在平衡点序列 $x^{\\ast} = 0$, $x^{\\ast} = +\\sqrt{\\mu}$, $x^{\\ast} = -\\sqrt{\\mu}$ 处的雅可比行列式 $f'(x^{\\ast})$ 的值。不需要数值近似；请提供精确的符号表达式。最终答案中不包含任何单位。",
            "solution": "该问题要求在参数 $\\mu > 0$ 的条件下，对给定的一维常微分方程（ODE）$\\frac{dx}{dt} = f(x) = \\mu x - x^{3}$ 的平衡点进行识别和线性稳定性分析。\n\n首先，我们识别平衡点，记为 $x^{\\ast}$。根据定义，动力系统的平衡点是系统变量不随时间变化的状态。对于给定的 ODE，这对应于条件 $\\frac{dx}{dt} = 0$。因此，我们必须找到方程 $f(x^{\\ast}) = 0$ 的根。\n$$\n\\mu x^{\\ast} - (x^{\\ast})^{3} = 0\n$$\n为了求解 $x^{\\ast}$，我们可以对左侧的表达式进行因式分解：\n$$\nx^{\\ast}(\\mu - (x^{\\ast})^{2}) = 0\n$$\n考虑到问题中 $\\mu > 0$ 的约束条件，该方程提供了三个不同的实数解。\n$1$. 通过将第一个因子设为零，可以找到平凡平衡点：$x^{\\ast}_1 = 0$。\n$2$. 通过将第二个因子设为零，可以找到非平凡平衡点：$\\mu - (x^{\\ast})^{2} = 0$。这意味着 $(x^{\\ast})^{2} = \\mu$。由于问题指定 $\\mu > 0$，我们可以取平方根得到两个不同的实数根：$x^{\\ast}_2 = +\\sqrt{\\mu}$ 和 $x^{\\ast}_3 = -\\sqrt{\\mu}$。\n\n因此，系统的三个平衡点是 $x^{\\ast} = 0$，$x^{\\ast} = +\\sqrt{\\mu}$ 和 $x^{\\ast} = -\\sqrt{\\mu}$。\n\n接下来，我们对每个平衡点进行线性稳定性分析。在一维系统中，平衡点 $x^{\\ast}$ 的稳定性由在该点求值的雅可比行列式的符号决定。对于函数 $f(x)$，雅可比行列式是它的一阶导数，$f'(x) = \\frac{df}{dx}$。稳定性判据如下：\n- 如果 $f'(x^{\\ast})  0$，平衡点是线性稳定的。对平衡点的小扰动将随时间衰减。\n- 如果 $f'(x^{\\ast}) > 0$，平衡点是线性不稳定的。小扰动将随时间增长，导致系统偏离平衡点。\n- 如果 $f'(x^{\\ast}) = 0$，平衡点被称为非双曲的，其稳定性不能仅通过线性分析确定。\n\n我们首先通过对 $f(x) = \\mu x - x^{3}$ 关于 $x$ 求导来计算雅可比行列式的一般表达式：\n$$\nf'(x) = \\frac{d}{dx}(\\mu x - x^{3}) = \\mu - 3x^{2}\n$$\n现在，我们在三个已识别的平衡点处分别计算该雅可比行列式的值。\n\n情况 1：平衡点 $x^{\\ast} = 0$。\n雅可比行列式的值是：\n$$\nf'(0) = \\mu - 3(0)^{2} = \\mu\n$$\n在 $\\mu > 0$ 的条件下，雅可比行列式 $f'(0)$ 是正的。这表明 $x^{\\ast} = 0$ 处的平衡点是线性不稳定的。\n\n情况 2：平衡点 $x^{\\ast} = +\\sqrt{\\mu}$。\n雅可比行列式的值是：\n$$\nf'(+\\sqrt{\\mu}) = \\mu - 3(+\\sqrt{\\mu})^{2} = \\mu - 3\\mu = -2\\mu\n$$\n由于 $\\mu > 0$，项 $-2\\mu$ 是负的。因此，$f'(+\\sqrt{\\mu})  0$，这表明 $x^{\\ast} = +\\sqrt{\\mu}$ 处的平衡点是线性稳定的。\n\n情况 3：平衡点 $x^{\\ast} = -\\sqrt{\\mu}$。\n雅可比行列式的值是：\n$$\nf'(-\\sqrt{\\mu}) = \\mu - 3(-\\sqrt{\\mu})^{2} = \\mu - 3\\mu = -2\\mu\n$$\n与前一种情况一样，由于 $\\mu > 0$，雅可比行列式 $f'(-\\sqrt{\\mu})$ 是负的。这表明 $x^{\\ast} = -\\sqrt{\\mu}$ 处的平衡点也是线性稳定的。\n\n问题要求最终答案为一个单行矩阵，其中包含在平衡点序列 $x^{\\ast} = 0$，$x^{\\ast} = +\\sqrt{\\mu}$ 和 $x^{\\ast} = -\\sqrt{\\mu}$ 处求值的雅可比行列式 $f'(x^{\\ast})$ 的值。这些值分别为 $\\mu$、$-2\\mu$ 和 $-2\\mu$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\mu  -2\\mu  -2\\mu \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "由于分子涨落，真实的生物系统永远不是完全确定的。本练习()通过引入随机噪声来扩展确定性模型，将系统转化为一个双势阱问题。你将使用克莱默斯近似理论（Kramers’ approximation theory）来估计系统随机地从一个稳定状态“跳跃”到另一个稳定状态所需的平均时间，这是理解细胞决策和记忆的关键概念。",
            "id": "3919650",
            "problem": "在一个具有正反馈的双稳态基因调控回路中，超临界叉式分岔点附近一个无量纲基因表达水平 $x(t)$ 的确定性动力学可以用常微分方程 $x'=\\mu x - x^{3}$ 来建模，其中 $\\mu$ 是一个与净反馈强度成正比的无量纲分岔参数。分子数量的波动会引入随机性，从而产生过阻尼朗之万动力学\n$$\nx'=\\mu x - x^{3} + \\sqrt{2D}\\,\\xi(t),\n$$\n其中 $\\xi(t)$ 是高斯白噪声，满足 $\\langle \\xi(t) \\rangle = 0$ 和 $\\langle \\xi(t)\\xi(s)\\rangle=\\delta(t-s)$, 且 $D>0$ 是一个由底层反应网络中的生灭过程决定的无量纲有效噪声强度。假设 $\\mu>0$，因此确定性系统有两个稳定的基因表达状态，它们被一个不稳定的状态隔开。\n\n从一维过阻尼随机微分方程 (SDE) 的基本梯度流表示 $x'=-U'(x)+\\sqrt{2D}\\,\\xi(t)$ 出发，其中 $U(x)$ 是一个标量势，推导与漂移项 $\\mu x - x^{3}$ 相关的有效势 $U(x)$。当 $\\mu>0$ 时，找出稳定阱和势垒（鞍点）的位置，并确定稳定阱和势垒之间的高度差。使用经典的 Kramers 近似来处理过阻尼区域中越过势垒的逃逸问题，计算从右阱（$x\\approx +\\sqrt{\\mu}$ 附近）到左阱（$x\\approx -\\sqrt{\\mu}$ 附近）的跃迁的平均首达时间 (MFPT)。用 $\\mu$ 和 $D$ 将最终的 MFPT 表示为一个闭式解析表达式，使用无量纲单位。不要提供数值计算。",
            "solution": "用户提供了有效的问题陈述。\n\n问题要求计算由一维过阻尼朗之万方程描述的、在双阱势中的粒子的平均首达时间 (MFPT)。求解过程需要推导势函数，确定其特征，并应用 Kramers 理论计算逃逸速率。\n\n随机微分方程 (SDE) 如下：\n$$\nx' = \\mu x - x^{3} + \\sqrt{2D}\\,\\xi(t)\n$$\n其中 $x(t)$ 是状态变量，$\\mu > 0$ 是分岔参数， $D > 0$ 是噪声强度，$\\xi(t)$ 是高斯白噪声。\n\n在势 $U(x)$ 中的过阻尼朗之万方程的一般形式为：\n$$\nx' = -U'(x) + \\sqrt{2D}\\,\\xi(t)\n$$\n其中 $U'(x)$ 是势函数对 $x$ 的导数。\n\n**步骤 1：推导有效势 $U(x)$**\n通过将给定 SDE 的漂移项与一般形式进行比较，我们可以确定 $-U'(x)$：\n$$\n-U'(x) = \\mu x - x^3\n$$\n因此，力为 $F(x) = \\mu x - x^3$。势函数可以通过对 $-F(x)$ 积分得到：\n$$\nU'(x) = -(\\mu x - x^3) = x^3 - \\mu x\n$$\n将 $U'(x)$ 对 $x$ 积分，得到势函数 $U(x)$：\n$$\nU(x) = \\int (x^3 - \\mu x) \\,dx = \\frac{x^4}{4} - \\frac{\\mu x^2}{2} + C\n$$\n积分常数 $C$ 只是将势能景观在垂直方向上平移，不影响动力学或势垒的高度。不失一般性，我们可以设 $C=0$。因此，有效势为：\n$$\nU(x) = \\frac{x^4}{4} - \\frac{\\mu x^2}{2}\n$$\n\n**步骤 2：确定稳定阱和势垒的位置**\n势函数 $U(x)$ 的极值点对应于确定性系统 ($D=0$) 的不动点，可通过令 $U'(x) = 0$ 求得：\n$$\nU'(x) = x^3 - \\mu x = x(x^2 - \\mu) = 0\n$$\n由于 $\\mu > 0$，根为 $x_0 = 0$， $x_s = \\pm\\sqrt{\\mu}$。\n\n为确定这些不动点的稳定性，我们考察势函数的二阶导数 $U''(x)$：\n$$\nU''(x) = \\frac{d}{dx}(x^3 - \\mu x) = 3x^2 - \\mu\n$$\n如果 $U''(x^*) > 0$，则点 $x^*$ 是一个稳定的极小值点（阱）；如果 $U''(x^*)  0$，则是一个不稳定的极大值点（势垒）。\n- 在 $x_0 = 0$ 处：$U''(0) = 3(0)^2 - \\mu = -\\mu$。因为 $\\mu > 0$，所以 $U''(0)  0$。该点是一个局部极大值，代表两个阱之间的势垒。\n- 在 $x_s = \\pm\\sqrt{\\mu}$ 处：$U''(\\pm\\sqrt{\\mu}) = 3(\\pm\\sqrt{\\mu})^2 - \\mu = 3\\mu - \\mu = 2\\mu$。因为 $\\mu > 0$，所以 $U''(\\pm\\sqrt{\\mu}) > 0$。这两点是局部极小值，代表势的稳定阱。\n\n因此，系统在 $x = \\pm\\sqrt{\\mu}$ 处有稳定阱，在 $x=0$ 处有势垒。问题要求的是从右阱（$x \\approx +\\sqrt{\\mu}$ 附近）到左阱（$x \\approx -\\sqrt{\\mu}$ 附近）的跃迁。\n\n**步骤 3：确定势垒高度**\n势垒高度 $\\Delta U$ 是势垒顶部和稳定阱底部的势能差。我们计算从右阱出发的跃迁的势垒高度。\n- 势垒顶部 ($x_b = 0$) 的势能：$U(0) = \\frac{0^4}{4} - \\frac{\\mu(0)^2}{2} = 0$。\n- 右阱底部 ($x_w = +\\sqrt{\\mu}$) 的势能：$U(\\sqrt{\\mu}) = \\frac{(\\sqrt{\\mu})^4}{4} - \\frac{\\mu(\\sqrt{\\mu})^2}{2} = \\frac{\\mu^2}{4} - \\frac{\\mu^2}{2} = -\\frac{\\mu^2}{4}$。\n\n势垒高度为：\n$$\n\\Delta U = U(x_b) - U(x_w) = U(0) - \\left(-\\frac{\\mu^2}{4}\\right) = \\frac{\\mu^2}{4}\n$$\n\n**步骤 4：使用 Kramers 近似计算平均首达时间 (MFPT)**\nKramers 理论为从势阱越过势垒的平均逃逸时间提供了一个近似，该近似在低噪声极限 ($D \\ll \\Delta U$) 下有效。对于一维过阻尼系统，从位于 $x_w$ 的势阱越过位于 $x_b$ 的势垒的 MFPT, $\\tau$, 由以下公式给出：\n$$\n\\tau \\approx \\frac{2\\pi}{\\sqrt{U''(x_w) |U''(x_b)|}} \\exp\\left(\\frac{\\Delta U}{D}\\right)\n$$\n我们已经计算出所有必要的组成部分：\n- 右阱的位置：$x_w = \\sqrt{\\mu}$\n- 势垒的位置：$x_b = 0$\n- 阱底的二阶导数：$U''(x_w) = U''(\\sqrt{\\mu}) = 2\\mu$\n- 势垒顶的二阶导数：$U''(x_b) = U''(0) = -\\mu$，所以 $|U''(x_b)|= \\mu$。\n- 势垒高度：$\\Delta U = \\frac{\\mu^2}{4}$\n\n将这些值代入 Kramers 公式：\n$$\n\\tau \\approx \\frac{2\\pi}{\\sqrt{(2\\mu)(\\mu)}} \\exp\\left(\\frac{\\mu^2/4}{D}\\right)\n$$\n$$\n\\tau = \\frac{2\\pi}{\\sqrt{2\\mu^2}} \\exp\\left(\\frac{\\mu^2}{4D}\\right)\n$$\n$$\n\\tau = \\frac{2\\pi}{\\mu\\sqrt{2}} \\exp\\left(\\frac{\\mu^2}{4D}\\right)\n$$\n$$\n\\tau = \\frac{\\pi\\sqrt{2}}{\\mu} \\exp\\left(\\frac{\\mu^2}{4D}\\right)\n$$\n这个表达式代表了逃离右阱的平均时间。在这个对称的双阱系统中，从一个阱逃逸的时间是到达另一个阱的 MFPT 的一个极好近似，因为从势垒顶部到对面阱底部的渡越时间与等待越过势垒的激活时间相比可以忽略不计。",
            "answer": "$$\n\\boxed{\\frac{\\pi\\sqrt{2}}{\\mu}\\exp\\left(\\frac{\\mu^2}{4D}\\right)}\n$$"
        },
        {
            "introduction": "简单模型中假设的完美对称性在现实中常常被打破，导致具有质的不同行为的“不完美”分岔。最后的这个练习()介绍了计算方法，作为分析这些更复杂情景的强大工具。通过推导双稳态的条件并实现一个算法来映射整个参数空间中的系统行为，你将在使用数值方法探索和设计合成生物回路上获得实践技能。",
            "id": "3926829",
            "problem": "考虑在合成基因调控回路的对称性破缺双稳态模型中遇到的叉式分岔的非完美展开。确定性的一维常微分方程（ODE）具有如下范式：$$\\frac{dx}{dt} = f(x;\\mu,\\epsilon) = \\mu x - x^3 + \\epsilon,$$ 其中 $x$ 是一个无量纲状态变量（例如，归一化的基因表达水平），$\\mu$ 是一个无量纲控制参数，代表有效正反馈强度，$\\epsilon$ 是一个无量纲不完美参数，代表调控中的对称性破缺偏置。\n\n该常微分方程的稳态由下式的实根给出：$$f(x;\\mu,\\epsilon) = 0,$$ 即方程 $$x^3 - \\mu x - \\epsilon = 0$$ 的解。在 $(\\mu,\\epsilon)$ 参数空间中，多稳态的边界（尖点曲线）由至少有两个稳态合并的条件定义，这等价于该三次方程有一个重实根。与设计相关的多稳态区域对应的参数值，使得系统具有多个渐近稳定稳态，其中当 $f'(x^\\star;\\mu,\\epsilon) = \\mu - 3(x^\\star)^2  0$ 时，稳态 $x^\\star$ 是渐近稳定的。\n\n任务：\n1. 从常微分方程和平衡条件出发，利用多项式理论中经过验证的结论，为此非完美展开推导尖点曲线在 $(\\mu,\\epsilon)$ 中的显式解析表达式。\n2. 设计一个数值算法，对于任何给定的 $(\\mu,\\epsilon)$，找出该三次方程的所有实稳态，使用 $f'(x^\\star;\\mu,\\epsilon)$ 的符号来分类其线性稳定性，并计算渐近稳定平衡点的数量。\n3. 在一个完整的、可运行的程序中实现解析尖点计算和数值分类，该程序：\n   - 为指定的 $\\mu$ 值计算尖点曲线上的值。\n   - 为指定的 $(\\mu,\\epsilon)$ 对分类渐近稳定平衡点的数量。\n   - 通过计算具有恰好两个渐近稳定平衡点的网格点数量，在 $(\\mu,\\epsilon)$ 空间的粗网格上绘制多稳态区域。\n4. 严格使用不带物理单位的数学量。不涉及角度量。\n\n测试套件：\n- 在 $\\mu \\in \\{0.0, 0.25, 1.0, 2.0\\}$ 处评估正分支上的尖点曲线，以及在 $\\mu \\in \\{1.0\\}$ 处评估负分支。报告每个 $\\epsilon$ 的尖点值，四舍五入到六位小数。\n- 对以下 $(\\mu,\\epsilon)$ 对进行稳定性分类（渐近稳定平衡点的数量）：\n  - $(1.0, 0.0)$，\n  - $(1.0, \\epsilon_{\\text{cusp}}(1.0))$ 在正分支的尖点边界上，\n  - $(1.0, 0.1)$，\n  - $(1.0, 0.5)$，\n  - $(0.0, 0.1)$，\n  - $(1.0, -0.1)$。\n  在每种情况下，只计算满足 $f'(x^\\star;\\mu,\\epsilon)  0$ 的平衡点；将满足 $f'(x^\\star;\\mu,\\epsilon) = 0$ 的平衡点视为非渐近稳定。\n- 在矩形网格上进行多稳态映射：$\\mu$ 在 $[0,2]$ 上均匀取样 $41$ 个点，$\\epsilon$ 在 $[-0.6,0.6]$ 上均匀取样 $61$ 个点。报告表现出恰好两个渐近稳定平衡点的网格点的整数计数。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。顺序必须是：\n- 首先，是 $\\mu = 0.0, 0.25, 1.0, 2.0$ 的四个正分支尖点 $\\epsilon$ 值（每个值四舍五入到六位小数），\n- 然后是 $\\mu = 1.0$ 的单个负分支尖点 $\\epsilon$ 值（四舍五入到六位小数），\n- 接着是六个整数，给出按上文所列顺序的指定 $(\\mu,\\epsilon)$ 对的渐近稳定平衡点数量，\n- 最后，是单个整数，给出具有恰好两个渐近稳定平衡点的网格点计数。\n\n例如，输出应类似于“[e1,e2,e3,e4,e5,n1,n2,n3,n4,n5,n6,Ngrid]”，并用实际数值替换这些占位符。",
            "solution": "该问题要求分析由常微分方程（ODE）$\\frac{dx}{dt} = \\mu x - x^3 + \\epsilon$ 描述的非完美叉式分岔。此分析涉及推导双稳态的尖点曲线，设计一个算法来分类稳态，并实现这些来分析特定的参数值和绘制多稳态区域。\n\n首先，需要一个关键的验证步骤。问题陈述将常微分方程定义为 $\\frac{dx}{dt} = f(x;\\mu,\\epsilon) = \\mu x - x^3 + \\epsilon$。稳态 $x^\\star$ 是 $f(x^\\star;\\mu,\\epsilon) = 0$ 的解。这导致方程 $\\mu x - x^3 + \\epsilon = 0$，或者乘以 $-1$ 后得到 $x^3 - \\mu x - \\epsilon = 0$。然而，问题文本明确给出稳态方程为 $x^3 - \\mu x + \\epsilon = 0$。这在 $\\epsilon$ 项的符号上存在直接矛盾。稳态 $x^\\star$ 的稳定性被正确地由 $f'(x^\\star;\\mu,\\epsilon) = \\mu - 3(x^\\star)^2$ 的符号决定，这是原始ODE定义中函数 $f(x)$ 的导数。由于常微分方程和稳定性判据是相互一致的，最合乎逻辑的做法是假设所给的稳态三次方程中存在印刷错误。因此，本解答将使用从所提供的常微分方程数学推导出的稳态方程继续进行：\n$$x^3 - \\mu x - \\epsilon = 0$$\n这一修正解决了不一致性，并允许进行严谨的分析，因为 $\\epsilon$ 的符号对于不完美参数来说只是一个约定问题，并不会改变分岔的基本数学结构。\n\n**第1部分：尖点曲线的推导**\n\n在 $(\\mu, \\epsilon)$ 参数空间中，多稳态区域的边界，即尖点曲线，是由至少有两个稳态合并的条件定义的。对于一个多项式方程，这对应于有一个重根。\n稳态方程是降次三次方程 $P(x) = x^3 - \\mu x - \\epsilon = 0$。\n一个多项式在点 $x_0$ 处有重根，当且仅当该多项式及其导数在 $x_0$ 处都为零。$P(x)$ 对 $x$ 的导数是：\n$$P'(x) = 3x^2 - \\mu$$\n为了得到重根，我们必须同时求解以下方程组：\n1. $x^3 - \\mu x - \\epsilon = 0$\n2. $3x^2 - \\mu = 0$\n\n从方程（2）中，我们找到了出现重根时的 $x$ 值：\n$$3x^2 = \\mu \\implies x^2 = \\frac{\\mu}{3}$$\n这意味着 $x = \\pm\\sqrt{\\frac{\\mu}{3}}$。为了存在实值重根，我们必须有 $\\mu \\ge 0$。如果 $\\mu  0$，那么对于所有实数 $x$，都有 $P'(x) = 3x^2 - \\mu > 0$，这意味着 $P(x)$ 是严格单调的，只能有一个实根。因此，多稳态只可能在 $\\mu \\ge 0$ 时出现。\n\n将 $x^2 = \\frac{\\mu}{3}$ 代回方程（1），我们可以找到定义尖点曲线的 $\\mu$ 和 $\\epsilon$ 之间的关系。我们可以将方程（1）重写为 $x(x^2 - \\mu) - \\epsilon = 0$。现在，代入 $x$ 和 $x^2$ 的表达式：\n$$\\left(\\pm\\sqrt{\\frac{\\mu}{3}}\\right) \\left(\\frac{\\mu}{3} - \\mu\\right) - \\epsilon = 0$$\n$$\\left(\\pm\\sqrt{\\frac{\\mu}{3}}\\right) \\left(-\\frac{2\\mu}{3}\\right) - \\epsilon = 0$$\n$$\\mp \\frac{2\\mu}{3}\\sqrt{\\frac{\\mu}{3}} - \\epsilon = 0$$\n解出 $\\epsilon$，我们得到尖点曲线的显式解析表达式：\n$$\\epsilon_{\\text{cusp}}(\\mu) = \\mp \\frac{2\\mu}{3} \\frac{\\sqrt{\\mu}}{\\sqrt{3}} = \\mp \\frac{2\\mu^{3/2}}{3\\sqrt{3}}$$\n这可以更清晰地写成：\n$$\\epsilon_{\\text{cusp}}(\\mu) = \\pm \\frac{2\\sqrt{3}}{9}\\mu^{3/2}$$\n多稳态（特别是具有两个稳定稳态的双稳态）区域是由尖点曲线的这两个分支所包围的区域，对应于满足 $4\\mu^3 - 27\\epsilon^2 > 0$ 的参数值 $(\\mu, \\epsilon)$。\n\n**第2部分：稳态分类算法**\n\n要确定给定参数对 $(\\mu, \\epsilon)$ 的渐近稳定平衡点的数量，我们遵循一个两步过程：找到稳态，然后评估其稳定性。\n\n**第2a步：找到实稳态**\n对于任何给定的 $(\\mu, \\epsilon)$，稳态是三次方程 $x^3 - \\mu x - \\epsilon = 0$ 的实根。这是一个形如 $c_3 x^3 + c_2 x^2 + c_1 x + c_0 = 0$ 的多项式方程，其系数为 $c_3=1$, $c_2=0$, $c_1=-\\mu$, $c_0=-\\epsilon$。我们可以采用标准的数值算法，如友矩阵法，来找到这个多项式的所有三个（可能是复数）根。得到根之后，我们筛选它们以仅保留实值根。如果一个根 $z = a + bi$ 的虚部 $b$ 小到可以忽略不计（例如，$|b|  10^{-9}$），则它被认为是实根。\n\n**第2b步：分类稳定性**\n如果线性分析显示微小扰动会随时间衰减，则平衡点 $x^\\star$ 是渐近稳定的。这取决于常微分方程右侧的导数 $f'(x) = \\frac{d}{dx}(\\mu x - x^3 + \\epsilon)$ 在平衡点 $x^\\star$ 处求得的符号。\n导数是：\n$$f'(x) = \\mu - 3x^2$$\n对于上一步中找到的每个实根 $x^\\star$，我们计算 $f'(x^\\star)$。\n- 如果 $f'(x^\\star)  0$，则平衡点是渐近稳定的。\n- 如果 $f'(x^\\star) > 0$，则平衡点是不稳定的。\n- 如果 $f'(x^\\star) = 0$，则平衡点是非双曲的（临界稳定的），根据问题的标准，不被认为是渐近稳定的。这种情况恰好发生在尖点边界上。\n\n**第2c步：计算稳定平衡点**\n最后一步是计算有多少个实根满足渐近稳定的条件 $f'(x^\\star)  0$。这个计数（可以是 $0$、 $1$ 或 $2$）是稳定性分类任务所期望的输出。\n\n**第3部分：多稳态映射**\n\n第2部分的算法可以应用于 $(\\mu, \\epsilon)$ 参数值网格上，以绘制出系统的行为。问题要求识别双稳态区域，定义为具有恰好两个渐近稳定平衡点。步骤如下：\n1. 通过为每个参数指定范围和采样点数，在 $(\\mu, \\epsilon)$ 平面中定义一个矩形网格点。\n2. 初始化一个双稳态点计数器为零。\n3. 遍历网格上的每个点 $(\\mu_i, \\epsilon_j)$。\n4. 对每个点，执行第2部分的算法来计算渐近稳定平衡点的数量。\n5. 如果稳定平衡点的计数恰好为 $2$，则增加计数器。\n6. 计数器的最终值代表双稳态区域内的网格点数量。\n\n这种对稳态分类算法的系统性应用，提供了一个系统相图随其控制参数变化的离散映射。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the imperfect pitchfork bifurcation problem.\n    1. Computes cusp curve values.\n    2. Classifies stability for specific (mu, epsilon) pairs.\n    3. Maps the multistable region on a parameter grid.\n    \"\"\"\n\n    # Helper function to calculate the positive branch of the cusp curve\n    def get_cusp_epsilon(mu):\n        \"\"\"Calculates epsilon on the positive cusp branch for a given mu >= 0.\"\"\"\n        if mu  0:\n            return 0.0\n        return (2 * np.sqrt(3) / 9) * (mu**1.5)\n\n    # Helper function to classify and count stable equilibria\n    def count_stable_equilibria(mu, epsilon):\n        \"\"\"\n        Finds all real steady states for a given (mu, epsilon) pair\n        and counts the number of asymptotically stable ones.\n        \"\"\"\n        # Steady state equation: x^3 - mu*x - epsilon = 0\n        # Coefficients of the polynomial x^3 + 0*x^2 - mu*x - epsilon\n        coeffs = [1, 0, -mu, -epsilon]\n        \n        # Find all complex roots\n        roots = np.roots(coeffs)\n        \n        # Filter for real roots (imaginary part is close to zero)\n        real_roots = roots[np.isclose(roots.imag, 0)].real\n        \n        stable_count = 0\n        # Check stability for each real root\n        for x_star in real_roots:\n            # Stability criterion: f'(x*) = mu - 3*(x*)^2  0\n            f_prime = mu - 3 * x_star**2\n            # Per problem, f'(x*) = 0 is not asymptotically stable\n            if f_prime  0:\n                stable_count += 1\n        \n        return stable_count\n\n    # --- Test Suite Execution ---\n    \n    results = []\n\n    # 1. Cusp curve evaluations\n    cusp_mus_pos = [0.0, 0.25, 1.0, 2.0]\n    for mu in cusp_mus_pos:\n        epsilon_val = get_cusp_epsilon(mu)\n        results.append(f\"{epsilon_val:.6f}\")\n\n    # Negative branch at mu = 1.0\n    epsilon_neg_val = -get_cusp_epsilon(1.0)\n    results.append(f\"{epsilon_neg_val:.6f}\")\n\n    # 2. Stability classification for specified pairs\n    class_pairs = [\n        (1.0, 0.0),\n        (1.0, get_cusp_epsilon(1.0)),\n        (1.0, 0.1),\n        (1.0, 0.5),\n        (0.0, 0.1),\n        (1.0, -0.1),\n    ]\n    for mu, epsilon in class_pairs:\n        count = count_stable_equilibria(mu, epsilon)\n        results.append(str(count))\n\n    # 3. Multistability mapping\n    mu_grid = np.linspace(0.0, 2.0, 41)\n    epsilon_grid = np.linspace(-0.6, 0.6, 61)\n    \n    bistable_points_count = 0\n    for mu in mu_grid:\n        for epsilon in epsilon_grid:\n            # Check for exactly two asymptotically stable equilibria\n            if count_stable_equilibria(mu, epsilon) == 2:\n                bistable_points_count += 1\n    \n    results.append(str(bistable_points_count))\n\n    # --- Final Output Formatting ---\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}