{
    "hands_on_practices": [
        {
            "introduction": "本练习通过研究群体感应回路（合成生物学中的一种常见模体），为相平面分析奠定基础。你将推导零斜线（即系统中一个变量变化率为零的曲线），以理解正反馈如何塑造系统的动态“景观”并允许多个稳态的存在。此练习的高潮是计算一个鞍结分岔点，这是一个两个平衡点合并与消失的临界阈值，为我们提供了一个预测回路行为如何发生剧烈变化的具体范例。",
            "id": "3926235",
            "problem": "考虑一个均匀混合的单一细胞群体中的最小群体感应模块，其中浓度为 $x$ 的细胞内转录调节因子以基础速率 $s$ 产生，并以速率 $\\gamma x$ 降解；浓度为 $y$ 的细胞外自诱导物以耦合强度 $k$ 反馈到 $x$ 的产生中。自诱导物 $y$ 由细胞以速率 $h(x)$ 产生，并以速率 $\\delta y$ 降解/稀释。其动力学由以下自治常微分方程组建模：\n$$\n\\dot{x} \\;=\\; s \\;-\\; \\gamma x \\;+\\; k y,\\qquad \n\\dot{y} \\;=\\; h(x) \\;-\\; \\delta y,\n$$\n其中 $s,\\gamma,k,\\delta>0$，$h(x)$ 是一个捕获正反馈的增函数。\n\n任务：\n1) 使用相平面中零增长线的定义，为任意可微函数 $h(x)$ 写出 $x$-零增长线和 $y$-零增长线的显式表达式，表示为 $y$ 关于 $x$ 的函数。\n\n2) 仅使用平衡点和零增长线的核心定义以及相平面中的几何推理，定性分析反馈函数 $h(x)$ 的选择如何相对于无反馈基线改变 $y$-零增长线的位置和形状，并解释为什么当参数 $s$ 变化时，足够强的正反馈可以改变平衡点的数量。\n\n3) 考虑 Hill 系数 $n=2$ 的 Hill 型正反馈特例，\n$$\nh(x) \\;=\\; \\alpha \\;+\\; \\beta \\,\\frac{x^{2}}{K^{2}+x^{2}},\n$$\n其中 $\\alpha\\ge 0$ 是基础产生速率，$\\beta>0$ 是诱导产生强度，$K>0$ 是半激活浓度。取以下参数：\n$$\n\\gamma \\,=\\, 0.1\\ \\text{min}^{-1},\\quad k \\,=\\, 0.5\\ \\text{min}^{-1},\\quad \\delta \\,=\\, 0.2\\ \\text{min}^{-1},\\quad \\alpha \\,=\\, 0.1\\ \\text{nM}\\cdot \\text{min}^{-1},\\\\\n\\beta \\,=\\, 3.125\\ \\text{nM}\\cdot \\text{min}^{-1},\\quad K \\,=\\, 50\\ \\text{nM}.\n$$\n当 $s$ 从低值准静态地增加时，在两个平衡点合并的临界输入速率 $s^{\\ast}$ 处发生鞍结分岔。通过推导定义此临界状态的相平面几何条件，并针对给定参数求解，确定 $s^{\\ast}$。将 $s^{\\ast}$ 的最终数值四舍五入到四位有效数字，并以 $\\text{nM}\\cdot \\text{min}^{-1}$ 为单位表示。",
            "solution": "该问题要求对一个模拟群体感应模块的双变量动力学系统进行分析。任务包括推导零增长线、定性分析系统存在多平衡点的可能性，以及为一组给定参数计算一个特定的分岔点。\n\n控制该系统的常微分方程（ODE）为：\n$$\n\\dot{x} = s - \\gamma x + k y\n$$\n$$\n\\dot{y} = h(x) - \\delta y\n$$\n其中 $x(t)$ 和 $y(t)$ 分别是细胞内调节因子和细胞外自诱导物的浓度。所有参数 $s, \\gamma, k, \\delta$ 均为正常数，且 $h(x)$ 是 $x$ 的一个增函数。\n\n**1) 零增长线表达式**\n\n零增长线是相平面中某个变量的变化率为零的点集。系统的平衡点是所有零增长线的交点。\n\n$x$-零增长线是满足 $\\dot{x} = 0$ 的点 $(x, y)$ 的轨迹。将第一个 ODE 设为零：\n$$\n0 = s - \\gamma x + k y\n$$\n为了将其表示为 $y$ 关于 $x$ 的函数，我们整理该方程：\n$$\nk y = \\gamma x - s\n$$\n$$\ny = \\frac{\\gamma}{k}x - \\frac{s}{k}\n$$\n这是 $x$-零增长线的方程。它是在 $(x, y)$ 相平面上的一条直线，斜率为正值 $\\frac{\\gamma}{k}$，$y$ 轴截距为 $-\\frac{s}{k}$。\n\n$y$-零增长线是满足 $\\dot{y} = 0$ 的点 $(x, y)$ 的轨迹。将第二个 ODE 设为零：\n$$\n0 = h(x) - \\delta y\n$$\n整理以求解 $y$：\n$$\n\\delta y = h(x)\n$$\n$$\ny = \\frac{h(x)}{\\delta}\n$$\n这是 $y$-零增长线的方程。其形状由反馈函数 $h(x)$ 决定。由于已知 $h(x)$ 是一个增函数，因此 $y$-零增长线也是 $x$ 的一个增函数。\n\n**2) 平衡点的定性分析**\n\n平衡点是同时满足 $\\dot{x}=0$ 和 $\\dot{y}=0$ 的点 $(x, y)$。从几何上看，这些是 $x$-零增长线和 $y$-零增长线在相平面上的交点。\n\n$x$-零增长线是直线 $y = \\frac{\\gamma}{k}x - \\frac{s}{k}$。参数 $s$ 控制这条线的垂直位置；随着 $s$ 的增加，$y$ 轴截距 $-\\frac{s}{k}$ 变得更负，从而使直线向下平移。\n\n$y$-零增长线是曲线 $y = \\frac{h(x)}{\\delta}$。反馈函数 $h(x)$ 的选择决定了这条曲线的形状。\n- “无反馈基线”可以解释为 $h(x)$ 是一个常数，例如 $h(x) = \\alpha_0$。在这种情况下，$y$-零增长线将是一条水平线 $y=\\alpha_0/\\delta$。无论 $s$ 的值是多少，这条水平线与向上倾斜的 $x$-零增长线的交点将总会产生一个唯一的平衡点。\n- “足够强的正反馈”意味着一种非线性的协同响应，通常由 S 型（sigmoidal）函数建模。一个 S 型的 $h(x)$ 会产生一个 S 型的 $y$-零增长线。这样的曲线在两个较平坦的区域之间有一个斜率陡峭的区域。\n\n平衡点的数量取决于线性的 $x$-零增长线与（可能为 S 型的）$y$-零增长线之间的交点数量。\n- 如果 $x$-零增长线的斜率 $\\frac{\\gamma}{k}$ 大于 $y$-零增长线的最大斜率，那么将总有且仅有一个交点，因此只有一个平衡点。\n- 如果反馈足够强，使得 $y$-零增长线的最大斜率超过 $x$-零增长线的斜率，就可能出现多个交点。通过改变 $s$，线性的 $x$-零增长线会上下移动。对于非常小或非常大的 $s$，直线与 S 型曲线在平坦区域相交，导致一个平衡点。对于一个中间范围的 $s$，直线可以与 S 型曲线的陡峭部分相交三次。一个和三个平衡点之间的转换发生在两条零增长线的相切点处。这些相切点对应于鞍结分岔。因此，足够强的正反馈在参数 $s$ 中创建了一个双稳态区域。\n\n**3) 分岔点 $s^{\\ast}$ 的计算**\n\n对于此任务，我们具体考虑 Hill 型反馈函数\n$$\nh(x) = \\alpha + \\beta \\frac{x^2}{K^2+x^2}\n$$\n参数为：$\\gamma = 0.1\\ \\text{min}^{-1}$，$k = 0.5\\ \\text{min}^{-1}$，$\\delta = 0.2\\ \\text{min}^{-1}$，$\\alpha = 0.1\\ \\text{nM}\\cdot \\text{min}^{-1}$，$\\beta = 3.125\\ \\text{nM}\\cdot \\text{min}^{-1}$，以及 $K = 50\\ \\text{nM}$。\n\n零增长线为：\n$x$-零增长线：$y = \\frac{\\gamma}{k}x - \\frac{s}{k}$\n$y$-零增长线：$y = g(x) = \\frac{1}{\\delta} \\left( \\alpha + \\beta \\frac{x^2}{K^2+x^2} \\right)$\n\n当两条零增长线相切时，发生鞍结分岔。这要求在分岔点 $(x^{\\ast}, y^{\\ast})$ 处满足两个条件：\n1. 该点同时位于两条曲线上：$y^{\\ast} = \\frac{\\gamma}{k}x^{\\ast} - \\frac{s^{\\ast}}{k} = g(x^{\\ast})$\n2. 两条曲线的斜率相等：$\\frac{d}{dx} \\left(\\frac{\\gamma}{k}x - \\frac{s}{k}\\right) \\bigg|_{x=x^{\\ast}} = g'(x^{\\ast})$\n\n我们首先评估斜率条件。$x$-零增长线的斜率是常数：\n$$\n\\text{Slope}_x = \\frac{\\gamma}{k} = \\frac{0.1}{0.5} = 0.2\n$$\n$y$-零增长线的斜率是 $g(x)$ 的导数：\n$$\ng'(x) = \\frac{d}{dx} \\left[ \\frac{\\alpha}{\\delta} + \\frac{\\beta}{\\delta} \\frac{x^2}{K^2+x^2} \\right] = \\frac{\\beta}{\\delta} \\frac{d}{dx} \\left( \\frac{x^2}{K^2+x^2} \\right)\n$$\n使用商法则，我们得到：\n$$\ng'(x) = \\frac{\\beta}{\\delta} \\frac{(2x)(K^2+x^2) - (x^2)(2x)}{(K^2+x^2)^2} = \\frac{2\\beta K^2}{\\delta} \\frac{x}{(K^2+x^2)^2}\n$$\n相切条件为 $g'(x^{\\ast}) = \\frac{\\gamma}{k}$：\n$$\n\\frac{2\\beta K^2}{\\delta} \\frac{x^{\\ast}}{((x^{\\ast})^2+K^2)^2} = \\frac{\\gamma}{k}\n$$\n代入数值：\n$\\frac{2 \\times 3.125 \\times 50^2}{0.2} = \\frac{6.25 \\times 2500}{0.2} = 78125$。\n$K^2 = 50^2 = 2500$。\n$x^{\\ast}$ 的方程变为：\n$$\n78125 \\frac{x^{\\ast}}{((x^{\\ast})^2+2500)^2} = 0.2\n$$\n$$\n((x^{\\ast})^2+2500)^2 = \\frac{78125}{0.2} x^{\\ast} = 390625 x^{\\ast}\n$$\n令 $X = x^{\\ast}$。展开左侧得到一个四次方程：\n$$\nX^4 + 5000 X^2 + 6250000 = 390625 X\n$$\n$$\nX^4 + 5000 X^2 - 390625 X + 6250000 = 0\n$$\n通过观察或数值检验，可以发现 $X=25$ 是一个根：\n$25^4 + 5000(25^2) - 390625(25) + 6250000 = 390625 + 5000(625) - 9765625 + 6250000 = 390625 + 3125000 - 9765625 + 6250000 = 0$。\n因此，一个相切点发生在 $x_1^{\\ast} = 25\\ \\text{nM}$。存在两个相切点，分别对应平衡点的产生和湮灭。问题描述了从低值增加 $s$，并要求找到两个现有平衡点合并的点。这对应于湮灭事件，发生在低稳态平衡点和不稳定鞍点平衡点合并时。这是 S 型响应曲线“膝点”处的分岔点，对应于较小的 $x^{\\ast}$ 值。快速分析表明另一个相切点在 $x_2^{\\ast} \\approx 33.7\\ \\text{nM}$。因此，我们使用 $x^{\\ast} = 25\\ \\text{nM}$。\n\n现在我们确定系统状态 $(x^{\\ast}, y^{\\ast})$ 和参数 $s^{\\ast}$。\n首先，我们将 $x^{\\ast}=25$ 代入 $y$-零增长线方程来求解 $y^{\\ast}$：\n$$\ny^{\\ast} = g(25) = \\frac{1}{0.2} \\left( 0.1 + 3.125 \\frac{25^2}{50^2+25^2} \\right)\n$$\n$$\ny^{\\ast} = 5 \\left( 0.1 + 3.125 \\frac{625}{2500+625} \\right) = 5 \\left( 0.1 + 3.125 \\frac{625}{3125} \\right)\n$$\n$$\ny^{\\ast} = 5 \\left( 0.1 + 3.125 \\times 0.2 \\right) = 5(0.1 + 0.625) = 5(0.725) = 3.625\\ \\text{nM}\n$$\n最后，我们使用 $x$-零增长线方程和点 $(x^{\\ast}, y^{\\ast})=(25, 3.625)$ 来求解 $s^{\\ast}$：\n$$\ny^{\\ast} = \\frac{\\gamma}{k}x^{\\ast} - \\frac{s^{\\ast}}{k}\n$$\n$$\ns^{\\ast} = k \\left( \\frac{\\gamma}{k}x^{\\ast} - y^{\\ast} \\right) = \\gamma x^{\\ast} - k y^{\\ast}\n$$\n$$\ns^{\\ast} = (0.1)(25) - (0.5)(3.625) = 2.5 - 1.8125 = 0.6875\n$$\n$s^{\\ast}$ 的单位是 $\\text{nM}\\cdot \\text{min}^{-1}$，符合要求。数值 $0.6875$ 有四位有效数字。",
            "answer": "$$\n\\boxed{0.6875}\n$$"
        },
        {
            "introduction": "从解析草图到计算可视化，本练习让你亲手构建工具来观察系统动态的全貌。你将为一个经典的基因开关（一种基础的合成回路）实现一个生成向量场的算法。这项动手编程实践不仅将相图的抽象概念具体化，还引入了关于数值离散化如何影响我们对系统流向解读的重要思考。",
            "id": "3926237",
            "problem": "给定一个平面的合成基因网络模型，其包含两个无量纲化的状态变量，即信使核糖核酸 (mRNA) 或蛋白质浓度，记为 $x$ 和 $y$。该网络动力学由以下形式的常微分方程 (ODE) 系统控制：\n$$\n\\frac{dx}{dt} = f(x,y) = \\frac{\\alpha}{1 + y^{n}} - x, \\quad\n\\frac{dy}{dt} = g(x,y) = \\frac{\\beta}{1 + x^{m}} - y,\n$$\n其中 $\\alpha > 0$ 和 $\\beta > 0$ 是产生参数，$n \\ge 1$ 和 $m \\ge 1$ 是表示协同抑制的 Hill 系数。由于标准的无量纲化选择将解离常数和降解率设为单位1，所有参数和变量都是无量纲的。\n\n您的任务是设计并实现一种基于网格的计算，以近似相平面流场的方向，并量化离散化效应对流场方向解释的影响。计算必须按以下步骤进行：\n\n1. 在方形域 $D = [0, X_{\\max}] \\times [0, Y_{\\max}]$ 上构建一个均匀的笛卡尔网格，每个轴上有 $N$ 个点，其中 $X_{\\max} = 3$，$Y_{\\max} = 3$，而 $N \\in \\mathbb{N}$ 由每个测试用例指定。设网格间距为 $h = \\frac{X_{\\max}}{N-1} = \\frac{Y_{\\max}}{N-1}$。\n\n2. 在每个网格节点 $(x_{i}, y_{j})$ 处，计算向量场 $(f(x_{i}, y_{j}), g(x_{i}, y_{j}))$ 及其方向角\n$$\n\\theta_{ij} = \\operatorname{atan2}(g(x_{i}, y_{j}), f(x_{i}, y_{j})),\n$$\n该角度以弧度为单位，并定义在 $(-\\pi, \\pi]$ 区间内。请使用双参数反正切函数。如果两个分量都满足 $|f(x_{i}, y_{j})| < \\epsilon$ 和 $|g(x_{i}, y_{j})| < \\epsilon$（其中 $\\epsilon = 10^{-12}$），则将 $\\theta_{ij}$ 定义为非数值 (无效)，表示该网格节点处的向量场大小有效为零。\n\n3. 对于每对水平相邻节点 $(x_{i}, y_{j})$ 和 $(x_{i+1}, y_{j})$ 以及每对垂直相邻节点 $(x_{i}, y_{j})$ 和 $(x_{i}, y_{j+1})$，定义角度差\n$$\n\\Delta \\theta = \\mathrm{wrap}(\\theta_{\\text{neighbor}} - \\theta_{\\text{current}}),\n$$\n其中包裹操作 $\\mathrm{wrap}(\\cdot)$ 通过加或减 $2\\pi$ 的整数倍，将任何实数角度映射到 $(-\\pi, \\pi]$ 的主值区间。仅当边的两个端点角度都有效（非无效）时，才认为该边是有效的。对于每个有效边，计算 $|\\Delta \\theta|$。\n\n4. 如果 $|\\Delta \\theta| > \\frac{\\pi}{2}$，则定义边上发生了方向翻转。翻转率度量则为\n$$\nR = \\frac{\\text{满足 } |\\Delta \\theta| > \\frac{\\pi}{2} \\text{ 的有效边数}}{\\text{有效边总数}},\n$$\n并约定如果没有有效边，则 $R = 0$。\n\n您的程序必须实现此算法，并对以下六个测试用例中的每一个评估翻转率 $R$。每个测试用例指定 $(\\alpha, \\beta, n, m, N)$，域固定为如上所述的 $[0,3] \\times [0,3]$，角度必须以弧度解释。\n\n- 测试用例 1: $(\\alpha, \\beta, n, m, N) = (2.0, 2.0, 2, 2, 25)$。\n- 测试用例 2: $(\\alpha, \\beta, n, m, N) = (2.0, 2.0, 2, 2, 5)$。\n- 测试用例 3: $(\\alpha, \\beta, n, m, N) = (2.0, 2.0, 6, 6, 25)$。\n- 测试用例 4: $(\\alpha, \\beta, n, m, N) = (3.0, 1.5, 4, 2, 21)$。\n- 测试用例 5: $(\\alpha, \\beta, n, m, N) = (2.5, 2.5, 8, 8, 9)$。\n- 测试用例 6: $(\\alpha, \\beta, n, m, N) = (2.0, 2.0, 2, 2, 2)$。\n\n目的是量化网格离散化和非线性度（通过 $n$ 和 $m$）如何影响相平面流场方向的表观连续性。\n\n最终输出格式：您的程序应生成一行输出，其中包含六个测试用例的翻转率结果，格式为方括号括起来的逗号分隔列表，顺序与上述测试用例相同。每个翻转率必须输出为四舍五入到六位小数的浮点数。例如，需要形如 $[r_{1},r_{2},r_{3},r_{4},r_{5},r_{6}]$ 的输出，其中每个 $r_{k}$ 是一个浮点数，如 $0.123456$。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题设定良好且客观。所描述的模型是合成生物学中基因触发开关的典型表示，而计算任务是一个清晰且定义明确的数值分析问题。所有必要的参数、方程和算法步骤都已提供，没有矛盾或歧义。\n\n该解决方案实现了规定的算法，用于在离散网格上计算平面动力系统的翻转率度量 $R$。过程如下：\n\n首先，合成基因网络的模型由以下常微分方程系统给出：\n$$\n\\frac{dx}{dt} = f(x,y) = \\frac{\\alpha}{1 + y^{n}} - x\n$$\n$$\n\\frac{dy}{dt} = g(x,y) = \\frac{\\beta}{1 + x^{m}} - y\n$$\n其中 $x$ 和 $y$ 是无量纲浓度，$\\alpha > 0$ 和 $\\beta > 0$ 是产生参数，$n \\ge 1$ 和 $m \\ge 1$ 是 Hill 系数。\n\n算法分为四个主要步骤：\n\n1.  **网格和向量场生成**：将域 $D = [0, X_{\\max}] \\times [0, Y_{\\max}]$（其中 $X_{\\max} = 3$ 且 $Y_{\\max} = 3$）离散化为一个均匀的 $N \\times N$ 笛卡尔网格。使用 `numpy.linspace` 和 `numpy.meshgrid` 构建网格节点坐标 $(x_i, y_j)$。为了提高计算效率，在每个节点上，使用对网格坐标数组的向量化操作来计算向量场分量 $f(x_i, y_j)$ 和 $g(x_i, y_j)$。\n\n2.  **角度计算和验证**：使用双参数反正切函数 $\\theta_{ij} = \\operatorname{atan2}(g(x_i, y_j), f(x_i, y_j))$ 来确定每个节点处向量场的方向角，该函数返回一个在 $(-\\pi, \\pi]$ 区间内的值。如果向量场的大小几乎为零，则认为该节点代表一个不动点。具体来说，如果 $|f(x_i, y_j)| < \\epsilon$ 且 $|g(x_i, y_j)| < \\epsilon$（其中容差为 $\\epsilon = 10^{-12}$），则相应的角度 $\\theta_{ij}$ 被标记为无效（在计算中表示为“非数值”，即 `NaN`）。\n\n3.  **角度差和翻转检测**：分析所有有效边上的流向变化。一条边（连接两个相邻节点，水平或垂直）仅在其两端点的角度都有效时才有效。对于连接“当前”节点和“邻居”节点的每条有效边，计算原始角度差 $\\Delta\\theta_{\\text{raw}} = \\theta_{\\text{neighbor}} - \\theta_{\\text{current}}$。这个差值可能在 $(-2\\pi, 2\\pi)$ 范围内，通过一个包裹函数 $\\Delta\\theta = \\mathrm{wrap}(\\Delta\\theta_{\\text{raw}})$ 将其映射到主区间 $(-\\pi, \\pi]$。包裹操作使用公式 $\\Delta\\theta = (\\Delta\\theta_{\\text{raw}} + \\pi) \\pmod{2\\pi} - \\pi$ 实现，以确保找到最短角度。如果此包裹差值的绝对值超过 $\\pi/2$，即 $|\\Delta\\theta| > \\pi/2$，则记录该边发生了一次“方向翻转”。整个过程通过创建角度矩阵的切片视图来表示水平和垂直相邻节点对，并使用布尔掩码仅对有效边执行计算，从而实现向量化。\n\n4.  **翻转率计算**：最终的翻转率度量 $R$ 计算为总翻转次数与网格中总有效边数的比率：\n    $$\n    R = \\frac{\\text{满足 } |\\Delta \\theta| > \\frac{\\pi}{2} \\text{ 的有效边数}}{\\text{有效边总数}}\n    $$\n    根据问题的定义，如果有效边总数为零，则翻转率取为 $R = 0$。对测试用例中指定的每组参数计算这个最终值。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_flip_rate(alpha, beta, n, m, N, X_max=3.0, Y_max=3.0, epsilon=1e-12):\n    \"\"\"\n    Computes the flip-rate metric R for a given synthetic gene network model on a discrete grid.\n\n    Args:\n        alpha (float): Production parameter for x.\n        beta (float): Production parameter for y.\n        n (int or float): Hill coefficient for y repression.\n        m (int or float): Hill coefficient for x repression.\n        N (int): Number of grid points per axis.\n        X_max (float): Maximum x-coordinate of the domain.\n        Y_max (float): Maximum y-coordinate of the domain.\n        epsilon (float): Tolerance for identifying zero vector fields.\n\n    Returns:\n        float: The computed flip-rate R.\n    \"\"\"\n    # If N  2, there are no edges, so the flip rate is 0 by convention.\n    if N  2:\n        return 0.0\n\n    # Step 1: Construct a uniform Cartesian grid.\n    x_coords = np.linspace(0.0, X_max, N)\n    y_coords = np.linspace(0.0, Y_max, N)\n    x_grid, y_grid = np.meshgrid(x_coords, y_coords)\n\n    # Step 2: Compute the vector field and direction angles.\n    f_vals = alpha / (1.0 + y_grid**n) - x_grid\n    g_vals = beta / (1.0 + x_grid**m) - y_grid\n    \n    theta = np.arctan2(g_vals, f_vals)\n    \n    # Identify and mark invalid angles where the vector field is effectively zero.\n    invalid_mask = (np.abs(f_vals)  epsilon)  (np.abs(g_vals)  epsilon)\n    theta[invalid_mask] = np.nan\n\n    # Step 3  4: Analyze edges for flips and compute the flip-rate.\n    total_flips = 0\n    total_valid_edges = 0\n\n    def wrap_angle_difference(delta):\n        \"\"\"Maps an angle difference to the principal interval (-pi, pi].\"\"\"\n        return (delta + np.pi) % (2.0 * np.pi) - np.pi\n\n    # Process horizontal edges\n    theta_h_current = theta[:, :-1]\n    theta_h_neighbor = theta[:, 1:]\n    valid_edges_h = ~np.isnan(theta_h_current)  ~np.isnan(theta_h_neighbor)\n    \n    num_valid_h = np.sum(valid_edges_h)\n    if num_valid_h > 0:\n        total_valid_edges += num_valid_h\n        delta_theta_h = theta_h_neighbor[valid_edges_h] - theta_h_current[valid_edges_h]\n        wrapped_delta_h = wrap_angle_difference(delta_theta_h)\n        total_flips += np.sum(np.abs(wrapped_delta_h) > (np.pi / 2.0))\n\n    # Process vertical edges\n    theta_v_current = theta[:-1, :]\n    theta_v_neighbor = theta[1:, :]\n    valid_edges_v = ~np.isnan(theta_v_current)  ~np.isnan(theta_v_neighbor)\n    \n    num_valid_v = np.sum(valid_edges_v)\n    if num_valid_v > 0:\n        total_valid_edges += num_valid_v\n        delta_theta_v = theta_v_neighbor[valid_edges_v] - theta_v_current[valid_edges_v]\n        wrapped_delta_v = wrap_angle_difference(delta_theta_v)\n        total_flips += np.sum(np.abs(wrapped_delta_v) > (np.pi / 2.0))\n\n    # Calculate the final flip-rate R.\n    if total_valid_edges == 0:\n        return 0.0\n    \n    return float(total_flips) / float(total_valid_edges)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, beta, n, m, N)\n        (2.0, 2.0, 2, 2, 25),\n        (2.0, 2.0, 2, 2, 5),\n        (2.0, 2.0, 6, 6, 25),\n        (3.0, 1.5, 4, 2, 21),\n        (2.5, 2.5, 8, 8, 9),\n        (2.0, 2.0, 2, 2, 2),\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, beta, n, m, N = case\n        rate = calculate_flip_rate(alpha, beta, n, m, int(N))\n        results.append(f\"{rate:.6f}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在这里，我们将稳定性和平衡点的概念应用于一个具体的工程问题：确定一个基因开关的触发阈值。该模型中的蛋白质表现出一种看似矛盾的行为：它在低浓度时激活自身生产，在高浓度时则抑制自身生产，从而产生了双稳态。通过找到分隔“关”态和“开”态的不稳定平衡点，你将直接计算出翻转该开关所需的最小瞬时蛋白质脉冲，这展示了稳定性分析在电路设计中的预测能力。",
            "id": "1458330",
            "problem": "在一个简化的遗传调控网络模型中，蛋白质X作为其自身的转录因子。这种自我调节表现出一种悖论行为：在低浓度时，该蛋白质促进其自身的合成（激活），而在高浓度时，则抑制其合成（抑制）。蛋白质X的浓度，记为$[X]$，随时间演变，遵循以下常微分方程：\n\n$$\n\\frac{d[X]}{dt} = \\beta \\frac{[X]^2}{K_A^2 + [X]^2} \\cdot \\frac{K_R^2}{K_R^2 + [X]^2} - k_d [X]\n$$\n\n其中，$\\beta$是最大合成速率，$k_d$是一级降解速率常数，$K_A$和$K_R$分别是激活常数和抑制常数。该系统作为一个双稳态开关，能够存在于低浓度的“关”态和高浓度的“开”态。\n\n给定以下参数值：\n- 最大合成速率，$\\beta = 20.0 \\text{ nM/min}$\n- 降解速率常数，$k_d = 1.0 \\text{ min}^{-1}$\n- 激活常数，$K_A = 1.0 \\text{ nM}$\n- 抑制常数，$K_R = 3.0 \\text{ nM}$\n\n为使系统从其“关”态（零浓度）转换到稳定的“开”态，X的浓度必须暂时升高到一个临界阈值以上。确定这个阈值浓度。答案以nM为单位，并四舍五入到三位有效数字。",
            "solution": "令$\\frac{d[X]}{dt}=0$以求稳态。为简洁起见，设$X=[X]$。稳态条件为\n$$\n\\beta \\frac{X^{2}}{K_{A}^{2}+X^{2}} \\cdot \\frac{K_{R}^{2}}{K_{R}^{2}+X^{2}}=k_{d}X.\n$$\n存在一个平凡解$X=0$。对于$X0$，两边同除以$X$得到\n$$\n\\beta \\frac{K_{R}^{2}X}{\\left(K_{A}^{2}+X^{2}\\right)\\left(K_{R}^{2}+X^{2}\\right)}=k_{d},\n$$\n或等价地\n$$\n\\beta K_{R}^{2}X=k_{d}\\left(K_{A}^{2}+X^{2}\\right)\\left(K_{R}^{2}+X^{2}\\right).\n$$\n该双稳态开关有两个稳定不动点（位于$X=0$的低浓度“关”态和位于较大$X$值的高浓度“开”态），它们被一个不稳定不动点隔开。要离开$X=0$的吸引盆所必须超过的临界阈值，恰好是上述稳态方程的最小正非零解。\n\n将给定的参数值$k_{d}=1.0$，$\\beta=20.0$，$K_{A}=1.0$，$K_{R}=3.0$（单位一致）代入精确的代数方程中：\n$$\n20\\cdot 9\\, X=(1+X^{2})(9+X^{2})\\quad\\Longrightarrow\\quad 180X=9+10X^{2}+X^{4}.\n$$\n由于阈值接近于零，我们首先在原始稳态条件下使用小$X$近似$X^{2}\\ll K_{A}^{2}$和$X^{2}\\ll K_{R}^{2}$：\n$$\n\\beta \\frac{X^{2}}{K_{A}^{2}}\\cdot 1\\approx k_{d}X \\quad\\Longrightarrow\\quad X\\approx \\frac{k_{d}K_{A}^{2}}{\\beta}=\\frac{1.0\\cdot 1.0^{2}}{20.0}=0.05.\n$$\n通过求解源自$180X=9+10X^{2}+X^{4}$的精确方程，使用不动点迭代法来精确化这个结果：\n$$\nX_{n+1}=\\frac{9+10X_{n}^{2}+X_{n}^{4}}{180},\\quad X_{0}=0.05.\n$$\n计算连续的迭代值：\n$$\nX_{1}=\\frac{9+10(0.05)^{2}+(0.05)^{4}}{180}\\approx 0.0501389,\\quad\nX_{2}=\\frac{9+10X_{1}^{2}+X_{1}^{4}}{180}\\approx 0.0501397.\n$$\n因此，不稳定的阈值浓度为$X\\approx 0.05014$ nM。四舍五入到三位有效数字，得到$0.0501$ nM。",
            "answer": "$$\\boxed{0.0501}$$"
        }
    ]
}