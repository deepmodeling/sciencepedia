{
    "hands_on_practices": [
        {
            "introduction": "要掌握反应扩散主方程（RDME），首先必须理解其数学核心——生成元矩阵。本练习将通过一个仅包含扩散过程的双格点系统，指导您从第一性原理构建生成元矩阵$Q$。通过计算其特征值，您将揭示微观跳跃率与宏观平衡弛豫时间之间的直接联系，从而深入理解主方程如何控制系统趋向平衡的动力学过程。",
            "id": "3929346",
            "problem": "考虑一个反应-扩散主方程（RDME）模型，用于描述单个化学物种在标记为$1$和$2$的两个空间体素之间进行扩散。该系统是封闭的，包含总共固定的$N$个分子，因此系统的状态完全由体素$1$中的分子数$n \\in \\{0,1,\\dots,N\\}$确定（此时体素$2$中有$N-n$个分子）。体素$1$中的每个分子以速率$\\eta_{1}$（每个分子）跳跃到体素$2$，体素$2$中的每个分子以速率$\\eta_{2}$（每个分子）跳跃到体素$1$。假设分子间不发生相互作用，也没有其他化学反应。\n\n从反应-扩散主方程（RDME）作为连续时间马尔可夫链（CTMC）的定义出发，其生成元为$Q$，满足状态概率向量$\\boldsymbol{p}(t)$的方程$\\frac{d}{dt}\\boldsymbol{p}(t) = Q \\boldsymbol{p}(t)$，完成以下任务：\n\n1. 用$N$、$\\eta_{1}$和$\\eta_{2}$显式构造$(N+1)\\times(N+1)$的生成元矩阵$Q$。您的构造必须遵循单分子扩散事件的RDME倾向函数的马尔可夫跳跃过程基本定义，并且必须确定所有非零元素$Q_{i,j}$，其中$i,j \\in \\{0,1,\\dots,N\\}$。\n\n2. 符号化地计算$Q$的全套特征值，并从第一性原理出发解释其推导过程，包括分子的独立性如何导致该谱的形成。\n\n3. 确定与每个非零特征值模式相关的达到平衡的弛豫时间，并确定最慢的弛豫时间（这些模式中最长的时间尺度）。用秒表示最慢的弛豫时间。不要代入数值；给出一个封闭形式的表达式。\n\n您的最终答案必须是表示最慢弛豫时间（以秒为单位）的单一封闭形式表达式。不需要近似或四舍五入。",
            "solution": "我们从反应-扩散主方程（RDME）作为连续时间马尔可夫链（CTMC）的基本定义开始。对于有限状态空间上的CTMC，介观层面的质量作用定律规定单分子扩散事件被建模为马尔可夫跳跃。生成元$Q$编码了转移速率，使得对于状态上的概率向量$\\boldsymbol{p}(t)$，主方程为$\\frac{d}{dt}\\boldsymbol{p}(t) = Q \\boldsymbol{p}(t)$。\n\n在这个具有两个体素和一种物种的系统中，状态可以表示为整数$n \\in \\{0,1,\\dots,N\\}$，表示体素$1$中的分子数量；此时体素$2$中的分子数量为$N-n$。体素$1$中的分子以每个分子$\\eta_{1}$的速率跳跃到体素$2$，体素$2$中的分子以每个分子$\\eta_{2}$的速率跳跃到体素$1$。由于分子不相互作用且只进行扩散，每个分子都遵循其自身独立的双态（体素$1$或体素$2$）马尔可夫动力学。\n\n步骤1（构造$Q$）：关于$n$的生灭链的RDME倾向函数源于单分子事件：\n\n- 体素$1$中的一个分子跳跃到体素$2$会使$n$减少$1$，即$n \\mapsto n-1$。从状态$n$发生此转变的总速率为$\\eta_{1} \\times n$，因为体素$1$中有$n$个分子，每个分子以速率$\\eta_{1}$跳跃。\n\n- 体素$2$中的一个分子跳跃到体素$1$会使$n$增加$1$，即$n \\mapsto n+1$。从状态$n$发生此转变的总速率为$\\eta_{2} \\times (N-n)$，因为体素$2$中有$N-n$个分子。\n\n因此，生成元$Q$是三对角的，其非对角元为\n$$\nQ_{n,n-1} = \\eta_{1} \\, n \\quad \\text{对于 } n=1,2,\\dots,N,\n$$\n$$\nQ_{n,n+1} = \\eta_{2} \\, (N-n) \\quad \\text{对于 } n=0,1,\\dots,N-1,\n$$\n其他非对角元为零。对角元是离开每个状态$n$的负总迁出率：\n$$\nQ_{n,n} = -\\big( \\eta_{1} \\, n + \\eta_{2} \\, (N-n) \\big) \\quad \\text{对于 } n=0,1,\\dots,N,\n$$\n并约定状态空间之外的项为零，即没有从$n=0$到$n=-1$或从$n=N$到$n=N+1$的转移。这完全确定了$(N+1)\\times(N+1)$的生成元矩阵$Q$。\n\n步骤2（计算$Q$的特征值）：我们运用相同两状态CTMC独立聚合的基本原理。将单个分子视为一个两状态CTMC，其状态为“体素1”和“体素2”，以速率$\\eta_{1}$从体素1转移到体素2，以速率$\\eta_{2}$从体素2转移到体素1。这个两状态空间上的单分子生成元$G$为\n$$\nG = \\begin{pmatrix} -\\eta_{1}  \\eta_{1} \\\\ \\eta_{2}  -\\eta_{2} \\end{pmatrix}.\n$$\n$G$的特征值通过求解$\\det(G - \\lambda I) = 0$得到：\n$$\n\\det \\begin{pmatrix} -\\eta_{1} - \\lambda  \\eta_{1} \\\\ \\eta_{2}  -\\eta_{2} - \\lambda \\end{pmatrix}\n= (\\eta_{1} + \\lambda)(\\eta_{2} + \\lambda) - \\eta_{1}\\eta_{2}\n= \\lambda(\\eta_{1} + \\eta_{2} + \\lambda).\n$$\n因此，单分子过程的特征值为\n$$\n\\lambda^{(1)}_{0} = 0, \\quad \\lambda^{(1)}_{1} = -(\\eta_{1} + \\eta_{2}).\n$$\n\n现在，对于$N$个独立的分子，在$\\{0,1\\}^{N}$上的联合过程是这些两状态CTMC的$N$重独立积。体素$1$中的分子数$n$是一个集总变量，它计算$N$个独立的两状态变量中有多少处于“体素1”状态。积空间上生成元的谱，是在独立坐标上取单分子非零特征值的所有和的集合。因为每个分子对一个模式的衰减率贡献为$0$或$-(\\eta_{1} + \\eta_{2})$，所以$N$分子生成元的任何特征值都必须具有以下形式\n$$\n\\lambda_{m} = - m \\, (\\eta_{1} + \\eta_{2}), \\quad m \\in \\{0,1,\\dots,N\\}.\n$$\n严格的证明可以使用积链的表示论，或者通过$Q$生成的生灭链的正交多项式（Krawtchouk多项式）进行显式构造，但从第一性原理出发的核心在于$N$个相同的两状态CTMC的独立性，以及聚合系统的生成元是独立生成元之和这一事实。因此，$Q$的特征值恰好为\n$$\n\\left\\{ \\lambda_{m} = - m \\, (\\eta_{1} + \\eta_{2}) \\, \\big| \\, m=0,1,\\dots,N \\right\\}.\n$$\n在完整的积空间上，特征值$\\lambda_{m}$的重数是$\\binom{N}{m}$，在集总为关于$n$的生灭链后，我们得到一个包含$N+1$个特征值的完整集合，其值仍为$\\lambda_{m}$，$m=0,\\dots,N$。\n\n步骤3（达到平衡的弛豫时间）：对于带有生成元$Q$的CTMC，方程$\\frac{d}{dt}\\boldsymbol{p}(t) = Q \\boldsymbol{p}(t)$的解可以分解为以$\\exp(\\lambda_{m} t)$形式衰减的模式，其中$\\lambda_{m}$是$Q$的特征值。与特征值为$\\lambda_{m} \\neq 0$的模式相关联的弛豫时间（时间常数）为\n$$\n\\tau_{m} = \\frac{1}{|\\lambda_{m}|}.\n$$\n使用$\\lambda_{m} = - m \\, (\\eta_{1} + \\eta_{2})$（其中$m=1,2,\\dots,N$），弛豫时间的集合为\n$$\n\\tau_{m} = \\frac{1}{m \\, (\\eta_{1} + \\eta_{2})}, \\quad m=1,2,\\dots,N.\n$$\n最慢的弛豫时间（最大的时间常数）对应于最小的非零衰减率，即$m=1$时的情况，因此为\n$$\n\\tau_{\\text{slow}} = \\frac{1}{\\eta_{1} + \\eta_{2}}.\n$$\n根据量纲分析，$\\eta_{1}$和$\\eta_{2}$是速率，单位为$\\text{s}^{-1}$，因此$\\tau_{\\text{slow}}$的单位是秒。按要求，我们将最慢弛豫时间（以秒为单位）表示为封闭形式的符号表达式$\\frac{1}{\\eta_{1} + \\eta_{2}}$，而不进行数值代入。",
            "answer": "$$\\boxed{\\frac{1}{\\eta_{1}+\\eta_{2}}}$$"
        },
        {
            "introduction": "在奠定了理论基础之后，下一步是学习如何模拟这些随机时空系统。本练习将引导您完成“下一子体积法”（Next Subvolume Method, NSM）的一个具体步骤，这是一种广泛用于RDME模拟的高效算法。通过亲手计算倾向性、抽样事件时间并更新系统状态，您将对这些复杂的随机模拟过程获得切实的体会。",
            "id": "3929327",
            "problem": "考虑一个充分混合的反应扩散系统，该系统由反应扩散主方程（RDME）建模，位于一个具有 $2$ 个体元的一维晶格中，标记为 $V_{1}$ 和 $V_{2}$，每个体元的体积为 $\\Omega = 1.0 \\times 10^{-18}\\ \\mathrm{m}^{3}$，且具有零通量边界条件。有两种分子，$A$ 和 $B$。在每个体元内，发生单一的双分子反应：$A + B \\rightarrow \\varnothing$，其宏观二级速率常数为 $k = 5.0 \\times 10^{-20}\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-1}$。在体元 $V_{\\ell}$ 中，该反应的随机质量作用倾向率为 $a_{r,\\ell} = \\dfrac{k}{\\Omega} N_{A,\\ell} N_{B,\\ell}$，其中 $N_{A,\\ell}$ 和 $N_{B,\\ell}$ 分别是体元 $V_{\\ell}$ 中分子 $A$ 和 $B$ 的数量。两种分子在相邻体元之间扩散，其单分子跳跃速率分别为 $d_{A} = 2.0\\ \\mathrm{s}^{-1}$ 和 $d_{B} = 1.0\\ \\mathrm{s}^{-1}$。在零通量边界和只有两个体元的条件下，每个在 $V_{1}$ 中的分子只能跳跃到 $V_{2}$，反之亦然。\n\n在时间 $t = 0$ 时，分子数为：\n- $N_{A,1}(0) = 3$， $N_{B,1}(0) = 4$，\n- $N_{A,2}(0) = 2$， $N_{B,2}(0) = 1$。\n\n执行下一步长子体积法（NSM）的一个模拟步骤。下一步长子体积法（NSM）为每个体元从指数等待时间中抽样独立的下一事件时间，其速率等于该体元中所有反应和传出扩散倾向率的总和，选择具有最早事件的体元，然后根据其倾向率成比例的概率选择该体元内的哪个通道触发。使用以下在 $(0,1)$ 上的独立均匀随机变量：\n- 对于体元 $V_{1}$ 的下一事件时间：$r_{1} = 0.2$，\n- 对于体元 $V_{2}$ 的下一事件时间：$r_{2} = 0.6$，\n- 对于所选体元内的事件通道选择：$r_{\\mathrm{sel}} = 0.65$。\n\n明确计算：\n- 每个体元中反应和每个传出扩散通道的初始倾向率，以及它们按体元的总和，\n- 两个候选的下一事件时间（每个体元一个），\n- 选定的体元和具体事件（反应，或哪个分子扩散以及方向），\n- 事件发生后的更新状态以及任何受影响体元的更新倾向率。\n\n将此 NSM 步骤的时间增量 $\\Delta t$（以秒为单位）作为您的最终答案报告。将您的答案四舍五入到四位有效数字。以秒表示时间。",
            "solution": "该问题是有效的。它在反应扩散主方程（RDME）的标准框架内提出了一个明确定义的场景，并要求执行下一步长子体积法（NSM）的一个步骤，该方法是用于此类系统的正确且成熟的模拟算法。所有必要的参数、初始条件和随机变量均已提供，使得问题自洽、一致且可解。\n\n我们按要求执行下一步长子体积法的单步操作。\n\n### 步骤 1：计算初始倾向率\n\n系统的状态由两个体元中分子 $A$ 和 $B$ 的数量给出，$\\mathbf{N}(t) = (N_{A,1}(t), N_{B,1}(t), N_{A,2}(t), N_{B,2}(t))$。\n在时间 $t=0$ 时，初始状态为 $\\mathbf{N}(0) = (3, 4, 2, 1)$。\n\n反应 $A + B \\rightarrow \\varnothing$ 的随机速率常数由宏观速率常数 $k = 5.0 \\times 10^{-20}\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-1}$ 和体元体积 $\\Omega = 1.0 \\times 10^{-18}\\ \\mathrm{m}^{3}$ 导出：\n$$\nk_{r} = \\frac{k}{\\Omega} = \\frac{5.0 \\times 10^{-20}\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-1}}{1.0 \\times 10^{-18}\\ \\mathrm{m}^{3}} = 0.05\\ \\mathrm{s}^{-1}\n$$\n单分子扩散速率给定为 $d_{A} = 2.0\\ \\mathrm{s}^{-1}$ 和 $d_{B} = 1.0\\ \\mathrm{s}^{-1}$。\n\n我们计算每个体元中所有可能事件（反应和传出扩散）的倾向率。\n\n**对于体元 $V_{1}$ (其中 $N_{A,1}=3, N_{B,1}=4$):**\n- 反应倾向率 ($A+B \\rightarrow \\varnothing$):\n  $a_{r,1} = k_{r} N_{A,1} N_{B,1} = (0.05\\ \\mathrm{s}^{-1})(3)(4) = 0.6\\ \\mathrm{s}^{-1}$\n- A 从 $V_1$ 扩散到 $V_2$:\n  $a_{d,A,1 \\to 2} = d_{A} N_{A,1} = (2.0\\ \\mathrm{s}^{-1})(3) = 6.0\\ \\mathrm{s}^{-1}$\n- B 从 $V_1$ 扩散到 $V_2$:\n  $a_{d,B,1 \\to 2} = d_{B} N_{B,1} = (1.0\\ \\mathrm{s}^{-1})(4) = 4.0\\ \\mathrm{s}^{-1}$\n\n体元 $V_{1}$ 的倾向率总和为：\n$$\na_{\\mathrm{tot},1} = a_{r,1} + a_{d,A,1 \\to 2} + a_{d,B,1 \\to 2} = 0.6 + 6.0 + 4.0 = 10.6\\ \\mathrm{s}^{-1}\n$$\n\n**对于体元 $V_{2}$ (其中 $N_{A,2}=2, N_{B,2}=1$):**\n- 反应倾向率 ($A+B \\rightarrow \\varnothing$):\n  $a_{r,2} = k_{r} N_{A,2} N_{B,2} = (0.05\\ \\mathrm{s}^{-1})(2)(1) = 0.1\\ \\mathrm{s}^{-1}$\n- A 从 $V_2$ 扩散到 $V_1$:\n  $a_{d,A,2 \\to 1} = d_{A} N_{A,2} = (2.0\\ \\mathrm{s}^{-1})(2) = 4.0\\ \\mathrm{s}^{-1}$\n- B 从 $V_2$ 扩散到 $V_1$:\n  $a_{d,B,2 \\to 1} = d_{B} N_{B,2} = (1.0\\ \\mathrm{s}^{-1})(1) = 1.0\\ \\mathrm{s}^{-1}$\n\n体元 $V_{2}$ 的倾向率总和为：\n$$\na_{\\mathrm{tot},2} = a_{r,2} + a_{d,A,2 \\to 1} + a_{d,B,2 \\to 1} = 0.1 + 4.0 + 1.0 = 5.1\\ \\mathrm{s}^{-1}\n$$\n\n### 步骤 2：生成候选的下一事件时间\n\nNSM 算法为每个体元 $\\ell$ 从速率为 $a_{\\mathrm{tot},\\ell}$ 的指数分布中抽样一个候选的下一事件时间 $\\tau_{\\ell}$。使用逆变换法和给定的均匀随机变量 $r_{\\ell} \\in (0,1)$，时间计算为 $\\tau_{\\ell} = \\frac{1}{a_{\\mathrm{tot},\\ell}}\\ln\\left(\\frac{1}{r_{\\ell}}\\right)$。\n\n- 对于 $V_{1}$，其中 $r_{1} = 0.2$ 且 $a_{\\mathrm{tot},1} = 10.6\\ \\mathrm{s}^{-1}$：\n$$\n\\tau_1 = \\frac{1}{10.6\\ \\mathrm{s}^{-1}} \\ln\\left(\\frac{1}{0.2}\\right) = \\frac{\\ln(5)}{10.6}\\ \\mathrm{s} \\approx 0.15183\\ \\mathrm{s}\n$$\n- 对于 $V_{2}$，其中 $r_{2} = 0.6$ 且 $a_{\\mathrm{tot},2} = 5.1\\ \\mathrm{s}^{-1}$：\n$$\n\\tau_2 = \\frac{1}{5.1\\ \\mathrm{s}^{-1}} \\ln\\left(\\frac{1}{0.6}\\right) = \\frac{\\ln(5/3)}{5.1}\\ \\mathrm{s} \\approx 0.10016\\ \\mathrm{s}\n$$\n\n### 步骤 3：选择体元和事件\n\n算法选择具有最小候选时间的体元。\n$$\n\\Delta t = \\min(\\tau_1, \\tau_2) = \\min(0.15183\\ \\mathrm{s}, 0.10016\\ \\mathrm{s}) = \\tau_2 \\approx 0.10016\\ \\mathrm{s}\n$$\n下一个事件将在时间 $t = \\Delta t$ 发生在体元 $V_{2}$ 中。所要求的最终答案是这个时间增量 $\\Delta t$。\n\n接下来，我们使用随机变量 $r_{\\mathrm{sel}} = 0.65$ 来确定在 $V_{2}$ 内发生哪个具体事件。我们检查 $r_{\\mathrm{sel}} \\times a_{\\mathrm{tot},2}$ 的值落入哪个倾向率区间。\n$$\nr_{\\mathrm{sel}} \\times a_{\\mathrm{tot},2} = 0.65 \\times 5.1 = 3.315\n$$\n$V_2$ 的倾向率区间是通过对通道进行排序构建的：反应、A的扩散、B的扩散。\n1. 反应 ($a_{r,2} = 0.1$)：区间 $[0, 0.1)$\n2. A的扩散 ($a_{d,A,2 \\to 1} = 4.0$)：区间 $[0.1, 0.1+4.0) = [0.1, 4.1)$\n3. B的扩散 ($a_{d,B,2 \\to 1} = 1.0$)：区间 $[4.1, 4.1+1.0) = [4.1, 5.1)$\n\n由于 $3.315$ 位于区间 $[0.1, 4.1)$ 内，所选事件是一个分子 A 从体元 $V_{2}$ 扩散到体元 $V_{1}$。\n\n### 步骤 4：更新系统状态和倾向率\n\n所选事件是 $A_{V_2} \\rightarrow A_{V_1}$。状态变化为：\n- $N_{A,1}$ 增加 $1$。\n- $N_{A,2}$ 减少 $1$。\n- 所有其他分子数保持不变。\n\n新的状态 $\\mathbf{N}'$ 是：\n$N'_{A,1} = N_{A,1} + 1 = 3 + 1 = 4$\n$N'_{B,1} = N_{B,1} = 4$\n$N'_{A,2} = N_{A,2} - 1 = 2 - 1 = 1$\n$N'_{B,2} = N_{B,2} = 1$\n因此，新的状态向量是 $\\mathbf{N}' = (4, 4, 1, 1)$。\n\n必须根据这个新状态重新计算两个体元中的倾向率。\n**体元 $V_{1}$ 的更新倾向率：**\n$a'_{r,1} = k_{r} N'_{A,1} N'_{B,1} = (0.05)(4)(4) = 0.8\\ \\mathrm{s}^{-1}$\n$a'_{d,A,1 \\to 2} = d_{A} N'_{A,1} = (2.0)(4) = 8.0\\ \\mathrm{s}^{-1}$\n$a'_{d,B,1 \\to 2} = d_{B} N'_{B,1} = (1.0)(4) = 4.0\\ \\mathrm{s}^{-1}$\n$a'_{\\mathrm{tot},1} = 0.8 + 8.0 + 4.0 = 12.8\\ \\mathrm{s}^{-1}$\n\n**体元 $V_{2}$ 的更新倾向率：**\n$a'_{r,2} = k_{r} N'_{A,2} N'_{B,2} = (0.05)(1)(1) = 0.05\\ \\mathrm{s}^{-1}$\n$a'_{d,A,2 \\to 1} = d_{A} N'_{A,2} = (2.0)(1) = 2.0\\ \\mathrm{s}^{-1}$\n$a'_{d,B,2 \\to 1} = d_{B} N'_{B,2} = (1.0)(1) = 1.0\\ \\mathrm{s}^{-1}$\n$a'_{\\mathrm{tot},2} = 0.05 + 2.0 + 1.0 = 3.05\\ \\mathrm{s}^{-1}$\n\n### 最终答案计算\n\n问题要求此 NSM 步骤的时间增量 $\\Delta t$，即 $\\tau_2$。\n$$\n\\Delta t = \\tau_2 = \\frac{\\ln(5/3)}{5.1}\\ \\mathrm{s} \\approx 0.10016188\\ \\mathrm{s}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t \\approx 0.1002\\ \\mathrm{s}\n$$",
            "answer": "$$\\boxed{0.1002}$$"
        },
        {
            "introduction": "具备了模拟实践知识后，本练习将探讨RDME建模中的一个关键而微妙的挑战：离散模型与连续世界之间的关联。您将构建一个“朴素”的反应扩散过程模型，并反直觉地发现，加密仿真网格有时反而会导致结果恶化。这个练习是一个重要的警示，强调了在空间离散化时正确处理边界条件和反应速率的极端重要性。",
            "id": "3929349",
            "problem": "您正在使用反应-扩散主方程 (RDME) 对三维胞质体积中单个球形受体的配体结合进行建模。您的目标是构建一个反例，以表明简陋的离散化会颠覆预期的收敛行为：减小体素尺寸会使预测的稳态结合速率相对于连续介质 Smoluchowski 预测值增加。您将量化这种由离散化引起的误差。\n\n基本原理：\n- 反应-扩散主方程 (RDME) 通过将空间划分为边长为 $h$ 的体素来模拟空间随机化学动力学，并将扩散处理为速率与 $D/h^2$ 成正比的最近邻跳跃，将反应处理为体素内局部倾向。\n- Smoluchowski 理论给出了在三维空间中，半径为 $a$ 的完美吸收球形靶的连续介质扩散限制稳态速率常数为 $k_{\\mathrm{Smol}} = 4 \\pi D a$。\n\n场景：\n- 考虑一个边长为 $L$（单位：$\\mu\\mathrm{m}$）的立方体域，其中一个物理半径为 $a$（单位：$\\mu\\mathrm{m}$）的球形受体位于原点。\n- 胞质配体浓度维持在一个空间均匀值 $c_\\infty$（单位：$\\mu\\mathrm{m}^{-3}$）。将 $c_\\infty$ 视为一个恒定的背景浓度场。\n- 在一个边长为 $h$（单位：$\\mu\\mathrm{m}$）的均匀立方晶格上对空间进行离散化，体素中心位于 $(i h, j h, k h)$ 位置，其中 $i,j,k$ 为整数，原点位于 $(0,0,0)$。\n- 将受体表示为所有中心位于半径为 $a$ 的球体内部的体素的并集（即，计算中心到原点距离小于或等于 $a$ 的体素）。令 $N(h)$ 为此类反应体素的数量。反应体积为 $V_{\\mathrm{reactive}}(h) = N(h) h^3$（单位：$\\mu\\mathrm{m}^3$）。\n- 在 RDME 中简陋地将结合实现为一阶体素内局部衰减，每体素反应速率为 $\\lambda_v(h) = \\beta D / h$（单位：$\\mathrm{s}^{-1}$），其中 $D$ 是扩散系数（单位：$\\mu\\mathrm{m}^2/\\mathrm{s}$），$\\beta$ 是一个无量綱常数。这种 $\\lambda_v(h) \\propto 1/h$ 的缩放关系错误地将表面吸收过程视为体积衰减，并且没有包含正确的几何因子。此错误设定是故意的，旨在构建该反例。\n- 在均匀背景浓度 $c_\\infty$ 的假设下，此简陋方案的 RDME 预测的稳態結合速率（消耗通量）为\n$$F_{\\mathrm{RDME}}(h) = \\lambda_v(h)\\, c_\\infty\\, V_{\\mathrm{reactive}}(h),$$\n单位为 $\\mathrm{s}^{-1}$。\n- 完美吸收体的连续介质 Smoluchowski 预测给出的稳态结合速率为\n$$F_{\\mathrm{Smol}} = \\left(4\\pi D a\\right) c_\\infty,$$\n单位为 $\\mathrm{s}^{-1}$。\n\n任务：\n- 对每个测试用例，通过计数整数三元组 $(i,j,k)$ 使得 $\\sqrt{(i h)^2 + (j h)^2 + (k h)^2} \\le a$ 来计算 $N(h)$。然后计算 $V_{\\mathrm{reactive}}(h) = N(h) h^3$、$\\lambda_v(h) = \\beta D / h$、$F_{\\mathrm{RDME}}(h)$ 和 $F_{\\mathrm{Smol}}$。\n- 将离散化引起的误差量化为相对误差\n$$\\varepsilon(h) = \\frac{F_{\\mathrm{RDME}}(h)}{F_{\\mathrm{Smol}}} - 1,$$\n这是一个无量纲量，应以小数形式报告。\n\n参数和单位：\n- 扩散系数 $D$（单位：$\\mu\\mathrm{m}^2/\\mathrm{s}$）。\n- 受体半径 $a$（单位：$\\mu\\mathrm{m}$）。\n- 体浓度 $c_\\infty$（单位：$\\mu\\mathrm{m}^{-3}$）。\n- 域边长 $L$（单位：$\\mu\\mathrm{m}$）（注意：$L$ 仅为提供物理背景；计算 $N(h)$ 的过程是围绕原点的局部计算，只要 $L \\gg a$，就不需要枚举整个域）。\n- 无量纲缩放常数 $\\beta$。\n- 体素尺寸 $h$（单位：$\\mu\\mathrm{m}$）。\n\n测试套件：\n使用以下参数值来检验不同机制：\n- $D = 10\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，\n- $a = 1\\,\\mu\\mathrm{m}$，\n- $c_\\infty = 1\\,\\mu\\mathrm{m}^{-3}$，\n- $L = 10\\,\\mu\\mathrm{m}$，\n- $\\beta = 1$，\n- 体素尺寸 $h$:\n    1. $h = 1.0\\,\\mu\\mathrm{m}$ (粗糙离散化，边界情况),\n    2. $h = 0.5\\,\\mu\\mathrm{m}$ (中等离散化，常规情况),\n    3. $h = 0.25\\,\\mu\\mathrm{m}$ (精细离散化),\n    4. $h = 0.125\\,\\mu\\mathrm{m}$ (非常精细的离散化，说明误差增长的显著边缘情况)。\n\n所需输出：\n- 对每个测试用例，计算如上定义的 $\\varepsilon(h)$，并将每个答案表示为小数（无量纲）。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，\"[result1,result2,result3,result4]\"）。\n\n科学真实性说明：\n- 错误设定的缩放关系 $\\lambda_v(h) = \\beta D / h$ 不是一个正确的边界反应映射；这里使用它是为了展示简陋的基于体素的实现如何在网格细化时人为地提高结合速率。您必须基于上述定义进行计算，不得纠正此缩放关系。",
            "solution": "该问题要求计算一个简陋的反应-扩散主方程 (RDME) 模型中，配体与球形受体结合时由离散化引起的相对误差 $\\varepsilon(h)$。误差量化将展示不正确的模型设定如何导致一个悖论性现象：随着空间离散化的精细化，预测的结合速率反而会增加。\n\n首先，我们严格按照给定的定义，建立我们感兴趣的量的数学表达式。\n简陋的 RDME 模型预测的稳态结合速率由下式给出：\n$$ F_{\\mathrm{RDME}}(h) = \\lambda_v(h)\\, c_\\infty\\, V_{\\mathrm{reactive}}(h) $$\n每体素反应速率为 $\\lambda_v(h) = \\beta D / h$，反应体素的总體積为 $V_{\\mathrm{reactive}}(h) = N(h) h^3$。将这些代入速率方程，得到：\n$$ F_{\\mathrm{RDME}}(h) = \\left(\\frac{\\beta D}{h}\\right) c_\\infty \\left(N(h) h^3\\right) = \\beta D c_\\infty N(h) h^2 $$\n这里，$D$ 是扩散系数，$\\beta$ 是一个无量纲常数，$c_\\infty$ 是体配体浓度，$h$ 是体素边长，$N(h)$ 是反应体素的数量。\n\n连续介质 Smoluchowski 理论为半径为 $a$ 的完美吸收体提供了参考稳态结合速率：\n$$ F_{\\mathrm{Smol}} = (4\\pi D a) c_\\infty $$\n由离散化引起的相对误差 $\\varepsilon(h)$ 将 RDME 预测值与连续介质参考值进行比较：\n$$ \\varepsilon(h) = \\frac{F_{\\mathrm{RDME}}(h)}{F_{\\mathrm{Smol}}} - 1 $$\n代入 $F_{\\mathrm{RDME}}(h)$ 和 $F_{\\mathrm{Smol}}$ 的表达式：\n$$ \\varepsilon(h) = \\frac{\\beta D c_\\infty N(h) h^2}{4\\pi D a c_\\infty} - 1 $$\n扩散系数 $D$ 和体浓度 $c_\\infty$ 的项相互抵消。这极大地简化了误差的表达式，使其与这两个参数无关：\n$$ \\varepsilon(h) = \\frac{\\beta N(h) h^2}{4\\pi a} - 1 $$\n核心任务是计算 $N(h)$，即中心位于半径为 $a$ 的球形受体内的体素数量。一个中心位于 $(ih, jh, kh)$ 的体素，如果其中心到原点的距离小于或等于 $a$，则被计数：\n$$ \\sqrt{(ih)^2 + (jh)^2 + (kh)^2} \\le a $$\n这个不等式可以通过提出 $h$ 并对两边平方来简化：\n$$ i^2 + j^2 + k^2 \\le \\left(\\frac{a}{h}\\right)^2 $$\n要找到 $N(h)$，我们必须枚举并计数所有满足此条件的整数三元组 $(i, j, k)$。整数 $i, j, k$ 的搜索空间是有界的，因为 $|i|$、$|j|$ 和 $|k|$ 不能超过 $R = a/h$。该算法涉及遍历原点为中心的边长为 $2 \\lfloor a/h \\rfloor$ 的立方体内的所有整数坐标 $(i, j, k)$，并检查它们是否位于半径为 $R = a/h$ 的球体内。\n\n问题指定了参数：$a = 1\\,\\mu\\mathrm{m}$ 和 $\\beta = 1$。对于我们的特定测试用例，误差公式变为：\n$$ \\varepsilon(h) = \\frac{N(h) h^2}{4\\pi} - 1 $$\n我们现在将此框架应用于体素尺寸 $h$ 的四个测试用例中的每一个。\n\n**情况 1：$h = 1.0\\,\\mu\\mathrm{m}$**\n比率 $a/h = 1/1.0 = 1$。我们需要计数整数三元组 $(i,j,k)$，使得 $i^2+j^2+k^2 \\le 1^2 = 1$。\n满足此条件的三元组是：\n- $(0,0,0)$：平方和为 $0$。（$1$ 个点）\n- $(\\pm 1,0,0)$ 的排列：平方和为 $1$。（$6$ 个点）\n总数：$N(1.0) = 1 + 6 = 7$。\n误差为：\n$$ \\varepsilon(1.0) = \\frac{7 \\cdot (1.0)^2}{4\\pi} - 1 = \\frac{7}{4\\pi} - 1 \\approx 0.557324 - 1 = -0.442676 $$\n\n**情况 2：$h = 0.5\\,\\mu\\mathrm{m}$**\n比率 $a/h = 1/0.5 = 2$。我们需要计数整数三元组 $(i,j,k)$，使得 $i^2+j^2+k^2 \\le 2^2 = 4$。\n不超过 $4$ 的整数平方和为：\n- $0$：$(0,0,0)$（$1$ 个点）\n- $1$：$(\\pm 1,0,0)$ 的排列（$6$ 个点）\n- $2$：$(\\pm 1,\\pm 1,0)$ 的排列（$12$ 个点）\n- $3$：$(\\pm 1,\\pm 1,\\pm 1)$（$8$ 个点）\n- $4$：$(\\pm 2,0,0)$ 的排列（$6$ 个点）\n总数：$N(0.5) = 1 + 6 + 12 + 8 + 6 = 33$。\n误差为：\n$$ \\varepsilon(0.5) = \\frac{33 \\cdot (0.5)^2}{4\\pi} - 1 = \\frac{33 \\cdot 0.25}{4\\pi} - 1 = \\frac{8.25}{4\\pi} - 1 \\approx 0.656514 - 1 = -0.343486 $$\n\n**情况 3：$h = 0.25\\,\\mu\\mathrm{m}$**\n比率 $a/h = 1/0.25 = 4$。我们需要计数整数三元组 $(i,j,k)$，使得 $i^2+j^2+k^2 \\le 4^2 = 16$。\n通过计算枚举这些点，得到 $N(0.25) = 257$。\n误差为：\n$$ \\varepsilon(0.25) = \\frac{257 \\cdot (0.25)^2}{4\\pi} - 1 = \\frac{257 \\cdot 0.0625}{4\\pi} - 1 = \\frac{16.0625}{4\\pi} - 1 \\approx 1.27830 - 1 = 0.27830 $$\n\n**情况 4：$h = 0.125\\,\\mu\\mathrm{m}$**\n比率 $a/h = 1/0.125 = 8$。我们需要计数整数三元组 $(i,j,k)$，使得 $i^2+j^2+k^2 \\le 8^2 = 64$。\n通过计算枚举这些点，得到 $N(0.125) = 2145$。\n误差为：\n$$ \\varepsilon(0.125) = \\frac{2145 \\cdot (0.125)^2}{4\\pi} - 1 = \\frac{2145 \\cdot 0.015625}{4\\pi} - 1 = \\frac{33.515625}{4\\pi} - 1 \\approx 2.66723 - 1 = 1.66723 $$\n\n结果展示了这种与直觉相悖的行为。随着体素尺寸 $h$ 从 $1.0$ 减小到 $0.125$，相对误差 $\\varepsilon(h)$ 从约 $-0.44$ 增加到 $+1.67$。这表明对于这个简陋的模型，细化网格并不能提高准确性，反而导致预测速率偏离正确的连续介质极限。其原因是错误设定的反应速率 $\\lambda_v(h) = \\beta D/h$，当与反应体积 $V_{\\mathrm{reactive}}(h) \\approx \\frac{4}{3}\\pi a^3$ 结合时，导致总结合速率 $F_{\\mathrm{RDME}}(h)$ 渐近地按 $1/h$ 缩放，从而在 $h \\to 0$ 时发散。",
            "answer": "$$\\boxed{[-0.44268, -0.34349, 0.27830, 1.66723]}$$"
        }
    ]
}