{
    "hands_on_practices": [
        {
            "introduction": "要理解基因开关这类复杂系统的行为，最佳起点通常是简化模型。本练习  将引导你完成无量纲化，这是一种将微分方程组提炼为其核心无量纲参数的强大技术。通过这项实践，你将更深刻地领悟反馈强度和时间尺度分离如何共同促成双稳态行为，这是分析表观遗传记忆的关键第一步。",
            "id": "3932577",
            "problem": "考虑一个由两个转录因子 $A$ 和 $B$ 实现的相互抑制的遗传拨动开关，其中每个因子都抑制另一个因子的转录。假设基于与启动子调控的热力学模型一致的平衡结合占有率，存在标准的质量作用降解和希尔型转录抑制。令 $A(t)$ 和 $B(t)$ 表示在时间 $t$ 时两种蛋白质的浓度。该有量纲模型由以下耦合常微分方程（ODE）给出：\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{\\alpha_{A}}{1 + \\left(\\frac{B}{K_{B}}\\right)^{n}} \\;-\\; \\delta_{A} A\n\\qquad\\text{和}\\qquad\n\\frac{dB}{dt} \\;=\\; \\frac{\\alpha_{B}}{1 + \\left(\\frac{A}{K_{A}}\\right)^{m}} \\;-\\; \\delta_{B} B,\n$$\n其中，$\\alpha_{A}$ 和 $\\alpha_{B}$ 是由转录和翻译动力学决定的最大（去抑制）生产速率，$K_{A}$ 和 $K_{B}$ 是为 $A$ 和 $B$ 设定特征抑制阈值的结合常数，$m$ 和 $n$ 是反映抑制子结合协同性的希尔系数，$\\delta_{A}$ 和 $\\delta_{B}$ 是一阶降解/稀释速率。在此背景下，表观遗传稳定状态之间的随机切换源于作用在确定性双稳态骨架上的噪声；因此，控制反馈强度和时间尺度分离的无量纲群对于解释记忆和切换现象至关重要。\n\n从上述有量纲模型出发，并仅使用可从模型参数推导出的尺度，对系统进行无量纲化，以将其简化为一组最小的无量纲参数。您的构建应基于与 $K_{A}$ 和 $K_{B}$ 相关的浓度尺度以及与 $\\delta_{A}$ 相关的时间尺度。推导无量纲常微分方程，并确定在无量纲化后能完全表征动力学的最小独立无量纲参数群集。为每个无量纲群提供一个简洁且有物理依据的解释，说明其在反馈强度、非线性和与表观遗传记忆及随机切换相关的时间尺度分离方面的意义。\n\n将您的最终结果表示为一个行矩阵，按 $\\left(A\\text{的反馈强度},\\; B\\text{的反馈强度},\\; \\text{时间尺度比},\\; m,\\; n\\right)$ 的顺序列出无量纲参数群。最终答案必须是单一的解析表达式。不需要进行数值计算或四舍五入。",
            "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知信息**\n先验信息包括一个关于蛋白质 $A(t)$ 和 $B(t)$ 浓度的双耦合常微分方程（ODE）系统：\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{\\alpha_{A}}{1 + \\left(\\frac{B}{K_{B}}\\right)^{n}} \\;-\\; \\delta_{A} A\n$$\n$$\n\\frac{dB}{dt} \\;=\\; \\frac{\\alpha_{B}}{1 + \\left(\\frac{A}{K_{A}}\\right)^{m}} \\;-\\; \\delta_{B} B\n$$\n参数定义如下：\n- $\\alpha_{A}, \\alpha_{B}$：最大生产速率。\n- $K_{A}, K_{B}$：结合常数（抑制阈值）。\n- $m, n$：希尔系数（协同性）。\n- $\\delta_{A}, \\delta_{B}$：一阶降解/稀释速率。\n\n无量纲化的指令是使用与 $K_{A}$ 和 $K_{B}$ 相关的浓度尺度，以及与 $\\delta_{A}$ 相关的时间尺度。\n\n**步骤2：使用提取的已知信息进行验证**\n- **科学依据**：该模型是典型的 Gardner-Collins 拨动开关，是合成生物学中的一个基础模型。使用希尔函数模拟协同抑制和一阶降解项在生物化学动力学中是标准且成熟的方法。该问题牢固地建立在公认的科学原理之上。\n- **适定性**：任务是进行无量纲化，这是一个标准的数学过程。选择尺度的指令是明确的，确保推导过程能得到唯一的结果。该问题是适定的。\n- **客观性**：问题以精确的数学和科学语言陈述，没有歧义或主观论断。\n- **完整性和一致性**：提供了所有必要的方程和参数。尺度规则定义清晰。不存在矛盾。\n- **其他缺陷**：该问题并非微不足道，因为它需要仔细的代数操作和物理解释。这是生物学中动力系统分析的一个标准且有意义的练习。\n\n**步骤3：结论与行动**\n该问题是有效的，因为它科学上合理、适定、客观且完整。将提供完整解答。\n\n为使系统无量纲化，我们根据问题陈述中指定的尺度引入浓度和时间的无量纲变量。抑制的特征浓度是 $K_A$ 和 $K_B$，特征时间尺度是蛋白质A的寿命，即 $1/\\delta_A$。\n\n我们定义无量纲浓度 $a$ 和 $b$ 以及无量纲时间 $\\tau$ 如下：\n$$\na = \\frac{A}{K_A}, \\qquad b = \\frac{B}{K_B}, \\qquad \\tau = t \\delta_A\n$$\n根据这些定义，我们可以用新的无量纲变量来表示原始变量及其导数：\n$$\nA = K_A a, \\qquad B = K_B b, \\qquad t = \\frac{\\tau}{\\delta_A}\n$$\n时间导数根据链式法则进行变换：\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau} = \\delta_A \\frac{d}{d\\tau}\n$$\n现在，我们可以将这些代入原始的常微分方程中。\n\n对于控制 $A(t)$ 的方程：\n$$\n\\frac{d(K_A a)}{dt} = \\frac{\\alpha_{A}}{1 + \\left(\\frac{K_B b}{K_{B}}\\right)^{n}} - \\delta_{A} (K_A a)\n$$\n应用变换后的时间导数：\n$$\nK_A \\frac{da}{dt} = K_A \\delta_A \\frac{da}{d\\tau} = \\frac{\\alpha_{A}}{1 + b^{n}} - \\delta_A K_A a\n$$\n将整个方程除以 $K_A \\delta_A$ 以分离出无量纲导数 $\\frac{da}{d\\tau}$：\n$$\n\\frac{da}{d\\tau} = \\frac{\\alpha_A}{K_A \\delta_A} \\frac{1}{1 + b^n} - a\n$$\n这就得到了第一个无量纲方程。\n\n对于控制 $B(t)$ 的方程：\n$$\n\\frac{d(K_B b)}{dt} = \\frac{\\alpha_{B}}{1 + \\left(\\frac{K_A a}{K_{A}}\\right)^{m}} - \\delta_{B} (K_B b)\n$$\n应用变换后的时间导数：\n$$\nK_B \\frac{db}{dt} = K_B \\delta_A \\frac{db}{d\\tau} = \\frac{\\alpha_{B}}{1 + a^{m}} - \\delta_B K_B b\n$$\n将整个方程除以 $K_B \\delta_A$：\n$$\n\\frac{db}{d\\tau} = \\frac{\\alpha_B}{K_B \\delta_A} \\frac{1}{1 + a^m} - \\frac{\\delta_B}{\\delta_A} b\n$$\n这就得到了第二个无量纲方程。\n\n现在，系统动力学由一组最小的独立无量纲参数群控制。我们必须识别这些群并提供物理解释。出现的参数是 $\\frac{\\alpha_A}{K_A \\delta_A}$，$\\frac{\\alpha_B}{K_B \\delta_A}$，$\\frac{\\delta_B}{\\delta_A}$，$m$ 和 $n$。为了获得更对称和物理上更直观的表示，我们可以定义核心的反馈强度和时间尺度比。\n\n1.  **A的反馈强度**：参数群 $\\frac{\\alpha_A}{K_A \\delta_A}$。我们称之为 $\\gamma_A$。项 $\\alpha_A / \\delta_A$ 表示 A 可能的最大稳态浓度（当 $B=0$ 时）。因此，$\\gamma_A = \\frac{\\alpha_A/\\delta_A}{K_A}$ 是 A 的最大稳态浓度与它自身对 B 启动子的抑制常数之比。它是反馈回路增益的无量纲度量。为了实现双稳态，该值必须足够大于 $1$。\n\n2.  **B的反馈强度**：根据对称性，B 的反馈强度应定义为 $\\gamma_B = \\frac{\\alpha_B/\\delta_B}{K_B}$。这是 B 的最大稳态浓度与其抑制常数 $K_B$ 之比。该参数为电路中 B 生产部分的增益提供了最直接的物理解释。\n\n3.  **时间尺度比**：参数群 $\\frac{\\delta_B}{\\delta_A}$。我们称之为 $\\delta$。这是 B 的降解/稀释速率与 A 的降解/稀释速率之比。它量化了两种蛋白质动力学之间的时间尺度分离。如果 $\\delta \\neq 1$，则一种蛋白质比另一种更稳定，这会影响状态间切换的路径和速度。\n\n4.  **希尔系数**：$m$ 和 $n$ 本身就是无量纲的，分别表示 A 抑制基因 B 和 B 抑制基因 A 的协同程度。它们控制着抑制响应的超敏性或陡峭度，这对于创建双稳态开关至关重要。\n\n这五个独立的无量纲参数群是 $\\{\\gamma_A, \\gamma_B, \\delta, m, n\\}$。我们可以用这组参数重写第二个无量纲常微分方程。系数 $\\frac{\\alpha_B}{K_B \\delta_A}$ 可以表示为：\n$$\n\\frac{\\alpha_B}{K_B \\delta_A} = \\left(\\frac{\\alpha_B}{K_B \\delta_B}\\right) \\left(\\frac{\\delta_B}{\\delta_A}\\right) = \\gamma_B \\delta\n$$\n因此，最终的无量纲常微分方程系统是：\n$$\n\\frac{da}{d\\tau} = \\gamma_A \\frac{1}{1 + b^n} - a\n$$\n$$\n\\frac{db}{d\\tau} = \\gamma_B \\delta \\frac{1}{1 + a^m} - \\delta b = \\delta \\left( \\gamma_B \\frac{1}{1 + a^m} - b \\right)\n$$\n拨动开关的动力学完全由所确定的五个无量纲参数决定：$\\gamma_A = \\frac{\\alpha_A}{K_A \\delta_A}$，$\\gamma_B = \\frac{\\alpha_B}{K_B \\delta_B}$，$\\delta = \\frac{\\delta_B}{\\delta_A}$，$m$ 和 $n$。按要求的顺序排列，这些参数构成了最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha_{A}}{K_{A} \\delta_{A}} & \\frac{\\alpha_{B}}{K_{B} \\delta_{B}} & \\frac{\\delta_{B}}{\\delta_{A}} & m & n\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在建立了简化模型之后，下一步是描绘其确定性行为的蓝图。本动手实践  介绍线性稳定性分析——动力系统理论的基石——用于寻找和分类系统的稳态。你将学习如何运用这一数学工具，严格地识别出基因开关的两个稳定“记忆”状态，以及至关重要的、位于它们之间的不稳定鞍点，该鞍点构成了随机切换必须克服的势垒。",
            "id": "3932610",
            "problem": "考虑一个具有相互转录抑制的合成双基因拨动开关，其由希尔型调控函数建模。设 $x(t)$ 和 $y(t)$ 分别表示调控子 $X$ 和调控子 $Y$ 的无量纲蛋白质浓度。假设两种物质的降解均为一级反应，速率常数均为 $1\\,\\mathrm{min}^{-1}$，并且最大合成速率是平衡的，使得在没有抑制的情况下，每个基因的净产量为 $4\\,\\mathrm{min}^{-1}$。两种相互作用的抑制协同性（希尔系数）均为 $2$。其动力学由以下确定性常微分方程给出\n$$\n\\frac{dx}{dt} = \\frac{4}{1 + y^{2}} - x,\\qquad \\frac{dy}{dt} = \\frac{4}{1 + x^{2}} - y,\n$$\n其中 $t$ 是以分钟为单位的时间。在表观遗传记忆的背景下，稳定不动点对应于可遗传的表达状态，而这些表观遗传状态之间的噪声诱导切换是通过在确定性流中经过一个不稳定鞍点不动点附近来介导的。\n\n任务：\n1. 通过求解稳态条件 $\\frac{dx}{dt}=0$ 和 $\\frac{dy}{dt}=0$ 来找到所有不动点 $(x^{\\ast}, y^{\\ast})$。\n2. 推导在一般点 $(x,y)$ 处向量场的雅可比矩阵，并在任务1中找到的每个不动点处计算其值。\n3. 计算每个不动点处的特征值，并确定它们的线性稳定性分类。识别介导噪声诱导切换的不稳定鞍点不动点。\n4. 从你的分析中，提取鞍点不动点处雅可比矩阵的正（不稳定）特征值。将此值作为你的最终答案报告。将你的答案四舍五入到四位有效数字，并以 $\\mathrm{min}^{-1}$ 为单位表示。",
            "solution": "我们从基因调控和分子生物学中心法则的基础建模图像开始，这促使我们使用常微分方程模型来描述转录调控下蛋白质浓度的动力学。拨动开关中的相互抑制由希尔型输入输出函数捕捉。给定的确定性动力学为\n$$\n\\frac{dx}{dt} = f(x,y) = \\frac{4}{1+y^{2}} - x,\\qquad \\frac{dy}{dt} = g(x,y) = \\frac{4}{1+x^{2}} - y,\n$$\n其中 $x$ 和 $y$ 的线性降解速率均为 $1\\,\\mathrm{min}^{-1}$，并具有系数为 $2$ 的对称希尔抑制。\n\n任务1：不动点由 $f(x^{\\ast},y^{\\ast})=0$ 和 $g(x^{\\ast},y^{\\ast})=0$ 定义，即\n$$\nx^{\\ast} = \\frac{4}{1+(y^{\\ast})^{2}},\\qquad y^{\\ast} = \\frac{4}{1+(x^{\\ast})^{2}}。\n$$\n根据对称性，一个不动点满足 $x^{\\ast}=y^{\\ast}=s$，其中 $s$ 求解\n$$\ns = \\frac{4}{1+s^{2}}\\quad\\Longleftrightarrow\\quad s(1+s^{2}) = 4\\quad\\Longleftrightarrow\\quad s^{3} + s - 4 = 0。\n$$\n这个三次方程有一个实根，我们可以使用 Cardano 公式对降次三次方程 $t^{3} + pt + q = 0$（其中 $p=1$ 和 $q=-4$）以闭合形式表示。判别式为\n$$\n\\Delta = \\left(\\frac{q}{2}\\right)^{2} + \\left(\\frac{p}{3}\\right)^{3} = 4 + \\frac{1}{27} = \\frac{109}{27}。\n$$\n因此，\n$$\ns = \\sqrt[3]{2 + \\sqrt{\\frac{109}{27}}} + \\sqrt[3]{2 - \\sqrt{\\frac{109}{27}}}。\n$$\n除了这个对称不动点之外，由于相互抑制，还存在两个非对称不动点：一个 $x^{\\ast}$ 大，$y^{\\ast}$ 小；另一个 $x^{\\ast}$ 小，$y^{\\ast}$ 大。它们满足上述稳态方程，并可通过迭代数值求解得到。近似值为：\n$$\n(x^{\\ast},y^{\\ast}) \\approx (3.737,\\,0.267),\\qquad (x^{\\ast},y^{\\ast}) \\approx (0.267,\\,3.737),\n$$\n这与系统的对称参数化是一致的。\n\n任务2：向量场 $(f,g)$ 在一般点 $(x,y)$ 处的雅可比矩阵 $J(x,y)$ 定义为\n$$\nJ(x,y) = \\begin{pmatrix}\n\\frac{\\partial f}{\\partial x} & \\frac{\\partial f}{\\partial y} \\\\\n\\frac{\\partial g}{\\partial x} & \\frac{\\partial g}{\\partial y}\n\\end{pmatrix}。\n$$\n我们计算偏导数。由于 $f(x,y) = \\frac{4}{1+y^{2}} - x$，我们有\n$$\n\\frac{\\partial f}{\\partial x} = -1,\\qquad \\frac{\\partial f}{\\partial y} = 4\\,\\frac{d}{dy}\\left(\\frac{1}{1+y^{2}}\\right) = 4\\left(-\\frac{2y}{(1+y^{2})^{2}}\\right) = -\\frac{8y}{(1+y^{2})^{2}}。\n$$\n类似地，对于 $g(x,y) = \\frac{4}{1+x^{2}} - y$，\n$$\n\\frac{\\partial g}{\\partial x} = 4\\,\\frac{d}{dx}\\left(\\frac{1}{1+x^{2}}\\right) = 4\\left(-\\frac{2x}{(1+x^{2})^{2}}\\right) = -\\frac{8x}{(1+x^{2})^{2}},\\qquad \\frac{\\partial g}{\\partial y} = -1。\n$$\n因此，\n$$\nJ(x,y) = \\begin{pmatrix}\n-1 & -\\dfrac{8y}{(1+y^{2})^{2}} \\\\\n-\\dfrac{8x}{(1+x^{2})^{2}} & -1\n\\end{pmatrix}。\n$$\n\n任务3：形式为\n$$\n\\begin{pmatrix}\n-1 & -A \\\\\n- B & -1\n\\end{pmatrix}\n$$\n的 $2\\times 2$ 矩阵的特征值 $\\lambda$ 由特征多项式的根给出\n$$\n\\det\\!\\left(J - \\lambda I\\right) = \\left(-1 - \\lambda\\right)^{2} - A B = 0,\n$$\n由此得出\n$$\n\\lambda_{\\pm} = -1 \\pm \\sqrt{A B},\n$$\n其中\n$$\nA = \\frac{8y}{(1+y^{2})^{2}},\\qquad B = \\frac{8x}{(1+x^{2})^{2}}。\n$$\n不动点 $(x^{\\ast}, y^{\\ast})$ 处的稳定性取决于 $\\lambda_{\\pm}$ 的符号。如果 $\\sqrt{A B}  1$，那么 $\\lambda_{+} = -1 + \\sqrt{A B}  0$ 并且 $\\lambda_{-} = -1 - \\sqrt{A B}  0$，所以该不动点是线性稳定的。如果 $\\sqrt{A B}  1$，那么 $\\lambda_{+}  0$ 并且 $\\lambda_{-}  0$，该不动点是一个具有一个不稳定方向的鞍点。\n\n我们现在对任务1中找到的不动点进行分类。对于非对称不动点，数值计算 $A$ 和 $B$ 显示：\n- 在 $(x^{\\ast},y^{\\ast}) \\approx (3.737,\\,0.267)$ 处，我们有\n$$\nA \\approx \\frac{8\\cdot 0.267}{(1+0.267^{2})^{2}} \\approx 1.861,\\qquad B \\approx \\frac{8\\cdot 3.737}{(1+3.737^{2})^{2}} \\approx 0.1335,\n$$\n所以 $A B \\approx 0.2487$ 且 $\\sqrt{A B} \\approx 0.4987  1$。因此两个特征值均为负：$\\lambda_{\\pm} \\approx -1 \\pm 0.4987$，这是一个稳定不动点。根据对称性，$(x^{\\ast},y^{\\ast}) \\approx (0.267,\\,3.737)$ 也是稳定的。\n- 在对称不动点 $(x^{\\ast},y^{\\ast}) = (s,s)$（其中 $s$ 如上定义），我们可以使用稳态关系来简化 $A$ 和 $B$。从 $s = \\dfrac{4}{1+s^{2}}$ 我们推断 $1+s^{2} = \\dfrac{4}{s}$，因此\n$$\nA = \\frac{8 s}{(1+s^{2})^{2}} = \\frac{8 s}{\\left(\\dfrac{4}{s}\\right)^{2}} = \\frac{8 s}{\\dfrac{16}{s^{2}}} = \\frac{8 s^{3}}{16} = \\frac{s^{3}}{2},\n$$\n类似地 $B = \\dfrac{s^{3}}{2}$。因此 $A B = \\left(\\dfrac{s^{3}}{2}\\right)^{2}$ 并且\n$$\n\\sqrt{A B} = \\frac{s^{3}}{2}。\n$$\n使用三次稳态条件 $s^{3} + s - 4 = 0$，我们有 $s^{3} = 4 - s$，所以\n$$\n\\sqrt{A B} = \\frac{4 - s}{2} = 2 - \\frac{s}{2}。\n$$\n对称不动点处的雅可比矩阵特征值为\n$$\n\\lambda_{\\pm} = -1 \\pm \\left(2 - \\frac{s}{2}\\right),\n$$\n所以\n$$\n\\lambda_{+} = 1 - \\frac{s}{2},\\qquad \\lambda_{-} = -3 + \\frac{s}{2}。\n$$\n由于 $s$ 是正的，并且数值上 $s \\approx 1.3788$（从 $s$ 的闭合形式表达式中获得），我们发现\n$$\n\\lambda_{+} \\approx 1 - \\frac{1.3788}{2} \\approx 0.3106,\\qquad \\lambda_{-} \\approx -3 + \\frac{1.3788}{2} \\approx -2.3106。\n$$\n因此，对称不动点是一个鞍点，具有一个正（不稳定）特征值和一个负（稳定）特征值。在存在随机涨落的情况下，这个鞍点介导了两个稳定表观遗传记忆状态之间的噪声诱导切换。\n\n任务4：鞍点处的正（不稳定）特征值为 $\\lambda_{+} = 1 - \\dfrac{s}{2}$，其中\n$$\ns = \\sqrt[3]{2 + \\sqrt{\\frac{109}{27}}} + \\sqrt[3]{2 - \\sqrt{\\frac{109}{27}}}。\n$$\n对该表达式进行数值计算得出 $\\lambda_{+} \\approx 0.3106\\,\\mathrm{min}^{-1}$。四舍五入到四位有效数字，该值为 $0.3106\\,\\mathrm{min}^{-1}$。",
            "answer": "$$\\boxed{0.3106}$$"
        },
        {
            "introduction": "确定性蓝图揭示了稳定记忆状态的位置，但正是随机噪声驱动了它们之间的实际切换。由于这些切换事件通常是罕见的，直接模拟的计算成本极高。本练习  介绍重要性采样，这是一种强大的计算技术，用于加速罕见事件，你将从中推导理论重加权因子，并实现一个有偏的随机模拟，从而高效、准确地估计切换速率。",
            "id": "3932586",
            "problem": "给定一个具有正反馈的一维随机基因表达模型，该模型表现出表观遗传记忆，其形式为从低表达盆地到高表达盆地的罕见随机转换。状态是拷贝数 $x \\in \\{0,1,2,\\ldots\\}$。发生两种反应：合成以倾向 $a_{1}(x)$ 使 $x$ 增加 $+1$，降解以倾向 $a_{2}(x)$ 使 $x$ 减少 $-1$。倾向定义为 $a_{1}(x) = k_{\\mathrm{basal}} + k_{\\mathrm{act}} \\dfrac{x^{n}}{K^{n} + x^{n}}$ 和 $a_{2}(x) = k_{\\mathrm{deg}} \\, x$，其中 $k_{\\mathrm{basal}}$、$k_{\\mathrm{act}}$、$K$、$n$ 和 $k_{\\mathrm{deg}}$ 是正常数。随机模拟算法（也称为 Gillespie 算法）用这些倾向定义了一个精确的连续时间马尔可夫跳跃过程。你将使用重要性采样方法，通过偏置势和正确的重加权来估计一个无偏的罕见转换率。\n\n你可以假定的基本原理：对于一个具有倾向 $\\{a_{j}(x)\\}_{j=1}^{J}$ 的连续时间马尔可夫跳跃过程，在某个时间范围内的路径概率密度由总速率 $a_{0}(x) = \\sum_{j=1}^{J} a_{j}(x)$ 决定的等待时间定律以及与 $a_{j}(x)$ 成正比的离散反应通道选择概率所确定。你也可以假定此类过程的路径概率具有标准的乘积积分结构。\n\n定义一个罕见事件目标为：从低表达盆地中的初始拷贝数 $x(0) = x_{0}$ 开始，在固定的时间范围 $T$ 之前达到或超过阈值 $H$。令 $\\tau$ 为首次到达集合 $\\{x \\ge H\\}$ 的时间。在无偏动态 $\\{a_{j}\\}$ 下，罕见事件概率为 $P(T) = \\mathbb{P}(\\tau \\le T)$。在小概率情况下，罕见转换率定义为 $r \\equiv P(T)/T$，单位为 $1/\\text{time}$。\n\n你将通过模拟一个具有倾向 $\\{\\tilde{a}_{j}\\}$ 的偏置过程来加速事件的发生，该过程由进程坐标 $q(x) = x$ 的指数倾斜定义。具体来说，对于每个反应 $j$，令化学计量增量为：合成反应 $\\nu_{1}=+1$，降解反应 $\\nu_{2}=-1$。对于给定的标量偏置强度 $\\theta \\in \\mathbb{R}$，将偏置倾向定义为 $\\tilde{a}_{j}(x) = a_{j}(x) \\exp(\\theta \\, \\nu_{j})$。当 $\\theta  0$ 时，偏置过程偏好向上移动；当 $\\theta  0$ 时，则不偏好向上移动。\n\n任务：\n- 从第一性原理出发，推导精确的轨迹重加权因子，该因子表示在此设定下无偏路径定律相对于偏置路径定律的 Radon–Nikodym 导数。推导必须从连续时间马尔可夫跳跃过程路径概率的标准乘积积分形式以及上述指数倾斜的定义开始。你的最终表达式必须对可能在停止时间 $\\min\\{\\tau, T\\}$ 被截断的一般轨迹有效。\n- 设计一个算法，该算法使用 Gillespie 算法在偏置倾向 $\\{\\tilde{a}_{j}\\}$ 下模拟轨迹，沿着每条模拟路径累积推导出的轨迹重加权因子直至 $\\min\\{\\tau, T\\}$，并为 $P(T) = \\mathbb{E}_{\\text{biased}}[W \\, \\mathbf{1}_{\\{\\tau \\le T\\}}]$ 构建一个无偏的蒙特卡洛估计量，其中 $W$ 是推导出的重加权因子。\n- 使用小概率近似 $r \\approx P(T)/T$，报告以下每个测试用例的估计速率 $r$，单位为 $1/\\text{time}$。\n\n所有测试用例中使用的模型参数：\n- $k_{\\mathrm{basal}} = 0.10$, $k_{\\mathrm{act}} = 1.50$, $K = 25.0$, $n = 2$, $k_{\\mathrm{deg}} = 0.10$, $x_{0} = 3$。\n模拟指南：\n- 在每个案例中，使用指定的 $\\theta$ 在偏置倾向 $\\{\\tilde{a}_{j}\\}$ 下进行精确的随机模拟。\n- 为保证数值稳定性，你可以在轨迹结束时累积权重的对数并取指数。\n- 对每个测试用例，使用恰好 $N = 3000$ 条独立轨迹来估计 $P(T)$。\n\n测试套件：\n- 案例 A (无偏基线): $\\theta = 0.0$, $T = 40.0$, $H = 35$。\n- 案例 B (中等正偏): $\\theta = 0.8$, $T = 40.0$, $H = 35$。\n- 案例 C (较强正偏): $\\theta = 1.2$, $T = 40.0$, $H = 35$。\n- 案例 D (不同时间范围和阈值): $\\theta = 0.5$, $T = 30.0$, $H = 38$。\n\n要求的最终程序输出：\n- 你的程序应生成单行输出，包含四个案例的估计罕见转换率，单位为 $1/\\text{time}$，形式为方括号括起来的逗号分隔列表（例如，$[0.00123,0.00098,0.00105,0.00076]$）。顺序必须是案例 A、案例 B、案例 C、案例 D。使用你的模拟计算出的精确值，不要添加额外的文本或单位。",
            "solution": "该问题具有科学依据，提法明确且客观。它指定了一个标准的基因表达随机模型，一个明确定义的罕见事件，以及一种标准的统计方法（带指数倾斜的重要性采样）来估计其速率。所有参数和条件都定义清晰且一致。因此，该问题是有效的。\n\n### 轨迹重加权因子的推导\n\n主要任务是推导重加权因子，即无偏路径测度 $P$ 相对于偏置路径测度 $\\tilde{P}$ 的 Radon–Nikodym 导数。我们从连续时间马尔可夫跳跃过程的单条轨迹的概率密度开始。\n\n在时间区间 $[0, \\tau_{\\text{stop}}]$ 上的一条轨迹由访问的状态序列和跳跃时间指定，表示为 $\\mathbf{x} = \\{(x_0, t_0=0), (x_1, t_1), \\dots, (x_K, t_K)\\}$，其中系统在时间 $t_i$ 通过反应 $j_i$ 从状态 $x_{i-1}$ 跳跃到 $x_i$，且 $t_K  \\tau_{\\text{stop}}$。该过程在最后的时间区间 $[t_K, \\tau_{\\text{stop}})$ 内保持在状态 $x_K$。停止时间 $\\tau_{\\text{stop}}$ 定义为 $\\min\\{\\tau, T\\}$，其中 $\\tau$ 是首次到达集合 $\\{x \\ge H\\}$ 的时间，$T$ 是固定的时间范围。\n\n在由倾向 $\\{a_j(x)\\}$ 表征的原始动态下，该轨迹的概率密度由乘积积分形式给出：\n$$\nP(\\mathbf{x}) = \\left[ \\prod_{i=1}^{K} a_{j_i}(x_{i-1}) \\right] \\exp\\left( -\\int_0^{\\tau_{\\text{stop}}} a_0(x(s)) ds \\right)\n$$\n其中 $a_0(x(s)) = \\sum_j a_j(x(s))$ 是总倾向或从状态 $x(s)$ 的逃逸率。由于状态是分段常数，即对于 $s \\in [t_{i-1}, t_i)$ 有 $x(s) = x_{i-1}$，一个更明确的形式是：\n$$\nP(\\mathbf{x}) = \\left[ \\prod_{i=1}^{K} a_{j_i}(x_{i-1}) \\right] \\exp\\left( -\\sum_{i=0}^{K-1} a_0(x_i)(t_{i+1}-t_i) - a_0(x_K)(\\tau_{\\text{stop}}-t_K) \\right)\n$$\n\n类似地，对于具有倾向 $\\{\\tilde{a}_j(x)\\}$ 的偏置过程，其路径概率密度为：\n$$\n\\tilde{P}(\\mathbf{x}) = \\left[ \\prod_{i=1}^{K} \\tilde{a}_{j_i}(x_{i-1}) \\right] \\exp\\left( -\\int_0^{\\tau_{\\text{stop}}} \\tilde{a}_0(x(s)) ds \\right)\n$$\n其中 $\\tilde{a}_0(x(s)) = \\sum_j \\tilde{a}_j(x(s))$。\n\n重加权因子 $W$ 是 Radon–Nikodym 导数 $W = \\frac{dP}{d\\tilde{P}}$，对于给定的路径 $\\mathbf{x}$，它是比率 $W(\\mathbf{x}) = \\frac{P(\\mathbf{x})}{\\tilde{P}(\\mathbf{x})}$。\n$$\nW = \\frac{\\left[ \\prod_{i=1}^{K} a_{j_i}(x_{i-1}) \\right] \\exp\\left( -\\int_0^{\\tau_{\\text{stop}}} a_0(x(s)) ds \\right)}{\\left[ \\prod_{i=1}^{K} \\tilde{a}_{j_i}(x_{i-1}) \\right] \\exp\\left( -\\int_0^{\\tau_{\\text{stop}}} \\tilde{a}_0(x(s)) ds \\right)}\n$$\n这个表达式可以分解为一个乘积项和一个指数项：\n$$\nW = \\left[ \\prod_{i=1}^{K} \\frac{a_{j_i}(x_{i-1})}{\\tilde{a}_{j_i}(x_{i-1})} \\right] \\exp\\left( \\int_0^{\\tau_{\\text{stop}}} (\\tilde{a}_0(x(s)) - a_0(x(s))) ds \\right)\n$$\n\n问题指定了进程坐标 $q(x) = x$ 的指数倾斜。偏置倾向为 $\\tilde{a}_{j}(x) = a_{j}(x) \\exp(\\theta \\nu_{j})$，其中 $\\theta$ 是偏置强度，$\\nu_j$ 是反应 $j$ 中 $x$ 的化学计量变化。在我们的模型中，有合成反应（反应 $j=1$, $\\nu_1 = +1$）和降解反应（反应 $j=2$, $\\nu_2 = -1$）。\n乘积项中的比率变为：\n$$\n\\frac{a_{j_i}(x_{i-1})}{\\tilde{a}_{j_i}(x_{i-1})} = \\frac{a_{j_i}(x_{i-1})}{a_{j_i}(x_{i-1}) \\exp(\\theta \\nu_{j_i})} = \\exp(-\\theta \\nu_{j_i})\n$$\n完整的乘积在指数中变为一个和：\n$$\n\\prod_{i=1}^{K} \\exp(-\\theta \\nu_{j_i}) = \\exp\\left(-\\theta \\sum_{i=1}^{K} \\nu_{j_i}\\right)\n$$\n化学计量变化的总和 $\\sum_{i=1}^{K} \\nu_{j_i}$ 恰好是从轨迹开始到最后一次跳跃后状态的状态变量的净变化，即 $x_K - x_0$。在停止时间的状态 $x(\\tau_{\\text{stop}})$ 是 $x_K$。因此，此项为 $\\exp(-\\theta(x(\\tau_{\\text{stop}}) - x_0))$。\n\n重加权因子 $W$ 的最终表达式为：\n$$\nW = \\exp\\left( -\\theta(x(\\tau_{\\text{stop}}) - x_0) + \\int_0^{\\tau_{\\text{stop}}} (\\tilde{a}_0(x(s)) - a_0(x(s))) ds \\right)\n$$\n其中 $x_0 = x(0)$ 是初始状态，$x(\\tau_{\\text{stop}})$ 是停止时间 $\\tau_{\\text{stop}}$ 时的状态，总速率的差异为 $\\tilde{a}_0(x) - a_0(x) = (a_1(x)e^{\\theta} + a_2(x)e^{-\\theta}) - (a_1(x) + a_2(x))$。为保证数值稳定性，我们通过在模拟过程中累积积分部分，并在结束时加上与状态相关的部分来计算权重的对数 $\\ln W$。\n\n### 蒙特卡洛估计的算法设计\n\n罕见事件概率 $P(T) = \\mathbb{P}(\\tau \\le T)$ 可以表示为在无偏动态下指示函数期望值 $P(T) = \\mathbb{E}[ \\mathbf{1}_{\\{\\tau \\le T\\}} ]$。使用重要性采样，我们在偏置动态 $\\tilde{P}$ 下进行模拟并重加权，得到无偏估计量：\n$$\n\\hat{P}(T) = \\frac{1}{N} \\sum_{i=1}^{N} W_i \\mathbf{1}_{\\{\\tau_i \\le T\\}}\n$$\n其中 $N$ 是模拟轨迹的数量，对于每条轨迹 $i$，$W_i$ 是计算出的权重，$\\tau_i$ 是首次到达时间。然后，罕见转换率估计为 $r \\approx \\hat{P}(T)/T$。\n\n该算法流程如下：\n\n1.  **初始化**：对于 $N$ 条轨迹中的每一条，初始化时间 $t=0$，状态 $x=x_0$，以及对数权重的积分部分 $\\ln W_{\\text{int}} = 0$。\n\n2.  **偏置随机模拟**：对于每条轨迹，使用偏置倾向 $\\{\\tilde{a}_j\\}$ 运行 Gillespie 算法，直到满足停止条件（$t \\ge T$ 或 $x \\ge H$）为止。\n    - 在当前状态 $x$ 和时间 $t$：\n        a. 计算无偏倾向 $a_1(x)$、$a_2(x)$ 和总倾向 $a_0(x)$。\n        b. 计算偏置倾向 $\\tilde{a}_1(x) = a_1(x)e^{\\theta}$、$\\tilde{a}_2(x) = a_2(x)e^{-\\theta}$ 和总倾向 $\\tilde{a}_0(x)$。注意 $a_2(0)=0$ 意味着 $\\tilde{a}_2(0)=0$，因此 $x$ 不会变为负数。\n        c. 从速率为 $\\tilde{a}_0(x)$ 的指数分布中抽取等待时间 $\\Delta t$：$\\Delta t = -\\ln(u_1)/\\tilde{a}_0(x)$，其中 $u_1 \\sim U(0,1)$。\n        d. 确定当前状态的时间步长 $\\Delta t_{\\text{step}} = \\min(\\Delta t, T - t)$。更新对数权重的积分：$\\ln W_{\\text{int}} \\leftarrow \\ln W_{\\text{int}} + (\\tilde{a}_0(x) - a_0(x))\\Delta t_{\\text{step}}$。\n        e. 如果 $t + \\Delta t \\ge T$，则轨迹在时间范围 $T$ 结束。设置 $t=T$ 并终止此轨迹的模拟循环。\n        f. 否则，推进时间 $t \\leftarrow t + \\Delta t$。以概率 $\\tilde{a}_j(x)/\\tilde{a}_0(x)$ 选择一个反应 $j$ 并相应地更新状态 $x$（$x \\leftarrow x + \\nu_j$）。\n        g. 重复此过程，直到 $t \\ge T$ 或 $x \\ge H$。\n\n3.  **权重计算与平均**：\n    - 在每条轨迹于时间 $\\tau_{\\text{stop}}$ 在状态 $x_{\\text{final}}$ 终止后：\n        a. 计算最终的对数权重：$\\ln W = \\ln W_{\\text{int}} - \\theta(x_{\\text{final}} - x_0)$。\n        b. 计算权重：$W = \\exp(\\ln W)$。\n        c. 确定指示函数：如果 $x_{\\text{final}} \\ge H$，则 $\\mathbf{1}_{\\{\\tau \\le T\\}} = 1$，否则为 $0$。\n        d. 将乘积 $W \\cdot \\mathbf{1}_{\\{\\tau \\le T\\}}$ 累加到一个运行总和中。\n\n4.  **最终估计**：\n    - 在所有 $N$ 条轨迹完成后，通过将总和除以 $N$ 来计算估计概率 $\\hat{P}(T)$。\n    - 计算估计速率 $r = \\hat{P}(T)/T$。对每个测试用例重复此过程。",
            "answer": "$$\n\\boxed{\\text{[0.0,0.0007137453673322475,0.0006932468453488214,0.00011037380961819668]}}\n$$"
        }
    ]
}