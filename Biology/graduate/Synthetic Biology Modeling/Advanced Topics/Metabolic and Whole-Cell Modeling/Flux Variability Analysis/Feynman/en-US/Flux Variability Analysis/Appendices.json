{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex computations, it is essential to build an intuition for *why* flux variability exists. This exercise explores the concept of alternative optima, where multiple distinct flux distributions can achieve the same maximal objective value, a common feature in genome-scale models. By manually deriving the relationships between fluxes and constructing different optimal solutions for a small network , you will gain a concrete understanding of the geometric nature of the solution space and see why Flux Variability Analysis is a necessary tool.",
            "id": "3913850",
            "problem": "Consider a minimal constraint-based metabolic model of a synthetic construct with two internal metabolites, $X$ and $Y$, and four reactions: $R_1$ (uptake), $R_5$ (biomass formation), $R_6$ ($X \\to Y$), and $R_7$ ($Y \\to X$). Let the flux vector be $\\mathbf{v} = (v_1, v_5, v_6, v_7)^{\\top}$, ordered as $(R_1, R_5, R_6, R_7)$. The internal mass balances are enforced by the steady-state constraint $S \\mathbf{v} = 0$, where the stoichiometric matrix $S$ over metabolites $(X, Y)$ is\n$$\nS \\;=\\; \\begin{pmatrix}\n1 & -1 & -1 & 1 \\\\\n0 & 0 & 1 & -1\n\\end{pmatrix}.\n$$\nAll reactions are irreversible with the following bounds: $0 \\leq v_1 \\leq 10$, $0 \\leq v_5 \\leq 100$, $0 \\leq v_6 \\leq 8$, and $0 \\leq v_7 \\leq 8$. The objective function is to maximize biomass formation, i.e., maximize $\\mathbf{c}^{\\top} \\mathbf{v}$ with $\\mathbf{c} = (0, 1, 0, 0)^{\\top}$. Flux Variability Analysis (FVA) is defined as determining, for each reaction $i$, the minimal and maximal values of $v_i$ over the feasible set subject to the constraint that the objective value is held at its maximum.\n\nStarting only from the principles of steady-state mass balance $S \\mathbf{v} = 0$, linear flux bounds, and a linear objective $\\mathbf{c}^{\\top} \\mathbf{v}$, and without invoking any shortcut formulas, do the following:\n- Derive the relationships among $v_1$, $v_5$, $v_6$, and $v_7$ that follow from $S \\mathbf{v} = 0$.\n- Explain why the optimal objective value $z^{*}$ is achieved by multiple distinct flux vectors (alternative optima) and construct two explicit, distinct feasible flux vectors that both achieve the same optimal $z^{*}$ while respecting all constraints.\n- Perform Flux Variability Analysis (FVA) for reaction $R_6$ under the additional constraint that the objective is held at $z^{*}$, and compute the width of the FVA interval for $v_6$, defined as the difference between its maximal and minimal feasible values under optimality.\n\nExpress your final numerical answer (the interval width) in $\\mathrm{mmol}\\ \\mathrm{gDW}^{-1}\\ \\mathrm{h}^{-1}$, where $\\mathrm{gDW}$ denotes grams dry weight. If rounding is required, round your answer to four significant figures; if the value is exact, no rounding is necessary.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- **Metabolites**: Two internal metabolites, $X$ and $Y$.\n- **Reactions**: Four reactions, $R_1$ (uptake), $R_5$ (biomass formation), $R_6$ ($X \\to Y$), and $R_7$ ($Y \\to X$).\n- **Flux Vector**: $\\mathbf{v} = (v_1, v_5, v_6, v_7)^{\\top}$, corresponding to reactions $(R_1, R_5, R_6, R_7)$.\n- **Stoichiometric Matrix**: The stoichiometric matrix $S$ for metabolites $(X, Y)$ is given as\n$$ S = \\begin{pmatrix} 1 & -1 & -1 & 1 \\\\ 0 & 0 & 1 & -1 \\end{pmatrix}. $$\n- **Steady-State Constraint**: $S \\mathbf{v} = 0$.\n- **Flux Bounds**:\n    - $0 \\leq v_1 \\leq 10$\n    - $0 \\leq v_5 \\leq 100$\n    - $0 \\leq v_6 \\leq 8$\n    - $0 \\leq v_7 \\leq 8$\n- **Objective Function**: Maximize $z = \\mathbf{c}^{\\top} \\mathbf{v}$ where $\\mathbf{c} = (0, 1, 0, 0)^{\\top}$, which is equivalent to maximizing $v_5$.\n- **FVA Definition**: Determine the minimal and maximal values of each $v_i$ over the feasible set, subject to the additional constraint that the objective value is held at its maximum, $z^*$.\n- **Final Output Requirement**: The width of the FVA interval for $v_6$, expressed in units of $\\mathrm{mmol}\\ \\mathrm{gDW}^{-1}\\ \\mathrm{h}^{-1}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard application of constraint-based metabolic modeling, specifically Flux Balance Analysis (FBA) and Flux Variability Analysis (FVA). The mathematical formulation is based on linear programming, which is a well-established and rigorous framework. The problem is well-posed, providing a stoichiometric matrix, flux bounds, and a linear objective function, which define a bounded feasible space and thus guarantee the existence of a solution. The problem is objective and uses precise mathematical language. There are no scientific or factual unsoundness, no contradictions in the setup, and no undefined terms. While the problem statement specifies units for the final answer that are not defined in the givens (the problem is formulated with dimensionless quantities), this is an instruction for the formatting of the final output, not a flaw in the problem's internal logical or dimensional consistency. Therefore, a valid solution can be derived.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will now proceed.\n\nThe solution is derived in three parts as requested.\n\nFirst, we derive the relationships among the fluxes $v_1$, $v_5$, $v_6$, and $v_7$ from the steady-state mass balance condition $S \\mathbf{v} = 0$. Writing out the matrix-vector product gives a system of two linear equations:\n$$ \\begin{pmatrix} 1 & -1 & -1 & 1 \\\\ 0 & 0 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_5 \\\\ v_6 \\\\ v_7 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\nThe second row of this system immediately yields the equation:\n$$ (0)v_1 + (0)v_5 + (1)v_6 + (-1)v_7 = 0 \\implies v_6 - v_7 = 0 \\implies v_6 = v_7 $$\nThis indicates that the forward and reverse reactions between metabolites $X$ and $Y$ must carry identical flux at steady state, forming a futile cycle if $v_6 = v_7 > 0$.\nThe first row of the system gives the equation:\n$$ (1)v_1 + (-1)v_5 + (-1)v_6 + (1)v_7 = 0 \\implies v_1 - v_5 - v_6 + v_7 = 0 $$\nSubstituting the result $v_6 = v_7$ into this equation gives:\n$$ v_1 - v_5 - v_6 + v_6 = 0 \\implies v_1 - v_5 = 0 \\implies v_1 = v_5 $$\nThis relationship shows that at steady state, the rate of uptake of the external substrate ($v_1$) must equal the rate of biomass formation ($v_5$). The relationships are thus $v_1 = v_5$ and $v_6 = v_7$.\n\nSecond, we determine the optimal objective value $z^*$ and explain the existence of alternative optima. The objective is to maximize $z = v_5$. The feasible space is defined by the steady-state relations and the flux bounds. We have the relation $v_1 = v_5$. The flux $v_1$ is bounded by $0 \\leq v_1 \\leq 10$. Substituting $v_5$ for $v_1$ in this inequality, we obtain a constraint on $v_5$: $0 \\leq v_5 \\leq 10$. There is also an explicit bound on $v_5$, $0 \\leq v_5 \\leq 100$. The feasible range for $v_5$ is the intersection of these two ranges, which is $[0, 10]$. The maximum value of $v_5$ is therefore $10$. The optimal objective value is $z^{*} = 10$.\n\nAlternative optima exist because the value of the objective function $z = v_5$ is determined completely by $v_1$, and it is independent of the fluxes $v_6$ and $v_7$. Any flux vector $\\mathbf{v} = (v_1, v_5, v_6, v_7)^{\\top}$ that satisfies $v_1 = v_5 = z^* = 10$ and also respects the constraints on $v_6$ and $v_7$ is an optimal solution. The constraints on $v_6$ and $v_7$ are $v_6 = v_7$, $0 \\leq v_6 \\leq 8$, and $0 \\leq v_7 \\leq 8$. These combine to give $0 \\leq v_6 \\leq 8$ (with $v_7$ being equal to $v_6$). Since $v_6$ can take any real value in the interval $[0, 8]$, there are infinitely many distinct flux vectors that achieve the optimal objective value. Two such explicit, distinct feasible flux vectors are:\n1.  Let $v_6 = 0$. Then $v_7 = 0$. The flux vector is $\\mathbf{v}^{(1)} = (10, 10, 0, 0)^{\\top}$. This vector satisfies $S \\mathbf{v}^{(1)} = 0$, all flux bounds, and gives the objective value $v_5 = 10$.\n2.  Let $v_6 = 8$. Then $v_7 = 8$. The flux vector is $\\mathbf{v}^{(2)} = (10, 10, 8, 8)^{\\top}$. This vector also satisfies $S \\mathbf{v}^{(2)} = 0$, all flux bounds, and gives the objective value $v_5 = 10$.\n\nThird, we perform Flux Variability Analysis (FVA) for reaction $R_6$ and compute the width of its interval. FVA for $v_6$ requires finding the minimum and maximum possible values of $v_6$ subject to the original constraints plus the new constraint that the objective function is held at its maximum, i.e., $v_5 = z^* = 10$.\nThe full set of constraints for the FVA is:\n1.  $v_1 = v_5$\n2.  $v_6 = v_7$\n3.  $0 \\leq v_1 \\leq 10$\n4.  $0 \\leq v_5 \\leq 100$\n5.  $0 \\leq v_6 \\leq 8$\n6.  $0 \\leq v_7 \\leq 8$\n7.  $v_5 = 10$\nFrom constraint $7$, we have $v_5 = 10$. From constraint $1$, it follows that $v_1 = 10$. These values are consistent with constraints $3$ and $4$. The remaining constraints apply to $v_6$ and $v_7$. We have $v_6=v_7$ from constraint $2$. The independent bounds are $0 \\leq v_6 \\leq 8$ (constraint $5$) and $0 \\leq v_7 \\leq 8$ (constraint $6$). Substituting $v_7=v_6$ into the bound for $v_7$ gives $0 \\leq v_6 \\leq 8$, which is identical to the original bound on $v_6$. Therefore, under the condition of optimal biomass formation, the flux $v_6$ can feasibly take any value in its allowed range.\nThe FVA problem for the minimum of $v_6$ is to minimize $v_6$ subject to these constraints. The minimum value is clearly $v_{6, \\min} = 0$.\nThe FVA problem for the maximum of $v_6$ is to maximize $v_6$ subject to these constraints. The maximum value is clearly $v_{6, \\max} = 8$.\nThe FVA interval for $v_6$ is $[0, 8]$.\nThe width of this interval is the difference between the maximal and minimal values:\n$$ \\text{Width} = v_{6, \\max} - v_{6, \\min} = 8 - 0 = 8 $$\nThe problem is formulated with dimensionless numbers. As per the instructions, we attach the specified units to this final numerical result. The width of the FVA interval for $v_6$ is $8\\ \\mathrm{mmol}\\ \\mathrm{gDW}^{-1}\\ \\mathrm{h}^{-1}$.",
            "answer": "$$\n\\boxed{8}\n$$"
        },
        {
            "introduction": "With a solid conceptual foundation, we now turn to the practical implementation of Flux Variability Analysis. This practice guides you through the process of translating the formal definition of FVA into a computational workflow by setting up and solving the two required linear programs for a given reaction. By working through a curated set of test cases that exhibit different network behaviors , you will develop the core skill of calculating the precise minimum and maximum flux for a reaction while respecting the optimality constraint $\\mathbf{c}^{\\top} \\mathbf{v} \\ge z^{\\star} - \\varepsilon$.",
            "id": "3913845",
            "problem": "You are given the task of performing Flux Variability Analysis (FVA) for a specified reaction in several small, steady-state metabolic networks under a known optimal objective value. The underlying modeling assumptions and definitions must be used directly as the fundamental base: steady-state mass balance, linear bounds on fluxes, and linear objective optimization. Use the following principles and definitions to design your program.\n\nFundamental base:\n- Steady-state mass balance for a metabolic network is expressed as $S \\mathbf{v} = 0$, where $S \\in \\mathbb{R}^{m \\times n}$ is the stoichiometric matrix, $\\mathbf{v} \\in \\mathbb{R}^n$ is the vector of reaction fluxes, and $m$ and $n$ are the numbers of metabolites and reactions, respectively.\n- Flux bounds are $\\boldsymbol{\\ell} \\le \\mathbf{v} \\le \\mathbf{u}$, where $\\boldsymbol{\\ell} \\in \\mathbb{R}^n$ and $\\mathbf{u} \\in \\mathbb{R}^n$ are lower and upper bounds.\n- Flux Balance Analysis (FBA) uses a linear objective $\\mathbf{c}^\\top \\mathbf{v}$ to find an optimal value $z^\\star$.\n- Flux Variability Analysis (FVA) for a reaction $i$ computes the minimum and maximum flux $v_i$ over all flux vectors $\\mathbf{v}$ that satisfy the same steady-state and bound constraints and that also achieve the optimal objective (within a specified tolerance) via an optimality cut $\\mathbf{c}^\\top \\mathbf{v} \\ge z^\\star - \\varepsilon$, where $\\varepsilon > 0$ is a small scalar tolerance.\n\nYour program must:\n- For each test case, compute the FVA range for a single reaction $i$ by solving two linear programs (LPs):\n  1. Minimize $v_i$ subject to $S \\mathbf{v} = 0$, $\\boldsymbol{\\ell} \\le \\mathbf{v} \\le \\mathbf{u}$, and $-\\mathbf{c}^\\top \\mathbf{v} \\le -(z^\\star - \\varepsilon)$.\n  2. Maximize $v_i$ subject to the same constraints (implement this by minimizing $-v_i$ with the same constraints).\n- Use identical and consistent solver settings across the two LPs to ensure the same optimality cut is applied.\n- Report the minimum and maximum flux values for the reaction $i$ in millimoles per gram dry weight per hour ($\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$), rounded to $6$ decimal places.\n\nAngle units do not apply. Fraction or decimal format applies to fluxes; do not include a percentage sign.\n\nTest suite:\nUse zero-based indexing for reactions. For each test case, the data are given as $(S, l, u, c, i, z^\\star, \\varepsilon)$.\n\n- Test case $1$ (two biomass drains with a single uptake limiting growth):\n  - $S = \\begin{bmatrix} 1 & -1 & 0 & -1 \\\\ 0 & 1 & -1 & 0 \\end{bmatrix}$,\n  - $l = [0, 0, 0, 0]$,\n  - $u = [10, 1000, 1000, 1000]$,\n  - $\\mathbf{c} = [0, 0, 1, 1]$,\n  - $i = 1$,\n  - $z^\\star = 10$,\n  - $\\varepsilon = 1 \\times 10^{-7}$.\n  This case exhibits multiple optima due to two alternative biomass-producing routes, with $\\mathbf{c}^\\top \\mathbf{v}$ limited by the uptake bound.\n\n- Test case $2$ (alternate optima with an internal cycle):\n  - $S = \\begin{bmatrix} 1 & -1 & 1 & 0 \\\\ 0 & 1 & -1 & -1 \\end{bmatrix}$,\n  - $l = [0, 0, 0, 0]$,\n  - $u = [5, 1005, 1000, 1000]$,\n  - $\\mathbf{c} = [0, 0, 0, 1]$,\n  - $i = 1$,\n  - $z^\\star = 5$,\n  - $\\varepsilon = 1 \\times 10^{-8}$.\n  This case permits internal cycling between metabolites, creating wide variability in a non-objective reaction while preserving the optimal objective.\n\n- Test case $3$ (blocked reaction due to an unbalanced metabolite):\n  - $S = \\begin{bmatrix} 1 & -1 & 0 & 0 \\\\ 0 & 1 & -1 & -1 \\\\ 0 & 0 & 0 & 1 \\end{bmatrix}$,\n  - $l = [0, 0, 0, 0]$,\n  - $u = [3, 1000, 1000, 1000]$,\n  - $\\mathbf{c} = [0, 0, 1, 0]$,\n  - $i = 3$,\n  - $z^\\star = 3$,\n  - $\\varepsilon = 1 \\times 10^{-9}$.\n  Metabolite $C$ has no sink; thus its producing reaction is blocked at steady state.\n\n- Test case $4$ (unique optimum with tight bound yielding fractional optimal growth):\n  - $S = \\begin{bmatrix} 1 & -1 \\end{bmatrix}$,\n  - $l = [0, 0]$,\n  - $u = [2.5, 1000]$,\n  - $\\mathbf{c} = [0, 1]$,\n  - $i = 0$,\n  - $z^\\star = 2.5$,\n  - $\\varepsilon = 1 \\times 10^{-12}$.\n  A single uptake bound fixes the unique objective value to a fractional number.\n\nSolver settings requirement:\n- Use a single linear programming method across all LPs that supports equality constraints and bound constraints reliably.\n- Apply identical tolerances for primal and dual feasibility and optimality across the minimization and maximization LPs to ensure the same optimality cut $\\mathbf{c}^\\top \\mathbf{v} \\ge z^\\star - \\varepsilon$ is enforced consistently.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and with each test case represented as a two-element list of floats rounded to $6$ decimal places, for example, $[[x_1,y_1],[x_2,y_2],\\dots]$. In this problem, the line must be of the form $[[\\text{min}_1,\\text{max}_1],[\\text{min}_2,\\text{max}_2],[\\text{min}_3,\\text{max}_3],[\\text{min}_4,\\text{max}_4]]$, where each $\\text{min}_k$ and $\\text{max}_k$ is in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$ and rounded to $6$ decimal places.",
            "solution": "The derivation proceeds from the standard steady-state and optimization principles used in constraint-based metabolic modeling. A Flux Balance Analysis (FBA) model specifies a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$, flux vector $\\mathbf{v} \\in \\mathbb{R}^n$, and bounds $\\boldsymbol{\\ell} \\le \\mathbf{v} \\le \\mathbf{u}$. Steady state implies $S \\mathbf{v} = 0$, which enforces that, for each metabolite, the sum of producing and consuming fluxes is zero. An objective function $\\mathbf{c}^\\top \\mathbf{v}$ is used to define a physiologically relevant target, such as growth rate, and a linear program (LP) is solved to find the optimal objective value $z^\\star$.\n\nFlux Variability Analysis (FVA) characterizes the permissible range of each reaction flux $v_i$ among all flux vectors $\\mathbf{v}$ that achieve the same optimal objective value (up to a tolerance), while still satisfying $S \\mathbf{v} = 0$ and bounds $\\boldsymbol{\\ell} \\le \\mathbf{v} \\le \\mathbf{u}$. Formally, for a given reaction index $i$, FVA solves two LPs:\n\n$$\n\\begin{aligned}\n\\min_{\\mathbf{v} \\in \\mathbb{R}^n} \\quad & v_i \\\\\n\\text{s.t.} \\quad & S \\mathbf{v} = 0, \\\\\n& \\boldsymbol{\\ell} \\le \\mathbf{v} \\le \\mathbf{u}, \\\\\n& \\mathbf{c}^\\top \\mathbf{v} \\ge z^\\star - \\varepsilon,\n\\end{aligned}\n$$\n\nand\n\n$$\n\\begin{aligned}\n\\max_{\\mathbf{v} \\in \\mathbb{R}^n} \\quad & v_i \\\\\n\\text{s.t.} \\quad & S \\mathbf{v} = 0, \\\\\n& \\boldsymbol{\\ell} \\le \\mathbf{v} \\le \\mathbf{u}, \\\\\n& \\mathbf{c}^\\top \\mathbf{v} \\ge z^\\star - \\varepsilon,\n\\end{aligned}\n$$\n\nwhere the optimality cut $\\mathbf{c}^\\top \\mathbf{v} \\ge z^\\star - \\varepsilon$ enforces that only flux vectors that are near-optimal with respect to the objective are considered. In practice, when using a solver that only minimizes, the maximization can be implemented by minimizing $-v_i$ with the same constraints. The inequality $\\mathbf{c}^\\top \\mathbf{v} \\ge z^\\star - \\varepsilon$ can be encoded in standard LP form as $-\\mathbf{c}^\\top \\mathbf{v} \\le -(z^\\star - \\varepsilon)$.\n\nAlgorithmic design:\n- For each test case, set $A_{\\text{eq}} = S$ and $b_{\\text{eq}} = 0$, and bounds as given by $\\boldsymbol{\\ell}$ and $\\mathbf{u}$.\n- Set the optimality cut as a single inequality $A_{\\text{ub}} = -\\mathbf{c}^\\top$ and $b_{\\text{ub}} = -(z^\\star - \\varepsilon)$.\n- To compute the minimum of $v_i$, minimize the objective vector $\\mathbf{f} = \\mathbf{e}_i$ where $\\mathbf{e}_i$ is the $i$-th standard basis vector in $\\mathbb{R}^n$.\n- To compute the maximum of $v_i$, minimize $\\mathbf{f} = -\\mathbf{e}_i$ and then negate the optimal objective value.\n- Use a single robust LP method with identical solver settings across both LPs so that the same optimality cut and tolerances are applied consistently. Suitable settings for an interior-point or hybrid solver include enabling presolve and setting primal and dual feasibility tolerances (and optimality tolerance) to the same small values, for example, $10^{-9}$, to ensure consistent enforcement of equality and inequality constraints across multiple solves.\n\nInterpretation and expected outcomes for the test suite:\n- Test case $1$:\n  The constraints are $S \\mathbf{v} = 0$ with $S = \\begin{bmatrix} 1 & -1 & 0 & -1 \\\\ 0 & 1 & -1 & 0 \\end{bmatrix}$, bounds $\\boldsymbol{\\ell} = [0, 0, 0, 0]$, $\\mathbf{u} = [10, 1000, 1000, 1000]$, and objective $\\mathbf{c} = [0, 0, 1, 1]$ with $z^\\star = 10$. From $S \\mathbf{v} = 0$, we have $v_2 = v_1$ and $v_0 = v_1 + v_3$. The objective is $\\mathbf{c}^\\top \\mathbf{v} = v_2 + v_3 = v_1 + v_3 = v_0$, which is limited by $v_0 \\le 10$, hence $z^\\star = 10$. Under the optimality cut $\\mathbf{c}^\\top \\mathbf{v} \\ge 10 - \\varepsilon$, the feasible set has $v_0 \\approx 10$ and $v_1$ can vary freely with $v_3$ while preserving $v_1 + v_3 = 10$. Therefore, $v_1 \\in [0, 10]$. The FVA range for reaction $i = 1$ (second reaction) is $[0, 10]$.\n- Test case $2$:\n  With $S = \\begin{bmatrix} 1 & -1 & 1 & 0 \\\\ 0 & 1 & -1 & -1 \\end{bmatrix}$, $\\boldsymbol{\\ell} = [0, 0, 0, 0]$, $\\mathbf{u} = [5, 1005, 1000, 1000]$, $\\mathbf{c} = [0, 0, 0, 1]$, and $z^\\star = 5$, the mass balances give $v_2 = v_1 - v_0$ and $v_3 = v_1 - v_2 = v_1 - (v_1 - v_0) = v_0$. Thus, the objective $\\mathbf{c}^\\top \\mathbf{v} = v_3 = v_0$ is limited by $v_0 \\le 5$, giving $z^\\star = 5$. Under the cut $\\mathbf{c}^\\top \\mathbf{v} \\ge 5 - \\varepsilon$, we have $v_0 \\approx 5$. The bounds on $v_2$ yield $0 \\le v_2 = v_1 - 5 \\le 1000$, so $v_1 \\in [5, 1005]$. The FVA range for reaction $i = 1$ (second reaction) is $[5, 1005]$.\n- Test case $3$:\n  With $S = \\begin{bmatrix} 1 & -1 & 0 & 0 \\\\ 0 & 1 & -1 & -1 \\\\ 0 & 0 & 0 & 1 \\end{bmatrix}$, $\\boldsymbol{\\ell} = [0, 0, 0, 0]$, $\\mathbf{u} = [3, 1000, 1000, 1000]$, $\\mathbf{c} = [0, 0, 1, 0]$, and $z^\\star = 3$, the $C$-row implies $v_3 = 1 \\cdot v_3 = 0$ at steady state since there is no sink for metabolite $C$. The objective is $\\mathbf{c}^\\top \\mathbf{v} = v_2 = v_1$ and from $A$-row $v_0 = v_1$, so the uptake bound $v_0 \\le 3$ imposes $z^\\star = 3$. Under the optimality cut $\\mathbf{c}^\\top \\mathbf{v} \\ge 3 - \\varepsilon$, $v_3$ remains blocked by the $C$-row, yielding $v_3 = 0$ exactly. The FVA range for reaction $i = 3$ is $[0, 0]$.\n- Test case $4$:\n  With $S = \\begin{bmatrix} 1 & -1 \\end{bmatrix}$, $\\boldsymbol{\\ell} = [0, 0]$, $\\mathbf{u} = [2.5, 1000]$, $\\mathbf{c} = [0, 1]$, and $z^\\star = 2.5$, we have $v_1 = v_0$ from steady state and the objective is $\\mathbf{c}^\\top \\mathbf{v} = v_1$. The bound $v_0 \\le 2.5$ enforces $z^\\star = 2.5$, and the optimality cut $\\mathbf{c}^\\top \\mathbf{v} \\ge 2.5 - \\varepsilon$ forces $v_1 \\approx 2.5$ and $v_0 \\approx 2.5$. Thus, the FVA range for reaction $i = 0$ (first reaction) is $[2.5, 2.5]$.\n\nSolver settings and consistent optimality cut:\nTo ensure consistency across the two LPs per test case, use a single LP method and identical tolerances for primal feasibility, dual feasibility, and optimality. Enabling presolve helps identify redundant constraints and scale the problem. Setting, for instance, primal feasibility tolerance and dual feasibility tolerance both to $10^{-9}$, along with an optimality tolerance of $10^{-9}$, ensures that the inequality $-\\mathbf{c}^\\top \\mathbf{v} \\le -(z^\\star - \\varepsilon)$ is enforced uniformly in both the minimization and maximization problems. Using the same solver and the same options across both LP solves guarantees that any numerical handling of the optimality cut and equality constraints is identical, avoiding discrepancies due to differing numerical tolerances or presolve behavior.\n\nImplementation notes:\n- Encode the optimality cut as $A_{\\text{ub}} = -\\mathbf{c}^\\top$ and $b_{\\text{ub}} = -(z^\\star - \\varepsilon)$.\n- Minimize $\\mathbf{e}_i^\\top \\mathbf{v}$ to obtain $\\min v_i$. Minimize $-\\mathbf{e}_i^\\top \\mathbf{v}$ and negate the resulting optimal value to obtain $\\max v_i$.\n- Use zero-based indexing for reactions.\n- Return each pair $[\\min v_i, \\max v_i]$ rounded to $6$ decimal places, in units $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$.\n\nExpected final outputs, based on the derivations above, are:\n- Test case $1$: $[0.000000, 10.000000]$,\n- Test case $2$: $[5.000000, 1005.000000]$,\n- Test case $3$: $[0.000000, 0.000000]$,\n- Test case $4$: $[2.500000, 2.500000]$.\n\nThe program will compute these by solving the corresponding LPs with consistent solver settings and print a single line formatted as $[[0.000000,10.000000],[5.000000,1005.000000],[0.000000,0.000000],[2.500000,2.500000]]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef fva_range(S, lb, ub, c, i, z_star, opt_tol):\n    \"\"\"\n    Compute FVA min and max for reaction i under the optimality cut c^T v >= z_star - opt_tol.\n    Uses two LP solves with identical solver settings to ensure consistency.\n    \"\"\"\n    S = np.array(S, dtype=float)\n    lb = np.array(lb, dtype=float)\n    ub = np.array(ub, dtype=float)\n    c = np.array(c, dtype=float)\n    n = S.shape[1]\n\n    # Equality constraints: S v = 0\n    A_eq = S\n    b_eq = np.zeros(S.shape[0], dtype=float)\n\n    # Optimality cut: -c^T v <= -(z_star - opt_tol)\n    A_ub = -c.reshape(1, -1)\n    b_ub = np.array([-(z_star - opt_tol)], dtype=float)\n\n    # Bounds as list of tuples\n    bounds = [(float(lb[j]), float(ub[j])) for j in range(n)]\n\n    # Objective vectors\n    e_i = np.zeros(n, dtype=float)\n    e_i[i] = 1.0\n\n    # Common solver options to ensure consistent use of the optimality cut\n    options = {\n        \"presolve\": True,\n        \"dual_feasibility_tolerance\": 1e-9,\n        \"primal_feasibility_tolerance\": 1e-9,\n        \"ipm_optimality_tolerance\": 1e-9,\n    }\n\n    # Minimize v_i\n    res_min = linprog(\n        c=e_i,\n        A_ub=A_ub,\n        b_ub=b_ub,\n        A_eq=A_eq,\n        b_eq=b_eq,\n        bounds=bounds,\n        method=\"highs\",\n        options=options,\n    )\n    if not res_min.success:\n        min_val = float(\"nan\")\n    else:\n        min_val = res_min.fun\n\n    # Maximize v_i by minimizing -v_i\n    res_max = linprog(\n        c=-e_i,\n        A_ub=A_ub,\n        b_ub=b_ub,\n        A_eq=A_eq,\n        b_eq=b_eq,\n        bounds=bounds,\n        method=\"highs\",\n        options=options,\n    )\n    if not res_max.success:\n        max_val = float(\"nan\")\n    else:\n        max_val = -res_max.fun\n\n    # Numerical guard: clamp within bounds and round to 6 decimals\n    if not np.isnan(min_val):\n        min_val = max(min_val, lb[i] - 1e-9)\n        min_val = min(min_val, ub[i] + 1e-9)\n    if not np.isnan(max_val):\n        max_val = max(max_val, lb[i] - 1e-9)\n        max_val = min(max_val, ub[i] + 1e-9)\n\n    # Round to 6 decimal places as required\n    min_val = float(f\"{min_val:.6f}\") if not np.isnan(min_val) else min_val\n    max_val = float(f\"{max_val:.6f}\") if not np.isnan(max_val) else max_val\n\n    return [min_val, max_val]\n\ndef solve():\n    # Define the test cases from the problem statement: (S, l, u, c, i, z_star, epsilon)\n    test_cases = [\n        # Test case 1\n        (\n            [[1, -1, 0, -1],\n             [0,  1, -1,  0]],\n            [0, 0, 0, 0],\n            [10, 1000, 1000, 1000],\n            [0, 0, 1, 1],\n            1,\n            10.0,\n            1e-7,\n        ),\n        # Test case 2\n        (\n            [[1, -1,  1,  0],\n             [0,  1, -1, -1]],\n            [0, 0, 0, 0],\n            [5, 1005, 1000, 1000],\n            [0, 0, 0, 1],\n            1,\n            5.0,\n            1e-8,\n        ),\n        # Test case 3\n        (\n            [[1, -1, 0, 0],\n             [0,  1, -1, -1],\n             [0,  0, 0, 1]],\n            [0, 0, 0, 0],\n            [3, 1000, 1000, 1000],\n            [0, 0, 1, 0],\n            3,\n            3.0,\n            1e-9,\n        ),\n        # Test case 4\n        (\n            [[1, -1]],\n            [0, 0],\n            [2.5, 1000],\n            [0, 1],\n            0,\n            2.5,\n            1e-12,\n        ),\n    ]\n\n    results = []\n    for S, l, u, c, i, z_star, eps in test_cases:\n        r = fva_range(S, l, u, c, i, z_star, eps)\n        results.append(r)\n\n    # Format results as a single line: [[min1,max1],[min2,max2],...]\n    pair_strings = []\n    for pair in results:\n        # Ensure fixed 6-decimal formatting in the output string\n        a, b = pair\n        sa = f\"{a:.6f}\" if not np.isnan(a) else \"nan\"\n        sb = f\"{b:.6f}\" if not np.isnan(b) else \"nan\"\n        pair_strings.append(f\"[{sa},{sb}]\")\n\n    print(f\"[{','.join(pair_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Flux Variability Analysis is not just a theoretical exercise; it is a powerful tool for predictive biology and metabolic engineering. This advanced practice demonstrates how FVA can be applied to analyze the functional consequences of genetic interventions, such as gene knockouts, which are modeled here by deleting reactions from the network. By observing how FVA ranges for key pathways change or \"collapse\" in response to these simulated perturbations , you will learn to predict important biological phenomena like synthetic lethality and better understand the principles of metabolic redundancy and robustness.",
            "id": "3913859",
            "problem": "You are given a minimal metabolic network intended to represent a simplified biomass synthesis module suitable for analysis by Flux Variability Analysis (FVA). Flux Variability Analysis (FVA) is defined as the computation of feasible minimum and maximum values of a flux variable over a steady-state feasible region while enforcing a target objective at a specified level. Gene–Protein–Reaction (GPR) mapping provides the correspondence between genes, proteins, and reactions, but for this problem you will model gene interventions by directly constraining reaction fluxes to zero.\n\nFundamental base:\n- Steady-state mass balance for internal metabolites is captured by a stoichiometric matrix and the condition that the net production rate equals zero.\n- Linear programs are solved under linear equality constraints for steady-state and bound constraints for reaction irreversibility and capacities.\n- Flux Variability Analysis sets the objective reaction to a fixed value and then solves two linear programs per reaction of interest to obtain the feasible minimum and maximum.\n\nNetwork specification:\n- Internal metabolites: $A$, $B$, $C$, $P$.\n- Reactions (indices in parentheses):\n  - $(0)$ $R_1$: external uptake $\\rightarrow A$, bounds $0 \\le v_0 \\le 10$.\n  - $(1)$ $R_2$: $A \\rightarrow B$, bounds $0 \\le v_1 \\le 1000$.\n  - $(2)$ $R_3$: $A \\rightarrow C$, bounds $0 \\le v_2 \\le 1000$.\n  - $(3)$ $R_4$: $B \\rightarrow P$, bounds $0 \\le v_3 \\le 1000$.\n  - $(4)$ $R_5$: $C \\rightarrow P$, bounds $0 \\le v_4 \\le 1000$.\n  - $(5)$ $R_6$: $P \\rightarrow$ biomass drain, bounds $0 \\le v_5 \\le 1000$, objective to be maximized in the optimal growth computation.\n- Stoichiometric matrix $S \\in \\mathbb{R}^{4 \\times 6}$ for internal metabolites ordered as $(A,B,C,P)$ and reactions ordered as $(R_1,\\dots,R_6)$:\n  - Row for $A$: $(+1,-1,-1,0,0,0)$,\n  - Row for $B$: $(0,+1,0,-1,0,0)$,\n  - Row for $C$: $(0,0,+1,0,-1,0)$,\n  - Row for $P$: $(0,0,0,+1,+1,-1)$.\n- Biomass-associated reactions to monitor by FVA: $R_4$ and $R_5$ (indices $3$ and $4$).\n\nDefinition of synthetic lethality in this context: two reaction deletions are synthetically lethal if neither reaction alone eliminates the ability to achieve strictly positive optimal biomass flux, but together they reduce the optimal biomass flux to zero under the steady-state and bound constraints.\n\nComputation tasks for each intervention (pairwise reaction deletions):\n1. Compute the optimal biomass flux $v_5^\\star$ by maximizing $v_5$ subject to steady-state constraints $S \\mathbf{v} = 0$ and bounds $0 \\le v_j \\le U_j$ for all $j$, where any deleted reaction has its bounds fixed to $v_j = 0$.\n2. Perform Flux Variability Analysis (FVA) at the enforced optimal biomass level by adding the equality constraint $v_5 = v_5^\\star$ to the steady-state constraints, and then, for each biomass-associated reaction $R_4$ and $R_5$, compute the feasible minimum and maximum values $(v_3^{\\min}, v_3^{\\max})$ and $(v_4^{\\min}, v_4^{\\max})$ under these constraints.\n3. Define a collapse of the FVA range for a reaction $R_i$ as the condition $v_i^{\\max} - v_i^{\\min} \\le \\varepsilon$, with tolerance $\\varepsilon = 10^{-7}$. Decide whether both $R_4$ and $R_5$ exhibit collapsed ranges.\n\nInterpretation requirement: explain, in terms of pathway redundancy and GPR-inspired intervention effects, how combined deletions alter the feasible space and lead to either persistence or collapse of FVA ranges for the biomass-associated reactions.\n\nTest suite:\n- Use the following five intervention cases, each specified as an ordered pair of deletions by reaction indices. The sentinel value $\\mathrm{None}$ denotes no deletion in that slot.\n  - Case $1$: $(\\mathrm{None}, \\mathrm{None})$.\n  - Case $2$: $(1, \\mathrm{None})$.\n  - Case $3$: $(1, 2)$.\n  - Case $4$: $(1, 4)$.\n  - Case $5$: $(4, \\mathrm{None})$.\nFor each case, enforce the deletions by setting the corresponding reaction flux bound to $v_j = 0$.\n\nOutput specification:\n- For each case in the order listed above, output a boolean indicating whether the FVA ranges for both $R_4$ and $R_5$ collapse under the enforced optimal biomass constraint. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\").\n\nAll fluxes are abstract steady-state fluxes; no physical unit conversion is required in the output since the required answers are booleans.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and complete. It describes a standard computational task in the field of synthetic biology and metabolic engineering, specifically the application of Flux Balance Analysis (FBA) and Flux Variability Analysis (FVA) to a simplified metabolic network. The network, constraints, and computational objectives are clearly defined, permitting a unique and verifiable solution. Therefore, the problem is valid.\n\nThe solution requires a two-stage computational process for each specified intervention case, both stages implemented using Linear Programming (LP). An LP problem seeks to optimize a linear objective function subject to linear equality and inequality constraints. The general form is:\n$$\n\\begin{align*}\n\\text{minimize} \\quad & \\mathbf{c}^T \\mathbf{v} \\\\\n\\text{subject to} \\quad & A_{eq} \\mathbf{v} = b_{eq} \\\\\n& \\mathbf{lb} \\le \\mathbf{v} \\le \\mathbf{ub}\n\\end{align*}\n$$\nwhere $\\mathbf{v}$ is the vector of variables (fluxes), $\\mathbf{c}$ is the objective vector, $A_{eq}$ is the equality constraint matrix, $b_{eq}$ is the corresponding right-hand side vector, and $\\mathbf{lb}$ and $\\mathbf{ub}$ are the lower and upper bounds on the variables, respectively.\n\nThe metabolic network is defined by the stoichiometric matrix $S$. The steady-state assumption imposes the mass balance constraint $S \\mathbf{v} = 0$, where $\\mathbf{v} = [v_0, v_1, v_2, v_3, v_4, v_5]^T$ is the vector of reaction fluxes. In the LP formulation, this corresponds to $A_{eq} = S$ and $b_{eq} = 0$. The reaction bounds provide the vectors $\\mathbf{lb}$ and $\\mathbf{ub}$.\n\n**Network Structure and Pathway Analysis**\n\nBefore detailing the computation, we analyze the network's topology. The flux of nutrients enters the system via $R_1$ (uptake of an external substrate, producing $A$) at a maximum rate of $v_0 = 10$. Metabolite $A$ is a precursor that can be converted to metabolite $P$ through two parallel pathways:\n1.  **Pathway B:** $A \\xrightarrow{R_2} B \\xrightarrow{R_4} P$. The fluxes are coupled by mass balance: $v_1 = v_3$.\n2.  **Pathway C:** $A \\xrightarrow{R_3} C \\xrightarrow{R_5} P$. The fluxes are coupled by mass balance: $v_2 = v_4$.\n\nMetabolite $P$ is the precursor for biomass, drained by reaction $R_6$. The steady-state condition for $P$ is $v_3 + v_4 - v_5 = 0$, which implies $v_5 = v_3 + v_4$. The steady-state for $A$ is $v_0 - v_1 - v_2 = 0$, which implies $v_0 = v_1 + v_2$. Combining these with the pathway couplings ($v_1=v_3$, $v_2=v_4$), we find $v_5 = v_3+v_4 = v_1+v_2 = v_0$. This fundamental relationship, $v_5 = v_0$, dictates that the maximum possible biomass production rate is limited by the maximum uptake rate, i.e., $v_5^{\\text{max}} = v_0^{\\text{max}} = 10$. This metabolic structure exhibits redundancy: as long as $v_3+v_4=10$, the biomass objective is maximal, allowing for a flexible trade-off between Pathway B and Pathway C.\n\n**Computational Stages**\n\nFor each intervention case (defined by a set of reaction deletions):\n\n**Stage 1: Optimal Biomass Calculation (FBA)**\nThe first step is to calculate the maximum possible biomass flux, $v_5^\\star$. This is a canonical FBA problem. We solve the following LP:\n$$\n\\begin{align*}\nv_5^\\star = \\max_{\\mathbf{v}} \\quad & v_5 \\\\\n\\text{subject to} \\quad & S \\mathbf{v} = 0 \\\\\n& \\mathbf{lb}' \\le \\mathbf{v} \\le \\mathbf{ub}'\n\\end{align*}\n$$\nThe bounds $\\mathbf{lb}'$ and $\\mathbf{ub}'$ are the base bounds, modified for any reaction deletions specified in the case. For a deleted reaction $R_j$, its flux $v_{j-1}$ is constrained to zero by setting its lower and upper bounds to $0$.\n\n**Stage 2: Flux Variability Analysis (FVA)**\nHaving found the optimal biomass flux $v_5^\\star$, we add a constraint fixing the biomass production to this optimal level: $v_5 = v_5^\\star$. This restricts the feasible flux space to solutions that are optimal with respect to biomass production.\nFor each target reaction of interest, $R_i$ (here, $R_4$ and $R_5$, corresponding to fluxes $v_3$ and $v_4$), we then solve two LPs to find its feasible minimum and maximum flux:\n$$\n\\begin{align*}\nv_i^{\\min} = \\min_{\\mathbf{v}} \\quad & v_i \\\\\n\\text{subject to} \\quad & S \\mathbf{v} = 0 \\\\\n& v_5 = v_5^\\star \\\\\n& \\mathbf{lb}' \\le \\mathbf{v} \\le \\mathbf{ub}'\n\\end{align*}\n$$\n$$\n\\begin{align*}\nv_i^{\\max} = \\max_{\\mathbf{v}} \\quad & v_i \\\\\n\\text{subject to} \\quad & S \\mathbf{v} = 0 \\\\\n& v_5 = v_5^\\star \\\\\n& \\mathbf{lb}' \\le \\mathbf{v} \\le \\mathbf{ub}'\n\\end{align*}\n$$\nA range for reaction $R_i$ is considered \"collapsed\" if $v_i^{\\max} - v_i^{\\min} \\le \\varepsilon$ for the given tolerance $\\varepsilon = 10^{-7}$. The final boolean result for the case is true if and only if the ranges for *both* $R_4$ and $R_5$ are collapsed.\n\n**Analysis of Test Cases**\n\n1.  **Case 1 (No Deletions):** $v_5^\\star = 10$. The FVA is performed under the constraints $v_5 = 10$ and $v_3 + v_4 = 10$. Any distribution of fluxes between $v_3$ and $v_4$ is possible as long as they sum to $10$ (e.g., $(v_3, v_4) = (10, 0)$ or $(0, 10)$ or $(5, 5)$). Thus, $v_3^{\\min}=0, v_3^{\\max}=10$ and $v_4^{\\min}=0, v_4^{\\max}=10$. Neither range collapses. **Result: False.**\n\n2.  **Case 2 (Delete $R_2$):** Deleting $R_2$ sets $v_1=0$, which implies $v_3=0$. The entire Pathway B is shut down. To produce biomass, all flux must go through Pathway C. Thus $v_5 = v_4$. The optimal biomass remains $v_5^\\star = 10$, as Pathway C can carry the full flux ($v_2 = v_4 = v_5 = v_0 = 10$). Under the constraint $v_5=10$, the flux distribution is uniquely determined: $v_3=0$ and $v_4=10$. The ranges for both $v_3$ and $v_4$ collapse to single points ($[0,0]$ and $[10,10]$ respectively). **Result: True.**\n\n3.  **Case 3 (Delete $R_2, R_3$):** Deleting $R_2$ ($v_1=0$) and $R_3$ ($v_2=0$) blocks both parallel pathways originating from metabolite $A$. This implies $v_3 = v_1 = 0$ and $v_4 = v_2 = 0$. Consequently, $v_5 = v_3 + v_4 = 0$. The optimal biomass is $v_5^\\star = 0$. This is a synthetically lethal pair. At $v_5^\\star=0$, the only feasible solution is $\\mathbf{v}=\\mathbf{0}$. The ranges for $v_3$ and $v_4$ are thus $[0,0]$. Both collapse. **Result: True.**\n\n4.  **Case 4 (Delete $R_2, R_5$):** Deleting $R_2$ ($v_1=0$) shuts down Pathway B, so $v_3=0$. Deleting $R_5$ ($v_4=0$) shuts down Pathway C. As both pathways to $P$ are blocked, $v_5 = v_3+v_4 = 0$. This is another synthetically lethal pair. Optimal biomass is $v_5^\\star = 0$. As in Case 3, all fluxes must be zero, so the ranges for $v_3$ and $v_4$ collapse. **Result: True.**\n\n5.  **Case 5 (Delete $R_5$):** This case is symmetric to Case 2. Deleting $R_5$ sets $v_4=0$, shutting down Pathway C. All flux must go through Pathway B. Optimal biomass is $v_5^\\star = 10$. At this optimum, the fluxes are uniquely determined: $v_4=0$ and $v_3=10$. The ranges for both $v_3$ and $v_4$ collapse. **Result: True.**\n\nThe implementation will follow this logic, using `scipy.optimize.linprog` to solve the required LP problems for each case.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the Flux Variability Analysis problem for a given metabolic network\n    under different gene knockout conditions.\n    \"\"\"\n    \n    # Stoichiometric matrix S for metabolites (A, B, C, P) and reactions (R1-R6)\n    S = np.array([\n        [1, -1, -1,  0,  0,  0],  # A\n        [0,  1,  0, -1,  0,  0],  # B\n        [0,  0,  1,  0, -1,  0],  # C\n        [0,  0,  0,  1,  1, -1]   # P\n    ])\n    \n    num_reactions = S.shape[1]\n\n    # Base bounds for all reactions v0 to v5\n    base_lb = np.array([0, 0, 0, 0, 0, 0], dtype=float)\n    base_ub = np.array([10, 1000, 1000, 1000, 1000, 1000], dtype=float)\n    \n    # Reactions to monitor with FVA (indices 3 and 4 for R4 and R5)\n    fva_targets = [3, 4]\n    \n    # Numerical tolerance for range collapse\n    epsilon = 1e-7\n\n    # Test cases: tuples of reaction indices to delete (None for no deletion)\n    # Indices correspond to v0, v1, ..., v5\n    test_cases = [\n        (None, None),  # Case 1\n        (1, None),     # Case 2: delete R2\n        (1, 2),        # Case 3: delete R2, R3\n        (1, 4),        # Case 4: delete R2, R5\n        (4, None)      # Case 5: delete R5\n    ]\n\n    final_results = []\n\n    for deletions in test_cases:\n        # 1. SETUP for the current case\n        current_lb = base_lb.copy()\n        current_ub = base_ub.copy()\n        \n        for del_idx in deletions:\n            if del_idx is not None:\n                current_lb[del_idx] = 0.0\n                current_ub[del_idx] = 0.0\n        \n        bounds = list(zip(current_lb, current_ub))\n        \n        # 2. FBA: Compute optimal biomass flux (v5_star)\n        # We maximize v5, which is equivalent to minimizing -v5.\n        c_fba = np.zeros(num_reactions)\n        c_fba[5] = -1.0\n        \n        res_fba = linprog(\n            c=c_fba,\n            A_eq=S,\n            b_eq=np.zeros(S.shape[0]),\n            bounds=bounds,\n            method='highs'\n        )\n\n        if not res_fba.success:\n            # Handle infeasible cases (e.g., lethal knockouts)\n            v5_star = 0.0\n        else:\n            v5_star = -res_fba.fun\n        \n        # Clamp near-zero values to zero to avoid floating point issues\n        if v5_star < epsilon:\n            v5_star = 0.0\n            \n        # 3. FVA: Compute min/max for target fluxes with v5 fixed at v5_star\n        fva_bounds = list(zip(current_lb, current_ub))\n        fva_bounds[5] = (v5_star, v5_star) # Enforce optimal biomass\n        \n        collapsed_flags = []\n        for target_idx in fva_targets:\n            # Minimize target flux\n            c_fva_min = np.zeros(num_reactions)\n            c_fva_min[target_idx] = 1.0\n            res_min = linprog(\n                c=c_fva_min,\n                A_eq=S,\n                b_eq=np.zeros(S.shape[0]),\n                bounds=fva_bounds,\n                method='highs'\n            )\n            v_min = res_min.fun if res_min.success else 0.0\n            \n            # Maximize target flux (by minimizing its negative)\n            c_fva_max = np.zeros(num_reactions)\n            c_fva_max[target_idx] = -1.0\n            res_max = linprog(\n                c=c_fva_max,\n                A_eq=S,\n                b_eq=np.zeros(S.shape[0]),\n                bounds=fva_bounds,\n                method='highs'\n            )\n            v_max = -res_max.fun if res_max.success else 0.0\n\n            # Check if the range has collapsed\n            is_collapsed = (v_max - v_min) <= epsilon\n            collapsed_flags.append(is_collapsed)\n            \n        # 4. Final boolean result for the case (both must collapse)\n        final_results.append(all(collapsed_flags))\n\n    # Format the output as specified\n    print(f\"[{','.join(map(str, final_results))}]\".replace(\"True\", \"true\").replace(\"False\", \"false\"))\n\nsolve()\n```"
        }
    ]
}