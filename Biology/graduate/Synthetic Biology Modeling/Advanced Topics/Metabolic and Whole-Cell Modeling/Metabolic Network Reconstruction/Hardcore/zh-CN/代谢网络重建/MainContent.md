## 引言
在系统生物学时代，理解细胞如何作为一个整合的系统来运作，是现代生命科学的核心挑战之一。细胞内数以千计的生化反应交织成复杂的代谢网络，精确调控着物质与能量的流动，决定了从生长、繁殖到应对环境变化的各种[生命表](@entry_id:154706)型。然而，这种复杂性使得仅凭直觉或对孤立途径的分析难以把握其整体行为。为了克服这一障碍，我们将目光投向了代谢网络重建——一个将生物体的代谢潜能系统地转化为一个结构化、可计算的数学模型的过程。

本文旨在全面阐释代谢网络重建这一强大方法。我们将首先在“原理与机制”一章中，深入探讨构建这些模型的基础，从底层的[化学计量学](@entry_id:140916)表示和伪[稳态假设](@entry_id:269399)，到如何整合基因组信息和施加[物理化学](@entry_id:145220)约束，最终定义一个能够模拟[细胞生长](@entry_id:175634)的目标函数。随后，在“应用与跨学科连接”一章中，我们将展示这些模型如何作为预测平台，在[代谢工程](@entry_id:139295)、系统医学和[微生物生态学](@entry_id:190481)等前沿领域中解决实际问题。最后，“动手实践”部分将提供具体的计算练习，以巩固核心概念。通过这三章的学习，读者将掌握[代谢网络](@entry_id:166711)重建的核心思想，并理解其作为连接[基因型与表型](@entry_id:142682)的桥梁所具有的巨大潜力。

## 原理与机制

在理解代谢网络的复杂性时，我们必须首先建立一个能够捕捉其结构和功能的数学框架。代谢网络重建的核心在于将生物化学知识系统地转化为一个可计算的模型。本章将详细阐述构建这些模型所依据的基本原理和核心机制，从[化学计量学](@entry_id:140916)的[基本表示](@entry_id:157678)法，到基因组信息与网络反应的关联，再到施加[物理化学](@entry_id:145220)约束和定义细胞生理目标的复杂过程。

### 代谢网络的[化学计量学](@entry_id:140916)表示

[代谢网络模型](@entry_id:751920)的基础是[质量守恒定律](@entry_id:147377)。在一个定义明确的系统（如一个细胞或细胞区室）中，任何代谢物的净产量必须等于其总产出率减去其总消耗率。为了系统地描述这一点，我们使用**[化学计量矩阵](@entry_id:275342) (stoichiometric matrix)**，记为 $S$。

该矩阵是[网络拓扑](@entry_id:141407)和[反应化学计量](@entry_id:274554)的定量编码。对于一个包含 $m$ 种代谢物和 $n$ 个反应的网络，$S$ 是一个 $m \times n$ 的矩阵。按照惯例，矩阵的每一行对应一种代谢物，每一列对应一个反应。矩阵中的每个元素 $S_{ij}$ 代表代谢物 $i$ 在反应 $j$ 中的**化学计量系数**。符号约定至关重要：

*   如果代谢物 $i$ 是反应 $j$ 的**产物**，则 $S_{ij} > 0$。
*   如果代谢物 $i$ 是反应 $j$ 的**底物**（被消耗），则 $S_{ij}  0$。
*   如果代谢物 $i$ **不参与**反应 $j$，则 $S_{ij} = 0$。

非零元素 $S_{ij}$ 的存在表明代谢物 $i$ 和反应 $j$ 之间存在连接，从而编码了网络的结构。例如，考虑一个包含代谢物 $\mathrm{A}$、$\mathrm{B}$、$\mathrm{C}$ 和三个反应的极简系统 ：
*   $R_1: \mathrm{A} \rightarrow \mathrm{B}$
*   $R_2: \mathrm{B} + \mathrm{C} \rightarrow 2\mathrm{A}$
*   $R_3: \mathrm{C} \rightarrow \emptyset$ （其中 $\emptyset$ 表示从系统中移除）

对于这个系统，[化学计量矩阵](@entry_id:275342) $S$ 将如下构建：
$$
S = \begin{pmatrix}
-1   2   0 \\
1   -1   0 \\
0   -1   -1
\end{pmatrix}
$$
第一行代表代谢物 A，它在 $R_1$ 中被消耗（系数为 -1），在 $R_2$ 中产生（系数为 2）。第二行和第三行分别代表代谢物 B 和 C，依此类推。

如果我们用向量 $\mathbf{c} \in \mathbb{R}^m$ 表示代谢物浓度，用向量 $\mathbf{v} \in \mathbb{R}^n$ 表示[反应速率](@entry_id:185114)（通量），那么整个系统的动态[质量平衡](@entry_id:181721)可以用一个简洁的常微分方程组来描述：
$$
\frac{d\mathbf{c}}{dt} = S\mathbf{v}
$$
然而，在许多生物学场景中，特别是对于微生物的[稳态](@entry_id:139253)生长，胞内代谢物的浓度变化远快于[细胞生长](@entry_id:175634)等其他过程。这引出了**伪[稳态假设](@entry_id:269399) (pseudo-steady-state assumption, PSSA)**，即我们假设胞内代谢物的浓度不随时间变化。在此假设下，$\frac{d\mathbf{c}}{dt} = \mathbf{0}$，上述动态方程简化为约束代谢网络通量的核心[代数方程](@entry_id:272665)：
$$
S\mathbf{v} = \mathbf{0}
$$
这个[线性方程组](@entry_id:148943)是[通量平衡分析](@entry_id:155597)（FBA）和所有[基于约束的建模](@entry_id:173286)方法的基础。它没有说明通量的值应该是多少，但它定义了一个所有可能[稳态通量](@entry_id:1132352)分布所必须存在的空间。

### 定义网络组件与边界

一个完整的[代谢模型](@entry_id:167873)不仅需要化学计量，还需要对反应的生物学背景进行精确分类，包括它们在细胞内的位置以及它们如何与环境相互作用。

#### 区室、转运与交换反应

细胞不是一个均匀混合的袋子。代谢过程发生在不同的**区室 (compartments)**中，例如细胞质 `[c]`、线粒体 `[m]` 或细胞外空间 `[e]`。在模型重建中，必须为每个代谢物明确其所在的区室。这种[区室化](@entry_id:270828)使我们能够区分不同类型的反应 ：

*   **内部代谢反应 (Internal metabolic reactions)**：所有底物和产物都位于**同一**区室内的化学转化。例如，[乳酸脱氢酶](@entry_id:166273)催化的反应 $R_4: \mathrm{lac}[c] + \mathrm{nad}^+[c] \rightarrow \mathrm{pyr}[c] + \mathrm{nadh}[c] + \mathrm{h^+}[c]$ 完全发生在细胞质中。

*   **内部转运反应 (Internal transport reactions)**：将一种或多种代谢物从一个生物区室移动到另一个。这些反应代表了跨[膜转运蛋白](@entry_id:172225)的活动，例如，将葡萄糖从细胞外摄取到细胞质的反应 $R_1: \mathrm{glc}[e] \rightarrow \mathrm{glc}[c]$，或将[质子泵](@entry_id:140469)出细胞的反应 $R_3: \mathrm{h^+}[c] \rightarrow \mathrm{h^+}[e]$。

*   **交换反应 (Exchange reactions)**：定义了模型系统与其环境之间的边界。它们将细胞外区室 `[e]` 中的代谢物与一个代表无限外部环境的**伪区室**（通常表示为 $\emptyset$）连接起来。这些反应模拟了营养物质的吸收和代谢废物的分泌。例如，$R_2: \mathrm{o_2}[e] \rightleftharpoons \emptyset$ 表示细胞与环境之间的氧气交换。

*   **需求反应 (Demand reactions)** 或**汇反应 (Sink reactions)** 是一类特殊的边界反应，它们消耗一个**内部**代谢物到伪区室 $\emptyset$ 中。例如，$R_5: \mathrm{atp}[c] \rightarrow \emptyset$ 可以用来模拟细胞用于非生长相关维持过程的ATP消耗。

#### [氧化还原平衡](@entry_id:1130746)：[化学计量](@entry_id:137450)一致性的结果

**[氧化还原平衡](@entry_id:1130746) (Redox balance)** 并非模型中一个额外的、独立的约束，而是将 $S\mathbf{v} = \mathbf{0}$ 约束应用于[氧化还原](@entry_id:138446)[辅因子](@entry_id:137503)（如 $\mathrm{NADH}/\mathrm{NAD}^+$, $\mathrm{NADPH}/\mathrm{NADP}^+$, $\mathrm{FAD}/\mathrm{FADH}_2$）的直接结果 。[稳态假设](@entry_id:269399)要求每种形式的[辅因子](@entry_id:137503)（例如 $\mathrm{NADH}$）的总产出率必须精确等于其总消耗率。这确保了模型中没有凭空产生或湮灭还原当量。

在[代谢网络](@entry_id:166711)中，不同的氧化还原[辅因子](@entry_id:137503)具有不同的生理作用：

*   **NADH/NAD+**：这对[辅因子](@entry_id:137503)主要参与**[分解代谢](@entry_id:141081)**途径。细胞通常维持较高的 $[\mathrm{NAD}^+]/[\mathrm{NADH}]$ 比率，以利于氧化反应，如[糖酵解](@entry_id:176090)（示例反应 $R_1$）。产生的 $\mathrm{NADH}$ 必须通过[呼吸作用](@entry_id:906901)（$R_3$）或[发酵](@entry_id:144068)（$R_2$）来再生 $\mathrm{NAD}^+$。

*   **NADPH/NADP+**：这对[辅因子](@entry_id:137503)是**[合成代谢](@entry_id:141041)**中的主要[还原剂](@entry_id:269392)。细胞维持较高的 $[\mathrm{NADPH}]/[\mathrm{NADP}^+]$ 比率，为[生物合成](@entry_id:174272)（$R_5$）提供驱动力。$\mathrm{NADPH}$ 主要通过戊糖磷酸途径（$R_4$）等途径产生。由于功能上的分离，将这两个[辅因子](@entry_id:137503)池（NADH和NADPH）合并是严重的建模错误。特定的**[转氢酶](@entry_id:193091)**（$R_6$）是它们之间受调控的桥梁。

*   **FAD/[FADH2](@entry_id:167044)**：与自由扩散的NAD(P)H不同，FAD通常作为**[辅基](@entry_id:165601)**紧密结合在酶上。例如，在[电子传递链](@entry_id:145010)的[复合物II](@entry_id:163438)（琥珀酸[脱氢酶](@entry_id:185854)）中，FAD被还原成[FADH2](@entry_id:167044)，然后立即将[电子传递](@entry_id:136976)给下一个载体（如[泛醌](@entry_id:176257)Q），自身变回FAD。因此，最佳建模实践是将整个过程表示为一个净反应（$R_7: \mathrm{Succ}_m + \mathrm{Q}_m \rightarrow \mathrm{Fum}_m + \mathrm{QH_2}_m$），而不是创建一个生理上并不存在的游离[FADH2](@entry_id:167044)池 。

### 从基因组到网络：基因-蛋白-反应关联

一个[代谢网络模型](@entry_id:751920)应能反映特定生物体的遗传潜力。**基因-蛋白-反应 (Gene-Protein-Reaction, GPR)** 关联提供了从基因组到功能反应的正式链接。GPRs使用[布尔逻辑](@entry_id:143377)规则来描述哪些基因的存在是催化一个特定反应的必要和充分条件 。

*   **AND 逻辑 ($\land$)**：用于描述由多个不同亚基组成的**酶复合物**。所有亚基（由不同基因编码）都必须存在，酶才有活性。

*   **OR 逻辑 ($\lor$)**：用于描述**[同工酶](@entry_id:894871)**（isoenzymes），即由不同基因编码但催化相同反应的多种酶。只要其中任何一种酶存在，反应就能发生。这也适用于酶复合物中可替换的亚基。

让我们通过一个例子来阐明这一点。假设反应 $R_X$ 可以由两种方式催化：一种是由基因 $g_\gamma$ 编码的单体[同工酶](@entry_id:894871) $\gamma$；另一种是由一个异源二聚体复合物催化，该复合物需要亚基 $\alpha$ 和亚基 $\beta$。亚基 $\alpha$ 可以由基因 $g_{\alpha1}$ 或 $g_{\alpha2}$ 产生，而亚基 $\beta$ 可以由基因 $g_{\beta1}$ 或 $g_{\beta2}$ 产生。

我们可以将这个逻辑层次化地翻译成一个[布尔表达式](@entry_id:262805)：
1.  亚基 $\alpha$ 的存在条件是：$(g_{\alpha1} \lor g_{\alpha2})$。
2.  亚基 $\beta$ 的存在条件是：$(g_{\beta1} \lor g_{\beta2})$。
3.  异源二聚体复合物的存在条件是两者都存在：$((g_{\alpha1} \lor g_{\alpha2}) \land (g_{\beta1} \lor g_{\beta2}))$。
4.  反应 $R_X$ 的总催化条件是单体酶或复合物存在：$g_{\gamma} \lor \left( (g_{\alpha1} \lor g_{\alpha2}) \land (g_{\beta1} \lor g_{\beta2}) \right)$。

这个GPR表达式使得模型能够用于模拟[基因敲除](@entry_id:145810)实验并预测其对[代谢网络](@entry_id:166711)功能的影响。

### 重建工作流：组装与校正

构建一个[全基因组](@entry_id:195052)规模的代谢网络是一个复杂的过程，它依赖于自动化的工作流程和细致的人工校正。

#### 利用生化数据库

重建过程始于从公共数据库中收集信息 。
*   **KEGG** 和 **MetaCyc** 等数据库是生化知识的宝库，提供了关于代谢物、反应、酶和途径的详细信息。它们是将[基因注释](@entry_id:164186)（例如，[EC编号](@entry_id:164157)）映射到具体、平衡的化学反应的主要来源。
*   **BiGG Models** 数据库是一个高质量、经人工校正的[全基因组](@entry_id:195052)规模[代谢模型](@entry_id:167873)的集合。它不仅提供了可用作模板的模型，还建立了一个标准化的命名空间，促进了模型之间的比较和整合。

#### [从头组装](@entry_id:172264) vs. 基于模板的重建

主要有两种重建策略 ：
*   **[从头组装](@entry_id:172264) (De novo assembly)** 是一种“自下而上”的方法。它始于目标生物体的基因组注释，将每个与代谢相关的基因映射到数据库中的反应，从而构建一个“草图”网络。这种方法的优点是无偏见，但缺点是草图网络通常高度不完整，充满了断开的路径。

*   **基于模板的重建 (Template-based bootstrapping)** 是一种“比较”或“自上而下”的方法。它利用一个来自[系统发育](@entry_id:137790)上相近的、已经过充分校正的物种的模型作为模板。通过基因[直系同源](@entry_id:163003)性映射，模板网络的反应、[GPR规则](@entry_id:274031)、区室信息等被转移到新模型中。这种方法通常更高效，能产生一个更完整的初始模型，因为它也继承了那些没有明确基因证据但对模型功能至关重要的反应（如许多转运反应）。

#### 识别和修复网络缺口

无论采用哪种方法，初始的草图网络几乎总是包含结构缺陷，导致其无法模拟已知的生理功能（例如，在特定培养基上生长）。

*   **末端代谢物 (Dead-end metabolites)** 是指在网络内部只能被生产或只能被消耗的代谢物。**阻断反应 (Blocked reactions)** 是指在任何[稳态](@entry_id:139253)条件下通量都必须为零的反应。在一个简单的线性通路中，例如 $A_{ext} \rightarrow A \rightarrow B \rightarrow C \rightarrow D \rightarrow D_{ext}$，如果增加一个分支 $B \rightarrow E$，而没有反应消耗E，那么E就是一个末端代谢物。[稳态](@entry_id:139253)条件 $(S\mathbf{v})_E = v_{B \to E} = 0$ 强制要求反应 $B \to E$ 被阻断 。这些缺陷代表了我们知识中的“缺口”，降低了模型的连通性和预测能力。

*   **补缺 (Gap filling)** 是一个计算过程，旨在通过从通用反应数据库中添加最少数量的反应来修复这些缺口，以使模型能够实现一个已知的生物学功能 。这个问题通常被构建为一个**混合整数线性规划 (Mixed-Integer Linear Programming, MILP)** 问题。

*   区分**拓扑补缺**和**[热力学约束](@entry_id:755911)补缺**非常重要。前者仅关注恢复化学计量上的连通性，可能会引入[热力学](@entry_id:172368)上不可行的**[无效循环](@entry_id:263970) (futile cycles)**（即在没有能量输入的情况下净产生能量，如ATP）。后者则在补缺过程中额外施加了[热力学](@entry_id:172368)可行性约束，通过确保存在一个一致的化学势集合来防止这类[无效循环](@entry_id:263970)的产生，从而构建出更符合生物学实际的模型 。

### 施加物理约束与生物学目标

一个结构完整的网络还需要通过[物理化学](@entry_id:145220)约束和生物学目标的定义来进一步完善，使其能够进行有意义的模拟。

#### [热力学约束](@entry_id:755911)与反应方向性

$S\mathbf{v}=\mathbf{0}$ 方程本身并不限制反应的方向。然而，[热力学](@entry_id:172368)第二定律规定，一个反应的净通量只能朝着[吉布斯自由能变](@entry_id:138324) ($\Delta G'$) 为负的方向进行。实际的吉布斯自由能变与[标准吉布斯自由能变](@entry_id:168647) ($\Delta G^{\prime \circ}$) 之间的关系由下式给出 ：
$$
\Delta G^{\prime} = \Delta G^{\prime \circ} + RT \ln Q
$$
其中，$R$ 是气体常数，$T$ 是温度，$Q$ 是**[反应商](@entry_id:145217)**，即产物与底物活度（近似于浓度）的比率。

反应的方[向性](@entry_id:144651)可以通过比较 $Q$ 的生理范围与**平衡常数** $K_{eq}^{\prime}$ 来确定，后者由 $\Delta G^{\prime \circ} = -RT \ln K_{eq}^{\prime}$ 定义。
*   如果生理上所有可能的 $Q$ 值都小于 $K_{eq}^{\prime}$，则 $\Delta G^{\prime}$ 始终为负，反应是**不可逆正向**的。
*   如果所有可能的 $Q$ 值都大于 $K_{eq}^{\prime}$，则 $\Delta G^{\prime}$ 始终为正，反应是**不可逆逆向**的。
*   如果 $K_{eq}^{\prime}$ 位于 $Q$ 的生理范围内，则 $\Delta G^{\prime}$ 的符号可以改变，反应是**可逆的**。

例如，考虑一个反应 $A + B \rightleftharpoons C$，其 $\Delta G^{\prime \circ} = +4.0 \text{ kJ mol}^{-1}$，在 $310 \text{ K}$ 时，计算得出 $K_{eq}^{\prime} \approx 0.212$。如果代谢物活度的生理范围导致 $Q$ 的范围为 $[0.1, 10^6]$，由于 $K_{eq}^{\prime}$ 落在了这个区间内，该反应必须被视为可逆的，因为它既可以正向进行（当 $Q  0.212$ 时），也可以逆向进行（当 $Q > 0.212$ 时）。这些方[向性](@entry_id:144651)约束被编码为通量的上下界 $(l \le v \le u)$。

#### 生物质[目标函数](@entry_id:267263)：模拟生长

为了使用模型预测生长等复杂的细胞功能，我们需要一个数学表达式来代表这个目标。**生物质[目标函数](@entry_id:267263) (Biomass Objective Function, BOF)** 就是这样一个“伪反应”，它从网络中消耗所有生产新细胞所需的生物分子前体（如氨基酸、[核苷酸](@entry_id:275639)、脂质）和能量（ATP）。

BOF的化学计量系数经过精心测量和计算，以精确反映合成1克干重（gDW）细胞所需的每种组分的毫摩尔数。通过将BOF的通量 $v_{biomass}$ 的单位归一化为 $\mathrm{h^{-1}}$，其值就直接对应于细胞的比生长速率 $\mu$。

在BOF中，ATP的消耗代表了与生长直接相关的能量成本，即**生长相关维持能量 (Growth-Associated Maintenance, GAM)**。然而，细胞即使不生长，也需要消耗能量来维持基本功能（如维持膜电位、[蛋白质周转](@entry_id:181997)等）。这部分能量消耗被称为**非生长相关维持能量 (Non-Growth-Associated Maintenance, NGAM)**。根据Pirt的经验模型，总ATP消耗率 $v_{\mathrm{ATP,tot}}$ 与生长速率 $\mu$ 的关系可以描述为：
$$
v_{\mathrm{ATP,tot}} \approx a \mu + b
$$
在模型中，这两个参数通过不同方式实现 ：
*   **GAM** ($a$) 是与生长成比例的能量消耗，单位为 $\mathrm{mmol \ ATP \ gDW^{-1}}$。它被实现为BOF内部[ATP水解](@entry_id:142984)的化学计量系数。例如，如果 $a = 50$，则BOF中会包含一项 $-50 \cdot \mathrm{ATP}$。
*   **NGAM** ($b$) 是一个与生长速率无关的恒定能量消耗率，单位为 $\mathrm{mmol \ ATP \ gDW^{-1} \ h^{-1}}$。它通过一个独立的[ATP水解](@entry_id:142984)反应（通常称为A[TPM](@entry_id:170576)）来实现，并为其设置一个固定的最小通量下界，即 $v_{ATPM} \ge b$。

### [基于约束的建模](@entry_id:173286)范式

综上所述，一个代谢网络重建的产物是一个包含了化学计量矩阵 $S$、[GPR关联](@entry_id:273837)、区室信息、反应方向性约束以及生物质[目标函数](@entry_id:267263)的综合性模型。这个模型本身并不预测唯一的通量值，而是定义了一个由约束 $S\mathbf{v}=\mathbf{0}$ 和 $l \le v \le u$ 界定的可行通量解空间。

**[通量平衡分析](@entry_id:155597) (Flux Balance Analysis, FBA)** 正是利用这个框架，通过求解一个**[线性规划](@entry_id:138188) (Linear Programming, LP)** 问题来预测在特定条件下（由交换反应的边界定义）能够最大化某个生物学目标（如[生物质产量](@entry_id:1121612)）的代谢状态 。

FBA与**机理[动力学建模](@entry_id:204326)**形成了鲜明对比：
*   **FBA** 依赖于伪[稳态假设](@entry_id:269399)，不需要动力学参数，预测的是[稳态](@entry_id:139253)下的**通量**分布。
*   **[动力学建模](@entry_id:204326)** 则保留了完整的时间动态性 $\frac{d\mathbf{c}}{dt} = S\mathbf{v}(\mathbf{c}, \boldsymbol{\theta})$，需要详细的[酶动力学](@entry_id:145769)[速率方程](@entry_id:198152)和大量参数 $\boldsymbol{\theta}$（如 $K_m, V_{max}$），通过[求解常微分方程组](@entry_id:173311)（ODEs）来预测**浓度**和通量随时间的变化。

FBA的优势在于其对数据的要求较低，计算规模可扩展至[全基因组](@entry_id:195052)，使其成为系统生物学和[代谢工程](@entry_id:139295)中分析和设计代谢网络不可或缺的工具。