{
    "hands_on_practices": [
        {
            "introduction": "The foundation of Flux Balance Analysis lies in the mathematical representation of a metabolic network. This exercise focuses on the cornerstone of that representation, the stoichiometric matrix $S$, which quantitatively captures the relationships between metabolites and reactions. Mastering the construction of this matrix from a given set of biochemical reactions is the essential first step in building and analyzing any FBA model. ",
            "id": "2038518",
            "problem": "Flux Balance Analysis (FBA) is a computational method used in systems biology to predict the distribution of metabolic fluxes in a biological system. A cornerstone of FBA is the stoichiometric matrix, denoted as $S$, which mathematically represents the metabolic network.\n\nConsider a hypothetical microorganism with a simplified metabolic network. This network consists of four internal metabolites, denoted as A, B, C, and D, and one external precursor metabolite, $M_{in}$. The metabolism is described by the following set of reactions:\n\n1.  **Uptake Reaction ($v_1$):** The cell imports the external precursor $M_{in}$ to produce the internal metabolite A.\n    $v_1: M_{in} \\rightarrow A$\n2.  **Conversion Reaction 1 ($v_2$):** Metabolite A is converted into two units of metabolite B.\n    $v_2: A \\rightarrow 2B$\n3.  **Conversion Reaction 2 ($v_3$):** Metabolite A is converted into one unit of metabolite C and one unit of metabolite D.\n    $v_3: A \\rightarrow C + D$\n4.  **Conversion Reaction 3 ($v_4$):** Metabolite A is converted into three units of metabolite D.\n    $v_4: A \\rightarrow 3D$\n5.  **Exchange Reaction for B ($v_{B,ex}$):** Metabolite B is exported from the cell.\n    $v_{B,ex}: B \\rightarrow$\n6.  **Exchange Reaction for C ($v_{C,ex}$):** Metabolite C is exported from the cell.\n    $v_{C,ex}: C \\rightarrow$\n7.  **Exchange Reaction for D ($v_{D,ex}$):** Metabolite D is exported from the cell.\n    $v_{D,ex}: D \\rightarrow$\n\nYour task is to construct the stoichiometric matrix $S$ for this metabolic network. The matrix should be structured such that the rows correspond to the concentrations of the internal metabolites in the order [A, B, C, D], and the columns correspond to the reaction fluxes in the order [$v_1, v_2, v_3, v_4, v_{B,ex}, v_{C,ex}, v_{D,ex}$].",
            "solution": "We construct the stoichiometric matrix $S$ with rows corresponding to internal metabolites $[A,B,C,D]$ and columns corresponding to reactions $[v_{1},v_{2},v_{3},v_{4},v_{B,ex},v_{C,ex},v_{D,ex}]$. By definition, $S_{i j}$ is the net stoichiometric coefficient of metabolite $i$ in reaction $j$, taken positive for production and negative for consumption.\n\nFor each reaction:\n- Uptake $v_{1}: M_{in} \\rightarrow A$. Internal changes: $A:+1$, $B:0$, $C:0$, $D:0$.\n- Conversion $v_{2}: A \\rightarrow 2B$. Internal changes: $A:-1$, $B:+2$, $C:0$, $D:0$.\n- Conversion $v_{3}: A \\rightarrow C + D$. Internal changes: $A:-1$, $B:0$, $C:+1$, $D:+1$.\n- Conversion $v_{4}: A \\rightarrow 3D$. Internal changes: $A:-1$, $B:0$, $C:0$, $D:+3$.\n- Exchange $v_{B,ex}: B \\rightarrow$. Internal changes: $B:-1$; others $0$.\n- Exchange $v_{C,ex}: C \\rightarrow$. Internal changes: $C:-1$; others $0$.\n- Exchange $v_{D,ex}: D \\rightarrow$. Internal changes: $D:-1$; others $0$.\n\nAssembling by rows $[A,B,C,D]$ and columns $[v_{1},v_{2},v_{3},v_{4},v_{B,ex},v_{C,ex},v_{D,ex}]$, we obtain\n$$\nS=\\begin{pmatrix}\n1 & -1 & -1 & -1 & 0 & 0 & 0 \\\\\n0 & 2 & 0 & 0 & -1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & -1 & 0 \\\\\n0 & 0 & 1 & 3 & 0 & 0 & -1\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\n1 & -1 & -1 & -1 & 0 & 0 & 0 \\\\\n0 & 2 & 0 & 0 & -1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & -1 & 0 \\\\\n0 & 0 & 1 & 3 & 0 & 0 & -1\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "While standard FBA can predict maximal growth, it often yields a range of equally optimal flux distributions, many of which are biologically unrealistic due to excessively high fluxes. Parsimonious FBA (pFBA) addresses this by selecting the single solution that achieves maximum growth with the minimum total metabolic effort, representing an efficient use of cellular resources. This advanced practice challenges you to formalize and solve a pFBA problem, moving from theoretical concept to a concrete numerical solution. ",
            "id": "4342817",
            "problem": "Consider a metabolic network at steady state described by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$ and a flux vector $v \\in \\mathbb{R}^{n}$, with flux bounds $l \\leq v \\leq u$. The steady-state assumption imposes the mass-balance constraints $S v = 0$. Let the cellular growth rate be modeled by a linear objective $c^{\\top} v$, where $c \\in \\mathbb{R}^{n}$ selects the biomass reaction (one component of $v$). Parsimonious Flux Balance Analysis (pFBA) is a lexicographic optimization that first maximizes growth and then minimizes the total flux magnitude. Starting from the foundational steady-state and linear stoichiometric constraints, and without invoking any shortcut formulas, do the following:\n\n1. Formulate pFBA as a bi-level optimization problem that first maximizes growth $c^{\\top} v$ and then, among all optimal growth solutions, minimizes the total flux $\\sum_{i=1}^{n} |v_i|$.\n2. Present an equivalent single-level linear program by introducing appropriate auxiliary variables so that the absolute-value objective is replaced by a linear objective, while preserving the growth optimum $c^{\\top} v = z^{\\star}$ attained in the first level. Provide the final single-level linear program in symbolic form.\n3. Now consider the following concrete network, with internal metabolites $A$, $B$, and $C$, and reactions $R_1$ through $R_6$:\n\n- $R_1$: $A_{\\mathrm{ext}} \\rightarrow A$ with flux $v_1$ and bounds $0 \\leq v_1 \\leq 10$,\n- $R_2$: $A \\rightarrow B$ with flux $v_2$ and bounds $0 \\leq v_2 \\leq 1000$,\n- $R_3$: $A \\rightarrow C$ with flux $v_3$ and bounds $0 \\leq v_3 \\leq 1000$,\n- $R_4$: $B + C \\rightarrow \\mathrm{Biomass}$ with flux $v_4$ and bounds $0 \\leq v_4 \\leq 1000$,\n- $R_5$: $C \\rightarrow C_{\\mathrm{ext}}$ with flux $v_5$ and bounds $0 \\leq v_5 \\leq 1000$,\n- $R_6$: $B \\rightarrow A$ with flux $v_6$ and bounds $0 \\leq v_6 \\leq 1000$.\n\nAssume internal steady-state mass balances for $A$, $B$, and $C$:\n$$\n\\begin{aligned}\nA: &\\quad v_1 - v_2 - v_3 + v_6 = 0, \\\\\nB: &\\quad v_2 - v_4 - v_6 = 0, \\\\\nC: &\\quad v_3 - v_4 - v_5 = 0.\n\\end{aligned}\n$$\nLet the growth (biomass) objective be $c^{\\top} v = v_4$. Under the pFBA framework described above, compute the minimal possible total flux\n$$\n\\sum_{i=1}^{6} |v_i|\n$$\nachievable among all flux vectors $v$ that maximize $v_4$. Express your final numerical answer in $\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$. Provide the exact value; do not round.",
            "solution": "### Part 1: Bi-level Optimization Formulation of pFBA\n\nParsimonious Flux Balance Analysis (pFBA) is a lexicographic optimization problem. This means it solves a sequence of optimization problems, where the optimal value of one problem becomes a constraint for the next.\n\nFirst, we define the feasible space of flux vectors, $\\mathcal{F}$, which contains all fluxes satisfying the steady-state and bound constraints:\n$$\n\\mathcal{F} = \\{v \\in \\mathbb{R}^n \\mid Sv = 0, l \\le v \\le u\\}\n$$\nThe first level of the optimization is a standard FBA problem, which maximizes the cellular growth objective $c^{\\top} v$. We define the optimal growth rate, $z^{\\star}$, as:\n$$\nz^{\\star} = \\max_{v \\in \\mathcal{F}} c^{\\top}v\n$$\nThe second level of the optimization seeks to find, among all the flux distributions that achieve this maximum growth rate $z^{\\star}$, one that minimizes the total flux magnitude, which is the sum of the absolute values of all fluxes. The set of flux vectors that achieve maximal growth is:\n$$\n\\mathcal{F}^{\\star} = \\{v \\in \\mathcal{F} \\mid c^{\\top}v = z^{\\star} \\}\n$$\nThe bi-level pFBA problem can be formally stated as finding a vector $v_{pFBA}$ such that it is the solution to the following minimization problem:\n$$\n\\min_{v \\in \\mathcal{F}^{\\star}} \\sum_{i=1}^{n} |v_i|\n$$\nThis can be written compactly as a lexicographic optimization:\n$$\n\\text{lex max}_{v} \\begin{pmatrix} c^{\\top}v \\\\ -\\sum_{i=1}^{n} |v_i| \\end{pmatrix} \\quad \\text{subject to } v \\in \\mathcal{F}\n$$\n\n### Part 2: Equivalent Single-Level Linear Program\n\nThe bi-level optimization is solved sequentially. After finding the maximal growth rate $z^{\\star}$ from the first LP, the second problem is formulated. The objective function of the second problem, $\\sum_{i=1}^{n} |v_i|$, is non-linear. To convert this into a linear program, we introduce auxiliary variables.\n\nFor each flux $v_i$, we can represent it as the difference of two non-negative variables, $v_i^{+}$ and $v_i^{-}$:\n$$\nv_i = v_i^{+} - v_i^{-}, \\quad \\text{with } v_i^{+} \\ge 0, v_i^{-} \\ge 0\n$$\nThe absolute value $|v_i|$ can then be expressed as the sum of these variables, $|v_i| = v_i^{+} + v_i^{-}$. This representation is valid in the context of a minimization problem because the optimization will inherently drive one of the two variables ($v_i^{+}$ or $v_i^{-}$) to zero to minimize their sum.\n\nThe single-level linear program for the second step of pFBA (minimizing total flux) is formulated as follows, assuming $z^{\\star}$ has been determined:\n\n**Minimize:**\n$$\n\\sum_{i=1}^{n} (v_i^{+} + v_i^{-})\n$$\n**Subject to:**\n1. Steady-state mass balance: $S(v^{+} - v^{-}) = 0$\n2. Maximal growth constraint: $c^{\\top}(v^{+} - v^{-}) = z^{\\star}$\n3. Flux bounds: $l \\le v^{+} - v^{-} \\le u$\n4. Non-negativity of auxiliary variables: $v_i^{+} \\ge 0$ and $v_i^{-} \\ge 0$ for all $i=1, \\dots, n$\n\nHere, $v^{+}$ and $v^{-}$ are vectors containing the $v_i^{+}$ and $v_i^{-}$ variables, respectively. This formulation is a standard linear program.\n\n### Part 3: pFBA for the Concrete Network\n\nWe apply the two-step pFBA procedure to the given metabolic network.\n\n**Step 1: Maximize growth ($v_4$)**\n\nThe problem is to maximize $v_4$ subject to the steady-state equations and flux bounds.\nThe steady-state equations are:\n1. $v_1 - v_2 - v_3 + v_6 = 0$\n2. $v_2 - v_4 - v_6 = 0 \\implies v_2 = v_4 + v_6$\n3. $v_3 - v_4 - v_5 = 0 \\implies v_3 = v_4 + v_5$\n\nSubstitute the expressions for $v_2$ and $v_3$ into the first equation:\n$v_1 - (v_4 + v_6) - (v_4 + v_5) + v_6 = 0$\n$v_1 - v_4 - v_6 - v_4 - v_5 + v_6 = 0$\n$v_1 - 2v_4 - v_5 = 0 \\implies v_1 = 2v_4 + v_5$\n\nAll fluxes $v_i$ are constrained to be non-negative. The variables on the right-hand side ($v_4, v_5, v_6$) are independent, subject to the flux bounds. The constraints on $v_1, v_2, v_3$ must also be satisfied.\nThe crucial bound is $0 \\le v_1 \\le 10$. Substituting the expression for $v_1$:\n$0 \\le 2v_4 + v_5 \\le 10$\n\nWe wish to maximize $v_4$. Since $v_4 \\ge 0$ and $v_5 \\ge 0$, the term $2v_4 + v_5$ is always non-negative, so the lower bound $0 \\le 2v_4 + v_5$ is satisfied. To maximize $v_4$ under the constraint $2v_4 + v_5 \\le 10$, we must make $v_5$ as small as possible. The lower bound for $v_5$ is $0$.\nSetting $v_5 = 0$, the constraint becomes $2v_4 \\le 10$, which implies $v_4 \\le 5$.\nTherefore, the maximum possible growth rate is $z^{\\star} = v_{4, \\text{max}} = 5$.\n\nLet's verify that a valid flux distribution exists for $v_4=5$.\nIf $v_4 = 5$ and $v_5 = 0$:\n- $v_1 = 2(5) + 0 = 10$. This satisfies $0 \\le v_1 \\le 10$.\n- $v_3 = v_4 + v_5 = 5 + 0 = 5$. This satisfies $0 \\le v_3 \\le 1000$.\n- $v_2 = v_4 + v_6 = 5 + v_6$. The bound on $v_2$ is $0 \\le v_2 \\le 1000$. Since $v_6 \\ge 0$, $v_2 \\ge 5$, satisfying the lower bound. The upper bound requires $5 + v_6 \\le 1000$, so $v_6 \\le 995$.\n- The bound on $v_6$ is $0 \\le v_6 \\le 1000$. The combined constraint on $v_6$ is thus $0 \\le v_6 \\le 995$.\n\nAny flux vector with $v_4=5$, $v_5=0$, and $v_6 \\in [0, 995]$ will achieve maximal growth.\n\n**Step 2: Minimize total flux magnitude**\n\nNow we minimize the total flux sum, $\\sum_{i=1}^{6} |v_i|$, subject to $v_4 = 5$. Since all fluxes $v_i$ are constrained to be non-negative, $|v_i| = v_i$. The objective is to minimize $\\sum_{i=1}^{6} v_i$.\nThe fluxes corresponding to maximal growth can be expressed in terms of the free parameter $v_6$:\n- $v_1 = 10$\n- $v_2 = 5 + v_6$\n- $v_3 = 5$\n- $v_4 = 5$\n- $v_5 = 0$\n- $v_6$ is the variable, with $v_6 \\in [0, 995]$.\n\nThe total flux sum, $J$, is:\n$J = v_1 + v_2 + v_3 + v_4 + v_5 + v_6$\n$J = 10 + (5 + v_6) + 5 + 5 + 0 + v_6$\n$J = 25 + 2v_6$\n\nTo minimize $J$, we must choose the smallest possible value for $v_6$ from its allowed range $[0, 995]$. The minimum value is $v_6 = 0$.\nWith $v_6 = 0$, the minimal total flux is $J_{min} = 25 + 2(0) = 25$.\n\nThe unique pFBA flux vector is:\n- $v_1 = 10$\n- $v_2 = 5 + 0 = 5$\n- $v_3 = 5$\n- $v_4 = 5$\n- $v_5 = 0$\n- $v_6 = 0$\n\nThe sum of these fluxes is $10 + 5 + 5 + 5 + 0 + 0 = 25$. The units for this value are given as $\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$.",
            "answer": "$$\\boxed{25}$$"
        },
        {
            "introduction": "A primary goal of metabolic engineering is the rational design of microbial strains for specific purposes, such as maximizing the production of a valuable chemical. This often requires identifying which genes to knock out to disable competing or undesirable pathways while maintaining cell viability. This practice delves into the computation of minimal cut sets, an advanced FBA application that systematically identifies the most efficient knockout strategies to achieve a desired metabolic phenotype. ",
            "id": "4342819",
            "problem": "You are given the task of computing minimal cut sets in flux balance analysis for small stoichiometric models, grounded in the steady-state assumption and mass balance. The fundamental base is as follows. A metabolic network is represented by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$ with $m$ metabolites and $n$ reactions. A flux vector $v \\in \\mathbb{R}^n$ is at steady state if and only if $S v = 0$. Each reaction $j$ has lower and upper bounds $l_j \\le v_j \\le u_j$, capturing reversibility and enzyme capacity. An undesired pathway is characterized by a specific target reaction index $t \\in \\{0,1,\\dots,n-1\\}$ and a minimal target flux $t_{\\min} \\in \\mathbb{R}_{\\ge 0}$. Biomass production is represented by a nonnegative linear functional $b^\\top v$ with $b \\in \\mathbb{R}_{\\ge 0}^n$, and viability requires the existence of a steady-state flux $v$ with $b^\\top v \\ge g_{\\min}$ for a given threshold $g_{\\min} \\in \\mathbb{R}_{\\ge 0}$.\n\nA knockout set $C \\subseteq \\{0,1,\\dots,n-1\\}$ imposes $v_j = 0$ for all $j \\in C$. A knockout set $C$ blocks the undesired pathway if and only if every steady-state flux $v$ satisfying the bounds and the knockouts also satisfies $v_t < t_{\\min}$. A knockout set $C$ preserves growth if and only if there exists a steady-state flux $v$ with bounds and knockouts such that $b^\\top v \\ge g_{\\min}$. A minimal cut set is an inclusion-minimal knockout set $C$ that simultaneously blocks the undesired pathway and preserves growth. Inclusion-minimal means that no proper subset of $C$ has the same properties.\n\nYour program must, for each test case below, compute all inclusion-minimal cut sets that block the undesired pathway while preserving growth. All reaction indices are zero-based integers. All linear feasibility and optimality comparisons must use an absolute numerical tolerance of $10^{-9}$ and strict comparison for blocking, that is, a target is considered blocked if and only if $\\max v_t \\le t_{\\min} - 10^{-9}$ under the constraints.\n\nYou must produce results for the following three test cases, each fully specified by a matrix $S$, bounds $(l,u)$, a target reaction index $t$, a biomass coefficient vector $b$, and thresholds $(t_{\\min}, g_{\\min})$. In all models, all fluxes are in arbitrary but consistent units; no unit conversion is required. Express all requested outputs as lists of integers or lists of such lists as described below.\n\nTest Case 1 (single-branch secretion model):\n- Stoichiometric matrix $S \\in \\mathbb{R}^{1 \\times 3}$ with metabolites ordered as $\\{A\\}$ and reactions ordered as $\\{R_0, R_1, R_2\\}$:\n  $$\n  S = \\begin{bmatrix}\n  1 & -1 & -1\n  \\end{bmatrix}.\n  $$\n  Here, $R_0$ is uptake $(\\to A)$, $R_1$ is biomass $(A \\to)$, and $R_2$ is secretion $(A \\to)$.\n- Bounds: $l = [0, 0, 0]$, $u = [10, 1000, 1000]$.\n- Target reaction index: $t = 2$.\n- Biomass objective coefficients: $b = [0, 1, 0]$ so that $b^\\top v = v_1$.\n- Thresholds: $t_{\\min} = 0.5$, $g_{\\min} = 1.0$.\n\nTest Case 2 (two-substrate growth with one undesired branch):\n- Stoichiometric matrix $S \\in \\mathbb{R}^{2 \\times 5}$ with metabolites ordered as $\\{A_1, A_2\\}$ and reactions ordered as $\\{R_0, R_1, R_2, R_3, R_4\\}$:\n  $$\n  S = \\begin{bmatrix}\n  1 & -1 & -1 & 0 & 0 \\\\\n  0 & 0 & 0 & 1 & -1\n  \\end{bmatrix}.\n  $$\n  Here, $R_0$ is uptake $(\\to A_1)$, $R_1$ is biomass $(A_1 \\to)$, $R_2$ is secretion target $(A_1 \\to)$, $R_3$ is a second uptake $(\\to A_2)$, and $R_4$ is biomass $(A_2 \\to)$.\n- Bounds: $l = [0, 0, 0, 0, 0]$, $u = [10, 1000, 1000, 10, 1000]$.\n- Target reaction index: $t = 2$.\n- Biomass objective coefficients: $b = [0, 1, 0, 0, 1]$ so that $b^\\top v = v_1 + v_4$.\n- Thresholds: $t_{\\min} = 0.5$, $g_{\\min} = 1.0$.\n\nTest Case 3 (target already infeasible at the chosen threshold):\n- Stoichiometric matrix $S \\in \\mathbb{R}^{1 \\times 3}$ with metabolites ordered as $\\{A\\}$ and reactions ordered as $\\{R_0, R_1, R_2\\}$:\n  $$\n  S = \\begin{bmatrix}\n  1 & -1 & -1\n  \\end{bmatrix}.\n  $$\n- Bounds: $l = [0, 0, 0]$, $u = [10, 1000, 0.3]$.\n- Target reaction index: $t = 2$.\n- Biomass objective coefficients: $b = [0, 1, 0]$.\n- Thresholds: $t_{\\min} = 0.5$, $g_{\\min} = 1.0$.\n\nYour program must, for each test case, enumerate all inclusion-minimal knockout sets $C$ that block the undesired pathway while preserving growth and return them as a list of increasing lists of reaction indices. For determinism, within each test case, sort the list of minimal cut sets first by cardinality and then lexicographically by their elements. Across test cases, aggregate the three per-case results into a single line of output containing the results as a comma-separated list enclosed in square brackets with no spaces, for example, \"[[[1],[3]],[[0]],[[]]]\".\n\nAll computations must adhere to the steady-state condition $S v = 0$, the bounds $l \\le v \\le u$, and must apply knockouts by fixing $v_j = 0$ for all $j \\in C$. Use a strict absolute tolerance of $10^{-9}$ for comparisons to $t_{\\min}$ and $g_{\\min}$ as specified above.",
            "solution": "The problem is scientifically and mathematically well-defined, providing a complete and consistent specification for computing minimal cut sets in the context of flux balance analysis. Therefore, it is deemed valid and a solution is provided below.\n\n### 1. Foundational Principles and Mathematical Formulation\n\nThe metabolic network is described by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$, where $m$ is the number of metabolites and $n$ is the number of reactions. The vector $v \\in \\mathbb{R}^n$ represents the fluxes through these reactions. The fundamental principle of flux balance analysis is the steady-state assumption, which dictates that the concentrations of internal metabolites do not change over time. This is expressed as a mass balance equation:\n$$\nS v = 0\n$$\nAdditionally, each reaction flux $v_j$ is constrained by lower and upper bounds, $l_j \\le v_j \\le u_j$, which reflect thermodynamic reversibility and enzyme capacity. A reaction knockout, corresponding to deleting a gene, is modeled by setting the flux of the corresponding reaction $j$ to zero, i.e., $v_j = 0$. For a given knockout set $C \\subseteq \\{0, 1, \\dots, n-1\\}$, the constraints $v_j = 0$ are applied for all $j \\in C$.\n\n### 2. Formalizing the Conditions for a Cut Set\n\nA knockout set $C$ is a valid cut set if it simultaneously preserves growth and blocks a target reaction. We must formalize these two conditions as computationally verifiable queries. Both can be formulated as Linear Programs (LPs). A numerical tolerance of $\\delta = 10^{-9}$ is used for all feasibility and optimality comparisons.\n\n#### Growth Preservation\nThe problem states that growth is preserved if there exists a steady-state flux vector $v$ that satisfies the bounds and knockouts, such that the biomass production rate, $b^\\top v$, is at least $g_{\\min}$. To check this, we solve an LP to find the maximum possible biomass production rate under the given constraints.\n\nLet $g_{\\max}(C)$ be the optimal value of the following LP for a given knockout set $C$:\n$$\n\\begin{aligned}\n\\text{maximize} \\quad & b^\\top v \\\\\n\\text{subject to} \\quad & S v = 0 \\\\\n& l_j \\le v_j \\le u_j, \\quad \\forall j \\notin C \\\\\n& v_j = 0, \\quad \\forall j \\in C\n\\end{aligned}\n$$\nThe growth preservation condition is met if this LP is feasible and its optimal value satisfies $g_{\\max}(C) \\ge g_{\\min} - \\delta$. If the LP is infeasible, no flux distribution exists, and thus growth is not preserved.\n\n#### Target Blocking\nThe target reaction $t$ is considered blocked if for all possible steady-state flux vectors $v$ (satisfying bounds and knockouts), the flux $v_t$ is less than the threshold $t_{\\min}$. This is equivalent to stating that the maximum possible flux through reaction $t$ is less than $t_{\\min}$.\n\nLet $v_{t, \\max}(C)$ be the optimal value of the following LP:\n$$\n\\begin{aligned}\n\\text{maximize} \\quad & v_t \\\\\n\\text{subject to} \\quad & S v = 0 \\\\\n& l_j \\le v_j \\le u_j, \\quad \\forall j \\notin C \\\\\n& v_j = 0, \\quad \\forall j \\in C\n\\end{aligned}\n$$\nThe problem specifies a strict inequality for blocking, which is implemented with the tolerance $\\delta$. The blocking condition is met if $v_{t, \\max}(C) \\le t_{\\min} - \\delta$. If this LP is infeasible, it means no steady-state flux vector exists for the set $C$, which vacuously implies that the condition on $v_t$ holds for all (zero) possible flux vectors. Thus, infeasibility also implies the target is blocked.\n\n### 3. Algorithmic Design for Minimal Cut Sets\n\nA minimal cut set is a valid cut set that contains no smaller valid cut set as a proper subset. The strategy to find all such sets is as follows:\n\n1.  **Combinatorial Search**: Since the number of reactions $n$ in the provided test cases is small ($n \\le 5$), we can systematically check every possible subset of reactions. The total number of subsets is $2^n$, which is computationally manageable.\n2.  **Validation**: For each candidate knockout set $C$, we perform the two checks described above by solving the corresponding LPs. If $C$ both preserves growth and blocks the target, it is recorded as a \"valid cut set\".\n3.  **Minimality Filtering**: After identifying all valid cut sets, we filter this collection to retain only those that are inclusion-minimal. A valid cut set $C_1$ is minimal if no other valid cut set $C_2$ is a proper subset of $C_1$ (i.e., $C_2 \\subset C_1$).\n4.  **Sorting**: The final list of minimal cut sets is sorted first by the number of elements (cardinality) in ascending order, and then lexicographically for sets of the same size.\n\n### 4. Implementation Details\n\nThe implementation will be a Python script relying on the `numpy` and `scipy` libraries.\n- The two LPs for checking growth and blocking are solved using the `linprog` function from `scipy.optimize`. Since `linprog` minimizes, the objective function $c$ for a maximization problem with objective $f^\\top v$ is set to $c = -f$.\n- The steady-state constraint $Sv=0$ is passed to `linprog` via the `A_eq` and `b_eq` arguments.\n- The flux bounds $l \\le v \\le u$ and knockouts $v_j=0$ for $j \\in C$ are jointly handled by constructing a `bounds` list of $(min, max)$ tuples for each reaction flux.\n- The generation of all candidate knockout sets is efficiently handled using `itertools.combinations` to generate subsets of increasing size.\n- A custom recursive function is used to format the final list of lists into a space-free string as required by the output specification.",
            "answer": "[[[2]],[[0],[2]],[[]]]"
        }
    ]
}