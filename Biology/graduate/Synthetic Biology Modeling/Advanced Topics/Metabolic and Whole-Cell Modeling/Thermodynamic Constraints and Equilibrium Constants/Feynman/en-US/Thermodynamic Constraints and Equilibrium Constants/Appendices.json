{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of biophysical modeling is the intimate relationship between the kinetics of a reaction and its overall thermodynamic equilibrium. This exercise challenges you to derive this connection from first principles, using the framework of Transition State Theory (TST). By applying the principle of detailed balance at equilibrium, you will demonstrate how the standard equilibrium constant $K_{\\mathrm{eq}}$ is fundamentally determined by the difference between the forward and reverse activation energy barriers, $\\Delta G^{\\ddagger}_{f}$ and $\\Delta G^{\\ddagger}_{r}$ . This practice reinforces the idea that thermodynamics and kinetics are two sides of the same coin, providing a microscopic view of chemical equilibrium.",
            "id": "3938368",
            "problem": "A synthetic biology pathway employs a designed enzyme that catalyzes the reversible interconversion $A \\rightleftharpoons B$. To ensure thermodynamic consistency in the pathway model, the equilibrium constant must be compatible with microscopic reversibility and Transition State Theory (TST). Assume an ideal dilute solution with standard state $1~\\mathrm{M}$, and that both directions of the reaction share a single well-defined transition state dividing surface and the same transmission coefficient.\n\nYou are given the following data measured at temperature $T = 310~\\mathrm{K}$:\n- The standard Gibbs free energy of activation for the forward direction is $\\Delta G^{\\ddagger}_{f} = 52~\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n- The standard Gibbs free energy of activation for the reverse direction is $\\Delta G^{\\ddagger}_{r} = 64~\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n\nUse the following foundational relations:\n- Transition State Theory (TST) rate law: $k = \\kappa \\left(\\frac{k_{B} T}{h}\\right) \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}}{R T}\\right)$, where $\\kappa$ is the transmission coefficient, $k_{B}$ is the Boltzmann constant, $h$ is Planck's constant, and $R$ is the ideal gas constant.\n- The definition of the standard equilibrium constant $K_{\\mathrm{eq}}$ via the standard Gibbs free energy: $\\Delta G^{\\circ} = - R T \\ln K_{\\mathrm{eq}}$.\n\nDerive, from these bases and first principles (including detailed balance at equilibrium), a closed-form expression for the standard equilibrium constant $K_{\\mathrm{eq}}$ in terms of $\\Delta G^{\\ddagger}_{f}$ and $\\Delta G^{\\ddagger}_{r}$, and then compute its numerical value using $R = 8.314~\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. Express your final answer as a pure number (dimensionless) and round your answer to three significant figures.",
            "solution": "The problem requires the derivation of an expression for the standard equilibrium constant, $K_{\\mathrm{eq}}$, and its numerical calculation for the reversible reaction $A \\rightleftharpoons B$. The derivation will be founded on the principle of detailed balance at equilibrium, combined with the Transition State Theory (TST) expression for rate constants.\n\nFirst, we invoke the principle of detailed balance. At thermodynamic equilibrium, the rate of every elementary process is equal to the rate of its reverse process. For the reaction $A \\rightleftharpoons B$, this means the forward reaction rate, $v_f$, must equal the reverse reaction rate, $v_r$. The rates are given by mass-action kinetics:\n$$v_f = k_f [A]_{\\mathrm{eq}}$$\n$$v_r = k_r [B]_{\\mathrm{eq}}$$\nwhere $k_f$ and $k_r$ are the forward and reverse rate constants, respectively, and $[A]_{\\mathrm{eq}}$ and $[B]_{\\mathrm{eq}}$ are the concentrations at equilibrium.\n\nAt equilibrium, $v_f = v_r$, which implies:\n$$k_f [A]_{\\mathrm{eq}} = k_r [B]_{\\mathrm{eq}}$$\n\nThe standard equilibrium constant, $K_{\\mathrm{eq}}$, is defined by the ratio of the equilibrium concentrations of products to reactants (raised to their stoichiometric powers, which are $1$ in this case):\n$$K_{\\mathrm{eq}} = \\frac{[B]_{\\mathrm{eq}}}{[A]_{\\mathrm{eq}}}$$\n\nBy rearranging the detailed balance equation, we can express $K_{\\mathrm{eq}}$ as the ratio of the rate constants:\n$$K_{\\mathrm{eq}} = \\frac{k_f}{k_r}$$\n\nNext, we use the provided Transition State Theory (TST) rate law to express $k_f$ and $k_r$. The general form is:\n$$k = \\kappa \\left(\\frac{k_{B} T}{h}\\right) \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}}{R T}\\right)$$\nApplying this to the forward and reverse reactions, we have:\n$$k_f = \\kappa \\left(\\frac{k_{B} T}{h}\\right) \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{f}}{R T}\\right)$$\n$$k_r = \\kappa \\left(\\frac{k_{B} T}{h}\\right) \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{r}}{R T}\\right)$$\nHere, $\\Delta G^{\\ddagger}_{f}$ and $\\Delta G^{\\ddagger}_{r}$ are the standard Gibbs free energies of activation for the forward and reverse directions, respectively. The problem states that the transmission coefficient, $\\kappa$, is the same for both directions. The pre-exponential factor $\\kappa \\left(\\frac{k_{B} T}{h}\\right)$ is therefore identical for $k_f$ and $k_r$.\n\nSubstituting these expressions for the rate constants into our equation for $K_{\\mathrm{eq}}$:\n$$K_{\\mathrm{eq}} = \\frac{k_f}{k_r} = \\frac{\\kappa \\left(\\frac{k_{B} T}{h}\\right) \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{f}}{R T}\\right)}{\\kappa \\left(\\frac{k_{B} T}{h}\\right) \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{r}}{R T}\\right)}$$\n\nThe common pre-exponential terms cancel, simplifying the expression significantly:\n$$K_{\\mathrm{eq}} = \\frac{\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{f}}{R T}\\right)}{\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{r}}{R T}\\right)}$$\n\nUsing the property of exponents $\\frac{\\exp(a)}{\\exp(b)} = \\exp(a-b)$, we obtain the closed-form expression for $K_{\\mathrm{eq}}$ in terms of the activation energies:\n$$K_{\\mathrm{eq}} = \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{f}}{R T} - \\left(-\\frac{\\Delta G^{\\ddagger}_{r}}{R T}\\right)\\right) = \\exp\\!\\left(\\frac{\\Delta G^{\\ddagger}_{r} - \\Delta G^{\\ddagger}_{f}}{R T}\\right)$$\nThis is the required derived expression. It demonstrates that the equilibrium constant is determined by the difference between the forward and reverse activation energy barriers.\n\nFor completeness, we can relate this to the standard Gibbs free energy of reaction, $\\Delta G^{\\circ}$. From a reaction energy profile, the difference in the energies of the product and reactant states is $\\Delta G^{\\circ} = G^{\\circ}_{\\mathrm{product}} - G^{\\circ}_{\\mathrm{reactant}}$. This is also equal to the difference between the activation energies: $\\Delta G^{\\circ} = \\Delta G^{\\ddagger}_{f} - \\Delta G^{\\ddagger}_{r}$. Substituting this into our derived expression yields:\n$$K_{\\mathrm{eq}} = \\exp\\!\\left(\\frac{-(\\Delta G^{\\ddagger}_{f} - \\Delta G^{\\ddagger}_{r})}{R T}\\right) = \\exp\\!\\left(-\\frac{\\Delta G^{\\circ}}{R T}\\right)$$\nThis is consistent with the provided thermodynamic relationship $\\Delta G^{\\circ} = - R T \\ln K_{\\mathrm{eq}}$, validating our derivation from kinetic principles.\n\nNow, we proceed to the numerical calculation. The given values are:\n$\\Delta G^{\\ddagger}_{f} = 52~\\mathrm{kJ}\\,\\mathrm{mol}^{-1} = 52000~\\mathrm{J}\\,\\mathrm{mol}^{-1}$\n$\\Delta G^{\\ddagger}_{r} = 64~\\mathrm{kJ}\\,\\mathrm{mol}^{-1} = 64000~\\mathrm{J}\\,\\mathrm{mol}^{-1}$\n$T = 310~\\mathrm{K}$\n$R = 8.314~\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n\nFirst, we calculate the difference in the activation energies:\n$$\\Delta G^{\\ddagger}_{r} - \\Delta G^{\\ddagger}_{f} = 64000~\\mathrm{J}\\,\\mathrm{mol}^{-1} - 52000~\\mathrm{J}\\,\\mathrm{mol}^{-1} = 12000~\\mathrm{J}\\,\\mathrm{mol}^{-1}$$\n\nNext, we calculate the product $R T$:\n$$R T = (8.314~\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (310~\\mathrm{K}) \\approx 2577.34~\\mathrm{J}\\,\\mathrm{mol}^{-1}$$\n\nNow we can compute the value of the exponent in the expression for $K_{\\mathrm{eq}}$:\n$$\\frac{\\Delta G^{\\ddagger}_{r} - \\Delta G^{\\ddagger}_{f}}{R T} = \\frac{12000~\\mathrm{J}\\,\\mathrm{mol}^{-1}}{2577.34~\\mathrm{J}\\,\\mathrm{mol}^{-1}} \\approx 4.65583$$\n\nFinally, we calculate $K_{\\mathrm{eq}}$:\n$$K_{\\mathrm{eq}} = \\exp(4.65583) \\approx 105.193$$\n\nThe problem requires the answer to be rounded to three significant figures.\n$$K_{\\mathrm{eq}} \\approx 105$$\nThe final answer is a dimensionless quantity as expected for an equilibrium constant defined in terms of standard states.",
            "answer": "$$\\boxed{105}$$"
        },
        {
            "introduction": "Life's processes often require reactions that are thermodynamically unfavorable on their own, and cells overcome this challenge through thermodynamic coupling, using the energy from exergonic reactions like ATP hydrolysis to drive endergonic ones. This exercise provides a practical application of these principles, tasking you with determining the minimum cellular energy charge required to make a reaction in a synthetic pathway feasible . Mastering this type of calculation is essential for designing and analyzing the bioenergetics of engineered metabolic circuits.",
            "id": "3938348",
            "problem": "A ligase in a synthetic pathway converts metabolite $A$ to $B$ by coupling the otherwise unfavorable reaction $A \\rightarrow B$ to the hydrolysis of adenosine triphosphate (ATP). The overall, enzyme-catalyzed reaction is\n$$A + \\text{ATP} + \\text{H}_{2}\\text{O} \\rightleftharpoons B + \\text{ADP} + \\text{Pi},$$\nwhere adenosine diphosphate (ADP) and inorganic phosphate (Pi) are the hydrolysis products. Assume biochemical standard conditions (transformed standard Gibbs energies at $\\text{pH}=7$), ideal dilute solution so that activities equal concentrations relative to the $1\\,\\mathrm{M}$ standard state, and that water activity is effectively constant and incorporated into the transformed standard state.\n\nYou are given the transformed standard Gibbs energy changes at $T=310\\,\\mathrm{K}$:\n- For $A \\rightarrow B$, $\\Delta G^{\\circ\\prime}_{A\\rightarrow B} = +26.0\\,\\mathrm{kJ\\,mol^{-1}}$.\n- For ATP hydrolysis, $\\Delta G^{\\circ\\prime}_{\\text{ATP hydrolysis}} = -30.5\\,\\mathrm{kJ\\,mol^{-1}}$.\n\nIn a designed steady state of a synthetic cell, the concentrations are constrained such that $[A] = 1.00\\,\\mathrm{mM}$ and $[B] = 0.200\\,\\mathrm{mM}$, where millimolar (mM) denotes $10^{-3}\\,\\mathrm{M}$. Under these conditions, determine the minimum value of the concentration ratio $[\\text{ATP}]/\\big([\\text{ADP}]\\,[\\text{Pi}]\\big)$ that renders the coupled reaction exactly at thermodynamic equilibrium (i.e., total transformed Gibbs energy change equal to zero). Express your final answer as a pure number (dimensionless) and round to four significant figures.",
            "solution": "The starting point is the definition of the chemical potential $\\mu_{i}$ of species $i$ in an ideal dilute solution,\n$$\\mu_{i} = \\mu_{i}^{\\circ} + R T \\ln a_{i},$$\nwhere $R$ is the universal gas constant, $T$ is the absolute temperature, and $a_{i}$ is the activity of species $i$. Under ideal dilute conditions with the biochemical standard state, $a_{i} = [i]/(1\\,\\mathrm{M})$.\n\nFor a reaction with stoichiometric coefficients $\\nu_{i}$ (products positive, reactants negative), the Gibbs energy change is\n$$\\Delta G = \\sum_{i} \\nu_{i} \\mu_{i} = \\Delta G^{\\circ\\prime} + R T \\ln Q,$$\nwhere $\\Delta G^{\\circ\\prime}$ is the transformed standard Gibbs energy change at biochemical standard conditions, and $Q$ is the reaction quotient formed from activities,\n$$Q = \\prod_{i} a_{i}^{\\nu_{i}}.$$\n\nThe coupled reaction is\n$$A + \\text{ATP} + \\text{H}_{2}\\text{O} \\rightleftharpoons B + \\text{ADP} + \\text{Pi}.$$\nUnder the biochemical standard state, the water activity is taken as constant and absorbed into $\\Delta G^{\\circ\\prime}$. Therefore, the transformed standard Gibbs energy for the coupled process is the sum of the individual transformed standard Gibbs energies (additivity follows from combining reactions):\n$$\\Delta G^{\\circ\\prime}_{\\text{coupled}} = \\Delta G^{\\circ\\prime}_{A\\rightarrow B} + \\Delta G^{\\circ\\prime}_{\\text{ATP hydrolysis}}.$$\nWith the given values,\n$$\\Delta G^{\\circ\\prime}_{\\text{coupled}} = (+26.0\\,\\mathrm{kJ\\,mol^{-1}}) + (-30.5\\,\\mathrm{kJ\\,mol^{-1}}) = -4.5\\,\\mathrm{kJ\\,mol^{-1}}.$$\n\nThe reaction quotient for the coupled reaction, using activities $a_{i} = [i]/(1\\,\\mathrm{M})$, is\n$$Q = \\frac{a_{B}\\,a_{\\text{ADP}}\\,a_{\\text{Pi}}}{a_{A}\\,a_{\\text{ATP}}} = \\frac{\\left(\\frac{[B]}{1\\,\\mathrm{M}}\\right)\\left(\\frac{[\\text{ADP}]}{1\\,\\mathrm{M}}\\right)\\left(\\frac{[\\text{Pi}]}{1\\,\\mathrm{M}}\\right)}{\\left(\\frac{[A]}{1\\,\\mathrm{M}}\\right)\\left(\\frac{[\\text{ATP}]}{1\\,\\mathrm{M}}\\right)} = \\frac{[B]\\,[\\text{ADP}]\\,[\\text{Pi}]}{[A]\\,[\\text{ATP}}},$$\nwhich is dimensionless because the $1\\,\\mathrm{M}$ factors cancel.\n\nAt thermodynamic equilibrium for the coupled reaction, $\\Delta G = 0$, therefore\n$$0 = \\Delta G^{\\circ\\prime}_{\\text{coupled}} + R T \\ln Q \\quad \\Rightarrow \\quad \\ln Q = -\\frac{\\Delta G^{\\circ\\prime}_{\\text{coupled}}}{R T}.$$\nExponentiating both sides yields\n$$Q = \\exp\\!\\left(-\\frac{\\Delta G^{\\circ\\prime}_{\\text{coupled}}}{R T}\\right).$$\nSubstituting the definition of $Q$ and rearranging to solve for the required ratio $[\\text{ATP}]/\\big([\\text{ADP}]\\,[\\text{Pi}]\\big)$ gives\n$$\\frac{[\\text{ATP}]}{[\\text{ADP}]\\,[\\text{Pi}]} = \\frac{[B]}{[A]}\\,\\exp\\!\\left(\\frac{\\Delta G^{\\circ\\prime}_{\\text{coupled}}}{R T}\\right).$$\n\nNow insert the numerical values. The concentration ratio is\n$$\\frac{[B]}{[A]} = \\frac{0.200\\,\\mathrm{mM}}{1.00\\,\\mathrm{mM}} = 0.200.$$\nUse $R = 8.314\\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$ and $T = 310\\,\\mathrm{K}$, so\n$$R T = (8.314\\times 10^{-3})\\times 310\\,\\mathrm{kJ\\,mol^{-1}} = 2.57734\\,\\mathrm{kJ\\,mol^{-1}}.$$\nCompute the exponential factor:\n$$\\frac{\\Delta G^{\\circ\\prime}_{\\text{coupled}}}{R T} = \\frac{-4.5\\,\\mathrm{kJ\\,mol^{-1}}}{2.57734\\,\\mathrm{kJ\\,mol^{-1}}} \\approx -1.74594,$$\n$$\\exp\\!\\left(\\frac{\\Delta G^{\\circ\\prime}_{\\text{coupled}}}{R T}\\right) \\approx \\exp(-1.74594) \\approx 0.1745.$$\nTherefore,\n$$\\left(\\frac{[\\text{ATP}]}{[\\text{ADP}]\\,[\\text{Pi}]}\\right)_{\\text{min at equilibrium}} \\approx 0.200 \\times 0.1745 \\approx 0.03490.$$\n\nThis is the minimum ratio that places the coupled reaction at thermodynamic equilibrium under the specified $[A]$ and $[B]$, meaning any larger value drives the reaction forward ($\\Delta G  0$).",
            "answer": "$$\\boxed{0.03490}$$"
        },
        {
            "introduction": "While analyzing single reactions is crucial, synthetic biology involves designing entire metabolic networks where a key question is whether a proposed flux distribution is thermodynamically feasible. This practice guides you through translating thermodynamic constraints into a system of linear inequalities and using Linear Programming (LP) to test if a cellular state exists where all reactions can run in their intended directions . This computational approach is a powerful tool for validating large-scale models and ensuring your synthetic circuit designs are physically realistic.",
            "id": "3938362",
            "problem": "A synthetic biology modeling task considers metabolic reaction networks constrained by thermodynamics. Starting from the fundamental base that the chemical potential of species $i$ in an ideal dilute solution at temperature $T$ is $\\mu_i = \\mu_i^{\\circ} + RT \\ln c_i$, and the Gibbs free energy change of reaction $j$ with stoichiometric coefficients $S_{ij}$ is $\\Delta G_j = \\sum_i S_{ij} \\mu_i$, and the equilibrium constant $K_{\\mathrm{eq},j}$ satisfies $K_{\\mathrm{eq},j} = \\exp\\left(-\\Delta G_j^{\\circ}/(RT)\\right)$, formulate a computational test for the existence of metabolite concentrations within given bounds that make a specified set of reaction flux directions thermodynamically feasible. Use the fundamental facts above as the only starting point, and do not assume any additional shortcut formulas.\n\nAssume ideal activities equal concentrations. Let $x_i = \\ln c_i$. Then concentrations are constrained by bounds $c_{i,\\min} \\le c_i \\le c_{i,\\max}$, which imply $\\ln c_{i,\\min} \\le x_i \\le \\ln c_{i,\\max}$. Let the standard Gibbs free energy of reaction $j$ be $\\Delta G_j^{\\circ} = -RT \\ln K_{\\mathrm{eq},j}$. The sign feasibility condition is that for a reaction carrying a net forward flux ($s_j = +1$) the reaction Gibbs free energy satisfies $\\Delta G_j \\le -\\varepsilon$, and for a reaction carrying a net reverse flux ($s_j = -1$) it satisfies $\\Delta G_j \\ge +\\varepsilon$, where $\\varepsilon$ is a small positive tolerance. Reactions with zero flux ($s_j = 0$) impose no thermodynamic sign constraint. All energies must be expressed in $\\mathrm{kJ/mol}$, temperature in $\\mathrm{K}$, and concentrations in $\\mathrm{M}$.\n\nYour program must construct and solve the resulting feasibility problem in $x$-space using Linear Programming (LP), by checking whether there exists a vector $x$ within the bounds such that all linearized thermodynamic inequalities implied by the flux directions and equilibrium constants are satisfied. If such a vector exists, the case is thermodynamically feasible and the output should be the boolean value $True$; otherwise, output $False$.\n\nImplement the program to evaluate the following test suite, each case defined by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$ (rows are metabolites, columns are reactions), equilibrium constants $K_{\\mathrm{eq},j}$, flux direction signs $s_j \\in \\{-1,0,+1\\}$, metabolite concentration bounds $(c_{i,\\min},c_{i,\\max})$, temperature $T$, and tolerance $\\varepsilon$. Use the universal gas constant $R = 8.31446261815324 \\times 10^{-3}\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n\nTest Case $1$ (happy path, single forward reaction):\n- $m = 2$, $n = 1$, $S = \\begin{bmatrix} -1 \\\\ +1 \\end{bmatrix}$,\n- $K_{\\mathrm{eq}} = [100.0]$,\n- $s = [+1]$,\n- $(c_{i,\\min},c_{i,\\max}) = [(10^{-6},10^{-3}),(10^{-6},10^{-3})]$,\n- $T = 298.15\\ \\mathrm{K}$,\n- $\\varepsilon = 0.001\\ \\mathrm{kJ/mol}$.\n\nTest Case $2$ (infeasible cycle due to product of equilibrium constants equal to $1$):\n- $m = 3$, $n = 3$, $S = \\begin{bmatrix} -1  0  +1 \\\\ +1  -1  0 \\\\ 0  +1  -1 \\end{bmatrix}$,\n- $K_{\\mathrm{eq}} = [10.0, 10.0, 0.01]$,\n- $s = [+1, +1, +1]$,\n- $(c_{i,\\min},c_{i,\\max}) = [(10^{-6},10^{-3}), (10^{-6},10^{-3}), (10^{-6},10^{-3})]$,\n- $T = 298.15\\ \\mathrm{K}$,\n- $\\varepsilon = 0.1\\ \\mathrm{kJ/mol}$.\n\nTest Case $3$ (mixed directions feasible):\n- $m = 3$, $n = 2$, $S = \\begin{bmatrix} -1  0 \\\\ +1  -1 \\\\ 0  +1 \\end{bmatrix}$,\n- $K_{\\mathrm{eq}} = [10.0, 10.0]$,\n- $s = [+1, -1]$,\n- $(c_{i,\\min},c_{i,\\max}) = [(10^{-6},10^{-3}), (10^{-6},10^{-3}), (10^{-6},10^{-3})]$,\n- $T = 298.15\\ \\mathrm{K}$,\n- $\\varepsilon = 0.5\\ \\mathrm{kJ/mol}$.\n\nTest Case $4$ (cycle feasible at boundary with $\\varepsilon = 0$):\n- $m = 3$, $n = 3$, $S = \\begin{bmatrix} -1  0  +1 \\\\ +1  -1  0 \\\\ 0  +1  -1 \\end{bmatrix}$,\n- $K_{\\mathrm{eq}} = [10.0, 10.0, 0.01]$,\n- $s = [+1, +1, +1]$,\n- $(c_{i,\\min},c_{i,\\max}) = [(10^{-6},10^{-3}), (10^{-6},10^{-3}), (10^{-6},10^{-3})]$,\n- $T = 298.15\\ \\mathrm{K}$,\n- $\\varepsilon = 0.0\\ \\mathrm{kJ/mol}$.\n\nTest Case $5$ (reverse impossible with very large equilibrium constant):\n- $m = 2$, $n = 1$, $S = \\begin{bmatrix} -1 \\\\ +1 \\end{bmatrix}$,\n- $K_{\\mathrm{eq}} = [10^{6}]$,\n- $s = [-1]$,\n- $(c_{i,\\min},c_{i,\\max}) = [(10^{-6},10^{-3}), (10^{-6},10^{-3})]$,\n- $T = 298.15\\ \\mathrm{K}$,\n- $\\varepsilon = 0.001\\ \\mathrm{kJ/mol}$.\n\nYour program should produce a single line of output containing the results for the five cases as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4,result_5]$), where each $result_k$ is a boolean indicating feasibility for Test Case $k$.",
            "solution": "The problem requires the formulation and solution of a thermodynamic feasibility test for a metabolic reaction network. This is accomplished by translating the given thermodynamic principles into a set of linear inequalities, which defines a Linear Programming (LP) feasibility problem.\n\nThe starting point is the definition of the chemical potential $\\mu_i$ for a species $i$ in an ideal dilute solution at temperature $T$:\n$$\n\\mu_i = \\mu_i^{\\circ} + RT \\ln c_i\n$$\nwhere $\\mu_i^{\\circ}$ is the standard chemical potential, $R$ is the universal gas constant, and $c_i$ is the concentration of species $i$.\n\nThe Gibbs free energy change, $\\Delta G_j$, for a reaction $j$ with stoichiometric coefficients $S_{ij}$ (positive for products, negative for reactants) is given by:\n$$\n\\Delta G_j = \\sum_{i} S_{ij} \\mu_i\n$$\nSubstituting the expression for $\\mu_i$ into the equation for $\\Delta G_j$:\n$$\n\\Delta G_j = \\sum_{i} S_{ij} (\\mu_i^{\\circ} + RT \\ln c_i) = \\sum_{i} S_{ij} \\mu_i^{\\circ} + RT \\sum_{i} S_{ij} \\ln c_i\n$$\nThe first term on the right-hand side is the standard Gibbs free energy change of the reaction, $\\Delta G_j^{\\circ} = \\sum_{i} S_{ij} \\mu_i^{\\circ}$. This yields the Wegscheider-Lewis relation:\n$$\n\\Delta G_j = \\Delta G_j^{\\circ} + RT \\sum_{i} S_{ij} \\ln c_i\n$$\nThe problem provides the relationship between the standard Gibbs free energy change and the equilibrium constant $K_{\\mathrm{eq},j}$:\n$$\n\\Delta G_j^{\\circ} = -RT \\ln K_{\\mathrm{eq},j}\n$$\nSubstituting this into the expression for $\\Delta G_j$:\n$$\n\\Delta G_j = -RT \\ln K_{\\mathrm{eq},j} + RT \\sum_{i} S_{ij} \\ln c_i\n$$\nTo linearize the problem, we introduce the change of variables $x_i = \\ln c_i$. The equation for $\\Delta G_j$ becomes linear in $x_i$:\n$$\n\\Delta G_j = -RT \\ln K_{\\mathrm{eq},j} + RT \\sum_{i} S_{ij} x_i\n$$\nThe problem defines thermodynamic feasibility based on the direction of reaction flux, specified by the sign vector $s_j \\in \\{-1, 0, +1\\}$, and a small positive tolerance $\\varepsilon$:\n1. For a net forward flux, $s_j = +1$, the reaction must be energetically favorable: $\\Delta G_j \\le -\\varepsilon$.\n2. For a net reverse flux, $s_j = -1$, the reaction must be energetically favorable in the reverse direction: $\\Delta G_j \\ge +\\varepsilon$.\n3. For zero flux, $s_j = 0$, no thermodynamic constraint is imposed.\n\nWe can combine the conditions for $s_j = +1$ and $s_j = -1$ into a single inequality: $s_j \\Delta G_j \\le -\\varepsilon$.\nLet's verify this:\n- If $s_j = +1$: $(+1)\\Delta G_j \\le -\\varepsilon \\implies \\Delta G_j \\le -\\varepsilon$.\n- If $s_j = -1$: $(-1)\\Delta G_j \\le -\\varepsilon \\implies \\Delta G_j \\ge +\\varepsilon$.\nThis unified inequality holds for all reactions with non-zero flux ($s_j \\neq 0$).\n\nSubstituting the linear expression for $\\Delta G_j$ into this unified constraint:\n$$\ns_j \\left( -RT \\ln K_{\\mathrm{eq},j} + RT \\sum_{i} S_{ij} x_i \\right) \\le -\\varepsilon\n$$\nSince $R > 0$ and $T > 0$, we can divide by $RT$ without changing the inequality direction:\n$$\ns_j \\left( -\\ln K_{\\mathrm{eq},j} + \\sum_{i} S_{ij} x_i \\right) \\le -\\frac{\\varepsilon}{RT}\n$$\nRearranging the terms, we obtain a linear inequality for each constrained reaction $j$ in terms of the variables $x_i$:\n$$\ns_j \\sum_{i=1}^{m} S_{ij} x_i \\le s_j \\ln K_{\\mathrm{eq},j} - \\frac{\\varepsilon}{RT}\n$$\nThis inequality must hold for every reaction $j \\in \\{1, ..., n\\}$ where $s_j \\neq 0$.\n\nFurthermore, the concentrations $c_i$ are bounded, $c_{i,\\min} \\le c_i \\le c_{i,\\max}$. This translates to bounds on our variables $x_i = \\ln c_i$:\n$$\n\\ln c_{i,\\min} \\le x_i \\le \\ln c_{i,\\max}\n$$\nThe problem is now fully specified as an LP feasibility problem: we must determine if there exists a vector $x = [x_1, ..., x_m]^T$ that simultaneously satisfies the set of linear inequalities derived from the flux directions and the box constraints derived from the concentration bounds.\n\nThis problem can be formulated in the standard LP form $A_{\\mathrm{ub}} x \\le b_{\\mathrm{ub}}$ with bounds $x_{\\min} \\le x \\le x_{\\max}$.\n- The vector of variables is $x$, of dimension $m$ (the number of metabolites).\n- The matrix $A_{\\mathrm{ub}}$ has one row for each reaction $j$ with $s_j \\neq 0$. The row corresponding to reaction $j$ is the vector $[s_j S_{1j}, s_j S_{2j}, ..., s_j S_{mj}]$. This is the $j$-th column of the stoichiometric matrix $S$, scaled by $s_j$.\n- The vector $b_{\\mathrm{ub}}$ contains the corresponding upper bounds. The element for reaction $j$ is $s_j \\ln K_{\\mathrm{eq},j} - \\varepsilon/(RT)$.\n- The bounds on the variables are given by $x_{i, \\min} = \\ln c_{i, \\min}$ and $x_{i, \\max} = \\ln c_{i, \\max}$.\n\nTo solve this, we can use a standard LP solver. Since we are only interested in feasibility, the objective function is irrelevant and can be set to zero (i.e., find $x$ to minimize $0^T x$). If the solver finds a point $x$ satisfying all constraints, the system is thermodynamically feasible. Otherwise, it is infeasible. The Python script will implement this logic using `scipy.optimize.linprog`.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a series of thermodynamic feasibility problems for metabolic networks.\n    \"\"\"\n    # Universal gas constant in kJ/(mol*K)\n    R_GAS_CONSTANT = 8.31446261815324e-3\n\n    test_cases = [\n        {\n            # Test Case 1: happy path, single forward reaction\n            \"S\": np.array([[-1], [1]]),\n            \"K_eq\": np.array([100.0]),\n            \"s\": np.array([1]),\n            \"c_bounds\": np.array([[1e-6, 1e-3], [1e-6, 1e-3]]),\n            \"T\": 298.15,\n            \"eps\": 0.001,\n        },\n        {\n            # Test Case 2: infeasible cycle\n            \"S\": np.array([[-1, 0, 1], [1, -1, 0], [0, 1, -1]]),\n            \"K_eq\": np.array([10.0, 10.0, 0.01]),\n            \"s\": np.array([1, 1, 1]),\n            \"c_bounds\": np.array([[1e-6, 1e-3], [1e-6, 1e-3], [1e-6, 1e-3]]),\n            \"T\": 298.15,\n            \"eps\": 0.1,\n        },\n        {\n            # Test Case 3: mixed directions feasible\n            \"S\": np.array([[-1, 0], [1, -1], [0, 1]]),\n            \"K_eq\": np.array([10.0, 10.0]),\n            \"s\": np.array([1, -1]),\n            \"c_bounds\": np.array([[1e-6, 1e-3], [1e-6, 1e-3], [1e-6, 1e-3]]),\n            \"T\": 298.15,\n            \"eps\": 0.5,\n        },\n        {\n            # Test Case 4: cycle feasible at boundary with eps = 0\n            \"S\": np.array([[-1, 0, 1], [1, -1, 0], [0, 1, -1]]),\n            \"K_eq\": np.array([10.0, 10.0, 0.01]),\n            \"s\": np.array([1, 1, 1]),\n            \"c_bounds\": np.array([[1e-6, 1e-3], [1e-6, 1e-3], [1e-6, 1e-3]]),\n            \"T\": 298.15,\n            \"eps\": 0.0,\n        },\n        {\n            # Test Case 5: reverse impossible with very large K_eq\n            \"S\": np.array([[-1], [1]]),\n            \"K_eq\": np.array([1e6]),\n            \"s\": np.array([-1]),\n            \"c_bounds\": np.array([[1e-6, 1e-3], [1e-6, 1e-3]]),\n            \"T\": 298.15,\n            \"eps\": 0.001,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        S = case[\"S\"]\n        K_eq = case[\"K_eq\"]\n        s = case[\"s\"]\n        c_bounds = case[\"c_bounds\"]\n        T = case[\"T\"]\n        eps = case[\"eps\"]\n\n        num_metabolites, num_reactions = S.shape\n\n        # The variables of the LP are x_i = ln(c_i)\n        # Calculate the bounds on x_i\n        with np.errstate(divide='ignore'): # suppress -inf from log(0) if it occurs\n            x_bounds = np.log(c_bounds)\n\n        # Calculate the RT factor\n        RT = R_GAS_CONSTANT * T\n\n        # Identify active reactions (s_j != 0) and construct LP constraints\n        A_ub_list = []\n        b_ub_list = []\n        \n        active_reaction_indices = np.where(s != 0)[0]\n\n        if active_reaction_indices.size  0:\n            # Filter matrices/vectors for active reactions\n            S_active = S[:, active_reaction_indices]\n            s_active = s[active_reaction_indices]\n            K_eq_active = K_eq[active_reaction_indices]\n            \n            # Formulate the inequalities: s_j * S_j^T * x = s_j * ln(K_eq_j) - eps/RT\n            # Reshape s_active to allow element-wise broadcasting\n            A_ub = (S_active * s_active).T\n            \n            # Calculate right-hand side (b_ub)\n            log_K_eq_active = np.log(K_eq_active)\n            b_ub = s_active * log_K_eq_active - eps / RT\n\n        else: # No constraints if no active reactions\n            A_ub = None\n            b_ub = None\n\n        # For a feasibility problem, the objective function is zero.\n        c_obj = np.zeros(num_metabolites)\n\n        # Solve the LP feasibility problem\n        # The 'highs' method is robust for this type of problem.\n        # We only care if a feasible solution exists (res.success is True).\n        res = linprog(c=c_obj, A_ub=A_ub, b_ub=b_ub, bounds=list(map(tuple, x_bounds)), method='highs')\n        \n        results.append(res.success)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}