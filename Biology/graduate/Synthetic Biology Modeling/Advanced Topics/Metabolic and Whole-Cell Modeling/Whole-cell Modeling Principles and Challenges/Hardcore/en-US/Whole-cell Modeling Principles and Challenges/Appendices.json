{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in modeling cellular processes is determining the relevant physical regimes. For a reaction occurring within the cytoplasm, we must ask: is the process limited by the speed of the biochemical reaction itself, or by the time it takes for substrate molecules to diffuse to the enzyme? This exercise  introduces the Damköhler number, a powerful dimensionless group derived from the reaction-diffusion equation, which provides the answer to this fundamental question.",
            "id": "3940236",
            "problem": "A synthetic biology team is building a whole-cell model that must couple cytoplasmic transport with enzymatic consumption of a small substrate. Consider a homogeneous cytoplasmic domain of characteristic length scale $L$ in which a substrate of concentration $c(\\mathbf{x},t)$ diffuses with diffusion coefficient $D$ and is consumed by a spatially uniform population of enzyme such that the net consumption is pseudo-first-order with respect to $c$, with rate constant $k$. Starting from the standard reaction–diffusion mass balance and Fick’s law, formulate the governing partial differential equation (PDE) for $c(\\mathbf{x},t)$ and use nondimensionalization based on $L$ to identify the dimensionless parameter that quantifies the ratio of the characteristic reaction rate to the characteristic diffusion rate across length $L$. Then, using the following realistic parameter values for a cytosolic metabolite and enzyme ensemble, compute the value of this dimensionless parameter:\n- $k = 3.5 \\ \\text{s}^{-1}$\n- $L = 1.2 \\ \\mu\\text{m}$\n- $D = 4.8 \\ \\mu\\text{m}^{2} \\ \\text{s}^{-1}$\n\nReport only the computed value of the dimensionless parameter. Round your answer to three significant figures. The final number is dimensionless; do not include units.",
            "solution": "The problem requires the formulation of a governing partial differential equation (PDE) for a reaction-diffusion system, the identification of a key dimensionless parameter through nondimensionalization, and the calculation of this parameter's value.\n\nFirst, we formulate the governing PDE. The general mass balance for a species with concentration $c(\\mathbf{x}, t)$ in a control volume is given by:\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\mathbf{J} = R\n$$\nwhere $\\frac{\\partial c}{\\partial t}$ is the rate of accumulation of the species, $\\mathbf{J}$ is the molar flux, and $R$ is the net rate of production per unit volume from chemical reactions.\n\nThe flux $\\mathbf{J}$ is described by Fick's first law of diffusion, which states that the flux is proportional to the negative of the concentration gradient:\n$$\n\\mathbf{J} = -D \\nabla c\n$$\nwhere $D$ is the diffusion coefficient, assumed to be constant throughout the homogeneous domain.\n\nThe reaction term $R$ represents the net rate of production. The problem states that the substrate is consumed by a pseudo-first-order reaction with rate constant $k$. Therefore, the rate of consumption is $k c$, and the net rate of production is $R = -k c$.\n\nSubstituting the expressions for $\\mathbf{J}$ and $R$ into the mass balance equation gives:\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot (-D \\nabla c) = -k c\n$$\nAssuming $D$ is spatially constant, the divergence operator can be moved past it, yielding the Laplacian operator $\\nabla^2 = \\nabla \\cdot \\nabla$:\n$$\n\\frac{\\partial c}{\\partial t} - D \\nabla^2 c = -k c\n$$\nRearranging this gives the final form of the reaction-diffusion equation:\n$$\n\\frac{\\partial c}{\\partial t} = D \\nabla^2 c - k c\n$$\n\nNext, we nondimensionalize this equation. We introduce dimensionless variables for position, time, and concentration. The problem specifies using the characteristic length scale $L$ for position.\nLet $\\tilde{\\mathbf{x}} = \\frac{\\mathbf{x}}{L}$.\nLet $\\tilde{c} = \\frac{c}{c_{ref}}$, where $c_{ref}$ is a suitable reference concentration (e.g., an initial or boundary concentration), which will cancel out.\nLet $\\tilde{t} = \\frac{t}{\\tau}$, where $\\tau$ is a characteristic time scale that we will determine.\n\nWe express the derivatives in the PDE in terms of these new dimensionless variables using the chain rule:\n$$\n\\frac{\\partial}{\\partial t} = \\frac{\\partial \\tilde{t}}{\\partial t} \\frac{\\partial}{\\partial \\tilde{t}} = \\frac{1}{\\tau} \\frac{\\partial}{\\partial \\tilde{t}}\n$$\n$$\n\\nabla = \\frac{\\partial \\tilde{\\mathbf{x}}}{\\partial \\mathbf{x}} \\tilde{\\nabla} = \\frac{1}{L} \\tilde{\\nabla} \\implies \\nabla^2 = \\frac{1}{L^2} \\tilde{\\nabla}^2\n$$\nSubstituting these into the governing PDE:\n$$\n\\frac{1}{\\tau} \\frac{\\partial (c_{ref} \\tilde{c})}{\\partial \\tilde{t}} = D \\frac{1}{L^2} \\tilde{\\nabla}^2 (c_{ref} \\tilde{c}) - k (c_{ref} \\tilde{c})\n$$\nSince $c_{ref}$ is a constant, it can be factored out from all terms and canceled:\n$$\n\\frac{1}{\\tau} \\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}} = \\frac{D}{L^2} \\tilde{\\nabla}^2 \\tilde{c} - k \\tilde{c}\n$$\nTo make the equation dimensionless, we group the parameters. A standard approach is to choose $\\tau$ such that the coefficient of either the diffusion term or the time-derivative term becomes unity. Let's choose the characteristic time scale to be the diffusion time, $\\tau_{diff} = \\frac{L^2}{D}$.\nSetting $\\tau = \\frac{L^2}{D}$:\n$$\n\\frac{1}{L^2/D} \\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}} = \\frac{D}{L^2} \\tilde{\\nabla}^2 \\tilde{c} - k \\tilde{c}\n$$\n$$\n\\frac{D}{L^2} \\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}} = \\frac{D}{L^2} \\tilde{\\nabla}^2 \\tilde{c} - k \\tilde{c}\n$$\nMultiplying the entire equation by $\\frac{L^2}{D}$ yields the dimensionless form:\n$$\n\\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}} = \\tilde{\\nabla}^2 \\tilde{c} - \\frac{k L^2}{D} \\tilde{c}\n$$\nThe dimensionless parameter is the coefficient of the reaction term, $\\frac{k L^2}{D}$. This parameter quantifies the ratio of reaction effects to diffusion effects.\n\nThe characteristic rate of reaction can be considered as the rate constant $k$ (units of $\\text{time}^{-1}$). The characteristic rate of diffusion across a length $L$ is the reciprocal of the diffusion time, i.e., $1/\\tau_{diff} = D/L^2$ (units of $\\text{time}^{-1}$).\nThe ratio of the characteristic reaction rate to the characteristic diffusion rate is therefore:\n$$\n\\frac{\\text{Reaction Rate}}{\\text{Diffusion Rate}} = \\frac{k}{D/L^2} = \\frac{k L^2}{D}\n$$\nThis dimensionless group is often referred to as the Damköhler number ($Da$) or the square of the Thiele modulus ($\\phi^2$).\n\nFinally, we compute the value of this parameter using the given values:\n- $k = 3.5 \\ \\text{s}^{-1}$\n- $L = 1.2 \\ \\mu\\text{m}$\n- $D = 4.8 \\ \\mu\\text{m}^{2} \\ \\text{s}^{-1}$\n\nThe dimensionless parameter is:\n$$\n\\frac{k L^2}{D} = \\frac{(3.5 \\ \\text{s}^{-1}) (1.2 \\ \\mu\\text{m})^2}{4.8 \\ \\mu\\text{m}^{2} \\ \\text{s}^{-1}}\n$$\nThe units cancel out as expected:\n$$\n\\frac{\\text{s}^{-1} \\cdot \\mu\\text{m}^2}{\\mu\\text{m}^2 \\cdot \\text{s}^{-1}} = 1\n$$\nNow, we compute the numerical value:\n$$\n\\frac{k L^2}{D} = \\frac{3.5 \\times (1.2)^2}{4.8} = \\frac{3.5 \\times 1.44}{4.8} = \\frac{5.04}{4.8} = 1.05\n$$\nThe problem asks for the answer to be rounded to three significant figures. The calculated value $1.05$ already has three significant figures.",
            "answer": "$$\\boxed{1.05}$$"
        },
        {
            "introduction": "Once a model structure, such as a set of Ordinary Differential Equations (ODEs), is established, we need to understand how its behavior depends on its parameters. Forward sensitivity analysis is a rigorous method for calculating the partial derivative of a model's output with respect to each parameter over time. This practice  demonstrates how to derive and solve the sensitivity equations for a core gene expression module, providing a quantitative measure of which parameters have the most impact on protein production.",
            "id": "3940291",
            "problem": "Consider a simplified, nondimensional module of a whole-cell model that captures transcription and translation dynamics consistent with the Central Dogma of molecular biology and mass-action kinetics. Let the state vector be $\\mathbf{x}(t) = (m(t), p(t))^{\\top}$, where $m(t)$ is the scaled concentration of messenger ribonucleic acid (mRNA) and $p(t)$ is the scaled concentration of protein. The module dynamics are represented by the system of ordinary differential equations (ODEs), derived from mass-action balances:\n$$\n\\frac{dm}{dt} = \\theta_{1} - \\theta_{2} m, \\qquad \\frac{dp}{dt} = \\theta_{3} m - \\theta_{4} p,\n$$\nwith initial conditions $m(0) = 0$ and $p(0) = 0$. The output is the scalar protein level $y(t) = p(t)$. The parameter vector is $\\boldsymbol{\\theta} = (\\theta_{1}, \\theta_{2}, \\theta_{3}, \\theta_{4})$, where all quantities are nondimensional as a result of standard nondimensionalization (states scaled by reference concentrations and time scaled by a reference timescale).\n\nStarting from first principles—namely, mass-action ODEs for reaction networks and the chain rule for differentiating composite functions—define the local sensitivities $s_{i}(t) = \\partial y(t)/\\partial \\theta_{i}$ for $i \\in \\{1,2,3,4\\}$, derive the forward sensitivity equations for $s_{i}(t)$, and compute their values at $t = T$, where $T = 3.0$. Use the parameter values\n$$\n\\theta_{1} = 2.0,\\quad \\theta_{2} = 0.5,\\quad \\theta_{3} = 1.2,\\quad \\theta_{4} = 0.8.\n$$\nAssume the initial conditions are independent of $\\boldsymbol{\\theta}$. Round each sensitivity $s_{i}(T)$ to four significant figures. Provide your final answer as a row matrix containing $(s_{1}(T), s_{2}(T), s_{3}(T), s_{4}(T))$.",
            "solution": "The solution requires computing the local sensitivities $s_i(t) = \\partial p(t) / \\partial \\theta_i$ for each parameter $\\theta_i$. This is accomplished using forward sensitivity analysis, which involves deriving and solving a set of ordinary differential equations (ODEs) for the sensitivities themselves. The general forward sensitivity equation for the sensitivity vector $\\mathbf{s}_i = \\partial\\mathbf{x}/\\partial\\theta_i$ is:\n$$\n\\dot{\\mathbf{s}}_i(t) = \\mathbf{J}(t) \\mathbf{s}_i(t) + \\frac{\\partial \\mathbf{f}}{\\partial \\theta_i}\n$$\nwhere $\\mathbf{J}(t)$ is the system's Jacobian matrix. The initial conditions for all sensitivities are zero, as the state initial conditions are independent of the parameters.\n\n**1. Solve the State Equations**\n\nFirst, we solve for the states $m(t)$ and $p(t)$ using the provided parameter values: $\\theta_1=2.0$, $\\theta_2=0.5$, $\\theta_3=1.2$, $\\theta_4=0.8$.\nThe equation for mRNA, $\\frac{dm}{dt} = 2.0 - 0.5 m$, with $m(0)=0$ yields the solution:\n$$m(t) = 4(1 - e^{-0.5t})$$\nThe equation for protein, $\\frac{dp}{dt} = 1.2 m(t) - 0.8 p$, with $p(0)=0$ is solved by substituting the expression for $m(t)$. This yields the solution:\n$$p(t) = 6 + 10e^{-0.8 t} - 16e^{-0.5 t}$$\n\n**2. Solve the Sensitivity Equations**\n\nThe Jacobian matrix is constant for this linear system: $\\mathbf{J} = \\begin{pmatrix} -0.5 & 0 \\\\ 1.2 & -0.8 \\end{pmatrix}$. We then solve the sensitivity ODEs for each parameter. The output sensitivity of interest is $s_i(t) = s_{p,i}(t) = \\partial p(t) / \\partial \\theta_i$.\n\n**Sensitivity to $\\theta_1$:**\nThe forcing term is $\\partial \\mathbf{f}/\\partial \\theta_1 = (1, 0)^{\\top}$. The sensitivity ODEs are:\n$\\frac{ds_{m,1}}{dt} = -0.5 s_{m,1} + 1$\n$\\frac{ds_{p,1}}{dt} = 1.2 s_{m,1} - 0.8 s_{p,1}$\nSolving this system yields $s_{p,1}(t) = 3 - 8e^{-0.5t} + 5e^{-0.8t}$.\nAt $t=3.0$, $s_1(3.0) = 3 - 8e^{-1.5} + 5e^{-2.4} \\approx 1.66855$.\n\n**Sensitivity to $\\theta_2$:**\nThe forcing term is $\\partial \\mathbf{f}/\\partial \\theta_2 = (-m(t), 0)^{\\top} = (-4(1-e^{-0.5t}), 0)^{\\top}$. Solving the corresponding sensitivity system gives:\n$s_{p,2}(t) = -12 + \\frac{100}{3}e^{-0.8t} - \\frac{64}{3}e^{-0.5t} + 16te^{-0.5t}$.\nAt $t=3.0$, $s_2(3.0) = -12 + \\frac{100}{3}e^{-2.4} + \\frac{80}{3}e^{-1.5} \\approx -3.02593$.\n\n**Sensitivity to $\\theta_3$:**\nThe forcing term is $\\partial \\mathbf{f}/\\partial \\theta_3 = (0, m(t))^{\\top} = (0, 4(1-e^{-0.5t}))^{\\top}$. Solving the corresponding sensitivity system gives:\n$s_{p,3}(t) = 5 - \\frac{40}{3}e^{-0.5t} + \\frac{25}{3}e^{-0.8t}$.\nAt $t=3.0$, $s_3(3.0) = 5 - \\frac{40}{3}e^{-1.5} + \\frac{25}{3}e^{-2.4} \\approx 2.78091$.\n\n**Sensitivity to $\\theta_4$:**\nThe forcing term is $\\partial \\mathbf{f}/\\partial \\theta_4 = (0, -p(t))^{\\top}$. Solving the corresponding sensitivity system gives:\n$s_{p,4}(t) = -7.5 + \\frac{160}{3}e^{-0.5t} - \\frac{275}{6}e^{-0.8t} - 10te^{-0.8t}$.\nAt $t=3.0$, $s_4(3.0) = -7.5 + \\frac{160}{3}e^{-1.5} - \\frac{455}{6}e^{-2.4} \\approx -2.47926$.\n\n**3. Final Result**\n\nRounding the results to four significant figures, we obtain the sensitivity vector at $T=3.0$:\n$s_1(3.0) \\approx 1.669$\n$s_2(3.0) \\approx -3.026$\n$s_3(3.0) \\approx 2.781$\n$s_4(3.0) \\approx -2.479$\nThis gives the final answer in matrix form.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.669 & -3.026 & 2.781 & -2.479 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A central challenge in systems biology is that complex models often have parameters that are \"sloppy\" or non-identifiable, meaning they cannot be uniquely determined from available experimental data. This exercise  guides you through implementing a profile likelihood analysis, a powerful statistical technique to diagnose such issues. By exploring a simple model of gene expression, you will discover how model structure and data availability can create situations where different parameter combinations produce nearly identical outputs, posing a major hurdle for model calibration.",
            "id": "3940276",
            "problem": "Consider a simplified whole-cell protein expression module derived from the Central Dogma of Molecular Biology and mass-action kinetics. Messenger ribonucleic acid (mRNA) is transcribed and degraded, and protein is translated from mRNA and degraded. Assume a quasi-steady-state approximation for mRNA relative to protein dynamics: mRNA reaches steady state much faster than protein. Let transcription rate be $k_{\\mathrm{tx}}$ (in $\\mathrm{min}^{-1}$), translation rate be $k_{\\mathrm{tl}}$ (in $\\mathrm{min}^{-1}$), protein degradation rate be $k_{\\mathrm{deg,p}}$ (in $\\mathrm{min}^{-1}$), and mRNA degradation rate be a known constant $k_{\\mathrm{deg,m}}$ (in $\\mathrm{min}^{-1}$). Under quasi-steady-state, the mRNA concentration is $R(t) = k_{\\mathrm{tx}}/k_{\\mathrm{deg,m}}$ and the protein concentration satisfies the linear ordinary differential equation (ODE) $dP(t)/dt = \\alpha - k_{\\mathrm{deg,p}} P(t)$ with $\\alpha = k_{\\mathrm{tl}} k_{\\mathrm{tx}} / k_{\\mathrm{deg,m}}$ and initial protein $P(0) = 0$. The protein solution is\n$$\nP(t) = \\left(\\frac{\\alpha}{k_{\\mathrm{deg,p}}}\\right)\\left(1 - e^{-k_{\\mathrm{deg,p}} t}\\right).\n$$\n\nAssume measurements are corrupted by independent, identically distributed Gaussian noise with known standard deviations $\\sigma_R$ and $\\sigma_P$ for mRNA and protein, respectively. Under the Gaussian noise model, Maximum Likelihood (ML) estimation reduces to minimizing the negative log-likelihood, which for a parameter vector $\\theta = (k_{\\mathrm{tx}}, k_{\\mathrm{tl}}, k_{\\mathrm{deg,p}})$ and a dataset with measurement times $t_1,\\dots,t_n$ is\n$$\n\\ell(\\theta) = \\frac{1}{2}\\sum_{i=1}^{n} \\left(\\frac{R_{\\mathrm{model}}(t_i;\\theta) - R_{\\mathrm{obs}}(t_i)}{\\sigma_R}\\right)^2 + \\frac{1}{2}\\sum_{i=1}^{n} \\left(\\frac{P_{\\mathrm{model}}(t_i;\\theta) - P_{\\mathrm{obs}}(t_i)}{\\sigma_P}\\right)^2,\n$$\nwhere $R_{\\mathrm{model}}(t_i;\\theta) = k_{\\mathrm{tx}}/k_{\\mathrm{deg,m}}$ and $P_{\\mathrm{model}}(t_i;\\theta) = \\left(\\frac{k_{\\mathrm{tl}} k_{\\mathrm{tx}}}{k_{\\mathrm{deg,m}} k_{\\mathrm{deg,p}}}\\right)\\left(1 - e^{-k_{\\mathrm{deg,p}} t_i}\\right)$.\n\nDefine the profile likelihood for the selected parameter $k_{\\mathrm{tx}}$ by optimizing over the nuisance parameters $(k_{\\mathrm{tl}}, k_{\\mathrm{deg,p}})$:\n$$\n\\ell_{\\mathrm{prof}}(k_{\\mathrm{tx}}) = \\min_{k_{\\mathrm{tl}} > 0,\\, k_{\\mathrm{deg,p}} > 0} \\ell\\big(k_{\\mathrm{tx}}, k_{\\mathrm{tl}}, k_{\\mathrm{deg,p}}\\big).\n$$\nLet $\\ell_{\\min} = \\min_{k_{\\mathrm{tx}}>0,\\,k_{\\mathrm{tl}}>0,\\,k_{\\mathrm{deg,p}}>0} \\ell(k_{\\mathrm{tx}}, k_{\\mathrm{tl}}, k_{\\mathrm{deg,p}})$. A practical numerical diagnostic of non-identifiability is the presence of a flat region in the profile likelihood, operationalized as\n$$\n\\Delta_{\\max} = \\max_{k_{\\mathrm{tx}} \\in \\mathcal{G}} \\left[\\ell_{\\mathrm{prof}}(k_{\\mathrm{tx}}) - \\ell_{\\min}\\right],\n$$\nover a grid $\\mathcal{G}$ of $k_{\\mathrm{tx}}$ values. If $\\Delta_{\\max}$ is below a small tolerance $\\tau$, we classify the profile as numerically flat for the explored range, indicating non-identifiability of $k_{\\mathrm{tx}}$ due to model redundancies or non-identifiable directions in parameter space.\n\nYour task is to implement a program that:\n- Generates synthetic observations from the model at specified times using given \"true\" parameters, without adding random noise.\n- Computes $\\ell_{\\min}$ and the profile likelihood $\\ell_{\\mathrm{prof}}(k_{\\mathrm{tx}})$ across a given grid $\\mathcal{G}$ by constrained optimization over $(k_{\\mathrm{tl}}, k_{\\mathrm{deg,p}})$ with positivity bounds. Use the method that ensures positivity of parameters.\n- Returns, for each test case, a boolean indicating whether the profile is flat under tolerance $\\tau$, that is, whether $\\Delta_{\\max} \\le \\tau$.\n\nFundamental base to use:\n- Central Dogma of Molecular Biology (transcription and translation) and mass-action kinetics for degradation.\n- The linear ODE solution and its analytic form for protein under constant input.\n- Gaussian noise with known variance and Maximum Likelihood equivalence to least-squares.\n- Profile likelihood definition by optimization over nuisance parameters.\n\nTest suite:\n- Case $1$ (happy path, identifiable with mRNA): $k_{\\mathrm{deg,m}} = 0.5\\,\\mathrm{min}^{-1}$, true parameters $(k_{\\mathrm{tx}},k_{\\mathrm{tl}},k_{\\mathrm{deg,p}}) = (10, 5, 0.1)$ in $\\mathrm{min}^{-1}$, times $\\{0,2,5,10\\}\\,\\mathrm{min}$ for both mRNA and protein, use both mRNA and protein in the likelihood, $\\sigma_R = 1$, $\\sigma_P = 1$, bounds for all unknowns are $(10^{-9},10^{3})$, grid $\\mathcal{G} = \\{0.2,0.5,1,2,5,10,20,50\\}$ in $\\mathrm{min}^{-1}$, tolerance $\\tau = 10^{-6}$.\n- Case $2$ (redundancy, non-identifiable without mRNA): same $k_{\\mathrm{deg,m}}$, same true parameters and times, use only protein in the likelihood (ignore mRNA term), $\\sigma_P = 1$, bounds $(10^{-9},10^{3})$ for all unknowns, same grid $\\mathcal{G}$, tolerance $\\tau = 10^{-6}$.\n- Case $3$ (boundary-induced curvature): same as Case $2$, but constrain $k_{\\mathrm{tl}}$ with upper bound $50$ and keep $(10^{-9},10^{3})$ bounds for $k_{\\mathrm{deg,p}}$, same grid $\\mathcal{G}$, tolerance $\\tau = 10^{-6}$.\n\nUnits:\n- All rates are in $\\mathrm{min}^{-1}$.\n- Time is in $\\mathrm{min}$.\n- No angles or percentages are involved.\n\nFinal output format:\n- Your program should produce a single line of output containing the boolean results for the three cases as a comma-separated list enclosed in square brackets, in the order of Case $1$, Case $2$, Case $3$ (for example, $[{\\tt True},{\\tt False},{\\tt True}]$).",
            "solution": "This problem explores parameter identifiability using the profile likelihood method for a simplified model of protein expression. The analysis investigates why and when the transcription rate, $k_{\\mathrm{tx}}$, might be difficult to determine from experimental data.\n\nThe core of the analysis rests on the model structure and the data provided. The procedure involves generating noise-free synthetic data and then calculating the profile likelihood for $k_{\\mathrm{tx}}$ by numerically optimizing the negative log-likelihood function. A profile is deemed \"flat\" (indicating non-identifiability) if the change in the minimized likelihood value is negligible across a wide range of the parameter.\n\n**Case 1 Analysis (Identifiable with mRNA data)**\nWhen mRNA data is used, the likelihood function contains a term that depends directly and solely on $k_{\\mathrm{tx}}$. This anchors the parameter's value, creating a distinct minimum in the likelihood landscape. The profile likelihood will show significant curvature, making the parameter identifiable. The expected result is `False`.\n\n**Case 2 Analysis (Non-identifiable without mRNA data)**\nWhen only protein data is used, the model depends on $k_{\\mathrm{tx}}$ and $k_{\\mathrm{tl}}$ only through their product, $k_{\\mathrm{prod}} = k_{\\mathrm{tx}}k_{\\mathrm{tl}}$. This creates a structural non-identifiability. For any given $k_{\\mathrm{tx}}$, an optimizer can find a corresponding $k_{\\mathrm{tl}}$ to perfectly match the data, as long as the parameter bounds are not restrictive. This results in a flat profile likelihood, as the minimized cost remains near zero across the grid of $k_{\\mathrm{tx}}$ values. The expected result is `True`.\n\n**Case 3 Analysis (Boundary-induced Identifiability)**\nThis case is similar to Case 2, but a restrictive upper bound is placed on the nuisance parameter $k_{\\mathrm{tl}}$. For some values of $k_{\\mathrm{tx}}$ on the grid, the value of $k_{\\mathrm{tl}}$ required to match the data may exceed this bound. The optimizer is then forced to choose the boundary value, which is suboptimal and results in a higher (non-zero) cost. This introduces curvature into the profile where the bounds are active, making the profile non-flat. The expected result is `False`.\n\nThe provided Python code implements this logic using `scipy.optimize.minimize` to perform the necessary constrained optimizations for each case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Main function to run the profile likelihood analysis for three test cases.\n    \"\"\"\n    # Common parameters for all cases\n    true_params = (10.0, 5.0, 0.1)  # (k_tx, k_tl, k_deg_p)\n    k_deg_m = 0.5\n    t_obs = np.array([0.0, 2.0, 5.0, 10.0])\n    k_tx_grid = np.array([0.2, 0.5, 1.0, 2.0, 5.0, 10.0, 20.0, 50.0])\n    tolerance = 1e-6\n\n    # Test case definitions\n    test_cases = [\n        {\n            \"name\": \"Case 1: Identifiable with mRNA\",\n            \"use_mrna\": True,\n            \"sigma_r\": 1.0,\n            \"sigma_p\": 1.0,\n            \"bounds_3d\": [(1e-9, 1e3), (1e-9, 1e3), (1e-9, 1e3)],\n            \"bounds_2d\": [(1e-9, 1e3), (1e-9, 1e3)],\n        },\n        {\n            \"name\": \"Case 2: Non-identifiable without mRNA\",\n            \"use_mrna\": False,\n            \"sigma_r\": 1.0,\n            \"sigma_p\": 1.0,\n            \"bounds_3d\": [(1e-9, 1e3), (1e-9, 1e3), (1e-9, 1e3)],\n            \"bounds_2d\": [(1e-9, 1e3), (1e-9, 1e3)],\n        },\n        {\n            \"name\": \"Case 3: Boundary-induced curvature\",\n            \"use_mrna\": False,\n            \"sigma_r\": 1.0,\n            \"sigma_p\": 1.0,\n            \"bounds_3d\": [(1e-9, 1e3), (1e-9, 50.0), (1e-9, 1e3)],\n            \"bounds_2d\": [(1e-9, 50.0), (1e-9, 1e3)],\n        },\n    ]\n\n    # Generate synthetic data (same for all cases, as true_params are the same)\n    k_tx_true, k_tl_true, k_deg_p_true = true_params\n    r_obs = (k_tx_true / k_deg_m) * np.ones_like(t_obs)\n    alpha_true = k_tl_true * k_tx_true / k_deg_m\n    p_obs = (alpha_true / k_deg_p_true) * (1 - np.exp(-k_deg_p_true * t_obs))\n    \n    # Store results here\n    results = []\n\n    for case in test_cases:\n        use_mrna = case[\"use_mrna\"]\n        sigma_r = case[\"sigma_r\"]\n        sigma_p = case[\"sigma_p\"]\n        bounds_3d = case[\"bounds_3d\"]\n        bounds_2d = case[\"bounds_2d\"]\n\n        def objective_function(params, k_tx_val=None):\n            \"\"\"\n            Calculates the negative log-likelihood.\n            If k_tx_val is provided, params are (k_tl, k_deg_p).\n            Otherwise, params are (k_tx, k_tl, k_deg_p).\n            \"\"\"\n            if k_tx_val is not None:\n                k_tx = k_tx_val\n                k_tl, k_deg_p = params\n            else:\n                k_tx, k_tl, k_deg_p = params\n\n            # Model calculations\n            r_model = k_tx / k_deg_m\n            alpha = k_tl * k_tx / k_deg_m\n            \n            # Use a large penalty for non-physical parameters instead of np.inf\n            # to keep the optimizer stable. The bounds should prevent this.\n            if k_deg_p <= 0: return 1e12\n\n            p_model = (alpha / k_deg_p) * (1 - np.exp(-k_deg_p * t_obs))\n            \n            # Likelihood terms\n            r_cost = 0.5 * np.sum(((r_model - r_obs) / sigma_r)**2) if use_mrna else 0.0\n            p_cost = 0.5 * np.sum(((p_model - p_obs) / sigma_p)**2)\n            \n            return r_cost + p_cost\n\n        # 1. Compute l_min (global minimum)\n        obj_3d = lambda p: objective_function(p)\n        res_min = minimize(obj_3d, x0=true_params, bounds=bounds_3d, method='L-BFGS-B')\n        l_min = res_min.fun\n\n        # 2. Compute profile likelihood over the grid\n        profile_values = []\n        initial_guess_2d = [true_params[1], true_params[2]]\n        \n        for k_tx_fixed in k_tx_grid:\n            obj_2d = lambda p: objective_function(p, k_tx_val=k_tx_fixed)\n            res_prof = minimize(obj_2d, x0=initial_guess_2d, bounds=bounds_2d, method='L-BFGS-B')\n            profile_values.append(res_prof.fun)\n\n        # 3. Calculate Delta_max and determine flatness\n        delta_max = np.max(profile_values) - l_min\n        is_flat = delta_max <= tolerance\n        results.append(is_flat)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda b: str(b), results))}]\")\n\nsolve()\n```"
        }
    ]
}