{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将引导你完成奇异摄动分析的基本步骤。通过将该方法应用于一个简单的基因调控模型，你将练习识别快慢变量、推导慢流形以及获得最终的简化模型，这些都是这一强大降维技术的核心步骤 。",
            "id": "3918750",
            "problem": "考虑一个最小的基因调控模块，其中蛋白质浓度 $p$ 由转录信号 $s$ 驱动。其无量纲形式的机理模型由以下常微分方程组（ODE）给出：\n$$\n\\dot{p} \\;=\\; \\alpha\\, s \\;-\\; \\gamma_p\\, p,\\qquad \\epsilon\\, \\dot{s} \\;=\\; \\beta \\;-\\; s \\;+\\; \\eta\\, p,\n$$\n其中 $\\alpha$、$\\beta$、$\\gamma_p$ 和 $\\eta$ 是正常数，而 $0  \\epsilon \\ll 1$ 量化了转录信号 $s$ 与蛋白质 $p$ 之间的时间尺度分离。假设所有变量和参数都是无量纲的。小参数 $\\epsilon$ 反映了 $s$ 在比 $p$ 快得多的时间尺度上弛豫。您可以假设 Tikhonov 和 Fenichel 的快慢系统经典奇异摄动框架以及常微分方程的标准性质均适用。\n\n从给定的常微分方程组出发，仅使用时间尺度分离和奇异摄动分析的第一性原理（不使用快捷公式），执行以下操作：\n\n- 引入快时间变量 $\\tau$（满足 $\\tau = t/\\epsilon$），并将系统重写为规范的快慢形式，清楚地说明哪个变量是快变量，哪个是慢变量。\n- 通过在快子系统中取形式极限 $\\epsilon \\to 0$ 来确定临界（慢）流形，并通过检验流形周围快动力学的线性化来证明其法向双曲性。\n- 推导临界流形上 $p(t)$ 的主阶降维慢动力学。\n- 在快时间 $\\tau$ 中，将 $p$ 视为冻结参数，陈述快变量的边界层（内）动力学。\n- 给出用 $p$ 和参数表示 $s$ 的显式主阶慢流形函数 $h(p)$。\n\n答案规格：以 $p$、$\\beta$ 和 $\\eta$ 表示 $h(p)$，作为一个单一的闭式解析表达式。最终答案中不要包含等号。不需要单位。",
            "solution": "该问题陈述是动力系统和合成生物学建模领域中一个有效且适定的问题。它要求对一个快慢常微分方程组进行奇异摄动分析的标准应用。所有必要信息均已提供，其前提在科学和数学上都是合理的。\n\n该常微分方程组（ODE）由以下方程给出：\n$$\n\\frac{dp}{dt} = \\alpha s - \\gamma_p p\n$$\n$$\n\\epsilon \\frac{ds}{dt} = \\beta - s + \\eta p\n$$\n其中 $p$ 是蛋白质浓度，$s$ 是转录信号。参数 $\\alpha$、$\\beta$、$\\gamma_p$ 和 $\\eta$ 是正常数。参数 $\\epsilon$ 是一个小的正数，$0  \\epsilon \\ll 1$，表明 $s$ 是一个快变量，$p$ 是一个慢变量。\n\n**规范的快慢形式**\n为了分析系统的时间尺度，我们引入一个快时间变量 $\\tau = t/\\epsilon$。这意味着 $t = \\epsilon\\tau$。我们使用链式法则将关于 $t$ 的导数转换为关于 $\\tau$ 的导数：\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt}\\frac{d}{d\\tau} = \\frac{1}{\\epsilon}\\frac{d}{d\\tau}\n$$\n将此应用于该系统，得到：\n$$\n\\frac{1}{\\epsilon}\\frac{dp}{d\\tau} = \\alpha s - \\gamma_p p \\quad \\implies \\quad \\frac{dp}{d\\tau} = \\epsilon (\\alpha s - \\gamma_p p)\n$$\n$$\n\\frac{1}{\\epsilon}(\\epsilon \\frac{ds}{dt}) = \\frac{1}{\\epsilon}(\\beta - s + \\eta p) \\quad \\implies \\quad \\frac{ds}{d\\tau} = \\beta - s + \\eta p\n$$\n因此，在快时间尺度 $\\tau$ 下的系统为：\n$$\n\\frac{dp}{d\\tau} = \\epsilon (\\alpha s - \\gamma_p p)\n$$\n$$\n\\frac{ds}{d\\tau} = \\beta - s + \\eta p\n$$\n这就是规范的快慢形式。在极限 $\\epsilon \\to 0$ 下，我们有 $\\frac{dp}{d\\tau} \\to 0$，这表明 $p$ 是慢变量，因为它在快时间尺度上基本保持不变。相反，$\\frac{ds}{d\\tau}$ 是 $O(1)$ 阶的，这证实了 $s$ 是快变量。\n\n**临界流形和法向双曲性**\n临界流形，也称为慢流形 $M_0$，是相空间中快动力学处于平衡状态的点集。这可以通过在原系统中设置 $\\epsilon = 0$ 来找到。具体来说，我们将快变量方程的右侧设为零：\n$$\n\\epsilon \\frac{ds}{dt} = \\beta - s + \\eta p \\quad \\xrightarrow{\\epsilon \\to 0} \\quad 0 = \\beta - s + \\eta p\n$$\n解这个关于快变量 $s$ 并用慢变量 $p$ 表示的代数方程，就得到了临界流形的方程：\n$$\ns = \\beta + \\eta p\n$$\n这个关系定义了快变量的准稳态。\n\n为了证明该流形的法向双曲性，我们分析了当慢变量 $p$ 取固定值时快动力学的稳定性。快子系统由快时间 $\\tau$ 中 $s$ 的动力学给出，其中 $p$ 被视为一个参数：\n$$\n\\frac{ds}{d\\tau} = \\beta + \\eta p - s\n$$\n这是一个关于 $s(\\tau)$ 的线性一阶常微分方程。其平衡点恰好是 $s = \\beta + \\eta p$，这定义了流形 $M_0$。为了评估稳定性，我们计算快动力学相对于快变量 $s$ 的雅可比矩阵：\n$$\nJ_s = \\frac{\\partial}{\\partial s} (\\beta + \\eta p - s) = -1\n$$\n这个 $1 \\times 1$ 雅可比矩阵的特征值为 $\\lambda = -1$。由于特征值的实部严格为负（$\\mathrm{Re}(\\lambda)  0$），因此对于参数 $p$ 的任何值，该平衡点都是渐近稳定的。快动力学朝向流形 $M_0$ 的这种一致稳定性证实了临界流形是法向双曲的（并且是吸引的）。\n\n**降维慢动力学**\n降维慢动力学描述了系统在临界流形 $M_0$ 上的演化。我们通过将快变量的准稳态表达式 $s = \\beta + \\eta p$ 代入慢变量的方程 $\\dot{p}$ 来获得它：\n$$\n\\frac{dp}{dt} = \\alpha s - \\gamma_p p\n$$\n代入 $s = \\beta + \\eta p$：\n$$\n\\frac{dp}{dt} = \\alpha (\\beta + \\eta p) - \\gamma_p p\n$$\n$$\n\\frac{dp}{dt} = \\alpha\\beta + \\alpha\\eta p - \\gamma_p p\n$$\n这可以写成一个关于 $p(t)$ 的单一常微分方程：\n$$\n\\frac{dp}{dt} = \\alpha\\beta - (\\gamma_p - \\alpha\\eta)p\n$$\n这就是蛋白质浓度 $p(t)$ 的主阶降维慢动力学。\n\n**边界层（内）动力学**\n边界层动力学描述了快变量 $s$ 接近临界流形时的初始快速瞬态过程。这些动力学由快子系统捕捉，通过在以快时间 $\\tau$ 书写的系统中设置 $\\epsilon=0$ 来获得：\n$$\n\\frac{dp}{d\\tau} = 0\n$$\n$$\n\\frac{ds}{d\\tau} = \\beta - s + \\eta p\n$$\n第一个方程意味着慢变量 $p$ 在这个瞬态过程中是“冻结”的，即 $p(\\tau) = p(0)$，其中 $p(0)$ 是 $p$ 的初始条件。因此，快变量 $s$ 的动力学由以下方程控制：\n$$\n\\frac{ds}{d\\tau} = \\beta - s + \\eta p(0)\n$$\n该方程描述了 $s$ 从其初始条件 $s(0)$ 指数弛豫到临界流形上对应于 $p(0)$ 的点，即 $s_{eq} = \\beta + \\eta p(0)$。\n\n**主阶慢流形函数 $h(p)$**\n问题要求给出显式函数 $h(p)$，使得慢流形由 $s = h(p)$ 给出。如在确定临界流形时所推导的，该函数通过求解准稳态条件 $0 = \\beta - s + \\eta p$ 得到 $s$。\n这得出：\n$$\ns = \\beta + \\eta p\n$$\n因此，函数 $h(p)$ 是：\n$$\nh(p) = \\beta + \\eta p\n$$\n此表达式提供了在初始边界层瞬态衰减后，快变量 $s$ 作为慢变量 $p$ 的函数的主阶近似。\n\n最终需要的答案是 $h(p)$ 的表达式。",
            "answer": "$$\n\\boxed{\\beta + \\eta p}\n$$"
        },
        {
            "introduction": "在掌握基础之上，本练习深入探讨了边界层动力学，即系统接近慢流形的初始快速瞬态过程。这个问题  揭示了快慢系统一个关键且不直观的特性：慢动态对于快变量中巨大但短暂的扰动具有鲁棒性。理解这一现象是领会模型降维为何如此有效的关键。",
            "id": "3918752",
            "problem": "一个合成基因调控模块通过关于一个慢状态变量（蛋白质浓度）和一个快状态变量（启动子占据率）的常微分方程组 (ODEs) 进行建模。设蛋白质浓度表示为 $x(t)$，启动子占据率表示为 $y(t)$。在一个生理工作点附近进行线性化后，该模块由以下快慢系统描述\n$$\n\\frac{dx}{dt} \\;=\\; \\alpha\\, y \\;-\\; \\beta\\, x,\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{1}{\\epsilon}\\,\\big(\\sigma \\;+\\; \\kappa\\, x \\;-\\; y\\big),\n$$\n其中 $\\alpha0$，$\\beta0$，$\\kappa\\ge 0$ 和 $\\sigma$ 相对于小的无量纲分离参数 $0\\epsilon\\ll 1$ 都是 $\\mathcal{O}(1)$ 阶的。降维慢流形由代数条件 $y=\\sigma+\\kappa x$ 给出。考虑在相同的 $x(0)=x_0$ 但不同的 $y(0)$ 下的两种初始化：一种是准备良好的初始条件 $y(0)=\\sigma+\\kappa x_0$，另一种是带有 $\\Delta=\\mathcal{O}(1)$ 的不匹配初始条件 $y(0)=\\sigma+\\kappa x_0+\\Delta$。使用奇异摄动分析 (SPA)，在适当的情况下包括内层（快）和外层（慢）近似：\n\n1) 在快时间尺度 $t=\\mathcal{O}(\\epsilon)$ 上，推导 $y(t)$ 的领头阶内层解；在慢时间尺度 $t=\\mathcal{O}(1)$ 上，推导 $x(t)$ 的领头阶降维（外层）动力学。\n\n2) 设 $x_{\\Delta}(t)$ 表示不匹配初始化下的解，$x_{0}(t)$ 表示准备良好的初始化下的解。当 $\\epsilon\\to 0$ 时，推导偏差 $\\delta x(t):=x_{\\Delta}(t)-x_{0}(t)$ 的领头阶渐近形式，该形式对固定的、与 $\\epsilon$ 无关的 $t0$ 有效，其形式为\n$$\n\\delta x(t) \\;\\sim\\; C\\,\\epsilon\\,\\exp(-\\beta t),\n$$\n并用文字简要解释，为什么尽管初始失配 $\\Delta$ 可能很大，但对于 $t\\gg \\epsilon$，$y(t)$ 中的快速暂态仅对 $x(t)$ 产生一个 $\\mathcal{O}(\\epsilon)$ 阶的影响。\n\n3) 给出系数 $C$ 的一个以 $\\alpha$、$\\beta$、$\\kappa$、$\\sigma$、$x_0$ 和 $\\Delta$ 表示的闭式解析表达式。你的最终答案必须是这个关于 $C$ 的单一表达式。",
            "solution": "我们从以下模型开始\n$$\n\\frac{dx}{dt} \\;=\\; \\alpha\\, y \\;-\\; \\beta\\, x,\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{1}{\\epsilon}\\,\\big(\\sigma \\;+\\; \\kappa\\, x \\;-\\; y\\big),\n$$\n该模型由于 $0\\epsilon\\ll 1$ 而表现出时间尺度分离。快变量 $y(t)$ 快速弛豫到慢流形 $y=\\sigma+\\kappa x$ 上，而 $x(t)$ 则在慢时间尺度上演化。这是奇异摄动分析 (SPA) 的标准设定，其中引入内层（快）时间和外层（慢）描述，并进行匹配。\n\n1) $y(t)$ 的内层（快）解和 $x(t)$ 的外层（慢）动力学。\n\n引入快时间 $\\tau = t/\\epsilon$。在这个快时间上，导数变换为 $d/dt = (1/\\epsilon)\\,d/d\\tau$。在 $t=\\mathcal{O}(\\epsilon)$ 的初始边界层上，慢变量 $x$ 仅改变 $\\mathcal{O}(\\epsilon)$，因此在领头阶上可以将其视为常数，其值为初始值 $x(0)=x_0$。$y$ 的快方程变为\n$$\n\\frac{dy}{d\\tau} \\;=\\; \\sigma + \\kappa x_0 - y,\n$$\n在不匹配的情况下，初始条件为 $y(0)=\\sigma+\\kappa x_0+\\Delta$。这个线性常微分方程具有以下领头阶内层解\n$$\ny_{\\text{in}}(\\tau) \\;=\\; \\sigma + \\kappa x_0 \\;+\\; \\Delta\\,\\exp(-\\tau),\n$$\n或者，用原始时间变量等价地表示为\n$$\ny_{\\text{in}}(t) \\;=\\; \\sigma + \\kappa x_0 \\;+\\; \\Delta\\,\\exp\\!\\big(-t/\\epsilon\\big).\n$$\n因此，不论初始失配 $\\Delta=\\mathcal{O}(1)$ 的大小如何，快变量 $y$ 都会在 $\\mathcal{O}(\\epsilon)$ 的时间尺度上以指数形式快速返回到慢流形。\n\n对于外层（慢）动力学，我们施加准稳态代数约束 $y=\\sigma+\\kappa x$ 并将其代入 $x$ 的方程，以获得降维系统：\n$$\n\\frac{dx}{dt} \\;=\\; \\alpha\\big(\\sigma+\\kappa x\\big) \\;-\\; \\beta x \\;=\\; \\alpha \\sigma \\;+\\; (\\alpha\\kappa - \\beta)\\,x.\n$$\n这是 $x(t)$ 在 $t=\\mathcal{O}(1)$ 及更长的时间上的领头阶慢演化。\n\n2) 当 $\\epsilon\\to 0$ 时，对于固定的 $t0$，领头阶渐近偏差 $\\delta x(t)$。\n\n设 $x_{\\Delta}(t)$ 是对应于 $y$ 的不匹配初始条件的 $x$ 轨迹，而 $x_{0}(t)$ 是对应于准备良好的初始条件（即 $\\Delta=0$）的 $x$ 轨迹，两者都具有相同的 $x(0)=x_0$。定义偏差\n$$\n\\delta x(t) \\;=\\; x_{\\Delta}(t) \\;-\\; x_{0}(t).\n$$\n将两种初始化下的 $x$ 方程相减，得到关于 $\\delta x$ 的线性非自治常微分方程：\n$$\n\\frac{d}{dt}\\,\\delta x(t) \\;=\\; \\alpha\\,\\delta y(t) \\;-\\; \\beta\\,\\delta x(t), \\qquad \\delta x(0)=0,\n$$\n其中 $\\delta y(t):=y_{\\Delta}(t)-y_{0}(t)$ 是快状态之间的差异。在领头阶上，$y_{0}(t)$ 已经位于慢流形上，而 $y_{\\Delta}(t)$ 遵循内层解。在快速暂态期间，慢变量 $x$ 仅改变 $\\mathcal{O}(\\epsilon)$，因此在领头阶上我们可以取\n$$\n\\delta y(t) \\;\\approx\\; \\Delta\\,\\exp\\!\\big(-t/\\epsilon\\big).\n$$\n因此，关于 $\\delta x$ 的线性常微分方程，其强迫项为 $\\alpha\\,\\Delta\\,\\exp(-t/\\epsilon)$，齐次衰减率为 $\\beta$，可以通过常数变易法精确求解：\n$$\n\\delta x(t) \\;=\\; \\alpha \\int_{0}^{t} \\exp\\!\\big(-\\beta (t-s)\\big)\\,\\Delta\\,\\exp\\!\\big(-s/\\epsilon\\big)\\,ds.\n$$\n显式地计算该积分：\n$$\n\\delta x(t) \\;=\\; \\alpha\\,\\Delta\\,\\exp\\!\\big(-\\beta t\\big)\\,\\int_{0}^{t} \\exp\\!\\Big(s\\big(\\beta - \\tfrac{1}{\\epsilon}\\big)\\Big)\\,ds\n\\;=\\; \\alpha\\,\\Delta\\,\\exp\\!\\big(-\\beta t\\big)\\,\\frac{1 - \\exp\\!\\big(-t(\\tfrac{1}{\\epsilon}-\\beta)\\big)}{\\tfrac{1}{\\epsilon}-\\beta}.\n$$\n对于固定的、与 $\\epsilon$ 无关的 $t0$，当 $\\epsilon\\to 0^{+}$ 时，我们有 $\\tfrac{1}{\\epsilon}-\\beta \\to +\\infty$ 和 $\\exp\\!\\big(-t(\\tfrac{1}{\\epsilon}-\\beta)\\big)\\to 0$。使用展开式\n$$\n\\frac{1}{\\tfrac{1}{\\epsilon}-\\beta} \\;=\\; \\frac{\\epsilon}{1-\\beta \\epsilon} \\;=\\; \\epsilon \\;+\\; \\mathcal{O}(\\epsilon^{2}),\n$$\n我们得到领头阶渐近形式\n$$\n\\delta x(t) \\;\\sim\\; \\alpha\\,\\Delta\\,\\epsilon\\,\\exp\\!\\big(-\\beta t\\big), \\qquad \\epsilon\\to 0^{+},\\quad t=\\mathcal{O}(1).\n$$\n因此，在\n$$\n\\delta x(t) \\;\\sim\\; C\\,\\epsilon\\,\\exp\\!\\big(-\\beta t\\big)\n$$\n中的所求系数为\n$$\nC \\;=\\; \\alpha\\,\\Delta.\n$$\n\n鲁棒性的直观解释：虽然初始失配 $\\Delta$ 在快状态 $y(t)$ 中产生了一个 $\\mathcal{O}(1)$ 阶的偏差，但这个偏差在快时间尺度 $t=\\mathcal{O}(\\epsilon)$ 上衰减。慢状态 $x(t)$ 通过产生项 $\\alpha y$ 对 $y(t)$ 的影响进行积分，因此快速暂态对 $x$ 的净效应与快速脉冲下的面积成正比，即\n$$\n\\alpha \\int_{0}^{\\infty} \\Delta\\,\\exp\\!\\big(-t/\\epsilon\\big)\\,dt \\;=\\; \\alpha\\,\\Delta\\,\\epsilon,\n$$\n并受暂态后累积的慢衰减因子 $\\exp(-\\beta t)$ 的调制。因此，对于任何固定的 $t\\gg \\epsilon$，$x(t)$ 中的偏差仅为 $\\mathcal{O}(\\epsilon)$ 阶，这证明了慢变量对于快变量中大的但短暂的失配具有鲁棒性。\n\n3) 出现在领头阶渐近偏差中的系数 $C$ 是\n$$\nC \\;=\\; \\alpha\\,\\Delta.\n$$\n在领头阶上，这个表达式与 $\\kappa$、$\\sigma$ 和 $x_0$ 无关，因为这些参数只影响慢流形的位置和匹配的慢演化，而不影响驱动两个 $x$ 轨迹之间差异的初始快速暂态的面积。",
            "answer": "$$\\boxed{\\alpha\\,\\Delta}$$"
        },
        {
            "introduction": "最后的练习将从解析理论转向计算验证，这是现代生物建模中的关键一步。你将实现一个完整的机理模型及其简化版本，然后使用灵敏度分析来定量比较它们的行为 。这个练习突出了简化模型在何种情况下是有效的近似，以及被消除的快动态何时可能对系统的参数灵敏度产生显著影响。",
            "id": "3918755",
            "problem": "考虑一个由恒定转录因子输入驱动的、具有快速启动子结合子网络的合成基因表达模块。完整的机理模型由信使核糖核酸（mRNA）、蛋白质和启动子-因子复合物状态组成，遵循质量作用动力学。设状态变量 $m(t)$ 代表信使核糖核酸，$p(t)$ 代表蛋白质，$c(t)$ 代表启动子-因子复合物。设参数为 $\\theta = \\left[k_{\\mathrm{tx}},\\, k_{\\mathrm{tl}},\\, \\gamma_m,\\, \\gamma_p,\\, k_{\\mathrm{on}},\\, k_{\\mathrm{off}},\\, T_{\\mathrm{tot}},\\, \\varepsilon,\\, U\\right]$，其中 $k_{\\mathrm{tx}}$ 是转录速率，$k_{\\mathrm{tl}}$ 是翻译速率，$\\gamma_m$ 是信使核糖核酸降解速率，$\\gamma_p$ 是蛋白质降解速率，$k_{\\mathrm{on}}$ 是启动子-因子结合的开启速率，$k_{\\mathrm{off}}$ 是关闭速率，$T_{\\mathrm{tot}}$ 是总启动子浓度，$\\varepsilon$ 是一个缩放快速结合动力学的小参数，$U$ 是恒定的转录因子输入浓度。完整的常微分方程（ODE）模型是\n$$\n\\frac{dm}{dt} = k_{\\mathrm{tx}}\\, c - \\gamma_m\\, m,\\qquad\n\\frac{dp}{dt} = k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p,\\qquad\n\\varepsilon\\, \\frac{dc}{dt} = k_{\\mathrm{on}}\\, (T_{\\mathrm{tot}} - c)\\, U - k_{\\mathrm{off}}\\, c,\n$$\n初始条件为 $m(0)=0$, $p(0)=0$, $c(0)=0$。小参数 $\\varepsilon$ 强制使 $c(t)$ 相对于 $m(t)$ 和 $p(t)$ 是一个快状态。在快状态准瞬时弛豫的奇异摄动假设下，简化模型通过准稳态代数关系 $c^{\\ast} = T_{\\mathrm{tot}}\\, U / \\left(U + K_d\\right)$（其中 $K_d = k_{\\mathrm{off}}/k_{\\mathrm{on}}$）消除了 $c(t)$，从而得到简化的常微分方程组\n$$\n\\frac{dm}{dt} = k_{\\mathrm{tx}}\\, c^{\\ast} - \\gamma_m\\, m,\\qquad\n\\frac{dp}{dt} = k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p,\n$$\n初始条件同样为 $m(0)=0$, $p(0)=0$。\n\n您的任务是实现一个局部的、在时间 $T$ 的输出灵敏度分析，以在固定的有限时间点比较完整模型和简化模型。具体来说，对于每个参数矢量 $\\theta$，计算蛋白质输出 $p(T)$ 对每个参数的对数灵敏度，\n$$\nS_j^{\\log} = \\frac{\\theta_j}{\\max\\{p(T),\\, \\delta\\}}\\, \\frac{\\partial p(T)}{\\partial \\theta_j},\n$$\n对于每个参数索引 $j$，其中 $\\delta$ 是一个用于避免除以零的小正常数。使用由模型雅可比矩阵驱动的正向灵敏度常微分方程，为完整模型和简化模型计算 $\\partial p(T)/\\partial \\theta_j$，从 $t=0$ 时的零初始灵敏度开始。在有限时间 $T=10$ 进行比较（无物理单位；将所有量视为无量纲）。将参数 $j$ 的完整对数灵敏度与简化对数灵敏度之间的绝对差定义为\n$$\n\\Delta_j = \\left| S_{j,\\mathrm{full}}^{\\log} - S_{j,\\mathrm{red}}^{\\log} \\right|.\n$$\n对于每个测试用例，识别出满足 $\\Delta_j \\ge \\tau$ 的参数名称集合，其中阈值为 $\\tau = 0.25$。\n\n您必须使用模型雅可比矩阵从第一性原理实现两套灵敏度方程。对于具有动力学 $\\dot{x} = f(x,\\theta)$ 和灵敏度矩阵 $S(t) = \\partial x / \\partial \\theta$ 的状态向量 $x(t)$，其正向灵敏度方程为\n$$\n\\frac{dS}{dt} = J_x(x,\\theta)\\, S + J_\\theta(x,\\theta),\n$$\n其中 $J_x = \\partial f / \\partial x$ 且 $J_\\theta = \\partial f / \\partial \\theta$。将 $S(0)$ 初始化为适当大小的零矩阵。使用适用于可能很小的 $\\varepsilon$ 的刚性积分器。\n\n测试套件。使用以下4个参数集，每个参数集都以有序列表的形式报告 $\\left[k_{\\mathrm{tx}},\\, k_{\\mathrm{tl}},\\, \\gamma_m,\\, \\gamma_p,\\, k_{\\mathrm{on}},\\, k_{\\mathrm{off}},\\, T_{\\mathrm{tot}},\\, \\varepsilon,\\, U\\right]$：\n\n- 案例1（快速结合，强激活）：$\\left[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.01,\\, 2\\right]$。\n- 案例2（慢结合时间尺度）：$\\left[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.5,\\, 2\\right]$。\n- 案例3（弱结合亲和力）：$\\left[50,\\, 5,\\, 1,\\, 0.2,\\, 1,\\, 20,\\, 1,\\, 0.01,\\, 2\\right]$。\n- 案例4（低转录因子输入）：$\\left[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.01,\\, 0.05\\right]$。\n\n对于每个案例，计算满足 $\\Delta_j \\ge \\tau$ 的参数名称列表，按 $\\Delta_j$ 降序排序；若值相等，则按参数名称的字典序排序。使用上面定义的与 $\\theta$ 相对应的参数名称顺序 $\\left[\\text{\"k\\_tx\"},\\, \\text{\"k\\_tl\"},\\, \\text{\"gamma\\_m\"},\\, \\text{\"gamma\\_p\"},\\, \\text{\"k\\_on\"},\\, \\text{\"k\\_off\"},\\, \\text{\"T\\_tot\"},\\, \\text{\"epsilon\"},\\, \\text{\"U\"}\\right]$。使用小常数 $\\delta = 10^{-12}$。\n\n最终输出格式。您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中每个条目本身是对应一个测试用例的参数名称列表（例如，$[\\,[\\text{\"k\\_on\"}],\\,[\\text{\"k\\_on\"},\\text{\"k\\_off\"}]\\,]$）。不需要单位；所有量都是无量纲的。每个测试用例的答案是一个字符串列表。",
            "solution": "用户要求在一个合成基因线路的完整模型和简化模型之间，对局部输出灵敏度进行比较。该比较将在一个固定的时间点 $T=10$ 进行，通过计算一组模型参数的对数灵敏度来完成。任务的核心是为两个模型实现正向灵敏度方程。\n\n### 问题验证\n\n**第1步：提取给定信息**\n- **状态（完整模型）**：$m(t)$（mRNA），$p(t)$（蛋白质），$c(t)$（启动子-因子复合物）。\n- **参数**：$\\theta = \\left[k_{\\mathrm{tx}},\\, k_{\\mathrm{tl}},\\, \\gamma_m,\\, \\gamma_p,\\, k_{\\mathrm{on}},\\, k_{\\mathrm{off}},\\, T_{\\mathrm{tot}},\\, \\varepsilon,\\, U\\right]$。\n  - $k_{\\mathrm{tx}}$：转录速率\n  - $k_{\\mathrm{tl}}$：翻译速率\n  - $\\gamma_m$：mRNA 降解速率\n  - $\\gamma_p$：蛋白质降解速率\n  - $k_{\\mathrm{on}}$：启动子-因子结合开启速率\n  - $k_{\\mathrm{off}}$：启动子-因子结合关闭速率\n  - $T_{\\mathrm{tot}}$：总启动子浓度\n  - $\\varepsilon$：用于快速动力学的小参数\n  - $U$：恒定转录因子输入浓度\n- **完整模型常微分方程组**：\n$$\n\\frac{dm}{dt} = k_{\\mathrm{tx}}\\, c - \\gamma_m\\, m \\\\\n\\frac{dp}{dt} = k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p \\\\\n\\varepsilon\\, \\frac{dc}{dt} = k_{\\mathrm{on}}\\, (T_{\\mathrm{tot}} - c)\\, U - k_{\\mathrm{off}}\\, c\n$$\n- **简化模型常微分方程组**：\n$$\nc^{\\ast} = \\frac{T_{\\mathrm{tot}}\\, U}{U + K_d} \\quad \\text{其中} \\quad K_d = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}} \\\\\n\\frac{dm}{dt} = k_{\\mathrm{tx}}\\, c^{\\ast} - \\gamma_m\\, m \\\\\n\\frac{dp}{dt} = k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p\n$$\n- **初始条件**：$m(0)=0$，$p(0)=0$，$c(0)=0$。对于简化模型，$m(0)=0$，$p(0)=0$。\n- **任务**：\n  - 计算完整模型和简化模型的对数灵敏度 $S_j^{\\log} = \\frac{\\theta_j}{\\max\\{p(T),\\, \\delta\\}}\\, \\frac{\\partial p(T)}{\\partial \\theta_j}$。\n  - 计算绝对差 $\\Delta_j = \\left| S_{j,\\mathrm{full}}^{\\log} - S_{j,\\mathrm{red}}^{\\log} \\right|$。\n  - 识别出 $\\Delta_j \\ge \\tau$ 的参数。\n- **常数**：$T=10$，$\\delta = 10^{-12}$，$\\tau=0.25$。\n- **正向灵敏度方程**：$\\frac{dS}{dt} = J_x(x,\\theta)\\, S + J_\\theta(x,\\theta)$，其中 $S(0) = 0$。\n- **参数测试用例**：\n  1. $[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.01,\\, 2]$\n  2. $[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.5,\\, 2]$\n  3. $[50,\\, 5,\\, 1,\\, 0.2,\\, 1,\\, 20,\\, 1,\\, 0.01,\\, 2]$\n  4. $[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.01,\\, 0.05]$\n- **输出**：每个案例中满足 $\\Delta_j \\ge \\tau$ 的参数名称列表，按 $\\Delta_j$ 降序排序，然后按名称排序。\n\n**第2步：使用提取的给定信息进行验证**\n- **科学依据**：该问题描述了一个用于基因表达的标准质量作用动力学模型，这是系统生物学和合成生物学中的一个基本概念。模型简化使用了奇异摄动分析（特别是准稳态假设），这是一种用于处理多时间尺度系统的成熟数学技术。通过正向灵敏度方程进行的灵敏度分析是工程和科学领域的标准方法。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。给定初始条件的常微分方程模型具有唯一解。计算灵敏度的任务在算法上是明确定义的，并会产生唯一的结果。\n- **客观性**：该问题以精确的数学和算法术语陈述，没有主观性语言。\n\n**第3步：结论与行动**\n该问题是有效的。将提供一个合理的解决方案。\n\n### 基于原理的解决方案设计\n\n该解决方案需要数值求解两套增广常微分方程（ODEs），一套用于完整模型，另一套用于简化模型。每个增广系统都将原始状态方程与正向灵敏度方程结合起来。\n\n**1. 完整模型灵敏度分析**\n\n设状态向量为 $x(t) = [m(t), p(t), c(t)]^T$，参数向量为 $\\theta \\in \\mathbb{R}^9$。动力学为 $\\dot{x} = f(x, \\theta)$，其中：\n$$\nf(x, \\theta) = \\begin{pmatrix} k_{\\mathrm{tx}}\\, c - \\gamma_m\\, m \\\\ k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p \\\\ \\frac{1}{\\varepsilon} \\left( k_{\\mathrm{on}}(T_{\\mathrm{tot}} - c)U - k_{\\mathrm{off}}c \\right) \\end{pmatrix}\n$$\n灵敏度矩阵 $S(t) = \\frac{\\partial x(t)}{\\partial \\theta}$ 是一个 $3 \\times 9$ 矩阵，其动力学由以下方程控制：\n$$ \\frac{dS}{dt} = J_x S + J_\\theta $$\n其中 $J_x = \\frac{\\partial f}{\\partial x}$ 是 $3 \\times 3$ 的状态雅可比矩阵，$J_\\theta = \\frac{\\partial f}{\\partial \\theta}$ 是 $3 \\times 9$ 的参数雅可比矩阵。\n\n状态雅可比矩阵 $J_x$ 是：\n$$\nJ_x = \\begin{pmatrix}\n-\\gamma_m  0  k_{\\mathrm{tx}} \\\\\nk_{\\mathrm{tl}}  -\\gamma_p  0 \\\\\n0  0  \\frac{1}{\\varepsilon}(-k_{\\mathrm{on}}U - k_{\\mathrm{off}})\n\\end{pmatrix}\n$$\n参数雅可比矩阵 $J_\\theta$ 包含 $f$ 对9个参数中每一个的偏导数。例如，第一列（关于 $k_{\\mathrm{tx}}$）是 $[\\partial \\dot{m}/\\partial k_{\\mathrm{tx}}, \\partial \\dot{p}/\\partial k_{\\mathrm{tx}}, \\partial \\dot{c}/\\partial k_{\\mathrm{tx}}]^T = [c, 0, 0]^T$。所有9列都是系统地推导出来的。\n\n增广系统由3个状态方程和 $3 \\times 9 = 27$ 个灵敏度方程组成，构成一个包含30个常微分方程的系统。初始条件为 $x(0) = [0, 0, 0]^T$ 和 $S(0) = 0_{3 \\times 9}$。该系统从 $t=0$ 积分到 $t=T=10$。\n\n**2. 简化模型灵敏度分析**\n\n设状态向量为 $x_{\\mathrm{red}}(t) = [m(t), p(t)]^T$。动力学为 $\\dot{x}_{\\mathrm{red}} = g(x_{\\mathrm{red}}, \\theta)$，其中：\n$$\ng(x_{\\mathrm{red}}, \\theta) = \\begin{pmatrix} k_{\\mathrm{tx}}\\, c^{\\ast}(\\theta) - \\gamma_m\\, m \\\\ k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p \\end{pmatrix}\n$$\n代数项 $c^{\\ast}(\\theta)$ 是参数 $k_{\\mathrm{on}}, k_{\\mathrm{off}}, T_{\\mathrm{tot}}, U$ 的函数：\n$$\nc^{\\ast} = \\frac{k_{\\mathrm{on}} T_{\\mathrm{tot}} U}{k_{\\mathrm{on}}U + k_{\\mathrm{off}}}\n$$\n简化系统的灵敏度矩阵 $S_{\\mathrm{red}}(t) = \\frac{\\partial x_{\\mathrm{red}}(t)}{\\partial \\theta}$ 是一个 $2 \\times 9$ 矩阵。其动力学为：\n$$ \\frac{dS_{\\mathrm{red}}}{dt} = J_{x, \\mathrm{red}} S_{\\mathrm{red}} + J_{\\theta, \\mathrm{red}} $$\n状态雅可比矩阵 $J_{x, \\mathrm{red}} = \\frac{\\partial g}{\\partial x_{\\mathrm{red}}}$ 是一个 $2 \\times 2$ 矩阵：\n$$\nJ_{x, \\mathrm{red}} = \\begin{pmatrix} -\\gamma_m  0 \\\\ k_{\\mathrm{tl}}  -\\gamma_p \\end{pmatrix}\n$$\n参数雅可比矩阵 $J_{\\theta, \\mathrm{red}} = \\frac{\\partial g}{\\partial \\theta}$ 是一个 $2 \\times 9$ 矩阵。其条目取决于 $c^{\\ast}$ 对参数的导数。例如，$\\frac{\\partial \\dot{m}}{\\partial k_{\\mathrm{on}}} = k_{\\mathrm{tx}} \\frac{\\partial c^{\\ast}}{\\partial k_{\\mathrm{on}}}$。应用链式法则来找到这些导数：\n$$\n\\frac{\\partial c^{\\ast}}{\\partial k_{\\mathrm{on}}} = \\frac{T_{\\mathrm{tot}} U k_{\\mathrm{off}}}{(k_{\\mathrm{on}}U + k_{\\mathrm{off}})^2}, \\quad \\frac{\\partial c^{\\ast}}{\\partial k_{\\mathrm{off}}} = \\frac{-k_{\\mathrm{on}} T_{\\mathrm{tot}} U}{(k_{\\mathrm{on}}U + k_{\\mathrm{off}})^2}, \\quad \\text{等。}\n$$\n值得注意的是，$\\frac{\\partial g}{\\partial \\varepsilon} = [0, 0]^T$，因此简化模型对 $\\varepsilon$ 的灵敏度为零，这符合预期。\n\n简化模型的增广系统由2个状态方程和 $2 \\times 9 = 18$ 个灵敏度方程组成，总计20个常微分方程。初始条件为 $x_{\\mathrm{red}}(0) = [0, 0]^T$ 和 $S_{\\mathrm{red}}(0) = 0_{2 \\times 9}$。该系统也积分到 $t=T=10$。\n\n**3. 数值积分和最终计算**\n两个增广系统都是刚性的，特别是对于小的 $\\varepsilon$ 值，这是由于完整模型雅可比矩阵中存在 $1/\\varepsilon$ 项。因此，必须使用刚性常微分方程求解器（例如，`Radau` 或 `BDF`）。\n积分后，我们得到在 $t=T=10$ 时的状态和灵敏度值：\n- 从完整模型得到：$p_{\\mathrm{full}}(T)$ 和向量 $\\frac{\\partial p_{\\mathrm{full}}(T)}{\\partial \\theta}$（$S(T)$ 的第二行）。\n- 从简化模型得到：$p_{\\mathrm{red}}(T)$ 和向量 $\\frac{\\partial p_{\\mathrm{red}}(T)}{\\partial \\theta}$（$S_{\\mathrm{red}}(T)$ 的第二行）。\n\n利用这些值，我们计算每个参数 $\\theta_j$ 的对数灵敏度 $S_{j, \\mathrm{full}}^{\\log}$ 和 $S_{j, \\mathrm{red}}^{\\log}$。最后，我们计算它们的绝对差 $\\Delta_j$，识别出满足 $\\Delta_j \\ge 0.25$ 的参数，并根据指定标准对它们进行排序。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nimport sys\nimport io\n\n# Redirect stdout to capture print output for exact formatting\nold_stdout = sys.stdout\nsys.stdout = captured_output = io.StringIO()\n\ndef solve():\n    \"\"\"\n    Solves the model sensitivity analysis problem.\n    \"\"\"\n    # Constants\n    T_final = 10.0\n    delta = 1e-12\n    tau = 0.25\n    param_names = [\"k_tx\", \"k_tl\", \"gamma_m\", \"gamma_p\", \"k_on\", \"k_off\", \"T_tot\", \"epsilon\", \"U\"]\n    num_params = len(param_names)\n\n    test_cases = [\n        # Case 1 (fast binding, strong activation)\n        [50., 5., 1., 0.2, 100., 10., 1., 0.01, 2.],\n        # Case 2 (slow binding time scale)\n        [50., 5., 1., 0.2, 100., 10., 1., 0.5, 2.],\n        # Case 3 (weak binding affinity)\n        [50., 5., 1., 0.2, 1., 20., 1., 0.01, 2.],\n        # Case 4 (low transcription factor input)\n        [50., 5., 1., 0.2, 100., 10., 1., 0.01, 0.05]\n    ]\n\n    all_results = []\n\n    for params_list in test_cases:\n        params = np.array(params_list)\n        k_tx, k_tl, gamma_m, gamma_p, k_on, k_off, T_tot, epsilon, U = params\n\n        # --- Full Model Analysis ---\n        def rhs_full(t, Y):\n            # Unpack state and sensitivities\n            m, p, c = Y[0:3]\n            S = Y[3:].reshape((3, num_params))\n\n            # State equations\n            dmdt = k_tx * c - gamma_m * m\n            dpdt = k_tl * m - gamma_p * p\n            dcdt_unscaled = k_on * (T_tot - c) * U - k_off * c\n            dcdt = dcdt_unscaled / epsilon\n            dxdt = np.array([dmdt, dpdt, dcdt])\n\n            # State Jacobian J_x\n            Jx = np.zeros((3, 3))\n            Jx[0, 0] = -gamma_m\n            Jx[0, 2] = k_tx\n            Jx[1, 0] = k_tl\n            Jx[1, 1] = -gamma_p\n            Jx[2, 2] = (-k_on * U - k_off) / epsilon\n\n            # Parameter Jacobian J_p\n            Jp = np.zeros((3, num_params))\n            Jp[0, 0] = c  # d(dmdt)/dk_tx\n            Jp[1, 1] = m  # d(dpdt)/dk_tl\n            Jp[0, 2] = -m  # d(dmdt)/dgamma_m\n            Jp[1, 3] = -p  # d(dpdt)/dgamma_p\n            Jp[2, 4] = (T_tot - c) * U / epsilon  # d(dcdt)/dk_on\n            Jp[2, 5] = -c / epsilon  # d(dcdt)/dk_off\n            Jp[2, 6] = k_on * U / epsilon  # d(dcdt)/dT_tot\n            Jp[2, 7] = -dcdt_unscaled / (epsilon**2)  # d(dcdt)/depsilon\n            Jp[2, 8] = k_on * (T_tot - c) / epsilon  # d(dcdt)/dU\n\n            # Sensitivity equations\n            dSdt = Jx @ S + Jp\n            return np.concatenate((dxdt, dSdt.flatten()))\n\n        y0_full = np.zeros(3 + 3 * num_params)\n        sol_full = solve_ivp(rhs_full, [0, T_final], y0_full, method='Radau', t_eval=[T_final])\n        y_final_full = sol_full.y[:, 0]\n        p_T_full = y_final_full[1]\n        S_full_final = y_final_full[3:].reshape((3, num_params))\n        dp_dtheta_full = S_full_final[1, :]\n        log_sens_full = (params / max(p_T_full, delta)) * dp_dtheta_full\n\n        # --- Reduced Model Analysis ---\n        def rhs_red(t, Y):\n            # Unpack state and sensitivities\n            m, p = Y[0:2]\n            S = Y[2:].reshape((2, num_params))\n\n            # Quasi-steady state c* and its derivatives\n            denom = k_on * U + k_off\n            c_star = (k_on * T_tot * U) / denom\n            dc_star_dk_on = (T_tot * U * k_off) / (denom**2)\n            dc_star_dk_off = (-k_on * T_tot * U) / (denom**2)\n            dc_star_dT_tot = (k_on * U) / denom\n            dc_star_dU = (k_on * T_tot * k_off) / (denom**2)\n            \n            # State equations\n            dmdt = k_tx * c_star - gamma_m * m\n            dpdt = k_tl * m - gamma_p * p\n            dxdt = np.array([dmdt, dpdt])\n\n            # State Jacobian J_x\n            Jx = np.zeros((2, 2))\n            Jx[0, 0] = -gamma_m\n            Jx[1, 0] = k_tl\n            Jx[1, 1] = -gamma_p\n\n            # Parameter Jacobian J_p\n            Jp = np.zeros((2, num_params))\n            Jp[0, 0] = c_star  # k_tx\n            Jp[1, 1] = m  # k_tl\n            Jp[0, 2] = -m  # gamma_m\n            Jp[1, 3] = -p  # gamma_p\n            Jp[0, 4] = k_tx * dc_star_dk_on\n            Jp[0, 5] = k_tx * dc_star_dk_off\n            Jp[0, 6] = k_tx * dc_star_dT_tot\n            Jp[0, 7] = 0.0  # epsilon\n            Jp[0, 8] = k_tx * dc_star_dU\n            \n            # Sensitivity equations\n            dSdt = Jx @ S + Jp\n            return np.concatenate((dxdt, dSdt.flatten()))\n\n        y0_red = np.zeros(2 + 2 * num_params)\n        sol_red = solve_ivp(rhs_red, [0, T_final], y0_red, method='Radau', t_eval=[T_final])\n        y_final_red = sol_red.y[:, 0]\n        p_T_red = y_final_red[1]\n        S_red_final = y_final_red[2:].reshape((2, num_params))\n        dp_dtheta_red = S_red_final[1, :]\n        log_sens_red = (params / max(p_T_red, delta)) * dp_dtheta_red\n\n        # --- Comparison ---\n        delta_S_abs = np.abs(log_sens_full - log_sens_red)\n        \n        discrepant_params = []\n        for i in range(num_params):\n            if delta_S_abs[i] >= tau:\n                discrepant_params.append((delta_S_abs[i], param_names[i]))\n\n        # Sort results by delta_S (desc) and then by name (asc)\n        discrepant_params.sort(key=lambda x: (-x[0], x[1]))\n        \n        sorted_names = [name for val, name in discrepant_params]\n        all_results.append(sorted_names)\n\n    # Format the output to exactly match the required string representation\n    final_output_parts = []\n    for res_list in all_results:\n        quoted_names = [f'\"{name}\"' for name in res_list]\n        final_output_parts.append(f\"[{','.join(quoted_names)}]\")\n    \n    print(f\"[{','.join(final_output_parts)}]\")\n\nsolve()\n\n# Restore stdout and print the captured output\nsys.stdout = old_stdout\nprint(captured_output.getvalue().strip())\n```"
        }
    ]
}