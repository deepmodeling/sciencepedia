{
    "hands_on_practices": [
        {
            "introduction": "理解群体感应的开关特性是至关重要的。本练习将深入探讨一种常见的自诱导回路的核心非线性动力学，让您能够解析地确定系统产生双稳态的条件。通过计算能够消除这种开关行为的临界“渗漏”表达水平，您将在鞍结分岔分析方面获得实践经验，这是设计和理解基因开关的关键工具。",
            "id": "3920220",
            "problem": "考虑一个基于酰基高丝氨酸内酯 (AHL) 信号传导的合成群体感应模块，其中每个细胞通过合成酶蛋白 LuxI 产生 AHL，并通过转录因子 LuxR 感应 AHL。在一个均匀混合的高密度群体中，假设细胞外 AHL 浓度与细胞内浓度快速达到平衡，并与合成酶水平成正比，因此启动子激活可以被建模为合成酶浓度的 Hill 函数。令 $X$ 表示细胞内 LuxI 浓度。LuxI 的产生速率包括一个基础表达（泄漏）项 $\\varepsilon$ 和一个由 AHL-LuxR 激活引起的自诱导项。$X$ 的动力学由以下常微分方程 (ODE) 建模\n$$\n\\frac{dX}{dt} \\;=\\; \\varepsilon \\;+\\; \\alpha \\,\\frac{X^{n}}{K^{n} + X^{n}} \\;-\\; \\delta\\,X,\n$$\n其中 $\\alpha$ 是最大诱导产生速率，$K$ 是有效激活阈值，$n$ 是 Hill 系数，$\\delta$ 是一阶蛋白质稀释加降解速率。假设以下通过实验确定的参数值和生物物理特征：\n- AHL-LuxR 的转录激活在启动子上实际上是二聚体形式，因此 Hill 系数为 $n=2$。\n- 最大诱导 LuxI 产生速率为 $\\alpha = 50\\,\\mathrm{nM\\,min^{-1}}$。\n- 一阶损失速率为 $\\delta = 0.02\\,\\mathrm{min^{-1}}$。\n- 有效激活阈值为 $K = 1.6\\,\\mathrm{\\mu M} = 1600\\,\\mathrm{nM}$。\n\n从上述定义和 ODE 出发，分析基础表达 $\\varepsilon$ 如何通过改变产生曲线和线性损失项之间的交点来改变稳态的数量。从第一性原理推导两个稳态合并（鞍节点条件）的条件，并用它来计算临界泄漏水平 $\\varepsilon_{c}$，当泄漏水平高于此值时，系统不再存在多个稳态（即双稳态被破坏）。\n\n将您对 $\\varepsilon_{c}$ 的最终答案以 $\\mathrm{nM\\,min^{-1}}$ 为单位表示，并四舍五入到 4 位有效数字。",
            "solution": "该问题要求解临界基础表达水平 $\\varepsilon_{c}$，当基础表达高于此水平时，合成群体感应回路将失去其双稳态行为。LuxI 蛋白浓度（用 $X$ 表示）的动力学由以下常微分方程 (ODE) 给出：\n$$\n\\frac{dX}{dt} = \\varepsilon + \\alpha \\frac{X^{n}}{K^{n} + X^{n}} - \\delta X\n$$\n稳态（用 $X^*$ 表示）是系统不随时间变化的浓度，即 $\\frac{dX}{dt} = 0$。这给出了稳态方程：\n$$\n\\delta X^* = \\varepsilon + \\alpha \\frac{(X^*)^{n}}{K^{n} + (X^*)^{n}}\n$$\n这个方程可以图形化地解释为寻找总产生速率曲线 $P(X) = \\varepsilon + \\alpha \\frac{X^{n}}{K^{n} + X^{n}}$ 与线性降解加稀释速率线 $D(X) = \\delta X$ 之间的交点。如果存在三个不同的正交点（即三个稳态），则系统是双稳态的。当其中两个稳态合并并消失时，双稳态就消失了。这一事件被称为鞍节点分岔。\n\n当产生曲线 $P(X)$ 与降解线 $D(X)$ 相切时，发生鞍节点分岔。在这样一个点（我们用临界浓度 $X_c$ 表示），必须同时满足两个条件：\n1.  稳态条件：$P(X_c) = D(X_c)$\n2.  相切条件：$\\frac{dP}{dX}\\bigg|_{X=X_c} = \\frac{dD}{dX}\\bigg|_{X=X_c}$\n\n让我们计算导数。降解项的导数是常数：\n$$\n\\frac{dD}{dX} = \\delta\n$$\n产生项的导数可以使用商法则对 Hill 函数部分求导得到：\n$$\n\\frac{dP}{dX} = \\frac{d}{dX} \\left( \\varepsilon + \\alpha \\frac{X^{n}}{K^{n} + X^{n}} \\right) = \\alpha \\frac{n X^{n-1}(K^n + X^n) - X^n(n X^{n-1})}{(K^n + X^n)^2} = \\frac{\\alpha n K^n X^{n-1}}{(K^n + X^n)^2}\n$$\n因此，相切条件为：\n$$\n\\frac{\\alpha n K^n X_c^{n-1}}{(K^n + X_c^n)^2} = \\delta\n$$\n这个方程确定了发生分岔时的临界浓度 $X_c$。问题提供了参数值：$n=2$，$\\alpha = 50\\,\\mathrm{nM\\,min^{-1}}$，$\\delta = 0.02\\,\\mathrm{min^{-1}}$，以及 $K = 1600\\,\\mathrm{nM}$。\n\n将 $n=2$ 代入相切条件，我们得到：\n$$\n\\frac{2 \\alpha K^2 X_c}{(K^2 + X_c^2)^2} = \\delta\n$$\n为简化此方程，我们可以通过令 $x_c = X_c/K$ 对浓度进行无量纲化。代入 $X_c = K x_c$：\n$$\n\\frac{2 \\alpha K^2 (K x_c)}{(K^2 + (K x_c)^2)^2} = \\delta \\implies \\frac{2 \\alpha K^3 x_c}{K^4 (1 + x_c^2)^2} = \\delta \\implies \\frac{2 \\alpha x_c}{K (1 + x_c^2)^2} = \\delta\n$$\n重新整理以求解 $x_c$，我们得到一个多项式方程：\n$$\n(1 + x_c^2)^2 = \\frac{2 \\alpha}{K \\delta} x_c\n$$\n$$\n1 + 2x_c^2 + x_c^4 = \\left(\\frac{2 \\alpha}{K \\delta}\\right) x_c\n$$\n让我们计算系数 $\\frac{2 \\alpha}{K \\delta}$：\n$$\n\\frac{2 \\alpha}{K \\delta} = \\frac{2 \\times 50}{1600 \\times 0.02} = \\frac{100}{32} = 3.125\n$$\n无量纲临界浓度的方程是：\n$$\nx_c^4 + 2x_c^2 - 3.125 x_c + 1 = 0\n$$\n这个四次方程最多可以有四个实根。对于 $X_c>0$ 的物理系统，我们关心的是正实根。经检验可知 $x_c = 0.5$ 是一个根：\n$$\n(0.5)^4 + 2(0.5)^2 - 3.125(0.5) + 1 = 0.0625 + 2(0.25) - 1.5625 + 1 = 0.0625 + 0.5 - 1.5625 + 1 = 1.5625 - 1.5625 = 0\n$$\n存在另一个正实根，可以证明它大于 0.5。这两个根对应于两个不同的鞍节点分岔，它们定义了参数 $\\varepsilon$ 的双稳态区域的边界。\n系统在 $\\varepsilon$ 值的一个范围 $(\\varepsilon_{c,1}, \\varepsilon_{c,2})$ 内是双稳态的。问题要求的是临界水平 $\\varepsilon_c$，当 $\\varepsilon$ *高于* 此值时系统不再是双稳态的。这对应于双稳态区域的上边界。\n\n为了找出哪个根对应于上边界，我们可以分析函数 $g(X) = P(X) - D(X) = \\varepsilon + \\alpha \\frac{X^n}{K^n+X^n} - \\delta X$。稳态是 $g(X)=0$ 的根。或者，我们可以定义 $f(X) = \\alpha \\frac{X^n}{K^n+X^n} - \\delta X$，这样寻找稳态就等价于求解 $f(X) = -\\varepsilon$。稳态的数量是曲线 $y=f(X)$ 与水平线 $y=-\\varepsilon$ 的交点数量。当 $-\\varepsilon$ 位于 $f(X)$ 的局部最小值和局部最大值之间时，出现双稳态。分岔点 $X_c$ 是 $f(X)$ 的极值点，通过令 $f'(X_c)=0$ 求得，这与我们的相切条件是相同的。\n二阶导数是 $f''(X) = \\frac{d}{dX} \\left( \\frac{\\alpha n K^n X^{n-1}}{(K^n + X^n)^2} \\right)$。$f''(X_c)$ 的符号决定了 $X_c$ 是局部最小值还是最大值。对于 $n=2$，函数 $\\frac{\\alpha n K^n X^{n-1}}{(K^n + X^n)^2}$ 在 $X = K/\\sqrt{3}$（即 $x=1/\\sqrt{3} \\approx 0.577$）处有一个单峰。较小的根 $x_c=0.5$ 位于该函数的上升斜率上，因此 $f''(X_c)>0$，对应于 $f(X)$ 的一个局部最小值。较大的根位于下降斜率上，对应于一个局部最大值。\n\n令 $X_{c,min}$ 为 $f(X)$ 局部最小值的位置，$X_{c,max}$ 为局部最大值的位置。$-\\varepsilon$ 的双稳态范围是 $(f(X_{c,min}), f(X_{c,max}))$。这意味着 $\\varepsilon$ 的双稳态范围是 $(-f(X_{c,max}), -f(X_{c,min}))$。因此，上临界值 $\\varepsilon_c$ 是 $-f(X_{c,min})$。\n我们确定了较小的根是 $x_c=0.5$，所以 $X_{c,min} = 0.5 \\times K$。\n$$\n\\varepsilon_c = -f(X_{c,min}) = -\\left( \\alpha \\frac{X_{c,min}^n}{K^n + X_{c,min}^n} - \\delta X_{c,min} \\right) = \\delta X_{c,min} - \\alpha \\frac{X_{c,min}^n}{K^n + X_{c,min}^n}\n$$\n现在我们代入数值。\n$X_{c,min} = 0.5 \\times K = 0.5 \\times 1600\\,\\mathrm{nM} = 800\\,\\mathrm{nM}$。\n$n=2$。\n$$\n\\varepsilon_c = (0.02\\,\\mathrm{min^{-1}}) \\times (800\\,\\mathrm{nM}) - (50\\,\\mathrm{nM\\,min^{-1}}) \\times \\frac{(800\\,\\mathrm{nM})^2}{(1600\\,\\mathrm{nM})^2 + (800\\,\\mathrm{nM})^2}\n$$\n$$\n\\varepsilon_c = 16\\,\\mathrm{nM\\,min^{-1}} - 50\\,\\mathrm{nM\\,min^{-1}} \\times \\frac{800^2}{1600^2 + 800^2} = 16 - 50 \\times \\frac{1^2}{2^2 + 1^2}\n$$\n$$\n\\varepsilon_c = 16 - 50 \\times \\frac{1}{4+1} = 16 - 50 \\times \\frac{1}{5} = 16 - 10 = 6\\,\\mathrm{nM\\,min^{-1}}\n$$\n临界泄漏水平为 $\\varepsilon_c = 6\\,\\mathrm{nM\\,min^{-1}}$。问题要求将答案四舍五入到 4 位有效数字。",
            "answer": "$$\n\\boxed{6.000}\n$$"
        },
        {
            "introduction": "确定性模型描述的是平均行为，但忽略了分子相互作用中固有的随机性，而这种随机性在小细胞群体中至关重要。这个动手编程挑战将指导您实现Gillespie随机模拟算法（SSA），在单分子层面模拟一个群体感应系统。通过逐个模拟化学反应事件，您将能直接观察并量化细胞间的变异性，例如激活时间的分布，从而更深入地理解生物回路中的噪声。",
            "id": "3920231",
            "problem": "设计并实现一个基于 Gillespie 方法的随机模拟算法，用于合成生物学中的一个群体感应系统，该算法专注于一个小的细胞群体，这些细胞通过一个共享的酰基高丝氨酸内酯 (AHL) 池进行通信。目标是模拟群体中首次激活时间的分布，其中当一个细胞内与 AHL 结合的转录因子复合物数量达到一个阈值时，该细胞即被激活。您必须从第一性原理推导反应倾向，并实现模拟以计算激活时间分布的汇总统计数据。所有时间单位必须以秒表示。所有报告的分数必须表示为小数，而非百分号。\n\n从以下基本基础开始：\n- 化学主方程控制着充分混合系统中离散状态、连续时间马尔可夫过程的概率分布演化，并且是 Gillespie 随机模拟算法 (SSA) 的基础。\n- 在离散分子数空间中，结合和解离反应的倾向采用质量作用动力学。\n- Gillespie SSA 通过基于总倾向选择下一个反应和时间增量来生成精确的样本路径，无任何近似。\n\n模型定义：\n- 存在一个共享的胞外 AHL 池，在时间 $t$ 的分子数为 $M(t)$，假设其为充分混合状态。\n- 存在 $N$ 个细胞，索引为 $i \\in \\{1,2,\\dots,N\\}$，每个细胞表达固定总数的转录因子单体 (LuxR) $R_{\\mathrm{tot}}$，其中 $R_i(t)$ 表示游离单体，$X_i(t)$ 表示与 AHL 结合的活性复合物，对于每个 $i$ 均满足约束条件 $R_i(t) + X_i(t) = R_{\\mathrm{tot}}$。\n- 每个细胞都组成性地产生 AHL 并添加到共享池中。\n- 池中的 AHL 会自发降解。\n- 池中的 AHL 与细胞 $i$ 中的 $R_i$ 结合形成 $X_i$，并从池中消耗一个 AHL 分子。细胞 $i$ 中的 $X_i$ 解离会向池中释放一个 AHL 分子并恢复 $R_i$。\n- 细胞 $i$ 的激活发生在 $X_i(t)$ 首次达到或超过阈值 $H$ 的时间 $\\tau_i$，即 $\\tau_i = \\inf\\{t \\ge 0 \\mid X_i(t) \\ge H\\}$。如果一个细胞在时间 $T_{\\max}$ 前未激活，则定义 $\\tau_i = -1$。\n\n反应通道和倾向：\n- 所有细胞的 AHL 产生总量：$M \\to M+1$，倾向为 $a_{\\mathrm{prod}} = \\alpha N$，其中 $\\alpha$ 是每个细胞的产生速率，单位为 $\\mathrm{s}^{-1}$。\n- 池中 AHL 降解：$M \\to M-1$，倾向为 $a_{\\mathrm{deg}} = \\delta M$，其中 $\\delta$ 是每个分子的降解速率，单位为 $\\mathrm{s}^{-1}$。\n- 细胞 $i$ 中的结合反应：$R_i + M \\to X_i$，倾向为 $a_{\\mathrm{bind},i} = k_{\\mathrm{on}} R_i M$，其中 $k_{\\mathrm{on}}$ 是离散分子数的有效双分子速率，单位为 $\\mathrm{s}^{-1}$。\n- 细胞 $i$ 中的解离反应：$X_i \\to R_i + M$，倾向为 $a_{\\mathrm{unbind},i} = k_{\\mathrm{off}} X_i$，其中 $k_{\\mathrm{off}}$ 是解离速率，单位为 $\\mathrm{s}^{-1}$。\n\n初始条件和参数：\n- 在时间 $t=0$ 时，对所有 $i$ 设置 $M(0) = 0$，$X_i(0) = 0$ 和 $R_i(0) = R_{\\mathrm{tot}}$。\n- 模拟持续进行，直到所有细胞都记录了 $\\tau_i \\ge 0$，或直到 $t \\ge T_{\\max}$，或直到总倾向变为零。\n- 激活阈值 $H$ 是一个正整数。\n\n每个参数集的输出：\n- 已激活细胞的比例 $f = \\frac{\\#\\{i \\mid \\tau_i \\ge 0\\}}{N}$，以小数形式表示。\n- 在 $\\tau_i \\ge 0$ 的细胞子集上计算的平均激活时间 $\\bar{\\tau}$，单位为秒。如果没有细胞激活，则报告 $\\bar{\\tau} = -1.0$。\n- 在 $\\tau_i \\ge 0$ 的细胞子集上计算的激活时间标准差 $\\sigma_{\\tau}$，单位为秒，使用总体标准差。如果没有细胞激活，则报告 $\\sigma_{\\tau} = -1.0$。\n\n您的程序必须实现 Gillespie SSA，为每个参数集生成一次实现，并使用固定的随机数生成器种子以确保可复现性。对于每个参数集，计算并返回列表 $[f, \\bar{\\tau}, \\sigma_{\\tau}]$。\n\n测试套件：\n- 案例 1 (基线)：$N=50$, $\\alpha = 0.02\\,\\mathrm{s}^{-1}$, $\\delta = 0.001\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{on}} = 2\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{off}} = 0.05\\,\\mathrm{s}^{-1}$, $R_{\\mathrm{tot}} = 20$, $H=5$, $T_{\\max} = 3600\\,\\mathrm{s}$, 随机种子 $42$。\n- 案例 2 (无降解，更快积累)：$N=50$, $\\alpha = 0.05\\,\\mathrm{s}^{-1}$, $\\delta = 0.0\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{on}} = 2\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{off}} = 0.05\\,\\mathrm{s}^{-1}$, $R_{\\mathrm{tot}} = 20$, $H=5$, $T_{\\max} = 1800\\,\\mathrm{s}$, 随机种子 $43$。\n- 案例 3 (弱产生，强解离)：$N=10$, $\\alpha = 0.001\\,\\mathrm{s}^{-1}$, $\\delta = 0.002\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{on}} = 2\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{off}} = 0.2\\,\\mathrm{s}^{-1}$, $R_{\\mathrm{tot}} = 15$, $H=7$, $T_{\\max} = 3600\\,\\mathrm{s}$, 随机种子 $44$。\n- 案例 4 (单细胞边界)：$N=1$, $\\alpha = 0.02\\,\\mathrm{s}^{-1}$, $\\delta = 0.001\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{on}} = 5\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{off}} = 0.05\\,\\mathrm{s}^{-1}$, $R_{\\mathrm{tot}} = 25$, $H=10$, $T_{\\max} = 3600\\,\\mathrm{s}$, 随机种子 $45$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试案例的结果，格式为一个由方括号括起来的逗号分隔列表，其中每个元素是对应案例的 $[f, \\bar{\\tau}, \\sigma_{\\tau}]$ 的 Python 列表表示。例如，输出必须看起来像 $[[f_1,\\bar{\\tau}_1,\\sigma_{\\tau,1}],[f_2,\\bar{\\tau}_2,\\sigma_{\\tau,2}],[f_3,\\bar{\\tau}_3,\\sigma_{\\tau,3}],[f_4,\\bar{\\tau}_4,\\sigma_{\\tau,4}]]$，时间为秒的数值，分数为小数值。",
            "solution": "该问题要求设计并实现一个 Gillespie 随机模拟算法 (SSA) 来模拟一个合成群体感应系统。该系统由 $N$ 个细胞组成，它们通过共享的信号分子酰基高丝氨酸内酯 (AHL) 进行通信。目标是计算每个细胞首次激活时间的统计数据，其中激活被定义为细胞内 AHL-蛋白质复合物的浓度达到阈值 $H$。\n\n在进行求解之前，需要对问题陈述进行关键的验证。该模型基于化学主方程和质量作用动力学，这是系统生物学中此类问题的恰当且标准的理论基础。状态变量、初始条件和终止标准都已明确定义。该系统由胞外 AHL 的分子数 $M$ 和每个细胞 $i \\in \\{1,\\dots,N\\}$ 中与 AHL 结合的转录因子复合物的数量 $X_i$ 来描述。游离转录因子的数量 $R_i$ 受 $R_i = R_{\\mathrm{tot}} - X_i$ 约束。\n\n一个需要仔细考虑的点是双分子结合反应倾向的定义，$a_{\\mathrm{bind},i} = k_{\\mathrm{on}} R_i M$。根据标准的化学动力学，一个反应倾向的单位必须是时间的倒数，例如 $\\mathrm{s}^{-1}$。由于 $R_i$ 和 $M$ 是无量纲的分子数，速率常数 $k_{\\mathrm{on}}$ 在此上下文中必须具有 $(\\text{时间})^{-1}(\\text{数量})^{-1}$ 的单位，或 $\\mathrm{s}^{-1}(\\text{分子})^{-1}$。然而，问题陈述将 $k_{\\mathrm{on}}$ 的单位指定为 $\\mathrm{s}^{-1}$，这乍一看似乎存在量纲不一致的问题。这个问题可以通过将 $k_{\\mathrm{on}}$ 解释为并非传统的宏观速率常数，而是单个特定的 $R_i$ 单体和 $M$ 分子对在单位时间内的反应概率来解决。在这种解释下（这是随机动力学文献中一种有效但不太常见的表述），细胞 $i$ 的总倾向是每对反应物的速率 ($k_{\\mathrm{on}}$) 乘以可能的反应物对的总数 ($R_i M$)。这种解释使得模型在量纲上保持一致且在科学上是合理的。经过这一澄清，该问题被认为是有效的，可以推导出解决方案。\n\nGillespie 算法是一种精确的随机模拟方法，它能生成系统状态的统计上正确的轨迹。我们的系统状态可以用一个分子数向量表示：$\\mathbf{s} = (M, X_0, X_1, \\dots, X_{N-1})$，对 $N$ 个细胞使用从零开始的索引。模拟以离散的步骤进行，在每一步中，我们确定下一个反应将在*何时*发生以及它是*哪一个*反应。\n\n系统中有 $2+2N$ 个可能的反应通道：\n1. AHL 产生：$M \\to M+1$（所有细胞的一个聚合通道）\n2. AHL 降解：$M \\to M-1$（池的一个通道）\n3. 细胞 $i$ 中的结合反应：$R_i + M \\to X_i$（$N$ 个通道，每个细胞 $i=0,\\dots,N-1$ 一个）\n4. 细胞 $i$ 中的解离反应：$X_i \\to R_i + M$（$N$ 个通道，每个细胞 $i=0,\\dots,N-1$ 一个）\n\n这些反应的倾向代表了它们的瞬时速率，定义如下：\n-   产生：$a_{\\mathrm{prod}} = \\alpha N$\n-   降解：$a_{\\mathrm{deg}} = \\delta M$\n-   细胞 $i$ 中的结合反应：$a_{\\mathrm{bind},i} = k_{\\mathrm{on}} (R_{\\mathrm{tot}} - X_i) M$\n-   细胞 $i$ 中的解离反应：$a_{\\mathrm{unbind},i} = k_{\\mathrm{off}} X_i$\n\nGillespie SSA 的过程如下：\n1.  **初始化**：设置时间 $t=0$。根据问题初始化状态向量：$M(0)=0$，且对所有 $i=0, \\dots, N-1$，$X_i(0)=0$。初始化一个大小为 $N$ 的数组 $\\mathbf{\\tau}$，使用一个哨兵值（例如-1）来存储首次激活时间。\n\n2.  **模拟循环**：只要 $t  T_{\\max}$、并非所有细胞都已激活，且系统未达到没有更多反应可以发生的状态，循环就继续进行。\n    a. **计算倾向**：在当前状态 $(M, X_0, \\dots, X_{N-1})$ 下，计算每个反应通道的倾向。总共有 $2+2N$ 个倾向。\n    b. **总倾向**：计算所有倾向的总和，$A_{\\mathrm{tot}} = a_{\\mathrm{prod}} + a_{\\mathrm{deg}} + \\sum_{i=0}^{N-1} a_{\\mathrm{bind},i} + \\sum_{i=0}^{N-1} a_{\\mathrm{unbind},i}$。\n    c. **终止检查**：如果 $A_{\\mathrm{tot}} = 0$，则没有更多反应可以发生。模拟终止。\n    d. **下一反应时间**：生成一个随机数 $r_1 \\sim U(0,1)$。到下一个反应发生的时间 $\\Delta t$ 是从速率为 $A_{\\mathrm{tot}}$ 的指数分布中抽取的：\n        $$ \\Delta t = \\frac{1}{A_{\\mathrm{tot}}} \\ln\\left(\\frac{1}{r_1}\\right) $$\n    e. **选择下一反应**：生成第二个随机数 $r_2 \\sim U(0,1)$。下一个要发生的反应 $\\mu$ 的选择概率与其倾向 $a_\\mu$ 成正比。这通过找到满足 $\\sum_{j=1}^{\\mu} a_j > r_2 A_{\\mathrm{tot}}$ 的最小整数 $\\mu$ 来实现。\n    f. **更新时间和状态**：推进模拟时间 $t \\leftarrow t + \\Delta t$。如果 $t \\ge T_{\\max}$，终止模拟。否则，根据所选反应 $\\mu$ 的化学计量来更新状态向量。\n        - 如果是产生反应：$M \\leftarrow M+1$。\n        - 如果是降解反应：$M \\leftarrow M-1$。\n        - 如果是细胞 $i$ 中的结合反应：$M \\leftarrow M-1, X_i \\leftarrow X_i+1$。\n        - 如果是细胞 $i$ 中的解离反应：$M \\leftarrow M+1, X_i \\leftarrow X_i-1$。\n    g. **检查激活**：对于刚刚更新了状态的细胞 $i$（如果有的话），检查是否 $X_i \\geq H$。如果满足此条件且 $\\tau_i$ 仍为其初始哨兵值，则记录激活时间：$\\tau_i \\leftarrow t$。\n\n3.  **后处理**：在模拟循环终止后（由于时间限制、所有细胞激活或总倾向变为零），分析记录的激活时间 $\\mathbf{\\tau}$。\n    a. 设 $\\mathbf{\\tau}_{\\mathrm{act}}$ 为 $\\mathbf{\\tau}$ 中只包含正值的子集，对应于已激活的细胞。\n    b. 已激活细胞的比例是 $f = \\frac{\\text{length}(\\mathbf{\\tau}_{\\mathrm{act}})}{N}$。\n    c. 如果 $\\text{length}(\\mathbf{\\tau}_{\\mathrm{act}}) > 0$，则平均激活时间为 $\\bar{\\tau} = \\text{mean}(\\mathbf{\\tau}_{\\mathrm{act}})$，总体标准差为 $\\sigma_{\\tau} = \\text{std}(\\mathbf{\\tau}_{\\mathrm{act}})$。\n    d. 如果没有细胞激活，根据问题规定，$\\bar{\\tau} = -1.0$ 且 $\\sigma_{\\tau} = -1.0$。\n\n该实现将使用单个函数为给定的参数集和随机种子运行模拟，以确保可复现性。此函数将返回三元组 $[f, \\bar{\\tau}, \\sigma_{\\tau}]$。主程序将遍历所提供的测试案例，为每个案例执行模拟，并将收集到的结果格式化为指定的最终输出字符串。",
            "answer": "```python\nimport numpy as np\n\ndef gillespie_simulation(\n    N, alpha, delta, k_on, k_off, R_tot, H, T_max, seed\n):\n    \"\"\"\n    Performs a Gillespie SSA for the quorum sensing model.\n\n    Args:\n        N (int): Number of cells.\n        alpha (float): Per-cell AHL production rate (s^-1).\n        delta (float): AHL degradation rate per molecule (s^-1).\n        k_on (float): Effective bimolecular binding rate.\n        k_off (float): Unbinding rate (s^-1).\n        R_tot (int): Total number of transcription factor monomers per cell.\n        H (int): Activation threshold for X_i.\n        T_max (float): Maximum simulation time (s).\n        seed (int): Seed for the random number generator.\n\n    Returns:\n        list: A list containing [f, mean_tau, std_tau].\n    \"\"\"\n    rng = np.random.default_rng(seed)\n\n    # State variables\n    t = 0.0  # Time\n    M = 0    # Extracellular AHL molecule count\n    X = np.zeros(N, dtype=int)  # AHL-bound complex counts for each cell\n\n    # Activation times, initialized to -1\n    tau = np.full(N, -1.0)\n    num_activated = 0\n    \n    # Store indices of non-activated cells for efficiency\n    not_activated_indices = list(range(N))\n\n    # Pre-calculate what we can\n    propensity_prod = alpha * N\n    \n    # Total number of reaction channels: 1 (prod) + 1 (deg) + N (bind) + N (unbind)\n    num_reactions = 2 + 2 * N\n    propensities = np.zeros(num_reactions)\n\n    while t  T_max and num_activated  N:\n        # Calculate propensities\n        # 1. Production\n        propensities[0] = propensity_prod\n        # 2. Degradation\n        propensities[1] = delta * M\n        # 3. Binding for each cell i\n        R = R_tot - X\n        propensities[2 : 2 + N] = k_on * R * M\n        # 4. Unbinding for each cell i\n        propensities[2 + N : 2 + 2 * N] = k_off * X\n\n        # Total propensity\n        A_tot = np.sum(propensities)\n\n        if A_tot == 0:\n            break  # No more reactions can occur\n\n        # Time to next reaction\n        r1 = rng.random()\n        dt = (1 / A_tot) * np.log(1 / r1)\n\n        t += dt\n        if t >= T_max:\n            break\n\n        # Select next reaction\n        r2 = rng.random()\n        prop_cumsum = np.cumsum(propensities)\n        reaction_index = np.searchsorted(prop_cumsum, r2 * A_tot, side='right')\n        \n        # Update state\n        if reaction_index == 0:  # Production\n            M += 1\n        elif reaction_index == 1:  # Degradation\n            M -= 1\n        elif 2 = reaction_index  2 + N:  # Binding\n            cell_idx = reaction_index - 2\n            M -= 1\n            X[cell_idx] += 1\n            # Check for activation\n            if tau[cell_idx] == -1 and X[cell_idx] >= H:\n                tau[cell_idx] = t\n                num_activated += 1\n        elif 2 + N = reaction_index  2 + 2 * N:  # Unbinding\n            cell_idx = reaction_index - (2 + N)\n            M += 1\n            X[cell_idx] -= 1\n        else:\n            # This should not happen\n            raise RuntimeError(\"Invalid reaction index selected.\")\n\n    # Calculate summary statistics\n    activated_times = tau[tau >= 0]\n    \n    f = len(activated_times) / N\n\n    if len(activated_times) > 0:\n        mean_tau = np.mean(activated_times)\n        # Population standard deviation (ddof=0)\n        std_tau = np.std(activated_times, ddof=0)\n    else:\n        mean_tau = -1.0\n        std_tau = -1.0\n\n    return [f, mean_tau, std_tau]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (baseline)\n        (50, 0.02, 0.001, 2e-5, 0.05, 20, 5, 3600, 42),\n        # Case 2 (no degradation, faster accumulation)\n        (50, 0.05, 0.0, 2e-5, 0.05, 20, 5, 1800, 43),\n        # Case 3 (weak production, strong unbinding)\n        (10, 0.001, 0.002, 2e-5, 0.2, 15, 7, 3600, 44),\n        # Case 4 (single-cell boundary)\n        (1, 0.02, 0.001, 5e-5, 0.05, 25, 10, 3600, 45)\n    ]\n\n    results = []\n    for params in test_cases:\n        N, alpha, delta, k_on, k_off, R_tot, H, T_max, seed = params\n        result = gillespie_simulation(N, alpha, delta, k_on, k_off, R_tot, H, T_max, seed)\n        results.append(result)\n\n    # Format output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "细胞行为深受其空间组织和周围环境的影响。本练习将引导您从“充分混合”的假设转向空间模型，探索AHL浓度梯度如何在菌落内部形成。通过比较零通量（Neumann）和吸收（Dirichlet）这两种边界条件，您将揭示菌落边缘与环境的相互作用如何显著改变信号分布，并可能导致边缘激活等现象。",
            "id": "3920278",
            "problem": "一个单层细菌菌落被建模为占据 $x \\in [0,L]$ 的一维平板，其中 $x=0$ 位于菌落中心，$x=L$ 位于菌落-空气界面。细胞以体积速率 $s0$ 均匀产生酰基高丝氨酸内酯 (AHL)，AHL 以速率常数 $\\delta0$ 进行一级衰减。AHL 的扩散系数为 $D0$。稳态浓度分布 $a(x)$ 满足反应-扩散偏微分方程 (PDE)\n$$\n0 = D \\frac{d^2 a}{dx^2} - \\delta a + s,\n$$\n在菌落中心有一个对称条件，\n$$\n\\frac{da}{dx}\\bigg|_{x=0} = 0,\n$$\n并在菌落-空气界面处有两个可能的边界条件之一：\n- Neumann（零通量）：$\\frac{da}{dx}\\big|_{x=L} = 0$，\n- Dirichlet（吸收）：$a(L) = 0$。\n\n假设群体感应激活阈值为 $a_{\\text{th}}0$，并将外围激活定义为在 $x=L$ 处满足局部条件 $a(L) \\ge a_{\\text{th}}$。\n\n根据扩散、衰减和边界条件的第一性原理，判断下列哪些陈述是正确的。\n\nA. 在 $x=L$ 处采用零通量 Neumann 边界条件下，稳态 AHL 浓度 $a(x)$ 在空间上是均匀的，等于 $s/\\delta$，相对于在 $x=L$ 处采用吸收性 Dirichlet 边界条件，这增加了外围激活的可能性。\n\nB. 在 $x=L$ 处的吸收性 Dirichlet 边界条件迫使稳态时整个菌落的 $a(x)=0$，从而无论 $D, s, \\delta, L$ 为何值，都阻止了各处的激活。\n\nC. 在 $x=L$ 处的零通量 Neumann 边界条件必然产生一个非零的向外梯度 $\\frac{da}{dx}\\big|_{x=L}0$，从而降低了边缘相对于中心的浓度，并抑制了外围激活。\n\nD. 在 $x=L$ 处采用吸收性 Dirichlet 边界条件时，$a(x)$ 的最大值出现在外围 ($x=L$)，因此边缘细胞最先被激活。\n\nE. 如果 $a_{\\text{th}}0$ 且 $s0$，那么在 Neumann 边界条件下，外围激活准则 $a(L)\\ge a_{\\text{th}}$ 能被满足当且仅当 $s/\\delta \\ge a_{\\text{th}}$，而在 Dirichlet 边界条件下，$a(L)=0$，因此外围激活是不可能的。",
            "solution": "问题陈述提出了一个用于群体感应中信号分子——酰基高丝氨酸内酯 (AHL) 的稳态一维反应-扩散模型。在推导解决方案之前，我们必须首先验证问题的完整性。\n\n### 步骤 1：提取已知条件\n- **区域：** 一维平板，$x \\in [0,L]$。\n- **坐标：** $x=0$ 是菌落中心，$x=L$ 是菌落-空气界面。\n- **参数：**\n    - AHL 的体积生产速率：$s0$。\n    - AHL 的一级衰减速率常数：$\\delta0$。\n    - AHL 的扩散系数：$D0$。\n- **控制方程：** 稳态浓度分布 $a(x)$ 满足以下常微分方程 (ODE)：\n$$\n0 = D \\frac{d^2 a}{dx^2} - \\delta a + s\n$$\n- **边界条件：**\n    1.  中心对称性：$\\frac{da}{dx}\\bigg|_{x=0} = 0$。\n    2.  在界面 ($x=L$) 处，有两种可能的条件：\n        -   Neumann (零通量)：$\\frac{da}{dx}\\big|_{x=L} = 0$。\n        -   Dirichlet (吸收)：$a(L) = 0$。\n- **激活条件：**\n    - 群体感应激活阈值：$a_{\\text{th}}0$。\n    - 外围激活定义为条件 $a(L) \\ge a_{\\text{th}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题描述了一个标准的反应-扩散系统，这是数学生物学和化学工程中的一个基本模型。\n- **科学依据：** 该模型在科学上是合理的。稳态反应-扩散方程是描述一种被生产、降解和扩散的物质空间分布的公认原理。参数 $s, \\delta, D$ 具有明确的物理意义。\n- **适定性：** 该问题是适定的。它由一个二阶线性常微分方程和每种情况（Neumann 或 Dirichlet）下两个指定的边界条件（一个在 $x=0$ 处，一个在 $x=L$ 处）组成，这保证了唯一解的存在。\n- **客观性：** 该问题以精确、客观的数学语言陈述。\n- **缺陷清单：**\n    1.  **科学/事实不健全：** 无。该模型是一个有效且广泛使用的简化模型。\n    2.  **不可形式化/不相关：** 无。该问题可直接形式化且相关。\n    3.  **不完整/矛盾的设置：** 无。提供了解决该边值问题所需的所有必要组件。\n    4.  **不切实际/不可行：** 无。该模型是一种理想化，但没有违反物理定律。\n    5.  **不适定/结构不良：** 无。该问题是适定的。\n    6.  **伪深刻/琐碎/同义反复：** 无。该问题需要对二阶常微分方程的解进行正确的推导和分析。\n    7.  **超出科学可验证性：** 无。该模型在数学上是可验证的。\n\n### 步骤 3：结论与行动\n问题陈述是 **有效的**。我们继续推导解决方案。\n\n### 通解的推导\n控制常微分方程是：\n$$\nD \\frac{d^2 a}{dx^2} - \\delta a + s = 0\n$$\n整理各项，我们得到一个标准的非齐次二阶线性常微分方程：\n$$\n\\frac{d^2 a}{dx^2} - \\frac{\\delta}{D} a = -\\frac{s}{D}\n$$\n我们定义特征长度尺度 $\\ell = \\sqrt{D/\\delta}$。方程变为：\n$$\n\\frac{d^2 a}{dx^2} - \\frac{1}{\\ell^2} a = -\\frac{s}{D}\n$$\n通解 $a(x)$ 是一个特解 $a_p(x)$ 和齐次解 $a_h(x)$ 的和。\n\n可以通过观察找到一个特解。假设一个常数解 $a_p(x) = C$：\n$$\n0 - \\frac{1}{\\ell^2} C = -\\frac{s}{D} \\implies C = \\frac{s\\ell^2}{D} = \\frac{s(D/\\delta)}{D} = \\frac{s}{\\delta}\n$$\n因此，$a_p(x) = s/\\delta$。\n\n齐次方程是 $\\frac{d^2 a_h}{dx^2} - \\frac{1}{\\ell^2} a_h = 0$。其特征方程为 $r^2 - 1/\\ell^2 = 0$，根为 $r = \\pm 1/\\ell$。齐次解通常写为 $a_h(x) = C_1 e^{x/\\ell} + C_2 e^{-x/\\ell}$。对于关于 $x=0$ 对称的问题，使用双曲函数更方便：\n$$\na_h(x) = A \\cosh(x/\\ell) + B \\sinh(x/\\ell)\n$$\n通解是：\n$$\na(x) = A \\cosh(x/\\ell) + B \\sinh(x/\\ell) + \\frac{s}{\\delta}\n$$\n现在，我们应用边界条件。中心的对称条件 $\\frac{da}{dx}\\big|_{x=0} = 0$ 适用于两种情况。首先，我们求导数：\n$$\n\\frac{da}{dx} = \\frac{A}{\\ell} \\sinh(x/\\ell) + \\frac{B}{\\ell} \\cosh(x/\\ell)\n$$\n在 $x=0$ 处：\n$$\n\\frac{da}{dx}\\bigg|_{x=0} = \\frac{A}{\\ell} \\sinh(0) + \\frac{B}{\\ell} \\cosh(0) = \\frac{A}{\\ell}(0) + \\frac{B}{\\ell}(1) = \\frac{B}{\\ell}\n$$\n由于 $\\frac{B}{\\ell} = 0$ 且 $\\ell \\neq 0$，我们必须有 $B=0$。两种情况的解形式简化为：\n$$\na(x) = A \\cosh(x/\\ell) + \\frac{s}{\\delta}\n$$\n\n### 情况 1：在 $x=L$ 处的 Neumann (零通量) 边界\n边界条件是 $\\frac{da}{dx}\\big|_{x=L} = 0$。当 $B=0$ 时，导数为 $\\frac{da}{dx} = \\frac{A}{\\ell} \\sinh(x/\\ell)$。\n$$\n\\frac{da}{dx}\\bigg|_{x=L} = \\frac{A}{\\ell} \\sinh(L/\\ell) = 0\n$$\n由于 $L0$ 且 $\\ell0$，所以 $L/\\ell  0$，这意味着 $\\sinh(L/\\ell) \\neq 0$。因此，常数 $A$ 必须为零。\n当 $A=0$ 时，Neumann 情况的解是：\n$$\na(x) = \\frac{s}{\\delta}\n$$\n浓度在整个菌落中是恒定的。\n\n### 情况 2：在 $x=L$ 处的 Dirichlet (吸收) 边界\n边界条件是 $a(L) = 0$。将其应用于简化的通解：\n$$\na(L) = A \\cosh(L/\\ell) + \\frac{s}{\\delta} = 0\n$$\n解出 $A$：\n$$\nA = -\\frac{s/\\delta}{\\cosh(L/\\ell)}\n$$\n将 $A$ 代回解中，我们得到：\n$$\na(x) = \\frac{s}{\\delta} - \\frac{s/\\delta}{\\cosh(L/\\ell)} \\cosh(x/\\ell) = \\frac{s}{\\delta} \\left( 1 - \\frac{\\cosh(x/\\ell)}{\\cosh(L/\\ell)} \\right)\n$$\n这是 Dirichlet 情况下的浓度分布。\n\n### 逐项分析\n\n**A. 在 $x=L$ 处采用零通量 Neumann 边界条件下，稳态 AHL 浓度 $a(x)$ 在空间上是均匀的，等于 $s/\\delta$，相对于在 $x=L$ 处采用吸收性 Dirichlet 边界条件，这增加了外围激活的可能性。**\n- 我们对 Neumann 情况的推导得出 $a(x) = s/\\delta$，这是空间均匀的。这部分是正确的。\n- 对于外围激活，我们检查条件 $a(L) \\ge a_{\\text{th}}$。\n  - 在 Neumann 情况下：$a(L) = s/\\delta$。如果 $s/\\delta \\ge a_{\\text{th}}$，则发生激活。\n  - 在 Dirichlet 情况下：根据定义 $a(L) = 0$。激活需要 $0 \\ge a_{\\text{th}}$。由于已知 $a_{\\text{th}}  0$，这是不可能的。\n- Neumann 边界允许外围激活（如果 $s/\\delta$ 足够大），而 Dirichlet 边界使其不可能。因此，Neumann 边界增加了外围激活的可能性。\n- **结论：正确。**\n\n**B. 在 $x=L$ 处的吸收性 Dirichlet 边界条件迫使稳态时整个菌落的 $a(x)=0$，从而无论 $D, s, \\delta, L$ 为何值，都阻止了各处的激活。**\n- Dirichlet 情况的解是 $a(x) = \\frac{s}{\\delta} \\left( 1 - \\frac{\\cosh(x/\\ell)}{\\cosh(L/\\ell)} \\right)$。\n- 这不恒等于零。例如，在中心 ($x=0$) 处，$a(0) = \\frac{s}{\\delta} \\left( 1 - \\frac{1}{\\cosh(L/\\ell)} \\right)$。由于 $L0$ 且 $\\ell0$，所以 $\\cosh(L/\\ell)1$，因此 $a(0)0$。\n- 关于 $a(x)$ 在整个菌落中为零的说法是错误的。\n- **结论：不正确。**\n\n**C. 在 $x=L$ 处的零通量 Neumann 边界条件必然产生一个非零的向外梯度 $\\frac{da}{dx}\\big|_{x=L}0$，从而降低了边缘相对于中心的浓度，并抑制了外围激活。**\n- Neumann 边界条件明确定义为`零通量`：$\\frac{da}{dx}\\big|_{x=L} = 0$。\n- 该陈述直接与问题定义相矛盾。我们推导出的解 $a(x) = s/\\delta$ 的梯度处处为零。\n- **结论：不正确。**\n\n**D. 在 $x=L$ 处采用吸收性 Dirichlet 边界条件时，$a(x)$ 的最大值出现在外围 ($x=L$)，因此边缘细胞最先被激活。**\n- 解为 $a(x) = \\frac{s}{\\delta} \\left( 1 - \\frac{\\cosh(x/\\ell)}{\\cosh(L/\\ell)} \\right)$。其导数为 $\\frac{da}{dx} = -\\frac{s}{\\delta\\ell} \\frac{\\sinh(x/\\ell)}{\\cosh(L/\\ell)}$。\n- 对于 $x \\in (0, L]$，右侧的所有项（$s, \\delta, \\ell, \\sinh(x/\\ell), \\cosh(L/\\ell)$）都为正。因此，$\\frac{da}{dx}  0$。\n- 负导数意味着函数 $a(x)$ 在区间 $[0, L]$ 上是严格递减的。\n- 最大浓度出现在 $x=0$（中心），最小浓度出现在 $x=L$（外围），其中 $a(L)=0$。\n- 因此，该陈述是错误的。\n- **结论：不正确。**\n\n**E. 如果 $a_{\\text{th}}0$ 且 $s0$，那么在 Neumann 边界条件下，外围激活准则 $a(L)\\ge a_{\\text{th}}$ 能被满足当且仅当 $s/\\delta \\ge a_{\\text{th}}$，而在 Dirichlet 边界条件下，$a(L)=0$，因此外围激活是不可能的。**\n- 在 Neumann 情况下，我们发现 $a(L) = s/\\delta$。因此，外围激活条件 $a(L) \\ge a_{\\text{th}}$ 变为 $s/\\delta \\ge a_{\\text{th}}$。这是正确的。\n- 在 Dirichlet 情况下，边界条件本身就是 $a(L) = 0$。由于题目规定 $a_{\\text{th}}  0$，激活条件 $0 \\ge a_{\\text{th}}$ 永远无法满足。因此，外围激活是不可能的。\n- 该陈述的两个部分都是正确的。\n- **结论：正确。**\n\n### 最终结论\n根据以上分析，陈述 A 和 E 是正确的。陈述 B、C 和 D 是不正确的。因此，正确答案组合是 AE。",
            "answer": "$$\\boxed{AE}$$"
        }
    ]
}