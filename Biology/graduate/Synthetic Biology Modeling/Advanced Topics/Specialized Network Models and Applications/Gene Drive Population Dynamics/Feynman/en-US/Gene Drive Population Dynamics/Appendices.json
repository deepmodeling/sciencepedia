{
    "hands_on_practices": [
        {
            "introduction": "Before we can model the fate of a gene drive in an entire population, we must first master its mechanism of action at the most fundamental level: inheritance. This exercise tasks you with translating the biological rules of a CRISPR-based homing drive—including the probabilities of successful homing and the formation of resistance alleles—into the expected genotype frequencies in the offspring of a single cross. Mastering this foundational calculation  is the essential first step for building robust, mechanistic models of population-wide dynamics.",
            "id": "3914128",
            "problem": "Consider a homing gene drive implemented using Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) and CRISPR-associated protein $9$ (Cas$9$) targeting a single-locus allele. Let the wild-type allele be denoted by $W$, the drive allele by $D$, and a resistant allele that is not cut by Cas$9$ by $R$. Assume the following foundational rules, which are widely used in population genetic models of homing gene drives:\n- In a heterozygous germline carrying genotype $WD$, the wild-type allele $W$ is cut with probability $h$ (the homing efficiency).\n- Conditional on a cut occurring, repair is by homology-directed repair with probability $1-r$, converting $W$ to $D$, or by non-homologous end joining with probability $r$, converting $W$ to $R$.\n- If no cut occurs, the $W$ allele remains $W$.\n- Gametes from a $WW$ individual carry only the $W$ allele.\n- There is random union of gametes, no embryonic deposition effects, no fitness differences among genotypes, and no viability selection; inheritance is otherwise Mendelian.\n\nStarting from these mechanistic rules and basic Mendelian segregation, derive the offspring zygote genotype frequency distribution produced by a mating between one $WD$ parent and one $WW$ parent under random mating. Use $h=0.9$ and $r=0.05$. Report the offspring genotype frequencies in the ordered vector (WW, WD, WR, DD, DR, RR). No rounding is required; present exact values. The answer must be a single row matrix containing the six genotype frequencies in the specified order.",
            "solution": "The problem statement has been rigorously validated and found to be scientifically grounded, well-posed, objective, and internally consistent. It presents a standard, simplified model of CRISPR-based homing gene drive inheritance, providing all necessary parameters and rules to derive a unique solution. Therefore, the problem is deemed valid and a full solution follows.\n\nThe objective is to determine the genotype frequency distribution of offspring from a cross between a heterozygous drive-carrying individual ($WD$) and a wild-type individual ($WW$). This requires a two-step process: first, calculating the frequencies of gametes produced by each parent, and second, determining the frequencies of zygotic genotypes resulting from the random union of these gametes.\n\n**Step 1: Gamete Frequencies**\n\n**Parent 1: Wild-type ($WW$)**\nAn individual with genotype $WW$ is homozygous for the wild-type allele $W$. By the principles of Mendelian segregation, this parent can only produce gametes carrying the $W$ allele.\n- Frequency of $W$ gametes from the $WW$ parent: $P_{WW}(W) = 1$.\n- Frequency of $D$ gametes from the $WW$ parent: $P_{WW}(D) = 0$.\n- Frequency of $R$ gametes from the $WW$ parent: $P_{WW}(R) = 0$.\n\n**Parent 2: Heterozygous Drive-carrier ($WD$)**\nAn individual with genotype $WD$ carries one wild-type allele ($W$) and one drive allele ($D$). In the germline of this individual, the drive mechanism actively attempts to convert the $W$ allele. We must analyze the fate of the two chromosomes to determine the final gamete proportions.\n\nUnder standard Mendelian inheritance, half of the gametes would receive the $W$ allele and half would receive the $D$ allele. The gene drive process modifies the gametes that would have received the $W$ allele.\n\nLet's consider the fate of the chromosome carrying the $W$ allele:\n- With probability $1-h$, no cut occurs, and the allele remains $W$.\n- With probability $h$, the allele is cut by the Cas$9$ nuclease.\n  - Conditional on a cut, repair occurs via homology-directed repair (HDR) with probability $1-r$, converting the $W$ allele into a $D$ allele. The total probability for this path is $h(1-r)$.\n  - Conditional on a cut, repair occurs via non-homologous end joining (NHEJ) with probability $r$, converting the $W$ allele into a resistant allele $R$. The total probability for this path is $hr$.\n\nThe chromosome originally carrying the $D$ allele is not targeted by the drive and is passed on unchanged.\n\nTherefore, we can calculate the final frequencies of gametes produced by the $WD$ parent:\n- **Frequency of $W$ gametes, $P_{WD}(W)$:** These arise only from the $W$-carrying chromosome when no homing occurs. This portion constitutes half of the total gametes.\n$$P_{WD}(W) = \\frac{1}{2}(1 - h)$$\n- **Frequency of $R$ gametes, $P_{WD}(R)$:** These arise only from the $W$-carrying chromosome when a cut is followed by NHEJ.\n$$P_{WD}(R) = \\frac{1}{2}hr$$\n- **Frequency of $D$ gametes, $P_{WD}(D)$:** These arise from two sources: (1) the original $D$-carrying chromosome, which constitutes half of the gametes, and (2) the $W$-carrying chromosome when a cut is followed by HDR.\n$$P_{WD}(D) = \\frac{1}{2} + \\frac{1}{2}h(1-r)$$\n\nAs a verification, the sum of these probabilities must be $1$:\n$$P_{WD}(W) + P_{WD}(D) + P_{WD}(R) = \\frac{1}{2}(1-h) + \\left(\\frac{1}{2} + \\frac{1}{2}h(1-r)\\right) + \\frac{1}{2}hr$$\n$$= \\frac{1}{2} - \\frac{h}{2} + \\frac{1}{2} + \\frac{h}{2} - \\frac{hr}{2} + \\frac{hr}{2} = 1$$\nThe frequencies sum to $1$ as required.\n\n**Step 2: Offspring Zygote Genotype Frequencies**\n\nThe offspring genotypes are formed by the random union of a gamete from the $WW$ parent and a gamete from the $WD$ parent. Since the $WW$ parent only produces $W$ gametes (with frequency $1$), the offspring genotype is determined solely by the allele carried by the gamete from the $WD$ parent.\n\n- **Frequency of $WW$ offspring, $f(WW)$:** A $W$ gamete from the $WW$ parent fertilizes a $W$ gamete from the $WD$ parent.\n$$f(WW) = P_{WW}(W) \\times P_{WD}(W) = 1 \\times \\frac{1}{2}(1-h) = \\frac{1}{2}(1-h)$$\n- **Frequency of $WD$ offspring, $f(WD)$:** A $W$ gamete from the $WW$ parent fertilizes a $D$ gamete from the $WD$ parent.\n$$f(WD) = P_{WW}(W) \\times P_{WD}(D) = 1 \\times \\left(\\frac{1}{2} + \\frac{1}{2}h(1-r)\\right) = \\frac{1}{2} + \\frac{1}{2}h(1-r)$$\n- **Frequency of $WR$ offspring, $f(WR)$:** A $W$ gamete from the $WW$ parent fertilizes an $R$ gamete from the $WD$ parent.\n$$f(WR) = P_{WW}(W) \\times P_{WD}(R) = 1 \\times \\frac{1}{2}hr = \\frac{1}{2}hr$$\n- **Frequencies of $DD$, $DR$, and $RR$ offspring:** These genotypes require a $D$ or $R$ allele from the $WW$ parent. Since the $WW$ parent cannot produce such gametes, the frequencies of these genotypes are zero.\n$$f(DD) = 0$$\n$$f(DR) = 0$$\n$$f(RR) = 0$$\n\n**Step 3: Numerical Calculation**\n\nThe problem provides the specific parameter values $h = 0.9$ and $r = 0.05$. We substitute these into the derived formulas.\n\n- $f(WW) = \\frac{1}{2}(1 - 0.9) = \\frac{1}{2}(0.1) = 0.05$\n- $f(WD) = \\frac{1}{2} + \\frac{1}{2}(0.9)(1 - 0.05) = 0.5 + 0.5(0.9)(0.95) = 0.5 + 0.45(0.95) = 0.5 + 0.4275 = 0.9275$\n- $f(WR) = \\frac{1}{2}(0.9)(0.05) = 0.5(0.045) = 0.0225$\n- $f(DD) = 0$\n- $f(DR) = 0$\n- $f(RR) = 0$\n\nThe sum of the offspring frequencies is $0.05 + 0.9275 + 0.0225 + 0 + 0 + 0 = 1.0$, which confirms the calculations.\n\nThe final result is the ordered vector of genotype frequencies $(f(WW),\\, f(WD),\\, f(WR),\\, f(DD),\\, f(DR),\\, f(RR))$.\nThe vector is $(0.05,\\, 0.9275,\\, 0.0225,\\, 0,\\, 0,\\, 0)$.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 0.05 & 0.9275 & 0.0225 & 0 & 0 & 0 \\end{pmatrix}} $$"
        },
        {
            "introduction": "A gene drive's ability to spread is not guaranteed; it must overcome any fitness costs it imposes on its host. This practice challenges you to derive the \"invasion threshold,\" a critical concept in population genetics that defines the conditions required for a new allele to increase in frequency when rare. By applying linear stability analysis to a homing drive system , you will determine the minimum homing efficiency needed to successfully invade a wild-type population, providing a powerful insight into the balance between drive strength and selective disadvantage.",
            "id": "3914106",
            "problem": "Consider a large, randomly mating diploid population with two alleles at a single locus: a gene drive allele $D$ and a wild-type allele $W$. Assume discrete, non-overlapping generations and Hardy–Weinberg equilibrium (HWE) at the start of each generation. The gene drive is of the homing type: in a $D/W$ heterozygote, during gametogenesis, the wild-type allele is cut and repaired by homology-directed repair with probability $h$ per gamete, resulting in a gamete that carries $D$ instead of $W$. There is no formation of resistant alleles, so the resistance rate is $r=0$. Viability selection acts before reproduction: $W/W$ individuals have viability $1$, and $D/W$ heterozygotes have viability reduced by a selection coefficient $s$, so their viability is $1-s$. You may assume that $D/D$ homozygotes are sufficiently rare when $D$ is rare that their contribution is negligible for the invasion analysis.\n\nLet $p_t$ denote the frequency of allele $D$ among adults at generation $t$, and consider the invasion-from-rare condition, i.e., the behavior of $p_{t+1}$ when $p_t$ is close to zero. Derive, from first principles starting at HWE and the definitions given above, the minimal homing efficiency $h_{\\min}$ required for the allele $D$ to increase when rare. Express your final answer as a single closed-form analytical expression in terms of $s$. No rounding is required, and no units are needed.",
            "solution": "The user wants me to solve the problem described in the prompt.\n\n### Step 1: Extract Givens\n- Population: Large, randomly mating, diploid.\n- Generations: Discrete, non-overlapping.\n- Alleles: Gene drive allele ($D$) and wild-type allele ($W$).\n- Initial state: Hardy–Weinberg equilibrium (HWE) at the start of each generation.\n- Gene drive: Homing type.\n- Homing efficiency: $h$. A wild-type allele in a $D/W$ heterozygote is converted to a $D$ allele with probability $h$ per gamete.\n- Resistance rate: $r=0$.\n- Viability selection:\n  - $W/W$ viability is $1$.\n  - $D/W$ viability is $1-s$.\n  - $D/D$ homozygote contribution is negligible for invasion analysis.\n- Notation: $p_t$ is the frequency of allele $D$ in adults at generation $t$.\n- Objective: Derive the minimal homing efficiency $h_{\\min}$ for allele $D$ to increase when rare, expressed in terms of $s$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes a standard, simplified model of a homing-based gene drive, a well-established concept in population genetics and synthetic biology. The assumptions of discrete generations, random mating, and HWE are common and valid for creating a baseline mathematical model. The model is scientifically sound.\n- **Well-Posed:** The problem is well-posed. It provides all necessary parameters ($s$, $h$) and a clear objective (find $h_{\\min}$ for invasion). The condition \"increase when rare\" is a standard criterion in stability analysis, leading to a unique threshold.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased language.\n- **Flaw Checklist:**\n  1. **Scientific/Factual Unsoundness:** None. The model is a valid simplification used in the field.\n  2. **Non-Formalizable/Irrelevant:** None. The problem is a classic example of population genetics modeling and is directly relevant to *gene drive population dynamics*.\n  3. **Incomplete/Contradictory:** None. The problem is self-contained. The instruction to neglect $D/D$ homozygotes is a standard and necessary simplification for an invasion-from-rare analysis (linear stability analysis), not a contradiction.\n  4. **Unrealistic/Infeasible:** None. The parameters are symbolic. The model represents a plausible biological trade-off.\n  5. **Ill-Posed/Poorly Structured:** None. The problem structure is clear and leads to a unique, meaningful solution.\n  6. **Pseudo-Profound/Trivial:** None. The derivation requires a careful, step-by-step application of population genetics principles and is not trivial.\n  7. **Outside Scientific Verifiability:** None. The model is mathematical and its predictions are verifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the solution.\n\nThe derivation of the minimal homing efficiency, $h_{\\min}$, requires establishing the recurrence relation for the frequency of the drive allele, $p_t$, and then analyzing the condition for this allele to increase in frequency when it is rare (i.e., when $p_t \\to 0$).\n\nLet $p_t$ be the frequency of the drive allele $D$ and $q_t = 1 - p_t$ be the frequency of the wild-type allele $W$ among adults in generation $t$.\n\n1.  **Zygote Formation:** Assuming random mating, the frequencies of the three genotypes ($D/D$, $D/W$, $W/W$) in the zygotes of the next generation, $t+1$, are given by the Hardy-Weinberg proportions:\n    -   $f_{D/D, \\text{zygote}} = p_t^2$\n    -   $f_{D/W, \\text{zygote}} = 2p_t q_t = 2p_t(1-p_t)$\n    -   $f_{W/W, \\text{zygote}} = q_t^2 = (1-p_t)^2$\n\n2.  **Viability Selection:** Viability selection acts on these zygotes. The relative viabilities are $w_{D/D}$ (unspecified, but its contribution is negligible), $w_{D/W} = 1-s$, and $w_{W/W} = 1$. The proportions of genotypes surviving to adulthood are:\n    -   $D/D$: $p_t^2 w_{D/D}$\n    -   $D/W$: $2p_t(1-p_t)(1-s)$\n    -   $W/W$: $(1-p_t)^2(1)$\n    The problem states we can neglect the contribution of $D/D$ homozygotes for an invasion analysis, which corresponds to analyzing the dynamics as $p_t \\to 0$. In this limit, the frequency of $D/D$ individuals, $p_t^2$, is of a lower order than the frequency of $D/W$ individuals, $2p_t(1-p_t) \\approx 2p_t$, and can be ignored.\n\n3.  **Adult Frequencies & Mean Fitness:** The mean fitness of the population, $\\bar{w}$, is the sum of the frequencies of surviving genotypes. For small $p_t$, we have:\n    $$ \\bar{w} = (1-p_t)^2 + 2p_t(1-p_t)(1-s) $$\n    The frequencies of the genotypes among the adult survivors who will reproduce are obtained by normalizing by $\\bar{w}$:\n    -   $f'_{D/W} = \\frac{2p_t(1-p_t)(1-s)}{\\bar{w}}$\n    -   $f'_{W/W} = \\frac{(1-p_t)^2}{\\bar{w}}$\n\n4.  **Gamete Production with Gene Drive:** These adults produce gametes.\n    -   $W/W$ adults produce only $W$ gametes.\n    -   In a $D/W$ heterozygote, the allele $D$ is inherited with a baseline probability of $\\frac{1}{2}$. The homing mechanism converts a fraction $h$ of the gametes that would have carried $W$ into $D$ gametes. Therefore, the proportion of $D$ gametes produced by a $D/W$ individual is $\\frac{1}{2} + h \\cdot \\frac{1}{2} = \\frac{1}{2}(1+h)$.\n\n5.  **Allele Frequency in the Next Generation:** The frequency of the $D$ allele in the next generation, $p_{t+1}$, is the frequency of $D$ gametes in the total gamete pool. This is found by summing the contributions from each adult genotype:\n    $$ p_{t+1} = \\underbrace{(0) \\cdot f'_{W/W}}_{\\text{from } W/W} + \\underbrace{\\left(\\frac{1}{2}(1+h)\\right) \\cdot f'_{D/W}}_{\\text{from } D/W} $$\n    We again neglect the $D/D$ contribution. Substituting the expression for $f'_{D/W}$:\n    $$ p_{t+1} = \\frac{1}{2}(1+h) \\frac{2p_t(1-p_t)(1-s)}{\\bar{w}} $$\n    $$ p_{t+1} = \\frac{p_t(1-p_t)(1+h)(1-s)}{(1-p_t)^2 + 2p_t(1-p_t)(1-s)} $$\n    This equation, $p_{t+1} = F(p_t)$, defines the change in allele frequency from one generation to the next.\n\n6.  **Invasion Analysis:** The allele $D$ will increase in frequency when rare if the initial growth rate is greater than $1$. This is determined by the derivative of the recurrence relation $F(p_t)$ evaluated at the extinction fixed point, $p_t=0$. The condition for invasion is $F'(0) > 1$.\n    To find $F'(0)$, we can use the quotient rule $F'(p_t) = \\frac{N'(p_t)D(p_t) - N(p_t)D'(p_t)}{[D(p_t)]^2}$, where $N(p_t)$ is the numerator and $D(p_t)$ is the denominator of $F(p_t)$.\n    Let's evaluate the components at $p_t=0$:\n    -   $N(p_t) = p_t(1-p_t)(1+h)(1-s) \\implies N(0) = 0$.\n    -   $N'(p_t) = (1-2p_t)(1+h)(1-s) \\implies N'(0) = (1+h)(1-s)$.\n    -   $D(p_t) = (1-p_t)^2 + 2p_t(1-p_t)(1-s) \\implies D(0) = (1-0)^2 = 1$.\n    -   Since $N(0)=0$, we do not need to compute $D'(0)$.\n\n    Substituting these into the formula for the derivative at $p_t=0$:\n    $$ F'(0) = \\frac{N'(0)D(0) - N(0)D'(0)}{[D(0)]^2} = \\frac{((1+h)(1-s)) \\cdot 1 - 0 \\cdot D'(0)}{1^2} = (1+h)(1-s) $$\n    The invasion condition is therefore:\n    $$ (1+h)(1-s) > 1 $$\n\n7.  **Minimal Homing Efficiency:** The minimal homing efficiency required for invasion, $h_{\\min}$, is the value of $h$ that satisfies the boundary condition where the growth rate is exactly $1$:\n    $$ (1+h_{\\min})(1-s) = 1 $$\n    Solving for $h_{\\min}$:\n    $$ 1 + h_{\\min} = \\frac{1}{1-s} $$\n    $$ h_{\\min} = \\frac{1}{1-s} - 1 $$\n    To obtain a single fraction, we find a common denominator:\n    $$ h_{\\min} = \\frac{1 - (1-s)}{1-s} = \\frac{1-1+s}{1-s} = \\frac{s}{1-s} $$\n    This expression gives the minimum homing efficiency required to overcome the fitness cost $s$ of the heterozygote and allow the gene drive to spread in the population when initially rare.",
            "answer": "$$ \\boxed{\\frac{s}{1-s}} $$"
        },
        {
            "introduction": "The ultimate impact of a gene drive often depends on the complex interplay between genetic changes and ecological responses. This final practice moves beyond purely genetic models to explore these eco-genetic feedback loops through computational simulation . You will develop and implement a coupled model that combines drive dynamics with population regulation, including a critical Allee effect, to investigate whether a drive designed for population suppression can succeed or if it leads to unintended transient dynamics.",
            "id": "3914103",
            "problem": "You are tasked with modeling the transient dynamics of a diploid population subject to a homing gene drive (HGD) with distorted transmission and viability costs, under density dependence with an Allee effect. Let the population size at discrete generation $t$ be $N(t)$ and the drive allele frequency among adults be $p(t)$. Immediately after a release at generation $t = 0$, the adult drive allele frequency is $p(0) = p_0$ and adult population size is $N(0) = N_0$. Assume random mating, Hardy–Weinberg (HW) genotype proportions among zygotes, and genotype-specific viability selection only. In the HGD, heterozygotes experience germline homing that increases the transmission of the drive allele with homing probability $c$, and there is no resistance allele formation. Assume the wild-type genotype has viability fitness $w_{WW} = 1$, the heterozygote has viability fitness $w_{WD} = 1 - s_H$, and the drive homozygote has viability fitness $w_{DD} = 1 - s_D$, where $s_H$ and $s_D$ are nonnegative costs. The ecological dynamics include an Allee threshold $A$ such that below $A$, per capita growth is negative. For density dependence, assume carrying capacity $K$ and an intrinsic scale $r$ for per capita growth. Time is measured in discrete generations.\n\nStarting from the above well-tested bases in population genetics (Mendelian segregation, HW, random mating, and genotype-specific viability selection) and population ecology (density-dependent growth and Allee effects), derive, from first principles, the coupled discrete-time recursions for $N(t+1)$ and $p(t+1)$ in terms of $N(t)$, $p(t)$, and parameters $(K, A, r, c, s_H, s_D)$. Your derivation must:\n- Express the gamete pool drive allele fraction produced by adults under homing transmission distortion,\n- Construct zygote genotype proportions under HW given the gamete allele fraction,\n- Apply viability selection to obtain adult genotype proportions,\n- Compute the adult drive allele frequency $p(t+1)$ from the post-selection genotype proportions,\n- Couple the ecological recursion for $N(t+1)$ to the average viability experienced by zygotes to adults and the Allee-modified density dependence.\n\nThen implement a program that, given a small test suite of parameter sets, simulates $T$ generations starting from $(N(0), p(0))$, computes the entire transient trajectory $\\{N(t), p(t)\\}$, and returns, for each test case, a boolean indicating whether the population size ever falls strictly below the Allee threshold $A$ at any generation $t \\in \\{0, 1, \\dots, T\\}$.\n\nUse the following scientifically plausible test suite of $5$ parameter sets, each specified as a tuple $(N_0, p_0, K, A, r, c, s_H, s_D, T)$ with all parameters dimensionless and time in generations:\n- Case $1$: $(N_0 = 5000, p_0 = 0.10, K = 10000, A = 500, r = 0.80, c = 0.80, s_H = 0.05, s_D = 0.10, T = 200)$,\n- Case $2$: $(N_0 = 800, p_0 = 0.20, K = 10000, A = 1000, r = 1.00, c = 0.95, s_H = 0.30, s_D = 0.60, T = 200)$,\n- Case $3$: $(N_0 = 1000, p_0 = 0.10, K = 10000, A = 1000, r = 0.80, c = 0.90, s_H = 0.10, s_D = 0.30, T = 200)$,\n- Case $4$: $(N_0 = 8000, p_0 = 0.20, K = 10000, A = 1000, r = 0.80, c = 0.00, s_H = 0.20, s_D = 0.40, T = 200)$,\n- Case $5$: $(N_0 = 3000, p_0 = 0.30, K = 5000, A = 500, r = 2.00, c = 0.70, s_H = 0.10, s_D = 0.20, T = 200)$.\n\nFor numerical stability, in your simulation you must ensure $N(t) \\ge 0$ and $p(t) \\in [0, 1]$ at all times (clip if necessary). If the ecological recursion produces a negative intermediate population, treat the next population as $0$. Angle units are not applicable. No physical units are used. Percentages must be represented as decimals in $[0,1]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots]$), where each $result_i$ is a boolean corresponding to the $i$-th test case.",
            "solution": "The problem is valid as it is scientifically grounded in established models of population genetics and ecology, is well-posed, objective, and contains all necessary information to derive and implement a solution.\n\nThe task is to derive the coupled discrete-time recurrence relations for population size $N(t)$ and gene drive allele frequency $p(t)$ and then to simulate these dynamics for a given set of parameters.\n\n### Derivation of the Recurrence Relations\n\nWe begin from first principles, following the life cycle of a diploid, randomly mating population. Let $W$ be the wild-type allele and $D$ be the homing gene drive allele.\n\n**1. Genetic Dynamics: From Adults to Gametes to New Adults**\n\nLet $p(t)$ be the frequency of the $D$ allele in the adult population at generation $t$. Assuming the adult population is in Hardy-Weinberg (HW) equilibrium, the genotype frequencies for wild-type homozygotes ($WW$), heterozygotes ($WD$), and drive homozygotes ($DD$) are:\n$$f_{WW}(t) = (1-p(t))^2$$\n$$f_{WD}(t) = 2p(t)(1-p(t))$$\n$$f_{DD}(t) = p(t)^2$$\n\nThese adults produce gametes to form the next generation.\n- $WW$ individuals produce only $W$ gametes.\n- $DD$ individuals produce only $D$ gametes.\n- $WD$ heterozygotes undergo non-Mendelian inheritance due to the homing process. The drive allele $D$ 'homes' by copying itself onto the homologous chromosome carrying the $W$ allele. This occurs with a probability $c$. Thus, a fraction $c$ of the $W$ alleles in the germline are converted to $D$ alleles. Consequently, a $WD$ individual produces a fraction $(1+c)/2$ of $D$ gametes and a fraction $(1-c)/2$ of $W$ gametes, instead of the standard Mendelian $1/2$ for each.\n\nThe frequency of the $D$ allele in the gamete pool, $p_g(t)$, is the sum of contributions from each genotype, weighted by their frequencies in the adult population:\n$$p_g(t) = (0) \\cdot f_{WW}(t) + \\left(\\frac{1+c}{2}\\right) \\cdot f_{WD}(t) + (1) \\cdot f_{DD}(t)$$\nSubstituting the HW frequencies:\n$$p_g(t) = \\left(\\frac{1+c}{2}\\right) \\cdot 2p(t)(1-p(t)) + p(t)^2$$\n$$p_g(t) = (1+c)p(t)(1-p(t)) + p(t)^2$$\n$$p_g(t) = p(t) + c \\cdot p(t)(1-p(t))$$\nThis equation describes the increase in the drive allele's frequency in the gamete pool due to homing.\n\nZygotes for the next generation are formed by the random union of these gametes. The pre-selection genotype frequencies at generation $t+1$ follow HW proportions based on the gamete allele frequency $p_g(t)$:\n$$f'_{WW} = (1-p_g(t))^2$$\n$$f'_{WD} = 2p_g(t)(1-p_g(t))$$\n$$f'_{DD} = p_g(t)^2$$\n\nThese zygotes are subject to viability selection. The relative viabilities (fitnesses) are given as $w_{WW} = 1$, $w_{WD} = 1 - s_H$, and $w_{DD} = 1 - s_D$, where $s_H$ and $s_D$ are the fitness costs.\n\nThe mean viability fitness of the population, $\\bar{w}(t)$, is the average fitness across all genotypes, weighted by their frequencies before selection:\n$$\\bar{w}(t) = f'_{WW}w_{WW} + f'_{WD}w_{WD} + f'_{DD}w_{DD}$$\n$$\\bar{w}(t) = (1-p_g(t))^2(1) + 2p_g(t)(1-p_g(t))(1-s_H) + p_g(t)^2(1-s_D)$$\n\nThe frequencies of genotypes among the surviving adults at generation $t+1$ are found by normalizing by the mean fitness:\n$$f_{WW}(t+1) = \\frac{f'_{WW}w_{WW}}{\\bar{w}(t)}, \\quad f_{WD}(t+1) = \\frac{f'_{WD}w_{WD}}{\\bar{w}(t)}, \\quad f_{DD}(t+1) = \\frac{f'_{DD}w_{DD}}{\\bar{w}(t)}$$\n\nThe frequency of the drive allele $D$ in the adult population at generation $t+1$, $p(t+1)$, is the frequency of $DD$ adults plus half the frequency of $WD$ adults:\n$$p(t+1) = f_{DD}(t+1) + \\frac{1}{2}f_{WD}(t+1)$$\n$$p(t+1) = \\frac{p_g(t)^2(1-s_D)}{\\bar{w}(t)} + \\frac{2p_g(t)(1-p_g(t))(1-s_H)}{2\\bar{w}(t)}$$\n$$p(t+1) = \\frac{p_g(t)^2(1-s_D) + p_g(t)(1-p_g(t))(1-s_H)}{\\bar{w}(t)}$$\nThis is the first recurrence relation, describing the evolution of the drive allele frequency.\n\n**2. Ecological Dynamics and Coupling**\n\nThe population size dynamics are governed by density dependence, including a carrying capacity $K$ and an Allee threshold $A$. The parameter $r$ is an intrinsic scale for per capita growth. For a discrete-time model, the per capita growth rate can be modeled such that it is negative below $A$ and for populations far above $K$. A standard functional form for this per-capita rate of change which incorporates these effects is $g(N) = r(1 - N/K)(N/A - 1)$. The number of offspring (zygotes) produced by the adult population of size $N(t)$ is given by $N_{zygotes} = N(t) \\cdot \\exp(g(N(t)))$, which is a discrete-time analogue of continuous growth.\n\n$$N_{zygotes} = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right)$$\n\nThis expression models the density-dependent fecundity. The number of adults in the next generation, $N(t+1)$, is the number of zygotes that survive to adulthood. This survival is determined by the mean viability fitness $\\bar{w}(t)$ of the population, which accounts for the genetic load imposed by the drive's fitness costs.\n\nTherefore, we couple the ecological and genetic dynamics:\n$$N(t+1) = N_{zygotes} \\cdot \\bar{w}(t)$$\n$$N(t+1) = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right) \\cdot \\bar{w}(t)$$\nThis is the second recurrence relation, for the total population size.\n\n**3. Summary of the Coupled System**\n\nThe complete system of coupled recurrence relations to be simulated is:\nGiven $N(t)$ and $p(t)$:\n1. Calculate the drive allele frequency in the gamete pool:\n   $$p_g(t) = p(t) + c \\cdot p(t)(1-p(t))$$\n2. Calculate the mean fitness of the offspring generation:\n   $$\\bar{w}(t) = (1-p_g(t))^2 + 2p_g(t)(1-p_g(t))(1-s_H) + p_g(t)^2(1-s_D)$$\n3. Calculate the adult population size for the next generation:\n   $$N(t+1) = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right) \\cdot \\bar{w}(t)$$\n4. Calculate the adult drive allele frequency for the next generation:\n   $$p(t+1) = \\frac{p_g(t)(1-p_g(t))(1-s_H) + p_g(t)^2(1-s_D)}{\\bar{w}(t)}$$\n\nThese equations are iterated starting from the initial conditions $(N_0, p_0)$ for $T$ generations. During the simulation, we must check if $N(t)$ falls below $A$ for any $t \\in \\{0, 1, \\dots, T\\}$. Numerical clipping of $N(t)$ at $0$ and $p(t)$ in $[0, 1]$ is implemented for stability.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates the population dynamics of a homing gene drive under density dependence\n    with an Allee effect, and determines if the population ever drops below the Allee threshold.\n    \"\"\"\n    # Test cases defined as tuples:\n    # (N0, p0, K, A, r, c, s_H, s_D, T)\n    test_cases = [\n        (5000, 0.10, 10000, 500, 0.80, 0.80, 0.05, 0.10, 200),\n        (800, 0.20, 10000, 1000, 1.00, 0.95, 0.30, 0.60, 200),\n        (1000, 0.10, 10000, 1000, 0.80, 0.90, 0.10, 0.30, 200),\n        (8000, 0.20, 10000, 1000, 0.80, 0.00, 0.20, 0.40, 200),\n        (3000, 0.30, 5000, 500, 2.00, 0.70, 0.10, 0.20, 200),\n    ]\n\n    results = []\n    for case in test_cases:\n        N0, p0, K, A, r, c, s_H, s_D, T = case\n\n        N = float(N0)\n        p = float(p0)\n        \n        # Flag to track if the population size falls below the Allee threshold.\n        crashed = False\n\n        # Check the initial condition at t=0\n        if N < A:\n            crashed = True\n        \n        if not crashed:\n            # Simulate for T generations\n            for t in range(T):\n                # Ensure p is within [0, 1] to avoid numerical issues\n                p = np.clip(p, 0.0, 1.0)\n                \n                # If population is extinct, it stays extinct.\n                if N == 0:\n                    crashed = True\n                    break\n\n                # 1. Calculate drive allele frequency in the gamete pool\n                p_g = p + c * p * (1 - p)\n\n                # 2. Calculate mean fitness\n                w_bar = ( (1 - p_g)**2 \n                        + 2 * p_g * (1 - p_g) * (1 - s_H) \n                        + p_g**2 * (1 - s_D) )\n\n                # Handle potential division by zero if w_bar is 0 or very close.\n                # This could happen if s_D=1 and p_g=1, or s_H=1 and p_g is not 0 or 1 etc.\n                if w_bar <= 0:\n                    N = 0.0\n                    # p is undefined, but since N=0, it doesn't matter. Let's set to 0.\n                    p = 0.0\n                    crashed = True\n                    break\n\n                # 3. Calculate next generation's allele frequency\n                p_next = (p_g * (1 - p_g) * (1 - s_H) + p_g**2 * (1 - s_D)) / w_bar\n                \n                # 4. Calculate next generation's population size\n                # The ecological term can result in a huge exponent, we handle this.\n                if N/K > 1e6 or K == 0 or A == 0: # Avoid overflow/division by zero\n                    # If N is huge compared to K, or K/A are zero, the exp term will be ~0\n                    # For N >> K, (1-N/K) is large negative, exp(...) -> 0\n                    growth_factor_arg = -np.inf\n                else:\n                    growth_factor_arg = r * (1 - N / K) * (N / A - 1)\n                \n                # Use np.exp which is robust to overflow/underflow\n                growth_factor = np.exp(growth_factor_arg)\n                \n                N_next = N * growth_factor * w_bar\n\n                # Update state variables for the next generation\n                N = N_next\n                p = p_next\n\n                # Clip N to be non-negative\n                N = np.max([0.0, N])\n\n                # Check if population has fallen below the Allee threshold\n                if N < A:\n                    crashed = True\n                    break\n        \n        results.append(crashed)\n\n    # Format the final output as specified\n    print(f\"[{','.join(str(r) for r in results).replace('True', 'true').replace('False', 'false')}]\")\n\nsolve()\n```"
        }
    ]
}