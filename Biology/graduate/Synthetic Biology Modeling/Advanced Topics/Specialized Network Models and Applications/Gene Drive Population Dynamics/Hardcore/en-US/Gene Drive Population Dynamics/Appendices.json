{
    "hands_on_practices": [
        {
            "introduction": "To model a gene drive's spread, we must first understand how it alters inheritance at the most basic level. This exercise challenges you to derive the non-Mendelian offspring ratios from a single cross involving a drive carrier, translating abstract parameters like homing efficiency ($h$) and resistance formation ($r$) into concrete genotype frequencies. Mastering this step is essential, as these inheritance rules are the engine of population-wide change.",
            "id": "3914128",
            "problem": "Consider a homing gene drive implemented using Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) and CRISPR-associated protein 9 (Cas9) targeting a single-locus allele. Let the wild-type allele be denoted by $W$, the drive allele by $D$, and a resistant allele that is not cut by Cas9 by $R$. Assume the following foundational rules, which are widely used in population genetic models of homing gene drives:\n- In a heterozygous germline carrying genotype $WD$, the wild-type allele $W$ is cut with probability $h$ (the homing efficiency).\n- Conditional on a cut occurring, repair is by homology-directed repair with probability $1-r$, converting $W$ to $D$, or by non-homologous end joining with probability $r$, converting $W$ to $R$.\n- If no cut occurs, the $W$ allele remains $W$.\n- Gametes from a $WW$ individual carry only the $W$ allele.\n- There is random union of gametes, no embryonic deposition effects, no fitness differences among genotypes, and no viability selection; inheritance is otherwise Mendelian.\n\nStarting from these mechanistic rules and basic Mendelian segregation, derive the offspring zygote genotype frequency distribution produced by a mating between one $WD$ parent and one $WW$ parent under random mating. Use $h=0.9$ and $r=0.05$. Report the offspring genotype frequencies in the ordered vector $\\left(WW,\\, WD,\\, WR,\\, DD,\\, DR,\\, RR\\right)$. No rounding is required; present exact values. The answer must be a single row matrix containing the six genotype frequencies in the specified order.",
            "solution": "The problem statement has been rigorously validated and found to be scientifically grounded, well-posed, objective, and internally consistent. It presents a standard, simplified model of CRISPR-based homing gene drive inheritance, providing all necessary parameters and rules to derive a unique solution. Therefore, the problem is deemed valid and a full solution follows.\n\nThe objective is to determine the genotype frequency distribution of offspring from a cross between a heterozygous drive-carrying individual ($WD$) and a wild-type individual ($WW$). This requires a two-step process: first, calculating the frequencies of gametes produced by each parent, and second, determining the frequencies of zygotic genotypes resulting from the random union of these gametes.\n\n**Step 1: Gamete Frequencies**\n\n**Parent 1: Wild-type ($WW$)**\nAn individual with genotype $WW$ is homozygous for the wild-type allele $W$. By the principles of Mendelian segregation, this parent can only produce gametes carrying the $W$ allele.\n- Frequency of $W$ gametes from the $WW$ parent: $P_{WW}(W) = 1$.\n- Frequency of $D$ gametes from the $WW$ parent: $P_{WW}(D) = 0$.\n- Frequency of $R$ gametes from the $WW$ parent: $P_{WW}(R) = 0$.\n\n**Parent 2: Heterozygous Drive-carrier ($WD$)**\nAn individual with genotype $WD$ carries one wild-type allele ($W$) and one drive allele ($D$). In the germline of this individual, the drive mechanism actively attempts to convert the $W$ allele. We must analyze the fate of the two chromosomes to determine the final gamete proportions.\n\nUnder standard Mendelian inheritance, half of the gametes would receive the $W$ allele and half would receive the $D$ allele. The gene drive process modifies the gametes that would have received the $W$ allele.\n\nLet's consider the fate of the chromosome carrying the $W$ allele:\n- With probability $1-h$, no cut occurs, and the allele remains $W$.\n- With probability $h$, the allele is cut by the Cas9 nuclease.\n  - Conditional on a cut, repair occurs via homology-directed repair (HDR) with probability $1-r$, converting the $W$ allele into a $D$ allele. The total probability for this path is $h(1-r)$.\n  - Conditional on a cut, repair occurs via non-homologous end joining (NHEJ) with probability $r$, converting the $W$ allele into a resistant allele $R$. The total probability for this path is $hr$.\n\nThe chromosome originally carrying the $D$ allele is not targeted by the drive and is passed on unchanged.\n\nTherefore, we can calculate the final frequencies of gametes produced by the $WD$ parent:\n- **Frequency of $W$ gametes, $P_{WD}(W)$:** These arise only from the $W$-carrying chromosome when no homing occurs. This portion constitutes half of the total gametes.\n$$P_{WD}(W) = \\frac{1}{2}(1 - h)$$\n- **Frequency of $R$ gametes, $P_{WD}(R)$:** These arise only from the $W$-carrying chromosome when a cut is followed by NHEJ.\n$$P_{WD}(R) = \\frac{1}{2}hr$$\n- **Frequency of $D$ gametes, $P_{WD}(D)$:** These arise from two sources: (1) the original $D$-carrying chromosome, which constitutes half of the gametes, and (2) the $W$-carrying chromosome when a cut is followed by HDR.\n$$P_{WD}(D) = \\frac{1}{2} + \\frac{1}{2}h(1-r)$$\n\nAs a verification, the sum of these probabilities must be $1$:\n$$P_{WD}(W) + P_{WD}(D) + P_{WD}(R) = \\frac{1}{2}(1-h) + \\left(\\frac{1}{2} + \\frac{1}{2}h(1-r)\\right) + \\frac{1}{2}hr$$\n$$= \\frac{1}{2} - \\frac{h}{2} + \\frac{1}{2} + \\frac{h}{2} - \\frac{hr}{2} + \\frac{hr}{2} = 1$$\nThe frequencies sum to $1$ as required.\n\n**Step 2: Offspring Zygote Genotype Frequencies**\n\nThe offspring genotypes are formed by the random union of a gamete from the $WW$ parent and a gamete from the $WD$ parent. Since the $WW$ parent only produces $W$ gametes (with frequency $1$), the offspring genotype is determined solely by the allele carried by the gamete from the $WD$ parent.\n\n- **Frequency of $WW$ offspring, $f(WW)$:** A $W$ gamete from the $WW$ parent fertilizes a $W$ gamete from the $WD$ parent.\n$$f(WW) = P_{WW}(W) \\times P_{WD}(W) = 1 \\times \\frac{1}{2}(1-h) = \\frac{1}{2}(1-h)$$\n- **Frequency of $WD$ offspring, $f(WD)$:** A $W$ gamete from the $WW$ parent fertilizes a $D$ gamete from the $WD$ parent.\n$$f(WD) = P_{WW}(W) \\times P_{WD}(D) = 1 \\times \\left(\\frac{1}{2} + \\frac{1}{2}h(1-r)\\right) = \\frac{1}{2} + \\frac{1}{2}h(1-r)$$\n- **Frequency of $WR$ offspring, $f(WR)$:** A $W$ gamete from the $WW$ parent fertilizes an $R$ gamete from the $WD$ parent.\n$$f(WR) = P_{WW}(W) \\times P_{WD}(R) = 1 \\times \\frac{1}{2}hr = \\frac{1}{2}hr$$\n- **Frequencies of $DD$, $DR$, and $RR$ offspring:** These genotypes require a $D$ or $R$ allele from the $WW$ parent. Since the $WW$ parent cannot produce such gametes, the frequencies of these genotypes are zero.\n$$f(DD) = 0$$\n$$f(DR) = 0$$\n$$f(RR) = 0$$\n\n**Step 3: Numerical Calculation**\n\nThe problem provides the specific parameter values $h = 0.9$ and $r = 0.05$. We substitute these into the derived formulas.\n\n- $f(WW) = \\frac{1}{2}(1 - 0.9) = \\frac{1}{2}(0.1) = 0.05$\n- $f(WD) = \\frac{1}{2} + \\frac{1}{2}(0.9)(1 - 0.05) = 0.5 + 0.5(0.9)(0.95) = 0.5 + 0.45(0.95) = 0.5 + 0.4275 = 0.9275$\n- $f(WR) = \\frac{1}{2}(0.9)(0.05) = 0.5(0.045) = 0.0225$\n- $f(DD) = 0$\n- $f(DR) = 0$\n- $f(RR) = 0$\n\nThe sum of the offspring frequencies is $0.05 + 0.9275 + 0.0225 + 0 + 0 + 0 = 1.0$, which confirms the calculations.\n\nThe final result is the ordered vector of genotype frequencies $(f(WW),\\, f(WD),\\, f(WR),\\, f(DD),\\, f(DR),\\, f(RR))$.\nThe vector is $(0.05,\\, 0.9275,\\, 0.0225,\\, 0,\\, 0,\\, 0)$.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 0.05  0.9275  0.0225  0  0  0 \\end{pmatrix}} $$"
        },
        {
            "introduction": "Once a gene drive allele is released, it faces an immediate challenge: can it overcome any associated fitness costs to increase in frequency? This practice explores the critical concept of the invasion threshold, a cornerstone of gene drive theory. You will use first principles of population genetics to determine the minimum homing efficiency ($h$) required for a drive to spread when rare, revealing the fundamental trade-off between drive strength and its selective disadvantage.",
            "id": "3914106",
            "problem": "Consider a large, randomly mating diploid population with two alleles at a single locus: a gene drive allele $D$ and a wild-type allele $W$. Assume discrete, non-overlapping generations. The gene drive is of the homing type: in a $D/W$ heterozygote, during gametogenesis, the wild-type allele is converted to a drive allele with probability $h$. There is no formation of resistant alleles. Viability selection acts before reproduction: $W/W$ individuals have viability $1$, and $D/W$ heterozygotes have viability $1-s_h$. You may assume that $D/D$ homozygotes are sufficiently rare when $D$ is rare that their contribution is negligible for the invasion analysis.\n\nLet $p_t$ be the frequency of allele $D$ in the gamete pool that forms generation $t$, and consider the invasion-from-rare condition, i.e., the behavior of $p_{t+1}$ when $p_t$ is close to zero. Derive, from first principles, the minimal homing efficiency $h_{\\min}$ required for the allele $D$ to increase when rare. Express your final answer as a single closed-form analytical expression in terms of $s_h$. No rounding is required, and no units are needed.",
            "solution": "The problem asks for the derivation of the minimal homing efficiency, $h_{\\min}$, required for a gene drive allele to invade a population from a rare initial frequency. This involves establishing the recurrence relation for the allele frequency and analyzing its stability at the extinction point ($p=0$).\n\nThe life cycle is as follows: Zygotes are formed based on gamete frequencies from the previous generation. These zygotes undergo viability selection to become adults. The surviving adults then produce gametes for the next generation, with the gene drive acting during gametogenesis in heterozygotes.\n\nLet $p_t$ be the frequency of the drive allele $D$ in the gamete pool that forms generation $t$.\n1.  **Zygote Formation:** Assuming random mating, the frequencies of the three genotypes ($D/D$, $D/W$, $W/W$) in the zygotes of generation $t$ are given by Hardy-Weinberg proportions:\n    -   $f_{D/D, \\text{zygote}} = p_t^2$\n    -   $f_{D/W, \\text{zygote}} = 2p_t(1-p_t)$\n    -   $f_{W/W, \\text{zygote}} = (1-p_t)^2$\n\n2.  **Viability Selection:** Viability selection acts on these zygotes. The relative viabilities are $w_{D/D}$ (unspecified, as its contribution is negligible when $p_t$ is small), $w_{D/W} = 1-s_h$, and $w_{W/W} = 1$. The frequencies of genotypes surviving to adulthood are proportional to:\n    -   $D/D$: $p_t^2 w_{D/D}$\n    -   $D/W$: $2p_t(1-p_t)(1-s_h)$\n    -   $W/W$: $(1-p_t)^2(1)$\n\n3.  **Adult Frequencies  Mean Fitness:** The mean fitness of the population, $\\bar{w}$, is the sum of the frequencies of surviving genotypes.\n    $$ \\bar{w} = (1-p_t)^2 + 2p_t(1-p_t)(1-s_h) + p_t^2 w_{D/D} $$\n    The frequencies of the genotypes among the adult survivors who will reproduce are obtained by normalizing by $\\bar{w}$.\n\n4.  **Gamete Production with Gene Drive:** These surviving adults produce gametes.\n    -   $W/W$ adults produce only $W$ gametes.\n    -   In a $D/W$ heterozygote, the allele $D$ is inherited with a baseline probability of $1/2$. The homing mechanism converts a fraction $h$ of the gametes that would have carried $W$ into $D$ gametes. Therefore, the proportion of $D$ gametes produced by a $D/W$ individual is $\\frac{1}{2} + h \\cdot \\frac{1}{2} = \\frac{1}{2}(1+h)$.\n\n5.  **Allele Frequency in the Next Generation:** The frequency of the $D$ allele in the gamete pool of the next generation, $p_{t+1}$, is found by summing the contributions from each surviving adult genotype, weighted by their post-selection frequencies:\n    $$ p_{t+1} = \\frac{ (2p_t(1-p_t)(1-s_h)) \\cdot \\frac{1}{2}(1+h) + (p_t^2 w_{D/D}) \\cdot 1 }{\\bar{w}} $$\n    $$ p_{t+1} = \\frac{p_t(1-p_t)(1-s_h)(1+h) + p_t^2 w_{D/D}}{(1-p_t)^2 + 2p_t(1-p_t)(1-s_h) + p_t^2 w_{D/D}} $$\n    This equation, $p_{t+1} = F(p_t)$, defines the change in allele frequency from one generation to the next.\n\n6.  **Invasion Analysis:** The allele $D$ will invade if its frequency increases when rare. This is determined by the derivative of the recurrence relation $F(p_t)$ evaluated at the extinction fixed point, $p_t=0$. The condition for invasion is $F'(0) > 1$.\n    To find $F'(0)$, we can analyze the behavior of $F(p_t)$ for $p_t \\to 0$. We neglect terms of order $p_t^2$ and higher.\n    $$ p_{t+1} \\approx \\frac{p_t(1-s_h)(1+h)}{1 - 2p_t + 2p_t(1-s_h)} = \\frac{p_t(1-s_h)(1+h)}{1 - 2p_t s_h} $$\n    For small $x$, $1/(1-x) \\approx 1+x$. So,\n    $$ p_{t+1} \\approx p_t(1-s_h)(1+h)(1+2p_t s_h) \\approx p_t(1-s_h)(1+h) $$\n    The linear approximation is $p_{t+1} \\approx p_t (1-s_h)(1+h)$. The growth rate for a rare allele is the multiplier $(1-s_h)(1+h)$.\n\n    Alternatively, using the quotient rule for derivatives on $F(p_t)$:\n    Let $N(p_t)$ be the numerator and $D(p_t)$ be the denominator.\n    - $N(p_t) = p_t(1-p_t)(1-s_h)(1+h) + p_t^2 w_{D/D} \\implies N(0) = 0$.\n    - $N'(p_t) = (1-2p_t)(1-s_h)(1+h) + 2p_t w_{D/D} \\implies N'(0) = (1-s_h)(1+h)$.\n    - $D(p_t) = (1-p_t)^2 + 2p_t(1-p_t)(1-s_h) + p_t^2 w_{D/D} \\implies D(0) = 1$.\n    Since $F'(0) = \\frac{N'(0)D(0) - N(0)D'(0)}{[D(0)]^2}$, we have:\n    $$ F'(0) = \\frac{((1-s_h)(1+h)) \\cdot 1 - 0}{1^2} = (1-s_h)(1+h) $$\n    The invasion condition is therefore:\n    $$ (1-s_h)(1+h) > 1 $$\n\n7.  **Minimal Homing Efficiency:** The minimal homing efficiency required for invasion, $h_{\\min}$, is the value of $h$ that satisfies the boundary condition where the growth rate is exactly $1$:\n    $$ (1-s_h)(1+h_{\\min}) = 1 $$\n    Solving for $h_{\\min}$:\n    $$ 1 + h_{\\min} = \\frac{1}{1-s_h} $$\n    $$ h_{\\min} = \\frac{1}{1-s_h} - 1 $$\n    To obtain a single fraction, we find a common denominator:\n    $$ h_{\\min} = \\frac{1 - (1-s_h)}{1-s_h} = \\frac{1-1+s_h}{1-s_h} = \\frac{s_h}{1-s_h} $$\n    This expression gives the minimum homing efficiency required to overcome the heterozygous fitness cost $s_h$ and allow the gene drive to spread in the population when initially rare.",
            "answer": "$$ \\boxed{\\frac{s_h}{1-s_h}} $$"
        },
        {
            "introduction": "The ultimate application of many gene drives, particularly for pest or disease vector control, is to suppress or even eradicate a target population. This advanced practice moves from pure population genetics to eco-genetic modeling, asking you to couple drive dynamics with population regulation. You will build and simulate a model that incorporates fitness costs, density dependence, and Allee effects to predict whether a gene drive release can push a population toward extinction.",
            "id": "3914103",
            "problem": "You are tasked with modeling the transient dynamics of a diploid population subject to a homing gene drive (HGD) with distorted transmission and viability costs, under density dependence with an Allee effect. Let the population size at discrete generation $t$ be $N(t)$ and the drive allele frequency among adults be $p(t)$. Immediately after a release at generation $t = 0$, the adult drive allele frequency is $p(0) = p_0$ and adult population size is $N(0) = N_0$. Assume random mating, Hardyâ€“Weinberg (HW) genotype proportions among zygotes, and genotype-specific viability selection only. In the HGD, heterozygotes experience germline homing that increases the transmission of the drive allele with homing probability $c$, and there is no resistance allele formation. Assume the wild-type genotype has viability fitness $w_{WW} = 1$, the heterozygote has viability fitness $w_{WD} = 1 - s_H$, and the drive homozygote has viability fitness $w_{DD} = 1 - s_D$, where $s_H$ and $s_D$ are nonnegative costs. The ecological dynamics include an Allee threshold $A$ such that below $A$, per capita growth is negative. For density dependence, assume carrying capacity $K$ and an intrinsic scale $r$ for per capita growth. Time is measured in discrete generations.\n\nStarting from the above well-tested bases in population genetics (Mendelian segregation, HW, random mating, and genotype-specific viability selection) and population ecology (density-dependent growth and Allee effects), derive, from first principles, the coupled discrete-time recursions for $N(t+1)$ and $p(t+1)$ in terms of $N(t)$, $p(t)$, and parameters $(K, A, r, c, s_H, s_D)$. Your derivation must:\n- Express the gamete pool drive allele fraction produced by adults under homing transmission distortion,\n- Construct zygote genotype proportions under HW given the gamete allele fraction,\n- Apply viability selection to obtain adult genotype proportions,\n- Compute the adult drive allele frequency $p(t+1)$ from the post-selection genotype proportions,\n- Couple the ecological recursion for $N(t+1)$ to the average viability experienced by zygotes to adults and the Allee-modified density dependence.\n\nThen implement a program that, given a small test suite of parameter sets, simulates $T$ generations starting from $(N(0), p(0))$, computes the entire transient trajectory $\\{N(t), p(t)\\}$, and returns, for each test case, a boolean indicating whether the population size ever falls strictly below the Allee threshold $A$ at any generation $t \\in \\{0, 1, \\dots, T\\}$.\n\nUse the following scientifically plausible test suite of $5$ parameter sets, each specified as a tuple $(N_0, p_0, K, A, r, c, s_H, s_D, T)$ with all parameters dimensionless and time in generations:\n- Case $1$: $(N_0 = 5000, p_0 = 0.10, K = 10000, A = 500, r = 0.80, c = 0.80, s_H = 0.05, s_D = 0.10, T = 200)$,\n- Case $2$: $(N_0 = 800, p_0 = 0.20, K = 10000, A = 1000, r = 1.00, c = 0.95, s_H = 0.30, s_D = 0.60, T = 200)$,\n- Case $3$: $(N_0 = 1000, p_0 = 0.10, K = 10000, A = 1000, r = 0.80, c = 0.90, s_H = 0.10, s_D = 0.30, T = 200)$,\n- Case $4$: $(N_0 = 8000, p_0 = 0.20, K = 10000, A = 1000, r = 0.80, c = 0.00, s_H = 0.20, s_D = 0.40, T = 200)$,\n- Case $5$: $(N_0 = 3000, p_0 = 0.30, K = 5000, A = 500, r = 2.00, c = 0.70, s_H = 0.10, s_D = 0.20, T = 200)$.\n\nFor numerical stability, in your simulation you must ensure $N(t) \\ge 0$ and $p(t) \\in [0, 1]$ at all times (clip if necessary). If the ecological recursion produces a negative intermediate population, treat the next population as $0$. Angle units are not applicable. No physical units are used. Percentages must be represented as decimals in $[0,1]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots]$), where each $result_i$ is a boolean corresponding to the $i$-th test case.",
            "solution": "The problem is valid as it is scientifically grounded in established models of population genetics and ecology, is well-posed, objective, and contains all necessary information to derive and implement a solution.\n\nThe task is to derive the coupled discrete-time recurrence relations for population size $N(t)$ and gene drive allele frequency $p(t)$ and then to simulate these dynamics. A rigorous model requires tracking genotype frequencies because viability selection disrupts Hardy-Weinberg proportions in adults.\n\n### Derivation of the Recurrence Relations\n\nWe follow the life cycle: Adults mate, produce gametes (with homing), form zygotes, which then undergo viability selection to become the next generation of adults. Let $f_{WW}(t)$, $f_{WD}(t)$, and $f_{DD}(t)$ be the frequencies of the three genotypes among adults at generation $t$, such that their sum is 1. The drive allele frequency is $p(t) = f_{DD}(t) + f_{WD}(t)/2$.\n\n**1. Gamete Production:**\nThe adult population produces gametes. $WD$ heterozygotes exhibit biased inheritance due to homing with efficiency $c$. The frequency of the drive allele $D$ in the gamete pool, $p_g(t)$, is the sum of contributions from each adult genotype:\n$$p_g(t) = (1) \\cdot f_{DD}(t) + \\left(\\frac{1+c}{2}\\right) \\cdot f_{WD}(t) + (0) \\cdot f_{WW}(t)$$\n\n**2. Zygote Formation:**\nZygotes for the next generation are formed by the random union of these gametes. According to the problem statement, their genotypes follow Hardy-Weinberg (HW) proportions based on the gamete allele frequency $p_g(t)$:\n- Zygote frequency of $WW$: $f'_{WW} = (1-p_g(t))^2$\n- Zygote frequency of $WD$: $f'_{WD} = 2p_g(t)(1-p_g(t))$\n- Zygote frequency of $DD$: $f'_{DD} = p_g(t)^2$\n\n**3. Viability Selection and Mean Fitness:**\nThese zygotes are subject to viability selection with relative fitnesses $w_{WW} = 1$, $w_{WD} = 1 - s_H$, and $w_{DD} = 1 - s_D$. The mean viability fitness of the population, $\\bar{w}(t)$, is the average fitness across all zygote genotypes:\n$$\\bar{w}(t) = f'_{WW}w_{WW} + f'_{WD}w_{WD} + f'_{DD}w_{DD}$$\n$$\\bar{w}(t) = (1-p_g(t))^2(1) + 2p_g(t)(1-p_g(t))(1-s_H) + p_g(t)^2(1-s_D)$$\nThis $\\bar{w}(t)$ represents the overall survival probability of zygotes due to genetic factors.\n\n**4. New Adult Genotype Frequencies:**\nThe frequencies of genotypes among the surviving adults at generation $t+1$ are the pre-selection frequencies weighted by their fitness and normalized by the mean fitness:\n$$f_{WW}(t+1) = \\frac{f'_{WW} \\cdot w_{WW}}{\\bar{w}(t)} = \\frac{(1-p_g(t))^2}{\\bar{w}(t)}$$\n$$f_{WD}(t+1) = \\frac{f'_{WD} \\cdot w_{WD}}{\\bar{w}(t)} = \\frac{2p_g(t)(1-p_g(t))(1-s_H)}{\\bar{w}(t)}$$\n$$f_{DD}(t+1) = \\frac{f'_{DD} \\cdot w_{DD}}{\\bar{w}(t)} = \\frac{p_g(t)^2(1-s_D)}{\\bar{w}(t)}$$\nThe new allele frequency is then $p(t+1) = f_{DD}(t+1) + f_{WD}(t+1)/2$.\n\n**5. Ecological Dynamics and Coupling:**\nThe population size dynamics are governed by density dependence with a carrying capacity $K$ and an Allee threshold $A$. The number of zygotes produced by an adult population of size $N(t)$ can be modeled using a discrete-time logistic growth model modified for the Allee effect:\n$$N_{zygotes} = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right)$$\nThe number of adults in the next generation, $N(t+1)$, is the number of zygotes that survive to adulthood, which is determined by the mean viability fitness $\\bar{w}(t)$:\n$$N(t+1) = N_{zygotes} \\cdot \\bar{w}(t)$$\n$$N(t+1) = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right) \\cdot \\bar{w}(t)$$\n\n**Simulation Logic:**\nThe simulation starts with initial conditions $N_0$ and $p_0$. We assume the initial adult population is in HW proportions based on $p_0$: $f_{DD}(0)=p_0^2$, $f_{WD}(0)=2p_0(1-p_0)$, $f_{WW}(0)=(1-p_0)^2$. We then iterate the system of equations for $N(t+1)$, $f_{WW}(t+1)$, $f_{WD}(t+1)$, and $f_{DD}(t+1)$ for $T$ generations, checking at each step if $N(t)  A$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates the population dynamics of a homing gene drive under density dependence\n    with an Allee effect, and determines if the population ever drops below the Allee threshold.\n    This version correctly tracks genotype frequencies.\n    \"\"\"\n    test_cases = [\n        (5000, 0.10, 10000, 500, 0.80, 0.80, 0.05, 0.10, 200),\n        (800, 0.20, 10000, 1000, 1.00, 0.95, 0.30, 0.60, 200),\n        (1000, 0.10, 10000, 1000, 0.80, 0.90, 0.10, 0.30, 200),\n        (8000, 0.20, 10000, 1000, 0.80, 0.00, 0.20, 0.40, 200),\n        (3000, 0.30, 5000, 500, 2.00, 0.70, 0.10, 0.20, 200),\n    ]\n\n    results = []\n    for case in test_cases:\n        N0, p0, K, A, r, c, s_H, s_D, T = case\n\n        N = float(N0)\n        \n        # Initial adult genotype frequencies assuming HW\n        f_DD = p0**2\n        f_WD = 2 * p0 * (1 - p0)\n        f_WW = (1 - p0)**2\n\n        crashed = False\n\n        if N  A:\n            crashed = True\n        \n        if not crashed:\n            for t in range(T):\n                if N == 0:\n                    crashed = True\n                    break\n\n                # 1. Calculate drive allele frequency in the gamete pool\n                p_g = f_DD + f_WD * (1 + c) / 2\n                p_g = np.clip(p_g, 0.0, 1.0)\n\n                # 2. Zygote genotype frequencies (HW proportions from gamete pool)\n                f_WW_zygote = (1 - p_g)**2\n                f_WD_zygote = 2 * p_g * (1 - p_g)\n                f_DD_zygote = p_g**2\n\n                # 3. Calculate mean fitness (viability)\n                w_bar = (f_WW_zygote * 1.0 +\n                         f_WD_zygote * (1 - s_H) +\n                         f_DD_zygote * (1 - s_D))\n                \n                if w_bar = 1e-9: # Avoid division by zero\n                    N = 0.0\n                    f_WW, f_WD, f_DD = 1.0, 0.0, 0.0\n                    crashed = True\n                    break\n\n                # 4. Calculate ecological growth/decline\n                if K == 0 or A == 0:\n                    growth_factor_arg = -np.inf\n                else:\n                    growth_factor_arg = r * (1 - N / K) * (N / A - 1)\n                \n                growth_factor = np.exp(growth_factor_arg)\n                \n                # 5. Update population size\n                N_next = N * growth_factor * w_bar\n                N = np.max([0.0, N_next])\n\n                # 6. Update adult genotype frequencies for next generation\n                f_WW_next = (f_WW_zygote * 1.0) / w_bar\n                f_WD_next = (f_WD_zygote * (1 - s_H)) / w_bar\n                f_DD_next = (f_DD_zygote * (1 - s_D)) / w_bar\n                \n                # Normalize to ensure they sum to 1 after potential floating point errors\n                gt_sum = f_WW_next + f_WD_next + f_DD_next\n                if gt_sum > 0:\n                    f_WW = f_WW_next / gt_sum\n                    f_WD = f_WD_next / gt_sum\n                    f_DD = f_DD_next / gt_sum\n\n                if N  A:\n                    crashed = True\n                    break\n        \n        results.append(crashed)\n\n    print(f\"[{','.join(str(r) for r in results).replace('True', 'True').replace('False', 'False')}]\")\n\nsolve()\n```"
        }
    ]
}