{
    "hands_on_practices": [
        {
            "introduction": "The Monod-Wyman-Changeux (MWC) model is a cornerstone in the quantitative description of allostery, describing how proteins switch between conformational states in a concerted fashion. Understanding this model begins with its derivation from the first principles of statistical mechanics. This exercise will guide you through deriving the MWC binding polynomial and fractional saturation function, providing a fundamental grasp of the model's assumptions and mathematical architecture .",
            "id": "3905911",
            "problem": "A synthetic biologist is modeling an allosteric protein sensor using the Monod–Wyman–Changeux (MWC) model, where the protein exists in two conformational states: a relaxed state $R$ and a tense state $T$. The protein is an oligomer with $n$ identical ligand-binding sites, and the ligand concentration is denoted by $[L]$. Within a given conformation, binding sites are identical and independent. Let the ligand dissociation constants in the $R$ and $T$ conformations be $K_{R}$ and $K_{T}$, respectively. At zero ligand, the conformational equilibrium is characterized by the allosteric constant $\\mathcal{L}$, defined as the ratio of the statistical weight of the $T$ ensemble to that of the $R$ ensemble in the absence of ligand.\n\nUsing the statistical mechanics definition of the binding polynomial, namely that the binding polynomial is the partition function over all microstates weighted by their statistical weights, and that for $m$ bound ligands in a conformation with dissociation constant $K$ the statistical weight is proportional to $\\binom{n}{m}\\left(\\frac{[L]}{K}\\right)^{m}$, derive:\n\n- The MWC binding polynomial $Q([L])$ for the two-conformation system.\n- The fractional saturation $Y([L])$, defined as the expected fraction of occupied binding sites per oligomer at ligand concentration $[L]$, starting from first principles. You may use the standard statistical mechanics identity that the expected number of bound ligands is given by $[L]\\frac{d}{d [L]}\\ln Q([L])$ for a binding polynomial $Q([L])$.\n\nExpress your final results in closed form in terms of $n$, $[L]$, $K_{R}$, $K_{T}$, and $\\mathcal{L}$. No numerical evaluation is required. Your final answer must be a closed-form analytical expression. Do not include any units or percentages in the final answer.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of statistical mechanics and the well-established Monod-Wyman-Changeux (MWC) model of allostery. It is well-posed, objective, and provides all necessary information for a unique, verifiable solution.\n\nThe objective is to derive the binding polynomial $Q([L])$ and the fractional saturation function $Y([L])$ for an allosteric oligomer described by the MWC model. The derivation will proceed from the first principles of statistical mechanics as specified.\n\nThe system consists of an $n$-subunit oligomeric protein that exists in two conformations, a relaxed state $R$ and a tense state $T$. The ligand concentration is $[L]$. The ligand dissociation constants for the $R$ and $T$ states are $K_{R}$ and $K_{T}$, respectively. The allosteric equilibrium constant, $\\mathcal{L}$, is the ratio of the concentration of the $T$ state to the $R$ state in the absence of ligand.\n\nFirst, we derive the binding polynomial, $Q([L])$. The binding polynomial is the partition function of the system, which is the sum of the statistical weights of all possible microstates. The total partition function $Q([L])$ is the sum of the partition functions for the $R$-state ensemble, $Q_R([L])$, and the $T$-state ensemble, $Q_T([L])$.\n$$Q([L]) = Q_R([L]) + Q_T([L])$$\n\nTo construct the partition function for the $R$-state ensemble, we sum the statistical weights of all $R$-state microstates. We set the statistical weight of the apoprotein (zero ligands bound) in the $R$ state, denoted $R_0$, to be our reference state with a weight of $1$. The problem states that for a conformation with dissociation constant $K$, the statistical weight for a microstate with $m$ bound ligands is proportional to $\\binom{n}{m}\\left(\\frac{[L]}{K}\\right)^{m}$. This weight is relative to the apoprotein in that same conformation. For the $R$ state, the dissociation constant is $K_R$. Thus, the statistical weight of an $R$-state protein with $m$ ligands bound, relative to $R_0$, is $\\binom{n}{m}\\left(\\frac{[L]}{K_R}\\right)^{m}$.\n\nThe partition function for the $R$-state ensemble, $Q_R([L])$, is the sum of these weights over all possible numbers of bound ligands, from $m=0$ to $m=n$:\n$$Q_R([L]) = \\sum_{m=0}^{n} \\binom{n}{m} \\left(\\frac{[L]}{K_R}\\right)^{m}$$\nThis sum is the binomial expansion of $\\left(1 + \\frac{[L]}{K_R}\\right)^{n}$.\n$$Q_R([L]) = \\left(1 + \\frac{[L]}{K_R}\\right)^{n}$$\n\nNext, we construct the partition function for the $T$-state ensemble, $Q_T([L])$. The allosteric constant $\\mathcal{L}$ is defined as the equilibrium ratio of the $T$ to $R$ ensembles in the absence of ligand. Therefore, the statistical weight of the apoprotein in the $T$ state, $T_0$, is $\\mathcal{L}$ relative to the reference state $R_0$. The statistical weight of a $T$-state protein with $m$ ligands bound, relative to $T_0$, is $\\binom{n}{m}\\left(\\frac{[L]}{K_T}\\right)^{m}$. To express this weight relative to our global reference state $R_0$, we multiply by the weight of $T_0$, which is $\\mathcal{L}$. The weight is thus $\\mathcal{L}\\binom{n}{m}\\left(\\frac{[L]}{K_T}\\right)^{m}$.\n\nThe partition function for the $T$-state ensemble, $Q_T([L])$, is the sum of these weights:\n$$Q_T([L]) = \\sum_{m=0}^{n} \\mathcal{L} \\binom{n}{m} \\left(\\frac{[L]}{K_T}\\right)^{m} = \\mathcal{L} \\sum_{m=0}^{n} \\binom{n}{m} \\left(\\frac{[L]}{K_T}\\right)^{m}$$\nThis sum is the binomial expansion of $\\mathcal{L}\\left(1 + \\frac{[L]}{K_T}\\right)^{n}$.\n$$Q_T([L]) = \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}$$\n\nThe total MWC binding polynomial, $Q([L])$, is the sum of the partition functions for the two ensembles:\n$$Q([L]) = \\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}$$\nThis is the first required result.\n\nNext, we derive the fractional saturation, $Y([L])$. This is defined as the expected fraction of occupied binding sites, which is the expected number of bound ligands, $\\langle N_B \\rangle$, divided by the total number of sites, $n$.\n$$Y([L]) = \\frac{\\langle N_B \\rangle}{n}$$\nThe problem provides the statistical mechanical identity for the expected number of bound ligands:\n$$\\langle N_B \\rangle = [L]\\frac{d}{d[L]}\\ln Q([L])$$\nUsing the chain rule for derivatives, this can be written as:\n$$\\langle N_B \\rangle = [L] \\frac{1}{Q([L])} \\frac{d Q([L])}{d[L]}$$\nWe must first compute the derivative of $Q([L])$ with respect to $[L]$:\n$$\\frac{d Q([L])}{d[L]} = \\frac{d}{d[L]} \\left[ \\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n} \\right]$$\nApplying the power rule and chain rule:\n$$\\frac{d Q([L])}{d[L]} = n \\left(1 + \\frac{[L]}{K_R}\\right)^{n-1} \\left(\\frac{1}{K_R}\\right) + \\mathcal{L} n \\left(1 + \\frac{[L]}{K_T}\\right)^{n-1} \\left(\\frac{1}{K_T}\\right)$$\nNow we substitute this into the expression for $\\langle N_B \\rangle$:\n$$\\langle N_B \\rangle = \\frac{[L] \\left[ n \\left(1 + \\frac{[L]}{K_R}\\right)^{n-1} \\frac{1}{K_R} + \\mathcal{L} n \\left(1 + \\frac{[L]}{K_T}\\right)^{n-1} \\frac{1}{K_T} \\right]}{\\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}}$$\nFinally, we obtain the fractional saturation $Y([L])$ by dividing $\\langle N_B \\rangle$ by $n$:\n$$Y([L]) = \\frac{\\langle N_B \\rangle}{n} = \\frac{[L] \\left[ \\left(1 + \\frac{[L]}{K_R}\\right)^{n-1} \\frac{1}{K_R} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n-1} \\frac{1}{K_T} \\right]}{\\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}}$$\nThis expression can be rearranged by distributing the $[L]$ term in the numerator to yield the standard form:\n$$Y([L]) = \\frac{\\frac{[L]}{K_R} \\left(1 + \\frac{[L]}{K_R}\\right)^{n-1} + \\mathcal{L} \\frac{[L]}{K_T} \\left(1 + \\frac{[L]}{K_T}\\right)^{n-1}}{\\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}}$$\nThis is the second required result. The expression represents a weighted average of the fractional saturation of the $R$ state and the $T$ state, where the weights are the respective probabilities of the protein being in the $R$ or $T$ ensemble at a given ligand concentration $[L]$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}  \n\\frac{\\frac{[L]}{K_R}\\left(1 + \\frac{[L]}{K_R}\\right)^{n-1} + \\mathcal{L} \\frac{[L]}{K_T}\\left(1 + \\frac{[L]}{K_T}\\right)^{n-1}}{\\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond conceptual models, quantifying the strength of allosteric communication within a protein is a key experimental challenge. The thermodynamic double mutant cycle is a powerful and elegant framework for measuring the energetic coupling between two perturbations, such as a point mutation and ligand binding. This practice provides hands-on experience applying this framework to interpret experimental data, connecting abstract free energies to measurable dissociation constants and revealing the energetic signature of allostery .",
            "id": "3905993",
            "problem": "A synthetic allosteric transcription factor is engineered to respond to a small-molecule ligand by undergoing a conformational change that modulates its DNA-binding activity. To quantify the allosteric coupling between a single point mutation and ligand binding, consider the four thermodynamic states defined by the Cartesian product of mutation status and ligand occupancy: wild-type apo, wild-type holo, mutant apo, and mutant holo. Experiments interrogate these four states at a fixed temperature $T$, reporting the following observables:\n\n- Isothermal Titration Calorimetry (ITC) yields equilibrium dissociation constants for ligand binding to the wild-type and mutant proteins: $K_d^{\\mathrm{WT}}$ and $K_d^{\\mathrm{M}}$, respectively.\n- Hydrogen–Deuterium Exchange (HDX) protection factors in the absence and presence of saturating ligand are used to infer the mutation-dependent free energy shifts of the folded ensemble in the apo and holo backgrounds. These report the mutation free energy changes $\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}$ and $\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}}$, defined as the difference in standard Gibbs free energy between mutant and wild-type in the indicated background.\n\nAssume the standard thermodynamic relation connecting equilibrium constants and standard Gibbs free energies, and that ligand binding is a reversible, monovalent equilibrium. Treat the mutation as a thermodynamic perturbation that changes the free energies of the apo and holo ensembles but does not alter the definition of the standard state. The following measurements were obtained at $T=298\\,\\mathrm{K}$:\n- $K_d^{\\mathrm{WT}} = 25\\,\\mathrm{nM}$,\n- $K_d^{\\mathrm{M}} = 250\\,\\mathrm{nM}$,\n- $\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}} = 1.800\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n- $\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} = 7.505\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n\nUsing a double mutant cycle framework grounded in equilibrium statistical thermodynamics and the definition of standard Gibbs free energy from equilibrium constants, compute the interaction (coupling) free energy $\\Delta G_{\\mathrm{int}}$ that quantifies how the mutation and ligand binding energetically interact. Express your final answer in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, and round your answer to four significant figures. You may assume a $1\\,\\mathrm{M}$ concentration standard state for equilibrium constants so that ratios of dissociation constants are dimensionless.",
            "solution": "The problem requires the calculation of the interaction free energy, $\\Delta G_{\\mathrm{int}}$, between a point mutation and ligand binding in a synthetic allosteric protein. This is a classic application of a double mutant cycle, a thermodynamic framework used to quantify energetic coupling. The system can be described by four states, forming a thermodynamic cycle:\n1.  Wild-type protein in the absence of ligand (WT_apo).\n2.  Wild-type protein bound to ligand (WT_holo).\n3.  Mutant protein in the absence of ligand (M_apo).\n4.  Mutant protein bound to ligand (M_holo).\n\nLet $G^{\\circ}_{\\mathrm{WT,apo}}$, $G^{\\circ}_{\\mathrm{WT,holo}}$, $G^{\\circ}_{\\mathrm{M,apo}}$, and $G^{\\circ}_{\\mathrm{M,holo}}$ be the standard Gibbs free energies of these four states, respectively. The free energy changes for the processes connecting these states are defined as follows:\n\nThe free energy change associated with ligand binding to the wild-type protein is:\n$$ \\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}} = G^{\\circ}_{\\mathrm{WT,holo}} - G^{\\circ}_{\\mathrm{WT,apo}} $$\nThe free energy change associated with ligand binding to the mutant protein is:\n$$ \\Delta G_{\\mathrm{bind}}^{\\mathrm{M}} = G^{\\circ}_{\\mathrm{M,holo}} - G^{\\circ}_{\\mathrm{M,apo}} $$\nThe free energy change of the mutation in the absence of ligand (apo state) is given as $\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}$:\n$$ \\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}} = G^{\\circ}_{\\mathrm{M,apo}} - G^{\\circ}_{\\mathrm{WT,apo}} $$\nThe free energy change of the mutation in the presence of ligand (holo state) is given as $\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}}$:\n$$ \\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} = G^{\\circ}_{\\mathrm{M,holo}} - G^{\\circ}_{\\mathrm{WT,holo}} $$\n\nThe thermodynamic cycle can be visualized as a box:\n$$\n\\begin{CD}\n\\text{WT_apo} @{\\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}}} \\text{WT_holo} \\\\\n@V{\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}}VV @VV{\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}}}V \\\\\n\\text{M_apo} @{\\Delta G_{\\mathrm{bind}}^{\\mathrm{M}}} \\text{M_holo}\n\\end{CD}\n$$\nSince Gibbs free energy is a state function, the change in free energy is independent of the path taken. Therefore, the sum of free energy changes around the closed cycle must be zero. Traversing the cycle clockwise from WT_apo:\n$$ (\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}) + (\\Delta G_{\\mathrm{bind}}^{\\mathrm{M}}) - (\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}}) - (\\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}}) = 0 $$\nRearranging this equation gives:\n$$ \\Delta G_{\\mathrm{bind}}^{\\mathrm{M}} - \\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}} = \\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} - \\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}} $$\nThis quantity is the interaction free energy, $\\Delta G_{\\mathrm{int}}$, which quantifies the energetic coupling between the mutation and ligand binding. A non-zero $\\Delta G_{\\mathrm{int}}$ indicates allosteric coupling.\n$$ \\Delta G_{\\mathrm{int}} = \\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} - \\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}} = \\Delta G_{\\mathrm{bind}}^{\\mathrm{M}} - \\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}} $$\n\nThe problem provides values for all four legs of the cycle, allowing us to calculate $\\Delta G_{\\mathrm{int}}$ in two ways, which must be consistent.\n\nMethod 1: Using the mutation free energies.\nThe problem directly provides the free energy changes for the mutation in the apo and holo states:\n$\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}} = 1.800\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n$\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} = 7.505\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n\nUsing the definition $\\Delta G_{\\mathrm{int}} = \\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} - \\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}$:\n$$ \\Delta G_{\\mathrm{int}} = 7.505\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} - 1.800\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} = 5.705\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n\nMethod 2: Using the ligand binding free energies.\nThe standard Gibbs free energy of binding is related to the equilibrium dissociation constant $K_d$ by the equation:\n$$ \\Delta G_{\\mathrm{bind}} = -RT \\ln(K_a) = RT \\ln\\left(\\frac{K_d}{C^\\circ}\\right) $$\nwhere $R$ is the ideal gas constant, $T$ is the absolute temperature, and $C^\\circ$ is the standard concentration ($1\\,\\mathrm{M}$).\nThe interaction energy can be calculated as the difference in binding energies:\n$$ \\Delta G_{\\mathrm{int}} = \\Delta G_{\\mathrm{bind}}^{\\mathrm{M}} - \\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}} = RT \\ln\\left(\\frac{K_d^{\\mathrm{M}}}{C^\\circ}\\right) - RT \\ln\\left(\\frac{K_d^{\\mathrm{WT}}}{C^\\circ}\\right) $$\n$$ \\Delta G_{\\mathrm{int}} = RT \\ln\\left(\\frac{K_d^{\\mathrm{M}}}{K_d^{\\mathrm{WT}}}\\right) $$\nThe given values are:\n$T = 298\\,\\mathrm{K}$\n$K_d^{\\mathrm{WT}} = 25\\,\\mathrm{nM} = 25 \\times 10^{-9}\\,\\mathrm{M}$\n$K_d^{\\mathrm{M}} = 250\\,\\mathrm{nM} = 250 \\times 10^{-9}\\,\\mathrm{M}$\nThe gas constant in appropriate units is $R \\approx 8.31446\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1} = 8.31446 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n\nThe ratio of dissociation constants is:\n$$ \\frac{K_d^{\\mathrm{M}}}{K_d^{\\mathrm{WT}}} = \\frac{250\\,\\mathrm{nM}}{25\\,\\mathrm{nM}} = 10 $$\nNow, we can calculate $\\Delta G_{\\mathrm{int}}$:\n$$ \\Delta G_{\\mathrm{int}} = (8.31446 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (298\\,\\mathrm{K}) \\times \\ln(10) $$\n$$ \\Delta G_{\\mathrm{int}} \\approx (2.47771\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}) \\times (2.30259) $$\n$$ \\Delta G_{\\mathrm{int}} \\approx 5.70509\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\nThe results from both methods are consistent. The value $5.705\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ from Method 1 is derived directly from the supplied free energy change data and is already presented to the appropriate precision reflecting the input data's decimal places. The value from Method 2, when rounded to four significant figures, is also $5.705\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n\nThe positive sign of $\\Delta G_{\\mathrm{int}}$ indicates that the mutation is more energetically unfavorable in the ligand-bound (holo) state than in the apo state ($\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} > \\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}$). Equivalently, it means that ligand binding is weaker (less favorable) to the mutant protein than to the wild-type protein ($\\Delta G_{\\mathrm{bind}}^{\\mathrm{M}} > \\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}}$, which corresponds to $K_d^{\\mathrm{M}} > K_d^{\\mathrm{WT}}$). This is an example of antagonistic or negative coupling.\n\nThe final answer, rounded to four significant figures, is $5.705\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.",
            "answer": "$$\\boxed{5.705}$$"
        },
        {
            "introduction": "Building a predictive model of an allosteric system requires not only defining its equations but also understanding how well its parameters can be determined from experimental data. This advanced computational practice explores the concept of parameter identifiability using sensitivity analysis, a technique central to modern systems biology. By computing the Jacobian of the MWC model and analyzing its singular values, you will learn to identify \"stiff\" and \"sloppy\" parameter combinations, gaining critical insight into the structural properties and practical limitations of complex biological models .",
            "id": "3905852",
            "problem": "Consider the Monod–Wyman–Changeux (MWC) model for allosteric regulation of proteins with two conformational states, the relaxed state and the tense state. The MWC model assumes $n$ identical ligand-binding sites per protein, an allosteric constant $L$ (the equilibrium ratio of the tense to relaxed states in the absence of ligand), and dissociation constants $K_R$ and $K_T$ for the relaxed and tense states, respectively. Define $c$ by $c = K_R / K_T$, so that $K_T = K_R / c$. Let the ligand concentration be denoted by $x$ (in $\\mathrm{M}$ units).\n\nThe binding polynomials for the relaxed and tense ensembles are given by\n$$Z_R(x; K_R, n) = \\left(1 + \\frac{x}{K_R}\\right)^n,$$\n$$Z_T(x; K_T, n) = L \\left(1 + \\frac{x}{K_T}\\right)^n.$$\nThe probability of being in the relaxed state is\n$$P_R(x; L, K_R, c, n) = \\frac{Z_R(x; K_R, n)}{Z_R(x; K_R, n) + Z_T(x; K_T, n)},$$\nand the per-site fractional occupancy in a given state with dissociation constant $K$ is\n$$a(x; K) = \\frac{x}{x + K}.$$\nThe observable per-site fractional occupancy under the MWC model is then\n$$Y(x; L, K_R, c, n) = P_R(x; L, K_R, c, n)\\, a(x; K_R) + \\left[1 - P_R(x; L, K_R, c, n)\\right]\\, a\\!\\left(x; \\frac{K_R}{c}\\right).$$\n\nFor a vector of $m$ ligand concentrations\n$$\\mathbf{x} = \\left[x_1, x_2, \\dots, x_m\\right],$$\ndefine the model output vector\n$$\\mathbf{y}(\\boldsymbol{\\theta}) = \\left[Y(x_1; \\boldsymbol{\\theta}), Y(x_2; \\boldsymbol{\\theta}), \\dots, Y(x_m; \\boldsymbol{\\theta})\\right]^\\top,$$\nwhere the parameter vector is\n$$\\boldsymbol{\\theta} = \\left[L, K_R, c\\right]^\\top.$$\nThe Jacobian matrix $J(\\boldsymbol{\\theta}) \\in \\mathbb{R}^{m \\times 3}$ is\n$$J(\\boldsymbol{\\theta}) = \\left[\\frac{\\partial \\mathbf{y}}{\\partial L} \\ \\ \\frac{\\partial \\mathbf{y}}{\\partial K_R} \\ \\ \\frac{\\partial \\mathbf{y}}{\\partial c}\\right].$$\n\nYour task is to write a program that, for each specified test case, constructs $J(\\boldsymbol{\\theta})$ using central finite differences with a relative perturbation step $s = 10^{-6}$ for each parameter, performs the singular value decomposition (SVD) of $J(\\boldsymbol{\\theta})$,\n$$J(\\boldsymbol{\\theta}) = U \\Sigma V^\\top,$$\nand reports the stiffness ratio\n$$\\rho = \\frac{\\sigma_{\\max}}{\\max(\\sigma_{\\min}, \\tau)},$$\nwhere $\\sigma_{\\max}$ is the largest singular value, $\\sigma_{\\min}$ is the smallest singular value, and $\\tau = 10^{-12}$ is a tolerance to prevent division by zero and to handle numerically singular Jacobians.\n\nAll ligand concentrations $x$ and dissociation constants $K_R$ must be treated in $\\mathrm{M}$ (molar) units. The final answers are unitless floats. Angles do not appear in this problem. No percentages are involved.\n\nConstruct the Jacobian using the central finite difference formula for each parameter $\\theta_j \\in \\{L, K_R, c\\}$:\n$$\\frac{\\partial \\mathbf{y}}{\\partial \\theta_j} \\approx \\frac{\\mathbf{y}(\\theta_j + h_j) - \\mathbf{y}(\\theta_j - h_j)}{2 h_j}, \\quad h_j = s \\, \\theta_j.$$\n\nTest Suite:\nFor each case below, use the specified parameters and construct a ligand concentration vector $\\mathbf{x}$ by logarithmically spacing $m$ points between $x_{\\min}$ and $x_{\\max}$ (inclusive).\n\n- Case $1$ (typical positive cooperativity):\n  - $L = 100$\n  - $n = 4$\n  - $K_R = 10^{-6}\\ \\mathrm{M}$\n  - $c = 0.1$\n  - $x_{\\min} = 10^{-9}\\ \\mathrm{M}$\n  - $x_{\\max} = 10^{-4}\\ \\mathrm{M}$\n  - $m = 15$\n- Case $2$ (boundary, nearly non-allosteric):\n  - $L = 1$\n  - $n = 4$\n  - $K_R = 10^{-6}\\ \\mathrm{M}$\n  - $c = 1$\n  - $x_{\\min} = 10^{-9}\\ \\mathrm{M}$\n  - $x_{\\max} = 10^{-4}\\ \\mathrm{M}$\n  - $m = 15$\n- Case $3$ (strong allostery and high sensitivity):\n  - $L = 1000$\n  - $n = 6$\n  - $K_R = 10^{-8}\\ \\mathrm{M}$\n  - $c = 0.01$\n  - $x_{\\min} = 10^{-10}\\ \\mathrm{M}$\n  - $x_{\\max} = 10^{-4}\\ \\mathrm{M}$\n  - $m = 20$\n- Case $4$ (weak binding and modest asymmetry):\n  - $L = 0.01$\n  - $n = 3$\n  - $K_R = 10^{-4}\\ \\mathrm{M}$\n  - $c = 0.5$\n  - $x_{\\min} = 10^{-9}\\ \\mathrm{M}$\n  - $x_{\\max} = 10^{-2}\\ \\mathrm{M}$\n  - $m = 12$\n\nYour program should produce a single line of output containing the stiffness ratios for the four cases as a comma-separated list enclosed in square brackets, for example, $\\left[\\rho_1, \\rho_2, \\rho_3, \\rho_4\\right]$, where each $\\rho_i$ is a float computed according to the procedure above.",
            "solution": "The problem requires the computation of a stiffness ratio for the Jacobian matrix of the Monod–Wyman–Changeux (MWC) model of allosteric regulation. This ratio serves as an indicator of the model's parametric sensitivity, a crucial concept in systems and synthetic biology for assessing parameter identifiability. The procedure involves defining the MWC model, constructing its Jacobian matrix numerically, and then analyzing the Jacobian's singular value spectrum.\n\nFirst, we restate the core equations of the MWC model. The model considers a protein with $n$ identical binding sites for a ligand with concentration $x$. The protein exists in two conformational states: a relaxed state (R) and a tense state (T). The equilibrium between these states is governed by the allosteric constant $L$, while ligand binding is characterized by the dissociation constants $K_R$ and $K_T$ for the R and T states, respectively. The ratio of these constants is $c = K_R / K_T$.\n\nThe binding polynomials for the ensemble of relaxed and tense proteins are given by:\n$$Z_R(x; K_R, n) = \\left(1 + \\frac{x}{K_R}\\right)^n$$\n$$Z_T(x; K_T, n) = L \\left(1 + \\frac{x}{K_T}\\right)^n = L \\left(1 + \\frac{cx}{K_R}\\right)^n$$\n\nFrom these, the probability that a protein is in the relaxed state is the ratio of the R-state partition function to the total partition function:\n$$P_R(x; L, K_R, c, n) = \\frac{Z_R(x; K_R, n)}{Z_R(x; K_R, n) + Z_T(x; K_T, n)}$$\n\nThe fractional saturation of binding sites for a protein in a single conformational state with a dissociation constant $K$ follows the simple Langmuir isotherm:\n$$a(x; K) = \\frac{x}{x + K}$$\n\nThe total observable per-site fractional occupancy, $Y$, is the weighted average of the occupancies in the R and T states, with the weights being the probabilities of each state:\n$$Y(x; L, K_R, c, n) = P_R(x; L, K_R, c, n)\\, a(x; K_R) + \\left[1 - P_R(x; L, K_R, c, n)\\right]\\, a\\!\\left(x; K_T\\right)$$\nSubstituting $K_T = K_R/c$, the expression becomes:\n$$Y(x; L, K_R, c, n) = P_R(x; L, K_R, c, n)\\, a(x; K_R) + \\left[1 - P_R(x; L, K_R, c, n)\\right]\\, a\\!\\left(x; \\frac{K_R}{c}\\right)$$\n\nThe problem defines a set of $m$ ligand concentrations, $\\mathbf{x} = [x_1, x_2, \\dots, x_m]^\\top$, and a parameter vector $\\boldsymbol{\\theta} = [L, K_R, c]^\\top$. The model's output for this set of concentrations is a vector $\\mathbf{y}(\\boldsymbol{\\theta}) \\in \\mathbb{R}^m$:\n$$\\mathbf{y}(\\boldsymbol{\\theta}) = \\left[Y(x_1; \\boldsymbol{\\theta}), Y(x_2; \\boldsymbol{\\theta}), \\dots, Y(x_m; \\boldsymbol{\\theta})\\right]^\\top$$\n\nThe central object of study is the Jacobian matrix, $J(\\boldsymbol{\\theta})$, which describes the local sensitivity of the model output vector $\\mathbf{y}$ to changes in the parameters $\\boldsymbol{\\theta}$. It is an $m \\times 3$ matrix whose columns are the partial derivatives of $\\mathbf{y}$ with respect to each parameter:\n$$J(\\boldsymbol{\\theta}) = \\left[\\frac{\\partial \\mathbf{y}}{\\partial L} \\ \\ \\frac{\\partial \\mathbf{y}}{\\partial K_R} \\ \\ \\frac{\\partial \\mathbf{y}}{\\partial c}\\right]$$\n\nSince the analytical derivation of these partial derivatives is complex, we are instructed to compute them numerically using the central finite difference method. For each parameter $\\theta_j$ in $\\boldsymbol{\\theta}$, the corresponding column of the Jacobian is approximated by:\n$$\\frac{\\partial \\mathbf{y}}{\\partial \\theta_j} \\approx \\frac{\\mathbf{y}(\\boldsymbol{\\theta}_{j}^{+}) - \\mathbf{y}(\\boldsymbol{\\theta}_{j}^{-})}{2 h_j}$$\nwhere $\\boldsymbol{\\theta}_{j}^{\\pm}$ represents the parameter vector $\\boldsymbol{\\theta}$ with the $j$-th element perturbed to $\\theta_j \\pm h_j$. The step size $h_j$ is a small relative perturbation of the parameter value: $h_j = s \\cdot \\theta_j$, with the relative step size $s = 10^{-6}$.\n\nOnce the Jacobian matrix $J(\\boldsymbol{\\theta})$ is constructed, we analyze its structure using Singular Value Decomposition (SVD):\n$$J(\\boldsymbol{\\theta}) = U \\Sigma V^\\top$$\nHere, $U$ and $V$ are orthogonal matrices, and $\\Sigma$ is a diagonal matrix containing the singular values, $\\sigma_i$, sorted in descending order ($\\sigma_1 \\ge \\sigma_2 \\ge \\dots$). These singular values represent the magnitudes of the principal axes of the sensitivity. The ratio of the largest singular value, $\\sigma_{\\max}$, to the smallest, $\\sigma_{\\min}$, indicates the anisotropy of the model's sensitivity. A large ratio implies that the model is \"sloppy,\" i.e., much more sensitive to certain combinations of parameter changes than to others.\n\nWe are to compute the stiffness ratio, $\\rho$, defined as:\n$$\\rho = \\frac{\\sigma_{\\max}}{\\max(\\sigma_{\\min}, \\tau)}$$\nwhere $\\sigma_{\\max}$ and $\\sigma_{\\min}$ are the largest and smallest singular values of $J(\\boldsymbol{\\theta})$, respectively. The tolerance $\\tau = 10^{-12}$ is introduced to prevent division by zero and provide a floor for the effective smallest singular value, which is important when the Jacobian is rank-deficient (numerically or analytically), as occurs in Case 2.\n\nThe computational procedure for each test case is as follows:\n1.  Define the parameters for the specific case: $L, n, K_R, c, x_{\\min}, x_{\\max}, m$.\n2.  Generate the ligand concentration vector $\\mathbf{x}$ by creating $m$ logarithmically spaced points between $x_{\\min}$ and $x_{\\max}$.\n3.  Establish the nominal parameter vector $\\boldsymbol{\\theta} = [L, K_R, c]^\\top$.\n4.  Construct the $m \\times 3$ Jacobian matrix $J(\\boldsymbol{\\theta})$ by computing each of its three columns using the central finite difference formula. This involves calling the MWC model function $Y$ six times (a pair of calls for each of the three parameters).\n5.  Perform SVD on the resulting Jacobian matrix $J(\\boldsymbol{\\theta})$ to obtain its singular values.\n6.  Calculate the stiffness ratio $\\rho$ using the largest and smallest singular values and the given tolerance $\\tau$.\n\nThis process is repeated for each of the four specified test cases, and the resulting stiffness ratios are reported.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not used as per the problem description mentioning `scipy==1.11.4` but no specific import. np.linalg.svd is sufficient.\n\ndef y_model(theta, n, x_vec):\n    \"\"\"\n    Computes the MWC model output vector y for a given parameter set and concentration vector.\n    \n    Args:\n        theta (list or np.ndarray): Parameter vector [L, K_R, c].\n        n (int): Number of binding sites (Hill coefficient).\n        x_vec (np.ndarray): Vector of ligand concentrations.\n\n    Returns:\n        np.ndarray: The model output vector y.\n    \"\"\"\n    L, K_R, c = theta\n    \n    # Handle potential division by zero, although problem constraints should prevent this.\n    if K_R = 0 or c = 0:\n        # Return a vector of NaNs or zeros if parameters are invalid.\n        return np.full_like(x_vec, np.nan)\n        \n    K_T = K_R / c\n\n    # Binding polynomials\n    Z_R = (1 + x_vec / K_R)**n\n    Z_T = L * (1 + x_vec / K_T)**n\n\n    # Probability of being in the relaxed state\n    # Add a small epsilon to the denominator for numerical stability if Z_R + Z_T could be zero,\n    # though it's not expected here as Z_R and Z_T are non-negative and Z_R is  0.\n    P_R = Z_R / (Z_R + Z_T)\n\n    # Per-site fractional occupancy in each state\n    a_R = x_vec / (x_vec + K_R)\n    a_T = x_vec / (x_vec + K_T)\n\n    # Observable per-site fractional occupancy\n    Y = P_R * a_R + (1 - P_R) * a_T\n    \n    return Y\n\ndef calculate_stiffness_ratio(L, n, K_R, c, x_min, x_max, m):\n    \"\"\"\n    Calculates the stiffness ratio for the MWC model Jacobian for a single test case.\n    \n    Args:\n        L (float): Allosteric constant.\n        n (int): Number of binding sites.\n        K_R (float): Dissociation constant for the relaxed state.\n        c (float): Ratio of dissociation constants, K_R / K_T.\n        x_min (float): Minimum ligand concentration.\n        x_max (float): Maximum ligand concentration.\n        m (int): Number of concentration points.\n        \n    Returns:\n        float: The computed stiffness ratio rho.\n    \"\"\"\n    s = 1e-6  # Relative perturbation step\n    tau = 1e-12 # Tolerance for stiffness ratio calculation\n\n    # 1. Generate the concentration vector\n    x_vec = np.logspace(np.log10(x_min), np.log10(x_max), m)\n\n    # 2. Define the nominal parameter vector\n    theta_nom = np.array([L, K_R, c])\n\n    # 3. Construct the Jacobian matrix using central finite differences\n    num_params = len(theta_nom)\n    J = np.zeros((m, num_params))\n    \n    for j in range(num_params):\n        theta_j = theta_nom[j]\n        \n        # Calculate step size\n        h_j = s * theta_j\n        # Failsafe for theta_j = 0, though not expected in this problem\n        if h_j == 0:\n            h_j = s \n        \n        # Perturb parameter vector\n        theta_plus = theta_nom.copy()\n        theta_minus = theta_nom.copy()\n        theta_plus[j] += h_j\n        theta_minus[j] -= h_j\n        \n        # Calculate model outputs for perturbed parameters\n        y_plus = y_model(theta_plus, n, x_vec)\n        y_minus = y_model(theta_minus, n, x_vec)\n        \n        # Calculate the j-th column of the Jacobian\n        J[:, j] = (y_plus - y_minus) / (2 * h_j)\n\n    # 4. Perform SVD on the Jacobian\n    # np.linalg.svd returns U, s, Vh where s is the vector of singular values.\n    # We only need the singular values.\n    try:\n        singular_values = np.linalg.svd(J, compute_uv=False)\n    except np.linalg.LinAlgError:\n        # Failsafe for non-convergence, though highly unlikely\n        return np.nan\n\n    # 5. Calculate the stiffness ratio\n    sigma_max = singular_values[0] # Singular values are sorted in descending order\n    sigma_min = singular_values[-1]\n    \n    rho = sigma_max / np.maximum(sigma_min, tau)\n    \n    return rho\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case 1: typical positive cooperativity\n        {\"L\": 100.0, \"n\": 4, \"K_R\": 1e-6, \"c\": 0.1, \"x_min\": 1e-9, \"x_max\": 1e-4, \"m\": 15},\n        # Case 2: boundary, nearly non-allosteric\n        {\"L\": 1.0, \"n\": 4, \"K_R\": 1e-6, \"c\": 1.0, \"x_min\": 1e-9, \"x_max\": 1e-4, \"m\": 15},\n        # Case 3: strong allostery and high sensitivity\n        {\"L\": 1000.0, \"n\": 6, \"K_R\": 1e-8, \"c\": 0.01, \"x_min\": 1e-10, \"x_max\": 1e-4, \"m\": 20},\n        # Case 4: weak binding and modest asymmetry\n        {\"L\": 0.01, \"n\": 3, \"K_R\": 1e-4, \"c\": 0.5, \"x_min\": 1e-9, \"x_max\": 1e-2, \"m\": 12},\n    ]\n\n    results = []\n    for case in test_cases:\n        rho = calculate_stiffness_ratio(\n            case[\"L\"], case[\"n\"], case[\"K_R\"], case[\"c\"],\n            case[\"x_min\"], case[\"x_max\"], case[\"m\"]\n        )\n        results.append(rho)\n\n    # Final print statement in the exact required format.\n    # The map(str, results) converts each float to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}