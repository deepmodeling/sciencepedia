{
    "hands_on_practices": [
        {
            "introduction": "While the irreversible Michaelis-Menten model is a familiar cornerstone of enzyme kinetics, most biochemical reactions are inherently reversible. This practice guides you through the first-principles derivation of the complete rate law for a single-substrate, single-product reversible reaction, which properly accounts for product inhibition and reverse flux. Mastering this fundamental derivation is essential for accurately modeling metabolic pathways, especially where reactions operate near equilibrium. ",
            "id": "3930460",
            "problem": "Consider a single-enzyme reversible conversion between a substrate and a product, $S \\rightleftharpoons P$, in a synthetic biology pathway module engineered to operate near steady state. The enzyme $E$ binds $S$ to form $ES$ and binds $P$ to form $EP$, and the catalytic step is reversible such that $ES$ can release $P$ and $EP$ can release $S$. Assume the following:\n\n- The reaction network is governed by the law of mass action, the steady-state (Briggsâ€“Haldane) approximation applies to the enzyme-bound intermediates, and total enzyme conservation holds: $E_{\\mathrm{tot}} = [E] + [ES] + [EP]$.\n- The forward and reverse catalytic turnover parameters are defined by $V_{f} = k_{\\mathrm{cat},f} E_{\\mathrm{tot}}$ and $V_{r} = k_{\\mathrm{cat},r} E_{\\mathrm{tot}}$, where $k_{\\mathrm{cat},f}$ and $k_{\\mathrm{cat},r}$ are the catalytic rate constants in the forward and reverse directions, respectively.\n- The Michaelis constants are defined by $K_{m,S} = (k_{-1,S} + k_{\\mathrm{cat},f})/k_{1,S}$ and $K_{m,P} = (k_{-1,P} + k_{\\mathrm{cat},r})/k_{1,P}$ for substrate and product binding steps, respectively.\n\nStarting from these principles, derive an expression for the net reaction rate $v$ (positive in the $S \\rightarrow P$ direction) in terms of $V_{f}$, $V_{r}$, $K_{m,S}$, $K_{m,P}$, $[S]$, and $[P]$. Then, using the following experimentally measured parameters for a synthetic enzyme variant:\n$$V_{f} = 100\\,\\mathrm{\\mu M\\,s^{-1}},\\quad V_{r} = 20\\,\\mathrm{\\mu M\\,s^{-1}},\\quad K_{m,S} = 50\\,\\mathrm{\\mu M},\\quad K_{m,P} = 100\\,\\mathrm{\\mu M},\\quad [S] = 200\\,\\mathrm{\\mu M},\\quad [P] = 50\\,\\mathrm{\\mu M},$$\ncompute the numerical value of $v$. Express your final rate in $\\mathrm{\\mu M\\,s^{-1}}$ and round your answer to four significant figures.",
            "solution": "The problem statement is deemed valid as it is scientifically grounded in established principles of enzyme kinetics, is well-posed with a unique and stable solution, and is stated in objective, unambiguous language. All necessary parameters and conditions for a complete derivation and calculation are provided, and they are physically and dimensionally consistent.\n\nThe problem requires the derivation of the net rate equation for a single-substrate, single-product reversible enzymatic reaction and the subsequent calculation of this rate for a given set of parameters. The reaction can be represented by the following mechanism, which accounts for competitive binding of substrate $S$ and product $P$ to the free enzyme $E$:\n$$\nE + S \\underset{k_{-1,S}}{\\stackrel{k_{1,S}}{\\rightleftharpoons}} ES \\xrightarrow{k_{\\mathrm{cat},f}} E + P\n$$\n$$\nE + P \\underset{k_{-1,P}}{\\stackrel{k_{1,P}}{\\rightleftharpoons}} EP \\xrightarrow{k_{\\mathrm{cat},r}} E + S\n$$\nThe net rate of reaction, $v$, is the difference between the forward rate of product formation and the reverse rate of substrate formation.\n$$\nv = k_{\\mathrm{cat},f}[ES] - k_{\\mathrm{cat},r}[EP]\n$$\nThe problem states that the steady-state (Briggs-Haldane) approximation applies to the enzyme-bound intermediates, $[ES]$ and $[EP]$. Therefore, their rates of change are assumed to be zero.\n$$\n\\frac{d[ES]}{dt} = k_{1,S}[E][S] - (k_{-1,S} + k_{\\mathrm{cat},f})[ES] = 0\n$$\n$$\n\\frac{d[EP]}{dt} = k_{1,P}[E][P] - (k_{-1,P} + k_{\\mathrm{cat},r})[EP] = 0\n$$\nFrom these equations, we can express the concentrations of the enzyme-substrate and enzyme-product complexes in terms of the free enzyme concentration $[E]$.\nRearranging the first steady-state equation gives:\n$$\nk_{1,S}[E][S] = (k_{-1,S} + k_{\\mathrm{cat},f})[ES]\n$$\n$$\n[ES] = \\frac{k_{1,S}}{(k_{-1,S} + k_{\\mathrm{cat},f})}[E][S]\n$$\nUsing the definition of the Michaelis constant for the substrate, $K_{m,S} = (k_{-1,S} + k_{\\mathrm{cat},f})/k_{1,S}$, this simplifies to:\n$$\n[ES] = \\frac{[E][S]}{K_{m,S}}\n$$\nSimilarly, for the second steady-state equation:\n$$\nk_{1,P}[E][P] = (k_{-1,P} + k_{\\mathrm{cat},r})[EP]\n$$\n$$\n[EP] = \\frac{k_{1,P}}{(k_{-1,P} + k_{\\mathrm{cat},r})}[E][P]\n$$\nUsing the definition of the Michaelis constant for the product, $K_{m,P} = (k_{-1,P} + k_{\\mathrm{cat},r})/k_{1,P}$, this simplifies to:\n$$\n[EP] = \\frac{[E][P]}{K_{m,P}}\n$$\nTotal enzyme concentration, $E_{\\mathrm{tot}}$, is conserved, as stated in the problem:\n$$\nE_{\\mathrm{tot}} = [E] + [ES] + [EP]\n$$\nSubstitute the expressions for $[ES]$ and $[EP]$ into the conservation equation:\n$$\nE_{\\mathrm{tot}} = [E] + \\frac{[E][S]}{K_{m,S}} + \\frac{[E][P]}{K_{m,P}}\n$$\nFactor out the free enzyme concentration $[E]$:\n$$\nE_{\\mathrm{tot}} = [E] \\left(1 + \\frac{[S]}{K_{m,S}} + \\frac{[P]}{K_{m,P}}\\right)\n$$\nSolve for $[E]$:\n$$\n[E] = \\frac{E_{\\mathrm{tot}}}{1 + \\frac{[S]}{K_{m,S}} + \\frac{[P]}{K_{m,P}}}\n$$\nNow, substitute this expression for $[E]$ back into the equations for $[ES]$ and $[EP]$:\n$$\n[ES] = \\frac{[S]}{K_{m,S}} \\frac{E_{\\mathrm{tot}}}{1 + \\frac{[S]}{K_{m,S}} + \\frac{[P]}{K_{m,P}}}\n$$\n$$\n[EP] = \\frac{[P]}{K_{m,P}} \\frac{E_{\\mathrm{tot}}}{1 + \\frac{[S]}{K_{m,S}} + \\frac{[P]}{K_{m,P}}}\n$$\nFinally, substitute these full expressions for $[ES]$ and $[EP]$ into the net rate equation $v = k_{\\mathrm{cat},f}[ES] - k_{\\mathrm{cat},r}[EP]$:\n$$\nv = k_{\\mathrm{cat},f} \\left(\\frac{\\frac{[S]}{K_{m,S}} E_{\\mathrm{tot}}}{1 + \\frac{[S]}{K_{m,S}} + \\frac{[P]}{K_{m,P}}}\\right) - k_{\\mathrm{cat},r} \\left(\\frac{\\frac{[P]}{K_{m,P}} E_{\\mathrm{tot}}}{1 + \\frac{[S]}{K_{m,S}} + \\frac{[P]}{K_{m,P}}}\\right)\n$$\nUsing the definitions $V_{f} = k_{\\mathrm{cat},f} E_{\\mathrm{tot}}$ and $V_{r} = k_{\\mathrm{cat},r} E_{\\mathrm{tot}}$, we arrive at the final expression for the net reaction rate:\n$$\nv = \\frac{\\frac{V_{f}[S]}{K_{m,S}} - \\frac{V_{r}[P]}{K_{m,P}}}{1 + \\frac{[S]}{K_{m,S}} + \\frac{[P]}{K_{m,P}}}\n$$\nThis is the required expression. Now we compute the numerical value of $v$ using the provided parameters:\n$V_{f} = 100\\,\\mathrm{\\mu M\\,s^{-1}}$\n$V_{r} = 20\\,\\mathrm{\\mu M\\,s^{-1}}$\n$K_{m,S} = 50\\,\\mathrm{\\mu M}$\n$K_{m,P} = 100\\,\\mathrm{\\mu M}$\n$[S] = 200\\,\\mathrm{\\mu M}$\n$[P] = 50\\,\\mathrm{\\mu M}$\n\nFirst, we calculate the dimensionless concentration ratios:\n$$\n\\frac{[S]}{K_{m,S}} = \\frac{200\\,\\mathrm{\\mu M}}{50\\,\\mathrm{\\mu M}} = 4\n$$\n$$\n\\frac{[P]}{K_{m,P}} = \\frac{50\\,\\mathrm{\\mu M}}{100\\,\\mathrm{\\mu M}} = 0.5\n$$\nNext, we substitute these values into the derived rate equation.\nThe numerator is:\n$$\n\\frac{V_{f}[S]}{K_{m,S}} - \\frac{V_{r}[P]}{K_{m,P}} = V_{f}\\left(\\frac{[S]}{K_{m,S}}\\right) - V_{r}\\left(\\frac{[P]}{K_{m,P}}\\right) = (100\\,\\mathrm{\\mu M\\,s^{-1}})(4) - (20\\,\\mathrm{\\mu M\\,s^{-1}})(0.5)\n$$\n$$\n= 400\\,\\mathrm{\\mu M\\,s^{-1}} - 10\\,\\mathrm{\\mu M\\,s^{-1}} = 390\\,\\mathrm{\\mu M\\,s^{-1}}\n$$\nThe denominator is:\n$$\n1 + \\frac{[S]}{K_{m,S}} + \\frac{[P]}{K_{m,P}} = 1 + 4 + 0.5 = 5.5\n$$\nFinally, we compute the net rate $v$:\n$$\nv = \\frac{390\\,\\mathrm{\\mu M\\,s^{-1}}}{5.5} = \\frac{780}{11}\\,\\mathrm{\\mu M\\,s^{-1}} \\approx 70.9090... \\,\\mathrm{\\mu M\\,s^{-1}}\n$$\nRounding to four significant figures, the result is $70.91\\,\\mathrm{\\mu M\\,s^{-1}}$.",
            "answer": "$$\\boxed{70.91}$$"
        },
        {
            "introduction": "Moving from a single reaction to a network, the thermodynamic properties of individual reactions become coupled through the network's structure. This exercise demonstrates how to connect the stoichiometry of a reaction network to the underlying standard chemical potentials ($\\mu_i^{\\circ'}$) of the participating species using measured equilibrium constants. Understanding this relationship is crucial for constructing large-scale metabolic models that are thermodynamically feasible and consistent. ",
            "id": "3930466",
            "problem": "A synthetic pathway is engineered to interconvert four molecular species $A$, $B$, $C$, and $D$ through three enzymatic steps operating near biochemical standard conditions (pH $7$). The stoichiometric matrix $S \\in \\mathbb{R}^{4 \\times 3}$ of the network (rows correspond to species in the order $A$, $B$, $C$, $D$ and columns to reactions $r=1,2,3$) is\n$$\nS \\;=\\;\n\\begin{pmatrix}\n-1 & 0 & +1 \\\\\n-1 & 0 & 0 \\\\\n+1 & -1 & 0 \\\\\n0 & +1 & -1\n\\end{pmatrix}.\n$$\nAt the physiological temperature $T=310$ $\\mathrm{K}$, experimentally determined equilibrium constants for the three steps are $K_{\\mathrm{eq},1} = 2.0$, $K_{\\mathrm{eq},2} = 0.5$, and $K_{\\mathrm{eq},3} = 1.5$. Let $R$ be the universal gas constant. Using only the fundamental relationships that, for each reaction $r$, the standard transformed Gibbs energy change $\\Delta_{r} G^{\\circ'}$ satisfies $\\Delta_{r} G^{\\circ'} = - R T \\ln K_{\\mathrm{eq},r}$, and that $\\Delta_{r} G^{\\circ'}$ equals the stoichiometric sum of species standard transformed chemical potentials $\\mu_{i}^{\\circ'}$ weighted by the stoichiometric coefficients, infer a vector of species standard transformed chemical potentials $\\mu^{\\circ'} = (\\mu_{A}^{\\circ'}, \\mu_{B}^{\\circ'}, \\mu_{C}^{\\circ'}, \\mu_{D}^{\\circ'})$ that is consistent with the given equilibrium constants.\n\nIdentify the dimension and a basis vector of any conserved moiety subspace implied by $S$, explain how this affects the uniqueness of $\\mu^{\\circ'}$, and impose the gauge constraint that the conserved moiety potential is zero by setting $\\mu_{A}^{\\circ'} + \\mu_{C}^{\\circ'} + \\mu_{D}^{\\circ'} = 0$ to obtain a unique representative for $\\mu^{\\circ'}$.\n\nRound each component of your final $\\mu^{\\circ'}$ vector to four significant figures and express your answer in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. The final reported vector must be ordered as $(\\mu_{A}^{\\circ'}, \\mu_{B}^{\\circ'}, \\mu_{C}^{\\circ'}, \\mu_{D}^{\\circ'})$.",
            "solution": "The problem requires the determination of a vector of standard transformed chemical potentials, $\\mu^{\\circ'} = (\\mu_{A}^{\\circ'}, \\mu_{B}^{\\circ'}, \\mu_{C}^{\\circ'}, \\mu_{D}^{\\circ'})^T$, for four species $A$, $B$, $C$, and $D$ involved in a synthetic reaction network. The solution must be consistent with the provided stoichiometric matrix $S$, a set of equilibrium constants $K_{\\mathrm{eq},r}$, and a specific gauge constraint.\n\nFirst, we establish the fundamental thermodynamic relationships. The standard transformed Gibbs energy change for each reaction $r$, denoted $\\Delta_{r} G^{\\circ'}$, is related to its equilibrium constant $K_{\\mathrm{eq},r}$ by the equation:\n$$ \\Delta_{r} G^{\\circ'} = - R T \\ln K_{\\mathrm{eq},r} $$\nwhere $R$ is the universal gas constant and $T$ is the absolute temperature. The problem specifies $T = 310 \\, \\mathrm{K}$, and we will use the value $R = 8.3145 \\times 10^{-3} \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. The product $R T$ is therefore:\n$$ R T = (8.3145 \\times 10^{-3} \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (310 \\, \\mathrm{K}) \\approx 2.5775 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\nUsing the given equilibrium constants, $K_{\\mathrm{eq},1} = 2.0$, $K_{\\mathrm{eq},2} = 0.5$, and $K_{\\mathrm{eq},3} = 1.5$, we calculate the corresponding Gibbs energy changes:\n$$ \\Delta_{1} G^{\\circ'} = - (2.5775) \\ln(2.0) \\approx -1.7865 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n$$ \\Delta_{2} G^{\\circ'} = - (2.5775) \\ln(0.5) = - (2.5775) (-\\ln(2.0)) \\approx +1.7865 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n$$ \\Delta_{3} G^{\\circ'} = - (2.5775) \\ln(1.5) \\approx -1.0451 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\nLet $\\Delta G^{\\circ'}$ be the column vector of these values: $\\Delta G^{\\circ'} = (\\Delta_{1} G^{\\circ'}, \\Delta_{2} G^{\\circ'}, \\Delta_{3} G^{\\circ'})^T$.\n\nThe second fundamental relationship connects the reaction Gibbs energies to the species' chemical potentials. For each reaction $r$, $\\Delta_{r} G^{\\circ'}$ is the stoichiometric sum of the standard transformed chemical potentials $\\mu_{i}^{\\circ'}$ of the participating species $i$:\n$$ \\Delta_{r} G^{\\circ'} = \\sum_{i} S_{ir} \\mu_{i}^{\\circ'} $$\nwhere $S_{ir}$ is the stoichiometric coefficient of species $i$ in reaction $r$. This set of equations can be expressed concisely in matrix form:\n$$ \\Delta G^{\\circ'} = S^T \\mu^{\\circ'} $$\nwhere $S^T$ is the transpose of the given stoichiometric matrix $S$.\n$$ S^T = \\begin{pmatrix} -1 & -1 & 1 & 0 \\\\ 0 & 0 & -1 & 1 \\\\ 1 & 0 & 0 & -1 \\end{pmatrix} $$\nThis gives the following system of three linear equations in four unknowns ($\\mu_{A}^{\\circ'}, \\mu_{B}^{\\circ'}, \\mu_{C}^{\\circ'}, \\mu_{D}^{\\circ'}$):\n$$ -\\mu_{A}^{\\circ'} - \\mu_{B}^{\\circ'} + \\mu_{C}^{\\circ'} = \\Delta_{1} G^{\\circ'} \\quad (1) $$\n$$ -\\mu_{C}^{\\circ'} + \\mu_{D}^{\\circ'} = \\Delta_{2} G^{\\circ'} \\quad (2) $$\n$$ \\mu_{A}^{\\circ'} - \\mu_{D}^{\\circ'} = \\Delta_{3} G^{\\circ'} \\quad (3) $$\nSince there are more unknowns than independent equations, this system does not have a unique solution. The non-uniqueness is related to the existence of conserved moieties in the reaction network. A conserved moiety corresponds to a linear combination of species concentrations that remains constant over time. The stoichiometric coefficients of such a combination form a vector $l$ in the left null space (kernel) of $S$, i.e., $S^T l = 0$.\n\nWe find the basis for the kernel of $S^T$. Let $l = (l_A, l_B, l_C, l_D)^T$. The condition $S^T l = 0$ yields the system:\n$$ -l_A - l_B + l_C = 0 $$\n$$ -l_C + l_D = 0 $$\n$$ l_A - l_D = 0 $$\nFrom the second and third equations, we get $l_A = l_D$ and $l_C = l_D$, so $l_A = l_C = l_D$. Substituting into the first equation gives $-l_A - l_B + l_A = 0$, which implies $l_B = 0$. Thus, any vector in $\\ker(S^T)$ must be of the form $(k, 0, k, k)^T$ for some scalar $k$. The conserved moiety subspace is one-dimensional, and a basis vector is $l = (1, 0, 1, 1)^T$. This corresponds to the conservation of the total amount of species $A$, $C$, and $D$.\n\nThe existence of this null space vector explains the non-uniqueness of $\\mu^{\\circ'}$. If $\\mu_p^{\\circ'}$ is a particular solution to $S^T \\mu^{\\circ'} = \\Delta G^{\\circ'}$, then any vector $\\mu^{\\circ'} = \\mu_p^{\\circ'} + \\alpha l$ is also a solution for any scalar $\\alpha$, because $S^T(\\mu_p^{\\circ'} + \\alpha l) = S^T\\mu_p^{\\circ'} + \\alpha(S^T l) = \\Delta G^{\\circ'} + \\alpha(0) = \\Delta G^{\\circ'}$.\n\nTo obtain a unique solution, we must impose an additional constraint. The problem provides a gauge constraint by setting the potential corresponding to the conserved moiety to zero:\n$$ \\mu_{A}^{\\circ'} + \\mu_{C}^{\\circ'} + \\mu_{D}^{\\circ'} = 0 \\quad (4) $$\nThis can be written as $l^T \\mu^{\\circ'} = 0$. This provides the fourth independent equation needed to uniquely determine the four components of $\\mu^{\\circ'}$.\n\nWe now solve the system of four linear equations:\n1. $-\\mu_{A}^{\\circ'} - \\mu_{B}^{\\circ'} + \\mu_{C}^{\\circ'} = \\Delta_{1} G^{\\circ'}$\n2. $-\\mu_{C}^{\\circ'} + \\mu_{D}^{\\circ'} = \\Delta_{2} G^{\\circ'}$\n3. $\\mu_{A}^{\\circ'} - \\mu_{D}^{\\circ'} = \\Delta_{3} G^{\\circ'}$\n4. $\\mu_{A}^{\\circ'} + \\mu_{C}^{\\circ'} + \\mu_{D}^{\\circ'} = 0$\n\nFrom (2), $\\mu_{D}^{\\circ'} = \\mu_{C}^{\\circ'} + \\Delta_{2} G^{\\circ'}$.\nFrom (3), $\\mu_{A}^{\\circ'} = \\mu_{D}^{\\circ'} + \\Delta_{3} G^{\\circ'} = (\\mu_{C}^{\\circ'} + \\Delta_{2} G^{\\circ'}) + \\Delta_{3} G^{\\circ'}$.\nSubstitute these expressions for $\\mu_{A}^{\\circ'}$ and $\\mu_{D}^{\\circ'}$ into (4):\n$$ (\\mu_{C}^{\\circ'} + \\Delta_{2} G^{\\circ'} + \\Delta_{3} G^{\\circ'}) + \\mu_{C}^{\\circ'} + (\\mu_{C}^{\\circ'} + \\Delta_{2} G^{\\circ'}) = 0 $$\n$$ 3\\mu_{C}^{\\circ'} + 2\\Delta_{2} G^{\\circ'} + \\Delta_{3} G^{\\circ'} = 0 $$\n$$ \\mu_{C}^{\\circ'} = -\\frac{1}{3} (2\\Delta_{2} G^{\\circ'} + \\Delta_{3} G^{\\circ'}) $$\nNow we can find the other potentials:\n$$ \\mu_{D}^{\\circ'} = \\mu_{C}^{\\circ'} + \\Delta_{2} G^{\\circ'} = -\\frac{1}{3} (2\\Delta_{2} G^{\\circ'} + \\Delta_{3} G^{\\circ'}) + \\Delta_{2} G^{\\circ'} = \\frac{1}{3} (\\Delta_{2} G^{\\circ'} - \\Delta_{3} G^{\\circ'}) $$\n$$ \\mu_{A}^{\\circ'} = \\mu_{D}^{\\circ'} + \\Delta_{3} G^{\\circ'} = \\frac{1}{3} (\\Delta_{2} G^{\\circ'} - \\Delta_{3} G^{\\circ'}) + \\Delta_{3} G^{\\circ'} = \\frac{1}{3} (\\Delta_{2} G^{\\circ'} + 2\\Delta_{3} G^{\\circ'}) $$\nFinally, from (1), we solve for $\\mu_{B}^{\\circ'}$:\n$$ \\mu_{B}^{\\circ'} = -\\mu_{A}^{\\circ'} + \\mu_{C}^{\\circ'} - \\Delta_{1} G^{\\circ'} $$\nSubstituting the expressions for $\\mu_{A}^{\\circ'}$ and $\\mu_{C}^{\\circ'}$:\n$$ \\mu_{B}^{\\circ'} = -\\frac{1}{3}(\\Delta_{2} G^{\\circ'} + 2\\Delta_{3} G^{\\circ'}) - \\frac{1}{3}(2\\Delta_{2} G^{\\circ'} + \\Delta_{3} G^{\\circ'}) - \\Delta_{1} G^{\\circ'} $$\n$$ \\mu_{B}^{\\circ'} = -\\frac{1}{3}(3\\Delta_{2} G^{\\circ'} + 3\\Delta_{3} G^{\\circ'}) - \\Delta_{1} G^{\\circ'} = -\\Delta_{2} G^{\\circ'} - \\Delta_{3} G^{\\circ'} - \\Delta_{1} G^{\\circ'} $$\n$$ \\mu_{B}^{\\circ'} = -(\\Delta_{1} G^{\\circ'} + \\Delta_{2} G^{\\circ'} + \\Delta_{3} G^{\\circ'}) $$\nSubstituting the numerical values for $\\Delta_r G^{\\circ'}$ (in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$):\n$\\Delta_{1} G^{\\circ'} \\approx -1.7865$, $\\Delta_{2} G^{\\circ'} \\approx 1.7865$, $\\Delta_{3} G^{\\circ'} \\approx -1.0451$.\nUsing higher precision for intermediate steps: $\\Delta_1 G^{\\circ'} = -1.78653$, $\\Delta_2 G^{\\circ'} = 1.78653$, $\\Delta_3 G^{\\circ'} = -1.04510$.\n$$ \\mu_{C}^{\\circ'} = -\\frac{1}{3} (2(1.78653) + (-1.04510)) = -\\frac{1}{3} (3.57306 - 1.04510) = -0.84265... $$\n$$ \\mu_{D}^{\\circ'} = \\frac{1}{3} (1.78653 - (-1.04510)) = \\frac{1}{3} (2.83163) = 0.94387... $$\n$$ \\mu_{A}^{\\circ'} = \\frac{1}{3} (1.78653 + 2(-1.04510)) = \\frac{1}{3} (1.78653 - 2.09020) = -0.10122... $$\n$$ \\mu_{B}^{\\circ'} = -(-1.78653 + 1.78653 - 1.04510) = 1.04510 $$\nRounding each component to four significant figures, we get:\n$\\mu_{A}^{\\circ'} \\approx -0.1012 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n$\\mu_{B}^{\\circ'} \\approx 1.045 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n$\\mu_{C}^{\\circ'} \\approx -0.8427 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n$\\mu_{D}^{\\circ'} \\approx 0.9439 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n\nThe final vector $\\mu^{\\circ'} = (\\mu_{A}^{\\circ'}, \\mu_{B}^{\\circ'}, \\mu_{C}^{\\circ'}, \\mu_{D}^{\\circ'})$ is:\n$(-0.1012, 1.045, -0.8427, 0.9439)$ in units of $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -0.1012 & 1.045 & -0.8427 & 0.9439 \\end{pmatrix} } $$"
        },
        {
            "introduction": "A significant challenge in systems biology is that experimentally measured kinetic parameters often contain noise and may not collectively satisfy fundamental thermodynamic laws. This advanced, computational practice addresses the Wegscheider cycle conditions, which ensure thermodynamic consistency in reaction networks. You will implement an optimization-based method to minimally adjust a set of measured rate constants, enforcing detailed balance and ensuring your resulting model is not only kinetically plausible but also thermodynamically sound. ",
            "id": "3930439",
            "problem": "Consider a synthetic biology modeling scenario where three biochemical species $A$, $B$, and $C$ are connected by a reversible three-reaction cycle $A \\rightleftharpoons B$, $B \\rightleftharpoons C$, and $C \\rightleftharpoons A$. Each reversible reaction $r \\in \\{1,2,3\\}$ has a forward rate constant $k_r^+$ and a backward rate constant $k_r^-$. Under mass-action kinetics and thermodynamic equilibrium, the Wegscheider conditions (thermodynamic cycle consistency conditions) require that the product of equilibrium constants around any closed loop is equal to $1$, which is a consequence of detailed balance and the additivity of reaction Gibbs free energies around cycles.\n\nYou are given measured rate constants that are subject to experimental noise and do not satisfy the Wegscheider conditions exactly. You are asked to minimally adjust the logarithms of the rate constants to enforce all Wegscheider conditions for the cycle, while perturbing the given values as little as possible in the Euclidean sense.\n\nFormally, let $z \\in \\mathbb{R}^6$ collect the logarithms of the rate constants in the order $z = [\\ln k_1^+, \\ln k_1^-, \\ln k_2^+, \\ln k_2^-, \\ln k_3^+, \\ln k_3^-]^\\top$, and let $z_0 \\in \\mathbb{R}^6$ be the corresponding vector formed from the measured rate constants. Your task is to compute the minimizer $z^\\star$ of the strictly convex quadratic problem that minimizes the Euclidean distance between $z$ and $z_0$, subject to the linear Wegscheider constraints for the three-reaction cycle. After obtaining $z^\\star$, convert back to rate constants $k_r^\\pm = \\exp(z^\\star)$.\n\nUse the following test suite of measured rate constants, each given in per second units ($\\mathrm{s}^{-1}$):\n\n- Case $1$ (happy path): $k^+ = [\\, 1.2,\\, 0.8,\\, 1.5 \\,] \\ \\mathrm{s}^{-1}$ and $k^- = [\\, 0.9,\\, 1.1,\\, 0.7 \\,] \\ \\mathrm{s}^{-1}$.\n- Case $2$ (near-consistent boundary): $k^+ = [\\, 0.6,\\, 2.0,\\, 1.0 \\,] \\ \\mathrm{s}^{-1}$ and $k^- = [\\, 0.5,\\, 2.1,\\, 0.95 \\,] \\ \\mathrm{s}^{-1}$.\n- Case $3$ (edge case with extreme scale separation): $k^+ = [\\, 5 \\times 10^{-2},\\, 10^{3},\\, 2.5 \\times 10^{1} \\,] \\ \\mathrm{s}^{-1}$ and $k^- = [\\, 10^{-3},\\, 2.0 \\times 10^{2},\\, 10^{-6} \\,] \\ \\mathrm{s}^{-1}$.\n\nYour program must, for each case, output a list of seven real numbers: the six adjusted rate constants $[\\, k_1^+,\\, k_1^-,\\, k_2^+,\\, k_2^-,\\, k_3^+,\\, k_3^- \\,]$ in $\\mathrm{s}^{-1}$, followed by the minimized objective value, which is the squared Euclidean adjustment magnitude $\\sum_{i=1}^{6} (z_i^\\star - z_{0,i})^2$ (dimensionless because it is in logarithmic space).\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a comma-separated list enclosed in square brackets. The order of elements in each inner list must be $[\\, k_1^+,\\, k_1^-,\\, k_2^+,\\, k_2^-,\\, k_3^+,\\, k_3^-,\\, \\text{objective} \\,]$. For example, an output with two hypothetical cases would look like $[[a_1,a_2,a_3,a_4,a_5,a_6,a_7],[b_1,b_2,b_3,b_4,b_5,b_6,b_7]]$.\n\nAssume all logarithms are natural logarithms. Express all adjusted rate constants in $\\mathrm{s}^{-1}$, and the objective values as real numbers.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of chemical thermodynamics and kinetics, specifically the Wegscheider cycle conditions derived from the principle of detailed balance. The problem is well-posed as a strictly convex quadratic optimization problem with a single linear equality constraint, which guarantees a unique solution. All terms are clearly defined, and the data provided is consistent and complete for solving the problem.\n\nThe problem is to find a vector of adjusted log-rate-constants $z \\in \\mathbb{R}^6$ that minimizes the squared Euclidean distance to a vector of measured log-rate-constants $z_0$, subject to a linear constraint representing thermodynamic consistency. This is a classic constrained optimization problem solvable using the method of Lagrange multipliers.\n\nLet the vector of log-rate-constants be $z = [\\ln k_1^+, \\ln k_1^-, \\ln k_2^+, \\ln k_2^-, \\ln k_3^+, \\ln k_3^-]^\\top$. The corresponding vector from experimental measurements is $z_0$. The objective is to minimize the function $f(z) = \\|z - z_0\\|^2_2 = \\sum_{i=1}^{6} (z_i - z_{0,i})^2$.\n\nThe Wegscheider condition for the cycle $A \\rightleftharpoons B \\rightleftharpoons C \\rightleftharpoons A$ requires the product of the equilibrium constants to be unity:\n$$\n\\frac{k_1^+}{k_1^-} \\cdot \\frac{k_2^+}{k_2^-} \\cdot \\frac{k_3^+}{k_3^-} = 1\n$$\nTaking the natural logarithm of this expression yields a linear equation in the log-rate-constants:\n$$\n(\\ln k_1^+ - \\ln k_1^-) + (\\ln k_2^+ - \\ln k_2^-) + (\\ln k_3^+ - \\ln k_3^-) = 0\n$$\nThis constraint can be written in vector form as $g(z) = c^\\top z = 0$, where the constraint vector $c$ is given by:\n$$\nc = [1, -1, 1, -1, 1, -1]^\\top\n$$\nThe problem is thus to find $\\arg\\min_{z} \\|z - z_0\\|^2_2$ subject to $c^\\top z = 0$.\n\nWe form the Lagrangian $\\mathcal{L}(z, \\lambda) = \\|z - z_0\\|^2_2 - \\lambda (c^\\top z)$, where $\\lambda$ is the Lagrange multiplier. The Karush-Kuhn-Tucker (KKT) conditions for optimality require the gradient of the Lagrangian with respect to $z$ to be zero:\n$$\n\\nabla_z \\mathcal{L}(z^\\star, \\lambda^\\star) = 2(z^\\star - z_0) - \\lambda^\\star c = 0\n$$\nFrom this, we can express the optimal solution $z^\\star$ in terms of $z_0$ and $\\lambda^\\star$:\n$$\nz^\\star = z_0 + \\frac{\\lambda^\\star}{2} c\n$$\nTo find the value of the Lagrange multiplier, we enforce the constraint $c^\\top z^\\star = 0$:\n$$\nc^\\top \\left( z_0 + \\frac{\\lambda^\\star}{2} c \\right) = 0 \\implies c^\\top z_0 + \\frac{\\lambda^\\star}{2} (c^\\top c) = 0\n$$\nSolving for $\\lambda^\\star/2$ yields:\n$$\n\\frac{\\lambda^\\star}{2} = - \\frac{c^\\top z_0}{c^\\top c}\n$$\nThe denominator $c^\\top c$ is the squared Euclidean norm of $c$: $\\|c\\|^2_2 = 1^2 + (-1)^2 + 1^2 + (-1)^2 + 1^2 + (-1)^2 = 6$. The numerator $c^\\top z_0$ represents the initial thermodynamic imbalance of the cycle based on the measured data. Let this imbalance be $\\epsilon_0 = c^\\top z_0$.\n\nSubstituting back, we get the expression for the optimal log-rate-constant vector $z^\\star$:\n$$\nz^\\star = z_0 - \\frac{\\epsilon_0}{6} c\n$$\nThis result has a clear geometric interpretation: the optimal solution $z^\\star$ is found by starting from the measured point $z_0$ and moving along the direction of the constraint normal vector $c$ just enough to land on the hyperplane defined by $c^\\top z = 0$. This is the orthogonal projection of $z_0$ onto the constraint hyperplane.\n\nThe six adjusted log-rate-constants are therefore:\n$z^\\star_1 = z_{0,1} - \\epsilon_0/6$ \\quad ($k_1^+$)\n$z^\\star_2 = z_{0,2} + \\epsilon_0/6$ \\quad ($k_1^-$)\n$z^\\star_3 = z_{0,3} - \\epsilon_0/6$ \\quad ($k_2^+$)\n$z^\\star_4 = z_{0,4} + \\epsilon_0/6$ \\quad ($k_2^-$)\n$z^\\star_5 = z_{0,5} - \\epsilon_0/6$ \\quad ($k_3^+$)\n$z^\\star_6 = z_{0,6} + \\epsilon_0/6$ \\quad ($k_3^-$)\n\nThe adjusted rate constants $k_r^\\pm$ are obtained by exponentiating the components of $z^\\star$: $k_i^\\star = \\exp(z^\\star_i)$.\n\nThe minimized objective value, which is the squared magnitude of the adjustment, is calculated as $\\|z^\\star - z_0\\|^2_2$:\n$$\n\\|z^\\star - z_0\\|^2_2 = \\left\\| - \\frac{\\epsilon_0}{6} c \\right\\|^2_2 = \\left( \\frac{\\epsilon_0}{6} \\right)^2 \\|c\\|^2_2 = \\frac{\\epsilon_0^2}{36} \\cdot 6 = \\frac{\\epsilon_0^2}{6}\n$$\nThe algorithmic procedure is as follows:\n1. For each test case, construct the vector of measured rate constants $k_0 = [k_{1,0}^+, k_{1,0}^-, k_{2,0}^+, k_{2,0}^-, k_{3,0}^+, k_{3,0}^-]$.\n2. Compute the initial log-rate vector $z_0 = \\ln(k_0)$ (element-wise).\n3. Compute the thermodynamic imbalance $\\epsilon_0 = c^\\top z_0$.\n4. Calculate the optimal log-rate vector $z^\\star = z_0 - (\\epsilon_0/6) c$.\n5. Compute the adjusted rate constants $k^\\star = \\exp(z^\\star)$ (element-wise).\n6. Calculate the minimized objective value $J = \\epsilon_0^2/6$.\n7. Collate the six components of $k^\\star$ and the value $J$ into the final result for the test case.\nThis procedure is implemented for each provided set of rate constants.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the constrained optimization problem for three test cases\n    of biochemically inconsistent rate constants.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: happy path\n        (np.array([1.2, 0.8, 1.5]), np.array([0.9, 1.1, 0.7])),\n        # Case 2: near-consistent boundary\n        (np.array([0.6, 2.0, 1.0]), np.array([0.5, 2.1, 0.95])),\n        # Case 3: edge case with extreme scale separation\n        (np.array([5e-2, 1e3, 2.5e1]), np.array([1e-3, 2e2, 1e-6])),\n    ]\n\n    results = []\n    \n    # The constraint vector c for the Wegscheider condition c^T z = 0\n    c = np.array([1.0, -1.0, 1.0, -1.0, 1.0, -1.0])\n    \n    # The squared norm of c, which is a constant in this problem\n    c_dot_c = c @ c # which is 6.0\n\n    for k_plus_0, k_minus_0 in test_cases:\n        # Step 1: Construct the full vector of measured rates and log-rates (z0)\n        # Order is [k1+, k1-, k2+, k2-, k3+, k3-]\n        k0 = np.ravel(np.column_stack((k_plus_0, k_minus_0)))\n        z0 = np.log(k0)\n\n        # Step 2: Calculate the thermodynamic imbalance (epsilon_0)\n        epsilon_0 = c @ z0\n\n        # Step 3: Calculate the optimal adjusted log-rate vector z_star\n        # z_star = z0 - (c.T @ z0 / c.T @ c) * c\n        adjustment = (epsilon_0 / c_dot_c) * c\n        z_star = z0 - adjustment\n\n        # Step 4: Convert back to adjusted rate constants\n        k_star = np.exp(z_star)\n\n        # Step 5: Calculate the minimized objective value\n        # This is the squared Euclidean norm of the adjustment vector (z_star - z0)\n        # ||z_star - z0||^2 = ||-adjustment||^2 = (epsilon_0 / ||c||^2)^2 * ||c||^2\n        objective_value = (epsilon_0**2) / c_dot_c\n\n        # Step 6: Assemble the results for the current case\n        case_result = k_star.tolist()\n        case_result.append(objective_value)\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # Format each inner list of numbers into a string.\n    formatted_results = []\n    for res in results:\n        # Use a high precision format to avoid rounding issues in validation\n        # but problem does not specify a precision, so standard repr is fine.\n        formatted_numbers = [f\"{x:.15g}\" for x in res]\n        formatted_results.append(f\"[{','.join(formatted_numbers)}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}