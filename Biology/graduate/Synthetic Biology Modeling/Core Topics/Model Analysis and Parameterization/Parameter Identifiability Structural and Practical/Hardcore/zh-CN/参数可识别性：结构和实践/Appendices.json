{
    "hands_on_practices": [
        {
            "introduction": "我们从一个最基本的问题开始：即使我们能获得完美且连续的数据，模型中的参数是否能够被唯一确定？这就是结构可辨识性的核心。这项练习  将提供一个基础方法，通过将状态空间模型转换为输入-输出方程，并检查参数到方程系数的映射关系，来回答一个简单线性系统的这个问题。通过这个过程，你将掌握分析模型内在属性的基本技能，这是任何参数估计工作开始之前的重要一步。",
            "id": "3925268",
            "problem": "在一个合成生物学建模场景中，考虑一个线性化的单输入单输出 (SISO) 基因表达模块，其状态变量 $x(t)$ 代表基因产物浓度，已知输入 $u(t)$ 代表诱导物，测量输出 $y(t)$ 等于该产物浓度。其动态由状态空间模型给出\n$$\\dot{x}(t)=-k\\,x(t)+\\alpha\\,u(t),\\quad y(t)=x(t),$$\n其中未知参数向量为 $\\theta=(k,\\alpha)$，$k$ 是一个正的降解/稀释率，$\\alpha$ 是一个正的输入增益。假设 $u(t)$ 是一个足够平滑的已知函数，且 $y(t)$ 的测量除了模型之外没有代数约束。\n\n仅从状态空间模型和结构可辨识性（如果对于几乎所有容许输入，不同的 $\\theta$ 会产生不同的输入输出行为，则参数化是结构可辨识的）的定义出发，执行以下任务：\n\n- 消去未观测状态 $x(t)$，推导出首一形式（“首一”指 $y(t)$ 的最高阶导数项的系数为1）的最小阶输入输出微分方程。\n- 基于此首一形式的输入输出微分方程，将系数映射 $c(\\theta)$ 定义为与 $y(t)$ 和 $u(t)$ 相关项（及其导数，如果存在）的系数组成的向量，并用 $\\theta=(k,\\alpha)$ 明确表示 $c(\\theta)$。\n- 使用系数映射简要论证 $\\theta$ 的每个分量是否是结构可辨识的。\n\n对于您的最终答案，仅需以行矩阵的形式报告系数映射 $c(\\theta)$。最终答案框中无需数值计算或四舍五入，也无需单位。",
            "solution": "该问题被验证为有科学依据、提法恰当、客观且完整。它是在线性时不变系统的结构可辨识性分析方面的一个标准练习，这是系统理论和建模中的一个基本课题。所有必需的信息都已提供，任务明确无歧义。\n\n目标是分析给定单输入单输出 (SISO) 系统的参数 $\\theta=(k,\\alpha)$ 的结构可辨识性。这包括三个步骤：首先，推导输入输出微分方程；其次，定义从系统参数 $\\theta$ 到该方程系数的映射；第三，评估该映射的单射性。\n\n系统由以下状态空间模型描述：\n$$\n\\dot{x}(t) = -k\\,x(t) + \\alpha\\,u(t)\n$$\n$$\ny(t) = x(t)\n$$\n其中 $x(t)$ 是未观测状态，$u(t)$ 是已知输入，$y(t)$ 是测量输出。需要辨识的参数是 $\\theta = (k, \\alpha)$。\n\n**步骤 1：推导输入输出方程**\n\n为了消去未观测的状态变量 $x(t)$，我们使用输出方程 $y(t) = x(t)$。这种直接关系允许我们将状态方程中的 $x(t)$ 替换为 $y(t)$。对输出方程关于时间 $t$ 求导，得到：\n$$\n\\dot{y}(t) = \\frac{dy(t)}{dt} = \\frac{dx(t)}{dt} = \\dot{x}(t)\n$$\n现在，我们将 $x(t) = y(t)$ 和 $\\dot{x}(t) = \\dot{y}(t)$ 代入状态方程：\n$$\n\\dot{y}(t) = -k\\,y(t) + \\alpha\\,u(t)\n$$\n问题要求这个最小阶输入输出微分方程是首一形式，这意味着输出 $y(t)$ 的最高阶导数的系数必须为 $1$。整理该方程，我们得到：\n$$\n\\dot{y}(t) + k\\,y(t) = \\alpha\\,u(t)\n$$\n在这个方程中，最高阶导数是 $\\dot{y}(t)$，其系数已经为 $1$。因此，这就是所要求的首一形式输入输出微分方程。它是最小阶（一阶）的，因为原始状态空间模型是一阶的。\n\n**步骤 2：定义系数映射 $c(\\theta)$**\n\n系数映射 $c(\\theta)$ 被定义为首一形式输入输出方程中与 $y(t)$ 和 $u(t)$ （及其导数）相关的项的系数组成的向量。一阶首一形式方程的一般形式是：\n$$\n\\dot{y}(t) + c_1\\,y(t) = d_0\\,u(t)\n$$\n系数向量是 $(c_1, d_0)$。通过将此一般形式与我们推导出的方程进行比较，\n$$\n\\dot{y}(t) + k\\,y(t) = \\alpha\\,u(t)\n$$\n我们可以根据参数向量 $\\theta=(k, \\alpha)$ 识别出这些系数。$y(t)$ 项的系数是 $k$，$u(t)$ 项的系数是 $\\alpha$。\n\n因此，系数映射 $c(\\theta)$ 是：\n$$\nc(\\theta) = (k, \\alpha)\n$$\n\n**步骤 3：结构可辨识性的论证**\n\n如果系数映射 $c(\\theta)$ 在容许参数空间上是单射的（一对一的），则参数向量 $\\theta$ 是结构可辨识的。这意味着对于任何两个不同的参数向量 $\\theta_1$ 和 $\\theta_2$，它们对应的系数向量 $c(\\theta_1)$ 和 $c(\\theta_2)$ 也必须是不同的。形式上，如果 $c(\\theta_1) = c(\\theta_2)$，则必须能推出 $\\theta_1 = \\theta_2$。\n\n设 $\\theta_1 = (k_1, \\alpha_1)$ 和 $\\theta_2 = (k_2, \\alpha_2)$ 是两个参数向量。它们产生相同输入输出行为的条件是 $c(\\theta_1) = c(\\theta_2)$。应用我们推导的映射：\n$$\n(k_1, \\alpha_1) = (k_2, \\alpha_2)\n$$\n这个向量等式意味着两个标量等式：\n$$\nk_1 = k_2\n$$\n$$\n\\alpha_1 = \\alpha_2\n$$\n这两个条件共同意味着参数向量必须是相同的，即 $\\theta_1 = \\theta_2$。\n\n由于假设 $c(\\theta_1) = c(\\theta_2)$ 必然导致结论 $\\theta_1 = \\theta_2$，因此映射 $c(\\theta)$ 是单射的。这意味着如果我们能从实验数据中确定输入输出微分方程的系数（这是结构可辨识性的前提，假设输入 $u(t)$ 足够丰富），我们就能唯一地确定参数 $k$ 和 $\\alpha$ 的值。\n\n因此，参数向量 $\\theta = (k, \\alpha)$ 的每个分量都是结构可辨识的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} k  \\alpha \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从理论转向实践，我们必须考虑离散测量和实验噪声。费雪信息矩阵（FIM）是解决这一问题的核心工具，它量化了一次实验能提供多少关于未知参数的信息。本练习  将引导你从第一性原理出发，为一个简单的衰变模型推导FIM，揭示实验设计（如采样时间）与我们参数估计能力之间的关键联系。理解FIM是评估和优化实验以获得精确参数估计的基础。",
            "id": "3925270",
            "problem": "在合成生物学中，对于信使RNA或蛋白质降解等单物种衰变过程的建模，一种常见的表示方法是使用一阶常微分方程 (ODE) $\\dot{x}(t)=-k x(t)$，其中衰减率 $k>0$。考虑一个实验，其中状态 $x(t)$ 在采样时间 $t_i$ 通过测量模型 $y_i=x(t_i)+\\epsilon_i$ 被观测，其中噪声项 $\\epsilon_i$ 是独立同分布 (i.i.d.) 的高斯噪声，满足 $\\epsilon_i\\sim \\mathcal{N}(0,\\sigma^2)$。假设初始条件 $x(0)=x_0$ 是未知的，需要与 $k$ 一起进行联合估计。\n\n从该ODE的确定性解和高斯噪声的似然定义出发，推导在由采样时间 $\\{t_i\\}_{i=1}^{n}$ 指定的实验设计下，参数向量 $\\theta=(x_0,k)$ 的费雪信息矩阵 (FIM)。您的推导必须从第一性原理开始：即ODE的解、测量模型以及独立同分布高斯误差的对数似然定义。在未于此背景下证明之前，请勿假定任何关于FIM的快捷公式。然后，使用您的表达式，陈述使FIM非奇异的关于集合 $\\{t_i\\}$ 的一个充分必要条件，并从与 $x_0$ 联合估计时 $k$ 的实际可辨识性角度解释该条件。\n\n将您最终的费雪信息矩阵表示为一个包含 $x_0$, $k$, $\\sigma^2$ 和采样时间 $\\{t_i\\}$ 的闭式解析表达式。无需进行数值计算。您的最终答案必须是一个单一的解析表达式。",
            "solution": "本题要求从第一性原理出发，推导一阶衰变过程参数的费雪信息矩阵 (FIM)，然后分析其非奇异性的条件。\n\n该过程首先求解控制常微分方程 (ODE)。模型由下式给出：\n$$\n\\dot{x}(t) = -k x(t)\n$$\n初始条件为 $x(0) = x_0$。这是一个可分离的一阶线性ODE。通过对 $\\frac{dx}{x} = -k dt$ 积分来求解：\n$$\n\\int \\frac{dx}{x} = \\int -k dt \\implies \\ln|x| = -kt + C\n$$\n应用初始条件 $x(0)=x_0$，我们得到 $\\ln|x_0| = C$。假设 $x(t)$ 代表一个物理量，如浓度或种群数量，我们取 $x(t) > 0$，因此 $|x|=x$。解为：\n$$\nx(t) = x_0 \\exp(-kt)\n$$\n这个函数描述了系统在任意时间 $t$ 的状态，由参数向量 $\\theta = (x_0, k)$ 参数化。\n\n测量模型指定，在每个采样时间 $t_i$（其中 $i=1, \\dots, n$），我们观测到一个值 $y_i$，由下式给出：\n$$\ny_i = x(t_i; \\theta) + \\epsilon_i = x_0 \\exp(-kt_i) + \\epsilon_i\n$$\n噪声项 $\\epsilon_i$ 是独立同分布 (i.i.d.) 的，服从均值为 $0$、方差为 $\\sigma^2$ 的高斯分布，即 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。因此，给定参数 $\\theta$ 的单次测量 $y_i$ 的概率密度函数 (PDF) 为：\n$$\np(y_i|\\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - x(t_i; \\theta))^2}{2\\sigma^2}\\right)\n$$\n由于噪声的独立同分布特性，观测到整个数据集 $\\mathbf{y} = (y_1, \\dots, y_n)$ 的似然是各个概率的乘积：\n$$\nL(\\theta|\\mathbf{y}) = \\prod_{i=1}^{n} p(y_i|\\theta)\n$$\n在数学上，使用对数似然函数 $\\mathcal{L}(\\theta) = \\ln L(\\theta|\\mathbf{y})$ 更为方便：\n$$\n\\mathcal{L}(\\theta) = \\sum_{i=1}^{n} \\ln p(y_i|\\theta) = \\sum_{i=1}^{n} \\left[ -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{(y_i - x_0\\exp(-kt_i))^2}{2\\sigma^2} \\right]\n$$\n费雪信息矩阵 (FIM)，记作 $\\mathcal{I}(\\theta)$，是针对参数向量 $\\theta = (\\theta_1, \\theta_2) = (x_0, k)$ 的一个 $2 \\times 2$ 矩阵。其元素定义为对数似然函数的二阶偏导数（Hessian矩阵）的负期望：\n$$\n\\mathcal{I}_{jl}(\\theta) = -E\\left[\\frac{\\partial^2 \\mathcal{L}(\\theta)}{\\partial \\theta_j \\partial \\theta_l}\\right]\n$$\n其中期望 $E[\\cdot]$ 是对数据 $\\mathbf{y}$ 的概率分布求得的。\n\n我们首先计算 $\\mathcal{L}(\\theta)$ 的一阶偏导数：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\theta_j} = \\sum_{i=1}^{n} \\frac{-1}{2\\sigma^2} \\cdot 2(y_i - x(t_i)) \\cdot \\left(-\\frac{\\partial x(t_i)}{\\partial \\theta_j}\\right) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (y_i - x(t_i)) \\frac{\\partial x(t_i)}{\\partial \\theta_j}\n$$\n现在，我们计算二阶偏导数：\n$$\n\\frac{\\partial^2 \\mathcal{L}}{\\partial \\theta_j \\partial \\theta_l} = \\frac{\\partial}{\\partial \\theta_l} \\left[ \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (y_i - x(t_i)) \\frac{\\partial x(t_i)}{\\partial \\theta_j} \\right] = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} \\left[ -\\frac{\\partial x(t_i)}{\\partial \\theta_l} \\frac{\\partial x(t_i)}{\\partial \\theta_j} + (y_i - x(t_i)) \\frac{\\partial^2 x(t_i)}{\\partial \\theta_j \\partial \\theta_l} \\right]\n$$\n为了求出FIM的元素，我们取该表达式负值的期望。我们利用 $E[y_i] = x(t_i)$ 这一事实，它意味着 $E[y_i - x(t_i)] = E[\\epsilon_i] = 0$。\n$$\n\\mathcal{I}_{jl}(\\theta) = -E\\left[\\frac{\\partial^2 \\mathcal{L}}{\\partial \\theta_j \\partial \\theta_l}\\right] = -\\frac{1}{\\sigma^2} \\sum_{i=1}^{n} E\\left[ -\\frac{\\partial x(t_i)}{\\partial \\theta_l} \\frac{\\partial x(t_i)}{\\partial \\theta_j} + (y_i - x(t_i)) \\frac{\\partial^2 x(t_i)}{\\partial \\theta_j \\partial \\theta_l} \\right]\n$$\n由于 $\\frac{\\partial x(t_i)}{\\partial \\theta_j}$ 不是随机变量，期望仅作用于 $(y_i - x(t_i))$ 项。\n$$\n\\mathcal{I}_{jl}(\\theta) = -\\frac{1}{\\sigma^2} \\sum_{i=1}^{n} \\left[ -\\frac{\\partial x(t_i)}{\\partial \\theta_l} \\frac{\\partial x(t_i)}{\\partial \\theta_j} + E[y_i - x(t_i)] \\frac{\\partial^2 x(t_i)}{\\partial \\theta_j \\partial \\theta_l} \\right] = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} \\frac{\\partial x(t_i)}{\\partial \\theta_j} \\frac{\\partial x(t_i)}{\\partial \\theta_l}\n$$\n这个推导满足了不假定快捷公式的要求。现在我们计算 $x(t_i; x_0, k) = x_0 \\exp(-kt_i)$ 的具体偏导数，也称为灵敏度函数。\n对于 $\\theta_1 = x_0$：\n$$\n\\frac{\\partial x(t_i)}{\\partial x_0} = \\exp(-kt_i)\n$$\n对于 $\\theta_2 = k$：\n$$\n\\frac{\\partial x(t_i)}{\\partial k} = x_0 \\exp(-kt_i) \\cdot (-t_i) = -x_0 t_i \\exp(-kt_i)\n$$\n使用这些灵敏度，我们构建FIM的元素：\n$$\n\\mathcal{I}_{11} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} \\left(\\frac{\\partial x(t_i)}{\\partial x_0}\\right)^2 = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (\\exp(-kt_i))^2 = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} \\exp(-2kt_i)\n$$\n$$\n\\mathcal{I}_{22} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} \\left(\\frac{\\partial x(t_i)}{\\partial k}\\right)^2 = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (-x_0 t_i \\exp(-kt_i))^2 = \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^{n} t_i^2 \\exp(-2kt_i)\n$$\n$$\n\\mathcal{I}_{12} = \\mathcal{I}_{21} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} \\frac{\\partial x(t_i)}{\\partial x_0} \\frac{\\partial x(t_i)}{\\partial k} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (\\exp(-kt_i)) (-x_0 t_i \\exp(-kt_i)) = -\\frac{x_0}{\\sigma^2} \\sum_{i=1}^{n} t_i \\exp(-2kt_i)\n$$\n组合这些元素，费雪信息矩阵为：\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^2} \\begin{pmatrix} \\sum_{i=1}^n \\exp(-2kt_i)  -x_0 \\sum_{i=1}^n t_i \\exp(-2kt_i) \\\\ -x_0 \\sum_{i=1}^n t_i \\exp(-2kt_i)  x_0^2 \\sum_{i=1}^n t_i^2 \\exp(-2kt_i) \\end{pmatrix}\n$$\n为使FIM非奇异，其行列式必须非零。FIM非奇异的充分必要条件是灵敏度向量是线性无关的。这两个灵敏度向量是 $\\mathbf{s}_{x_0}$ 和 $\\mathbf{s}_k$，其分量为：\n$$\n(\\mathbf{s}_{x_0})_i = \\frac{\\partial x(t_i)}{\\partial x_0} = \\exp(-kt_i)\n$$\n$$\n(\\mathbf{s}_k)_i = \\frac{\\partial x(t_i)}{\\partial k} = -x_0 t_i \\exp(-kt_i)\n$$\n如果存在一个常数 $c$ 使得 $\\mathbf{s}_k = c \\mathbf{s}_{x_0}$，则这两个向量是线性相关的。这将要求：\n$$\n-x_0 t_i \\exp(-kt_i) = c \\cdot \\exp(-kt_i)\n$$\n假设 $x_0 \\neq 0$ (否则系统恒为零，无法辨识任何参数) 并注意到 $\\exp(-kt_i) \\neq 0$，我们可以将两边同时除以 $\\exp(-kt_i)$ 得到：\n$$\n-x_0 t_i = c\n$$\n这个方程必须对所有 $i=1, \\dots, n$ 成立。如果所有采样时间 $t_i$ 都相同，即对所有 $i$ 都有 $t_i = T$，那么当 $c = -x_0 T$ 时条件满足，向量是线性相关的，从而使FIM是奇异的。然而，如果存在至少一对采样时间 $(t_i, t_j)$ 使得 $t_i \\neq t_j$，那么就不可能找到一个单一的常数 $c$ 同时满足 $-x_0 t_i = c$ 和 $-x_0 t_j = c$。在这种情况下，向量是线性无关的，FIM是非奇异的。\n\n因此，使FIM非奇异的关于集合 $\\{t_i\\}_{i=1}^n$ 的充分必要条件是必须至少有两个不同的采样时间（即集合 $\\{t_i\\}$ 必须包含至少两个唯一的值）。这要求 $n \\ge 2$。\n\n解释：一个非奇异的FIM是参数局部实际可辨识性的先决条件。如果FIM是奇异的，那么无论噪声水平如何，都无法从给定的实验数据中唯一确定参数。要求至少两个不同测量时间的条件具有明确的实际意义。如果所有的测量都在单一时间点 $T$ 进行，我们实际上是在多次测量同一个量 $x(T) = x_0 \\exp(-kT)$。这允许我们精确地估计乘积 $x_0 \\exp(-kT)$，但它没有提供任何信息来区分 $x_0$ 和 $k$ 的各自贡献。无数对 $(x_0, k)$ 都可以产生相同的 $x_0 \\exp(-kT)$ 值。通过在两个或更多个不同的时间（比如 $t_1$ 和 $t_2$）测量系统，我们可以观察到状态 $x(t)$ 如何随时间变化。这种动态信息使我们能够独立地解析初始条件 $x_0$（“起点”）和衰减率 $k$（“衰减速度”）。例如，两次测量值的比率 $x(t_2)/x(t_1) = \\exp(-k(t_2-t_1))$ 仅依赖于 $k$，从而可以估计出 $k$，之后便可以确定 $x_0$。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sigma^2} \\begin{pmatrix} \\sum_{i=1}^n \\exp(-2kt_i)  -x_0 \\sum_{i=1}^n t_i \\exp(-2kt_i) \\\\ -x_0 \\sum_{i=1}^n t_i \\exp(-2kt_i)  x_0^2 \\sum_{i=1}^n t_i^2 \\exp(-2kt_i) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "建模的一个关键作用是指导实验设计。我们应该如何激励一个系统才能最大程度地了解其参数？这个计算练习  将直接解决这个问题。通过为一个非线性的诱导型启动子模型在不同输入信号（简单的阶跃输入与动态的正弦输入）下数值计算FIM，你将研究输入信号的“丰富性”如何直接影响实践可辨识性，并亲身体会为什么动态输入对于稳健的参数估计通常是必不可少的。",
            "id": "3925354",
            "problem": "考虑合成生物学中一个标准的诱导型启动子模型，该模型具有单一动态状态，其中表达产物的浓度由常微分方程 $$\\dot{x}(t)=\\frac{\\alpha\\,u(t)}{K+u(t)}-\\delta\\,x(t)$$ 控制，并通过测量模型 $$y(t)=x(t)+\\epsilon(t)$$ 进行观测。假设 $\\epsilon(t)$ 是均值为零、方差为 $\\sigma^2$ 的加性高斯白噪声 (AWGN)，并且 $x(0)=0$。输入 $u(t)$ 是外部设定且已知的。参数 $\\alpha$、$K$ 和 $\\delta$ 是未知的正常数。\n\n从独立高斯测量的费雪信息矩阵 (FIM) 的基本定义和动态系统的灵敏度出发，计算参数向量 $$\\theta=\\begin{bmatrix}\\alpha\\\\K\\\\\\delta\\end{bmatrix}$$ 在两种输入设计下的 FIM：\n- 阶跃输入 $$u_{\\text{step}}(t)=U_0$$，该输入在时间上是恒定的，以及\n- 正弦输入 $$u_{\\text{sine}}(t)=U_0+A\\sin(\\omega t),$$ 其中 $U_0\\ge A\\ge 0$ 以确保 $u(t)\\ge 0$。\n\n在给定的加性噪声方差 $\\sigma^2$ 下，使用基于灵敏度的方法，针对在固定实验时长 $$T=N\\,\\Delta t$$ 内、采样时间为 $$t_i=i\\,\\Delta t,\\quad i=0,1,\\dots,N,$$ 的时间离散化观测值计算 FIM。对于方差为 $\\sigma^2$ 的独立高斯噪声，费雪信息矩阵为 $$\\mathcal{I}(\\theta)=\\sum_{i=0}^{N}\\frac{1}{\\sigma^2}\\left(\\frac{\\partial\\,\\mathbb{E}[y(t_i)]}{\\partial\\theta}\\right)\\left(\\frac{\\partial\\,\\mathbb{E}[y(t_i)]}{\\partial\\theta}\\right)^\\top,$$ 并且由于 $$\\mathbb{E}[y(t)]=x(t),$$ 所需的灵敏度为 $$\\frac{\\partial\\,x(t)}{\\partial\\alpha},\\quad \\frac{\\partial\\,x(t)}{\\partial K},\\quad \\frac{\\partial\\,x(t)}{\\partial\\delta}.$$ 通过对状态方程关于每个参数求导来推导这些灵敏度，并将它们与状态一起进行数值积分，以计算两种输入下的 FIM。然后，从计算出的 FIM 中，确定 FIM 的秩，该秩表示局部可辨识的参数组合数量。报告每种输入设计和测试用例的整数秩。\n\n时间以秒为单位。最终输出中不需要物理单位，因为秩是无量纲整数。\n\n实现一个程序，对下面指定的每个测试用例，计算：\n- 阶跃输入下的 FIM 及其整数秩，以及\n- 正弦输入下的 FIM 及其整数秩。\n\n为了确定秩，使用 FIM 的严格正特征值的数量，数值阈值定义为 $$\\tau=10^{-8}\\,\\lambda_{\\max},$$ 其中 $\\lambda_{\\max}$ 是 FIM 的最大特征值；如果一个特征值超过 $\\tau$，则认为它是正的。如果所有特征值都为零，则将秩定义为 $0$。\n\n测试套件：\n- 用例 1（正常情况）：\n  - $\\alpha=4.0$, $K=1.5$, $\\delta=0.4$\n  - 阶跃输入：$U_0=1.0$\n  - 正弦输入：$U_0=1.0$, $A=0.5$, $\\omega=0.4$ (弧度/秒)\n  - 实验：$T=40.0$, $\\Delta t=0.1$, $\\sigma=0.05$\n- 用例 2（边界情况：慢动态与快激励）：\n  - $\\alpha=4.0$, $K=0.1$, $\\delta=0.01$\n  - 阶跃输入：$U_0=0.15$\n  - 正弦输入：$U_0=0.15$, $A=0.12$, $\\omega=5.0$ (弧度/秒)\n  - 实验：$T=60.0$, $\\Delta t=0.1$, $\\sigma=0.05$\n- 用例 3（边界：接近饱和状态）：\n  - $\\alpha=4.0$, $K=100.0$, $\\delta=1.0$\n  - 阶跃输入：$U_0=1.0$\n  - 正弦输入：$U_0=1.0$, $A=0.5$, $\\omega=0.2$ (弧度/秒)\n  - 实验：$T=40.0$, $\\Delta t=0.1$, $\\sigma=0.05$\n\n您的程序应生成一行输出，其中包含一个以逗号分隔的列表，用方括号括起来的结果，每个测试用例贡献一对整数 $[r_{\\text{step}},r_{\\text{sine}}]$。例如，输出格式应为 $$\\big[[r_{\\text{step},1},r_{\\text{sine},1}],[r_{\\text{step},2},r_{\\text{sine},2}],\\dots\\big].$$",
            "solution": "该问题是有效的。这是一个关于参数可辨识性分析的适定且有科学依据的练习，这是系统生物学和工程学中的一个标准课题。所有必要的数据和定义都已提供，没有内部矛盾或事实错误。\n\n求解过程首先推导灵敏度方程，这些方程控制着系统状态如何随其参数变化。这些方程与原始状态方程相结合，形成一个增广常微分方程(ODE)组。然后对该系统进行数值积分，以获得状态及其灵敏度的时间历程。最后，根据这些灵敏度计算费雪信息矩阵(FIM)，并确定其秩以评估参数的可辨识性。\n\n模型由产物浓度 $x(t)$ 的状态方程描述：\n$$\n\\dot{x}(t)=\\frac{\\alpha\\,u(t)}{K+u(t)}-\\delta\\,x(t), \\quad x(0)=0\n$$\n参数向量为 $\\theta=\\begin{bmatrix}\\alpha  K  \\delta\\end{bmatrix}^\\top$。\n\n对于 $N+1$ 个具有独立加性高斯噪声（方差为 $\\sigma^2$）的离散时间测量，费雪信息矩阵由下式给出：\n$$\n\\mathcal{I}(\\theta)=\\frac{1}{\\sigma^2}\\sum_{i=0}^{N} \\left(\\nabla_\\theta x(t_i)\\right) \\left(\\nabla_\\theta x(t_i)\\right)^\\top\n$$\n其中 $\\nabla_\\theta x(t_i)$ 是灵敏度向量，其分量是状态对每个参数的偏导数，在时间 $t_i$ 处求值：\n$$\n\\nabla_\\theta x(t) = \\begin{bmatrix}\n\\frac{\\partial x(t)}{\\partial \\alpha} \\\\\n\\frac{\\partial x(t)}{\\partial K} \\\\\n\\frac{\\partial x(t)}{\\partial \\delta}\n\\end{bmatrix} = \\begin{bmatrix}\nS_\\alpha(t) \\\\\nS_K(t) \\\\\nS_\\delta(t)\n\\end{bmatrix}\n$$\n\n为了找到这些灵敏度，我们对状态方程关于每个参数求导。设 $f(x, u, \\theta) = \\frac{\\alpha u}{K+u} - \\delta x$。灵敏度方程的一般形式通过应用链式法则得到，注意时间和参数的求导顺序可以交换：\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial x}{\\partial \\theta_j}\\right) = \\frac{\\partial}{\\partial \\theta_j}\\left(\\frac{dx}{dt}\\right) = \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial \\theta_j} + \\frac{\\partial f}{\\partial \\theta_j}\n$$\n在我们的模型中，$\\frac{\\partial f}{\\partial x} = -\\delta$。因此，灵敏度 $S_j(t) = \\frac{\\partial x(t)}{\\partial \\theta_j}$ 的演化遵循：\n$$\n\\dot{S}_j(t) = -\\delta S_j(t) + \\frac{\\partial f}{\\partial \\theta_j}\n$$\n每个灵敏度的初始条件是 $S_j(0) = \\frac{\\partial x(0)}{\\partial \\theta_j} = \\frac{\\partial 0}{\\partial \\theta_j} = 0$。\n\n我们现在推导每个参数的具体项 $\\frac{\\partial f}{\\partial \\theta_j}$：\n1.  **对 $\\alpha$ 的灵敏度**：$S_\\alpha(t) = \\frac{\\partial x}{\\partial \\alpha}$\n    $$\n    \\frac{\\partial f}{\\partial \\alpha} = \\frac{u(t)}{K+u(t)}\n    $$\n    相应的 ODE 是：\n    $$\n    \\dot{S}_\\alpha(t) = -\\delta S_\\alpha(t) + \\frac{u(t)}{K+u(t)}, \\quad S_\\alpha(0)=0\n    $$\n\n2.  **对 $K$ 的灵敏度**：$S_K(t) = \\frac{\\partial x}{\\partial K}$\n    $$\n    \\frac{\\partial f}{\\partial K} = \\alpha u(t) \\frac{\\partial}{\\partial K}(K+u(t))^{-1} = -\\frac{\\alpha u(t)}{(K+u(t))^2}\n    $$\n    相应的 ODE 是：\n    $$\n    \\dot{S}_K(t) = -\\delta S_K(t) - \\frac{\\alpha u(t)}{(K+u(t))^2}, \\quad S_K(0)=0\n    $$\n    \n3.  **对 $\\delta$ 的灵敏度**：$S_\\delta(t) = \\frac{\\partial x}{\\partial \\delta}$\n    这种情况需要小心，因为 $\\delta$ 出现在 $f$ 的两个项中。\n    $$\n    \\frac{\\partial f}{\\partial \\delta} = -x(t)\n    $$\n    然而，完整的灵敏度方程在 $\\frac{\\partial f}{\\partial x}$ 项中也包含 $\\delta$。\n    $$\n    \\frac{d S_\\delta}{dt} = \\frac{\\partial}{\\partial \\delta}(\\dot{x}) = \\frac{\\partial}{\\partial \\delta}\\left(\\frac{\\alpha u}{K+u} - \\delta x\\right) = -\\left(x + \\delta \\frac{\\partial x}{\\partial \\delta}\\right) = -x - \\delta S_\\delta\n    $$\n    相应的 ODE 是：\n    $$\n    \\dot{S}_\\delta(t) = -\\delta S_\\delta(t) - x(t), \\quad S_\\delta(0)=0\n    $$\n\n为了计算 FIM，我们为状态向量 $Z(t) = \\begin{bmatrix} x(t), S_\\alpha(t), S_K(t), S_\\delta(t) \\end{bmatrix}^\\top$ 构建一个包含四个 ODE 的增广系统：\n$$\n\\frac{d}{dt}\n\\begin{bmatrix} x \\\\ S_\\alpha \\\\ S_K \\\\ S_\\delta \\end{bmatrix}\n=\n\\begin{bmatrix}\n\\frac{\\alpha u(t)}{K+u(t)} - \\delta x \\\\\n\\frac{u(t)}{K+u(t)} - \\delta S_\\alpha \\\\\n-\\frac{\\alpha u(t)}{(K+u(t))^2} - \\delta S_K \\\\\n-x - \\delta S_\\delta\n\\end{bmatrix}\n\\quad \\text{初始条件为} \\quad\nZ(0) = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n\n对于每个指定的输入 $u(t)$（阶跃和正弦），此系统从 $t=0$ 到 $t=T$ 进行数值积分。解在离散时间点 $t_i = i\\,\\Delta t$（其中 $i=0, 1, \\dots, N$）处进行评估。得到的灵敏度向量 $\\nabla_\\theta x(t_i)$ 用于构建 $3 \\times 3$ 的 FIM。\n\nFIM 的秩表示可辨识的参数或参数组合的数量。满秩 FIM（秩 $3$）表明所有三个参数都是局部可辨识的。秩亏 FIM（秩 $ 3$）表示结构性或实践性不可辨识，意味着某些参数或其组合无法从给定的实验中唯一确定。通过计算严格大于阈值 $\\tau = 10^{-8} \\lambda_{\\max}$ 的特征值 $\\lambda_j$ 的数量来数值确定秩，其中 $\\lambda_{\\max}$ 是 FIM 的最大特征值。对于零矩阵，秩为 $0$。\n\n以下 Python 代码为每个测试用例实现了此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef dZ_dt(t, Z, alpha, K, delta, u_func):\n    \"\"\"\n    Defines the augmented system of ODEs for the state and sensitivities.\n    Z = [x, S_alpha, S_K, S_delta]\n    \"\"\"\n    x, s_alpha, s_K, s_delta = Z\n    u_val = u_func(t)\n\n    # Pre-compute common terms to avoid re-calculation\n    production_term_denom = K + u_val\n    if production_term_denom == 0: # Avoid division by zero, although not expected with K0, u=0\n        production_term_denom = 1e-12\n\n    # State equation\n    dx_dt = (alpha * u_val / production_term_denom) - (delta * x)\n\n    # Forcing terms for sensitivity equations\n    df_dalpha = u_val / production_term_denom\n    df_dK = -alpha * u_val / (production_term_denom**2)\n    df_ddelta = -x\n\n    # Sensitivity equations\n    ds_alpha_dt = -delta * s_alpha + df_dalpha\n    ds_K_dt = -delta * s_K + df_dK\n    ds_delta_dt = -delta * s_delta + df_ddelta\n\n    return [dx_dt, ds_alpha_dt, ds_K_dt, ds_delta_dt]\n\ndef compute_fim_rank(alpha, K, delta, u_func, T, dt, sigma):\n    \"\"\"\n    Computes the Fisher Information Matrix and its rank for a given experiment.\n    \"\"\"\n    # Define time points for integration and evaluation\n    N = int(round(T / dt))\n    t_eval = np.linspace(0.0, T, N + 1)\n\n    # Initial conditions for the augmented system [x, S_alpha, S_K, S_delta]\n    z0 = [0.0, 0.0, 0.0, 0.0]\n\n    # Numerically integrate the system of ODEs\n    sol = solve_ivp(\n        dZ_dt,\n        [0, T],\n        z0,\n        args=(alpha, K, delta, u_func),\n        t_eval=t_eval,\n        method='RK45',\n        rtol=1e-6,\n        atol=1e-9\n    )\n\n    if not sol.success:\n        # If integration fails, we cannot compute the FIM.\n        # This implies extreme stiffness or other issues; rank is effectively 0.\n        return 0\n\n    # Extract sensitivity matrix S, shape (3, N+1)\n    sensitivities = sol.y[1:, :]\n\n    # Compute the Fisher Information Matrix (FIM)\n    # FIM = (1/sigma^2) * sum(S_i * S_i^T) = (1/sigma^2) * (S @ S.T)\n    fim = (1.0 / sigma**2) * (sensitivities @ sensitivities.T)\n\n    # Compute eigenvalues of the symmetric FIM\n    try:\n        # eigvalsh is preferred for symmetric matrices; returns sorted eigenvalues\n        eigvals = np.linalg.eigvalsh(fim)\n    except np.linalg.LinAlgError:\n        # This can happen if the FIM is numerically pathological\n        return 0\n\n    # Determine the rank based on the specified threshold\n    if len(eigvals) == 0:\n        return 0\n    lambda_max = eigvals[-1] # Largest eigenvalue\n\n    if lambda_max = 0.0:  # Handles the all-zero matrix case and numerical noise\n        return 0\n\n    threshold = 1e-8 * lambda_max\n    \n    # Count eigenvalues strictly greater than the threshold\n    rank = np.sum(eigvals > threshold)\n\n    return int(rank)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path)\n        {\n            'params': {'alpha': 4.0, 'K': 1.5, 'delta': 0.4},\n            'step_input': {'U0': 1.0},\n            'sine_input': {'U0': 1.0, 'A': 0.5, 'omega': 0.4},\n            'exp': {'T': 40.0, 'dt': 0.1, 'sigma': 0.05}\n        },\n        # Case 2 (edge case: slow dynamics with fast excitation)\n        {\n            'params': {'alpha': 4.0, 'K': 0.1, 'delta': 0.01},\n            'step_input': {'U0': 0.15},\n            'sine_input': {'U0': 0.15, 'A': 0.12, 'omega': 5.0},\n            'exp': {'T': 60.0, 'dt': 0.1, 'sigma': 0.05}\n        },\n        # Case 3 (boundary: near saturation regime)\n        {\n            'params': {'alpha': 4.0, 'K': 100.0, 'delta': 1.0},\n            'step_input': {'U0': 1.0},\n            'sine_input': {'U0': 1.0, 'A': 0.5, 'omega': 0.2},\n            'exp': {'T': 40.0, 'dt': 0.1, 'sigma': 0.05}\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Unpack parameters for clarity\n        params = case['params']\n        exp_params = case['exp']\n        alpha, K, delta = params['alpha'], params['K'], params['delta']\n        T, dt, sigma = exp_params['T'], exp_params['dt'], exp_params['sigma']\n        \n        case_ranks = []\n\n        # --- Process Step Input ---\n        step_params = case['step_input']\n        U0_step = step_params['U0']\n        u_step = lambda t: U0_step\n        rank_step = compute_fim_rank(alpha, K, delta, u_step, T, dt, sigma)\n        case_ranks.append(rank_step)\n\n        # --- Process Sinusoidal Input ---\n        sine_params = case['sine_input']\n        U0_sine, A, omega = sine_params['U0'], sine_params['A'], sine_params['omega']\n        u_sine = lambda t: U0_sine + A * np.sin(omega * t)\n        rank_sine = compute_fim_rank(alpha, K, delta, u_sine, T, dt, sigma)\n        case_ranks.append(rank_sine)\n        \n        all_results.append(case_ranks)\n\n    # Format the final output string exactly as specified\n    output_str = '[' + ','.join([f'[{r[0]},{r[1]}]' for r in all_results]) + ']'\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}