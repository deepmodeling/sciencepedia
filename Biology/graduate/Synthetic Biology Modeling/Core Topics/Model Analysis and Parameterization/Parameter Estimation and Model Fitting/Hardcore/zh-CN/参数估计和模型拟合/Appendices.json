{
    "hands_on_practices": [
        {
            "introduction": "参数估计的核心在于，给定一个数学模型和一组实验数据，如何找到最能描述该数据的模型参数值。最大似然估计（Maximum Likelihood Estimation, MLE）为此提供了一个强大而有原则的框架。本练习将通过一个在合成生物学中至关重要的基本任务——将相对荧光单位（arbitrary units, AU）校准为绝对分子数——来引导你推导并应用最大似然估计。通过解决这个看似简单但基础性的问题，你将掌握将统计学原理应用于实际生物测量数据的核心技能。",
            "id": "3925010",
            "problem": "使用流式细胞术测定一个合成基因线路的报告基因荧光强度（以任意单位 AU 表示），并在一个平行的校准实验中，使用内参标准品和单分子计数法对同一报告基因的每个细胞的绝对分子数进行量化。假设一个单参数尺度模型 $y_i = \\alpha x_i + \\varepsilon_i$，其中 $y_i$ 是每个细胞的绝对分子数，$x_i$ 是以 AU 为单位的荧光强度，$\\alpha$ 是一个将 AU 转换为分子数的恒定缩放参数，$\\varepsilon_i$ 是独立同分布的高斯噪声项，满足 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$。\n\n根据高斯概率密度函数和最大似然估计（MLE）的基本定义，在所述假设下推导出 $\\alpha$ 的最大似然估计，然后使用以下校准数据点 $(x_i,y_i)$ 计算其值：\n$(x_1,y_1) = (1200,24)$，\n$(x_2,y_2) = (2500,52)$，\n$(x_3,y_3) = (4000,81)$，\n$(x_4,y_4) = (5500,110)$，\n$(x_5,y_5) = (7000,141)$。\n\n简要解释这个单参数尺度模型如何与合成生物学检测中将荧光测量值转换为分子数相关，包括背景扣除和噪声结构的任何影响。请用“分子数/AU”为单位表示你对 $\\alpha$ 的最终估计，并将答案四舍五入至六位有效数字。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、是良定的，并且所有必要信息均已提供。\n\n### 第1步：提取已知条件\n- **模型：** 单参数尺度模型 $y_i = \\alpha x_i + \\varepsilon_i$。\n- **变量：**\n    - $y_i$：报告基因的每个细胞绝对分子数。\n    - $x_i$：任意单位（AU）的荧光强度。\n- **参数：**\n    - $\\alpha$：一个恒定的缩放参数（从 AU 到分子数的转换因子）。\n- **噪声项：**\n    - $\\varepsilon_i$：独立同分布（i.i.d.）的高斯噪声项。\n    - 噪声分布：$\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$，其中均值为 $0$，方差为常数 $\\sigma^2$。\n- **数据点 $(x_i, y_i)$：**\n    - $(x_1, y_1) = (1200, 24)$\n    - $(x_2, y_2) = (2500, 52)$\n    - $(x_3, y_3) = (4000, 81)$\n    - $(x_4, y_4) = (5500, 110)$\n    - $(x_5, y_5) = (7000, 141)$\n- **任务：**\n    1.  根据高斯概率密度函数的定义推导 $\\alpha$ 的最大似然估计（MLE）。\n    2.  使用所提供的数据计算 $\\alpha$ 的数值，并四舍五入至六位有效数字。\n    3.  简要解释该模型的意义，包括背景扣除和噪声结构的影响。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题在科学上是合理的。它描述了定量生物学，特别是合成生物学中的一个标准校准程序，其中报告蛋白的荧光与绝对分子数相关联。线性模型是一种常见且有效的一阶近似，而高斯噪声的假设是最大似然估计的一个标准出发点。\n- **良定性：** 该问题是良定的。它要求在一个明确定义的统计模型中，利用足够的数据来估计单个参数的最大似然值。存在一个唯一的解，并且可以被推导出来。\n- **客观性与完整性：** 该问题以客观、正式的语言陈述。所有必要的数据、定义和假设（线性模型、独立同分布的高斯噪声）都已提供。它是自洽的。\n\n### 第3步：结论与行动\n该问题被判定为**有效**。将按要求进行解答的推导和计算。\n\n### 解答推导\n第 $i$ 个观测值的模型由 $y_i = \\alpha x_i + \\varepsilon_i$ 给出。噪声项 $\\varepsilon_i$ 被假定为独立同分布，遵循均值为 $0$、方差为 $\\sigma^2$ 的高斯分布，即 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n从该模型中，我们可以将误差项写为 $\\varepsilon_i = y_i - \\alpha x_i$。单个误差项 $\\varepsilon_i$ 的概率密度函数（PDF）为：\n$$P(\\varepsilon_i | \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{\\varepsilon_i^2}{2\\sigma^2}\\right)$$\n代入 $\\varepsilon_i = y_i - \\alpha x_i$，在给定 $x_i$ 和参数 $\\alpha$、$\\sigma^2$ 的条件下，观测到特定 $y_i$ 的概率为：\n$$P(y_i | x_i, \\alpha, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - \\alpha x_i)^2}{2\\sigma^2}\\right)$$\n这是一个随机变量 $Y_i \\sim \\mathcal{N}(\\alpha x_i, \\sigma^2)$ 的概率密度函数。\n\n似然函数 $L(\\alpha, \\sigma^2)$ 是观测到整个数据集的联合概率，该数据集由 $n$ 个独立的数据点组成。它是各个概率的乘积：\n$$L(\\alpha, \\sigma^2 | \\mathbf{y}, \\mathbf{x}) = \\prod_{i=1}^{n} P(y_i | x_i, \\alpha, \\sigma^2) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - \\alpha x_i)^2}{2\\sigma^2}\\right)$$\n$$L(\\alpha, \\sigma^2) = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} (y_i - \\alpha x_i)^2\\right)$$\n为了找到 $\\alpha$ 的最大似然估计（MLE），我们对 $L$ 关于 $\\alpha$ 进行最大化。在计算上，最大化似然函数的自然对数，即对数似然 $\\ln L$，更为简单，因为对数是单调递增函数。\n$$\\ln L(\\alpha, \\sigma^2) = \\ln\\left[ \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} (y_i - \\alpha x_i)^2\\right) \\right]$$\n$$\\ln L(\\alpha, \\sigma^2) = -\\frac{n}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} (y_i - \\alpha x_i)^2$$\n为了找到使该函数最大化的 $\\alpha$ 值，我们求其关于 $\\alpha$ 的偏导数，并令其为零。\n$$\\frac{\\partial (\\ln L)}{\\partial \\alpha} = \\frac{\\partial}{\\partial \\alpha} \\left[ -\\frac{n}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} (y_i - \\alpha x_i)^2 \\right]$$\n第一项相对于 $\\alpha$ 是常数。我们对第二项应用链式法则：\n$$\\frac{\\partial (\\ln L)}{\\partial \\alpha} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} \\frac{\\partial}{\\partial \\alpha} (y_i - \\alpha x_i)^2 = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} 2(y_i - \\alpha x_i)(-x_i)$$\n$$\\frac{\\partial (\\ln L)}{\\partial \\alpha} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} x_i(y_i - \\alpha x_i) = \\frac{1}{\\sigma^2} \\left( \\sum_{i=1}^{n} x_i y_i - \\alpha \\sum_{i=1}^{n} x_i^2 \\right)$$\n将导数设为零以求得 MLE，我们将其记为 $\\hat{\\alpha}_{MLE}$：\n$$\\frac{1}{\\sigma^2} \\left( \\sum_{i=1}^{n} x_i y_i - \\hat{\\alpha}_{MLE} \\sum_{i=1}^{n} x_i^2 \\right) = 0$$\n因为 $\\sigma^2 > 0$，我们必须有：\n$$\\sum_{i=1}^{n} x_i y_i - \\hat{\\alpha}_{MLE} \\sum_{i=1}^{n} x_i^2 = 0$$\n解出 $\\hat{\\alpha}_{MLE}$，得到估计量的最终表达式：\n$$\\hat{\\alpha}_{MLE} = \\frac{\\sum_{i=1}^{n} x_i y_i}{\\sum_{i=1}^{n} x_i^2}$$\n值得注意的是，该结果与强制通过原点的线性回归模型的普通最小二乘（OLS）估计量相同。这种等价性之所以出现，是因为独立同分布高斯噪声的假设使得最大化似然等同于最小化残差平方和 $\\sum (y_i - \\alpha x_i)^2$。\n\n### 数值计算\n我们有 $n=5$ 个数据点。现在我们计算必要的和 $\\sum_{i=1}^{5} x_i y_i$ 和 $\\sum_{i=1}^{5} x_i^2$。\n- $\\sum x_i y_i$ 的计算：\n$x_1 y_1 = 1200 \\times 24 = 28800$\n$x_2 y_2 = 2500 \\times 52 = 130000$\n$x_3 y_3 = 4000 \\times 81 = 324000$\n$x_4 y_4 = 5500 \\times 110 = 605000$\n$x_5 y_5 = 7000 \\times 141 = 987000$\n$$\\sum_{i=1}^{5} x_i y_i = 28800 + 130000 + 324000 + 605000 + 987000 = 2074800$$\n- $\\sum x_i^2$ 的计算：\n$x_1^2 = 1200^2 = 1440000$\n$x_2^2 = 2500^2 = 6250000$\n$x_3^2 = 4000^2 = 16000000$\n$x_4^2 = 5500^2 = 30250000$\n$x_5^2 = 7000^2 = 49000000$\n$$\\sum_{i=1}^{5} x_i^2 = 1440000 + 6250000 + 16000000 + 30250000 + 49000000 = 102940000$$\n- 计算 $\\hat{\\alpha}_{MLE}$：\n$$\\hat{\\alpha}_{MLE} = \\frac{2074800}{102940000} \\approx 0.0201554303...$$\n四舍五入到六位有效数字，我们得到：\n$$\\hat{\\alpha}_{MLE} \\approx 0.0201554$$\n\n### 模型的意义与启示\n单参数尺度模型 $y = \\alpha x$ 是校准合成生物学和其他定量生命科学中荧光测量的基本工具。它提供了一种将相对的、依赖于仪器的荧光单位（AU）转换为绝对的、具有物理意义的单位（如每个细胞的分子数）的方法。参数 $\\alpha$ 是校准常数，表示一个任意荧光单位对应的分子数量。\n\n- **背景扣除的意义：** 模型 $y = \\alpha x$ 是一个通过原点的回归，这意味着它假设零荧光强度（$x=0$）对应于零分子数（$y=0$）。在实践中，即使没有报告蛋白的细胞也会表现出背景荧光（自发荧光），并且仪器也存在暗电流噪声。因此，该模型隐含地假设荧光数据 $x_i$ 已经对这种背景进行了校正（例如，通过减去阴性对照群体的平均荧光值）。一个更复杂的模型 $y_i = \\alpha x_i + \\beta$ 会估计截距 $\\beta$，这可能捕捉到残留的背景效应。选择强制截距为零是一种常见且通常合理的简化。\n\n- **噪声结构的意义：** 该模型假设误差 $\\varepsilon_i$ 服从具有恒定方差 $\\sigma^2$ 的高斯分布（同方差性）。这意味着无论信号强度大小，噪声水平都被假定为是相同的。在许多生物物理测量中，包括流式细胞术中的光子计数，噪声通常是信号依赖的（异方差性）。例如，散粒噪声遵循泊松分布，其方差等于信号均值。虽然恒定方差高斯假设是一种方便的简化，它导出了直接的最小二乘结果，但更高级的分析可能会使用加权最小二乘法（WLS），其中具有较高预期方差的数据点（例如，更亮的细胞）在拟合中被赋予较小的权重。然而，对于许多应用而言，未加权模型提供了足够精确的缩放因子估计。",
            "answer": "$$\\boxed{0.0201554}$$"
        },
        {
            "introduction": "理想化的模型假设（如高斯噪声）在面对真实的实验数据时常常会受到挑战。显微成像等技术中偶尔出现的伪影，如饱和像素或杂散光，会产生“离群点”（outliers），这些离群点会严重扭曲基于最小二乘法的参数估计结果。为了解决这个问题，我们需要“稳健”（robust）的估计方法。本练习将介绍Huber损失函数，这是一种巧妙的设计，它能在处理常规噪声时表现得像二次损失（$L_2$），而在面对离群点时则切换为线性损失（$L_1$），从而有效降低极端数据点对拟合结果的过度影响。",
            "id": "3924986",
            "problem": "通过落射荧光显微镜监测细菌基因回路中的一个合成启动子。确定性模型预测了在给定输入 $x_i$ 和参数 $\\boldsymbol{\\theta} \\in \\mathbb{R}^p$ 的情况下，荧光输出为 $y_i^{\\text{mod}} = g(x_i; \\boldsymbol{\\theta})$。由于测量噪声和偶然的成像伪影（如饱和像素和灰尘引起的眩光），观测到的荧光 $y_i$ 会偏离 $y_i^{\\text{mod}}$。设残差为 $r_i(\\boldsymbol{\\theta}) = y_i - g(x_i; \\boldsymbol{\\theta})$。您将通过最小化 $\\sum_{i=1}^n \\rho(r_i(\\boldsymbol{\\theta}))$ 来拟合 $\\boldsymbol{\\theta}$，其中 $\\rho(\\cdot)$ 是一个选定的损失函数。\n\n根据参数估计和模型拟合的基本原理：\n- 在方差为 $\\sigma^2$ 的独立同分布高斯噪声下，残差的负对数似然与 $\\sum_i r_i^2$ 成正比，因此最小二乘法是最大似然（ML）估计器。\n- 在尺度参数为 $b$ 的独立同分布拉普拉斯噪声下，负对数似然与 $\\sum_i |r_i|$ 成正比，因此最小绝对偏差是 ML 估计器。\n- 成像伪影会引起重尾偏差，因此对大残差具有有界影响的估计器可能是有利的。\n\n考虑使用 Huber 损失来获得一个在平方损失和绝对损失行为之间插值的稳健估计器。下列哪些陈述是正确的？\n\nA. 对于调节参数 $\\delta > 0$，Huber 损失 $\\rho_\\delta(r)$ 定义为\n$$\n\\rho_\\delta(r) = \n\\begin{cases}\n\\dfrac{1}{2} r^2,  |r| \\le \\delta,\\\\\n\\delta \\left(|r| - \\dfrac{1}{2}\\delta \\right),  |r| > \\delta,\n\\end{cases}\n$$\n因此它在 $r=0$ 附近是二次的，在尾部是线性的。\n\nB. 导数 $\\psi_\\delta(r) = \\dfrac{d}{dr}\\rho_\\delta(r)$ 在 $|r| \\le \\delta$ 时等于 $r$，在 $|r| > \\delta$ 时等于 $\\delta \\,\\mathrm{sign}(r)$，这限制了大残差的影响，并产生对离群点的稳健性。\n\nC. 如果残差是独立同分布的高斯分布，那么最小化 Huber 损失会得到 $\\boldsymbol{\\theta}$ 的精确最大似然（ML）估计器。\n\nD. 在存在罕见饱和像素（产生极大 $|r_i|$）的荧光成像中，选择一个适度的 $\\delta$ 可以在保留小残差的近高斯效率的同时，降低饱和离群点的权重，从而相对于纯最小二乘法改善参数估计。\n\nE. 取极小的 $\\delta$ 总会同时增加高斯效率和稳健性，因为它会积极地降低所有残差的权重。\n\nF. Huber 损失是非凸的，并且这种非凸性对于在稳健模型拟合中避免局部最小值至关重要。\n\n选择所有适用的选项。",
            "solution": "该问题要求评估关于 Huber 损失函数的几个陈述，这些陈述是在一个合成生物学模型的参数估计背景下提出的，该模型的数据同时受到标准测量噪声和偶然的大伪影的干扰。\n\n问题的核心在于理解稳健估计。目标是找到对观测值 $y_i$ 中一小部分大误差（离群点）不敏感的参数 $\\boldsymbol{\\theta}$。这是通过为残差 $r_i = y_i - g(x_i; \\boldsymbol{\\theta})$ 选择一个损失函数 $\\rho(\\cdot)$ 来实现的，该函数对于大的 $|r|$ 值的增长速度比平方损失 $\\rho(r) = r^2$ 慢。平方损失虽然对于纯高斯噪声是最优的（因为它能导出最大似然估计器），但它给了离群点无界的影响，因为最小化 $\\sum_i r_i^2$ 对任何单个大的 $r_i$ 都高度敏感。\n\nHuber 损失函数 $\\rho_\\delta(r)$ 是一种广泛使用的稳健损失函数，它在平方误差损失（对高斯噪声有效）和绝对误差损失（对离群点稳健）之间提供了一种折衷。我们将分析其性质以评估给定的陈述。\n\n**选项 A：对于调节参数 $\\delta > 0$，Huber 损失 $\\rho_\\delta(r)$ 定义为...**\n该陈述给出了定义：\n$$\n\\rho_\\delta(r) = \n\\begin{cases}\n\\dfrac{1}{2} r^2,  |r| \\le \\delta,\\\\\n\\delta \\left(|r| - \\dfrac{1}{2}\\delta \\right),  |r| > \\delta,\n\\end{cases}\n$$\n这确实是 Huber 损失函数的标准定义。它对于小残差（在 $\\pm\\delta$ 内）表现为二次函数，对于大残差表现为线性函数。我们来验证其在过渡点 $|r| = \\delta$ 处的连续性。\n对于 $|r| = \\delta$，二次部分的值为 $\\frac{1}{2}\\delta^2$。\n对于 $|r| = \\delta$，线性部分的值为 $\\delta(\\delta - \\frac{1}{2}\\delta) = \\delta(\\frac{1}{2}\\delta) = \\frac{1}{2}\\delta^2$。\n由于值匹配，该函数是连续的。关于它在 $r=0$ 附近是二次的，在尾部是线性的描述也是准确的。\n结论：**正确**。\n\n**选项 B：导数 $\\psi_\\delta(r) = \\dfrac{d}{dr}\\rho_\\delta(r)$ 在 $|r| \\le \\delta$ 时等于 $r$，在 $|r| > \\delta$ 时等于 $\\delta \\,\\mathrm{sign}(r)$，这限制了大残差的影响，并产生对离群点的稳健性。**\n我们计算选项 A 中定义的 Huber 损失函数的导数。\n对于 $|r|  \\delta$，$\\dfrac{d}{dr}\\left(\\dfrac{1}{2}r^2\\right) = r$。\n对于 $r > \\delta$，$\\dfrac{d}{dr}\\left(\\delta \\left(r - \\dfrac{1}{2}\\delta \\right)\\right) = \\delta$。\n对于 $r  -\\delta$，我们有 $|r| = -r$，因此我们对 $\\delta \\left(-r - \\dfrac{1}{2}\\delta \\right)$ 求导，得到 $-\\delta$。\n这些可以紧凑地写作 $\\psi_\\delta(r) = \\delta \\cdot \\mathrm{sign}(r)$，对于 $|r| > \\delta$。\n在 $r = \\delta$ 处，左导数是 $\\delta$，右导数也是 $\\delta$。同样，在 $r = -\\delta$ 处也是如此。因此，导数是连续的，可以表示为：\n$$\n\\psi_\\delta(r) = \\text{clip}(r, -\\delta, \\delta) = \\min(\\delta, \\max(-\\delta, r)) =\n\\begin{cases}\nr,  |r| \\le \\delta, \\\\\n\\delta \\cdot \\mathrm{sign}(r),  |r| > \\delta.\n\\end{cases}\n$$\n在 M-估计的背景下，$\\psi(r)$ 是影响函数。对于最小二乘法，$\\psi(r) = r$，这是无界的。对于 Huber 损失，任何单个残差的影响都被限制在 $[-\\delta, \\delta]$ 范围内。影响函数的这种有界性是估计器对离群点稳健性的数学基础。大残差不会对参数估计产生任意大的拉动。\n结论：**正确**。\n\n**选项 C：如果残差是独立同分布的高斯分布，那么最小化 Huber 损失会得到 $\\boldsymbol{\\theta}$ 的精确最大似然（ML）估计器。**\n对于来自均值为 $0$、方差为 $\\sigma^2$ 的高斯分布的独立同分布样本，负对数似然（不计常数）为：\n$$\n-\\sum_{i=1}^n \\log\\left(\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp\\left(-\\frac{r_i^2}{2\\sigma^2}\\right)\\right) = \\sum_{i=1}^n \\left(\\frac{r_i^2}{2\\sigma^2} + \\text{const}\\right) \\propto \\sum_{i=1}^n r_i^2.\n$$\n因此，对于高斯噪声，ML 估计器是最小二乘估计器，这对应于纯二次损失函数，$\\rho(r) \\propto r^2$。只有当选择的 $\\delta$ 大于所有残差的绝对值时，Huber 损失才是纯二次的，而通常情况并非如此。对于任何有限的 $\\delta$ 且有部分残差超过它时，Huber 损失就不是纯二次的。因此，最小化 Huber 损失并不能得到高斯分布的精确 ML 估计器。它是另一个分布的 ML 估计器，该分布的概率密度函数 $p(r)$ 与 $\\exp(-\\rho_\\delta(r))$ 成正比。\n结论：**错误**。\n\n**选项 D：在存在罕见饱和像素（产生极大 $|r_i|$）的荧光成像中，选择一个适度的 $\\delta$ 可以在保留小残差的近高斯效率的同时，降低饱和离群点的权重，从而相对于纯最小二乘法改善参数估计。**\n这个陈述正确地描述了 Huber 损失的实际效用。问题指出，噪声有两个组成部分：标准测量噪声（通常可以很好地用高斯分布近似）和导致重尾分布的罕见伪影（离群点）。\n- 对于小残差（$|r_i| \\le \\delta$），这些残差大概对应于标准测量噪声，Huber 损失是二次的。这模仿了最优的最小二乘损失，从而为数据的“行为良好”部分保持了高统计效率（即参数估计的低方差）。这就是“近高斯效率”所指的。\n- 对于大残差（$|r_i| > \\delta$），这些残差对应于离群点，损失变为线性的。与最小二乘法的平方损失相比，线性损失的增长速度慢得多，从而“降低”了这些离群点的影响。\n这种组合使得估计器能够抵抗像饱和像素这样的伪影的破坏性影响，从而得到比纯最小二乘法更准确和稳定的参数估计，因为纯最小二乘法会受到此类离群点的严重扭曲。\n结论：**正确**。\n\n**选项 E：取极小的 $\\delta$ 总会同时增加高斯效率和稳健性，因为它会积极地降低所有残差的权重。**\n这个陈述误解了选择 $\\delta$ 时固有的权衡。\n- **稳健性**：当 $\\delta \\to 0$ 时，Huber 损失 $\\rho_\\delta(r)$ 更接近于绝对损失 $|r|$（在缩放因子内）。最小绝对偏差（$L_1$）估计器是高度稳健的。所以，减小 $\\delta$ 会增加稳健性。\n- **高斯效率**：这指的是当底层噪声确实是高斯分布时，估计器的统计效率。在这种情况下，最有效的估计器是最小二乘估计器，它对应于 $\\delta \\to \\infty$。随着 $\\delta$ 的减小，Huber 估计器偏离最小二乘估计器的程度越大，其在高斯数据上的效率就越低。$L_1$ 估计器（$\\delta \\to 0$）在高斯数据上的效率仅为最小二乘估计器的大约 $64\\%$。\n因此，减小 $\\delta$ 会增加稳健性，但会*降低*高斯效率。通过改变 $\\delta$，这两个属性不能同时增加。存在一个根本性的权衡。\n结论：**错误**。\n\n**F. Huber 损失是非凸的，并且这种非凸性对于在稳健模型拟合中避免局部最小值至关重要。**\n这个陈述在两个基本点上是错误的。\n1.  **Huber 损失的凸性**：Huber 损失函数是凸函数。在其定义域内，其二阶导数在 $|r|  \\delta$ 时为 $\\rho''_\\delta(r) = 1$，在 $|r| > \\delta$ 时为 $\\rho''_\\delta(r) = 0$。由于在二阶导数有定义的所有点上都有 $\\rho''_\\delta(r) \\ge 0$，并且其一阶导数 $\\psi_\\delta(r)$ 是连续且单调不减的，所以函数 $\\rho_\\delta(r)$ 是凸的。\n2.  **凸性与局部最小值**：在优化中，凸性是一个非常理想的性质。对于一个凸函数，任何局部最小值都保证是全局最小值。这极大地简化了优化问题。而非凸函数则可能存在多个非全局最优的局部最小值，使得寻找真正最优解变得具有挑战性。该陈述声称非凸性对于*避免*局部最小值是至关重要的，这与事实正好相反。\n结论：**错误**。",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "在许多复杂的生物学系统中，我们不仅想知道参数的最佳点估计，更希望全面地刻画参数的不确定性。贝叶斯推断（Bayesian inference）通过计算参数的后验分布（posterior distribution）来完整地回答这个问题，这对于理解模型的预测能力和指导实验设计至关重要。对于由常微分方程（ODEs）描述的动态模型，进行贝叶斯推断通常需要复杂的计算方法。本练习  将带你探索汉密尔顿蒙特卡洛（Hamiltonian Monte Carlo, HMC）这一前沿算法，它是从复杂高维后验分布中进行高效采样的黄金标准之一。你将学习如何为动态系统模型构建HMC框架，理解其背后的物理直觉，并认识到梯度计算（如伴随法）在现代贝叶斯建模中的核心作用。",
            "id": "3925022",
            "problem": "一个合成生物学基因表达模型被构建为一个常微分方程组 (ODEs)，其中信使核糖核酸 (mRNA) 浓度 $m(t)$ 和蛋白质浓度 $p(t)$ 的演化遵循\n$$\n\\frac{dm}{dt} = \\alpha - \\delta_m m, \\qquad \\frac{dp}{dt} = \\beta m - \\delta_p p,\n$$\n其中参数 $\\theta = (\\alpha,\\beta,\\delta_m,\\delta_p)$ 和初始条件 $m(0)$ 和 $p(0)$ 已知。在时间点 $t_k$，$k=1,\\dots,n$ 采集蛋白质浓度的观测值 $y_k$，这些观测值带有方差为 $\\sigma^2$ 的加性高斯测量噪声，因此 $y_k = p(t_k;\\theta) + \\varepsilon_k$，其中 $\\varepsilon_k \\sim \\mathcal{N}(0,\\sigma^2)$ 是独立同分布的。一个先验分布 $p(\\theta)$ 代表了关于可行速率的生物学知识，我们寻求通过马尔可夫链蒙特卡洛 (MCMC) 对 $\\theta$ 进行贝叶斯推断。\n\n根据贝叶斯法则，后验密度满足 $p(\\theta \\mid y) \\propto p(y \\mid \\theta)\\,p(\\theta)$，其中 $y=(y_1,\\dots,y_n)$，$p(y \\mid \\theta)$ 是由ODE解和高斯噪声模型导出的似然。考虑使用哈密顿蒙特卡洛 (HMC) 和一个对称正定质量矩阵 $M$ 从 $p(\\theta \\mid y)$ 中采样。在HMC中，正则坐标 $(\\theta,p)$ 引入了一个辅助动量 $p$ 和一个哈密顿量 $H(\\theta,p)$，该哈密顿量分解为一个势能 $U(\\theta)$ 和一个动能 $K(p)$，通过对哈密顿动力学进行数值积分来驱动确定性的提议。需要计算关于 $\\theta$ 的梯度；对于基于ODE的似然，这些梯度是通过伴随灵敏度方法获得的，该方法中，一个时间反向的伴随方程被积分，并在观测时间点处带有跳跃条件，源项则由测量残差导出，最终得到 $\\nabla_{\\theta}\\log p(y \\mid \\theta)$。像蛙跳法这样的辛积分器使用步长 $\\varepsilon>0$ 和质量矩阵 $M$ 来演化 $(\\theta,p)$ 并保持体积和可逆性。\n\n对于这个基于ODE的合成生物学模型，哪个选项正确地指定了势能 $U(\\theta)$、动能 $K(p)$ 以及根据通过伴随方法计算的 $\\nabla_{\\theta}\\log p(\\theta \\mid y)$ 进行的蛙跳法更新？\n\nA. $U(\\theta) = -\\big(\\log p(y \\mid \\theta) + \\log p(\\theta)\\big)$ 在相差一个加性常数的情况下成立；$K(p) = \\tfrac{1}{2} p^{\\top} M^{-1} p$；步长为 $\\varepsilon$ 的蛙跳法：\n首先 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M^{-1} p$，接着 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$；其中 $\\nabla_{\\theta} U(\\theta) = -\\nabla_{\\theta} \\log p(\\theta \\mid y)$，而 $\\nabla_{\\theta}\\log p(y \\mid \\theta)$ 通过伴随灵敏度方法计算，并从先验中加上 $\\nabla_{\\theta}\\log p(\\theta)$。\n\nB. $U(\\theta) = \\log p(\\theta \\mid y)$；$K(p) = \\tfrac{1}{2} p^{\\top} M p$；步长为 $\\varepsilon$ 的蛙跳法：\n首先 $p \\leftarrow p + \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M p$，接着 $p \\leftarrow p + \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$；其中 $\\nabla_{\\theta} U(\\theta)$ 通过ODE的伴随方法计算。\n\nC. 仅 $U(\\theta) = -\\log p(y \\mid \\theta)$；$K(p) = \\tfrac{1}{2} p^{\\top} M^{-1} p$；步长为 $\\varepsilon$ 的蛙跳法：\n首先 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} \\log p(\\theta \\mid y)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M^{-1} p$，接着 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} \\log p(\\theta \\mid y)$；其中 $\\nabla_{\\theta} \\log p(\\theta \\mid y)$ 通过ODE解的前向灵敏度计算。\n\nD. $U(\\theta) = -\\log p(\\theta \\mid y)$；$K(p) = \\tfrac{1}{2} p^{\\top} p$；步长为 $\\varepsilon$ 的蛙跳法：\n首先 $\\theta \\leftarrow \\theta + \\tfrac{\\varepsilon}{2}\\, p$，然后 $p \\leftarrow p - \\varepsilon\\,\\nabla_{\\theta} U(\\theta)$，接着 $\\theta \\leftarrow \\theta + \\tfrac{\\varepsilon}{2}\\, p$；其中 $\\nabla_{\\theta} U(\\theta)$ 通过 $\\log p(\\theta \\mid y)$ 的有限差分近似。",
            "solution": "该问题要求为一个由常微分方程组 (ODEs) 描述的合成生物学模型，确定用于参数贝叶斯推断的哈密顿蒙特卡洛 (HMC) 算法的正确表述。让我们根据第一性原理和问题描述来推导HMC算法的各个组成部分。\n\n贝叶斯推断的目标是从参数 $\\theta$ 的后验分布中采样，该后验分布由贝叶斯法则给出：\n$$\np(\\theta \\mid y) \\propto p(y \\mid \\theta) \\, p(\\theta)\n$$\n其中 $y = (y_1, \\dots, y_n)$ 代表观测数据。\n\n哈密顿蒙特卡洛是一种马尔可夫链蒙特卡洛 (MCMC) 方法，它使用哈密顿动力学的框架来提议新状态。它定义了一个相空间，坐标为 $(\\theta, p)$，其中 $\\theta$ 是感兴趣的参数（位置），而 $p$ 是一个与 $\\theta$ 维度相同的辅助动量变量。\n\n哈密顿量 $H(\\theta, p)$ 定义为一个势能 $U(\\theta)$ 和一个动能 $K(p)$ 的和：\n$$\nH(\\theta, p) = U(\\theta) + K(p)\n$$\n\n**1. 势能 $U(\\theta)$**\n在HMC中，势能 $U(\\theta)$ 被定义为目标概率密度函数的负对数，可相差一个加性常数。目标密度是后验分布 $p(\\theta \\mid y)$。\n$$\nU(\\theta) = -\\log p(\\theta \\mid y) + C_1\n$$\n其中 $C_1$ 是任意常数。使用贝叶斯法则中的后验表达式：\n$$\nU(\\theta) = -\\log \\big(p(y \\mid \\theta) \\, p(\\theta)\\big) + C_2 = -\\big(\\log p(y \\mid \\theta) + \\log p(\\theta)\\big) + C_2\n$$\n常数不影响动力学，通常被省略。因此，势能为：\n$$\nU(\\theta) = -\\big(\\log p(y \\mid \\theta) + \\log p(\\theta)\\big)\n$$\n\n**2. 动能 $K(p)$**\n动量 $p$ 通常从一个独立于 $\\theta$ 的零均值高斯分布中抽取。动能被定义为该高斯分布密度的负对数。对于一个协方差矩阵为 $M$ 的一般多元高斯分布，其密度为 $p(p) \\propto \\exp(-\\frac{1}{2} p^{\\top} M^{-1} p)$。质量矩阵 $M$ 是一个对称正定矩阵，可以进行调整以提高采样效率。因此，动能为：\n$$\nK(p) = \\frac{1}{2} p^{\\top} M^{-1} p\n$$\n\n**3. 哈密顿动力学与蛙跳积分器**\n系统在相空间中的演化由哈密顿方程控制：\n$$\n\\frac{d\\theta_i}{dt} = \\frac{\\partial H}{\\partial p_i} = \\frac{\\partial K}{\\partial p_i} \\implies \\frac{d\\theta}{dt} = \\nabla_p K(p) = M^{-1} p\n$$\n$$\n\\frac{dp_i}{dt} = -\\frac{\\partial H}{\\partial \\theta_i} = -\\frac{\\partial U}{\\partial \\theta_i} \\implies \\frac{dp}{dt} = -\\nabla_{\\theta} U(\\theta)\n$$\n为了模拟这些动力学，使用了一个数值积分器。蛙跳法（或Störmer-Verlet方法）是一个常见的选择，因为它是一个辛积分器，能够保持相空间体积并且是时间可逆的。标准蛙跳积分器（特别是速度-Verlet变体）的一个步长为 $\\varepsilon$ 的单步包含三次更新：\n1.  对动量进行半步更新：$p \\leftarrow p - \\frac{\\varepsilon}{2} \\nabla_{\\theta} U(\\theta)$。\n2.  对位置进行全步更新：$\\theta \\leftarrow \\theta + \\varepsilon M^{-1} p$。\n3.  使用新位置处的梯度对动量进行最后的半步更新：$p \\leftarrow p - \\frac{\\varepsilon}{2} \\nabla_{\\theta} U(\\theta)$。\n\n**4. 梯度项 $\\nabla_{\\theta} U(\\theta)$**\n动量更新需要势能的梯度。\n$$\n\\nabla_{\\theta} U(\\theta) = \\nabla_{\\theta} \\left( -\\big(\\log p(y \\mid \\theta) + \\log p(\\theta)\\big) \\right) = -\\left( \\nabla_{\\theta} \\log p(y \\mid \\theta) + \\nabla_{\\theta} \\log p(\\theta) \\right)\n$$\n这等价于 $\\nabla_{\\theta} U(\\theta) = -\\nabla_{\\theta} \\log p(\\theta \\mid y)$。问题陈述指出，似然梯度 $\\nabla_{\\theta} \\log p(y \\mid \\theta)$ 是使用伴随灵敏度方法计算的，并且必须加上对数先验的梯度 $\\nabla_{\\theta} \\log p(\\theta)$。这与我们的推导完全一致。\n\n**逐项分析**\n\nA. **$U(\\theta) = -\\big(\\log p(y \\mid \\theta) + \\log p(\\theta)\\big)$ 在相差一个加性常数的情况下成立；$K(p) = \\tfrac{1}{2} p^{\\top} M^{-1} p$；步长为 $\\varepsilon$ 的蛙跳法：首先 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M^{-1} p$，接着 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$；其中 $\\nabla_{\\theta} U(\\theta) = -\\nabla_{\\theta} \\log p(\\theta \\mid y)$，而 $\\nabla_{\\theta}\\log p(y \\mid \\theta)$ 通过伴随灵敏度方法计算，并从先验中加上 $\\nabla_{\\theta}\\log p(\\theta)$。**\n-   势能 $U(\\theta)$ 被正确指定为负对数后验。\n-   动能 $K(p)$ 被正确指定，使用了逆质量矩阵 $M^{-1}$。\n-   蛙跳法更新是标准的速度-Verlet实现，这是正确的。\n-   关于如何计算梯度 $\\nabla_{\\theta} U(\\theta)$ 的描述与其定义以及问题陈述中给出的信息一致。\n-   **结论：正确。**\n\nB. **$U(\\theta) = \\log p(\\theta \\mid y)$；$K(p) = \\tfrac{1}{2} p^{\\top} M p$；步长为 $\\varepsilon$ 的蛙跳法：首先 $p \\leftarrow p + \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M p$，接着 $p \\leftarrow p + \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$；其中 $\\nabla_{\\theta} U(\\theta)$ 通过ODE的伴随方法计算。**\n-   势能 $U(\\theta)$ 的符号错误。它应该是负对数后验。\n-   动能 $K(p)$ 使用了 $M$ 而不是 $M^{-1}$。这是一个非标准的形式，与标准的HMC推导不一致。\n-   动量的蛙跳法更新符号错误（`+` 而不是 `-`）。\n-   **结论：错误。**\n\nC. **仅 $U(\\theta) = -\\log p(y \\mid \\theta)$；$K(p) = \\tfrac{1}{2} p^{\\top} M^{-1} p$；步长为 $\\varepsilon$ 的蛙跳法：首先 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} \\log p(\\theta \\mid y)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M^{-1} p$，接着 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} \\log p(\\theta \\mid y)$；其中 $\\nabla_{\\theta} \\log p(\\theta \\mid y)$ 通过ODE解的前向灵敏度计算。**\n-   势能 $U(\\theta)$ 不完整；它忽略了先验项 $\\log p(\\theta)$。这将导致从似然而不是后验进行采样。\n-   梯度计算方法的描述（“前向灵敏度”）与问题陈述中指定的“伴随灵敏度方法”相矛盾。\n-   该选项内部存在矛盾：$U(\\theta)$ 仅基于似然定义，但蛙跳法更新却使用了对数后验的梯度 $\\nabla_{\\theta} \\log p(\\theta \\mid y)$。\n-   **结论：错误。**\n\nD. **$U(\\theta) = -\\log p(\\theta \\mid y)$；$K(p) = \\tfrac{1}{2} p^{\\top} p$；步长为 $\\varepsilon$ 的蛙跳法：首先 $\\theta \\leftarrow \\theta + \\tfrac{\\varepsilon}{2}\\, p$，然后 $p \\leftarrow p - \\varepsilon\\,\\nabla_{\\theta} U(\\theta)$，接着 $\\theta \\leftarrow \\theta + \\tfrac{\\varepsilon}{2}\\, p$；其中 $\\nabla_{\\theta} U(\\theta)$ 通过 $\\log p(\\theta \\mid y)$ 的有限差分近似。**\n-   势能 $U(\\theta)$ 被正确地表述为 $-\\log p(\\theta \\mid y)$。\n-   动能 $K(p)$ 是质量矩阵 $M$ 为单位矩阵（$M=I$）的特例。虽然这是一个有效的选择，但问题陈述指的是一个通用的对称正定质量矩阵 $M$。\n-   蛙跳法更新对应于一个有效的“位置-Verlet”变体，但它们特定于 $M=I$ 的情况。\n-   至关重要的是，计算梯度的方法（“通过有限差分近似”）直接与问题陈述中指定的“伴随灵敏度方法”相矛盾。\n-   **结论：错误。**\n\n基于详细分析，选项A是唯一一个为给定问题情境提供了完全正确且一致的HMC算法描述的选项。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}