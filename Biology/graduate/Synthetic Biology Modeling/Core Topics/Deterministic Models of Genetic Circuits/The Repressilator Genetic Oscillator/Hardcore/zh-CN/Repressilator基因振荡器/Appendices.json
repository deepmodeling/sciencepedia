{
    "hands_on_practices": [
        {
            "introduction": "在构建和分析任何科学领域的数学模型时，确保其量纲一致性是至关重要的一步。本练习  聚焦于量纲分析和变量替换，这是建模实践中的一项基本功。通过将抑制振荡器（Repressilator）模型的单位从分钟和微摩尔浓度转换到秒和纳摩尔浓度，你将练习如何严谨地推导模型参数在单位变换下的相应调整，从而确保模型的物理意义和数学正确性。",
            "id": "3937283",
            "problem": "考虑经典的三基因抑制振荡器 (Repressilator)，它被建模为一个六维常微分方程（ODE）系统，包含三种信使 RNA 浓度和三种蛋白质浓度。令 $m_{i}(t)$ 表示基因 $i$ 的信使 RNA 浓度，$p_{i}(t)$ 表示其蛋白质产物的浓度，其中 $i \\in \\{1,2,3\\}$。每个基因 $i$ 都被循环中前一个基因的蛋白质所抑制，因此基因 1 被 $p_{3}$ 抑制，基因 2 被 $p_{1}$ 抑制，基因 3 被 $p_{2}$ 抑制。该 ODE 模型的标准形式为\n$$\n\\frac{d m_{i}}{d t} \\;=\\; \\alpha \\, \\frac{1}{1 + \\left(\\frac{p_{j}}{K}\\right)^{n}} \\;-\\; \\gamma_{m} \\, m_{i}, \\qquad\n\\frac{d p_{i}}{d t} \\;=\\; \\beta \\, m_{i} \\;-\\; \\gamma_{p} \\, p_{i},\n$$\n对于每个 $i \\in \\{1,2,3\\}$，其中 $j$ 如上所述，索引了抑制基因 $i$ 的蛋白质。这里，$n$ 是希尔系数（无量纲），$\\alpha$ 是最大转录速率，$\\beta$ 是翻译速率常数，$\\gamma_{m}$ 是信使 RNA 降解速率常数，$\\gamma_{p}$ 是蛋白质降解速率常数，$K$ 是抑制阈值（产生半数最大抑制效应的浓度）。假设该模型中使用以下基本单位：\n- 时间变量 $t$ 以分钟为单位。\n- 浓度 $m_{i}$ 和 $p_{i}$ 以微摩尔浓度为单位。\n因此，参数满足以下单位分配\n- $\\alpha$ 的单位是 微摩尔/分钟，\n- $\\beta$ 的单位是 1/分钟，\n- $\\gamma_{m}$ 的单位是 1/分钟，\n- $\\gamma_{p}$ 的单位是 1/分钟，\n- $K$ 的单位是 微摩尔，\n而 $n$ 是无量纲的。\n\n定义一个变量替换，以秒表示时间，以纳摩尔浓度表示浓度，通过引入缩放变量 $T$, $M_{i}$, 和 $P_{i}$：\n$$\nT \\;=\\; s_{t} \\, t, \\qquad M_{i} \\;=\\; s_{c} \\, m_{i}, \\qquad P_{i} \\;=\\; s_{c} \\, p_{i},\n$$\n其中 $s_{t} \\;=\\; 60$ 且 $s_{c} \\;=\\; 10^{3}$（因此一分钟等于 $60$ 秒，一微摩尔浓度等于 $10^{3}$ 纳摩尔浓度）。要求以变量 $(T, M_{i}, P_{i})$ 表示的变换后模型保持相同的函数形式，\n$$\n\\frac{d M_{i}}{d T} \\;=\\; \\alpha' \\, \\frac{1}{1 + \\left(\\frac{P_{j}}{K'}\\right)^{n}} \\;-\\; \\gamma_{m}' \\, M_{i}, \\qquad\n\\frac{d P_{i}}{d T} \\;=\\; \\beta' \\, M_{i} \\;-\\; \\gamma_{p}' \\, P_{i},\n$$\n其中带撇的参数 $\\alpha'$, $\\beta'$, $\\gamma_{m}'$, $\\gamma_{p}'$, 和 $K'$ 反映了到秒和纳摩尔浓度的单位变换。\n\n从速率和浓度的量纲定义出发，并仅使用上述变量替换关系，推导出将 $(\\alpha, \\beta, \\gamma_{m}, \\gamma_{p}, K)$ 映射到 $(\\alpha', \\beta', \\gamma_{m}', \\gamma_{p}', K')$ 的显式变换，使得变换后的 ODE 在量纲上与秒和纳摩尔浓度一致。你的最终答案必须是按顺序排列的五个变换后的参数 $\\alpha'$, $\\beta'$, $\\gamma_{m}'$, $\\gamma_{p}'$, $K'$，每个参数都表示为由 $\\alpha$, $\\beta$, $\\gamma_{m}$, $\\gamma_{p}$, $K$ 以及常数 $60$ 和 $10^{3}$ 组成的封闭形式解析表达式。不要四舍五入；提供精确表达式。最终的方框答案中不要包含单位。在你的推导过程中，明确验证每个变换后参数的单位（$\\alpha'$ 的单位是纳摩尔/秒，$\\beta'$, $\\gamma_{m}'$, 和 $\\gamma_{p}'$ 的单位是 1/秒，$K'$ 的单位是纳摩尔）。",
            "solution": "该问题要求推导当时间和浓度的单位改变时，抑制振荡器模型参数的变换规则。原始系统使用的时间单位是分钟 ($min$)，浓度单位是微摩尔浓度 ($\\mu M$)。新系统使用的时间单位是秒 ($s$)，浓度单位是纳摩尔浓度 ($nM$)。\n\n原始变量为 $t$（时间）、$m_i$（mRNA 浓度）和 $p_i$（蛋白质浓度）。变换后的变量为 $T$, $M_i$ 和 $P_i$。它们之间的关系由以下公式给出：\n$$ T = s_t t \\implies t = \\frac{T}{s_t} $$\n$$ M_i = s_c m_i \\implies m_i = \\frac{M_i}{s_c} $$\n$$ P_i = s_c p_i \\implies p_i = \\frac{P_i}{s_c} $$\n缩放因子为 $s_t = 60 \\frac{s}{min}$ 和 $s_c = 10^3 \\frac{nM}{\\mu M}$。\n\n首先，我们使用链式法则建立时间导数之间的关系：\n$$ \\frac{d}{dt} = \\frac{dT}{dt} \\frac{d}{dT} $$\n由于 $T = s_t t$，我们有 $\\frac{dT}{dt} = s_t$。因此，\n$$ \\frac{d}{dt} = s_t \\frac{d}{dT} \\quad \\text{或} \\quad \\frac{d}{dT} = \\frac{1}{s_t} \\frac{d}{dt} $$\n\n现在，我们对系统中的两种常微分方程（ODE）进行变换。\n\n**mRNA 方程的变换：**\nmRNA 浓度 $m_i$ 的原始方程是：\n$$ \\frac{d m_{i}}{d t} = \\alpha \\frac{1}{1 + \\left(\\frac{p_{j}}{K}\\right)^{n}} - \\gamma_{m} m_{i} $$\n我们将原始变量（$m_i$, $p_j$）用新变量（$M_i$, $P_j$）的表达式代入：\n$$ \\frac{d}{dt} \\left( \\frac{M_i}{s_c} \\right) = \\alpha \\frac{1}{1 + \\left(\\frac{P_j/s_c}{K}\\right)^{n}} - \\gamma_{m} \\left( \\frac{M_i}{s_c} \\right) $$\n由于 $s_c$ 是一个常数，可以从导数中提出：\n$$ \\frac{1}{s_c} \\frac{dM_i}{dt} = \\alpha \\frac{1}{1 + \\left(\\frac{P_j}{s_c K}\\right)^{n}} - \\frac{\\gamma_m}{s_c} M_i $$\n接下来，我们将时间导数 $\\frac{d}{dt}$ 替换为其在 $\\frac{d}{dT}$下的等价形式，即 $s_t \\frac{d}{dT}$：\n$$ \\frac{1}{s_c} \\left( s_t \\frac{dM_i}{dT} \\right) = \\alpha \\frac{1}{1 + \\left(\\frac{P_j}{s_c K}\\right)^{n}} - \\frac{\\gamma_m}{s_c} M_i $$\n为了得到所需形式 $\\frac{dM_i}{dT} = \\dots$，我们将整个方程乘以 $\\frac{s_c}{s_t}$ 来解出 $\\frac{dM_i}{dT}$：\n$$ \\frac{dM_i}{dT} = \\frac{s_c}{s_t} \\left( \\alpha \\frac{1}{1 + \\left(\\frac{P_j}{s_c K}\\right)^{n}} - \\frac{\\gamma_m}{s_c} M_i \\right) $$\n$$ \\frac{dM_i}{dT} = \\left( \\frac{s_c \\alpha}{s_t} \\right) \\frac{1}{1 + \\left(\\frac{P_j}{s_c K}\\right)^{n}} - \\left( \\frac{s_c}{s_t} \\frac{\\gamma_m}{s_c} \\right) M_i $$\n$$ \\frac{dM_i}{dT} = \\left( \\frac{s_c \\alpha}{s_t} \\right) \\frac{1}{1 + \\left(\\frac{P_j}{s_c K}\\right)^{n}} - \\left( \\frac{\\gamma_m}{s_t} \\right) M_i $$\n我们将此结果与目标方程形式进行比较：\n$$ \\frac{d M_{i}}{d T} = \\alpha' \\frac{1}{1 + \\left(\\frac{P_{j}}{K'}\\right)^{n}} - \\gamma_{m}' M_{i} $$\n通过对系数和项进行等价，我们确定变换后的参数：\n$$ \\alpha' = \\frac{s_c}{s_t} \\alpha = \\frac{10^3}{60} \\alpha $$\n$$ \\gamma_m' = \\frac{\\gamma_m}{s_t} = \\frac{1}{60} \\gamma_m $$\n$$ K' = s_c K = 10^3 K $$\n\n**蛋白质方程的变换：**\n蛋白质浓度 $p_i$ 的原始方程是：\n$$ \\frac{d p_{i}}{d t} = \\beta m_{i} - \\gamma_{p} p_{i} $$\n我们将 $p_i$ 和 $m_i$ 用 $P_i$ 和 $M_i$ 的表达式代入：\n$$ \\frac{d}{dt} \\left( \\frac{P_i}{s_c} \\right) = \\beta \\left( \\frac{M_i}{s_c} \\right) - \\gamma_{p} \\left( \\frac{P_i}{s_c} \\right) $$\n提出常数 $\\frac{1}{s_c}$：\n$$ \\frac{1}{s_c} \\frac{dP_i}{dt} = \\frac{\\beta}{s_c} M_i - \\frac{\\gamma_p}{s_c} P_i $$\n将整个方程乘以 $s_c$ 以消去公因子：\n$$ \\frac{dP_i}{dt} = \\beta M_i - \\gamma_p P_i $$\n现在，我们将时间导数 $\\frac{d}{dt}$ 替换为 $s_t \\frac{d}{dT}$：\n$$ s_t \\frac{dP_i}{dT} = \\beta M_i - \\gamma_p P_i $$\n最后，我们通过除以 $s_t$ 来解出 $\\frac{dP_i}{dT}$：\n$$ \\frac{dP_i}{dT} = \\frac{\\beta}{s_t} M_i - \\frac{\\gamma_p}{s_t} P_i $$\n我们将此结果与目标方程形式进行比较：\n$$ \\frac{d P_{i}}{d T} = \\beta' M_{i} - \\gamma_{p}' P_{i} $$\n通过对系数进行等价，我们确定了其余的变换后参数：\n$$ \\beta' = \\frac{\\beta}{s_t} = \\frac{1}{60} \\beta $$\n$$ \\gamma_p' = \\frac{\\gamma_p}{s_t} = \\frac{1}{60} \\gamma_p $$\n\n**单位验证：**\n我们验证新参数是否具有正确的单位。\n原始参数的单位是：$[\\alpha] = \\mu M \\cdot min^{-1}$, $[\\beta] = min^{-1}$, $[\\gamma_m] = min^{-1}$, $[\\gamma_p] = min^{-1}$, $[K] = \\mu M$。\n缩放因子的单位是：$[s_t] = s \\cdot min^{-1}$ 和 $[s_c] = nM \\cdot \\mu M^{-1}$。\n\n- 对于 $\\alpha'$: $[\\alpha'] = \\frac{[s_c]}{[s_t]} [\\alpha] = \\frac{nM \\cdot \\mu M^{-1}}{s \\cdot min^{-1}} (\\mu M \\cdot min^{-1}) = nM \\cdot s^{-1}$。目标单位是 纳摩尔/秒，正确。\n- 对于 $\\beta'$: $[\\beta'] = \\frac{[\\beta]}{[s_t]} = \\frac{min^{-1}}{s \\cdot min^{-1}} = s^{-1}$。目标单位是 1/秒，正确。\n- 对于 $\\gamma_m'$: $[\\gamma_m'] = \\frac{[\\gamma_m]}{[s_t]} = \\frac{min^{-1}}{s \\cdot min^{-1}} = s^{-1}$。目标单位是 1/秒，正确。\n- 对于 $\\gamma_p'$: $[\\gamma_p'] = \\frac{[\\gamma_p]}{[s_t]} = \\frac{min^{-1}}{s \\cdot min^{-1}} = s^{-1}$。目标单位是 1/秒，正确。\n- 对于 $K'$: $[K'] = [s_c][K] = (nM \\cdot \\mu M^{-1})(\\mu M) = nM$。目标单位是 纳摩尔，正确。\n\n推导过程是一致的，单位分析也证实了结果。五个变换后的参数是：\n$\\alpha' = \\frac{10^3}{60} \\alpha$\n$\\beta' = \\frac{1}{60} \\beta$\n$\\gamma_m' = \\frac{1}{60} \\gamma_m$\n$\\gamma_p' = \\frac{1}{60} \\gamma_p$\n$K' = 10^3 K$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{10^3}{60} \\alpha  \\frac{1}{60} \\beta  \\frac{1}{60} \\gamma_m  \\frac{1}{60} \\gamma_p  10^3 K \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个理论模型的价值最终取决于它能否被实验数据所约束，然而，参数的可辨识性是一个普遍的挑战，即不同的参数组合可能产生相似的模型输出。这项计算实践  将引导你运用剖面似然（profile likelihood）分析这一强大技术，来评估从充满噪声的时间序列数据中辨识模型关键参数（如转录延迟和希尔系数）的实际能力。通过亲手生成模拟数据并尝试反向推断参数，你将获得诊断实验局限性（如噪声和稀疏采样）如何影响参数估计的宝贵经验，并掌握一种量化参数估计置信度的严谨方法。",
            "id": "3937200",
            "problem": "要求您使用根据合成时间序列数据计算的轮廓似然，评估一个三基因循环抑制振荡器（repressilator）中转录延迟参数和 Hill 协作指数的实际可辨识性。该问题必须通过编写一个完整的、可运行的程序来解决。\n\n建模基础应遵循以下经过充分检验的原则：\n- 分子生物学的中心法则意味着信使核糖核酸（mRNA）的浓度动态由转录和降解决定，而蛋白质的浓度动态由翻译和降解决定。\n- 转录抑制可以用一个 Hill 抑制函数来建模，该函数依赖于提高到 Hill 协作指数幂的抑制蛋白浓度。\n- 离散的转录延迟可以通过一阶滤波器的线性链（伽马分布延迟近似）来近似，这是将延迟微分方程简化为常微分方程的标准方法。\n\n模型说明：\n- 存在 $3$ 个基因，由 $i \\in \\{1,2,3\\}$ 循环索引；令 $m_i(t)$ 表示基因 $i$ 的 mRNA 浓度， $p_i(t)$ 表示基因 $i$ 的蛋白质浓度。\n- 基因 $i$ 的转录被基因 $i-1$ 的蛋白质的延迟版本所抑制（约定基因 $0$ 指的是基因 $3$）。该抑制使用一个协作性为 $n$ 的 Hill 函数。\n- 平均值为 $\\tau$ 的延迟通过一个由 $K$ 个相同的一阶滤波器组成的链来近似，其速率为 $\\kappa$，其中 $\\kappa = K/\\tau$，因此平均延迟为 $\\tau$。\n\n状态动态：\n- 对于每个 $i \\in \\{1,2,3\\}$，\n  - mRNA 动态：$\\dfrac{d m_i}{dt} = a_0 + \\dfrac{a}{1 + \\left(\\tilde{p}_{i-1}(t)\\right)^n} - \\gamma_m m_i$，\n  - 蛋白质动态：$\\dfrac{d p_i}{dt} = \\beta \\left(m_i - p_i\\right)$，\n  - 每个蛋白质 $p_i$ 的延迟链：定义 $z_{i,0}, z_{i,1}, \\dots, z_{i,K-1}$，其中\n    - $\\dfrac{d z_{i,0}}{dt} = \\kappa \\left(p_i - z_{i,0}\\right)$，\n    - $\\dfrac{d z_{i,j}}{dt} = \\kappa \\left(z_{i,j-1} - z_{i,j}\\right)$ for $j \\in \\{1,\\dots,K-1\\}$，\n    - 在 Hill 项中使用的延迟抑制物是 $\\tilde{p}_i(t) = z_{i,K-1}(t)$。\n- 参数 $a_0$、$a$、$\\beta$、$\\gamma_m$ 和 $\\gamma_p$ 是正常数，$\\gamma_p$ 如上文所述通过 $\\beta$ 嵌入在蛋白质方程中。\n- 使用 $K = 3$、$a_0 = 0.03$、$a = 50.0$、$\\beta = 5.0$ 和 $\\gamma_m = 1.0$。\n- 两个感兴趣的参数是平均延迟 $\\tau$ 和 Hill 协作指数 $n$。\n\n数据生成：\n- 使用上述模型生成合成数据，其真实参数为 $\\tau^\\star = 5.0$ 和 $n^\\star = 2.4$。\n- 初始条件：对于所有 $i$，设置 $m_i(0) = 0.1$，$i \\in \\{1,2,3\\}$ 对应的 $p_i(0)$ 分别为 $\\{0.1, 0.2, 0.15\\}$，并且对于所有 $i$ 和所有延迟链状态 $z_{i,j}(0) = p_i(0)$。\n- 模拟模型并在均匀的时间网格上对蛋白质浓度 $p_i(t)$ 进行采样。\n- 向每个采样的蛋白质测量值添加独立的、零均值、标准差为 $\\sigma$ 的高斯噪声。\n\n似然模型和轮廓似然：\n- 假设测量误差是独立同分布的高斯误差，其方差参数未知。\n- 参数的实际可辨识性通过其轮廓似然的形状来评估（在优化掉另一个参数后），以及从似然比推断出的 $95\\%$ 置信集是否在所考虑的参数网格内有界。\n- 您的程序必须从高斯假设（具有未知方差）中推导出适当的似然比统计量，并用它来计算 $\\tau$ 和 $n$ 的轮廓似然曲线。不要硬编码任何“快捷”公式；使用高斯似然的第一性原理来构建该统计量。\n\n测试套件：\n- 通过改变观测时间窗口 $T$、采样间隔 $\\Delta t$ 和噪声标准差 $\\sigma$ 使用三个测试用例：\n  - 案例 A（信息丰富）：$T = 200.0$，$\\Delta t = 1.0$，$\\sigma = 0.3$。\n  - 案例 B（高噪声）：$T = 200.0$，$\\Delta t = 1.0$，$\\sigma = 5.0$。\n  - 案例 C（短而稀疏）：$T = 60.0$，$\\Delta t = 2.0$，$\\sigma = 0.3$。\n- 对于每个案例，使用一个轮廓分析网格，其中 $\\tau$ 在 $[1.5, 8.5]$ 区间内有 $7$ 个等间距值， $n$ 在 $[1.4, 3.8]$ 区间内有 $7$ 个等间距值。\n- 对于每个案例，当且仅当轮廓似然比保持在 $95\\%$ 置信区域内（基于单自由度似然比）的网格值集合在网格两侧均被严格限制时，定义 $\\tau$（或 $n$）的实际可辨识性为“真”；否则为“假”。\n\n计算指南：\n- 使用常微分方程模拟线性链增强的 repressilator。您可以使用自适应求解器。\n- 对于每个案例，计算所有基因和时间点上模拟蛋白质与带噪观测值之间的残差平方和，并推导出在给定网格上关于 $\\tau$ 和 $n$ 的相应轮廓似然比曲线。\n- 为了构建轮廓，对于每个固定的 $\\tau$ 值，在 $n$ 网格上最小化差异；对于每个固定的 $n$ 值，在 $\\tau$ 网格上最小化差异。使用整个 $7 \\times 7$ 网格上的全局最小差异来锚定轮廓似然比。\n\n必需的输出：\n- 对于三个案例中的每一个，按顺序输出两个布尔值：$\\tau$ 的实际可辨识性，$n$ 的实际可辨识性（按此顺序）。\n- 您的程序应生成单行输出，包含一个列表的列表，每个子列表对应一个测试案例，例如 $[[b_{11}, b_{12}], [b_{21}, b_{22}], [b_{31}, b_{32}]]$，其中每个 $b_{ij}$ 是 $\\mathrm{True}$ 或 $\\mathrm{False}$。\n\n最终输出格式：\n- 您的程序必须生成单行输出，该行内容完全是一个 Python 风格的包含三个布尔值列表的列表，按案例 A、B、C 的顺序排列，不带任何额外文本，例如：$[[\\mathrm{True}, \\mathrm{False}], [\\mathrm{False}, \\mathrm{False}], [\\mathrm{True}, \\mathrm{True}]]$.",
            "solution": "目标是使用根据合成时间序列数据计算的轮廓似然分析，评估 repressilator 基因振荡器模型的两个关键参数——平均转录延迟 $\\tau$ 和 Hill 协作指数 $n$——的实际可辨识性。\n\n**模型构建**\n\n该系统由 $3$ 个基因组成，循环索引。系统在时间 $t$ 的状态由每个基因 $i \\in \\{1, 2, 3\\}$ 的信使 RNA ($m_i(t)$) 和蛋白质 ($p_i(t)$) 的浓度来描述。转录延迟通过一个由 $K$ 个中间状态 $z_{i,j}(t)$ 组成的线性链来建模，这为离散延迟提供了一个伽马分布的近似。对于 $K=3$ 个基因和长度为 $K=3$ 的延迟链，状态变量的总数为 $3 \\times (1 \\text{ mRNA} + 1 \\text{ 蛋白质} + 3 \\text{ 延迟状态}) = 15$。令状态向量为 $Y(t) = [m_1, m_2, m_3, p_1, p_2, p_3, z_{1,0}, z_{1,1}, z_{1,2}, z_{2,0}, z_{2,1}, z_{2,2}, z_{3,0}, z_{3,1}, z_{3,2}]^T$。\n\n动态由一组常微分方程（ODE）控制。对于每个基因 $i \\in \\{1, 2, 3\\}$，方程如下：\n\n1.  **mRNA 动态**：转录被建模为基础速率 $a_0$ 和一个抑制项之和，随后是一阶降解，速率为 $\\gamma_m$。基因 $i$ 的抑制由基因 $i-1$（基因 $0$ 理解为基因 $3$）的延迟蛋白质施加，通过 Hill 函数建模。\n    $$\n    \\frac{d m_i}{dt} = a_0 + \\frac{a}{1 + \\left(\\tilde{p}_{i-1}(t)\\right)^n} - \\gamma_m m_i\n    $$\n    其中 $\\tilde{p}_{i-1}(t)$ 是抑制蛋白的延迟浓度。\n\n2.  **蛋白质动态**：蛋白质从 mRNA 翻译而来，速率与 $m_i$ 成正比，并以一阶速率降解。问题为这两个过程指定了单个参数 $\\beta$。\n    $$\n    \\frac{d p_i}{dt} = \\beta (m_i - p_i)\n    $$\n\n3.  **延迟动态**：平均值为 $\\tau$ 的延迟通过一个由 $K$ 个一阶滤波器组成的链来近似，每个滤波器的速率常数为 $\\kappa = K/\\tau$。\n    \\begin{align*}\n    \\frac{d z_{i,0}}{dt} = \\kappa (p_i - z_{i,0}) \\\\\n    \\frac{d z_{i,j}}{dt} = \\kappa (z_{i,j-1} - z_{i,j}), \\quad \\text{for } j \\in \\{1, \\dots, K-1\\}\n    \\end{align*}\n    延迟链的输出，即作为 Hill 函数中抑制物浓度的，是链中的最后一个状态：\n    $$\n    \\tilde{p}_i(t) = z_{i,K-1}(t)\n    $$\n\n给定的固定模型参数为 $K=3$、$a_0=0.03$、$a=50.0$、$\\beta=5.0$ 和 $\\gamma_m=1.0$。\n\n**似然模型和轮廓似然**\n\n通过使用真实参数 $\\theta^\\star = (\\tau^\\star, n^\\star) = (5.0, 2.4)$ 模拟模型并添加噪声来生成合成数据。在时间点 $t_k$ 对蛋白质浓度 $p_i$ 的测量值 $y_{i,k}$ 建模为：\n$$\ny_{i,k} = p_i(t_k; \\theta) + \\epsilon_{i,k}\n$$\n其中 $\\theta = (\\tau, n)$ 是参数向量，$\\epsilon_{i,k}$ 是独立同分布（i.i.d.）的高斯误差，均值为 $0$，方差未知为 $\\sigma^2$，即 $\\epsilon_{i,k} \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n给定参数 $\\theta$ 和 $\\sigma^2$ 时观测到数据 $\\mathbf{y}$ 的似然是每个测量概率的乘积：\n$$\nL(\\theta, \\sigma^2 | \\mathbf{y}) = \\prod_{i=1}^{3} \\prod_{k=1}^{N_t} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_{i,k} - p_i(t_k; \\theta))^2}{2\\sigma^2}\\right)\n$$\n其中 $N_t$ 是时间点的数量。对数似然函数为：\n$$\n\\ell(\\theta, \\sigma^2 | \\mathbf{y}) = -\\frac{N_{total}}{2} \\log(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{3} \\sum_{k=1}^{N_t} (y_{i,k} - p_i(t_k; \\theta))^2\n$$\n其中 $N_{total} = 3 \\times N_t$ 是数据点的总数。令残差平方和为 $\\text{SSR}(\\theta) = \\sum_{i,k} (y_{i,k} - p_i(t_k; \\theta))^2$。那么：\n$$\n\\ell(\\theta, \\sigma^2 | \\mathbf{y}) = -\\frac{N_{total}}{2} \\log(2\\pi\\sigma^2) - \\frac{\\text{SSR}(\\theta)}{2\\sigma^2}\n$$\n对于固定的 $\\theta$，关于 $\\sigma^2$ 最大化 $\\ell$ 可以得到方差的最大似然估计（MLE）：$\\hat{\\sigma}^2(\\theta) = \\text{SSR}(\\theta) / N_{total}$。将其代回可得到置入或集中的对数似然：\n$$\n\\ell_{conc}(\\theta) = -\\frac{N_{total}}{2} \\left( \\log(2\\pi) + \\log\\left(\\frac{\\text{SSR}(\\theta)}{N_{total}}\\right) + 1 \\right)\n$$\n最大化 $\\ell_{conc}(\\theta)$ 等价于最小化 $\\text{SSR}(\\theta)$。全局最大似然估计参数 $\\hat{\\theta} = (\\hat{\\tau}, \\hat{n})$ 是使 SSR 最小化的参数。令此全局最小值为 $\\text{SSR}_{\\text{min}} = \\text{SSR}(\\hat{\\theta})$。相应的最大对数似然值为 $\\ell_{max} = \\ell_{conc}(\\hat{\\theta})$。\n\n单个参数（例如 $\\tau$）的轮廓似然是通过对其他“讨厌”参数最大化似然函数得到的。$\\tau$ 的轮廓对数似然为：\n$$\n\\ell_{prof}(\\tau) = \\max_{n, \\sigma^2} \\ell(\\tau, n, \\sigma^2 | \\mathbf{y}) = \\ell_{conc}(\\tau, \\hat{n}(\\tau))\n$$\n其中 $\\hat{n}(\\tau)$ 是在给定 $\\tau$ 的情况下最小化 $\\text{SSR}(\\tau, n)$ 的 $n$ 值。令 $\\text{SSR}_{prof}(\\tau) = \\min_n \\text{SSR}(\\tau, n)$。\n\n为了评估可辨识性，我们使用似然比检验统计量。对于特定值 $\\tau_0$，该统计量为：\n$$\n\\lambda(\\tau_0) = 2(\\ell_{max} - \\ell_{prof}(\\tau_0))\n$$\n代入对数似然的表达式：\n$$\n\\lambda(\\tau_0) = 2 \\left[ -\\frac{N_{total}}{2} \\left(\\log\\left(\\frac{\\text{SSR}_{\\text{min}}}{N_{total}}\\right) + C\\right) - \\left(-\\frac{N_{total}}{2} \\left(\\log\\left(\\frac{\\text{SSR}_{prof}(\\tau_0)}{N_{total}}\\right) + C\\right)\\right) \\right]\n$$\n其中 $C = \\log(2\\pi) + 1$。这可以简化为：\n$$\n\\lambda(\\tau_0) = N_{total} \\left( \\log(\\text{SSR}_{prof}(\\tau_0)) - \\log(\\text{SSR}_{\\text{min}}) \\right) = N_{total} \\log\\left(\\frac{\\text{SSR}_{prof}(\\tau_0)}{\\text{SSR}_{\\text{min}}}\\right)\n$$\n在真实参数值为 $\\tau_0$ 的原假设下，$\\lambda(\\tau_0)$ 服从自由度为 $1$ 的卡方分布（$\\chi^2_1$）。$\\tau$ 的 $95\\%$ 置信区域是我们不会拒绝假设的所有 $\\tau_0$ 值的集合，即满足 $\\lambda(\\tau_0) \\le \\chi^2_{1, 0.95} \\approx 3.841$ 的区域。\n\n**计算过程和可辨识性准则**\n\n对于每个测试案例（A、B、C）：\n1.  **生成数据**：使用真实参数（$\\tau^\\star, n^\\star$）模拟 ODE 系统，生成真实的蛋白质浓度 $p_i(t)$。在指定时间对这些浓度进行采样，并添加具有指定标准差 $\\sigma$ 的独立同分布高斯噪声。\n2.  **网格搜索**：对于提供的 $7 \\times 7$ 网格上的每对参数 $(\\tau_j, n_k)$，模拟模型并计算模拟结果与带噪数据之间的 $\\text{SSR}(\\tau_j, n_k)$。\n3.  **轮廓似然**：\n    *   在网格上找到全局最小 SSR：$\\text{SSR}_{\\text{min}} = \\min_{j,k} \\text{SSR}(\\tau_j, n_k)$。\n    *   计算 SSR 轮廓：$\\text{SSR}_{prof}(\\tau_j) = \\min_k \\text{SSR}(\\tau_j, n_k)$ 和 $\\text{SSR}_{prof}(n_k) = \\min_j \\text{SSR}(\\tau_j, n_k)$。\n    *   使用推导出的公式计算似然比统计量轮廓 $\\lambda(\\tau_j)$ 和 $\\lambda(n_k)$。\n4.  **可辨识性检查**：如果一个参数的 $95\\%$ 置信集严格地限制在其网格内部，则该参数被认为是实际可辨识的。这意味着 $\\lambda$ 统计量低于 $\\chi^2_1$ 阈值的网格索引集合不得包含第一个（$0$）或最后一个（$6$）索引。如果置信集为空或触及任一边界，则该参数在给定的实验条件和参数网格下被归类为不具有实际可辨识性。\n\n整个过程在以下程序中自动化实现。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Define fixed model parameters\nA0 = 0.03\nA = 50.0\nBETA = 5.0\nGAMMA_M = 1.0\nK = 3\nNUM_GENES = 3\n\n# Ground-truth parameters for data generation\nTAU_TRUTH = 5.0\nN_TRUTH = 2.4\n\n# Initial conditions\nM_INIT = [0.1] * NUM_GENES\nP_INIT = [0.1, 0.2, 0.15]\nZ_INIT_FLAT = [p for p in P_INIT for _ in range(K)]\nY0 = np.array(M_INIT + P_INIT + Z_INIT_FLAT)\n\ndef repressilator_ode(t, y, tau, n):\n    \"\"\"\n    ODE system for the repressilator with gamma-distributed delay.\n    State vector y: [m1, m2, m3, p1, p2, p3, z1_0..z1_K-1, z2_0..z2_K-1, z3_0..z3_K-1]\n    \"\"\"\n    dy = np.zeros_like(y)\n    m = y[:NUM_GENES]\n    p = y[NUM_GENES:2*NUM_GENES]\n    \n    # Reshape z to be a (NUM_GENES, K) matrix for easier indexing\n    z = y[2*NUM_GENES:].reshape((NUM_GENES, K))\n    \n    kappa = K / tau if tau  0 else np.inf\n\n    # Calculate derivatives\n    for i in range(NUM_GENES):\n        # Repressor for gene i is protein (i-1) % NUM_GENES\n        repressor_idx = (i - 1 + NUM_GENES) % NUM_GENES\n        \n        # The delayed repressor is the last element in its delay chain\n        delayed_repressor = z[repressor_idx, K-1]\n        \n        # mRNA dynamics\n        hill_term = A / (1 + delayed_repressor**n)\n        dy[i] = A0 + hill_term - GAMMA_M * m[i]\n        \n        # Protein dynamics\n        dy[NUM_GENES + i] = BETA * (m[i] - p[i])\n        \n        # Delay chain dynamics\n        # Index for the start of z_i states in dy\n        z_start_idx = 2*NUM_GENES + i*K\n        \n        # First element of the chain\n        dy[z_start_idx] = kappa * (p[i] - z[i, 0])\n        \n        # Subsequent elements\n        for j in range(1, K):\n            dy[z_start_idx + j] = kappa * (z[i, j-1] - z[i, j])\n            \n    return dy\n\ndef generate_data(t_eval, sigma):\n    \"\"\"Generates synthetic noisy data.\"\"\"\n    sol = solve_ivp(\n        fun=repressilator_ode,\n        t_span=(t_eval[0], t_eval[-1]),\n        y0=Y0,\n        t_eval=t_eval,\n        args=(TAU_TRUTH, N_TRUTH),\n        method='LSODA',\n        rtol=1e-6,\n        atol=1e-9\n    )\n    \n    true_protein_data = sol.y[NUM_GENES:2*NUM_GENES, :]\n    noise = np.random.normal(0, sigma, size=true_protein_data.shape)\n    noisy_data = true_protein_data + noise\n    return noisy_data\n\ndef solve():\n    \"\"\"\n    Main function to run the identifiability analysis for all test cases.\n    \"\"\"\n    test_cases = [\n        {'id': 'A', 'T': 200.0, 'dt': 1.0, 'sigma': 0.3},\n        {'id': 'B', 'T': 200.0, 'dt': 1.0, 'sigma': 5.0},\n        {'id': 'C', 'T': 60.0, 'dt': 2.0, 'sigma': 0.3},\n    ]\n\n    tau_grid = np.linspace(1.5, 8.5, 7)\n    n_grid = np.linspace(1.4, 3.8, 7)\n\n    # Chi-squared critical value for 1 DoF, 95% confidence\n    # from scipy.stats.chi2.ppf(0.95, 1)\n    chi2_crit = 3.841458820694124\n\n    # Set a fixed seed for reproducibility of noise generation\n    np.random.seed(42)\n\n    all_results = []\n\n    for case in test_cases:\n        T, dt, sigma = case['T'], case['dt'], case['sigma']\n        t_eval = np.arange(0, T + dt, dt)\n        \n        # 1. Generate synthetic data for the current case\n        noisy_protein_data = generate_data(t_eval, sigma)\n        n_total_datapoints = noisy_protein_data.size\n\n        # 2. Compute SSR grid\n        ssr_grid = np.full((len(tau_grid), len(n_grid)), np.inf)\n\n        for i, tau in enumerate(tau_grid):\n            for j, n in enumerate(n_grid):\n                sol = solve_ivp(\n                    fun=repressilator_ode,\n                    t_span=(t_eval[0], t_eval[-1]),\n                    y0=Y0,\n                    t_eval=t_eval,\n                    args=(tau, n),\n                    method='LSODA',\n                    rtol=1e-6,\n                    atol=1e-9\n                )\n                \n                if sol.success:\n                    sim_protein_data = sol.y[NUM_GENES:2*NUM_GENES, :]\n                    ssr = np.sum((sim_protein_data - noisy_protein_data)**2)\n                    ssr_grid[i, j] = ssr\n\n        # 3. Compute profile likelihoods\n        ssr_min = np.nanmin(ssr_grid)\n        if ssr_min == 0 or not np.isfinite(ssr_min):\n            # Avoid log(0) or log(inf) if simulation or fitting fails globally\n            # In this case, no parameter is identifiable\n            all_results.append([False, False])\n            continue\n            \n        ssr_profile_tau = np.nanmin(ssr_grid, axis=1)\n        ssr_profile_n = np.nanmin(ssr_grid, axis=0)\n\n        # Likelihood ratio statistics\n        # Add a small epsilon to avoid log(0) if a profile SSR matches ssr_min\n        epsilon = 1e-9\n        lambda_tau = n_total_datapoints * np.log((ssr_profile_tau + epsilon) / ssr_min)\n        lambda_n = n_total_datapoints * np.log((ssr_profile_n + epsilon) / ssr_min)\n\n        # 4. Check identifiability\n        def is_identifiable(lambda_profile):\n            confident_mask = lambda_profile = chi2_crit\n            if not np.any(confident_mask):\n                return False\n            \n            confident_indices = np.where(confident_mask)[0]\n            is_bounded = (np.min(confident_indices)  0) and \\\n                         (np.max(confident_indices)  len(lambda_profile) - 1)\n            return is_bounded\n\n        tau_identifiable = is_identifiable(lambda_tau)\n        n_identifiable = is_identifiable(lambda_n)\n        \n        all_results.append([tau_identifiable, n_identifiable])\n\n    # Final print statement in the exact required format\n    # Example format: [[True, False], [False, False], [True, True]]\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}