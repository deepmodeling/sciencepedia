{
    "hands_on_practices": [
        {
            "introduction": "A central task in analyzing any potential oscillator is to determine the conditions under which oscillations emerge. This practice guides you through a linear stability analysis of the repressilator's steady state to find the threshold for a Hopf bifurcation—the birth of an oscillation. By working with the full six-dimensional system, you will derive how the finite lifetime of mRNA, controlled by the parameter $\\delta$, quantitatively shifts the boundary of the oscillatory regime, providing a deeper and more realistic understanding than simpler, reduced models .",
            "id": "3937232",
            "problem": "Consider the canonical nondimensionalized six-dimensional ordinary differential equation model of the repressilator ring oscillator consisting of three transcriptional repressors arranged in a unidirectional inhibitory cycle. Let $m_i(t)$ denote the messenger ribonucleic acid (mRNA) of gene $i$ and $p_i(t)$ the corresponding protein, with indices taken modulo $3$. The dynamics are\n$$\n\\frac{d m_i}{d t} \\;=\\; \\delta\\big(-m_i + g(p_{i-1})\\big), \n\\qquad\n\\frac{d p_i}{d t} \\;=\\; -\\,p_i + m_i,\n$$\nwhere $\\delta \\gg 1$ is the ratio of the mRNA turnover rate to the protein turnover rate, and $g(p)$ is a smooth, monotonically decreasing repression function. Assume a leak-free Hill-type repression $g(p) = \\dfrac{\\alpha}{1 + p^n}$ with Hill coefficient $n \\ge 2$ and maximal synthesis $\\alpha  0$. Let $(m_i^*,p_i^*)$ denote the unique symmetric steady state with $m_i^* = p_i^* = p^*$ for all $i$, determined implicitly by $p^* = g(p^*)$, and write $g'(p^*)$ for the slope evaluated at this steady state.\n\nStarting only from the model structure above and fundamental linearization principles for smooth dynamical systems, analyze the onset of oscillations via a Hopf bifurcation of the symmetric steady state. In the reduced limit $\\delta \\to \\infty$ (quasi-steady mRNA), the classical three-dimensional protein-only reduction is recovered. In that limit, the Hopf threshold is determined by the critical value of the steady-state slope $g'(p^*)$ and the corresponding Hopf angular frequency is finite. Now, for large but finite $\\delta$, mRNA dynamics are no longer instantaneous and will shift both the Hopf threshold and the oscillation frequency.\n\nDerive, to leading order in $1/\\delta$ (i.e., keeping terms up to and including order $1/\\delta$), the asymptotic expressions for:\n- the critical steady-state slope $g'_H(\\delta)$ at which the Hopf bifurcation occurs, and\n- the corresponding Hopf angular frequency $\\omega_H(\\delta)$,\n\nin terms of $\\delta$ only, without explicit reference to $\\alpha$ or $n$ beyond the occurrence of $g'(p^*)$. Your derivation must proceed by linearizing the full six-dimensional system about the symmetric equilibrium and exploiting the circulant symmetry of the three-gene ring to decouple the eigenmodes, followed by a large-$\\delta$ expansion. Express the final answer as closed-form symbolic expressions for $g'_H(\\delta)$ and $\\omega_H(\\delta)$ valid to order $1/\\delta$. The angular frequency must be expressed in radians per unit nondimensional time. No numerical rounding is required. Your final boxed answer must contain only these two expressions and no explanatory text.",
            "solution": "The problem asks for the asymptotic expressions for the critical steady-state slope and Hopf frequency for the repressilator model to order $1/\\delta$. The derivation proceeds via linearization of the full six-dimensional system about its symmetric steady state.\n\nThe system dynamics are given by:\n$$\n\\frac{d m_i}{d t} \\;=\\; \\delta\\big(-m_i + g(p_{i-1})\\big)\n$$\n$$\n\\frac{d p_i}{d t} \\;=\\; -\\,p_i + m_i\n$$\nfor $i=1, 2, 3$ with indices taken modulo $3$. The symmetric steady state $(m_i^*, p_i^*)$ satisfies $m_i^* = m^*$ and $p_i^* = p^*$ for all $i$, where $m^*=p^*$ and $p^*=g(p^*)$.\n\nFirst, we linearize the system around this steady state. Let the state vector be ordered as $X(t) = (m_1, p_1, m_2, p_2, m_3, p_3)^T$. The linearized system for the perturbations $\\delta X = X - X^*$ is given by $\\frac{d}{dt}\\delta X = J \\delta X$, where $J$ is the Jacobian matrix evaluated at the steady state.\nThe partial derivatives are:\n$\\frac{\\partial}{\\partial m_i}(\\frac{dm_i}{dt}) = -\\delta$, $\\frac{\\partial}{\\partial p_{i-1}}(\\frac{dm_i}{dt}) = \\delta g'(p^*)$,\n$\\frac{\\partial}{\\partial p_i}(\\frac{dp_i}{dt}) = -1$, $\\frac{\\partial}{\\partial m_i}(\\frac{dp_i}{dt}) = 1$.\nAll other partial derivatives are zero.\n\nTo exploit the cyclic symmetry, we group the variables as $\\vec{m}=(m_1, m_2, m_3)^T$ and $\\vec{p}=(p_1, p_2, p_3)^T$. The linearized equations for the perturbations $\\delta\\vec{m}$ and $\\delta\\vec{p}$ are:\n$$\n\\frac{d}{dt}\\delta\\vec{m} = -\\delta I \\delta\\vec{m} + \\delta g'(p^*) C \\delta\\vec{p}\n$$\n$$\n\\frac{d}{dt}\\delta\\vec{p} = I \\delta\\vec{m} - I \\delta\\vec{p}\n$$\nwhere $I$ is the $3 \\times 3$ identity matrix and $C$ is the circulant permutation matrix:\n$$\nC = \\begin{pmatrix} 0  0  1 \\\\ 1  0  0 \\\\ 0  1  0 \\end{pmatrix}\n$$\nThe full Jacobian matrix in this block representation is:\n$$\nJ = \\begin{pmatrix} -\\delta I  \\delta g'(p^*) C \\\\ I  -I \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $J$ are determined by the characteristic equation $\\det(J - \\lambda I) = 0$. For an eigenvector $(\\vec{v}_m, \\vec{v}_p)^T$, we have:\n$$\n-\\delta \\vec{v}_m + \\delta g'(p^*) C \\vec{v}_p = \\lambda \\vec{v}_m\n$$\n$$\n\\vec{v}_m - \\vec{v}_p = \\lambda \\vec{v}_p\n$$\nFrom the second equation, we get $\\vec{v}_m = (\\lambda+1)\\vec{v}_p$. Substituting this into the first equation yields:\n$$\n-\\delta (\\lambda+1) \\vec{v}_p + \\delta g'(p^*) C \\vec{v}_p = \\lambda (\\lambda+1) \\vec{v}_p\n$$\nAssuming $\\vec{v}_p \\neq \\vec{0}$, we can rearrange the terms:\n$$\n\\delta g'(p^*) C \\vec{v}_p = \\left[ \\lambda(\\lambda+1) + \\delta(\\lambda+1) \\right] \\vec{v}_p = (\\lambda+1)(\\lambda+\\delta)\\vec{v}_p\n$$\nThis implies that $\\frac{(\\lambda+1)(\\lambda+\\delta)}{\\delta g'(p^*)}$ must be an eigenvalue of the matrix $C$. The eigenvalues of the $3 \\times 3$ circulant matrix $C$ are the third roots of unity, $\\mu_k = \\exp(i 2\\pi k/3)$ for $k=0, 1, 2$.\n$$\n(\\lambda+1)(\\lambda+\\delta) = \\delta g'(p^*) \\mu_k\n$$\nThis gives the characteristic equation for the eigenvalues $\\lambda$ of the full system:\n$$\n\\lambda^2 + (\\delta+1)\\lambda + \\delta(1 - g'(p^*) \\mu_k) = 0\n$$\nWe analyze the roots for each mode $k$:\nCase $k=0$: $\\mu_0 = 1$. The equation is $\\lambda^2 + (\\delta+1)\\lambda + \\delta(1 - g'(p^*)) = 0$. Since $g(p)$ is a decreasing function, $g'(p^*)  0$, which implies $1 - g'(p^*)  0$. The sum of the roots is $-(\\delta+1)  0$ and the product of the roots is $\\delta(1-g'(p^*))  0$. Therefore, both roots are real and negative. This mode is always stable and cannot lead to oscillations.\n\nCase $k=1, 2$: $\\mu_1 = \\exp(i 2\\pi/3) = -\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}$ and $\\mu_2 = \\mu_1^* = \\exp(-i 2\\pi/3) = -\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}$. These two cases yield complex conjugate characteristic equations, so their eigenvalue spectra are the same. We focus on $k=2$.\n$$\n\\lambda^2 + (\\delta+1)\\lambda + \\delta\\left(1 - g'(p^*)\\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right)\\right) = 0\n$$\n$$\n\\lambda^2 + (\\delta+1)\\lambda + \\delta\\left(1 + \\frac{g'(p^*)}{2} + i\\frac{\\sqrt{3}}{2}g'(p^*)\\right) = 0\n$$\nA Hopf bifurcation occurs when a pair of complex conjugate eigenvalues crosses the imaginary axis. We set $\\lambda = i\\omega_H$, where $\\omega_H$ is the real-valued Hopf frequency. We require $\\omega_H  0$.\n$$\n(i\\omega_H)^2 + (\\delta+1)(i\\omega_H) + \\delta\\left(1 + \\frac{g'_H}{2} + i\\frac{\\sqrt{3}}{2}g'_H\\right) = 0\n$$\nwhere $g'_H$ is the critical value of $g'(p^*)$ at the bifurcation. Separating the real and imaginary parts:\n$$\n\\left(-\\omega_H^2 + \\delta\\left(1 + \\frac{g'_H}{2}\\right)\\right) + i\\left(\\omega_H(\\delta+1) + \\delta\\frac{\\sqrt{3}}{2}g'_H\\right) = 0\n$$\nBoth real and imaginary parts must be zero:\n1. Real part: $\\omega_H^2 = \\delta(1 + \\frac{g'_H}{2})$\n2. Imaginary part: $\\omega_H(\\delta+1) = -\\delta\\frac{\\sqrt{3}}{2}g'_H$\n\nFrom the imaginary part, since $\\omega_H > 0$ and $\\delta > 0$, we must have $g'_H  0$. This is consistent with $g(p)$ being a repressive function. (Note: choosing $k=1$ would lead to $g'_H > 0$, which is unphysical).\nFrom the real part, for $\\omega_H^2 > 0$, we need $1 + g'_H/2 > 0$, which means $g'_H > -2$.\n\nWe now solve these two equations for $g'_H$ and $\\omega_H$ as functions of $\\delta$. From the imaginary part equation:\n$$\ng'_H = -\\frac{2\\omega_H(\\delta+1)}{\\delta\\sqrt{3}}\n$$\nSubstituting this into the real part equation:\n$$\n\\omega_H^2 = \\delta\\left(1 + \\frac{1}{2} \\left(-\\frac{2\\omega_H(\\delta+1)}{\\delta\\sqrt{3}}\\right)\\right) = \\delta - \\frac{\\omega_H(\\delta+1)}{\\sqrt{3}}\n$$\nThis gives a quadratic equation for $\\omega_H$:\n$$\n\\omega_H^2 + \\frac{\\delta+1}{\\sqrt{3}}\\omega_H - \\delta = 0\n$$\nSolving for $\\omega_H$ and taking the positive root (since frequency must be positive):\n$$\n\\omega_H(\\delta) = \\frac{1}{2}\\left( -\\frac{\\delta+1}{\\sqrt{3}} + \\sqrt{\\left(\\frac{\\delta+1}{\\sqrt{3}}\\right)^2 + 4\\delta} \\right) = \\frac{1}{2\\sqrt{3}}\\left( -(\\delta+1) + \\sqrt{\\delta^2 + 14\\delta + 1} \\right)\n$$\nTo find the asymptotic expression for large $\\delta$, we expand the square root term:\n$$\n\\sqrt{\\delta^2 + 14\\delta + 1} = \\delta\\left(1 + \\frac{14}{\\delta} + \\frac{1}{\\delta^2}\\right)^{1/2} = \\delta\\left(1 + \\frac{1}{2}\\left(\\frac{14}{\\delta}\\right) - \\frac{1}{8}\\left(\\frac{14}{\\delta}\\right)^2 + O(\\delta^{-3}) \\right) = \\delta + 7 - \\frac{24}{\\delta} + O(\\delta^{-2})\n$$\nSubstituting this into the expression for $\\omega_H(\\delta)$:\n$$\n\\omega_H(\\delta) = \\frac{1}{2\\sqrt{3}}\\left( -(\\delta+1) + (\\delta + 7 - \\frac{24}{\\delta} + O(\\delta^{-2})) \\right) = \\frac{1}{2\\sqrt{3}}\\left(6 - \\frac{24}{\\delta} + O(\\delta^{-2})\\right)\n$$\n$$\n\\omega_H(\\delta) = \\frac{3}{\\sqrt{3}} - \\frac{12}{\\sqrt{3}\\delta} + O(\\delta^{-2}) = \\sqrt{3} - \\frac{4\\sqrt{3}}{\\delta} + O(\\delta^{-2})\n$$\nSo, to order $1/\\delta$, $\\omega_H(\\delta) = \\sqrt{3}\\left(1 - \\frac{4}{\\delta}\\right)$.\n\nNow we find the expression for $g'_H(\\delta)$:\n$$\ng'_H(\\delta) = -\\frac{2\\omega_H(\\delta)(\\delta+1)}{\\delta\\sqrt{3}} = -\\frac{2(1+1/\\delta)}{\\sqrt{3}}\\omega_H(\\delta)\n$$\nSubstituting the asymptotic expression for $\\omega_H(\\delta)$:\n$$\ng'_H(\\delta) = -\\frac{2(1+1/\\delta)}{\\sqrt{3}}\\left(\\sqrt{3}\\left(1 - \\frac{4}{\\delta}\\right) + O(\\delta^{-2})\\right) = -2\\left(1+\\frac{1}{\\delta}\\right)\\left(1 - \\frac{4}{\\delta}\\right) + O(\\delta^{-2})\n$$\n$$\ng'_H(\\delta) = -2\\left(1 - \\frac{4}{\\delta} + \\frac{1}{\\delta} - \\frac{4}{\\delta^2}\\right) + O(\\delta^{-2}) = -2\\left(1 - \\frac{3}{\\delta} + O(\\delta^{-2})\\right)\n$$\n$$\ng'_H(\\delta) = -2 + \\frac{6}{\\delta} + O(\\delta^{-2})\n$$\nThus, the asymptotic expressions to order $1/\\delta$ are $g'_H(\\delta) = -2 + \\frac{6}{\\delta}$ and $\\omega_H(\\delta) = \\sqrt{3}(1 - \\frac{4}{\\delta})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-2 + \\frac{6}{\\delta}  \\sqrt{3}\\left(1 - \\frac{4}{\\delta}\\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While bifurcation analysis reveals the onset of oscillations, many synthetic circuits operate deep within the oscillatory regime where dynamics are strongly nonlinear and pulse-like. This exercise introduces the powerful technique of asymptotic analysis to study these relaxation oscillations. By assuming high cooperativity and fast mRNA degradation, you will reduce the complex nonlinear system to a set of solvable piecewise dynamics, yielding an elegant analytical expression for the oscillation period .",
            "id": "3937323",
            "problem": "Consider the canonical three-gene repressilator in which gene $i$ ($i \\in \\{1,2,3\\}$, indices modulo $3$) is transcriptionally repressed by the protein of gene $i-1$. Let $m_i(t)$ denote the messenger ribonucleic acid (mRNA) concentration and $p_i(t)$ the corresponding protein concentration for gene $i$. Assume the following nondimensionalized ordinary differential equation (ODE) model grounded in standard transcription-translation kinetics with Hill-type repression:\n$$\n\\frac{d m_i}{d t} \\;=\\; - m_i \\;+\\; \\frac{\\alpha}{1 + \\left(\\frac{p_{i-1}}{K}\\right)^{n}} \\;+\\; \\alpha_0, \n\\qquad\n\\frac{d p_i}{d t} \\;=\\; -\\beta \\left(p_i - m_i\\right),\n$$\nwhere $\\alpha$ is the maximal transcriptional drive, $\\alpha_0$ is a small leak term (basal transcription), $K$ is the repression threshold (the dissociation constant scaled into this nondimensionalization), $n$ is the Hill coefficient, and $\\beta  0$ sets the protein relaxation timescale relative to mRNA. Work in the scientifically relevant relaxation-oscillation limit characterized by (i) $n \\to \\infty$ and $\\alpha_0/\\alpha \\to 0$ with $\\alpha_0  0$ finite, so the promoter behaves as a near-binary switch with small leak, and (ii) fast mRNA relative to protein so that $m_i$ rapidly tracks its quasi-steady value on the slow protein timescale. Assume parameter inequalities $\\alpha  K  \\alpha_0  0$ so that both rise and fall threshold crossings are attainable.\n\nStarting only from the model above and these asymptotic limits, do the following:\n\n- Derive the approximate piecewise protein dynamics during a rise phase (when the upstream repressor $p_{i-1}$ is below $K$ and the promoter is effectively ON) and during a fall phase (when $p_{i-1}$ is above $K$ and the promoter is effectively OFF with only leak).\n- Using a threshold-crossing argument, obtain the approximate time $t_{\\mathrm{rise}}$ it takes for a protein trajectory starting near $\\alpha_0$ to rise and cross the threshold $K$, and the approximate time $t_{\\mathrm{fall}}$ it takes for a trajectory starting near $\\alpha$ to fall and cross the threshold $K$.\n- Combine the results, using the $3$-node ring symmetry and the event-driven switching sequence, to produce a closed-form expression for the oscillation period $T$ of the repressilator in this relaxation limit.\n\nExpress your final answer as a single closed-form analytic expression for $T$ in terms of $\\alpha$, $\\alpha_0$, $\\beta$, and $K$. The time variable is nondimensional, so no physical units are required. No numerical rounding is required; provide an exact expression.",
            "solution": "The problem asks for the period of the repressilator in the relaxation oscillation limit. We start by simplifying the model based on the given asymptotic limits.\n\n**1. Model Simplification**\n\n*   **High Cooperativity ($n \\to \\infty$):** The Hill function, $\\frac{\\alpha}{1 + (p_{i-1}/K)^{n}}$, behaves like a step function.\n    *   If $p_{i-1}  K$, the term becomes $\\alpha$.\n    *   If $p_{i-1} > K$, the term becomes $0$.\n*   **Fast mRNA Dynamics (Quasi-Steady-State Approximation):** We assume mRNA concentration instantaneously adjusts to its equilibrium by setting $\\frac{dm_i}{dt} = 0$. This gives $m_i$ as a function of the repressor $p_{i-1}$.\n\nCombining these, the quasi-steady-state mRNA concentration, $m_i^{\\mathrm{qss}}$, is:\n$$\nm_i^{\\mathrm{qss}} \\approx \\begin{cases} \\alpha + \\alpha_0 \\approx \\alpha  \\text{if } p_{i-1}  K \\quad (\\text{Promoter ON}) \\\\ \\alpha_0  \\text{if } p_{i-1} > K \\quad (\\text{Promoter OFF}) \\end{cases}\n$$\nWe use $\\alpha+\\alpha_0 \\approx \\alpha$ because the leak term $\\alpha_0$ is small compared to $\\alpha$.\n\n**2. Piecewise Protein Dynamics**\n\nSubstituting $m_i^{\\mathrm{qss}}$ into the protein ODE, $\\frac{dp_i}{dt} = -\\beta(p_i - m_i)$, gives a piecewise linear model for protein dynamics:\n$$\n\\frac{dp_i}{dt} = \\begin{cases} -\\beta (p_i - \\alpha)  \\text{if } p_{i-1}  K \\quad \\text{(Rise Phase for } p_i\\text{)} \\\\ -\\beta (p_i - \\alpha_0)  \\text{if } p_{i-1} > K \\quad \\text{(Fall Phase for } p_i\\text{)} \\end{cases}\n$$\n\n**3. Calculation of Rise and Fall Times**\n\nThe oscillation consists of each protein switching between a low concentration near $\\alpha_0$ and a high concentration near $\\alpha$. The switching occurs when a protein crosses the threshold $K$.\n\n*   **Rise Time ($t_{\\mathrm{rise}}$):** We calculate the time it takes for a protein $p_i$ to rise from its minimum value (approximately $\\alpha_0$) to the threshold $K$. This happens during its \"Rise Phase.\" We solve the ODE $\\frac{dp_i}{dt} = -\\beta (p_i - \\alpha)$ with initial condition $p_i(0) = \\alpha_0$:\n    $$ \\int_{\\alpha_0}^{K} \\frac{dp_i}{p_i - \\alpha} = \\int_{0}^{t_{\\mathrm{rise}}} -\\beta dt \\implies \\left[ \\ln|\\alpha - p_i| \\right]_{\\alpha_0}^{K} = \\beta t_{\\mathrm{rise}} $$\n    $$ \\ln(\\alpha - K) - \\ln(\\alpha - \\alpha_0) = -\\beta t_{\\mathrm{rise}} $$\n    $$ t_{\\mathrm{rise}} = \\frac{1}{\\beta} \\ln\\left(\\frac{\\alpha - \\alpha_0}{\\alpha - K}\\right) $$\n\n*   **Fall Time ($t_{\\mathrm{fall}}$):** We calculate the time for $p_i$ to fall from its maximum value (approximately $\\alpha$) to the threshold $K$. This occurs during the \"Fall Phase.\" We solve $\\frac{dp_i}{dt} = -\\beta(p_i - \\alpha_0)$ with initial condition $p_i(0) = \\alpha$:\n    $$ \\int_{\\alpha}^{K} \\frac{dp_i}{p_i - \\alpha_0} = \\int_{0}^{t_{\\mathrm{fall}}} -\\beta dt \\implies \\left[ \\ln(p_i - \\alpha_0) \\right]_{\\alpha}^{K} = -\\beta t_{\\mathrm{fall}} $$\n    $$ \\ln(K - \\alpha_0) - \\ln(\\alpha - \\alpha_0) = -\\beta t_{\\mathrm{fall}} $$\n    $$ t_{\\mathrm{fall}} = \\frac{1}{\\beta} \\ln\\left(\\frac{\\alpha - \\alpha_0}{K - \\alpha_0}\\right) $$\n\n**4. Total Oscillation Period**\n\nThe total period $T$ of the oscillation is the time for the entire three-protein system to complete one full cycle. Due to the cyclic symmetry, a full cycle consists of three rise phases and three fall phases (one for each protein).\n$$ T = 3 \\times t_{\\mathrm{rise}} + 3 \\times t_{\\mathrm{fall}} = 3(t_{\\mathrm{rise}} + t_{\\mathrm{fall}}) $$\nSubstituting the expressions for the rise and fall times:\n$$ T = \\frac{3}{\\beta} \\left[ \\ln\\left(\\frac{\\alpha - \\alpha_0}{\\alpha - K}\\right) + \\ln\\left(\\frac{\\alpha - \\alpha_0}{K - \\alpha_0}\\right) \\right] $$\nUsing the logarithm property $\\ln(a) + \\ln(b) = \\ln(ab)$:\n$$ T = \\frac{3}{\\beta} \\ln\\left[ \\frac{(\\alpha - \\alpha_0)^2}{(\\alpha - K)(K - \\alpha_0)} \\right] $$\nThis is the final expression for the period in the relaxation limit.",
            "answer": "$$\\boxed{T = \\frac{3}{\\beta} \\ln\\left( \\frac{(\\alpha - \\alpha_0)^{2}}{(\\alpha - K)(K - \\alpha_0)} \\right)}$$"
        },
        {
            "introduction": "Bridging theory and experiment requires confronting the challenge of parameter estimation from noisy data. This computational practice explores the crucial concept of practical identifiability: can we uniquely determine a model's parameters from a given dataset? You will use the profile likelihood method to investigate the structural relationship between transcriptional delay ($\\tau$) and Hill cooperativity ($n$), learning how data quality (noise, duration, sampling rate) impacts our ability to confidently infer these key biological parameters .",
            "id": "3937200",
            "problem": "You are asked to evaluate the practical identifiability of the transcriptional delay parameter and the Hill cooperativity exponent in a three-gene cyclic repressor oscillator (the repressilator) using profile likelihoods computed from synthetic time series data. The problem must be solved by writing a complete, runnable program.\n\nThe modeling base shall be the following well-tested principles:\n- The Central Dogma of molecular biology implies that messenger ribonucleic acid (mRNA) concentration dynamics result from transcription and degradation, and protein concentration dynamics result from translation and degradation.\n- Transcriptional repression can be modeled by a Hill repression function that depends on a repressor protein concentration raised to a Hill cooperativity exponent.\n- A discrete transcriptional delay can be approximated by a linear chain of first-order filters (a gamma-distributed delay approximation), which is a standard reduction of a delay differential equation to an ordinary differential equation.\n\nModel specification:\n- There are $3$ genes indexed cyclically by $i \\in \\{1,2,3\\}$; let $m_i(t)$ denote the mRNA concentration of gene $i$, and $p_i(t)$ denote the protein concentration of gene $i$.\n- Transcription of gene $i$ is repressed by a delayed version of the protein of gene $i-1$ (with the convention that gene $0$ means gene $3$). The repression uses a Hill function with cooperativity $n$.\n- The delay of mean $\\tau$ is approximated by a chain of $K$ identical first-order filters with rate $\\kappa$, where $\\kappa = K/\\tau$ so that the mean delay is $\\tau$.\n\nState dynamics:\n- For each $i \\in \\{1,2,3\\}$,\n  - mRNA dynamics: $\\dfrac{d m_i}{dt} = a_0 + \\dfrac{a}{1 + \\left(\\tilde{p}_{i-1}(t)\\right)^n} - \\gamma_m m_i$,\n  - protein dynamics: $\\dfrac{d p_i}{dt} = \\beta \\left(m_i - p_i\\right)$,\n  - delay chain for each protein $p_i$: define $z_{i,0}, z_{i,1}, \\dots, z_{i,K-1}$ with\n    - $\\dfrac{d z_{i,0}}{dt} = \\kappa \\left(p_i - z_{i,0}\\right)$,\n    - $\\dfrac{d z_{i,j}}{dt} = \\kappa \\left(z_{i,j-1} - z_{i,j}\\right)$ for $j \\in \\{1,\\dots,K-1\\}$,\n    - the delayed repressor used in the Hill term is $\\tilde{p}_i(t) = z_{i,K-1}(t)$.\n- Parameters $a_0$, $a$, $\\beta$, $\\gamma_m$, and $\\gamma_p$ are positive constants and $\\gamma_p$ is embedded in the protein equation via $\\beta$ as written above.\n- Use $K = 3$, $a_0 = 0.03$, $a = 50.0$, $\\beta = 5.0$, and $\\gamma_m = 1.0$.\n- The two parameters of interest are the mean delay $\\tau$ and the Hill cooperativity exponent $n$.\n\nData generation:\n- Use the above model to generate synthetic data with ground-truth parameters $\\tau^\\star = 5.0$ and $n^\\star = 2.4$.\n- Initial conditions: for all $i$, set $m_i(0) = 0.1$, $p_i(0) \\in \\{0.1, 0.2, 0.15\\}$ for $i \\in \\{1,2,3\\}$ respectively, and for all $i$ and all delay-chain states $z_{i,j}(0) = p_i(0)$.\n- Simulate the model and sample the protein concentrations $p_i(t)$ at a uniform grid of times.\n- Add independent, zero-mean Gaussian noise with standard deviation $\\sigma$ to each sampled protein measurement.\n\nLikelihood model and profile likelihood:\n- Assume independent and identically distributed Gaussian measurement errors with an unknown variance parameter.\n- Practical identifiability for a parameter is assessed by the shape of its profile likelihood with the other parameter optimized out, and whether the $95\\%$ confidence set inferred from the likelihood ratio is bounded within the parameter grid considered.\n- Your program must derive the appropriate likelihood ratio statistic from the Gaussian assumption (with unknown variance) and use it to construct the statistic. Do not hard-code any “shortcut” formulas; use first principles from the Gaussian likelihood to construct the statistic.\n\nTest suite:\n- Use three test cases by varying the observation time window $T$, sampling interval $\\Delta t$, and noise standard deviation $\\sigma$:\n  - Case A (informative): $T = 200.0$, $\\Delta t = 1.0$, $\\sigma = 0.3$.\n  - Case B (high noise): $T = 200.0$, $\\Delta t = 1.0$, $\\sigma = 5.0$.\n  - Case C (short and sparse): $T = 60.0$, $\\Delta t = 2.0$, $\\sigma = 0.3$.\n- For each case, use a profiling grid with $7$ equispaced values for $\\tau$ in $[1.5, 8.5]$ and $7$ equispaced values for $n$ in $[1.4, 3.8]$.\n- For each case, define practical identifiability for $\\tau$ (respectively $n$) as “true” if and only if the set of grid values where the profile likelihood ratio stays within the $95\\%$ confidence region (based on a single degree-of-freedom likelihood ratio) is bounded strictly within the grid on both sides; otherwise “false”.\n\nComputational guidance:\n- Use ordinary differential equation simulation of the linear-chain-augmented repressilator. You may use an adaptive solver.\n- For each case, compute the sum of squared residuals between the simulated proteins and the noisy observations across all genes and time points and derive the corresponding profile likelihood ratio curves for $\\tau$ and $n$ over the given grids.\n- To construct the profiles, for each fixed $\\tau$ value minimize the discrepancy over the $n$ grid, and for each fixed $n$ value minimize the discrepancy over the $\\tau$ grid. Use the global minimum discrepancy over the full $7 \\times 7$ grid to anchor the profile likelihood ratio.\n\nRequired outputs:\n- For each of the three cases, output two boolean values in order: practical identifiability of $\\tau$, practical identifiability of $n$ (in that order).\n- Your program should produce a single line of output containing a list of lists, one per test case, e.g., $[[b_{11}, b_{12}], [b_{21}, b_{22}], [b_{31}, b_{32}]]$ where each $b_{ij}$ is either $\\mathrm{True}$ or $\\mathrm{False}$.\n\nFinal output format:\n- Your program must produce a single line that is exactly a Python-style list of three lists of booleans, in the order of Cases A, B, C, printed with no extra text, for example: $[[\\mathrm{True}, \\mathrm{False}], [\\mathrm{False}, \\mathrm{False}], [\\mathrm{True}, \\mathrm{True}]]$.",
            "solution": "The objective is to evaluate the practical identifiability of two key parameters of the repressilator genetic oscillator model—the mean transcriptional delay $\\tau$ and the Hill cooperativity exponent $n$—using profile likelihood analysis computed from synthetic time-series data.\n\n**Model Formulation**\n\nThe system consists of $3$ genes, indexed cyclically. The state of the system at time $t$ is described by the concentrations of messenger RNA ($m_i(t)$) and protein ($p_i(t)$) for each gene $i \\in \\{1, 2, 3\\}$. The transcriptional delay is modeled by a linear chain of $K$ intermediate states, $z_{i,j}(t)$, which provides a gamma-distributed approximation to a discrete delay. With $K=3$ genes and a delay chain of length $K=3$, the total number of state variables is $3 \\times (1 \\text{ mRNA} + 1 \\text{ protein} + 3 \\text{ delay states}) = 15$. Let the state vector be $Y(t) = [m_1, m_2, m_3, p_1, p_2, p_3, z_{1,0}, z_{1,1}, z_{1,2}, z_{2,0}, z_{2,1}, z_{2,2}, z_{3,0}, z_{3,1}, z_{3,2}]^T$.\n\nThe dynamics are governed by a set of ordinary differential equations (ODEs). For each gene $i \\in \\{1, 2, 3\\}$, the equations are:\n\n1.  **mRNA dynamics**: Transcription is modeled as a sum of a basal rate $a_0$ and a repressed term, followed by first-order degradation with rate $\\gamma_m$. The repression of gene $i$ is exerted by the delayed protein of gene $i-1$ (with gene $0$ understood as gene $3$), modeled by a Hill function.\n    $$\n    \\frac{d m_i}{dt} = a_0 + \\frac{a}{1 + \\left(\\tilde{p}_{i-1}(t)\\right)^n} - \\gamma_m m_i\n    $$\n    where $\\tilde{p}_{i-1}(t)$ is the delayed concentration of the repressor protein.\n\n2.  **Protein dynamics**: Protein is translated from mRNA at a rate proportional to $m_i$ and degrades with a first-order rate. The problem specifies a single parameter $\\beta$ for both processes.\n    $$\n    \\frac{d p_i}{dt} = \\beta (m_i - p_i)\n    $$\n\n3.  **Delay dynamics**: The delay of mean $\\tau$ is approximated by a chain of $K$ first-order filters, each with a rate constant $\\kappa = K/\\tau$.\n    \\begin{align*}\n    \\frac{d z_{i,0}}{dt} = \\kappa (p_i - z_{i,0}) \\\\\n    \\frac{d z_{i,j}}{dt} = \\kappa (z_{i,j-1} - z_{i,j}), \\quad \\text{for } j \\in \\{1, \\dots, K-1\\}\n    \\end{align*}\n    The output of the delay chain, which serves as the repressor concentration in the Hill function, is the last state in the chain:\n    $$\n    \\tilde{p}_i(t) = z_{i,K-1}(t)\n    $$\n\nThe fixed model parameters are given as $K=3$, $a_0=0.03$, $a=50.0$, $\\beta=5.0$, and $\\gamma_m=1.0$.\n\n**Likelihood Model and Profile Likelihood**\n\nSynthetic data are generated by simulating the model with ground-truth parameters $\\theta^\\star = (\\tau^\\star, n^\\star) = (5.0, 2.4)$ and adding noise. The measurements $y_{i,k}$ of protein concentrations $p_i$ at time points $t_k$ are modeled as:\n$$\ny_{i,k} = p_i(t_k; \\theta) + \\epsilon_{i,k}\n$$\nwhere $\\theta = (\\tau, n)$ is the parameter vector and $\\epsilon_{i,k}$ are independent and identically distributed (i.i.d.) Gaussian errors with mean $0$ and unknown variance $\\sigma^2$, i.e., $\\epsilon_{i,k} \\sim \\mathcal{N}(0, \\sigma^2)$.\n\nThe likelihood of observing the data $\\mathbf{y}$ given parameters $\\theta$ and $\\sigma^2$ is the product of the probabilities of each measurement:\n$$\nL(\\theta, \\sigma^2 | \\mathbf{y}) = \\prod_{i=1}^{3} \\prod_{k=1}^{N_t} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_{i,k} - p_i(t_k; \\theta))^2}{2\\sigma^2}\\right)\n$$\nwhere $N_t$ is the number of time points. The log-likelihood function is:\n$$\n\\ell(\\theta, \\sigma^2 | \\mathbf{y}) = -\\frac{N_{total}}{2} \\log(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{3} \\sum_{k=1}^{N_t} (y_{i,k} - p_i(t_k; \\theta))^2\n$$\nwhere $N_{total} = 3 \\times N_t$ is the total number of data points. Let the Sum of Squared Residuals be $\\text{SSR}(\\theta) = \\sum_{i,k} (y_{i,k} - p_i(t_k; \\theta))^2$. Then:\n$$\n\\ell(\\theta, \\sigma^2 | \\mathbf{y}) = -\\frac{N_{total}}{2} \\log(2\\pi\\sigma^2) - \\frac{\\text{SSR}(\\theta)}{2\\sigma^2}\n$$\nFor a fixed $\\theta$, maximizing $\\ell$ with respect to $\\sigma^2$ yields the maximum likelihood estimate (MLE) for the variance: $\\hat{\\sigma}^2(\\theta) = \\text{SSR}(\\theta) / N_{total}$. Substituting this back gives the plug-in or concentrated log-likelihood:\n$$\n\\ell_{conc}(\\theta) = -\\frac{N_{total}}{2} \\left( \\log(2\\pi) + \\log\\left(\\frac{\\text{SSR}(\\theta)}{N_{total}}\\right) + 1 \\right)\n$$\nMaximizing $\\ell_{conc}(\\theta)$ is equivalent to minimizing $\\text{SSR}(\\theta)$. The global MLE parameters, $\\hat{\\theta} = (\\hat{\\tau}, \\hat{n})$, are those that minimize the SSR. Let this global minimum be $\\text{SSR}_{\\text{min}} = \\text{SSR}(\\hat{\\theta})$. The corresponding maximum log-likelihood value is $\\ell_{max} = \\ell_{conc}(\\hat{\\theta})$.\n\nThe profile likelihood for a single parameter, e.g., $\\tau$, is obtained by maximizing the likelihood over the other \"nuisance\" parameters. The profile log-likelihood for $\\tau$ is:\n$$\n\\ell_{prof}(\\tau) = \\max_{n, \\sigma^2} \\ell(\\tau, n, \\sigma^2 | \\mathbf{y}) = \\ell_{conc}(\\tau, \\hat{n}(\\tau))\n$$\nwhere $\\hat{n}(\\tau)$ is the value of $n$ that minimizes $\\text{SSR}(\\tau, n)$ for the given $\\tau$. Let $\\text{SSR}_{prof}(\\tau) = \\min_n \\text{SSR}(\\tau, n)$.\n\nTo assess identifiability, we use the likelihood ratio test statistic. For a specific value $\\tau_0$, the statistic is:\n$$\n\\lambda(\\tau_0) = 2(\\ell_{max} - \\ell_{prof}(\\tau_0))\n$$\nSubstituting the expressions for the log-likelihoods:\n$$\n\\lambda(\\tau_0) = 2 \\left[ -\\frac{N_{total}}{2} \\left(\\log\\left(\\frac{\\text{SSR}_{\\text{min}}}{N_{total}}\\right) + C\\right) - \\left(-\\frac{N_{total}}{2} \\left(\\log\\left(\\frac{\\text{SSR}_{prof}(\\tau_0)}{N_{total}}\\right) + C\\right)\\right) \\right]\n$$\nwhere $C = \\log(2\\pi) + 1$. This simplifies to:\n$$\n\\lambda(\\tau_0) = N_{total} \\left( \\log(\\text{SSR}_{prof}(\\tau_0)) - \\log(\\text{SSR}_{\\text{min}}) \\right) = N_{total} \\log\\left(\\frac{\\text{SSR}_{prof}(\\tau_0)}{\\text{SSR}_{\\text{min}}}\\right)\n$$\nUnder the null hypothesis that the true parameter value is $\\tau_0$, $\\lambda(\\tau_0)$ follows a chi-squared distribution with $1$ degree of freedom ($\\chi^2_1$). A $95\\%$ confidence region for $\\tau$ is the set of all $\\tau_0$ values for which we would not reject the hypothesis, i.e., where $\\lambda(\\tau_0) \\le \\chi^2_{1, 0.95} \\approx 3.841$.\n\n**Computational Procedure and Identifiability Criterion**\n\nFor each test case (A, B, C):\n1.  **Generate Data**: Simulate the ODE system using ground-truth parameters ($\\tau^\\star, n^\\star$) to generate true protein concentrations $p_i(t)$. Sample these at specified times and add i.i.d. Gaussian noise with the specified standard deviation $\\sigma$.\n2.  **Grid Search**: For each pair of parameters $(\\tau_j, n_k)$ on the provided $7 \\times 7$ grid, simulate the model and compute the $\\text{SSR}(\\tau_j, n_k)$ between the simulation and the noisy data.\n3.  **Profile Likelihood**:\n    *   Find the global minimum SSR on the grid: $\\text{SSR}_{\\text{min}} = \\min_{j,k} \\text{SSR}(\\tau_j, n_k)$.\n    *   Compute the SSR profiles: $\\text{SSR}_{prof}(\\tau_j) = \\min_k \\text{SSR}(\\tau_j, n_k)$ and $\\text{SSR}_{prof}(n_k) = \\min_j \\text{SSR}(\\tau_j, n_k)$.\n    *   Compute the likelihood ratio statistic profiles $\\lambda(\\tau_j)$ and $\\lambda(n_k)$ using the derived formula.\n4.  **Identifiability Check**: A parameter is deemed practically identifiable if its $95\\%$ confidence set is strictly bounded within its grid. This means the set of grid indices where the $\\lambda$ statistic is below the $\\chi^2_1$ threshold must not include the first ($0$) or last ($6$) index. If the confidence set is empty or touches either boundary, the parameter is classified as not practically identifiable under the given experimental conditions and parameter grid.\n\nThis entire procedure is automated in the following program.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Define fixed model parameters\nA0 = 0.03\nA = 50.0\nBETA = 5.0\nGAMMA_M = 1.0\nK = 3\nNUM_GENES = 3\n\n# Ground-truth parameters for data generation\nTAU_TRUTH = 5.0\nN_TRUTH = 2.4\n\n# Initial conditions\nM_INIT = [0.1] * NUM_GENES\nP_INIT = [0.1, 0.2, 0.15]\nZ_INIT_FLAT = [p for p in P_INIT for _ in range(K)]\nY0 = np.array(M_INIT + P_INIT + Z_INIT_FLAT)\n\ndef repressilator_ode(t, y, tau, n):\n    \"\"\"\n    ODE system for the repressilator with gamma-distributed delay.\n    State vector y: [m1, m2, m3, p1, p2, p3, z1_0..z1_K-1, z2_0..z2_K-1, z3_0..z3_K-1]\n    \"\"\"\n    dy = np.zeros_like(y)\n    m = y[:NUM_GENES]\n    p = y[NUM_GENES:2*NUM_GENES]\n    \n    # Reshape z to be a (NUM_GENES, K) matrix for easier indexing\n    z = y[2*NUM_GENES:].reshape((NUM_GENES, K))\n    \n    kappa = K / tau if tau > 0 else np.inf\n\n    # Calculate derivatives\n    for i in range(NUM_GENES):\n        # Repressor for gene i is protein (i-1) % NUM_GENES\n        repressor_idx = (i - 1 + NUM_GENES) % NUM_GENES\n        \n        # The delayed repressor is the last element in its delay chain\n        delayed_repressor = z[repressor_idx, K-1]\n        \n        # mRNA dynamics\n        hill_term = A / (1 + delayed_repressor**n)\n        dy[i] = A0 + hill_term - GAMMA_M * m[i]\n        \n        # Protein dynamics\n        dy[NUM_GENES + i] = BETA * (m[i] - p[i])\n        \n        # Delay chain dynamics\n        # Index for the start of z_i states in dy\n        z_start_idx = 2*NUM_GENES + i*K\n        \n        # First element of the chain\n        dy[z_start_idx] = kappa * (p[i] - z[i, 0])\n        \n        # Subsequent elements\n        for j in range(1, K):\n            dy[z_start_idx + j] = kappa * (z[i, j-1] - z[i, j])\n            \n    return dy\n\ndef generate_data(t_eval, sigma):\n    \"\"\"Generates synthetic noisy data.\"\"\"\n    sol = solve_ivp(\n        fun=repressilator_ode,\n        t_span=(t_eval[0], t_eval[-1]),\n        y0=Y0,\n        t_eval=t_eval,\n        args=(TAU_TRUTH, N_TRUTH),\n        method='LSODA',\n        rtol=1e-6,\n        atol=1e-9\n    )\n    \n    true_protein_data = sol.y[NUM_GENES:2*NUM_GENES, :]\n    noise = np.random.normal(0, sigma, size=true_protein_data.shape)\n    noisy_data = true_protein_data + noise\n    return noisy_data\n\ndef solve():\n    \"\"\"\n    Main function to run the identifiability analysis for all test cases.\n    \"\"\"\n    test_cases = [\n        {'id': 'A', 'T': 200.0, 'dt': 1.0, 'sigma': 0.3},\n        {'id': 'B', 'T': 200.0, 'dt': 1.0, 'sigma': 5.0},\n        {'id': 'C', 'T': 60.0, 'dt': 2.0, 'sigma': 0.3},\n    ]\n\n    tau_grid = np.linspace(1.5, 8.5, 7)\n    n_grid = np.linspace(1.4, 3.8, 7)\n\n    # Chi-squared critical value for 1 DoF, 95% confidence\n    # from scipy.stats.chi2.ppf(0.95, 1)\n    chi2_crit = 3.841458820694124\n\n    # Set a fixed seed for reproducibility of noise generation\n    np.random.seed(42)\n\n    all_results = []\n\n    for case in test_cases:\n        T, dt, sigma = case['T'], case['dt'], case['sigma']\n        t_eval = np.arange(0, T + dt, dt)\n        \n        # 1. Generate synthetic data for the current case\n        noisy_protein_data = generate_data(t_eval, sigma)\n        n_total_datapoints = noisy_protein_data.size\n\n        # 2. Compute SSR grid\n        ssr_grid = np.full((len(tau_grid), len(n_grid)), np.inf)\n\n        for i, tau in enumerate(tau_grid):\n            for j, n in enumerate(n_grid):\n                sol = solve_ivp(\n                    fun=repressilator_ode,\n                    t_span=(t_eval[0], t_eval[-1]),\n                    y0=Y0,\n                    t_eval=t_eval,\n                    args=(tau, n),\n                    method='LSODA',\n                    rtol=1e-6,\n                    atol=1e-9\n                )\n                \n                if sol.success:\n                    sim_protein_data = sol.y[NUM_GENES:2*NUM_GENES, :]\n                    ssr = np.sum((sim_protein_data - noisy_protein_data)**2)\n                    ssr_grid[i, j] = ssr\n\n        # 3. Compute profile likelihoods\n        ssr_min = np.nanmin(ssr_grid)\n        if ssr_min == 0 or not np.isfinite(ssr_min):\n            # Avoid log(0) or log(inf) if simulation or fitting fails globally\n            # In this case, no parameter is identifiable\n            all_results.append([False, False])\n            continue\n            \n        ssr_profile_tau = np.nanmin(ssr_grid, axis=1)\n        ssr_profile_n = np.nanmin(ssr_grid, axis=0)\n\n        # Likelihood ratio statistics\n        # Add a small epsilon to avoid log(0) if a profile SSR matches ssr_min\n        epsilon = 1e-9\n        lambda_tau = n_total_datapoints * np.log((ssr_profile_tau + epsilon) / ssr_min)\n        lambda_n = n_total_datapoints * np.log((ssr_profile_n + epsilon) / ssr_min)\n\n        # 4. Check identifiability\n        def is_identifiable(lambda_profile):\n            confident_mask = lambda_profile = chi2_crit\n            if not np.any(confident_mask):\n                return False\n            \n            confident_indices = np.where(confident_mask)[0]\n            is_bounded = (np.min(confident_indices) > 0) and \\\n                         (np.max(confident_indices)  len(lambda_profile) - 1)\n            return is_bounded\n\n        tau_identifiable = is_identifiable(lambda_tau)\n        n_identifiable = is_identifiable(lambda_n)\n        \n        all_results.append([tau_identifiable, n_identifiable])\n\n    # Final print statement in the exact required format\n    # Example format: [[True, False], [False, False], [True, True]]\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}