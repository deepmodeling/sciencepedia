{
    "hands_on_practices": [
        {
            "introduction": "Understanding feedback begins with its simplest and most common form: negative autoregulation. This foundational exercise guides you through the analysis of the deterministic dynamics of a single-gene circuit where a protein represses its own synthesis . By deriving the steady-state condition and solving for the equilibrium protein concentration, you will practice the essential skill of analyzing the long-term behavior of a core biological motif.",
            "id": "3913123",
            "problem": "In a synthetic gene circuit implementing negative autoregulation, the protein concentration $x$ evolves deterministically according to the ordinary differential equation (ODE)\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1 + (x/K)^{n}} \\;-\\; \\beta\\,x,\n$$\nwhere $\\alpha>0$ is the maximum synthesis rate, $\\beta>0$ is the first-order effective loss rate, $K>0$ is the dissociation constant setting the repression threshold, and $n\\geq 1$ is the Hill coefficient characterizing binding cooperativity. Assume well-mixed conditions and a single, effective regulatory step so that the above ODE captures the coarse-grained dynamics of protein expression under negative feedback.\n\nStarting from the foundational modeling principle that steady states satisfy $\\dot{x}=0$ and from the standard Hill repression form for transcriptional control, derive the steady-state condition that defines the equilibrium expression level $x^{*}$ and use first principles (monotonicity and continuity) to argue whether a unique positive steady state exists for $\\alpha>0$, $\\beta>0$, $K>0$, and $n\\geq 1$. Then, specialize to the noncooperative case $n=1$ and solve exactly for $x^{*}$ in closed form as a function of the parameters $\\alpha$, $\\beta$, and $K$. Finally, state how $x^{*}$ depends on the parameters $(\\alpha,\\beta,K,n)$, making clear which dependencies are increasing or decreasing in the noncooperative case $n=1$, and clarifying the role of $n$.\n\nProvide the final explicit expression for the noncooperative case $n=1$. Do not round; leave your answer in exact analytic form. No units are required for the final answer.",
            "solution": "The user wants to analyze the steady-state properties of a synthetic gene circuit with negative autoregulation.\n\n### Step 1: Extract Givens\nThe problem describes the dynamics of a protein concentration $x$ with the following ordinary differential equation (ODE):\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1 + (x/K)^{n}} \\;-\\; \\beta\\,x\n$$\nThe parameters are defined as:\n- $\\alpha > 0$: maximum synthesis rate.\n- $\\beta > 0$: first-order effective loss rate.\n- $K > 0$: dissociation constant (repression threshold).\n- $n \\geq 1$: Hill coefficient.\n\nThe tasks are:\n1.  Derive the steady-state condition for the equilibrium expression level $x^{*}$.\n2.  Argue for the existence and uniqueness of a positive steady state for the given parameter constraints.\n3.  Solve for the exact closed-form expression of $x^{*}$ in the special case $n=1$.\n4.  Describe the dependence of $x^{*}$ on the parameters, particularly for the $n=1$ case.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n\n- **Scientifically Grounded:** The provided ODE is a canonical model in systems and synthetic biology for describing negative autoregulation. The use of a Hill function for transcriptional regulation and a first-order term for degradation/dilution is a standard and well-established approach. The model is firmly based on fundamental principles of biochemical kinetics.\n- **Well-Posed:** The problem is clearly stated. It asks for a derivation, a proof of uniqueness, and a specific solution for a special case. These are standard mathematical analyses for a dynamical system, and the structure of the problem leads to a unique and meaningful solution.\n- **Objective:** The problem is phrased using precise, objective, and standard scientific terminology. There are no subjective or ambiguous statements.\n- **Completeness and Consistency:** The problem provides all necessary information (the ODE and parameter constraints) to perform the required analysis. There are no missing definitions or contradictions.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist. It is a valid, well-posed, and standard problem in the field of quantitative biology.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe analysis proceeds by first establishing the general condition for steady states, then proving the existence and uniqueness of a positive steady state, and finally solving for this steady state in the specialized noncooperative case.\n\nA steady state of a dynamical system is a state where the system variables do not change over time. For the given system, the steady-state concentration, denoted as $x^{*}$, is the value of $x$ for which the rate of change $\\dot{x}$ is zero.\n$$\n\\dot{x} = 0\n$$\nSubstituting the given ODE, the steady-state condition is:\n$$\n\\frac{\\alpha}{1 + (x^{*}/K)^{n}} - \\beta x^{*} = 0\n$$\nThis equation implicitly defines the steady-state concentration $x^{*}$. It can be rewritten by equating the protein synthesis rate to the protein loss rate:\n$$\n\\frac{\\alpha}{1 + (x^{*}/K)^{n}} = \\beta x^{*}\n$$\n\nTo determine if a unique positive steady state exists, we analyze the intersection of two functions of $x$ for $x > 0$: the production rate function, $P(x) = \\frac{\\alpha}{1 + (x/K)^{n}}$, and the degradation rate function, $D(x) = \\beta x$. A steady state $x^{*}$ corresponds to a point where $P(x^{*}) = D(x^{*})$.\n\nWe analyze the properties of these two functions for $x \\geq 0$:\n\n1.  **Production Rate, $P(x)$:**\n    -   At $x=0$, the production rate is maximal: $P(0) = \\frac{\\alpha}{1 + 0} = \\alpha$. Since $\\alpha > 0$, $P(0) > 0$.\n    -   $P(x)$ is a continuous function for all $x \\geq 0$.\n    -   For $x > 0$, $P(x)$ is a strictly monotonically decreasing function. As $x$ increases, the term $(x/K)^{n}$ increases (since $K>0, n \\geq 1$), which increases the denominator $1+(x/K)^n$. Consequently, the fraction $P(x)$ decreases.\n    -   In the limit as $x \\to \\infty$, the denominator grows without bound, so the production rate approaches zero: $\\lim_{x \\to \\infty} P(x) = 0$.\n\n2.  **Degradation Rate, $D(x)$:**\n    -   At $x=0$, the degradation rate is zero: $D(0) = \\beta \\cdot 0 = 0$.\n    -   $D(x)$ is a continuous function for all $x \\geq 0$.\n    -   For $x > 0$, $D(x)$ is a strictly monotonically increasing function. It represents a straight line passing through the origin with a positive slope $\\beta$.\n\nBy comparing the two functions:\n-   At $x=0$, we have $P(0) = \\alpha$ and $D(0) = 0$. Since $\\alpha > 0$, we have $P(0) > D(0)$.\n-   As $x \\to \\infty$, we have $P(x) \\to 0$ and $D(x) \\to \\infty$. Therefore, for a sufficiently large value of $x$, we must have $D(x) > P(x)$.\n\nSince both $P(x)$ and $D(x)$ are continuous functions, and the function $f(x) = P(x) - D(x)$ changes sign from positive at $x=0$ to negative for large $x$, the Intermediate Value Theorem guarantees that there must be at least one root $x^{*} > 0$ where $f(x^{*}) = 0$, or $P(x^{*}) = D(x^{*})$.\n\nTo prove uniqueness, we observe that $P(x)$ is strictly decreasing for $x > 0$, while $D(x)$ is strictly increasing for $x > 0$. A strictly decreasing function and a strictly increasing function can intersect at most once for $x > 0$. Therefore, the positive steady state $x^{*}$ is unique. This holds for all $\\alpha>0$, $\\beta>0$, $K>0$, and $n\\geq 1$.\n\nNext, we specialize to the noncooperative case, where the Hill coefficient $n=1$. The steady-state equation becomes:\n$$\n\\frac{\\alpha}{1 + x^{*}/K} - \\beta x^{*} = 0\n$$\nTo solve for $x^{*}$, we rearrange the equation:\n$$\n\\alpha = \\beta x^{*} \\left(1 + \\frac{x^{*}}{K}\\right)\n$$\n$$\n\\alpha = \\beta x^{*} + \\frac{\\beta}{K} (x^{*})^{2}\n$$\nThis is a quadratic equation in the variable $x^{*}$:\n$$\n\\frac{\\beta}{K} (x^{*})^{2} + \\beta x^{*} - \\alpha = 0\n$$\nWe use the quadratic formula, $x^{*} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a = \\frac{\\beta}{K}$, $b = \\beta$, and $c = -\\alpha$.\n$$\nx^{*} = \\frac{-\\beta \\pm \\sqrt{\\beta^2 - 4\\left(\\frac{\\beta}{K}\\right)(-\\alpha)}}{2\\left(\\frac{\\beta}{K}\\right)}\n$$\n$$\nx^{*} = \\frac{-\\beta \\pm \\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}}{\\frac{2\\beta}{K}}\n$$\nSince protein concentration $x^{*}$ must be a positive physical quantity, we must choose the positive root (the '-' sign would yield a negative value).\n$$\nx^{*} = \\frac{-\\beta + \\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}}{\\frac{2\\beta}{K}}\n$$\nWe can simplify this expression by factoring out $\\beta$ from the square root term:\n$$\nx^{*} = \\frac{-\\beta + \\sqrt{\\beta^2 \\left(1 + \\frac{4\\alpha}{\\beta K}\\right)}}{\\frac{2\\beta}{K}} = \\frac{-\\beta + \\beta\\sqrt{1 + \\frac{4\\alpha}{\\beta K}}}{\\frac{2\\beta}{K}}\n$$\nDividing the numerator and denominator by $\\beta$ (since $\\beta > 0$):\n$$\nx^{*} = \\frac{-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}}{\\frac{2}{K}}\n$$\nMultiplying by $\\frac{K}{2}$ gives the final explicit expression for $x^{*}$ when $n=1$:\n$$\nx^{*} = \\frac{K}{2} \\left(-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)\n$$\n\nFinally, we analyze the dependence of the steady state $x^{*}$ on the parameters.\nIn the general case, from the graphical analysis, we can deduce:\n- Increasing $\\alpha$ (maximum production) shifts the $P(x)$ curve up, increasing the intersection point $x^{*}$. So $x^{*}$ is an increasing function of $\\alpha$.\n- Increasing $\\beta$ (loss rate) increases the slope of the $D(x)$ line, decreasing the intersection point $x^{*}$. So $x^{*}$ is a decreasing function of $\\beta$.\n- Increasing $K$ (repression threshold) weakens the repression for a given $x$, which means $P(x)$ increases for any $x>0$. This shifts the $P(x)$ curve up, increasing the intersection point $x^{*}$. So $x^{*}$ is an increasing function of $K$.\n- The Hill coefficient $n$ controls the steepness of the repression. Increasing $n$ makes the feedback more switch-like. For $x < K$, increasing $n$ raises the production curve $P(x)$, while for $x > K$, it lowers it. Its effect on $x^*$ thus depends on the other parameters.\n\nFor the noncooperative case $n=1$, we can verify these dependencies from the explicit solution:\n$$\nx^{*} = \\frac{K}{2} \\left(-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)\n$$\n- As $\\alpha$ increases, the term under the square root increases, so $x^{*}$ increases.\n- As $\\beta$ increases, the term under the square root decreases, so $x^{*}$ decreases.\n- As $K$ increases, the dependence is more complex. Let $f(K) = x^{*}$. As shown in the preparatory thoughts, the derivative $\\frac{df}{dK} = \\frac{(\\sqrt{1+4\\alpha/(\\beta K)}-1)^2}{4\\sqrt{1+4\\alpha/(\\beta K)}}$ is always positive for positive parameters, so $x^{*}$ is an increasing function of $K$.\nThese explicit dependencies for $n=1$ confirm the conclusions from the general graphical argument.",
            "answer": "$$\n\\boxed{\\frac{K}{2} \\left(-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)}\n$$"
        },
        {
            "introduction": "Biological function rarely arises from isolated components; it emerges from networks of interacting parts. This practice moves from a single gene to a two-gene 'toggle switch' motif, exploring how mutual repression shapes the system's response to perturbations . Here, you will apply linear stability analysis, a cornerstone of dynamical systems theory, by computing the Jacobian matrix to determine if the network's symmetric steady state is stable.",
            "id": "3913190",
            "problem": "Consider a two-gene synthetic feedback network in which one gene represses the other with first-order Hill kinetics. Let the state variables be the dimensionless concentrations $x$ and $y$, and suppose the dynamics are given by the system of ordinary differential equations (ODEs)\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1 + y/K} \\;-\\; \\gamma\\,x,\\qquad\n\\dot{y} \\;=\\; \\frac{\\alpha}{1 + x/K} \\;-\\; \\gamma\\,y,\n$$\nwhere $\\alpha>0$ is a maximal production rate, $K>0$ is a repression threshold, and $\\gamma>0$ is a first-order loss rate (e.g., dilution or degradation). This network implements mutual negative feedback via repression, and you may assume symmetry in parameters. For the specific parameter set $\\alpha = 2$, $K = 1$, and $\\gamma = 1$, carry out the following:\n\n1. Determine the unique symmetric equilibrium $(x^{*}, y^{*})$ that satisfies $\\dot{x}=\\dot{y}=0$ under these parameters.\n2. Compute the Jacobian matrix $J(x^{*},y^{*})$ obtained by linearizing the system at $(x^{*}, y^{*})$, i.e.,\n$$\nJ(x^{*},y^{*}) \\;=\\; \n\\begin{pmatrix}\n\\frac{\\partial f}{\\partial x} & \\frac{\\partial f}{\\partial y} \\\\\n\\frac{\\partial g}{\\partial x} & \\frac{\\partial g}{\\partial y}\n\\end{pmatrix}\\Bigg|_{(x^{*},y^{*})},\n$$\nwhere $f(x,y) = \\frac{\\alpha}{1 + y/K} - \\gamma x$ and $g(x,y) = \\frac{\\alpha}{1 + x/K} - \\gamma y$.\n3. Using the trace-determinant characterization for two-dimensional linear systems, assess local stability of the equilibrium and compute the spectral abscissa $\\lambda_{\\max}$, defined as the largest real part among the eigenvalues of $J(x^{*},y^{*})$.\n\nExpress your final numerical answer for $\\lambda_{\\max}$ in units of $\\text{time}^{-1}$. No rounding instruction is necessary; give the exact value implied by the parameters provided.",
            "solution": "The problem requires a stability analysis of a two-gene synthetic feedback network described by a system of ordinary differential equations (ODEs). The process involves three steps: finding the symmetric equilibrium point, calculating the Jacobian matrix at that point, and then determining the eigenvalues to assess stability and find the spectral abscissa.\n\nThe system dynamics are given by:\n$$\n\\dot{x} = f(x,y) = \\frac{\\alpha}{1 + y/K} - \\gamma x\n$$\n$$\n\\dot{y} = g(x,y) = \\frac{\\alpha}{1 + x/K} - \\gamma y\n$$\nThe specific parameters are provided as $\\alpha = 2$, $K = 1$, and $\\gamma = 1$.\n\n**Step 1: Determine the symmetric equilibrium $(x^{*}, y^{*})$**\n\nAn equilibrium point $(x, y)$ of the system is a point where the rates of change are zero, i.e., $\\dot{x} = 0$ and $\\dot{y} = 0$. This gives the following system of algebraic equations:\n$$\n\\frac{\\alpha}{1 + y/K} - \\gamma x = 0\n$$\n$$\n\\frac{\\alpha}{1 + x/K} - \\gamma y = 0\n$$\nWe are looking for a symmetric equilibrium, which is defined by the condition $x = y$. Let us denote this common value by $x^*$, so that $(x^*, y^*) = (x^*, x^*)$. Substituting $y=x$ into the first equation (or second, due to symmetry) yields:\n$$\n\\frac{\\alpha}{1 + x/K} - \\gamma x = 0\n$$\nNow, we substitute the given parameter values $\\alpha = 2$, $K = 1$, and $\\gamma = 1$:\n$$\n\\frac{2}{1 + x/1} - 1 \\cdot x = 0\n$$\n$$\n\\frac{2}{1 + x} = x\n$$\nAssuming $x \\neq -1$, which is physically necessary as concentration cannot be negative, we can multiply both sides by $(1 + x)$:\n$$\n2 = x(1 + x)\n$$\n$$\n2 = x + x^2\n$$\nRearranging this into a standard quadratic equation form gives:\n$$\nx^2 + x - 2 = 0\n$$\nThis equation can be factored as:\n$$\n(x+2)(x-1) = 0\n$$\nThe two mathematical solutions are $x = 1$ and $x = -2$. Since $x$ represents a dimensionless concentration, it must be a non-negative quantity. Therefore, the only physically meaningful solution is $x = 1$.\nThe unique symmetric equilibrium is $(x^{*}, y^{*}) = (1, 1)$.\n\n**Step 2: Compute the Jacobian matrix $J(x^{*},y^{*})$**\n\nThe Jacobian matrix $J(x,y)$ for this two-dimensional system is defined as:\n$$\nJ(x,y) = \n\\begin{pmatrix}\n\\frac{\\partial f}{\\partial x} & \\frac{\\partial f}{\\partial y} \\\\\n\\frac{\\partial g}{\\partial x} & \\frac{\\partial g}{\\partial y}\n\\end{pmatrix}\n$$\nWe calculate the four partial derivatives of $f(x,y) = \\frac{\\alpha}{1 + y/K} - \\gamma x$ and $g(x,y) = \\frac{\\alpha}{1 + x/K} - \\gamma y$:\n$$\n\\frac{\\partial f}{\\partial x} = -\\gamma\n$$\n$$\n\\frac{\\partial f}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\alpha(1 + y/K)^{-1} \\right) = \\alpha \\cdot (-1)(1 + y/K)^{-2} \\cdot (1/K) = -\\frac{\\alpha/K}{(1+y/K)^2} = -\\frac{\\alpha K}{(K+y)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\alpha(1 + x/K)^{-1} \\right) = \\alpha \\cdot (-1)(1 + x/K)^{-2} \\cdot (1/K) = -\\frac{\\alpha/K}{(1+x/K)^2} = -\\frac{\\alpha K}{(K+x)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial y} = -\\gamma\n$$\nSo, the Jacobian matrix at a general point $(x,y)$ is:\n$$\nJ(x,y) = \n\\begin{pmatrix}\n-\\gamma & -\\frac{\\alpha K}{(K+y)^2} \\\\\n-\\frac{\\alpha K}{(K+x)^2} & -\\gamma\n\\end{pmatrix}\n$$\nNow we evaluate this matrix at the equilibrium point $(x^{*}, y^{*}) = (1, 1)$ using the parameters $\\alpha = 2$, $K = 1$, and $\\gamma = 1$:\n$$\nJ(1,1) = \n\\begin{pmatrix}\n-1 & -\\frac{2 \\cdot 1}{(1+1)^2} \\\\\n-\\frac{2 \\cdot 1}{(1+1)^2} & -1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-1 & -\\frac{2}{4} \\\\\n-\\frac{2}{4} & -1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-1 & -\\frac{1}{2} \\\\\n-\\frac{1}{2} & -1\n\\end{pmatrix}\n$$\n\n**Step 3: Assess stability and compute the spectral abscissa $\\lambda_{\\max}$**\n\nThe local stability of the equilibrium is determined by the eigenvalues of the Jacobian matrix $J(1,1)$. The eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(J - \\lambda I) = 0$, where $I$ is the identity matrix. This equation can be written as:\n$$\n\\lambda^2 - \\text{tr}(J)\\lambda + \\det(J) = 0\n$$\nFirst, we compute the trace and determinant of $J(1,1)$:\n$$\n\\text{tr}(J) = -1 + (-1) = -2\n$$\n$$\n\\det(J) = (-1)(-1) - (-\\frac{1}{2})(-\\frac{1}{2}) = 1 - \\frac{1}{4} = \\frac{3}{4}\n$$\nThe characteristic equation is therefore:\n$$\n\\lambda^2 - (-2)\\lambda + \\frac{3}{4} = 0\n$$\n$$\n\\lambda^2 + 2\\lambda + \\frac{3}{4} = 0\n$$\nWe solve this quadratic equation for $\\lambda$ using the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\n\\lambda = \\frac{-2 \\pm \\sqrt{2^2 - 4(1)(\\frac{3}{4})}}{2(1)} = \\frac{-2 \\pm \\sqrt{4 - 3}}{2} = \\frac{-2 \\pm \\sqrt{1}}{2} = \\frac{-2 \\pm 1}{2}\n$$\nThe two eigenvalues are:\n$$\n\\lambda_1 = \\frac{-2 + 1}{2} = -\\frac{1}{2}\n$$\n$$\n\\lambda_2 = \\frac{-2 - 1}{2} = -\\frac{3}{2}\n$$\nFor local stability, all eigenvalues must have negative real parts. Here, both eigenvalues are real and negative ($\\lambda_1 = -1/2 < 0$ and $\\lambda_2 = -3/2 < 0$). Thus, the equilibrium point $(1,1)$ is locally stable. Specifically, since the eigenvalues are real and distinct, it is a stable node.\n\nThe spectral abscissa, $\\lambda_{\\max}$, is defined as the largest real part among the eigenvalues of the Jacobian.\n$$\n\\lambda_{\\max} = \\max(\\text{Re}(\\lambda_1), \\text{Re}(\\lambda_2))\n$$\nSince both eigenvalues are real, we simply take the maximum of the two values:\n$$\n\\lambda_{\\max} = \\max(-\\frac{1}{2}, -\\frac{3}{2}) = -\\frac{1}{2}\n$$\nThe units of the parameters $\\alpha$ and $\\gamma$ are typically concentration per time and per time, respectively. Since the concentrations are dimensionless, the eigenvalues of the Jacobian have units of inverse time, as requested.",
            "answer": "$$\\boxed{-\\frac{1}{2}}$$"
        },
        {
            "introduction": "While deterministic models offer a powerful framework, they neglect the inherent randomness, or noise, of biochemical reactions. This advanced practice transitions to the stochastic realm to analyze an antithetic integral feedback controller, a sophisticated synthetic design for achieving robust performance despite noise . You will use the Linear Noise Approximation (LNA) to derive and compute the magnitude of fluctuations around the system's average behavior, bridging theoretical moment-closure techniques with practical, computational implementation.",
            "id": "3913082",
            "problem": "You are asked to implement and validate a moment-closure-based analysis for a canonical stochastic antithetic integral feedback controller regulating a single molecular species. The controller is modeled as a well-mixed, continuous-time, Markov jump process on a finite set of molecular species with reactions obeying mass-action kinetics. Your task is to derive mean-field dynamics and a second-order noise approximation grounded in first principles, and then to implement a program that computes the stationary mean and variance of the regulated species for a specified test suite of parameters.\n\nStart from the Chemical Master Equation (CME), which gives the time evolution of the probability distribution over molecular counts. Denote the state vector as $x = [x_{X}, x_{Z_{1}}, x_{Z_{2}}]^{\\top}$ where $x_{X}$ is the count of the regulated species $X$, and $x_{Z_{1}}$, $x_{Z_{2}}$ are the counts of the two antithetic controller species $Z_{1}$ and $Z_{2}$. The reaction network is:\n- Production of $X$: $\\varnothing \\xrightarrow{k x_{Z_{1}}} X$ with propensity $a_{1}(x) = k x_{Z_{1}}$.\n- Degradation of $X$: $X \\xrightarrow{\\delta x_{X}} \\varnothing$ with propensity $a_{2}(x) = \\delta x_{X}$.\n- Reference input to $Z_{1}$: $\\varnothing \\xrightarrow{\\mu} Z_{1}$ with propensity $a_{3}(x) = \\mu$.\n- Measurement to $Z_{2}$: $\\varnothing \\xrightarrow{\\theta x_{X}} Z_{2}$ with propensity $a_{4}(x) = \\theta x_{X}$.\n- Antithetic annihilation: $Z_{1} + Z_{2} \\xrightarrow{\\eta x_{Z_{1}} x_{Z_{2}}} \\varnothing$ with propensity $a_{5}(x) = \\eta x_{Z_{1}} x_{Z_{2}}$.\n\nLet the stoichiometry matrix be $S \\in \\mathbb{R}^{3 \\times 5}$, whose columns are the state-change vectors for reactions $1$ through $5$ (ordered as above). The CME implies the exact moment evolution through $ \\frac{d}{dt} \\mathbb{E}[x] = S \\, \\mathbb{E}[a(x)] $, where $a(x) = [a_{1}(x), a_{2}(x), a_{3}(x), a_{4}(x), a_{5}(x)]^{\\top}$. Because $a_{5}(x)$ is bilinear in $x_{Z_{1}}$ and $x_{Z_{2}}$, the mean dynamics are not closed without approximations.\n\nImplement a mean-field closure by approximating $\\mathbb{E}[a(x)] \\approx a(\\mathbb{E}[x])$. Under this closure, you obtain a deterministic drift $f(m) = S \\, a(m)$ for the mean $m = \\mathbb{E}[x]$, which yields a closed ordinary differential equation for $m(t)$:\n- Derive these mean-field dynamics explicitly in terms of $m_{X}(t)$, $m_{Z_{1}}(t)$, and $m_{Z_{2}}(t)$ from the fundamental laws above, without assuming any target formulas in advance.\n- Derive the steady-state mean $m^{\\star}$ by solving $f(m^{\\star}) = 0$.\n\nTo assess noise around the mean-field steady state, use the Linear Noise Approximation (LNA), which is a second-order approximation derived from the van Kampen system-size expansion. Let $A$ be the Jacobian (matrix of partial derivatives) of $f(m)$ evaluated at $m^{\\star}$, and let $D$ be the diffusion matrix given by $D = S \\, \\mathrm{diag}(a(m^{\\star})) \\, S^{\\top}$. Under the LNA, the stationary covariance $\\Sigma$ approximately satisfies the continuous-time Lyapunov equation $A \\Sigma + \\Sigma A^{\\top} + D = 0$. Derive $A$ and $D$ from the fundamental definitions.\n\nYour program must:\n- Compute the steady-state mean $m^{\\star}$ under mean-field closure for each parameter set.\n- Compute the stationary covariance matrix $\\Sigma$ by solving the Lyapunov equation; report the variance of $X$ as $\\Sigma_{XX}$.\n- Aggregate, for each test case, the pair $[m^{\\star}_{X}, \\Sigma_{XX}]$, where both entries must be real numbers.\n\nUse the following test suite of parameter values, where each tuple is $(\\mu, \\theta, \\eta, k, \\delta)$:\n- Case $1$ (general): $(20.0, 2.0, 0.5, 1.0, 0.1)$.\n- Case $2$ (weak sequestration): $(20.0, 2.0, 0.01, 1.0, 0.1)$.\n- Case $3$ (strong actuation): $(20.0, 2.0, 0.5, 10.0, 0.1)$.\n- Case $4$ (low measurement gain): $(20.0, 0.05, 0.5, 1.0, 0.1)$.\n- Case $5$ (low reference): $(0.2, 2.0, 0.5, 1.0, 0.1)$.\n\nScientific realism and self-consistency requirements:\n- All parameters $\\mu, \\theta, \\eta, k, \\delta$ are strictly positive real numbers and represent reaction rate constants in a well-mixed volume under mass-action kinetics. There are no additional hidden parameters.\n- No ad hoc formulas are allowed beyond those derived from the Chemical Master Equation (CME), stoichiometry, and mass-action propensities, combined with the mean-field closure and the Linear Noise Approximation (LNA).\n\nFinal output format:\n- For each test case, output the pair $[m^{\\star}_{X}, \\Sigma_{XX}]$ with both values rounded to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list of these pairs, enclosed in square brackets, for example: $[[v_{1},w_{1}],[v_{2},w_{2}],\\dots]$ where each $v_{i}$ and $w_{i}$ are floats rounded to $6$ decimals.\n- No additional text should be printed.\n\nAngle units: none. Physical units: none. Percentages: none. The answer must be unitless real numbers rounded to $6$ decimal places.",
            "solution": "The problem is scientifically grounded, well-posed, and self-contained, providing all necessary information to derive and compute the requested quantities. The modeling framework, based on the Chemical Master Equation (CME), mean-field closure, and the Linear Noise Approximation (LNA), is standard in the field of stochastic biochemical kinetics and synthetic biology. Therefore, the problem is valid.\n\nThe solution proceeds by first deriving the analytical expressions for the mean-field dynamics and the components of the LNA, and then implementing a numerical calculation for the specified test cases.\n\nThe state of the system is the vector of molecular counts $x = [x_{X}, x_{Z_{1}}, x_{Z_{2}}]^\\top$. The reactions and their mass-action propensities $a_i(x)$ are given as:\n$1$. Production of $X$: $\\varnothing \\xrightarrow{k x_{Z_{1}}} X$ with propensity $a_{1}(x) = k x_{Z_{1}}$.\n$2$. Degradation of $X$: $X \\xrightarrow{\\delta x_{X}} \\varnothing$ with propensity $a_{2}(x) = \\delta x_{X}$.\n$3$. Production of $Z_{1}$: $\\varnothing \\xrightarrow{\\mu} Z_{1}$ with propensity $a_{3}(x) = \\mu$.\n$4$. Production of $Z_{2}$: $\\varnothing \\xrightarrow{\\theta x_{X}} Z_{2}$ with propensity $a_{4}(x) = \\theta x_{X}$.\n$5$. Annihilation: $Z_{1} + Z_{2} \\xrightarrow{\\eta x_{Z_{1}} x_{Z_{2}}} \\varnothing$ with propensity $a_{5}(x) = \\eta x_{Z_{1}} x_{Z_{2}}$.\nThe propensity vector is $a(x) = [k x_{Z_{1}}, \\delta x_{X}, \\mu, \\theta x_{X}, \\eta x_{Z_{1}} x_{Z_{2}}]^\\top$.\n\nThe state-change vectors for these $5$ reactions are, respectively:\n$\\Delta x_1 = [1, 0, 0]^\\top$\n$\\Delta x_2 = [-1, 0, 0]^\\top$\n$\\Delta x_3 = [0, 1, 0]^\\top$\n$\\Delta x_4 = [0, 0, 1]^\\top$\n$\\Delta x_5 = [0, -1, -1]^\\top$\nThese form the columns of the stoichiometry matrix $S \\in \\mathbb{R}^{3 \\times 5}$:\n$$\nS = \\begin{pmatrix}\n1 & -1 & 0 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & -1 \\\\\n0 & 0 & 0 & 1 & -1\n\\end{pmatrix}\n$$\nThe evolution of the mean species counts $m(t) = \\mathbb{E}[x(t)]$ is governed by $\\frac{d}{dt}m = S \\mathbb{E}[a(x)]$. We apply a mean-field closure, which approximates the expectation of the propensities by the propensities of the expectations: $\\mathbb{E}[a(x)] \\approx a(\\mathbb{E}[x]) = a(m)$. This yields a closed system of ordinary differential equations (ODEs) for the means, $\\frac{d}{dt}m = f(m) = S a(m)$. Let $m = [m_X, m_{Z_1}, m_{Z_2}]^\\top$.\n$$\n\\frac{d}{dt}m = \\begin{pmatrix}\n1 & -1 & 0 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & -1 \\\\\n0 & 0 & 0 & 1 & -1\n\\end{pmatrix}\n\\begin{pmatrix}\nk m_{Z_1} \\\\\n\\delta m_X \\\\\n\\mu \\\\\n\\theta m_X \\\\\n\\eta m_{Z_1} m_{Z_2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nk m_{Z_1} - \\delta m_X \\\\\n\\mu - \\eta m_{Z_1} m_{Z_2} \\\\\n\\theta m_X - \\eta m_{Z_1} m_{Z_2}\n\\end{pmatrix}\n$$\nThe explicit ODEs for the mean concentrations are:\n$$\n\\begin{align*}\n\\frac{dm_X}{dt} &= k m_{Z_1} - \\delta m_X \\\\\n\\frac{dm_{Z_1}}{dt} &= \\mu - \\eta m_{Z_1} m_{Z_2} \\\\\n\\frac{dm_{Z_2}}{dt} &= \\theta m_X - \\eta m_{Z_1} m_{Z_2}\n\\end{align*}\n$$\nTo find the steady-state mean $m^{\\star} = [m_X^\\star, m_{Z_1}^\\star, m_{Z_2}^\\star]^\\top$, we set the time derivatives to zero:\n$k m_{Z_1}^\\star - \\delta m_X^\\star = 0$\n$\\mu - \\eta m_{Z_1}^\\star m_{Z_2}^\\star = 0$\n$\\theta m_X^\\star - \\eta m_{Z_1}^\\star m_{Z_2}^\\star = 0$\nFrom the second and third equations, we find $\\mu = \\theta m_X^\\star$, which gives the steady-state mean of the regulated species $X$:\n$$\nm_X^\\star = \\frac{\\mu}{\\theta}\n$$\nSubstituting this into the first equation gives $k m_{Z_1}^\\star - \\delta (\\mu/\\theta) = 0$, which solves for $m_{Z_1}^\\star$:\n$$\nm_{Z_1}^\\star = \\frac{\\delta \\mu}{k \\theta}\n$$\nSubstituting $m_{Z_1}^\\star$ into the second equation gives $\\mu - \\eta (\\frac{\\delta \\mu}{k \\theta}) m_{Z_2}^\\star = 0$, which solves for $m_{Z_2}^\\star$:\n$$\nm_{Z_2}^\\star = \\frac{\\mu k \\theta}{\\eta \\delta \\mu} = \\frac{k \\theta}{\\eta \\delta}\n$$\nNext, we use the Linear Noise Approximation (LNA) to find the stationary covariance matrix $\\Sigma = \\mathbb{E}[(x - m^\\star)(x - m^\\star)^\\top]$. The LNA states that $\\Sigma$ satisfies the continuous-time Lyapunov equation:\n$$\nA \\Sigma + \\Sigma A^\\top + D = 0\n$$\nwhere $A$ is the Jacobian of the drift $f(m)$ and $D$ is the diffusion matrix, both evaluated at the steady state $m^\\star$.\n\nThe Jacobian matrix $A$ is $A_{ij} = \\frac{\\partial f_i}{\\partial m_j} \\big|_{m=m^\\star}$.\n$$\nA = \\frac{\\partial}{\\partial m} \\begin{pmatrix} k m_{Z_1} - \\delta m_X \\\\ \\mu - \\eta m_{Z_1} m_{Z_2} \\\\ \\theta m_X - \\eta m_{Z_1} m_{Z_2} \\end{pmatrix} \\Bigg|_{m^\\star}\n= \\begin{pmatrix} -\\delta & k & 0 \\\\ 0 & -\\eta m_{Z_2} & -\\eta m_{Z_1} \\\\ \\theta & -\\eta m_{Z_2} & -\\eta m_{Z_1} \\end{pmatrix} \\Bigg|_{m^\\star}\n$$\nSubstituting the steady-state mean values:\n$$\nA = \\begin{pmatrix}\n-\\delta & k & 0 \\\\\n0 & -\\eta \\left(\\frac{k \\theta}{\\eta \\delta}\\right) & -\\eta \\left(\\frac{\\delta \\mu}{k \\theta}\\right) \\\\\n\\theta & -\\eta \\left(\\frac{k \\theta}{\\eta \\delta}\\right) & -\\eta \\left(\\frac{\\delta \\mu}{k \\theta}\\right)\n\\end{pmatrix}\n= \\begin{pmatrix}\n-\\delta & k & 0 \\\\\n0 & -\\frac{k\\theta}{\\delta} & -\\frac{\\eta\\delta\\mu}{k\\theta} \\\\\n\\theta & -\\frac{k\\theta}{\\delta} & -\\frac_ {\\eta\\delta\\mu}{k\\theta}\n\\end{pmatrix}\n$$\nThe diffusion matrix $D$ is given by $D = S \\, \\text{diag}(a(m^\\star)) \\, S^\\top$. First, we evaluate the propensities at steady state:\n$a_1(m^\\star) = k m_{Z_1}^\\star = \\frac{\\delta\\mu}{\\theta}$\n$a_2(m^\\star) = \\delta m_X^\\star = \\frac{\\delta\\mu}{\\theta}$\n$a_3(m^\\star) = \\mu$\n$a_4(m^\\star) = \\theta m_X^\\star = \\mu$\n$a_5(m^\\star) = \\eta m_{Z_1}^\\star m_{Z_2}^\\star = \\mu$\nLet $W = \\text{diag}(a(m^\\star)) = \\text{diag}(\\frac{\\delta\\mu}{\\theta}, \\frac{\\delta\\mu}{\\theta}, \\mu, \\mu, \\mu)$.\n$$\nD = S W S^\\top = \\begin{pmatrix} 1 & -1 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 & -1 \\\\ 0 & 0 & 0 & 1 & -1 \\end{pmatrix}\n\\begin{pmatrix} \\frac{\\delta\\mu}{\\theta} & 0 & 0 & 0 & 0 \\\\ 0 & \\frac{\\delta\\mu}{\\theta} & 0 & 0 & 0 \\\\ 0 & 0 & \\mu & 0 & 0 \\\\ 0 & 0 & 0 & \\mu & 0 \\\\ 0 & 0 & 0 & 0 & \\mu \\end{pmatrix}\n\\begin{pmatrix} 1 & 0 & 0 \\\\ -1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & -1 & -1 \\end{pmatrix}\n$$\nPerforming the matrix multiplication yields:\n$$\nD = \\begin{pmatrix}\na_1(m^\\star) + a_2(m^\\star) & 0 & 0 \\\\\n0 & a_3(m^\\star) + a_5(m^\\star) & a_5(m^\\star) \\\\\n0 & a_5(m^\\star) & a_4(m^\\star) + a_5(m^\\star)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2\\frac{\\delta\\mu}{\\theta} & 0 & 0 \\\\\n0 & 2\\mu & \\mu \\\\\n0 & \\mu & 2\\mu\n\\end{pmatrix}\n$$\nFinally, for each parameter set provided in the test suite, we numerically construct the matrices $A$ and $D$ using the derived formulas. The Lyapunov equation $A\\Sigma + \\Sigma A^\\top = -D$ is then solved for a unique symmetric positive definite matrix $\\Sigma$ using a standard numerical linear algebra routine. The quantities of interest are the steady-state mean of species $X$, $m_X^\\star$, and its variance, $\\Sigma_{XX} = \\Sigma_{11}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_lyapunov\n\ndef compute_metrics(params):\n    \"\"\"\n    Computes the steady-state mean and variance for the antithetic controller.\n\n    Args:\n        params (tuple): A tuple of parameters (mu, theta, eta, k, delta).\n\n    Returns:\n        list: A list containing [m_X_star, Sigma_XX].\n    \"\"\"\n    mu, theta, eta, k, delta = params\n\n    # 1. Calculate the steady-state mean m_star = [m_X, m_Z1, m_Z2]\n    # All parameters are strictly positive, so division is safe.\n    m_X_star = mu / theta\n    m_Z1_star = (delta * mu) / (k * theta)\n    m_Z2_star = (k * theta) / (eta * delta)\n\n    # 2. Construct the Jacobian matrix A at m_star\n    A = np.zeros((3, 3), dtype=float)\n    A[0, 0] = -delta\n    A[0, 1] = k\n    # A[0, 2] = 0 is default\n    # A[1, 0] = 0 is default\n    A[1, 1] = -eta * m_Z2_star\n    A[1, 2] = -eta * m_Z1_star\n    A[2, 0] = theta\n    A[2, 1] = -eta * m_Z2_star\n    A[2, 2] = -eta * m_Z1_star\n\n    # 3. Construct the Diffusion matrix D at m_star\n    D = np.zeros((3, 3), dtype=float)\n    D[0, 0] = 2 * delta * mu / theta\n    D[1, 1] = 2 * mu\n    D[2, 2] = 2 * mu\n    D[1, 2] = mu\n    D[2, 1] = mu\n    \n    # 4. Solve the continuous-time Lyapunov equation: A*Sigma + Sigma*A.T = -D\n    # The solver expects A*X + X*A.T = Q, so we pass Q = -D.\n    Sigma = solve_lyapunov(A, -D)\n\n    # 5. Extract the variance of the regulated species X, which is the (0,0) element of Sigma.\n    Sigma_XX = Sigma[0, 0]\n\n    return [m_X_star, Sigma_XX]\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (mu, theta, eta, k, delta)\n    test_cases = [\n        (20.0, 2.0, 0.5, 1.0, 0.1),\n        (20.0, 2.0, 0.01, 1.0, 0.1),\n        (20.0, 2.0, 0.5, 10.0, 0.1),\n        (20.0, 0.05, 0.5, 1.0, 0.1),\n        (0.2, 2.0, 0.5, 1.0, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        result_pair = compute_metrics(case)\n        results.append(result_pair)\n\n    # Final print statement in the exact required format.\n    # e.g., [[v1,w1],[v2,w2],...] with 6 decimal places for each float.\n    formatted_pairs = [f\"[{pair[0]:.6f},{pair[1]:.6f}]\" for pair in results]\n    output_string = \"[\" + \",\".join(formatted_pairs) + \"]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}