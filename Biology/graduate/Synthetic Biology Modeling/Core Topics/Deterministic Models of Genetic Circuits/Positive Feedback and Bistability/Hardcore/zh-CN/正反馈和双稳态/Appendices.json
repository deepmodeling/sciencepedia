{
    "hands_on_practices": [
        {
            "introduction": "要理解一个系统如何能在多个稳定状态之间切换，我们必须首先掌握判断任意一个状态是否稳定的数学方法。这项练习将引导你运用线性稳定性分析，这是研究非线性动力学系统的基石。通过推导一个典型的正反馈回路模型的关键导数，你将学会如何从数学上确定一个稳态是稳定的还是不稳定的，为后续更复杂的分析奠定基础 。",
            "id": "3927215",
            "problem": "一个单基因正向自动调节模块在群体平均、充分混合的水平上通过常微分方程 (ODE) $\\,\\frac{dx}{dt} = f(x)\\,$ 进行建模，其中 $\\,x\\,$ 表示基因产物的浓度。假设转录自激活由一个希尔型激活项和线性一阶损失来描述，得到\n$$\nf(x) \\;=\\; \\alpha \\;+\\; \\beta\\,\\frac{x^{n}}{K^{n} + x^{n}} \\;-\\; \\gamma\\,x,\n$$\n其中 $\\,\\alpha>0\\,$ 是基础生产速率，$\\,\\beta>0\\,$ 是受调控的最大可诱导生产增量，$\\,K>0\\,$ 是半激活浓度，$\\,n\\geq 1\\,$ 是希尔系数，以及 $\\,\\gamma>0\\,$ 是有效一阶损失速率（稀释加降解）。在确定性的平均场极限下进行分析，并假设参数不随时间变化，且 $\\,x \\ge 0\\,$。\n\n从一维常微分方程的标准线性化原理和希尔函数的定义出发，执行以下操作：\n\n- 通过对右侧关于 $\\,x\\,$ 求导，推导 $\\,f'(x)\\,$ 的一般闭式表达式。\n- 使用在满足 $\\,f(x^{\\ast})=0\\,$ 的稳态 $\\,x^{\\ast}\\,$ 附近的线性化方法，以在 $\\,x^{\\ast}\\,$ 处计算的希尔项的导数相对于 $\\,\\gamma\\,$ 的形式，陈述局部渐近稳定性判据。用文字和符号形式表达您的结果。\n\n提供 $\\,f'(x)\\,$ 的单一闭式符号表达式作为最终答案。不需要数值计算，也不需要四舍五入。最终答案不带单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n**步骤1：提取已知条件**\n控制基因产物浓度 $x$ 的常微分方程 (ODE) 为 $\\frac{dx}{dt} = f(x)$，其中函数 $f(x)$ 定义为：\n$$\nf(x) \\;=\\; \\alpha \\;+\\; \\beta\\,\\frac{x^{n}}{K^{n} + x^{n}} \\;-\\; \\gamma\\,x\n$$\n参数定义及约束如下：\n- 基础生产速率：$\\alpha>0$\n- 受调控的最大可诱导生产增量：$\\beta>0$\n- 半激活浓度：$K>0$\n- 希尔系数：$n\\geq 1$\n- 有效一阶损失速率：$\\gamma>0$\n状态变量的定义域为 $x \\ge 0$。分析应在确定性的平均场极限下进行。任务是推导 $f'(x)$ 的表达式，并陈述稳态 $x^{\\ast}$ 的局部渐近稳定性判据。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据。所提供的 ODE 是单基因正反馈回路的经典模型，广泛用于系统生物学和合成生物学中，以研究双稳态和生物开关等现象。其函数形式采用了希尔函数表示协同激活，线性项表示降解/稀释，这是一种标准且广为接受的表述。参数具有物理意义且定义正确。该问题是适定的，提供了执行所需微积分和稳定性分析的所有必要信息。它是客观的，使用了精确的数学语言，并且是自洽的。该问题没有违反任何科学或数学逻辑原理，也不包含任何可能使其无效的所列出的缺陷。\n\n**步骤3：结论与行动**\n该问题被认定为有效。将提供完整解答。\n\n**解答推导**\n\n系统动力学由函数 $f(x)$ 描述。第一个任务是求该函数关于 $x$ 的导数，记作 $f'(x) = \\frac{d}{dx}f(x)$。函数为：\n$$\nf(x) = \\alpha + \\beta \\frac{x^n}{K^n + x^n} - \\gamma x\n$$\n我们逐项对 $f(x)$ 求导。常数基础生产项 $\\alpha$ 的导数为 $0$。线性损失项 $-\\gamma x$ 的导数为 $-\\gamma$。主要任务是求希尔激活项的导数，我们将其记为 $h_{act}(x) = \\beta \\frac{x^n}{K^n + x^n}$。\n\n使用导数的商法则，即对于 $g(x) = \\frac{u(x)}{v(x)}$，其导数为 $g'(x) = \\frac{u'(x)v(x) - u(x)v'(x)}{[v(x)]^2}$，我们设：\n- $u(x) = x^n$\n- $v(x) = K^n + x^n$\n\n$u(x)$ 和 $v(x)$ 关于 $x$ 的导数是：\n- $u'(x) = \\frac{d}{dx}(x^n) = n x^{n-1}$\n- $v'(x) = \\frac{d}{dx}(K^n + x^n) = n x^{n-1}$ (因为 $K^n$ 是常数)\n\n现在我们应用商法则来求 $\\frac{x^n}{K^n + x^n}$ 的导数：\n$$\n\\frac{d}{dx}\\left(\\frac{x^n}{K^n + x^n}\\right) = \\frac{(n x^{n-1})(K^n + x^n) - (x^n)(n x^{n-1})}{(K^n + x^n)^2}\n$$\n我们展开分子：\n$$\n(n x^{n-1})(K^n) + (n x^{n-1})(x^n) - (x^n)(n x^{n-1}) = n K^n x^{n-1} + n x^{2n-1} - n x^{2n-1} = n K^n x^{n-1}\n$$\n所以，希尔激活项的导数是：\n$$\n\\frac{d}{dx}\\left(\\beta \\frac{x^n}{K^n + x^n}\\right) = \\beta \\frac{n K^n x^{n-1}}{(K^n + x^n)^2}\n$$\n结合所有求导后的项，我们得到 $f'(x)$ 的完整表达式：\n$$\nf'(x) = 0 + \\beta \\frac{n K^n x^{n-1}}{(K^n + x^n)^2} - \\gamma\n$$\n$$\nf'(x) = \\beta \\frac{n K^n x^{n-1}}{(K^n + x^n)^2} - \\gamma\n$$\n这是 $f'(x)$ 的一般闭式表达式。\n\n第二个任务是陈述稳态 $x^{\\ast}$ 的局部渐近稳定性判据。稳态或不动点 $x^{\\ast}$ 是净变化率为零的浓度，即 $f(x^{\\ast})=0$。对于一维自治常微分方程 $\\frac{dx}{dt} = f(x)$，一个稳态 $x^{\\ast}$ 是局部渐近稳定的当且仅当 $f'(x^{\\ast}) < 0$。\n\n将我们推导出的 $f'(x)$ 表达式代入此不等式，稳定性判据变为：\n$$\n\\beta \\frac{n K^n (x^{\\ast})^{n-1}}{(K^n + (x^{\\ast})^n)^2} - \\gamma < 0\n$$\n这可以改写为：\n$$\n\\beta \\frac{n K^n (x^{\\ast})^{n-1}}{(K^n + (x^{\\ast})^n)^2} < \\gamma\n$$\n左侧的项是在稳态 $x^{\\ast}$ 处计算的希尔激活项 $\\beta \\frac{x^n}{K^n+x^n}$ 的导数。用文字表述，稳定性判据如下：\n\n一个稳态 $x^{\\ast}$ 是局部渐近稳定的，如果受调控的生产速率函数（希尔项）的斜率在稳态浓度 $x^{\\ast}$ 处的值小于有效一阶损失速率常数 $\\gamma$。这意味着，对于稳态的一个微小扰动，生产机制的反馈响应弱于蛋白质的被动清除，从而确保系统返回到稳态。",
            "answer": "$$\n\\boxed{\\beta \\frac{n K^n x^{n-1}}{(K^n + x^n)^2} - \\gamma}\n$$"
        },
        {
            "introduction": "理论模型中的“双稳态”与实验数据（如流式细胞术结果）中观察到的“双峰分布”之间存在着微妙但至关重要的区别。这项概念性练习旨在深化你对这一区别的理解，它将挑战你思考噪声和细胞异质性如何影响我们的测量结果。掌握区分这两种现象的能力，对于准确地从实验数据中推断潜在的生物学机制至关重要 。",
            "id": "3927189",
            "problem": "考虑一个具有正反馈的单基因自激活回路。设蛋白质浓度用 $x$ 表示，并假设其确定性动力学由常微分方程 (ODE) $\\dot{x} = f(x)$ 给出，其中 $f(x) = \\alpha \\dfrac{x^{n}}{K^{n} + x^{n}} - \\beta x$，且 $\\alpha > 0$, $\\beta > 0$, $K > 0$ 以及希尔系数 $n \\ge 1$。该系统通过荧光读数 $y$ 进行观测，它与 $x$ 通过线性测量模型 $y = s x + \\eta$ 相关，其中 $s > 0$ 且 $\\eta$ 是一个加性测量噪声。假设内源性生化噪声可以被建模为围绕确定性不动点的动力学的弱随机扰动，并且测量噪声 $\\eta$ 是均值为零、方差为 $\\sigma_{m}^{2}$ 的高斯噪声，该方差可以很大。\n\n将双稳态定义为确定性动力学存在多个吸引不动点（即，多个满足 $f(x^{*}) = 0$ 和 $f'(x^{*}) < 0$ 的 $x^{*}$，且它们之间被至少一个满足 $f'(x^{*}) > 0$ 的排斥不动点所分隔）。将双峰性定义为观测值的稳态分布中存在多个峰。\n\n选择所有正确的并且最能区分底层动力学中的双稳态与观测稳态分布中的双峰性的陈述：\n\nA. 在单稳态区域（一个吸引不动点），弱内源性噪声下真实状态 $x$ 的稳态分布是单峰的；在线性测量模型和加性高斯噪声下，观测读数 $y$ 的稳态分布保持单峰，较大的 $\\sigma_{m}$ 会增加其宽度但不会诱导出多个峰。\n\nB. 底层动力学中的真正双稳态要求至少有两个由一个排斥不动点分隔的吸引不动点；在小内源性噪声极限下，真实状态 $x$ 的稳态分布变为双峰，其峰值位于吸引不动点附近。\n\nC. 观测到荧光读数 $y$ 的双峰稳态分布必然意味着 $x$ 的底层确定性动力学是双稳态的。\n\nD. 即使确定性动力学是单稳态的，引起细胞间或随时间变化的多种不同操作模式混合的慢外源性波动，也可以产生一个表观上的双峰稳态分布的观测读数 $y$。\n\nE. 无论噪声来源或其时间尺度如何，观测读数 $y$ 的时间平均稳态分布中的一对峰总是表示底层确定性动力学中存在两个稳定不动点。",
            "solution": "该问题要求评估区分双稳态（确定性动力学系统的一个属性）和双峰性（观测状态概率分布的一个属性）的陈述。\n\n首先，让我们根据问题陈述中的定义来形式化这些概念。\n\n该系统的动力学由以下常微分方程 (ODE) 描述：\n$$ \\dot{x} = f(x) = \\alpha \\frac{x^n}{K^n + x^n} - \\beta x $$\n其中 $x$ 是蛋白质浓度，且 $\\alpha, \\beta, K > 0$, $n \\ge 1$。\n\n系统的不动点 $x^*$ 是方程 $\\dot{x} = 0$ 的解，即 $f(x^*) = 0$。这可以写成：\n$$ \\alpha \\frac{(x^*)^n}{K^n + (x^*)^n} = \\beta x^* $$\n这个方程对应于寻找S型生成速率函数 $P(x) = \\alpha \\frac{x^n}{K^n + x^n}$ 与线性降解速率函数 $D(x) = \\beta x$ 的交点。\n\n**双稳态**，根据定义，要求存在多个吸引（稳定）不动点。如果 $f'(x^*) < 0$，则不动点 $x^*$ 是吸引（稳定）的；如果 $f'(x^*) > 0$，则不动点是排斥（不稳定）的。对于此系统，当方程 $f(x) = 0$ 有三个正解时，就会出现双稳态，这三个解形成一个稳定、不稳定、稳定的不动点序列。这通常需要一个足够大的希尔系数 ($n > 1$) 和合适的参数值 $\\alpha$、$\\beta$ 和 $K$，使得S型曲线 $P(x)$ 足够陡峭，以便与直线 $D(x)$ 相交三次。\n\n**双峰性**被定义为稳态概率分布中存在多个峰。\n观测读数为 $y = s x + \\eta$，其中 $\\eta \\sim \\mathcal{N}(0, \\sigma_m^2)$。$y$ 的分布（我们称之为 $p_Y(y)$）通过缩放和卷积与真实状态 $x$ 的分布 $p_X(x)$ 相关。如果 $z=sx$，则 $p_Z(z) = \\frac{1}{s}p_X(z/s)$。$y$ 的分布是 $z$ 的分布与噪声 $\\eta$ 的高斯分布的卷积：\n$$ p_Y(y) = (p_Z * p_\\eta)(y) = \\int_{-\\infty}^{\\infty} p_Z(z) p_\\eta(y-z) dz $$\n其中 $p_\\eta$ 是一个高斯概率密度函数（PDF）。\n\n在确立了这些原则之后，我们可以评估每个陈述。\n\n**A. 在单稳态区域（一个吸引不动点），弱内源性噪声下真实状态 $x$ 的稳态分布是单峰的；在线性测量模型和加性高斯噪声下，观测读数 $y$ 的稳态分布保持单峰，较大的 $\\sigma_{m}$ 会增加其宽度但不会诱导出多个峰。**\n\n- **分析：** 在单稳态区域，存在一个单一的稳定不动点 $x^*$。弱内源性噪声将导致系统状态 $x$ 在该不动点周围波动。在势能景观类比中（其中 $f(x) = -dU/dx$），一个单一的稳定不动点对应于一个单一的势阱。小的扰动将使状态在该势阱内探索，从而导致一个在 $x^*$ 处（或其附近）达到峰值的单峰稳态分布 $p_X(x)$。线性变换 $z = sx$ 只是重新缩放了坐标轴，因此 $z$ 的分布 $p_Z(z)$ 也是单峰的。最终的观测分布 $p_Y(y)$ 是这个单峰分布 $p_Z(z)$ 与一个高斯分布（其本身也是单峰的）的卷积。一个基本的数学结论指出，一个单峰分布与一个高斯分布的卷积总是单峰的。因此，从一个单峰分布出发，增加高斯测量噪声不能产生新的峰。增加噪声方差 $\\sigma_m^2$ 会增加卷积高斯函数的宽度，从而进一步平滑和加宽最终的分布 $p_Y(y)$。\n\n- **结论：** **正确**。\n\n**B. 底层动力学中的真正双稳态要求至少有两个由一个排斥不动点分隔的吸引不动点；在小内源性噪声极限下，真实状态 $x$ 的稳态分布变为双峰，其峰值位于吸引不动点附近。**\n\n- **分析：** 该陈述的第一部分是问题设置中提供的双稳态的定义，并且与动力学系统中的标准用法一致。在一个双稳态系统中（例如，两个稳定不动点 $x_1^*$ 和 $x_3^*$ 被一个不稳定不动点 $x_2^*$ 分隔），相应的势能景观 $U(x)$ 在 $x_1^*$ 和 $x_3^*$ 处有两个势阱，被 $x_2^*$ 处的一个势垒隔开。在弱内源性噪声下，系统将绝大部分时间在两个势阱内波动。势阱之间的跃迁是稀有事件。因此，状态的稳态概率分布 $p_X(x)$ 将呈现出两个不同的峰，中心位于稳定不动点 $x_1^*$ 和 $x_3^*$ 附近。这就是双峰分布的定义。\n\n- **结论：** **正确**。\n\n**C. 观测到荧光读数 $y$ 的双峰稳态分布必然意味着 $x$ 的底层确定性动力学是双稳态的。**\n\n- **分析：** 这个陈述假设双峰性是双稳态的充分条件。为了证伪这一点，我们需要找到一个动力学是单稳态但观测分布是双峰的场景。这样的场景是存在的。一个显著的例子，在陈述D中有详细说明，涉及到外源性噪声。如果细胞群体是异质的，或者系统参数随时间缓慢波动，那么观测到的群体可以是不同单稳态的混合。例如，由于转录速率 $\\alpha$ 等参数的差异，一半的细胞可能处于低表达的单稳态，另一半处于高表达的单稳态。整个群体的直方图将显示两个峰，从而形成双峰分布，尽管没有任何单个细胞是双稳态的。因为存在产生双峰性的合理替代机制，所以不能必然地得出底层动力学必须是双稳态的结论。\n\n- **结论：** **不正确**。\n\n**D. 即使确定性动力学是单稳态的，引起细胞间或随时间变化的多种不同操作模式混合的慢外源性波动，也可以产生一个表观上的双峰稳态分布的观测读数 $y$。**\n\n- **分析：** 这个陈述为陈述C提供了主要的反例。“外源性波动”指的是系统参数（例如 $\\alpha, \\beta$）的变化，这些参数对于所建模的特定基因表达反应而言是外部的。如果这些波动是“缓慢的”（即，在参数再次改变之前，参数保持恒定的时间足够长，以使 $x$ 达到其稳态分布），那么总的时间平均或群体平均分布是对应于不同参数值的稳态分布的混合（加权和）。假设一个参数 $\\theta$ 可以取两个值，$\\theta_1$ 和 $\\theta_2$。如果系统对于 $\\theta_1$（稳态为 $x_1^*$）和 $\\theta_2$（稳态为 $x_2^*$）都是单稳态的，那么 $x$ 的总分布将是 $p_X(x) = w_1 p_{X|\\theta_1}(x) + w_2 p_{X|\\theta_2}(x)$。如果相应的平均读数 $y_1=sx_1^*$ 和 $y_2=sx_2^*$ 相对于单个分布的宽度足够分离，那么最终的 $y$ 的混合分布将是双峰的。这是一个在生物系统中产生双峰性而无需确定性双稳态的公认机制。\n\n- **结论：** **正确**。\n\n**E. 无论噪声来源或其时间尺度如何，观测读数 $y$ 的时间平均稳态分布中的一对峰总是表示底层确定性动力学中存在两个稳定不动点。**\n\n- **分析：** 这个陈述是陈述C的一个更强、更绝对的版本。使用“总是”和“无论噪声来源或其时间尺度如何”使其极易被证伪。正如在对陈述D的分析中所确立的，慢外源性噪声是一种特定类型、具有特定时间尺度的噪声源，可以从一个单稳态系统产生双峰性。这直接与该主张相矛盾。因此，一对峰并不“总是”表示两个稳定不动点。\n\n- **结论：** **不正确**。\n\n总而言之，陈述A、B和D是正确的。它们共同通过展示以下几点来区分双稳态和双峰性：(A) 一个简单系统何时保持单峰，(B) 双稳态如何导致双峰性，以及 (D) 双峰性如何在没有双稳态的情况下产生。",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "合成生物学的一个核心目标是设计功能稳健的生物回路。一个理论上可行的双稳态开关，如果对参数的微小变化极其敏感，那么在真实的细胞环境中可能毫无用处。这项计算实践将引导你超越单个参数点的分析，进入多维参数空间来评估和优化一个基因开关的稳健性。通过编写程序来量化和最大化双稳态区域的“体积”，你将亲身体验如何设计出能够抵御内在和外在波动的、更可靠的生物器件 。",
            "id": "3927191",
            "problem": "考虑一个用于合成生物学建模的典范单基因正反馈系统，其中自激活转录因子的无量纲浓度 $x$ 根据一个具有 Hill 型激活和线性降解的常微分方程 (ODE) 演化。该确定性模型为\n$$\n\\frac{dx}{dt} = \\tilde{\\alpha}\\,\\frac{x^n}{1 + x^n} - \\tilde{\\beta}\\,x,\n$$\n其中 $\\tilde{\\alpha} > 0$ 是无量纲最大生产速率，$\\tilde{\\beta} > 0$ 是无量纲一阶降解速率，而 $n > 0$ 是 Hill 激活系数。正反馈和超敏性可以产生多稳态；当且仅当比率 $r = \\tilde{\\alpha}/\\tilde{\\beta}$ 超过一个临界阈值 $r_{\\mathrm{c}}(n)$ 时，系统出现双稳态区域（两个不同的稳定不动点，由一个不稳定不动点分隔）。该阈值依赖于 $n$ 并源于零斜线交点的几何形状。对于 $n \\le 1$，不出现双稳态。对于 $n > 1$，临界阈值 $r_{\\mathrm{c}}(n)$ 由函数 $g(x;n) = x^{n-1}/(1+x^n)$ 的最大值等于 $1/r$ 的条件定义。$g$ 的最大值在 $x^\\star = (n-1)^{1/n}$ 处取得，其值为 $g(x^\\star;n) = (n-1)^{(n-1)/n}/n$。因此，双稳态恰好在 $r > r_{\\mathrm{c}}(n)$ 时出现，其中\n$$\nr_{\\mathrm{c}}(n) = \\frac{n}{(n-1)^{(n-1)/n}},\\quad n>1.\n$$\n\n您的任务是通过计算 $(\\tilde{\\alpha},\\tilde{\\beta},n)$ 空间中一个有界参数框内双稳态区域的体积来分析参数变化的鲁棒性，并通过优化一个固定尺寸设计子框的位置来最大化此双稳态体积。具体来说：\n\n1. 对于一个由区间 $\\tilde{\\alpha} \\in [A_{\\min}, A_{\\max}]$, $\\tilde{\\beta} \\in [B_{\\min}, B_{\\max}]$, 和 $n \\in [N_{\\min}, N_{\\max}]$ 定义的给定参数框，计算此框内产生双稳态的 $(\\tilde{\\alpha},\\tilde{\\beta},n)$ 子集的体积 $V$。该体积在 $\\mathbb{R}^3$ 上以标准勒贝格测度衡量。等价地，\n$$\nV = \\int_{N_{\\min}}^{N_{\\max}} \\text{Area}\\Big(\\left\\{(\\tilde{\\alpha},\\tilde{\\beta}) \\in [A_{\\min},A_{\\max}] \\times [B_{\\min},B_{\\max}] : \\frac{\\tilde{\\alpha}}{\\tilde{\\beta}} > r_{\\mathrm{c}}(n)\\right\\}\\Big)\\,dn.\n$$\n对于 $n \\le 1$，被积函数必须定义为零。\n\n2. 给定一个可行超集框 $[A_{\\mathrm{lo}},A_{\\mathrm{hi}}] \\times [B_{\\mathrm{lo}},B_{\\mathrm{hi}}] \\times [N_{\\mathrm{lo}},N_{\\mathrm{hi}}]$ 和固定的设计宽度 $w_\\alpha$, $w_\\beta$ 和 $w_n$（使得 $0 < w_\\alpha \\le A_{\\mathrm{hi}}-A_{\\mathrm{lo}}$, $0 < w_\\beta \\le B_{\\mathrm{hi}}-B_{\\mathrm{lo}}$, 和 $0 < w_n \\le N_{\\mathrm{hi}}-N_{\\mathrm{lo}}$），选择一个具有这些精确宽度（即 $A_{\\max}-A_{\\min}=w_\\alpha$, $B_{\\max}-B_{\\min}=w_\\beta$, $N_{\\max}-N_{\\min}=w_n$）且包含在可行超集内的子框 $[A_{\\min},A_{\\max}] \\times [B_{\\min},B_{\\max}] \\times [N_{\\min},N_{\\max}]$，以最大化双稳态体积 $V$。计算最大体积 $V_{\\mathrm{opt}}$ 并仅报告其数值。优化必须在超集内子框的所有可能位置上进行，并且您必须将算法策略建立在从双稳态条件推导出的第一性原理之上。\n\n为了实现对于固定 $n$ 的 $\\tilde{\\alpha}$-$\\tilde{\\beta}$ 横截面积的计算，请注意条件 $\\tilde{\\alpha}/\\tilde{\\beta} > c$（其中 $c = r_{\\mathrm{c}}(n)$）定义了矩形 $[A_{\\min},A_{\\max}] \\times [B_{\\min},B_{\\max}]$ 中直线 $\\tilde{\\alpha} = c \\tilde{\\beta}$ 上方的区域。该面积通过对每个 $\\tilde{\\beta}$ 积分满足 $\\tilde{\\alpha} > c \\tilde{\\beta}$ 且 $\\tilde{\\alpha} \\in [A_{\\min},A_{\\max}]$ 的 $\\tilde{\\alpha}$ 值长度来给出。这产生了以 $\\beta_0 = A_{\\min}/c$ 和 $\\beta_1 = A_{\\max}/c$ 表示的分段解析面积公式：\n- 对于 $\\tilde{\\beta} \\in [B_{\\min}, \\min(B_{\\max}, \\beta_0)]$，长度为 $A_{\\max} - A_{\\min}$。\n- 对于 $\\tilde{\\beta} \\in [\\max(B_{\\min}, \\beta_0), \\min(B_{\\max}, \\beta_1)]$，长度为 $A_{\\max} - c \\tilde{\\beta}$。\n- 在这些区间之外，长度为零。\n\n因此，面积为\n$$\n\\text{Area}(n) = (A_{\\max}-A_{\\min})\\cdot\\max\\big(0,\\min(B_{\\max},\\beta_0)-B_{\\min}\\big) + \\Big[A_{\\max}(\\beta_u - \\beta_l) - \\frac{c}{2}(\\beta_u^2 - \\beta_l^2)\\Big]_+,\n$$\n其中 $c=r_{\\mathrm{c}}(n)$, $\\beta_l=\\max(B_{\\min},\\beta_0)$, $\\beta_u=\\min(B_{\\max},\\beta_1)$, 且 $[\\,\\cdot\\,]_+$ 表示仅当 $\\beta_u>\\beta_l$ 时才包含该项（否则为零）。体积则为 $V=\\int_{N_{\\min}}^{N_{\\max}} \\text{Area}(n)\\,dn$。\n\n您必须实现一个程序，使用对 $n$ 的数值积分来计算 $V$，并使用上述分段公式来评估 $\\text{Area}(n)$。对于优化问题，您必须根据双稳态条件相对于 $\\tilde{\\alpha}$、$\\tilde{\\beta}$ 和 $n$ 的单调性来论证并实现最优放置策略。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,\\dots]$）。每个结果必须是实数（浮点数）。对于每个测试用例，输出两个数字：首先是给定完整框的双稳态区域体积 $V$，其次是在给定可行超集内放置固定宽度的子框所能获得的最大体积 $V_{\\mathrm{opt}}$。将所有测试用例的结果按顺序聚合到一个扁平列表中。\n\n测试套件：\n- 测试用例 1 (正常路径)：\n  - 完整框：$\\tilde{\\alpha} \\in [0.5, 10.0]$, $\\tilde{\\beta} \\in [0.2, 5.0]$, $n \\in [1.2, 5.0]$。\n  - 用于优化的可行超集和宽度：$[A_{\\mathrm{lo}},A_{\\mathrm{hi}}]=[0.5, 10.0]$, $[B_{\\mathrm{lo}},B_{\\mathrm{hi}}]=[0.2, 5.0]$, $[N_{\\mathrm{lo}},N_{\\mathrm{hi}}]=[1.2, 5.0]$, 宽度为 $w_\\alpha=3.0$, $w_\\beta=1.0$, $w_n=2.0$。\n- 测试用例 2 (边界主导的窄框)：\n  - 完整框：$\\tilde{\\alpha} \\in [1.0, 2.0]$, $\\tilde{\\beta} \\in [0.5, 1.0]$, $n \\in [1.0, 2.0]$。\n  - 用于优化的可行超集和宽度：$[A_{\\mathrm{lo}},A_{\\mathrm{hi}}]=[1.0, 2.0]$, $[B_{\\mathrm{lo}},B_{\\mathrm{hi}}]=[0.5, 1.0]$, $[N_{\\mathrm{lo}},N_{\\mathrm{hi}}]=[1.0, 2.0]$, 宽度为 $w_\\alpha=1.0$, $w_\\beta=0.5$, $w_n=1.0$。\n- 测试用例 3 (跨越 $n=1$ 阈值的边界情况)：\n  - 完整框：$\\tilde{\\alpha} \\in [0.1, 3.0]$, $\\tilde{\\beta} \\in [0.2, 1.5]$, $n \\in [0.8, 1.4]$。\n  - 用于优化的可行超集和宽度：$[A_{\\mathrm{lo}},A_{\\mathrm{hi}}]=[0.1, 3.0]$, $[B_{\\mathrm{lo}},B_{\\mathrm{hi}}]=[0.2, 1.5]$, $[N_{\\mathrm{lo}},N_{\\mathrm{hi}}]=[0.8, 1.4]$, 宽度为 $w_\\alpha=1.0$, $w_\\beta=0.5$, $w_n=0.4$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的包含 $6$ 个数字的逗号分隔列表：$[V_1,V_{\\mathrm{opt},1},V_2,V_{\\mathrm{opt},2},V_3,V_{\\mathrm{opt},3}]$，其中 $V_i$ 是测试用例 $i$ 中给定完整框内双稳态区域的体积，而 $V_{\\mathrm{opt},i}$ 是在测试用例 $i$ 的可行超集内通过优化放置给定宽度的子框可实现的最大双稳态体积。\n\n不涉及物理单位；所有量均为无量纲。将所有数值结果表示为实数（浮点数）。不涉及角度。不涉及百分比。",
            "solution": "用户提供了一个问题陈述，在尝试解决方案之前需要对其进行验证。\n\n### 第 1 步：提取已知条件\n- **控制方程：** 自激活转录因子的无量纲浓度 $x$ 遵循以下常微分方程：\n$$\n\\frac{dx}{dt} = \\tilde{\\alpha}\\,\\frac{x^n}{1 + x^n} - \\tilde{\\beta}\\,x\n$$\n- **参数：** $\\tilde{\\alpha} > 0$ (最大生产速率)，$\\tilde{\\beta} > 0$ (降解速率)，$n > 0$ (Hill 系数)。\n- **双稳态条件：** 当且仅当 $n > 1$ 且比率 $r = \\tilde{\\alpha}/\\tilde{\\beta}$ 大于临界阈值 $r_{\\mathrm{c}}(n)$ 时，出现双稳态。\n- **临界阈值：**\n$$\nr_{\\mathrm{c}}(n) = \\frac{n}{(n-1)^{(n-1)/n}},\\quad n>1.\n$$\n- **任务 1 (体积计算)：** 对于由 $\\tilde{\\alpha} \\in [A_{\\min}, A_{\\max}]$，$\\tilde{\\beta} \\in [B_{\\min}, B_{\\max}]$ 和 $n \\in [N_{\\min}, N_{\\max}]$ 定义的参数框，计算双稳态区域的体积 $V$：\n$$\nV = \\int_{N_{\\min}}^{N_{\\max}} \\text{Area}\\Big(\\left\\{(\\tilde{\\alpha},\\tilde{\\beta}) \\in [A_{\\min},A_{\\max}] \\times [B_{\\min},B_{\\max}] : \\frac{\\tilde{\\alpha}}{\\tilde{\\beta}} > r_{\\mathrm{c}}(n)\\right\\}\\Big)\\,dn,\n$$\n其中对于 $n \\le 1$，被积函数为零。\n- **面积公式：** 对于固定的 $n$，横截面积由以下公式给出：\n$$\n\\text{Area}(n) = (A_{\\max}-A_{\\min})\\cdot\\max\\big(0,\\min(B_{\\max},\\beta_0)-B_{\\min}\\big) + \\Big[A_{\\max}(\\beta_u - \\beta_l) - \\frac{c}{2}(\\beta_u^2 - \\beta_l^2)\\Big]_+,\n$$\n其中 $c=r_{\\mathrm{c}}(n)$, $\\beta_0=A_{\\min}/c$, $\\beta_1=A_{\\max}/c$, $\\beta_l=\\max(B_{\\min},\\beta_0)$, $\\beta_u=\\min(B_{\\max},\\beta_1)$，且 $[\\,\\cdot\\,]_+$ 表示仅当 $\\beta_u > \\beta_l$ 时包含该项。\n- **任务 2 (优化)：** 给定一个可行超集框 $[A_{\\mathrm{lo}},A_{\\mathrm{hi}}] \\times [B_{\\mathrm{lo}},B_{\\mathrm{hi}}] \\times [N_{\\mathrm{lo}},N_{\\mathrm{hi}}]$ 和固定宽度 $w_\\alpha$, $w_\\beta$, $w_n$，找到包含在该超集内且具有这些宽度的子框，以最大化双稳态体积 $V$。结果是最大体积 $V_{\\mathrm{opt}}$。\n- **测试套件：** 提供了三个测试用例，包含框边界和宽度的具体数值。\n- **输出格式：** 单行逗号分隔的 6 个浮点值列表：$[V_1,V_{\\mathrm{opt},1},V_2,V_{\\mathrm{opt},2},V_3,V_{\\mathrm{opt},3}]$。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于系统与合成生物学中一个标准的、成熟的单基因正反馈回路（一种基因触发开关）数学模型。使用 Hill 函数进行激活和双稳态准则的推导都是典范做法。数学公式是正确的。\n2.  **良构性：**\n    - 体积计算涉及在一个有限区间上对一个分段解析的非负函数进行积分。该积分是良定义的，并且可以进行数值计算。\n    - 优化问题需要最大化该积分。被积函数对参数 $(\\tilde{\\alpha}, \\tilde{\\beta}, n)$ 的依赖关系是可分析的，这允许采用有原则的优化策略，而不是暴力搜索。对于最优位置和体积，存在唯一、稳定的解。\n3.  **客观性：** 问题以精确、无歧义的数学语言陈述。没有主观或基于意见的成分。\n4.  **完整性和一致性：** 所有必需的定义、公式和数据都已提供。对参数和框宽度的约束是一致的，并且足以解决该问题。所提供的 `Area(n)` 公式是正确的，并且可以从第一性原理推导出来。\n5.  **平凡性：** 该问题并非平凡。它需要数值积分和一个分析步骤来设计优化策略，该策略依赖于一个非单调函数 $r_c(n)$。\n\n问题陈述在所有标准上均有效。\n\n### 第 3 步：结论与行动\n问题是有效的。将提供一个合理的解决方案和实现。\n\n解决方案分两部分制定，对应于两个任务。首先，建立计算体积 $V$ 的方法。其次，从第一性原理推导出寻找最优子框及其体积 $V_{\\mathrm{opt}}$ 的策略。\n\n**第 1 部分：双稳态体积计算**\n\n主要目标是计算在给定框 $[A_{\\min}, A_{\\max}] \\times [B_{\\min}, B_{\\max}] \\times [N_{\\min}, N_{\\max}]$ 内导致双稳态的参数集 $(\\tilde{\\alpha}, \\tilde{\\beta}, n)$ 的体积 $V$。该体积由积分给出：\n$$\nV = \\int_{N_{\\min}}^{N_{\\max}} \\text{Area}(n) \\, dn\n$$\n被积函数 $\\text{Area}(n)$ 表示在 $(\\tilde{\\alpha}, \\tilde{\\beta})$ 平面中，对于特定的 $n$ 值系统呈双稳态的区域面积。双稳态的条件是对于 $n > 1$ 有 $\\tilde{\\alpha}/\\tilde{\\beta} > r_{\\mathrm{c}}(n)$，而对于 $n \\le 1$ 不存在双稳态。因此，对于 $n \\le 1$，$\\text{Area}(n) = 0$。\n\n对于 $n > 1$，我们定义 $c = r_c(n) = n / (n-1)^{(n-1)/n}$。面积是集合 $\\{(\\tilde{\\alpha}, \\tilde{\\beta}) \\mid \\tilde{\\alpha} > c \\tilde{\\beta}\\}$ 与矩形 $[A_{\\min}, A_{\\max}] \\times [B_{\\min}, B_{\\max}]$ 相交的区域面积。问题为此面积提供了一个正确的、显式的公式，该公式通过对每个 $\\tilde{\\beta}$ 从 $B_{\\min}$ 到 $B_{\\max}$ 积分有效 $\\tilde{\\alpha}$ 区间的长度推导得出。此公式被直接实现。最终体积 $V$ 随后通过使用数值求积（`scipy.integrate.quad` 函数适用于此目的）在区间 $[N_{\\min}, N_{\\max}]$ 上对 $\\text{Area}(n)$ 关于 $n$ 进行数值积分来计算。\n\n**第 2 部分：最优子框放置**\n\n第二个任务是通过在更大的可行超集 $[A_{\\mathrm{lo}}, A_{\\mathrm{hi}}] \\times [B_{\\mathrm{lo}}, B_{\\mathrm{hi}}] \\times [N_{\\mathrm{lo}}, N_{\\mathrm{hi}}]$ 内选择一个固定尺寸 $(w_\\alpha, w_\\beta, w_n)$ 的子框来最大化双稳态体积 $V$。最优放置位置通过分析被积函数 $\\text{Area}(n)$ 如何依赖于框的边界来确定。\n\n*   **对 $\\tilde{\\alpha}$ 和 $\\tilde{\\beta}$ 的依赖性：** 双稳态条件 $\\tilde{\\alpha} > c(n) \\tilde{\\beta}$ 受益于大的 $\\tilde{\\alpha}$ 值和小的 $\\tilde{\\beta}$ 值。因此，为了在任何给定的 $n$ 下最大化双稳态区域的面积，$(\\tilde{\\alpha}, \\tilde{\\beta})$ 的积分矩形应被放置在包含尽可能大的 $\\tilde{\\alpha}$ 值和尽可能小的 $\\tilde{\\beta}$ 值的位置。这将最优子框放置在 $(\\tilde{\\alpha}, \\tilde{\\beta})$ 平面中可行空间的“左上角”。因此，最优区间为 $[A_{\\min}, A_{\\max}] = [A_{\\mathrm{hi}} - w_\\alpha, A_{\\mathrm{hi}}]$ 和 $[B_{\\min}, B_{\\max}] = [B_{\\mathrm{lo}}, B_{\\mathrm{lo}} + w_\\beta]$。\n\n*   **对 $n$ 的依赖性：** 对 $n$ 的依赖性由临界阈值 $c(n) = r_{\\mathrm{c}}(n)$ 介导。双稳态区域的面积是 $c(n)$ 的单调递减函数：一个较小的阈值 $c(n)$ 使双稳态更容易实现，从而产生更大的面积。对 $n>1$ 时 $c(n)$ 的数学分析表明：\n    -   $\\lim_{n\\to 1^+} c(n) = 1$。\n    -   对于 $n \\in (1, 2]$，$c(n)$ 增加，在 $c(2) = 2$ 处达到全局最大值。\n    -   对于 $n > 2$，$c(n)$ 减小，且 $\\lim_{n\\to\\infty} c(n) = 1$。\n\n    $c(n)$ 的这种非单调行为意味着它的反函数，并延伸到 $\\text{Area}(n)$，在 $n=2$ 附近有一个全局最小值，并且当 $n$ 远离 $2$ 时（无论是朝向 $1$ 还是朝向 $\\infty$）会增加。为了在一个固定宽度 $w_n$ 的区间上最大化总体积 $\\int \\text{Area}(n)\\,dn$，区间 $[N_{\\min}, N_{\\max}]$ 应放置在 $\\text{Area}(n)$ 最大的地方。考虑到 $\\text{Area}(n)$ 的形状（在 $n=2$ 处有一个“谷”），最优放置位置必须在可行范围 $[N_{\\mathrm{lo}}, N_{\\mathrm{hi}}]$ 的两端之一。\n\n*   **最优策略：** 子框的最优放置按如下方式确定：\n    1.  $\\tilde{\\alpha}$ 和 $\\tilde{\\beta}$ 的区间分别固定为 $[A_{\\mathrm{hi}}-w_\\alpha, A_{\\mathrm{hi}}]$ 和 $[B_{\\mathrm{lo}}, B_{\\mathrm{lo}}+w_\\beta]$。\n    2.  考虑 $n$ 区间的两个候选位置：低端位置 $[N_{\\mathrm{lo}}, N_{\\mathrm{lo}}+w_n]$ 和高端位置 $[N_{\\mathrm{hi}}-w_n, N_{\\mathrm{hi}}]$。\n    3.  计算两个候选子框的双稳态体积。\n    4.  这两个体积中的最大值即为最终的最优体积 $V_{\\mathrm{opt}}$。\n\n这种有原则的策略在提供的 Python 代码中实现。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef r_c(n):\n    \"\"\"\n    Calculates the critical threshold r_c for a given Hill coefficient n.\n    \"\"\"\n    if n = 1.0:\n        return np.inf\n    # To avoid potential numerical issues as n approaches 1, we can handle it\n    # explicitly, although np.power is generally robust.\n    if np.isclose(n, 1.0):\n        return np.inf\n    \n    # Formula: r_c(n) = n / (n-1)^((n-1)/n) for n > 1\n    base = n - 1.0\n    exponent = (n - 1.0) / n\n    denominator = np.power(base, exponent)\n    \n    if denominator == 0:\n        return np.inf\n\n    return n / denominator\n\ndef area_integrand(n, A_min, A_max, B_min, B_max):\n    \"\"\"\n    Calculates the cross-sectional area of the bistable region in the\n    (alpha, beta) plane for a fixed n. This is the integrand for the volume calculation.\n    \"\"\"\n    if n = 1.0:\n        return 0.0\n\n    c = r_c(n)\n    \n    if np.isinf(c) or c == 0:\n        return 0.0\n\n    beta_0 = A_min / c\n    beta_1 = A_max / c\n\n    # Term 1: Area of the rectangular region where all alpha values satisfy the condition.\n    # This corresponds to beta  beta_0.\n    term1_width = np.max([0.0, np.min([B_max, beta_0]) - B_min])\n    area1 = (A_max - A_min) * term1_width\n\n    # Term 2: Area of the trapezoidal region.\n    # This corresponds to beta_0 = beta = beta_1.\n    beta_l = np.max([B_min, beta_0])\n    beta_u = np.min([B_max, beta_1])\n\n    area2 = 0.0\n    if beta_u > beta_l:\n        # Integral of (A_max - c*beta) from beta_l to beta_u\n        integral_val = A_max * (beta_u - beta_l) - (c / 2.0) * (beta_u**2 - beta_l**2)\n        # The problem statement's [...]+ notation implies taking max(0, integral_val),\n        # though the geometry ensures it should be non-negative if beta_u > beta_l.\n        area2 = integral_val\n        \n    return area1 + area2\n\ndef calculate_volume(box_params):\n    \"\"\"\n    Computes the bistable volume for a given parameter box.\n    \"\"\"\n    A_min, A_max, B_min, B_max, N_min, N_max = box_params\n    \n    # Use scipy.integrate.quad for numerical integration over n.\n    # The area_integrand function handles the case n = 1 by returning 0.\n    volume, _ = integrate.quad(\n        area_integrand,\n        N_min,\n        N_max,\n        args=(A_min, A_max, B_min, B_max),\n        epsabs=1.49e-09, \n        epsrel=1.49e-09,\n        limit=100\n    )\n    return volume\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Test Case 1\n        {\n            \"full_box\": (0.5, 10.0, 0.2, 5.0, 1.2, 5.0),\n            \"opt_setup\": {\n                \"super_box\": (0.5, 10.0, 0.2, 5.0, 1.2, 5.0),\n                \"widths\": (3.0, 1.0, 2.0)\n            }\n        },\n        # Test Case 2\n        {\n            \"full_box\": (1.0, 2.0, 0.5, 1.0, 1.0, 2.0),\n            \"opt_setup\": {\n                \"super_box\": (1.0, 2.0, 0.5, 1.0, 1.0, 2.0),\n                \"widths\": (1.0, 0.5, 1.0)\n            }\n        },\n        # Test Case 3\n        {\n             \"full_box\": (0.1, 3.0, 0.2, 1.5, 0.8, 1.4),\n             \"opt_setup\": {\n                 \"super_box\": (0.1, 3.0, 0.2, 1.5, 0.8, 1.4),\n                 \"widths\": (1.0, 0.5, 0.4)\n             }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Part 1: Volume of the full given box\n        V = calculate_volume(case[\"full_box\"])\n        results.append(V)\n\n        # Part 2: Maximal volume for the optimally placed sub-box\n        A_lo, A_hi, B_lo, B_hi, N_lo, N_hi = case[\"opt_setup\"][\"super_box\"]\n        w_alpha, w_beta, w_n = case[\"opt_setup\"][\"widths\"]\n        \n        # Optimal placement for alpha (high end) and beta (low end)\n        A_min_opt = A_hi - w_alpha\n        A_max_opt = A_hi\n        B_min_opt = B_lo\n        B_max_opt = B_lo + w_beta\n        \n        # Candidate 1 for n-box placement (lower end of feasible range)\n        N_min_1 = N_lo\n        N_max_1 = N_lo + w_n\n        opt_box_1 = (A_min_opt, A_max_opt, B_min_opt, B_max_opt, N_min_1, N_max_1)\n        V_opt_1 = calculate_volume(opt_box_1)\n        \n        # Candidate 2 for n-box placement (upper end of feasible range)\n        N_min_2 = N_hi - w_n\n        N_max_2 = N_hi\n        opt_box_2 = (A_min_opt, A_max_opt, B_min_opt, B_max_opt, N_min_2, N_max_2)\n        V_opt_2 = calculate_volume(opt_box_2)\n        \n        V_opt = max(V_opt_1, V_opt_2)\n        results.append(V_opt)\n\n    # Format the final output as a single line\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}