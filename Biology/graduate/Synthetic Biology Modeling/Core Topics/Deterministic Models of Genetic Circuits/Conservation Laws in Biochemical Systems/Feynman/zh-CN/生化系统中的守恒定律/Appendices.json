{
    "hands_on_practices": [
        {
            "introduction": "在构建任何生化网络模型之前，一个至关重要的步骤是验证其化学计量一致性。这个基本检查确保了网络中的反应不会凭空创造或消灭质量，从而违背质量守恒定律。本练习将指导你如何将这个物理原则转化为一个线性规划可行性问题，这是一种强大的计算方法，用于系统性地检验模型结构是否在根本上是有效的。",
            "id": "3909429",
            "problem": "考虑一个由化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 表示的生物化学反应网络，其中 $m$ 是化学物质（代谢物）的数量， $n$ 是反应的数量。$S$ 的每一列编码一个单一的反应：负数项表示消耗，正数项表示生成。在合成生物学建模中，化学计量一致性要求存在一个严格正值的代谢物质量分配，该分配由 $\\mathbb{R}^m$ 中的一个向量表示，使得总质量在每个反应中都守恒。从封闭的生物化学转化中质量守恒的基本原理出发，请从第一性原理推导出一个形式化的可行性条件，用于检验给定的化学计量矩阵是否具有化学计量一致性。您的推导必须仅使用质量守恒定律和化学计量编码的核心定义，并且必须产生一个可以使用线性规划（LP）进行检验的条件，同时对不可行性有一个清晰的解释，即反应式中的不一致性。\n\n一旦您推导出可行性条件，请实现一个完整的程序，该程序对下面定义的测试套件中的每个化学计量矩阵，确定该矩阵是否具有化学计量一致性，并输出结果。在您的实现中，不参与任何反应的代谢物，即 $S$ 中恒为零的行，必须被视为不参与反应的物质，其质量变量固定为零，以避免可行性问题中的退化情况。所有参与反应的代谢物必须通过决策变量的下界被赋予严格正值的质量。程序必须为每个测试用例求解推导出的LP可行性问题，并将求解器的不可行性解释为不存在严格正值的质量分配可以在所有反应中保持质量守恒的证据，即该网络在化学计量上是不一致的。\n\n测试套件由以下化学计量矩阵组成，每个矩阵都在 $\\mathbb{R}^{m \\times n}$ 中指定，其中行对应于代谢物 $\\{A,B,C\\}$（如适用）：\n\n1. 两种物质之间的单次可逆转换：$S_1 \\in \\mathbb{R}^{2 \\times 1}$，\n$$\nS_1 = \\begin{bmatrix}\n-1 \\\\\n+1\n\\end{bmatrix}.\n$$\n2. 净降解为无物（无产物），捕捉了一个物理上不现实的汇：$S_2 \\in \\mathbb{R}^{2 \\times 1}$，\n$$\nS_2 = \\begin{bmatrix}\n-1 \\\\\n-1\n\\end{bmatrix}.\n$$\n3. 在三种物质之间守恒总质量的两个反应的相互转换：$S_3 \\in \\mathbb{R}^{3 \\times 2}$，\n$$\nS_3 = \\begin{bmatrix}\n-1  +1 \\\\\n-1  +1 \\\\\n+1  -1\n\\end{bmatrix}.\n$$\n4. 明确包含一种不参与反应的物质的转换：$S_4 \\in \\mathbb{R}^{3 \\times 1}$，\n$$\nS_4 = \\begin{bmatrix}\n-1 \\\\\n+1 \\\\\n0\n\\end{bmatrix}.\n$$\n5. 终止于一个汇的两步路径：$S_5 \\in \\mathbb{R}^{2 \\times 2}$，\n$$\nS_5 = \\begin{bmatrix}\n-1  0 \\\\\n+1  -1\n\\end{bmatrix}.\n$$\n\n您的程序必须对每个 $S_k$，建立并求解从质量守恒原理推导出的LP可行性问题，对参与反应的代谢物强制执行严格正值的下界，将不参与反应的代谢物质的质量固定为零，并按 $S_1$ 到 $S_5$ 的顺序返回每个案例的一致性布尔值。\n\n最终输出格式：您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[True,False,True,False,True]”）。\n\n本问题不涉及物理单位。角度和百分比不适用。",
            "solution": "本问题要求从质量守恒的第一性原理出发，推导化学计量一致性的形式化可行性条件，并实现该条件以测试一系列给定的化学计量矩阵。\n\n**可行性条件的推导**\n\n让我们首先根据所提供的定义，将问题的各个组成部分形式化。一个生物化学反应网络由一个化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 描述，其中 $m$ 是化学物质的数量， $n$ 是反应的数量。该矩阵的一个元素 $S_{ij}$ 代表物质 $i$ 在反应 $j$ 中的化学计量系数。$S_{ij}$ 为负值表示物质 $i$ 在反应 $j$ 中被消耗，而正值表示其被生成。\n\n基本原理是质量守恒定律，该定律指出在任何封闭的化学反应中，反应物的总质量等于产物的总质量。我们旨在找到一个条件，该条件必须被满足，以使该定律在网络中的所有反应中均成立。\n\n让我们为每种物质分配一个分子质量。我们定义一个质量向量 $x \\in \\mathbb{R}^m$，其中 $x_i$ 是物质 $i$ 一个单位（例如，一摩尔）的质量。为使网络在物理上是现实的，每种物质都必须具有非负质量，因此 $x_i \\ge 0$。问题要求对参与反应的代谢物进行*严格正值*的分配，我们将很快纳入这一点。\n\n现在，考虑单个反应 $j$。此反应过程中的质量变化 $\\Delta M_j$ 是所有物质质量的总和，每种物质的质量都按其在该反应中的化学计量系数加权。\n$$\n\\Delta M_j = \\sum_{i=1}^{m} S_{ij} x_i\n$$\n质量守恒定律要求，为使反应 $j$ 成为一个平衡的转化，这个净质量变化必须为零。\n$$\n\\Delta M_j = \\sum_{i=1}^{m} S_{ij} x_i = 0\n$$\n这个方程是代表反应 $j$ 的列向量（即 $S$ 的第 $j$ 列）与质量向量 $x$ 的点积。用向量表示法，如果我们令 $S_{:,j}$ 为 $S$ 的第 $j$ 列，则为 $x^T S_{:,j} = 0$。\n\n化学计量一致性要求这个质量守恒定律对网络中的*每一个*反应都成立。因此，对于所有 $j \\in \\{1, 2, \\dots, n\\}$，该条件都必须成立。这给了我们一个包含 $n$ 个线性方程的方程组：\n$$\n\\begin{cases}\n    \\sum_{i=1}^{m} S_{i1} x_i = 0 \\\\\n    \\sum_{i=1}^{m} S_{i2} x_i = 0 \\\\\n    \\vdots \\\\\n    \\sum_{i=1}^{m} S_{in} x_i = 0\n\\end{cases}\n$$\n这个方程组可以用矩阵形式紧凑地表示。认识到该方程组等价于化学计量矩阵的转置 $S^{\\top}$ 与质量向量 $x$ 的乘积，我们得到：\n$$\nS^{\\top} x = \\mathbf{0}\n$$\n其中 $\\mathbf{0}$ 是 $\\mathbb{R}^n$ 中的零向量。\n\n问题将化学计量一致性定义为存在一个对参与反应的代谢物进行的*严格正值*的质量分配。让我们将参与反应的物质的索引集合定义为 $I_p = \\{i \\mid \\exists j, S_{ij} \\neq 0\\}$，意味着物质 $i$ 至少参与一个反应。相应地，不参与反应的物质的索引集合是 $I_{np} = \\{i \\mid \\forall j, S_{ij} = 0\\}$。\n\n因此，对质量向量 $x$ 的约束是：\n1.  对于每个参与反应的物质 $i \\in I_p$，其质量必须为严格正值：$x_i > 0$。\n2.  对于每个不参与反应的物质 $i \\in I_{np}$，其质量按规定固定为零：$x_i = 0$。\n\n将这些约束与质量平衡方程相结合，化学计量矩阵 $S$ 是一致的，当且仅当存在一个向量 $x \\in \\mathbb{R}^m$ 满足以下条件系统：\n$$\n\\begin{cases}\n    S^{\\top} x = \\mathbf{0} \\\\\n    x_i > 0  \\forall i \\in I_p \\\\\n    x_i = 0  \\forall i \\in I_{np}\n\\end{cases}\n$$\n这是一个可行性问题。为了使其能被标准的线性规划（LP）求解器解决（这些求解器通常处理非严格不等式 $\\ge$ 或 $\\le$），我们可以转换严格不等式 $x_i > 0$。由于方程 $S^{\\top} x = \\mathbf{0}$ 是齐次的，如果存在一个解 $x$ 使得对于所有 $i \\in I_p$ 都有 $x_i > 0$，那么对于任何标量 $c > 0$，向量 $c \\cdot x$ 也是一个解。这意味着我们可以在不失一般性的情况下设置一个任意的正下界。一个方便的选择是 $1$。因此，条件 $x_i > 0$ 可以被替换为 $x_i \\ge 1$。\n\n用于检验化学计量一致性的最终可测试条件是以下LP问题的可行性：\n\n**寻找一个向量 $x \\in \\mathbb{R}^m$ 使得：**\n1.  **等式约束：** $S^{\\top} x = \\mathbf{0}$\n2.  **变量边界：**\n    - 对于所有 $i \\in I_p$（参与反应的物质），$x_i \\ge 1$\n    - 对于所有 $i \\in I_{np}$（不参与反应的物质），$x_i = 0$\n\n这是一个标准的LP可行性问题。我们可以设置一个任意的目标函数，例如最小化 $c^T x$，其中 $c = \\mathbf{0}$。如果LP求解器找到了一个可行解，则矩阵 $S$ 是化学计量一致的。如果求解器确定问题是不可行的，这意味着不存在这样的严格正值质量分配，矩阵 $S$ 在化学计量上是不一致的。这个推导出的条件是可直接实现的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef is_stoichiometrically_consistent(S: np.ndarray) -> bool:\n    \"\"\"\n    Determines if a stoichiometric matrix is consistent by solving an LP feasibility problem.\n\n    A matrix S is stoichiometrically consistent if there exists a mass vector x\n    such that:\n    1. S^T @ x = 0 (mass is conserved in every reaction)\n    2. x_i >= 1 for all participating species i (strictly positive mass)\n    3. x_i = 0 for all non-participating species i\n\n    Args:\n        S: The stoichiometric matrix (m_species x n_reactions).\n\n    Returns:\n        True if the matrix is consistent, False otherwise.\n    \"\"\"\n    if S.ndim == 1:\n        S = S.reshape(-1, 1)\n\n    m_species, n_reactions = S.shape\n\n    # Identify participating species (rows that are not all zero)\n    # and set up bounds for the mass vector x.\n    bounds = []\n    is_participating = np.any(S != 0, axis=1)\n\n    for i in range(m_species):\n        if is_participating[i]:\n            # For participating metabolites, mass x_i must be strictly positive.\n            # We use x_i >= 1 as a lower bound.\n            bounds.append((1, None))\n        else:\n            # For non-participating metabolites, mass x_i must be zero.\n            bounds.append((0, 0))\n\n    # The objective function is irrelevant for a feasibility problem.\n    # We can set the cost vector c to all zeros.\n    c = np.zeros(m_species)\n\n    # The equality constraints from mass conservation are S^T @ x = 0.\n    A_eq = S.T\n    b_eq = np.zeros(n_reactions)\n\n    # Solve the linear programming problem.\n    # The 'highs' solver is robust and suitable for this task.\n    # We only care about feasibility, which is indicated by the 'success' flag.\n    res = linprog(c, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n    # If the solver finds a feasible solution, res.success is True.\n    # Infeasibility means no such mass vector x exists, and the network is inconsistent.\n    return res.success\n\ndef solve():\n    \"\"\"\n    Defines the test suite of stoichiometric matrices and checks each for consistency.\n    \"\"\"\n    # Test cases from the problem statement.\n    test_cases = [\n        # S1: A -> B, m=2, n=1. Consistent.\n        np.array([\n            [-1],\n            [+1]\n        ]),\n        # S2: A + B -> empty, m=2, n=1. Inconsistent (mass sink).\n        np.array([\n            [-1],\n            [-1]\n        ]),\n        # S3: A+B -> C, m=3, n=2. Consistent.\n        np.array([\n            [-1, +1],\n            [-1, +1],\n            [+1, -1]\n        ]),\n        # S4: A -> B, with non-participating C, m=3, n=1. Consistent.\n        np.array([\n            [-1],\n            [+1],\n            [ 0]\n        ]),\n        # S5: A -> B -> empty, m=2, n=2. Inconsistent (pathway to a sink).\n        np.array([\n            [-1,  0],\n            [+1, -1]\n        ]),\n    ]\n\n    results = []\n    for S in test_cases:\n        is_consistent = is_stoichiometrically_consistent(S)\n        results.append(is_consistent)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "将理论付诸实践，我们经常需要在模型中定义一个概括了细胞生长过程的“生物质”伪反应。这个练习演示了如何应用元素守恒定律来精确确定这个复杂反应的化学计量系数。通过确保模型中的生物质组成与实验测量的元素分析相匹配，我们为更精确的代谢流分析和预测奠定了基础。",
            "id": "3909438",
            "problem": "在基于约束的合成生物学中，一个核心的建模步骤是定义一个生物质伪反应，该反应将前体代谢物消耗生成一种名为生物质（Biomass, BM）的单一伪代谢物，同时遵循原子守恒定律。原子守恒意味着在任何化学上允许的反应中，反应物和产物中每种元素的总数是相同的。考虑以下物种集合及其由元素关联矩阵（Elemental Incidence Matrix, EIM）$M$ 给出的元素组成。$M$ 的行按顺序对应于元素碳（$\\mathrm{C}$）、氢（$\\mathrm{H}$）、氮（$\\mathrm{N}$）、氧（$\\mathrm{O}$）、磷（$\\mathrm{P}$）和硫（$\\mathrm{S}$），其列按顺序对应于物种氨基酸池（Amino Acid Pool, AAP）、脂肪酸池（Fatty Acid Pool, FAP）、核苷酸池（Nucleotide Pool, NUP）、碳水化合物池（Carbohydrate Pool, CHOP）、磷酸盐（Phosphate, Pi）、硫酸盐（Sulfate, $\\text{SO}_4$）和生物质（Biomass, BM）：\n$$\nM \\;=\\;\n\\begin{pmatrix}\n5  16  10  6  0  0  37 \\\\\n9  30  12  10  0  0  61 \\\\\n2  0  5  0  0  0  7 \\\\\n2  2  6  5  4  4  23 \\\\\n0  0  1  0  1  0  2 \\\\\n0  0  0  0  0  1  1\n\\end{pmatrix}.\n$$\n上述生物质（BM）列反映了每个任意生物质单位经实验测得的元素组成：$\\mathrm{C}=37$、$\\mathrm{H}=61$、$\\mathrm{N}=7$、$\\mathrm{O}=23$、$\\mathrm{P}=2$、$\\mathrm{S}=1$。\n\n将有序物种 $(\\mathrm{AAP}, \\mathrm{FAP}, \\mathrm{NUP}, \\mathrm{CHOP}, \\mathrm{Pi}, \\mathrm{SO}_4, \\mathrm{BM})$ 上的生物质反应列化学计量向量 $s_{\\mathrm{BM}}$ 定义为\n$$\ns_{\\mathrm{BM}} \\;=\\; \\begin{pmatrix} -a \\\\ -b \\\\ -c \\\\ -d \\\\ -e \\\\ -f \\\\ +1 \\end{pmatrix},\n$$\n其中 $a,b,c,d,e,f$ 是非负实数化学计量系数，将通过对 $\\mathrm{C}$、$\\mathrm{H}$、$\\mathrm{N}$、$\\mathrm{O}$、$\\mathrm{P}$ 和 $\\mathrm{S}$ 强制执行原子守恒来确定。符号约定为：反应物（消耗）为负，产物 BM（生成）为正。\n\n任务1：确定 $a,b,c,d,e,f$ 的精确值，使得生物质反应中每种元素的总数守恒，且与给定的 BM 组成一致。\n\n任务2：为说明如何检测不一致性，假设第二次测量提出了一个备选的 BM 氧原子数为 $\\mathrm{O}=22$，而所有其他元素的数量与上表相同。设 $M'$ 与矩阵 $M$ 相同，只是 BM 的氧条目为 $22$ 而非 $23$。使用任务1中找到的化学计量向量 $s_{\\mathrm{BM}}$，计算元素残差向量 $r$，$r \\in \\mathbb{R}^{6}$，定义为 EIM 与生物质列的乘积，该向量量化了备选 BM 氧原子数下各元素的失衡情况。\n\n答案报告：将您的最终答案表示为一个单行矩阵，该矩阵按顺序串联 $s_{\\mathrm{BM}}$ 的七个条目和残差向量 $r$ 的六个条目。无需四舍五入；报告精确整数。无需单位。",
            "solution": "在尝试解答之前，将对问题进行验证。\n\n### 第1步：提取已知条件\n已知条件如下：\n-   一个元素关联矩阵（EIM）$M$：\n    $$\n    M \\;=\\;\n    \\begin{pmatrix}\n    5  16  10  6  0  0  37 \\\\\n    9  30  12  10  0  0  61 \\\\\n    2  0  5  0  0  0  7 \\\\\n    2  2  6  5  4  4  23 \\\\\n    0  0  1  0  1  0  2 \\\\\n    0  0  0  0  0  1  1\n    \\end{pmatrix}\n    $$\n-   $M$ 的行按顺序对应于元素碳（$\\mathrm{C}$）、氢（$\\mathrm{H}$）、氮（$\\mathrm{N}$）、氧（$\\mathrm{O}$）、磷（$\\mathrm{P}$）和硫（$\\mathrm{S}$）。\n-   $M$ 的列按顺序对应于物种氨基酸池（Amino Acid Pool, AAP）、脂肪酸池（Fatty Acid Pool, FAP）、核苷酸池（Nucleotide Pool, NUP）、碳水化合物池（Carbohydrate Pool, CHOP）、磷酸盐（Phosphate, Pi）、硫酸盐（Sulfate, SO$_4$）和生物质（Biomass, BM）。\n-   生物质反应列化学计量向量 $s_{\\mathrm{BM}}$ 定义为：\n    $$\n    s_{\\mathrm{BM}} \\;=\\; \\begin{pmatrix} -a \\\\ -b \\\\ -c \\\\ -d \\\\ -e \\\\ -f \\\\ +1 \\end{pmatrix}\n    $$\n    其中 $a, b, c, d, e, f$ 是非负实数化学计量系数。\n-   **任务1**：通过对所有六种元素强制执行原子守恒，确定 $a,b,c,d,e,f$ 的精确值。\n-   **任务2**：第二次测量提出了一个备选的 BM 氧原子数为 $O=22$。设 $M'$ 为矩阵 $M$，但 BM 氧条目（第4行，第7列）从23变为22。使用任务1中找到的向量 $s_{\\mathrm{BM}}$，计算元素残差向量 $r \\in \\mathbb{R}^{6}$，定义为 $r = M' s_{\\mathrm{BM}}$。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学基础（关键）**：该问题坚实地基于化学反应中质量守恒（特别是原子守恒）的基本原理。这是化学计量学的核心概念，也是系统生物学和合成生物学中基于约束建模的核心。该问题在科学上是合理的。\n-   **适定性**：该问题被构造为任务1的线性方程组和任务2的矩阵-向量乘法。如果该方程组有唯一解，则问题是适定的。快速检查表明这是一个非奇异系统。\n-   **客观性（关键）**：问题使用精确的数学和科学语言陈述，没有主观或模糊的术语。\n-   **完整性和一致性**：提供了所有必要的数据（矩阵、向量、定义）。设置中没有矛盾之处。\n-   **其他缺陷**：该问题不是隐喻性的、琐碎的，或超出科学可验证范围的。\n\n### 第3步：结论和行动\n问题有效。将提供解答。\n\n### 解答推导\n一个反应的原子守恒原理指出，反应物侧和产物侧每种元素的原子总数必须相同。在矩阵表示法中，这表示为元素关联矩阵（$M$）与反应的化学计量向量（$s$）的乘积等于零向量。\n\n#### 任务1：确定化学计量系数\n对于生物质反应，守恒定律为：\n$$ M s_{\\mathrm{BM}} = \\mathbf{0} $$\n代入给定的 $M$ 和 $s_{\\mathrm{BM}}$ 形式：\n$$\n\\begin{pmatrix}\n5  16  10  6  0  0  37 \\\\\n9  30  12  10  0  0  61 \\\\\n2  0  5  0  0  0  7 \\\\\n2  2  6  5  4  4  23 \\\\\n0  0  1  0  1  0  2 \\\\\n0  0  0  0  0  1  1\n\\end{pmatrix}\n\\begin{pmatrix} -a \\\\ -b \\\\ -c \\\\ -d \\\\ -e \\\\ -f \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这个矩阵方程可以通过将反应物（系数为 $-a, \\dots, -f$）与产物（系数为 $1$）分开来重写。设 $M_{\\text{reac}}$ 为 $M$ 的前六列，$m_{\\text{BM}}$ 为 $M$ 的第七列。设 $s_{\\text{reac}} = (a, b, c, d, e, f)^T$。方程变为：\n$$ -M_{\\text{reac}} s_{\\text{reac}} + m_{\\text{BM}} = \\mathbf{0} \\quad \\implies \\quad M_{\\text{reac}} s_{\\text{reac}} = m_{\\text{BM}} $$\n这产生了一个包含 $6$ 个未知数 $(a, b, c, d, e, f)$ 的 $6$ 个线性方程组：\n1.  ($\\mathrm{C}$): $5a + 16b + 10c + 6d + 0e + 0f = 37$\n2.  ($\\mathrm{H}$): $9a + 30b + 12c + 10d + 0e + 0f = 61$\n3.  ($\\mathrm{N}$): $2a + 0b + 5c + 0d + 0e + 0f = 7$\n4.  ($\\mathrm{O}$): $2a + 2b + 6c + 5d + 4e + 4f = 23$\n5.  ($\\mathrm{P}$): $0a + 0b + c + 0d + e + 0f = 2$\n6.  ($\\mathrm{S}$): $0a + 0b + 0c + 0d + 0e + f = 1$\n\n我们可以从最简单的方程开始，通过代入法求解这个系统。\n从方程（6）得到：\n$$ f = 1 $$\n从方程（5）得到：\n$$ e = 2 - c $$\n从方程（3）得到：\n$$ 2a + 5c = 7 \\implies a = \\frac{7 - 5c}{2} $$\n将 $f=1$ 代入方程（4）：\n$$ 2a + 2b + 6c + 5d + 4e + 4(1) = 23 \\implies 2a + 2b + 6c + 5d + 4e = 19 $$\n现在将 $e=2-c$ 代入这个修改后的方程（4）：\n$$ 2a + 2b + 6c + 5d + 4(2-c) = 19 \\implies 2a + 2b + 6c + 5d + 8 - 4c = 19 \\implies 2a + 2b + 2c + 5d = 11 $$\n我们现在有一个涉及 $a, b, c, d$ 的系统。让我们将 $a = \\frac{7 - 5c}{2}$ 代入剩余的方程（1）、（2）和修改后的（4）。\n代入修改后的（4）：$2\\left(\\frac{7-5c}{2}\\right) + 2b + 2c + 5d = 11 \\implies 7 - 5c + 2b + 2c + 5d = 11 \\implies 2b - 3c + 5d = 4$\n代入（1）：$5\\left(\\frac{7-5c}{2}\\right) + 16b + 10c + 6d = 37 \\implies 35 - 25c + 32b + 20c + 12d = 74 \\implies 32b - 5c + 12d = 39$\n代入（2）：$9\\left(\\frac{7-5c}{2}\\right) + 30b + 12c + 10d = 61 \\implies 63 - 45c + 60b + 24c + 20d = 122 \\implies 60b - 21c + 20d = 59$\n\n我们有一个关于 $b, c, d$ 的 $3\\times3$ 系统：\n(i) $2b - 3c + 5d = 4$\n(ii) $32b - 5c + 12d = 39$\n(iii) $60b - 21c + 20d = 59$\n\n简单检查一下问题的整数设置，表明可能存在一个简单的整数解。让我们测试 $a=1, b=1, c=1, d=1, e=1, f=1$。\n- $f=1$：从（6）得到，正确。\n- $c+e=2 \\implies 1+1=2$：从（5）得到，正确。\n- $2a+5c=7 \\implies 2(1)+5(1)=7$：从（3）得到，正确。\n- $5a+16b+10c+6d=37 \\implies 5(1)+16(1)+10(1)+6(1) = 37$：从（1）得到，正确。\n- $9a+30b+12c+10d=61 \\implies 9(1)+30(1)+12(1)+10(1) = 61$：从（2）得到，正确。\n- $2a+2b+6c+5d+4e+4f=23 \\implies 2(1)+2(1)+6(1)+5(1)+4(1)+4(1) = 23$：从（4）得到，正确。\n\n解确实是 $a=1, b=1, c=1, d=1, e=1, f=1$。\n因此，生物质化学计量向量为：\n$$ s_{\\mathrm{BM}} = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\\\ -1 \\\\ -1 \\\\ -1 \\\\ 1 \\end{pmatrix} $$\n\n#### 任务2：计算元素残差向量\n定义一个新的元素关联矩阵 $M'$，其中生物质（BM）的氧原子数为 $22$ 而非 $23$。$M$ 中的所有其他值保持不变。因此，$M'_{4,7} = 22$。\n$$\nM' \\;=\\;\n\\begin{pmatrix}\n5  16  10  6  0  0  37 \\\\\n9  30  12  10  0  0  61 \\\\\n2  0  5  0  0  0  7 \\\\\n2  2  6  5  4  4  22 \\\\\n0  0  1  0  1  0  2 \\\\\n0  0  0  0  0  1  1\n\\end{pmatrix}\n$$\n残差向量 $r$ 定义为 $r = M' s_{\\mathrm{BM}}$。我们使用任务1中找到的 $s_{\\mathrm{BM}}$ 向量。\n$$\nr = \\begin{pmatrix}\n5  16  10  6  0  0  37 \\\\\n9  30  12  10  0  0  61 \\\\\n2  0  5  0  0  0  7 \\\\\n2  2  6  5  4  4  22 \\\\\n0  0  1  0  1  0  2 \\\\\n0  0  0  0  0  1  1\n\\end{pmatrix}\n\\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\\\ -1 \\\\ -1 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n$r=(r_C, r_H, r_N, r_O, r_P, r_S)^T$ 的分量计算如下：\n$r_C = 5(-1) + 16(-1) + 10(-1) + 6(-1) + 0(-1) + 0(-1) + 37(1) = -37 + 37 = 0$\n$r_H = 9(-1) + 30(-1) + 12(-1) + 10(-1) + 0(-1) + 0(-1) + 61(1) = -61 + 61 = 0$\n$r_N = 2(-1) + 0(-1) + 5(-1) + 0(-1) + 0(-1) + 0(-1) + 7(1) = -7 + 7 = 0$\n$r_O = 2(-1) + 2(-1) + 6(-1) + 5(-1) + 4(-1) + 4(-1) + 22(1) = -2-2-6-5-4-4 + 22 = -23 + 22 = -1$\n$r_P = 0(-1) + 0(-1) + 1(-1) + 0(-1) + 1(-1) + 0(-1) + 2(1) = -1 - 1 + 2 = 0$\n$r_S = 0(-1) + 0(-1) + 0(-1) + 0(-1) + 0(-1) + 1(-1) + 1(1) = -1 + 1 = 0$\n\n残差向量为：\n$$ r = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n这个结果表明，使用为原始生物质组成计算的系数，新生物质组成的反应除了氧之外的所有元素都是平衡的，而氧有一个未被计入的 $1$ 个原子的净消耗（$r_O = -1$）。\n\n最终答案要求将 $s_{\\mathrm{BM}}$ 的七个条目与 $r$ 的六个条目串联起来。\n$s_{\\mathrm{BM}}$ 分量：$-1, -1, -1, -1, -1, -1, 1$\n$r$ 分量：$0, 0, 0, -1, 0, 0$\n串联后的向量：$(-1, -1, -1, -1, -1, -1, 1, 0, 0, 0, -1, 0, 0)$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -1  -1  -1  -1  -1  -1  1  0  0  0  -1  0  0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "生物系统本质上是动态的；细胞会生长和分裂，这为质量守恒定律的应用带来了新的维度。本练习探讨了系统体积的变化（即生长）如何影响守恒定律，特别是当我们将关注点从浓度转移到分子总数时。通过这个练习，你将推导出在动态生长条件下，即使是化学计量守恒的系统，其守恒量的总和也会因稀释效应而发生变化。",
            "id": "3909476",
            "problem": "一个充分混合的细胞内区室包含 $m$ 种化学物质，其物质量向量为 $n(t) \\in \\mathbb{R}^{m}$，浓度向量为 $x(t) \\in \\mathbb{R}^{m}$，两者通过 $n(t) = V(t)\\,x(t)$ 相关联，其中 $V(t)$ 是区室的体积。细胞内反应由化学计量矩阵 $S \\in \\mathbb{R}^{m \\times r}$ 和反应速率向量 $v(x(t)) \\in \\mathbb{R}^{r}$ 建模，因此在空间均匀性假设下，反应对 $n(t)$ 变化率的贡献为 $S\\,v(x(t))$。随着细胞的生长，区室边界会移动，导致 $V(t)$ 发生变化。您可以假定以下基于物理的基础：\n- 基于移动控制体积的雷诺输运定理 (RTT) 的质量守恒，以及\n- 充分混合、空间均匀的浓度，且边界上没有扩散通量。\n\n考虑这样一种情况：体积增长是通过在区室边界上增加细胞质来实现的，边界处的组分与瞬时内部组分相同，因此每种物质积累的平流贡献为 $x(t)\\,\\frac{dV}{dt}$。令 $w \\in \\mathbb{R}^{m}$ 为一个任意的候选守恒向量。\n\n任务：\n1) 从雷诺输运定理和定义 $n(t) = \\int_{V(t)} x(t)\\,dV$ 出发，在上述边界吸积假设下，推导 $\\frac{d}{dt}\\big(w^{\\top} n(t)\\big)$ 关于 $S$, $v(x(t))$, $x(t)$ 和 $\\frac{dV}{dt}$ 的一般表达式。然后，用 $w$, $S$, $x(t)$ 和 $\\frac{dV}{dt}$ 陈述线性泛函 $w^{\\top} n(t)$ 随时间保持不变的精确条件，以及不变性被破坏的条件。\n\n2) 现在，特化为一个包含三种物质的链式反应，其中 $m = 3$ 且\n$$\nS \\;=\\;\n\\begin{pmatrix}\n-1  0 \\\\\n\\;\\;1  -1 \\\\\n\\;\\;0  \\;\\;1\n\\end{pmatrix},\n\\qquad\nw \\;=\\;\n\\begin{pmatrix}\n1 \\\\\n1 \\\\\n1\n\\end{pmatrix}.\n$$\n在时间 $t^{\\ast}$，体积为 $V(t^{\\ast}) = 2.0 \\times 10^{-12}$ 升，瞬时生长率为 $\\mu = \\frac{1}{V}\\frac{dV}{dt}\\big|_{t^{\\ast}} = 1.0 \\times 10^{-2}$ s$^{-1}$，细胞内浓度为 $x_{1}(t^{\\ast}) = 2.0 \\times 10^{-3}$ mol L$^{-1}$，$x_{2}(t^{\\ast}) = 1.0 \\times 10^{-3}$ mol L$^{-1}$，以及 $x_{3}(t^{\\ast}) = 1.0 \\times 10^{-3}$ mol L$^{-1}$。在上述边界吸积假设下，计算 $\\frac{d}{dt}\\big(w^{\\top} n(t)\\big)\\big|_{t^{\\ast}}$ 的瞬时值。用 mol s$^{-1}$ 表示你的最终结果，并四舍五入到三位有效数字。",
            "solution": "该问题经验证具有科学依据、良定、客观且自洽。这是一个合成生物学建模中的规范问题，利用了质量平衡和反应动力学的标准原理。前提条件在物理上是合理的，并且所有需要的数据都已提供。\n\n### 第1部分：一般表达式和不变性条件\n\n问题要求推导线性泛函 $w^{\\top} n(t)$ 的变化率。物质的总量由向量 $n(t) \\in \\mathbb{R}^{m}$ 给出。$n(t)$ 的变化率，记为 $\\frac{d n(t)}{dt}$，是细胞内反应和边界上新体积增加所产生贡献的总和。\n\n根据问题陈述：\n1.  反应对 $n(t)$ 变化率的贡献由 $S v(x(t))$ 给出，其中 $S \\in \\mathbb{R}^{m \\times r}$ 是化学计量矩阵，$v(x(t)) \\in \\mathbb{R}^{r}$ 是反应速率向量。\n2.  在“边界吸积”假设（新增加的细胞质与主体具有相同组分）下，体积增长的贡献是一个平流项，由 $x(t) \\frac{dV(t)}{dt}$ 给出。\n\n将这两个贡献相加，得到物质量向量 $n(t)$ 的总变化率：\n$$\n\\frac{d n(t)}{dt} = S v(x(t)) + x(t) \\frac{dV(t)}{dt}\n$$\n我们关心的是标量 $w^{\\top} n(t)$ 的时间导数。由于 $w$ 是一个常数向量，我们可以将时间导数作用于 $n(t)$：\n$$\n\\frac{d}{dt} \\left( w^{\\top} n(t) \\right) = w^{\\top} \\frac{d n(t)}{dt}\n$$\n代入 $\\frac{d n(t)}{dt}$ 的表达式：\n$$\n\\frac{d}{dt} \\left( w^{\\top} n(t) \\right) = w^{\\top} \\left( S v(x(t)) + x(t) \\frac{dV(t)}{dt} \\right)\n$$\n利用矩阵乘法的分配律：\n$$\n\\frac{d}{dt} \\left( w^{\\top} n(t) \\right) = w^{\\top} S v(x(t)) + w^{\\top} x(t) \\frac{dV(t)}{dt}\n$$\n这就是线性泛函 $w^{\\top} n(t)$ 变化率的一般表达式。\n\n**不变性条件：**\n当且仅当其时间导数为零时，量 $w^{\\top} n(t)$ 随时间不变：\n$$\n\\frac{d}{dt} \\left( w^{\\top} n(t) \\right) = w^{\\top} S v(x(t)) + w^{\\top} x(t) \\frac{dV(t)}{dt} = 0\n$$\n该条件在以下情况下满足：\n1.  右侧的两项恒等于零。这是在所有状态和增长率下保持不变的最一般条件。\n    -   第一项 $w^{\\top} S v(x(t))$，对于任何有效的动力学 $v(x(t))$，如果 $w^{\\top} S = 0^{\\top}$（零行向量），则该项为零。这意味着 $w$ 位于 $S$ 的左零空间中，对应于一个化学计量守恒律。\n    -   第二项 $w^{\\top} x(t) \\frac{dV(t)}{dt}$，如果没有增长（$\\frac{dV(t)}{dt} = 0$）或者 $w^{\\top} x(t) = 0$，则该项为零。\n2.  两项均不为零但其和为零：$w^{\\top} S v(x(t)) = - w^{\\top} x(t) \\frac{dV(t)}{dt}$。这表示一个动态平衡，可能仅在特定状态或特定轨迹下成立，但并非普遍成立。\n\n**不变性被破坏的条件：**\n如果时间导数不为零，则不变性被破坏：\n$$\nw^{\\top} S v(x(t)) + w^{\\top} x(t) \\frac{dV(t)}{dt} \\neq 0\n$$\n一个值得注意的情况是当存在化学计量守恒律（$w^{\\top} S = 0^{\\top}$），但系统正在增长。在这种特定情况下，反应项消失，表达式简化为：\n$$\n\\frac{d}{dt} \\left( w^{\\top} n(t) \\right) = w^{\\top} x(t) \\frac{dV(t)}{dt}\n$$\n在这种情况下，不变性因增长而被破坏，前提是 $\\frac{dV(t)}{dt} \\neq 0$ 且浓度的加权和 $w^{\\top} x(t)$ 不为零。\n\n### 第2部分：具体计算\n\n我们被要求计算在特定时间 $t^{\\ast}$ 时 $\\frac{d}{dt}(w^{\\top} n(t))$ 的值。控制方程为：\n$$\n\\frac{d}{dt}\\big(w^{\\top} n(t)\\big)\\bigg|_{t^{\\ast}} = w^{\\top} S v(x(t^{\\ast})) + w^{\\top} x(t^{\\ast}) \\frac{dV}{dt}\\bigg|_{t^{\\ast}}\n$$\n我们给出了 $S$ 和 $w$ 的具体形式：\n$$\nS = \\begin{pmatrix} -1  0 \\\\ 1  -1 \\\\ 0  1 \\end{pmatrix}, \\qquad w = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n首先，我们计算乘积 $w^{\\top} S$：\n$$\nw^{\\top} S = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} -1  0 \\\\ 1  -1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} (1)(-1) + (1)(1) + (1)(0)  (1)(0) + (1)(-1) + (1)(1) \\end{pmatrix}\n$$\n$$\nw^{\\top} S = \\begin{pmatrix} -1+1  -1+1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\end{pmatrix} = 0^{\\top}\n$$\n由于 $w^{\\top} S = 0^{\\top}$，时间导数表达式中的第一项为零，无论反应速率 $v(x(t^{\\ast}))$ 是多少。\n$$\nw^{\\top} S v(x(t^{\\ast})) = 0^{\\top} v(x(t^{\\ast})) = 0\n$$\n表达式简化为：\n$$\n\\frac{d}{dt}\\big(w^{\\top} n(t)\\big)\\bigg|_{t^{\\ast}} = w^{\\top} x(t^{\\ast}) \\frac{dV}{dt}\\bigg|_{t^{\\ast}}\n$$\n现在，我们使用为时间 $t^{\\ast}$ 提供的数据来计算其余各项。\n瞬时生长率为 $\\mu = \\frac{1}{V}\\frac{dV}{dt}\\big|_{t^{\\ast}} = 1.0 \\times 10^{-2} \\, \\text{s}^{-1}$。\n体积为 $V(t^{\\ast}) = 2.0 \\times 10^{-12} \\, \\text{L}$。\n我们可以计算体积变化率：\n$$\n\\frac{dV}{dt}\\bigg|_{t^{\\ast}} = \\mu \\cdot V(t^{\\ast}) = (1.0 \\times 10^{-2} \\, \\text{s}^{-1}) \\times (2.0 \\times 10^{-12} \\, \\text{L}) = 2.0 \\times 10^{-14} \\, \\text{L} \\, \\text{s}^{-1}\n$$\n浓度向量为 $x(t^{\\ast}) = \\begin{pmatrix} x_1(t^{\\ast}) \\\\ x_2(t^{\\ast}) \\\\ x_3(t^{\\ast}) \\end{pmatrix} = \\begin{pmatrix} 2.0 \\times 10^{-3} \\\\ 1.0 \\times 10^{-3} \\\\ 1.0 \\times 10^{-3} \\end{pmatrix} \\, \\text{mol L}^{-1}$。\n我们计算浓度的加权和 $w^{\\top} x(t^{\\ast})$：\n$$\nw^{\\top} x(t^{\\ast}) = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} 2.0 \\times 10^{-3} \\\\ 1.0 \\times 10^{-3} \\\\ 1.0 \\times 10^{-3} \\end{pmatrix} \\, \\text{mol L}^{-1}\n$$\n$$\nw^{\\top} x(t^{\\ast}) = (2.0 \\times 10^{-3} + 1.0 \\times 10^{-3} + 1.0 \\times 10^{-3}) \\, \\text{mol L}^{-1} = 4.0 \\times 10^{-3} \\, \\text{mol L}^{-1}\n$$\n最后，我们将这两个结果相乘，求得瞬时变化率：\n$$\n\\frac{d}{dt}\\big(w^{\\top} n(t)\\big)\\bigg|_{t^{\\ast}} = (4.0 \\times 10^{-3} \\, \\text{mol L}^{-1}) \\times (2.0 \\times 10^{-14} \\, \\text{L} \\, \\text{s}^{-1})\n$$\n$$\n\\frac{d}{dt}\\big(w^{\\top} n(t)\\big)\\bigg|_{t^{\\ast}} = 8.0 \\times 10^{-17} \\, \\text{mol s}^{-1}\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\n8.0 \\times 10^{-17} \\, \\text{mol s}^{-1} = 8.00 \\times 10^{-17} \\, \\text{mol s}^{-1}\n$$",
            "answer": "$$\\boxed{8.00 \\times 10^{-17}}$$"
        }
    ]
}