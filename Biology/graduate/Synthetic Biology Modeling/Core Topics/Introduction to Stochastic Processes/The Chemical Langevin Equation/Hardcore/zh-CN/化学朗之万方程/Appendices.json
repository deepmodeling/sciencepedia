{
    "hands_on_practices": [
        {
            "introduction": "掌握化学朗之万方程 (Chemical Langevin Equation, CLE) 的第一步是理解它与我们熟悉的确定性化学动力学之间的联系。本练习旨在揭示 CLE 中的“漂移项”实际上就是宏观反应速率方程。通过这一练习，我们将学会如何利用漂移项来求解系统的稳态，从而在随机模型和确定性描述之间建立起一座桥梁。",
            "id": "1517651",
            "problem": "考虑一个细胞室内的简单生化反应网络，其中涉及单一分子种类 $X$。$X$ 分子以恒定速率产生，并遵循一级动力学降解。这两个反应是：\n1.  生成：$\\emptyset \\xrightarrow{k_1} X$\n2.  降解：$X \\xrightarrow{k_2} \\emptyset$\n\n生成反应以零级速率常数 $k_1$（单位为分子/单位时间）发生，反映了来自充足来源的恒定流入。降解反应是一个一级过程，速率常数为 $k_2$（单位为时间倒数）。\n\n物种 $X$ 的分子数 $n(t)$ 随时间的演化，可以用化学朗之万方程 (CLE) 来近似。CLE 的漂移项对应于描述分子平均数确定性变化的宏观速率方程。\n\n通过分析漂移项，确定当系统达到稳态时物种 $X$ 的平均分子数。请用 $k_1$ 和 $k_2$ 的解析表达式表示你的答案。",
            "solution": "我们考虑这两个反应的化学计量和倾向函数：\n- 生成反应：$\\emptyset \\to X$ 对 $n(t)$ 的化学计量变化为 $+1$，其零级倾向函数为 $a_{1}(n) = k_{1}$。\n- 降解反应：$X \\to \\emptyset$ 对 $n(t)$ 的化学计量变化为 $-1$，其一级倾向函数为 $a_{2}(n) = k_{2} n(t)$。\n\n化学朗之万方程的漂移项等于通过将化学计量变化乘以倾向函数并求和得到的确定性速率方程。因此，描述平均动力学的漂移（宏观）方程为\n$$\n\\frac{dn(t)}{dt} = (+1)\\,a_{1}(n) + (-1)\\,a_{2}(n) = k_{1} - k_{2}\\,n(t).\n$$\n在稳态时，平均分子数是恒定的，所以我们将时间导数设为零：\n$$\n0 = k_{1} - k_{2}\\,n_{\\text{ss}}.\n$$\n求解 $n_{\\text{ss}}$ 可得\n$$\nn_{\\text{ss}} = \\frac{k_{1}}{k_{2}}.\n$$\n这就是在稳态下 $X$ 的平均分子数。",
            "answer": "$$\\boxed{\\frac{k_{1}}{k_{2}}}$$"
        },
        {
            "introduction": "随机建模的一个核心特征是系统尺寸对噪声的影响。本练习将探讨如何正确地将描述离散分子数的 CLE 转换为描述连续浓度的形式。通过这个转换过程，我们将推导出系统体积 $\\Omega$ 是如何显式地出现在噪声项中的，从而量化“系统越小，噪声越大”这一基本原理。",
            "id": "1517670",
            "problem": "在随机化学动力学的研究中，化学朗之万方程（Chemical Langevin Equation, CLE）为离散随机模拟算法提供了一种连续近似。对于一个包含 $S$ 种化学物种、发生 $M$ 个反应的系统，其分子数的态矢量 $\\mathbf{N}(t) = (N_1(t), \\dots, N_S(t))$ 依照下式演化：\n\n$$dN_i(t) = \\sum_{j=1}^{M} \\nu_{ij} a_j(\\mathbf{N}(t)) dt + \\sum_{j=1}^{M} \\nu_{ij} \\sqrt{a_j(\\mathbf{N}(t))} dW_j(t)$$\n\n此处，$\\nu_{ij}$ 是因反应 $j$ 的单次事件而引起的物种 $i$ 的分子数变化，$a_j(\\mathbf{N})$ 是反应 $j$ 的倾向函数，$dW_j(t)$ 是独立的维纳过程增量。\n\n考虑一个在体积恒为 $\\Omega$ 的均匀混合系统内发生的简单二聚化反应：\n$$2X \\xrightarrow{k} Y$$\n其微观速率常数为 $k$。该反应的倾向函数由 $a(N_X) = \\frac{k}{2}N_X(N_X-1)$ 给出，其中 $N_X$ 是物种 $X$ 的分子数。对于本题，我们假设分子数很大，从而允许使用近似 $a(N_X) \\approx \\frac{k}{2}N_X^2$。\n\n在宏观化学动力学中，同一反应通过浓度来描述，我们将其记为 $x(t) = N_X(t)/\\Omega$。确定性速率方程为 $\\frac{dx}{dt} = -2k_c x^2$，其中 $k_c$ 是宏观速率常数。\n\n将分子数 $N_X(t)$ 的CLE转化为浓度 $x(t)$ 的方程，可以得到一个形式如下的新的朗之万方程：\n$$dx = f(x, k_c) dt + g(x, \\Omega, k_c) dW(t)$$\n其中 $dW(t)$ 是与该二聚化反应相关的单个维纳过程。\n\n确定描述浓度朗之万方程中噪声项的函数 $g(x, \\Omega, k_c)$。您的答案应为一个以 $x$, $\\Omega$ 和 $k_c$ 表示的表达式。",
            "solution": "我们考虑单个反应 $2X \\to Y$。在大分子数近似下，物种 $X$ 的化学计量变化为 $\\nu_{X}=-2$，倾向函数为 $a(N_{X}) \\approx \\frac{k}{2}N_{X}^{2}$。$N_{X}(t)$ 的化学朗之万方程 (CLE) 为\n$$\ndN_{X}(t) \\;=\\; \\nu_{X}\\,a(N_{X})\\,dt \\;+\\; \\nu_{X}\\,\\sqrt{a(N_{X})}\\,dW(t)\n\\;=\\; -2\\,a(N_{X})\\,dt \\;-\\;2\\,\\sqrt{a(N_{X})}\\,dW(t).\n$$\n定义浓度 $x(t)=N_{X}(t)/\\Omega$。由于 $x$ 是 $N_{X}$ 的线性函数，我们有\n$$\ndx \\;=\\; \\frac{1}{\\Omega}\\,dN_{X} \\;=\\; -\\frac{2}{\\Omega}\\,a(N_{X})\\,dt \\;-\\;\\frac{2}{\\Omega}\\,\\sqrt{a(N_{X})}\\,dW(t).\n$$\n使用 $N_{X}=\\Omega x$ 和 $a(N_{X}) \\approx \\frac{k}{2}(\\Omega x)^{2}=\\frac{k}{2}\\Omega^{2}x^{2}$，上式变为\n$$\ndx \\;=\\; -k\\,\\Omega\\,x^{2}\\,dt \\;-\\;2\\,x\\,\\sqrt{\\frac{k}{2}}\\,dW(t).\n$$\n为用宏观速率常数 $k_{c}$ 表示结果，我们将确定性漂移项与宏观速率方程 $\\frac{dx}{dt}=-2k_{c}x^{2}$ 进行匹配。从 $-k\\,\\Omega\\,x^{2}=-2k_{c}x^{2}$，我们得到\n$$\nk_{c} \\;=\\; \\frac{k\\,\\Omega}{2}, \\qquad \\text{所以} \\qquad \\frac{k}{2} \\;=\\; \\frac{k_{c}}{\\Omega}.\n$$\n将此式代入噪声系数可得\n$$\ng(x,\\Omega,k_{c}) \\;=\\; -2\\,x\\,\\sqrt{\\frac{k}{2}} \\;=\\; -2\\,x\\,\\sqrt{\\frac{k_{c}}{\\Omega}}.\n$$\n由于浓度 $x \\ge 0$，因此不需要绝对值。这就是浓度朗之万方程 $dx=f(x,k_{c})\\,dt+g(x,\\Omega,k_{c})\\,dW(t)$ 中的噪声振幅。",
            "answer": "$$\\boxed{-2\\,x\\,\\sqrt{\\frac{k_{c}}{\\Omega}}}$$"
        },
        {
            "introduction": "理论的最终目的是指导实践，对于 CLE 而言，这意味着通过数值模拟来探索系统行为。这个高级练习将我们带入计算领域，要求我们使用欧拉-丸山 (Euler-Maruyama) 法对 CLE 进行离散化。这不仅需要构建正确的差分方程，还需要分析其数值稳定性——这是任何计算建模者为确保模拟结果准确可靠所必须掌握的关键技能。",
            "id": "3934330",
            "problem": "考虑一个单物种合成生物学系统，其中物种 $X$ 的分子通过倾向为 $a_{\\mathrm{birth}}(x)=\\alpha$ 的零级生成反应产生，并通过倾向为 $a_{\\mathrm{death}}(x)=\\beta x$ 的一级消亡反应移除，其中 $\\alpha>0$ 且 $\\beta>0$。从反应通道表示法和从化学主方程（CME）导出化学朗之万方程（CLE）的扩散近似出发，并使用带有维纳过程（标准布朗运动）增量的 Itô 诠释，确定此 CLE 的正确单步 Euler–Maruyama (EM) 离散化方法。然后，通过分析确定性不动点附近的小涨落，给出在这种线性生成-消亡的情况下，EM 方法是均方稳定的时间步长 $\\Delta t$ 需满足的条件。选择一个同时正确给出 EM 更新和稳定性条件的选项。\n\nA. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$，当 $0 < \\Delta t < \\frac{2}{\\beta}$ 时均方稳定。\n\nB. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\big(\\sqrt{\\alpha}-\\sqrt{\\beta X_n}\\big)\\,\\Delta W_n$，当 $0 < \\Delta t < \\frac{1}{\\beta}$ 时均方稳定。\n\nC. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$，当 $0 < \\Delta t < \\frac{1}{2\\beta}$ 时均方稳定。\n\nD. $X_{n+1}=X_n+(\\alpha+\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$，当 $0 < \\Delta t < \\frac{2}{\\beta}$ 时均方稳定。\n\n此处 $\\Delta W_n$ 表示长度为 $\\Delta t$ 的区间上的维纳过程增量，服从分布 $\\Delta W_n\\sim N(0,\\Delta t)$。",
            "solution": "我们从第一性原理开始。对于充分混合的反应网络，化学主方程（CME）描述了分子数量的随机演化。在具有足够大分子数和光滑倾向的介观尺度下，扩散近似得到化学朗之万方程（CLE）。对于一个反应通道由 $j$ 索引、化学计量变化为 $\\nu_j$、倾向为 $a_j(x)$ 的系统，其一维 CLE 可写为\n$$\n\\mathrm{d}X(t)=\\sum_j \\nu_j a_j\\big(X(t)\\big)\\,\\mathrm{d}t+\\sum_j \\nu_j \\sqrt{a_j\\big(X(t)\\big)}\\,\\mathrm{d}W_j(t),\n$$\n其中 $\\mathrm{d}W_j(t)$ 是与每个反应通道相关联的独立维纳增量。\n\n在本例中，有两个通道：\n- 生成：$\\nu_{\\mathrm{birth}}=+1$, $a_{\\mathrm{birth}}(x)=\\alpha$。\n- 消亡：$\\nu_{\\mathrm{death}}=-1$, $a_{\\mathrm{death}}(x)=\\beta x$。\n\n因此，漂移项为\n$$\n\\sum_j \\nu_j a_j(x)=+1\\cdot \\alpha+(-1)\\cdot \\beta x=\\alpha-\\beta x.\n$$\n扩散项是独立高斯增量的和，其振幅由化学计量乘以倾向的平方根给出：\n$$\n\\sum_j \\nu_j \\sqrt{a_j(x)}\\,\\mathrm{d}W_j(t)=\\sqrt{\\alpha}\\,\\mathrm{d}W_{\\mathrm{birth}}(t)-\\sqrt{\\beta x}\\,\\mathrm{d}W_{\\mathrm{death}}(t).\n$$\n由于 $\\mathrm{d}W_{\\mathrm{birth}}(t)$ 和 $\\mathrm{d}W_{\\mathrm{death}}(t)$ 是独立的，在长度为 $\\Delta t$ 的时间步长内的净噪声增量的方差为\n$$\n\\mathrm{Var}\\big(\\sqrt{\\alpha}\\,\\Delta W_{\\mathrm{birth}}-\\sqrt{\\beta x}\\,\\Delta W_{\\mathrm{death}}\\big)=\\alpha\\,\\Delta t+\\beta x\\,\\Delta t=(\\alpha+\\beta x)\\,\\Delta t,\n$$\n因此可以等效地表示为单个维纳增量 $\\Delta\\widetilde{W}\\sim N(0,\\Delta t)$，其振幅为 $\\sqrt{\\alpha+\\beta x}$。因此，一维 CLE 可以写为\n$$\n\\mathrm{d}X(t)=\\big(\\alpha-\\beta X(t)\\big)\\,\\mathrm{d}t+\\sqrt{\\alpha+\\beta X(t)}\\,\\mathrm{d}\\widetilde{W}(t).\n$$\n\n对于一个 Itô 随机微分方程 $\\mathrm{d}X(t)=b\\big(X(t)\\big)\\,\\mathrm{d}t+G\\big(X(t)\\big)\\,\\mathrm{d}W(t)$，Euler–Maruyama (EM) 方法使用\n$$\nX_{n+1}=X_n+b(X_n)\\,\\Delta t+G(X_n)\\,\\Delta W_n,\n$$\n其中 $\\Delta W_n\\sim N(0,\\Delta t)$。将此应用于上面推导的 CLE，得到 EM 更新\n$$\nX_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n.\n$$\n\n我们现在评估确定性不动点附近的均方稳定性。确定性动力学为 $\\dot{x}=\\alpha-\\beta x$，它在\n$$\nx^\\star=\\frac{\\alpha}{\\beta}\n$$\n处有一个全局稳定不动点。\n定义涨落 $Y_n=X_n-x^\\star$。在 $x^\\star$ 附近对漂移项进行线性化，得到 $b(x^\\star+Y)\\approx \\alpha-\\beta(x^\\star+Y)=-\\beta Y$。在 $x^\\star$ 附近的扩散振幅为\n$$\nG(x^\\star+Y)=\\sqrt{\\alpha+\\beta(x^\\star+Y)}=\\sqrt{\\alpha+\\beta\\left(\\frac{\\alpha}{\\beta}+Y\\right)}=\\sqrt{2\\alpha+\\beta Y}.\n$$\n为了在小涨落范围内进行均方稳定性分析，我们用其常数主导项 $G(x^\\star)\\approx \\sqrt{2\\alpha}$ 来近似扩散振幅，得到加性噪声线性化模型\n$$\nY_{n+1}=(1-\\beta\\,\\Delta t)\\,Y_n+\\sqrt{2\\alpha}\\,\\Delta W_n.\n$$\n将 $\\Delta W_n$ 写为 $\\sqrt{\\Delta t}\\,\\xi_n$，其中 $\\xi_n\\sim N(0,1)$，二阶矩的演化如下\n$$\n\\mathbb{E}\\big[Y_{n+1}^2\\big]=(1-\\beta\\,\\Delta t)^2\\,\\mathbb{E}\\big[Y_n^2\\big]+2\\alpha\\,\\Delta t.\n$$\n这是一个 $\\mathbb{E}[Y_{n+1}^2]=\\rho\\,\\mathbb{E}[Y_n^2]+c$ 形式的线性递归，其中 $\\rho=(1-\\beta\\,\\Delta t)^2$ 且 $c=2\\alpha\\,\\Delta t>0$。为了使二阶矩序列保持有界并收敛到一个有限的极限，我们要求 $\\rho  1$，即\n$$\n(1-\\beta\\,\\Delta t)^2  1,\n$$\n对于 $\\Delta t0$，这简化为\n$$\n0  \\Delta t  \\frac{2}{\\beta}.\n$$\n这是应用于不动点附近的线性化生成-消亡 CLE 的 EM 方法的均方稳定性条件。这也是 Ornstein–Uhlenbeck (OU) 过程（此处定义为具有加性高斯噪声的线性漂移）的标准 EM 稳定区域。\n\n我们现在来评估各个选项：\n\nA. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$，当 $0  \\Delta t  \\frac{2}{\\beta}$。漂移项 $(\\alpha-\\beta X_n)$ 与反应通道的总和相匹配。有效的单噪声振幅 $\\sqrt{\\alpha+\\beta X_n}$ 通过匹配方差，正确地汇总了独立的生成和消亡噪声贡献。均方稳定性条件 $0  \\Delta t  \\frac{2}{\\beta}$ 正是线性化加性噪声模型的 $(1-\\beta\\,\\Delta t)^2  1$ 要求。结论：正确。\n\nB. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\big(\\sqrt{\\alpha}-\\sqrt{\\beta X_n}\\big)\\,\\Delta W_n$，当 $0  \\Delta t  \\frac{1}{\\beta}$。在一维情况下，用一个带有振幅的有符号差的单个维纳增量来表示两个独立的噪声源是不正确的：它强制了完全的反相关，并得出方差为 $(\\sqrt{\\alpha}-\\sqrt{\\beta X_n})^2\\,\\Delta t=\\alpha+\\beta X_n-2\\sqrt{\\alpha\\beta X_n}$，这不等于正确的 $\\alpha+\\beta X_n$。所述的稳定性界限 $0  \\Delta t  \\frac{1}{\\beta}$ 相对于 EM 均方稳定区域也过于严格。结论：不正确。\n\nC. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$，当 $0  \\Delta t  \\frac{1}{2\\beta}$。EM 更新是正确的，但均方稳定性界限过于严格；正确的条件是 $0  \\Delta t  \\frac{2}{\\beta}$。结论：不正确。\n\nD. $X_{n+1}=X_n+(\\alpha+\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$，当 $0  \\Delta t  \\frac{2}{\\beta}$。对于生成-消亡过程，漂移项 $(\\alpha+\\beta X_n)$ 是错误的；它将对应于生成和“负消亡”（或自催化产生），而不是倾向为 $\\beta X_n$ 的移除反应。尽管所述的稳定性区间与正确的线性化漂移的正确 EM 条件相匹配，但漂移项本身是不正确的，这使得该选项无效。结论：不正确。\n\n因此，正确选项是 A。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}