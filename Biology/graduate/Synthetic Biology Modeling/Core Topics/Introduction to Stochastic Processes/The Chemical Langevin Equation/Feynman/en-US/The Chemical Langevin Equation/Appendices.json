{
    "hands_on_practices": [
        {
            "introduction": "The Chemical Langevin Equation provides a powerful framework for understanding stochastic effects in biochemical systems. A crucial first step is to see how it relates to the deterministic models you may already be familiar with. This practice  focuses on the drift term of the CLE, which describes the average rate of change, and demonstrates how it can be used to find the system's macroscopic steady state.",
            "id": "1517651",
            "problem": "Consider a simple biochemical reaction network inside a cellular compartment, involving a single molecular species, $X$. The molecules of $X$ are produced at a constant rate, and they degrade following first-order kinetics. The two reactions are:\n1.  Production: $\\emptyset \\xrightarrow{k_1} X$\n2.  Degradation: $X \\xrightarrow{k_2} \\emptyset$\n\nThe production reaction occurs with a zero-order rate constant $k_1$ (with units of molecules per unit time), reflecting a constant influx from an abundant source. The degradation reaction is a first-order process with a rate constant $k_2$ (with units of inverse time).\n\nThe time evolution of the number of molecules of species $X$, denoted by $n(t)$, can be approximated by the Chemical Langevin Equation (CLE). The drift term of the CLE corresponds to the macroscopic rate equation describing the deterministic change in the mean number of molecules.\n\nBy analyzing the drift term, determine the mean number of molecules of species $X$ when the system reaches steady state. Express your answer as an analytic expression in terms of $k_1$ and $k_2$.",
            "solution": "We consider the two reactions with stoichiometries and propensities:\n- Production: $\\emptyset \\to X$ has stoichiometric change $+1$ for $n(t)$ and a zero-order propensity $a_{1}(n) = k_{1}$.\n- Degradation: $X \\to \\emptyset$ has stoichiometric change $-1$ for $n(t)$ and a first-order propensity $a_{2}(n) = k_{2} n(t)$.\n\nThe Chemical Langevin Equation has a drift term equal to the deterministic rate equation obtained by summing stoichiometric changes times propensities. Therefore, the drift (macroscopic) equation for the mean dynamics is\n$$\n\\frac{dn(t)}{dt} = (+1)\\,a_{1}(n) + (-1)\\,a_{2}(n) = k_{1} - k_{2}\\,n(t).\n$$\nAt steady state, the mean number of molecules is constant, so we set the time derivative to zero:\n$$\n0 = k_{1} - k_{2}\\,n_{\\text{ss}}.\n$$\nSolving for $n_{\\text{ss}}$ gives\n$$\nn_{\\text{ss}} = \\frac{k_{1}}{k_{2}}.\n$$\nThis is the mean number of molecules of $X$ at steady state.",
            "answer": "$$\\boxed{\\frac{k_{1}}{k_{2}}}$$"
        },
        {
            "introduction": "While deterministic models often work interchangeably with molecule numbers or concentrations, the stochastic nature of the CLE introduces important subtleties. This exercise  explores how the CLE is properly scaled when transitioning from a description based on discrete molecule counts to one based on continuous concentrations. Successfully solving it requires careful attention to how the noise term depends on the system volume, a key principle underpinning the transition from stochastic to deterministic regimes.",
            "id": "1517670",
            "problem": "In the study of stochastic chemical kinetics, the Chemical Langevin Equation (CLE) provides a continuous approximation to the discrete stochastic simulation algorithm. For a system with $S$ chemical species undergoing $M$ reactions, the state vector of molecule numbers $\\mathbf{N}(t) = (N_1(t), \\dots, N_S(t))$ evolves according to:\n\n$$dN_i(t) = \\sum_{j=1}^{M} \\nu_{ij} a_j(\\mathbf{N}(t)) dt + \\sum_{j=1}^{M} \\nu_{ij} \\sqrt{a_j(\\mathbf{N}(t))} dW_j(t)$$\n\nHere, $\\nu_{ij}$ is the change in the number of molecules of species $i$ due to one event of reaction $j$, $a_j(\\mathbf{N})$ is the propensity function of reaction $j$, and $dW_j(t)$ are independent Wiener process increments.\n\nConsider a simple dimerization reaction occurring in a well-mixed compartment of constant volume $\\Omega$:\n$$2X \\xrightarrow{k} Y$$\nThe microscopic rate constant is $k$. The propensity function for this reaction is given by $a(N_X) = \\frac{k}{2}N_X(N_X-1)$, where $N_X$ is the number of molecules of species $X$. For the purpose of this problem, assume the number of molecules is large, allowing for the approximation $a(N_X) \\approx \\frac{k}{2}N_X^2$.\n\nIn macroscopic chemical kinetics, the same reaction is described in terms of concentration, which we will denote by $x(t) = N_X(t)/\\Omega$. The deterministic rate equation is given by $\\frac{dx}{dt} = -2k_c x^2$, where $k_c$ is the macroscopic rate constant.\n\nBy converting the CLE for the number of molecules $N_X(t)$ into an equation for the concentration $x(t)$, you will obtain a new Langevin equation of the form:\n$$dx = f(x, k_c) dt + g(x, \\Omega, k_c) dW(t)$$\nwhere $dW(t)$ is the single Wiener process associated with the dimerization reaction.\n\nDetermine the function $g(x, \\Omega, k_c)$ that describes the noise term in the Langevin equation for the concentration. Your answer should be an expression in terms of $x$, $\\Omega$, and $k_c$.",
            "solution": "We consider the single reaction $2X \\to Y$ with stoichiometric change $\\nu_{X}=-2$ for species $X$ and propensity $a(N_{X}) \\approx \\frac{k}{2}N_{X}^{2}$ in the large-molecule-number approximation. The Chemical Langevin Equation (CLE) for $N_{X}(t)$ is\n$$\ndN_{X}(t) \\;=\\; \\nu_{X}\\,a(N_{X})\\,dt \\;+\\; \\nu_{X}\\,\\sqrt{a(N_{X})}\\,dW(t)\n\\;=\\; -2\\,a(N_{X})\\,dt \\;-\\;2\\,\\sqrt{a(N_{X})}\\,dW(t).\n$$\nDefine the concentration $x(t)=N_{X}(t)/\\Omega$. Since $x$ is a linear function of $N_{X}$, we have\n$$\ndx \\;=\\; \\frac{1}{\\Omega}\\,dN_{X} \\;=\\; -\\frac{2}{\\Omega}\\,a(N_{X})\\,dt \\;-\\;\\frac{2}{\\Omega}\\,\\sqrt{a(N_{X})}\\,dW(t).\n$$\nUsing $N_{X}=\\Omega x$ and $a(N_{X}) \\approx \\frac{k}{2}(\\Omega x)^{2}=\\frac{k}{2}\\Omega^{2}x^{2}$, this becomes\n$$\ndx \\;=\\; -k\\,\\Omega\\,x^{2}\\,dt \\;-\\;2\\,x\\,\\sqrt{\\frac{k}{2}}\\,dW(t).\n$$\nTo express the result in terms of the macroscopic rate constant $k_{c}$, match the deterministic drift with the macroscopic rate equation $\\frac{dx}{dt}=-2k_{c}x^{2}$. From $-k\\,\\Omega\\,x^{2}=-2k_{c}x^{2}$, we obtain\n$$\nk_{c} \\;=\\; \\frac{k\\,\\Omega}{2}, \\qquad \\text{so} \\qquad \\frac{k}{2} \\;=\\; \\frac{k_{c}}{\\Omega}.\n$$\nSubstituting this into the noise coefficient yields\n$$\ng(x,\\Omega,k_{c}) \\;=\\; -2\\,x\\,\\sqrt{\\frac{k}{2}} \\;=\\; -2\\,x\\,\\sqrt{\\frac{k_{c}}{\\Omega}}.\n$$\nSince $x \\ge 0$ for concentrations, no absolute value is required. This is the noise amplitude in the Langevin equation $dx=f(x,k_{c})\\,dt+g(x,\\Omega,k_{c})\\,dW(t)$ for the concentration.",
            "answer": "$$\\boxed{-2\\,x\\,\\sqrt{\\frac{k_{c}}{\\Omega}}}$$"
        },
        {
            "introduction": "The analytical power of the Chemical Langevin Equation is often complemented by numerical simulations to explore complex system dynamics. This practice  delves into the practicalities of simulating the CLE, starting with its discretization using the Euler-Maruyama method. Beyond just implementing the algorithm, you will analyze its numerical stability to understand the constraints on the simulation time step, a crucial consideration for ensuring a physically meaningful and accurate simulation.",
            "id": "3934330",
            "problem": "Consider a single-species synthetic biology system where molecules of species $X$ are produced by a zero-order birth reaction with propensity $a_{\\mathrm{birth}}(x)=\\alpha$ and removed by a first-order death reaction with propensity $a_{\\mathrm{death}}(x)=\\beta x$, with $\\alpha>0$ and $\\beta>0$. Starting from the reaction-channel representation and the diffusion approximation that leads from the Chemical Master Equation (CME) to the Chemical Langevin Equation (CLE), and using the Itô interpretation with increments of a Wiener process (standard Brownian motion), determine the correct one-step Euler–Maruyama (EM) discretization for this CLE. Then, by analyzing small fluctuations about the deterministic fixed point, state a condition on the time-step $\\Delta t$ under which the EM method is mean-square stable in this linear birth-death case. Choose the option that correctly gives both the EM update and the stability condition.\n\nA. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$, with mean-square stability when $0<\\Delta t<\\dfrac{2}{\\beta}$.\n\nB. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\big(\\sqrt{\\alpha}-\\sqrt{\\beta X_n}\\big)\\,\\Delta W_n$, with mean-square stability when $0<\\Delta t<\\dfrac{1}{\\beta}$.\n\nC. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$, with mean-square stability when $0<\\Delta t<\\dfrac{1}{2\\beta}$.\n\nD. $X_{n+1}=X_n+(\\alpha+\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$, with mean-square stability when $0<\\Delta t<\\dfrac{2}{\\beta}$.\n\nHere $\\Delta W_n$ denotes an increment of a Wiener process over the interval of length $\\Delta t$, distributed as $\\Delta W_n\\sim N(0,\\Delta t)$.",
            "solution": "We begin from first principles. For well-mixed reaction networks, the Chemical Master Equation (CME) describes the stochastic evolution of molecule counts. In the mesoscopic regime with sufficiently large counts and smooth propensities, the diffusion approximation yields the Chemical Langevin Equation (CLE). For a system with reaction channels indexed by $j$, stoichiometric changes $\\nu_j$, and propensities $a_j(x)$, the CLE in one dimension reads\n$$\n\\mathrm{d}X(t)=\\sum_j \\nu_j a_j\\big(X(t)\\big)\\,\\mathrm{d}t+\\sum_j \\nu_j \\sqrt{a_j\\big(X(t)\\big)}\\,\\mathrm{d}W_j(t),\n$$\nwhere $\\mathrm{d}W_j(t)$ are independent Wiener increments associated with each reaction channel.\n\nIn our case, there are two channels:\n- Birth: $\\nu_{\\mathrm{birth}}=+1$, $a_{\\mathrm{birth}}(x)=\\alpha$.\n- Death: $\\nu_{\\mathrm{death}}=-1$, $a_{\\mathrm{death}}(x)=\\beta x$.\n\nTherefore, the drift term is\n$$\n\\sum_j \\nu_j a_j(x)=+1\\cdot \\alpha+(-1)\\cdot \\beta x=\\alpha-\\beta x.\n$$\nThe diffusion term is the sum of independent Gaussian increments with amplitudes given by the stoichiometry times square roots of the propensities:\n$$\n\\sum_j \\nu_j \\sqrt{a_j(x)}\\,\\mathrm{d}W_j(t)=\\sqrt{\\alpha}\\,\\mathrm{d}W_{\\mathrm{birth}}(t)-\\sqrt{\\beta x}\\,\\mathrm{d}W_{\\mathrm{death}}(t).\n$$\nSince $\\mathrm{d}W_{\\mathrm{birth}}(t)$ and $\\mathrm{d}W_{\\mathrm{death}}(t)$ are independent, the net noise increment over a time-step of length $\\Delta t$ has variance\n$$\n\\mathrm{Var}\\big(\\sqrt{\\alpha}\\,\\Delta W_{\\mathrm{birth}}-\\sqrt{\\beta x}\\,\\Delta W_{\\mathrm{death}}\\big)=\\alpha\\,\\Delta t+\\beta x\\,\\Delta t=(\\alpha+\\beta x)\\,\\Delta t,\n$$\nand hence can be represented equivalently by a single Wiener increment $\\Delta\\widetilde{W}\\sim N(0,\\Delta t)$ with amplitude $\\sqrt{\\alpha+\\beta x}$. Thus, the one-dimensional CLE can be written as\n$$\n\\mathrm{d}X(t)=\\big(\\alpha-\\beta X(t)\\big)\\,\\mathrm{d}t+\\sqrt{\\alpha+\\beta X(t)}\\,\\mathrm{d}\\widetilde{W}(t).\n$$\n\nThe Euler–Maruyama (EM) method for an Itô stochastic differential equation $\\mathrm{d}X(t)=b\\big(X(t)\\big)\\,\\mathrm{d}t+G\\big(X(t)\\big)\\,\\mathrm{d}W(t)$ uses\n$$\nX_{n+1}=X_n+b(X_n)\\,\\Delta t+G(X_n)\\,\\Delta W_n,\n$$\nwith $\\Delta W_n\\sim N(0,\\Delta t)$. Applying this to the CLE derived above yields the EM update\n$$\nX_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n.\n$$\n\nWe now assess mean-square stability near the deterministic fixed point. The deterministic dynamics is $\\dot{x}=\\alpha-\\beta x$, which has a globally stable fixed point at\n$$\nx^\\star=\\frac{\\alpha}{\\beta}.\n$$\nDefine the fluctuation $Y_n=X_n-x^\\star$. Linearizing the drift about $x^\\star$ gives $b(x^\\star+Y)\\approx \\alpha-\\beta(x^\\star+Y)=-\\beta Y$. The diffusion amplitude near $x^\\star$ is\n$$\nG(x^\\star+Y)=\\sqrt{\\alpha+\\beta(x^\\star+Y)}=\\sqrt{\\alpha+\\beta\\left(\\frac{\\alpha}{\\beta}+Y\\right)}=\\sqrt{2\\alpha+\\beta Y}.\n$$\nFor mean-square stability analysis in the small-fluctuation regime, we approximate the diffusion amplitude by its constant leading term $G(x^\\star)\\approx \\sqrt{2\\alpha}$, yielding the additive-noise linearized model\n$$\nY_{n+1}=(1-\\beta\\,\\Delta t)\\,Y_n+\\sqrt{2\\alpha}\\,\\Delta W_n.\n$$\nWriting $\\Delta W_n=\\sqrt{\\Delta t}\\,\\xi_n$ with $\\xi_n\\sim N(0,1)$, the second moment evolves as\n$$\n\\mathbb{E}\\big[Y_{n+1}^2\\big]=(1-\\beta\\,\\Delta t)^2\\,\\mathbb{E}\\big[Y_n^2\\big]+2\\alpha\\,\\Delta t.\n$$\nThis is a linear recursion of the form $\\mathbb{E}[Y_{n+1}^2]=\\rho\\,\\mathbb{E}[Y_n^2]+c$, where $\\rho=(1-\\beta\\,\\Delta t)^2$ and $c=2\\alpha\\,\\Delta t>0$. For the sequence of second moments to remain bounded and approach a finite limit, we require $\\rho<1$, i.e.,\n$$\n(1-\\beta\\,\\Delta t)^2<1,\n$$\nwhich for $\\Delta t>0$ reduces to\n$$\n0<\\Delta t<\\frac{2}{\\beta}.\n$$\nThis is the mean-square stability condition for the EM method applied to the linearized birth-death CLE near the fixed point. It is also the standard EM stability region for the Ornstein–Uhlenbeck (OU) process (defined here as a linear drift with additive Gaussian noise).\n\nWe now evaluate the options:\n\nA. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$, with $0<\\Delta t<\\dfrac{2}{\\beta}$. The drift $(\\alpha-\\beta X_n)$ matches the reaction-channel sum. The effective single-noise amplitude $\\sqrt{\\alpha+\\beta X_n}$ correctly aggregates the independent birth and death noise contributions by matching the variance. The mean-square stability condition $0<\\Delta t<\\dfrac{2}{\\beta}$ is exactly the requirement $(1-\\beta\\,\\Delta t)^2<1$ for the linearized additive-noise model. Verdict: Correct.\n\nB. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\big(\\sqrt{\\alpha}-\\sqrt{\\beta X_n}\\big)\\,\\Delta W_n$, with $0<\\Delta t<\\dfrac{1}{\\beta}$. In one dimension, representing the two independent noise sources by a single Wiener increment with a signed difference of amplitudes is incorrect: it enforces perfect anticorrelation and yields variance $(\\sqrt{\\alpha}-\\sqrt{\\beta X_n})^2\\,\\Delta t=\\alpha+\\beta X_n-2\\sqrt{\\alpha\\beta X_n}$, which does not equal the correct $\\alpha+\\beta X_n$. The stated stability bound $0<\\Delta t<\\dfrac{1}{\\beta}$ is also too restrictive relative to the EM mean-square stability region. Verdict: Incorrect.\n\nC. $X_{n+1}=X_n+(\\alpha-\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$, with $0<\\Delta t<\\dfrac{1}{2\\beta}$. The EM update is correct, but the mean-square stability bound is overly restrictive; the correct condition is $0<\\Delta t<\\dfrac{2}{\\beta}$. Verdict: Incorrect.\n\nD. $X_{n+1}=X_n+(\\alpha+\\beta X_n)\\,\\Delta t+\\sqrt{\\alpha+\\beta X_n}\\,\\Delta W_n$, with $0<\\Delta t<\\dfrac{2}{\\beta}$. The drift $(\\alpha+\\beta X_n)$ is wrong for a birth-death process; it would correspond to birth and “negative death” (or autocatalytic production), not a removal reaction with propensity $\\beta X_n$. Even though the stated stability interval matches the correct EM condition for the proper linearized drift, the drift itself is incorrect, invalidating the option. Verdict: Incorrect.\n\nTherefore, the correct choice is A.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}