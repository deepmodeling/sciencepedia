{
    "hands_on_practices": [
        {
            "introduction": "对基因型-环境互作的理解始于一个能够量化其贡献的数学框架。本练习将引导您推导出表型方差分解的基本模型，这是定量遗传学中分析 G×E 互作的基石。通过这个过程，您将深入理解如何将总表型变异 ($V_P$) 剖分为遗传 ($V_G$)、环境 ($V_E$) 和它们之间互作 ($V_{G \\times E}$) 等多个组分，并认识到严谨的实验设计（如随机化）对于准确估计这些组分的重要性 。",
            "id": "2718943",
            "problem": "一位研究人员在一组受控环境中研究一个克隆组的反应范式，以量化表型值如何依赖于基因型和环境。对于每个克隆和环境，观察到的表型被建模为一个基线，加上遗传、环境和互作组分的贡献，以及测量噪声的总和。具体来说，对于一个随机抽样的个体，其表型表示为\n$$\nP \\;=\\; \\mu \\;+\\; G \\;+\\; E \\;+\\; I_{G\\times E} \\;+\\; I_{G\\times G} \\;+\\; \\epsilon,\n$$\n其中 $P$ 是表型，$\\mu$ 是一个恒定的基线，$G$ 是加性遗传贡献，$E$ 是标示已实现宏观环境的环境贡献，$I_{G\\times E}$ 是捕捉非平行反应范式的基因型-环境互作，$I_{G\\times G}$ 是上位性偏差（基因型-基因型互作），而 $\\epsilon$ 是残差测量噪声。假设 $G$、$E$、$I_{G\\times E}$、$I_{G\\times G}$ 和 $\\epsilon$ 是均值为 $0$ 的随机变量，并且通过在线性混合效应表示的反应范式中构建正交随机效应，使得 $I_{G\\times E}$、$I_{G\\times G}$ 和 $\\epsilon$ 与 $G$ 和 $E$ 不相关，但当基因型未在环境中随机分配时，$\\operatorname{Cov}(G,E)$ 可能非零。量 $V_G$、$V_E$、$V_{G\\times E}$、$V_{G\\times G}$ 和 $V_{\\epsilon}$ 分别表示 $G$、$E$、$I_{G\\times E}$、$I_{G\\times G}$ 和 $\\epsilon$ 的方差。\n\n你的任务是：\n- 仅从 $P$ 的组分求和表示以及方差恒等式 $\\operatorname{Var}(X+Y)=\\operatorname{Var}(X)+\\operatorname{Var}(Y)+2\\operatorname{Cov}(X,Y)$ 出发，推导表型方差 $V_P \\equiv \\operatorname{Var}(P)$ 的表达式，用 $V_G$、$V_E$、$V_{G\\times E}$、$V_{G\\times G}$、$V_{\\epsilon}$ 以及在给定假设下仍然存在的任何非零协方差项来表示。\n- 运用实验设计的基本原理，指出在反应范式的研究中，何时能够通过设计保证 $2\\operatorname{Cov}(G,E)$ 为 $0$。\n- 在一个将基因型完全随机分配到各个环境的同质园实验中（因此你所确定的相关设计条件成立），假设 $V_G = 2.4$，$V_E = 1.3$，$V_{G\\times E} = 0.8$，$V_{G\\times G} = 0.5$，以及 $V_{\\epsilon} = 0.6$。计算此设计的 $V_P$。将你的数值答案四舍五入到四位有效数字。最终结果以纯数字形式表示（无单位）。",
            "solution": "在尝试解答之前，对所述问题进行验证。\n\n已知条件如下：\n表型模型：$P \\;=\\; \\mu \\;+\\; G \\;+\\; E \\;+\\; I_{G\\times E} \\;+\\; I_{G\\times G} \\;+\\; \\epsilon$。\n组分定义：$\\mu$ 是一个恒定的基线；$G$ 是加性遗传贡献；$E$ 是环境贡献；$I_{G\\times E}$ 是基因型-环境互作；$I_{G\\times G}$ 是上位性偏差；$\\epsilon$ 是残差测量噪声。\n统计假设：$G$、$E$、$I_{G\\times E}$、$I_{G\\times G}$ 和 $\\epsilon$ 是均值为 $0$ 的随机变量。组分 $I_{G\\times E}$、$I_{G\\times G}$ 和 $\\epsilon$ 与 $G$ 和 $E$ 不相关。它们也被描述为正交随机效应，这意味着它们是相互不相关的。协方差 $\\operatorname{Cov}(G,E)$ 可能非零。\n方差定义：$V_P = \\operatorname{Var}(P)$，$V_G = \\operatorname{Var}(G)$，$V_E = \\operatorname{Var}(E)$，$V_{G\\times E} = \\operatorname{Var}(I_{G\\times E})$，$V_{G\\times G} = \\operatorname{Var}(I_{G\\times G})$，和 $V_{\\epsilon} = \\operatorname{Var}(\\epsilon)$。\n和的方差基本恒等式：$\\operatorname{Var}(X+Y)=\\operatorname{Var}(X)+\\operatorname{Var}(Y)+2\\operatorname{Cov}(X,Y)$。\n对于最终计算，提供了数值：在一个完全随机化的同质园实验条件下，$V_G = 2.4$，$V_E = 1.3$，$V_{G\\times E} = 0.8$，$V_{G\\times G} = 0.5$，以及 $V_{\\epsilon} = 0.6$。\n\n该问题在科学上基于数量遗传学和实验设计的原理。用于划分表型方差的线性模型是一个标准和基本概念。问题提法得当，为获得唯一解指定了所有必要的定义和条件。语言客观而精确。因此，该问题是有效的。我们可以继续进行解答。\n\n第一个任务是推导总表型方差 $V_P$ 的表达式。我们从表型 $P$ 的定义开始。\n$$\nP \\;=\\; \\mu \\;+\\; G \\;+\\; E \\;+\\; I_{G\\times E} \\;+\\; I_{G\\times G} \\;+\\; \\epsilon\n$$\n$P$ 的方差，记作 $V_P$，是 $\\operatorname{Var}(P)$。由于 $\\mu$ 是一个常数，其方差为 $0$，并且它不与任何随机变量协变。因此，它对 $V_P$ 没有贡献。\n$$\nV_P = \\operatorname{Var}(G \\;+\\; E \\;+\\; I_{G\\times E} \\;+\\; I_{G\\times G} \\;+\\; \\epsilon)\n$$\n多个随机变量之和的方差等于它们各自方差之和，加上所有唯一成对协方差之和的两倍。设随机组分为 $X_1 = G$，$X_2 = E$，$X_3 = I_{G\\times E}$，$X_4 = I_{G\\times G}$，和 $X_5 = \\epsilon$。通用公式为：\n$$\n\\operatorname{Var}\\left(\\sum_i X_i\\right) = \\sum_i \\operatorname{Var}(X_i) + 2 \\sum_{i<j} \\operatorname{Cov}(X_i, X_j)\n$$\n将此应用于我们的模型，我们得到：\n$$\nV_P = \\operatorname{Var}(G) + \\operatorname{Var}(E) + \\operatorname{Var}(I_{G\\times E}) + \\operatorname{Var}(I_{G\\times G}) + \\operatorname{Var}(\\epsilon) + 2\\sum_{\\text{pairs}} \\operatorname{Cov}\n$$\n根据定义，方差之和为 $V_G + V_E + V_{G\\times E} + V_{G\\times G} + V_{\\epsilon}$。现在，我们必须根据问题的假设来评估协方差项。\n明确指出，项 $\\operatorname{Cov}(G,E)$ 可能非零。\n问题陈述 $I_{G\\times E}$、$I_{G\\times G}$ 和 $\\epsilon$ 与 $G$ 和 $E$ 不相关。这意味着：\n$\\operatorname{Cov}(G, I_{G\\times E})=0$，$\\operatorname{Cov}(G, I_{G\\times G})=0$，$\\operatorname{Cov}(G, \\epsilon)=0$。\n$\\operatorname{Cov}(E, I_{G\\times E})=0$，$\\operatorname{Cov}(E, I_{G\\times G})=0$，$\\operatorname{Cov}(E, \\epsilon)=0$。\n此外，将这些项描述为“正交随机效应”意味着它们相互不相关。这意味着：\n$\\operatorname{Cov}(I_{G\\times E}, I_{G\\times G})=0$，$\\operatorname{Cov}(I_{G\\times E}, \\epsilon)=0$，$\\operatorname{Cov}(I_{G\\times G}, \\epsilon)=0$。\n因此，唯一不一定为零的协方差项是 $\\operatorname{Cov}(G,E)$。表型方差的完整表达式为：\n$$\nV_P = V_G + V_E + V_{G\\times E} + V_{G\\times G} + V_{\\epsilon} + 2\\operatorname{Cov}(G,E)\n$$\n\n第二个任务是确定保证 $2\\operatorname{Cov}(G,E)=0$ 的实验设计条件。项 $\\operatorname{Cov}(G,E)$ 是基因型-环境协方差。如果特定基因型与特定环境系统性地关联，则该项非零。例如，如果具有较高潜在产量（较高的 $G$）的基因型被优先放置在更肥沃的环境中（较高的 $E$），则 $\\operatorname{Cov}(G,E)$ 将为正。\n为确保 $\\operatorname{Cov}(G,E)=0$，必须消除任何此类系统性关联。实现这一目标的实验设计基本原则是**随机化**。在研究反应范式的背景下，这要求代表不同基因型（或克隆）的个体被随机分配到所有实验环境中。如果每种基因型在任何给定环境中被培育的概率均等，那么通过构建，遗传效应和环境效应在统计上是独立的，其协方差将为零。同质园实验，即在同一组环境中共同种植不同基因型，必须采用这样的随机化方案来消除这种协方差。\n\n第三个任务是数值计算。我们给定一个“将基因型完全随机分配到各个环境”的同质园实验。根据第二个任务的推理，这种设计确保了 $\\operatorname{Cov}(G,E) = 0$。因此，$V_P$ 的表达式简化为：\n$$\nV_P = V_G + V_E + V_{G\\times E} + V_{G\\times G} + V_{\\epsilon}\n$$\n我们获得了以下方差组分的数值：$V_G = 2.4$，$V_E = 1.3$，$V_{G\\times E} = 0.8$，$V_{G\\times G} = 0.5$，以及 $V_{\\epsilon} = 0.6$。将这些值代入简化后的方程，得到：\n$$\nV_P = 2.4 + 1.3 + 0.8 + 0.5 + 0.6\n$$\n执行求和：\n$$\nV_P = (2.4 + 1.3) + (0.8 + 0.5) + 0.6 = 3.7 + 1.3 + 0.6 = 5.0 + 0.6 = 5.6\n$$\n问题要求答案四舍五入到四位有效数字。计算值 $5.6$ 必须表示为 $5.600$。",
            "answer": "$$\\boxed{5.600}$$"
        },
        {
            "introduction": "在掌握了如何分解方差之后，下一步是理解反应范式本身是如何演化的。本练习将反应范式的截距 ($\\alpha$) 和斜率 ($\\beta$) 视作可遗传的量化性状，并运用多变量育种家方程来预测它们在选择作用下的逐代变化。通过推导，您将亲身体会选择梯度如何与性状的遗传变异和协变异（由 $\\mathbf{G}$ 矩阵描述）相结合，共同驱动表型可塑性的演化 。",
            "id": "2718891",
            "problem": "考虑在基因型-环境互作 (G×E) 下数量性状的线性反应范式，其中具有反应范式参数的个体所表达的表型由 $z(E)=\\alpha+\\beta E$ 给出，此处 $E$ 表示一个环境协变量。假设在选择期间所经历的环境服从分布 $E \\sim \\mathcal{N}(\\mu_{E},\\sigma_{E}^{2})$，且独立于基因型。假设在环境 $E$ 中，表达表型 $z$ 的个体的相对适合度为\n$$\nW(z,E)=\\exp\\!\\big((b_{0}+b_{1}E)\\,z\\big),\n$$\n其中 $b_{0}$ 和 $b_{1}$ 是参数化表型上对数线性、环境依赖性定向选择的常数。假设反应范式参数 $(\\alpha,\\beta)$ 遵循一个标准加性遗传模型，具有恒定的加性遗传（协）方差矩阵\n$$\n\\mathbf{G}=\\begin{pmatrix}G_{\\alpha\\alpha}&G_{\\alpha\\beta}\\\\G_{\\alpha\\beta}&G_{\\beta\\beta}\\end{pmatrix},\n$$\n且随机交配，在 $E$ 的分布中不存在基因型-环境协方差（即，环境分布在不同基因型间是相同的）。在种群平均反应范式水平上进行分析。\n\n应用将进化响应与加性遗传协方差和选择梯度联系起来的核心数量遗传学原理，并通过相对适合度对数的导数定义反应范式参数上的选择梯度，推导出单代变化 $\\Delta \\alpha$ 和 $\\Delta \\beta$ 的闭式解析表达式，该表达式应以 $G_{\\alpha\\alpha}$、$G_{\\alpha\\beta}$、$G_{\\beta\\beta}$、$\\mu_{E}$、$\\sigma_{E}^{2}$、$b_{0}$ 和 $b_{1}$ 表示。将最终答案表示为单个行向量 $\\big(\\Delta \\alpha,\\ \\Delta \\beta\\big)$。\n\n无需数值近似或四舍五入。您的最终答案必须是一个闭式表达式。",
            "solution": "问题陈述需经验证。\n\n步骤1：提取已知条件。\n- 表型 $z$ 是环境协变量 $E$ 的线性函数：$z(E)=\\alpha+\\beta E$。参数 $\\alpha$（截距）和 $\\beta$（斜率）定义了反应范式。\n- 环境协变量 $E$ 服从正态分布：$E \\sim \\mathcal{N}(\\mu_{E},\\sigma_{E}^{2})$。\n- 在环境 $E$ 中，表型为 $z$ 的个体的相对适合度 $W$ 由 $W(z,E)=\\exp\\big((b_{0}+b_{1}E)\\,z\\big)$ 给出，其中 $b_0$ 和 $b_1$ 是常数。\n- 反应范式参数 $(\\alpha, \\beta)$ 是可遗传性状，具有一个恒定的加性遗传协方差矩阵 $\\mathbf{G}$：\n$$\n\\mathbf{G}=\\begin{pmatrix}G_{\\alpha\\alpha}&G_{\\alpha\\beta}\\\\G_{\\alpha\\beta}&G_{\\beta\\beta}\\end{pmatrix}\n$$\n- 问题假设随机交配，并且在 $E$ 的分布中不存在基因型-环境协方差。\n- 任务是推导平均反应范式参数的单代变化，即 $\\Delta \\alpha$ 和 $\\Delta \\beta$。\n- 指定的方法是使用多变量育种家方程，其中反应范式参数上的选择梯度通过相对适合度对数的导数来定义。\n\n步骤2：验证已知条件。\n该问题具有科学依据，是关于反应范式进化的演化数量遗传学中的一个标准表述。所指定的表型、适合度和遗传结构模型是经典的，并广泛用于理论研究（例如，遵循 Lande 和 Arnold 的框架）。该问题是适定的，提供了推导唯一解析解所需的所有必要信息、参数和函数形式。术语是精确和客观的。没有矛盾、缺失数据或不科学的主张。\n\n结论：该问题有效。\n\n我们进行推导。多变量数量遗传学的基本方程描述了平均性状值向量 $\\Delta\\bar{\\mathbf{a}}$ 对选择的每代进化响应：\n$$\n\\Delta\\bar{\\mathbf{a}} = \\mathbf{G} \\boldsymbol{\\beta}_{s}\n$$\n在本问题中，性状是反应范式的参数 $\\alpha$ 和 $\\beta$。我们将性状向量定义为 $\\mathbf{a} = \\begin{pmatrix} \\alpha & \\beta \\end{pmatrix}^T$。因此，根据问题的符号表示，种群平均值的变化为 $\\Delta\\bar{\\mathbf{a}} = \\begin{pmatrix} \\Delta \\alpha & \\Delta \\beta \\end{pmatrix}^T$。矩阵 $\\mathbf{G}$ 是这些性状的加性遗传方差-协方差矩阵，如题目所给。向量 $\\boldsymbol{\\beta}_{s} = \\begin{pmatrix} \\beta_{\\alpha} & \\beta_{\\beta} \\end{pmatrix}^T$ 包含了对 $\\alpha$ 和 $\\beta$ 的选择梯度。\n\n问题陈述，选择梯度是通过相对适合度对数的导数定义的。这意味着一个性状上的选择梯度是，个体相对适合度对数关于该性状的偏导数，在所有环境变异来源上的期望值。首先，我们求相对适合度函数的对数，记为 $w(\\alpha, \\beta, E)$：\n$$\nw(\\alpha, \\beta, E) = \\ln\\Big( W(z(E), E) \\Big) = \\ln\\left( \\exp\\big( (b_{0}+b_{1}E)z(E) \\big) \\right) = (b_{0}+b_{1}E)z(E)\n$$\n代入表型表达式 $z(E) = \\alpha + \\beta E$：\n$$\nw(\\alpha, \\beta, E) = (b_{0}+b_{1}E)(\\alpha + \\beta E) = b_{0}\\alpha + b_{0}\\beta E + b_{1}\\alpha E + b_{1}\\beta E^{2}\n$$\n反应范式参数 $\\beta_{\\alpha}$ 和 $\\beta_{\\beta}$ 上的选择梯度是 $w$ 关于 $\\alpha$ 和 $\\beta$ 的偏导数的期望值。该期望是针对环境 $E$ 的分布计算的。\n\n首先，我们计算偏导数：\n$$\n\\frac{\\partial w}{\\partial \\alpha} = b_{0} + b_{1}E\n$$\n$$\n\\frac{\\partial w}{\\partial \\beta} = b_{0}E + b_{1}E^{2}\n$$\n接下来，我们计算这些表达式在分布 $E \\sim \\mathcal{N}(\\mu_{E},\\sigma_{E}^{2})$ 下的期望。\n\n截距 $\\alpha$ 上的选择梯度为：\n$$\n\\beta_{\\alpha} = \\mathbb{E}_{E}\\left[\\frac{\\partial w}{\\partial \\alpha}\\right] = \\mathbb{E}_{E}[b_{0} + b_{1}E]\n$$\n根据期望的线性性质：\n$$\n\\beta_{\\alpha} = b_{0} + b_{1}\\mathbb{E}_{E}[E]\n$$\n已知 $\\mathbb{E}_{E}[E] = \\mu_{E}$，我们得到：\n$$\n\\beta_{\\alpha} = b_{0} + b_{1}\\mu_{E}\n$$\n斜率 $\\beta$ 上的选择梯度为：\n$$\n\\beta_{\\beta} = \\mathbb{E}_{E}\\left[\\frac{\\partial w}{\\partial \\beta}\\right] = \\mathbb{E}_{E}[b_{0}E + b_{1}E^{2}]\n$$\n根据期望的线性性质：\n$$\n\\beta_{\\beta} = b_{0}\\mathbb{E}_{E}[E] + b_{1}\\mathbb{E}_{E}[E^{2}]\n$$\n我们知道 $\\mathbb{E}_{E}[E] = \\mu_{E}$。对于二阶矩 $\\mathbb{E}_{E}[E^{2}]$，我们使用恒等式 $\\text{Var}(E) = \\mathbb{E}[E^{2}] - (\\mathbb{E}[E])^{2}$。由此得出 $\\mathbb{E}[E^{2}] = \\text{Var}(E) + (\\mathbb{E}[E])^{2} = \\sigma_{E}^{2} + \\mu_{E}^{2}$。代入这些矩：\n$$\n\\beta_{\\beta} = b_{0}\\mu_{E} + b_{1}(\\sigma_{E}^{2} + \\mu_{E}^{2})\n$$\n现在我们可以组装选择梯度向量：\n$$\n\\boldsymbol{\\beta}_{s} = \\begin{pmatrix} \\beta_{\\alpha} \\\\ \\beta_{\\beta} \\end{pmatrix} = \\begin{pmatrix} b_{0} + b_{1}\\mu_{E} \\\\ b_{0}\\mu_{E} + b_{1}(\\sigma_{E}^{2} + \\mu_{E}^{2}) \\end{pmatrix}\n$$\n最后，我们通过将遗传协方差矩阵 $\\mathbf{G}$ 与选择梯度向量 $\\boldsymbol{\\beta}_{s}$ 相乘来计算进化响应向量 $\\begin{pmatrix} \\Delta \\alpha & \\Delta \\beta \\end{pmatrix}^T$：\n$$\n\\begin{pmatrix} \\Delta \\alpha \\\\ \\Delta \\beta \\end{pmatrix} = \\mathbf{G} \\boldsymbol{\\beta}_{s} = \\begin{pmatrix} G_{\\alpha\\alpha} & G_{\\alpha\\beta} \\\\ G_{\\alpha\\beta} & G_{\\beta\\beta} \\end{pmatrix} \\begin{pmatrix} b_{0} + b_{1}\\mu_{E} \\\\ b_{0}\\mu_{E} + b_{1}(\\sigma_{E}^{2} + \\mu_{E}^{2}) \\end{pmatrix}\n$$\n执行矩阵-向量乘法得到 $\\Delta \\alpha$ 和 $\\Delta \\beta$ 的各自表达式：\n$$\n\\Delta \\alpha = G_{\\alpha\\alpha}(b_{0} + b_{1}\\mu_{E}) + G_{\\alpha\\beta}\\big(b_{0}\\mu_{E} + b_{1}(\\sigma_{E}^{2} + \\mu_{E}^{2})\\big)\n$$\n$$\n\\Delta \\beta = G_{\\alpha\\beta}(b_{0} + b_{1}\\mu_{E}) + G_{\\beta\\beta}\\big(b_{0}\\mu_{E} + b_{1}(\\sigma_{E}^{2} + \\mu_{E}^{2})\\big)\n$$\n问题要求将最终答案表示为单个行向量 $(\\Delta \\alpha, \\Delta \\beta)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nG_{\\alpha\\alpha}(b_{0} + b_{1}\\mu_{E}) + G_{\\alpha\\beta}\\left(b_{0}\\mu_{E} + b_{1}(\\sigma_{E}^{2} + \\mu_{E}^{2})\\right)\n&\nG_{\\alpha\\beta}(b_{0} + b_{1}\\mu_{E}) + G_{\\beta\\beta}\\left(b_{0}\\mu_{E} + b_{1}(\\sigma_{E}^{2} + \\mu_{E}^{2})\\right)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}