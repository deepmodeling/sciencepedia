{
    "hands_on_practices": [
        {
            "introduction": "Understanding how plasticity evolves requires a formal framework for how selection acts on reaction norms. This foundational exercise () guides you through the derivation of the evolutionary response of a linear reaction norm, characterized by an intercept ($a$) and a slope ($b$). By applying the multivariate breeder's equation, you will see precisely how selection acting on a phenotype across a range of environments translates into direct and correlated evolutionary change in these underlying genetic parameters.",
            "id": "2717165",
            "problem": "A population expresses a linear reaction norm for a quantitative trait across an abiotic environment. Let the phenotype expressed in environment $E$ be $z(E) = a + b E$, where $a$ is the intercept (the phenotype at $E=0$) and $b$ is the slope (plasticity). The additive genetic values for $a$ and $b$ have means $\\bar{a}$ and $\\bar{b}$ and a genetic variance-covariance matrix $\\mathbf{G}$ with elements $G_{aa}$, $G_{ab}=G_{ba}$, and $G_{bb}$. Environments $E$ are encountered with probability density $p(E)$, which has finite moments. Relative fitness in environment $E$ depends on $z(E)$ through an unknown but smooth function; define the environment-specific directional selection gradient on the phenotype as $\\beta_{z}(E) = \\partial \\ln W(z,E)/\\partial z \\big|_{z=z(E)}$, where $W$ is relative fitness.\n\nUse the multivariate breeder’s equation (also known as the Lande equation), which states that the per-generation change in the mean vector of additive genetic traits equals the genetic variance-covariance matrix times the vector of directional selection gradients on those traits. Carefully apply the chain rule and the distribution of environments $p(E)$ to connect selection on $z(E)$ to selection on $a$ and $b$.\n\nWhich option correctly gives the per-generation responses $\\Delta \\bar{a}$ and $\\Delta \\bar{b}$ in terms of $\\mathbf{G}$, $p(E)$, and $\\beta_{z}(E)$ for the reaction norm defined above, and thereby specifies how selection on $z(E)$ induces correlated responses in $a$ and $b$ across the distribution of environments?\n\nA. $\\Delta \\begin{pmatrix}\\bar{a}\\\\ \\bar{b}\\end{pmatrix} = \\mathbf{G} \\begin{pmatrix}\\beta_{a}\\\\ \\beta_{b}\\end{pmatrix}$ with $\\beta_{a} = \\int \\beta_{z}(E)\\, p(E)\\, dE$ and $\\beta_{b} = \\int E\\, \\beta_{z}(E)\\, p(E)\\, dE$, so explicitly\n$\\Delta \\bar{a} = G_{aa}\\!\\int \\beta_{z}(E)p(E)dE + G_{ab}\\!\\int E\\,\\beta_{z}(E)p(E)dE$ and\n$\\Delta \\bar{b} = G_{ab}\\!\\int \\beta_{z}(E)p(E)dE + G_{bb}\\!\\int E\\,\\beta_{z}(E)p(E)dE$.\n\nB. $\\Delta \\begin{pmatrix}\\bar{a}\\\\ \\bar{b}\\end{pmatrix} = \\mathbf{P} \\begin{pmatrix}\\beta_{a}\\\\ \\beta_{b}\\end{pmatrix}$ with $\\beta_{a} = \\int \\beta_{z}(E)\\, p(E)\\, dE$ and $\\beta_{b} = \\int E\\, \\beta_{z}(E)\\, p(E)\\, dE$, where $\\mathbf{P}$ is the phenotypic variance-covariance matrix for $a$ and $b$.\n\nC. $\\Delta \\bar{a} = G_{aa} \\int \\beta_{z}(E)\\, p(E)\\, dE$ and $\\Delta \\bar{b} = G_{bb} \\int E\\, \\beta_{z}(E)\\, p(E)\\, dE$ (no off-diagonal terms), because selection acts separately on $a$ and $b$.\n\nD. $\\Delta \\begin{pmatrix}\\bar{a}\\\\ \\bar{b}\\end{pmatrix} = \\mathbf{G} \\begin{pmatrix}\\beta_{a}\\\\ \\beta_{b}\\end{pmatrix}$ with $\\beta_{a} = \\int \\beta_{z}(E)\\, p(E)\\, dE$ and $\\beta_{b} = \\int \\dfrac{\\partial \\beta_{z}(E)}{\\partial E}\\, p(E)\\, dE$, because the slope $b$ pertains to changes across $E$.\n\nSelect the single best option.",
            "solution": "We begin from core quantitative genetic principles and definitions and derive the response. The reaction norm is $z(E) = a + b E$, with additive genetic parameters $a$ and $b$. The genetic variance-covariance matrix is $\\mathbf{G} = \\begin{pmatrix}G_{aa} & G_{ab}\\\\ G_{ab} & G_{bb}\\end{pmatrix}$. The multivariate breeder’s equation (Lande equation) states\n$$\n\\Delta \\boldsymbol{\\bar{\\theta}} = \\mathbf{G}\\, \\boldsymbol{\\beta},\n$$\nwhere $\\boldsymbol{\\bar{\\theta}} = \\begin{pmatrix}\\bar{a}\\\\ \\bar{b}\\end{pmatrix}$ and $\\boldsymbol{\\beta} = \\begin{pmatrix}\\beta_{a}\\\\ \\beta_{b}\\end{pmatrix}$ is the vector of directional selection gradients on the genetic parameters $a$ and $b$. The directional selection gradient on a trait is defined as the partial derivative of mean relative fitness with respect to that trait’s mean, equivalently the covariance between relative fitness and the trait scaled by phenotypic variance under weak selection. Here, selection acts directly on $z(E)$ in each environment $E$, with environment-specific phenotypic selection gradient\n$$\n\\beta_{z}(E) \\equiv \\frac{\\partial \\ln W(z,E)}{\\partial z}\\Big|_{z=z(E)}.\n$$\nBecause each individual encounters environment $E$ according to $p(E)$, the overall selection gradient on the genetic parameters is the $p(E)$-weighted expectation of the environment-specific gradient times the sensitivity of the phenotype to those parameters (chain rule). The sensitivities are\n$$\n\\frac{\\partial z(E)}{\\partial a} = 1, \\quad \\frac{\\partial z(E)}{\\partial b} = E.\n$$\nTherefore,\n$$\n\\beta_{a} = \\int \\beta_{z}(E)\\, \\frac{\\partial z(E)}{\\partial a}\\, p(E)\\, dE = \\int \\beta_{z}(E)\\, p(E)\\, dE,\n$$\n$$\n\\beta_{b} = \\int \\beta_{z}(E)\\, \\frac{\\partial z(E)}{\\partial b}\\, p(E)\\, dE = \\int E\\, \\beta_{z}(E)\\, p(E)\\, dE.\n$$\nSubstituting into the multivariate breeder’s equation yields\n$$\n\\Delta \\bar{a} = G_{aa}\\, \\beta_{a} + G_{ab}\\, \\beta_{b}\n= G_{aa}\\!\\int \\beta_{z}(E)\\, p(E)\\, dE \\;+\\; G_{ab}\\!\\int E\\, \\beta_{z}(E)\\, p(E)\\, dE,\n$$\n$$\n\\Delta \\bar{b} = G_{ab}\\, \\beta_{a} + G_{bb}\\, \\beta_{b}\n= G_{ab}\\!\\int \\beta_{z}(E)\\, p(E)\\, dE \\;+\\; G_{bb}\\!\\int E\\, \\beta_{z}(E)\\, p(E)\\, dE.\n$$\nThese expressions show how selection on $z(E)$ over a distribution of environments induces direct and correlated responses in $a$ and $b$, mediated by both the weighting of environments via $p(E)$ and the genetic covariance $G_{ab}$. In particular, if $p(E)$ narrows around some $E^{\\ast}$ and $\\beta_{z}(E)$ varies smoothly, then $\\int E\\, \\beta_{z}(E)\\, p(E)\\, dE$ tends toward $E^{\\ast}\\int \\beta_{z}(E)\\, p(E)\\, dE$, reducing the component of selection that exclusively targets $b$ when measured around $E=0$. Under sustained novel $E^{\\ast}$, selection will primarily shift $\\bar{a}$, with correlated change in $\\bar{b}$ via $G_{ab}$; if the environment then stabilizes, $\\beta_{b}$ can approach $0$, favoring reduced plasticity (consistent with genetic assimilation), whereas during transient environmental heterogeneity, a nonzero $\\beta_{b}$ can favor adaptive plasticity (a route to the Baldwin effect).\n\nOption-by-option analysis:\n- Option A: This matches the derivation. It uses the multivariate breeder’s equation with the correct chain rule mapping from $\\beta_{z}(E)$ to $\\beta_{a}$ and $\\beta_{b}$ via $\\partial z/\\partial a = 1$ and $\\partial z/\\partial b = E$, and it includes the correlated response terms via $G_{ab}$. Verdict — Correct.\n- Option B: This incorrectly uses the phenotypic variance-covariance matrix $\\mathbf{P}$ in place of the genetic variance-covariance matrix $\\mathbf{G}$. The breeder’s equation requires additive genetic variances and covariances for evolutionary response. Verdict — Incorrect.\n- Option C: This drops the off-diagonal genetic covariance terms $G_{ab}$. Unless $G_{ab}=0$ by assumption, this fails to capture correlated responses and is not the general expression requested. Verdict — Incorrect.\n- Option D: This misidentifies $\\beta_{b}$. The selection gradient on $b$ comes from the sensitivity of $z(E)$ to $b$, which is $E$, not from $\\partial \\beta_{z}(E)/\\partial E$. Differentiating with respect to the environment confuses how selection acts on the phenotype with how the phenotype depends on the genetic parameter. Verdict — Incorrect.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "After establishing the general equations of change, we can apply them to a concrete scenario to quantify the dynamics of genetic assimilation. This practice () uses the classic liability–threshold model, where a continuous underlying trait determines the expression of a discrete phenotype. You will calculate the expected number of generations for a formerly-induced phenotype to become constitutively expressed, providing a tangible sense of how selection strength and genetic variance dictate the pace of evolutionary change.",
            "id": "2717232",
            "problem": "A population exhibits an inducible phenotype governed by a standard liability–threshold architecture. Let the latent liability be denoted by $L$, with $L \\sim \\mathcal{N}(\\mu_t, \\sigma^2)$ each generation $t$. In the absence of the inducer, the phenotype is expressed if and only if $L > T$, where $T$ is a fixed threshold. Initially (generation $t=0$), the uninduced expression frequency is $p_0 = 0.05$.\n\nSelection each generation occurs in the induced environment, where the inducer acts as a constant additive shift on the expressed trait (and thus does not alter its variance). Assume that selection in the induced environment produces a per-generation selection differential $S$ (on the induced phenotype scale) that is constant across generations. The additive genetic variance for the underlying liability (equivalently, for the breeding value that shifts $\\mu_t$) is $V_A$, also constant across generations. Assume the phenotypic variance of the liability is $V_P = \\sigma^2 = 1$ in both environments and remains constant through time.\n\nUse the Lande equation for multivariate quantitative genetics specialized to a single trait to model the evolutionary change in the mean liability, and the Gaussian liability–threshold model to connect $\\mu_t$ to expression probability in the uninduced environment. Take $S = 0.5$ and $V_A = 0.2$.\n\nCompute the expected number of generations required until the uninduced expression probability reaches $0.95$. Report your answer as a pure number rounded to four significant figures.",
            "solution": "We begin by formalizing the liability–threshold model that links the mean liability $\\mu_t$ to the expression probability in the uninduced environment. With $L \\sim \\mathcal{N}(\\mu_t, \\sigma^2)$ and threshold $T$, the uninduced expression probability at generation $t$ is\n$$\np_t = \\Pr(L > T) = 1 - \\Phi\\!\\left(\\frac{T - \\mu_t}{\\sigma}\\right),\n$$\nwhere $\\Phi$ is the cumulative distribution function of the standard normal distribution. With $\\sigma^2 = V_P = 1$, we have $\\sigma = 1$.\n\nFirst, infer the initial mean $\\mu_0$ from the initial expression probability $p_0 = 0.05$:\n$$\np_0 = 1 - \\Phi(T - \\mu_0) = 0.05 \\;\\;\\Longrightarrow\\;\\; \\Phi(T - \\mu_0) = 0.95.\n$$\nApplying the inverse cumulative distribution function $\\Phi^{-1}$ yields\n$$\nT - \\mu_0 = \\Phi^{-1}(0.95) \\equiv z_{0.95},\n$$\nso\n$$\n\\mu_0 = T - z_{0.95}.\n$$\nTo reach uninduced expression probability $p^\\star = 0.95$, we require\n$$\n0.95 = 1 - \\Phi(T - \\mu_\\star) \\;\\;\\Longrightarrow\\;\\; \\Phi(T - \\mu_\\star) = 0.05 \\;\\;\\Longrightarrow\\;\\; T - \\mu_\\star = \\Phi^{-1}(0.05).\n$$\nUsing the symmetry of the standard normal, $\\Phi^{-1}(0.05) = -\\Phi^{-1}(0.95) = -z_{0.95}$, hence\n$$\n\\mu_\\star = T + z_{0.95}.\n$$\nTherefore, the required change in the mean liability is\n$$\n\\Delta \\mu_{\\text{req}} = \\mu_\\star - \\mu_0 = \\left(T + z_{0.95}\\right) - \\left(T - z_{0.95}\\right) = 2 z_{0.95}.\n$$\n\nNext, we connect selection in the induced environment to the evolutionary response in $\\mu_t$. The Lande equation for a single trait gives\n$$\n\\Delta \\mu = G \\beta,\n$$\nwhere $G = V_A$ is the additive genetic variance for the liability and $\\beta$ is the directional selection gradient on that trait. The selection differential $S$ and the selection gradient $\\beta$ are related by $S = V_P \\beta$. Because $V_P = 1$, we have $S = \\beta$. Furthermore, the induced environment imposes only a constant additive shift to the trait, which does not affect the variance nor the selection gradient scale, so $S$ is on the same scale as the liability.\n\nHence the per-generation response in mean liability is\n$$\n\\Delta \\mu_{\\text{gen}} = V_A \\beta = V_A S.\n$$\nWith $V_A = 0.2$ and $S = 0.5$, we have\n$$\n\\Delta \\mu_{\\text{gen}} = 0.2 \\times 0.5 = 0.1.\n$$\n\nTherefore, the expected number of generations required is the total required shift divided by the per-generation shift:\n$$\nn = \\frac{\\Delta \\mu_{\\text{req}}}{\\Delta \\mu_{\\text{gen}}} = \\frac{2 z_{0.95}}{V_A S}.\n$$\nNumerically, $z_{0.95} = \\Phi^{-1}(0.95) \\approx 1.644853626951$; thus\n$$\n\\Delta \\mu_{\\text{req}} = 2 \\times 1.644853626951 \\approx 3.289707253902,\n$$\nand\n$$\nn \\approx \\frac{3.289707253902}{0.1} \\approx 32.89707253902.\n$$\nRounding to four significant figures gives\n$$\nn \\approx 32.90.\n$$",
            "answer": "$$\\boxed{32.90}$$"
        },
        {
            "introduction": "The ultimate test of understanding is often the ability to build a model from first principles. This final practice () challenges you to construct an individual-based simulation to explore the conditions that lead to genetic assimilation. By implementing the core components of evolution—genotype-phenotype mapping, fitness, and inheritance—you can directly observe how a population shifts from reliance on plasticity to genetic fixation and test how factors like the cost of plasticity mediate this pivotal evolutionary transition.",
            "id": "2717245",
            "problem": "Design and implement an individual-based Wright–Fisher simulation to test whether genetic assimilation emerges under varying costs of phenotypic plasticity, grounded in the definitions of natural selection, genotype–phenotype mapping, and stabilizing selection. Your program must implement the following model, rules, and detection criterion, and then run a specified test suite. The final output must be a single line containing a list of integers as specified at the end.\n\nFundamental base. Use the following widely accepted definitions and rules:\n- Natural selection is modeled as differential reproduction proportional to fitness, where fitness is a nonnegative function of the mismatch between phenotype and environment, and any intrinsic costs.\n- A genotype–phenotype mapping is a deterministic or stochastic function from genetic variables to trait values.\n- Under stabilizing selection around an optimum, the fitness of a phenotype is a decreasing function of squared deviation from the optimum.\n- A Wright–Fisher population evolves in discrete generations with non-overlapping generations and reproduction given by multinomial sampling proportional to fitness.\n\nModel specification:\n1) Genotype. Each individual $i$ carries a two-locus quantitative genotype $\\mathbf{g}_i(t) = (a_i(t), b_i(t))$, where $a_i(t)$ is a genetically encoded baseline (intercept) and $b_i(t)$ is a genetically encoded linear plasticity coefficient (slope).\n2) Developmental mapping. In generation $t$, the expressed phenotype of individual $i$ is\n$$\nz_i(t) = a_i(t) + b_i(t) \\, c_t,\n$$\nwhere $c_t$ is an environmental cue. There is no additional developmental noise.\n3) Environment. The environment has two phases:\n   - Phase I (pre-shift): For $t \\in \\{0,1,\\dots,T_{\\mathrm{shift}}-1\\}$, draw $c_t \\sim \\mathcal{N}(0,1)$ and set the fitness optimum $\\theta_t = c_t$.\n   - Phase II (post-shift): For $t \\in \\{T_{\\mathrm{shift}}, T_{\\mathrm{shift}}+1, \\dots, G-1\\}$, set $c_t = 0$ and fix the fitness optimum at $\\theta_t = \\theta^\\star$.\n4) Fitness. Let stabilizing selection around the optimum have Gaussian form with width parameter $\\omega > 0$ and impose a multiplicative cost of plasticity proportional to $b_i(t)^2$ with cost coefficient $k \\ge 0$:\n$$\nw_i(t) = \\exp\\!\\left( - \\frac{(z_i(t) - \\theta_t)^2}{2 \\, \\omega^2} \\right) \\cdot \\exp\\!\\left( - k \\, b_i(t)^2 \\right).\n$$\n5) Reproduction and mutation. Use the Wright–Fisher model with population size $N$. In each generation, sample $N$ parents with replacement with probabilities proportional to $w_i(t)$. Each offspring inherits the parent’s genotype with additive Gaussian mutation:\n$$\na_i(t+1) = a_{\\pi(i)}(t) + \\varepsilon_{a,i}(t), \\quad \\varepsilon_{a,i}(t) \\sim \\mathcal{N}(0,\\sigma_a^2), \\\\\nb_i(t+1) = b_{\\pi(i)}(t) + \\varepsilon_{b,i}(t), \\quad \\varepsilon_{b,i}(t) \\sim \\mathcal{N}(0,\\sigma_b^2),\n$$\nindependently across individuals and loci, where $\\pi(i)$ denotes the chosen parent index of offspring $i$. Constrain $b_i(t)$ to lie within a finite interval by truncation after mutation.\n6) Initialization. At $t=0$, initialize $a_i(0)$ and $b_i(0)$ independently as $\\mathcal{N}(0,\\sigma_{\\mathrm{init}}^2)$.\n\nDetection of genetic assimilation. Define genetic assimilation here as the loss of reliance on plasticity in a constant post-shift environment together with the genetic fixation of the required phenotype. Operationally, for a sliding window of $W$ consecutive generations in Phase II, declare assimilation at the earliest generation $t \\ge T_{\\mathrm{shift}} + W - 1$ such that both conditions simultaneously hold:\n- Small plasticity criterion: $\\lvert \\bar{b}(g) \\rvert \\le \\varepsilon_b$ for all generations $g \\in \\{t-W+1,\\dots,t\\}$, where $\\bar{b}(g)$ is the population mean of $b$ at generation $g$.\n- Genetic fixation criterion: $\\lvert \\bar{a}(g) - \\theta^\\star \\rvert \\le \\varepsilon_a$ for all $g \\in \\{t-W+1,\\dots,t\\}$, where $\\bar{a}(g)$ is the population mean of $a$.\nIf no such $t$ exists by $G-1$, report no assimilation.\n\nSimulation parameters to use:\n- Population size $N = 200$.\n- Total generations $G = 800$.\n- Environmental shift generation $T_{\\mathrm{shift}} = 400$.\n- Optimum after the shift $\\theta^\\star = 1.0$.\n- Stabilizing selection width $\\omega = 0.5$.\n- Mutation standard deviations $\\sigma_a = 0.02$ and $\\sigma_b = 0.02$.\n- Initialization standard deviation $\\sigma_{\\mathrm{init}} = 0.01$.\n- Plasticity truncation bounds $b_{\\min} = -5$ and $b_{\\max} = 5$ (apply by truncation after mutation each generation).\n- Assimilation window size $W = 10$.\n- Thresholds $\\varepsilon_b = 0.05$ and $\\varepsilon_a = 0.05$.\n- Randomness. Use a fixed seed $12345$ for all random processes so that results are replicable.\n\nNumerical details:\n- Use log-fitness to compute sampling probabilities stably by subtracting the maximum log-fitness before exponentiation.\n- If numerical underflow results in all-zero unnormalized weights, fall back to uniform sampling.\n\nTest suite. Run four independent cases differing only by the plasticity cost coefficient $k$:\n- Case $1$: $k = 0.0$.\n- Case $2$: $k = 0.001$.\n- Case $3$: $k = 0.01$.\n- Case $4$: $k = 0.05$.\n\nAnswer specification:\n- For each case, output a single integer: the earliest generation index $t$ at which the assimilation criterion is satisfied; if never satisfied, output $-1$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$).",
            "solution": "The solution implements an individual-based simulation to model the evolution of a quantitative trait under changing environmental conditions, as specified. The core of the algorithm is a discrete-time simulation of a population of size $N=200$ over $G$ non-overlapping generations, according to the Wright–Fisher model.\n\n**1. Model and State Representation**\nThe population at any generation $t$ consists of $N=200$ individuals. The genotype of each individual $i$ is represented by a pair of continuous values, $\\mathbf{g}_i(t) = (a_i(t), b_i(t))$, corresponding to a genetic baseline and a plasticity coefficient. These are stored in two numerical arrays, one for the set of all $a_i$ values and one for the $b_i$ values.\n\n**2. Simulation Initialization**\nAt the initial generation $t=0$, the genotypes are initialized by drawing values for $a_i(0)$ and $b_i(0)$ for all $i \\in \\{1, \\dots, N\\}$ from an independent and identical Gaussian distribution $\\mathcal{N}(0, \\sigma_{\\mathrm{init}}^2)$, where $\\sigma_{\\mathrm{init}}=0.01$. The plasticity coefficients $b_i(0)$ are then truncated to the interval $[b_{\\min}, b_{\\max}]$, which is $[-5, 5]$. A dedicated pseudo-random number generator is initialized with a fixed seed of $12345$ for each of the four test cases to ensure that the stochastic trajectories (environmental fluctuations, mutations) are identical, thereby isolating the effect of the plasticity cost coefficient $k$.\n\n**3. Generational Cycle**\nThe simulation proceeds iteratively for $t$ from $0$ to $G-1=799$. In each generation, the following sequence of events occurs:\n\n*   **Environment Definition**: The environmental cue $c_t$ and the phenotypic optimum $\\theta_t$ are determined.\n    *   In Phase I ($t < T_{\\mathrm{shift}}=400$), the environment is variable. $c_t$ is drawn from a standard normal distribution $\\mathcal{N}(0,1)$, and the optimum is set to match the cue, $\\theta_t = c_t$. This selective regime favors plasticity, as it allows individuals to track the fluctuating optimum.\n    *   In Phase II ($t \\ge T_{\\mathrm{shift}}=400$), the environment becomes constant. The cue is fixed at $c_t=0$, and the optimum is fixed at a new value $\\theta_t = \\theta^\\star = 1.0$.\n\n*   **Phenotype Expression**: The phenotype $z_i(t)$ of each individual is calculated from its genotype and the environmental cue via the linear developmental map:\n    $$\n    z_i(t) = a_i(t) + b_i(t) c_t\n    $$\n\n*   **Fitness Calculation**: The fitness $w_i(t)$ of each individual is computed based on how well its phenotype matches the optimum and the intrinsic cost of plasticity. The fitness function is given by the product of two exponential terms:\n    $$\n    w_i(t) = \\exp\\left( - \\frac{(z_i(t) - \\theta_t)^2}{2 \\omega^2} \\right) \\cdot \\exp\\left( - k b_i(t)^2 \\right)\n    $$\n    where $\\omega=0.5$ is the width of stabilizing selection and $k$ is the cost coefficient. To maintain numerical stability, calculations are performed using log-fitness. The log-fitness values are shifted by subtracting their maximum value before exponentiation to prevent floating-point underflow when calculating relative fitness weights for sampling. In the rare event that all computed fitness values are zero, uniform sampling is used as a fallback.\n\n*   **Reproduction**: The next generation is formed by sampling $N$ parents with replacement from the current generation. The probability of an individual $i$ being chosen as a parent is proportional to its fitness, $p_i \\propto w_i(t)$. This is the defining step of the Wright–Fisher model.\n\n*   **Inheritance and Mutation**: Each of the $N$ offspring inherits the genotype of its chosen parent. This genotype is then subjected to mutation. New genetic values $a_i(t+1)$ and $b_i(t+1)$ are generated by adding a small random perturbation drawn from a Gaussian distribution to the parental values:\n    $$\n    a_i(t+1) = a_{\\pi(i)}(t) + \\varepsilon_{a,i}(t), \\quad \\text{where } \\varepsilon_{a,i}(t) \\sim \\mathcal{N}(0, \\sigma_a^2) \\\\\n    b_i(t+1) = b_{\\pi(i)}(t) + \\varepsilon_{b,i}(t), \\quad \\text{where } \\varepsilon_{b,i}(t) \\sim \\mathcal{N}(0, \\sigma_b^2)\n    $$\n    with $\\sigma_a = \\sigma_b = 0.02$. Following mutation, the new plasticity coefficients $b_i(t+1)$ are truncated to ensure they remain within the interval $[-5, 5]$.\n\n**4. Detection of Genetic Assimilation**\nThe simulation checks for the occurrence of genetic assimilation during Phase II. The check begins at generation $t = T_{\\mathrm{shift}} + W - 1 = 409$, where $W=10$ is the window size. For each subsequent generation $t$ until $G-1$, the algorithm examines the population mean genotypes, $\\bar{a}(g)$ and $\\bar{b}(g)$, over the sliding window of the last $W$ generations (from $g=t-W+1$ to $g=t$). Assimilation is declared at the first generation $t$ where both of the following conditions are simultaneously met for all $g$ in the window:\n1.  **Small Plasticity Criterion**: The magnitude of the mean plasticity coefficient is small: $|\\bar{b}(g)| \\le \\varepsilon_b$, where $\\varepsilon_b = 0.05$.\n2.  **Genetic Fixation Criterion**: The mean baseline trait is close to the new optimum: $|\\bar{a}(g) - \\theta^\\star| \\le \\varepsilon_a$, where $\\varepsilon_a=0.05$ and $\\theta^\\star=1.0$.\n\nIf these conditions are met, the generation index $t$ is recorded as the time of assimilation, and the simulation for that value of $k$ is terminated. If the simulation completes all $G$ generations without the criteria being met, a value of $-1$ is recorded, indicating no assimilation occurred.\n\n**5. Execution over Test Suite**\nThe entire simulation is encapsulated within a function which is executed four times, once for each specified value of the plasticity cost $k \\in \\{0.0, 0.001, 0.01, 0.05\\}$. The results from these four runs are collected and formatted into the required output list.",
            "answer": "$$\\boxed{\\text{[-1,784,451,410]}}$$"
        }
    ]
}