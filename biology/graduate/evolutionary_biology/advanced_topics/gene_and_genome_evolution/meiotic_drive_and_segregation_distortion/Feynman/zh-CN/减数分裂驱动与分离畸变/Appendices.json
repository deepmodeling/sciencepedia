{
    "hands_on_practices": [
        {
            "introduction": "在群体中观察到非孟德尔遗传比例时，一个核心的挑战是区分其根本原因。这种偏离是由减数分裂驱动（合子形成前的事件）引起的，还是由不同基因型合子在发育过程中的差异生存能力（合子形成后的事件）造成的？这个练习将引导你设计一个决定性的实验，以明确区分这两种机制。掌握这种区分能力是遗传分析和理解进化动力的基本功。",
            "id": "2733643",
            "problem": "一个二倍体物种有一个单一的双等位基因座，其等位基因为 $S$ 和 $s$。根据孟德尔第一定律（分离定律），一个杂合子 $S/s$ 产生携带 $S$ 和携带 $s$ 的配子，比例为 $1\\!:\\!1$。在合子之间不存在生存力差异的情况下，一次 $S/s \\times s/s$ 的测交会产生比例为 $1\\!:\\!1$ 的 $S/s$ 和 $s/s$ 后代。你进行了一次 $S/s$ 雄性 $\\times$ $s/s$ 雌性的测交，并观察到 $N = 1000$ 个成年后代：$700$ 个为 $S/s$，$300$ 个为 $s/s$。这种偏离 $1\\!:\\!1$ 比例的现象可能源于配子发生过程中的减数分裂驱动（分离畸变），或者源于合子形成后不同基因型的生存力差异。设 $t$ 表示一个 $S/s$ 雄性在其功能性配子中传递等位基因 $S$ 的概率（因此孟德尔期望为 $t = 1/2$），并设 $w_{S/s}$ 和 $w_{s/s}$ 分别表示相应合子发育至成年的相对生存力（因此“无生存力选择”意味着 $w_{S/s} = w_{s/s}$）。在不直接揭示是哪种机制起作用的情况下，请选择一个选项，该选项能正确对比分离畸变与生存力选择的因果作用阶段，并给出一个科学合理且具有决定性的实验设计，以便在本次杂交中将 $t$ 从 $w_{S/s}$ 和 $w_{s/s}$ 中区分开来，同时包括对每种机制的预测。\n\nA. 分离畸变在配子产生过程中改变 $t$，而生存力选择在合子形成后改变 $w$。为了区分它们，从 $S/s$ 雄性 $\\times$ $s/s$ 雌性的杂交中收集一个有时间标记的受精卵同龄群，在发生显著死亡前的早期胚胎阶段（例如，受精后 $2$ 小时内）对随机样本进行基因分型，以估计胚胎中的传递比率，并将其与成年比率进行比较。预测：如果胚胎已经显示出 $S/s$:$s/s$ $\\approx 700\\!:\\!300$ （即 $t \\approx 0.7$）且成年比率与之匹配，则表明是分离畸变在起作用，且 $w_{S/s} \\approx w_{s/s}$；如果胚胎比率约为 $1\\!:\\!1$ 但成年比率为 $700\\!:\\!300$，则 $t \\approx 1/2$ 且 $w_{S/s} \\neq w_{s/s}$，表明存在生存力差异。\n\nB. 分离畸变仅限于雄性，在雌性中消失，而生存力选择是性别中性的。为了区分它们，用 $S/s$ 雌性 $\\times$ $s/s$ 雄性重复该杂交；如果比例为 $1\\!:\\!1$，则原始杂交中的偏差是分离畸变；如果比例仍为 $700\\!:\\!300$，则是生存力选择。\n\nC. 分离畸变对环境条件不敏感，而生存力选择对环境敏感。为了区分它们，在两种不同温度下重复 $S/s$ 雄性 $\\times$ $s/s$ 雌性的杂交。如果在不同温度下比例始终为 $700\\!:\\!300$，则原因是分离畸变；如果比例随温度变化，则原因是生存力选择。\n\nD. 分离畸变在受精时使合子基因型频率保持孟德尔比例，但会改变连锁关系，而生存力选择改变连锁关系，但不改变初始基因型频率。为了区分它们，估算成年后代中 $S$ 基因座附近的重组率；如果重组率偏离图谱预期，则原因是分离畸变；如果符合预期，则原因是生存力选择。",
            "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 物种：二倍体。\n- 基因座：单一、双等位基因座，等位基因为 $S$ 和 $s$。\n- 孟德尔期望（孟德尔第一定律）：一个 $S/s$ 杂合子产生 $S$ 和 $s$ 配子的比例为 $1\\!:\\!1$。\n- 进行的测交：$S/s$ 雄性 $\\times$ $s/s$ 雌性。\n- 观察到的成年后代：总共 $N = 1000$ 个，包括 $700$ 个 $S/s$ 个体和 $300$ 个 $s/s$ 个体。\n- 偏离 $1\\!:\\!1$ 比例的潜在原因：减数分裂驱动（分离畸变）或合子后生存力差异。\n- 参数 $t$：一个 $S/s$ 雄性在其功能性配子中传递等位基因 $S$ 的概率。孟德尔期望为 $t = 1/2$。\n- 参数 $w_{S/s}$, $w_{s/s}$：$S/s$ 和 $s/s$ 合子发育至成年的相对生存力。无生存力选择意味着 $w_{S/s} = w_{s/s}$。\n- 任务：选择一个选项，该选项能正确对比两种机制的因果作用阶段，并提出一个具有决定性的实验来区分它们。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题提出了一个进化遗传学中的经典情景。分离畸变（减数分裂驱动）和生存力差异是导致偏离预期孟德尔比率的基本且已确立的机制。参数 $t$ 和 $w$ 是群体遗传学模型中的标准参数。实验设置和观测数据在科学上是合理的。该问题是自洽、客观且表述清晰的，要求设计一个实验来区分两个相混淆的假说。没有科学或逻辑上的缺陷。\n\n**步骤3：结论与行动**\n问题陈述有效。有必要进行全面分析。\n\n**推导**\n\n让我们将分离和生存力对最终后代比例的贡献形式化。\n杂交组合为 $S/s$ 雄性 $\\times$ $s/s$ 雌性。\n$S/s$ 雄性产生含等位基因 $S$ 的配子的概率为 $t$，产生含等位基因 $s$ 的配子的概率为 $1-t$。\n$s/s$ 雌性只产生含等位基因 $s$ 的配子。\n\n受精后，合子基因型的形成频率如下：\n- $S/s$ 合子频率 = ($S$ 精子频率) $\\times$ ($s$ 卵细胞频率) = $t \\times 1 = t$。\n- $s/s$ 合子频率 = ($s$ 精子频率) $\\times$ ($s$ 卵细胞频率) = $(1-t) \\times 1 = 1-t$。\n\n这些合子之后必须存活到成年。它们的存活率由其相对生存力 $w_{S/s}$ 和 $w_{s/s}$ 加权。因此，成年后代的预期比率为：\n$$\n\\frac{\\text{Number of } S/s \\text{ adults}}{\\text{Number of } s/s \\text{ adults}} = \\frac{t \\cdot w_{S/s}}{(1-t) \\cdot w_{s/s}}\n$$\n观测数据显示这个比率为 $700 / 300 = 7/3$。因此，我们得到方程：\n$$\n\\frac{t \\cdot w_{S/s}}{(1-t) \\cdot w_{s/s}} = \\frac{7}{3}\n$$\n这一个方程有两个未知参数（或者更准确地说，是参数的比率）：由 $t$ 决定的分离比，和生存力比 $w_{S/s}/w_{s/s}$。我们无法仅通过一次对成年频率的观察就求解出这两个参数。有两个非互斥的假说可以解释这些数据：\n\n情况1：纯粹的分离畸变。\n此时，没有生存力差异，因此我们可以设定 $w_{S/s} = w_{s/s} = 1$。方程简化为：\n$$\n\\frac{t}{1-t} = \\frac{7}{3} \\implies 3t = 7(1-t) \\implies 10t = 7 \\implies t = 0.7\n$$\n在这种情况下，$S$ 等位基因被传递到 $70\\%$ 的功能性配子中。\n\n情况2：纯粹的生存力差异。\n此时，分离是严格遵循孟德尔定律的，所以 $t = 1/2$。方程变为：\n$$\n\\frac{(1/2) \\cdot w_{S/s}}{(1 - 1/2) \\cdot w_{s/s}} = \\frac{w_{S/s}}{w_{s/s}} = \\frac{7}{3}\n$$\n在这种情况下，$S/s$ 个体的生存力是 $s/s$ 个体的 $7/3 \\approx 2.33$ 倍。\n\n这两种机制的根本区别在于它们在生命周期中的作用点。分离畸变在*合子形成前*起作用，即在配子形成期间，它改变了配子库中等位基因的频率。生存力差异在*合子形成后*起作用，它改变了发育中生物体基因型的频率。因此，一个决定性的实验必须探查将这两个过程分开的生命阶段的群体状态。合子的形成就是这个关键点。\n\n**逐项分析**\n\nA. 该选项正确地指出了两种过程的因果作用阶段。所提出的实验——在受精后立即对个体进行基因分型——是将合子前效应与合子后效应区分开来的决定性方法。如果基因型比例在合子中（或在生存力选择能够起作用之前的极早期胚胎中）就已经倾斜，那么原因必定是合子前的，即分离畸变。如果合子比例是孟德尔式的（$1\\!:\\!1$）但成年比例是倾斜的，那么原因必定是合子后的，即生存力差异。其预测陈述得精确且正确。这个实验设计是合理且具有决定性的。结论：**正确**。\n\nB. 该选项基于一些并非普遍成立的概括性论断。首先，分离畸变不一定是雄性特有的；雌性中也存在减数分裂驱动。其次，生存力选择不一定是性别中性的；一个基因型的适合度效应可能因性别而异。因此，所提出的正反交不具有决定性。如果正反交产生 $1\\!:\\!1$ 的比例，这只能证明该效应特定于 $S/s$ 亲本为雄性时；这可能是雄性特有的驱动，*也可能*是父本来源对后代生存力的影响。如果正反交产生 $700\\!:\\!300$ 的比例，这可能是生存力选择，*也可能*是在两性中都发生的分离畸变。其前提有误，结论模棱两可。结论：**错误**。\n\nC. 这个前提在科学上是不成立的。许多减数分裂驱动系统的表达已知对环境因素（包括温度）敏感。反之，生存力差异可能在一系列环境中都表现得很稳定。一个显示比例随温度变化的实验结果，无法区分温度敏感的驱动和温度敏感的生存力。一个显示没有变化的结果，也无法区分对温度不敏感的驱动和对温度不敏感的生存力。该实验不具有决定性，因为其基本假设是错误的。结论：**错误**。\n\nD. 该选项对这两种现象的描述是荒谬的。根据其定义，分离畸变导致合子基因型频率非孟德尔式（$t \\neq 1/2$）。虽然一些驱动机制与抑制重组（改变连锁）的染色体重排（如倒位）有关，但这只是一种常见的关联，并非驱动本身的定义性特征。此外，生存力选择作用于基因型；它不改变在亲本减数分裂期间决定的重组率。整个前提是概念上的混淆。结论：**错误**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一旦确认了减数分裂驱动的存在，下一个关键问题便是它在群体中的演化命运。驱动等位基因虽然能获得传递优势，但往往会给携带它的个体带来生存或繁殖上的代价。这个练习深入探讨了这种“演化拔河”，要求你推导出一个核心的群体遗传学递推方程，用以预测驱动等位基因在驱动力与负选择压力共同作用下的频率变化。掌握这种建模能力是理解驱动系统长期演化动态的关键。",
            "id": "2733535",
            "problem": "考虑一个随机交配、无限大的二倍体种群，其世代不重叠且性别比相等。在单个基因座上，存在一个常染色体等位基因 $D$（一种减数分裂驱动子）和一个野生型等位基因 $d$。设当前群体中 $D$ 的等位基因频率为 $p$，并定义 $q = 1 - p$。假设：\n- 基因型生存力分别为 $w_{DD} = 1 - s$，$w_{Dd} = 1 - h s$ 以及 $w_{dd} = 1$，其中 $s \\in [0,1]$ 是与 $D$ 相关的生存力代价，$h \\in [0,1]$ 是显性参数。\n- 生存力选择发生在繁殖之前，且在两性中作用相同。\n- 选择之后，雌性的减数分裂是公平的（杂合子雌性以 $1/2$ 的概率传递 $D$），但杂合子雄性以 $t \\in [0,1]$ 的概率传递 $D$（减数分裂驱动），而 $DD$ 雄性以 $1$ 的概率传递 $D$，$dd$ 雄性以 $0$ 的概率传递 $D$。\n- 来自雄性和雌性的配子随机结合形成合子。\n\n从这些假设和选择前随机交配遵循的 Hardy–Weinberg 原理出发，推导下一代等位基因 $D$ 的频率 $p'$ 作为 $p, s, h, t$ 的函数的递归式。请将您的最终结果表示为 $p'$ 关于 $p, s, h, t$ 的单一闭式解析表达式。不需要数值近似，也不需要单位。不要提供不等式或方程组；请给出 $p'$ 的单个表达式。",
            "solution": "该问题是有效的，因为它基于既定原理，提出了一个数学群体遗传学中的良定问题。我们将遵循指定的离散生命周期来推导等位基因频率 $p'$ 的递归式。\n\n设当前世代合子中等位基因 $D$ 的频率为 $p$，等位基因 $d$ 的频率为 $q = 1-p$。在随机交配的假设下，合子种群的初始基因型频率遵循 Hardy-Weinberg 平衡比例：\n- $DD$ 合子的频率：$p^2$\n- $Dd$ 合子的频率：$2pq = 2p(1-p)$\n- $dd$ 合子的频率：$q^2 = (1-p)^2$\n\n接下来，发生生存力选择。各基因型的相对生存力为 $w_{DD} = 1-s$，$w_{Dd} = 1-hs$ 以及 $w_{dd} = 1$。选择后的基因型频率与其初始频率乘以各自的生存力成正比。为了找到成体种群中的真实频率，我们必须通过种群的平均适合度 $\\bar{w}$ 进行归一化。\n\n平均适合度 $\\bar{w}$ 是基因型频率按其适合度加权的总和：\n$$ \\bar{w} = p^2 w_{DD} + 2p(1-p) w_{Dd} + (1-p)^2 w_{dd} $$\n代入给定的适合度值：\n$$ \\bar{w} = p^2(1-s) + 2p(1-p)(1-hs) + (1-p)^2 $$\n\n选择作用后，成体种群中各基因型的频率为：\n- 成体 $DD$ 的频率：$f'_{DD} = \\frac{p^2(1-s)}{\\bar{w}}$\n- 成体 $Dd$ 的频率：$f'_{Dd} = \\frac{2p(1-p)(1-hs)}{\\bar{w}}$\n- 成体 $dd$ 的频率：$f'_{dd} = \\frac{(1-p)^2}{\\bar{w}}$\n\n这些性别比相等的成年个体现在产生配子。对于雄性和雌性，产生含有等位基因 $D$ 的配子的过程是不同的。\n\n在雌性产生的配子库中，等位基因 $D$ 的频率 $p'_f$ 是基于公平减数分裂（杂合子中的分离概率为 $1/2$）计算的：\n$$ p'_f = (1) \\cdot f'_{DD} + \\left(\\frac{1}{2}\\right) \\cdot f'_{Dd} + (0) \\cdot f'_{dd} $$\n$$ p'_f = \\frac{p^2(1-s)}{\\bar{w}} + \\frac{1}{2} \\cdot \\frac{2p(1-p)(1-hs)}{\\bar{w}} = \\frac{p^2(1-s) + p(1-p)(1-hs)}{\\bar{w}} $$\n\n在雄性产生的配子库中，等位基因 $D$ 的频率 $p'_m$ 的计算考虑了减数分裂驱动（杂合子中的分离概率为 $t$）：\n$$ p'_m = (1) \\cdot f'_{DD} + (t) \\cdot f'_{Dd} + (0) \\cdot f'_{dd} $$\n$$ p'_m = \\frac{p^2(1-s)}{\\bar{w}} + t \\cdot \\frac{2p(1-p)(1-hs)}{\\bar{w}} = \\frac{p^2(1-s) + 2tp(1-p)(1-hs)}{\\bar{w}} $$\n\n来自雄性和雌性的配子随机结合，形成下一代的合子。由于性别比相等，新一代合子中等位基因 $D$ 的频率 $p'$ 是雄性和雌性配子库中等位基因频率的平均值：\n$$ p' = \\frac{p'_f + p'_m}{2} $$\n代入 $p'_f$ 和 $p'_m$ 的表达式：\n$$ p' = \\frac{1}{2} \\left[ \\frac{p^2(1-s) + p(1-p)(1-hs)}{\\bar{w}} + \\frac{p^2(1-s) + 2tp(1-p)(1-hs)}{\\bar{w}} \\right] $$\n$$ p' = \\frac{1}{2\\bar{w}} \\left[ 2p^2(1-s) + p(1-p)(1-hs) + 2tp(1-p)(1-hs) \\right] $$\n我们可以对涉及杂合子的项进行因式分解：\n$$ p' = \\frac{1}{2\\bar{w}} \\left[ 2p^2(1-s) + p(1-p)(1-hs)(1+2t) \\right] $$\n现在，我们将平均适合度 $\\bar{w}$ 的完整表达式代入分母：\n$$ p' = \\frac{2p^2(1-s) + p(1-p)(1-hs)(1+2t)}{2 \\left[ p^2(1-s) + 2p(1-p)(1-hs) + (1-p)^2 \\right]} $$\n这就是下一代等位基因频率 $p'$ 作为 $p, s, h, t$ 的函数的完整的单一闭式解析表达式。我们可以从分子中提出因子 $p$，以稍微不同的形式呈现，尽管这不是必需的：\n$$ p' = \\frac{p \\left[ 2p(1-s) + (1-p)(1-hs)(1+2t) \\right]}{2 \\left[ p^2(1-s) + 2p(1-p)(1-hs) + (1-p)^2 \\right]} $$\n第一种形式已经足够，并且直接遵循了推导结构。它完全满足题目的要求。",
            "answer": "$$\\boxed{\\frac{2p^{2}(1-s) + p(1-p)(1-hs)(1+2t)}{2 \\left[ p^{2}(1-s) + 2p(1-p)(1-hs) + (1-p)^{2} \\right]}}$$"
        },
        {
            "introduction": "理论模型和实际数据之间存在着一道鸿沟，即统计检测的现实挑战。在实验中检测一个效应较弱的驱动系统尤其困难，因为生物学变异和随机抽样误差可能会掩盖真实的信号。本练习将理论付诸实践，要求你进行功效分析（power analysis）——这是现代实验设计的基石。你将模拟一位研究者的真实任务：确定需要多大的样本量才能以足够的统计置信度检测出驱动效应，同时还要考虑真实数据中常见的聚集效应（overdispersion）。",
            "id": "2733591",
            "problem": "您的任务是设计并实现一个程序，用以计算在存在因聚类（clustering）而导致的过度离散（overdispersion）时，检测减数分裂驱动（meiotic drive，即分离畸变）所需的最小总样本量。减数分裂驱动在此表现为对孟德尔 $1:1$ 传递的微小偏离。您的程序必须基于基本原理和标准渐近检验，其输出必须是为所提供的测试集汇总结果的单行文本。\n\n一个符合生物学现实的抽样方案如下。考虑 $F$ 个独立的、大小均为 $m$ 的家系（或窝），每个家系由一个杂合子产生，其对驱动等位基因的传递概率为 $p_f$。假设存在家系水平的异质性，使得 $p_f$ 在不同家系间变化，其平均传递概率为 $p = 0.5 + \\delta$，组内相关性（即过度离散）为 $\\rho \\in [0,1)$。在单个家系内，给定 $p_f$ 的条件下，驱动传递的次数服从二项分布。在所有家系间，通过对异质性进行边缘化，每个家系的驱动传递计数服从贝塔二项分布，其方差膨胀由组内相关性 $\\rho$ 所描述。总样本量为 $n = F m$。\n\n基本原理：\n- 在没有减数分裂驱动的情况下，杂合位点上的孟德尔式分离意味着传递概率相等，即 $p_0 = 0.5$。\n- 当使用贝塔二项分布对每个家系的过度离散进行建模时，单个家系计数 $X_i$ 的方差为\n$$\n\\mathrm{Var}(X_i) = m\\,p(1-p)\\left[1 + (m-1)\\rho\\right].\n$$\n- 对于 $F$ 个独立的家系，总计数 $X = \\sum_{i=1}^F X_i$ 得到样本比例 $\\hat{p} = X/n$。根据中心极限定理（CLT），在无驱动的零假设下，使用零假设方差的Wald型检验统计量近似服从标准正态分布。设设计效应为 $D = 1 + (m-1)\\rho$。在零假设 $p_0 = 0.5$ 下，标准误为\n$$\n\\sigma_0 = \\sqrt{\\frac{p_0(1-p_0) D}{n}}.\n$$\n- 使用显著性水平为 $\\alpha$ 的双边Wald检验，其统计量为\n$$\nZ = \\frac{\\hat{p} - p_0}{\\sigma_0}.\n$$\n当 $\\lvert Z \\rvert > z_{1-\\alpha/2}$ 时拒绝原假设，其中 $z_{1-\\alpha/2}$ 是标准正态分布的上 $(1-\\alpha/2)$ 分位数。\n- 在备择假设 $p = p_0 + \\delta$ 下，将 $Z$ 的分布近似为均值为\n$$\n\\mu = \\frac{\\delta}{\\sigma_0} = \\frac{\\delta}{\\sqrt{p_0(1-p_0) D / n}},\n$$\n且方差为1的正态分布（使用零假设下的标准化和微小偏离近似）。若 $\\Phi$ 表示标准正态分布的累积分布函数，则对于固定的 $n$，检验的功效为\n$$\n\\pi(n) = \\mathbb{P}\\left(\\lvert Z \\rvert > z_{1-\\alpha/2} \\,\\middle|\\, \\mu\\right)\n= 1 - \\Phi\\left(z_{1-\\alpha/2} - \\mu\\right) + \\Phi\\left(-z_{1-\\alpha/2} - \\mu\\right).\n$$\n\n您的任务：\n- 对每组指定的参数集，计算最小整数家系数量 $F$（并由此得出最小总样本量 $n = Fm$），使得功效 $\\pi(n)$ 至少达到目标功效 $\\pi^{\\star}$。假设过度离散参数 $\\rho$ 和聚类大小 $m$ 是已知且固定的。将 $\\delta$ 视为需要检测的、与 $0.5$ 的绝对微小偏离值。所有概率必须表示为小数（例如，使用 $0.8$ 而不是 $80\\%$）。\n- 检验是双边的。\n- 在零假设下使用 $p_0 = 0.5$ 进行标准化。\n- 搜索过程必须确保 $n$ 是 $m$ 的倍数。\n- 您的算法必须具有通用性，不应假定任何闭式反演。您必须使用上述正态近似公式计算 $\\pi(n)$，并搜索达到目标功效的最小 $n$。\n\n测试集：\n对每个元组 $(\\delta, \\rho, m, \\alpha, \\pi^{\\star})$，按要求计算最小的 $n$。将 $\\delta$ 表示为小数。\n\n1. $(\\delta, \\rho, m, \\alpha, \\pi^{\\star}) = (0.02, 0.0, 1, 0.05, 0.8)$\n2. $(\\delta, \\rho, m, \\alpha, \\pi^{\\star}) = (0.03, 0.05, 10, 0.05, 0.9)$\n3. $(\\delta, \\rho, m, \\alpha, \\pi^{\\star}) = (0.02, 0.1, 20, 0.01, 0.8)$\n4. $(\\delta, \\rho, m, \\alpha, \\pi^{\\star}) = (0.005, 0.02, 5, 0.05, 0.8)$\n5. $(\\delta, \\rho, m, \\alpha, \\pi^{\\star}) = (0.01, 0.2, 50, 0.05, 0.95)$\n6. $(\\delta, \\rho, m, \\alpha, \\pi^{\\star}) = (0.04, 0.3, 2, 0.05, 0.9)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的结果顺序与上述测试集相同。每个条目必须是该测试用例的最小整数 $n$（总样本量）。例如，格式必须与 $[n_1,n_2,n_3,n_4,n_5,n_6]$ 完全一致，不含任何额外文本和空格。",
            "solution": "该问题陈述已经过严格验证，被认为是有效的。它在科学上基于群体遗传学和生物统计学的原理，特别是关于在聚类抽样中检测减数分裂驱动的问题。该问题定义明确，提供了所有必要的参数和清晰的目标。不存在逻辑矛盾、不切实际的假设或含糊不清之处。因此，我们将着手提供一个完整的、有理有据的解决方案。\n\n目标是计算所需的最小总样本量 $n$，以在达到目标统计功效 $\\pi^{\\star}$ 的前提下，检测出与孟德尔分离的指定偏差 $\\delta$。抽样设计涉及 $F$ 个家系，每个家系的大小为 $m$，总样本量为 $n = F m$。该模型通过组内相关系数 $\\rho$ 来解释由家系水平异质性引起的过度离散。\n\n所使用的统计检验是针对传递概率 $p$ 的双边Wald检验。零假设 $H_0$ 对应于公平的孟德尔分离，其传递概率为 $p_0 = 0.5$。备择假设 $H_A$ 假定存在减数分裂驱动，其传递概率为 $p = p_0 + \\delta$。\n\n驱动等位基因的总数 $X = \\sum_{i=1}^F X_i$（其中 $X_i$ 是第 $i$ 个家系中的计数）用于构建样本比例 $\\hat{p} = X/n$。由于聚类效应，单个家系内计数的方差会膨胀。在零假设下，$X_i$ 的方差由下式给出：\n$$\n\\mathrm{Var}(X_i | H_0) = m p_0 (1-p_0) [1 + (m-1)\\rho]\n$$\n项 $D = 1 + (m-1)\\rho$ 是设计效应，它量化了由聚类引起的方差膨胀。对于 $F$ 个独立的家系，总计数 $X$ 的方差为 $F \\cdot \\mathrm{Var}(X_i | H_0)$，样本比例 $\\hat{p}$ 的方差为：\n$$\n\\mathrm{Var}(\\hat{p} | H_0) = \\frac{F \\cdot m p_0 (1-p_0) D}{(Fm)^2} = \\frac{p_0(1-p_0)D}{n}\n$$\n因此，在零假设下 $\\hat{p}$ 的标准误为：\n$$\n\\sigma_0 = \\sqrt{\\frac{p_0(1-p_0)D}{n}}\n$$\n根据中心极限定理，在 $H_0$ 下近似服从标准正态分布的Wald检验统计量是：\n$$\nZ = \\frac{\\hat{p} - p_0}{\\sigma_0}\n$$\n对于显著性水平为 $\\alpha$ 的双边检验，如果 $|Z| > z_{1-\\alpha/2}$，我们拒绝 $H_0$，其中 $z_{1-\\alpha/2}$ 是标准正态分布的上 $(1-\\alpha/2)$-分位数。\n\n为了计算统计功效，我们必须评估检验统计量 $Z$ 在备择假设 $H_A$ 下的分布。在 $H_A$ 下，样本比例的期望值为 $E[\\hat{p} | H_A] = p = p_0 + \\delta$。检验统计量 $Z$ 的期望值为：\n$$\n\\mu = E[Z | H_A] = \\frac{E[\\hat{p} | H_A] - p_0}{\\sigma_0} = \\frac{(p_0 + \\delta) - p_0}{\\sigma_0} = \\frac{\\delta}{\\sigma_0}\n$$\n代入 $\\sigma_0$ 的表达式，我们得到作为 $n$ 的函数的均值偏移：\n$$\n\\mu(n) = \\frac{\\delta}{\\sqrt{p_0(1-p_0)D/n}} = \\frac{\\delta \\sqrt{n}}{\\sqrt{p_0(1-p_0)D}}\n$$\n假设在 $H_A$ 下 $Z$ 的方差近似为 $1$（这是对于小 $\\delta$ 的标准简化），则在 $H_A$ 下 $Z$ 的分布近似为 $N(\\mu(n), 1)$。检验的功效 $\\pi(n)$ 是正确拒绝零假设的概率：\n$$\n\\pi(n) = \\mathbb{P}(|Z| > z_{1-\\alpha/2} | H_A) = \\mathbb{P}(Z > z_{1-\\alpha/2} | H_A) + \\mathbb{P}(Z  -z_{1-\\alpha/2} | H_A)\n$$\n令 $Z' \\sim N(0,1)$，我们可以将功效写为：\n$$\n\\pi(n) = \\mathbb{P}(Z' > z_{1-\\alpha/2} - \\mu(n)) + \\mathbb{P}(Z'  -z_{1-\\alpha/2} - \\mu(n))\n$$\n用标准正态累积分布函数 $\\Phi(\\cdot)$ 表示，则为：\n$$\n\\pi(n) = 1 - \\Phi(z_{1-\\alpha/2} - \\mu(n)) + \\Phi(-z_{1-\\alpha/2} - \\mu(n))\n$$\n问题要求找到最小的整数家系数量 $F$，使得总样本量 $n = F m$ 产生的功效 $\\pi(n)$ 至少达到目标功效 $\\pi^{\\star}$。由于 $\\mu(n)$ 是 $n$ 的单调递增函数，功效 $\\pi(n)$ 也随 $n$ 单调递增。这一性质使得我们可以通过直接的迭代搜索来找到所需的最小 $F$。\n\n算法如下：对于每个参数集 $(\\delta, \\rho, m, \\alpha, \\pi^{\\star})$：\n1.  初始化家系数量 $F = 1$。\n2.  计算常数参数：$p_0 = 0.5$，设计效应 $D = 1 + (m-1)\\rho$，以及标准正态临界值 $z_{1-\\alpha/2} = \\Phi^{-1}(1-\\alpha/2)$。\n3.  进入一个循环，直到满足功效条件：\n    a. 计算当前 $F$ 的总样本量：$n = F \\cdot m$。\n    b. 计算备择假设下的均值偏移：$\\mu(n) = \\frac{\\delta \\sqrt{n}}{\\sqrt{p_0(1-p_0)D}}$。\n    c. 使用上文推导的公式计算功效 $\\pi(n)$。\n    d. 如果 $\\pi(n) \\ge \\pi^{\\star}$，则所需的最小家系数量为当前值 $F$，最小总样本量为 $n$。循环终止。\n    e. 如果条件未满足，则增加家系数量 $F \\leftarrow F + 1$，并从步骤3a开始重复。\n\n此过程保证能找到满足功效要求的最小整数 $F$ 及相应的样本量 $n$。我们将实施此算法来计算所提供测试集的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes the minimum total sample size needed to detect meiotic drive\n    for a suite of test cases, accounting for overdispersion.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (delta, rho, m, alpha, pi_star)\n    test_cases = [\n        (0.02, 0.0, 1, 0.05, 0.8),\n        (0.03, 0.05, 10, 0.05, 0.9),\n        (0.02, 0.1, 20, 0.01, 0.8),\n        (0.005, 0.02, 5, 0.05, 0.8),\n        (0.01, 0.2, 50, 0.05, 0.95),\n        (0.04, 0.3, 2, 0.05, 0.9),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, rho, m, alpha, pi_star = case\n\n        # Parameters from the problem statement\n        p0 = 0.5\n\n        # Pre-calculate constant values for the current test case\n        # Design effect\n        D = 1 + (m - 1) * rho\n        # Two-sided critical value from the standard normal distribution\n        z_alpha = norm.ppf(1 - alpha / 2)\n        \n        # Iteratively search for the minimum number of families F\n        F = 1\n        while True:\n            # Total sample size n is a multiple of family size m\n            n = F * m\n\n            # Calculate the mean of the Z-statistic under the alternative hypothesis\n            denominator = np.sqrt(p0 * (1 - p0) * D / n)\n            mu = delta / denominator\n\n            # Calculate the statistical power using the normal approximation\n            # power = 1 - Phi(z_alpha - mu) + Phi(-z_alpha - mu)\n            power = 1 - norm.cdf(z_alpha - mu) + norm.cdf(-z_alpha - mu)\n\n            # Check if the calculated power meets the target power\n            if power >= pi_star:\n                results.append(n)\n                break\n            \n            # Increment the number of families and continue the search\n            F += 1\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}