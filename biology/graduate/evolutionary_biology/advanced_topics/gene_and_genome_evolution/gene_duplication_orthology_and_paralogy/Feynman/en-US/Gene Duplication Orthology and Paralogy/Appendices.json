{
    "hands_on_practices": [
        {
            "introduction": "The foundation of comparative genomics rests on correctly identifying homologous relationships between genes. While the Fitch definitions of orthology and paralogy are conceptually clear, inferring these relationships from sequence data presents significant challenges. This first exercise explores the widely used Best Reciprocal Hit (BRH) heuristic, a cornerstone of many early phylogenomic pipelines. By working through a hypothetical scenario, you will uncover a critical vulnerability of BRH, demonstrating how asymmetric rates of evolution can lead it to misidentify a more distant paralog as the closest ortholog, a phenomenon that underscores the need for more sophisticated, phylogeny-aware methods .",
            "id": "2715922",
            "problem": "You are given the following background facts as the foundation for reasoning. Orthologs are pairs of genes in different species whose last common ancestor is a speciation event (Fitch definition), whereas paralogs are pairs whose last common ancestor is a gene duplication event. Under homogeneous rates of sequence evolution, higher sequence similarity (e.g., higher bit-score or lower $E$-value) approximately reflects a shorter evolutionary path (fewer expected substitutions per site) between two sequences. The best reciprocal hit (BRH) heuristic between two species is widely used to identify putative orthologs using pairwise similarity searches.\n\nConsider an unknown researcher who claims that BRH always retrieves true orthologs when comparing two species, and that rate asymmetry cannot cause errors. You want to assess this claim by selecting the option that both (i) correctly defines the BRH heuristic and (ii) provides a specific, scientifically plausible counterexample in which rate asymmetry causes BRH to fail to retrieve the true orthologs.\n\nWhich option best satisfies both (i) and (ii)?\n\nA. BRH definition: For two species $S_1$ and $S_2$, genes $g \\in S_1$ and $h \\in S_2$ form a BRH pair if $h = \\arg\\max_{x \\in S_2} f(g,x)$ and $g = \\arg\\max_{y \\in S_1} f(y,h)$, where $f$ is a similarity score such as bit-score or the negative of the $E$-value. Counterexample: A single ancestral gene duplicates at time $t_d = 1.5$ (measured in the same time units as branch lengths), creating duplicates $X$ and $Y$. A speciation occurs later at time $t_s = 1.0$, yielding species $A$ and $B$. Species $A$ retains only $X$ (call it $a$). Species $B$ retains both $X$ (call it $b_X$) and $Y$ (call it $b_Y$). Substitution rates (per site per unit time) are as follows: along $A$’s $X$ lineage after speciation, $\\mu_{A,X} = 1.0$; along $B$’s $X$ lineage after speciation, $\\mu_{B,X} = 2.0$ (accelerated); along $B$’s $Y$ lineage after speciation, $\\mu_{B,Y} = 0.1$ (slow); along the ancestral pre-speciation branches from duplication to speciation, $\\mu_{\\text{anc}} = 0.5$. Under a Poisson model, the expected pairwise divergence between $a$ and $b_X$ (orthologs) is $d(a,b_X) = \\mu_{A,X} t_s + \\mu_{B,X} t_s = 1.0 \\cdot 1.0 + 2.0 \\cdot 1.0 = 3.0$. The expected divergence between $a$ and $b_Y$ (out-paralogs, last common ancestor at the duplication) is $d(a,b_Y) = \\mu_{A,X} t_s + \\mu_{B,Y} t_s + 2 \\mu_{\\text{anc}} (t_d - t_s) = 1.0 \\cdot 1.0 + 0.1 \\cdot 1.0 + 2 \\cdot 0.5 \\cdot (1.5 - 1.0) = 1.6$. Because $1.6 < 3.0$, $f(a,b_Y) > f(a,b_X)$, so the best hit of $a$ in $B$ is $b_Y$. In the reverse search from $B$ to $A$, both $b_X$ and $b_Y$ have their best hit in $A$ as $a$, but only $b_Y$ forms a reciprocal best hit with $a$. Thus BRH returns $(a,b_Y)$, which are out-paralogs, failing to retrieve the true ortholog $(a,b_X)$ due to rate asymmetry.\n\nB. BRH definition: The BRH pair between two species are the two genes with the highest overall similarity across both proteomes after removing lineage-specific paralogs. Counterexample: A gene duplicates in species $B$ after speciation at time $t_s = 1.0$, producing $b_1$ and $b_2$ with rates $\\mu_{B,1} = 2.0$ and $\\mu_{B,2} = 0.1$, while species $A$ has a single ortholog $a$ with $\\mu_{A} = 1.0$. Because $b_2$ is slow, the reciprocal best hits are $(a,b_2)$, which are paralogs rather than orthologs; hence BRH fails due to rate asymmetry.\n\nC. BRH definition: Two genes from different species are reciprocal best hits if they are each other’s highest-scoring local alignments under a fixed scoring scheme. Counterexample: A duplication before speciation yields $X$ in $A$ and $X$ and $Y$ in $B$, with equal post-speciation rates $\\mu_{A,X} = \\mu_{B,X} = \\mu_{B,Y} = 1.0$ and $\\mu_{\\text{anc}} = 0.5$, $t_d = 1.5$, $t_s = 1.0$. Orthologous divergence $d(a,b_X) = 2.0$, paralogous divergence $d(a,b_Y) = 3.0$. Because $d(a,b_X) < d(a,b_Y)$, the reciprocal best hits recover the orthologs, showing that BRH fails under rate asymmetry.\n\nD. BRH definition: In a three-species comparison, three genes are BRHs if they maximize a triangle inequality on pairwise similarities. Counterexample: Long-branch attraction during phylogenetic tree reconstruction makes the wrong leaves cluster, so BRH must also fail from the same artifact, regardless of rates or duplication times.",
            "solution": "The problem statement is subjected to validation.\n\n**1. Extraction of Givens:**\n- Definition of orthologs: Genes in different species whose last common ancestor is a speciation event.\n- Definition of paralogs: Genes whose last common ancestor is a gene duplication event.\n- Relationship between similarity and distance: Higher sequence similarity reflects a shorter evolutionary path (fewer expected substitutions).\n- Best Reciprocal Hit (BRH): A heuristic for identifying putative orthologs from pairwise similarity searches.\n- The problem posits a claim by a hypothetical researcher that BRH is infallible and immune to errors from rate asymmetry.\n- The task is to select an option that fulfills two criteria: (i) provides a correct definition of the BRH heuristic, and (ii) presents a scientifically sound counterexample where rate asymmetry causes BRH to fail in identifying true orthologs.\n\n**2. Validation:**\n- **Scientific Grounding:** The definitions of orthology and paralogy are the standard Fitch definitions used in molecular evolution. The inverse relationship between sequence similarity and evolutionary distance is a cornerstone of bioinformatics. The proposition that BRH can fail, particularly due to asymmetric evolutionary rates leading to misidentification of out-paralogs (a phenomenon sometimes called \"hidden paralogy\"), is a well-documented issue in computational biology. The problem is therefore scientifically sound.\n- **Well-Posedness:** The problem is well-posed. It requires the identification of an option that satisfies two clear and distinct criteria. The scenario to be evaluated—gene duplication, speciation, differential gene loss, and rate asymmetry—is the canonical model for studying this exact problem.\n- **Objectivity:** The problem is stated objectively and uses precise, standard terminology from the field of evolutionary biology.\n\n**3. Verdict:**\nThe problem statement is valid. It is scientifically rigorous, well-posed, and directly addresses a key conceptual challenge in orthology detection. We may proceed to the solution.\n\n**Solution Derivation:**\nThe task is to evaluate each option against two criteria: a correct definition of the Best Reciprocal Hit (BRH) heuristic and a valid counterexample illustrating its failure due to rate asymmetry. A valid counterexample must describe a scenario where, due to unequal rates of evolution following a gene duplication and speciation, the BRH pair consists of out-paralogs instead of the true orthologs.\n\nThe canonical scenario for this failure involves a gene duplication in a common ancestor, followed by speciation, and then differential gene loss and rate heterogeneity in the descendant lineages. Let there be an ancestral gene that duplicates at time $t_d$ into copies $X$ and $Y$. A speciation event occurs at a later time $t_s < t_d$, creating species $S_1$ and $S_2$. Suppose $S_1$ loses the copy derived from $Y$, retaining only gene $a$ (from $X$). Suppose $S_2$ retains both copies, $b_X$ (from $X$) and $b_Y$ (from $Y$).\n- The true orthologs are $(a, b_X)$, as their last common ancestor is the speciation event.\n- The genes $a$ and $b_Y$ are out-paralogs, as their last common ancestor is the duplication event.\n- Evolutionary distance, $d$, is the total number of expected substitutions along the path connecting two genes in the gene tree. $d \\propto \\sum (\\text{rate} \\times \\text{time})$.\n- Similarity, $f$, is inversely related to distance: if $d_1 < d_2$, then $f_1 > f_2$.\n- BRH fails if it identifies $(a, b_Y)$ as the orthologs. This occurs if $b_Y$ is the best hit for $a$ in $S_2$ (i.e., $f(a, b_Y) > f(a, b_X)$) and $a$ is the best hit for $b_Y$ in $S_1$ (which is trivially true if $a$ is the only gene). The condition simplifies to $d(a, b_Y) < d(a, b_X)$.\n\nThe distance between the orthologs $(a, b_X)$ is the sum of divergences along the two lineages from the speciation node:\n$$d(a, b_X) = \\mu_{1,X} t_s + \\mu_{2,X} t_s$$\nThe distance between the out-paralogs $(a, b_Y)$ is the sum of divergences along the path from $a$ to the duplication node and back down to $b_Y$:\n$$d(a, b_Y) = \\mu_{1,X} t_s + 2 \\mu_{\\text{anc}} (t_d - t_s) + \\mu_{2,Y} t_s$$\nwhere $\\mu_{i,G}$ is the rate for gene $G$ in species $i$ post-speciation and $\\mu_{\\text{anc}}$ is the rate on the ancestral branches between duplication and speciation. BRH fails if a high rate for the true ortholog (e.g., large $\\mu_{2,X}$) and a low rate for the out-paralog (e.g., small $\\mu_{2,Y}$) cause $d(a, b_Y) < d(a, b_X)$.\n\n**Evaluation of Options:**\n\n**A. BRH definition: For two species $S_1$ and $S_2$, genes $g \\in S_1$ and $h \\in S_2$ form a BRH pair if $h = \\arg\\max_{x \\in S_2} f(g,x)$ and $g = \\arg\\max_{y \\in S_1} f(y,h)$, where $f$ is a similarity score such as bit-score or the negative of the $E$-value. Counterexample: A single ancestral gene duplicates at time $t_d = 1.5$ (measured in the same time units as branch lengths), creating duplicates $X$ and $Y$. A speciation occurs later at time $t_s = 1.0$, yielding species $A$ and $B$. Species $A$ retains only $X$ (call it $a$). Species $B$ retains both $X$ (call it $b_X$) and $Y$ (call it $b_Y$). Substitution rates (per site per unit time) are as follows: along $A$’s $X$ lineage after speciation, $\\mu_{A,X} = 1.0$; along $B$’s $X$ lineage after speciation, $\\mu_{B,X} = 2.0$ (accelerated); along $B$’s $Y$ lineage after speciation, $\\mu_{B,Y} = 0.1$ (slow); along the ancestral pre-speciation branches from duplication to speciation, $\\mu_{\\text{anc}} = 0.5$. Under a Poisson model, the expected pairwise divergence between $a$ and $b_X$ (orthologs) is $d(a,b_X) = \\mu_{A,X} t_s + \\mu_{B,X} t_s = 1.0 \\cdot 1.0 + 2.0 \\cdot 1.0 = 3.0$. The expected divergence between $a$ and $b_Y$ (out-paralogs, last common ancestor at the duplication) is $d(a,b_Y) = \\mu_{A,X} t_s + \\mu_{B,Y} t_s + 2 \\mu_{\\text{anc}} (t_d - t_s) = 1.0 \\cdot 1.0 + 0.1 \\cdot 1.0 + 2 \\cdot 0.5 \\cdot (1.5 - 1.0) = 1.6$. Because $1.6 < 3.0$, $f(a,b_Y) > f(a,b_X)$, so the best hit of $a$ in $B$ is $b_Y$. In the reverse search from $B$ to $A$, both $b_X$ and $b_Y$ have their best hit in $A$ as $a$, but only $b_Y$ forms a reciprocal best hit with $a$. Thus BRH returns $(a,b_Y)$, which are out-paralogs, failing to retrieve the true ortholog $(a,b_X)$ due to rate asymmetry.**\n\n- **Analysis of Definition:** The definition provided, $h = \\arg\\max_{x \\in S_2} f(g,x)$ and $g = \\arg\\max_{y \\in S_1} f(y,h)$, is the precise, formal definition of the Best Reciprocal Hit heuristic. It is correct.\n- **Analysis of Counterexample:** The scenario matches the canonical model for BRH failure. The true orthologs are $(a, b_X)$ and the out-paralogs are $(a, b_Y)$. The calculation of the evolutionary distances is performed correctly based on the provided parameters.\n  - Ortholog distance: $d(a, b_X) = \\mu_{A,X} t_s + \\mu_{B,X} t_s = (1.0 \\times 1.0) + (2.0 \\times 1.0) = 3.0$.\n  - Out-paralog distance: $d(a, b_Y) = \\mu_{A,X} t_s + \\mu_{B,Y} t_s + 2\\mu_{\\text{anc}}(t_d - t_s) = (1.0 \\times 1.0) + (0.1 \\times 1.0) + 2(0.5)(1.5 - 1.0) = 1.0 + 0.1 + 1.0(0.5) = 1.6$.\nThe calculations are correct. Since $d(a, b_Y) = 1.6 < d(a, b_X) = 3.0$, the similarity $f(a, b_Y)$ will be greater than $f(a, b_X)$. Thus, the best hit of $a$ in species $B$ is the out-paralog $b_Y$. The reverse search from any gene in $B$ to the single-gene proteome of $A$ will always return $a$ as the best hit. Therefore, $(a, b_Y)$ forms a BRH pair. This is a false positive for orthology. The failure is directly caused by rate asymmetry: the ortholog $b_X$ evolved fast ($\\mu_{B,X} = 2.0$) while the paralog $b_Y$ evolved slow ($\\mu_{B,Y} = 0.1$), making the paralog appear more closely related. The counterexample is specific, scientifically plausible, and mathematically sound.\n- **Verdict:** Correct.\n\n**B. BRH definition: The BRH pair between two species are the two genes with the highest overall similarity across both proteomes after removing lineage-specific paralogs. Counterexample: A gene duplicates in species $B$ after speciation at time $t_s = 1.0$, producing $b_1$ and $b_2$ with rates $\\mu_{B,1} = 2.0$ and $\\mu_{B,2} = 0.1$, while species $A$ has a single ortholog $a$ with $\\mu_{A} = 1.0$. Because $b_2$ is slow, the reciprocal best hits are $(a,b_2)$, which are paralogs rather than orthologs; hence BRH fails due to rate asymmetry.**\n\n- **Analysis of Definition:** This definition is incorrect and muddled. BRH identifies multiple pairs, not \"the\" pair with \"highest overall similarity\". The instruction to remove paralogs *before* the search is circular reasoning, as distinguishing orthologs from paralogs is the goal.\n- **Analysis of Counterexample:** The scenario describes a post-speciation duplication. Gene $a$ in species $A$ is co-orthologous to both $b_1$ and $b_2$ in species $B$; the genes $b_1$ and $b_2$ are in-paralogs. The statement that $(a, b_2)$ are \"paralogs rather than orthologs\" is a fundamental error. Their last common ancestor is the speciation node, so they are, by definition, orthologs. BRH correctly identifies an orthologous relationship, $(a, b_2)$. The issue here is the one-to-many orthology that BRH cannot fully capture, not a failure to distinguish orthologs from paralogs.\n- **Verdict:** Incorrect.\n\n**C. BRH definition: Two genes from different species are reciprocal best hits if they are each other’s highest-scoring local alignments under a fixed scoring scheme. Counterexample: A duplication before speciation yields $X$ in $A$ and $X$ and $Y$ in $B$, with equal post-speciation rates $\\mu_{A,X} = \\mu_{B,X} = \\mu_{B,Y} = 1.0$ and $\\mu_{\\text{anc}} = 0.5$, $t_d = 1.5$, $t_s = 1.0$. Orthologous divergence $d(a,b_X) = 2.0$, paralogous divergence $d(a,b_Y) = 3.0$. Because $d(a,b_X) < d(a,b_Y)$, the reciprocal best hits recover the orthologs, showing that BRH fails under rate asymmetry.**\n\n- **Analysis of Definition:** This definition is informal but acceptable, as it captures the essence of the BRH procedure using BLAST or similar tools.\n- **Analysis of Counterexample:** This example explicitly uses *equal* post-speciation rates, not rate asymmetry. It therefore fails to address a key requirement of the problem. Moreover, its logic is self-contradictory. It calculates (with an error, the correct $d(a,b_Y)$ is $2.5$) that the orthologs are more similar ($d(a,b_X) < d(a,b_Y)$) and states that BRH correctly recovers them, but then concludes this \"showing that BRH fails\". The reasoning is nonsensical.\n- **Verdict:** Incorrect.\n\n**D. BRH definition: In a three-species comparison, three genes are BRHs if they maximize a triangle inequality on pairwise similarities. Counterexample: Long-branch attraction during phylogenetic tree reconstruction makes the wrong leaves cluster, so BRH must also fail from the same artifact, regardless of rates or duplication times.**\n\n- **Analysis of Definition:** The definition is completely incorrect. BRH is a pairwise method for two species. The description refers to a different, multi-species heuristic and misuses the term \"triangle inequality\".\n- **Analysis of Counterexample:** This is not a specific counterexample but a flawed argument by analogy. Long-branch attraction is an artifact of tree reconstruction methods, which is mechanistically distinct from the pairwise comparison logic of BRH. While related by the shared cause of rate heterogeneity, one does not directly imply the other in this manner. The claim that this happens \"regardless of rates\" is false; these failures are critically dependent on specific rate configurations.\n- **Verdict:** Incorrect.\n\n**Final Conclusion:**\nOption A is the only one that provides both a correct, formal definition of the BRH heuristic and a valid, specific, and correctly calculated counterexample demonstrating the failure of BRH to distinguish an out-paralog from a true ortholog due to asymmetric rates of evolution.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Having established how simple heuristics can fail, we now move to a practical application: diagnosing and correcting flawed evolutionary analyses. This problem presents a realistic case study where a conclusion of positive selection, indicated by a high ratio of nonsynonymous to synonymous substitution rates ($d_{N}/d_{S} > 1$), may be an artifact of hidden paralogy. Your task is to think like a critical reviewer or researcher, proposing a rigorous workflow to resolve the gene family's true evolutionary history before re-evaluating the evidence for selection. This practice emphasizes the crucial link between accurate orthology inference and the reliability of downstream functional and evolutionary conclusions .",
            "id": "2715891",
            "problem": "A published comparative study tested for elevated nonsynonymous over synonymous substitution rates across species for a single-copy gene family $G$ and reported evidence for positive selection. The authors sampled $S=8$ mammals, identified putative orthologs by reciprocal best hits using the Basic Local Alignment Search Tool (BLAST; reciprocal best hit (RBH) criterion with $E<10^{-5}$), retained one sequence per species (total $n=8$), generated a codon alignment, and estimated the ratio of nonsynonymous to synonymous substitution rates $\\omega=d_{N}/d_{S}$. A likelihood ratio test (LRT) reported $\\hat{\\omega}=1.3$ and a $p$-value $p=0.01$. Subsequent inspection of the genomes indicates that in $k=3$ of the $S=8$ species, there are $2$ tandemly duplicated copies of $G$ separated by less than $10$ kilobases, and the RBH procedure appears to have chosen among these duplicates inconsistently across species.\n\nStarting from core definitions in molecular evolution and phylogenomics—namely, that orthologs are homologous genes related by speciation, paralogs are homologous genes related by duplication, and that $\\omega=d_{N}/d_{S}$ is interpreted as purifying selection when $\\omega<1$, neutrality when $\\omega\\approx 1$, and positive selection when $\\omega>1$—propose how you would diagnose whether the originally reported signal of positive selection could be explained by hidden paralogy, and how you would correct the analysis before re-testing for selection. Your plan should be rooted in generally accepted practices for orthology inference and codon-model analysis, and should avoid assumptions that are invalid under gene duplication.\n\nWhich option(s) below most appropriately diagnose and correct hidden paralogy in this context before re-testing for positive selection? Select all that apply.\n\nA. Build a gene tree including all detected copies of $G$ from all $S=8$ species plus at least one outgroup to root the tree; reconcile this gene tree with a curated species tree to infer and time duplication events; identify and prune to a clade of $1$-$1$ orthologs by excluding branches descending from inferred duplication nodes; realign the retained orthologs with a codon-aware aligner and re-estimate $\\omega$ using a branch-site model restricted to the ortholog clade.\n\nB. Keep the original $n=8$ sequence set and alignment unchanged; replace the codon model with a nucleotide substitution model with $\\Gamma$-distributed rate variation across sites to account for heterogeneity, and re-run the same LRT without altering orthology assignments.\n\nC. For species with $2$ duplicates, select the copy with the smallest pairwise synonymous divergence $d_{S}$ to human, keep the original RBH picks for species with a single copy, then pool these $n=8$ sequences and re-estimate $\\omega$ as before.\n\nD. Examine the genomic neighborhood around $G$ across species for conserved synteny at $\\pm 10$ genes to define co-linear putative $1$-$1$ orthologs; cross-validate this set with gene-tree–species-tree reconciliation to confirm that no duplication nodes lie within the chosen clade; restrict the selection analysis to this validated ortholog set, and apply appropriate multiple-testing correction if testing multiple branches or models.\n\nE. Concatenate all paralogous copies per species into a single supersequence for each species to preserve all substitutions, realign, and re-fit the codon model, which increases power to detect selection while avoiding orthology decisions.",
            "solution": "The problem statement describes a situation where an initial analysis reported positive selection ($\\hat{\\omega} = d_{N}/d_{S} = 1.3$) in a gene family $G$ across $S=8$ mammalian species. This conclusion was based on a set of putative orthologs identified using the Reciprocal Best Hit (RBH) method. However, subsequent investigation revealed that gene $G$ is not a single-copy gene in $k=3$ of the species; these species possess tandem duplicates. The RBH procedure, a pairwise method, is known to be unreliable in the presence of gene duplications and differential gene loss, and in this case, it is stated to have chosen inconsistently among the paralogs. This is a critical flaw.\n\nThe core issue is **hidden paralogy**. The set of $n=8$ sequences used in the original analysis is not a true set of orthologs (genes related by speciation events) but rather a mixture of orthologs and paralogs (genes related by duplication events). After a gene duplication, one of the resulting paralogs may be subject to relaxed purifying selection or undergo positive selection to acquire a new function (neofunctionalization). When such a fast-evolving paralog from one species is mistakenly compared to a conserved ortholog in another species, the rate of nonsynonymous substitutions can appear artificially high. This inflates the estimate of $\\omega$ for the entire gene tree, often leading to a false-positive signal of positive selection. This is a well-documented artifact in molecular evolution studies.\n\nA valid correction must therefore abandon the flawed pairwise RBH approach and instead use a phylogenetically-principled method to distinguish orthology from paralogy. The standard and most robust method to achieve this is to reconstruct the evolutionary history of the entire gene family. The key steps are:\n$1$. Collect all detectable homologous sequences for gene $G$ from the $S=8$ species and include at least one outgroup species.\n$2$. Build a phylogenetic tree for the gene family from a multiple sequence alignment of these sequences. An outgroup is required to root the tree, which establishes the direction of evolution.\n$3$. Reconcile the rooted gene tree with the known species phylogeny. This process involves mapping the gene tree onto the species tree to infer which nodes in the gene tree represent speciation events and which represent gene duplication events.\n$4$. Based on the reconciled tree, identify a set of true one-to-one ($1-1$) orthologs. This is typically a subclade of the gene tree that contains exactly one gene from each species, where all bifurcations within that subclade are speciation events. Any lineages descending from a duplication node must be pruned to obtain such a clean set.\n$5$. Using this validated set of orthologs, redo the selection analysis. This involves creating a new codon alignment and fitting appropriate codon-based models of evolution (e.g., branch-site models) to test for positive selection, now free from the confounding effects of paralogy.\n\nBased on this principled approach, we can evaluate the provided options.\n\n**A. Build a gene tree including all detected copies of $G$ from all $S=8$ species plus at least one outgroup to root the tree; reconcile this gene tree with a curated species tree to infer and time duplication events; identify and prune to a clade of $1$-$1$ orthologs by excluding branches descending from inferred duplication nodes; realign the retained orthologs with a codon-aware aligner and re-estimate $\\omega$ using a branch-site model restricted to the ortholog clade.**\nThis option meticulously follows the standard, robust, and generally accepted phylogenetic workflow for resolving issues of hidden paralogy. It correctly prescribes ($1$) collecting all homologs, ($2$) building a rooted gene tree, ($3$) reconciling the gene and species trees to identify duplications, ($4$) pruning to a clean set of $1-1$ orthologs, and ($5$) re-running a proper selection analysis (using a codon-aware aligner and a powerful branch-site model) on the corrected dataset. This procedure directly addresses the root cause of the problem.\n**Verdict: Correct.**\n\n**B. Keep the original $n=8$ sequence set and alignment unchanged; replace the codon model with a nucleotide substitution model with $\\Gamma$-distributed rate variation across sites to account for heterogeneity, and re-run the same LRT without altering orthology assignments.**\nThis option is fundamentally flawed. Its primary mistake is to \"keep the original $n=8$ sequence set,\" which is known to be contaminated with paralogs. No statistical model, however complex, can correct for a dataset that misrepresents the true evolutionary relationships. Furthermore, replacing a codon model with a nucleotide substitution model is inappropriate for testing for positive selection on a protein's function, as the key metric $\\omega = d_{N}/d_{S}$ is a property of codon evolution, not nucleotide evolution. The $\\Gamma$-distributed rate variation accounts for rate heterogeneity among sites but does not solve the problem of including incorrect sequences (paralogs).\n**Verdict: Incorrect.**\n\n**C. For species with $2$ duplicates, select the copy with the smallest pairwise synonymous divergence $d_{S}$ to human, keep the original RBH picks for species with a single copy, then pool these $n=8$ sequences and re-estimate $\\omega$ as before.**\nThis option proposes a heuristic based on pairwise sequence divergence. While potentially better than random choice, it is not a principled phylogenetic method. It arbitrarily uses \"human\" as a reference, which may not be appropriate, and the assumption that the \"true\" ortholog has the lower $d_S$ is not guaranteed to be true. This method still avoids the crucial step of building a full gene tree to visualize and resolve all relationships simultaneously. It is another form of pairwise analysis, like RBH, and is susceptible to its own set of errors. It is not considered a robust or generally accepted practice for definitive orthology assignment.\n**Verdict: Incorrect.**\n\n**D. Examine the genomic neighborhood around $G$ across species for conserved synteny at $\\pm 10$ genes to define co-linear putative $1$-$1$ orthologs; cross-validate this set with gene-tree–species-tree reconciliation to confirm that no duplication nodes lie within the chosen clade; restrict the selection analysis to this validated ortholog set, and apply appropriate multiple-testing correction if testing multiple branches or models.**\nThis option describes an excellent and highly rigorous approach. It uses an independent line of evidence—conserved synteny (gene order)—to propose putative orthologs. True orthologs are more likely to be found in a conserved genomic context than are paralogs, especially recent tandem duplicates. Critically, it does not rely on synteny alone but \"cross-validates\" this hypothesis using the powerful gene-tree–species-tree reconciliation method. This combination of genomic location and sequence phylogeny provides very strong evidence for orthology. The subsequent steps of restricting the analysis to the validated set and applying appropriate statistical corrections are also correct. This represents a gold-standard approach in modern phylogenomics.\n**Verdict: Correct.**\n\n**E. Concatenate all paralogous copies per species into a single supersequence for each species to preserve all substitutions, realign, and re-fit the codon model, which increases power to detect selection while avoiding orthology decisions.**\nThis procedure is biologically nonsensical. Concatenating paralogs creates an artificial chimeric sequence that does not exist in nature and has no coherent evolutionary history. The assumptions of all phylogenetic and molecular evolution models would be violated. An alignment of such \"supersequences\" would be meaningless, and any resulting $\\omega$ estimate would be uninterpretable garbage. This approach does not \"avoid\" the orthology problem; it completely misunderstands it, leading to a fatally flawed analysis. The claim that this \"increases power\" is baseless.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "Our discussion of orthology and paralogy ultimately traces back to the detection of gene duplications from raw sequencing data. This final practice moves from high-level inference to the foundational data analysis that identifies the very structural variants that create paralogs. You will derive a decision rule from first principles to detect recent tandem duplications, integrating evidence from both read depth and split-read alignments. This exercise provides an essential look under the hood of bioinformatics, revealing how we translate ambiguous sequencing signals into concrete hypotheses about genome structure and evolution .",
            "id": "2715859",
            "problem": "Define unequal sister chromatid exchange in mechanistic terms and then construct, from first principles, a computational decision rule that detects recent tandem duplications in short-read resequencing data by combining read-depth evidence with split-read breakpoint evidence. Begin from foundational and widely accepted bases: (i) the proportionality between read depth and underlying deoxyribonucleic acid (DNA) copy number for uniformly sampled reads, (ii) a Poisson model for read counts in fixed-width windows, and (iii) the expectation that a tandem duplication in a diploid genome increases the local copy number from $2$ to $3$ and yields head-to-tail breakpoint junctions detectable as split-read alignments. Explain how such duplications generate paralogous copies and how these differ conceptually from orthologous relationships across species. Your decision rule must be explicitly derived from these bases, not asserted.\n\nYour program must implement the derived rule with the following formalization and fixed calibration choices so that results are testable:\n\n- For each genomic window, let $x$ be the observed read count, and let $\\mu$ be the expected read count under a baseline diploid copy number $2$ for that window after appropriate normalization (e.g., by genome-wide coverage and mappability). Model $x \\sim \\mathrm{Poisson}(\\mu)$ under the null (no duplication). Under a single-copy tandem duplication in a diploid, model the alternative mean as $\\mu_{1} = \\frac{3}{2}\\mu$.\n- Define the log-ratio $L = \\log_{2}\\!\\left(\\frac{x+\\epsilon}{\\mu+\\epsilon}\\right)$ with $\\epsilon = 10^{-6}$ to avoid division by zero.\n- Define the standardized residual $z = \\frac{x - \\mu}{\\sqrt{\\mu}}$ using the Poisson variance approximation.\n- Define the split-read support $s$ as the count of split-read alignments consistent with a head-to-tail tandem duplication breakpoint within the window or its boundaries.\n- Call a window a recent tandem duplication if and only if all of the following hold simultaneously:\n  1. Depth elevation: $L \\ge \\tau_{L}$ with $\\tau_{L} = \\log_{2}(1.3)$.\n  2. Depth significance: $z \\ge z_{\\min}$ with $z_{\\min} = 3.5$.\n  3. Breakpoint support: $s \\ge s_{\\min}$ with $s_{\\min} = 3$.\nThese thresholds are fixed for this exercise to ensure determinism; your derivation should justify why combining proportionality, Poisson variability, and breakpoint evidence is principled.\n\nTest suite. Your program must evaluate the following six cases, each represented as a triple $(\\mu, x, s)$:\n- Case A: $(1000, 1500, 6)$\n- Case B: $(1000, 980, 0)$\n- Case C: $(1000, 1500, 0)$\n- Case D: $(1000, 1000, 5)$\n- Case E: $(400, 560, 4)$\n- Case F: $(40, 60, 3)$\n\nFor each case, output a boolean indicating whether the rule calls a recent tandem duplication.\n\nFinal output format. Your program should produce a single line of output containing the results, in order A through F, as a comma-separated list enclosed in square brackets (e.g., \"[trueA,trueB,...]\" but using Python boolean literals). No physical units are required. Angles are not involved. Percentages must not be used; all comparisons are direct numeric thresholds on $L$, $z$, and $s$.",
            "solution": "The problem as stated is scientifically sound, internally consistent, and well-posed. It rests upon established principles of molecular biology and statistical genomics. All necessary parameters and definitions for the construction and testing of the computational rule are provided. Therefore, a rigorous solution can be derived.\n\nFirst, we shall address the conceptual underpinnings.\n\n**I. Mechanism and Homology**\n\nGene duplication is a fundamental driver of evolutionary innovation. One primary mechanism for generating tandem duplications—where a copy of a genomic segment is inserted adjacent to the original—is **unequal sister chromatid exchange (USCE)**. During mitosis or meiosis, sister chromatids—identical copies of a replicated chromosome—engage in homologous recombination for processes such as DNA repair. If the genome contains repetitive sequences (e.g., transposable elements), a misalignment may occur where one chromatid pairs with a non-allelic but homologous repeat on its sister. A subsequent crossover event will result in an unequal exchange of genetic material. One chromatid will receive a duplicated segment, while the other will sustain a corresponding deletion.\n\nThis duplication event gives rise to **paralogous genes**. To be precise, we must distinguish between different types of homology:\n- **Homologs** are genes that share a common evolutionary ancestor.\n- **Orthologs** are homologs found in different species that originated from a single ancestral gene in the last common ancestor. They arise from a speciation event and typically retain equivalent functions.\n- **Paralogs** are homologs within the same species that originated from a duplication event, such as USCE. Following duplication, the two paralogous copies can diverge. One copy may maintain the original function, while the other is free to accumulate mutations, potentially leading to a new function (neofunctionalization), a sub-divided function (subfunctionalization), or becoming a non-functional pseudogene (pseudogenization).\n\nThe problem concerns the detection of recent tandem duplications, which create nascent paralogous copies.\n\n**II. Derivation of the Decision Rule an First Principles**\n\nThe proposed decision rule is a logical construct that integrates three orthogonal lines of evidence, each grounded in a fundamental principle of sequencing data analysis. We derive the justification for each component of the rule.\n\n**Principle A: Proportionality of Read Depth to DNA Copy Number**\nThe first principle is that for an ideal short-read sequencing experiment with uniform, random sampling, the number of reads mapped to a genomic region is directly proportional to the copy number of that region's DNA in the sample.\n\nLet $C_0$ be the baseline copy number in a diploid organism, which is $C_0 = 2$. Let $\\mu$ be the expected read count (or \"depth\") for such a region after normalization for factors like local mappability and global sequencing throughput.\n\nA recent, heterozygous tandem duplication means that on one of the two homologous chromosomes, the segment is present in two copies, while on the other, it remains as a single copy. The new total copy number, $C_1$, is therefore $C_1 = 1 + 2 = 3$.\n\nBy the proportionality principle, the expected read count, $\\mu_1$, for the duplicated region is related to the baseline expectation $\\mu$ by the ratio of copy numbers:\n$$ \\mu_1 = \\mu \\times \\frac{C_1}{C_0} = \\mu \\times \\frac{3}{2} $$\nThis derivation provides the theoretical basis for the alternative hypothesis's mean, $\\mu_1 = \\frac{3}{2}\\mu$. The observed read count, $x$, should thus be centered around $1.5$ times the diploid expectation.\n\n**Principle B: Poisson Model of Read Counts**\nThe second principle is that the process of sequencing and mapping reads to a fixed-width genomic window can be modeled as a Poisson process. The count of reads, $x$, in a window is a random variable following a Poisson distribution, $x \\sim \\mathrm{Poisson}(\\lambda)$, where $\\lambda$ is the expected count. The variance of a Poisson distribution is equal to its mean, $\\mathrm{Var}(x) = \\lambda$.\n\nWe establish a hypothesis-testing framework:\n- **Null Hypothesis ($H_0$):** The region is diploid (no duplication). The expected read count is $\\mu$. So, $x \\sim \\mathrm{Poisson}(\\mu)$.\n- **Alternative Hypothesis ($H_1$):** The region has a heterozygous tandem duplication. The expected read count is $\\mu_1 = \\frac{3}{2}\\mu$. So, $x \\sim \\mathrm{Poisson}(\\frac{3}{2}\\mu)$.\n\nFrom these two principles, we derive two criteria based on read depth:\n\n1.  **Criterion of Depth Elevation ($L$):** We need to test if the observed data are consistent with the expected fold-change of $\\frac{3}{2} = 1.5$. We use the log-ratio $L = \\log_{2}\\!\\left(\\frac{x+\\epsilon}{\\mu+\\epsilon}\\right)$. The logarithm is used to stabilize variance and make fold-changes symmetric around $0$. The small constant $\\epsilon = 10^{-6}$ is a standard computational device to prevent undefined results when $x$ or $\\mu$ are zero. The threshold is set at $\\tau_L = \\log_2(1.3)$, which requires an observed fold-change of at least $1.3$. This is a conservative value, below the theoretical $1.5$, to account for measurement noise and mapping inefficiencies that can suppress the observed signal.\n\n2.  **Criterion of Statistical Significance ($z$):** A high fold-change can occur by chance, especially in regions of low coverage (small $\\mu$). For example, if $\\mu = 2$, observing $x=3$ gives a fold change of $1.5$, but this is a common random fluctuation. We must assess if the deviation from the null expectation is statistically significant. We use the standardized residual, $z = \\frac{x - \\mu}{\\sqrt{\\mu}}$. This quantity measures the difference between the observed count $x$ and the null expectation $\\mu$ in units of the standard deviation under the null ($\\sqrt{\\mathrm{Var}(x)} = \\sqrt{\\mu}$). For sufficiently large $\\mu$, $z$ is approximately distributed as a standard normal variable. The threshold $z_{\\min} = 3.5$ is a stringent requirement. It corresponds to a very small p-value, meaning that an observation with $z \\ge 3.5$ is extremely unlikely to have occurred by chance if the null hypothesis were true. This criterion guards against false positives driven by stochastic noise in low-coverage regions.\n\n**Principle C: Structural Evidence from Split Reads**\nThe third principle is that a tandem duplication creates a unique molecular structure—a novel head-to-tail junction—that is directly detectable. Read depth evidence is quantitative but not structural; an increase in depth could also be caused by a dispersed duplication or an experimental artifact.\n\nA read that spans the novel breakpoint junction of a tandem duplication cannot be mapped as a single, contiguous sequence to the reference genome. Instead, a proper alignment algorithm will split the read into two parts: one part mapping to the sequence just before the duplicated segment's end, and the other part mapping to the sequence just after its beginning. The count of such \"split reads,\" $s$, provides direct physical evidence for the specific tandem duplication structure.\n\n3.  **Criterion of Breakpoint Support ($s$):** To distinguish a true biological event from random mapping errors or chimeric sequencing artifacts, we require a minimum number of independent reads supporting the breakpoint. The condition $s \\ge s_{\\min} = 3$ ensures that the structural evidence is reproducible across at least $3$ independent DNA fragments. This provides strong confirmation of the tandem-duplication structure that is orthogonal to the copy-number evidence.\n\n**Synthesis**\nThe final decision rule, requiring all three conditions ($L \\ge \\tau_L$, $z \\ge z_{\\min}$, and $s \\ge s_{\\min}$) to be met simultaneously, is a robust and principled design. It combines a test for the expected magnitude of change ($L$), a test for the statistical significance of this change ($z$), and a test for the specific molecular structure of the event ($s$). By demanding consensus from these three orthogonal sources of evidence, the rule effectively minimizes false positives and ensures high-confidence detection of recent tandem duplications.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Applies a decision rule to detect recent tandem duplications based on\n    read depth and split-read evidence.\n    \"\"\"\n    # Define the fixed parameters and thresholds for the decision rule.\n    epsilon = 1e-6\n    tau_L = np.log2(1.3)\n    z_min = 3.5\n    s_min = 3\n\n    # Define the test cases from the problem statement as tuples of (mu, x, s).\n    # mu: expected read count (diploid)\n    # x: observed read count\n    # s: split-read support count\n    test_cases = [\n        (1000, 1500, 6),  # Case A\n        (1000, 980, 0),   # Case B\n        (1000, 1500, 0),  # Case C\n        (1000, 1000, 5),  # Case D\n        (400, 560, 4),    # Case E\n        (40, 60, 3),      # Case F\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, x, s = case\n\n        # 1. Calculate depth elevation (log-ratio L)\n        # L = log2((x + epsilon) / (mu + epsilon))\n        # Condition: L >= tau_L\n        log_ratio = np.log2((x + epsilon) / (mu + epsilon))\n        cond1_depth_elevation = log_ratio >= tau_L\n\n        # 2. Calculate depth significance (standardized residual z)\n        # z = (x - mu) / sqrt(mu)\n        # Condition: z >= z_min\n        # Ensure mu is not zero to avoid division error, though problem cases are safe.\n        if mu > 0:\n            std_residual = (x - mu) / np.sqrt(mu)\n            cond2_depth_significance = std_residual >= z_min\n        else: # Handle mu=0 case, though not present in test suite\n            cond2_depth_significance = False\n\n        # 3. Check breakpoint support (split-read count s)\n        # Condition: s >= s_min\n        cond3_breakpoint_support = s >= s_min\n\n        # A window is called as a tandem duplication if and only if\n        # all three conditions hold simultaneously.\n        is_duplication = cond1_depth_elevation and cond2_depth_significance and cond3_breakpoint_support\n        results.append(is_duplication)\n\n    # Format the final output as a single line: a comma-separated list of\n    # lowercase boolean strings, enclosed in square brackets.\n    # e.g., [true,false,false,false,true,false]\n    output_str = f\"[{','.join(map(lambda b: str(b).lower(), results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}