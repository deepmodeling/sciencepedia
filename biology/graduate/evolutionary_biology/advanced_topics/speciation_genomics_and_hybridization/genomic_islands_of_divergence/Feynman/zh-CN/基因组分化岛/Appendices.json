{
    "hands_on_practices": [
        {
            "introduction": "从理论到实践的第一步是培养敏锐的洞察力，以区分基因组中真实的分化信号与由其他演化过程产生的伪迹。在全基因组扫描中，仅依赖相对分化指标（如 $F_{ST}$）的峰值来识别分化岛是一个常见的陷阱，因为连锁选择（包括背景选择和选择性扫描）同样可以在低重组区域造成 $F_{ST}$ 的升高。这个练习旨在磨练一项关键技能：结合使用绝对分化（$d_{XY}$）、群体内多样性（$\\pi$）、重组率（$r$）以及经过突变率校正的指标（如相对节点深度 $\\mathrm{RND}$），来准确解读高分化信号的来源。通过这个实践，你将学会如何诊断一个 $F_{ST}$ 峰值究竟是代表了真正的基因流屏障，还是仅仅是局部有效种群大小降低所产生的统计结果 。",
            "id": "2718632",
            "problem": "对单一物种的两个种群（表示为 $X$ 和 $Y$）在不重叠的 $100$ 千碱基窗口中进行了全基因组取样。对于每个窗口，你计算了固定指数（F-统计量；$F_{ST}$）、种群间的平均成对差异（绝对分化；$d_{XY}$）、各种群内部的核苷酸多样性（$\\pi_X$和$\\pi_Y$）、重组率（$r$）以及与一个外群基因组的序列分化（$d_{XO}$和$d_{YO}$）。你观察到一部分窗口在 $F_{ST}$ 中形成了显著的峰值，但这些相同的窗口相对于基因组背景并未显示出升高的 $d_{XY}$；在几个这样的窗口中，$d_{XY}$ 与基因组中位数无法区分。在这些 $F_{ST}$ 峰值窗口中，你还注意到 $\\pi_X$ 和 $\\pi_Y$ 都倾向于低于其全基因组中位数，并且 $r$ 通常较低。\n\n从群体遗传学和溯祖理论的核心定义出发，推理这种模式是如何产生的。具体来说，利用以下两点：(i) 对于两个群体，固定指数的一个广泛使用的定义是可归因于群体间差异的总多样性比例，并且可以通过群体内和群体间的平均成对差异来表示；(ii) 谱系间的预期成对差异数与突变率乘以相关分支上的预期溯祖时间的乘积成正比。基于这些原则，回答以下问题：\n\n- 从机理上解释为什么 $F_{ST}$ 的峰值可以在没有相应 $d_{XY}$ 峰值的情况下出现。\n- 提出一个具体的、可检验的诊断方法，用以区分由群体内多样性降低引起的 $F_{ST}$ 峰值和由基因流屏障导致的群体间分化增加引起的 $F_{ST}$ 峰值，同时要考虑到突变率的异质性。\n\n哪个选项最能提供正确的解释和恰当的诊断方法？\n\nA. 当连锁选择（背景选择或平行选择性清除）降低了 $X$ 和 $Y$ 两个种群内的核苷酸多样性时，$F_{ST}$ 峰值可能出现。这会减少 $\\pi_X$ 和 $\\pi_Y$，从而夸大了归因于种群间差异的变异比例，即使绝对分化 $d_{XY}$ 未变。一个合适的诊断方法是检验 $F_{ST}$ 峰值是否与两个种群中都降低的 $\\pi_X$ 和 $\\pi_Y$ 同时出现，在 $d_{XY}$ 和相对节点深度 $\\mathrm{RND} = d_{XY}/\\overline{d_{XO,YO}}$ 上没有升高，并且与重组率 $r$ 显示出负相关。相比之下，基因流屏障模型预测 $d_{XY}$ 和 $\\mathrm{RND}$ 会升高，而 $\\pi$ 不会出现对称性的降低。\n\nB. $F_{ST}$ 的峰值反映了局部突变率的增加，这提高了种群内部新变异的数量，但由于种群间比较平均了更多的谱系，所以 $d_{XY}$ 保持不变。一个合适的诊断方法是，如果突变率是原因，那么与外群的分化（$d_{XO}$ 和 $d_{YO}$）在 $F_{ST}$ 峰值处应该保持不变。\n\nC. $F_{ST}$ 的峰值是古老平衡选择的标志，它在两个种群中维持了不同的等位基因类别，但因为平衡的等位基因是共享的，所以不改变 $d_{XY}$。一个合适的诊断方法是，在峰值处，Tajima’s $D$ 应该是正的，$\\pi_X$ 和 $\\pi_Y$ 应该是升高的，而 $d_{XY}$ 不变。\n\nD. $F_{ST}$ 的峰值最好由近期向一个种群的基因渗入来解释，这减少了该种群内的溯祖时间，但不改变 $d_{XY}$。一个合适的诊断方法是，如果基因渗入导致了这种模式，那么在这些窗口中，基于 $D$-统计量（ABBA–BABA）的基因流检验应该为阴性。\n\n选择唯一的最佳选项。",
            "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 抽样了两个种群，分别指定为 $X$ 和 $Y$。\n- 在不重叠的 $100$ 千碱基窗口中对基因组进行了分析。\n- 对每个窗口，计算了以下统计量：\n    - 固定指数：$F_{ST}$\n    - 种群间绝对分化：$d_{XY}$\n    - 种群内核苷酸多样性：$\\pi_X$ 和 $\\pi_Y$\n    - 重组率：$r$\n    - 与外群的分化：$d_{XO}$ 和 $d_{YO}$\n- 在一部分窗口（下文称“$F_{ST}$-峰值窗口”）中的关键观察结果：\n    1. $F_{ST}$ 出现显著峰值。\n    2. 相对于基因组背景，$d_{XY}$ 没有相应升高；$d_{XY}$ 可能处于基因组中位数水平。\n    3. $\\pi_X$ 和 $\\pi_Y$ 均低于其全基因组中位数。\n    4. 重组率 $r$ 通常较低。\n- 需要使用的指导原则：\n    1. $F_{ST}$ 是来自种群间差异的总多样性比例，可通过种群内和种群间的平均成对差异来表示。\n    2. 预期的成对差异数与突变率乘以预期溯祖时间的乘积成正比。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提问恰当且客观。它描述了在种群基因组数据中观察到的一个真实模式，并要求基于溯祖理论和种群遗传学的基本原则给出机理上的解释和诊断检验。已知条件是自洽的，足以形成一个严谨的答案。所描述的现象——固定指数、核苷酸多样性、分化、连锁选择、基因流屏障——是进化生物学的核心概念。该问题不违反任何科学原则，没有歧义，并提出了一个有相当难度的挑战。\n\n**步骤3：结论与行动**\n该问题是**有效的**。将推导一个解决方案。\n\n**从第一性原理推导**\n\n问题要求解释在 $d_{XY}$ 不高的情况下出现高 $F_{ST}$ 的现象，同时已知 $\\pi_X$ 和 $\\pi_Y$ 降低。让我们从 $F_{ST}$ 的给定定义开始。一个基于平均成对差异（核苷酸多样性）的固定指数常用公式是：\n$$F_{ST} = \\frac{\\pi_T - \\pi_S}{\\pi_T}$$\n其中 $\\pi_S$ 是种群内的平均多样性，$\\pi_T$ 是总多样性。在两个种群 $X$ 和 $Y$ 的情况下，可以表示为 $\\pi_S = (\\pi_X + \\pi_Y)/2$，而 $\\pi_T$ 是混合样本中的多样性。Nei (1987) 提出了一个密切相关的替代定义，直接用 $\\pi$ 和 $d_{XY}$ 表示 $F_{ST}$：\n$$F_{ST} = 1 - \\frac{\\pi_S}{d_{XY}} = 1 - \\frac{(\\pi_X + \\pi_Y)/2}{d_{XY}}$$\n这个方程揭示了 $F_{ST}$ 可以通过两种主要方式升高：\n1.  分母 $d_{XY}$（绝对分化）增加，而 $\\pi_X + \\pi_Y$ 保持不变或减少。\n2.  分子 $\\pi_X + \\pi_Y$（种群内多样性）减少，而 $d_{XY}$ 保持不变或增加得不那么快。\n\n问题陈述中指出，在 $F_{ST}$-峰值窗口中，$d_{XY}$ *并未* 升高，而 $\\pi_X$ 和 $\\pi_Y$ 都 *减少*了。这直接对应于第二种情况：高 $F_{ST}$ 值必定是种群内多样性降低的结果，而不是种群间分化增加的结果。\n\n接下来，按照指示，我们将这些统计量与溯祖理论联系起来。一个二倍体种群内的预期核苷酸多样性 $\\pi$ 与其有效种群大小 $N_e$ 和突变率 $\\mu$ 成正比：$E[\\pi] = 4N_e\\mu$。更一般地，$E[\\pi]$ 与从该种群中抽取的两个谱系的平均溯祖时间 $T_2$ 成正比。因此，$\\pi_X \\propto T_X$ 和 $\\pi_Y \\propto T_Y$。\n预期的绝对分化 $d_{XY}$ 与从每个种群中各抽取一个谱系的平均溯祖时间成正比。这个时间 $T_{XY}$ 是到达共同祖先种群的时间（$T_{\\text{split}}$）与该祖先种群内的溯祖时间之和。因此，$E[d_{XY}] \\propto T_{XY}$。\n\n观察到 $\\pi_X$ 和 $\\pi_Y$ 的降低，意味着种群内溯祖时间 $T_X$ 和 $T_Y$ 的局部减少。这等同于有效种群大小 $N_e$ 的局部减少。在基因组中导致 $N_e$ 局部减少的机制是**连锁选择**。\n- **背景选择 (BGS)**：针对不断出现的有害突变的净化选择会移除连锁的中性变异。在低重组率的区域，BGS 的强度更强，因为有更大的基因组片段与受选择的位点连锁。这与在 $F_{ST}$-峰值窗口中 $r$ 较低的观察结果相符。\n- **选择性清除**：一个有利等位基因的固定会“清除”掉连锁的中性变异。如果此类清除在两个种群中平行发生，或发生在祖先种群中，它们将减少 $X$ 和 $Y$ 种群内的多样性。\n\n连锁选择减少了种群内的溯祖时间，但不影响种群的分化时间。因此，它在不增加 $d_{XY}$ 的情况下减少了 $\\pi_X$ 和 $\\pi_Y$。这就产生了所描述的特征：高 $F_{ST}$、低 $\\pi_X$、低 $\\pi_Y$ 和正常的 $d_{XY}$。\n\n第二个任务是提出一种诊断方法。我们必须将连锁选择情景与“分化岛”的典型模型区分开来，后者假设存在局部的**基因流屏障**（例如，由于针对杂交种的分化选择）。基因流屏障特别阻碍了特定基因组区域内种群间等位基因的交换。这会有选择地将种群间谱系对的溯祖时间（$T_{XY}$）向更远的过去推移，导致绝对分化 $d_{XY}$ 的增加。\n为了区分这些情景，必须考虑突变率的异质性。$d_{XY}$ 和 $\\pi$ 都与局部突变率 $\\mu$ 成正比。一个高突变率的区域默认会有高的 $d_{XY}$ 和高的 $\\pi$。为了控制 $\\mu$，我们可以使用与一个更远的外群的分化。分化 $d_{O} = (d_{XO} + d_{YO})/2$ 也与 $\\mu$ 成正比。分化值的比率可以对突变率进行归一化。**相对节点深度 (RND)** 是实现此目的的有效统计量：\n$$\\mathrm{RND} = \\frac{d_{XY}}{\\overline{d_{XO,YO}}}$$\n该比率与溯祖时间之比 $T_{XY}/T_{XO,YO}$ 成正比。\n- 在**连锁选择**情景中，$T_{XY}$ 相对于基因组背景没有升高。因此，$d_{XY}$ 没有升高（在考虑 $\\mu$ 之后），RND 也不会升高。\n- 在**基因流屏障**情景中，$T_{XY}$ 会局部升高。因此，$d_{XY}$ 会升高，RND 也会升高。\n\n因此，一个稳健的诊断方法是检查 $\\pi_X$、$\\pi_Y$、$d_{XY}$ 和 RND 的模式。连锁选择模型预测 $F_{ST}$ 的峰值与降低的 $\\pi_X$ 和 $\\pi_Y$ 同时出现，但与升高的 $d_{XY}$ 或 RND 无关。基因流屏障模型预测 $F_{ST}$ 的峰值与升高的 $d_{XY}$ 和 RND 同时出现，而不一定伴随 $\\pi$ 的对称性降低。\n\n**逐项分析**\n\n**A. 当连锁选择（背景选择或平行选择性清除）降低了 $X$ 和 $Y$ 两个种群内的核苷酸多样性时，$F_{ST}$ 峰值可能出现。这会减少 $\\pi_X$ 和 $\\pi_Y$，从而夸大了归因于种群间差异的变异比例，即使绝对分化 $d_{XY}$ 未变。一个合适的诊断方法是检验 $F_{ST}$ 峰值是否与两个种群中都降低的 $\\pi_X$ 和 $\\pi_Y$ 同时出现，在 $d_{XY}$ 和相对节点深度 $\\mathrm{RND} = d_{XY}/\\overline{d_{XO,YO}}$ 上没有升高，并且与重组率 $r$ 显示出负相关。相比之下，基因流屏障模型预测 $d_{XY}$ 和 $\\mathrm{RND}$ 会升高，而 $\\pi$ 不会出现对称性的降低。**\n\n- **解释**：这与我们的推导完全一致。它正确地指出了连锁选择是 $\\pi_X$ 和 $\\pi_Y$ 降低的原因，并正确解释了这在不增加 $d_{XY}$ 的情况下夸大了 $F_{ST}$。\n- **诊断**：这提供了一个全面且正确的诊断方法。它结合了直接特征（降低的 $\\pi$，`$d_{XY}$` 未升高）和促进连锁选择的条件（低 `$r$`），而且至关重要的是，它包含了一个经突变率校正的度量（`RND`），以将此情景与局部基因流屏障的情景区分开来。与屏障模型的对比也是准确的。\n- **结论**：**正确**。\n\n**B. $F_{ST}$ 的峰值反映了局部突变率的增加，这提高了种群内部新变异的数量，但由于种群间比较平均了更多的谱系，所以 $d_{XY}$ 保持不变。一个合适的诊断方法是，如果突变率是原因，那么与外群的分化（$d_{XO}$ 和 $d_{YO}$）在 $F_{ST}$ 峰值处应该保持不变。**\n\n- **解释**：这是不正确的。增加的突变率（`$\\mu$`）将增加*所有*的多样性和分化指标（`$\\pi_X$`、`$\\pi_Y$`、`$d_{XY}$`、`$d_{XO}$`、`$d_{YO}$`）。这与观察到 `$\\pi_X$` 和 `$\\pi_Y$` *降低*的事实相矛盾。声称 `$d_{XY}$` 会保持不变在理论上是不成立的。\n- **诊断**：诊断方法也有缺陷。如果增加的突变率是原因，`$d_{XO}$` 和 `$d_{YO}$` 会升高，而不是保持不变。\n- **结论**：**不正确**。\n\n**C. $F_{ST}$ 的峰值是古老平衡选择的标志，它在两个种群中维持了不同的等位基因类别，但因为平衡的等位基因是共享的，所以不改变 $d_{XY}$。一个合适的诊断方法是，在峰值处，Tajima’s $D$ 应该是正的，$\\pi_X$ 和 $\\pi_Y$ 应该是升高的，而 $d_{XY}$ 不变。**\n\n- **解释**：平衡选择通过维持古老的等位基因，导致局部核苷酸多样性（`$\\pi$`）*增加*。这与观察到 `$\\pi_X$` 和 `$\\pi_Y$` 降低的核心观察结果相矛盾。此外，如果平衡选择在每个种群中维持*不同*的等位基因，它将增加种群间的分化，从而提高 `$d_{XY}$`。如果相同的等位基因在两个种群中都得到维持（跨物种多态性），`$F_{ST}$` 应该低，而不是高。\n- **诊断**：所提出的诊断方法（正的 Tajima's `$D$`，升高的 `$\\pi$`）是用来检验平衡选择的，但这与问题中观察到的模式相反。\n- **结论**：**不正确**。\n\n**D. $F_{ST}$ 的峰值最好由近期向一个种群的基因渗入来解释，这减少了该种群内的溯祖时间，但不改变 $d_{XY}$。一个合适的诊断方法是，如果基因渗入导致了这种模式，那么在这些窗口中，基于 $D$-统计量（ABBA–BABA）的基因流检验应该为阴性。**\n\n- **解释**：对基因渗入影响的描述含糊不清，并且不太可能产生观察到的模式。来自一个分化源的基因渗入通常会*增加*受体种群的多样性，这与观察到的减少相反。`$X$` 和 `$Y$` 种群之间的基因渗入会使它们同质化，降低 `$F_{ST}$` 和 `$d_{XY}$`。\n- **诊断**：这从根本上是错误的。`$D$`-统计量旨在检测基因渗入。一个显著的非零 `$D$`-统计量是基因渗入*存在*的证据。一个阴性检验（`$D \\approx 0$`）是*反对*基因渗入的证据。所述的诊断方法是自相矛盾的。\n- **结论**：**不正确**。\n\n基于严谨的分析，选项A既为观察到的基因组模式提供了正确的机理学解释，也提供了一个完整、论证充分的诊断程序，该程序在考虑了混杂因素的同时，将其与一个关键的替代假设区分开来。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在学会了如何概念性地解读观测到的基因组模式之后，下一步是建立一个理论模型来预测“真实”分化岛的特征。这个练习将引导你从群体遗传学的基本原理出发，推导出一个由有害等位基因的迁移和选择所维持的分化岛的特征宽度。你将亲手将选择系数（$s$）、迁移率（$m$）、有效种群大小（$N_e$）和重组率（$\\rho$）等核心演化参数联系起来，预测一个可观测的基因组特征。这项实践不仅能加深你对基因流屏障如何塑造基因组变异景观的理解，也为评估和解释在真实数据中发现的候选分化岛提供了理论基准 。",
            "id": "2718647",
            "problem": "您的任务是构建一个基于原则、基于模拟的估计量，用于估算在两个交换迁徙个体的亚群之间，受分化选择作用的单个双等位基因座周围的特征性基因组岛宽度。请严格遵循基于经典群体遗传学和结构化溯祖理论的第一性原理进行推导。\n\n考虑一个具有以下常数的双亚群 Wright–Fisher 模型：每个亚群的有效群体大小 $N_e = 10^5$，每碱基每代的（中性）突变率 $\\mu = 1 \\times 10^{-8}$，每代对称迁移率 $m = 5 \\times 10^{-4}$，以及一个受分化选择的单个基因座，在每个亚群中，针对局部不适应等位基因的选择系数为 $s = 0.02$。每碱基每代的重组率用 $\\rho$ 表示（这在缩略图中扮演 $r$ 的角色，但必须明确处理为每碱基的速率），并且假设一个与受选择位点物理距离为 $x$（单位为碱基对）的中性位点之间的重组分数满足 $c \\approx \\rho x$（对于较小的遗传距离）。\n\n请仅从以下基础出发：\n- 在离散、非重叠世代中的包含迁移和重组的 Wright–Fisher 模型。\n- 结构化溯祖对应关系，即在一个双亚群岛屿模型的中性平衡状态下，一个中性基因座的固定指数 (Fixation Index, F_ST) 取决于遗传漂变和有效迁移率之间的平衡。\n- 群体遗传学推理，即与受分化选择的基因座连锁的中性基因座会经历有效迁移率降低，因为携带不适应等位基因的迁徙单倍型通常会被清除，除非在被清除之前，重组将该中性位点与不适应背景解耦。\n\n基于这些基础，推导出一个可实现的算法，该算法能够：\n- 利用选择清除（速率为 $s$）和重组解耦（速率为 $c$）之间的竞争，将一个中性基因座的有效迁移率定义为 $c$ 的函数。\n- 通过将有效迁移率代入结构化群体中中性分化对迁移的经典依赖关系，将预期的平衡分化剖面表示为 $c$ 的函数。\n- 如下定义基因组岛的“半峰全宽”(FWHM)。设 $F(c)$ 表示作为 $c$ 的函数的预期平衡分化，其中 $F(0)$ 是在受选择位点处的峰值分化，而 $\\lim_{c \\to \\infty} F(c)$ 是非连锁中性基线。半峰值水平是这两个水平之间的中点。半宽 $x_{1/2}$ 是当 $c = \\rho x$ 时，使得 $F(c)$ 等于此半峰值的物理距离 $x$（单位为碱基对）。全宽为 $W = 2 x_{1/2}$。所有距离必须以碱基对表示。\n\n实现一个程序，在给定的常数 $N_e, \\mu, m, s$ 下，为一组给定的每碱基重组率 $\\rho$ 计算 $W$。您的程序不应读取任何输入，并且必须确定性地生成其输出。虽然 $\\mu$ 是作为一个参数提供的，但您的推导应明确在所述假设下 $W$ 是否依赖于 $\\mu$。\n\n测试集：\n- 使用五个每碱基每代的重组率 $\\rho \\in \\{1 \\times 10^{-10}, 5 \\times 10^{-10}, 1 \\times 10^{-9}, 1 \\times 10^{-8}, 5 \\times 10^{-8}\\}$。\n- 对于测试集中的每个 $\\rho$，按照上述描述计算全宽 $W$，单位为碱基对。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个 Python 风格的列表，该列表包含与测试集中的 $\\rho$ 值相对应的五个宽度值，顺序与所列顺序相同。每个宽度必须以浮点数形式报告，单位为碱基对，并四舍五入到 $1$ 位小数。该行必须只包含此列表，例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$（无附加文本）。",
            "solution": "问题陈述严格基于群体遗传学原理，且定义明确。它提供了所有必要的参数和一个清晰、可形式化的目标。所描述的模型是用于研究生殖隔离的基因组结构的经典理论构建。因此，该问题是有效的，并将按要求从第一性原理推导出解决方案。\n\n目标是计算受选择基因座周围的分化基因组岛的半峰全宽 $W$。这需要一个三步推导过程：首先，将有效迁移率 $m_e$ 建模为重组的函数；其次，用这个有效迁移率表达基因组分化 $F(c)$；第三，基于 $F(c)$ 的剖面求解宽度。\n\n**1. 有效迁移率 ($m_e$)**\n\n考虑一个与受选择基因座重组距离为 $c$ 的中性基因座。在所描述的双亚群模型中，受选择基因座的一个等位基因在亚群1中受青睐，在亚群2中不受青睐，反之亦然。一个迁徙单倍型携带其来源亚群的中性等位基因，但它与在接受亚群中不适应的等位基因连锁。这个不适应的等位基因具有 $s$ 的选择劣势。\n\n到达新的亚群后，该迁徙单倍型受到两种竞争过程的影响：\n-   **选择清除**：由于连锁的不适应等位基因的负面适应性效应，该单倍型被从群体中清除。此过程的特征速率与选择系数 $s$ 成正比。\n-   **重组**：中性等位基因与不适应背景解耦，并被置于一个局部适应的遗传背景上。这以每代 $c$ 的速率发生。\n\n只有当重组在谱系被选择清除之前发生时，中性等位基因才能成功渗入。迁徙谱系通过重组逃避选择清除的概率 $P_{\\text{escape}}$ 可近似为重组速率与重组和选择速率之和的比值。这个来自遗传障碍理论的经典结果由下式给出：\n$$\nP_{\\text{escape}} \\approx \\frac{c}{c+s}\n$$\n中性基因座的有效迁移率 $m_e(c)$ 是名义迁移率 $m$ 与此逃逸概率的乘积：\n$$\nm_e(c) = m \\cdot P_{\\text{escape}} = m \\frac{c}{c+s}\n$$\n该函数正确地捕捉了极限行为：当连锁是绝对的（$c=0$）时，有效迁移率为零（$m_e(0)=0$）。当中性基因座不连锁（$c \\to \\infty$）时，有效迁移率接近名义迁移率（$m_e(c) \\to m$）。\n\n**2. 平衡分化剖面 ($F(c)$)**\n\n问题指导我们使用结构化群体中固定指数 $F_{ST}$ 与迁移率之间的标准关系。对于赖特岛屿模型（Wright's island model）下的一个中性基因座，平衡 $F_{ST}$ 由遗传漂变（增加分化）和迁移（使群体同质化）之间的平衡决定。这种关系由下式给出：\n$$\nF_{ST} = \\frac{1}{1 + 4N_e m}\n$$\n其中 $N_e$ 是每个亚群的有效大小， $m$ 是迁移率。在我们的案例中，与连锁中性基因座相关的迁移率是有效迁移率 $m_e(c)$。通过将 $m_e(c)$ 代入此公式，我们得到作为重组分数 $c$ 的函数的预期分化 $F(c)$：\n$$\nF(c) = \\frac{1}{1 + 4N_e m_e(c)} = \\frac{1}{1 + 4N_e m \\left(\\frac{c}{c+s}\\right)}\n$$\n值得注意的是，中性突变率 $\\mu$ 并未出现在此公式中。这是同源共祖（identity by descent）模型的标准结果，其中平衡结构取决于溯祖率（与 $N_e$ 相关）和迁移率（$m$），其常见假设是突变率远小于这些其他速率（$\\mu \\ll m$ 且 $\\mu \\ll 1/N_e$）。鉴于给定的参数 $\\mu = 1 \\times 10^{-8}$、$m = 5 \\times 10^{-4}$ 和 $N_e = 10^5$，这个假设成立，因此宽度 $W$ 将不依赖于 $\\mu$。\n\n**3. 半峰全宽 ($W$)**\n\n半峰全宽 ($W$) 是基于分化剖面 $F(c)$ 定义的。\n\n首先，我们确定分化的峰值和基线水平。\n-   **峰值分化 ($F_{peak}$)** 发生在受选择基因座本身，此处 $c=0$。\n    $$\n    F_{peak} = F(0) = \\frac{1}{1 + 4N_e m \\left(\\frac{0}{0+s}\\right)} = \\frac{1}{1+0} = 1\n    $$\n-   **基线分化 ($F_{base}$)** 发生在远离受选择位点的基因座，此处连锁可以忽略 ($c \\to \\infty$)。\n    $$\n    F_{base} = \\lim_{c \\to \\infty} F(c) = \\lim_{c \\to \\infty} \\frac{1}{1 + 4N_e m \\left(\\frac{c}{c+s}\\right)} = \\frac{1}{1 + 4N_e m}\n    $$\n\n接下来，我们将半峰值分化水平 $F_{1/2}$ 定义为峰值和基线之间的中点。\n$$\nF_{1/2} = \\frac{F_{peak} + F_{base}}{2} = \\frac{1}{2}\\left(1 + \\frac{1}{1 + 4N_e m}\\right)\n$$\n半宽对应于使分化等于此半峰值水平的重组分数 $c_{1/2}$，即 $F(c_{1/2}) = F_{1/2}$。我们求解 $c_{1/2}$：\n$$\n\\frac{1}{1 + 4N_e m \\left(\\frac{c_{1/2}}{c_{1/2}+s}\\right)} = \\frac{1}{2}\\left(1 + \\frac{1}{1 + 4N_e m}\\right) = \\frac{1}{2}\\left(\\frac{1 + 4N_e m + 1}{1 + 4N_e m}\\right) = \\frac{2 + 4N_e m}{2(1 + 4N_e m)}\n$$\n对两边取倒数：\n$$\n1 + 4N_e m \\left(\\frac{c_{1/2}}{c_{1/2}+s}\\right) = \\frac{2(1 + 4N_e m)}{2 + 4N_e m}\n$$\n两边同时减去 $1$：\n$$\n4N_e m \\left(\\frac{c_{1/2}}{c_{1/2}+s}\\right) = \\frac{2(1 + 4N_e m)}{2 + 4N_e m} - 1 = \\frac{2 + 8N_e m - (2 + 4N_e m)}{2 + 4N_e m} = \\frac{4N_e m}{2 + 4N_e m}\n$$\n假设 $4N_e m \\neq 0$，我们可以用 $4N_e m$ 除以两边：\n$$\n\\frac{c_{1/2}}{c_{1/2}+s} = \\frac{1}{2 + 4N_e m}\n$$\n求解 $c_{1/2}$：\n$$\n(2 + 4N_e m)c_{1/2} = c_{1/2} + s\n$$\n$$\n(1 + 4N_e m)c_{1/2} = s \\implies c_{1/2} = \\frac{s}{1 + 4N_e m}\n$$\n半宽 $x_{1/2}$ 是与 $c_{1/2}$ 对应的以碱基对为单位的物理距离。使用给定的近似值 $c \\approx \\rho x$，其中 $\\rho$ 是每碱基对的重组率：\n$$\nx_{1/2} = \\frac{c_{1/2}}{\\rho} = \\frac{1}{\\rho} \\left(\\frac{s}{1 + 4N_e m}\\right)\n$$\n半峰全宽 $W$ 定义为 $2x_{1/2}$：\n$$\nW = 2x_{1/2} = \\frac{2}{\\rho}\\left(\\frac{s}{1 + 4N_e m}\\right)\n$$\n这就是需要实现的最终表达式。它巧妙地综合了选择（$s$）、重组（$\\rho$）、迁移（$m$）和遗传漂变（$N_e$）对基因组分化空间范围的影响。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the full width at half maximum (FWHM) of a genomic island of divergence.\n\n    The derivation is based on a two-deme Wright-Fisher model with selection, migration,\n    and recombination. The final formula for the width W is:\n        W = (2 / rho) * (s / (1 + 4 * Ne * m))\n    where:\n    - rho: recombination rate per base per generation\n    - s: selection coefficient\n    - Ne: effective population size per deme\n    - m: migration rate per generation\n    \"\"\"\n\n    # Define the fixed constants from the problem statement.\n    Ne = 1e5  # Effective population size per deme\n    m = 5e-4  # Symmetric per-generation migration rate\n    s = 0.02  # Selection coefficient against maladapted allele\n\n    # Define the test suite for the recombination rate per base per generation (rho).\n    test_suite_rho = [1e-10, 5e-10, 1e-9, 1e-8, 5e-8]\n\n    # Pre-calculate the constant part of the formula.\n    # This term combines the effects of selection, population size, and migration.\n    # The result, c_half, is the recombination fraction at the half-maximum point.\n    c_half = s / (1 + 4 * Ne * m)\n\n    results = []\n    for rho in test_suite_rho:\n        # Calculate the half-width in base pairs.\n        # x_half = c_half / rho\n        # The full width W is 2 * x_half.\n        # All distances are in base pairs.\n        width = 2 * c_half / rho\n        \n        # Round the result to one decimal place as required.\n        results.append(round(width, 1))\n\n    # Format the final output as a single line containing a Python-style list\n    # of the computed widths, rounded to 1 decimal place.\n    # e.g., [1234.5,678.9,...]\n    # The str() function on a float like 123.0 correctly formats it as \"123.0\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}