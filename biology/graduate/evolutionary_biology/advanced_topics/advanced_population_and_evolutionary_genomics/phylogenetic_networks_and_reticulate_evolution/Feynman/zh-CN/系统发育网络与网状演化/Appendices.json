{
    "hands_on_practices": [
        {
            "introduction": "从距离数据构建系统发育网络是该领域的一项基本任务。NeighborNet 算法是一种强大的基于距离的方法，它通过迭代地聚合分类单元来构建网络，从而可视化数据中的冲突信号。本练习将带您亲历 NeighborNet 算法的初始步骤，通过计算 Q-准则并确定第一个成对的分类单元，来理解网络构建过程的核心机制。",
            "id": "2743224",
            "problem": "一个研究团队正在使用一种旨在恢复分裂网络的基于距离的方法，分析五个分类单元间的网状进化。他们计划使用 NeighborNet 算法的第一个凝聚步骤来初始化分类单元的循环排序，并基于此构建网络。给定关于分类单元 $\\{A,B,C,D,E\\}$ 的对称分类单元距离矩阵 $D=\\left(d_{ij}\\right)$：\n$$\nD \\;=\\;\n\\begin{pmatrix}\n0 & 2 & 8 & 9 & 9 \\\\\n2 & 0 & 9 & 9 & 10 \\\\\n8 & 9 & 0 & 3 & 8 \\\\\n9 & 9 & 3 & 0 & 9 \\\\\n9 & 10 & 8 & 9 & 0\n\\end{pmatrix},\n$$\n其中，条目 $(i,j)$ 的值 $d_{ij}$ 是分类单元 $i$ 和 $j$ 之间观测到的进化距离，且对所有 $i$ 都有 $d_{ii}=0$。假设这些距离是与序列进化的标准随机模型一致的加性近似。\n\n使用凝聚式距离方法的基本原理，按以下步骤进行。\n\n- 使用邻接法 $Q$-准则（在 NeighborNet 的第一步中，当所有簇都为单元素簇时应用）来选择第一个要凝聚的对。对于具有成对距离 $d_{ij}$ 和行和 $r_i=\\sum_{k\\neq i} d_{ik}$ 的 $n$ 个分类单元，计算\n$$\nQ(i,j) \\;=\\; (n-2)\\,d_{ij} \\;-\\; r_i \\;-\\; r_j,\n$$\n对于所有无序对 $\\{i,j\\}$，其中 $n=5$，并选择具有最小 $Q$ 值的对。\n\n- 从这个凝聚对 $(u,v)$ 开始，通过以下最近邻扩展规则生成所有五个分类单元的循环排序：用 $(u,v)$ 初始化一个排序；在每一步中，从剩余的分类单元中选择使 $\\min\\{d_{ux},\\,d_{vx}\\}$ 最小的分类单元 $x$，并将其附加到它更近的一端（当前排序的 $u$ 端或 $v$ 端），若出现平局，则选择 $r_x$ 较小者，若仍然平局，则选择 $d_{ux}$ 较小者；附加后，相应地更新当前的两端；重复此过程，直到所有分类单元都被放置，以获得一个循环排序（不区分旋转和反转）。\n\n显示您的中间计算过程，包括 $r_i$ 值、$Q(i,j)$ 值、所选的对以及构建的循环排序。然后，作为您最终报告的量，提供您为第一次凝聚找到的最小 $Q$ 值。将最终值表示为一个精确整数（不要四舍五入）。最终答案中不要包含任何单位。",
            "solution": "对问题陈述进行验证。\n\n**第1步：提取已知信息**\n- 分类单元集：$\\{A, B, C, D, E\\}$\n- 分类单元数量：$n=5$\n- 对称距离矩阵 $D = (d_{ij})$：\n$$\nD = \\begin{pmatrix}\n0 & 2 & 8 & 9 & 9 \\\\\n2 & 0 & 9 & 9 & 10 \\\\\n8 & 9 & 0 & 3 & 8 \\\\\n9 & 9 & 3 & 0 & 9 \\\\\n9 & 10 & 8 & 9 & 0\n\\end{pmatrix}\n$$\n- $Q$-凝聚准则：$Q(i,j) = (n-2)d_{ij} - r_i - r_j$\n- 行和定义：$r_i = \\sum_{k \\neq i} d_{ik}$\n- 循环排序构建规则：\n    1. 用使 $Q(i,j)$ 最小的对 $(u,v)$ 初始化排序。\n    2. 在每一步中，选择一个未放置的分类单元 $x$，使其最小化 $\\min\\{d_{ux}, d_{vx}\\}$，其中 $u$ 和 $v$ 是当前有序列表的两端。\n    3. 将 $x$ 附加到其更近的一端（$u$ 或 $v$）。\n    4. 平局首先由较小的 $r_x$ 打破，然后由较小的 $d_{ux}$ 打破。\n    5. 重复此过程，直到所有分类单元都被放置。\n\n**第2步：使用提取的已知信息进行验证**\n评估问题的有效性。\n- **科学依据**：该问题基于邻接法（$Q$-准则）和 NeighborNet 算法，这些是在计算进化生物学中从距离数据构建系统发育树和网络的标准且成熟的方法。其前提是科学合理的。\n- **良态问题**：该问题提供了所有必要的数据（距离矩阵 $D$）、定义（$r_i$ 和 $Q(i,j)$ 的公式），以及一个用于构建循环排序的完整、确定性的算法，包括明确的平局打破规则。这保证了唯一解的存在。\n- **客观性**：问题以精确、正式的语言陈述，没有歧义或主观论断。\n- **完整性与一致性**：问题是自洽的。矩阵的大小（$5 \\times 5$）与分类单元的数量（$n=5$）相匹配。没有信息缺失或相互矛盾。\n\n**第3步：结论与行动**\n该问题是有效的。这是一个应用已知系统发育算法的、定义明确的计算练习。将提供完整解答。\n\n首要任务是确定使 $Q$-准则最小化的分类单元对 $\\{i,j\\}$。这需要为每个分类单元计算行和 $r_i$，然后为所有不同的对计算 $Q(i,j)$ 值。分类单元的数量为 $n=5$。\n\n首先，我们为每个分类单元 $i \\in \\{A, B, C, D, E\\}$ 计算行和 $r_i = \\sum_{k \\neq i} d_{ik}$。\n$$r_A = d_{AB} + d_{AC} + d_{AD} + d_{AE} = 2 + 8 + 9 + 9 = 28$$\n$$r_B = d_{BA} + d_{BC} + d_{BD} + d_{BE} = 2 + 9 + 9 + 10 = 30$$\n$$r_C = d_{CA} + d_{CB} + d_{CD} + d_{CE} = 8 + 9 + 3 + 8 = 28$$\n$$r_D = d_{DA} + d_{DB} + d_{DC} + d_{DE} = 9 + 9 + 3 + 9 = 30$$\n$$r_E = d_{EA} + d_{EB} + d_{EC} + d_{ED} = 9 + 10 + 8 + 9 = 36$$\n\n接下来，我们使用公式 $Q(i,j) = (n-2)d_{ij} - r_i - r_j$ 来计算 $Q(i,j)$ 值。当 $n=5$ 时，公式变为 $Q(i,j) = 3 d_{ij} - r_i - r_j$。有 $\\binom{5}{2} = 10$ 个唯一的对需要评估。\n\n$Q(A,B) = 3 \\cdot d_{AB} - r_A - r_B = 3(2) - 28 - 30 = 6 - 58 = -52$\n$Q(A,C) = 3 \\cdot d_{AC} - r_A - r_C = 3(8) - 28 - 28 = 24 - 56 = -32$\n$Q(A,D) = 3 \\cdot d_{AD} - r_A - r_D = 3(9) - 28 - 30 = 27 - 58 = -31$\n$Q(A,E) = 3 \\cdot d_{AE} - r_A - r_E = 3(9) - 28 - 36 = 27 - 64 = -37$\n$Q(B,C) = 3 \\cdot d_{BC} - r_B - r_C = 3(9) - 30 - 28 = 27 - 58 = -31$\n$Q(B,D) = 3 \\cdot d_{BD} - r_B - r_D = 3(9) - 30 - 30 = 27 - 60 = -33$\n$Q(B,E) = 3 \\cdot d_{BE} - r_B - r_E = 3(10) - 30 - 36 = 30 - 66 = -36$\n$Q(C,D) = 3 \\cdot d_{CD} - r_C - r_D = 3(3) - 28 - 30 = 9 - 58 = -49$\n$Q(C,E) = 3 \\cdot d_{CE} - r_C - r_E = 3(8) - 28 - 36 = 24 - 64 = -40$\n$Q(D,E) = 3 \\cdot d_{DE} - r_D - r_E = 3(9) - 30 - 36 = 27 - 66 = -39$\n\n比较计算出的 $Q$ 值：$\\{-52, -32, -31, -37, -31, -33, -36, -49, -40, -39\\}$。最小值是 $-52$，对应于对 $\\{A, B\\}$。这是第一个凝聚的对。\n\n要求最终报告的量是这个最小的 $Q$ 值。但是，为了按指示保持完整性，我们继续构建循环排序。\n\n初始排序为 $(A, B)$。排序的两端是 $u=A$ 和 $v=B$。剩余未放置的分类单元为 $\\{C, D, E\\}$。\n\n**迭代 1：**\n我们必须从 $\\{C, D, E\\}$ 中选择使 $\\min\\{d_{Ax}, d_{Bx}\\}$ 最小的分类单元 $x$。\n- 对于 $x=C$：$\\min\\{d_{AC}, d_{BC}\\} = \\min\\{8, 9\\} = 8$。\n- 对于 $x=D$：$\\min\\{d_{AD}, d_{BD}\\} = \\min\\{9, 9\\} = 9$。\n- 对于 $x=E$：$\\min\\{d_{AE}, d_{BE}\\} = \\min\\{9, 10\\} = 9$。\n最小值为 $8$，所以我们选择分类单元 $C$。我们将 $C$ 附加到它更近的一端。由于 $d_{AC} = 8$ 小于 $d_{BC} = 9$，我们将 $C$ 附加到 $A$ 端。\n新的排序是 $(C, A, B)$。现在的两端是 $u=C$ 和 $v=B$。剩余的分类单元是 $\\{D, E\\}$。\n\n**迭代 2：**\n我们从 $\\{D, E\\}$ 中选择使 $\\min\\{d_{Cx}, d_{Bx}\\}$ 最小的分类单元 $x$。\n- 对于 $x=D$：$\\min\\{d_{CD}, d_{BD}\\} = \\min\\{3, 9\\} = 3$。\n- 对于 $x=E$：$\\min\\{d_{CE}, d_{BE}\\} = \\min\\{8, 10\\} = 8$。\n最小值为 $3$，所以我们选择分类单元 $D$。我们将 $D$ 附加到它更近的一端。由于 $d_{CD} = 3$ 小于 $d_{BD} = 9$，我们将 $D$ 附加到 $C$ 端。\n新的排序是 $(D, C, A, B)$。现在的两端是 $u=D$ 和 $v=B$。唯一剩余的分类单元是 $\\{E\\}$。\n\n**迭代 3：**\n最后一个分类单元是 $E$。我们必须将其附加到 $D$ 端或 $B$ 端。\n我们比较 $d_{DE} = 9$ 和 $d_{BE} = 10$。由于 $d_{DE} < d_{BE}$，我们将 $E$ 附加到 $D$ 端。\n最终的线性排序是 $(E, D, C, A, B)$。这对应于循环排序 $(A-B-E-D-C-A)$。\n\n因此，中间计算过程如下：\n- 行和：$r_A=28, r_B=30, r_C=28, r_D=30, r_E=36$。\n- $Q$ 值：$Q(A,B)=-52$, $Q(A,C)=-32$, $Q(A,D)=-31$, $Q(A,E)=-37$, $Q(B,C)=-31$, $Q(B,D)=-33$, $Q(B,E)=-36$, $Q(C,D)=-49$, $Q(C,E)=-40$, $Q(D,E)=-39$。\n- 所选的对：$\\{A, B\\}$，最小 $Q$ 值为 $-52$。\n- 构建的循环排序：$(A, B, E, D, C)$（不区分旋转和反转）。\n\n问题要求的是为第一次凝聚找到的最小 $Q$ 值。该值已被确定为 $-52$。",
            "answer": "$$\\boxed{-52}$$"
        },
        {
            "introduction": "系统发育网络不仅仅是一个静态的图；它是一个生成模型，预测了在网状进化过程中可能出现的不同基因树拓扑的概率分布。理解一个给定的网络如何产生特定的基因树是诠释其生物学意义的关键。通过这个练习，您将计算在一个具有特定遗传概率 ($\\gamma$) 的网络中，产生一个特定基因树拓扑的精确概率，从而深入理解网络模型与其预测能力之间的联系。",
            "id": "2743232",
            "problem": "一个以叶节点 $a$、 $b$、$c$ 和 $d$ 为基础的有根二叉系统发育网络定义如下。根节点 $\\rho$ 在一个内部分叉处分裂成两个祖先世系，产生内部节点 $L$ 和 $M$。节点 $L$ 物种形成叶节点 $a$ 和一个延续世系 $L'$。节点 $M$ 物种形成叶节点 $d$ 和一个延续世系 $M'$。随后发生两个网状进化事件：\n- 网状进化 $R_1$ 的父节点为 $L'$ 和 $M'$，其唯一的子节点直接导向叶节点 $b$。在此网状进化中，单个基因座由父节点 $L'$ 继承的遗传概率为 $\\gamma_1$，由 $M'$ 继承的概率为 $1-\\gamma_1$。\n- 网状进化 $R_2$ 的父节点为 $L'$ 和 $M'$，其唯一的子节点直接导向叶节点 $c$。在此网状进化中，单个基因座由父节点 $L'$ 继承的遗传概率为 $\\gamma_2$，由 $M'$ 继承的概率为 $1-\\gamma_2$。\n\n假设网状进化遵循标准的单基因座、无重组模型：在每个网状进化点，根据其遗传概率精确选择一条传入的亲代边，不同网状进化点的选择是相互独立的，并且通过抑制所有入度为1和出度为1的节点，将得到的有向无环图简化为所展示的有根树。\n\n设遗传概率为 $\\gamma_1 = 0.73$ 和 $\\gamma_2 = 0.41$。计算所展示的有根树具有拓扑结构 $T = ((a,b),(c,d))$ 的概率。以 $[0,1]$ 范围内的精确小数形式给出答案。",
            "solution": "该问题要求计算在单基因座遗传模型下，从一个给定的系统发育网络中实现特定有根树拓扑结构 $T = ((a,b),(c,d))$ 的概率。该过程由网状进化事件中的随机选择决定。\n\n首先，我们必须形式化系统发育网络的结构以及从中生成树的过程。该网络包含四个叶节点：$a$、$b$、$c$ 和 $d$。根节点 $\\rho$ 分叉为节点 $L$ 和 $M$。节点 $L$ 产生叶节点 $a$ 和一个内部世系 $L'$。节点 $M$ 产生叶节点 $d$ 和一个内部世系 $M'$。存在两个网状进化节点 $R_1$ 和 $R_2$，它们分别决定了叶节点 $b$ 和 $c$ 的祖先。$R_1$ 和 $R_2$ 具有相同的父系世系，$L'$ 和 $M'$。\n\n通过解析每个网状进化来生成单基因座树。在每个网状进化节点，选择两个父系世系中的一个。这些选择是独立事件。\n- 对于源自网状进化 $R_1$ 的叶节点 $b$，其父系世系是 $L'$ 的概率为 $\\gamma_1$，是 $M'$ 的概率为 $1-\\gamma_1$。\n- 对于源自网状进化 $R_2$ 的叶节点 $c$，其父系世系是 $L'$ 的概率为 $\\gamma_2$，是 $M'$ 的概率为 $1-\\gamma_2$。\n\n由于存在两个独立的二元选择，因此有 $2 \\times 2 = 4$ 种可能的生成树。我们必须分析这四种可能结果中每一种的拓扑结构，并计算它们各自的概率。\n\n我们用 $x \\leftarrow P$ 表示叶节点 $x$ 的父系选择，其中 $P$ 是父系世系。\n\n情况1：$b \\leftarrow L'$ 且 $c \\leftarrow L'$。\n此联合事件的概率为 $P_1 = \\gamma_1 \\gamma_2$。\n在这种情况下，从根节点 $\\rho$ 到各叶节点的路径如下：\n- 到 $a$ 的路径：$\\rho \\to L \\to a$\n- 到 $b$ 的路径：$\\rho \\to L \\to L' \\to R_1 \\to b$\n- 到 $c$ 的路径：$\\rho \\to L \\to L' \\to R_2 \\to c$\n- 到 $d$ 的路径：$\\rho \\to M \\to d$\n叶节点 $b$ 和 $c$ 的最近共同祖先 (MRCA) 是节点 $L'$ 的后代。$a$ 与 $(b,c)$ 对的 MRCA 是节点 $L$。分支 $(a,b,c)$ 与叶节点 $d$ 的 MRCA 是根节点 $\\rho$。在抑制入度为1和出度为1的节点后，得到的树拓扑结构为 $((a,(b,c)),d)$。这不是目标拓扑结构。\n\n情况2：$b \\leftarrow L'$ 且 $c \\leftarrow M'$。\n此联合事件的概率为 $P_2 = \\gamma_1 (1-\\gamma_2)$。\n从根节点 $\\rho$ 到各叶节点的路径如下：\n- 到 $a$ 的路径：$\\rho \\to L \\to a$\n- 到 $b$ 的路径：$\\rho \\to L \\to L' \\to R_1 \\to b$\n- 到 $d$ 的路径：$\\rho \\to M \\to d$\n- 到 $c$ 的路径：$\\rho \\to M \\to M' \\to R_2 \\to c$\n在抑制单分叉节点（如 $L'$、$M'$、$R_1$、$R_2$）后，基本的分支结构变为：\n- 通往 $a$ 的世系和通往 $b$ 的世系在节点 $L$ 处合并。因此，MRCA($a,b$) 是 $L$。\n- 通往 $c$ 的世系和通往 $d$ 的世系在节点 $M$ 处合并。因此，MRCA($c,d$) 是 $M$。\n两个分支 $(a,b)$ 和 $(c,d)$ 在根节点 $\\rho$ 处合并。\n得到的树拓扑结构为 $((a,b),(c,d))$。这与目标拓扑结构 $T$ 相匹配。\n\n情况3：$b \\leftarrow M'$ 且 $c \\leftarrow L'$。\n此联合事件的概率为 $P_3 = (1-\\gamma_1) \\gamma_2$。\n从根节点 $\\rho$ 到各叶节点的路径如下：\n- 到 $a$ 的路径：$\\rho \\to L \\to a$\n- 到 $c$ 的路径：$\\rho \\to L \\to L' \\to R_2 \\to c$\n- 到 $d$ 的路径：$\\rho \\to M \\to d$\n- 到 $b$ 的路径：$\\rho \\to M \\to M' \\to R_1 \\to b$\n通过与情况2类似的分析，MRCA($a,c$) 是节点 $L$，而 MRCA($b,d$) 是节点 $M$。得到的树拓扑结构为 $((a,c),(b,d))$。这不是目标拓扑结构。\n\n情况4：$b \\leftarrow M'$ 且 $c \\leftarrow M'$。\n此联合事件的概率为 $P_4 = (1-\\gamma_1) (1-\\gamma_2)$。\n从根节点 $\\rho$ 到各叶节点的路径如下：\n- 到 $a$ 的路径：$\\rho \\to L \\to a$\n- 到 $b$ 的路径：$\\rho \\to M \\to M' \\to R_1 \\to b$\n- 到 $c$ 的路径：$\\rho \\to M \\to M' \\to R_2 \\to c$\n- 到 $d$ 的路径：$\\rho \\to M \\to d$\n$b$ 和 $c$ 的 MRCA 是节点 $M'$ 的后代。$(b,c)$ 对与叶节点 $d$ 的 MRCA 是节点 $M$。分支 $(b,c,d)$ 与叶节点 $a$ 的 MRCA 是根节点 $\\rho$。得到的树拓扑结构为 $(a,(d,(b,c)))$，也可以写作 $(a,((b,c),d))$。这不是目标拓扑结构。\n\n目标拓扑结构 $T = ((a,b),(c,d))$ 仅由情况2产生。因此，观察到拓扑结构 $T$ 的概率，记为 $P(T)$，等于情况2的概率。\n$$P(T) = P_2 = \\gamma_1 (1 - \\gamma_2)$$\n我们已知遗传概率的数值为：$\\gamma_1 = 0.73$ 和 $\\gamma_2 = 0.41$。将这些值代入 $P(T)$ 的表达式中：\n$$P(T) = 0.73 \\times (1 - 0.41)$$\n$$P(T) = 0.73 \\times 0.59$$\n计算很简单：\n$$P(T) = 0.4307$$\n此结果是所要求的精确小数。",
            "answer": "$$\\boxed{0.4307}$$"
        },
        {
            "introduction": "在系统发育基因组学中，基因树之间的不一致性很常见，但这并非总是由网状进化（如杂交）引起。不完全谱系分选 (ILS) 是另一个主要原因，因此区分这两种信号是推断进化历史时的关键挑战。本练习介绍了一种基于四重奏协同因子的定量检验方法，让您能够判断观测到的基因树冲突是否可以仅用多物种溯祖模型下的 ILS 来解释，还是需要更复杂的网状进化模型。",
            "id": "2743287",
            "problem": "考虑一个由四个物种组成的单元，其有三种可能的无根基因树拓扑，由分裂 $(ab|cd)$、$(ac|bd)$ 和 $(ad|bc)$ 表示。设观察到的四物种单元协调因子（支持三种已解析拓扑中每一种的基因座比例）为 $(q_{ab|cd}, q_{ac|bd}, q_{ad|bc})$，其满足 $q_{ab|cd} + q_{ac|bd} + q_{ad|bc} = 1$ 且对于所有三种拓扑都有 $q_{ij|kl} \\ge 0$。假设有大量独立的基因座，因此可以忽略抽样噪音，并假设采用无基因流的多物种溯祖 (MSC) 模型，物种树上有一个长度为 $x$（以溯祖单位计）的内部分支。在没有网状进化的情况下，根据 MSC 模型，不完全谱系分选 (ILS) 是与主导拓扑不一致的唯一来源。\n\n从 MSC 的第一性原理出发（谱系在种群内以每对每溯祖单位为 1 的速率发生溯祖；未在内部分支上发生溯祖的谱系会进入祖先种群，其中三个谱系间的成对溯祖是可交换的），推导当不一致性仅由某个物种树拓扑和某个内部分支长度 $x \\ge 0$ 上的 ILS 引起时，期望的协调因子三元组必须满足的充要条件。使用这些约束条件来检验一个给定的观测三元组是否可以仅由主导拓扑（三元组中具有最大坐标值的拓扑）的 ILS 来解释。\n\n对于下面的每个选项，三元组按 $(q_{ab|cd}, q_{ac|bd}, q_{ad|bc})$ 的顺序列出。选择所有选项，其中与主导拓扑的偏差可以完全由 MSC 模型下某个内部分支长度 $x \\ge 0$ 的 ILS 解释（即，该三元组位于其主导拓扑的 MSC 溯祖锥内）。\n\nA. $\\left(\\dfrac{29}{50}, \\dfrac{21}{100}, \\dfrac{21}{100}\\right)$\n\nB. $\\left(\\dfrac{2}{5}, \\dfrac{3}{10}, \\dfrac{3}{10}\\right)$\n\nC. $\\left(\\dfrac{7}{10}, \\dfrac{1}{10}, \\dfrac{2}{10}\\right)$\n\nD. $\\left(\\dfrac{8}{25}, \\dfrac{17}{50}, \\dfrac{17}{50}\\right)$",
            "solution": "该问题要求在多物种溯祖 (MSC) 模型下，推导四物种单元协调因子 $(q_{ab|cd}, q_{ac|bd}, q_{ad|bc})$ 所受的约束条件，其中不完全谱系分选 (ILS) 是基因树不一致的唯一来源。然后，将使用这些约束条件来评估给定的四个协调因子三元组的有效性。\n\n我们首先推导期望协调因子与物种树内部分支长度之间的关系。不失一般性，假设无根物种树拓扑为 $((a,b),(c,d))$，对应于分裂 $(ab|cd)$。设将 $(a,b)$ 进化支与 $(c,d)$ 进化支分离开的内部分支长度为 $x$，以溯祖单位计量。根据题意，我们假设有大量独立的基因座，因此观察到的协调因子 $q$ 可以视为每种基因树拓扑的期望概率 $p$。\n\n设 $p_{ab|cd}$、$p_{ac|bd}$ 和 $p_{ad|bc}$ 分别为观察到四物种单元三种可能无根基因树拓扑的概率。在 MSC 模型下，基因树拓扑由追溯来自每个物种 $\\{a,b,c,d\\}$ 的四个谱系（每个物种一个）时，溯祖事件的序列所决定。\n\n问题陈述为推导提供了一个关键提示：“未在内部分支上发生溯祖的谱系会进入祖先种群，其中三个谱系间的成对溯祖是可交换的”。这描述了三分类单元树的标准模型，我们可以将其应用于四分类单元的情况。考虑物种树 $((a,b),(c,d))$，让我们从现在开始向后追溯谱系 $l_a, l_b, l_c, l_d$。由于假设有大量从平稳过程中抽取的基因座，我们可以通过首先假设其中两个谱系（例如 $l_c$ 和 $l_d$）已经溯祖成单个祖先谱系 $L_{cd}$ 来将此过程概念化。现在，我们考虑三个谱系 $l_a、l_b$ 和 $L_{cd}$ 在物种树 $((a,b), (cd))$ 上的演化。\n\n谱系 $l_a$ 和 $l_b$ 进入它们的共同祖先种群，该种群在与包含谱系 $L_{cd}$ 的种群合并之前，存在的时间对应于长度为 $x$ 的内部分支。\n\n两个谱系 $l_a$ 和 $l_b$ 在这个长度为 $x$ 的分支内发生溯祖的概率由 $P(\\text{coalesce}) = 1 - e^{-x}$ 给出。如果发生此事件，所得的基因树将首先将 $a$ 和 $b$ 组合在一起，产生拓扑 $(ab|cd)$，这与物种树一致。\n\n谱系 $l_a$ 和 $l_b$ 未能在此内部分支上溯祖的概率为 $P(\\text{no coalesce}) = e^{-x}$。在这种情况下，三个不同的谱系——$l_a$、$l_b$ 和 $L_{cd}$——进入三分类单元子树根部的更深层祖先种群。在这个深层种群中，物种树是未解析的（“星状”系统发育），任何一对谱系首先发生溯祖的可能性都是相同的。三种可能的配对是 $(l_a, l_b)$、$(l_a, L_{cd})$ 和 $(l_b, L_{cd})$。每对成为第一个溯祖的概率都是 $\\dfrac{1}{3}$。\n\n*   如果 $(l_a, l_b)$ 首先溯祖，则基因树拓扑为 $(ab|cd)$。此路径的概率为 $e^{-x} \\cdot \\dfrac{1}{3}$。\n*   如果 $(l_a, L_{cd})$ 首先溯祖，谱系 $a$ 与 $c$ 和 $d$ 的祖先组合在一起。无根拓扑为 $((a,(c,d)),b)$，对应于分裂 $(ac|bd)$。此路径的概率为 $e^{-x} \\cdot \\dfrac{1}{3}$。\n*   如果 $(l_b, L_{cd})$ 首先溯祖，谱系 $b$ 与 $c$ 和 $d$ 的祖先组合在一起。无根拓扑为 $((b,(c,d)),a)$，对应于分裂 $(ad|bc)$。此路径的概率为 $e^{-x} \\cdot \\dfrac{1}{3}$。\n\n将每种拓扑的概率相加：\n与物种树一致的拓扑 $(ab|cd)$ 的概率是内部分支上溯祖的概率与在深层祖先种群中相应溯祖的概率之和：\n$$p_{ab|cd} = (1 - e^{-x}) + \\dfrac{1}{3}e^{-x} = 1 - \\dfrac{2}{3}e^{-x}$$\n两种不一致拓扑的概率为：\n$$p_{ac|bd} = \\dfrac{1}{3}e^{-x}$$\n$$p_{ad|bc} = \\dfrac{1}{3}e^{-x}$$\n\n设主导拓扑的观察协调因子为 $q_1$，两个次要拓扑的协调因子为 $q_2$ 和 $q_3$。要使数据能够仅由某个物种树上的 ILS 解释，必须满足以下充要条件：\n1.  两个次要的（不一致的）协调因子必须相等：$q_2 = q_3$。这是由深层祖先种群中溯祖过程的对称性产生的。\n2.  分支长度 $x$ 必须为非负数，$x \\ge 0$。关系 $q_2 = \\dfrac{1}{3}e^{-x}$ 意味着 $e^{-x} = 3q_2$。对于 $x \\ge 0$，我们需要 $e^{-x} \\le 1$，即 $3q_2 \\le 1$，或 $q_2 \\le \\dfrac{1}{3}$。由于 $q_3 = q_2$，这也意味着 $q_3 \\le \\dfrac{1}{3}$。\n\n条件 $q_1+2q_2=1$（因为 $q_2=q_3$ 且 $\\sum q_i=1$）在第一个条件满足且各因子总和为 1 时自动满足。条件 $q_1 \\ge 1/3$ 是 $q_2 \\le 1/3$ 的直接结果。因此，对于给定的三元组，其中 $q_1$ 是最大坐标值，约束条件简化为：\n(i) 两个较小的坐标值必须相等。\n(ii) 较小坐标值的值不得超过 $\\dfrac{1}{3}$。\n\n我们现在根据这些约束条件来检验每个选项。\n\n**A. $\\left(\\dfrac{29}{50}, \\dfrac{21}{100}, \\dfrac{21}{100}\\right)$**\n让我们将坐标写成小数形式：$(0.58, 0.21, 0.21)$。\n主导拓扑是第一个，其 $q_1 = 0.58$。次要协调因子是 $q_2 = 0.21$ 和 $q_3 = 0.21$。\n1.  检查次要因子是否相等：$q_2 = q_3$ ($0.21 = 0.21$)。此条件满足。\n2.  检查次要因子的上限：$q_2 = 0.21 \\le \\dfrac{1}{3} \\approx 0.333$。此条件满足。\n两个条件都满足。这个三元组可以仅由拓扑为 $(ab|cd)$ 的物种树上的 ILS 解释。相应的内部分支长度为 $x = -\\ln(3q_2) = -\\ln(3 \\times 0.21) = -\\ln(0.63) \\ge 0$。\n**结论：正确**\n\n**B. $\\left(\\dfrac{2}{5}, \\dfrac{3}{10}, \\dfrac{3}{10}\\right)$**\n让我们将坐标写成小数形式：$(0.4, 0.3, 0.3)$。\n主导拓扑是第一个，其 $q_1 = 0.4$。次要协调因子是 $q_2 = 0.3$ 和 $q_3 = 0.3$。\n1.  检查次要因子是否相等：$q_2 = q_3$ ($0.3 = 0.3$)。此条件满足。\n2.  检查次要因子的上限：$q_2 = 0.3 \\le \\dfrac{1}{3} \\approx 0.333$。此条件满足。\n两个条件都满足。这个三元组可以仅由拓扑为 $(ab|cd)$ 的物种树上的 ILS 解释。相应的内部分支长度为 $x = -\\ln(3q_2) = -\\ln(3 \\times 0.3) = -\\ln(0.9) \\ge 0$。\n**结论：正确**\n\n**C. $\\left(\\dfrac{7}{10}, \\dfrac{1}{10}, \\dfrac{2}{10}\\right)$**\n让我们将坐标写成小数形式：$(0.7, 0.1, 0.2)$。\n主导拓扑是第一个，其 $q_1 = 0.7$。次要协调因子是 $q_2 = 0.1$ 和 $q_3 = 0.2$。\n1.  检查次要因子是否相等：$q_2 \\ne q_3$ ($0.1 \\ne 0.2$)。此条件不满足。\n不一致拓扑中的不对称性无法仅由 ILS 解释，这表明可能存在其他进化过程，例如网状进化。\n**结论：不正确**\n\n**D. $\\left(\\dfrac{8}{25}, \\dfrac{17}{50}, \\dfrac{17}{50}\\right)$**\n让我们将坐标写成小数形式：$(0.32, 0.34, 0.34)$。\n最大的坐标值为 $0.34$，对应于两种拓扑：$(ac|bd)$ 和 $(ad|bc)$。没有唯一的主导拓扑。问题要求评估相对于主导拓扑的一致性。这种情况是模糊的，但我们可以测试每种可能性。\n让我们假设物种树对应于拓扑 $(ac|bd)$。那么主导协调因子是 $q_1' = q_{ac|bd} = 0.34$。两个次要因子必须是另外两种拓扑 $(ab|cd)$ 和 $(ad|bc)$ 的频率，即 $q_2' = 0.32$ 和 $q_3' = 0.34$。\n1.  检查次要因子是否相等：$q_2' \\ne q_3'$ ($0.32 \\ne 0.34$)。此条件不满足。\n如果我们假设物种树是 $(ad|bc)$，也会得出相同的结论。\n此外，两个所谓的次要频率必须小于或等于 $\\dfrac{1}{3}$。在这里，一个或两个非主导频率（$0.32$ 和 $0.34$）都有可能是不一致频率。值 $0.34$ 大于 $\\dfrac{1}{3} \\approx 0.333$。在 MSC 模型下，一个不一致的基因树拓扑的概率不能大于 $\\dfrac{1}{3}$。这提供了第二个独立的拒绝理由。\n因此，对于任何物种树拓扑，这个三元组都与 MSC/ILS 模型不一致。\n**结论：不正确**",
            "answer": "$$\\boxed{AB}$$"
        }
    ]
}