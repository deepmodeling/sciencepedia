{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个练习将深入探讨一个估算从现存遗传变异（SGV）进行适应的概率的基础模型。通过进行灵敏度分析，你将对关键的进化参数——例如有效种群大小（$N_e$）、选择强度（$s$）和突变率（$\\mu$）——如何共同决定一个种群是从预先存在的等位基因适应还是等待新突变形成定量的直觉。这个练习对于理解何种生态和人口学条件更有利于某一种适应路径至关重要。",
            "id": "2688410",
            "problem": "在环境变化后快速适应的模型中，对于稀有等位基因，适应来自现有遗传变异而非新突变的概率可以近似为\n$$\nP_{\\text{SGV}} \\approx 1 - \\exp\\!\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right),\n$$\n其中，$N_{e}$是有效种群大小，$s_{b}$是环境变化后等位基因的选择系数（有利的），$s_{d}$是环境变化前等位基因的选择系数（在祖先环境中是有害的），$\\mu$是每一代向目标等位基因的突变率。假设$0 < P_{\\text{SGV}} < 1$且所有参数均为严格正数。\n\n使用微积分和标准敏感性分析的定义，完成以下任务：\n\n1. 计算$P_{\\text{SGV}}$关于$(N_{e}, s_{b}, \\mu, s_{d})$的梯度，即，计算每个偏导数$\\frac{\\partial P_{\\text{SGV}}}{\\partial N_{e}}$、$\\frac{\\partial P_{\\text{SGV}}}{\\partial s_{b}}$、$\\frac{\\partial P_{\\text{SGV}}}{\\partial \\mu}$和$\\frac{\\partial P_{\\text{SGV}}}{\\partial s_{d}}$，并以$N_{e}$、$s_{b}$、$s_{d}$和$\\mu$的符号表达式表示。\n\n2. 将$P_{\\text{SGV}}$关于参数$x$的（无量纲）对数弹性定义为$E_{x} \\equiv \\frac{\\partial \\ln P_{\\text{SGV}}}{\\partial \\ln x} = \\frac{x}{P_{\\text{SGV}}}\\frac{\\partial P_{\\text{SGV}}}{\\partial x}$。用符号推导$E_{N_{e}}$、$E_{s_{b}}$、$E_{\\mu}$和$E_{s_{d}}$，并用它们按绝对值大小对每个参数对$P_{\\text{SGV}}$的影响进行排序。\n\n3. 最后，在下列参数值下计算对数弹性的共同绝对值大小：\n$$\nN_{e} = 10^{5},\\quad s_{b} = 0.02,\\quad s_{d} = 0.01,\\quad \\mu = 2 \\times 10^{-8}.\n$$\n将您的最终答案表示为一个等于该共同绝对对数弹性大小的十进制数，四舍五入到四位有效数字。不需要单位，且该数字必须以小数形式表示（不要使用百分号）。",
            "solution": "所述问题具有科学依据，提法恰当且客观。它基于群体遗传学领域的一个标准近似，并提出了一个数学上易于处理的敏感性分析问题。所有必要的参数和条件都已提供，且内部没有矛盾。因此，该问题是有效的，我们着手进行求解。\n\n设从现有遗传变异中适应的概率为$P_{\\text{SGV}}$。给定的模型是：\n$$\nP_{\\text{SGV}} = 1 - \\exp\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right)\n$$\n其中，$N_{e}$是有效种群大小，$s_{b}$是有利等位基因的选择系数，$s_d$是在祖先环境中有害等位基因的选择系数，$\\mu$是突变率。我们已知所有参数均为严格正数。\n\n为方便起见，我们定义无量纲参数组$X$为：\n$$\nX = \\frac{4 N_{e} s_{b} \\mu}{s_{d}}\n$$\n根据这一定义，$P_{\\text{SGV}} = 1 - \\exp(-X)$。因为给定$0 < P_{\\text{SGV}} < 1$，所以可以得出$X > 0$。\n\n**1. $P_{\\text{SGV}}$的梯度**\n\n$P_{\\text{SGV}}$相对于参数矢量$(N_{e}, s_{b}, \\mu, s_{d})$的梯度是其偏导数的矢量。我们使用链式法则计算每个分量。对于一个通用参数$p \\in \\{N_{e}, s_{b}, \\mu, s_{d}\\}$，其导数为：\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial p} = \\frac{\\partial}{\\partial p} (1 - \\exp(-X)) = -\\exp(-X) \\left(-\\frac{\\partial X}{\\partial p}\\right) = \\exp(-X) \\frac{\\partial X}{\\partial p}\n$$\n现在我们计算$X$对每个参数的偏导数：\n- 关于$N_{e}$：$\\frac{\\partial X}{\\partial N_{e}} = \\frac{4 s_{b} \\mu}{s_{d}}$\n- 关于$s_{b}$：$\\frac{\\partial X}{\\partial s_{b}} = \\frac{4 N_{e} \\mu}{s_{d}}$\n- 关于$\\mu$：$\\frac{\\partial X}{\\partial \\mu} = \\frac{4 N_{e} s_{b}}{s_{d}}$\n- 关于$s_{d}$：$\\frac{\\partial X}{\\partial s_{d}} = \\frac{\\partial}{\\partial s_{d}} (4 N_{e} s_{b} \\mu s_{d}^{-1}) = -4 N_{e} s_{b} \\mu s_{d}^{-2} = -\\frac{4 N_{e} s_{b} \\mu}{s_{d}^{2}}$\n\n将这些代入$\\frac{\\partial P_{\\text{SGV}}}{\\partial p}$的表达式，我们得到梯度的各个分量：\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial N_{e}} = \\frac{4 s_{b} \\mu}{s_{d}} \\exp\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right)\n$$\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial s_{b}} = \\frac{4 N_{e} \\mu}{s_{d}} \\exp\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right)\n$$\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial \\mu} = \\frac{4 N_{e} s_{b}}{s_{d}} \\exp\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right)\n$$\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial s_{d}} = -\\frac{4 N_{e} s_{b} \\mu}{s_{d}^{2}} \\exp\\left(-\\frac{4 N_{e} s_{b} \\mu}{s_{d}}\\right)\n$$\n\n**2. 对数弹性和排序**\n\n$P_{\\text{SGV}}$关于参数$p$的对数弹性定义为$E_{p} = \\frac{p}{P_{\\text{SGV}}} \\frac{\\partial P_{\\text{SGV}}}{\\partial p}$。我们对每个参数计算此值。\n\n对于$N_{e}$、$s_{b}$和$\\mu$，我们可以观察到一个模式。设$p \\in \\{N_{e}, s_{b}, \\mu\\}$。那么$\\frac{\\partial X}{\\partial p} = \\frac{X}{p}$。因此，\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial p} = \\exp(-X) \\frac{X}{p}\n$$\n那么弹性为：\n$$\nE_{p} = \\frac{p}{P_{\\text{SGV}}} \\left( \\exp(-X) \\frac{X}{p} \\right) = \\frac{X \\exp(-X)}{P_{\\text{SGV}}} = \\frac{X \\exp(-X)}{1 - \\exp(-X)}\n$$\n因此，$N_{e}$、$s_{b}$和$\\mu$的弹性是相同的：\n$$\nE_{N_{e}} = E_{s_{b}} = E_{\\mu} = \\frac{X \\exp(-X)}{1 - \\exp(-X)}\n$$\n\n对于$s_{d}$，我们得到$\\frac{\\partial X}{\\partial s_{d}} = -\\frac{X}{s_{d}}$。因此，\n$$\n\\frac{\\partial P_{\\text{SGV}}}{\\partial s_{d}} = \\exp(-X) \\left(-\\frac{X}{s_{d}}\\right) = -\\frac{X \\exp(-X)}{s_{d}}\n$$\n关于$s_{d}$的弹性是：\n$$\nE_{s_{d}} = \\frac{s_{d}}{P_{\\text{SGV}}} \\left(-\\frac{X \\exp(-X)}{s_{d}}\\right) = -\\frac{X \\exp(-X)}{P_{\\text{SGV}}} = -\\frac{X \\exp(-X)}{1 - \\exp(-X)}\n$$\n比较结果，我们看到$E_{s_{d}} = -E_{N_{e}} = -E_{s_{b}} = -E_{\\mu}$。\n\n为了按绝对值大小对各参数的影响进行排序，我们计算每个弹性的绝对值：\n$$\n|E_{N_{e}}| = |E_{s_{b}}| = |E_{\\mu}| = |E_{s_{d}}| = \\left|\\frac{X \\exp(-X)}{1 - \\exp(-X)}\\right| = \\frac{X \\exp(-X)}{1 - \\exp(-X)}\n$$\n最后一个等式成立，因为$X > 0$，所以$\\exp(-X) > 0$且$1 - \\exp(-X) > 0$。\n由于所有四个参数的对数弹性绝对值相同，因此就它们对$P_{\\text{SGV}}$的比例影响而言，它们的排名是相同的。\n\n**3. 数值计算**\n\n我们现在必须在给定的参数值下计算对数弹性的共同绝对值大小：\n$N_{e} = 10^{5}$，$s_{b} = 0.02$，$s_{d} = 0.01$，以及$\\mu = 2 \\times 10^{-8}$。\n\n首先，我们计算$X$的值：\n$$\nX = \\frac{4 N_{e} s_{b} \\mu}{s_{d}} = \\frac{4 \\times (10^{5}) \\times (0.02) \\times (2 \\times 10^{-8})}{0.01}\n$$\n$$\nX = \\frac{4 \\times 10^{5} \\times 2 \\times 10^{-2} \\times 2 \\times 10^{-8}}{10^{-2}} = \\frac{16 \\times 10^{5-2-8}}{10^{-2}} = \\frac{16 \\times 10^{-5}}{10^{-2}} = 16 \\times 10^{-3} = 0.016\n$$\n现在，我们计算共同的绝对弹性，记为$E_{\\text{abs}}$：\n$$\nE_{\\text{abs}} = \\frac{X \\exp(-X)}{1 - \\exp(-X)} = \\frac{X}{\\exp(X) - 1}\n$$\n代入$X = 0.016$：\n$$\nE_{\\text{abs}} = \\frac{0.016}{\\exp(0.016) - 1}\n$$\n使用计算器计算指数函数：\n$\\exp(0.016) \\approx 1.01612885$\n$$\nE_{\\text{abs}} \\approx \\frac{0.016}{1.01612885 - 1} = \\frac{0.016}{0.01612885} \\approx 0.992013038\n$$\n按照问题要求，四舍五入到四位有效数字，我们得到$0.9920$。\n这个值代表了共同的绝对对数弹性大小。",
            "answer": "$$\\boxed{0.9920}$$"
        },
        {
            "introduction": "区分从现存遗传变异（SGV）适应还是从新生突变（*de novo*）适应并非总是那么直截了当，因为不同的进化历史有时会产生相似的结果。这个练习是一个思想实验，旨在阐释这种“殊途同归”的原理，你将推导出在何种条件下，SGV情景下的等位基因频率可以在特定时间点完美地模仿新生突变情景下的频率。理解这种潜在的模糊性是让你领会为何群体遗传学家依赖特定类型数据（如单倍型结构或时间序列信息）来解析适应起源的根本原因。",
            "id": "2688422",
            "problem": "一个有效种群大小为 $N$ 的大型单倍体种群在时间 $t=0$ 时经历了一次突然的环境变化，这使得某个特定等位基因变得有益，其选择系数为 $s>0$。考虑该适应性等位基因起源的两种替代模型：\n\n- 存量遗传变异 (SGV) 模型：在 $t=0$ 时，该等位基因已存在，频率为 $p_0 \\in (0,1)$。\n- 新生复发突变模型：在 $t=0$ 时该等位基因不存在，而是以每个基因组每代 $U_b$ 次突变的速率通过新的有益突变产生。\n\n假定世代不重叠、随机交配、无显性（单倍体），且 $N$ 足够大，$s$ 足够小，使得在选择清除的早期阶段，当 $p(t) \\ll 1$ 时，以下经过充分检验的近似成立：\n\n- 有益等位基因的确定性选择动态满足 $dp/dt = s\\,p\\,(1-p)$，当 $p \\ll 1$ 时，这简化为 $dp/dt \\approx s\\,p$。\n- 一个选择系数为 $s$ 的新产生有益突变体的建立概率约为 $2s$。\n- 当一个新的有益谱系逃脱遗传漂变后，它以约为 $p^{\\ast} \\approx \\frac{1}{2 N s}$ 的有效频率进入确定性增长阶段。\n- 在具有复发有益输入的新生突变模型中，此类已建立谱系的出现速率为 $N U_b \\times 2s$，并且在 $p \\ll 1$ 的情况下，它们对等位基因频率动态的总贡献可以表示为一个恒定的流入项。\n\n设 $T>0$ 为一个固定的观察时间（以代为单位）。仅使用这些基础理论，完成以下任务：\n\n1. 推导 SGV 模型下的早期阶段预期等位基因频率轨迹 $p_{\\mathrm{SGV}}(t)$ 和新生突变模型下的 $p_{\\mathrm{DN}}(t)$。\n2. 通过设定 $p_{\\mathrm{SGV}}(T) = p_{\\mathrm{DN}}(T)$ 的条件，符号求解使两种模型在时间 $T$ 预测出相同等位基因频率的 $U_b^{\\ast}$ 值（作为 $s$、$p_0$ 和 $T$ 的函数）。请以每个基因组每代的突变次数为单位，报告 $U_b^{\\ast}$ 的最终表达式。\n3. 根据你的推导，简要解释为什么在你找到的参数组合下，这两种模型在时间 $T$ 会产生无法区分的数据，并指出至少两种在实践中能够区分这两种模型的额外数据类型。你的解释不属于最终数值或符号答案的一部分。\n\n你的最终答案必须是 $U_b^{\\ast}$ 的单一封闭形式解析表达式。无需进行四舍五入。",
            "solution": "所提出的问题是理论群体遗传学中一个标准的、形式良好的练习。它具有科学依据、内部逻辑一致，并且需要应用基本原理。我们将着手进行推导。\n\n问题要求完成三项任务。我们按顺序进行处理。\n\n**1. 等位基因频率轨迹的推导**\n\n我们必须在等位基因频率 $p(t)$ 远小于 1 ($p(t) \\ll 1$) 的假设下，推导预期的等位基因频率轨迹 $p_{\\mathrm{SGV}}(t)$ 和 $p_{\\mathrm{DN}}(t)$。\n\n*   **存量遗传变异 (SGV) 模型：**\n    在此模型中，有益等位基因在时间 $t=0$ 时已存在于种群中，初始频率为 $p_{0}$。其动态由确定性选择主导。为选择清除早期阶段提供的微分方程是：\n    $$\n    \\frac{dp}{dt} \\approx s p\n    $$\n    这是一个表示指数增长的一阶线性常微分方程。在初始条件 $p(0) = p_{0}$下，通过直接积分求解：\n    $$\n    \\int_{p_{0}}^{p_{\\mathrm{SGV}}(t)} \\frac{dp}{p} = \\int_{0}^{t} s \\, d\\tau\n    $$\n    $$\n    \\ln\\left(\\frac{p_{\\mathrm{SGV}}(t)}{p_{0}}\\right) = st\n    $$\n    对两边取指数，得到 SGV 模型的轨迹：\n    $$\n    p_{\\mathrm{SGV}}(t) = p_{0} \\exp(st)\n    $$\n\n*   **新生复发突变 (DN) 模型：**\n    在此模型中，等位基因在 $t=0$ 时不存在，所以 $p(0) = 0$。新的有益等位基因通过突变产生，速率为每个基因组每代 $U_b$ 次。这些新突变体必须逃脱随机丢失（遗传漂变），才能对确定性的频率增加做出贡献。问题陈述一个新突变体的建立概率为 $2s$，因此在大小为 $N$ 的种群中，*已建立*谱系的出现速率为 $N U_b \\times 2s$。\n    \n    问题进一步指明，这些持续产生的新谱系的总贡献可以被建模为等位基因频率动态中的一个恒定流入项。等位基因频率的增长率 $dp/dt$ 是两项之和：现有有益等位基因的增长 ($s p$) 和来自新的、已建立的突变的流入。\n    \n    在一个时间间隔 $dt$ 内，新建谱系的数量为 $2 N s U_b dt$。每个这样的谱系在逃脱漂变后，实际上以 $p^{\\ast} \\approx \\frac{1}{2Ns}$ 的频率进入确定性阶段。因此，频率流入速率是谱系建立速率与每个谱系起始频率的乘积：\n    $$\n    \\text{流入速率} = (2 N s U_b) \\times \\left(\\frac{1}{2Ns}\\right) = U_b\n    $$\n    这证实了 $U_b$ 是恒定的流入项。因此，DN 模型的主导微分方程是：\n    $$\n    \\frac{dp}{dt} = s p + U_b\n    $$\n    这是一个一阶线性非齐次微分方程。我们使用积分因子 $I(t) = \\exp\\left(-\\int s \\, dt\\right) = \\exp(-st)$ 来求解。将方程乘以 $I(t)$ 得到：\n    $$\n    \\exp(-st)\\frac{dp}{dt} - s\\exp(-st)p = U_b \\exp(-st)\n    $$\n    左边是 $p(t)\\exp(-st)$ 对 $t$ 的导数。\n    $$\n    \\frac{d}{dt}\\left(p(t)\\exp(-st)\\right) = U_b \\exp(-st)\n    $$\n    从 $\\tau=0$ 到 $\\tau=t$ 进行积分，并应用初始条件 $p(0)=0$：\n    $$\n    p_{\\mathrm{DN}}(t)\\exp(-st) - p_{\\mathrm{DN}}(0)\\exp(0) = \\int_{0}^{t} U_b \\exp(-s\\tau) \\, d\\tau\n    $$\n    $$\n    p_{\\mathrm{DN}}(t)\\exp(-st) = U_b \\left[ -\\frac{1}{s}\\exp(-s\\tau) \\right]_{0}^{t}\n    $$\n    $$\n    p_{\\mathrm{DN}}(t)\\exp(-st) = -\\frac{U_b}{s} (\\exp(-st) - \\exp(0)) = \\frac{U_b}{s} (1 - \\exp(-st))\n    $$\n    乘以 $\\exp(st)$，得到 DN 模型的轨迹：\n    $$\n    p_{\\mathrm{DN}}(t) = \\frac{U_b}{s} (\\exp(st) - 1)\n    $$\n\n**2. 等效突变率 $U_b^{\\ast}$ 的计算**\n\n我们需要找到一个特定的突变率，记为 $U_b^{\\ast}$，它使得两个模型在一个固定的观察时间 $T > 0$ 时预测出相同的等位基因频率。我们设定 $p_{\\mathrm{SGV}}(T) = p_{\\mathrm{DN}}(T)$：\n$$\np_{0} \\exp(sT) = \\frac{U_b^{\\ast}}{s} (\\exp(sT) - 1)\n$$\n求解 $U_b^{\\ast}$ 是一个代数重排的问题：\n$$\nU_b^{\\ast} = s p_{0} \\frac{\\exp(sT)}{\\exp(sT) - 1}\n$$\n该表达式给出了新生突变模型所需的有益突变率，以便在经过 $T$ 代选择后，其最终频率能与一个初始频率为 $p_0$ 的存量变异的最终频率相匹配。\n\n**3. 关于不可区分性及区分数据的解释**\n\n这两种截然不同的演化历史之所以能在单个时间点 $T$ 产生相同的等位基因频率，是因为一个过程涉及单个、较早出现的变体在长时间内的指数增长，而另一个过程涉及大量持续产生的、较年轻变体的积分式指数增长。SGV 模型的最终频率 $p_0 \\exp(sT)$ 是将初始状态 $p_0$ 在整个持续时间 $T$ 内放大的结果。DN 模型的最终频率 $\\frac{U_b}{s}(\\exp(sT)-1)$ 是来自许多谱系的频率总和，每个谱系都从很小的频率开始，增长了不超过 $T$ 的时间。我们推导出的 $U_b^{\\ast}$ 等价关系揭示了初始频率 $p_0$ 和突变率 $U_b$ 之间的精确数学权衡，正是这种权衡使得这两个不同的总和在时间 $T$ 产生相同的结果。仅仅观察这个单一终点，我们无法解析其潜在的时间动态。\n\n为了在实践中区分 SGV 和新生突变模型，需要的数据必须对适应性等位基因的历史敏感，而不仅仅是其最终频率。两种主要类型的数据会很有效：\n\n1.  **单倍型结构**：源自单个存量变异的适应（“硬清除”）意味着有益等位基因及其所在原始染色体上的一个大型连锁片段（即单倍型）会一同被席卷至高频。结果是在受选择位点周围形成一个遗传多样性极低的区域，几乎所有个体都携带相同的长程单倍型。相比之下，源自复发新生突变的适应（“软清除”）意味着有益等位基因在多个不同的遗传背景上独立出现。因此，有益等位基因将存在于几个不同的单倍型上，受选择位点周围的多样性降低程度也不会那么严重。对样本个体中受选择位点周围的基因组区域进行测序，就能揭示这种单倍型多样性的差异。\n\n2.  **时间序列等位基因频率数据**：如果能在到达 $T$ 之前的多个时间点测量等位基因频率（例如，通过古DNA或在实验室演化实验中），则可以通过轨迹的函数形式来区分这两种模型。对于 SGV 模型，$\\ln(p(t))$ 对 $t$ 的曲线图是一条直线，即 $\\ln(p(t)) = \\ln(p_0) + st$，其 y 轴截距为 $\\ln(p_0)$。而对于 DN 模型，同样的图会显示一条曲线，即 $\\ln(p(t)) = \\ln\\left(\\frac{U_b}{s}\\right) + \\ln(\\exp(st)-1)$，它对 $t$ 并非线性，并且当 $t \\to 0$ 时会趋近于 $-\\infty$。将这些不同的数学模型拟合到时间序列数据上，将有助于进行稳健的模型选择。",
            "answer": "$$\n\\boxed{s p_{0} \\frac{\\exp(sT)}{\\exp(sT) - 1}}\n$$"
        },
        {
            "introduction": "这项高级练习挑战你从第一性原理出发，构建一个正式的推断框架来区分适应的起源。你将运用贝叶斯推理，根据来自古代样本的带有噪音的等位基因频率数据，计算选择性清除（selective sweep）源于现存遗传变异的后验概率。这个实践是将概率论应用于古基因组学中现实世界问题的一次动手操作，它将使你具备处理经验数据中不确定性和误差的技能。",
            "id": "2688401",
            "problem": "在环境变迁发生前，对一个古代群体中的单个双等位基因座进行了取样。变迁发生后，在一个后代群体中，观察到该基因座上发生了硬选择清除。要求您仅使用古代数据和一个包含取样与测序错误的模型，从第一性原理出发，量化该选择清除是由存留遗传变异 (SGV) 而非新突变 (NM) 驱动的后验概率。\n\n假设与模型组成部分：\n- 古代取样：您对该基因座上的 $n$ 条独立的古代染色体进行测序，观察到 $k$ 条读段被检出为衍生等位基因。每条读段的对称性错误检出率为 $\\epsilon \\in (0, \\tfrac{1}{2})$，这意味着一个真实的祖先等位基因被检出为衍生等位基因的概率为 $\\epsilon$，一个真实的衍生等位基因被检出为祖先等位基因的概率也为 $\\epsilon$。以古代群体中真实的衍生等位基因频率 $p_0$ 为条件，观察到的衍生读段数 $K$ 服从二项分布，其成功概率为 $q(p_0) = \\epsilon + (1 - 2\\epsilon) p_0$。\n- 环境变迁发生时的竞争性选择清除起源模型：\n  - SGV 模型 ($\\mathcal{M}_{\\mathrm{SGV}}$)：衍生等位基因以频率 $p_0 \\in (0,1)$ 预先存在，其先验密度为 $p_0 \\sim \\mathrm{Beta}(a,b)$，其中 $a>0$ 且 $b>0$。贝塔函数为 $B(x,y) = \\dfrac{\\Gamma(x)\\Gamma(y)}{\\Gamma(x+y)}$，贝塔密度为 $f(p_0) = \\dfrac{p_0^{a-1}(1-p_0)^{b-1}}{B(a,b)}$。\n  - NM 模型 ($\\mathcal{M}_{\\mathrm{NM}}$)：在变迁发生前，衍生等位基因不存在，即 $p_0 = 0$。在此模型下，古代数据中任何衍生读段都仅源于速率为 $\\epsilon$ 的错误检出。\n- 模型先验：$\\Pr(\\mathcal{M}_{\\mathrm{SGV}}) = \\pi \\in (0,1)$ 且 $\\Pr(\\mathcal{M}_{\\mathrm{NM}}) = 1 - \\pi$。\n\n任务：\n- 运用贝叶斯定理、带对称性错误的二项取样模型以及 $p_0$ 的贝塔先验，推导后验概率 $\\Pr(\\mathcal{M}_{\\mathrm{SGV}} \\mid K = k, n, \\epsilon, a, b, \\pi)$ 的一个闭式解析表达式，该表达式用 $n$、$k$、$\\epsilon$、$a$、$b$ 和 $\\pi$ 表示。您可以使用有限和、二项式系数以及贝塔函数 $B(\\cdot,\\cdot)$ 来表示您的结果。\n- 您的最终答案必须是单个闭式符号表达式。不要提供不等式或待解方程。不要进行近似。\n\n请将最终答案表示为单个解析表达式。无需单位。不要四舍五入。",
            "solution": "我们需要计算后验模型概率 $\\Pr(\\mathcal{M}_{\\mathrm{SGV}} \\mid D)$，其中数据 $D$ 是指在存在对称性错误检出率 $\\epsilon$ 的情况下，从 $n$ 次读段中观察到 $K=k$ 个衍生等位基因。基本依据如下：\n- 贝叶斯定理：$\\Pr(\\mathcal{M}_{i} \\mid D) = \\dfrac{\\Pr(\\mathcal{M}_{i}) \\, \\Pr(D \\mid \\mathcal{M}_{i})}{\\sum_{j} \\Pr(\\mathcal{M}_{j}) \\, \\Pr(D \\mid \\mathcal{M}_{j})}$。\n- 带错误分类的二项取样：以真实衍生等位基因频率 $p_0$ 为条件，观察到的衍生读段概率为 $q(p_0) = \\epsilon + (1 - 2\\epsilon) p_0$，且 $K \\sim \\mathrm{Binomial}(n, q(p_0))$。\n- 共轭贝塔先验：在 $\\mathcal{M}_{\\mathrm{SGV}}$ 模型下，$p_0 \\sim \\mathrm{Beta}(a,b)$，其密度为 $f(p_0) = \\dfrac{p_0^{a-1}(1-p_0)^{b-1}}{B(a,b)}$。\n- 在 $\\mathcal{M}_{\\mathrm{NM}}$ 模型下，$p_0 = 0$ 是确定性的，因此 $q(0) = \\epsilon$，所以 $K \\sim \\mathrm{Binomial}(n, \\epsilon)$。\n\n我们分步进行推导。\n\n第 1 步：新突变模型 $\\mathcal{M}_{\\mathrm{NM}}$ 下的似然。\n\n在 $\\mathcal{M}_{\\mathrm{NM}}$ 模型下，$q = \\epsilon$，因此\n$$\n\\Pr(K=k \\mid n, \\epsilon, \\mathcal{M}_{\\mathrm{NM}}) \\;=\\; \\binom{n}{k} \\, \\epsilon^{k} \\, (1-\\epsilon)^{n-k}.\n$$\n\n第 2 步：存留遗传变异模型 $\\mathcal{M}_{\\mathrm{SGV}}$ 下的边际似然。\n\n在 $\\mathcal{M}_{\\mathrm{SGV}}$ 模型下，以 $p_0$ 为条件，\n$$\n\\Pr(K=k \\mid n, \\epsilon, p_0, \\mathcal{M}_{\\mathrm{SGV}}) \\;=\\; \\binom{n}{k} \\, \\big(\\epsilon + (1 - 2\\epsilon) p_0\\big)^{k} \\, \\Big(1 - \\epsilon - (1 - 2\\epsilon) p_0\\Big)^{n-k}.\n$$\n我们将此似然函数对 $p_0$ 的贝塔先验进行积分：\n$$\n\\Pr(K=k \\mid n, \\epsilon, a, b, \\mathcal{M}_{\\mathrm{SGV}}) \\;=\\; \\int_{0}^{1} \\binom{n}{k} \\, \\big(\\epsilon + (1 - 2\\epsilon) p_0\\big)^{k} \\, \\Big(1 - \\epsilon - (1 - 2\\epsilon) p_0\\Big)^{n-k} \\, \\frac{p_0^{a-1} (1-p_0)^{b-1}}{B(a,b)} \\, dp_0.\n$$\n令 $\\delta = 1 - 2\\epsilon$。通过二项式定理展开各项：\n- 对于第一项，\n$$\n\\big(\\epsilon + \\delta p_0\\big)^{k} \\;=\\; \\sum_{i=0}^{k} \\binom{k}{i} \\, \\epsilon^{k-i} \\, \\delta^{i} \\, p_0^{i}.\n$$\n- 对于第二项，写作 $1 - \\epsilon - \\delta p_0 = (1 - \\epsilon) + (-\\delta) p_0$ 并展开：\n$$\n\\Big(1 - \\epsilon - \\delta p_0\\Big)^{n-k} \\;=\\; \\sum_{j=0}^{n-k} \\binom{n-k}{j} \\, (1 - \\epsilon)^{n-k-j} \\, (-\\delta)^{j} \\, p_0^{j}.\n$$\n将两个展开式相乘，并逐项对贝塔密度进行积分，得到\n$$\n\\Pr(K=k \\mid n, \\epsilon, a, b, \\mathcal{M}_{\\mathrm{SGV}}) \\;=\\; \\binom{n}{k} \\, \\frac{1}{B(a,b)} \\, \\sum_{i=0}^{k} \\sum_{j=0}^{n-k} \\binom{k}{i} \\binom{n-k}{j} \\, \\epsilon^{k-i} \\, (1 - \\epsilon)^{n-k-j} \\, \\delta^{i+j} \\, (-1)^{j} \\, \\int_{0}^{1} p_0^{a-1+i+j} (1-p_0)^{b-1} \\, dp_0.\n$$\n剩下的积分是贝塔函数 $B(a+i+j, b)$。因此，\n$$\n\\Pr(K=k \\mid n, \\epsilon, a, b, \\mathcal{M}_{\\mathrm{SGV}}) \\;=\\; \\binom{n}{k} \\, \\frac{1}{B(a,b)} \\, \\sum_{i=0}^{k} \\sum_{j=0}^{n-k} \\binom{k}{i} \\binom{n-k}{j} \\, \\epsilon^{k-i} \\, (1 - \\epsilon)^{n-k-j} \\, \\delta^{i+j} \\, (-1)^{j} \\, B(a+i+j, b).\n$$\n\n定义有限双重和\n$$\nS(n,k,\\epsilon,a,b) \\;=\\; \\sum_{i=0}^{k} \\sum_{j=0}^{n-k} \\binom{k}{i} \\binom{n-k}{j} \\, \\epsilon^{k-i} \\, (1 - \\epsilon)^{n-k-j} \\, (1 - 2\\epsilon)^{i+j} \\, (-1)^{j} \\, B(a+i+j, b).\n$$\n则\n$$\n\\Pr(K=k \\mid n, \\epsilon, a, b, \\mathcal{M}_{\\mathrm{SGV}}) \\;=\\; \\binom{n}{k} \\, \\frac{S(n,k,\\epsilon,a,b)}{B(a,b)}.\n$$\n\n第 3 步：应用贝叶斯定理得到 $\\Pr(\\mathcal{M}_{\\mathrm{SGV}} \\mid K=k, n, \\epsilon, a, b, \\pi)$。\n\n根据先验 $\\Pr(\\mathcal{M}_{\\mathrm{SGV}})=\\pi$ 和 $\\Pr(\\mathcal{M}_{\\mathrm{NM}})=1-\\pi$，贝叶斯定理给出\n$$\n\\Pr(\\mathcal{M}_{\\mathrm{SGV}} \\mid D) \\;=\\; \\frac{\\pi \\, \\Pr(D \\mid \\mathcal{M}_{\\mathrm{SGV}})}{\\pi \\, \\Pr(D \\mid \\mathcal{M}_{\\mathrm{SGV}}) \\;+\\; (1-\\pi)\\, \\Pr(D \\mid \\mathcal{M}_{\\mathrm{NM}})}.\n$$\n代入边际似然，并注意到公因子 $\\binom{n}{k}$ 从分子和分母中约去，我们得到\n$$\n\\Pr(\\mathcal{M}_{\\mathrm{SGV}} \\mid K=k, n, \\epsilon, a, b, \\pi)\n\\;=\\;\n\\frac{\\displaystyle \\pi \\, \\frac{S(n,k,\\epsilon,a,b)}{B(a,b)}}\n{\\displaystyle \\pi \\, \\frac{S(n,k,\\epsilon,a,b)}{B(a,b)} \\;+\\; (1-\\pi) \\, \\epsilon^{k} \\, (1-\\epsilon)^{n-k}}.\n$$\n\n这是一个关于 $n$、$k$、$\\epsilon$、$a$、$b$ 和 $\\pi$ 的闭式有限和表达式，其中还包含贝塔函数 $B(\\cdot,\\cdot)$ 和二项式系数。它仅依赖于指定的模型组件和基本概率定律。",
            "answer": "$$\\boxed{\\frac{\\displaystyle \\pi \\,\\dfrac{\\sum_{i=0}^{k} \\sum_{j=0}^{\\,n-k} \\binom{k}{i}\\binom{n-k}{j}\\,\\epsilon^{\\,k-i}\\,(1-\\epsilon)^{\\,n-k-j}\\,(1-2\\epsilon)^{\\,i+j}\\,(-1)^{j}\\,B(a+i+j,\\,b)}{B(a,b)}}{\\displaystyle \\pi \\,\\dfrac{\\sum_{i=0}^{k} \\sum_{j=0}^{\\,n-k} \\binom{k}{i}\\binom{n-k}{j}\\,\\epsilon^{\\,k-i}\\,(1-\\epsilon)^{\\,n-k-j}\\,(1-2\\epsilon)^{\\,i+j}\\,(-1)^{j}\\,B(a+i+j,\\,b)}{B(a,b)} \\;+\\; (1-\\pi)\\,\\epsilon^{\\,k}\\,(1-\\epsilon)^{\\,n-k}}}$$"
        }
    ]
}