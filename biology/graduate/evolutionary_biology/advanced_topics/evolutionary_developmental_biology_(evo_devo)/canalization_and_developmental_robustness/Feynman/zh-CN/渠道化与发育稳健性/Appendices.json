{
    "hands_on_practices": [
        {
            "introduction": "对发育生物学家和进化生物学家而言，一项基础技能是能够准确解读反应规范图。这些图是研究表型可塑性、环境驯化和遗传驯化的核心视觉工具。本练习旨在挑战您基于严格的定义，区分反应规范图中环境驯化（特定基因型内部的表型稳定性）和遗传驯化（不同基因型之间的表型稳定性），从而为您建立坚实的表型进化概念和视觉词汇。",
            "id": "2695835",
            "problem": "为一个数量性状在 $m$ 个离散环境（$m \\geq 3$）中对 $n$ 个基因型（$n \\geq 3$）进行测量。所得的反应规范图显示了每个基因型 $G_i$（其中 $i \\in \\{1,\\dots,n\\}$）的表型 $P(G_i,E_j)$ 随环境 $E_j$（其中 $j \\in \\{1,\\dots,m\\}$）变化的曲线。使用以下基础定义：\n\n- 表型可以表示为一个映射 $P: (G,E) \\mapsto \\mathbb{R}$，其中 $G$ 索引基因型，$E$ 索引环境。\n- 环境渠道化定义为在单个基因型内，表型对环境扰动的稳健性，即在保持 $G$ 固定的情况下，$P$ 对 $E$ 变化的不敏感性。\n- 遗传渠道化定义为在单个环境内，表型对遗传扰动的稳健性，即在保持 $E$ 固定的情况下，$P$ 对 $G$ 变化的不敏感性。\n- 基因型与环境互作 (GxE) 指的是基因型的表型效应对环境的依赖性。\n\n严格基于这些定义，并且不假定 $P(G,E)$ 的任何特定参数形式，哪个选项最能描述在包含多个基因型和多个环境的反应规范图中，环境渠道化和遗传渠道化将如何被判断？\n\nA. 环境渠道化：在每个基因型内部，反应规范在不同环境中是平坦的（斜率 $\\partial P/\\partial E \\approx 0$）；遗传渠道化：在不同基因型之间，每个环境中的反应规范都紧密聚集或重叠（基因型间差异小，$\\mathrm{Var}_{G}[P\\mid E] \\approx 0$），无论其斜率如何。\n\nB. 环境渠道化：在每个环境中，基因型间差异最小（$\\mathrm{Var}_{G}[P\\mid E]$ 小）；遗传渠道化：在每个基因型内部，反应规范是平坦的（$\\partial P/\\partial E$ 小）。\n\nC. 环境渠道化：反应规范陡峭但在不同基因型之间平行（$\\partial P/\\partial E$ 大且相似）；遗传渠道化：随着环境变化，反应规范频繁交叉（强的GxE）。\n\nD. 环境渠道化：反应规范在单一环境中收敛到一个共同的表型，但在其他地方发散；遗传渠道化：由于缓冲作用，反应规范随环境变化的曲率减小，即使斜率很大。",
            "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 为 $n$ 个基因型（$n \\geq 3$）测量一个数量性状。\n- 测量是在 $m$ 个离散环境（$m \\geq 3$）中进行的。\n- 反应规范图显示了每个基因型 $G_i$（其中 $i \\in \\{1,\\dots,n\\}$）的表型 $P(G_i,E_j)$ 随环境 $E_j$（其中 $j \\in \\{1,\\dots,m\\}$）变化的曲线。\n- 表型是一个映射 $P: (G,E) \\mapsto \\mathbb{R}$。\n- **定义1（环境渠道化）：** 在单个基因型内，表型对环境扰动的稳健性，即在保持 $G$ 固定的情况下，$P$ 对 $E$ 变化的不敏感性。\n- **定义2（遗传渠道化）：** 在单个环境内，表型对遗传扰动的稳健性，即在保持 $E$ 固定的情况下，$P$ 对 $G$ 变化的不敏感性。\n- **定义3（基因型与环境互作，GxE）：** 基因型的表型效应对环境的依赖性。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据。环境渠道化、遗传渠道化和基因型与环境互作的定义在进化遗传学和数量遗传学领域是标准定义。所描述的实验设计（为多个基因型在多个环境中测量表型以生成反应规范）是该领域的一种基本方法。该问题提法得当，因为它要求基于严格的定义对图形表示进行正确解释。语言客观而精确。问题是自洽的，没有矛盾或科学缺陷。\n\n**步骤3：结论与行动**\n问题有效。解答将首先从给定定义中推导出图形解释，然后评估每个选项。\n\n**从第一性原理推导**\n\n反应规范图将表型 $P$（y轴）绘制为环境 $E$（x轴）的函数。图上的每条曲线对应一个特定的基因型 $G_i$。\n\n1.  **环境渠道化的解释**：\n    定义指出，环境渠道化是“在保持 $G$ 固定的情况下，$P$ 对 $E$ 变化的不敏感性”。\n    - “保持 $G$ 固定”意味着我们关注特定基因型 $G_i$ 的单一反应规范曲线。\n    - “$P$ 对 $E$ 变化的不敏感性”意味着，当我们沿x轴改变环境 $E_j$ 时，y轴上对应的表型值 $P(G_i, E_j)$ 保持相对恒定。\n    - 在图形上，一个函数当其自变量变化时保持恒定，表现为一条水平线。因此，基因型 $G_i$ 的高环境渠道化表现为一条平坦的反应规范曲线。对于连续环境变量，这对应于斜率为零，即 $\\frac{\\partial P}{\\partial E} \\approx 0$。对于离散环境，这意味着对于所有的 $j \\in \\{1, \\dots, m\\}$，表型值 $P(G_i, E_j)$ 几乎相同。\n\n2.  **遗传渠道化的解释**：\n    定义指出，遗传渠道化是“在保持 $E$ 固定的情况下，$P$ 对 $G$ 变化的不敏感性”。\n    - “保持 $E$ 固定”意味着我们关注一个单一的、特定的环境，比如说 $E_j$。这对应于反应规范图上x轴特定值处的一条垂直线。\n    - “$P$ 对 $G$ 变化的不敏感性”意味着，对于这个固定的环境 $E_j$，不同的基因型（$G_1, G_2, \\dots, G_n$）产生非常相似的表型值。\n    - 在图形上，这意味着在对应于环境 $E_j$ 的x坐标处，所有不同反应规范曲线上的点的y坐标都非常相似。在此环境点上，曲线之间的垂直距离很小。\n    - 从统计学上讲，这等同于在给定环境中基因型间表型的方差很小。这可以表示为 $\\mathrm{Var}_{G}[P \\mid E=E_j] \\approx 0$。如果遗传渠道化是该系统的一个普遍特征，那么在大多数或所有环境中都会观察到这种低方差。\n\n**选项分析**\n\n**A. 环境渠道化：在每个基因型内部，反应规范在不同环境中是平坦的（斜率 $\\partial P/\\partial E \\approx 0$）；遗传渠道化：在不同基因型之间，每个环境中的反应规范都紧密聚集或重叠（基因型间差异小，$\\mathrm{Var}_{G}[P\\mid E] \\approx 0$），无论其斜率如何。**\n- 环境渠道化的描述（“反应规范是平坦的”）是上述推导出的定义的直接图形结果。数学公式 $\\partial P/\\partial E \\approx 0$ 对于连续近似是正确的。\n- 遗传渠道化的描述（“在每个环境中反应规范都紧密聚集或重叠”）也是该定义的直接图形结果。统计公式 $\\mathrm{Var}_{G}[P\\mid E] \\approx 0$ 是精确的数学表述。澄清“无论其斜率如何”也是正确的；一组陡峭的平行线可以非常紧密地聚集，表明遗传方差低（高遗传渠道化），但环境渠道化低。\n- **结论**：正确。\n\n**B. 环境渠道化：在每个环境中，基因型间差异最小（$\\mathrm{Var}_{G}[P\\mid E]$ 小）；遗传渠道化：在每个基因型内部，反应规范是平坦的（$\\partial P/\\partial E$ 小）。**\n- 该选项错误地将遗传渠道化的图形特征（“基因型间差异最小”）归因于环境渠道化。\n- 它也错误地将环境渠道化的图形特征（“反应规范是平坦的”）归因于遗传渠道化。\n- 该选项完全混淆了这两个定义。\n- **结论**：不正确。\n\n**C. 环境渠道化：反应规范陡峭但在不同基因型之间平行（$\\partial P/\\partial E$ 大且相似）；遗传渠道化：随着环境变化，反应规范频繁交叉（强的GxE）。**\n- 对环境渠道化的描述与正确解释相反。“陡峭的”反应规范（大的 $\\partial P/\\partial E$）表示高表型可塑性，这与环境渠道化是对立的。\n- 对遗传渠道化的描述也是不正确的。“反应规范频繁交叉”是基因型与环境互作（GxE）的标志，更具体地说是基因型在不同环境下的排序变化。虽然GxE与此相关，但它是一个与遗传渠道化不同的概念。遗传渠道化是关于在给定环境中基因型之间表型差异的大小，而不是关于它们的相对排名如何变化。\n- **结论**：不正确。\n\n**D. 环境渠道化：反应规范在单一环境中收敛到一个共同的表型，但在其他地方发散；遗传渠道化：由于缓冲作用，反应规范随环境变化的曲率减小，即使斜率很大。**\n- 对环境渠道化的描述是不正确的。它描述了基因型间方差随环境的变化，这是一种特定形式的GxE，而不是环境渠道化。环境渠道化关乎单个反应规范的斜率。\n- 对遗传渠道化的描述也是不正确的。遗传渠道化是关于在固定环境下的基因型间方差（$\\mathrm{Var}_G[P|E]$），而不是关于反应规范的曲率。曲率与可塑性反应的非线性（$\\partial^2 P / \\partial E^2$）有关，这是表型可塑性的一个不同方面。\n- **结论**：不正确。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "从定性概念向量化分析的转变，是提升科学严谨性的关键一步。本练习提供了一个模拟的实验数据集，要求您通过计算明确的量化指标来实施驯化的概念。通过处理这些假设的表型数据，您将培养数据处理能力，并学会在比较生物学的框架下，应用定量指数来衡量发育的稳健性。",
            "id": "2552837",
            "problem": "比较动物学和比较植物学中的一个核心概念是反应规范，它将环境映射到表型。发育渠道化指的是表型对环境扰动的不敏感性。考虑一个植物性状（叶面积），在两种培育温度下对四种基因型进行了测量。使用了两种环境：$18\\,^{\\circ}\\mathrm{C}$ 和 $28\\,^{\\circ}\\mathrm{C}$。为了以尊重绝对温标的方式量化比例敏感性，在计算比例变化前，请将温度转换为开尔文。对于每个基因型，在每个温度下测量了多个生物学重复：\n\n- 基因型 $\\mathrm{A}$：在 $18\\,^{\\circ}\\mathrm{C}$ 时，重复测量值为 $9.97,\\,10.02,\\,10.01,\\,9.98,\\,10.02$；在 $28\\,^{\\circ}\\mathrm{C}$ 时，重复测量值为 $10.06,\\,10.03,\\,10.05,\\,10.07,\\,10.04$。\n- 基因型 $\\mathrm{B}$：在 $18\\,^{\\circ}\\mathrm{C}$ 时，重复测量值为 $11.90,\\,11.86,\\,11.88,\\,11.89,\\,11.87$；在 $28\\,^{\\circ}\\mathrm{C}$ 时，重复测量值为 $12.14,\\,12.13,\\,12.11,\\,12.10,\\,12.12$。\n- 基因型 $\\mathrm{C}$：在 $18\\,^{\\circ}\\mathrm{C}$ 时，重复测量值为 $9.33,\\,9.26,\\,9.29,\\,9.28,\\,9.29$；在 $28\\,^{\\circ}\\mathrm{C}$ 时，重复测量值为 $8.80,\\,8.83,\\,8.86,\\,8.85,\\,8.86$。\n- 基因型 $\\mathrm{D}$：在 $18\\,^{\\circ}\\mathrm{C}$ 时，重复测量值为 $10.94,\\,10.96,\\,10.95,\\,10.93,\\,10.97$；在 $28\\,^{\\circ}\\mathrm{C}$ 时，重复测量值为 $11.05,\\,11.07,\\,11.06,\\,11.04,\\,11.08$。\n\n任务：\n1) 对每个基因型，计算其在各个温度下的基因型水平平均表型，然后使用这两个平均点，通过表型对温度的普通最小二乘法，估算反应规范斜率。温度使用开尔文。\n2) 对每个基因型，量化其表型对温度的基于弹性的比例敏感性，其定义为表型比例变化的绝对值除以绝对温度的比例变化。然后，通过一个倒数映射，将此敏感性转化为一个在 $[0,1]$ 区间内的有界渠道化指数 $c_g$。该映射在敏感性为零时等于 $1$，当敏感性无限增大时趋近于 $0$。\n3) 最后，将跨基因型的总体渠道化指数定义为各基因型特定指数 $c_g$ 的几何平均值。\n\n最终结果只提供总体渠道化指数，以无单位小数形式表示，并四舍五入到四位有效数字。最终数值答案中不要包含任何中间值。",
            "solution": "问题陈述已经过评估，被认为是有效的。它具有科学依据，提法恰当，并且为得出唯一解提供了所有必要的数据和定义。该问题要求通过一系列计算，从所提供的表型数据中确定一个发育渠道化的复合指数。我们将按照指定任务执行来求解。\n\n首先，我们必须按照计算比例变化的要求，将给定的摄氏温度转换为绝对开尔文温标。转换公式为 $T_K = T_C + 273.15$。\n两个环境温度分别为 $T_1 = 18\\,^{\\circ}\\mathrm{C}$ 和 $T_2 = 28\\,^{\\circ}\\mathrm{C}$。\n换算成开尔文，它们是：\n$$ T_1 = 18 + 273.15 = 291.15 \\, \\mathrm{K} $$\n$$ T_2 = 28 + 273.15 = 301.15 \\, \\mathrm{K} $$\n温差为 $\\Delta T = T_2 - T_1 = 10 \\, \\mathrm{K}$。平均绝对温度为 $\\bar{T} = \\frac{T_1 + T_2}{2} = \\frac{291.15 + 301.15}{2} = 296.15 \\, \\mathrm{K}$。\n\n第一个任务是计算每个基因型（$g \\in \\{\\mathrm{A, B, C, D}\\}$）在每个温度 $T_i$（$i \\in \\{1, 2\\}$）下的平均表型。设 $\\bar{P}_{g,i}$ 表示基因型 $g$ 在温度 $T_i$ 下的平均表型。\n对于基因型 $\\mathrm{A}$：\n$$ \\bar{P}_{\\mathrm{A},1} = \\frac{9.97 + 10.02 + 10.01 + 9.98 + 10.02}{5} = \\frac{50.00}{5} = 10.00 $$\n$$ \\bar{P}_{\\mathrm{A},2} = \\frac{10.06 + 10.03 + 10.05 + 10.07 + 10.04}{5} = \\frac{50.25}{5} = 10.05 $$\n对于基因型 $\\mathrm{B}$：\n$$ \\bar{P}_{\\mathrm{B},1} = \\frac{11.90 + 11.86 + 11.88 + 11.89 + 11.87}{5} = \\frac{59.40}{5} = 11.88 $$\n$$ \\bar{P}_{\\mathrm{B},2} = \\frac{12.14 + 12.13 + 12.11 + 12.10 + 12.12}{5} = \\frac{60.60}{5} = 12.12 $$\n对于基因型 $\\mathrm{C}$：\n$$ \\bar{P}_{\\mathrm{C},1} = \\frac{9.33 + 9.26 + 9.29 + 9.28 + 9.29}{5} = \\frac{46.45}{5} = 9.29 $$\n$$ \\bar{P}_{\\mathrm{C},2} = \\frac{8.80 + 8.83 + 8.86 + 8.85 + 8.86}{5} = \\frac{44.20}{5} = 8.84 $$\n对于基因型 $\\mathrm{D}$：\n$$ \\bar{P}_{\\mathrm{D},1} = \\frac{10.94 + 10.96 + 10.95 + 10.93 + 10.97}{5} = \\frac{54.75}{5} = 10.95 $$\n$$ \\bar{P}_{\\mathrm{D},2} = \\frac{11.05 + 11.07 + 11.06 + 11.04 + 11.08}{5} = \\frac{55.30}{5} = 11.06 $$\n\n接下来，我们计算每个基因型的反应规范斜率 $m_g$。对于两个点 $(\\bar{P}_{g,1}, T_1)$ 和 $(\\bar{P}_{g,2}, T_2)$，斜率由 $m_g = \\frac{\\bar{P}_{g,2} - \\bar{P}_{g,1}}{T_2 - T_1}$ 给出。\n$$ m_{\\mathrm{A}} = \\frac{10.05 - 10.00}{301.15 - 291.15} = \\frac{0.05}{10} = 0.005 $$\n$$ m_{\\mathrm{B}} = \\frac{12.12 - 11.88}{10} = \\frac{0.24}{10} = 0.024 $$\n$$ m_{\\mathrm{C}} = \\frac{8.84 - 9.29}{10} = \\frac{-0.45}{10} = -0.045 $$\n$$ m_{\\mathrm{D}} = \\frac{11.06 - 10.95}{10} = \\frac{0.11}{10} = 0.011 $$\n\n第二个任务是计算基于弹性的比例敏感性 $S_g$ 和渠道化指数 $c_g$。敏感性 $S_g$ 是表型关于温度的弹性的绝对值。对于离散变化，这被称为弧弹性，定义为：\n$$ S_g = \\left| \\frac{(\\bar{P}_{g,2} - \\bar{P}_{g,1}) / ((\\bar{P}_{g,1} + \\bar{P}_{g,2})/2)}{(T_2 - T_1) / ((T_1 + T_2)/2)} \\right| = \\left| \\frac{\\bar{P}_{g,2} - \\bar{P}_{g,1}}{T_2 - T_1} \\right| \\cdot \\frac{T_1+T_2}{\\bar{P}_{g,1}+\\bar{P}_{g,2}} = |m_g| \\frac{2\\bar{T}}{2\\bar{P}_g} = |m_g| \\frac{\\bar{T}}{\\bar{P}_g} $$\n其中 $\\bar{P}_g = (\\bar{P}_{g,1} + \\bar{P}_{g,2})/2$ 是基因型 $g$ 在两个温度下的平均表型。\n\n对每个基因型：\n$$ \\bar{P}_{\\mathrm{A}} = \\frac{10.00 + 10.05}{2} = 10.025 \\implies S_{\\mathrm{A}} = |0.005| \\frac{296.15}{10.025} \\approx 0.147706 $$\n$$ \\bar{P}_{\\mathrm{B}} = \\frac{11.88 + 12.12}{2} = 12.00 \\implies S_{\\mathrm{B}} = |0.024| \\frac{296.15}{12.00} = 0.592300 $$\n$$ \\bar{P}_{\\mathrm{C}} = \\frac{9.29 + 8.84}{2} = 9.065 \\implies S_{\\mathrm{C}} = |-0.045| \\frac{296.15}{9.065} \\approx 1.470132 $$\n$$ \\bar{P}_{\\mathrm{D}} = \\frac{10.95 + 11.06}{2} = 11.005 \\implies S_{\\mathrm{D}} = |0.011| \\frac{296.15}{11.005} \\approx 0.296011 $$\n\n渠道化指数 $c_g$ 是 $S_g$ 的一个倒数映射，使得当 $S_g=0$ 时 $c_g=1$，且当 $S_g \\to \\infty$ 时 $c_g \\to 0$。满足这些性质的最直接的函数形式是 $c_g = (1 + S_g)^{-1}$。\n我们计算每个基因型的 $c_g$：\n$$ c_{\\mathrm{A}} = \\frac{1}{1 + 0.147706} \\approx 0.871295 $$\n$$ c_{\\mathrm{B}} = \\frac{1}{1 + 0.592300} \\approx 0.628022 $$\n$$ c_{\\mathrm{C}} = \\frac{1}{1 + 1.470132} \\approx 0.404837 $$\n$$ c_{\\mathrm{D}} = \\frac{1}{1 + 0.296011} \\approx 0.771601 $$\n\n第三个也是最后一个任务是计算总体渠道化指数 $C_{overall}$，即各基因型特定指数的几何平均值：\n$$ C_{overall} = (c_{\\mathrm{A}} \\cdot c_{\\mathrm{B}} \\cdot c_{\\mathrm{C}} \\cdot c_{\\mathrm{D}})^{1/4} $$\n代入数值：\n$$ C_{overall} = (0.871295 \\times 0.628022 \\times 0.404837 \\times 0.771601)^{1/4} $$\n$$ C_{overall} \\approx (0.170881)^{1/4} \\approx 0.642964 $$\n\n题目要求结果四舍五入到四位有效数字。第四位有效数字是 $9$，其后的数字是 $6$，因此我们向上取整。\n$$ C_{overall} \\approx 0.6430 $$\n此为最终答案。",
            "answer": "$$ \\boxed{0.6430} $$"
        },
        {
            "introduction": "在更深层次上，驯化不仅是一种发育特性，它还对进化过程本身产生深远影响。这项高级练习利用一个关于基因型-表型图的抽象模型，来探索由驯化赋予的稳健性（robustness）与系统的可演化性（evolvability）之间的内在权衡。通过推导和计算适应度景观的性质，您将洞悉发育稳定性如何在缓冲种群免受扰动的同时，也可能限制其未来的适应性进化路径。",
            "id": "2552704",
            "problem": "你需要形式化并计算一个基因型网络中关于渠道化和发育稳健性的定量模型，然后将其实现为一个完整的程序。该模型捕捉了这样一种权衡关系：当稳健性增加时，中性网络会扩张，而严格适应性路径的数量会减少。从以下基本基础和定义开始。\n\n将基因型空间视为 $L$-维超立方体 $\\{0,1\\}^L$，其中每个节点是一个基因型，边连接着仅相差一个比特的基因型。令 $d_H(\\mathbf{g},\\mathbf{o})$ 表示基因型 $\\mathbf{g}$ 与一个固定的最优基因型 $\\mathbf{o}$ 之间的汉明距离。定义一个适应度函数 $F(\\mathbf{g})$，该函数是渠道化的，具有一个稳健性半径 $r \\in \\{0,1,\\dots,L\\}$：\n- $F(\\mathbf{g}) = 1$ 若 $d_H(\\mathbf{g},\\mathbf{o}) \\le r$（一个具有最大适应度的中性平稳区）。\n- $F(\\mathbf{g})$ 在 $d_H(\\mathbf{g},\\mathbf{o}) > r$ 时，是关于 $d_H(\\mathbf{g},\\mathbf{o})$ 的严格递减函数（为具体起见，你可以假设在平稳区之外 $F(\\mathbf{g}) = \\exp(-(d_H(\\mathbf{g},\\mathbf{o})-r))$，该函数是无量纲且单调的）。\n\n根据超立方体的对称性，对于仅依赖于 $d_H(\\mathbf{g},\\mathbf{o})$ 的计数问题，只需为一个起始基因型 $\\mathbf{s}$ 指定 $d_0 = d_H(\\mathbf{s},\\mathbf{o})$ 即可。对于给定的 $(L,r,d_0)$，需要计算以下两个量：\n- 中性网络大小 $N_{\\text{neutral}}(L,r)$：满足 $d_H(\\mathbf{g},\\mathbf{o}) \\le r$ 的基因型 $\\mathbf{g} \\in \\{0,1\\}^L$ 的数量。\n- 严格适应性路径计数 $P_{\\text{adaptive}}(d_0,r)$：超立方体上从一个满足 $d_H(\\mathbf{s},\\mathbf{o}) = d_0$ 的起始点 $\\mathbf{s}$ 开始，沿着边移动，并且每一步的适应度都相对于前一个节点严格增加，最终在首次进入中性平稳区时终止（即到达任何满足 $d_H(\\mathbf{g},\\mathbf{o}) \\le r$ 的基因型）的不同路径的数量。任何包含非递增或中性步骤的路径都不被计数。如果 $d_0 \\le r$，则不存在严格增加适应度的步骤，此时计数为 $0$。\n\n你的任务：\n- 根据上述定义和超立方体的对称性，推导出 $N_{\\text{neutral}}(L,r)$ 和 $P_{\\text{adaptive}}(d_0,r)$ 关于 $L$、$r$ 和 $d_0$ 的闭式表达式。\n- 实现一个程序，为下面的每个测试用例计算这些量，并按测试顺序将所有结果输出到一个单一的扁平化列表中，每个测试用例贡献两个整数 $[N_{\\text{neutral}}, P_{\\text{adaptive}}]$。\n\n测试套件（每个测试用例是三元组 $(L,r,d_0)$）：\n- 案例 A: $(L,r,d_0) = (10,2,6)$。\n- 案例 B: $(L,r,d_0) = (8,0,5)$。\n- 案例 C: $(L,r,d_0) = (12,4,3)$。\n- 案例 D: $(L,r,d_0) = (15,3,9)$。\n- 案例 E: $(L,r,d_0) = (6,6,5)$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按测试顺序扁平化排列。例如，输出必须类似于 $[N_{\\text{A}},P_{\\text{A}},N_{\\text{B}},P_{\\text{B}},\\dots]$，其中每个 $N_{\\cdot}$ 和 $P_{\\cdot}$ 都是一个整数。不应打印任何额外文本。\n- 此问题中没有物理单位。",
            "solution": "问题陈述已经过严格验证，并被确定为自洽、有科学依据且数学上适定的。它提出了一个植根于进化景观理论生物学的形式化组合问题。我们现在将系统地推导所需的量。\n\n分析的关键在于 $L$-维超立方体 $\\{0,1\\}^L$ 的对称性。由于这种对称性，最优基因型 $\\mathbf{o}$ 的绝对身份是无关紧要的；重要的是任意基因型 $\\mathbf{g}$ 到 $\\mathbf{o}$ 的汉明距离 $d_H(\\mathbf{g}, \\mathbf{o})$。不失一般性，我们将最优基因型固定为原点，即 $\\mathbf{o} = (0, 0, \\dots, 0)$。因此，对于任何基因型 $\\mathbf{g}$，汉明距离 $d_H(\\mathbf{g}, \\mathbf{o})$ 就是其二进制表示中 $1$ 的数量，这也被称为其汉明权重。\n\n**中性网络大小 $N_{\\text{neutral}}(L,r)$ 的推导**\n\n$N_{\\text{neutral}}(L,r)$ 这个量被定义为适应度达到最大值，即 $F(\\mathbf{g})=1$ 的基因型 $\\mathbf{g}$ 的总数。这个条件等价于 $d_H(\\mathbf{g}, \\mathbf{o}) \\le r$。由于我们选择 $\\mathbf{o}$ 为零向量，这意味着我们必须计算所有长度为 $L$ 且包含 $k$ 个 $1$ 的二进制字符串的数量，其中 $k$ 是满足 $0 \\le k \\le r$ 的整数。\n\n构建一个长度为 $L$ 且恰好包含 $k$ 个 $1$ 的二进制字符串的方法数由二项式系数 $\\binom{L}{k}$ 给出，因为它表示从总共 $L$ 个可用位置中为 $1$ 选择 $k$ 个位置的方法数。\n\n为了找到中性平稳区上的基因型总数，我们必须将此数量对所有允许的 $k$ 值（从 $k=0$ 到 $k=r$）进行求和。这就得到了中性网络大小的如下表达式：\n$$ N_{\\text{neutral}}(L,r) = \\sum_{k=0}^{r} \\binom{L}{k} $$\n这个表达式是二项分布的一个标准累积分布函数，但在这里它只是一个组合求和。\n\n**适应性路径计数 $P_{\\text{adaptive}}(d_0,r)$ 的推导**\n\n$P_{\\text{adaptive}}(d_0,r)$ 这个量表示从一个满足 $d_H(\\mathbf{s}, \\mathbf{o}) = d_0$ 的起始基因型 $\\mathbf{s}$ 到达中性平稳区边界的不同路径的数量。这些路径的定义性特征是每一步都必须严格增加适应度。\n\n根据问题定义，对于中性平稳区外的基因型（即 $d_H(\\mathbf{g}, \\mathbf{o}) > r$ 的情况），适应度 $F(\\mathbf{g})$ 是汉明距离 $d_H(\\mathbf{g}, \\mathbf{o})$ 的一个严格递减函数。从一个基因型 $\\mathbf{g}_i$ 到一个相邻基因型 $\\mathbf{g}_{i+1}$（其中 $d_H(\\mathbf{g}_i, \\mathbf{g}_{i+1})=1$）的一步路径，其适应度严格增加，当且仅当 $d_H(\\mathbf{g}_{i+1}, \\mathbf{o}) < d_H(\\mathbf{g}_i, \\mathbf{o})$。由于单比特翻转最多只能使距离改变 $1$，这意味着 $d_H(\\mathbf{g}_{i+1}, \\mathbf{o}) = d_H(\\mathbf{g}_i, \\mathbf{o}) - 1$。因此，一条“严格适应性路径”是一个基因型序列，其中每个后续基因型都是通过翻转单个比特，使其到最优基因型 $\\mathbf{o}$ 的汉明距离恰好减少 1 而得到的。\n\n起始基因型 $\\mathbf{s}$ 的距离为 $d_0$。路径在首次进入中性平稳区时终止，这意味着到达一个满足 $d_H(\\mathbf{g}_m, \\mathbf{o}) \\le r$ 的基因型 $\\mathbf{g}_m$。由于每一步都使距离减一，最后一步必然是从距离 $r+1$ 的基因型移动到距离 $r$ 的基因型。因此，该路径是一系列基因型，其距离分别为 $d_0, d_0-1, \\dots, r+1, r$。这样一条路径的长度恰好是 $d_0 - r$ 步。\n\n我们根据初始条件考虑两种情况。\n\n情况 1：$d_0 \\le r$。\n起始基因型 $\\mathbf{s}$ 已经位于中性平稳区内。任何单比特翻转得到的邻居 $\\mathbf{s}'$ 的距离 $d_H(\\mathbf{s}',\\mathbf{o})$ 将是 $d_0-1$ 或 $d_0+1$。如果 $d_0-1 \\le r$，则邻居也在平稳区内，因此适应度不变（$F(\\mathbf{s}')=1=F(\\mathbf{s})$）。如果 $d_0+1 > r$，则适应度下降。在任何情况下，适应度都不能严格增加。因此，根据问题定义，此类路径的计数为零。\n$$ P_{\\text{adaptive}}(d_0,r) = 0 \\quad \\text{if } d_0 \\le r $$\n\n情况 2：$d_0 > r$。\n路径必须由 $d_0 - r$ 步组成，每一步都减少到 $\\mathbf{o}$ 的距离。我们来计算每一步的选择数量。起始基因型 $\\mathbf{s}$ 有 $d_0$ 个 1（在我们的坐标系中，$\\mathbf{o}$ 是零向量）。\n- 第 1 步（从距离 $d_0$ 到 $d_0-1$）：为了减少 1 的数量，我们必须将一个 $1$ 翻转为 $0$。在 $\\mathbf{s}$ 中有 $d_0$ 个这样的比特，所以有 $d_0$ 种可能的第一步。\n- 第 2 步（从距离 $d_0-1$ 到 $d_0-2$）：得到的基因型有 $d_0-1$ 个 1。有 $d_0-1$ 种可能的下一步可以减少距离。\n- ...\n- 第 $i$ 步（从距离 $d_0-i+1$ 到 $d_0-i$）：该基因型有 $d_0-i+1$ 个 1。有 $d_0-i+1$ 种选择。\n- 最后一步（从距离 $r+1$ 到 $r$）：该基因型有 $r+1$ 个 1。有 $r+1$ 种选择可以到达一个具有 $r$ 个 1 的基因型。\n\n由于每一步的选择都决定了一个唯一的下一个基因型，任何有效的选择序列都会产生一条唯一的路径。不同路径的总数是每一步可用选择数的乘积：\n$$ P_{\\text{adaptive}}(d_0,r) = d_0 \\times (d_0-1) \\times \\cdots \\times (r+1) $$\n这个乘积是降阶乘积的定义，可以用阶乘表示为：\n$$ P_{\\text{adaptive}}(d_0,r) = \\frac{d_0!}{r!} \\quad \\text{if } d_0 > r $$\n\n结合这两种情况，我们得到了 $P_{\\text{adaptive}}(d_0,r)$ 的完整公式。实现将基于这些推导出的解析表达式进行。",
            "answer": "```python\n# language: Python\n# version: 3.12\n# libraries:\n#   name: numpy\n#   version: 1.23.5\n#   name: scipy\n#   version: 1.11.4\nimport numpy as np\nfrom scipy.special import comb\n\ndef solve():\n    \"\"\"\n    Computes and prints the results for the defined test cases based on the\n    derived formulas for canalization and developmental robustness.\n    \"\"\"\n    # Define the test cases from the problem statement as (L, r, d0) tuples.\n    test_cases = [\n        (10, 2, 6),   # Case A\n        (8, 0, 5),    # Case B\n        (12, 4, 3),   # Case C\n        (15, 3, 9),   # Case D\n        (6, 6, 5),    # Case E\n    ]\n\n    results = []\n    \n    for L, r, d0 in test_cases:\n        # Calculate N_neutral(L, r): the number of genotypes g with d_H(g, o) <= r.\n        # This is the sum of binomial coefficients C(L, k) for k from 0 to r.\n        # The sum is computed using scipy.special.comb for precision with large numbers.\n        # The result must be an integer, so exact=True is used.\n        n_neutral = sum(comb(L, k, exact=True) for k in range(r + 1))\n        \n        # Calculate P_adaptive(d0, r): the number of strictly adaptive paths.\n        if d0 <= r:\n            # If the start is within the neutral plateau, no strictly adaptive path exists.\n            p_adaptive = 0\n        else:\n            # For d0 > r, the number of paths is d0 * (d0-1) * ... * (r+1),\n            # which is equivalent to the falling factorial P(d0, d0-r), or d0! / r!.\n            # This is computed via an iterative product to maintain precision and\n            # avoid dealing with potentially very large intermediate factorial values.\n            p_adaptive_val = 1\n            for i in range(r + 1, d0 + 1):\n                p_adaptive_val *= i\n            p_adaptive = p_adaptive_val\n\n        results.extend([n_neutral, p_adaptive])\n\n    # The final print statement must produce a single-line output in the exact\n    # specified format: a comma-separated list of integers in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the main function to run the solution.\nsolve()\n```"
        }
    ]
}