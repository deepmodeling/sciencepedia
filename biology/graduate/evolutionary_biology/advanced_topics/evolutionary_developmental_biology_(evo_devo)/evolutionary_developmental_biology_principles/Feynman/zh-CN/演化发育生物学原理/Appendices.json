{
    "hands_on_practices": [
        {
            "introduction": "发育的结果由精确的基因表达所控制，这一过程根本上遵循转录因子与DNA相互作用的物理化学规律。本练习将引导您构建一个基因调控的热力学模型，这是一个强大的框架，用于定量预测增强子如何整合多个激活和抑制信号。通过从第一性原理推导转录概率 $p_{\\mathrm{on}}$，您将深入理解调控DNA如何编码复杂的逻辑功能，这是理解发育程序的基础。",
            "id": "2710366",
            "problem": "在发育中的胚胎中，一个增强子通过整合来自单个激活剂物种的 $2$ 个结合位点和单个阻遏剂物种的 $1$ 个结合位点的输入来控制一个核心启动子。核心启动子结合 RNA 聚合酶（RNA Pol；简称 RNAP）。假设一个基因调控的热力学平衡（统计力学）模型，其中转录输出与 RNAP 结合到启动子的概率成正比（占有假说）。使用以下基本原则：\n\n- 在平衡状态下，调控 DNA 的每个微观状态 $s$（由哪些位点被占据定义）都有一个统计权重 $w(s)$，该权重与该状态下被占据位点的结合权重之积以及任何存在的相互作用（协同）因子成正比。\n- 状态 $s$ 的概率是 $P(s) = w(s)/Z$，其中配分函数 $Z = \\sum_{s} w(s)$ 是所有允许的微观状态的权重之和。\n- 对于一个结合因子 $X$ 的位点，若 $X$ 的游离核浓度为 $[X]$，解离常数为 $K_{X}$，则其相对于未结合位点的结合权重为 $[X]/K_{X}$。\n- 每个结合位点都是二元的（要么为空，要么最多被一个分子占据），并且除了明确指定的相互作用外，所有结合事件都是独立的。\n\n模型规范：\n\n- 有两个激活剂结合位点，索引为 $i \\in \\{1,2\\}$。两者都结合相同的激活剂物种 $A$，其浓度为 $[A]$，解离常数分别为 $K_{A1}$ 和 $K_{A2}$。\n- 有一个阻遏剂结合位点，用于结合阻遏剂物种 $R$，其浓度为 $[R]$，解离常数为 $K_{R}$。\n- 启动子结合 RNAP，其浓度为 $[P]$，解离常数为 $K_{P}$。\n- 当两个激活剂位点同时被占据时，该状态的权重乘以一个激活剂-激活剂协同因子 $\\omega_{AA}$。\n- 当 RNAP 与被占据的激活剂位点 $i$ 一同结合时，该状态的权重乘以一个激活剂-聚合酶相互作用因子 $\\omega_{AP,i}$（对于 $i \\in \\{1,2\\}$）。\n- 阻遏剂通过空间位阻排斥 RNAP：任何阻遏剂和 RNAP 同时结合的状态都是不允许的（权重为 $0$）。除此之外，阻遏剂不改变激活剂的结合或激活剂-激活剂的相互作用（除了排斥 RNAP 外没有其他相互作用）。\n- 不存在其他相互作用。\n\n仅使用上述原则，推导转录概率（与 RNAP 占有率成正比）$p_{\\mathrm{on}}([A],[R],[P])$ 的闭式表达式，该表达式是 $[A]$、$[R]$、$[P]$、$K_{A1}$、$K_{A2}$、$K_{R}$、$K_{P}$、$\\omega_{AA}$、$\\omega_{AP,1}$ 和 $\\omega_{AP,2}$ 的函数。请将最终答案表示为单个代数表达式。不要简化为小数或代入数值。最终表达式中不要包含任何单位。无需四舍五入。",
            "solution": "问题陈述经评估有效。它在科学上基于应用于基因调控的统计力学原理（Shea-Ackers 模型），问题设定良好，定义了所有必要的参数和条件，并以客观、正式的语言表达。它提出了一个可解的问题，没有矛盾、歧义或依赖于非科学的前提。\n\n目标是推导 RNA 聚合酶（RNAP）结合到启动子的概率，记为 $p_{\\mathrm{on}}$。根据指定的的热力学模型，此概率是所有 RNAP 结合状态的统计权重之和（$Z_{\\mathrm{on}}$）与所有可能状态的统计权重之和（配分函数，$Z$）的比值。\n$$p_{\\mathrm{on}} = \\frac{Z_{\\mathrm{on}}}{Z}$$\n\n该系统包含四个结合位点：两个用于激活剂（$A$），一个用于阻遏剂（$R$），一个用于 RNAP（$P$）。微观状态 $s$ 由这四个位点的占有情况定义。设一个状态由向量 $(s_{A1}, s_{A2}, s_R, s_P)$ 表示，其中 $s_i \\in \\{0, 1\\}$ 表示位点是空的（$0$）还是被占据的（$1$）。\n\n对于浓度为 $[X]$、解离常数为 $K_X$ 的因子 $X$，其相对结合权重为 $[X]/K_X$。为方便起见，我们定义以下无量纲浓度：\n- 激活剂在位点 1：$c_{A1} = \\frac{[A]}{K_{A1}}$\n- 激活剂在位点 2：$c_{A2} = \\frac{[A]}{K_{A2}}$\n- 阻遏剂：$c_{R} = \\frac{[R]}{K_{R}}$\n- RNAP：$c_{P} = \\frac{[P]}{K_{P}}$\n\n任何微观状态的统计权重 $w(s)$ 是所有被占据位点的结合权重与任何相关协同因子的乘积。配分函数 $Z$ 是所有允许的微观状态 $w(s)$ 的总和。\n\n一个关键的约束是阻遏剂 $R$ 通过空间位阻排斥 RNAP $P$。这意味着任何 $R$ 和 $P$ 同时结合的状态都是不允许的，因此其统计权重为 $0$。总共有 $2^4 = 16$ 种潜在的微观状态，但其中 $s_R=1$ 且 $s_P=1$ 的状态是被禁止的。\n\n我们将通过对所有允许状态的权重求和来计算配分函数 $Z$。根据阻遏剂位点的占有情况来组织求和会很方便。\n\n情况 1：阻遏剂位点未被占据（$s_R = 0$）。\n在这种情况下，RNAP 可以自由结合。我们对其他三个位点（A1、A2、P）的所有可能构型求和。\n这些状态的权重之和，我们称之为 $Z_{R=0}$，可以根据 RNAP 的占有情况进行分解。\n子情况 1a：RNAP 未结合（$s_P=0$）。激活剂的可能构型为：\n- 没有激活剂结合：权重 = $1$。\n- 只有激活剂 1 结合：权重 = $c_{A1}$。\n- 只有激活剂 2 结合：权重 = $c_{A2}$。\n- 两个激活剂都结合（有协同性）：权重 = $c_{A1}c_{A2}\\omega_{AA}$。\n此子情况的和为 $Z_{R=0, P=0} = 1 + c_{A1} + c_{A2} + c_{A1}c_{A2}\\omega_{AA}$。\n\n子情况 1b：RNAP 结合（$s_P=1$）。基础权重乘以 $c_P$。激活剂-聚合酶相互作用因子 $\\omega_{AP,i}$ 也适用。\n- 只有 RNAP 结合：权重 = $c_P$。\n- RNAP 和激活剂 1 结合：权重 = $c_P c_{A1} \\omega_{AP,1}$。\n- RNAP 和激活剂 2 结合：权重 = $c_P c_{A2} \\omega_{AP,2}$。\n- RNAP 和两个激活剂都结合：权重 = $c_P c_{A1} c_{A2} \\omega_{AA} \\omega_{AP,1} \\omega_{AP,2}$。注意，两个激活剂-聚合酶相互作用以及激活剂-激活剂协同性都适用。\n此子情况的和为 $Z_{R=0, P=1} = c_P(1 + c_{A1}\\omega_{AP,1} + c_{A2}\\omega_{AP,2} + c_{A1}c_{A2}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2})$。\n\n因此，阻遏剂位点为空的状态的总配分函数为 $Z_{R=0} = Z_{R=0, P=0} + Z_{R=0, P=1}$。\n\n情况 2：阻遏剂位点被占据（$s_R = 1$）。\n基础权重乘以 $c_R$。由于空间位阻，RNAP 不能结合，因此所有状态的 $s_P=0$。除了 RNAP 被排斥之外，激活剂的构型与阻遏剂无关。\n这些状态的权重之和 $Z_{R=1}$ 为：\n$Z_{R=1} = c_R(1 + c_{A1} + c_{A2} + c_{A1}c_{A2}\\omega_{AA})$。这恰好是 $c_R \\cdot Z_{R=0, P=0}$。\n\n总配分函数 $Z$ 是所有允许状态的权重之和：\n$Z = Z_{R=0} + Z_{R=1} = (Z_{R=0, P=0} + Z_{R=0, P=1}) + Z_{R=1}$\n$Z = Z_{R=0, P=0} + Z_{R=0, P=1} + c_R \\cdot Z_{R=0, P=0}$\n$Z = (1+c_R)Z_{R=0, P=0} + Z_{R=0, P=1}$\n\n代入各子配分函数的表达式：\n$$Z = (1+c_R)(1 + c_{A1} + c_{A2} + c_{A1}c_{A2}\\omega_{AA}) + c_P(1 + c_{A1}\\omega_{AP,1} + c_{A2}\\omega_{AP,2} + c_{A1}c_{A2}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2})$$\n\n现在，我们求 $Z_{\\mathrm{on}}$，即 RNAP 结合状态的权重之和。根据定义，这些是 $s_P=1$ 的状态。排斥规则意味着对于这些状态，$s_R$ 必须为 $0$。因此，$Z_{\\mathrm{on}}$ 正是我们计算的 $Z_{R=0, P=1}$ 项。\n$$Z_{\\mathrm{on}} = c_P(1 + c_{A1}\\omega_{AP,1} + c_{A2}\\omega_{AP,2} + c_{A1}c_{A2}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2})$$\n\n最后，转录概率是 $p_{\\mathrm{on}} = Z_{\\mathrm{on}} / Z$。\n$$p_{\\mathrm{on}} = \\frac{c_P(1 + c_{A1}\\omega_{AP,1} + c_{A2}\\omega_{AP,2} + c_{A1}c_{A2}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2})}{(1+c_R)(1 + c_{A1} + c_{A2} + c_{A1}c_{A2}\\omega_{AA}) + c_P(1 + c_{A1}\\omega_{AP,1} + c_{A2}\\omega_{AP,2} + c_{A1}c_{A2}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2})}$$\n我们将 $c_{A1}$、$c_{A2}$、$c_R$ 和 $c_P$ 的原始定义代回：\n$c_{A1} = \\frac{[A]}{K_{A1}}$, $c_{A2} = \\frac{[A]}{K_{A2}}$, $c_{R} = \\frac{[R]}{K_{R}}$, $c_{P} = \\frac{[P]}{K_{P}}$。\n项 $c_{A1}c_{A2}$ 变为 $\\frac{[A]^2}{K_{A1}K_{A2}}$。\n\n最终表达式是：\n$$p_{\\mathrm{on}}([A],[R],[P]) = \\frac{\\frac{[P]}{K_P}\\left(1 + \\frac{[A]}{K_{A1}}\\omega_{AP,1} + \\frac{[A]}{K_{A2}}\\omega_{AP,2} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2}\\right)}{\\left(1+\\frac{[R]}{K_R}\\right)\\left(1 + \\frac{[A]}{K_{A1}} + \\frac{[A]}{K_{A2}} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\right) + \\frac{[P]}{K_P}\\left(1 + \\frac{[A]}{K_{A1}}\\omega_{AP,1} + \\frac{[A]}{K_{A2}}\\omega_{AP,2} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2}\\right)}$$\n这是关于给定参数的转录概率的完整、闭式的表达式。",
            "answer": "$$\\boxed{\\frac{\\frac{[P]}{K_P}\\left(1 + \\frac{[A]}{K_{A1}}\\omega_{AP,1} + \\frac{[A]}{K_{A2}}\\omega_{AP,2} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2}\\right)}{\\left(1+\\frac{[R]}{K_R}\\right)\\left(1 + \\frac{[A]}{K_{A1}} + \\frac{[A]}{K_{A2}} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\right) + \\frac{[P]}{K_P}\\left(1 + \\frac{[A]}{K_{A1}}\\omega_{AP,1} + \\frac{[A]}{K_{A2}}\\omega_{AP,2} + \\frac{[A]^2}{K_{A1}K_{A2}}\\omega_{AA}\\omega_{AP,1}\\omega_{AP,2}\\right)}}$$"
        },
        {
            "introduction": "理解了单个基因的调控后，我们进而探究细胞群体如何协同形成组织。在胚胎发育中，形态发生素梯度为细胞提供了关键的位置信息，指导其分化命运。本练习将运用经典的反应-扩散（reaction-diffusion）模型，从物理层面揭示一个稳定的信号分子浓度梯度 $C(x)$ 是如何通过局部产生、扩散和降解过程自发形成的。通过这个推导，您将掌握简单分子过程生成复杂空间图案的核心原理，这是贯穿发育生物学和演化发育生物学的基本思想。",
            "id": "2710362",
            "problem": "在一个具有均匀横截面的胚胎组织的一维表示中，一个局部组织中心在位置 $x=0$ 处持续分泌形成素。将形成素浓度 $C(x,t)$ 视为线性浓度（单位长度上的量），其输运通过菲克扩散（扩散系数为 $D$）和均匀一级降解（速率常数为 $\\lambda$）来建模。该组织中心以恒定的总速率 $J$（单位时间内的量）分泌形成素，您应当将其表示为位于 $x=0$ 处的狄拉克 $\\delta$ 源。假设组织延伸至整个实轴，且稳态浓度在 $x=0$ 处保持有限，并在 $|x|\\to\\infty$ 时趋于零。\n\n从菲克第一定律和局部质量守恒出发，建立控制性的一维偏微分方程，并求解稳态浓度分布 $C(x)$。您的推导过程应明确地考虑点源的分布性质，以及它对 $x=0$ 处任何连续性或跳跃条件所产生的影响。\n\n请用 $J$、$D$、$\\lambda$ 和 $x$ 将您的最终答案表示为一个闭式解析表达式。只报告稳态 $C(x)$ 的符号表达式；不要在最终表达式中包含单位。",
            "solution": "该问题要求推导并求解在扩散、降解和局域产生作用下一个形成素的一维稳态浓度分布。我将首先从第一性原理出发建立控制性偏微分方程，然后求解其稳态情况。\n\n首先，我们将质量守恒原理应用于组织从 $x$ 到 $x + \\Delta x$ 的一个任意片段。该片段中形成素的总量为 $\\int_{x}^{x+\\Delta x} C(u,t) \\, du$。该总量的变化率等于进入该片段的形成素净速率。该净速率由扩散输运、降解损失以及源的产生三部分组成。\n\n设 $j(x,t)$ 为在位置 $x$ 和时间 $t$ 处形成素的扩散通量。由于扩散而进入该片段的形成素净速率为 $j(x,t) - j(x+\\Delta x,t)$。由一级降解导致的损失速率为 $-\\int_{x}^{x+\\Delta x} \\lambda C(u,t) \\, du$，其中 $\\lambda$ 是降解速率常数。片段内源产生的速率由 $\\int_{x}^{x+\\Delta x} S(u,t) \\, du$ 给出，其中 $S(x,t)$ 是源密度。\n\n因此，守恒定律为：\n$$ \\frac{\\partial}{\\partial t} \\int_{x}^{x+\\Delta x} C(u,t) \\, du = j(x,t) - j(x+\\Delta x,t) - \\int_{x}^{x+\\Delta x} \\lambda C(u,t) \\, du + \\int_{x}^{x+\\Delta x} S(u,t) \\, du $$\n我们将等式两边除以 $\\Delta x$ 并取 $\\Delta x \\to 0$ 的极限。根据微积分基本定理，这得到了微分形式的局域守恒方程：\n$$ \\frac{\\partial C}{\\partial t} = -\\frac{\\partial j}{\\partial x} - \\lambda C + S(x,t) $$\n问题指出，输运遵循菲克第一定律（Fick's first law），该定律将通量 $j$ 与浓度梯度关联起来：\n$$ j(x,t) = -D \\frac{\\partial C}{\\partial x} $$\n其中 $D$ 是扩散系数。将此代入守恒方程，得到反应-扩散方程：\n$$ \\frac{\\partial C}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left(-D \\frac{\\partial C}{\\partial x}\\right) - \\lambda C + S(x,t) $$\n由于 $D$ 是一个均匀常数，这可以简化为：\n$$ \\frac{\\partial C}{\\partial t} = D \\frac{\\partial^2 C}{\\partial x^2} - \\lambda C + S(x,t) $$\n源是位于 $x=0$ 处的一个局部组织中心，以恒定的总速率 $J$ 分泌形成素。这被建模为一个使用狄拉克 $\\delta$ 函数（Dirac delta function）, $\\delta(x)$ 的点源。因此，$S(x,t) = J \\delta(x)$。我们的控制性偏微分方程是：\n$$ \\frac{\\partial C}{\\partial t} = D \\frac{\\partial^2 C}{\\partial x^2} - \\lambda C + J \\delta(x) $$\n我们需要求解稳态浓度分布 $C(x)$。在稳态下，浓度不随时间变化，因此 $\\frac{\\partial C}{\\partial t} = 0$。方程变为一个二阶常微分方程：\n$$ D \\frac{d^2 C}{d x^2} - \\lambda C + J \\delta(x) = 0 $$\n通常将其重新排列为：\n$$ \\frac{d^2 C}{d x^2} - \\frac{\\lambda}{D} C(x) = -\\frac{J}{D} \\delta(x) $$\n让我们定义一个特征长度尺度 $L = \\sqrt{D/\\lambda}$。方程则为：\n$$ \\frac{d^2 C}{d x^2} - \\frac{1}{L^2} C(x) = -\\frac{J}{D} \\delta(x) $$\n对于任何位置 $x \\neq 0$，源项为零，我们得到齐次方程：\n$$ \\frac{d^2 C}{d x^2} - \\frac{1}{L^2} C(x) = 0 $$\n该常微分方程的特征方程是 $r^2 - 1/L^2 = 0$，其根为 $r = \\pm 1/L$。对于 $x \\neq 0$ 的通解是指数函数的线性组合：\n$$ C(x) = A e^{-x/L} + B e^{x/L} $$\n我们必须应用问题中指定的边界条件。定义域是整个实轴，且浓度必须在 $|x| \\to \\infty$ 时趋于零。\n\n对于 $x > 0$：当 $x \\to \\infty$ 时，$B e^{x/L}$ 项会发散，除非 $B=0$。因此，对于 $x > 0$，解的形式必须是 $C(x) = A_1 e^{-x/L}$。\n对于 $x < 0$：当 $x \\to -\\infty$ 时，$A e^{-x/L}$ 项会发散，除非 $A=0$。因此，对于 $x < 0$，解的形式必须是 $C(x) = A_2 e^{x/L}$。\n\n整体解可以使用绝对值函数表示为：$C(x) = A \\exp(-|x|/L)$，其中 $A$ 是某个常数。这种形式在 $x=0$ 处是连续的，这符合浓度保持有限的条件。$C(0) = A$。\n\n为了确定常数 $A$，我们必须考虑狄拉克 $\\delta$ 源。这通过将完整的常微分方程在源点 $x=0$ 附近的一个小区间 $[-\\epsilon, \\epsilon]$ 上积分，然后取 $\\epsilon \\to 0$ 的极限来完成。\n$$ \\int_{-\\epsilon}^{\\epsilon} \\left(\\frac{d^2 C}{d x^2} - \\frac{1}{L^2} C(x)\\right) dx = \\int_{-\\epsilon}^{\\epsilon} -\\frac{J}{D} \\delta(x) dx $$\n让我们在 $\\epsilon \\to 0$ 的极限下计算每一项：\n第一项：\n$$ \\lim_{\\epsilon \\to 0} \\int_{-\\epsilon}^{\\epsilon} \\frac{d^2 C}{d x^2} dx = \\lim_{\\epsilon \\to 0} \\left[ \\frac{dC}{dx} \\right]_{-\\epsilon}^{\\epsilon} = \\lim_{\\epsilon \\to 0} \\left( \\frac{dC}{dx}\\bigg|_{x=\\epsilon} - \\frac{dC}{dx}\\bigg|_{x=-\\epsilon} \\right) $$\n这是一阶导数在 $x=0$ 处的跳跃。\n第二项：\n$$ \\lim_{\\epsilon \\to 0} \\int_{-\\epsilon}^{\\epsilon} -\\frac{1}{L^2} C(x) dx $$\n由于 $C(x)$ 在 $x=0$ 处是连续且有限的，它在一个无穷小区间的积分是零。\n右边项，根据 $\\delta$ 函数的筛选性质：\n$$ \\int_{-\\epsilon}^{\\epsilon} -\\frac{J}{D} \\delta(x) dx = -\\frac{J}{D} $$\n将这些结果结合起来，得到了一阶导数在 $x=0$ 处的跳跃条件：\n$$ \\frac{dC}{dx}\\bigg|_{x=0^+} - \\frac{dC}{dx}\\bigg|_{x=0^-} = -\\frac{J}{D} $$\n现在我们从解 $C(x) = A \\exp(-|x|/L)$ 计算导数：\n对于 $x > 0$，$C(x) = A e^{-x/L}$，所以 $\\frac{dC}{dx} = -\\frac{A}{L} e^{-x/L}$。因此，$\\frac{dC}{dx}\\bigg|_{x=0^+} = -\\frac{A}{L}$。\n对于 $x < 0$，$C(x) = A e^{x/L}$，所以 $\\frac{dC}{dx} = \\frac{A}{L} e^{x/L}$。因此，$\\frac{dC}{dx}\\bigg|_{x=0^-} = \\frac{A}{L}$。\n\n将这些代入跳跃条件：\n$$ \\left(-\\frac{A}{L}\\right) - \\left(\\frac{A}{L}\\right) = -\\frac{J}{D} $$\n$$ -\\frac{2A}{L} = -\\frac{J}{D} \\implies A = \\frac{JL}{2D} $$\n现在我们将 $A$ 的表达式代回到我们对 $C(x)$ 的解中：\n$$ C(x) = \\frac{JL}{2D} \\exp\\left(-\\frac{|x|}{L}\\right) $$\n最后，我们代回特征长度的定义 $L = \\sqrt{D/\\lambda}$：\n$$ C(x) = \\frac{J \\sqrt{D/\\lambda}}{2D} \\exp\\left(-\\frac{|x|}{\\sqrt{D/\\lambda}}\\right) $$\n前置因子可以简化为：\n$$ \\frac{J \\sqrt{D}}{2D \\sqrt{\\lambda}} = \\frac{J}{2\\sqrt{D}\\sqrt{\\lambda}} = \\frac{J}{2\\sqrt{D\\lambda}} $$\n指数中的项可以写为 $-|x|\\sqrt{\\lambda/D}$。\n因此，稳态浓度分布的最终表达式为：\n$$ C(x) = \\frac{J}{2\\sqrt{D\\lambda}} \\exp\\left(-|x|\\sqrt{\\frac{\\lambda}{D}}\\right) $$\n这个表达式满足所有条件：它解出了控制方程，在无穷远处趋于零，并且在 $x=0$ 处连续，其导数的不连续性正确地模拟了点源。",
            "answer": "$$\n\\boxed{\\frac{J}{2 \\sqrt{D \\lambda}} \\exp\\left(-|x| \\sqrt{\\frac{\\lambda}{D}}\\right)}\n$$"
        },
        {
            "introduction": "发育蓝图在物种间演化，但其背后的基因调控网络究竟是如何改变的？要回答此问题，我们必须能够区分顺式作用（cis-acting）和反式作用（trans-acting）突变的贡献。本练习将指导您分析种间杂交体中的等位基因特异性表达数据，这正是分离这两种效应的经典实验与计算策略。通过亲手实现此分析流程，您将学会如何量化不同演化模式，并能识别“发育系统漂变”（developmental system drift）这一重要概念——即表型保守，而底层调控网络却发生了补偿性演化。",
            "id": "2710400",
            "problem": "您将获得一组源自种间杂交体中等位基因特异性表达的基因水平汇总统计数据，用于推断顺式和反式调控对表达差异的贡献。其科学基础是，在子一代（F1）杂交体中，两个等位基因都暴露于相同的反式作用因子细胞环境中，因此杂交体中任何等位基因特异性的表达差异都反映了顺式作用的调控差异，而亲本表达差异与杂交体等位基因差异之间的残差则反映了反式作用的调控差异。这些思想是演化发育生物学的基础，其中顺式和反式变化的组合可以通过补偿性演化产生保守的表型，这一现象被称为系统漂变。您的任务是使用标准正态近似和误差传播来实现以下定量分类方案。\n\n基本出发点和定义：\n- 设 $E_A$ 和 $E_B$ 表示给定基因在物种 $A$ 和物种 $B$ 中的稳态表达，设 $H_A$ 和 $H_B$ 分别表示 F1 杂交体中源自物种 $A$ 和 $B$ 的等位基因的特异性表达。将以2为底的表达比率对数视为效应量。\n- 定义亲本对数倍数变化为 $L_P = \\log_2\\left(\\dfrac{E_B}{E_A}\\right)$。\n- 定义杂交体等位基因对数倍数变化为 $L_C = \\log_2\\left(\\dfrac{H_B}{H_A}\\right)$，它估计了顺式调控效应，因为在杂交体中两个等位基因共享相同的反式环境。\n- 通过减法在对数尺度上定义反式调控效应为 $L_T = L_P - L_C$。这源于对数尺度上效应的可加性。\n- 假设 $L_P$ 和 $L_C$ 的估计量近似服从正态分布，其标准误分别为 $s_P$ 和 $s_C$，这些标准误源于生物学或技术重复。在亲本和杂交体估计量相互独立的假设下，使用差值的误差传播公式得到 $\\mathrm{SE}(L_T) = \\sqrt{s_P^2 + s_C^2}$。\n- 对于双侧显著性水平 $\\alpha = 0.05$ 的假设检验，使用标准正态临界值 $z^\\star = \\Phi^{-1}(1 - \\alpha/2)$，其中 $\\Phi^{-1}$ 是概率单位函数。数值上，$z^\\star \\approx 1.959963984540054$。\n- 定义顺式效应的检验统计量为 $z_C = \\dfrac{L_C}{s_C}$，反式效应的检验统计量为 $z_T = \\dfrac{L_T}{\\sqrt{s_P^2 + s_C^2}}$，亲本差异的检验统计量为 $z_P = \\dfrac{L_P}{s_P}$。当且仅当 $|z| > z^\\star$ 时，检验结果被认为是统计显著的。\n\n每个基因的分类规则，返回一个整数代码：\n- $4$ (顺反式补偿性系统漂变)：顺式和反式均显著，$L_C$ 和 $L_T$ 的符号相反，且亲本差异不显著，即 $|z_C| > z^\\star$，$|z_T| > z^\\star$，$L_C \\cdot L_T < 0$ 且 $|z_P| \\le z^\\star$。\n- $3$ (顺式和反式增强性差异)：顺式和反式均显著，$L_C$ 和 $L_T$ 的符号相同，且亲本差异显著，即 $|z_C| > z^\\star$，$|z_T| > z^\\star$，$L_C \\cdot L_T > 0$ 且 $|z_P| > z^\\star$。\n- $1$ (仅顺式)：顺式显著而反式不显著，即 $|z_C| > z^\\star$ 且 $|z_T| \\le z^\\star$。\n- $2$ (仅反式)：反式显著而顺式不显著，即 $|z_T| > z^\\star$ 且 $|z_C| \\le z^\\star$。\n- $0$ (无证据)：顺式和反式均不显著，即 $|z_C| \\le z^\\star$ 且 $|z_T| \\le z^\\star$。\n\n您的程序的输入是固定的，为以下基因测试套件，每个基因由一个四元组 $(L_P, s_P, L_C, s_C)$ 指定，其中效应值以2为底的对数单位表示，标准误也使用相同单位：\n- 基因 $1$：$(1.05, 0.25, 1.00, 0.20)$。\n- 基因 $2$：$(1.20, 0.20, 0.05, 0.25)$。\n- 基因 $3$：$(1.00, 0.10, 0.60, 0.10)$。\n- 基因 $4$：$(0.10, 0.15, 0.70, 0.10)$。\n- 基因 $5$：$(0.05, 0.20, 0.10, 0.20)$。\n- 基因 $6$：$(-0.80, 0.10, -0.02, 0.20)$。\n- 基因 $7$：$(-0.46, 0.20, -0.50, 0.10)$。\n- 基因 $8$：$(0.39, 0.20, 0.39, 0.20)$。\n\n角度单位和物理单位不适用，因为所有量都是无量纲的以2为底的对数或其标准误。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\mathrm{result}_1,\\mathrm{result}_2,\\dots]$）的结果，其中每个 $\\mathrm{result}_i$ 是根据上述规则为基因 $i$ 分配的整数代码，顺序与测试套件中的顺序相同。",
            "solution": "问题陈述经过了严格验证，被认定为有效。\n\n**第 1 步：提取已知信息**\n\n问题提供了以下定义和数据：\n-   亲本对数倍数变化：$L_P = \\log_2\\left(\\dfrac{E_B}{E_A}\\right)$。\n-   杂交体等位基因对数倍数变化（顺式调控效应）：$L_C = \\log_2\\left(\\dfrac{H_B}{H_A}\\right)$。\n-   反式调控效应：$L_T = L_P - L_C$。\n-   $L_P$ 和 $L_C$ 估计量的标准误分别表示为 $s_P$ 和 $s_C$。\n-   $L_T$ 估计量的标准误通过误差传播公式给出：$\\mathrm{SE}(L_T) = \\sqrt{s_P^2 + s_C^2}$。\n-   双侧检验的显著性水平：$\\alpha = 0.05$。\n-   标准正态临界值：$z^\\star = \\Phi^{-1}(1 - \\alpha/2) \\approx 1.959963984540054$。\n-   检验统计量：$z_P = \\dfrac{L_P}{s_P}$，$z_C = \\dfrac{L_C}{s_C}$，以及 $z_T = \\dfrac{L_T}{\\sqrt{s_P^2 + s_C^2}}$。\n-   统计显著性条件：$|z| > z^\\star$。\n-   一个包含五条规则的分类方案，用于根据 $z_C$、$z_T$、$z_P$ 的显著性以及乘积 $L_C \\cdot L_T$ 的符号来分配整数代码（$0$、$1$、$2$、$3$、$4$）。\n-   一个包含八个基因的测试套件，每个基因由一个元组 $(L_P, s_P, L_C, s_C)$ 指定。输入数据中的 `$` 符号是明显的印刷错误，应予忽略，其值被解释为标准浮点数。\n\n**第 2 步：验证结论**\n\n该问题是**有效的**。它在科学上基于演化遗传学中划分顺式和反式调控差异的既定原则。其数学和统计框架是自洽且定义明确的。所提供的数据是现实的，分类规则虽然没有穷尽所有理论可能性，但对于给定的测试案例是充分且明确的，这使得问题成为一个适定且可解的问题。\n\n**第 3 步：求解方法**\n\n任务是根据一套预设规则对每个基因进行分类。这需要对每个基因进行系统性计算，遵循以下步骤：\n\n1.  给定输入元组 $(L_P, s_P, L_C, s_C)$，计算派生量。\n    -   反式调控效应：$L_T = L_P - L_C$。\n    -   反式效应估计量的标准误：$s_T = \\sqrt{s_P^2 + s_C^2}$。\n\n2.  计算三个检验统计量。\n    -   亲本差异：$z_P = L_P / s_P$。\n    -   顺式效应：$z_C = L_C / s_C$。\n    -   反式效应：$z_T = L_T / s_T$。\n\n3.  通过将其检验统计量的绝对值与临界值 $z^\\star \\approx 1.959963984540054$进行比较，来评估每种效应的显著性。\n    -   如果 $|z_C| > z^\\star$，则顺式效应显著。\n    -   如果 $|z_T| > z^\\star$，则反式效应显著。\n    -   如果 $|z_P| > z^\\star$，则亲本差异显著。\n\n4.  按特定顺序应用分类规则以确定整数代码。这套规则在结果空间上定义了一个划分。一个逻辑实现将对每个类别进行测试。\n\n    -   **类别 4 (补偿性)：** $|z_C| > z^\\star$，$|z_T| > z^\\star$，$L_C \\cdot L_T < 0$ 且 $|z_P| \\le z^\\star$。\n    -   **类别 3 (增强性)：** $|z_C| > z^\\star$，$|z_T| > z^\\star$，$L_C \\cdot L_T > 0$ 且 $|z_P| > z^\\star$。\n    -   **类别 1 (仅顺式)：** $|z_C| > z^\\star$ 且 $|z_T| \\le z^\\star$。\n    -   **类别 2 (仅反式)：** $|z_T| > z^\\star$ 且 $|z_C| \\le z^\\star$。\n    -   **类别 0 (无证据)：** $|z_C| \\le z^\\star$ 且 $|z_T| \\le z^\\star$。\n\n该实现将通过此计算和逻辑流程处理测试套件中的每个基因，以生成最终的分类代码列表。\n\n**各基因的计算演练：**\n\n-   **基因 1：** $(1.05, 0.25, 1.00, 0.20)$。\n    $L_T = 1.05 - 1.00 = 0.05$。$s_T = \\sqrt{0.25^2 + 0.20^2} \\approx 0.3202$。\n    $z_C = 1.00 / 0.20 = 5.00$。$z_T = 0.05 / 0.3202 \\approx 0.156$。\n    $|z_C| > z^\\star$ 且 $|z_T| \\le z^\\star$。类别为 **1 (仅顺式)**。\n\n-   **基因 2：** $(1.20, 0.20, 0.05, 0.25)$。\n    $L_T = 1.20 - 0.05 = 1.15$。$s_T = \\sqrt{0.20^2 + 0.25^2} \\approx 0.3202$。\n    $z_C = 0.05 / 0.25 = 0.20$。$z_T = 1.15 / 0.3202 \\approx 3.592$。\n    $|z_C| \\le z^\\star$ 且 $|z_T| > z^\\star$。类别为 **2 (仅反式)**。\n\n-   **基因 3：** $(1.00, 0.10, 0.60, 0.10)$。\n    $L_T = 1.00 - 0.60 = 0.40$。$s_T = \\sqrt{0.10^2 + 0.10^2} \\approx 0.1414$。\n    $z_P = 1.00 / 0.10 = 10.00$。$z_C = 0.60 / 0.10 = 6.00$。$z_T = 0.40 / 0.1414 \\approx 2.828$。\n    所有效应均显著。$L_C \\cdot L_T = 0.60 \\cdot 0.40 > 0$。且 $|z_P| > z^\\star$。类别为 **3 (增强性)**。\n\n-   **基因 4：** $(0.10, 0.15, 0.70, 0.10)$。\n    $L_T = 0.10 - 0.70 = -0.60$。$s_T = \\sqrt{0.15^2 + 0.10^2} \\approx 0.1803$。\n    $z_P = 0.10 / 0.15 \\approx 0.667$。$z_C = 0.70 / 0.10 = 7.00$。$z_T = -0.60 / 0.1803 \\approx -3.328$。\n    $|z_C| > z^\\star$，$|z_T| > z^\\star$。$L_C \\cdot L_T = 0.70 \\cdot (-0.60) < 0$。且 $|z_P| \\le z^\\star$。类别为 **4 (补偿性)**。\n\n-   **基因 5：** $(0.05, 0.20, 0.10, 0.20)$。\n    $L_T = 0.05 - 0.10 = -0.05$。$s_T = \\sqrt{0.20^2 + 0.20^2} \\approx 0.2828$。\n    $z_C = 0.10 / 0.20 = 0.50$。$z_T = -0.05 / 0.2828 \\approx -0.177$。\n    $|z_C| \\le z^\\star$ 且 $|z_T| \\le z^\\star$。类别为 **0 (无证据)**。\n\n-   **基因 6：** $(-0.80, 0.10, -0.02, 0.20)$。\n    $L_T = -0.80 - (-0.02) = -0.78$。$s_T = \\sqrt{0.10^2 + 0.20^2} \\approx 0.2236$。\n    $z_C = -0.02 / 0.20 = -0.10$。$z_T = -0.78 / 0.2236 \\approx -3.488$。\n    $|z_C| \\le z^\\star$ 且 $|z_T| > z^\\star$。类别为 **2 (仅反式)**。\n\n-   **基因 7：** $(-0.46, 0.20, -0.50, 0.10)$。\n    $L_T = -0.46 - (-0.50) = 0.04$。$s_T = \\sqrt{0.20^2 + 0.10^2} \\approx 0.2236$。\n    $z_C = -0.50 / 0.10 = -5.00$。$z_T = 0.04 / 0.2236 \\approx 0.179$。\n    $|z_C| > z^\\star$ 且 $|z_T| \\le z^\\star$。类别为 **1 (仅顺式)**。\n\n-   **基因 8：** $(0.39, 0.20, 0.39, 0.20)$。\n    $L_T = 0.39 - 0.39 = 0.0$。$s_T = \\sqrt{0.20^2 + 0.20^2} \\approx 0.2828$。\n    $z_C = 0.39 / 0.20 = 1.95$。$z_T = 0.0 / 0.2828 = 0.0$。\n    由于 $1.95 < z^\\star \\approx 1.96$，我们有 $|z_C| \\le z^\\star$。我们也有 $|z_T| \\le z^\\star$。类别为 **0 (无证据)**。\n\n最终的整数代码序列是 $[1, 2, 3, 4, 0, 2, 1, 0]$。",
            "answer": "```python\nimport numpy as np\n# The problem statement indicates scipy is available, but it is not strictly\n# necessary as the critical value z* is provided numerically.\n# from scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Applies a quantitative classification scheme to infer cis and trans\n    regulatory contributions from gene expression summary statistics.\n    \"\"\"\n\n    # The critical value z* for a two-sided test at alpha = 0.05\n    # z_star = norm.ppf(1 - 0.05 / 2) -> 1.959963984540054\n    z_star = 1.959963984540054\n\n    # Test suite of genes, each specified by (L_P, s_P, L_C, s_C).\n    # The '$' symbols from the problem description are ignored.\n    test_cases = [\n        (1.05, 0.25, 1.00, 0.20),  # Gene 1\n        (1.20, 0.20, 0.05, 0.25),  # Gene 2\n        (1.00, 0.10, 0.60, 0.10),  # Gene 3\n        (0.10, 0.15, 0.70, 0.10),  # Gene 4\n        (0.05, 0.20, 0.10, 0.20),  # Gene 5\n        (-0.80, 0.10, -0.02, 0.20), # Gene 6\n        (-0.46, 0.20, -0.50, 0.10), # Gene 7\n        (0.39, 0.20, 0.39, 0.20),  # Gene 8\n    ]\n\n    results = []\n    for case in test_cases:\n        L_P, s_P, L_C, s_C = case\n\n        # Calculate the trans-regulatory effect and its standard error\n        L_T = L_P - L_C\n        s_T = np.sqrt(s_P**2 + s_C**2)\n\n        # Calculate the test statistics for parental, cis, and trans effects.\n        # Ensure no division by zero, although problem inputs have s > 0.\n        z_P = L_P / s_P if s_P > 0 else 0\n        z_C = L_C / s_C if s_C > 0 else 0\n        z_T = L_T / s_T if s_T > 0 else 0\n        \n        # Determine significance of each effect\n        is_cis_sig = np.abs(z_C) > z_star\n        is_trans_sig = np.abs(z_T) > z_star\n        is_parental_sig = np.abs(z_P) > z_star\n        \n        # Apply the classification rules using a nested conditional structure.\n        # This structure directly implements the logic from the problem statement.\n        code = -1 # Default/error code\n        if is_cis_sig and is_trans_sig:\n            if (L_C * L_T < 0) and (not is_parental_sig):\n                code = 4  # cis-trans compensatory\n            elif (L_C * L_T > 0) and is_parental_sig:\n                code = 3  # cis and trans reinforcing\n        elif is_cis_sig and not is_trans_sig:\n            code = 1  # cis-only\n        elif not is_cis_sig and is_trans_sig:\n            code = 2  # trans-only\n        elif not is_cis_sig and not is_trans_sig:\n            code = 0  # no evidence\n\n        results.append(code)\n    \n    # Format and print the final output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}