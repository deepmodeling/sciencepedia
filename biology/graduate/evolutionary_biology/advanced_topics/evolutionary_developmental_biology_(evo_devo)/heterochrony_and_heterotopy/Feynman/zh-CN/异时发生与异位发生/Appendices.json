{
    "hands_on_practices": [
        {
            "introduction": "异时性 (heterochrony) 描述了发育时间或速率的演化变化，是形态多样性的主要驱动力。为了精确理解不同类型的异时性，如幼态延续 (progenesis) 和新成幼态 (neoteny)，我们可以使用简化的数学模型来量化它们的效应。本练习将通过一个线性生长模型，引导你推导出这两种机制如何影响最终的成年形态，并让你学会如何直接比较改变发育时长和改变发育速率所产生的表型后果 。",
            "id": "2722168",
            "problem": "某一演化支中的一个形态计量性状在个体发育期间的生长模型为线性生长，该过程始于起始年龄 $t_0$，初始值为 $y_0$，生长速率为恒定的 $r$。因此，对于 $t \\in [t_0, t_1]$，该性状遵循 $y(t) = y_0 + r(t - t_0)$，并且生长在终止年龄 $t_1$ 时停止（即，对于 $t \\ge t_1$，$y(t) = y(t_1)$）。在异时性的语境下，幼态延续 (progenesis) 是一种促进成熟（提早终止）的转变，而新成幼态 (neoteny) 则是在不改变起始或终止时间安排的情况下降低发育速率的转变。假设该谱系从一个由 $(y_0, r, t_0, t_1)$ 定义的共同基线（其中 $t_1 > t_0$ 且 $r > 0$）出发，存在两种可替代的演化修饰：\n\n- 幼态延续 (Progenesis)：终止时间提前了 $\\Delta t_1$（其中 $0 < \\Delta t_1 < t_1 - t_0$），因此新的终止时间为 $t_1' = t_1 - \\Delta t_1$，而 $r$ 保持不变。\n- 新成幼态 (Neoteny)：生长速率降低了 $\\Delta r$（其中 $0 < \\Delta r < r$），因此新的速率为 $r' = r - \\Delta r$，而终止时间 $t_1$ 保持不变。\n\n设成年值为生长停止时的平台值，并将基线成年值记为 $y_{\\mathrm{adult}}$，幼态延续成年值记为 $y_{\\mathrm{prog}}$，新成幼态成年值记为 $y_{\\mathrm{neo}}$。为了比较这两种机制对成年表型的异时性效应的量级，将任何变异的效应大小定义为成年值的带符号比例变化，该变化是相对于基线成年增量的，其中基线成年增量是基线成年值与 $y_0$ 之间的差值。\n\n仅从线性生长模型和这些定义出发，将所有符号 $(y_0, r, t_0, t_1, \\Delta t_1, \\Delta r)$ 视为参数，完成以下任务：\n\n- 推导 $y_{\\mathrm{adult}}$、$y_{\\mathrm{prog}}$ 和 $y_{\\mathrm{neo}}$ 的表达式。\n- 推导幼态延续和新成幼态的效应大小的表达式，其形式为关于 $(t_0, t_1, r, \\Delta t_1, \\Delta r)$ 的函数。\n- 确定唯一的 $\\Delta r_{\\mathrm{eq}}$ 值，其为关于 $(t_0, t_1, r, \\Delta t_1)$ 的封闭形式解析表达式，该值使得幼态延续和新成幼态效应大小的绝对量级完全相等。\n\n以 $\\Delta r_{\\mathrm{eq}}$ 的单一封闭形式表达式提供最终答案。无需进行数值代入，也无需四舍五入。最终答案不带单位。",
            "solution": "首先对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- **生长模型：** 对于一个形态计量性状 $y(t)$，在个体发育期间从起始年龄 $t_0$ 到终止年龄 $t_1$，其生长是线性的：$y(t) = y_0 + r(t - t_0)$，适用于 $t \\in [t_0, t_1]$。\n- **生长停止：** 当 $t \\ge t_1$ 时，生长停止，性状值恒定：$y(t) = y(t_1)$。\n- **基线参数：** 基线谱系由参数集 $(y_0, r, t_0, t_1)$ 定义。\n- **参数约束：** $t_1 > t_0$ 且 $r > 0$。\n- **幼态延续修饰：** 终止年龄变为 $t_1' = t_1 - \\Delta t_1$，生长速率 $r$ 不变。约束条件为 $0 < \\Delta t_1 < t_1 - t_0$。\n- **新成幼态修饰：** 生长速率降至 $r' = r - \\Delta r$，终止年龄 $t_1$ 不变。约束条件为 $0 < \\Delta r < r$。\n- **成年值定义：** 成年值是生长停止时达到的平台值，分别记为 $y_{\\mathrm{adult}}$（基线）、$y_{\\mathrm{prog}}$（幼态延续）和 $y_{\\mathrm{neo}}$（新成幼态）。\n- **效应大小定义：** 修饰的效应大小是“成年值的带符号比例变化，相对于基线成年增量”。\n- **基线成年增量定义：** 基线成年增量是基线成年值与初始值 $y_0$ 的差值。\n- **任务：** 推导成年值和效应大小的表达式，并确定使幼态延续和新成幼态效应大小的绝对量级相等的特定值 $\\Delta r_{\\mathrm{eq}}$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题在演化发育生物学的理论框架内具有科学依据。它使用了一个简化的线性模型，这是形式化如异时性等生物学概念的常用且可接受的工具。幼态延续和新成幼态的定义与该领域中既定的含义一致。问题是适定的、客观的、自洽的；所有必要的参数、定义和约束都已提供，以指定一个唯一的数学任务。该问题需要基于这些定义进行多步推导，这并非易事，需要细致的代数操作。不存在矛盾、模糊或事实错误。\n\n**第3步：结论与行动**\n问题被判定为**有效**。将提供完整解答。\n\n推导过程如下。\n\n首先，我们根据给定的线性生长模型确定基线、幼态延续和新成幼态情况下的成年值。成年值是生长终止时的性状值。\n\n基线成年值 $y_{\\mathrm{adult}}$ 是性状在时间 $t_1$ 的值：\n$$y_{\\mathrm{adult}} = y(t_1) = y_0 + r(t_1 - t_0)$$\n\n幼态延续成年值 $y_{\\mathrm{prog}}$ 是由更早的终止时间 $t_1' = t_1 - \\Delta t_1$ 产生的。生长速率 $r$ 和起始参数 $(y_0, t_0)$ 保持不变：\n$$y_{\\mathrm{prog}} = y(t_1') = y_0 + r(t_1' - t_0) = y_0 + r(t_1 - \\Delta t_1 - t_0)$$\n\n新成幼态成年值 $y_{\\mathrm{neo}}$ 是由降低的生长速率 $r' = r - \\Delta r$ 产生的。时间参数 $(t_0, t_1)$ 保持不变：\n$$y_{\\mathrm{neo}} = y_0 + r'(t_1 - t_0) = y_0 + (r - \\Delta r)(t_1 - t_0)$$\n\n接下来，我们推导效应大小的表达式。效应大小 $E$ 定义为成年值的带符号比例变化，该变化是相对于基线成年增量的。基线成年增量（我们记为 $I_{\\mathrm{adult}}$）是 $y_{\\mathrm{adult}} - y_0$。\n$$I_{\\mathrm{adult}} = y_{\\mathrm{adult}} - y_0 = \\left(y_0 + r(t_1 - t_0)\\right) - y_0 = r(t_1 - t_0)$$\n对于一个给定修饰，其新成年值为 $y_{\\mathrm{new}}$，其效应大小的公式为：\n$$E = \\frac{y_{\\mathrm{new}} - y_{\\mathrm{adult}}}{I_{\\mathrm{adult}}}$$\n\n现在我们计算幼态延续的效应大小 $E_{\\mathrm{prog}}$。成年值的变化是：\n$$y_{\\mathrm{prog}} - y_{\\mathrm{adult}} = \\left(y_0 + r(t_1 - \\Delta t_1 - t_0)\\right) - \\left(y_0 + r(t_1 - t_0)\\right) = r(t_1 - \\Delta t_1 - t_0 - t_1 + t_0) = -r \\Delta t_1$$\n因此，幼态延续的效应大小为：\n$$E_{\\mathrm{prog}} = \\frac{-r \\Delta t_1}{r(t_1 - t_0)} = -\\frac{\\Delta t_1}{t_1 - t_0}$$\n这个结果是负的，这与幼态延续截断了生长期并导致幼态存留（即成年表型更小）的现象是一致的。\n\n类似地，我们计算新成幼态的效应大小 $E_{\\mathrm{neo}}$。成年值的变化是：\n$$y_{\\mathrm{neo}} - y_{\\mathrm{adult}} = \\left(y_0 + (r - \\Delta r)(t_1 - t_0)\\right) - \\left(y_0 + r(t_1 - t_0)\\right) = (r - \\Delta r - r)(t_1 - t_0) = -\\Delta r (t_1 - t_0)$$\n因此，新成幼态的效应大小为：\n$$E_{\\mathrm{neo}} = \\frac{-\\Delta r (t_1 - t_0)}{r(t_1 - t_0)} = -\\frac{\\Delta r}{r}$$\n这个结果也是负的，这与新成幼态降低发育速率并导致幼态存留的现象是一致的。\n\n最后，我们必须找到值 $\\Delta r_{\\mathrm{eq}}$，使得两种效应大小的绝对量级相等。条件是 $|E_{\\mathrm{prog}}| = |E_{\\mathrm{neo}}|$。\n$$|E_{\\mathrm{prog}}| = \\left|-\\frac{\\Delta t_1}{t_1 - t_0}\\right|$$\n$$|E_{\\mathrm{neo}}| = \\left|-\\frac{\\Delta r}{r}\\right|$$\n鉴于约束条件 $t_1 > t_0$、$\\Delta t_1 > 0$、$r > 0$ 和 $\\Delta r > 0$，绝对值内的两个表达式都为负。因此，我们可以写成：\n$$|E_{\\mathrm{prog}}| = \\frac{\\Delta t_1}{t_1 - t_0}$$\n$$|E_{\\mathrm{neo}}| = \\frac{\\Delta r}{r}$$\n我们令它们相等，并用 $\\Delta r_{\\mathrm{eq}}$ 替换 $\\Delta r$：\n$$\\frac{\\Delta r_{\\mathrm{eq}}}{r} = \\frac{\\Delta t_1}{t_1 - t_0}$$\n解此方程得到 $\\Delta r_{\\mathrm{eq}}$ 的唯一封闭形式表达式：\n$$\\Delta r_{\\mathrm{eq}} = r \\frac{\\Delta t_1}{t_1 - t_0}$$\n该表达式给出了生长速率的变化量 $\\Delta r_{\\mathrm{eq}}$，它所产生的新成幼态效应的量级，与由终止时间变化 $\\Delta t_1$ 所引起的幼态延续效应的量级相同。",
            "answer": "$$\\boxed{r \\frac{\\Delta t_1}{t_1 - t_0}}$$"
        },
        {
            "introduction": "除了发育时间的改变，发育事件在空间位置上的变化，即异位表达 (heterotopy)，同样是形态演化的关键机制。本练习将焦点从时间转向空间，通过一个关于脊椎动物肢体发育中 $Hox$ 基因表达的案例，让你亲手实践如何处理和解释比较发育数据。你将学习如何通过标准化来消除体型差异的干扰，从而准确量化基因表达边界的空间位移，并将其与最终的形态差异联系起来 。",
            "id": "2722088",
            "problem": "一项关于肢体发育的比较研究，调查了在两个分类单元（记作物种 $A$ 和物种 $B$）中，远端 Homeobox D13 (HoxD13) 基因在前肢芽近远轴上的表达存在的空间异位现象。设近远轴由坐标 $s$ 参数化，$s=0$ 位于近侧基部，$s=L$ 位于远侧尖端，其中 $L$ 是通过转录组分期确定的同源发育阶段的肢芽总长度。前肢芽中的后侧 HoxD13 表达域位于远端，占据 $s \\ge s^{\\ast}$ 的区域，其中 $s^{\\ast}$ 是沿近远轴测得的 HoxD13 表达起始的边界位置。\n\n已知以下测量数据：\n- 物种 $A$：肢芽总长度 $L_{A} = 1.80$ 毫米，HoxD13 边界位置 $s_{A}^{\\ast} = 1.26$ 毫米。\n- 物种 $B$：肢芽总长度 $L_{B} = 2.50$ 毫米，HoxD13 边界位置 $s_{B}^{\\ast} = 1.50$ 毫米。\n\n为了比较不同肢芽大小的物种之间的边界位置，为每个物种定义无量纲边界位置 $p = s^{\\ast}/L$，然后通过位移将种间差异映射回长度为 $L_{\\mathrm{std}}$ 的标准化肢体上\n$$\n\\Delta x_{\\mathrm{std}} = \\left(p_{B} - p_{A}\\right) L_{\\mathrm{std}},\n$$\n符号约定为 $\\Delta x_{\\mathrm{std}} > 0$ 表示物种 $B$ 的边界相对于物种 $A$ 更靠远侧。\n\n此外，为了在形态发生素阈值（法国国旗）图案形成模型下进行进化解释，观察到成年个体中的远端肢比例（记作 $R$）在物种 $A$ 中为 $R_{A} = 0.31$，在物种 $B$ 中为 $R_{B} = 0.42$。仅假设基本原则：HoxD13 阳性的远端区域对应于预期的远端肢区域，并且在这些阶段附近的一阶近似下，成年个体的远端肢比例 $R$ 随着 HoxD13 阳性区域在近远轴上的相对范围单调增加。\n\n任务：\n- 使用 $L_{\\mathrm{std}} = 2.00$ 毫米计算带符号的标准化位移 $\\Delta x_{\\mathrm{std}}$。答案以毫米为单位，并四舍五入至三位有效数字。\n\n注意：您的推理应基于核心定义（无量纲归一化，跨尺度映射）和形态发生素阈值图案形成的公认事实，不得引用任何未提供的快捷公式。最终报告值必须是单个实数。",
            "solution": "我们首先阐明坐标系和定义。对于每个物种，近远轴由 $s \\in [0,L]$ 表示，其中 $L$ 是在分期时间点的肢芽长度。HoxD13 表达域占据 $s \\ge s^{\\ast}$ 的区域，$s^{\\ast}$ 表示表达起始的边界位置。为了比较不同肢芽大小的物种之间的边界位置，我们首先通过构建分数将边界位置无量纲化\n$$\np \\equiv \\frac{s^{\\ast}}{L}.\n$$\n此步骤消除了绝对尺寸的影响，仅保留了沿肢体的相对位置。在长度为 $L_{\\mathrm{std}}$ 的标准化肢体上的空间异位位移则定义为\n$$\n\\Delta x_{\\mathrm{std}} = \\left(p_{B} - p_{A}\\right) L_{\\mathrm{std}},\n$$\n其中 $\\Delta x_{\\mathrm{std}} > 0$ 意味着物种 $B$ 的 HoxD13 边界相比物种 $A$ 更靠远侧（即 $s^{\\ast}$ 相对于 $L$ 更大）。\n\n根据给定数据计算 $p_{A}$ 和 $p_{B}$：\n- 对于物种 $A$，$L_{A} = 1.80$ 毫米，$s_{A}^{\\ast} = 1.26$ 毫米。因此，\n$$\np_{A} = \\frac{s_{A}^{\\ast}}{L_{A}} = \\frac{1.26}{1.80} = 0.70.\n$$\n- 对于物种 $B$，$L_{B} = 2.50$ 毫米，$s_{B}^{\\ast} = 1.50$ 毫米。因此，\n$$\np_{B} = \\frac{s_{B}^{\\ast}}{L_{B}} = \\frac{1.50}{2.50} = 0.60.\n$$\n\n现在使用 $L_{\\mathrm{std}} = 2.00$ 毫米计算标准化位移：\n$$\n\\Delta x_{\\mathrm{std}} = \\left(p_{B} - p_{A}\\right) L_{\\mathrm{std}} = \\left(0.60 - 0.70\\right) \\times 2.00 = (-0.10) \\times 2.00 = -0.20 \\text{ 毫米}.\n$$\n\n在异位性和形态差异背景下的解释：在形态发生素阈值（法国国旗）模型下，位于 $s^{\\ast}$ 的边界界定了远端区域的命运。HoxD13 阳性区域的长度是 $L - s^{\\ast}$，因此远端肢的比例为\n$$\nR = \\frac{L - s^{\\ast}}{L} = 1 - \\frac{s^{\\ast}}{L} = 1 - p.\n$$\n这个一般关系直接源于 $R$ 的定义，即肢体中对应于 HoxD13 阳性区域的部分。因此，$p$ 的减小意味着 $R$ 的增加。在测量数据中，$p_{B} - p_{A} = -0.10 < 0$，因此我们预期 $R_{B} - R_{A} > 0$。观察到的成年个体值 $R_{A} = 0.31$ 和 $R_{B} = 0.42$ 与该预测一致，表明物种 $B$ 中 HoxD13 边界的近端移位与远端肢比例的增加有关，这符合影响远端肢体形态的异位性变化的预期。\n\n最后，我们报告所要求的带符号的标准化位移。将 $-0.20$ 毫米四舍五入至三位有效数字得到 $-0.200$ 毫米。",
            "answer": "$$\\boxed{-0.200}$$"
        },
        {
            "introduction": "在真实的演化研究中，我们常常需要面对多种可能的解释，并利用数据来判断哪种假说更具说服力。本练习将你置于演化生物学家的角色，面对蝙蝠翅膀这一经典的演化新颖性案例，旨在检验其极度伸长的指骨是由更快的生长速率还是更长的生长时间所致。你将应用统计模型选择的方法来比较两种对立的异速生长假说，体验如何利用定量数据和计算方法来解决一个核心的演化发育生物学问题 。",
            "id": "2722110",
            "problem": "考虑使用一个基于指数细胞群体动力学的最小增殖生长框架，来模拟异时性下的异形成指/趾伸长。假设生长区内的增殖细胞群体遵循常微分方程 $dN/dt = r N$，其中 $N$ 是细胞数量，$r$ 是人均增殖率。如果指/趾长度 $L$ 在时间 $t$ 与 $N(t)$ 成正比，其比例常数 $k$ 对特定的指/趾芽是唯一的，则有 $L(t) = k N_{0} e^{r t}$，其中 $N_{0}$ 是伸长阶段开始时的初始细胞数量。对于参考物种（小鼠）中的一个目标指/趾 $i$，设小鼠的参数为 $r_{i}$（单位为 $\\text{day}^{-1}$），$T_{i}$（单位为 $\\text{days}$），以及观测到的最终长度 $L^{\\mathrm{mouse}}_{i}$（单位为 $\\text{mm}$）。对于衍生/特化物种（蝙蝠），观测到同一指/趾 $i$ 的异形成长度为 $L^{\\mathrm{bat}}_{i}$（单位为 $\\text{mm}$）。\n\n需要对所有指/趾 $i$ 评估两种相互竞争的异时性假说：\n- 速率偏移模型：$r^{\\mathrm{bat}}_{i} = \\alpha\\, r^{\\mathrm{mouse}}_{i}$，其中速率乘数 $\\alpha \\geq 1$ 为单一值，且时长 $T_{i}$ 相同。\n- 时长偏移模型：$T^{\\mathrm{bat}}_{i} = T^{\\mathrm{mouse}}_{i} + \\Delta t$，其中延长时间 $\\Delta t \\geq 0$（单位为 $\\text{days}$）为单一值，且速率 $r_{i}$ 相同。\n\n在比例性假设下，比率 $R_{i} = L^{\\mathrm{bat}}_{i} / L^{\\mathrm{mouse}}_{i}$ 对于速率偏移模型满足 $\\ln R_{i} = (\\alpha - 1)\\, r_{i} T_{i}$，对于时长偏移模型满足 $\\ln R_{i} = r_{i} \\Delta t$。给定观测到的数据对 $\\{L^{\\mathrm{mouse}}_{i}, L^{\\mathrm{bat}}_{i}\\}$ 和已知的 $\\{r_{i}, T_{i}\\}$，在对数空间中通过最小二乘法（LS）拟合每个模型，以获得使 $\\ln R_{i}$ 的残差平方和最小化的 $\\alpha$ 和 $\\Delta t$。通过将无约束的最小二乘估计投影到这些定义域上，来施加约束 $\\alpha \\geq 1$ 和 $\\Delta t \\geq 0$。\n\n您的任务是编写一个程序，在每个测试案例中，通过比较对数空间中的误差平方和，来判断哪个模型能更好地解释观测到的异形成长度。如果误差平方和的绝对差小于或等于容差 $\\tau = 10^{-8}$，则判定为平局。\n\n使用以下单位：$L$ 的单位为 $\\text{mm}$，$r$ 的单位为 $\\text{day}^{-1}$，$t$ 和 $T$ 的单位为 $\\text{days}$。不涉及角度。所有输出均为无单位的决策代码。\n\n对于每个测试案例，您将获得关于指/趾 2 至 5 的数组：小鼠长度 $L^{\\mathrm{mouse}}_{i}$、小鼠速率 $r_{i}$、小鼠时长 $T_{i}$ 和蝙蝠长度 $L^{\\mathrm{bat}}_{i}$。测试套件如下：\n\n- 测试案例 1（速率偏移生成，不同的 $T_{i}$）：\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,13.0,\\,12.0,\\,11.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,25.324,\\,29.240,\\,24.900,\\,28.404\\,]$ $\\text{mm}$\n\n- 测试案例 2（时长偏移生成，不同的 $r_{i}$）：\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,13.0,\\,12.0,\\,11.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,19.921,\\,21.030,\\,20.387,\\,24.952\\,]$ $\\text{mm}$\n\n- 测试案例 3（边界条件，具有相同的 $T_{i}$，当数据与任一模型持续匹配时，会产生精确的平局）：\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,12.0,\\,12.0,\\,12.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,12.327,\\,13.538,\\,13.666,\\,14.838\\,]$ $\\text{mm}$\n\n- 测试案例 4（含噪声的速率偏移生成，不同的 $T_{i}$）：\n  - $L^{\\mathrm{mouse}} = [\\,6.0,\\,7.0,\\,7.5,\\,6.8\\,]$ $\\text{mm}$\n  - $r = [\\,0.12,\\,0.11,\\,0.10,\\,0.13\\,]$ $\\text{day}^{-1}$\n  - $T = [\\,12.0,\\,13.0,\\,12.0,\\,11.0\\,]$ $\\text{days}$\n  - $L^{\\mathrm{bat}} = [\\,19.973,\\,21.322,\\,19.971,\\,20.503\\,]$ $\\text{mm}$\n\n对于每个测试案例，您的程序必须：\n- 对所有指/趾 $i$ 计算 $R_{i} = L^{\\mathrm{bat}}_{i} / L^{\\mathrm{mouse}}_{i}$ 和 $y_{i} = \\ln R_{i}$。\n- 在对数空间中使用 $y_{i} \\approx (\\alpha - 1)\\, x_{i}$ (其中 $x_{i} = r_{i} T_{i}$) 通过最小二乘法拟合速率偏移模型以估计 $\\alpha$。无约束的最小二乘估计为 $\\widehat{\\alpha}_{\\mathrm{unc}} = 1 + \\frac{\\sum_{i} x_{i} y_{i}}{\\sum_{i} x_{i}^{2}}$。通过设置 $\\widehat{\\alpha} = \\max\\{1, \\widehat{\\alpha}_{\\mathrm{unc}}\\}$ 来施加异形成约束。\n- 在对数空间中使用 $y_{i} \\approx r_{i} \\Delta t$ 通过最小二乘法拟合时长偏移模型以估计 $\\Delta t$。无约束的最小二乘估计为 $\\widehat{\\Delta t}_{\\mathrm{unc}} = \\frac{\\sum_{i} r_{i} y_{i}}{\\sum_{i} r_{i}^{2}}$。通过设置 $\\widehat{\\Delta t} = \\max\\{0, \\widehat{\\Delta t}_{\\mathrm{unc}}\\}$ 来施加异形成约束。\n- 计算每个模型在对数空间中的残差平方和，\n  $$\\mathrm{SSE}_{\\mathrm{rate}} = \\sum_{i} \\left(y_{i} - (\\widehat{\\alpha} - 1)\\, x_{i}\\right)^{2}, \\quad \\mathrm{SSE}_{\\mathrm{duration}} = \\sum_{i} \\left(y_{i} - r_{i} \\widehat{\\Delta t}\\right)^{2}.$$\n- 使用容差 $\\tau = 10^{-8}$ 判断哪个模型更优：如果 $\\mathrm{SSE}_{\\mathrm{rate}} + \\tau < \\mathrm{SSE}_{\\mathrm{duration}}$，输出决策代码 $0$；如果 $\\mathrm{SSE}_{\\mathrm{duration}} + \\tau < \\mathrm{SSE}_{\\mathrm{rate}}$，输出决策代码 $1$；否则输出代码 $2$。\n\n最终输出格式：您的程序应生成一行输出，其中包含 4 个测试案例的决策结果，格式为一个用方括号括起来的逗号分隔列表（例如，$[0,1,2,0]$）。程序不得读取任何输入，也不得打印任何其他内容。",
            "solution": "所提供的问题在科学上是合理的，在数学上是适定的。我们将着手提供一个解决方案。\n\n目标是基于参考物种（小鼠）和衍生/特化物种（蝙蝠）中观测到的指/趾长度，来区分两种相互竞争的异形成演化模型：速率偏移模型和时长偏移模型。两种模型的基础都是指/趾长度的指数增长定律，$L(t) = L_{0} e^{r t}$，其中 $L_{0}$ 是生长阶段开始时（$t=0$）的初始长度，$r$ 是人均增殖率，$t$ 是时间。经过生长时长 $T$ 后的最终长度为 $L=L_0 e^{rT}$。\n\n假设对于两个物种间的同源指/趾 $i$，初始条件参数 $L_0$ 是保守的，则最终长度的比率 $R_{i} = L^{\\mathrm{bat}}_{i} / L^{\\mathrm{mouse}}_{i}$ 由下式给出：\n$$\nR_{i} = \\frac{L_{0, i} e^{r^{\\mathrm{bat}}_i T^{\\mathrm{bat}}_i}}{L_{0, i} e^{r^{\\mathrm{mouse}}_i T^{\\mathrm{mouse}}_i}} = e^{r^{\\mathrm{bat}}_i T^{\\mathrm{bat}}_i - r^{\\mathrm{mouse}}_i T^{\\mathrm{mouse}}_i}\n$$\n取自然对数，得到我们分析的核心方程：\n$$\n\\ln(R_{i}) = r^{\\mathrm{bat}}_i T^{\\mathrm{bat}}_i - r^{\\mathrm{mouse}}_i T^{\\mathrm{mouse}}_i\n$$\n我们将可观测的对数比率记为 $y_{i} = \\ln(R_{i})$，参考参数记为 $r_{i} = r^{\\mathrm{mouse}}_i$ 和 $T_{i} = T^{\\mathrm{mouse}}_i$。\n\n这两种异时性假说可以表述为对数空间中的线性模型：\n\n1.  **速率偏移模型**：该模型假定演化变化是由于生长速率以一个因子 $\\alpha \\ge 1$ 加速，而时长保持不变。参数关系为 $r^{\\mathrm{bat}}_i = \\alpha r_i$ 和 $T^{\\mathrm{bat}}_i = T_i$。将这些代入对数比率方程可得：\n    $$\n    y_{i} = (\\alpha r_i) T_i - r_i T_i = (\\alpha - 1) r_i T_i\n    $$\n    这是一个 $y_{i} = \\beta_{\\mathrm{rate}} x_{i}$ 形式的线性模型，其中预测变量为 $x_{i} = r_{i} T_{i}$，斜率为 $\\beta_{\\mathrm{rate}} = \\alpha - 1$。约束条件 $\\alpha \\ge 1$ 意味着 $\\beta_{\\mathrm{rate}} \\ge 0$。\n\n2.  **时长偏移模型**：该模型假定变化是由于生长时长延长了 $\\Delta t \\ge 0$，而速率保持不变。参数关系为 $r^{\\mathrm{bat}}_i = r_i$ 和 $T^{\\mathrm{bat}}_i = T_i + \\Delta t$。代入可得：\n    $$\n    y_{i} = r_i (T_i + \\Delta t) - r_i T_i = r_i \\Delta t\n    $$\n    这是一个 $y_{i} = \\beta_{\\mathrm{duration}} z_{i}$ 形式的线性模型，其中预测变量为 $z_{i} = r_{i}$，斜率为 $\\beta_{\\mathrm{duration}} = \\Delta t$。约束条件 $\\Delta t \\ge 0$ 意味着 $\\beta_{\\mathrm{duration}} \\ge 0$。\n\n为了估计参数 $\\alpha$ 和 $\\Delta t$，我们对一个零截距的线性模型（$y = \\beta u$）采用普通最小二乘法（LS）。使残差平方和 $\\sum (y_i - \\beta u_i)^2$ 最小化的斜率 $\\beta$ 的 LS 估计量由下式给出：\n$$\n\\widehat{\\beta} = \\frac{\\sum_{i} u_{i} y_{i}}{\\sum_{i} u_{i}^{2}}\n$$\n将此方法应用于我们的模型，我们得到无约束的估计值：\n对于速率偏移模型，其中 $u_{i} = x_{i} = r_{i}T_{i}$ 且 $\\widehat{\\beta}_{\\mathrm{rate, unc}} = \\widehat{\\alpha}_{\\mathrm{unc}} - 1$：\n$$\n\\widehat{\\alpha}_{\\mathrm{unc}} - 1 = \\frac{\\sum_{i} (r_{i}T_{i}) y_{i}}{\\sum_{i} (r_{i}T_{i})^{2}} \\implies \\widehat{\\alpha}_{\\mathrm{unc}} = 1 + \\frac{\\sum_{i} (r_{i}T_{i}) y_{i}}{\\sum_{i} (r_{i}T_{i})^{2}}\n$$\n对于时长偏移模型，其中 $u_{i} = z_{i} = r_{i}$ 且 $\\widehat{\\beta}_{\\mathrm{duration, unc}} = \\widehat{\\Delta t}_{\\mathrm{unc}}$：\n$$\n\\widehat{\\Delta t}_{\\mathrm{unc}} = \\frac{\\sum_{i} r_{i} y_{i}}{\\sum_{i} r_{i}^{2}}\n$$\n通过将这些估计值投影到它们的有效域上，来施加异形成约束（$\\alpha \\geq 1$ 和 $\\Delta t \\geq 0$）：\n$$\n\\widehat{\\alpha} = \\max\\{1, \\widehat{\\alpha}_{\\mathrm{unc}}\\}\n$$\n$$\n\\widehat{\\Delta t} = \\max\\{0, \\widehat{\\Delta t}_{\\mathrm{unc}}\\}\n$$\n每个模型的拟合优度通过其在对数空间中的误差平方和（SSE）来量化，该值使用带约束的参数估计值计算：\n$$\n\\mathrm{SSE}_{\\mathrm{rate}} = \\sum_{i} \\left( y_{i} - (\\widehat{\\alpha} - 1) r_{i} T_{i} \\right)^{2}\n$$\n$$\n\\mathrm{SSE}_{\\mathrm{duration}} = \\sum_{i} \\left( y_{i} - \\widehat{\\Delta t} r_{i} \\right)^{2}\n$$\n具有较低 SSE 的模型被认为是对数据的更好解释。使用一个容差为 $\\tau = 10^{-8}$ 的决策规则来处理性能几乎相等的情况：\n- 如果 $\\mathrm{SSE}_{\\mathrm{rate}} + \\tau < \\mathrm{SSE}_{\\mathrm{duration}}$，则速率偏移模型更优（决策代码 $0$）。\n- 如果 $\\mathrm{SSE}_{\\mathrm{duration}} + \\tau < \\mathrm{SSE}_{\\mathrm{rate}}$，则时长偏移模型更优（决策代码 $1$）。\n- 否则，认为两个模型表现同样好（决策代码 $2$）。\n\n所提供的算法为每个测试案例自动化了整个流程，从原始的长度、速率和时长数据开始。",
            "answer": "```python\n# The final and complete solution is a self-contained Python program.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the heterochrony model comparison problem for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (rate-shift generated)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 13.0, 12.0, 11.0]),\n            \"L_bat\": np.array([25.324, 29.240, 24.900, 28.404])\n        },\n        # Test case 2 (duration-shift generated)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 13.0, 12.0, 11.0]),\n            \"L_bat\": np.array([19.921, 21.030, 20.387, 24.952])\n        },\n        # Test case 3 (boundary condition for tie)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 12.0, 12.0, 12.0]),\n            \"L_bat\": np.array([12.327, 13.538, 13.666, 14.838])\n        },\n        # Test case 4 (noisy rate-shift generated)\n        {\n            \"L_mouse\": np.array([6.0, 7.0, 7.5, 6.8]),\n            \"r\": np.array([0.12, 0.11, 0.10, 0.13]),\n            \"T\": np.array([12.0, 13.0, 12.0, 11.0]),\n            \"L_bat\": np.array([19.973, 21.322, 19.971, 20.503])\n        }\n    ]\n\n    results = []\n    tolerance = 1e-8\n\n    for case in test_cases:\n        L_mouse, r, T, L_bat = case[\"L_mouse\"], case[\"r\"], case[\"T\"], case[\"L_bat\"]\n\n        # Compute the response variable y_i = ln(R_i)\n        R_i = L_bat / L_mouse\n        y_i = np.log(R_i)\n\n        # Fit the rate-shift model\n        # Predictor variable x_i = r_i * T_i\n        x_i = r * T\n        # Unconstrained estimate for alpha\n        alpha_unc = 1.0 + np.dot(x_i, y_i) / np.dot(x_i, x_i)\n        # Constrained estimate, alpha >= 1\n        alpha_hat = np.maximum(1.0, alpha_unc)\n        \n        # Fit the duration-shift model\n        # Predictor variable is r_i\n        # Unconstrained estimate for Delta_t\n        delta_t_unc = np.dot(r, y_i) / np.dot(r, r)\n        # Constrained estimate, Delta_t >= 0\n        delta_t_hat = np.maximum(0.0, delta_t_unc)\n\n        # Compute Sum of Squared Errors (SSE) for each model\n        # SSE for rate-shift model\n        y_pred_rate = (alpha_hat - 1.0) * x_i\n        SSE_rate = np.sum((y_i - y_pred_rate)**2)\n        \n        # SSE for duration-shift model\n        y_pred_duration = delta_t_hat * r\n        SSE_duration = np.sum((y_i - y_pred_duration)**2)\n\n        # Decide which model is better based on SSE with tolerance\n        if SSE_rate + tolerance < SSE_duration:\n            decision_code = 0  # Rate-shift is better\n        elif SSE_duration + tolerance < SSE_rate:\n            decision_code = 1  # Duration-shift is better\n        else:\n            decision_code = 2  # Tie\n        \n        results.append(decision_code)\n\n    # Print the results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}