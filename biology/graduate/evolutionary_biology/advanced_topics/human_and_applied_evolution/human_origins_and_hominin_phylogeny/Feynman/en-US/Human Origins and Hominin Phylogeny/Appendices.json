{
    "hands_on_practices": [
        {
            "introduction": "Understanding the long-term demographic history of our ancestors is a central goal in human origins research. One of the most fundamental parameters we seek to estimate is the effective population size ($N_e$), which reflects the magnitude of genetic drift a population has experienced over long timescales. This exercise demonstrates how to apply core principles of neutral theory and coalescent theory to infer $N_e$ from observable, genome-wide data—specifically, nucleotide diversity ($\\pi$) and the mutation rate ($\\mu$). By working through this calculation , you will solidify your understanding of the key relationship $\\pi = 4N_e\\mu$ and appreciate its power in converting genetic variation into demographic insights.",
            "id": "2724541",
            "problem": "A research team is investigating the long-term demographic history of an ancestral population of anatomically modern humans during the Late Pleistocene. They obtain whole-genome data from autosomal, putatively neutral intergenic sites and estimate genome-wide nucleotide diversity (pairwise differences per site between two randomly sampled chromosomes), denoted by $\\pi$, to be $\\pi = 0.001$. Independent pedigree-based studies provide a per-site, per-generation mutation rate $\\mu = 1.25 \\times 10^{-8}$.\n\nAssume a panmictic, diploid population at mutation–drift equilibrium with a constant long-term effective population size, where mutations follow the infinite-sites model and selection at the analyzed sites is negligible. Using only these assumptions and core definitions of nucleotide diversity and effective population size, derive the relationship necessary to estimate the autosomal long-term effective population size $N_{e}$ from $\\pi$ and $\\mu$, compute the point estimate, and briefly explain why such an $N_{e}$ can differ from census size in hominin lineages.\n\nProvide your numerical estimate of $N_{e}$ rounded to two significant figures and report it in individuals. Your final reported answer must be a single number.",
            "solution": "The objective is to estimate the autosomal long-term effective population size, denoted $N_e$, from genome-wide nucleotide diversity, $\\pi$, and the per-generation mutation rate, $\\mu$. The provided assumptions are a panmictic, diploid population at mutation–drift equilibrium with constant $N_e$, operating under the infinite-sites mutation model with no selection.\n\nNucleotide diversity, $\\pi$, is defined as the average number of pairwise differences per site between two randomly sampled sequences (chromosomes) from a population. To derive the relationship between $\\pi$, $N_e$, and $\\mu$, we consider two gene lineages sampled at random from the present-day diploid population of effective size $N_e$.\n\nAccording to coalescent theory for a Wright-Fisher model of a diploid population, the probability that these two lineages coalesce (i.e., find their most recent common ancestor) in the immediately preceding generation is given by $\\frac{1}{2N_e}$. The time to coalescence, $T_2$, follows a geometric distribution with this probability of success. The expected time to the most recent common ancestor for these two lineages is therefore the inverse of this probability:\n$$E[T_2] = \\frac{1}{\\frac{1}{2N_e}} = 2N_e \\text{ generations}$$\n\nMutations are assumed to occur at a rate of $\\mu$ per site, per generation. Under the infinite-sites model, every new mutation occurs at a site that was not previously polymorphic. Therefore, the number of nucleotide differences between the two sequences is the total number of mutations that have accumulated along both lineages since their divergence from the common ancestor.\n\nThe total time separating the two sampled chromosomes is the sum of the lengths of the two branches leading back to their common ancestor. This total branch length is $2T_2$. The expected total branch length is $E[2T_2] = 2 E[T_2] = 2(2N_e) = 4N_e$ generations.\n\nThe expected number of mutations per site separating the two lineages is the product of the total mutational opportunity (total expected branch length in generations) and the mutation rate per generation. This quantity is, by definition, the nucleotide diversity $\\pi$.\n$$\\pi = (2 \\mu) \\times E[T_2]$$\nOr, more directly:\n$$\\pi = \\mu \\times E[\\text{total branch length}] = \\mu \\times (4N_e)$$\nThus, the fundamental relationship under these assumptions is:\n$$\\pi = 4N_e\\mu$$\n\nWe can now solve for the effective population size $N_e$:\n$$N_e = \\frac{\\pi}{4\\mu}$$\n\nThe problem provides the following values:\nNucleotide diversity, $\\pi = 0.001$.\nMutation rate, $\\mu = 1.25 \\times 10^{-8}$ per site per generation.\n\nSubstituting these values into the derived equation:\n$$N_e = \\frac{0.001}{4 \\times (1.25 \\times 10^{-8})}$$\nFirst, we compute the denominator:\n$$4 \\times 1.25 \\times 10^{-8} = 5.0 \\times 10^{-8}$$\nNow, we perform the division:\n$$N_e = \\frac{10^{-3}}{5.0 \\times 10^{-8}} = \\frac{1}{5.0} \\times 10^{-3 - (-8)} = 0.2 \\times 10^5 = 20000$$\nThe problem requires the estimate to be rounded to two significant figures. The calculated value is exactly $20000$, which can be expressed as $2.0 \\times 10^4$ to denote two significant figures.\n\nFinally, a brief explanation of why effective population size ($N_e$) can differ from census size ($N_c$) in hominin lineages is required. The effective population size is an idealized concept representing the size of a Wright-Fisher population that would experience the same magnitude of genetic drift as the actual population. In reality, $N_e$ is almost always smaller than the census size, $N_c$ (the actual number of individuals), due to violations of the ideal model's assumptions. For hominin lineages, key factors include:\n$1$. **Variation in reproductive success:** If there is a high variance in the number of offspring among individuals, where some contribute disproportionately more to the next generation (e.g., due to social structures or sexual selection), genetic drift is accelerated, and $N_e$ is reduced.\n$2$. **Unequal sex ratio:** A skewed ratio of breeding males to breeding females reduces $N_e$. The effective size is sensitive to the number of the less numerous sex, as given by the formula $N_e = \\frac{4N_m N_f}{N_m + N_f}$. Polygynous or polyandrous mating systems, which are plausible for various hominin groups, would lead to $N_e < N_c$.\n$3$. **Fluctuations in population size:** The long-term effective size is determined by the harmonic mean of the population size over time. This mean is heavily weighted by periods of small population size (bottlenecks). Hominin history, particularly for *Homo sapiens*, is characterized by demographic bottlenecks, such as those associated with the \"Out of Africa\" migrations, which would dramatically reduce the long-term $N_e$ relative to the census size at any given time.",
            "answer": "$$\\boxed{2.0 \\times 10^4}$$"
        },
        {
            "introduction": "While phylogenetic trees often assume a history of clean splits, the story of human evolution is increasingly understood to involve complex episodes of interbreeding, or introgression, between distinct lineages. The Patterson’s $D$-statistic, also known as the ABBA-BABA test, is a powerful tool designed to detect such ancient gene flow by testing for a significant excess of shared derived alleles. This exercise  guides you through the calculation of the $D$-statistic and, critically, the assessment of its statistical significance using the block-jackknife procedure, providing practical skills for identifying admixture events from genomic data.",
            "id": "2724590",
            "problem": "Consider a four-taxon test for gene flow using the ABBA–BABA framework applied to hominin phylogeny: population $P_1$ is a West African population (Yoruba), population $P_2$ is a European population, population $P_3$ is a high-coverage Neanderthal genome, and $O$ is Chimpanzee as the outgroup to polarize derived alleles. Assume biallelic sites, correct ancestral state polarization, and that linkage disequilibrium is accounted for by partitioning the genome into $20$ approximately equal-length, non-overlapping blocks. Across all informative sites, the genome-wide counts of site patterns are $ABBA = 120$ and $BABA = 80$. You are provided with block-wise leave-one-block-out jackknife contributions defined as $v_i = \\left(D_{(i)} - \\bar{D}\\right)^2$, where $D_{(i)}$ is the leave-one-block-out estimator of Patterson’s $D$-statistic and $\\bar{D}$ is the mean of the $D_{(i)}$ across the $20$ blocks. The $20$ values of $v_i$ are:\n$$\n\\{\\,1.0 \\times 10^{-4},\\, 1.2 \\times 10^{-4},\\, 1.5 \\times 10^{-4},\\, 9.0 \\times 10^{-5},\\, 1.4 \\times 10^{-4},\\, 1.3 \\times 10^{-4},\\, 1.1 \\times 10^{-4},\\, 1.6 \\times 10^{-4},\\, 1.2 \\times 10^{-4},\\, 1.4 \\times 10^{-4},\\, 1.3 \\times 10^{-4},\\, 1.1 \\times 10^{-4},\\, 1.7 \\times 10^{-4},\\, 1.0 \\times 10^{-4},\\, 1.3 \\times 10^{-4},\\, 1.2 \\times 10^{-4},\\, 1.4 \\times 10^{-4},\\, 2.2 \\times 10^{-4},\\, 1.5 \\times 10^{-4},\\, 1.1 \\times 10^{-4}\\,\\}.\n$$\nStarting from first principles appropriate to evolutionary inference in this setting, compute the genome-wide Patterson’s $D$-statistic from the counts, construct the block-jackknife standard error for $D$ using the $20$ blocks, and then compute the corresponding two-sided normal approximation $Z$-score for testing the null hypothesis of no excess allele sharing (that is, no asymmetric gene flow). Use the widely adopted criterion that $|Z| \\ge 3$ indicates statistical significance in this context, and interpret the result biologically in terms of excess allele sharing between $P_2$ and $P_3$ relative to $P_1$. Report as your final numeric answer the $Z$-score rounded to four significant figures. State the $Z$-score as a dimensionless quantity.",
            "solution": "The problem requires the calculation of the Patterson's $D$-statistic, its standard error using a block-jackknife procedure, and the resultant $Z$-score to test for gene flow.\n\nThe null hypothesis, $H_0$, posits a strict bifurcating phylogeny $((P_1, P_2), P_3), O$ with no gene flow between the ingroup clades. Under this model, ancestral polymorphisms that sort into $P_1$, $P_2$, and $P_3$ are the sole source of discordant phylogenies. This process, known as incomplete lineage sorting (ILS), is expected to produce the derived site patterns 'ABBA' and 'BABA' in equal frequencies. Here, 'A' denotes the ancestral allele (as in the outgroup $O$) and 'B' denotes the derived allele. An excess of 'ABBA' patterns, where $P_2$ and $P_3$ share the derived allele, suggests gene flow between them. Conversely, an excess of 'BABA' patterns, where $P_1$ and $P_3$ share the derived allele, would suggest gene flow between them.\n\nPatterson's $D$-statistic quantifies the asymmetry in these site pattern counts. It is defined as:\n$$\nD = \\frac{\\sum_j (C_{ABBA,j} - C_{BABA,j})}{\\sum_j (C_{ABBA,j} + C_{BABA,j})}\n$$\nwhere $C_{ABBA,j}$ and $C_{BABA,j}$ are indicator variables for the site patterns at site $j$. For genome-wide counts, this simplifies to:\n$$\nD = \\frac{N_{ABBA} - N_{BABA}}{N_{ABBA} + N_{BABA}}\n$$\nwhere $N_{ABBA}$ and $N_{BABA}$ are the total counts of the respective patterns.\n\nUsing the provided data, $N_{ABBA} = 120$ and $N_{BABA} = 80$, the genome-wide $D$-statistic is:\n$$\nD = \\frac{120 - 80}{120 + 80} = \\frac{40}{200} = 0.2\n$$\nA positive value of $D$ indicates an excess of 'ABBA' sites, suggesting excess allele sharing between population $P_2$ (European) and $P_3$ (Neanderthal).\n\nTo assess the statistical significance of this deviation from the null expectation ($D=0$), we must compute the standard error of the estimate, $SE_D$. The problem specifies a block-jackknife procedure over $n=20$ blocks. The formula for the standard error of a jackknife estimate is:\n$$\nSE_D = \\sqrt{\\frac{n-1}{n} \\sum_{i=1}^{n} (D_{(i)} - \\bar{D})^2}\n$$\nwhere $D_{(i)}$ is the $D$-statistic calculated with the $i$-th block removed, and $\\bar{D}$ is the mean of these $n$ values of $D_{(i)}$. The problem provides the quantities $v_i = (D_{(i)} - \\bar{D})^2$ directly. Thus, we first need to calculate the sum of these values.\nThe values of $v_i$ are given, one of which is $9.0 \\times 10^{-5} = 0.9 \\times 10^{-4}$. The sum $\\sum_{i=1}^{20} v_i$ is:\n$$\n\\sum_{i=1}^{20} v_i = (1.0 + 1.2 + 1.5 + 0.9 + 1.4 + 1.3 + 1.1 + 1.6 + 1.2 + 1.4 + 1.3 + 1.1 + 1.7 + 1.0 + 1.3 + 1.2 + 1.4 + 2.2 + 1.5 + 1.1) \\times 10^{-4}\n$$\n$$\n\\sum_{i=1}^{20} v_i = 26.4 \\times 10^{-4}\n$$\nNow, substitute this sum into the standard error formula with $n=20$:\n$$\nSE_D = \\sqrt{\\frac{20-1}{20} \\sum_{i=1}^{20} v_i} = \\sqrt{\\frac{19}{20} \\times (26.4 \\times 10^{-4})}\n$$\n$$\nSE_D = \\sqrt{0.95 \\times 26.4 \\times 10^{-4}} = \\sqrt{25.08 \\times 10^{-4}}\n$$\n$SE_D \\approx 5.0079936 \\times 10^{-2}$.\n\nFinally, we compute the $Z$-score. The $Z$-score for testing the null hypothesis $H_0: D=0$ is given by the ratio of the estimate to its standard error, assuming a normal distribution for the estimator under the Central Limit Theorem.\n$$\nZ = \\frac{D}{SE_D}\n$$\nSubstituting the calculated values:\n$$\nZ = \\frac{0.2}{\\sqrt{25.08 \\times 10^{-4}}} \\approx \\frac{0.2}{0.050079936} \\approx 3.993615\n$$\nThe problem requires rounding the $Z$-score to four significant figures.\n$$\nZ \\approx 3.994\n$$\nThis value of $Z$ is then compared to the significance threshold. The problem states that $|Z| \\ge 3$ indicates statistical significance. Since $|3.994| = 3.994 \\ge 3$, the null hypothesis of no gene flow is rejected with high confidence.\n\nThe biological interpretation is that there is a statistically significant excess of shared derived alleles between the European population ($P_2$) and the Neanderthal population ($P_3$), relative to the West African population ($P_1$). This result is strong evidence for admixture (gene flow) from Neanderthals into the ancestors of modern Europeans after they diverged from the ancestors of modern West Africans. This is consistent with the established scientific consensus on human evolution.",
            "answer": "$$\n\\boxed{3.994}\n$$"
        },
        {
            "introduction": "Detecting the presence of ancient admixture is often just the first step; a deeper question is understanding the nature of the contact. For instance, did gene flow occur as a single, discrete pulse, or was it the result of continuous migration over many generations? This advanced practice explores how the decay of admixture-induced linkage disequilibrium (LD) with genetic distance can distinguish between these scenarios. By developing a simulation study , you will derive the expected LD decay curves under different models and use this theoretical foundation to classify simulated data, gaining insight into the sophisticated model-based approaches used to characterize the dynamics of ancient introgression.",
            "id": "2724604",
            "problem": "You are asked to design and implement a reproducible simulation study to algorithmically distinguish a single pulse of admixture from continuous migration by exploiting the decay of linkage disequilibrium (LD) with genetic distance. Your program must synthesize an admixture-induced LD decay curve under each demographic scenario, fit a parsimonious model that captures the expected signature of a single event, quantify the lack-of-fit, and then classify whether the underlying scenario is more consistent with a single pulse or continuous migration. All genetic distances must be treated as genetic map units measured in Morgans, and all distances in your simulation must be expressed in Morgans.\n\nBase principles to use:\n- Recombination events can be modeled as a Poisson process along the genetic map, and the probability that two neutral loci separated by a genetic distance $d$ jointly inherit the same ancestry track across generations declines monotonically as a function of $d$ and the distribution of the times when migrant ancestry entered the population.\n- A single pulse of admixture contributing a fixed fraction in a single generation creates long-range correlations in local ancestry that are governed by a single characteristic time-scale of decay across $d$, whereas continuous migration across multiple generations creates a superposition of contributions from many entry times, each contributing its own time-scale, resulting in a mixture of decays.\n\nYour tasks:\n1. Derive from first principles the expected functional form of the admixture-induced LD decay signal as a function of genetic distance $d$ for both scenarios:\n   - A single pulse of admixture that occurred $t$ generations in the past.\n   - Continuous migration at a constant per-generation rate $m$ across $G$ generations.\n   In both cases, the signal you will simulate is the expected decay curve, and you will add small, multiplicative log-normal noise to mimic sampling noise while preserving positivity.\n\n2. Implement a simulator that, given a grid of genetic distances $d \\in [0,0.5]$ Morgans at increments of $0.01$ Morgans, generates a noisy decay curve for each scenario using the derived functional form. The noise model must be multiplicative log-normal: for each $d$, multiply the ideal curve value by $\\exp(\\epsilon)$ where $\\epsilon$ is a zero-mean normal random variable with standard deviation $0.004$ in natural-log units. Use a fixed random seed to ensure exact reproducibility.\n\n3. Fit a single-exponential-in-$d$ model in logarithmic space by ordinary least squares, that is, fit a straight line to $\\log$ of the simulated curve as a function of $d$ via linear regression with an intercept. Compute the root-mean-square error (RMSE) of the residuals in log space across the entire $d$ grid. Based on the conceptual expectation that a single pulse generates a single characteristic time-scale (linear in log space), while continuous migration generates a mixture of time-scales (nonlinear in log space), implement the following decision rule: classify as \"continuous migration\" if the RMSE exceeds the threshold $0.008$, and classify as \"single pulse\" otherwise. Encode the classification as an integer: output $1$ for \"continuous migration\" and $0$ for \"single pulse\".\n\n4. Test Suite. Your program must evaluate the following six parameter sets in this exact order, using the same distance grid and noise model as defined above:\n   - Case A (single pulse): $t = 5$.\n   - Case B (single pulse): $t = 40$.\n   - Case C (continuous migration): $m = 0.02$, $G = 50$.\n   - Case D (continuous migration): $m = 0.005$, $G = 200$.\n   - Case E (boundary condition, continuous migration that collapses to a single generation): $m = 0.3$, $G = 1$.\n   - Case F (continuous migration): $m = 0.05$, $G = 10$.\n\n5. Final Output Format. Your program should produce a single line of output containing the six integer classifications for Cases A–F, as a comma-separated list enclosed in square brackets (for example, \"[0,1,1,0,0,1]\"). No other output is permitted.\n\nNotes:\n- You must not assume any external files or inputs. All values must be embedded in the program.\n- All genetic distances are in Morgans. No other physical units are involved in the required outputs.\n- The answers for each test case are integers as specified above, and the final output must aggregate them in the specified single-line format.",
            "solution": "The core of the problem is to distinguish two demographic histories, a single admixture pulse and continuous migration, by analyzing the shape of the linkage disequilibrium (LD) decay curve. The fundamental principle is that recombination, modeled as a Poisson process, breaks down ancestral chromosome segments over time. The rate of this breakdown depends on the time since admixture and the genetic distance $d$ between loci.\n\n**1. Derivation of LD Decay Models**\n\nWe derive the functional form for the expected LD decay signal, which we denote $L(d)$, as a function of genetic distance $d$ in Morgans.\n\n**Scenario A: Single Pulse Admixture**\n\nConsider an admixture event that occurred as a single pulse $t$ generations in the past. Chromosomal segments from the migrant population are introduced into the admixed population at this time. For two loci at a genetic distance $d$, the correlation in their ancestry depends on the probability that the segment connecting them has not been broken by a recombination event in any of the $t$ generations since the pulse.\n\nThe probability of no recombination occurring across a segment of length $d$ in a single meiosis is $e^{-d}$. The probability of this segment remaining intact over $t$ independent generations of meiosis is $(e^{-d})^t = e^{-td}$. The admixture-induced LD signal is directly proportional to this survival probability. We can therefore write the functional form of the decay as:\n$$L_{\\text{pulse}}(d) = C_1 e^{-td}$$\nwhere $C_1$ is an amplitude constant dependent on admixture proportions.\n\nFor the purpose of analyzing the decay shape, we can normalize the amplitude. Taking the natural logarithm of this function yields:\n$$\\log(L_{\\text{pulse}}(d)) = \\log(C_1) - td$$\nThis equation is linear in $d$, with a slope of $-t$ and an intercept of $\\log(C_1)$. This confirms the premise that a single pulse event leads to a simple exponential decay, which appears as a straight line in logarithmic space.\n\n**Scenario B: Continuous Migration**\n\nConsider a continuous migration process occurring at a constant rate $m$ over a period of $G$ generations, from generation $g=1$ to $g=G$ in the past. Migrant segments entering the population at different times will have experienced different numbers of generations of recombination. A segment that entered $g$ generations ago contributes to the LD signal with a decay of the form $e^{-gd}$.\n\nThe total LD signal is a superposition, or a weighted sum, of the contributions from each generation of migration. Let $w_g$ be the relative contribution to the observed LD from segments that entered at generation $g$. The total signal is:\n$$L_{\\text{continuous}}(d) = C_2 \\sum_{g=1}^{G} w_g e^{-gd}$$\nThe problem does not specify the weights $w_g$. For a simplified model of \"continuous\" flow, a reasonable and standard assumption is that each generation of the migration period contributes equally to the pool of migrant segments. This corresponds to uniform weights, $w_g = 1/G$ for $g \\in \\{1, 2, \\dots, G\\}$. The model becomes:\n$$L_{\\text{continuous}}(d) = C_2 \\frac{1}{G} \\sum_{g=1}^{G} e^{-gd}$$\nThis is a sum of multiple exponential functions with different decay rates. The resulting function is not a single exponential. Its logarithm, $\\log(L_{\\text{continuous}}(d))$, is not a linear function of $d$. The sum is a geometric series which can be written in closed form:\n$$\\sum_{g=1}^{G} (e^{-d})^g = e^{-d} \\frac{1 - e^{-Gd}}{1 - e^{-d}}$$\nTherefore:\n$$L_{\\text{continuous}}(d) = C_2 \\frac{e^{-d}(1 - e^{-Gd})}{G(1 - e^{-d})}$$\nWhen a linear model is fitted to $\\log(L_{\\text{continuous}}(d))$, the inherent curvature will result in significant model misspecification error, which can be quantified by the root-mean-square error (RMSE) of the residuals.\n\n**2. Simulation and Classification Procedure**\n\nThe analysis will proceed algorithmically as follows:\n\n1.  **Define Grid**: A grid of genetic distances $d$ is established from $0$ to $0.5$ Morgans, with an increment of $0.01$ Morgans. This results in $N=51$ data points.\n\n2.  **Simulate Decay Curve**: For each test case, the ideal decay curve $L_{\\text{ideal}}(d)$ is generated using the appropriate derived formula (single pulse or continuous migration) with unit amplitude ($C_1=C_2=1$).\n    -   Single Pulse: $L(d) = e^{-td}$\n    -   Continuous Migration: $L(d) = \\frac{1}{G} \\sum_{g=1}^{G} e^{-gd}$\n    A noisy simulated curve $L_{\\text{sim}}(d)$ is then produced by introducing multiplicative log-normal noise:\n    $$L_{\\text{sim}}(d_i) = L_{\\text{ideal}}(d_i) \\cdot \\exp(\\epsilon_i)$$\n    where $\\epsilon_i$ are independent samples from a normal distribution $\\mathcal{N}(0, \\sigma^2)$ with $\\sigma = 0.004$. A fixed random seed is used to ensure reproducibility.\n\n3.  **Perform Linear Regression**: The simulated data is log-transformed, $z_i = \\log(L_{\\text{sim}}(d_i))$. An ordinary least squares linear regression is performed to fit the model $z(d) = \\beta_0 + \\beta_1 d$ to the transformed data points $(d_i, z_i)$. This finds the best-fit line.\n\n4.  **Quantify Goodness-of-Fit**: The root-mean-square error (RMSE) of the residuals in log space is calculated. The residuals are $r_i = z_i - (\\hat{\\beta}_0 + \\hat{\\beta}_1 d_i)$, where $\\hat{\\beta}_0$ and $\\hat{\\beta}_1$ are the estimated regression coefficients. The RMSE is:\n    $$RMSE = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} r_i^2}$$\n    For a true single-pulse scenario, the residuals $r_i$ arise only from the noise term $\\epsilon_i$, so the RMSE is expected to be close to $\\sigma = 0.004$. For a continuous migration scenario, the residuals additionally include the systematic error from fitting a line to a curve, resulting in a significantly larger RMSE.\n\n5.  **Classify Scenario**: A decision is made based on the calculated RMSE and a predefined threshold:\n    -   If $RMSE > 0.008$: The large error suggests non-linearity, characteristic of continuous migration. The case is classified as 'continuous migration' (output $1$).\n    -   If $RMSE \\leq 0.008$: The small error is consistent with linearity, characteristic of a single pulse. The case is classified as 'single pulse' (output $0$).\n\nThis procedure is applied to each of the six specified test cases to determine its classification. The boundary case of continuous migration over $G=1$ generation is expected to behave identically to a single pulse at $t=1$, providing a critical check of the model's self-consistency.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and implements a simulation to distinguish single pulse from continuous migration\n    based on linkage disequilibrium decay, as specified in the problem statement.\n    \"\"\"\n    \n    # Define the six test cases as per the problem statement\n    test_cases = [\n        {'type': 'pulse', 'params': {'t': 5}, 'label': 'A'},\n        {'type': 'pulse', 'params': {'t': 40}, 'label': 'B'},\n        {'type': 'continuous', 'params': {'m': 0.02, 'G': 50}, 'label': 'C'},\n        {'type': 'continuous', 'params': {'m': 0.005, 'G': 200}, 'label': 'D'},\n        {'type': 'continuous', 'params': {'m': 0.3, 'G': 1}, 'label': 'E'},\n        {'type': 'continuous', 'params': {'m': 0.05, 'G': 10}, 'label': 'F'}\n    ]\n\n    # Global parameters for the simulation\n    d = np.arange(0.0, 0.501, 0.01) # Genetic distance grid from 0 to 0.5 Morgans\n    sigma_noise = 0.004 # Standard deviation of log-normal noise\n    rmse_threshold = 0.008 # Decision threshold for classification\n    \n    # Set a fixed random seed for reproducibility\n    np.random.seed(0)\n\n    results = []\n\n    for case in test_cases:\n        # 1. Generate the ideal LD decay curve\n        if case['type'] == 'pulse':\n            t = case['params']['t']\n            # Functional form for single pulse: L(d) = exp(-t*d)\n            y_ideal = np.exp(-t * d)\n        elif case['type'] == 'continuous':\n            G = case['params']['G']\n            # Parameter m is not used for the decay shape, only G matters.\n            # Functional form for continuous migration: L(d) = 1/G * sum_{g=1 to G} exp(-g*d)\n            # Vectorized implementation for efficiency:\n            g_gens = np.arange(1, G + 1).reshape(-1, 1) # Generations as a column vector\n            d_grid = d.reshape(1, -1)                  # Distances as a row vector\n            matrix_gd = g_gens @ d_grid                # Outer product g*d\n            exp_matrix = np.exp(-matrix_gd)\n            y_ideal = np.mean(exp_matrix, axis=0) # Average over generations\n        else:\n            # This path should not be reached with the given test cases\n            raise ValueError(f\"Unknown case type: {case['type']}\")\n\n        # 2. Add multiplicative log-normal noise\n        noise = np.random.normal(loc=0.0, scale=sigma_noise, size=len(d))\n        y_sim = y_ideal * np.exp(noise)\n\n        # 3. Fit a linear model in log space\n        log_y_sim = np.log(y_sim)\n        \n        # OLS linear regression (degree 1 polynomial fit)\n        # coeffs[0] is the slope, coeffs[1] is the intercept\n        coeffs = np.polyfit(d, log_y_sim, 1)\n        y_fit = coeffs[0] * d + coeffs[1]\n        \n        # 4. Compute RMSE of the residuals\n        residuals = log_y_sim - y_fit\n        rmse = np.sqrt(np.mean(residuals**2))\n\n        # 5. Classify based on the RMSE threshold\n        classification = 1 if rmse > rmse_threshold else 0\n        results.append(classification)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}