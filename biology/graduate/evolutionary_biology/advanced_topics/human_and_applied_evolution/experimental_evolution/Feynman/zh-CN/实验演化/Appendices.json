{
    "hands_on_practices": [
        {
            "introduction": "竞争实验是实验进化的基石。通过追踪菌株频率随时间的变化，我们可以推断出适应度差异。本练习将指导你基于一个简化的指数增长和二项采样模型，推导出选择系数 $s$ 的标准估计量及其统计不确定性，这是分析实验数据的基本功 。",
            "id": "2712517",
            "problem": "在一批次培养的实验性演化分析中，两个无性生殖品系（表示为$A$和$B$）在恒定条件下竞争$t$代。假设每个品系每代具有恒定的马尔萨斯适应度，分别表示为$m_A$和$m_B$，并且确定性种群动态遵循指数增长，因此预期丰度满足$N_A(t) = N_A(0)\\exp(m_A t)$和$N_B(t) = N_B(0)\\exp(m_B t)$。将每代选择系数定义为$s = m_A - m_B$。在时间$0$和时间$t$，您使用流式细胞术对充分混合的大等分试样进行测量，以确定品系的相对丰度，在时间$0$从总共$N_0 = A_0 + B_0$个事件中产生计数$(A_0,B_0)$，在时间$t$从总共$N_t = A_t + B_t$个事件中产生计数$(A_t,B_t)$。将每个时间点的细胞术取样建模为从真实基础频率$p_\\tau = N_A(\\tau)/[N_A(\\tau)+N_B(\\tau)]$进行的独立二项式抽取，样本大小为$N_\\tau$，即，对于$\\tau \\in \\{0,t\\}$，$A_\\tau \\sim \\mathrm{Binomial}(N_\\tau, p_\\tau)$，其中$B_\\tau = N_\\tau - A_\\tau$。\n\n从这些假设以及选择系数作为马尔萨斯参数差异的定义出发，推导：\n- 一个以观测计数$(A_0,B_0,A_t,B_t)$和已知代数$t$表示的闭式估计量$\\hat{s}$，以及\n- 一个$\\mathrm{Var}(\\hat{s})$的一阶delta方法近似，该近似考虑了在时间$0$和$t$流式细胞术计数中的取样方差。\n\n陈述您所引用的任何正则性假设，并对任何未知的滋扰参数使用即插法。以精确的解析表达式提供您的最终答案。将$s$以每代为单位表示。不要在最终的方框答案中包含单位。如果您选择呈现多个表达式，请将它们表示为单个行向量。",
            "solution": "该问题要求从竞争性生长和二项式取样模型中，推导出选择系数的估计量$\\hat{s}$及其方差$\\mathrm{Var}(\\hat{s})$的一阶近似。\n\n我们首先验证问题陈述。\n**步骤1：提取已知条件**\n- 品系：$A$和$B$，无性生殖。\n- 竞争时间：$t$代。\n- 马尔萨斯适应度参数：$m_A$, $m_B$。\n- 种群动态：$N_A(t) = N_A(0)\\exp(m_A t)$和$N_B(t) = N_B(0)\\exp(m_B t)$。\n- 选择系数：$s = m_A - m_B$。\n- 观测计数：在时间$\\tau=0$时，从大小为$N_0 = A_0 + B_0$的样本中得到$(A_0, B_0)$；在时间$\\tau=t$时，从大小为$N_t = A_t + B_t$的样本中得到$(A_t, B_t)$。\n- 取样模型：对于$\\tau \\in \\{0,t\\}$，$A_\\tau \\sim \\mathrm{Binomial}(N_\\tau, p_\\tau)$，其中$p_\\tau = N_A(\\tau) / (N_A(\\tau)+N_B(\\tau))$是品系$A$在时间$\\tau$的真实频率。两个样本是独立的。\n- 任务：推导一个以$(A_0, B_0, A_t, B_t, t)$表示的闭式估计量$\\hat{s}$，并使用delta方法和对未知参数的即插法来近似$\\mathrm{Var}(\\hat{s})$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了群体遗传学和实验演化中的标准模型（指数增长、马尔萨斯适应度、二项式取样）。该问题提法恰当，为获得唯一解提供了足够的信息。其语言客观而精确。这些假设虽然是对现实的简化，但在许多微生物演化实验的背景下是标准且合理的。该问题并非微不足道，需要严格应用统计学理论。因此，该问题被认为是有效的。\n\n**步骤3：进行求解**\n\n**估计量$\\hat{s}$的推导**\n\n两个品系的种群动态由以下公式给出：\n$$N_A(t) = N_A(0)\\exp(m_A t)$$\n$$N_B(t) = N_B(0)\\exp(m_B t)$$\n我们考虑在时间$t$时两个品系丰度的比率：\n$$ \\frac{N_A(t)}{N_B(t)} = \\frac{N_A(0)\\exp(m_A t)}{N_B(0)\\exp(m_B t)} = \\frac{N_A(0)}{N_B(0)} \\exp\\left( (m_A - m_B)t \\right) $$\n使用选择系数的定义$s = m_A - m_B$，我们有：\n$$ \\frac{N_A(t)}{N_B(t)} = \\frac{N_A(0)}{N_B(0)} \\exp(st) $$\n为了找到$s$的表达式，我们重新整理方程并取自然对数：\n$$ \\exp(st) = \\frac{N_A(t)/N_B(t)}{N_A(0)/N_B(0)} $$\n$$ st = \\ln\\left( \\frac{N_A(t)/N_B(t)}{N_A(0)/N_B(0)} \\right) = \\ln\\left(\\frac{N_A(t)}{N_B(t)}\\right) - \\ln\\left(\\frac{N_A(0)}{N_B(0)}\\right) $$\n因此，选择系数由下式给出：\n$$ s = \\frac{1}{t} \\left[ \\ln\\left(\\frac{N_A(t)}{N_B(t)}\\right) - \\ln\\left(\\frac{N_A(0)}{N_B(0)}\\right) \\right] $$\n这个方程将$s$与真实的、未观测到的种群比率联系起来。我们必须从观测到的计数构造一个估计量。时间$\\tau$的真实比率可以用真实频率$p_\\tau = N_A(\\tau) / (N_A(\\tau) + N_B(\\tau))$表示为$N_A(\\tau)/N_B(\\tau) = p_\\tau/(1-p_\\tau)$。我们使用来自流式细胞术数据的样本频率来估计这些真实频率：\n$$ \\hat{p}_0 = \\frac{A_0}{N_0} = \\frac{A_0}{A_0+B_0} \\quad \\text{和} \\quad \\hat{p}_t = \\frac{A_t}{N_t} = \\frac{A_t}{A_t+B_t} $$\n相应的估计比率为：\n$$ \\frac{\\hat{p}_0}{1-\\hat{p}_0} = \\frac{A_0/N_0}{B_0/N_0} = \\frac{A_0}{B_0} \\quad \\text{和} \\quad \\frac{\\hat{p}_t}{1-\\hat{p}_t} = \\frac{A_t/N_t}{B_t/N_t} = \\frac{A_t}{B_t} $$\n使用即插原理（plug-in principle），我们将这些估计值代入$s$的方程中，以获得估计量$\\hat{s}$：\n$$ \\hat{s} = \\frac{1}{t} \\left[ \\ln\\left(\\frac{A_t}{B_t}\\right) - \\ln\\left(\\frac{A_0}{B_0}\\right) \\right] $$\n这可以更紧凑地写作：\n$$ \\hat{s} = \\frac{1}{t} \\ln\\left( \\frac{A_t B_0}{A_0 B_t} \\right) $$\n此估计量的一个正则性假设是，所有计数$A_0, B_0, A_t, B_t$必须严格为正，这样对数才有定义。\n\n**方差近似$\\mathrm{Var}(\\hat{s})$的推导**\n\n我们使用delta方法来近似$\\hat{s}$的方差。估计量$\\hat{s}$是随机变量$A_0$和$A_t$的函数（因为$B_0=N_0-A_0$和$B_t=N_t-A_t$，其中$N_0$和$N_t$是固定的样本大小）。让我们定义函数$g(x,y)$：\n$$ g(x,y) = \\frac{1}{t} \\left[ \\ln\\left(\\frac{y}{N_t-y}\\right) - \\ln\\left(\\frac{x}{N_0-x}\\right) \\right] $$\n所以，$\\hat{s} = g(A_0, A_t)$。根据问题陈述，随机变量$A_0$和$A_t$是独立的。根据delta方法，$\\hat{s}$的方差近似为：\n$$ \\mathrm{Var}(\\hat{s}) \\approx \\left( \\frac{\\partial g}{\\partial x} \\right)^2 \\mathrm{Var}(A_0) + \\left( \\frac{\\partial g}{\\partial y} \\right)^2 \\mathrm{Var}(A_t) $$\n其中偏导数在$A_0$和$A_t$的期望值处计算，即$\\mathrm{E}[A_0] = N_0 p_0$和$\\mathrm{E}[A_t] = N_t p_t$。\n\n首先，我们计算$g(x,y) = \\frac{1}{t} [ \\ln(y) - \\ln(N_t-y) - \\ln(x) + \\ln(N_0-x) ]$的偏导数：\n$$ \\frac{\\partial g}{\\partial x} = \\frac{1}{t} \\left[ -\\frac{1}{x} + \\frac{1}{N_0-x} \\right] = \\frac{1}{t} \\frac{-N_0+x-x}{x(N_0-x)} = -\\frac{N_0}{t x (N_0-x)} $$\n$$ \\frac{\\partial g}{\\partial y} = \\frac{1}{t} \\left[ \\frac{1}{y} - \\frac{-1}{N_t-y} \\right] = \\frac{1}{t} \\frac{N_t-y+y}{y(N_t-y)} = \\frac{N_t}{t y (N_t-y)} $$\n接下来，我们在$x=\\mathrm{E}[A_0]=N_0 p_0$和$y=\\mathrm{E}[A_t]=N_t p_t$处计算这些导数：\n$$ \\left. \\frac{\\partial g}{\\partial x} \\right|_{x=N_0 p_0} = -\\frac{N_0}{t (N_0 p_0) (N_0 - N_0 p_0)} = -\\frac{1}{t N_0 p_0 (1-p_0)} $$\n$$ \\left. \\frac{\\partial g}{\\partial y} \\right|_{y=N_t p_t} = \\frac{N_t}{t (N_t p_t) (N_t - N_t p_t)} = \\frac{1}{t N_t p_t (1-p_t)} $$\n二项式随机变量的方差为$\\mathrm{Var}(A_0) = N_0 p_0 (1-p_0)$和$\\mathrm{Var}(A_t) = N_t p_t (1-p_t)$。\n将这些代入delta方法的公式中：\n$$ \\mathrm{Var}(\\hat{s}) \\approx \\left( -\\frac{1}{t N_0 p_0 (1-p_0)} \\right)^2 [N_0 p_0 (1-p_0)] + \\left( \\frac{1}{t N_t p_t (1-p_t)} \\right)^2 [N_t p_t (1-p_t)] $$\n$$ \\mathrm{Var}(\\hat{s}) \\approx \\frac{1}{t^2 N_0 p_0 (1-p_0)} + \\frac{1}{t^2 N_t p_t (1-p_t)} = \\frac{1}{t^2} \\left[ \\frac{1}{N_0 p_0 (1-p_0)} + \\frac{1}{N_t p_t (1-p_t)} \\right] $$\n这个近似值依赖于未知的真实频率$p_0$和$p_t$。按照指示，我们使用即插法，用样本估计值$\\hat{p}_0 = A_0/N_0$和$\\hat{p}_t = A_t/N_t$替换真实频率。这就得出了方差的一个估计量，为简化起见，我们同样将其表示为$\\mathrm{Var}(\\hat{s})$。\n$$ \\mathrm{Var}(\\hat{s}) \\approx \\frac{1}{t^2} \\left[ \\frac{1}{N_0 \\hat{p}_0 (1-\\hat{p}_0)} + \\frac{1}{N_t \\hat{p}_t (1-\\hat{p}_t)} \\right] $$\n让我们简化括号中的项：\n$$ \\frac{1}{N_0 \\hat{p}_0 (1-\\hat{p}_0)} = \\frac{1}{N_0 (A_0/N_0) (B_0/N_0)} = \\frac{N_0}{A_0 B_0} = \\frac{A_0+B_0}{A_0 B_0} = \\frac{1}{A_0} + \\frac{1}{B_0} $$\n类似地，对于时间$t$的项：\n$$ \\frac{1}{N_t \\hat{p}_t (1-\\hat{p}_t)} = \\frac{1}{A_t} + \\frac{1}{B_t} $$\n将这些代回，我们得到方差近似的最终表达式，用观测计数表示：\n$$ \\mathrm{Var}(\\hat{s}) \\approx \\frac{1}{t^2} \\left( \\frac{1}{A_0} + \\frac{1}{B_0} + \\frac{1}{A_t} + \\frac{1}{B_t} \\right) $$\n该表达式代表了我们估计量$\\hat{s}$的估计方差。\n因此，所需的两个表达式都已推导出。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{t} \\ln\\left(\\frac{A_t B_0}{A_0 B_t}\\right) & \\frac{1}{t^2} \\left( \\frac{1}{A_0} + \\frac{1}{B_0} + \\frac{1}{A_t} + \\frac{1}{B_t} \\right) \\end{pmatrix} } $$"
        },
        {
            "introduction": "现代实验进化严重依赖深度测序来测量等位基因频率。然而，聚合酶链式反应（PCR）步骤可能会引入显著的、非二项分布的噪声（即“头彩效应”），从而扭曲我们的估计。本练习将演示如何对这种PCR噪声进行数学建模，并量化使用独特分子标识符（UMIs）这项关键的定量基因组学技术所带来的精度显著提升 。",
            "id": "2712500",
            "problem": "在一项实验演化研究中，您对一个混合群体进行测序，以估计某个目标遗传变异的频率。首先通过聚合酶链式反应（PCR）对脱氧核糖核酸（DNA）分子进行扩增，然后进行深度测序。由于早期循环扩增的随机性差异（PCR大奖效应），不同的输入模板分子会产生数量差异极大的扩增拷贝。您考虑使用唯一分子标识符（UMI）来校正这个问题，UMI可以将PCR重复片段合并到不同输入模板的层面。\n\n假设存在以下生成模型。存在 $N_{0}$ 个输入模板分子，由 $i \\in \\{1,\\dots,N_{0}\\}$ 索引。每个模板要么是目标变异（$X_{i}=1$），要么是参考（$X_{i}=0$），其中 $X_{i} \\sim \\mathrm{Bernoulli}(p)$ 独立同分布，未知的真实变异频率为 $p \\in (0,1)$。在给定 $X_{i}$ 的条件下，每个模板 $i$ 产生随机数量 $K_{i}$ 的PCR扩增分子；大奖效应通过将 $K_{i}$ 建模为独立同分布（具有有限均值 $\\mu_{K}=\\mathbb{E}[K_{i}]$ 和方差 $\\sigma_{K}^{2}=\\mathrm{Var}(K_{i})$），且与 $\\{X_{i}\\}$ 独立来模拟。设 $S=\\sum_{i=1}^{N_{0}} X_{i} K_{i}$ 为扩增后的变异分子总数，设 $T=\\sum_{i=1}^{N_{0}} K_{i}$ 为扩增后的分子总数。\n\n您进行饱和深度测序，因此相对于上游变异，测序带来的抽样噪声可以忽略不计。也就是说，在测序深度非常大的极限情况下，基于读数（read）的朴素变异频率估计量为 $\\hat{q}=S/T$。在饱和覆盖度下（每个输入分子都被标记并至少被观察到一次），使用基于UMI的去重复方法，校正后的估计量是携带变异的不同输入模板的比例，即 $\\hat{p}_{\\mathrm{UMI}}=N_{0}^{-1}\\sum_{i=1}^{N_{0}} X_{i}$。\n\n仅使用基本概率定义、独立性假设以及适用于大 $N_{0}$ 的一阶泰勒（delta方法）近似，推导在PCR大奖效应下 $\\hat{q}$ 的主阶方差，以及在完美UMI去重复下 $\\hat{p}_{\\mathrm{UMI}}$ 的相应方差。将过度离势（overdispersion）降低因子定义为比率\n$$\n\\mathcal{R} \\equiv \\frac{\\mathrm{Var}(\\hat{q})}{\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}})} \\, .\n$$\n假设如前所述，$N_{0}$ 很大且测序深度饱和，那么仅用 $\\mu_{K}$ 和 $\\sigma_{K}^{2}$ 表示的 $\\mathcal{R}$ 的封闭形式解析表达式是什么？提供 $\\mathcal{R}$ 的最终表达式；无需进行数值评估，也无需单位。",
            "solution": "必须首先严格验证问题陈述。\n\n步骤1：提取已知条件。\n- $N_{0}$：输入模板分子的数量。\n- $i \\in \\{1, \\dots, N_{0}\\}$：分子的索引。\n- $X_{i}$：目标变异的指示变量，$X_{i}=1$ 表示变异，$X_{i}=0$ 表示参考。\n- 对所有 $i$，$X_{i} \\sim \\mathrm{Bernoulli}(p)$ 独立同分布。\n- $p \\in (0,1)$：目标变异的真实比例。\n- $K_{i}$：来自模板 $i$ 的PCR扩增分子的随机数量。\n- $\\{K_{i}\\}$ 是独立同分布的（i.i.d.）。\n- $\\mu_{K} = \\mathbb{E}[K_{i}]$：扩增计数的有限均值。\n- $\\sigma_{K}^{2} = \\mathrm{Var}(K_{i})$：扩增计数的有限方差。\n- 对所有 $i, j$，$\\{K_{i}\\}$ 和 $\\{X_{j}\\}$ 相互独立。\n- $S = \\sum_{i=1}^{N_{0}} X_{i} K_{i}$：扩增后的变异分子总数。\n- $T = \\sum_{i=1}^{N_{0}} K_{i}$：扩增后的分子总数。\n- $\\hat{q} = S/T$：基于读数的朴素变异频率估计量。\n- $\\hat{p}_{\\mathrm{UMI}} = N_{0}^{-1}\\sum_{i=1}^{N_{0}} X_{i}$：经UMI校正的估计量。\n- 假设：$N_{0}$ 很大。\n- 假设：测序深度是饱和的，因此从扩增池中抽样不是误差的来源。\n- 任务：使用一阶泰勒（delta方法）近似推导 $\\mathrm{Var}(\\hat{q})$。\n- 任务：推导 $\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}})$。\n- 任务：计算比率 $\\mathcal{R} \\equiv \\frac{\\mathrm{Var}(\\hat{q})}{\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}})}$，用 $\\mu_{K}$ 和 $\\sigma_{K}^{2}$ 表示。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，描述了定量测序中的一个标准且被充分理解的问题（PCR大奖效应）以及一种常见的校正方法（UMI）。其概率模型是对这一过程的常规且恰当的形式化。这是一个适定问题，提供了所有必要的定义、假设（大 $N_{0}$、独立性）和一个明确的目标。它没有规定不足、自相矛盾或基于主观论断。其推导需要对概率论和近似方法进行标准的、非平凡的应用。该问题是有效的。\n\n步骤3：结论与行动。\n该问题有效。我将继续进行推导。\n\n首先，我们推导基于UMI的估计量 $\\hat{p}_{\\mathrm{UMI}}$ 的方差。该估计量是 $N_{0}$ 个独立同分布的伯努利（Bernoulli）随机变量 $X_{i}$ 的样本均值。\n一个服从参数为 $p$ 的伯努利分布的随机变量，其方差为 $p(1-p)$。\n$$\n\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}}) = \\mathrm{Var}\\left(\\frac{1}{N_{0}}\\sum_{i=1}^{N_{0}} X_{i}\\right)\n$$\n因为 $X_{i}$ 是独立的，所以和的方差等于方差的和：\n$$\n\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}}) = \\frac{1}{N_{0}^{2}} \\sum_{i=1}^{N_{0}} \\mathrm{Var}(X_{i}) = \\frac{1}{N_{0}^{2}} \\cdot N_{0} \\cdot p(1-p) = \\frac{p(1-p)}{N_{0}}\n$$\n\n接下来，我们推导朴素估计量 $\\hat{q} = S/T$ 的方差。我们使用两个随机变量之比的一阶泰勒展开（delta方法），这对于大 $N_{0}$ 是一个有效的近似。设 $g(S, T) = S/T$。 $\\hat{q}$ 的方差近似为：\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\left(\\frac{\\partial g}{\\partial S}\\right)^2 \\mathrm{Var}(S) + \\left(\\frac{\\partial g}{\\partial T}\\right)^2 \\mathrm{Var}(T) + 2\\left(\\frac{\\partial g}{\\partial S}\\right)\\left(\\frac{\\partial g}{\\partial T}\\right) \\mathrm{Cov}(S, T)\n$$\n偏导数在 $S$ 和 $T$ 的期望值处求值。\n\n我们必须首先计算 $S$ 和 $T$ 的期望、方差和协方差。\n$T$ 的期望为：\n$$\n\\mathbb{E}[T] = \\mathbb{E}\\left[\\sum_{i=1}^{N_{0}} K_{i}\\right] = \\sum_{i=1}^{N_{0}} \\mathbb{E}[K_{i}] = N_{0}\\mu_{K}\n$$\n$S$ 的期望为：\n$$\n\\mathbb{E}[S] = \\mathbb{E}\\left[\\sum_{i=1}^{N_{0}} X_{i}K_{i}\\right] = \\sum_{i=1}^{N_{0}} \\mathbb{E}[X_{i}K_{i}]\n$$\n由于 $X_{i}$和$K_{i}$的独立性，$\\mathbb{E}[X_{i}K_{i}] = \\mathbb{E}[X_{i}]\\mathbb{E}[K_{i}] = p\\mu_{K}$。\n$$\n\\mathbb{E}[S] = \\sum_{i=1}^{N_{0}} p\\mu_{K} = N_{0}p\\mu_{K}\n$$\n该比率的期望值近似为 $\\mathbb{E}[\\hat{q}] \\approx \\mathbb{E}[S]/\\mathbb{E}[T] = (N_{0}p\\mu_{K})/(N_{0}\\mu_{K}) = p$。\n\n$g(S,T)=S/T$ 的偏导数为：\n$$\n\\frac{\\partial g}{\\partial S} = \\frac{1}{T} \\quad \\implies \\quad \\left. \\frac{\\partial g}{\\partial S} \\right|_{\\mathbb{E}[S], \\mathbb{E}[T]} = \\frac{1}{N_{0}\\mu_{K}}\n$$\n$$\n\\frac{\\partial g}{\\partial T} = -\\frac{S}{T^{2}} \\quad \\implies \\quad \\left. \\frac{\\partial g}{\\partial T} \\right|_{\\mathbb{E}[S], \\mathbb{E}[T]} = -\\frac{N_{0}p\\mu_{K}}{(N_{0}\\mu_{K})^{2}} = -\\frac{p}{N_{0}\\mu_{K}}\n$$\n\n现在我们求方差和协方差。\n$T$ 的方差：由于 $K_{i}$ 是独立同分布的，\n$$\n\\mathrm{Var}(T) = \\mathrm{Var}\\left(\\sum_{i=1}^{N_{0}} K_{i}\\right) = \\sum_{i=1}^{N_{0}} \\mathrm{Var}(K_{i}) = N_{0}\\sigma_{K}^{2}\n$$\n$S$ 的方差：设 $Y_{i} = X_{i}K_{i}$。由于这些项是独立同分布的，$\\mathrm{Var}(S) = \\sum \\mathrm{Var}(Y_{i}) = N_{0}\\mathrm{Var}(Y_{1})$。我们使用全方差公式：$\\mathrm{Var}(Y_{i}) = \\mathbb{E}[\\mathrm{Var}(Y_{i}|X_{i})] + \\mathrm{Var}(\\mathbb{E}[Y_{i}|X_{i}])$。\n$$\n\\mathbb{E}[Y_{i}|X_{i}] = \\mathbb{E}[X_{i}K_{i}|X_{i}] = X_{i}\\mathbb{E}[K_{i}] = X_{i}\\mu_{K}\n$$\n$$\n\\mathrm{Var}(Y_{i}|X_{i}) = \\mathrm{Var}(X_{i}K_{i}|X_{i}) = X_{i}^{2}\\mathrm{Var}(K_{i}) = X_{i}\\sigma_{K}^{2} \\quad (\\text{因为对于伯努利变量 } X_{i}^{2}=X_{i})\n$$\n所以，$\\mathbb{E}[\\mathrm{Var}(Y_{i}|X_{i})] = \\mathbb{E}[X_{i}\\sigma_{K}^{2}] = \\sigma_{K}^{2}\\mathbb{E}[X_{i}] = p\\sigma_{K}^{2}$。\n并且，$\\mathrm{Var}(\\mathbb{E}[Y_{i}|X_{i}]) = \\mathrm{Var}(X_{i}\\mu_{K}) = \\mu_{K}^{2}\\mathrm{Var}(X_{i}) = \\mu_{K}^{2}p(1-p)$。\n$$\n\\mathrm{Var}(Y_{i}) = p\\sigma_{K}^{2} + \\mu_{K}^{2}p(1-p)\n$$\n因此，$S$ 的方差为：\n$$\n\\mathrm{Var}(S) = N_{0}\\left(p\\sigma_{K}^{2} + \\mu_{K}^{2}p(1-p)\\right)\n$$\n$S$ 和 $T$ 的协方差：\n$$\n\\mathrm{Cov}(S, T) = \\mathrm{Cov}\\left(\\sum_{i=1}^{N_{0}} X_{i}K_{i}, \\sum_{j=1}^{N_{0}} K_{j}\\right) = \\sum_{i=1}^{N_{0}}\\sum_{j=1}^{N_{0}} \\mathrm{Cov}(X_{i}K_{i}, K_{j})\n$$\n对于 $i \\neq j$，$X_{i}K_{i}$ 和 $K_{j}$ 是独立的，所以 $\\mathrm{Cov}(X_{i}K_{i}, K_{j}) = 0$。我们只需要考虑 $i=j$ 的项。\n$$\n\\mathrm{Cov}(S, T) = \\sum_{i=1}^{N_{0}} \\mathrm{Cov}(X_{i}K_{i}, K_{i})\n$$\n我们计算 $\\mathrm{Cov}(X_{i}K_{i}, K_{i}) = \\mathbb{E}[X_{i}K_{i}^{2}] - \\mathbb{E}[X_{i}K_{i}]\\mathbb{E}[K_{i}]$。\n根据独立性，$\\mathbb{E}[X_{i}K_{i}^{2}] = \\mathbb{E}[X_{i}]\\mathbb{E}[K_{i}^{2}] = p(\\sigma_{K}^{2} + \\mu_{K}^{2})$。\n并且 $\\mathbb{E}[X_{i}K_{i}]\\mathbb{E}[K_{i}] = (p\\mu_{K})\\mu_{K} = p\\mu_{K}^{2}$。\n所以, $\\mathrm{Cov}(X_{i}K_{i}, K_{i}) = p(\\sigma_{K}^{2} + \\mu_{K}^{2}) - p\\mu_{K}^{2} = p\\sigma_{K}^{2}$。\n$$\n\\mathrm{Cov}(S, T) = \\sum_{i=1}^{N_{0}} p\\sigma_{K}^{2} = N_{0}p\\sigma_{K}^{2}\n$$\n\n现在将所有分量代入 $\\mathrm{Var}(\\hat{q})$ 的delta方法公式中：\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\left(\\frac{1}{N_{0}\\mu_{K}}\\right)^{2}\\mathrm{Var}(S) + \\left(-\\frac{p}{N_{0}\\mu_{K}}\\right)^{2}\\mathrm{Var}(T) + 2\\left(\\frac{1}{N_{0}\\mu_{K}}\\right)\\left(-\\frac{p}{N_{0}\\mu_{K}}\\right)\\mathrm{Cov}(S, T)\n$$\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{1}{(N_{0}\\mu_{K})^{2}} \\left[ \\mathrm{Var}(S) + p^{2}\\mathrm{Var}(T) - 2p\\mathrm{Cov}(S, T) \\right]\n$$\n代入方差和协方差的表达式：\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{1}{N_{0}^{2}\\mu_{K}^{2}} \\left[ N_{0}(p\\sigma_{K}^{2} + \\mu_{K}^{2}p(1-p)) + p^{2}(N_{0}\\sigma_{K}^{2}) - 2p(N_{0}p\\sigma_{K}^{2}) \\right]\n$$\n从方括号中提出因子 $N_{0}$：\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{N_{0}}{N_{0}^{2}\\mu_{K}^{2}} \\left[ (p\\sigma_{K}^{2} + p(1-p)\\mu_{K}^{2}) + p^{2}\\sigma_{K}^{2} - 2p^{2}\\sigma_{K}^{2} \\right]\n$$\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{1}{N_{0}\\mu_{K}^{2}} \\left[ p\\sigma_{K}^{2} - p^{2}\\sigma_{K}^{2} + p(1-p)\\mu_{K}^{2} \\right]\n$$\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{1}{N_{0}\\mu_{K}^{2}} \\left[ p(1-p)\\sigma_{K}^{2} + p(1-p)\\mu_{K}^{2} \\right]\n$$\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{p(1-p)}{N_{0}\\mu_{K}^{2}} \\left( \\sigma_{K}^{2} + \\mu_{K}^{2} \\right)\n$$\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{p(1-p)}{N_{0}} \\left( 1 + \\frac{\\sigma_{K}^{2}}{\\mu_{K}^{2}} \\right)\n$$\n\n最后，我们计算过度离势降低因子 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{\\mathrm{Var}(\\hat{q})}{\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}})} \\approx \\frac{\\frac{p(1-p)}{N_{0}} \\left( 1 + \\frac{\\sigma_{K}^{2}}{\\mu_{K}^{2}} \\right)}{\\frac{p(1-p)}{N_{0}}}\n$$\n$$\n\\mathcal{R} \\approx 1 + \\frac{\\sigma_{K}^{2}}{\\mu_{K}^{2}}\n$$\n这就是要求的用 $\\mu_{K}$ 和 $\\sigma_{K}^{2}$ 表示的封闭形式表达式。它表示由于PCR扩增的随机性导致的方差膨胀，其大小由扩增拷贝数的变异系数的平方来量化。",
            "answer": "$$\\boxed{1 + \\frac{\\sigma_{K}^{2}}{\\mu_{K}^{2}}}$$"
        },
        {
            "introduction": "进化很少通过孤立的单个突变发生；突变之间的相互作用，即上位性，共同塑造了“适应度景观”。通过测量少数突变的所有组合的适应度，我们可以绘制出这个景观并识别出适应度高峰和低谷等特征。这项实践分析将向你展示如何利用适应度数据和基本的统计推断，来检验诸如交互符号上位性等复杂的进化现象，并识别适应过程中的潜在障碍 。",
            "id": "2712459",
            "problem": "对于一个经过实验进化的通路基因，您将获得一个双位点系统中所有基因型的相对适应度的重复估算值。这两个位点由位置 $A$ 和 $B$ 处的等位基因表示，每个等位基因可以是野生型（$0$）或突变型（$1$）。四种基因型分别为 $00$、$10$、$01$ 和 $11$，其中第一位数字对应位点 $A$，第二位数字对应位点 $B$。对于每种基因型 $g \\in \\{00,10,01,11\\}$，我们为您提供了根据独立重复测量计算出的估算平均相对适应度 $\\hat{W}_g$（无量纲）及其标准误 $\\hat{\\sigma}_g$（无量纲）。\n\n您的任务是，使用第一性原理和基本统计推断，对每个参数集实施以下分析：\n\n1. 使用置信区间（CI），在 $95\\%$ 的水平上确定是否存在相互作用符号上位性（RSE）的支持。具体来说，如下定义两种遗传背景下的单位点突变效应：\n- 在野生型背景下（即 $B=0$ 时）$A$ 突变的效应：$s_{A|b0} = \\hat{W}_{10} - \\hat{W}_{00}$。\n- 在突变型 $B$ 背景下（即 $B=1$ 时）$A$ 突变的效应：$s_{A|b1} = \\hat{W}_{11} - \\hat{W}_{01}$。\n- 在野生型背景下（即 $A=0$ 时）$B$ 突变的效应：$s_{B|a0} = \\hat{W}_{01} - \\hat{W}_{00}$。\n- 在突变型 $A$ 背景下（即 $A=1$ 时）$B$ 突变的效应：$s_{B|a1} = \\hat{W}_{11} - \\hat{W}_{10}$。\n\n假设估算误差独立且近似服从正态分布，因此任意差异 $d = \\hat{W}_x - \\hat{W}_y$ 的标准误为 $\\operatorname{SE}(d) = \\sqrt{\\hat{\\sigma}_x^2 + \\hat{\\sigma}_y^2}$。使用正态分位数 $z_{0.975} = 1.96$ 构建每个差异的 $95\\%$ 置信区间：\n$$\n\\mathrm{CI}_{95\\%}(d) = \\left[d - z_{0.975}\\,\\operatorname{SE}(d),\\; d + z_{0.975}\\,\\operatorname{SE}(d)\\right].\n$$\n将差异的 CI 支持符号定义为\n- 如果置信区间的下限严格大于 $0$，则为 $+1$；\n- 如果置信区间的上限严格小于 $0$，则为 $-1$；\n- 否则为 $0$。\n\n当且仅当两种突变效应在不同背景下的 CI 支持符号均发生翻转时，声明存在相互作用符号上位性（布尔值）：\n$$\n\\mathrm{RSE} = \\Big(\\mathrm{sign}(s_{A|b0}) \\cdot \\mathrm{sign}(s_{A|b1}) = -1\\Big)\\;\\wedge\\;\\Big(\\mathrm{sign}(s_{B|a0}) \\cdot \\mathrm{sign}(s_{B|a1}) = -1\\Big).\n$$\n\n2. 通过计算四种基因型中 CI 支持的适应度峰的数量来量化崎岖度。如果一个基因型 $g$ 的适应度以 $95\\%$ 的置信度超过其每个单步突变邻居的适应度，则该基因型是一个 CI 支持的峰。形式上，对于每个仅在一个位点上不同的邻居 $n$，计算 $\\Delta_{g\\to n} = \\hat{W}_g - \\hat{W}_n$ 及其标准误 $\\operatorname{SE}(\\Delta_{g\\to n}) = \\sqrt{\\hat{\\sigma}_g^2 + \\hat{\\sigma}_n^2}$ 和 $95\\%$ 置信区间。如果对于所有这样的 $n$，$\\Delta_{g\\to n}$ 的置信区间下限都严格大于 $0$，则基因型 $g$ 是一个受支持的峰。计算满足此条件的基因型数量。\n\n3. 检验野生型周围是否存在适应度屏障，该屏障将需要通过有害的第一步来跨越以达到双突变体。如果在 $95\\%$ 的水平上，野生型背景下的两个单位点突变均显著有害，则定义存在屏障（布尔值）：\n$$\n\\text{Barrier} = \\Big(\\text{upper bound of } \\mathrm{CI}_{95\\%}(\\hat{W}_{10}-\\hat{W}_{00}) < 0\\Big)\\;\\wedge\\;\\Big(\\text{upper bound of } \\mathrm{CI}_{95\\%}(\\hat{W}_{01}-\\hat{W}_{00}) < 0\\Big).\n$$\n\n您的程序必须对以下测试套件中的每个参数集执行上述计算，并为每个集合按顺序输出一个包含三个量的列表：RSE 布尔值、CI 支持峰的整数数量和屏障布尔值。\n\n使用的基本依据和假设：\n- 基因型到适应度的映射由实验进化下的相对适应度 $W$（无量纲）定义，其在预期生长或繁殖成功方面的解释已经过充分检验。\n- 不同基因型 $\\hat{W}_g$ 的独立正态分布估算误差导致差异的方差等于方差之和。\n- 在正态近似下，平均值差异的 $95\\%$ 置信区间（CI）使用 $z_{0.975} = 1.96$。\n\n每个测试用例的输入规范：\n- 您将获得元组 $(\\hat{W}_{00}, \\hat{\\sigma}_{00}, \\hat{W}_{10}, \\hat{\\sigma}_{10}, \\hat{W}_{01}, \\hat{\\sigma}_{01}, \\hat{W}_{11}, \\hat{\\sigma}_{11})$。\n\n测试套件（四个参数集），所有值均无量纲：\n- 案例 A（强相互作用符号上位性，有两个峰和一个屏障）：\n  $(1.00, 0.005, 0.97, 0.005, 0.98, 0.005, 1.05, 0.005)$。\n- 案例 B（有符号上位性但无相互作用，一个峰，无屏障）：\n  $(1.00, 0.004, 1.02, 0.004, 0.99, 0.004, 0.98, 0.004)$。\n- 案例 C（无符号上位性，单个全局峰，无屏障）：\n  $(1.00, 0.003, 1.02, 0.003, 1.03, 0.003, 1.05, 0.003)$。\n- 案例 D（因误差大导致效应不明确，无受支持的峰，无屏障）：\n  $(1.00, 0.030, 0.97, 0.030, 0.98, 0.030, 1.05, 0.030)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个案例的结果列表（按顺序排列），每个案例的结果是一个形式为 $[\\text{RSE},\\text{num\\_peaks},\\text{barrier}]$ 的列表。整个输出必须是单行，不含任何额外文本，格式示例如下：$[[ \\text{true},2,\\text{false} ],[ \\dots ], \\dots ]$。",
            "solution": "所提出的问题是定量进化生物学中一个有效练习。它具有科学依据，问题阐述清晰，并且为进行严谨分析提供了所有必要的数据和定义。我们将着手进行解答。\n\n对双位点适应度景观的分析，其前提是应用基本统计推断来比较估算的适应度值。此分析的核心工具是两个均值之差的置信区间，这两个均值被假定为服从正态分布且为独立估算。\n\n给定两个基因型 $x$ 和 $y$，其估算的平均相对适应度值为 $\\hat{W}_x$ 和 $\\hat{W}_y$，对应的标准误为 $\\hat{\\sigma}_x$ 和 $\\hat{\\sigma}_y$，则适应度差异为 $d = \\hat{W}_x - \\hat{W}_y$。由于误差独立的假设，该差异的方差是各个方差之和。因此，差异的标准误为：\n$$\n\\operatorname{SE}(d) = \\sqrt{\\hat{\\sigma}_x^2 + \\hat{\\sigma}_y^2}\n$$\n在正态近似下，使用标准正态分布的临界值 $z_{0.975} \\approx 1.96$ 来构建真实差异的 $95\\%$ 置信区间。该区间为：\n$$\n\\mathrm{CI}_{95\\%}(d) = \\left[d - 1.96\\,\\operatorname{SE}(d),\\; d + 1.96\\,\\operatorname{SE}(d)\\right]\n$$\n为了做出明确的陈述，我们为差异 $d$ 定义一个 CI 支持的符号。如果整个置信区间都大于 $0$（即其下限严格为正），则符号为 $+1$，表示具有统计显著性的正效应。如果整个区间都小于 $0$（即其上限严格为负），则符号为 $-1$，表示具有显著性的负效应。如果区间包含 $0$，则在给定的置信水平上，该效应与零无统计学差异，其符号被指定为 $0$。\n\n基于此统计基础，我们来解决这三个分析任务。\n\n1.  **相互作用符号上位性 (RSE)**：上位性描述了突变的适应度效应依赖于遗传背景的情况。相互作用符号上位性是一种强形式的上位性，其中一个突变在一个背景下是有益的，但在另一个背景下是有害的，并且系统中的两个突变都如此。我们必须在统计支持下评估此条件。单位点突变效应定义如下：\n    *   $s_{A|b0} = \\hat{W}_{10} - \\hat{W}_{00}$\n    *   $s_{A|b1} = \\hat{W}_{11} - \\hat{W}_{01}$\n    *   $s_{B|a0} = \\hat{W}_{01} - \\hat{W}_{00}$\n    *   $s_{B|a1} = \\hat{W}_{11} - \\hat{W}_{10}$\n    \n    如果这些效应的 CI 支持符号在不同背景下发生翻转，则 RSE 成立。形式上，我们评估以下布尔表达式：\n    $$\n    \\mathrm{RSE} = \\Big(\\mathrm{sign}(\\mathrm{CI}(s_{A|b0})) \\cdot \\mathrm{sign}(\\mathrm{CI}(s_{A|b1})) = -1\\Big)\\;\\wedge\\;\\Big(\\mathrm{sign}(\\mathrm{CI}(s_{B|a0})) \\cdot \\mathrm{sign}(\\mathrm{CI}(s_{B|a1})) = -1\\Big)\n    $$\n    例如，此条件要求 $s_{A|b0}$ 显著为正且 $s_{A|b1}$ 显著为负（反之亦然），位点 $B$ 处的突变同理。\n\n2.  **适应度景观崎岖度（峰数量）**：适应度景观可以看作一个图，其中节点是基因型，边连接着突变邻居。一个“峰”是指一个基因型的适应度大于其所有单步突变邻居的适应度。我们的分析必须计算由统计证据支持的峰的数量。如果对于每一个单步邻居 $n$，适应度差异 $\\Delta_{g\\to n} = \\hat{W}_g - \\hat{W}_n$ 都是显著为正，那么基因型 $g$ 就是一个 CI 支持的峰。这等效于 $\\Delta_{g\\to n}$ 的 $95\\%$ 置信区间下限严格大于 $0$。该过程包括检查四种基因型（$00$，$10$，$01$，$11$）中的每一种，核对其是否满足针对其所有相应邻居的此标准，并汇总已确认的峰的数量。每种基因型的邻居是：\n    *   $00$ 的邻居：$10$, $01$\n    *   $10$ 的邻居：$00$, $11$\n    *   $01$ 的邻居：$00$, $11$\n    *   $11$ 的邻居：$10$, $01$\n\n3.  **有害第一步的适应度屏障**：从野生型基因型（此处为 $00$）到一个可能更适应的双突变体（$11$）的进化路径的可及性可能会被一个适应度屏障所阻碍。如果所有初始的突变步骤都是有害的，那么这样的屏障就存在。在这个双位点系统中，这意味着两个单位点突变基因型（$10$ 和 $01$）的适应度都必须显著低于野生型（$00$）。通过检查 $s_{A|b0} = \\hat{W}_{10} - \\hat{W}_{00}$ 和 $s_{B|a0} = \\hat{W}_{01} - \\hat{W}_{00}$ 的 CI 支持符号是否均为 $-1$ 来评估此条件。形式上：\n    $$\n    \\text{Barrier} = \\Big(\\text{upper bound of } \\mathrm{CI}_{95\\%}(\\hat{W}_{10}-\\hat{W}_{00}) < 0\\Big)\\;\\wedge\\;\\Big(\\text{upper bound of } \\mathrm{CI}_{95\\%}(\\hat{W}_{01}-\\hat{W}_{00}) < 0\\Big)\n    $$\n    这确定了从野生型到达双突变体是否需要穿过一个适应度谷。\n\n该实现将系统地将这三种分析应用于每个提供的参数集，从而得出其适应度景观结构的特征。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the evolutionary landscape analysis on test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (W_00, sigma_00, W_10, sigma_10, W_01, sigma_01, W_11, sigma_11)\n    test_cases = [\n        # Case A (strong reciprocal sign epistasis with two peaks and a barrier)\n        (1.00, 0.005, 0.97, 0.005, 0.98, 0.005, 1.05, 0.005),\n        # Case B (sign epistasis without reciprocity, one peak, no barrier)\n        (1.00, 0.004, 1.02, 0.004, 0.99, 0.004, 0.98, 0.004),\n        # Case C (no sign epistasis, single global peak, no barrier)\n        (1.00, 0.003, 1.02, 0.003, 1.03, 0.003, 1.05, 0.003),\n        # Case D (ambiguous effects due to large errors, no supported peaks, no barrier)\n        (1.00, 0.030, 0.97, 0.030, 0.98, 0.030, 1.05, 0.030),\n    ]\n\n    results = [analyze_landscape(case) for case in test_cases]\n\n    # The final print statement must follow the specified format exactly.\n    # Convert boolean to lowercase 'true'/'false' for the final output string representation.\n    output_str = \"[\" + \",\".join([f\"[{str(r[0]).lower()},{r[1]},{str(r[2]).lower()}]\" for r in results]) + \"]\"\n    print(output_str)\n\n\ndef get_ci_supported_sign(w_x, sigma_x, w_y, sigma_y):\n    \"\"\"\n    Calculates the CI-supported sign of the difference W_x - W_y.\n\n    Returns:\n        1 if the 95% CI lower bound is > 0.\n       -1 if the 95% CI upper bound is < 0.\n        0 otherwise.\n    \"\"\"\n    z_critical = 1.96\n    difference = w_x - w_y\n    se_diff = np.sqrt(sigma_x**2 + sigma_y**2)\n    \n    ci_lower = difference - z_critical * se_diff\n    ci_upper = difference + z_critical * se_diff\n    \n    if ci_lower > 0:\n        return 1\n    elif ci_upper < 0:\n        return -1\n    else:\n        return 0\n\n\ndef analyze_landscape(params):\n    \"\"\"\n    Performs the three analyses (RSE, peak count, barrier) for a single parameter set.\n\n    Args:\n        params: A tuple containing (W_00, sigma_00, ... , W_11, sigma_11).\n\n    Returns:\n        A list: [RSE_boolean, num_peaks_integer, barrier_boolean].\n    \"\"\"\n    w00, s00, w10, s10, w01, s01, w11, s11 = params\n    \n    # Task 1: Reciprocal Sign Epistasis (RSE)\n    # Effect of mutating A on background B=0 and B=1\n    sign_A_b0 = get_ci_supported_sign(w10, s10, w00, s00)\n    sign_A_b1 = get_ci_supported_sign(w11, s11, w01, s01)\n    \n    # Effect of mutating B on background A=0 and A=1\n    sign_B_a0 = get_ci_supported_sign(w01, s01, w00, s00)\n    sign_B_a1 = get_ci_supported_sign(w11, s11, w10, s10)\n    \n    rse_present = (sign_A_b0 * sign_A_b1 == -1) and (sign_B_a0 * sign_B_a1 == -1)\n\n    # Task 2: Ruggedness (CI-supported peak count)\n    genotypes = {\n        '00': {'w': w00, 's': s00, 'neighbors': ['10', '01']},\n        '10': {'w': w10, 's': s10, 'neighbors': ['00', '11']},\n        '01': {'w': w01, 's': s01, 'neighbors': ['00', '11']},\n        '11': {'w': w11, 's': s11, 'neighbors': ['10', '01']}\n    }\n    \n    num_peaks = 0\n    for g_name, g_data in genotypes.items():\n        is_peak = True\n        for n_name in g_data['neighbors']:\n            n_data = genotypes[n_name]\n            # A peak must be significantly fitter than all its neighbors\n            if get_ci_supported_sign(g_data['w'], g_data['s'], n_data['w'], n_data['s']) != 1:\n                is_peak = False\n                break\n        if is_peak:\n            num_peaks += 1\n            \n    # Task 3: Fitness Barrier\n    # This re-uses calculations from the RSE part.\n    # Barrier exists if both single mutations from WT are deleterious.\n    barrier_present = (sign_A_b0 == -1) and (sign_B_a0 == -1)\n    \n    return [rse_present, num_peaks, barrier_present]\n\nsolve()\n```"
        }
    ]
}