{
    "hands_on_practices": [
        {
            "introduction": "估算现代人基因组中的古人类血统比例（以 $\\alpha$ 表示）是一项基本任务。本练习将介绍一种强有力的工具——$f_4$ 比率统计量，它通过比较不同居群四元组之间共享的遗传漂变模式来量化基因渗入。通过完成这个练习，你将亲手实践如何应用 delta 方法来计算比率统计量的误差传播，这对于严谨地评估基因渗入比例估计的置信度至关重要。",
            "id": "2692273",
            "problem": "在一项关于古代人种基因渐渗的研究中，考虑四居群统计量 $f_4(A,B;C,D)$，其定义为跨位点等位基因频率差异的期望乘积，$f_4(A,B;C,D) = \\mathbb{E}\\left[(p_A - p_B)(p_C - p_D)\\right]$，其中 $p_X$ 表示居群 $X$ 中的等位基因频率。对于一个测试居群 $T$、一个外群 $O$、一个尼安德特人（Neanderthal）参考 $N$、一个丹尼索瓦人（Denisovan）参考 $D$，以及一个已知缺乏尼安德特人祖源的现代人参考 $R$，尼安德特人混合比例的 $f_4$ 比率估计量定义为\n$$\n\\hat{\\alpha} \\equiv \\frac{\\widehat{f_4}(T,O;N,D)}{\\widehat{f_4}(R,O;N,D)} \\equiv \\frac{\\hat{f}_1}{\\hat{f}_2}.\n$$\n使用应用于大基因组片段的区块刀切法 (Block Jackknife, BJ) 来估计向量 $(\\hat{f}_1,\\hat{f}_2)^{\\top}$ 的均值和 $2 \\times 2$ 协方差矩阵。BJ 估计值为：\n$$\n\\hat{f}_1 = 1.30 \\times 10^{-4}, \\qquad \\hat{f}_2 = 6.10 \\times 10^{-3},\n$$\n和\n$$\n\\widehat{\\Sigma} = \n\\begin{pmatrix}\n2.4 \\times 10^{-9} & -3.0 \\times 10^{-9} \\\\\n-3.0 \\times 10^{-9} & 1.3 \\times 10^{-7}\n\\end{pmatrix}.\n$$\n使用随机变量光滑函数误差传播的基本原理，应用多变量德尔塔方法计算标准误差 $\\operatorname{se}(\\hat{\\alpha}) = \\sqrt{\\operatorname{Var}(\\hat{\\alpha})}$，并明确考虑 $\\hat{f}_1$ 和 $\\hat{f}_2$ 之间的协方差。你可以将 $(\\hat{f}_1,\\hat{f}_2)^{\\top}$ 视为近似服从联合正态分布，其均值为 $(\\hat{f}_1,\\hat{f}_2)^{\\top}$，协方差为 $\\widehat{\\Sigma}$。\n\n最终答案仅报告标准误差 $\\operatorname{se}(\\hat{\\alpha})$（无量纲），并四舍五入至三位有效数字。",
            "solution": "所给出的问题具有科学依据、提法恰当、客观，并且包含得出唯一解所需的所有必要信息。因此，该问题被认定为有效。任务是使用多变量德尔塔方法计算一个比率估计量的标准误差。\n\n设统计量向量为 $\\boldsymbol{\\theta} = (\\hat{f}_1, \\hat{f}_2)^{\\top}$。混合比例的估计量是这些统计量的函数，$\\hat{\\alpha} = g(\\boldsymbol{\\theta}) = g(\\hat{f}_1, \\hat{f}_2) = \\frac{\\hat{f}_1}{\\hat{f}_2}$。多变量德尔塔方法为随机变量光滑函数的方差提供了一阶近似。如果 $\\boldsymbol{\\theta}$ 是一个随机向量，其均值为 $\\boldsymbol{\\mu}$，协方差矩阵为 $\\Sigma$，那么 $g(\\boldsymbol{\\theta})$ 的方差可近似为：\n$$\n\\operatorname{Var}(g(\\boldsymbol{\\theta})) \\approx \\left[ \\nabla g(\\boldsymbol{\\mu}) \\right]^{\\top} \\Sigma \\left[ \\nabla g(\\boldsymbol{\\mu}) \\right]\n$$\n在本问题中，我们使用估计的均值和协方差矩阵。均值由样本估计值近似 $\\boldsymbol{\\mu} \\approx (\\hat{f}_1, \\hat{f}_2)^{\\top}$，协方差矩阵为给定的 $\\widehat{\\Sigma}$。\n\n首先，我们计算函数 $g(x_1, x_2) = \\frac{x_1}{x_2}$ 的梯度。偏导数是：\n$$\n\\frac{\\partial g}{\\partial x_1} = \\frac{1}{x_2}\n$$\n$$\n\\frac{\\partial g}{\\partial x_2} = -\\frac{x_1}{x_2^2}\n$$\n梯度向量，我们记为 $\\mathbf{J}$，在点 $(\\hat{f}_1, \\hat{f}_2)$ 处求值为：\n$$\n\\mathbf{J} = \\nabla g(\\hat{f}_1, \\hat{f}_2) = \\begin{pmatrix} \\frac{1}{\\hat{f}_2} \\\\ -\\frac{\\hat{f}_1}{\\hat{f}_2^2} \\end{pmatrix}\n$$\n那么 $\\hat{\\alpha}$ 的方差由以下二次型给出：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\mathbf{J}^{\\top} \\widehat{\\Sigma} \\mathbf{J} = \\begin{pmatrix} \\frac{1}{\\hat{f}_2} & -\\frac{\\hat{f}_1}{\\hat{f}_2^2} \\end{pmatrix} \\widehat{\\Sigma} \\begin{pmatrix} \\frac{1}{\\hat{f}_2} \\\\ -\\frac{\\hat{f}_1}{\\hat{f}_2^2} \\end{pmatrix}\n$$\n设协方差矩阵的元素为 $\\widehat{\\Sigma} = \\begin{pmatrix} \\sigma_{11} & \\sigma_{12} \\\\ \\sigma_{21} & \\sigma_{22} \\end{pmatrix}$。注意 $\\sigma_{12} = \\sigma_{21}$。展开矩阵乘积，得到方差的表达式：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\left(\\frac{1}{\\hat{f}_2}\\right)^2 \\sigma_{11} + 2 \\left(\\frac{1}{\\hat{f}_2}\\right) \\left(-\\frac{\\hat{f}_1}{\\hat{f}_2^2}\\right) \\sigma_{12} + \\left(-\\frac{\\hat{f}_1}{\\hat{f}_2^2}\\right)^2 \\sigma_{22}\n$$\n化简此表达式，我们得到：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{\\sigma_{11}}{\\hat{f}_2^2} - \\frac{2\\hat{f}_1\\sigma_{12}}{\\hat{f}_2^3} + \\frac{\\hat{f}_1^2\\sigma_{22}}{\\hat{f}_2^4}\n$$\n这可以用 $\\hat{\\alpha} = \\hat{f}_1/\\hat{f}_2$ 更紧凑地重写为：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{1}{\\hat{f}_2^2} \\left( \\sigma_{11} - 2\\hat{\\alpha}\\sigma_{12} + \\hat{\\alpha}^2\\sigma_{22} \\right)\n$$\n给定的数值如下：\n$\\hat{f}_1 = 1.30 \\times 10^{-4}$\n$\\hat{f}_2 = 6.10 \\times 10^{-3}$\n$\\sigma_{11} = 2.4 \\times 10^{-9}$\n$\\sigma_{12} = -3.0 \\times 10^{-9}$\n$\\sigma_{22} = 1.3 \\times 10^{-7}$\n\n首先，我们计算估计的混合比例 $\\hat{\\alpha}$：\n$$\n\\hat{\\alpha} = \\frac{\\hat{f}_1}{\\hat{f}_2} = \\frac{1.30 \\times 10^{-4}}{6.10 \\times 10^{-3}} = \\frac{1.30}{61.0} \\approx 0.021311475\n$$\n现在，将这些值代入方差公式：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{1}{\\left(6.10 \\times 10^{-3}\\right)^2} \\left[ \\left(2.4 \\times 10^{-9}\\right) - 2\\left(\\frac{1.30}{61.0}\\right)\\left(-3.0 \\times 10^{-9}\\right) + \\left(\\frac{1.30}{61.0}\\right)^2\\left(1.3 \\times 10^{-7}\\right) \\right]\n$$\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{1}{3.721 \\times 10^{-5}} \\left[ 2.4 \\times 10^{-9} + \\left(\\frac{7.8}{61.0}\\right) \\times 10^{-9} + \\left(\\frac{1.69}{3721}\\right)\\left(1.3 \\times 10^{-7}\\right) \\right]\n$$\n为保持精度，我们提取公因子 $10^{-9}$：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{10^{-9}}{3.721 \\times 10^{-5}} \\left[ 2.4 + \\frac{7.8}{61.0} + \\frac{1.69 \\times 130}{3721} \\right]\n$$\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{10^{-4}}{3.721} \\left[ 2.4 + 0.1278688... + 0.0590432... \\right]\n$$\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{10^{-4}}{3.721} \\left[ 2.586912... \\right] \\approx 0.695219... \\times 10^{-4} = 6.95219... \\times 10^{-5}\n$$\n标准误差 $\\operatorname{se}(\\hat{\\alpha})$ 是方差的平方根：\n$$\n\\operatorname{se}(\\hat{\\alpha}) = \\sqrt{\\operatorname{Var}(\\hat{\\alpha})} \\approx \\sqrt{6.95219... \\times 10^{-5}} \\approx 0.00833798...\n$$\n按要求将结果四舍五入到三位有效数字，我们得到：\n$$\n\\operatorname{se}(\\hat{\\alpha}) \\approx 0.00834\n$$\n用科学记数法表示为 $8.34 \\times 10^{-3}$。",
            "answer": "$$\n\\boxed{8.34 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "一旦检测到基因渗入，一个关键问题是它发生在 *何时*。本练习探讨了一种为基因渗入事件定年的基本方法，即通过分析现代人基因组中存留的古人类DNA片段的长度 。其基本原理是，重组会随着时间的推移逐渐缩短这些DNA片段，因此我们可以根据其平均长度 $\\bar{L}$ 来估计基因渗入的年代 $t_a$。这个练习将巩固你对分子机制如何充当过去群体事件的“遗传时钟”的理解。",
            "id": "2692279",
            "problem": "一次单脉冲式古人类基因渗透事件发生在 $t_a$ 代前，进入了解剖学意义上的现代人群体。在这次混合脉冲之后，每一代中的重组都会打断基因渗透的祖源片段。在一个均一的每碱基重组率 $r$ (单位为 $\\text{bp}^{-1}\\text{gen}^{-1}$)下，渗透片段的长度（以碱基对为单位）可以沿染色体被建模为一个无记忆过程。给定一个从现代人基因组中推断出的一组经过整理的渗透片段中得到的平均片段长度的经验估计值 $\\bar{L} = 70$ kb，以及一个重组率 $r = 1.0 \\times 10^{-8}$ 每碱基对每代。假设代际时间为 $29$ 年。对个体和基因组区域进行的区块自助法分析得出样本平均片段长度的估计方差为 $\\text{Var}[\\bar{L}] = 4.9$ $(\\text{kb})^2$。\n\n仅使用基础群体遗传学中关于单次混合脉冲后 $t_a$ 代内重组断点的推理，按以下步骤进行：\n\n- 用 $\\bar{L}$ 和 $r$ 表示 $t_a$（以代为单位）的估计量，并计算其数值。\n- 使用给定的代际时间将该点估计值转换为年。\n- 使用 delta 方法和给定的 $\\text{Var}[\\bar{L}]$，计算 $t_a$（以代为单位）的近似 $95\\%$ 置信区间（CI），并将该区间转换为年。\n\n假设为单次脉冲混合模型，空间上均一的重组率，且基因转换可忽略不计。将所有报告的数值四舍五入至三位有效数字。用代和年表示时间估计值（在计算过程中说明单位），但请注意，评分时只会检查纯数字。对于数值计算，请记住 $1$ kb $= 1000$ bp。",
            "solution": "所述问题具有科学依据、提法明确且客观。它描述了群体遗传学中用于根据重组导致的祖源片段长度衰减来确定混合事件年代的一个标准简化模型。所提供的参数是符合实际的，所要求的计算也是标准的统计步骤。因此，我们开始进行解答。\n\n其基本原理是，源于 $t_a$ 代前一次单脉冲混合的渗透性染色体片段的长度遵循指数分布。这是因为将重组断点沿染色体建模为一个泊松过程。设 $r$ 为每碱基对每代的均一重组率。在 $t_a$ 代中，终止一个祖源片段的断点的累积率为 $\\lambda = t_a r$。\n\n一个片段长度 $L$ 的概率密度函数由 $f(L) = \\lambda \\exp(-\\lambda L)$ 给出。从此指数分布中得到的片段的期望值，即平均长度，为 $E[L] = \\frac{1}{\\lambda}$。\n\n通过代入 $\\lambda = t_a r$，我们得到平均片段长度与混合后时间之间的关系：\n$$E[L] = \\frac{1}{t_a r}$$\n经验测得的平均片段长度 $\\bar{L}$ 可用作真实群体均值 $E[L]$ 的估计量。因此，我们可以写出 $\\bar{L} \\approx \\frac{1}{t_a r}$。根据这个关系，我们推导出混合后代数 $\\hat{t}_a$ 的估计量，它是一个关于可观测数量 $\\bar{L}$ 和固定参数 $r$ 的函数：\n$$\\hat{t}_a = \\frac{1}{r \\bar{L}}$$\n这就是所要求的 $t_a$ 的估计量。\n\n我们现在计算 $t_a$ 的点估计值。给定值为 $\\bar{L} = 70$ kb 和 $r = 1.0 \\times 10^{-8} \\text{ bp}^{-1}\\text{gen}^{-1}$。为保证量纲一致性，我们必须用碱基对（bp）来表示 $\\bar{L}$，使用换算关系 $1 \\text{ kb} = 1000 \\text{ bp}$：\n$$\\bar{L} = 70 \\text{ kb} = 70 \\times 1000 \\text{ bp} = 7 \\times 10^4 \\text{ bp}$$\n将数值代入我们的估计量：\n$$\\hat{t}_a = \\frac{1}{(1.0 \\times 10^{-8} \\text{ bp}^{-1}\\text{gen}^{-1}) \\times (7 \\times 10^4 \\text{ bp})} = \\frac{1}{7 \\times 10^{-4}} \\text{ gen} \\approx 1428.57 \\text{ generations}$$\n四舍五入到三位有效数字，点估计值为 $\\hat{t}_a \\approx 1.43 \\times 10^3$ 代。\n\n为了将这个时间转换为年，我们使用指定的代际时间 $29$ 年：\n$$\\text{Time in years} = \\hat{t}_a \\times 29 \\text{ years/gen} \\approx 1428.57 \\times 29 \\approx 41428.5 \\text{ years}$$\n四舍五入到三位有效数字，这对应于 $4.14 \\times 10^4$ 年。\n\n接下来，我们利用 delta 方法计算 $t_a$ 的 $95\\%$ 置信区间。delta 方法用于近似一个随机变量函数的方差。我们的估计量 $\\hat{t}_a = g(\\bar{L}) = (r\\bar{L})^{-1}$ 是随机变量 $\\bar{L}$ 的一个函数。$g(\\bar{L})$ 的方差可近似为 $\\text{Var}[\\hat{t}_a] \\approx (g'(\\mu_{\\bar{L}}))^2 \\text{Var}[\\bar{L}]$，其中我们使用样本均值 $\\bar{L}$ 作为其期望值 $\\mu_{\\bar{L}}$ 的估计。$g(\\bar{L})$ 相对于 $\\bar{L}$ 的导数是：\n$$g'(\\bar{L}) = \\frac{d}{d\\bar{L}} \\left( \\frac{1}{r\\bar{L}} \\right) = -\\frac{1}{r\\bar{L}^2}$$\n因此，我们估计量的方差为：\n$$\\text{Var}[\\hat{t}_a] \\approx \\left(-\\frac{1}{r\\bar{L}^2}\\right)^2 \\text{Var}[\\bar{L}] = \\frac{\\text{Var}[\\bar{L}]}{r^2\\bar{L}^4}$$\n这个表达式可以用点估计值 $\\hat{t}_a = \\frac{1}{r\\bar{L}}$ 重写：\n$$\\text{Var}[\\hat{t}_a] \\approx \\left(\\frac{1}{r\\bar{L}}\\right)^2 \\frac{\\text{Var}[\\bar{L}]}{\\bar{L}^2} = \\hat{t}_a^2 \\frac{\\text{Var}[\\bar{L}]}{\\bar{L}^2}$$\n我们已知 $\\text{Var}[\\bar{L}] = 4.9 \\text{ (kb)}^2$。$\\bar{L}$ 的变异系数的平方是：\n$$\\frac{\\text{Var}[\\bar{L}]}{\\bar{L}^2} = \\frac{4.9 \\text{ (kb)}^2}{(70 \\text{ kb})^2} = \\frac{4.9}{4900} = 0.001$$\n那么 $\\hat{t}_a$ 的方差是：\n$$\\text{Var}[\\hat{t}_a] \\approx (1428.57 \\text{ gen})^2 \\times 0.001 \\approx 2040.8 \\text{ gen}^2$$\n估计值的标准误（SE）是其方差的平方根：\n$$SE(\\hat{t}_a) = \\sqrt{\\text{Var}[\\hat{t}_a]} \\approx \\sqrt{2040.8} \\approx 45.175 \\text{ generations}$$\n一个近似的 $95\\%$ 置信区间由 $\\hat{t}_a \\pm z_{0.025} \\times SE(\\hat{t}_a)$ 给出，其中 $z_{0.025} \\approx 1.96$ 是来自标准正态分布的临界值。误差范围是 $1.96 \\times 45.175 \\approx 88.543$ 代。\n\n$t_a$ 以代为单位的 $95\\%$ 置信区间是：\n$$[1428.57 - 88.543, \\quad 1428.57 + 88.543] = [1340.027, \\quad 1517.113] \\text{ generations}$$\n将区间边界四舍五入到三位有效数字，得到区间为 $[1.34 \\times 10^3, 1.52 \\times 10^3]$ 代。\n\n最后，我们将这个区间的未四舍五入的边界乘以 $29$ 年的代际时间，将其转换为年：\n$$\\text{Lower bound (years)}: 1340.027 \\times 29 \\approx 38860.8 \\text{ years}$$\n$$\\text{Upper bound (years)}: 1517.113 \\times 29 \\approx 43996.3 \\text{ years}$$\n四舍五入到三位有效数字，以年为单位的 $95\\%$ 置信区间是 $[3.89 \\times 10^4, 4.40 \\times 10^4]$ 年。\n\n所要求的数值结果是混合时间的点估计值（以代和年为单位），以及相应的 $95\\%$ 置信区间边界。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.43 \\times 10^3 & 4.14 \\times 10^4 & 1.34 \\times 10^3 & 1.52 \\times 10^3 & 3.89 \\times 10^4 & 4.40 \\times 10^4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在基因渗入研究中，一个关键挑战是如何将真实的基因渗入信号与由古代种群结构产生的模式区分开来，因为两者都可能导致相似的等位基因频率相关性。本练习将这种模糊性形式化，展示了不同的群体历史模型如何能够产生完全相同的 $f_4$ 统计量结果 。您将进一步探索如何利用基于连锁不平衡（LD）衰变的辅助统计量来打破僵局，为基因渗入特有的近期基因流提供“确凿证据”。这项实践将训练你批判性地评估统计证据，并利用多维度的基因组信息来解析复杂的演化历史。",
            "id": "2692318",
            "problem": "要求您形式化两种替代的人口统计学模型，这两种模型在标准的等位基因频率相关性统计量下会产生几乎无法区分的信号，并设计一个有原则的辅助统计量来区分它们。在Wright–Fisher模型的扩散极限下进行分析，采用高斯（布朗）近似来描述等位基因频率沿人口统计学图谱边缘的漂移，其中方差的独立增量等于漂移长度。假设一个群体在某个双等位基因座上的等位基因频率，被建模为沿从根到叶路径上各边缘的独立高斯增量之和。对于脉冲式混合，假设在混合节点处，亲代等位基因频率的随机变量是线性混合的。\n\n根据等位基因频率 $p_X$ 定义标准的 $f$-统计量 (Reich et al.) 如下：\n- $f_2(X,Y) = \\mathbb{E}\\left[(p_X - p_Y)^2\\right]$,\n- $f_3(C;A,B) = \\mathbb{E}\\left[(p_C - p_A)(p_C - p_B)\\right]$,\n- $f_4(A,B;C,D) = \\mathbb{E}\\left[(p_A - p_B)(p_C - p_D)\\right]$.\n\n您将考虑四个标记的群体：一个外群 $O$，一个古代人属 $N$，一个非洲人群 $A$，以及一个非非洲人群 $B$。漂移长度以方差沿边缘累加的单位表示（例如，$f_2$ 漂移单位）。\n\n模型 I (基因渗入模型): 一个对称的现代人骨架，伴有一次古代基因渗入到 $B$ 群体的脉冲。\n- 根分裂成导向 $N$ 和现代人祖先的谱系；共享的主干漂移长度为 $t_0$。\n- $N$ 谱系额外累积了 $n_U$ 的独特漂移直至现在。\n- 现代人祖先立即分裂为 $A$ 和 $B$（为简化起见，假设分裂后共享漂移为零）；$A$ 累积了 $a$ 的漂移直至现在，$B$ 沿其未混合的路径 $B_{\\mathrm{main}}$ 累积了 $b$ 的漂移直至现在。\n- 一次比例为 $\\alpha$ 的从 $N$ 到 $B$ 的基因渗入脉冲在非常近代发生，因此现今 $B$ 的随机变量为 $p_B = (1-\\alpha) p_{B_{\\mathrm{main}}} + \\alpha p_N$。\n- 外群 $O$ 是独立的，有自己的漂移方差 $o$，且与其他群体协方差为零。\n\n模型 S (深层结构模型): 一个没有基因渗入的树，其中 $B$ 和 $N$ 共享一个 $A$ 所不共享的额外内部支系。\n- 根分裂成两个分支：一个导向 $A$，另一个导向包含 $N$ 和 $B$ 的分支。共享的主干漂移长度为 $t_0$。\n- 在导向 $(N,B)$ 分支的支系上，在分裂成 $N$ 和 $B$ 之前，有一个漂移长度为 $s_{\\mathrm{shared}}$ 的短内部片段；此后，$N$ 继续以 $n_U - s_{\\mathrm{shared}}$ 的独特漂移发展，以保持 $N$ 的总方差与模型 I 中的相等；$B$ 继续以 $b_S$ 的独特漂移发展，$A$ 以 $a_S$ 的独特漂移发展。\n- 外群 $O$ 与上述模型相同。\n- 为了使 $f$-统计量与模型 I 中的紧密匹配，同时保持所有漂移为非负，选择 $s_{\\mathrm{shared}} = \\alpha n_U$ 并设置 $a_S = a - \\tfrac{1}{2} s_{\\mathrm{shared}}$ 和 $b_S = b - \\tfrac{1}{2} s_{\\mathrm{shared}}$。\n\n任务：\n1) 使用带有线性混合的高斯漂移设置，推导在每种模型下 $(O,N,A,B)$ 之间的预期协方差矩阵，作为漂移参数的函数。然后，使用这些协方差矩阵和 $f$-统计量的定义，计算在模型 I 和模型 S 下，对于四群体组 $(O,N;A,B)$、$(A,O;B,N)$ 和 $(A,B;O,N)$ 的 $f_4$-统计量三元组。将每个三元组表示为按指定顺序排列的三个实数的向量。\n\n2) 计算这两个 $f_4$ 三元组（模型 I 减去模型 S）之差的欧几里得范数。\n\n3) 提出并形式化一个基于双基因座混合连锁不平衡 (LD) 衰减的辅助统计量。使用以下原理：在过去 $t$ 代发生了一次比例为 $\\alpha$ 的单一混合脉冲，在遗传距离为 $d$ Morgans 处的预期协方差按 $C(d) = A_0 \\exp(-2 r t d)$ 衰减，其中 $r$ 是每 Morgan 的重组率，$A_0$ 是一个振幅。在没有近代脉冲的深层结构下，在相同的遗传距离尺度上，将预期协方差建模为 $C(d) = B_0$（近似平坦）。给定两个距离 $d_1$ 和 $d_2$ 且 $d_2 > d_1$，通过以下公式估计脉冲时间：\n$$\n\\widehat{t} = -\\frac{\\ln\\left(\\frac{C(d_2)}{C(d_1)}\\right)}{2 r (d_2 - d_1)}.\n$$\n采用惯例，如果 $C(d_1) = C(d_2) = 0$，则 $\\widehat{t} = 0$。对于模型 I，设置 $C(d) = \\alpha(1-\\alpha)\\exp(-2 r t d)$；对于模型 S，设置 $C(d) = B_0$，其中 $B_0 > 0$ 是一个常数（您的估计与 $B_0$ 无关）。报告每个模型的 $\\widehat{t}$。\n\n4) 决策规则：如果辅助统计量能够区分模型，则输出一个布尔值 true。此处定义为，对于模型 I 返回 $\\widehat{t} > 0$，对于模型 S 返回 $\\widehat{t} = 0$（在数值公差范围内）。\n\n测试套件与答案规范：\n- 使用以下三个参数集，每个参数集定义一个测试用例。在所有情况下，按顺序使用四群体组 $(O,N;A,B)$、$(A,O;B,N)$ 和 $(A,B;O,N)$。距离单位为 Morgans，重组率 $r$ 的单位为每 Morgan。\n    - 用例1: $t_0 = 0.1$, $n_U = 0.06$, $a = 0.02$, $b = 0.02$, $\\alpha = 0.02$, $o = 0.2$, $d_1 = 0.01$, $d_2 = 0.05$, $r = 1.0$, $t = 120$。\n    - 用例2: $t_0 = 0.1$, $n_U = 0.08$, $a = 0.03$, $b = 0.018$, $\\alpha = 0.005$, $o = 0.2$, $d_1 = 0.005$, $d_2 = 0.05$, $r = 1.0$, $t = 300$。\n    - 用例3: $t_0 = 0.1$, $n_U = 0.05$, $a = 0.02$, $b = 0.02$, $\\alpha = 0.0$, $o = 0.2$, $d_1 = 0.01$, $d_2 = 0.05$, $r = 1.0$, $t = 200$。\n\n- 单位与数值报告：\n    - 所有漂移长度（$t_0$, $n_U$, $a$, $b$, $o$）都以方差可加性累积的漂移单位表示；辅助统计量要求 $d_1$ 和 $d_2$ 的单位为 Morgans，$r$ 的单位为每 Morgan，$t$ 的单位为代。\n    - 您的程序必须为每个测试用例计算一个列表 $[ \\Delta, \\widehat{t}_{\\mathrm{I}}, \\widehat{t}_{\\mathrm{S}}, \\text{disc} ]$，其中 $\\Delta$ 是两个 $f_4$ 三元组（模型 I 减去模型 S）之差的欧几里得范数，$\\widehat{t}_{\\mathrm{I}}$ 是模型 I 的估计时间，$\\widehat{t}_{\\mathrm{S}}$ 是模型 S 的估计时间，$\\text{disc}$ 是上文定义的布尔值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个用例列表的结果，以逗号分隔，无空格，并用方括号括起来。例如，一个有效的格式是 $[[x_{11},x_{12},x_{13},b_1],[x_{21},x_{22},x_{23},b_2],[x_{31},x_{32},x_{33},b_3]]$，其中 $x_{ij}$ 是浮点数，$b_i$ 是布尔字面量。",
            "solution": "该问题要求我们使用群体遗传学统计量，来形式化并区分两种关于古代基因渗入的人口统计学模型。对问题陈述的验证已确认其科学合理性、一致性和适定性。我们可以开始解答。\n\n群体 $X$ 的等位基因频率 $p_X$ 被建模为从一个根频率开始的独立高斯增量之和，为计算 $f$-统计量，我们可以不失一般性地将该根频率设为 0。两个群体等位基因频率之间的协方差 $\\text{Cov}(p_X, p_Y)$，是从根到它们最近共同祖先的共享路径上的总漂移长度。我们将其表示为 $c(X,Y)$。方差 $\\text{Var}(p_X) = c(X,X)$ 是从根到 $X$ 的总漂移。$f$-统计量是根据等位基因频率差异乘积的期望来定义的，这可以用协方差来表示。具体而言，$f_4(A,B;C,D) = \\mathbb{E}[(p_A - p_B)(p_C - p_D)] = c(A,C) - c(A,D) - c(B,C) + c(B,D)$。\n\n**第1部分：协方差矩阵与 $f_4$-统计量**\n\n首先，我们推导在每种模型下群体 $(O, N, A, B)$ 等位基因频率的协方差矩阵。外群 $O$ 在根部分裂，且与所有其他群体独立，因此对于任何 $X \\neq O$，都有 $c(O,X)=0$，且 $\\text{Var}(p_O) = o$。\n\n**模型 I：基因渗入模型**\n人口统计学图为 $((N, (A, B_{\\text{main}})), O)$，其中一个近期的混合事件产生了群体 $B$。群体 $B$ 的等位基因频率由 $p_B = (1-\\alpha) p_{B_{\\mathrm{main}}} + \\alpha p_N$ 给出。我们利用协方差算子的线性性质来计算涉及 $p_B$ 的协方差。\n\n非混合群体的基本协方差为：\n- $\\text{Var}(p_N) = c(N,N) = t_0 + n_U$\n- $\\text{Var}(p_A) = c(A,A) = t_0 + a$\n- $\\text{Var}(p_{B_{\\mathrm{main}}}) = c(B_{\\mathrm{main}},B_{\\mathrm{main}}) = t_0 + b$\n- $c(N,A) = c(N,B_{\\mathrm{main}}) = c(A,B_{\\mathrm{main}}) = t_0$\n\n混合群体 $B$ 的协方差为：\n- $\\text{Cov}(p_A, p_B) = \\text{Cov}(p_A, (1-\\alpha)p_{B_{\\mathrm{main}}} + \\alpha p_N) = (1-\\alpha)c(A, B_{\\mathrm{main}}) + \\alpha c(A,N) = (1-\\alpha)t_0 + \\alpha t_0 = t_0$.\n- $\\text{Cov}(p_N, p_B) = \\text{Cov}(p_N, (1-\\alpha)p_{B_{\\mathrm{main}}} + \\alpha p_N) = (1-\\alpha)c(N, B_{\\mathrm{main}}) + \\alpha \\text{Var}(p_N) = (1-\\alpha)t_0 + \\alpha(t_0+n_U) = t_0 + \\alpha n_U$.\n- 计算指定的 $f_4$ 统计量不需要其他与 $p_B$ 相关的协方差。\n\n**模型 S：深层结构模型**\n人口统计学图为 $((A, (N,B)), O)$。这是一个没有混合的简单树模型。选择参数以模仿模型 I：$s_{\\mathrm{shared}} = \\alpha n_U$，$a_S = a - \\frac{1}{2}s_{\\mathrm{shared}}$，以及 $b_S = b - \\frac{1}{2}s_{\\mathrm{shared}}$。\n\n协方差可以直接从树结构中读出：\n- $c(A,N) = t_0$\n- $c(A,B) = t_0$\n- $c(N,B) = t_0 + s_{\\mathrm{shared}} = t_0 + \\alpha n_U$\n\n现在，我们计算两种模型的 $f_4$-统计量三元组。所需的四群体组是 $(O,N;A,B)$、$(A,O;B,N)$ 和 $(A,B;O,N)$。\n\n1.  $f_4(O,N;A,B) = c(O,A) - c(O,B) - c(N,A) + c(N,B)$:\n    - 模型 I: $0 - 0 - t_0 + (t_0 + \\alpha n_U) = \\alpha n_U$。\n    - 模型 S: $0 - 0 - t_0 + (t_0 + \\alpha n_U) = \\alpha n_U$。\n    结果是相同的。\n\n2.  $f_4(A,O;B,N) = c(A,B) - c(A,N) - c(O,B) + c(O,N)$:\n    - 模型 I: $t_0 - t_0 - 0 + 0 = 0$。\n    - 模型 S: $t_0 - t_0 - 0 + 0 = 0$。\n    结果是相同的。\n\n3.  $f_4(A,B;O,N) = c(A,O) - c(A,N) - c(B,O) + c(B,N)$:\n    - 模型 I: $0 - t_0 - 0 + (t_0 + \\alpha n_U) = \\alpha n_U$。\n    - 模型 S: $0 - t_0 - 0 + (t_0 + \\alpha n_U) = \\alpha n_U$。\n    结果是相同的。\n\n对于两种模型，$f_4$ 统计量三元组均为 $(\\alpha n_U, 0, \\alpha n_U)$。这表明，对于这组特定的统计量，这两个模型是无法区分的。\n\n**第2部分：差值的欧几里得范数**\n模型I的 $f_4$ 统计量向量是 $\\mathbf{F_I} = (\\alpha n_U, 0, \\alpha n_U)$，模型S的是 $\\mathbf{F_S} = (\\alpha n_U, 0, \\alpha n_U)$。差分向量是 $\\mathbf{F_I} - \\mathbf{F_S} = (0, 0, 0)$。\n这个差值的欧几里得范数 $\\Delta$ 是：\n$$\n\\Delta = \\sqrt{0^2 + 0^2 + 0^2} = 0\n$$\n\n**第3部分：基于LD衰减的辅助统计量**\n所提出的辅助统计量是基于连锁不平衡 (LD) 随遗传距离 $d$ 的衰减而对混合时间 $t$ 的一个估计量。\n$$\n\\widehat{t} = -\\frac{\\ln\\left(\\frac{C(d_2)}{C(d_1)}\\right)}{2 r (d_2 - d_1)}\n$$\n- **对于模型 I (基因渗入)**，混合连锁不平衡由 $C(d) = \\alpha(1-\\alpha)e^{-2rtd}$ 给出。\n  如果 $\\alpha \\in (0,1)$，协方差的比率是：\n  $$\n  \\frac{C(d_2)}{C(d_1)} = \\frac{\\alpha(1-\\alpha)\\exp(-2 r t d_2)}{\\alpha(1-\\alpha)\\exp(-2 r t d_1)} = \\exp(-2 r t (d_2 - d_1))\n  $$\n  将此代入 $\\widehat{t}_{\\mathrm{I}}$ 的估计量中：\n  $$\n  \\widehat{t}_{\\mathrm{I}} = -\\frac{\\ln(\\exp(-2 r t (d_2 - d_1)))}{2 r (d_2 - d_1)} = -\\frac{-2 r t (d_2 - d_1)}{2 r (d_2 - d_1)} = t\n  $$\n  如果 $\\alpha=0$ 或 $\\alpha=1$，则 $C(d)=0$，并且根据问题的惯例，$\\widehat{t}_{\\mathrm{I}} = 0$。\n\n- **对于模型 S (深层结构)**，没有近期的混合脉冲。LD 被建模为一个常数，$C(d) = B_0 > 0$。\n  协方差的比率是：\n  $$\n  \\frac{C(d_2)}{C(d_1)} = \\frac{B_0}{B_0} = 1\n  $$\n  将此代入 $\\widehat{t}_{\\mathrm{S}}$ 的估计量中：\n  $$\n  \\widehat{t}_{\\mathrm{S}} = -\\frac{\\ln(1)}{2 r (d_2 - d_1)} = -\\frac{0}{2 r (d_2 - d_1)} = 0\n  $$\n\n**第4部分：决策规则与测试用例评估**\n区分模型的决策规则是一个布尔值 `disc`，如果 $\\widehat{t}_{\\mathrm{I}} > 0$ 且 $\\widehat{t}_{\\mathrm{S}} = 0$，则为 true。由于 $\\widehat{t}_{\\mathrm{S}}$ 始终为 0，该规则简化为 `disc` 为 true 当且仅当 $\\widehat{t}_{\\mathrm{I}} > 0$。这种情况发生在存在真实混合（$\\alpha \\in (0,1)$）且脉冲时间 $t$ 为正时。\n\n我们现在将这些公式应用于测试用例。\n\n**用例1：** $\\alpha = 0.02$，$n_U = 0.06$，$t=120$。\n- $\\Delta = 0.0$。\n- $\\widehat{t}_{\\mathrm{I}} = t = 120.0$ (因为 $0 < 0.02 < 1$)。\n- $\\widehat{t}_{\\mathrm{S}} = 0.0$。\n- `disc`: $(120.0 > 0) \\land (0.0 = 0)$ 为 True。\n- 结果: $[0.0, 120.0, 0.0, \\text{True}]$\n\n**用例2：** $\\alpha = 0.005$，$n_U = 0.08$，$t=300$。\n- $\\Delta = 0.0$。\n- $\\widehat{t}_{\\mathrm{I}} = t = 300.0$ (因为 $0 < 0.005 < 1$)。\n- $\\widehat{t}_{\\mathrm{S}} = 0.0$。\n- `disc`: $(300.0 > 0) \\land (0.0 = 0)$ 为 True。\n- 结果: $[0.0, 300.0, 0.0, \\text{True}]$\n\n**用例3：** $\\alpha = 0.0$，$n_U = 0.05$，$t=200$。\n- $\\Delta = 0.0$。\n- $\\widehat{t}_{\\mathrm{I}} = 0.0$ (因为 $\\alpha = 0$)。\n- $\\widehat{t}_{\\mathrm{S}} = 0.0$。\n- `disc`: $(0.0 > 0) \\land (0.0 = 0)$ 为 False。\n- 结果: $[0.0, 0.0, 0.0, \\text{False}]$\n\n基于LD的统计量成功地区分了模型 I（有基因渗入）和模型 S（深层结构），而所选的 $f_4$-统计量集合则不能。",
            "answer": "[[0.0,120.0,0.0,True],[0.0,300.0,0.0,True],[0.0,0.0,0.0,False]]"
        }
    ]
}