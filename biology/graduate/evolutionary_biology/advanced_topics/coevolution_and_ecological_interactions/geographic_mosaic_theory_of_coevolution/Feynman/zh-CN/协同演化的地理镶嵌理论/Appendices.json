{
    "hands_on_practices": [
        {
            "introduction": "地理选择镶嵌理论始于一个核心观点：共同进化互作的强度和方向在空间上是变化的。本练习将此概念形式化，通过推导在由共同进化热点和冷点构成的异质景观中，作用于物种性状的总体选择压力。掌握如何从适应度函数出发计算选择梯度，是理论上模拟空间共同进化的基础技能，它能量化地理镶嵌如何塑造净进化方向。",
            "id": "2719766",
            "problem": "两种相互作用的物种（物种A和物种B）在一个异质性景观中协同进化，这与协同进化的地理镶嵌理论相符。设物种A的平均性状值为 $z_A$，物种B的平均性状值为 $z_B$。环境异质性由 $K$ 个不同的生态斑块所体现，斑块由 $k \\in \\{1,\\dots,K\\}$ 索引，每个斑块被遇到的频率为 $\\pi_k$，使得 $\\sum_{k=1}^{K} \\pi_k = 1$ 且对所有 $k$ 都有 $\\pi_k > 0$。在斑块 $k$ 中，物种A的人均适合度为 $w_A^{(k)} = f_k(z_A, z_B)$，物种B的人均适合度为 $w_B^{(k)} = g_k(z_A, z_B)$，其中 $f_k$ 和 $g_k$ 是关于性状的正、二次连续可微函数，概括了协同进化相互作用和局域生态条件的影响。\n\n假设：\n- 在每个物种内部，性状近似服从方差很小且选择较弱的正态分布，因此在 $(z_A, z_B)$ 附近的一阶（线性）近似是准确的。\n- 高强度的基因流在每一代中使每个物种内部各斑块间的平均性状均质化，因此在给定的一代中，每个斑块经历相同的 $(z_A, z_B)$。\n- 在所考虑的时间尺度上，传递偏差可以忽略不计。\n\n以Price方程为基本基础，并利用相对适合度的定义，从第一性原理推导作用于每个物种性状的方向性选择梯度表达式，这些梯度决定了在整个镶嵌景观上作用于 $z_A$ 和 $z_B$ 的直接选择方向。你的推导应首先表达每个物种在所有斑块上的平均适合度，然后对平均相对适合度求其自身性状的导数。将最终答案表示为行矩阵 $\\bigl(\\beta_A\\ \\beta_B\\bigr)$，其中 $\\beta_A$ 和 $\\beta_B$ 分别是作用于 $z_A$ 和 $z_B$ 的方向性选择梯度。以 $\\{\\pi_k\\}_{k=1}^{K}$、$\\{f_k\\}_{k=1}^{K}$ 和 $\\{g_k\\}_{k=1}^{K}$ 的闭合形式给出你的最终表达式。无需进行数值评估，也无需四舍五入。",
            "solution": "问题陈述具有科学依据、自成体系且阐述清晰。这是一个将理论数量遗传学应用于协同进化地理镶嵌理论的标准练习。我们将从第一性原理出发进行严格推导。\n\n作用于数量性状的直接选择方向由方向性选择梯度决定，记为 $\\beta$。Price方程为这一概念提供了基本基础。平均性状 $\\bar{z}$ 的变化由 $\\Delta \\bar{z} = \\text{Cov}(w, z) + \\text{E}(w \\Delta z)$ 给出，其中 $w$ 是相对适合度，$z$ 是性状，$\\text{Cov}$ 是协方差，$\\text{E}$ 是期望。问题指明传递偏差可以忽略，因此第二项 $\\text{E}(w \\Delta z)$ 可以被忽略。在弱选择的假设下，平均性状的变化可以很好地近似为 $\\Delta \\bar{z} \\approx G \\beta_z$，其中 $G$ 是性状的加性遗传方差。选择梯度 $\\beta_z$ 定义为个体的相对适合度对其自身性状值的偏导数，并在群体平均性状处取值。我们应用此定义来推导物种A和物种B的选择梯度。\n\n让我们首先考虑物种A。设 $z_A'$ 表示物种A中某个个体的性状值，而 $z_A$ 是整个物种的平均性状值。问题陈述指出，高强度的基因流使得跨越所有 $K$ 个斑块的平均性状均质化。因此，具有性状 $z_A'$ 的个体的适合度是在整个景观上平均的。该个体的绝对适合度 $W_A(z_A')$ 是其在每个斑块 $k$ 中适合度的加权平均，权重为斑块频率 $\\pi_k$。适合度取决于个体的性状 $z_A'$ 和相互作用物种B的平均性状 $z_B$。\n$$W_A(z_A', z_B) = \\sum_{k=1}^{K} \\pi_k f_k(z_A', z_B)$$\n整个物种A群体的平均绝对适合度 $\\bar{W}_A$ 是通过在群体平均性状值 $z_A' = z_A$ 处评估 $W_A(z_A', z_B)$ 得到的。\n$$\\bar{W}_A(z_A, z_B) = \\sum_{k=1}^{K} \\pi_k f_k(z_A, z_B)$$\n具有性状 $z_A'$ 的个体的相对适合度是其绝对适合度除以群体的平均绝对适合度。\n$$w_A(z_A') = \\frac{W_A(z_A', z_B)}{\\bar{W}_A(z_A, z_B)}$$\n作用于性状 $z_A$ 的方向性选择梯度，记为 $\\beta_A$，是该相对适合度函数对个体性状 $z_A'$ 的偏导数，并在群体平均值 $z_A$ 处求值。\n$$\\beta_A = \\frac{\\partial w_A(z_A')}{\\partial z_A'} \\bigg|_{z_A' = z_A}$$\n我们使用商法则计算此导数。关键要注意，$\\bar{W}_A(z_A, z_B)$ 是群体平均性状 $z_A$ 的函数，因此在对个体性状变量 $z_A'$ 求导时被视为常数。\n$$\\frac{\\partial w_A(z_A')}{\\partial z_A'} = \\frac{\\partial}{\\partial z_A'} \\left( \\frac{W_A(z_A', z_B)}{\\bar{W}_A(z_A, z_B)} \\right) = \\frac{1}{\\bar{W}_A(z_A, z_B)} \\frac{\\partial W_A(z_A', z_B)}{\\partial z_A'}$$\n个体绝对适合度的导数是：\n$$\\frac{\\partial W_A(z_A', z_B)}{\\partial z_A'} = \\frac{\\partial}{\\partial z_A'} \\left( \\sum_{k=1}^{K} \\pi_k f_k(z_A', z_B) \\right) = \\sum_{k=1}^{K} \\pi_k \\frac{\\partial f_k(z_A', z_B)}{\\partial z_A'}$$\n在 $z_A' = z_A$ 处求值得到：\n$$\\frac{\\partial W_A(z_A', z_B)}{\\partial z_A'} \\bigg|_{z_A' = z_A} = \\sum_{k=1}^{K} \\pi_k \\frac{\\partial f_k(z_A, z_B)}{\\partial z_A}$$\n将此结果代回 $\\beta_A$ 的表达式，我们得到：\n$$\\beta_A = \\frac{1}{\\bar{W}_A(z_A, z_B)} \\sum_{k=1}^{K} \\pi_k \\frac{\\partial f_k(z_A, z_B)}{\\partial z_A}$$\n最后，我们代入 $\\bar{W}_A(z_A, z_B)$ 的表达式：\n$$\\beta_A = \\frac{\\sum_{k=1}^{K} \\pi_k \\frac{\\partial f_k(z_A, z_B)}{\\partial z_A}}{\\sum_{k=1}^{K} \\pi_k f_k(z_A, z_B)}$$\n这就是作用于性状 $z_A$ 的选择梯度。它是景观平均的选择压力，并由景观平均的适合度进行归一化。\n\n对物种B的推导遵循相同的逻辑。设 $z_B'$ 是来自物种B的个体的性状，$z_B$是群体平均值。该个体的绝对适合度 $W_B(z_A, z_B')$ 取决于其自身的性状和物种A的平均性状 $z_A$。\n$$W_B(z_A, z_B') = \\sum_{k=1}^{K} \\pi_k g_k(z_A, z_B')$$\n物种B群体的平均绝对适合度是：\n$$\\bar{W}_B(z_A, z_B) = \\sum_{k=1}^{K} \\pi_k g_k(z_A, z_B)$$\n该个体的相对适合度是 $w_B(z_B') = W_B(z_A, z_B') / \\bar{W}_B(z_A, z_B)$。选择梯度 $\\beta_B$ 是：\n$$\\beta_B = \\frac{\\partial w_B(z_B')}{\\partial z_B'} \\bigg|_{z_B' = z_B}$$\n遵循与物种A相同的步骤：\n$$\\beta_B = \\frac{1}{\\bar{W}_B(z_A, z_B)} \\frac{\\partial W_B(z_A, z_B')}{\\partial z_B'} \\bigg|_{z_B' = z_B}$$\n$$\\frac{\\partial W_B(z_A, z_B')}{\\partial z_B'} \\bigg|_{z_B' = z_B} = \\sum_{k=1}^{K} \\pi_k \\frac{\\partial g_k(z_A, z_B)}{\\partial z_B}$$\n代入这些表达式得到 $\\beta_B$ 的最终形式：\n$$\\beta_B = \\frac{\\sum_{k=1}^{K} \\pi_k \\frac{\\partial g_k(z_A, z_B)}{\\partial z_B}}{\\sum_{k=1}^{K} \\pi_k g_k(z_A, z_B)}$$\n问题要求答案以行矩阵 $(\\beta_A, \\beta_B)$ 的形式给出。结合推导出的表达式，我们得出最终结果。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\sum_{k=1}^{K} \\pi_k \\frac{\\partial f_k(z_A, z_B)}{\\partial z_A}}{\\sum_{k=1}^{K} \\pi_k f_k(z_A, z_B)} & \\frac{\\sum_{k=1}^{K} \\pi_k \\frac{\\partial g_k(z_A, z_B)}{\\partial z_B}}{\\sum_{k=1}^{K} \\pi_k g_k(z_A, z_B)} \\end{pmatrix} } $$"
        },
        {
            "introduction": "选择压力只是共同进化故事的一部分；通过基因流进行的性状重混是另一个关键过程。本练习探讨了两种核心力量之间的相互作用：驱动性状适应局部环境的局域选择，以及倾向于使不同种群性状均质化的基因流。通过求解该模型下的平衡性状值，您可以定量地理解这种基本张力如何决定了局域适应和潜在错配的地理格局。",
            "id": "2719868",
            "problem": "考虑一个由两个斑块组成的复合种群，斑块之间通过对称扩散连接，每代迁移率为 $m$（岛屿模型）。单个数量性状 $z$ 在数量遗传动力学的作用下演化。在每个斑块 $i \\in \\{1,2\\}$ 中，令 $\\bar{z}_i$ 表示平均性状。假设：\n- 在两个斑块中，加性遗传方差是恒定的，且等于 $G$。\n- 在每个斑块中，性状根据 Lande 方程演化，迁移将斑块耦合起来：$\\bar{z}_i$ 的每代变化由 $G \\beta_i(\\bar{z}_i)$ 加上来自另一斑块迁入者的净增益给出。\n- 局域共同演化相互作用产生围绕斑块特有的最适值 $\\theta_1$ 和 $\\theta_2$ 的高斯稳定化选择，且曲率相等。具体而言，斑块 $i$ 中的 Malthus 适应度满足 $\\ln W_i(z) = \\text{const} - \\frac{a}{2}(z - \\theta_i)^2$，其中 $a>0$ 衡量稳定化选择的强度。因此，局域选择梯度（$\\ln W_i$ 关于 $z$ 的导数）是 $\\beta_i(\\bar{z}_i) = -a(\\bar{z}_i - \\theta_i)$。\n\n从这些假设和包含迁移的 Lande 方程的定义出发，推导出平衡平均性状 $\\bar{z}_1^{\\ast}$ 和 $\\bar{z}_2^{\\ast}$ 关于 $G$、$a$、$m$、$\\theta_1$ 和 $\\theta_2$ 的闭式解析表达式。将你的最终答案表示为一个单行矩阵，其元素为 $\\bar{z}_1^{\\ast}$ 和 $\\bar{z}_2^{\\ast}$。不需要数值近似或四舍五入。",
            "solution": "该问题要求在一个包含选择和迁移的二斑块数量遗传模型中求解平衡平均性状。对问题陈述的验证确认了其科学性、良定性和客观性。我们可以开始推导。\n\n每个斑块 $i \\in \\{1, 2\\}$ 中平均性状 $\\bar{z}_i$ 的动力学由 Lande 方程决定，该方程经过增广以包含迁移效应。平均性状的每代变化 $\\Delta\\bar{z}_i$ 是对选择的响应和由基因流引起的变化之和。对选择的响应由加性遗传方差 $G$ 和选择梯度 $\\beta_i$ 的乘积给出。从斑块 $j$到斑块 $i$ 的基因流引起的变化与迁移率 $m$ 和平均性状的差异成正比，即 $m(\\bar{z}_j - \\bar{z}_i)$。\n\n因此，我们可以写出平均性状 $\\bar{z}_1$ 和 $\\bar{z}_2$ 的差分方程组如下：\n$$\n\\Delta\\bar{z}_1 = \\bar{z}_1(t+1) - \\bar{z}_1(t) = G \\beta_1(\\bar{z}_1) + m(\\bar{z}_2 - \\bar{z}_1)\n$$\n$$\n\\Delta\\bar{z}_2 = \\bar{z}_2(t+1) - \\bar{z}_2(t) = G \\beta_2(\\bar{z}_2) + m(\\bar{z}_1 - \\bar{z}_2)\n$$\n问题指定了围绕局域最适值 $\\theta_i$ 的高斯稳定化选择的选择梯度为 $\\beta_i(\\bar{z}_i) = -a(\\bar{z}_i - \\theta_i)$，其中 $a > 0$ 是选择强度。将此代入动力学方程，得到：\n$$\n\\Delta\\bar{z}_1 = -G a (\\bar{z}_1 - \\theta_1) + m(\\bar{z}_2 - \\bar{z}_1)\n$$\n$$\n\\Delta\\bar{z}_2 = -G a (\\bar{z}_2 - \\theta_2) + m(\\bar{z}_1 - \\bar{z}_2)\n$$\n在平衡状态下，平均性状不再改变，因此 $\\Delta\\bar{z}_1 = 0$ 和 $\\Delta\\bar{z}_2 = 0$。令平衡性状为 $\\bar{z}_1^{\\ast}$ 和 $\\bar{z}_2^{\\ast}$。平衡时的方程组为：\n$$\n0 = -G a (\\bar{z}_1^{\\ast} - \\theta_1) + m(\\bar{z}_2^{\\ast} - \\bar{z}_1^{\\ast}) \\quad (1)\n$$\n$$\n0 = -G a (\\bar{z}_2^{\\ast} - \\theta_2) + m(\\bar{z}_1^{\\ast} - \\bar{z}_2^{\\ast}) \\quad (2)\n$$\n我们现在必须求解这个关于 $\\bar{z}_1^{\\ast}$ 和 $\\bar{z}_2^{\\ast}$ 的二元线性方程组。我们先整理方程。\n由方程($1$):\n$$\nG a (\\bar{z}_1^{\\ast} - \\theta_1) = m(\\bar{z}_2^{\\ast} - \\bar{z}_1^{\\ast})\n$$\n$$\nG a \\bar{z}_1^{\\ast} - G a \\theta_1 = m \\bar{z}_2^{\\ast} - m \\bar{z}_1^{\\ast}\n$$\n$$\n(G a + m) \\bar{z}_1^{\\ast} - m \\bar{z}_2^{\\ast} = G a \\theta_1 \\quad (3)\n$$\n由方程($2$):\n$$\nG a (\\bar{z}_2^{\\ast} - \\theta_2) = m(\\bar{z}_1^{\\ast} - \\bar{z}_2^{\\ast})\n$$\n$$\nG a \\bar{z}_2^{\\ast} - G a \\theta_2 = m \\bar{z}_1^{\\ast} - m \\bar{z}_2^{\\ast}\n$$\n$$\n-m \\bar{z}_1^{\\ast} + (G a + m) \\bar{z}_2^{\\ast} = G a \\theta_2 \\quad (4)\n$$\n将方程($3$)和方程($4$)相加，得到一个有用的简化：\n$$\n[(G a + m) - m] \\bar{z}_1^{\\ast} + [-m + (G a + m)] \\bar{z}_2^{\\ast} = G a \\theta_1 + G a \\theta_2\n$$\n$$\nG a \\bar{z}_1^{\\ast} + G a \\bar{z}_2^{\\ast} = G a (\\theta_1 + \\theta_2)\n$$\n由于 $G$ 和 $a$ 是正常数，我们可以两边同除以 $G a$：\n$$\n\\bar{z}_1^{\\ast} + \\bar{z}_2^{\\ast} = \\theta_1 + \\theta_2\n$$\n这揭示了平衡平均性状之和等于选择最适值之和。由此，我们可以用一个变量表示另一个变量：$\\bar{z}_2^{\\ast} = \\theta_1 + \\theta_2 - \\bar{z}_1^{\\ast}$。\n将 $\\bar{z}_2^{\\ast}$ 的这个表达式代入方程($3$)中：\n$$\n(G a + m) \\bar{z}_1^{\\ast} - m (\\theta_1 + \\theta_2 - \\bar{z}_1^{\\ast}) = G a \\theta_1\n$$\n$$\nG a \\bar{z}_1^{\\ast} + m \\bar{z}_1^{\\ast} - m \\theta_1 - m \\theta_2 + m \\bar{z}_1^{\\ast} = G a \\theta_1\n$$\n合并含有 $\\bar{z}_1^{\\ast}$ 的项：\n$$\n(G a + 2m) \\bar{z}_1^{\\ast} = G a \\theta_1 + m \\theta_1 + m \\theta_2\n$$\n$$\n(G a + 2m) \\bar{z}_1^{\\ast} = (G a + m)\\theta_1 + m \\theta_2\n$$\n解出 $\\bar{z}_1^{\\ast}$ 得到：\n$$\n\\bar{z}_1^{\\ast} = \\frac{(G a + m) \\theta_1 + m \\theta_2}{G a + 2m}\n$$\n由于问题设定的对称性，$\\bar{z}_2^{\\ast}$ 的表达式可以通过简单地交换下标 $1$ 和 $2$ 来获得：\n$$\n\\bar{z}_2^{\\ast} = \\frac{(G a + m) \\theta_2 + m \\theta_1}{G a + 2m}\n$$\n这些就是平衡平均性状的闭式解析表达式。表达式表明，每个平衡性状都是两个最适值 $\\theta_1$ 和 $\\theta_2$ 的加权平均。权重取决于选择（$G a$）和迁移（$m$）的相对强度。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{(G a + m) \\theta_1 + m \\theta_2}{G a + 2m} & \\frac{(G a + m) \\theta_2 + m \\theta_1}{G a + 2m} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "检验地理镶嵌理论的预测，最终需要我们能够从真实世界的经验数据中量化选择。本练习将引导您完成经验分析中的两个关键步骤：首先，学习如何直接从野外采集的个体适应度和性状数据中估计理论上的选择梯度；其次，学习如何运用统计模型将观察到的选择梯度在空间上的变异分解为由生态因素驱动的部分和由共同进化互作物种性状驱动的部分。这项实践将抽象的理论与经验研究紧密联系起来。",
            "id": "2719800",
            "problem": "考虑一个共进化种对，分布在 $m$ 个离散的地点，地点索引为 $i \\in \\{1,\\dots,m\\}$。在每个地点 $i$，您对焦点物种的 $n_i$ 个个体进行抽样，并测量每个个体 $j \\in \\{1,\\dots,n_i\\}$ 的一个焦点数量性状 $z_{ij}$ 及其绝对适合度 $W_{ij}$。您还记录了每个地点 $i$ 的一个生态驱动因子 $X_i$（例如，资源指数）和一个互作物种性状的局域均值 $y_i$（例如，介导交互选择的拮抗物种性状的均值）。假设在每个地点 $i$ 内，对焦点性状的定向选择可以很好地用相对适合度与该性状之间的线性关系来近似，并且在各地之间，局域定向选择梯度的变异源于生态背景和作用者的进化分化，这与共进化的地理镶嵌理论一致。\n\n1) 仅使用相对适合度和普通最小二乘法的定义，推导在地点 $i$ 内作用于 $z$ 的定向选择梯度 $\\beta_i$ 的一个地点特异性无偏估计量 $\\hat{\\beta}_i$，该估计量是相对适合度对性状回归的斜率。您的估计量必须用 $\\{z_{ij},W_{ij}\\}_{j=1}^{n_i}$ 和地点水平的样本均值明确表示。\n\n2) 为捕捉地理镶嵌，假设 $\\beta_i$ 的跨地点变异可以用一个包含生态预测变量和进化预测变量的线性模型来描述，\n$$\n\\beta_i \\;=\\; \\alpha \\;+\\; \\gamma_{E}\\,X_i \\;+\\; \\gamma_{Y}\\,y_i \\;+\\; \\varepsilon_i,\n$$\n其中 $\\alpha$ 是截距，$\\gamma_{E}$ 和 $\\gamma_{Y}$ 是回归系数，$\\varepsilon_i$ 是独立的、均值为零且方差恒定的残差。仅使用方差、协方差和线性法则，推导一个闭式表达式，将跨地点方差 $\\mathrm{Var}(\\beta_i)$ 分解为一个归因于 $X_i$ 的生态分量、一个归因于 $y_i$ 的进化分量、一个生态-进化耦合项和一个残差分量。您的最终分解式必须仅用 $\\gamma_{E}$、$\\gamma_{Y}$、$\\mathrm{Var}(X_i)$、$\\mathrm{Var}(y_i)$、$\\mathrm{Cov}(X_i,y_i)$ 和 $\\mathrm{Var}(\\varepsilon_i)$ 来表示。\n\n将您的最终答案以单个行矩阵的形式呈现，该矩阵由一对解析表达式组成，第一个条目是第1部分得到的估计量 $\\hat{\\beta}_i$，第二个条目是第2部分得到的方差分解式。不需要进行数值计算，最终答案中也不应包含任何单位。",
            "solution": "此问题具有坚实的科学基础，问题阐述清晰，可以通过直接应用统计学和数量进化生物学的标准原理解答。\n\n第1部分：地点特异性选择梯度估计量 $\\hat{\\beta}_i$ 的推导。\n\n目标是推导在特定地点 $i$ 内定向选择梯度 $\\beta_i$ 的一个估计量。问题指明，相对适合度与数量性状 $z$ 之间存在线性关系。\n\n首先，我们定义相对适合度。对于地点 $i$ 中的任何个体 $j$，其绝对适合度为 $W_{ij}$。包含 $n_i$ 个个体的地点 $i$ 的平均绝对适合度由下式给出：\n$$ \\bar{W}_i = \\frac{1}{n_i} \\sum_{j=1}^{n_i} W_{ij} $$\n相对适合度 $w_{ij}$ 则定义为个体的绝对适合度除以地点均值：\n$$ w_{ij} = \\frac{W_{ij}}{\\bar{W}_i} $$\n相对适合度的一个关键特性是其在地点内的样本均值恒为1：\n$$ \\bar{w}_i = \\frac{1}{n_i} \\sum_{j=1}^{n_i} w_{ij} = \\frac{1}{n_i} \\sum_{j=1}^{n_i} \\frac{W_{ij}}{\\bar{W}_i} = \\frac{1}{n_i \\bar{W}_i} \\left( \\sum_{j=1}^{n_i} W_{ij} \\right) = \\frac{1}{n_i \\bar{W}_i} (n_i \\bar{W}_i) = 1 $$\n\n问题陈述，相对适合度与性状 $z_{ij}$ 之间的关系可用一个线性模型近似：\n$$ w_{ij} = \\alpha_i' + \\beta_i z_{ij} + e_{ij} $$\n其中 $\\beta_i$ 是我们关心的定向选择梯度。我们的任务是求出该斜率的普通最小二乘（OLS）估计量，我们将其记为 $\\hat{\\beta}_i$。\n\n对于响应变量 $Y$ 对预测变量 $X$ 的简单线性回归，OLS斜率估计量的一般公式为：\n$$ \\hat{\\beta} = \\frac{\\sum_{k=1}^{N} (X_k - \\bar{X})(Y_k - \\bar{Y})}{\\sum_{k=1}^{N} (X_k - \\bar{X})^2} $$\n对于我们在地点 $i$ 的特定情况，我们有 $Y_j = w_{ij}$ 和 $X_j = z_{ij}$。相应的样本均值为 $\\bar{Y} = \\bar{w}_i = 1$ 和 $\\bar{X} = \\bar{z}_i$，其中 $\\bar{z}_i = \\frac{1}{n_i} \\sum_{j=1}^{n_i} z_{ij}$。\n\n将这些代入OLS公式，得到 $\\beta_i$ 的估计量：\n$$ \\hat{\\beta}_i = \\frac{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)(w_{ij} - \\bar{w}_i)}{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)^2} = \\frac{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)(w_{ij} - 1)}{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)^2} $$\n现在，我们必须用给定的量 $\\{z_{ij}, W_{ij}\\}$ 以及地点水平的样本均值 $\\bar{z}_i$ 和 $\\bar{W}_i$ 来表示它。我们代入 $w_{ij} = W_{ij} / \\bar{W}_i$：\n$$ \\hat{\\beta}_i = \\frac{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) \\left( \\frac{W_{ij}}{\\bar{W}_i} - 1 \\right)}{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)^2} $$\n分子可以展开为：\n$$ \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) \\left( \\frac{W_{ij}}{\\bar{W}_i} - 1 \\right) = \\frac{1}{\\bar{W}_i} \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) W_{ij} - \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) $$\n根据均值的定义，第二项 $\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)$ 恒等于零。因此，分子简化为：\n$$ \\frac{1}{\\bar{W}_i} \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) W_{ij} $$\n项 $\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) W_{ij}$ 是中心化性状值与绝对适合度值的交叉乘积之和。这也可以写成中心化适合度值的形式，即 $\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)(W_{ij} - \\bar{W}_i)$，因为增加的项 $-\\bar{W}_i \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)$ 为零。\n因此，估计量 $\\hat{\\beta}_i$ 的最终表达式为：\n$$ \\hat{\\beta}_i = \\frac{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)(W_{ij} - \\bar{W}_i)}{\\bar{W}_i \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)^2} $$\n此表达式满足了问题的要求。它是性状与绝对适合度的样本协方差，除以平均绝对适合度与性状的样本方差的乘积（分子和分母中都有一个因子 $n_i - 1$ 或 $n_i$，它们相互抵消）。\n\n第2部分：跨地点选择梯度 $\\mathrm{Var}(\\beta_i)$ 的方差分解。\n\n问题的第二部分要求基于给定的线性模型来分解选择梯度的跨地点方差 $\\mathrm{Var}(\\beta_i)$：\n$$ \\beta_i = \\alpha + \\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i + \\varepsilon_i $$\n在这里，$\\beta_i$、$X_i$、$y_i$ 和 $\\varepsilon_i$ 是代表 $m$ 个地点间变异的随机变量，而 $\\alpha$、$\\gamma_E$ 和 $\\gamma_Y$ 是固定系数。残差 $\\varepsilon_i$ 是独立的，均值为零，方差为常数 $\\mathrm{Var}(\\varepsilon_i)$，并且与预测变量 $X_i$ 和 $y_i$ 相互独立。\n\n我们将方差算子应用于 $\\beta_i$ 的方程：\n$$ \\mathrm{Var}(\\beta_i) = \\mathrm{Var}(\\alpha + \\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i + \\varepsilon_i) $$\n使用方差的基本性质：\n1.  常数的方差为零，所以 $\\mathrm{Var}(\\alpha)=0$。\n2.  随机变量 $A$ 和 $B$ 之和的方差为 $\\mathrm{Var}(A+B) = \\mathrm{Var}(A) + \\mathrm{Var}(B) + 2\\mathrm{Cov}(A,B)$。\n\n由于误差项 $\\varepsilon_i$ 与 $X_i$ 和 $y_i$ 都独立，因此它也与它们的任何线性组合独立。因此，$\\varepsilon_i$ 与其他变量项之间的协方差为零：\n$$ \\mathrm{Cov}(\\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i, \\varepsilon_i) = 0 $$\n这使我们能够将误差项的方差分离出来：\n$$ \\mathrm{Var}(\\beta_i) = \\mathrm{Var}(\\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i) + \\mathrm{Var}(\\varepsilon_i) $$\n接下来，我们使用相关变量加权和的方差规则展开第一项：\n$$ \\mathrm{Var}(\\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i) = \\mathrm{Var}(\\gamma_{E}\\,X_i) + \\mathrm{Var}(\\gamma_{Y}\\,y_i) + 2\\mathrm{Cov}(\\gamma_{E}\\,X_i, \\gamma_{Y}\\,y_i) $$\n对于常数 $c$ 和 $d$，使用性质 $\\mathrm{Var}(cA) = c^2\\mathrm{Var}(A)$ 和 $\\mathrm{Cov}(cA, dB) = cd\\mathrm{Cov}(A,B)$：\n$$ \\mathrm{Var}(\\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i) = \\gamma_{E}^{2}\\,\\mathrm{Var}(X_i) + \\gamma_{Y}^{2}\\,\\mathrm{Var}(y_i) + 2\\gamma_{E}\\gamma_{Y}\\mathrm{Cov}(X_i, y_i) $$\n将此结果与残差方差结合，得到完整的分解式：\n$$ \\mathrm{Var}(\\beta_i) = \\gamma_{E}^{2}\\,\\mathrm{Var}(X_i) + \\gamma_{Y}^{2}\\,\\mathrm{Var}(y_i) + 2\\gamma_{E}\\gamma_{Y}\\mathrm{Cov}(X_i, y_i) + \\mathrm{Var}(\\varepsilon_i) $$\n该表达式按要求分解了选择梯度的总方差：\n-   $\\gamma_{E}^{2}\\,\\mathrm{Var}(X_i)$ 是生态分量，源于生态驱动因子 $X_i$ 的变异。\n-   $\\gamma_{Y}^{2}\\,\\mathrm{Var}(y_i)$ 是进化分量，源于互作物种性状 $y_i$ 的变异。\n-   $2\\gamma_{E}\\gamma_{Y}\\mathrm{Cov}(X_i, y_i)$ 是生态-进化耦合项，源于生态预测变量和进化预测变量之间的统计关联。\n-   $\\mathrm{Var}(\\varepsilon_i)$ 是残差方差，代表模型未捕捉到的所有其他变异来源。\n\n此表达式即为所要求的闭式分解。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)(W_{ij} - \\bar{W}_i)}{\\bar{W}_i \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)^2} & \\gamma_{E}^{2} \\mathrm{Var}(X_i) + \\gamma_{Y}^{2} \\mathrm{Var}(y_i) + 2 \\gamma_{E} \\gamma_{Y} \\mathrm{Cov}(X_i, y_i) + \\mathrm{Var}(\\varepsilon_i)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}