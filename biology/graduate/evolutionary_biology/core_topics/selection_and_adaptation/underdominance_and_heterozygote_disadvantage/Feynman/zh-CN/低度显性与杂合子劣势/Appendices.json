{
    "hands_on_practices": [
        {
            "introduction": "理解等位基因频率如何逐代变化，是掌握微观进化核心机制的第一步。本练习提供了一个直接应用在杂合子劣势（欠显性）选择模型下，计算下一代等位基因频率 $p'$ 和频率变化 $\\Delta p$ 的机会。通过对给定的参数进行精确计算，你将亲身体验选择压力如何引导等位基因频率的演化轨迹，从而为理解更复杂的动态系统打下坚实的定量基础。",
            "id": "2760980",
            "problem": "考虑一个单基因座、双等位基因（$A$ 和 $a$）系统，存在于一个世代不重叠的大型随机交配二倍体群体中。设在生存力选择下，基因型的相对生存力为 $w_{AA}=1$、$w_{Aa}=1-s$ 和 $w_{aa}=1-r$，其中 $s>0$ 和 $r>0$ 代表杂合子劣势（欠显性）。假设选择前基因型比例符合哈代-温伯格平衡，因此，如果选择前等位基因 $A$ 的频率为 $p$，等位基因 $a$ 的频率为 $q=1-p$，则选择前基因型 $AA$、$Aa$ 和 $aa$ 的频率分别为 $p^{2}$、$2pq$ 和 $q^{2}$。\n\n仅从哈代-温伯格原理和相对适应度的生存力选择定义出发，推导选择后等位基因频率 $p'$ 作为 $p$、$s$ 和 $r$ 的函数的显式表达式。\n\n然后，使用参数值 $p=0.4$、$s=0.2$ 和 $r=0.1$，精确计算 $p'$，并通过评估 $\\Delta p = p' - p$ 的符号来确定等位基因 $A$ 的变化方向。在最终报告的答案中，提供一个包含两个条目的行矩阵：\n- $p'$ 作为有理数的精确值，以及\n- 编码的方向 $\\operatorname{sgn}(\\Delta p)\\in\\{-1,0,+1\\}$，其中 $+1$ 表示 $A$ 增加，$0$ 表示无变化，$-1$ 表示减少。\n\n不要四舍五入；将 $p'$ 精确表示为最简分数。你的最终答案必须仅包含一个行矩阵内的这两个所求量。",
            "solution": "该问题是群体遗传学中的一个标准练习题，其陈述科学合理、问题明确、客观且信息完备。因此，我们判定该题目有效，并将着手进行严格的推导。\n\n所描述的系统涉及一个具有两个等位基因 $A$ 和 $a$ 的单基因座。群体被假定为大型、二倍体并随机交配。我们从单个世代内选择前的状态开始，此时基因型比例符合哈代-温伯格原理。设等位基因 $A$ 的频率为 $p$，等位基因 $a$ 的频率为 $q = 1-p$。\n\n选择前基因型 $AA$、$Aa$ 和 $aa$ 的频率分别为 $p^{2}$、$2pq$ 和 $q^{2}$。\n\n生存力选择作用于这些基因型。相对生存力（适应度）给出为 $w_{AA}=1$、$w_{Aa}=1-s$ 和 $w_{aa}=1-r$。条件 $s>0$ 和 $r>0$ 指明杂合子 $Aa$ 的适应度低于至少一个纯合子。题目设定 $w_{AA}=1$ 和 $w_{aa}=1-r$（其中 $r>0$），这意味着 $w_{Aa} < w_{AA}$，并且如果 $1-s < 1-r$（即 $s>r>0$），则有 $w_{Aa} < w_{aa}$。如果 $s,r>0$，这就是一个欠显性（或称杂合子劣势）的情况。\n\n选择之后，每个基因型的频率与其初始频率乘以其相对适应度成正比。\n- $AA$ 的比例频率：$p^{2} w_{AA} = p^{2}(1) = p^{2}$\n- $Aa$ 的比例频率：$2pq w_{Aa} = 2pq(1-s)$\n- $aa$ 的比例频率：$q^{2} w_{aa} = q^{2}(1-r)$\n\n为了得到选择后的真实基因型频率，我们必须用这些量的总和来对它们进行归一化。这个总和是群体的平均适应度，记为 $\\bar{w}$。\n$$ \\bar{w} = p^{2} w_{AA} + 2pq w_{Aa} + q^{2} w_{aa} $$\n$$ \\bar{w} = p^{2} + 2pq(1-s) + q^{2}(1-r) $$\n\n选择后等位基因 $A$ 的频率，记为 $p'$，是选择后群体中 $AA$ 基因型频率加上 $Aa$ 基因型频率的一半。$A$ 等位基因的数量与 $2(p^{2} w_{AA}) + 1(2pq w_{Aa})$ 成正比，而等位基因总数与 $2\\bar{w}$ 成正比。因此，频率 $p'$ 为：\n$$ p' = \\frac{p^{2} w_{AA} + pq w_{Aa}}{\\bar{w}} $$\n代入给定的适应度值，我们推导出 $p'$ 作为 $p$、$s$ 和 $r$ 的函数的显式表达式：\n$$ p' = \\frac{p^{2}(1) + p(1-p)(1-s)}{p^{2}(1) + 2p(1-p)(1-s) + (1-p)^{2}(1-r)} $$\n这是在这种选择模式下，下一代等位基因频率的通用公式。\n\n现在，我们必须根据给定的参数计算 $p'$ 的数值：$p=0.4$，$s=0.2$，$r=0.1$。我们将使用精确的分数运算以避免舍入误差。\n参数如下：\n$p = 0.4 = \\frac{4}{10} = \\frac{2}{5}$\n$q = 1-p = 1 - \\frac{2}{5} = \\frac{3}{5}$\n$s = 0.2 = \\frac{2}{10} = \\frac{1}{5}$\n$r = 0.1 = \\frac{1}{10}$\n\n适应度值如下：\n$w_{AA} = 1$\n$w_{Aa} = 1-s = 1 - \\frac{1}{5} = \\frac{4}{5}$\n$w_{aa} = 1-r = 1 - \\frac{1}{10} = \\frac{9}{10}$\n\n首先，我们计算 $p'$ 表达式的分子，它代表选择后基因库中 $A$ 等位基因的总比例：\n$$ p^{2} w_{AA} + pq w_{Aa} = \\left(\\frac{2}{5}\\right)^{2}(1) + \\left(\\frac{2}{5}\\right)\\left(\\frac{3}{5}\\right)\\left(\\frac{4}{5}\\right) = \\frac{4}{25} + \\frac{24}{125} $$\n为了将这些分数相加，我们找到一个公分母，即 $125$：\n$$ \\frac{4 \\times 5}{25 \\times 5} + \\frac{24}{125} = \\frac{20}{125} + \\frac{24}{125} = \\frac{44}{125} $$\n\n接下来，我们计算平均适应度 $\\bar{w}$：\n$$ \\bar{w} = p^{2} w_{AA} + 2pq w_{Aa} + q^{2} w_{aa} $$\n$$ \\bar{w} = \\left(\\frac{2}{5}\\right)^{2}(1) + 2\\left(\\frac{2}{5}\\right)\\left(\\frac{3}{5}\\right)\\left(\\frac{4}{5}\\right) + \\left(\\frac{3}{5}\\right)^{2}\\left(\\frac{9}{10}\\right) $$\n$$ \\bar{w} = \\frac{4}{25} + \\frac{48}{125} + \\frac{9}{25}\\left(\\frac{9}{10}\\right) = \\frac{4}{25} + \\frac{48}{125} + \\frac{81}{250} $$\n$25$、$125$ 和 $250$ 的最小公倍数是 $250$。我们转换这些分数：\n$$ \\bar{w} = \\frac{4 \\times 10}{250} + \\frac{48 \\times 2}{250} + \\frac{81}{250} = \\frac{40 + 96 + 81}{250} = \\frac{217}{250} $$\n\n现在我们可以计算 $p'$：\n$$ p' = \\frac{\\frac{44}{125}}{\\frac{217}{250}} = \\frac{44}{125} \\times \\frac{250}{217} = \\frac{44 \\times 2}{217} = \\frac{88}{217} $$\n数字 $88 = 2^{3} \\times 11$。数字 $217 = 7 \\times 31$。它们没有公因数，所以这个分数是其最简形式。因此，$p' = \\frac{88}{217}$。\n\n最后，我们通过评估其符号来确定变化方向 $\\Delta p = p' - p$。\n$$ \\Delta p = p' - p = \\frac{88}{217} - \\frac{2}{5} $$\n为了进行比较，我们使用公分母 $217 \\times 5 = 1085$：\n$$ \\Delta p = \\frac{88 \\times 5}{1085} - \\frac{2 \\times 217}{1085} = \\frac{440 - 434}{1085} = \\frac{6}{1085} $$\n由于 $\\Delta p = \\frac{6}{1085} > 0$，等位基因 $A$ 的频率增加。变化的符号为正。因此，$\\operatorname{sgn}(\\Delta p) = +1$。\n\n所求的两个量是 $p'$ 的精确值和 $\\Delta p$ 的符号。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{88}{217} & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论模型中的适应度参数并非凭空而来，它们往往源于具体的生物学机制。这个练习将抽象的群体遗传学模型与经典的细胞遗传学现象——染色体相互易位——联系起来。你将需要从第一性原理出发，推导出易位杂合子因产生部分不育配子而导致的相对适应度（$w_{Aa}$），并进一步求解由此产生的非稳定平衡点（$p^*$），深刻理解进化阈值在物种形成等过程中的生物学起源。",
            "id": "2760973",
            "problem": "考虑一个大的、随机交配的、世代不重叠的种群，其单个基因座上有两个等位基因 $A$ 和 $a$。除非个体是特定相互易位的异核型，否则其细胞遗传学上是正常的。假设存在以下生物学情景。\n\n1. 易位杂合子 ($A a$) 在减数分裂时发生等频率的交替分离和邻近分离。$A a$ 成体产生的配子中，恰好有 $\\frac{1}{2}$ 的部分是平衡的，并在受精后产生能存活的合子；剩下 $\\frac{1}{2}$ 的部分是不平衡的，并产生不能存活的合子。在平衡的配子中不存在分离畸变，并且在这方面雄性和雌性的功能是等同的。\n2. 纯合子 ($A A$ 和 $a a$) 只产生平衡的配子，所有这些配子在受精后都能产生存活的合子。\n3. 所有的生存力差异仅来源于上述配子的平衡与不平衡状态；不存在额外的合子生存力选择。因此，基因型适合度的差异纯粹通过相对生育力（每个成体产生的存活合子数量）来体现。\n4. 不存在突变、迁移、自交或遗传漂变。设 $p$ 表示一代开始时合子中等位基因 $A$ 的频率，且 $q = 1 - p$。\n\n设基因型的相对适合度（生育力）分别表示为 $w_{A A}$、$w_{A a}$ 和 $w_{a a}$。按照惯例，设定 $w_{A A} = w_{a a} = 1$。\n\n任务：\n(a) 仅根据上述生物学假设，确定 $w_{A a}$ 的相对生育力值。\n(b) 在随机交配和指定的生育力选择下，从第一性原理推导 $p$ 的跨代递归式，并求解内部多态性平衡点 $p^{\\ast}$（即满足 $0 < p^{\\ast} < 1$ 的平衡点）（如果存在的话），其中 $w_{A A} = w_{a a} = 1$ 且 $w_{A a}$ 为你在 (a) 部分求得的值。\n\n提供 $w_{A a}$ 和 $p^{\\ast}$ 的精确数值答案（不要四舍五入）。你最终报告的答案必须仅包含这两个值，并按此顺序排列。",
            "solution": "首先必须验证问题陈述的科学合理性、自洽性和客观性。\n\n**步骤 1：提取已知条件**\n- 种群：大的、随机交配的、世代不重叠。\n- 基因座：单个，有两个等位基因 $A$ 和 $a$。\n- 细胞遗传学：杂合子 $Aa$ 是相互易位的异核型。\n- 来自 $Aa$ 的配子产生：比例为 $\\frac{1}{2}$ 的配子是平衡的，并产生可存活的合子。剩下的比例为 $\\frac{1}{2}$ 的配子是不平衡的，并产生不可存活的合子。平衡配子中没有分离畸变。\n- 来自纯合子 $AA$ 和 $aa$ 的配子产生：所有配子都是平衡的，并产生可存活的合子。\n- 选择：适合度差异仅源于相对生育力（每个成体产生的可存活合子数量）。没有其他合子生存力选择。\n- 进化动力：无突变、迁移、自交或遗传漂变。\n- 符号：$p$ 是合子中等位基因 $A$ 的频率。$q = 1 - p$。\n- 适合度归一化：相对适合度为 $w_{AA}$、$w_{Aa}$、$w_{aa}$，其中 $w_{AA} = w_{aa} = 1$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据充分：** 该问题描述了一个由染色体重排驱动的经典杂合子劣势模型。易位杂合子中 50% 的配子不存活是在特定分离模式（邻近-1、邻近-2 和 3:1 分离导致非整倍性）下的标准理论预期。该模型是关于染色体进化和物种形成的进化理论的基石。它是科学合理的。\n- **问题定义明确：** 问题陈述清晰，提供了推导所求量（$w_{Aa}$ 和 $p^{\\ast}$）所需的所有必要参数和假设。预期会有一个唯一解。\n- **客观性：** 语言正式且量化，没有主观或含糊的术语。\n\n**步骤 3：结论与行动**\n问题是有效的。这是理论群体遗传学中一个标准的、定义明确的问题。将提供解答。\n\n**(a) 部分：确定 $w_{Aa}$**\n\n问题指出，适合度差异完全由相对生育力决定，即每个成体产生的可存活合子的相对数量。按照惯例，纯合子的适合度设定为 $1$。\n\n设 $N$ 为一个纯合子成体产生的、能形成可存活合子的基准配子数。一个纯合的 $AA$ 或 $aa$ 个体只产生平衡配子，所有这些配子在受精后都可存活。它们对下一代的贡献与 $N$ 成正比。我们将其相对适合度定义为：\n$$w_{AA} = w_{aa} = \\frac{N}{N} = 1$$\n\n一个杂合的 $Aa$ 个体总共也产生 $N$ 个配子。然而，问题指明这些配子中只有 $\\frac{1}{2}$ 的部分是平衡的，并且能够产生可存活的合子。因此，一个杂合子产生的可存活合子数量是 $\\frac{1}{2}N$。\n\n杂合子 $w_{Aa}$ 的相对适合度是其相对于纯合子参考生育力的生育力：\n$$w_{Aa} = \\frac{\\text{Fertility of } Aa}{\\text{Fertility of } AA} = \\frac{\\frac{1}{2}N}{N} = \\frac{1}{2}$$\n因此，杂合子的相对适合度是 $w_{Aa} = \\frac{1}{2}$。\n\n**(b) 部分：$p$ 的递归式和内部平衡点 $p^{\\ast}$**\n\n我们从第一性原理推导等位基因频率的变化。设 $p$ 和 $q$ 分别为当前代合子中等位基因 $A$ 和 $a$ 的频率。在随机交配下，合子阶段的基因型频率由哈迪-温伯格比例给出：\n- AA 的频率：$p^2$\n- Aa 的频率：$2pq$\n- aa 的频率：$q^2$\n\n选择通过这些基因型的不同生育力起作用。每个基因型对下一代配子库的贡献由其相对适合度加权：$w_{AA}=1$、$w_{aa}=1$ 和 $w_{Aa}=\\frac{1}{2}$。\n\n种群的平均适合度 $\\bar{w}$ 是基因型频率乘以其适合度的总和：\n$$\\bar{w} = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa}$$\n代入具体的适合度值：\n$$\\bar{w} = p^2(1) + 2pq\\left(\\frac{1}{2}\\right) + q^2(1) = p^2 + pq + q^2$$\n我们可以使用恒等式 $p^2 + q^2 = (p+q)^2 - 2pq = 1 - 2pq$ 来简化这个表达式。\n$$\\bar{w} = (1 - 2pq) + pq = 1 - pq$$\n\n下一代中 $A$ 等位基因的频率 $p'$ 是由成体种群产生的配子库中 $A$ 等位基因的频率。$A$ 等位基因由 $AA$ 纯合子和 $Aa$ 杂合子贡献。\n$$p' = \\frac{p^2 w_{AA} + \\frac{1}{2}(2pq w_{Aa})}{\\bar{w}} = \\frac{p^2 w_{AA} + pq w_{Aa}}{\\bar{w}}$$\n这是 $p$ 的通用递归式。\n\n将具体的适合度值代入递归式：\n$$p' = \\frac{p^2(1) + pq\\left(\\frac{1}{2}\\right)}{1 - pq} = \\frac{p^2 + \\frac{1}{2}pq}{1 - pq}$$\n\n当等位基因频率在代际间不发生变化时，即 $p' = p$ 时，存在平衡。我们寻求内部多态性平衡点 $p^{\\ast}$，其中 $0 < p^{\\ast} < 1$。\n$$p = \\frac{p^2 + \\frac{1}{2}pq}{1 - pq}$$\n由于在内部平衡点处 $p \\neq 0$，我们可以将等式两边同时除以 $p$：\n$$1 = \\frac{p + \\frac{1}{2}q}{1 - pq}$$\n$$1 - pq = p + \\frac{1}{2}q$$\n为了解出 $p$，我们代入 $q = 1 - p$：\n$$1 - p(1 - p) = p + \\frac{1}{2}(1 - p)$$\n$$1 - p + p^2 = p + \\frac{1}{2} - \\frac{1}{2}p$$\n$$1 - p + p^2 = \\frac{1}{2}p + \\frac{1}{2}$$\n重新整理各项，得到一个标准的二次方程 $ax^2+bx+c=0$：\n$$p^2 - p - \\frac{1}{2}p + 1 - \\frac{1}{2} = 0$$\n$$p^2 - \\frac{3}{2}p + \\frac{1}{2} = 0$$\n为了消去分数，我们将整个方程乘以 $2$：\n$$2p^2 - 3p + 1 = 0$$\n这个二次方程可以因式分解为：\n$$(2p - 1)(p - 1) = 0$$\n解为 $p = \\frac{1}{2}$ 和 $p = 1$。解 $p=1$ 代表等位基因 $A$ 的固定，这是一个平凡（边界）平衡点。内部多态性平衡点是另一个解。\n\n因此，内部平衡等位基因频率为 $p^{\\ast} = \\frac{1}{2}$。这是一个不稳定的平衡点，是杂合子劣势的特征，选择将根据初始频率将等位基因频率从该点推向 $0$ 或 $1$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "群体遗传学研究的关键一环是连接理论模型与经验数据。本练习将让你扮演一名进化生物学家的角色，利用从两个生命阶段（合子与成体）观测到的基因型计数数据，来估计潜在的相对适应度值 $(\\hat{w}_{AA}, \\hat{w}_{Aa}, \\hat{w}_{aa})$。通过运用最大似然估计（Maximum Likelihood Estimation, MLE）这一强大的统计方法，你将学会如何从实际观测中量化选择压力，并诊断欠显性选择的存在，从而架起理论与实践之间的桥梁。",
            "id": "2761005",
            "problem": "一个大型、随机交配的二倍体种群，在单个常染色体基因座上携带两个等位基因 $A$ 和 $a$。在 $A$ 的等位基因频率为 $p$ 的条件下，合子根据 Hardy–Weinberg 平衡形成，因此选择前的基因型频率对于 $AA$ 是 $p^{2}$，对于 $Aa$ 是 $2p(1-p)$，对于 $aa$ 是 $(1-p)^{2}$。在合子到成体的阶段之间，生存力选择起作用，其特定基因型的相对生存力 $w_{AA}$、$w_{Aa}$ 和 $w_{aa}$ 通过一个共同的、未知的乘法常数来缩放绝对存活概率。您在两个连续的生命阶段观察到以下基因型计数：\n\n- 合子（选择前）：$n_{AA}^{(0)} = 500$，$n_{Aa}^{(0)} = 1000$，$n_{aa}^{(0)} = 500$。\n- 成体（选择后存活者）：$n_{AA}^{(1)} = 175$，$n_{Aa}^{(1)} = 100$，$n_{aa}^{(1)} = 125$。\n\n假设在给定合子计数的条件下，每个基因型的成体存活者是通过独立的 Bernoulli 存活过程产生的，其特定基因型的绝对存活概率为 $s_{g}$，其中 $g \\in \\{AA, Aa, aa\\}$。并且，$s_{g} = c\\, w_{g}$，其中 $c$ 是一个未知的正常数，将绝对存活与相对生存力联系起来。将合子计数视为在等位基因频率为 $p$ 的情况下根据 Hardy–Weinberg 平衡产生的，并从合子计数中通过其最大似然估计（MLE）来估计 $p$。\n\n从这些建模假设出发，不使用任何预先推导的选择公式，写出给定合子计数和存活概率下成体计数的似然函数，推导出 $\\hat{s}_{g}$ 的最大似然估计，然后在合子阶段平均相对生存力等于 $1$ 的可识别性约束下，推导出相对生存力 $\\hat{w}_{g}$ 的最大似然估计，即\n$$\np^{2} w_{AA} + 2p(1-p) w_{Aa} + (1-p)^{2} w_{aa} = 1.\n$$\n最后，在给定数据集上评估您的估计量，并以精确分数形式报告三元组 $(\\hat{w}_{AA}, \\hat{w}_{Aa}, \\hat{w}_{aa})$。以单行矩阵的形式提供您的最终数值答案。",
            "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n**步骤 1：提取已知条件**\n- 种群模型：大型、随机交配、二倍体、单个常染色体基因座，有两个等位基因 $A$ 和 $a$。\n- $A$ 的等位基因频率：$p$。\n- 合子基因型频率 (Hardy–Weinberg 平衡)：$f_{AA}^{(0)} = p^{2}$，$f_{Aa}^{(0)} = 2p(1-p)$，$f_{aa}^{(0)} = (1-p)^{2}$。\n- 选择模型：在合子与成体阶段之间发生生存力选择。\n- 相对生存力：$w_{AA}$，$w_{Aa}$，$w_{aa}$。\n- 绝对存活概率：$s_{g} = c\\, w_{g}$，其中 $g \\in \\{AA, Aa, aa\\}$，且 $c>0$ 是某个未知常数。\n- 合子计数（选择前）：$n_{AA}^{(0)} = 500$，$n_{Aa}^{(0)} = 1000$，$n_{aa}^{(0)} = 500$。\n- 成体计数（选择后）：$n_{AA}^{(1)} = 175$，$n_{Aa}^{(1)} = 100$，$n_{aa}^{(1)} = 125$。\n- 统计模型：成体存活者由概率为 $s_g$ 的独立 Bernoulli 试验生成。\n- 估计任务：求 $p$、$s_g$ 和 $w_g$ 的最大似然估计（MLE）。\n- 可识别性约束：由合子基因型频率加权的平均相对生存力为 $1$。这表示为 $p^{2} w_{AA} + 2p(1-p) w_{Aa} + (1-p)^{2} w_{aa} = 1$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了包括 Hardy-Weinberg 平衡和生存力选择在内的标准群体遗传学模型。最大似然估计的使用是适用于此背景的基本统计方法。该问题是适定的：它提供了所有必要的数据、一个清晰的模型和一个特定的约束，以确保相对生存力有一个唯一的解，否则相对生存力只能确定到一个乘法常数的范围内。数据是内部一致的（例如，对于所有基因型 $g$，$n_g^{(1)} \\le n_g^{(0)}$）。没有事实错误、歧义或逻辑矛盾。该问题是统计群体遗传学中的一个标准的、非平凡的练习。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将推导完整解法。\n\n目标是从提供的队列数据中估计相对生存力 $(\\hat{w}_{AA}, \\hat{w}_{Aa}, \\hat{w}_{aa})$。\n\n首先，我们从合子计数中估计等位基因频率 $p$。对于一个二倍体个体的样本，等位基因频率的最大似然估计（MLE）是其在样本中的观测比例。\n合子总数为 $N^{(0)} = n_{AA}^{(0)} + n_{Aa}^{(0)} + n_{aa}^{(0)} = 500 + 1000 + 500 = 2000$。\n合子样本中 $A$ 等位基因的数量为 $2n_{AA}^{(0)} + n_{Aa}^{(0)}$。等位基因总数为 $2N^{(0)}$。\n$p$ 的 MLE 是：\n$$\n\\hat{p} = \\frac{2n_{AA}^{(0)} + n_{Aa}^{(0)}}{2(n_{AA}^{(0)} + n_{Aa}^{(0)} + n_{aa}^{(0)})} = \\frac{2(500) + 1000}{2(2000)} = \\frac{2000}{4000} = \\frac{1}{2}\n$$\n当 $\\hat{p} = 1/2$ 时，期望的 Hardy-Weinberg 基因型频率为 $\\hat{p}^{2} = 1/4$，$2\\hat{p}(1-\\hat{p}) = 1/2$ 和 $(1-\\hat{p})^{2} = 1/4$。合子样本中的观测频率为 $n_{AA}^{(0)}/N^{(0)} = 500/2000 = 1/4$，$n_{Aa}^{(0)}/N^{(0)} = 1000/2000 = 1/2$ 和 $n_{aa}^{(0)}/N^{(0)} = 500/2000 = 1/4$。数据完全符合 $\\hat{p} = 1/2$ 时的 Hardy-Weinberg 比例。\n\n接下来，我们推导绝对存活概率 $s_g$ 的 MLE。对于每个基因型 $g$，我们观察到初始的 $n_g^{(0)}$ 个个体中有 $n_g^{(1)}$ 个存活下来。这是一个二项过程。在给定合子计数和存活概率 $\\{s_{AA}, s_{Aa}, s_{aa}\\}$ 的条件下，观察到成体计数的似然是每个基因型似然的乘积，因为它们是独立的：\n$$\nL(s_{AA}, s_{Aa}, s_{aa}) = \\prod_{g \\in \\{AA, Aa, aa\\}} \\binom{n_g^{(0)}}{n_g^{(1)}} s_g^{n_g^{(1)}} (1-s_g)^{n_g^{(0)}-n_g^{(1)}}\n$$\n为了最大化这个似然，我们使用对数似然函数 $\\ell = \\ln(L)$：\n$$\n\\ell = \\sum_{g} \\left[ \\ln\\binom{n_g^{(0)}}{n_g^{(1)}} + n_g^{(1)}\\ln(s_g) + (n_g^{(0)}-n_g^{(1)})\\ln(1-s_g) \\right]\n$$\n在这个函数中，参数 $s_g$ 是相互独立的。我们通过对 $s_g$ 求偏导并令其为零来找到 MLE $\\hat{s}_g$：\n$$\n\\frac{\\partial \\ell}{\\partial s_g} = \\frac{n_g^{(1)}}{s_g} - \\frac{n_g^{(0)}-n_g^{(1)}}{1-s_g} = 0\n$$\n求解 $s_g$ 得到 MLE：\n$$\n\\hat{s}_g = \\frac{n_g^{(1)}}{n_g^{(0)}}\n$$\n这是每个基因型存活者的观测比例。\n\n使用给定数据，我们计算这些 MLE：\n$$\n\\hat{s}_{AA} = \\frac{n_{AA}^{(1)}}{n_{AA}^{(0)}} = \\frac{175}{500} = \\frac{7}{20}\n$$\n$$\n\\hat{s}_{Aa} = \\frac{n_{Aa}^{(1)}}{n_{Aa}^{(0)}} = \\frac{100}{1000} = \\frac{1}{10}\n$$\n$$\n\\hat{s}_{aa} = \\frac{n_{aa}^{(1)}}{n_{aa}^{(0)}} = \\frac{125}{500} = \\frac{1}{4}\n$$\n\n最后，我们推导相对生存力 $w_g$ 的 MLE。我们已知关系式 $s_g = c \\, w_g$ 和约束条件 $p^{2} w_{AA} + 2p(1-p) w_{Aa} + (1-p)^{2} w_{aa} = 1$。左边的表达式是平均相对生存力，我们称之为 $\\bar{w}$。约束条件为 $\\bar{w}=1$。\n根据 MLE 的不变性，我们有 $\\hat{s}_g = \\hat{c} \\, \\hat{w}_g$。这意味着相对生存力估计量与绝对存活估计量成正比，即 $\\hat{w}_g \\propto \\hat{s}_g$。\n将约束条件应用于我们的估计量，得到：\n$$\n\\hat{p}^{2} \\hat{w}_{AA} + 2\\hat{p}(1-\\hat{p}) \\hat{w}_{Aa} + (1-\\hat{p})^{2} \\hat{w}_{aa} = 1\n$$\n代入 $\\hat{w}_g = k\\,\\hat{s}_g$（其中 $k$ 为某个归一化常数）：\n$$\nk \\left( \\hat{p}^{2} \\hat{s}_{AA} + 2\\hat{p}(1-\\hat{p}) \\hat{s}_{Aa} + (1-\\hat{p})^{2} \\hat{s}_{aa} \\right) = 1\n$$\n括号中的项是由估计的合子基因型频率加权的估计平均绝对存活率 $\\hat{\\bar{s}}$。\n$$\n\\hat{\\bar{s}} = \\hat{p}^{2} \\hat{s}_{AA} + 2\\hat{p}(1-\\hat{p}) \\hat{s}_{Aa} + (1-\\hat{p})^{2} \\hat{s}_{aa}\n$$\n因此，$k = 1/\\hat{\\bar{s}}$，并且每个相对生存力的 MLE 为：\n$$\n\\hat{w}_g = \\frac{\\hat{s}_g}{\\hat{\\bar{s}}}\n$$\n我们可以直接计算 $\\hat{\\bar{s}}$。由于观测到的合子基因型频率 $f_g^{(0)} = n_g^{(0)}/N^{(0)}$ 与从 $\\hat{p}$ 计算出的 HWE 频率相匹配，我们可以写出：\n$$\n\\hat{\\bar{s}} = \\sum_g f_g^{(0)} \\hat{s}_g = \\sum_g \\frac{n_g^{(0)}}{N^{(0)}} \\frac{n_g^{(1)}}{n_g^{(0)}} = \\sum_g \\frac{n_g^{(1)}}{N^{(0)}} = \\frac{N^{(1)}}{N^{(0)}}\n$$\n其中 $N^{(1)} = n_{AA}^{(1)} + n_{Aa}^{(1)} + n_{aa}^{(1)}$ 是成体总数。\n我们从数据中计算 $N^{(1)}$：\n$$\nN^{(1)} = 175 + 100 + 125 = 400\n$$\n现在我们可以计算估计的平均绝对存活率：\n$$\n\\hat{\\bar{s}} = \\frac{N^{(1)}}{N^{(0)}} = \\frac{400}{2000} = \\frac{1}{5}\n$$\n最后，我们计算相对生存力的 MLE：\n$$\n\\hat{w}_{AA} = \\frac{\\hat{s}_{AA}}{\\hat{\\bar{s}}} = \\frac{7/20}{1/5} = \\frac{7}{20} \\times 5 = \\frac{7}{4}\n$$\n$$\n\\hat{w}_{Aa} = \\frac{\\hat{s}_{Aa}}{\\hat{\\bar{s}}} = \\frac{1/10}{1/5} = \\frac{1}{10} \\times 5 = \\frac{1}{2}\n$$\n$$\n\\hat{w}_{aa} = \\frac{\\hat{s}_{aa}}{\\hat{\\bar{s}}} = \\frac{1/4}{1/5} = \\frac{1}{4} \\times 5 = \\frac{5}{4}\n$$\n估计的相对生存力为 $(\\hat{w}_{AA}, \\hat{w}_{Aa}, \\hat{w}_{aa}) = (7/4, 1/2, 5/4)$。这是一个劣势杂合，即杂合子劣势的情况，因为杂合子的生存力低于两种纯合子。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{7}{4} & \\frac{1}{2} & \\frac{5}{4}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}