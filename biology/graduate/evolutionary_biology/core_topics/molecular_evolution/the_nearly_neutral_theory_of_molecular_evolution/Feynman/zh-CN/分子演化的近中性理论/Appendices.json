{
    "hands_on_practices": [
        {
            "introduction": "近中性演化理论的核心在于区分随机遗传漂变和自然选择的相对强度，但这个界限在哪里？这个练习将指导你从群体遗传学的第一性原理出发，通过对Kimura的固定概率公式进行数学推导，来量化划分这两个演化力主导区域的关键阈值 。掌握这个过程对于深刻理解近中性突变的定义及其对有效种群大小 $N_e$ 的依赖性至关重要。",
            "id": "2758881",
            "problem": "在分子进化的近中性理论中，一个在有效群体大小为 $N_e$、选择系数为 $s$ 的二倍体 Wright–Fisher 群体中新出现的突变，如果在其演化轨迹中随机遗传漂变主导了选择，以至于其固定概率在关于 $s$ 的主导阶上近似于中性值，则该突变被称为“有效中性”的。考虑一个以单拷贝形式引入的半显性突变，因此其初始频率为 $x_0 = \\frac{1}{2N_e}$。请使用一个经过充分检验的、关于选择作用下新突变固定概率的扩散近似表达式，并通过在 $s=0$ 附近进行小 $|s|$ 展开，来确定有效中性的主导阶条件。然后，由此推导出阈值大小 $s_{\\star}(N_e)$，使得当 $|s| < s_{\\star}(N_e)$ 时突变是有效中性的。\n\n计算当 $N_e = 10^4$ 和 $N_e = 10^6$ 时 $s_{\\star}(N_e)$ 的值。以科学记数法将你的最终数值答案表示为行矩阵 $\\begin{pmatrix} s_{\\star}(10^4) & s_{\\star}(10^6) \\end{pmatrix}$。无需四舍五入。计算出阈值后，简要解释对于典型的蛋白质编码突变，有效中性类别如何随 $N_e$ 变化的生物学意义。最终数值答案中不要包含单位。",
            "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 模型：二倍体 Wright–Fisher 群体。\n- 有效群体大小：$N_e$。\n- 选择系数：$s$。\n- 突变类型：半显性。\n- 初始条件：单拷贝，初始频率 $x_0 = \\frac{1}{2N_e}$。\n- “有效中性”的定义：随机遗传漂变主导选择，且固定概率在关于 $s$ 的主导阶上近似于中性值。\n- 要求方法：使用固定概率的扩散近似表达式，并在 $s=0$ 附近进行小 $|s|$ 展开。\n- 交付成果：\n    1.  关于 $s$ 的有效中性主导阶条件。\n    2.  阈值大小 $s_{\\star}(N_e)$。\n    3.  计算当 $N_e = 10^4$ 和 $N_e = 10^6$ 时 $s_{\\star}(N_e)$ 的值。\n    4.  对生物学意义的简要解释。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在根本上是合理的。它基于群体遗传学的标准理论框架，使用了 Wright-Fisher 模型、扩散近似和分子进化的近中性理论，这些都是公认的原理。\n- **良定性**：该问题是良定的。它要求应用一个标准公式（Kimura 的固定概率）和一种标准数学技巧（泰勒级数展开）来推导一个特定的量。输入被明确定义，并且预期会有一个唯一的解。\n- **客观性**：该问题以精确、客观且无歧义的科学语言陈述。\n\n**步骤 3：结论与操作**\n- **结论**：问题有效。这是理论群体遗传学中一个标准的、有一定难度的练习。\n- **操作**：继续提供完整解答。\n\n**解题推导**\n\n在一个有效大小为 $N_e$ 的二倍体群体中，对于一个初始频率为 $x_0$、选择系数为 $s$ 的新突变，在基因选择（半显性）模型下，其固定概率 $\\Pi(x_0, s)$ 由 Kimura 的扩散近似公式给出：\n$$ \\Pi(x_0, s) = \\frac{\\int_0^{x_0} \\exp(-4 N_e s y) \\, dy}{\\int_0^1 \\exp(-4 N_e s y) \\, dy} $$\n这些积分是初等的。分子计算结果为：\n$$ \\int_0^{x_0} \\exp(-4 N_e s y) \\, dy = \\left[ -\\frac{1}{4 N_e s} \\exp(-4 N_e s y) \\right]_0^{x_0} = \\frac{1 - \\exp(-4 N_e s x_0)}{4 N_e s} $$\n分母计算结果为：\n$$ \\int_0^1 \\exp(-4 N_e s y) \\, dy = \\frac{1 - \\exp(-4 N_e s)}{4 N_e s} $$\n因此，固定概率为以下比率：\n$$ \\Pi(x_0, s) = \\frac{1 - \\exp(-4 N_e s x_0)}{1 - \\exp(-4 N_e s)} $$\n问题指明新突变是以单拷贝形式引入的，因此其初始频率为 $x_0 = \\frac{1}{2N_e}$。将此代入方程，得到固定概率作为 $s$ 和 $N_e$ 的函数：\n$$ \\Pi(s) = \\frac{1 - \\exp\\left(-4 N_e s \\frac{1}{2N_e}\\right)}{1 - \\exp(-4 N_e s)} = \\frac{1 - \\exp(-2s)}{1 - \\exp(-4 N_e s)} $$\n为了确定有效中性的条件，我们首先通过取 $s \\to 0$ 的极限来求中性固定概率 $\\Pi_0$：\n$$ \\Pi_0 = \\lim_{s \\to 0} \\Pi(s) = \\lim_{s \\to 0} \\frac{1 - \\exp(-2s)}{1 - \\exp(-4 N_e s)} $$\n对于小的 $z$，使用一阶泰勒展开 $\\exp(z) \\approx 1 + z$，我们得到：\n$$ \\Pi_0 = \\lim_{s \\to 0} \\frac{1 - (1 - 2s)}{1 - (1 - 4 N_e s)} = \\lim_{s \\to 0} \\frac{2s}{4 N_e s} = \\frac{1}{2N_e} $$\n这证实了一个已知的结果：中性等位基因的固定概率等于其初始频率。\n\n接下来，我们将 $\\Pi(s)$ 在 $s=0$ 附近展开为泰勒级数，以找到由选择引起的主导阶修正。我们需要分子和分母中最高到 $O(s^2)$ 的项，以求得商的 $O(s)$ 项。\n$$ 1 - \\exp(-2s) = 1 - \\left(1 - 2s + \\frac{(-2s)^2}{2} + O(s^3)\\right) = 2s - 2s^2 + O(s^3) $$\n$$ 1 - \\exp(-4N_e s) = 1 - \\left(1 - 4N_e s + \\frac{(-4N_e s)^2}{2} + O(s^3)\\right) = 4N_e s - 8(N_e s)^2 + O(s^3) $$\n那么，固定概率为：\n$$ \\Pi(s) = \\frac{2s - 2s^2 + O(s^3)}{4N_e s - 8(N_e s)^2 + O(s^3)} = \\frac{2s(1 - s + O(s^2))}{4N_e s(1 - 2N_e s + O(s^2))} = \\frac{1-s}{2N_e(1 - 2N_e s)} + O(s^2) $$\n对于小的 $z$，使用几何级数展开 $(1-z)^{-1} \\approx 1+z$：\n$$ \\Pi(s) \\approx \\frac{1-s}{2N_e}(1 + 2N_e s) = \\frac{1}{2N_e}(1 - s + 2N_e s - 2N_e s^2) = \\frac{1}{2N_e} + \\frac{2N_e-1}{2N_e}s - s^2 $$\n在一阶 $s$ 上，表达式为：\n$$ \\Pi(s) \\approx \\frac{1}{2N_e} + \\left(1 - \\frac{1}{2N_e}\\right)s $$\n问题将“有效中性”定义为随机遗传漂变主导选择的区域，使得固定概率近似于中性值。这转化为由选择引起的一阶修正项的量级小于或等于中性固定概率本身的条件。\n$$ \\left| \\left(1 - \\frac{1}{2N_e}\\right)s \\right| \\lesssim \\frac{1}{2N_e} $$\n对于任何符合生物学现实的群体大小，$N_e \\gg 1$，因此 $(1 - \\frac{1}{2N_e}) \\approx 1$。该条件简化为：\n$$ |s| \\lesssim \\frac{1}{2N_e} $$\n这就是有效中性的主导阶条件。阈值大小 $s_{\\star}(N_e)$ 是这两个量相等时的值。\n$$ s_{\\star}(N_e) = \\frac{1}{2N_e} $$\n因此，如果一个突变满足 $|s| < s_{\\star}(N_e)$，它就被认为是有效中性的。这等同于广泛使用的条件 $|2N_e s| < 1$。\n\n**数值计算**\n我们对给定的 $N_e$ 值计算 $s_{\\star}(N_e)$。\n当 $N_e = 10^4$ 时：\n$$ s_{\\star}(10^4) = \\frac{1}{2 \\times 10^4} = 5 \\times 10^{-5} $$\n当 $N_e = 10^6$ 时：\n$$ s_{\\star}(10^6) = \\frac{1}{2 \\times 10^6} = 5 \\times 10^{-7} $$\n\n**生物学意义**\n有效中性的阈值 $s_{\\star}(N_e) = \\frac{1}{2N_e}$ 与有效群体大小成反比。这种关系是近中性理论的核心，对分子进化具有深远的影响。在较小的群体中（较小的 $N_e$），阈值 $s_{\\star}$ 更高。这意味着更广范围的突变，包括那些具有显著适应度效应的突变（例如 $|s| \\approx 10^{-4}$），其行为也如同中性突变，因为随机遗传漂变的随机波动足以压倒选择的定向力。因此，在小群体中，轻微有害的突变更容易通过偶然机会被固定下来。\n\n相反，在较大的群体中（较大的 $N_e$），阈值 $s_{\\star}$ 要低得多。选择成为一种更强大、更具辨别力的进化力量，能够作用于适应度效应非常微小的突变。在一个 $N_e = 10^6$ 的群体中，一个 $s = -10^{-5}$ 的突变会受到强烈的负选择（因为 $|s| \\gg s_{\\star} = 5 \\times 10^{-7}$），而在一个 $N_e = 10^4$ 的群体中，它却是有效中性的（因为 $|s| < s_{\\star} = 5 \\times 10^{-5}$）。因此，大群体在清除轻微有害突变和固定轻微有利突变方面效率更高。这引出了一个预测：历史上有效群体规模较大的生物（例如许多原核生物和无脊椎动物）与有效群体规模较小的生物（例如许多脊椎动物）相比，应表现出更高水平的适应性进化，并拥有更精简的基因组，因为在后者中，轻微有害突变的固定更为常见。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5 \\times 10^{-5} & 5 \\times 10^{-7}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论的威力体现在其预测能力上。在建立了近中性选择的理论阈值后，本练习提供了一个具体的计算场景，让你亲手验证该理论的核心预测：一个具有固定选择系数 $s$ 的突变，其最终命运会如何因种群大小 $N_e$ 的不同而发生巨大变化 。通过这个实践，你将具体看到选择在不同规模的种群中效率的差异，从而将抽象的 $|2N_e s|$ 准则与可量化的结果联系起来。",
            "id": "2758906",
            "problem": "一个大的、随机交配的二倍体种群遵循经典的 Wright–Fisher 模型，并伴有基因选择（无显性）。考虑一个以单个拷贝形式出现的新突变，因此其初始频率为 $x_0 = 1/(2N_e)$。该突变等位基因在杂合子中的相对适应度优势为 $1 + s$，在纯合子中为 $1 + 2s$，这对应于选择系数为 $s$ 的基因选择，并以等位基因数目的加性方式作用。假设在二倍体种群中，对于基因选择，使用标准漂移项和扩散项的扩散近似成立。\n\n从 Wright–Fisher 扩散下具有漂移 $m(x)$ 和扩散方差 $v(x)$ 的固定概率 $u(x)$ 的后向 Kolmogorov 方程出发，推导新突变的固定概率 $u(x_0)$，然后在两种情况下（$N_e = 10^{6}$ 和 $N_e = 10^{4}$）针对参数值 $s = -10^{-6}$ 对其进行求值。比较这两个值，并在分子进化的近中性理论的概念框架下解释结果。\n\n将每个固定概率表示为一个无量纲数，四舍五入到三位有效数字，并使用科学记数法。将你的最终答案报告为一个有序对，其中第一个条目对应于 $N_e = 10^{6}$，第二个条目对应于 $N_e = 10^{4}$。",
            "solution": "本问题要求在带有基因选择的 Wright-Fisher 模型的扩散近似下，推导并评估一个新突变的固定概率。分析将分三个阶段进行：首先，推导固定概率的通用公式；其次，根据指定参数计算此概率；第三，在分子进化的近中性理论框架内解释结果。\n\n等位基因频率 $x$ 的演化动力学可以用一维扩散过程来描述。对于当前频率为 $x$ 的等位基因，其最终固定概率 $u(x)$ 由后向 Kolmogorov 方程决定：\n$$ m(x) \\frac{du}{dx} + \\frac{1}{2} v(x) \\frac{d^2u}{dx^2} = 0 $$\n固定问题的边界条件是 $u(0)=0$ 和 $u(1)=1$，因为频率为 $0$ 的等位基因已丢失（固定概率为 $0$），而频率为 $1$ 的等位基因已固定（固定概率为 $1$）。\n\n在有效种群大小为 $N_e$ 的二倍体种群的 Wright-Fisher 模型中，漂移系数 $m(x)$ 和扩散方差系数 $v(x)$ 由每代等位基因频率变化的均值和方差给出。对于选择系数为 $s$（代表突变等位基因在杂合状态下的适应度优势）的基因选择，这些系数为：\n$$ m(x) = s x(1-x) $$\n$$ v(x) = \\frac{x(1-x)}{2N_e} $$\n将这些表达式代入后向 Kolmogorov 方程，得到：\n$$ s x(1-x) \\frac{du}{dx} + \\frac{1}{2} \\left( \\frac{x(1-x)}{2N_e} \\right) \\frac{d^2u}{dx^2} = 0 $$\n对于等位基因频率 $x \\in (0, 1)$，我们可以除以公因子 $x(1-x)$：\n$$ s \\frac{du}{dx} + \\frac{1}{4N_e} \\frac{d^2u}{dx^2} = 0 $$\n这是一个关于函数 $p(x) = \\frac{du}{dx}$ 的二阶线性常系数常微分方程。我们将其写作：\n$$ \\frac{d p(x)}{dx} + (4N_e s) p(x) = 0 $$\n这是一个一阶可分离方程，其解为：\n$$ p(x) = C_1 \\exp(-4N_e s x) $$\n其中 $C_1$ 是一个积分常数。由于 $p(x) = \\frac{du}{dx}$，我们对 $x$ 积分以求得 $u(x)$：\n$$ u(x) = \\int p(y) dy = C_1 \\int \\exp(-4N_e s y) dy = C_1 \\left( \\frac{\\exp(-4N_e s x)}{-4N_e s} \\right) + C_2 $$\n为确定常数 $C_1$ 和 $C_2$，我们应用边界条件。使用定积分更为直接。\n$$ u(x) = \\int_0^x \\frac{du}{dy} dy + u(0) $$\n使用 $u(0)=0$ 和 $\\frac{du}{dy} = C_1 \\exp(-4N_e s y)$:\n$$ u(x) = C_1 \\int_0^x \\exp(-4N_e s y) dy $$\n现在，应用第二个边界条件 $u(1)=1$:\n$$ 1 = C_1 \\int_0^1 \\exp(-4N_e s y) dy $$\n这使我们能够解出 $C_1$:\n$$ C_1 = \\frac{1}{\\int_0^1 \\exp(-4N_e s y) dy} $$\n将 $C_1$ 代回到 $u(x)$ 的表达式中，我们得到固定概率的通解，这是 Kimura 首次推导出的结果：\n$$ u(x) = \\frac{\\int_0^x \\exp(-4N_e s y) dy}{\\int_0^1 \\exp(-4N_e s y) dy} $$\n积分的计算结果为：\n$$ \\int_0^z \\exp(-4N_e s y) dy = \\left[ -\\frac{1}{4N_e s} \\exp(-4N_e s y) \\right]_0^z = \\frac{1 - \\exp(-4N_e s z)}{4N_e s} $$\n因此，固定概率简化为：\n$$ u(x) = \\frac{1 - \\exp(-4N_e s x)}{1 - \\exp(-4N_e s)} $$\n问题考虑的是一个在种群中以单个拷贝形式出现的新突变。因此，初始频率为 $x_0 = \\frac{1}{2N_e}$。将此代入我们推导的公式中，得到新突变的固定概率：\n$$ u(x_0) = u\\left(\\frac{1}{2N_e}\\right) = \\frac{1 - \\exp\\left(-4N_e s \\frac{1}{2N_e}\\right)}{1 - \\exp(-4N_e s)} = \\frac{1 - \\exp(-2s)}{1 - \\exp(-4N_e s)} $$\n我们现在根据给定的参数计算这个表达式的值。选择系数为 $s = -10^{-6}$。\n\n情况1：$N_e = 10^6$。\n固定概率为：\n$$ u_1 = \\frac{1 - \\exp(-2 \\times (-10^{-6}))}{1 - \\exp(-4 \\times 10^6 \\times (-10^{-6}))} = \\frac{1 - \\exp(2 \\times 10^{-6})}{1 - \\exp(4)} $$\n使用计算器以确保精度：\n$$ u_1 \\approx \\frac{1 - 1.000002000002}{1 - 54.598150} = \\frac{-2.000002 \\times 10^{-6}}{-53.598150} \\approx 3.73148 \\times 10^{-8} $$\n四舍五入到三位有效数字，结果为 $3.73 \\times 10^{-8}$。\n\n情况2：$N_e = 10^4$。\n固定概率为：\n$$ u_2 = \\frac{1 - \\exp(-2 \\times (-10^{-6}))}{1 - \\exp(-4 \\times 10^4 \\times (-10^{-6}))} = \\frac{1 - \\exp(2 \\times 10^{-6})}{1 - \\exp(0.04)} $$\n使用计算器：\n$$ u_2 \\approx \\frac{1 - 1.000002000002}{1 - 1.04081077} = \\frac{-2.000002 \\times 10^{-6}}{-0.04081077} \\approx 4.90070 \\times 10^{-5} $$\n四舍五入到三位有效数字，结果为 $4.90 \\times 10^{-5}$。\n\n最后，我们解释这些结果。较小种群中的固定概率（$u_2 \\approx 4.90 \\times 10^{-5}$）显著大于较大种群中的固定概率（$u_1 \\approx 3.73 \\times 10^{-8}$）。这一现象是分子进化近中性理论的一个核心预测。该理论指出，具有小选择系数的突变的演化命运由复合参数 $N_e s$ 决定，该参数衡量了选择相对于遗传漂变的力量。临界阈值通常被认为是 $|2N_e s| \\approx 1$。\n\n在情况1中（$N_e = 10^6$），该参数为 $|2N_e s| = |2 \\times 10^6 \\times (-10^{-6})| = 2$。由于该值大于 $1$，自然选择足够强大以有效发挥作用。由于突变是有害的（$s < 0$），它被有效地从种群中清除，导致极低的固定概率，远低于中性期望值 $x_0 = \\frac{1}{2N_e} = \\frac{1}{2 \\times 10^6} = 5 \\times 10^{-7}$。\n\n在情况2中（$N_e = 10^4$），该参数为 $|2N_e s| = |2 \\times 10^4 \\times (-10^{-6})| = 0.02$。由于该值远小于 $1$，随机遗传漂变的力量压倒了微弱的选择压力。该突变表现得好像它是有效中性的。严格中性等位基因的固定概率是其初始频率 $x_0 = \\frac{1}{2N_e} = \\frac{1}{2 \\times 10^4} = 5 \\times 10^{-5}$。我们计算出的值 $u_2 \\approx 4.90 \\times 10^{-5}$ 与这个中性期望值非常接近。微弱的有害效应几乎完全被漂变所掩盖。\n\n总之，对于一个固定的有害选择系数，较小的种群规模会使选择的效果减弱，从而允许等位基因以接近中性速率的概率漂变至固定。相反，在大的种群中，同一个等位基因会受到有效的负选择，从而极大地降低其固定的机会。这展示了对于近中性突变，选择性演化和中性演化之间存在一个依赖于种群大小的边界。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.73 \\times 10^{-8} & 4.90 \\times 10^{-5}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在真实的生物世界中，新突变并非具有单一的适应度效应，而是呈现出一个适应度效应分布（Distribution of Fitness Effects, DFE）。这个高级练习将引导你从处理单个突变过渡到分析整个突变谱，这是一个更接近现代基因组学研究的真实情景 。你将学习如何将近中性理论操作化，通过对给定的DFE进行积分，来计算在特定种群规模下被视为“近中性”的突变所占的比例，这是连接理论模型与经验数据分析的关键一步。",
            "id": "2758951",
            "problem": "要求您为一个有害适应性效应分布（DFE）操作化分子进化近中性学说中的一个核心量。在一个有效种群大小为 $N_e$ 的单倍体或加性二倍体 Wright–Fisher 模型环境中进行研究，其中一个新突变以 $1/(2N_e)$ 的初始频率出现。假设以下基本事实：\n\n1. 在一个恒定种群中，于 Wright–Fisher 动态下，一个具有选择系数 $s$ 的新突变的固定概率是扩散理论中一个经过充分检验的结果。其关于 $s=0$ 的泰勒展开表明，中性基准固定概率为 $1/(2N_e)$，并且当 $|2N_e s|$ 很小时，选择是弱的。\n\n2. 有害 DFE 通过一个伽马分布来建模，该分布描述了绝对适应性效应的大小 $X$。其中 $X \\sim \\mathrm{Gamma}(k,\\theta)$，形状参数 $k>0$，尺度参数 $\\theta>0$。选择系数为 $s=-X \\le 0$。$s$ 的均值等于 $\\bar{s}=-k\\theta<0$。因此，给定 $k$ 和 $\\bar{s}<0$，尺度参数为 $\\theta=-\\bar{s}/k>0$。\n\n将近中性分数 $F_{\\mathrm{NN}}(N_e)$ 定义为：根据经典的漂变-选择边界 $|2N_e s|\\le 1$，一个新突变相对于漂变和选择而言是有效中性的概率。您的任务是为几组参数集数值计算 $F_{\\mathrm{NN}}(N_e)$。\n\n通过对满足近中性标准的 $s$ 的子集上的 DFE 进行积分，将 $F_{\\mathrm{NN}}(N_e)$ 表达为一个纯粹的数学量。利用 $s=-X$ 且 $X \\ge 0$ 这一事实。除了上述基本要素外，您不得采用任何特设的捷径；必须通过数值计算或等价的数学特殊函数来评估相关积分。\n\n请为以下六个测试用例计算 $F_{\\mathrm{NN}}(N_e)$，每个用例是一个三元组 $(k,\\bar{s},N_e)$：\n\n- 测试用例 $1$：$k=0.5$，$\\bar{s}=-10^{-3}$，$N_e=10^{3}$。\n- 测试用例 $2$：$k=0.5$，$\\bar{s}=-10^{-3}$，$N_e=50$。\n- 测试用例 $3$：$k=5.0$，$\\bar{s}=-10^{-3}$，$N_e=10^{3}$。\n- 测试用例 $4$：$k=0.2$，$\\bar{s}=-10^{-4}$，$N_e=10^{6}$。\n- 测试用例 $5$：$k=2.0$，$\\bar{s}=-10^{-5}$，$N_e=10^{4}$。\n- 测试用例 $6$：$k=1.0$，$\\bar{s}=-10^{-4}$，$N_e=1$。\n\n对于每个测试用例：\n\n- 计算相应的伽马尺度参数 $\\theta=-\\bar{s}/k$。\n- 在 $|2N_e s| \\le 1$ 的标准下，数值计算 $F_{\\mathrm{NN}}(N_e)$。\n- 将结果报告为一个在 $[0,1]$ 区间内的实数，并四舍五入到 $6$ 位小数。\n\n最终输出格式：您的程序应生成单行输出，其中包含六个数值结果，形式为逗号分隔的列表，并用方括号括起来（例如，“[0.123456,0.234567,0.345678,0.456789,0.567890,0.678901]”）。此问题不涉及物理单位或角度单位，并且不应打印百分比。",
            "solution": "所述问题是有效的。它在科学上基于种群遗传学原理，特别是分子进化的近中性学说。该问题提法恰当、客观，并包含得出唯一解所需的所有信息。我将继续提供一个完整且有理有据的解决方案。\n\n目标是计算近中性分数，记为 $F_{\\mathrm{NN}}(N_e)$。这个量表示一个新的有害突变是有效中性的概率。有效中性的标准由经典的漂变-选择边界条件 $|2N_e s| \\le 1$ 给出，其中 $N_e$ 是有效种群大小，$s$ 是选择系数。\n\n问题指明突变是有害的，意味着它们的选择系数为非正值。选择系数 $s$ 通过关系式 $s = -X$ 与适应性效应的大小（一个正随机变量 $X$）相关联。由于 $X \\ge 0$ 且 $N_e > 0$，近中性的条件简化为：\n$$ |2N_e (-X)| \\le 1 \\implies 2N_e X \\le 1 \\implies 0 \\le X \\le \\frac{1}{2N_e} $$\n因此，近中性分数 $F_{\\mathrm{NN}}(N_e)$ 是随机变量 $X$ 落在此区间内的概率。\n\n所述的有害适应性效应的大小 $X$ 服从伽马分布，$X \\sim \\mathrm{Gamma}(k, \\theta)$，其形状参数 $k > 0$ 且尺度参数 $\\theta > 0$。$X$ 的概率密度函数 (PDF) 由下式给出：\n$$ f(x; k, \\theta) = \\frac{x^{k-1} e^{-x/\\theta}}{\\theta^k \\Gamma(k)} \\quad \\text{for } x \\ge 0 $$\n其中 $\\Gamma(k)$ 是伽马函数。\n\n近中性分数 $F_{\\mathrm{NN}}(N_e)$ 是通过在此 PDF 上对区间 $[0, 1/(2N_e)]$ 进行积分来计算的：\n$$ F_{\\mathrm{NN}}(N_e) = P\\left(X \\le \\frac{1}{2N_e}\\right) = \\int_{0}^{1/(2N_e)} f(x; k, \\theta) \\,dx $$\n根据定义，该积分是伽马分布的累积分布函数 (CDF) 在点 $x' = 1/(2N_e)$ 处的值。\n\n一个服从伽马分布的随机变量的 CDF 最恰当的表示方式是使用正则化下不完全伽马函数，记作 $P(a, z)$，其定义为：\n$$ P(a, z) = \\frac{\\gamma(a, z)}{\\Gamma(a)} = \\frac{1}{\\Gamma(a)} \\int_{0}^{z} t^{a-1} e^{-t} \\,dt $$\n为将我们的积分与此标准形式相关联，我们进行变量替换 $t = x/\\theta$，这意味着 $x = t\\theta$ 和 $dx = \\theta dt$。积分上限变为 $x = 1/(2N_e)$，对应于 $t = 1/(2N_e\\theta)$。积分变换如下：\n$$ F_{\\mathrm{NN}}(N_e) = \\int_{0}^{1/(2N_e\\theta)} \\frac{(t\\theta)^{k-1} e^{-t}}{\\theta^k \\Gamma(k)} (\\theta \\,dt) = \\frac{1}{\\Gamma(k)} \\int_{0}^{1/(2N_e\\theta)} t^{k-1} e^{-t} \\,dt $$\n这正是形状参数为 $a=k$、自变量为 $z = 1/(2N_e\\theta)$ 的正则化下不完全伽马函数：\n$$ F_{\\mathrm{NN}}(N_e) = P\\left(k, \\frac{1}{2N_e\\theta}\\right) $$\n该问题提供了参数 $k$ 和平均选择系数 $\\bar{s}$。随机变量 $X \\sim \\mathrm{Gamma}(k, \\theta)$ 的均值为 $E[X] = k\\theta$。由于 $s=-X$，平均选择系数为 $\\bar{s} = E[-X] = -E[X] = -k\\theta$。我们可以解出尺度参数 $\\theta$：\n$$ \\theta = -\\frac{\\bar{s}}{k} $$\n由于 $\\bar{s} < 0$ 且 $k > 0$，尺度参数 $\\theta$ 的确为正。\n\n将 $\\theta$ 的这个表达式代入自变量 $z$ 中，得到：\n$$ z = \\frac{1}{2N_e \\theta} = \\frac{1}{2N_e (-\\bar{s}/k)} = \\frac{k}{-2N_e \\bar{s}} $$\n因此，对于由三元组 $(k, \\bar{s}, N_e)$ 指定的每个测试用例，计算分两步进行：\n1.  计算特殊函数的自变量：$z = k/(-2N_e \\bar{s})$。\n2.  计算近中性分数：$F_{\\mathrm{NN}}(N_e) = P(k, z)$，使用标准数值库中正则化下不完全伽马函数的实现。\n\n该过程在数学上是严谨的，直接源于问题陈述，没有任何特设的假设。我们现在将此过程应用于给定的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammainc\n\ndef solve():\n    \"\"\"\n    Computes the nearly neutral fraction F_NN for a deleterious DFE.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (k, s_bar, Ne), representing the Gamma shape,\n    # mean selection coefficient, and effective population size.\n    test_cases = [\n        (0.5, -1e-3, 1e3),\n        (0.5, -1e-3, 50.0),\n        (5.0, -1e-3, 1e3),\n        (0.2, -1e-4, 1e6),\n        (2.0, -1e-5, 1e4),\n        (1.0, -1e-4, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        k, s_bar, Ne = case\n\n        # The nearly neutral fraction F_NN is the probability that a new\n        # deleterious mutation has a selection coefficient s such that |2*Ne*s| <= 1.\n        # Given s = -X where X is the fitness effect magnitude (X >= 0),\n        # the condition for near-neutrality becomes 2*Ne*X <= 1, or X <= 1 / (2*Ne).\n\n        # The magnitude of the fitness effect X follows a Gamma distribution:\n        # X ~ Gamma(shape=k, scale=theta).\n        # We are given the mean selection coefficient s_bar = E[s] = E[-X] = -E[X].\n        # For a Gamma(k, theta) distribution, the mean is k*theta, so E[X] = k*theta.\n        # This implies s_bar = -k*theta.\n\n        # From the given parameters, we find the scale parameter theta.\n        # As s_bar < 0 and k > 0, theta is positive as required.\n        theta = -s_bar / k\n\n        # F_NN is the probability P(X <= 1 / (2*Ne)).\n        # This is the value of the cumulative distribution function (CDF) of the\n        # Gamma(k, theta) distribution evaluated at the cutoff x_cutoff = 1 / (2*Ne).\n        x_cutoff = 1.0 / (2.0 * Ne)\n\n        # The CDF of a Gamma distribution is given by the regularized lower\n        # incomplete gamma function, P(a, z), where 'a' is the shape parameter\n        # and 'z = x / theta' is the argument.\n        # Here, a = k and z = x_cutoff / theta.\n        # z can also be calculated as z = k / (-2 * Ne * s_bar).\n        z_arg = x_cutoff / theta\n\n        # Calculate F_NN using scipy.special.gammainc for the regularized\n        # lower incomplete gamma function P(k, z).\n        f_nn = gammainc(k, z_arg)\n\n        # Append the result, formatted to 6 decimal places as specified.\n        results.append(f\"{f_nn:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}