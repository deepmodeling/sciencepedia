{
    "hands_on_practices": [
        {
            "introduction": "在我们应用复杂的演化模型之前，首要任务是学习如何从序列数据中精确地计算同义和非同义替换的机会（分别为 $S$ 和 $N$ 位点）以及观察到的差异（分别为 $S_d$ 和 $N_d$）。这个练习  将引导你完成这一基础过程，通过一种简化的计算方法来建立你对遗传密码如何影响分子演化测量的直观理解。这是所有后续速率估算都依赖的关键技能。",
            "id": "2754869",
            "problem": "下面给出两个直系同源蛋白质编码序列的成对密码子比对。这些序列是同框、密码子对齐的，并按 $5^\\prime \\to 3^\\prime$ 方向读取。比对的序列跨越 $4$ 个密码子（即 $12$ 个核苷酸）。\n\n序列 1 (参考): GCT TTT AGA GAA\n序列 2 (查询):     GCC TAT GCA GAC\n\n仅使用以下基本定义和假设：\n\n- 同义替换是指密码子内不改变其编码的氨基酸的单个核苷酸变化；非同义替换是指会改变其编码的氨基酸的单个核苷酸变化。产生终止密码子的单核苷酸变化应计为非同义替换。\n- 对每个密码子，同义位点的数量定义为：对三个密码子位置进行求和，每个位置的加项是在该位置上三种可能的单核苷酸变化中同义变化的比例。非同义位点的数量是剩余部分，因此每个密码子的同义和非同义位点之和等于 $3$。\n- 对于存在多个核苷酸差异的密码子对，将差异分解为沿所有最短路径（即密码子之间的汉明距离）的单核苷酸步骤，计算每条路径上的同义与非同义步骤数，然后对这些路径取平均值（等路径加权，如 Nei–Gojobori 框架中所示）。\n- 使用标准核基因密码，以及以下相关的密码子家族：丙氨酸由 GCT、GCC、GCA、GCG 编码；苯丙氨酸由 TTT、TTC 编码；酪氨酸由 TAT、TAC 编码；精氨酸由 CGT、CGC、CGA、CGG、AGA、AGG 编码；谷氨酸由 GAA、GAG 编码；天冬氨酸由 GAT、GAC 编码。不需要其他遗传密码的细节。\n\n任务：\n\n1. 首先计算两个序列中每个密码子的位点数，然后对每个位置上成对密码子的计数取平均，最后对 $4$ 个密码子位置求和，从而计算出比对的总同义位点数 $S$ 和总非同义位点数 $N$。\n2. 对于单核苷酸差异使用单步分类，对于有两个差异的密码子对使用等路径加权，计算整个比对中同义差异的期望数 $S_{d}$ 和非同义差异的期望数 $N_{d}$。\n3. 由此推导出 $p_{S} = S_{d}/S$ 和 $p_{N} = N_{d}/N$。\n\n将您的最终答案以有序对 $(p_{S}, p_{N})$ 的形式报告。将 $p_{S}$ 和 $p_{N}$ 各自四舍五入到四位有效数字。最终答案不带单位。",
            "solution": "该问题要求针对给定的成对密码子比对，计算每个同义位点的同义差异比例 $p_{S}$，以及每个非同义位点的非同义差异比例 $p_{N}$。验证已确认该问题具有科学依据，提法明确，并包含足够的信息以得出唯一解。计算将按规定分三个阶段执行。\n\n**阶段 1：总同义位点数 ($S$) 和总非同义位点数 ($N$) 的计算**\n\n首先，我们必须确定比对中每个唯一密码子的同义位点数 ($s$) 和非同义位点数 ($n$)。每个密码子的位点数为 $3$。一个密码子的同义位点数计算公式为 $s = \\sum_{i=1}^{3} f_{i,S}$，其中 $f_{i,S}$ 是在位置 $i$ 处单核苷酸变化中同义变化的比例。非同义位点数为 $n = 3 - s$。相关遗传密码已提供。\n\n比对如下：\n序列 1: GCT TTT AGA GAA\n序列 2: GCC TAT GCA GAC\n\n对每个唯一密码子的计算：\n- **GCT (丙氨酸):** 位置 $1$ 和 $2$ 是非简并的。位置 $3$ 是一个 $4$ 重简并位点。\n  $s_{\\text{GCT}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{3}{3} = 1$。所以，$n_{\\text{GCT}} = 3 - 1 = 2$。\n- **GCC (丙氨酸):** 性质与 GCT 相同。\n  $s_{\\text{GCC}} = 1$ 且 $n_{\\text{GCC}} = 2$。\n- **TTT (苯丙氨酸):** 位置 $1$ 和 $2$ 是非简并的。在位置 $3$，三种可能的变化之一（变为 TTC）是同义的。\n  $s_{\\text{TTT}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$。所以，$n_{\\text{TTT}} = 3 - \\frac{1}{3} = \\frac{8}{3}$。\n- **TAT (酪氨酸):** 位置 $1$ 和 $2$ 是非简并的。在位置 $3$，三种可能的变化之一（变为 TAC）是同义的。\n  $s_{\\text{TAT}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$。所以，$n_{\\text{TAT}} = 3 - \\frac{1}{3} = \\frac{8}{3}$。\n- **AGA (精氨酸):** 在位置 $1$，一个变化（变为 CGA）是同义的。在位置 $2$，所有变化都是非同义的。在位置 $3$，一个变化（变为 AGG）是同义的。\n  $s_{\\text{AGA}} = \\frac{1}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{2}{3}$。所以，$n_{\\text{AGA}} = 3 - \\frac{2}{3} = \\frac{7}{3}$。\n- **GCA (丙氨酸):** 性质与 GCT 相同。\n  $s_{\\text{GCA}} = 1$ 且 $n_{\\text{GCA}} = 2$。\n- **GAA (谷氨酸):** 位置 $1$ 和 $2$ 是非简并的。在位置 $3$，一个变化（变为 GAG）是同义的。\n  $s_{\\text{GAA}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$。所以，$n_{\\text{GAA}} = 3 - \\frac{1}{3} = \\frac{8}{3}$。\n- **GAC (天冬氨酸):** 位置 $1$ 和 $2$ 是非简并的。在位置 $3$，一个变化（变为 GAT）是同义的。\n  $s_{\\text{GAC}} = \\frac{0}{3} + \\frac{0}{3} + \\frac{1}{3} = \\frac{1}{3}$。所以，$n_{\\text{GAC}} = 3 - \\frac{1}{3} = \\frac{8}{3}$。\n\n接下来，我们对比对中每个密码子对的位点数进行平均。\n1.  **密码子对 1 (GCT, GCC):**\n    $\\bar{s}_1 = \\frac{s_{\\text{GCT}} + s_{\\text{GCC}}}{2} = \\frac{1+1}{2} = 1$。\n    $\\bar{n}_1 = \\frac{n_{\\text{GCT}} + n_{\\text{GCC}}}{2} = \\frac{2+2}{2} = 2$。\n2.  **密码子对 2 (TTT, TAT):**\n    $\\bar{s}_2 = \\frac{s_{\\text{TTT}} + s_{\\text{TAT}}}{2} = \\frac{1/3+1/3}{2} = \\frac{1}{3}$。\n    $\\bar{n}_2 = \\frac{n_{\\text{TTT}} + n_{\\text{TAT}}}{2} = \\frac{8/3+8/3}{2} = \\frac{8}{3}$。\n3.  **密码子对 3 (AGA, GCA):**\n    $\\bar{s}_3 = \\frac{s_{\\text{AGA}} + s_{\\text{GCA}}}{2} = \\frac{2/3+1}{2} = \\frac{5/3}{2} = \\frac{5}{6}$。\n    $\\bar{n}_3 = \\frac{n_{\\text{AGA}} + n_{\\text{GCA}}}{2} = \\frac{7/3+2}{2} = \\frac{13/3}{2} = \\frac{13}{6}$。\n4.  **密码子对 4 (GAA, GAC):**\n    $\\bar{s}_4 = \\frac{s_{\\text{GAA}} + s_{\\text{GAC}}}{2} = \\frac{1/3+1/3}{2} = \\frac{1}{3}$。\n    $\\bar{n}_4 = \\frac{n_{\\text{GAA}} + n_{\\text{GAC}}}{2} = \\frac{8/3+8/3}{2} = \\frac{8}{3}$。\n\n最后，我们对这些平均计数求和，以找到比对的总 $S$ 和 $N$。\n$S = \\bar{s}_1 + \\bar{s}_2 + \\bar{s}_3 + \\bar{s}_4 = 1 + \\frac{1}{3} + \\frac{5}{6} + \\frac{1}{3} = \\frac{6+2+5+2}{6} = \\frac{15}{6} = 2.5$。\n$N = \\bar{n}_1 + \\bar{n}_2 + \\bar{n}_3 + \\bar{n}_4 = 2 + \\frac{8}{3} + \\frac{13}{6} + \\frac{8}{3} = \\frac{12+16+13+16}{6} = \\frac{57}{6} = 9.5$。\n总和 $S+N = 2.5+9.5 = 12$，这对于一个 $4$ 密码子比对是正确的。\n\n**阶段 2：同义差异 ($S_d$) 和非同义差异 ($N_d$) 的计算**\n\n我们现在对每个密码子对的核苷酸差异进行分类。\n1.  **密码子对 1 (GCT vs GCC):** 有 $1$ 个差异 (T $\\to$ C)。GCT (丙氨酸) $\\to$ GCC (丙氨酸) 是一个同义变化。\n    $s_{d,1} = 1$，$n_{d,1} = 0$。\n2.  **密码子对 2 (TTT vs TAT):** 有 $1$ 个差异 (T $\\to$ A)。TTT (苯丙氨酸) $\\to$ TAT (酪氨酸) 是一个非同义变化。\n    $s_{d,2} = 0$，$n_{d,2} = 1$。\n3.  **密码子对 3 (AGA vs GCA):** 有 $2$ 个差异 (A $\\to$ G, G $\\to$ C)。我们检查两条最短的进化路径：\n    - 路径 A：AGA (精氨酸) $\\to$ GGA (甘氨酸) $\\to$ GCA (丙氨酸)。两个步骤都是非同义的。路径 A：$0$ 个 S，$2$ 个 N 步骤。\n    - 路径 B：AGA (精氨酸) $\\to$ ACA (苏氨酸) $\\to$ GCA (丙氨酸)。两个步骤都是非同义的。路径 B：$0$ 个 S，$2$ 个 N 步骤。\n    对路径进行平均：$s_{d,3} = \\frac{0+0}{2}=0$，$n_{d,3} = \\frac{2+2}{2}=2$。\n4.  **密码子对 4 (GAA vs GAC):** 有 $1$ 个差异 (A $\\to$ C)。GAA (谷氨酸) $\\to$ GAC (天冬氨酸) 是一个非同义变化。\n    $s_{d,4} = 0$，$n_{d,4} = 1$。\n\n差异总数：\n$S_d = \\sum s_{d,i} = 1 + 0 + 0 + 0 = 1$。\n$N_d = \\sum n_{d,i} = 0 + 1 + 2 + 1 = 4$。\n\n**阶段 3：$p_S$ 和 $p_N$ 的计算**\n\n比例计算为差异数除以位点数。\n$p_S = \\frac{S_d}{S} = \\frac{1}{2.5} = 0.4$。\n$p_N = \\frac{N_d}{N} = \\frac{4}{9.5} = \\frac{4}{19/2} = \\frac{8}{19}$。\n\n最后，我们将这些值以十进制形式表示，并四舍五入到四位有效数字。\n$p_S = 0.4000$。\n$p_N = \\frac{8}{19} \\approx 0.4210526...$，四舍五入为 $0.4211$。\n\n最终答案是有序对 $(p_S, p_N)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4000 & 0.4211\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "由于在同一位点上可能发生多次未被观察到的替换，序列间的观察差异往往低估了真实的替换总数。这个实践  将介绍 Jukes-Cantor 模型，这是一个基础工具，用于校正这种饱和效应并估算真实的替换速率 $d_S$ 和 $d_N$。通过推导和应用这一校正，你将学会如何从简单的比例转向更准确地估算演化速率比 $\\omega$。",
            "id": "2754886",
            "problem": "两条直系同源蛋白质编码序列进行了无间隙比对。在分为同义和非同义的位点中，两条序列之间观察到的核苷酸差异比例分别为 $p_{S}=0.3$ 和 $p_{N}=0.05$。假设在每个位点类别内，核苷酸替换分别遵循连续时间的 Jukes–Cantor 模型（所有不同核苷酸对之间具有相等的平衡碱基频率和相等的瞬时速率），各位点独立进化，且位点间不存在速率异质性。\n\n从具有相同非对角线元素的生成矩阵的连续时间马尔可夫链的定义出发，并使用柯尔莫哥洛夫前向方程，推导出 Jukes–Cantor 校正公式。该校正将时间 $t$ 观察到的差异比例 $p$ 映射到该模型下每个位点的预期替换数 $d$。将此校正独立地应用于同义和非同义位点类别，从 $p_{S}$ 和 $p_{N}$ 计算出 $d_{S}$ 和 $d_{N}$。然后计算非同义与同义替换率之比 $\\omega = d_N/d_S$。\n\n最终答案只提供 $\\omega$ 的值。将报告的 $\\omega$ 值四舍五入到四位有效数字。不包括单位。",
            "solution": "该问题要求从第一性原理出发推导 Jukes-Cantor 校正，并应用它来计算非同义与同义替换率之比 $\\omega$。\n\n首先，我们验证问题的有效性。已知条件如下：\n- 同义位点的观测差异比例，$p_{S} = 0.3$。\n- 非同义位点的观测差异比例，$p_{N} = 0.05$。\n- 替换过程遵循连续时间的 Jukes–Cantor (JC69) 模型。\n该问题在进化生物学方面有科学依据，信息充分，问题设定良好，并使用了客观、标准的术语。不存在逻辑矛盾、事实错误或含糊不清之处。该问题是有效的。\n\n现在我们开始求解。\n\nJukes-Cantor 模型将核苷酸替换描述为在四个核苷酸状态空间上的连续时间马尔可夫过程。该模型假定任意一对不同核苷酸之间的替换率 $\\alpha$ 相等。包含瞬时转换率的生成矩阵 $Q$ 由下式给出：\n$$\nQ =\n\\begin{pmatrix}\n-3\\alpha & \\alpha & \\alpha & \\alpha \\\\\n\\alpha & -3\\alpha & \\alpha & \\alpha \\\\\n\\alpha & \\alpha & -3\\alpha & \\alpha \\\\\n\\alpha & \\alpha & \\alpha & -3\\alpha\n\\end{pmatrix}\n$$\n对角线元素 $Q_{ii} = -3\\alpha$ 表示从核苷酸 $i$ 替换出去的总速率，这确保了 $Q$ 矩阵的行和为零。\n\n转移概率矩阵 $P(t)$（其中 $P_{ij}(t)$ 是在 $t=0$ 时处于状态 $i$ 的条件下，在时间 $t$ 处于状态 $j$ 的概率）根据柯尔莫哥洛夫前向方程演化：\n$$ \\frac{d P(t)}{dt} = P(t) Q $$\n初始条件为 $P(0) = I$，即单位矩阵。\n\n由于 $Q$ 矩阵的对称性，转移概率仅取决于初始状态和最终状态是相同还是不同。设 $P_{ii}(t)$ 为在时间 $t$ 内没有发生变化的概率，而对于 $i \\neq j$，$P_{ij}(t)$ 为发生特定变化的概率。对于任何 $i$，概率之和必须为1：\n$$ P_{ii}(t) + \\sum_{j \\neq i} P_{ij}(t) = 1 $$\n根据对称性，对所有 $i \\neq j$，$P_{ij}(t)$ 均相等。所以，$P_{ii}(t) + 3P_{ij}(t) = 1$，这意味着 $P_{ij}(t) = \\frac{1 - P_{ii}(t)}{3}$。\n\n我们可以从该矩阵方程写出关于 $P_{ii}(t)$ 的微分方程。对于任意行 $i$：\n$$ \\frac{dP_{ii}(t)}{dt} = \\sum_{k=1}^{4} P_{ik}(t) Q_{ki} = P_{ii}(t) Q_{ii} + \\sum_{k \\neq i} P_{ik}(t) Q_{ki} $$\n$$ \\frac{dP_{ii}(t)}{dt} = P_{ii}(t)(-3\\alpha) + 3 P_{ij}(t)(\\alpha) $$\n代入 $P_{ij}(t) = \\frac{1 - P_{ii}(t)}{3}$：\n$$ \\frac{dP_{ii}(t)}{dt} = -3\\alpha P_{ii}(t) + 3\\alpha \\left(\\frac{1 - P_{ii}(t)}{3}\\right) = -3\\alpha P_{ii}(t) + \\alpha - \\alpha P_{ii}(t) $$\n$$ \\frac{dP_{ii}(t)}{dt} = \\alpha - 4\\alpha P_{ii}(t) $$\n这是一个一阶线性常微分方程。在初始条件 $P_{ii}(0) = 1$下，其解为：\n$$ P_{ii}(t) = \\frac{1}{4} + \\frac{3}{4} \\exp(-4\\alpha t) $$\n\n两条序列在 $t$ 个时间单位前从共同祖先分化而来，它们之间观察到的差异比例 $p$ 是同源位点上的核苷酸不同的概率。分隔这两条序列的总进化时间是 $2t$。序列间差异的概率等同于单个谱系在 $2t$ 的时间间隔内改变其状态的概率。\n设 $T = 2t$。在这段总时间内观察到没有变化的概率是 $P_{ii}(T) = P_{ii}(2t)$。\n$$ P_{\\text{same}} = \\frac{1}{4} + \\frac{3}{4} \\exp(-4\\alpha(2t)) = \\frac{1}{4} + \\frac{3}{4} \\exp(-8\\alpha t) $$\n观察到差异的概率 $p$ 是 $1 - P_{\\text{same}}$：\n$$ p = 1 - \\left( \\frac{1}{4} + \\frac{3}{4} \\exp(-8\\alpha t) \\right) = \\frac{3}{4} (1 - \\exp(-8\\alpha t)) $$\n\n每个位点的预期替换数 $d$ 是替换率乘以总流逝时间。从任何一个核苷酸替换出去的速率是 $3\\alpha$。在 $2t$ 的总时间内，预期的替换数是：\n$$ d = (3\\alpha) \\times (2t) = 6\\alpha t $$\n\n现在我们必须用 $p$ 来表示 $d$。从 $p$ 的方程中：\n$$ \\frac{4p}{3} = 1 - \\exp(-8\\alpha t) $$\n$$ \\exp(-8\\alpha t) = 1 - \\frac{4p}{3} $$\n$$ -8\\alpha t = \\ln\\left(1 - \\frac{4p}{3}\\right) $$\n我们需要 $d = 6\\alpha t$。我们可以从 $8\\alpha t$ 得到：\n$$ 6\\alpha t = \\frac{6}{8} (8\\alpha t) = \\frac{3}{4} (8\\alpha t) = \\frac{3}{4} \\left[ -\\ln\\left(1 - \\frac{4p}{3}\\right) \\right] $$\n因此，Jukes-Cantor 校正为：\n$$ d = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p\\right) $$\n\n现在，我们将此公式独立地应用于同义和非同义位点。\n给定 $p_{S} = 0.3$：\n$$ d_S = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p_S\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.3\\right) $$\n$$ d_S = -\\frac{3}{4} \\ln(1 - 0.4) = -\\frac{3}{4} \\ln(0.6) $$\n\n给定 $p_{N} = 0.05$：\n$$ d_N = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p_N\\right) = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} \\times 0.05\\right) $$\n$$ d_N = -\\frac{3}{4} \\ln\\left(1 - \\frac{1}{15}\\right) = -\\frac{3}{4} \\ln\\left(\\frac{14}{15}\\right) $$\n\n非同义与同义替换率之比 $\\omega$ 计算为 $d_N$ 与 $d_S$ 的比值：\n$$ \\omega = \\frac{d_N}{d_S} = \\frac{-\\frac{3}{4} \\ln\\left(\\frac{14}{15}\\right)}{-\\frac{3}{4} \\ln(0.6)} = \\frac{\\ln(14/15)}{\\ln(0.6)} $$\n我们现在计算数值：\n$$ \\ln(0.6) \\approx -0.5108256 $$\n$$ \\ln(14/15) \\approx \\ln(0.9333...) \\approx -0.0689929 $$\n$$ \\omega \\approx \\frac{-0.0689929}{-0.5108256} \\approx 0.135061 $$\n将结果四舍五入到四位有效数字，我们得到 $\\omega \\approx 0.1351$。",
            "answer": "$$\\boxed{0.1351}$$"
        },
        {
            "introduction": "虽然单个 $\\omega$ 值提供了基因范围内的平均选择压力，但选择压力在蛋白质的不同密码子间通常存在巨大差异。现代演化分析采用位点特异性模型来识别这些选择的“热点”。这个练习  让你沉浸在强大的贝叶斯经验贝叶斯（Bayes Empirical Bayes, BEB）方法中，向你展示如何基于演化速率的混合模型，计算特定位点处于正选择下的后验概率。",
            "id": "2754811",
            "problem": "一个蛋白质编码基因已在密码子替换混合模型（通常记为 M8，即 Beta 和 $\\omega>1$ 模型）下进行了分析，其中 $\\omega = d_N/d_S$ 是非同义替换与同义替换速率的比值。在此模型下，各位点从一个潜位点类别的混合中抽样得到：一组类别的 $\\omega$ 值在 $(0,1)$ 区间内，服从 Beta 分布（此处用一组有限的离散类别来近似）；以及一个 $\\omega>1$ 的类别，代表正选择。该模型的参数已通过在固定的系统发育树和分支长度上进行最大似然估计得到。对于一个特定的比对位点，在拟合的参数值下，您获得了关于位点类别混合的以下信息：\n\n- Beta 分布的离散近似：四个位点类别，其 $\\omega$ 值分别为 $\\omega_1 = 0.05$, $\\omega_2 = 0.25$, $\\omega_3 = 0.55$, $\\omega_4 = 0.85$，先验混合比例分别为 $\\pi_1 = 0.15$, $\\pi_2 = 0.25$, $\\pi_3 = 0.30$, $\\pi_4 = 0.20$。\n- 一个正选择类别，其 $\\omega_+ = 2.4$，先验混合比例为 $\\pi_+ = 0.10$。\n\n对于此焦点位点，类别条件位点对数似然（根据上述 $\\omega$ 值的密码子模型计算，并以固定的系统发育树和所有其他拟合参数为条件）如下：\n- $\\ell_1 = -210.8$,\n- $\\ell_2 = -209.5$,\n- $\\ell_3 = -209.0$,\n- $\\ell_4 = -208.7$,\n- $\\ell_+ = -207.9$.\n\n将给定的先验混合比例视为贝叶斯经验贝叶斯（BEB）框架中位点类别的先验概率。使用所提供的对数似然，计算该位点属于正选择类别的 BEB 后验概率。在组合对数似然与混合比例时，请使用数值稳定的计算方法。将您的最终答案四舍五入到四位有效数字。答案应为无量纲。",
            "solution": "问题陈述经评估有效。它在科学上基于分子进化和统计系统发育学的原理，提出了一个定义明确、参数完整且一致的问题。这是一个可以形式化的客观问题，需要进行标准的、非平凡的计算。\n\n任务是根据一组先验概率和类别条件似然，计算特定比对位点属于正选择类别的后验概率。这个计算是贝叶斯定理在贝叶斯经验贝叶斯（BEB）框架内的直接应用。\n\n设 $C_k$ 为位点属于类别 $k$ 的事件，其中类别集合由 $k \\in \\{1, 2, 3, 4, +\\}$ 索引。设 $D$ 代表焦点位点的观测数据（即比对列）。根据贝叶斯定理，给定数据 $D$ 的情况下，位点属于类别 $C_k$ 的后验概率为：\n$$ P(C_k | D) = \\frac{P(D | C_k) P(C_k)}{P(D)} $$\n在此背景下：\n-   $P(C_k)$ 是类别 $k$ 的先验概率，由混合比例 $\\pi_k$ 给出。\n-   $P(D | C_k)$ 是给定类别 $k$ 时数据的似然，我们将其表示为 $L_k$。问题提供了似然的自然对数，即 $\\ell_k = \\ln(L_k)$。因此，$L_k = \\exp(\\ell_k)$。\n-   $P(D)$ 是数据的边际似然，也称为证据。它通过对所有可能类别的联合概率求和来计算，因此用作归一化常数：\n    $$ P(D) = \\sum_{j \\in \\{1, 2, 3, 4, +\\}} P(D, C_j) = \\sum_{j} P(D | C_j) P(C_j) = \\sum_{j} L_j \\pi_j $$\n\n我们需要计算正选择类别 $C_{+}$ 的后验概率。公式为：\n$$ P(C_{+} | D) = \\frac{L_{+} \\pi_{+}}{\\sum_{j} L_j \\pi_j} = \\frac{\\exp(\\ell_{+}) \\pi_{+}}{\\sum_{j} \\exp(\\ell_{j}) \\pi_{j}} $$\n给定的对数似然值是很大的负数。直接计算 $\\exp(\\ell_j)$ 将导致数值下溢，即这些值太小，无法用标准浮点数表示。为了进行数值稳定的计算，我们必须重新缩放各项。设 $\\ell_{\\max} = \\max_{j} \\{\\ell_j\\}$。我们可以将分子和分母同乘以 $\\exp(-\\ell_{\\max})$ 而不改变分数的值：\n$$ P(C_{+} | D) = \\frac{\\exp(\\ell_{+}) \\exp(-\\ell_{\\max}) \\pi_{+}}{\\left( \\sum_{j} \\exp(\\ell_{j}) \\pi_{j} \\right) \\exp(-\\ell_{\\max})} = \\frac{\\exp(\\ell_{+} - \\ell_{\\max}) \\pi_{+}}{\\sum_{j} \\exp(\\ell_{j} - \\ell_{\\max}) \\pi_{j}} $$\n该方法确保任何项中的最大指数为 $0$，从而防止下溢。\n\n所提供的参数如下：\n-   先验比例：$\\pi_{1} = 0.15$, $\\pi_{2} = 0.25$, $\\pi_{3} = 0.30$, $\\pi_{4} = 0.20$, $\\pi_{+} = 0.10$。\n-   类别条件对数似然：$\\ell_{1} = -210.8$, $\\ell_{2} = -209.5$, $\\ell_{3} = -209.0$, $\\ell_{4} = -208.7$, $\\ell_{+} = -207.9$。\n\n首先，我们确定最大对数似然：\n$$ \\ell_{\\max} = \\max\\{-210.8, -209.5, -209.0, -208.7, -207.9\\} = -207.9 $$\n我们注意到 $\\ell_{\\max} = \\ell_{+}$。\n\n接下来，我们计算每个类别的未归一化后验支持度，我们将其表示为 $w_j = \\exp(\\ell_j - \\ell_{\\max}) \\pi_j$。\n-   $w_1 = \\exp(-210.8 - (-207.9)) \\times 0.15 = \\exp(-2.9) \\times 0.15$\n-   $w_2 = \\exp(-209.5 - (-207.9)) \\times 0.25 = \\exp(-1.6) \\times 0.25$\n-   $w_3 = \\exp(-209.0 - (-207.9)) \\times 0.30 = \\exp(-1.1) \\times 0.30$\n-   $w_4 = \\exp(-208.7 - (-207.9)) \\times 0.20 = \\exp(-0.8) \\times 0.20$\n-   $w_{+} = \\exp(-207.9 - (-207.9)) \\times 0.10 = \\exp(0) \\times 0.10 = 1 \\times 0.10 = 0.10$\n\n我们继续对这些项进行数值计算：\n-   $w_1 \\approx 0.055023 \\times 0.15 \\approx 0.008253$\n-   $w_2 \\approx 0.201897 \\times 0.25 \\approx 0.050474$\n-   $w_3 \\approx 0.332871 \\times 0.30 \\approx 0.099861$\n-   $w_4 \\approx 0.449329 \\times 0.20 \\approx 0.089866$\n-   $w_{+} = 0.10$\n\n后验概率公式的分母是这些值的总和：\n$$ \\sum_{j} w_j \\approx 0.008253 + 0.050474 + 0.099861 + 0.089866 + 0.10 = 0.348454 $$\n分子是正选择类别对应的项，即 $w_{+} = 0.10$。\n\n最后，后验概率是这个比率：\n$$ P(C_{+} | D) = \\frac{w_{+}}{\\sum_{j} w_j} \\approx \\frac{0.10}{0.348454} \\approx 0.286981... $$\n问题要求将结果四舍五入到四位有效数字。\n$$ P(C_{+} | D) \\approx 0.2870 $$\n这个值是无量纲的，符合概率的要求。",
            "answer": "$$\n\\boxed{0.2870}\n$$"
        }
    ]
}