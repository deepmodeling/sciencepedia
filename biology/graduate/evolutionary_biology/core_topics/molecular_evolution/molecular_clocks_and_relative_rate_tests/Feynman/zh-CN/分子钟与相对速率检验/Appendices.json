{
    "hands_on_practices": [
        {
            "introduction": "在检验分子钟或估算分化时间之前，我们必须首先准确地测量进化距离。由于多次未被观测到的替换事件（即“多次击中”），序列间的原始差异（$p$）会系统性地低估真实的替换数量（$d$）。本练习将通过从第一性原理推导Jukes-Cantor（JC69）校正公式，并量化其影响，从而巩固您对多次击中问题的理解，这是任何分子进化分析中至关重要的第一步。",
            "id": "2736569",
            "problem": "一位研究人员正准备使用一个蛋白质编码基因，对两个姐妹谱系进行分子钟校准和相对速率检验。设两序列间观察到的成对核苷酸差异分数为 $p=0.2$。假设采用 Jukes–Cantor $1969$ (JC69) 模型：这是一个在4状态字母表上的连续时间、时间同质性马尔可夫链，其特点是所有核苷酸变化的稳态碱基频率相等、瞬时速率相等，并且各位点之间具有独立性和速率同质性。\n\n从这些 JC69 假设和连续时间马尔可夫链的第一性原理（瞬时速率矩阵的矩阵指数，以及将每位点预期替换数定义为瞬时速率的路径积分）出发，推导出与观察值 $p=0.2$ 一致的校正后进化距离 $d$（沿分隔两个序列的总路径上每位点的预期替换数）。然后，在分子钟校准或相对速率检验的背景下，通过比较 $d$ 和 $p$，定量解释“多次击中”的量级。\n\n以“每位点替换数”为单位表示 $d$ 的最终数值，并四舍五入到四位有效数字。最终报告的答案必须仅为 $d$ 的单一数值（不带单位）。",
            "solution": "该问题要求从观察到的核苷酸差异比例 $p$ 推导出 Jukes-Cantor (JC69) 距离 $d$，并对结果进行定量解释。推导过程必须从第一性原理出发。\n\n首先，我们定义 JC69 模型的瞬时速率矩阵 $Q$。该模型假设稳态碱基频率相等，即对于 $i \\in \\{A, C, G, T\\}$，$\\pi_i = \\frac{1}{4}$，并且任意两个不同核苷酸之间的替换速率 $\\alpha$ 也相等。对角线元素 $Q_{ii}$ 的定义使得每行之和为零，即 $Q_{ii} = -3\\alpha$。该速率矩阵为：\n$$\nQ = \\begin{pmatrix} -3\\alpha & \\alpha & \\alpha & \\alpha \\\\ \\alpha & -3\\alpha & \\alpha & \\alpha \\\\ \\alpha & \\alpha & -3\\alpha & \\alpha \\\\ \\alpha & \\alpha & \\alpha & -3\\alpha \\end{pmatrix}\n$$\n\n进化距离 $d$ 定义为沿分隔两个序列的总路径上，每位点的预期替换数。设这两个序列在时间 $0$ 从它们的共同祖先分化，并在时间 $t$ 被观察到。分隔这两个序列的总分歧时间为 $T = 2t$。每位点的总替换速率 $\\mu$ 是离开任何状态的平均速率，按稳态频率加权：\n$$\n\\mu = -\\sum_{i} \\pi_i Q_{ii} = -\\sum_{i} \\left(\\frac{1}{4}\\right)(-3\\alpha) = 4 \\left(\\frac{3\\alpha}{4}\\right) = 3\\alpha\n$$\n总距离 $d$ 是该速率与总时间跨度 $T = 2t$ 的乘积：\n$$\nd = \\mu T = (3\\alpha)(2t) = 6\\alpha t\n$$\n\n接下来，我们将观察到的差异比例 $p$ 与模型参数联系起来。值 $p$ 是在任何给定位置，第一个序列中的核苷酸与第二个序列中的核苷酸不同的概率。这等于 $1$ 减去它们相同的概率。\n$$\np = 1 - P(\\text{核苷酸相同})\n$$\n一个更直接的方法是认识到，沿着分隔两个序列的两个分支的进化过程，等效于一个在总时间间隔 $T = 2t$ 上的单一过程。因此，观察到差异的概率，就是在这个时间间隔内发生替换的概率。这等于 $1$ 减去核苷酸保持不变的概率。\n$$\np = 1 - \\sum_i \\pi_i P_{ii}(2t)\n$$\n由于 JC69 模型的对称性，稳态分布是均匀的（$\\pi_i = \\frac{1}{4}$），并且转移概率矩阵的对角线元素 $P_{ii}(2t)$ 都相等。因此，对于像 A 这样的任意核苷酸，有 $p = 1 - P_{AA}(2t)$。\n\n转移概率矩阵是速率矩阵的指数，即 $P(\\tau) = \\exp(Q\\tau)$。对于 JC69 模型，在时间间隔 $\\tau$ 内，一个特定核苷酸保持不变的概率是：\n$$\nP_{ii}(\\tau) = \\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha\\tau)\n$$\n我们针对总分歧时间 $\\tau = 2t$ 来计算这个概率：\n$$\nP_{ii}(2t) = \\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha(2t)) = \\frac{1}{4} + \\frac{3}{4}\\exp(-8\\alpha t)\n$$\n将此代入 $p$ 的表达式中：\n$$\np = 1 - \\left(\\frac{1}{4} + \\frac{3}{4}\\exp(-8\\alpha t)\\right) = \\frac{3}{4} - \\frac{3}{4}\\exp(-8\\alpha t) = \\frac{3}{4}(1 - \\exp(-8\\alpha t))\n$$\n现在我们必须用进化距离 $d = 6\\alpha t$ 来表示这个关系。根据这个定义，我们得到 $\\alpha t = \\frac{d}{6}$。将此代入 $p$ 的方程中：\n$$\np = \\frac{3}{4}\\left(1 - \\exp\\left(-8 \\cdot \\frac{d}{6}\\right)\\right) = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{4d}{3}\\right)\\right)\n$$\n这就是 JC69 模型下观察到的差异 $p$ 和校正后距离 $d$ 之间的基本关系。为了解出 $d$，我们重新整理方程：\n$$\n\\frac{4p}{3} = 1 - \\exp\\left(-\\frac{4d}{3}\\right)\n$$\n$$\n\\exp\\left(-\\frac{4d}{3}\\right) = 1 - \\frac{4p}{3}\n$$\n对两边取自然对数：\n$$\n-\\frac{4d}{3} = \\ln\\left(1 - \\frac{4p}{3}\\right)\n$$\n$$\nd = -\\frac{3}{4}\\ln\\left(1 - \\frac{4p}{3}\\right)\n$$\n这就是推导出的 Jukes-Cantor 距离校正公式。\n\n给定 $p = 0.2$。代入这个值：\n$$\nd = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}(0.2)\\right) = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{15}\\right) = -\\frac{3}{4}\\ln\\left(\\frac{11}{15}\\right) = \\frac{3}{4}\\ln\\left(\\frac{15}{11}\\right)\n$$\n计算数值：\n$$\nd \\approx \\frac{3}{4} \\times 0.31015494 = 0.2326162...\n$$\n四舍五入到四位有效数字，距离为 $d \\approx 0.2326$ 每位点替换数。\n\n最后，我们必须定量解释“多次击中”的量级。观察到的差异比例 $p=0.2$ 代表了通过直接比较两个序列所能计算出的差异数。校正后的距离 $d \\approx 0.2326$ 代表了在分隔两个序列的进化历史中，每位点实际发生的预期替换数。$d > p$ 这一事实是“多次击中”的直接结果：这些替换在最终的序列比较中是不可见的。这些包括回复突变（例如，A $\\to$ G $\\to$ A）和平行变化，它们导致观察到的差异小于事件的真实数量。\n这些未观察到的替换的量级是 $d - p \\approx 0.2326 - 0.2 = 0.0326$。这意味着每 100 个位点中，大约有 20 个被观察到是不同的，但模型推断出，还有额外的 3.26 次替换因“多次击中”而被掩盖了。校正后距离相对于观察到差异的分数增长为 $\\frac{d-p}{p} = \\frac{0.0326}{0.2} = 0.163$，即 $16.3\\%$。\n这种校正对于分子钟校准和相对速率检验至关重要。在这种情况下，使用原始的、未校正的距离 $p$ 会导致对分歧时间或进化速率产生约 $16.3\\%$ 的系统性低估。在比较两个谱系的相对速率检验中，替换率较高的谱系会累积更多的“多次击中”。使用 $p$ 而不是 $d$ 会不成比例地低估较快谱系的距离，这可能会掩盖真实的速率变异，并导致错误地接受分子钟假说。因此，使用校正后的距离 $d$ 对于准确的进化推断是必不可少的。",
            "answer": "$$\\boxed{0.2326}$$"
        },
        {
            "introduction": "严格分子钟的核心假设是，进化速率在不同谱系间是恒定的。Tajima的相对速率检验提供了一个简单而强大的统计框架，通过比较两个姐妹谱系相对于一个外群的特有替换数量来检验这一假设。通过从基本原理推导检验统计量并将其应用于计数数据，您将获得正式检验分子钟假设的实践经验，这是应用时钟模型进行年代测定前的关键步骤。",
            "id": "2736568",
            "problem": "对两个姐妹群 $A$ 和 $B$ 以及一个外群 $O$ 在 $L=1000$ 个对齐的脱氧核糖核酸（DNA）位点上进行了采样。每个位点相对于 $O$ 分类如下：如果 $A$ 与 $O$ 不同而 $B$ 与 $O$ 相同，则计入 $n_{A}$；如果 $B$ 与 $O$ 不同而 $A$ 与 $O$ 相同，则计入 $n_{B}$；如果 $A$ 和 $B$ 都与 $O$ 相同，则计入 $n_{\\text{shared}}$。观测到的计数为 $n_{A}=120$，$n_{B}=150$，以及 $n_{\\text{shared}}=730$。假设各位点独立进化，并且在这一分化过程中，$A$ 和 $B$ 支系上每个位点的替换足够罕见，以至于位点事件可以建模为独立的伯努利试验，而计数 $n_{A}$ 和 $n_{B}$ 是这些试验的总和。在 $A$–$B$ 分化之后，根据严格分子钟的假说，$A$ 和 $B$ 的支系特异性替换速率是相等的，因此 $A$ 特有差异和 $B$ 特有差异的期望数也相等。\n\n从这些假设出发，且不使用任何现成的检验公式，推导一个用于 Tajima 相对速率检验的合适的标准化正态检验统计量，该检验利用观测到的计数来比较 $A$ 和 $B$ 支系上的速率。然后，使用上述数据计算得出的 $z$ 分数。将您计算的 $z$ 分数四舍五入到3位有效数字。将最终答案表示为一个无单位的数。",
            "solution": "目标是检验严格分子钟的零假设 ($H_0$)，该假设认为在物种分化后，导致分类单元 $A$ 的支系上的替换速率与导致分类单元 $B$ 的支系上的替换速率相等。设 $A$ 支系上每个位点的替换概率为 $p_A$，$B$ 支系上为 $p_B$。问题陈述中提到替换是罕见的，这使我们可以忽略在同一位点上两个支系都发生替换的概率，即 $p_A p_B \\approx 0$。\n\n零假设 $H_0$ 是速率相等，即 $p_A = p_B$。备择假设 ($H_1$) 是速率不相等，即 $p_A \\ne p_B$。\n\n我们感兴趣的是比较在每个支系上累积的替换数量。用于此比较的信息位点是那些恰好在两个支系中的一个上发生了替换的位点。仅有 $A$ 支系与外群 $O$ 不同的位点计数为 $n_A=120$。仅有 $B$ 支系与外群不同的位点计数为 $n_B=150$。此类信息位点的总数为 $N = n_A + n_B$。在本问题中，$N = 120 + 150 = 270$。\n\n让我们考虑单个信息位点。在替换发生在 $A$ 支系或 $B$ 支系上（但不是两者都发生）的假设下，我们想求出替换发生在 $A$ 支系上的条件概率。设 $S_A$ 为 $A$ 支系上发生替换的事件，$S_B$ 为 $B$ 支系上发生替换的事件。观测到一个计入 $n_A$ 的位点的概率是 $P(S_A \\text{ and not } S_B) = p_A(1 - p_B) \\approx p_A$。类似地，观测到一个计入 $n_B$ 的位点的概率是 $P(S_B \\text{ and not } S_A) = p_B(1 - p_A) \\approx p_B$。\n\n在给定它是一个信息位点（即，恰好发生了一次替换）的情况下，替换发生在 $A$ 支系上的条件概率为：\n$$ P(S_A | (S_A \\text{ and not } S_B) \\text{ or } (S_B \\text{ and not } S_A)) = \\frac{p_A(1-p_B)}{p_A(1-p_B) + p_B(1-p_A)} $$\n在零假设 $H_0: p_A = p_B$ 下，我们将这个共同概率称为 $p_s$。该表达式简化为：\n$$ p = \\frac{p_s(1-p_s)}{p_s(1-p_s) + p_s(1-p_s)} = \\frac{p_s(1-p_s)}{2p_s(1-p_s)} = \\frac{1}{2} $$\n因此，在零假设下，$N = n_A + n_B$ 个信息位点中的每一个，其变化是 $A$ 特有或 $B$ 特有的概率相等，均为 $1/2$。这意味着我们可以将计数 $n_A$ 建模为一个服从二项分布的随机变量，其试验次数为 $N$，成功概率为 $p=1/2$。\n$$ n_A \\sim \\text{Binomial}(N, \\frac{1}{2}) $$\n在 $H_0$ 下，$n_A$ 的期望值为：\n$$ E[n_A] = Np = (n_A + n_B) \\times \\frac{1}{2} = \\frac{n_A + n_B}{2} $$\n在 $H_0$ 下，$n_A$ 的方差为：\n$$ \\text{Var}(n_A) = Np(1-p) = (n_A + n_B) \\times \\frac{1}{2} \\times \\frac{1}{2} = \\frac{n_A + n_B}{4} $$\n对于足够大的试验次数 $N$，二项分布可以由正态分布近似。一个标准化的检验统计量，或称 $z$ 分数，其公式为观测值与期望值之差除以标准差。\n$$ z = \\frac{\\text{Observed} - \\text{Expected}}{\\text{Standard Deviation}} = \\frac{n_A - E[n_A]}{\\sqrt{\\text{Var}(n_A)}} $$\n代入期望值和方差的表达式：\n$$ z = \\frac{n_A - \\frac{n_A + n_B}{2}}{\\sqrt{\\frac{n_A + n_B}{4}}} $$\n对表达式进行代数化简：\n$$ z = \\frac{\\frac{2n_A - (n_A + n_B)}{2}}{\\frac{\\sqrt{n_A + n_B}}{2}} = \\frac{n_A - n_B}{\\sqrt{n_A + n_B}} $$\n这就是推导出的用于 Tajima 相对速率检验的检验统计量。现在，我们使用所提供的数据计算其值：$n_A = 120$ 和 $n_B = 150$。\n$$ z = \\frac{120 - 150}{\\sqrt{120 + 150}} = \\frac{-30}{\\sqrt{270}} $$\n为了计算数值：\n$$ \\sqrt{270} = \\sqrt{9 \\times 30} = 3\\sqrt{30} \\approx 16.4316767 $$\n$$ z = \\frac{-30}{16.4316767} \\approx -1.825741858 $$\n问题要求将结果四舍五入到3位有效数字。前三位有效数字是 $1$，$8$ 和 $2$。下一位数字是 $5$，因此我们将最后一位有效数字向上取整。\n$$ z \\approx -1.83 $$\n这个检验统计量的值表明，$B$ 支系上的替换数量高于 $A$ 支系，其差异程度可能在统计上是显著的，具体取决于所选择的显著性水平。",
            "answer": "$$\\boxed{-1.83}$$"
        },
        {
            "introduction": "分子钟研究的一个主要目标是将遗传距离转化为绝对分化时间。在严格分子钟的假设下，从系统发育树的根到任何一个末端（叶尖）的遗传距离都是相等的（即超度量性），这使我们能够利用已知的替换速率将分支长度转换为时间。本练习将向您展示如何利用成对距离数据来重建进化事件的时间顺序，通过在一个简单的三分类单元树上强制执行时钟假设，来计算共同祖先的年龄。",
            "id": "2736532",
            "problem": "给定来自三个分类单元 $A$、$B$ 和一个已知外群 $O$ 的三条已比对的蛋白质编码序列。使用一个拟合良好的、带有位点间速率变异的时间可逆替换模型，您已获得每对分类单元之间每位点期望替换数的无偏估计：\n- $d_{AB} = 0.086$，\n- $d_{AO} = 0.196$，\n- $d_{BO} = 0.204$。\n\n假设存在严格分子钟：沿任何支系，以每位点期望替换数表示的分支长度等于恒定的每单位时间每位点替换速率与所经过时间的乘积。令 $\\mu$ 表示替换速率（每百万年每位点替换数），并假设一项独立的校准给出 $\\mu = 1.25 \\times 10^{-3}$。\n\n从基本原理出发：\n- 树上的两两距离是沿连接两个分类单元的唯一路径累加的。\n- 在严格分子钟下，存在一个根的位置，使得从根到每个末端的路径长度都相同（形成一棵超度量树），并且分支长度等于 $\\mu$ 乘以所经过的时间。\n\n任务：\n1. 仅使用三个分类单元树上距离的可加性和严格分子钟假设，推导出该无根三分类单元树的三条悬挂分支长度（从唯一的内部节点到 $A$、到 $B$ 和到 $O$）。\n2. 展示如何将根置于通往 $O$ 的边上，以使该树成为超度量树，并从基本原理出发论证您定根的位置。如果由于抽样噪音导致两个内群的悬挂分支长度略有差异，请使用严格分子钟通过取其平均值来强制它们相等。\n3. 使用 $\\mu$ 将所得的根到末端路径长度（以每位点期望替换数计）转换为以百万年为单位的绝对根年龄（$O$ 与 $A$、$B$ 的共同祖先之间的分化时间）。\n\n根年龄是多少百万年？将您的最终答案四舍五入到四位有效数字，并以 Myr 为单位表示。",
            "solution": "该问题要求在严格分子钟的假设下，为一个包含分类单元 $A$、$B$ 和一个外群 $O$ 的三分类单元树计算根年龄。\n\n令 $R$ 表示树的根，它对应于所有三个分类单元 $A$、$B$ 和 $O$ 的最近共同祖先 (MRCA)。由于 $O$ 是外群，有根树的拓扑结构是 $((A,B),O)$。令 $N$ 为代表内群分类单元 $A$ 和 $B$ 的 MRCA 的内部节点。因此，树的结构涉及从根 $R$ 出发的三个主要分支：一个通向外群 $O$，另一个在节点 $N$ 处分裂，分别通向分类单元 $A$ 和 $B$。\n\n令 $T$ 为从根 $R$ 到现在的绝对时间（以百万年 Myr 为单位），这是我们要求解的根年龄。令 $t_{AB}$ 为从节点 $N$ 处分化到现在的绝对时间（$t_{AB} < T$）。令 $\\mu$ 为恒定的替换速率，给定为 $\\mu = 1.25 \\times 10^{-3}$ 每百万年每位点替换数。\n\n在严格分子钟模型下，进化树上任何分支的长度（以每位点期望替换数衡量）都是替换速率 $\\mu$ 与该分支所代表的时间区间的乘积。\n\n因此，有根树 $((A,B),O)$ 的分支长度为：\n- 从 $N$ 到 $A$ 的分支：$b_{NA} = \\mu t_{AB}$\n- 从 $N$ 到 $B$ 的分支：$b_{NB} = \\mu t_{AB}$\n- 从 $R$ 到 $N$ 的分支：$b_{RN} = \\mu (T - t_{AB})$\n- 从 $R$ 到 $O$ 的分支：$b_{RO} = \\mu T$\n\n总的根到末端路径长度 $L$ 是从根 $R$ 到任何现存分类单元的遗传距离。对于超度量树，这个距离是恒定的：\n$L = b_{RN} + b_{NA} = \\mu(T - t_{AB}) + \\mu t_{AB} = \\mu T$\n$L = b_{RN} + b_{NB} = \\mu(T - t_{AB}) + \\mu t_{AB} = \\mu T$\n$L = b_{RO} = \\mu T$\n\n这证实了根到末端的距离是 $L = \\mu T$。\n\n分类单元之间的两两距离是沿连接它们的路径累加的。我们可以用分支长度来表示可观察到的两两距离（$d_{AB}$、$d_{AO}$、$d_{BO}$）：\n1.  $A$ 和 $B$ 之间的距离是通过它们的 MRCA, $N$ 连接它们的分支长度之和：\n    $$d_{AB} = b_{NA} + b_{NB} = \\mu t_{AB} + \\mu t_{AB} = 2 \\mu t_{AB}$$\n2.  $A$ 和 $O$ 之间的距离是通过它们的 MRCA, $R$ 连接它们的分支长度之和：\n    $$d_{AO} = b_{NA} + b_{RN} + b_{RO} = \\mu t_{AB} + \\mu(T - t_{AB}) +  \\mu T = 2 \\mu T$$\n3.  类似地，$B$ 和 $O$ 之间的距离是：\n    $$d_{BO} = b_{NB} + b_{RN} + b_{RO} = \\mu t_{AB} + \\mu(T - t_{AB}) + \\mu T = 2 \\mu T$$\n\n严格分子钟模型的一个直接推论是，任何内群分类单元与外群分类单元之间的距离必须相同：$d_{AO} = d_{BO} = 2 \\mu T$。\n\n给定的数据是 $d_{AO} = 0.196$ 和 $d_{BO} = 0.204$。这两个值不相等，这反映了对严格分子钟假设的轻微违背，在问题中归因于抽样噪音。为了强制满足分子钟条件，我们必须使用内群和外群之间真实距离的最佳估计，即观测距离的算术平均值。令这个校正后的距离为 $d_{(AB)O}^*$。\n$$d_{(AB)O}^* = \\frac{d_{AO} + d_{BO}}{2} = \\frac{0.196 + 0.204}{2} = \\frac{0.400}{2} = 0.200$$\n\n这代表了内群 $(A,B)$ 和外群 $O$ 之间经过分子钟校正的距离估计。根据我们的推导，我们有正式关系 $d_{(AB)O}^* = 2 \\mu T$。\n\n量 $\\mu T$ 正是根到末端的路径长度 $L$。因此，我们可以写出：\n$$d_{(AB)O}^* = 2L$$\n我们现在可以解出 $L$：\n$$L = \\frac{d_{(AB)O}^*}{2} = \\frac{0.200}{2} = 0.100$$\n这个值，$L = 0.100$，是以每位点期望替换数为单位的根到末端路径长度。这个结果通过确定超度量树的关键参数，满足了任务1和2的隐含要求。\n\n为了完整起见，我们可以推导出经过分子钟校正的有根树的所有分支长度。\n- 从 $d_{AB} = 2 \\mu t_{AB}$ 和给定的 $d_{AB} = 0.086$，我们找到内群分支的长度：$b_{NA} = b_{NB} = \\mu t_{AB} = \\frac{d_{AB}}{2} = \\frac{0.086}{2} = 0.043$。\n- 通向外群的分支长度是 $b_{RO} = L = 0.100$。\n- 内部自分支的长度是 $b_{RN} = L - b_{NA} = 0.100 - 0.043 = 0.057$。\n\n最后，对于任务3，我们将根到末端的距离 $L$ 转换为绝对根年龄 $T$。我们使用基本的分子钟方程 $L = \\mu T$ 并解出 $T$：\n$$T = \\frac{L}{\\mu}$$\n代入计算出的 $L$ 值和给定的 $\\mu$ 值：\n$$T = \\frac{0.100 \\text{ (substitutions/site)}}{1.25 \\times 10^{-3} \\text{ (substitutions/site/Myr)}}$$\n$$T = \\frac{0.1}{0.00125} \\text{ Myr} = \\frac{100}{1.25} \\text{ Myr} = 80 \\text{ Myr}$$\n根年龄，即外群 $O$ 与 $A$、$B$ 的共同祖先之间的分化时间，恰好是 80 百万年。\n\n问题要求答案四舍五入到四位有效数字。因此，最终答案是 $80.00$ Myr。",
            "answer": "$$\\boxed{80.00}$$"
        }
    ]
}