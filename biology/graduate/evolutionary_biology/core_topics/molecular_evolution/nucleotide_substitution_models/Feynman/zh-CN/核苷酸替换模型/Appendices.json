{
    "hands_on_practices": [
        {
            "introduction": "理解进化距离的估计是系统发育分析的基石。本练习将带您从第一性原理出发，推导最简单的核苷酸替换模型——Jukes-Cantor (JC69) 模型的距离估计器。通过这个过程，您将深入理解如何将一个连续时间马尔可夫链模型与观察到的序列差异联系起来，并体会多重替换修正的必要性与数学原理。",
            "id": "2739950",
            "problem": "两条长度为 $n$ 的同源脱氧核糖核酸（DNA）序列从一个共同祖先进化而来，其遵循 Jukes-Cantor 1969 (JC69) 连续时间马尔可夫链 (CTMC) 核苷酸替换模型。JC69 生成（速率）矩阵为 $Q$，其非对角线元素为 $Q_{ij}=\\alpha$（当 $i\\neq j$），对角线元素为 $Q_{ii}=-3\\alpha$，其中 $\\alpha>0$ 且在 4 种核苷酸上的平稳分布是均匀的。假设各位点独立同分布地进化，并且分开这两条序列的两个谱系具有相同的替换过程参数且是时间均匀的。\n\n设两条序列之间的总进化路径长度用分支长度 $d$ 来衡量，$d$ 定义为在分开这两条序列的组合路径上，每位点累积的预期替换数。一次经验比对在 $n$ 个位点中产生了 $k$ 个观测到的汉明差异计数，因此观测到的差异比例为 $p=k/n$。\n\n仅从 CTMC 定义和 JC69 生成矩阵 $Q$ 出发（并且不使用任何预先推导出的转移概率公式），执行以下操作：\n\n- 通过对角化 $Q$ 来推导转移概率矩阵 $P(t)=\\exp(Qt)$，并利用半群性质将两个在末端采样的同源核苷酸不同的概率表示为 $d$ 的函数。\n- 使用二项抽样模型对 $n$ 个位点上的位点模式计数进行建模，写出在给定观测值 $p$ 的情况下 $d$ 的似然函数，并推导出最大似然估计量 $\\hat{d}$ 作为 $p$ 的显式函数。\n- 确定使 $\\hat{d}$ 为实值且有限的 $p$ 的定义域，并描述其边界行为。\n- 对真实差异概率使用二阶 Delta 方法，获得有限样本偏差 $\\operatorname{Bias}(\\hat{d})$ 的主导阶（$1/n$ 阶）表达式，作为 $d$ 和 $n$ 的函数，并说明其在 $d>0$ 时的符号。\n\n仅提供估计量 $\\hat{d}$ 的解析表达式作为最终答案。不包含任何单位。无需四舍五入。",
            "solution": "该问题陈述构成了一个在理论分子进化领域中定义明确且具有科学依据的练习。它包含了所有必要信息，内部一致，并探讨了一个基本概念：在 Jukes-Cantor 1969 模型下从序列数据估计进化距离。因此，我们可以着手进行推导。\n\nJukes-Cantor 1969 (JC69) 模型由瞬时速率矩阵 $Q$ 定义。对于由 4 种核苷酸 $\\{A, C, G, T\\}$ 组成的状态空间，矩阵 $Q$ 的元素为 $Q_{ij} = \\alpha$（对于任何不同的状态 $i, j$）和 $Q_{ii} = -3\\alpha$。参数 $\\alpha > 0$ 是替换为任意一个特定不同核苷酸的速率。矩阵 $Q$可以写作：\n$$\nQ = \\begin{pmatrix} -3\\alpha & \\alpha & \\alpha & \\alpha \\\\ \\alpha & -3\\alpha & \\alpha & \\alpha \\\\ \\alpha & \\alpha & -3\\alpha & \\alpha \\\\ \\alpha & \\alpha & \\alpha & -3\\alpha \\end{pmatrix}\n$$\n这可以使用 $4 \\times 4$ 的单位矩阵 $I$ 和 $4 \\times 4$ 的全1矩阵 $J$ 来紧凑地表示。具体来说，$Q = \\alpha J - 4\\alpha I = \\alpha(J - 4I)$。\n\n首先，我们推导转移概率矩阵 $P(t) = \\exp(Qt)$。为此，我们对 $Q$ 进行对角化。$J$ 的特征值为 $4$（重数为 $1$，对应于特征向量 $\\mathbf{1} = (1, 1, 1, 1)^T$）和 $0$（重数为 $3$）。因此 $Q$ 的特征值为 $\\lambda_1 = \\alpha(4 - 4) = 0$ 和 $\\lambda_2 = \\alpha(0 - 4) = -4\\alpha$（重数为 $3$）。\n\n由于 $I$ 和 $J$ 可交换，我们可以写出 $\\exp(Qt) = \\exp(\\alpha Jt - 4\\alpha It) = \\exp(\\alpha Jt)\\exp(-4\\alpha It)$。第二项就是 $\\exp(-4\\alpha t)I$。对于第一项，我们使用矩阵指数的泰勒级数展开。我们注意到当 $k \\ge 1$ 时，$J^k = 4^{k-1}J$。\n$$\n\\exp(\\alpha Jt) = I + \\sum_{k=1}^{\\infty} \\frac{(\\alpha t)^k J^k}{k!} = I + \\sum_{k=1}^{\\infty} \\frac{(\\alpha t)^k 4^{k-1} J}{k!} = I + \\frac{J}{4} \\sum_{k=1}^{\\infty} \\frac{(4\\alpha t)^k}{k!} = I + \\frac{J}{4}(\\exp(4\\alpha t) - 1)\n$$\n合并各项，我们得到转移矩阵 $P(t)$：\n$$\nP(t) = \\left( I + \\frac{J}{4}(\\exp(4\\alpha t) - 1) \\right) \\exp(-4\\alpha t) = \\exp(-4\\alpha t)I + \\frac{1}{4}(1 - \\exp(-4\\alpha t))J\n$$\n从这个表达式，我们可以写出任意核苷酸保持不变的概率 $P_{ii}(t)$，或变为某一特定不同核苷酸的概率 $P_{ij}(t)$ ($i \\neq j$)：\n$$\nP_{ii}(t) = \\exp(-4\\alpha t) + \\frac{1}{4}(1 - \\exp(-4\\alpha t)) = \\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha t)\n$$\n$$\nP_{ij}(t) = \\frac{1}{4}(1 - \\exp(-4\\alpha t)) \\quad (i \\neq j)\n$$\n\n接下来，我们求在两个谱系末端的两个同源核苷酸不同的概率 $p_d$。这两个谱系从一个共同祖先分化开来，各自演化了时间 $t$。假设过程从根部的平稳分布 $\\pi = (\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})^T$ 开始。根据在祖先状态条件下两个谱系的独立性，在两个末端观察到相同核苷酸 $i$ 的概率是：\n$$\nP(\\text{same } i) = \\sum_{k=A,C,G,T} \\pi_k P_{ki}(t) P_{ki}(t) = \\frac{1}{4}\\sum_{k=A,C,G,T} (P_{ki}(t))^2\n$$\n由于 JC69 模型的对称性，这个和与 $i$ 无关。让我们对某个 $i_0$ 计算它：\n$$\n\\sum_{k} (P_{ki_0}(t))^2 = (P_{i_0 i_0}(t))^2 + 3(P_{j i_0}(t))^2 \\quad (j \\neq i_0)\n$$\n代入 $P_{ii}(t)$ 和 $P_{ij}(t)$ 的表达式：\n$$\n\\sum_{k} (P_{ki_0}(t))^2 = \\left(\\frac{1}{4} + \\frac{3}{4}e^{-4\\alpha t}\\right)^2 + 3\\left(\\frac{1}{4} - \\frac{1}{4}e^{-4\\alpha t}\\right)^2 = \\frac{1}{16} \\left[ (1+6e^{-4\\alpha t}+9e^{-8\\alpha t}) + 3(1-2e^{-4\\alpha t}+e^{-8\\alpha t}) \\right]\n$$\n$$\n= \\frac{1}{16} [1+6e^{-4\\alpha t}+9e^{-8\\alpha t} + 3-6e^{-4\\alpha t}+3e^{-8\\alpha t}] = \\frac{1}{16}[4+12e^{-8\\alpha t}] = \\frac{1}{4}(1+3e^{-8\\alpha t})\n$$\n两个位点相同的总概率是所有四种可能的相同状态的概率之和：\n$$\nP(\\text{same}) = \\sum_{i=A,C,G,T} P(\\text{same } i) = 4 \\times \\left( \\frac{1}{4} \\cdot \\frac{1}{4}(1+3e^{-8\\alpha t}) \\right) = \\frac{1}{4}(1+3e^{-8\\alpha t})\n$$\n因此，位点不同的概率 $p_d$ 是：\n$$\np_d = 1 - P(\\text{same}) = 1 - \\frac{1}{4}(1+3e^{-8\\alpha t}) = \\frac{3}{4} - \\frac{3}{4}e^{-8\\alpha t} = \\frac{3}{4}(1 - \\exp(-8\\alpha t))\n$$\n进化距离 $d$ 定义为沿组合路径上每位点的预期替换数。从任意状态替换出去的速率是 $-Q_{ii} = 3\\alpha$。沿着一个时间为 $t$ 的分支的预期替换数是 $3\\alpha t$。两个这样分支的总距离是 $d = 3\\alpha t + 3\\alpha t = 6\\alpha t$。由此，我们有 $\\alpha t = d/6$，所以 $8\\alpha t = 4d/3$。将此代入 $p_d$ 的表达式中：\n$$\np_d = f(d) = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{4}{3}d\\right)\\right)\n$$\n\n现在我们推导 $d$ 的最大似然估计量 (MLE)。长度为 $n$ 的比对中观测到的差异数 $k$ 被建模为一个二项随机变量，$k \\sim \\text{Binomial}(n, p_d)$。似然函数为 $L(d; k, n) \\propto p_d^k (1-p_d)^{n-k}$。二项比例参数 $p_d$ 的 MLE 是观测到的差异比例 $\\hat{p}_d = k/n = p$。根据 MLE 的不变性，$d$ 的 MLE（记为 $\\hat{d}$）可以通过对函数 $f(d)$ 求逆并在 $p$ 处求值得到。\n$$\np = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{4}{3}\\hat{d}\\right)\\right)\n$$\n$$\n\\frac{4}{3}p = 1 - \\exp\\left(-\\frac{4}{3}\\hat{d}\\right)\n$$\n$$\n\\exp\\left(-\\frac{4}{3}\\hat{d}\\right) = 1 - \\frac{4}{3}p\n$$\n$$\n-\\frac{4}{3}\\hat{d} = \\ln\\left(1 - \\frac{4}{3}p\\right)\n$$\n$$\n\\hat{d} = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}p\\right)\n$$\n这个表达式就是所求的 Jukes-Cantor 距离的最大似然估计量。\n\n估计量 $\\hat{d}$ 是实值且有限的，条件是对数的参数为正：$1 - \\frac{4}{3}p > 0$，这意味着 $p < \\frac{3}{4}$。由于观测比例 $p$ 是非负的，定义域是 $p \\in [0, \\frac{3}{4})$。\n在边界 $p \\to 0^+$ 处，$\\hat{d} \\to -\\frac{3}{4}\\ln(1) = 0$。\n在边界 $p \\to (\\frac{3}{4})^-$ 处，对数的参数趋近于 $0^+$，所以 $\\ln(\\cdot) \\to -\\infty$，且 $\\hat{d} \\to +\\infty$。这表明发生了突变饱和。\n\n最后，我们使用二阶 Delta 方法分析有限样本偏差。令 $g(p) = \\hat{d}(p)$。偏差近似为 $\\text{Bias}(\\hat{d}) \\approx \\frac{1}{2} \\text{Var}(p) g''(p_d)$，其中 $p_d$ 是真实的差异概率。样本比例 $p$ 的方差是 $\\text{Var}(p) = \\frac{p_d(1-p_d)}{n}$。导数为：\n$$\ng'(p) = \\frac{1}{1 - \\frac{4}{3}p} \\quad \\text{and} \\quad g''(p) = \\frac{4}{3}\\left(1 - \\frac{4}{3}p\\right)^{-2}\n$$\n由于 $p_d \\in [0, \\frac{3}{4})$，显然对于所有有效的 $p_d$，$g''(p_d) > 0$。那么偏差是：\n$$\n\\operatorname{Bias}(\\hat{d}) \\approx \\frac{1}{2} \\frac{p_d(1-p_d)}{n} \\frac{4}{3} \\frac{1}{(1 - \\frac{4}{3}p_d)^2} = \\frac{2}{3n} \\frac{p_d(1-p_d)}{(1 - \\frac{4}{3}p_d)^2}\n$$\n对于任意 $d>0$，我们有 $p_d \\in (0, \\frac{3}{4})$，这意味着 $p_d > 0$ 和 $1-p_d > 0$。对于任意有限的 $n$，表达式中的所有项都是正的。因此，对于 $d > 0$，主导阶偏差为正，这意味着对于有限的样本量，MLE $\\hat{d}$ 倾向于高估真实距离 $d$。这是琴生不等式应用于凸函数 $g(p)$ 的一个结果。",
            "answer": "$$\\boxed{-\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}p\\right)}$$"
        },
        {
            "introduction": "真实的进化过程很少像 Jukes-Cantor 模型那样简单。本练习将引导您使用更实际的 Hasegawa-Kishino-Yano (HKY) 模型，通过计算特定替换类型的瞬时速率之比，来具体化模型参数的生物学意义。这个计算能帮助您直观地理解转换/颠换偏好（$\\kappa$）和碱基组成偏好（$\\pi_i$）是如何共同作用，从而塑造了我们观察到的替换模式。",
            "id": "1951135",
            "problem": "一位进化生物学家正在分析来自一种嗜热古菌的特定非编码基因组区域。已知该区域承受着强烈的选择压力，这导致了有偏的核苷酸组成。通过对相关物种该区域的系统发育分析，该生物学家确定其替换模式最适合用核苷酸进化的Hasegawa-Kishino-Yano (HKY)模型来描述。\n\nHKY模型的特征在于一个总体突变率 $\\mu$、一组平衡碱基频率 $\\{\\pi_A, \\pi_C, \\pi_G, \\pi_T\\}$，以及一个代表转换率与颠换率之比的参数 $\\kappa$。对于任意两个不同的核苷酸 $i, j \\in \\{A, C, G, T\\}$，从 $i$ 到 $j$ 的瞬时替换率（记作 $Q_{ij}$）与目标核苷酸 $\\pi_j$ 的平衡频率成正比。对于转换（嘌呤 $\\{A,G\\}$ 之间或嘧啶 $\\{C,T\\}$ 之间的替换）和颠换（嘌呤与嘧啶之间的替换），其比例常数是不同的。\n\n为该基因组区域找到的最佳拟合参数为：\n- 平衡碱基频率：$\\pi_A = 0.10, \\pi_C = 0.40, \\pi_G = 0.40, \\pi_T = 0.10$。\n- 转换/颠换率之比：$\\kappa = 5.0$。\n\n为了更好地理解其中的进化动态，该生物学家希望比较从一个腺嘌呤（A）核苷酸开始的两种不同潜在突变的相对可能性。计算从A到G替换的瞬时速率与从A到T替换的瞬时速率之比的精确数值。换句话说，计算 $\\frac{Q_{AG}}{Q_{AT}}$ 的值。",
            "solution": "该问题要求在Hasegawa-Kishino-Yano (HKY)模型下，计算两个瞬时替换率之比 $\\frac{Q_{AG}}{Q_{AT}}$。\n\n首先，我们必须回顾HKY替换率矩阵 $Q$ 的非对角线元素的定义。对于从核苷酸 $i$ 到核苷酸 $j$（其中 $i \\neq j$）的替换，其速率 $Q_{ij}$ 由以下公式给出：\n- 如果替换 $i \\to j$ 是转换，则 $Q_{ij} = \\mu \\kappa \\pi_j$。\n- 如果替换 $i \\to j$ 是颠换，则 $Q_{ij} = \\mu \\pi_j$。\n\n在这里，$\\mu$ 是突变率的总体缩放因子，$\\kappa$ 是转换/颠换率之比，$\\pi_j$ 是目标核苷酸 $j$ 的平衡频率。\n\n接下来，我们需要将我们关心的两种替换，即 A $\\to$ G 和 A $\\to$ T，分类为转换或颠换。\n嘌呤集合为 $\\{A, G\\}$，嘧啶集合为 $\\{C, T\\}$。\n- 替换 A $\\to$ G 是从一个嘌呤变为另一个嘌呤。根据定义，这是一种**转换**。\n- 替换 A $\\to$ T 是从一个嘌呤变为一个嘧啶。根据定义，这是一种**颠换**。\n\n现在，我们可以使用HKY模型公式写出速率 $Q_{AG}$ 和 $Q_{AT}$ 的显式表达式。\n- 对于转换 A $\\to$ G，目标核苷酸是 G。使用转换公式，速率为：\n$$ Q_{AG} = \\mu \\kappa \\pi_G $$\n- 对于颠换 A $\\to$ T，目标核苷酸是 T。使用颠换公式，速率为：\n$$ Q_{AT} = \\mu \\pi_T $$\n\n问题要求计算比率 $\\frac{Q_{AG}}{Q_{AT}}$。我们现在可以使用上面推导出的表达式来构建这个比率：\n$$ \\frac{Q_{AG}}{Q_{AT}} = \\frac{\\mu \\kappa \\pi_G}{\\mu \\pi_T} $$\n\n总体速率缩放因子 $\\mu$ 同时存在于分子和分母中，因此可以消去：\n$$ \\frac{Q_{AG}}{Q_{AT}} = \\frac{\\kappa \\pi_G}{\\pi_T} $$\n\n最后，我们将给定的参数值代入这个表达式。问题陈述如下：\n- $\\kappa = 5.0$\n- $\\pi_G = 0.40$\n- $\\pi_T = 0.10$\n\n将这些值代入我们的比率方程中：\n$$ \\frac{Q_{AG}}{Q_{AT}} = \\frac{(5.0) \\times (0.40)}{0.10} $$\n$$ \\frac{Q_{AG}}{Q_{AT}} = \\frac{2.0}{0.10} $$\n$$ \\frac{Q_{AG}}{Q_{AT}} = 20 $$\n\n从A到G替换的瞬时速率与从A到T替换的瞬时速率之比为20。这表明，对于这个特定的基因组区域，在任何给定瞬间，发生从A到G的转换的可能性是发生从A到T的颠换的20倍。",
            "answer": "$$\\boxed{20}$$"
        },
        {
            "introduction": "在基于模型的系统发育学中，核心任务是在给定一棵树和一个模型的情况下计算观察数据的似然值。本练习将让您亲手实践 Felsenstein 的剪枝算法（pruning algorithm），这是现代系统发育分析的计算核心。通过在一个具体的四分类单元树上计算单个位点的似然值，您将掌握如何将替换模型、分支长度和序列数据结合起来，为模型选择和拓扑推断奠定基础。",
            "id": "2739922",
            "problem": "考虑一个在 Hasegawa–Kishino–Yano 1985 (HKY85) 核苷酸替换模型下演化的四分类单元系统发育。假设这是一个连续时间、时齐马尔可夫过程，其平稳碱基频率为 $\\pi_A=\\pi_C=\\pi_G=\\pi_T=0.25$，转换/颠换速率比为 $\\kappa=3$。瞬时速率矩阵 $Q=(q_{ij})$ 的非对角线元素对于嘌呤-嘌呤或嘧啶-嘧啶的转换为 $q_{ij}=\\mu\\,\\kappa\\,\\pi_j$，对于颠换为 $q_{ij}=\\mu\\,\\pi_j$，对角线元素的选择应使每行之和为 $0$。设定总体速率标量 $\\mu$，使得在平稳状态下的期望替换率为 $1$，分支长度以每位点的期望替换数来度量。\n\n无根树拓扑结构为 $((1,2),(3,4))$。叶分支长度分别为：到分类单元 $1$ 的 $t_1=0.3$，到分类单元 $2$ 的 $t_2=0.4$，到分类单元 $3$ 的 $t_3=0.2$，到分类单元 $4$ 的 $t_4=0.5$。连接两个内部节点的内部分支长度为 $t_5=0.1$。在叶节点上，观测到的位点模式为 $1{:}\\,A$, $2{:}\\,G$, $3{:}\\,A$, $4{:}\\,G$。\n\n使用 Felsenstein 的剪枝算法，将根节点置于内部分支的中点（因此从根到两个内部节点的两条边的长度均为 $t_5/2$），并在根节点处使用平稳先验 $\\pi$，计算在该 HKY85 模型下此单位点的位点似然。您的计算必须：\n- 从 HKY85 $Q$ 矩阵的定义及其标度约束开始。\n- 使用由 $Q$ 决定的每个分支上的隐含转换概率。\n- 在根节点进行求和之前，明确展示两个内部节点的部分似然向量的数值，以及从这些节点发出的两个向根“信息”的数值。\n\n将您最终的位点似然值四舍五入到六位有效数字。将最终答案表示为不带单位的纯数。",
            "solution": "问题陈述经过严格评估，被确定为有效。它在科学上基于分子演化的原理，特别是 HKY85 模型和 Felsenstein 的剪枝算法。该问题设定良好，为求得唯一解提供了所有必要的参数、数据和约束条件。语言客观而精确。\n\n该问题要求针对给定的系统发育树和观测到的核苷酸数据计算位点似然。该过程包括几个步骤：定义速率矩阵、计算转换概率以及应用剪枝算法。\n\n首先，我们构建 HKY85 模型的瞬时速率矩阵 $Q=(q_{ij})$。平稳碱基频率是均匀的：$\\pi_A=\\pi_C=\\pi_G=\\pi_T=0.25$。转换/颠换速率比为 $\\kappa=3$。非对角线元素对于转换（嘌呤-嘌呤或嘧啶-嘧啶）为 $q_{ij}=\\mu\\,\\kappa\\,\\pi_j$，对于颠换为 $q_{ij}=\\mu\\,\\pi_j$。\n变化速率为：\n转换速率 ($A \\leftrightarrow G$, $C \\leftrightarrow T$): $\\mu \\kappa \\pi_j = \\mu \\cdot 3 \\cdot 0.25 = 0.75\\mu$。\n颠换速率 (所有其他情况): $\\mu \\pi_j = \\mu \\cdot 0.25 = 0.25\\mu$。\n对角线元素 $q_{ii}$ 由行和为零的要求定义：$q_{ii} = -\\sum_{j\\neq i} q_{ij}$。对于任何碱基 $i$，可能发生一次转换和两次颠换。例如，从 $A$ 出发，可能转换为 $G$，颠换为 $C$ 和 $T$。\n因此， $q_{AA} = -(q_{AC}+q_{AG}+q_{AT}) = -(\\mu\\pi_C + \\mu\\kappa\\pi_G + \\mu\\pi_T) = -\\mu(0.25 + 3 \\cdot 0.25 + 0.25) = -1.25\\mu$。\n由于平稳频率的对称性，所有对角线元素都相同。\n速率标量 $\\mu$ 的设定使得每位点的期望替换数为 $1$。该速率计算如下：$-\\sum_i \\pi_i q_{ii} = -\\sum_i 0.25(-1.25\\mu) = 4 \\cdot 0.25 \\cdot 1.25\\mu = 1.25\\mu$。\n令 $1.25\\mu=1$，得到 $\\mu = 1/1.25 = 0.8$。\n将 $\\mu=0.8$ 代入速率计算：\n转换速率：$0.75 \\cdot 0.8 = 0.6$。\n颠换速率：$0.25 \\cdot 0.8 = 0.2$。\n对角线速率：$-1.25 \\cdot 0.8 = -1$。\n标度后的速率矩阵 $Q$，碱基顺序为 $(A, C, G, T)$，是：\n$$\nQ = \\begin{pmatrix} -1 & 0.2 & 0.6 & 0.2 \\\\ 0.2 & -1 & 0.2 & 0.6 \\\\ 0.6 & 0.2 & -1 & 0.2 \\\\ 0.2 & 0.6 & 0.2 & -1 \\end{pmatrix}\n$$\n长度为 $t$ 的分支的转换概率矩阵为 $P(t) = \\exp(Qt)$。对于这种特定形式的 $Q$（K2P，HKY85 的一个特例），概率可以通过谱分解来计算。$Q$ 的特征值为 $\\lambda_0=0$, $\\lambda_1=-0.8$ 和 $\\lambda_2=-1.6$（重数为 $2$）。替换概率为：\n$p_1(t) \\equiv P_{ii}(t) = 0.25 + 0.25 \\exp(-0.8 t) + 0.5 \\exp(-1.6 t)$ (无变化)\n$p_s(t) \\equiv P_{ij}(t)_{\\text{transition}} = 0.25 + 0.25 \\exp(-0.8 t) - 0.5 \\exp(-1.6 t)$\n$p_v(t) \\equiv P_{ij}(t)_{\\text{transversion}} = 0.25 - 0.25 \\exp(-0.8 t)$\n\n剪枝算法在有根树上执行。根节点 $R$ 位于内部分支的中点，从而创建了两个内部节点，$N_5$（叶节点 $1, 2$ 的祖先）和 $N_6$（叶节点 $3, 4$ 的祖先）。分支长度为 $t_{R,N_5} = t_{R,N_6} = t_5/2 = 0.05$。其他分支长度为 $t_1=0.3$, $t_2=0.4$, $t_3=0.2$, $t_4=0.5$。观测数据为 $S_1=A, S_2=G, S_3=A, S_4=G$。\n\n在节点 $k$ 处的部分似然向量 $L_k = (L_k(A), L_k(C), L_k(G), L_k(T))^T$ 给出在以 $k$ 处状态为条件的、由 $k$ 延伸出的子树中的观测数据的概率。\n在叶节点处，$L_i(S) = \\delta_{S,S_i}$。\n$L_1=(1,0,0,0)^T$, $L_2=(0,0,1,0)^T$, $L_3=(1,0,0,0)^T$, $L_4=(0,0,1,0)^T$。\n\n内部节点 $N_5$ 的部分似然向量由其子节点（叶节点 $1$ 和 $2$）计算得出。对于 $N_5$ 处的某个状态 $S \\in \\{A,C,G,T\\}$：\n$L_{N_5}(S) = (\\sum_{S_1} P_{SS_1}(t_1)L_1(S_1)) \\cdot (\\sum_{S_2} P_{SS_2}(t_2)L_2(S_2)) = P_{SA}(t_1=0.3) \\cdot P_{SG}(t_2=0.4)$。\n我们计算 $t=0.3$ 和 $t=0.4$ 时的概率：\n$p_1(0.3) \\approx 0.75605$, $p_s(0.3) \\approx 0.13726$, $p_v(0.3) \\approx 0.05334$\n$p_1(0.4) \\approx 0.69518$, $p_s(0.4) \\approx 0.16789$, $p_v(0.4) \\approx 0.06846$\n$L_{N_5}(A) = p_1(0.3) p_s(0.4) \\approx 0.12693$\n$L_{N_5}(C) = p_v(0.3) p_v(0.4) \\approx 0.00365$\n$L_{N_5}(G) = p_s(0.3) p_1(0.4) \\approx 0.09542$\n$L_{N_5}(T) = p_v(0.3) p_v(0.4) \\approx 0.00365$\n因此，节点 $N_5$ 处的部分似然向量为 $L_{N_5} \\approx (0.12693, 0.00365, 0.09542, 0.00365)^T$。\n\n同理，对于具有子节点（叶节点 $3$ 和 $4$）的节点 $N_6$：\n$L_{N_6}(S) = P_{SA}(t_3=0.2) \\cdot P_{SG}(t_4=0.5)$。\n$t=0.2$ 和 $t=0.5$ 时的概率：\n$p_1(0.2) \\approx 0.82611$, $p_s(0.2) \\approx 0.09996$, $p_v(0.2) \\approx 0.03696$\n$p_1(0.5) \\approx 0.64224$, $p_s(0.5) \\approx 0.19292$, $p_v(0.5) \\approx 0.08242$\n$L_{N_6}(A) = p_1(0.2) p_s(0.5) \\approx 0.15936$\n$L_{N_6}(C) = p_v(0.2) p_v(0.5) \\approx 0.00305$\n$L_{N_6}(G) = p_s(0.2) p_1(0.5) \\approx 0.06420$\n$L_{N_6}(T) = p_v(0.2) p_v(0.5) \\approx 0.00305$\n节点 $N_6$ 处的部分似然向量为 $L_{N_6} \\approx (0.15936, 0.00305, 0.06420, 0.00305)^T$。\n\n接下来，我们计算从节点 $N_5$ 和 $N_6$ 到根节点 $R$ 的“信息”。分支长度为 $t=0.05$。\n从 $N_5$ 发出、对应于根处状态 $S_R$ 的信息是 $M_{N_5 \\to R}(S_R) = \\sum_{S_5} P_{S_R S_5}(0.05) L_{N_5}(S_5)$。\n$t=0.05$ 时的概率：$p_1(0.05) \\approx 0.95175$, $p_s(0.05) \\approx 0.02865$, $p_v(0.05) \\approx 0.00980$。\n$M_{N_5 \\to R}(A) = p_1(0.05)L_{N_5}(A) + p_s(0.05)L_{N_5}(G) + p_v(0.05)(L_{N_5}(C)+L_{N_5}(T)) \\approx 0.12361$\n$M_{N_5 \\to R}(G) = p_s(0.05)L_{N_5}(A) + p_1(0.05)L_{N_5}(G) + p_v(0.05)(L_{N_5}(C)+L_{N_5}(T)) \\approx 0.09453$\n$M_{N_5 \\to R}(C) = p_v(0.05)(L_{N_5}(A)+L_{N_5}(G)) + p_1(0.05)L_{N_5}(C) + p_s(0.05)L_{N_5}(T) \\approx 0.00576$\n$M_{N_5 \\to R}(T) = p_v(0.05)(L_{N_5}(A)+L_{N_5}(G)) + p_s(0.05)L_{N_5}(C) + p_1(0.05)L_{N_5}(T) \\approx 0.00576$\n从 $N_5$ 发出的向根信息为 $M_{N_5 \\to R} \\approx (0.12361, 0.00576, 0.09453, 0.00576)^T$。\n\n从 $N_6$ 发出的信息是 $M_{N_6 \\to R}(S_R) = \\sum_{S_6} P_{S_R S_6}(0.05) L_{N_6}(S_6)$。\n$M_{N_6 \\to R}(A) = p_1(0.05)L_{N_6}(A) + p_s(0.05)L_{N_6}(G) + p_v(0.05)(L_{N_6}(C)+L_{N_6}(T)) \\approx 0.15357$\n$M_{N_6 \\to R}(G) = p_s(0.05)L_{N_6}(A) + p_1(0.05)L_{N_6}(G) + p_v(0.05)(L_{N_6}(C)+L_{N_6}(T)) \\approx 0.06572$\n$M_{N_6 \\to R}(C) = p_v(0.05)(L_{N_6}(A)+L_{N_6}(G)) + p_1(0.05)L_{N_6}(C) + p_s(0.05)L_{N_6}(T) \\approx 0.00518$\n$M_{N_6 \\to R}(T) = p_v(0.05)(L_{N_6}(A)+L_{N_6}(G)) + p_s(0.05)L_{N_6}(C) + p_1(0.05)L_{N_6}(T) \\approx 0.00518$\n从 $N_6$ 发出的向根信息为 $M_{N_6 \\to R} \\approx (0.15357, 0.00518, 0.06572, 0.00518)^T$。\n\n最后，总似然是所有根状态 $S_R$ 的总和，并由先验概率 $\\pi(S_R)=0.25$ 加权：\n$L = \\sum_{S_R} \\pi(S_R) M_{N_5 \\to R}(S_R) M_{N_6 \\to R}(S_R)$。\n$L = 0.25 \\times [M_{N_5 \\to R}(A)M_{N_6 \\to R}(A) + M_{N_5 \\to R}(C)M_{N_6 \\to R}(C) + M_{N_5 \\to R}(G)M_{N_6 \\to R}(G) + M_{N_5 \\to R}(T)M_{N_6 \\to R}(T)]$\n$L \\approx 0.25 \\times [(0.12361)(0.15357) + (0.00576)(0.00518) + (0.09453)(0.06572) + (0.00576)(0.00518)]$\n$L \\approx 0.25 \\times [0.018983 + 0.000030 + 0.006212 + 0.000030] = 0.25 \\times 0.025255$\n$L \\approx 0.00631375$\n\n四舍五入到六位有效数字，位点似然为 $0.00631375$。更高精度的计算给出 $L \\approx 0.00631373$。\n最终答案是 $0.00631373$。",
            "answer": "$$\\boxed{0.00631373}$$"
        }
    ]
}