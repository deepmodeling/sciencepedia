{
    "hands_on_practices": [
        {
            "introduction": "费雪失控选择机制的核心在于雄性饰品性状与雌性偏好之间的遗传相关性。本练习将深入探讨这一核心，通过建立模型来揭示选择性交配如何逐步构建起关键的遗传协方差（$G_{zy}$），同时重组又如何削弱它。通过这个练习，你将亲手计算驱动正反馈循环所需“燃料”的产生过程。",
            "id": "2713639",
            "problem": "考虑一个经典的费雪式失控框架，其中有两个性别限制的数量性状：一个仅在雄性中表达的雄性展示性状 $z$ 和一个仅在雌性中表达的雌性偏好 $y$。设加性遗传方差-协方差矩阵为\n$$\n\\mathbf{G} \\equiv \n\\begin{pmatrix}\nG_{zz} & G_{zy} \\\\\nG_{yz} & G_{yy}\n\\end{pmatrix},\n$$\n其中 $G_{zy} = G_{yz}$ 代表了因控制 $z$ 和 $y$ 的基因座之间的连锁不平衡 (LD)而产生的加性遗传协方差。假设选择是弱的，且存在许多非连锁基因座，因此多变量育种家方程对其均值向量 $\\boldsymbol{\\bar{g}} \\equiv (\\bar{z}, \\bar{y})^{\\top}$ 以其标准形式成立，\n$$\n\\Delta \\boldsymbol{\\bar{g}} = \\mathbf{G} \\, \\boldsymbol{\\beta},\n$$\n其中 $\\boldsymbol{\\beta} \\equiv (\\beta_{z}, \\beta_{y})^{\\top}$ 是定向选择梯度向量，且 $\\beta_{y} = 0$（当前代对偏好没有直接选择），而 $\\beta_{z}$ 是任意的，但由对 $z$ 的生存能力选择和性选择所固定。\n\n第 (i) 部分：仅使用育种家方程和相关响应的定义，明确展示当 $\\beta_{y} = 0$ 时，设置 $G_{zy} = 0$ 如何消除了 $y$ 对 $z$ 上选择的即时（单代）相关响应。\n\n第 (ii) 部分：现在引入配偶选择，它在 $z$ 和 $y$ 之间产生表型选型交配。假设一个弱偏好交配核，使得每一代中，强度为 $a$ 的选型交配会诱导新的性状间连锁不平衡，为加性遗传协方差 $G_{zy}$ 贡献一个源项 $a \\, V_{z} V_{y}$，其中 $V_{z} \\equiv G_{zz}$ 和 $V_{y} \\equiv G_{yy}$ 分别表示 $z$ 和 $y$ 的加性遗传方差（在所考虑的短时间内视为常数）。重组和分离以每代 $\\rho$ 的比例速率削弱性状间的连锁不平衡。在许多非连锁基因座和弱选型交配的这些标准假设下，协方差的预期每代递归关系为\n$$\nG_{zy}(t+1) \\;=\\; (1 - \\rho)\\, G_{zy}(t) \\;+\\; a \\, V_{z} V_{y},\n$$\n初始条件为 $G_{zy}(0) = 0$。\n\n取参数值为 $V_{z} = 1$，$V_{y} = 1$，$\\rho = \\tfrac{1}{2}$，以及 $a = \\tfrac{1}{75}$。计算使 $G_{zy}(t) \\geq 0.02$ 成立的最小整数代数 $t$。以整数代数报告您的答案。在最终的方框答案中不要包含单位。除了确定满足不等式的最小整数外，不需要进行舍入。",
            "solution": "所给出的问题是数量演化遗传学中的一个标准练习，具体涉及通过费雪式“失控”过程实现的性选择动态。该框架基于多变量育种家方程和遗传协方差的递归关系，这两者都是 Lande 和 Kirkpatrick 所发展理论的基石。该问题具有科学依据，是良定的，并包含得出唯一解所需的所有信息。因此，它被认为是有效的，我们继续进行分析。\n\n问题分为两部分。我们将按顺序解决它们。\n\n第 (i) 部分：证明遗传协方差在相关响应中的作用。\n\n在选择作用下，平均表型向量 $\\boldsymbol{\\bar{g}} = (\\bar{z}, \\bar{y})^{\\top}$ 的演化变化由多变量育种家方程给出：\n$$\n\\Delta \\boldsymbol{\\bar{g}} = \\mathbf{G} \\, \\boldsymbol{\\beta}\n$$\n在此，$\\Delta \\boldsymbol{\\bar{g}}$ 是一代内平均性状值的变化向量，$\\mathbf{G}$ 是加性遗传方差-协方差矩阵，$\\boldsymbol{\\beta}$ 是定向选择梯度向量。\n\n将此方程写成其显式分量形式，我们得到：\n$$\n\\begin{pmatrix} \\Delta \\bar{z} \\\\ \\Delta \\bar{y} \\end{pmatrix} = \\begin{pmatrix} G_{zz} & G_{zy} \\\\ G_{yz} & G_{yy} \\end{pmatrix} \\begin{pmatrix} \\beta_{z} \\\\ \\beta_{y} \\end{pmatrix}\n$$\n该矩阵方程产生两个标量方程，每个方程对应一个性状均值的变化：\n$$\n\\Delta \\bar{z} = G_{zz} \\beta_{z} + G_{zy} \\beta_{y}\n$$\n$$\n\\Delta \\bar{y} = G_{yz} \\beta_{z} + G_{yy} \\beta_{y}\n$$\n我们关心的是雌性偏好 $\\bar{y}$ 的响应。其变化量 $\\Delta \\bar{y}$ 由两部分组成。$G_{yy} \\beta_{y}$ 项代表了对作用于偏好性状本身的选择的直接响应。$G_{yz} \\beta_{z}$ 项代表了由于作用于雄性展示性状 $z$ 的选择而引起的偏好性状的间接响应或相关响应。这种相关响应是由两种性状之间的遗传协方差 $G_{yz}$ 介导的。\n\n问题指明了两个条件：\n1. 对雌性偏好没有直接选择，这意味着 $\\beta_{y} = 0$。\n2. 雄性性状和雌性偏好之间没有遗传协方差，这意味着 $G_{zy} = 0$。根据协方差矩阵的对称性，这也意味着 $G_{yz} = 0$。\n\n将这些条件代入 $\\Delta \\bar{y}$ 的方程中：\n$$\n\\Delta \\bar{y} = (0) \\cdot \\beta_{z} + G_{yy} \\cdot (0) = 0\n$$\n相关响应分量 $G_{yz} \\beta_{z}$ 显式为零，因为 $G_{yz}=0$。因此，在没有遗传协方差的情况下，即使对雄性性状存在选择（$\\beta_z \\neq 0$），雌性偏好也不会有即时的相关演化响应。这表明，遗传协方差 $G_{zy}$ 对于偏好作为展示性状选择的副产品而演化是至关重要的，而这正是费雪式失控的基础机制。\n\n第 (ii) 部分：计算建立足够遗传协方差所需的时间。\n\n在这一部分，我们分析遗传协方差 $G_{zy}$ 随时间变化的动态。协方差因选型交配而建立，因重组而衰减。该动态由以下一阶线性递归关系描述：\n$$\nG_{zy}(t+1) = (1 - \\rho)\\, G_{zy}(t) + a \\, V_{z} V_{y}\n$$\n初始条件为 $G_{zy}(0) = 0$。\n\n我们得到以下参数值：\n- $z$ 的加性遗传方差：$V_{z} = G_{zz} = 1$\n- $y$ 的加性遗传方差：$V_{y} = G_{yy} = 1$\n- 重组率：$\\rho = \\frac{1}{2}$\n- 选型交配强度：$a = \\frac{1}{75}$\n\n将这些值代入递归关系中：\n$$\nG_{zy}(t+1) = \\left(1 - \\frac{1}{2}\\right) G_{zy}(t) + \\left(\\frac{1}{75}\\right) \\cdot (1) \\cdot (1)\n$$\n$$\nG_{zy}(t+1) = \\frac{1}{2} G_{zy}(t) + \\frac{1}{75}\n$$\n这是一个标准的线性非齐次递归关系。其解可以通过确定不动点（平衡点）并求解瞬态动力学来找到。不动点 $G_{zy}^*$ 可通过设置 $G_{zy}(t+1) = G_{zy}(t) = G_{zy}^*$ 求得：\n$$\nG_{zy}^* = \\frac{1}{2} G_{zy}^* + \\frac{1}{75} \\implies \\frac{1}{2} G_{zy}^* = \\frac{1}{75} \\implies G_{zy}^* = \\frac{2}{75}\n$$\n递归关系的通解形式为 $G_{zy}(t) = G_{zy}^* + C \\cdot (1-\\rho)^t$，其中 $C$ 是由初始条件决定的常数。\n$$\nG_{zy}(t) = \\frac{2}{75} + C \\left(\\frac{1}{2}\\right)^t\n$$\n使用初始条件 $G_{zy}(0) = 0$：\n$$\nG_{zy}(0) = 0 = \\frac{2}{75} + C \\left(\\frac{1}{2}\\right)^0 = \\frac{2}{75} + C\n$$\n这得到 $C = -\\frac{2}{75}$。\n因此，在第 $t$ 代时协方差的显式解为：\n$$\nG_{zy}(t) = \\frac{2}{75} - \\frac{2}{75} \\left(\\frac{1}{2}\\right)^t = \\frac{2}{75} \\left(1 - \\left(\\frac{1}{2}\\right)^t\\right)\n$$\n问题要求找到使 $G_{zy}(t) \\geq 0.02$ 成立的最小整数代数 $t$。我们首先为了精确将小数转换为分数：$0.02 = \\frac{2}{100} = \\frac{1}{50}$。不等式为：\n$$\n\\frac{2}{75} \\left(1 - \\left(\\frac{1}{2}\\right)^t\\right) \\geq \\frac{1}{50}\n$$\n我们求解这个关于 $t$ 的不等式：\n$$\n1 - \\left(\\frac{1}{2}\\right)^t \\geq \\frac{1}{50} \\cdot \\frac{75}{2}\n$$\n$$\n1 - \\left(\\frac{1}{2}\\right)^t \\geq \\frac{75}{100} = \\frac{3}{4}\n$$\n重新整理各项以分离指数项：\n$$\n1 - \\frac{3}{4} \\geq \\left(\\frac{1}{2}\\right)^t\n$$\n$$\n\\frac{1}{4} \\geq \\left(\\frac{1}{2}\\right)^t\n$$\n我们可以将 $\\frac{1}{4}$ 写成 $\\left(\\frac{1}{2}\\right)^2$：\n$$\n\\left(\\frac{1}{2}\\right)^2 \\geq \\left(\\frac{1}{2}\\right)^t\n$$\n由于指数的底数 $\\frac{1}{2}$ 在 0 和 1 之间，指数函数 $f(x) = (\\frac{1}{2})^x$ 是一个递减函数。因此，为满足该不等式，指数必须具有相反的关系：\n$$\n2 \\leq t\n$$\n条件是代数 $t$ 必须大于或等于 2。满足此条件的最小整数 $t$ 值为 $t=2$。\n\n让我们验证这个结果。\n在 $t=1$ 时：$G_{zy}(1) = \\frac{2}{75} (1 - \\frac{1}{2}) = \\frac{1}{75} \\approx 0.0133$。这小于 $0.02$。\n在 $t=2$ 时：$G_{zy}(2) = \\frac{2}{75} (1 - \\frac{1}{4}) = \\frac{2}{75} \\cdot \\frac{3}{4} = \\frac{6}{300} = \\frac{1}{50} = 0.02$。\n条件 $G_{zy}(2) \\geq 0.02$ 恰好满足。因此，最小的整数代数是 $2$。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "失控选择并非不可避免，它是一场间接遗传收益（“性感儿子”效应）与直接生存成本之间的博弈。本练习引入了一个现实的冲突情景——基因座内两性冲突，即对雄性有吸引力的饰品等位基因会降低其雌性携带者的生存力。通过推导失控选择的启动阈值，你将能够量化收益超越成本的精确临界点。",
            "id": "1929122",
            "problem": "在一个简化的演化动力学模型中，考虑一个二倍体物种，其雄性饰品和雌性对该饰品的偏好由两个独立的、非连锁的基因座控制。该系统受到基因座内性冲突的影响，其中控制雄性饰品的等位基因对雌性适应度有害。\n\n该系统可以用两个连续性状来描述：雄性饰品水平 $z_t$ 和雌性偏好水平 $z_p$。我们关心的是种群平均值 $\\bar{z}_t$ 和 $\\bar{z}_p$ 的演化。\n\n假设选择是弱的，适应度组分定义如下：\n1.  **雄性交配适应度**：饰品水平为 $z_t$ 的雄性的相对交配成功率由雌性种群的平均偏好水平 $\\bar{z}_p$ 决定。该适应度组分由 $W_m(z_t) = 1 + A \\cdot z_t \\cdot \\bar{z}_p$ 给出，其中 $A$ 是一个正常数，表示雌性选择的有效性。\n2.  **雌性生存适应度**：雌性的生存力会因其携带的雄性饰品等位基因而受到负面影响，即使她不表达该性状。基因型对应于雄性饰品水平为 $z_t$ 的雌性，其生存力由 $W_f(z_t) = 1 - C \\cdot z_t$ 给出，其中 $C$ 是一个正常数，表示生存力代价的严重程度。假设对雄性的自然选择可以忽略不计。\n\n费雪氏失控选择的启动要求雄性性状上的总选择梯度 $\\beta_t$ 为正。该梯度是雄性和雌性选择组分梯度的总和：$\\beta_t = \\beta_{t,males} + \\beta_{t,females}$。性状 $z$ 的选择梯度定义为平均适应度的对数对平均性状值的偏导数，例如 $\\beta_{t,males} = \\frac{\\partial \\ln(\\bar{W}_m)}{\\partial \\bar{z}_t}$。\n\n对于给定的非零平均雌性偏好 $\\bar{z}_p > 0$，只有当雄性收益参数与雌性代价参数之比 $A/C$ 超过某个阈值时，失控选择才能启动。求此阈值。你的答案需要用平均雌性偏好 $\\bar{z}_p$ 以闭式解析表达式表示。",
            "solution": "我们分别用 $\\bar{z}_{t}$ 和 $\\bar{z}_{p}$ 表示平均雄性饰品和平均雌性偏好。雄性性状上的总选择梯度是特定性别组分的总和：\n$\n\\beta_{t}=\\beta_{t,\\text{males}}+\\beta_{t,\\text{females}},\\quad \\beta_{t,\\cdot}=\\frac{\\partial}{\\partial \\bar{z}_{t}}\\ln\\left(\\bar{W}_{\\cdot}\\right).\n$\n雄性交配适应度为 $W_{m}(z_{t})=1+A\\,z_{t}\\,\\bar{z}_{p}$。在弱选择和线性适应度下，平均雄性交配适应度是在平均性状处评估的适应度：\n$\n\\bar{W}_{m}=1+A\\,\\bar{z}_{t}\\,\\bar{z}_{p}.\n$\n因此，\n$\n\\beta_{t,\\text{males}}=\\frac{\\partial}{\\partial \\bar{z}_{t}}\\ln\\left(1+A\\,\\bar{z}_{t}\\,\\bar{z}_{p}\\right)=\\frac{A\\,\\bar{z}_{p}}{1+A\\,\\bar{z}_{t}\\,\\bar{z}_{p}}.\n$\n雌性生存适应度为 $W_{f}(z_{t})=1-C\\,z_{t}$，这反映了基因座内性冲突，因为携带雄性饰品等位基因的雌性会承受代价。平均雌性生存力是\n$\n\\bar{W}_{f}=1-C\\,\\bar{z}_{t},\n$\n因此，雄性性状上相应的选择梯度是\n$\n\\beta_{t,\\text{females}}=\\frac{\\partial}{\\partial \\bar{z}_{t}}\\ln\\left(1-C\\,\\bar{z}_{t}\\right)=-\\frac{C}{1-C\\,\\bar{z}_{t}}.\n$\n于是，\n$\n\\beta_{t}=\\frac{A\\,\\bar{z}_{p}}{1+A\\,\\bar{z}_{t}\\,\\bar{z}_{p}}-\\frac{C}{1-C\\,\\bar{z}_{t}}.\n$\n费雪氏失控的启动是在性状的原点附近（$\\bar{z}_{t}$ 很小）进行评估的。在 $\\bar{z}_{t}=0$ 处取极限得到\n$\n\\beta_{t}\\big|_{\\bar{z}_{t}=0}=A\\,\\bar{z}_{p}-C.\n$\n当且仅当 $\\beta_{t}\\big|_{\\bar{z}_{t}=0}>0$ 时，失控选择才能启动，这得出\n$\nA\\,\\bar{z}_{p}-C>0\\quad\\Longleftrightarrow\\quad \\frac{A}{C}>\\frac{1}{\\bar{z}_{p}}.\n$\n因此，对于任何给定的 $\\bar{z}_{p}>0$，比率 $A/C$ 的阈值是 $1/\\bar{z}_{p}$。",
            "answer": "$$\\boxed{\\frac{1}{\\bar{z}_{p}}}$$"
        },
        {
            "introduction": "本练习将所有概念融会贯通，从静态条件分析转向动态过程模拟。你将亲手构建一个Lande模型的计算机模拟程序，将抽象的遗传矩阵（$G$）和选择矩阵（$S$）转化为具体的进化轨迹。通过比较基于特征值的解析预测与模拟的实际结果，你将对进化动态的实时展开获得深刻而直观的理解。",
            "id": "2713675",
            "problem": "考虑用于雄性性状和雌性偏好协同进化的 Lande 定量遗传学模型。设种群均值向量为 $\\mathbf{m}(t) = \\begin{bmatrix} z(t) \\\\ p(t) \\end{bmatrix}$，其中 $z$ 是雄性性状均值，$p$ 是雌性偏好均值。其基本基础是 Lande 方程，该方程指出，均值的变化率等于加性遗传方差-协方差矩阵乘以选择梯度：\n$$\n\\frac{d \\mathbf{m}}{dt} = \\mathbf{G}\\,\\boldsymbol{\\beta}(\\mathbf{m}) .\n$$\n在平衡点 $\\mathbf{m} = \\mathbf{0}$ 附近，将选择梯度线性化为 $\\boldsymbol{\\beta}(\\mathbf{m}) = \\mathbf{S}\\,\\mathbf{m}$，其中矩阵 $\\mathbf{S}$ 通过两个参数 $c$ 和 $a$ 捕捉稳定性自然选择和 Fisherian 性选择：\n$$\n\\mathbf{S} = \\begin{bmatrix} -c & a \\\\ a & -c \\end{bmatrix} ,\n$$\n其中 $c > 0$ 代表稳定性自然选择的强度（曲率），$a \\ge 0$ 代表雌性偏好对雄性性状产生性选择（以及对偏好的交互间接选择）的强度。假定加性遗传方差-协方差矩阵 $\\mathbf{G}$ 是对称正定的。\n\n因此，线性化动力学由以下线性常微分方程 (ODE) 给出：\n$$\n\\frac{d \\mathbf{m}}{dt} = \\mathbf{J}\\,\\mathbf{m}, \\quad \\text{其中} \\quad \\mathbf{J} = \\mathbf{G}\\,\\mathbf{S} .\n$$\n\n任务：编写一个完整的程序，对测试套件中的每个参数集执行以下所有操作：\n- 使用步长为 $\\Delta t$ 的显式欧拉方案，对 ODE 进行前向时间模拟：\n$$\n\\mathbf{m}_{t+\\Delta t} = \\mathbf{m}_t + \\Delta t\\,\\mathbf{J}\\,\\mathbf{m}_t,\n$$\n从初始条件 $\\mathbf{m}(0) = \\mathbf{m}_0$ 开始，总持续时间为 $T$。\n- 以两种不同的方式检测 Fisherian 失控：\n  1. 基于特征值的预测：计算 $\\mathbf{J}$ 的特征值 $\\{\\lambda_i\\}$。如果 $\\max_i \\mathrm{Re}(\\lambda_i) > 0$，则声明一个基于特征值的失控预测。否则，声明没有基于特征值的失控预测。\n  2. 轨迹范数监测：计算模拟轨迹上的欧几里得范数 $\\|\\mathbf{m}(t)\\|_2$。如果以下两个条件都成立，则声明一个基于范数的已检测失控：\n     - 在模拟过程中的某个时间点，范数超过检测阈值 $L$。\n     - 在持续时间为 $W$ 的最后一个窗口内，$\\log\\|\\mathbf{m}(t)\\|_2$ 的平均斜率为正且严格大于一个小的容差 $\\varepsilon$。形式上，如果 $t_k$ 是最后一个窗口中记录的时间，且 $y_k = \\log\\|\\mathbf{m}(t_k)\\|_2$，则计算 $y_k$ 相对于 $t_k$ 的最小二乘斜率 $\\hat{s}$；如果 $\\hat{s} > \\varepsilon$ 并且阈值 $L$ 至少被穿越过一次，则声明一个基于范数的已检测失控。\n\n附加实现要求：\n- 对每个测试用例，使用 $\\Delta t = 0.01$（任意时间单位），$T = 200.0$，$\\mathbf{m}_0 = \\begin{bmatrix} 0.01 \\\\ 0.01 \\end{bmatrix}$，$L = 1.0$，$W = 10.0$ 和 $\\varepsilon = 10^{-4}$。\n- 为保证数值稳定性，一旦 $\\|\\mathbf{m}(t)\\|_2$ 超过 $10^6$，您可以提前终止模拟；若发生提前终止，仍需在最后一个可用窗口上评估斜率标准。\n- 所有矩阵和向量必须以数学上一致的方式处理。不涉及角度。不需要物理单位。\n\n测试套件：\n- 情况 1：$a = 0.5$, $c = 1.0$, $\\mathbf{G} = \\begin{bmatrix} 0.2 & 0.05 \\\\ 0.05 & 0.3 \\end{bmatrix}$。\n- 情况 2：$a = 1.2$, $c = 0.5$, $\\mathbf{G} = \\begin{bmatrix} 1.0 & 0.0 \\\\ 0.0 & 1.0 \\end{bmatrix}$。\n- 情况 3：$a = 1.0$, $c = 1.0$, $\\mathbf{G} = \\begin{bmatrix} 1.0 & 0.0 \\\\ 0.0 & 1.0 \\end{bmatrix}$。\n- 情况 4：$a = 1.5$, $c = 1.0$, $\\mathbf{G} = \\begin{bmatrix} 0.001 & 0.0 \\\\ 0.0 & 0.001 \\end{bmatrix}$。\n\n对于每个测试用例，您的程序必须计算：\n- 一个布尔值，指示基于特征值的失控预测（如果 $\\max_i \\mathrm{Re}(\\lambda_i) > 0$ 则为 true，否则为 false）。\n- 一个布尔值，指示根据上述定义从模拟轨迹中检测到的基于范数的失控。\n- 最大实部特征值 $\\max_i \\mathrm{Re}(\\lambda_i)$，作为一个浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果。此列表中的每个元素对应一个测试用例，并且其本身必须是 $[\\text{eig\\_runaway},\\ \\text{sim\\_runaway},\\ \\text{max\\_real\\_eig}]$ 形式的列表，其中前两个条目是布尔值，第三个是浮点数。例如，一个有效的整体输出将类似于\n$[[\\text{True},\\text{False},0.123456],[\\text{False},\\text{False},-0.543210],\\ldots]$。",
            "solution": "所述问题是有效的。这是一个适定的、有科学依据的练习，涉及进化定量遗传学中一个经典模型的稳定性分析。该任务要求结合解析计算和数值模拟，这些都是该领域的标准方法。我们将着手解决该问题。\n\n该问题围绕雄性性状 $z$ 和雌性偏好 $p$ 的线性化动力学展开，其种群均值由向量 $\\mathbf{m}(t) = \\begin{bmatrix} z(t) \\\\ p(t) \\end{bmatrix}$ 捕捉。控制方程是一个线性常微分方程组 (ODEs)：\n$$\n\\frac{d \\mathbf{m}}{dt} = \\mathbf{J}\\,\\mathbf{m}\n$$\n其中雅可比矩阵 $\\mathbf{J}$ 是加性遗传方差-协方差矩阵 $\\mathbf{G}$ 和选择梯度矩阵 $\\mathbf{S}$ 的乘积：\n$$\n\\mathbf{J} = \\mathbf{G}\\,\\mathbf{S} = \\begin{bmatrix} G_{zz} & G_{zp} \\\\ G_{zp} & G_{pp} \\end{bmatrix} \\begin{bmatrix} -c & a \\\\ a & -c \\end{bmatrix} = \\begin{bmatrix} -c G_{zz} + a G_{zp} & a G_{zz} - c G_{zp} \\\\ -c G_{zp} + a G_{pp} & a G_{zp} - c G_{pp} \\end{bmatrix}\n$$\n这里，$c > 0$ 代表对性状和偏好的稳定性自然选择，而 $a \\ge 0$ 代表性选择的强度。矩阵 $\\mathbf{G}$ 是对称且正定的。\n\n该问题的解决方案是双重的：一个基于系统稳定性的解析预测，和一个基于轨迹模拟的数值验证。\n\n**1. 基于特征值的失控预测**\n\n如果所有从平衡点 $\\mathbf{m} = \\mathbf{0}$ 附近开始的轨迹都收敛于它，则该平衡点是稳定的。如果至少有一条轨迹远离它，则它是不稳定的。对于一个线性系统，这种行为完全由雅可比矩阵 $\\mathbf{J}$ 的特征值 $\\{\\lambda_i\\}$ 决定。\n\n通解是形如 $\\mathbf{v}_i e^{\\lambda_i t}$ 的项的线性组合，其中 $\\mathbf{v}_i$ 是对应于特征值 $\\lambda_i$ 的特征向量。\n- 如果所有特征值都有负实部，即对所有 $i$ 都有 $\\mathrm{Re}(\\lambda_i) < 0$，则所有项都衰减到零，系统是稳定的。\n- 如果任何特征值有正实部，$\\mathrm{Re}(\\lambda_i) > 0$，则对应的项 $e^{\\lambda_i t}$ 将呈指数增长。轨迹将从原点发散。这种指数发散对应于 Fisherian“失控”选择。\n\n因此，首要任务是为每个测试用例计算 $\\mathbf{J}$ 的特征值。如果特征值的最大实部大于零，则预测为基于特征值的失控：\n$$\n\\text{失控预测} \\iff \\max_i \\mathrm{Re}(\\lambda_i) > 0\n$$\n\n**2. 基于模拟的失控检测**\n\n第二个任务是随时间模拟系统的轨迹并分析其行为。我们使用显式欧拉方法，一个一阶数值积分方案，时间步长为 $\\Delta t$。时间 $t + \\Delta t$ 的状态向量由时间 $t$ 的状态计算得出：\n$$\n\\mathbf{m}_{t+\\Delta t} = \\mathbf{m}_t + \\Delta t \\frac{d\\mathbf{m}}{dt}\\bigg|_t = \\mathbf{m}_t + \\Delta t\\,\\mathbf{J}\\,\\mathbf{m}_t = (\\mathbf{I} + \\Delta t\\,\\mathbf{J})\\mathbf{m}_t\n$$\n从初始条件 $\\mathbf{m}(0) = \\mathbf{m}_0 = \\begin{bmatrix} 0.01 \\\\ 0.01 \\end{bmatrix}$ 开始，我们迭代这个方程，总持续时间为 $T=200.0$，或者直到范数 $\\|\\mathbf{m}(t)\\|_2$ 超过一个大值（给定为 $10^6$）以防止数值溢出。在模拟期间，我们记录时间 $t$ 的历史和状态向量的欧几里得范数 $\\|\\mathbf{m}(t)\\|_2 = \\sqrt{z(t)^2 + p(t)^2}$。\n\n如果满足两个条件，则从模拟中检测到失控过程：\n- **阈值穿越**：在模拟过程中的某个点，范数必须超过指定的阈值 $L=1.0$。这表明状态已经移动到离平衡点显著远的位置。形式上，$\\max_t \\|\\mathbf{m}(t)\\|_2 > L$。\n- **持续增长**：在模拟结束时，状态必须表现出持续的指数增长。对于一个不稳定的系统，$\\|\\mathbf{m}(t)\\|_2 \\propto e^{\\lambda_{\\max} t}$，其中 $\\lambda_{\\max}$ 是具有最大实部的特征值。这意味着 $\\log\\|\\mathbf{m}(t)\\|_2 \\propto \\lambda_{\\max} t$。我们通过分析持续时间为 $W=10.0$ 的轨迹的最后一段来验证这一点。我们提取该最后窗口内的时间点 $t_k$ 和对应的范数对数 $y_k = \\log\\|\\mathbf{m}(t_k)\\|_2$。对 $y_k$ 与 $t_k$ 进行线性回归以估计斜率 $\\hat{s}$。该斜率是 $\\lambda_{\\max}$ 的一个经验估计。如果此斜率为正且不可忽略，具体为 $\\hat{s} > \\varepsilon$（其中 $\\varepsilon=10^{-4}$），则确认失控。斜率 $\\hat{s}$ 使用普通最小二乘法的标准公式计算：\n$$\n\\hat{s} = \\frac{\\sum (t_k - \\bar{t})(y_k - \\bar{y})}{\\sum (t_k - \\bar{t})^2}\n$$\n其中 $\\bar{t}$ 和 $\\bar{y}$ 是窗口中时间点和范数对数的均值。\n\n当且仅当阈值穿越和正斜率条件都得到满足时，才声明基于范数的失控。下面的程序为每个提供的测试用例实现了这个逻辑。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Lande model Fisherian runaway problem for a suite of test cases.\n    For each case, it performs an eigenvalue analysis and a numerical simulation \n    to detect runaway selection, then formats the results as specified.\n    \"\"\"\n    # Test suite of parameters\n    test_cases = [\n        {'a': 0.5, 'c': 1.0, 'G': np.array([[0.2, 0.05], [0.05, 0.3]])},\n        {'a': 1.2, 'c': 0.5, 'G': np.array([[1.0, 0.0], [0.0, 1.0]])},\n        {'a': 1.0, 'c': 1.0, 'G': np.array([[1.0, 0.0], [0.0, 1.0]])},\n        {'a': 1.5, 'c': 1.0, 'G': np.array([[0.001, 0.0], [0.0, 0.001]])},\n    ]\n\n    # Simulation and analysis constants\n    dt = 0.01\n    T_final = 200.0\n    m0 = np.array([0.01, 0.01])\n    L = 1.0\n    W = 10.0\n    epsilon = 1e-4\n    norm_limit = 1e6\n\n    all_results = []\n\n    for case in test_cases:\n        a = case['a']\n        c = case['c']\n        G = case['G']\n\n        # Construct the selection and Jacobian matrices\n        S = np.array([[-c, a], [a, -c]])\n        J = G @ S\n\n        # 1. Eigenvalue-based prediction\n        eigenvalues = np.linalg.eigvals(J)\n        max_real_eig = np.max(np.real(eigenvalues))\n        eig_runaway = max_real_eig > 0\n\n        # 2. Simulation-based detection\n        # Setup simulation\n        n_steps = int(T_final / dt)\n        m = m0.copy()\n        \n        t_history = []\n        norm_history = []\n        crossed_L = False\n        \n        # Run explicit Euler simulation\n        for i in range(n_steps + 1):\n            t = i * dt\n            current_norm = np.linalg.norm(m)\n\n            t_history.append(t)\n            norm_history.append(current_norm)\n            \n            if not crossed_L and current_norm > L:\n                crossed_L = True\n\n            # Early termination condition\n            if current_norm > norm_limit:\n                break\n            \n            m = m + dt * (J @ m)\n        \n        # Analyze trajectory norm for runaway detection\n        num_window_points = int(W / dt)\n        \n        # Ensure the window does not exceed the available data\n        if len(t_history)  num_window_points:\n            window_times = np.array(t_history)\n            window_norms = np.array(norm_history)\n        else:\n            window_times = np.array(t_history[-num_window_points:])\n            window_norms = np.array(norm_history[-num_window_points:])\n        \n        # To avoid log(0) if m becomes exactly 0 (unlikely but possible for stable cases)\n        if np.any(window_norms = 0):\n             slope = -np.inf # Assign a non-positive slope\n        else:\n             log_norms = np.log(window_norms)\n             # Perform linear regression of log(norm) vs. time\n             # np.polyfit(x, y, 1) returns [slope, intercept]\n             slope = np.polyfit(window_times, log_norms, 1)[0]\n        \n        slope_positive = slope > epsilon\n        sim_runaway = crossed_L and slope_positive\n        \n        # Store results for this case\n        all_results.append([eig_runaway, sim_runaway, max_real_eig])\n\n    # Format the final output string as required\n    # Creates a list of strings like \"[True,False,0.123]\"\n    formatted_results = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in all_results]\n    \n    # Joins them with commas and wraps in brackets\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    # Python's bool __str__ method returns \"True\" and \"False\" (capitalized),\n    # which matches the format requested in the problem.\n    # The f-string conversion implicitly calls str() on an object.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}