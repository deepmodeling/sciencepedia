{
    "hands_on_practices": [
        {
            "introduction": "理论的学习需要通过实践来巩固。第一个练习将引导你完成一个基础但至关重要的任务：根据系统发育分析得出的原始对数似然值，应用赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 的公式来选择最佳模型。这个练习旨在帮助你熟练掌握这些广泛使用的模型选择标准的核心计算过程，这是进行任何基于似然的模型选择研究的必备技能 。",
            "id": "2734801",
            "problem": "一个长度为 $5000$ 个位点的核苷酸序列比对，在一个关联 $12$ 个分类单元的固定的、完全解析的无根拓扑结构上进行了分析。对于一个有 $m$ 个分类单元的无根二叉系统发育树，有 $2m - 3$ 个分支，每个分支都有一个独立的分支长度参数。在五个时间同质、时间可逆的替换模型下获得的最大对数似然（自然对数）如下所示，所有这些都是在相同的拓扑结构和序列比对上估计的：\n\n- JC69: $\\ln \\hat{L}_{\\mathrm{JC69}} = -7423.6$\n- HKY: $\\ln \\hat{L}_{\\mathrm{HKY}} = -7089.2$\n- GTR: $\\ln \\hat{L}_{\\mathrm{GTR}} = -7012.8$\n- GTR+G (四个离散伽马类别，具有单个形状参数): $\\ln \\hat{L}_{\\mathrm{GTR+G}} = -6844.5$\n- GTR+G+I (伽马分布同上，外加一个不变位点比例): $\\ln \\hat{L}_{\\mathrm{GTR+G+I}} = -6839.7$\n\n假设核苷酸模型采用标准参数化：JC69 模型具有相等的碱基频率和相等的替换率，除了分支长度外，不增加额外的自由替换过程参数；HKY 模型增加了一个转换/颠换速率比参数 $\\kappa$ 和三个独立的碱基频率参数；GTR 模型有五个独立的替换率参数和三个独立的碱基频率参数；$+G$ 扩展增加了一个伽马形状参数 $\\alpha$；$+I$ 扩展增加了一个不变位点比例参数。离散伽马类别的数量是固定的，不增加参数。\n\n使用赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 的标准定义，每个准则都在最大化对数似然与一个惩罚项之间进行权衡，该惩罚项随自由参数数量的增加而增加，对于 BIC，还随样本大小（此处为序列比对的位点数）的增加而增加，请完成以下任务：\n\n1. 确定每个模型的自由参数总数 $k$，包括所有分支长度和模型特定参数。\n2. 计算每个模型的 AIC 和 BIC 值。\n3. 根据 AIC 和 BIC 确定偏好模型（即各自准则下值最小的模型）。\n4. 作为您的最终数值答案，报告 AIC 偏好模型的 Akaike 权重（基于 AIC 的标准化相对似然），以小数形式表示。将您的最终数值答案四舍五入到四位有效数字。",
            "solution": "该问题要求使用赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 对五个嵌套的核苷酸替换模型进行比较分析。目标是确定最佳拟合模型，并通过其 Akaike 权重来量化其支持度。\n\n首先，我们必须定义这两个准则。AIC 由以下公式给出：\n$$\nAIC = 2k - 2\\ln \\hat{L}\n$$\n其中 $k$ 是模型中的自由参数数量，$\\ln \\hat{L}$ 是最大化自然对数似然。BIC 由以下公式给出：\n$$\nBIC = k \\ln(n) - 2\\ln \\hat{L}\n$$\n其中 $n$ 是样本大小，在此情境下为核苷酸序列比对的位点数，给定为 $n = 5000$。\n\n第一步是正确确定五个模型中每一个模型的自由参数总数 $k$。参数总数是分支长度参数数量与替换过程参数数量之和。\n对于一个有 $m$ 个分类单元的无根二叉系统发育树，分支数量为 $2m - 3$。此处，有 $m = 12$ 个分类单元，所以分支数量为 $2(12) - 3 = 21$。每个分支都有一个长度参数，因此所有模型都共享 $k_{branches} = 21$ 个参数。\n\n现在我们按描述确定每个模型的替换过程参数数量 ($k_{subst}$):\n- **JC69**：该模型假设碱基频率相等，替换速率单一。它没有用于替换过程的自由参数。因此，$k_{subst, \\mathrm{JC69}} = 0$。\n- **HKY**：该模型引入了一个转换/颠换速率比参数 ($\\kappa$)，并允许不相等的碱基频率。由于四个碱基频率之和必须为1，因此有3个自由的频率参数。因此，$k_{subst, \\mathrm{HKY}} = 1 + 3 = 4$。\n- **GTR**：这是广义时间可逆模型。它有6个替换率参数，但它们是相对的，因此只有5个是自由的。它还有3个自由的碱基频率参数。因此，$k_{subst, \\mathrm{GTR}} = 5 + 3 = 8$。\n- **GTR+G**：该模型为位点间的速率伽马分布增加了一个参数，即形状参数 $\\alpha$。因此，$k_{subst, \\mathrm{GTR+G}} = k_{subst, \\mathrm{GTR}} + 1 = 8 + 1 = 9$。\n- **GTR+G+I**：该模型增加了一个不变位点比例参数 $p_{inv}$。因此，$k_{subst, \\mathrm{GTR+G+I}} = k_{subst, \\mathrm{GTR+G}} + 1 = 9 + 1 = 10$。\n\n每个模型的总参数数量 ($k$) 为：\n- $k_{\\mathrm{JC69}} = 21 + 0 = 21$\n- $k_{\\mathrm{HKY}} = 21 + 4 = 25$\n- $k_{\\mathrm{GTR}} = 21 + 8 = 29$\n- $k_{\\mathrm{GTR+G}} = 21 + 9 = 30$\n- $k_{\\mathrm{GTR+G+I}} = 21 + 10 = 31$\n\n有了 $k$、$\\ln \\hat{L}$ 和 $n=5000$ 的值，我们可以计算每个模型的 AIC 和 BIC。\n\n1. **JC69**: $k = 21$, $\\ln \\hat{L} = -7423.6$\n   $AIC_{\\mathrm{JC69}} = 2(21) - 2(-7423.6) = 42 + 14847.2 = 14889.2$\n   $BIC_{\\mathrm{JC69}} = 21\\ln(5000) - 2(-7423.6) \\approx 21(8.5172) + 14847.2 = 178.8612 + 14847.2 = 15026.0612$\n\n2. **HKY**: $k = 25$, $\\ln \\hat{L} = -7089.2$\n   $AIC_{\\mathrm{HKY}} = 2(25) - 2(-7089.2) = 50 + 14178.4 = 14228.4$\n   $BIC_{\\mathrm{HKY}} = 25\\ln(5000) - 2(-7089.2) \\approx 25(8.5172) + 14178.4 = 212.9300 + 14178.4 = 14391.3300$\n\n3. **GTR**: $k = 29$, $\\ln \\hat{L} = -7012.8$\n   $AIC_{\\mathrm{GTR}} = 2(29) - 2(-7012.8) = 58 + 14025.6 = 14083.6$\n   $BIC_{\\mathrm{GTR}} = 29\\ln(5000) - 2(-7012.8) \\approx 29(8.5172) + 14025.6 = 246.9988 + 14025.6 = 14272.5988$\n\n4. **GTR+G**: $k = 30$, $\\ln \\hat{L} = -6844.5$\n   $AIC_{\\mathrm{GTR+G}} = 2(30) - 2(-6844.5) = 60 + 13689.0 = 13749.0$\n   $BIC_{\\mathrm{GTR+G}} = 30\\ln(5000) - 2(-6844.5) \\approx 30(8.5172) + 13689.0 = 255.5160 + 13689.0 = 13944.5160$\n\n5. **GTR+G+I**: $k = 31$, $\\ln \\hat{L} = -6839.7$\n   $AIC_{\\mathrm{GTR+G+I}} = 2(31) - 2(-6839.7) = 62 + 13679.4 = 13741.4$\n   $BIC_{\\mathrm{GTR+G+I}} = 31\\ln(5000) - 2(-6839.7) \\approx 31(8.5172) + 13679.4 = 264.0332 + 13679.4 = 13943.4332$\n\n偏好模型是使信息准则得分最小化的模型。\n-对于AIC，最小值为 $AIC_{min} = 13741.4$，对应于 **GTR+G+I** 模型。\n-对于BIC，最小值为 $BIC_{min} \\approx 13943.43$，也对应于 **GTR+G+I** 模型。\n\n最后，我们必须计算 AIC 下偏好模型（即 GTR+G+I）的 Akaike 权重。模型 $i$ 的 Akaike 权重 ($w_i$) 是其在一组候选模型中相对支持度的度量。其计算公式为：\n$$\nw_i = \\frac{\\exp(-\\frac{1}{2}\\Delta_i)}{\\sum_{j=1}^{R} \\exp(-\\frac{1}{2}\\Delta_j)}\n$$\n其中 $\\Delta_i = AIC_i - AIC_{min}$，$R=5$ 是模型数量。\n\n首先，我们计算每个模型相对于 $AIC_{min} = AIC_{\\mathrm{GTR+G+I}} = 13741.4$ 的 $\\Delta_i$ 值。\n- $\\Delta_{\\mathrm{JC69}} = 14889.2 - 13741.4 = 1147.8$\n- $\\Delta_{\\mathrm{HKY}} = 14228.4 - 13741.4 = 487.0$\n- $\\Delta_{\\mathrm{GTR}} = 14083.6 - 13741.4 = 342.2$\n- $\\Delta_{\\mathrm{GTR+G}} = 13749.0 - 13741.4 = 7.6$\n- $\\Delta_{\\mathrm{GTR+G+I}} = 13741.4 - 13741.4 = 0$\n\n接下来，我们计算偏好模型（GTR+G+I）的 Akaike 权重的分子：\n$\\exp(-\\frac{1}{2}\\Delta_{\\mathrm{GTR+G+I}}) = \\exp(-\\frac{1}{2} \\times 0) = \\exp(0) = 1$。\n\n现在，我们计算分母，即所有模型相对似然的总和：\n$\\sum_{j=1}^{5} \\exp(-\\frac{1}{2}\\Delta_j) = \\exp(-\\frac{1147.8}{2}) + \\exp(-\\frac{487.0}{2}) + \\exp(-\\frac{342.2}{2}) + \\exp(-\\frac{7.6}{2}) + \\exp(-\\frac{0}{2})$\n$\\sum_{j} \\exp(-\\frac{1}{2}\\Delta_j) = \\exp(-573.9) + \\exp(-243.5) + \\exp(-171.1) + \\exp(-3.8) + \\exp(0)$\n前三项小到可以忽略不计，在数值上可以忽略。我们计算：\n$\\exp(-3.8) \\approx 0.0223708$\n$\\exp(0) = 1$\n所以，总和约为 $0 + 0 + 0 + 0.0223708 + 1 = 1.0223708$。\n\nGTR+G+I 模型的 Akaike 权重为：\n$w_{\\mathrm{GTR+G+I}} = \\frac{1}{1.0223708} \\approx 0.978119$\n\n四舍五入到四位有效数字，AIC 偏好模型的 Akaike 权重是 $0.9781$。这表明，在给定数据和候选模型集的情况下，GTR+G+I 模型在 Kullback-Leibler 意义上是最佳模型的概率约为 $97.81\\%$。",
            "answer": "$$\\boxed{0.9781}$$"
        },
        {
            "introduction": "在我们自信地应用信息准则之前，必须深刻理解其核心组成部分——对数似然值 ($log-likelihood$)。本练习旨在解决一个常见的概念误区：为什么不能直接比较来自不同长度序列比对的原始对数似然值。通过这个思想实验，你将探索如何正确地进行归一化处理以评估相对拟合优度，并加深对似然值本质的理解 。",
            "id": "2734788",
            "problem": "两个来自同一组分类单元的独立核苷酸比对（表示为比对 $A$ 和比对 $B$）具有不同数量的位点。比对 $A$ 有 $n_A = 2400$ 个位点，比对 $B$ 有 $n_B = 600$ 个位点。对于每个比对，您都拟合了相同的同质、时间可逆的替换模型族，通过最大似然法分别为每个比对优化了分支长度和模型参数。设 $\\ell$ 表示给定比对-模型拟合的最大化对数似然值。对于更复杂的模型 $M_c$（有 $k_c = 12$ 个自由替换模型参数，不计分支长度）和一个更简单的嵌套模型 $M_s$（有 $k_s = 6$ 个自由替换模型参数，不计分支长度），您获得了以下最大化对数似然值：\n- 比对 $A$：$\\ell_{A,s} = -7250$, $\\ell_{A,c} = -7200$。\n- 比对 $B$：$\\ell_{B,s} = -1875$, $\\ell_{B,c} = -1860$。\n\n假设这些模型使用通常的位点独立似然。考虑以下关于对数似然值如何随比对长度缩放以及如何恰当使用信息准则在不同长度的比对之间进行模型选择的陈述。选择所有正确的陈述。\n\nA. 由于独立位点的对数似然值是各位点贡献的总和，它近似地与位点数 $n$ 呈线性缩放关系；因此，直接比较不同 $n$ 的比对之间的原始值 $\\ell_{A,\\cdot}$ 和 $\\ell_{B,\\cdot}$ 是不恰当的。\n\nB. 一种长度归一化的比较方法是使用每位点的平均对数似然值，$\\bar{\\ell}_{A,\\cdot} = \\ell_{A,\\cdot}/n_A$ 和 $\\bar{\\ell}_{B,\\cdot} = \\ell_{B,\\cdot}/n_B$。对于复杂模型 $M_c$，这些值是 $\\bar{\\ell}_{A,c} = -3.0$ 和 $\\bar{\\ell}_{B,c} = -3.1$，这表明在相同模型族下，按每位点计算，比对 $A$ 的拟合效果优于比对 $B$。\n\nC. 贝叶斯信息准则 (Bayesian Information Criterion) 考虑了样本大小，因此使得不同比对之间的值可以直接比较；因此，即使比对长度不同，也应选择 BIC 值较小的模型。\n\nD. 对于每个单独分析的比对，应选择赤池信息准则 (Akaike Information Criterion) 值较小的模型；根据给定的数值和参数数量，对于两个比对，AIC 都会选择更复杂的模型 $M_c$。\n\nE. 一种有效的针对不同比对长度进行归一化的方法是比较比值 $\\ell_{A,\\cdot}/\\ell_{B,\\cdot}$ 除以比值 $n_A/n_B$；大于 1 的值表示比对 $A$ 的拟合效果更好。\n\nF. 由于恒定位点携带的关于替换过程的信息很少，因此进行跨比对比较的正确归一化方法是将每个 $\\ell$ 除以可变位点的数量，而不是总位点数。使用所有位点会不适当地稀释比较结果。\n\n注：请拼写并使用信息准则的全称。赤池信息准则 (Akaike Information Criterion, AIC) 和贝叶斯信息准则 (Bayesian Information Criterion, BIC) 应按照其在系统发育学中使用的标准频率派形式进行解释；此处不使用贝叶斯边际似然或交叉验证。",
            "solution": "所述问题是有效的。它在科学上基于统计系统发育学的原理，问题提出得很好，数据充分且一致，并以客观、精确的语言表述。我现在将进行严谨的分析。\n\n支配该问题的基本原理是基于似然的推断及其相关信息准则的性质。\n\n首先，在假定位点独立的模型下，一个数据集的对数似然值（$\\ell$）是每个位点对数似然值的总和。对于一个长度为 $n$、位点索引为 $i$ 的比对，总对数似然值为 $\\ell = \\sum_{i=1}^{n} \\ell_i$。这个求和意味着，在其他条件相同的情况下，$\\ell$ 的值是一个广延量，预计会与位点数 $n$ 呈线性缩放关系。\n\n其次，信息准则用于为*给定*数据集比较不同统计模型的相对质量。它们在拟合优度（通过似然值衡量）和模型复杂度（通过自由参数数量衡量）之间提供了一种权衡。\n赤池信息准则 (Akaike Information Criterion, AIC) 定义为：\n$$AIC = 2K - 2\\ell$$\n其中 $K$ 是模型中自由参数的总数，$\\ell$ 是最大化的对数似然值。\n贝叶斯信息准则 (Bayesian Information Criterion, BIC) 定义为：\n$$BIC = K \\log(n) - 2\\ell$$\n其中 $n$ 是样本大小，在此情境下是比对中的位点数。\n对于这两种准则，都偏好值*较小*的模型。关键是要理解，这些准则是为了在*相同*数据集上比较不同模型而推导出来的。它们并非设计用来比较模型在*不同*数据集（尤其是不同大小的数据集）上的性能。\n\n现在，我将评估每个陈述。\n\nA. 由于独立位点的对数似然值是各位点贡献的总和，它近似地与位点数 $n$ 呈线性缩放关系；因此，直接比较不同 $n$ 的比对之间的原始值 $\\ell_{A,\\cdot}$ 和 $\\ell_{B,\\cdot}$ 是不恰当的。\n这个陈述根本上是正确的。如前所述，对数似然值 $\\ell = \\sum_{i=1}^{n} \\ell_i$。$\\ell$ 的期望值与位点数 $n$ 成正比。给定的比对长度差异很大，$n_A = 2400$ 和 $n_B = 600$。在 $n$ 相差 4 倍的数据集之间比较一个与 $n$ 成比例的量在统计上是无意义的。例如，$\\ell_{A,c} = -7200$ 而 $\\ell_{B,c} = -1860$。$\\ell_{A,c}$ 比 $\\ell_{B,c}$ 负得多，这是比对 $A$ 远长于比对 $B$ 的直接结果，而不是拟合效果更差的标志。因此，直接比较是不恰当的。\n结论：**正确**。\n\nB. 一种长度归一化的比较方法是使用每位点的平均对数似然值，$\\bar{\\ell}_{A,\\cdot} = \\ell_{A,\\cdot}/n_A$ 和 $\\bar{\\ell}_{B,\\cdot} = \\ell_{B,\\cdot}/n_B$。对于复杂模型 $M_c$，这些值是 $\\bar{\\ell}_{A,c} = -3.0$ 和 $\\bar{\\ell}_{B,c} = -3.1$，这表明在相同模型族下，按每位点计算，比对 $A$ 的拟合效果优于比对 $B$。\n这个陈述提出了一种有效的归一化方法，用于比较不同长度比对的拟合优度。我们计算复杂模型 $M_c$ 下每位点的平均对数似然值。\n对于比对 $A$：$\\bar{\\ell}_{A,c} = \\frac{\\ell_{A,c}}{n_A} = \\frac{-7200}{2400} = -3.0$。\n对于比对 $B$：$\\bar{\\ell}_{B,c} = \\frac{\\ell_{B,c}}{n_B} = \\frac{-1860}{600} = -3.1$。\n陈述中的计算是正确的。更好的拟合对应于更高（负得更少）的对数似然值。由于 $-3.0 > -3.1$，模型 $M_c$ 在每位点基础上对比对 $A$ 的拟合效果优于其对比对 $B$ 的拟合效果。“比对 A 的拟合优于比对 B”这种说法是陈述这一点的常用（尽管略有不精确）方式。该结论是合乎逻辑的，并且源于正确的计算。\n结论：**正确**。\n\nC. 贝叶斯信息准则 (Bayesian Information Criterion) 考虑了样本大小，因此使得不同比对之间的值可以直接比较；因此，即使比对长度不同，也应选择 BIC 值较小的模型。\n这个陈述从根本上误解了样本大小 $n$ 在 BIC 公式中的作用。惩罚项 $K \\log(n)$ 根据可用数据量调整对参数的惩罚。它并不能将整个 BIC 值归一化以使其独立于样本大小。BIC 表达式中的主导项是 $-2\\ell$，正如在 A 中确立的，它与 $n$ 呈线性缩放。因此，总的 BIC 值也将强烈依赖于 $n$。让我们计算模型 $M_c$ 的 BIC（忽略分支长度，因为它们对于给定的比对是恒定的，并且只会同等地增加所有模型的复杂性）。\n$BIC_A \\approx k_c \\log(n_A) - 2\\ell_{A,c} = 12 \\log(2400) - 2(-7200) \\approx 12(7.78) + 14400 \\approx 14493$。\n$BIC_B \\approx k_c \\log(n_B) - 2\\ell_{B,c} = 12 \\log(600) - 2(-1860) \\approx 12(6.40) + 3720 \\approx 3797$。\n这些值差异巨大，主要由各自的对数似然值决定。比较这些值无法洞察哪个比对被模型“更好”地拟合。BIC 是用于在*相同*比对上比较不同模型的。\n结论：**错误**。\n\nD. 对于每个单独分析的比对，应选择赤池信息准则 (Akaike Information Criterion) 值较小的模型；根据给定的数值和参数数量，对于两个比对，AIC 都会选择更复杂的模型 $M_c$。\n陈述的第一部分正确地说明了基于 AIC 的模型选择原则。为验证第二部分，我们必须为每个比对比较模型 $M_s$ 和 $M_c$ 的 AIC 值。如果 $AIC_c < AIC_s$，则更复杂的模型 $M_c$ 优于更简单的嵌套模型 $M_s$。\n设 $K_s$ 和 $K_c$ 分别为简单模型和复杂模型的总参数数量。问题给出的替换参数数量为 $k_s=6$ 和 $k_c=12$。总参数数量还包括分支长度，比如说 $k_{br}$，所以 $K_s = k_s + k_{br}$ 和 $K_c = k_c + k_{br}$。\n条件 $AIC_c < AIC_s$ 变为：\n$$2 K_c - 2 \\ell_c < 2 K_s - 2 \\ell_s$$\n$$2 (k_c + k_{br}) - 2 \\ell_c < 2 (k_s + k_{br}) - 2 \\ell_s$$\n$$2 k_c - 2 \\ell_c < 2 k_s - 2 \\ell_s$$\n$$\\ell_c - \\ell_s > k_c - k_s$$\n替换参数的差异是 $k_c - k_s = 12 - 6 = 6$。因此，如果 $M_c$ 的对数似然值比 $M_s$ 的对数似然值大 6 以上，则 $M_c$ 更优。\n对于比对 $A$：$\\ell_{A,c} - \\ell_{A,s} = -7200 - (-7250) = 50$。由于 $50 > 6$，模型 $M_c$ 被选用于比对 $A$。\n对于比对 $B$：$\\ell_{B,c} - \\ell_{B,s} = -1860 - (-1875) = 15$。由于 $15 > 6$，模型 $M_c$ 也被选用于比对 $B$。\n该陈述完全正确。\n结论：**正确**。\n\nE. 一种有效的针对不同比对长度进行归一化的方法是比较比值 $\\ell_{A,\\cdot}/\\ell_{B,\\cdot}$ 除以比值 $n_A/n_B$；大于 1 的值表示比对 $A$ 的拟合效果更好。\n所提出的度量是 $\\frac{\\ell_A / \\ell_B}{n_A / n_B} = \\frac{\\ell_A / n_A}{\\ell_B / n_B} = \\frac{\\bar{\\ell}_A}{\\bar{\\ell}_B}$。这是每位点平均对数似然值的比率。\n对比对 $A$ 的更好拟合意味着更高（负得更少）的平均对数似然值，即 $\\bar{\\ell}_A > \\bar{\\ell}_B$。\n让我们使用选项 B 中模型 $M_c$ 的值：$\\bar{\\ell}_{A,c} = -3.0$ 和 $\\bar{\\ell}_{B,c} = -3.1$。\n我们有 $\\bar{\\ell}_{A,c} > \\bar{\\ell}_{B,c}$。让我们计算比率：\n$$\\frac{\\bar{\\ell}_{A,c}}{\\bar{\\ell}_{B,c}} = \\frac{-3.0}{-3.1} \\approx 0.9677$$\n这个值小于 1。该陈述声称大于 1 的值表示比对 $A$ 的拟合效果更好。这是不正确的。因为对数似然值为负，对 $A$ 的更好拟合（$\\bar{\\ell}_A > \\bar{\\ell}_B$）会导致比率 $\\frac{\\bar{\\ell}_A}{\\bar{\\ell}_B} = \\frac{|\\bar{\\ell}_A|}{|\\bar{\\ell}_B|}$ 小于 1。该陈述的不等式方向是反的。\n结论：**错误**。\n\nF. 由于恒定位点携带的关于替换过程的信息很少，因此进行跨比对比较的正确归一化方法是将每个 $\\ell$ 除以可变位点的数量，而不是总位点数。使用所有位点会不适当地稀释比较结果。\n这个陈述是有缺陷的。首先，“恒定（不变）位点携带‘很少信息’”的断言是一种过度简化。它们携带着关于进化速率（具体来说，它们是短分支的证据）和平衡碱基频率的信息。一个不能准确预测观察到的不变位点数量的模型是一个差的模型。其次，对数似然值 $\\ell$ 是通过对*所有*位点（包括可变和恒定位点）的贡献求和来计算的。然后用一个排除了部分贡献项（恒定位点）的计数来对这个总和进行归一化，这在统计上是不连贯的。在基于似然的系统发育学中，标准、“正确”的方法是使用所有位点，因为它们共同构成了待解释的数据。将标准程序称为“不适当的稀释”，并提出这种临时方法为“正确”的方法，在科学上是不合理的。\n结论：**错误**。",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "信息准则虽然功能强大，但其应用必须考虑具体情境。这个练习提出了一个微妙而关键的场景，旨在区分系统发育学中的两个基本任务：为固定拓扑选择替换模型，以及在固定模型下选择树拓扑。理解这种情境差异对于正确应用 $AIC$ 和 $BIC$ 中固有的复杂性惩罚项至关重要，因为它揭示了当参数数量相同时，模型选择如何简化为最大似然值的比较 。",
            "id": "2734810",
            "problem": "一个包含 $N=10$ 个分类单元的多序列比对有 $n=2000$ 个位点。在给定系统发育树和替换模型的条件下，这些位点被假定为在位点间独立同分布。考虑两个不同但密切相关的模型选择任务：\n\n- 任务1（在固定拓扑结构上选择替换模型）：无根、完全二分的树拓扑结构 $T^\\star$保持固定。你将比较三种在参数化上有所不同的时间可逆、平稳、同质的替换过程模型。对于每个模型 $M_i$，令 $k_i$ 表示自由参数的总数，包括所有枝长和所有替换过程参数。候选模型及其最大化对数似然值如下：\n  - $M_1=\\text{JC69}$，$k_1=17$，$\\ell_1=\\log L(M_1,T^\\star \\mid \\text{data})=-5500.0$。\n  - $M_2=\\text{HKY}$，$k_2=21$，$\\ell_2=\\log L(M_2,T^\\star \\mid \\text{data})=-5205.0$。\n  - $M_3=\\text{GTR}+\\Gamma+I$，$k_3=27$，$\\ell_3=\\log L(M_3,T^\\star \\mid \\text{data})=-5195.0$。\n\n- 任务2（在固定替换模型下选择拓扑结构）：替换模型固定为 $M_2=\\text{HKY}$。你将比较针对相同 $N=10$ 个分类单元的三个无根、完全二分的拓扑结构 $T_A,T_B,T_C$。对于每个拓扑结构，所有枝长和所有 $M_2$ 的参数都进行了优化。因为这三个拓扑结构都是在相同分类单元集上、使用相同替换模型的完全解析树，所以它们的总参数数量相同，即 $k_A=k_B=k_C=21$。最大化对数似然值如下：\n  - $\\ell_A=\\log L(M_2,T_A \\mid \\text{data})=-5200.0$，\n  - $\\ell_B=\\log L(M_2,T_B \\mid \\text{data})=-5192.0$，\n  - $\\ell_C=\\log L(M_2,T_C \\mid \\text{data})=-5195.0$。\n\n仅使用基于似然度的模型比较和信息准则的一般原理，选择最准确、最完整地做到以下两点的唯一选项：\n\n1) 阐明在固定拓扑结构上选择替换模型与在固定替换模型下选择树拓扑结构之间的概念性区别，包括复杂度惩罚在这两个任务中是如何以及为何以不同方式引入的。\n\n2) 根据上面给出的数值，正确陈述在任务1中，赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 分别选择了哪个候选模型；在任务2中，两个准则都选择了哪个拓扑结构，并说明为什么在这种设置下两个准则对拓扑结构的排序结果是相同的。\n\nA. 在固定的拓扑结构 $T^\\star$ 下，三个替换模型 $M_1,M_2,M_3$ 构成了具有不同总参数数量 $k_i$ 的不同统计模型，因此 AIC 和 BIC 都在拟合度的提高与增加的替换过程和位点间速率参数之间进行权衡。根据给定的 $\\ell_i$ 和 $n=2000$，AIC 选择 $M_3$，而 BIC 选择 $M_2$。在固定的替换模型下，对于相同分类单元上的三个完全二分的拓扑结构，总参数数量 $k$（所有枝长加上替换参数）在 $T_A,T_B,T_C$ 之间是相同的，因此惩罚项是相等的常数，AIC 和 BIC 都简化为选择最大似然拓扑结构，即此处的 $T_B$。\n\nB. 贝叶斯信息准则应使用分类单元数 $N=10$ 作为样本量，因此对于更丰富的替换模型，其惩罚项占主导地位；所以在任务1中，AIC 和 BIC 都选择 $M_1$。在任务2中，BIC 在拓扑上偏好最平衡的拓扑结构，因此即使 $T_A$ 的似然度较低，它也会选择 $T_A$。\n\nC. 信息准则不能应用于像树拓扑结构这样的离散对象；只有似然比检验是合适的。因为 $T_A$ 与 $T_B$ 是非嵌套的，所以 AIC 和 BIC 都没有意义，应该转而通过简约性选择 $T_A$。\n\nD. 在固定替换模型下比较拓扑结构时，参数数量 $k$ 因树之间的枝长估计不同而不同，因此 BIC 会惩罚总枝长更长的树；根据给定的数值，它会选择 $T_C$。在任务1中，AIC 和 BIC 都必然选择 $M_3$，因为它具有最高的似然度。\n\nE. 在固定拓扑结构下，根据似然度，AIC 和 BIC 都选择最丰富的模型 $M_3$；在固定替换模型下，两个准则都选择 $T_B$；然而，因为即使模型固定，BIC 的惩罚项在不同拓扑结构间也会变化，所以原则上它可以逆转具有相同分类单元数的完全二分树之间的似然度排序。",
            "solution": "我们从系统发育推断的标准似然框架开始，该框架基于时间可逆、平稳、同质的替换模型以及位点独立性假设。给定一个包含 $n$ 个位点的比对和一个候选模型（该模型由一个替换过程的参数化以及一个树拓扑结构及其枝长组成），似然度为\n$$\nL(\\text{model} \\mid \\text{data}) \\;=\\; \\prod_{i=1}^{n} p\\big(X_i \\mid \\text{model}\\big),\n$$\n其中 $X_i$ 是位点 $i$ 的位点模式，$p(\\cdot \\mid \\text{model})$ 通过 Felsenstein 的剪枝算法计算得出，该算法对未观察到的祖先状态进行积分。对数似然在各位点上是可加的：\n$$\n\\ell \\;=\\; \\log L \\;=\\; \\sum_{i=1}^{n} \\log p\\big(X_i \\mid \\text{model}\\big).\n$$\n\n信息准则提供了有原则的、近似的方法，用于在数据拟合度与模型复杂度之间进行权衡。赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 的定义如下\n$$\n\\mathrm{AIC} \\;=\\; -2 \\ell \\;+\\; 2k, \n\\qquad\n\\mathrm{BIC} \\;=\\; -2 \\ell \\;+\\; k \\log n,\n$$\n其中 $k$ 是模型自由参数的总数，$n$ 是样本量。在传统的位点独立性假设下，系统发育学中 BIC 的合适样本量 $n$ 等于比对位点的数量。值越小表示模型越优。\n\n从这些定义可以直接得出两个概念要点：\n\n- 在任务1中，拓扑结构 $T^\\star$ 是固定的，因此 $M_1,M_2,M_3$ 之间 $k$ 值的差异源于替换过程的参数化（例如，可交换率、碱基频率、位点间速率变异参数），而枝长参数的数量在各个 $M_i$ 之间是相同的。因此，AIC 和 BIC 将权衡 $\\ell$ 值的提高与替换模型中 $k$ 值的增加。\n\n- 在任务2中，替换模型固定为 $M_2$，且三个拓扑结构 $T_A,T_B,T_C$ 都是针对相同 $N=10$ 个分类单元的无根、完全二分树。这样的树都具有相同数量的枝长参数，即 $2N-3=17$，以及相同数量的替换过程参数（即 $M_2$ 的参数），因此在候选拓扑结构之间总的 $k$ 值是相同的。因此，惩罚项 $2k$（对于 AIC）和 $k \\log n$（对于 BIC）在 $T_A,T_B,T_C$ 之间是相等的常数，两个准则都简化为仅根据 $\\ell$ 对拓扑结构进行排序，即选择最大似然 (ML) 拓扑结构。\n\n现在我们进行所要求的计算。\n\n任务1（固定拓扑结构 $T^\\star$，比较 $M_1,M_2,M_3$）：\n\n- 计算每个模型的 $-2\\ell$ 值：\n  - $-2\\ell_1 = -2(-5500.0) = 11000.0$，\n  - $-2\\ell_2 = -2(-5205.0) = 10410.0$，\n  - $-2\\ell_3 = -2(-5195.0) = 10390.0$。\n\n- AIC 值：\n  - $\\mathrm{AIC}(M_1) = 11000.0 + 2 \\times 17 = 11034.0$，\n  - $\\mathrm{AIC}(M_2) = 10410.0 + 2 \\times 21 = 10452.0$，\n  - $\\mathrm{AIC}(M_3) = 10390.0 + 2 \\times 27 = 10444.0$。\n  最小值是 $\\mathrm{AIC}(M_3)=10444.0$，所以 AIC 选择 $M_3$。\n\n- BIC 值（$n=2000$ 个位点，$\\log n = \\log 2000 \\approx 7.600902$）：\n  - 惩罚项：$k_1 \\log n \\approx 17 \\times 7.600902 \\approx 129.215$，$k_2 \\log n \\approx 21 \\times 7.600902 \\approx 159.619$，$k_3 \\log n \\approx 27 \\times 7.600902 \\approx 205.224$。\n  - $\\mathrm{BIC}(M_1) \\approx 11000.0 + 129.215 = 11129.215$，\n  - $\\mathrm{BIC}(M_2) \\approx 10410.0 + 159.619 = 10569.619$，\n  - $\\mathrm{BIC}(M_3) \\approx 10390.0 + 205.224 = 10595.224$。\n  最小值是 $\\mathrm{BIC}(M_2)\\approx 10569.619$，所以 BIC 选择 $M_2$。\n\n因此，在任务1中，两个准则如预期般得出不同结论：AIC 的参数惩罚项不随 $n$ 变化，因此更宽容，选择了更丰富的模型 $M_3$；而 BIC 的惩罚项随 $\\log n$ 增长，在 $n=2000$ 时更保守，选择了中等复杂度的模型 $M_2$。\n\n任务2（固定模型 $M_2$，比较拓扑结构 $T_A,T_B,T_C$）：\n\n- 计算 $-2\\ell$：\n  - $-2\\ell_A = -2(-5200.0) = 10400.0$，\n  - $-2\\ell_B = -2(-5192.0) = 10384.0$，\n  - $-2\\ell_C = -2(-5195.0) = 10390.0$。\n  由于 $k_A=k_B=k_C=21$，AIC 和 BIC 在不同拓扑结构之间的差异仅在于 $-2\\ell$ 项，因此两者都选择具有最大 $\\ell$ 值（最小 $-2\\ell$ 值）的拓扑结构，即 $T_B$。\n\n逐项分析：\n\n- 选项A：该选项正确地阐明了概念上的区别：在任务1中，替换模型之间 $k$ 值的差异驱动了惩罚项的权衡；而在任务2中，对于相同分类单元上、使用固定替换模型的完全二分树，$k$ 在不同拓扑结构间是相同的，因此惩罚项是相等的常数，两个准则都简化为最大似然排序。它也根据给定的数值正确地指出了被选择的模型：在任务1中，AIC选择 $M_3$，BIC选择 $M_2$；在任务2中，两者都选择 $T_B$。结论 — 正确。\n\n- 选项B：该选项断言 BIC 应将分类单元数 $N=10$ 作为样本量。在位点独立模型下，合适的 $n$ 是位点数，而不是分类单元数。它还声称 AIC 和 BIC 都选择 $M_1$，这与上面的明确计算相矛盾。它还提及“平衡的拓扑结构”作为 BIC 的偏好，但这并非信息准则的运作方式。结论 — 错误。\n\n- 选项C：该选项声称信息准则不能应用于像拓扑结构这样的离散对象，并建议改用似然比检验。AIC 和 BIC 都是明确设计用于比较任何有限集合的已拟合模型，包括像树拓扑结构这样的离散选项。此外，似然比检验要求模型具有嵌套关系，而不同的完全解析拓扑结构之间通常不满足此条件；信息准则正是用于比较这类非嵌套模型的。结论 — 错误。\n\n- 选项D：该选项声称 $k$ 在不同拓扑结构间有所不同，因为枝长估计值不同。估计的数值是不同的，但自由参数的数量 $k$ 并不变：所有基于相同分类单元集的无根完全二分树都有 $2N-3$ 个枝长，因此 $k$ 值相同。它还断言 BIC 会惩罚更长的总枝长，这是错误的；惩罚项取决于参数数量，而非参数的大小。其声称在任务1中 AIC 和 BIC “必然选择 $M_3$”与上面的 BIC 计算结果相矛盾。结论 — 错误。\n\n- 选项E：虽然它在任务2中正确地指出了 $T_B$，但它错误地断言在任务1中 AIC 和 BIC 都选择了 $M_3$。它还声称，即使模型和分类单元数相同，BIC 的惩罚项在不同的完全二分拓扑结构之间也会变化，这在这种设置下是错误的，因为 $k$ 在 $T_A,T_B,T_C$ 之间是相同的。结论 — 错误。\n\n因此，只有选项A是正确的。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}