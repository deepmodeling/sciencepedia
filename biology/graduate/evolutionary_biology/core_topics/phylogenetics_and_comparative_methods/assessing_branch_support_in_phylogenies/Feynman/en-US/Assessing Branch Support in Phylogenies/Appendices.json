{
    "hands_on_practices": [
        {
            "introduction": "Bootstrap support values are a cornerstone of phylogenetic analysis, yet they are often treated as fixed, known quantities. In reality, a bootstrap proportion from a finite number of replicates is a statistical estimate with its own uncertainty. This exercise guides you through calculating a confidence interval for the true, long-run bootstrap probability , providing a more rigorous framework for deciding whether a branch is well-supported.",
            "id": "2692757",
            "problem": "In phylogenetic inference, nonparametric bootstrap replicates are commonly used to assess the support for a candidate split (clade). Consider a target internal branch in a maximum likelihood (ML) tree. You generated $R = 800$ nonparametric bootstrap replicates, and the split appears in $k = 584$ of them. Assume that each bootstrap replicate can be modeled as an independent Bernoulli trial indicating presence ($1$) or absence ($0$) of the split, with an unknown true split frequency $p$ that is the long-run bootstrap recovery probability for this branch.\n\nStarting from the binomial model and the definition of the score test for a binomial proportion, derive the Wilson score confidence interval for $p$ at $95\\%$ confidence and use it to compute the interval for the given $k$ and $R$. Then, interpret the interval in the context of decision-making under the following conservative policy: declare the branch “moderately supported” only if the lower bound of the $95\\%$ confidence interval (CI) is at least $0.70$. Round both numerical bounds of the interval to four significant figures. Report the two bounds as numerical values without units.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It presents a standard problem in applied statistics within the field of evolutionary biology. Therefore, it is deemed valid, and a solution will be provided.\n\nThe problem requires the derivation and computation of a $95\\%$ Wilson score confidence interval for a binomial proportion $p$. The number of times a specific split is observed, $k$, in $R$ bootstrap replicates is modeled as a random variable following a binomial distribution, $k \\sim \\text{Bin}(R, p)$, where $p$ is the true underlying probability of observing the split in a single replicate.\n\nThe derivation of the Wilson score interval begins by inverting the score test for the null hypothesis $H_0: p = p_0$. The score test statistic is based on the log-likelihood function for the binomial model:\n$$ \\ell(p; k) = \\ln\\binom{R}{k} + k \\ln(p) + (R-k) \\ln(1-p) $$\nThe score function, $U(p)$, is the first derivative of the log-likelihood with respect to $p$:\n$$ U(p) = \\frac{\\partial \\ell}{\\partial p} = \\frac{k}{p} - \\frac{R-k}{1-p} = \\frac{k(1-p) - (R-k)p}{p(1-p)} = \\frac{k - Rp}{p(1-p)} $$\nThe Fisher information, $I(p)$, is the negative expected value of the second derivative of the log-likelihood:\n$$ I(p) = -E\\left[\\frac{\\partial^2 \\ell}{\\partial p^2}\\right] = -E\\left[-\\frac{k}{p^2} - \\frac{R-k}{(1-p)^2}\\right] = \\frac{E[k]}{p^2} + \\frac{E[R-k]}{(1-p)^2} $$\nSince $E[k] = Rp$, we have:\n$$ I(p) = \\frac{Rp}{p^2} + \\frac{R-Rp}{(1-p)^2} = \\frac{R}{p} + \\frac{R}{1-p} = \\frac{R}{p(1-p)} $$\nThe score test statistic, which is approximately standard normal under $H_0$, is given by:\n$$ Z = \\frac{U(p_0)}{\\sqrt{I(p_0)}} = \\frac{(k - Rp_0) / (p_0(1-p_0))}{\\sqrt{R / (p_0(1-p_0))}} = \\frac{k - Rp_0}{\\sqrt{R p_0(1-p_0)}} $$\nLet $\\hat{p} = k/R$ be the sample proportion. The test statistic can be rewritten as:\n$$ Z = \\frac{R(\\hat{p} - p_0)}{\\sqrt{R p_0(1-p_0)}} = \\frac{\\sqrt{R}(\\hat{p} - p_0)}{\\sqrt{p_0(1-p_0)}} $$\nA $(1-\\alpha)$ confidence interval for $p$ is the set of all values $p_0$ for which we do not reject the null hypothesis $H_0: p = p_0$ at significance level $\\alpha$. This condition is $|Z| \\leq z_{\\alpha/2}$, where $z_{\\alpha/2}$ is the upper $\\alpha/2$ quantile of the standard normal distribution. We solve the inequality $Z^2 \\leq z_{\\alpha/2}^2$:\n$$ \\frac{R(\\hat{p}-p)^2}{p(1-p)} \\leq z_{\\alpha/2}^2 $$\nThis inequality must be solved for $p$. Rearranging gives a quadratic inequality:\n$$ R(\\hat{p}^2 - 2\\hat{p}p + p^2) \\leq z_{\\alpha/2}^2 (p - p^2) $$\n$$ (R + z_{\\alpha/2}^2)p^2 - (2R\\hat{p} + z_{\\alpha/2}^2)p + R\\hat{p}^2 \\leq 0 $$\nThe roots of the corresponding quadratic equation $(R + z_{\\alpha/2}^2)p^2 - (2R\\hat{p} + z_{\\alpha/2}^2)p + R\\hat{p}^2 = 0$ provide the bounds of the confidence interval. Using the quadratic formula $p = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$, with $A = R + z_{\\alpha/2}^2$, $B = -(2R\\hat{p} + z_{\\alpha/2}^2)$, and $C = R\\hat{p}^2$, we obtain the interval bounds:\n$$ p = \\frac{2R\\hat{p} + z_{\\alpha/2}^2 \\pm \\sqrt{(2R\\hat{p} + z_{\\alpha/2}^2)^2 - 4(R + z_{\\alpha/2}^2)(R\\hat{p}^2)}}{2(R + z_{\\alpha/2}^2)} $$\nSimplifying the term under the square root yields:\n$$ p = \\frac{2R\\hat{p} + z_{\\alpha/2}^2 \\pm z_{\\alpha/2}\\sqrt{4R\\hat{p}(1-\\hat{p}) + z_{\\alpha/2}^2}}{2(R + z_{\\alpha/2}^2)} $$\nDividing the numerator and denominator by $2R$, we arrive at the standard form for the Wilson score interval:\n$$ p = \\frac{\\hat{p} + \\frac{z_{\\alpha/2}^2}{2R} \\pm z_{\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{R} + \\frac{z_{\\alpha/2}^2}{4R^2}}}{1 + \\frac{z_{\\alpha/2}^2}{R}} $$\nWe are given $R=800$ bootstrap replicates and $k=584$ successes. The sample proportion is $\\hat{p} = \\frac{584}{800} = 0.73$.\nFor a $95\\%$ confidence interval, $\\alpha = 0.05$, so $\\alpha/2 = 0.025$. The corresponding standard normal quantile is $z_{0.025} \\approx 1.96$. We use this value in our calculations. Then $z_{\\alpha/2}^2 \\approx (1.96)^2 = 3.8416$.\n\nWe substitute these values into the derived formula:\nThe denominator is $1 + \\frac{z_{\\alpha/2}^2}{R} = 1 + \\frac{3.8416}{800} = 1 + 0.004802 = 1.004802$.\nThe first term in the numerator is $\\hat{p} + \\frac{z_{\\alpha/2}^2}{2R} = 0.73 + \\frac{3.8416}{1600} = 0.73 + 0.002401 = 0.732401$.\nThe term under the square root in the numerator is $\\frac{\\hat{p}(1-\\hat{p})}{R} + \\frac{z_{\\alpha/2}^2}{4R^2} = \\frac{0.73 \\times 0.27}{800} + \\frac{3.8416}{4 \\times 800^2} = \\frac{0.1971}{800} + \\frac{3.8416}{2560000} \\approx 0.000246375 + 0.0000015 = 0.000247875$.\nThe second term in the numerator is $z_{\\alpha/2}\\sqrt{0.000247875} \\approx 1.96 \\times 0.01574404 \\approx 0.0308583$.\n\nThe interval bounds are thus:\n$$ p \\approx \\frac{0.732401 \\pm 0.0308583}{1.004802} $$\nThe lower bound is:\n$$ p_L \\approx \\frac{0.732401 - 0.0308583}{1.004802} = \\frac{0.7015427}{1.004802} \\approx 0.698189 $$\nThe upper bound is:\n$$ p_U \\approx \\frac{0.732401 + 0.0308583}{1.004802} = \\frac{0.7632593}{1.004802} \\approx 0.759610 $$\nRounding these bounds to four significant figures gives $p_L \\approx 0.6982$ and $p_U \\approx 0.7596$.\nThe $95\\%$ Wilson score confidence interval for the true split frequency $p$ is approximately $[0.6982, 0.7596]$.\n\nThe problem requires an interpretation of this result based on a conservative policy: a branch is declared \"moderately supported\" only if the lower bound of its $95\\%$ CI is at least $0.70$.\nOur calculated lower bound is $p_L \\approx 0.6982$. We must check if $p_L \\geq 0.70$.\nSince $0.6982 < 0.70$, the condition is not satisfied.\nTherefore, according to the specified policy, the statistical support for this branch is insufficient to be classified as \"moderately supported\". The true frequency $p$ could plausibly be less than $70\\%$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.6982 & 0.7596 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Beyond random sampling error, phylogenetic inference can be plagued by systematic biases like long-branch attraction (LBA), where high support is incorrectly assigned to unrelated, rapidly evolving lineages. Understanding the conditions that cause and mitigate LBA is critical for robust phylogenetic practice. This hands-on theoretical problem  explores how strategically adding taxa can break up long branches and rescue the analysis from misleadingly high support, illustrating a fundamental principle of experimental design in phylogenomics.",
            "id": "2692783",
            "problem": "Consider a four-lineage phylogeny under a site-homogeneous, time-reversible nucleotide substitution model with independent and identically distributed sites. Two lineages, labeled $A$ and $B$, are separated by a short internal branch of length $t$ and each subtends a long terminal branch of length $L$. The true topology does not group $A$ and $B$ together. Suppose that tree inference within each bootstrap replicate is decided by a majority rule over informative sites: a replicate supports the true internal split if and only if the number of informative sites that favor the true split exceeds the number that favor the incorrect $A$-$B$ split. Let $n$ be the number of i.i.d. sites in the alignment.\n\nAssume the following per-site categorization holds to first order in branch lengths:\n- With probability $p_{c}$, a site is informative in favor of the true internal split, reflecting substitutions along the short internal branch (this probability depends on $t$ but is treated here as a fixed constant, independent of taxon sampling along the long branches).\n- With probability $p_{w}(k)$, a site is informative in favor of the incorrect $A$-$B$ split due to convergent substitutions on the terminal portions of the long branches feeding $A$ and $B$. Assume $k$ additional taxa are sampled on each of the long branches, placed so as to split each long branch of length $L$ into $k+1$ equal terminal segments of length $L/(k+1)$. In the small-time Poisson regime, the probability of two independent same-state changes on the two terminal segments scales with the product of segment lengths, so that $p_{w}(k) = \\beta \\left(\\frac{L}{k+1}\\right)^{2}$, where $\\beta$ is a constant capturing the per-site substitution rate and model-specific state-matching factor. The remaining sites, with probability $1 - p_{c} - p_{w}(k)$, are uninformative.\n\nFor large $n$, use fundamental definitions of nonparametric bootstrap support, multinomial sampling, and asymptotic normality of sums of i.i.d. indicator variables to derive an analytic expression for the expected bootstrap support $S(k)$ of the true split as a function of $k$, $n$, $p_{c}$, $\\beta$, and $L$. Then, express the expected change in support due to adding taxa that break the long branches,\n$$\\Delta S(k) \\equiv S(k) - S(0),$$\nas a closed-form function of $k$, $n$, $p_{c}$, $\\beta$, and $L$.\n\nProvide your final answer as a single closed-form expression for $\\Delta S(k)$. No numerical evaluation is required, and no rounding is needed. All symbols must be clearly defined in your derivation.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is a well-posed, scientifically grounded problem in theoretical evolutionary biology that admits a unique analytical solution based on the provided premises.\n\nThe problem requires the derivation of the expected change in bootstrap support, $\\Delta S(k) \\equiv S(k) - S(0)$, for the true phylogenetic split as a function of increased taxon sampling, represented by the integer $k$.\n\nFirst, we formalize the probabilistic model for the sites in the alignment. The alignment consists of $n$ independent and identically distributed (i.i.d.) sites. For any given site, there are three possible outcomes relevant to the inference of the internal branch:\n1.  The site is informative for the true split, with probability $p_c$.\n2.  The site is informative for the incorrect split grouping taxa $A$ and $B$, with probability $p_w(k)$. This probability depends on the number of additional taxa, $k$, and is given by $p_w(k) = \\beta \\left(\\frac{L}{k+1}\\right)^2$.\n3.  The site is uninformative, with probability $1 - p_c - p_w(k)$.\n\nThe nonparametric bootstrap support for the true split, $S(k)$, is the probability that a single bootstrap replicate will support this split. A bootstrap replicate consists of $n$ sites drawn with replacement from the original alignment. For large $n$, the composition of a bootstrap sample converges to the underlying site probabilities. The problem defines the decision rule within a replicate: the true split is supported if and only if the number of sites favoring the true split, which we shall denote $N_c$, is strictly greater than the number of sites favoring the incorrect $A$-$B$ split, denoted $N_w$.\n\nTo analyze this condition, $N_c > N_w$, we can define a random variable, $X_i$, for each of the $n$ sites drawn in a bootstrap replicate. Let:\n- $X_i = 1$ if the $i$-th site supports the true split.\n- $X_i = -1$ if the $i$-th site supports the incorrect $A$-$B$ split.\n- $X_i = 0$ if the $i$-th site is uninformative.\n\nThe probabilities for these outcomes are $P(X_i = 1) = p_{c}$, $P(X_i = -1) = p_{w}(k)$, and $P(X_i = 0) = 1 - p_{c} - p_{w}(k)$. The variables $X_i$ for $i=1, \\dots, n$ are i.i.d.\nThe condition for supporting the true split, $N_c > N_w$, is equivalent to the condition that the sum $Y_n = \\sum_{i=1}^{n} X_i$ is positive, i.e., $Y_n > 0$. The expected bootstrap support is therefore $S(k) = P(Y_n > 0)$.\n\nFor large $n$, the Central Limit Theorem states that the distribution of the sum $Y_n$ approaches a normal distribution. To apply this theorem, we must find the mean and variance of the random variable $X_i$.\n\nThe mean of $X_i$, which we denote $\\mu_X(k)$, is:\n$$ \\mu_X(k) = E[X_i] = (1)(p_{c}) + (-1)(p_{w}(k)) + (0)(1 - p_{c} - p_{w}(k)) = p_{c} - p_{w}(k) $$\n\nThe variance of $X_i$, denoted $\\sigma_X^2(k)$, is $Var(X_i) = E[X_i^2] - (E[X_i])^2$. First we compute $E[X_i^2]$:\n$$ E[X_i^2] = (1)^2(p_{c}) + (-1)^2(p_{w}(k)) + (0)^2(1 - p_{c} - p_{w}(k)) = p_{c} + p_{w}(k) $$\nThus, the variance is:\n$$ \\sigma_X^2(k) = (p_{c} + p_{w}(k)) - (p_{c} - p_{w}(k))^2 $$\n\nAccording to the Central Limit Theorem, the sum $Y_n = \\sum_{i=1}^{n} X_i$ is approximately normally distributed with mean $E[Y_n] = n \\mu_X(k)$ and variance $Var(Y_n) = n \\sigma_X^2(k)$.\n$$ Y_n \\sim \\mathcal{N}\\left(n(p_{c} - p_{w}(k)), n[(p_{c} + p_{w}(k)) - (p_{c} - p_{w}(k))^2]\\right) $$\n\nWe can now compute the support $S(k) = P(Y_n > 0)$. We standardize the random variable $Y_n$:\n$$ S(k) = P\\left(\\frac{Y_n - E[Y_n]}{\\sqrt{Var(Y_n)}} > \\frac{0 - E[Y_n]}{\\sqrt{Var(Y_n)}}\\right) $$\nLet $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution, $\\mathcal{N}(0,1)$. The above probability becomes:\n$$ S(k) = P\\left(Z > -\\frac{E[Y_n]}{\\sqrt{Var(Y_n)}}\\right) = 1 - \\Phi\\left(-\\frac{E[Y_n]}{\\sqrt{Var(Y_n)}}\\right) = \\Phi\\left(\\frac{E[Y_n]}{\\sqrt{Var(Y_n)}}\\right) $$\nSubstituting the expressions for the mean and variance:\n$$ S(k) = \\Phi\\left(\\frac{n(p_{c} - p_{w}(k))}{\\sqrt{n[(p_{c} + p_{w}(k)) - (p_{c} - p_{w}(k))^2]}}\\right) = \\Phi\\left(\\frac{\\sqrt{n}(p_{c} - p_{w}(k))}{\\sqrt{(p_{c} + p_{w}(k)) - (p_{c} - p_{w}(k))^2}}\\right) $$\n\nWe are given $p_{w}(k) = \\beta \\left(\\frac{L}{k+1}\\right)^2$. Substituting this into the expression for $S(k)$, we find:\n$$ S(k) = \\Phi\\left(\\frac{\\sqrt{n}\\left(p_{c} - \\beta \\left(\\frac{L}{k+1}\\right)^2\\right)}{\\sqrt{\\left(p_{c} + \\beta \\left(\\frac{L}{k+1}\\right)^2\\right) - \\left(p_{c} - \\beta \\left(\\frac{L}{k+1}\\right)^2\\right)^2}}\\right) $$\n\nThe problem asks for the change in support, $\\Delta S(k) = S(k) - S(0)$. The term $S(0)$ corresponds to the case with no additional taxa, i.e., $k=0$. In this case, $p_{w}(0) = \\beta \\left(\\frac{L}{0+1}\\right)^2 = \\beta L^2$.\nSo, $S(0)$ is given by:\n$$ S(0) = \\Phi\\left(\\frac{\\sqrt{n}(p_{c} - \\beta L^2)}{\\sqrt{(p_{c} + \\beta L^2) - (p_{c} - \\beta L^2)^2}}\\right) $$\n\nFinally, the expected change in support due to adding $k$ taxa on each long branch is:\n$$ \\Delta S(k) = S(k) - S(0) $$\nThis yields the closed-form expression for $\\Delta S(k)$ as the difference of two values of the standard normal CDF. This is the final analytical expression required.\nLet us define the argument of the function $\\Phi$ as $z(k)$:\n$$ z(k) = \\frac{\\sqrt{n}\\left(p_{c} - \\beta \\left(\\frac{L}{k+1}\\right)^2\\right)}{\\sqrt{\\left(p_{c} + \\beta \\left(\\frac{L}{k+1}\\right)^2\\right) - \\left(p_{c} - \\beta \\left(\\frac{L}{k+1}\\right)^2\\right)^2}} $$\nThen $\\Delta S(k) = \\Phi(z(k)) - \\Phi(z(0))$.",
            "answer": "$$\n\\boxed{\n\\Phi\\left(\\frac{\\sqrt{n}\\left(p_{c} - \\beta \\left(\\frac{L}{k+1}\\right)^2\\right)}{\\sqrt{\\left(p_{c} + \\beta \\left(\\frac{L}{k+1}\\right)^2\\right) - \\left(p_{c} - \\beta \\left(\\frac{L}{k+1}\\right)^2\\right)^2}}\\right) - \\Phi\\left(\\frac{\\sqrt{n}\\left(p_{c} - \\beta L^2\\right)}{\\sqrt{\\left(p_{c} + \\beta L^2\\right) - \\left(p_{c} - \\beta L^2\\right)^2}}\\right)\n}\n$$"
        },
        {
            "introduction": "While frequentist bootstrap values measure the consistency of a signal in the data, Bayesian posterior probabilities quantify the degree of belief in a hypothesis after seeing the data. A key difference is the explicit role of a prior model. This exercise  delves into the heart of Bayesian interpretation by having you calculate the prior probability of a clade under a common topological prior and use it to compute a Bayes factor, which reframes the posterior probability as a measure of evidence provided by the data.",
            "id": "2692802",
            "problem": "Design and implement a program that operationalizes a prior predictive assessment for a user-specified clade in rooted, fully bifurcating, labeled phylogenies, and uses this to calibrate the interpretation of observed posterior probabilities via Bayes factors. Work from first principles of Bayesian inference and combinatorial counting of labeled tree topologies.\n\nBase assumptions and definitions:\n- Consider rooted, fully bifurcating phylogenetic trees on a fixed labeled taxon set of size $n$. Assume the Proportional to Distinguishable Arrangements (PDA) prior, which assigns equal probability to each labeled rooted binary topology.\n- The number of distinct labeled rooted binary trees with $n$ labeled leaves is given by the double factorial $T(n) = (2n - 3)!!$ for $n \\ge 2$, with $T(1) = 1$.\n- A subset of the taxa $C \\subset \\{1,\\dots,n\\}$ of size $k = |C|$ is a monophyletic clade in a rooted tree if and only if there exists an internal node whose descendant leaf set is exactly $C$.\n- Under the PDA prior, the prior probability that a particular fixed subset $C$ of size $k$ is a clade equals the fraction of labeled rooted binary trees on $n$ leaves in which $C$ is a clade.\n\nStarting from these bases, derive a formula for the prior probability $p_0$ that a specified subset $C$ of size $k$ is a clade under the PDA prior, expressed using only $n$, $k$, and the double factorial function. Then, given an observed posterior probability $p$ for the same clade from a Bayesian phylogenetic analysis (expressed as a decimal, not a percentage), compute the Bayes factor $\\mathrm{BF}_{10}$ in favor of the clade versus its complement by combining the prior baseline and the observed posterior via Bayes’ theorem.\n\nYour program must:\n- Implement the exact prior probability $p_0$ for a clade of size $k$ under the PDA prior using the derived formula (no stochastic approximation).\n- Compute the Bayes factor $\\mathrm{BF}_{10}$ implied by an observed posterior probability $p$ using the odds form of Bayes’ theorem.\n- Apply the above to each parameter triple $(n,k,p)$ in the test suite below, and for each case output two floats: first the prior probability $p_0$, then the Bayes factor $\\mathrm{BF}_{10}$.\n- Round all floats to $6$ decimal places.\n\nScientific constraints and guidance:\n- Use only the PDA prior on labeled rooted binary topologies. Do not assume any sequence evolution model; do not simulate sequence data.\n- Treat the “observed posterior probability” $p$ as a given summary from a Bayesian analysis; you must not transform $p$ further except to compute the Bayes factor via odds.\n- All probabilities must be expressed as decimals in $[0,1]$.\n- Ensure numerical stability by avoiding division by zero in edge cases; the test suite avoids degenerate inputs ($p \\in \\{0,1\\}$, $k \\in \\{0,1,n\\}$).\n\nTest suite:\n- Case A: $(n,k,p) = (5,2,0.95)$.\n- Case B: $(n,k,p) = (6,3,0.9)$.\n- Case C: $(n,k,p) = (7,2,0.75)$.\n- Case D: $(n,k,p) = (7,6,0.9)$.\n\nAnswer specification:\n- For each case, compute the pair $(p_0,\\mathrm{BF}_{10})$ where $p_0$ is the prior probability that a fixed subset of size $k$ is a clade under the PDA prior for $n$ taxa, and $\\mathrm{BF}_{10}$ is the Bayes factor implied by the observed posterior probability $p$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[p_{0,A}, \\mathrm{BF}_{10,A}, p_{0,B}, \\mathrm{BF}_{10,B}, p_{0,C}, \\mathrm{BF}_{10,C}, p_{0,D}, \\mathrm{BF}_{10,D}]$, with each float rounded to $6$ decimal places.\n\nMathematical requirements to be derived and used in your solution (do not provide shortcuts in the problem statement):\n- Derive $T(n)$ and the combinatorial count of labeled rooted binary trees in which a fixed subset of size $k$ is a clade, from which $p_0$ follows as a ratio of counts.\n- Derive the Bayes factor in terms of prior and posterior odds: if the prior probability is $p_0$ and the posterior probability is $p$, then\n$$\n\\mathrm{BF}_{10} \\;=\\; \\frac{p/(1-p)}{p_0/(1-p_0)} \\,.\n$$\n\nAll mathematical entities must be written in LaTeX, inside $...$ or $$...$$ as appropriate.\n\nYour program must be self-contained, require no user input, and follow the exact output format described above.",
            "solution": "The problem has been analyzed and is determined to be valid. It is scientifically sound, resting on established principles of combinatorial mathematics and Bayesian statistical inference as applied to phylogenetics. The problem is well-posed, with all necessary definitions and constraints provided, leading to a unique and meaningful solution. There are no contradictions, ambiguities, or factual unsoundness. We shall proceed with a formal derivation and solution.\n\nThe objective is to operationalize a prior predictive assessment for a specified clade. This requires two main components: first, the derivation of the prior probability of the clade under the Proportional to Distinguishable Arrangements (PDA) prior; second, the calculation of the Bayes factor that quantifies the evidence for the clade, given an observed posterior probability.\n\nFirst, we derive the prior probability, $p_0$, that a fixed subset of taxa $C$, with size $|C|=k$, forms a monophyletic clade in a rooted, binary, labeled tree of $n$ taxa.\n\nThe PDA prior assumes that every distinct labeled rooted binary tree topology is equally likely. Therefore, the prior probability of a specific hypothesis about tree structure, such as the monophyly of a group $C$, is the ratio of the number of topologies satisfying the hypothesis to the total number of possible topologies.\n\nThe total number of distinct labeled rooted binary trees on $n$ leaves, $T(n)$, is given by the double factorial function:\n$$\nT(n) = (2n-5)!! \\times (2n-3) \\text{ for } n > 2\n$$\nA recursive argument shows that to form a tree with $n$ taxa from a tree with $n-1$ taxa, the $n$-th taxon can be added to any of the $2(n-1)-1 = 2n-3$ existing edges. This leads to the recurrence $T(n) = (2n-3)T(n-1)$. With the base case $T(2)=1$, we obtain the closed form for $n \\ge 2$:\n$$\nT(n) = (2n-3)!! = \\prod_{i=1}^{n-1} (2i-1)\n$$\nThe problem statement provides a slightly different formula, $T(n)=(2n-3)!!$ for $n \\ge 2$, with $T(1)=1$. This is correct. For $n=2$, $(2(2)-3)!! = 1!! = 1$. For $n=3$, $(2(3)-3)!! = 3!! = 3$. This matches the number of rooted trees for 3 taxa.\n\nNext, we must count the number of such trees, let us call this $N_{\\text{clade}}(n,k)$, in which the specified subset $C$ of size $k$ is a clade. For $C$ to be a clade, its members must all descend from a common internal node whose descendant leaf set is precisely $C$. We can count these trees by constructing them in two stages:\n1.  The internal topology of the clade $C$. The taxa in $C$ themselves form a labeled rooted binary tree of size $k$. The number of ways to arrange these $k$ taxa within their own subtree is $T(k) = (2k-3)!!$.\n2.  The external topology. We can treat the entire clade $C$ as a single composite leaf or \"supertaxon\". The problem then reduces to finding the number of labeled rooted binary trees for the remaining $n-k$ taxa plus this one supertaxon. This is a tree on $(n-k)+1$ leaves. The number of such topologies is $T(n-k+1) = (2(n-k+1)-3)!! = (2n-2k-1)!!$.\n\nBy the multiplication principle of counting, the total number of trees where $C$ is a clade is the product of these two counts:\n$$\nN_{\\text{clade}}(n,k) = T(k) \\times T(n-k+1) = (2k-3)!! \\times (2n-2k-1)!!\n$$\nThis formula is valid for $2 \\le k \\le n-1$, which ensures that both $T(k)$ and $T(n-k+1)$ are well-defined for binary trees ($k \\ge 2$ and $n-k+1 \\ge 2$).\n\nThe prior probability $p_0$ is the ratio of $N_{\\text{clade}}(n,k)$ to the total number of trees $T(n)$:\n$$\np_0 = \\frac{N_{\\text{clade}}(n,k)}{T(n)} = \\frac{(2k-3)!! \\times (2n-2k-1)!!}{(2n-3)!!}\n$$\nThis is the required formula for the prior probability of the clade.\n\nSecond, we derive the formula for the Bayes factor $\\mathrm{BF}_{10}$. The Bayes factor is the ratio of the posterior odds to the prior odds. Let $H_1$ be the hypothesis that the group $C$ is a clade, and $H_0$ be the alternative hypothesis that it is not.\nLet $p$ be the posterior probability of $H_1$ given some data $D$, so $p = P(H_1|D)$.\nLet $p_0$ be the prior probability of $H_1$, so $p_0 = P(H_1)$.\n\nThe prior odds in favor of $H_1$ are:\n$$\n\\text{Odds}_{\\text{prior}} = \\frac{P(H_1)}{P(H_0)} = \\frac{p_0}{1-p_0}\n$$\nThe posterior odds in favor of $H_1$ are:\n$$\n\\text{Odds}_{\\text{posterior}} = \\frac{P(H_1|D)}{P(H_0|D)} = \\frac{p}{1-p}\n$$\nAccording to the odds form of Bayes' theorem, the posterior odds are the product of the prior odds and the Bayes factor $\\mathrm{BF}_{10}$:\n$$\n\\text{Odds}_{\\text{posterior}} = \\mathrm{BF}_{10} \\times \\text{Odds}_{\\text{prior}}\n$$\nSolving for the Bayes factor gives:\n$$\n\\mathrm{BF}_{10} = \\frac{\\text{Odds}_{\\text{posterior}}}{\\text{Odds}_{\\text{prior}}} = \\frac{p/(1-p)}{p_0/(1-p_0)}\n$$\nThis formula quantifies the evidence from the data, which shifts the prior odds to the posterior odds. A value of $\\mathrm{BF}_{10} > 1$ indicates that the data support the hypothesis that $C$ is a clade.\n\nThe computational procedure is as follows:\n1.  For each test case $(n, k, p)$, compute the double factorials $(2k-3)!!$, $(2n-2k-1)!!$, and $(2n-3)!!$.\n2.  Use these values to calculate the prior probability $p_0$ via the derived formula.\n3.  Use the calculated $p_0$ and the given posterior probability $p$ to calculate the Bayes factor $\\mathrm{BF}_{10}$.\n4.  Round both $p_0$ and $\\mathrm{BF}_{10}$ to $6$ decimal places and report the results.\nThis procedure is implemented in the provided program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef double_factorial(n: int) -> int:\n    \"\"\"\n    Computes the double factorial n!! = n * (n-2) * (n-4) * ...\n    For n >= 0. By convention, 0!! = 1.\n    \"\"\"\n    if not isinstance(n, int) or n < 0:\n        raise ValueError(\"Double factorial is defined for non-negative integers only.\")\n    if n == 0 or n == 1:\n        return 1\n    \n    product = 1\n    val = n\n    while val >= 1:\n        product *= val\n        val -= 2\n    return product\n\ndef calculate_prior_probability(n: int, k: int) -> float:\n    \"\"\"\n    Calculates the prior probability p0 that a fixed subset of size k\n    is a clade in a tree of n taxa under the PDA prior.\n    \n    p0 = (T(k) * T(n-k+1)) / T(n)\n       = ((2k-3)!! * (2(n-k+1)-3)!!) / (2n-3)!!\n       = ((2k-3)!! * (2n-2k-1)!!) / (2n-3)!!\n    \"\"\"\n    # Arguments for the double factorial function are derived from the formula.\n    # Constraints 2 <= k <= n-1 ensure all arguments are non-negative.\n    arg_tk = 2 * k - 3\n    arg_t_nk1 = 2 * n - 2 * k - 1\n    arg_tn = 2 * n - 3\n\n    t_k = double_factorial(arg_tk)\n    t_nk1 = double_factorial(arg_t_nk1)\n    t_n = double_factorial(arg_tn)\n\n    # Using floating point division as integer results can be large,\n    # and final result is a float anyway.\n    p0 = (t_k * t_nk1) / t_n\n    return p0\n\ndef calculate_bayes_factor(p: float, p0: float) -> float:\n    \"\"\"\n    Calculates the Bayes factor BF_10 in favor of a clade.\n    BF_10 = (posterior_odds) / (prior_odds)\n          = (p / (1-p)) / (p0 / (1-p0))\n    \"\"\"\n    # Problem constraints ensure p is not 0 or 1,\n    # and p0 is not 0 or 1 for the given k constraints.\n    if p0 == 1.0 or p0 == 0.0:\n        # This case should not be reached with the problem's constraints.\n        # If p0=1, prior odds are infinite. If p0=0, prior odds are zero.\n        # This would lead to division by zero or an infinite BF.\n        return float('inf') if p > 0 else 0.0\n\n    prior_odds = p0 / (1.0 - p0)\n    posterior_odds = p / (1.0 - p)\n    \n    bf10 = posterior_odds / prior_odds\n    return bf10\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (5, 2, 0.95),  # Case A\n        (6, 3, 0.9),   # Case B\n        (7, 2, 0.75),  # Case C\n        (7, 6, 0.9)    # Case D\n    ]\n\n    results = []\n    for n, k, p in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        p0 = calculate_prior_probability(n, k)\n        bf10 = calculate_bayes_factor(p, p0)\n        \n        # Round the results to 6 decimal places and append to the list.\n        results.append(round(p0, 6))\n        results.append(round(bf10, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}