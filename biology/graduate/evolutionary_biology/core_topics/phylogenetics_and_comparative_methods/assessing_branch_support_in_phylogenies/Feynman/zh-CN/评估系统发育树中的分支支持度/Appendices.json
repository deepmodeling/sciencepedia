{
    "hands_on_practices": [
        {
            "introduction": "系统发育分析中的非参数 bootstrap 支持率是通过对原始数据进行有限次数的重采样来估计的。因此，任何一个分支的 bootstrap 支持率值本身就是一个统计估计量，会受到抽样误差的影响。下面的练习将通过一个具体的计算，向您展示当 bootstrap 重复次数不足（例如 $n=20$）时，仅由抽样误差导致的误判概率可能有多高，这是一个对所有实践者都至关重要的警示。",
            "id": "2692789",
            "problem": "一位系统发育分析师使用非参数自助法来评估分支支持度。对于一个目标分支，假设其在单次重采样比对中出现的真实包含概率为 $p$（即，该分支在自助树中被重建）。该分析师进行了 $n$ 次独立的自助法重复，并且如果观察到的自助法比例 $\\hat{p}$ 满足 $\\hat{p} \\ge t$，则将该分支归类为“强支持”，其中 $t$ 是一个固定的支持度阈值，用于关于分支的下游假设检验。假设重采样是独立同分布的，因此每次重复中分支重建的指标是一次成功概率为 $p$ 的伯努利试验。\n\n考虑使用过少重复次数的影响，设 $n = 20$，阈值 $t = 0.95$，真实包含概率 $p = 0.90$（因此，实际上该分支未达到强支持阈值）。在这些假设下，计算仅由抽样误差导致该分支被错误分类为“强支持”的概率，即尽管 $p < t$，观察到的 $\\hat{p}$ 却超过了阈值。\n\n将您的最终结果表示为小数，并四舍五入到四位有效数字。",
            "solution": "问题陈述已经过分析，并被确定为有效。这是一个建立在系统发育推断和概率论原理基础上的、定义明确的统计学问题。它自成体系、客观，并且没有科学或逻辑上的缺陷。我们将继续进行解答。\n\n该问题要求我们计算在系统发育自助法分析中一种特定类型错误的概率。给定一组参数：\n- 独立自助法重复次数，$n = 20$。\n- 目标分支的真实包含概率，$p = 0.90$。\n- 将分支归类为“强支持”的阈值，$t = 0.95$。\n\n在 $n$ 次自助法重复中，每次分支的重建被建模为一次成功概率为 $p$ 的独立伯努利试验。设随机变量 $X$ 表示在 $n$ 次重复中分支被重建的总次数。因此，随机变量 $X$ 服从参数为 $n$ 和 $p$ 的二项分布，我们记为 $X \\sim \\text{Bin}(n, p)$。\n\n观察到的自助法比例 $\\hat{p}$ 定义为成功次数 $X$ 除以总试验次数 $n$。因此，$\\hat{p} = \\frac{X}{n}$。\n\n如果一个分支在其真实包含概率 $p$ 小于阈值 $t$ 的情况下仍被归类为“强支持”，则发生错误分类。这种错误分类的条件是 $\\hat{p} \\ge t$。我们必须计算这个事件的概率，即 $P(\\hat{p} \\ge t)$。\n\n我们可以用随机变量 $X$ 来表示这个条件：\n$$ \\frac{X}{n} \\ge t $$\n$$ X \\ge n \\cdot t $$\n代入给定值 $n = 20$ 和 $t = 0.95$：\n$$ X \\ge 20 \\cdot 0.95 $$\n$$ X \\ge 19 $$\n由于 $X$ 必须是一个整数（因为它代表计数），这个不等式意味着如果 $X = 19$ 或 $X = 20$，就会发生错误分类。因此，我们需要计算 $P(X \\ge 19) = P(X=19) + P(X=20)$。\n\n二项分布的概率质量函数（PMF）由下式给出：\n$$ P(X=k) = \\binom{n}{k} p^k (1-p)^{n-k} $$\n我们将使用这个函数来计算 $k=19$ 和 $k=20$ 时的概率。\n\n对于 $k=19$：\n$$ P(X=19) = \\binom{20}{19} (0.90)^{19} (1-0.90)^{20-19} $$\n$$ P(X=19) = \\frac{20!}{19!1!} (0.90)^{19} (0.10)^1 $$\n$$ P(X=19) = 20 \\cdot (0.90)^{19} \\cdot 0.10 $$\n$$ P(X=19) = 2 \\cdot (0.90)^{19} $$\n\n对于 $k=20$：\n$$ P(X=20) = \\binom{20}{20} (0.90)^{20} (1-0.90)^{20-20} $$\n$$ P(X=20) = \\frac{20!}{20!0!} (0.90)^{20} (0.10)^0 $$\n$$ P(X=20) = 1 \\cdot (0.90)^{20} \\cdot 1 $$\n$$ P(X=20) = (0.90)^{20} $$\n\n错误分类的总概率是这两个概率之和：\n$$ P(X \\ge 19) = P(X=19) + P(X=20) = 2 \\cdot (0.90)^{19} + (0.90)^{20} $$\n我们可以分解这个表达式以便计算：\n$$ P(X \\ge 19) = (0.90)^{19} \\cdot (2 + 0.90) = 2.9 \\cdot (0.90)^{19} $$\n现在，我们计算数值：\n$$ (0.90)^{19} \\approx 0.135085171681387 $$\n$$ P(X=19) \\approx 2 \\cdot 0.135085171681387 = 0.270170343362774 $$\n$$ (0.90)^{20} \\approx 0.1215766545132483 $$\n$$ P(X \\ge 19) \\approx 0.270170343362774 + 0.1215766545132483 = 0.3917469978760223 $$\n\n问题要求答案四舍五入到四位有效数字。计算出的概率是 $0.39174699...$。第四位有效数字是 $7$。其后的数字是 $4$，小于 $5$，因此我们进行舍位处理。\n\n错误分类的概率约为 $0.3917$。这个结果表明，使用不足的自助法重复次数可能导致相当大的概率错误地得出某个分支是强支持的结论。",
            "answer": "$$\\boxed{0.3917}$$"
        },
        {
            "introduction": "认识到 bootstrap 支持率的统计不确定性后，一个自然的问题是如何量化这种不确定性。仅仅报告一个点估计值（例如，73% 的支持率）可能具有误导性，更严谨的方法是提供一个区间估计。本练习将指导您为一个观测到的 bootstrap 比例推导并计算一个置信区间，从而为评估分支的可靠性提供一个更稳健的统计基础。",
            "id": "2692757",
            "problem": "在系统发育推断中，通常使用非参数自举重复来评估候选分支（进化支）的支持度。考虑一个最大似然（ML）树中的目标内部支。您生成了 $R = 800$ 次非参数自举重复，其中该分支在 $k = 584$ 次重复中出现。假设每次自举重复可以建模为一次独立的伯努利试验，指示该分支的出现（$1$）或不出现（$0$），其未知的真实分支频率为 $p$，即该分支的长期自举恢复概率。\n\n从二项模型和二项比例分数检验的定义出发，推导 $p$ 在 $95\\%$ 置信度下的 Wilson 分数置信区间，并使用它为给定的 $k$ 和 $R$ 计算该区间。然后，在以下保守策略的决策制定背景下解释该区间：仅当 $95\\%$ 置信区间（CI）的下界至少为 $0.70$ 时，才宣布该分支为“中度支持”。将区间的两个数值界限四舍五入到四位有效数字。以不带单位的数值形式报告这两个界限。",
            "solution": "该问题陈述具有科学依据、良置、客观且自洽。它提出了一个在演化生物学领域内应用统计学中的标准问题。因此，该问题被认为是有效的，并将提供解答。\n\n该问题要求推导并计算二项比例 $p$ 的 $95\\%$ Wilson 分数置信区间。在 $R$ 次自举重复中观察到特定分支的次数 $k$ 被建模为服从二项分布的随机变量，即 $k \\sim \\text{Bin}(R, p)$，其中 $p$ 是单次重复中观察到该分支的真实基础概率。\n\nWilson 分数区间的推导始于对原假设 $H_0: p = p_0$ 的分数检验进行反演。分数检验统计量基于二项模型的对数似然函数：\n$$ \\ell(p; k) = \\ln\\binom{R}{k} + k \\ln(p) + (R-k) \\ln(1-p) $$\n分数函数 $U(p)$ 是对数似然函数关于 $p$ 的一阶导数：\n$$ U(p) = \\frac{\\partial \\ell}{\\partial p} = \\frac{k}{p} - \\frac{R-k}{1-p} = \\frac{k(1-p) - (R-k)p}{p(1-p)} = \\frac{k - Rp}{p(1-p)} $$\n费雪信息 $I(p)$ 是对数似然函数二阶导数的负期望值：\n$$ I(p) = -E\\left[\\frac{\\partial^2 \\ell}{\\partial p^2}\\right] = -E\\left[-\\frac{k}{p^2} - \\frac{R-k}{(1-p)^2}\\right] = \\frac{E[k]}{p^2} + \\frac{E[R-k]}{(1-p)^2} $$\n因为 $E[k] = Rp$，我们有：\n$$ I(p) = \\frac{Rp}{p^2} + \\frac{R-Rp}{(1-p)^2} = \\frac{R}{p} + \\frac{R}{1-p} = \\frac{R}{p(1-p)} $$\n在 $H_0$ 下近似服从标准正态分布的分数检验统计量由下式给出：\n$$ Z = \\frac{U(p_0)}{\\sqrt{I(p_0)}} = \\frac{(k - Rp_0) / (p_0(1-p_0))}{\\sqrt{R / (p_0(1-p_0))}} = \\frac{k - Rp_0}{\\sqrt{R p_0(1-p_0)}} $$\n令 $\\hat{p} = k/R$ 为样本比例。检验统计量可以重写为：\n$$ Z = \\frac{R(\\hat{p} - p_0)}{\\sqrt{R p_0(1-p_0)}} = \\frac{\\sqrt{R}(\\hat{p} - p_0)}{\\sqrt{p_0(1-p_0)}} $$\n$p$ 的 $(1-\\alpha)$ 置信区间是所有 $p_0$ 值的集合，对于这些值，我们在显著性水平 $\\alpha$ 下不拒绝原假设 $H_0: p = p_0$。此条件为 $|Z| \\leq z_{\\alpha/2}$，其中 $z_{\\alpha/2}$ 是标准正态分布的上 $\\alpha/2$ 分位数。我们解不等式 $Z^2 \\leq z_{\\alpha/2}^2$：\n$$ \\frac{R(\\hat{p}-p)^2}{p(1-p)} \\leq z_{\\alpha/2}^2 $$\n这个不等式必须对 $p$ 求解。整理后得到一个二次不等式：\n$$ (R + z_{\\alpha/2}^2)p^2 - (2R\\hat{p} + z_{\\alpha/2}^2)p + R\\hat{p}^2 \\leq 0 $$\n相应二次方程 $(R + z_{\\alpha/2}^2)p^2 - (2R\\hat{p} + z_{\\alpha/2}^2)p + R\\hat{p}^2 = 0$ 的根提供了置信区间的界限。使用二次求根公式 $p = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$，其中 $A = R + z_{\\alpha/2}^2$, $B = -(2R\\hat{p} + z_{\\alpha/2}^2)$ 和 $C = R\\hat{p}^2$，我们得到区间的界限：\n$$ p = \\frac{2R\\hat{p} + z_{\\alpha/2}^2 \\pm \\sqrt{(2R\\hat{p} + z_{\\alpha/2}^2)^2 - 4(R + z_{\\alpha/2}^2)(R\\hat{p}^2)}}{2(R + z_{\\alpha/2}^2)} $$\n化简平方根下的项可得：\n$$ p = \\frac{2R\\hat{p} + z_{\\alpha/2}^2 \\pm z_{\\alpha/2}\\sqrt{4R\\hat{p}(1-\\hat{p}) + z_{\\alpha/2}^2}}{2(R + z_{\\alpha/2}^2)} $$\n将分子和分母同除以 $2R$，我们得到 Wilson 分数区间的标准形式：\n$$ p = \\frac{\\hat{p} + \\frac{z_{\\alpha/2}^2}{2R} \\pm z_{\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{R} + \\frac{z_{\\alpha/2}^2}{4R^2}}}{1 + \\frac{z_{\\alpha/2}^2}{R}} $$\n给定 $R=800$ 次自举重复和 $k=584$ 次成功。样本比例为 $\\hat{p} = \\frac{584}{800} = 0.73$。\n对于 $95\\%$ 置信区间，$\\alpha = 0.05$，所以 $\\alpha/2 = 0.025$。相应的标准正态分位数是 $z_{0.025} \\approx 1.96$。我们在计算中使用这个值。那么 $z_{\\alpha/2}^2 \\approx (1.96)^2 = 3.8416$。\n\n我们将这些值代入推导出的公式中：\n分母为 $1 + \\frac{z_{\\alpha/2}^2}{R} = 1 + \\frac{3.8416}{800} = 1 + 0.004802 = 1.004802$。\n分子中的第一项是 $\\hat{p} + \\frac{z_{\\alpha/2}^2}{2R} = 0.73 + \\frac{3.8416}{1600} = 0.73 + 0.002401 = 0.732401$。\n分子中平方根下的项是 $\\frac{\\hat{p}(1-\\hat{p})}{R} + \\frac{z_{\\alpha/2}^2}{4R^2} = \\frac{0.73 \\times 0.27}{800} + \\frac{3.8416}{4 \\times 800^2} = \\frac{0.1971}{800} + \\frac{3.8416}{2560000} \\approx 0.000246375 + 0.0000015 = 0.000247875$。\n分子中的第二项是 $z_{\\alpha/2}\\sqrt{0.000247875} \\approx 1.96 \\times 0.01574404 \\approx 0.0308583$。\n\n因此，区间界限为：\n$$ p \\approx \\frac{0.732401 \\pm 0.0308583}{1.004802} $$\n下界为：\n$$ p_L \\approx \\frac{0.732401 - 0.0308583}{1.004802} = \\frac{0.7015427}{1.004802} \\approx 0.698189 $$\n上界为：\n$$ p_U \\approx \\frac{0.732401 + 0.0308583}{1.004802} = \\frac{0.7632593}{1.004802} \\approx 0.759610 $$\n将这些界限四舍五入到四位有效数字，得到 $p_L \\approx 0.6982$ 和 $p_U \\approx 0.7596$。\n真实分支频率 $p$ 的 $95\\%$ Wilson 分数置信区间大约为 $[0.6982, 0.7596]$。\n\n问题要求根据一项保守策略对该结果进行解释：仅当一个分支的 $95\\%$ CI 的下界至少为 $0.70$ 时，才宣布其为“中度支持”。\n我们计算出的下界是 $p_L \\approx 0.6982$。我们必须检查是否 $p_L \\ge 0.70$。\n由于 $0.6982 < 0.70$，该条件未被满足。\n因此，根据指定的策略，该分支的统计支持度不足以被归类为“中度支持”。真实频率 $p$ 有可能低于 $70\\%$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.6982 & 0.7596 \\end{pmatrix} } $$"
        },
        {
            "introduction": "除了标准的非参数 bootstrap ($U_{\\mathrm{BS}}$)，研究人员还开发了多种快速评估分支支持的方法，如 Ultrafast Bootstrap ($U_{\\mathrm{UF}}$) 和近似似然比检验 (SH-like aLRT, $U_{\\mathrm{SH}}$)。然而，不同方法的支持度值在统计意义上并不可直接比较。为了在这些方法之间建立一个公平的比较标准，我们可以采用控制 I 型错误率（即错误地支持一个不存在的分支的概率）的框架。这个高级练习将引导您推导如何为不同的支持度量校准决策阈值，以确保它们达到相同的统计严格性水平 $\\alpha$。",
            "id": "2692773",
            "problem": "要求您形式化并实现一个基准校准方案，用于评估系统发育树中的分支支持度，该方案使用三种常用度量：Shimodaira-Hasegawa式近似似然比检验 (SH-like aLRT)、超快自举法 (UFBoot) 和标准非参数自举法。主要目标是为这些支持度度量校准决策阈值，从而将错误支持不存在分支的概率（I型错误）控制在目标水平。\n\n假设存在以下风格化且科学上合理的生成模型，该模型抽象了系统发育支持度评估中的常见做法，同时在数学上易于处理。\n\n1. 对于一个固定的内部自分支（分裂），在原假设（即该分支不存在，真实拓扑不包含此分裂）下，考虑比较该内部分支周围两个最近邻解析的、各位点独立同分布的对数似然比增量 $\\{\\delta_i\\}_{i=1}^{S}$。在原假设下，假定 $\\mathbb{E}[\\delta_i] = 0$ 且 $\\mathrm{Var}(\\delta_i) = \\sigma^2 \\in (0,\\infty)$，其中有 $S \\in \\mathbb{N}$ 个位点。用 $\\Delta = \\sum_{i=1}^{S} \\delta_i$ 表示聚合检验信号。\n\n2. 对于标准非参数自举支持度，将焦点解析的条件支持度 $U_{\\mathrm{BS}}$ 定义为，在给定观测数据集的条件下，自举总和 $\\Delta^\\star$ 为正的条件概率（基于对 $S$ 个位点进行有放回的自举重抽样）。根据中心极限定理的假设，当 $S$ 增大时，给定观测数据下 $\\Delta^\\star$ 的条件分布可以用一个正态分布来近似，该正态分布以观测总和为中心，其方差由 $\\delta_i$ 的经验方差确定。\n\n3. 对于超快自举法 (UFBoot)，通过一个正缩放因子 $\\lambda \\in (0,\\infty)$ 来模拟其相对于标准自举法的重抽样方差，这意味着其重抽样总和的条件分布近似为正态分布，但与标准自举法相比，其方差乘以了 $\\lambda$。将 $U_{\\mathrm{UF}}$ 的定义与 $U_{\\mathrm{BS}}$ 类似，但其中包含了由 $\\lambda$ 编码的方差缩放。\n\n4. 对于SH-like近似似然比检验 (aLRT)，假定该分支的局部检验统计量为 $T = 2 \\Delta \\ell$，即最佳和次佳最近邻解析之间最大对数似然差的两倍。在常规内部零假设下，$T$ 渐近服从自由度为 $1$ 的 $\\chi^2$ 分布。在边界零假设下（例如，分支长度位于边界上），将 $T$ 近似为一个混合分布 $q \\cdot \\delta_0 + (1-q)\\cdot \\chi^2_1$，其中 $q \\in [0,1)$ 是一个固定值，$\\delta_0$ 表示位于 $0$ 处的点质量。假设该方法报告的支持度 $U_{\\mathrm{SH}}$ 是通过将 $\\chi^2_1$ 的累积分布函数应用于 $T$ 得到的。\n\n5. 将I型错误控制定义如下：对于一个指定的目标水平 $\\alpha \\in (0,1)$，为每个支持度度量 $U \\in \\{U_{\\mathrm{BS}}, U_{\\mathrm{UF}}, U_{\\mathrm{SH}}\\}$ 选择一个阈值 $\\tau$，使得在零数据生成模型下，对于重复的数据集，$\\mathbb{P}(U \\ge \\tau) \\le \\alpha$。\n\n任务。从这些定义和近似出发，推导数学上有效的阈值函数，以生成阈值 $\\tau_{\\mathrm{BS}}(\\alpha)$、$\\tau_{\\mathrm{UF}}(\\alpha,\\lambda)$ 和 $\\tau_{\\mathrm{SH}}(\\alpha,q)$，确保在所述零模型下，I型错误被控制在水平 $\\alpha$。您的程序必须实现推导出的公式，并为以下测试套件计算阈值。所有阈值必须表示为 $[0,1]$ 区间内的小数（而非百分比）。\n\n测试套件。对于下面的每个元组 $(\\alpha,\\lambda,q)$，计算一个列表 $[\\tau_{\\mathrm{BS}}(\\alpha), \\tau_{\\mathrm{UF}}(\\alpha,\\lambda), \\tau_{\\mathrm{SH}}(\\alpha,q)]$：\n\n- 情况A（通用，SH-like aLRT的内部零假设）：$(\\alpha,\\lambda,q) = (0.05, 1.0, 0.0)$。\n- 情况B（UFBoot的重抽样方差减小）：$(\\alpha,\\lambda,q) = (0.05, 0.6, 0.0)$。\n- 情况C（SH-like aLRT的边界零假设和UFBoot的方差增大）：$(\\alpha,\\lambda,q) = (0.05, 1.4, 0.5)$。\n- 情况D（小的I型错误目标）：$(\\alpha,\\lambda,q) = (0.01, 0.6, 0.0)$。\n- 情况E（中间边界混合）：$(\\alpha,\\lambda,q) = (0.10, 0.8, 0.2)$。\n- 情况F（粗略控制，伴有强方差膨胀和边界零假设）：$(\\alpha,\\lambda,q) = (0.25, 2.0, 0.5)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素本身是针对一个测试用例的三个小数值的列表，顺序与上文相同。例如：“[[x11,x12,x13],[x21,x22,x23],...]”，其中每个 $x_{ij}$ 是一个浮点数。为确保确定性，请将每个阈值精确舍入到小数点后六位。\n\n约束和说明。\n\n- 您不得返回或打印百分比；阈值必须以 $[0,1]$ 区间内的小数形式返回。\n- 在所有情况下，假定 $\\lambda > 0$ 且 $q \\in [0,1)$。如果在您的推导下，所请求的 $\\alpha$ 对于给定的 $q$ 违反了可行性，请选择 $[0,1]$ 区间内仍然能在您的模型下控制I型错误的最小阈值。\n- 您的程序必须是自包含的，且不得接受任何输入。请将测试套件硬编码，并按规定打印单行输出。",
            "solution": "问题陈述已经过严格验证，并被确定为是合理的。它具有科学依据，定义明确，并为系统发育支持值校准的可行性理论分析提供了一个完整、一致的框架。因此，我们将着手推导和实现解决方案。\n\n目标是为三种分支支持度度量——标准非参数自举法 ($U_{\\mathrm{BS}}$)、超快自举法 ($U_{\\mathrm{UF}}$) 和 Shimodaira-Hasegawa式近似似然比检验 ($U_{\\mathrm{SH}}$)——推导决策阈值 $\\tau$，以将I型错误率控制在指定水平 $\\alpha$。需要满足的条件是 $\\mathbb{P}(U \\ge \\tau) \\le \\alpha$，其中 $U$ 代表一种支持度度量，该概率是在焦点分支不存在的原假设下生成的数据集分布上计算的。\n\n在原假设下，聚合对数似然比信号 $\\Delta = \\sum_{i=1}^{S} \\delta_i$ 是一系列独立同分布随机变量的总和，其中 $\\mathbb{E}[\\delta_i] = 0$ 且 $\\mathrm{Var}(\\delta_i) = \\sigma^2$。根据中心极限定理，对于大量的位点 $S$，$\\Delta$ 的分布可以很好地用一个正态分布近似：$\\Delta \\sim \\mathcal{N}(0, S\\sigma^2)$。为了方便，我们使用标准化信号 $X = \\frac{\\Delta}{\\sqrt{S}\\sigma}$，在原假设下，它服从标准正态分布 $X \\sim \\mathcal{N}(0, 1)$。支持度值是观测数据的函数，因此也是随机变量 $X$ 的函数。\n\n**1. 标准非参数自举法（$U_{\\mathrm{BS}}$）的阈值**\n\n标准自举支持度 $U_{\\mathrm{BS}}$ 是在给定观测数据 $\\Delta_{obs}$ 的条件下，自举总和 $\\Delta^\\star$ 为正的条件概率。$\\Delta^\\star$ 的分布近似为 $\\mathcal{N}(\\Delta_{obs}, S\\sigma^2)$。因此，支持度值为：\n$$\nU_{\\mathrm{BS}} = \\mathbb{P}(\\Delta^\\star > 0 | \\Delta_{obs}) = \\mathbb{P}\\left(\\frac{\\Delta^\\star - \\Delta_{obs}}{\\sqrt{S}\\sigma} > \\frac{-\\Delta_{obs}}{\\sqrt{S}\\sigma}\\right)\n$$\n令 $Z = (\\Delta^\\star - \\Delta_{obs})/(\\sqrt{S}\\sigma) \\sim \\mathcal{N}(0, 1)$，我们有：\n$$\nU_{\\mathrm{BS}} = \\mathbb{P}\\left(Z > -\\frac{\\Delta_{obs}}{\\sqrt{S}\\sigma}\\right) = 1 - \\Phi\\left(-\\frac{\\Delta_{obs}}{\\sqrt{S}\\sigma}\\right) = \\Phi\\left(\\frac{\\Delta_{obs}}{\\sqrt{S}\\sigma}\\right)\n$$\n其中 $\\Phi$ 是标准正态分布的累积分布函数 (CDF)。作为标准化信号 $X = \\Delta/(\\sqrt{S}\\sigma)$ 的函数，支持度值是随机变量 $U_{\\mathrm{BS}}(X) = \\Phi(X)$。\n\n我们寻求一个阈值 $\\tau_{\\mathrm{BS}}$，使得 $\\mathbb{P}(U_{\\mathrm{BS}} \\ge \\tau_{\\mathrm{BS}}) \\le \\alpha$。\n$$\n\\mathbb{P}(\\Phi(X) \\ge \\tau_{\\mathrm{BS}}) \\le \\alpha\n$$\n由于 $\\Phi$ 是单调递增的，这等价于：\n$$\n\\mathbb{P}(X \\ge \\Phi^{-1}(\\tau_{\\mathrm{BS}})) \\le \\alpha\n$$\n对于 $X \\sim \\mathcal{N}(0, 1)$，我们知道 $\\mathbb{P}(X \\ge z_{1-\\alpha}) = \\alpha$，其中 $z_{1-\\alpha} = \\Phi^{-1}(1-\\alpha)$ 是标准正态分布的 $(1-\\alpha)$-分位数。为了使不等式以等式形式成立（这给出了最不严格的阈值），我们必须设置：\n$$\n\\Phi^{-1}(\\tau_{\\mathrm{BS}}) = z_{1-\\alpha} = \\Phi^{-1}(1-\\alpha)\n$$\n这直接得出了阈值：\n$$\n\\tau_{\\mathrm{BS}}(\\alpha) = 1 - \\alpha\n$$\n\n**2. 超快自举法（$U_{\\mathrm{UF}}$）的阈值**\n\n超快自举法模型是类似的，但其重抽样总和的方差被一个因子 $\\lambda > 0$ 缩放。UFBoot总和的条件分布为 $\\mathcal{N}(\\Delta_{obs}, \\lambda S \\sigma^2)$。支持度值 $U_{\\mathrm{UF}}$ 为：\n$$\nU_{\\mathrm{UF}} = \\mathbb{P}\\left(\\frac{\\Delta^{\\star\\star} - \\Delta_{obs}}{\\sqrt{\\lambda S}\\sigma} > \\frac{-\\Delta_{obs}}{\\sqrt{\\lambda S}\\sigma}\\right) = \\Phi\\left(\\frac{\\Delta_{obs}}{\\sqrt{\\lambda S}\\sigma}\\right)\n$$\n表示为标准化信号 $X = \\Delta/(\\sqrt{S}\\sigma)$ 的函数时，支持度为 $U_{\\mathrm{UF}}(X) = \\Phi(X/\\sqrt{\\lambda})$。我们寻求 $\\tau_{\\mathrm{UF}}$ 使得 $\\mathbb{P}(U_{\\mathrm{UF}} \\ge \\tau_{\\mathrm{UF}}) \\le \\alpha$。\n$$\n\\mathbb{P}\\left(\\Phi\\left(\\frac{X}{\\sqrt{\\lambda}}\\right) \\ge \\tau_{\\mathrm{UF}}\\right) \\le \\alpha \\implies \\mathbb{P}\\left(\\frac{X}{\\sqrt{\\lambda}} \\ge \\Phi^{-1}(\\tau_{\\mathrm{UF}})\\right) \\le \\alpha \\implies \\mathbb{P}\\left(X \\ge \\sqrt{\\lambda}\\Phi^{-1}(\\tau_{\\mathrm{UF}})\\right) \\le \\alpha\n$$\n为了将错误校准到 $\\alpha$，我们设置：\n$$\n\\sqrt{\\lambda}\\Phi^{-1}(\\tau_{\\mathrm{UF}}) = z_{1-\\alpha} = \\Phi^{-1}(1-\\alpha)\n$$\n求解 $\\tau_{\\mathrm{UF}}$ 可得：\n$$\n\\Phi^{-1}(\\tau_{\\mathrm{UF}}) = \\frac{\\Phi^{-1}(1-\\alpha)}{\\sqrt{\\lambda}} \\implies \\tau_{\\mathrm{UF}}(\\alpha, \\lambda) = \\Phi\\left(\\frac{\\Phi^{-1}(1-\\alpha)}{\\sqrt{\\lambda}}\\right)\n$$\n\n**3. SH-like aLRT（$U_{\\mathrm{SH}}$）的阈值**\n\n支持度 $U_{\\mathrm{SH}}$ 由 $F_{\\chi^2_1}(T)$ 给出，其中 $T$ 是检验统计量，$F_{\\chi^2_1}$ 是自由度为1的卡方分布的累积分布函数。在原假设下，$T$ 的分布是一个混合分布：$T \\sim q \\cdot \\delta_0 + (1-q) \\cdot \\chi^2_1$，其中 $q \\in [0, 1)$，$\\delta_0$ 是位于0处的点质量。\n\n我们寻求 $\\tau_{\\mathrm{SH}}$ 使得 $\\mathbb{P}(U_{\\mathrm{SH}} \\ge \\tau_{\\mathrm{SH}}) \\le \\alpha$。\n$$\n\\mathbb{P}(F_{\\chi^2_1}(T) \\ge \\tau_{\\mathrm{SH}}) \\le \\alpha\n$$\n由于 $F_{\\chi^2_1}$ 对于非负参数是严格递增的，这等价于找到阈值 $t_\\tau = F_{\\chi^2_1}^{-1}(\\tau_{\\mathrm{SH}})$ 并求解 $\\mathbb{P}(T \\ge t_\\tau) \\le \\alpha$。关于混合分布的概率是：\n$$\n\\mathbb{P}(T \\ge t_\\tau) = q \\cdot \\mathbb{P}(T \\ge t_\\tau| T \\sim \\delta_0) + (1-q) \\cdot \\mathbb{P}(T \\ge t_\\tau| T \\sim \\chi^2_1)\n$$\n假设 $t_\\tau > 0$，第一项为 $0$。第二项为 $(1-q) \\cdot (1 - F_{\\chi^2_1}(t_\\tau))$。因此我们需要：\n$$\n(1-q)(1-F_{\\chi^2_1}(t_\\tau)) \\le \\alpha\n$$\n代入 $t_\\tau = F_{\\chi^2_1}^{-1}(\\tau_{\\mathrm{SH}})$，我们得到：\n$$\n(1-q)(1-\\tau_{\\mathrm{SH}}) \\le \\alpha \\implies 1-\\tau_{\\mathrm{SH}} \\le \\frac{\\alpha}{1-q} \\implies \\tau_{\\mathrm{SH}} \\ge 1 - \\frac{\\alpha}{1-q}\n$$\n为了控制I型错误，我们必须选择一个至少这么大的阈值。最小的有效阈值（最不保守的选择）是 $\\tau_{\\mathrm{SH}} = 1 - \\frac{\\alpha}{1-q}$。该公式在阈值为非负时有效，这要求 $1 - \\frac{\\alpha}{1-q} \\ge 0$，即 $\\alpha \\le 1-q$。如果 $\\alpha > 1-q$，所需的阈值将为负，这是不可能的。在这种情况下，即使是 $\\tau_{\\mathrm{SH}}=0$ 的阈值也能控制I型错误。对于 $\\tau_{\\mathrm{SH}}=0$，错误是 $\\mathbb{P}(U_{\\mathrm{SH}} \\ge 0)$。由于 $U_{\\mathrm{SH}}$ 是一个累积分布函数值，它总为非负，所以只有当 T 可以为负时 $\\mathbb{P}(U_{\\mathrm{SH}} \\ge 0) = 1$，而对于一个似然比检验统计量来说情况并非如此。让我们重新评估在 $\\tau=0$ 时的实际错误。错误是 $(1-q)(1-0)=1-q$。如果 $\\alpha > 1-q$，选择 $\\tau=0$ 会产生 $1-q$ 的错误，这确实 $\\le \\alpha$。因此，最小的有效阈值是 $0$。\n结合这些情况，通用公式为：\n$$\n\\tau_{\\mathrm{SH}}(\\alpha, q) = \\max\\left(0, 1 - \\frac{\\alpha}{1-q}\\right)\n$$\n\n**推导出的阈值总结：**\n1.  $\\tau_{\\mathrm{BS}}(\\alpha) = 1 - \\alpha$\n2.  $\\tau_{\\mathrm{UF}}(\\alpha, \\lambda) = \\Phi\\left(\\frac{\\Phi^{-1}(1-\\alpha)}{\\sqrt{\\lambda}}\\right)$\n3.  $\\tau_{\\mathrm{SH}}(\\alpha, q) = \\max\\left(0, 1 - \\frac{\\alpha}{1-q}\\right)\n\n现在将实施这些公式，以计算所提供测试套件的阈值。",
            "answer": "```\n[[0.950000,0.950000,0.950000],[0.950000,0.983152,0.950000],[0.950000,0.917578,0.900000],[0.990000,0.998699,0.990000],[0.900000,0.938367,0.875000],[0.750000,0.500000,0.500000]]\n```"
        }
    ]
}