{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将带领你直接比较两种经典的基于距离的建树算法：UPGMA（非加权配对平均法）和 NJ（邻接法）。这个练习的核心在于让你通过亲手计算，来揭示这两种方法背后基本假设的差异——UPGMA 严格依赖于“分子钟”假设（即超度量性），而 NJ 则放宽了这一要求，仅需满足距离的“可加性”。通过处理一个特意设计的、不完全符合分子钟假设的数据集，你将能深刻理解为何 NJ 在更广泛的进化场景中表现得更为稳健和准确。",
            "id": "2840492",
            "problem": "考虑四个分类单元 $\\{A,B,C,D\\}$，其对称的成对距离矩阵 $D$（可解释为每个位点的预期替换数）如下：\n$$\nD \\;=\\; \\begin{pmatrix}\n0 & 0.17 & 0.26 & 0.29\\\\\n0.17 & 0 & 0.27 & 0.22\\\\\n0.26 & 0.27 & 0 & 0.39\\\\\n0.29 & 0.22 & 0.39 & 0\n\\end{pmatrix}.\n$$\n根据三点条件，该矩阵近似但并非严格的超度量（ultrametric）。仅从系统发育系统学和基于距离的树重建的核心定义出发，完成以下任务：\n\n- 使用非加权对组平均法（Unweighted Pair Group Method with Arithmetic Mean, UPGMA），构建 $\\{A,B,C,D\\}$ 的有根超度量树，包括该算法所隐含的所有中间合并高度和末端分支长度，并计算此 UPGMA 树中的路径距离与 $D$ 矩阵各项之间的平方误差和 $\\mathrm{SSE}_{\\mathrm{UPGMA}}$。\n\n- 使用邻接法（Neighbor-Joining, NJ），构建 $\\{A,B,C,D\\}$ 的无根可加树，包括确定首个连接对、临时的简约距离以及最终的分支长度，并计算此 NJ 树中的路径距离与 $D$ 矩阵各项之间的平方误差和 $\\mathrm{SSE}_{\\mathrm{NJ}}$。\n\n- 使用超度量性（ultrametricity）的定义以及 UPGMA 和 NJ 的算法标准，解释为什么 UPGMA 未能从此数据中恢复正确的分组，而 NJ 却成功了。\n\n最后，计算差值\n$$\n\\Delta \\;=\\; \\mathrm{SSE}_{\\mathrm{UPGMA}} \\;-\\; \\mathrm{SSE}_{\\mathrm{NJ}}.\n$$\n将 $\\Delta$ 以实数形式报告。答案四舍五入至四位有效数字。不要包含任何单位。",
            "solution": "该问题要求基于给定的成对距离矩阵 $D$，使用两种不同的基于距离的方法——UPGMA 和邻接法（Neighbor-Joining）——为四个分类单元 $\\{A, B, C, D\\}$ 构建和评估系统发育树。首先，我们分析该矩阵的性质。\n给定的是分类单元集合和对称距离矩阵 $D$：\n$$\nD = \\begin{pmatrix}\n0 & 0.17 & 0.26 & 0.29 \\\\\n0.17 & 0 & 0.27 & 0.22 \\\\\n0.26 & 0.27 & 0 & 0.39 \\\\\n0.29 & 0.22 & 0.39 & 0\n\\end{pmatrix}\n$$\n该矩阵不是超度量的。例如，对于三元组 $\\{A, C, D\\}$，距离为 $d(A,C)=0.26$，$d(A,D)=0.29$ 和 $d(C,D)=0.39$。两个最大的距离 $0.39$ 和 $0.29$ 不相等，这违反了三点条件。\n然而，该矩阵是完美可加的。对于这四个分类单元，我们检验四点条件。令对边距离之和为 $S_1 = d(A,B)+d(C,D)$，$S_2 = d(A,C)+d(B,D)$ 和 $S_3 = d(A,D)+d(B,C)$。\n$S_1 = 0.17 + 0.39 = 0.56$\n$S_2 = 0.26 + 0.22 = 0.48$\n$S_3 = 0.29 + 0.27 = 0.56$\n由于 $S_1 = S_3 > S_2$，该矩阵是可加的，并且对应于无根树拓扑 $((A,C),(B,D))$。\n\n**非加权对组平均法 (UPGMA)**\n\nUPGMA 是一种分层聚类算法，它假设存在分子钟，即数据是超度量的。\n**第一轮迭代：** 初始聚类为 $\\{A\\}, \\{B\\}, \\{C\\}, \\{D\\}$。$D$ 中最小的距离是 $d(A,B) = 0.17$。我们将 $A$ 和 $B$ 合并成一个新的聚类 $(AB)$。连接它们的节点高度为 $h_{(AB)} = \\frac{d(A,B)}{2} = \\frac{0.17}{2} = 0.085$。\n计算这个新聚类到 $C$ 和 $D$ 的距离：\n$d((AB), C) = \\frac{d(A,C) + d(B,C)}{2} = \\frac{0.26 + 0.27}{2} = 0.265$\n$d((AB), D) = \\frac{d(A,D) + d(B,D)}{2} = \\frac{0.29 + 0.22}{2} = 0.255$\n新的距离矩阵是：\n$$\nD_1 = \\begin{array}{c|ccc}\n & (AB) & C & D \\\\ \\hline\n(AB) & 0 & 0.265 & 0.255 \\\\\nC & 0.265 & 0 & 0.39 \\\\\nD & 0.255 & 0.39 & 0\n\\end{array}\n$$\n**第二轮迭代：**$D_1$ 中最小的距离是 $d((AB), D) = 0.255$。我们将聚类 $(AB)$ 和 $D$ 合并，形成 $((AB),D)$。这个新节点的高度是 $h_{((AB),D)} = \\frac{d((AB),D)}{2} = \\frac{0.255}{2} = 0.1275$。\n\n**第三轮迭代：** 剩下的聚类是 $((AB),D)$ 和 $C$。它们之间的距离根据 UPGMA 规则计算：\n$d(((AB),D), C) = \\frac{d((AB),C) + d(D,C)}{2} = \\frac{0.265 + 0.39}{2} = 0.3275$\n我们将它们合并。根节点的高度是 $h_{root} = \\frac{d(((AB),D), C)}{2} = \\frac{0.3275}{2} = 0.16375$。\n\n生成的 UPGMA 树的拓扑结构是 $(((A,B),D),C)$。该树中的路径距离 $D_{\\mathrm{UPGMA}}$ 由最近共同祖先高度的两倍给出。\n$d_{\\mathrm{UPGMA}}(A,B) = 2 h_{(AB)} = 2(0.085) = 0.17$\n$d_{\\mathrm{UPGMA}}(A,D) = d_{\\mathrm{UPGMA}}(B,D) = 2 h_{((AB),D)} = 2(0.1275) = 0.255$\n$d_{\\mathrm{UPGMA}}(A,C) = d_{\\mathrm{UPGMA}}(B,C) = d_{\\mathrm{UPGMA}}(D,C) = 2 h_{root} = 2 (0.16375) = 0.3275$\n\n平方误差和为 $\\mathrm{SSE}_{\\mathrm{UPGMA}} = \\sum_{i<j} (D_{ij} - (D_{\\mathrm{UPGMA}})_{ij})^2$。\n$\\mathrm{SSE}_{\\mathrm{UPGMA}} = (0.17 - 0.17)^2 + (0.26 - 0.3275)^2 + (0.29 - 0.255)^2 + (0.27 - 0.3275)^2 + (0.22 - 0.255)^2 + (0.39 - 0.3275)^2$\n$= 0 + (-0.0675)^2 + (0.035)^2 + (-0.0575)^2 + (-0.035)^2 + (0.0625)^2$\n$= 0.00455625 + 0.001225 + 0.00330625 + 0.001225 + 0.00390625 = 0.01421875$\n\n**邻接法 (NJ)**\n\nNJ 旨在重建可加树。\n**第一轮迭代：** 对于 $N=4$ 个分类单元，我们计算 $r_i = \\sum_{k \\ne i} d(i,k)$。\n$r_A=0.17+0.26+0.29=0.72$\n$r_B=0.17+0.27+0.22=0.66$\n$r_C=0.26+0.27+0.39=0.92$\n$r_D=0.29+0.22+0.39=0.90$\n选择标准是最小化 $Q_{ij} = (N-2)d(i,j) - r_i - r_j = 2d(i,j) - r_i - r_j$。\n$Q_{AC} = 2(0.26) - 0.72 - 0.92 = 0.52 - 1.64 = -1.12$\n$Q_{BD} = 2(0.22) - 0.66 - 0.90 = 0.44 - 1.56 = -1.12$\n其他的 $Q$ 值均为 $-1.04$。最小值为 $-1.12$，对应于配对 $(A,C)$ 和 $(B,D)$。这与四点条件一致。我们选择先连接 $(A,C)$；这是确定的第一个配对。创建一个新节点 $U$。\n到新节点 $U$ 的分支长度为：\n$v_A = d(A,U) = \\frac{1}{2}d(A,C) + \\frac{1}{2(N-2)}(r_A-r_C) = \\frac{0.26}{2} + \\frac{0.72-0.92}{4} = 0.13 - 0.05 = 0.08$。\n$v_C = d(C,U) = d(A,C) - v_A = 0.26 - 0.08 = 0.18$。\n从 $B$ 和 $D$ 到新节点 $U$ 的临时简约距离为：\n$d(B,U) = \\frac{1}{2}(d(A,B)+d(C,B)-d(A,C)) = \\frac{1}{2}(0.17+0.27-0.26) = 0.09$。\n$d(D,U) = \\frac{1}{2}(d(A,D)+d(C,D)-d(A,C)) = \\frac{1}{2}(0.29+0.39-0.26) = 0.21$。\n\n**第二轮迭代：** 剩余的分类单元是 $\\{B,D,U\\}$，它们之间的距离是 $d(B,D)=0.22$，$d(B,U)=0.09$，$d(D,U)=0.21$。这就定义了最终的树，其中一个中心节点 $V$ 连接着 $B,D,U$。最后三个分支的长度是：\n$v_B = d(B,V) = \\frac{1}{2}(d(B,D)+d(B,U)-d(D,U)) = \\frac{1}{2}(0.22+0.09-0.21) = 0.05$。\n$v_D = d(D,V) = \\frac{1}{2}(d(B,D)+d(D,U)-d(B,U)) = \\frac{1}{2}(0.22+0.21-0.09) = 0.17$。\n$v_{UV} = d(U,V) = \\frac{1}{2}(d(B,U)+d(D,U)-d(B,D)) = \\frac{1}{2}(0.09+0.21-0.22) = 0.04$。\n最终的分支长度为：$v_A=0.08$，$v_C=0.18$，$v_B=0.05$，$v_D=0.17$，内部支长为 $v_{UV}=0.04$。拓扑结构是 $((A,C),(B,D))$。\nNJ 树中的路径距离 $D_{\\mathrm{NJ}}$ 与原始矩阵 $D$ 完全匹配：\n$d_{\\mathrm{NJ}}(A,C) = v_A+v_C = 0.08+0.18 = 0.26$。\n$d_{\\mathrm{NJ}}(B,D) = v_B+v_D = 0.05+0.17 = 0.22$。\n$d_{\\mathrm{NJ}}(A,B) = v_A+v_{UV}+v_B = 0.08+0.04+0.05 = 0.17$。\n$d_{\\mathrm{NJ}}(C,D) = v_C+v_{UV}+v_D = 0.18+0.04+0.17 = 0.39$。\n由于 $D_{\\mathrm{NJ}} = D$，平方误差和 $\\mathrm{SSE}_{\\mathrm{NJ}} = 0$。\n\n**关于 UPGMA 失败和 NJ 成功的解释**\n\nUPGMA 失败是因为它在分子钟假设下运行，该假设要求距离矩阵是超度量的。该算法的标准是在每一步贪婪地合并距离最小的一对聚类。对于给定的矩阵 $D$，全局最小距离是 $d(A,B)=0.17$。因此，UPGMA 错误地将 $A$ 和 $B$ 配对，强制生成了拓扑结构 $(((A,B),D),C)$，这与四点条件所揭示的真实可加结构 $((A,C),(B,D))$ 相矛盾。基础数据不是超度量的，这已由其违反三点条件所证明，意味着不同谱系间的进化速率存在差异。\n\nNJ 成功是因为其目标是找到最能拟合可加距离矩阵的树。所提供的数据是完美可加的，满足拓扑结构 $((A,C),(B,D))$ 的四点条件。NJ 的选择标准，即最小化 $Q_{ij}$ 值，在数学上被构建用于在可加树中识别真正的邻居。因此，它正确地将 $(A,C)$ 和 $(B,D)$ 识别为邻居，并重建了正确的树拓扑和分支长度，从而完美地拟合了数据（$\\mathrm{SSE}_{\\mathrm{NJ}}=0$）。NJ 不假设分子钟，并且能够适应谱系特异性的速率变化。\n\n**最终计算**\n\n平方误差和的差值为：\n$\\Delta = \\mathrm{SSE}_{\\mathrm{UPGMA}} - \\mathrm{SSE}_{\\mathrm{NJ}} = 0.01421875 - 0 = 0.01421875$\n四舍五入到四位有效数字，我们得到 $\\Delta = 0.01422$。",
            "answer": "$$\\boxed{0.01422}$$"
        },
        {
            "introduction": "在理解了 NJ 算法对数据“可加性”的依赖之后，下一个自然的问题就是：我们如何判断一个距离矩阵是否满足可加性？本练习将带你深入 NJ 算法的理论核心——四点条件。通过对所有可能的四分类单元组合计算“四点残差”，你将学会一种量化方法来评估距离数据偏离完美树状结构的程度。这个实践不仅是理论验证，更是一项重要的诊断技能，能帮助你在实际研究中评估数据的质量和系统发育信号的可靠性。",
            "id": "2701717",
            "problem": "考虑一个包含五个分类单元的集合，这些分类单元之间的对称成对进化距离是根据比对后的序列估算得出的。基于距离的邻接法（Neighbor-Joining, NJ）系统发育推断依赖于当距离完全呈树形时，无根树上路径长度的可加性。一个有限数据集可能会偏离完美的可加性。一个基础性的特征描述指出，一个度量当且仅当对于任意四个分类单元的集合，当人们根据这四个分类单元的三种二分法，构建三组成对距离之和时，这三个和中恰好有两个相等，且它们的值不小于第三个，此时该度量才是一个精确的树度量。\n\n给定下列五个分类单元 $A$、$B$、$C$、$D$、$E$ 的成对距离（所有距离单位任意但一致）：\n- $d(A,B) = 5.0$, $d(A,C) = 7.2$, $d(A,D) = 10.0$, $d(A,E) = 8.8$,\n- $d(B,C) = 8.0$, $d(B,D) = 10.9$, $d(B,E) = 10.1$,\n- $d(C,D) = 7.0$, $d(C,E) = 6.1$,\n- $d(D,E) = 5.0$。\n所有其他项由对称性定义，且对于每个分类单元 $X$ 都有 $d(X,X)=0$。\n\n对于每个无序的四分类单元组（共有$5$个这样的组），执行以下操作：对于四分类单元组 $\\{i,j,k,\\ell\\}$，通过将三种可能配对的距离相加得到三种和，即对应于二分 $\\{i,j\\}\\mid\\{k,\\ell\\}$、$\\{i,k\\}\\mid\\{j,\\ell\\}$ 和 $\\{i,\\ell\\}\\mid\\{j,k\\}$。在一个完美可加的（树形）度量中，这三个和中最大的两个将是相等的。对于每个四分类单元组，将其四点残差定义为这两个最大和之间的绝对差。这个残差量化了该四分类单元组在四点条件意义上对可加性的偏离程度。\n\n计算所有五个分类单元的无序四分类单元组的平均四点残差。将你的最终答案以一个实数形式给出。将答案表示为精确小数（无舍入要求）。",
            "solution": "该问题已经过验证，被认为是科学上可靠、定义明确、客观且自洽的。它提出了一个来自进化生物学领域的标准计算任务，特别是关于树度量的四点条件。因此，有必要给出直接的解答。\n\n任务是计算五个给定分类单元（我们标记为 $\\mathcal{T} = \\{A, B, C, D, E\\}$）所有可能的无序四分类单元组的平均四点残差。这样的四分类单元组的数量由二项式系数 $\\binom{5}{4} = 5$ 给出。对于每个四分类单元组 $\\{i, j, k, \\ell\\}$，我们必须计算对应于三种可能二分法的三个距离和：\n$S_{ij,k\\ell} = d(i,j) + d(k,\\ell)$\n$S_{ik,j\\ell} = d(i,k) + d(j,\\ell)$\n$S_{i\\ell,jk} = d(i,\\ell) + d(j,k)$\n根据四点条件，对于一个完美的树度量，这三个和中有两个是相等的，并且不小于第三个。一个四分类单元组的四点残差被定义为这三个和中最大的两个之间的绝对差。设 $S_{(1)} \\le S_{(2)} \\le S_{(3)}$ 是按非递减顺序排序的和。残差 $R$ 是 $S_{(3)} - S_{(2)}$。\n\n提供的距离是：\n- $d(A,B) = 5.0$, $d(A,C) = 7.2$, $d(A,D) = 10.0$, $d(A,E) = 8.8$\n- $d(B,C) = 8.0$, $d(B,D) = 10.9$, $d(B,E) = 10.1$\n- $d(C,D) = 7.0$, $d(C,E) = 6.1$\n- $d(D,E) = 5.0$\n\n我们通过系统地分析五个四分类单元组中的每一个来进行计算。\n\n1.  **四分类单元组 $\\{A, B, C, D\\}$**\n    三个和是：\n    $S_1 = d(A,B) + d(C,D) = 5.0 + 7.0 = 12.0$\n    $S_2 = d(A,C) + d(B,D) = 7.2 + 10.9 = 18.1$\n    $S_3 = d(A,D) + d(B,C) = 10.0 + 8.0 = 18.0$\n    排序后的和是 $12.0$、$18.0$、$18.1$。最大的两个是 $18.1$ 和 $18.0$。\n    残差是 $R_1 = |18.1 - 18.0| = 0.1$。\n\n2.  **四分类单元组 $\\{A, B, C, E\\}$**\n    三个和是：\n    $S_1 = d(A,B) + d(C,E) = 5.0 + 6.1 = 11.1$\n    $S_2 = d(A,C) + d(B,E) = 7.2 + 10.1 = 17.3$\n    $S_3 = d(A,E) + d(B,C) = 8.8 + 8.0 = 16.8$\n    排序后的和是 $11.1$、$16.8$、$17.3$。最大的两个是 $17.3$ 和 $16.8$。\n    残差是 $R_2 = |17.3 - 16.8| = 0.5$。\n\n3.  **四分类单元组 $\\{A, B, D, E\\}$**\n    三个和是：\n    $S_1 = d(A,B) + d(D,E) = 5.0 + 5.0 = 10.0$\n    $S_2 = d(A,D) + d(B,E) = 10.0 + 10.1 = 20.1$\n    $S_3 = d(A,E) + d(B,D) = 8.8 + 10.9 = 19.7$\n    排序后的和是 $10.0$、$19.7$、$20.1$。最大的两个是 $20.1$ 和 $19.7$。\n    残差是 $R_3 = |20.1 - 19.7| = 0.4$。\n\n4.  **四分类单元组 $\\{A, C, D, E\\}$**\n    三个和是：\n    $S_1 = d(A,C) + d(D,E) = 7.2 + 5.0 = 12.2$\n    $S_2 = d(A,D) + d(C,E) = 10.0 + 6.1 = 16.1$\n    $S_3 = d(A,E) + d(C,D) = 8.8 + 7.0 = 15.8$\n    排序后的和是 $12.2$、$15.8$、$16.1$。最大的两个是 $16.1$ 和 $15.8$。\n    残差是 $R_4 = |16.1 - 15.8| = 0.3$。\n\n5.  **四分类单元组 $\\{B, C, D, E\\}$**\n    三个和是：\n    $S_1 = d(B,C) + d(D,E) = 8.0 + 5.0 = 13.0$\n    $S_2 = d(B,D) + d(C,E) = 10.9 + 6.1 = 17.0$\n    $S_3 = d(B,E) + d(C,D) = 10.1 + 7.0 = 17.1$\n    排序后的和是 $13.0$、$17.0$、$17.1$。最大的两个是 $17.1$ 和 $17.0$。\n    残差是 $R_5 = |17.1 - 17.0| = 0.1$。\n\n最后，我们计算这五个残差的平均值。残差的总和是：\n$$ \\sum_{i=1}^{5} R_i = R_1 + R_2 + R_3 + R_4 + R_5 = 0.1 + 0.5 + 0.4 + 0.3 + 0.1 = 1.4 $$\n四分类单元组的数量是 $N=5$。平均残差 $\\bar{R}$ 是总和除以四分类单元组的数量：\n$$ \\bar{R} = \\frac{\\sum_{i=1}^{5} R_i}{N} = \\frac{1.4}{5} = 0.28 $$\n计算是精确的，不需要近似。平均四点残差为 $0.28$。",
            "answer": "$$\\boxed{0.28}$$"
        },
        {
            "introduction": "真实的进化距离数据总是伴随着随机误差和系统偏差。那么，在多大程度上我们可以相信 NJ 算法从这些含噪数据中重建出的拓扑结构呢？这个高级练习将引导你从理论层面分析 NJ 算法的稳健性。通过在一个已知真实拓扑结构上引入有界噪声的思维实验，你将推导保证 NJ 算法在第一步做出正确“成对归并”（cherry-picking）的噪声容忍上限 $\\varepsilon$。这项实践将深化你对算法性能边界的理解，并培养在处理不完美数据时进行严谨推断和批判性思考的能力。",
            "id": "2701770",
            "problem": "给定一个五分类单元加性树（一种具有路径长度距离的精确树度量），其叶节点为 $\\{A,B,C,D,E\\}$，拓扑结构为 $((A,B),(C,D),E)$。悬垂边的长度为 $p_A = p_B = p_C = p_D = p_E = 0.1$，从 $(A,B)$ 樱桃对到中心节点的内部边长度为 $s_1 = 0.2$，从 $(C,D)$ 樱桃对到中心节点的内部边长度为 $s_2 = 0.25$，从 $E$到中心节点的内部边长度为 $s_3 = 0.3$。叶节点之间的距离是连接它们的唯一路径上的分支长度之和（加性度量）。\n\n假设我们观察到的不是真实的配对距离 $d_{ij}$，而是带有噪声的估计值 $\\hat d_{ij} = d_{ij} + \\eta_{ij}$，其中 $\\eta_{ij}$ 是对称的未知扰动，对于所有无序对 $\\{i,j\\}$，其界限为 $|\\eta_{ij}| \\le \\varepsilon$，并且没有其他约束（即对抗性有界噪声）。\n\n邻接法 (NJ) 算法在每一步选择使 $Q$ 准则最小化的配对 $(i,j)$\n$$\nQ_{ij} \\equiv (n-2)\\, \\hat d_{ij} - \\sum_{k \\ne i} \\hat d_{ik} - \\sum_{k \\ne j} \\hat d_{jk},\n$$\n此处 $n = 5$。在底层树中形成一个樱桃对的一对叶节点被称为“真实樱桃对”。\n\n从加性树度量的基本定义和上述 NJ 的 $Q$ 准则定义出发，推断有界扰动如何通过 $Q_{ij}$ 传播，并导致真实樱桃对和非樱桃对的 $Q$ 值之间产生鲁棒的分离。你的任务是确定下列哪些陈述是正确的。选择所有适用的选项。\n\nA. 在上确界范数误差模型 $|\\eta_{ij}| \\le \\varepsilon$ 下，保证邻接法 (NJ) 选择的第一个樱桃对是底层树的真实樱桃对的一个充分条件是 $\\varepsilon < 0.10$。\n\nB. 在相同的误差模型下，保证 NJ 选择的第一个樱桃对是真实樱桃对的一个充分条件是 $\\varepsilon < 0.125$。\n\nC. 在相同的误差模型下，$\\varepsilon < 0.20$ 是保证 NJ 首先选择一个真实樱桃对的充要条件。\n\nD. 根据 Atteson 的 NJ 的 $\\ell_{\\infty}$ 半径定理，$\\varepsilon < \\tfrac{1}{2}\\min\\{\\text{边长}\\} = 0.05$ 是在任何步骤保证任何拓扑正确性的必要条件；因此，没有大于 $0.05$ 的界限可以保证第一个樱桃对是正确的。\n\nE. 如果 $\\varepsilon < 0.125$，则无论容许误差如何排列，NJ 都能保证恢复出完整的树拓扑结构（不仅仅是第一个樱桃对）。",
            "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- **树拓扑结构**：一个五分类单元加性树，叶节点为 $\\{A,B,C,D,E\\}$，拓扑结构为 $((A,B),(C,D),E)$。\n- **分类单元**：$n=5$ 个叶节点，$\\{A,B,C,D,E\\}$。\n- **边长**：\n    - 悬垂边：$p_A = p_B = p_C = p_D = p_E = 0.1$。\n    - 从 $(A,B)$ 樱桃对到中心节点的内部边：$s_1 = 0.2$。\n    - 从 $(C,D)$ 樱桃对到中心节点的内部边：$s_2 = 0.25$。\n    - 从 $E$ 到中心节点的内部边：$s_3 = 0.3$。\n- **距离度量**：叶节点 $i$ 和 $j$ 之间的真实距离 $d_{ij}$ 是连接它们的唯一路径上的分支长度之和（加性度量）。\n- **噪声模型**：观察到的距离是 $\\hat d_{ij} = d_{ij} + \\eta_{ij}$，其中 $\\eta_{ij}$ 是对称的未知扰动，对于所有无序对 $\\{i,j\\}$，其界限为 $|\\eta_{ij}| \\le \\varepsilon$。\n- **邻接法 (NJ) 准则**：该算法选择使 $Q_{ij} \\equiv (n-2)\\, \\hat d_{ij} - \\sum_{k \\ne i} \\hat d_{ik} - \\sum_{k \\ne j} \\hat d_{jk}$ 最小化的配对 $(i,j)$，此处 $n=5$。\n- **定义**：“真实樱桃对”是在真实树中互为姐妹的一对叶节点。对于给定的拓扑结构，真实樱桃对是 $(A,B)$ 和 $(C,D)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据、问题明确且客观。它描述了计算系统发育学中一个标准的理论设置，用于分析邻接法在有界对抗性噪声下的鲁棒性。所有必要的数据和定义都已提供，没有内部矛盾或不科学的前提。该问题是一个应用 NJ 算法定义并分析其在扰动下行为的规范练习。\n\n**步骤 3：结论与行动**\n问题有效。将进行完整的推导和解答。\n\n**解答推导**\n任务是找到噪声界限 $\\varepsilon$ 的一个充分条件，以保证 NJ 算法选择的第一个配对是真实樱桃对，即 $(A,B)$ 或 $(C,D)$。当最小的 $\\hat Q_{ij}$ 值对应一个真实樱桃对时，此条件成立。\n\n**1. 计算真实配对距离 ($d_{ij}$)**\n设 $U$ 是 $A$ 和 $B$ 的父节点， $V$ 是 $C$ 和 $D$ 的父节点，$X$ 是连接 $U$、$V$ 和 $E$ 的中心节点。\n距离计算为路径长度：\n- $d_{AB} = p_A + p_B = 0.1 + 0.1 = 0.2$\n- $d_{CD} = p_C + p_D = 0.1 + 0.1 = 0.2$\n- $d_{AC} = p_A + s_1 + s_2 + p_C = 0.1 + 0.2 + 0.25 + 0.1 = 0.65$\n- $d_{AD} = p_A + s_1 + s_2 + p_D = 0.1 + 0.2 + 0.25 + 0.1 = 0.65$\n- $d_{BC} = p_B + s_1 + s_2 + p_C = 0.1 + 0.2 + 0.25 + 0.1 = 0.65$\n- $d_{BD} = p_B + s_1 + s_2 + p_D = 0.1 + 0.2 + 0.25 + 0.1 = 0.65$\n- $d_{AE} = p_A + s_1 + s_3 = 0.1 + 0.2 + 0.3 = 0.6$\n- $d_{BE} = p_B + s_1 + s_3 = 0.1 + 0.2 + 0.3 = 0.6$\n- $d_{CE} = p_C + s_2 + s_3 = 0.1 + 0.25 + 0.3 = 0.65$\n- $d_{DE} = p_D + s_2 + s_3 = 0.1 + 0.25 + 0.3 = 0.65$\n\n**2. 计算真实 $Q$ 值 ($Q_{ij}$)**\n当 $n=5$ 时，准则为 $Q_{ij} = 3 d_{ij} - S_i - S_j$，其中 $S_i = \\sum_{k \\neq i} d_{ik}$ 是从叶节点 $i$ 到所有其他叶节点的距离之和。\n首先，我们计算总和 $S_i$：\n- $S_A = d_{AB} + d_{AC} + d_{AD} + d_{AE} = 0.2 + 0.65 + 0.65 + 0.6 = 2.1$\n- $S_B = d_{BA} + d_{BC} + d_{BD} + d_{BE} = 0.2 + 0.65 + 0.65 + 0.6 = 2.1$\n- $S_C = d_{CA} + d_{CB} + d_{CD} + d_{CE} = 0.65 + 0.65 + 0.2 + 0.65 = 2.15$\n- $S_D = d_{DA} + d_{DB} + d_{DC} + d_{DE} = 0.65 + 0.65 + 0.2 + 0.65 = 2.15$\n- $S_E = d_{EA} + d_{EB} + d_{EC} + d_{ED} = 0.6 + 0.6 + 0.65 + 0.65 = 2.5$\n\n现在，我们计算所有配对的 $Q_{ij}$ 值：\n- **真实樱桃对**：\n    - $Q_{AB} = 3(0.2) - S_A - S_B = 0.6 - 2.1 - 2.1 = -3.6$\n    - $Q_{CD} = 3(0.2) - S_C - S_D = 0.6 - 2.15 - 2.15 = -3.7$\n- **非樱桃对**：\n    - $Q_{AC} = 3(0.65) - S_A - S_C = 1.95 - 2.1 - 2.15 = -2.3$ (对 $AD, BC, BD$ 类似)\n    - $Q_{AE} = 3(0.6) - S_A - S_E = 1.8 - 2.1 - 2.5 = -2.8$ (对 $BE$ 类似)\n    - $Q_{CE} = 3(0.65) - S_C - S_E = 1.95 - 2.15 - 2.5 = -2.7$ (对 $DE$ 类似)\n\n正如加性度量所预期的，最小的 $Q$ 值对应于真实樱桃对，且 $Q_{CD} < Q_{AB}$。\n\n**3. 噪声传播分析**\n观察到的 $Q$ 值为 $\\hat Q_{ij} = Q_{ij} + \\Delta Q_{ij}$，其中 $\\Delta Q_{ij}$ 是由噪声项 $\\eta_{kl}$ 引起的对 $Q_{ij}$ 的扰动。\n$\\Delta Q_{ij} = (n-2)\\eta_{ij} - \\sum_{k \\ne i} \\eta_{ik} - \\sum_{k \\ne j} \\eta_{jk} = (n-4)\\eta_{ij} - \\sum_{k \\ne i,j} (\\eta_{ik} + \\eta_{jk})$。\n对于 $n=5$，$\\Delta Q_{ij} = \\eta_{ij} - \\sum_{k \\ne i,j} (\\eta_{ik} + \\eta_{jk})$。\n\n为了找到选择真实樱桃对的充分条件，我们必须确保至少有一个真实樱桃对的 $\\hat Q$ 值小于任何非樱桃对的 $\\hat Q$ 值。一个确保此条件的鲁棒方法是找到一个 $\\varepsilon$，使得对于某个真实樱桃对，例如 $(i,j)$，无论容许误差如何配置，条件 $\\hat Q_{ij} < \\hat Q_{kl}$ 对所有非樱桃对 $(k,l)$ 都成立。如果 $(Q_{kl} - Q_{ij}) + (\\Delta Q_{kl} - \\Delta Q_{ij}) > 0$，则该条件得到保证。最坏的情况是当噪声项 $\\Delta Q_{kl} - \\Delta Q_{ij}$ 被最小化时。\n\n差值 $\\Delta Q_{kl} - \\Delta Q_{ij}$ 是噪声项 $\\eta_{uv}$ 的一个线性组合。保证成功的条件是 $\\varepsilon < (Q_{kl} - Q_{ij}) / N_{I}$，其中 $N_{I}$ 是该线性组合中系数绝对值之和。\n对于 $n=5$，当比较两个配对时，该系数和 $N_{I}$ 为：\n- **情况 1**：配对共享一个叶节点，例如 $(i, j)$ 和 $(i, k)$。$N_I = 8$。\n- **情况 2**：配对不相交，例如 $(i, j)$ 和 $(k, l)$。$N_I = 6$。\n\n**4. 确定 $\\varepsilon$ 的充分条件**\n如果至少有一个真实樱桃对，例如 $(i,j)$，是“受保护的”，即对于所有非樱桃对 $(k,l)$ 都有 $\\hat Q_{ij} < \\hat Q_{kl}$，那么就能保证第一个选择是正确的。让我们检查樱桃对 $(C,D)$ 的保护情况，它的真实 $Q$ 值更低。我们需要找到保证 $\\hat Q_{CD} < \\hat Q_{kl}$ 对于所有非樱桃对 $(k,l)$ 成立的 $\\varepsilon$ 的界限。总体的充分条件将是这些单独界限中的最小值。\n\n- **对比 $(A,C)$（非樱桃对，共享叶节点 $C$）**：$Q_{AC}-Q_{CD} = -2.3 - (-3.7) = 1.4$。系数 $N_I=8$。界限：$\\varepsilon < 1.4/8 = 0.175$。\n- **对比 $(A,D)$（非樱桃对，共享叶节点 $D$）**：$Q_{AD}-Q_{CD} = 1.4$。系数 $N_I=8$。界限：$\\varepsilon < 1.4/8 = 0.175$。\n- **对比 $(B,C)$（非樱桃对，共享叶节点 $C$）**：$Q_{BC}-Q_{CD} = 1.4$。系数 $N_I=8$。界限：$\\varepsilon < 1.4/8 = 0.175$。\n- **对比 $(B,D)$（非樱桃对，共享叶节点 $D$）**：$Q_{BD}-Q_{CD} = 1.4$。系数 $N_I=8$。界限：$\\varepsilon < 1.4/8 = 0.175$。\n- **对比 $(A,E)$（非樱桃对，不相交）**：$Q_{AE}-Q_{CD} = -2.8 - (-3.7) = 0.9$。系数 $N_I=6$。界限：$\\varepsilon < 0.9/6 = 0.15$。\n- **对比 $(B,E)$（非樱桃对，不相交）**：$Q_{BE}-Q_{CD} = 0.9$。系数 $N_I=6$。界限：$\\varepsilon < 0.9/6 = 0.15$。\n- **对比 $(C,E)$（非樱桃对，共享叶节点 $C$）**：$Q_{CE}-Q_{CD} = -2.7 - (-3.7) = 1.0$。系数 $N_I=8$。界限：$\\varepsilon < 1.0/8 = 0.125$。\n- **对比 $(D,E)$（非樱桃对，共享叶节点 $D$）**：$Q_{DE}-Q_{CD} = 1.0$。系数 $N_I=8$。界限：$\\varepsilon < 1.0/8 = 0.125$。\n\n为了保证 $\\hat Q_{CD}$ 小于任何非樱桃对的 $\\hat Q$ 值，$\\varepsilon$ 必须小于所有这些界限的最小值：$\\min(0.175, 0.15, 0.125) = 0.125$。\n因此，如果 $\\varepsilon < 0.125$，则可以保证对于任何非樱桃对 $(k,l)$，都有 $\\hat Q_{CD} < \\hat Q_{kl}$。\n这确保了所有 $\\hat Q$ 值中的最小值必定属于一个真实樱桃对（可能是 $\\hat Q_{CD}$，或者如果噪声使其变得更小，也可能是 $\\hat Q_{AB}$，只要噪声不足以使 $\\hat Q_{AB}$ 大于某个非樱桃对的 $\\hat Q$ 值）。因此，$\\varepsilon < 0.125$ 是保证 NJ 首先选择一个真实樱桃对的充分条件。\n\n**逐项分析**\n\n**A. 在上确界范数误差模型 $|\\eta_{ij}| \\le \\varepsilon$ 下，保证邻接法 (NJ) 选择的第一个樱桃对是底层树的真实樱桃对的一个充分条件是 $\\varepsilon < 0.10$。**\n正如我们推导的，$\\varepsilon < 0.125$ 是一个充分条件。如果条件 $\\varepsilon < 0.10$ 满足，那么 $\\varepsilon$ 也小于 $0.125$。因此，$\\varepsilon < 0.10$ 也是一个充分条件。它是一个更严格但有效的充分条件。\n**结论：正确**\n\n**B. 在相同的误差模型下，保证 NJ 选择的第一个樱桃对是真实樱桃对的一个充分条件是 $\\varepsilon < 0.125$。**\n我们的推导表明，这是通过保护樱桃对 $(C,D)$ 找到的最紧的充分条件。如果这个条件成立，NJ 保证会选择一个真实樱桃对。\n**结论：正确**\n\n**C. 在相同的误差模型下，$\\varepsilon < 0.20$ 是保证 NJ 首先选择一个真实樱桃对的充要条件。**\n这是不正确的。通过与 $(C,E)$ 的比较得出的界限表明，如果 $\\varepsilon$ 略大于 $0.125$，则存在一种噪声配置使得 $\\hat Q_{CE} < \\hat Q_{CD}$，从而导致选择错误的配对。因此 $\\varepsilon < 0.20$ 不是一个充分条件。它也不是一个必要条件；“必要”在这种上下文中没有明确定义且通常不适用。\n**结论：不正确**\n\n**D. 根据 Atteson 的 NJ 的 $\\ell_{\\infty}$ 半径定理，$\\varepsilon < \\tfrac{1}{2}\\min\\{\\text{边长}\\} = 0.05$ 是在任何步骤保证任何拓扑正确性的必要条件；因此，没有大于 $0.05$ 的界限可以保证第一个樱桃对是正确的。**\n这个陈述在多个方面存在缺陷。首先，Atteson 定理提供的是一个*充分*条件，而非*必要*条件。其次，该定理指出，$\\varepsilon < \\frac{1}{2} L_{\\min}$，其中 $L_{\\min}$ 是最短*内部*边的长度，是恢复*整个*树拓扑的充分条件。在这里，内部边长为 $\\{0.2, 0.25, 0.3\\}$，所以 $L_{\\min} = 0.2$。从 Atteson 定理得到的正确界限是 $\\varepsilon < \\frac{1}{2}(0.2) = 0.1$。该陈述错误地取了所有边长的最小值（包括悬垂边，最小值为 $0.1$）来得到 $0.05$ 的界限。最后，结论说没有大于 $0.05$ 的界限可以保证第一个樱桃对的正确性是错误的；这个条件是针对完整树的，而仅仅针对第一步的条件可以（实际上也确实）更宽松。\n**结论：不正确**\n\n**E. 如果 $\\varepsilon < 0.125$，则无论容许误差如何排列，NJ 都能保证恢复出完整的树拓扑结构（不仅仅是第一个樱桃对）。**\n这是不正确的。条件 $\\varepsilon < 0.125$ 仅对第一步是充分的。保证恢复完整的拓扑结构是一个更强的要求。恢复完整拓扑的通用充分条件由 Atteson 定理给出，对于这棵树，该定理要求 $\\varepsilon < 0.1$。如果 $\\varepsilon = 0.11$（满足 $\\varepsilon < 0.125$），第一步是正确的，但后续步骤的正确性无法保证，因为在缩减后的距离矩阵中，误差可能会超过剩余子树的安全边界。\n**结论：不正确**",
            "answer": "$$\\boxed{AB}$$"
        }
    ]
}