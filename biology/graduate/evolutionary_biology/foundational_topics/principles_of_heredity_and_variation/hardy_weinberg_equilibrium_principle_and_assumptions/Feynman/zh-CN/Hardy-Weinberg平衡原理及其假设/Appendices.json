{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在从第一性原理出发，巩固对等位基因频率估计的统计学基础。通过在有约束（哈迪-温伯格平衡）和无约束（多项式模型）两种情况下推导等位基因频率 $p$ 的最大似然估计（MLE），您将深入理解为何直观的“基因计数”法是严谨且有效的方法 。这个推导过程对于建立群体遗传学分析的统计直觉至关重要。",
            "id": "2721753",
            "problem": "对一个泛交二倍体群体中单个具有两个等位基因（表示为 $A$ 和 $a$）的常染色体位点进行抽样。从随机抽样的 $n$ 个个体中，你观察到基因型计数为 $(n_{AA}, n_{Aa}, n_{aa})$，其中 $n_{AA} + n_{Aa} + n_{aa} = n$。设 $p$ 表示等位基因 $A$ 的种群频率。仅使用以下基础：基因型计数的多项抽样模型、作为基因型概率函数的等位基因频率的定义，以及哈代-温伯格平衡 (Hardy–Weinberg Equilibrium, HWE) 原理及其标准假设（随机交配、无选择、无突变、无迁移和有效无限大的种群规模），通过两种方法推导 $p$ 的最大似然估计。\n\n1) 首先，将基因型概率视为自由参数 $\\theta_{AA}, \\theta_{Aa}, \\theta_{aa}$，仅受约束条件 $\\theta_{AA} \\ge 0$, $\\theta_{Aa} \\ge 0$, $\\theta_{aa} \\ge 0$ 和 $\\theta_{AA} + \\theta_{Aa} + \\theta_{aa} = 1$ 的限制，同时将 $p$ 定义为诱导的等位基因频率 $p = \\theta_{AA} + \\frac{1}{2}\\theta_{Aa}$。以 $(n_{AA}, n_{Aa}, n_{aa})$ 的函数形式，推导最大似然估计量 $\\hat{p}$ 的闭式解。\n\n2) 其次，施加哈代-温伯格平衡 (HWE) 约束，即基因型概率由等位基因频率 $p$ 通过 $(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa}) = (p^{2}, 2p(1-p), (1-p)^{2})$ 确定，并通过最大化关于 $p$ 的多项似然来推导最大似然估计量 $\\hat{p}$。\n\n从第一性原理出发，解释为什么这两个估计量是相同的。将你的最终估计量表示为关于 $(n_{AA}, n_{Aa}, n)$ 的单个精确代数表达式，其中 $n = n_{AA} + n_{Aa} + n_{aa}$。最终答案应为精确表达式，无需四舍五入或单位。",
            "solution": "该问题要求在基因型计数的多项抽样模型的两种不同参数化下，推导等位基因 $A$ 频率（表示为 $p$）的最大似然估计 (MLE)。观测数据是从 $n$ 个二倍体个体样本中得到的基因型计数 $(n_{AA}, n_{Aa}, n_{aa})$，其中 $n = n_{AA} + n_{Aa} + n_{aa}$。\n\n这个问题的基础是观察到这些基因型计数的似然函数，它遵循多项分布。设基因型的种群概率为 $(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa})$。似然函数 $L$ 由下式给出：\n$$ L(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa} | n_{AA}, n_{Aa}, n_{aa}) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} \\theta_{AA}^{n_{AA}} \\theta_{Aa}^{n_{Aa}} \\theta_{aa}^{n_{aa}} $$\n为了最大化，可以忽略常数组合项。使用对数似然函数 $\\ell = \\ln(L)$ 更为方便。\n$$ \\ell \\propto n_{AA}\\ln(\\theta_{AA}) + n_{Aa}\\ln(\\theta_{Aa}) + n_{aa}\\ln(\\theta_{aa}) $$\n\n**1) 使用自由基因型概率的推导**\n\n在第一种情况下，基因型概率 $(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa})$ 被视为自由参数，仅受概率分布的标准约束：$\\theta_{AA} \\ge 0$, $\\theta_{Aa} \\ge 0$, $\\theta_{aa} \\ge 0$ 和总和为一的约束 $\\theta_{AA} + \\theta_{Aa} + \\theta_{aa} = 1$。等位基因频率 $p$ 定义为一个诱导量：$p = \\theta_{AA} + \\frac{1}{2}\\theta_{Aa}$。\n\n为了找到 $(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa})$ 的最大似然估计，我们在约束条件 $\\theta_{AA} + \\theta_{Aa} + \\theta_{aa} = 1$ 下最大化对数似然。这是拉格朗日乘数法的标准应用。拉格朗日函数 $\\mathcal{L}$ 为：\n$$ \\mathcal{L}(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa}, \\lambda) = n_{AA}\\ln(\\theta_{AA}) + n_{Aa}\\ln(\\theta_{Aa}) + n_{aa}\\ln(\\theta_{aa}) - \\lambda(\\theta_{AA} + \\theta_{Aa} + \\theta_{aa} - 1) $$\n我们对每个 $\\theta_{ij}$ 求偏导数并将其设为零：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\theta_{AA}} = \\frac{n_{AA}}{\\theta_{AA}} - \\lambda = 0 \\implies \\hat{\\theta}_{AA} = \\frac{n_{AA}}{\\lambda} $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\theta_{Aa}} = \\frac{n_{Aa}}{\\theta_{Aa}} - \\lambda = 0 \\implies \\hat{\\theta}_{Aa} = \\frac{n_{Aa}}{\\lambda} $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\theta_{aa}} = \\frac{n_{aa}}{\\theta_{aa}} - \\lambda = 0 \\implies \\hat{\\theta}_{aa} = \\frac{n_{aa}}{\\lambda} $$\n为了找到拉格朗日乘数 $\\lambda$ 的值，我们使用约束条件：\n$$ \\hat{\\theta}_{AA} + \\hat{\\theta}_{Aa} + \\hat{\\theta}_{aa} = \\frac{n_{AA}}{\\lambda} + \\frac{n_{Aa}}{\\lambda} + \\frac{n_{aa}}{\\lambda} = 1 $$\n$$ \\frac{n_{AA} + n_{Aa} + n_{aa}}{\\lambda} = \\frac{n}{\\lambda} = 1 \\implies \\lambda = n $$\n将 $\\lambda = n$ 代回估计量的表达式中，得到基因型概率的 MLE：\n$$ \\hat{\\theta}_{AA} = \\frac{n_{AA}}{n}, \\quad \\hat{\\theta}_{Aa} = \\frac{n_{Aa}}{n}, \\quad \\hat{\\theta}_{aa} = \\frac{n_{aa}}{n} $$\n这些就是观测到的基因型样本频率。\n\n问题要求的是 $p$ 的 MLE。根据最大似然估计量的不变性，参数函数的 MLE 就是将该函数应用于参数的 MLE。因此，$p$ 的 MLE，表示为 $\\hat{p}$，是：\n$$ \\hat{p} = \\hat{\\theta}_{AA} + \\frac{1}{2}\\hat{\\theta}_{Aa} = \\frac{n_{AA}}{n} + \\frac{1}{2}\\frac{n_{Aa}}{n} = \\frac{2n_{AA} + n_{Aa}}{2n} $$\n\n**2) 使用哈代-温伯格平衡 (HWE) 约束的推导**\n\n在第二种情况下，我们施加 HWE 约束，该约束将基因型概率建模为单个参数，即等位基因频率 $p$ 的函数：\n$$ (\\theta_{AA}, \\theta_{Aa}, \\theta_{aa}) = (p^{2}, 2p(1-p), (1-p)^{2}) $$\n我们将这些代入对数似然函数，创建一个仅关于 $p$ 的函数：\n$$ \\ell(p) \\propto n_{AA}\\ln(p^{2}) + n_{Aa}\\ln(2p(1-p)) + n_{aa}\\ln((1-p)^{2}) $$\n$$ \\ell(p) = 2n_{AA}\\ln(p) + n_{Aa}(\\ln(2) + \\ln(p) + \\ln(1-p)) + 2n_{aa}\\ln(1-p) $$\n$$ \\ell(p) = (2n_{AA} + n_{Aa})\\ln(p) + (n_{Aa} + 2n_{aa})\\ln(1-p) + n_{Aa}\\ln(2) $$\n为了找到 $p$ 的 MLE，我们对 $\\ell(p)$ 关于 $p$ 求导并将其设为零。常数项 $n_{Aa}\\ln(2)$ 在微分时消失。\n$$ \\frac{d\\ell}{dp} = \\frac{2n_{AA} + n_{Aa}}{p} - \\frac{n_{Aa} + 2n_{aa}}{1-p} = 0 $$\n解出 $p$：\n$$ \\frac{2n_{AA} + n_{Aa}}{p} = \\frac{n_{Aa} + 2n_{aa}}{1-p} $$\n$$ (2n_{AA} + n_{Aa})(1-p) = p(n_{Aa} + 2n_{aa}) $$\n$$ 2n_{AA} + n_{Aa} - p(2n_{AA} + n_{Aa}) = p(n_{Aa} + 2n_{aa}) $$\n$$ 2n_{AA} + n_{Aa} = p(2n_{AA} + n_{Aa} + n_{Aa} + 2n_{aa}) $$\n$$ 2n_{AA} + n_{Aa} = p(2n_{AA} + 2n_{Aa} + 2n_{aa}) $$\n$$ 2n_{AA} + n_{Aa} = p \\cdot 2(n_{AA} + n_{Aa} + n_{aa}) $$\n由于 $n = n_{AA} + n_{Aa} + n_{aa}$，我们有：\n$$ 2n_{AA} + n_{Aa} = p \\cdot 2n $$\n因此，在 HWE 约束下的 MLE 是：\n$$ \\hat{p} = \\frac{2n_{AA} + n_{Aa}}{2n} $$\n\n**等价性解释**\n\n两种推导得出了相同的 $p$ 的估计量。这不是巧合，而是源于 HWE 模型的特定代数结构。\n第一种推导在一般的、无约束的参数空间（三个概率的 2-单纯形）中找到 MLE。第二种推导将最大化限制在该空间内的一个一维曲面子流形上，该子流形由 HWE 参数方程 $(\\theta_{AA}, \\theta_{Aa}, \\theta_{aa}) = (p^{2}, 2p(1-p), (1-p)^{2})$ 定义。\n\n两个估计量相同的根本原因是，HWE 参数化的构造方式使得诱导的等位基因频率恒等于参数 $p$ 本身。也就是说，如果我们取 HWE 基因型频率并应用等位基因频率的一般定义，我们就能恢复出 $p$：\n$$ \\theta_{AA} + \\frac{1}{2}\\theta_{Aa} = p^{2} + \\frac{1}{2}(2p(1-p)) = p^{2} + p(1-p) = p^{2} + p - p^{2} = p $$\n这表明 HWE 模型中的参数 $p$ 与我们在第一部分中希望估计的量具有完全相同的定义。\n\nHWE 约束模型的得分方程（对数似然的导数设为零）是 $\\frac{d\\ell}{dp} = 0$，我们发现它导致了以下条件：\n$$ \\hat{p} = \\frac{2n_{AA} + n_{Aa}}{2n} $$\n如果我们将基因型频率的无约束 MLE $\\hat{\\theta}_{ij} = n_{ij}/n$ 代入第一部分中 $\\hat{p}$ 的表达式，我们得到：\n$$ \\hat{p} = \\frac{n_{AA}}{n} + \\frac{1}{2}\\frac{n_{Aa}}{n} = \\hat{\\theta}_{AA} + \\frac{1}{2}\\hat{\\theta}_{Aa} $$\n综合这些表明，HWE 下的 MLE，$\\hat{p}$，满足 $\\hat{p} = \\hat{\\theta}_{AA} + \\frac{1}{2}\\hat{\\theta}_{Aa}$。这意味着在 HWE 假设下的 MLE 正是从观测到的样本基因型比例计算出的等位基因频率。\n\n本质上，HWE 曲线上的“最佳拟合”点是其参数 $p$ 与从更大的、无约束空间中的全局最优点计算出的等位基因频率相匹配的点。这是一个特殊性质，对于任意的重参数化并不成立。它在这里之所以有效，是因为 HWE 模型属于指数分布族，并且等位基因频率 $p$ 是无约束模型中自然参数的线性函数，而在这里自然参数对应于基因型频率。无论是在完整参数空间还是在 HWE 子流形上最大化似然，都会将样本等位基因频率确定为种群等位基因频率的最优估计。数量 $2n_{AA} + n_{Aa}$ 代表样本中等位基因 $A$ 的总数，而 $2n$ 是等位基因拷贝的总数。因此，该估计量是等位基因 $A$ 的样本比例，这个结果在两种建模场景下都既直观又在数学上是稳健的。",
            "answer": "$$\n\\boxed{\\frac{2n_{AA} + n_{Aa}}{2n}}\n$$"
        },
        {
            "introduction": "在掌握了如何估计等位基因频率后，下一步便是检验一个群体是否符合哈迪-温伯格平衡的预期。本练习提供了一个包含多个等位基因的真实数据场景，要求您完整地执行一次皮尔逊卡方拟合优度检验 。通过亲手计算预期基因型频率、自由度以及最终的卡方统计量，您将把抽象的统计理论转化为解决实际问题的有力工具。",
            "id": "2721768",
            "problem": "在一个随机交配的二倍体种群中，对 $N$ 个无亲缘关系个体的样本中的一个常染色体座位进行分型。该座位有 $k=4$ 个等位基因，分别标记为 $A_1,A_2,A_3,A_4$。假设该种群满足经典的哈迪-温伯格假说（随机交配、无选择、无突变、无迁移以及有效无限大的种群规模），因此基因型频率仅由等位基因频率决定。基因型以无序类别 $A_iA_j$（其中 $i \\le j$）记录。观察到的基因型计数如下：\n- $A_1A_1$: $135$\n- $A_2A_2$: $70$\n- $A_3A_3$: $29$\n- $A_4A_4$: $6$\n- $A_1A_2$: $180$\n- $A_1A_3$: $130$\n- $A_1A_4$: $60$\n- $A_2A_3$: $105$\n- $A_2A_4$: $53$\n- $A_3A_4$: $32$\n\n仅从哈迪-温伯格关于纯合子和杂合子基因型概率是等位基因频率的函数的定义出发，按顺序完成以下任务：\n1. 通过适用于哈迪-温伯格平衡（HWE）下多项式计数的似然论证，从样本中获得等位基因频率的估计值 $\\hat{p}_1,\\hat{p}_2,\\hat{p}_3,\\hat{p}_4$。\n2. 使用这些 $\\hat{p}_i$ 计算在HWE下每个基因型类别中的期望计数。\n3. 从第一性原理出发，通过计算参数和约束条件的数量，来论证一个有 $k$ 个等位基因的座位在HWE下的皮尔逊卡方拟合优度检验的自由度，并将其表示为 $k$ 的函数。\n4. 使用步骤2中得到的期望计数，计算观测数据的皮尔逊卡方统计量。\n\n将步骤4中得到的卡方统计量的数值作为最终答案报告，四舍五入到四位有效数字。不要报告 $p$ 值。最终答案必须是一个不带单位的实数。",
            "solution": "该问题陈述经过验证，被认为是科学上合理的、问题明确的、客观的且自洽的。这是群体遗传学中的一个标准练习，涉及哈迪-温伯格原理和皮尔逊卡方拟合优度检验的应用。不存在使其无效的缺陷。我们开始解答。\n\n该问题需要一个四步的解题过程。我们将按顺序处理每一步。\n\n步骤1：估计等位基因频率。\n问题陈述该种群处于哈迪-温伯格平衡（HWE）状态。对于一个有 $k$ 个等位基因 $A_1, A_2, \\dots, A_k$（其各自的种群频率为 $p_1, p_2, \\dots, p_k$）的座位，在HWE下的期望基因型频率对于纯合子 $A_iA_i$ 是 $p_i^2$，对于杂合子 $A_iA_j$（其中 $i \\neq j$）是 $2p_ip_j$。数据由来自 $N$ 个个体样本的基因型计数 $n_{ij}$ 组成。这些计数遵循一个多项分布，其概率由HWE频率给出。\n\n对于给定的等位基因频率 $\\{p_i\\}$，观察到的基因型计数 $\\{n_{ij}\\}$ 的似然函数 $L$ 正比于：\n$$L(\\{p_i\\}) \\propto \\left( \\prod_{i=1}^{k} (p_i^2)^{n_{ii}} \\right) \\left( \\prod_{i<j} (2p_ip_j)^{n_{ij}} \\right)$$\n为了找到等位基因频率的最大似然估计（MLEs），我们最大化对数似然 $\\ln L$：\n$$\\ln L = \\sum_{i=1}^{k} n_{ii} \\ln(p_i^2) + \\sum_{i<j} n_{ij} \\ln(2p_ip_j) + C$$\n其中 $C$ 是一个常数。这可以简化为：\n$$\\ln L = \\sum_{i=1}^{k} 2n_{ii} \\ln(p_i) + \\sum_{i<j} n_{ij}(\\ln(2) + \\ln(p_i) + \\ln(p_j)) + C$$\n重新整理各项，按 $\\ln(p_i)$ 分组：\n$$\\ln L = \\sum_{i=1}^{k} \\left( 2n_{ii} + \\sum_{j \\neq i} n_{ij} \\right) \\ln(p_i) + C'$$\n项 $C_i = 2n_{ii} + \\sum_{j \\neq i} n_{ij}$ 代表样本中等位基因 $A_i$ 的总计数。需要最大化的表达式是 $\\sum_{i=1}^{k} C_i \\ln(p_i)$，约束条件为 $\\sum_{i=1}^{k} p_i = 1$。使用拉格朗日乘数法，可以证明 $p_i$ 的MLE由等位基因 $A_i$ 在总等位基因库中的比例给出：\n$$\\hat{p}_i = \\frac{C_i}{\\sum_{j=1}^{k} C_j}$$\n在一个包含 $N$ 个二倍体个体的样本中，等位基因的总数为 $2N$。因此，$\\sum_{j=1}^{k} C_j = 2N$，且MLE为 $\\hat{p}_i = \\frac{C_i}{2N}$。这就是“基因计数法”或“等位基因计数法”。\n\n首先，我们从给定的基因型计数中计算总样本量 $N$：\n$n_{11} = 135$， $n_{22} = 70$， $n_{33} = 29$， $n_{44} = 6$。\n$n_{12} = 180$， $n_{13} = 130$， $n_{14} = 60$， $n_{23} = 105$， $n_{24} = 53$， $n_{34} = 32$。\n$$N = 135 + 70 + 29 + 6 + 180 + 130 + 60 + 105 + 53 + 32 = 800$$\n样本中等位基因的总数是 $2N = 1600$。\n\n接下来，我们计算 $k=4$ 个等位基因中每一个的计数：\n$C_1 = 2n_{11} + n_{12} + n_{13} + n_{14} = 2(135) + 180 + 130 + 60 = 270 + 370 = 640$。\n$C_2 = 2n_{22} + n_{12} + n_{23} + n_{24} = 2(70) + 180 + 105 + 53 = 140 + 338 = 478$。\n$C_3 = 2n_{33} + n_{13} + n_{23} + n_{34} = 2(29) + 130 + 105 + 32 = 58 + 267 = 325$。\n$C_4 = 2n_{44} + n_{14} + n_{24} + n_{34} = 2(6) + 60 + 53 + 32 = 12 + 145 = 157$。\n等位基因计数的总和是 $640 + 478 + 325 + 157 = 1600$，这验证了我们对 $2N$ 的计算。\n\n最后，我们计算估计的等位基因频率 $\\hat{p}_i$：\n$\\hat{p}_1 = \\frac{640}{1600} = 0.4$。\n$\\hat{p}_2 = \\frac{478}{1600} = 0.29875$。\n$\\hat{p}_3 = \\frac{325}{1600} = 0.203125$。\n$\\hat{p}_4 = \\frac{157}{1600} = 0.098125$。\n它们的和是 $\\hat{p}_1 + \\hat{p}_2 + \\hat{p}_3 + \\hat{p}_4 = 0.4 + 0.29875 + 0.203125 + 0.098125 = 1.0$。\n\n步骤2：计算期望基因型计数。\n一个基因型类别的期望计数是总样本量 $N$ 乘以在HWE下使用估计的等位基因频率计算出的该基因型的期望频率。\n纯合子 $A_iA_i$ 的期望计数：$E_{ii} = N \\hat{p}_i^2$。\n杂合子 $A_iA_j$ 的期望计数：$E_{ij} = N (2\\hat{p}_i\\hat{p}_j)$。\n使用 $N=800$ 和估计的频率：\n$E_{11} = 800 \\times (0.4)^2 = 800 \\times 0.16 = 128$。\n$E_{22} = 800 \\times (0.29875)^2 = 71.40125$。\n$E_{33} = 800 \\times (0.203125)^2 = 33.0078125$。\n$E_{44} = 800 \\times (0.098125)^2 = 7.7028125$。\n$E_{12} = 800 \\times 2 \\times 0.4 \\times 0.29875 = 191.2$。\n$E_{13} = 800 \\times 2 \\times 0.4 \\times 0.203125 = 130$。\n$E_{14} = 800 \\times 2 \\times 0.4 \\times 0.098125 = 62.8$。\n$E_{23} = 800 \\times 2 \\times 0.29875 \\times 0.203125 = 97.09375$。\n$E_{24} = 800 \\times 2 \\times 0.29875 \\times 0.098125 = 46.903125$。\n$E_{34} = 800 \\times 2 \\times 0.203125 \\times 0.098125 = 31.890625$。\n这些期望计数的总和是 $800$。\n\n步骤3：自由度的论证。\n皮尔逊卡方拟合优度检验的自由度（$df$）的计算方法是：类别总数减1，再减去根据数据估计出的独立参数的数目。\n首先，我们计算类别的数量。对于 $k$ 个等位基因，有 $k$ 种可能的纯合子基因型（$A_1A_1, \\dots, A_kA_k$）和 $\\binom{k}{2}$ 种可能的杂合子基因型（$A_iA_j$ 且 $i<j$）。基因型类别的总数是：\n$$\\text{类别数} = k + \\binom{k}{2} = k + \\frac{k(k-1)}{2} = \\frac{2k + k^2 - k}{2} = \\frac{k(k+1)}{2}$$\n接下来，我们计算估计的独立参数的数量。HWE模型由 $k$ 个等位基因频率 $p_1, \\dots, p_k$ 指定。但是，这些频率受到 $\\sum_{i=1}^{k} p_i = 1$ 的约束。因此，只有 $k-1$ 个频率是独立的；一旦知道了 $k-1$ 个，第 $k$ 个就确定了。在这个问题中，我们从数据中估计了 $k-1 = 4-1 = 3$ 个独立的等位基因频率。\n因此，自由度为：\n$$df = (\\text{类别数}) - 1 - (\\text{估计的独立参数数目})$$\n$$df = \\frac{k(k+1)}{2} - 1 - (k-1) = \\frac{k(k+1)}{2} - k$$\n$$df = \\frac{k^2+k-2k}{2} = \\frac{k^2-k}{2} = \\frac{k(k-1)}{2} = \\binom{k}{2}$$\n对于本问题中 $k=4$ 个等位基因的情况，自由度为 $df = \\binom{4}{2} = \\frac{4 \\times 3}{2} = 6$。\n\n步骤4：计算皮尔逊卡方统计量。\n该统计量按公式 $\\chi^2 = \\sum \\frac{(\\text{观察值} - \\text{期望值})^2}{\\text{期望值}}$ 对所有基因型类别进行计算。设 $O_{ij}$ 为观察计数。\n我们计算每个类别的贡献值：\n$A_1A_1$: $\\frac{(135 - 128)^2}{128} = \\frac{7^2}{128} = \\frac{49}{128} \\approx 0.3828125$。\n$A_2A_2$: $\\frac{(70 - 71.40125)^2}{71.40125} = \\frac{(-1.40125)^2}{71.40125} \\approx 0.0275135$。\n$A_3A_3$: $\\frac{(29 - 33.0078125)^2}{33.0078125} = \\frac{(-4.0078125)^2}{33.0078125} \\approx 0.4866320$。\n$A_4A_4$: $\\frac{(6 - 7.7028125)^2}{7.7028125} = \\frac{(-1.7028125)^2}{7.7028125} \\approx 0.3764172$。\n$A_1A_2$: $\\frac{(180 - 191.2)^2}{191.2} = \\frac{(-11.2)^2}{191.2} \\approx 0.6560669$。\n$A_1A_3$: $\\frac{(130 - 130)^2}{130} = \\frac{0^2}{130} = 0$。\n$A_1A_4$: $\\frac{(60 - 62.8)^2}{62.8} = \\frac{(-2.8)^2}{62.8} \\approx 0.1248408$。\n$A_2A_3$: $\\frac{(105 - 97.09375)^2}{97.09375} = \\frac{(7.90625)^2}{97.09375} \\approx 0.6437988$。\n$A_2A_4$: $\\frac{(53 - 46.903125)^2}{46.903125} = \\frac{(6.096875)^2}{46.903125} \\approx 0.7925227$。\n$A_3A_4$: $\\frac{(32 - 31.890625)^2}{31.890625} = \\frac{(0.109375)^2}{31.890625} \\approx 0.0003751$。\n\n将这些值相加得到卡方统计量：\n$$\\chi^2 \\approx 0.38281 + 0.02751 + 0.48663 + 0.37642 + 0.65607 + 0 + 0.12484 + 0.64380 + 0.79252 + 0.00038$$\n$$\\chi^2 \\approx 3.49098$$\n四舍五入到四位有效数字，结果是 $3.491$。",
            "answer": "$$\\boxed{3.491}$$"
        },
        {
            "introduction": "哈迪-温伯格原理的真正力量不仅在于描述理想群体的静态平衡，更在于它为我们提供了一个识别和量化演化力量的基准。本练习将挑战您分析一个打破了孟德尔遗传定律（HWE 的核心假设之一）的情景——分离畸变（segregation distortion）。通过推导在存在该演化压力时，群体基因库的动态变化以及恢复平衡的条件，您将学会如何运用数学模型来探索演化的复杂机制。",
            "id": "2721761",
            "problem": "考虑一个随机交配、雌雄异体的二倍体物种，其某个常染色体基因座上有两个等位基因 $A$ 和 $a$。设成年雄性种群的等位基因频率为 $\\pi_m$，成年雌性种群的等位基因频率为 $\\pi_f$。在每个性别内部，假定基因型比例相对于其特定性别的等位基因频率呈哈代-温伯格平衡。在配子发生过程中，雌性减数分裂是孟德尔式的（杂合子以 $1/2$ 的概率传递等位基因 $A$），但雄性减数分裂表现出分离畸变：雄性杂合子以概率 $k$（其中 $0 \\leq k \\leq 1$）传递等位基因 $A$。纯合子以概率 $1$ 传递其等位基因。假设在减数分裂和合子形成之间没有其他因素起作用，并且合子由雌雄配子随机结合形成，且两性贡献相等。\n\n任务：\n1) 推导雄配子中 $A$ 的等位基因频率 $p_m$ 和雌配子中 $A$ 的等位基因频率 $p_f$，将它们表示为 $\\pi_m$、$\\pi_f$ 和 $k$ 的函数。\n2) 仅使用哈代-温伯格平衡 (HWE) 的基本定义，用 $p_m$ 和 $p_f$ 写出合子的基因型频率，并确定合子处于 HWE 的条件。特别地，评估当 $p_m \\neq p_f$ 时 HWE 是否能够成立，除非可能是在等位基因在配子中被固定的边界情况下。\n3) 求解能使合子恢复 HWE 的畸变参数值 $k^{\\star}$，用成年种群的等位基因频率 $\\pi_m$ 和 $\\pi_f$ 来表示，并假设 $0 < \\pi_m < 1$。\n\n请提供 $k^{\\star}$ 关于 $\\pi_m$ 和 $\\pi_f$ 的闭式解析表达式作为最终答案。无需进行数值计算。",
            "solution": "该问题经检验在科学上是合理的、适定的和客观的。这是理论群体遗传学中的一个标准练习。我们着手进行解答。\n\n该问题要求一个三部分的推导，涉及一个雌雄异体、具有性别特异性等位基因频率、且一个性别中存在非孟德尔式分离的二倍体种群中的哈代-温伯格平衡 (HWE)。\n\n首先，我们解决任务1：推导雄配子中 $A$ 的等位基因频率 $p_m$ 和雌配子中 $A$ 的等位基因频率 $p_f$。\n\n假设成年雌性种群处于哈代-温伯格平衡，其等位基因 $A$ 的频率为 $\\pi_f$。因此，雌性的基因型频率为：\n- $AA$ 雌性的频率：$\\pi_f^2$\n- $Aa$ 雌性的频率：$2\\pi_f(1-\\pi_f)$\n- $aa$ 雌性的频率：$(1-\\pi_f)^2$\n\n雌性减数分裂是孟德尔式的。$AA$ 个体只产生 $A$ 配子（概率为 $1$），$Aa$ 个体以概率 $\\frac{1}{2}$ 产生 $A$ 配子，而 $aa$ 个体不产生 $A$ 配子（概率为 $0$）。雌配子库中等位基因 $A$ 的频率 $p_f$ 是来自每种基因型的 $A$ 配子产量的加权平均值：\n$$p_f = (1) \\cdot (\\pi_f^2) + \\left(\\frac{1}{2}\\right) \\cdot (2\\pi_f(1-\\pi_f)) + (0) \\cdot ((1-\\pi_f)^2)$$\n$$p_f = \\pi_f^2 + \\pi_f(1-\\pi_f) = \\pi_f^2 + \\pi_f - \\pi_f^2 = \\pi_f$$\n正如孟德尔遗传所预期的，配子中的等位基因频率与亲代中的相同。\n\n成年雄性种群处于哈代-温伯格平衡，其等位基因 $A$ 的频率为 $\\pi_m$。雄性的基因型频率为：\n- $AA$ 雄性的频率：$\\pi_m^2$\n- $Aa$ 雄性的频率：$2\\pi_m(1-\\pi_m)$\n- $aa$ 雄性的频率：$(1-\\pi_m)^2$\n\n雄性减数分裂表现出分离畸变，其中杂合（$Aa$）雄性以概率 $k$ 传递 $A$ 等位基因。纯合雄性则确定地传递其等位基因。因此，雄配子库中等位基因 $A$ 的频率 $p_m$ 为：\n$$p_m = (1) \\cdot (\\pi_m^2) + (k) \\cdot (2\\pi_m(1-\\pi_m)) + (0) \\cdot ((1-\\pi_m)^2)$$\n$$p_m = \\pi_m^2 + 2k\\pi_m(1-\\pi_m)$$\n\n这就完成了第一个任务。对于第二个任务，我们必须找出合子处于 HWE 的条件。合子由雌雄配子随机结合形成。合子代的基因型频率为：\n- $AA$ 合子的频率：$P(AA) = p_m p_f$\n- $Aa$ 合子的频率：$P(Aa) = p_m(1-p_f) + p_f(1-p_m)$\n- $aa$ 合子的频率：$P(aa) = (1-p_m)(1-p_f)$\n\n合子种群中等位基因 $A$ 的总频率，我们称之为 $p_{zygote}$，是两个配子库中频率的平均值，因为每个性别贡献相等：\n$$p_{zygote} = \\frac{p_m + p_f}{2}$$\n要使合子种群处于 HWE，其基因型频率必须满足 $P(AA) = p_{zygote}^2$，$P(Aa) = 2 p_{zygote}(1-p_{zygote})$ 和 $P(aa) = (1-p_{zygote})^2$。我们可以使用任一基因型频率来检验此条件。让我们使用 $P(AA)$：\n$$P(AA) = p_{zygote}^2$$\n$$p_m p_f = \\left(\\frac{p_m + p_f}{2}\\right)^2$$\n将右侧展开得到：\n$$p_m p_f = \\frac{p_m^2 + 2p_m p_f + p_f^2}{4}$$\n乘以 $4$ 并整理各项：\n$$4p_m p_f = p_m^2 + 2p_m p_f + p_f^2$$\n$$0 = p_m^2 - 2p_m p_f + p_f^2$$\n这是完全平方差的展开式：\n$$0 = (p_m - p_f)^2$$\n该方程成立的充要条件是 $p_m - p_f = 0$，即 $p_m = p_f$。因此，合子种群处于哈代-温伯格平衡的基本条件是，雄性和雌性配子库中的等位基因频率必须相同。如果 $p_m \\neq p_f$（且我们不处于某个等位基因被固定的边界情况），则 $(p_m - p_f)^2 > 0$，该条件不被满足，合子种群将不会处于 HWE。\n\n最后，对于第三个任务，我们必须求解能使合子恢复 HWE 的畸变参数值 $k^{\\star}$。这需要应用在任务2中推导出的条件 $p_m = p_f$，并使用在任务1中推导出的 $p_m$ 和 $p_f$ 的表达式。\n$$p_f = \\pi_f$$\n$$p_m = \\pi_m^2 + 2k\\pi_m(1-\\pi_m)$$\n令它们相等以求解 $k^{\\star}$：\n$$\\pi_m^2 + 2k^{\\star}\\pi_m(1-\\pi_m) = \\pi_f$$\n我们现在求解 $k^{\\star}$。整理方程：\n$$2k^{\\star}\\pi_m(1-\\pi_m) = \\pi_f - \\pi_m^2$$\n根据 $0 < \\pi_m < 1$ 的假设，项 $\\pi_m(1-\\pi_m)$ 非零，因此我们可以除以 $2\\pi_m(1-\\pi_m)$ 来解出 $k^{\\star}$：\n$$k^{\\star} = \\frac{\\pi_f - \\pi_m^2}{2\\pi_m(1-\\pi_m)}$$\n这就是所求的能使配子等位基因频率相等、从而确保最终的合子种群处于哈代-温伯格平衡的分离畸变参数 $k^{\\star}$ 的闭式表达式。",
            "answer": "$$\\boxed{\\frac{\\pi_f - \\pi_m^{2}}{2 \\pi_m (1 - \\pi_m)}}$$"
        }
    ]
}