{
    "hands_on_practices": [
        {
            "introduction": "To truly understand a stochastic model, one must grasp its fundamental building block: the rule governing the transition from one state to the next. This first exercise guides you through a foundational derivation of the one-generation transition probability for the classic Wright-Fisher model, starting from first principles. By formalizing the model's core assumption of random sampling with replacement from a parental gene pool, you will see how the complex, long-term behavior of genetic drift emerges directly from a simple binomial sampling process . This practice is essential for building a solid theoretical footing in stochastic evolutionary dynamics.",
            "id": "2753551",
            "problem": "Consider a neutral, biallelic locus with alleles $A$ and $a$ evolving in a diploid Wright–Fisher population of constant size $N$. Generations are non-overlapping, there is random mating, no selection, no mutation, and no migration. Let $X_t$ denote the number of copies of allele $A$ among the $2N$ gene copies in generation $t$. Conditional on $X_t=i$, define the allele-$A$ frequency as $p=i/(2N)$. The next generation is formed by sampling $2N$ gene copies independently with replacement from the parental gene pool, consistent with random mating and Mendelian segregation under neutrality.\n\nStarting from these model assumptions alone and first principles of finite sampling, derive the exact one-step transition probability mass function for $X_{t+1}$ conditional on $X_t=i$. Your final answer must be a single closed-form analytic expression for $\\Pr(X_{t+1}=k \\mid X_t=i)$ as a function of $N$, $i$, and $k$, using only elementary functions and standard combinatorial quantities.\n\nExpress your answer as a single algebraic expression. Do not provide an inequality or an equation to be solved. No rounding is required.",
            "solution": "The problem statement has been subjected to rigorous validation. It is a standard, well-posed problem in theoretical population genetics, grounded in established principles of stochastic modeling. All necessary data and conditions are provided, and there are no scientific or logical inconsistencies. The task is to derive the one-step transition probability for the Wright-Fisher model from first principles, which is a fundamental exercise. We shall now proceed with this derivation.\n\nThe state of the population at generation $t$ is given by $X_t = i$, where $i$ is the number of copies of allele $A$ in a total gene pool of size $2N$. The value of $i$ can range from $0$ to $2N$. From this, the frequency of allele $A$ in the parental gene pool is precisely $p = \\frac{i}{2N}$. The frequency of the other allele, $a$, is $1-p = 1 - \\frac{i}{2N} = \\frac{2N-i}{2N}$.\n\nThe problem states that the gene pool for the subsequent generation, $t+1$, is formed by sampling $2N$ gene copies independently and with replacement from the gene pool of generation $t$. This sampling scheme is the defining characteristic of the Wright-Fisher model. The process of drawing one gene copy for the next generation can be modeled as a single trial. We must perform $2N$ such trials to form the new generation.\n\nLet us define a \"success\" for a single trial as the event that the drawn gene copy is of allele type $A$. Since the sampling is performed with replacement, the probability of success for each trial is constant and independent of the outcomes of all other trials. This probability is equal to the frequency of allele $A$ in the parental gene pool, which is $p = \\frac{i}{2N}$.\n\nWe are interested in the probability that the next generation contains exactly $k$ copies of allele $A$. This is equivalent to asking for the probability of obtaining exactly $k$ successes in a sequence of $n = 2N$ independent Bernoulli trials, where the probability of success in each trial is $p = \\frac{i}{2N}$.\n\nThis is, by definition, a problem described by the binomial distribution. The probability mass function (PMF) for a binomial random variable $K$ with parameters $n$ (number of trials) and $p$ (probability of success) is given by the formula:\n$$ \\Pr(K=k) = \\binom{n}{k} p^k (1-p)^{n-k} $$\nwhere $k$ is the number of successes sought, and $\\binom{n}{k}$ is the binomial coefficient, which counts the number of ways to choose $k$ successful trials out of $n$ total trials.\n\nTo derive the specific transition probability $\\Pr(X_{t+1}=k \\mid X_t=i)$, we substitute the parameters of the Wright-Fisher model into the general binomial PMF:\n1.  The number of trials is the total number of gene copies in the new generation, so $n = 2N$.\n2.  The number of successes is the desired number of $A$ alleles in the new generation, so the variable is $k$. The range of possible values for $k$ is $0, 1, 2, \\dots, 2N$.\n3.  The probability of success for each trial is the frequency of allele $A$ in the parent generation, $p = \\frac{i}{2N}$.\n4.  The probability of failure (drawing an allele $a$) is $1-p = 1 - \\frac{i}{2N} = \\frac{2N-i}{2N}$.\n\nSubstituting these values into the binomial PMF yields the one-step transition probability for the Wright-Fisher model:\n$$ \\Pr(X_{t+1}=k \\mid X_t=i) = \\binom{2N}{k} \\left(\\frac{i}{2N}\\right)^k \\left(\\frac{2N-i}{2N}\\right)^{2N-k} $$\nThis expression represents the probability of transitioning from a state with $i$ copies of allele $A$ to a state with $k$ copies in a single generation. It is a closed-form analytical expression using standard combinatorial quantities, as required. This completes the derivation from first principles.",
            "answer": "$$\n\\boxed{\\binom{2N}{k} \\left(\\frac{i}{2N}\\right)^k \\left(\\frac{2N-i}{2N}\\right)^{2N-k}}\n$$"
        },
        {
            "introduction": "Population genetics often employs different idealized models to capture the same underlying process, and understanding their relationships is a key analytical skill. This practice introduces the Moran model, with its overlapping generations, as an alternative to the Wright-Fisher framework. You are tasked with comparing the two models by calculating the variance of allele frequency change per unit time, a quantity that serves as the diffusion coefficient in the continuous limit . Deriving the timescale mapping that equates the drift variance of these distinct models provides a deep insight into how different microscopic dynamics can converge to the same macroscopic evolutionary behavior.",
            "id": "2753553",
            "problem": "A neutral allele segregates in a closed, randomly mating diploid population of size $N$ with non-overlapping generations under the Wright–Fisher model, and in an overlapping-generation population evolving by the Moran model via single birth–death events. Let $p_t$ denote the allele frequency at time $t$.\n\nAssume the following foundational definitions.\n\n1. Wright–Fisher model: In each generation, the $2N$ gene copies of the next generation are sampled independently from the current generation, each being of the focal allele with probability $p_t$. Hence $p_{t+1} = \\frac{K}{2N}$ where $K \\sim \\operatorname{Binomial}(2N,p_t)$.\n\n2. Moran model on gene copies: The population is represented as $M$ haploid gene copies, with $M=2N$, evolving by repeated replacement events. In each event, one gene copy is chosen as a parent uniformly at random and copied, and one (possibly the same type) gene copy is chosen uniformly at random to be removed. Let a “Moran event” denote one such birth–death replacement, and let $p$ denote the allele frequency just before an event.\n\nDefine the drift variance “per unit time” as the leading-order conditional variance of the allele-frequency increment divided by the unit of time. For the Wright–Fisher model, take the unit of time to be one generation. For the Moran model, suppose there are $c$ Moran birth–death events, in expectation, during the time interval corresponding to one Wright–Fisher generation; assume independence of increments over events at fixed allele frequency $p$ to leading order.\n\nUsing only the above fundamental definitions and standard properties of the binomial distribution, first compute the neutral genetic-drift variance per Wright–Fisher generation. Next, compute the neutral genetic-drift variance contributed by a single Moran birth–death event. Then, by matching the two diffusion coefficients (variance rates) at the same allele frequency $p$, determine the unique scaling factor $c=c(N)$, i.e., the expected number of Moran birth–death events that must occur during one Wright–Fisher generation in order for the two models to have identical neutral-drift diffusion coefficients.\n\nYour final answer must be a single closed-form expression for $c(N)$, with no units. No numerical approximation or rounding is required.",
            "solution": "The problem requires us to determine the scaling factor $c(N)$ that equates the neutral genetic-drift diffusion coefficients of the Wright-Fisher model and the Moran model. We will proceed by first calculating the variance of the allele frequency change per unit time for each model as defined, and then equating these quantities. For the allele frequency at a particular time, we use the generic symbol $p$.\n\nFirst, we analyze the Wright-Fisher model. The population consists of $N$ diploid individuals, corresponding to $2N$ gene copies. The allele frequency in the next generation, $p_{t+1}$, is given by $p_{t+1} = \\frac{K}{2N}$, where $K$ is a random variable drawn from a binomial distribution, $K \\sim \\operatorname{Binomial}(2N, p_t)$. The change in allele frequency in one generation is $\\Delta p = p_{t+1} - p_t$. The problem asks for the drift variance per unit time, which for the Wright-Fisher model is the conditional variance of $\\Delta p$ over one generation.\nThe conditional expectation of the change is zero for a neutral allele:\n$$E[\\Delta p | p_t] = E[p_{t+1} - p_t | p_t] = E\\left[\\frac{K}{2N}\\right] - p_t = \\frac{1}{2N}E[K] - p_t = \\frac{1}{2N}(2Np_t) - p_t = 0$$\nThe conditional variance is therefore:\n$$\\operatorname{Var}(\\Delta p | p_t) = \\operatorname{Var}(p_{t+1} - p_t | p_t)$$\nSince $p_t$ is a given constant in the conditioning, this simplifies to:\n$$\\operatorname{Var}(\\Delta p | p_t) = \\operatorname{Var}(p_{t+1} | p_t) = \\operatorname{Var}\\left(\\frac{K}{2N} | p_t\\right) = \\frac{1}{(2N)^2} \\operatorname{Var}(K | p_t)$$\nThe variance of a binomial random variable $\\operatorname{Binomial}(n,p)$ is $n p (1-p)$. In our case, $n=2N$ and the probability is $p_t$. Thus, $\\operatorname{Var}(K | p_t) = 2N p_t(1-p_t)$.\nSubstituting this into the expression for the variance of the frequency change, we obtain the diffusion coefficient for the Wright-Fisher model, which we denote $D_{WF}$:\n$$D_{WF} = \\frac{1}{4N^2} \\left[2N p_t(1-p_t)\\right] = \\frac{p_t(1-p_t)}{2N}$$\n\nNext, we analyze the Moran model. The population is defined as $M = 2N$ haploid gene copies. Let the number of focal alleles be $i$, so the frequency is $p = i/M$. A Moran event is a single birth-death replacement. The problem description, \"one gene copy is chosen as a parent uniformly at random and copied, and one ... gene copy is chosen uniformly at random to be removed,\" is interpreted as two independent draws from the population of $M$ gene copies to determine the parent and the individual to be removed.\nLet $\\delta p$ be the change in allele frequency in one such event. The number of focal alleles, $i$, can change by $+1$, $-1$, or $0$.\nThe number of focal alleles increases by one ($\\Delta i = +1$) if a focal allele is chosen as parent (probability $p = i/M$) and a non-focal allele is chosen for removal (probability $1-p = (M-i)/M$). The probability for this transition is $p(1-p)$.\nThe number of focal alleles decreases by one ($\\Delta i = -1$) if a non-focal allele is chosen as parent (probability $1-p$) and a focal allele is chosen for removal (probability $p$). The probability for this transition is $(1-p)p$.\nThe number of alleles remains unchanged ($\\Delta i = 0$) if both the parent and the removed individual are of the same type, which occurs with probability $p^2 + (1-p)^2$.\nThe change in frequency is $\\delta p = \\Delta i / M$. The expected change per event is:\n$$E[\\delta p | p] = \\frac{1}{M} E[\\Delta i | p] = \\frac{1}{M} \\left[ (+1)p(1-p) + (-1)p(1-p) + (0)\\left(p^2+(1-p)^2\\right) \\right] = 0$$\nThe variance of the frequency change per event is $\\operatorname{Var}(\\delta p | p) = E[(\\delta p)^2 | p] - (E[\\delta p | p])^2 = E[(\\delta p)^2 | p]$.\n$$E[(\\delta p)^2 | p] = \\left(\\frac{+1}{M}\\right)^2 p(1-p) + \\left(\\frac{-1}{M}\\right)^2 p(1-p) + (0)^2\\left(p^2+(1-p)^2\\right) = \\frac{2p(1-p)}{M^2}$$\nSubstituting $M=2N$, the variance per Moran event is:\n$$\\operatorname{Var}(\\delta p | p) = \\frac{2p(1-p)}{(2N)^2} = \\frac{p(1-p)}{2N^2}$$\nAccording to the problem, there are $c$ such events in the time corresponding to one Wright-Fisher generation. Assuming independence of increments, the total variance over this period, which gives the diffusion coefficient for the Moran model, $D_M$, is:\n$$D_M = c \\cdot \\operatorname{Var}(\\delta p | p) = c \\frac{p(1-p)}{2N^2}$$\n\nTo find the scaling factor $c(N)$, we equate the two diffusion coefficients, $D_{WF} = D_M$, using a common reference frequency $p$:\n$$\\frac{p(1-p)}{2N} = c \\frac{p(1-p)}{2N^2}$$\nFor a polymorphic population where $p \\in (0,1)$, we can divide both sides by the term $p(1-p)$:\n$$\\frac{1}{2N} = \\frac{c}{2N^2}$$\nSolving this equation for $c$ yields the unique scaling factor:\n$$c = \\frac{2N^2}{2N} = N$$\nThus, for the neutral drift variance to be equivalent on the time scale of one generation, $N$ Moran birth-death events must occur.",
            "answer": "$$\\boxed{N}$$"
        },
        {
            "introduction": "While theoretical derivations provide a formal foundation, computational simulations build intuition and allow for the exploration of complex dynamics that are analytically intractable. This final practice bridges theory and application by bringing the abstract concepts of the Wright-Fisher and Moran models to life through code. You will implement both processes as stochastic simulations to generate allele frequency trajectories and estimate key evolutionary outcomes, such as the time to fixation . This exercise not only reinforces the theoretical relationship between the models but also develops practical skills in computational modeling, a cornerstone of modern quantitative biology.",
            "id": "2753535",
            "problem": "You are to write a complete, runnable program that compares two stochastic models of neutral genetic drift for a haploid, panmictic population of constant size: the Wright-Fisher (WF) model and the continuous-time Moran process (MP). For the Wright-Fisher model, use direct binomial sampling per generation. For the Moran process, use a tau-leaping (TL) approximation in continuous time. Your goal is to estimate fixation times from first principles and to provide a computational complexity proxy based on random number generation counts.\n\nFundamental assumptions and definitions:\n- There are two alleles, denoted $A$ and $a$. The population size is $N$, which is constant across time. The state at time $t$ is the number of $A$ alleles, denoted $X_t \\in \\{0,1,\\dots,N\\}$.\n- The initial count is $X_0=i_0$.\n- The process is neutral (no selection and no mutation). Thus, parent choices are proportional to allele frequencies.\n- Absorption occurs when $X_t \\in \\{0,N\\}$. The fixation time is the time until absorption starting from $X_0=i_0$.\n\nWright-Fisher (WF) model specification:\n- Time is in discrete generations $t=0,1,2,\\dots$.\n- The update is $X_{t+1} \\sim \\mathrm{Binomial}(N, p_t)$ with $p_t = X_t/N$.\n- The fixation time is the smallest generation $T_{\\mathrm{WF}}$ such that $X_{T_{\\mathrm{WF}}} \\in \\{0,N\\}$.\n\nMoran process (MP) tau-leaping specification:\n- Time is continuous, measured in units such that one unit corresponds to a typical generation-scale time. Let the tau-leaping step be $\\tau>0$.\n- In the neutral continuous-time Moran process, in an infinitesimal time step $dt$, an individual dies and is replaced by the offspring of a randomly chosen parent; effective change events that increase or decrease $X$ by $1$ occur at instantaneous rates\n$$\n\\lambda_+(X) = \\frac{X(N-X)}{N}, \\quad \\lambda_-(X) = \\frac{X(N-X)}{N}.\n$$\n- In the tau-leaping approximation over an interval of length $\\tau$, draw the numbers of upward and downward change events as independent Poisson random variables,\n$$\nK_+ \\sim \\mathrm{Poisson}(\\lambda_+(X)\\,\\tau), \\quad K_- \\sim \\mathrm{Poisson}(\\lambda_-(X)\\,\\tau),\n$$\nand update $X \\leftarrow X + (K_+ - K_-)$ while ensuring $X$ remains in $[0,N]$. If an overshoot beyond $0$ or $N$ occurs within a tau-leap, linearly interpolate the within-step absorption time as a fraction of $\\tau$ proportional to the number of net change events needed to hit the boundary, and then stop.\n- The fixation time is the continuous time $T_{\\mathrm{MP}}$ (in the same unit as above) when $X$ first reaches $\\{0,N\\}$.\n\nEstimation procedure:\n- For each model and each parameter set, perform $R$ independent replicate simulations starting from $X_0=i_0$, obtaining independent fixation times. The estimate of the mean fixation time for a model is the arithmetic mean across the $R$ replicates.\n- As a simple proxy for computational complexity, count the number of pseudo-random variate draws. In the WF simulation, count $1$ per binomial draw per generation until absorption. In the tau-leaping MP simulation, count $2$ per tau-leap step (one for each Poisson draw) until absorption. Aggregate these counts across the $R$ replicates for each model.\n\nDeterminism requirement:\n- For each test case, use a fixed base seed $s$. Instantiate two independent pseudo-random number generators, one for WF and one for MP, with seeds $s+1$ and $s+2$, respectively. Use these generators exclusively for their corresponding model.\n\nNumerical outputs and units:\n- Report fixation times for the Wright-Fisher model in units of generations (integers, but report as floats).\n- Report fixation times for the Moran process in units of generations as defined by the time scale above (floats).\n- For each test case, output a list of four floats:\n  $[\\overline{T}_{\\mathrm{WF}}, \\overline{T}_{\\mathrm{MP}}, \\rho_T, \\rho_{\\mathrm{RNG}}]$,\n  where $\\overline{T}_{\\mathrm{WF}}$ is the estimated mean fixation time for WF, $\\overline{T}_{\\mathrm{MP}}$ is the estimated mean fixation time for MP with tau-leaping, $\\rho_T = \\overline{T}_{\\mathrm{MP}}/\\overline{T}_{\\mathrm{WF}}$, and $\\rho_{\\mathrm{RNG}} = (\\text{total random draws in MP})/(\\text{total random draws in WF})$.\n- Round each float to $6$ decimal places.\n\nTest suite:\n- The program must run the following three test cases and aggregate their results in a single output line.\n  1. Case A (balanced starting state): $N=50$, $i_0=25$, $R=200$, $\\tau=0.2$, $s=12345$.\n  2. Case B (boundary-small population): $N=2$, $i_0=1$, $R=1000$, $\\tau=0.5$, $s=98765$.\n  3. Case C (rare allele): $N=100$, $i_0=10$, $R=100$, $\\tau=0.2$, $s=202345$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of the three case results, each itself a list of four floats, all enclosed in a single pair of square brackets. For example:\n\"[[tWF_A,tMP_A,ratioA,randRatioA],[tWF_B,tMP_B,ratioB,randRatioB],[tWF_C,tMP_C,ratioC,randRatioC]]\"\nThere must be no extra whitespace or text. All floats must be rounded to $6$ decimal places.\n\nConstraints:\n- Ensure that the tau-leaping update for the Moran process does not allow $X$ to leave the interval $[0,N]$. If $X+\\Delta$ would overshoot a boundary, interpolate the absorption within the step as described above and terminate the replicate.\n- All arithmetic must be numerically stable and scientifically plausible within the model assumptions.",
            "solution": "The problem statement has been critically examined.\n\n**Step 1: Extracted Givens**\n- **Population and Alleles**: A haploid, panmictic population of constant size $N$ with two alleles, $A$ and $a$.\n- **State Variable**: The number of $A$ alleles, $X_t \\in \\{0, 1, \\dots, N\\}$.\n- **Initial Condition**: $X_0 = i_0$.\n- **Evolutionary Dynamics**: Neutral process (no selection, no mutation).\n- **Termination Condition**: Absorption occurs when $X_t \\in \\{0,N\\}$. The fixation time is the time to absorption.\n- **Wright-Fisher (WF) Model**:\n    - Time: Discrete generations, $t=0, 1, 2, \\dots$.\n    - Update Rule: $X_{t+1} \\sim \\mathrm{Binomial}(N, p_t)$, where $p_t = X_t/N$.\n    - Fixation Time: $T_{\\mathrm{WF}}$, the smallest integer $T$ where $X_T \\in \\{0,N\\}$.\n- **Moran Process (MP) with Tau-Leaping (TL)**:\n    - Time: Continuous, with step size $\\tau > 0$. Time is scaled such that one unit corresponds to one generation.\n    - Instantaneous Rates of Change: $\\lambda_+(X) = \\frac{X(N-X)}{N}$ for $X \\to X+1$, and $\\lambda_-(X) = \\frac{X(N-X)}{N}$ for $X \\to X-1$.\n    - Update Rule: Over a step $\\tau$, the number of upward and downward events are independent Poisson draws: $K_+ \\sim \\mathrm{Poisson}(\\lambda_+(X)\\,\\tau)$ and $K_- \\sim \\mathrm{Poisson}(\\lambda_-(X)\\,\\tau)$. The state is updated by $X \\leftarrow X + (K_+ - K_-)$.\n    - Overshoot Handling: If the update causes $X$ to go outside $[0,N]$, the absorption time is linearly interpolated within the step $\\tau$ based on the net change required to reach the boundary.\n    - Fixation Time: $T_{\\mathrm{MP}}$, the continuous time when $X$ reaches $\\{0,N\\}$.\n- **Estimation Procedure**:\n    - Replicates: $R$ independent simulations for each model and parameter set.\n    - Mean Fixation Time: Estimated as the arithmetic mean of fixation times from $R$ replicates.\n    - Computational Complexity Proxy: Total count of pseudo-random variate draws across all $R$ replicates. For WF, $1$ draw per generation. For MP-TL, $2$ draws per $\\tau$-step.\n- **Determinism**:\n    - A base seed $s$ is used for each case.\n    - The WF simulation uses a generator seeded with $s+1$.\n    - The MP-TL simulation uses a generator seeded with $s+2$.\n- **Outputs**:\n    - For each test case, a list of four floats: $[\\overline{T}_{\\mathrm{WF}}, \\overline{T}_{\\mathrm{MP}}, \\rho_T, \\rho_{\\mathrm{RNG}}]$.\n    - $\\rho_T = \\overline{T}_{\\mathrm{MP}} / \\overline{T}_{\\mathrm{WF}}$.\n    - $\\rho_{\\mathrm{RNG}} = (\\text{Total MP RNG draws}) / (\\text{Total WF RNG draws})$.\n    - All floats are rounded to $6$ decimal places.\n- **Test Cases**:\n    1.  $N=50$, $i_0=25$, $R=200$, $\\tau=0.2$, $s=12345$.\n    2.  $N=2$, $i_0=1$, $R=1000$, $\\tau=0.5$, $s=98765$.\n    3.  $N=100$, $i_0=10$, $R=100$, $\\tau=0.2$, $s=202345$.\n\n**Step 2: Validation of Givens**\n- **Scientifically Grounded**: The problem is grounded in fundamental models of population genetics. The Wright-Fisher model is a canonical discrete-time model, and the Moran process is its continuous-time counterpart. The specified rates for the Moran process, $\\lambda_\\pm(X) = X(N-X)/N$, are standard for a neutral process when time is scaled in units of generations to match the Wright-Fisher model's timescale. The tau-leaping method is a well-established numerical approximation scheme for simulating such stochastic processes.\n- **Well-Posed**: The problem is specified with mathematical precision. All parameters are provided, and the algorithms for simulation and estimation are clearly defined. The use of fixed seeds ensures a unique, deterministic outcome for the specified simulations.\n- **Objective**: The problem statement is entirely objective and quantitative, free of any subjective or ambiguous language.\n\nAll other validation criteria are met. The problem is not unsound, incomplete, inconsistent, or trivial.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be constructed based on the specifications.\n\n**Solution Methodology**\n\nThe task is to implement and compare two stochastic simulation algorithms for neutral genetic drift. For each test case, we will execute two separate simulation procedures, one for the Wright-Fisher (WF) model and one for the tau-leaping approximation of the Moran Process (MP-TL). The simulations must be deterministic by using specified seeds for the pseudo-random number generators (RNGs).\n\n**Wright-Fisher Simulation**\nFor each of the $R$ replicates:\n1.  Initialize the state $X = i_0$, time $T_{\\mathrm{WF}} = 0$, and RNG draw count $C_{\\mathrm{WF}} = 0$.\n2.  The simulation proceeds in discrete time steps (generations). In each generation $t$, as long as the allele is not fixed (i.e., $0 < X < N$):\n    a. The frequency of allele $A$ is $p = X/N$.\n    b. The number of $A$ alleles in the next generation is drawn from a binomial distribution: $X_{t+1} \\sim \\mathrm{Binomial}(N, p)$. This is implemented using the `numpy.random.Generator.binomial` method.\n    c. The RNG draw count $C_{\\mathrm{WF}}$ is incremented by $1$.\n    d. The time $T_{\\mathrm{WF}}$ is incremented by $1$.\n    e. The state is updated: $X \\leftarrow X_{t+1}$.\n3.  The loop terminates when $X=0$ or $X=N$. The final value of $T_{\\mathrm{WF}}$ is the fixation time for this replicate.\n4.  The total fixation time and total RNG draws are accumulated over all $R$ replicates. Finally, the mean fixation time $\\overline{T}_{\\mathrm{WF}}$ is computed by dividing the sum of fixation times by $R$. The total RNG draw count is the sum over all replicates.\n\n**Moran Process (Tau-Leaping) Simulation**\nFor each of the $R$ replicates:\n1.  Initialize the state $X = i_0$, time $T_{\\mathrm{MP}} = 0.0$, and RNG draw count $C_{\\mathrm{MP}} = 0$.\n2.  The simulation proceeds in continuous time with discrete steps of size $\\tau$, as long as $0 < X < N$:\n    a. Calculate the instantaneous rate of both upward and downward changes: $\\lambda = X(N-X)/N$.\n    b. The mean number of each type of event in the interval $\\tau$ is $\\mu = \\lambda \\cdot \\tau$.\n    c. Draw the number of upward ($K_+$) and downward ($K_-$) jumps from independent Poisson distributions: $K_+ \\sim \\mathrm{Poisson}(\\mu)$ and $K_- \\sim \\mathrm{Poisson}(\\mu)$. This requires two RNG calls, implemented using `numpy.random.Generator.poisson`.\n    d. The RNG draw count $C_{\\mathrm{MP}}$ is incremented by $2$.\n    e. Calculate the net change in the number of $A$ alleles: $\\Delta = K_+ - K_-$.\n    f. Check for absorption (overshoot). Let the potential new state be $X_{\\text{new}} = X + \\Delta$.\n        i. If $X_{\\text{new}} \\ge N$: Absorption by fixation of $A$. This can only occur if $\\Delta > 0$. The time to absorption is interpolated as $T_{\\mathrm{MP}} \\leftarrow T_{\\mathrm{MP}} + \\tau \\cdot (N-X)/\\Delta$. The simulation for this replicate terminates.\n        ii. Else if $X_{\\text{new}} \\le 0$: Absorption by loss of $A$. This can only occur if $\\Delta < 0$. The time to absorption is interpolated as $T_{\\mathrm{MP}} \\leftarrow T_{\\mathrm{MP}} + \\tau \\cdot (X)/(-\\Delta)$. The simulation for this replicate terminates.\n        iii. Otherwise (no absorption): The state and time are updated: $X \\leftarrow X_{\\text{new}}$ and $T_{\\mathrm{MP}} \\leftarrow T_{\\mathrm{MP}} + \\tau$.\n3. The total fixation time and total RNG draws are accumulated over all $R$ replicates. Their mean $\\overline{T}_{\\mathrm{MP}}$ and total count are then calculated.\n\n**Final Calculations**\nFor each test case, after running both simulation ensembles, the required quantities are calculated:\n1. $\\overline{T}_{\\mathrm{WF}}$: Mean fixation time for the Wright-Fisher model.\n2. $\\overline{T}_{\\mathrm{MP}}$: Mean fixation time for the Moran process.\n3. $\\rho_T = \\overline{T}_{\\mathrm{MP}} / \\overline{T}_{\\mathrm{WF}}$: The ratio of mean fixation times.\n4. $\\rho_{\\mathrm{RNG}} = C_{\\mathrm{MP, total}} / C_{\\mathrm{WF, total}}$: The ratio of total RNG calls.\n\nAll floating-point results must be rounded to $6$ decimal places before final output formatting. The use of specific seeds for the RNGs ensures that the entire procedure is deterministic and reproducible.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_wright_fisher(N, i0, R, rng):\n    \"\"\"\n    Simulates the Wright-Fisher model for R replicates.\n    \"\"\"\n    total_fixation_time = 0\n    total_rng_calls = 0\n\n    for _ in range(R):\n        x = i0\n        time = 0\n        rng_calls = 0\n        while 0  x  N:\n            p = x / N\n            x = rng.binomial(N, p)\n            rng_calls += 1\n            time += 1\n        total_fixation_time += time\n        total_rng_calls += rng_calls\n        \n    return total_fixation_time / R, total_rng_calls\n\ndef run_moran_tau_leaping(N, i0, R, tau, rng):\n    \"\"\"\n    Simulates the Moran process using a tau-leaping approximation for R replicates.\n    \"\"\"\n    total_fixation_time = 0.0\n    total_rng_calls = 0\n\n    for _ in range(R):\n        x = float(i0)\n        time = 0.0\n        rng_calls = 0\n        while 0  x  N:\n            # Rate of events that change the count of A\n            rate_param = x * (N - x) / N\n            mu = rate_param * tau\n            \n            # If rate is zero, state is absorbing, but loop condition prevents this.\n            # However, for very small rates, mu can be zero.\n            if mu = 0:\n                # This can happen if x is very close to 0 or N, but the while loop handles the exact boundaries.\n                # If mu is numerically zero, no events occur in this step.\n                time += tau\n                continue\n\n            k_plus, k_minus = rng.poisson(mu, size=2)\n            rng_calls += 2\n            \n            delta = k_plus - k_minus\n            \n            if delta > 0 and x + delta >= N:\n                # Overshot to or past N\n                time += tau * (N - x) / delta\n                break # Replicate finished\n            elif delta  0 and x + delta = 0:\n                # Overshot to or past 0\n                time += tau * x / (-delta)\n                break # Replicate finished\n            else:\n                x += delta\n                time += tau\n\n        total_fixation_time += time\n        total_rng_calls += rng_calls\n\n    return total_fixation_time / R, total_rng_calls\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A (balanced starting state)\n        {'N': 50, 'i0': 25, 'R': 200, 'tau': 0.2, 's': 12345},\n        # Case B (boundary-small population)\n        {'N': 2, 'i0': 1, 'R': 1000, 'tau': 0.5, 's': 98765},\n        # Case C (rare allele)\n        {'N': 100, 'i0': 10, 'R': 100, 'tau': 0.2, 's': 202345},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, i0, R, tau, s = case['N'], case['i0'], case['R'], case['tau'], case['s']\n\n        # Instantiate RNGs with specified seeds\n        rng_wf = np.random.default_rng(seed=s + 1)\n        rng_mp = np.random.default_rng(seed=s + 2)\n\n        # Run Wright-Fisher simulation\n        mean_t_wf, total_rng_wf = run_wright_fisher(N, i0, R, rng_wf)\n\n        # Run Moran process (tau-leaping) simulation\n        mean_t_mp, total_rng_mp = run_moran_tau_leaping(N, i0, R, tau, rng_mp)\n\n        # Calculate ratios, handle potential division by zero (unlikely here)\n        ratio_t = mean_t_mp / mean_t_wf if mean_t_wf != 0 else 0\n        ratio_rng = total_rng_mp / total_rng_wf if total_rng_wf != 0 else 0\n\n        # Store results rounded to 6 decimal places\n        case_results = [\n            round(mean_t_wf, 6),\n            round(mean_t_mp, 6),\n            round(ratio_t, 6),\n            round(ratio_rng, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string\n    case_strings = [f\"[{','.join(f'{val:.6f}' for val in res)}]\" for res in all_results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}