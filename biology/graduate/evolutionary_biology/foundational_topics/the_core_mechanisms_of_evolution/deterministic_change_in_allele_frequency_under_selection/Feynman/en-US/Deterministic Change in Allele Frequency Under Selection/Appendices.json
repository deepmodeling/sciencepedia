{
    "hands_on_practices": [
        {
            "introduction": "This first practice is a foundational exercise in deriving the core mathematical engine of selection. By building the one-generation recursion equation from first principles, we solidify our understanding of how genotype fitnesses translate into allele frequency change. This exercise  further reveals a profound insight: the more complex dynamics of diploid selection can be elegantly expressed in a form analogous to the simpler haploid case by introducing the concept of marginal allelic fitness.",
            "id": "2700654",
            "problem": "Consider a single locus with alleles $A$ and $a$ in a large population with discrete, nonoverlapping generations. Assume no mutation, no migration, and no genetic drift. Selection acts deterministically on absolute viability fitnesses. Let $p$ denote the allele $A$ frequency before selection and $q=1-p$ the allele $a$ frequency.\n\na) Haploid case: The population is haploid and asexual. Each individual carrying allele $A$ has absolute fitness $w_A$, and each individual carrying allele $a$ has absolute fitness $w_a$. Starting only from the definitions that (i) absolute fitness multiplies expected contributions to the next generation and (ii) frequencies must be normalized so they sum to $1$, derive the one-generation recursion that maps $p$ to the post-selection allele frequency $p'$.\n\nb) Diploid case: The population is diploid with random mating, producing zygotes in Hardy–Weinberg proportions before selection. Absolute viabilities of genotypes are $w_{AA}$, $w_{Aa}$, and $w_{aa}$. Selection acts on zygotes prior to reproduction. Starting from first principles (zygote genotype frequencies, viability scaling, and normalization by mean fitness), derive the one-generation recursion mapping $p$ to $p'$ for the allele $A$ frequency among adults after selection. Then, define the allele-specific marginal fitnesses $\\bar{w}_A$ and $\\bar{w}_a$ as genotype-fitness averages over the genetic backgrounds carried by alleles $A$ and $a$, respectively, and algebraically rewrite your diploid recursion in a form that is directly comparable to the haploid recursion from part (a). Provide as your final answer a single closed-form expression for $p'$ written in terms of $p$, $q$, and the marginal fitnesses $\\bar{w}_A$ and $\\bar{w}_a$ obtained from the diploid model. No numerical evaluation is required, and no rounding is needed.",
            "solution": "The problem presented is a standard, well-posed exercise in theoretical population genetics. It is scientifically sound, internally consistent, and contains all necessary information for its resolution. I will therefore proceed with the derivation as requested.\n\nThe task is to derive the one-generation recursion for the frequency of an allele $A$, denoted by $p$, under the influence of deterministic viability selection. This will be done for both a haploid and a diploid population.\n\nPart (a): Haploid Case\n\nIn a haploid population, individuals carry a single copy of the gene. Let the frequency of individuals carrying allele $A$ be $p$ and the frequency of individuals carrying allele $a$ be $q$, where $q = 1-p$. Let the total population size before selection be $N$. The number of individuals of type $A$ is $N_A = Np$ and the number of individuals of type $a$ is $N_a = Nq$.\n\nThe absolute fitnesses are given as $w_A$ and $w_a$. Absolute fitness is a multiplier representing the expected number of offspring an individual contributes to the next generation. After viability selection, the expected numbers of individuals of each type are:\n$$ N'_A = N_A w_A = N p w_A $$\n$$ N'_a = N_a w_a = N q w_a $$\nThe total population size after selection, $N'$, is the sum of these quantities:\n$$ N' = N'_A + N'_a = N p w_A + N q w_a = N(p w_A + q w_a) $$\nThe term $\\bar{w} = p w_A + q w_a$ is the mean absolute fitness of the haploid population. It represents the average fitness across all individuals. Thus, $N' = N \\bar{w}$.\n\nThe frequency of allele $A$ in the next generation, $p'$, is the number of $A$ individuals after selection divided by the total number of individuals after selection.\n$$ p' = \\frac{N'_A}{N'} = \\frac{N p w_A}{N(p w_A + q w_a)} $$\nThe initial population size $N$ cancels, as expected in a deterministic model where only relative frequencies matter for the dynamics. This leaves the recursion:\n$$ p' = \\frac{p w_A}{p w_A + q w_a} = \\frac{p w_A}{\\bar{w}} $$\nThis equation describes the change in the frequency of allele $A$ over one generation of selection in a haploid population.\n\nPart (b): Diploid Case\n\nIn a diploid population with random mating, the frequencies of genotypes among zygotes are given by the Hardy–Weinberg proportions:\n-   Frequency of $AA$: $f(AA) = p^2$\n-   Frequency of $Aa$: $f(Aa) = 2pq$\n-   Frequency of $aa$: $f(aa) = q^2$\nThese frequencies sum to $p^2 + 2pq + q^2 = (p+q)^2 = 1^2 = 1$.\n\nSelection acts on the viability of these zygotes. The absolute viabilities are $w_{AA}$, $w_{Aa}$, and $w_{aa}$ for genotypes $AA$, $Aa$, and $aa$, respectively. The frequencies of the genotypes after selection but before normalization are proportional to their initial frequencies multiplied by their fitnesses:\n-   Proportion of $AA$ survivors $\\propto p^2 w_{AA}$\n-   Proportion of $Aa$ survivors $\\propto 2pq w_{Aa}$\n-   Proportion of $aa$ survivors $\\propto q^2 w_{aa}$\n\nTo obtain the true frequencies of the genotypes among the adult survivors, we must normalize by dividing by the sum of these proportions. This sum is the mean absolute fitness of the diploid population, $\\bar{w}$:\n$$ \\bar{w} = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa} $$\nThe post-selection genotype frequencies are therefore:\n$$ P'_{AA} = \\frac{p^2 w_{AA}}{\\bar{w}} $$\n$$ P'_{Aa} = \\frac{2pq w_{Aa}}{\\bar{w}} $$\n$$ P'_{aa} = \\frac{q^2 w_{aa}}{\\bar{w}} $$\nThe new frequency of allele $A$, denoted $p'$, is the frequency of this allele in the gene pool of the surviving adults. In a diploid organism, each $AA$ individual carries two $A$ alleles and each $Aa$ individual carries one $A$ allele. Thus, $p'$ is the frequency of $AA$ individuals plus half the frequency of $Aa$ individuals:\n$$ p' = P'_{AA} + \\frac{1}{2} P'_{Aa} $$\nSubstituting the expressions for the post-selection genotype frequencies:\n$$ p' = \\frac{p^2 w_{AA}}{\\bar{w}} + \\frac{1}{2} \\left( \\frac{2pq w_{Aa}}{\\bar{w}} \\right) = \\frac{p^2 w_{AA} + pq w_{Aa}}{\\bar{w}} $$\nThis is the fundamental one-generation recursion for allele frequency under viability selection in a diploid population.\n\nNow, we must rewrite this expression in terms of allele-specific marginal fitnesses, $\\bar{w}_A$ and $\\bar{w}_a$. The marginal fitness of an allele is the average fitness of all genotypes in which it occurs, weighted by the frequency of the other allele it is paired with. For allele $A$, it can be paired with another $A$ (from a gamete with frequency $p$) to form $AA$, or with an $a$ (from a gamete with frequency $q$) to form $Aa$. Therefore, the marginal fitness of allele $A$ is:\n$$ \\bar{w}_A = p w_{AA} + q w_{Aa} $$\nSimilarly, for allele $a$:\n$$ \\bar{w}_a = p w_{Aa} + q w_{aa} $$\nLet us now examine the numerator of our expression for $p'$:\n$$ p^2 w_{AA} + pq w_{Aa} = p(p w_{AA} + q w_{Aa}) $$\nThe term in the parenthesis is precisely the definition of the marginal fitness $\\bar{w}_A$. So, the numerator is $p \\bar{w}_A$.\n\nNext, we examine the denominator, which is the mean fitness $\\bar{w}$. We can show that it is a weighted average of the marginal fitnesses:\n$$ p \\bar{w}_A + q \\bar{w}_a = p(p w_{AA} + q w_{Aa}) + q(p w_{Aa} + q w_{aa}) $$\n$$ = p^2 w_{AA} + pq w_{Aa} + qp w_{Aa} + q^2 w_{aa} $$\n$$ = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa} = \\bar{w} $$\nTherefore, the mean fitness can be expressed as $\\bar{w} = p \\bar{w}_A + q \\bar{w}_a$.\n\nSubstituting these new forms for the numerator and denominator into the diploid recursion for $p'$ gives:\n$$ p' = \\frac{p \\bar{w}_A}{p \\bar{w}_A + q \\bar{w}_a} $$\nThis expression is formally identical to the haploid recursion $p' = \\frac{p w_A}{p w_A + q w_a}$, with the haploid fitnesses $w_A$ and $w_a$ being replaced by the diploid marginal fitnesses $\\bar{w}_A$ and $\\bar{w}_a$. This is a profound result, demonstrating that the dynamics of gene frequency change can be described by focusing on the average fitness effects of the alleles themselves, even within the more complex context of diploid genetics. The final requested expression is for $p'$ in terms of $p$, $q$, $\\bar{w}_A$, and $\\bar{w}_a$.",
            "answer": "$$\\boxed{p' = \\frac{p \\bar{w}_A}{p \\bar{w}_A + q \\bar{w}_a}}$$"
        },
        {
            "introduction": "With the recursion equation in hand, we can now explore the long-term consequences of selection by identifying the allele frequencies at which the population ceases to evolve. These fixed points, or equilibria, are central to predicting evolutionary outcomes. This practice  guides you through calculating an internal equilibrium for the important case of underdominance, where the heterozygote is the least fit genotype, and then analyzing its stability to understand why it represents a critical evolutionary \"tipping point.\"",
            "id": "2700643",
            "problem": "Consider a single locus with two alleles, $A$ and $a$, in a large, randomly mating diploid population with discrete, non-overlapping generations. Assume no mutation, no migration, and no genetic drift. Let the relative viabilities of the genotypes be $w_{AA}$, $w_{Aa}$, and $w_{aa}$. The life cycle is zygotes $\\rightarrow$ viability selection $\\rightarrow$ adults $\\rightarrow$ random mating.\n\nStarting from the definitions of Hardy–Weinberg genotype frequencies before selection and the definition of mean fitness as the genotype-frequency-weighted average of viabilities, derive the deterministic recurrence for the allele $A$ frequency, $p \\mapsto p'$, under viability selection. Use this to identify any internal equilibrium allele frequency $p^{\\ast}$ (i.e., $0<p^{\\ast}<1$) by solving the fixed-point condition $p'=p$ in terms of $w_{AA}$, $w_{Aa}$, and $w_{aa}$.\n\nNow specialize to the case of underdominance (heterozygote disadvantage) with $w_{AA}=1$, $w_{Aa}=0.8$, and $w_{aa}=0.9$. Compute the internal equilibrium $p^{\\ast}$ for these values. Then, using your general recurrence and a first-principles sign analysis of the one-generation change $p' - p$ in a neighborhood of $p^{\\ast}$, determine whether $p^{\\ast}$ is locally stable or locally unstable, and explain how the initial condition $p_0$ relative to $p^{\\ast}$ determines fixation of $A$ versus $a$.\n\nReport the numerical value of $p^{\\ast}$ for the given viabilities as a decimal rounded to four significant figures.",
            "solution": "The problem requires the derivation of the fundamental recurrence relation for allele frequency under viability selection, the calculation of the internal equilibrium, and an analysis of its stability for a specific case of underdominance.\n\nFirst, we validate the problem statement.\nThe givens are:\n- A single locus with two alleles, $A$ and $a$.\n- A large, randomly mating diploid population with discrete, non-overlapping generations.\n- Assumptions: no mutation, no migration, no genetic drift.\n- Relative viabilities of genotypes: $w_{AA}$, $w_{Aa}$, and $w_{aa}$.\n- Life cycle: zygotes $\\rightarrow$ viability selection $\\rightarrow$ adults $\\rightarrow$ random mating.\n- Allele frequency of $A$ is denoted by $p$.\n- The task is to derive the recurrence $p \\mapsto p'$, find the internal equilibrium $p^*$, specialize to the case $w_{AA}=1$, $w_{Aa}=0.8$, $w_{aa}=0.9$, compute $p^*$, and determine its stability.\n\nThe problem is scientifically grounded, being a cornerstone of theoretical population genetics. It is well-posed, objective, and internally consistent, with all necessary information provided to derive a unique solution based on established principles. The model, while a simplification, is a standard and valid framework for studying selection. No flaws are identified. The problem is valid.\n\nWe now proceed with the solution.\n\nLet $p$ be the frequency of allele $A$ and $q=1-p$ be the frequency of allele $a$ in a given generation. In a large, randomly mating population, the genotypes of the zygotes will be in Hardy–Weinberg proportions:\n- Frequency of $AA$ zygotes = $p^2$\n- Frequency of $Aa$ zygotes = $2pq$\n- Frequency of $aa$ zygotes = $q^2$\n\nViability selection acts on these zygotes before they reach adulthood. The relative proportions of the genotypes that survive to reproductive age are weighted by their respective viabilities:\n- Proportion of $AA$ adults $\\propto p^2 w_{AA}$\n- Proportion of $Aa$ adults $\\propto 2pq w_{Aa}$\n- Proportion of $aa$ adults $\\propto q^2 w_{aa}$\n\nThe sum of these proportions is the mean fitness of the population, denoted by $\\bar{w}$. This serves as the normalization factor to convert these proportions into frequencies.\n$$ \\bar{w} = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa} $$\nThe frequencies of the genotypes among the surviving adults are therefore:\n- Frequency of $AA$ adults = $\\frac{p^2 w_{AA}}{\\bar{w}}$\n- Frequency of $Aa$ adults = $\\frac{2pq w_{Aa}}{\\bar{w}}$\n- Frequency of $aa$ adults = $\\frac{q^2 w_{aa}}{\\bar{w}}$\n\nThe allele frequency of $A$ in the next generation, $p'$, is the frequency of $A$ alleles in this pool of surviving adults. Each $AA$ individual carries two $A$ alleles, and each $Aa$ individual carries one. Thus, $p'$ is the frequency of $AA$ adults plus half the frequency of $Aa$ adults.\n$$ p' = \\frac{p^2 w_{AA}}{\\bar{w}} + \\frac{1}{2}\\left(\\frac{2pq w_{Aa}}{\\bar{w}}\\right) $$\n$$ p' = \\frac{p^2 w_{AA} + pq w_{Aa}}{\\bar{w}} $$\nFactoring out $p$ from the numerator gives the recurrence relation:\n$$ p' = \\frac{p(p w_{AA} + q w_{Aa})}{\\bar{w}} = \\frac{p(p w_{AA} + (1-p) w_{Aa})}{p^2 w_{AA} + 2p(1-p) w_{Aa} + (1-p)^2 w_{aa}} $$\nThis is the deterministic recurrence for the allele $A$ frequency.\n\nNext, we find the internal equilibrium frequency, $p^*$, where $0 < p^* < 1$. This is a fixed point of the recurrence, meaning $p' = p^*$. We set $p' = p$ in the equation:\n$$ p = \\frac{p(p w_{AA} + q w_{Aa})}{\\bar{w}} $$\nThis equation has trivial solutions $p=0$ and $p=1$. For the internal equilibrium, we assume $p \\neq 0$ and divide both sides by $p$:\n$$ 1 = \\frac{p w_{AA} + q w_{Aa}}{\\bar{w}} $$\n$$ \\bar{w} = p w_{AA} + q w_{Aa} $$\nThe term $p w_{AA} + q w_{Aa}$ is the marginal fitness of allele $A$, denoted $\\bar{w}_A$. The equilibrium condition is $\\bar{w} = \\bar{w}_A$. We also know that $\\bar{w} = p \\bar{w}_A + q \\bar{w}_a$, where $\\bar{w}_a = p w_{Aa} + q w_{aa}$ is the marginal fitness of allele $a$. Substituting $\\bar{w} = \\bar{w}_A$ into the definition of $\\bar{w}$ gives $p \\bar{w}_A + q \\bar{w}_a = \\bar{w}_A$, which simplifies to $q(\\bar{w}_a - \\bar{w}_A) = 0$. Since we are looking for an internal equilibrium where $q \\neq 0$, this requires $\\bar{w}_A = \\bar{w}_a$.\n$$ p w_{AA} + q w_{Aa} = p w_{Aa} + q w_{aa} $$\nSubstituting $q=1-p$:\n$$ p w_{AA} + (1-p) w_{Aa} = p w_{Aa} + (1-p) w_{aa} $$\n$$ p w_{AA} + w_{Aa} - p w_{Aa} = p w_{Aa} + w_{aa} - p w_{aa} $$\nWe gather terms containing $p$ on one side:\n$$ p(w_{AA} - w_{Aa} - w_{Aa} + w_{aa}) = w_{aa} - w_{Aa} $$\n$$ p(w_{AA} - 2w_{Aa} + w_{aa}) = w_{aa} - w_{Aa} $$\nSolving for the equilibrium frequency $p^*$:\n$$ p^* = \\frac{w_{aa} - w_{Aa}}{w_{AA} - 2w_{Aa} + w_{aa}} $$\n\nNow, we specialize to the case of underdominance (heterozygote disadvantage) with $w_{AA}=1$, $w_{Aa}=0.8$, and $w_{aa}=0.9$. We compute the numerical value of $p^*$:\n$$ p^* = \\frac{0.9 - 0.8}{1 - 2(0.8) + 0.9} = \\frac{0.1}{1 - 1.6 + 0.9} = \\frac{0.1}{0.3} = \\frac{1}{3} $$\nAs a decimal rounded to four significant figures, this is $0.3333$.\n\nFinally, we determine the stability of this equilibrium by analyzing the sign of the one-generation change in allele frequency, $\\Delta p = p' - p$.\n$$ \\Delta p = p' - p = \\frac{p(p w_{AA} + q w_{Aa})}{\\bar{w}} - p = \\frac{p(p w_{AA} + q w_{Aa}) - p\\bar{w}}{\\bar{w}} $$\n$$ \\Delta p = \\frac{p}{\\bar{w}}[(\\bar{w}_A) - (p \\bar{w}_A + q \\bar{w}_a)] = \\frac{p}{\\bar{w}}[q(\\bar{w}_A - \\bar{w}_a)] = \\frac{pq}{\\bar{w}}(\\bar{w}_A - \\bar{w}_a) $$\nThe term $\\frac{pq}{\\bar{w}}$ is positive for $p \\in (0, 1)$. Thus, the sign of $\\Delta p$ is determined by the sign of $\\bar{w}_A - \\bar{w}_a$.\nFrom our derivation of $p^*$, we found that $\\bar{w}_A - \\bar{w}_a = p(w_{AA} - 2w_{Aa} + w_{aa}) - (w_{aa} - w_{Aa})$.\nRecognizing that $p^* = \\frac{w_{aa} - w_{Aa}}{w_{AA} - 2w_{Aa} + w_{aa}}$, we can write:\n$$ \\bar{w}_A - \\bar{w}_a = (p - p^*)(w_{AA} - 2w_{Aa} + w_{aa}) $$\nSo, the change in allele frequency is:\n$$ \\Delta p = \\frac{pq}{\\bar{w}}(p - p^*)(w_{AA} - 2w_{Aa} + w_{aa}) $$\nFor our specific values, the term $(w_{AA} - 2w_{Aa} + w_{aa})$ is $1 - 2(0.8) + 0.9 = 0.3$, which is positive.\nTherefore, the sign of $\\Delta p$ is the same as the sign of $(p - p^*)$.\n- If $p > p^*$, then $p - p^* > 0$, so $\\Delta p > 0$. The allele frequency $p$ will increase, moving further away from $p^*$.\n- If $p < p^*$, then $p - p^* < 0$, so $\\Delta p < 0$. The allele frequency $p$ will decrease, moving further away from $p^*$.\nThis behavior, where allele frequencies are repelled from the equilibrium point, defines a locally unstable equilibrium.\n\nThe long-term fate of the alleles depends on the initial frequency $p_0$ relative to the unstable equilibrium $p^* = 1/3$.\n- If the initial frequency $p_0 > 1/3$, selection will continuously increase the frequency of allele $A$, leading to its fixation ($p \\to 1$).\n- If the initial frequency $p_0 < 1/3$, selection will continuously decrease the frequency of allele $A$, leading to its loss and the fixation of allele $a$ ($p \\to 0$).\n- If $p_0 = 1/3$, the population remains at the unstable equilibrium, but any perturbation would drive it to one of the fixation states.\nThus, the unstable equilibrium acts as a threshold, determining which of the two homozygous genotypes will ultimately dominate the population.",
            "answer": "$$\n\\boxed{0.3333}\n$$"
        },
        {
            "introduction": "Beyond identifying where evolution might stop, we often want to know how fast it proceeds. This final practice  addresses the dynamics of allele fixation, a key process in adaptation. You will tackle the challenge of a dominant beneficial allele sweeping to fixation, focusing on the slow final phase where the deleterious recessive allele is shielded from selection in heterozygotes. This exercise introduces powerful approximation techniques, including the transition from a discrete-time model to a continuous one, to estimate the time required for such an evolutionary transition.",
            "id": "2700639",
            "problem": "Consider a large, randomly mating, diploid population with discrete, non-overlapping generations and viability selection. A new allele $A$ is completely dominant and beneficial relative to the wild type $a$. The genotype fitnesses are $w_{AA} = 1 + s$, $w_{Aa} = 1 + s$, and $w_{aa} = 1$, where $s>0$ is the selection coefficient. Assume Hardy–Weinberg equilibrium (HWE) holds before selection in every generation, and that the dynamics are deterministic.\n\nSuppose the allele $A$ is already common so that the wild-type allele $a$ has initial frequency $q_0$ with $0<q_0 \\ll 1$ (so the initial frequency of $A$ is $p_0 = 1 - q_0$). Define the deterministic fixation threshold as the first generation $T$ at which the wild-type frequency satisfies $q_T = 1/(2N)$ for a given large census size $N$ (so that $q_T$ is effectively zero at the resolution of $2N$ gene copies).\n\nStarting only from the definitions above and fundamental population-genetic bookkeeping (genotype frequencies under HWE, viability selection, mean fitness, and allele-frequency updating), transform the dynamics to the wild-type frequency $q$, obtain the leading-order discrete-time change of $q$ near $q=0$, approximate the resulting difference equation by a continuous-time ordinary differential equation valid when $q$ remains small throughout, and integrate to obtain an explicit approximation for the number of generations $T$ required to reach $q_T = 1/(2N)$ from $q_0$.\n\nProvide your final answer as a single closed-form expression in terms of $s$, $N$, and $q_0$. Do not include any additional text with the answer. No rounding is required; give an exact analytic expression without units.",
            "solution": "The problem requires the derivation of an approximate expression for the number of generations, $T$, for the frequency of a deleterious recessive allele, $a$, to decrease from a small initial frequency $q_0$ to a fixation threshold $q_T = 1/(2N)$. The system properties are a large, diploid, randomly mating population with a dominant beneficial allele $A$. The fitnesses of genotypes $AA$, $Aa$, and $aa$ are given as $w_{AA} = 1+s$, $w_{Aa} = 1+s$, and $w_{aa} = 1$, respectively, with $s>0$.\n\nWe begin by establishing the recurrence relation for the frequency of allele $a$, denoted by $q$. In generation $t$, let the frequency of allele $a$ be $q_t$, and the frequency of allele $A$ be $p_t = 1-q_t$. Assuming the population is in Hardy-Weinberg equilibrium before selection, the frequencies of the genotypes $AA$, $Aa$, and $aa$ are $p_t^2$, $2p_t q_t$, and $q_t^2$.\n\nThe mean fitness of the population, $\\bar{w}_t$, is the weighted average of the genotype fitnesses, which serves as a normalization constant for the genotype frequencies after selection.\n$$ \\bar{w}_t = w_{AA} p_t^2 + w_{Aa} (2p_t q_t) + w_{aa} q_t^2 $$\nSubstituting the given fitness values and $p_t = 1-q_t$:\n$$ \\bar{w}_t = (1+s)(1-q_t)^2 + (1+s)2(1-q_t)q_t + (1)q_t^2 $$\nFactoring out the term $(1+s)$:\n$$ \\bar{w}_t = (1+s) \\left[ (1-q_t)^2 + 2(1-q_t)q_t \\right] + q_t^2 $$\nThe term in the brackets simplifies: $(1-q_t) \\left( (1-q_t) + 2q_t \\right) = (1-q_t)(1+q_t) = 1-q_t^2$.\nThus, the mean fitness is:\n$$ \\bar{w}_t = (1+s)(1-q_t^2) + q_t^2 = 1+s - (1+s)q_t^2 + q_t^2 = 1+s - sq_t^2 $$\nThe frequency of allele $a$ in the next generation, $q_{t+1}$, is derived from the frequencies of genotypes carrying the $a$ allele after selection, normalized by the mean fitness. The $aa$ genotype contributes its full frequency to the $a$ allele pool, while the $Aa$ genotype contributes one-half of its frequency.\n$$ q_{t+1} = \\frac{w_{aa} q_t^2 + w_{Aa} (\\frac{1}{2} \\cdot 2p_t q_t)}{\\bar{w}_t} = \\frac{(1)q_t^2 + (1+s)(1-q_t)q_t}{1+s - sq_t^2} $$\nThe numerator simplifies to:\n$$ q_t^2 + (1+s)(q_t - q_t^2) = q_t^2 + q_t + sq_t - q_t^2 - sq_t^2 = q_t(1+s - sq_t) $$\nThis yields the exact discrete-time recurrence relation for $q_t$:\n$$ q_{t+1} = \\frac{q_t(1+s - sq_t)}{1+s - sq_t^2} $$\nThe change in allele frequency in one generation is $\\Delta q_t = q_{t+1} - q_t$:\n$$ \\Delta q_t = \\frac{q_t(1+s - sq_t)}{1+s - sq_t^2} - q_t = q_t \\left( \\frac{1+s-sq_t - (1+s-sq_t^2)}{1+s - sq_t^2} \\right) $$\n$$ \\Delta q_t = q_t \\left( \\frac{-sq_t + sq_t^2}{1+s - sq_t^2} \\right) = \\frac{-sq_t^2(1-q_t)}{1+s - sq_t^2} $$\nThe problem states that allele $a$ is rare ($q_t \\ll 1$). This allows for a leading-order approximation. For small $q_t$, we have $(1-q_t) \\approx 1$ and the denominator $1+s - sq_t^2 \\approx 1+s$.\n$$ \\Delta q_t \\approx \\frac{-sq_t^2}{1+s} $$\nGiven that the change per generation is small, we can approximate this discrete difference equation by a continuous-time ordinary differential equation (ODE), setting $\\Delta q_t \\approx \\frac{dq}{dt}$ for a time step of $\\Delta t=1$ generation.\n$$ \\frac{dq}{dt} = -\\frac{s}{1+s} q^2 $$\nThis is a separable differential equation. We rearrange the terms to integrate from the initial condition ($t=0$, $q=q_0$) to the final condition ($t=T$, $q=q_T$).\n$$ \\frac{dq}{q^2} = -\\left(\\frac{s}{1+s}\\right) dt $$\nIntegrating both sides over the specified limits:\n$$ \\int_{q_0}^{q_T} q^{-2} dq = -\\int_{0}^{T} \\frac{s}{1+s} dt $$\nThe integral on the left evaluates to:\n$$ \\left[ -\\frac{1}{q} \\right]_{q_0}^{q_T} = -\\frac{1}{q_T} - \\left(-\\frac{1}{q_0}\\right) = \\frac{1}{q_0} - \\frac{1}{q_T} $$\nThe integral on the right evaluates to:\n$$ -\\frac{s}{1+s} [t]_{0}^{T} = -\\frac{s}{1+s} T $$\nEquating the two results gives the relation:\n$$ \\frac{1}{q_0} - \\frac{1}{q_T} = -\\frac{s}{1+s} T $$\nSolving for the number of generations, $T$:\n$$ T = -\\frac{1+s}{s} \\left( \\frac{1}{q_0} - \\frac{1}{q_T} \\right) = \\frac{1+s}{s} \\left( \\frac{1}{q_T} - \\frac{1}{q_0} \\right) $$\nFinally, we substitute the definition of the fixation threshold, $q_T = \\frac{1}{2N}$, into the expression for $T$.\n$$ T = \\frac{1+s}{s} \\left( \\frac{1}{1/(2N)} - \\frac{1}{q_0} \\right) $$\nThis simplifies to the final closed-form expression:\n$$ T = \\frac{1+s}{s} \\left( 2N - \\frac{1}{q_0} \\right) $$\nThis result is predicated on the condition that $q$ remains small throughout the process, which is justified by the initial condition $q_0 \\ll 1$ and the fact that selection against a recessive allele is inefficient at low frequencies.",
            "answer": "$$\n\\boxed{\\frac{1+s}{s} \\left( 2N - \\frac{1}{q_0} \\right)}\n$$"
        }
    ]
}