{
    "hands_on_practices": [
        {
            "introduction": "在数据分析中，将不同分组的数据合并汇总是一种常见操作，但这有时会掩盖甚至颠倒真实的趋势。辛普森悖论正是这样一个关键的统计陷阱，即在分组数据中表现出的一种趋势，在数据汇总后却呈现出相反的结论。本练习  构建了一个真实的合成生物学场景，展示了在单细胞分析中，细胞周期阶段如何成为一个混杂变量，从而导致悖论的出现，这强调了在解释数据时审慎考虑条件概率的重要性。",
            "id": "3907106",
            "problem": "在一项合成生物学实验中，一个高通量单细胞分析评估了一个驱动绿色荧光蛋白（GFP）报告基因的转录激活回路。细胞被分为两个队列：一个将表观遗传激活剂招募到启动子的扰动（处理组），以及一个仅含启动子的构建体（对照组）。由于细胞周期阶段调节染色质可及性，数据也根据S期（$S$）和G1期（$\\mathrm{G1}$）进行分层，这是通过DNA含量染色确定的。如果一个细胞的GFP超过预设阈值，则被计为报告基因阳性。\n\n获得了以下计数：\n- $S$期：\n  - 处理组：$700$个细胞总数，$196$个报告基因阳性。\n  - 对照组：$300$个细胞总数，$90$个报告基因阳性。\n- $\\mathrm{G1}$期：\n  - 处理组：$300$个细胞总数，$27$个报告基因阳性。\n  - 对照组：$700$个细胞总数，$70$个报告基因阳性。\n\n假设每个细胞都是从其对应的队列-阶段亚群中进行的独立同分布抽样。根据条件概率的基本定义和应用于这些数据的全概率定律，判断下列哪些陈述是正确的。\n\nA. 在$S$期和$\\mathrm{G1}$期中，处理组的报告基因激活概率均低于对照组。\n\nB. 在汇总$S$期和$\\mathrm{G1}$期（忽略阶段）后，处理组的报告基因激活概率高于对照组。\n\nC. 阶段内比较与汇总比较之间的逆转是辛普森悖论的一个实例。\n\nD. 如果处理组和对照组具有相同的阶段分布（即，在$S$期和$\\mathrm{G1}$期中的比例相同），那么汇总比较将与阶段内比较保持一致。\n\nE. 这种悖论性的逆转发生是因为全概率定律在这些数据中被违反了。",
            "solution": "我们从条件概率的定义开始。对于任何事件$A$和条件事件$B$（其中$P(B)  0$），条件概率为 $P(A \\mid B) = \\dfrac{P(A \\cap B)}{P(B)}$。当我们有一个样本空间划分为互斥事件 $\\{B_i\\}$，且 $\\sum_i P(B_i) = 1$ 时，全概率定律指出，对于任何事件 $A$，有 $P(A) = \\sum_i P(A \\mid B_i) P(B_i)$。\n\n我们将经验频率解释为在每个队列-阶段层内细胞独立同分布假设下的概率估计。因此，特定阶段的激活概率由每个层内报告基因阳性计数除以总数得出。\n\n计算特定阶段的激活概率：\n\n- 在$S$期：\n  - 处理组：$P(\\text{On} \\mid \\text{Trt}, S) \\approx \\dfrac{196}{700} = 0.28$。\n  - 对照组：$P(\\text{On} \\mid \\text{Ctl}, S) \\approx \\dfrac{90}{300} = 0.30$。\n  因此，在$S$期，处理组的激活概率低于对照组。\n\n- 在$\\mathrm{G1}$期：\n  - 处理组：$P(\\text{On} \\mid \\text{Trt}, \\mathrm{G1}) \\approx \\dfrac{27}{300} = 0.09$。\n  - 对照组：$P(\\text{On} \\mid \\text{Ctl}, \\mathrm{G1}) \\approx \\dfrac{70}{700} = 0.10$。\n  因此，在$\\mathrm{G1}$期，处理组的激活概率也低于对照组。\n\n现在通过忽略阶段来计算汇总的激活概率。这使用了全概率定律，权重等于每个队列内的阶段比例。\n\n对于处理组：\n- 处理组细胞总数：$700 + 300 = 1000$。\n- 处理组阳性总数：$196 + 27 = 223$。\n- 汇总的 $P(\\text{On} \\mid \\text{Trt}) \\approx \\dfrac{223}{1000} = 0.223$。\n\n对于对照组：\n- 对照组细胞总数：$300 + 700 = 1000$。\n- 对照组阳性总数：$90 + 70 = 160$。\n- 汇总的 $P(\\text{On} \\mid \\text{Ctl}) \\approx \\dfrac{160}{1000} = 0.160$。\n\n因此，在按阶段汇总后，处理组表现出比对照组更高的激活概率，尽管在每个阶段内其概率都更低。这是辛普森悖论的标志：一个在几个组中出现的趋势，在数据合并时发生逆转，这是由不同的组比例驱动的。\n\n我们还分析了处理组和对照组共享相同阶段分布的反事实情况。设 $w_S$ 表示在$S$期中的共同比例，而 $w_{\\mathrm{G1}} = 1 - w_S$ 表示在$\\mathrm{G1}$期中的比例。那么汇总的差异将是\n$$\n\\Delta = \\bigl[w_S \\, P(\\text{On} \\mid \\text{Trt}, S) + w_{\\mathrm{G1}} \\, P(\\text{On} \\mid \\text{Trt}, \\mathrm{G1})\\bigr] - \\bigl[w_S \\, P(\\text{On} \\mid \\text{Ctl}, S) + w_{\\mathrm{G1}} \\, P(\\text{On} \\mid \\text{Ctl}, \\mathrm{G1})\\bigr].\n$$\n重新整理后，\n$$\n\\Delta = w_S \\bigl[P(\\text{On} \\mid \\text{Trt}, S) - P(\\text{On} \\mid \\text{Ctl}, S)\\bigr] + w_{\\mathrm{G1}} \\bigl[P(\\text{On} \\mid \\text{Trt}, \\mathrm{G1}) - P(\\text{On} \\mid \\text{Ctl}, \\mathrm{G1})\\bigr].\n$$\n在这里，$P(\\text{On} \\mid \\text{Trt}, S) - P(\\text{On} \\mid \\text{Ctl}, S) = 0.28 - 0.30 = -0.02$ 且 $P(\\text{On} \\mid \\text{Trt}, \\mathrm{G1}) - P(\\text{On} \\mid \\text{Ctl}, \\mathrm{G1}) = 0.09 - 0.10 = -0.01$，均为负数。由于 $w_S \\in [0,1]$ 且 $w_{\\mathrm{G1}} \\in [0,1]$，$\\Delta$ 是负数的凸组合，因此必须为负。因此，如果队列间的阶段分布相等，汇总比较将与阶段内比较一致，显示处理组低于对照组。\n\n最后，全概率定律没有被违反。上述汇总概率正是通过将特定阶段的概率按特定队列的阶段比例加权求和来计算的。逆转的出现是因为队列具有不同的阶段分布（处理组在激活率较高的$S$期中占比过高），而不是因为任何概率定律被打破。\n\n逐项分析：\n\n- 选项A：正确。我们计算出 $P(\\text{On} \\mid \\text{Trt}, S) = 0.28  0.30 = P(\\text{On} \\mid \\text{Ctl}, S)$ 和 $P(\\text{On} \\mid \\text{Trt}, \\mathrm{G1}) = 0.09  0.10 = P(\\text{On} \\mid \\text{Ctl}, \\mathrm{G1})$。\n\n- 选项B：正确。汇总后，$P(\\text{On} \\mid \\text{Trt}) = 0.223  0.160 = P(\\text{On} \\mid \\text{Ctl})$。\n\n- 选项C：正确。处理组在阶段内的劣势在数据汇总后逆转为表面上的优势，这就是辛普森悖论。\n\n- 选项D：正确。在阶段分布匹配的情况下，汇总差异是阶段内负差异的加权平均，因此仍然为负。\n\n- 选项E：错误。全概率定律成立；悖论源于不同阶段的混合比例不同，而非任何概率定律的违反。",
            "answer": "$$\\boxed{ABCD}$$"
        },
        {
            "introduction": "上一个练习揭示了混杂变量如何扭曲我们的结论，而这种现象背后是深刻的概率论原理。本练习  进一步形式化了这一概念，探讨了两个原本独立的随机变量如何在对第三个变量（称为“对撞因子”）进行条件化后变得相关。理解这种“对撞偏倚”对于分析实验数据至关重要，尤其是在流式细胞分选（FACS）等涉及数据筛选的技术中，它加深了我们对边缘独立性与条件独立性之间微妙差异的认识。",
            "id": "3907128",
            "problem": "在合成生物学建模中，荧光激活细胞分选术（FACS）被用来根据荧光读数筛选细胞。考虑两个报告基因强度，建模为随机变量 $X$ 和 $Y$，它们代表筛选前独立的通路活性。一个门控变量 $Z$ 编码了 FACS 所应用的筛选规则。独立性意味着对于所有可测集 $A$ 和 $B$，$\\mathbb{P}(X\\in A, Y\\in B)=\\mathbb{P}(X\\in A)\\mathbb{P}(Y\\in B)$，而给定 $Z$ 的条件独立性意味着对于所有可测集 $A$ 和 $B$ 以及值 $z$，$\\mathbb{P}(X\\in A, Y\\in B \\mid Z=z)=\\mathbb{P}(X\\in A \\mid Z=z)\\mathbb{P}(Y\\in B \\mid Z=z)$。\n\n选择所有构建了一个科学上合理的 FACS 筛选场景的选项，在这些场景中，$X\\perp Y$ 在整个群体中成立，但在至少一个 $Z$ 的选定分层中 $X\\not\\perp Y\\mid Z$。\n\nA. $X$ 和 $Y$ 是参数为 $p\\in(0,1)$ 的独立伯努利随机变量，模拟了两个独立的报告基因阳性事件。门控选择任何至少一个报告基因为阳性的细胞：$Z=\\mathbb{I}\\{X+Y\\ge 1\\}$。\n\nB. $X$ 和 $Y$ 是参数为 $p\\in(0,1)$ 的独立伯努利随机变量。门控仅根据报告基因 $X$ 来选择细胞：$Z=\\mathbb{I}\\{X=1\\}$。\n\nC. $X\\sim\\mathcal{N}(0,1)$ 和 $Y\\sim\\mathcal{N}(0,1)$ 是独立的标准正态随机变量，代表经过适当归一化后的两个独立荧光通道。门控选择总荧光强度高于阈值 $c\\in\\mathbb{R}$ 的细胞：$Z=\\mathbb{I}\\{X+Yc\\}$。\n\nD. $X\\sim\\mathcal{N}(0,1)$ 和 $Y\\sim\\mathcal{N}(0,1)$ 是如上所述的独立标准正态随机变量。$Z$ 是一次独立的抛硬币结果，$Z\\sim\\text{Bernoulli}(q)$，其中 $q\\in(0,1)$，代表一个不相关的元数据标志。\n\nE. $X\\sim\\text{Poisson}(\\lambda_1)$ 和 $Y\\sim\\text{Poisson}(\\lambda_2)$ 是独立的计数值，代表两种基因产物的分子拷贝数。门控记录总计数 $Z=X+Y$，并且分析被限制在某个 $s\\in\\mathbb{N}$ 的固定层 $Z=s$ 上。",
            "solution": "我们从核心的概率定义开始。$X$ 和 $Y$ 的独立性意味着对于所有可测集 $A$ 和 $B$，$\\mathbb{P}(X\\in A, Y\\in B)=\\mathbb{P}(X\\in A)\\mathbb{P}(Y\\in B)$。给定 $Z=z$ 时 $X$ 和 $Y$ 的条件独立性意味着对于所有可测集 $A$ 和 $B$，$\\mathbb{P}(X\\in A, Y\\in B \\mid Z=z)=\\mathbb{P}(X\\in A \\mid Z=z)\\mathbb{P}(Y\\in B \\mid Z=z)$。我们将使用条件概率的定义 $\\mathbb{P}(A\\mid B)=\\frac{\\mathbb{P}(A\\cap B)}{\\mathbb{P}(B)}$（当 $\\mathbb{P}(B)0$ 时），并在适当的时候使用全概率公式。\n\n选项 A 分析：\n- 无条件独立性：根据构造，$X$ 和 $Y$ 是参数为 $p\\in(0,1)$ 的独立伯努利随机变量，因此对于任何 $x,y\\in\\{0,1\\}$，$\\mathbb{P}(X=x, Y=y)=\\mathbb{P}(X=x)\\mathbb{P}(Y=y)$；因此 $X\\perp Y$。\n- 给定 $Z=1$ 时的条件依赖性：这里 $Z=\\mathbb{I}\\{X+Y\\ge 1\\}$。我们计算 $\\mathbb{P}(Y=1\\mid Z=1)$ 和 $\\mathbb{P}(Y=1\\mid X=1, Z=1)$ 并证明它们不相等。首先，\n$$\n\\mathbb{P}(Z=1)=1-\\mathbb{P}(X=0, Y=0)=1-(1-p)^2=2p-p^2.\n$$\n并且 $\\mathbb{P}(Y=1, Z=1)=\\mathbb{P}(Y=1)=p$，因为 $Y=1$ 意味着 $Z=1$。因此\n$$\n\\mathbb{P}(Y=1\\mid Z=1)=\\frac{\\mathbb{P}(Y=1, Z=1)}{\\mathbb{P}(Z=1)}=\\frac{p}{2p-p^2}=\\frac{1}{2-p}.\n$$\n接下来，以 $X=1$ 为条件使得 $Z=1$ 成为必然事件，并且根据无条件独立性，$\\mathbb{P}(Y=1\\mid X=1)=p$。因此\n$$\n\\mathbb{P}(Y=1\\mid X=1, Z=1)=p\\neq \\frac{1}{2-p}\n$$\n对于所有 $p\\in(0,1)$。因为在给定 $Z=1$ 的条件下，$Y$ 的条件分布在进一步以 $X=1$ 为条件时发生了变化，所以条件独立性所需的因子分解不成立，因此 $X\\not\\perp Y\\mid Z$。结论：正确。\n\n选项 B 分析：\n- 无条件独立性：与选项 A 中一样，$X$ 和 $Y$ 是参数为 $p$ 的独立伯努利随机变量，因此 $X\\perp Y$。\n- 条件独立性：这里 $Z=\\mathbb{I}\\{X=1\\}$，所以 $Z=X$ 是确定性的。对于任何可测集 $A\\subseteq\\{0,1\\}$ 和 $B\\subseteq\\{0,1\\}$，以及对于 $z\\in\\{0,1\\}$，\n$$\n\\mathbb{P}(X\\in A, Y\\in B \\mid Z=z)=\\mathbb{P}(X\\in A, Y\\in B \\mid X=z).\n$$\n由于 $Y\\perp X$，$\\mathbb{P}(Y\\in B \\mid X=z)=\\mathbb{P}(Y\\in B)$，并且给定 $Z=z$ 的 $X$ 在 $x=z$ 处是退化的。因此\n$$\n\\mathbb{P}(X\\in A, Y\\in B \\mid Z=z)=\\mathbb{P}(X\\in A \\mid Z=z)\\mathbb{P}(Y\\in B \\mid Z=z),\n$$\n其中如果 $z\\in A$ 则 $\\mathbb{P}(X\\in A \\mid Z=z)$ 等于 $1$，否则为 $0$，且 $\\mathbb{P}(Y\\in B \\mid Z=z)=\\mathbb{P}(Y\\in B)$。因此所需的因子分解成立，所以 $X\\perp Y\\mid Z$。结论：不正确。\n\n选项 C 分析：\n- 无条件独立性：根据构造，$X$ 和 $Y$ 是独立的标准正态随机变量，因此 $X\\perp Y$。\n- 对于门控层 $Z=1$ 的条件依赖性：门控 $Z=\\mathbb{I}\\{X+Yc\\}$ 编码了对总和的选择。我们通过证明对于一个可测事件 $B=\\{Yt\\}$，$\\mathbb{P}(Yt\\mid X=x, Z=1)$ 依赖于 $x$ 来展示非独立性。对于固定的 $x\\in\\mathbb{R}$，\n$$\n\\{Z=1\\}=\\{X+Yc\\}=\\{Yc-x\\}.\n$$\n因此，根据条件概率，\n$$\n\\mathbb{P}(Yt \\mid X=x, Z=1)=\\frac{\\mathbb{P}(Yt, Yc-x \\mid X=x)}{\\mathbb{P}(Yc-x \\mid X=x)}.\n$$\n利用无条件独立性，$Y$ 的分布不依赖于 $X$，所以\n$$\n\\mathbb{P}(Yt \\mid X=x, Z=1)=\\frac{\\mathbb{P}(Y\\max\\{t, c-x\\})}{\\mathbb{P}(Yc-x)}.\n$$\n当 $Y\\sim \\mathcal{N}(0,1)$ 时，将生存函数写作 $\\bar{\\Phi}(u)=\\mathbb{P}(Yu)$，\n$$\n\\mathbb{P}(Yt \\mid X=x, Z=1)=\\frac{\\bar{\\Phi}(\\max\\{t, c-x\\})}{\\bar{\\Phi}(c-x)}.\n$$\n对于任何固定的 $t$，右侧是 $x$ 的一个非常数函数（例如，选择 $t=c$，这样当 $x\\ge 0$ 时 $\\max\\{t,c-x\\}=c$，当 $x0$ 时等于 $c-x$）。因为 $\\mathbb{P}(Yt \\mid X=x, Z=1)$ 依赖于 $x$，对于适当的 $A$ 和 $B$，因子分解 $\\mathbb{P}(X\\in A, Y\\in B \\mid Z=1)=\\mathbb{P}(X\\in A\\mid Z=1)\\mathbb{P}(Y\\in B\\mid Z=1)$ 不成立，因此 $X\\not\\perp Y\\mid Z$。直观上，以 $X+Yc$ 为条件会引入一个负相关：较大的 $X$ 需要较小的 $Y$ 的贡献才能超过阈值。结论：正确。\n\n选项 D 分析：\n- 无条件独立性：$X$ 和 $Y$ 是独立的标准正态随机变量，因此 $X\\perp Y$。\n- 条件独立性：$Z$ 与 $(X,Y)$ 独立，因此对于任何可测集 $A, B$ 和任何满足 $\\mathbb{P}(Z=z)0$ 的 $z$，\n$$\n\\mathbb{P}(X\\in A, Y\\in B \\mid Z=z)=\\frac{\\mathbb{P}(X\\in A, Y\\in B, Z=z)}{\\mathbb{P}(Z=z)}=\\frac{\\mathbb{P}(X\\in A, Y\\in B)\\,\\mathbb{P}(Z=z)}{\\mathbb{P}(Z=z)}=\\mathbb{P}(X\\in A, Y\\in B).\n$$\n类似地，\n$$\n\\mathbb{P}(X\\in A \\mid Z=z)=\\mathbb{P}(X\\in A),\\quad \\mathbb{P}(Y\\in B \\mid Z=z)=\\mathbb{P}(Y\\in B).\n$$\n因此，\n$$\n\\mathbb{P}(X\\in A, Y\\in B \\mid Z=z)=\\mathbb{P}(X\\in A)\\mathbb{P}(Y\\in B)=\\mathbb{P}(X\\in A \\mid Z=z)\\mathbb{P}(Y\\in B \\mid Z=z),\n$$\n所以 $X\\perp Y\\mid Z$。结论：不正确。\n\n选项 E 分析：\n- 无条件独立性：$X$ 和 $Y$ 是参数为 $\\lambda_10$ 和 $\\lambda_20$ 的独立泊松随机变量，所以 $X\\perp Y$。\n- 给定固定总和 $Z=s$ 时的条件依赖性：门控记录 $Z=X+Y$，并且分析集中在层 $Z=s$ 上。使用独立泊松随机变量的加法性质，$Z\\sim \\text{Poisson}(\\lambda_1+\\lambda_2)$。给定 $Z=s$ 时 $X$ 的条件分布是二项分布，\n$$\n\\mathbb{P}(X=x \\mid Z=s)=\\binom{s}{x}\\left(\\frac{\\lambda_1}{\\lambda_1+\\lambda_2}\\right)^x\\left(\\frac{\\lambda_2}{\\lambda_1+\\lambda_2}\\right)^{s-x},\\quad x\\in\\{0,1,\\dots,s\\},\n$$\n并且给定 $Z=s$ 时，$Y$ 被确定为 $Y=s-X$。因此，\n$$\n\\operatorname{Cov}(X,Y \\mid Z=s)=\\operatorname{Cov}(X, s-X \\mid Z=s)=\\operatorname{Cov}(X,s\\mid Z=s)-\\operatorname{Var}(X\\mid Z=s)=-\\operatorname{Var}(X\\mid Z=s)0,\n$$\n因为对于 $\\lambda_1,\\lambda_20$ 和 $s\\ge 1$，$\\operatorname{Var}(X\\mid Z=s)=s\\frac{\\lambda_1}{\\lambda_1+\\lambda_2}\\left(1-\\frac{\\lambda_1}{\\lambda_1+\\lambda_2}\\right)0$。在条件作用下的非零协方差意味着条件独立性的不成立。等价地，联合条件分布集中在直线 $x+y=s$ 上，这违反了任何乘积因子分解。因此 $X\\not\\perp Y\\mid Z$。结论：正确。\n\n总而言之，选项 A、C 和 E 通过在 FACS 细胞分选中有科学可信度的碰撞子或固定总和门控上进行选择，满足了 $X\\perp Y$ 但 $X\\not\\perp Y\\mid Z$。选项 B 和 D 不会引起条件依赖性，因为仅对 $X$ 进行门控或对一个独立的元数据标志进行门控会保持 $X\\perp Y\\mid Z$。",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "在掌握了条件概率的复杂性之后，我们转向一个能够严谨分析概率分布的强大数学工具。特征函数可被视为一个概率分布的“指纹”，它不仅唯一地确定了分布，还能便捷地计算其各阶矩。本练习  将通过从第一性原理出发，推导高斯分布的特征函数，并利用它反推出分布的均值和方差，让您亲身体验这一工具的威力。高斯分布是描述实验测量噪声最常用的模型之一。",
            "id": "3907107",
            "problem": "在一个监测合成基因线路中荧光报告分子的微流控恒化器实验中，由于相机读出和高计数率下的光子统计，测量信号受到了加性测量噪声的干扰。一个常见的建模假设是，这种测量噪声可以由一个高斯随机变量 $X$ 来表示，其均值为 $\\mu$（仪器偏移），方差为 $\\sigma^{2}$（总体波动水平），且该噪声独立于潜在的生物过程。设 $X$ 的概率密度函数由高斯密度 $f_{X}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\big(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\big)$ 给出，特征函数定义为 $\\varphi_{X}(t) = \\mathbb{E}[\\exp(i t X)] = \\int_{-\\infty}^{\\infty} \\exp(i t x) f_{X}(x)\\,dx$。\n\n仅使用特征函数和高斯密度的定义，通过从第一性原理出发计算定义积分，求出 $\\varphi_{X}(t)$ 的闭式解。然后，利用 $\\varphi_{X}(t)$ 在 $t=0$ 处的导数与原始矩 $\\mathbb{E}[X^{n}]$ 之间的关系，推导出 $\\mathbb{E}[X]$ 和 $\\operatorname{Var}(X)$，过程中不使用任何预先记下的高斯分布矩公式。\n\n将 $\\varphi_{X}(t)$ 的闭式表达式作为你的最终答案。无需进行数值近似或舍入；用 $\\mu$、$\\sigma$ 和 $t$ 的符号表示最终结果。",
            "solution": "该问题陈述提法恰当、内容自洽，并且在标准概率论中有坚实的科学基础。它展示了高斯分布特征函数的经典推导过程，以及如何使用它来计算矩。我们按照要求从第一性原理出发进行求解。\n\n问题定义了一个均值为 $\\mu$、方差为 $\\sigma^2$ 的高斯随机变量 $X$。其概率密度函数（PDF）如下：\n$$f_{X}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right)$$\n特征函数 $\\varphi_{X}(t)$ 定义为 $\\exp(itX)$ 的期望值：\n$$\\varphi_{X}(t) = \\mathbb{E}[\\exp(itX)] = \\int_{-\\infty}^{\\infty} \\exp(itx) f_{X}(x)\\,dx$$\n\n为了计算 $\\varphi_{X}(t)$，我们将概率密度函数代入积分定义中：\n$$\\varphi_{X}(t) = \\int_{-\\infty}^{\\infty} \\exp(itx) \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right) dx$$\n我们可以合并指数项，并将常数因子移到积分符号外：\n$$\\varphi_{X}(t) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\int_{-\\infty}^{\\infty} \\exp\\left(itx - \\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right) dx$$\n推导的核心是将指数的参数变换成一个新高斯分布的形式，从而可以对积分进行求值。我们关注指数部分，称之为 $A(x)$：\n$$A(x) = itx - \\frac{(x-\\mu)^{2}}{2\\sigma^{2}}$$\n展开平方项：\n$$A(x) = itx - \\frac{x^2 - 2\\mu x + \\mu^2}{2\\sigma^2} = -\\frac{1}{2\\sigma^2} \\left[ x^2 - 2\\mu x + \\mu^2 - 2i\\sigma^2tx \\right]$$\n我们将包含 $x$ 的项分组并进行配方。含 $x$ 的项为 $x^2 - 2\\mu x - 2i\\sigma^2tx = x^2 - 2x(\\mu + i\\sigma^2t)$。\n对于表达式 $x^2 - 2bx$ 进行配方，我们将其写成 $(x-b)^2 - b^2$。这里，$b = \\mu + i\\sigma^2t$。\n所以，$x^2 - 2x(\\mu + i\\sigma^2t) = \\left(x - (\\mu + i\\sigma^2t)\\right)^2 - (\\mu + i\\sigma^2t)^2$。\n将此代回 $A(x)$ 的表达式中：\n$$A(x) = -\\frac{1}{2\\sigma^2} \\left[ \\left(x - (\\mu + i\\sigma^2t)\\right)^2 - (\\mu + i\\sigma^2t)^2 + \\mu^2 \\right]$$\n$$A(x) = -\\frac{\\left(x - (\\mu + i\\sigma^2t)\\right)^2}{2\\sigma^2} + \\frac{(\\mu + i\\sigma^2t)^2 - \\mu^2}{2\\sigma^2}$$\n现在我们简化不含 $x$ 的项：\n$$\\frac{(\\mu + i\\sigma^2t)^2 - \\mu^2}{2\\sigma^2} = \\frac{\\mu^2 + 2i\\mu\\sigma^2t + (i\\sigma^2t)^2 - \\mu^2}{2\\sigma^2} = \\frac{2i\\mu\\sigma^2t - \\sigma^4t^2}{2\\sigma^2} = i\\mu t - \\frac{\\sigma^2t^2}{2}$$\n因此，指数 $A(x)$ 变为：\n$$A(x) = -\\frac{\\left(x - (\\mu + i\\sigma^2t)\\right)^2}{2\\sigma^2} + i\\mu t - \\frac{\\sigma^2t^2}{2}$$\n我们将其代回 $\\varphi_X(t)$ 的积分中：\n$$\\varphi_{X}(t) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\left(x - (\\mu + i\\sigma^2t)\\right)^2}{2\\sigma^2} + i\\mu t - \\frac{\\sigma^2t^2}{2}\\right) dx$$\n项 $\\exp\\left(i\\mu t - \\frac{\\sigma^2t^2}{2}\\right)$ 相对于 $x$ 是常数，可以被提出来：\n$$\\varphi_{X}(t) = \\exp\\left(i\\mu t - \\frac{\\sigma^2t^2}{2}\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{\\left(x - (\\mu + i\\sigma^2t)\\right)^2}{2\\sigma^2}\\right) dx$$\n该积分是均值为 $\\mu' = \\mu + i\\sigma^2t$、标准差为 $\\sigma$ 的高斯概率密度函数下的总面积。任何概率密度函数在其整个定义域上的积分都为 $1$。尽管均值 $\\mu'$ 是复数，但通过复平面上的围道积分可以证明该结果仍然成立，即该积分的值为 $1$。\n因此，高斯分布的特征函数为：\n$$\\varphi_{X}(t) = \\exp\\left(i\\mu t - \\frac{\\sigma^2t^2}{2}\\right)$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们使用性质 $\\mathbb{E}[X^n] = i^{-n} \\frac{d^n \\varphi_X(t)}{dt^n}\\bigg|_{t=0}$ 从 $\\varphi_{X}(t)$ 推导矩。\n\n为了求均值 $\\mathbb{E}[X]$（一阶原始矩，$n=1$）：\n$$\\mathbb{E}[X] = i^{-1} \\frac{d\\varphi_X(t)}{dt}\\bigg|_{t=0}$$\n首先，我们计算 $\\varphi_X(t)$ 对 $t$ 的导数：\n$$\\frac{d\\varphi_X(t)}{dt} = \\frac{d}{dt} \\exp\\left(i\\mu t - \\frac{\\sigma^2t^2}{2}\\right) = \\exp\\left(i\\mu t - \\frac{\\sigma^2t^2}{2}\\right) \\cdot \\left(i\\mu - \\sigma^2t\\right)$$\n在 $t=0$ 处求值：\n$$\\frac{d\\varphi_X(t)}{dt}\\bigg|_{t=0} = \\exp(0) \\cdot (i\\mu - 0) = i\\mu$$\n因此，均值为：\n$$\\mathbb{E}[X] = \\frac{1}{i}(i\\mu) = \\mu$$\n这验证了该分布的均值。\n\n为了求方差 $\\operatorname{Var}(X)$，我们首先需要二阶原始矩 $\\mathbb{E}[X^2]$（$n=2$）：\n$$\\mathbb{E}[X^2] = i^{-2} \\frac{d^2\\varphi_X(t)}{dt^2}\\bigg|_{t=0} = -\\frac{d^2\\varphi_X(t)}{dt^2}\\bigg|_{t=0}$$\n我们使用乘法法则对一阶导数求导，以计算二阶导数：\n$$\\frac{d^2\\varphi_X(t)}{dt^2} = \\frac{d}{dt} \\left[ \\exp\\left(i\\mu t - \\frac{\\sigma^2t^2}{2}\\right) (i\\mu - \\sigma^2t) \\right]$$\n$$= \\left[\\frac{d}{dt}\\exp(\\dots)\\right](i\\mu - \\sigma^2t) + \\exp(\\dots)\\left[\\frac{d}{dt}(i\\mu - \\sigma^2t)\\right]$$\n$$= \\left[\\exp(\\dots)(i\\mu - \\sigma^2t)\\right](i\\mu - \\sigma^2t) + \\exp(\\dots)(-\\sigma^2)$$\n$$= \\exp\\left(i\\mu t - \\frac{\\sigma^2t^2}{2}\\right) \\left[ (i\\mu - \\sigma^2t)^2 - \\sigma^2 \\right]$$\n在 $t=0$ 处求值：\n$$\\frac{d^2\\varphi_X(t)}{dt^2}\\bigg|_{t=0} = \\exp(0) \\left[ (i\\mu - 0)^2 - \\sigma^2 \\right] = (i\\mu)^2 - \\sigma^2 = -\\mu^2 - \\sigma^2$$\n所以，二阶矩为：\n$$\\mathbb{E}[X^2] = -(-\\mu^2 - \\sigma^2) = \\mu^2 + \\sigma^2$$\n最后，方差计算为 $\\operatorname{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2$：\n$$\\operatorname{Var}(X) = (\\mu^2 + \\sigma^2) - (\\mu)^2 = \\sigma^2$$\n这验证了该分布的方差。从特征函数得到的推导结果与给定参数一致。要求的最终答案是 $\\varphi_{X}(t)$ 的闭式表达式。",
            "answer": "$$\\boxed{\\exp\\left(i \\mu t - \\frac{\\sigma^{2}t^{2}}{2}\\right)}$$"
        }
    ]
}