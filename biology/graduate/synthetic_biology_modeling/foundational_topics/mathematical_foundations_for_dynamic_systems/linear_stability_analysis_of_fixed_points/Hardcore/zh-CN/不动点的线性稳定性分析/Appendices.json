{
    "hands_on_practices": [
        {
            "introduction": "掌握线性稳定性分析的第一步，是熟练计算给定不动点的雅可比矩阵及其特征值。本练习  将通过一个三维基因开关模型（合成生物学中的一个常见模块）来提供这些核心技能的直接实践。通过手动计算偏导数和求解特征值问题，你将具体地理解系统的局部动态行为是如何被其雅可比矩阵的结构所决定的。",
            "id": "3916940",
            "problem": "一个合成基因触发开关包含两个转录抑制子，以及代表不反馈于基因的细胞外信号的第三种分子。考虑以下关于蛋白质浓度 $x$ 和 $y$ 以及信号 $s$ 的常微分方程 (ODE) 模型：\n$$\n\\frac{d x}{d t} \\;=\\; \\frac{\\alpha_1}{1 + \\left(\\frac{y}{K_y}\\right)^2} \\;+\\; \\beta_x \\;-\\; \\delta_x \\, x, \n$$\n$$\n\\frac{d y}{d t} \\;=\\; \\frac{\\alpha_2}{1 + \\left(\\frac{x}{K_x}\\right)^2} \\;+\\; \\beta_y \\;-\\; \\delta_y \\, y,\n$$\n$$\n\\frac{d s}{d t} \\;=\\; \\beta \\;-\\; \\delta_s \\, s.\n$$\n这里，$x$、$y$ 和 $s$ 表示浓度；$\\alpha_1$ 和 $\\alpha_2$ 是最大调控合成速率；$K_x$ 和 $K_y$ 是解离常数；$\\beta_x$ 和 $\\beta_y$ 是基础合成速率；$\\delta_x$、$\\delta_y$ 和 $\\delta_s$ 是一阶降解或稀释速率。所有速率的单位为 min$^{-1}$，浓度单位为一致的任意单位。\n\n使用非线性动力系统的线性化基础：不动点 $\\mathbf{z}^\\ast$ 是一个向量场为零的状态，雅可比矩阵 $J(\\mathbf{z}^\\ast)$ 的元素为 $J_{ij} = \\frac{\\partial f_i}{\\partial z_j}(\\mathbf{z}^\\ast)$（对于向量场 $\\mathbf{f}$），局部稳定性由 $J(\\mathbf{z}^\\ast)$ 的特征值的实部决定（实部为负意味着局部渐近稳定）。\n\n取参数值为 $K_x = 1$, $K_y = 1$, $\\alpha_1 = 4$, $\\alpha_2 = 6$, $\\beta_x = 0.5$, $\\beta_y = 0.5$, $\\delta_x = 2.5$, $\\delta_y = 3.5$, $\\beta = 3$, $\\delta_s = 1.5$。假设在这些参数下，系统存在与稳态平衡一致的不动点 $(x^\\ast, y^\\ast, s^\\ast) = (1, 1, 2)$。\n\n任务：\n- 根据上述定义，通过计算所需的偏导数，在不动点 $(x^\\ast, y^\\ast, s^\\ast)$ 处构建雅可比矩阵 $J$。\n- 计算 $J$ 的所有特征值和特征向量。\n- 利用特征值实部的符号及其特征向量，识别不动点处的稳定和不稳定子空间，并提供它们的基。\n\n最后，报告谱横坐标 $\\alpha(J)$，其定义为 $\\alpha(J) = \\max\\{\\Re(\\lambda_i)\\}$，其中 $\\lambda_i$ 是 $J$ 的特征值。以 min$^{-1}$ 为单位表示 $\\alpha(J)$ 的最终数值。无需四舍五入。",
            "solution": "在尝试任何解答之前，需要对问题进行验证。\n\n### 步骤1：提取已知条件\n常微分方程 (ODE) 系统为：\n$$\n\\frac{d x}{d t} \\;=\\; f_x(x, y, s) \\;=\\; \\frac{\\alpha_1}{1 + \\left(\\frac{y}{K_y}\\right)^2} \\;+\\; \\beta_x \\;-\\; \\delta_x \\, x\n$$\n$$\n\\frac{d y}{d t} \\;=\\; f_y(x, y, s) \\;=\\; \\frac{\\alpha_2}{1 + \\left(\\frac{x}{K_x}\\right)^2} \\;+\\; \\beta_y \\;-\\; \\delta_y \\, y\n$$\n$$\n\\frac{d s}{d t} \\;=\\; f_s(x, y, s) \\;=\\; \\beta \\;-\\; \\delta_s \\, s\n$$\n给定的参数值为：\n$K_x = 1$, $K_y = 1$, $\\alpha_1 = 4$, $\\alpha_2 = 6$, $\\beta_x = 0.5$, $\\beta_y = 0.5$, $\\delta_x = 2.5$, $\\delta_y = 3.5$, $\\beta = 3$, $\\delta_s = 1.5$。\n问题陈述假设在这些参数下，系统存在不动点 $(x^\\ast, y^\\ast, s^\\ast) = (1, 1, 2)$，且该不动点与稳态平衡一致。\n任务是求出此不动点处的雅可比矩阵 $J$，计算其特征值和特征向量，识别稳定和不稳定子空间及其基，并报告谱横坐标 $\\alpha(J)$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，代表了合成生物学中基因触发开关的标准模型。方程使用希尔型函数来表示转录抑制，这是一种常用且被接受的表述方式。语言客观，任务明确。\n问题是自洽的。为确保其没有矛盾，必须根据将时间导数设为零所得到的稳态条件来验证假设的不动点。\n1.  对于 $s$：$0 = \\beta - \\delta_s s^\\ast \\implies s^\\ast = \\frac{\\beta}{\\delta_s} = \\frac{3}{1.5} = 2$。这与给定的 $s^\\ast = 2$ 相符。\n2.  对于 $x$：$0 = \\frac{\\alpha_1}{1 + (y^\\ast/K_y)^2} + \\beta_x - \\delta_x x^\\ast \\implies 0 = \\frac{4}{1 + (1/1)^2} + 0.5 - 2.5(1) = \\frac{4}{2} + 0.5 - 2.5 = 2 + 0.5 - 2.5 = 0$。这是一致的。\n3.  对于 $y$：$0 = \\frac{\\alpha_2}{1 + (x^\\ast/K_x)^2} + \\beta_y - \\delta_y y^\\ast \\implies 0 = \\frac{6}{1 + (1/1)^2} + 0.5 - 3.5(1) = \\frac{6}{2} + 0.5 - 3.5 = 3 + 0.5 - 3.5 = 0$。这是一致的。\n由于给定的不动点满足给定参数下的稳态方程，该问题是自洽且适定的。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供解答。\n\n### 解答\n局部稳定性分析需要计算系统在不动点处的雅可比矩阵。状态向量为 $\\mathbf{z} = (x, y, s)^T$。雅可比矩阵 $J$ 的元素为 $J_{ij} = \\frac{\\partial f_i}{\\partial z_j}$，其中 $f_1=f_x, f_2=f_y, f_3=f_s$ 以及 $z_1=x, z_2=y, z_3=s$。\n\n首先，我们计算向量场 $\\mathbf{f}$ 的偏导数：\n$J_{11} = \\frac{\\partial f_x}{\\partial x} = -\\delta_x$\n$J_{12} = \\frac{\\partial f_x}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\alpha_1 \\left(1 + \\frac{y^2}{K_y^2}\\right)^{-1} \\right) = \\alpha_1 (-1) \\left(1 + \\frac{y^2}{K_y^2}\\right)^{-2} \\left(\\frac{2y}{K_y^2}\\right) = -\\frac{2 \\alpha_1 y}{K_y^2 \\left(1 + (y/K_y)^2\\right)^2}$\n$J_{13} = \\frac{\\partial f_x}{\\partial s} = 0$\n$J_{21} = \\frac{\\partial f_y}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\alpha_2 \\left(1 + \\frac{x^2}{K_x^2}\\right)^{-1} \\right) = \\alpha_2 (-1) \\left(1 + \\frac{x^2}{K_x^2}\\right)^{-2} \\left(\\frac{2x}{K_x^2}\\right) = -\\frac{2 \\alpha_2 x}{K_x^2 \\left(1 + (x/K_x)^2\\right)^2}$\n$J_{22} = \\frac{\\partial f_y}{\\partial y} = -\\delta_y$\n$J_{23} = \\frac{\\partial f_y}{\\partial s} = 0$\n$J_{31} = \\frac{\\partial f_s}{\\partial x} = 0$\n$J_{32} = \\frac{\\partial f_s}{\\partial y} = 0$\n$J_{33} = \\frac{\\partial f_s}{\\partial s} = -\\delta_s$\n\n雅可比矩阵为：\n$$\nJ(x, y, s) = \\begin{pmatrix}\n-\\delta_x  -\\frac{2 \\alpha_1 y}{K_y^2 \\left(1 + (y/K_y)^2\\right)^2}  0 \\\\\n-\\frac{2 \\alpha_2 x}{K_x^2 \\left(1 + (x/K_x)^2\\right)^2}  -\\delta_y  0 \\\\\n0  0  -\\delta_s\n\\end{pmatrix}\n$$\n现在，我们使用给定的参数值在不动点 $(x^\\ast, y^\\ast, s^\\ast) = (1, 1, 2)$ 处计算该矩阵：\n$J_{11} = -\\delta_x = -2.5$\n$J_{12} = -\\frac{2(4)(1)}{1^2 \\left(1 + (1/1)^2\\right)^2} = -\\frac{8}{1 \\cdot (2)^2} = -\\frac{8}{4} = -2$\n$J_{21} = -\\frac{2(6)(1)}{1^2 \\left(1 + (1/1)^2\\right)^2} = -\\frac{12}{1 \\cdot (2)^2} = -\\frac{12}{4} = -3$\n$J_{22} = -\\delta_y = -3.5$\n$J_{33} = -\\delta_s = -1.5$\n\n在不动点处的雅可比矩阵为：\n$$\nJ^\\ast = J(1, 1, 2) = \\begin{pmatrix}\n-2.5  -2  0 \\\\\n-3  -3.5  0 \\\\\n0  0  -1.5\n\\end{pmatrix}\n$$\n$J^\\ast$ 的特征值 $\\lambda$ 是特征方程 $\\det(J^\\ast - \\lambda I) = 0$ 的根。由于其块对角结构，一个特征值立即可见：$\\lambda_3 = -1.5$。另外两个特征值来自左上角的 $2 \\times 2$ 子矩阵：\n$$\nJ_{xy} = \\begin{pmatrix}\n-2.5  -2 \\\\\n-3  -3.5\n\\end{pmatrix}\n$$\n该子矩阵的特征方程为 $\\det(J_{xy} - \\lambda I) = 0$：\n$$\n(-2.5 - \\lambda)(-3.5 - \\lambda) - (-2)(-3) = 0\n$$\n$$\n\\lambda^2 + 3.5\\lambda + 2.5\\lambda + (2.5)(3.5) - 6 = 0\n$$\n$$\n\\lambda^2 + 6\\lambda + 8.75 - 6 = 0\n$$\n$$\n\\lambda^2 + 6\\lambda + 2.75 = 0\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\n\\lambda = \\frac{-6 \\pm \\sqrt{6^2 - 4(1)(2.75)}}{2(1)} = \\frac{-6 \\pm \\sqrt{36 - 11}}{2} = \\frac{-6 \\pm \\sqrt{25}}{2} = \\frac{-6 \\pm 5}{2}\n$$\n这给出了另外两个特征值：\n$\\lambda_1 = \\frac{-6 + 5}{2} = -0.5$\n$\\lambda_2 = \\frac{-6 - 5}{2} = -5.5$\n$J^\\ast$ 的特征值集合为 $\\{\\lambda_1, \\lambda_2, \\lambda_3\\} = \\{-0.5, -5.5, -1.5\\}$。\n\n接下来，我们通过求解 $(J^\\ast - \\lambda I)\\mathbf{v} = \\mathbf{0}$ 来找到相应的特征向量 $\\mathbf{v}$。\n对于 $\\lambda_1 = -0.5$：\n$$\n\\begin{pmatrix} -2.5 - (-0.5)  -2  0 \\\\ -3  -3.5 - (-0.5)  0 \\\\ 0  0  -1.5 - (-0.5) \\end{pmatrix} \\begin{pmatrix} v_{1x} \\\\ v_{1y} \\\\ v_{1z} \\end{pmatrix} = \\begin{pmatrix} -2  -2  0 \\\\ -3  -3  0 \\\\ 0  0  -1 \\end{pmatrix} \\begin{pmatrix} v_{1x} \\\\ v_{1y} \\\\ v_{1z} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n第三行意味着 $v_{1z}=0$。第一行意味着 $-2v_{1x} - 2v_{1y} = 0$，所以 $v_{1x} = -v_{1y}$。选择 $v_{1y}=1$ 得到 $v_{1x}=-1$。一个特征向量是 $\\mathbf{v}_1 = (-1, 1, 0)^T$。\n\n对于 $\\lambda_2 = -5.5$：\n$$\n\\begin{pmatrix} -2.5 - (-5.5)  -2  0 \\\\ -3  -3.5 - (-5.5)  0 \\\\ 0  0  -1.5 - (-5.5) \\end{pmatrix} \\begin{pmatrix} v_{2x} \\\\ v_{2y} \\\\ v_{2z} \\end{pmatrix} = \\begin{pmatrix} 3  -2  0 \\\\ -3  2  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} v_{2x} \\\\ v_{2y} \\\\ v_{2z} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n第三行意味着 $v_{2z}=0$。第一行意味着 $3v_{2x} - 2v_{2y} = 0$，所以 $3v_{2x} = 2v_{2y}$。选择 $v_{2y}=3$ 得到 $v_{2x}=2$。一个特征向量是 $\\mathbf{v}_2 = (2, 3, 0)^T$。\n\n对于 $\\lambda_3 = -1.5$：\n$$\n\\begin{pmatrix} -2.5 - (-1.5)  -2  0 \\\\ -3  -3.5 - (-1.5)  0 \\\\ 0  0  -1.5 - (-1.5) \\end{pmatrix} \\begin{pmatrix} v_{3x} \\\\ v_{3y} \\\\ v_{3z} \\end{pmatrix} = \\begin{pmatrix} -1  -2  0 \\\\ -3  -2  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} v_{3x} \\\\ v_{3y} \\\\ v_{3z} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n第二行方程减去第一行方程得到 $-2v_{3x} = 0 \\implies v_{3x}=0$。代回后得到 $-2v_{3y}=0 \\implies v_{3y}=0$。变量 $v_{3z}$ 是自由的。选择 $v_{3z}=1$ 得到特征向量 $\\mathbf{v}_3 = (0, 0, 1)^T$。\n\n特征值及其对应的特征向量为：\n$\\lambda_1 = -0.5, \\quad \\mathbf{v}_1 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$\n$\\lambda_2 = -5.5, \\quad \\mathbf{v}_2 = \\begin{pmatrix} 2 \\\\ 3 \\\\ 0 \\end{pmatrix}$\n$\\lambda_3 = -1.5, \\quad \\mathbf{v}_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$\n\n不动点的局部稳定性由特征值实部的符号决定。所有三个特征值都是实数且为负：$\\{-0.5, -5.5, -1.5\\}$。由于对于所有的 $i=1,2,3$ 都有 $\\Re(\\lambda_i)  0$，所以不动点 $(1, 1, 2)$ 是局部渐近稳定的。\n\n稳定子空间 $E^s$ 是由对应于负实部特征值的特征向量张成的空间。由于所有特征值都是负的，稳定子空间是整个状态空间 $E^s = \\mathbb{R}^3$。稳定子空间的一个基是所有特征向量的集合：\n$$\n\\text{稳定子空间 } E^s \\text{ 的基} : \\left\\{ \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 2 \\\\ 3 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\right\\}\n$$\n不稳定子空间 $E^u$ 是由对应于正实部特征值的特征向量张成的空间。没有这样的特征值，所以不稳定子空间是只包含原点的平凡子空间：$E^u = \\{\\mathbf{0}\\}$。该子空间的基是空集。\n\n最后，谱横坐标 $\\alpha(J)$ 是特征值实部的最大值：\n$$\n\\alpha(J^\\ast) = \\max\\{\\Re(\\lambda_1), \\Re(\\lambda_2), \\Re(\\lambda_3)\\} = \\max\\{-0.5, -5.5, -1.5\\} = -0.5\n$$\n根据规定，单位为 $\\text{min}^{-1}$。",
            "answer": "$$\n\\boxed{-0.5}\n$$"
        },
        {
            "introduction": "生化反应网络通常包含守恒定律，例如蛋白质及其修饰形式的总浓度保持不变。这些约束会在完整系统的雅可比矩阵中引入结构性奇异，导致出现一个可能被误解的零特征值。本练习  旨在探讨这一关键问题，引导你理解为何会出现这个零特征值，并学会如何通过在由守恒律定义的低维流形上分析系统来正确评估其稳定性。",
            "id": "3916888",
            "problem": "考虑一个由合成启动子控制的转录模块，其中包含物种 $P$（游离启动子）、$PX$（与转录因子 $X$ 结合的启动子）和 $X$（转录因子）。所涉及的反应有：可逆结合 $P + X \\rightleftharpoons PX$，从结合的启动子转录 $PX \\rightarrow PX + X$，以及降解 $X \\rightarrow \\varnothing$。假设在充分混合条件下，动力学行为是确定性的，并由基于质量作用动力学和线性降解的常微分方程（ODEs）建模。设动力学参数为 $k_f$（结合速率）、$k_r$（解离速率）、$\\alpha$（从 $PX$ 转录的速率）和 $\\delta$（$X$ 的降解速率），总启动子数量 $P_{\\mathrm{tot}}$ 守恒。该 ODE 模型为\n$$\n\\frac{dP}{dt} = - k_f P X + k_r PX,\\quad\n\\frac{dPX}{dt} = k_f P X - k_r PX,\\quad\n\\frac{dX}{dt} = \\alpha PX - \\delta X - k_f P X + k_r PX.\n$$\n一个不动点 $(P^\\ast, PX^\\ast, X^\\ast)$ 满足方程组右侧等于 $0$，并同时满足守恒关系 $P^\\ast + PX^\\ast = P_{\\mathrm{tot}}$。假设参数满足 $k_f = 2$, $k_r = 1$, $\\alpha = 3$, $\\delta = 1$, $P_{\\mathrm{tot}} = 1$，并考虑正不动点 $P^\\ast = \\frac{1}{6}$，$PX^\\ast = \\frac{5}{6}$，$X^\\ast = \\frac{5}{2}$。\n\n从第一性原理出发，该反应网络意味着向量场位于化学计量子空间（化学计量矩阵的像空间）内，并且启动子部分 $P + PX$ 是守恒的。你的任务是通过仔细处理守恒约束来评估该不动点的真实线性稳定性。\n\n请执行以下推理步骤：\n- 从给定的 ODEs 和守恒关系 $P + PX = P_{\\mathrm{tot}}$ 出发，从第一性原理角度解释为什么在全物种坐标 $(P, PX, X)$ 中计算时，守恒约束会导致雅可比矩阵 $J = \\partial f/\\partial x$ 出现零特征值。\n- 直接从反应变化向量为该网络构建化学计量子空间的一个标准正交基，并用它来定义一个将 $J$ 限制在化学计量子空间上的投影。在不动点 $(P^\\ast, PX^\\ast, X^\\ast)$ 处评估降维后的雅可比矩阵，并确定其特征值的符号。\n- 根据你的推导，选择一个最佳陈述，该陈述能正确解释为什么会出现零特征值，以及如何排除它们以评估真实稳定性。\n\n哪个选项是正确的？\nA. 零特征值的出现是由于守恒约束，因为向量场被限制在一个较低维度的化学计量子空间中，这使得在全坐标系下的雅可比矩阵 $J$ 成为奇异矩阵；正确的稳定性评估方法是将 $J$ 限制在该子空间上，并分析降维后算子的特征值。\nB. 仅当在不动点处产生速率和降解速率相等时才会出现零特征值；要排除它们，应在计算特征值之前移除 $J$ 中对应于守恒物种的列。\nC. 零特征值是由高浓度 $X$ 下的结合饱和引起的；可以通过重新标度时间来消除 $J$ 的简并性以排除它们。\nD. 任何零特征值都意味着不动点不可能是线性稳定的；因此必须放弃线性化，并完全依赖非线性项来评估稳定性。",
            "solution": "用户要求对一个关于带有守恒律的生化反应网络中不动点的线性稳定性分析问题进行严格验证和详细解答。\n\n### 步骤 1：提取已知条件\n\n- **物种**：$P$ (游离启动子)，$PX$ (结合的启动子)，$X$ (转录因子)。\n- **状态向量**：$x = (P, PX, X)^T$。\n- **反应和动力学**：\n    1.  结合：$P + X \\xrightarrow{k_f} PX$ (速率：$k_f P X$)\n    2.  解离：$PX \\xrightarrow{k_r} P + X$ (速率：$k_r PX$)\n    3.  转录：$PX \\xrightarrow{\\alpha} PX + X$ (速率：$\\alpha PX$)\n    4.  降解：$X \\xrightarrow{\\delta} \\varnothing$ (速率：$\\delta X$)\n- **常微分方程 (ODEs)**：\n$$\n\\begin{aligned}\n\\frac{dP}{dt} = - k_f P X + k_r PX \\\\\n\\frac{dPX}{dt} = k_f P X - k_r PX \\\\\n\\frac{dX}{dt} = \\alpha PX - \\delta X - k_f P X + k_r PX\n\\end{aligned}\n$$\n- **守恒律**：总启动子浓度守恒：$P(t) + PX(t) = P_{\\mathrm{tot}}$。\n- **参数值**：$k_f = 2$, $k_r = 1$, $\\alpha = 3$, $\\delta = 1$, $P_{\\mathrm{tot}} = 1$。\n- **不动点**：$(P^\\ast, PX^\\ast, X^\\ast) = (\\frac{1}{6}, \\frac{5}{6}, \\frac{5}{2})$。\n\n### 步骤 2：使用已知条件进行验证\n\n1.  **科学依据和一致性检查**：该模型使用标准的质量作用动力学来描述基本的生化过程（结合、催化、降解），这是化学和系统生物学建模的基石。ODEs 是根据指定的反应正确推导出来的。该问题在科学上是合理的。\n\n2.  **内部一致性检查**：我将验证给定的不动点确实是具有给定参数的系统的不动点。\n    -   **守恒律**：$P^\\ast + PX^\\ast = \\frac{1}{6} + \\frac{5}{6} = 1 = P_{\\mathrm{tot}}$。该守恒律在指定点上得到满足。\n    -   **不动点处的 ODEs**：我们必须验证在 $(P^\\ast, PX^\\ast, X^\\ast)$ 处，$\\frac{dP}{dt} = \\frac{dPX}{dt} = \\frac{dX}{dt} = 0$。\n        -   $\\frac{dP}{dt} = - k_f P^\\ast X^\\ast + k_r PX^\\ast = - (2)(\\frac{1}{6})(\\frac{5}{2}) + (1)(\\frac{5}{6}) = -\\frac{10}{12} + \\frac{5}{6} = -\\frac{5}{6} + \\frac{5}{6} = 0$。满足条件。\n        -   $\\frac{dPX}{dt} = k_f P^\\ast X^\\ast - k_r PX^\\ast = (2)(\\frac{1}{6})(\\frac{5}{2}) - (1)(\\frac{5}{6}) = \\frac{5}{6} - \\frac{5}{6} = 0$。满足条件。\n        -   $\\frac{dX}{dt} = \\alpha PX^\\ast - \\delta X^\\ast - k_f P^\\ast X^\\ast + k_r PX^\\ast = (3)(\\frac{5}{6}) - (1)(\\frac{5}{2}) - (2)(\\frac{1}{6})(\\frac{5}{2}) + (1)(\\frac{5}{6}) = \\frac{5}{2} - \\frac{5}{2} - \\frac{5}{6} + \\frac{5}{6} = 0$。满足条件。\n\n3.  **问题的适定性和任务清晰度**：任务是在存在守恒律的情况下分析一个已验证不动点的线性稳定性，这是一个定义明确的数学问题。提示中概述的步骤指导了一个标准且正确的分析过程。\n\n问题设定在科学上是合理的，内部一致，且适定性良好。未检测到任何缺陷。\n\n### 步骤 3：结论与行动\n\n问题是**有效的**。我将继续进行解答。\n\n---\n\n### 推导与分析\n\n问题要求解释为什么由于守恒律会产生零特征值，并通过将雅可比矩阵限制在化学计量子空间上来评估稳定性。\n\n**第 1 部分：由守恒约束引起的零特征值的来源**\n\n守恒律意味着系统的状态被限制在完整状态空间的一个子流形上。在这种情况下，总启动子的守恒，$P(t) + PX(t) = P_{\\mathrm{tot}}$，将动力学限制在 $(P, PX, X)$ 的三维空间中的一个平面上。\n\n设状态向量为 $x = (P, PX, X)^T$。守恒律可以写成 $c^T x = P_{\\mathrm{tot}}$，其中 $c = (1, 1, 0)^T$ 是该平面的常法向量。\n\n守恒律的时间导数必须为零：\n$$\n\\frac{d}{dt}(P + PX) = \\frac{dP}{dt} + \\frac{dPX}{dt} = 0\n$$\n让我们从 ODEs 中验证这一点：\n$$\n(- k_f P X + k_r PX) + (k_f P X - k_r PX) = 0\n$$\n这个恒等式对任何状态 $(P, PX, X)$ 都成立，而不仅仅是在不动点。用向量符号表示，其中 $\\dot{x} = f(x)$，这意味着对于所有 $x$，$c^T f(x) = 0$。这证实了向量场 $f(x)$ 总是平行于由守恒律定义的平面（即，与其法向量 $c$ 正交）。\n\n系统的雅可比矩阵是 $J = \\frac{\\partial f}{\\partial x}$。由于 $c^T f(x) = 0$ 是一个恒等式，我们可以对它关于 $x$ 求导：\n$$\n\\frac{\\partial}{\\partial x} [c^T f(x)] = c^T \\frac{\\partial f}{\\partial x} = c^T J = 0\n$$\n这个方程表明，对于在*任何*点评估的雅可比矩阵 $J$，向量 $c^T$ 是一个特征值为 $0$ 的左特征向量。一个具有零特征值的左特征向量的矩阵是奇异的（其行列式为零），因此也必须有一个具有零特征值的右特征向量。\n\n这个零特征值是坐标系冗余的直接后果。动力学实际上是低维的，但在一个高维空间中被描述。零特征值对应于与不变流形（平面 $P+PX=P_{tot}$）正交的方向，沿这个方向没有动力学发生。要确定不动点的真实稳定性，我们必须分析限制*在该*流形上的动力学。\n\n**第 2 部分：通过系统降维进行稳定性分析**\n\n分析不变流形上动力学的最直接方法是利用守恒律消除一个变量。设 $P = P_{\\mathrm{tot}} - PX$。三维系统简化为关于变量 $(PX, X)$ 的二维系统。\n\n$P$ 的 ODE 现在是多余的。剩下的 ODEs 变为：\n$$\n\\begin{aligned}\n\\frac{dPX}{dt} = k_f (P_{\\mathrm{tot}} - PX) X - k_r PX \\\\\n\\frac{dX}{dt} = \\alpha PX - \\delta X - k_f (P_{\\mathrm{tot}} - PX) X + k_r PX\n\\end{aligned}\n$$\n设 $g(PX, X)$ 是这个降维系统的向量场。我们求这个降维系统的雅可比矩阵 $J_{red}$：\n$$\nJ_{red} = \\begin{pmatrix} \\frac{\\partial}{\\partial PX} ( k_f (P_{\\mathrm{tot}} - PX) X - k_r PX )  \\frac{\\partial}{\\partial X} ( k_f (P_{\\mathrm{tot}} - PX) X - k_r PX ) \\\\ \\frac{\\partial}{\\partial PX} ( \\dots )  \\frac{\\partial}{\\partial X} ( \\dots ) \\end{pmatrix}\n$$\n偏导数是：\n$$\n\\begin{aligned}\n\\frac{\\partial g_1}{\\partial PX} = -k_f X - k_r \\\\\n\\frac{\\partial g_1}{\\partial X} = k_f (P_{\\mathrm{tot}} - PX) = k_f P \\\\\n\\frac{\\partial g_2}{\\partial PX} = \\alpha + k_f X + k_r \\\\\n\\frac{\\partial g_2}{\\partial X} = -\\delta - k_f(P_{\\mathrm{tot}} - PX) = -\\delta - k_f P\n\\end{aligned}\n$$\n所以，降维雅可比矩阵是：\n$$\nJ_{red} = \\begin{pmatrix} -k_f X - k_r  k_f P \\\\ \\alpha + k_f X + k_r  -\\delta - k_f P \\end{pmatrix}\n$$\n现在，我们在不动点 $(P^\\ast, PX^\\ast, X^\\ast) = (\\frac{1}{6}, \\frac{5}{6}, \\frac{5}{2})$ 和给定参数（$k_f = 2, k_r = 1, \\alpha = 3, \\delta = 1, P_{\\mathrm{tot}} = 1$）下评估 $J_{red}$：\n- $-k_f X^\\ast - k_r = -(2)(\\frac{5}{2}) - 1 = -5 - 1 = -6$\n- $k_f P^\\ast = (2)(\\frac{1}{6}) = \\frac{1}{3}$\n- $\\alpha + k_f X^\\ast + k_r = 3 + (2)(\\frac{5}{2}) + 1 = 3 + 5 + 1 = 9$\n- $-\\delta - k_f P^\\ast = -1 - (2)(\\frac{1}{6}) = -1 - \\frac{1}{3} = -\\frac{4}{3}$\n$$\nJ_{red}^\\ast = \\begin{pmatrix} -6  1/3 \\\\ 9  -4/3 \\end{pmatrix}\n$$\n该矩阵的特征值 $\\lambda$ 决定了稳定性。它们是特征方程 $\\lambda^2 - \\text{tr}(J_{red}^\\ast)\\lambda + \\det(J_{red}^\\ast) = 0$ 的根。\n- **迹**：$\\text{tr}(J_{red}^\\ast) = -6 + (-\\frac{4}{3}) = -\\frac{18}{3} - \\frac{4}{3} = -\\frac{22}{3}$。\n- **行列式**：$\\det(J_{red}^\\ast) = (-6)(-\\frac{4}{3}) - (\\frac{1}{3})(9) = 8 - 3 = 5$。\n\n特征方程是 $\\lambda^2 + \\frac{22}{3}\\lambda + 5 = 0$。\n特征值之和为 $\\lambda_1 + \\lambda_2 = \\text{tr}(J_{red}^\\ast) = -\\frac{22}{3}  0$。\n特征值之积为 $\\lambda_1 \\lambda_2 = \\det(J_{red}^\\ast) = 5 > 0$。\n\n由于特征值的积为正，它们的符号相同。由于它们的和为负，两个特征值都必须是负的。（另外，判别式为 $\\Delta = (\\frac{22}{3})^2 - 4(5) = \\frac{484}{9} - \\frac{180}{9} = \\frac{304}{9} > 0$，所以特征值是实数且不相等）。\n\n因为降维系统的两个特征值都具有负实部（在这种情况下，它们都是负实数），所以该不动点是线性稳定的。问题中提到的使用标准正交基和投影是一种更通用但等效的方法，它将得到一个具有完全相同的迹和行列式的 $2 \\times 2$ 矩阵，因此具有相同的特征值。\n\n### 选项评估\n\n- **A. 零特征值的出现是由于守恒约束，因为向量场被限制在一个较低维度的化学计量子空间中，这使得在全坐标系下的雅可比矩阵 $J$ 成为奇异矩阵；正确的稳定性评估方法是将 $J$ 限制在该子空间上，并分析降维后算子的特征值。**\n  - 这个陈述与我们的推导完全一致。守恒律将动力学限制在一个流形上（化学计量子空间的一个平移版本），这导致完整系统（$J$）的雅可比矩阵是奇异的并且有一个零特征值。正确的程序是分析限制在该子空间上的动力学，例如，通过将 $J$ 投影到该子空间的一个标准正交基上，这与我们上面执行的变量约简方法是等效的。这个陈述是对情况的精确和正确的描述。**正确**。\n\n- **B. 仅当在不动点处产生速率和降解速率相等时才会出现零特征值；要排除它们，应在计算特征值之前移除 $J$ 中对应于守恒物种的列。**\n  - 第一个子句混淆了不动点的条件与零特征值的结构性原因。零特征值源于守恒律本身，它独立于任何特定的参数值或不动点的位置。第二个子句提出了一个不正确的程序（“移除 $J$ 的列”）。守恒量是物种的*总和*，而不是单个物种，正确的程序是系统降维或投影，而不是粗略地移除列。**不正确**。\n\n- **C. 零特征值是由高浓度 $X$ 下的结合饱和引起的；可以通过重新标度时间来消除 $J$ 的简并性以排除它们。**\n  - 这将原因归于“饱和”，这不是根本原因。这里使用的质量作用动力学不表现出饱和。零特征值是由于守恒律引起的结构性特征。此外，时间重标度（$t \\to \\tau t'$）会按一个常数因子缩放所有特征值（$J \\to J/\\tau$），所以它会将一个零特征值变成另一个零特征值（$0 \\to 0/\\tau = 0$），而不会消除它。**不正确**。\n\n- **D. 任何零特征值都意味着不动点不可能是线性稳定的；因此必须放弃线性化，并完全依赖非线性项来评估稳定性。**\n  - 这个陈述误解了在这种情况下稳定性的含义。虽然在一般情况下，一个零特征值可能导致中性稳定并需要更高阶的分析（如中心流形理论），但由守恒律产生的零特征值是冗余坐标系造成的人为结果。一旦系统被正确地简化到其基本自由度，这个人为的零特征值就会消失。剩下的特征值决定了稳定性。在降维系统上进行线性化是有效且充分的。放弃线性化是不必要的。**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "尽管手动计算对于建立直觉至关重要，但现代系统生物学在很大程度上依赖计算工具来分析复杂模型。本练习  旨在通过为一个经典的基因开关模型实现一个完整的计算工作流，从而连接理论与应用。你将编写代码，通过绘制零增长等值线来数值化地定位所有不动点，并对其稳定性进行分类，这为你探索如双稳态等系统行为提供了一种强大且可推广的方法。",
            "id": "3916947",
            "problem": "考虑一个确定性的双基因相互抑制回路，其模型为一个由两个耦合常微分方程组成的系统，这是合成生物学中基因调控网络建模的标准结构。令 $x(t)$ 和 $y(t)$ 表示由基因 $X$ 和 $Y$ 产生的两种阻遏蛋白的无量纲浓度。每种蛋白质的产生都通过希尔型（Hill-type）抑制被另一种蛋白质所抑制，并通过一阶降解被移除。其动力学由以下方程定义\n$$\n\\frac{dx}{dt} \\equiv f_1(x,y) = \\frac{\\alpha_x}{1 + \\left(\\frac{y}{K_y}\\right)^{n_y}} - \\delta_x x,\n\\qquad\n\\frac{dy}{dt} \\equiv f_2(x,y) = \\frac{\\alpha_y}{1 + \\left(\\frac{x}{K_x}\\right)^{n_x}} - \\delta_y y.\n$$\n假设 $\\alpha_x = \\alpha_y = \\alpha$，$K_x = K_y = 1$，$\\delta_x = \\delta_y = 1$ 以及 $n_x = n_y = 4$。该系统被广泛用作合成生物学中触发开关（toggle switch）的最小模型。一个不动点 $(x^*,y^*)$ 满足 $f_1(x^*,y^*)=0$ 和 $f_2(x^*,y^*)=0$。不动点的局部线性稳定性由在该点 $(x^*,y^*)$ 求值的雅可比矩阵 $J(x^*,y^*)$ 的特征值决定，其元素为 $J_{ij} = \\partial f_i / \\partial z_j$，其中 $(z_1,z_2)=(x,y)$。\n\n您的任务是实现一个计算程序，该程序：\n- 在 $(x,y)$ 平面的一个矩形域上，仅使用数值方法（不利用零斜线的封闭形式表达式）来数值化地绘制系统的零斜线（即 $f_1(x,y)=0$ 和 $f_2(x,y)=0$ 的点集）。\n- 使用零斜线图和稳健的求根策略来定位域内所有不同的不动点。\n- 通过有限差分法在每个不动点处估计雅可比矩阵 $J(x^*,y^*)$，计算其特征值，并根据特征值的实部和行列式的符号将每个不动点分类为线性稳定点、不稳定点或鞍点。\n- 根据模型速率定律的第一性原理，将有限差分法得到的雅可比矩阵与解析推导的雅可比矩阵条目进行验证。\n\n您可以使用的基础出发点包括：不动点的常微分方程定义、零斜线的定义、动力系统的雅可比矩阵和线性化、基因调控中的希尔抑制函数形式，以及用于导数数值近似的中心差分法。不要使用或假设零斜线的任何封闭形式；计算程序必须通过检测网格中的零交叉点来数值化地绘制它们。\n\n在定义域 $x \\in [0,4]$，$y \\in [0,4]$ 内进行计算。使用一个 $201 \\times 201$ 点的均匀网格来扫描零斜线的零交叉点。对于有限差分雅可比矩阵的估计，使用中心差分法，其步长应与不动点的值成比例（为了数值稳定性），例如，对于 $x$ 的扰动，步长为 $h = 10^{-4} \\max(1, |x^*|)$，对于 $y$ 的扰动，步长为 $h = 10^{-4} \\max(1, |y^*|)$。在验证解析雅可比矩阵与有限差分雅可比矩阵时，如果两者逐个元素的最大绝对差小于 $10^{-5}$，则认为这两个矩阵匹配。\n\n定义以下参数集测试套件，每个集合由单个标量 $\\alpha$ 指定（所有其他参数如上所述）：\n1. 正常路径（双稳态候选区）：$\\alpha = 3.0$。\n2. 低产率（单稳态区）：$\\alpha = 0.5$。\n3. 接近对称性破缺阈值（边界情况）：$\\alpha = 1.012948$。\n\n对于每个参数集，计算并汇总以下量：\n- 在域内找到的不同不动点的总数。\n- 线性稳定不动点的数量（所有特征值实部为负）。\n- 鞍点的数量（雅可比矩阵行列式为负）。\n- 一个布尔值，指示在每个不动点处，解析雅可比矩阵是否在上述容差范围内与有限差分雅可比矩阵匹配。\n- “近临界”不动点的数量，即至少有一个特征值的实部绝对值小于 $10^{-3}$ 的不动点。\n\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中每个元素对应一个参数集，并且本身是按上述顺序排列的列表。例如，输出格式必须严格如下：\n$$\n[ [r_{11}, r_{12}, r_{13}, r_{14}, r_{15}], [r_{21}, r_{22}, r_{23}, r_{24}, r_{25}], [r_{31}, r_{32}, r_{33}, r_{34}, r_{35}] ].\n$$\n所有输出均为无单位的实数或整数，布尔值必须以 Python 的原生布尔形式表示。程序必须是自包含的，不接受任何输入，并且能够按原样运行以产生指定的单行输出。",
            "solution": "用户提供的问题是一个有效且适定的计算练习，其基础是应用于合成生物学的动力系统理论的基本原理。它要求对一个标准的基因触发开关模型进行不动点分析。问题提供了所有必要的方程、参数和计算约束。我将继续提供完整的解决方案。\n\n问题的核心是找到并分类以下常微分方程（ODE）系统的不动点：\n$$\n\\frac{dx}{dt} = f_1(x,y) = \\frac{\\alpha}{1 + y^4} - x\n$$\n$$\n\\frac{dy}{dt} = f_2(x,y) = \\frac{\\alpha}{1 + x^4} - y\n$$\n这是所提供通用模型的简化版本，其参数为 $\\alpha_x = \\alpha_y = \\alpha$，$K_x = K_y = 1$，$\\delta_x = \\delta_y = 1$ 以及 $n_x = n_y = 4$。\n\n不动点 $(x^*, y^*)$ 是系统不随时间变化的状态，意味着变化率为零：\n$$\nf_1(x^*, y^*) = 0 \\quad \\text{且} \\quad f_2(x^*, y^*) = 0\n$$\n满足 $f_1(x,y) = 0$ 和 $f_2(x,y) = 0$ 的点集分别称为 x-零斜线和 y-零斜线。不动点正是这些零斜线的交点。\n\n计算过程包括以下几个步骤。\n\n**1. 不动点定位与精化**\n\n为了在不依赖零斜线交点的解析解的情况下找到不动点，我们遵循一个两步数值过程：定位和精化。\n\n首先，我们将定义域 $x \\in [0,4]$，$y \\in [0,4]$ 离散化为一个 $201 \\times 201$ 的网格。设网格点为 $(x_i, y_j)$。在每个网格点上，我们计算函数 $f_1(x_i, y_j)$ 和 $f_2(x_i, y_j)$ 的值。\n\n如果 $f_1$ 和 $f_2$ 的零斜线都穿过某个网格单元，则该单元内必定存在一个不动点。如果一个函数 $f$ 在某个单元四个角点上的值不全为同号（即，最小值是负的，最大值是正的），则该函数的零斜线必定穿过该单元。我们遍历 $200 \\times 200$ 个网格单元中的每一个。如果对于某个单元，我们发现 $f_1$ 和 $f_2$ 都在其角点之间发生符号变化，我们就将该单元的中心确定为不动点的初始猜测值 $(x_0, y_0)$。\n\n其次，对于每个初始猜测值 $(x_0, y_0)$，我们使用数值求根算法来精化不动点 $(x^*, y^*)$ 的位置。这可以通过求解向量方程 $\\vec{F}(x,y) = [f_1(x,y), f_2(x,y)] = \\vec{0}$ 来实现。`scipy.optimize.root` 函数适合此任务。\n\n由于多个网格单元可能会产生收敛到同一个不动点的初始猜测值，我们收集所有找到的根，并筛选出唯一的解。如果一个新根与一个已找到的根之间的欧几里得距离小于一个很小的容差（例如 $10^{-5}$），则认为它是重复的。我们还会丢弃在指定域之外找到的任何根。\n\n**2. 雅可比矩阵推导**\n\n不动点 $(x^*, y^*)$ 的局部稳定性由在该点求值的雅可比矩阵 $J$ 的特征值决定。雅可比矩阵是向量函数 $\\vec{F}$ 所有一阶偏导数的矩阵：\n$$\nJ(x,y) = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x}  \\frac{\\partial f_1}{\\partial y} \\\\ \\frac{\\partial f_2}{\\partial x}  \\frac{\\partial f_2}{\\partial y} \\end{pmatrix}\n$$\n对于给定的系统，解析导数是：\n$$\n\\frac{\\partial f_1}{\\partial x} = -1\n$$\n$$\n\\frac{\\partial f_1}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\frac{\\alpha}{1 + y^4} \\right) = \\alpha \\cdot (-1)(1+y^4)^{-2} \\cdot (4y^3) = -\\frac{4\\alpha y^3}{(1+y^4)^2}\n$$\n$$\n\\frac{\\partial f_2}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\alpha}{1 + x^4} \\right) = \\alpha \\cdot (-1)(1+x^4)^{-2} \\cdot (4x^3) = -\\frac{4\\alpha x^3}{(1+x^4)^2}\n$$\n$$\n\\frac{\\partial f_2}{\\partial y} = -1\n$$\n因此，解析雅可比矩阵是：\n$$\nJ_{an}(x,y) = \\begin{pmatrix} -1  -\\frac{4\\alpha y^3}{(1+y^4)^2} \\\\ -\\frac{4\\alpha x^3}{(1+x^4)^2}  -1 \\end{pmatrix}\n$$\n\n**3. 数值雅可比矩阵估计与验证**\n\n根据要求，我们还使用中心有限差分法来数值估计雅可比矩阵。对于函数 $g(z_1, z_2)$，其偏导数近似为：\n$$\n\\frac{\\partial g}{\\partial z_1} \\approx \\frac{g(z_1+h_1, z_2) - g(z_1-h_1, z_2)}{2h_1}, \\quad \\frac{\\partial g}{\\partial z_2} \\approx \\frac{g(z_1, z_2+h_2) - g(z_1, z_2-h_2)}{2h_2}\n$$\n为了数值稳定性，步长选择为与不动点坐标的大小成比例：$h_x = 10^{-4} \\max(1, |x^*|)$ 和 $h_y = 10^{-4} \\max(1, |y^*|)$。\n\n在每个不动点处，我们计算解析雅可比矩阵 $J_{an}$ 和数值雅可比矩阵 $J_{num}$。然后，我们通过检查它们对应元素之间的最大绝对差是否小于指定的容差 $10^{-5}$ 来进行验证。一个布尔标志用于跟踪在给定参数集内，此验证是否对所有不动点都成立。\n\n**4. 不动点分类**\n\n对于每个唯一的不动点，我们计算解析雅可比矩阵的特征值 $\\lambda_1$ 和 $\\lambda_2$。稳定性由这些特征值实部 $\\text{Re}(\\lambda_1)$ 和 $\\text{Re}(\\lambda_2)$ 的符号决定。\n\n- **线性稳定：** 如果所有特征值的实部都为负，即 $\\text{Re}(\\lambda_1)  0$ 且 $\\text{Re}(\\lambda_2)  0$，则不动点是稳定的。从该点附近开始的轨迹将收敛到该点。\n- **鞍点：** 如果特征值的实部符号相反，则该不动点为鞍点。对于一个 $2 \\times 2$ 系统，最稳健的判别条件是雅可比矩阵的行列式为负：$\\det(J) = \\lambda_1 \\lambda_2  0$。鞍点附近的轨迹在一个方向上被吸引，但在另一个方向上被排斥。\n- **不稳定：** 如果所有特征值的实部都为正，即 $\\text{Re}(\\lambda_1) > 0$ 且 $\\text{Re}(\\lambda_2) > 0$，则不动点是不稳定的。从该点附近开始的轨迹将偏离该点。\n\n最后，我们计算“近临界”不动点的数量，其定义为至少有一个特征值的实部绝对值小于 $10^{-3}$ 的不动点。这表明系统接近一个分岔点，在分岔点上动力学的定性性质会发生改变。\n\n**5. 结果汇总**\n\n对于所提供的三个 $\\alpha$ 值中的每一个，都将执行整个程序——定位、精化、雅可比矩阵计算、验证和分类。对于每种情况，我们汇总五个所需的量：不动点总数、稳定点数、鞍点数、雅可比矩阵验证的布尔值以及近临界点数。最终输出的结构是包含每种情况汇总结果的列表。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Finds and analyzes the fixed points of a genetic toggle-switch model\n    for different parameter sets.\n    \"\"\"\n    test_cases = [3.0, 0.5, 1.012948]\n    all_results = []\n\n    for alpha in test_cases:\n        # Define the system of equations as a vector function\n        def f_vec(p, alpha_val):\n            x, y = p\n            f1 = alpha_val / (1 + y**4) - x\n            f2 = alpha_val / (1 + x**4) - y\n            return np.array([f1, f2])\n\n        # Define the analytical Jacobian\n        def analytical_jacobian(p, alpha_val):\n            x, y = p\n            j11 = -1.0\n            j12 = -4 * alpha_val * y**3 / (1 + y**4)**2\n            j21 = -4 * alpha_val * x**3 / (1 + x**4)**2\n            j22 = -1.0\n            return np.array([[j11, j12], [j21, j22]])\n\n        # --- Step 1: Find Fixed Points ---\n        domain_min, domain_max, grid_points = 0.0, 4.0, 201\n        grid = np.linspace(domain_min, domain_max, grid_points)\n        dx = grid[1] - grid[0]\n        \n        # Evaluate the functions on the grid\n        xv, yv = np.meshgrid(grid, grid)\n        f1_vals, f2_vals = f_vec([xv, yv], alpha)\n\n        initial_guesses = []\n        for i in range(grid_points - 1):\n            for j in range(grid_points - 1):\n                # Check for sign change of f1 in the cell\n                f1_cell_vals = f1_vals[j:j+2, i:i+2]\n                f1_has_zerocross = np.min(f1_cell_vals)  0 and np.max(f1_cell_vals) > 0\n\n                # Check for sign change of f2 in the cell\n                f2_cell_vals = f2_vals[j:j+2, i:i+2]\n                f2_has_zerocross = np.min(f2_cell_vals)  0 and np.max(f2_cell_vals) > 0\n\n                if f1_has_zerocross and f2_has_zerocross:\n                    guess = [grid[i] + dx/2, grid[j] + dx/2]\n                    initial_guesses.append(guess)\n        \n        # Refine guesses and filter for unique fixed points\n        found_fps = []\n        for guess in initial_guesses:\n            sol = root(f_vec, guess, args=(alpha,), method='hybr')\n            if sol.success:\n                fp = sol.x\n                # Check if in domain and unique\n                if np.all(fp >= domain_min) and np.all(fp = domain_max):\n                    is_unique = True\n                    for old_fp in found_fps:\n                        if np.linalg.norm(fp - old_fp)  1e-5:\n                            is_unique = False\n                            break\n                    if is_unique:\n                        found_fps.append(fp)\n        \n        # --- Step 2: Analyze each fixed point ---\n        total_fps = len(found_fps)\n        stable_fps = 0\n        saddle_fps = 0\n        all_jacobians_match = True\n        near_critical_fps = 0\n\n        for fp in found_fps:\n            x_fp, y_fp = fp\n\n            # Analytical Jacobian\n            j_an = analytical_jacobian(fp, alpha)\n\n            # Numerical Jacobian (Central Differences)\n            hx = 1e-4 * max(1, abs(x_fp))\n            hy = 1e-4 * max(1, abs(y_fp))\n            \n            f1_dx = (f_vec([x_fp + hx, y_fp], alpha)[0] - f_vec([x_fp - hx, y_fp], alpha)[0]) / (2 * hx)\n            f1_dy = (f_vec([x_fp, y_fp + hy], alpha)[0] - f_vec([x_fp, y_fp - hy], alpha)[0]) / (2 * hy)\n            f2_dx = (f_vec([x_fp + hx, y_fp], alpha)[1] - f_vec([x_fp - hx, y_fp], alpha)[1]) / (2 * hx)\n            f2_dy = (f_vec([x_fp, y_fp + hy], alpha)[1] - f_vec([x_fp, y_fp - hy], alpha)[1]) / (2 * hy)\n            j_num = np.array([[f1_dx, f1_dy], [f2_dx, f2_dy]])\n            \n            # Validate Jacobians\n            if np.max(np.abs(j_an - j_num)) >= 1e-5:\n                all_jacobians_match = False\n            \n            # Eigenvalue analysis using analytical Jacobian\n            eigenvalues = np.linalg.eigvals(j_an)\n            real_parts = np.real(eigenvalues)\n\n            # Classify stability\n            if np.all(real_parts  0):\n                stable_fps += 1\n            if np.linalg.det(j_an)  0:\n                saddle_fps += 1\n            \n            # Check for near-criticality\n            if np.any(np.abs(real_parts)  1e-3):\n                near_critical_fps += 1\n\n        case_results = [\n            total_fps,\n            stable_fps,\n            saddle_fps,\n            all_jacobians_match,\n            near_critical_fps\n        ]\n        all_results.append(case_results)\n\n    # Format output as a string representing a list of lists.\n    inner_strs = []\n    for res in all_results:\n        inner_strs.append(f\"[{res[0]}, {res[1]}, {res[2]}, {res[3]}, {res[4]}]\")\n    print(f\"[{', '.join(inner_strs)}]\")\n\n# solve() # The function is defined but not called here to avoid execution in this block.\n# The expected output from running solve() is placed in the answer tag.\n```",
            "answer": "$$\n\\boxed{[[3, 2, 1, True, 0], [1, 1, 0, True, 0], [1, 1, 0, True, 1]]}\n$$"
        }
    ]
}