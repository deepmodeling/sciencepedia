{
    "hands_on_practices": [
        {
            "introduction": "Our first practice establishes a cornerstone concept in microbial synthetic biology: the apparent \"loss\" of stable molecules due to cellular growth and division. By deriving the kinetics of dilution from first principles of mass conservation, you will build a foundational understanding of how growth rate directly influences protein concentration. This exercise  is crucial for interpreting gene expression dynamics in any growing cell population, revealing that for stable species, the effective half-life can be determined solely by the cell's doubling time.",
            "id": "3922357",
            "problem": "A microbial cell in balanced exponential growth has a cytoplasmic protein whose concentration $x(t)$ is regulated by synthesis and loss processes. Assume a well-mixed cytoplasm and no secretion. The protein has no active degradation, so the first-order proteolysis rate constant is $\\delta_{p}=0$. The cell volume $V(t)$ grows exponentially at a constant specific growth rate $\\mu$, and protein synthesis capacity scales with volume so that the volumetric production rate is constant, equal to $\\alpha$.\n\nStarting from mass conservation at the molecule-number level $N(t)$ and the definition of concentration $x(t)=N(t)/V(t)$, and using the kinematics of exponential volume growth $dV/dt=\\mu V$, derive the ordinary differential equation (ODE) governing $x(t)$ when dilution is the only loss process. Then, determine the steady-state concentration $x^{*}$ under these conditions. Express your final answer as a single closed-form analytic expression in terms of $\\alpha$ and $\\mu$; do not include units.",
            "solution": "The problem requires the derivation of the ordinary differential equation (ODE) for the concentration $x(t)$ of a protein in a growing cell, and the subsequent determination of its steady-state value, $x^*$. The derivation must begin from the principle of mass conservation at the level of the number of protein molecules, $N(t)$.\n\nLet $N(t)$ be the total number of protein molecules in the cell at time $t$, and let $V(t)$ be the cell volume at time $t$. The concentration of the protein is defined as:\n$$ x(t) = \\frac{N(t)}{V(t)} $$\n\nThe rate of change of the number of molecules, $\\frac{dN}{dt}$, is governed by the balance between production and loss.\n$$ \\frac{dN}{dt} = (\\text{Rate of Production}) - (\\text{Rate of Loss}) $$\n\nThe problem states that the volumetric production rate is a constant, $\\alpha$. The total number of molecules produced per unit time is this rate multiplied by the cell volume, $V(t)$.\n$$ \\text{Rate of Production} = \\alpha V(t) $$\n\nFor the loss of molecules, the problem specifies that the protein has no active degradation. This means the first-order degradation rate constant $\\delta_p$ is zero, and the total rate of loss of molecules is also zero.\n$$ \\text{Rate of Loss} = \\delta_p N(t) = 0 $$\n\nSubstituting the production and loss rates into the mass balance equation for $N(t)$ yields:\n$$ \\frac{dN}{dt} = \\alpha V(t) - 0 = \\alpha V(t) $$\n\nTo find the ODE for the concentration $x(t)$, we differentiate the definition $x(t) = N(t)/V(t)$ with respect to time $t$ using the quotient rule for differentiation:\n$$ \\frac{dx}{dt} = \\frac{d}{dt} \\left( \\frac{N(t)}{V(t)} \\right) = \\frac{V(t) \\frac{dN}{dt} - N(t) \\frac{dV}{dt}}{[V(t)]^2} $$\nThis can be rewritten as:\n$$ \\frac{dx}{dt} = \\frac{1}{V(t)} \\frac{dN}{dt} - \\frac{N(t)}{[V(t)]^2} \\frac{dV}{dt} $$\n\nWe have expressions for $\\frac{dN}{dt}$ and $\\frac{dV}{dt}$. The problem states that the cell volume grows exponentially at a specific growth rate $\\mu$, which is described by the kinematic equation:\n$$ \\frac{dV}{dt} = \\mu V(t) $$\nWe can now substitute the expressions for $\\frac{dN}{dt}$ and $\\frac{dV}{dt}$ into the equation for $\\frac{dx}{dt}$:\n$$ \\frac{dx}{dt} = \\frac{1}{V(t)} (\\alpha V(t)) - \\frac{N(t)}{[V(t)]^2} (\\mu V(t)) $$\n\nSimplifying the terms:\n$$ \\frac{dx}{dt} = \\alpha - \\frac{N(t)}{V(t)} \\mu $$\nRecognizing that $x(t) = N(t)/V(t)$, we can substitute $x(t)$ into the equation:\n$$ \\frac{dx}{dt} = \\alpha - \\mu x(t) $$\nThis is the ordinary differential equation governing the protein concentration $x(t)$. The term $\\alpha$ represents the increase in concentration due to synthesis, and the term $-\\mu x(t)$ represents the decrease in concentration due to dilution as the cell volume increases.\n\nNext, we determine the steady-state concentration, denoted as $x^*$. By definition, steady state is the condition where the concentration no longer changes with time. Mathematically, this means $\\frac{dx}{dt} = 0$.\nSetting the derivative in our ODE to zero:\n$$ 0 = \\alpha - \\mu x^* $$\n\nSolving for $x^*$:\n$$ \\mu x^* = \\alpha $$\n$$ x^* = \\frac{\\alpha}{\\mu} $$\nThis is the steady-state concentration of the protein, which is achieved when the rate of increase in concentration from synthesis is exactly balanced by the rate of decrease from dilution due to cell growth. The final expression is in terms of the given parameters $\\alpha$ and $\\mu$.",
            "answer": "$$\n\\boxed{\\frac{\\alpha}{\\mu}}\n$$"
        },
        {
            "introduction": "Moving from theory to application, this practice tackles the real-world challenge of estimating kinetic parameters from experimental data. You will implement a Weighted Least Squares (WLS) regression to analyze a simulated mRNA decay experiment, learning why this method is superior when dealing with realistic, heteroscedastic measurement noise . This computational exercise builds essential skills for extracting meaningful parameters from fluorescence time-course data, where measurement variance often depends on signal intensity.",
            "id": "3922320",
            "problem": "You are given a promoter shutoff time course for messenger ribonucleic acid (mRNA) fluorescence per cell, measured with replicates across discrete time points after transcription stops. After promoter shutoff, transcription ceases and mRNA dynamics follow first-order loss due to degradation and dilution by cell growth. Assume the mRNA amount per cell, denoted by $M(t)$, evolves according to the ordinary differential equation $dM/dt = -(\\lambda_m + \\mu) M(t)$, where $\\lambda_m$ is the mRNA degradation rate (in $\\mathrm{min}^{-1}$) and $\\mu$ is the per-capita growth rate (in $\\mathrm{min}^{-1}$) that produces dilution. The solution under shutdown conditions is $M(t) = M_0 \\exp(-(\\lambda_m + \\mu) t)$, where $M_0$ is the initial mRNA fluorescence at $t=0$.\n\nYour measurement device reports fluorescence per cell that is heteroscedastic due to photon shot noise and technical background. Model one replicate observation at time $t_i$ as $Y_{i,r} = M_0 \\exp(-(\\lambda_m + \\mu) t_i) + \\varepsilon_{i,r}$ for replicate index $r$, with $\\mathbb{E}[\\varepsilon_{i,r}] = 0$ and $\\operatorname{Var}(\\varepsilon_{i,r}) = \\sigma_b^2 + \\phi M_0 \\exp(-(\\lambda_m + \\mu) t_i)$, where $\\sigma_b^2$ is the background variance (in fluorescence squared) and $\\phi$ is a proportionality constant reflecting mean-dependent shot noise. Because variance increases with the mean, the data are heteroscedastic. You must estimate $\\lambda_m$ using Weighted Least Squares (WLS), defined as minimizing the weighted sum of squared residuals with weights equal to the inverse of the error variance at each observation. Use replicate data to estimate the empirical variance at each time point, and justify weighting by the heteroscedastic variance model.\n\nImplement a program that:\n- Generates synthetic replicate datasets for four test cases using a fixed seed for reproducibility ($12345$) and the heteroscedastic noise model above. For each time point $t_i$, draw $n_i$ replicate observations $Y_{i,r}$ independently from a Normal distribution with mean $M_0 \\exp(-(\\lambda_m + \\mu) t_i)$ and variance $\\sigma_b^2 + \\phi M_0 \\exp(-(\\lambda_m + \\mu) t_i)$. Clip any negative draws to a small positive value to reflect nonnegative fluorescence.\n- Estimates $(M_0, k_{\\text{tot}})$ with $k_{\\text{tot}} = \\lambda_m + \\mu$ by solving a nonlinear Weighted Least Squares problem on the original (non-log) scale, using weights equal to the inverse of the empirical variance computed from replicates at each time point. Specifically, minimize $\\sum_{i,r} w_i \\left(Y_{i,r} - M_0 \\exp(-k_{\\text{tot}} t_i)\\right)^2$ with $w_i = 1/\\widehat{\\operatorname{Var}}(Y_{i,\\cdot})$, where $\\widehat{\\operatorname{Var}}(Y_{i,\\cdot})$ is the sample variance across replicates at time $t_i$. Use bounds to enforce $M_0 > 0$ and $k_{\\text{tot}} > 0$. Initialize by a linear regression of $\\log$-means versus time to obtain a starting value for $k_{\\text{tot}}$ and $M_0$.\n- Computes $\\widehat{\\lambda}_m = \\widehat{k}_{\\text{tot}} - \\mu$ for each test case.\n\nExpress the final answers in $\\mathrm{min}^{-1}$ and round to $6$ decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3]$).\n\nUse the following test suite of parameter values (all times in minutes, rates in $\\mathrm{min}^{-1}$, fluorescence in arbitrary units). For each case, use the specified time grid $\\{t_i\\}$, number of replicates per time point $n_i$, and noise parameters $(\\phi, \\sigma_b)$:\n- Case $1$ (general case): $M_0=1200$, $\\lambda_m=0.06$, $\\mu=0.01$, $\\phi=0.25$, $\\sigma_b=12$, $t_i \\in \\{0,5,10,15,20,25,30,35,40,45,50,55,60\\}$, $n_i=10$ for all $i$.\n- Case $2$ (fast decay): $M_0=1500$, $\\lambda_m=0.20$, $\\mu=0.005$, $\\phi=0.30$, $\\sigma_b=10$, $t_i \\in \\{0,3,6,9,12,15,18,21,24,27,30\\}$, $n_i=12$ for all $i$.\n- Case $3$ (no dilution, fewer replicates): $M_0=800$, $\\lambda_m=0.08$, $\\mu=0$, $\\phi=0.15$, $\\sigma_b=20$, $t_i \\in \\{0,5,10,15,20,25,30,35,40,45,50\\}$, $n_i=6$ for all $i$.\n- Case $4$ (larger initial fluorescence and stronger heteroscedasticity): $M_0=2000$, $\\lambda_m=0.04$, $\\mu=0.02$, $\\phi=0.50$, $\\sigma_b=5$, $t_i \\in \\{0,6,12,18,24,30,36,42,48,54,60\\}$, $n_i=9$ for all $i$.\n\nYour implementation must justify the WLS weighting based on the heteroscedastic variance model. The final output of your program must be a single line in the format $[\\widehat{\\lambda}_{m,1},\\widehat{\\lambda}_{m,2},\\widehat{\\lambda}_{m,3},\\widehat{\\lambda}_{m,4}]$, where each entry is a float rounded to $6$ decimal places, with no spaces.",
            "solution": "The problem requires the estimation of the messenger RNA (mRNA) degradation rate, $\\lambda_m$, from synthetic promoter shutoff time course data. The estimation must account for the heteroscedastic nature of the measurement noise.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Governing ODE for mRNA amount per cell $M(t)$:** $\\frac{dM}{dt} = -(\\lambda_m + \\mu) M(t)$, where $\\lambda_m$ is the mRNA degradation rate ($\\mathrm{min}^{-1}$) and $\\mu$ is the per-capita growth rate ($\\mathrm{min}^{-1}$).\n- **Solution to the ODE:** $M(t) = M_0 \\exp(-(\\lambda_m + \\mu) t)$, where $M_0$ is the initial mRNA amount at time $t=0$. Let $k_{\\text{tot}} = \\lambda_m + \\mu$. The model is $M(t) = M_0 \\exp(-k_{\\text{tot}} t)$.\n- **Observation Model:** A single replicate observation $Y_{i,r}$ at time $t_i$ for replicate $r$ is given by $Y_{i,r} = M_0 \\exp(-k_{\\text{tot}} t_i) + \\varepsilon_{i,r}$.\n- **Error Structure:** The error term $\\varepsilon_{i,r}$ has mean $\\mathbb{E}[\\varepsilon_{i,r}] = 0$ and a heteroscedastic variance $\\operatorname{Var}(\\varepsilon_{i,r}) = \\sigma_b^2 + \\phi M_0 \\exp(-k_{\\text{tot}} t_i)$, where $\\sigma_b^2$ is the background variance and $\\phi$ is a shot noise proportionality constant.\n- **Data Generation:** Replicates $Y_{i,r}$ are to be drawn from a Normal distribution $\\mathcal{N}(M(t_i), \\sigma_b^2 + \\phi M(t_i))$. Negative draws are clipped to a small positive value. A fixed seed of $12345$ must be used.\n- **Estimation Method:** Weighted Least Squares (WLS) must be used to estimate parameters $(M_0, k_{\\text{tot}})$.\n- **WLS Cost Function:** Minimize $\\sum_{i,r} w_i \\left(Y_{i,r} - M_0 \\exp(-k_{\\text{tot}} t_i)\\right)^2$.\n- **Weights:** The weights are defined as the inverse of the empirical variance at each time point, $w_i = 1/\\widehat{\\operatorname{Var}}(Y_{i,\\cdot})$, where $\\widehat{\\operatorname{Var}}(Y_{i,\\cdot})$ is the sample variance across replicates at time $t_i$.\n- **Constraints:** The estimation must enforce $M_0 > 0$ and $k_{\\text{tot}} > 0$.\n- **Initialization:** Use a linear regression of the natural logarithm of the mean replicate values versus time to find initial guesses for $M_0$ and $k_{\\text{tot}}$.\n- **Final Calculation:** $\\widehat{\\lambda}_m = \\widehat{k}_{\\text{tot}} - \\mu$.\n- **Test Cases:** Four specific sets of parameters $(M_0, \\lambda_m, \\mu, \\phi, \\sigma_b)$, time points $\\{t_i\\}$, and number of replicates $n_i$ are provided.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The problem is scientifically sound. The first-order decay model, $dM/dt = -k M$, is a cornerstone of chemical and biological kinetics, accurately describing processes like mRNA degradation and dilution in growing cell populations. The heteroscedastic noise model, comprising a constant background term ($\\sigma_b^2$) and a mean-proportional term ($\\phi M$), is a realistic representation of noise in fluorescence-based biological measurements, accounting for both detector noise and photon shot noise.\n- **Well-Posed:** The problem is well-posed. It provides all necessary information: a clear generative model for the data, a specific estimation procedure (WLS with empirical weights), and a complete set of parameters for all test cases. The objective is to recover parameters from synthetic data generated from the same model class, which is a standard and well-defined task in computational statistics.\n- **Objective:** The problem is stated with complete objectivity using precise mathematical and algorithmic language. There are no subjective elements.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ambiguity. All terms are well-defined, and the task is a standard, non-trivial problem in biophysical data analysis.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe core of the problem is to estimate the parameters $M_0$ and $k_{\\text{tot}} = \\lambda_m + \\mu$ of the exponential decay model $M(t) = M_0 \\exp(-k_{\\text{tot}} t)$ from heteroscedastic time-series data. The final goal is to report the estimated degradation rate, $\\widehat{\\lambda}_m = \\widehat{k}_{\\text{tot}} - \\mu$.\n\n**Justification for Weighted Least Squares (WLS)**\n\nThe specified observation model indicates that the variance of the measurements is not constant. Specifically, $\\operatorname{Var}(Y_{i,r}) = \\sigma_i^2 = \\sigma_b^2 + \\phi M(t_i)$. Since the mean signal $M(t_i)$ changes over time, the variance $\\sigma_i^2$ also changes, a condition known as heteroscedasticity.\n\nStandard Ordinary Least Squares (OLS) assumes homoscedasticity (i.e., constant variance) for all observations. When this assumption is violated, OLS is no longer the Best Linear Unbiased Estimator (BLUE). It gives equal influence to all data points, even though some are much more precise (lower variance) than others. This can lead to inefficient and potentially biased estimates.\n\nWeighted Least Squares (WLS) corrects for heteroscedasticity by assigning a weight to each data point, typically inversely proportional to its variance. The objective function for WLS is to minimize the weighted sum of squared residuals:\n$$ \\text{WSSR} = \\sum_{i} \\sum_{r} w_i \\left(Y_{i,r} - M(t_i; M_0, k_{\\text{tot}})\\right)^2 $$\nAccording to the Gauss-Markov theorem and its extension to nonlinear regression, the most efficient (minimum variance) estimates are obtained when the weights are the inverse of the true variance of the observations, $w_i = 1/\\sigma_i^2$.\n\nIn this problem, the true variance $\\sigma_i^2$ is unknown because it depends on the true parameters. However, we are provided with replicate measurements at each time point $t_i$. This allows us to compute the sample variance for each group of replicates:\n$$ \\widehat{\\sigma}_i^2 = \\widehat{\\operatorname{Var}}(Y_{i,\\cdot}) = \\frac{1}{n_i-1} \\sum_{r=1}^{n_i} (Y_{i,r} - \\bar{Y}_{i,\\cdot})^2 $$\nwhere $\\bar{Y}_{i,\\cdot}$ is the sample mean at time $t_i$. This sample variance $\\widehat{\\sigma}_i^2$ serves as a consistent estimate of the true underlying variance $\\sigma_i^2$. By setting the weights $w_i = 1/\\widehat{\\sigma}_i^2$, we implement a feasible and statistically robust WLS procedure that properly accounts for the heteroscedasticity defined in the problem, yielding more accurate parameter estimates than an unweighted approach.\n\n**Step-by-Step Implementation Plan**\n\nFor each of the four test cases:\n\n1.  **Data Synthesis:** With a fixed random seed ($12345$), generate synthetic data. For each time point $t_i$ in the specified grid:\n    a. Calculate the true mean fluorescence: $M(t_i) = M_0 \\exp(-k_{\\text{tot}} t_i)$.\n    b. Calculate the true measurement variance: $\\sigma_i^2 = \\sigma_b^2 + \\phi M(t_i)$.\n    c. Draw $n_i$ replicate samples $Y_{i,r}$ from a normal distribution $\\mathcal{N}(M(t_i), \\sigma_i^2)$.\n    d. Clip any resulting negative fluorescence values to a small positive constant (e.g., $10^{-9}$) to ensure physical realism and numerical stability for logarithmic transformations.\n\n2.  **Initial Parameter Guess:** The nonlinear WLS optimization requires initial starting values for the parameters $(M_0, k_{\\text{tot}})$. A robust method is to linearize the model by taking the natural logarithm: $\\ln(M(t)) = \\ln(M_0) - k_{\\text{tot}} t$.\n    a. For each time point $t_i$, calculate the sample mean of the generated replicates, $\\bar{Y}_{i,\\cdot}$.\n    b. Perform a linear regression (e.g., using `numpy.polyfit`) of $\\ln(\\bar{Y}_{i,\\cdot})$ versus $t_i$. This yields a slope $s$ and an intercept $c$.\n    c. The initial guesses are then $k_{\\text{tot},0} = -s$ and $M_{0,0} = \\exp(c)$.\n\n3.  **Nonlinear Weighted Least Squares:**\n    a. Calculate the empirical sample variance $\\widehat{\\sigma}_i^2$ for the replicates at each time point $t_i$. To prevent division by zero, any variance calculated to be zero will be set to a small positive number.\n    b. The weights for all replicates at time $t_i$ are $w_i = 1/\\widehat{\\sigma}_i^2$.\n    c. Define a residual function that, for a given set of parameters $(M_0, k_{\\text{tot}})$, computes the vector of weighted residuals for all data points $(i, r)$:\n       $$ \\text{res}_{i,r} = \\sqrt{w_i} \\left(Y_{i,r} - M_0 \\exp(-k_{\\text{tot}} t_i) \\right) $$\n    d. Use `scipy.optimize.least_squares` to find the parameters $(\\widehat{M}_0, \\widehat{k}_{\\text{tot}})$ that minimize the sum of squares of these residuals. The optimization will be constrained with bounds $M_0 > 0$ and $k_{\\text{tot}} > 0$.\n\n4.  **Calculate $\\widehat{\\lambda}_m$:**\n    a. From the WLS optimization, extract the estimated total decay rate, $\\widehat{k}_{\\text{tot}}$.\n    b. Calculate the estimated degradation rate using the known growth rate $\\mu$: $\\widehat{\\lambda}_m = \\widehat{k}_{\\text{tot}} - \\mu$.\n    c. Round the result to $6$ decimal places as required.\n\nThis procedure will be repeated for all four test cases to generate the final list of estimated degradation rates.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves for the mRNA degradation rate lambda_m for four test cases\n    using a Weighted Least Squares (WLS) optimization procedure.\n    \"\"\"\n    test_cases = [\n        {\n            \"M0\": 1200.0, \"lambda_m\": 0.06, \"mu\": 0.01, \"phi\": 0.25, \"sigma_b\": 12.0,\n            \"times\": np.array([0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60]),\n            \"n_replicates\": 10\n        },\n        {\n            \"M0\": 1500.0, \"lambda_m\": 0.20, \"mu\": 0.005, \"phi\": 0.30, \"sigma_b\": 10.0,\n            \"times\": np.array([0, 3, 6, 9, 12, 15, 18, 21, 24, 27, 30]),\n            \"n_replicates\": 12\n        },\n        {\n            \"M0\": 800.0, \"lambda_m\": 0.08, \"mu\": 0.0, \"phi\": 0.15, \"sigma_b\": 20.0,\n            \"times\": np.array([0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50]),\n            \"n_replicates\": 6\n        },\n        {\n            \"M0\": 2000.0, \"lambda_m\": 0.04, \"mu\": 0.02, \"phi\": 0.50, \"sigma_b\": 5.0,\n            \"times\": np.array([0, 6, 12, 18, 24, 30, 36, 42, 48, 54, 60]),\n            \"n_replicates\": 9\n        }\n    ]\n\n    estimated_lambda_m = []\n    \n    # Use a fixed seed for reproducibility.\n    rng = np.random.default_rng(12345)\n    \n    # Epsilon for clipping negative values and avoiding division by zero.\n    epsilon = 1e-9\n\n    for case in test_cases:\n        # Step 1: Generate synthetic data\n        true_k_tot = case[\"lambda_m\"] + case[\"mu\"]\n        \n        all_replicates = []\n        empirical_means = []\n        empirical_vars = []\n\n        for t in case[\"times\"]:\n            mean_val = case[\"M0\"] * np.exp(-true_k_tot * t)\n            variance = case[\"sigma_b\"]**2 + case[\"phi\"] * mean_val\n            std_dev = np.sqrt(variance)\n            \n            reps = rng.normal(loc=mean_val, scale=std_dev, size=case[\"n_replicates\"])\n            # Clip negative fluorescence values\n            reps[reps < epsilon] = epsilon\n            \n            all_replicates.append(reps)\n            empirical_means.append(np.mean(reps))\n            # Use ddof=1 for an unbiased sample variance estimate\n            empirical_vars.append(np.var(reps, ddof=1))\n        \n        empirical_means = np.array(empirical_means)\n        empirical_vars = np.array(empirical_vars)\n\n        # Step 2: WLS preparation and initial guess\n        # Avoid zero variance for weight calculation\n        empirical_vars[empirical_vars < epsilon] = epsilon\n        weights_per_timepoint = 1.0 / empirical_vars\n        \n        # Initial guess from log-linear regression\n        # Filter out any non-positive means before taking the log\n        valid_points = empirical_means > 0\n        if np.sum(valid_points) < 2: # Not enough points for a fit\n             # Fallback initial guess\n            k_tot_init = 0.1\n            m0_init = case[\"M0\"]\n        else:\n            slope, intercept = np.polyfit(\n                case[\"times\"][valid_points],\n                np.log(empirical_means[valid_points]),\n                1\n            )\n            k_tot_init = -slope\n            m0_init = np.exp(intercept)\n\n        # Prepare flattened arrays for scipy.optimize.least_squares\n        y_flat = np.concatenate(all_replicates)\n        t_flat = np.repeat(case[\"times\"], case[\"n_replicates\"])\n        w_flat_sqrt = np.sqrt(np.repeat(weights_per_timepoint, case[\"n_replicates\"]))\n\n        # Step 3: Nonlinear Weighted Least Squares optimization\n        def residuals(params, t, y, w_sqrt):\n            m0, k_tot = params\n            model_y = m0 * np.exp(-k_tot * t)\n            return w_sqrt * (y - model_y)\n\n        initial_params = [m0_init, k_tot_init]\n        bounds = ([epsilon, epsilon], [np.inf, np.inf])\n        \n        result = least_squares(\n            residuals,\n            initial_params,\n            bounds=bounds,\n            args=(t_flat, y_flat, w_flat_sqrt),\n            method='trf' # Trust Region Reflective, good for bounds\n        )\n        \n        m0_hat, k_tot_hat = result.x\n        \n        # Step 4: Calculate lambda_m\n        lambda_m_hat = k_tot_hat - case[\"mu\"]\n        estimated_lambda_m.append(lambda_m_hat)\n        \n    # Format and print the final output\n    formatted_results = [f\"{val:.6f}\" for val in estimated_lambda_m]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A robust analysis requires more than just fitting a model; it demands a critical evaluation of the model's underlying assumptions. This final, advanced practice explores the consequences of model misspecification, a common pitfall in analyzing dynamic biological data . By working through a hypothetical scenario where a non-constant growth rate is incorrectly assumed to be constant, you will derive how this error systematically biases parameter estimates and, crucially, how to diagnose the issue by examining the characteristic structure of the model's residuals.",
            "id": "3922313",
            "problem": "A cell population growing in batch culture experiences time-varying biomass accumulation, causing dilution of intracellular molecules. For messenger ribonucleic acid (mRNA) that is transcriptionally shut off at time $t=0$, the concentration $m(t)$ obeys first-order loss due to molecular degradation and dilution by growth. The Central Dogma and mass-action loss imply the balance $\\frac{d m}{d t} = -(\\delta + \\mu(t))\\,m(t)$ for $t \\ge 0$, where $\\delta$ is the molecular degradation rate constant and $\\mu(t)$ is the instantaneous specific growth rate that induces dilution. Consider the following counterexample scenario: the true mRNA degradation rate is time-independent and constant at $\\delta$, but the growth rate increases linearly in time according to $\\mu(t) = \\mu_{0} + \\beta t$ with $\\beta \\neq 0$.\n\nYou collect measurements of $\\ln m(t)$ over the interval $t \\in [0, T]$ after transcription shutoff. A standard analysis in synthetic biology modeling fits a straight line to the log-transformed trajectory $\\ln m(t)$ over $[0, T]$ using Ordinary Least Squares (OLS), treating the slope as an estimate of a constant total loss rate. In this analysis, suppose one incorrectly assumes the growth-dilution rate is constant and equal to $\\mu_{0}$ when interpreting the slope, and thus defines the estimated degradation rate as the slope magnitude minus $\\mu_{0}$. Let $\\hat{b}$ and $\\hat{a}$ denote the OLS slope and intercept, respectively, for the continuous-time, uniformly weighted fit over $[0, T]$ to the model $\\ln m(t) \\approx \\hat{a} + \\hat{b}\\,t$.\n\nStarting only from the governing loss equation $\\frac{d m}{d t} = -(\\delta + \\mu(t))\\,m(t)$ with $\\mu(t) = \\mu_{0} + \\beta t$, and the definitions of OLS estimators $\\hat{b}$ and $\\hat{a}$ for a continuous uniform design on $[0, T]$, derive two quantities that together demonstrate how variable growth $\\mu(t)$ can mimic changes in $\\delta$ and how to diagnose this with residual analysis:\n1. The mis-specified degradation estimate $\\hat{\\delta}$ obtained by subtracting $\\mu_{0}$ from the magnitude of the fitted slope on $\\ln m(t)$.\n2. The residual function $R(t) = \\ln m(t) - (\\hat{a} + \\hat{b}\\,t)$ across $t \\in [0, T]$.\n\nExpress both results in closed form as analytic expressions in terms of $\\delta$, $\\mu_{0}$, $\\beta$, $T$, and $t$. No rounding is required. Provide your final answer as the pair $\\hat{\\delta}$ and $R(t)$ written together as a single row matrix using the LaTeX $\\mathrm{pmatrix}$ environment.",
            "solution": "The problem requires the derivation of two quantities: the mis-specified degradation rate estimate, $\\hat{\\delta}$, and the residual function, $R(t)$, for a linear fit to a non-linear decay process. The derivation begins with the solution to the governing ordinary differential equation for mRNA concentration, $m(t)$.\n\nFirst, we solve the governing equation for $m(t)$:\n$$\n\\frac{d m}{d t} = -(\\delta + \\mu(t))\\,m(t)\n$$\nGiven the specific growth rate $\\mu(t) = \\mu_{0} + \\beta t$, the equation becomes:\n$$\n\\frac{d m}{d t} = -(\\delta + \\mu_{0} + \\beta t)\\,m(t)\n$$\nThis is a first-order linear separable differential equation. We can separate variables and integrate:\n$$\n\\int_{m(0)}^{m(t)} \\frac{d\\tilde{m}}{\\tilde{m}} = -\\int_{0}^{t} (\\delta + \\mu_{0} + \\beta \\tau) d\\tau\n$$\nLet the initial concentration at $t=0$ be $m_0 = m(0)$. The integration yields:\n$$\n\\ln(m(t)) - \\ln(m_0) = - \\left[ (\\delta + \\mu_{0})\\tau + \\frac{\\beta}{2}\\tau^2 \\right]_0^t\n$$\n$$\n\\ln(m(t)) = \\ln(m_0) - (\\delta + \\mu_{0})t - \\frac{\\beta}{2}t^2\n$$\nThis equation describes the true time evolution of the logarithm of the mRNA concentration. It is a quadratic function of time, $t$. Let's denote this true function as $y(t) = \\ln(m(t))$.\n\nNext, we address the Ordinary Least Squares (OLS) fit. The problem states that a linear model, $\\hat{y}(t) = \\hat{a} + \\hat{b}t$, is fitted to $y(t)$ over the continuous interval $t \\in [0, T]$. The OLS estimators $\\hat{a}$ and $\\hat{b}$ are found by minimizing the integrated sum of squared errors, $S = \\int_0^T (y(t) - (\\hat{a} + \\hat{b}t))^2 dt$. The estimators satisfy the normal equations:\n$$\n\\frac{\\partial S}{\\partial \\hat{a}} = 0 \\implies \\int_0^T y(t) dt = \\hat{a} \\int_0^T dt + \\hat{b} \\int_0^T t dt\n$$\n$$\n\\frac{\\partial S}{\\partial \\hat{b}} = 0 \\implies \\int_0^T t y(t) dt = \\hat{a} \\int_0^T t dt + \\hat{b} \\int_0^T t^2 dt\n$$\nWe compute the integrals of powers of $t$ over the interval $[0, T]$:\n$$\n\\int_0^T dt = T\n$$\n$$\n\\int_0^T t dt = \\frac{T^2}{2}\n$$\n$$\n\\int_0^T t^2 dt = \\frac{T^3}{3}\n$$\nAnd the integrals involving $y(t) = \\ln(m_0) - (\\delta + \\mu_{0})t - \\frac{\\beta}{2}t^2$:\n$$\n\\int_0^T y(t) dt = \\int_0^T \\left(\\ln(m_0) - (\\delta + \\mu_{0})t - \\frac{\\beta}{2}t^2\\right) dt = \\ln(m_0) T - (\\delta + \\mu_{0})\\frac{T^2}{2} - \\frac{\\beta}{2}\\frac{T^3}{3}\n$$\n$$\n\\int_0^T t y(t) dt = \\int_0^T \\left(\\ln(m_0)t - (\\delta + \\mu_{0})t^2 - \\frac{\\beta}{2}t^3\\right) dt = \\ln(m_0)\\frac{T^2}{2} - (\\delta + \\mu_{0})\\frac{T^3}{3} - \\frac{\\beta}{2}\\frac{T^4}{4}\n$$\nThe normal equations form a $2 \\times 2$ linear system for $\\hat{a}$ and $\\hat{b}$:\n$$\n\\text{(1)} \\quad \\ln(m_0) T - (\\delta + \\mu_{0})\\frac{T^2}{2} - \\frac{\\beta T^3}{6} = \\hat{a}T + \\hat{b}\\frac{T^2}{2}\n$$\n$$\n\\text{(2)} \\quad \\ln(m_0)\\frac{T^2}{2} - (\\delta + \\mu_{0})\\frac{T^3}{3} - \\frac{\\beta T^4}{8} = \\hat{a}\\frac{T^2}{2} + \\hat{b}\\frac{T^3}{3}\n$$\nTo solve for $\\hat{b}$, we can multiply equation (1) by $\\frac{T}{2}$ and subtract it from equation (2).\n$$\n\\left( \\ln(m_0)\\frac{T^2}{2} - (\\delta + \\mu_{0})\\frac{T^3}{3} - \\frac{\\beta T^4}{8} \\right) - \\left( \\ln(m_0)\\frac{T^2}{2} - (\\delta + \\mu_{0})\\frac{T^3}{4} - \\frac{\\beta T^4}{12} \\right) = \\left( \\hat{a}\\frac{T^2}{2} + \\hat{b}\\frac{T^3}{3} \\right) - \\left( \\hat{a}\\frac{T^2}{2} + \\hat{b}\\frac{T^3}{4} \\right)\n$$\nSimplifying this expression gives:\n$$\n-(\\delta + \\mu_{0})\\left(\\frac{T^3}{3} - \\frac{T^3}{4}\\right) - \\beta\\left(\\frac{T^4}{8} - \\frac{T^4}{12}\\right) = \\hat{b}\\left(\\frac{T^3}{3} - \\frac{T^3}{4}\\right)\n$$\n$$\n-(\\delta + \\mu_{0})\\frac{T^3}{12} - \\beta\\frac{T^4}{24} = \\hat{b}\\frac{T^3}{12}\n$$\nDivide by $\\frac{T^3}{12}$:\n$$\n-(\\delta + \\mu_{0}) - \\frac{\\beta T}{2} = \\hat{b}\n$$\nSo, the OLS slope is $\\hat{b} = -(\\delta + \\mu_0 + \\frac{\\beta T}{2})$.\n\nThe first required quantity is the mis-specified degradation estimate, $\\hat{\\delta}$, defined as the magnitude of the slope minus $\\mu_0$. Since the slope $\\hat{b}$ is negative, its magnitude is $-\\hat{b}$.\n$$\n\\hat{\\delta} = -\\hat{b} - \\mu_0 = -[-(\\delta + \\mu_0 + \\frac{\\beta T}{2})] - \\mu_0\n$$\n$$\n\\hat{\\delta} = \\delta + \\mu_0 + \\frac{\\beta T}{2} - \\mu_0\n$$\n$$\n\\hat{\\delta} = \\delta + \\frac{\\beta T}{2}\n$$\nThis result shows that the estimated degradation rate is biased from the true rate $\\delta$ by a term $\\frac{\\beta T}{2}$, which depends on the rate of change of growth and the experiment duration.\n\nThe second required quantity is the residual function, $R(t) = y(t) - (\\hat{a} + \\hat{b}t)$. To find it, we first need to determine the intercept $\\hat{a}$. From equation (1), after dividing by $T$:\n$$\n\\hat{a} = \\ln(m_0) - (\\delta + \\mu_{0})\\frac{T}{2} - \\frac{\\beta T^2}{6} - \\hat{b}\\frac{T}{2}\n$$\nSubstitute the expression for $\\hat{b}$:\n$$\n\\hat{a} = \\ln(m_0) - (\\delta + \\mu_{0})\\frac{T}{2} - \\frac{\\beta T^2}{6} - \\left(-(\\delta + \\mu_0 + \\frac{\\beta T}{2})\\right)\\frac{T}{2}\n$$\n$$\n\\hat{a} = \\ln(m_0) - (\\delta + \\mu_{0})\\frac{T}{2} - \\frac{\\beta T^2}{6} + (\\delta + \\mu_0)\\frac{T}{2} + \\frac{\\beta T^2}{4}\n$$\n$$\n\\hat{a} = \\ln(m_0) + \\beta T^2 \\left(-\\frac{1}{6} + \\frac{1}{4}\\right) = \\ln(m_0) + \\frac{\\beta T^2}{12}\n$$\nNow we can write the full linear fit:\n$$\n\\hat{a} + \\hat{b}t = \\left(\\ln(m_0) + \\frac{\\beta T^2}{12}\\right) + \\left(-(\\delta + \\mu_0 + \\frac{\\beta T}{2})\\right)t\n$$\nThe residual function is:\n$$\nR(t) = \\ln(m(t)) - (\\hat{a} + \\hat{b}t)\n$$\n$$\nR(t) = \\left(\\ln(m_0) - (\\delta + \\mu_{0})t - \\frac{\\beta}{2}t^2\\right) - \\left[\\left(\\ln(m_0) + \\frac{\\beta T^2}{12}\\right) - \\left(\\delta + \\mu_0 + \\frac{\\beta T}{2}\\right)t\\right]\n$$\nThe terms $\\ln(m_0)$ and $(\\delta+\\mu_0)t$ cancel out:\n$$\nR(t) = -\\frac{\\beta}{2}t^2 - \\frac{\\beta T^2}{12} + \\frac{\\beta T}{2}t\n$$\nFactoring out common terms gives the final expression for the residual function:\n$$\nR(t) = -\\frac{\\beta}{12}(6t^2 - 6Tt + T^2)\n$$\nThis quadratic form of the residual is a characteristic signature of fitting a linear model to data with quadratic curvature, providing a clear diagnostic tool for the model misspecification.\n\nThe two derived quantities are $\\hat{\\delta} = \\delta + \\frac{\\beta T}{2}$ and $R(t) = -\\frac{\\beta}{12}(6t^2 - 6Tt + T^2)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\delta + \\frac{\\beta T}{2} & -\\frac{\\beta}{12}(6t^{2} - 6Tt + T^{2})\n\\end{pmatrix}\n}\n$$"
        }
    ]
}