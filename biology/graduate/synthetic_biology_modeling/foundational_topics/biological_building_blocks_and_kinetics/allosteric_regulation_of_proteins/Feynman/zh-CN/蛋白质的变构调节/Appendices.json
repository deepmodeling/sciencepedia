{
    "hands_on_practices": [
        {
            "introduction": "为了定量描述变构调控，我们首先需要一个数学模型。本练习  将指导你从统计力学的基本原理出发，推导出经典的Monod-Wyman-Changeux (MWC) 模型。这个过程至关重要，因为它揭示了蛋白质的构象状态与配体结合之间的微观相互作用如何产生宏观的结合行为（如协同性）。掌握这一推导将使你对变构领域最重要的模型之一的核心假设和数学结构有深刻的理解。",
            "id": "3905911",
            "problem": "一位合成生物学家正在使用 Monod–Wyman–Changeux (MWC) 模型对一种变构蛋白传感器进行建模，其中蛋白质存在于两种构象状态：舒张态 $R$ 和紧张态 $T$。该蛋白质是一个具有 $n$ 个相同配体结合位点的寡聚体，配体浓度用 $[L]$ 表示。在给定的构象内，结合位点是相同且独立的。设配体在 $R$ 和 $T$ 构象中的解离常数分别为 $K_{R}$ 和 $K_{T}$。在配体浓度为零时，构象平衡由变构常数 $\\mathcal{L}$ 来表征，其定义为在没有配体的情况下，$T$ 系综的统计权重与 $R$ 系综的统计权重之比。\n\n使用统计力学中结合多项式的定义，即结合多项式是所有微观状态的配分函数，按其统计权重加权，并且对于一个解离常数为 $K$ 的构象中结合了 $i$ 个配体的情况，其统计权重正比于 $\\binom{n}{i}\\left(\\frac{[L]}{K}\\right)^{i}$，推导：\n\n- 双构象系统的 MWC 结合多项式 $Q([L])$。\n- 从第一性原理出发，推导分数饱和度 $Y([L])$，其定义为在配体浓度为 $[L]$ 时，每个寡聚体上被占据结合位点的期望分数。您可以利用标准的统计力学恒等式，即对于一个结合多项式 $Q([L])$，结合配体的期望数由 $[L]\\frac{d}{d [L]}\\ln Q([L])$ 给出。\n\n请用 $n$、$[L]$、$K_{R}$、$K_{T}$ 和 $\\mathcal{L}$ 以闭合形式表示您的最终结果。不需要进行数值计算。您的最终答案必须是闭合形式的解析表达式。最终答案中不要包含任何单位或百分比。",
            "solution": "该问题是有效的，因为它科学地基于统计力学的原理以及公认的 Monod-Wyman-Changeux (MWC) 变构模型。该问题提法恰当、客观，并为得出唯一、可验证的解提供了所有必要信息。\n\n目标是为 MWC 模型所描述的变构寡聚体推导结合多项式 $Q([L])$ 和分数饱和度函数 $Y([L])$。推导将按照指定的要求，从统计力学的第一性原理出发。\n\n该系统由一个 $n$ 亚基的寡聚体蛋白组成，存在于两种构象中，即舒张态 $R$ 和紧张态 $T$。配体浓度为 $[L]$。$R$ 态和 $T$ 态的配体解离常数分别为 $K_{R}$ 和 $K_{T}$。变构平衡常数 $\\mathcal{L}$ 是在没有配体时 $T$ 态与 $R$ 态浓度之比。\n\n首先，我们推导结合多项式 $Q([L])$。结合多项式是系统的配分函数，它是所有可能微观状态的统计权重之和。总配分函数 $Q([L])$ 是 $R$ 态系综的配分函数 $Q_R([L])$ 和 $T$ 态系综的配分函数 $Q_T([L])$ 之和。\n$$Q([L]) = Q_R([L]) + Q_T([L])$$\n\n为了构建 $R$ 态系综的配分函数，我们对所有 $R$ 态微观状态的统计权重求和。我们将 $R$ 态下的脱辅基蛋白（未结合配体），记为 $R_0$，设为我们的参考态，其权重为 $1$。问题指出，对于一个解离常数为 $K$ 的构象，具有 $i$ 个结合配体的微观状态的统计权重正比于 $\\binom{n}{i}\\left(\\frac{[L]}{K}\\right)^{i}$。这个权重是相对于同一构象中的脱辅基蛋白而言的。对于 $R$ 态，解离常数为 $K_R$。因此，相对于 $R_0$，一个结合了 $i$ 个配体的 $R$ 态蛋白质的统计权重是 $\\binom{n}{i}\\left(\\frac{[L]}{K_R}\\right)^{i}$。\n\n$R$ 态系综的配分函数 $Q_R([L])$ 是这些权重对所有可能的结合配体数（从 $i=0$ 到 $i=n$）求和：\n$$Q_R([L]) = \\sum_{i=0}^{n} \\binom{n}{i} \\left(\\frac{[L]}{K_R}\\right)^{i}$$\n这个和是 $\\left(1 + \\frac{[L]}{K_R}\\right)^{n}$ 的二项式展开。\n$$Q_R([L]) = \\left(1 + \\frac{[L]}{K_R}\\right)^{n}$$\n\n接下来，我们构建 $T$ 态系综的配分函数 $Q_T([L])$。变构常数 $\\mathcal{L}$ 定义为在没有配体时 $T$ 系综与 $R$ 系综的平衡比。因此，相对于参考态 $R_0$，$T$ 态下的脱辅基蛋白 $T_0$ 的统计权重是 $\\mathcal{L}$。一个结合了 $i$ 个配体的 $T$ 态蛋白质，相对于 $T_0$ 的统计权重是 $\\binom{n}{i}\\left(\\frac{[L]}{K_T}\\right)^{i}$。为了将此权重表示为相对于我们的全局参考态 $R_0$，我们乘以 $T_0$ 的权重，即 $\\mathcal{L}$。因此，该权重为 $\\mathcal{L}\\binom{n}{i}\\left(\\frac{[L]}{K_T}\\right)^{i}$。\n\n$T$ 态系综的配分函数 $Q_T([L])$ 是这些权重之和：\n$$Q_T([L]) = \\sum_{i=0}^{n} \\mathcal{L} \\binom{n}{i} \\left(\\frac{[L]}{K_T}\\right)^{i} = \\mathcal{L} \\sum_{i=0}^{n} \\binom{n}{i} \\left(\\frac{[L]}{K_T}\\right)^{i}$$\n这个和是 $\\mathcal{L}\\left(1 + \\frac{[L]}{K_T}\\right)^{n}$ 的二项式展开。\n$$Q_T([L]) = \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}$$\n\n总的 MWC 结合多项式 $Q([L])$ 是这两个系综的配分函数之和：\n$$Q([L]) = \\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}$$\n这是第一个要求的结果。\n\n接下来，我们推导分数饱和度 $Y([L])$。它定义为被占据结合位点的期望分数，即结合配体的期望数 $\\langle N_B \\rangle$ 除以总位点数 $n$。\n$$Y([L]) = \\frac{\\langle N_B \\rangle}{n}$$\n问题给出了结合配体期望数的统计力学恒等式：\n$$\\langle N_B \\rangle = [L]\\frac{d}{d[L]}\\ln Q([L])$$\n使用求导的链式法则，这可以写作：\n$$\\langle N_B \\rangle = [L] \\frac{1}{Q([L])} \\frac{d Q([L])}{d[L]}$$\n我们必须首先计算 $Q([L])$ 对 $[L]$ 的导数：\n$$\\frac{d Q([L])}{d[L]} = \\frac{d}{d[L]} \\left[ \\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n} \\right]$$\n应用幂法则和链式法则：\n$$\\frac{d Q([L])}{d[L]} = n \\left(1 + \\frac{[L]}{K_R}\\right)^{n-1} \\left(\\frac{1}{K_R}\\right) + \\mathcal{L} n \\left(1 + \\frac{[L]}{K_T}\\right)^{n-1} \\left(\\frac{1}{K_T}\\right)$$\n现在我们把这个代入 $\\langle N_B \\rangle$ 的表达式中：\n$$\\langle N_B \\rangle = \\frac{[L] \\left[ n \\left(1 + \\frac{[L]}{K_R}\\right)^{n-1} \\frac{1}{K_R} + \\mathcal{L} n \\left(1 + \\frac{[L]}{K_T}\\right)^{n-1} \\frac{1}{K_T} \\right]}{\\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}}$$\n最后，我们将 $\\langle N_B \\rangle$ 除以 $n$ 得到分数饱和度 $Y([L])$：\n$$Y([L]) = \\frac{\\langle N_B \\rangle}{n} = \\frac{[L] \\left[ \\left(1 + \\frac{[L]}{K_R}\\right)^{n-1} \\frac{1}{K_R} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n-1} \\frac{1}{K_T} \\right]}{\\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}}$$\n通过将分子中的 $[L]$ 项分配进去，这个表达式可以重新整理成标准形式：\n$$Y([L]) = \\frac{\\frac{[L]}{K_R} \\left(1 + \\frac{[L]}{K_R}\\right)^{n-1} + \\mathcal{L} \\frac{[L]}{K_T} \\left(1 + \\frac{[L]}{K_T}\\right)^{n-1}}{\\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}}$$\n这是第二个要求的结果。该表达式表示 $R$ 态和 $T$ 态分数饱和度的加权平均值，其中权重是在给定配体浓度 $[L]$ 下蛋白质处于 $R$ 或 $T$ 系综的各自概率。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n} \\\\\n\\frac{\\frac{[L]}{K_R}\\left(1 + \\frac{[L]}{K_R}\\right)^{n-1} + \\mathcal{L} \\frac{[L]}{K_T}\\left(1 + \\frac{[L]}{K_T}\\right)^{n-1}}{\\left(1 + \\frac{[L]}{K_R}\\right)^{n} + \\mathcal{L} \\left(1 + \\frac{[L]}{K_T}\\right)^{n}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "除了为单个蛋白质的行为建模外，一个关键任务是量化突变等扰动如何影响变构通讯。本练习  介绍了一个强大的工具——双突变循环框架，它是一种从热力学角度剖析远距离位点间能量耦合的方法。通过将该方法应用于一组假设的实验数据，你将学会如何精确计算相互作用自由能 $\\Delta G_{\\mathrm{int}}$，从而在理论模型和可测量的生物化学参数之间建立桥梁。",
            "id": "3905993",
            "problem": "一个合成的变构转录因子被设计用于响应一个小分子配体，通过发生构象变化来调节其DNA结合活性。为了量化单点突变和配体结合之间的变构耦合，我们考虑由突变状态和配体占据情况的笛卡尔积定义的四个热力学状态：野生型脱辅基、野生型全息、突变型脱辅基和突变型全息。实验在固定温度 $T$ 下探究这四个状态，并报告了以下可观测量：\n\n- 等温滴定微量热法 (ITC) 测得配体与野生型和突变型蛋白质结合的平衡解离常数分别为：$K_d^{\\mathrm{WT}}$ 和 $K_d^{\\mathrm{M}}$。\n- 在无饱和配体和有饱和配体的情况下，使用氢-氘交换 (HDX) 保护因子来推断在脱辅基和全息背景下，折叠系综中由突变引起的自由能变化。这些数据报告了突变自由能变化 $\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}$ 和 $\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}}$，定义为在指定背景下突变型和野生型之间的标准吉布斯自由能之差。\n\n假设平衡常数和标准吉布斯自由能之间遵循标准热力学关系，并且配体结合是一个可逆的、单价的平衡。将突变视为一种热力学微扰，它改变了脱辅基和全息系综的自由能，但不改变标准态的定义。在 $T=298\\,\\mathrm{K}$ 时获得了以下测量值：\n- $K_d^{\\mathrm{WT}} = 25\\,\\mathrm{nM}$,\n- $K_d^{\\mathrm{M}} = 250\\,\\mathrm{nM}$,\n- $\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}} = 1.800\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n- $\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} = 7.505\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n\n使用基于平衡统计热力学和由平衡常数定义的标准吉布斯自由能的双突变循环框架，计算相互作用（耦合）自由能 $\\Delta G_{\\mathrm{int}}$，它量化了突变和配体结合在能量上的相互作用。请以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示您的最终答案，并将其四舍五入到四位有效数字。您可以假设平衡常数的浓度标准态为 $1\\,\\mathrm{M}$，因此解离常数的比率是无量纲的。",
            "solution": "该问题要求计算一个合成变构蛋白中，单点突变与配体结合之间的相互作用自由能 $\\Delta G_{\\mathrm{int}}$。这是一个双突变循环的经典应用，双突变循环是用于量化能量耦合的热力学框架。该系统可以由四个状态描述，形成一个热力学循环：\n1.  无配体时的野生型蛋白质 (WT_apo)。\n2.  与配体结合的野生型蛋白质 (WT_holo)。\n3.  无配体时的突变型蛋白质 (M_apo)。\n4.  与配体结合的突变型蛋白质 (M_holo)。\n\n设 $G^{\\circ}_{\\mathrm{WT,apo}}$、$G^{\\circ}_{\\mathrm{WT,holo}}$、$G^{\\circ}_{\\mathrm{M,apo}}$ 和 $G^{\\circ}_{\\mathrm{M,holo}}$ 分别为这四个状态的标准吉布斯自由能。连接这些状态的过程的自由能变化定义如下：\n\n与配体结合到野生型蛋白质相关的自由能变化为：\n$$ \\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}} = G^{\\circ}_{\\mathrm{WT,holo}} - G^{\\circ}_{\\mathrm{WT,apo}} $$\n与配体结合到突变型蛋白质相关的自由能变化为：\n$$ \\Delta G_{\\mathrm{bind}}^{\\mathrm{M}} = G^{\\circ}_{\\mathrm{M,holo}} - G^{\\circ}_{\\mathrm{M,apo}} $$\n在无配体（apo 状态）时，突变的自由能变化由 $\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}$ 给出：\n$$ \\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}} = G^{\\circ}_{\\mathrm{M,apo}} - G^{\\circ}_{\\mathrm{WT,apo}} $$\n在有配体（holo 状态）时，突变的自由能变化由 $\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}}$ 给出：\n$$ \\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} = G^{\\circ}_{\\mathrm{M,holo}} - G^{\\circ}_{\\mathrm{WT,holo}} $$\n\n这个热力学循环可以可视化为一个方框：\n$$\n\\begin{CD}\n\\text{WT_apo} @{\\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}}} \\text{WT_holo} \\\\\n@V{\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}}VV @VV{\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}}}V \\\\\n\\text{M_apo} @{\\Delta G_{\\mathrm{bind}}^{\\mathrm{M}}} \\text{M_holo}\n\\end{CD}\n$$\n由于吉布斯自由能是一个状态函数，其变化与所取路径无关。因此，围绕闭合循环的自由能变化总和必须为零。从 WT_apo 开始顺时针遍历循环：\n$$ (\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}) + (\\Delta G_{\\mathrm{bind}}^{\\mathrm{M}}) - (\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}}) - (\\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}}) = 0 $$\n重排此方程可得：\n$$ \\Delta G_{\\mathrm{bind}}^{\\mathrm{M}} - \\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}} = \\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} - \\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}} $$\n这个量就是相互作用自由能 $\\Delta G_{\\mathrm{int}}$，它量化了突变和配体结合之间的能量耦合。一个非零的 $\\Delta G_{\\mathrm{int}}$ 表示存在变构耦合。\n$$ \\Delta G_{\\mathrm{int}} = \\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} - \\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}} = \\Delta G_{\\mathrm{bind}}^{\\mathrm{M}} - \\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}} $$\n\n题目提供了循环四个边的值，使我们能够用两种方法计算 $\\Delta G_{\\mathrm{int}}$，这两种方法的结果必须一致。\n\n方法 1：使用突变自由能。\n题目直接给出了在脱辅基和全息状态下突变的自由能变化：\n$\\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}} = 1.800\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n$\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} = 7.505\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n\n使用定义 $\\Delta G_{\\mathrm{int}} = \\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} - \\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}$：\n$$ \\Delta G_{\\mathrm{int}} = 7.505\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} - 1.800\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} = 5.705\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n\n方法 2：使用配体结合自由能。\n结合的标准吉布斯自由能通过以下方程与平衡解离常数 $K_d$ 相关：\n$$ \\Delta G_{\\mathrm{bind}} = -RT \\ln(K_a) = RT \\ln\\left(\\frac{K_d}{C^\\circ}\\right) $$\n其中 $R$ 是理想气体常数，$T$ 是绝对温度，$C^\\circ$ 是标准浓度（$1\\,\\mathrm{M}$）。\n相互作用能可以计算为结合能之差：\n$$ \\Delta G_{\\mathrm{int}} = \\Delta G_{\\mathrm{bind}}^{\\mathrm{M}} - \\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}} = RT \\ln\\left(\\frac{K_d^{\\mathrm{M}}}{C^\\circ}\\right) - RT \\ln\\left(\\frac{K_d^{\\mathrm{WT}}}{C^\\circ}\\right) $$\n$$ \\Delta G_{\\mathrm{int}} = RT \\ln\\left(\\frac{K_d^{\\mathrm{M}}}{K_d^{\\mathrm{WT}}}\\right) $$\n给定值为：\n$T = 298\\,\\mathrm{K}$\n$K_d^{\\mathrm{WT}} = 25\\,\\mathrm{nM} = 25 \\times 10^{-9}\\,\\mathrm{M}$\n$K_d^{\\mathrm{M}} = 250\\,\\mathrm{nM} = 250 \\times 10^{-9}\\,\\mathrm{M}$\n使用适当单位的气体常数为 $R \\approx 8.31446\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1} = 8.31446 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n\n解离常数的比率为：\n$$ \\frac{K_d^{\\mathrm{M}}}{K_d^{\\mathrm{WT}}} = \\frac{250\\,\\mathrm{nM}}{25\\,\\mathrm{nM}} = 10 $$\n现在，我们可以计算 $\\Delta G_{\\mathrm{int}}$：\n$$ \\Delta G_{\\mathrm{int}} = (8.31446 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (298\\,\\mathrm{K}) \\times \\ln(10) $$\n$$ \\Delta G_{\\mathrm{int}} \\approx (2.47771\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}) \\times (2.30259) $$\n$$ \\Delta G_{\\mathrm{int}} \\approx 5.70509\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} $$\n两种方法的结果是一致的。方法1得到的值 $5.705\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 是直接从提供的自由能变化数据中推导出来的，并且已经以反映输入数据小数位数的适当精度呈现。方法2的值在四舍五入到四位有效数字后，也是 $5.705\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n$\\Delta G_{\\mathrm{int}}$ 的正号表示，与脱辅基状态相比，该突变在配体结合（全息）状态下在能量上更不利（$\\Delta G_{\\mathrm{mut}}^{\\mathrm{holo}} > \\Delta G_{\\mathrm{mut}}^{\\mathrm{apo}}$）。等效地，这意味着配体与突变型蛋白质的结合比与野生型蛋白质的结合更弱（更不利）（$\\Delta G_{\\mathrm{bind}}^{\\mathrm{M}} > \\Delta G_{\\mathrm{bind}}^{\\mathrm{WT}}$，这对应于 $K_d^{\\mathrm{M}} > K_d^{\\mathrm{WT}}$）。这是一个拮抗性或负耦合的例子。\n\n最终答案，四舍五入到四位有效数字，是 $5.705\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。",
            "answer": "$$\\boxed{5.705}$$"
        },
        {
            "introduction": "一个可靠的模型不仅要在物理上合理，其参数还必须能通过实验数据来确定。这项计算练习  将深入探讨参数敏感性分析这一高级主题，该领域通常被称为“模型柔性”(sloppiness)分析。你将通过编程构建MWC模型的雅可比矩阵 $J$，并使用奇异值分解(SVD)来揭示哪些参数组合能被数据很好地约束（“刚性”），哪些则难以确定（“柔性”），这是所有合成生物学建模工作者都应具备的关键技能。",
            "id": "3905852",
            "problem": "考虑用于蛋白质变构调控的 Monod–Wyman–Changeux (MWC) 模型，该模型涉及两种构象状态：松弛态和紧张态。MWC 模型假设每个蛋白质有 $n$ 个相同的配体结合位点，一个变构常数 $L$（在没有配体时，紧张态与松弛态的平衡比率），以及松弛态和紧张态的解离常数分别为 $K_R$ 和 $K_T$。定义 $c$ 为 $c = K_R / K_T$，因此 $K_T = K_R / c$。设配体浓度用 $x$ 表示（单位为 $\\mathrm{M}$）。\n\n松弛态和紧张态系综的结合多项式由下式给出\n$$Z_R(x; K_R, n) = \\left(1 + \\frac{x}{K_R}\\right)^n,$$\n$$Z_T(x; K_T, n) = L \\left(1 + \\frac{x}{K_T}\\right)^n.$$\n处于松弛态的概率为\n$$P_R(x; L, K_R, c, n) = \\frac{Z_R(x; K_R, n)}{Z_R(x; K_R, n) + Z_T(x; K_T, n)},$$\n而对于解离常数为 $K$ 的给定状态，每个位点的分数占据率为\n$$a(x; K) = \\frac{x}{x + K}.$$\n在 MWC 模型下，可观测的每个位点的分数占据率则为\n$$Y(x; L, K_R, c, n) = P_R(x; L, K_R, c, n)\\, a(x; K_R) + \\left[1 - P_R(x; L, K_R, c, n)\\right]\\, a\\!\\left(x; \\frac{K_R}{c}\\right).$$\n\n对于一个包含 $m$ 个配体浓度的向量\n$$\\mathbf{x} = \\left[x_1, x_2, \\dots, x_m\\right],$$\n定义模型输出向量\n$$\\mathbf{y}(\\boldsymbol{\\theta}) = \\left[Y(x_1; \\boldsymbol{\\theta}), Y(x_2; \\boldsymbol{\\theta}), \\dots, Y(x_m; \\boldsymbol{\\theta})\\right]^\\top,$$\n其中参数向量为\n$$\\boldsymbol{\\theta} = \\left[L, K_R, c\\right]^\\top.$$\n雅可比矩阵 $J(\\boldsymbol{\\theta}) \\in \\mathbb{R}^{m \\times 3}$ 是\n$$J(\\boldsymbol{\\theta}) = \\left[\\frac{\\partial \\mathbf{y}}{\\partial L} \\ \\ \\frac{\\partial \\mathbf{y}}{\\partial K_R} \\ \\ \\frac{\\partial \\mathbf{y}}{\\partial c}\\right].$$\n\n您的任务是编写一个程序，对于每个指定的测试用例，使用中心有限差分法构建 $J(\\boldsymbol{\\theta})$，其中每个参数的相对扰动步长为 $s = 10^{-6}$，然后对 $J(\\boldsymbol{\\theta})$ 进行奇异值分解 (SVD)，\n$$J(\\boldsymbol{\\theta}) = U \\Sigma V^\\top,$$\n并报告刚度比\n$$\\rho = \\frac{\\sigma_{\\max}}{\\max(\\sigma_{\\min}, \\tau)},$$\n其中 $\\sigma_{\\max}$ 是最大奇异值，$\\sigma_{\\min}$ 是最小奇异值，$\\tau = 10^{-12}$ 是一个容差，用于防止除以零并处理数值上奇异的雅可比矩阵。\n\n所有配体浓度 $x$ 和解离常数 $K_R$ 都必须以 $\\mathrm{M}$ (摩尔) 单位处理。最终答案是无单位的浮点数。此问题不涉及角度。不涉及百分比。\n\n使用中心有限差分公式为每个参数 $\\theta_j \\in \\{L, K_R, c\\}$ 构建雅可比矩阵：\n$$\\frac{\\partial \\mathbf{y}}{\\partial \\theta_j} \\approx \\frac{\\mathbf{y}(\\theta_j + h_j) - \\mathbf{y}(\\theta_j - h_j)}{2 h_j}, \\quad h_j = s \\, \\theta_j.$$\n\n测试套件：\n对于下面的每个案例，使用指定的参数，并通过在 $x_{\\min}$ 和 $x_{\\max}$ 之间（含两端）以对数方式分隔 $m$ 个点来构建配体浓度向量 $\\mathbf{x}$。\n\n- 案例 1（典型的正协同性）：\n  - $L = 100$\n  - $n = 4$\n  - $K_R = 10^{-6}\\ \\mathrm{M}$\n  - $c = 0.1$\n  - $x_{\\min} = 10^{-9}\\ \\mathrm{M}$\n  - $x_{\\max} = 10^{-4}\\ \\mathrm{M}$\n  - $m = 15$\n- 案例 2（边界情况，几乎非变构）：\n  - $L = 1$\n  - $n = 4$\n  - $K_R = 10^{-6}\\ \\mathrm{M}$\n  - $c = 1$\n  - $x_{\\min} = 10^{-9}\\ \\mathrm{M}$\n  - $x_{\\max} = 10^{-4}\\ \\mathrm{M}$\n  - $m = 15$\n- 案例 3（强变构和高灵敏度）：\n  - $L = 1000$\n  - $n = 6$\n  - $K_R = 10^{-8}\\ \\mathrm{M}$\n  - $c = 0.01$\n  - $x_{\\min} = 10^{-10}\\ \\mathrm{M}$\n  - $x_{\\max} = 10^{-4}\\ \\mathrm{M}$\n  - $m = 20$\n- 案例 4（弱结合和中度不对称）：\n  - $L = 0.01$\n  - $n = 3$\n  - $K_R = 10^{-4}\\ \\mathrm{M}$\n  - $c = 0.5$\n  - $x_{\\min} = 10^{-9}\\ \\mathrm{M}$\n  - $x_{\\max} = 10^{-2}\\ \\mathrm{M}$\n  - $m = 12$\n\n您的程序应生成单行输出，其中包含四个案例的刚度比，形式为逗号分隔的列表，并用方括号括起来，例如 $\\left[\\rho_1, \\rho_2, \\rho_3, \\rho_4\\right]$，其中每个 $\\rho_i$ 是根据上述过程计算出的浮点数。",
            "solution": "该问题要求计算 Monod–Wyman–Changeux (MWC) 变构调控模型雅可比矩阵的刚度比。该比率可作为模型参数敏感性的一个指标，这是系统生物学和合成生物学中评估参数可辨识性的一个关键概念。该过程涉及定义 MWC 模型，以数值方式构建其雅可比矩阵，然后分析雅可比矩阵的奇异值谱。\n\n首先，我们重申 MWC 模型的核心方程。该模型考虑一个蛋白质，其上有 $n$ 个相同的配体结合位点，配体浓度为 $x$。蛋白质存在于两种构象状态：松弛态（R）和紧张态（T）。这些状态之间的平衡由变构常数 $L$ 控制，而配体结合的特征在于 R 和 T 态的解离常数分别为 $K_R$ 和 $K_T$。这些常数的比值为 $c = K_R / K_T$。\n\n松弛态和紧张态蛋白质系综的结合多项式由下式给出：\n$$Z_R(x; K_R, n) = \\left(1 + \\frac{x}{K_R}\\right)^n$$\n$$Z_T(x; K_T, n) = L \\left(1 + \\frac{x}{K_T}\\right)^n = L \\left(1 + \\frac{cx}{K_R}\\right)^n$$\n\n由此，蛋白质处于松弛态的概率是 R 态配分函数与总配分函数之比：\n$$P_R(x; L, K_R, c, n) = \\frac{Z_R(x; K_R, n)}{Z_R(x; K_R, n) + Z_T(x; K_T, n)}$$\n\n对于处于单一构象状态且解离常数为 $K$ 的蛋白质，其结合位点的分数饱和度遵循简单的 Langmuir 等温线：\n$$a(x; K) = \\frac{x}{x + K}$$\n\n总的可观测的每个位点的分数占据率 $Y$ 是 R 态和 T 态占据率的加权平均值，权重为每种状态的概率：\n$$Y(x; L, K_R, c, n) = P_R(x; L, K_R, c, n)\\, a(x; K_R) + \\left[1 - P_R(x; L, K_R, c, n)\\right]\\, a\\!\\left(x; K_T\\right)$$\n代入 $K_T = K_R/c$，表达式变为：\n$$Y(x; L, K_R, c, n) = P_R(x; L, K_R, c, n)\\, a(x; K_R) + \\left[1 - P_R(x; L, K_R, c, n)\\right]\\, a\\!\\left(x; \\frac{K_R}{c}\\right)$$\n\n该问题定义了一组 $m$ 个配体浓度 $\\mathbf{x} = [x_1, x_2, \\dots, x_m]^\\top$ 和一个参数向量 $\\boldsymbol{\\theta} = [L, K_R, c]^\\top$。对于这组浓度，模型的输出是一个向量 $\\mathbf{y}(\\boldsymbol{\\theta}) \\in \\mathbb{R}^m$：\n$$\\mathbf{y}(\\boldsymbol{\\theta}) = \\left[Y(x_1; \\boldsymbol{\\theta}), Y(x_2; \\boldsymbol{\\theta}), \\dots, Y(x_m; \\boldsymbol{\\theta})\\right]^\\top$$\n\n研究的核心对象是雅可比矩阵 $J(\\boldsymbol{\\theta})$，它描述了模型输出向量 $\\mathbf{y}$ 对参数 $\\boldsymbol{\\theta}$ 变化的局部敏感性。它是一个 $m \\times 3$ 矩阵，其列是 $\\mathbf{y}$ 对每个参数的偏导数：\n$$J(\\boldsymbol{\\theta}) = \\left[\\frac{\\partial \\mathbf{y}}{\\partial L} \\ \\ \\frac{\\partial \\mathbf{y}}{\\partial K_R} \\ \\ \\frac{\\partial \\mathbf{y}}{\\partial c}\\right]$$\n\n由于这些偏导数的解析推导很复杂，我们被要求使用中心有限差分法进行数值计算。对于 $\\boldsymbol{\\theta}$ 中的每个参数 $\\theta_j$，雅可比矩阵的相应列近似为：\n$$\\frac{\\partial \\mathbf{y}}{\\partial \\theta_j} \\approx \\frac{\\mathbf{y}(\\boldsymbol{\\theta}_{j}^{+}) - \\mathbf{y}(\\boldsymbol{\\theta}_{j}^{-})}{2 h_j}$$\n其中 $\\boldsymbol{\\theta}_{j}^{\\pm}$ 表示参数向量 $\\boldsymbol{\\theta}$ 的第 $j$ 个元素被扰动为 $\\theta_j \\pm h_j$。步长 $h_j$ 是参数值的一个小的相对扰动：$h_j = s \\cdot \\theta_j$，相对步长 $s = 10^{-6}$。\n\n一旦构建了雅可比矩阵 $J(\\boldsymbol{\\theta})$，我们使用奇异值分解 (SVD) 来分析其结构：\n$$J(\\boldsymbol{\\theta}) = U \\Sigma V^\\top$$\n这里，$U$ 和 $V$ 是正交矩阵，$\\Sigma$ 是一个包含奇异值 $\\sigma_i$ 的对角矩阵，按降序排列 ($\\sigma_1 \\ge \\sigma_2 \\ge \\dots$)。这些奇异值代表了敏感性主轴的大小。最大奇异值 $\\sigma_{\\max}$ 与最小奇异值 $\\sigma_{\\min}$ 的比率表示模型敏感性的各向异性。较大的比率意味着模型是“草率的”（sloppy），即模型对某些参数变化的组合比对其他组合要敏感得多。\n\n我们要计算刚度比 $\\rho$，定义为：\n$$\\rho = \\frac{\\sigma_{\\max}}{\\max(\\sigma_{\\min}, \\tau)}$$\n其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别是 $J(\\boldsymbol{\\theta})$ 的最大和最小奇异值。引入容差 $\\tau = 10^{-12}$ 以防止除以零，并为有效最小奇异值提供一个下限，这在雅可比矩阵秩亏（数值上或解析上）时很重要，如案例 2 中所发生的情况。\n\n每个测试用例的计算过程如下：\n1.  定义特定案例的参数：$L, n, K_R, c, x_{\\min}, x_{\\max}, m$。\n2.  通过在 $x_{\\min}$ 和 $x_{\\max}$ 之间创建 $m$ 个对数间隔的点来生成配体浓度向量 $\\mathbf{x}$。\n3.  建立标称参数向量 $\\boldsymbol{\\theta} = [L, K_R, c]^\\top$。\n4.  通过使用中心有限差分公式计算其三列中的每一列，来构建 $m \\times 3$ 的雅可比矩阵 $J(\\boldsymbol{\\theta})$。这涉及到调用 MWC 模型函数 $Y$ 六次（对三个参数中的每一个进行一对调用）。\n5.  对得到的雅可比矩阵 $J(\\boldsymbol{\\theta})$ 进行 SVD 分解，以获得其奇异值。\n6.  使用最大和最小奇异值以及给定的容差 $\\tau$ 计算刚度比 $\\rho$。\n\n对四个指定的测试用例中的每一个重复此过程，并报告所得的刚度比。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not used as per the problem description mentioning `scipy==1.11.4` but no specific import. np.linalg.svd is sufficient.\n\ndef y_model(theta, n, x_vec):\n    \"\"\"\n    Computes the MWC model output vector y for a given parameter set and concentration vector.\n    \n    Args:\n        theta (list or np.ndarray): Parameter vector [L, K_R, c].\n        n (int): Number of binding sites (Hill coefficient).\n        x_vec (np.ndarray): Vector of ligand concentrations.\n\n    Returns:\n        np.ndarray: The model output vector y.\n    \"\"\"\n    L, K_R, c = theta\n    \n    # Handle potential division by zero, although problem constraints should prevent this.\n    if K_R == 0 or c == 0:\n        # Return a vector of NaNs or zeros if parameters are invalid.\n        return np.full_like(x_vec, np.nan)\n        \n    K_T = K_R / c\n\n    # Binding polynomials\n    Z_R = (1 + x_vec / K_R)**n\n    Z_T = L * (1 + x_vec / K_T)**n\n\n    # Probability of being in the relaxed state\n    # Add a small epsilon to the denominator for numerical stability if Z_R + Z_T could be zero,\n    # though it's not expected here as Z_R and Z_T are non-negative and Z_R is  0.\n    P_R = Z_R / (Z_R + Z_T)\n\n    # Per-site fractional occupancy in each state\n    a_R = x_vec / (x_vec + K_R)\n    a_T = x_vec / (x_vec + K_T)\n\n    # Observable per-site fractional occupancy\n    Y = P_R * a_R + (1 - P_R) * a_T\n    \n    return Y\n\ndef calculate_stiffness_ratio(L, n, K_R, c, x_min, x_max, m):\n    \"\"\"\n    Calculates the stiffness ratio for the MWC model Jacobian for a single test case.\n    \n    Args:\n        L (float): Allosteric constant.\n        n (int): Number of binding sites.\n        K_R (float): Dissociation constant for the relaxed state.\n        c (float): Ratio of dissociation constants, K_R / K_T.\n        x_min (float): Minimum ligand concentration.\n        x_max (float): Maximum ligand concentration.\n        m (int): Number of concentration points.\n        \n    Returns:\n        float: The computed stiffness ratio rho.\n    \"\"\"\n    s = 1e-6  # Relative perturbation step\n    tau = 1e-12 # Tolerance for stiffness ratio calculation\n\n    # 1. Generate the concentration vector\n    x_vec = np.logspace(np.log10(x_min), np.log10(x_max), m)\n\n    # 2. Define the nominal parameter vector\n    theta_nom = np.array([L, K_R, c])\n\n    # 3. Construct the Jacobian matrix using central finite differences\n    num_params = len(theta_nom)\n    J = np.zeros((m, num_params))\n    \n    for j in range(num_params):\n        theta_j = theta_nom[j]\n        \n        # Calculate step size\n        h_j = s * theta_j\n        # Failsafe for theta_j = 0, though not expected in this problem\n        if h_j == 0:\n            h_j = s \n        \n        # Perturb parameter vector\n        theta_plus = theta_nom.copy()\n        theta_minus = theta_nom.copy()\n        theta_plus[j] += h_j\n        theta_minus[j] -= h_j\n        \n        # Calculate model outputs for perturbed parameters\n        y_plus = y_model(theta_plus, n, x_vec)\n        y_minus = y_model(theta_minus, n, x_vec)\n        \n        # Calculate the j-th column of the Jacobian\n        J[:, j] = (y_plus - y_minus) / (2 * h_j)\n\n    # 4. Perform SVD on the Jacobian\n    # np.linalg.svd returns U, s, Vh where s is the vector of singular values.\n    # We only need the singular values.\n    try:\n        singular_values = np.linalg.svd(J, compute_uv=False)\n    except np.linalg.LinAlgError:\n        # Failsafe for non-convergence, though highly unlikely\n        return np.nan\n\n    # 5. Calculate the stiffness ratio\n    sigma_max = singular_values[0] # Singular values are sorted in descending order\n    sigma_min = singular_values[-1]\n    \n    rho = sigma_max / np.maximum(sigma_min, tau)\n    \n    return rho\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case 1: typical positive cooperativity\n        {\"L\": 100.0, \"n\": 4, \"K_R\": 1e-6, \"c\": 0.1, \"x_min\": 1e-9, \"x_max\": 1e-4, \"m\": 15},\n        # Case 2: boundary, nearly non-allosteric\n        {\"L\": 1.0, \"n\": 4, \"K_R\": 1e-6, \"c\": 1.0, \"x_min\": 1e-9, \"x_max\": 1e-4, \"m\": 15},\n        # Case 3: strong allostery and high sensitivity\n        {\"L\": 1000.0, \"n\": 6, \"K_R\": 1e-8, \"c\": 0.01, \"x_min\": 1e-10, \"x_max\": 1e-4, \"m\": 20},\n        # Case 4: weak binding and modest asymmetry\n        {\"L\": 0.01, \"n\": 3, \"K_R\": 1e-4, \"c\": 0.5, \"x_min\": 1e-9, \"x_max\": 1e-2, \"m\": 12},\n    ]\n\n    results = []\n    for case in test_cases:\n        rho = calculate_stiffness_ratio(\n            case[\"L\"], case[\"n\"], case[\"K_R\"], case[\"c\"],\n            case[\"x_min\"], case[\"x_max\"], case[\"m\"]\n        )\n        results.append(rho)\n\n    # Final print statement in the exact required format.\n    # The map(str, results) converts each float to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}