{
    "hands_on_practices": [
        {
            "introduction": "High-level expression of synthetic proteins is a cornerstone of biotechnology, but it comes at a cost to the host cell. This exercise challenges you to think like a systems biologist by quantifying the metabolic burden of protein production. By treating the cell as an economy with finite resources—including ribosomes, ATP, and GTP—you will use the principle of the rate-limiting step to determine the maximum possible rate of synthesis for a desired protein, a fundamental skill for managing metabolic load in engineered organisms .",
            "id": "3939745",
            "problem": "A single-gene synthetic module in a bacterium drives high-level expression of a designed protein subject to translational and post-translational control. Assume the following well-tested facts and resource-accounting principles as the fundamental base: translation is performed by ribosomes that elongate polypeptides at a finite amino-acid incorporation rate, every amino acid added to a polypeptide consumes adenosine triphosphate equivalents (ATP equivalents) for aminoacyl transfer ribonucleic acid charging and guanosine triphosphate (GTP) for elongation, and each full-length protein additionally incurs finite initiation and termination GTP costs. Post-translational processing by a chaperone and a kinase consumes ATP equivalents per completed protein. Conservation of resources holds at steady state: the consumption rates of ATP equivalents and GTP by the module cannot exceed the fractions of cellular ATP equivalent and GTP production rates allocated to the module.\n\nThe designed protein has length $L = 300$ amino acids. Ribosomes translate this protein at a maximum per-ribosome elongation speed $v_{\\max} = 10$ amino acids per second when not energy-limited. The total cellular ribosome pool is $R_{\\text{tot}} = 2.0 \\times 10^{4}$, and a fixed fraction $\\theta = 0.40$ can be allocated to this module, so the number of ribosomes available to translate this gene is $R_{\\text{avail}} = \\theta R_{\\text{tot}}$. Messenger ribonucleic acid is sufficiently abundant that ribosome availability, not initiation site saturation, limits the number of engaged ribosomes.\n\nEnergy budgets are as follows. The cell produces ATP equivalents at a rate $J_{\\text{ATP,tot}} = 1.2 \\times 10^{6}$ per second and consumes $J_{\\text{ATP,maint}} = 5.0 \\times 10^{5}$ per second for non-translation maintenance. A fixed fraction $\\beta = 0.50$ of the remaining ATP equivalent production can be allocated to the module. The cell produces GTP at a rate $J_{\\text{GTP,tot}} = 5.0 \\times 10^{5}$ per second and consumes $J_{\\text{GTP,maint}} = 2.0 \\times 10^{5}$ per second for non-translation maintenance. A fixed fraction $\\gamma = 0.50$ of the remaining GTP production can be allocated to the module.\n\nPer-protein energy costs are as follows. For each amino acid added, $2$ ATP equivalents are consumed for aminoacyl transfer ribonucleic acid charging. Elongation consumes $2$ GTP per amino acid incorporated. Initiation and termination together consume $2$ GTP per completed protein. Post-translational processing by a chaperone consumes $C = 150$ ATP equivalents per completed protein. The protein is phosphorylated on $S = 2$ sites, each consuming $1$ ATP equivalent per site. A dedicated kinase with concentration corresponding to $E_{k} = 400$ enzyme molecules and catalytic constant $k_{\\text{cat}} = 20$ per second processes phosphorylation, so the phosphorylation throughput is limited by enzyme capacity as a separate potential bottleneck.\n\nAssume steady state, no ribosome drop-off, and negligible premature termination. Under these assumptions, the module’s steady-state protein completion rate $J_{P}$ (proteins per second) is jointly constrained by ribosome availability, ATP equivalent budget, GTP budget, and phosphorylation enzyme capacity. Derive from first principles the binding and energy conservation constraints for $J_{P}$ and compute the unique steady-state $J_{P}$ implied by these constraints. Express the final protein production rate in molecules per second, and round your answer to three significant figures.",
            "solution": "The problem will first be validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Protein properties:**\n  - Length: $L = 300$ amino acids\n  - Phosphorylation sites: $S = 2$\n\n- **Ribosome and Translation parameters:**\n  - Total cellular ribosomes: $R_{\\text{tot}} = 2.0 \\times 10^{4}$\n  - Fraction of ribosomes allocated to the module: $\\theta = 0.40$\n  - Maximum ribosome elongation speed: $v_{\\max} = 10$ amino acids/second\n\n- **ATP Budget:**\n  - Total cellular ATP equivalent production rate: $J_{\\text{ATP,tot}} = 1.2 \\times 10^{6}$ per second\n  - ATP equivalent maintenance consumption rate: $J_{\\text{ATP,maint}} = 5.0 \\times 10^{5}$ per second\n  - Fraction of remaining ATP equivalent production allocated to the module: $\\beta = 0.50$\n\n- **GTP Budget:**\n  - Total cellular GTP production rate: $J_{\\text{GTP,tot}} = 5.0 \\times 10^{5}$ per second\n  - GTP maintenance consumption rate: $J_{\\text{GTP,maint}} = 2.0 \\times 10^{5}$ per second\n  - Fraction of remaining GTP production allocated to the module: $\\gamma = 0.50$\n\n- **Energy Costs per Protein:**\n  - aa-tRNA charging: $2$ ATP equivalents per amino acid\n  - Elongation: $2$ GTP per amino acid\n  - Initiation and termination: $2$ GTP per protein\n  - Chaperone processing: $C = 150$ ATP equivalents per protein\n  - Phosphorylation: $1$ ATP equivalent per site\n\n- **Post-translational Modification (Phosphorylation) Capacity:**\n  - Kinase enzyme molecules: $E_{k} = 400$\n  - Kinase catalytic constant: $k_{\\text{cat}} = 20$ per second\n\n- **Assumptions:**\n  - Steady state\n  - No ribosome drop-off\n  - Negligible premature termination\n  - Ribosome availability, not initiation site saturation, is limiting for ribosome engagement.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria.\n\n- **Scientifically Grounded:** The problem is based on fundamental and well-established principles of molecular and cellular biology, specifically the stoichiometry of protein synthesis, energy metabolism (ATP/GTP consumption), and enzyme kinetics. The use of a resource-allocation framework is a standard and rigorous approach in systems and synthetic biology modeling. The problem is free of pseudoscience or scientifically unsound claims.\n- **Well-Posed:** The problem asks for a single quantity, the steady-state protein completion rate $J_P$, which is determined by the most restrictive of several independent constraints. This \"bottleneck\" or \"limiting factor\" structure ensures that a unique and meaningful solution exists.\n- **Objective:** The problem is stated using precise, quantitative, and unbiased language. All parameters are clearly defined.\n- **Incomplete or Contradictory Setup:** The problem provides all necessary data to calculate the maximum protein production rate allowed by each of the four specified constraints (ribosome availability, ATP budget, GTP budget, phosphorylation capacity). There are no missing parameters or contradictory statements.\n- **Unrealistic or Infeasible:** The numerical values provided for cellular parameters (ribosome count, energy fluxes) and biochemical constants ($k_{\\text{cat}}$, energy costs) are within plausible physiological ranges for a bacterium like *E. coli*. The setup is scientifically realistic.\n- **Ill-Posed or Poorly Structured:** The problem is clearly structured as a bottleneck analysis, which is a well-defined mathematical problem. The terms are unambiguous.\n- **Pseudo-Profound, Trivial, or Tautological:** The problem requires the synthesis of several concepts from biochemistry and cell biology into a cohesive quantitative model. It involves non-trivial calculations and reasoning to identify the rate-limiting step, thus it is not superficial or tautological.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid** as it is scientifically grounded, self-contained, consistent, and well-posed. A solution will be derived.\n\n### Solution\n\nThe steady-state protein completion rate, $J_P$, is determined by the most restrictive constraint among the available resources and processing capacities. This is the principle of the rate-limiting step. We must calculate the maximum possible rate, $J_{P, \\text{max}}$, supported by each of the four independent constraints: ribosome availability, the ATP budget, the GTP budget, and the phosphorylation capacity. The actual steady-state rate will be the minimum of these values:\n$$\nJ_P = \\min(J_{P, \\text{ribosome}}, J_{P, \\text{ATP}}, J_{P, \\text{GTP}}, J_{P, \\text{phos}})\n$$\nWe will now derive each of these limiting rates.\n\n**1. Ribosome Availability Constraint ($J_{P, \\text{ribosome}}$)**\n\nThe total number of ribosomes available for translating the protein of interest is:\n$$\nR_{\\text{avail}} = \\theta R_{\\text{tot}} = 0.40 \\times (2.0 \\times 10^{4}) = 8000 \\text{ ribosomes}\n$$\nThe time required for a single ribosome to translate one full-length protein of length $L$ at maximum speed $v_{\\max}$ is:\n$$\nt_{\\text{protein}} = \\frac{L}{v_{\\max}} = \\frac{300 \\text{ aa}}{10 \\text{ aa/s}} = 30 \\text{ s}\n$$\nThe total protein completion rate is the number of available ribosomes divided by the time each takes to complete a protein.\n$$\nJ_{P, \\text{ribosome}} = \\frac{R_{\\text{avail}}}{t_{\\text{protein}}} = \\frac{8000}{30} = \\frac{800}{3} \\approx 266.67 \\text{ proteins/s}\n$$\n\n**2. ATP Budget Constraint ($J_{P, \\text{ATP}}$)**\n\nFirst, we determine the rate of ATP equivalent production available to the module. This is a fraction $\\beta$ of the total production rate minus the maintenance consumption.\n$$\nJ_{\\text{ATP,avail}} = \\beta (J_{\\text{ATP,tot}} - J_{\\text{ATP,maint}}) = 0.50 \\times (1.2 \\times 10^{6} \\text{ s}^{-1} - 5.0 \\times 10^{5} \\text{ s}^{-1}) = 0.50 \\times (7.0 \\times 10^{5} \\text{ s}^{-1}) = 3.5 \\times 10^{5} \\text{ ATP/s}\n$$\nNext, we calculate the total ATP equivalent cost per protein, $C_{\\text{ATP,prot}}$. This cost has three components: aminoacyl-tRNA charging, chaperone-mediated processing, and phosphorylation.\n$$\nC_{\\text{ATP,prot}} = (\\text{Cost}_{\\text{charging}}) + (\\text{Cost}_{\\text{chaperone}}) + (\\text{Cost}_{\\text{phos}})\n$$\n$$\n\\text{Cost}_{\\text{charging}} = (2 \\text{ ATP/aa}) \\times L = 2 \\times 300 = 600 \\text{ ATP/protein}\n$$\n$$\n\\text{Cost}_{\\text{chaperone}} = C = 150 \\text{ ATP/protein}\n$$\n$$\n\\text{Cost}_{\\text{phos}} = (1 \\text{ ATP/site}) \\times S = 1 \\times 2 = 2 \\text{ ATP/protein}\n$$\nThe total cost is:\n$$\nC_{\\text{ATP,prot}} = 600 + 150 + 2 = 752 \\text{ ATP/protein}\n$$\nThe maximum protein production rate supported by the ATP budget is the available ATP flux divided by the cost per protein.\n$$\nJ_{P, \\text{ATP}} = \\frac{J_{\\text{ATP,avail}}}{C_{\\text{ATP,prot}}} = \\frac{3.5 \\times 10^{5}}{752} \\approx 465.43 \\text{ proteins/s}\n$$\n\n**3. GTP Budget Constraint ($J_{P, \\text{GTP}}$)**\n\nSimilar to the ATP budget, we first determine the available GTP flux.\n$$\nJ_{\\text{GTP,avail}} = \\gamma (J_{\\text{GTP,tot}} - J_{\\text{GTP,maint}}) = 0.50 \\times (5.0 \\times 10^{5} \\text{ s}^{-1} - 2.0 \\times 10^{5} \\text{ s}^{-1}) = 0.50 \\times (3.0 \\times 10^{5} \\text{ s}^{-1}) = 1.5 \\times 10^{5} \\text{ GTP/s}\n$$\nThe GTP cost per protein, $C_{\\text{GTP,prot}}$, has two components: elongation and initiation/termination.\n$$\nC_{\\text{GTP,prot}} = (\\text{Cost}_{\\text{elongation}}) + (\\text{Cost}_{\\text{init/term}})\n$$\n$$\n\\text{Cost}_{\\text{elongation}} = (2 \\text{ GTP/aa}) \\times L = 2 \\times 300 = 600 \\text{ GTP/protein}\n$$\n$$\n\\text{Cost}_{\\text{init/term}} = 2 \\text{ GTP/protein}\n$$\nThe total cost is:\n$$\nC_{\\text{GTP,prot}} = 600 + 2 = 602 \\text{ GTP/protein}\n$$\nThe maximum protein production rate supported by the GTP budget is:\n$$\nJ_{P, \\text{GTP}} = \\frac{J_{\\text{GTP,avail}}}{C_{\\text{GTP,prot}}} = \\frac{1.5 \\times 10^{5}}{602} \\approx 249.17 \\text{ proteins/s}\n$$\n\n**4. Phosphorylation Capacity Constraint ($J_{P, \\text{phos}}$)**\n\nThe total catalytic throughput of the kinase is the number of enzyme molecules multiplied by the catalytic constant. This gives the total number of phosphorylation *events* per second.\n$$\nJ_{\\text{phos,events}} = E_k \\times k_{\\text{cat}} = 400 \\times 20 \\text{ s}^{-1} = 8000 \\text{ events/s}\n$$\nSince each protein requires $S=2$ phosphorylation events, the maximum rate of *protein* processing is:\n$$\nJ_{P, \\text{phos}} = \\frac{J_{\\text{phos,events}}}{S} = \\frac{8000}{2} = 4000 \\text{ proteins/s}\n$$\n\n**Conclusion: Identifying the Rate-Limiting Step**\n\nWe now compare the four calculated maximum rates:\n- $J_{P, \\text{ribosome}} \\approx 266.67$ proteins/s\n- $J_{P, \\text{ATP}} \\approx 465.43$ proteins/s\n- $J_{P, \\text{GTP}} \\approx 249.17$ proteins/s\n- $J_{P, \\text{phos}} = 4000$ proteins/s\n\nThe overall steady-state protein completion rate $J_P$ is the minimum of these values.\n$$\nJ_P = \\min(266.67, 465.43, 249.17, 4000) = 249.17 \\text{ proteins/s}\n$$\nThe limiting factor for protein production is the GTP budget. The system is GTP-limited.\n\nThe problem requires the final answer rounded to three significant figures.\n$$\nJ_P \\approx 249 \\text{ proteins/s}\n$$",
            "answer": "$$\n\\boxed{249}\n$$"
        },
        {
            "introduction": "While resource budgets set the upper limits on production, the dynamics of the translation machinery itself introduce another layer of control. In this practice, we model ribosome movement along an mRNA as a \"traffic jam\" problem using the Totally Asymmetric Simple Exclusion Process (TASEP), a powerful framework from statistical physics. This approach allows us to understand how the interplay between the rates of translation initiation, elongation, and termination gives rise to distinct phases of protein flux, bridging the gap between molecular rates and system-level output .",
            "id": "3939744",
            "problem": "Consider a single messenger ribonucleic acid (mRNA) transcript undergoing translation by ribosomes. Model ribosome traffic along the mRNA as a one-dimensional Totally Asymmetric Simple Exclusion Process (TASEP) with open boundaries and random sequential kinetics, where each site represents a codon and each ribosome occupies a single codon site. Entry of a ribosome onto the first codon occurs with rate $\\alpha$ (in $\\mathrm{s}^{-1}$) conditioned on vacancy, elongation from codon $i$ to $i+1$ occurs with uniform rate $w$ (in $\\mathrm{s}^{-1}$) conditioned on vacancy of site $i+1$, and termination at the last codon occurs with rate $\\beta$ (in $\\mathrm{s}^{-1}$) conditioned on occupancy at the final site. Assume a homogeneous lattice of length $L$ codons and that $L$ is sufficiently large that boundary layers do not dominate the bulk behavior. In addition to translational control, suppose each nascent polypeptide must undergo a single post-translational maturation step with rate $\\mu$ (in $\\mathrm{s}^{-1}$) while in the immature state, and may be degraded from the immature state with rate $\\delta$ (in $\\mathrm{s}^{-1}$). Matured proteins are counted as output; degradation of mature proteins does not affect the counting of matured outputs.\n\nStarting from fundamental base principles and well-tested facts:\n- The Central Dogma of molecular biology establishes that translation produces polypeptides by sequential addition of amino acids along codons.\n- Mass-action kinetics for first-order processes implies exponential waiting times with rates given, and competing exponential processes yield event probabilities proportional to their rates.\n- In homogeneous open-boundary TASEP with random sequential kinetics, the steady-state bulk current is determined by the bulk density and boundary conditions through conservation of flow and exclusion constraints.\n\nDerive, from first principles, an expression for the steady-state translation flux $J$ (in $\\mathrm{s}^{-1}$ per mRNA) in terms of $\\alpha$, $\\beta$, and $w$ for the three qualitatively distinct regimes determined by boundary conditions, and then derive the matured output flux $F$ (in $\\mathrm{s}^{-1}$ per mRNA) accounting for the single-step post-translational maturation with competing immature degradation. Your final program must compute $F$ for each test case below.\n\nUse the following test suite of parameter values, given as tuples ($L, \\alpha, \\beta, w, \\mu, \\delta$), with all rates in $\\mathrm{s}^{-1}$ and $L$ in codons:\n- Test 1: ($L=1000$, $\\alpha=0.2$, $\\beta=5.0$, $w=1.0$, $\\mu=0.5$, $\\delta=0.0$)\n- Test 2: ($L=1000$, $\\alpha=5.0$, $\\beta=0.2$, $w=1.0$, $\\mu=0.5$, $\\delta=0.5$)\n- Test 3: ($L=1000$, $\\alpha=1.0$, $\\beta=1.0$, $w=1.0$, $\\mu=10.0$, $\\delta=10.0$)\n- Test 4: ($L=1000$, $\\alpha=1.0$, $\\beta=10.0$, $w=4.0$, $\\mu=1.0$, $\\delta=0.5$)\n- Test 5: ($L=1000$, $\\alpha=10.0$, $\\beta=10.0$, $w=0.1$, $\\mu=0.01$, $\\delta=0.02$)\n- Test 6: ($L=1000$, $\\alpha=1.0$, $\\beta=10.0$, $w=2.0$, $\\mu=5.0$, $\\delta=0.0$)\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry being the matured output flux $F$ in $\\mathrm{s}^{-1}$ rounded to six decimal places (e.g., $[0.123456,0.654321]$). No other text should be printed.",
            "solution": "The problem requires the derivation of the steady-state matured protein output flux, $F$, for a system coupling gene translation and post-translational modification. The derivation proceeds in two stages: first, determining the translational flux $J$ using the Totally Asymmetric Simple Exclusion Process (TASEP) model, and second, calculating the final matured flux $F$ by considering the competing post-translational kinetics.\n\nThe process of translation is modeled as ribosome traffic on a one-dimensional lattice of length $L$ codons, representing an mRNA molecule. This is a TASEP with open boundaries. Ribosomes are treated as particles that occupy a single site (codon). The kinetic rates are given:\n- Ribosome entry at site $1$ occurs with rate $\\alpha$, provided site $1$ is vacant.\n- Elongation (hopping) from site $i$ to site $i+1$ occurs with a uniform rate $w$ for all $i \\in \\{1, ..., L-1\\}$, provided site $i+1$ is vacant.\n- Termination (exit) from site $L$ occurs with rate $\\beta$, provided site $L$ is occupied.\n\nThe problem states that $L$ is sufficiently large, which allows for a mean-field treatment where boundary effects are localized and a uniform bulk density, $\\rho$ (the average occupancy of a site), can be assumed. The steady-state translational flux, $J$, is the number of ribosomes successfully completing translation per unit time. In steady-state, the particle current must be constant throughout the lattice.\n\nThe relationship between the bulk current $J$ and the bulk density $\\rho$ in the TASEP model is given by the mean-field expression:\n$$J = w \\rho(1-\\rho)$$\nThis reflects that a hop from an occupied site (probability $\\rho$) to an adjacent empty site (probability $1-\\rho$) occurs with intrinsic rate $w$. This function has a maximum value, $J_{max} = w/4$, which occurs at a density of $\\rho = 1/2$. This represents the maximum possible transport capacity of the bulk of the lattice.\n\nThe boundary conditions impose further constraints. At the entrance (site $1$), the current is $J = \\alpha(1-\\rho_1)$, where $\\rho_1$ is the occupancy of the first site. At the exit (site $L$), the current is $J = \\beta \\rho_L$, where $\\rho_L$ is the occupancy of the last site. In the mean-field approximation for a large system, we approximate $\\rho_1$ and $\\rho_L$ by the bulk density $\\rho$.\n\nThe overall system behavior is determined by the interplay between the injection rate $\\alpha$, the ejection rate $\\beta$, and the bulk transport capacity characterized by $w$. This gives rise to three distinct phases, determined by which process is the rate-limiting step. The phase diagram is a well-established result for the open-boundary TASEP.\n\n1.  **Low-Density (LD) Phase**: This phase occurs when injection is the bottleneck. The conditions for this phase are $\\alpha < \\beta$ and $\\alpha < w/2$. The bulk of the lattice is sparsely occupied, and the density adjusts to accommodate the slow influx. The current is limited by the entry rate $\\alpha$. The bulk density is $\\rho \\approx \\alpha/w$. Substituting this into the bulk current-density relation gives the steady-state flux:\n    $$J = w \\left(\\frac{\\alpha}{w}\\right) \\left(1 - \\frac{\\alpha}{w}\\right) = \\alpha\\left(1 - \\frac{\\alpha}{w}\\right)$$\n\n2.  **High-Density (HD) Phase**: This phase occurs when ejection is the bottleneck. The conditions are $\\beta < \\alpha$ and $\\beta < w/2$. A traffic jam of ribosomes builds up from the exit, leading to a high-density bulk. The rate of hopping is limited by the availability of empty sites. The density of vacancies, $(1-\\rho)$, is determined by the slow exit, $(1-\\rho) \\approx \\beta/w$, which implies a bulk density of $\\rho \\approx 1 - \\beta/w$. Substituting this into the current-density relation yields the flux:\n    $$J = w \\left(1 - \\frac{\\beta}{w}\\right) \\left(1 - \\left(1 - \\frac{\\beta}{w}\\right)\\right) = w \\left(1 - \\frac{\\beta}{w}\\right) \\left(\\frac{\\beta}{w}\\right) = \\beta\\left(1 - \\frac{\\beta}{w}\\right)$$\n\n3.  **Maximal-Current (MC) Phase**: This phase occurs when both injection and ejection are fast enough to not be limiting, and the bulk transport is the bottleneck. The conditions are $\\alpha \\ge w/2$ and $\\beta \\ge w/2$. The system self-organizes to the density $\\rho = 1/2$ that permits the maximal possible current. The flux is:\n    $$J = J_{max} = \\frac{w}{4}$$\n\nThese three cases cover the entire parameter space for $\\alpha$, $\\beta$, and $w$. We can summarize the translational flux $J$ as:\n$$\nJ(\\alpha, \\beta, w) =\n\\begin{cases}\n    \\alpha(1 - \\alpha/w) & \\text{if } \\alpha < \\beta \\text{ and } \\alpha < w/2 \\\\\n    \\beta(1 - \\beta/w) & \\text{if } \\beta < \\alpha \\text{ and } \\beta < w/2 \\\\\n    w/4 & \\text{if } \\alpha \\ge w/2 \\text{ and } \\beta \\ge w/2\n\\end{cases}\n$$\nThe boundaries between phases are continuous. For instance, on the coexistence line $\\alpha = \\beta < w/2$, both the LD and HD formulas yield the same result, $J = \\alpha(1-\\alpha/w)$.\n\nNext, we derive the matured output flux $F$. The translational flux $J$ represents the rate of production of immature polypeptides. Each immature polypeptide is subject to two competing first-order kinetic processes:\n- Maturation, with rate $\\mu$.\n- Degradation, with rate $\\delta$.\n\nAccording to the principles of mass-action kinetics for competing first-order reactions, the probability of a specific outcome is the rate of that outcome divided by the sum of the rates of all possible outcomes. The total rate of exit from the immature state is $\\mu + \\delta$.\n\nThe probability, $p_{mature}$, that an immature protein will successfully mature rather than be degraded is:\n$$p_{mature} = \\frac{\\mu}{\\mu + \\delta}$$\nThis derivation is meaningless if both $\\mu=0$ and $\\delta=0$. In that specific case, the protein never matures, so the flux of matured proteins must be $0$. If $\\mu=0$ and \\delta>0, $p_{mature}=0$. If $\\mu>0$ and $\\delta=0$, $p_{mature}=1$. The formula holds for all cases except the undefined $\\mu=0, \\delta=0$ case, which must be handled by observing that if $\\mu=0$, no maturation can occur.\n\nThe matured output flux, $F$, is the total rate of production of immature proteins, $J$, multiplied by the probability of successful maturation, $p_{mature}$.\n$$F = J \\times p_{mature} = J \\cdot \\frac{\\mu}{\\mu + \\delta}$$\nIf $\\mu=0$, the flux $F$ is $0$. Otherwise, the formula is valid. This final expression combines the translational control model (TASEP) with the post-translational control model (competing kinetics) to yield the desired output flux.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the steady-state matured protein output flux F for a series of test cases.\n    The model combines a TASEP model for translation with a post-translational\n    maturation/degradation step.\n    \"\"\"\n\n    # Test suite of parameter values (L, alpha, beta, w, mu, delta)\n    # L is in codons, all rates (alpha, beta, w, mu, delta) are in s^-1.\n    # L is not used in the calculation because the model assumes a sufficiently\n    # large lattice where bulk behavior dominates.\n    test_cases = [\n        (1000, 0.2, 5.0, 1.0, 0.5, 0.0),  # Test 1\n        (1000, 5.0, 0.2, 1.0, 0.5, 0.5),  # Test 2\n        (1000, 1.0, 1.0, 1.0, 10.0, 10.0), # Test 3\n        (1000, 1.0, 10.0, 4.0, 1.0, 0.5), # Test 4\n        (1000, 10.0, 10.0, 0.1, 0.01, 0.02),# Test 5\n        (1000, 1.0, 10.0, 2.0, 5.0, 0.0)   # Test 6\n    ]\n\n    results = []\n    for case in test_cases:\n        _, alpha, beta, w, mu, delta = case\n\n        # Step 1: Calculate the steady-state translational flux J based on TASEP phases.\n        # The logic correctly implements the phase diagram:\n        # MC phase: if alpha >= w/2 and beta >= w/2\n        # LD phase: if not MC and alpha < beta (implicitly alpha < w/2)\n        # HD phase: if not MC and beta <= alpha (implicitly beta < w/2)\n        \n        w_half = w / 2.0\n        J = 0.0\n\n        if alpha >= w_half and beta >= w_half:\n            # Maximal Current (MC) Phase\n            J = w / 4.0\n        elif alpha < beta:\n            # Low-Density (LD) Phase\n            J = alpha * (1.0 - alpha / w)\n        else: # beta <= alpha\n            # High-Density (HD) Phase\n            J = beta * (1.0 - beta / w)\n\n        # Step 2: Calculate the matured output flux F.\n        # Immature proteins are produced at rate J. They mature with rate mu\n        # and are degraded with rate delta. The probability of maturation\n        # is mu / (mu + delta).\n        F = 0.0\n        \n        # Handle the case where mu > 0 to avoid division by zero if both mu and delta are 0.\n        # If mu is 0, no matured protein can be produced, so F is 0.\n        if mu > 0:\n            F = J * mu / (mu + delta)\n\n        results.append(F)\n\n    # Format the results to 6 decimal places and print in the required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The journey of a protein does not end when it is released from the ribosome, as the nascent polypeptide must still navigate a complex landscape of folding and modification to become functional. This final practice focuses on these critical post-translational steps, modeling them as a stochastic process with competing kinetic pathways for correct folding, misfolding, chaperone-assisted refolding, and degradation. By calculating the ultimate probability that a newly synthesized protein reaches its mature, functional state, you will gain quantitative insight into the efficiency of protein quality control and the factors that determine the final yield of a synthetic circuit .",
            "id": "3939734",
            "problem": "A synthetic gene circuit expresses a fluorescent protein whose translational product must fold and then undergo a post-translational maturation to become fluorescent. Assume dilute conditions and well-mixed cytoplasm so that first-order mass-action kinetics apply. Immediately upon release from the ribosome, a newly synthesized polypeptide enters an unfolded state, denoted $U$. From $U$, three mutually exclusive events can occur: native folding to $N$ with rate constant $k_{f}$, misfolding to $M$ with rate constant $k_{m}$, or degradation with rate constant $k_{dU}$. From the misfolded state $M$, two mutually exclusive events can occur: chaperone-assisted refolding to $N$ with rate constant $k_{r}$, or degradation with rate constant $k_{dM}$. From the native but non-fluorescent state $N$, two mutually exclusive events can occur: chromophore maturation to the fluorescent state $R$ with rate constant $k_{\\mathrm{mat}}$, or degradation with rate constant $k_{dN}$. The fluorescent state $R$ is absorbing on the timescale considered (no reverse reactions and no degradation of $R$). Translation proceeds at a constant rate, but you may consider a single newly released polypeptide starting in $U$ at time $t=0$ because the yield sought below is independent of the synthesis rate under these assumptions.\n\nStarting only from the Central Dogma (information flow from gene to protein) and first-order reaction kinetics, model this as a continuous-time Markov process with $R$ and degradation as absorbing outcomes. Derive, from first principles, the ultimate probability that a polypeptide starting in $U$ reaches $R$ (rather than being degraded), and evaluate this probability for the following scientifically plausible parameter values: $k_{f}=0.3\\ \\mathrm{s}^{-1}$, $k_{m}=0.05\\ \\mathrm{s}^{-1}$, $k_{dU}=0.005\\ \\mathrm{s}^{-1}$, $k_{r}=0.02\\ \\mathrm{s}^{-1}$, $k_{dM}=0.01\\ \\mathrm{s}^{-1}$, $k_{\\mathrm{mat}}=0.001\\ \\mathrm{s}^{-1}$, $k_{dN}=0.0005\\ \\mathrm{s}^{-1}$.\n\nReport the numerical value of this ultimate maturation yield as a dimensionless fraction. Round your answer to four significant figures.",
            "solution": "The problem asks for the ultimate probability that a single polypeptide, starting in the unfolded state $U$ at time $t=0$, will reach the mature fluorescent state $R$. The system is modeled as a continuous-time Markov process with a set of transient states $\\{U, M, N\\}$ and two absorbing outcomes, reaching state $R$ or being degraded (which we can denote as a composite state $D$). The derivation will be based on the principles of absorption probabilities in such a process.\n\nLet $P_X$ be the probability of eventual absorption into state $R$, given that the process starts in state $X$, where $X \\in \\{U, M, N\\}$. We are asked to find $P_U$.\n\nBy definition, the probability of reaching state $R$ starting from state $R$ is $1$, and the probability of reaching state $R$ starting from the degraded state $D$ is $0$. Thus, we have the boundary conditions:\n$$ P_R = 1 $$\n$$ P_D = 0 $$\n\nWe can establish a system of linear equations for the unknown probabilities $P_U$, $P_M$, and $P_N$ by applying the law of total probability, conditioning on the first transition out of each state. For any transient state $X$, the probability $P_X$ is the sum of the probabilities of transitioning to each possible next state $Y$, multiplied by the probability of eventually reaching $R$ from that state $Y$. The probability of a specific transition $X \\to Y$ occurring, given that some transition from $X$ occurs, is the ratio of the rate constant for that transition, $k_{X \\to Y}$, to the sum of all rate constants for transitions out of $X$.\n\nLet's formulate the equation for each transient state.\n\n1.  For a polypeptide in the native state $N$:\n    The possible transitions are to state $R$ with rate $k_{\\mathrm{mat}}$ or to the degraded state $D$ with rate $k_{dN}$. The total rate of exit from $N$ is $k_{\\mathrm{mat}} + k_{dN}$. The equation for $P_N$ is:\n    $$ P_N = \\left(\\frac{k_{\\mathrm{mat}}}{k_{\\mathrm{mat}} + k_{dN}}\\right) P_R + \\left(\\frac{k_{dN}}{k_{\\mathrm{mat}} + k_{dN}}\\right) P_D $$\n    Substituting the boundary conditions $P_R=1$ and $P_D=0$, we get:\n    $$ P_N = \\frac{k_{\\mathrm{mat}}}{k_{\\mathrm{mat}} + k_{dN}} \\quad (1) $$\n    This result is intuitive: $P_N$ is the fraction of molecules leaving the native state that proceed to maturation rather than degradation.\n\n2.  For a polypeptide in the misfolded state $M$:\n    The possible transitions are to state $N$ (refolding) with rate $k_r$ or to the degraded state $D$ with rate $k_{dM}$. The total rate of exit from $M$ is $k_r + k_{dM}$. The equation for $P_M$ is:\n    $$ P_M = \\left(\\frac{k_r}{k_r + k_{dM}}\\right) P_N + \\left(\\frac{k_{dM}}{k_r + k_{dM}}\\right) P_D $$\n    Substituting $P_D = 0$:\n    $$ P_M = \\left(\\frac{k_r}{k_r + k_{dM}}\\right) P_N \\quad (2) $$\n    This means the probability of reaching $R$ from $M$ is the probability of first successfully refolding to $N$, multiplied by the probability of then reaching $R$ from $N$.\n\n3.  For a polypeptide in the initial unfolded state $U$:\n    The possible transitions are to $N$ (native folding) with rate $k_f$, to $M$ (misfolding) with rate $k_m$, or to $D$ (degradation) with rate $k_{dU}$. The total rate of exit from $U$ is $k_f + k_m + k_{dU}$. The equation for $P_U$ is:\n    $$ P_U = \\left(\\frac{k_f}{k_f + k_m + k_{dU}}\\right) P_N + \\left(\\frac{k_m}{k_f + k_m + k_{dU}}\\right) P_M + \\left(\\frac{k_{dU}}{k_f + k_m + k_{dU}}\\right) P_D $$\n    Substituting $P_D = 0$:\n    $$ P_U = \\frac{k_f P_N + k_m P_M}{k_f + k_m + k_{dU}} \\quad (3) $$\n\nWe now have a system of three linear equations and can solve for $P_U$. We can solve this system by substitution. First, substitute equation $(1)$ into $(2)$ to express $P_M$ in terms of known constants:\n$$ P_M = \\left(\\frac{k_r}{k_r + k_{dM}}\\right) \\left(\\frac{k_{\\mathrm{mat}}}{k_{\\mathrm{mat}} + k_{dN}}\\right) $$\nNext, substitute the expressions for $P_N$ (from eq. $1$) and $P_M$ into equation $(3)$:\n$$ P_U = \\frac{k_f \\left(\\frac{k_{\\mathrm{mat}}}{k_{\\mathrm{mat}} + k_{dN}}\\right) + k_m \\left(\\frac{k_r}{k_r + k_{dM}}\\right) \\left(\\frac{k_{\\mathrm{mat}}}{k_{\\mathrm{mat}} + k_{dN}}\\right)}{k_f + k_m + k_{dU}} $$\nWe can factor out the term for $P_N$ to obtain a more structured expression:\n$$ P_U = \\left(\\frac{k_{\\mathrm{mat}}}{k_{\\mathrm{mat}} + k_{dN}}\\right) \\left( \\frac{k_f + k_m \\left(\\frac{k_r}{k_r + k_{dM}}\\right)}{k_f + k_m + k_{dU}} \\right) $$\nThis expression represents the total maturation yield. The first term, $\\frac{k_{\\mathrm{mat}}}{k_{\\mathrm{mat}} + k_{dN}}$, is the yield of maturation from the native state, $Y_{N \\to R}$. The second term is the yield of reaching the native state from the unfolded state, $Y_{U \\to N}$, accounting for both direct folding ($k_f$) and the indirect pathway through misfolding and refolding ($k_m \\to k_r$).\n\nNow, we substitute the provided numerical values for the rate constants to evaluate this probability:\n$k_{f}=0.3\\ \\mathrm{s}^{-1}$, $k_{m}=0.05\\ \\mathrm{s}^{-1}$, $k_{dU}=0.005\\ \\mathrm{s}^{-1}$, $k_{r}=0.02\\ \\mathrm{s}^{-1}$, $k_{dM}=0.01\\ \\mathrm{s}^{-1}$, $k_{\\mathrm{mat}}=0.001\\ \\mathrm{s}^{-1}$, $k_{dN}=0.0005\\ \\mathrm{s}^{-1}$.\n\nFirst, calculate the yield from the native state, $P_N$:\n$$ P_N = \\frac{k_{\\mathrm{mat}}}{k_{\\mathrm{mat}} + k_{dN}} = \\frac{0.001}{0.001 + 0.0005} = \\frac{0.001}{0.0015} = \\frac{2}{3} $$\n\nNext, calculate the term for the branching probability from misfolding to refolding:\n$$ \\frac{k_r}{k_r + k_{dM}} = \\frac{0.02}{0.02 + 0.01} = \\frac{0.02}{0.03} = \\frac{2}{3} $$\n\nNow, calculate the yield of reaching state $N$ from state $U$:\n$$ Y_{U \\to N} = \\frac{k_f + k_m \\left(\\frac{k_r}{k_r + k_{dM}}\\right)}{k_f + k_m + k_{dU}} = \\frac{0.3 + (0.05)\\left(\\frac{2}{3}\\right)}{0.3 + 0.05 + 0.005} $$\nThe denominator is $0.3 + 0.05 + 0.005 = 0.355$.\nThe numerator is $0.3 + \\frac{0.1}{3} = \\frac{0.9}{3} + \\frac{0.1}{3} = \\frac{1}{3}$.\n$$ Y_{U \\to N} = \\frac{1/3}{0.355} = \\frac{1}{3 \\times 0.355} = \\frac{1}{1.065} $$\n\nFinally, the total probability $P_U$ is the product of these yields:\n$$ P_U = P_N \\times Y_{U \\to N} = \\left(\\frac{2}{3}\\right) \\left(\\frac{1}{1.065}\\right) = \\frac{2}{3.195} $$\nPerforming the division:\n$$ P_U \\approx 0.62597809... $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ P_U \\approx 0.6260 $$\nThis is the ultimate probability that a polypeptide starting in the unfolded state $U$ successfully folds, matures, and becomes fluorescent.",
            "answer": "$$\\boxed{0.6260}$$"
        }
    ]
}