{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的动态模型之前，我们必须首先理解随机性如何从最基础的层面——即通过采样——影响群体构成。这个练习旨在量化由种群瓶颈（一种基本的采样过程）引入的“噪音”或“漂变”，这是群体遗传学和细胞生物学中的一个核心概念。通过推导后代群体与亲本群体之间表型分数的预期偏差，您将建立一个理解群体随机性的基准()。",
            "id": "3926559",
            "problem": "在合成生物学背景下设计的一个克隆微生物种群，在$k$个不同的表型状态（由$j \\in \\{1,2,\\dots,k\\}$索引）之间表现出表型异质性。在稳定的环境中，表型异质性通过赌注对冲策略来维持，其中表型$j$的细胞在瓶颈前的比例为$f_{j}$，且满足$\\sum_{j=1}^{k} f_{j} = 1$和$0  f_{j}  1$。考虑一个种群瓶颈，其中从一个非常大的、充分混合的种群中随机抽取$n$个细胞。由于种群规模巨大，该抽样可视为有放回抽样。设$X_{j}$为观察到的表型$j$的抽样细胞数，并定义瓶颈后的经验比例为$\\hat{f}_{j} := X_{j}/n$。\n\n仅使用以下基础知识：\n- 概率和期望的公理化定义。\n- 方差和协方差的定义，$\\operatorname{Var}(Y) := \\mathbb{E}[Y^{2}] - (\\mathbb{E}[Y])^{2}$ 和 $\\operatorname{Cov}(Y,Z) := \\mathbb{E}[YZ] - \\mathbb{E}[Y]\\mathbb{E}[Z]$。\n- 由具有固定类别概率的独立分类试验产生的多项分布的标准性质。\n\n推导由瓶颈引起的表型比例期望总扰动的闭式表达式，该扰动由瓶颈后经验比例向量与瓶颈前比例向量之间的期望欧氏距离平方来量化，\n$$\n\\mathbb{E}\\!\\left[\\sum_{j=1}^{k}\\left(\\hat{f}_{j} - f_{j}\\right)^{2}\\right],\n$$\n该表达式是关于$n$和初始比例$\\{f_{j}\\}_{j=1}^{k}$的函数。将最终答案表示为单个闭式解析表达式。无需四舍五入。此量无需单位。",
            "solution": "该问题要求推导表型比例的期望总扰动，该扰动由瓶颈后经验比例向量与瓶颈前比例向量之间的期望欧氏距离平方来量化。我们将此量表示为$Q$，其表达式为：\n$$\nQ = \\mathbb{E}\\!\\left[\\sum_{j=1}^{k}\\left(\\hat{f}_{j} - f_{j}\\right)^{2}\\right]\n$$\n问题陈述指明，从一个非常大的、充分混合的种群中抽取$n$个细胞，可视为有放回抽样。这意味着各种表型的计数向量 $(X_{1}, X_{2}, \\dots, X_{k})$ 服从参数为$n$和概率为 $\\mathbf{f} = (f_{1}, f_{2}, \\dots, f_{k})$ 的多项分布。总试验次数为$n$，在任何单次试验中抽到表型$j$细胞的概率为$f_{j}$。我们还已知$\\sum_{j=1}^{k} X_{j} = n$和$\\sum_{j=1}^{k} f_{j} = 1$。\n\n我们首先对$Q$的表达式应用期望的线性性：\n$$\nQ = \\sum_{j=1}^{k} \\mathbb{E}\\!\\left[\\left(\\hat{f}_{j} - f_{j}\\right)^{2}\\right]\n$$\n我们来分析求和式中的项 $\\mathbb{E}\\!\\left[\\left(\\hat{f}_{j} - f_{j}\\right)^{2}\\right]$。该项是估计量$\\hat{f}_{j}$的均方误差的定义。它可以分解为估计量的方差及其偏差的平方。$\\hat{f}_{j}$的偏差为$\\mathbb{E}[\\hat{f}_{j}] - f_{j}$。\n\n首先，我们计算经验比例$\\hat{f}_{j}$的期望。经验比例定义为$\\hat{f}_{j} = X_{j}/n$。利用期望的线性性：\n$$\n\\mathbb{E}[\\hat{f}_{j}] = \\mathbb{E}\\!\\left[\\frac{X_{j}}{n}\\right] = \\frac{1}{n}\\mathbb{E}[X_{j}]\n$$\n多项分布的一个关键性质是，任何单个计数$X_{j}$的边际分布是参数为$n$和$f_{j}$的二项分布，即$X_{j} \\sim \\text{Binomial}(n, f_{j})$。二项分布随机变量的期望是其参数的乘积。因此，\n$$\n\\mathbb{E}[X_{j}] = n f_{j}\n$$\n将此结果代回$\\mathbb{E}[\\hat{f}_{j}]$的表达式中，我们发现：\n$$\n\\mathbb{E}[\\hat{f}_{j}] = \\frac{1}{n}(n f_{j}) = f_{j}\n$$\n这表明经验比例$\\hat{f}_{j}$是真实比例$f_{j}$的无偏估计量。\n\n由于$\\mathbb{E}[\\hat{f}_{j}] = f_{j}$，项$\\mathbb{E}\\!\\left[\\left(\\hat{f}_{j} - f_{j}\\right)^{2}\\right]$简化为$\\hat{f}_{j}$的方差：\n$$\n\\mathbb{E}\\!\\left[\\left(\\hat{f}_{j} - f_{j}\\right)^{2}\\right] = \\mathbb{E}\\!\\left[\\left(\\hat{f}_{j} - \\mathbb{E}[\\hat{f}_{j}]\\right)^{2}\\right] = \\operatorname{Var}(\\hat{f}_{j})\n$$\n问题陈述给出了定义$\\operatorname{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2$。使用该定义，我们有：\n$$\n\\mathbb{E}\\!\\left[\\left(\\hat{f}_{j} - f_{j}\\right)^{2}\\right] = \\mathbb{E}[\\hat{f}_{j}^2 - 2\\hat{f}_{j}f_{j} + f_{j}^2] = \\mathbb{E}[\\hat{f}_{j}^2] - 2f_{j}\\mathbb{E}[\\hat{f}_{j}] + f_{j}^2 = \\mathbb{E}[\\hat{f}_{j}^2] - 2f_{j}^2 + f_{j}^2 = \\mathbb{E}[\\hat{f}_{j}^2] - f_{j}^2 = \\mathbb{E}[\\hat{f}_{j}^2] - (\\mathbb{E}[\\hat{f}_{j}])^2 = \\operatorname{Var}(\\hat{f}_{j})\n$$\n因此，我们的任务简化为计算每个$j$的$\\hat{f}_{j}$的方差，然后将结果相加。利用方差的性质，我们有：\n$$\n\\operatorname{Var}(\\hat{f}_{j}) = \\operatorname{Var}\\!\\left(\\frac{X_{j}}{n}\\right) = \\frac{1}{n^{2}}\\operatorname{Var}(X_{j})\n$$\n如前所述，$X_{j}$服从二项分布，$X_{j} \\sim \\text{Binomial}(n, f_{j})$。这类随机变量的方差由下式给出：\n$$\n\\operatorname{Var}(X_{j}) = n f_{j} (1 - f_{j})\n$$\n将此代入$\\operatorname{Var}(\\hat{f}_{j})$的表达式中：\n$$\n\\operatorname{Var}(\\hat{f}_{j}) = \\frac{1}{n^{2}} [n f_{j} (1 - f_{j})] = \\frac{f_{j} (1 - f_{j})}{n}\n$$\n现在我们可以将此结果代回$Q$的表达式中：\n$$\nQ = \\sum_{j=1}^{k} \\operatorname{Var}(\\hat{f}_{j}) = \\sum_{j=1}^{k} \\frac{f_{j} (1 - f_{j})}{n}\n$$\n我们可以将常数项$1/n$提取出来：\n$$\nQ = \\frac{1}{n} \\sum_{j=1}^{k} f_{j} (1 - f_{j})\n$$\n展开求和式中的项：\n$$\nQ = \\frac{1}{n} \\sum_{j=1}^{k} (f_{j} - f_{j}^{2})\n$$\n通过分配求和符号：\n$$\nQ = \\frac{1}{n} \\left( \\sum_{j=1}^{k} f_{j} - \\sum_{j=1}^{k} f_{j}^{2} \\right)\n$$\n我们已知约束条件，即瓶颈前的比例之和必须为1：$\\sum_{j=1}^{k} f_{j} = 1$。将此代入我们得到的$Q$的表达式中，即可得出最终的闭式表达式：\n$$\nQ = \\frac{1}{n} \\left( 1 - \\sum_{j=1}^{k} f_{j}^{2} \\right)\n$$\n该表达式给出了期望欧氏距离平方，其是关于瓶颈大小$n$和初始表型比例$\\{f_{j}\\}_{j=1}^{k}$的函数，符合题目要求。",
            "answer": "$$\n\\boxed{\\frac{1}{n}\\left(1 - \\sum_{j=1}^{k}f_{j}^{2}\\right)}\n$$"
        },
        {
            "introduction": "现在，我们将视角从静态的采样过程转向动态的平衡。表型异质性通常并非静止不变，而是由潜在的随机分子过程驱动的动态平衡。此练习借鉴了物理学中一个强有力的类比，将一个合成双稳态开关建模为在能量势阱中运动的粒子()。您将运用克莱默斯逃逸率理论来计算细胞在随机噪声驱动下如何在不同表型状态之间转换，并最终揭示系统的“势能景观”如何决定群体中各个表型的稳定比例。",
            "id": "3926597",
            "problem": "克隆群体中的一个合成开关在两个稳定表达状态之间表现出表型异质性，这两个状态分别记为状态 $A$ (高表达) 和状态 $B$ (低表达)。粗粒化底层基因调控网络的慢序参量 $x$ 被建模为一个由加性分子噪声驱动的过阻尼一维随机微分方程 (SDE)：\n$$\n\\frac{dx}{dt} \\;=\\; -\\,\\frac{dU(x)}{dx} \\;+\\; \\sqrt{2\\sigma^{2}}\\,\\eta(t),\n$$\n其中，$U(x)$ 是有效势，$\\sigma^{2}$ 是有效噪声强度，$\\eta(t)$ 是均值为零、方差为一的标准高斯白噪声。在小噪声、亚稳态区域，细胞停留在 $U(x)$ 的局部极小值点 $x_{A}$ 和 $x_{B}$ 附近，偶尔通过热激活逃逸越过中间的鞍点 $x^{\\ddagger}$ 而发生跃迁。假设存在时间尺度分离，使得阱内弛豫相对于阱间转换是快速过程。\n\n给定以下从独立的测量或模拟中获得的粗粒化势的特征：\n- 极小值点的局部势阱曲率：$U''(x_{A}) \\equiv \\kappa_{A} = 3.0$ 和 $U''(x_{B}) \\equiv \\kappa_{B} = 2.0$。\n- 鞍点处曲率的大小：$|U''(x^{\\ddagger})| \\equiv \\kappa^{\\ddagger} = 1.5$。\n- 从各势阱到鞍点的势垒高度：$\\Delta U_{A} \\equiv U(x^{\\ddagger}) - U(x_{A}) = 4.2$ 和 $\\Delta U_{B} \\equiv U(x^{\\ddagger}) - U(x_{B}) = 3.8$。\n- 有效噪声强度：$\\sigma^{2} = 0.7$。\n\n假设适用于一维梯度动力学的小噪声 Kramers 逃逸理论，并且在稳态下，具有细致平衡的两态马尔可夫近似是有效的。以这些假设为基础，计算处于状态 $A$ 的细胞的稳态比例（以 $[0,1]$ 区间内的无量纲小数表示）。将你的答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的。它提出了统计物理学和系统生物学中的一个标准情景，该情景具有科学依据、是适定的且客观的。所有必要的参数都已提供，可以使用已有的理论求解稳态群体比例。\n\n该系统被描述为一个两态马尔可夫过程，状态记为 $A$ 和 $B$，对应于势 $U(x)$ 的局部极小值点。设 $P_A$ 和 $P_B$ 分别为细胞群体处于状态 $A$ 和状态 $B$ 的稳态比例。根据定义，这些比例的总和必须为 1：\n$$\nP_A + P_B = 1\n$$\n在稳态下，细致平衡原理要求从状态 $A$ 到状态 $B$ 的细胞通量等于从状态 $B$ 到状态 $A$ 的通量。这表示为：\n$$\nP_A \\, k_{A \\to B} = P_B \\, k_{B \\to A}\n$$\n其中 $k_{A \\to B}$ 是从状态 $A$ 到状态 $B$ 的跃迁速率，$k_{B \\to A}$ 是从状态 $B$ 到状态 $A$ 的跃迁速率。根据细致平衡条件，我们可以用跃迁速率来表示稳态比例之比：\n$$\n\\frac{P_A}{P_B} = \\frac{k_{B \\to A}}{k_{A \\to B}}\n$$\n问题指明，适用于一维梯度动力学的小噪声 Kramers 逃逸理论是成立的。对于给定的随机微分方程 $\\frac{dx}{dt} = -U'(x) + \\sqrt{2\\sigma^2}\\eta(t)$，从一个势阱（例如，在 $x_i$ 处）越过一个势垒（在 $x^{\\ddagger}$ 处）的 Kramers 逃逸速率由下式给出：\n$$\nk_{i \\to j} = \\frac{\\sqrt{U''(x_i) |U''(x^{\\ddagger})|}}{2\\pi} \\exp\\left(-\\frac{\\Delta U_i}{\\sigma^2}\\right)\n$$\n这里，$U''(x_i)$ 是势在极小值点 $x_i$ 处的曲率，$\\left|U''(x^{\\ddagger})\\right|$ 是在鞍点 $x^{\\ddagger}$ 处曲率的大小，而 $\\Delta U_i = U(x^{\\ddagger}) - U(x_i)$ 是从势阱 $i$ 开始的势垒高度。\n\n使用问题陈述中提供的记号（$U''(x_A) = \\kappa_A$, $U''(x_B) = \\kappa_B$, $|U''(x^{\\ddagger})| = \\kappa^{\\ddagger}$），我们可以写出我们系统的具体跃迁速率：\n从状态 $A$ 到状态 $B$ 的速率是：\n$$\nk_{A \\to B} = \\frac{\\sqrt{\\kappa_A \\kappa^{\\ddagger}}}{2\\pi} \\exp\\left(-\\frac{\\Delta U_A}{\\sigma^2}\\right)\n$$\n从状态 $B$ 到状态 $A$ 的速率是：\n$$\nk_{B \\to A} = \\frac{\\sqrt{\\kappa_B \\kappa^{\\ddagger}}}{2\\pi} \\exp\\left(-\\frac{\\Delta U_B}{\\sigma^2}\\right)\n$$\n现在，我们计算这些速率的比值：\n$$\n\\frac{k_{B \\to A}}{k_{A \\to B}} = \\frac{\\frac{\\sqrt{\\kappa_B \\kappa^{\\ddagger}}}{2\\pi} \\exp\\left(-\\frac{\\Delta U_B}{\\sigma^2}\\right)}{\\frac{\\sqrt{\\kappa_A \\kappa^{\\ddagger}}}{2\\pi} \\exp\\left(-\\frac{\\Delta U_A}{\\sigma^2}\\right)}\n$$\n指前因子 $\\frac{\\sqrt{\\kappa^{\\ddagger}}}{2\\pi}$ 被消去，剩下：\n$$\n\\frac{k_{B \\to A}}{k_{A \\to B}} = \\sqrt{\\frac{\\kappa_B}{\\kappa_A}} \\exp\\left(-\\frac{\\Delta U_B}{\\sigma^2} + \\frac{\\Delta U_A}{\\sigma^2}\\right) = \\sqrt{\\frac{\\kappa_B}{\\kappa_A}} \\exp\\left(\\frac{\\Delta U_A - \\Delta U_B}{\\sigma^2}\\right)\n$$\n因此，稳态比例之比为：\n$$\n\\frac{P_A}{P_B} = \\sqrt{\\frac{\\kappa_B}{\\kappa_A}} \\exp\\left(\\frac{\\Delta U_A - \\Delta U_B}{\\sigma^2}\\right)\n$$\n我们已知以下数值：$\\kappa_A = 3.0$, $\\kappa_B = 2.0$, $\\Delta U_A = 4.2$, $\\Delta U_B = 3.8$, 以及 $\\sigma^2 = 0.7$。将这些数值代入表达式中：\n$$\n\\frac{P_A}{P_B} = \\sqrt{\\frac{2.0}{3.0}} \\exp\\left(\\frac{4.2 - 3.8}{0.7}\\right) = \\sqrt{\\frac{2}{3}} \\exp\\left(\\frac{0.4}{0.7}\\right) = \\sqrt{\\frac{2}{3}} \\exp\\left(\\frac{4}{7}\\right)\n$$\n我们将比值 $\\frac{P_A}{P_B}$ 记为 $R$。为了求出比例 $P_A$，我们使用归一化条件 $P_A + P_B = 1$。由于 $P_B = P_A / R$，我们有：\n$$\nP_A + \\frac{P_A}{R} = 1 \\implies P_A \\left(1 + \\frac{1}{R}\\right) = 1 \\implies P_A \\left(\\frac{R+1}{R}\\right) = 1\n$$\n解出 $P_A$ 可得：\n$$\nP_A = \\frac{R}{R+1}\n$$\n现在，我们计算 $R$ 的数值：\n$$\nR = \\sqrt{\\frac{2}{3}} \\exp\\left(\\frac{4}{7}\\right) \\approx 0.81649658 \\times \\exp(0.57142857) \\approx 0.81649658 \\times 1.77085002 \\approx 1.4460535\n$$\n最后，我们计算 $P_A$：\n$$\nP_A = \\frac{1.4460535}{1 + 1.4460535} = \\frac{1.4460535}{2.4460535} \\approx 0.5911798\n$$\n按照要求将结果四舍五入到四位有效数字，我们得到 $P_A \\approx 0.5912$。这就是处于状态 $A$ 的细胞的稳态比例。",
            "answer": "$$\n\\boxed{0.5912}\n$$"
        },
        {
            "introduction": "掌握了表型分布如何形成和维持的动态原理后，我们需将视野扩展至整个种群的适应性。毕竟，“赌金持平”策略的最终目的是最大化种群的长期增长率。这个练习构建了一个包含出生、死亡和表型转换的完整种群动力学模型()。您将推导并计算作为种群适应性关键指标的主李雅普诺夫指数($\\lambda^\\star$)，并学会如何在恒定环境和周期性波动的复杂环境中评估“赌金持平”策略的成败。",
            "id": "3926558",
            "problem": "考虑一个由表型 $A$ 和表型 $B$ 构成的双表型种群，该种群被建模为一个具有单位细胞出生、死亡和随机表型转换的连续时间分支过程。令 $b_A$ 和 $b_B$ 分别表示单位细胞出生率（单位：$\\mathrm{s}^{-1}$），$d_A$ 和 $d_B$ 分别表示单位细胞死亡率（单位：$\\mathrm{s}^{-1}$），$s_{AB}$ 和 $s_{BA}$ 分别表示从表型 $A$ 到表型 $B$ 以及从表型 $B$ 到表型 $A$ 的单位细胞转换率（单位：$\\mathrm{s}^{-1}$）。令种群大小的期望向量为 $N(t) = \\begin{bmatrix} \\mathbb{E}[n_A(t)] \\\\ \\mathbb{E}[n_B(t)] \\end{bmatrix}$。从分支过程和常微分方程（ODE）的标准线性期望动态出发，构建完整的出生-死亡-转换算子 $M$，使得 $\\dfrac{d}{dt} N(t) = M N(t)$。然后，在以下两种情景中推导主导长期平均种群增长的主李雅普诺夫指数 $\\lambda^\\star$ 的表达式：\n1. 恒定环境：$M$ 是时间齐次的，不随时间变化。\n2. 周期性环境：$M(t)$ 在两个时间齐次算子 $M_1$ 和 $M_2$ 之间交替，持续时间分别为 $\\tau_1$ 和 $\\tau_2$ （单位：秒），并无限重复。\n\n仅使用基于分支过程中期望的线性性质、常系数系统的线性常微分方程解以及矩阵谱性质的原理性推理。避免使用任何未从这些基础推导出的快捷公式。\n\n对于恒定环境，所需的输出量为实数 $\\lambda^\\star$（单位：$\\mathrm{s}^{-1}$），定义为 $M$ 的特征值中最大的实部。对于周期为 $T = \\tau_1 + \\tau_2$ 的周期性环境，所需的输出量为 $\\lambda^\\star = \\dfrac{1}{T} \\log \\rho(P)$，其中 $P = \\exp(M_2 \\tau_2) \\exp(M_1 \\tau_1)$ 是单周期演化算子，$\\rho(P)$ 是 $P$ 的谱半径。\n\n实现一个程序，对于下面测试套件中的每组参数，构建 $M$（以及适用时的 $M_1$、$M_2$），按规定计算 $\\lambda^\\star$，并输出结果。将每个 $\\lambda^\\star$ 以 $\\mathrm{s}^{-1}$ 为单位表示为四舍五入到六位小数的十进制数。\n\n测试套件：\n- 情况 $1$（一般恒定环境）：\n  - $b_A = 1.2$, $d_A = 0.3$, $b_B = 0.6$, $d_B = 0.7$, $s_{AB} = 0.15$, $s_{BA} = 0.05$。\n- 情况 $2$（边界情况：无转换）：\n  - $b_A = 0.8$, $d_A = 0.1$, $b_B = 1.0$, $d_B = 1.2$, $s_{AB} = 0$, $s_{BA} = 0$。\n- 情况 $3$（边缘情况：对称净增长和对称转换）：\n  - $b_A = 0.8$, $d_A = 0.5$, $b_B = 0.75$, $d_B = 0.45$, $s_{AB} = 0.2$, $s_{BA} = 0.2$。\n- 情况 $4$（在 $M_1$ 和 $M_2$ 之间交替的周期性环境）：\n  - 环境 $1$：$b_A^{(1)} = 1.2$, $d_A^{(1)} = 0.3$, $b_B^{(1)} = 0.5$, $d_B^{(1)} = 0.7$, $s_{AB}^{(1)} = 0.12$, $s_{BA}^{(1)} = 0.04$，持续时间 $\\tau_1 = 2.5$。\n  - 环境 $2$：$b_A^{(2)} = 0.7$, $d_A^{(2)} = 0.9$, $b_B^{(2)} = 1.4$, $d_B^{(2)} = 0.5$, $s_{AB}^{(2)} = 0.06$, $s_{BA}^{(2)} = 0.18$，持续时间 $\\tau_2 = 1.5$。\n\n定义和所需构造：\n- 根据 $b_A$, $d_A$, $b_B$, $d_B$, $s_{AB}$, $s_{BA}$ 构造算子 $M$ 作为一个 $2 \\times 2$ 矩阵。\n- 对于周期性环境，以相同形式构造 $M_1$ 和 $M_2$，计算 $P = \\exp(M_2 \\tau_2) \\exp(M_1 \\tau_1)$，然后计算 $\\lambda^\\star$。\n\n你的程序应产生单行输出，包含一个由方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4]$），其中每个 $result_i$ 是为情况 $i$ 计算的 $\\lambda^\\star$，单位为 $\\mathrm{s}^{-1}$，并四舍五入到六位小数。不应打印任何其他输出。",
            "solution": "我们利用分支过程中期望的线性性质，从出生-死亡-转换的描述中推导出线性算子。令 $\\mathbb{E}[n_A(t)]$ 和 $\\mathbb{E}[n_B(t)]$ 分别表示在时间 $t$ 时表型 $A$ 和表型 $B$ 中细胞的期望数量。一个表型 $A$ 的细胞以 $b_A$ 的速率出生，以 $d_A$ 的速率死亡，并以 $s_{AB}$ 的速率转换为表型 $B$。一个表型 $B$ 的细胞以 $b_B$ 的速率出生，以 $d_B$ 的速率死亡，并以 $s_{BA}$ 的速率转换为表型 $A$。在期望上，对 $\\mathbb{E}[n_A(t)]$ 变化率的贡献是净增长率 $(b_A - d_A)$ 乘以 $\\mathbb{E}[n_A(t)]$，减去因转换为 $B$ 而产生的流出 $s_{AB} \\mathbb{E}[n_A(t)]$，再加上因从 $B$ 转换为 $A$ 而产生的流入 $s_{BA} \\mathbb{E}[n_B(t)]$。因此，\n$$\n\\frac{d}{dt} \\mathbb{E}[n_A(t)] = \\left(b_A - d_A - s_{AB}\\right) \\mathbb{E}[n_A(t)] + s_{BA} \\mathbb{E}[n_B(t)].\n$$\n类似地，对于表型 $B$：\n$$\n\\frac{d}{dt} \\mathbb{E}[n_B(t)] = s_{AB} \\mathbb{E}[n_A(t)] + \\left(b_B - d_B - s_{BA}\\right) \\mathbb{E}[n_B(t)].\n$$\n定义期望向量 $N(t) = \\begin{bmatrix} \\mathbb{E}[n_A(t)] \\\\ \\mathbb{E}[n_B(t)] \\end{bmatrix}$ 和算子\n$$\nM = \\begin{bmatrix}\nb_A - d_A - s_{AB}  s_{BA} \\\\\ns_{AB}  b_B - d_B - s_{BA}\n\\end{bmatrix}.\n$$\n该动态系统可以写成线性常微分方程（ODE）\n$$\n\\frac{d}{dt} N(t) = M N(t).\n$$\n对于恒定环境，$M$ 是时间齐次的。其解由矩阵指数给出：\n$$\nN(t) = \\exp(M t) N(0).\n$$\n根据线性算子的谱理论，$N(t)$ 的长期增长由 $M$ 的特征值决定。令 $\\lambda_1, \\lambda_2$ 表示 $M$ 的特征值（可能为复数）。$\\exp(M t)$ 的范数渐近表现为 $\\exp(\\operatorname{Re}(\\lambda_{\\max}) t)$，其中 $\\operatorname{Re}(\\lambda_{\\max})$ 是特征值中最大的实部。因此，恒定环境的主李雅普诺夫指数为\n$$\n\\lambda^\\star = \\max\\left\\{ \\operatorname{Re}(\\lambda_1), \\operatorname{Re}(\\lambda_2) \\right\\}.\n$$\n该量的单位为 $\\mathrm{s}^{-1}$。\n\n对于周期性环境，假设 $M(t)$ 在两个恒定算子 $M_1$ 和 $M_2$ 之间交替，持续时间分别为 $\\tau_1$ 和 $\\tau_2$，总周期为 $T = \\tau_1 + \\tau_2$。在一个周期内，状态根据单值矩阵进行传播\n$$\nP = \\exp(M_2 \\tau_2) \\exp(M_1 \\tau_1),\n$$\n因此在 $k$ 个周期后，\n$$\nN(k T) = P^k N(0).\n$$\n令 $\\mu_1, \\mu_2$ 表示 $P$ 的特征值，令 $\\rho(P) = \\max\\{ |\\mu_1|, |\\mu_2| \\}$ 表示谱半径。一个周期内的增长是乘以一个因子 $\\rho(P)$，因此单位时间的主李雅普诺夫指数为\n$$\n\\lambda^\\star = \\frac{1}{T} \\log \\rho(P).\n$$\n\n算法实现：\n- 对于每个恒定环境的情况，从 $(b_A, d_A, b_B, d_B, s_{AB}, s_{BA})$ 构建 $M$，计算其特征值，并取其实部的最大值作为 $\\lambda^\\star$。\n- 对于周期性环境的情况，从各自的参数构建 $M_1$ 和 $M_2$，计算 $\\exp(M_1 \\tau_1)$ 和 $\\exp(M_2 \\tau_2)$，形成 $P = \\exp(M_2 \\tau_2)\\exp(M_1 \\tau_1)$，计算 $P$ 的特征值，取谱半径 $\\rho(P)$，并计算 $\\lambda^\\star = \\dfrac{1}{\\tau_1 + \\tau_2} \\log \\rho(P)$。\n\n合理性检查和边缘情况：\n- 当 $s_{AB} = s_{BA} = 0$ 时，$M$ 是对角矩阵，对角元为 $(b_A - d_A)$ 和 $(b_B - d_B)$，所以 $\\lambda^\\star = \\max\\{ b_A - d_A, b_B - d_B \\}$。\n- 对于对称转换和相等的净增长率 $b_A - d_A = b_B - d_B = r$，如果 $s_{AB} = s_{BA} = s$，则算子形式为 $M = \\begin{bmatrix} r - s  s \\\\ s  r - s \\end{bmatrix}$，其特征值为 $r$ 和 $r - 2s$。因此 $\\lambda^\\star = r$，这表明当两种表型具有相等的净增长率时，对称转换不改变主导增长率。\n\n该程序计算所提供的测试套件的四个请求的 $\\lambda^\\star$ 值，并以 $[x_1,x_2,x_3,x_4]$ 的格式单行打印，每个值都四舍五入到六位小数，单位 $\\mathrm{s}^{-1}$ 从模型参数单位中隐式理解。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm, eigvals\n\ndef operator_matrix(bA, dA, bB, dB, sAB, sBA):\n    \"\"\"\n    Construct the 2x2 birth-death-switchover operator matrix M.\n    M = [[bA - dA - sAB, sBA],\n         [sAB,           bB - dB - sBA]]\n    \"\"\"\n    return np.array([[bA - dA - sAB, sBA],\n                     [sAB,           bB - dB - sBA]], dtype=float)\n\ndef leading_exponent_constant(M):\n    \"\"\"\n    Compute the leading Lyapunov exponent (largest real part of eigenvalues) for constant M.\n    \"\"\"\n    vals = eigvals(M)\n    # Largest real part\n    return float(np.max(np.real(vals)))\n\ndef leading_exponent_periodic(M1, tau1, M2, tau2):\n    \"\"\"\n    Compute the leading Lyapunov exponent for a periodic environment alternating M1 (duration tau1)\n    and M2 (duration tau2). One-cycle propagator P = exp(M2*tau2) @ exp(M1*tau1).\n    Lyapunov exponent lambda* = (1/(tau1+tau2)) * log(spectral_radius(P)).\n    \"\"\"\n    P = expm(M2 * tau2) @ expm(M1 * tau1)\n    # Spectral radius: max absolute value of eigenvalues\n    evals = eigvals(P)\n    rho = np.max(np.abs(evals))\n    # Guard against numerical issues: rho must be positive real\n    return float(np.log(rho) / (tau1 + tau2))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: general constant environment\n        {\n            \"type\": \"constant\",\n            \"params\": {\n                \"bA\": 1.2, \"dA\": 0.3, \"bB\": 0.6, \"dB\": 0.7, \"sAB\": 0.15, \"sBA\": 0.05\n            }\n        },\n        # Case 2: boundary case (no switching)\n        {\n            \"type\": \"constant\",\n            \"params\": {\n                \"bA\": 0.8, \"dA\": 0.1, \"bB\": 1.0, \"dB\": 1.2, \"sAB\": 0.0, \"sBA\": 0.0\n            }\n        },\n        # Case 3: symmetric net growth and symmetric switching\n        {\n            \"type\": \"constant\",\n            \"params\": {\n                \"bA\": 0.8, \"dA\": 0.5, \"bB\": 0.75, \"dB\": 0.45, \"sAB\": 0.2, \"sBA\": 0.2\n            }\n        },\n        # Case 4: periodic environment alternating between M1 and M2\n        {\n            \"type\": \"periodic\",\n            \"params\": {\n                # Environment 1\n                \"bA1\": 1.2, \"dA1\": 0.3, \"bB1\": 0.5, \"dB1\": 0.7, \"sAB1\": 0.12, \"sBA1\": 0.04, \"tau1\": 2.5,\n                # Environment 2\n                \"bA2\": 0.7, \"dA2\": 0.9, \"bB2\": 1.4, \"dB2\": 0.5, \"sAB2\": 0.06, \"sBA2\": 0.18, \"tau2\": 1.5\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        ctype = case[\"type\"]\n        p = case[\"params\"]\n        if ctype == \"constant\":\n            M = operator_matrix(p[\"bA\"], p[\"dA\"], p[\"bB\"], p[\"dB\"], p[\"sAB\"], p[\"sBA\"])\n            lam = leading_exponent_constant(M)\n            results.append(lam)\n        elif ctype == \"periodic\":\n            M1 = operator_matrix(p[\"bA1\"], p[\"dA1\"], p[\"bB1\"], p[\"dB1\"], p[\"sAB1\"], p[\"sBA1\"])\n            M2 = operator_matrix(p[\"bA2\"], p[\"dA2\"], p[\"bB2\"], p[\"dB2\"], p[\"sAB2\"], p[\"sBA2\"])\n            lam = leading_exponent_periodic(M1, p[\"tau1\"], M2, p[\"tau2\"])\n            results.append(lam)\n        else:\n            # Should not occur given the test suite; default to NaN\n            results.append(float(\"nan\"))\n\n    # Round to six decimal places and format as required.\n    formatted = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted)}]\")\n\nsolve()\n```"
        }
    ]
}