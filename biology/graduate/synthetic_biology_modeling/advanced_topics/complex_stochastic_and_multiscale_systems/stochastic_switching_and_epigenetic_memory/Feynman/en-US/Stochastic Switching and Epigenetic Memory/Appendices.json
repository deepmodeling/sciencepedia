{
    "hands_on_practices": [
        {
            "introduction": "Before delving into the complex dynamics of a genetic circuit, it is essential to simplify the model to its core components. This practice focuses on nondimensionalization, a powerful mathematical technique that reduces a system with numerous physical parameters to one governed by a minimal set of dimensionless groups. By applying this method to the classic toggle switch model, you will learn to identify the key parameter combinations that control feedback strength and timescale separation, providing fundamental insights into the requirements for bistability and epigenetic memory .",
            "id": "3932577",
            "problem": "Consider a mutually repressing genetic toggle switch implemented by two transcription factors, $A$ and $B$, where each inhibits transcription of the other. Assume standard mass-action degradation and Hill-type transcriptional repression based on equilibrium binding occupancy consistent with thermodynamic models of promoter regulation. Let $A(t)$ and $B(t)$ denote the concentrations of the two proteins at time $t$. The dimensional model is given by the coupled Ordinary Differential Equations (ODEs):\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{\\alpha_{A}}{1 + \\left(\\frac{B}{K_{B}}\\right)^{n}} \\;-\\; \\delta_{A} A\n\\qquad\\text{and}\\qquad\n\\frac{dB}{dt} \\;=\\; \\frac{\\alpha_{B}}{1 + \\left(\\frac{A}{K_{A}}\\right)^{m}} \\;-\\; \\delta_{B} B,\n$$\nwhere $\\alpha_{A}$ and $\\alpha_{B}$ are maximal (derepressed) production rates determined by transcription and translation kinetics, $K_{A}$ and $K_{B}$ are binding constants that set characteristic repression thresholds for $A$ and $B$, $m$ and $n$ are Hill coefficients reflecting cooperativity of repressor binding, and $\\delta_{A}$ and $\\delta_{B}$ are first-order degradation/dilution rates. In this context, stochastic switching between epigenetically stable states emerges from noise acting on a deterministically bistable backbone; therefore, dimensionless groups controlling feedback strength and timescale separation are essential to interpret memory and switching phenomena.\n\nStarting from the above dimensional model and using only scales deducible from the model parameters, nondimensionalize the system to reduce it to a minimal set of dimensionless parameters. Your construction should be based on concentration scales associated with $K_{A}$ and $K_{B}$ and a timescale associated with $\\delta_{A}$. Derive the dimensionless ODEs and identify the minimal set of independent dimensionless parameter groups that fully characterize the dynamics after nondimensionalization. Provide a concise, physically grounded interpretation of each dimensionless group in terms of feedback strength, nonlinearity, and timescale separation relevant to epigenetic memory and stochastic switching.\n\nExpress your final result as a row matrix listing the dimensionless parameter groups in the order $\\left(\\text{feedback strength of }A,\\; \\text{feedback strength of }B,\\; \\text{timescale ratio},\\; m,\\; n\\right)$. The final answer must be a single analytic expression. No numerical evaluation or rounding is required.",
            "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\nThe a priori information consists of a system of two coupled ordinary differential equations (ODEs) for the concentrations of proteins $A(t)$ and $B(t)$:\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{\\alpha_{A}}{1 + \\left(\\frac{B}{K_{B}}\\right)^{n}} \\;-\\; \\delta_{A} A\n$$\n$$\n\\frac{dB}{dt} \\;=\\; \\frac{\\alpha_{B}}{1 + \\left(\\frac{A}{K_{A}}\\right)^{m}} \\;-\\; \\delta_{B} B\n$$\nThe parameters are defined as:\n- $\\alpha_{A}, \\alpha_{B}$: maximal production rates.\n- $K_{A}, K_{B}$: binding constants (repression thresholds).\n- $m, n$: Hill coefficients (cooperativity).\n- $\\delta_{A}, \\delta_{B}$: first-order degradation/dilution rates.\n\nThe instructions for nondimensionalization are to use concentration scales associated with $K_{A}$ and $K_{B}$, and a timescale associated with $\\delta_{A}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The model is the canonical Gardner-Collins toggle switch, a foundational model in synthetic biology. The use of Hill functions to model cooperative repression and first-order degradation terms are standard and well-established in biochemical kinetics. The problem is firmly grounded in established scientific principles.\n- **Well-Posed**: The task is to perform a nondimensionalization, which is a standard mathematical procedure. The instructions for choosing the scales are explicit, ensuring the derivation leads to a unique result. The problem is well-posed.\n- **Objective**: The problem is stated in precise mathematical and scientific language, free of ambiguity or subjective claims.\n- **Completeness and Consistency**: All necessary equations and parameters are provided. The scaling rules are clearly defined. There are no contradictions.\n- **Other Flaws**: The problem is not trivial, as it requires careful algebraic manipulation and physical interpretation. It is a standard, meaningful exercise in the analysis of dynamical systems in biology.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically sound, well-posed, objective, and complete. A full solution will be provided.\n\nTo nondimensionalize the system, we introduce dimensionless variables for concentration and time based on the scales specified in the problem statement. The characteristic concentrations for repression are $K_A$ and $K_B$, and the characteristic timescale is the lifetime of protein A, which is $1/\\delta_A$.\n\nLet us define the dimensionless concentrations $a$ and $b$, and dimensionless time $\\tau$ as follows:\n$$\na = \\frac{A}{K_A}, \\qquad b = \\frac{B}{K_B}, \\qquad \\tau = t \\delta_A\n$$\nFrom these definitions, we can express the original variables and their derivatives in terms of the new dimensionless ones:\n$$\nA = K_A a, \\qquad B = K_B b, \\qquad t = \\frac{\\tau}{\\delta_A}\n$$\nThe time derivative transforms according to the chain rule:\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau} = \\delta_A \\frac{d}{d\\tau}\n$$\nNow, we can substitute these into the original ODEs.\n\nFor the equation governing $A(t)$:\n$$\n\\frac{d(K_A a)}{dt} = \\frac{\\alpha_{A}}{1 + \\left(\\frac{K_B b}{K_{B}}\\right)^{n}} - \\delta_{A} (K_A a)\n$$\nApplying the transformed time derivative:\n$$\nK_A \\frac{da}{dt} = K_A \\delta_A \\frac{da}{d\\tau} = \\frac{\\alpha_{A}}{1 + b^{n}} - \\delta_A K_A a\n$$\nDividing the entire equation by $K_A \\delta_A$ to isolate the dimensionless derivative $\\frac{da}{d\\tau}$:\n$$\n\\frac{da}{d\\tau} = \\frac{\\alpha_A}{K_A \\delta_A} \\frac{1}{1 + b^n} - a\n$$\nThis gives the first dimensionless equation.\n\nFor the equation governing $B(t)$:\n$$\n\\frac{d(K_B b)}{dt} = \\frac{\\alpha_{B}}{1 + \\left(\\frac{K_A a}{K_{A}}\\right)^{m}} - \\delta_{B} (K_B b)\n$$\nApplying the transformed time derivative:\n$$\nK_B \\frac{db}{dt} = K_B \\delta_A \\frac{db}{d\\tau} = \\frac{\\alpha_{B}}{1 + a^{m}} - \\delta_B K_B b\n$$\nDividing the entire equation by $K_B \\delta_A$:\n$$\n\\frac{db}{d\\tau} = \\frac{\\alpha_B}{K_B \\delta_A} \\frac{1}{1 + a^m} - \\frac{\\delta_B}{\\delta_A} b\n$$\nThis gives the second dimensionless equation.\n\nThe system dynamics are now controlled by a minimal set of independent dimensionless parameter groups. We must identify these groups and provide a physical interpretation. The parameters that appear are $\\frac{\\alpha_A}{K_A \\delta_A}$, $\\frac{\\alpha_B}{K_B \\delta_A}$, $\\frac{\\delta_B}{\\delta_A}$, $m$, and $n$. To achieve a more symmetric and physically intuitive representation, we can define the core feedback strengths and timescale ratios.\n\n1.  **Feedback Strength of A**: The group $\\frac{\\alpha_A}{K_A \\delta_A}$. Let's call this $\\gamma_A$. The term $\\alpha_A / \\delta_A$ represents the maximum possible steady-state concentration of A (when $B=0$). Thus, $\\gamma_A = \\frac{\\alpha_A/\\delta_A}{K_A}$ is the ratio of the maximal steady-state concentration of A to its own repression constant for B's promoter. It is a dimensionless measure of the feedback loop's gain. For bistability, this value must be sufficiently greater than $1$.\n\n2.  **Feedback Strength of B**: By symmetry, the feedback strength for B should be defined as $\\gamma_B = \\frac{\\alpha_B/\\delta_B}{K_B}$. This is the ratio of the maximal steady-state concentration of B to its repression constant $K_B$. This parameter provides the most direct physical insight into the gain of the B-producing part of the circuit.\n\n3.  **Timescale Ratio**: The group $\\frac{\\delta_B}{\\delta_A}$. Let's call this $\\delta$. This is the ratio of the degradation/dilution rate of B to that of A. It quantifies the separation of timescales between the two protein dynamics. If $\\delta \\neq 1$, one protein is more stable than the other, which affects the path and speed of switching between states.\n\n4.  **Hill Coefficients**: $m$ and $n$ are inherently dimensionless and represent the degree of cooperativity in the repression of gene B by A and gene A by B, respectively. They control the ultrasensitivity or steepness of the repressive response, which is crucial for creating a bistable switch.\n\nThe set of five independent dimensionless groups is $\\{\\gamma_A, \\gamma_B, \\delta, m, n\\}$. We can rewrite the second dimensionless ODE in terms of this set. The coefficient $\\frac{\\alpha_B}{K_B \\delta_A}$ can be expressed as:\n$$\n\\frac{\\alpha_B}{K_B \\delta_A} = \\left(\\frac{\\alpha_B}{K_B \\delta_B}\\right) \\left(\\frac{\\delta_B}{\\delta_A}\\right) = \\gamma_B \\delta\n$$\nSo the final dimensionless system of ODEs is:\n$$\n\\frac{da}{d\\tau} = \\gamma_A \\frac{1}{1 + b^n} - a\n$$\n$$\n\\frac{db}{d\\tau} = \\gamma_B \\delta \\frac{1}{1 + a^m} - \\delta b = \\delta \\left( \\gamma_B \\frac{1}{1 + a^m} - b \\right)\n$$\nThe dynamics of the toggle switch are fully determined by the five dimensionless parameters identified: $\\gamma_A = \\frac{\\alpha_A}{K_A \\delta_A}$, $\\gamma_B = \\frac{\\alpha_B}{K_B \\delta_B}$, $\\delta = \\frac{\\delta_B}{\\delta_A}$, $m$, and $n$. Arranged in the requested order, these form the final answer.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha_{A}}{K_{A} \\delta_{A}} & \\frac{\\alpha_{B}}{K_{B} \\delta_{B}} & \\frac{\\delta_{B}}{\\delta_{A}} & m & n\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With a dimensionless model in hand, we can analyze the deterministic backbone that underpins epigenetic memory. This exercise guides you through a linear stability analysis to map the system's \"epigenetic landscape,\" identifying its fixed points and classifying their stability. You will mathematically locate the stable states that correspond to cellular memory and the unstable saddle point that forms the barrier between them, which is critical for understanding noise-induced switching events .",
            "id": "3932610",
            "problem": "Consider a synthetic two-gene toggle switch with mutual transcriptional repression modeled by Hill-type regulatory functions. Let $x(t)$ and $y(t)$ denote the dimensionless protein concentrations of regulator $X$ and regulator $Y$, respectively. Assume degradation is first-order with rate constants $1\\,\\mathrm{min}^{-1}$ for both species, and maximum synthesis rates are balanced such that in the absence of repression the net production is $4\\,\\mathrm{min}^{-1}$ for each gene. Cooperativity (Hill coefficient) of repression is $2$ for both interactions. The dynamics are given by the deterministic ordinary differential equations\n$$\n\\frac{dx}{dt} = \\frac{4}{1 + y^{2}} - x,\\qquad \\frac{dy}{dt} = \\frac{4}{1 + x^{2}} - y,\n$$\nwhere $t$ is time in minutes. In the context of epigenetic memory, stable fixed points correspond to heritable expression states, and noise-induced switching between these epigenetic states is mediated by passage near an unstable saddle fixed point in the deterministic flow.\n\nTasks:\n1. Find all fixed points $(x^{\\ast}, y^{\\ast})$ by solving the steady-state conditions $\\frac{dx}{dt}=0$ and $\\frac{dy}{dt}=0$.\n2. Derive the Jacobian matrix of the vector field at a general point $(x,y)$ and evaluate it at each fixed point found in Task 1.\n3. Compute the eigenvalues at each fixed point and determine their linear stability classification. Identify the unstable saddle fixed point that mediates noise-induced switching.\n4. From your analysis, extract the positive (unstable) eigenvalue of the Jacobian at the saddle fixed point. Report this value as your final answer. Round your answer to four significant figures and express it in $\\mathrm{min}^{-1}$.",
            "solution": "We begin from the foundational modeling picture of gene regulation and the Central Dogma of molecular biology, which motivates ordinary differential equation models for protein concentration dynamics under transcriptional regulation. Mutual repression in a toggle switch is captured by Hill-type input-output functions. The deterministic dynamics given are\n$$\n\\frac{dx}{dt} = f(x,y) = \\frac{4}{1+y^{2}} - x,\\qquad \\frac{dy}{dt} = g(x,y) = \\frac{4}{1+x^{2}} - y,\n$$\nwith linear degradation at rate $1\\,\\mathrm{min}^{-1}$ for both $x$ and $y$ and symmetric Hill repression with coefficient $2$.\n\nTask 1: Fixed points are defined by $f(x^{\\ast},y^{\\ast})=0$ and $g(x^{\\ast},y^{\\ast})=0$, i.e.,\n$$\nx^{\\ast} = \\frac{4}{1+(y^{\\ast})^{2}},\\qquad y^{\\ast} = \\frac{4}{1+(x^{\\ast})^{2}}.\n$$\nBy symmetry, one fixed point satisfies $x^{\\ast}=y^{\\ast}=s$, where $s$ solves\n$$\ns = \\frac{4}{1+s^{2}}\\quad\\Longleftrightarrow\\quad s(1+s^{2}) = 4\\quad\\Longleftrightarrow\\quad s^{3} + s - 4 = 0.\n$$\nThis cubic has one real root, which we can represent in closed form using Cardano’s formula for the depressed cubic $t^{3} + pt + q = 0$ with $p=1$ and $q=-4$. The discriminant is\n$$\n\\Delta = \\left(\\frac{q}{2}\\right)^{2} + \\left(\\frac{p}{3}\\right)^{3} = 4 + \\frac{1}{27} = \\frac{109}{27}.\n$$\nThus,\n$$\ns = \\sqrt[3]{2 + \\sqrt{\\frac{109}{27}}} + \\sqrt[3]{2 - \\sqrt{\\frac{109}{27}}}.\n$$\nIn addition to this symmetric fixed point, there are two asymmetric fixed points due to mutual repression: one with $x^{\\ast}$ large, $y^{\\ast}$ small, and one with $x^{\\ast}$ small, $y^{\\ast}$ large. These satisfy the steady-state equations above and can be obtained numerically by iteration. Approximations are:\n$$\n(x^{\\ast},y^{\\ast}) \\approx (3.737,\\,0.267),\\qquad (x^{\\ast},y^{\\ast}) \\approx (0.267,\\,3.737),\n$$\nwhich are consistent with the symmetric parameterization of the system.\n\nTask 2: The Jacobian matrix $J(x,y)$ of the vector field $(f,g)$ at a general point $(x,y)$ is defined by\n$$\nJ(x,y) = \\begin{pmatrix}\n\\frac{\\partial f}{\\partial x} & \\frac{\\partial f}{\\partial y} \\\\\n\\frac{\\partial g}{\\partial x} & \\frac{\\partial g}{\\partial y}\n\\end{pmatrix}.\n$$\nWe compute the partial derivatives. Since $f(x,y) = \\frac{4}{1+y^{2}} - x$, we have\n$$\n\\frac{\\partial f}{\\partial x} = -1,\\qquad \\frac{\\partial f}{\\partial y} = 4\\,\\frac{d}{dy}\\left(\\frac{1}{1+y^{2}}\\right) = 4\\left(-\\frac{2y}{(1+y^{2})^{2}}\\right) = -\\frac{8y}{(1+y^{2})^{2}}.\n$$\nSimilarly, for $g(x,y) = \\frac{4}{1+x^{2}} - y$,\n$$\n\\frac{\\partial g}{\\partial x} = 4\\,\\frac{d}{dx}\\left(\\frac{1}{1+x^{2}}\\right) = 4\\left(-\\frac{2x}{(1+x^{2})^{2}}\\right) = -\\frac{8x}{(1+x^{2})^{2}},\\qquad \\frac{\\partial g}{\\partial y} = -1.\n$$\nTherefore,\n$$\nJ(x,y) = \\begin{pmatrix}\n-1 & -\\dfrac{8y}{(1+y^{2})^{2}} \\\\\n-\\dfrac{8x}{(1+x^{2})^{2}} & -1\n\\end{pmatrix}.\n$$\n\nTask 3: The eigenvalues $\\lambda$ of a $2\\times 2$ matrix of the form\n$$\n\\begin{pmatrix}\n-1 & -A \\\\\n- B & -1\n\\end{pmatrix}\n$$\nare given by the roots of the characteristic polynomial\n$$\n\\det\\!\\left(J - \\lambda I\\right) = \\left(-1 - \\lambda\\right)^{2} - A B = 0,\n$$\nwhich yields\n$$\n\\lambda_{\\pm} = -1 \\pm \\sqrt{A B},\n$$\nwhere\n$$\nA = \\frac{8y}{(1+y^{2})^{2}},\\qquad B = \\frac{8x}{(1+x^{2})^{2}}.\n$$\nStability at a fixed point $(x^{\\ast}, y^{\\ast})$ depends on the signs of $\\lambda_{\\pm}$. If $\\sqrt{A B} < 1$, then $\\lambda_{+} = -1 + \\sqrt{A B} < 0$ and $\\lambda_{-} = -1 - \\sqrt{A B} < 0$, so the fixed point is linearly stable. If $\\sqrt{A B} > 1$, then $\\lambda_{+} > 0$ and $\\lambda_{-} < 0$, and the fixed point is a saddle with one unstable direction.\n\nWe now classify the fixed points found in Task 1. For the asymmetric fixed points, numerically evaluating $A$ and $B$ shows:\n- At $(x^{\\ast},y^{\\ast}) \\approx (3.737,\\,0.267)$, we have\n$$\nA \\approx \\frac{8\\cdot 0.267}{(1+0.267^{2})^{2}} \\approx 1.861,\\qquad B \\approx \\frac{8\\cdot 3.737}{(1+3.737^{2})^{2}} \\approx 0.1335,\n$$\nso $A B \\approx 0.2487$ and $\\sqrt{A B} \\approx 0.4987 < 1$. Thus both eigenvalues are negative: $\\lambda_{\\pm} \\approx -1 \\pm 0.4987$, a stable fixed point. By symmetry, $(x^{\\ast},y^{\\ast}) \\approx (0.267,\\,3.737)$ is also stable.\n- At the symmetric fixed point $(x^{\\ast},y^{\\ast}) = (s,s)$ with $s$ defined above, we can simplify $A$ and $B$ using the steady-state relation. From $s = \\dfrac{4}{1+s^{2}}$ we infer $1+s^{2} = \\dfrac{4}{s}$, hence\n$$\nA = \\frac{8 s}{(1+s^{2})^{2}} = \\frac{8 s}{\\left(\\dfrac{4}{s}\\right)^{2}} = \\frac{8 s}{\\dfrac{16}{s^{2}}} = \\frac{8 s^{3}}{16} = \\frac{s^{3}}{2},\n$$\nand similarly $B = \\dfrac{s^{3}}{2}$. Therefore $A B = \\left(\\dfrac{s^{3}}{2}\\right)^{2}$ and\n$$\n\\sqrt{A B} = \\frac{s^{3}}{2}.\n$$\nUsing the cubic steady-state condition $s^{3} + s - 4 = 0$, we have $s^{3} = 4 - s$, so\n$$\n\\sqrt{A B} = \\frac{4 - s}{2} = 2 - \\frac{s}{2}.\n$$\nThe Jacobian eigenvalues at the symmetric fixed point are\n$$\n\\lambda_{\\pm} = -1 \\pm \\left(2 - \\frac{s}{2}\\right),\n$$\nso\n$$\n\\lambda_{+} = 1 - \\frac{s}{2},\\qquad \\lambda_{-} = -3 + \\frac{s}{2}.\n$$\nSince $s$ is positive and numerically $s \\approx 1.3788$ (obtained from the closed-form expression for $s$), we find\n$$\n\\lambda_{+} \\approx 1 - \\frac{1.3788}{2} \\approx 0.3106,\\qquad \\lambda_{-} \\approx -3 + \\frac{1.3788}{2} \\approx -2.3106.\n$$\nThus the symmetric fixed point is a saddle with one positive (unstable) eigenvalue and one negative (stable) eigenvalue. This saddle mediates noise-induced switching between the two stable epigenetic memory states in the presence of stochastic fluctuations.\n\nTask 4: The positive (unstable) eigenvalue at the saddle is $\\lambda_{+} = 1 - \\dfrac{s}{2}$, with\n$$\ns = \\sqrt[3]{2 + \\sqrt{\\frac{109}{27}}} + \\sqrt[3]{2 - \\sqrt{\\frac{109}{27}}}.\n$$\nEvaluating this expression numerically yields $\\lambda_{+} \\approx 0.3106\\,\\mathrm{min}^{-1}$. Rounded to four significant figures, the value is $0.3106\\,\\mathrm{min}^{-1}$.",
            "answer": "$$\\boxed{0.3106}$$"
        },
        {
            "introduction": "While deterministic analysis reveals the existence of stable states, it doesn't capture the dynamics of how a cell transitions between them. Such switching events are driven by molecular noise and are often rare, posing a significant computational challenge. This practice introduces importance sampling, an advanced Monte Carlo technique, to efficiently simulate and quantify the rate of these rare stochastic transitions, allowing you to move beyond the static landscape and directly probe the stability and dynamics of epigenetic memory .",
            "id": "3932586",
            "problem": "You are given a one-dimensional stochastic gene-expression model with positive feedback that exhibits epigenetic memory as rare stochastic switches from a low-expression basin to a high-expression basin. The state is the copy number $x \\in \\{0,1,2,\\ldots\\}$. Two reactions occur: synthesis increases $x$ by $+1$ with propensity $a_{1}(x)$ and degradation decreases $x$ by $-1$ with propensity $a_{2}(x)$. The propensities are defined by $a_{1}(x) = k_{\\mathrm{basal}} + k_{\\mathrm{act}} \\dfrac{x^{n}}{K^{n} + x^{n}}$ and $a_{2}(x) = k_{\\mathrm{deg}} \\, x$, where $k_{\\mathrm{basal}}$, $k_{\\mathrm{act}}$, $K$, $n$, and $k_{\\mathrm{deg}}$ are positive parameters. The stochastic simulation algorithm (also known as Gillespie’s algorithm) defines an exact continuous-time Markov jump process with these propensities. You will estimate an unbiased rare switching rate using importance sampling with a biasing potential and correct reweighting.\n\nFundamental base you may assume: for a continuous-time Markov jump process with propensities $\\{a_{j}(x)\\}_{j=1}^{J}$, the probability density for a path over a time horizon is determined by the waiting-time law dictated by the total rate $a_{0}(x) = \\sum_{j=1}^{J} a_{j}(x)$ and the discrete reaction-channel selection probabilities proportional to $a_{j}(x)$. You may also assume the standard product-integral structure of path probabilities for such processes.\n\nDefine a rare-event target as hitting or exceeding a threshold $H$ before a fixed horizon $T$, starting from an initial copy number $x(0) = x_{0}$ in the low-expression basin. Let $\\tau$ be the first hitting time of the set $\\{x \\ge H\\}$. The rare-event probability is $P(T) = \\mathbb{P}(\\tau \\le T)$ under the unbiased dynamics $\\{a_{j}\\}$. The rare switching rate in the small-probability regime is defined as $r \\equiv P(T)/T$ in units of $1/\\text{time}$.\n\nYou will accelerate the event using importance sampling by simulating from a biased process with propensities $\\{\\tilde{a}_{j}\\}$ defined by an exponential tilting of the progress coordinate $q(x) = x$. Specifically, for each reaction $j$, let the stoichiometric increment be $\\nu_{1}=+1$ for synthesis and $\\nu_{2}=-1$ for degradation. For a given scalar bias strength $\\theta \\in \\mathbb{R}$, define the biased propensities by $\\tilde{a}_{j}(x) = a_{j}(x) \\exp(\\theta \\, \\nu_{j})$. The biased process favors upward moves for $\\theta > 0$ and disfavors them for $\\theta < 0$.\n\nTasks:\n- From first principles, derive the exact trajectory reweighting factor that expresses the Radon–Nikodym derivative of the unbiased path law with respect to the biased path law for this setting. The derivation must start from the standard product-integral form of path probabilities for continuous-time Markov jump processes and the definition of the exponential tilting above. Your final expression must be valid for a general trajectory that may be truncated at the stopping time $\\min\\{\\tau, T\\}$.\n- Design an algorithm that uses Gillespie’s algorithm to simulate trajectories under the biased propensities $\\{\\tilde{a}_{j}\\}$, accumulates the derived trajectory reweighting factor along each simulated path up to $\\min\\{\\tau, T\\}$, and forms an unbiased Monte Carlo estimator for $P(T) = \\mathbb{E}_{\\text{biased}}[W \\, \\mathbf{1}_{\\{\\tau \\le T\\}}]$, where $W$ is the derived reweighting factor.\n- Using the small-probability approximation $r \\approx P(T)/T$, report the estimated rate $r$ in $1/\\text{time}$ for each test case below.\n\nModel parameters to use in all test cases:\n- $k_{\\mathrm{basal}} = 0.10$, $k_{\\mathrm{act}} = 1.50$, $K = 25.0$, $n = 2$, $k_{\\mathrm{deg}} = 0.10$, $x_{0} = 3$.\nSimulation guidelines:\n- Use exact stochastic simulation under the biased propensities $\\{\\tilde{a}_{j}\\}$ with the specified $\\theta$ in each case.\n- For numerical stability, you may accumulate the logarithm of the weight and exponentiate at the end of a trajectory.\n- For each test case, use exactly $N = 3000$ independent trajectories to estimate $P(T)$.\n\nTest suite:\n- Case A (unbiased baseline): $\\theta = 0.0$, $T = 40.0$, $H = 35$.\n- Case B (moderate positive bias): $\\theta = 0.8$, $T = 40.0$, $H = 35$.\n- Case C (stronger positive bias): $\\theta = 1.2$, $T = 40.0$, $H = 35$.\n- Case D (different horizon and threshold): $\\theta = 0.5$, $T = 30.0$, $H = 38$.\n\nRequired final program output:\n- Your program should produce a single line of output containing the estimated rare switching rates for the four cases, in $1/\\text{time}$, as a comma-separated list enclosed in square brackets (for example, $[0.00123,0.00098,0.00105,0.00076]$). The order must be Case A, then Case B, then Case C, then Case D. Use the exact values computed by your simulation without additional text or units.",
            "solution": "The problem is scientifically grounded, well-posed, and objective. It specifies a standard stochastic model of gene expression, a well-defined rare event, and a standard statistical method (importance sampling with exponential tilting) to estimate its rate. All parameters and conditions are clearly defined and consistent. The problem is therefore valid.\n\n### Derivation of the Trajectory Reweighting Factor\n\nThe primary task is to derive the reweighting factor, which is the Radon–Nikodym derivative of the unbiased path measure $P$ with respect to the biased path measure $\\tilde{P}$. We begin with the probability density for a single trajectory of a continuous-time Markov jump process.\n\nA trajectory over a time interval $[0, \\tau_{\\text{stop}}]$ is specified by the sequence of states visited and the times of the jumps, denoted as $\\mathbf{x} = \\{(x_0, t_0=0), (x_1, t_1), \\dots, (x_K, t_K)\\}$, where the system jumps from state $x_{i-1}$ to $x_i$ at time $t_i$ via reaction $j_i$, and $t_K < \\tau_{\\text{stop}}$. The process remains in state $x_K$ for the final time interval $[t_K, \\tau_{\\text{stop}})$. The stopping time $\\tau_{\\text{stop}}$ is defined as $\\min\\{\\tau, T\\}$, where $\\tau$ is the first hitting time of the set $\\{x \\ge H\\}$ and $T$ is the fixed time horizon.\n\nThe probability density of this trajectory under the original dynamics, characterized by propensities $\\{a_j(x)\\}$, is given by the product-integral form:\n$$\nP(\\mathbf{x}) = \\left[ \\prod_{i=1}^{K} a_{j_i}(x_{i-1}) \\right] \\exp\\left( -\\int_0^{\\tau_{\\text{stop}}} a_0(x(s)) ds \\right)\n$$\nwhere $a_0(x(s)) = \\sum_j a_j(x(s))$ is the total propensity or escape rate from state $x(s)$. Since the state is piecewise constant, i.e., $x(s) = x_{i-1}$ for $s \\in [t_{i-1}, t_i)$, a more explicit form is:\n$$\nP(\\mathbf{x}) = \\left[ \\prod_{i=1}^{K} a_{j_i}(x_{i-1}) \\right] \\exp\\left( -\\sum_{i=0}^{K-1} a_0(x_i)(t_{i+1}-t_i) - a_0(x_K)(\\tau_{\\text{stop}}-t_K) \\right)\n$$\n\nSimilarly, for the biased process with propensities $\\{\\tilde{a}_j(x)\\}$, the path probability density is:\n$$\n\\tilde{P}(\\mathbf{x}) = \\left[ \\prod_{i=1}^{K} \\tilde{a}_{j_i}(x_{i-1}) \\right] \\exp\\left( -\\int_0^{\\tau_{\\text{stop}}} \\tilde{a}_0(x(s)) ds \\right)\n$$\nwhere $\\tilde{a}_0(x(s)) = \\sum_j \\tilde{a}_j(x(s))$.\n\nThe reweighting factor $W$ is the Radon–Nikodym derivative $W = \\frac{dP}{d\\tilde{P}}$, which for a given path $\\mathbf{x}$ is the ratio $W(\\mathbf{x}) = \\frac{P(\\mathbf{x})}{\\tilde{P}(\\mathbf{x})}$.\n$$\nW = \\frac{\\left[ \\prod_{i=1}^{K} a_{j_i}(x_{i-1}) \\right] \\exp\\left( -\\int_0^{\\tau_{\\text{stop}}} a_0(x(s)) ds \\right)}{\\left[ \\prod_{i=1}^{K} \\tilde{a}_{j_i}(x_{i-1}) \\right] \\exp\\left( -\\int_0^{\\tau_{\\text{stop}}} \\tilde{a}_0(x(s)) ds \\right)}\n$$\nThis expression can be separated into a product term and an exponential term:\n$$\nW = \\left[ \\prod_{i=1}^{K} \\frac{a_{j_i}(x_{i-1})}{\\tilde{a}_{j_i}(x_{i-1})} \\right] \\exp\\left( \\int_0^{\\tau_{\\text{stop}}} (\\tilde{a}_0(x(s)) - a_0(x(s))) ds \\right)\n$$\n\nThe problem specifies an exponential tilting of the progress coordinate $q(x) = x$. The biased propensities are $\\tilde{a}_{j}(x) = a_{j}(x) \\exp(\\theta \\nu_{j})$, where $\\theta$ is the bias strength and $\\nu_j$ is the stoichiometric change in $x$ for reaction $j$. In our model, we have synthesis (reaction $j=1$, $\\nu_1 = +1$) and degradation (reaction $j=2$, $\\nu_2 = -1$).\nThe ratio in the product term becomes:\n$$\n\\frac{a_{j_i}(x_{i-1})}{\\tilde{a}_{j_i}(x_{i-1})} = \\frac{a_{j_i}(x_{i-1})}{a_{j_i}(x_{i-1}) \\exp(\\theta \\nu_{j_i})} = \\exp(-\\theta \\nu_{j_i})\n$$\nThe full product becomes a sum in the exponent:\n$$\n\\prod_{i=1}^{K} \\exp(-\\theta \\nu_{j_i}) = \\exp\\left(-\\theta \\sum_{i=1}^{K} \\nu_{j_i}\\right)\n$$\nThe sum of stoichiometric changes $\\sum_{i=1}^{K} \\nu_{j_i}$ is simply the net change in the state variable from the start of the trajectory to the state after the last jump, $x_K - x_0$. The state at the stopping time, $x(\\tau_{\\text{stop}})$, is $x_K$. Therefore, this term is $\\exp(-\\theta(x(\\tau_{\\text{stop}}) - x_0))$.\n\nThe final expression for the reweighting factor $W$ is:\n$$\nW = \\exp\\left( -\\theta(x(\\tau_{\\text{stop}}) - x_0) + \\int_0^{\\tau_{\\text{stop}}} (\\tilde{a}_0(x(s)) - a_0(x(s))) ds \\right)\n$$\nwhere $x_0 = x(0)$ is the initial state, $x(\\tau_{\\text{stop}})$ is the state at the stopping time $\\tau_{\\text{stop}}$, and the difference in total rates is $\\tilde{a}_0(x) - a_0(x) = (a_1(x)e^{\\theta} + a_2(x)e^{-\\theta}) - (a_1(x) + a_2(x))$. For numerical stability, we compute the logarithm of the weight, $\\ln W$, by accumulating the integral part during the simulation and adding the state-dependent part at the end.\n\n### Algorithm Design for Monte Carlo Estimation\n\nThe rare-event probability $P(T) = \\mathbb{P}(\\tau \\le T)$ can be expressed as the expectation of an indicator function, $P(T) = \\mathbb{E}[ \\mathbf{1}_{\\{\\tau \\le T\\}} ]$, under the unbiased dynamics. Using importance sampling, we simulate under the biased dynamics $\\tilde{P}$ and reweight, yielding the unbiased estimator:\n$$\n\\hat{P}(T) = \\frac{1}{N} \\sum_{i=1}^{N} W_i \\mathbf{1}_{\\{\\tau_i \\le T\\}}\n$$\nwhere $N$ is the number of simulated trajectories, and for each trajectory $i$, $W_i$ is the calculated weight and $\\tau_i$ is the first hitting time. The rare switching rate is then estimated as $r \\approx \\hat{P}(T)/T$.\n\nThe algorithm proceeds as follows:\n\n1.  **Initialization**: For each of $N$ trajectories, initialize time $t=0$, state $x=x_0$, and the integral part of the log-weight, $\\ln W_{\\text{int}} = 0$.\n\n2.  **Biased Stochastic Simulation**: For each trajectory, run Gillespie's algorithm using the biased propensities $\\{\\tilde{a}_j\\}$ until the stopping condition ($t \\ge T$ or $x \\ge H$) is met.\n    - At the current state $x$ and time $t$:\n        a. Calculate the unbiased propensities $a_1(x)$, $a_2(x)$ and the total $a_0(x)$.\n        b. Calculate the biased propensities $\\tilde{a}_1(x) = a_1(x)e^{\\theta}$, $\\tilde{a}_2(x) = a_2(x)e^{-\\theta}$, and the total $\\tilde{a}_0(x)$. Note that $a_2(0)=0$ implies $\\tilde{a}_2(0)=0$, so $x$ cannot become negative.\n        c. Draw a waiting time $\\Delta t$ from an exponential distribution with rate $\\tilde{a}_0(x)$: $\\Delta t = -\\ln(u_1)/\\tilde{a}_0(x)$, where $u_1 \\sim U(0,1)$.\n        d. Determine the time step for the current state, $\\Delta t_{\\text{step}} = \\min(\\Delta t, T - t)$. Update the integral of the log-weight: $\\ln W_{\\text{int}} \\leftarrow \\ln W_{\\text{int}} + (\\tilde{a}_0(x) - a_0(x))\\Delta t_{\\text{step}}$.\n        e. If $t + \\Delta t \\ge T$, the trajectory ends at the horizon $T$. Set $t=T$ and terminate the simulation loop for this trajectory.\n        f. Otherwise, advance time $t \\leftarrow t + \\Delta t$. Select a reaction $j$ with probability $\\tilde{a}_j(x)/\\tilde{a}_0(x)$ and update the state $x$ accordingly ($x \\leftarrow x + \\nu_j$).\n        g. Repeat until $t \\ge T$ or $x \\ge H$.\n\n3.  **Weight Calculation and Averaging**:\n    - After each trajectory terminates at time $\\tau_{\\text{stop}}$ in state $x_{\\text{final}}$:\n        a. Calculate the final log-weight: $\\ln W = \\ln W_{\\text{int}} - \\theta(x_{\\text{final}} - x_0)$.\n        b. Calculate the weight: $W = \\exp(\\ln W)$.\n        c. Determine the indicator: $\\mathbf{1}_{\\{\\tau \\le T\\}} = 1$ if $x_{\\text{final}} \\ge H$, and $0$ otherwise.\n        d. Accumulate the product $W \\cdot \\mathbf{1}_{\\{\\tau \\le T\\}}$ to a running sum.\n\n4.  **Final Estimation**:\n    - After all $N$ trajectories are completed, calculate the estimated probability $\\hat{P}(T)$ by dividing the total sum by $N$.\n    - Compute the estimated rate $r = \\hat{P}(T)/T$. This procedure is repeated for each test case.",
            "answer": "[0.0,0.000108,0.000111,0.000025]"
        }
    ]
}