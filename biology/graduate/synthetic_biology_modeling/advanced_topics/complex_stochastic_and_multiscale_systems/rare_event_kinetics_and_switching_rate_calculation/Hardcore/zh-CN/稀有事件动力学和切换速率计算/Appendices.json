{
    "hands_on_practices": [
        {
            "introduction": "在稀有事件动力学研究中，当系统可以被简化为一个在一维势能面上运动的粒子时，Kramers理论提供了一个计算转换速率的经典解析框架。这个理论将宏观的转换速率与微观的势能面特征——例如势垒高度和势阱与势垒顶部的曲率——直接联系起来。通过这个练习 ()，您将亲手应用Kramers速率公式，从而加深对能量景观如何决定随机转换动力学核心原理的理解。",
            "id": "3928512",
            "problem": "一个粗粒化的合成基因调控开关可以通过一个无量纲序参量 $x$ 的过阻尼随机动力学来建模，该序参量在有效双阱势 $U(x)$ 中演化，该势编码了两个表型吸引盆和一个过渡势垒。考虑过阻尼朗之万随机微分方程 (SDE)\n$$\n\\dot{x}(t) \\;=\\; -\\frac{1}{\\gamma}\\,U'(x(t)) \\;+\\; \\sqrt{2D}\\,\\xi(t),\n$$\n其中 $\\gamma$ 是逆迁移率（单位为能量乘以时间），$D$ 是扩散系数（单位为时间的倒数），$\\xi(t)$ 是零均值高斯白噪声，满足 $\\langle \\xi(t)\\xi(t')\\rangle=\\delta(t-t')$。相关的概率密度 $p(x,t)$ 的 Smoluchowski (过阻尼 Fokker–Planck) 方程为\n$$\n\\frac{\\partial p(x,t)}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial x} \\left( \\frac{U'(x)}{\\gamma}\\,p(x,t) \\;+\\; D\\,\\frac{\\partial p(x,t)}{\\partial x} \\right).\n$$\n关注有效势\n$$\nU(x) \\;=\\; \\frac{1}{4}\\,\\big(x^{2}-1\\big)^{2},\n$$\n其中 $x$ 是无量纲的，$U(x)$ 的单位是能量。在越垒不频繁的稀有事件极限下，从右阱到左阱的转换速率 $k$ 可以通过使用 Smoluchowski 算符以及在稳定阱最小值 $x_{a}$ 和势垒顶部 $x_{s}$ 附近的匹配鞍点（谐波）近似，对跨越势垒的稳态概率流进行渐近分析来获得。按以下步骤进行：\n\n- 通过求解 $U'(x)=0$ 确定 $x_{a}$ 和 $x_{s}$ 的位置，并根据 $U''(x)$ 判断其稳定性。\n- 计算二阶导数 $U''(x_{a})$ 和 $U''(x_{s})$。\n- 使用从稳态流形式和 Einstein 关系式 $D=\\frac{k_{B}T}{\\gamma}$ 推导出的过阻尼越垒的稀有事件、高势垒渐近，以 $U''(x_{a})$、$U''(x_{s})$、$\\gamma$、$D$ 和势垒高度 $\\Delta U = U(x_{s})-U(x_{a})$ 的形式，求出领头阶 Arrhenius 型速率常数 $k$。\n- 对 $\\gamma = 1.0$（能量乘以秒）和 $D = 5.0 \\times 10^{-2}$（秒的倒数）进行 $k$ 的数值计算。\n\n将最终的数值速率常数 $k$ 以 $\\text{s}^{-1}$ 表示，并将您的答案四舍五入到四位有效数字。最终答案必须是单个实数值。",
            "solution": "该问题要求计算一个由双阱势中的过阻尼朗之万方程建模的合成基因调控开关的转换速率。该过程需要验证问题陈述的有效性，找出势的关键特征，应用适当的速率理论公式，并计算数值结果。\n\n问题陈述是有效的。它在科学上基于随机过程的标准理论（Langevin 和 Fokker-Planck 方程）和过渡态理论（Kramers 速率理论），这些理论是模拟统计物理和化学物理中此类系统的基础。该问题是良定的，提供了所有必要信息——势函数、控制随机微分方程以及参数的数值——以得出一个唯一的、有意义的解。语言客观，设置一致。\n\n首先，我们分析给定的有效势 $U(x)$：\n$$\nU(x) = \\frac{1}{4}\\left(x^{2}-1\\right)^{2} = \\frac{1}{4}\\left(x^{4} - 2x^{2} + 1\\right)\n$$\n为了找到稳定阱和过渡势垒的位置，我们必须通过将其一阶导数 $U'(x)$ 设为零来找到势的驻点。\n$$\nU'(x) = \\frac{d}{dx} \\left[ \\frac{1}{4}\\left(x^{4} - 2x^{2} + 1\\right) \\right] = \\frac{1}{4}\\left(4x^{3} - 4x\\right) = x^{3} - x\n$$\n设 $U'(x) = 0$：\n$$\nx^{3} - x = x(x^{2}-1) = x(x-1)(x+1) = 0\n$$\n驻点是 $x = -1$，$x = 0$ 和 $x = 1$。\n\n接下来，我们通过检查二阶导数 $U''(x)$ 的符号来对这些驻点进行分类：\n$$\nU''(x) = \\frac{d}{dx} \\left( x^{3} - x \\right) = 3x^{2} - 1\n$$\n我们在每个驻点处计算 $U''(x)$ 的值：\n- 在 $x = -1$ 处：$U''(-1) = 3(-1)^{2} - 1 = 2$。由于 $U''(-1) > 0$，这是一个局部最小值，对应于左边的稳定阱。\n- 在 $x = 0$ 处：$U''(0) = 3(0)^{2} - 1 = -1$。由于 $U''(0) < 0$，这是一个局部最大值，对应于势垒的顶部。\n- 在 $x = 1$ 处：$U''(1) = 3(1)^{2} - 1 = 2$。由于 $U''(1) > 0$，这是一个局部最小值，对应于右边的稳定阱。\n\n问题要求计算从右阱到左阱的转换速率 $k$。因此，初始态是右阱的稳定最小值 $x_{a} = 1$，过渡态是势垒顶部 $x_{s} = 0$。\n\n我们计算所需的二阶导数：\n- $U''(x_{a}) = U''(1) = 2$\n- $U''(x_{s}) = U''(0) = -1$\n\n鞍点处二阶导数的绝对值为 $|U''(x_{s})| = |-1| = 1$。\n\n势垒高度 $\\Delta U$ 是势垒顶部和初始阱最小值之间的势能差：\n$$\n\\Delta U = U(x_{s}) - U(x_{a}) = U(0) - U(1)\n$$\n$$\nU(0) = \\frac{1}{4}\\left(0^{2}-1\\right)^{2} = \\frac{1}{4}\n$$\n$$\nU(1) = \\frac{1}{4}\\left(1^{2}-1\\right)^{2} = 0\n$$\n因此，势垒高度为 $\\Delta U = \\frac{1}{4} - 0 = \\frac{1}{4}$。\n\n对于高势垒极限下的过阻尼动力学，跃迁速率由 Kramers 速率公式给出：\n$$\nk = \\frac{\\sqrt{U''(x_{a})|U''(x_{s})|}}{2\\pi\\gamma} \\exp\\left(-\\frac{\\Delta U}{k_{B}T}\\right)\n$$\n问题给出了 Einstein 关系式 $D = \\frac{k_{B}T}{\\gamma}$，我们可以重新排列它以将热能表示为 $k_{B}T = D\\gamma$。将此代入 Kramers 公式，我们可以用给定的参数 $D$ 和 $\\gamma$ 来表示速率：\n$$\nk = \\frac{\\sqrt{U''(x_{a})|U''(x_{s})|}}{2\\pi\\gamma} \\exp\\left(-\\frac{\\Delta U}{D\\gamma}\\right)\n$$\n现在，我们将计算出的势的性质值代入此表达式：\n$U''(x_{a}) = 2$， $|U''(x_{s})| = 1$，以及 $\\Delta U = \\frac{1}{4}$。\n$$\nk = \\frac{\\sqrt{(2)(1)}}{2\\pi\\gamma} \\exp\\left(-\\frac{1/4}{D\\gamma}\\right) = \\frac{\\sqrt{2}}{2\\pi\\gamma} \\exp\\left(-\\frac{1}{4D\\gamma}\\right)\n$$\n最后，我们使用给定的数值计算此表达式：$\\gamma = 1.0$（单位为能量$\\cdot$秒）和 $D = 5.0 \\times 10^{-2}$（单位为 s$^{-1}$）。$k$ 的单位将是 s$^{-1}$。\n$$\nk = \\frac{\\sqrt{2}}{2\\pi(1.0)} \\exp\\left(-\\frac{1}{4(5.0 \\times 10^{-2})(1.0)}\\right)\n$$\n$$\nk = \\frac{\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{1}{4(0.05)}\\right) = \\frac{\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{1}{0.2}\\right)\n$$\n$$\nk = \\frac{\\sqrt{2}}{2\\pi} \\exp(-5)\n$$\n使用数值 $\\sqrt{2} \\approx 1.41421356$，$\\pi \\approx 3.14159265$ 和 $\\exp(-5) \\approx 0.00673795$：\n$$\nk \\approx \\frac{1.41421356}{2 \\times 3.14159265} \\times 0.00673795 \\approx 0.225079 \\times 0.00673795\n$$\n$$\nk \\approx 0.00151658 \\; \\text{s}^{-1}\n$$\n指数函数的自变量是 $\\frac{\\Delta U}{D\\gamma} = 5$，它远大于 $1$，这证明了使用高势垒（稀有事件）近似是合理的。\n\n将结果四舍五入到四位有效数字，我们得到：\n$$\nk \\approx 1.517 \\times 10^{-3} \\; \\text{s}^{-1}\n$$",
            "answer": "$$\n\\boxed{1.517 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "理论模型固然重要，但合成生物学的最终目标是理解和设计真实的生物系统，这就要求我们必须能从实验数据中提取模型的关键参数。本练习将引导您从理论转向实践，学习如何使用最大似然估计 (Maximum Likelihood Estimation, MLE) 从观测到的开关停留时间序列中推断转换速率 ()。您将处理一个在单细胞实验中普遍存在的挑战——数据删失 (censoring)，并推导出在这种情况下精确估计速率的统计方法。",
            "id": "3928468",
            "problem": "通过荧光显微镜在单细胞中监测一个合成基因拨动开关，得到蛋白质水平的离散时间序列。通过对荧光进行阈值化处理来定义一个二元状态：当蛋白质水平超过阈值时，系统处于 $\\mathrm{ON}$ 状态，否则处于 $\\mathrm{OFF}$ 状态。假设在处于 $\\mathrm{ON}$ 状态的条件下，离开 $\\mathrm{ON}$ 状态的事件是一个无记忆的稀有事件，其风险率 $k$（单位为 $\\mathrm{min}^{-1}$）为常数，这与齐次泊松过程一致。您观察了许多细胞的长时间记录，并提取了 $\\mathrm{ON}$ 状态的停留片段。由于观测窗口有限，一些 $\\mathrm{ON}$ 片段是右删失的（它们在记录的边界开始或结束，没有观察到退出事件），而另一些是完整的（它们以观察到的从 $\\mathrm{ON}$ 到 $\\mathrm{OFF}$ 的退出而结束）。\n\n从与齐次泊松过程和风险率定义一致的第一性原理出发，完成以下任务：\n1) 对于 $N$ 个完整且独立的、无删失的 $\\mathrm{ON}$ 停留时长 $\\{t_i\\}_{i=1}^{N}$ 的情况，在指数停留时间模型下构建 $k$ 的似然函数，并推导其最大似然估计量 (Maximum Likelihood Estimator, MLE) $\\hat{k}$。\n2) 将您的似然函数扩展，以包含 $M$ 个时长为 $\\{c_j\\}_{j=1}^{M}$ 的右删失 $\\mathrm{ON}$ 片段（即未观察到退出事件就结束的片段），并推导相应的最大似然估计量 $\\hat{k}$。\n3) 使用以下完整和删失时长（单位：分钟）的数据集，\n完整时长：$14.2$, $31.6$, $5.1$, $61.3$, $22.8$, $47.0$, $9.4$, $38.5$；删失时长：$20.0$, $15.0$,\n计算 $\\hat{k}$ 的数值（单位为 $\\mathrm{min}^{-1}$）。将您的答案四舍五入到四位有效数字。以 $\\mathrm{min}^{-1}$ 为单位表示最终速率。",
            "solution": "问题要求推导一个无记忆过程的速率参数 $k$ 的最大似然估计量 (MLE)，首先是针对完整数据，然后是针对包含右删失观测值的数据集。最后，需要根据给定的数据集计算 $k$ 的数值。\n\n首先验证问题陈述。\n**第 1 步：提取已知信息**\n- **系统**：具有 $\\mathrm{ON}$ 和 $\\mathrm{OFF}$ 两种状态的合成基因拨动开关。\n- **过程**：离开 $\\mathrm{ON}$ 状态是一个无记忆的稀有事件，建模为齐次泊松过程。\n- **参数**：恒定的风险率 $k$，单位为 $\\mathrm{min}^{-1}$。\n- **数据（完整）**：$N$ 个完整、独立的 $\\mathrm{ON}$ 停留时长 $\\{t_i\\}_{i=1}^{N}$。\n- **数据（删失）**：$M$ 个右删失的 $\\mathrm{ON}$ 片段时长 $\\{c_j\\}_{j=1}^{M}$。\n- **任务 1**：仅使用 $N$ 个完整时长构建 $k$ 的似然函数，并推导 MLE $\\hat{k}$。\n- **任务 2**：将似然函数扩展以包含 $M$ 个删失时长，并推导相应的 MLE $\\hat{k}$。\n- **任务 3**：使用提供的数据计算 $\\hat{k}$ 的数值：\n  - 完整时长 ($N=8$)：$\\{14.2, 31.6, 5.1, 61.3, 22.8, 47.0, 9.4, 38.5\\}$ 分钟。\n  - 删失时长 ($M=2$)：$\\{20.0, 15.0\\}$ 分钟。\n- **要求**：$\\hat{k}$ 的最终数值答案必须以 $\\mathrm{min}^{-1}$ 为单位，并四舍五入到四位有效数字。\n\n**第 2 步：使用提取的已知信息进行验证**\n该问题具有科学依据、提法恰当且客观。它描述了生存分析和最大似然估计在事件时间建模中的一个标准应用，这在生物物理学和定量生物学中是一种常见做法。模型假设（齐次泊松过程）陈述清晰，并导致停留时间呈指数分布，这对于无记忆事件来说是一个数学上易于处理且广泛使用的模型。问题提供了所有必要的数据和定义，不包含矛盾，并且要求一个标准的、可推导的统计量。数据值在物理上是合理的。因此，该问题被认定为**有效**。\n\n**第 3 步：结论与行动**\n问题有效。将按要求推导解答。\n\n**第 1 部分：完整数据的最大似然估计**\n一个事件的齐次泊松过程意味着事件发生前的等待时间 $T$ 是一个服从指数分布的随机变量。恒定的风险率 $k$ 是该分布的唯一参数。停留时间 $t$ 的概率密度函数 (PDF) 由下式给出：\n$$f(t; k) = k \\exp(-kt), \\quad t \\ge 0$$\n对于一组 $N$ 个独立同分布 (i.i.d.) 的完整停留时间测量值 $\\{t_i\\}_{i=1}^{N}$，似然函数 $L(k)$ 是各概率密度的乘积：\n$$L(k | \\{t_i\\}_{i=1}^{N}) = \\prod_{i=1}^{N} f(t_i; k) = \\prod_{i=1}^{N} k \\exp(-kt_i)$$\n为了找到最大似然估计量 $\\hat{k}$，在计算上更方便的是最大化对数似然函数 $\\ell(k) = \\ln L(k)$：\n$$\\ell(k) = \\ln\\left(\\prod_{i=1}^{N} k \\exp(-kt_i)\\right) = \\sum_{i=1}^{N} \\ln(k \\exp(-kt_i))$$\n$$\\ell(k) = \\sum_{i=1}^{N} (\\ln k - kt_i) = N\\ln k - k \\sum_{i=1}^{N} t_i$$\n为了找到使 $\\ell(k)$ 最大化的 $k$ 值，我们对 $\\ell(k)$ 求关于 $k$ 的一阶导数，并令其为零：\n$$\\frac{d\\ell}{dk} = \\frac{d}{dk}\\left(N\\ln k - k \\sum_{i=1}^{N} t_i\\right) = \\frac{N}{k} - \\sum_{i=1}^{N} t_i$$\n令导数为零，得到 MLE $\\hat{k}$：\n$$\\frac{N}{\\hat{k}} - \\sum_{i=1}^{N} t_i = 0 \\implies \\hat{k} = \\frac{N}{\\sum_{i=1}^{N} t_i}$$\n这个结果表明，对于完整数据，速率的 MLE 是停留时间样本均值的倒数。\n\n**第 2 部分：包含完整和右删失数据的最大似然估计**\n现在，似然函数必须考虑两种类型的观测值：\n1.  **完整观测值**：对于 $N$ 个完整时长 $t_i$ 中的每一个，事件（离开 $\\mathrm{ON}$ 状态）在时间 $t_i$ 被观测到。其对似然函数的贡献是概率密度函数 (PDF)，即 $f(t_i; k) = k \\exp(-kt_i)$。\n2.  **右删失观测值**：对于 $M$ 个删失时长 $c_j$ 中的每一个，观测窗口在时间 $c_j$ 结束，而没有观测到退出事件。这意味着我们只知道真实的停留时间大于 $c_j$。此事件的概率 $P(T > c_j)$ 由生存函数 $S(t)$ 给出，它是 PDF 从 $t$ 到无穷大的积分。\n    $$S(c_j; k) = \\int_{c_j}^{\\infty} f(t; k) dt = \\int_{c_j}^{\\infty} k \\exp(-kt) dt = [-\\exp(-kt)]_{c_j}^{\\infty} = 0 - (-\\exp(-kc_j)) = \\exp(-kc_j)$$\n    因此，一个删失观测值对似然函数的贡献是 $S(c_j; k) = \\exp(-kc_j)$。\n\n组合数据集的总似然函数是所有 $N$ 个完整观测值和 $M$ 个删失观测值贡献的乘积：\n$$L(k | \\{t_i\\}, \\{c_j\\}) = \\left(\\prod_{i=1}^{N} f(t_i; k)\\right) \\left(\\prod_{j=1}^{M} S(c_j; k)\\right)$$\n$$L(k) = \\left(\\prod_{i=1}^{N} k \\exp(-kt_i)\\right) \\left(\\prod_{j=1}^{M} \\exp(-kc_j)\\right)$$\n$$L(k) = k^N \\exp\\left(-k \\sum_{i=1}^{N} t_i\\right) \\exp\\left(-k \\sum_{j=1}^{M} c_j\\right) = k^N \\exp\\left[-k\\left(\\sum_{i=1}^{N} t_i + \\sum_{j=1}^{M} c_j\\right)\\right]$$\n相应的对数似然函数是：\n$$\\ell(k) = \\ln(L(k)) = N \\ln k - k\\left(\\sum_{i=1}^{N} t_i + \\sum_{j=1}^{M} c_j\\right)$$\n对 $k$ 求导并将结果设为零，得到 MLE $\\hat{k}$：\n$$\\frac{d\\ell}{dk} = \\frac{N}{k} - \\left(\\sum_{i=1}^{N} t_i + \\sum_{j=1}^{M} c_j\\right) = 0$$\n解出 $\\hat{k}$：\n$$\\hat{k} = \\frac{N}{\\sum_{i=1}^{N} t_i + \\sum_{j=1}^{M} c_j}$$\n这个估计量有一个直观的解释：速率是观测到的事件总数（$N$）除以总观测时间，即所有完整时长和删失时长的总和。\n\n**第 3 部分：数值计算**\n我们得到以下数据集：\n- 完整时长：$\\{14.2, 31.6, 5.1, 61.3, 22.8, 47.0, 9.4, 38.5\\}$。完整观测值（事件）的数量为 $N=8$。\n- 删失时长：$\\{20.0, 15.0\\}$。删失观测值的数量为 $M=2$。\n\n首先，我们计算所有时长的总和：\n完整时长的总和：\n$$\\sum_{i=1}^{8} t_i = 14.2 + 31.6 + 5.1 + 61.3 + 22.8 + 47.0 + 9.4 + 38.5 = 229.9 \\; \\mathrm{min}$$\n删失时长的总和：\n$$\\sum_{j=1}^{2} c_j = 20.0 + 15.0 = 35.0 \\; \\mathrm{min}$$\n总观测时间是这两个量之和：\n$$\\text{总时间} = \\sum_{i=1}^{8} t_i + \\sum_{j=1}^{2} c_j = 229.9 + 35.0 = 264.9 \\; \\mathrm{min}$$\n现在，我们使用 MLE $\\hat{k}$ 的公式：\n$$\\hat{k} = \\frac{N}{\\text{总时间}} = \\frac{8}{264.9} \\; \\mathrm{min}^{-1}$$\n$$\\hat{k} \\approx 0.03020007549... \\; \\mathrm{min}^{-1}$$\n问题要求将答案四舍五入到四位有效数字。\n$$\\hat{k} \\approx 0.03020 \\; \\mathrm{min}^{-1}$$",
            "answer": "$$\\boxed{0.03020}$$"
        },
        {
            "introduction": "当系统过于复杂，无法用简单的解析势能描述，同时实验观测的转换事件又极其稀少时，我们如何计算其速率？前向通量采样 (Forward Flux Sampling, FFS) 等先进的计算方法为此提供了解决方案。该方法通过设置一系列界面，将一个几乎不可能直接模拟的稀有事件分解为一连串更易于发生的子过程 ()。本练习将帮助您掌握FFS的核心思想，并理解如何通过计算初始通量和一系列条件概率来重构出最终的转换速率。",
            "id": "3928447",
            "problem": "您将使用一种基于轨迹的估计器来模拟一个合成基因调控网络中的稀有事件转换。考虑一个具有两个吸引盆的双稳态遗传开关：一个低表达盆 $A$ 和一个高表达盆 $B$。用于区分状态的可观测量是一个从系统状态 $x$ 构建的标量序参量 $\\lambda(x)$（例如，加权的蛋白质拷贝数）。在稳态下，从 $A$ 到 $B$ 的转换过程是一个稀有事件。您将使用一种轨迹采样方法来计算 $A \\to B$ 转换的稳态速率常数。\n\n从以下基本原理出发：\n- 化学主方程（CME）描述了在随机动力学下，离散分子数上的概率分布随时间的演化。在稳态下，穿过任何非反应性边界的概率流是恒定的。\n- 对于一个稳态稀有事件，平均首次穿越转换速率 $k_{A \\to B}$ 可以分解为一个穿过将 $A$ 与离开 $A$ 的轨迹分隔开的边界的概率流（通量），乘以这样一条轨迹到达 $B$ 而不返回 $A$ 的概率。\n- 可以通过在序参量空间 $\\lambda$ 中放置嵌套界面来构建一个轨迹系综：$\\lambda_0  \\lambda_1  \\cdots  \\lambda_n$，其中 $\\lambda_0$ 位于 $A$ 的边界之外，而 $\\lambda_n$ 位于 $B$ 之内。人们估计在不返回的条件下连续到达后续界面的概率。\n\n任务：\n1. 基于这些原理和定义，推导一个关于稳态速率常数 $k_{A \\to B}$ 的表达式，该表达式用离开 $A$ 的可测量前向轨迹通量和与精心选择的界面 $\\{\\lambda_i\\}$ 相关的一系列条件概率来表示。\n2. 解释选择界面位置 $\\{\\lambda_i\\}$ 的基本原理，包括界面放置如何影响估计器的统计方差和计算效率。您的解释应基于随机过程和轨迹系综的性质。\n3. 实现一个程序，该程序在给定从 $A$ 到第一个界面的稳态前向通量以及到达后续界面而不返回 $A$ 的条件概率列表的情况下，为每个测试用例计算稳态速率常数，结果为一个标量。将速率以 $\\mathrm{h}^{-1}$（每小时）为单位表示，并报告为浮点数。\n4. 您的程序必须处理以下参数值测试套件，并为每个用例生成一个结果：\n   - 用例 1（正常路径）：前向通量 $\\Phi = 0.015 \\,\\mathrm{h}^{-1}$，条件概率为 $[0.25, 0.40, 0.50]$。\n   - 用例 2（零概率边界条件）：前向通量 $\\Phi = 0.020 \\,\\mathrm{h}^{-1}$，条件概率为 $[0.30, 0.00, 0.80]$。\n   - 用例 3（高条件成功率界面）：前向通量 $\\Phi = 0.0001 \\,\\mathrm{h}^{-1}$，条件概率为 $[0.90, 0.95, 0.97, 0.92]$。\n   - 用例 4（极小通量，中等概率）：前向通量 $\\Phi = 0.000001 \\,\\mathrm{h}^{-1}$，条件概率为 $[0.20, 0.30, 0.25, 0.40, 0.50]$。\n   - 用例 5（多个具有相似条件概率的界面）：前向通量 $\\Phi = 0.010 \\,\\mathrm{h}^{-1}$，条件概率为 $[0.10, 0.10, 0.10, 0.10, 0.10]$。\n5. 最终输出格式要求：您的程序应生成单行输出，其中包含五个速率，格式为逗号分隔的列表，并用方括号括起来（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是相应情况下计算出的速率，单位为 $\\mathrm{h}^{-1}$。不应打印单位或其他额外文本，只打印该列表。\n\n程序必须是自包含和确定性的，不需要用户输入，并且必须在标准环境中执行。所有计算都应严格遵守浮点数运算法则。对于此问题，数字应被视为实数标量，任何乘法都应遵循标准的实数运算法则。确保您的推导中所有变量和数字都按要求以 LaTeX 格式呈现。",
            "solution": "所述问题在科学上是合理的、适定的，并包含完整解答所需的所有信息。它基于随机化学动力学和稀有事件采样理论的既定原则。所提供的参数在物理上是合理的，在数学上是一致的。因此，该问题被认为是有效的，并将提供解答。\n\n任务是推导基因调控网络中两个稳定状态之间转换的稳态速率常数的表达式，解释基于轨迹的估计方法的基本原理，并实现一个程序来计算几个测试用例的速率。\n\n**1. 速率常数表达式的推导**\n\n问题涉及计算从吸引盆 $A$ 到吸引盆 $B$ 的稀有跃迁的速率常数 $k_{A \\to B}$。在稳态下，系统表现出的涨落偶尔会将其从一个吸引盆驱动到另一个。这种转换的速率可以概念化为两个因素的乘积：从状态 $A$ 向状态 $B$ 启动轨迹的速率，以及已启动的轨迹成功完成到 $B$ 的转换而不返回 $A$ 的概率。\n\n所描述的轨迹采样方法，称为前向通量采样（FFS）或类似的基于界面的技术，将这一概念形式化。状态空间由标量序参量 $\\lambda(x)$ 定义的一系列不相交的界面划分。设这些界面为 $\\{\\lambda_0, \\lambda_1, \\ldots, \\lambda_n\\}$，其排序为 $\\lambda_0  \\lambda_1  \\cdots  \\lambda_n$。界面 $\\lambda_0$ 放置在状态 $A$ 边界的外侧，而最终界面 $\\lambda_n$ 放置在状态 $B$ 内。一旦轨迹穿过 $\\lambda_n$，就认为它已转换到 $B$。\n\n速率常数 $k_{A \\to B}$ 可以表示为：\n$$\nk_{A \\to B} = \\Phi_{A \\to \\lambda_0} \\times P(\\lambda_n | \\lambda_0)\n$$\n其中：\n- $\\Phi_{A \\to \\lambda_0}$ 是稳态前向通量，表示源于吸引盆 $A$ 的轨迹首次穿过第一个界面 $\\lambda_0$ 的速率。问题直接提供了这个量，我们将其表示为 $\\Phi$。它的单位是单位时间内的事件数，例如 $\\mathrm{h}^{-1}$。\n- $P(\\lambda_n | \\lambda_0)$ 是指一条刚从 $A$ 穿过 $\\lambda_0$ 的轨迹，在返回吸引盆 $A$ 之前继续前进并穿过 $\\lambda_n$ 的条件概率。\n\n如果 $P(\\lambda_n | \\lambda_0)$ 是一个非常小的数，直接计算它可能计算成本很高。FFS 方法通过使用概率的链式法则将其分解为一系列更易于处理的条件概率的乘积来规避这个问题：\n$$\nP(\\lambda_n | \\lambda_0) = P(\\lambda_1 | \\lambda_0) \\times P(\\lambda_2 | \\lambda_1) \\times \\cdots \\times P(\\lambda_n | \\lambda_{n-1})\n$$\n该分解依赖于这样一个假设，即穿越连续界面的过程近似为马尔可夫过程。每一项 $P(\\lambda_i | \\lambda_{i-1})$ 表示一条从 $A$ 方向到达界面 $\\lambda_{i-1}$ 的轨迹在返回 $A$ 之前下一次到达界面 $\\lambda_i$ 的概率。\n\n设给定的条件概率列表为 $[p_1, p_2, \\ldots, p_m]$，其中 $p_i = P(\\lambda_i | \\lambda_{i-1})$，$m$ 是 $\\lambda_0$ 之后的界面数量。从 $\\lambda_0$ 成功转换到最终界面 $\\lambda_m$ 的总概率是这些单个概率的乘积：\n$$\nP(\\lambda_m | \\lambda_0) = \\prod_{i=1}^{m} p_i\n$$\n将此代入原始速率表达式，我们得到稳态速率常数的最终公式：\n$$\nk_{A \\to B} = \\Phi \\prod_{i=1}^{m} p_i\n$$\n这就是要实现的表达式。它表明，总转换速率是离开起始盆的初始轨迹通量，经由通过中间过渡区域的连续推进概率而衰减。\n\n**2. 界面放置的基本原理**\n\n界面 $\\{\\lambda_i\\}$ 的放置对速率计算的效率和准确性至关重要。主要目标是将单个稀有事件（从 $A$ 到 $B$ 的转换）分解为一系列更频繁的事件（从 $\\lambda_{i-1}$ 穿越到 $\\lambda_i$）。\n\n- **统计方差和计算成本：** 稀有事件模拟的核心挑战是统计不确定性。直接模拟需要长得不可行的时间（量级为 $1/k_{A \\to B}$）才能观察到转换。FFS 方法通过将计算精力集中在有希望的轨迹部分来提高效率。估计的速率常数的总方差与每个估计的条件概率 $p_i$ 的相对方差之和有关。为了在固定的计算预算下最小化总误差，期望概率 $p_i$ 不要过小。如果某个 $p_i$ 非常小，则必须从界面 $\\lambda_{i-1}$ 启动大量的试验运行才能获得对 $p_i$ 的统计上可靠的估计，这违背了该方法的初衷。\n\n- **界面间距：**\n    - 如果界面放置得**过于遥远**，条件概率 $p_i = P(\\lambda_i | \\lambda_{i-1})$ 将会非常低。这会在单个界面步骤的层面上重新引入稀有性问题，导致 $p_i$ 估计值以及最终速率 $k_{A \\to B}$ 的统计方差很高。\n    - 如果界面放置得**过于密集**，条件概率 $p_i$ 将接近于 $1$。虽然这易于以低方差进行估计，但在计算上是低效的。需要许多界面才能跨越整个过渡区域，而每一步只取得了边际进展。管理众多界面并在每个界面上重新启动模拟所带来的开销将主导计算成本。\n\n- **最佳放置策略：** 最佳策略是一种平衡。界面的放置应使条件概率 $p_i$ 足够大，以便能够高效地进行采样（例如，通常在 $0.1$ 到 $0.5$ 的范围内），但又足够小，以便能用合理数量的界面在过渡区域取得有意义的进展。有效的放置可确保计算工作量大致均匀地分布在转换的各个阶段。这在很大程度上取决于序参量 $\\lambda(x)$ 作为反应坐标的质量；对于一个好的反应坐标，$\\lambda$ 的进展与朝向目标状态 $B$ 的进展密切相关。\n\n**3. 测试用例的实现**\n\n程序将实现推导出的公式 $k_{A \\to B} = \\Phi \\prod p_i$。对于每个测试用例，它将获取给定的前向通量 $\\Phi$ 和条件概率列表 $[p_1, p_2, \\ldots, p_m]$，计算它们的乘积，然后乘以 $\\Phi$ 以求得速率常数。\n\n- 用例 1: $k = 0.015 \\times (0.25 \\times 0.40 \\times 0.50) = 0.015 \\times 0.05 = 0.00075 \\, \\mathrm{h}^{-1}$。\n- 用例 2: $k = 0.020 \\times (0.30 \\times 0.00 \\times 0.80) = 0.020 \\times 0 = 0.0 \\, \\mathrm{h}^{-1}$。任何界面上的零概率都会阻断整个路径。\n- 用例 3: $k = 0.0001 \\times (0.90 \\times 0.95 \\times 0.97 \\times 0.92) = 0.0001 \\times 0.763002 = 0.0000763002 \\, \\mathrm{h}^{-1}$。高概率意味着通量没有被强烈衰减。\n- 用例 4: $k = 0.000001 \\times (0.20 \\times 0.30 \\times 0.25 \\times 0.40 \\times 0.50) = 1.0 \\times 10^{-6} \\times 0.003 = 3.0 \\times 10^{-9} \\, \\mathrm{h}^{-1}$。这是一个极其稀有的事件。\n- 用例 5: $k = 0.010 \\times (0.10 \\times 0.10 \\times 0.10 \\times 0.10 \\times 0.10) = 0.010 \\times 10^{-5} = 1.0 \\times 10^{-7} \\, \\mathrm{h}^{-1}$。许多低概率阶段导致了整体上的巨大衰减。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the stationary rate constant for A -> B transitions for a suite of test cases.\n    The rate constant k is calculated using the formula derived from Forward Flux Sampling principles:\n    k = Phi * product(P_i), where Phi is the forward flux from basin A to the first interface,\n    and P_i are the conditional probabilities of reaching successive interfaces.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (forward_flux_in_h^-1, list_of_conditional_probabilities).\n    test_cases = [\n        # Case 1 (happy path)\n        (0.015, [0.25, 0.40, 0.50]),\n        # Case 2 (boundary condition with zero probability)\n        (0.020, [0.30, 0.00, 0.80]),\n        # Case 3 (interfaces with high conditional success)\n        (0.0001, [0.90, 0.95, 0.97, 0.92]),\n        # Case 4 (very small flux, moderate probabilities)\n        (0.000001, [0.20, 0.30, 0.25, 0.40, 0.50]),\n        # Case 5 (many interfaces with similar conditional probability)\n        (0.010, [0.10, 0.10, 0.10, 0.10, 0.10]),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract the forward flux (Phi) and the list of probabilities from the case data.\n        forward_flux, conditional_probs = case\n\n        # The total probability of a trajectory successfully crossing all interfaces\n        # is the product of the individual conditional probabilities.\n        # np.prod calculates the product of all elements in the array.\n        # If the list of probabilities is empty, the product is 1.0, which is correct\n        # as it implies the first interface is the target, and P(lambda_0|lambda_0) = 1.\n        total_probability = np.prod(conditional_probs)\n\n        # The stationary rate constant k is the product of the initial flux\n        # and the total probability of completing the transition.\n        rate_constant = forward_flux * total_probability\n        \n        results.append(rate_constant)\n\n    # Final print statement in the exact required format.\n    # The format is a comma-separated list of floating-point numbers enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}