{
    "hands_on_practices": [
        {
            "introduction": "Kramers速率理论为在已知势能面的系统中估算切换速率提供了基础的解析工具。本练习旨在通过计算一个经典的双稳态系统中的跃迁速率，来巩固对势垒高度、阱底和垒顶曲率等势能面特征如何决定动力学速率的理解。这对于掌握化学物理和系统生物学中的核心概念至关重要 。",
            "id": "3928512",
            "problem": "一个粗粒度的合成基因调控开关可以通过一个无量纲序参量 $x$ 的过阻尼随机动力学来建模，该序参量在一个有效的双阱势 $U(x)$ 中演化，该势编码了两个表型吸引盆和一个过渡势垒。考虑过阻尼朗之万随机微分方程 (SDE)\n$$\n\\dot{x}(t) \\;=\\; -\\frac{1}{\\gamma}\\,U'(x(t)) \\;+\\; \\sqrt{2D}\\,\\xi(t),\n$$\n其中 $\\gamma$ 是逆迁移率（单位为能量乘以时间），$D$ 是扩散系数（单位为时间的倒数），而 $\\xi(t)$ 是零均值高斯白噪声，满足 $\\langle \\xi(t)\\xi(t')\\rangle=\\delta(t-t')$. 与之相关的概率密度 $p(x,t)$ 的斯摩鲁霍夫斯基（过阻尼福克-普朗克）方程为\n$$\n\\frac{\\partial p(x,t)}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial x} \\left( \\frac{U'(x)}{\\gamma}\\,p(x,t) \\;+\\; D\\,\\frac{\\partial p(x,t)}{\\partial x} \\right).\n$$\n考虑有效势\n$$\nU(x) \\;=\\; \\frac{1}{4}\\,\\big(x^{2}-1\\big)^{2},\n$$\n其中 $x$ 是无量纲的，$U(x)$ 的单位是能量。在越垒不频繁的稀有事件极限下，从右阱到左阱的切换速率 $k$ 可以通过使用斯摩鲁霍夫斯基算符和在稳定阱最小值 $x_{a}$ 及势垒顶部 $x_{s}$ 附近的匹配鞍点（谐波）近似，对跨越势垒的稳态概率流进行渐近分析来获得。请按以下步骤进行：\n\n- 通过求解 $U'(x)=0$ 确定 $x_{a}$ 和 $x_{s}$ 的位置，并根据 $U''(x)$ 判断其稳定性。\n- 计算二阶导数 $U''(x_{a})$ 和 $U''(x_{s})$。\n- 使用从稳态流形式体系和爱因斯坦关系式 $D=\\frac{k_{B}T}{\\gamma}$ 推导出的过阻尼越垒的稀有事件、高势垒渐近理论，获得用 $U''(x_{a})$、$U''(x_{s})$、$\\gamma$、$D$ 以及势垒高度 $\\Delta U = U(x_{s})-U(x_{a})$ 表示的主导阶阿伦尼乌斯型速率常数 $k$。\n- 对于 $\\gamma = 1.0$（能量·秒）和 $D = 5.0 \\times 10^{-2}$（秒的倒数），对 $k$ 进行数值计算。\n\n将最终的数值速率常数 $k$ 以 $\\text{s}^{-1}$ 为单位表示，并将答案四舍五入到四位有效数字。最终答案必须是一个实数值。",
            "solution": "该问题要求计算一个由过阻尼朗之万方程在双阱势中建模的合成基因调控开关的切换速率。该过程需要验证问题陈述的有效性，找到势的关键特征，应用适当的速率理论公式，并计算数值结果。\n\n问题陈述是有效的。它在科学上基于随机过程的标准理论（朗之万方程和福克-普朗克方程）和过渡态理论（克拉默斯速率理论），这些理论是在统计物理和化学物理中对此类系统进行建模的基础。这个问题是适定的，提供了所有必要信息——势函数、控制性随机微分方程以及参数的数值——从而能够得出一个唯一的、有意义的解。语言是客观的，设定是一致的。\n\n首先，我们分析所提供的有效势 $U(x)$:\n$$\nU(x) = \\frac{1}{4}\\left(x^{2}-1\\right)^{2} = \\frac{1}{4}\\left(x^{4} - 2x^{2} + 1\\right)\n$$\n为了找到稳定阱和过渡势垒的位置，我们必须通过将其一阶导数 $U'(x)$ 设为零来找到势的驻点。\n$$\nU'(x) = \\frac{d}{dx} \\left[ \\frac{1}{4}\\left(x^{4} - 2x^{2} + 1\\right) \\right] = \\frac{1}{4}\\left(4x^{3} - 4x\\right) = x^{3} - x\n$$\n令 $U'(x) = 0$:\n$$\nx^{3} - x = x(x^{2}-1) = x(x-1)(x+1) = 0\n$$\n驻点是 $x = -1$，$x = 0$ 和 $x = 1$。\n\n接下来，我们通过检查二阶导数 $U''(x)$ 的符号来对这些驻点进行分类：\n$$\nU''(x) = \\frac{d}{dx} \\left( x^{3} - x \\right) = 3x^{2} - 1\n$$\n我们在每个驻点处计算 $U''(x)$ 的值：\n- 在 $x = -1$ 处：$U''(-1) = 3(-1)^{2} - 1 = 2$。由于 $U''(-1) > 0$，这是一个局部最小值，对应于左稳定阱。\n- 在 $x = 0$ 处：$U''(0) = 3(0)^{2} - 1 = -1$。由于 $U''(0)  0$，这是一个局部最大值，对应于势垒的顶部。\n- 在 $x = 1$ 处：$U''(1) = 3(1)^{2} - 1 = 2$。由于 $U''(1)  0$，这是一个局部最小值，对应于右稳定阱。\n\n问题要求计算从右阱到左阱的切换速率 $k$。因此，初始态是右阱的稳定最小值 $x_{a} = 1$，过渡态是势垒顶部 $x_{s} = 0$。\n\n我们计算所需的二阶导数：\n- $U''(x_{a}) = U''(1) = 2$\n- $U''(x_{s}) = U''(0) = -1$\n\n在鞍点处二阶导数的绝对值为 $|U''(x_{s})| = |-1| = 1$。\n\n势垒高度 $\\Delta U$ 是势垒顶部和初始阱最小值之间的势能差：\n$$\n\\Delta U = U(x_{s}) - U(x_{a}) = U(0) - U(1)\n$$\n$$\nU(0) = \\frac{1}{4}\\left(0^{2}-1\\right)^{2} = \\frac{1}{4}\n$$\n$$\nU(1) = \\frac{1}{4}\\left(1^{2}-1\\right)^{2} = 0\n$$\n因此，势垒高度为 $\\Delta U = \\frac{1}{4} - 0 = \\frac{1}{4}$。\n\n对于高势垒极限下的过阻尼动力学，过渡速率由克拉默斯速率公式给出：\n$$\nk = \\frac{\\sqrt{U''(x_{a})|U''(x_{s})|}}{2\\pi\\gamma} \\exp\\left(-\\frac{\\Delta U}{k_{B}T}\\right)\n$$\n问题提供了爱因斯坦关系式 $D = \\frac{k_{B}T}{\\gamma}$，我们可以将其重排以将热能表示为 $k_{B}T = D\\gamma$。将此代入克拉默斯公式，我们就可以用给定的参数 $D$ 和 $\\gamma$ 来表示速率：\n$$\nk = \\frac{\\sqrt{U''(x_{a})|U''(x_{s})|}}{2\\pi\\gamma} \\exp\\left(-\\frac{\\Delta U}{D\\gamma}\\right)\n$$\n现在，我们将计算出的势的性质的值代入此表达式：$U''(x_{a}) = 2$， $|U''(x_{s})| = 1$ 以及 $\\Delta U = \\frac{1}{4}$。\n$$\nk = \\frac{\\sqrt{(2)(1)}}{2\\pi\\gamma} \\exp\\left(-\\frac{1/4}{D\\gamma}\\right) = \\frac{\\sqrt{2}}{2\\pi\\gamma} \\exp\\left(-\\frac{1}{4D\\gamma}\\right)\n$$\n最后，我们使用给定的数值计算此表达式：$\\gamma = 1.0$（单位为能量·秒）和 $D = 5.0 \\times 10^{-2}$（单位为 s$^{-1}$）。$k$ 的单位将是 s$^{-1}$。\n$$\nk = \\frac{\\sqrt{2}}{2\\pi(1.0)} \\exp\\left(-\\frac{1}{4(5.0 \\times 10^{-2})(1.0)}\\right)\n$$\n$$\nk = \\frac{\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{1}{4(0.05)}\\right) = \\frac{\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{1}{0.2}\\right)\n$$\n$$\nk = \\frac{\\sqrt{2}}{2\\pi} \\exp(-5)\n$$\n使用数值 $\\sqrt{2} \\approx 1.41421356$, $\\pi \\approx 3.14159265$, 和 $\\exp(-5) \\approx 0.00673795$:\n$$\nk \\approx \\frac{1.41421356}{2 \\times 3.14159265} \\times 0.00673795 \\approx 0.225079 \\times 0.00673795\n$$\n$$\nk \\approx 0.00151658 \\; \\text{s}^{-1}\n$$\n指数部分的自变量为 $\\frac{\\Delta U}{D\\gamma} = 5$，该值远大于1，这证明了使用高势垒（稀有事件）近似的合理性。\n\n将结果四舍五入到四位有效数字，我们得到：\n$$\nk \\approx 1.517 \\times 10^{-3} \\; \\text{s}^{-1}\n$$",
            "answer": "$$\n\\boxed{1.517 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "在理论模型之外，我们常常需要从实验观测数据中推断动力学参数。本练习将带领我们从处理离散的时间序列数据入手，学习如何应用最大似然估计（Maximum Likelihood Estimation, MLE）来计算事件发生的速率。通过这个实践，你将掌握处理在实验中普遍存在的右删失数据（right-censored data）的关键技能，从而更准确地从真实世界的数据中提取信息 。",
            "id": "3928468",
            "problem": "一个合成基因开关通过荧光显微镜在单细胞中进行监测，得到蛋白质水平的离散时间序列。通过对荧光强度设定阈值来定义一个二元状态：当蛋白质水平超过阈值时，系统处于$\\mathrm{ON}$状态；否则，系统处于$\\mathrm{OFF}$状态。假设在处于$\\mathrm{ON}$状态的条件下，离开$\\mathrm{ON}$状态是一个无记忆的稀有事件，其风险率 $k$（单位为$\\mathrm{min}^{-1}$）为恒定值，这与齐次泊松过程一致。您观察了许多细胞的长时间记录，并提取了$\\mathrm{ON}$状态的停留片段。由于观察窗口有限，一些$\\mathrm{ON}$片段是右删失的（它们在记录的边界开始或结束，没有观察到退出），而另一些是完整的（它们以观察到的从$\\mathrm{ON}$到$\\mathrm{OFF}$的退出而结束）。\n\n从与齐次泊松过程和风险率定义一致的第一性原理出发，完成以下任务：\n1) 对于$N$个完整且独立的$\\mathrm{ON}$状态停留时长$\\{t_i\\}_{i=1}^{N}$且无删失的情况，构建指数停留时间模型下 $k$ 的似然函数，并推导最大似然估计量（Maximum Likelihood Estimator (MLE)）$\\hat{k}$。\n2) 扩展您的似然函数，使其包含$M$个时长为$\\{c_j\\}_{j=1}^{M}$的右删失$\\mathrm{ON}$片段（即在观察结束时未观察到退出的片段），并推导出相应的MLE $\\hat{k}$。\n3) 使用以下完整和删失时长（单位为分钟）的数据集：\n完整时长：$14.2$, $31.6$, $5.1$, $61.3$, $22.8$, $47.0$, $9.4$, $38.5$；删失时长：$20.0$, $15.0$。\n计算$\\hat{k}$的数值（单位为$\\mathrm{min}^{-1}$）。将您的答案四舍五入到四位有效数字。最终速率以$\\mathrm{min}^{-1}$表示。",
            "solution": "该问题要求推导一个无记忆过程的速率参数 $k$ 的最大似然估计量（MLE），首先针对完整数据，然后针对包含右删失观测值的数据集。最后，需要根据给定的数据集计算 $k$ 的数值。\n\n首先验证问题陈述。\n**步骤1：提取已知条件**\n- **系统**：一个具有$\\mathrm{ON}$和$\\mathrm{OFF}$两种状态的合成基因开关。\n- **过程**：离开$\\mathrm{ON}$状态是一个无记忆的稀有事件，建模为齐次泊松过程。\n- **参数**：恒定的风险率是 $k$，单位为$\\mathrm{min}^{-1}$。\n- **数据（完整）**：$N$个完整且独立的$\\mathrm{ON}$状态停留时长$\\{t_i\\}_{i=1}^{N}$。\n- **数据（删失）**：$M$个右删失的$\\mathrm{ON}$片段时长$\\{c_j\\}_{j=1}^{M}$。\n- **任务1**：仅使用$N$个完整时长构建 $k$ 的似然函数，并推导MLE $\\hat{k}$。\n- **任务2**：扩展似然函数，使其包含$M$个删失时长，并推导相应的MLE $\\hat{k}$。\n- **任务3**：使用提供的数据计算$\\hat{k}$的数值：\n  - 完整时长（$N=8$）：$\\{14.2, 31.6, 5.1, 61.3, 22.8, 47.0, 9.4, 38.5\\}$ 分钟。\n  - 删失时长（$M=2$）：$\\{20.0, 15.0\\}$ 分钟。\n- **要求**：$\\hat{k}$的最终数值答案必须以$\\mathrm{min}^{-1}$为单位，并四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法恰当且客观。它描述了生存分析和最大似然估计在建模事件时间方面的标准应用，这是生物物理学和定量生物学中的常见做法。模型假设（齐次泊松过程）陈述清晰，并导出了停留时间的指数分布，这是一个数学上易于处理且广泛用于无记忆事件的模型。问题提供了所有必要的数据和定义，不包含任何矛盾，并要求一个标准的、可推导的统计量。数据值在物理上是合理的。因此，该问题被视为**有效的**。\n\n**步骤3：结论与行动**\n该问题是有效的。将按要求推导解答。\n\n**第1部分：完整数据的MLE**\n事件的齐次泊松过程意味着，直到事件发生为止的等待时间 $T$ 是一个服从指数分布的随机变量。恒定的风险率 $k$ 是该分布的唯一参数。停留时间 $t$ 的概率密度函数（PDF）由下式给出：\n$$f(t; k) = k \\exp(-kt), \\quad t \\ge 0$$\n对于一组$N$个独立同分布（i.i.d.）的完整停留时间测量值$\\{t_i\\}_{i=1}^{N}$，似然函数$L(k)$是各个概率密度的乘积：\n$$L(k | \\{t_i\\}_{i=1}^{N}) = \\prod_{i=1}^{N} f(t_i; k) = \\prod_{i=1}^{N} k \\exp(-kt_i)$$\n为了找到最大似然估计量$\\hat{k}$，计算上更方便的是最大化对数似然函数 $\\ell(k) = \\ln L(k)$：\n$$\\ell(k) = \\ln\\left(\\prod_{i=1}^{N} k \\exp(-kt_i)\\right) = \\sum_{i=1}^{N} \\ln(k \\exp(-kt_i))$$\n$$\\ell(k) = \\sum_{i=1}^{N} (\\ln k - kt_i) = N\\ln k - k \\sum_{i=1}^{N} t_i$$\n为了找到使$\\ell(k)$最大化的 $k$ 值，我们对$\\ell(k)$关于 $k$ 求一阶导数，并令其为零：\n$$\\frac{d\\ell}{dk} = \\frac{d}{dk}\\left(N\\ln k - k \\sum_{i=1}^{N} t_i\\right) = \\frac{N}{k} - \\sum_{i=1}^{N} t_i$$\n将导数设为零，得到MLE $\\hat{k}$：\n$$\\frac{N}{\\hat{k}} - \\sum_{i=1}^{N} t_i = 0 \\implies \\hat{k} = \\frac{N}{\\sum_{i=1}^{N} t_i}$$\n这个结果表明，对于完整数据，速率的MLE是停留时间样本均值的倒数。\n\n**第2部分：包含完整和右删失数据的MLE**\n似然函数现在必须考虑两种类型的观测值：\n1.  **完整观测值**：对于$N$个完整时长$t_i$中的每一个，事件（离开$\\mathrm{ON}$状态）在时间$t_i$被观测到。它对似然函数的贡献是PDF，$f(t_i; k) = k \\exp(-kt_i)$。\n2.  **右删失观测值**：对于$M$个删失时长$c_j$中的每一个，观察窗口在时间$c_j$结束，而没有观测到退出。这意味着真实的停留时间只知道大于$c_j$。此事件的概率 $P(T  c_j)$ 由生存函数 $S(t)$ 给出，该函数是PDF从 $t$ 到无穷大的积分。\n    $$S(c_j; k) = \\int_{c_j}^{\\infty} f(t; k) dt = \\int_{c_j}^{\\infty} k \\exp(-kt) dt = [-\\exp(-kt)]_{c_j}^{\\infty} = 0 - (-\\exp(-kc_j)) = \\exp(-kc_j)$$\n    因此，一个删失观测值对似然函数的贡献是$S(c_j; k) = \\exp(-kc_j)$。\n\n组合数据集的总似然函数是所有$N$个完整观测值和$M$个删失观测值贡献的乘积：\n$$L(k | \\{t_i\\}, \\{c_j\\}) = \\left(\\prod_{i=1}^{N} f(t_i; k)\\right) \\left(\\prod_{j=1}^{M} S(c_j; k)\\right)$$\n$$L(k) = \\left(\\prod_{i=1}^{N} k \\exp(-kt_i)\\right) \\left(\\prod_{j=1}^{M} \\exp(-kc_j)\\right)$$\n$$L(k) = k^N \\exp\\left(-k \\sum_{i=1}^{N} t_i\\right) \\exp\\left(-k \\sum_{j=1}^{M} c_j\\right) = k^N \\exp\\left[-k\\left(\\sum_{i=1}^{N} t_i + \\sum_{j=1}^{M} c_j\\right)\\right]$$\n相应的对数似然函数是：\n$$\\ell(k) = \\ln(L(k)) = N \\ln k - k\\left(\\sum_{i=1}^{N} t_i + \\sum_{j=1}^{M} c_j\\right)$$\n对 $k$ 求导并将结果设为零，得到MLE $\\hat{k}$：\n$$\\frac{d\\ell}{dk} = \\frac{N}{k} - \\left(\\sum_{i=1}^{N} t_i + \\sum_{j=1}^{M} c_j\\right) = 0$$\n解出$\\hat{k}$：\n$$\\hat{k} = \\frac{N}{\\sum_{i=1}^{N} t_i + \\sum_{j=1}^{M} c_j}$$\n这个估计量有一个直观的解释：速率是观测到的事件总数（$N$）除以总观察时间，即所有完整时长和删失时长的总和。\n\n**第3部分：数值计算**\n我们得到以下数据集：\n- 完整时长：$\\{14.2, 31.6, 5.1, 61.3, 22.8, 47.0, 9.4, 38.5\\}$。完整观测值（事件）的数量为$N=8$。\n- 删失时长：$\\{20.0, 15.0\\}$。删失观测值的数量为$M=2$。\n\n首先，我们计算所有时长的总和：\n完整时长的总和：\n$$\\sum_{i=1}^{8} t_i = 14.2 + 31.6 + 5.1 + 61.3 + 22.8 + 47.0 + 9.4 + 38.5 = 229.9 \\; \\mathrm{min}$$\n删失时长的总和：\n$$\\sum_{j=1}^{2} c_j = 20.0 + 15.0 = 35.0 \\; \\mathrm{min}$$\n总观察时间是这两个量的总和：\n$$\\text{Total Time} = \\sum_{i=1}^{8} t_i + \\sum_{j=1}^{2} c_j = 229.9 + 35.0 = 264.9 \\; \\mathrm{min}$$\n现在，我们使用MLE $\\hat{k}$的公式：\n$$\\hat{k} = \\frac{N}{\\text{Total Time}} = \\frac{8}{264.9} \\; \\mathrm{min}^{-1}$$\n$$\\hat{k} \\approx 0.03020007549... \\; \\mathrm{min}^{-1}$$\n问题要求答案四舍五入到四位有效数字。\n$$\\hat{k} \\approx 0.03020 \\; \\mathrm{min}^{-1}$$",
            "answer": "$$\\boxed{0.03020}$$"
        },
        {
            "introduction": "当系统过于复杂，无法用解析理论求解，且直接模拟或实验观测稀有事件又极其耗时，我们就需要更高效的计算方法。前向通量采样（Forward Flux Sampling, FFS）是一种强大的计算技术，专门用于解决这类问题。本练习通过一个编程任务，让你亲身体验FFS算法的核心逻辑，并理解其如何通过分步计算条件概率来高效估算稀有事件的速率 。",
            "id": "3928447",
            "problem": "您将使用基于轨迹的估计器来模拟合成基因调控网络中的罕见事件切换。考虑一个具有两个吸引盆的双稳态基因开关：一个低表达盆 $A$ 和一个高表达盆 $B$。用于区分状态的可观测量是一个根据系统状态 $x$ 构建的标量序参量 $\\lambda(x)$（例如，加权的蛋白质拷贝数）。从 $A$ 到 $B$ 的切换过程在稳态下是一个罕见事件。您将使用轨迹采样方法来计算 $A \\to B$ 转变的稳态速率常数。\n\n从以下基本基础出发：\n- 化学主方程（CME）描述了在随机动力学下，离散分子数上的概率分布随时间的演化。在稳态下，跨越任何非反应边界的概率流是恒定的。\n- 对于稳态罕见事件，平均首达切换速率 $k_{A \\to B}$ 可以分解为一个跨越边界的概率流（通量）与一个概率的乘积。该边界将 $A$ 与离开 $A$ 的轨迹分开，而该概率是指这样的轨迹到达 $B$ 而不返回 $A$ 的概率。\n- 可以通过在序参量空间 $\\lambda$ 中放置嵌套界面来构建轨迹系综：$\\lambda_0  \\lambda_1  \\cdots  \\lambda_n$，其中 $\\lambda_0$ 位于 $A$ 边界之外，而 $\\lambda_n$ 位于 $B$ 内部。人们可以估计在不返回的条件下连续到达后续界面的概率。\n\n任务：\n1. 根据这些原理和定义，推导稳态速率常数 $k_{A \\to B}$ 的表达式，该表达式应使用离开 $A$ 的可测量正向轨迹通量和与精心选择的界面 $\\{\\lambda_i\\}$ 相关的一系列条件概率来表示。\n2. 解释选择界面位置 $\\{\\lambda_i\\}$ 的基本原理，包括界面放置如何影响估计器中的统计方差和计算效率。您的解释应基于随机过程和轨迹系综的性质。\n3. 实现一个程序，给定从 $A$ 到第一个界面的稳态正向通量，以及到达后续界面而不返回 $A$ 的条件概率列表，为每个测试用例计算稳态速率常数，并将其表示为单个标量。以 $\\mathrm{h}^{-1}$（每小时）为单位表示速率，并以浮点数形式报告。\n4. 您的程序必须处理以下参数值测试套件，并为每个用例生成一个结果：\n   - 用例1（正常路径）：正向通量 $\\Phi = 0.015 \\,\\mathrm{h}^{-1}$ 和条件概率 $[0.25, 0.40, 0.50]$。\n   - 用例2（零概率边界条件）：正向通量 $\\Phi = 0.020 \\,\\mathrm{h}^{-1}$ 和条件概率 $[0.30, 0.00, 0.80]$。\n   - 用例3（具有高条件成功率的界面）：正向通量 $\\Phi = 0.0001 \\,\\mathrm{h}^{-1}$ 和条件概率 $[0.90, 0.95, 0.97, 0.92]$。\n   - 用例4（极小通量，中等概率）：正向通量 $\\Phi = 0.000001 \\,\\mathrm{h}^{-1}$ 和条件概率 $[0.20, 0.30, 0.25, 0.40, 0.50]$。\n   - 用例5（多个具有相似条件概率的界面）：正向通量 $\\Phi = 0.010 \\,\\mathrm{h}^{-1}$ 和条件概率 $[0.10, 0.10, 0.10, 0.10, 0.10]$。\n5. 最终输出格式要求：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，内含五个速率（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是相应案例计算出的速率，单位为 $\\mathrm{h}^{-1}$。不应打印单位或附加文本，只打印该列表。\n\n程序必须是自包含和确定性的，不需要用户输入，并且必须在标准环境中执行。所有计算都应严格遵守浮点运算。对于此问题，数字应被视为实数标量，任何乘法都应遵循标准实数算术规则。确保您推导中的所有变量和数字都按要求以 LaTeX 格式呈现。",
            "solution": "所述问题在科学上是合理的、适定的，并包含了完整解决方案所需的所有必要信息。它基于随机化学动力学和罕见事件采样理论的既定原则。所提供的参数在物理上是合理的，在数学上是一致的。因此，该问题被认为是有效的，并将提供解决方案。\n\n任务是推导基因调控网络中两个稳定状态之间切换的稳态速率常数的表达式，解释基于轨迹的估计方法的基本原理，并实现一个程序来计算几个测试用例的速率。\n\n**1. 速率常数表达式的推导**\n\n该问题涉及计算从吸引盆 $A$ 到吸引盆 $B$ 的罕见转变的速率常数 $k_{A \\to B}$。在稳态下，系统表现出波动，偶尔会将其从一个盆驱动到另一个盆。这种转变的速率可以概念化为两个因素的乘积：从状态 $A$ 向状态 $B$ 发起轨迹的速率，以及已发起的轨迹成功完成到 $B$ 的转变而不返回 $A$ 的概率。\n\n所描述的轨迹采样方法，称为前向通量采样（FFS）或类似的基于界面的技术，将这一概念形式化。状态空间由一系列由标量序参量 $\\lambda(x)$ 定义的非相交界面划分。设这些界面为 $\\{\\lambda_0, \\lambda_1, \\ldots, \\lambda_n\\}$，其排序为 $\\lambda_0  \\lambda_1  \\cdots  \\lambda_n$。界面 $\\lambda_0$ 放置在状态 $A$ 的边界之外，最终界面 $\\lambda_n$ 放置在状态 $B$ 之内。一旦轨迹穿过 $\\lambda_n$，就认为它已经转变到 $B$。\n\n速率常数 $k_{A \\to B}$ 可以表示为：\n$$\nk_{A \\to B} = \\Phi_{A \\to \\lambda_0} \\times P(\\lambda_n | \\lambda_0)\n$$\n其中：\n- $\\Phi_{A \\to \\lambda_0}$ 是稳态正向通量，表示源于盆 $A$ 的轨迹首次穿过第一个界面 $\\lambda_0$ 的速率。问题直接提供了这个量，我们将其表示为 $\\Phi$。它的单位是单位时间内的事件数，例如 $\\mathrm{h}^{-1}$。\n- $P(\\lambda_n | \\lambda_0)$ 是一个条件概率，指刚从 $A$ 穿过 $\\lambda_0$ 的轨迹，在返回盆 $A$ 之前继续前进并穿过 $\\lambda_n$ 的概率。\n\n如果 $P(\\lambda_n | \\lambda_0)$ 是一个非常小的数，直接计算它可能在计算上非常昂贵。FFS方法通过使用概率的链式法则将其分解为一系列更易于处理的条件概率的乘积来规避这个问题：\n$$\nP(\\lambda_n | \\lambda_0) = P(\\lambda_1 | \\lambda_0) \\times P(\\lambda_2 | \\lambda_1) \\times \\cdots \\times P(\\lambda_n | \\lambda_{n-1})\n$$\n这种分解依赖于一个假设，即穿越连续界面的过程近似于马尔可夫过程。每一项 $P(\\lambda_i | \\lambda_{i-1})$ 表示从 $A$ 方向到达界面 $\\lambda_{i-1}$ 的轨迹在返回 $A$ 之前下一次到达界面 $\\lambda_i$ 的概率。\n\n设给定的条件概率列表为 $[p_1, p_2, \\ldots, p_m]$，其中 $p_i = P(\\lambda_i | \\lambda_{i-1})$，$m$ 是 $\\lambda_0$ 之外的界面数量。从 $\\lambda_0$ 成功转变到最终界面 $\\lambda_m$ 的总概率是这些单个概率的乘积：\n$$\nP(\\lambda_m | \\lambda_0) = \\prod_{i=1}^{m} p_i\n$$\n将此代入原始速率表达式，我们得到稳态速率常数的最终公式：\n$$\nk_{A \\to B} = \\Phi \\prod_{i=1}^{m} p_i\n$$\n这就是需要实现的表达式。它表明，总的切换速率是离开起始盆的初始轨迹通量，该通量被穿过中间过渡区域的连续推进概率所衰减。\n\n**2. 界面放置的基本原理**\n\n界面 $\\{\\lambda_i\\}$ 的放置对速率计算的效率和准确性至关重要。主要目标是将单个罕见事件（从 $A$ 到 $B$ 的转变）分解为一系列更频繁的事件（从 $\\lambda_{i-1}$ 到 $\\lambda_i$ 的穿越）。\n\n- **统计方差和计算成本：** 罕见事件模拟的核心挑战是统计不确定性。直接模拟需要长得不可行的时间（量级为 $1/k_{A \\to B}$）才能观察到切换。FFS方法通过将计算精力集中在轨迹有希望的部分来提高效率。估计速率常数的总方差与每个估计的条件概率 $p_i$ 的相对方差之和有关。为了在固定的计算预算下最小化总误差，希望概率 $p_i$ 不要过小。如果某个 $p_i$ 非常小，就必须从界面 $\\lambda_{i-1}$ 开始进行大量的试运行，才能获得对 $p_i$ 的统计可靠估计，这违背了该方法的初衷。\n\n- **界面间距：**\n    - 如果界面放置得**太远**，条件概率 $p_i = P(\\lambda_i | \\lambda_{i-1})$ 将会非常低。这会在单个界面步骤的层面上重新引入罕见性问题，导致 $p_i$ 估计值以及最终速率 $k_{A \\to B}$ 的统计方差很高。\n    - 如果界面放置得**太近**，条件概率 $p_i$ 将接近于 $1$。虽然这很容易以低方差进行估计，但在计算上是低效的。需要许多界面才能跨越过渡区域，而每一步只取得边际进展。管理大量界面并在每个界面重新启动模拟所带来的开销将主导计算成本。\n\n- **最优放置策略：** 最优策略是一种平衡。界面的放置应使得条件概率 $p_i$ 足够大以便能被有效采样（例如，通常在 $0.1$ 到 $0.5$ 的范围内），但又足够小以便能用合理数量的界面在过渡区域取得有意义的进展。有效的放置确保了计算工作量大致均匀地分布在转变的各个阶段。这在很大程度上取决于序参量 $\\lambda(x)$ 作为反应坐标的质量；对于一个好的反应坐标，$\\lambda$ 的进展与向目标状态 $B$ 的进展密切相关。\n\n**3. 测试用例的实现**\n\n程序将实现推导出的公式 $k_{A \\to B} = \\Phi \\prod p_i$。对于每个测试用例，它将获取给定的正向通量 $\\Phi$ 和条件概率列表 $[p_1, p_2, \\ldots, p_m]$，计算它们的乘积，然后乘以 $\\Phi$ 以求得速率常数。\n\n- **用例1：** $k = 0.015 \\times (0.25 \\times 0.40 \\times 0.50) = 0.015 \\times 0.05 = 0.00075 \\, \\mathrm{h}^{-1}$。\n- **用例2：** $k = 0.020 \\times (0.30 \\times 0.00 \\times 0.80) = 0.020 \\times 0 = 0.0 \\, \\mathrm{h}^{-1}$。任何界面上的零概率都会阻断整个路径。\n- **用例3：** $k = 0.0001 \\times (0.90 \\times 0.95 \\times 0.97 \\times 0.92) = 0.0001 \\times 0.763002 = 0.0000763002 \\, \\mathrm{h}^{-1}$。高概率意味着通量没有被强烈衰减。\n- **用例4：** $k = 0.000001 \\times (0.20 \\times 0.30 \\times 0.25 \\times 0.40 \\times 0.50) = 1.0 \\times 10^{-6} \\times 0.003 = 3.0 \\times 10^{-9} \\, \\mathrm{h}^{-1}$。这是一个极其罕见的事件。\n- **用例5：** $k = 0.010 \\times (0.10 \\times 0.10 \\times 0.10 \\times 0.10 \\times 0.10) = 0.010 \\times 10^{-5} = 1.0 \\times 10^{-7} \\, \\mathrm{h}^{-1}$。许多低概率的阶段导致了巨大的整体衰减。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the stationary rate constant for A - B transitions for a suite of test cases.\n    The rate constant k is calculated using the formula derived from Forward Flux Sampling principles:\n    k = Phi * product(P_i), where Phi is the forward flux from basin A to the first interface,\n    and P_i are the conditional probabilities of reaching successive interfaces.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (forward_flux_in_h^-1, list_of_conditional_probabilities).\n    test_cases = [\n        # Case 1 (happy path)\n        (0.015, [0.25, 0.40, 0.50]),\n        # Case 2 (boundary condition with zero probability)\n        (0.020, [0.30, 0.00, 0.80]),\n        # Case 3 (interfaces with high conditional success)\n        (0.0001, [0.90, 0.95, 0.97, 0.92]),\n        # Case 4 (very small flux, moderate probabilities)\n        (0.000001, [0.20, 0.30, 0.25, 0.40, 0.50]),\n        # Case 5 (many interfaces with similar conditional probability)\n        (0.010, [0.10, 0.10, 0.10, 0.10, 0.10]),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract the forward flux (Phi) and the list of probabilities from the case data.\n        forward_flux, conditional_probs = case\n\n        # The total probability of a trajectory successfully crossing all interfaces\n        # is the product of the individual conditional probabilities.\n        # np.prod calculates the product of all elements in the array.\n        # If the list of probabilities is empty, the product is 1.0, which is correct\n        # as it implies the first interface is the target, and P(lambda_0|lambda_0) = 1.\n        total_probability = np.prod(conditional_probs)\n\n        # The stationary rate constant k is the product of the initial flux\n        # and the total probability of completing the transition.\n        rate_constant = forward_flux * total_probability\n        \n        results.append(rate_constant)\n\n    # Final print statement in the exact required format.\n    # The format is a comma-separated list of floating-point numbers enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}