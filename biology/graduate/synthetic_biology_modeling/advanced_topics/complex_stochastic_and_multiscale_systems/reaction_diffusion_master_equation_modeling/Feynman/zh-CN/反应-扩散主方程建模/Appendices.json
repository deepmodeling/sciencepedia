{
    "hands_on_practices": [
        {
            "introduction": "反应扩散主方程（RDME）的数学核心在于其生成元矩阵 $Q$，它编码了系统所有可能的状态跃迁。本练习将指导您从基本原理出发，为一个简单的双微室扩散系统构建此矩阵。通过分析其特征值，您将深入理解系统如何弛豫至平衡态，这是连接抽象数学描述与可观测物理行为的基础性实践练习 。",
            "id": "3929346",
            "problem": "考虑一个反应扩散主方程（RDME）模型，该模型描述了单个化学物种在标记为 $1$ 和 $2$ 的两个空间体素之间进行扩散。该系统是封闭的，总共包含 $N$ 个分子，因此系统状态可以由体素 $1$ 中的分子数 $n \\in \\{0,1,\\dots,N\\}$ 完全确定（此时体素 $2$ 中有 $N-n$ 个分子）。体素 $1$ 中的每个分子以速率 $\\eta_{1}$（每个分子）跳跃到体素 $2$，体素 $2$ 中的每个分子以速率 $\\eta_{2}$（每个分子）跳跃到体素 $1$。假设分子之间不相互作用，并且没有其他化学反应。\n\n从反应扩散主方程（RDME）作为连续时间马尔可夫链（CTMC）的定义出发，其生成元为 $Q$，满足状态概率向量 $\\boldsymbol{p}(t)$ 的方程 $\\frac{d}{dt}\\boldsymbol{p}(t) = Q \\boldsymbol{p}(t)$，请完成以下任务：\n\n1. 以 $N$、$\\eta_{1}$ 和 $\\eta_{2}$ 为参数，显式地构造 $(N+1)\\times(N+1)$ 的生成元矩阵 $Q$。你的构造必须遵循单分子扩散事件的 RDME 倾向性的基本马尔可夫跳跃过程定义，并且必须确定所有非零元素 $Q_{i,j}$，其中 $i,j \\in \\{0,1,\\dots,N\\}$。\n\n2. 符号化地计算 $Q$ 的全部特征值，并从第一性原理出发解释你的推导过程，包括分子的独立性如何导致该谱的形成。\n\n3. 确定与每个非零特征值模式相关的弛豫至平衡的时间，并找出最慢的弛豫时间（这些模式中最长的时间尺度）。以秒为单位表示最慢的弛豫时间。不要代入数值；给出一个封闭形式的表达式。\n\n你的最终答案必须是表示最慢弛豫时间（以秒为单位）的单一封闭形式表达式。不需要近似或四舍五入。",
            "solution": "我们从反应扩散主方程（RDME）作为连续时间马尔可夫链（CTMC）的基本定义开始。对于有限状态空间上的 CTMC，细观层面的质量作用定律规定，单分子扩散事件被建模为马尔可夫跳跃。生成元 $Q$ 编码了转移速率，使得对于状态上的概率向量 $\\boldsymbol{p}(t)$，主方程为 $\\frac{d}{dt}\\boldsymbol{p}(t) = Q \\boldsymbol{p}(t)$。\n\n在这个具有两个体素和一种物种的系统中，状态可以由整数 $n \\in \\{0,1,\\dots,N\\}$ 表示，该整数表示体素 $1$ 中的分子数量；体素 $2$ 中的分子数量则为 $N-n$。体素 $1$ 中的分子以每个分子 $\\eta_{1}$ 的速率跳跃到体素 $2$，体素 $2$ 中的分子以每个分子 $\\eta_{2}$ 的速率跳跃到体素 $1$。由于分子不相互作用且只进行扩散，每个分子都独立地遵循其自身的两状态（体素 $1$ 或体素 $2$）马尔可夫动力学。\n\n步骤 1（构造 $Q$）：关于 $n$ 的生灭链的 RDME 倾向性源于单分子事件：\n\n- 体素 $1$ 中的一个分子跳跃到体素 $2$，使 $n$ 减少 $1$，即 $n \\mapsto n-1$。从状态 $n$ 发生此转移的总速率为 $\\eta_{1} \\times n$，因为体素 $1$ 中有 $n$ 个分子，每个分子以速率 $\\eta_{1}$ 跳跃。\n\n- 体素 $2$ 中的一个分子跳跃到体素 $1$，使 $n$ 增加 $1$，即 $n \\mapsto n+1$。从状态 $n$ 发生此转移的总速率为 $\\eta_{2} \\times (N-n)$，因为体素 $2$ 中有 $N-n$ 个分子。\n\n因此，生成元 $Q$ 是一个三对角矩阵，其非对角元素为\n$$\nQ_{n,n-1} = \\eta_{1} \\, n \\quad \\text{对于 } n=1,2,\\dots,N,\n$$\n$$\nQ_{n,n+1} = \\eta_{2} \\, (N-n) \\quad \\text{对于 } n=0,1,\\dots,N-1,\n$$\n对于其他非对角元素则为零。对角元素是每个状态 $n$ 的负总离开率：\n$$\nQ_{n,n} = -\\big( \\eta_{1} \\, n + \\eta_{2} \\, (N-n) \\big) \\quad \\text{对于 } n=0,1,\\dots,N,\n$$\n约定状态空间之外的项为零，即不存在从 $n=0$ 到 $n=-1$ 或从 $n=N$ 到 $n=N+1$ 的转移。这完全确定了 $(N+1)\\times(N+1)$ 的生成元矩阵 $Q$。\n\n步骤 2（计算 $Q$ 的特征值）：我们运用独立聚合相同两状态 CTMC 的基本原理。将单个分子视为一个两状态 CTMC，状态为“体素 $1$”和“体素 $2$”，其以速率 $\\eta_{1}$ 从体素 $1$ 转移到体素 $2$，并以速率 $\\eta_{2}$ 从体素 $2$ 转移到体素 $1$。该两状态空间上的单分子生成元 $G$ 为\n$$\nG = \\begin{pmatrix}\n-\\eta_{1} & \\eta_{1} \\\\\n\\eta_{2} & -\\eta_{2}\n\\end{pmatrix}.\n$$\n$G$ 的特征值通过求解 $\\det(G - \\lambda I) = 0$ 得到：\n$$\n\\det \\begin{pmatrix}\n-\\eta_{1} - \\lambda & \\eta_{1} \\\\\n\\eta_{2} & -\\eta_{2} - \\lambda\n\\end{pmatrix}\n= (\\eta_{1} + \\lambda)(\\eta_{2} + \\lambda) - \\eta_{1}\\eta_{2}\n= \\lambda(\\eta_{1} + \\eta_{2} + \\lambda).\n$$\n因此，单分子过程的特征值为\n$$\n\\lambda^{(1)}_{0} = 0, \\quad \\lambda^{(1)}_{1} = -(\\eta_{1} + \\eta_{2}).\n$$\n\n现在，对于 $N$ 个独立的分子，在 $\\{0,1\\}^{N}$ 上的联合过程是这些两状态 CTMC 的 $N$ 重独立积。体素 $1$ 中的分子数 $n$ 是一个集总变量，它计算 $N$ 个独立的两状态变量中有多少处于“体素 $1$”状态。乘积空间上生成元的谱是单分子非零特征值在独立坐标上所有可能求和的集合。因为每个分子对一个模式的衰减率的贡献要么是 $0$，要么是 $-(\\eta_{1} + \\eta_{2})$，所以 $N$ 分子生成元的任何特征值都必须具有以下形式\n$$\n\\lambda_{m} = - m \\, (\\eta_{1} + \\eta_{2}), \\quad m \\in \\{0,1,\\dots,N\\}.\n$$\n严格的证明可以使用乘积链的表示论，或者通过正交多项式（Krawtchouk多项式）对 $Q$ 生成的生灭链进行显式构造，但从第一性原理出发的核心是 $N$ 个相同的两状态 CTMC 的独立性，以及聚合体的生成元是独立生成元之和这一事实。因此，$Q$ 的特征值恰好是\n$$\n\\left\\{ \\lambda_{m} = - m \\, (\\eta_{1} + \\eta_{2}) \\, \\big| \\, m=0,1,\\dots,N \\right\\}.\n$$\n在完整乘积空间上，特征值 $\\lambda_{m}$ 的多重性是 $\\binom{N}{m}$，当集总到关于 $n$ 的生灭链时，我们得到一个包含 $N+1$ 个特征值的完整集合，其值与 $\\lambda_{m}$ 相同，其中 $m=0,\\dots,N$。\n\n步骤 3（弛豫至平衡的时间）：对于具有生成元 $Q$ 的 CTMC，方程 $\\frac{d}{dt}\\boldsymbol{p}(t) = Q \\boldsymbol{p}(t)$ 的解可以分解为以 $\\exp(\\lambda_{m} t)$ 形式衰减的模式，其中 $\\lambda_{m}$ 是 $Q$ 的特征值。与特征值 $\\lambda_{m} \\neq 0$ 的模式相关联的弛豫时间（时间常数）为\n$$\n\\tau_{m} = \\frac{1}{|\\lambda_{m}|}.\n$$\n使用 $\\lambda_{m} = - m \\, (\\eta_{1} + \\eta_{2})$，对于 $m=1,2,\\dots,N$，弛豫时间的集合是\n$$\n\\tau_{m} = \\frac{1}{m \\, (\\eta_{1} + \\eta_{2})}, \\quad m=1,2,\\dots,N.\n$$\n最慢的弛豫时间（最大的时间常数）对应于最小的非零衰减率，即 $m=1$，因此为\n$$\n\\tau_{\\text{slow}} = \\frac{1}{\\eta_{1} + \\eta_{2}}.\n$$\n通过量纲分析，$\\eta_{1}$ 和 $\\eta_{2}$ 是速率，单位为 $\\text{s}^{-1}$，因此 $\\tau_{\\text{slow}}$ 的单位是秒。根据要求，我们将最慢弛豫时间表示为封闭形式的符号表达式 $\\frac{1}{\\eta_{1} + \\eta_{2}}$，不进行数值代入。",
            "answer": "$$\\boxed{\\frac{1}{\\eta_{1}+\\eta_{2}}}$$"
        },
        {
            "introduction": "由于大多数 RDME 系统的复杂性，我们通常依赖于随机模拟算法来探索其动态行为。本练习旨在揭开模拟过程的“黑箱”，引导您手动执行一次“下一微室方法”（Next Subvolume Method, NSM）的计算步骤，这是一种高效的空间随机模拟算法。通过亲手计算倾向函数、事件时间和状态更新，您将对这些模拟的内在机制建立起关键的直觉 。",
            "id": "3929327",
            "problem": "考虑一个由反应扩散主方程 (Reaction-Diffusion Master Equation, RDME) 建模的充分混合的反应扩散系统，该系统位于一个一维晶格上，有两个体元，标记为 $V_{1}$ 和 $V_{2}$，每个体元的体积为 $\\Omega = 1.0 \\times 10^{-18}\\ \\mathrm{m}^{3}$，且具有零通量边界条件。存在两种分子，$A$ 和 $B$。在每个体元内，发生单一的双分子反应：$A + B \\rightarrow \\varnothing$，其宏观二级速率常数为 $k = 5.0 \\times 10^{-20}\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-1}$。在体元 $V_{\\ell}$ 中，此反应的随机质量作用倾向性为 $a_{r,\\ell} = \\dfrac{k}{\\Omega} N_{A,\\ell} N_{B,\\ell}$，其中 $N_{A,\\ell}$ 和 $N_{B,\\ell}$ 分别是体元 $V_{\\ell}$ 中分子 $A$ 和 $B$ 的数量。两种分子都在相邻体元之间扩散，其单分子跳跃速率分别为 $d_{A} = 2.0\\ \\mathrm{s}^{-1}$ 和 $d_{B} = 1.0\\ \\mathrm{s}^{-1}$。由于是零通量边界且只有两个体元，每个在 $V_{1}$ 中的分子只能跳跃到 $V_{2}$，反之亦然。\n\n在时间 $t = 0$ 时，拷贝数为：\n- $N_{A,1}(0) = 3$, $N_{B,1}(0) = 4$,\n- $N_{A,2}(0) = 2$, $N_{B,2}(0) = 1$。\n\n执行下一步长子体积法 (Next Subvolume Method, NSM) 的一个模拟步骤，其中下一步长子体积法 (NSM) 为每个体元从指数等待时间中独立抽样下一个事件时间，其速率等于该体元中所有反应和向外扩散倾向性之和，然后选择具有最早事件的体元，并以与其倾向性成正比的概率选择该体元内的哪个通道触发。使用以下在 $(0,1)$ 上的独立均匀随机变量：\n- 对于体元 $V_{1}$ 的下一个事件时间：$r_{1} = 0.2$，\n- 对于体元 $V_{2}$ 的下一个事件时间：$r_{2} = 0.6$，\n- 对于所选体元内的事件通道选择：$r_{\\mathrm{sel}} = 0.65$。\n\n明确计算：\n- 每个体元中反应和每个向外扩散通道的初始倾向性，以及它们按体元的总和，\n- 两个候选的下一个事件时间（每个体元一个），\n- 被选中的体元和具体事件（反应，或哪种分子扩散以及方向），\n- 事件发生后的更新状态以及任何受影响体元的更新倾向性。\n\n将此 NSM 步骤的时间增量 $\\Delta t$（以秒为单位）作为你的最终答案。将你的答案四舍五入到四位有效数字。以秒表示时间。",
            "solution": "该问题是有效的。它在反应扩散主方程 (RDME) 的标准框架内提出了一个明确定义的场景，并要求执行下一步长子体积法 (NSM) 的一个步骤，这是一种用于此类系统的正确且成熟的模拟算法。所有必要的参数、初始条件和随机变量均已提供，使得问题自洽、一致且可解。\n\n我们按要求执行下一步长子体积法的一个步骤。\n\n### 步骤 1：计算初始倾向性\n\n系统的状态由两个体元中分子 $A$ 和 $B$ 的拷贝数给出，$\\mathbf{N}(t) = (N_{A,1}(t), N_{B,1}(t), N_{A,2}(t), N_{B,2}(t))$。\n在时间 $t=0$ 时，初始状态为 $\\mathbf{N}(0) = (3, 4, 2, 1)$。\n\n反应 $A + B \\rightarrow \\varnothing$ 的随机速率常数由宏观速率常数 $k = 5.0 \\times 10^{-20}\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-1}$ 和体元体积 $\\Omega = 1.0 \\times 10^{-18}\\ \\mathrm{m}^{3}$ 导出：\n$$\nk_{r} = \\frac{k}{\\Omega} = \\frac{5.0 \\times 10^{-20}\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-1}}{1.0 \\times 10^{-18}\\ \\mathrm{m}^{3}} = 0.05\\ \\mathrm{s}^{-1}\n$$\n单分子扩散速率给定为 $d_{A} = 2.0\\ \\mathrm{s}^{-1}$ 和 $d_{B} = 1.0\\ \\mathrm{s}^{-1}$。\n\n我们计算每个体元中所有可能事件（反应和向外扩散）的倾向性。\n\n**对于体元 $V_{1}$（其中 $N_{A,1}=3, N_{B,1}=4$）：**\n- 反应倾向性 ($A+B \\rightarrow \\varnothing$)：\n  $a_{r,1} = k_{r} N_{A,1} N_{B,1} = (0.05\\ \\mathrm{s}^{-1})(3)(4) = 0.6\\ \\mathrm{s}^{-1}$\n- A 从 $V_1$ 扩散到 $V_2$：\n  $a_{d,A,1 \\to 2} = d_{A} N_{A,1} = (2.0\\ \\mathrm{s}^{-1})(3) = 6.0\\ \\mathrm{s}^{-1}$\n- B 从 $V_1$ 扩散到 $V_2$：\n  $a_{d,B,1 \\to 2} = d_{B} N_{B,1} = (1.0\\ \\mathrm{s}^{-1})(4) = 4.0\\ \\mathrm{s}^{-1}$\n\n体元 $V_{1}$ 的倾向性总和为：\n$$\na_{\\mathrm{tot},1} = a_{r,1} + a_{d,A,1 \\to 2} + a_{d,B,1 \\to 2} = 0.6 + 6.0 + 4.0 = 10.6\\ \\mathrm{s}^{-1}\n$$\n\n**对于体元 $V_{2}$（其中 $N_{A,2}=2, N_{B,2}=1$）：**\n- 反应倾向性 ($A+B \\rightarrow \\varnothing$)：\n  $a_{r,2} = k_{r} N_{A,2} N_{B,2} = (0.05\\ \\mathrm{s}^{-1})(2)(1) = 0.1\\ \\mathrm{s}^{-1}$\n- A 从 $V_2$ 扩散到 $V_1$：\n  $a_{d,A,2 \\to 1} = d_{A} N_{A,2} = (2.0\\ \\mathrm{s}^{-1})(2) = 4.0\\ \\mathrm{s}^{-1}$\n- B 从 $V_2$ 扩散到 $V_1$：\n  $a_{d,B,2 \\to 1} = d_{B} N_{B,2} = (1.0\\ \\mathrm{s}^{-1})(1) = 1.0\\ \\mathrm{s}^{-1}$\n\n体元 $V_{2}$ 的倾向性总和为：\n$$\na_{\\mathrm{tot},2} = a_{r,2} + a_{d,A,2 \\to 1} + a_{d,B,2 \\to 1} = 0.1 + 4.0 + 1.0 = 5.1\\ \\mathrm{s}^{-1}\n$$\n\n### 步骤 2：生成候选的下一个事件时间\n\nNSM 算法为每个体元 $\\ell$ 从速率为 $a_{\\mathrm{tot},\\ell}$ 的指数分布中抽样一个候选的下一个事件时间 $\\tau_{\\ell}$。使用逆变换法和给定的均匀随机变量 $r_{\\ell} \\in (0,1)$，时间计算为 $\\tau_{\\ell} = \\frac{1}{a_{\\mathrm{tot},\\ell}}\\ln\\left(\\frac{1}{r_{\\ell}}\\right)$。\n\n- 对于 $V_{1}$，使用 $r_{1} = 0.2$ 和 $a_{\\mathrm{tot},1} = 10.6\\ \\mathrm{s}^{-1}$：\n$$\n\\tau_1 = \\frac{1}{10.6\\ \\mathrm{s}^{-1}} \\ln\\left(\\frac{1}{0.2}\\right) = \\frac{\\ln(5)}{10.6}\\ \\mathrm{s} \\approx 0.15183\\ \\mathrm{s}\n$$\n- 对于 $V_{2}$，使用 $r_{2} = 0.6$ 和 $a_{\\mathrm{tot},2} = 5.1\\ \\mathrm{s}^{-1}$：\n$$\n\\tau_2 = \\frac{1}{5.1\\ \\mathrm{s}^{-1}} \\ln\\left(\\frac{1}{0.6}\\right) = \\frac{\\ln(5/3)}{5.1}\\ \\mathrm{s} \\approx 0.10016\\ \\mathrm{s}\n$$\n\n### 步骤 3：选择体元和事件\n\n算法选择具有最小候选时间的体元。\n$$\n\\Delta t = \\min(\\tau_1, \\tau_2) = \\min(0.15183\\ \\mathrm{s}, 0.10016\\ \\mathrm{s}) = \\tau_2 \\approx 0.10016\\ \\mathrm{s}\n$$\n下一个事件将在时间 $t = \\Delta t$ 时在体元 $V_{2}$ 中发生。要求的最终答案是这个时间增量 $\\Delta t$。\n\n接下来，我们通过使用随机变量 $r_{\\mathrm{sel}} = 0.65$ 来确定在 $V_{2}$ 内发生哪个具体事件。我们检查 $r_{\\mathrm{sel}} \\times a_{\\mathrm{tot},2}$ 的值落入哪个倾向性区间。\n$$\nr_{\\mathrm{sel}} \\times a_{\\mathrm{tot},2} = 0.65 \\times 5.1 = 3.315\n$$\n为 $V_2$ 构建的倾向性区间是按通道顺序排列的：反应、A的扩散、B的扩散。\n1. 反应 ($a_{r,2} = 0.1$)：区间 $[0, 0.1)$\n2. A的扩散 ($a_{d,A,2 \\to 1} = 4.0$)：区间 $[0.1, 0.1+4.0) = [0.1, 4.1)$\n3. B的扩散 ($a_{d,B,2 \\to 1} = 1.0$)：区间 $[4.1, 4.1+1.0) = [4.1, 5.1)$\n\n由于 $3.315$ 在区间 $[0.1, 4.1)$ 内，所选事件是分子 A 从体元 $V_{2}$ 扩散到体元 $V_{1}$。\n\n### 步骤 4：更新系统状态和倾向性\n\n所选事件为 $A_{V_2} \\rightarrow A_{V_1}$。状态变化为：\n- $N_{A,1}$ 增加 1。\n- $N_{A,2}$ 减少 1。\n- 所有其他拷贝数保持不变。\n\n新状态 $\\mathbf{N}'$ 为：\n$N'_{A,1} = N_{A,1} + 1 = 3 + 1 = 4$\n$N'_{B,1} = N_{B,1} = 4$\n$N'_{A,2} = N_{A,2} - 1 = 2 - 1 = 1$\n$N'_{B,2} = N_{B,2} = 1$\n因此，新的状态向量为 $\\mathbf{N}' = (4, 4, 1, 1)$。\n\n必须基于这个新状态重新计算两个体元的倾向性。\n**体元 $V_{1}$ 的更新倾向性：**\n$a'_{r,1} = k_{r} N'_{A,1} N'_{B,1} = (0.05)(4)(4) = 0.8\\ \\mathrm{s}^{-1}$\n$a'_{d,A,1 \\to 2} = d_{A} N'_{A,1} = (2.0)(4) = 8.0\\ \\mathrm{s}^{-1}$\n$a'_{d,B,1 \\to 2} = d_{B} N'_{B,1} = (1.0)(4) = 4.0\\ \\mathrm{s}^{-1}$\n$a'_{\\mathrm{tot},1} = 0.8 + 8.0 + 4.0 = 12.8\\ \\mathrm{s}^{-1}$\n\n**体元 $V_{2}$ 的更新倾向性：**\n$a'_{r,2} = k_{r} N'_{A,2} N'_{B,2} = (0.05)(1)(1) = 0.05\\ \\mathrm{s}^{-1}$\n$a'_{d,A,2 \\to 1} = d_{A} N'_{A,2} = (2.0)(1) = 2.0\\ \\mathrm{s}^{-1}$\n$a'_{d,B,2 \\to 1} = d_{B} N'_{B,2} = (1.0)(1) = 1.0\\ \\mathrm{s}^{-1}$\n$a'_{\\mathrm{tot},2} = 0.05 + 2.0 + 1.0 = 3.05\\ \\mathrm{s}^{-1}$\n\n### 最终答案计算\n\n问题要求的是此 NSM 步骤的时间增量 $\\Delta t$，即 $\\tau_2$。\n$$\n\\Delta t = \\tau_2 = \\frac{\\ln(5/3)}{5.1}\\ \\mathrm{s} \\approx 0.10016188\\ \\mathrm{s}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t \\approx 0.1002\\ \\mathrm{s}\n$$",
            "answer": "$$\\boxed{0.1002}$$"
        },
        {
            "introduction": "RDME 本质上是连续物理现实的一种离散近似，因此一个核心挑战是确保这种近似在离散化尺度变细时能够正确收敛。本练习提出了一个发人深省的反例，它揭示了一种看似合理的朴素建模选择如何导致结果发散，并与物理现实相悖。这个练习强调了在模型构建中审慎思考的极端重要性，尤其是在处理如边界反应等跨尺度过程时 。",
            "id": "3929349",
            "problem": "您正在使用反应-扩散主方程（RDME）对嵌入三维胞质体积中的单个球形受体的配体结合进行建模。您的目标是构建一个反例，表明朴素的离散化会颠覆预期的收敛行为：减小体素大小会使预测的稳态结合速率相对于连续Smoluchowski预测值增加。您将量化这种离散化引起的误差。\n\n基本原理：\n- 反应-扩散主方程（RDME）通过将空间划分为边长为$h$的体素，并将扩散处理为速率与$D/h^2$成正比的最近邻跳跃，将反应处理为体素局域倾向，来模拟空间随机化学动力学。\n- Smoluchowski理论给出了在三维空间中，半径为$a$的完美吸收球形靶的连续扩散限制稳态速率常数为$k_{\\mathrm{Smol}} = 4 \\pi D a$。\n\n情景：\n- 考虑一个边长为$L$（单位：微米，$\\mu\\mathrm{m}$）的立方体域，其中一个物理半径为$a$（单位：$\\mu\\mathrm{m}$）的球形受体以原点为中心。\n- 胞质配体浓度维持在一个空间均匀值$c_\\infty$（单位：$\\mu\\mathrm{m}^{-3}$）。将$c_\\infty$视为一个恒定的背景浓度场。\n- 在一个均匀的立方晶格上对空间进行离散化，体素边长为$h$（单位：$\\mu\\mathrm{m}$），体素中心位于$(i h, j h, k h)$，其中$i,j,k$为整数，原点在$(0,0,0)$。\n- 将受体表示为所有中心位于半径为$a$的球体内部的体素的并集（即，计算中心到原点距离小于或等于$a$的体素）。令$N(h)$为此类反应性体素的数量。反应性体积为$V_{\\mathrm{reactive}}(h) = N(h) h^3$（单位：$\\mu\\mathrm{m}^3$）。\n- 在RDME中，将结合朴素地实现为一个一阶体素局域衰减，每个体素的反应速率为$\\lambda_v(h) = \\beta D / h$（单位：$\\mathrm{s}^{-1}$），其中$D$是扩散系数（单位：$\\mu\\mathrm{m}^2/\\mathrm{s}$），$\\beta$是一个无量纲常数。这种$\\lambda_v(h) \\propto 1/h$的缩放方式错误地将表面吸收过程视为体积衰减，并且没有包含正确的几何因子。这种错误的设定是为构建反例而有意为之的。\n- 在均匀背景浓度$c_\\infty$的假设下，这种朴素方案的RDME预测稳态结合速率（消耗通量）为\n$$F_{\\mathrm{RDME}}(h) = \\lambda_v(h)\\, c_\\infty\\, V_{\\mathrm{reactive}}(h),$$\n单位为$\\mathrm{s}^{-1}$。\n- 对于完美吸收体，连续Smoluchowski预测给出的稳态结合速率为\n$$F_{\\mathrm{Smol}} = \\left(4\\pi D a\\right) c_\\infty,$$\n单位为$\\mathrm{s}^{-1}$。\n\n任务：\n- 对于每个测试用例，通过计算满足$\\sqrt{(i h)^2 + (j h)^2 + (k h)^2} \\le a$的整数三元组$(i,j,k)$的数量来计算$N(h)$。然后计算$V_{\\mathrm{reactive}}(h) = N(h) h^3$、$\\lambda_v(h) = \\beta D / h$、$F_{\\mathrm{RDME}}(h)$和$F_{\\mathrm{Smol}}$。\n- 将离散化引起的误差量化为相对误差\n$$\\varepsilon(h) = \\frac{F_{\\mathrm{RDME}}(h)}{F_{\\mathrm{Smol}}} - 1,$$\n这是一个无量纲量，应以十进制数报告。\n\n参数和单位：\n- 扩散系数$D$（单位：$\\mu\\mathrm{m}^2/\\mathrm{s}$）。\n- 受体半径$a$（单位：$\\mu\\mathrm{m}$）。\n- 体积浓度$c_\\infty$（单位：$\\mu\\mathrm{m}^{-3}$）。\n- 域边长$L$（单位：$\\mu\\mathrm{m}$）（注意：$L$为物理背景而提供；只要$L \\gg a$，$N(h)$的计数过程是围绕原点的局部过程，不需要枚举整个域）。\n- 无量纲缩放常数$\\beta$。\n- 体素大小$h$（单位：$\\mu\\mathrm{m}$）。\n\n测试套件：\n使用以下参数值来检验不同情况：\n- $D = 10\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，\n- $a = 1\\,\\mu\\mathrm{m}$，\n- $c_\\infty = 1\\,\\mu\\mathrm{m}^{-3}$，\n- $L = 10\\,\\mu\\mathrm{m}$，\n- $\\beta = 1$，\n- 体素大小$h$：\n    1. $h = 1.0\\,\\mu\\mathrm{m}$（粗糙离散化，边界情况），\n    2. $h = 0.5\\,\\mu\\mathrm{m}$（中等离散化，理想情况），\n    3. $h = 0.25\\,\\mu\\mathrm{m}$（精细离散化），\n    4. $h = 0.125\\,\\mu\\mathrm{m}$（非常精细的离散化，说明误差增长的显著边界情况）。\n\n要求输出：\n- 对于每个测试用例，计算如上定义的$\\varepsilon(h)$，并将每个答案表示为十进制数（无量纲）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4]\"）。\n\n科学真实性说明：\n- 错误指定的缩放$\\lambda_v(h) = \\beta D / h$不是一个正确的边界反应映射；这里使用它来演示朴素的基于体素的实现如何随着网格的细化而人为地提高结合速率。您必须基于上述定义进行计算，而不纠正此缩放。",
            "solution": "该问题要求计算一个朴素的反应-扩散主方程（RDME）模型中，配体与球形受体结合时由离散化引起的相对误差$\\varepsilon(h)$。误差的量化将展示一个不正确的模型设定如何导致预测的结合速率随着空间离散化的细化而出现悖论性的增加。\n\n首先，我们严格遵守所提供的定义，建立我们关注的量的数学表达式。\n由朴素RDME模型预测的稳态结合速率由下式给出：\n$$ F_{\\mathrm{RDME}}(h) = \\lambda_v(h)\\, c_\\infty\\, V_{\\mathrm{reactive}}(h) $$\n每个体素的反应速率为$\\lambda_v(h) = \\beta D / h$，反应性体素的总体积为$V_{\\mathrm{reactive}}(h) = N(h) h^3$。将这些代入速率方程，得到：\n$$ F_{\\mathrm{RDME}}(h) = \\left(\\frac{\\beta D}{h}\\right) c_\\infty \\left(N(h) h^3\\right) = \\beta D c_\\infty N(h) h^2 $$\n这里，$D$是扩散系数，$\\beta$是无量纲常数，$c_\\infty$是体配体浓度，$h$是体素边长，$N(h)$是反应性体素的数量。\n\n连续Smoluchowski理论为半径为$a$的完美吸收体提供了参考稳态结合速率：\n$$ F_{\\mathrm{Smol}} = (4\\pi D a) c_\\infty $$\n离散化引起的相对误差$\\varepsilon(h)$，将RDME的预测与连续参考值进行比较：\n$$ \\varepsilon(h) = \\frac{F_{\\mathrm{RDME}}(h)}{F_{\\mathrm{Smol}}} - 1 $$\n代入$F_{\\mathrm{RDME}}(h)$和$F_{\\mathrm{Smol}}$的表达式：\n$$ \\varepsilon(h) = \\frac{\\beta D c_\\infty N(h) h^2}{4\\pi D a c_\\infty} - 1 $$\n扩散系数$D$和体浓度$c_\\infty$的项被消去。这极大地简化了误差的表达式，使其与这两个参数无关：\n$$ \\varepsilon(h) = \\frac{\\beta N(h) h^2}{4\\pi a} - 1 $$\n核心任务是计算$N(h)$，即中心落在半径为$a$的球形受体内的体素数量。一个中心位于$(ih, jh, kh)$的体素被计数，如果其中心到原点的距离小于或等于$a$：\n$$ \\sqrt{(ih)^2 + (jh)^2 + (kh)^2} \\le a $$\n这个不等式可以通过提出$h$并两边平方来简化：\n$$ i^2 + j^2 + k^2 \\le \\left(\\frac{a}{h}\\right)^2 $$\n为了找到$N(h)$，我们必须枚举并计数满足此条件的所有整数三元组$(i, j, k)$。整数$i, j, k$的搜索空间是有界的，因为$|i|$, $|j|$和$|k|$不能超过$R = a/h$。算法包括遍历以原点为中心、边长为$2 \\lfloor a/h \\rfloor$的立方体内的所有整数坐标$(i, j, k)$，并检查它们是否位于半径为$R = a/h$的球体内。\n\n问题指定的参数是：$a = 1\\,\\mu\\mathrm{m}$和$\\beta = 1$。对于我们的特定测试用例，误差公式变为：\n$$ \\varepsilon(h) = \\frac{N(h) h^2}{4\\pi} - 1 $$\n我们现在将此框架应用于体素大小$h$的四个测试用例。\n\n**情况 1: $h = 1.0\\,\\mu\\mathrm{m}$**\n比率$a/h = 1/1.0 = 1$。我们需要计数整数三元组$(i,j,k)$，使得$i^2+j^2+k^2 \\le 1^2 = 1$。\n满足此条件的三元组是：\n- $(0,0,0)$: 平方和为$0$。（1个点）\n- $(\\pm 1,0,0)$的排列：平方和为$1$。（6个点）\n总计数：$N(1.0) = 1 + 6 = 7$。\n误差是：\n$$ \\varepsilon(1.0) = \\frac{7 \\cdot (1.0)^2}{4\\pi} - 1 = \\frac{7}{4\\pi} - 1 \\approx 0.557324 - 1 = -0.442676 $$\n\n**情况 2: $h = 0.5\\,\\mu\\mathrm{m}$**\n比率$a/h = 1/0.5 = 2$。我们需要计数整数三元组$(i,j,k)$，使得$i^2+j^2+k^2 \\le 2^2 = 4$。\n整数的平方和小于等于$4$的有：\n- $0$: $(0,0,0)$（1个点）\n- $1$: $(\\pm 1,0,0)$的排列（6个点）\n- $2$: $(\\pm 1,\\pm 1,0)$的排列（12个点）\n- $3$: $(\\pm 1,\\pm 1,\\pm 1)$（8个点）\n- $4$: $(\\pm 2,0,0)$的排列（6个点）\n总计数：$N(0.5) = 1 + 6 + 12 + 8 + 6 = 33$。\n误差是：\n$$ \\varepsilon(0.5) = \\frac{33 \\cdot (0.5)^2}{4\\pi} - 1 = \\frac{33 \\cdot 0.25}{4\\pi} - 1 = \\frac{8.25}{4\\pi} - 1 \\approx 0.656514 - 1 = -0.343486 $$\n\n**情况 3: $h = 0.25\\,\\mu\\mathrm{m}$**\n比率$a/h = 1/0.25 = 4$。我们需要计数整数三元组$(i,j,k)$，使得$i^2+j^2+k^2 \\le 4^2 = 16$。\n通过计算枚举这些点，得到$N(0.25) = 257$。\n误差是：\n$$ \\varepsilon(0.25) = \\frac{257 \\cdot (0.25)^2}{4\\pi} - 1 = \\frac{257 \\cdot 0.0625}{4\\pi} - 1 = \\frac{16.0625}{4\\pi} - 1 \\approx 1.27830 - 1 = 0.27830 $$\n\n**情况 4: $h = 0.125\\,\\mu\\mathrm{m}$**\n比率$a/h = 1/0.125 = 8$。我们需要计数整数三元组$(i,j,k)$，使得$i^2+j^2+k^2 \\le 8^2 = 64$。\n通过计算枚举这些点，得到$N(0.125) = 2089$。\n误差是：\n$$ \\varepsilon(0.125) = \\frac{2089 \\cdot (0.125)^2}{4\\pi} - 1 = \\frac{2089 \\cdot 0.015625}{4\\pi} - 1 = \\frac{32.640625}{4\\pi} - 1 \\approx 2.59762 - 1 = 1.59762 $$\n\n结果展示了与直觉相反的行为。随着体素大小$h$从$1.0$减小到$0.125$，相对误差$\\varepsilon(h)$从大约$-0.44$增加到$+1.60$。这表明对于这个朴素模型，细化网格并不能提高准确性，反而导致预测速率偏离正确的连续极限。原因是错误指定的反应速率$\\lambda_v(h) = \\beta D/h$，当它与反应性体积$V_{\\mathrm{reactive}}(h) \\approx \\frac{4}{3}\\pi a^3$结合时，导致总结合速率$F_{\\mathrm{RDME}}(h)$渐进地按$1/h$缩放，从而在$h \\to 0$时导致发散。",
            "answer": "[-0.442676, -0.343486, 0.27830, 1.59762]"
        }
    ]
}