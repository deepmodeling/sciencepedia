{
    "hands_on_practices": [
        {
            "introduction": "在约束基础的代谢建模中，生物质目标函数是模拟细胞生长的核心。这个练习将带你从基本原理出发，亲手构建这样一个函数。通过运用生物化学和化学计量的基本原则，我们将把细胞的宏观分子组成（如蛋白质、RNA、DNA）及其合成的能量成本，转化为一个定量的、可在计算机上求解的目标。掌握这一过程，你将能够为不同的生物体或特定的生长条件创建或定制目标函数，这是进行有意义的代谢模拟的关键一步。",
            "id": "4333439",
            "problem": "在基于约束的建模和流通量平衡分析 (FBA) 中，一个核心实践是定义一个生物量目标函数，该函数汇总了生产新细胞物质所需的化学计量需求，包括大分子聚合和维持的能量成本。考虑一个原核细胞，使用一个生物量伪代谢物进行建模，其分子量设定为每毫摩尔生物量伪代谢物 $1$ 克。因此，生产 $1$ mmol 的生物量相当于形成 $1$ g 的干生物量。该生物量的大分子质量分数为：蛋白质 $= 0.55$，核糖核酸 (RNA) $= 0.20$，脱氧核糖核酸 (DNA) $= 0.03$。忽略其他生物量组分对聚合能的贡献。假设平均并入单体质量（即聚合状态下的平均残基质量）为：蛋白质中的氨基酸为 $110$ g mol$^{-1}$，RNA 中的核糖核苷酸为 $330$ g mol$^{-1}$，DNA 中的脱氧核糖核苷酸为 $330$ g mol$^{-1}$。假设聚合的能量成本，以每形成一个磷酸二酯键或肽键所水解的三磷酸腺苷 (ATP) 当量表示，为：蛋白质翻译成本 $= 4$ ATP 当量/肽键（考虑到氨酰-tRNA 的装载和由 ATP 再生的三磷酸鸟苷的使用），RNA 转录成本 $= 1$ ATP 当量/磷酸二酯键，以及 DNA 复制成本 $= 1$ ATP 当量/磷酸二酯键。假设为长聚合物，因此键的数量约等于并入的单体数量（忽略起始和终止的额外开销以及末端基团校正）。除了聚合成本外，还包括一个生长相关维持 (GAM) 能量，即每形成一克干生物量水解 $30$ mmol 的 ATP。\n\n从质量守恒和生物量反应中化学计量系数代表每形成一毫摩尔生物量所需各种物质的摩尔数的定义出发，推导在生物量反应消耗侧乘以 ATP 的总化学计量系数（即，每生产一毫摩尔生物量伪代谢物所水解的 ATP 的量值），包括聚合能和生长相关维持能量。请用单位 mmol ATP / mmol 生物量伪代谢物来表示您的最终答案。将您的答案四舍五入到四位有效数字。",
            "solution": "首先对问题的有效性进行评估。所有给定的数据、条件和假设逐条列出如下：\n已知条件：\n1.  生物量伪代谢物的分子量：$1$ g/mmol。这建立了生产 $1$ mmol 生物量相当于形成 $1$ g 干生物量的等价关系。\n2.  生物量的大分子质量分数 ($f$)：蛋白质 ($f_{prot}$) $= 0.55$，核糖核酸 (RNA, $f_{RNA}$) $= 0.20$，脱氧核糖核酸 (DNA, $f_{DNA}$) $= 0.03$。\n3.  忽略其他组分对聚合能的贡献。\n4.  平均并入单体质量 ($M$)：蛋白质中的氨基酸 ($M_{AA}$) $= 110$ g mol$^{-1}$，RNA 中的核糖核苷酸 ($M_{NTP}$) $= 330$ g mol$^{-1}$，DNA 中的脱氧核糖核苷酸 ($M_{dNTP}$) $= 330$ g mol$^{-1}$。\n5.  聚合的能量成本 ($C$)：蛋白质翻译 ($C_{prot}$) $= 4$ ATP 当量/肽键，RNA 转录 ($C_{RNA}$) $= 1$ ATP 当量/磷酸二酯键，DNA 复制 ($C_{DNA}$) $= 1$ ATP 当量/磷酸二酯键。\n6.  假设：对于长聚合物，键的数量约等于并入的单体数量。\n7.  生长相关维持 (GAM) 能量：每形成一克干生物量水解 $30$ mmol 的 ATP。\n\n有效性结论：\n该问题有科学依据，提法得当且客观。它基于细胞代谢的基于约束建模中使用的化学计量学和生物能量学的标准原理。所提供的质量分数、单体分子量和能量成本值为标准教科书中的近似值。该问题是自洽的，提供了计算唯一解所需的所有数据。术语精确且无歧义。因此，该问题被认为是有效的，并将推导其解。\n\n目标是计算 ATP 消耗的总化学计量系数，它代表每生产一摩尔生物量伪代谢物所水解的 ATP 的总摩尔数。在化学计量矩阵中，该系数的单位通常是 mmol/mmol。计算基于生产 $1$ g 干生物量，根据题目陈述，这等同于生产 $1$ mmol 的生物量伪代谢物。\n\n总 ATP 成本，记为 $C_{total}$，可以分解为两个部分：大分子聚合成本 $C_{poly}$ 和生长相关维持成本 $C_{GAM}$。\n$$C_{total} = C_{poly} + C_{GAM}$$\n聚合成本是生产生物量中蛋白质、RNA 和 DNA 组分的成本之和。\n$$C_{poly} = C_{poly, prot} + C_{poly, RNA} + C_{poly, DNA}$$\n\n我们将计算每克干生物量的各个组分成本。\n\n1.  蛋白质聚合成本 ($C_{poly, prot}$):\n    $1$ g 生物量中蛋白质的质量 $m_{prot}$ 由其质量分数给出：\n    $$m_{prot} = f_{prot} \\times 1 \\text{ g} = 0.55 \\text{ g}$$\n    并入的氨基酸 (AA) 单体的摩尔数通过将蛋白质的质量除以并入的氨基酸残基的平均摩尔质量 $M_{AA}$ 来计算：\n    $$n_{AA} = \\frac{m_{prot}}{M_{AA}} = \\frac{0.55 \\text{ g}}{110 \\text{ g mol}^{-1}} = 0.005 \\text{ mol}$$\n    为了统一使用 mmol 单位，我们转换该值：\n    $$n_{AA} = 0.005 \\text{ mol} \\times 1000 \\frac{\\text{mmol}}{\\text{mol}} = 5 \\text{ mmol}$$\n    在形成的肽键数量等于单体数量的假设下，蛋白质合成的总 ATP 成本为：\n    $$C_{poly, prot} = n_{AA} \\times C_{prot} = 5 \\text{ mmol} \\times 4 \\frac{\\text{mmol ATP}}{\\text{mmol bond}} = 20 \\text{ mmol ATP}$$\n    该成本是每形成一克生物量的成本。\n\n2.  RNA 聚合成本 ($C_{poly, RNA}$):\n    $1$ g 生物量中 RNA 的质量 $m_{RNA}$ 为：\n    $$m_{RNA} = f_{RNA} \\times 1 \\text{ g} = 0.20 \\text{ g}$$\n    核糖核苷酸 (NTP) 单体的摩尔数为：\n    $$n_{NTP} = \\frac{m_{RNA}}{M_{NTP}} = \\frac{0.20 \\text{ g}}{330 \\text{ g mol}^{-1}} = \\frac{0.20}{330} \\text{ mol}$$\n    转换为 mmol：\n    $$n_{NTP} = \\frac{0.20}{330} \\text{ mol} \\times 1000 \\frac{\\text{mmol}}{\\text{mol}} = \\frac{200}{330} \\text{ mmol} = \\frac{20}{33} \\text{ mmol}$$\n    磷酸二酯键的数量等于单体的数量。RNA 合成的 ATP 成本为：\n    $$C_{poly, RNA} = n_{NTP} \\times C_{RNA} = \\frac{20}{33} \\text{ mmol} \\times 1 \\frac{\\text{mmol ATP}}{\\text{mmol bond}} = \\frac{20}{33} \\text{ mmol ATP}$$\n    该成本是每形成一克生物量的成本。\n\n3.  DNA 聚合成本 ($C_{poly, DNA}$):\n    $1$ g 生物量中 DNA 的质量 $m_{DNA}$ 为：\n    $$m_{DNA} = f_{DNA} \\times 1 \\text{ g} = 0.03 \\text{ g}$$\n    脱氧核糖核苷酸 (dNTP) 单体的摩尔数为：\n    $$n_{dNTP} = \\frac{m_{DNA}}{M_{dNTP}} = \\frac{0.03 \\text{ g}}{330 \\text{ g mol}^{-1}} = \\frac{0.03}{330} \\text{ mol}$$\n    转换为 mmol：\n    $$n_{dNTP} = \\frac{0.03}{330} \\text{ mol} \\times 1000 \\frac{\\text{mmol}}{\\text{mol}} = \\frac{30}{330} \\text{ mmol} = \\frac{3}{33} \\text{ mmol}$$\n    DNA 合成的 ATP 成本为：\n    $$C_{poly, DNA} = n_{dNTP} \\times C_{DNA} = \\frac{3}{33} \\text{ mmol} \\times 1 \\frac{\\text{mmol ATP}}{\\text{mmol bond}} = \\frac{3}{33} \\text{ mmol ATP}$$\n    该成本是每形成一克生物量的成本。\n\n4.  总聚合成本 ($C_{poly}$):\n    总聚合成本是各项成本之和：\n    $$C_{poly} = C_{poly, prot} + C_{poly, RNA} + C_{poly, DNA} = \\left(20 + \\frac{20}{33} + \\frac{3}{33}\\right) \\text{ mmol ATP}$$\n    $$C_{poly} = \\left(20 + \\frac{23}{33}\\right) \\text{ mmol ATP / 克生物量}$$\n\n5.  生长相关维持 (GAM) 成本:\n    题目直接给出了这个值：\n    $$C_{GAM} = 30 \\text{ mmol ATP / 克生物量}$$\n\n6.  总 ATP 成本 ($C_{total}$):\n    总 ATP 成本是聚合成本和维持成本之和：\n    $$C_{total} = C_{poly} + C_{GAM} = \\left(20 + \\frac{23}{33}\\right) + 30 = \\left(50 + \\frac{23}{33}\\right) \\text{ mmol ATP / 克生物量}$$\n    现在，我们将其转换为数值：\n    $$\\frac{23}{33} \\approx 0.696969...$$\n    $$C_{total} \\approx 50 + 0.696969... = 50.696969... \\text{ mmol ATP / 克生物量}$$\n\n最后，我们将其表示为生物量反应中乘以 ATP 的化学计量系数。题目说明 $1$ mmol 的生物量质量为 $1$ g。因此，以 `mmol ATP / 克生物量` 为单位的成本在数值上与以 `mmol ATP / mmol 生物量` 为单位的成本相同。\n$$C_{total} = 50.696969... \\frac{\\text{mmol ATP}}{\\text{mmol biomass}}$$\n题目要求将答案四舍五入到四位有效数字。前四位有效数字是 $5$、$0$、$6$ 和 $9$。第五位数字是 $6$，所以我们向上取整。\n$$C_{total} \\approx 50.70 \\frac{\\text{mmol ATP}}{\\text{mmol biomass}}$$\n这个值代表了生物量生产伪反应中反应物侧 ATP 的化学计量系数的量值。",
            "answer": "$$\n\\boxed{50.70}\n$$"
        },
        {
            "introduction": "虽然最大化生长是一个常见且有力的假设，但细胞的“目标”并非一成不变，它们常常面临着基本的生存策略权衡。本练习将探讨其中一个最经典的困境：是快速（高代谢速率）还是高效（高底物产率）地产生能量？我们将使用通量平衡分析（FBA）在一个简化的代谢网络上，定量比较最大化绝对ATP生产速率和最大化每单位底物的ATP产率这两个不同目标所导致的代谢状态。通过这个练习，你将具体理解目标函数的选择如何决定了模型预测的代谢策略，例如在好氧呼吸和发酵之间的切换。",
            "id": "3910485",
            "problem": "一个细胞必须在两种备选途径中分配有限的资源，以从外部碳底物中生成三磷酸腺苷（ATP）。使用流平衡分析（FBA）的框架，定义两个细胞目标函数：最大化绝对ATP生产速率和最大化每单位底物的ATP产率。考虑一个简化的模型网络，该网络有一个单一的输入底物和两条不相交的ATP生成途径：一条有氧呼吸途径和一条无氧发酵途径。通量变量为：$v_{\\text{in}}$ 代表底物吸收，$v_{\\text{O}_2}$ 代表氧气吸收，$v_{\\text{R}}$ 代表底物的呼吸转换，$v_{\\text{F}}$ 代表底物的发酵转换。稳态约束强制要求 $v_{\\text{in}} = v_{\\text{R}} + v_{\\text{F}}$ 和 $v_{\\text{O}_2} = 6\\,v_{\\text{R}}$。呼吸途径每单位转换的底物产生 $30$ 个ATP，发酵途径每单位转换的底物产生 $2$ 个ATP。假设上限为 $v_{\\text{in}} \\leq V_{\\text{in}}^{\\max}$ 和 $v_{\\text{O}_2} \\leq V_{\\text{O}_2}^{\\max}$，其中 $V_{\\text{in}}^{\\max} = 60$ 且 $V_{\\text{O}_2}^{\\max} = 6$。一个单一的集总酶容量约束限制了总途径通量：$c_{\\text{R}}\\,v_{\\text{R}} + c_{\\text{F}}\\,v_{\\text{F}} \\leq E^{\\text{tot}}$，其中 $c_{\\text{R}} = 0.8$，$c_{\\text{F}} = 0.02$，且 $E^{\\text{tot}} = 1$。所有通量均为非负。\n\n将最大化绝对ATP生产的目标定义为在上述约束条件下最大化 $v_{\\text{ATP}} = 30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}$。将最大化每单位底物的ATP产率的目标定义为在相同约束条件下最大化 $Y_{\\text{ATP/S}} = \\dfrac{30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}}{v_{\\text{in}}}$。为了在相同的物理约束下对目标函数进行定量比较，请执行以下权衡计算：首先，求解绝对ATP最大化问题以获得 $v_{\\text{ATP}}^{\\max}$。其次，通过将 $Y_{\\text{ATP/S}}$ 约束为其最大可行值来强制执行产率最优的组合，然后在该组合约束下，最大化ATP生产速率以获得 $v_{\\text{ATP}}^{\\text{yield}}$。最后，以无量纲小数的形式报告权衡比率 $T = \\dfrac{v_{\\text{ATP}}^{\\text{yield}}}{v_{\\text{ATP}}^{\\max}}$。答案保留三位有效数字。",
            "solution": "已根据指定的验证标准对用户提供的问题陈述进行了分析。\n\n### 问题验证\n**第1步：提取已知条件**\n- 通量变量：$v_{\\text{in}}$（底物吸收），$v_{\\text{O}_2}$（氧气吸收），$v_{\\text{R}}$（呼吸通量），$v_{\\text{F}}$（发酵通量）。\n- 化学计量和稳态约束：\n  - $v_{\\text{in}} = v_{\\text{R}} + v_{\\text{F}}$\n  - $v_{\\text{O}_2} = 6\\,v_{\\text{R}}$\n- 资源约束：\n  - 底物吸收：$v_{\\text{in}} \\leq V_{\\text{in}}^{\\max} = 60$\n  - 氧气吸收：$v_{\\text{O}_2} \\leq V_{\\text{O}_2}^{\\max} = 6$\n  - 酶容量：$c_{\\text{R}}\\,v_{\\text{R}} + c_{\\text{F}}\\,v_{\\text{F}} \\leq E^{\\text{tot}}$，其中 $c_{\\text{R}} = 0.8$，$c_{\\text{F}} = 0.02$，且 $E^{\\text{tot}} = 1$。\n- 通量的非负性：$v_{\\text{in}} \\geq 0$, $v_{\\text{O}_2} \\geq 0$, $v_{\\text{R}} \\geq 0$, $v_{\\text{F}} \\geq 0$。\n- ATP生产速率：\n  - 呼吸途径：每单位底物 $30$ ATP。\n  - 发酵途径：每单位底物 $2$ ATP。\n- 目标函数：\n  - 绝对ATP生产速率：$v_{\\text{ATP}} = 30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}$\n  - 每单位底物的ATP产率：$Y_{\\text{ATP/S}} = \\dfrac{30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}}{v_{\\text{in}}}$\n- 任务：计算权衡比率 $T = \\dfrac{v_{\\text{ATP}}^{\\text{yield}}}{v_{\\text{ATP}}^{\\max}}$，其中 $v_{\\text{ATP}}^{\\max}$ 是最大化 $v_{\\text{ATP}}$ 的解，而 $v_{\\text{ATP}}^{\\text{yield}}$ 是在 $Y_{\\text{ATP/S}}$ 处于其自身最大可行值的约束下最大化 $v_{\\text{ATP}}$ 的解。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，使用了流平衡分析中一个简化但标准的模型。问题陈述清晰，定义了一系列具有线性约束的可解优化问题。语言客观，所有必要信息均已提供且内部一致。该问题未违反任何无效性标准。\n\n**第3步：结论与行动**\n该问题被判定为**有效**。将提供完整解答。\n\n### 解答\n该问题需要求解一系列优化问题。我们可以通过将所有约束用独立通量 $v_{\\text{R}}$ 和 $v_{\\text{F}}$ 表示来简化系统。\n\n给定的约束条件是：\n1. $v_{\\text{in}} = v_{\\text{R}} + v_{\\text{F}} \\leq 60$\n2. $v_{\\text{O}_2} = 6\\,v_{\\text{R}} \\leq 6 \\implies v_{\\text{R}} \\leq 1$\n3. $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} \\leq 1$\n4. $v_{\\text{R}} \\geq 0$, $v_{\\text{F}} \\geq 0$\n\n注意，第一个约束条件 $v_{\\text{R}} + v_{\\text{F}} \\leq 60$ 是多余的。从约束条件3可得，$0.02\\,v_{\\text{F}} \\leq 1 - 0.8\\,v_{\\text{R}}$。由于 $v_{\\text{R}} \\geq 0$，右侧最多为 $1$，因此 $0.02\\,v_{\\text{F}} \\leq 1$，这意味着 $v_{\\text{F}} \\leq 50$。结合 $v_{\\text{R}} \\leq 1$，我们有 $v_{\\text{R}} + v_{\\text{F}} \\leq 1 + 50 = 51$，这小于 $60$。因此，$(v_{\\text{R}}, v_{\\text{F}})$ 的可行域由 $v_{\\text{R}} \\geq 0$，$v_{\\text{F}} \\geq 0$，$v_{\\text{R}} \\leq 1$ 和 $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} \\leq 1$ 定义。\n\n**第1部分：最大化绝对ATP生产速率 ($v_{\\text{ATP}}^{\\max}$)**\n我们必须在可行域上最大化目标函数 $v_{\\text{ATP}} = 30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}$。由于这是一个线性规划问题，最大值将出现在可行域的某个顶点上。由 $v_{\\text{R}} \\geq 0$，$v_{\\text{F}} \\geq 0$，$v_{\\text{R}} \\leq 1$ 和 $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} \\leq 1$ 定义的区域的顶点是：\n- $v_{\\text{R}}=0$ 和 $v_{\\text{F}}=0$ 的交点：$(0, 0)$。\n- $v_{\\text{F}}=0$ 和 $v_{\\text{R}}=1$ 的交点：$(1, 0)$。这满足 $0.8(1) + 0.02(0) = 0.8 \\leq 1$。\n- $v_{\\text{R}}=0$ 和 $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} = 1$ 的交点：这得到 $0.02\\,v_{\\text{F}} = 1$，所以 $v_{\\text{F}}=50$。顶点是 $(0, 50)$。这满足 $v_{\\text{R}} \\leq 1$。\n- $v_{\\text{R}}=1$ 和 $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} = 1$ 的交点：这得到 $0.8(1) + 0.02\\,v_{\\text{F}} = 1$，所以 $0.02\\,v_{\\text{F}} = 0.2$，这意味着 $v_{\\text{F}}=10$。顶点是 $(1, 10)$。\n\n我们在每个顶点上计算 $v_{\\text{ATP}}$ 的值：\n- 在 $(0, 0)$：$v_{\\text{ATP}} = 30(0) + 2(0) = 0$。\n- 在 $(1, 0)$：$v_{\\text{ATP}} = 30(1) + 2(0) = 30$。\n- 在 $(0, 50)$：$v_{\\text{ATP}} = 30(0) + 2(50) = 100$。\n- 在 $(1, 10)$：$v_{\\text{ATP}} = 30(1) + 2(10) = 30 + 20 = 50$。\n\n最大值为 $100$。因此，$v_{\\text{ATP}}^{\\max} = 100$。\n\n**第2部分：最大化每单位底物的ATP产率 ($Y_{\\text{ATP/S}}$)**\n接下来，我们最大化产率函数 $Y_{\\text{ATP/S}} = \\dfrac{30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}}{v_{\\text{in}}}$。代入 $v_{\\text{in}} = v_{\\text{R}} + v_{\\text{F}}$，我们得到：\n$$Y_{\\text{ATP/S}} = \\frac{30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}}{v_{\\text{R}} + v_{\\text{F}}}$$\n该函数代表单个产率 $30$ 和 $2$ 的加权平均值。令 $x = \\frac{v_{\\text{R}}}{v_{\\text{R}} + v_{\\text{F}}}$ 为导向呼吸作用的底物比例。则 $Y_{\\text{ATP/S}} = 30x + 2(1-x) = 28x + 2$。为了最大化 $Y_{\\text{ATP/S}}$，我们必须最大化 $x$。这对应于最大化呼吸通量与总通量的比率，这可以通过使通量完全为呼吸通量（$v_{\\text{F}}=0$）来实现。\n我们必须检查纯呼吸通量（$v_{\\text{F}}=0$ 且 $v_{\\text{R}}0$）是否可行。约束条件变为 $0  v_{\\text{R}} \\leq 1$ 和 $0.8\\,v_{\\text{R}} \\leq 1$（即 $v_{\\text{R}} \\leq 1.25$）。对于任何 $v_{\\text{R}} \\in (0, 1]$，都存在可行解。\n对于任何 $v_{\\text{F}}=0$ 的点，产率为 $Y_{\\text{ATP/S}} = \\frac{30\\,v_{\\text{R}}}{v_{\\text{R}}} = 30$。\n因此，产率的最大可行值为 $30$，而“产率最优组合”是任何 $v_{\\text{F}}=0$ 的状态。\n\n**第3部分：计算 $v_{\\text{ATP}}^{\\text{yield}}$**\n我们现在求解在强制执行产率最优组合（即 $v_{\\text{F}}=0$）的约束条件下，ATP的最大生产速率。新的优化问题是：\n最大化 $v_{\\text{ATP}} = 30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}$\n约束条件：\n1. $v_{\\text{R}} \\leq 1$\n2. $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} \\leq 1$\n3. $v_{\\text{F}} = 0$\n4. $v_{\\text{R}} \\geq 0$\n\n将 $v_{\\text{F}}=0$ 代入目标函数和约束条件，得到：\n最大化 $30\\,v_{\\text{R}}$\n约束条件：$v_{\\text{R}} \\leq 1$，$0.8\\,v_{\\text{R}} \\leq 1$（或 $v_{\\text{R}} \\leq 1.25$），以及 $v_{\\text{R}} \\geq 0$。\n$v_{\\text{R}}$ 上的组合约束是 $0 \\leq v_{\\text{R}} \\leq \\min(1, 1.25) = 1$。\n为了最大化 $30\\,v_{\\text{R}}$，我们必须选择 $v_{\\text{R}}$ 的最大可能值，即 $v_{\\text{R}}=1$。\n得到的最大ATP生产速率是 $30(1) = 30$。\n因此，$v_{\\text{ATP}}^{\\text{yield}} = 30$。\n\n**第4部分：计算权衡比率 ($T$)**\n权衡比率 $T$ 是在产率最优策略下的ATP生产速率与绝对最大ATP生产速率之比。\n$$T = \\frac{v_{\\text{ATP}}^{\\text{yield}}}{v_{\\text{ATP}}^{\\max}} = \\frac{30}{100} = 0.3$$\n问题要求答案四舍五入到三位有效数字。\n$T = 0.300$。",
            "answer": "$$\\boxed{0.300}$$"
        },
        {
            "introduction": "在应用通量平衡分析时，一个常见的挑战是最大化主目标（如生长速率）可能会得到多个等效的最优通量分布，这种现象被称为简并性（degeneracy）。这种解的不唯一性会给结果的生理学解释带来困难。为了解决这个问题，我们可以引入一个具有生物学意义的次级目标来从众多最优解中挑选出唯一的、最合理的解。本练习将引导你实施“字典序优化”（lexicographic optimization），首先最大化生长速率，然后在一个简化的网络上最小化总通量消耗或加权的酶使用成本，从而获得唯一的通量分布。这个实践将为你介绍一种增强FBA模型预测鲁棒性和生理学相关性的强大技术。",
            "id": "3910497",
            "problem": "考虑稳态下单细胞代谢网络的通量平衡分析（FBA）的规范表述。其基础包括化学计量稳态约束 $S \\, \\mathbf{v} = \\mathbf{0}$、反应不可逆性和容量边界 $ \\mathbf{l} \\le \\mathbf{v} \\le \\mathbf{u}$，以及一个待最大化的细胞目标函数。在本问题中，分析一个在主目标下表现出多重最优解的最小网络，然后通过引入有科学动机的次级目标来解决简并性问题。\n\n该网络包含四个反应，其通量为 $\\mathbf{v} = [v_{1}, v_{2}, v_{3}, v_{B}]^{\\top}$：\n- $v_{1}$：从细胞外空间摄取葡萄糖，\n- $v_{2}$：内部途径 A，将细胞内葡萄糖转化为生物质，\n- $v_{3}$：内部途径 B，将细胞内葡萄糖转化为生物质，\n- $v_{B}$：生物质排出（生长速率）。\n\n有两个内部代谢物：细胞内葡萄糖和生物质。化学计量矩阵 $S$（行对应代谢物，列按 $v_{1}, v_{2}, v_{3}, v_{B}$ 的顺序列出反应）为\n$$\nS \\;=\\;\n\\begin{pmatrix}\n1  -1  -1  0 \\\\\n0  1  1  -1\n\\end{pmatrix}.\n$$\n因此，稳态质量平衡约束为\n$$\nv_{1} - v_{2} - v_{3} = 0, \\qquad v_{2} + v_{3} - v_{B} = 0.\n$$\n假设所有反应都是不可逆的，且边界为\n$$\n0 \\le v_{i}, \\quad i \\in \\{1,2,3,B\\}, \\qquad v_{1} \\le 10.\n$$\n\n主目标：最大化生长速率 $v_{B}$。\n\n任务：\n1. 从基本的 FBA 基础（$S\\,\\mathbf{v}=\\mathbf{0}$ 及上述边界）出发，确定主目标的最优解集，并明确证明最优解是简并的。\n2. 使用有科学动机的次级目标，提出字典序决胜规则。具体来说，分析通常建议的次级目标“最小化总通量”，并确定它是否解决了该网络的简并性问题。然后，基于最小化途径通量平方的加权和，以反映不同的酶使用成本，提出一个次级目标。设途径 A 的权重为 $w_{2} = 2$，途径 B 的权重为 $w_{3} = 1$，并在满足任务 1 中找到的最大 $v_{B}$ 以及稳态约束和不可逆性边界的条件下，最小化\n$$\nJ(v_{2}, v_{3}) \\;=\\; w_{2}\\, v_{2}^{2} \\;+\\; w_{3}\\, v_{3}^{2}\n$$\n3. 计算通过字典序优化得到的唯一通量向量 $\\mathbf{v}^{\\star} = [v_{1}^{\\star}, v_{2}^{\\star}, v_{3}^{\\star}, v_{B}^{\\star}]$：首先最大化 $v_{B}$，然后按规定最小化 $J(v_{2}, v_{3})$。以行矩阵的形式，按 $[v_{1}, v_{2}, v_{3}, v_{B}]$ 的顺序表示你的最终答案，并使用单位毫摩尔每克干重每小时（mmol gDW$^{-1}$ h$^{-1}$）。无需四舍五入；提供精确值。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于通量平衡分析（FBA）的原理，在数学上是适定的、无歧义的且自洽的。所提供的化学计量矩阵、约束和目标是一致且充分的，足以通过指定的字典序优化过程推导出一个唯一的、有意义的解。\n\n按要求，问题分三部分解决。\n\n### 任务 1：主目标与简并性\n\n系统由化学计量稳态约束 $S \\, \\mathbf{v} = \\mathbf{0}$ 控制，其中化学计量矩阵为\n$$\nS = \\begin{pmatrix} 1  -1  -1  0 \\\\ 0  1  1  -1 \\end{pmatrix}\n$$\n通量向量为 $\\mathbf{v} = [v_{1}, v_{2}, v_{3}, v_{B}]^{\\top}$。该矩阵方程产生两个线性方程：\n1.  $v_{1} - v_{2} - v_{3} = 0$\n2.  $v_{2} + v_{3} - v_{B} = 0$\n\n由方程（1），我们有 $v_{1} = v_{2} + v_{3}$。\n由方程（2），我们有 $v_{B} = v_{2} + v_{3}$。\n结合这两个结果，我们发现葡萄糖摄取通量 $v_{1}$ 和生物质产生通量（生长速率）$v_{B}$ 之间存在直接关系：\n$$\nv_{B} = v_{1}\n$$\n主目标是最大化生长速率 $v_{B}$。由于 $v_{B} = v_{1}$，这等同于最大化葡萄糖摄取通量 $v_{1}$。问题给出了通量边界 $0 \\le v_{i}$（对于 $i \\in \\{1,2,3,B\\}$）以及葡萄糖摄取的上界 $v_{1} \\le 10$。\n\n因此，$v_{1}$ 的最大可能值为 $10$，这反过来给出了最大生长速率：\n$$\nv_{B, \\text{max}} = v_{1, \\text{max}} = 10\n$$\n任何最优解都必须满足 $v_{B} = 10$ 和 $v_{1} = 10$。将这些值代回稳态方程，我们得到：\n$$\nv_{2} + v_{3} = v_{1} = 10\n$$\n问题还要求所有通量都为非负，所以 $v_{2} \\ge 0$ 且 $v_{3} \\ge 0$。\n\n最优解集是满足这些条件的所有通量向量 $\\mathbf{v} = [v_{1}, v_{2}, v_{3}, v_{B}]^{\\top}$ 的集合。具体来说，任何形式为\n$$\n\\mathbf{v}_{\\text{opt}} = \\begin{pmatrix} 10 \\\\ v_{2} \\\\ v_{3} \\\\ 10 \\end{pmatrix}\n$$\n的向量，其中 $v_{2} + v_{3} = 10$ 且 $v_{2}, v_{3} \\ge 0$，都是最优解。我们可以通过令 $v_{2} = \\alpha$ 来参数化这个集合。那么 $v_{3} = 10 - \\alpha$，非负性约束要求 $0 \\le \\alpha \\le 10$。因此，最优解集为\n$$\n\\left\\{ \\begin{pmatrix} 10 \\\\ \\alpha \\\\ 10 - \\alpha \\\\ 10 \\end{pmatrix} \\;\\Bigg|\\; \\alpha \\in [0, 10] \\right\\}\n$$\n由于 $\\alpha$ 可以在连续区间 $[0, 10]$ 内取任何实数值，因此存在无限多个最优通量分布。这明确地证明了主最优解是简并的。\n\n### 任务 2：字典序决胜\n\n为了解决这种简并性，我们以字典序方式引入次级目标。这涉及到在主目标的最优解集上优化一个新的目标函数。\n\n**次级目标 1：最小化总通量**\n\n一个常见的次级目标是最小化所有代谢通量的总和，这通常被解释为代谢效率的原则。总通量为 $F_{\\text{total}} = \\sum_{i} |v_i|$。由于所有通量都是非负的，所以总通量为 $F_{\\text{total}} = v_{1} + v_{2} + v_{3} + v_{B}$。\n\n对于任务 1 中找到的简并最优集中的任何解，我们有 $v_{1} = 10$，$v_{B} = 10$ 和 $v_{2} + v_{3} = 10$。将这些值代入总通量的表达式中：\n$$\nF_{\\text{total}} = 10 + (v_{2} + v_{3}) + 10 = 10 + 10 + 10 = 30\n$$\n在主最优集中的所有解中，总通量都是一个常数（$30$）。因此，最小化总通量并不会对 $v_{2}$ 和 $v_{3}$ 的值施加任何新的约束，也无法解决简并性问题。\n\n**次级目标 2：最小化通量平方的加权和**\n\n可以根据酶成本制定一个更敏感的次级目标，其中成本被假定为其所承载通量的非线性函数。我们被要求最小化目标函数\n$$\nJ(v_{2}, v_{3}) = w_{2}\\, v_{2}^{2} + w_{3}\\, v_{3}^{2}\n$$\n其中权重为 $w_{2} = 2$ 和 $w_{3} = 1$。最小化是在主最优解集上进行的。此优化问题的约束条件是：\n1. $v_{2} + v_{3} = 10$\n2. $v_{2} \\ge 0$\n3. $v_{3} \\ge 0$\n\n我们可以通过从第一个约束中代入 $v_{3} = 10 - v_{2}$，将 $J$ 表示为单个变量（例如 $v_{2}$）的函数。$v_{2}$ 的定义域是 $[0, 10]$。\n$$\nJ(v_{2}) = 2 v_{2}^{2} + 1 (10 - v_{2})^{2}\n$$\n展开此表达式可得：\n$$\nJ(v_{2}) = 2 v_{2}^{2} + (100 - 20v_{2} + v_{2}^{2}) = 3 v_{2}^{2} - 20v_{2} + 100\n$$\n这是一个关于 $v_{2}$ 的二次函数，表示一个开口向上的抛物线。其最小值可以通过将其关于 $v_{2}$ 的导数设为零来找到。\n$$\n\\frac{dJ}{dv_{2}} = 6 v_{2} - 20\n$$\n将导数设为 $0$：\n$$\n6 v_{2} - 20 = 0 \\quad \\implies \\quad v_{2} = \\frac{20}{6} = \\frac{10}{3}\n$$\n二阶导数为 $\\frac{d^{2}J}{dv_{2}^{2}} = 6  0$，证实了这是一个最小值。值 $v_{2} = \\frac{10}{3}$ 在可行区间 $[0, 10]$ 内。因此，这是使 $J$ 最小化的唯一 $v_{2}$ 值。\n\n### 任务 3：唯一最优通量向量\n\n利用次级优化的结果，我们可以确定唯一的通量分布 $\\mathbf{v}^{\\star}$。通量的单位为 mmol gDW$^{-1}$ h$^{-1}$。\n$v_{2}$ 的最优值为：\n$$\nv_{2}^{\\star} = \\frac{10}{3}\n$$\n我们现在可以计算其他通量：\n途径 B 的通量 $v_{3}$ 由约束 $v_{2} + v_{3} = 10$ 确定：\n$$\nv_{3}^{\\star} = 10 - v_{2}^{\\star} = 10 - \\frac{10}{3} = \\frac{30 - 10}{3} = \\frac{20}{3}\n$$\n葡萄糖摄取和生物质生产的通量由主目标固定：\n$$\nv_{1}^{\\star} = 10\n$$\n$$\nv_{B}^{\\star} = 10\n$$\n由字典序优化得到的唯一通量向量是 $\\mathbf{v}^{\\star} = [v_{1}^{\\star}, v_{2}^{\\star}, v_{3}^{\\star}, v_{B}^{\\star}]^{\\top}$。代入计算出的值：\n$$\n\\mathbf{v}^{\\star} = \\begin{pmatrix} 10 \\\\ \\frac{10}{3} \\\\ \\frac{20}{3} \\\\ 10 \\end{pmatrix}\n$$\n最终答案以行矩阵形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 10  \\frac{10}{3}  \\frac{20}{3}  10 \\end{pmatrix}}\n$$"
        }
    ]
}