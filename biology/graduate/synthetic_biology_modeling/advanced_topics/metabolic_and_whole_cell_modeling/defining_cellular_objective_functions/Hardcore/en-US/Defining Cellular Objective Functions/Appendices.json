{
    "hands_on_practices": [
        {
            "introduction": "The biomass objective function (BOF) is arguably the most critical component in flux balance analysis for predicting cellular growth. This exercise  demystifies the BOF by guiding you through its construction from first principles, based on measurable cellular properties. By calculating the energetic requirements for synthesizing macromolecules, you will gain a practical understanding of how a cell's composition and bioenergetic costs are translated into a quantitative objective for computational models.",
            "id": "4333439",
            "problem": "A central practice in constraint-based modeling and flux balance analysis (FBA) is to define a biomass objective function that aggregates the stoichiometric demands to produce new cellular material, including the energetic costs of macromolecular polymerization and maintenance. Consider a prokaryotic cell modeled with a biomass pseudo-metabolite whose molecular weight is set to $1$ g per mmol of biomass pseudo-metabolite. Thus, producing $1$ mmol of biomass corresponds to forming $1$ g of dry biomass. The macromolecular mass fractions of this biomass are: protein = 0.55, ribonucleic acid (RNA) = 0.20, deoxyribonucleic acid (DNA) = 0.03. Neglect the contributions of other biomass components to polymerization energy. Assume that the average incorporated monomer masses (that is, average residue mass in the polymerized state) are $110$ g mol$^{-1}$ for amino acids in protein, $330$ g mol$^{-1}$ for ribonucleotides in RNA, and $330$ g mol$^{-1}$ for deoxyribonucleotides in DNA. Assume that the energetic costs of polymerization, expressed in adenosine triphosphate (ATP) equivalents hydrolyzed per phosphodiester or peptide bond formed, are: protein translation cost = 4 ATP equivalents per peptide bond (accounting for aminoacyl-transfer RNA charging and guanosine triphosphate usage recharged from ATP), RNA transcription cost = 1 ATP equivalent per phosphodiester bond, and DNA replication cost = 1 ATP equivalent per phosphodiester bond. Assume long polymers so that the number of bonds approximately equals the number of incorporated monomers (ignore initiation and termination overheads and end-group corrections). In addition to polymerization costs, include a growth-associated maintenance (GAM) energy of $30$ mmol of ATP hydrolyzed per gram of dry biomass formed.\n\nStarting from mass conservation and the definition that stoichiometric coefficients in the biomass reaction represent the moles of each requirement per mmol of biomass formed, derive the total stoichiometric coefficient multiplying ATP on the consumption side of the biomass reaction (that is, the magnitude of ATP hydrolyzed per mmol of biomass pseudo-metabolite produced), including both polymerization energy and the growth-associated maintenance energy. Express your final answer in mmol of ATP per mmol of biomass pseudo-metabolite. Round your answer to four significant figures.",
            "solution": "The problem is first assessed for validity. All provided data, conditions, and assumptions are listed verbatim:\nGivens:\n1.  Molecular weight of biomass pseudo-metabolite: $1$ g per mmol. This establishes the equivalence that the production of $1$ mmol of biomass corresponds to the formation of $1$ g of dry biomass.\n2.  Macromolecular mass fractions ($f$) of biomass: protein ($f_{prot}$) $= 0.55$, ribonucleic acid (RNA, $f_{RNA}$) $= 0.20$, deoxyribonucleic acid (DNA, $f_{DNA}$) $= 0.03$.\n3.  Polymerization energy contributions from other components are neglected.\n4.  Average incorporated monomer masses ($M$): amino acids in protein ($M_{AA}$) $= 110$ g mol$^{-1}$, ribonucleotides in RNA ($M_{NTP}$) $= 330$ g mol$^{-1}$, deoxyribonucleotides in DNA ($M_{dNTP}$) $= 330$ g mol$^{-1}$.\n5.  Energetic costs of polymerization ($C$): protein translation ($C_{prot}$) $= 4$ ATP equivalents per peptide bond, RNA transcription ($C_{RNA}$) $= 1$ ATP equivalent per phosphodiester bond, DNA replication ($C_{DNA}$) $= 1$ ATP equivalent per phosphodiester bond.\n6.  Assumption: For long polymers, the number of bonds is approximately equal to the number of incorporated monomers.\n7.  Growth-Associated Maintenance (GAM) energy: $30$ mmol of ATP hydrolyzed per gram of dry biomass formed.\n\nValidation Verdict:\nThe problem is scientifically grounded, well-posed, and objective. It is based on standard principles of stoichiometry and bioenergetics used in constraint-based modeling of cellular metabolism. The provided values for mass fractions, monomer molecular weights, and energy costs are standard textbook approximations. The problem is self-contained, with all necessary data provided to compute a unique solution. The terminology is precise and unambiguous. Therefore, the problem is deemed valid and a solution will be derived.\n\nThe objective is to calculate the total stoichiometric coefficient for ATP consumption, which represents the total moles of ATP hydrolyzed per mole of biomass pseudo-metabolite produced. The units for this coefficient in a stoichiometric matrix are typically mmol/mmol. The calculation is performed on the basis of producing $1$ g of dry biomass, which, according to the problem statement, is equivalent to producing $1$ mmol of the biomass pseudo-metabolite.\n\nThe total ATP cost, denoted $C_{total}$, can be decomposed into two components: the cost of macromolecular polymerization, $C_{poly}$, and the growth-associated maintenance cost, $C_{GAM}$.\n$$C_{total} = C_{poly} + C_{GAM}$$\nThe polymerization cost is the sum of the costs for producing the protein, RNA, and DNA components of the biomass.\n$$C_{poly} = C_{poly, prot} + C_{poly, RNA} + C_{poly, DNA}$$\n\nWe will calculate each component per gram of dry biomass.\n\n1.  Protein Polymerization Cost ($C_{poly, prot}$):\n    The mass of protein, $m_{prot}$, in $1$ g of biomass is given by its mass fraction:\n    $$m_{prot} = f_{prot} \\times 1 \\text{ g} = 0.55 \\text{ g}$$\n    The number of moles of amino acid (AA) monomers incorporated is found by dividing the mass of the protein by the average molar mass of an incorporated amino acid residue, $M_{AA}$:\n    $$n_{AA} = \\frac{m_{prot}}{M_{AA}} = \\frac{0.55 \\text{ g}}{110 \\text{ g mol}^{-1}} = 0.005 \\text{ mol}$$\n    To work with mmol consistently, we convert this value:\n    $$n_{AA} = 0.005 \\text{ mol} \\times 1000 \\frac{\\text{mmol}}{\\text{mol}} = 5 \\text{ mmol}$$\n    Under the assumption that the number of peptide bonds formed is equal to the number of monomers, the total ATP cost for protein synthesis is:\n    $$C_{poly, prot} = n_{AA} \\times C_{prot} = 5 \\text{ mmol} \\times 4 \\frac{\\text{mmol ATP}}{\\text{mmol bond}} = 20 \\text{ mmol ATP}$$\n    This cost is per gram of biomass formed.\n\n2.  RNA Polymerization Cost ($C_{poly, RNA}$):\n    The mass of RNA, $m_{RNA}$, in $1$ g of biomass is:\n    $$m_{RNA} = f_{RNA} \\times 1 \\text{ g} = 0.20 \\text{ g}$$\n    The number of moles of ribonucleotide (NTP) monomers is:\n    $$n_{NTP} = \\frac{m_{RNA}}{M_{NTP}} = \\frac{0.20 \\text{ g}}{330 \\text{ g mol}^{-1}} = \\frac{0.20}{330} \\text{ mol}$$\n    Converting to mmol:\n    $$n_{NTP} = \\frac{0.20}{330} \\text{ mol} \\times 1000 \\frac{\\text{mmol}}{\\text{mol}} = \\frac{200}{330} \\text{ mmol} = \\frac{20}{33} \\text{ mmol}$$\n    The number of phosphodiester bonds equals the number of monomers. The ATP cost for RNA synthesis is:\n    $$C_{poly, RNA} = n_{NTP} \\times C_{RNA} = \\frac{20}{33} \\text{ mmol} \\times 1 \\frac{\\text{mmol ATP}}{\\text{mmol bond}} = \\frac{20}{33} \\text{ mmol ATP}$$\n    This cost is per gram of biomass formed.\n\n3.  DNA Polymerization Cost ($C_{poly, DNA}$):\n    The mass of DNA, $m_{DNA}$, in $1$ g of biomass is:\n    $$m_{DNA} = f_{DNA} \\times 1 \\text{ g} = 0.03 \\text{ g}$$\n    The number of moles of deoxyribonucleotide (dNTP) monomers is:\n    $$n_{dNTP} = \\frac{m_{DNA}}{M_{dNTP}} = \\frac{0.03 \\text{ g}}{330 \\text{ g mol}^{-1}} = \\frac{0.03}{330} \\text{ mol}$$\n    Converting to mmol:\n    $$n_{dNTP} = \\frac{0.03}{330} \\text{ mol} \\times 1000 \\frac{\\text{mmol}}{\\text{mol}} = \\frac{30}{330} \\text{ mmol} = \\frac{3}{33} \\text{ mmol}$$\n    The ATP cost for DNA synthesis is:\n    $$C_{poly, DNA} = n_{dNTP} \\times C_{DNA} = \\frac{3}{33} \\text{ mmol} \\times 1 \\frac{\\text{mmol ATP}}{\\text{mmol bond}} = \\frac{3}{33} \\text{ mmol ATP}$$\n    This cost is per gram of biomass formed.\n\n4.  Total Polymerization Cost ($C_{poly}$):\n    The total polymerization cost is the sum of the individual costs:\n    $$C_{poly} = C_{poly, prot} + C_{poly, RNA} + C_{poly, DNA} = \\left(20 + \\frac{20}{33} + \\frac{3}{33}\\right) \\text{ mmol ATP}$$\n    $$C_{poly} = \\left(20 + \\frac{23}{33}\\right) \\text{ mmol ATP per gram of biomass}$$\n\n5.  Growth-Associated Maintenance (GAM) Cost:\n    The problem provides this value directly:\n    $$C_{GAM} = 30 \\text{ mmol ATP per gram of biomass}$$\n\n6.  Total ATP Cost ($C_{total}$):\n    The total ATP cost is the sum of the polymerization and maintenance costs:\n    $$C_{total} = C_{poly} + C_{GAM} = \\left(20 + \\frac{23}{33}\\right) + 30 = \\left(50 + \\frac{23}{33}\\right) \\text{ mmol ATP per gram of biomass}$$\n    Now, we convert this to a numerical value:\n    $$\\frac{23}{33} \\approx 0.696969...$$\n    $$C_{total} \\approx 50 + 0.696969... = 50.696969... \\text{ mmol ATP per gram of biomass}$$\n\nFinally, we express this as the stoichiometric coefficient multiplying ATP in the biomass reaction. The problem states that $1$ mmol of biomass has a mass of $1$ g. Therefore, the cost in `mmol ATP per gram of biomass` is numerically identical to the cost in `mmol ATP per mmol of biomass`.\n$$C_{total} = 50.696969... \\frac{\\text{mmol ATP}}{\\text{mmol biomass}}$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $5$, $0$, $6$, and $9$. The fifth digit is $6$, so we round up.\n$$C_{total} \\approx 50.70 \\frac{\\text{mmol ATP}}{\\text{mmol biomass}}$$\nThis value represents the magnitude of the stoichiometric coefficient for ATP on the reactant side of the biomass production pseudo-reaction.",
            "answer": "$$\\boxed{50.70}$$"
        },
        {
            "introduction": "Cells often face a fundamental trade-off between the efficiency and the speed of resource conversion, a choice that dictates metabolic strategy. This practice  explores this classic dilemma by modeling the allocation of resources between a high-yield respiratory pathway and a high-rate fermentative pathway. You will define and apply two distinct objective functions—maximizing total ATP production versus maximizing ATP yield per substrate—to quantitatively assess the metabolic consequences of each strategy.",
            "id": "3910485",
            "problem": "A cell must allocate limited resources across two alternate pathways to generate Adenosine Triphosphate (ATP) from an external carbon substrate. Using the framework of Flux Balance Analysis (FBA), define two cellular objective functions: maximizing absolute ATP production rate and maximizing ATP yield per substrate. Consider a toy network with a single imported substrate and two disjoint ATP-generating routes: an aerobic respiratory route and an anaerobic fermentative route. The flux variables are $v_{\\text{in}}$ for substrate uptake, $v_{\\text{O}_2}$ for oxygen uptake, $v_{\\text{R}}$ for respiratory conversion of substrate, and $v_{\\text{F}}$ for fermentative conversion of substrate. Steady-state constraints enforce $v_{\\text{in}} = v_{\\text{R}} + v_{\\text{F}}$ and $v_{\\text{O}_2} = 6\\,v_{\\text{R}}$. The respiratory route yields $30$ ATP per unit of substrate converted, and the fermentative route yields $2$ ATP per unit of substrate converted. Assume upper bounds $v_{\\text{in}} \\leq V_{\\text{in}}^{\\max}$ and $v_{\\text{O}_2} \\leq V_{\\text{O}_2}^{\\max}$ with $V_{\\text{in}}^{\\max} = 60$ and $V_{\\text{O}_2}^{\\max} = 6$. A single lumped enzyme-capacity constraint limits the total pathway throughput: $c_{\\text{R}}\\,v_{\\text{R}} + c_{\\text{F}}\\,v_{\\text{F}} \\leq E^{\\text{tot}}$, where $c_{\\text{R}} = 0.8$, $c_{\\text{F}} = 0.02$, and $E^{\\text{tot}} = 1$. All fluxes are nonnegative.\n\nDefine the absolute ATP production objective as maximizing $v_{\\text{ATP}} = 30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}$ subject to the above constraints. Define the ATP yield per substrate objective as maximizing $Y_{\\text{ATP/S}} = \\dfrac{30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}}{v_{\\text{in}}}$ subject to the same constraints. For a quantitative comparison of objective functions under identical physical constraints, impose the following trade-off computation: first, solve the absolute ATP maximization to obtain $v_{\\text{ATP}}^{\\max}$. Second, enforce the yield-optimal composition by constraining $Y_{\\text{ATP/S}}$ to its maximal feasible value and then, under that composition constraint, maximize the ATP production rate to obtain $v_{\\text{ATP}}^{\\text{yield}}$. Finally, report the trade-off ratio $T = \\dfrac{v_{\\text{ATP}}^{\\text{yield}}}{v_{\\text{ATP}}^{\\max}}$ as a dimensionless decimal number. Round your answer to three significant figures.",
            "solution": "The user-provided problem statement has been analyzed according to the specified validation criteria.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- Flux variables: $v_{\\text{in}}$ (substrate uptake), $v_{\\text{O}_2}$ (oxygen uptake), $v_{\\text{R}}$ (respiratory flux), $v_{\\text{F}}$ (fermentative flux).\n- Stoichiometric and steady-state constraints:\n  - $v_{\\text{in}} = v_{\\text{R}} + v_{\\text{F}}$\n  - $v_{\\text{O}_2} = 6\\,v_{\\text{R}}$\n- Resource constraints:\n  - Substrate uptake: $v_{\\text{in}} \\leq V_{\\text{in}}^{\\max} = 60$\n  - Oxygen uptake: $v_{\\text{O}_2} \\leq V_{\\text{O}_2}^{\\max} = 6$\n  - Enzyme capacity: $c_{\\text{R}}\\,v_{\\text{R}} + c_{\\text{F}}\\,v_{\\text{F}} \\leq E^{\\text{tot}}$, with $c_{\\text{R}} = 0.8$, $c_{\\text{F}} = 0.02$, and $E^{\\text{tot}} = 1$.\n- Non-negativity of fluxes: $v_{\\text{in}} \\geq 0$, $v_{\\text{O}_2} \\geq 0$, $v_{\\text{R}} \\geq 0$, $v_{\\text{F}} \\geq 0$.\n- ATP production rates:\n  - Respiratory route: $30$ ATP per unit of substrate.\n  - Fermentative route: $2$ ATP per unit of substrate.\n- Objective functions:\n  - Absolute ATP production rate: $v_{\\text{ATP}} = 30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}$\n  - ATP yield per substrate: $Y_{\\text{ATP/S}} = \\dfrac{30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}}{v_{\\text{in}}}$\n- Task: Calculate the trade-off ratio $T = \\dfrac{v_{\\text{ATP}}^{\\text{yield}}}{v_{\\text{ATP}}^{\\max}}$, where $v_{\\text{ATP}}^{\\max}$ is the solution to maximizing $v_{\\text{ATP}}$, and $v_{\\text{ATP}}^{\\text{yield}}$ is the solution to maximizing $v_{\\text{ATP}}$ under the constraint that $Y_{\\text{ATP/S}}$ is at its own maximal feasible value.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, using a simplified but standard model from Flux Balance Analysis. It is well-posed, defining a series of solvable optimization problems with linear constraints. The language is objective and all necessary information is provided and is internally consistent. The problem does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution\nThe problem requires solving a sequence of optimization problems. We can simplify the system by expressing all constraints in terms of the independent fluxes $v_{\\text{R}}$ and $v_{\\text{F}}$.\n\nThe given constraints are:\n1. $v_{\\text{in}} = v_{\\text{R}} + v_{\\text{F}} \\leq 60$\n2. $v_{\\text{O}_2} = 6\\,v_{\\text{R}} \\leq 6 \\implies v_{\\text{R}} \\leq 1$\n3. $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} \\leq 1$\n4. $v_{\\text{R}} \\geq 0$, $v_{\\text{F}} \\geq 0$\n\nNote that the first constraint, $v_{\\text{R}} + v_{\\text{F}} \\leq 60$, is redundant. From constraint $3$, $0.02\\,v_{\\text{F}} \\leq 1 - 0.8\\,v_{\\text{R}}$. Since $v_{\\text{R}} \\geq 0$, the right-hand side is at most $1$, so $0.02\\,v_{\\text{F}} \\leq 1$, which implies $v_{\\text{F}} \\leq 50$. Combined with $v_{\\text{R}} \\leq 1$, we have $v_{\\text{R}} + v_{\\text{F}} \\leq 1 + 50 = 51$, which is less than $60$. Thus, the feasible region for $(v_{\\text{R}}, v_{\\text{F}})$ is defined by $v_{\\text{R}} \\geq 0$, $v_{\\text{F}} \\geq 0$, $v_{\\text{R}} \\leq 1$, and $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} \\leq 1$.\n\n**Part 1: Maximizing Absolute ATP Production Rate ($v_{\\text{ATP}}^{\\max}$)**\nWe must maximize the objective function $v_{\\text{ATP}} = 30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}$ over the feasible region. As this is a linear program, the maximum will occur at a vertex of the feasible region. The vertices of the region defined by $v_{\\text{R}} \\geq 0$, $v_{\\text{F}} \\geq 0$, $v_{\\text{R}} \\leq 1$, and $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} \\leq 1$ are:\n- Intersection of $v_{\\text{R}}=0$ and $v_{\\text{F}}=0$: $(0, 0)$.\n- Intersection of $v_{\\text{F}}=0$ and $v_{\\text{R}}=1$: $(1, 0)$. This satisfies $0.8(1) + 0.02(0) = 0.8 \\leq 1$.\n- Intersection of $v_{\\text{R}}=0$ and $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} = 1$: This gives $0.02\\,v_{\\text{F}} = 1$, so $v_{\\text{F}}=50$. The vertex is $(0, 50)$. This satisfies $v_{\\text{R}} \\leq 1$.\n- Intersection of $v_{\\text{R}}=1$ and $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} = 1$: This gives $0.8(1) + 0.02\\,v_{\\text{F}} = 1$, so $0.02\\,v_{\\text{F}} = 0.2$, which means $v_{\\text{F}}=10$. The vertex is $(1, 10)$.\n\nWe evaluate $v_{\\text{ATP}}$ at each vertex:\n- At $(0, 0)$: $v_{\\text{ATP}} = 30(0) + 2(0) = 0$.\n- At $(1, 0)$: $v_{\\text{ATP}} = 30(1) + 2(0) = 30$.\n- At $(0, 50)$: $v_{\\text{ATP}} = 30(0) + 2(50) = 100$.\n- At $(1, 10)$: $v_{\\text{ATP}} = 30(1) + 2(10) = 30 + 20 = 50$.\n\nThe maximum value is $100$. Therefore, $v_{\\text{ATP}}^{\\max} = 100$.\n\n**Part 2: Maximizing ATP Yield per Substrate ($Y_{\\text{ATP/S}}$)**\nNext, we maximize the yield function $Y_{\\text{ATP/S}} = \\dfrac{30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}}{v_{\\text{in}}}$. Substituting $v_{\\text{in}} = v_{\\text{R}} + v_{\\text{F}}$, we get:\n$$Y_{\\text{ATP/S}} = \\frac{30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}}{v_{\\text{R}} + v_{\\text{F}}}$$\nThis function represents a weighted average of the individual yields, $30$ and $2$. Let $x = \\frac{v_{\\text{R}}}{v_{\\text{R}} + v_{\\text{F}}}$ be the fraction of substrate directed to respiration. Then $Y_{\\text{ATP/S}} = 30x + 2(1-x) = 28x + 2$. To maximize $Y_{\\text{ATP/S}}$, we must maximize $x$. This corresponds to maximizing the ratio of respiratory flux to total flux, which is achieved by making the flux purely respiratory ($v_{\\text{F}}=0$).\nWe must check if a purely respiratory flux ($v_{\\text{F}}=0$ and $v_{\\text{R}}>0$) is feasible. The constraints become $0 < v_{\\text{R}} \\leq 1$ and $0.8\\,v_{\\text{R}} \\leq 1$ (i.e., $v_{\\text{R}} \\leq 1.25$). A feasible solution exists for any $v_{\\text{R}} \\in (0, 1]$.\nFor any a such point with $v_{\\text{F}}=0$, the yield is $Y_{\\text{ATP/S}} = \\frac{30\\,v_{\\text{R}}}{v_{\\text{R}}} = 30$.\nThus, the maximal feasible value of the yield is $30$, and the \"yield-optimal composition\" is any state with $v_{\\text{F}}=0$.\n\n**Part 3: Calculating $v_{\\text{ATP}}^{\\text{yield}}$**\nWe now find the maximum ATP production rate subject to the constraint that enforces the yield-optimal composition, which is $v_{\\text{F}}=0$. The new optimization problem is:\nMaximize $v_{\\text{ATP}} = 30\\,v_{\\text{R}} + 2\\,v_{\\text{F}}$\nSubject to:\n1. $v_{\\text{R}} \\leq 1$\n2. $0.8\\,v_{\\text{R}} + 0.02\\,v_{\\text{F}} \\leq 1$\n3. $v_{\\text{F}} = 0$\n4. $v_{\\text{R}} \\geq 0$\n\nSubstituting $v_{\\text{F}}=0$ into the objective and constraints gives:\nMaximize $30\\,v_{\\text{R}}$\nSubject to: $v_{\\text{R}} \\leq 1$, $0.8\\,v_{\\text{R}} \\leq 1$ (or $v_{\\text{R}} \\leq 1.25$), and $v_{\\text{R}} \\geq 0$.\nThe combined constraint on $v_{\\text{R}}$ is $0 \\leq v_{\\text{R}} \\leq \\min(1, 1.25) = 1$.\nTo maximize $30\\,v_{\\text{R}}$, we must choose the maximum possible value for $v_{\\text{R}}$, which is $v_{\\text{R}}=1$.\nThe resulting maximum ATP production rate is $30(1) = 30$.\nTherefore, $v_{\\text{ATP}}^{\\text{yield}} = 30$.\n\n**Part 4: Calculating the Trade-off Ratio ($T$)**\nThe trade-off ratio $T$ is the ratio of the ATP production rate under the yield-optimal strategy to the absolute maximum ATP production rate.\n$$T = \\frac{v_{\\text{ATP}}^{\\text{yield}}}{v_{\\text{ATP}}^{\\max}} = \\frac{30}{100} = 0.3$$\nThe problem requires the answer to be rounded to three significant figures.\n$T = 0.300$.",
            "answer": "$$\\boxed{0.300}$$"
        },
        {
            "introduction": "Optimizing a single biological objective, such as maximizing growth rate, can sometimes result in multiple, equally optimal metabolic flux patterns, a situation known as degeneracy. This practice  addresses this ambiguity by introducing the concept of lexicographic optimization, where a secondary objective is used to select a unique solution from the primary optimal set. You will explore how applying a physically motivated secondary objective, such as minimizing enzymatic cost, can resolve this degeneracy and provide a more definitive prediction of cellular behavior.",
            "id": "3910497",
            "problem": "Consider the canonical formulation of Flux Balance Analysis (FBA) for a single-cell metabolic network at steady state. The fundamental base consists of the stoichiometric steady-state constraint $S \\, \\mathbf{v} = \\mathbf{0}$, reaction irreversibility and capacity bounds $ \\mathbf{l} \\le \\mathbf{v} \\le \\mathbf{u}$, and a cellular objective function to be maximized. In this problem, analyze a minimal network that exhibits multiple optima under a primary objective, and then resolve degeneracy by introducing scientifically motivated secondary objectives.\n\nThe network contains four reactions with fluxes $\\mathbf{v} = [v_{1}, v_{2}, v_{3}, v_{B}]^{\\top}$:\n- $v_{1}$: glucose uptake from the extracellular space,\n- $v_{2}$: internal pathway A converting intracellular glucose to biomass,\n- $v_{3}$: internal pathway B converting intracellular glucose to biomass,\n- $v_{B}$: biomass drain (growth rate).\n\nThere are two internal metabolites: intracellular glucose and biomass. The stoichiometric matrix $S$ (rows correspond to metabolites, columns to reactions in the order $v_{1}, v_{2}, v_{3}, v_{B}$) is\n$$\nS \\;=\\;\n\\begin{pmatrix}\n1 & -1 & -1 & 0 \\\\\n0 & 1 & 1 & -1\n\\end{pmatrix}.\n$$\nThe steady-state mass-balance constraints are therefore\n$$\nv_{1} - v_{2} - v_{3} = 0, \\qquad v_{2} + v_{3} - v_{B} = 0.\n$$\nAssume all reactions are irreversible and bounded by\n$$\n0 \\le v_{i}, \\quad i \\in \\{1,2,3,B\\}, \\qquad v_{1} \\le 10.\n$$\n\nPrimary objective: maximize the growth rate $v_{B}$.\n\nTasks:\n1. Starting from the fundamental FBA base ($S\\,\\mathbf{v}=\\mathbf{0}$ with the bounds above), determine the set of optimal solutions for the primary objective and show explicitly that the optimum is degenerate.\n2. Propose lexicographic tie-breaking rules using scientifically motivated secondary objectives. In particular, analyze the commonly suggested secondary objective “minimize total flux” and determine whether it resolves the degeneracy for this network. Then, propose a secondary objective based on minimizing a weighted sum of squared pathway fluxes to reflect differential enzyme usage costs. Let the weight on pathway A be $w_{2} = 2$ and on pathway B be $w_{3} = 1$, and minimize\n$$\nJ(v_{2}, v_{3}) \\;=\\; w_{2}\\, v_{2}^{2} \\;+\\; w_{3}\\, v_{3}^{2}\n$$\nsubject to achieving the maximal $v_{B}$ found in task 1 and satisfying the steady-state constraints and irreversibility bounds.\n3. Compute the unique flux vector $\\mathbf{v}^{\\star} = [v_{1}^{\\star}, v_{2}^{\\star}, v_{3}^{\\star}, v_{B}^{\\star}]$ that results from the lexicographic optimization: first maximize $v_{B}$, then minimize $J(v_{2}, v_{3})$ as specified. Express your final answer as a row matrix in the order $[v_{1}, v_{2}, v_{3}, v_{B}]$ and use millimoles per gram dry weight per hour (mmol gDW$^{-1}$ h$^{-1}$) as the unit. No rounding is required; provide exact values.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of Flux Balance Analysis (FBA), is mathematically well-posed, unambiguous, and self-contained. The provided stoichiometric matrix, constraints, and objectives are consistent and sufficient for deriving a unique, meaningful solution through the specified lexicographic optimization procedure.\n\nThe problem is addressed in three parts as requested.\n\n### Task 1: Primary Objective and Degeneracy\n\nThe system is governed by the stoichiometric steady-state constraint $S \\, \\mathbf{v} = \\mathbf{0}$, where the stoichiometric matrix is\n$$\nS = \\begin{pmatrix} 1 & -1 & -1 & 0 \\\\ 0 & 1 & 1 & -1 \\end{pmatrix}\n$$\nand the flux vector is $\\mathbf{v} = [v_{1}, v_{2}, v_{3}, v_{B}]^{\\top}$. This matrix equation yields two linear equations:\n1.  $v_{1} - v_{2} - v_{3} = 0$\n2.  $v_{2} + v_{3} - v_{B} = 0$\n\nFrom equation (1), we have $v_{1} = v_{2} + v_{3}$.\nFrom equation (2), we have $v_{B} = v_{2} + v_{3}$.\nCombining these two results, we find a direct relationship between the glucose uptake flux $v_{1}$ and the biomass production flux (growth rate) $v_{B}$:\n$$\nv_{B} = v_{1}\n$$\nThe primary objective is to maximize the growth rate, $v_{B}$. Since $v_{B} = v_{1}$, this is equivalent to maximizing the glucose uptake flux $v_{1}$. The problem provides the flux bounds $0 \\le v_{i}$ for $i \\in \\{1,2,3,B\\}$ and an upper bound on glucose uptake, $v_{1} \\le 10$.\n\nTherefore, the maximum possible value for $v_{1}$ is $10$, which in turn gives the maximum growth rate:\n$$\nv_{B, \\text{max}} = v_{1, \\text{max}} = 10\n$$\nAny optimal solution must satisfy $v_{B} = 10$ and $v_{1} = 10$. Substituting these values back into the steady-state equations, we have:\n$$\nv_{2} + v_{3} = v_{1} = 10\n$$\nThe problem also requires all fluxes to be non-negative, so $v_{2} \\ge 0$ and $v_{3} \\ge 0$.\n\nThe set of optimal solutions is the collection of all flux vectors $\\mathbf{v} = [v_{1}, v_{2}, v_{3}, v_{B}]^{\\top}$ that satisfy these conditions. Specifically, any vector of the form\n$$\n\\mathbf{v}_{\\text{opt}} = \\begin{pmatrix} 10 \\\\ v_{2} \\\\ v_{3} \\\\ 10 \\end{pmatrix}\n$$\nwhere $v_{2} + v_{3} = 10$ and $v_{2}, v_{3} \\ge 0$, is an optimal solution. We can parameterize this set by letting $v_{2} = \\alpha$. Then $v_{3} = 10 - \\alpha$, and the non-negativity constraints require $0 \\le \\alpha \\le 10$. The set of optimal solutions is thus\n$$\n\\left\\{ \\begin{pmatrix} 10 \\\\ \\alpha \\\\ 10 - \\alpha \\\\ 10 \\end{pmatrix} \\;\\Bigg|\\; \\alpha \\in [0, 10] \\right\\}\n$$\nSince $\\alpha$ can take any real value in the continuous interval $[0, 10]$, there are infinitely many optimal flux distributions. This explicitly demonstrates that the primary optimum is degenerate.\n\n### Task 2: Lexicographic Tie-breaking\n\nTo resolve this degeneracy, we introduce secondary objectives in a lexicographic manner. This involves optimizing a new objective function over the set of solutions that are optimal for the primary objective.\n\n**Secondary Objective 1: Minimize Total Flux**\n\nA common secondary objective is the minimization of the sum of all metabolic fluxes, often interpreted as a principle of metabolic efficiency. The total flux is $F_{\\text{total}} = \\sum_{i} |v_i|$. Since all fluxes are non-negative, this is $F_{\\text{total}} = v_{1} + v_{2} + v_{3} + v_{B}$.\n\nFor any solution in the degenerate optimal set found in Task 1, we have $v_{1} = 10$, $v_{B} = 10$, and $v_{2} + v_{3} = 10$. Substituting these into the expression for total flux:\n$$\nF_{\\text{total}} = 10 + (v_{2} + v_{3}) + 10 = 10 + 10 + 10 = 30\n$$\nThe total flux is constant ($30$) across all solutions in the primary optimal set. Therefore, minimizing the total flux does not impose any new constraint on the values of $v_{2}$ and $v_{3}$ and fails to resolve the degeneracy.\n\n**Secondary Objective 2: Minimize Weighted Sum of Squared Fluxes**\n\nA more sensitive secondary objective can be formulated based on enzyme costs, where the cost is assumed to be a non-linear function of the flux it carries. We are asked to minimize the objective function\n$$\nJ(v_{2}, v_{3}) = w_{2}\\, v_{2}^{2} + w_{3}\\, v_{3}^{2}\n$$\nwith weights $w_{2} = 2$ and $w_{3} = 1$. The minimization is performed over the set of primary optimal solutions. The constraints for this optimization problem are:\n1. $v_{2} + v_{3} = 10$\n2. $v_{2} \\ge 0$\n3. $v_{3} \\ge 0$\n\nWe can express $J$ as a function of a single variable, say $v_{2}$, by substituting $v_{3} = 10 - v_{2}$ from the first constraint. The domain for $v_{2}$ is $[0, 10]$.\n$$\nJ(v_{2}) = 2 v_{2}^{2} + 1 (10 - v_{2})^{2}\n$$\nExpanding this expression gives:\n$$\nJ(v_{2}) = 2 v_{2}^{2} + (100 - 20v_{2} + v_{2}^{2}) = 3 v_{2}^{2} - 20v_{2} + 100\n$$\nThis is a quadratic function of $v_{2}$, representing an upward-opening parabola. Its minimum can be found by setting its derivative with respect to $v_{2}$ to zero.\n$$\n\\frac{dJ}{dv_{2}} = 6 v_{2} - 20\n$$\nSetting the derivative to $0$:\n$$\n6 v_{2} - 20 = 0 \\quad \\implies \\quad v_{2} = \\frac{20}{6} = \\frac{10}{3}\n$$\nThe second derivative is $\\frac{d^{2}J}{dv_{2}^{2}} = 6 > 0$, confirming this is a minimum. The value $v_{2} = \\frac{10}{3}$ is within the feasible interval $[0, 10]$. Thus, this is the unique value of $v_{2}$ that minimizes $J$.\n\n### Task 3: Unique Optimal Flux Vector\n\nUsing the result from the secondary optimization, we can determine the unique flux distribution $\\mathbf{v}^{\\star}$. The units for the fluxes are given as mmol gDW$^{-1}$ h$^{-1}$.\nThe optimal value for $v_{2}$ is:\n$$\nv_{2}^{\\star} = \\frac{10}{3}\n$$\nWe can now calculate the other fluxes:\nThe flux for pathway B, $v_{3}$, is determined by the constraint $v_{2} + v_{3} = 10$:\n$$\nv_{3}^{\\star} = 10 - v_{2}^{\\star} = 10 - \\frac{10}{3} = \\frac{30 - 10}{3} = \\frac{20}{3}\n$$\nThe fluxes for glucose uptake and biomass production are fixed by the primary objective:\n$$\nv_{1}^{\\star} = 10\n$$\n$$\nv_{B}^{\\star} = 10\n$$\nThe resulting unique flux vector from the lexicographic optimization is $\\mathbf{v}^{\\star} = [v_{1}^{\\star}, v_{2}^{\\star}, v_{3}^{\\star}, v_{B}^{\\star}]^{\\top}$. Substituting the computed values:\n$$\n\\mathbf{v}^{\\star} = \\begin{pmatrix} 10 \\\\ \\frac{10}{3} \\\\ \\frac{20}{3} \\\\ 10 \\end{pmatrix}\n$$\nThe final answer is presented as a row matrix.",
            "answer": "$$\\boxed{\\begin{pmatrix} 10 & \\frac{10}{3} & \\frac{20}{3} & 10 \\end{pmatrix}}$$"
        }
    ]
}