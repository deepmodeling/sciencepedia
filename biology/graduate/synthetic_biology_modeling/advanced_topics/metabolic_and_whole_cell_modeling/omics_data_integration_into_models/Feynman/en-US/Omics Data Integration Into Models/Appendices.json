{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in parameterizing any mechanistic model is to convert the raw, relative outputs of a high-throughput assay into meaningful physical units. This practice explores a cornerstone technique for RNA-seq: the use of external spike-in controls to translate arbitrary sequencing counts into absolute numbers of molecules per cell. By working through this exercise , you will derive the fundamental relationship that enables this conversion, providing a concrete link between experimental data and the parameters of a quantitative model.",
            "id": "3924226",
            "problem": "A single-cell ribonucleic acid sequencing (RNA-seq) experiment is performed to parameterize a mechanistic gene expression model in synthetic biology by converting sequencing counts into absolute molecules per cell. External RNA Controls Consortium (ERCC) spike-in transcripts are added at a known absolute abundance prior to cell lysis. Assume the following foundational measurement model: sequencing reads arise from random sampling of complementary deoxyribonucleic acid (cDNA) molecules generated from messenger ribonucleic acid (mRNA) and spike-in templates, and, in expectation, the number of reads mapping to any transcript is proportional to the number of its input molecules multiplied by the total library size.\n\nLet $L$ denote the total number of uniquely mapped reads in the library, $C_{g}$ the uniquely mapped reads to gene $g$, $C_{s}$ the uniquely mapped reads to a particular ERCC spike-in species $s$, and $M_{s}$ the true number of molecules of spike-in species $s$ contributed per cell. Assume a common linear factor of proportionality across endogenous mRNA and the chosen spike-in, encompassing reverse transcription efficiency, amplification efficiency, and mapping probability, and assume that $L$ is known.\n\nStarting from the proportional sampling premise and core definitions above, derive an expression for the molecules per cell of gene $g$, denoted $M_{g}$, in terms of $C_{g}$, $C_{s}$, $M_{s}$, and $L$, and eliminate any nuisance constants so that $M_{g}$ is expressed only in terms of $C_{g}$, $C_{s}$, and $M_{s}$.\n\nThen, for a single cell with observed $L = 2.80 \\times 10^{7}$, $C_{g} = 13{,}720$, $C_{s} = 22{,}740$, and a known $M_{s} = 1{,}300$ molecules per cell, compute $M_{g}$ as a real number. Round your final answer to four significant figures. Express your answer as molecules per cell with no units in your final numerical value.",
            "solution": "The problem requires the derivation of an expression for the number of messenger ribonucleic acid (mRNA) molecules of a gene, $M_{g}$, based on a single-cell ribonucleic acid sequencing (RNA-seq) experiment that uses External RNA Controls Consortium (ERCC) spike-in controls for absolute quantification. Subsequently, a numerical value for $M_{g}$ is to be computed based on provided data.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\n- $L$: total number of uniquely mapped reads in the library.\n- $C_{g}$: uniquely mapped reads to gene $g$.\n- $C_{s}$: uniquely mapped reads to a particular ERCC spike-in species $s$.\n- $M_{s}$: true number of molecules of spike-in species $s$ contributed per cell.\n- $M_{g}$: molecules per cell of gene $g$.\n- Premise: \"...in expectation, the number of reads mapping to any transcript is proportional to the number of its input molecules multiplied by the total library size.\"\n- Assumption: \"a common linear factor of proportionality across endogenous mRNA and the chosen spike-in\".\n- Numerical values for a single cell: $L = 2.80 \\times 10^{7}$, $C_{g} = 13{,}720$, $C_{s} = 22{,}740$, and $M_{s} = 1{,}300$.\n- Required task: Derive an expression for $M_{g}$ in terms of $C_{g}$, $C_{s}$, and $M_{s}$, and then compute its numerical value, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes a valid and common methodology in quantitative biology and synthetic biology modeling, specifically the use of spike-in standards for absolute quantification of transcripts from sequencing data. The underlying principle of proportional sampling is a cornerstone of RNA-seq analysis.\n- **Well-Posed:** The problem is well-posed. It provides a clear set of definitions and a specific, albeit simplified, measurement model. The objectives are explicit: derive an expression and then compute a numerical value. The information provided is sufficient to achieve these objectives.\n- **Objective:** The language is technical, precise, and free of subjective or ambiguous terminology.\n- **Incomplete or Contradictory Setup:** The problem is self-contained. While the premise that read counts are proportional to molecule counts *multiplied by* the total library size ($C \\propto M \\cdot L$) is an unconventional formulation (a more standard model is that the read fraction is proportional to the molecule fraction, $C/L \\propto M/M_{total}$, or simply $C \\propto M$), it constitutes a self-consistent mathematical model defined within the problem statement itself. The presence of the variable $L$, which is ultimately eliminated from the final expression, is a common feature in physics and engineering problems designed to test understanding of scaling relationships. The problem is not contradictory.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the solution.\n\nThe foundational measurement model, as stated in the problem, is that the expected number of reads for a given transcript, $\\mathbb{E}[C]$, is proportional to the number of its input molecules, $M$, and the total library size, $L$. This can be expressed mathematically as:\n$$ \\mathbb{E}[C] = k \\cdot M \\cdot L $$\nwhere $k$ is a constant of proportionality. This constant $k$ is assumed to be common for both the endogenous gene $g$ and the ERCC spike-in species $s$. For the purpose of estimation, we equate the observed read counts, $C_{g}$ and $C_{s}$, with their expectations.\n\nFor the gene of interest, $g$, we have:\n$$ C_{g} = k \\cdot M_{g} \\cdot L \\quad (1) $$\n\nFor the ERCC spike-in species, $s$, we have:\n$$ C_{s} = k \\cdot M_{s} \\cdot L \\quad (2) $$\n\nThe problem asks for an expression for $M_{g}$. Our strategy will be to eliminate the unknown nuisance constant $k$ and any other non-essential variables. We can take the ratio of equation $(1)$ to equation $(2)$:\n$$ \\frac{C_{g}}{C_{s}} = \\frac{k \\cdot M_{g} \\cdot L}{k \\cdot M_{s} \\cdot L} $$\nThe terms $k$ and $L$ cancel out, which simplifies the expression significantly. This cancellation confirms that under this model, the total library size $L$ is not needed for the relative quantification that leads to absolute numbers via the spike-in standard.\n$$ \\frac{C_{g}}{C_{s}} = \\frac{M_{g}}{M_{s}} $$\nNow, we can solve for $M_{g}$ by rearranging the equation:\n$$ M_{g} = M_{s} \\cdot \\frac{C_{g}}{C_{s}} $$\nThis is the derived expression for the number of molecules of gene $g$, expressed solely in terms of the directly measurable quantities $C_{g}$ and $C_{s}$, and the known quantity $M_{s}$.\n\nNow, we will compute the numerical value for $M_{g}$ using the provided data:\n- $C_{g} = 13720$\n- $C_{s} = 22740$\n- $M_{s} = 1300$\n\nSubstituting these values into our derived formula:\n$$ M_{g} = 1300 \\cdot \\frac{13720}{22740} $$\n$$ M_{g} = \\frac{1300 \\cdot 13720}{22740} = \\frac{17836000}{22740} $$\n$$ M_{g} \\approx 784.340369... $$\n\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $7$, $8$, $4$, and $3$. The fifth digit is $4$, which is less than $5$, so we round down.\n$$ M_{g} \\approx 784.3 $$\nThis value represents the estimated number of molecules of gene $g$ per cell.",
            "answer": "$$\\boxed{784.3}$$"
        },
        {
            "introduction": "Integrating omics data is not merely about obtaining parameter estimates; it is about understanding their uncertainty. This exercise  directly connects the quality of sequencing data, as summarized by alignment metrics like MAPQ, to the confidence we can have in a biophysical parameter inferred from that data. You will use a Bayesian framework to see how measurement error, derived from data quality, propagates to the posterior variance of a transcription rate, illustrating the critical link between data fidelity and model reliability.",
            "id": "3924210",
            "problem": "A synthetic biology model integrates transcriptome-level observations into a mechanistic ordinary differential equation for gene expression. Under steady state of transcription and degradation, the messenger ribonucleic acid (mRNA) abundance for a gene is modeled by $x = k_{t}/d$, where $x$ is the steady-state mRNA abundance in molecules, $k_{t}$ is the transcription rate in molecules per minute, and $d$ is the first-order degradation rate in per minute. An RNA sequencing (RNA-seq) assay provides aligned reads to this gene with alignment quality summaries derived from the Sequence Alignment/Map specification, including Mapping Quality (MAPQ). The mapping quality score $Q$ is defined such that the probability of an incorrect alignment is $P_{\\mathrm{wrong}} = 10^{-Q/10}$.\n\nAssume the following:\n- The total number of reads aligned to the gene is $N = 3000$.\n- The average per-base mismatch rate across aligned reads is $m = 0.02$.\n- The average Mapping Quality (MAPQ) score is $Q = 25$, so $P_{\\mathrm{wrong}} = 10^{-Q/10}$.\n- Treat the effective information content of a read as reduced multiplicatively by mismatch and incorrect-mapping probabilities, with a reliability weight $w = (1 - m)\\,(1 - P_{\\mathrm{wrong}})$. The effective number of reliable reads is $N_{\\mathrm{eff}} = wN$.\n- Counts are modeled as Poisson, and the expression estimator $\\hat{x}$ (in molecules) is obtained by a fixed conversion factor $\\phi = 2$ counts per molecule, so that the measurement variance can be approximated by $\\sigma^{2} = N_{\\mathrm{eff}}/\\phi^{2}$ via a Poisson-to-Normal approximation.\n- The degradation rate is known and equal to $d = 0.05\\,\\mathrm{min}^{-1}$.\n- The transcription rate parameter has a Gaussian prior $k_{t} \\sim \\mathcal{N}(\\mu_{0}, \\tau_{0}^{2})$ with $\\mu_{0} = 50$ molecules per minute and $\\tau_{0}^{2} = 100\\,(\\mathrm{molecules\\, per\\, minute})^{2}$.\n- The observation model is $\\hat{x} \\sim \\mathcal{N}(x, \\sigma^{2})$ with $x = k_{t}/d$.\n\nFrom first principles, use the above definitions and assumptions to derive the posterior variance of $k_{t}$ under the Gaussian prior and Gaussian likelihood implied by the linear mapping $x = k_{t}/d$ and the measurement error variance $\\sigma^{2}$ determined by the alignment quality metrics. Compute the numerical value of the posterior variance and express your final answer in $(\\mathrm{molecules\\, per\\, minute})^{2}$. Round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the posterior variance of the transcription rate parameter, $k_t$, using a Bayesian framework. The solution involves combining a Gaussian prior with a Gaussian likelihood derived from the experimental observation.\n\nFirst, let us establish the statistical model. The parameter of interest is the transcription rate, $k_t$. The prior belief about this parameter is given as a Gaussian distribution:\n$$k_{t} \\sim \\mathcal{N}(\\mu_{0}, \\tau_{0}^{2})$$\nwhere the prior mean is $\\mu_{0} = 50$ molecules per minute and the prior variance is $\\tau_{0}^{2} = 100\\,(\\mathrm{molecules/min})^{2}$. The prior probability density function is therefore:\n$$p(k_t) = \\frac{1}{\\sqrt{2\\pi\\tau_{0}^{2}}} \\exp\\left(-\\frac{(k_t - \\mu_0)^2}{2\\tau_0^2}\\right)$$\n\nThe experimental observation is an estimate of the mRNA abundance, $\\hat{x}$. The observation model is given as a Gaussian distribution centered on the true steady-state abundance, $x$:\n$$\\hat{x} \\sim \\mathcal{N}(x, \\sigma^{2})$$\nThe true abundance $x$ is related to the transcription rate $k_t$ and degradation rate $d$ by the steady-state equation $x = k_t/d$. Substituting this into the observation model, we obtain the distribution of $\\hat{x}$ conditional on $k_t$:\n$$\\hat{x} | k_t \\sim \\mathcal{N}(k_t/d, \\sigma^{2})$$\nThe likelihood function, $L(k_t; \\hat{x})$, is the probability of observing $\\hat{x}$ for a given value of $k_t$. This is given by the probability density function of the above distribution, but viewed as a function of $k_t$:\n$$p(\\hat{x} | k_t) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(\\hat{x} - k_t/d)^2}{2\\sigma^2}\\right)$$\n\nAccording to Bayes' theorem, the posterior distribution of $k_t$ is proportional to the product of the prior distribution and the likelihood function:\n$$p(k_t | \\hat{x}) \\propto p(\\hat{x} | k_t) p(k_t)$$\nSubstituting the expressions for the prior and likelihood:\n$$p(k_t | \\hat{x}) \\propto \\exp\\left(-\\frac{(\\hat{x} - k_t/d)^2}{2\\sigma^2}\\right) \\exp\\left(-\\frac{(k_t - \\mu_0)^2}{2\\tau_0^2}\\right)$$\nSince the product of two Gaussian functions is another Gaussian function (unnormalized), the posterior distribution for $k_t$ will also be Gaussian, which we can write as $p(k_t | \\hat{x}) = \\mathcal{N}(k_t | \\mu_{\\text{post}}, \\tau_{\\text{post}}^2)$.\n\nTo find the posterior variance, $\\tau_{\\text{post}}^2$, it is most convenient to work with precisions (inverse variances). The precision of a Gaussian distribution $\\mathcal{N}(\\mu, \\sigma^2)$ is $1/\\sigma^2$. The posterior precision is the sum of the prior precision and the precision of the likelihood.\nThe prior precision is clearly $1/\\tau_0^2$. To find the precision from the likelihood, we must rewrite the likelihood's exponent as a quadratic function of $k_t$:\n$$-\\frac{(\\hat{x} - k_t/d)^2}{2\\sigma^2} = -\\frac{(1/d)^2(d\\hat{x} - k_t)^2}{2\\sigma^2} = -\\frac{(k_t - d\\hat{x})^2}{2d^2\\sigma^2}$$\nThis form reveals that the likelihood, as a function of $k_t$, corresponds to a Gaussian distribution centered at $d\\hat{x}$ with a variance of $d^2\\sigma^2$. Thus, the precision contributed by the likelihood is $1/(d^2\\sigma^2)$.\n\nThe posterior precision, $1/\\tau_{\\text{post}}^2$, is the sum of the prior and likelihood precisions:\n$$\\frac{1}{\\tau_{\\text{post}}^2} = \\frac{1}{\\tau_0^2} + \\frac{1}{d^2\\sigma^2}$$\nFrom this, the posterior variance is:\n$$\\tau_{\\text{post}}^2 = \\left(\\frac{1}{\\tau_0^2} + \\frac{1}{d^2\\sigma^2}\\right)^{-1}$$\n\nNext, we must calculate the value of the measurement variance, $\\sigma^2$, from the provided alignment quality metrics.\nGiven values are: total reads $N = 3000$, average Mapping Quality $Q = 25$, and average per-base mismatch rate $m = 0.02$.\nThe probability of an incorrect alignment is $P_{\\mathrm{wrong}} = 10^{-Q/10}$.\n$$P_{\\mathrm{wrong}} = 10^{-25/10} = 10^{-2.5}$$\nThe reliability weight $w$ is defined as $w = (1 - m)(1 - P_{\\mathrm{wrong}})$.\n$$w = (1 - 0.02)(1 - 10^{-2.5}) = 0.98 \\times (1 - 10^{-2.5})$$\nThe effective number of reliable reads is $N_{\\mathrm{eff}} = wN$.\n$$N_{\\mathrm{eff}} = (0.98 \\times (1 - 10^{-2.5})) \\times 3000$$\nThe measurement variance $\\sigma^2$ is given by $\\sigma^2 = N_{\\mathrm{eff}}/\\phi^2$, with the conversion factor $\\phi = 2$.\n$$\\sigma^2 = \\frac{0.98 \\times (1 - 10^{-2.5}) \\times 3000}{2^2} = 0.98 \\times (1 - 10^{-2.5}) \\times 750$$\nLet's compute the numerical value for $\\sigma^2$:\n$10^{-2.5} \\approx 0.00316228$\n$1 - 10^{-2.5} \\approx 0.99683772$\n$w \\approx 0.98 \\times 0.99683772 \\approx 0.97690097$\n$N_{\\mathrm{eff}} \\approx 0.97690097 \\times 3000 \\approx 2930.7029$\n$$\\sigma^2 = \\frac{N_{\\mathrm{eff}}}{4} \\approx \\frac{2930.7029}{4} \\approx 732.6757\\,(\\mathrm{molecules})^2$$\n\nNow we have all the components to calculate the posterior variance $\\tau_{\\text{post}}^2$. The given values for the prior and the model are $\\tau_0^2 = 100\\,(\\mathrm{molecules/min})^2$ and $d = 0.05\\,\\mathrm{min}^{-1}$.\nSubstituting into the formula for the posterior variance:\n$$\\tau_{\\text{post}}^2 = \\left(\\frac{1}{100} + \\frac{1}{(0.05)^2 \\times \\sigma^2}\\right)^{-1}$$\nFirst, compute the denominator term for the likelihood's contribution:\n$$d^2\\sigma^2 = (0.05)^2 \\times 732.6757 = 0.0025 \\times 732.6757 \\approx 1.831689\\,(\\mathrm{molecules/min})^2$$\nNow, substitute this into the expression for $\\tau_{\\text{post}}^2$:\n$$\\tau_{\\text{post}}^2 = \\left(\\frac{1}{100} + \\frac{1}{1.831689}\\right)^{-1}$$\n$$\\tau_{\\text{post}}^2 = (0.01 + 0.545945)^{-1}$$\n$$\\tau_{\\text{post}}^2 = (0.555945)^{-1} \\approx 1.798730\\,(\\mathrm{molecules/min})^2$$\n\nRounding the final result to four significant figures, as requested, we get:\n$$\\tau_{\\text{post}}^2 \\approx 1.799\\,(\\mathrm{molecules\\, per\\, minute})^{2}$$\nThis value represents the updated variance (a measure of uncertainty) of the transcription rate parameter $k_t$ after incorporating the RNA-seq measurement, which provides much more information than the prior alone, resulting in a significant reduction in variance from the prior value of $100$ to the posterior value of approximately $1.8$.",
            "answer": "$$\\boxed{1.799}$$"
        },
        {
            "introduction": "Modern multi-omics techniques, especially at the single-cell level, generate incredibly rich datasets but are also susceptible to unique technical artifacts that can corrupt downstream analysis. This practice  focuses on one such artifact—doublets—and demonstrates how to construct a formal probabilistic model to both identify and correct for their effects. By reasoning through a generative model for singleton and doublet droplets, you will understand how to apply Bayesian principles to ensure the integrity of cross-modal data integration.",
            "id": "3924193",
            "problem": "A droplet-based single-cell multi-omics experiment jointly profiles ribonucleic acid (RNA) by single-cell ribonucleic acid sequencing (scRNA-seq) and chromatin accessibility by single-cell assay for transposase-accessible chromatin sequencing (scATAC-seq) within the same barcoded droplet. Let the number of captured cells per droplet be modeled by a Poisson distribution with mean $\\lambda$. Only droplets with at least one captured cell are retained. For each retained droplet, the observed data are a pair of count vectors $(\\mathbf{x}, \\mathbf{y})$, where $\\mathbf{x} \\in \\mathbb{N}^{G}$ are gene counts for $G$ genes from scRNA-seq and $\\mathbf{y} \\in \\mathbb{N}^{P}$ are peak counts for $P$ peaks from scATAC-seq. Assume a catalog of $K$ biological cell types indexed by $k \\in \\{1,\\dots,K\\}$, with known modality-specific rate vectors $\\boldsymbol{\\theta}^{(R)}_k \\in \\mathbb{R}_{>0}^{G}$ and $\\boldsymbol{\\theta}^{(A)}_k \\in \\mathbb{R}_{>0}^{P}$ estimated from high-quality references. Let $\\pi_k$ denote the prior proportion of cell type $k$ in the sample, with $\\sum_{k=1}^{K} \\pi_k = 1$.\n\nDefine a latent indicator $D \\in \\{0,1\\}$, where $D=0$ denotes a singleton (one captured cell of type $k$) and $D=1$ denotes a doublet (two captured cells of types $k \\neq \\ell$). Assume the following generative model based on well-tested sampling facts for droplet sequencing and the superposition of independent Poisson processes:\n\n- Conditional on $D=0$ and cell type $k$, the modalities are independent given $k$, and\n$$\\mathbf{x} \\sim \\mathrm{Poisson}\\!\\left(\\boldsymbol{\\theta}^{(R)}_k\\right), \\quad \\mathbf{y} \\sim \\mathrm{Poisson}\\!\\left(\\boldsymbol{\\theta}^{(A)}_k\\right).$$\n\n- Conditional on $D=1$ and a pair $(k,\\ell)$ with $k \\neq \\ell$, molecule additivity implies the sum of two independent Poisson processes, so\n$$\\mathbf{x} \\sim \\mathrm{Poisson}\\!\\left(\\boldsymbol{\\theta}^{(R)}_k + \\boldsymbol{\\theta}^{(R)}_\\ell\\right), \\quad \\mathbf{y} \\sim \\mathrm{Poisson}\\!\\left(\\boldsymbol{\\theta}^{(A)}_k + \\boldsymbol{\\theta}^{(A)}_\\ell\\right),$$\nwith conditional independence of modalities given $(k,\\ell)$.\n\nLet $p(D)$ denote the prior probability of a doublet among retained droplets, derived from the Poisson loading model and the conditioning on at least one captured cell per droplet. Using Bayes’ rule, one can compute the posterior $p(D=1 \\mid \\mathbf{x}, \\mathbf{y})$ by integrating over all possible cell-type pairs for doublets and single types for singletons. Doublets are known to distort cross-modal integration because the summed signals form points that lie between distinct single-cell manifolds, spuriously connecting neighborhoods across modalities and biasing latent alignments.\n\nWhich option correctly characterizes the impact of doublets on cross-modal integration and provides a probabilistically valid detection-and-correction approach consistent with the stated generative assumptions?\n\nA. Doublets bridge distinct single-cell manifolds in the joint latent space, increasing erroneous cross-modal nearest neighbors. A valid detector uses a Bayes posterior that conditions on retained droplets and integrates both modalities:\n$$p(D=1 \\mid \\mathbf{x}, \\mathbf{y}) = \\frac{p(D=1)\\,\\sum_{k \\neq \\ell} \\pi_k \\pi_\\ell \\, L_R\\!\\left(\\mathbf{x}\\,\\middle|\\,\\boldsymbol{\\theta}^{(R)}_k + \\boldsymbol{\\theta}^{(R)}_\\ell\\right)\\, L_A\\!\\left(\\mathbf{y}\\,\\middle|\\,\\boldsymbol{\\theta}^{(A)}_k + \\boldsymbol{\\theta}^{(A)}_\\ell\\right)}{p(D=1)\\,\\sum_{k \\neq \\ell} \\pi_k \\pi_\\ell \\, L_R\\!\\left(\\mathbf{x}\\,\\middle|\\,\\boldsymbol{\\theta}^{(R)}_k + \\boldsymbol{\\theta}^{(R)}_\\ell\\right)\\, L_A\\!\\left(\\mathbf{y}\\,\\middle|\\,\\boldsymbol{\\theta}^{(A)}_k + \\boldsymbol{\\theta}^{(A)}_\\ell\\right) \\;+\\; p(D=0)\\,\\sum_{k} \\pi_k \\, L_R\\!\\left(\\mathbf{x}\\,\\middle|\\,\\boldsymbol{\\theta}^{(R)}_k\\right)\\, L_A\\!\\left(\\mathbf{y}\\,\\middle|\\,\\boldsymbol{\\theta}^{(A)}_k\\right)},$$\nwhere $L_R$ and $L_A$ are Poisson likelihoods for scRNA-seq and scATAC-seq, respectively, and $p(D)$ is computed from the Poisson loading conditioned on at least one captured cell. A principled correction creates two pseudo-cells by Poisson thinning per modality for the maximum a posteriori pair $(k^{\\star}, \\ell^{\\star})$: for each gene $g$, split $x_g$ into $(x^{(k^{\\star})}_g, x^{(\\ell^{\\star})}_g) \\sim \\mathrm{Multinomial}\\!\\left(x_g; \\frac{\\theta^{(R)}_{k^{\\star},g}}{\\theta^{(R)}_{k^{\\star},g} + \\theta^{(R)}_{\\ell^{\\star},g}}, \\frac{\\theta^{(R)}_{\\ell^{\\star},g}}{\\theta^{(R)}_{k^{\\star},g} + \\theta^{(R)}_{\\ell^{\\star},g}}\\right)$, and analogously for peaks in $\\mathbf{y}$, yielding two corrected single-cell profiles consistent with Poisson superposition.\n\nB. Doublets inflate total counts but do not change cross-modal neighborhood structure if normalization is applied. A detector can ignore scATAC-seq and use only scRNA-seq with prior $p(D=1) = 1 - e^{-\\lambda}(1+\\lambda)$, declaring a doublet when the scRNA-seq likelihood under any single type is below a fixed threshold; correction is unnecessary, so detected doublets are simply discarded.\n\nC. Doublets are primarily high-library-size events; integration is unaffected if counts are log-normalized. Detect doublets by thresholding $\\|\\mathbf{x}\\|_{1} + \\|\\mathbf{y}\\|_{1}$ above the median, and correct by dividing all counts in $(\\mathbf{x}, \\mathbf{y})$ by $\\log\\!\\left(\\|\\mathbf{x}\\|_{1} + \\|\\mathbf{y}\\|_{1}\\right)$.\n\nD. Doublets generate convex averages of two single-cell profiles rather than sums. A valid detector assumes a Gaussian likelihood centered at $\\tfrac{1}{2}\\left(\\boldsymbol{\\theta}^{(R)}_k + \\boldsymbol{\\theta}^{(R)}_\\ell\\right)$ for scRNA-seq and $\\tfrac{1}{2}\\left(\\boldsymbol{\\theta}^{(A)}_k + \\boldsymbol{\\theta}^{(A)}_\\ell\\right)$ for scATAC-seq, with a uniform prior over $k \\neq \\ell$; correction replaces $(\\mathbf{x}, \\mathbf{y})$ by their arithmetic mean.\n\nE. Doublets distort canonical correlation analysis by merging two cell-type clusters. A valid detector fits an Expectation-Maximization (EM) algorithm with $K$ singleton components and $\\tfrac{K(K-1)}{2}$ doublet components in the latent canonical correlation space, using isotropic Gaussian likelihoods; correction assigns the droplet to the most likely doublet component and back-projects the Gaussian mean to two singletons by halving the latent vector.",
            "solution": "The problem asks for an evaluation of different strategies for detecting and correcting doublets in a single-cell multi-omics experiment, based on a specific generative probabilistic model.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Experiment**: Joint profiling of RNA (scRNA-seq, counts $\\mathbf{x} \\in \\mathbb{N}^{G}$) and chromatin accessibility (scATAC-seq, counts $\\mathbf{y} \\in \\mathbb{N}^{P}$) in droplets.\n-   **Cell Loading**: Number of cells per droplet $\\sim \\mathrm{Poisson}(\\lambda)$. Only droplets with $\\ge 1$ cell are kept.\n-   **Cell Types**: $K$ known cell types, with prior proportions $\\pi_k$ where $\\sum_{k=1}^K \\pi_k = 1$.\n-   **Reference Profiles**: Known rate vectors $\\boldsymbol{\\theta}^{(R)}_k \\in \\mathbb{R}_{>0}^{G}$ (RNA) and $\\boldsymbol{\\theta}^{(A)}_k \\in \\mathbb{R}_{>0}^{P}$ (ATAC) for each type $k$.\n-   **Latent Droplet State**: $D=0$ for a singleton (one cell of type $k$), $D=1$ for a doublet (two cells of types $k \\neq \\ell$).\n-   **Singleton Model ($D=0$)**: Given type $k$, counts are from independent Poisson distributions:\n    $$ \\mathbf{x} \\sim \\mathrm{Poisson}\\!\\left(\\boldsymbol{\\theta}^{(R)}_k\\right), \\quad \\mathbf{y} \\sim \\mathrm{Poisson}\\!\\left(\\boldsymbol{\\theta}^{(A)}_k\\right) $$\n-   **Doublet Model ($D=1$)**: Given types $k \\neq \\ell$, counts are from a superposition of independent Poisson processes:\n    $$ \\mathbf{x} \\sim \\mathrm{Poisson}\\!\\left(\\boldsymbol{\\theta}^{(R)}_k + \\boldsymbol{\\theta}^{(R)}_\\ell\\right), \\quad \\mathbf{y} \\sim \\mathrm{Poisson}\\!\\left(\\boldsymbol{\\theta}^{(A)}_k + \\boldsymbol{\\theta}^{(A)}_\\ell\\right) $$\n-   **Prior on Doublets**: $p(D)$ is the prior probability of a doublet among retained droplets.\n-   **Objective**: Identify the option that correctly characterizes doublet impact and provides a probabilistically valid detection/correction scheme consistent with the model.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem formulation is scientifically and mathematically sound.\n-   **Scientific Grounding**: The use of a Poisson model for cell capture and for sequencing counts is standard in the field of single-cell genomics. The additivity of molecules from two cells in a droplet and the corresponding superposition property of Poisson distributions (sum of independent Poisson variables is Poisson with the sum of rates) is a correct and fundamental modeling principle.\n-   **Well-Posed**: The problem defines a complete generative model and asks for the evaluation of methods against this model. This is a well-posed question in statistical model checking and application.\n-   **Objectivity & Completeness**: The problem is stated using precise, objective mathematical language. All necessary components of the generative model are provided to derive a Bayesian classifier.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed to derive the solution and evaluate each option.\n\n### Principle-Based Derivation and Option Analysis\n\nThe core task is to formulate the posterior probability $p(D=1 \\mid \\mathbf{x}, \\mathbf{y})$ using Bayes' rule.\n$$ p(D=1 \\mid \\mathbf{x}, \\mathbf{y}) = \\frac{p(\\mathbf{x}, \\mathbf{y} \\mid D=1) p(D=1)}{p(\\mathbf{x}, \\mathbf{y})} $$\nThe denominator is the marginal likelihood, $p(\\mathbf{x}, \\mathbf{y}) = p(\\mathbf{x}, \\mathbf{y} \\mid D=1) p(D=1) + p(\\mathbf{x}, \\mathbf{y} \\mid D=0) p(D=0)$.\nLet $L_R(\\mathbf{x} \\mid \\boldsymbol{\\lambda})$ and $L_A(\\mathbf{y} \\mid \\boldsymbol{\\mu})$ denote the Poisson likelihoods. The problem states that modalities are conditionally independent.\n\n**1. Likelihood for a Singleton ($D=0$)**\nWe must marginalize over the possible cell types. Assuming the probability of a singleton being type $k$ is $\\pi_k$:\n$$ p(\\mathbf{x}, \\mathbf{y} \\mid D=0) = \\sum_{k=1}^K p(\\mathbf{x}, \\mathbf{y} \\mid D=0, \\text{type } k) P(\\text{type } k \\mid D=0) $$\n$$ p(\\mathbf{x}, \\mathbf{y} \\mid D=0) = \\sum_{k=1}^K \\pi_k \\left[ L_R(\\mathbf{x} \\mid \\boldsymbol{\\theta}^{(R)}_k) L_A(\\mathbf{y} \\mid \\boldsymbol{\\theta}^{(A)}_k) \\right] $$\n\n**2. Likelihood for a Doublet ($D=1$)**\nWe marginalize over all distinct pairs of cell types $(k, \\ell)$ where $k \\neq \\ell$. The probability of drawing a pair of cells with types $k$ and $\\ell$ is proportional to $\\pi_k \\pi_\\ell$.\n$$ p(\\mathbf{x}, \\mathbf{y} \\mid D=1) = \\sum_{k \\neq \\ell} p(\\mathbf{x}, \\mathbf{y} \\mid D=1, \\text{types } k, \\ell) P(\\text{types } k, \\ell \\mid D=1) $$\nUsing $\\pi_k \\pi_\\ell$ as the relative weight for the pair $(k, \\ell)$, which is standard in such mixture models:\n$$ p(\\mathbf{x}, \\mathbf{y} \\mid D=1) \\propto \\sum_{k \\neq \\ell} \\pi_k \\pi_\\ell \\left[ L_R(\\mathbf{x} \\mid \\boldsymbol{\\theta}^{(R)}_k + \\boldsymbol{\\theta}^{(R)}_\\ell) L_A(\\mathbf{y} \\mid \\boldsymbol{\\theta}^{(A)}_k + \\boldsymbol{\\theta}^{(A)}_\\ell) \\right] $$\nThe formulation in Option A implicitly defines the class-conditional likelihoods this way.\n\n**3. Posterior Probability**\nCombining these terms into Bayes' rule yields:\n$$ p(D=1 \\mid \\mathbf{x}, \\mathbf{y}) = \\frac{p(D=1)\\,\\sum_{k \\neq \\ell} \\pi_k \\pi_\\ell \\, L_R(\\dots) L_A(\\dots)}{p(D=1)\\,\\sum_{k \\neq \\ell} \\pi_k \\pi_\\ell \\, L_R(\\dots) L_A(\\dots) \\;+\\; p(D=0)\\,\\sum_{k} \\pi_k \\, L_R(\\dots) L_A(\\dots)} $$\nThis is a standard formulation for a Bayesian classifier derived from a mixture model.\n\n**4. Correction of Doublet Counts**\nIf a droplet is identified as a doublet of types $(k^\\star, \\ell^\\star)$, we have observed counts $x_g \\sim \\mathrm{Poisson}(\\theta^{(R)}_{k^\\star,g} + \\theta^{(R)}_{\\ell^\\star,g})$. We want to infer the unobserved constituent counts $x_g^{(k^\\star)} \\sim \\mathrm{Poisson}(\\theta^{(R)}_{k^\\star,g})$ and $x_g^{(\\ell^\\star)} \\sim \\mathrm{Poisson}(\\theta^{(R)}_{\\ell^\\star,g})$, where $x_g = x_g^{(k^\\star)} + x_g^{(\\ell^\\star)}$.\nBy a fundamental property of the Poisson distribution, the conditional distribution of one of the components given their sum is Binomial:\n$$ x_g^{(k^\\star)} \\mid x_g \\sim \\mathrm{Binomial}\\left(x_g, p_g\\right) \\quad \\text{where} \\quad p_g = \\frac{\\theta^{(R)}_{k^\\star,g}}{\\theta^{(R)}_{k^\\star,g} + \\theta^{(R)}_{\\ell^\\star,g}} $$\nSampling from this distribution to obtain $x_g^{(k^\\star)}$ and setting $x_g^{(\\ell^\\star)} = x_g - x_g^{(k^\\star)}$ is the correct way to \"unmix\" the counts. This procedure is equivalent to sampling the pair $(x_g^{(k^\\star)}, x_g^{(\\ell^\\star)})$ from a Multinomial distribution with two categories and $x_g$ trials. This process is known as Poisson thinning.\n\nWith these principles established, we evaluate the options.\n\n### Option-by-Option Analysis\n\n**A. Doublets bridge distinct single-cell manifolds in the joint latent space, increasing erroneous cross-modal nearest neighbors. A valid detector uses a Bayes posterior that conditions on retained droplets and integrates both modalities: ... A principled correction creates two pseudo-cells by Poisson thinning per modality for the maximum a posteriori pair $(k^{\\star}, \\ell^{\\star})$: ...**\n\n-   **Impact**: The description of doublets bridging manifolds is accurate and a key motivation for their removal or correction in single-cell analysis.\n-   **Detector**: The formula for $p(D=1 \\mid \\mathbf{x}, \\mathbf{y})$ is identical to the one derived above. It correctly applies Bayes' rule to the specified generative model, integrating evidence from both modalities and marginalizing over the latent cell types.\n-   **Correction**: The proposed correction method, splitting the total count $x_g$ via a Multinomial distribution with probabilities proportional to the expected rates from the constituent cell types, is precisely Poisson thinning. This is the statistically correct procedure to reverse the Poisson superposition.\n-   **Verdict**: **Correct**. This option is entirely consistent with the problem's probabilistic setup and established statistical theory.\n\n**B. Doublets inflate total counts but do not change cross-modal neighborhood structure if normalization is applied. A detector can ignore scATAC-seq and use only scRNA-seq with prior $p(D=1) = 1 - e^{-\\lambda}(1+\\lambda)$, declaring a doublet when the scRNA-seq likelihood under any single type is below a fixed threshold; correction is unnecessary, so detected doublets are simply discarded.**\n\n-   **Impact**: The claim that normalization resolves the structural changes is false. A doublet's profile is a composition of two different types, which places it artifactually between the true cell-type clusters, a structural distortion that normalization does not fix.\n-   **Detector**: Ignoring one modality (scATAC-seq) is suboptimal and inconsistent with a model for the joint data $(\\mathbf{x}, \\mathbf{y})$. The prior $p(D=1) = P(N \\ge 2) = 1 - e^{-\\lambda}(1+\\lambda)$ is incorrect because it's not conditioned on the retention of droplets with at least one cell. The correct conditioned prior is $P(N \\ge 2 \\mid N \\ge 1) = \\frac{1 - e^{-\\lambda}(1+\\lambda)}{1-e^{-\\lambda}}$. The detection rule is a heuristic, not a principled Bayesian calculation.\n-   **Correction**: The claim that correction is unnecessary is false, and simply discarding data is one, but not the only or always the best, option.\n-   **Verdict**: **Incorrect**.\n\n**C. Doublets are primarily high-library-size events; integration is unaffected if counts are log-normalized. Detect doublets by thresholding $\\|\\mathbf{x}\\|_{1} + \\|\\mathbf{y}\\|_{1}$ above the median, and correct by dividing all counts in $(\\mathbf{x}, \\mathbf{y})$ by $\\log\\!\\left(\\|\\mathbf{x}\\|_{1} + \\|\\mathbf{y}\\|_{1}\\right)$.**\n\n-   **Impact**: Falsely claims log-normalization fixes the integration problem.\n-   **Detector**: This is a crude heuristic. Thresholding total library size at the median is arbitrary and has no connection to the generative model. It would falsely label $50\\%$ of droplets as doublets, which is biologically unrealistic.\n-   **Correction**: Dividing counts by a logarithmic term is an ad-hoc normalization with no probabilistic justification. It does not perform the required unmixing of the two cell profiles.\n-   **Verdict**: **Incorrect**.\n\n**D. Doublets generate convex averages of two single-cell profiles rather than sums. A valid detector assumes a Gaussian likelihood centered at $\\tfrac{1}{2}\\left(\\boldsymbol{\\theta}^{(R)}_k + \\boldsymbol{\\theta}^{(R)}_\\ell\\right)$ for scRNA-seq and $\\tfrac{1}{2}\\left(\\boldsymbol{\\theta}^{(A)}_k + \\boldsymbol{\\theta}^{(A)}_\\ell\\right)$ for scATAC-seq, with a uniform prior over $k \\neq \\ell$; correction replaces $(\\mathbf{x}, \\mathbf{y})$ by their arithmetic mean.**\n\n-   **Impact/Model**: This fundamentally misunderstands the physics of droplet sequencing. Molecules are pooled, so counts are summed, not averaged. The model should be based on the sum of rates $\\boldsymbol{\\theta}_k + \\boldsymbol{\\theta}_\\ell$, not their average.\n-   **Detector**: It proposes using a Gaussian likelihood, contradicting the Poisson model for count data given in the problem.\n-   **Correction**: The proposed correction is nonsensical.\n-   **Verdict**: **Incorrect**.\n\n**E. Doublets distort canonical correlation analysis by merging two cell-type clusters. A valid detector fits an Expectation-Maximization (EM) algorithm with $K$ singleton components and $\\tfrac{K(K-1)}{2}$ doublet components in the latent canonical correlation space, using isotropic Gaussian likelihoods; correction assigns the droplet to the most likely doublet component and back-projects the Gaussian mean to two singletons by halving the latent vector.**\n\n-   **Impact**: The description of distortion in CCA space is plausible.\n-   **Detector/Correction**: This describes an entirely different approach. The problem defines a generative model in the raw count space with Poisson likelihoods. This option proposes a Gaussian mixture model in a latent space derived from CCA. This is not \"consistent with the stated generative assumptions.\" Furthermore, the correction method of halving a latent vector is heuristic and lacks a principled inverse mapping back to the count space.\n-   **Verdict**: **Incorrect**.\n\nIn conclusion, only Option A provides a description, detector, and correction method that are all fully consistent with the established generative model and underlying statistical principles.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}