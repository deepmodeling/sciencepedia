{
    "hands_on_practices": [
        {
            "introduction": "在构建全细胞模型时，一个基础性的决策是确定是否需要考虑空间维度。对于细胞质中的生化反应，我们是应该使用描述均匀混合系统的常微分方程（ODE），还是需要采用考虑分子扩散的偏微分方程（PDE）？本练习将指导你通过量纲分析，从一个反应-扩散系统中推导出关键的无量纲参数——丹姆科勒数（Damköhler number），它量化了反应速率与扩散速率的比值，从而为上述决策提供了定量依据 。",
            "id": "3940236",
            "problem": "一个合成生物学团队正在构建一个全细胞模型，该模型必须将胞质运输与小底物的酶促消耗耦合起来。考虑一个特征长度尺度为 $L$ 的均匀胞质区域，其中浓度为 $c(\\mathbf{x},t)$ 的底物以扩散系数 $D$ 进行扩散，并被空间均匀分布的酶群消耗，其净消耗相对于 $c$ 是伪一级反应，速率常数为 $k$。从标准的反应-扩散质量平衡和菲克定律出发，建立 $c(\\mathbf{x},t)$ 的控制性偏微分方程（PDE），并使用基于 $L$ 的无量纲化来确定量化特征反应速率与跨越长度 $L$ 的特征扩散速率之比的无量纲参数。然后，使用以下针对胞质代谢物和酶系的实际参数值，计算该无量纲参数的值：\n- $k = 3.5\\,\\text{s}^{-1}$\n- $L = 1.2\\,\\mu\\text{m}$\n- $D = 4.8\\,\\mu\\text{m}^{2}\\,\\text{s}^{-1}$\n\n仅报告计算出的无量纲参数的值。将您的答案四舍五入到三位有效数字。最终数字是无量纲的；不要包含单位。",
            "solution": "该问题要求为反应-扩散系统建立控制性偏微分方程（PDE），通过无量纲化确定一个关键的无量纲参数，并计算该参数的值。\n\n首先，我们建立控制性PDE。在控制体积中，物种浓度为 $c(\\mathbf{x}, t)$ 的通用质量平衡由下式给出：\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\mathbf{J} = R\n$$\n其中 $\\frac{\\partial c}{\\partial t}$ 是物种的累积速率，$\\mathbf{J}$ 是摩尔通量，而 $R$ 是单位体积内化学反应的净生成速率。\n\n通量 $\\mathbf{J}$ 由菲克第一扩散定律描述，该定律指出通量与浓度梯度的负值成正比：\n$$\n\\mathbf{J} = -D \\nabla c\n$$\n其中 $D$ 是扩散系数，假定在整个均匀区域内为常数。\n\n反应项 $R$ 代表净生成速率。问题指出底物被一个速率常数为 $k$ 的伪一级反应消耗。因此，消耗速率为 $k c$，净生成速率为 $R = -k c$。\n\n将 $\\mathbf{J}$ 和 $R$ 的表达式代入质量平衡方程，得到：\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot (-D \\nabla c) = -k c\n$$\n假设 $D$ 在空间上是常数，散度算子可以移到其前面，得到拉普拉斯算子 $\\nabla^2 = \\nabla \\cdot \\nabla$：\n$$\n\\frac{\\partial c}{\\partial t} - D \\nabla^2 c = -k c\n$$\n重新整理得到反应-扩散方程的最终形式：\n$$\n\\frac{\\partial c}{\\partial t} = D \\nabla^2 c - k c\n$$\n\n接下来，我们对该方程进行无量纲化。我们为位置、时间和浓度引入无量纲变量。问题指定使用特征长度尺度 $L$ 来处理位置。\n令 $\\tilde{\\mathbf{x}} = \\frac{\\mathbf{x}}{L}$。\n令 $\\tilde{c} = \\frac{c}{c_{ref}}$，其中 $c_{ref}$ 是一个合适的参考浓度（例如，初始或边界浓度），它将被消去。\n令 $\\tilde{t} = \\frac{t}{\\tau}$，其中 $\\tau$ 是一个我们将要确定的特征时间尺度。\n\n我们使用链式法则，用这些新的无量纲变量来表示PDE中的导数：\n$$\n\\frac{\\partial}{\\partial t} = \\frac{\\partial \\tilde{t}}{\\partial t} \\frac{\\partial}{\\partial \\tilde{t}} = \\frac{1}{\\tau} \\frac{\\partial}{\\partial \\tilde{t}}\n$$\n$$\n\\nabla = \\frac{\\partial \\tilde{\\mathbf{x}}}{\\partial \\mathbf{x}} \\tilde{\\nabla} = \\frac{1}{L} \\tilde{\\nabla} \\implies \\nabla^2 = \\frac{1}{L^2} \\tilde{\\nabla}^2\n$$\n将这些代入控制性PDE：\n$$\n\\frac{1}{\\tau} \\frac{\\partial (c_{ref} \\tilde{c})}{\\partial \\tilde{t}} = D \\frac{1}{L^2} \\tilde{\\nabla}^2 (c_{ref} \\tilde{c}) - k (c_{ref} \\tilde{c})\n$$\n由于 $c_{ref}$ 是一个常数，它可以从所有项中提出并消去：\n$$\n\\frac{1}{\\tau} \\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}} = \\frac{D}{L^2} \\tilde{\\nabla}^2 \\tilde{c} - k \\tilde{c}\n$$\n为了使方程无量纲化，我们将参数分组。一种标准方法是选择 $\\tau$，使得扩散项或时间导数项的系数变为1。我们选择特征时间尺度为扩散时间，$\\tau_{diff} = \\frac{L^2}{D}$。\n设 $\\tau = \\frac{L^2}{D}$：\n$$\n\\frac{1}{L^2/D} \\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}} = \\frac{D}{L^2} \\tilde{\\nabla}^2 \\tilde{c} - k \\tilde{c}\n$$\n$$\n\\frac{D}{L^2} \\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}} = \\frac{D}{L^2} \\tilde{\\nabla}^2 \\tilde{c} - k \\tilde{c}\n$$\n将整个方程乘以 $\\frac{L^2}{D}$，得到无量纲形式：\n$$\n\\frac{\\partial \\tilde{c}}{\\partial \\tilde{t}} = \\tilde{\\nabla}^2 \\tilde{c} - \\frac{k L^2}{D} \\tilde{c}\n$$\n无量纲参数是反应项的系数 $\\frac{k L^2}{D}$。该参数量化了反应效应与扩散效应之比。\n\n特征反应速率可以看作是速率常数 $k$（单位为 $\\text{time}^{-1}$）。跨越长度 $L$ 的特征扩散速率是扩散时间的倒数，即 $1/\\tau_{diff} = D/L^2$（单位为 $\\text{time}^{-1}$）。\n因此，特征反应速率与特征扩散速率之比为：\n$$\n\\frac{\\text{反应速率}}{\\text{扩散速率}} = \\frac{k}{D/L^2} = \\frac{k L^2}{D}\n$$\n这个无量纲群通常被称为丹姆科勒数（Damköhler number, $Da$）或赛勒模数（Thiele modulus, $\\phi$）的平方（$\\phi^2$）。\n\n最后，我们使用给定的值计算该参数的值：\n- $k = 3.5\\,\\text{s}^{-1}$\n- $L = 1.2\\,\\mu\\text{m}$\n- $D = 4.8\\,\\mu\\text{m}^{2}\\,\\text{s}^{-1}$\n\n无量纲参数为：\n$$\n\\frac{k L^2}{D} = \\frac{(3.5\\,\\text{s}^{-1}) (1.2\\,\\mu\\text{m})^2}{4.8\\,\\mu\\text{m}^{2}\\,\\text{s}^{-1}}\n$$\n正如预期的那样，单位相互抵消：\n$$\n\\frac{\\text{s}^{-1} \\cdot \\mu\\text{m}^2}{\\mu\\text{m}^2 \\cdot \\text{s}^{-1}} = 1\n$$\n现在，我们计算数值：\n$$\n\\frac{k L^2}{D} = \\frac{3.5 \\times (1.2)^2}{4.8} = \\frac{3.5 \\times 1.44}{4.8} = \\frac{5.04}{4.8} = 1.05\n$$\n问题要求答案四舍五入到三位有效数字。计算值 $1.05$ 已经有三位有效数字。",
            "answer": "$$\\boxed{1.05}$$"
        },
        {
            "introduction": "细胞内部是一个高度拥挤的环境，这种“大分子拥挤”效应使得溶液表现出非理想行为，从而显著影响生化反应速率。本练习将探讨如何将经典的酶动力学模型（如米氏方程）扩展到更真实的细胞环境中。你将学习使用热力学活度（activity）代替浓度来修正质量作用定律，并推导在拥挤条件下表观米氏常数（$K_M^{\\mathrm{app}}$）的表达式，从而深入理解细胞环境如何从机制上调控酶的催化效率 。",
            "id": "3940242",
            "problem": "在全细胞模型中，大分子拥挤通过使溶液变为非理想溶液来改变生物化学反应速率，因此反应速率取决于热力学活度而非浓度。考虑一个酶催化反应，其机理为 $E + S \\rightleftharpoons ES \\rightarrow E + P$，该反应发生在拥挤的细胞质中，其中惰性大分子的体积分数为 $\\phi$。假设广义质量作用定律对基元反应以活度形式成立，其中物种 $i$ 的热力学活度为 $a_i = \\gamma_i c_i$， $c_i$ 是摩尔浓度，$\\gamma_i$ 是活度系数。假设活度系数的拥挤模型如下：$\\ln \\gamma_i = \\beta_i \\frac{\\phi}{1 - \\phi}$，其中 $\\beta_i$ 是一个物种特异性参数，用于描述排斥体积相互作用如何随拥挤程度而变化。\n\n仅从基于活度的速率定律和准稳态近似（QSSA）出发，推导拥挤系统中以浓度单位表示的表观米氏常数 $K_M^{\\mathrm{app}}$，用基元速率常数和活度系数表示。然后，使用推导出的表达式，根据以下参数值计算 $K_M^{\\mathrm{app}}$：\n$\\phi = 0.30$，$\\beta_E = 0.60$，$\\beta_S = 0.30$，$\\beta_{ES} = 0.70$，$k_1 = 5.0 \\times 10^{7}\\,\\mathrm{M^{-1}\\,s^{-1}}$，$k_{-1} = 1.5 \\times 10^{2}\\,\\mathrm{s^{-1}}$ 和 $k_{\\mathrm{cat}} = 5.0 \\times 10^{1}\\,\\mathrm{s^{-1}}$。假设除了在速率定律中使用活度外，$k_1$、$k_{-1}$ 和 $k_{\\mathrm{cat}}$ 不受拥挤影响。将最终数值答案四舍五入到四位有效数字，并以微摩尔（写出对应于 $\\mu\\mathrm{M}$ 的数值）表示。除了计算之外，请解释在该模型下拥挤如何改变有效 $K_M$，并阐明由活度系数引起的任何增加或减少的机理起源。",
            "solution": "该问题被评估为有效。它在科学上基于酶动力学和非理想溶液物理化学的既定原理，问题设定良好，定义和参数完整一致，并以客观、可形式化的语言表达。\n\n表观米氏常数 $K_M^{\\mathrm{app}}$ 的推导是通过将准稳态近似（QSSA）应用于一个酶催化反应，在该反应中，反应速率由热力学活度而非浓度决定。\n\n反应机理如下：\n$$ E + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\stackrel{k_{\\mathrm{cat}}}{\\longrightarrow} E + P $$\n基元反应速率使用广义质量作用定律以活度表示，$a_i = \\gamma_i c_i$，其中 $c_i$ 是物种 $i$ 的摩尔浓度，$\\gamma_i$ 是其活度系数。\n酶-底物复合物 $ES$ 的生成速率为：\n$$ v_{\\text{formation}} = k_1 a_E a_S = k_1 (\\gamma_E c_E) (\\gamma_S c_S) $$\n$ES$ 复合物的分解速率是逆向反应速率和催化步骤速率之和：\n$$ v_{\\text{breakdown}} = k_{-1} a_{ES} + k_{\\mathrm{cat}} a_{ES} = (k_{-1} + k_{\\mathrm{cat}}) a_{ES} = (k_{-1} + k_{\\mathrm{cat}}) (\\gamma_{ES} c_{ES}) $$\n\nQSSA 假设中间复合物的浓度 $c_{ES}$ 迅速达到稳态，使其净变化率约等于零。这意味着生成速率等于分解速率：\n$$ k_1 a_E a_S = (k_{-1} + k_{\\mathrm{cat}}) a_{ES} $$\n代入活度的表达式：\n$$ k_1 \\gamma_E c_E \\gamma_S c_S = (k_{-1} + k_{\\mathrm{cat}}) \\gamma_{ES} c_{ES} $$\n总酶浓度 $c_{E,\\text{tot}}$ 是守恒的：$c_{E,\\text{tot}} = c_E + c_{ES}$。我们可以将游离酶浓度表示为 $c_E = c_{E,\\text{tot}} - c_{ES}$。将其代入稳态方程得到：\n$$ k_1 \\gamma_E (c_{E,\\text{tot}} - c_{ES}) \\gamma_S c_S = (k_{-1} + k_{\\mathrm{cat}}) \\gamma_{ES} c_{ES} $$\n我们的目标是解出 $c_{ES}$：\n$$ k_1 \\gamma_E \\gamma_S c_{E,\\text{tot}} c_S - k_1 \\gamma_E \\gamma_S c_{ES} c_S = (k_{-1} + k_{\\mathrm{cat}}) \\gamma_{ES} c_{ES} $$\n合并含有 $c_{ES}$ 的项：\n$$ k_1 \\gamma_E \\gamma_S c_{E,\\text{tot}} c_S = \\left[ (k_{-1} + k_{\\mathrm{cat}}) \\gamma_{ES} + k_1 \\gamma_E \\gamma_S c_S \\right] c_{ES} $$\n$$ c_{ES} = \\frac{k_1 \\gamma_E \\gamma_S c_{E,\\text{tot}} c_S}{(k_{-1} + k_{\\mathrm{cat}}) \\gamma_{ES} + k_1 \\gamma_E \\gamma_S c_S} $$\n为了将其转化为标准的米氏-孟顿形式，我们将分子和分母同除以 $k_1 \\gamma_E \\gamma_S$ 项：\n$$ c_{ES} = \\frac{c_{E,\\text{tot}} c_S}{\\frac{(k_{-1} + k_{\\mathrm{cat}}) \\gamma_{ES}}{k_1 \\gamma_E \\gamma_S} + c_S} $$\n总反应速率 $v$ 是产物的生成速率，由下式给出：\n$$ v = k_{\\mathrm{cat}} a_{ES} = k_{\\mathrm{cat}} \\gamma_{ES} c_{ES} $$\n代入 $c_{ES}$ 的表达式：\n$$ v = k_{\\mathrm{cat}} \\gamma_{ES} \\frac{c_{E,\\text{tot}} c_S}{\\frac{(k_{-1} + k_{\\mathrm{cat}}) \\gamma_{ES}}{k_1 \\gamma_E \\gamma_S} + c_S} $$\n该方程具有我们熟悉的形式 $v = \\frac{V_{\\mathrm{max}}^{\\mathrm{app}} c_S}{K_M^{\\mathrm{app}} + c_S}$，其中表观最大速率为 $V_{\\mathrm{max}}^{\\mathrm{app}} = k_{\\mathrm{cat}} \\gamma_{ES} c_{E,\\text{tot}}$，表观米氏常数 $K_M^{\\mathrm{app}}$ 为：\n$$ K_M^{\\mathrm{app}} = \\frac{(k_{-1} + k_{\\mathrm{cat}}) \\gamma_{ES}}{k_1 \\gamma_E \\gamma_S} $$\n理想溶液（其中所有 $\\gamma_i = 1$）的米氏常数为 $K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}$。因此，我们可以用理想米氏常数来表示表观米氏常数：\n$$ K_M^{\\mathrm{app}} = K_M \\frac{\\gamma_{ES}}{\\gamma_E \\gamma_S} $$\n\n这个表达式揭示了拥挤如何改变有效 $K_M$。这种调节作用由活度系数的比值 $\\frac{\\gamma_{ES}}{\\gamma_E \\gamma_S}$ 决定。每个活度系数 $\\gamma_i$ 量化了物种 $i$ 由于排斥体积效应而偏离理想行为的程度。$\\gamma_i > 1$ 的值表示在相同浓度下，该物种在拥挤溶液中比在理想溶液中热力学上更不稳定（具有更高的化学势）。\n使用给定的模型 $\\ln \\gamma_i = \\beta_i \\frac{\\phi}{1 - \\phi}$，我们可以进一步分析该比值项：\n$$ \\ln\\left(\\frac{\\gamma_{ES}}{\\gamma_E \\gamma_S}\\right) = \\ln(\\gamma_{ES}) - \\ln(\\gamma_E) - \\ln(\\gamma_S) = \\left(\\beta_{ES} - \\beta_E - \\beta_S\\right) \\frac{\\phi}{1 - \\phi} $$\n所以，该比值为：\n$$ \\frac{\\gamma_{ES}}{\\gamma_E \\gamma_S} = \\exp\\left[ \\left(\\beta_{ES} - \\beta_E - \\beta_S\\right) \\frac{\\phi}{1 - \\phi} \\right] $$\n$\\Delta\\beta = \\beta_{ES} - \\beta_E - \\beta_S$ 项代表了复合物形成时拥挤相互作用参数的净变化。$\\beta_i$ 参数与分子的有效尺寸有关。\n- 如果 $\\Delta\\beta > 0$，则 $ES$ 复合物受到的拥挤去稳定效应比反应物 $E$ 和 $S$ 的总和更强。这不利于复合物的形成，增加了其解离趋势。指数项大于1，因此 $K_M^{\\mathrm{app}} > K_M$，表明表观底物亲和力降低。\n- 如果 $\\Delta\\beta  0$，则 $ES$ 复合物在空间上更“紧凑”，或比反应物受到更弱的排斥体积效应。此时拥挤有利于复合物的形成，这种现象被称为“体积捕获”效应。指数项小于1，因此 $K_M^{\\mathrm{app}}  K_M$，表明表观底物亲和力增加。\n\n现在，我们使用给定的参数计算 $K_M^{\\mathrm{app}}$ 的数值：\n$\\phi = 0.30$，$\\beta_E = 0.60$，$\\beta_S = 0.30$，$\\beta_{ES} = 0.70$，$k_1 = 5.0 \\times 10^{7}\\,\\mathrm{M^{-1}\\,s^{-1}}$，$k_{-1} = 1.5 \\times 10^{2}\\,\\mathrm{s^{-1}}$ 和 $k_{\\mathrm{cat}} = 5.0 \\times 10^{1}\\,\\mathrm{s^{-1}}$。\n\n首先，我们计算理想米氏常数 $K_M$：\n$$ K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1} = \\frac{1.5 \\times 10^{2}\\,\\mathrm{s^{-1}} + 5.0 \\times 10^{1}\\,\\mathrm{s^{-1}}}{5.0 \\times 10^{7}\\,\\mathrm{M^{-1}\\,s^{-1}}} = \\frac{2.0 \\times 10^{2}}{5.0 \\times 10^{7}}\\,\\mathrm{M} = 4.0 \\times 10^{-6}\\,\\mathrm{M} $$\n接下来，我们计算依赖于拥挤的调节因子。拥挤项为：\n$$ \\frac{\\phi}{1 - \\phi} = \\frac{0.30}{1 - 0.30} = \\frac{0.30}{0.70} = \\frac{3}{7} $$\n$\\beta$ 参数的变化为：\n$$ \\Delta\\beta = \\beta_{ES} - \\beta_E - \\beta_S = 0.70 - 0.60 - 0.30 = -0.20 $$\n活度系数比值为：\n$$ \\frac{\\gamma_{ES}}{\\gamma_E \\gamma_S} = \\exp\\left[ \\Delta\\beta \\frac{\\phi}{1 - \\phi} \\right] = \\exp\\left[ (-0.20) \\left(\\frac{3}{7}\\right) \\right] = \\exp\\left(-\\frac{0.6}{7}\\right) $$\n现在，我们计算 $K_M^{\\mathrm{app}}$：\n$$ K_M^{\\mathrm{app}} = K_M \\times \\exp\\left(-\\frac{0.6}{7}\\right) = (4.0 \\times 10^{-6}\\,\\mathrm{M}) \\times \\exp\\left(-\\frac{0.6}{7}\\right) $$\n$$ K_M^{\\mathrm{app}} \\approx (4.0 \\times 10^{-6}\\,\\mathrm{M}) \\times 0.917855 \\approx 3.67142 \\times 10^{-6}\\,\\mathrm{M} $$\n题目要求答案以微摩尔（$\\mu\\mathrm{M}$）为单位。\n$$ K_M^{\\mathrm{app}} \\approx 3.67142\\,\\mu\\mathrm{M} $$\n四舍五入到四位有效数字，结果为 $3.671\\,\\mu\\mathrm{M}$。在这个具体案例中，拥挤导致酶对底物的表观亲和力略有增加。",
            "answer": "$$\n\\boxed{3.671}\n$$"
        },
        {
            "introduction": "现代全细胞模型越来越依赖于整合来自不同来源的多组学数据（如转录组和蛋白质组）来进行校准和验证。本练习将引导你进入贝叶斯推断的世界，学习如何在一个统一的概率框架下融合多组学数据。你将为模型的潜在参数构建后验分布，并进一步将这些参数的不确定性传播到对宏观细胞表型（如倍增时间）的预测中，最终计算出该预测的置信区间 。",
            "id": "3940308",
            "problem": "考虑一个合成生物学建模中的简化全细胞生长表型模型，其中基因表达和蛋白质丰度测量为潜在的通路容量参数提供信息，这些参数又用于预测细胞生长。令潜在参数向量为 $\\boldsymbol{\\theta} \\in \\mathbb{R}^{d}$，代表通路容量。假设一个高斯先验 $\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{m}_0, \\mathbf{S}_0)$，其中 $\\boldsymbol{m}_0 \\in \\mathbb{R}^{d}$ 且 $\\mathbf{S}_0 \\in \\mathbb{R}^{d \\times d}$ 是一个正定矩阵。令RNA测序（RNA-seq）的对数丰度 $\\boldsymbol{z}_r \\in \\mathbb{R}^{n_r}$ 和质谱蛋白质组学（MS）的对数丰度 $\\boldsymbol{z}_p \\in \\mathbb{R}^{n_p}$ 在给定 $\\boldsymbol{\\theta}$ 的条件下条件独立，并建模为线性高斯观测：\n$$\n\\boldsymbol{z}_r \\mid \\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{H}_r \\boldsymbol{\\theta}, \\boldsymbol{\\Sigma}_r), \\quad\n\\boldsymbol{z}_p \\mid \\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{H}_p \\boldsymbol{\\theta}, \\boldsymbol{\\Sigma}_p),\n$$\n其中 $\\mathbf{H}_r \\in \\mathbb{R}^{n_r \\times d}$ 和 $\\mathbf{H}_p \\in \\mathbb{R}^{n_p \\times d}$ 是连接潜在容量与对数丰度的设计矩阵，而 $\\boldsymbol{\\Sigma}_r \\in \\mathbb{R}^{n_r \\times n_r}$ 和 $\\boldsymbol{\\Sigma}_p \\in \\mathbb{R}^{n_p \\times n_p}$ 是已知的正定噪声协方差矩阵，用于捕获测量噪声。假设细胞生长速率 $\\mu$（单位为 $\\mathrm{h}^{-1}$）通过指数-线性链接从 $\\boldsymbol{\\theta}$ 预测得出：\n$$\n\\mu = \\exp\\!\\left(c_0 + \\boldsymbol{c}^{\\top} \\boldsymbol{\\theta}\\right),\n$$\n其中 $\\boldsymbol{c} \\in \\mathbb{R}^{d}$ 且 $c_0 \\in \\mathbb{R}$。倍增时间为 $t_d = \\ln(2)/\\mu$，以小时为单位报告。\n\n任务：\n- 从贝叶斯法则以及指定的高斯先验和高斯似然出发，在给定的独立性假设下，形式化给定 $(\\boldsymbol{z}_r, \\boldsymbol{z}_p)$ 时 $\\boldsymbol{\\theta}$ 的贝叶斯后验分布。\n- 从 $\\boldsymbol{\\theta}$ 的后验分布中，推导出倍增时间 $t_d$ 的导出分布。\n- 对于给定的置信水平 $0.95$，计算 $t_d$ 的 $0.95$ 置信区间的下端点和上端点（以小时为单位）。\n\n科学真实性要求：\n- 将 $\\boldsymbol{\\Sigma}_r$ 和 $\\boldsymbol{\\Sigma}_p$ 视为已知的正定协方差矩阵，反映对数丰度中的测量不确定性。\n- 将 $\\mathbf{H}_r$ 和 $\\mathbf{H}_p$ 视为已知映射，该映射源自于一个全细胞模型中对数丰度对通路容量依赖关系的机理线性化。\n\n您的程序必须实现在线性高斯假设下 $\\boldsymbol{\\theta}$ 后验分布的解析解，然后使用导出分布计算 $t_d$ 的 $0.95$ 置信区间。不要使用基于采样的方法。\n\n物理单位：\n- 所有倍增时间置信区间的端点均以小时报告。\n\n角度单位：\n- 不涉及角度。\n\n百分比：\n- 置信水平使用小数形式 $0.95$。\n\n测试套件：\n在所有案例中均使用 $d = 2$。对于每个案例，所有矩阵和向量都已明确指定。\n\n案例 $1$（一般正常路径）：\n- 先验：$\\boldsymbol{m}_0 = [0.0, 0.0]^{\\top}$，$\\mathbf{S}_0 = \\mathrm{diag}([0.5, 0.5])$。\n- RNA测序：$\\mathbf{H}_r = \\begin{bmatrix}1.0  0.0 \\\\ 0.0  1.0\\end{bmatrix}$，$\\boldsymbol{\\Sigma}_r = \\mathrm{diag}([0.04, 0.04])$，$\\boldsymbol{z}_r = [1.0, 0.5]^{\\top}$。\n- 蛋白质组学：$\\mathbf{H}_p = \\begin{bmatrix}1.0  1.0\\end{bmatrix}$，$\\boldsymbol{\\Sigma}_p = \\mathrm{diag}([0.09])$，$\\boldsymbol{z}_p = [1.2]^{\\top}$。\n- 表型图：$c_0 = -0.3$，$\\boldsymbol{c} = [0.8, 0.4]^{\\top}$。\n\n案例 $2$（高噪声、先验主导的边界）：\n- 先验：$\\boldsymbol{m}_0 = [0.0, 0.0]^{\\top}$，$\\mathbf{S}_0 = \\mathrm{diag}([0.5, 0.5])$。\n- RNA测序：$\\mathbf{H}_r = \\begin{bmatrix}1.0  0.0 \\\\ 0.0  1.0\\end{bmatrix}$，$\\boldsymbol{\\Sigma}_r = \\mathrm{diag}([1.0, 1.0])$，$\\boldsymbol{z}_r = [0.0, 0.0]^{\\top}$。\n- 蛋白质组学：$\\mathbf{H}_p = \\begin{bmatrix}1.0  1.0\\end{bmatrix}$，$\\boldsymbol{\\Sigma}_p = \\mathrm{diag}([1.44])$，$\\boldsymbol{z}_p = [0.0]^{\\top}$。\n- 表型图：$c_0 = -0.3$，$\\boldsymbol{c} = [0.8, 0.4]^{\\top}$。\n\n案例 $3$（低噪声、证据冲突的边缘案例）：\n- 先验：$\\boldsymbol{m}_0 = [0.2, -0.2]^{\\top}$，$\\mathbf{S}_0 = \\mathrm{diag}([1.0, 0.3])$。\n- RNA测序：$\\mathbf{H}_r = \\begin{bmatrix}1.0  0.0 \\\\ 0.0  1.0\\end{bmatrix}$，$\\boldsymbol{\\Sigma}_r = \\mathrm{diag}([0.01, 0.01])$，$\\boldsymbol{z}_r = [2.0, -1.0]^{\\top}$。\n- 蛋白质组学：$\\mathbf{H}_p = \\begin{bmatrix}-0.5  1.5\\end{bmatrix}$，$\\boldsymbol{\\Sigma}_p = \\mathrm{diag}([0.04])$，$\\boldsymbol{z}_p = [0.2]^{\\top}$。\n- 表型图：$c_0 = -0.3$, $\\boldsymbol{c} = [0.8, 0.4]^{\\top}$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表内容为所有案例的结果连接而成，顺序为每个案例的下端点和上端点。例如，输出必须采用 $[\\text{lb}_1,\\text{ub}_1,\\text{lb}_2,\\text{ub}_2,\\text{lb}_3,\\text{ub}_3]$ 的形式，其中每个 $\\text{lb}_i$ 和 $\\text{ub}_i$ 是代表案例 $i$ 的 $t_d$ 的 $0.95$ 置信区间端点（以小时为单位）的浮点数。",
            "solution": "该问题提出了一个有效且适定的贝叶斯推断任务，其基础是系统生物学建模的原理。所有必要的参数和条件都已提供，不存在科学或逻辑上的不一致性。因此，我们可以进行形式化的推导和求解。\n\n问题的核心是利用两种实验数据源——RNA测序丰度 $\\boldsymbol{z}_r$ 和蛋白质组学丰度 $\\boldsymbol{z}_p$——来更新我们关于一组潜在通路容量（由向量 $\\boldsymbol{\\theta} \\in \\mathbb{R}^{d}$ 表示）的知识。我们从关于 $\\boldsymbol{\\theta}$ 的先验信念开始，根据观测数据的似然对其进行更新，最后将 $\\boldsymbol{\\theta}$ 中的不确定性传播到预测的表型，即细胞倍增时间 $t_d$。\n\n**1. 潜在参数 $\\boldsymbol{\\theta}$ 的后验分布**\n\n根据贝叶斯法则，给定数据 $(\\boldsymbol{z}_r, \\boldsymbol{z}_p)$ 时，参数 $\\boldsymbol{\\theta}$ 的后验概率分布与似然和先验的乘积成正比：\n$$\np(\\boldsymbol{\\theta} \\mid \\boldsymbol{z}_r, \\boldsymbol{z}_p) \\propto p(\\boldsymbol{z}_r, \\boldsymbol{z}_p \\mid \\boldsymbol{\\theta}) p(\\boldsymbol{\\theta})\n$$\n问题陈述，RNA测序和蛋白质组学测量在给定 $\\boldsymbol{\\theta}$ 的条件下是条件独立的。因此，联合似然可以分解为：\n$$\np(\\boldsymbol{z}_r, \\boldsymbol{z}_p \\mid \\boldsymbol{\\theta}) = p(\\boldsymbol{z}_r \\mid \\boldsymbol{\\theta}) p(\\boldsymbol{z}_p \\mid \\boldsymbol{\\theta})\n$$\n因此，后验分布与三个高斯分布的乘积成正比：\n$$\np(\\boldsymbol{\\theta} \\mid \\boldsymbol{z}_r, \\boldsymbol{z}_p) \\propto \\mathcal{N}(\\boldsymbol{z}_r \\mid \\mathbf{H}_r \\boldsymbol{\\theta}, \\boldsymbol{\\Sigma}_r) \\cdot \\mathcal{N}(\\boldsymbol{z}_p \\mid \\mathbf{H}_p \\boldsymbol{\\theta}, \\boldsymbol{\\Sigma}_p) \\cdot \\mathcal{N}(\\boldsymbol{\\theta} \\mid \\boldsymbol{m}_0, \\mathbf{S}_0)\n$$\n高斯分布的乘积也是一个高斯分布（在忽略归一化常数的情况下）。后验分布的指数部分是二次型的和。取后验分布的对数（并舍去不依赖于 $\\boldsymbol{\\theta}$ 的项）：\n$$\n\\ln p(\\boldsymbol{\\theta} \\mid \\boldsymbol{z}_r, \\boldsymbol{z}_p) = -\\frac{1}{2} (\\boldsymbol{z}_r - \\mathbf{H}_r \\boldsymbol{\\theta})^{\\top} \\boldsymbol{\\Sigma}_r^{-1} (\\boldsymbol{z}_r - \\mathbf{H}_r \\boldsymbol{\\theta}) - \\frac{1}{2} (\\boldsymbol{z}_p - \\mathbf{H}_p \\boldsymbol{\\theta})^{\\top} \\boldsymbol{\\Sigma}_p^{-1} (\\boldsymbol{z}_p - \\mathbf{H}_p \\boldsymbol{\\theta}) - \\frac{1}{2} (\\boldsymbol{\\theta} - \\boldsymbol{m}_0)^{\\top} \\mathbf{S}_0^{-1} (\\boldsymbol{\\theta} - \\boldsymbol{m}_0) + C\n$$\n为了找到后验高斯分布 $\\boldsymbol{\\theta} \\mid \\boldsymbol{z}_r, \\boldsymbol{z}_p \\sim \\mathcal{N}(\\boldsymbol{m}_{\\text{post}}, \\mathbf{S}_{\\text{post}})$ 的参数，我们展开表达式，并将关于 $\\boldsymbol{\\theta}$ 的二次项和线性项进行分组。得到的后验精度矩阵 $\\mathbf{S}_{\\text{post}}^{-1}$ 是先验精度与来自两个似然函数的信息之和：\n$$\n\\mathbf{S}_{\\text{post}}^{-1} = \\mathbf{S}_0^{-1} + \\mathbf{H}_r^{\\top} \\boldsymbol{\\Sigma}_r^{-1} \\mathbf{H}_r + \\mathbf{H}_p^{\\top} \\boldsymbol{\\Sigma}_p^{-1} \\mathbf{H}_p\n$$\n后验协方差矩阵是精度矩阵的逆：$\\mathbf{S}_{\\text{post}} = (\\mathbf{S}_{\\text{post}}^{-1})^{-1}$。\n\n后验均值 $\\boldsymbol{m}_{\\text{post}}$ 是先验均值和数据隐含均值的精度加权平均：\n$$\n\\boldsymbol{m}_{\\text{post}} = \\mathbf{S}_{\\text{post}} \\left( \\mathbf{S}_0^{-1} \\boldsymbol{m}_0 + \\mathbf{H}_r^{\\top} \\boldsymbol{\\Sigma}_r^{-1} \\boldsymbol{z}_r + \\mathbf{H}_p^{\\top} \\boldsymbol{\\Sigma}_p^{-1} \\boldsymbol{z}_p \\right)\n$$\n\n**2. 倍增时间 $t_d$ 的分布**\n\n倍增时间 $t_d$ 通过一系列变换与 $\\boldsymbol{\\theta}$ 相关。首先，我们定义一个中间变量 $y$，作为对数生长速率的线性预测器：\n$$\ny = c_0 + \\boldsymbol{c}^{\\top} \\boldsymbol{\\theta}\n$$\n由于 $\\boldsymbol{\\theta}$ 服从多元高斯分布，且 $y$ 是 $\\boldsymbol{\\theta}$ 的仿射变换，因此 $y$ 必须服从单变量高斯分布 $y \\sim \\mathcal{N}(\\mu_y, \\sigma_y^2)$。$y$ 的均值和方差可以通过对随机向量线性变换的期望和方差应用标准法则来求得：\n$$\n\\mu_y = E[y] = E[c_0 + \\boldsymbol{c}^{\\top} \\boldsymbol{\\theta}] = c_0 + \\boldsymbol{c}^{\\top} E[\\boldsymbol{\\theta}] = c_0 + \\boldsymbol{c}^{\\top} \\boldsymbol{m}_{\\text{post}}\n$$\n$$\n\\sigma_y^2 = \\text{Var}[y] = \\text{Var}[c_0 + \\boldsymbol{c}^{\\top} \\boldsymbol{\\theta}] = \\text{Var}[\\boldsymbol{c}^{\\top} \\boldsymbol{\\theta}] = \\boldsymbol{c}^{\\top} \\text{Var}[\\boldsymbol{\\theta}] \\boldsymbol{c} = \\boldsymbol{c}^{\\top} \\mathbf{S}_{\\text{post}} \\boldsymbol{c}\n$$\n细胞生长速率为 $\\mu = \\exp(y)$，这意味着 $\\mu$ 服从对数正态分布。倍增时间由下式给出：\n$$\nt_d = \\frac{\\ln(2)}{\\mu} = \\frac{\\ln(2)}{\\exp(y)} = \\ln(2) \\exp(-y)\n$$\n为了找到 $t_d$ 的分布，我们考虑其自然对数 $w = \\ln(t_d)$：\n$$\nw = \\ln(t_d) = \\ln(\\ln(2) \\exp(-y)) = \\ln(\\ln(2)) - y\n$$\n由于 $y$ 是正态分布的，$w$ 也是正态分布的，$w \\sim \\mathcal{N}(\\mu_w, \\sigma_w^2)$。其均值和方差为：\n$$\n\\mu_w = E[w] = E[\\ln(\\ln(2)) - y] = \\ln(\\ln(2)) - \\mu_y\n$$\n$$\n\\sigma_w^2 = \\text{Var}[w] = \\text{Var}[\\ln(\\ln(2)) - y] = (-1)^2 \\text{Var}[y] = \\sigma_y^2\n$$\n因此，倍增时间的对数 $w = \\ln(t_d)$ 服从正态分布，其均值为 $\\mu_w = \\ln(\\ln(2)) - (c_0 + \\boldsymbol{c}^{\\top} \\boldsymbol{m}_{\\text{post}})$，方差为 $\\sigma_w^2 = \\boldsymbol{c}^{\\top} \\mathbf{S}_{\\text{post}} \\boldsymbol{c}$。这意味着倍增时间 $t_d$ 本身服从对数正态分布 $t_d \\sim \\text{Log-Normal}(\\mu_w, \\sigma_w^2)$。\n\n**3. $t_d$ 的置信区间**\n\n$t_d$ 的一个 $0.95$ 置信区间是一个区间 $[L, U]$，使得后验概率 $P(L \\le t_d \\le U) = 0.95$。我们可以通过首先找到正态分布变量 $w = \\ln(t_d)$ 的相应区间，然后对其端点进行变换，来构建一个等尾区间。\n\n对于 $w \\sim \\mathcal{N}(\\mu_w, \\sigma_w^2)$，一个 $0.95$ 的置信区间由 $[\\mu_w + z_{0.025} \\sigma_w, \\mu_w + z_{0.975} \\sigma_w]$ 给出，其中 $z_{0.025}$ 和 $z_{0.975}$ 分别是标准正态分布 $\\mathcal{N}(0, 1)$ 的 $2.5\\%$ 和 $97.5\\%$ 分位数。注意 $z_{0.025} = -z_{0.975}$。对于置信水平 $1-\\alpha=0.95$，令 $z_{\\alpha/2} = z_{0.025}$ 和 $z_{1-\\alpha/2} = z_{0.975}$。\n\n$w$ 的下界是 $w_L = \\mu_w + z_{0.025} \\sigma_w$。\n$w$ 的上界是 $w_U = \\mu_w + z_{0.975} \\sigma_w$。\n\n由于 $t_d = \\exp(w)$ 且指数函数是单调的，因此 $t_d$ 的置信区间可以通过对 $w$ 的区间端点取指数来找到：\n$$\n\\text{下界: } t_{d,L} = \\exp(w_L) = \\exp(\\mu_w + z_{0.025} \\sigma_w)\n$$\n$$\n\\text{上界: } t_{d,U} = \\exp(w_U) = \\exp(\\mu_w + z_{0.975} \\sigma_w)\n$$\n这些公式为置信区间端点提供了解析解，可以进行数值实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef calculate_credible_interval(m0, S0, Hr, Sr, zr, Hp, Sp, zp, c0, c):\n    \"\"\"\n    Computes the 0.95 credible interval for the doubling time td.\n    \n    Args:\n        m0 (np.ndarray): Prior mean vector (d,).\n        S0 (np.ndarray): Prior covariance matrix (d, d).\n        Hr (np.ndarray): Design matrix for RNA-seq (nr, d).\n        Sr (np.ndarray): Covariance matrix for RNA-seq noise (nr, nr).\n        zr (np.ndarray): RNA-seq observation vector (nr,).\n        Hp (np.ndarray): Design matrix for Proteomics (np, d).\n        Sp (np.ndarray): Covariance matrix for Proteomics noise (np, np).\n        zp (np.ndarray): Proteomics observation vector (np,).\n        c0 (float): Scalar offset for phenotype map.\n        c (np.ndarray): Vector for phenotype map (d,).\n\n    Returns:\n        tuple[float, float]: Lower and upper bounds of the 0.95 credible interval for td.\n    \"\"\"\n    # Defensive reshaping of input vectors to column vectors for robust matrix algebra.\n    m0 = m0.reshape(-1, 1)\n    zr = zr.reshape(-1, 1)\n    zp = zp.reshape(-1, 1)\n    c = c.reshape(-1, 1)\n    \n    # 1. Calculate Posterior Distribution Parameters\n    S0_inv = np.linalg.inv(S0)\n    Sr_inv = np.linalg.inv(Sr)\n    Sp_inv = np.linalg.inv(Sp)\n\n    # Posterior precision matrix\n    S_post_inv = S0_inv + Hr.T @ Sr_inv @ Hr + Hp.T @ Sp_inv @ Hp\n    \n    # Posterior covariance matrix\n    S_post = np.linalg.inv(S_post_inv)\n\n    # Term for a posterior mean calculation\n    v = S0_inv @ m0 + Hr.T @ Sr_inv @ zr + Hp.T @ Sp_inv @ zp\n\n    # Posterior mean vector\n    m_post = S_post @ v\n    \n    # 2. Derive Distribution of Doubling Time\n    # y = c0 + c.T @ theta ~ N(mu_y, sigma_y^2)\n    mu_y = c0 + c.T @ m_post\n    sigma_y_sq = c.T @ S_post @ c\n    \n    # w = ln(td) = ln(ln(2)) - y ~ N(mu_w, sigma_w^2)\n    mu_w = np.log(np.log(2.0)) - mu_y\n    sigma_w_sq = sigma_y_sq\n    sigma_w = np.sqrt(sigma_w_sq)\n\n    # 3. Compute Credible Interval\n    credibility_level = 0.95\n    alpha = 1.0 - credibility_level\n    \n    # Get quantiles from standard normal distribution\n    z_lower = norm.ppf(alpha / 2.0)  # e.g., for 0.95 -> 0.025\n    z_upper = norm.ppf(1.0 - alpha / 2.0)  # e.g., for 0.95 -> 0.975\n    \n    # Calculate interval for w = ln(td)\n    w_lower = mu_w + z_lower * sigma_w\n    w_upper = mu_w + z_upper * sigma_w\n    \n    # Transform back to get the interval for td\n    td_lower = np.exp(w_lower)\n    td_upper = np.exp(w_upper)\n\n    # .item() extracts the scalar from a 1x1 array\n    return td_lower.item(), td_upper.item()\n\ndef solve():\n    \"\"\"\n    Defines test cases and runs the solver to produce the final output.\n    \"\"\"\n    test_cases = [\n        # Case 1: General happy path\n        {\n            \"m0\": np.array([0.0, 0.0]),\n            \"S0\": np.diag([0.5, 0.5]),\n            \"Hr\": np.array([[1.0, 0.0], [0.0, 1.0]]),\n            \"Sr\": np.diag([0.04, 0.04]),\n            \"zr\": np.array([1.0, 0.5]),\n            \"Hp\": np.array([[1.0, 1.0]]),\n            \"Sp\": np.diag([0.09]),\n            \"zp\": np.array([1.2]),\n            \"c0\": -0.3,\n            \"c\": np.array([0.8, 0.4])\n        },\n        # Case 2: High-noise, prior-dominated boundary\n        {\n            \"m0\": np.array([0.0, 0.0]),\n            \"S0\": np.diag([0.5, 0.5]),\n            \"Hr\": np.array([[1.0, 0.0], [0.0, 1.0]]),\n            \"Sr\": np.diag([1.0, 1.0]),\n            \"zr\": np.array([0.0, 0.0]),\n            \"Hp\": np.array([[1.0, 1.0]]),\n            \"Sp\": np.diag([1.44]),\n            \"zp\": np.array([0.0]),\n            \"c0\": -0.3,\n            \"c\": np.array([0.8, 0.4])\n        },\n        # Case 3: Low-noise, conflicting evidence edge case\n        {\n            \"m0\": np.array([0.2, -0.2]),\n            \"S0\": np.diag([1.0, 0.3]),\n            \"Hr\": np.array([[1.0, 0.0], [0.0, 1.0]]),\n            \"Sr\": np.diag([0.01, 0.01]),\n            \"zr\": np.array([2.0, -1.0]),\n            \"Hp\": np.array([[-0.5, 1.5]]),\n            \"Sp\": np.diag([0.04]),\n            \"zp\": np.array([0.2]),\n            \"c0\": -0.3,\n            \"c\": np.array([0.8, 0.4])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        lower_bound, upper_bound = calculate_credible_interval(**case)\n        results.extend([lower_bound, upper_bound])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}