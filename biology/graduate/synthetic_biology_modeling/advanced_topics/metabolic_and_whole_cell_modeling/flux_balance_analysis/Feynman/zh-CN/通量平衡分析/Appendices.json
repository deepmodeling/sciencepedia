{
    "hands_on_practices": [
        {
            "introduction": "通量平衡分析的第一步，也是最关键的一步，是将生物化学反应网络转化为数学形式。化学计量矩阵 $S$ 正是这种转化的核心，它精确地描述了网络中每个代谢物在每次反应中的消耗与生成关系。本练习将引导你为一个简化的假设代谢网络构建其化学计量矩阵，这是后续所有 FBA 计算和分析的基础技能 。",
            "id": "2038518",
            "problem": "通量平衡分析 (Flux Balance Analysis, FBA) 是系统生物学中用于预测生物系统中代谢通量分布的一种计算方法。FBA 的一个基石是化学计量矩阵，记为 $S$，它在数学上表示了代谢网络。\n\n考虑一个具有简化代谢网络的假想微生物。该网络由四种内部代谢物（记为 A、B、C 和 D）和一种外部前体代谢物 $M_{in}$ 组成。其新陈代谢由以下一组反应描述：\n\n1.  **摄取反应 ($v_1$):** 细胞输入外部前体 $M_{in}$ 以生成内部代谢物 A。\n    $v_1: M_{in} \\rightarrow A$\n2.  **转换反应 1 ($v_2$):** 代谢物 A 转化为两个单位的代谢物 B。\n    $v_2: A \\rightarrow 2B$\n3.  **转换反应 2 ($v_3$):** 代谢物 A 转化为一个单位的代谢物 C 和一个单位的代谢物 D。\n    $v_3: A \\rightarrow C + D$\n4.  **转换反应 3 ($v_4$):** 代谢物 A 转化为三个单位的代谢物 D。\n    $v_4: A \\rightarrow 3D$\n5.  **B 的交换反应 ($v_{B,ex}$):** 代谢物 B 从细胞中输出。\n    $v_{B,ex}: B \\rightarrow$\n6.  **C 的交换反应 ($v_{C,ex}$):** 代谢物 C 从细胞中输出。\n    $v_{C,ex}: C \\rightarrow$\n7.  **D 的交换反应 ($v_{D,ex}$):** 代谢物 D 从细胞中输出。\n    $v_{D,ex}: D \\rightarrow$\n\n您的任务是为该代谢网络构建化学计量矩阵 $S$。该矩阵的结构应为：行对应内部代谢物的浓度，顺序为 [A, B, C, D]；列对应反应通量，顺序为 [$v_1, v_2, v_3, v_4, v_{B,ex}, v_{C,ex}, v_{D,ex}$]。",
            "solution": "我们构建化学计量矩阵 $S$，其行对应内部代谢物 $[A,B,C,D]$，列对应反应 $[v_{1},v_{2},v_{3},v_{4},v_{B,ex},v_{C,ex},v_{D,ex}]$。根据定义，$S_{i j}$ 是代谢物 $i$ 在反应 $j$ 中的净化学计量系数，生成为正，消耗为负。\n\n对于每个反应：\n- 摄取反应 $v_{1}: M_{in} \\rightarrow A$。内部变化：$A:+1$, $B:0$, $C:0$, $D:0$。\n- 转换反应 $v_{2}: A \\rightarrow 2B$。内部变化：$A:-1$, $B:+2$, $C:0$, $D:0$。\n- 转换反应 $v_{3}: A \\rightarrow C + D$。内部变化：$A:-1$, $B:0$, $C:+1$, $D:+1$。\n- 转换反应 $v_{4}: A \\rightarrow 3D$。内部变化：$A:-1$, $B:0$, $C:0$, $D:+3$。\n- 交换反应 $v_{B,ex}: B \\rightarrow$。内部变化：$B:-1$；其他为 $0$。\n- 交换反应 $v_{C,ex}: C \\rightarrow$。内部变化：$C:-1$；其他为 $0$。\n- 交换反应 $v_{D,ex}: D \\rightarrow$。内部变化：$D:-1$；其他为 $0$。\n\n按行 $[A,B,C,D]$ 和列 $[v_{1},v_{2},v_{3},v_{4},v_{B,ex},v_{C,ex},v_{D,ex}]$ 组合，我们得到\n$$\nS=\\begin{pmatrix}\n1  -1  -1  -1  0  0  0 \\\\\n0  2  0  0  -1  0  0 \\\\\n0  0  1  0  0  -1  0 \\\\\n0  0  1  3  0  0  -1\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\n1  -1  -1  -1  0  0  0 \\\\\n0  2  0  0  -1  0  0 \\\\\n0  0  1  0  0  -1  0 \\\\\n0  0  1  3  0  0  -1\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "标准的 FBA 在最大化目标（如生长速率）时，常常会得到一系列通量分布均可达到最优值的解，但并非所有解在生物学上都是合理的。简约通量平衡分析（pFBA）通过引入第二个优化目标——最小化总通量——来解决这个问题，从而筛选出最“经济”或最高效的代谢途径。这个练习  将挑战你构建并求解一个 pFBA 问题，让你掌握如何从众多最优解中识别出符合细胞资源节约原则的、更具生物学意义的唯一解。",
            "id": "4342817",
            "problem": "考虑一个处于稳态的代谢网络，由化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 和通量向量 $v \\in \\mathbb{R}^{n}$ 描述，其通量边界为 $l \\leq v \\leq u$。稳态假设施加了质量平衡约束 $S v = 0$。设细胞生长速率由线性目标 $c^{\\top} v$ 建模，其中 $c \\in \\mathbb{R}^{n}$ 用于选择生物质反应（$v$ 的一个组分）。简约通量平衡分析 (Parsimonious Flux Balance Analysis, pFBA) 是一种字典序优化，它首先最大化生长，然后在所有最优生长解中最小化总通量大小。从基本的稳态和线性化学计量约束出发，并且不使用任何快捷公式，完成以下任务：\n\n1. 将 pFBA 表述为一个双层优化问题，该问题首先最大化生长 $c^{\\top} v$，然后在所有最优生长解中，最小化总通量 $\\sum_{i=1}^{n} |v_i|$。\n2. 通过引入适当的辅助变量，提出了一个等价的单层线性规划，使得绝对值目标被线性目标替换，同时保持在第一层中获得的最优生长值 $c^{\\top} v = z^{\\star}$。以符号形式提供最终的单层线性规划。\n3. 现在考虑以下具体网络，包含内部代谢物 $A$、$B$ 和 $C$ 以及反应 $R_1$ 到 $R_6$：\n\n- $R_1$: $A_{\\mathrm{ext}} \\rightarrow A$，通量为 $v_1$，边界为 $0 \\leq v_1 \\leq 10$，\n- $R_2$: $A \\rightarrow B$，通量为 $v_2$，边界为 $0 \\leq v_2 \\leq 1000$，\n- $R_3$: $A \\rightarrow C$，通量为 $v_3$，边界为 $0 \\leq v_3 \\leq 1000$，\n- $R_4$: $B + C \\rightarrow \\mathrm{Biomass}$，通量为 $v_4$，边界为 $0 \\leq v_4 \\leq 1000$，\n- $R_5$: $C \\rightarrow C_{\\mathrm{ext}}$，通量为 $v_5$，边界为 $0 \\leq v_5 \\leq 1000$，\n- $R_6$: $B \\rightarrow A$，通量为 $v_6$，边界为 $0 \\leq v_6 \\leq 1000$。\n\n假设 $A$、$B$ 和 $C$ 的内部稳态质量平衡为：\n$$\n\\begin{aligned}\nA: \\quad v_1 - v_2 - v_3 + v_6 = 0, \\\\\nB: \\quad v_2 - v_4 - v_6 = 0, \\\\\nC: \\quad v_3 - v_4 - v_5 = 0.\n\\end{aligned}\n$$\n设生长（生物质）目标为 $c^{\\top} v = v_4$。在上述 pFBA 框架下，计算在所有最大化 $v_4$ 的通量向量 $v$ 中可实现的最小可能总通量\n$$\n\\sum_{i=1}^{6} |v_i|\n$$\n。用 $\\mathrm{mmol}\\cdot\\mathrm{gDW}^{-1}\\cdot\\mathrm{h}^{-1}$ 单位表示您的最终数值答案。提供精确值，不要四舍五入。",
            "solution": "该问题是有效的，将提供完整的解决方案。\n\n### 第 1 部分：pFBA 的双层优化表述\n\n简约通量平衡分析 (pFBA) 是一个字典序优化问题。这意味着它求解一系列优化问题，其中一个问题的最优值成为下一个问题的约束。\n\n首先，我们定义通量向量的可行空间 $\\mathcal{F}$，它包含所有满足稳态和边界约束的通量：\n$$\n\\mathcal{F} = \\{v \\in \\mathbb{R}^n \\mid Sv = 0, l \\le v \\le u\\}\n$$\n优化的第一层是一个标准的 FBA 问题，即最大化细胞生长目标 $c^{\\top} v$。我们将最优生长速率 $z^{\\star}$ 定义为：\n$$\nz^{\\star} = \\max_{v \\in \\mathcal{F}} c^{\\top}v\n$$\n优化的第二层旨在在所有实现此最大生长速率 $z^{\\star}$ 的通量分布中，找到一个最小化总通量大小（即所有通量绝对值之和）的分布。实现最大生长的通量向量集合是：\n$$\n\\mathcal{F}^{\\star} = \\{v \\in \\mathcal{F} \\mid c^{\\top}v = z^{\\star} \\}\n$$\n双层 pFBA 问题可以正式表述为寻找一个向量 $v_{pFBA}$，使其成为以下最小化问题的解：\n$$\n\\min_{v \\in \\mathcal{F}^{\\star}} \\sum_{i=1}^{n} |v_i|\n$$\n这可以紧凑地写成一个字典序优化：\n$$\n\\text{lex max}_{v} \\begin{pmatrix} c^{\\top}v \\\\ -\\sum_{i=1}^{n} |v_i| \\end{pmatrix} \\quad \\text{约束条件为 } v \\in \\mathcal{F}\n$$\n\n### 第 2 部分：等价的单层线性规划\n\n双层优化是顺序求解的。在从第一个 LP 中找到最大生长速率 $z^{\\star}$ 后，构建第二个问题。第二个问题的目标函数 $\\sum_{i=1}^{n} |v_i|$ 是非线性的。为了将其转换为线性规划，我们引入辅助变量。\n\n对于每个通量 $v_i$，我们可以将其表示为两个非负变量 $v_i^{+}$ 和 $v_i^{-}$ 的差：\n$$\nv_i = v_i^{+} - v_i^{-}, \\quad \\text{with } v_i^{+} \\ge 0, v_i^{-} \\ge 0\n$$\n绝对值 $|v_i|$ 随后可以表示为这些变量的和，即 $|v_i| = v_i^{+} + v_i^{-}$。这种表示在最小化问题的背景下是有效的，因为优化会内在性地将两个变量之一（$v_i^{+}$ 或 $v_i^{-}$）驱动为零，以最小化它们的和。\n\n假设 $z^{\\star}$ 已经确定，pFBA 第二步（最小化总通量）的单层线性规划表述如下：\n\n**最小化：**\n$$\n\\sum_{i=1}^{n} (v_i^{+} + v_i^{-})\n$$\n**约束条件：**\n$1.$ 稳态质量平衡：$S(v^{+} - v^{-}) = 0$\n$2.$ 最大生长约束：$c^{\\top}(v^{+} - v^{-}) = z^{\\star}$\n$3.$ 通量边界：$l \\le v^{+} - v^{-} \\le u$\n$4.$ 辅助变量的非负性：对于所有 $i=1, \\dots, n$，$v_i^{+} \\ge 0$ 且 $v_i^{-} \\ge 0$\n\n这里，$v^{+}$ 和 $v^{-}$ 分别是包含 $v_i^{+}$ 和 $v_i^{-}$ 变量的向量。这个表述是一个标准的线性规划。\n\n### 第 3 部分：针对具体网络的 pFBA\n\n我们将两步 pFBA 程序应用于给定的代谢网络。\n\n**步骤 1：最大化生长 ($v_4$)**\n\n问题是在稳态方程和通量边界的约束下最大化 $v_4$。\n稳态方程为：\n$1.$ $v_1 - v_2 - v_3 + v_6 = 0$\n$2.$ $v_2 - v_4 - v_6 = 0 \\implies v_2 = v_4 + v_6$\n$3.$ $v_3 - v_4 - v_5 = 0 \\implies v_3 = v_4 + v_5$\n\n将 $v_2$ 和 $v_3$ 的表达式代入第一个方程：\n$v_1 - (v_4 + v_6) - (v_4 + v_5) + v_6 = 0$\n$v_1 - v_4 - v_6 - v_4 - v_5 + v_6 = 0$\n$v_1 - 2v_4 - v_5 = 0 \\implies v_1 = 2v_4 + v_5$\n\n所有通量 $v_i$ 都被约束为非负。右侧的变量（$v_4, v_5, v_6$）是独立的，受通量边界约束。对 $v_1, v_2, v_3$ 的约束也必须满足。\n关键的边界是 $0 \\le v_1 \\le 10$。代入 $v_1$ 的表达式：\n$0 \\le 2v_4 + v_5 \\le 10$\n\n我们希望最大化 $v_4$。由于 $v_4 \\ge 0$ 且 $v_5 \\ge 0$，项 $2v_4 + v_5$ 总是非负的，因此下界 $0 \\le 2v_4 + v_5$ 得到满足。为了在约束 $2v_4 + v_5 \\le 10$ 下最大化 $v_4$，我们必须使 $v_5$ 尽可能小。$v_5$ 的下界是 $0$。\n设置 $v_5 = 0$，约束变为 $2v_4 \\le 10$，这意味着 $v_4 \\le 5$。因此，最大可能生长速率为 $z^{\\star} = v_{4, \\text{max}} = 5$。\n\n让我们验证对于 $v_4=5$ 是否存在一个有效的通量分布。\n如果 $v_4 = 5$ 且 $v_5 = 0$：\n- $v_1 = 2(5) + 0 = 10$。这满足 $0 \\le v_1 \\le 10$。\n- $v_3 = v_4 + v_5 = 5 + 0 = 5$。这满足 $0 \\le v_3 \\le 1000$。\n- $v_2 = v_4 + v_6 = 5 + v_6$。$v_2$ 的边界是 $0 \\le v_2 \\le 1000$。由于 $v_6 \\ge 0$，$v_2 \\ge 5$，满足下界。上界要求 $5 + v_6 \\le 1000$，所以 $v_6 \\le 995$。\n- $v_6$ 的边界是 $0 \\le v_6 \\le 1000$。因此，对 $v_6$ 的组合约束是 $0 \\le v_6 \\le 995$。\n\n任何具有 $v_4=5$、$v_5=0$ 和 $v_6 \\in [0, 995]$ 的通量向量都将实现最大生长。\n\n**步骤 2：最小化总通量大小**\n\n现在我们最小化总通量和 $\\sum_{i=1}^{6} |v_i|$，约束条件为 $v_4 = 5$。由于所有通量 $v_i$ 都被约束为非负，所以 $|v_i| = v_i$。目标是最小化 $\\sum_{i=1}^{6} v_i$。\n对应于最大生长的通量可以用自由参数 $v_6$ 表示：\n- $v_1 = 10$\n- $v_2 = 5 + v_6$\n- $v_3 = 5$\n- $v_4 = 5$\n- $v_5 = 0$\n- $v_6$ 是变量，且 $v_6 \\in [0, 995]$。\n\n总通量和 $J$ 是：\n$J = v_1 + v_2 + v_3 + v_4 + v_5 + v_6$\n$J = 10 + (5 + v_6) + 5 + 5 + 0 + v_6$\n$J = 25 + 2v_6$\n\n为了最小化 $J$，我们必须从 $v_6$ 的允许范围 $[0, 995]$ 中选择尽可能小的值。最小值为 $v_6 = 0$。\n当 $v_6 = 0$ 时，最小总通量为 $J_{min} = 25 + 2(0) = 25$。\n\n唯一的 pFBA 通量向量是：\n- $v_1 = 10$\n- $v_2 = 5 + 0 = 5$\n- $v_3 = 5$\n- $v_4 = 5$\n- $v_5 = 0$\n- $v_6 = 0$\n\n这些通量之和为 $10 + 5 + 5 + 5 + 0 + 0 = 25$。此值的单位为 $\\mathrm{mmol}\\cdot\\mathrm{gDW}^{-1}\\cdot\\mathrm{h}^{-1}$。",
            "answer": "$$\\boxed{25}$$"
        },
        {
            "introduction": "将 FBA 从分析工具转变为强大的工程设计工具，是合成生物学与代谢工程的核心目标之一。最小切割集（minimal cut sets）的计算正是实现这一目标的关键技术，它旨在识别出为实现特定工程目标（如阻断副产物生成）所需要敲除的最少基因组合，同时保证细胞的存活。这个高级计算实践  将带你深入 FBA 在基因敲除策略预测中的应用，通过算法设计来解决一个对代谢途径进行理性改造的典型问题。",
            "id": "4342819",
            "problem": "您的任务是计算小化学计量模型中通量平衡分析的最小割集，该模型基于稳态假设和质量平衡。基本原理如下。代谢网络由一个化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 表示，其中有 $m$ 种代谢物和 $n$ 个反应。当且仅当 $S v = 0$ 时，通量向量 $v \\in \\mathbb{R}^n$ 处于稳态。每个反应 $j$ 都有上下界 $l_j \\le v_j \\le u_j$，这反映了反应的可逆性和酶的容量。一个不期望的途径由一个特定的目标反应索引 $t \\in \\{0,1,\\dots,n-1\\}$ 和一个最小目标通量 $t_{\\min} \\in \\mathbb{R}_{\\ge 0}$ 来表征。生物质产生由一个非负线性泛函 $b^\\top v$ 表示，其中 $b \\in \\mathbb{R}_{\\ge 0}^n$。生存能力要求存在一个稳态通量 $v$ 使得 $b^\\top v \\ge g_{\\min}$，其中 $g_{\\min} \\in \\mathbb{R}_{\\ge 0}$ 是给定的阈值。\n\n敲除集 $C \\subseteq \\{0,1,\\dots,n-1\\}$ 强制对所有 $j \\in C$ 都有 $v_j = 0$。当且仅当每个满足边界条件和敲除条件的稳态通量 $v$ 也满足 $v_t  t_{\\min}$ 时，敲除集 $C$ 才能阻断不期望的途径。当且仅当存在一个满足边界条件和敲除条件的稳态通量 $v$ 使得 $b^\\top v \\ge g_{\\min}$ 时，敲除集 $C$ 才能维持生长。最小割集是一个包含最小的敲除集 $C$，它同时阻断不期望的途径并维持生长。包含最小意味着 $C$ 的任何真子集都不具备相同的性质。\n\n对于下面的每个测试用例，您的程序必须计算出所有能够阻断不期望途径同时维持生长的包含最小割集。所有反应索引都是从零开始的整数。所有线性可行性和最优性比较必须使用 $10^{-9}$ 的绝对数值公差，并且对阻断使用严格比较，即，当且仅当在约束条件下 $\\max v_t \\le t_{\\min} - 10^{-9}$ 时，目标才被视为已阻断。\n\n您必须为以下三个测试用例生成结果，每个案例都由矩阵 $S$、边界 $(l,u)$、目标反应索引 $t$、生物质系数向量 $b$ 和阈值 $(t_{\\min}, g_{\\min})$ 完全指定。在所有模型中，所有通量都使用任意但一致的单位；无需单位转换。将所有请求的输出表示为整数列表或如下所述的此类列表的列表。\n\n测试用例 1（单分支分泌模型）：\n- 化学计量矩阵 $S \\in \\mathbb{R}^{1 \\times 3}$，代谢物排序为 $\\{A\\}$，反应排序为 $\\{R_0, R_1, R_2\\}$：\n  $$\n  S = \\begin{bmatrix}\n  1  -1  -1\n  \\end{bmatrix}.\n  $$\n  此处，$R_0$ 是摄取 $(\\to A)$，$R_1$ 是生物质 $(A \\to)$，$R_2$ 是分泌 $(A \\to)$。\n- 边界: $l = [0, 0, 0]$, $u = [10, 1000, 1000]$。\n- 目标反应索引: $t = 2$。\n- 生物质目标系数: $b = [0, 1, 0]$，因此 $b^\\top v = v_1$。\n- 阈值: $t_{\\min} = 0.5$, $g_{\\min} = 1.0$。\n\n测试用例 2（双底物生长带有一个不期望的分支）：\n- 化学计量矩阵 $S \\in \\mathbb{R}^{2 \\times 5}$，代谢物排序为 $\\{A_1, A_2\\}$，反应排序为 $\\{R_0, R_1, R_2, R_3, R_4\\}$：\n  $$\n  S = \\begin{bmatrix}\n  1  -1  -1  0  0 \\\\\n  0  0  0  1  -1\n  \\end{bmatrix}.\n  $$\n  此处，$R_0$ 是摄取 $(\\to A_1)$，$R_1$ 是生物质 $(A_1 \\to)$，$R_2$ 是分泌目标 $(A_1 \\to)$，$R_3$ 是第二次摄取 $(\\to A_2)$，$R_4$ 是生物质 $(A_2 \\to)$。\n- 边界: $l = [0, 0, 0, 0, 0]$, $u = [10, 1000, 1000, 10, 1000]$。\n- 目标反应索引: $t = 2$。\n- 生物质目标系数: $b = [0, 1, 0, 0, 1]$，因此 $b^\\top v = v_1 + v_4$。\n- 阈值: $t_{\\min} = 0.5$, $g_{\\min} = 1.0$。\n\n测试用例 3（在所选阈值下目标已不可行）：\n- 化学计量矩阵 $S \\in \\mathbb{R}^{1 \\times 3}$，代谢物排序为 $\\{A\\}$，反应排序为 $\\{R_0, R_1, R_2\\}$：\n  $$\n  S = \\begin{bmatrix}\n  1  -1  -1\n  \\end{bmatrix}.\n  $$\n- 边界: $l = [0, 0, 0]$, $u = [10, 1000, 0.3]$。\n- 目标反应索引: $t = 2$。\n- 生物质目标系数: $b = [0, 1, 0]$。\n- 阈值: $t_{\\min} = 0.5$, $g_{\\min} = 1.0$。\n\n对于每个测试用例，您的程序必须枚举所有能够阻断不期望途径同时维持生长的包含最小敲除集 $C$，并将其作为反应索引的递增列表的列表返回。为确保确定性，在每个测试用例中，首先按基数对最小割集列表进行排序，然后按其元素进行字典序排序。跨测试用例，将每个案例的三个结果汇总到一行输出中，该输出包含一个用方括号括起来的逗号分隔列表，没有空格，例如，“[result1,result2,result3]”。每个结果本身必须是一个整数列表的列表。例如，一个有效的整体输出可能看起来像“[[[1],[3]],[[0]],[[]]]”，具体取决于计算出的最小割集。\n\n所有计算都必须遵守稳态条件 $S v = 0$ 和边界条件 $l \\le v \\le u$，并且必须通过对所有 $j \\in C$ 固定 $v_j = 0$ 来应用敲除。如上所述，使用 $10^{-9}$ 的严格绝对公差进行与 $t_{\\min}$ 和 $g_{\\min}$ 的比较。",
            "solution": "该问题在科学和数学上都得到了明确的定义，为在通量平衡分析背景下计算最小割集提供了完整且一致的规范。这个问题的核心是识别满足两个标准的包含最小的反应敲除集：阻断不期望的代谢通量和维持细胞生长。这是代谢工程中的一项标准任务，可以通过将线性规划与组合搜索相结合来解决。\n\n### 1. 基本原理与数学公式\n\n代谢网络由化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 描述，其中 $m$ 是代谢物的数量，$n$ 是反应的数量。向量 $v \\in \\mathbb{R}^n$ 表示通过这些反应的通量。通量平衡分析的基本原理是稳态假设，该假设规定内部代谢物的浓度不随时间变化。这表示为一个质量平衡方程：\n$$\nS v = 0\n$$\n此外，每个反应通量 $v_j$ 都受到上下界 $l_j \\le v_j \\le u_j$ 的约束，这反映了热力学可逆性和酶的容量。反应敲除（对应于删除一个基因）通过将相应反应 $j$ 的通量设为零来建模，即 $v_j = 0$。对于给定的敲除集 $C \\subseteq \\{0, 1, \\dots, n-1\\}$，对所有 $j \\in C$ 应用约束 $v_j = 0$。\n\n### 2. 形式化割集的条件\n\n如果一个敲除集 $C$ 同时维持生长并阻断目标反应，则它是一个有效的割集。我们必须将这两个条件形式化为可计算验证的查询。两者都可以被表述为线性规划（LPs）。所有可行性和最优性比较都使用 $\\delta = 10^{-9}$ 的数值公差。\n\n#### 生长维持\n问题指出，如果存在一个满足边界和敲除条件的稳态通量向量 $v$，使得生物质产生速率 $b^\\top v$ 至少为 $g_{\\min}$，则生长得以维持。为了检查这一点，我们求解一个线性规划问题，以在给定约束下找到最大可能的生物质产生速率。\n\n设 $g_{\\max}(C)$ 为给定敲除集 $C$ 的以下线性规划的最优值：\n$$\n\\begin{aligned}\n\\text{最大化} \\quad  b^\\top v \\\\\n\\text{约束条件} \\quad  S v = 0 \\\\\n l_j \\le v_j \\le u_j, \\quad \\forall j \\notin C \\\\\n v_j = 0, \\quad \\forall j \\in C\n\\end{aligned}\n$$\n如果该线性规划是可行的，并且其最优值满足 $g_{\\max}(C) \\ge g_{\\min} - \\delta$，则生长维持条件得到满足。如果该线性规划不可行，则不存在通量分布，因此生长无法维持。\n\n#### 目标阻断\n如果对于所有可能的稳态通量向量 $v$（满足边界和敲除条件），通量 $v_t$ 小于阈值 $t_{\\min}$，则目标反应 $t$ 被认为是已阻断。这等同于声明通过反应 $t$ 的最大可能通量小于 $t_{\\min}$。\n\n设 $v_{t, \\max}(C)$ 为以下线性规划的最优值：\n$$\n\\begin{aligned}\n\\text{最大化} \\quad  v_t \\\\\n\\text{约束条件} \\quad  S v = 0 \\\\\n l_j \\le v_j \\le u_j, \\quad \\forall j \\notin C \\\\\n v_j = 0, \\quad \\forall j \\in C\n\\end{aligned}\n$$\n问题为阻断指定了一个严格不等式，该不等式通过公差 $\\delta$ 实现。如果 $v_{t, \\max}(C) \\le t_{\\min} - \\delta$，则阻断条件得到满足。如果此线性规划不可行，意味着对于集合 $C$ 不存在稳态通量向量，这不言自明地意味着对 $v_t$ 的条件对所有（零个）可能的通量向量都成立。因此，不可行性也意味着目标被阻断。\n\n### 3. 最小割集的算法设计\n\n最小割集是一个有效的割集，它不包含任何更小的有效割集作为其真子集。找到所有这些集合的策略如下：\n\n1.  **组合搜索**：由于所提供的测试用例中反应的数量 $n$ 很小（$n \\le 5$），我们可以系统地检查每个可能的反应子集。子集的总数为 $2^n$，这在计算上是可行的。\n2.  **验证**：对于每个候选敲除集 $C$，我们通过求解相应的线性规划来执行上述两个检查。如果 $C$ 同时维持生长并阻断目标，则将其记录为“有效割集”。\n3.  **最小性筛选**：在识别出所有有效割集后，我们筛选此集合以仅保留那些包含最小的割集。如果不存在其他有效割集 $C_2$ 是 $C_1$ 的真子集（即 $C_2 \\subset C_1$），则有效割集 $C_1$ 是最小的。\n4.  **排序**：最终的最小割集列表首先按元素数量（基数）升序排序，然后对大小相同的集合按字典序排序。\n\n基于对问题中提供的三个测试用例的手动和计算分析，得出以下最小割集：\n- **测试用例 1:** 唯一的最小割集是敲除反应2，即 `[[2]]`。\n- **测试用例 2:** 有两个大小为1的最小割集：敲除反应0或敲除反应2。排序后为 `[[0], [2]]`。\n- **测试用例 3:** 目标反应2的通量上限（0.3）已经低于目标阈值（0.5），因此无需敲除即可阻断目标。生长也能维持。因此，唯一的最小割集是空集，即 `[[]]`。\n\n将这三个结果按指定格式组合，得到最终答案。",
            "answer": "[[[2]],[[0],[2]],[[]]]"
        }
    ]
}