{
    "hands_on_practices": [
        {
            "introduction": "将热力学约束整合到FBA中的核心是正确判断反应的可行方向。虽然标准吉布斯自由能（$\\Delta G_j^{\\circ'}$）提供了参考，但反应的实际方向取决于细胞内代谢物的实时浓度。这个练习旨在通过计算实际的吉布斯自由能变化（$\\Delta G_j$），并应用最小驱动力原则来确定热力学上允许的通量方向，从而巩固这项基本技能。",
            "id": "3915794",
            "problem": "一条合成途径中的单一细胞内反应为 $A + 2B \\rightleftharpoons C$。考虑使用在 pH $7$ 下的转换标准吉布斯自由能（记为 $\\Delta G_{j}^{\\circ'}$）将热力学约束整合到通量平衡分析（FBA）中。假设代谢物活性可以很好地用浓度来近似，参考标准浓度 $c^{\\circ} = 1\\ \\mathrm{M}$，并为每种代谢物 $i \\in \\{A,B,C\\}$ 定义无量纲的对数活性变量 $y_{i} = \\ln\\!\\big(a_{i}\\big) = \\ln\\!\\big(c_{i}/c^{\\circ}\\big)$。代谢物 $i$ 的化学势为 $\\mu_{i} = \\mu_{i}^{\\circ'} + RT \\ln\\!\\big(a_{i}\\big)$，其中 $R$ 是通用气体常数，$T$ 是绝对温度。反应吉布斯自由能由化学势的化学计量加和给出，按照惯例，反应物带有负的化学计量系数，产物带有正的化学计量系数。施加一个最小热力学驱动力 $\\varepsilon  0$，使得任何非零通量 $v_{j}$ 都必须满足热力学一致性：$v_{j}$ 的符号必须与 $\\Delta G_{j}$ 的符号相反，且其大小必须超过阈值 $\\varepsilon$。\n\n数据：\n- 转换标准吉布斯自由能：$\\Delta G_{j}^{\\circ'} = -10.0\\ \\mathrm{kJ\\,mol^{-1}}$。\n- 温度：$T = 310\\ \\mathrm{K}$。\n- 气体常数：$R = 8.314 \\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n- 代谢物浓度：$c_{A} = 1.0 \\times 10^{-4}\\ \\mathrm{M}$，$c_{B} = 1.0 \\times 10^{-3}\\ \\mathrm{M}$，$c_{C} = 1.0 \\times 10^{-5}\\ \\mathrm{M}$，其中 $c^{\\circ} = 1\\ \\mathrm{M}$，给出 $y_{A} = \\ln\\!\\big(1.0 \\times 10^{-4}\\big)$、$y_{B} = \\ln\\!\\big(1.0 \\times 10^{-3}\\big)$、$y_{C} = \\ln\\!\\big(1.0 \\times 10^{-5}\\big)$。\n- 最小驱动力：$\\varepsilon = 3.0\\ \\mathrm{kJ\\,mol^{-1}}$。\n\n任务：\n1. 使用上述热力学定义和反应化学计量，计算在给定温度 $T$ 和代谢物活性下，以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的 $\\Delta G_{j}$。\n2. 在最小驱动力 $\\varepsilon$ 的条件下，确定通量 $v_{j}$ 的允许符号，返回一个符号指示符 $s \\in \\{-1, 0, +1\\}$。其中 $+1$ 表示热力学上只允许正向通量（$v_{j} > 0$），$-1$ 表示只允许逆向通量（$v_{j}  0$），$0$ 表示在驱动力阈值下只允许零通量（$v_{j} = 0$）。\n\n答案格式：\n- 返回一个单行矩阵 $\\begin{pmatrix}\\Delta G_{j}  s\\end{pmatrix}$，其中第一个条目是计算出的能量，第二个条目是如上定义的符号指示符。\n- 能量以 $\\mathrm{kJ\\,mol^{-1}}$ 表示，并四舍五入到四位有效数字。",
            "solution": "该问题被认为是有效的，因为它科学地基于化学热力学的基本原理，问题陈述清晰，提供了所有必要的数据，并且其表述是客观的。它要求计算一个反应的吉布斯自由能，并根据指定的驱动力约束确定热力学上可行的通量方向，这是代谢建模中的一个标准程序。\n\n该问题要求两个量：反应的吉布斯自由能 $\\Delta G_{j}$，以及热力学上允许的通量 $v_{j}$ 的符号指示符 $s$。\n\n首先，我们计算反应 $A + 2B \\rightleftharpoons C$ 的吉布斯自由能。根据反应物系数为负、产物系数为正的惯例，各物质的化学计量系数为 $S_{A}=-1$，$S_{B}=-2$ 和 $S_{C}=+1$。\n\n反应吉布斯自由能 $\\Delta G_{j}$ 定义为参与反应的各物质的化学势 $\\mu_{i}$ 的总和，每一项都由其化学计量系数 $S_{i}$ 加权：\n$$ \\Delta G_{j} = \\sum_{i} S_{i} \\mu_{i} $$\n对于给定的反应，展开为：\n$$ \\Delta G_{j} = (1) \\mu_{C} + (-1) \\mu_{A} + (-2) \\mu_{B} = \\mu_{C} - \\mu_{A} - 2\\mu_{B} $$\n每种物质 $i$ 的化学势 $\\mu_{i}$ 由 $\\mu_{i} = \\mu_{i}^{\\circ'} + RT \\ln(a_{i})$ 给出，其中 $\\mu_{i}^{\\circ'}$ 是转换标准化学势，$R$ 是通用气体常数，$T$ 是绝对温度，$a_{i}$ 是物质 $i$ 的活性。问题陈述，活性可以用相对于标准浓度 $c^{\\circ} = 1\\ \\mathrm{M}$ 的浓度 $c_i$ 来近似，即 $a_i = c_i / c^{\\circ}$。问题还定义了无量纲的对数活性变量 $y_i = \\ln(a_i)$。因此，化学势可以写成 $\\mu_{i} = \\mu_{i}^{\\circ'} + RT y_{i}$。\n\n将这个化学势表达式代入 $\\Delta G_{j}$ 的方程中：\n$$ \\Delta G_{j} = (\\mu_{C}^{\\circ'} + RT y_{C}) - (\\mu_{A}^{\\circ'} + RT y_{A}) - 2(\\mu_{B}^{\\circ'} + RT y_{B}) $$\n将标准势项和对数活性项分组：\n$$ \\Delta G_{j} = (\\mu_{C}^{\\circ'} - \\mu_{A}^{\\circ'} - 2\\mu_{B}^{\\circ'}) + RT(y_{C} - y_{A} - 2y_{B}) $$\n项 $(\\mu_{C}^{\\circ'} - \\mu_{A}^{\\circ'} - 2\\mu_{B}^{\\circ'})$ 是反应的转换标准吉布斯自由能 $\\Delta G_{j}^{\\circ'}$。这导出了 $\\Delta G_{j}$ 的最终表达式：\n$$ \\Delta G_{j} = \\Delta G_{j}^{\\circ'} + RT \\sum_{i} S_{i} y_{i} $$\n问题提供了以下数据：$\\Delta G_{j}^{\\circ'} = -10.0\\ \\mathrm{kJ\\,mol^{-1}}$，$R = 8.314 \\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$，以及 $T = 310\\ \\mathrm{K}$。对数活性由 $y_{A} = \\ln(1.0 \\times 10^{-4})$、$y_{B} = \\ln(1.0 \\times 10^{-3})$ 和 $y_{C} = \\ln(1.0 \\times 10^{-5})$ 给出。\n\n我们来计算 $\\sum_{i} S_{i} y_{i}$ 这一项：\n$$ \\sum_{i} S_{i} y_{i} = y_{C} - y_{A} - 2y_{B} = \\ln(1.0 \\times 10^{-5}) - \\ln(1.0 \\times 10^{-4}) - 2\\ln(1.0 \\times 10^{-3}) $$\n使用对数性质 $\\ln(x) - \\ln(y) = \\ln(x/y)$ 和 $c\\ln(x) = \\ln(x^c)$：\n$$ \\sum_{i} S_{i} y_{i} = \\ln\\left(\\frac{1.0 \\times 10^{-5}}{(1.0 \\times 10^{-4}) \\times (1.0 \\times 10^{-3})^{2}}\\right) = \\ln\\left(\\frac{10^{-5}}{10^{-4} \\times 10^{-6}}\\right) = \\ln\\left(\\frac{10^{-5}}{10^{-10}}\\right) = \\ln(10^{5}) $$\n现在我们可以通过代入数值来计算 $\\Delta G_{j}$：\n$$ \\Delta G_{j} = -10.0\\ \\mathrm{kJ\\,mol^{-1}} + (8.314 \\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}) \\times (310\\ \\mathrm{K}) \\times \\ln(10^{5}) $$\n首先，计算乘积 $RT$：\n$$ RT = (8.314 \\times 10^{-3}) \\times 310 \\approx 2.57734\\ \\mathrm{kJ\\,mol^{-1}} $$\n并且 $\\ln(10^5) = 5 \\ln(10) \\approx 5 \\times 2.302585 = 11.512925$：\n$$ \\Delta G_{j} \\approx -10.0 + (2.57734) \\times (11.512925) \\approx -10.0 + 29.67483 $$\n$$ \\Delta G_{j} \\approx 19.67483\\ \\mathrm{kJ\\,mol^{-1}} $$\n按要求四舍五入到四位有效数字，我们得到：\n$$ \\Delta G_{j} = 19.67\\ \\mathrm{kJ\\,mol^{-1}} $$\n这就完成了第一个任务。\n\n对于第二个任务，我们必须确定通量 $v_{j}$ 的允许符号，用指示符 $s$ 表示。热力学约束规定，对于非零通量（$v_{j} \\neq 0$），必须满足两个条件：\n1. 通量的符号必须与反应吉布斯自由能的符号相反：$\\mathrm{sign}(v_{j}) = -\\mathrm{sign}(\\Delta G_{j})$。\n2. 吉布斯自由能的绝对值必须超过最小驱动力阈值 $\\varepsilon$：$|\\Delta G_{j}|  \\varepsilon$。\n\n如果 $|\\Delta G_{j}| \\le \\varepsilon$，则不允许有通量，因此 $v_{j} = 0$ 且 $s=0$。\n我们有 $\\Delta G_{j} \\approx 19.67\\ \\mathrm{kJ\\,mol^{-1}}$ 和 $\\varepsilon = 3.0\\ \\mathrm{kJ\\,mol^{-1}}$。\n首先，检查大小条件：\n$$ |\\Delta G_{j}| = |19.67| = 19.67\\ \\mathrm{kJ\\,mol^{-1}} $$\n由于 $19.67  3.0$，条件 $|\\Delta G_{j}|  \\varepsilon$ 得到满足。因此，非零通量在热力学上是可能的。\n\n接下来，我们确定通量的符号。由于 $\\Delta G_{j} = 19.67\\ \\mathrm{kJ\\,mol^{-1}}$ 是正的，其符号为 $+1$。\n$$ \\mathrm{sign}(\\Delta G_{j}) = +1 $$\n通量符号的规则是：\n$$ \\mathrm{sign}(v_{j}) = -\\mathrm{sign}(\\Delta G_{j}) = -(+1) = -1 $$\n通量符号为 $-1$ 意味着 $v_{j}  0$，这对应于反应向逆方向进行（$C \\rightarrow A + 2B$）。符号指示符 $s$ 定义为 $-1$ 表示仅有逆向通量。\n因此，$s = -1$。\n\n最终答案是一个包含计算出的 $\\Delta G_{j}$ 和符号指示符 $s$ 的行矩阵。\n$$ \\begin{pmatrix}\\Delta G_{j}  s\\end{pmatrix} = \\begin{pmatrix} 19.67  -1 \\end{pmatrix} $$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 19.67  -1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了单个反应的分析之后，下一步是将其应用于整个代谢网络。单个反应的热力学约束会共同塑造网络模型的整个可行解空间，并最终影响其预测的代谢表型。本练习将引导你完成一个完整的建模流程：构建化学计量矩阵，利用热力学计算来设定不可逆反应边界，并求解以获得最优通量分布，从而将局部反应的可行性与全局网络目标联系起来。",
            "id": "3915837",
            "problem": "您的任务是将热力学约束整合到一个最小网络的通量平衡分析（FBA）模型中。考虑三个内部代谢物 $A$、$B$ 和 $C$，以及四个反应 $R_{1}$ 到 $R_{4}$，它们排列成一个线性途径，通过 $B$ 和 $C$ 将外部来源的 $A$ 转化为生物质。该网络由以下关于内部代谢物池的化学计量关系定义：\n- $R_{1}$：外部摄取 $A$ 生成 $A$，对 $A$ 的化学计量系数为 $+1$，对 $B$ 和 $C$ 为 $0$。\n- $R_{2}$：$A \\to B$ 消耗 $A$（化学计量系数为 $-1$）并生成 $B$（化学计量系数为 $+1$），对 $C$ 为 $0$。\n- $R_{3}$：$B \\to C$ 消耗 $B$（化学计量系数为 $-1$）并生成 $C$（化学计量系数为 $+1$），对 $A$ 为 $0$。\n- $R_{4}$：$C \\to \\text{Biomass}$ 消耗 $C$（化学计量系数为 $-1$），对 $A$ 和 $B$ 为 $0$。\n\n使用稳态 FBA 质量平衡方程 $S v = 0$，其中 $S \\in \\mathbb{R}^{3 \\times 4}$ 是关于 $(A,B,C)$ 的化学计量矩阵，而 $v \\in \\mathbb{R}^{4}$ 是反应通量。生物质目标由 $c = (0,0,0,1)^{\\top}$ 表示，优化问题是最大化 $c^{\\top} v$。\n\n通过要求在给定的细胞内条件下，每个正向不可逆反应都必须具有严格为负的吉布斯能量变化 $\\Delta G_{r}  0$ 来整合热力学可行性。使用关系式 $\\Delta G_{r} = \\Delta G^{\\circ}_{r} + R T \\ln Q_{r}$，其中 $R$ 是普适气体常数，$T$ 是绝对温度，$Q_{r}$ 是由细胞内浓度推导出的反应商。假设代谢物的细胞内浓度和标准化学势如下：\n- 细胞内浓度：$c_{A} = 1\\,\\mathrm{mM}$，$c_{B} = 0.1\\,\\mathrm{mM}$，$c_{C} = 0.01\\,\\mathrm{mM}$。\n- 标准化学势：$g^{\\circ}_{A} = -10\\,\\mathrm{kJ\\,mol^{-1}}$，$g^{\\circ}_{B} = -8\\,\\mathrm{kJ\\,mol^{-1}}$，$g^{\\circ}_{C} = -7\\,\\mathrm{kJ\\,mol^{-1}}$。\n- 温度：$T = 310\\,\\mathrm{K}$。\n- 普适气体常数：$R = 8.314 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n\n根据这些值，计算 $R_{2}: A \\to B$ 的 $\\Delta G_{2}$ 和 $R_{3}: B \\to C$ 的 $\\Delta G_{3}$；如果两者均为负，则对 $R_{2}$ 和 $R_{3}$ 强制实施正向不可逆性（即 $v_{2} \\ge 0$，$v_{3} \\ge 0$）。同样将 $R_{1}$（摄取）和 $R_{4}$（生物质形成）视为正向不可逆反应。通量边界（单位为 $\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$）如下：\n- $0 \\le v_{1} \\le 6$,\n- $0 \\le v_{2} \\le 5$,\n- $0 \\le v_{3} \\le 4$,\n- $0 \\le v_{4} \\le 100$.\n\n任务：\n- 编写如上所述的代谢物 $(A,B,C)$ 和反应 $(R_{1},R_{2},R_{3},R_{4})$ 的化学计量矩阵 $S$。\n- 在给定的细胞内条件下，计算 $\\Delta G_{2}$ 和 $\\Delta G_{3}$，并陈述其隐含的方向性约束。\n- 求解 FBA 问题 $\\max_{v} \\, c^{\\top} v$，其约束条件为 $S v = 0$ 和上述边界，并纳入热力学不可逆性约束。\n以行矩阵形式提供最优通量向量 $v^{\\star}$，其元素为 $(v_{1}, v_{2}, v_{3}, v_{4})$。通量单位为 $\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$。如果需要进行任何数值近似，请将答案四舍五入到 $4$ 位有效数字。",
            "solution": "该问题是一个将热力学约束整合到通量平衡分析（FBA）框架中的适定优化任务。我们将分三部分解决它：首先，构建化学计量矩阵；其次，进行热力学可行性分析；第三，求解约束优化问题。\n\n_任务 1：化学计量矩阵 $S$_\n\n该系统涉及 $3$ 个内部代谢物 $(A, B, C)$ 和 $4$ 个反应 $(R_{1}, R_{2}, R_{3}, R_{4})$。化学计量矩阵 $S$ 的维度将是 $3 \\times 4$，其中每一行对应一个代谢物，每一列对应一个反应。元素 $S_{ij}$ 代表代谢物 $i$ 在反应 $j$ 中的化学计量系数。根据问题描述：\n\n- $R_{1}$：外部 $\\to A$。该反应生成 $A$ ($+1$)，对 $B$ 或 $C$ 没有影响。对应 $v_1$ 的列向量是 $(1, 0, 0)^{\\top}$。\n- $R_{2}$：$A \\to B$。该反应消耗 $A$ ($-1$) 并生成 $B$ ($+1$)，对 $C$ 没有影响。对应 $v_2$ 的列向量是 $(-1, 1, 0)^{\\top}$。\n- $R_{3}$：$B \\to C$。该反应消耗 $B$ ($-1$) 并生成 $C$ ($+1$)，对 $A$ 没有影响。对应 $v_3$ 的列向量是 $(0, -1, 1)^{\\top}$。\n- $R_{4}$：$C \\to \\text{Biomass}$。该反应消耗 $C$ ($-1$)，对 $A$ 或 $B$ 没有影响。对应 $v_4$ 的列向量是 $(0, 0, -1)^{\\top}$。\n\n组合这些列向量，化学计量矩阵 $S$ 为：\n$$ S = \\begin{pmatrix} 1  -1  0  0 \\\\ 0  1  -1  0 \\\\ 0  0  1  -1 \\end{pmatrix} $$\n\n_任务 2：热力学可行性分析_\n\n我们必须计算反应 $R_{2}$ 和 $R_{3}$ 的吉布斯自由能变化 ($\\Delta G_{r}$) 以确认其方向性。控制方程为 $\\Delta G_{r} = \\Delta G^{\\circ}_{r} + R T \\ln Q_{r}$。\n\n气体常数 $R$ 和温度 $T$ 的乘积是：\n$$ RT = (8.314 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}) \\times (310\\,\\mathrm{K}) \\approx 2.57734\\,\\mathrm{kJ\\,mol^{-1}} $$\n\n对于反应 $R_{2}: A \\to B$：\n标准吉布斯自由能变化为 $\\Delta G^{\\circ}_{2} = g^{\\circ}_{B} - g^{\\circ}_{A}$。\n$$ \\Delta G^{\\circ}_{2} = (-8\\,\\mathrm{kJ\\,mol^{-1}}) - (-10\\,\\mathrm{kJ\\,mol^{-1}}) = 2\\,\\mathrm{kJ\\,mol^{-1}} $$\n反应商为 $Q_{2} = \\frac{c_{B}}{c_{A}}$。\n$$ Q_{2} = \\frac{0.1\\,\\mathrm{mM}}{1\\,\\mathrm{mM}} = 0.1 $$\n因此，吉布斯自由能变化为：\n$$ \\Delta G_{2} = \\Delta G^{\\circ}_{2} + RT \\ln Q_{2} = 2\\,\\mathrm{kJ\\,mol^{-1}} + (2.57734\\,\\mathrm{kJ\\,mol^{-1}}) \\ln(0.1) $$\n$$ \\Delta G_{2} \\approx 2 + 2.57734 \\times (-2.30259) \\approx 2 - 5.9347 \\approx -3.9347\\,\\mathrm{kJ\\,mol^{-1}} $$\n精确到 $4$ 位有效数字，$\\Delta G_{2} \\approx -3.935\\,\\mathrm{kJ\\,mol^{-1}}$。由于 $\\Delta G_{2}  0$，反应 $R_{2}$ 在正向上是热力学可行的。约束 $v_{2} \\ge 0$ 是合理的。\n\n对于反应 $R_{3}: B \\to C$：\n标准吉布斯自由能变化为 $\\Delta G^{\\circ}_{3} = g^{\\circ}_{C} - g^{\\circ}_{B}$。\n$$ \\Delta G^{\\circ}_{3} = (-7\\,\\mathrm{kJ\\,mol^{-1}}) - (-8\\,\\mathrm{kJ\\,mol^{-1}}) = 1\\,\\mathrm{kJ\\,mol^{-1}} $$\n反应商为 $Q_{3} = \\frac{c_{C}}{c_{B}}$。\n$$ Q_{3} = \\frac{0.01\\,\\mathrm{mM}}{0.1\\,\\mathrm{mM}} = 0.1 $$\n因此，吉布斯自由能变化为：\n$$ \\Delta G_{3} = \\Delta G^{\\circ}_{3} + RT \\ln Q_{3} = 1\\,\\mathrm{kJ\\,mol^{-1}} + (2.57734\\,\\mathrm{kJ\\,mol^{-1}}) \\ln(0.1) $$\n$$ \\Delta G_{3} \\approx 1 - 5.9347 \\approx -4.9347\\,\\mathrm{kJ\\,mol^{-1}} $$\n精确到 $4$ 位有效数字，$\\Delta G_{3} \\approx -4.935\\,\\mathrm{kJ\\,mol^{-1}}$。由于 $\\Delta G_{3}  0$，反应 $R_{3}$ 在正向上也是热力学可行的。约束 $v_{3} \\ge 0$ 是合理的。\n\n问题陈述中还提到 $R_{1}$ 和 $R_{4}$ 也应被视为不可逆反应。因此，所有反应通量都必须是非负的，这与所提供的边界一致。\n\n_任务 3：FBA 优化_\n\nFBA 问题是最大化目标函数 $Z = c^{\\top}v$，其约束条件为稳态质量平衡约束 $S v = 0$ 和通量边界。\n目标向量是 $c = (0, 0, 0, 1)^{\\top}$，所以我们要最大化 $Z = v_{4}$。\n\n由 $S v = 0$ 得到的质量平衡方程组是：\n$$\n\\begin{pmatrix} 1  -1  0  0 \\\\ 0  1  -1  0 \\\\ 0  0  1  -1 \\end{pmatrix}\n\\begin{pmatrix} v_{1} \\\\ v_{2} \\\\ v_{3} \\\\ v_{4} \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这产生了一个线性方程组：\n1. $v_{1} - v_{2} = 0 \\implies v_{1} = v_{2}$\n2. $v_{2} - v_{3} = 0 \\implies v_{2} = v_{3}$\n3. $v_{3} - v_{4} = 0 \\implies v_{3} = v_{4}$\n\n从这些方程可以得出，在稳态下，所有通量必须相等：\n$$ v_{1} = v_{2} = v_{3} = v_{4} $$\n\n设这个共同的通量值为 $v$。问题就变成了最大化 $v_{4} = v$，并满足所有四个反应的通量边界：\n- $0 \\le v_{1} \\le 6 \\implies 0 \\le v \\le 6$\n- $0 \\le v_{2} \\le 5 \\implies 0 \\le v \\le 5$\n- $0 \\le v_{3} \\le 4 \\implies 0 \\le v \\le 4$\n- $0 \\le v_{4} \\le 100 \\implies 0 \\le v \\le 100$\n\n为了同时满足所有这些约束，通量 $v$ 必须小于或等于所有上边界的最小值：\n$$ v \\le \\min(6, 5, 4, 100) $$\n$$ v \\le 4 $$\n$v$ 的最大可能值，也就是目标函数 $v_{4}$ 的最大值，是 $4$。这种情况发生在整个途径的通量受限于反应 $R_{3}$ 的能力时。\n\n通过将所有通量设置为此最大值，可以找到最优通量向量 $v^{\\star}$：\n$$ v_{1}^{\\star} = v_{2}^{\\star} = v_{3}^{\\star} = v_{4}^{\\star} = 4 $$\n这些通量的单位是 $\\mathrm{mmol\\,gDW^{-1}\\,h^{-1}}$。\n\n最优通量向量是 $v^{\\star} = (4, 4, 4, 4)^{\\top}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4  4  4  4 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在实际应用中，将热力学约束集成到全基因组规模模型时，通常需要借助混合整数线性规划（MILP）。这个练习聚焦于一个关键的实际问题：如何正确设置“大M”（big-M）参数来编码逻辑约束。通过本练习，你将学会如何根据代谢物浓度和标准自由能的范围来计算最小的有效$M$值，这对于构建既能保证逻辑正确性又具备数值稳定性的可靠模型至关重要。",
            "id": "3915796",
            "problem": "一个合成生物学模型通过混合整数线性规划（MILP）将通量平衡分析（FBA）与热力学可行性耦合起来。在此表述中，一个二元变量 $y_j \\in \\{0,1\\}$ 编码了这样一个条件：只有当反应 $j$ 的吉布斯自由能变化满足严格为负的条件时，该反应才允许有正向通量。为确保这一点，当 $y_j = 1$ 时，模型强制执行不等式 $\\Delta G_j \\leq -\\varepsilon$，其中 $\\varepsilon  0$ 是一个强制严格为负的小常数。引入一个大常数 $M$（大-$M$ 参数）以便在 $y_j = 0$ 时松弛该不等式，从而使热力学约束在非活动状态下不会无意中限制 $\\Delta G_j$。选择过小的 $M$ 会违反逻辑蕴含关系；选择不必要地大的 $M$ 会在 MILP 中导致数值不稳定性。\n\n考虑一个化学计量为 $A + 2B \\rightarrow C$ 的单一不可逆生化反应 $j$，因此其化学计量系数为 $S_{A j} = -1$、 $S_{B j} = -2$ 和 $S_{C j} = +1$。该反应的吉布斯自由能变化由 $\\Delta G_j = \\sum_i S_{i j} \\mu_i$ 给出，其中代谢物 $i$ 的化学势为 $\\mu_i = \\mu_i^{\\circ'} + RT \\ln c_i$。等价地，反应自由能可以写为 $\\Delta G_j = \\Delta G_j^{\\circ'} + RT \\ln Q_j$，其中反应商为 $Q_j = \\dfrac{c_C}{c_A c_B^2}$。假设以下界限和常数：\n- $\\Delta G_j^{\\circ'} \\in [-5\\,\\mathrm{kJ/mol}, +2\\,\\mathrm{kJ/mol}]$，\n- $c_A \\in [10^{-6}\\,\\mathrm{M}, 10^{-3}\\,\\mathrm{M}]$，$c_B \\in [10^{-6}\\,\\mathrm{M}, 10^{-2}\\,\\mathrm{M}]$，$c_C \\in [10^{-6}\\,\\mathrm{M}, 10^{-2}\\,\\mathrm{M}]$，\n- 普适气体常数 $R = 8.314\\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$，\n- 绝对温度 $T = 310\\,\\mathrm{K}$，\n- 严格性参数 $\\varepsilon = 10^{-3}\\,\\mathrm{kJ/mol}$。\n\n请从第一性原理出发，通过使用由 $\\Delta G_j^{\\circ'}$ 和浓度范围所隐含的 $\\Delta G_j$ 的最坏情况界限，确定大-$M$ 常数 $M$（单位为 $\\mathrm{kJ/mol}$）的最小有效值，该值既能避免数值不稳定性，又能保持蕴含关系的正确性。请选择最佳选项。\n\n选项：\nA. $M = 97\\,\\mathrm{kJ/mol}$\nB. $M = 1000\\,\\mathrm{kJ/mol}$\nC. $M = 2.001\\,\\mathrm{kJ/mol}$\nD. $M = 70\\,\\mathrm{kJ/mol}$\nE. $M = 120\\,\\mathrm{kJ/mol}$",
            "solution": "问题陈述已经过验证，被认为是科学上合理、适定且完整的。所有确定最小有效大-$M$ 常数所需的必要参数和关系均已提供。\n\n该问题描述了一个用于将热力学与通量平衡分析（FBA）耦合的混合整数线性规划（MILP）表述。使用一个二元变量 $y_j \\in \\{0, 1\\}$ 来强制执行逻辑蕴含关系：如果反应 $j$ 具有正向通量（$y_j = 1$），则其吉布斯自由能变化必须严格为负（$\\Delta G_j \\leq -\\varepsilon$，其中 $\\varepsilon  0$）。\n\n标准的“大-$M$”方法被用来将此蕴含关系表述为一个线性约束。问题描述所隐含的约束形式是：\n$$ \\Delta G_j \\leq -\\varepsilon + M(1 - y_j) $$\n\n让我们验证这个表述：\n- 如果 $y_j = 1$，约束变为 $\\Delta G_j \\leq -\\varepsilon + M(1-1)$，简化为 $\\Delta G_j \\leq -\\varepsilon$。这正确地强制执行了负值条件。\n- 如果 $y_j = 0$，约束变为 $\\Delta G_j \\leq -\\varepsilon + M(1-0)$，简化为 $\\Delta G_j \\leq M - \\varepsilon$。这是松弛状态。为了使此约束是非约束性的（即，在反应非活动时不会无意中限制 $\\Delta G_j$ 的值），项 $M - \\varepsilon$ 必须大于或等于 $\\Delta G_j$ 能取到的最大可能值。设这个最大值为 $\\overline{\\Delta G_j}$。\n\n因此，我们要求：\n$$ M - \\varepsilon \\geq \\overline{\\Delta G_j} $$\n为了避免由不必要地大的 $M$ 引起的数值不稳定性，我们应该选择满足此条件的最小可能值 $M$。这个最小值 $M_{min}$ 在等式成立时找到：\n$$ M_{min} = \\overline{\\Delta G_j} + \\varepsilon $$\n\n主要任务是使用所提供的数据计算 $\\Delta G_j$ 的最大可能值。反应 $j$ 的吉布斯自由能变化由以下公式给出：\n$$ \\Delta G_j = \\Delta G_j^{\\circ'} + RT \\ln Q_j $$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度，$\\Delta G_j^{\\circ'}$ 是标准吉布斯自由能变化，$Q_j$ 是反应商。\n\n为了找到 $\\overline{\\Delta G_j}$，我们必须在 $\\Delta G_j$ 的参数的给定范围内将其最大化。由于这些项是相加的，我们可以独立地最大化它们：\n$$ \\overline{\\Delta G_j} = \\max(\\Delta G_j) = \\max(\\Delta G_j^{\\circ'}) + \\max(RT \\ln Q_j) $$\n鉴于 $R$ 和 $T$ 是正常数，最大化 $RT \\ln Q_j$ 等价于最大化 $\\ln Q_j$，这又等价于最大化反应商 $Q_j$。\n\n让我们使用提供的界限：\n- $\\Delta G_j^{\\circ'} \\in [-5, +2]\\,\\mathrm{kJ/mol}$，所以 $\\max(\\Delta G_j^{\\circ'}) = \\overline{\\Delta G_j^{\\circ'}} = +2\\,\\mathrm{kJ/mol}$。\n- 对于反应 $A + 2B \\rightarrow C$，反应商为 $Q_j = \\dfrac{c_C}{c_A c_B^2}$。\n- 为了最大化 $Q_j$，我们必须最大化分子 $c_C$ 并最小化分母 $c_A$ 和 $c_B$。给定的浓度范围是：\n    - $c_A \\in [10^{-6}, 10^{-3}]\\,\\mathrm{M}$\n    - $c_B \\in [10^{-6}, 10^{-2}]\\,\\mathrm{M}$\n    - $c_C \\in [10^{-6}, 10^{-2}]\\,\\mathrm{M}$\n- 极值是：\n    - $\\max(c_C) = 10^{-2}\\,\\mathrm{M}$\n    - $\\min(c_A) = 10^{-6}\\,\\mathrm{M}$\n    - $\\min(c_B) = 10^{-6}\\,\\mathrm{M}$\n\n现在我们计算最大反应商 $\\max(Q_j)$。标准做法是将反应商中的浓度视为被隐式地除以 $1\\,\\mathrm{M}$ 的标准浓度，以确保对数的参数是无量纲的。\n$$ \\max(Q_j) = \\frac{\\max(c_C)}{\\min(c_A) \\min(c_B)^2} = \\frac{10^{-2}}{(10^{-6})(10^{-6})^2} = \\frac{10^{-2}}{10^{-6} \\cdot 10^{-12}} = \\frac{10^{-2}}{10^{-18}} = 10^{16} $$\n\n接下来，我们计算项 $RT$：\n- $R = 8.314 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$\n- $T = 310\\,\\mathrm{K}$\n- $RT = (8.314 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}) \\times (310\\,\\mathrm{K}) \\approx 2.57734\\,\\mathrm{kJ/mol}$\n\n现在，我们可以计算对数项的最大值：\n$$ \\max(RT \\ln Q_j) = RT \\ln(\\max(Q_j)) = (2.57734\\,\\mathrm{kJ/mol}) \\times \\ln(10^{16}) $$\n$$ = (2.57734\\,\\mathrm{kJ/mol}) \\times 16 \\ln(10) $$\n使用近似值 $\\ln(10) \\approx 2.30259$：\n$$ \\max(RT \\ln Q_j) \\approx (2.57734) \\times 16 \\times 2.30259 \\approx 94.950\\,\\mathrm{kJ/mol} $$\n\n我们现在可以找到总的最大吉布斯自由能变化 $\\overline{\\Delta G_j}$：\n$$ \\overline{\\Delta G_j} = \\overline{\\Delta G_j^{\\circ'}} + \\max(RT \\ln Q_j) \\approx 2\\,\\mathrm{kJ/mol} + 94.950\\,\\mathrm{kJ/mol} = 96.950\\,\\mathrm{kJ/mol} $$\n\n最后，我们计算最小的有效大-$M$ 常数 $M_{min}$：\n- $\\varepsilon = 10^{-3}\\,\\mathrm{kJ/mol} = 0.001\\,\\mathrm{kJ/mol}$\n- $M_{min} = \\overline{\\Delta G_j} + \\varepsilon \\approx 96.950\\,\\mathrm{kJ/mol} + 0.001\\,\\mathrm{kJ/mol} = 96.951\\,\\mathrm{kJ/mol}$\n\n$M$ 的最小有效值约为 $96.951\\,\\mathrm{kJ/mol}$。任何小于此值的 $M$ 都可能切掉可行解，从而违反 MILP 模型的逻辑正确性。\n\n现在我们评估给定的选项：\nA. $M = 97\\,\\mathrm{kJ/mol}$：该值略大于计算出的最小所需值 $96.951\\,\\mathrm{kJ/mol}$。这是一个有效的选择。由于该值必须至少为最小值，向上取整到最近的整数是确保有效性的标准做法。这是有效的最小选项。**正确**。\n\nB. $M = 1000\\,\\mathrm{kJ/mol}$：该值远大于所需的最小值 $96.951\\,\\mathrm{kJ/mol}$。虽然它能确保约束的逻辑正确性，但问题明确提到不必要地大的 $M$ “会导致数值不稳定性”。因此，这不是“最小有效值”，并且从数值角度来看是一个糟糕的选择。**错误**。\n\nC. $M = 2.001\\,\\mathrm{kJ/mol}$：该值是按 $\\overline{\\Delta G_j^{\\circ'}} + \\varepsilon = 2 + 0.001$ 计算的。这个计算错误地忽略了来自浓度项 $RT \\ln Q_j$ 的巨大贡献。由于 $2.001\\,\\mathrm{kJ/mol}  96.951\\,\\mathrm{kJ/mol}$，这个 $M$ 的选择太小，会在 $y_j=0$ 时不正确地约束 $\\Delta G_j$。**错误**。\n\nD. $M = 70\\,\\mathrm{kJ/mol}$：该值小于计算出的最小值 $96.951\\,\\mathrm{kJ/mol}$。使用 $M=70\\,\\mathrm{kJ/mol}$ 会在反应非活动时对 $\\Delta G_j$ 施加一个 $M-\\varepsilon = 69.999\\,\\mathrm{kJ/mol}$ 的无效上限，而 $\\Delta G_j$ 的值实际上可以达到约 $96.95\\,\\mathrm{kJ/mol}$。**错误**。\n\nE. $M = 120\\,\\mathrm{kJ/mol}$：该值大于所需的最小值 $96.951\\,\\mathrm{kJ/mol}$，因此是一个有效的选择。然而，它不是选项中*最小*的有效值。选项 A 更小且同样有效，使其成为减轻数值问题的更好选择。**错误**。\n\n根据分析，确保正确性的 $M$ 的最小有效值为 $96.951\\,\\mathrm{kJ/mol}$。在给定的选项中，$M=97\\,\\mathrm{kJ/mol}$ 是大于或等于此最小值的最小选项，因此是最佳选择。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}