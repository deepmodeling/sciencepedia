{
    "hands_on_practices": [
        {
            "introduction": "At the heart of many quorum sensing systems lies a positive feedback loop that creates a sharp, switch-like response. This exercise guides you through a core analysis in systems biology: finding the conditions for bistability in a synthetic autoinduction circuit. By performing a saddle-node bifurcation analysis, you will calculate the critical level of \"leaky\" gene expression that can collapse this biological switch, providing a powerful lesson in circuit robustness .",
            "id": "3920220",
            "problem": "Consider a synthetic quorum sensing module based on acyl-homoserine lactone (AHL) signaling, where each cell produces AHL via the synthase protein LuxI and senses AHL via the transcription factor LuxR. In a well-mixed, high-density population, assume the extracellular AHL concentration equilibrates rapidly with the intracellular concentration and scales proportionally with the synthase level, such that promoter activation can be modeled as a Hill function of the synthase concentration. Let $X$ denote the intracellular LuxI concentration. The production rate of LuxI includes a basal expression (leak) term $\\varepsilon$ and an autoinduction term due to AHL-LuxR activation. The dynamics of $X$ are modeled by the ordinary differential equation (ODE)\n$$\n\\frac{dX}{dt} \\;=\\; \\varepsilon \\;+\\; \\alpha \\,\\frac{X^{n}}{K^{n} + X^{n}} \\;-\\; \\delta\\,X,\n$$\nwhere $\\alpha$ is the maximal induced production rate, $K$ is the effective activation threshold, $n$ is the Hill coefficient, and $\\delta$ is the first-order protein dilution-plus-degradation rate. Assume the following experimentally determined parameter values and biophysical features:\n- The AHL-LuxR transcriptional activation is effectively dimeric at the promoter, so the Hill coefficient is $n=2$.\n- The maximal induced LuxI production rate is $\\alpha = 50\\,\\mathrm{nM\\,min^{-1}}$.\n- The first-order loss rate is $\\delta = 0.02\\,\\mathrm{min^{-1}}$.\n- The effective activation threshold is $K = 1.6\\,\\mathrm{\\mu M} = 1600\\,\\mathrm{nM}$.\n\nStarting from these definitions and the ODE above, analyze how the basal expression $\\varepsilon$ alters the number of steady states by changing the intersection between the production curve and the linear loss term. Derive, from first principles, the condition under which two steady states coalesce (the saddle-node condition), and use it to calculate the critical leak level $\\varepsilon_{c}$ above which the system no longer admits multiple steady states (i.e., bistability is destroyed).\n\nExpress your final answer for $\\varepsilon_{c}$ in $\\mathrm{nM\\,min^{-1}}$ and round your answer to $4$ significant figures.",
            "solution": "The problem asks for the critical basal expression level $\\varepsilon_{c}$ above which a synthetic quorum sensing circuit loses its bistable behavior. The dynamics of the LuxI protein concentration, denoted by $X$, are given by the ordinary differential equation (ODE):\n$$\n\\frac{dX}{dt} = \\varepsilon + \\alpha \\frac{X^{n}}{K^{n} + X^{n}} - \\delta X\n$$\nSteady states, denoted by $X^*$, are concentrations where the system does not change over time, i.e., $\\frac{dX}{dt} = 0$. This gives the steady-state equation:\n$$\n\\delta X^* = \\varepsilon + \\alpha \\frac{(X^*)^{n}}{K^{n} + (X^*)^{n}}\n$$\nThis equation can be interpreted graphically as finding the intersection points between the total production rate curve, $P(X) = \\varepsilon + \\alpha \\frac{X^{n}}{K^{n} + X^{n}}$, and the linear degradation-plus-dilution rate line, $D(X) = \\delta X$. The system is bistable if there are three distinct positive intersection points (i.e., three steady states). Bistability is lost when two of these steady states merge and disappear. This event is a saddle-node bifurcation.\n\nA saddle-node bifurcation occurs when the production curve $P(X)$ is tangent to the degradation line $D(X)$. At such a point, which we denote by the critical concentration $X_c$, two conditions must be satisfied simultaneously:\n1.  The steady-state condition: $P(X_c) = D(X_c)$\n2.  The tangency condition: $\\frac{dP}{dX}\\bigg|_{X=X_c} = \\frac{dD}{dX}\\bigg|_{X=X_c}$\n\nLet's evaluate the derivatives. The derivative of the degradation term is constant:\n$$\n\\frac{dD}{dX} = \\delta\n$$\nThe derivative of the production term is found using the quotient rule for the Hill function part:\n$$\n\\frac{dP}{dX} = \\frac{d}{dX} \\left( \\varepsilon + \\alpha \\frac{X^{n}}{K^{n} + X^{n}} \\right) = \\alpha \\frac{n X^{n-1}(K^n + X^n) - X^n(n X^{n-1})}{(K^n + X^n)^2} = \\frac{\\alpha n K^n X^{n-1}}{(K^n + X^n)^2}\n$$\nThe tangency condition is therefore:\n$$\n\\frac{\\alpha n K^n X_c^{n-1}}{(K^n + X_c^n)^2} = \\delta\n$$\nThis equation determines the critical concentration(s) $X_c$ at which bifurcations occur. The problem provides the parameter values: $n=2$, $\\alpha = 50\\,\\mathrm{nM\\,min^{-1}}$, $\\delta = 0.02\\,\\mathrm{min^{-1}}$, and $K = 1600\\,\\mathrm{nM}$.\n\nSubstituting $n=2$ into the tangency condition, we get:\n$$\n\\frac{2 \\alpha K^2 X_c}{(K^2 + X_c^2)^2} = \\delta\n$$\nTo simplify this equation, we can non-dimensionalize the concentration by letting $x_c = X_c/K$. Substituting $X_c = K x_c$:\n$$\n\\frac{2 \\alpha K^2 (K x_c)}{(K^2 + (K x_c)^2)^2} = \\delta \\implies \\frac{2 \\alpha K^3 x_c}{K^4 (1 + x_c^2)^2} = \\delta \\implies \\frac{2 \\alpha x_c}{K (1 + x_c^2)^2} = \\delta\n$$\nRearranging to solve for $x_c$, we obtain a polynomial equation:\n$$\n(1 + x_c^2)^2 = \\frac{2 \\alpha}{K \\delta} x_c\n$$\n$$\n1 + 2x_c^2 + x_c^4 = \\left(\\frac{2 \\alpha}{K \\delta}\\right) x_c\n$$\nLet's calculate the coefficient $\\frac{2 \\alpha}{K \\delta}$:\n$$\n\\frac{2 \\alpha}{K \\delta} = \\frac{2 \\times 50}{1600 \\times 0.02} = \\frac{100}{32} = 3.125\n$$\nThe equation for the non-dimensional critical concentrations is:\n$$\nx_c^4 + 2x_c^2 - 3.125 x_c + 1 = 0\n$$\nThis quartic equation can have up to four real roots. For a physical system with $X_c>0$, we are interested in positive real roots. Inspection reveals that $x_c = 0.5$ is a root:\n$$\n(0.5)^4 + 2(0.5)^2 - 3.125(0.5) + 1 = 0.0625 + 2(0.25) - 1.5625 + 1 = 0.0625 + 0.5 - 1.5625 + 1 = 1.5625 - 1.5625 = 0\n$$\nThere is another positive real root, which can be shown to be larger than $0.5$. These two roots correspond to two distinct saddle-node bifurcations that define the boundaries of the bistable region for the parameter $\\varepsilon$.\nThe system is bistable for a range of $\\varepsilon$ values, $(\\varepsilon_{c,1}, \\varepsilon_{c,2})$. The problem asks for the critical level $\\varepsilon_c$ *above which* the system is no longer bistable. This corresponds to the upper boundary of the bistable region.\n\nTo find which root corresponds to the upper boundary, we can analyze the function $g(X) = P(X) - D(X) = \\varepsilon + \\alpha \\frac{X^n}{K^n+X^n} - \\delta X$. The steady states are roots of $g(X)=0$. Alternatively, we can define $f(X) = \\alpha \\frac{X^n}{K^n+X^n} - \\delta X$, so that finding steady states is equivalent to solving $f(X) = -\\varepsilon$. The number of steady states is the number of intersections of the curve $y=f(X)$ with the horizontal line $y=-\\varepsilon$. Bistability occurs when $-\\varepsilon$ lies between the local minimum and local maximum of $f(X)$. The bifurcation points $X_c$ are the extrema of $f(X)$, found by setting $f'(X_c)=0$, which is identical to our tangency condition.\nThe second derivative is $f''(X) = \\frac{d}{dX} \\left( \\frac{\\alpha n K^n X^{n-1}}{(K^n + X^n)^2} \\right)$. The sign of $f''(X_c)$ determines if $X_c$ is a local minimum or maximum. The function $\\frac{\\alpha n K^n X^{n-1}}{(K^n + X^n)^2}$ for $n=2$ has a single peak at $X = K/\\sqrt{3}$, or $x=1/\\sqrt{3} \\approx 0.577$. The smaller root $x_c=0.5$ is on the rising slope of this function, so $f''(X_c)>0$, corresponding to a local minimum of $f(X)$. The larger root is on the falling slope, corresponding to a local maximum.\n\nLet $X_{c,min}$ be the location of the local minimum of $f(X)$ and $X_{c,max}$ be the location of the local maximum. The bistable range for $-\\varepsilon$ is $(f(X_{c,min}), f(X_{c,max}))$. This means the bistable range for $\\varepsilon$ is $(-f(X_{c,max}), -f(X_{c,min}))$. The upper critical value $\\varepsilon_c$ is thus $-f(X_{c,min})$.\nWe identified the smaller root as $x_c=0.5$, so $X_{c,min} = 0.5 \\times K$.\n$$\n\\varepsilon_c = -f(X_{c,min}) = -\\left( \\alpha \\frac{X_{c,min}^n}{K^n + X_{c,min}^n} - \\delta X_{c,min} \\right) = \\delta X_{c,min} - \\alpha \\frac{X_{c,min}^n}{K^n + X_{c,min}^n}\n$$\nNow we substitute the values.\n$X_{c,min} = 0.5 \\times K = 0.5 \\times 1600\\,\\mathrm{nM} = 800\\,\\mathrm{nM}$.\n$n=2$.\n$$\n\\varepsilon_c = (0.02\\,\\mathrm{min^{-1}}) \\times (800\\,\\mathrm{nM}) - (50\\,\\mathrm{nM\\,min^{-1}}) \\times \\frac{(800\\,\\mathrm{nM})^2}{(1600\\,\\mathrm{nM})^2 + (800\\,\\mathrm{nM})^2}\n$$\n$$\n\\varepsilon_c = 16\\,\\mathrm{nM\\,min^{-1}} - 50\\,\\mathrm{nM\\,min^{-1}} \\times \\frac{800^2}{1600^2 + 800^2} = 16 - 50 \\times \\frac{1^2}{2^2 + 1^2}\n$$\n$$\n\\varepsilon_c = 16 - 50 \\times \\frac{1}{4+1} = 16 - 50 \\times \\frac{1}{5} = 16 - 10 = 6\\,\\mathrm{nM\\,min^{-1}}\n$$\nThe critical leak level is $\\varepsilon_c = 6\\,\\mathrm{nM\\,min^{-1}}$. The problem asks for the answer to be rounded to $4$ significant figures.",
            "answer": "$$\n\\boxed{6.000}\n$$"
        },
        {
            "introduction": "Cell-cell communication rarely occurs in perfectly mixed environments; cells often live in spatially structured colonies or biofilms. This practice challenges you to model how the spatial distribution of a signaling molecule is shaped by production, degradation, diffusion, and the physical environment at the colony's edge . By comparing different boundary conditions, you will gain insight into how physical containment or exposure dictates whether cells at the periphery can participate in the coordinated response.",
            "id": "3920231",
            "problem": "A single-layer bacterial colony is modeled as a one-dimensional slab occupying $x \\in [0,L]$, with $x=0$ at the colony center and $x=L$ at the colony-air interface. Cells uniformly produce acyl-homoserine lactone (AHL) at volumetric rate $s>0$ and AHL undergoes first-order decay at rate constant $\\delta>0$. AHL diffuses with coefficient $D>0$. The steady-state concentration profile $a(x)$ satisfies the reaction-diffusion partial differential equation (PDE)\n$$\n0 = D \\frac{d^2 a}{dx^2} - \\delta a + s,\n$$\nwith a symmetry condition at the colony center,\n$$\n\\frac{da}{dx}\\bigg|_{x=0} = 0,\n$$\nand one of two possible boundary conditions at the colony-air interface:\n- Neumann (zero-flux): $\\frac{da}{dx}\\big|_{x=L} = 0$,\n- Dirichlet (absorbing): $a(L) = 0$.\n\nAssume a quorum-sensing activation threshold $a_{\\text{th}}>0$, and define periphery activation as the local condition $a(L) \\ge a_{\\text{th}}$ being satisfied at $x=L$.\n\nBased on first principles of diffusion, decay, and boundary conditions, determine which of the following statements are correct.\n\nA. Under a zero-flux Neumann boundary at $x=L$, the steady-state AHL concentration $a(x)$ is spatially uniform and equal to $s/\\delta$, increasing the likelihood of periphery activation relative to an absorbing Dirichlet boundary at $x=L$.\n\nB. An absorbing Dirichlet boundary at $x=L$ forces $a(x)=0$ throughout the colony at steady state, preventing activation everywhere regardless of $D$, $s$, $\\delta$, and $L$.\n\nC. A zero-flux Neumann boundary at $x=L$ necessarily produces a nonzero outward gradient $\\frac{da}{dx}\\big|_{x=L}>0$, lowering edge concentration relative to the center and suppressing periphery activation.\n\nD. With an absorbing Dirichlet boundary at $x=L$, the maximum of $a(x)$ occurs at the periphery ($x=L$), so edge cells are the first to activate.\n\nE. If $a_{\\text{th}}>0$ and $s>0$, then the periphery activation criterion $a(L)\\ge a_{\\text{th}}$ can be satisfied under a Neumann boundary if and only if $s/\\delta \\ge a_{\\text{th}}$, whereas under a Dirichlet boundary $a(L)=0<a_{\\text{th}}$ and periphery activation is impossible.\n\nF. In the Dirichlet case, the edge suppression of $a(x)$ decays into the colony over a characteristic length scale $\\ell = \\sqrt{D/\\delta}$, so when $L \\gg \\ell$ the central concentration approaches $s/\\delta$.",
            "solution": "The problem statement presents a steady-state, one-dimensional reaction-diffusion model for acyl-homoserine lactone (AHL), a signaling molecule in quorum sensing. We must first validate the problem's integrity before deriving a solution.\n\n### Step 1: Extract Givens\n- **Domain:** A one-dimensional slab, $x \\in [0,L]$.\n- **Coordinates:** $x=0$ is the colony center, $x=L$ is the colony-air interface.\n- **Parameters:**\n    - Volumetric production rate of AHL: $s>0$.\n    - First-order decay rate constant of AHL: $\\delta>0$.\n    - Diffusion coefficient of AHL: $D>0$.\n- **Governing Equation:** The steady-state concentration profile $a(x)$ satisfies the ordinary differential equation (ODE):\n$$\n0 = D \\frac{d^2 a}{dx^2} - \\delta a + s\n$$\n- **Boundary Conditions:**\n    1.  Symmetry at the center: $\\frac{da}{dx}\\bigg|_{x=0} = 0$.\n    2.  At the interface ($x=L$), two possible conditions:\n        -   Neumann (zero-flux): $\\frac{da}{dx}\\big|_{x=L} = 0$.\n        -   Dirichlet (absorbing): $a(L) = 0$.\n- **Activation Condition:**\n    - Quorum-sensing activation threshold: $a_{\\text{th}}>0$.\n    - Periphery activation is defined as the condition $a(L) \\ge a_{\\text{th}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a standard reaction-diffusion system, a fundamental model in mathematical biology and chemical engineering.\n- **Scientific Groundedness:** The model is scientifically sound. The steady-state reaction-diffusion equation is a well-established principle for describing the spatial distribution of a substance that is produced, degraded, and diffuses. The parameters $s$, $\\delta$, and $D$ have clear physical meanings.\n- **Well-Posedness:** The problem is well-posed. It consists of a second-order linear ODE with two specified boundary conditions (one at $x=0$ and one at $x=L$) for each case (Neumann or Dirichlet), which guarantees a unique solution.\n- **Objectivity:** The problem is stated in precise, objective mathematical language.\n- **Flaw Checklist:**\n    1.  **Scientific/Factual Unsoundness:** None. The model is a valid and widely used simplification.\n    2.  **Non-Formalizable/Irrelevant:** None. The problem is directly formalizable and relevant.\n    3.  **Incomplete/Contradictory Setup:** None. All necessary components to solve the boundary value problem are provided.\n    4.  **Unrealistic/Infeasible:** None. The model is an idealization but does not violate physical laws.\n    5.  **Ill-Posed/Poorly Structured:** None. The problem is well-posed.\n    6.  **Pseudo-Profound/Trivial/Tautological:** None. The problem requires a correct derivation and analysis of the solutions to a second-order ODE.\n    7.  **Outside Scientific Verifiability:** None. The model is mathematically verifiable.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. We proceed to derive the solution.\n\n### Derivation of the General Solution\nThe governing ODE is:\n$$\nD \\frac{d^2 a}{dx^2} - \\delta a + s = 0\n$$\nRearranging the terms, we get a standard non-homogeneous second-order linear ODE:\n$$\n\\frac{d^2 a}{dx^2} - \\frac{\\delta}{D} a = -\\frac{s}{D}\n$$\nLet's define the characteristic length scale $\\ell = \\sqrt{D/\\delta}$. The equation becomes:\n$$\n\\frac{d^2 a}{dx^2} - \\frac{1}{\\ell^2} a = -\\frac{s}{D}\n$$\nThe general solution $a(x)$ is the sum of a particular solution $a_p(x)$ and the homogeneous solution $a_h(x)$.\n\nA particular solution can be found by inspection. Assuming a constant solution $a_p(x) = C$:\n$$\n0 - \\frac{1}{\\ell^2} C = -\\frac{s}{D} \\implies C = \\frac{s\\ell^2}{D} = \\frac{s(D/\\delta)}{D} = \\frac{s}{\\delta}\n$$\nSo, $a_p(x) = s/\\delta$.\n\nThe homogeneous equation is $\\frac{d^2 a_h}{dx^2} - \\frac{1}{\\ell^2} a_h = 0$. The characteristic equation is $r^2 - 1/\\ell^2 = 0$, with roots $r = \\pm 1/\\ell$. The homogeneous solution is typically written as $a_h(x) = C_1 e^{x/\\ell} + C_2 e^{-x/\\ell}$. For problems with symmetry about $x=0$, it is more convenient to use hyperbolic functions:\n$$\na_h(x) = A \\cosh(x/\\ell) + B \\sinh(x/\\ell)\n$$\nThe general solution is:\n$$\na(x) = A \\cosh(x/\\ell) + B \\sinh(x/\\ell) + \\frac{s}{\\delta}\n$$\nNow, we apply the boundary conditions. The symmetry condition at the center, $\\frac{da}{dx}\\big|_{x=0} = 0$, applies to both cases. First, we find the derivative:\n$$\n\\frac{da}{dx} = \\frac{A}{\\ell} \\sinh(x/\\ell) + \\frac{B}{\\ell} \\cosh(x/\\ell)\n$$\nAt $x=0$:\n$$\n\\frac{da}{dx}\\bigg|_{x=0} = \\frac{A}{\\ell} \\sinh(0) + \\frac{B}{\\ell} \\cosh(0) = \\frac{A}{\\ell}(0) + \\frac{B}{\\ell}(1) = \\frac{B}{\\ell}\n$$\nSince $\\frac{B}{\\ell} = 0$ and $\\ell \\neq 0$, we must have $B=0$. The solution form for both cases simplifies to:\n$$\na(x) = A \\cosh(x/\\ell) + \\frac{s}{\\delta}\n$$\n\n### Case 1: Neumann (zero-flux) boundary at $x=L$\nThe boundary condition is $\\frac{da}{dx}\\big|_{x=L} = 0$. With $B=0$, the derivative is $\\frac{da}{dx} = \\frac{A}{\\ell} \\sinh(x/\\ell)$.\n$$\n\\frac{da}{dx}\\bigg|_{x=L} = \\frac{A}{\\ell} \\sinh(L/\\ell) = 0\n$$\nSince $L>0$ and $\\ell>0$, $L/\\ell > 0$, which means $\\sinh(L/\\ell) \\neq 0$. Therefore, the constant $A$ must be zero.\nWith $A=0$, the solution for the Neumann case is:\n$$\na(x) = \\frac{s}{\\delta}\n$$\nThe concentration is constant throughout the colony.\n\n### Case 2: Dirichlet (absorbing) boundary at $x=L$\nThe boundary condition is $a(L) = 0$. Applying this to the simplified general solution:\n$$\na(L) = A \\cosh(L/\\ell) + \\frac{s}{\\delta} = 0\n$$\nSolving for $A$:\n$$\nA = -\\frac{s/\\delta}{\\cosh(L/\\ell)}\n$$\nSubstituting $A$ back into the solution, we get:\n$$\na(x) = \\frac{s}{\\delta} - \\frac{s/\\delta}{\\cosh(L/\\ell)} \\cosh(x/\\ell) = \\frac{s}{\\delta} \\left( 1 - \\frac{\\cosh(x/\\ell)}{\\cosh(L/\\ell)} \\right)\n$$\nThis is the concentration profile for the Dirichlet case.\n\n### Option-by-Option Analysis\n\n**A. Under a zero-flux Neumann boundary at $x=L$, the steady-state AHL concentration $a(x)$ is spatially uniform and equal to $s/\\delta$, increasing the likelihood of periphery activation relative to an absorbing Dirichlet boundary at $x=L$.**\n- Our derivation for the Neumann case yields $a(x) = s/\\delta$, which is spatially uniform. This part is correct.\n- For periphery activation, we check the condition $a(L) \\ge a_{\\text{th}}$.\n  - In the Neumann case: $a(L) = s/\\delta$. Activation occurs if $s/\\delta \\ge a_{\\text{th}}$.\n  - In the Dirichlet case: $a(L) = 0$ by definition. Activation requires $0 \\ge a_{\\text{th}}$. Since we are given $a_{\\text{th}} > 0$, this is impossible.\n- The Neumann boundary allows for periphery activation (if $s/\\delta$ is large enough), whereas the Dirichlet boundary makes it impossible. Therefore, the Neumann boundary increases the likelihood of periphery activation.\n- **Verdict: Correct.**\n\n**B. An absorbing Dirichlet boundary at $x=L$ forces $a(x)=0$ throughout the colony at steady state, preventing activation everywhere regardless of $D$, $s$, $\\delta$, and $L$.**\n- The solution for the Dirichlet case is $a(x) = \\frac{s}{\\delta} \\left( 1 - \\frac{\\cosh(x/\\ell)}{\\cosh(L/\\ell)} \\right)$.\n- This is not identically zero. For example, at the center ($x=0$), $a(0) = \\frac{s}{\\delta} \\left( 1 - \\frac{1}{\\cosh(L/\\ell)} \\right)$. Since $L>0$ and $\\ell>0$, $\\cosh(L/\\ell)>1$, so $a(0)>0$.\n- The statement that $a(x)=0$ throughout the colony is false.\n- **Verdict: Incorrect.**\n\n**C. A zero-flux Neumann boundary at $x=L$ necessarily produces a nonzero outward gradient $\\frac{da}{dx}\\big|_{x=L}>0$, lowering edge concentration relative to the center and suppressing periphery activation.**\n- The Neumann boundary condition is explicitly defined as `zero-flux`: $\\frac{da}{dx}\\big|_{x=L} = 0$.\n- The statement directly contradicts the problem definition. Our derived solution, $a(x) = s/\\delta$, has a gradient of zero everywhere.\n- **Verdict: Incorrect.**\n\n**D. With an absorbing Dirichlet boundary at $x=L$, the maximum of $a(x)$ occurs at the periphery ($x=L$), so edge cells are the first to activate.**\n- The solution is $a(x) = \\frac{s}{\\delta} \\left( 1 - \\frac{\\cosh(x/\\ell)}{\\cosh(L/\\ell)} \\right)$. Its derivative is $\\frac{da}{dx} = -\\frac{s}{\\delta\\ell} \\frac{\\sinh(x/\\ell)}{\\cosh(L/\\ell)}$.\n- For $x \\in (0, L]$, all terms on the right-hand side ($s$, $\\delta$, $\\ell$, $\\sinh(x/\\ell)$, $\\cosh(L/\\ell)$) are positive. Thus, $\\frac{da}{dx} < 0$.\n- A negative derivative means the function $a(x)$ is strictly decreasing on the interval $[0, L]$.\n- The maximum concentration occurs at $x=0$ (the center), and the minimum occurs at $x=L$ (the periphery), where $a(L)=0$.\n- The statement is therefore false.\n- **Verdict: Incorrect.**\n\n**E. If $a_{\\text{th}}>0$ and $s>0$, then the periphery activation criterion $a(L)\\ge a_{\\text{th}}$ can be satisfied under a Neumann boundary if and only if $s/\\delta \\ge a_{\\text{th}}$, whereas under a Dirichlet boundary $a(L)=0<a_{\\text{th}}$ and periphery activation is impossible.**\n- **Neumann part:** From our derivation, $a(L) = s/\\delta$. The condition $a(L) \\ge a_{\\text{th}}$ is thus equivalent to $s/\\delta \\ge a_{\\text{th}}$. This statement is correct.\n- **Dirichlet part:** The boundary condition is $a(L)=0$. The activation criterion $a(L) \\ge a_{\\text{th}}$ becomes $0 \\ge a_{\\text{th}}$. Since it's given that $a_{\\text{th}}>0$, this condition can never be met. Periphery activation is impossible. This statement is also correct.\n- The entire statement is a complete and accurate summary of the conditions for periphery activation.\n- **Verdict: Correct.**\n\n**F. In the Dirichlet case, the edge suppression of $a(x)$ decays into the colony over a characteristic length scale $\\ell = \\sqrt{D/\\delta}$, so when $L \\gg \\ell$ the central concentration approaches $s/\\delta$.**\n- The concentration at the center ($x=0$) is $a(0) = \\frac{s}{\\delta} \\left( 1 - \\frac{1}{\\cosh(L/\\ell)} \\right)$.\n- The characteristic length scale is indeed $\\ell = \\sqrt{D/\\delta}$ as derived from the original ODE.\n- The condition $L \\gg \\ell$ means the ratio $L/\\ell$ is very large. We examine the limit as $L/\\ell \\to \\infty$.\n- As $z \\to \\infty$, $\\cosh(z) \\to \\infty$, so $\\frac{1}{\\cosh(z)} \\to 0$.\n- Therefore, $\\lim_{L/\\ell \\to \\infty} a(0) = \\lim_{L/\\ell \\to \\infty} \\frac{s}{\\delta} \\left( 1 - \\frac{1}{\\cosh(L/\\ell)} \\right) = \\frac{s}{\\delta} (1 - 0) = \\frac{s}{\\delta}$.\n- The statement is correct. Physically, this means that for a very large colony (relative to the diffusion length scale), the center concentration is not affected by the absorbing boundary at the edge and reaches the value $s/\\delta$ that would be seen in an infinite medium.\n- **Verdict: Correct.**",
            "answer": "$$\\boxed{AEF}$$"
        },
        {
            "introduction": "Deterministic models describe the average behavior of a large population, but they miss the inherent randomness of molecular events that causes cell-to-cell variability. This computational exercise takes you to the frontier of modeling by having you implement the Gillespie Stochastic Simulation Algorithm (SSA) to capture these random fluctuations in a small population . You will quantify the distribution of activation times, revealing how noise shapes the dynamics of quorum sensing at the single-cell level.",
            "id": "3920278",
            "problem": "Design and implement a stochastic simulation algorithm based on the Gillespie method for a quorum sensing system in synthetic biology, focusing on a small population of cells that communicate via a shared pool of Acyl-Homoserine Lactone (AHL). The goal is to model the distribution of first activation times across the population, where activation for a cell occurs when the number of internal AHL-bound transcription factor complexes reaches a threshold. You must derive the reaction propensities from first principles and implement the simulation to compute summary statistics of the activation time distribution. All time units must be expressed in seconds. All reported fractions must be expressed as decimal numbers, not with a percentage sign.\n\nStart from the following fundamental base:\n- The Chemical Master Equation governs the evolution of probability distributions for discrete-state, continuous-time Markov processes in well-mixed systems, and underpins the Gillespie Stochastic Simulation Algorithm (SSA).\n- Mass-action kinetics for reaction propensities are adopted for binding and unbinding in discrete molecule-number space.\n- The Gillespie SSA generates exact sample paths by selecting the next reaction and time increment based on the total propensity, without approximations.\n\nModel definition:\n- There is a shared extracellular pool of AHL with molecule count $M(t)$ at time $t$, assumed to be well-mixed.\n- There are $N$ cells indexed by $i \\in \\{1,2,\\dots,N\\}$, each expressing a fixed total number $R_{\\mathrm{tot}}$ of transcription factor monomers (LuxR), denoted $R_i(t)$ for free monomers and $X_i(t)$ for AHL-bound active complexes, with the constraint $R_i(t) + X_i(t) = R_{\\mathrm{tot}}$ for each $i$.\n- AHL is produced constitutively by each cell and added to the shared pool.\n- AHL in the pool degrades spontaneously.\n- Binding of AHL from the pool to $R_i$ in cell $i$ forms $X_i$, consuming one AHL molecule from the pool. Unbinding of $X_i$ in cell $i$ releases one AHL molecule to the pool and restores $R_i$.\n- Activation for cell $i$ occurs at the first time $\\tau_i$ when $X_i(t)$ reaches or exceeds a threshold $H$, i.e., $\\tau_i = \\inf\\{t \\ge 0 \\mid X_i(t) \\ge H\\}$. If a cell does not activate by time $T_{\\max}$, define $\\tau_i = -1$.\n\nReaction channels and propensities:\n- AHL production aggregated over all cells: $M \\to M+1$ with propensity $a_{\\mathrm{prod}} = \\alpha N$, where $\\alpha$ is the per-cell production rate in $\\mathrm{s}^{-1}$.\n- AHL degradation in the pool: $M \\to M-1$ with propensity $a_{\\mathrm{deg}} = \\delta M$, where $\\delta$ is the degradation rate per molecule in $\\mathrm{s}^{-1}$.\n- Binding in cell $i$: $R_i + M \\to X_i$ with propensity $a_{\\mathrm{bind},i} = k_{\\mathrm{on}} R_i M$, where $k_{\\mathrm{on}}$ is an effective bimolecular rate in $\\mathrm{s}^{-1}$ for discrete molecule numbers.\n- Unbinding in cell $i$: $X_i \\to R_i + M$ with propensity $a_{\\mathrm{unbind},i} = k_{\\mathrm{off}} X_i$, where $k_{\\mathrm{off}}$ is the unbinding rate in $\\mathrm{s}^{-1}$.\n\nInitial conditions and parameters:\n- At time $t=0$, set $M(0) = 0$, $X_i(0) = 0$, and $R_i(0) = R_{\\mathrm{tot}}$ for all $i$.\n- Simulation proceeds until either all cells have recorded $\\tau_i \\ge 0$ or until $t \\ge T_{\\max}$ or until the total propensity becomes zero.\n- Activation threshold $H$ is a positive integer.\n\nOutputs for each parameter set:\n- The fraction of activated cells $f = \\frac{\\#\\{i \\mid \\tau_i \\ge 0\\}}{N}$ as a decimal.\n- The mean activation time $\\bar{\\tau}$ computed over the subset of cells with $\\tau_i \\ge 0$, in seconds. If no cells activate, report $\\bar{\\tau} = -1.0$.\n- The standard deviation $\\sigma_{\\tau}$ of activation times over the subset of cells with $\\tau_i \\ge 0$, in seconds, using the population standard deviation. If no cells activate, report $\\sigma_{\\tau} = -1.0$.\n\nYour program must implement the Gillespie SSA to generate one realization per parameter set using a fixed seed for the random number generator for reproducibility. For each parameter set, compute and return the list $[f, \\bar{\\tau}, \\sigma_{\\tau}]$.\n\nTest suite:\n- Case $1$ (baseline): $N=50$, $\\alpha = 0.02\\,\\mathrm{s}^{-1}$, $\\delta = 0.001\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{on}} = 2\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{off}} = 0.05\\,\\mathrm{s}^{-1}$, $R_{\\mathrm{tot}} = 20$, $H=5$, $T_{\\max} = 3600\\,\\mathrm{s}$, random seed $42$.\n- Case $2$ (no degradation, faster accumulation): $N=50$, $\\alpha = 0.05\\,\\mathrm{s}^{-1}$, $\\delta = 0.0\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{on}} = 2\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{off}} = 0.05\\,\\mathrm{s}^{-1}$, $R_{\\mathrm{tot}} = 20$, $H=5$, $T_{\\max} = 1800\\,\\mathrm{s}$, random seed $43$.\n- Case $3$ (weak production, strong unbinding): $N=10$, $\\alpha = 0.001\\,\\mathrm{s}^{-1}$, $\\delta = 0.002\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{on}} = 2\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{off}} = 0.2\\,\\mathrm{s}^{-1}$, $R_{\\mathrm{tot}} = 15$, $H=7$, $T_{\\max} = 3600\\,\\mathrm{s}$, random seed $44$.\n- Case $4$ (single-cell boundary): $N=1$, $\\alpha = 0.02\\,\\mathrm{s}^{-1}$, $\\delta = 0.001\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{on}} = 5\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{off}} = 0.05\\,\\mathrm{s}^{-1}$, $R_{\\mathrm{tot}} = 25$, $H=10$, $T_{\\max} = 3600\\,\\mathrm{s}$, random seed $45$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, where each element is the Python list representation of $[f_1,\\bar{\\tau}_1,\\sigma_{\\tau,1}],[f_2,\\bar{\\tau}_2,\\sigma_{\\tau,2}],[f_3,\\bar{\\tau}_3,\\sigma_{\\tau,3}],[f_4,\\bar{\\tau}_4,\\sigma_{\\tau,4}]$ with numeric values in seconds for times and decimal values for fractions.",
            "solution": "The problem asks for the design and implementation of a Gillespie Stochastic Simulation Algorithm (SSA) to model a synthetic quorum sensing system. The system consists of $N$ cells communicating via a shared signaling molecule, Acyl-Homoserine Lactone (AHL). The objective is to compute statistics on the first activation time for each cell, where activation is defined as the intracellular concentration of an AHL-protein complex reaching a threshold $H$.\n\nBefore proceeding to the solution, a critical validation of the problem statement is required. The model is based on the Chemical Master Equation and mass-action kinetics, which are appropriate and standard theoretical foundations for this type of problem in systems biology. The state variables, initial conditions, and termination criteria are explicitly defined. The system is described by the molecule count of extracellular AHL, $M$, and the counts of the AHL-bound transcription factor complex, $X_i$, for each cell $i \\in \\{1,\\dots,N\\}$. The count of free transcription factor, $R_i$, is constrained by $R_i = R_{\\mathrm{tot}} - X_i$.\n\nA point requiring careful consideration is the definition of the propensity for the bimolecular binding reaction, $a_{\\mathrm{bind},i} = k_{\\mathrm{on}} R_i M$. According to standard chemical kinetics, a propensity must have units of inverse time, e.g., $\\mathrm{s}^{-1}$. Since $R_i$ and $M$ are dimensionless molecule counts, the rate constant $k_{\\mathrm{on}}$ must have units of $(\\text{time})^{-1}(\\text{count})^{-1}$, or $\\mathrm{s}^{-1}(\\text{molecule})^{-1}$ in this context. However, the problem statement specifies the units of $k_{\\mathrm{on}}$ as $\\mathrm{s}^{-1}$, which at first appears to be a dimensional inconsistency. This can be resolved by interpreting $k_{\\mathrm{on}}$ not as a conventional macroscopic rate constant, but as the reaction probability per unit time for a *single specific pair* of one $R_i$ monomer and one $M$ molecule. Under this interpretation, which is a valid, albeit less common, formulation in stochastic kinetics literature, the total propensity for cell $i$ is the rate per pair ($k_{\\mathrm{on}}$) multiplied by the total number of possible pairs ($R_i M$). This interpretation renders the model dimensionally consistent and scientifically sound. With this clarification, the problem is deemed valid and a solution can be derived.\n\nThe Gillespie algorithm is an exact stochastic simulation method that generates a statistically correct trajectory of the system's state. The state of our system can be represented by a vector of molecule counts: $\\mathbf{s} = (M, X_0, X_1, \\dots, X_{N-1})$, using zero-based indexing for the $N$ cells. The simulation proceeds in discrete steps, where at each step, we determine *when* the next reaction will occur and *which* reaction it will be.\n\nThere are $2+2N$ possible reaction channels in the system:\n1.  AHL Production: $M \\to M+1$ (one aggregated channel for all cells)\n2.  AHL Degradation: $M \\to M-1$ (one channel for the pool)\n3.  Binding in cell $i$: $R_i + M \\to X_i$ ($N$ channels, one for each cell $i=0,\\dots,N-1$)\n4.  Unbinding in cell $i$: $X_i \\to R_i + M$ ($N$ channels, one for each cell $i=0,\\dots,N-1$)\n\nThe propensities for these reactions, which represent their instantaneous rates, are defined as:\n-   Production: $a_{\\mathrm{prod}} = \\alpha N$\n-   Degradation: $a_{\\mathrm{deg}} = \\delta M$\n-   Binding in cell $i$: $a_{\\mathrm{bind},i} = k_{\\mathrm{on}} (R_{\\mathrm{tot}} - X_i) M$\n-   Unbinding in cell $i$: $a_{\\mathrm{unbind},i} = k_{\\mathrm{off}} X_i$\n\nThe Gillespie SSA proceeds as follows:\n1.  **Initialization**: Set time $t=0$. Initialize the state vector according to the problem: $M(0)=0$, and $X_i(0)=0$ for all $i=0, \\dots, N-1$. Initialize an array $\\mathbf{\\tau}$ of size $N$ with a sentinel value, e.g., $-1$, to store the first activation times.\n\n2.  **Simulation Loop**: The loop continues as long as $t < T_{\\max}$, not all cells have activated, and the system has not reached a state where no more reactions can occur.\n    a. **Calculate Propensities**: At the current state $(M, X_0, \\dots, X_{N-1})$, compute the propensity for every reaction channel. There are $2+2N$ propensities in total.\n    b. **Total Propensity**: Calculate the sum of all propensities, $A_{\\mathrm{tot}} = a_{\\mathrm{prod}} + a_{\\mathrm{deg}} + \\sum_{i=0}^{N-1} a_{\\mathrm{bind},i} + \\sum_{i=0}^{N-1} a_{\\mathrm{unbind},i}$.\n    c. **Termination Check**: If $A_{\\mathrm{tot}} = 0$, no further reactions can occur. The simulation terminates.\n    d. **Time to Next Reaction**: Generate a random number $r_1 \\sim U(0,1)$. The time until the next reaction, $\\Delta t$, is drawn from an exponential distribution with rate $A_{\\mathrm{tot}}$:\n        $$ \\Delta t = \\frac{1}{A_{\\mathrm{tot}}} \\ln\\left(\\frac{1}{r_1}\\right) $$\n    e. **Select Next Reaction**: Generate a second random number $r_2 \\sim U(0,1)$. The next reaction to occur, $\\mu$, is chosen with a probability proportional to its propensity $a_\\mu$. This is achieved by finding the smallest integer $\\mu$ for which $\\sum_{j=1}^{\\mu} a_j > r_2 A_{\\mathrm{tot}}$.\n    f. **Update Time and State**: Advance the simulation time $t \\leftarrow t + \\Delta t$. If $t \\ge T_{\\max}$, terminate the simulation. Otherwise, update the state vector according to the stoichiometry of the chosen reaction $\\mu$.\n        - If production: $M \\leftarrow M+1$.\n        - If degradation: $M \\leftarrow M-1$.\n        - If binding in cell $i$: $M \\leftarrow M-1, X_i \\leftarrow X_i+1$.\n        - If unbinding in cell $i$: $M \\leftarrow M+1, X_i \\leftarrow X_i-1$.\n    g. **Check for Activation**: For the cell $i$ whose state was just updated (if any), check if $X_i \\geq H$. If this condition is met and $\\tau_i$ is still at its initial sentinel value, record the activation time: $\\tau_i \\leftarrow t$.\n\n3.  **Post-Processing**: After the simulation loop terminates (due to time limit, all cells activating, or total propensity becoming zero), analyze the recorded activation times $\\mathbf{\\tau}$.\n    a. Let $\\mathbf{\\tau}_{\\mathrm{act}}$ be the subset of $\\mathbf{\\tau}$ containing only positive values, corresponding to cells that activated.\n    b. The fraction of activated cells is $f = \\frac{\\text{length}(\\mathbf{\\tau}_{\\mathrm{act}})}{N}$.\n    c. If $\\text{length}(\\mathbf{\\tau}_{\\mathrm{act}}) > 0$, the mean activation time is $\\bar{\\tau} = \\text{mean}(\\mathbf{\\tau}_{\\mathrm{act}})$ and the population standard deviation is $\\sigma_{\\tau} = \\text{std}(\\mathbf{\\tau}_{\\mathrm{act}})$.\n    d. If no cells activated, $\\bar{\\tau} = -1.0$ and $\\sigma_{\\tau} = -1.0$ as per the problem specification.\n\nThe implementation will use a single function to run the simulation for a given set of parameters and a random seed to ensure reproducibility. This function will return the triplet $[f, \\bar{\\tau}, \\sigma_{\\tau}]$. The main program will iterate through the provided test cases, execute the simulation for each, and format the collected results into the specified final output string.",
            "answer": "```python\nimport numpy as np\n\ndef gillespie_simulation(\n    N, alpha, delta, k_on, k_off, R_tot, H, T_max, seed\n):\n    \"\"\"\n    Performs a Gillespie SSA for the quorum sensing model.\n\n    Args:\n        N (int): Number of cells.\n        alpha (float): Per-cell AHL production rate (s^-1).\n        delta (float): AHL degradation rate per molecule (s^-1).\n        k_on (float): Effective bimolecular binding rate.\n        k_off (float): Unbinding rate (s^-1).\n        R_tot (int): Total number of transcription factor monomers per cell.\n        H (int): Activation threshold for X_i.\n        T_max (float): Maximum simulation time (s).\n        seed (int): Seed for the random number generator.\n\n    Returns:\n        list: A list containing [f, mean_tau, std_tau].\n    \"\"\"\n    rng = np.random.default_rng(seed)\n\n    # State variables\n    t = 0.0  # Time\n    M = 0    # Extracellular AHL molecule count\n    X = np.zeros(N, dtype=int)  # AHL-bound complex counts for each cell\n\n    # Activation times, initialized to -1\n    tau = np.full(N, -1.0)\n    num_activated = 0\n    \n    # Store indices of non-activated cells for efficiency\n    not_activated_indices = list(range(N))\n\n    # Pre-calculate what we can\n    propensity_prod = alpha * N\n    \n    # Total number of reaction channels: 1 (prod) + 1 (deg) + N (bind) + N (unbind)\n    num_reactions = 2 + 2 * N\n    propensities = np.zeros(num_reactions)\n\n    while t < T_max and num_activated < N:\n        # Calculate propensities\n        # 1. Production\n        propensities[0] = propensity_prod\n        # 2. Degradation\n        propensities[1] = delta * M\n        # 3. Binding for each cell i\n        R = R_tot - X\n        propensities[2 : 2 + N] = k_on * R * M\n        # 4. Unbinding for each cell i\n        propensities[2 + N : 2 + 2 * N] = k_off * X\n\n        # Total propensity\n        A_tot = np.sum(propensities)\n\n        if A_tot == 0:\n            break  # No more reactions can occur\n\n        # Time to next reaction\n        r1 = rng.random()\n        dt = (1 / A_tot) * np.log(1 / r1)\n\n        t += dt\n        if t >= T_max:\n            break\n\n        # Select next reaction\n        r2 = rng.random()\n        prop_cumsum = np.cumsum(propensities)\n        reaction_index = np.searchsorted(prop_cumsum, r2 * A_tot, side='right')\n        \n        # Update state\n        if reaction_index == 0:  # Production\n            M += 1\n        elif reaction_index == 1:  # Degradation\n            M -= 1\n        elif 2 <= reaction_index < 2 + N:  # Binding\n            cell_idx = reaction_index - 2\n            M -= 1\n            X[cell_idx] += 1\n            # Check for activation\n            if tau[cell_idx] == -1 and X[cell_idx] >= H:\n                tau[cell_idx] = t\n                num_activated += 1\n        elif 2 + N <= reaction_index < 2 + 2 * N:  # Unbinding\n            cell_idx = reaction_index - (2 + N)\n            M += 1\n            X[cell_idx] -= 1\n        else:\n            # This should not happen\n            raise RuntimeError(\"Invalid reaction index selected.\")\n\n    # Calculate summary statistics\n    activated_times = tau[tau >= 0]\n    \n    f = len(activated_times) / N\n\n    if len(activated_times) > 0:\n        mean_tau = np.mean(activated_times)\n        # Population standard deviation (ddof=0)\n        std_tau = np.std(activated_times, ddof=0)\n    else:\n        mean_tau = -1.0\n        std_tau = -1.0\n\n    return [f, mean_tau, std_tau]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (baseline)\n        (50, 0.02, 0.001, 2e-5, 0.05, 20, 5, 3600, 42),\n        # Case 2 (no degradation, faster accumulation)\n        (50, 0.05, 0.0, 2e-5, 0.05, 20, 5, 1800, 43),\n        # Case 3 (weak production, strong unbinding)\n        (10, 0.001, 0.002, 2e-5, 0.2, 15, 7, 3600, 44),\n        # Case 4 (single-cell boundary)\n        (1, 0.02, 0.001, 5e-5, 0.05, 25, 10, 3600, 45)\n    ]\n\n    results = []\n    for params in test_cases:\n        N, alpha, delta, k_on, k_off, R_tot, H, T_max, seed = params\n        result = gillespie_simulation(N, alpha, delta, k_on, k_off, R_tot, H, T_max, seed)\n        results.append(result)\n\n    # Format output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}