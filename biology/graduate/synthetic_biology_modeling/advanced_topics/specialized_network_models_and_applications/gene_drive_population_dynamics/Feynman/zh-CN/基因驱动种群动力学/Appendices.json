{
    "hands_on_practices": [
        {
            "introduction": "基因驱动研究中的一个核心问题是，一个驱动等位基因能否成功入侵野生型种群。这取决于一个关键的平衡：驱动系统偏向其自身遗传的能力（归巢效率 $h$）必须足够强大，以克服它给携带它的生物体带来的任何适应性成本（例如，选择劣势 $s$）。本练习将指导您完成一项基础分析，推导出一个驱动基因在稀有时得以传播所需的最低归巢效率，这一概念被称为入侵阈值。",
            "id": "3914106",
            "problem": "考虑一个大的、随机交配的二倍体种群，其单个基因座上有两个等位基因：基因驱动等位基因 $D$ 和野生型等位基因 $W$。假设世代离散、不重叠，并且每代开始时都处于 Hardy–Weinberg 平衡 (HWE) 状态。该基因驱动为归巢型：在 $D/W$ 杂合子中，在配子发生过程中，野生型等位基因被切割并通过同源指导修复进行修复的概率为每个配子 $h$，从而产生携带 $D$ 而非 $W$ 的配子。没有抗性等位基因的形成，因此抗性率为 $r=0$。生存力选择在繁殖前起作用：$W/W$ 个体的生存力为 $1$，而 $D/W$ 杂合子的生存力因选择系数 $s$ 而降低，因此其生存力为 $1-s$。你可以假设，当 $D$ 稀有时，$D/D$ 纯合子足够稀少，以至于它们对入侵分析的贡献可以忽略不计。\n\n设 $p_t$ 表示在第 $t$ 代成年个体中等位基因 $D$ 的频率，并考虑从稀有状态入侵的条件，即当 $p_t$ 接近于零时 $p_{t+1}$ 的行为。从第一性原理出发，基于 HWE 和上述定义，推导当等位基因 $D$ 稀有时其频率增加所需的最小归巢效率 $h_{\\min}$。请用一个关于 $s$ 的封闭形式解析表达式来表示你的最终答案。无需四舍五入，也无需单位。",
            "solution": "用户希望我解决提示中描述的问题。\n\n### 步骤 1：提取已知条件\n- 种群：大的、随机交配的、二倍体。\n- 世代：离散、不重叠。\n- 等位基因：基因驱动等位基因 ($D$) 和野生型等位基因 ($W$)。\n- 初始状态：每代开始时处于 Hardy–Weinberg 平衡 (HWE) 状态。\n- 基因驱动：归巢型。\n- 归巢效率：$h$。在 $D/W$ 杂合子中，一个野生型等位基因以每个配子 $h$ 的概率转化为 $D$ 等位基因。\n- 抗性率：$r=0$。\n- 生存力选择：\n  - $W/W$ 生存力为 $1$。\n  - $D/W$ 生存力为 $1-s$。\n  - $D/D$ 纯合子的贡献在入侵分析中可忽略不计。\n- 符号：$p_t$ 是第 $t$ 代成年个体中等位基因 $D$ 的频率。\n- 目标：推导当等位基因 $D$ 稀有时其频率增加所需的最小归巢效率 $h_{\\min}$，并用 $s$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题描述了一个标准的、简化的基于归巢的基因驱动模型，这是群体遗传学和合成生物学中一个成熟的概念。离散世代、随机交配和 HWE 的假设是常见且有效的，可用于创建基线数学模型。该模型在科学上是合理的。\n- **适定性：** 该问题是适定的。它提供了所有必要的参数（$s$，$h$）和一个明确的目标（找到入侵所需的 $h_{\\min}$）。“稀有时增加”的条件是稳定性分析中的一个标准准则，它导出一个唯一的阈值。\n- **客观性：** 该问题以精确、定量和无偏见的语言陈述。\n- **缺陷检查清单：**\n  1. **科学/事实不健全：** 无。该模型是该领域使用的有效简化。\n  2. **不可形式化/不相关：** 无。该问题是群体遗传学建模的一个经典例子，与*基因驱动种群动态*直接相关。\n  3. **不完整/矛盾：** 无。该问题是自洽的。忽略 $D/D$ 纯合子的指令是进行从稀有状态入侵分析（线性稳定性分析）的标准且必要的简化，并非矛盾。\n  4. **不切实际/不可行：** 无。参数是符号性的。该模型代表了一个合理的生物学权衡。\n  5. **不适定/结构不良：** 无。问题结构清晰，可导出一个唯一的、有意义的解。\n  6. **伪深刻/琐碎：** 无。推导过程需要仔细、逐步地应用群体遗传学原理，并非琐碎。\n  7. **超出科学可验证性：** 无。该模型是数学模型，其预测是可验证的。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行求解。\n\n最小归巢效率 $h_{\\min}$ 的推导需要建立驱动等位基因频率 $p_t$ 的递推关系，然后分析该等位基因在稀有状态（即当 $p_t \\to 0$ 时）下频率增加的条件。\n\n设 $p_t$ 为第 $t$ 代成年个体中驱动等位基因 $D$ 的频率，$q_t = 1 - p_t$ 为野生型等位基因 $W$ 的频率。\n\n1.  **合子形成：** 假设随机交配，下一代（$t+1$）合子中三种基因型（$D/D$、$D/W$、$W/W$）的频率由 Hardy-Weinberg 比例给出：\n    -   $f_{D/D, \\text{zygote}} = p_t^2$\n    -   $f_{D/W, \\text{zygote}} = 2p_t q_t = 2p_t(1-p_t)$\n    -   $f_{W/W, \\text{zygote}} = q_t^2 = (1-p_t)^2$\n\n2.  **生存力选择：** 生存力选择作用于这些合子。相对生存力为 $w_{D/D}$（未指定，但其贡献可忽略）、$w_{D/W} = 1-s$ 和 $w_{W/W} = 1$。存活至成年的基因型比例为：\n    -   $D/D$: $p_t^2 w_{D/D}$\n    -   $D/W$: $2p_t(1-p_t)(1-s)$\n    -   $W/W$: $(1-p_t)^2(1)$\n    问题指出，在入侵分析中我们可以忽略 $D/D$ 纯合子的贡献，这对应于分析当 $p_t \\to 0$ 时的动态。在此极限下，$D/D$ 个体的频率 $p_t^2$ 是比 $D/W$ 个体频率 $2p_t(1-p_t) \\approx 2p_t$ 更低阶的项，可以忽略。\n\n3.  **成年个体频率与平均适合度：** 种群的平均适合度 $\\bar{w}$ 是存活基因型频率的总和。对于小的 $p_t$，我们有：\n    $$ \\bar{w} = (1-p_t)^2 + 2p_t(1-p_t)(1-s) $$\n    在将要繁殖的成年幸存者中，各基因型的频率通过除以 $\\bar{w}$ 进行归一化得到：\n    -   $f'_{D/W} = \\frac{2p_t(1-p_t)(1-s)}{\\bar{w}}$\n    -   $f'_{W/W} = \\frac{(1-p_t)^2}{\\bar{w}}$\n\n4.  **含基因驱动的配子产生：** 这些成年个体产生配子。\n    -   $W/W$ 成年个体只产生 $W$ 配子。\n    -   在 $D/W$ 杂合子中，等位基因 $D$ 以 $\\frac{1}{2}$ 的基准概率遗传。归巢机制将本应携带 $W$ 的配子中的一部分（比例为 $h$）转化为 $D$ 配子。因此，$D/W$ 个体产生的 $D$ 配子的比例为 $\\frac{1}{2} + h \\cdot \\frac{1}{2} = \\frac{1}{2}(1+h)$。\n\n5.  **下一代等位基因频率：** 下一代中等位基因 $D$ 的频率 $p_{t+1}$ 是总配子库中 $D$ 配子的频率。这可以通过对每个成年基因型的贡献求和得到：\n    $$ p_{t+1} = \\underbrace{(0) \\cdot f'_{W/W}}_{\\text{from } W/W} + \\underbrace{\\left(\\frac{1}{2}(1+h)\\right) \\cdot f'_{D/W}}_{\\text{from } D/W} $$\n    我们再次忽略 $D/D$ 的贡献。代入 $f'_{D/W}$ 的表达式：\n    $$ p_{t+1} = \\frac{1}{2}(1+h) \\frac{2p_t(1-p_t)(1-s)}{\\bar{w}} $$\n    $$ p_{t+1} = \\frac{p_t(1-p_t)(1+h)(1-s)}{(1-p_t)^2 + 2p_t(1-p_t)(1-s)} $$\n    这个方程 $p_{t+1} = F(p_t)$ 定义了等位基因频率从一代到下一代的变化。\n\n6.  **入侵分析：** 当等位基因 $D$ 稀有时，如果其初始增长率大于 $1$，其频率将会增加。这由递推关系 $F(p_t)$ 在灭绝不动点 $p_t=0$ 处的导数决定。入侵条件是 $F'(0)  1$。\n    为了求得 $F'(0)$，我们可以使用商法则 $F'(p_t) = \\frac{N'(p_t)D(p_t) - N(p_t)D'(p_t)}{[D(p_t)]^2}$，其中 $N(p_t)$ 是 $F(p_t)$ 的分子，$D(p_t)$ 是分母。\n    让我们计算在 $p_t=0$ 时各组成部分的值：\n    -   $N(p_t) = p_t(1-p_t)(1+h)(1-s) \\implies N(0) = 0$。\n    -   $N'(p_t) = (1-2p_t)(1+h)(1-s) \\implies N'(0) = (1+h)(1-s)$。\n    -   $D(p_t) = (1-p_t)^2 + 2p_t(1-p_t)(1-s) \\implies D(0) = (1-0)^2 = 1$。\n    -   由于 $N(0)=0$，我们不需要计算 $D'(0)$。\n\n    将这些值代入 $p_t=0$ 处的导数公式：\n    $$ F'(0) = \\frac{N'(0)D(0) - N(0)D'(0)}{[D(0)]^2} = \\frac{((1+h)(1-s)) \\cdot 1 - 0 \\cdot D'(0)}{1^2} = (1+h)(1-s) $$\n    因此，入侵条件为：\n    $$ (1+h)(1-s)  1 $$\n\n7.  **最小归巢效率：** 入侵所需的最小归巢效率 $h_{\\min}$ 是满足增长率恰好为 $1$ 的边界条件的 $h$ 值：\n    $$ (1+h_{\\min})(1-s) = 1 $$\n    求解 $h_{\\min}$：\n    $$ 1 + h_{\\min} = \\frac{1}{1-s} $$\n    $$ h_{\\min} = \\frac{1}{1-s} - 1 $$\n    为了得到一个单一的分数，我们通分：\n    $$ h_{\\min} = \\frac{1 - (1-s)}{1-s} = \\frac{1-1+s}{1-s} = \\frac{s}{1-s} $$\n    该表达式给出了克服杂合子适合度成本 $s$ 并允许基因驱动在初始稀有状态下在种群中扩散所需的最小归巢效率。",
            "answer": "$$ \\boxed{\\frac{s}{1-s}} $$"
        },
        {
            "introduction": "与侵入性归巢驱动相反，其他基因驱动架构（如低显性系统）被设计用于实现更好的控制和生物遏制。这些驱动通过使杂合子比任何一种纯合子都具有更低的适应性来发挥作用，从而创造出一种动态：只有当驱动基因的初始频率超过某个阈值时，它才能传播。本练习将让您推导出这个关键的释放阈值，并证明控制此类系统的双稳态原理。",
            "id": "3914155",
            "problem": "考虑一个具有离散世代的大型随机交配二倍体种群，其中引入了一种合成亚显性基因驱动。设等位基因 $D$ 表示驱动，等位基因 $W$ 表示野生型。假设在生存力选择之前，随机交配产生的基因型比例符合哈代-温伯格平衡。生存力适应度呈对称亚显性：$w_{WW}=1$、$w_{WD}=1-s_u$ 和 $w_{DD}=1$，其中 $s_u$ 是一个常数，表示杂合子生存力的降低程度，且 $0  s_u \\leq 1$。不存在配子转换、减数分裂驱动，以及除生存力选择之外的其他选择压力。设 $p_t$ 为第 $t$ 代等位基因 $D$ 的频率。\n\n从哈代-温伯格比例和生存力选择（即对基因型频率进行加权）的基本定义出发，推导等位基因频率的更新规则 $p_{t+1}$ 作为 $p_t$ 和 $s_u$ 的函数。确定该动力系统的所有不动点。仅使用第一性原理和离散映射的动力系统稳定性判据，确定分隔两个纯合子状态吸引盆的不稳定阈值 $p_{\\mathrm{thr}}$，并证明当 $0  s_u \\leq 1$ 时系统具有双稳态性。\n\n你的最终答案必须是 $p_{\\mathrm{thr}}$ 的明确值，以单个闭式表达式给出。无需四舍五入，最终答案中不应使用单位。",
            "solution": "该问题要求推导合成亚显性基因驱动的等位基因频率动态，找出所有不动点，并确定分隔两个纯合子状态吸引盆的不稳定阈值。\n\n设 $p_t$ 表示第 $t$ 代驱动等位基因 $D$ 的频率，$q_t = 1 - p_t$ 表示野生型等位基因 $W$ 的频率。假设种群是大的、二倍体的和随机交配的，因此合子阶段的基因型频率遵循哈代-温伯格比例：\n-   $DD$ 基因型的频率: $p_t^2$\n-   $WD$ 基因型的频率: $2p_t(1-p_t)$\n-   $WW$ 基因型的频率: $(1-p_t)^2$\n\n生存力选择作用于这些基因型。给定的适应度值为 $w_{DD}=1$，$w_{WD}=1-s_u$ 和 $w_{WW}=1$。选择后的基因型频率与其初始频率乘以各自的适应度值成正比。种群的平均适应度 $\\bar{w}_t$ 是归一化常数，计算方法为这些加权频率的总和：\n$$\n\\bar{w}_t = p_t^2 w_{DD} + 2p_t(1-p_t)w_{WD} + (1-p_t)^2 w_{WW}\n$$\n代入适应度值：\n$$\n\\bar{w}_t = p_t^2(1) + 2p_t(1-p_t)(1-s_u) + (1-p_t)^2(1)\n$$\n此表达式可简化为：\n$$\n\\bar{w}_t = (p_t^2 + (1-p_t)^2) + 2p_t(1-p_t)(1-s_u)\n$$\n使用恒等式 $a^2+b^2 = (a+b)^2-2ab$，我们有 $p_t^2+(1-p_t)^2 = (p_t+1-p_t)^2 - 2p_t(1-p_t) = 1-2p_t(1-p_t)$。\n$$\n\\bar{w}_t = 1 - 2p_t(1-p_t) + 2p_t(1-p_t)(1-s_u) = 1 - 2s_u p_t(1-p_t)\n$$\n下一代中驱动等位基因 $D$ 的频率 $p_{t+1}$，是根据存活下来并繁殖的基因型频率计算得出的。这是 $DD$ 成体频率与 $WD$ 成体频率一半的总和：\n$$\np_{t+1} = \\frac{p_t^2 w_{DD}}{\\bar{w}_t} + \\frac{1}{2} \\frac{2p_t(1-p_t)w_{WD}}{\\bar{w}_t}\n$$\n$$\np_{t+1} = \\frac{p_t^2 + p_t(1-p_t)(1-s_u)}{\\bar{w}_t}\n$$\n代入 $\\bar{w}_t$ 的表达式并展开分子：\n$$\np_{t+1} = \\frac{p_t^2 + p_t - p_t^2 - s_u p_t + s_u p_t^2}{1 - 2s_u p_t(1-p_t)} = \\frac{p_t(1 - s_u + s_u p_t)}{1 - 2s_u p_t(1-p_t)}\n$$\n这就是等位基因频率的更新规则，$p_{t+1} = f(p_t)$。\n\n接下来，我们通过求解 $p^* = f(p^*)$ 来确定该动力系统的不动点：\n$$\np^* = \\frac{p^*(1 - s_u + s_u p^*)}{1 - 2s_u p^*(1-p^*)}\n$$\n一个解是 $p^* = 0$。对于 $p^* \\neq 0$，我们可以两边同除以 $p^*$：\n$$\n1 = \\frac{1 - s_u + s_u p^*}{1 - 2s_u p^*(1-p^*)}\n$$\n$$\n1 - 2s_u p^*(1-p^*) = 1 - s_u + s_u p^*\n$$\n$$\n-2s_u p^* + 2s_u (p^*)^2 = -s_u + s_u p^*\n$$\n由于 $0  s_u \\leq 1$，我们可以两边同除以 $s_u$：\n$$\n-2p^* + 2(p^*)^2 = -1 + p^*\n$$\n$$\n2(p^*)^2 - 3p^* + 1 = 0\n$$\n这个二次方程可以因式分解为：\n$$\n(2p^* - 1)(p^* - 1) = 0\n$$\n这得到另外两个不动点：$p^* = \\frac{1}{2}$ 和 $p^* = 1$。该系统的三个不动点是 $p^* \\in \\{0, \\frac{1}{2}, 1\\}$。\n\n为了分析这些不动点的稳定性，我们考察映射的导数 $f'(p)$ 在每个不动点的值。如果 $|f'(p^*)|  1$，则不动点 $p^*$ 是稳定的；如果 $|f'(p^*)|  1$，则是不稳定的。设 $N(p) = p(1 - s_u + s_u p)$ 和 $D(p) = 1 - 2s_u p(1-p)$。在不动点 $p^*$ 处的导数 $f'(p^*)$ 可以计算为 $f'(p^*) = \\frac{N'(p^*) - p^*D'(p^*)}{D(p^*)}$, 其中 $N'(p) = 1 - s_u + 2s_u p$ 且 $D'(p) = -2s_u + 4s_u p$。\n\n1.  $p^*=0$ 的稳定性：\n    $N'(0) = 1 - s_u$ 且 $D(0) = 1$。所以，$f'(0) = 1 - s_u$。\n    给定 $0  s_u \\leq 1$，我们有 $0 \\leq f'(0)  1$。因此， $|f'(0)|  1$ (对于 $s_u \\neq 0$)，$p^* = 0$ 是一个稳定的不动点。\n\n2.  $p^*=1$ 的稳定性：\n    $N'(1) = 1 + s_u$，$D(1) = 1$，且 $D'(1) = 2s_u$。\n    $f'(1) = \\frac{(1+s_u) - 1(2s_u)}{1} = 1 - s_u$。\n    类似地， $|f'(1)|  1$，所以 $p^* = 1$ 也是一个稳定的不动点。\n\n3.  $p^*=\\frac{1}{2}$ 的稳定性：\n    $N'(\\frac{1}{2}) = 1 - s_u + 2s_u(\\frac{1}{2}) = 1$。\n    $D(\\frac{1}{2}) = 1 - 2s_u(\\frac{1}{2})(1-\\frac{1}{2}) = 1 - \\frac{s_u}{2}$。\n    $D'(\\frac{1}{2}) = -2s_u + 4s_u(\\frac{1}{2}) = 0$。\n    $f'(\\frac{1}{2}) = \\frac{1 - (\\frac{1}{2})(0)}{1 - \\frac{s_u}{2}} = \\frac{1}{1 - \\frac{s_u}{2}}$。\n    由于 $0  s_u \\leq 1$，可得 $0  \\frac{s_u}{2} \\leq \\frac{1}{2}$。这意味着 $\\frac{1}{2} \\leq 1 - \\frac{s_u}{2}  1$。\n    取倒数可得 $1  \\frac{1}{1 - s_u/2} \\leq 2$。\n    因此，$f'(\\frac{1}{2})  1$。不动点 $p^* = \\frac{1}{2}$ 是不稳定的。\n\n该系统是双稳态的。它拥有两个稳定的不动点，$p^*=0$ (代表野生型等位基因 $W$ 的固定) 和 $p^*=1$ (代表驱动等位基因 $D$ 的固定)。这两个状态被一个位于 $p^*=\\frac{1}{2}$ 的不稳定不动点所分隔。这个不稳定点作为临界阈值 $p_{\\mathrm{thr}}$。如果初始等位基因频率 $p_0$ 低于此阈值 ($0 \\leq p_0  \\frac{1}{2}$)，等位基因频率将随世代递减，最终达到 $0$。如果初始频率高于此阈值 ($\\frac{1}{2}  p_0 \\leq 1$)，频率将增加，直到驱动等位基因在种群中固定下来，即 $p=1$。\n\n不稳定阈值 $p_{\\mathrm{thr}}$ 就是这个不稳定不动点的值。\n$$\np_{\\mathrm{thr}} = \\frac{1}{2}\n$$",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "为了预测基因驱动的真实世界影响，特别是旨在减少有害生物种群的“抑制性驱动”，我们必须将目光超越遗传学，并整合生态动态。种群的最终命运取决于驱动基因施加的遗传负荷与种群自身的密度依赖性调节（包括潜在的阿利效应）之间的相互作用。这项综合性模拟练习要求您构建一个耦合的生态-遗传模型，以探索这些瞬态动态，并确定种群在何种条件下可能走向崩溃。",
            "id": "3914103",
            "problem": "您的任务是为受归巢基因驱动 (HGD) 影响的二倍体种群的瞬时动态进行建模，该驱动具有传递扭曲和生存力成本，并处于具有Allee效应的密度依赖性之下。设离散世代 $t$ 的种群大小为 $N(t)$，成年个体中的驱动等位基因频率为 $p(t)$。在世代 $t = 0$ 时进行释放后，成年个体的驱动等位基因频率为 $p(0) = p_0$，成年种群大小为 $N(0) = N_0$。假设随机交配，合子中的基因型比例符合Hardy–Weinberg (HW)定律，且仅存在基因型特异的生存力选择。在HGD中，杂合子经历种系归巢，以归巢概率 $c$ 增加驱动等位基因的传递，并且没有抗性等位基因的形成。假设野生型基因型的生存力适应度为 $w_{WW} = 1$，杂合子的生存力适应度为 $w_{WD} = 1 - s_H$，驱动纯合子的生存力适应度为 $w_{DD} = 1 - s_D$，其中 $s_H$ 和 $s_D$ 为非负成本。生态动态包括一个Allee阈值 $A$，当种群大小低于 $A$ 时，人均增长率为负。对于密度依赖性，假设环境承载力为 $K$，人均增长的内禀尺度为 $r$。时间以离散世代为单位进行度量。\n\n从群体遗传学（Mendelian分离、HW定律、随机交配和基因型特异的生存力选择）和种群生态学（密度依赖性增长和Allee效应）中上述经过充分检验的基础出发，根据第一性原理，推导出 $N(t+1)$ 和 $p(t+1)$ 关于 $N(t)$、$p(t)$ 和参数 $(K, A, r, c, s_H, s_D)$ 的耦合离散时间递归关系。您的推导必须：\n- 表达在归巢传递扭曲下，成年个体产生的配子池中驱动等位基因的比例，\n- 在给定配子等位基因比例的情况下，根据HW定律构建合子基因型比例，\n- 应用生存力选择以获得成年个体的基因型比例，\n- 根据选择后的基因型比例计算成年个体的驱动等位基因频率 $p(t+1)$，\n- 将 $N(t+1)$ 的生态递归与合子到成年个体的平均生存力以及经Allee效应修正的密度依赖性耦合起来。\n\n然后实现一个程序，给定一个小的参数集测试套件，从 $(N(0), p(0))$ 开始模拟 $T$ 个世代，计算整个瞬时轨迹 $\\{N(t), p(t)\\}$，并为每个测试案例返回一个布尔值，该值指示在任何世代 $t \\in \\{0, 1, \\dots, T\\}$ 中，种群大小是否曾严格低于Allee阈值 $A$。\n\n使用以下包含5个参数集的科学上合理的测试套件，每个参数集指定为一个元组 $(N_0, p_0, K, A, r, c, s_H, s_D, T)$，所有参数均为无量纲，时间单位为世代：\n- 案例1：$(N_0 = 5000, p_0 = 0.10, K = 10000, A = 500, r = 0.80, c = 0.80, s_H = 0.05, s_D = 0.10, T = 200)$，\n- 案例2：$(N_0 = 800, p_0 = 0.20, K = 10000, A = 1000, r = 1.00, c = 0.95, s_H = 0.30, s_D = 0.60, T = 200)$，\n- 案例3：$(N_0 = 1000, p_0 = 0.10, K = 10000, A = 1000, r = 0.80, c = 0.90, s_H = 0.10, s_D = 0.30, T = 200)$，\n- 案例4：$(N_0 = 8000, p_0 = 0.20, K = 10000, A = 1000, r = 0.80, c = 0.00, s_H = 0.20, s_D = 0.40, T = 200)$，\n- 案例5：$(N_0 = 3000, p_0 = 0.30, K = 5000, A = 500, r = 2.00, c = 0.70, s_H = 0.10, s_D = 0.20, T = 200)$。\n\n为保证数值稳定性，在您的模拟中必须确保在所有时间点 $N(t) \\ge 0$ 和 $p(t) \\in [0, 1]$（必要时进行截断）。如果生态递归产生负的中间种群，则将下一代种群视为 $0$。角度单位不适用。不使用物理单位。百分比必须表示为 $[0,1]$ 范围内的小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result_1,result_2,\\dots]$），其中每个 $result_i$ 是一个对应于第 $i$ 个测试案例的布尔值。",
            "solution": "该问题是有效的，因为它在科学上基于群体遗传学和生态学中已确立的模型，问题陈述清晰、客观，并包含了推导和实现解决方案所需的所有必要信息。\n\n任务是推导种群大小$N(t)$和基因驱动等位基因频率$p(t)$的耦合离散时间递归关系，然后对一组给定的参数模拟这些动态。\n\n### 递归关系的推导\n\n我们从第一性原理开始，遵循一个二倍体、随机交配种群的生命周期。设 $W$ 为野生型等位基因，$D$ 为归巢基因驱动等位基因。\n\n**1. 遗传动态：从成年个体到配子再到新一代成年个体**\n\n设 $p(t)$ 是在世代 $t$ 时成年种群中 $D$ 等位基因的频率。假设成年种群处于Hardy-Weinberg (HW)平衡状态，则野生型纯合子 ($WW$)、杂合子 ($WD$) 和驱动纯合子 ($DD$) 的基因型频率为：\n$$f_{WW}(t) = (1-p(t))^2$$\n$$f_{WD}(t) = 2p(t)(1-p(t))$$\n$$f_{DD}(t) = p(t)^2$$\n\n这些成年个体产生配子以形成下一代。\n- $WW$ 个体只产生 $W$ 配子。\n- $DD$ 个体只产生 $D$ 配子。\n- 由于归巢过程，$WD$ 杂合子经历非Mendelian遗传。驱动等位基因 $D$ 通过在携带 $W$ 等位基因的同源染色体上进行复制来实现“归巢”。这以概率 $c$ 发生。因此，种系中一小部分比例为 $c$ 的 $W$ 等位基因被转化为 $D$ 等位基因。因此，一个 $WD$ 个体产生比例为 $(1+c)/2$ 的 $D$ 配子和比例为 $(1-c)/2$ 的 $W$ 配子，而不是标准的Mendelian比例各 $1/2$。\n\n配子池中 $D$ 等位基因的频率 $p_g(t)$ 是各种基因型贡献的总和，按其在成年种群中的频率加权：\n$$p_g(t) = (0) \\cdot f_{WW}(t) + \\left(\\frac{1+c}{2}\\right) \\cdot f_{WD}(t) + (1) \\cdot f_{DD}(t)$$\n代入HW频率：\n$$p_g(t) = \\left(\\frac{1+c}{2}\\right) \\cdot 2p(t)(1-p(t)) + p(t)^2$$\n$$p_g(t) = (1+c)p(t)(1-p(t)) + p(t)^2$$\n$$p_g(t) = p(t) + c \\cdot p(t)(1-p(t))$$\n这个方程描述了由于归巢，驱动等位基因在配子池中频率的增加。\n\n下一代的合子是由这些配子的随机结合形成的。在世代 $t+1$ 时，选择前的基因型频率遵循基于配子等位基因频率 $p_g(t)$ 的HW比例：\n$$f'_{WW} = (1-p_g(t))^2$$\n$$f'_{WD} = 2p_g(t)(1-p_g(t))$$\n$$f'_{DD} = p_g(t)^2$$\n\n这些合子受到生存力选择。相对生存力（适应度）给定为 $w_{WW} = 1$、$w_{WD} = 1 - s_H$ 和 $w_{DD} = 1 - s_D$，其中 $s_H$ 和 $s_D$ 是适应度成本。\n\n种群的平均生存力适应度 $\\bar{w}(t)$ 是所有基因型在选择前按其频率加权的平均适应度：\n$$\\bar{w}(t) = f'_{WW}w_{WW} + f'_{WD}w_{WD} + f'_{DD}w_{DD}$$\n$$\\bar{w}(t) = (1-p_g(t))^2(1) + 2p_g(t)(1-p_g(t))(1-s_H) + p_g(t)^2(1-s_D)$$\n\n在世代 $t+1$ 时，存活的成年个体中各基因型的频率通过除以平均适应度进行归一化得到：\n$$f_{WW}(t+1) = \\frac{f'_{WW}w_{WW}}{\\bar{w}(t)}, \\quad f_{WD}(t+1) = \\frac{f'_{WD}w_{WD}}{\\bar{w}(t)}, \\quad f_{DD}(t+1) = \\frac{f'_{DD}w_{DD}}{\\bar{w}(t)}$$\n\n在世代 $t+1$ 时，成年种群中驱动等位基因 $D$ 的频率 $p(t+1)$ 是 $DD$ 成年个体频率加上 $WD$ 成年个体频率的一半：\n$$p(t+1) = f_{DD}(t+1) + \\frac{1}{2}f_{WD}(t+1)$$\n$$p(t+1) = \\frac{p_g(t)^2(1-s_D)}{\\bar{w}(t)} + \\frac{2p_g(t)(1-p_g(t))(1-s_H)}{2\\bar{w}(t)}$$\n$$p(t+1) = \\frac{p_g(t)^2(1-s_D) + p_g(t)(1-p_g(t))(1-s_H)}{\\bar{w}(t)}$$\n这是第一个递归关系，描述了驱动等位基因频率的演化。\n\n**2. 生态动态与耦合**\n\n种群大小动态受密度依赖性控制，包括一个环境承载力 $K$ 和一个Allee阈值 $A$。参数 $r$ 是人均增长的内禀尺度。对于离散时间模型，人均增长率可以被建模为在低于 $A$ 和种群远高于 $K$ 时为负。一个包含这些效应的标准函数形式的人均变化率是 $g(N) = r(1 - N/K)(N/A - 1)$。由大小为 $N(t)$ 的成年种群产生的后代（合子）数量由 $N_{zygotes} = N(t) \\cdot \\exp(g(N(t)))$ 给出，这是连续增长的离散时间模拟。\n\n$$N_{zygotes} = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right)$$\n\n该表达式模拟了密度依赖的繁殖力。下一代成年个体的数量 $N(t+1)$ 是存活至成年的合子数量。这种存活由种群的平均生存力适应度 $\\bar{w}(t)$ 决定，该适应度考虑了由驱动的适应度成本所施加的遗传负荷。\n\n因此，我们将生态和遗传动态耦合起来：\n$$N(t+1) = N_{zygotes} \\cdot \\bar{w}(t)$$\n$$N(t+1) = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right) \\cdot \\bar{w}(t)$$\n这是关于总种群大小的第二个递归关系。\n\n**3. 耦合系统总结**\n\n需要模拟的完整耦合递归关系系统如下：\n给定 $N(t)$ 和 $p(t)$：\n1. 计算配子池中的驱动等位基因频率：\n   $$p_g(t) = p(t) + c \\cdot p(t)(1-p(t))$$\n2. 计算后代代的平均适应度：\n   $$\\bar{w}(t) = (1-p_g(t))^2 + 2p_g(t)(1-p_g(t))(1-s_H) + p_g(t)^2(1-s_D)$$\n3. 计算下一代的成年种群大小：\n   $$N(t+1) = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right) \\cdot \\bar{w}(t)$$\n4. 计算下一代的成年驱动等位基因频率：\n   $$p(t+1) = \\frac{p_g(t)(1-p_g(t))(1-s_H) + p_g(t)^2(1-s_D)}{\\bar{w}(t)}$$\n\n这些方程从初始条件 $(N_0, p_0)$ 开始迭代 $T$ 个世代。在模拟过程中，我们必须检查在任何 $t \\in \\{0, 1, \\dots, T\\}$ 时，$N(t)$ 是否低于 $A$。为了稳定性，对 $N(t)$ 在 $0$ 处以及 $p(t)$ 在 $[0, 1]$ 区间内进行数值截断。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates the population dynamics of a homing gene drive under density dependence\n    with an Allee effect, and determines if the population ever drops below the Allee threshold.\n    \"\"\"\n    # Test cases defined as tuples:\n    # (N0, p0, K, A, r, c, s_H, s_D, T)\n    test_cases = [\n        (5000, 0.10, 10000, 500, 0.80, 0.80, 0.05, 0.10, 200),\n        (800, 0.20, 10000, 1000, 1.00, 0.95, 0.30, 0.60, 200),\n        (1000, 0.10, 10000, 1000, 0.80, 0.90, 0.10, 0.30, 200),\n        (8000, 0.20, 10000, 1000, 0.80, 0.00, 0.20, 0.40, 200),\n        (3000, 0.30, 5000, 500, 2.00, 0.70, 0.10, 0.20, 200),\n    ]\n\n    results = []\n    for case in test_cases:\n        N0, p0, K, A, r, c, s_H, s_D, T = case\n\n        N = float(N0)\n        p = float(p0)\n        \n        # Flag to track if the population size falls below the Allee threshold.\n        crashed = False\n\n        # Check the initial condition at t=0\n        if N  A:\n            crashed = True\n        \n        if not crashed:\n            # Simulate for T generations\n            for t in range(T):\n                # Ensure p is within [0, 1] to avoid numerical issues\n                p = np.clip(p, 0.0, 1.0)\n                \n                # If population is extinct, it stays extinct.\n                if N == 0:\n                    crashed = True\n                    break\n\n                # 1. Calculate drive allele frequency in the gamete pool\n                p_g = p + c * p * (1 - p)\n\n                # 2. Calculate mean fitness\n                w_bar = ( (1 - p_g)**2 \n                        + 2 * p_g * (1 - p_g) * (1 - s_H) \n                        + p_g**2 * (1 - s_D) )\n\n                # Handle potential division by zero if w_bar is 0 or very close.\n                # This could happen if s_D=1 and p_g=1, or s_H=1 and p_g is not 0 or 1 etc.\n                if w_bar = 0:\n                    N = 0.0\n                    # p is undefined, but since N=0, it doesn't matter. Let's set to 0.\n                    p = 0.0\n                    crashed = True\n                    break\n\n                # 3. Calculate next generation's allele frequency\n                p_next = (p_g * (1 - p_g) * (1 - s_H) + p_g**2 * (1 - s_D)) / w_bar\n                \n                # 4. Calculate next generation's population size\n                # The ecological term can result in a huge exponent, we handle this.\n                if K == 0 or A == 0 or N/K > 1e6 : # Avoid overflow/division by zero\n                    # If N is huge compared to K, or K/A are zero, the exp term will be ~0\n                    # For N >> K, (1-N/K) is large negative, exp(...) -> 0\n                    growth_factor_arg = -np.inf\n                else:\n                    growth_factor_arg = r * (1 - N / K) * (N / A - 1)\n                \n                # Use np.exp which is robust to overflow/underflow\n                growth_factor = np.exp(growth_factor_arg)\n                \n                N_next = N * growth_factor * w_bar\n\n                # Update state variables for the next generation\n                N = N_next\n                p = p_next\n\n                # Clip N to be non-negative\n                N = np.max([0.0, N])\n\n                # Check if population has fallen below the Allee threshold\n                if N  A:\n                    crashed = True\n                    break\n        \n        results.append(crashed)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}