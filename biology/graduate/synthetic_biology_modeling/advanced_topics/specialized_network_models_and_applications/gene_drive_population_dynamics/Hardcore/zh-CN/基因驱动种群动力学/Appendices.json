{
    "hands_on_practices": [
        {
            "introduction": "在模拟整个种群的动态之前，我们必须首先精确理解基因驱动等位基因是如何从亲代传递给子代的。这个练习将归纳法基因驱动的核心机制——归巢效率和抗性形成——分解到最基本的层面。通过推导一次特定杂交的后代基因型分布，您将掌握构建更复杂种群模型所需的基本规则 。",
            "id": "3914128",
            "problem": "考虑一个使用成簇规律间隔短回文重复序列 (CRISPR) 和CRISPR相关蛋白$9$ (Cas$9$) 实现的、靶向单个基因座等位基因的归巢基因驱动。设野生型等位基因用 $W$ 表示，驱动等位基因用 $D$ 表示，不被Cas$9$切割的抗性等位基因用 $R$ 表示。假设遵循以下基本规则，这些规则在归巢基因驱动的种群遗传学模型中被广泛使用：\n- 在携带基因型 $WD$ 的杂合生殖细胞中，野生型等位基因 $W$ 以概率 $h$（归巢效率）被切割。\n- 在发生切割的条件下，修复通过同源指导修复的概率为 $1-r$，将 $W$ 转换为 $D$；或通过非同源末端连接的概率为 $r$，将 $W$ 转换为 $R$。\n- 如果没有发生切割，则 $W$ 等位基因保持为 $W$。\n- 来自 $WW$ 个体的配子仅携带 $W$ 等位基因。\n- 配子随机结合，无胚胎沉积效应，基因型之间无适应性差异，无生存力选择；其余遗传方式遵循孟德尔定律。\n\n从这些机制性规则和基本的孟德尔分离定律出发，推导在一个 $WD$ 亲本和一个 $WW$ 亲本随机交配的情况下，产生的子代合子基因型频率分布。使用 $h=0.9$ 和 $r=0.05$。以有序向量 $\\left(WW,\\, WD,\\, WR,\\, DD,\\, DR,\\, RR\\right)$ 的形式报告子代基因型频率。无需四舍五入；请给出精确值。答案必须是包含按指定顺序排列的六个基因型频率的单行矩阵。",
            "solution": "该问题陈述已经过严格验证，被认为是具有科学依据、提法恰当、客观且内部一致的。它提出了一个基于CRISPR的归巢基因驱动遗传的标准简化模型，提供了推导唯一解所需的所有必要参数和规则。因此，该问题被视为有效，并给出完整解答如下。\n\n目标是确定一个杂合驱动携带个体 ($WD$) 和一个野生型个体 ($WW$) 杂交产生的子代的基因型频率分布。这需要一个两步过程：首先，计算每个亲本产生的配子频率；其次，确定这些配子随机结合产生的合子基因型频率。\n\n**步骤1：配子频率**\n\n**亲本1：野生型 ($WW$)**\n基因型为 $WW$ 的个体是野生型等位基因 $W$ 的纯合子。根据孟德尔分离定律，该亲本只能产生携带 $W$ 等位基因的配子。\n- 来自 $WW$ 亲本的 $W$ 配子频率：$P_{WW}(W) = 1$。\n- 来自 $WW$ 亲本的 $D$ 配子频率：$P_{WW}(D) = 0$。\n- 来自 $WW$ 亲本的 $R$ 配子频率：$P_{WW}(R) = 0$。\n\n**亲本2：杂合驱动携带者 ($WD$)**\n基因型为 $WD$ 的个体携带一个野生型等位基因 ($W$) 和一个驱动等位基因 ($D$)。在该个体的生殖系中，驱动机制会主动尝试转换 $W$ 等位基因。我们必须分析这两条染色体的走向，以确定最终的配子比例。\n\n在标准孟德尔遗传下，一半的配子将接收 $W$ 等位基因，另一半将接收 $D$ 等位基因。基因驱动过程会修饰那些本应接收 $W$ 等位基因的配子。\n\n让我们考虑携带 $W$ 等位基因的染色体的命运：\n- 以概率 $1-h$，不发生切割，该等位基因保持为 $W$。\n- 以概率 $h$，该等位基因被 Cas$9$ 核酸酶切割。\n  - 在发生切割的条件下，以概率 $1-r$ 通过同源指导修复 (HDR) 进行修复，将 $W$ 等位基因转换为 $D$ 等位基因。此路径的总概率为 $h(1-r)$。\n  - 在发生切割的条件下，以概率 $r$ 通过非同源末端连接 (NHEJ) 进行修复，将 $W$ 等位基因转换为抗性等位基因 $R$。此路径的总概率为 $hr$。\n\n最初携带 $D$ 等位基因的染色体不被驱动机制靶向，并保持不变地传递下去。\n\n因此，我们可以计算出 $WD$ 亲本产生的最终配子频率：\n- **$W$ 配子的频率, $P_{WD}(W)$:** 这些配子仅在未发生归巢时，来自于携带 $W$ 的染色体。这部分构成了总配子的一半。\n$$P_{WD}(W) = \\frac{1}{2}(1 - h)$$\n- **$R$ 配子的频率, $P_{WD}(R)$:** 这些配子仅在切割后发生 NHEJ 时，来自于携带 $W$ 的染色体。\n$$P_{WD}(R) = \\frac{1}{2}hr$$\n- **$D$ 配子的频率, $P_{WD}(D)$:** 这些配子来自两个来源：（1）原始携带 $D$ 的染色体，构成了配子的一半；（2）携带 $W$ 的染色体在切割后发生 HDR。\n$$P_{WD}(D) = \\frac{1}{2} + \\frac{1}{2}h(1-r)$$\n\n作为验证，这些概率的总和必须为 $1$：\n$$P_{WD}(W) + P_{WD}(D) + P_{WD}(R) = \\frac{1}{2}(1-h) + \\left(\\frac{1}{2} + \\frac{1}{2}h(1-r)\\right) + \\frac{1}{2}hr$$\n$$= \\frac{1}{2} - \\frac{h}{2} + \\frac{1}{2} + \\frac{h}{2} - \\frac{hr}{2} + \\frac{hr}{2} = 1$$\n频率总和为 $1$，符合要求。\n\n**步骤2：子代合子基因型频率**\n\n子代基因型是由来自 $WW$ 亲本的配子和来自 $WD$ 亲本的配子随机结合形成的。由于 $WW$ 亲本只产生 $W$ 配子（频率为 $1$），子代的基因型完全由来自 $WD$ 亲本的配子所携带的等位基因决定。\n\n- **$WW$ 子代的频率, $f(WW)$:** 来自 $WW$ 亲本的 $W$ 配子与来自 $WD$ 亲本的 $W$ 配子受精。\n$$f(WW) = P_{WW}(W) \\times P_{WD}(W) = 1 \\times \\frac{1}{2}(1-h) = \\frac{1}{2}(1-h)$$\n- **$WD$ 子代的频率, $f(WD)$:** 来自 $WW$ 亲本的 $W$ 配子与来自 $WD$ 亲本的 $D$ 配子受精。\n$$f(WD) = P_{WW}(W) \\times P_{WD}(D) = 1 \\times \\left(\\frac{1}{2} + \\frac{1}{2}h(1-r)\\right) = \\frac{1}{2} + \\frac{1}{2}h(1-r)$$\n- **$WR$ 子代的频率, $f(WR)$:** 来自 $WW$ 亲本的 $W$ 配子与来自 $WD$ 亲本的 $R$ 配子受精。\n$$f(WR) = P_{WW}(W) \\times P_{WD}(R) = 1 \\times \\frac{1}{2}hr = \\frac{1}{2}hr$$\n- **$DD$、$DR$ 和 $RR$ 子代的频率:** 这些基因型需要来自 $WW$ 亲本的 $D$ 或 $R$ 等位基因。由于 $WW$ 亲本不能产生此类配子，这些基因型的频率为零。\n$$f(DD) = 0$$\n$$f(DR) = 0$$\n$$f(RR) = 0$$\n\n**步骤3：数值计算**\n\n问题给出了具体的参数值 $h = 0.9$ 和 $r = 0.05$。我们将这些值代入推导出的公式中。\n\n- $f(WW) = \\frac{1}{2}(1 - 0.9) = \\frac{1}{2}(0.1) = 0.05$\n- $f(WD) = \\frac{1}{2} + \\frac{1}{2}(0.9)(1 - 0.05) = 0.5 + 0.5(0.9)(0.95) = 0.5 + 0.45(0.95) = 0.5 + 0.4275 = 0.9275$\n- $f(WR) = \\frac{1}{2}(0.9)(0.05) = 0.5(0.045) = 0.0225$\n- $f(DD) = 0$\n- $f(DR) = 0$\n- $f(RR) = 0$\n\n子代频率的总和为 $0.05 + 0.9275 + 0.0225 + 0 + 0 + 0 = 1.0$，这验证了计算结果。\n\n最终结果是基因型频率的有序向量 $(f(WW),\\, f(WD),\\, f(WR),\\, f(DD),\\, f(DR),\\, f(RR))$。\n该向量为 $(0.05,\\, 0.9275,\\, 0.0225,\\, 0,\\, 0,\\, 0)$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 0.05  0.9275  0.0225  0  0  0 \\end{pmatrix}} $$"
        },
        {
            "introduction": "为了使基因驱动有效，当它被引入一个大型野生种群时，必须能够从稀有状态开始增加其频率。这个练习探讨了基因驱动的归巢效率与其可能带来的适合度成本之间的关键权衡，并推导了驱动成功入侵所需的最小归巢效率。这个阈值是评估任何基因驱动策略可行性的核心参数 。",
            "id": "3914106",
            "problem": "考虑一个大的、随机交配的二倍体种群，在单个基因座上有两个等位基因：一个基因驱动等位基因 $D$ 和一个野生型等位基因 $W$。假设世代是不重叠的离散世代，并且在每一代开始时都处于哈迪-温伯格平衡（HWE）状态。该基因驱动是归巢型的：在一个 $D/W$ 杂合子中，在配子发生过程中，野生型等位基因被切割并通过同源指导修复以每个配子 $h$ 的概率被修复，从而产生一个携带 $D$ 而不是 $W$ 的配子。没有抗性等位基因的形成，因此抗性率为 $r=0$。生存力选择在繁殖前起作用：$W/W$ 个体的生存力为 $1$，而 $D/W$ 杂合子的生存力因选择系数 $s$ 而降低，因此其生存力为 $1-s$。你可以假设，当 $D$ 稀有时，$D/D$ 纯合子足够罕见，以至于它们对入侵分析的贡献可以忽略不计。\n\n令 $p_t$ 表示在第 $t$ 代成年个体中等位基因 $D$ 的频率，并考虑从稀有状态入侵的条件，即当 $p_t$ 接近于零时 $p_{t+1}$ 的行为。从第一性原理出发，基于哈迪-温伯格平衡和上述定义，推导当等位基因 $D$ 稀有时其频率增加所需的最小归巢效率 $h_{\\min}$。用包含 $s$ 的单个闭式解析表达式表示你的最终答案。不需要四舍五入，也不需要单位。",
            "solution": "用户希望我解决提示中描述的问题。\n\n### 第1步：提取已知条件\n- 种群：大的、随机交配的、二倍体。\n- 世代：离散、不重叠。\n- 等位基因：基因驱动等位基因 ($D$) 和野生型等位基因 ($W$)。\n- 初始状态：每代开始时处于哈迪-温伯格平衡（HWE）。\n- 基因驱动：归巢型。\n- 归巢效率：$h$。在 $D/W$ 杂合子中，一个野生型等位基因以每个配子 $h$ 的概率被转换为 $D$ 等位基因。\n- 抗性率：$r=0$。\n- 生存力选择：\n  - $W/W$ 生存力为 $1$。\n  - $D/W$ 生存力为 $1-s$。\n  - $D/D$ 纯合子的贡献在入侵分析中可忽略不计。\n- 符号：$p_t$ 是第 $t$ 代成年个体中等位基因 $D$ 的频率。\n- 目标：推导当等位基因 $D$ 稀有时其频率增加所需的最小归巢效率 $h_{\\min}$，并用 $s$ 表示。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题描述了一个基于归巢的基因驱动的标准简化模型，这是群体遗传学和合成生物学中一个成熟的概念。离散世代、随机交配和HWE的假设是创建基线数学模型的常见且有效的假设。该模型在科学上是合理的。\n- **适定性：** 这是一个适定问题。它提供了所有必要的参数（$s$，$h$）和一个明确的目标（找到入侵所需的 $h_{\\min}$）。“稀有时增加”的条件是稳定性分析中的一个标准准则，会导出一个唯一的阈值。\n- **客观性：** 问题以精确、定量和无偏见的语言陈述。\n- **缺陷清单：**\n  1. **科学/事实不准确：** 无。该模型是该领域使用的有效简化模型。\n  2. **无法形式化/不相关：** 无。该问题是群体遗传学建模的一个经典例子，与*基因驱动种群动态*直接相关。\n  3. **不完整/矛盾：** 无。问题是自洽的。忽略 $D/D$ 纯合子的指令是进行从稀有状态入侵分析（线性稳定性分析）时标准且必要的简化，并非矛盾。\n  4. **不切实际/不可行：** 无。参数是符号性的。该模型代表了一种合理的生物学权衡。\n  5. **不适定/结构不良：** 无。问题结构清晰，能导出一个唯一且有意义的解。\n  6. **伪深刻/琐碎：** 无。推导过程需要仔细、逐步地应用群体遗传学原理，并非琐碎。\n  7. **超出科学可验证范围：** 无。该模型是数学模型，其预测是可验证的。\n\n### 第3步：结论与行动\n该问题是有效的。我将继续进行解答。\n\n要推导最小归巢效率 $h_{\\min}$，需要建立驱动等位基因频率 $p_t$ 的递推关系，然后分析该等位基因在稀有时（即当 $p_t \\to 0$ 时）频率增加的条件。\n\n令 $p_t$ 为第 $t$ 代成年个体中驱动等位基因 $D$ 的频率，$q_t = 1 - p_t$ 为野生型等位基因 $W$ 的频率。\n\n1.  **合子形成：** 假设随机交配，下一代（$t+1$）合子中三种基因型（$D/D$、$D/W$、$W/W$）的频率由哈迪-温伯格比例给出：\n    -   $f_{D/D, \\text{合子}} = p_t^2$\n    -   $f_{D/W, \\text{合子}} = 2p_t q_t = 2p_t(1-p_t)$\n    -   $f_{W/W, \\text{合子}} = q_t^2 = (1-p_t)^2$\n\n2.  **生存力选择：** 生存力选择作用于这些合子。相对生存力为 $w_{D/D}$（未指定，但其贡献可忽略不计）、$w_{D/W} = 1-s$ 和 $w_{W/W} = 1$。存活至成年的基因型比例为：\n    -   $D/D$：$p_t^2 w_{D/D}$\n    -   $D/W$：$2p_t(1-p_t)(1-s)$\n    -   $W/W$：$(1-p_t)^2(1)$\n    问题陈述中提到，对于入侵分析，我们可以忽略 $D/D$ 纯合子的贡献，这对应于分析 $p_t \\to 0$ 时的动力学。在此极限下，$D/D$ 个体的频率 $p_t^2$ 是比 $D/W$ 个体频率 $2p_t(1-p_t) \\approx 2p_t$ 更低阶的量，可以忽略。\n\n3.  **成年个体频率与平均适合度：** 种群的平均适合度 $\\bar{w}$ 是存活基因型频率的总和。对于小的 $p_t$，我们有：\n    $$ \\bar{w} = (1-p_t)^2 + 2p_t(1-p_t)(1-s) $$\n    将在繁殖中贡献的成年幸存者中，各基因型的频率通过除以平均适合度 $\\bar{w}$ 进行归一化得到：\n    -   $f'_{D/W} = \\frac{2p_t(1-p_t)(1-s)}{\\bar{w}}$\n    -   $f'_{W/W} = \\frac{(1-p_t)^2}{\\bar{w}}$\n\n4.  **带基因驱动的配子产生：** 这些成年个体产生配子。\n    -   $W/W$ 成年个体只产生 $W$ 配子。\n    -   在一个 $D/W$ 杂合子中，等位基因 $D$ 以 $\\frac{1}{2}$ 的基准概率被遗传。归巢机制将本应携带 $W$ 的配子中的 $h$ 比例转化为 $D$ 配子。因此，一个 $D/W$ 个体产生的 $D$ 配子比例为 $\\frac{1}{2} + h \\cdot \\frac{1}{2} = \\frac{1}{2}(1+h)$。\n\n5.  **下一代中的等位基因频率：** 下一代中等位基因 $D$ 的频率 $p_{t+1}$ 是总配子池中 $D$ 配子的频率。这可以通过对每个成年基因型的贡献求和得到：\n    $$ p_{t+1} = \\underbrace{(0) \\cdot f'_{W/W}}_{\\text{来自 } W/W} + \\underbrace{\\left(\\frac{1}{2}(1+h)\\right) \\cdot f'_{D/W}}_{\\text{来自 } D/W} $$\n    我们再次忽略 $D/D$ 的贡献。代入 $f'_{D/W}$ 的表达式：\n    $$ p_{t+1} = \\frac{1}{2}(1+h) \\frac{2p_t(1-p_t)(1-s)}{\\bar{w}} $$\n    $$ p_{t+1} = \\frac{p_t(1-p_t)(1+h)(1-s)}{(1-p_t)^2 + 2p_t(1-p_t)(1-s)} $$\n    这个方程 $p_{t+1} = F(p_t)$ 定义了等位基因频率从一代到下一代的变化。\n\n6.  **入侵分析：** 如果初始增长率大于 $1$，那么等位基因 $D$ 在稀有时频率会增加。这由递推关系 $F(p_t)$ 在灭绝不动点 $p_t=0$ 处的导数决定。入侵的条件是 $F'(0) > 1$。\n    为了求得 $F'(0)$，我们可以使用商法则 $F'(p_t) = \\frac{N'(p_t)D(p_t) - N(p_t)D'(p_t)}{[D(p_t)]^2}$，其中 $N(p_t)$ 是 $F(p_t)$ 的分子，$D(p_t)$ 是分母。\n    让我们在 $p_t=0$ 处计算各分量：\n    -   $N(p_t) = p_t(1-p_t)(1+h)(1-s) \\implies N(0) = 0$。\n    -   $N'(p_t) = (1-2p_t)(1+h)(1-s) \\implies N'(0) = (1+h)(1-s)$。\n    -   $D(p_t) = (1-p_t)^2 + 2p_t(1-p_t)(1-s) \\implies D(0) = (1-0)^2 = 1$。\n    -   由于 $N(0)=0$，我们不需要计算 $D'(0)$。\n\n    将这些代入在 $p_t=0$ 处的导数公式：\n    $$ F'(0) = \\frac{N'(0)D(0) - N(0)D'(0)}{[D(0)]^2} = \\frac{((1+h)(1-s)) \\cdot 1 - 0 \\cdot D'(0)}{1^2} = (1+h)(1-s) $$\n    因此，入侵条件为：\n    $$ (1+h)(1-s) > 1 $$\n\n7.  **最小归巢效率：** 入侵所需的最小归巢效率 $h_{\\min}$ 是满足增长率恰好为 $1$ 的边界条件的 $h$ 值：\n    $$ (1+h_{\\min})(1-s) = 1 $$\n    求解 $h_{\\min}$：\n    $$ 1 + h_{\\min} = \\frac{1}{1-s} $$\n    $$ h_{\\min} = \\frac{1}{1-s} - 1 $$\n    为了得到一个单一分数，我们通分：\n    $$ h_{\\min} = \\frac{1 - (1-s)}{1-s} = \\frac{1-1+s}{1-s} = \\frac{s}{1-s} $$\n    该表达式给出了克服杂合子适合度成本 $s$ 并使基因驱动在初始稀有时能够在种群中传播所需的最小归巢效率。",
            "answer": "$$ \\boxed{\\frac{s}{1-s}} $$"
        },
        {
            "introduction": "许多基因驱动的最终目标是改变种群动态，例如抑制传播疾病的媒介。这项高级实践将遗传模型与生态学原理（如密度依赖和阿利效应）相结合，以预测等位基因频率和种群总规模的瞬时动态。通过构建并运行一个计算模拟，您将把抽象的数学模型与基因驱动技术在种群控制方面的实际应用联系起来 。",
            "id": "3914103",
            "problem": "您的任务是为一个受归巢基因驱动（HGD）影响的二倍体种群建立瞬时动态模型。该基因驱动具有扭曲传递和生存力成本，并且种群受带有Allee效应的密度依赖性制约。设离散世代$t$的种群大小为$N(t)$，成年个体中驱动等位基因的频率为$p(t)$。在世代$t = 0$释放后，成年个体驱动等位基因的频率为$p(0) = p_0$，成年种群大小为$N(0) = N_0$。假设随机交配，合子中的Hardy-Weinberg（HW）基因型比例，以及仅存在特定于基因型的生存力选择。在HGD中，杂合子经历种系归巢，以归巢概率$c$增加驱动等位基因的传递，并且没有抗性等位基因的形成。假设野生型基因型的生存力适应度为$w_{WW} = 1$，杂合子的生存力适应度为$w_{WD} = 1 - s_H$，驱动纯合子的生存力适应度为$w_{DD} = 1 - s_D$，其中$s_H$和$s_D$为非负成本。生态动态包括一个Allee阈值$A$，低于该阈值时，人均增长为负。对于密度依赖性，假设环境承载力为$K$，人均增长的内在尺度为$r$。时间以离散世代为单位。\n\n从群体遗传学（孟德尔分离、HW、随机交配和特定基因型生存力选择）和种群生态学（密度依赖性增长和Allee效应）中上述经过充分检验的基础出发，根据第一性原理，推导$N(t+1)$和$p(t+1)$关于$N(t)$、$p(t)$和参数$(K, A, r, c, s_H, s_D)$的耦合离散时间递推关系。您的推导必须：\n- 表达在归巢传递扭曲下，成年个体产生的配子池中驱动等位基因的比例，\n- 根据配子等位基因比例，在HW条件下构建合子基因型比例，\n- 应用生存力选择以获得成年基因型比例，\n- 从选择后的基因型比例计算成年驱动等位基因频率$p(t+1)$，\n- 将$N(t+1)$的生态递推与合子到成年个体的平均生存力以及经Allee效应修正的密度依赖性耦合起来。\n\n然后，实现一个程序，给定一个小的参数集测试套件，模拟$T$个世代（从$(N(0), p(0))$开始），计算整个瞬时轨迹$\\{N(t), p(t)\\}$，并为每个测试用例返回一个布尔值，指示种群大小是否在任何世代$t \\in \\{0, 1, \\dots, T\\}$严格低于Allee阈值$A$。\n\n使用以下包含5个参数集的科学上合理的测试套件，每个参数集指定为一个元组$(N_0, p_0, K, A, r, c, s_H, s_D, T)$，所有参数均无量纲，时间单位为世代：\n- 情况1：$(N_0 = 5000, p_0 = 0.10, K = 10000, A = 500, r = 0.80, c = 0.80, s_H = 0.05, s_D = 0.10, T = 200)$，\n- 情况2：$(N_0 = 800, p_0 = 0.20, K = 10000, A = 1000, r = 1.00, c = 0.95, s_H = 0.30, s_D = 0.60, T = 200)$，\n- 情况3：$(N_0 = 1000, p_0 = 0.10, K = 10000, A = 1000, r = 0.80, c = 0.90, s_H = 0.10, s_D = 0.30, T = 200)$，\n- 情况4：$(N_0 = 8000, p_0 = 0.20, K = 10000, A = 1000, r = 0.80, c = 0.00, s_H = 0.20, s_D = 0.40, T = 200)$，\n- 情况5：$(N_0 = 3000, p_0 = 0.30, K = 5000, A = 500, r = 2.00, c = 0.70, s_H = 0.10, s_D = 0.20, T = 200)$。\n\n为确保数值稳定性，在您的模拟中，必须确保在所有时间$N(t) \\ge 0$和$p(t) \\in [0, 1]$（必要时进行截断）。如果生态递推产生负的中间种群，则将下一个种群视为$0$。角度单位不适用。不使用物理单位。百分比必须表示为$[0,1]$范围内的小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[result_1,result_2,\\dots]$），其中每个$result_i$是对应于第$i$个测试用例的布尔值。",
            "solution": "该问题是有效的，因为它科学地基于群体遗传学和生态学的既定模型，问题阐述清晰、客观，并包含了推导和实现解决方案所需的所有必要信息。\n\n任务是推导种群大小$N(t)$和基因驱动等位基因频率$p(t)$的耦合离散时间递推关系，然后针对一组给定的参数模拟这些动态。\n\n### 递推关系的推导\n\n我们从第一性原理出发，遵循一个二倍体、随机交配种群的生命周期。设$W$为野生型等位基因，$D$为归巢基因驱动等位基因。\n\n**1. 遗传动态：从成年个体到配子再到新成年个体**\n\n设$p(t)$为世代$t$成年种群中$D$等位基因的频率。假设成年种群处于Hardy-Weinberg (HW) 平衡状态，则野生型纯合子($WW$)、杂合子($WD$)和驱动纯合子($DD$)的基因型频率为：\n$$f_{WW}(t) = (1-p(t))^2$$\n$$f_{WD}(t) = 2p(t)(1-p(t))$$\n$$f_{DD}(t) = p(t)^2$$\n\n这些成年个体产生配子以形成下一代。\n- $WW$个体只产生$W$配子。\n- $DD$个体只产生$D$配子。\n- 由于归巢过程，$WD$杂合子经历非孟德尔遗传。驱动等位基因$D$通过将自身复制到携带$W$等位基因的同源染色体上来实现“归巢”。这以概率$c$发生。因此，种系中$W$等位基因的一部分（比例为$c$）被转化为$D$等位基因。因此，一个$WD$个体产生的$D$配子比例为$(1+c)/2$，产生的$W$配子比例为$(1-c)/2$，而不是标准的孟德尔遗传中各占$1/2$。\n\n配子池中$D$等位基因的频率$p_g(t)$是各种基因型贡献的总和，按其在成年种群中的频率加权：\n$$p_g(t) = (0) \\cdot f_{WW}(t) + \\left(\\frac{1+c}{2}\\right) \\cdot f_{WD}(t) + (1) \\cdot f_{DD}(t)$$\n代入HW频率：\n$$p_g(t) = \\left(\\frac{1+c}{2}\\right) \\cdot 2p(t)(1-p(t)) + p(t)^2$$\n$$p_g(t) = (1+c)p(t)(1-p(t)) + p(t)^2$$\n$$p_g(t) = p(t) + c \\cdot p(t)(1-p(t))$$\n该方程描述了由于归巢，驱动等位基因在配子池中频率的增加。\n\n下一代的合子是由这些配子的随机结合形成的。在世代$t+1$，选择前的基因型频率遵循基于配子等位基因频率$p_g(t)$的HW比例：\n$$f'_{WW} = (1-p_g(t))^2$$\n$$f'_{WD} = 2p_g(t)(1-p_g(t))$$\n$$f'_{DD} = p_g(t)^2$$\n\n这些合子受到生存力选择。相对生存力（适应度）给定为$w_{WW} = 1$、$w_{WD} = 1 - s_H$和$w_{DD} = 1 - s_D$，其中$s_H$和$s_D$是适应度成本。\n\n种群的平均生存力适应度$\\bar{w}(t)$是所有基因型适应度的加权平均值，权重为它们在选择前的频率：\n$$\\bar{w}(t) = f'_{WW}w_{WW} + f'_{WD}w_{WD} + f'_{DD}w_{DD}$$\n$$\\bar{w}(t) = (1-p_g(t))^2(1) + 2p_g(t)(1-p_g(t))(1-s_H) + p_g(t)^2(1-s_D)$$\n\n在世代$t+1$，存活下来的成年个体中各基因型的频率通过除以平均适应度进行归一化得到：\n$$f_{WW}(t+1) = \\frac{f'_{WW}w_{WW}}{\\bar{w}(t)}, \\quad f_{WD}(t+1) = \\frac{f'_{WD}w_{WD}}{\\bar{w}(t)}, \\quad f_{DD}(t+1) = \\frac{f'_{DD}w_{DD}}{\\bar{w}(t)}$$\n\n在世代$t+1$的成年种群中，驱动等位基因$D$的频率$p(t+1)$是$DD$成年个体的频率加上$WD$成年个体频率的一半：\n$$p(t+1) = f_{DD}(t+1) + \\frac{1}{2}f_{WD}(t+1)$$\n$$p(t+1) = \\frac{p_g(t)^2(1-s_D)}{\\bar{w}(t)} + \\frac{2p_g(t)(1-p_g(t))(1-s_H)}{2\\bar{w}(t)}$$\n$$p(t+1) = \\frac{p_g(t)^2(1-s_D) + p_g(t)(1-p_g(t))(1-s_H)}{\\bar{w}(t)}$$\n这是第一个递推关系，描述了驱动等位基因频率的演化。\n\n**2. 生态动态与耦合**\n\n种群大小的动态受密度依赖性控制，包括环境承载力$K$和Allee阈值$A$。参数$r$是人均增长的内在尺度。对于离散时间模型，人均增长率可以被建模为在低于$A$时为负，在种群远超$K$时也为负。一个包含这些效应的标准函数形式是$g(N) = r(1 - N/K)(N/A - 1)$。由大小为$N(t)$的成年种群产生的后代（合子）数量为$N_{zygotes} = N(t) \\cdot \\exp(g(N(t)))$，这是连续增长的离散时间模拟。\n\n$$N_{zygotes} = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right)$$\n\n此表达式模拟了密度依赖性的繁殖力。下一代成年个体的数量$N(t+1)$是存活到成年的合子数量。这种存活由种群的平均生存力适应度$\\bar{w}(t)$决定，该适应度考虑了由驱动的适应度成本施加的遗传负荷。\n\n因此，我们将生态和遗传动态耦合起来：\n$$N(t+1) = N_{zygotes} \\cdot \\bar{w}(t)$$\n$$N(t+1) = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right) \\cdot \\bar{w}(t)$$\n这是第二个递推关系，用于总种群大小。\n\n**3. 耦合系统总结**\n\n需要模拟的耦合递推关系完整系统如下：\n给定$N(t)$和$p(t)$：\n1. 计算配子池中的驱动等位基因频率：\n   $$p_g(t) = p(t) + c \\cdot p(t)(1-p(t))$$\n2. 计算后代代的平均适应度：\n   $$\\bar{w}(t) = (1-p_g(t))^2 + 2p_g(t)(1-p_g(t))(1-s_H) + p_g(t)^2(1-s_D)$$\n3. 计算下一代的成年种群大小：\n   $$N(t+1) = N(t) \\exp\\left(r\\left(1 - \\frac{N(t)}{K}\\right)\\left(\\frac{N(t)}{A} - 1\\right)\\right) \\cdot \\bar{w}(t)$$\n4. 计算下一代的成年驱动等位基因频率：\n   $$p(t+1) = \\frac{p_g(t)(1-p_g(t))(1-s_H) + p_g(t)^2(1-s_D)}{\\bar{w}(t)}$$\n\n从初始条件$(N_0, p_0)$开始，对这些方程进行$T$个世代的迭代。在模拟过程中，我们必须检查$N(t)$是否在任何$t \\in \\{0, 1, \\dots, T\\}$时低于$A$。为保证稳定性，需对$N(t)$在$0$处以及$p(t)$在$[0, 1]$范围内进行数值截断。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates the population dynamics of a homing gene drive under density dependence\n    with an Allee effect, and determines if the population ever drops below the Allee threshold.\n    \"\"\"\n    # Test cases defined as tuples:\n    # (N0, p0, K, A, r, c, s_H, s_D, T)\n    test_cases = [\n        (5000, 0.10, 10000, 500, 0.80, 0.80, 0.05, 0.10, 200),\n        (800, 0.20, 10000, 1000, 1.00, 0.95, 0.30, 0.60, 200),\n        (1000, 0.10, 10000, 1000, 0.80, 0.90, 0.10, 0.30, 200),\n        (8000, 0.20, 10000, 1000, 0.80, 0.00, 0.20, 0.40, 200),\n        (3000, 0.30, 5000, 500, 2.00, 0.70, 0.10, 0.20, 200),\n    ]\n\n    results = []\n    for case in test_cases:\n        N0, p0, K, A, r, c, s_H, s_D, T = case\n\n        N = float(N0)\n        p = float(p0)\n        \n        # Flag to track if the population size falls below the Allee threshold.\n        crashed = False\n\n        # Check the initial condition at t=0\n        if N  A:\n            crashed = True\n        \n        if not crashed:\n            # Simulate for T generations\n            for t in range(T):\n                # Ensure p is within [0, 1] to avoid numerical issues\n                p = np.clip(p, 0.0, 1.0)\n                \n                # If population is extinct, it stays extinct.\n                if N == 0:\n                    crashed = True\n                    break\n\n                # 1. Calculate drive allele frequency in the gamete pool\n                p_g = p + c * p * (1 - p)\n\n                # 2. Calculate mean fitness\n                w_bar = ( (1 - p_g)**2 \n                        + 2 * p_g * (1 - p_g) * (1 - s_H) \n                        + p_g**2 * (1 - s_D) )\n\n                # Handle potential division by zero if w_bar is 0 or very close.\n                # This could happen if s_D=1 and p_g=1, or s_H=1 and p_g is not 0 or 1 etc.\n                if w_bar = 0:\n                    N = 0.0\n                    # p is undefined, but since N=0, it doesn't matter. Let's set to 0.\n                    p = 0.0\n                    crashed = True\n                    break\n\n                # 3. Calculate next generation's allele frequency\n                p_next = (p_g * (1 - p_g) * (1 - s_H) + p_g**2 * (1 - s_D)) / w_bar\n                \n                # 4. Calculate next generation's population size\n                # The ecological term can result in a huge exponent, we handle this.\n                if N/K > 1e6 or K == 0 or A == 0: # Avoid overflow/division by zero\n                    # If N is huge compared to K, or K/A are zero, the exp term will be ~0\n                    # For N >> K, (1-N/K) is large negative, exp(...) -> 0\n                    growth_factor_arg = -np.inf\n                else:\n                    growth_factor_arg = r * (1 - N / K) * (N / A - 1)\n                \n                # Use np.exp which is robust to overflow/underflow\n                growth_factor = np.exp(growth_factor_arg)\n                \n                N_next = N * growth_factor * w_bar\n\n                # Update state variables for the next generation\n                N = N_next\n                p = p_next\n\n                # Clip N to be non-negative\n                N = np.max([0.0, N])\n\n                # Check if population has fallen below the Allee threshold\n                if N  A:\n                    crashed = True\n                    break\n        \n        results.append(crashed)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}