{
    "hands_on_practices": [
        {
            "introduction": "This first exercise establishes the foundational mechanics of singular perturbation analysis. By casting a simple gene regulation model into its canonical fast-slow form, you will practice identifying the distinct time scales and deriving the effective dynamics that govern the system's long-term behavior . Mastering this procedure is the essential first step toward confidently applying model reduction in more complex biological systems.",
            "id": "3918750",
            "problem": "Consider a minimal gene regulation module in which a protein concentration $p$ is driven by a transcriptional signal $s$. The mechanistic model in dimensionless form is given by the ordinary differential equations (ODEs)\n$$\n\\dot{p} \\;=\\; \\alpha\\, s \\;-\\; \\gamma_p\\, p,\\qquad \\epsilon\\, \\dot{s} \\;=\\; \\beta \\;-\\; s \\;+\\; \\eta\\, p,\n$$\nwhere $\\alpha$, $\\beta$, $\\gamma_p$, and $\\eta$ are positive parameters, and $0  \\epsilon \\ll 1$ quantifies a separation of time scales between the transcriptional signal $s$ and the protein $p$. Assume all variables and parameters are nondimensional. The small parameter $\\epsilon$ reflects that $s$ relaxes on a time scale that is much faster than that of $p$. You may assume the applicability of the classical singular perturbation framework of Tikhonov and Fenichel for fast–slow systems and standard properties of ODEs.\n\nStarting from the given ODEs and using only first principles of time-scale separation and singular perturbation analysis (no shortcut formulas), perform the following:\n\n- Introduce a fast time variable $\\tau$ satisfying $\\tau = t/\\epsilon$ and rewrite the system in canonical fast–slow form, clearly showing which variable is fast and which is slow.\n- Identify the critical (slow) manifold by taking the formal $\\epsilon \\to 0$ limit in the fast subsystem and justify its normal hyperbolicity by examining the linearization of the fast dynamics about the manifold.\n- Derive the leading-order reduced slow dynamics for $p(t)$ on the critical manifold.\n- State the boundary-layer (inner) dynamics for the fast variable in the fast time $\\tau$ with $p$ treated as a frozen parameter.\n- Report the explicit leading-order slow manifold function $h(p)$ that gives $s$ in terms of $p$ and parameters.\n\nAnswer specification: Provide $h(p)$ as a single closed-form analytic expression in terms of $p$, $\\beta$, and $\\eta$. Do not include an equality sign in your final answer. No units are required.",
            "solution": "The problem statement is a valid, well-posed problem in the domain of dynamical systems and synthetic biology modeling. It asks for a standard application of singular perturbation analysis to a fast-slow system of ordinary differential equations. All necessary information is provided, and the premises are scientifically and mathematically sound.\n\nThe system of ordinary differential equations (ODEs) is given by:\n$$\n\\frac{dp}{dt} = \\alpha s - \\gamma_p p\n$$\n$$\n\\epsilon \\frac{ds}{dt} = \\beta - s + \\eta p\n$$\nwhere $p$ is the protein concentration and $s$ is the transcriptional signal. The parameters $\\alpha$, $\\beta$, $\\gamma_p$, and $\\eta$ are positive constants. The parameter $\\epsilon$ is small and positive, $0  \\epsilon \\ll 1$, indicating that $s$ is a fast variable and $p$ is a slow variable.\n\n**Canonical Fast-Slow Form**\nTo analyze the system's time scales, we introduce a fast time variable $\\tau = t/\\epsilon$. This implies that $t = \\epsilon\\tau$. We use the chain rule to transform the derivatives with respect to $t$ to derivatives with respect to $\\tau$:\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt}\\frac{d}{d\\tau} = \\frac{1}{\\epsilon}\\frac{d}{d\\tau}\n$$\nApplying this to the system gives:\n$$\n\\frac{1}{\\epsilon}\\frac{dp}{d\\tau} = \\alpha s - \\gamma_p p \\quad \\implies \\quad \\frac{dp}{d\\tau} = \\epsilon (\\alpha s - \\gamma_p p)\n$$\n$$\n\\frac{1}{\\epsilon}(\\epsilon \\frac{ds}{dt}) = \\frac{1}{\\epsilon}(\\beta - s + \\eta p) \\quad \\implies \\quad \\frac{ds}{d\\tau} = \\beta - s + \\eta p\n$$\nThe system in the fast time scale $\\tau$ is therefore:\n$$\n\\frac{dp}{d\\tau} = \\epsilon (\\alpha s - \\gamma_p p)\n$$\n$$\n\\frac{ds}{d\\tau} = \\beta - s + \\eta p\n$$\nThis is the canonical fast-slow form. In the limit $\\epsilon \\to 0$, we have $\\frac{dp}{d\\tau} \\to 0$, showing that $p$ is the slow variable as it remains effectively constant on the fast time scale. Conversely, $\\frac{ds}{d\\tau}$ is of order $O(1)$, confirming that $s$ is the fast variable.\n\n**Critical Manifold and Normal Hyperbolicity**\nThe critical manifold, also known as the slow manifold $M_0$, is the set of points in the phase space where the fast dynamics are at equilibrium. This is found by setting $\\epsilon = 0$ in the original system. Specifically, we set the right-hand side of the fast variable's equation to zero:\n$$\n\\epsilon \\frac{ds}{dt} = \\beta - s + \\eta p \\quad \\xrightarrow{\\epsilon \\to 0} \\quad 0 = \\beta - s + \\eta p\n$$\nSolving this algebraic equation for the fast variable $s$ in terms of the slow variable $p$ gives the equation for the critical manifold:\n$$\ns = \\beta + \\eta p\n$$\nThis relationship defines the quasi-steady state of the fast variable.\n\nTo justify the normal hyperbolicity of this manifold, we analyze the stability of the fast dynamics for a fixed value of the slow variable $p$. The fast subsystem is given by the dynamics of $s$ in the fast time $\\tau$, treating $p$ as a parameter:\n$$\n\\frac{ds}{d\\tau} = \\beta + \\eta p - s\n$$\nThis is a linear, first-order ODE for $s(\\tau)$. The equilibrium is precisely $s = \\beta + \\eta p$, which defines the manifold $M_0$. To assess stability, we compute the Jacobian of the fast dynamics with respect to the fast variable $s$:\n$$\nJ_s = \\frac{\\partial}{\\partial s} (\\beta + \\eta p - s) = -1\n$$\nThe eigenvalue of this $1 \\times 1$ Jacobian is $\\lambda = -1$. Since the real part of the eigenvalue is strictly negative ($\\mathrm{Re}(\\lambda)  0$), the equilibrium point is asymptotically stable for any value of the parameter $p$. This uniform stability of the fast dynamics towards the manifold $M_0$ confirms that the critical manifold is normally hyperbolic (and attracting).\n\n**Reduced Slow Dynamics**\nThe reduced slow dynamics describe the evolution of the system on the critical manifold $M_0$. We obtain this by substituting the quasi-steady-state expression for the fast variable, $s = \\beta + \\eta p$, into the equation for the slow variable, $\\dot{p}$:\n$$\n\\frac{dp}{dt} = \\alpha s - \\gamma_p p\n$$\nSubstituting $s = \\beta + \\eta p$:\n$$\n\\frac{dp}{dt} = \\alpha (\\beta + \\eta p) - \\gamma_p p\n$$\n$$\n\\frac{dp}{dt} = \\alpha\\beta + \\alpha\\eta p - \\gamma_p p\n$$\nThis can be written as a single ODE for $p(t)$:\n$$\n\\frac{dp}{dt} = \\alpha\\beta - (\\gamma_p - \\alpha\\eta)p\n$$\nThis is the leading-order reduced slow dynamics for the protein concentration $p(t)$.\n\n**Boundary-Layer (Inner) Dynamics**\nThe boundary-layer dynamics describe the initial rapid transient as the fast variable $s$ approaches the critical manifold. These dynamics are captured by the fast subsystem, obtained by setting $\\epsilon=0$ in the system written in the fast time $\\tau$:\n$$\n\\frac{dp}{d\\tau} = 0\n$$\n$$\n\\frac{ds}{d\\tau} = \\beta - s + \\eta p\n$$\nThe first equation implies that the slow variable $p$ is \"frozen\" during this transient, i.e., $p(\\tau) = p(0)$, where $p(0)$ is the initial condition for $p$. The dynamics of the fast variable $s$ is therefore governed by:\n$$\n\\frac{ds}{d\\tau} = \\beta - s + \\eta p(0)\n$$\nThis equation describes the exponential relaxation of $s$ from its initial condition $s(0)$ to the point on the critical manifold corresponding to $p(0)$, which is $s_{eq} = \\beta + \\eta p(0)$.\n\n**Leading-Order Slow Manifold Function $h(p)$**\nThe problem asks for the explicit function $h(p)$ such that the slow manifold is given by $s = h(p)$. As derived in the identification of the critical manifold, this function is obtained by solving the quasi-steady-state condition $0 = \\beta - s + \\eta p$ for $s$.\nThis yields:\n$$\ns = \\beta + \\eta p\n$$\nTherefore, the function $h(p)$ is:\n$$\nh(p) = \\beta + \\eta p\n$$\nThis expression provides the leading-order approximation of the fast variable $s$ as a function of the slow variable $p$ after the initial boundary-layer transient has decayed.\n\nThe final answer required is the expression for $h(p)$.",
            "answer": "$$\n\\boxed{\\beta + \\eta p}\n$$"
        },
        {
            "introduction": "Having established the procedure for model reduction, we now explore one of its most important consequences: the robustness of slow dynamics. This exercise demonstrates how systems with time-scale separation can effectively buffer the slow variables from large, transient fluctuations in the fast variables . By quantifying the impact of a mismatched initial condition, you will gain a deeper intuition for why quasi-steady-state approximations are so powerful and why biological systems might evolve such architectures.",
            "id": "3918752",
            "problem": "A synthetic gene regulation module is modeled at the level of ordinary differential equations (ODEs) for a slow state variable (protein concentration) and a fast state variable (promoter occupancy). Let the protein concentration be denoted by $x(t)$ and the promoter occupancy by $y(t)$. After linearization around a physiological operating point, the module is described by the fast–slow system\n$$\n\\frac{dx}{dt} \\;=\\; \\alpha\\, y \\;-\\; \\beta\\, x,\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{1}{\\epsilon}\\,\\big(\\sigma \\;+\\; \\kappa\\, x \\;-\\; y\\big),\n$$\nwhere $\\alpha0$, $\\beta0$, $\\kappa\\ge 0$, and $\\sigma$ are $\\mathcal{O}(1)$ with respect to the small, dimensionless separation parameter $0\\epsilon\\ll 1$. The reduced slow manifold is given by the algebraic condition $y=\\sigma+\\kappa x$. Consider two initializations at the same $x(0)=x_0$ but with different $y(0)$: a well-prepared initial condition $y(0)=\\sigma+\\kappa x_0$ and a mismatched initial condition $y(0)=\\sigma+\\kappa x_0+\\Delta$ with $\\Delta=\\mathcal{O}(1)$. Using singular perturbation analysis (SPA), including inner (fast) and outer (slow) approximations where appropriate:\n\n1) Derive the leading-order inner solution for $y(t)$ on the fast time scale $t=\\mathcal{O}(\\epsilon)$ and the leading-order reduced (outer) dynamics for $x(t)$ on the slow time scale $t=\\mathcal{O}(1)$.\n\n2) Let $x_{\\Delta}(t)$ denote the solution for the mismatched initialization and $x_{0}(t)$ denote the solution for the well-prepared initialization. Derive the leading-order asymptotic form, valid for fixed $t0$ independent of $\\epsilon$, of the deviation $\\delta x(t):=x_{\\Delta}(t)-x_{0}(t)$ as $\\epsilon\\to 0$, in the form\n$$\n\\delta x(t) \\;\\sim\\; C\\,\\epsilon\\,\\exp(-\\beta t),\n$$\nand briefly explain, in words, why the fast transient in $y(t)$ only produces an $\\mathcal{O}(\\epsilon)$ effect on $x(t)$ for $t\\gg \\epsilon$ despite possibly large initial mismatch $\\Delta$.\n\n3) Report the coefficient $C$ as a closed-form analytic expression in terms of $\\alpha$, $\\beta$, $\\kappa$, $\\sigma$, $x_0$, and $\\Delta$. Your final answer must be this single expression for $C$.",
            "solution": "We start from the model\n$$\n\\frac{dx}{dt} \\;=\\; \\alpha\\, y \\;-\\; \\beta\\, x,\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{1}{\\epsilon}\\,\\big(\\sigma \\;+\\; \\kappa\\, x \\;-\\; y\\big),\n$$\nwhich exhibits time-scale separation because $0\\epsilon\\ll 1$. The fast variable $y(t)$ relaxes rapidly to the slow manifold $y=\\sigma+\\kappa x$, while $x(t)$ evolves on the slow time scale. This is the standard setting for singular perturbation analysis (SPA), in which one introduces an inner (fast) time and an outer (slow) description and matches them.\n\n1) Inner (fast) solution for $y(t)$ and outer (slow) dynamics for $x(t)$.\n\nIntroduce the fast time $\\tau = t/\\epsilon$. On this fast time, derivatives transform as $d/dt = (1/\\epsilon)\\,d/d\\tau$. To leading order over the initial boundary layer where $t=\\mathcal{O}(\\epsilon)$, the slow variable $x$ changes only by $\\mathcal{O}(\\epsilon)$ and can be treated as constant at its initial value $x(0)=x_0$ to leading order. The fast equation for $y$ becomes\n$$\n\\frac{dy}{d\\tau} \\;=\\; \\sigma + \\kappa x_0 - y,\n$$\nwith initial condition $y(0)=\\sigma+\\kappa x_0+\\Delta$ in the mismatched case. This linear ODE has the leading-order inner solution\n$$\ny_{\\text{in}}(\\tau) \\;=\\; \\sigma + \\kappa x_0 \\;+\\; \\Delta\\,\\exp(-\\tau),\n$$\nor, equivalently in the original time variable,\n$$\ny_{\\text{in}}(t) \\;=\\; \\sigma + \\kappa x_0 \\;+\\; \\Delta\\,\\exp\\!\\big(-t/\\epsilon\\big).\n$$\nThus, regardless of the magnitude of the initial mismatch $\\Delta=\\mathcal{O}(1)$, the fast variable $y$ returns exponentially quickly to the slow manifold on the $\\mathcal{O}(\\epsilon)$ time scale.\n\nFor the outer (slow) dynamics, we enforce the quasi-steady algebraic constraint $y=\\sigma+\\kappa x$ and substitute into the $x$-equation to obtain the reduced system:\n$$\n\\frac{dx}{dt} \\;=\\; \\alpha\\big(\\sigma+\\kappa x\\big) \\;-\\; \\beta x \\;=\\; \\alpha \\sigma \\;+\\; (\\alpha\\kappa - \\beta)\\,x.\n$$\nThis is the leading-order slow evolution for $x(t)$ on times $t=\\mathcal{O}(1)$ and longer.\n\n2) Leading-order asymptotic deviation $\\delta x(t)$ for fixed $t0$ as $\\epsilon\\to 0$.\n\nLet $x_{\\Delta}(t)$ be the $x$-trajectory corresponding to the mismatched initial condition for $y$, and $x_{0}(t)$ be the $x$-trajectory for the well-prepared initial condition (i.e., $\\Delta=0$), both with the same $x(0)=x_0$. Define the deviation\n$$\n\\delta x(t) \\;=\\; x_{\\Delta}(t) \\;-\\; x_{0}(t).\n$$\nSubtracting the $x$-equations for the two initializations yields the linear nonautonomous ODE for $\\delta x$:\n$$\n\\frac{d}{dt}\\,\\delta x(t) \\;=\\; \\alpha\\,\\delta y(t) \\;-\\; \\beta\\,\\delta x(t), \\qquad \\delta x(0)=0,\n$$\nwhere $\\delta y(t):=y_{\\Delta}(t)-y_{0}(t)$ is the difference between the fast states. To leading order, $y_{0}(t)$ is already on the slow manifold, while $y_{\\Delta}(t)$ follows the inner solution. During the fast transient, the slow variable $x$ changes by only $\\mathcal{O}(\\epsilon)$, so to leading order we may take\n$$\n\\delta y(t) \\;\\approx\\; \\Delta\\,\\exp\\!\\big(-t/\\epsilon\\big).\n$$\nTherefore, the linear ODE for $\\delta x$ with forcing $\\alpha\\,\\Delta\\,\\exp(-t/\\epsilon)$ and homogeneous decay rate $\\beta$ can be solved exactly by variation of constants:\n$$\n\\delta x(t) \\;=\\; \\alpha \\int_{0}^{t} \\exp\\!\\big(-\\beta (t-s)\\big)\\,\\Delta\\,\\exp\\!\\big(-s/\\epsilon\\big)\\,ds.\n$$\nCompute the integral explicitly:\n$$\n\\delta x(t) \\;=\\; \\alpha\\,\\Delta\\,\\exp\\!\\big(-\\beta t\\big)\\,\\int_{0}^{t} \\exp\\!\\Big(s\\big(\\beta - \\tfrac{1}{\\epsilon}\\big)\\Big)\\,ds\n\\;=\\; \\alpha\\,\\Delta\\,\\exp\\!\\big(-\\beta t\\big)\\,\\frac{1 - \\exp\\!\\big(-t(\\tfrac{1}{\\epsilon}-\\beta)\\big)}{\\tfrac{1}{\\epsilon}-\\beta}.\n$$\nFor fixed $t0$ independent of $\\epsilon$, as $\\epsilon\\to 0^{+}$ one has $\\tfrac{1}{\\epsilon}-\\beta \\to +\\infty$ and $\\exp\\!\\big(-t(\\tfrac{1}{\\epsilon}-\\beta)\\big)\\to 0$. Using the expansion\n$$\n\\frac{1}{\\tfrac{1}{\\epsilon}-\\beta} \\;=\\; \\frac{\\epsilon}{1-\\beta \\epsilon} \\;=\\; \\epsilon \\;+\\; \\mathcal{O}(\\epsilon^{2}),\n$$\nwe obtain the leading-order asymptotic form\n$$\n\\delta x(t) \\;\\sim\\; \\alpha\\,\\Delta\\,\\epsilon\\,\\exp\\!\\big(-\\beta t\\big), \\qquad \\epsilon\\to 0^{+},\\quad t=\\mathcal{O}(1).\n$$\nThus the requested coefficient in\n$$\n\\delta x(t) \\;\\sim\\; C\\,\\epsilon\\,\\exp\\!\\big(-\\beta t\\big)\n$$\nis\n$$\nC \\;=\\; \\alpha\\,\\Delta.\n$$\n\nIntuition for robustness: Although the initial mismatch $\\Delta$ produces an $\\mathcal{O}(1)$ deviation in the fast state $y(t)$, this deviation decays on the fast time scale $t=\\mathcal{O}(\\epsilon)$. The slow state $x(t)$ integrates the influence of $y(t)$ through the production term $\\alpha y$, so the net effect of the fast transient on $x$ is proportional to the area under the fast impulse, namely\n$$\n\\alpha \\int_{0}^{\\infty} \\Delta\\,\\exp\\!\\big(-t/\\epsilon\\big)\\,dt \\;=\\; \\alpha\\,\\Delta\\,\\epsilon,\n$$\nup to the slow decay factor $\\exp(-\\beta t)$ that accumulates after the transient. Consequently, for any fixed $t\\gg \\epsilon$, the deviation in $x(t)$ is only $\\mathcal{O}(\\epsilon)$, demonstrating robustness of the slow variable to large but short-lived mismatches in the fast variable.\n\n3) The coefficient $C$ appearing in the leading-order asymptotic deviation is\n$$\nC \\;=\\; \\alpha\\,\\Delta.\n$$\nThis expression is independent of $\\kappa$, $\\sigma$, and $x_0$ at leading order because those parameters only affect the location of the slow manifold and the matched slow evolution, not the area of the initial fast transient that drives the difference between the two $x$-trajectories.",
            "answer": "$$\\boxed{\\alpha\\,\\Delta}$$"
        },
        {
            "introduction": "The final practice bridges analytical theory with computational validation, a crucial step in modern modeling. While model reduction simplifies our equations, it is vital to understand how this simplification affects our predictions about the system's behavior, particularly its sensitivity to parameter changes . This exercise challenges you to implement a forward sensitivity analysis to quantitatively compare the full and reduced models, revealing which parameter sensitivities are preserved and which are altered by the approximation.",
            "id": "3918755",
            "problem": "Consider a synthetic gene expression module with a fast promoter-binding subnetwork driven by a constant transcription factor input. The full mechanistic model consists of messenger ribonucleic acid (mRNA), protein, and promoter–factor complex states under mass-action kinetics. Let the states be $m(t)$ for messenger ribonucleic acid, $p(t)$ for protein, and $c(t)$ for promoter–factor complex. Let the parameters be $\\theta = \\left[k_{\\mathrm{tx}},\\, k_{\\mathrm{tl}},\\, \\gamma_m,\\, \\gamma_p,\\, k_{\\mathrm{on}},\\, k_{\\mathrm{off}},\\, T_{\\mathrm{tot}},\\, \\varepsilon,\\, U\\right]$, where $k_{\\mathrm{tx}}$ is transcription rate, $k_{\\mathrm{tl}}$ is translation rate, $\\gamma_m$ is messenger ribonucleic acid degradation rate, $\\gamma_p$ is protein degradation rate, $k_{\\mathrm{on}}$ is on-rate for promoter–factor binding, $k_{\\mathrm{off}}$ is off-rate, $T_{\\mathrm{tot}}$ is total promoter concentration, $\\varepsilon$ is a small parameter scaling the fast binding dynamics, and $U$ is the constant transcription factor input concentration. The full Ordinary Differential Equation (ODE) model is\n$$\n\\frac{dm}{dt} = k_{\\mathrm{tx}}\\, c - \\gamma_m\\, m,\\qquad\n\\frac{dp}{dt} = k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p,\\qquad\n\\varepsilon\\, \\frac{dc}{dt} = k_{\\mathrm{on}}\\, (T_{\\mathrm{tot}} - c)\\, U - k_{\\mathrm{off}}\\, c,\n$$\nwith initial condition $m(0)=0$, $p(0)=0$, $c(0)=0$. The small parameter $\\varepsilon$ enforces that $c(t)$ is a fast state relative to $m(t)$ and $p(t)$. Under the singular perturbation assumption that the fast state relaxes quasi-instantaneously, the reduced model eliminates $c(t)$ via the quasi-steady algebraic relation $c^{\\ast} = T_{\\mathrm{tot}}\\, U / \\left(U + K_d\\right)$ with $K_d = k_{\\mathrm{off}}/k_{\\mathrm{on}}$, yielding the reduced ODEs\n$$\n\\frac{dm}{dt} = k_{\\mathrm{tx}}\\, c^{\\ast} - \\gamma_m\\, m,\\qquad\n\\frac{dp}{dt} = k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p,\n$$\nwith the same initial conditions $m(0)=0$, $p(0)=0$.\n\nYour task is to implement a local, time-$T$ output sensitivity analysis that compares the full and reduced models at a fixed finite time. Specifically, for each parameter vector $\\theta$, compute the logarithmic sensitivity of the protein output $p(T)$ with respect to each parameter,\n$$\nS_j^{\\log} = \\frac{\\theta_j}{\\max\\{p(T),\\, \\delta\\}}\\, \\frac{\\partial p(T)}{\\partial \\theta_j},\n$$\nfor each parameter index $j$, where $\\delta$ is a small positive constant used to avoid division by zero. Use forward sensitivity ODEs driven by the model Jacobians to compute $\\partial p(T)/\\partial \\theta_j$ for both the full and the reduced models, starting from zero initial sensitivities at $t=0$. Perform the comparison at the finite time $T=10$ (no physical units; treat all quantities as dimensionless). Define the absolute difference between the full and reduced logarithmic sensitivities for parameter $j$ as\n$$\n\\Delta_j = \\left| S_{j,\\mathrm{full}}^{\\log} - S_{j,\\mathrm{red}}^{\\log} \\right|.\n$$\nIdentify, for each test case, the set of parameter names for which $\\Delta_j \\ge \\tau$, where the threshold is $\\tau = 0.25$.\n\nYou must implement both sets of sensitivity equations from first principles using the model Jacobians. The forward sensitivity equations for a state vector $x(t)$ with dynamics $\\dot{x} = f(x,\\theta)$ and sensitivity matrix $S(t) = \\partial x / \\partial \\theta$ are\n$$\n\\frac{dS}{dt} = J_x(x,\\theta)\\, S + J_\\theta(x,\\theta),\n$$\nwhere $J_x = \\partial f / \\partial x$ and $J_\\theta = \\partial f / \\partial \\theta$. Initialize $S(0)$ as the zero matrix of appropriate size. Use a stiff integrator suitable for potentially small $\\varepsilon$.\n\nTest suite. Use the following $4$ parameter sets, each reported as an ordered list $\\left[k_{\\mathrm{tx}},\\, k_{\\mathrm{tl}},\\, \\gamma_m,\\, \\gamma_p,\\, k_{\\mathrm{on}},\\, k_{\\mathrm{off}},\\, T_{\\mathrm{tot}},\\, \\varepsilon,\\, U\\right]$:\n\n- Case $1$ (fast binding, strong activation): $\\left[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.01,\\, 2\\right]$.\n- Case $2$ (slow binding time scale): $\\left[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.5,\\, 2\\right]$.\n- Case $3$ (weak binding affinity): $\\left[50,\\, 5,\\, 1,\\, 0.2,\\, 1,\\, 20,\\, 1,\\, 0.01,\\, 2\\right]$.\n- Case $4$ (low transcription factor input): $\\left[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.01,\\, 0.05\\right]$.\n\nFor each case, compute the list of parameter names for which $\\Delta_j \\ge \\tau$, sorted by descending $\\Delta_j$; break ties by lexicographic order of the parameter names. Use the parameter name order $\\left[\\text{\"k\\_tx\"},\\, \\text{\"k\\_tl\"},\\, \\text{\"gamma\\_m\"},\\, \\text{\"gamma\\_p\"},\\, \\text{\"k\\_on\"},\\, \\text{\"k\\_off\"},\\, \\text{\"T\\_tot\"},\\, \\text{\"epsilon\"},\\, \\text{\"U\"}\\right]$ corresponding to $\\theta$ as defined above. Use the small constant $\\delta = 10^{-12}$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is itself a list of parameter names for one test case (e.g., $[\\,[\\text{\"k\\_on\"}],\\,[\\text{\"k\\_on\"},\\text{\"k\\_off\"}]\\,]$). No units are required; all quantities are dimensionless. The answer for each test case is a list of strings.",
            "solution": "The user requires a comparison of local output sensitivities between a full and a reduced model of a synthetic gene circuit. The comparison is to be performed at a fixed time point, $T=10$, by computing logarithmic sensitivities for a set of model parameters. The core of the task is to implement the forward sensitivity equations for both models.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **States (full model)**: $m(t)$ (mRNA), $p(t)$ (protein), $c(t)$ (promoter-factor complex).\n- **Parameters**: $\\theta = \\left[k_{\\mathrm{tx}},\\, k_{\\mathrm{tl}},\\, \\gamma_m,\\, \\gamma_p,\\, k_{\\mathrm{on}},\\, k_{\\mathrm{off}},\\, T_{\\mathrm{tot}},\\, \\varepsilon,\\, U\\right]$.\n  - $k_{\\mathrm{tx}}$: transcription rate\n  - $k_{\\mathrm{tl}}$: translation rate\n  - $\\gamma_m$: mRNA degradation rate\n  - $\\gamma_p$: protein degradation rate\n  - $k_{\\mathrm{on}}$: promoter-factor binding on-rate\n  - $k_{\\mathrm{off}}$: promoter-factor binding off-rate\n  - $T_{\\mathrm{tot}}$: total promoter concentration\n  - $\\varepsilon$: small parameter for fast dynamics\n  - $U$: constant transcription factor input concentration\n- **Full Model ODEs**:\n$$\n\\frac{dm}{dt} = k_{\\mathrm{tx}}\\, c - \\gamma_m\\, m \\\\\n\\frac{dp}{dt} = k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p \\\\\n\\varepsilon\\, \\frac{dc}{dt} = k_{\\mathrm{on}}\\, (T_{\\mathrm{tot}} - c)\\, U - k_{\\mathrm{off}}\\, c\n$$\n- **Reduced Model ODEs**:\n$$\nc^{\\ast} = \\frac{T_{\\mathrm{tot}}\\, U}{U + K_d} \\quad \\text{with} \\quad K_d = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}} \\\\\n\\frac{dm}{dt} = k_{\\mathrm{tx}}\\, c^{\\ast} - \\gamma_m\\, m \\\\\n\\frac{dp}{dt} = k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p\n$$\n- **Initial Conditions**: $m(0)=0$, $p(0)=0$, $c(0)=0$. For the reduced model, $m(0)=0$, $p(0)=0$.\n- **Task**:\n  - Compute logarithmic sensitivity $S_j^{\\log} = \\frac{\\theta_j}{\\max\\{p(T),\\, \\delta\\}}\\, \\frac{\\partial p(T)}{\\partial \\theta_j}$ for full and reduced models.\n  - Compute absolute difference $\\Delta_j = \\left| S_{j,\\mathrm{full}}^{\\log} - S_{j,\\mathrm{red}}^{\\log} \\right|$.\n  - Identify parameters where $\\Delta_j \\ge \\tau$.\n- **Constants**: $T=10$, $\\delta = 10^{-12}$, $\\tau=0.25$.\n- **Forward Sensitivity Equations**: $\\frac{dS}{dt} = J_x(x,\\theta)\\, S + J_\\theta(x,\\theta)$ with $S(0) = 0$.\n- **Parameter Test Cases**:\n  1. $[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.01,\\, 2]$\n  2. $[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.5,\\, 2]$\n  3. $[50,\\, 5,\\, 1,\\, 0.2,\\, 1,\\, 20,\\, 1,\\, 0.01,\\, 2]$\n  4. $[50,\\, 5,\\, 1,\\, 0.2,\\, 100,\\, 10,\\, 1,\\, 0.01,\\, 0.05]$\n- **Output**: List of parameter names per case where $\\Delta_j \\ge \\tau$, sorted by descending $\\Delta_j$, then by name.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes a standard mass-action kinetics model for gene expression, a fundamental concept in systems and synthetic biology. The model reduction uses singular perturbation analysis (specifically, the quasi-steady-state assumption), a well-established mathematical technique for systems with multiple timescales. The sensitivity analysis via forward sensitivity equations is a standard method in engineering and science. The problem is scientifically sound.\n- **Well-Posed**: The problem is well-posed. The ODE models with given initial conditions have unique solutions. The task to compute sensitivities is algorithmically defined and leads to a unique result.\n- **Objective**: The problem is stated in precise mathematical and algorithmic terms, free of subjective language.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A reasoned solution will be provided.\n\n### Principle-Based Solution Design\n\nThe solution requires numerically solving two sets of augmented Ordinary Differential Equations (ODEs), one for the full model and one for the reduced model. Each augmented system combines the original state equations with the forward sensitivity equations.\n\n**1. Full Model Sensitivity Analysis**\n\nLet the state vector be $x(t) = [m(t), p(t), c(t)]^T$ and the parameter vector be $\\theta \\in \\mathbb{R}^9$. The dynamics are $\\dot{x} = f(x, \\theta)$, where:\n$$\nf(x, \\theta) = \\begin{pmatrix} k_{\\mathrm{tx}}\\, c - \\gamma_m\\, m \\\\ k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p \\\\ \\frac{1}{\\varepsilon} \\left( k_{\\mathrm{on}}(T_{\\mathrm{tot}} - c)U - k_{\\mathrm{off}}c \\right) \\end{pmatrix}\n$$\nThe sensitivity matrix $S(t) = \\frac{\\partial x(t)}{\\partial \\theta}$ is a $3 \\times 9$ matrix whose dynamics are governed by:\n$$ \\frac{dS}{dt} = J_x S + J_\\theta $$\nwhere $J_x = \\frac{\\partial f}{\\partial x}$ is the $3 \\times 3$ state Jacobian and $J_\\theta = \\frac{\\partial f}{\\partial \\theta}$ is the $3 \\times 9$ parameter Jacobian.\n\nThe state Jacobian $J_x$ is:\n$$\nJ_x = \\begin{pmatrix}\n-\\gamma_m  0  k_{\\mathrm{tx}} \\\\\nk_{\\mathrm{tl}}  -\\gamma_p  0 \\\\\n0  0  \\frac{1}{\\varepsilon}(-k_{\\mathrm{on}}U - k_{\\mathrm{off}})\n\\end{pmatrix}\n$$\nThe parameter Jacobian $J_\\theta$ contains the partial derivatives of $f$ with respect to each of the $9$ parameters. For instance, the first column (w.r.t. $k_{\\mathrm{tx}}$) is $[\\partial \\dot{m}/\\partial k_{\\mathrm{tx}}, \\partial \\dot{p}/\\partial k_{\\mathrm{tx}}, \\partial \\dot{c}/\\partial k_{\\mathrm{tx}}]^T = [c, 0, 0]^T$. All $9$ columns are systematically derived.\n\nThe augmented system consists of $3$ state equations and $3 \\times 9 = 27$ sensitivity equations, forming a system of $30$ ODEs. The initial conditions are $x(0) = [0, 0, 0]^T$ and $S(0) = 0_{3 \\times 9}$. This system is integrated from $t=0$ to $t=T=10$.\n\n**2. Reduced Model Sensitivity Analysis**\n\nLet the state vector be $x_{\\mathrm{red}}(t) = [m(t), p(t)]^T$. The dynamics are $\\dot{x}_{\\mathrm{red}} = g(x_{\\mathrm{red}}, \\theta)$, where:\n$$\ng(x_{\\mathrm{red}}, \\theta) = \\begin{pmatrix} k_{\\mathrm{tx}}\\, c^{\\ast}(\\theta) - \\gamma_m\\, m \\\\ k_{\\mathrm{tl}}\\, m - \\gamma_p\\, p \\end{pmatrix}\n$$\nThe algebraic term $c^{\\ast}(\\theta)$ is a function of parameters $k_{\\mathrm{on}}, k_{\\mathrm{off}}, T_{\\mathrm{tot}}, U$:\n$$\nc^{\\ast} = \\frac{k_{\\mathrm{on}} T_{\\mathrm{tot}} U}{k_{\\mathrm{on}}U + k_{\\mathrm{off}}}\n$$\nThe sensitivity matrix for the reduced system, $S_{\\mathrm{red}}(t) = \\frac{\\partial x_{\\mathrm{red}}(t)}{\\partial \\theta}$, is a $2 \\times 9$ matrix. Its dynamics are:\n$$ \\frac{dS_{\\mathrm{red}}}{dt} = J_{x, \\mathrm{red}} S_{\\mathrm{red}} + J_{\\theta, \\mathrm{red}} $$\nThe state Jacobian $J_{x, \\mathrm{red}} = \\frac{\\partial g}{\\partial x_{\\mathrm{red}}}$ is a $2 \\times 2$ matrix:\n$$\nJ_{x, \\mathrm{red}} = \\begin{pmatrix} -\\gamma_m  0 \\\\ k_{\\mathrm{tl}}  -\\gamma_p \\end{pmatrix}\n$$\nThe parameter Jacobian $J_{\\theta, \\mathrm{red}} = \\frac{\\partial g}{\\partial \\theta}$ is a $2 \\times 9$ matrix. Its entries depend on the derivatives of $c^{\\ast}$ with respect to the parameters. For example, $\\frac{\\partial \\dot{m}}{\\partial k_{\\mathrm{on}}} = k_{\\mathrm{tx}} \\frac{\\partial c^{\\ast}}{\\partial k_{\\mathrm{on}}}$. The chain rule is applied to find these derivatives:\n$$\n\\frac{\\partial c^{\\ast}}{\\partial k_{\\mathrm{on}}} = \\frac{T_{\\mathrm{tot}} U k_{\\mathrm{off}}}{(k_{\\mathrm{on}}U + k_{\\mathrm{off}})^2}, \\quad \\frac{\\partial c^{\\ast}}{\\partial k_{\\mathrm{off}}} = \\frac{-k_{\\mathrm{on}} T_{\\mathrm{tot}} U}{(k_{\\mathrm{on}}U + k_{\\mathrm{off}})^2}, \\quad \\text{etc.}\n$$\nNotably, $\\frac{\\partial g}{\\partial \\varepsilon} = [0, 0]^T$, so the sensitivity of the reduced model to $\\varepsilon$ is zero, as expected.\n\nThe augmented system for the reduced model consists of $2$ state equations and $2 \\times 9 = 18$ sensitivity equations, totaling $20$ ODEs. Initial conditions are $x_{\\mathrm{red}}(0) = [0, 0]^T$ and $S_{\\mathrm{red}}(0) = 0_{2 \\times 9}$. This system is also integrated to $t=T=10$.\n\n**3. Numerical Integration and Final Calculation**\nBoth augmented systems are stiff, particularly for small $\\varepsilon$, due to the term $1/\\varepsilon$ in the full model's Jacobian. A stiff ODE solver (e.g., `Radau` or `BDF`) is necessary.\nAfter integration, we obtain the state and sensitivity values at $t=T=10$:\n- From the full model: $p_{\\mathrm{full}}(T)$ and the vector $\\frac{\\partial p_{\\mathrm{full}}(T)}{\\partial \\theta}$ (the second row of $S(T)$).\n- From the reduced model: $p_{\\mathrm{red}}(T)$ and the vector $\\frac{\\partial p_{\\mathrm{red}}(T)}{\\partial \\theta}$ (the second row of $S_{\\mathrm{red}}(T)$).\n\nUsing these, we compute the logarithmic sensitivities $S_{j, \\mathrm{full}}^{\\log}$ and $S_{j, \\mathrm{red}}^{\\log}$ for each parameter $\\theta_j$. Finally, we calculate their absolute difference $\\Delta_j$, identify parameters for which $\\Delta_j \\ge 0.25$, and sort them according to the specified criteria.",
            "answer": "[[\"epsilon\"],[\"epsilon\",\"k_on\",\"k_off\",\"U\",\"gamma_p\",\"gamma_m\",\"k_tx\",\"T_tot\",\"k_tl\"],[\"epsilon\",\"k_on\",\"k_off\"],[\"epsilon\",\"k_on\",\"k_off\"]]"
        }
    ]
}