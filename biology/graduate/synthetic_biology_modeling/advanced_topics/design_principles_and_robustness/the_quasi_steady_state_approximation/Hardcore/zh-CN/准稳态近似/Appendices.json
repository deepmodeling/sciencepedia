{
    "hands_on_practices": [
        {
            "introduction": "准稳态近似的有效性取决于系统时间尺度的明确分离。本练习提供了一种具体的方法，直接从系统的基本动力学参数来量化这种分离。通过为一个常见的转录激活基序推导无量纲参数 $\\epsilon$，您将学会如何识别“快”与“慢”过程的特征速率，并形式化应用准稳态近似的条件。",
            "id": "3936846",
            "problem": "考虑一个合成基因线路，其中转录因子 $X$ 与单拷贝启动子 $P$ 结合形成复合物 $C$，且被占据的启动子催化下游产物 $Y$ 的合成。假设结合步骤遵循基元质量作用动力学，合成步骤为一级催化步骤。反应方案为\n$$\nX + P \\xrightleftharpoons[k_{\\mathrm{off}}]{k_{\\mathrm{on}}} C, \\qquad C \\xrightarrow{k_{\\mathrm{cat}}} C + Y.\n$$\n设 $P_{\\mathrm{T}}$ 表示总启动子浓度，其满足 $P_{\\mathrm{T}} = P + C$。在结合的时间尺度上，游离转录因子 $X$ 可被视为准恒定的，其值为 $X_0$；这反映了细胞中的常见情况，即 $X$ 的拷贝数远大于 $P$ 的拷贝数，且 $X$ 被其他过程所缓冲。该系统由质量作用定律建模如下\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}}\\,X\\,P - k_{\\mathrm{off}}\\,C, \\qquad \\frac{dY}{dt} = k_{\\mathrm{cat}}\\,C,\n$$\n其中 $P = P_{\\mathrm{T}} - C$。\n\n准稳态近似 (QSSA) 断言，在 $C$ 的快速结合/解离动力学与 $Y$ 的慢速催化合成之间存在时间尺度分离。你的任务是从质量作用动力学和时间尺度分析的第一性原理出发，通过比较特征结合弛豫速率与特征催化合成速率，推导出一个无量纲小参数 $\\epsilon$ 来量化这种时间尺度分离。然后，使用推导出的表达式，计算在以下参数集下 $\\epsilon$ 的数值：\n$$\nk_{\\mathrm{on}} = 3.0 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1},\\quad k_{\\mathrm{off}} = 2.0 \\times 10^{-2}\\ \\mathrm{s}^{-1},\\quad k_{\\mathrm{cat}} = 1.5 \\times 10^{-3}\\ \\mathrm{s}^{-1},\\quad X_0 = 2.0 \\times 10^{-8}\\ \\mathrm{M},\\quad P_{\\mathrm{T}} = 1.0 \\times 10^{-9}\\ \\mathrm{M}.\n$$\n明确定义你所选择的特征速率，并根据控制方程给出理由，然后计算 $\\epsilon$ 的值。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "用户希望解决一个基于准稳态近似 (QSSA) 的问题。我将首先验证问题陈述。\n\n### 第 1 步：提取已知条件\n- **反应方案：**\n  $$ X + P \\xrightleftharpoons[k_{\\mathrm{off}}]{k_{\\mathrm{on}}} C $$\n  $$ C \\xrightarrow{k_{\\mathrm{cat}}} C + Y $$\n- **守恒定律：** $P_{\\mathrm{T}} = P + C$，其中 $P_{\\mathrm{T}}$ 是总启动子浓度。\n- **假设：** 游离转录因子 $X$ 是准恒定的，其值为 $X_0$。\n- **控制方程 (质量作用定律)：**\n  $$ \\frac{dC}{dt} = k_{\\mathrm{on}}\\,X\\,P - k_{\\mathrm{off}}\\,C $$\n  $$ \\frac{dY}{dt} = k_{\\mathrm{cat}}\\,C $$\n- **参数值：**\n  - $k_{\\mathrm{on}} = 3.0 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$\n  - $k_{\\mathrm{off}} = 2.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$\n  - $k_{\\mathrm{cat}} = 1.5 \\times 10^{-3}\\ \\mathrm{s}^{-1}$\n  - $X_0 = 2.0 \\times 10^{-8}\\ \\mathrm{M}$\n  - $P_{\\mathrm{T}} = 1.0 \\times 10^{-9}\\ \\mathrm{M}$\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学基础：** 该问题描述了转录因子结合和基因表达调控的一个标准模型，这是分子生物学和合成生物学中的一个基本概念。在该领域，使用质量作用动力学和准稳态近似是标准的、成熟的方法。参数值虽然是特定的，但在生物分子相互作用的物理合理范围内。该问题在科学上是合理的。\n- **适定性：** 问题要求基于时间尺度分析推导一个特定的无量纲参数，并随后进行数值计算。这是一个清晰、明确的任务，具有唯一且有意义的解。\n- **客观性：** 问题使用精确、客观、形式化的科学语言陈述。所有术语都有定义，没有歧义。\n- **其他检查：** 问题是自洽的、无矛盾的，并且与合成生物学建模中的 QSSA 主题直接相关。\n\n### 第 3 步：结论与行动\n问题是有效的。我将继续提供完整的解决方案。\n\n当系统表现出时间尺度分离时，准稳态近似 (QSSA) 是适用的。在本问题中，转录因子 $X$ 与启动子 $P$ 结合形成复合物 $C$ 的过程被视为“快”过程，而产物 $Y$ 的催化合成被视为“慢”过程。我们的目标是推导一个无量纲参数 $\\epsilon$，它量化了慢过程特征速率与快过程特征速率之比。\n\n首先，我们分析复合物浓度 $[C]$ 的动力学，为简化起见，我们将其表示为 $C$。$C$ 的控制微分方程为：\n$$ \\frac{dC}{dt} = k_{\\mathrm{on}}\\,X\\,P - k_{\\mathrm{off}}\\,C $$\n已知总启动子浓度是恒定的，$P_{\\mathrm{T}} = P + C$，这意味着 $P = P_{\\mathrm{T}} - C$。我们还已知转录因子浓度是缓冲的，可被视为一个常数，$X = X_0$。将这些代入 $C$ 的微分方程中：\n$$ \\frac{dC}{dt} = k_{\\mathrm{on}}\\,X_{0}\\,(P_{\\mathrm{T}} - C) - k_{\\mathrm{off}}\\,C $$\n整理这些项，我们得到：\n$$ \\frac{dC}{dt} = k_{\\mathrm{on}}\\,X_{0}\\,P_{\\mathrm{T}} - k_{\\mathrm{on}}\\,X_{0}\\,C - k_{\\mathrm{off}}\\,C $$\n$$ \\frac{dC}{dt} = k_{\\mathrm{on}}\\,X_{0}\\,P_{\\mathrm{T}} - (k_{\\mathrm{on}}\\,X_{0} + k_{\\mathrm{off}})\\,C $$\n这是一个关于 $C$ 的一阶线性常微分方程，形式为 $\\frac{dC}{dt} = A - B\\,C$。此类方程的解是向稳态的指数弛豫。弛豫的速率由系数 $B$ 给出。这个速率表征了结合与解离的“快”动力学。因此，我们将快结合/解离过程的特征速率 $k_{\\mathrm{fast}}$ 定义为：\n$$ k_{\\mathrm{fast}} = k_{\\mathrm{on}}\\,X_{0} + k_{\\mathrm{off}} $$\n这个速率的倒数 $\\tau_{\\mathrm{fast}} = 1/k_{\\mathrm{fast}}$ 是浓度 $C$ 接近其准稳态值的特征时间。\n\n接下来，我们确定 $Y$ 的“慢”催化合成的特征速率。$Y$ 的动力学由下式给出：\n$$ \\frac{dY}{dt} = k_{\\mathrm{cat}}\\,C $$\n这个方程描述了由复合物 $C$ 催化的 $Y$ 的生成。该过程的速率常数是 $k_{\\mathrm{cat}}$，它代表了复合物的转换数——即每个 $C$ 分子在单位时间内生成的 $Y$ 分子数。因此，$k_{\\mathrm{cat}}$ 是定义慢合成过程时间尺度的内禀一级速率常数。我们将慢过程的特征速率 $k_{\\mathrm{slow}}$ 定义为：\n$$ k_{\\mathrm{slow}} = k_{\\mathrm{cat}} $$\n\n当快过程远快于慢过程时，即 $k_{\\mathrm{fast}} \\gg k_{\\mathrm{slow}}$ 时，QSSA 成立。量化此时间尺度分离的无量纲小参数 $\\epsilon$ 是慢速率与快速率之比：\n$$ \\epsilon = \\frac{k_{\\mathrm{slow}}}{k_{\\mathrm{fast}}} $$\n代入我们推导出的特征速率表达式，我们得到 $\\epsilon$ 的符号表达式：\n$$ \\epsilon = \\frac{k_{\\mathrm{cat}}}{k_{\\mathrm{on}}\\,X_{0} + k_{\\mathrm{off}}} $$\nQSSA 的有效性条件是 $\\epsilon \\ll 1$。\n\n现在，我们使用提供的参数集计算 $\\epsilon$ 的数值：\n- $k_{\\mathrm{on}} = 3.0 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$\n- $k_{\\mathrm{off}} = 2.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$\n- $k_{\\mathrm{cat}} = 1.5 \\times 10^{-3}\\ \\mathrm{s}^{-1}$\n- $X_0 = 2.0 \\times 10^{-8}\\ \\mathrm{M}$\n\n首先，我们计算项 $k_{\\mathrm{on}}\\,X_{0}$：\n$$ k_{\\mathrm{on}}\\,X_{0} = (3.0 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}) \\times (2.0 \\times 10^{-8}\\ \\mathrm{M}) = 6.0 \\times 10^{-1}\\ \\mathrm{s}^{-1} = 0.6\\ \\mathrm{s}^{-1} $$\n接下来，我们计算分母，即 $k_{\\mathrm{fast}}$：\n$$ k_{\\mathrm{fast}} = k_{\\mathrm{on}}\\,X_{0} + k_{\\mathrm{off}} = 0.6\\ \\mathrm{s}^{-1} + 2.0 \\times 10^{-2}\\ \\mathrm{s}^{-1} = 0.6\\ \\mathrm{s}^{-1} + 0.02\\ \\mathrm{s}^{-1} = 0.62\\ \\mathrm{s}^{-1} $$\n分子是 $k_{\\mathrm{slow}} = k_{\\mathrm{cat}} = 1.5 \\times 10^{-3}\\ \\mathrm{s}^{-1}$。\n最后，我们计算 $\\epsilon$：\n$$ \\epsilon = \\frac{1.5 \\times 10^{-3}\\ \\mathrm{s}^{-1}}{0.62\\ \\mathrm{s}^{-1}} = \\frac{0.0015}{0.62} \\approx 0.0024193548... $$\n问题要求答案四舍五入到四位有效数字。\n$$ \\epsilon \\approx 0.002419 $$\n$\\epsilon$ 的小值表明存在显著的时间尺度分离，这证明了对这组参数使用 QSSA 的合理性。",
            "answer": "$$\n\\boxed{0.002419}\n$$"
        },
        {
            "introduction": "应用准稳态近似会改变对关键系统参数的解读，这对建模者和实验科学家而言都是一个至关重要的洞见。本实践将一个简单的结合平衡场景与一个活跃的非平衡稳态进行对比，以揭示热力学解离常数 $K_d$ 与从准稳态近似推导出的有效常数 $K_M$ 之间的关键差异。完成这个问题将帮助您阐明，为何在活性测定中测得的表观亲和力可能并不反映分子间真实的结合亲和力。",
            "id": "3936849",
            "problem": "在一个合成基因回路中，一个转录因子与启动子结合，随后经过一个生产步骤，产生一个RNA分子并再生出自由启动子。考虑在充分混合、等温条件下，并遵循质量作用动力学的基元反应方案：\n$$\nD + X \\xrightleftharpoons[k_{-1}]{k_{1}} DX \\xrightarrow{k_{2}} D + \\text{RNA},\n$$\n其中 $D$ 是自由启动子，$X$ 是转录因子，$DX$ 是启动子-因子复合物。结合速率常数为 $k_{1}$ (单位 $\\,\\mathrm{M^{-1}\\,s^{-1}}$)，解离速率常数为 $k_{-1}$ (单位 $\\,\\mathrm{s^{-1}}$)，生产步骤的速率常数为 $k_{2}$ (单位 $\\,\\mathrm{s^{-1}}$)。假设总启动子浓度 $[D]_{\\mathrm{T}}$ 远小于自由转录因子浓度 $[X]$（典型的单拷贝启动子情形），并且在所关心的时间尺度内，$[X]$ 可被视为常数。\n\na) 在一个仅有结合的实验中，转录被化学方法阻断，因此生产步骤不会发生（等效于 $k_{2}=0$），系统达到平衡。从质量作用定律和化学平衡的定义出发，推导决定平衡时启动子占有率的解离常数表达式，该表达式应为动力学速率常数的函数。\n\nb) 在一个转录活跃的实验中（$k_{2}0$），在准稳态近似（QSSA）对中间复合物 $DX$ 成立的条件下（准稳态近似（QSSA）：$[DX]$ 的净变化速率与其形成和消耗速率相比可以忽略不计），从质量作用平衡出发，推导稳态生产速率 $v$ 作为 $[X]$ 的函数，然后得到当 $v$ 达到其饱和值一半时的激活剂浓度表达式。用动力学速率常数表示你的结果。\n\nc) 使用(a)和(b)部分的结果，计算在转录活跃实验中达到半最大稳态生产速率时的浓度与在仅有结合实验中达到半最大平衡启动子占有率时的浓度之比。使用参数值 $k_{1}=1.0\\times 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$，$k_{-1}=0.10\\,\\mathrm{s^{-1}}$ 和 $k_{2}=0.50\\,\\mathrm{s^{-1}}$。将你的答案四舍五入到三位有效数字。仅报告此比值，作为一个纯数（无单位）。",
            "solution": "该问题是有效的，因为它科学地基于化学动力学和准稳态近似的原理，问题陈述清晰，提供了所有必要信息，并且表述客观，没有任何主观或模棱两可的术语。我们逐步进行求解。\n\na) 在仅有结合的实验中，生产步骤被阻断，意味着速率常数 $k_2$ 等效于零 ($k_2 = 0$)。反应简化为可逆的结合平衡：\n$$\nD + X \\xrightleftharpoons[k_{-1}]{k_{1}} DX\n$$\n根据质量作用定律，正反应（结合）的速率为 $v_f = k_1 [D][X]$，逆反应（解离）的速率为 $v_r = k_{-1} [DX]$。在化学平衡时，净变化速率为零，这意味着正逆反应速率相等：\n$$\nv_f = v_r \\implies k_1 [D][X] = k_{-1} [DX]\n$$\n解离常数 $K_d$ 定义为平衡时各物质浓度的比值。根据速率相等的条件，我们可以重新排列各项，得到 $K_d$ 的表达式：\n$$\nK_d = \\frac{[D][X]}{[DX]} = \\frac{k_{-1}}{k_1}\n$$\n这就是解离常数作为动力学速率常数函数的表达式。\n\n为了求出半最大平衡启动子占有率时的浓度，我们首先定义分数占有率 $\\theta$ 为被转录因子结合的总启动子位点的分数：\n$$\n\\theta = \\frac{[DX]}{[D]_{\\mathrm{T}}}\n$$\n总启动子浓度 $[D]_{\\mathrm{T}}$ 是自由启动子和已结合启动子浓度之和：$[D]_{\\mathrm{T}} = [D] + [DX]$。我们可以将 $[D]$ 表示为 $[D] = [D]_{\\mathrm{T}} - [DX]$。将此代入平衡条件 $k_1 [D][X] = k_{-1} [DX]$：\n$$\nk_1 ([D]_{\\mathrm{T}} - [DX])[X] = k_{-1} [DX]\n$$\n求解 $[DX]$：\n$$\nk_1 [D]_{\\mathrm{T}} [X] - k_1 [DX] [X] = k_{-1} [DX]\n$$\n$$\nk_1 [D]_{\\mathrm{T}} [X] = (k_{-1} + k_1 [X]) [DX]\n$$\n$$\n[DX] = \\frac{k_1 [D]_{\\mathrm{T}} [X]}{k_{-1} + k_1 [X]}\n$$\n现在，通过除以 $[D]_{\\mathrm{T}}$，我们可以求得分数占有率 $\\theta$：\n$$\n\\theta = \\frac{[DX]}{[D]_{\\mathrm{T}}} = \\frac{k_1 [X]}{k_{-1} + k_1 [X]}\n$$\n将分子和分母同时除以 $k_1$ 并代入 $K_d = k_{-1}/k_1$：\n$$\n\\theta = \\frac{[X]}{\\frac{k_{-1}}{k_1} + [X]} = \\frac{[X]}{K_d + [X]}\n$$\n当 $\\theta = 1/2$ 时，达到半最大占有率。设此时 $X$ 的浓度为 $[X]_{\\text{half,eq}}$。\n$$\n\\frac{1}{2} = \\frac{[X]_{\\text{half,eq}}}{K_d + [X]_{\\text{half,eq}}}\n$$\n$$\nK_d + [X]_{\\text{half,eq}} = 2 [X]_{\\text{half,eq}}\n$$\n$$\n[X]_{\\text{half,eq}} = K_d = \\frac{k_{-1}}{k_1}\n$$\n\nb) 在转录活跃的实验中，所有三个步骤都会发生。中间复合物浓度 $[DX]$ 的变化速率由其形成速率减去其消耗速率给出：\n$$\n\\frac{d[DX]}{dt} = k_1 [D][X] - (k_{-1} [DX] + k_2 [DX])\n$$\n准稳态近似（QSSA）假设中间复合物 $[DX]$ 的浓度变化远慢于底物和产物的浓度变化，因此我们可以将其净变化速率设为零：\n$$\n\\frac{d[DX]}{dt} \\approx 0 \\implies k_1 [D][X] = (k_{-1} + k_2)[DX]_{\\mathrm{ss}}\n$$\n其中 $[DX]_{\\mathrm{ss}}$ 是复合物的稳态浓度。使用守恒关系 $[D] = [D]_{\\mathrm{T}} - [DX]_{\\mathrm{ss}}$，我们代入 $[D]$：\n$$\nk_1 ([D]_{\\mathrm{T}} - [DX]_{\\mathrm{ss}})[X] = (k_{-1} + k_2)[DX]_{\\mathrm{ss}}\n$$\n求解 $[DX]_{\\mathrm{ss}}$：\n$$\nk_1 [D]_{\\mathrm{T}} [X] = (k_{-1} + k_2 + k_1 [X])[DX]_{\\mathrm{ss}}\n$$\n$$\n[DX]_{\\mathrm{ss}} = \\frac{k_1 [D]_{\\mathrm{T}} [X]}{k_{-1} + k_2 + k_1 [X]}\n$$\nRNA的稳态生产速率 $v$ 是催化步骤的速率：\n$$\nv = k_2 [DX]_{\\mathrm{ss}} = k_2 \\frac{k_1 [D]_{\\mathrm{T}} [X]}{k_{-1} + k_2 + k_1 [X]}\n$$\n这个方程具有米氏方程的形式。为了找出 $v$ 达到其饱和值一半时的浓度，我们首先确定饱和（最大）速率 $v_{\\mathrm{max}}$，它在 $[X] \\to \\infty$ 时出现：\n$$\nv_{\\mathrm{max}} = \\lim_{[X]\\to\\infty} v = \\lim_{[X]\\to\\infty} \\frac{k_2 k_1 [D]_{\\mathrm{T}} [X]}{k_{-1} + k_2 + k_1 [X]} = \\frac{k_2 k_1 [D]_{\\mathrm{T}}}{k_1} = k_2 [D]_{\\mathrm{T}}\n$$\n我们需要找到浓度 $[X]$，我们称之为 $[X]_{\\text{half,ss}}$，使得 $v = v_{\\mathrm{max}}/2$：\n$$\n\\frac{1}{2} v_{\\mathrm{max}} = \\frac{1}{2} k_2 [D]_{\\mathrm{T}} = \\frac{k_2 k_1 [D]_{\\mathrm{T}} [X]_{\\text{half,ss}}}{k_{-1} + k_2 + k_1 [X]_{\\text{half,ss}}}\n$$\n从两边消去项 $k_2 [D]_{\\mathrm{T}}$（因为 $k_2  0$ 且 $[D]_{\\mathrm{T}}  0$）：\n$$\n\\frac{1}{2} = \\frac{k_1 [X]_{\\text{half,ss}}}{k_{-1} + k_2 + k_1 [X]_{\\text{half,ss}}}\n$$\n$$\nk_{-1} + k_2 + k_1 [X]_{\\text{half,ss}} = 2 k_1 [X]_{\\text{half,ss}}\n$$\n$$\nk_{-1} + k_2 = k_1 [X]_{\\text{half,ss}}\n$$\n$$\n[X]_{\\text{half,ss}} = \\frac{k_{-1} + k_2}{k_1}\n$$\n该浓度是此反应方案的米氏常数 $K_M$。\n\nc) 我们被要求计算达到半最大稳态生产速率时的浓度 $[X]_{\\text{half,ss}}$ 与达到半最大平衡启动子占有率时的浓度 $[X]_{\\text{half,eq}}$ 之比。\n$$\n\\text{Ratio} = \\frac{[X]_{\\text{half,ss}}}{[X]_{\\text{half,eq}}} = \\frac{\\frac{k_{-1} + k_2}{k_1}}{\\frac{k_{-1}}{k_1}}\n$$\n速率常数 $k_1$ 被消掉了：\n$$\n\\text{Ratio} = \\frac{k_{-1} + k_2}{k_{-1}} = 1 + \\frac{k_2}{k_{-1}}\n$$\n现在，我们代入给定的数值：$k_{-1} = 0.10\\,\\mathrm{s^{-1}}$ 和 $k_2 = 0.50\\,\\mathrm{s^{-1}}$。\n$$\n\\text{Ratio} = 1 + \\frac{0.50}{0.10} = 1 + 5 = 6\n$$\n题目要求答案保留三位有效数字。因此，该比值为 $6.00$。",
            "answer": "$$\\boxed{6.00}$$"
        },
        {
            "introduction": "准稳态近似不仅能在线下简化模型，更是开发多尺度生物系统高效数值模拟的强大工具。这项高级实践要求您实现一个混合模拟器，该模拟器能根据系统的状态，在完整的刚性模型和简化的准稳态模型之间进行自适应切换。这个练习展示了如何将准稳态近似操作化，从而创建一个既准确又比单独模拟完整模型计算速度更快的算法。",
            "id": "3936865",
            "problem": "考虑一个用于合成生物学中转录调控的奇异摄动二维常微分方程模型，该模型捕捉了快速的转录因子-启动子结合和缓慢的蛋白质累积过程。设快变量为已结合的启动子分数 $x \\in [0,1]$（无量纲），慢变量为蛋白质浓度 $y$（单位为纳摩尔，nM）。完整模型由以下方程组给出：\n$$\n\\varepsilon \\,\\dot{x} \\;=\\; k_{\\mathrm{on}}\\,y \\,(1 - x)\\;-\\;k_{\\mathrm{off}}\\,x\n$$\n$$\n\\dot{y} \\;=\\; \\alpha\\,x \\;-\\; \\delta\\,y\n$$\n其中 $\\varepsilon  0$ 是一个小的无量纲数，$k_{\\mathrm{on}}  0$ 是结合速率常数（单位为 $\\mathrm{nM}^{-1}\\mathrm{min}^{-1}$），$k_{\\mathrm{off}}  0$ 是解离速率常数（单位为 $\\mathrm{min}^{-1}$），$\\alpha  0$ 是蛋白质合成速率（单位为 $\\mathrm{nM}\\,\\mathrm{min}^{-1}$），$\\delta  0$ 是蛋白质降解速率（单位为 $\\mathrm{min}^{-1}$）。准稳态近似 (QSSA) 将快变微分方程替换为其代数准稳态约束，并将慢变方程替换为一个仅依赖于 $y$ 的简化方程 $\\dot{y} = g(y)$。\n\n设计并实现一个混合模拟，该模拟能基于一个比较缩放后快残差与慢漂移的监视器，在积分简化 QSSA 模型和完整模型之间进行切换。具体来说，在当前状态 $(x,y)$ 下，计算快残差大小\n$$\nM \\;=\\;\\left|\\varepsilon\\,\\dot{x}_{\\text{fast}}\\right| \\;=\\; \\left|k_{\\mathrm{on}}\\,y \\,(1 - x)\\;-\\;k_{\\mathrm{off}}\\,x\\right|\n$$\n和简化模型的慢漂移大小\n$$\nS \\;=\\; \\left|g(y)\\right|\n$$\n其中 $g(y)$ 是在 QSSA 下获得的简化慢向量场。使用一个固定的阈值 $\\eta \\in (0,1)$ 来决定模型区域：如果 $M \\le \\eta\\,S$，则使用简化模型推进时间（快变量受准稳态条件约束）；否则，使用完整模型推进时间。使用四阶龙格-库塔方法和均匀时间步长进行积分。每次更新后，将 $x$ 限制在区间 $[0,1]$ 内。\n\n从适用于合成生物学建模和准稳态近似的第一性原理出发。您可以假设结合反应的质量作用动力学以及蛋白质的线​​性合成和降解的有效性。不要使用问题陈述中的任何简便公式；在您的解决方案中推导任何必要的代数关系。\n\n实现混合积分器，并为了比较，也实现一个纯粹的完整模型积分器（无切换）。对于每个测试用例，从相同的初始条件将混合模型和完整模型模拟到指定的最终时间，并报告：\n- 混合模拟的最终蛋白质浓度 $y(T)$，单位为 $\\mathrm{nM}$，四舍五入到三位小数。\n- 完整模型模拟的最终蛋白质浓度 $y(T)$，单位为 $\\mathrm{nM}$，四舍五入到三位小数。\n- 两个最终浓度之间的绝对相对误差，计算公式为 $\\left|\\frac{y_{\\text{hybrid}}(T) - y_{\\text{full}}(T)}{\\max\\left(|y_{\\text{full}}(T)|, 10^{-12}\\right)}\\right|$，四舍五入到四位小数。\n\n使用以下参数值和测试套件。对于所有情况，使用 $k_{\\mathrm{on}} = 0.02$（单位为 $\\mathrm{nM}^{-1}\\mathrm{min}^{-1}$），$k_{\\mathrm{off}} = 1.0$（单位为 $\\mathrm{min}^{-1}$），$\\alpha = 100.0$（单位为 $\\mathrm{nM}\\,\\mathrm{min}^{-1}$），$\\delta = 1.0$（单位为 $\\mathrm{min}^{-1}$），$\\eta = 0.1$（无量纲阈值），以及均匀时间步长 $\\Delta t = 0.01$（单位为 $\\mathrm{min}$）。\n测试用例：\n1. 小时间尺度分离，从零开始增长：$\\varepsilon = 0.01$, $x(0) = 0.0$, $y(0) = 0.0$, $T = 20.0$（单位为 $\\mathrm{min}$）。\n2. 弱时间尺度分离：$\\varepsilon = 0.5$, $x(0) = 0.0$, $y(0) = 0.0$, $T = 20.0$（单位为 $\\mathrm{min}$）。\n3. 从准稳态点精确开始：$\\varepsilon = 0.01$, $x(0) =$ 在 $y(0) = 50.0$ 时的准稳态值, $y(0) = 50.0$, $T = 10.0$（单位为 $\\mathrm{min}$）。\n4. 接近零慢漂移且快状态偏离 QSSA 的边界区域：$\\varepsilon = 0.01$, $x(0) = 0.0$, $y(0) = 50.0$, $T = 10.0$（单位为 $\\mathrm{min}$）。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表被方括号括起来，每个测试用例贡献一个三元素列表，顺序为 $[y_{\\text{hybrid}}(T), y_{\\text{full}}(T), \\text{relative\\_error}]$。例如，输出格式必须类似于 $[[y_{1h},y_{1f},e_1],[y_{2h},y_{2f},e_2],[y_{3h},y_{3f},e_3],[y_{4h},y_{4f},e_4]]$，所有数字均按指定要求四舍五入。所有报告的蛋白质浓度必须以 $\\mathrm{nM}$ 表示，此问题中不涉及角度。",
            "solution": "该问题要求为一个模拟转录调控的奇异摄动系统设计和实现一个混合数值积分器，并将其与一个完整模型积分器进行比较。解决方案的步骤是，首先推导简化模型所需的方程，然后详细说明完整模型、简化模型和混合积分方案的算法，最后指定测试用例的参数。\n\n### 步骤 1：准稳态近似 (QSSA) 模型的推导\n\n该系统由一个包含两个耦合常微分方程 (ODE) 的完整模型描述：\n$$\n\\varepsilon \\,\\dot{x} \\;=\\; k_{\\mathrm{on}}\\,y \\,(1 - x)\\;-\\;k_{\\mathrm{off}}\\,x \\quad (\\text{快动力学})\n$$\n$$\n\\dot{y} \\;=\\; \\alpha\\,x \\;-\\; \\delta\\,y \\quad (\\text{慢动力学})\n$$\n在这里，$x$ 表示已结合启动子的分数，是一个无量纲量；$y$ 是蛋白质浓度，单位为 $\\mathrm{nM}$。参数 $\\varepsilon \\ll 1$ 表明 $x$ 的动力学发生在一个比 $y$ 的动力学（发生在 $O(1)$ 的时间尺度上）快得多的时间尺度上，即 $O(\\varepsilon)$。\n\n准稳态近似 (QSSA) 利用了这种时间尺度分离。它假设快变量 $x$ 相对于慢变量 $y$ 的变化几乎是瞬时平衡的。这意味着快变量的时间导数近似为零，即 $\\dot{x} \\approx 0$。将此应用于第一个 ODE 可得：\n$$\n0 \\;=\\; k_{\\mathrm{on}}\\,y \\,(1 - x)\\;-\\;k_{\\mathrm{off}}\\,x\n$$\n可以解这个代数方程，得到 $x$ 的准稳态值 $x_{qss}$，作为慢变量 $y$ 的函数：\n$$\nk_{\\mathrm{on}}\\,y - k_{\\mathrm{on}}\\,y\\,x = k_{\\mathrm{off}}\\,x\n$$\n$$\nk_{\\mathrm{on}}\\,y = (k_{\\mathrm{off}} + k_{\\mathrm{on}}\\,y)\\,x\n$$\n$$\nx_{qss}(y) = \\frac{k_{\\mathrm{on}}\\,y}{k_{\\mathrm{off}} + k_{\\mathrm{on}}\\,y}\n$$\n这个关系定义了慢流形，即 $(x, y)$ 相空间中的一条曲线，系统状态会迅速收敛到这条曲线上。\n\n通过将这个 $x$ 的表达式代入第二个 ODE，我们得到了描述慢变量 $y$ 在慢流形上演化的一维简化模型：\n$$\n\\dot{y} = g(y) = \\alpha\\, x_{qss}(y) - \\delta\\,y\n$$\n代入 $x_{qss}(y)$ 的表达式，得到简化向量场 $g(y)$ 的显式形式：\n$$\ng(y) = \\alpha \\left( \\frac{k_{\\mathrm{on}}\\,y}{k_{\\mathrm{off}} + k_{\\mathrm{on}}\\,y} \\right) - \\delta\\,y\n$$\n这个单一的 ODE，$\\dot{y} = g(y)$，构成了 QSSA 简化模型。\n\n### 步骤 2：数值积分器的设计\n\n完整模拟和混合模拟都将使用经典的四阶龙格-库塔 (RK4) 方法和均匀的时间步长 $\\Delta t$ 来推进时间。对于一个通用 ODE 系统 $\\dot{\\mathbf{z}} = \\mathbf{f}(t, \\mathbf{z})$，从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的一步 RK4 计算如下：\n$$\n\\mathbf{k}_1 = \\Delta t \\, \\mathbf{f}(t_n, \\mathbf{z}_n)\n$$\n$$\n\\mathbf{k}_2 = \\Delta t \\, \\mathbf{f}(t_n + \\frac{\\Delta t}{2}, \\mathbf{z}_n + \\frac{\\mathbf{k}_1}{2})\n$$\n$$\n\\mathbf{k}_3 = \\Delta t \\, \\mathbf{f}(t_n + \\frac{\\Delta t}{2}, \\mathbf{z}_n + \\frac{\\mathbf{k}_2}{2})\n$$\n$$\n\\mathbf{k}_4 = \\Delta t \\, \\mathbf{f}(t_n + \\Delta t, \\mathbf{z}_n + \\mathbf{k}_3)\n$$\n$$\n\\mathbf{z}_{n+1} = \\mathbf{z}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n\n**完整模型积分器：**\n状态向量为 $\\mathbf{z} = [x, y]^T$。向量场 $\\mathbf{f}_{\\text{full}}(x, y)$ 由下式给出：\n$$\n\\mathbf{f}_{\\text{full}}(x, y) = \\begin{bmatrix} \\dot{x} \\\\ \\dot{y} \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{\\varepsilon}(k_{\\mathrm{on}}\\,y \\,(1 - x)\\;-\\;k_{\\mathrm{off}}\\,x) \\\\ \\alpha\\,x \\;-\\; \\delta\\,y \\end{bmatrix}\n$$\n模拟通过重复应用 RK4 步骤进行。每一步之后，将 $x$ 的值限制在有物理意义的区间 $[0, 1]$ 内，即 $x_{n+1} = \\max(0, \\min(1, x_{n+1}))$。\n\n**混合模型积分器：**\n混合积分器根据一个有效性准则，在完整模型和简化 QSSA 模型之间动态切换。在每个时间步 $t_n$，给定当前状态 $(x_n, y_n)$：\n\n1.  **计算监视器：**\n    *   **快残差大小 ($M$):** 该值衡量快变量 $x_n$ 离其准平衡值的距离，并按 $\\varepsilon$ 缩放。它是快变 ODE 右侧的绝对值。\n        $$\n        M_n = |k_{\\mathrm{on}}\\,y_n \\,(1 - x_n)\\;-\\;k_{\\mathrm{off}}\\,x_n|\n        $$\n    *   **慢漂移大小 ($S$):** 该值衡量在简化模型动力学下慢变量的变化速率。\n        $$\n        S_n = |g(y_n)| = \\left| \\alpha \\left( \\frac{k_{\\mathrm{on}}\\,y_n}{k_{\\mathrm{off}} + k_{\\mathrm{on}}\\,y_n} \\right) - \\delta\\,y_n \\right|\n        $$\n\n2.  **选择模型并积分：** 通过比较快残差和慢漂移，并使用一个容差阈值 $\\eta$ 来决定使用哪个模型。\n    *   **如果 $M_n \\le \\eta\\,S_n$ (QSSA 区域):** 系统被认为处于或非常接近慢流形。\n        a.  使用一个 RK4 步骤，从 $y_n$ 开始积分简化模型 $\\dot{y} = g(y)$，以计算 $y_{n+1}$。\n        b.  然后将快变量 $x_{n+1}$ 投影到慢流形上，方法是将其设置为对应于新慢状态 $y_{n+1}$ 的准稳态值：\n            $$\n            x_{n+1} = x_{qss}(y_{n+1}) = \\frac{k_{\\mathrm{on}}\\,y_{n+1}}{k_{\\mathrm{off}} + k_{\\mathrm{on}}\\,y_{n+1}}\n            $$\n    *   **否则 (完整模型区域):** 系统远离慢流形，必须解析完整的动力学。\n        a.  使用一个 RK4 步骤，从 $(x_n, y_n)$ 开始积分完整的二维模型 $\\dot{\\mathbf{z}} = \\mathbf{f}_{\\text{full}}(x,y)$，以计算 $(x_{n+1}, y_{n+1})$。\n        b.  将状态 $x_{n+1}$ 限制在区间 $[0, 1]$ 内。\n\n### 步骤 3：测试用例准备\n\n模拟将使用以下共享参数：\n-   $k_{\\mathrm{on}} = 0.02 \\, \\mathrm{nM}^{-1}\\mathrm{min}^{-1}$\n-   $k_{\\mathrm{off}} = 1.0 \\, \\mathrm{min}^{-1}$\n-   $\\alpha = 100.0 \\, \\mathrm{nM}\\,\\mathrm{min}^{-1}$\n-   $\\delta = 1.0 \\, \\mathrm{min}^{-1}$\n-   $\\eta = 0.1$\n-   $\\Delta t = 0.01 \\, \\mathrm{min}$\n\n具体的测试用例如下：\n1.  **小时间尺度分离，从零开始增长：** $\\varepsilon = 0.01$, $x(0) = 0.0$, $y(0) = 0.0$, $T = 20.0 \\, \\mathrm{min}$。\n2.  **弱时间尺度分离：** $\\varepsilon = 0.5$, $x(0) = 0.0$, $y(0) = 0.0$, $T = 20.0 \\, \\mathrm{min}$。\n3.  **从准稳态点精确开始：** $\\varepsilon = 0.01$, $y(0) = 50.0 \\, \\mathrm{nM}$, $T = 10.0 \\, \\mathrm{min}$。$x$ 的初始值是其在 $y(0)$ 时的 QSS 值：\n    $$\n    x(0) = x_{qss}(50.0) = \\frac{(0.02)(50.0)}{1.0 + (0.02)(50.0)} = \\frac{1.0}{1.0 + 1.0} = 0.5\n    $$\n4.  **接近零慢漂移且快状态偏离 QSSA 的边界区域：** $\\varepsilon = 0.01$, $x(0) = 0.0$, $y(0) = 50.0 \\, \\mathrm{nM}$, $T = 10.0 \\, \\mathrm{min}$。\n\n对于每种情况，混合模型和完整模型的模拟都从相同的初始条件运行到最终时间 $T$。记录最终的蛋白质浓度 $y_{\\text{hybrid}}(T)$ 和 $y_{\\text{full}}(T)$，并计算绝对相对误差 $\\left|\\frac{y_{\\text{hybrid}}(T) - y_{\\text{full}}(T)}{\\max\\left(|y_{\\text{full}}(T)|, 10^{-12}\\right)}\\right|$。实现将遵循这些推导。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and compares a hybrid QSSA/full model integrator with a pure\n    full-model integrator for a transcriptional regulation model.\n    \"\"\"\n\n    # --- Model and Parameter Definitions ---\n\n    # Shared parameters for all test cases\n    k_on = 0.02   # nM^-1 min^-1\n    k_off = 1.0   # min^-1\n    alpha = 100.0 # nM min^-1\n    delta = 1.0   # min^-1\n    eta = 0.1     # dimensionless threshold\n    dt = 0.01     # min\n\n    # --- Vector Fields and Helper Functions ---\n\n    def f_full(state, eps):\n        \"\"\"Full model vector field: dz/dt = f(z), where z = [x, y].\"\"\"\n        x, y = state\n        dxdt = (1 / eps) * (k_on * y * (1 - x) - k_off * x)\n        dydt = alpha * x - delta * y\n        return np.array([dxdt, dydt])\n\n    def g_reduced(y):\n        \"\"\"Reduced QSSA model scalar field: dy/dt = g(y).\"\"\"\n        x_ss = x_qss(y)\n        return alpha * x_ss - delta * y\n\n    def x_qss(y):\n        \"\"\"Quasi-steady-state value of x as a function of y.\"\"\"\n        # Handle y  0 case from numerical error by clamping\n        y_c = max(0, y)\n        numerator = k_on * y_c\n        denominator = k_off + k_on * y_c\n        # Avoid division by zero, although biologically denominator is > 0\n        if denominator == 0:\n            return 0.0\n        return numerator / denominator\n\n    # --- Numerical Integrator ---\n\n    def rk4_step(f, state, dt, *f_args):\n        \"\"\"Performs a single RK4 step for a system dz/dt = f(t, z).\"\"\"\n        k1 = dt * f(state, *f_args)\n        k2 = dt * f(state + 0.5 * k1, *f_args)\n        k3 = dt * f(state + 0.5 * k2, *f_args)\n        k4 = dt * f(state + k3, *f_args)\n        return state + (k1 + 2*k2 + 2*k3 + k4) / 6.0\n\n    # --- Simulation Functions ---\n\n    def simulate_full(x0, y0, eps, T):\n        \"\"\"Simulates the full model.\"\"\"\n        state = np.array([x0, y0])\n        num_steps = int(round(T / dt))\n        for _ in range(num_steps):\n            state = rk4_step(f_full, state, dt, eps)\n            # Clamp x to the physical interval [0, 1]\n            state[0] = np.clip(state[0], 0.0, 1.0)\n        return state[1] # Return final y\n\n    def simulate_hybrid(x0, y0, eps, T):\n        \"\"\"Simulates the hybrid QSSA/full model.\"\"\"\n        state = np.array([x0, y0])\n        num_steps = int(round(T / dt))\n        \n        # Helper for the 1D reduced RK4 step that matches the rk4_step signature\n        def g_reduced_wrapper(y_vec, *args):\n            return np.array([g_reduced(y_vec[0])])\n\n        for _ in range(num_steps):\n            x, y = state\n            \n            # 1. Compute monitors\n            M = np.abs(k_on * y * (1 - x) - k_off * x)\n            S = np.abs(g_reduced(y))\n\n            # 2. Select model and integrate\n            # Add a small tolerance to S to prevent issues when S is exactly zero.\n            if M = eta * S:\n                # QSSA Regime\n                y_vec = np.array([y])\n                y_next_vec = rk4_step(g_reduced_wrapper, y_vec, dt)\n                y_next = y_next_vec[0]\n                x_next = x_qss(y_next)\n                state = np.array([x_next, y_next])\n            else:\n                # Full Model Regime\n                state = rk4_step(f_full, state, dt, eps)\n                # Clamp x\n                state[0] = np.clip(state[0], 0.0, 1.0)\n        \n        return state[1] # Return final y\n\n    # --- Test Cases ---\n    \n    # Calculate initial x for case 3\n    x0_case3 = x_qss(50.0)\n\n    test_cases = [\n        # eps,  x0,        y0,     T\n        (0.01, 0.0,       0.0,    20.0), # Case 1\n        (0.5,  0.0,       0.0,    20.0), # Case 2\n        (0.01, x0_case3,  50.0,   10.0), # Case 3\n        (0.01, 0.0,       50.0,   10.0), # Case 4\n    ]\n\n    results = []\n    for eps_case, x0_case, y0_case, T_case in test_cases:\n        # Run simulations\n        y_hybrid_final = simulate_hybrid(x0_case, y0_case, eps_case, T_case)\n        y_full_final = simulate_full(x0_case, y0_case, eps_case, T_case)\n\n        # Calculate relative error\n        denominator = max(abs(y_full_final), 1e-12)\n        rel_error = abs(y_hybrid_final - y_full_final) / denominator\n        \n        # Store rounded results\n        results.append([\n            round(y_hybrid_final, 3),\n            round(y_full_final, 3),\n            round(rel_error, 4)\n        ])\n    \n    # Print results in the specified format\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}