{
    "hands_on_practices": [
        {
            "introduction": "A common source of oscillations in biological systems is the presence of time delays, such as those inherent in gene transcription and translation. This exercise provides a foundational guide to analyzing how a simple delay can destabilize a steady state and give rise to periodic behavior through a Hopf bifurcation. By working through the analysis of a scalar delay differential equation (DDE), you will learn to derive the conditions for oscillation onset and understand the critical role of the delay parameter, $\\tau$. ",
            "id": "3914858",
            "problem": "A single-gene autorepressor in synthetic biology can be modeled, after linearization around its steady state, by a scalar Delay Differential Equation (DDE) of the form\n$$\n\\dot{x}(t) = a\\,x(t) + b\\,x(t-\\tau),\n$$\nwhere $x(t)$ is the deviation in gene product concentration from steady state, $a \\in \\mathbb{R}$ captures the instantaneous linearized self-dynamics (including degradation and nondelayed feedback), $b \\in \\mathbb{R}$ captures the slope of the delayed regulatory effect, and $\\tau > 0$ is the net transcription-translation delay. Starting from the fundamental definition of exponential trial solutions for linear time-invariant systems and the definition of a Hopf bifurcation as the creation of a small-amplitude limit cycle when a complex conjugate pair of eigenvalues crosses the imaginary axis with nonzero speed as a parameter varies, proceed as follows.\n\n1) Using the trial solution $x(t) = \\exp(\\lambda t)$, derive the characteristic equation for $\\lambda$.\n\n2) Assuming $a,b \\in \\mathbb{R}$, determine the necessary and sufficient condition for the existence of purely imaginary roots $\\lambda = i \\omega$ with $\\omega > 0$. Then obtain explicit algebraic relations between $\\omega$, $a$, and $b$, and express the corresponding family of delays $\\tau$ that yield $\\lambda = i \\omega$.\n\n3) By implicitly differentiating the characteristic equation with respect to $\\tau$, derive an expression for $\\mathrm{d}\\lambda/\\mathrm{d}\\tau$ evaluated at $\\lambda = i \\omega$, and show that the transversality condition $\\mathrm{d}\\operatorname{Re}(\\lambda)/\\mathrm{d}\\tau \\neq 0$ holds under the condition you found in part 2). Conclude that a Hopf bifurcation occurs when $\\tau$ crosses any such critical delay.\n\n4) For a specific autorepressor with parameters $a=-0.1\\,\\mathrm{min}^{-1}$ and $b=-0.3\\,\\mathrm{min}^{-1}$, compute the smallest positive critical delay $\\tau_c$ (in minutes) at which a Hopf bifurcation occurs. Express your final answer as an exact closed-form analytic expression in terms of elementary functions and constants; do not approximate numerically. Provide your final answer for $\\tau_c$ in minutes. No rounding is required, and you must not include units inside the final boxed answer.",
            "solution": "The problem statement is validated as being complete, self-contained, scientifically grounded, objective, and well-posed. The parameters provided are plausible within the context of synthetic biology modeling. Therefore, a full solution is warranted and will be provided by following the four specified parts of the problem.\n\nPart 1: Derivation of the characteristic equation.\nThe Delay Differential Equation (DDE) is given by:\n$$\n\\dot{x}(t) = a\\,x(t) + b\\,x(t-\\tau)\n$$\nTo find the characteristic equation, we substitute the trial exponential solution $x(t) = C\\exp(\\lambda t)$, where $C$ is a constant and $\\lambda \\in \\mathbb{C}$. The derivative is $\\dot{x}(t) = C\\lambda\\exp(\\lambda t)$ and the delayed term is $x(t-\\tau) = C\\exp(\\lambda(t-\\tau)) = C\\exp(\\lambda t)\\exp(-\\lambda\\tau)$. Substituting these expressions into the DDE yields:\n$$\nC\\lambda\\exp(\\lambda t) = a\\,C\\exp(\\lambda t) + b\\,C\\exp(\\lambda t)\\exp(-\\lambda\\tau)\n$$\nSince $C\\exp(\\lambda t) \\neq 0$, we can divide the entire equation by this term, which gives the characteristic equation for the eigenvalues $\\lambda$:\n$$\n\\lambda = a + b\\,\\exp(-\\lambda\\tau)\n$$\n\nPart 2: Condition for purely imaginary roots.\nA Hopf bifurcation can occur when a pair of complex conjugate eigenvalues crosses the imaginary axis. We therefore seek purely imaginary roots $\\lambda = i\\omega$, where $\\omega \\in \\mathbb{R}$ and $\\omega > 0$ represents the angular frequency of oscillation at the bifurcation point. Substituting $\\lambda = i\\omega$ into the characteristic equation:\n$$\ni\\omega = a + b\\,\\exp(-i\\omega\\tau)\n$$\nUsing Euler's formula, $\\exp(-i\\omega\\tau) = \\cos(\\omega\\tau) - i\\sin(\\omega\\tau)$, the equation becomes:\n$$\ni\\omega = a + b(\\cos(\\omega\\tau) - i\\sin(\\omega\\tau)) = (a + b\\cos(\\omega\\tau)) - i(b\\sin(\\omega\\tau))\n$$\nBy equating the real and imaginary parts of this complex equation, we obtain a system of two real equations:\n$$\n\\text{Real part: } 0 = a + b\\cos(\\omega\\tau) \\implies \\cos(\\omega\\tau) = -\\frac{a}{b}\n$$\n$$\n\\text{Imaginary part: } \\omega = -b\\sin(\\omega\\tau) \\implies \\sin(\\omega\\tau) = -\\frac{\\omega}{b}\n$$\nFor these two equations to hold simultaneously, the trigonometric identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$ must be satisfied. Substituting the expressions for cosine and sine:\n$$\n\\left(-\\frac{a}{b}\\right)^2 + \\left(-\\frac{\\omega}{b}\\right)^2 = 1\n$$\n$$\n\\frac{a^2}{b^2} + \\frac{\\omega^2}{b^2} = 1 \\implies a^2 + \\omega^2 = b^2\n$$\nSolving for $\\omega^2$, we get $\\omega^2 = b^2 - a^2$. Since we require a real frequency $\\omega > 0$, we must have $\\omega^2 > 0$. This leads to the necessary and sufficient condition for the existence of purely imaginary roots: $b^2 > a^2$, or $|b| > |a|$. When this holds, the frequency is $\\omega = \\sqrt{b^2 - a^2}$. The family of critical delays $\\tau_k$ for $k \\in \\{0, 1, 2, \\dots\\}$, can be found by solving $\\omega\\tau = \\theta$ where $\\cos(\\theta) = -a/b$ and $\\sin(\\theta) = -\\omega/b$. Let $\\alpha = \\arccos(-a/b)$, where $\\alpha \\in [0, \\pi]$. All solutions for $\\theta$ are given by $\\theta = 2\\pi k \\pm \\alpha$. The choice of sign depends on the sign of $b$ to match $\\sin(\\omega\\tau)$. The set of delays is then $\\tau_k = (\\theta_0+2\\pi k)/\\omega$, where $\\theta_0$ is the smallest positive angle satisfying the trigonometric conditions.\n\nPart 3: Transversality condition.\nThe transversality condition for a Hopf bifurcation requires that the eigenvalues cross the imaginary axis with non-zero speed, i.e., $\\mathrm{d}\\operatorname{Re}(\\lambda)/\\mathrm{d}\\tau \\neq 0$ at $\\lambda=i\\omega$. We differentiate the characteristic equation $\\lambda - a - b\\exp(-\\lambda\\tau) = 0$ implicitly with respect to $\\tau$:\n$$\n\\frac{\\mathrm{d}\\lambda}{\\mathrm{d}\\tau} - b\\left( \\exp(-\\lambda\\tau) \\left( -\\tau\\frac{\\mathrm{d}\\lambda}{\\mathrm{d}\\tau} - \\lambda \\right) \\right) = 0\n$$\n$$\n\\frac{\\mathrm{d}\\lambda}{\\mathrm{d}\\tau} \\left(1 + b\\tau\\exp(-\\lambda\\tau)\\right) = -b\\lambda\\exp(-\\lambda\\tau)\n$$\n$$\n\\frac{\\mathrm{d}\\lambda}{\\mathrm{d}\\tau} = -\\frac{b\\lambda\\exp(-\\lambda\\tau)}{1+b\\tau\\exp(-\\lambda\\tau)}\n$$\nFrom the characteristic equation itself, we have $b\\exp(-\\lambda\\tau) = \\lambda - a$. Substituting this into the derivative expression simplifies it to:\n$$\n\\frac{\\mathrm{d}\\lambda}{\\mathrm{d}\\tau} = -\\frac{\\lambda(\\lambda-a)}{1+\\tau(\\lambda-a)}\n$$\nWe evaluate this at the bifurcation point, $\\lambda=i\\omega$:\n$$\n\\left.\\frac{\\mathrm{d}\\lambda}{\\mathrm{d}\\tau}\\right|_{\\lambda=i\\omega} = -\\frac{i\\omega(i\\omega-a)}{1+\\tau(i\\omega-a)} = \\frac{\\omega^2+ia\\omega}{(1-a\\tau)+i\\omega\\tau}\n$$\nTo find the real part of this complex number, we multiply the numerator and denominator by the conjugate of the denominator, $(1-a\\tau)-i\\omega\\tau$:\n$$\n\\operatorname{Re}\\left(\\left.\\frac{\\mathrm{d}\\lambda}{\\mathrm{d}\\tau}\\right|_{\\lambda=i\\omega}\\right) = \\operatorname{Re}\\left(\\frac{(\\omega^2+ia\\omega)((1-a\\tau)-i\\omega\\tau)}{(1-a\\tau)^2+(\\omega\\tau)^2}\\right) = \\frac{\\omega^2(1-a\\tau) - (a\\omega)(-\\omega\\tau)}{(1-a\\tau)^2+(\\omega\\tau)^2} = \\frac{\\omega^2 - a\\omega^2\\tau + a\\omega^2\\tau}{(1-a\\tau)^2+(\\omega\\tau)^2}\n$$\n$$\n\\operatorname{Re}\\left(\\left.\\frac{\\mathrm{d}\\lambda}{\\mathrm{d}\\tau}\\right|_{\\lambda=i\\omega}\\right) = \\frac{\\omega^2}{(1-a\\tau)^2+(\\omega\\tau)^2}\n$$\nUnder the condition for Hopf bifurcation ($|b|>|a|$), we have $\\omega^2 = b^2-a^2 > 0$. The denominator is a sum of squares and is strictly positive since $\\tau > 0$ and $\\omega > 0$. Thus, $\\mathrm{d}\\operatorname{Re}(\\lambda)/\\mathrm{d}\\tau > 0$. The transversality condition is satisfied, confirming that a Hopf bifurcation occurs as $\\tau$ crosses a critical value.\n\nPart 4: Calculation of the smallest positive critical delay $\\tau_c$.\nFor the given parameters $a = -0.1\\,\\mathrm{min}^{-1}$ and $b = -0.3\\,\\mathrm{min}^{-1}$, we first check the condition $|b|>|a|$:\n$|-0.3| = 0.3$ and $|-0.1|=0.1$. Since $0.3 > 0.1$, the condition holds.\nThe oscillation frequency $\\omega$ is:\n$$\n\\omega = \\sqrt{b^2 - a^2} = \\sqrt{(-0.3)^2 - (-0.1)^2} = \\sqrt{0.09 - 0.01} = \\sqrt{0.08} = \\sqrt{\\frac{8}{100}} = \\frac{2\\sqrt{2}}{10} = \\frac{\\sqrt{2}}{5}\n$$\nThe value of $\\omega$ is in units of $\\mathrm{min}^{-1}$. At the bifurcation, we have:\n$$\n\\cos(\\omega\\tau) = -\\frac{a}{b} = -\\frac{-0.1}{-0.3} = -\\frac{1}{3}\n$$\n$$\n\\sin(\\omega\\tau) = -\\frac{\\omega}{b} = -\\frac{\\sqrt{0.08}}{-0.3} = \\frac{\\sqrt{8/100}}{0.3} = \\frac{2\\sqrt{2}/10}{3/10} = \\frac{2\\sqrt{2}}{3}\n$$\nSince $\\cos(\\omega\\tau)  0$ and $\\sin(\\omega\\tau) > 0$, the angle $\\omega\\tau$ lies in the second quadrant. The smallest positive angle satisfying these conditions is $\\arccos(-1/3)$. The general solution is $\\omega\\tau_k = \\arccos(-1/3) + 2\\pi k$ for $k=0, 1, 2, \\ldots$.\nThe smallest positive critical delay, $\\tau_c$, corresponds to $k=0$:\n$$\n\\omega\\tau_c = \\arccos\\left(-\\frac{1}{3}\\right)\n$$\nSolving for $\\tau_c$:\n$$\n\\tau_c = \\frac{1}{\\omega}\\arccos\\left(-\\frac{1}{3}\\right) = \\frac{1}{\\sqrt{2}/5}\\arccos\\left(-\\frac{1}{3}\\right) = \\frac{5}{\\sqrt{2}}\\arccos\\left(-\\frac{1}{3}\\right)\n$$\nRationalizing the denominator gives the final expression:\n$$\n\\tau_c = \\frac{5\\sqrt{2}}{2}\\arccos\\left(-\\frac{1}{3}\\right)\n$$",
            "answer": "$$\\boxed{\\frac{5\\sqrt{2}}{2}\\arccos\\left(-\\frac{1}{3}\\right)}$$"
        },
        {
            "introduction": "Linear stability analysis can predict the threshold at which oscillations begin, but it cannot describe the properties of the emergent limit cycle itself. To determine whether the new oscillatory state is stable (a supercritical bifurcation) or unstable (a subcritical bifurcation), we must consider the system's nonlinearities. This practice introduces center manifold theory, a powerful technique for reducing the dimensionality of a system at a bifurcation point and deriving the essential \"normal form\" that governs the oscillation's amplitude. ",
            "id": "3914817",
            "problem": "Consider a synthetic toggle-based oscillator comprising two mutually repressing transcriptional regulators and a shared auxiliary factor mediating coupling. Let $u$, $v$, and $w$ denote small deviations from a symmetric steady state in the concentrations of the two regulators and the auxiliary factor, respectively. Near this steady state, assume that the dynamics are well-approximated by the following scaled Ordinary Differential Equation (ODE) model derived from Taylor expansion of Hill-type repression and recruitment terms:\n$$\n\\begin{aligned}\n\\dot{u} = \\mu\\,u + \\omega\\,v + b\\left(u^{3} + u\\,v^{2}\\right) + c\\,v\\,w, \\\\\n\\dot{v} = \\mu\\,v - \\omega\\,u + b\\left(v^{3} + v\\,u^{2}\\right) - c\\,u\\,w, \\\\\n\\dot{w} = -\\lambda\\,w + d\\left(u^{2} + v^{2}\\right),\n\\end{aligned}\n$$\nwhere $\\mu$ is a scalar bifurcation parameter controlling the effective production-minus-degradation balance of the regulators, and $\\omega$, $\\lambda$, $c$, $d$, and $b$ are real constants determined by biochemical rates and the curvature of the Hill nonlinearities at the steady state. The auxiliary factor $w$ relaxes on the timescale set by $\\lambda0$ and is driven quadratically by the regulators, consistent with recruitment or burden-like coupling in synthetic biology. Assume the parameter values are\n$$\n\\omega = 1, \\quad \\lambda = 2, \\quad c = 1, \\quad d = 1, \\quad b = -\\frac{1}{10}.\n$$\nAt $\\mu = 0$, the linearization in the $(u,v)$-plane is a pure rotation with angular frequency $\\omega$, and the $w$-direction is strictly stable.\n\nStarting from fundamental definitions in nonlinear dynamical systems and using center manifold theory, perform a center manifold reduction about the equilibrium at the origin for $\\mu = 0$ up to cubic order in $(u,v)$. Derive the reduced normal form for the amplitude of oscillations $r = \\sqrt{u^2+v^2}$ and determine the first Lyapunov coefficient of the Hopf bifurcation. Based on its sign, assess whether the emergent limit cycle as $\\mu$ increases through zero is supercritical or subcritical. Report the numerical value of the first Lyapunov coefficient as your final answer. Express your final answer as an exact rational number. No units are required.",
            "solution": "The analysis is performed at the bifurcation point $\\mu=0$. Substituting the given parameter values, the system becomes:\n$$\n\\begin{aligned}\n\\dot{u} = v - \\frac{1}{10}(u^3 + uv^2) + vw \\\\\n\\dot{v} = -u - \\frac{1}{10}(v^3 + vu^2) - uw \\\\\n\\dot{w} = -2w + u^2 + v^2\n\\end{aligned}\n$$\nAs established, the linear part has eigenvalues $\\pm i$ and $-2$. The center subspace is the $(u,v)$-plane, and the stable subspace is the $w$-axis. Center manifold theory states that the long-term dynamics near the origin are governed by a lower-dimensional system on an invariant manifold, the center manifold $W^c$, which is tangent to the center subspace at the origin. This manifold can be expressed as a function $w = h(u,v)$. Since $W^c$ is tangent to the $(u,v)$-plane at the origin, we must have $h(0,0)=0$ and $Dh(0,0)=0$. Thus, the Taylor expansion of $h$ starts at quadratic order:\n$$\nw = h(u,v) = A u^2 + B uv + C v^2 + \\mathcal{O}(\\|(u,v)\\|^3)\n$$\nThe invariance of the manifold requires that for any trajectory $(u(t), v(t))$ on the manifold, $\\frac{d}{dt}h(u(t), v(t)) = \\dot{w}(t)$. This leads to the invariance equation:\n$$\n\\frac{\\partial h}{\\partial u}\\dot{u} + \\frac{\\partial h}{\\partial v}\\dot{v} = -2h(u,v) + (u^2+v^2)\n$$\nWe substitute the expressions for $\\dot{u}$, $\\dot{v}$ and $h(u,v)$, and match terms order by order. For the quadratic terms in $h$, we only need the linear parts of $\\dot{u}$ and $\\dot{v}$ (i.e., $\\dot{u} \\approx v$ and $\\dot{v} \\approx -u$).\n$$\n\\frac{\\partial h}{\\partial u} = 2Au + Bv + \\mathcal{O}(2) \\quad \\text{and} \\quad \\frac{\\partial h}{\\partial v} = Bu + 2Cv + \\mathcal{O}(2)\n$$\nSubstituting into the left side of the invariance equation:\n$$\n(2Au + Bv)(v) + (Bu + 2Cv)(-u) + \\mathcal{O}(3) = 2Auv + Bv^2 - Bu^2 - 2Cuv + \\mathcal{O}(3) = -Bu^2 + (2A - 2C)uv + Bv^2 + \\mathcal{O}(3)\n$$\nThe right side is:\n$$\n-2(Au^2 + Buv + Cv^2) + u^2 + v^2 + \\mathcal{O}(3) = (1-2A)u^2 - 2Buv + (1-2C)v^2 + \\mathcal{O}(3)\n$$\nEquating coefficients of the quadratic terms:\n- For $u^2$: $-B = 1-2A \\implies 2A - B = 1$\n- For $uv$: $2A - 2C = -2B \\implies A + B - C = 0$\n- For $v^2$: $B = 1-2C \\implies B + 2C = 1$\nSolving this linear system gives $A = \\frac{1}{2}$, $B = 0$, and $C = \\frac{1}{2}$.\nThus, the center manifold is approximated by:\n$$\nw = h(u,v) = \\frac{1}{2}(u^2 + v^2) + \\mathcal{O}(\\|(u,v)\\|^4)\n$$\nThe cubic terms are zero due to the symmetries of the system.\n\nNow, we obtain the reduced dynamics on the center manifold by substituting $w = \\frac{1}{2}(u^2+v^2)$ back into the equations for $\\dot{u}$ and $\\dot{v}$, re-introducing $\\mu$:\n$$\n\\begin{aligned}\n\\dot{u} = \\mu u + v - \\frac{1}{10}(u^3 + uv^2) + v\\left(\\frac{1}{2}(u^2 + v^2)\\right) \\\\\n\\dot{v} = \\mu v - u - \\frac{1}{10}(v^3 + vu^2) - u\\left(\\frac{1}{2}(u^2 + v^2)\\right)\n\\end{aligned}\n$$\nLet's use polar coordinates $u = r\\cos\\theta$ and $v = r\\sin\\theta$, where $r^2 = u^2+v^2$. The system becomes:\n$$\n\\begin{aligned}\n\\dot{u} = \\mu u + v - \\frac{1}{10}u r^2 + \\frac{1}{2}v r^2 \\\\\n\\dot{v} = \\mu v - u - \\frac{1}{10}v r^2 - \\frac{1}{2}u r^2\n\\end{aligned}\n$$\nTo find the equation for the amplitude $r$, we compute $r\\dot{r} = u\\dot{u} + v\\dot{v}$:\n$$\nu\\dot{u} = u\\left(\\mu u + v - \\frac{1}{10}u r^2 + \\frac{1}{2}v r^2\\right) = \\mu u^2 + uv - \\frac{1}{10}u^2 r^2 + \\frac{1}{2}uv r^2\n$$\n$$\nv\\dot{v} = v\\left(\\mu v - u - \\frac{1}{10}v r^2 - \\frac{1}{2}u r^2\\right) = \\mu v^2 - uv - \\frac{1}{10}v^2 r^2 - \\frac{1}{2}uv r^2\n$$\nSumming these two expressions:\n$$\nr\\dot{r} = u\\dot{u} + v\\dot{v} = \\mu(u^2+v^2) + (uv-uv) - \\frac{1}{10}(u^2+v^2)r^2 + \\left(\\frac{1}{2}uv - \\frac{1}{2}uv\\right)r^2\n$$\n$$\nr\\dot{r} = \\mu r^2 - \\frac{1}{10}r^2 r^2 = \\mu r^2 - \\frac{1}{10}r^4\n$$\nDividing by $r$ (for $r \\neq 0$), we get the normal form for the amplitude:\n$$\n\\dot{r} = \\mu r - \\frac{1}{10}r^3\n$$\nThe standard normal form for a Hopf bifurcation is $\\dot{r} = \\mu r + L_1 r^3 + \\mathcal{O}(r^5)$, where $L_1$ is the first Lyapunov coefficient. By comparing our result with the standard form, we identify the first Lyapunov coefficient as:\n$$\nL_1 = -\\frac{1}{10}\n$$\nThe sign of $L_1$ determines the nature of the bifurcation. Since $L_1 = -\\frac{1}{10}  0$, the bifurcation is **supercritical**. This means that as $\\mu$ increases through $0$, the stable equilibrium at the origin becomes unstable and gives birth to a stable limit cycle whose amplitude squared, $r_{lc}^2$, is approximately $-\\frac{\\mu}{L_1} = 10\\mu$.\n\nThe problem asks for the numerical value of the first Lyapunov coefficient.\n$$\nL_1 = -\\frac{1}{10}\n$$\nThis is an exact rational number as requested.",
            "answer": "$$\\boxed{-\\frac{1}{10}}$$"
        },
        {
            "introduction": "For a synthetic oscillator to be functional, it must be robust—meaning its amplitude and frequency should be stable against cellular noise and parameter fluctuations. The universal \"normal form\" equation derived from bifurcation analysis provides a direct way to quantify these crucial properties. This practice will guide you in using the complex amplitude equation to calculate key metrics of oscillator performance, such as sensitivity to control parameters and the rate of convergence to the limit cycle, which is quantified by Floquet multipliers. ",
            "id": "3914799",
            "problem": "Consider a reduced normal-form model for gene regulatory oscillations near a supercritical Hopf bifurcation, which captures the universal dynamics of a wide class of synthetic biological oscillators close to onset. The model describes the complex amplitude $z(t) \\in \\mathbb{C}$ of the dominant oscillatory mode and is given by the ordinary differential equation (ODE)\n$$\n\\frac{dz}{dt} = \\left(\\mu + i \\,\\omega_0\\right) z - \\left(1 + i \\, c_2\\right) |z|^2 z,\n$$\nwhere $\\mu \\in \\mathbb{R}$ is a scalar control parameter (dimensionless), $\\omega_0 \\in \\mathbb{R}$ is the natural angular frequency parameter (in radians per unit time), and $c_2 \\in \\mathbb{R}$ is a nonlinear frequency-coupling coefficient (dimensionless). The time variable is $t$ (in time units), and the angle unit throughout is radians.\n\nYour task is to evaluate robustness of the oscillations by computing the sensitivity of the stable limit cycle to variations in the control parameter $\\mu$ and linking this sensitivity to the structure of the Floquet spectrum. Begin from first principles as follows:\n\n1. Transform the dynamics to polar form $z(t) = r(t) e^{i \\theta(t)}$ and derive the evolution equations for $r(t)$ and $\\theta(t)$.\n2. For $\\mu > 0$, determine the nonzero equilibrium radius $r^\\star$ corresponding to the stable limit cycle and the fundamental period $T$ of oscillation.\n3. Compute the sensitivity of the limit-cycle amplitude with respect to $\\mu$, defined as $S_r = \\partial r^\\star / \\partial \\mu$, evaluated at fixed $\\omega_0$ and $c_2$.\n4. Compute the sensitivity of the period with respect to $\\mu$, defined as $S_T = \\partial T / \\partial \\mu$, evaluated at fixed $\\omega_0$ and $c_2$.\n5. Linearize the radial dynamics around $r^\\star$ to obtain the nontrivial Floquet exponent $\\lambda_\\perp$ that governs transverse stability of the limit cycle. Use it to compute the magnitude of the corresponding Floquet multiplier over one period, $\\rho = \\exp\\left(\\lambda_\\perp \\, T\\right)$, and report $|\\rho|$.\n6. Interpret robustness in terms of small $|S_r|$ and small $|\\rho|$ (strong transverse stability), and report the numerical values that quantify these properties.\n\nAll answers involving angles must use radians, and all times must be expressed in the same time units as $t$. The outputs to compute for each test case are the list\n$$\n\\left[r^\\star,\\; T,\\; S_r,\\; S_T,\\; |\\rho|\\right],\n$$\nnumerically rounded to six decimal places.\n\nTest Suite:\nUse the following parameter sets $(\\mu, \\omega_0, c_2)$:\n- Case A (baseline near onset, no amplitude–phase coupling): $(0.01,\\; 1.0,\\; 0.0)$.\n- Case B (farther from onset, positive coupling): $(0.25,\\; 1.0,\\; 0.5)$.\n- Case C (very close to onset, negative coupling; edge case): $(0.0001,\\; 1.0,\\; -0.8)$.\n- Case D (higher base frequency, positive coupling): $(0.1,\\; 2.5,\\; 1.2)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list of the four case results, each itself a list in the order above, all enclosed in square brackets. For example:\n\"[ [rA,T_A,Sr_A,ST_A,absrho_A], [rB,T_B,Sr_B,ST_B,absrho_B], [rC,T_C,Sr_C,ST_C,absrho_C], [rD,T_D,Sr_D,ST_D,absrho_D] ]\"\nEnsure every floating-point number is rounded to six decimal places in the printed output.",
            "solution": "The solution proceeds by following the steps outlined in the problem statement.\n\n**1. Transformation to Polar Coordinates**\n\nLet $z(t) = r(t) e^{i \\theta(t)}$, where $r(t)$ is the real-valued amplitude and $\\theta(t)$ is the real-valued phase. The time derivative is:\n$$\n\\frac{dz}{dt} = \\frac{dr}{dt} e^{i\\theta} + r \\left(i \\frac{d\\theta}{dt}\\right) e^{i\\theta} = \\left(\\frac{dr}{dt} + i r \\frac{d\\theta}{dt}\\right) e^{i\\theta}\n$$\nWe also note that $|z|^2 = |r e^{i\\theta}|^2 = r^2$. Substituting these into the original ODE:\n$$\n\\left(\\frac{dr}{dt} + i r \\frac{d\\theta}{dt}\\right) e^{i\\theta} = \\left(\\mu + i \\,\\omega_0\\right) r e^{i\\theta} - \\left(1 + i \\, c_2\\right) r^2 (r e^{i\\theta})\n$$\nDividing by $e^{i\\theta}$ (which is permissible as long as $z \\neq 0$):\n$$\n\\frac{dr}{dt} + i r \\frac{d\\theta}{dt} = (\\mu r - r^3) + i(\\omega_0 r - c_2 r^3)\n$$\nEquating the real and imaginary parts yields the decoupled system for $r(t)$ and $\\theta(t)$:\n$$\n\\frac{dr}{dt} = \\mu r - r^3\n$$\n$$\n\\frac{d\\theta}{dt} = \\omega_0 - c_2 r^2 \\quad (\\text{for } r \\neq 0)\n$$\n\n**2. Limit Cycle Radius and Period**\n\nThe limit cycle corresponds to a non-trivial, stable fixed point of the radial dynamics. We set $\\frac{dr}{dt} = 0$:\n$$\n\\mu r - r^3 = 0 \\implies r(\\mu - r^2) = 0\n$$\nThis gives two solutions: $r = 0$ (the origin) and $r^2 = \\mu$. For a limit cycle to exist, we require $\\mu > 0$, which ensures a real, non-zero radius. The equilibrium radius of the limit cycle is:\n$$\nr^\\star = \\sqrt{\\mu}\n$$\nOn this limit cycle, the radius $r$ is constant ($r = r^\\star$), so the angular velocity is also constant:\n$$\n\\omega = \\left. \\frac{d\\theta}{dt} \\right|_{r=r^\\star} = \\omega_0 - c_2 (r^\\star)^2 = \\omega_0 - c_2 \\mu\n$$\nThe period of oscillation, $T$, is the time taken for the phase $\\theta$ to advance by $2\\pi$ radians at this constant angular velocity:\n$$\nT = \\frac{2\\pi}{|\\omega|} = \\frac{2\\pi}{|\\omega_0 - c_2 \\mu|}\n$$\nAssuming the oscillatory regime is not degenerate (i.e., $\\omega \\neq 0$) and considering continuous variation from $\\mu=0$ where $\\omega = \\omega_0 > 0$ for the given test cases, we can drop the absolute value for these cases.\n$$\nT = \\frac{2\\pi}{\\omega_0 - c_2 \\mu}\n$$\n\n**3. Amplitude Sensitivity ($S_r$)**\n\nThe sensitivity of the limit cycle amplitude to the control parameter $\\mu$ is the partial derivative $S_r = \\frac{\\partial r^\\star}{\\partial \\mu}$.\n$$\nS_r = \\frac{\\partial}{\\partial \\mu} \\left(\\sqrt{\\mu}\\right) = \\frac{\\partial}{\\partial \\mu} \\left(\\mu^{1/2}\\right) = \\frac{1}{2} \\mu^{-1/2} = \\frac{1}{2\\sqrt{\\mu}}\n$$\nThis is defined for $\\mu > 0$.\n\n**4. Period Sensitivity ($S_T$)**\n\nThe sensitivity of the period to $\\mu$ is $S_T = \\frac{\\partial T}{\\partial \\mu}$.\n$$\nS_T = \\frac{\\partial}{\\partial \\mu} \\left( \\frac{2\\pi}{\\omega_0 - c_2 \\mu} \\right) = 2\\pi \\frac{\\partial}{\\partial \\mu} \\left( (\\omega_0 - c_2 \\mu)^{-1} \\right)\n$$\nUsing the chain rule:\n$$\nS_T = 2\\pi \\cdot (-1)(\\omega_0 - c_2 \\mu)^{-2} \\cdot (-c_2) = \\frac{2\\pi c_2}{(\\omega_0 - c_2 \\mu)^2}\n$$\n\n**5. Floquet Exponent and Multiplier Magnitude ($|\\rho|$)**\n\nThe stability of the limit cycle in the direction transverse to the flow is determined by linearizing the radial dynamics $f(r) = \\mu r - r^3$ around the fixed point $r^\\star = \\sqrt{\\mu}$. The eigenvalue of this linearized one-dimensional system is the nontrivial Floquet exponent, $\\lambda_\\perp$.\n$$\n\\lambda_\\perp = \\left. \\frac{df}{dr} \\right|_{r=r^\\star} = \\left. (\\mu - 3r^2) \\right|_{r=\\sqrt{\\mu}} = \\mu - 3(\\sqrt{\\mu})^2 = \\mu - 3\\mu = -2\\mu\n$$\nSince $\\mu > 0$, $\\lambda_\\perp  0$, confirming that the limit cycle is stable, as expected for a supercritical Hopf bifurcation. The corresponding Floquet multiplier, $\\rho$, quantifies the contraction or expansion of a small transverse perturbation after one full period $T$.\n$$\n\\rho = e^{\\lambda_\\perp T} = e^{-2\\mu T}\n$$\nWe need its magnitude, $|\\rho|$. Since $\\mu$ and $T$ are positive real numbers, the exponent is real and negative.\n$$\n|\\rho| = |e^{-2\\mu T}| = e^{-2\\mu T} = \\exp\\left(-2\\mu \\frac{2\\pi}{\\omega_0 - c_2 \\mu}\\right) = \\exp\\left(\\frac{-4\\pi\\mu}{\\omega_0 - c_2 \\mu}\\right)\n$$\n\n### Summary of Formulas for Computation\nFor a given set of parameters $(\\mu, \\omega_0, c_2)$:\n1.  $r^\\star = \\sqrt{\\mu}$\n2.  $T = \\frac{2\\pi}{\\omega_0 - c_2 \\mu}$\n3.  $S_r = \\frac{1}{2\\sqrt{\\mu}}$\n4.  $S_T = \\frac{2\\pi c_2}{(\\omega_0 - c_2 \\mu)^2}$\n5.  $|\\rho| = \\exp\\left(\\frac{-4\\pi\\mu}{\\omega_0 - c_2 \\mu}\\right)$\n\nThese formulas will now be applied to the test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates stability and sensitivity metrics for a gene regulatory\n    oscillator model near a supercritical Hopf bifurcation.\n    \"\"\"\n\n    # Test cases are provided as tuples of (mu, omega_0, c_2).\n    test_cases = [\n        (0.01, 1.0, 0.0),    # Case A\n        (0.25, 1.0, 0.5),    # Case B\n        (0.0001, 1.0, -0.8), # Case C\n        (0.1, 2.5, 1.2),     # Case D\n    ]\n\n    all_results = []\n    for case in test_cases:\n        mu, w0, c2 = case\n\n        # 1. Equilibrium radius (r_star)\n        # For mu  0, the limit cycle radius is r_star = sqrt(mu).\n        r_star = np.sqrt(mu)\n\n        # 2. Period of oscillation (T)\n        # The angular frequency on the limit cycle is omega = w0 - c2 * mu.\n        # The period T = 2*pi / omega.\n        omega = w0 - c2 * mu\n        period = (2 * np.pi) / omega\n\n        # 3. Amplitude sensitivity (S_r)\n        # S_r = d(r_star)/d(mu) = d(sqrt(mu))/d(mu) = 1 / (2*sqrt(mu)).\n        s_r = 1 / (2 * np.sqrt(mu))\n\n        # 4. Period sensitivity (S_T)\n        # S_T = d(T)/d(mu) = d(2*pi / (w0 - c2*mu))/d(mu) = 2*pi*c2 / (w0 - c2*mu)^2.\n        s_t = (2 * np.pi * c2) / (omega**2)\n\n        # 5. Floquet multiplier magnitude (abs_rho)\n        # The nontrivial Floquet exponent is lambda_perp = -2*mu.\n        # The multiplier is rho = exp(lambda_perp * T).\n        # The magnitude is |rho| = exp(-2*mu*T).\n        lambda_perp = -2 * mu\n        abs_rho = np.exp(lambda_perp * period)\n\n        # Store the results for the current case.\n        case_results = [r_star, period, s_r, s_t, abs_rho]\n        all_results.append(case_results)\n\n    # Format the final output string according to the problem specification.\n    # The format is a list of lists, where inner lists are separated by \", \"\n    # and numbers within inner lists are separated by \",\".\n    # All numbers are rounded to six decimal places.\n    case_strings = []\n    for row in all_results:\n        formatted_row = [f\"{x:.6f}\" for x in row]\n        case_strings.append(f\"[{','.join(formatted_row)}]\")\n    \n    final_output = f\"[{', '.join(case_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}