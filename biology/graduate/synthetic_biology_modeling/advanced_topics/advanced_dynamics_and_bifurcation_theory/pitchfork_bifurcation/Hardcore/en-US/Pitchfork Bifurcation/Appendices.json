{
    "hands_on_practices": [
        {
            "introduction": "The journey to mastering pitchfork bifurcations begins with its quintessential mathematical representation, the normal form equation. This exercise  strips the phenomenon down to its core, allowing you to practice the fundamental skill of identifying equilibrium points and classifying their stability through linear analysis. This foundational calculation is the bedrock upon which more complex analyses of biological switches are built.",
            "id": "3919636",
            "problem": "Consider a minimal symmetry-breaking model of a bistable cell-fate decision in a homogeneous tissue, where the scalar state variable $x$ represents a dimensionless, signed deviation in a lineage-specific transcription factor activity from a symmetry point. Near the symmetry point, the lowest-order normal form capturing the onset of bistability under a control parameter $\\mu$ (proportional to a dimensionless morphogen drive) is the one-dimensional ordinary differential equation (ODE)\n$$\n\\frac{dx}{dt} = f(x) = \\mu x - x^{3},\n$$\nwhere $\\mu$ is real. This model is widely used in biomedical systems modeling to represent the local normal form of a supercritical pitchfork bifurcation emerging from symmetric gene-regulatory interactions.\n\nAssume $\\mu > 0$. Using only the foundational definitions for equilibria and linear stability in one-dimensional dynamical systems, proceed from first principles to:\n- identify the equilibrium points $x^{\\ast}$,\n- compute the Jacobian (the derivative of $f$ with respect to $x$) evaluated at each equilibrium, and\n- infer the linear stability of each equilibrium from the sign of the Jacobian.\n\nExpress your final answer as a single row matrix containing the values of the Jacobian $f'(x^{\\ast})$ at the equilibria in the ordered sequence $x^{\\ast} = 0$, $x^{\\ast} = +\\sqrt{\\mu}$, $x^{\\ast} = -\\sqrt{\\mu}$. No numerical approximation is required; provide the exact symbolic expression. Do not include any units in your final answer.",
            "solution": "The problem requires the identification and linear stability analysis of the equilibrium points for the one-dimensional ordinary differential equation (ODE) given by $\\frac{dx}{dt} = f(x) = \\mu x - x^{3}$, under the condition that the parameter $\\mu > 0$.\n\nFirst, we identify the equilibrium points, which we denote as $x^{\\ast}$. By definition, an equilibrium point of a dynamical system is a state where the system's variables do not change over time. For the given ODE, this corresponds to the condition $\\frac{dx}{dt} = 0$. We must therefore find the roots of the equation $f(x^{\\ast}) = 0$.\n$$\n\\mu x^{\\ast} - (x^{\\ast})^{3} = 0\n$$\nTo solve for $x^{\\ast}$, we can factor the expression on the left-hand side:\n$$\nx^{\\ast}(\\mu - (x^{\\ast})^{2}) = 0\n$$\nThis equation provides three distinct real solutions, given the problem's constraint that $\\mu > 0$.\n$1$. The trivial equilibrium point is found by setting the first factor to zero: $x^{\\ast}_1 = 0$.\n$2$. The non-trivial equilibrium points are found by setting the second factor to zero: $\\mu - (x^{\\ast})^{2} = 0$. This implies $(x^{\\ast})^{2} = \\mu$. Since the problem specifies $\\mu > 0$, we can take the square root to find two distinct real roots: $x^{\\ast}_2 = +\\sqrt{\\mu}$ and $x^{\\ast}_3 = -\\sqrt{\\mu}$.\n\nTherefore, the three equilibrium points of the system are $x^{\\ast} = 0$, $x^{\\ast} = +\\sqrt{\\mu}$, and $x^{\\ast} = -\\sqrt{\\mu}$.\n\nNext, we proceed with the linear stability analysis for each equilibrium point. The stability of an equilibrium $x^{\\ast}$ in a one-dimensional system is determined by the sign of the Jacobian evaluated at that point. For a function $f(x)$, the Jacobian is its first derivative, $f'(x) = \\frac{df}{dx}$. The stability criteria are:\n- If $f'(x^{\\ast})  0$, the equilibrium is linearly stable. A small perturbation from the equilibrium will decay over time.\n- If $f'(x^{\\ast}) > 0$, the equilibrium is linearly unstable. A small perturbation will grow over time, causing the system to move away from the equilibrium.\n- If $f'(x^{\\ast}) = 0$, the equilibrium is termed non-hyperbolic, and its stability cannot be determined from linear analysis alone.\n\nWe first compute the general expression for the Jacobian by differentiating $f(x) = \\mu x - x^{3}$ with respect to $x$:\n$$\nf'(x) = \\frac{d}{dx}(\\mu x - x^{3}) = \\mu - 3x^{2}\n$$\nNow, we evaluate this Jacobian at each of the three identified equilibrium points.\n\nCase 1: Equilibrium point $x^{\\ast} = 0$.\nThe value of the Jacobian is:\n$$\nf'(0) = \\mu - 3(0)^{2} = \\mu\n$$\nGiven the condition $\\mu > 0$, the Jacobian $f'(0)$ is positive. This indicates that the equilibrium point at $x^{\\ast} = 0$ is linearly unstable.\n\nCase 2: Equilibrium point $x^{\\ast} = +\\sqrt{\\mu}$.\nThe value of the Jacobian is:\n$$\nf'(+\\sqrt{\\mu}) = \\mu - 3(+\\sqrt{\\mu})^{2} = \\mu - 3\\mu = -2\\mu\n$$\nSince $\\mu > 0$, the term $-2\\mu$ is negative. Therefore, $f'(+\\sqrt{\\mu})  0$, which indicates that the equilibrium point at $x^{\\ast} = +\\sqrt{\\mu}$ is linearly stable.\n\nCase 3: Equilibrium point $x^{\\ast} = -\\sqrt{\\mu}$.\nThe value of the Jacobian is:\n$$\nf'(-\\sqrt{\\mu}) = \\mu - 3(-\\sqrt{\\mu})^{2} = \\mu - 3\\mu = -2\\mu\n$$\nAs in the previous case, since $\\mu > 0$, the Jacobian $f'(-\\sqrt{\\mu})$ is negative. This indicates that the equilibrium point at $x^{\\ast} = -\\sqrt{\\mu}$ is also linearly stable.\n\nThe problem asks for the final answer to be a single row matrix containing the values of the Jacobian $f'(x^{\\ast})$ evaluated at the equilibria in the ordered sequence $x^{\\ast} = 0$, $x^{\\ast} = +\\sqrt{\\mu}$, and $x^{\\ast} = -\\sqrt{\\mu}$. These values are, respectively, $\\mu$, $-2\\mu$, and $-2\\mu$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\mu  -2\\mu  -2\\mu \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While deterministic models reveal the stable states of a system, they do not capture the full picture of a noisy cellular environment. This practice  introduces the critical role of stochastic fluctuations, recasting the bifurcation diagram as a potential energy landscape. By calculating the mean first passage time, you will quantify how molecular noise enables the system to switch between stable states, a key consideration for the robustness and function of any biological switch.",
            "id": "3919650",
            "problem": "In a bistable gene regulatory circuit with positive feedback, the deterministic dynamics for a dimensionless gene expression level $x(t)$ near a supercritical pitchfork bifurcation can be modeled by the ordinary differential equation $x'=\\mu x - x^{3}$, where $\\mu$ is a dimensionless bifurcation parameter proportional to the net feedback strength. Molecular copy number fluctuations introduce stochasticity, yielding the overdamped Langevin dynamics\n$$\nx'=\\mu x - x^{3} + \\sqrt{2D}\\,\\xi(t),\n$$\nwhere $\\xi(t)$ is Gaussian white noise with $\\langle \\xi(t) \\rangle = 0$ and $\\langle \\xi(t)\\xi(s)\\rangle=\\delta(t-s)$, and $D>0$ is a dimensionless effective noise intensity determined by birth-death processes in the underlying reaction network. Assume $\\mu>0$, so that the deterministic system has two stable gene expression states separated by an unstable state.\n\nStarting from the fundamental gradient-flow representation $x'=-U'(x)+\\sqrt{2D}\\,\\xi(t)$ for an overdamped one-dimensional stochastic differential equation (SDE), where $U(x)$ is a scalar potential, derive the effective potential $U(x)$ associated with the drift $\\mu x - x^{3}$. Locate the stable wells and the barrier (saddle) for $\\mu>0$, and determine the barrier height between a stable well and the barrier. Using the classical Kramersâ€™ approximation for escape over a potential barrier in the overdamped regime, compute the mean first passage time (MFPT) for a transition from the right well (near $x\\approx +\\sqrt{\\mu}$) to the left well (near $x\\approx -\\sqrt{\\mu}$). Express your final MFPT as a closed-form analytical expression in terms of $\\mu$ and $D$, using dimensionless units. Provide no numerical evaluation.",
            "solution": "The user has provided a valid problem statement.\n\nThe problem asks for the mean first passage time (MFPT) for a particle in a double-well potential, described by a one-dimensional overdamped Langevin equation. The solution requires deriving the potential, identifying its features, and applying Kramers' theory for the escape rate.\n\nThe stochastic differential equation (SDE) is given as:\n$$\nx' = \\mu x - x^{3} + \\sqrt{2D}\\,\\xi(t)\n$$\nwhere $x(t)$ is the state variable, $\\mu > 0$ is the bifurcation parameter, $D > 0$ is the noise intensity, and $\\xi(t)$ is Gaussian white noise.\n\nThe general form of an overdamped Langevin equation in a potential $U(x)$ is:\n$$\nx' = -U'(x) + \\sqrt{2D}\\,\\xi(t)\n$$\nwhere $U'(x)$ is the derivative of the potential with respect to $x$.\n\n**Step 1: Derive the effective potential $U(x)$**\nBy comparing the drift term of the given SDE with the general form, we can identify $-U'(x)$:\n$$\n-U'(x) = \\mu x - x^3\n$$\nTherefore, the force is $F(x) = \\mu x - x^3$. The potential is found by integrating $-F(x)$:\n$$\nU'(x) = -(\\mu x - x^3) = x^3 - \\mu x\n$$\nIntegrating $U'(x)$ with respect to $x$ yields the potential $U(x)$:\n$$\nU(x) = \\int (x^3 - \\mu x) \\,dx = \\frac{x^4}{4} - \\frac{\\mu x^2}{2} + C\n$$\nThe constant of integration $C$ merely shifts the potential energy landscape vertically and does not affect the dynamics or the height of potential barriers. We can set $C=0$ without loss of generality. Thus, the effective potential is:\n$$\nU(x) = \\frac{x^4}{4} - \\frac{\\mu x^2}{2}\n$$\n\n**Step 2: Locate the stable wells and the barrier**\nThe extrema of the potential $U(x)$ correspond to the fixed points of the deterministic system ($D=0$), which are found by setting $U'(x) = 0$:\n$$\nU'(x) = x^3 - \\mu x = x(x^2 - \\mu) = 0\n$$\nSince $\\mu > 0$, the roots are $x_0 = 0$, $x_s = \\pm\\sqrt{\\mu}$.\n\nTo determine the stability of these fixed points, we examine the second derivative of the potential, $U''(x)$:\n$$\nU''(x) = \\frac{d}{dx}(x^3 - \\mu x) = 3x^2 - \\mu\n$$\nA point $x^*$ is a stable minimum (well) if $U''(x^*) > 0$ and an unstable maximum (barrier) if $U''(x^*)  0$.\n- At $x_0 = 0$: $U''(0) = 3(0)^2 - \\mu = -\\mu$. Since $\\mu > 0$, $U''(0)  0$. This point is a local maximum, representing the potential barrier between the two wells.\n- At $x_s = \\pm\\sqrt{\\mu}$: $U''(\\pm\\sqrt{\\mu}) = 3(\\pm\\sqrt{\\mu})^2 - \\mu = 3\\mu - \\mu = 2\\mu$. Since $\\mu > 0$, $U''(\\pm\\sqrt{\\mu}) > 0$. These two points are local minima, representing the stable wells of the potential.\n\nSo, the system has stable wells at $x = \\pm\\sqrt{\\mu}$ and a barrier at $x=0$. The problem asks for the transition from the right well (near $x \\approx +\\sqrt{\\mu}$) to the left well (near $x \\approx -\\sqrt{\\mu}$).\n\n**Step 3: Determine the barrier height**\nThe barrier height, $\\Delta U$, is the difference in potential energy between the top of the barrier and the bottom of a stable well. We calculate this for the transition originating from the right well.\n- Potential at the barrier top ($x_b = 0$): $U(0) = \\frac{0^4}{4} - \\frac{\\mu(0)^2}{2} = 0$.\n- Potential at the right well bottom ($x_w = +\\sqrt{\\mu}$): $U(\\sqrt{\\mu}) = \\frac{(\\sqrt{\\mu})^4}{4} - \\frac{\\mu(\\sqrt{\\mu})^2}{2} = \\frac{\\mu^2}{4} - \\frac{\\mu^2}{2} = -\\frac{\\mu^2}{4}$.\n\nThe barrier height is:\n$$\n\\Delta U = U(x_b) - U(x_w) = U(0) - U(\\sqrt{\\mu}) = 0 - \\left(-\\frac{\\mu^2}{4}\\right) = \\frac{\\mu^2}{4}\n$$\n\n**Step 4: Compute the Mean First Passage Time (MFPT) using Kramers' approximation**\nKramers' theory provides an approximation for the mean time to escape from a potential well over a barrier, valid in the low-noise limit ($D \\ll \\Delta U$). For a one-dimensional overdamped system, the MFPT, $\\tau$, to escape from a well at $x_w$ over a barrier at $x_b$ is given by:\n$$\n\\tau \\approx \\frac{2\\pi}{\\sqrt{U''(x_w) |U''(x_b)|}} \\exp\\left(\\frac{\\Delta U}{D}\\right)\n$$\nWe have already calculated the necessary components:\n- The location of the right well: $x_w = \\sqrt{\\mu}$\n- The location of the barrier: $x_b = 0$\n- The second derivative at the well: $U''(x_w) = U''(\\sqrt{\\mu}) = 2\\mu$\n- The second derivative at the barrier: $U''(x_b) = U''(0) = -\\mu$, so $|U''(x_b)|= \\mu$.\n- The barrier height: $\\Delta U = \\frac{\\mu^2}{4}$\n\nSubstituting these values into the Kramers' formula:\n$$\n\\tau \\approx \\frac{2\\pi}{\\sqrt{(2\\mu)(\\mu)}} \\exp\\left(\\frac{\\mu^2/4}{D}\\right)\n$$\n$$\n\\tau = \\frac{2\\pi}{\\sqrt{2\\mu^2}} \\exp\\left(\\frac{\\mu^2}{4D}\\right)\n$$\n$$\n\\tau = \\frac{2\\pi}{\\mu\\sqrt{2}} \\exp\\left(\\frac{\\mu^2}{4D}\\right)\n$$\n$$\n\\tau = \\frac{\\pi\\sqrt{2}}{\\mu} \\exp\\left(\\frac{\\mu^2}{4D}\\right)\n$$\nThis expression represents the mean time to escape the right well. In this symmetric double-well system, the escape time from the well is an excellent approximation for the MFPT to the other well, as the transit time from the barrier top to the opposing well bottom is negligible compared to the waiting time for activation over the barrier.",
            "answer": "$$\n\\boxed{\\frac{\\pi\\sqrt{2}}{\\mu}\\exp\\left(\\frac{\\mu^2}{4D}\\right)}\n$$"
        },
        {
            "introduction": "Perfect symmetry is a mathematical idealization; real biological circuits are almost always subject to imbalances or biases. This final exercise  explores the \"imperfect\" pitchfork bifurcation, a more general and realistic model. By combining analytical derivation with computational implementation, you will map the complete parameter space of the system, identifying the so-called \"cusp\" boundaries that define the region of bistability and offering a powerful tool for designing and understanding synthetic circuits.",
            "id": "3926829",
            "problem": "Consider the imperfect unfolding of the pitchfork bifurcation encountered in models of symmetry-broken bistability in synthetic gene regulation circuits. The deterministic one-dimensional Ordinary Differential Equation (ODE) has the normal form given by $$\\frac{dx}{dt} = f(x;\\mu,\\epsilon) = \\mu x - x^3 + \\epsilon,$$ where $x$ is a dimensionless state variable (e.g., a normalized gene expression level), $\\mu$ is a dimensionless control parameter representing the effective positive feedback strength, and $\\epsilon$ is a dimensionless imperfection parameter representing a symmetry-breaking bias in the regulation.\n\nThis ODE admits steady states given by the real roots of $$f(x;\\mu,\\epsilon) = 0,$$ that is, solutions to $$x^3 - \\mu x + \\epsilon = 0.$$ The boundary of multistability (the cusp curve) in the $(\\mu,\\epsilon)$ parameter space is defined by the condition that at least two steady states coalesce, equivalently that the cubic has a repeated real root. The multistable region relevant to design corresponds to parameter values where the system has multiple asymptotically stable steady states, where a steady state $x^\\star$ is asymptotically stable when $$f'(x^\\star;\\mu,\\epsilon) = \\mu - 3(x^\\star)^2  0.$$\n\nTask:\n1. Starting from the ODE and the equilibrium condition, use well-tested facts from polynomial theory to derive an explicit analytic expression for the cusp curve in $(\\mu,\\epsilon)$ for this imperfect unfolding.\n2. Design a numerical algorithm that, for any given $(\\mu,\\epsilon)$, finds all real steady states of the cubic, classifies their linear stability using the sign of $f'(x^\\star;\\mu,\\epsilon)$, and counts the number of asymptotically stable equilibria.\n3. Implement both the analytic cusp calculation and the numerical classification in a complete, runnable program that:\n   - Computes values on the cusp curve for specified $\\mu$ values.\n   - Classifies the number of asymptotically stable equilibria for specified $(\\mu,\\epsilon)$ pairs.\n   - Maps the multistable region over a coarse grid in $(\\mu,\\epsilon)$ space by counting grid points with exactly two asymptotically stable equilibria.\n4. Use strictly mathematical quantities without physical units. No angle quantities are involved.\n\nTest Suite:\n- Cusp curve evaluations on the positive branch at $\\mu \\in \\{0.0, 0.25, 1.0, 2.0\\}$, and on the negative branch at $\\mu \\in \\{1.0\\}$. Report each cusp value of $\\epsilon$ rounded to six decimal places.\n- Stability classification (number of asymptotically stable equilibria) for the following $(\\mu,\\epsilon)$ pairs:\n  - $(1.0, 0.0)$,\n  - $(1.0, \\epsilon_{\\text{cusp}}(1.0))$ on the cusp boundary for the positive branch,\n  - $(1.0, 0.1)$,\n  - $(1.0, 0.5)$,\n  - $(0.0, 0.1)$,\n  - $(1.0, -0.1)$.\n  In each case, count only equilibria where $f'(x^\\star;\\mu,\\epsilon)  0$; treat equilibria with $f'(x^\\star;\\mu,\\epsilon) = 0$ as not asymptotically stable.\n- Multistability mapping over a rectangular grid: $\\mu$ sampled uniformly over $[0,2]$ with $41$ points and $\\epsilon$ sampled uniformly over $[-0.6,0.6]$ with $61$ points. Report the integer count of grid points exhibiting exactly two asymptotically stable equilibria.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The order must be:\n- First, the four positive-branch cusp values of $\\epsilon$ for $\\mu = 0.0, 0.25, 1.0, 2.0$ (each rounded to six decimal places),\n- then the single negative-branch cusp value of $\\epsilon$ for $\\mu = 1.0$ (rounded to six decimal places),\n- then the six integers giving the number of asymptotically stable equilibria for the specified $(\\mu,\\epsilon)$ pairs in the order listed above,\n- finally, the single integer giving the count of grid points with exactly two asymptotically stable equilibria.\n\nFor example, the output should look like \"[e1,e2,e3,e4,e5,n1,n2,n3,n4,n5,n6,Ngrid]\" with the actual numeric values replacing these placeholders.",
            "solution": "The problem asks for an analysis of the imperfect pitchfork bifurcation described by the ordinary differential equation (ODE) $\\frac{dx}{dt} = \\mu x - x^3 + \\epsilon$. This analysis involves deriving the cusp curve for bistability, designing an algorithm to classify steady states, and implementing these to analyze specific parameter values and map the multistable region.\n\nFirst, a critical validation step is required. The problem statement defines the ODE as $\\frac{dx}{dt} = f(x;\\mu,\\epsilon) = \\mu x - x^3 + \\epsilon$. Steady states $x^\\star$ are solutions to $f(x^\\star;\\mu,\\epsilon) = 0$. This leads to the equation $\\mu x - x^3 + \\epsilon = 0$, or, by multiplying by $-1$, $x^3 - \\mu x - \\epsilon = 0$. However, the problem text explicitly gives the steady-state equation as $x^3 - \\mu x + \\epsilon = 0$. This is a direct contradiction in the sign of the $\\epsilon$ term. The stability of a steady state $x^\\star$ is correctly given as being determined by the sign of $f'(x^\\star;\\mu,\\epsilon) = \\mu - 3(x^\\star)^2$, which is the derivative of the function $f(x)$ from the original ODE definition. Because the ODE and the stability criterion are mutually consistent, the most logical course of action is to assume the stated steady-state cubic equation contains a typographical error. Therefore, this solution will proceed using the steady-state equation that is mathematically derived from the provided ODE:\n$$x^3 - \\mu x - \\epsilon = 0$$\nThis correction resolves the inconsistency and allows for a rigorous analysis, as the sign of $\\epsilon$ is a matter of convention for the imperfection parameter and does not alter the fundamental mathematical structure of the bifurcation.\n\n**Part 1: Derivation of the Cusp Curve**\n\nThe boundary of the multistability region, known as the cusp curve in the $(\\mu, \\epsilon)$ parameter space, is defined by the condition where at least two steady states coalesce. For a polynomial equation, this corresponds to having a repeated root.\nThe steady-state equation is the depressed cubic $P(x) = x^3 - \\mu x - \\epsilon = 0$.\nA polynomial has a repeated root at a point $x_0$ if and only if both the polynomial and its derivative are zero at $x_0$. The derivative of $P(x)$ with respect to $x$ is:\n$$P'(x) = 3x^2 - \\mu$$\nFor a repeated root, we must simultaneously solve the system of equations:\n1. $x^3 - \\mu x - \\epsilon = 0$\n2. $3x^2 - \\mu = 0$\n\nFrom equation (2), we find the value of $x$ at which the repeated root occurs:\n$$3x^2 = \\mu \\implies x^2 = \\frac{\\mu}{3}$$\nThis implies that $x = \\pm\\sqrt{\\frac{\\mu}{3}}$. For a real-valued repeated root to exist, we must have $\\mu \\ge 0$. If $\\mu  0$, $P'(x) = 3x^2 - \\mu > 0$ for all real $x$, meaning $P(x)$ is strictly monotonic and can only have one real root. Thus, multistability is only possible for $\\mu \\ge 0$.\n\nSubstituting $x^2 = \\frac{\\mu}{3}$ back into equation (1) allows us to find the relationship between $\\mu$ and $\\epsilon$ that defines the cusp curve. We can rewrite equation (1) as $x(x^2 - \\mu) - \\epsilon = 0$. Now, substituting the expressions for $x$ and $x^2$:\n$$\\left(\\pm\\sqrt{\\frac{\\mu}{3}}\\right) \\left(\\frac{\\mu}{3} - \\mu\\right) - \\epsilon = 0$$\n$$\\left(\\pm\\sqrt{\\frac{\\mu}{3}}\\right) \\left(-\\frac{2\\mu}{3}\\right) - \\epsilon = 0$$\n$$\\mp \\frac{2\\mu}{3}\\sqrt{\\frac{\\mu}{3}} - \\epsilon = 0$$\nSolving for $\\epsilon$, we obtain the explicit analytic expression for the cusp curve:\n$$\\epsilon_{\\text{cusp}}(\\mu) = \\mp \\frac{2\\mu}{3} \\frac{\\sqrt{\\mu}}{\\sqrt{3}} = \\mp \\frac{2\\mu^{3/2}}{3\\sqrt{3}}$$\nThis can be written more cleanly as:\n$$\\epsilon_{\\text{cusp}}^2 = \\frac{4\\mu^3}{27} \\text{ or } 27\\epsilon^2 = 4\\mu^3$$\nThe region of multistability (specifically, bistability with two stable steady states) is the area enclosed by these two branches of the cusp curve, which corresponds to parameter values $(\\mu, \\epsilon)$ satisfying $4\\mu^3 - 27\\epsilon^2 > 0$.\n\n**Part 2: Algorithm for Steady State Classification**\n\nTo determine the number of asymptotically stable equilibria for a given parameter pair $(\\mu, \\epsilon)$, we follow a two-step process: finding the steady states and then assessing their stability.\n\n**Step 2a: Finding Real Steady States**\nFor any given $(\\mu, \\epsilon)$, the steady states are the real roots of the cubic equation $x^3 - \\mu x - \\epsilon = 0$. This is a polynomial equation of the form $c_3 x^3 + c_2 x^2 + c_1 x + c_0 = 0$, with coefficients $c_3=1$, $c_2=0$, $c_1=-\\mu$, and $c_0=-\\epsilon$. We can employ a standard numerical algorithm, such as the companion matrix method, to find all three (possibly complex) roots of this polynomial. After obtaining the roots, we filter them to retain only the real-valued ones. A root $z = a + bi$ is considered real if its imaginary part $b$ is negligibly small (e.g., $|b|  10^{-9}$).\n\n**Step 2b: Classifying Stability**\nAn equilibrium point $x^\\star$ is asymptotically stable if linear analysis shows that small perturbations decay over time. This is determined by the sign of the derivative of the right-hand side of the ODE, $f'(x) = \\frac{d}{dx}(\\mu x - x^3 + \\epsilon)$, evaluated at the equilibrium point $x^\\star$.\nThe derivative is:\n$$f'(x) = \\mu - 3x^2$$\nFor each real root $x^\\star$ found in the previous step, we calculate $f'(x^\\star)$.\n- If $f'(x^\\star)  0$, the equilibrium is asymptotically stable.\n- If $f'(x^\\star) > 0$, the equilibrium is unstable.\n- If $f'(x^\\star) = 0$, the equilibrium is non-hyperbolic (marginally stable), and is not considered asymptotically stable as per the problem's criteria. This case occurs precisely on the cusp boundary.\n\n**Step 2c: Counting Stable Equilibria**\nThe final step is to count how many of the real roots satisfy the condition for asymptotic stability, $f'(x^\\star)  0$. This count, which can be $0$, $1$, or $2$, is the desired output for the stability classification task.\n\n**Part 3: Multistability Mapping**\n\nThe algorithm from Part 2 can be applied across a grid of $(\\mu, \\epsilon)$ parameter values to map out the system's behavior. The problem asks to identify the region of bistability, defined as having exactly two asymptotically stable equilibria. The procedure is as follows:\n1. Define a rectangular grid of points in the $(\\mu, \\epsilon)$ plane by specifying the range and number of sampling points for each parameter.\n2. Initialize a counter for bistable points to zero.\n3. Iterate through each point $(\\mu_i, \\epsilon_j)$ on the grid.\n4. For each point, execute the algorithm from Part 2 to compute the number of asymptotically stable equilibria.\n5. If the count of stable equilibria is exactly $2$, increment the counter.\n6. The final value of the counter represents the number of grid points within the bistable region.\n\nThis systematic application of the steady-state classification algorithm provides a discrete map of the system's phase portrait as a function of its governing parameters.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the imperfect pitchfork bifurcation problem.\n    1. Computes cusp curve values.\n    2. Classifies stability for specific (mu, epsilon) pairs.\n    3. Maps the multistable region on a parameter grid.\n    \"\"\"\n\n    # Helper function to calculate the positive branch of the cusp curve\n    def get_cusp_epsilon(mu):\n        \"\"\"Calculates epsilon on the positive cusp branch for a given mu >= 0.\"\"\"\n        if mu  0:\n            return 0.0\n        # This is equivalent to (2 * mu**(3/2)) / (3 * np.sqrt(3))\n        return np.sqrt(4 * mu**3 / 27)\n\n    # Helper function to classify and count stable equilibria\n    def count_stable_equilibria(mu, epsilon):\n        \"\"\"\n        Finds all real steady states for a given (mu, epsilon) pair\n        and counts the number of asymptotically stable ones.\n        \"\"\"\n        # Steady state equation: x^3 - mu*x - epsilon = 0\n        # Coefficients of the polynomial x^3 + 0*x^2 - mu*x - epsilon\n        coeffs = [1, 0, -mu, -epsilon]\n        \n        # Find all complex roots\n        roots = np.roots(coeffs)\n        \n        # Filter for real roots (imaginary part is close to zero)\n        real_roots = roots[np.isclose(roots.imag, 0)].real\n        \n        stable_count = 0\n        # Check stability for each real root\n        for x_star in real_roots:\n            # Stability criterion: f'(x*) = mu - 3*(x*)^2  0\n            f_prime = mu - 3 * x_star**2\n            # Per problem, f'(x*) = 0 is not asymptotically stable\n            if f_prime  0:\n                stable_count += 1\n        \n        return stable_count\n\n    # --- Test Suite Execution ---\n    \n    results = []\n\n    # 1. Cusp curve evaluations\n    cusp_mus_pos = [0.0, 0.25, 1.0, 2.0]\n    for mu in cusp_mus_pos:\n        epsilon_val = get_cusp_epsilon(mu)\n        results.append(f\"{epsilon_val:.6f}\")\n\n    # Negative branch at mu = 1.0\n    epsilon_neg_val = -get_cusp_epsilon(1.0)\n    results.append(f\"{epsilon_neg_val:.6f}\")\n\n    # 2. Stability classification for specified pairs\n    class_pairs = [\n        (1.0, 0.0),\n        (1.0, get_cusp_epsilon(1.0)),\n        (1.0, 0.1),\n        (1.0, 0.5),\n        (0.0, 0.1),\n        (1.0, -0.1),\n    ]\n    for mu, epsilon in class_pairs:\n        count = count_stable_equilibria(mu, epsilon)\n        results.append(str(count))\n\n    # 3. Multistability mapping\n    mu_grid = np.linspace(0.0, 2.0, 41)\n    epsilon_grid = np.linspace(-0.6, 0.6, 61)\n    \n    bistable_points_count = 0\n    for mu in mu_grid:\n        for epsilon in epsilon_grid:\n            # Check for exactly two asymptotically stable equilibria\n            if count_stable_equilibria(mu, epsilon) == 2:\n                bistable_points_count += 1\n    \n    results.append(str(bistable_points_count))\n\n    # --- Final Output Formatting ---\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}