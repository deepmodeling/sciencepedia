{
    "hands_on_practices": [
        {
            "introduction": "掌握任何分岔理论的第一步都是对其标准型进行基础分析。本练习将引导你分析超临界叉式分岔的典型模型（$x'=\\mu x - x^3$），通过计算其平衡点并评估其线性稳定性。这个基础练习  旨在巩固你识别系统稳态和运用雅可比矩阵判断其稳定性的核心技能，为后续更复杂的场景分析奠定坚实的基础。",
            "id": "3919636",
            "problem": "考虑一个均匀组织中双稳态细胞命运决定的最小对称性破缺模型，其中标量状态变量 $x$ 代表谱系特异性转录因子活性相对于对称点的一个无量纲、有符号的偏差。在对称点附近，描述在控制参数 $\\mu$（与一个无量纲形态发生素驱动成正比）作用下双稳态出现的最低阶范式为以下一维常微分方程(ODE)：\n$$\n\\frac{dx}{dt} = f(x) = \\mu x - x^{3},\n$$\n其中 $\\mu$ 为实数。该模型在生物医学系统建模中被广泛用于表示由对称基因调控相互作用产生的超临界叉式分岔的局部范式。\n\n假设 $\\mu  0$。请仅使用一维动力学系统中关于平衡点和线性稳定性的基本定义，从第一性原理出发：\n- 确定平衡点 $x^{\\ast}$，\n- 计算在每个平衡点处的雅可比导数（即 $f$ 对 $x$ 的导数），以及\n- 根据雅可比导数的符号推断每个平衡点的线性稳定性。\n\n将您的最终答案表示为一个单行矩阵，其中包含按 $x^{\\ast} = 0$, $x^{\\ast} = +\\sqrt{\\mu}$, $x^{\\ast} = -\\sqrt{\\mu}$ 顺序排列的平衡点上的雅可比导数 $f'(x^{\\ast})$ 的值。无需数值近似；请提供精确的符号表达式。最终答案中不要包含任何单位。",
            "solution": "该问题要求在参数 $\\mu  0$ 的条件下，对由一维常微分方程(ODE) $\\frac{dx}{dt} = f(x) = \\mu x - x^{3}$ 给出的系统的平衡点进行辨识和线性稳定性分析。\n\n首先，我们确定平衡点，记为 $x^{\\ast}$。根据定义，动力学系统的平衡点是系统变量不随时间变化的状态。对于给定的ODE，这对应于条件 $\\frac{dx}{dt} = 0$。因此，我们必须找到方程 $f(x^{\\ast}) = 0$ 的根。\n$$\n\\mu x^{\\ast} - (x^{\\ast})^{3} = 0\n$$\n为求解 $x^{\\ast}$，我们可以对左侧表达式进行因式分解：\n$$\nx^{\\ast}(\\mu - (x^{\\ast})^{2}) = 0\n$$\n鉴于问题中 $\\mu  0$ 的约束条件，该方程提供了三个不同的实数解。\n1. 通过将第一个因子设为零，可找到平凡平衡点：$x^{\\ast}_1 = 0$。\n2. 通过将第二个因子设为零，可找到非平凡平衡点：$\\mu - (x^{\\ast})^{2} = 0$。这意味着 $(x^{\\ast})^{2} = \\mu$。由于问题指定 $\\mu  0$，我们可以取平方根得到两个不同的实数根：$x^{\\ast}_2 = +\\sqrt{\\mu}$ 和 $x^{\\ast}_3 = -\\sqrt{\\mu}$。\n\n因此，系统的三个平衡点是 $x^{\\ast} = 0$、$x^{\\ast} = +\\sqrt{\\mu}$ 和 $x^{\\ast} = -\\sqrt{\\mu}$。\n\n接下来，我们对每个平衡点进行线性稳定性分析。在一维系统中，平衡点 $x^{\\ast}$ 的稳定性由在该点计算的雅可比导数的符号决定。对于函数 $f(x)$，其雅可比导数是它的一阶导数 $f'(x) = \\frac{df}{dx}$。稳定性判据如下：\n- 若 $f'(x^{\\ast})  0$，则平衡点是线性稳定的。对平衡点的微小扰动将随时间衰减。\n- 若 $f'(x^{\\ast})  0$，则平衡点是线性不稳定的。微小扰动将随时间增长，导致系统远离该平衡点。\n- 若 $f'(x^{\\ast}) = 0$，则平衡点称为非双曲的，其稳定性无法仅通过线性分析确定。\n\n我们首先通过对 $f(x) = \\mu x - x^{3}$ 关于 $x$ 求导来计算雅可比导数的一般表达式：\n$$\nf'(x) = \\frac{d}{dx}(\\mu x - x^{3}) = \\mu - 3x^{2}\n$$\n现在，我们在已确定的三个平衡点处计算该雅可比导数的值。\n\n情况1：平衡点 $x^{\\ast} = 0$。\n雅可比导数的值为：\n$$\nf'(0) = \\mu - 3(0)^{2} = \\mu\n$$\n在 $\\mu  0$ 的条件下，雅可比导数 $f'(0)$ 为正。这表明 $x^{\\ast} = 0$ 处的平衡点是线性不稳定的。\n\n情况2：平衡点 $x^{\\ast} = +\\sqrt{\\mu}$。\n雅可比导数的值为：\n$$\nf'(+\\sqrt{\\mu}) = \\mu - 3(+\\sqrt{\\mu})^{2} = \\mu - 3\\mu = -2\\mu\n$$\n由于 $\\mu  0$，项 $-2\\mu$ 为负。因此，$f'(+\\sqrt{\\mu})  0$，这表明 $x^{\\ast} = +\\sqrt{\\mu}$ 处的平衡点是线性稳定的。\n\n情况3：平衡点 $x^{\\ast} = -\\sqrt{\\mu}$。\n雅可比导数的值为：\n$$\nf'(-\\sqrt{\\mu}) = \\mu - 3(-\\sqrt{\\mu})^{2} = \\mu - 3\\mu = -2\\mu\n$$\n与前一种情况一样，由于 $\\mu  0$，雅可比导数 $f'(-\\sqrt{\\mu})$ 为负。这表明 $x^{\\ast} = -\\sqrt{\\mu}$ 处的平衡点也是线性稳定的。\n\n问题要求最终答案为一个单行矩阵，其中包含按 $x^{\\ast} = 0$、$x^{\\ast} = +\\sqrt{\\mu}$ 和 $x^{\\ast} = -\\sqrt{\\mu}$ 顺序排列的平衡点处计算的雅可比导数 $f'(x^{\\ast})$ 的值。这些值分别为 $\\mu$、$-2\\mu$ 和 $-2\\mu$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\mu  -2\\mu  -2\\mu \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在生物系统中，确定性模型只是理想化的描述，分子噪声是不可避免的。本练习在前一个确定性模型的基础上引入了随机性，要求你将系统动力学与势景观联系起来。通过使用克莱默理论（Kramers’ theory）计算平均首通时间 ，你将亲身体会噪声如何诱导系统在不同稳态之间转换，这是理解基因开关等生物现象稳定性的关键一步。",
            "id": "3919650",
            "problem": "在一个具有正反馈的双稳态基因调控回路中，对于一个无量纲的基因表达水平 $x(t)$，其在超临界叉式分岔附近的确定性动力学可由常微分方程 $x'=\\mu x - x^{3}$ 建模。其中 $\\mu$ 是一个无量纲的分岔参数，与净反馈强度成正比。分子拷贝数的涨落引入了随机性，从而产生过阻尼朗之万动力学\n$$\nx'=\\mu x - x^{3} + \\sqrt{2D}\\,\\xi(t),\n$$\n其中 $\\xi(t)$ 是高斯白噪声，满足 $\\langle \\xi(t) \\rangle = 0$ 和 $\\langle \\xi(t)\\xi(s)\\rangle=\\delta(t-s)$, 且 $D0$ 是一个无量纲的有效噪声强度，由底层反应网络中的生灭过程决定。假设 $\\mu0$，因此确定性系统有两个由一个不稳定态隔开的稳定基因表达态。\n\n从一个过阻尼一维随机微分方程（SDE）的基本梯度流表示 $x'=-U'(x)+\\sqrt{2D}\\,\\xi(t)$ 出发，其中 $U(x)$ 是一个标量势，推导与漂移项 $\\mu x - x^{3}$ 相关联的有效势 $U(x)$。找出当 $\\mu0$ 时的稳定阱和势垒（鞍点），并确定稳定阱与势垒之间的高度差。使用经典的克莱默斯近似来计算在过阻尼情形下越过势垒的逃逸问题，计算从右阱（$x\\approx +\\sqrt{\\mu}$ 附近）到左阱（$x\\approx -\\sqrt{\\mu}$ 附近）跃迁的平均首达时间（MFPT）。将最终的 MFPT 表示为以 $\\mu$ 和 $D$ 为变量的闭式解析表达式，使用无量纲单位。无需进行数值计算。",
            "solution": "用户提供了一个有效的问题陈述。\n\n问题要求计算在双阱势中一个粒子的平均首达时间（MFPT），该过程由一个一维过阻尼朗之万方程描述。求解过程需要推导势函数，确定其特征，并应用克莱默斯理论计算逃逸速率。\n\n随机微分方程（SDE）如下所示：\n$$\nx' = \\mu x - x^{3} + \\sqrt{2D}\\,\\xi(t)\n$$\n其中 $x(t)$ 是状态变量，$\\mu  0$ 是分岔参数，$D  0$ 是噪声强度，$\\xi(t)$ 是高斯白噪声。\n\n在势 $U(x)$ 中的过阻尼朗之万方程的一般形式为：\n$$\nx' = -U'(x) + \\sqrt{2D}\\,\\xi(t)\n$$\n其中 $U'(x)$ 是势函数对 $x$ 的导数。\n\n**步骤 1：推导有效势 $U(x)$**\n将给定 SDE 的漂移项与一般形式进行比较，我们可以确定 $-U'(x)$：\n$$\n-U'(x) = \\mu x - x^3\n$$\n因此，力为 $F(x) = \\mu x - x^3$。通过对 $-F(x)$ 积分来求得势函数：\n$$\nU'(x) = -(\\mu x - x^3) = x^3 - \\mu x\n$$\n将 $U'(x)$ 对 $x$ 积分得到势函数 $U(x)$：\n$$\nU(x) = \\int (x^3 - \\mu x) \\,dx = \\frac{x^4}{4} - \\frac{\\mu x^2}{2} + C\n$$\n积分常数 $C$ 只是将势能景观在垂直方向上平移，不影响动力学或势垒的高度。不失一般性，我们可以设 $C=0$。因此，有效势为：\n$$\nU(x) = \\frac{x^4}{4} - \\frac{\\mu x^2}{2}\n$$\n\n**步骤 2：定位稳定阱和势垒**\n势函数 $U(x)$ 的极值点对应于确定性系统（$D=0$）的固定点，可通过令 $U'(x) = 0$ 求得：\n$$\nU'(x) = x^3 - \\mu x = x(x^2 - \\mu) = 0\n$$\n由于 $\\mu  0$，方程的根为 $x_0 = 0$ 和 $x_s = \\pm\\sqrt{\\mu}$。\n\n为确定这些固定点的稳定性，我们考察势函数的二阶导数 $U''(x)$：\n$$\nU''(x) = \\frac{d}{dx}(x^3 - \\mu x) = 3x^2 - \\mu\n$$\n如果 $U''(x^*)  0$，点 $x^*$ 是一个稳定极小值点（阱）；如果 $U''(x^*)  0$，则是一个不稳定极大值点（势垒）。\n- 在 $x_0 = 0$ 处：$U''(0) = 3(0)^2 - \\mu = -\\mu$。由于 $\\mu  0$，所以 $U''(0)  0$。该点是一个局部极大值点，代表两个阱之间的势垒。\n- 在 $x_s = \\pm\\sqrt{\\mu}$ 处：$U''(\\pm\\sqrt{\\mu}) = 3(\\pm\\sqrt{\\mu})^2 - \\mu = 3\\mu - \\mu = 2\\mu$。由于 $\\mu  0$，所以 $U''(\\pm\\sqrt{\\mu})  0$。这两点是局部极小值点，代表势的稳定阱。\n\n所以，系统在 $x = \\pm\\sqrt{\\mu}$ 处有稳定阱，在 $x=0$ 处有势垒。问题要求计算从右阱（$x \\approx +\\sqrt{\\mu}$ 附近）到左阱（$x \\approx -\\sqrt{\\mu}$ 附近）的跃迁。\n\n**步骤 3：确定势垒高度**\n势垒高度 $\\Delta U$ 是势垒顶部和稳定阱底部的势能差。我们计算从右阱出发的跃迁的势垒高度。\n- 势垒顶部的势能（$x_b = 0$）：$U(0) = \\frac{0^4}{4} - \\frac{\\mu(0)^2}{2} = 0$。\n- 右阱底部的势能（$x_w = +\\sqrt{\\mu}$）：$U(\\sqrt{\\mu}) = \\frac{(\\sqrt{\\mu})^4}{4} - \\frac{\\mu(\\sqrt{\\mu})^2}{2} = \\frac{\\mu^2}{4} - \\frac{\\mu^2}{2} = -\\frac{\\mu^2}{4}$。\n\n势垒高度为：\n$$\n\\Delta U = U(x_b) - U(x_w) = U(0) - U(\\sqrt{\\mu}) = 0 - \\left(-\\frac{\\mu^2}{4}\\right) = \\frac{\\mu^2}{4}\n$$\n\n**步骤 4：使用克莱默斯近似计算平均首达时间（MFPT）**\n克莱默斯理论为从一个势阱越过势垒的平均逃逸时间提供了一个近似，该近似在低噪声极限（$D \\ll \\Delta U$）下有效。对于一个一维过阻尼系统，从位于 $x_w$ 的阱越过位于 $x_b$ 的势垒的平均首达时间 $\\tau$ 由以下公式给出：\n$$\n\\tau \\approx \\frac{2\\pi}{\\sqrt{U''(x_w) |U''(x_b)|}} \\exp\\left(\\frac{\\Delta U}{D}\\right)\n$$\n我们已经计算了所有必要的组成部分：\n- 右阱的位置：$x_w = \\sqrt{\\mu}$\n- 势垒的位置：$x_b = 0$\n- 阱处的二阶导数：$U''(x_w) = U''(\\sqrt{\\mu}) = 2\\mu$\n- 势垒处的二阶导数：$U''(x_b) = U''(0) = -\\mu$，所以 $|U''(x_b)|= \\mu$。\n- 势垒高度：$\\Delta U = \\frac{\\mu^2}{4}$\n\n将这些值代入克莱默斯公式：\n$$\n\\tau \\approx \\frac{2\\pi}{\\sqrt{(2\\mu)(\\mu)}} \\exp\\left(\\frac{\\mu^2/4}{D}\\right)\n$$\n$$\n\\tau = \\frac{2\\pi}{\\sqrt{2\\mu^2}} \\exp\\left(\\frac{\\mu^2}{4D}\\right)\n$$\n$$\n\\tau = \\frac{2\\pi}{\\mu\\sqrt{2}} \\exp\\left(\\frac{\\mu^2}{4D}\\right)\n$$\n$$\n\\tau = \\frac{\\pi\\sqrt{2}}{\\mu} \\exp\\left(\\frac{\\mu^2}{4D}\\right)\n$$\n该表达式代表逃离右阱的平均时间。在这个对称的双阱系统中，从一个阱的逃逸时间是对到达另一个阱的平均首达时间的一个极好近似，因为从势垒顶部到对侧阱底部的渡越时间与为越过势垒而激活的等待时间相比可以忽略不计。",
            "answer": "$$\n\\boxed{\\frac{\\pi\\sqrt{2}}{\\mu}\\exp\\left(\\frac{\\mu^2}{4D}\\right)}\n$$"
        },
        {
            "introduction": "完美的对称性在自然界和工程生物系统中都极为罕见。本练习将带你从理想的叉式分岔模型走向更贴近现实的“不完美”分岔，其中一个微小的不对称项 $\\epsilon$ 会极大地改变系统行为。这个练习  融合了解析推导与计算实践，你将首先推导出多稳态区域的边界（尖点曲线），然后通过编程来系统地探索参数空间，这是设计和分析合成生物回路的一项强大技能。",
            "id": "3926829",
            "problem": "考虑在合成基因调控回路的对称性破缺双稳态模型中遇到的叉式分岔的不完美展开。该确定性一维常微分方程 (ODE) 的范式由下式给出：$$\\frac{dx}{dt} = f(x;\\mu,\\epsilon) = \\mu x - x^3 + \\epsilon,$$ 其中 $x$ 是一个无量纲状态变量（例如，一个归一化的基因表达水平），$\\mu$ 是一个代表有效正反馈强度的无量纲控制参数，$\\epsilon$ 是一个代表调控中对称性破缺偏置的无量纲不完美参数。\n\n该常微分方程的稳态由下式实根给出：$$f(x;\\mu,\\epsilon) = 0,$$ 也就是方程 $$x^3 - \\mu x - \\epsilon = 0$$ 的解。在 $(\\mu,\\epsilon)$ 参数空间中，多稳态的边界（尖点曲线）由至少两个稳态重合的条件定义，这等价于该三次方程有一个重实根。与设计相关的多稳态区域对应于系统具有多个渐近稳定稳态的参数值，其中一个稳态 $x^\\star$ 在以下条件成立时是渐近稳定的：$$f'(x^\\star;\\mu,\\epsilon) = \\mu - 3(x^\\star)^2  0.$$\n\n任务：\n1. 从常微分方程和平衡条件出发，利用多项式理论中成熟的结论，为此不完美展开推导 $(\\mu,\\epsilon)$ 空间中尖点曲线的显式解析表达式。\n2. 设计一个数值算法，对于任意给定的 $(\\mu,\\epsilon)$，找出该三次方程的所有实数稳态，利用 $f'(x^\\star;\\mu,\\epsilon)$ 的符号对其线性稳定性进行分类，并计算渐近稳定平衡点的数量。\n3. 在一个完整的、可运行的程序中实现解析尖点计算和数值分类，该程序：\n   - 为指定的 $\\mu$ 值计算尖点曲线上的值。\n   - 为指定的 $(\\mu,\\epsilon)$ 对分类渐近稳定平衡点的数量。\n   - 通过计算具有恰好两个渐近稳定平衡点的网格点数，在 $(\\mu,\\epsilon)$ 空间的粗网格上映射多稳态区域。\n4. 严格使用不带物理单位的数学量。不涉及角度量。\n\n测试套件：\n- 在 $\\mu \\in \\{0.0, 0.25, 1.0, 2.0\\}$ 处对正分支以及在 $\\mu \\in \\{1.0\\}$ 处对负分支进行尖点曲线求值。报告每个 $\\epsilon$ 的尖点值，四舍五入到六位小数。\n- 对以下 $(\\mu,\\epsilon)$ 对进行稳定性分类（渐近稳定平衡点的数量）：\n  - $(1.0, 0.0)$,\n  - $(1.0, \\epsilon_{\\text{cusp}}(1.0))$ 在正分支的尖点边界上,\n  - $(1.0, 0.1)$,\n  - $(1.0, 0.5)$,\n  - $(0.0, 0.1)$,\n  - $(1.0, -0.1)$.\n  在每种情况下，仅计算满足 $f'(x^\\star;\\mu,\\epsilon)  0$ 的平衡点；将满足 $f'(x^\\star;\\mu,\\epsilon) = 0$ 的平衡点视为非渐近稳定的。\n- 在矩形网格上进行多稳态映射：$\\mu$ 在 $[0,2]$ 上均匀采样 $41$ 个点，$\\epsilon$ 在 $[-0.6,0.6]$ 上均匀采样 $61$ 个点。报告表现出恰好两个渐近稳定平衡点的网格点的整数数量。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。顺序必须是：\n- 首先，是针对 $\\mu = 0.0, 0.25, 1.0, 2.0$ 的四个正分支 $\\epsilon$ 尖点值（每个都四舍五入到六位小数），\n- 然后，是针对 $\\mu = 1.0$ 的单个负分支 $\\epsilon$ 尖点值（四舍五入到六位小数），\n- 接着，是六个整数，表示按上述顺序列出的指定 $(\\mu,\\epsilon)$ 对的渐近稳定平衡点数量，\n- 最后，是单个整数，表示具有恰好两个渐近稳定平衡点的网格点计数。\n\n例如，输出应类似于“[e1,e2,e3,e4,e5,n1,n2,n3,n4,n5,n6,Ngrid]”，其中实际数值将替换这些占位符。",
            "solution": "问题要求对由常微分方程 (ODE) $\\frac{dx}{dt} = \\mu x - x^3 + \\epsilon$ 描述的不完美叉式分岔进行分析。该分析涉及推导双稳态的尖点曲线，设计一个算法来分类稳态，并实现这些算法来分析特定的参数值和映射多稳态区域。\n\n**第1部分：尖点曲线的推导**\n\n多稳态区域的边界，在 $(\\mu, \\epsilon)$ 参数空间中被称为尖点曲线，其定义条件是至少有两个稳态重合。对于一个多项式方程，这对应于存在一个重根。\n稳态方程是折合三次方程 $P(x) = x^3 - \\mu x - \\epsilon = 0$。\n一个多项式在点 $x_0$ 处有重根的充要条件是，该多项式及其导数在 $x_0$ 处都为零。$P(x)$ 关于 $x$ 的导数是：\n$$P'(x) = 3x^2 - \\mu$$\n为了得到重根，我们必须联立求解以下方程组：\n1. $x^3 - \\mu x - \\epsilon = 0$\n2. $3x^2 - \\mu = 0$\n\n从方程 (2) 中，我们找到重根出现的 $x$ 值：\n$$3x^2 = \\mu \\implies x^2 = \\frac{\\mu}{3}$$\n这意味着 $x = \\pm\\sqrt{\\frac{\\mu}{3}}$。为了存在实数重根，我们必须有 $\\mu \\ge 0$。如果 $\\mu  0$，那么对于所有实数 $x$，$P'(x) = 3x^2 - \\mu > 0$，这意味着 $P(x)$ 是严格单调的，只能有一个实根。因此，多稳态只可能在 $\\mu \\ge 0$ 时出现。\n\n将 $x^2 = \\frac{\\mu}{3}$ 代回方程 (1) 使我们能够找到定义尖点曲线的 $\\mu$ 和 $\\epsilon$ 之间的关系。我们可以将方程 (1) 重写为 $x(x^2 - \\mu) - \\epsilon = 0$。现在，代入 $x$ 和 $x^2$ 的表达式：\n$$\\left(\\pm\\sqrt{\\frac{\\mu}{3}}\\right) \\left(\\frac{\\mu}{3} - \\mu\\right) - \\epsilon = 0$$\n$$\\left(\\pm\\sqrt{\\frac{\\mu}{3}}\\right) \\left(-\\frac{2\\mu}{3}\\right) - \\epsilon = 0$$\n$$\\mp \\frac{2\\mu}{3}\\sqrt{\\frac{\\mu}{3}} - \\epsilon = 0$$\n解出 $\\epsilon$，我们得到尖点曲线的显式解析表达式：\n$$\\epsilon_{\\text{cusp}}(\\mu) = \\mp \\frac{2\\mu}{3} \\frac{\\sqrt{\\mu}}{\\sqrt{3}} = \\mp \\frac{2\\mu^{3/2}}{3\\sqrt{3}}$$\n这可以更清晰地写为：\n$$\\epsilon_{\\text{cusp}}(\\mu) = \\pm \\frac{2\\sqrt{3}}{9}\\mu^{3/2}$$\n多稳态区域（特别是具有两个稳定稳态的双稳态）是由尖点曲线的这两个分支所包围的区域，它对应于满足 $4\\mu^3 - 27\\epsilon^2 > 0$ 的参数值 $(\\mu, \\epsilon)$。\n\n**第2部分：稳态分类算法**\n\n为了确定给定参数对 $(\\mu, \\epsilon)$ 的渐近稳定平衡点数量，我们遵循一个两步过程：找到稳态，然后评估其稳定性。\n\n**步骤2a：寻找实数稳态**\n对于任意给定的 $(\\mu, \\epsilon)$，稳态是三次方程 $x^3 - \\mu x - \\epsilon = 0$ 的实根。这是一个形式为 $c_3 x^3 + c_2 x^2 + c_1 x + c_0 = 0$ 的多项式方程，其系数为 $c_3=1$, $c_2=0$, $c_1=-\\mu$, $c_0=-\\epsilon$。我们可以采用标准的数值算法，例如友矩阵法，来找到这个多项式的所有三个（可能是复数的）根。获得根之后，我们对其进行筛选，只保留实数值的根。如果一个根 $z = a + bi$ 的虚部 $b$ 小到可以忽略不计（例如， $|b|  10^{-9}$），则认为该根是实数。\n\n**步骤2b：稳定性分类**\n如果线性分析表明小扰动会随时间衰减，则平衡点 $x^\\star$ 是渐近稳定的。这由 ODE 右侧导数 $f'(x) = \\frac{d}{dx}(\\mu x - x^3 + \\epsilon)$ 在平衡点 $x^\\star$ 处的值的符号决定。\n导数为：\n$$f'(x) = \\mu - 3x^2$$\n对于上一步中找到的每个实根 $x^\\star$，我们计算 $f'(x^\\star)$。\n- 如果 $f'(x^\\star)  0$，则该平衡点是渐近稳定的。\n- 如果 $f'(x^\\star) > 0$，则该平衡点是不稳定的。\n- 如果 $f'(x^\\star) = 0$，则该平衡点是非双曲的（临界稳定），根据问题的标准，不被视为渐近稳定。这种情况恰好发生在尖点边界上。\n\n**步骤2c：计数稳定平衡点**\n最后一步是计算有多少个实根满足渐近稳定条件 $f'(x^\\star)  0$。这个计数（可以是 $0$、$1$ 或 $2$）是稳定性分类任务所需的输出。\n\n**第3部分：多稳态映射**\n\n第2部分的算法可以应用于 $(\\mu, \\epsilon)$ 参数值网格，以绘制出系统的行为。问题要求识别双稳态区域，该区域定义为具有恰好两个渐近稳定平衡点。步骤如下：\n1. 通过为每个参数指定范围和采样点数，在 $(\\mu, \\epsilon)$ 平面中定义一个矩形网格点。\n2. 将双稳态点的计数器初始化为零。\n3. 遍历网格上的每个点 $(\\mu_i, \\epsilon_j)$。\n4. 对每个点，执行第2部分的算法来计算渐近稳定平衡点的数量。\n5. 如果稳定平衡点的计数恰好为 $2$，则将计数器加一。\n6. 计数器的最终值表示双稳态区域内的网格点数量。\n\n这种对稳态分类算法的系统性应用，提供了一个系统相图作为其控制参数函数的离散映射。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the imperfect pitchfork bifurcation problem.\n    1. Computes cusp curve values.\n    2. Classifies stability for specific (mu, epsilon) pairs.\n    3. Maps the multistable region on a parameter grid.\n    \"\"\"\n\n    # Helper function to calculate the positive branch of the cusp curve\n    def get_cusp_epsilon(mu):\n        \"\"\"Calculates epsilon on the positive cusp branch for a given mu = 0.\"\"\"\n        if mu  0:\n            return 0.0\n        return (2 * np.sqrt(3) / 9) * (mu**1.5)\n\n    # Helper function to classify and count stable equilibria\n    def count_stable_equilibria(mu, epsilon):\n        \"\"\"\n        Finds all real steady states for a given (mu, epsilon) pair\n        and counts the number of asymptotically stable ones.\n        \"\"\"\n        # Steady state equation: x^3 - mu*x - epsilon = 0\n        # Coefficients of the polynomial x^3 + 0*x^2 - mu*x - epsilon\n        coeffs = [1, 0, -mu, -epsilon]\n        \n        # Find all complex roots\n        roots = np.roots(coeffs)\n        \n        # Filter for real roots (imaginary part is close to zero)\n        real_roots = roots[np.isclose(roots.imag, 0)].real\n        \n        stable_count = 0\n        # Check stability for each real root\n        for x_star in real_roots:\n            # Stability criterion: f'(x*) = mu - 3*(x*)^2  0\n            f_prime = mu - 3 * x_star**2\n            # Per problem, f'(x*) = 0 is not asymptotically stable\n            if f_prime  0:\n                stable_count += 1\n        \n        return stable_count\n\n    # --- Test Suite Execution ---\n    \n    results = []\n\n    # 1. Cusp curve evaluations\n    cusp_mus_pos = [0.0, 0.25, 1.0, 2.0]\n    for mu in cusp_mus_pos:\n        epsilon_val = get_cusp_epsilon(mu)\n        results.append(f\"{epsilon_val:.6f}\")\n\n    # Negative branch at mu = 1.0\n    epsilon_neg_val = -get_cusp_epsilon(1.0)\n    results.append(f\"{epsilon_neg_val:.6f}\")\n\n    # 2. Stability classification for specified pairs\n    class_pairs = [\n        (1.0, 0.0),\n        (1.0, get_cusp_epsilon(1.0)),\n        (1.0, 0.1),\n        (1.0, 0.5),\n        (0.0, 0.1),\n        (1.0, -0.1),\n    ]\n    for mu, epsilon in class_pairs:\n        count = count_stable_equilibria(mu, epsilon)\n        results.append(str(count))\n\n    # 3. Multistability mapping\n    mu_grid = np.linspace(0.0, 2.0, 41)\n    epsilon_grid = np.linspace(-0.6, 0.6, 61)\n    \n    bistable_points_count = 0\n    for mu in mu_grid:\n        for epsilon in epsilon_grid:\n            # Check for exactly two asymptotically stable equilibria\n            if count_stable_equilibria(mu, epsilon) == 2:\n                bistable_points_count += 1\n    \n    results.append(str(bistable_points_count))\n\n    # --- Final Output Formatting ---\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}