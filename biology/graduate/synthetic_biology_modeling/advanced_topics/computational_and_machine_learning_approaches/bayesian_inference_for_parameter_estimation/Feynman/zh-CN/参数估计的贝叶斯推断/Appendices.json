{
    "hands_on_practices": [
        {
            "introduction": "在合成生物学中，精确量化蛋白质降解率等动力学参数至关重要。本练习将指导您完成一个典型的工作流程：利用贝叶斯推断，从带有测量噪声的时间序列荧光数据中估计降解率。通过这个实践 ，您将掌握如何将物理模型（一级降解）和统计模型（高斯似然）相结合，并通过共轭先验（高斯先验）解析地推导出后验分布。",
            "id": "3907511",
            "problem": "一个合成基因电路在一个可诱导启动子的控制下表达一种荧光报告蛋白。在时间 $t=0$ 时，诱导剂被移除，停止了蛋白质的生产，因此蛋白质丰度 $X(t)$ 以一级动力学方式衰减，降解速率为 $\\delta$。假设标准的质量作用衰减定律 $dX/dt=-\\delta X$ 成立，并且测得的荧光强度 $F(t)$ 与 $X(t)$ 成正比，比例常数固定。测量噪声在强度上是乘性的，因此在对数上是加性的，所以 $y_i=\\ln F(t_i)$ 满足 $y_i=\\mu-\\delta t_i+\\epsilon_i$，其中 $\\mu=\\ln(\\kappa X_0)$ 吸收了比例常数 $\\kappa$ 和初始丰度 $X_0$，而 $\\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 是独立同分布的。在 $t=0$ 时进行的高信噪比基线测量提供了 $F_0$，因此 $\\mu=\\ln F_0$ 可被视为已知。给定一个单细胞延时摄影轨迹，其时间点为 $t_i \\in \\{5,10,15,20,25,30\\}$ 分钟，记录的强度为\n$F_i \\in \\{10^{4}\\exp(-0.05 \\times 5),\\,10^{4}\\exp(-0.05 \\times 10),\\,10^{4}\\exp(-0.05 \\times 15),\\,10^{4}\\exp(-0.05 \\times 20),\\,10^{4}\\exp(-0.05 \\times 25),\\,10^{4}\\exp(-0.05 \\times 30)\\}$（任意单位，a.u.），且 $F_0=10^{4}$ a.u.。已知对数空间的噪声标准差为 $\\sigma=0.05$。对降解速率 $\\delta$ 设置一个高斯先验 $\\delta \\sim \\mathcal{N}(m_0,s_0^2)$，其中 $m_0=0.04$，$s_0=0.02$，且 $m_0$ 和 $s_0$ 的单位为 $\\text{min}^{-1}$。\n\n仅以上述定义和定律为出发点，执行以下操作：\n\n- 基于对数转换后的测量值和给定的先验，为 $\\delta$ 构建贝叶斯模型。\n- 推导后验分布 $p(\\delta \\mid \\{(t_i,F_i)\\}_{i=1}^{6})$ 的解析形式。\n- 根据此后验分布，为所提供的数据计算最大后验估计值 $\\hat{\\delta}_{\\text{MAP}}$。\n\n将 $\\hat{\\delta}_{\\text{MAP}}$ 的最终数值答案四舍五入到四位有效数字。最终速率以 $\\text{min}^{-1}$ 表示。",
            "solution": "首先对问题陈述进行验证，以确保其具有科学依据、问题定义良好且客观。\n\n### 步骤1：提取已知条件\n- **微分方程：** 蛋白质丰度 $X(t)$ 根据 $\\frac{dX}{dt}=-\\delta X$ 进行衰减。\n- **测量模型：** 测得的荧光强度 $F(t)$ 与 $X(t)$ 成正比，即 $F(t) = \\kappa X(t)$。\n- **对数线性模型：** 对数转换后的测量值 $y_i = \\ln F(t_i)$ 服从线性模型 $y_i = \\mu - \\delta t_i + \\epsilon_i$，其中 $\\mu = \\ln(\\kappa X_0)$。\n- **噪声模型：** 噪声项 $\\epsilon_i$ 是独立同分布（i.i.d.）的高斯随机变量，$\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n- **已知参数：**\n    - $\\mu$ 被视为已知：$\\mu = \\ln F_0$。\n    - 初始荧光强度：$F_0 = 10^4$ a.u.。\n    - 噪声标准差：$\\sigma = 0.05$。\n- **数据：**\n    - 测量时间：$t_i \\in \\{5, 10, 15, 20, 25, 30\\}$ 分钟，其中 $i=1, \\dots, 6$。\n    - 测量的荧光值：$F_i = 10^4 \\exp(-0.05 t_i)$，对应于相应的 $t_i$。\n- **先验分布：** 对降解速率 $\\delta$ 设置高斯先验：$\\delta \\sim \\mathcal{N}(m_0, s_0^2)$。\n    - 先验均值：$m_0 = 0.04 \\text{ min}^{-1}$。\n    - 先验标准差：$s_0 = 0.02 \\text{ min}^{-1}$。\n- **任务：**\n    1. 为 $\\delta$ 构建贝叶斯模型。\n    2. 推导后验分布 $p(\\delta \\mid \\{(t_i,F_i)\\})$ 的解析形式。\n    3. 计算最大后验（MAP）估计值 $\\hat{\\delta}_{\\text{MAP}}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，采用了标准质量作用动力学来描述一级衰减，并使用了一个通用的对数线性模型来处理带乘性噪声的荧光数据。该问题是适定的；它提供了所有必要的信息（数据、一个完整的概率模型和一个先验），以推导出一个唯一的后验分布，从而得到一个唯一的MAP估计值。在线性高斯模型中对参数使用高斯先验是一个标准的共轭先验设置，确保了后验分布是定义良好的高斯分布。语言客观而精确。数据虽然是从模型本身合成生成且不含噪声，但这并不使问题无效，因为该问题旨在测试在指定模型噪声 $\\sigma$ 的情况下应用贝叶斯框架的能力。该问题是自洽的、一致的且科学上合理的。\n\n### 步骤3：结论与行动\n问题有效。我们开始推导解答。\n\n### 贝叶斯模型构建与后验推导\n目标是求在给定数据 $D = \\{(t_i, y_i)\\}_{i=1}^6$（其中 $y_i = \\ln F_i$）的条件下，降解速率 $\\delta$ 的后验分布。根据贝叶斯定理，后验分布正比于似然与先验的乘积：\n$$p(\\delta \\mid D) \\propto p(D \\mid \\delta) p(\\delta)$$\n\n**1. 似然函数**\n单个对数转换测量的模型是 $y_i = \\mu - \\delta t_i + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着在给定 $\\delta$ 的条件下，$y_i$ 的条件分布是高斯分布：\n$$y_i \\mid \\delta \\sim \\mathcal{N}(\\mu - \\delta t_i, \\sigma^2)$$\n单个数据点的概率密度函数为：\n$$p(y_i \\mid \\delta) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - (\\mu - \\delta t_i))^2}{2\\sigma^2} \\right) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - \\mu + \\delta t_i)^2}{2\\sigma^2} \\right)$$\n由于测量是独立的，整个数据集 $D$ 的似然是各个概率的乘积：\n$$L(\\delta) = p(D \\mid \\delta) = \\prod_{i=1}^N p(y_i \\mid \\delta)$$\n处理对数似然 $\\ln L(\\delta)$ 更为方便。只保留依赖于 $\\delta$ 的项：\n$$\\ln L(\\delta) = \\sum_{i=1}^N \\ln p(y_i \\mid \\delta) = \\text{const} - \\frac{1}{2\\sigma^2} \\sum_{i=1}^N (y_i - \\mu + \\delta t_i)^2$$\n展开二次项，我们看到对数似然是 $\\delta$ 的一个二次函数：\n$$\\ln L(\\delta) = \\text{const} - \\frac{1}{2\\sigma^2} \\left( \\delta^2 \\sum_{i=1}^N t_i^2 + 2\\delta \\sum_{i=1}^N t_i(y_i - \\mu) + \\sum_{i=1}^N (y_i - \\mu)^2 \\right)$$\n这表明似然函数，作为 $\\delta$ 的函数，正比于一个高斯分布。\n\n**2. 先验分布**\n$\\delta$ 的先验分布给定为高斯分布：\n$$p(\\delta) = \\mathcal{N}(\\delta; m_0, s_0^2) = \\frac{1}{\\sqrt{2\\pi s_0^2}} \\exp\\left( -\\frac{(\\delta - m_0)^2}{2s_0^2} \\right)$$\n对数先验为：\n$$\\ln p(\\delta) = \\text{const} - \\frac{(\\delta - m_0)^2}{2s_0^2} = \\text{const} - \\frac{1}{2s_0^2}(\\delta^2 - 2\\delta m_0 + m_0^2)$$\n\n**3. 后验分布**\n对数后验是对数似然和对数先验之和（加上常数）：\n$$\\ln p(\\delta \\mid D) = \\text{const} - \\frac{1}{2} \\left[ \\frac{1}{\\sigma^2}\\left(\\delta^2 \\sum t_i^2 - 2\\delta \\sum t_i(\\mu-y_i)\\right) + \\frac{1}{s_0^2}(\\delta^2 - 2\\delta m_0) \\right]$$\n按 $\\delta$ 的幂次对项进行分组：\n$$\\ln p(\\delta \\mid D) = \\text{const} - \\frac{1}{2} \\left[ \\delta^2 \\left( \\frac{\\sum t_i^2}{\\sigma^2} + \\frac{1}{s_0^2} \\right) - 2\\delta \\left( \\frac{\\sum t_i(\\mu-y_i)}{\\sigma^2} + \\frac{m_0}{s_0^2} \\right) \\right]$$\n这是 $\\delta$ 的一个二次型，这意味着后验分布 $p(\\delta \\mid D)$ 也是一个高斯分布，记为 $\\mathcal{N}(\\delta; m_N, s_N^2)$。对数高斯函数的一般形式为 $\\text{const} - \\frac{(\\delta - m_N)^2}{2s_N^2} = \\text{const} - \\frac{1}{2} \\left( \\frac{\\delta^2}{s_N^2} - \\frac{2\\delta m_N}{s_N^2} \\right)$。\n通过比较 $\\delta^2$ 和 $\\delta$ 的系数，我们得到后验方差 $s_N^2$ 和均值 $m_N$。\n后验方差的倒数（后验精度）为：\n$$\\frac{1}{s_N^2} = \\frac{\\sum_{i=1}^N t_i^2}{\\sigma^2} + \\frac{1}{s_0^2}$$\n后验均值为：\n$$m_N = s_N^2 \\left( \\frac{\\sum_{i=1}^N t_i(\\mu-y_i)}{\\sigma^2} + \\frac{m_0}{s_0^2} \\right)$$\n因此，后验分布的解析形式是一个高斯分布：\n$$p(\\delta \\mid D) = \\mathcal{N}\\left(\\delta; m_N, s_N^2\\right)$$\n其参数 $m_N$ 和 $s_N^2$ 如上定义。\n\n### MAP 估计计算\n对于高斯后验分布，最大后验（MAP）估计值等于其均值、众数和中位数。因此，$\\hat{\\delta}_{\\text{MAP}} = m_N$。我们现在计算其数值。\n\n首先，处理数据：\n$F_0 = 10^4$，所以 $\\mu = \\ln(10^4)$。\n$F_i = 10^4\\exp(-0.05 t_i)$，所以 $y_i = \\ln F_i = \\ln(10^4) - 0.05 t_i$。\n项 $\\mu - y_i$ 可简化为：$\\mu - y_i = \\ln(10^4) - (\\ln(10^4) - 0.05 t_i) = 0.05 t_i$。\n\n接下来，计算所需的和：\n时间点为 $t_i \\in \\{5, 10, 15, 20, 25, 30\\}$。\n$\\sum_{i=1}^6 t_i^2 = 5^2 + 10^2 + 15^2 + 20^2 + 25^2 + 30^2 = 25 + 100 + 225 + 400 + 625 + 900 = 2275 \\text{ min}^2$。\n$\\sum_{i=1}^6 t_i(\\mu-y_i) = \\sum_{i=1}^6 t_i(0.05 t_i) = 0.05 \\sum_{i=1}^6 t_i^2 = 0.05 \\times 2275 = 113.75 \\text{ min}$。\n\n现在，使用给定的参数值：\n$\\sigma = 0.05 \\implies \\sigma^2 = 0.0025$。\n$m_0 = 0.04 \\text{ min}^{-1}$。\n$s_0 = 0.02 \\text{ min}^{-1} \\implies s_0^2 = 0.0004 \\text{ min}^{-2}$。\n\n计算后验精度（$1/s_N^2$）：\n$$\\frac{1}{s_N^2} = \\frac{2275}{0.0025} + \\frac{1}{0.0004} = 910000 + 2500 = 912500 \\text{ min}^2$$\n\n计算 $m_N$ 括号中的项：\n$$\\frac{\\sum t_i(\\mu-y_i)}{\\sigma^2} + \\frac{m_0}{s_0^2} = \\frac{113.75}{0.0025} + \\frac{0.04}{0.0004} = 45500 + 100 = 45600 \\text{ min}$$\n\n最后，计算 $\\hat{\\delta}_{\\text{MAP}} = m_N$：\n$$\\hat{\\delta}_{\\text{MAP}} = m_N = \\frac{45600 \\text{ min}}{912500 \\text{ min}^2} = \\frac{456}{9125} \\text{ min}^{-1}$$\n$$\\hat{\\delta}_{\\text{MAP}} \\approx 0.0499726027... \\text{ min}^{-1}$$\n四舍五入到四位有效数字，我们得到 $0.04997$。\n结果是最大似然估计值（为 $0.05$）和先验均值（为 $0.04$）的精度加权平均值。由于数据精度远高于先验精度（$910000$ 对 $2500$），后验均值被拉向非常接近最大似然估计值（MLE）的位置。",
            "answer": "$$\\boxed{0.04997}$$"
        },
        {
            "introduction": "当模型中的多个参数对观测结果的贡献无法区分时，就会出现参数不可识别的问题，这使得经典的最大似然估计失效。本练习展示了贝叶斯方法如何通过引入先验知识来解决这个难题。您将分析一个简单但极具启发性的场景，其中一个信息丰富的先验分布能够“约束”模型，从而为一个原本无法唯一确定的参数得到一个明确的后验分布 。",
            "id": "2374096",
            "problem": "在一个计算工程校准任务中，一个集总模型预测一个测量到的标量响应是两个分量参数之和。一次实验产生一个测量值，其模型为\n$$\ny = \\theta_1 + \\theta_2 + \\varepsilon,\\quad \\varepsilon \\sim \\mathcal{N}(0,\\sigma^2),\n$$\n观测值为 $y_{\\text{obs}} = 10$，已知噪声方差为 $\\sigma^2 = 1$。参数 $\\theta_1$ 和 $\\theta_2$ 代表了不同的分量贡献，它们各自都具有工程意义。因为在这次单次实验中只观测到它们的和，所以对于 $(\\theta_1,\\theta_2)$ 而言，似然是不可辨识的。为了引入先验工程知识，对 $\\theta_1$ 使用一个非正常平坦先验（即在 $\\mathbb{R}$ 上 $p(\\theta_1) \\propto 1$），对 $\\theta_2$ 使用一个强信息高斯先验，\n$$\n\\theta_2 \\sim \\mathcal{N}(\\mu_2,\\tau_2^2),\\quad \\mu_2 = 6,\\ \\tau_2^2 = 0.04.\n$$\n考虑由此模型产生的后验推断。\n\n下列哪个陈述是正确的？\n\nA. $\\theta_1$ 的边缘后验是均值为 $y_{\\text{obs}} - \\mu_2$、方差为 $\\sigma^2 + \\tau_2^2$ 的高斯分布；数值上为 $\\mathcal{N}(4,\\ 1.04)$。\n\nB. 如果 $\\theta_2$ 的先验也是非正常平坦先验（即 $\\theta_1$ 和 $\\theta_2$ 都有平坦先验），那么给定 $y_{\\text{obs}}$ 时 $\\theta_1$ 的后验将是非正常的。\n\nC. 减小 $\\tau_2^2$ 会严格减小 $\\theta_1$ 的边缘后验方差，并且该方差不能被减小到低于 $\\sigma^2$。\n\nD. 在所述模型下，$\\theta_1$ 的最大似然估计等于 $4$。",
            "solution": "该问题要求在一个似然不可辨识的简单线性模型中，推导和分析参数 $\\theta_1$ 和 $\\theta_2$ 的后验分布。使用先验信息对于获得一个良定义的后验至关重要。我们将首先推导感兴趣的参数 $\\theta_1$ 的边缘后验分布，然后评估每个陈述。\n\n该模型由以下部分定义：\n似然函数由测量模型 $y = \\theta_1 + \\theta_2 + \\varepsilon$ 导出，其中误差项 $\\varepsilon$ 服从正态分布 $\\mathcal{N}(0, \\sigma^2)$。给定单个观测值 $y_{\\text{obs}}$，参数 $(\\theta_1, \\theta_2)$ 的似然为：\n$$p(y_{\\text{obs}} | \\theta_1, \\theta_2, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_{\\text{obs}} - \\theta_1 - \\theta_2)^2}{2\\sigma^2}\\right)$$\n给定的数值为 $y_{\\text{obs}} = 10$ 和 $\\sigma^2 = 1$。\n\n参数的先验分布如下：\n- 对于 $\\theta_1$：一个非正常均匀（平坦）先验，$p(\\theta_1) \\propto 1$ 对于 $\\theta_1 \\in \\mathbb{R}$。\n- 对于 $\\theta_2$：一个正常的正态（高斯）先验，$\\theta_2 \\sim \\mathcal{N}(\\mu_2, \\tau_2^2)$，其概率密度函数为 $p(\\theta_2) = \\frac{1}{\\sqrt{2\\pi\\tau_2^2}} \\exp\\left(-\\frac{(\\theta_2 - \\mu_2)^2}{2\\tau_2^2}\\right)$。\n$\\theta_2$ 先验的数值为 $\\mu_2 = 6$ 和 $\\tau_2^2 = 0.04$。\n\n假设 $\\theta_1$ 和 $\\theta_2$ 先验独立，则联合先验为 $p(\\theta_1, \\theta_2) = p(\\theta_1)p(\\theta_2)$。\n\n根据贝叶斯定理，联合后验分布正比于似然与联合先验的乘积：\n$$p(\\theta_1, \\theta_2 | y_{\\text{obs}}) \\propto p(y_{\\text{obs}} | \\theta_1, \\theta_2) p(\\theta_1, \\theta_2) \\propto \\exp\\left(-\\frac{(y_{\\text{obs}} - \\theta_1 - \\theta_2)^2}{2\\sigma^2}\\right) \\exp\\left(-\\frac{(\\theta_2 - \\mu_2)^2}{2\\tau_2^2}\\right)$$\n为了求得 $\\theta_1$ 的边缘后验，我们必须将联合后验对 $\\theta_2$ 的所有可能值进行积分：\n$$p(\\theta_1 | y_{\\text{obs}}) = \\int_{-\\infty}^{\\infty} p(\\theta_1, \\theta_2 | y_{\\text{obs}}) d\\theta_2$$\n一个更直接的方法是首先确定 $\\theta_1$ 的有效似然，记为 $p(y_{\\text{obs}} | \\theta_1)$。从模型 $y = \\theta_1 + \\theta_2 + \\varepsilon$ 中，我们可以将 $y | \\theta_1$ 写成一个由 $\\theta_2$ 和 $\\varepsilon$ 的分布决定的随机变量。给定 $\\theta_1$，量 $y$ 是一个常数 $\\theta_1$ 和两个独立随机变量之和：$\\theta_2 \\sim \\mathcal{N}(\\mu_2, \\tau_2^2)$ 和 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$。独立正态随机变量的和也是一个正态随机变量。\n给定 $\\theta_1$ 时 $y$ 的期望是：\n$$E[y | \\theta_1] = E[\\theta_1 + \\theta_2 + \\varepsilon | \\theta_1] = \\theta_1 + E[\\theta_2] + E[\\varepsilon] = \\theta_1 + \\mu_2 + 0 = \\theta_1 + \\mu_2$$\n给定 $\\theta_1$ 时 $y$ 的方差是：\n$$\\text{Var}(y | \\theta_1) = \\text{Var}(\\theta_1 + \\theta_2 + \\varepsilon | \\theta_1) = \\text{Var}(\\theta_2) + \\text{Var}(\\varepsilon) = \\tau_2^2 + \\sigma^2$$\n因此，以 $\\theta_1$ 为条件的 $y$ 的分布是正态分布：\n$$y | \\theta_1 \\sim \\mathcal{N}(\\theta_1 + \\mu_2, \\sigma^2 + \\tau_2^2)$$\n这给出了 $\\theta_1$ 的有效似然：$p(y_{\\text{obs}}|\\theta_1) = \\mathcal{N}(y_{\\text{obs}} | \\theta_1 + \\mu_2, \\sigma^2 + \\tau_2^2)$。\n\n现在，我们应用贝叶斯定理来求 $\\theta_1$ 的后验：\n$$p(\\theta_1 | y_{\\text{obs}}) \\propto p(y_{\\text{obs}} | \\theta_1) p(\\theta_1)$$\n由于平坦先验 $p(\\theta_1) \\propto 1$，后验正比于似然：\n$$p(\\theta_1 | y_{\\text{obs}}) \\propto \\exp\\left(-\\frac{(y_{\\text{obs}} - (\\theta_1 + \\mu_2))^2}{2(\\sigma^2 + \\tau_2^2)}\\right) = \\exp\\left(-\\frac{((y_{\\text{obs}} - \\mu_2) - \\theta_1)^2}{2(\\sigma^2 + \\tau_2^2)}\\right)$$\n这是 $\\theta_1$ 的一个正态分布的核。通过观察，$\\theta_1$ 的后验分布为：\n$$\\theta_1 | y_{\\text{obs}} \\sim \\mathcal{N}(\\; y_{\\text{obs}} - \\mu_2, \\; \\sigma^2 + \\tau_2^2 \\;)$$\n我们现在可以评估每个陈述了。\n\nA. $\\theta_1$ 的边缘后验是均值为 $y_{\\text{obs}} - \\mu_2$、方差为 $\\sigma^2 + \\tau_2^2$ 的高斯分布；数值上为 $\\mathcal{N}(4,\\ 1.04)$。\n\n根据我们的推导，$\\theta_1$ 的边缘后验确实是均值为 $y_{\\text{obs}} - \\mu_2$、方差为 $\\sigma^2 + \\tau_2^2$ 的正态分布。\n让我们代入给定的数值：\n- 均值: $E[\\theta_1 | y_{\\text{obs}}] = y_{\\text{obs}} - \\mu_2 = 10 - 6 = 4$。\n- 方差: $\\text{Var}(\\theta_1 | y_{\\text{obs}}) = \\sigma^2 + \\tau_2^2 = 1 + 0.04 = 1.04$。\n得到的后验是 $\\mathcal{N}(4, 1.04)$。该陈述与我们的推导完全一致。\n结论：**正确**。\n\nB. 如果 $\\theta_2$ 的先验也是非正常平坦先验（即 $\\theta_1$ 和 $\\theta_2$ 都有平坦先验），那么给定 $y_{\\text{obs}}$ 时 $\\theta_1$ 的后验将是非正常的。\n\n让我们假设 $p(\\theta_1) \\propto 1$ 和 $p(\\theta_2) \\propto 1$。联合先验为 $p(\\theta_1, \\theta_2) \\propto 1$。\n联合后验变为：\n$$p(\\theta_1, \\theta_2 | y_{\\text{obs}}) \\propto p(y_{\\text{obs}} | \\theta_1, \\theta_2) p(\\theta_1, \\theta_2) \\propto \\exp\\left(-\\frac{(y_{\\text{obs}} - \\theta_1 - \\theta_2)^2}{2\\sigma^2}\\right)$$\n为了求得 $\\theta_1$ 的边缘后验，我们对 $\\theta_2$ 进行积分：\n$$p(\\theta_1 | y_{\\text{obs}}) = \\int_{-\\infty}^{\\infty} p(\\theta_1, \\theta_2 | y_{\\text{obs}}) d\\theta_2 \\propto \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(y_{\\text{obs}} - \\theta_1 - \\theta_2)^2}{2\\sigma^2}\\right) d\\theta_2$$\n令 $z = \\theta_2$。被积函数是关于 $z$ 的高斯函数，其均值为 $(y_{\\text{obs}} - \\theta_1)$，方差相关参数为 $\\sigma^2$。一个未归一化的高斯函数在 $\\mathbb{R}$ 上的定积分是一个常数。具体来说，$\\int_{-\\infty}^{\\infty} e^{-(x-c)^2/(2s^2)} dx = \\sqrt{2\\pi s^2}$。\n在我们的例子中，该积分的值为 $\\sqrt{2\\pi\\sigma^2}$，这是一个不依赖于 $\\theta_1$ 的正常数。\n因此，$p(\\theta_1 | y_{\\text{obs}}) \\propto \\text{constant}$ 对于所有 $\\theta_1 \\in \\mathbb{R}$。\n一个在整个实线上为常数的未归一化密度是一个非正常分布，因为它的积分 $\\int_{-\\infty}^{\\infty} c \\, d\\theta_1$ 对于任何常数 $c > 0$ 都是发散的。因此，$\\theta_1$ 的边缘后验将是非正常的。\n结论：**正确**。\n\nC. 减小 $\\tau_2^2$ 会严格减小 $\\theta_1$ 的边缘后验方差，并且该方差不能被减小到低于 $\\sigma^2$。\n\n从我们的推导可知，$\\theta_1$ 的边缘后验方差为 $V_1 = \\text{Var}(\\theta_1 | y_{\\text{obs}}) = \\sigma^2 + \\tau_2^2$。\n参数 $\\sigma^2 = 1$ 是来自测量模型的一个固定常数。参数 $\\tau_2^2$ 代表我们关于 $\\theta_2$ 的先验信念的方差，并且必须是非负的（$\\tau_2^2 \\ge 0$）。\n为了分析 $\\tau_2^2$ 对 $V_1$ 的影响，我们考虑其导数：\n$$\\frac{dV_1}{d(\\tau_2^2)} = \\frac{d}{d(\\tau_2^2)}(\\sigma^2 + \\tau_2^2) = 1$$\n由于导数严格为正，$V_1$ 是 $\\tau_2^2$ 的严格增函数。因此，减小 $\\tau_2^2$ 会严格减小 $\\theta_1$ 的边缘后验方差。这证实了陈述的第一部分。\n对于第二部分，由于 $\\tau_2^2 \\ge 0$，后验方差的最小可能值为：\n$$V_1 = \\sigma^2 + \\tau_2^2 \\ge \\sigma^2 + 0 = \\sigma^2$$\n该方差不能被减小到低于测量噪声方差 $\\sigma^2$。这个下界在 $\\tau_2^2 \\to 0$ 的极限情况下达到，这对应于我们先验地认为 $\\theta_2$ 是完全已知的。该陈述完全正确。\n结论：**正确**。\n\nD. 在所述模型下，$\\theta_1$ 的最大似然估计等于 $4$。\n\n最大似然估计（MLE）是通过关于参数最大化似然函数 $L(\\theta_1, \\theta_2; y_{\\text{obs}}) = p(y_{\\text{obs}} | \\theta_1, \\theta_2)$ 来确定的。在计算 MLE 时不使用先验分布。\n似然函数为：\n$$L(\\theta_1, \\theta_2; y_{\\text{obs}}) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_{\\text{obs}} - \\theta_1 - \\theta_2)^2}{2\\sigma^2}\\right)$$\n最大化该函数等价于最小化指数中的平方误差项：$(y_{\\text{obs}} - \\theta_1 - \\theta_2)^2$。\n该项的最小值为全局最小值 $0$，对于任何满足条件 $\\theta_1 + \\theta_2 = y_{\\text{obs}}$ 的参数对 $(\\theta_1, \\theta_2)$ 都可以达到。\n给定 $y_{\\text{obs}} = 10$，直线上 $\\theta_1 + \\theta_2 = 10$ 的任何点对都是一个 MLE。对于参数向量 $(\\theta_1, \\theta_2)$ 没有唯一的 MLE，因此对于 $\\theta_1$ 单独也没有唯一的 MLE。使似然最大化的 $\\theta_1$ 的值集合是整个 $\\mathbb{R}$。\n值 $\\theta_1 = 4$ 是后验均值 E$[\\theta_1 | y_{\\text{obs}}]$，也是 $\\theta_1$ 的最大后验（MAP）估计，它最大化了边缘后验 $p(\\theta_1 | y_{\\text{obs}})$。然而，问题明确要求的是 MLE，这与这些贝叶斯估计量是不同的。\n结论：**错误**。",
            "answer": "$$\\boxed{ABC}$$"
        },
        {
            "introduction": "虽然许多简单的贝叶斯模型会产生易于处理的单峰后验分布，但现实世界中的非线性模型常常导致更复杂的分布形态。本练习探讨了一个后验分布呈现双峰形态的情景，这对参数估计和计算方法都构成了挑战。通过分析此问题 ，您将深入理解为何标准的MCMC算法（如随机游走Metropolis-Hastings）在探索多模态分布时可能会失败，并认识到在贝叶斯计算实践中保持批判性思维的重要性。",
            "id": "2374074",
            "problem": "一个计算工程实验室中的仪器模块输出一个非负标量摘要 $y$，该值与一个带符号的校准系数 $\\theta \\in \\mathbb{R}$ 的平方成正比，并带有加性高斯噪声。测量模型为\n\n$$\ny \\mid \\theta \\sim \\mathcal{N}\\!\\big(\\theta^{2}, \\sigma^{2}\\big),\n$$\n\n其中噪声标准差 $\\sigma$ 已知。校准系数的先验为\n\n$$\n\\theta \\sim \\mathcal{N}\\!\\big(0, \\tau^{2}\\big).\n$$\n\n记录到单个观测值 $y_{\\text{obs}} = 9$，其中 $\\sigma = 0.5$ 且 $\\tau = 5$。考虑基于此观测值对 $\\theta$ 进行贝叶斯推断。一位从业者使用高斯提议\n\n$$\nq(\\theta' \\mid \\theta) = \\mathcal{N}\\!\\big(\\theta, s^{2}\\big),\n$$\n\n运行了一个标准的随机游走Metropolis-Hastings马尔可夫链蒙特卡洛(MCMC)算法，提议尺度为 $s = 0.2$，初始化于 $\\theta_{0} = 3.2$，并使用标准的Metropolis-Hastings接受准则。\n\n关于后验 $p(\\theta \\mid y_{\\text{obs}})$ 和所描述的MCMC运行，以下哪个陈述最为准确？\n\nA. 后验密度在 $\\theta = 0$ 处是单峰的，因为似然仅通过 $\\theta^{2}$ 依赖于 $\\theta$；因此，提议尺度为 $s = 0.2$ 的随机游走Metropolis-Hastings将在正负 $\\theta$ 之间快速混合。\n\nB. 后验密度是双峰的，有两个对称的众数，位于 $\\theta \\approx \\pm 3$ 附近；当提议尺度较小（$s = 0.2$）且初始化于 $\\theta_{0} = 3.2$ 时，随机游走Metropolis-Hastings链将倾向于长时间停留在正众数附近，在典型的运行长度内可能无法发现负众数，从而可能给出误导性的单链收敛诊断。\n\nC. 后验密度是双峰的，并且根据细致平衡，无论提议尺度或初始化如何，链在任何有限次运行中都必须在两个众数中花费相等的时间。\n\nD. 后验密度在 $\\theta$ 的整数值处有无限多个众数；然而，即使对于 $s = 0.2$，高斯提议的对称性也确保了在这些众数之间频繁的跳跃。",
            "solution": "首先将对问题的科学性和逻辑一致性进行验证。\n\n### 步骤 1：提取已知条件\n-   测量模型（似然）：$y \\mid \\theta \\sim \\mathcal{N}(\\theta^{2}, \\sigma^{2})$，参数 $\\theta \\in \\mathbb{R}$。\n-   先验分布：$\\theta \\sim \\mathcal{N}(0, \\tau^{2})$。\n-   观测数据：单个观测值 $y_{\\text{obs}} = 9$。\n-   已知常数：噪声标准差 $\\sigma = 0.5$，先验标准差 $\\tau = 5$。\n-   MCMC算法：随机游走Metropolis-Hastings。\n-   MCMC提议分布：$q(\\theta' \\mid \\theta) = \\mathcal{N}(\\theta, s^{2})$。\n-   MCMC参数：提议尺度 $s = 0.2$，初始化 $\\theta_{0} = 3.2$。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述描述了一个用于参数估计的标准贝叶斯推断任务。指定的似然和先验分布是良定义的概率密度。在该模型中，观测值与参数的平方成正比并加上高斯噪声，这是信号处理和物理学中（例如，从振幅测量功率）的常见情景。提供的数值是合理且自洽的。问题要求分析后验分布和标准MCMC算法的行为，这是一个在计算统计学和工程学中良构的问题。陈述中 $y$ 是一个“非负标量摘要”与给定参数的高斯模型并不冲突，因为在 $y \\mid \\theta \\sim \\mathcal{N}(\\theta^2, 0.5^2)$ 和 $y_{\\text{obs}}=9$ 的条件下，$y < 0$ 的概率可以忽略不计（对于在 $\\pm 3$ 附近的相关 $\\theta$ 值，似然的均值距离 $0$ 至少有 $18$ 个标准差）。该问题具有科学依据，良构，客观且完整。\n\n### 步骤 3：结论与行动\n问题陈述有效。将推导完整解答。\n\n### 后验分布的推导\n\n根据贝叶斯定理，给定观测值 $y=y_{\\text{obs}}$ 时参数 $\\theta$ 的后验概率密度函数（PDF）正比于似然和先验的乘积：\n$$\np(\\theta \\mid y) \\propto p(y \\mid \\theta) p(\\theta)\n$$\n似然函数由均值为 $\\theta^2$、方差为 $\\sigma^2$ 的正态分布的PDF给出：\n$$\np(y \\mid \\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y - \\theta^2)^2}{2\\sigma^2}\\right)\n$$\n先验分布是一个以 $0$ 为中心、方差为 $\\tau^2$ 的正态分布：\n$$\np(\\theta) = \\frac{1}{\\sqrt{2\\pi\\tau^2}} \\exp\\left(-\\frac{\\theta^2}{2\\tau^2}\\right)\n$$\n结合这两者，后验为：\n$$\np(\\theta \\mid y) \\propto \\exp\\left(-\\frac{(y - \\theta^2)^2}{2\\sigma^2} - \\frac{\\theta^2}{2\\tau^2}\\right)\n$$\n为了分析此分布的形状，特别是为了找到其众数（局部最大值），使用对数后验是方便的。忽略加性常数，对数后验 $L(\\theta)$ 为：\n$$\nL(\\theta) = -\\frac{(y - \\theta^2)^2}{2\\sigma^2} - \\frac{\\theta^2}{2\\tau^2}\n$$\n后验的众数可以通过求 $L(\\theta)$ 对 $\\theta$ 的导数并将其设为零来找到：\n$$\n\\frac{dL}{d\\theta} = -\\frac{2(y - \\theta^2)(-2\\theta)}{2\\sigma^2} - \\frac{2\\theta}{2\\tau^2} = \\frac{2\\theta(y - \\theta^2)}{\\sigma^2} - \\frac{\\theta}{\\tau^2}\n$$\n设 $\\frac{dL}{d\\theta} = 0$:\n$$\n\\theta \\left( \\frac{2(y - \\theta^2)}{\\sigma^2} - \\frac{1}{\\tau^2} \\right) = 0\n$$\n此方程的解为 $\\theta=0$ 或括号中的项为零。\n1.  $\\theta = 0$ 是一个临界点。\n2.  $\\frac{2(y - \\theta^2)}{\\sigma^2} = \\frac{1}{\\tau^2} \\implies 2(y - \\theta^2) = \\frac{\\sigma^2}{\\tau^2} \\implies \\theta^2 = y - \\frac{\\sigma^2}{2\\tau^2}$。\n\n代入给定值 $y = 9$, $\\sigma = 0.5$ ($\\sigma^2 = 0.25$) 和 $\\tau = 5$ ($\\tau^2 = 25$):\n$$\n\\theta^2 = 9 - \\frac{0.25}{2(25)} = 9 - \\frac{0.25}{50} = 9 - 0.005 = 8.995\n$$\n这给出了另外两个临界点：$\\theta \\approx \\pm\\sqrt{8.995} \\approx \\pm 2.999$。\n\n为了对这些临界点进行分类，我们考察二阶导数 $\\frac{d^2L}{d\\theta^2}$:\n$$\n\\frac{d^2L}{d\\theta^2} = \\frac{d}{d\\theta}\\left(\\frac{2y\\theta}{\\sigma^2} - \\frac{2\\theta^3}{\\sigma^2} - \\frac{\\theta}{\\tau^2}\\right) = \\frac{2y}{\\sigma^2} - \\frac{6\\theta^2}{\\sigma^2} - \\frac{1}{\\tau^2}\n$$\n-   在 $\\theta=0$ 处：$\\frac{d^2L}{d\\theta^2} = \\frac{2(9)}{0.25} - \\frac{1}{25} = 72 - 0.04 = 71.96 > 0$。这表示一个局部最小值。因此，$\\theta=0$ 是一个反众数（后验密度最小的点）。\n-   在 $\\theta^2=8.995$ 处：$\\frac{d^2L}{d\\theta^2} = \\frac{2(9)}{0.25} - \\frac{6(8.995)}{0.25} - \\frac{1}{25} = 72 - 6(35.98) - 0.04 = 72 - 215.88 - 0.04 = -143.92  0$。这表示一个局部最大值。\n\n因此，后验分布 $p(\\theta \\mid y_{\\text{obs}})$ 是双峰的，有两个对称的众数，位于 $\\theta \\approx \\pm 3$，由一个围绕 $\\theta = 0$ 的低概率区域隔开。\n\n### MCMC算法分析\n\n指定的算法是一个随机游走Metropolis-Hastings (RWMH) 采样器。链初始化于 $\\theta_0 = 3.2$，非常接近位于 $\\theta \\approx +3$ 的正众数。提议分布是一个窄高斯分布 $q(\\theta' \\mid \\theta) = \\mathcal{N}(\\theta, s^2)$，具有一个小的尺度（标准差）$s = 0.2$。\n\n为了让MCMC链能从整个后验分布中抽样，它必须能够在两个众数之间移动。从正众数（接近 $+3$）跳到负众数（接近 $-3$）需要穿过围绕 $\\theta = 0$ 的低概率“谷”。当提议尺度像 $s=0.2$ 这么小时，提议 $\\theta'$ 将非常接近当前状态 $\\theta$。要从一个众数跨越到另一个，链必须采取许多小步骤。任何从众数附近朝向 $\\theta=0$ 的反众数的步骤都是向后验概率更低的区域移动。这类移动的接受概率小于1，因此不被偏好。发生一系列此类不受偏好的移动的概率非常低。\n\n因此，从 $\\theta_0=3.2$ 开始的链将有效地探索正众数周围的区域，但将极难跨越到负众数。对于任何实际的、有限次数的迭代（“典型的运行长度”），链很可能“卡”在正众数的吸引盆地中。对这条单链的输出进行分析（例如，轨迹图）很可能显示出良好的行为和表观收敛，但这将是收敛到一个仅代表真实后验一半的分布。这是MCMC在多峰设置中的经典问题，其中单链诊断可能具有危险的误导性。\n\n### 逐项分析\n\n**A. 后验密度在 $\\theta = 0$ 处是单峰的，因为似然仅通过 $\\theta^{2}$ 依赖于 $\\theta$；因此，提议尺度为 $s = 0.2$ 的随机游走Metropolis-Hastings将在正负 $\\theta$ 之间快速混合。**\n此陈述不正确。后验密度在 $\\theta = 0$ 处不是单峰的；我们的分析证明了它是双峰的，在 $\\theta = 0$ 处有一个反众数（局部最小值）。似然和先验的对称性创造了两个众数，而不是一个。此外，MCMC链不会快速混合；小的提议尺度会将其困在一个众数中。\n结论：**不正确**。\n\n**B. 后验密度是双峰的，有两个对称的众数，位于 $\\theta \\approx \\pm 3$ 附近；当提议尺度较小（$s = 0.2$）且初始化于 $\\theta_{0} = 3.2$ 时，随机游走Metropolis-Hastings链将倾向于长时间停留在正众数附近，在典型的运行长度内可能无法发现负众数，从而可能给出误导性的单链收敛诊断。**\n该陈述与我们的推导完全一致。后验是双峰的，众数位于 $\\theta \\approx \\pm 3$ 附近。鉴于MCMC的设置（在一个众数附近初始化，提议尺度小），链在众数之间将表现出差的混合性，很可能被困在正众数中。这种行为可能导致从单条链中得出误导性的乐观收敛诊断。\n结论：**正确**。\n\n**C. 后验密度是双峰的，并且根据细致平衡，无论提议尺度或初始化如何，链在任何有限次运行中都必须在两个众数中花费相等的时间。**\n此陈述不正确。虽然后验是双峰的，但关于MCMC行为的结论是有缺陷的。细致平衡性质确保了在无限步数的极限下，链会收敛到正确的平稳分布。对于对称的后验，这意味着渐近地，探索每个众数所花费的时间是相等的。然而，这个保证不适用于任何*有限次运行*，尤其是在混合性差的情况下。提议尺度和初始化是决定收敛速度以及链探索整个状态空间速度的关键因素。像本问题中的糟糕选择，会阻止链在有限次运行中访问所有众数。\n结论：**不正确**。\n\n**D. 后验密度在 $\\theta$ 的整数值处有无限多个众数；然而，即使对于 $s = 0.2$，高斯提议的对称性也确保了在这些众数之间频繁的跳跃。**\n此陈述不正确。后验分布由两个与高斯函数相关的函数的乘积推导而来，其形式简单 ($L(\\theta) \\propto a\\theta^2 - b\\theta^4$)，只有两个众数，而不是无限多个。众数不在整数值处，而是在 $\\theta \\approx \\pm 2.999$ 处。提议分布的对称性并不能保证在遥远的众数之间频繁跳跃；提议尺度是决定性因素，而在这里它太小了，无法促进这样的跳跃。\n结论：**不正确**。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}