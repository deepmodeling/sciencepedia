{
    "hands_on_practices": [
        {
            "introduction": "在贝叶斯参数估计中，一个核心实践是构建可信区间并理解其与频率派置信区间的区别。本练习将通过一个合成生物学中的典型场景——估计基因回路的激活概率——来具体化这一对比。通过处理小样本数据，您将亲身体会到先验选择如何影响后验推断，并从根本上理解这两种统计推断范式在解释上的差异。",
            "id": "3907430",
            "problem": "一个合成基因线路被设计用于在转录因子激活时将荧光报告基因切换到“开启”状态。在一次微流控分析中，将 $n=10$ 个独立的微滴分别装载一个工程细胞，并在相同条件下暴露于诱导剂。观测到“开启”状态的微滴数量为 $k=2$。设未知的激活概率为 $p \\in (0,1)$，并将数据建模为一系列独立的伯努利试验，从而得到在 $n$ 次试验中取得 $k$ 次成功的二项似然。采用二项比例的Jeffreys先验，即参数为 $1/2$ 和 $1/2$ 的贝塔分布。使用相干贝叶斯更新，构建 $p$ 的后验分布。\n\n基于此后验分布，构建 $p$ 的等尾 $0.95$ 可信区间。另外，使用二项模型，基于Clopper–Pearson方法（Clopper–Pearson精确置信区间(CP)），构建 $p$ 的 $0.95$ 精确频率派置信区间。将区间的宽度定义为上端点减去下端点。\n\n计算这些数据的贝叶斯等尾 $0.95$ 可信区间的宽度与Clopper–Pearson $0.95$ 置信区间的宽度之比。将最终答案表示为包含正则化不完全贝塔函数反函数的单一闭式解析表达式，且不进行任何数值四舍五入。",
            "solution": "首先对问题进行验证。\n\n**步骤1：提取已知条件**\n- 独立试验次数（微滴数）：$n=10$。\n- 观测到的成功次数（“开启”状态的微滴数）：$k=2$。\n- 未知参数（激活概率）：$p \\in (0,1)$。\n- 似然模型：二项分布，描述在 $n$ 次试验中的 $k$ 次成功。\n- 先验分布：二项比例的Jeffreys先验，即参数为 $\\alpha_0 = \\frac{1}{2}$ 和 $\\beta_0 = \\frac{1}{2}$ 的贝塔分布，即 $p \\sim \\text{Beta}(\\frac{1}{2}, \\frac{1}{2})$。\n- 期望的贝叶斯区间：$p$ 的等尾 $0.95$ 可信区间。\n- 期望的频率派区间：$p$ 的 $0.95$ 精确Clopper–Pearson置信区间。\n- 最终计算：贝叶斯可信区间的宽度与Clopper–Pearson置信区间的宽度之比。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它使用标准且成熟的统计方法（使用共轭先验的贝叶斯推断、Clopper-Pearson区间）来分析合成生物学中一个常见的实验设置（量化基因线路的成功率）。该问题是适定的、客观的且自洽的，提供了所有必要的数据（$n$、$k$）、模型（二项似然、Jeffreys先验）和方法（等尾可信区间、Clopper-Pearson区间），以得出一个唯一的、有意义的解析解。不存在矛盾、歧义或不切实际的假设。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整解答。\n\n解答包括三个主要部分：首先，进行贝叶斯分析以确定可信区间的宽度；其次，进行频率派分析以确定Clopper–Pearson置信区间的宽度；第三，计算这两个宽度的比率。\n\n**1. 贝叶斯可信区间**\n\n分析首先从定义贝叶斯定理的各个组成部分开始。\n在 $n$ 次试验中观测到 $k$ 次成功的似然由二项概率质量函数给出：\n$$ P(k|n, p) = \\binom{n}{k} p^k (1-p)^{n-k} $$\n作为 $p$ 的函数，似然正比于 $p^k (1-p)^{n-k}$。\n\n$p$ 的先验分布被指定为Jeffreys先验，即贝塔分布 $\\text{Beta}(\\frac{1}{2}, \\frac{1}{2})$。其概率密度函数 (PDF) 为：\n$$ \\pi(p) \\propto p^{\\frac{1}{2}-1} (1-p)^{\\frac{1}{2}-1} = p^{-\\frac{1}{2}} (1-p)^{-\\frac{1}{2}} $$\n$p$ 的后验分布正比于似然与先验的乘积：\n$$ \\pi(p|k,n) \\propto P(k|n,p) \\times \\pi(p) \\propto \\left[p^k (1-p)^{n-k}\\right] \\times \\left[p^{\\frac{1}{2}-1} (1-p)^{\\frac{1}{2}-1}\\right] $$\n$$ \\pi(p|k,n) \\propto p^{k+\\frac{1}{2}-1} (1-p)^{n-k+\\frac{1}{2}-1} $$\n这是一个贝塔分布的核。由于贝塔先验与二项似然的共轭性，后验分布也是一个贝塔分布，其更新后的参数为：\n$$ \\alpha_{\\text{post}} = k + \\frac{1}{2} $$\n$$ \\beta_{\\text{post}} = n - k + \\frac{1}{2} $$\n代入给定值 $n=10$ 和 $k=2$：\n$$ \\alpha_{\\text{post}} = 2 + \\frac{1}{2} = \\frac{5}{2} $$\n$$ \\beta_{\\text{post}} = 10 - 2 + \\frac{1}{2} = 8 + \\frac{1}{2} = \\frac{17}{2} $$\n因此，后验分布为 $p|k=2, n=10 \\sim \\text{Beta}(\\frac{5}{2}, \\frac{17}{2})$。\n\n一个等尾 $0.95$ 可信区间 $[p_L, p_U]$ 的定义为 $P(p  p_L) = 0.025$ 且 $P(p > p_U) = 0.025$。这些概率是使用后验贝塔分布的累积分布函数 (CDF) 求得的，该函数即为正则化不完全贝塔函数，记作 $I_x(\\alpha, \\beta)$。因此，端点是后验分布的分位数：\n$$ p_L = I^{-1}(0.025; \\alpha_{\\text{post}}, \\beta_{\\text{post}}) = I^{-1}(0.025; \\frac{5}{2}, \\frac{17}{2}) $$\n$$ p_U = I^{-1}(0.975; \\alpha_{\\text{post}}, \\beta_{\\text{post}}) = I^{-1}(0.975; \\frac{5}{2}, \\frac{17}{2}) $$\n贝叶斯可信区间的宽度 $W_B$ 是上端点与下端点之差：\n$$ W_B = p_U - p_L = I^{-1}(0.975; \\frac{5}{2}, \\frac{17}{2}) - I^{-1}(0.025; \\frac{5}{2}, \\frac{17}{2}) $$\n\n**2. Clopper-Pearson置信区间**\n\n二项比例的Clopper-Pearson $1-\\alpha$ 置信区间 $[p_{L,CP}, p_{U,CP}]$ 是通过反演两个单边二项检验来构造的。对于 $0.95$ 的置信水平，$\\alpha = 0.05$。\n下端点 $p_{L,CP}$ 是这样一个 $p$ 值，使得观测到 $k$ 次或更多次成功的概率为 $\\frac{\\alpha}{2} = 0.025$：\n$$ P(X \\ge k | p=p_{L,CP}, n) = \\sum_{j=k}^{n} \\binom{n}{j} (p_{L,CP})^j (1-p_{L,CP})^{n-j} = \\frac{\\alpha}{2} $$\n这个累积概率通过恒等式 $P(X \\ge k) = I_p(k, n-k+1)$ 与正则化不完全贝塔函数相关。因此：\n$$ I_{p_{L,CP}}(k, n-k+1) = \\frac{\\alpha}{2} $$\n求解 $p_{L,CP}$ 并代入 $k=2$，$n=10$ 和 $\\frac{\\alpha}{2}=0.025$：\n$$ p_{L,CP} = I^{-1}(\\frac{\\alpha}{2}; k, n-k+1) = I^{-1}(0.025; 2, 10-2+1) = I^{-1}(0.025; 2, 9) $$\n上端点 $p_{U,CP}$ 是这样一个 $p$ 值，使得观测到 $k$ 次或更少次成功的概率为 $\\frac{\\alpha}{2} = 0.025$：\n$$ P(X \\le k | p=p_{U,CP}, n) = \\sum_{j=0}^{k} \\binom{n}{j} (p_{U,CP})^j (1-p_{U,CP})^{n-j} = \\frac{\\alpha}{2} $$\n这个累积概率通过恒等式 $P(X \\le k) = I_{1-p}(n-k, k+1)$ 与正则化不完全贝塔函数相关。一个更直接的分位数函数公式可以从 $P(X \\ge k+1 | p=p_{U,CP}) = 1-\\frac{\\alpha}{2}$ 导出，这得到 $I_{p_{U,CP}}(k+1, n-k) = 1-\\frac{\\alpha}{2}$。求解 $p_{U,CP}$：\n$$ p_{U,CP} = I^{-1}(1-\\frac{\\alpha}{2}; k+1, n-k) = I^{-1}(0.975; 2+1, 10-2) = I^{-1}(0.975; 3, 8) $$\nClopper-Pearson置信区间的宽度 $W_{CP}$ 是其端点之差：\n$$ W_{CP} = p_{U,CP} - p_{L,CP} = I^{-1}(0.975; 3, 8) - I^{-1}(0.025; 2, 9) $$\n\n**3. 宽度之比**\n\n最后一步是计算贝叶斯可信区间宽度 $W_B$ 与Clopper-Pearson置信区间宽度 $W_{CP}$ 的比值。\n$$ \\text{比率} = \\frac{W_B}{W_{CP}} = \\frac{I^{-1}(0.975; \\frac{5}{2}, \\frac{17}{2}) - I^{-1}(0.025; \\frac{5}{2}, \\frac{17}{2})}{I^{-1}(0.975; 3, 8) - I^{-1}(0.025; 2, 9)} $$\n这就是问题陈述所要求的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{I^{-1}(0.975; \\frac{5}{2}, \\frac{17}{2}) - I^{-1}(0.025; \\frac{5}{2}, \\frac{17}{2})}{I^{-1}(0.975; 3, 8) - I^{-1}(0.025; 2, 9)}}\n$$"
        },
        {
            "introduction": "在对动态生物系统进行建模时，从时间序列数据中估计速率常数是一项核心任务。这个练习模拟了通过荧光蛋白降解实验来推断蛋白质降解速率的场景。 您将学习如何将一阶动力学模型转化为贝叶斯线性回归框架，并利用共轭先验的威力来解析地推导出参数的后验分布，这是定量生物学中一项非常实用的技能。",
            "id": "3907511",
            "problem": "一个合成基因电路在一个可诱导启动子的控制下表达一种荧光报告蛋白。在时间 $t=0$ 时，诱导剂被移除，生产停止，因此蛋白质丰度 $X(t)$ 以一级动力学方式衰减，降解速率为 $\\delta$。假设标准的质量作用衰减定律 $dX/dt=-\\delta X$ 成立，并且测得的荧光强度 $F(t)$ 与 $X(t)$ 成正比，比例常数固定。测量噪声在强度上是乘性的，因此在对数上是加性的，所以 $y_i=\\ln F(t_i)$ 满足 $y_i=\\mu-\\delta t_i+\\epsilon_i$，其中 $\\mu=\\ln(\\kappa X_0)$ 吸收了比例常数 $\\kappa$ 和初始丰度 $X_0$，而 $\\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 是独立同分布的。在 $t=0$ 时进行的一次高信噪比基线测量提供了 $F_0$，使得 $\\mu=\\ln F_0$ 可以被视为已知。给定一个单细胞延时摄影轨迹，时间点为 $t_i \\in \\{5,10,15,20,25,30\\}$ 分钟，记录的强度为\n$F_i \\in \\{10^{4}\\exp(-0.05 \\times 5),\\,10^{4}\\exp(-0.05 \\times 10),\\,10^{4}\\exp(-0.05 \\times 15),\\,10^{4}\\exp(-0.05 \\times 20),\\,10^{4}\\exp(-0.05 \\times 25),\\,10^{4}\\exp(-0.05 \\times 30)\\}$（任意单位，a.u.），并且 $F_0=10^{4}$ a.u.。已知对数空间中的噪声标准差为 $\\sigma=0.05$。对降解速率 $\\delta$ 设置一个高斯先验 $\\delta \\sim \\mathcal{N}(m_0,s_0^2)$，其中 $m_0=0.04$，$s_0=0.02$，$m_0$ 和 $s_0$ 的单位为 $\\text{min}^{-1}$。\n\n仅使用上述定义和定律作为出发点，执行以下操作：\n\n- 基于对数转换后的测量值和给定的先验，构建 $\\delta$ 的贝叶斯模型。\n- 推导后验分布 $p(\\delta \\mid \\{(t_i,F_i)\\}_{i=1}^{6})$ 的解析形式。\n- 根据此后验和提供的数据，计算最大后验估计 $\\hat{\\delta}_{\\text{MAP}}$。\n\n将 $\\hat{\\delta}_{\\text{MAP}}$ 的最终数值答案四舍五入到四位有效数字。以 $\\text{min}^{-1}$ 为单位表示最终速率。",
            "solution": "首先对问题陈述进行验证，以确保其科学基础扎实、问题定义明确且客观。\n\n### 第1步：提取已知信息\n- **微分方程：** 蛋白质丰度 $X(t)$ 根据 $\\frac{dX}{dt}=-\\delta X$ 衰减。\n- **测量模型：** 测得的荧光强度 $F(t)$ 与 $X(t)$ 成正比，即 $F(t) = \\kappa X(t)$。\n- **对数线性模型：** 对数转换后的测量值 $y_i = \\ln F(t_i)$ 服从线性模型 $y_i = \\mu - \\delta t_i + \\epsilon_i$，其中 $\\mu = \\ln(\\kappa X_0)$。\n- **噪声模型：** 噪声项 $\\epsilon_i$ 是独立同分布（i.i.d.）的高斯随机变量，$\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n- **已知参数：**\n    - $\\mu$ 被视为已知：$\\mu = \\ln F_0$。\n    - 初始荧光强度：$F_0 = 10^4$ a.u.。\n    - 噪声标准差：$\\sigma = 0.05$。\n- **数据：**\n    - 测量时间：$t_i \\in \\{5, 10, 15, 20, 25, 30\\}$ 分钟，其中 $i=1, \\dots, 6$。\n    - 测得的荧光值：对于相应的 $t_i$，$F_i = 10^4 \\exp(-0.05 t_i)$。\n- **先验分布：** 对降解速率 $\\delta$ 设置一个高斯先验：$\\delta \\sim \\mathcal{N}(m_0, s_0^2)$。\n    - 先验均值：$m_0 = 0.04 \\text{ min}^{-1}$。\n    - 先验标准差：$s_0 = 0.02 \\text{ min}^{-1}$。\n- **任务：**\n    1. 构建 $\\delta$ 的贝叶斯模型。\n    2. 推导后验分布 $p(\\delta \\mid \\{(t_i,F_i)\\})$ 的解析形式。\n    3. 计算最大后验（MAP）估计 $\\hat{\\delta}_{\\text{MAP}}$。\n\n### 第2步：使用提取的已知信息进行验证\n该问题具有科学依据，采用了标准的一级衰减质量作用动力学和一种常见的对数线性模型来处理具有乘性噪声的荧光数据。该问题定义明确；它提供了推导唯一后验分布以及唯一MAP估计所需的所有信息（数据、完整的概率模型和先验）。在线性高斯模型中对参数使用高斯先验是一种标准的共轭先验设置，确保了后验分布是明确定义的高斯分布。语言客观而精确。数据虽然是从模型本身合成的，没有噪声，但这并不会使问题无效，因为该问题旨在测试在指定模型噪声 $\\sigma$ 的情况下应用贝叶斯框架的能力。该问题自成体系、前后一致且科学合理。\n\n### 第3步：结论与行动\n问题有效。我们继续推导解决方案。\n\n### 贝叶斯模型构建与后验推导\n目标是找到在给定数据 $D = \\{(t_i, y_i)\\}_{i=1}^6$（其中 $y_i = \\ln F_i$）的条件下，降解速率 $\\delta$ 的后验分布。根据贝叶斯定理，后验分布正比于似然与先验的乘积：\n$$p(\\delta \\mid D) \\propto p(D \\mid \\delta) p(\\delta)$$\n\n**1. 似然函数**\n单个对数转换测量的模型为 $y_i = \\mu - \\delta t_i + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着在给定 $\\delta$ 的条件下，$y_i$ 的条件分布是高斯的：\n$$y_i \\mid \\delta \\sim \\mathcal{N}(\\mu - \\delta t_i, \\sigma^2)$$\n单个数据点的概率密度函数为：\n$$p(y_i \\mid \\delta) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - (\\mu - \\delta t_i))^2}{2\\sigma^2} \\right) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - \\mu + \\delta t_i)^2}{2\\sigma^2} \\right)$$\n由于测量是独立的，整个数据集 $D$ 的似然是各个概率的乘积：\n$$L(\\delta) = p(D \\mid \\delta) = \\prod_{i=1}^N p(y_i \\mid \\delta)$$\n使用对数似然 $\\ln L(\\delta)$ 更为方便。只保留依赖于 $\\delta$ 的项：\n$$\\ln L(\\delta) = \\sum_{i=1}^N \\ln p(y_i \\mid \\delta) = \\text{const} - \\frac{1}{2\\sigma^2} \\sum_{i=1}^N (y_i - \\mu + \\delta t_i)^2$$\n展开二次项，我们看到对数似然是 $\\delta$ 的一个二次函数：\n$$\\ln L(\\delta) = \\text{const} - \\frac{1}{2\\sigma^2} \\left( \\delta^2 \\sum_{i=1}^N t_i^2 + 2\\delta \\sum_{i=1}^N t_i(y_i - \\mu) + \\sum_{i=1}^N (y_i - \\mu)^2 \\right)$$\n这表明似然函数作为 $\\delta$ 的函数，与一个高斯分布成正比。\n\n**2. 先验分布**\n$\\delta$ 的先验分布被给定为高斯分布：\n$$p(\\delta) = \\mathcal{N}(\\delta; m_0, s_0^2) = \\frac{1}{\\sqrt{2\\pi s_0^2}} \\exp\\left( -\\frac{(\\delta - m_0)^2}{2s_0^2} \\right)$$\n对数先验是：\n$$\\ln p(\\delta) = \\text{const} - \\frac{(\\delta - m_0)^2}{2s_0^2} = \\text{const} - \\frac{1}{2s_0^2}(\\delta^2 - 2\\delta m_0 + m_0^2)$$\n\n**3. 后验分布**\n对数后验是对数似然和对数先验的和（加上常数）：\n$$\\ln p(\\delta \\mid D) = \\text{const} - \\frac{1}{2} \\left[ \\frac{1}{\\sigma^2}\\left(\\delta^2 \\sum t_i^2 - 2\\delta \\sum t_i(\\mu-y_i)\\right) + \\frac{1}{s_0^2}(\\delta^2 - 2\\delta m_0) \\right]$$\n按 $\\delta$ 的幂次对各项进行分组：\n$$\\ln p(\\delta \\mid D) = \\text{const} - \\frac{1}{2} \\left[ \\delta^2 \\left( \\frac{\\sum t_i^2}{\\sigma^2} + \\frac{1}{s_0^2} \\right) - 2\\delta \\left( \\frac{\\sum t_i(\\mu-y_i)}{\\sigma^2} + \\frac{m_0}{s_0^2} \\right) \\right]$$\n这是 $\\delta$ 的一个二次型，这意味着后验分布 $p(\\delta \\mid D)$ 也是一个高斯分布，记为 $\\mathcal{N}(\\delta; m_N, s_N^2)$。对数高斯函数的一般形式是 $\\text{const} - \\frac{(\\delta - m_N)^2}{2s_N^2} = \\text{const} - \\frac{1}{2} \\left( \\frac{\\delta^2}{s_N^2} - \\frac{2\\delta m_N}{s_N^2} \\right)$。\n通过比较 $\\delta^2$ 和 $\\delta$ 的系数，我们可以找到后验方差 $s_N^2$ 和均值 $m_N$。\n后验方差的倒数（后验精度）是：\n$$\\frac{1}{s_N^2} = \\frac{\\sum_{i=1}^N t_i^2}{\\sigma^2} + \\frac{1}{s_0^2}$$\n后验均值是：\n$$m_N = s_N^2 \\left( \\frac{\\sum_{i=1}^N t_i(\\mu-y_i)}{\\sigma^2} + \\frac{m_0}{s_0^2} \\right)$$\n因此，后验分布的解析形式是一个高斯分布：\n$$p(\\delta \\mid D) = \\mathcal{N}\\left(\\delta; m_N, s_N^2\\right)$$\n其参数 $m_N$ 和 $s_N^2$ 如上定义。\n\n### MAP估计计算\n对于高斯后验分布，最大后验（MAP）估计等于其均值、众数和中位数。因此，$\\hat{\\delta}_{\\text{MAP}} = m_N$。我们现在计算其数值。\n\n首先，处理数据：\n$F_0 = 10^4$，因此 $\\mu = \\ln(10^4)$。\n$F_i = 10^4\\exp(-0.05 t_i)$，因此 $y_i = \\ln F_i = \\ln(10^4) - 0.05 t_i$。\n项 $\\mu - y_i$ 简化为：$\\mu - y_i = \\ln(10^4) - (\\ln(10^4) - 0.05 t_i) = 0.05 t_i$。\n\n接下来，计算所需的和：\n时间点为 $t_i \\in \\{5, 10, 15, 20, 25, 30\\}$。\n$\\sum_{i=1}^6 t_i^2 = 5^2 + 10^2 + 15^2 + 20^2 + 25^2 + 30^2 = 25 + 100 + 225 + 400 + 625 + 900 = 2275 \\text{ min}^2$。\n$\\sum_{i=1}^6 t_i(\\mu-y_i) = \\sum_{i=1}^6 t_i(0.05 t_i) = 0.05 \\sum_{i=1}^6 t_i^2 = 0.05 \\times 2275 = 113.75 \\text{ min}$。\n\n现在，使用给定的参数值：\n$\\sigma = 0.05 \\implies \\sigma^2 = 0.0025$。\n$m_0 = 0.04 \\text{ min}^{-1}$。\n$s_0 = 0.02 \\text{ min}^{-1} \\implies s_0^2 = 0.0004 \\text{ min}^{-2}$。\n\n计算后验精度（$1/s_N^2$）：\n$$\\frac{1}{s_N^2} = \\frac{2275}{0.0025} + \\frac{1}{0.0004} = 910000 + 2500 = 912500 \\text{ min}^2$$\n\n计算 $m_N$ 表达式中括号内的项：\n$$\\frac{\\sum t_i(\\mu-y_i)}{\\sigma^2} + \\frac{m_0}{s_0^2} = \\frac{113.75}{0.0025} + \\frac{0.04}{0.0004} = 45500 + 100 = 45600 \\text{ min}$$\n\n最后，计算 $\\hat{\\delta}_{\\text{MAP}} = m_N$：\n$$\\hat{\\delta}_{\\text{MAP}} = m_N = \\frac{45600 \\text{ min}}{912500 \\text{ min}^2} = \\frac{456}{9125} \\text{ min}^{-1}$$\n$$\\hat{\\delta}_{\\text{MAP}} \\approx 0.0499726027... \\text{ min}^{-1}$$\n四舍五入到四位有效数字，我们得到 $0.04997$。\n该结果是最大似然估计值 $0.05$ 和先验均值 $0.04$ 的精度加权平均值。由于数据精度远高于先验精度（$910000$ vs $2500$），后验均值被拉向非常接近最大似然估计（MLE）的值。",
            "answer": "$$\\boxed{0.04997}$$"
        },
        {
            "introduction": "理论上构建后验分布只是第一步；在实践中，我们必须能够有效地从中进行计算和采样。这个练习通过一个非线性测量模型揭示了后验分布可能呈现的复杂形态，例如双峰分布。 通过分析一个标准MCMC采样器的行为，您将深入理解当后验分布并非简单的单峰时，计算方法的选择（如采样器的初始化和步长）为何至关重要，以及为何必须对算法的收敛性进行批判性评估。",
            "id": "2374074",
            "problem": "某计算工程实验室的一个仪器模块输出一个非负标量摘要 $y$，该值与一个带符号的校准系数 $\\theta \\in \\mathbb{R}$ 的平方成正比，并带有加性高斯噪声。其测量模型为\n\n$$\ny \\mid \\theta \\sim \\mathcal{N}\\!\\big(\\theta^{2}, \\sigma^{2}\\big),\n$$\n\n其中噪声标准差 $\\sigma$ 已知。校准系数的先验分布为\n\n$$\n\\theta \\sim \\mathcal{N}\\!\\big(0, \\tau^{2}\\big).\n$$\n\n在 $\\sigma = 0.5$ 和 $\\tau = 5$ 的条件下，记录到单个观测值 $y_{\\text{obs}} = 9$。考虑基于此观测值对 $\\theta$ 进行贝叶斯推断。一位从业者使用高斯提议分布运行一个标准的随机游走 Metropolis-Hastings 马尔可夫链蒙特卡洛 (MCMC) 算法\n\n$$\nq(\\theta' \\mid \\theta) = \\mathcal{N}\\!\\big(\\theta, s^{2}\\big),\n$$\n\n其提议尺度为 $s = 0.2$，初始值为 $\\theta_{0} = 3.2$，并使用标准的 Metropolis-Hastings 接受准则。\n\n关于后验 $p(\\theta \\mid y_{\\text{obs}})$ 和所述的 MCMC 运行，以下哪个陈述最为准确？\n\nA. 后验密度在 $\\theta = 0$ 处是单峰的，因为似然仅通过 $\\theta^2$ 依赖于 $\\theta$；因此，提议尺度 $s = 0.2$ 的随机游走 Metropolis-Hastings 算法将在正负 $\\theta$ 值之间快速混合。\n\nB. 后验密度是双峰的，在 $\\theta \\approx \\pm 3$ 附近有两个对称的峰；由于提议尺度 $s = 0.2$ 很小且初始值为 $\\theta_{0} = 3.2$，随机游走 Metropolis-Hastings 链将倾向于长时间停留在正值峰附近，并可能在典型的运行长度内无法发现负值峰，从而可能给出误导性的单链收敛诊断。\n\nC. 后验密度是双峰的，并且根据细致平衡条件，在任何有限次运行中，无论提议尺度或初始值如何，链都必须在两个峰中花费相等的时间。\n\nD. 后验密度在 $\\theta$ 的整数值处有无数个峰；然而，高斯提议分布的对称性确保了即使 $s = 0.2$，链也能在这些峰之间频繁跳跃。",
            "solution": "首先将验证问题的科学性和逻辑一致性。\n\n### 步骤 1：提取已知条件\n-   测量模型 (似然): $y \\mid \\theta \\sim \\mathcal{N}(\\theta^{2}, \\sigma^{2})$，参数 $\\theta \\in \\mathbb{R}$。\n-   先验分布: $\\theta \\sim \\mathcal{N}(0, \\tau^{2})$。\n-   观测数据: 单个观测值 $y_{\\text{obs}} = 9$。\n-   已知常数: 噪声标准差 $\\sigma = 0.5$，先验标准差 $\\tau = 5$。\n-   MCMC 算法: 随机游走 Metropolis-Hastings。\n-   MCMC 提议分布: $q(\\theta' \\mid \\theta) = \\mathcal{N}(\\theta, s^{2})$。\n-   MCMC 参数: 提议尺度 $s = 0.2$，初始值 $\\theta_{0} = 3.2$。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述描述了一个用于参数估计的标准贝叶斯推断任务。指定的似然和先验分布是良定义的概率密度。该模型中，观测值与参数的平方加上高斯噪声成正比，这是信号处理和物理学中的常见情景（例如，从振幅测量功率）。提供的数值是合理且自洽的。问题要求分析后验分布和标准 MCMC 算法的行为，这是计算统计学和工程学中的一个适定问题。关于 $y$ 是一个“非负标量摘要”的陈述与给定参数下的高斯模型并不冲突，因为在给定 $y \\mid \\theta \\sim \\mathcal{N}(\\theta^2, 0.5^2)$ 和 $y_{\\text{obs}}=9$ 的条件下，$y  0$ 的概率可以忽略不计（对于 $\\pm 3$ 附近的相关 $\\theta$ 值，似然的均值距离 0 至少有 18 个标准差）。该问题有科学依据、适定、客观且完整。\n\n### 步骤 3：结论与行动\n问题陈述有效。将推导完整解法。\n\n### 后验分布的推导\n\n根据贝叶斯定理，在给定观测值 $y=y_{\\text{obs}}$ 的条件下，参数 $\\theta$ 的后验概率密度函数 (PDF) 与似然和先验的乘积成正比：\n$$\np(\\theta \\mid y) \\propto p(y \\mid \\theta) p(\\theta)\n$$\n似然函数由均值为 $\\theta^2$、方差为 $\\sigma^2$ 的正态分布的 PDF 给出：\n$$\np(y \\mid \\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y - \\theta^2)^2}{2\\sigma^2}\\right)\n$$\n先验分布是中心在 0、方差为 $\\tau^2$ 的正态分布：\n$$\np(\\theta) = \\frac{1}{\\sqrt{2\\pi\\tau^2}} \\exp\\left(-\\frac{\\theta^2}{2\\tau^2}\\right)\n$$\n结合这两者，后验分布为：\n$$\np(\\theta \\mid y) \\propto \\exp\\left(-\\frac{(y - \\theta^2)^2}{2\\sigma^2} - \\frac{\\theta^2}{2\\tau^2}\\right)\n$$\n为了分析该分布的形状，特别是找到其众数（局部最大值），使用对数后验会很方便。忽略加性常数，对数后验 $L(\\theta)$ 为：\n$$\nL(\\theta) = -\\frac{(y - \\theta^2)^2}{2\\sigma^2} - \\frac{\\theta^2}{2\\tau^2}\n$$\n后验的众数可以通过求 $L(\\theta)$ 对 $\\theta$ 的导数并将其设为零来找到：\n$$\n\\frac{dL}{d\\theta} = -\\frac{2(y - \\theta^2)(-2\\theta)}{2\\sigma^2} - \\frac{2\\theta}{2\\tau^2} = \\frac{2\\theta(y - \\theta^2)}{\\sigma^2} - \\frac{\\theta}{\\tau^2}\n$$\n令 $\\frac{dL}{d\\theta} = 0$：\n$$\n\\theta \\left( \\frac{2(y - \\theta^2)}{\\sigma^2} - \\frac{1}{\\tau^2} \\right) = 0\n$$\n当 $\\theta=0$ 或括号中的项为零时，此方程有解。\n1.  $\\theta = 0$ 是一个临界点。\n2.  $\\frac{2(y - \\theta^2)}{\\sigma^2} = \\frac{1}{\\tau^2} \\implies 2(y - \\theta^2) = \\frac{\\sigma^2}{\\tau^2} \\implies \\theta^2 = y - \\frac{\\sigma^2}{2\\tau^2}$。\n\n代入给定值 $y = 9$，$\\sigma = 0.5$ ($\\sigma^2 = 0.25$) 和 $\\tau = 5$ ($\\tau^2 = 25$)：\n$$\n\\theta^2 = 9 - \\frac{0.25}{2(25)} = 9 - \\frac{0.25}{50} = 9 - 0.005 = 8.995\n$$\n这给出了另外两个临界点：$\\theta \\approx \\pm\\sqrt{8.995} \\approx \\pm 2.999$。\n\n为了对这些临界点进行分类，我们检查二阶导数 $\\frac{d^2L}{d\\theta^2}$：\n$$\n\\frac{d^2L}{d\\theta^2} = \\frac{d}{d\\theta}\\left(\\frac{2y\\theta}{\\sigma^2} - \\frac{2\\theta^3}{\\sigma^2} - \\frac{\\theta}{\\tau^2}\\right) = \\frac{2y}{\\sigma^2} - \\frac{6\\theta^2}{\\sigma^2} - \\frac{1}{\\tau^2}\n$$\n-   在 $\\theta=0$ 处：$\\frac{d^2L}{d\\theta^2} = \\frac{2(9)}{0.25} - \\frac{1}{25} = 72 - 0.04 = 71.96 > 0$。这表示一个局部最小值。因此，$\\theta=0$ 是一个反众数（后验密度最小的点）。\n-   在 $\\theta^2=8.995$ 处：$\\frac{d^2L}{d\\theta^2} = \\frac{2(9)}{0.25} - \\frac{6(8.995)}{0.25} - \\frac{1}{25} = 72 - 6(35.98) - 0.04 = 72 - 215.88 - 0.04  0$。这表示一个局部最大值。\n\n因此，后验分布 $p(\\theta \\mid y_{\\text{obs}})$ 是双峰的，有两个位于 $\\theta \\approx \\pm 3$ 的对称峰，它们被 $\\theta = 0$ 附近的一个低概率区域分隔。\n\n### MCMC 算法分析\n\n指定的算法是一个随机游走 Metropolis-Hastings (RWMH) 采样器。链的初始值为 $\\theta_0 = 3.2$，非常接近于 $\\theta \\approx +3$ 处的正值峰。提议分布是一个窄高斯分布，$q(\\theta' \\mid \\theta) = \\mathcal{N}(\\theta, s^2)$，其尺度（标准差）很小，为 $s = 0.2$。\n\n为了使 MCMC 链能从整个后验分布中采样，它必须能够在两个峰之间移动。从正值峰（接近 $+3$）跳到负值峰（接近 $-3$）需要穿越 $\\theta = 0$ 附近的低概率“谷底”。当提议尺度很小（如 $s=0.2$）时，提议值 $\\theta'$ 将非常接近当前状态 $\\theta$。为了从一个峰跨越到另一个峰，链必须采取许多小步。任何从峰附近向 $\\theta=0$ 处的反众数移动的步骤都是向后验概率更低的区域移动。这类移动的接受概率小于 1，因此不受青睐。发生一系列这样不受青睐的移动的概率非常低。\n\n因此，从 $\\theta_0=3.2$ 开始的链将有效地探索正值峰周围的区域，但在跨越到负值峰时会遇到极大困难。对于任何实际的、有限次数的迭代（一个“典型的运行长度”），链很可能会“卡在”正值峰的吸引盆中。对这个单链的输出（例如，轨迹图）进行分析，可能会显示出良好的行为和表观收敛，但这将是收敛到一个仅代表真实后验分布一半的分布。这是 MCMC 在多峰设置中的一个典型问题，其中单链诊断可能具有危险的误导性。\n\n### 逐项分析\n\n**A. 后验密度在 $\\theta = 0$ 处是单峰的，因为似然仅通过 $\\theta^2$ 依赖于 $\\theta$；因此，提议尺度 $s = 0.2$ 的随机游走 Metropolis-Hastings 算法将在正负 $\\theta$ 值之间快速混合。**\n这个陈述是错误的。后验密度在 $\\theta = 0$ 处不是单峰的；我们的分析证明了它是双峰的，在 $\\theta = 0$ 处有一个反众数（局部最小值）。似然和先验的对称性创造了两个峰，而不是一个。此外，MCMC 链不会快速混合；小的提议尺度会将其困在一个峰中。\n结论：**错误**。\n\n**B. 后验密度是双峰的，在 $\\theta \\approx \\pm 3$ 附近有两个对称的峰；由于提议尺度 $s = 0.2$ 很小且初始值为 $\\theta_{0} = 3.2$，随机游走 Metropolis-Hastings 链将倾向于长时间停留在正值峰附近，并可能在典型的运行长度内无法发现负值峰，从而可能给出误导性的单链收敛诊断。**\n这个陈述与我们的推导完全一致。后验是双峰的，峰值在 $\\theta \\approx \\pm 3$ 附近。在给定的 MCMC 设置（在其中一个峰附近初始化，提议尺度小）下，链在两个峰之间的混合会很差，很可能被困在正值峰中。这种行为可能导致从单链得到误导性地乐观的收敛诊断。\n结论：**正确**。\n\n**C. 后验密度是双峰的，并且根据细致平衡条件，在任何有限次运行中，无论提议尺度或初始值如何，链都必须在两个峰中花费相等的时间。**\n这个陈述是错误的。虽然候验是双峰的，但关于 MCMC 行为的结论是有缺陷的。细致平衡属性确保链在无限步数的极限下收敛到正确的平稳分布。对于对称的后验，这意味着渐近地，链会花费相等的时间探索每个峰。然而，这个保证不适用于任何*有限次运行*，特别是当混合很差时。提议尺度和初始值是决定收敛速度和链探索整个状态空间速度的关键因素。像本题中这样的糟糕选择，会阻止链在有限次运行中访问所有峰。\n结论：**错误**。\n\n**D. 后验密度在 $\\theta$ 的整数值处有无数个峰；然而，高斯提议分布的对称性确保了即使 $s = 0.2$，链也能在这些峰之间频繁跳跃。**\n这个陈述是错误的。后验分布由两个与高斯函数相关的函数的乘积推导而来，其形式简单 ($L(\\theta) \\propto a\\theta^2 - b\\theta^4$)，只有两个峰，而不是无数个。峰值不在整数值处，而是在 $\\theta \\approx \\pm 2.999$ 处。提议分布的对称性并不能保证在遥远的峰之间的频繁跳跃；提议尺度是决定性因素，而在这里它太小了，无法促进这样的跳跃。\n结论：**错误**。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}