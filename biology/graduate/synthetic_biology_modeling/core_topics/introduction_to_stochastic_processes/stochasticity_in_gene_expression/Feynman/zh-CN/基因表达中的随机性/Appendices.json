{
    "hands_on_practices": [
        {
            "introduction": "基因表达本质上是一个随机过程，理解其噪声的来源是随机建模的第一步。启动子的“开”和“关”状态之间的随机切换是转录噪声的一个主要来源，这一现象通常用双态模型来描述。这个练习将引导你分析一个重要的极限情况——转录爆发（transcriptional bursting），并推导出mRNA计数的法诺因子（Fano factor）的简化表达式 ()。通过这个推导，你将理解为什么实验中观察到的mRNA分布通常比泊松分布（其法诺因子为1）具有更大的变异性。",
            "id": "2071177",
            "problem": "细胞内基因的表达通常是一个随机过程，这导致了蛋白质和信使RNA（mRNA）水平在细胞间存在变异。模拟这一现象的一个常用框架是转录的两态模型或随机电报模型。在此模型中，基因的启动子在活性状态（ON）和非活性状态（OFF）之间随机切换。\n\n启动子从OFF状态转换到ON状态的速率常数为 $k_{on}$，从ON状态返回到OFF状态的速率常数为 $k_{off}$。转录仅在启动子处于ON状态时发生，作为一个速率为 $k_{tx}$ 的泊松过程进行。一旦一个mRNA分子被合成，它会以降解速率为 $\\gamma$ 的一级速率常数发生降解。\n\n对于该模型，可以从数学上证明，每个细胞中mRNA分子数量的稳态均值 $\\langle n \\rangle$ 和方差 $\\sigma^2$ 由以下表达式给出：\n$$ \\langle n \\rangle = \\left(\\frac{k_{on}}{k_{on}+k_{off}}\\right) \\frac{k_{tx}}{\\gamma} $$\n$$ \\sigma^2 = \\langle n \\rangle + \\left(\\frac{k_{on}k_{off}}{(k_{on}+k_{off})^2}\\right) \\frac{k_{tx}^2}{\\gamma(k_{on}+k_{off}+\\gamma)} $$\n\n法诺因子定义为 $F = \\sigma^2 / \\langle n \\rangle$，是一个用于表征mRNA数量噪声的无量纲量度。法诺因子为1是泊松分布的特征。\n\n考虑一种被称为转录爆发的生物学机制。该机制的特点是启动子不频繁激活，且仅在短时间内保持活性。此外，这些启动子状态变化的时间尺度远快于mRNA分子的寿命。在数学上，这些条件对应于极限 $k_{off} \\gg k_{on}$ 和 $k_{off} \\gg \\gamma$。\n\n您的任务是在这种特定的转录爆发机制下，推导出一个关于法诺因子 $F$ 的简化的近似表达式。您的最终答案应该是一个用相关速率常数表示的解析表达式。",
            "solution": "我们从两态启动子模型中给出的mRNA拷贝数的均值和方差的定义开始：\n$$\\langle n \\rangle = \\left(\\frac{k_{on}}{k_{on}+k_{off}}\\right)\\frac{k_{tx}}{\\gamma}, \\quad \\sigma^{2} = \\langle n \\rangle + \\left(\\frac{k_{on}k_{off}}{(k_{on}+k_{off})^{2}}\\right)\\frac{k_{tx}^{2}}{\\gamma\\left(k_{on}+k_{off}+\\gamma\\right)}.$$\n法诺因子定义为 $F=\\sigma^{2}/\\langle n \\rangle$。代入上述表达式可得\n$$F=\\frac{\\langle n \\rangle}{\\langle n \\rangle}+\\frac{\\displaystyle \\left(\\frac{k_{on}k_{off}}{(k_{on}+k_{off})^{2}}\\right)\\frac{k_{tx}^{2}}{\\gamma\\left(k_{on}+k_{off}+\\gamma\\right)}}{\\displaystyle \\left(\\frac{k_{on}}{k_{on}+k_{off}}\\right)\\frac{k_{tx}}{\\gamma}}=1+\\frac{\\displaystyle \\frac{k_{on}k_{off}}{(k_{on}+k_{off})^{2}}\\cdot \\frac{k_{tx}^{2}}{\\gamma\\left(k_{on}+k_{off}+\\gamma\\right)}}{\\displaystyle \\frac{k_{on}}{k_{on}+k_{off}}\\cdot \\frac{k_{tx}}{\\gamma}}.$$\n通过对分子和分母进行适当的乘法运算来化简该比率，\n$$F=1+\\left[\\frac{k_{on}k_{off}}{(k_{on}+k_{off})^{2}}\\cdot \\frac{k_{tx}^{2}}{\\gamma\\left(k_{on}+k_{off}+\\gamma\\right)}\\right]\\cdot \\left[\\frac{\\gamma\\left(k_{on}+k_{off}\\right)}{k_{on}k_{tx}}\\right].$$\n消去公因式（$\\gamma$ 和一个 $k_{tx}$ 因子）并化简，\n$$F=1+\\frac{k_{off}k_{tx}}{(k_{on}+k_{off})\\left(k_{on}+k_{off}+\\gamma\\right)}.$$\n现在应用转录爆发机制的极限条件 $k_{off}\\gg k_{on}$ 和 $k_{off}\\gg \\gamma$。在这些条件下，取主导阶，\n$$k_{on}+k_{off}\\approx k_{off}, \\quad k_{on}+k_{off}+\\gamma\\approx k_{off}.$$\n代入这些近似值可得\n$$F\\approx 1+\\frac{k_{off}k_{tx}}{k_{off}\\cdot k_{off}}=1+\\frac{k_{tx}}{k_{off}},$$\n这便是在爆发机制下所求的简化表达式。",
            "answer": "$$\\boxed{1+\\frac{k_{tx}}{k_{off}}}$$"
        },
        {
            "introduction": "基因表达中的噪声会从mRNA传递到蛋白质，影响合成生物回路的稳定性和细胞命运决定的精确性。因此，一个核心的设计问题是如何在保持平均表达水平不变的情况下，最小化蛋白质水平的细胞间差异。这个练习 () 提出了一个经典的合成生物学权衡问题：是“强启动子/弱RBS”的组合更优，还是“弱启动子/强RBS”的组合更优？通过分析这个思想实验，你将揭示一个关于基因表达级联中噪声传播与调控的基本原则。",
            "id": "2071130",
            "problem": "一位合成生物学家正在细菌中设计一个遗传回路以产生一种荧光蛋白。目标是在细胞群体中实现特定的蛋白质表达平均水平，同时尽可能降低细胞间的变异性。蛋白质的表达由一个简单的两阶段模型控制：DNA以速率 $k_m$ 转录成信使RNA (mRNA)，然后每个mRNA分子以速率 $k_p$ 翻译成蛋白质。mRNA分子以降解速率 $\\gamma_m$ 降解，蛋白质分子以降解速率 $\\gamma_p$ 降解。转录速率 $k_m$ 由启动子强度决定，翻译速率 $k_p$ 由核糖体结合位点 (RBS) 的强度决定。\n\n该生物学家有两种构建体可供选择，分别标记为 Construct Alpha 和 Construct Beta。两种构建体都使用相同的荧光蛋白基因，并在相同的细菌菌株中表达，因此它们的mRNA和蛋白质降解速率 $\\gamma_m$ 和 $\\gamma_p$ 是相同的。这两种构建体仅在其启动子和RBS序列上有所不同。\n\n- **Construct Alpha** 使用强启动子和弱RBS。\n- **Construct Beta** 使用弱启动子和强RBS。\n\n这些强度经过调节，使得两种构建体的转录速率和翻译速率的乘积相同，确保它们在稳态下每个细胞产生相同平均数量的蛋白质分子。具体来说，设Construct Alpha的速率为 $k_{m,A}$ 和 $k_{p,A}$，Construct Beta的速率为 $k_{m,B}$ 和 $k_{p,B}$。以下关系成立：$k_{m,A} > k_{m,B}$，$k_{p,A} < k_{p,B}$，且 $k_{m,A} k_{p,A} = k_{m,B} k_{p,B}$。\n\n假设蛋白质比mRNA稳定得多（即 $\\gamma_p \\ll \\gamma_m$）。生物学家应该选择哪种构建体以实现较低的蛋白质水平细胞间变异性？\n\nA. Construct Alpha 的变异性会更低。\n\nB. Construct Beta 的变异性会更低。\n\nC. 两种构建体的变异性相同，因为它们的平均表达水平相同。\n\nD. 如果没有降解速率 $\\gamma_m$ 和 $\\gamma_p$ 的具体数值，则无法确定变异性。",
            "solution": "我们使用标准的两阶段生灭过程来模拟表达。mRNA以速率 $k_{m}$ 产生，以速率 $\\gamma_{m}$ 降解；蛋白质由mRNA以速率 $k_{p}$ 产生，以速率 $\\gamma_{p}$ 降解。在稳态下，\n$$\n\\bar{M} = \\frac{k_{m}}{\\gamma_{m}}, \\qquad \\bar{P} = \\mu = \\frac{k_{p}}{\\gamma_{p}} \\bar{M} = \\frac{k_{m} k_{p}}{\\gamma_{m} \\gamma_{p}}.\n$$\n为了比较细胞间的变异性，我们从线性反应网络的确切矩方程计算蛋白质的稳态方差。令 $M$ 和 $P$ 分别表示mRNA和蛋白质的随机拷贝数。使用线性反应的化学主方程，二阶矩的稳态方程得出：\n- 对于mRNA，因为它是一个简单的生灭过程，$\\operatorname{Var}(M) = \\bar{M} = \\frac{k_{m}}{\\gamma_{m}}$ 且 $E[M^{2}] = \\operatorname{Var}(M) + \\bar{M}^{2} = \\frac{k_{m}}{\\gamma_{m}} + \\frac{k_{m}^{2}}{\\gamma_{m}^{2}}$。\n- 对于交叉矩 $E[MP]$，稳态方程为\n$$\n0 = k_{m} \\bar{P} + k_{p} E[M^{2}] - (\\gamma_{m} + \\gamma_{p}) E[MP],\n$$\n因此\n$$\nE[MP] = \\frac{k_{m} \\mu + k_{p} E[M^{2}]}{\\gamma_{m} + \\gamma_{p}} = \\frac{k_{p}}{\\gamma_{m} + \\gamma_{p}} \\left( \\frac{k_{m}^{2}}{\\gamma_{m} \\gamma_{p}} + \\frac{k_{m}}{\\gamma_{m}} + \\frac{k_{m}^{2}}{\\gamma_{m}^{2}} \\right).\n$$\n- 对于 $E[P^{2}]$，稳态方程给出\n$$\n0 = 2 k_{p} E[MP] + k_{p} \\bar{M} - 2 \\gamma_{p} E[P^{2}] + \\gamma_{p} \\mu,\n$$\n因此\n$$\nE[P^{2}] = \\frac{1}{2 \\gamma_{p}} \\left( 2 k_{p} E[MP] + k_{p} \\bar{M} + \\gamma_{p} \\mu \\right).\n$$\n将上述表达式代入并简化，可以通过引入标准爆发参数来方便进行\n$$\nb \\equiv \\frac{k_{p}}{\\gamma_{m}}, \\qquad f \\equiv \\frac{k_{m}}{\\gamma_{p}}, \\qquad r \\equiv \\frac{\\gamma_{p}}{\\gamma_{m}},\n$$\n这样 $\\mu = \\bar{P} = b f$。经过代数简化后，可以发现\n$$\nE[P^{2}] = b^{2} f^{2} + b f + \\frac{b^{2} f}{1 + r}.\n$$\n因此蛋白质的方差为\n$$\n\\operatorname{Var}(P) = E[P^{2}] - \\mu^{2} = \\mu + \\frac{b \\mu}{1 + r} = \\mu \\left( 1 + \\frac{b}{1 + r} \\right).\n$$\n等价地，法诺因子为\n$$\n\\frac{\\operatorname{Var}(P)}{\\mu} = 1 + \\frac{b}{1 + r},\n$$\n而变异系数的平方为\n$$\n\\operatorname{CV}^{2} = \\frac{\\operatorname{Var}(P)}{\\mu^{2}} = \\frac{1}{\\mu} \\left( 1 + \\frac{b}{1 + r} \\right).\n$$\n在所述的蛋白质比mRNA稳定得多的条件下，$\\gamma_{p} \\ll \\gamma_{m}$，所以 $r \\ll 1$ 并且\n$$\n\\frac{\\operatorname{Var}(P)}{\\mu} \\approx 1 + b, \\qquad \\operatorname{Var}(P) \\approx \\mu (1 + b).\n$$\n对于固定的平均值 $\\mu = b f$，变异性随 $b = \\frac{k_{p}}{\\gamma_{m}}$ 单调增加，随 $f = \\frac{k_{m}}{\\gamma_{p}}$ 单调减少。因此，要在固定平均值下最小化变异性，应选择较小的 $k_{p}$ 和较大的 $k_{m}$，即强启动子和弱RBS。\n\n给定 $k_{m,A} > k_{m,B}$，$k_{p,A}  k_{p,B}$，以及 $k_{m,A} k_{p,A} = k_{m,B} k_{p,B}$，可以得出 $b_{A} = \\frac{k_{p,A}}{\\gamma_{m}}  b_{B} = \\frac{k_{p,B}}{\\gamma_{m}}$，而两种构建体的 $\\mu$ 相同。因此，Construct Alpha 具有较低的细胞间变异性。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理论模型的最终价值在于其解释和预测实验数据的能力。本章的最后一个练习旨在连接抽象的随机模型与真实的单细胞观测数据。在这个练习中 ()，你将扮演一个计算生物学家的角色，利用谱系追踪实验中获得的关于母细胞和子细胞蛋白质数量的数据，来推断一个关键的生物学参数——细胞分裂过程中的分子分配比例。通过应用最大似然估计等统计学方法，你将体验如何从实验数据中量化随机过程，完成从理论到实践的闭环。",
            "id": "3932921",
            "problem": "考虑一个基于细胞谱系的随机基因表达模型，其中单个细胞谱系通过连续的分裂进行追踪。设 $X(t)$ 表示在时间 $t$ 时被追踪细胞中报告蛋白的分子拷贝数。在分裂间期，$X(t)$ 作为一个连续时间的生灭过程演化，代表合成和降解，其合成速率为 $k_s$，降解速率为 $k_d$。在离散的分裂时间 $t = T_i$，被追踪的细胞分裂成两个子细胞，母细胞在分裂前的分子数记为 $N_i = X(T_i^{-})$。分裂后，任意选择一个子细胞来延续该谱系。分子根据独立的伯努利试验被分配到被追踪的子细胞中：$N_i$ 个分子中的每一个都以概率 $r \\in (0,1)$ 独立地最终进入被追踪的子细胞，我们称之为分配参数。因此，在给定 $N_i$ 的条件下，被追踪子细胞在分裂后瞬间的分子数 $Y_i = X(T_i^{+})$ 是一个服从二项分布的随机变量。\n\n假设延时单细胞测量为谱系中的每个分裂事件提供了由分裂前分子数和分裂后被追踪子细胞的瞬间分子数组成的配对 $(N_i, Y_i)$。假设在给定 $N_i$ 的条件下，不同分裂事件中的分配过程是独立同分布的，且具有相同的参数 $r$。\n\n任务：\n1. 从分裂时独立伯努利试验的定义出发，推导在给定观测序列 $\\{(N_i, Y_i)\\}_{i=1}^m$ 的情况下 $r$ 的似然函数，并从中获得以观测计数表示的 $r$ 的最大似然估计量。证明为什么分裂间期的生灭动态不影响在分裂时刻给定 $N_i$ 时 $Y_i$ 的条件分布。\n2. 使用基于二项分布反演的精确方法，构造一个置信水平为 $1 - \\alpha$（其中 $\\alpha = 0.05$）的 $r$ 的双边置信区间，不依赖正态近似。清楚地说明如何处理总成功次数等于 $0$ 或等于总试验次数的边界情况。\n\n您的程序必须为以下测试套件实现这些任务。对于每个测试用例，您将获得一个分裂前计数的列表 $[N_1,\\dots,N_m]$ 和一个相应的分裂后被追踪子细胞计数的列表 $[Y_1,\\dots,Y_m]$：\n\n- 测试用例 1 (一般情况): $[104,87,96,110]$ 和 $[58,46,51,62]$。\n- 测试用例 2 (接近对称): $[50,50,50,50,50]$ 和 $[25,26,24,22,28]$。\n- 测试用例 3 (不对称分配): $[60,55,70]$ 和 $[10,9,12]$。\n- 测试用例 4 (零边界): $[3,2,1]$ 和 $[0,0,0]$。\n- 测试用例 5 (一边界): $[4,3,1,2]$ 和 $[4,3,1,2]$。\n- 测试用例 6 (大计数): $[1000,1200,900,800]$ 和 $[550,660,495,440]$。\n\n对于每个测试用例：\n- 计算最大似然估计 $\\hat r$。\n- 计算置信水平为 $1 - \\alpha$（其中 $\\alpha = 0.05$）的双边精确置信区间的下限和上限 $(r_{\\text{L}}, r_{\\text{U}})$。\n- 将每个数值结果四舍五入到六位小数。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是列表 $[\\hat r, r_{\\text{L}}, r_{\\text{U}}]$。例如，输出必须看起来像 $[[\\hat r_1, r_{\\text{L},1}, r_{\\text{U},1}],[\\hat r_2, r_{\\text{L},2}, r_{\\text{U},2}],\\dots]$，不含空格。",
            "solution": "该问题陈述已经过验证，被认为是合理的。它在科学上基于随机基因表达的标准模型，在数学上是适定的、客观的，并包含了推导唯一且有意义的解所需的所有必要信息。\n\n任务是就基因表达的谱系模型中的分配参数 $r$ 进行统计推断。这包括两部分：首先，推导 $r$ 的最大似然估计量 (MLE)；其次，构造 $r$ 的精确置信区间。\n\n**1. 分配参数 $r$ 的最大似然估计量 (MLE)**\n\n问题陈述指出，在每次分裂 $i$ 中，一个拥有 $N_i$ 个分子的母细胞将其分配到一个被追踪的子细胞中，使得每个分子以概率 $r$ 被独立继承。这是一个包含 $N_i$ 次伯努利试验的序列的定义，其中“成功”是指一个分子最终进入被追踪的子细胞。因此，总成功次数 $Y_i$ 在给定试验次数 $N_i$ 的条件下，服从二项分布。其概率质量函数 (PMF) 为：\n$$P(Y_i = y_i | N_i = n_i, r) = \\binom{n_i}{y_i} r^{y_i} (1-r)^{n_i-y_i}$$\n其中 $\\binom{n_i}{y_i}$ 是二项式系数。\n\n我们给定一个包含 $m$ 个独立观测值的序列 $\\{(N_i, Y_i)\\}_{i=1}^m$。不同分裂事件中分配过程的独立性使我们能够将给定观测数据时参数 $r$ 的总似然写成各个条件概率的乘积：\n$$L(r; \\{ (N_i, Y_i) \\}) = P(\\{Y_i\\} | \\{N_i\\}, r) = \\prod_{i=1}^{m} P(Y_i | N_i, r)$$\n代入二项分布的 PMF，我们得到：\n$$L(r) = \\prod_{i=1}^{m} \\binom{N_i}{Y_i} r^{Y_i} (1-r)^{N_i-Y_i}$$\n为了找到 MLE $\\hat{r}$，我们关于 $r$ 最大化此似然函数。在计算上，最大化对数似然函数 $\\ell(r) = \\ln L(r)$ 更为简单，因为对数是单调函数。\n$$\\ell(r) = \\ln\\left( \\prod_{i=1}^{m} \\binom{N_i}{Y_i} r^{Y_i} (1-r)^{N_i-Y_i} \\right) = \\sum_{i=1}^{m} \\ln\\left( \\binom{N_i}{Y_i} r^{Y_i} (1-r)^{N_i-Y_i} \\right)$$\n$$\\ell(r) = \\sum_{i=1}^{m} \\left( \\ln\\binom{N_i}{Y_i} + Y_i \\ln r + (N_i - Y_i) \\ln(1-r) \\right)$$\n为了找到最大值，我们计算 $\\ell(r)$ 关于 $r$ 的导数并将其设为零：\n$$\\frac{d\\ell(r)}{dr} = \\sum_{i=1}^{m} \\left( \\frac{Y_i}{r} - \\frac{N_i - Y_i}{1-r} \\right) = 0$$\n$$\\frac{1}{r} \\sum_{i=1}^{m} Y_i - \\frac{1}{1-r} \\sum_{i=1}^{m} (N_i - Y_i) = 0$$\n设 $Y_{\\text{tot}} = \\sum_{i=1}^{m} Y_i$ 为分裂后在被追踪的子细胞中观测到的分子总数，而 $N_{\\text{tot}} = \\sum_{i=1}^{m} N_i$ 为分裂前母细胞中的分子总数。方程变为：\n$$\\frac{Y_{\\text{tot}}}{\\hat{r}} = \\frac{N_{\\text{tot}} - Y_{\\text{tot}}}{1-\\hat{r}}$$\n求解 $\\hat{r}$：\n$$Y_{\\text{tot}}(1-\\hat{r}) = \\hat{r}(N_{\\text{tot}} - Y_{\\text{tot}})$$\n$$Y_{\\text{tot}} - Y_{\\text{tot}}\\hat{r} = N_{\\text{tot}}\\hat{r} - Y_{\\text{tot}}\\hat{r}$$\n$$Y_{\\text{tot}} = N_{\\text{tot}}\\hat{r}$$\n因此，$r$ 的最大似然估计量为：\n$$\\hat{r} = \\frac{\\sum_{i=1}^{m} Y_i}{\\sum_{i=1}^{m} N_i} = \\frac{Y_{\\text{tot}}}{N_{\\text{tot}}}$$\n这个结果是直观的：对于分配概率的最佳估计是总观测成功次数与总试验次数的比率。\n\n控制蛋白质计数 $X(t)$ 的生灭动态（合成速率 $k_s$，降解速率 $k_d$）决定了 $N_i$ 的概率分布。然而，任务是基于条件概率 $P(Y_i | N_i, r)$ 来找到 $r$ 的 MLE。根据条件概率的定义，我们是在分裂前计数已知为 $N_i$ 的条件下分析系统。导致该状态的随机过程与随后的、独立的物理分配过程无关。分配机制被定义为仅依赖于分裂时刻存在的分子数 $N_i$ 和参数 $r$。因此，分裂间动态不影响给定观测配对 $(N_i, Y_i)$ 时 $r$ 的条件似然。\n\n**2. $r$ 的精确双边置信区间**\n\n二项分布的一个关键特性是，对于固定的成功概率，它具有可加性。由于每个 $Y_i \\sim \\text{Binomial}(N_i, r)$ 且分裂事件是独立的，它们的和 $Y_{\\text{tot}} = \\sum_{i=1}^m Y_i$ 也服从二项分布，其参数等于试验次数的总和和相同的成功概率：\n$$Y_{\\text{tot}} \\sim \\text{Binomial}(N_{\\text{tot}}, r)$$\n其中 $N_{\\text{tot}} = \\sum_{i=1}^m N_i$。因此，给定观测集合 $\\{ (N_i, Y_i) \\}_{i=1}^m$ 求 $r$ 的置信区间的问题，等价于为单个有 $N_{\\text{tot}}$ 次试验和 $Y_{\\text{tot}}$ 次观测成功的二项试验的成功概率 $r$ 寻找置信区间。\n\n问题要求使用一种精确方法，即 Clopper-Pearson 区间。该方法基于反演两个单边假设检验。对于给定的试验次数 $n = N_{\\text{tot}}$ 和成功次数 $k = Y_{\\text{tot}}$，一个 $1-\\alpha$ 置信区间 $[r_{\\text{L}}, r_{\\text{U}}]$ 的构造使得：\n下界 $r_{\\text{L}}$ 是使得观测到 $k$ 次或更多次成功的概率为 $\\alpha/2$ 的 $r$ 值：\n$$P(X \\ge k | r = r_{\\text{L}}) = \\sum_{j=k}^{n} \\binom{n}{j} r_{\\text{L}}^j (1-r_{\\text{L}})^{n-j} = \\frac{\\alpha}{2}$$\n上界 $r_{\\text{U}}$ 是使得观测到 $k$ 次或更少次成功的概率为 $\\alpha/2$ 的 $r$ 值：\n$$P(X \\le k | r = r_{\\text{U}}) = \\sum_{j=0}^{k} \\binom{n}{j} r_{\\text{U}}^j (1-r_{\\text{U}})^{n-j} = \\frac{\\alpha}{2}$$\n这些方程可以数值求解。二项累积分布函数 (CDF) 和正则化不完全贝塔函数之间存在直接关系，这简化了计算。界限由贝塔分布的分位数给出：\n$r_{\\text{L}}$ 是参数为 $(k, n-k+1)$ 的贝塔分布的 $\\alpha/2$ 分位数：\n$$r_{\\text{L}} = \\text{Beta}(\\alpha/2; k, n-k+1)$$\n$r_{\\text{U}}$ 是参数为 $(k+1, n-k)$ 的贝塔分布的 $1-\\alpha/2$ 分位数：\n$$r_{\\text{U}} = \\text{Beta}(1-\\alpha/2; k+1, n-k)$$\n其中 $\\text{Beta}(q; a, b)$ 表示形状参数为 $a$ 和 $b$ 的贝塔分布的第 $q$ 个分位数（逆累积分布函数）。指定的置信水平为 $1-\\alpha = 0.95$，因此 $\\alpha=0.05$ 且 $\\alpha/2 = 0.025$。\n\n必须正确处理边界情况：\n- 如果 $k = 0$（没有成功，例如测试用例 4），则 MLE 为 $\\hat{r}=0$。下界自然是 $r_{\\text{L}} = 0$。上界通过求解 $P(X \\le 0 | r=r_{\\text{U}}) = (1-r_{\\text{U}})^n = \\alpha/2$ 来找到，这给出 $r_{\\text{U}} = 1 - (\\alpha/2)^{1/n}$。这对应于 $\\text{Beta}(1-\\alpha/2; 1, n)$。\n- 如果 $k = n$（所有试验都成功，例如测试用例 5），则 MLE 为 $\\hat{r}=1$。上界自然是 $r_{\\text{U}} = 1$。下界通过求解 $P(X \\ge n | r=r_{\\text{L}}) = r_{\\text{L}}^n = \\alpha/2$ 来找到，这给出 $r_{\\text{L}} = (\\alpha/2)^{1/n}$。这对应于 $\\text{Beta}(\\alpha/2; n, 1)$。\n\n每个测试用例的计算过程是，首先计算 $N_{\\text{tot}} = \\sum N_i$ 和 $Y_{\\text{tot}} = \\sum Y_i$，然后计算 $\\hat{r} = Y_{\\text{tot}}/N_{\\text{tot}}$，最后使用贝塔分布的分位数（其中 $n = N_{\\text{tot}}$，$k = Y_{\\text{tot}}$）计算 $r_{\\text{L}}$ 和 $r_{\\text{U}}$，同时遵守边界条件。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import beta\n\ndef solve():\n    \"\"\"\n    Solves the stochastic gene expression partitioning problem for multiple test cases.\n\n    For each case, it calculates the Maximum Likelihood Estimate (MLE) of the partitioning\n    parameter r and its 95% exact confidence interval (Clopper-Pearson).\n    \"\"\"\n\n    test_cases = [\n        # Test Case 1 (general case)\n        {'N': [104, 87, 96, 110], 'Y': [58, 46, 51, 62]},\n        # Test Case 2 (near symmetry)\n        {'N': [50, 50, 50, 50, 50], 'Y': [25, 26, 24, 22, 28]},\n        # Test Case 3 (asymmetric partitioning)\n        {'N': [60, 55, 70], 'Y': [10, 9, 12]},\n        # Test Case 4 (boundary at zero)\n        {'N': [3, 2, 1], 'Y': [0, 0, 0]},\n        # Test Case 5 (boundary at one)\n        {'N': [4, 3, 1, 2], 'Y': [4, 3, 1, 2]},\n        # Test Case 6 (large counts)\n        {'N': [1000, 1200, 900, 800], 'Y': [550, 660, 495, 440]},\n    ]\n\n    results = []\n    alpha = 0.05\n\n    for case in test_cases:\n        N_list = case['N']\n        Y_list = case['Y']\n\n        # Calculate total pre-division and post-division counts\n        N_tot = np.sum(N_list)\n        Y_tot = np.sum(Y_list)\n\n        # Task 1: Calculate the Maximum Likelihood Estimator (MLE)\n        if N_tot == 0:\n            # Handle the undefined case, although not expected from test data\n            r_hat = np.nan\n        else:\n            r_hat = Y_tot / N_tot\n\n        # Task 2: Calculate the exact (Clopper-Pearson) confidence interval\n        n = N_tot\n        k = Y_tot\n        \n        r_L = 0.0\n        r_U = 1.0\n\n        if n  0: # Proceed only if there are trials\n            # Lower bound\n            if k == 0:\n                r_L = 0.0\n            else:\n                # r_L is the alpha/2 quantile of Beta(k, n-k+1)\n                r_L = beta.ppf(alpha / 2, k, n - k + 1)\n            \n            # Upper bound\n            if k == n:\n                r_U = 1.0\n            else:\n                # r_U is the 1-alpha/2 quantile of Beta(k+1, n-k)\n                r_U = beta.ppf(1 - alpha / 2, k + 1, n - k)\n        else: # Case where N_tot is 0\n            r_L = np.nan\n            r_U = np.nan\n\n        # Format results to six decimal places\n        # Using f-string formatting ensures trailing zeros and rounding\n        formatted_r_hat = f\"{r_hat:.6f}\"\n        formatted_r_L = f\"{r_L:.6f}\"\n        formatted_r_U = f\"{r_U:.6f}\"\n\n        results.append(f\"[{formatted_r_hat},{formatted_r_L},{formatted_r_U}]\")\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}