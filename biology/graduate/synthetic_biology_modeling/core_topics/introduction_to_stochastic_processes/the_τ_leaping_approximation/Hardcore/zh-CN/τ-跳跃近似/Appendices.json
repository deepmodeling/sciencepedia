{
    "hands_on_practices": [
        {
            "introduction": "τ-跳跃方法的一个关键在于如何选择一个有效的时间步长τ。本练习将通过一个简单的基因表达模型，让您亲手实践如何从“跨越条件”这一核心概念出发，推导出τ的选择规则。这有助于您深入理解如何通过控制反应倾向性的变化速率来保证近似的准确性。",
            "id": "3938166",
            "problem": "在一个用于合成生物学回路的单基因表达模型中，蛋白质种类 $X$ 的分子数 $x$ 的演化遵循一个连续时间、离散状态的马尔可夫过程，该过程由化学主方程（CME）下的两个反应通道控制：一个零级合成反应，其倾向为 $a_{1}(x)=c_{s}$，化学计量数为 $\\nu_{1}=+1$；以及一个一级降解反应，其倾向为 $a_{2}(x)=c_{d}\\,x$，化学计量数为 $\\nu_{2}=-1$。其中，$x$ 是当前分子数，$c_{s}0$ 是合成速率常数，$c_{d}0$ 是降解速率常数。假设时间单位为分钟，$c_{s}$ 的单位为分子/分钟，$c_{d}$ 的单位为/分钟，$x$ 的单位为分子。\n\n使用 $\\tau$-跳跃近似法，强制执行跳跃条件：在时长为 $\\tau$ 的一次跳跃中，每个倾向函数的相对变化幅值受一个小参数 $\\epsilon$ 的限制。为此，通过对当前状态进行一阶泰勒展开来线性化倾向向量，并用状态增量在跳跃下的期望值来替代状态增量。使用关于 $x$ 的雅可比矩阵来形式化此界限。取 $\\epsilon=0.03$。\n\n仅根据这些原理，推导出在当前状态 $x$ 下，基于雅可比矩阵的界限所允许的最大 $\\tau$ 的闭式表达式。将最终结果表示为 $c_{s}$、$c_{d}$ 和 $x$ 的简化符号函数，并代入 $\\epsilon$ 的数值。以分钟表示 $\\tau$，但不要在最终的方框答案中包含单位。如果出现任何特殊情况，请在推导中清楚地说明，但最终答案需提供一个单一的闭式表达式。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 步骤 1：提取给定信息\n-   **系统**：一个针对蛋白质种类 $X$ 的单基因表达模型。\n-   **动力学**：由化学主方程（CME）控制，作为一个连续时间、离散状态的马尔可夫过程。\n-   **反应 1（合成）**：零级，倾向 $a_{1}(x)=c_{s}$，化学计量数 $\\nu_{1}=+1$。\n-   **反应 2（降解）**：一级，倾向 $a_{2}(x)=c_{d}\\,x$，化学计量数 $\\nu_{2}=-1$。\n-   **变量和常数**：\n    -   $x$：种类 $X$ 的当前分子数。\n    -   $c_{s}$：合成速率常数，$c_{s}  0$。\n    -   $c_{d}$：降解速率常数，$c_{d}  0$。\n-   **假设与方法**：\n    -   模拟使用 $\\tau$-跳跃近似法。\n    -   跳跃时长 $\\tau$ 受跳跃条件约束：每个倾向函数幅值的相对变化受 $\\epsilon$ 限制。\n    -   **约束公式**：$|a_j(x(t+\\tau)) - a_j(x(t))| / a_j(x(t)) \\le \\epsilon$。\n    -   **线性化**：倾向的变化量 $a_j(x(t+\\tau)) - a_j(x(t))$，通过在当前状态 $x(t)$ 附近进行一阶泰勒展开来近似。\n    -   **状态增量近似**：泰勒展开中的状态增量 $\\Delta x$ 被其在跳跃 $\\tau$ 期间的期望值 $E[\\Delta x]$ 替代。\n    -   **雅可比矩阵**：使用关于 $x$ 的倾向向量的雅可比矩阵来形式化线性化界限。\n-   **参数值**：$\\epsilon = 0.03$。\n-   **目标**：推导允许的最大 $\\tau$ 作为 $c_{s}$、$c_{d}$ 和 $x$ 的函数的闭式表达式。\n\n### 步骤 2：使用提取的信息进行验证\n1.  **科学基础**：该问题描述了一个典型的生灭过程，这是随机化学动力学和系统生物学中的一个基本模型。$\\tau$-跳跃算法是一种标准的、有科学依据的方法，用于近似此类系统的随机模拟算法（SSA）。所描述的基于限制倾向相对变化的时间步长选择准则是一种已知且有效的技术。该问题牢固地植根于计算生物学和应用数学的原理。\n2.  **适定性**：该问题清楚地定义了模型、模拟方法、要使用的特定时间步长选择规则的变体以及期望的输出。所有必要的参数和关系都已提供。这种结构允许推导出唯一的解析表达式。\n3.  **客观性**：该问题以精确的数学术语陈述，没有任何主观或模糊的语言。\n\n问题陈述是自洽的、科学上合理的、并且在数学上是适定的。没有矛盾、关键信息缺失或伪科学主张。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供详细的解答。\n\n### $\\tau$-跳跃时间步长的推导\n\n系统由单一物种 $X$ 组成，其分子数为 $x$。系统的状态是标量 $x$。存在两个具有各自倾向的反应通道：\n1.  合成：$a_{1}(x) = c_{s}$，化学计量数为 $\\nu_{1} = +1$。\n2.  降解：$a_{2}(x) = c_{d}x$，化学计量数为 $\\nu_{2} = -1$。\n\n问题陈述指出，必须选择时间步长 $\\tau$，使得每个倾向函数的相对变化受小参数 $\\epsilon$ 的限制。对于每个反应 $j \\in \\{1, 2\\}$，此条件为：\n$$\n\\frac{| a_{j}(x(t+\\tau)) - a_{j}(x(t)) |}{a_{j}(x(t))} \\le \\epsilon\n$$\n其中 $x(t)$ 是跳跃开始时的状态。我们将 $x(t)$ 记为 $x$。跳跃结束时的状态是 $x(t+\\tau) = x + \\Delta x$，其中 $\\Delta x$ 是在时间间隔 $\\tau$ 内分子数的变化量。\n\n问题要求使用关于状态 $x$ 的一阶泰勒展开来线性化倾向的变化量 $a_{j}(x + \\Delta x) - a_{j}(x)$：\n$$\na_{j}(x + \\Delta x) - a_{j}(x) \\approx \\frac{\\partial a_{j}(x)}{\\partial x} \\Delta x\n$$\n倾向关于 $x$ 的偏导数构成了倾向向量的雅可比矩阵。对于我们的系统：\n$$\n\\frac{\\partial a_{1}(x)}{\\partial x} = \\frac{\\partial}{\\partial x}(c_{s}) = 0\n$$\n$$\n\\frac{\\partial a_{2}(x)}{\\partial x} = \\frac{\\partial}{\\partial x}(c_{d}x) = c_{d}\n$$\n接下来，问题要求用其期望值 $E[\\Delta x]$ 替代随机状态增量 $\\Delta x$。在 $\\tau$-跳跃框架中，反应 $j$ 在 $[t, t+\\tau]$ 时间内发生的次数是一个泊松随机变量 $K_j \\sim \\text{Poisson}(a_j(x)\\tau)$。其期望值为 $E[K_j] = a_j(x)\\tau$。$x$ 的总期望变化是每个反应期望变化的总和：\n$$\nE[\\Delta x] = \\sum_{j=1}^{2} \\nu_{j} E[K_{j}] = \\sum_{j=1}^{2} \\nu_{j} a_{j}(x) \\tau\n$$\n代入给定值：\n$$\nE[\\Delta x] = (\\nu_{1}a_{1}(x) + \\nu_{2}a_{2}(x))\\tau = ((+1)c_{s} + (-1)c_{d}x)\\tau = (c_{s} - c_{d}x)\\tau\n$$\n现在我们将线性化的倾向变化（其中 $\\Delta x$ 被 $E[\\Delta x]$ 替代）代回到跳跃条件不等式中：\n$$\n\\frac{|\\frac{\\partial a_{j}(x)}{\\partial x} E[\\Delta x]|}{a_{j}(x)} \\le \\epsilon\n$$\n$$\n\\frac{|\\frac{\\partial a_{j}(x)}{\\partial x} (c_{s} - c_{d}x)\\tau|}{a_{j}(x)} \\le \\epsilon\n$$\n我们必须对两个反应都满足此条件，以找到对整个系统都有效的单一最大 $\\tau$。\n\n**对于反应 1 ($j=1$)：**\n$$\n\\frac{|0 \\cdot (c_{s} - c_{d}x)\\tau|}{c_{s}} \\le \\epsilon \\implies \\frac{0}{c_{s}} \\le \\epsilon \\implies 0 \\le \\epsilon\n$$\n由于 $\\epsilon = 0.03  0$，此条件总是满足，并且不对 $\\tau$ 施加上限。\n\n**对于反应 2 ($j=2$)：**\n$$\n\\frac{|c_{d} \\cdot (c_{s} - c_{d}x)\\tau|}{c_{d}x} \\le \\epsilon\n$$\n由于 $c_{d}  0$ 且我们考虑 $x \\ge 0$，我们可以简化此表达式。对于 $x  0$：\n$$\n\\frac{c_{d} |(c_{s} - c_{d}x)\\tau|}{c_{d}x} \\le \\epsilon\n$$\n$$\n\\frac{|c_{s} - c_{d}x| \\tau}{x} \\le \\epsilon\n$$\n由于 $\\tau$ 必须为非负，并且我们正在寻找可能的最大 $\\tau$，我们解出 $\\tau$：\n$$\n\\tau \\le \\frac{\\epsilon x}{|c_{s} - c_{d}x|}\n$$\n总的时间步长 $\\tau$ 必须满足最严格的约束，在本例中该约束仅由反应 2 提供。因此，根据这一特定准则，$\\tau$ 的最大允许值为：\n$$\n\\tau = \\frac{\\epsilon x}{|c_{s} - c_{d}x|}\n$$\n我们现在分析此表达式的特殊情况。\n-   **情况 1：$x = 0$**。倾向 $a_{2}(0)=0$，因此相对变化在形式上是未定义的。然而，我们推导的公式给出 $\\tau = \\frac{\\epsilon \\cdot 0}{|c_s - 0|} = 0$。这是一个合理的结果；任何合成事件（$x=0 \\to x=1$）都会导致降解倾向发生无限大的相对变化（从 $0$ 到 $c_d$），因此时间步长必须缩小到零以维持跳跃条件。\n-   **情况 2：$c_{s} - c_{d}x = 0$**，这在 $x = c_{s}/c_{d}$ 时发生。这是系统的确定性稳态。在此状态下，分子数的期望净变化为零，$E[\\Delta x] = 0$。因此，所有反应倾向变化的线性化估计也为零。对于任何 $\\tau$ 值，跳跃条件都得到满足，这意味着 $\\tau \\to \\infty$。我们的公式通过分母为零来反映这一点。实际的实现会把 $\\tau$ 上限设为一个预定义的最大值，但仅根据问题中阐述的原理，该界限是无限的。\n\n问题要求一个单一的闭式表达式。推导出的公式满足此目的，并需理解其在这些特定点的行为。最后，我们代入给定的 $\\epsilon=0.03$ 值：\n$$\n\\tau = \\frac{0.03 x}{|c_{s} - c_{d}x|}\n$$\n这是以分钟为单位的最大允许时间步长 $\\tau$ 的最终符号表达式。",
            "answer": "$$\n\\boxed{\\frac{0.03 x}{|c_{s} - c_{d}x|}}\n$$"
        },
        {
            "introduction": "选定时间步长后，下一步是理解随机更新本身的统计特性。本练习要求您推导在单个τ-跳跃中，一个物种分子数变化的精确均值和方差。这种从第一性原理出发的推导，将巩固您对泊松激发假设与驱动系统演化的矩（moments）之间联系的理解。",
            "id": "3938145",
            "problem": "考虑一个具有 $M$ 个反应通道的合成生物学反应网络，通道索引为 $i \\in \\{1,\\dots,M\\}$。令 $x \\in \\mathbb{N}^{S}$ 表示在时间 $t$ 的当前分子数状态，令 $x_s$ 表示某个固定物种 $s \\in \\{1,\\dots,S\\}$ 的分子数。每个反应 $i$ 都有一个倾向（风险）函数 $a_i(x)$ 和一个化学计量变化向量 $\\nu_i \\in \\mathbb{Z}^{S}$，其中条目 $\\nu_{si} \\in \\mathbb{Z}$ 表示当反应 $i$ 发生一次时，物种 $s$ 产生的净变化。假设在化学主方程（CME）框架和 τ-跳跃近似下：对于一个长度为 $\\tau  0$ 的跳跃间隔，如果该间隔足够小，以至于所有 $a_i(x)$ 在 $[t, t+\\tau]$ 上都近似保持不变，那么在此期间 $[t, t+\\tau]$，每个反应 $i$ 的发生次数 $K_i$ 可以被建模为独立的泊松随机变量，其参数为 $a_i(x)\\,\\tau$。\n\n定义物种 $s$ 的分子数在跳跃间隔内的净变化为 $\\Delta x_s := \\sum_{i=1}^{M} \\nu_{si}\\,K_i$，因此有 $x_s(t+\\tau) = x_s(t) + \\Delta x_s$。仅从 CME 的短时行为和 τ-跳跃近似出发，通过推导其特征函数 $\\phi_s(\\theta) = \\mathbb{E}\\!\\left[\\exp\\!\\left(i\\,\\theta\\,\\Delta x_s\\right)\\middle|x\\right]$ 的闭式表达式来计算 $\\Delta x_s$ 的分布，然后用 $\\{\\nu_{si}\\}_{i=1}^{M}$、$\\{a_i(x)\\}_{i=1}^{M}$ 和 $\\tau$ 来推导其均值 $\\mathbb{E}[\\Delta x_s\\,|\\,x]$ 和方差 $\\operatorname{Var}[\\Delta x_s\\,|\\,x]$。将你的最终答案表示为一个单一的解析表达式，该表达式以行矩阵的形式，依次包含 $\\Delta x_s$ 的特征函数、均值和方差。无需进行数值计算或四舍五入。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题设定良好且自洽，代表了随机化学动力学领域的一个标准推导。我们现在可以开始求解。\n\n目标是在 τ-跳跃近似下，求解单个时间步长 $\\tau$ 内物种计数的净变化量 $\\Delta x_s$ 的特征函数、均值和方差。物种 $s$ 的净变化定义为每个反应通道 $i$ 的反应发生次数 $K_i$ 的加权和：\n$$\n\\Delta x_s = \\sum_{i=1}^{M} \\nu_{si}\\,K_i\n$$\n其中 $\\nu_{si}$ 是物种 $s$ 因反应 $i$ 引起的化学计量变化， $M$ 是反应通道的总数。\n\n根据 τ-跳跃近似，对于一个足够小的时间步长 $\\tau$，当倾向函数 $a_i(x)$ 近似为常数时，每个反应 $i \\in \\{1,\\dots,M\\}$ 的发生次数 $K_i$ 是一个独立的泊松随机变量，其参数为 $\\lambda_i = a_i(x)\\,\\tau$。即，对于所有的 $i$，$K_i \\sim \\text{Poisson}(a_i(x)\\,\\tau)$，并且随机变量集合 $\\{K_1, K_2, \\dots, K_M\\}$ 是相互独立的。所有的期望都是以时间 $t$ 的状态 $x$为条件的。\n\n**1. 特征函数 $\\phi_s(\\theta)$ 的推导**\n\n随机变量 $\\Delta x_s$ 的特征函数定义为 $\\phi_s(\\theta) = \\mathbb{E}[\\exp(i\\,\\theta\\,\\Delta x_s)|x]$。代入 $\\Delta x_s$ 的表达式：\n$$\n\\phi_s(\\theta) = \\mathbb{E}\\left[\\exp\\left(i\\,\\theta\\,\\sum_{j=1}^{M} \\nu_{sj}\\,K_j\\right)\\middle|x\\right]\n$$\n使用性质 $\\exp(\\sum_j A_j) = \\prod_j \\exp(A_j)$，我们可以将表达式重写为：\n$$\n\\phi_s(\\theta) = \\mathbb{E}\\left[\\prod_{j=1}^{M} \\exp(i\\,\\theta\\,\\nu_{sj}\\,K_j)\\middle|x\\right]\n$$\nτ-跳跃方法的一个关键假设是随机变量 $K_j$ 是独立的。独立随机变量乘积的期望等于它们各自期望的乘积。因此：\n$$\n\\phi_s(\\theta) = \\prod_{j=1}^{M} \\mathbb{E}\\left[\\exp(i\\,\\theta\\,\\nu_{sj}\\,K_j)\\middle|x\\right]\n$$\n每一项 $\\mathbb{E}[\\exp(i\\,\\theta\\,\\nu_{sj}\\,K_j)|x]$ 是缩放后的随机变量 $\\nu_{sj}K_j$ 的特征函数。令 $\\phi_{K_j}(u) = \\mathbb{E}[\\exp(i\\,u\\,K_j)|x]$ 为 $K_j$ 的特征函数。那么 $\\mathbb{E}[\\exp(i\\,(\\theta\\nu_{sj})\\,K_j)|x] = \\phi_{K_j}(\\theta\\nu_{sj})$。\n\n对于一个泊松随机变量 $K \\sim \\text{Poisson}(\\lambda)$，其特征函数为 $\\phi_K(u) = \\exp(\\lambda(\\exp(i\\,u) - 1))$。在我们的情况下，$K_j \\sim \\text{Poisson}(a_j(x)\\tau)$，所以 $\\lambda_j = a_j(x)\\tau$。$K_j$ 的特征函数为：\n$$\n\\phi_{K_j}(u) = \\exp\\left(a_j(x)\\tau(\\exp(i\\,u)-1)\\right)\n$$\n在 $u = \\theta\\nu_{sj}$ 处求值，我们得到：\n$$\n\\mathbb{E}\\left[\\exp(i\\,\\theta\\,\\nu_{sj}\\,K_j)\\middle|x\\right] = \\phi_{K_j}(\\theta\\nu_{sj}) = \\exp\\left(a_j(x)\\tau(\\exp(i\\,\\theta\\,\\nu_{sj})-1)\\right)\n$$\n将此代回 $\\phi_s(\\theta)$ 的乘积式中：\n$$\n\\phi_s(\\theta) = \\prod_{j=1}^{M} \\exp\\left(a_j(x)\\tau(\\exp(i\\,\\theta\\,\\nu_{sj})-1)\\right)\n$$\n最后，使用性质 $\\prod_j \\exp(A_j) = \\exp(\\sum_j A_j)$，我们得到特征函数的闭式表达式：\n$$\n\\phi_s(\\theta) = \\exp\\left(\\sum_{j=1}^{M} a_j(x)\\tau(\\exp(i\\,\\theta\\,\\nu_{sj})-1)\\right) = \\exp\\left(\\tau\\sum_{j=1}^{M} a_j(x)\\left(\\exp(i\\,\\theta\\,\\nu_{sj})-1\\right)\\right)\n$$\n为了与问题陈述的索引保持一致，我们使用 $i$：\n$$\n\\phi_s(\\theta) = \\exp\\left(\\tau \\sum_{i=1}^{M} a_i(x)(\\exp(i\\,\\theta\\,\\nu_{si})-1)\\right)\n$$\n\n**2. 均值和方差的推导**\n\n$\\Delta x_s$ 的均值和方差可以从其特征函数导出。一个更直接的方法是使用累积量生成函数 $C_s(\\theta) = \\ln(\\phi_s(\\theta))$。第 $n$ 阶累积量 $\\kappa_n$ 由 $\\kappa_n = (i^{-n}) \\frac{d^nC_s(\\theta)}{d\\theta^n}\\big|_{\\theta=0}$ 给出。第一阶累积量 $\\kappa_1$ 是均值，第二阶累积量 $\\kappa_2$ 是方差。\n\n$\\Delta x_s$ 的累积量生成函数为：\n$$\nC_s(\\theta) = \\ln(\\phi_s(\\theta)) = \\tau \\sum_{i=1}^{M} a_i(x)(\\exp(i\\,\\theta\\,\\nu_{si})-1)\n$$\n\n**均值 $\\mathbb{E}[\\Delta x_s|x]$：**\n均值是第一阶累积量 $\\kappa_1$。我们计算 $C_s(\\theta)$ 对 $\\theta$ 的一阶导数：\n$$\n\\frac{dC_s(\\theta)}{d\\theta} = \\frac{d}{d\\theta}\\left[\\tau \\sum_{i=1}^{M} a_i(x)(\\exp(i\\,\\theta\\,\\nu_{si})-1)\\right] = \\tau \\sum_{i=1}^{M} a_i(x)(i\\,\\nu_{si}\\,\\exp(i\\,\\theta\\,\\nu_{si}))\n$$\n在 $\\theta=0$ 处求值：\n$$\n\\frac{dC_s(\\theta)}{d\\theta}\\bigg|_{\\theta=0} = \\tau \\sum_{i=1}^{M} a_i(x)(i\\,\\nu_{si}\\,\\exp(0)) = i\\,\\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}\n$$\n那么均值为：\n$$\n\\mathbb{E}[\\Delta x_s|x] = \\kappa_1 = \\frac{1}{i} \\left(\\frac{dC_s(\\theta)}{d\\theta}\\bigg|_{\\theta=0}\\right) = \\frac{1}{i} \\left(i\\,\\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}\\right) = \\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}\n$$\n\n**方差 $\\operatorname{Var}[\\Delta x_s|x]$：**\n方差是第二阶累积量 $\\kappa_2$。我们计算 $C_s(\\theta)$ 的二阶导数：\n$$\n\\frac{d^2C_s(\\theta)}{d\\theta^2} = \\frac{d}{d\\theta}\\left[i\\,\\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}\\,\\exp(i\\,\\theta\\,\\nu_{si})\\right] = i\\,\\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}\\,(i\\,\\nu_{si}\\,\\exp(i\\,\\theta\\,\\nu_{si}))\n$$\n$$\n\\frac{d^2C_s(\\theta)}{d\\theta^2} = i^2\\,\\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}^2\\,\\exp(i\\,\\theta\\,\\nu_{si}) = -\\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}^2\\,\\exp(i\\,\\theta\\,\\nu_{si})\n$$\n在 $\\theta=0$ 处求值：\n$$\n\\frac{d^2C_s(\\theta)}{d\\theta^2}\\bigg|_{\\theta=0} = -\\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}^2\\,\\exp(0) = -\\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}^2\n$$\n那么方差为：\n$$\n\\operatorname{Var}[\\Delta x_s|x] = \\kappa_2 = \\frac{1}{i^2} \\left(\\frac{d^2C_s(\\theta)}{d\\theta^2}\\bigg|_{\\theta=0}\\right) = -1 \\left(-\\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}^2\\right) = \\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}^2\n$$\n\n这些结果与使用期望和方差的线性性质的推导一致。具体来说，$\\mathbb{E}[\\Delta x_s|x] = \\sum_i \\nu_{si}\\mathbb{E}[K_i|x] = \\sum_i \\nu_{si}(a_i(x)\\tau)$，并且由于独立性，$\\operatorname{Var}[\\Delta x_s|x] = \\sum_i \\operatorname{Var}[\\nu_{si}K_i|x] = \\sum_i \\nu_{si}^2\\operatorname{Var}[K_i|x] = \\sum_i \\nu_{si}^2(a_i(x)\\tau)$。\n\n所需的三个表达式是：\n1. 特征函数: $\\phi_s(\\theta) = \\exp\\left(\\tau \\sum_{i=1}^{M} a_i(x)(\\exp(i\\,\\theta\\,\\nu_{si})-1)\\right)$\n2. 均值: $\\mathbb{E}[\\Delta x_s|x] = \\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}$\n3. 方差: $\\operatorname{Var}[\\Delta x_s|x] = \\tau \\sum_{i=1}^{M} a_i(x)\\nu_{si}^2$\n我们现在将以要求的最终格式呈现这些结果。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\exp\\left(\\tau\\sum_{i=1}^{M} a_i(x)(\\exp(i\\,\\theta\\,\\nu_{si})-1)\\right)  \\tau\\sum_{i=1}^{M} a_i(x)\\nu_{si}  \\tau\\sum_{i=1}^{M} a_i(x)\\nu_{si}^{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的这项实践将所有概念融合成一个完整的计算实验。您将为一个经典的合成生物学线路——基因拨动开关——实现一个τ-跳跃模拟器，并用它来估计一个关键的动力学特性：平均切换时间。此练习将应对确保物种非负性等实际挑战，并展示τ-跳跃方法如何用于研究精确模拟可能非常缓慢的复杂非线性系统。",
            "id": "3938161",
            "problem": "考虑一个合成基因转换开关的随机模型，该开关包含两种蛋白质 $X$ 和 $Y$，它们相互抑制对方的产生。其动力学被建模为一个由化学主方程 (CME) 控制的连续时间、离散状态的马尔可夫过程。假设反应通道及其依赖于状态的倾向性如下：\n- $X$的产生：$\\varnothing \\rightarrow X$，倾向性为 $a_{1}(x,y) = b_{x} + \\dfrac{\\alpha_{x}}{1 + \\left(\\dfrac{y}{K}\\right)^{n}}$。\n- $Y$的产生：$\\varnothing \\rightarrow Y$，倾向性为 $a_{2}(x,y) = b_{y} + \\dfrac{\\alpha_{y}}{1 + \\left(\\dfrac{x}{K}\\right)^{n}}$。\n- $X$的降解：$X \\rightarrow \\varnothing$，倾向性为 $a_{3}(x,y) = \\delta_{x}\\,x$。\n- $Y$的降解：$Y \\rightarrow \\varnothing$，倾向性为 $a_{4}(x,y) = \\delta_{y}\\,y$。\n\n此处，$x$ 和 $y$ 分别表示 $X$ 和 $Y$ 的分子数量。参数 $b_{x}$ 和 $b_{y}$ 是基础产生速率，$\\alpha_{x}$ 和 $\\alpha_{y}$ 是最大调控产生速率，$K$ 是抑制阈值，$n$ 是Hill系数，$\\delta_{x}$ 和 $\\delta_{y}$ 是一级降解速率常数。所有速率的单位均为 $\\text{min}^{-1}$，时间以分钟为单位。\n\n以CME为基本出发点，推导在该系统下$\\tau$-跳跃近似成立的条件，并为每个反应通道指明在时间间隔 $\\tau$ 内反应发生次数所遵循的统计定律。基于第一性原理，解释为什么跳跃条件必须限制倾向性和物种数量的变化。对于具有一级降解（消耗单个分子）的反应，请论证一种能确保在跳跃过程中物种数量非负性的方法。\n\n然后，设计并实现一个模拟器，使用固定大小的 $\\tau$-跳跃来估计从 $X$高/$Y$低吸引盆到 $Y$高/$X$低吸引盆的平均首次穿越转换时间。使用以下科学上合理且自洽的参数集：\n- $\\alpha_{x} = \\alpha_{y} = 50$,\n- $b_{x} = b_{y} = 0.2$,\n- $K = 80$,\n- $n = 4$,\n- $\\delta_{x} = \\delta_{y} = 1$.\n\n将每条轨迹初始化于 $(x_{0},y_{0}) = (120,2)$，当 $y \\geq 100$ 且 $x \\leq 20$ 时，认为发生了一次转换。如果一条轨迹在时间 $T_{\\max} = 200$ 分钟前未发生转换，则在计算样本均值时将其转换时间视为 $200$，并在您的解答中明确指出这种删失处理的影响。\n\n您的程序必须使用每个 $\\tau$ 值下 $N = 60$ 条独立轨迹，来估计以下每个固定跳跃大小 $\\tau$ 的平均转换时间（以分钟为单位）：\n- $\\tau = 0.005$,\n- $\\tau = 0.050$,\n- $\\tau = 0.200$,\n- $\\tau = 0.800$.\n\n模拟器在每次跳跃中必须对反应次数使用统计上可靠的采样方法：\n- 对于产生反应，当倾向性在跳跃期间近似保持不变时，使用与$\\tau$-跳跃近似一致的分布。\n- 对于降解反应，使用能防止消耗的分子数超过当前计数的分布。\n\n将每次测试的最终平均转换时间以分钟为单位表示为浮点数。您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序与上述 $\\tau$ 值相对应。每个浮点数必须四舍五入到三位小数。例如，输出格式必须与 $[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}]$ 完全一致。\n\n测试套件与答案规范：\n- 为四个 $\\tau$ 值 $\\tau \\in \\{0.005, 0.050, 0.200, 0.800\\}$ 提供结果。\n- 每个 $\\tau$ 值使用 $N = 60$ 条轨迹。\n- 使用 $T_{\\max} = 200$ 分钟进行删失处理。\n- 初始条件为 $(x_{0},y_{0}) = (120,2)$。\n- 转换条件为：$y \\geq 100$ 且 $x \\leq 20$。\n\n您的程序必须实现上述要求，并以指定格式打印单行输出。不应打印任何其他文本。",
            "solution": "问题陈述已经过仔细验证，被确定为具有科学依据、适定且客观。它提出了计算系统生物学中的一个标准问题：使用近似方法模拟随机基因开关模型，以估计一个关键的动力学特性。所有参数、条件和目标都已明确定义，构成了一个有效的先验任务。\n\n该问题涉及使用 $\\tau$-跳跃近似来模拟合成基因转换开关，这是系统生物学中的一个典型基序。系统状态由分子数量向量 $\\mathbf{x}(t) = [x(t), y(t)]^T$ 给出，其中 $x$ 和 $y$ 分别是蛋白质种类 $X$ 和 $Y$ 的数量。系统的时间演化从根本上由化学主方程 (CME) 控制，这是一组描述系统在时间 $t$ 处于状态 $\\mathbf{x}$ 的概率 $P(\\mathbf{x}, t)$ 的线性常微分方程。\n\n$\\tau$-跳跃算法是一种近似方法，旨在加速随机模拟，其能力超越了由 Gillespie 提出的精确随机模拟算法 (SSA)。SSA 模拟每一个反应事件，这对于具有大分子数量或快速反应速率的系统来说，计算成本可能高得令人望而却步。相比之下，$\\tau$-跳跃将模拟时间推进一个预选的时间间隔 $\\tau$，并在此跳跃内发生多次反应。\n\n### $\\tau$-跳跃近似及其有效性\n\n$\\tau$-跳跃的基本假设是**跳跃条件**：在时间间隔 $[t, t+\\tau)$ 内，每个反应通道 $j$ 的倾向性函数 $a_j(\\mathbf{x}(t'))$ 必须近似保持不变，即对于 $t' \\in [t, t+\\tau)$，有 $a_j(\\mathbf{x}(t')) \\approx a_j(\\mathbf{x}(t))$。\n\n如果此条件成立，则在时间间隔 $\\tau$ 内反应 $j$ 的发生过程可以被建模为速率为 $\\lambda_j = a_j(\\mathbf{x}(t))$ 的齐次泊松过程。因此，在跳跃期间反应通道 $j$ 发生的次数（记为 $k_j$）是一个从泊松分布中抽取的随机变量：\n$$k_j \\sim \\text{Pois}(a_j(\\mathbf{x}(t))\\tau)$$\n对于倾向性不是被消耗物种函数的通道（例如本问题中的产生反应），这构成了控制其反应发生次数的统计定律。\n\n跳跃条件的有效性取决于跳跃期间状态向量 $\\mathbf{x}$ 的变化。状态根据以下公式更新：\n$$\\mathbf{x}(t+\\tau) = \\mathbf{x}(t) + \\sum_{j=1}^{M} k_j \\mathbf{v}_j$$\n其中 $M$ 是反应通道的数量，$\\mathbf{v}_j$ 是反应 $j$ 的状态改变向量。倾向性函数因状态 $\\mathbf{x}$ 的改变而改变。为确保跳跃条件成立，由所有反应的发生所引起的任何倾向性 $a_i$ 的变化必须相对于其自身的值很小。使用一阶近似，倾向性 $a_i$ 的变化为 $\\Delta a_i \\approx \\nabla a_i \\cdot \\Delta \\mathbf{x} = \\nabla a_i \\cdot \\sum_j k_j \\mathbf{v}_j$。跳跃条件要求限制这一变化，例如，通过要求期望的分数变化很小：\n$$ \\left| \\sum_{j=1}^{M} \\frac{\\partial a_i}{\\partial \\mathbf{x}} \\mathbf{v}_j \\mathbb{E}[k_j] \\right| = \\left| \\sum_{j=1}^{M} \\frac{\\partial a_i}{\\partial \\mathbf{x}} \\mathbf{v}_j (a_j(\\mathbf{x})\\tau) \\right| \\ll a_i(\\mathbf{x}) $$\n对于所有 $i=1, \\dots, M$。在自适应算法中，会选择 $\\tau$ 以满足给定容差 $\\epsilon$ 的此约束。在本问题中，我们使用固定的 $\\tau$，因此我们承认，对于较大的 $\\tau$ 值，此条件可能被违反，从而在模拟中引入不准确性。限制这些变化至关重要，因为 $k_j$ 的泊松分布是在假设事件速率恒定的前提下推导出来的。如果倾向性发生显著变化，其潜在过程就不再是齐次泊松过程，近似便会失效，导致不正确的系统动力学。\n\n### 降解反应的非负性约束\n\n对于一级降解反应，例如倾向性为 $a_3(x,y) = \\delta_x x$ 的反应 $X \\rightarrow \\varnothing$，标准的泊松近似 $k_3 \\sim \\text{Pois}(\\delta_x x \\tau)$ 可能会产生一个样本 $k_3  x$，这在物理上是不可能的，因为它会导致负的分子数量。这种假象的产生是因为泊松模型隐含地假设了有放回抽样；在整个跳跃过程中，倾向性保持其初始值不变，忽略了每个反应的分子被消耗后不能再反应的事实。\n\n一个在物理上更准确的方法是将此过程建模为*无*放回抽样。对于物种 $X$ 的单个分子，在时间间隔 $\\tau$ 内不发生降解的概率是 $e^{-\\delta_x \\tau}$。这是通过求解微分方程 $dP_{\\text{survival}}/dt = -\\delta_x P_{\\text{survival}}$ 得到的，其解为 $P_{\\text{survival}}(t) = e^{-\\delta_x t}$。因此，单个分子在 $\\tau$ 内*确实*发生降解的概率是 $p_x = 1 - e^{-\\delta_x \\tau}$。\n\n给定一个由 $x$ 个相同且独立的分子组成的群体，发生降解的分子数 $k_3$ 是 $x$ 次独立伯努利试验中“成功”（即降解）的次数。这恰好可以用二项分布来描述：\n$$k_3 \\sim \\text{Bin}(x, p_x) \\quad \\text{其中} \\quad p_x = 1 - e^{-\\delta_x \\tau}$$\n类似地，对于 $Y$ 的降解：\n$$k_4 \\sim \\text{Bin}(y, p_y) \\quad \\text{其中} \\quad p_y = 1 - e^{-\\delta_y \\tau}$$\n这种二项分布的表述方式自然地确保了 $k_3 \\le x$ 和 $k_4 \\le y$，从而严格防止了物种数量出现负值，并为 $\\tau$-跳跃框架内的单分子消耗反应提供了一个更忠实的物理模型。\n\n### 平均首次穿越时间的模拟\n\n任务是估计系统从 $X$ 高、$Y$ 低的状态转换到 $X$ 低、$Y$ 高的状态的平均首次穿越时间 (MFPT)。模拟过程如下：\n1. 将系统状态初始化为 $(x_0, y_0) = (120, 2)$，时间 $t=0$。\n2. 对于一个固定的跳跃大小 $\\tau$，按时间步进。在从 $t$ 到 $t+\\tau$ 的每一步中：\n    a. 根据时间 $t$ 的状态 $(x,y)$ 计算产生反应倾向性 $a_1, a_2$ 和降解反应倾向性 $a_3, a_4$。\n    b. 从泊松分布中抽样产生事件的次数 $k_1$ 和 $k_2$：$k_1 \\sim \\text{Pois}(a_1 \\tau)$ 和 $k_2 \\sim \\text{Pois}(a_2 \\tau)$。\n    c. 从二项分布中抽样降解事件的次数 $k_3$ 和 $k_4$：$k_3 \\sim \\text{Bin}(x, 1 - e^{-\\delta_x \\tau})$ 和 $k_4 \\sim \\text{Bin}(y, 1 - e^{-\\delta_y \\tau})$。\n    d. 更新状态：$x_{\\text{new}} = x + k_1 - k_3$ 和 $y_{\\text{new}} = y + k_2 - k_4$。\n    e. 更新时间：$t_{\\text{new}} = t + \\tau$。\n3. 每步之后，检查是否满足转换条件（$y \\ge 100$ 且 $x \\le 20$）。如果满足，则将该轨迹的首次穿越时间记录为 $t_{\\text{new}}$，并终止该轨迹的模拟。\n4. 如果模拟时间 $t$ 达到或超过 $T_{\\max} = 200$ 分钟而转换仍未发生，则终止该轨迹。其转换时间记录为 $200$。这是一种右删失。这种删失处理的影响是，计算出的样本均值是真实 MFPT 的一个下界。如果有很大一部分轨迹被删失，真实的 MFPT 可能会远大于估计值。\n5. 对每个给定的 $\\tau$ 值，重复此过程 $N=60$ 条独立轨迹。这 $N$ 个记录的转换时间的平均值即为最终估计值。\n\n对每个指定的 $\\tau \\in \\{0.005, 0.050, 0.200, 0.800\\}$ 执行此过程，并报告所得的平均转换时间。随着 $\\tau$ 的增加，计算速度会提高，但因违反跳跃条件而产生的误差预计也会增加，这可能会影响 MFPT 估计的准确性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a tau-leaping simulator to estimate the mean first-passage time \n    for a genetic toggle switch model.\n    \"\"\"\n\n    # --- Model Parameters ---\n    alpha_x = 50.0\n    alpha_y = 50.0\n    b_x = 0.2\n    b_y = 0.2\n    K = 80.0\n    n = 4.0\n    delta_x = 1.0\n    delta_y = 1.0\n\n    # --- Simulation Conditions ---\n    x0, y0 = 120, 2\n    y_thresh, x_thresh = 100, 20\n    Tmax = 200.0\n    N = 60  # Number of trajectories per tau\n\n    # --- Test Suite ---\n    tau_values = [0.005, 0.050, 0.200, 0.800]\n\n    # --- Propensity Functions ---\n    def a1(x, y):\n        # Production of X\n        return b_x + alpha_x / (1.0 + (y / K)**n)\n\n    def a2(x, y):\n        # Production of Y\n        return b_y + alpha_y / (1.0 + (x / K)**n)\n        \n    # Note: Degradation propensities a3 and a4 are handled directly\n    # within the Binomial sampling logic.\n\n    mean_switching_times = []\n\n    for tau in tau_values:\n        trajectory_times = []\n        for _ in range(N):\n            # --- Initialize Trajectory ---\n            x, y = float(x0), float(y0)\n            t = 0.0\n            switching_time = Tmax # Default to censored time\n\n            # --- Time-stepping Loop ---\n            while t  Tmax:\n                # Ensure state variables are non-negative integers for sampling\n                # (though they are floats from updates, they represent counts)\n                x_int, y_int = int(round(x)), int(round(y))\n\n                # --- Calculate Propensities ---\n                prop_a1 = a1(x, y)\n                prop_a2 = a2(x, y)\n                \n                # --- Sample Reaction Firings ---\n                # Production (Poisson)\n                k1 = np.random.poisson(prop_a1 * tau)\n                k2 = np.random.poisson(prop_a2 * tau)\n                \n                # Degradation (Binomial to ensure non-negativity)\n                # Probability of decay for a single molecule in time tau\n                p_decay_x = 1.0 - np.exp(-delta_x * tau)\n                p_decay_y = 1.0 - np.exp(-delta_y * tau)\n                \n                k3 = np.random.binomial(x_int, p_decay_x)\n                k4 = np.random.binomial(y_int, p_decay_y)\n                \n                # --- Update State and Time ---\n                x_new = x + k1 - k3\n                y_new = y + k2 - k4\n                t_new = t + tau\n\n                # --- Check for Switching Condition ---\n                if y_new >= y_thresh and x_new = x_thresh:\n                    switching_time = t_new\n                    break  # Exit time-stepping loop for this trajectory\n\n                # --- Prepare for Next Iteration ---\n                x, y, t = x_new, y_new, t_new\n\n            trajectory_times.append(switching_time)\n        \n        # --- Calculate and store mean switching time for this tau ---\n        mean_time = np.mean(trajectory_times)\n        mean_switching_times.append(mean_time)\n\n    # --- Final Print ---\n    # The final print statement in the exact required format.\n    print(f\"[{','.join(f'{t:.3f}' for t in mean_switching_times)}]\")\n\nsolve()\n```"
        }
    ]
}