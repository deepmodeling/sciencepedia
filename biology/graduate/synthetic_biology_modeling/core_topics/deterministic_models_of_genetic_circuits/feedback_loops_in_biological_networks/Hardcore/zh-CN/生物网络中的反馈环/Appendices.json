{
    "hands_on_practices": [
        {
            "introduction": "这个练习从最基本的调控模块——负自我调节（negative autoregulation）——入手。通过分析一个基因产物抑制自身表达的简化模型，我们可以掌握定量描述基因表达的基础。这项实践的核心是推导系统的稳态解 ，即蛋白质的生成速率与降解速率相等的平衡点，这是理解任何动态系统行为的第一步。",
            "id": "3913123",
            "problem": "在一个实现负向自动调节的合成基因线路中，蛋白质浓度 $x$ 的确定性演化遵循以下常微分方程 (ODE)\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1 + (x/K)^{n}} \\;-\\; \\beta\\,x,\n$$\n其中 $\\alpha0$ 是最大合成速率，$\\beta0$ 是一阶有效损失速率， $K0$ 是设定阻遏阈值的解离常数， $n\\geq 1$ 是表征结合协同性的希尔系数。假设条件为充分混合，且存在单一的有效调控步骤，因此上述 ODE 能够捕捉负反馈下蛋白质表达的粗粒化动力学。\n\n从稳态满足 $\\dot{x}=0$ 的基本建模原理和转录控制的标准希尔阻遏形式出发，推导定义平衡表达水平 $x^{*}$ 的稳态条件，并使用基本原理（单调性和连续性）论证对于 $\\alpha0$、$\\beta0$、 $K0$ 和 $n\\geq 1$ 是否存在唯一的正稳态。然后，将情况特化至非协同情况 $n=1$，并求解出 $x^{*}$ 作为参数 $\\alpha$、$\\beta$ 和 $K$ 的函数的精确闭式解。最后，说明 $x^{*}$ 如何依赖于参数 $(\\alpha,\\beta,K,n)$，明确在非协同情况 $n=1$下哪些是递增或递减依赖关系，并阐明 $n$ 的作用。\n\n提供非协同情况 $n=1$ 的最终显式表达式。不要四舍五入；将您的答案保留为精确的解析形式。最终答案无需单位。",
            "solution": "用户希望分析具有负向自动调节的合成基因线路的稳态特性。\n\n### 第 1 步：提取已知条件\n问题描述了蛋白质浓度 $x$ 的动力学，其常微分方程 (ODE) 如下：\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1 + (x/K)^{n}} \\;-\\; \\beta\\,x\n$$\n参数定义如下：\n- $\\alpha  0$：最大合成速率。\n- $\\beta  0$：一阶有效损失速率。\n- $K  0$：解离常数（阻遏阈值）。\n- $n \\geq 1$：希尔系数。\n\n任务是：\n1.  推导平衡表达水平 $x^{*}$ 的稳态条件。\n2.  在给定的参数约束下，论证正稳态的存在性和唯一性。\n3.  在 $n=1$ 的特殊情况下，求解 $x^{*}$ 的精确闭式表达式。\n4.  描述 $x^{*}$ 对参数的依赖关系，特别是对于 $n=1$ 的情况。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n\n- **科学依据充分：** 所提供的 ODE 是系统生物学和合成生物学中描述负向自动调节的经典模型。使用希尔函数描述转录调控和使用一阶项描述降解/稀释是一种标准且成熟的方法。该模型牢固地建立在生物化学动力学的基本原理之上。\n- **提法明确：** 问题陈述清晰。它要求进行推导、唯一性证明以及针对特殊情况的特定解。这些是对动力系统的标准数学分析，问题的结构能够导出一个唯一且有意义的解。\n- **客观性：** 问题使用了精确、客观和标准的科学术语进行表述。没有主观或含糊不清的陈述。\n- **完整性与一致性：** 问题提供了进行所需分析的所有必要信息（ODE 和参数约束）。没有缺失的定义或矛盾之处。\n\n该问题没有验证清单中列出的任何缺陷。它是定量生物学领域一个有效、提法明确且标准的问题。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整解答。\n\n### 求解推导\n\n分析过程首先建立稳态的一般条件，然后证明正稳态的存在性和唯一性，最后在特化的非协同情况下求解该稳态。\n\n动力系统的稳态是指系统变量不随时间变化的状态。对于给定系统，稳态浓度（表示为 $x^{*}$）是使变化率 $\\dot{x}$ 为零的 $x$ 值。\n$$\n\\dot{x} = 0\n$$\n代入给定的 ODE，稳态条件为：\n$$\n\\frac{\\alpha}{1 + (x^{*}/K)^{n}} - \\beta x^{*} = 0\n$$\n该方程隐式地定义了稳态浓度 $x^{*}$。通过令蛋白质合成速率等于蛋白质损失速率，可以将其改写为：\n$$\n\\frac{\\alpha}{1 + (x^{*}/K)^{n}} = \\beta x^{*}\n$$\n\n为了确定是否存在唯一的正稳态，我们分析 $x0$ 时两个函数 $x$ 的交点：生成速率函数 $P(x) = \\frac{\\alpha}{1 + (x/K)^{n}}$ 和降解速率函数 $D(x) = \\beta x$。稳态 $x^{*}$ 对应于一个点，在该点处 $P(x^{*}) = D(x^{*})$。\n\n我们分析这两个函数在 $x \\geq 0$ 时的性质：\n\n1.  **生成速率, $P(x)$:**\n    -   当 $x=0$ 时，生成速率达到最大值：$P(0) = \\frac{\\alpha}{1 + 0} = \\alpha$。因为 $\\alpha  0$，所以 $P(0)  0$。\n    -   $P(x)$ 对于所有 $x \\geq 0$ 都是连续函数。\n    -   对于 $x  0$，$P(x)$ 是一个严格单调递减的函数。随着 $x$ 的增加，项 $(x/K)^{n}$ 增加（因为 $K0, n \\geq 1$），这使得分母 $1+(x/K)^n$ 增加。因此，分式 $P(x)$ 减小。\n    -   在 $x \\to \\infty$ 的极限情况下，分母无界增长，因此生成速率趋近于零：$\\lim_{x \\to \\infty} P(x) = 0$。\n\n2.  **降解速率, $D(x)$:**\n    -   当 $x=0$ 时，降解速率为零：$D(0) = \\beta \\cdot 0 = 0$。\n    -   $D(x)$ 对于所有 $x \\geq 0$ 都是连续函数。\n    -   对于 $x  0$，$D(x)$ 是一个严格单调递增的函数。它代表一条穿过原点、斜率为正值 $\\beta$ 的直线。\n\n通过比较这两个函数：\n-   当 $x=0$ 时，我们有 $P(0) = \\alpha$ 和 $D(0) = 0$。因为 $\\alpha  0$，所以我们有 $P(0)  D(0)$。\n-   当 $x \\to \\infty$ 时，我们有 $P(x) \\to 0$ 和 $D(x) \\to \\infty$。因此，对于足够大的 $x$ 值，必然有 $D(x)  P(x)$。\n\n由于 $P(x)$ 和 $D(x)$ 都是连续函数，并且函数 $f(x) = P(x) - D(x)$ 在 $x=0$ 时为正，在 $x$ 很大时为负，其符号发生改变，因此根据介值定理，必然存在至少一个根 $x^{*}  0$ 使得 $f(x^{*}) = 0$，即 $P(x^{*}) = D(x^{*})$。\n\n为了证明唯一性，我们观察到当 $x0$ 时，$P(x)$ 是严格递减的，而 $D(x)$ 是严格递增的。一个严格递减函数和一个严格递增函数在 $x0$ 的区间内最多只能相交一次。因此，正稳态 $x^{*}$ 是唯一的。这对所有 $\\alpha0$、$\\beta0$、 $K0$ 和 $n\\geq 1$ 都成立。\n\n接下来，我们特化到非协同情况，其中希尔系数 $n=1$。稳态方程变为：\n$$\n\\frac{\\alpha}{1 + x^{*}/K} - \\beta x^{*} = 0\n$$\n为了求解 $x^{*}$，我们整理该方程：\n$$\n\\alpha = \\beta x^{*} \\left(1 + \\frac{x^{*}}{K}\\right)\n$$\n$$\n\\alpha = \\beta x^{*} + \\frac{\\beta}{K} (x^{*})^{2}\n$$\n这是一个关于变量 $x^{*}$ 的二次方程：\n$$\n\\frac{\\beta}{K} (x^{*})^{2} + \\beta x^{*} - \\alpha = 0\n$$\n我们使用二次公式 $x^{*} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中 $a = \\frac{\\beta}{K}$，$b = \\beta$，$c = -\\alpha$。\n$$\nx^{*} = \\frac{-\\beta \\pm \\sqrt{\\beta^2 - 4\\left(\\frac{\\beta}{K}\\right)(-\\alpha)}}{2\\left(\\frac{\\beta}{K}\\right)}\n$$\n$$\nx^{*} = \\frac{-\\beta \\pm \\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}}{\\frac{2\\beta}{K}}\n$$\n由于蛋白质浓度 $x^{*}$ 必须是正的物理量，我们必须选择正根（‘-’号会产生一个负值）。\n$$\nx^{*} = \\frac{-\\beta + \\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}}{\\frac{2\\beta}{K}}\n$$\n我们可以通过从平方根项中提取 $\\beta$ 来简化这个表达式：\n$$\nx^{*} = \\frac{-\\beta + \\sqrt{\\beta^2 \\left(1 + \\frac{4\\alpha}{\\beta K}\\right)}}{\\frac{2\\beta}{K}} = \\frac{-\\beta + \\beta\\sqrt{1 + \\frac{4\\alpha}{\\beta K}}}{\\frac{2\\beta}{K}}\n$$\n分子和分母同除以 $\\beta$ （因为 $\\beta  0$）：\n$$\nx^{*} = \\frac{-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}}{\\frac{2}{K}}\n$$\n乘以 $\\frac{K}{2}$ 得到当 $n=1$ 时 $x^{*}$ 的最终显式表达式：\n$$\nx^{*} = \\frac{K}{2} \\left(-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)\n$$\n\n最后，我们分析稳态 $x^{*}$ 对参数的依赖关系。\n在一般情况下，从图形分析我们可以推断：\n- 增加 $\\alpha$ （最大生成速率）会使 $P(x)$ 曲线向上移动，从而增加交点 $x^{*}$。所以 $x^{*}$ 是 $\\alpha$ 的增函数。\n- 增加 $\\beta$ （损失速率）会增加 $D(x)$ 直线的斜率，从而减小交点 $x^{*}$。所以 $x^{*}$ 是 $\\beta$ 的减函数。\n- 增加 $K$ （阻遏阈值）会减弱给定 $x$ 下的阻遏作用，这意味着对于任何 $x0$，$P(x)$ 都会增加。这会使 $P(x)$ 曲线向上移动，从而增加交点 $x^{*}$。所以 $x^{*}$ 是 $K$ 的增函数。\n- 希尔系数 $n$ 控制阻遏的陡峭程度。增加 $n$ 会使反馈更具开关特性。对于 $x  K$，增加 $n$ 会提升生成曲线 $P(x)$；而对于 $x  K$，则会降低它。因此，它对 $x^*$ 的影响取决于其他参数。\n\n对于非协同情况 $n=1$，我们可以从显式解中验证这些依赖关系：\n$$\nx^{*} = \\frac{K}{2} \\left(-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)\n$$\n- 随着 $\\alpha$ 增加，平方根下的项增加，所以 $x^{*}$ 增加。\n- 随着 $\\beta$ 增加，平方根下的项减小，所以 $x^{*}$ 减小。\n- 随着 $K$ 增加，依赖关系更为复杂。设 $f(K) = x^{*}$。如预备思路中所示，导数 $\\frac{df}{dK} = \\frac{(\\sqrt{1+4\\alpha/(\\beta K)}-1)^2}{4\\sqrt{1+4\\alpha/(\\beta K)}}$ 对于正参数总是为正，因此 $x^{*}$ 是 $K$ 的增函数。\n这些针对 $n=1$ 的显式依赖关系证实了一般图形论证得出的结论。",
            "answer": "$$\n\\boxed{\\frac{K}{2} \\left(-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)}\n$$"
        },
        {
            "introduction": "在掌握了单基因回路分析的基础上，我们进一步研究由两个基因组成的网络。本练习聚焦于一个经典的合成生物学模块——相互抑制的“拨动开关”（toggle switch） 。通过对该系统进行线性稳定性分析，你将学习如何使用雅可比矩阵（Jacobian matrix）及其特征值来判断一个平衡点的局部稳定性，从而预测网络在受到微小扰动后的动态行为。",
            "id": "3913190",
            "problem": "考虑一个双基因合成反馈网络，其中一个基因以一阶希尔动力学抑制另一个基因。设状态变量为无量纲浓度 $x$ 和 $y$，并假设其动力学由以下常微分方程组 (ODEs) 给出\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1 + y/K} \\;-\\; \\gamma\\,x,\\qquad\n\\dot{y} \\;=\\; \\frac{\\alpha}{1 + x/K} \\;-\\; \\gamma\\,y,\n$$\n其中 $\\alpha0$ 是最大生产速率，$K0$ 是抑制阈值，$\\gamma0$ 是一阶损失率（例如，稀释或降解）。该网络通过抑制实现相互负反馈，您可以假设参数是对称的。对于特定的参数集 $\\alpha = 2$、$K = 1$ 和 $\\gamma = 1$，执行以下操作：\n\n1. 在这些参数下，确定满足 $\\dot{x}=\\dot{y}=0$ 的唯一对称平衡点 $(x^{*}, y^{*})$。\n2. 计算在 $(x^{*}, y^{*})$ 处通过系统线性化得到的雅可比矩阵 $J(x^{*},y^{*})$，即：\n$$\nJ(x^{*},y^{*}) \\;=\\; \n\\begin{pmatrix}\n\\frac{\\partial f}{\\partial x}  \\frac{\\partial f}{\\partial y} \\\\\n\\frac{\\partial g}{\\partial x}  \\frac{\\partial g}{\\partial y}\n\\end{pmatrix}\\Bigg|_{(x^{*},y^{*})},\n$$\n其中 $f(x,y) = \\frac{\\alpha}{1 + y/K} - \\gamma x$ 且 $g(x,y) = \\frac{\\alpha}{1 + x/K} - \\gamma y$。\n3. 使用二维线性系统的迹-行列式表征，评估平衡点的局部稳定性，并计算谱横坐标 $\\lambda_{\\max}$，其定义为 $J(x^{*},y^{*})$ 的特征值中的最大实部。\n\n以 $\\text{time}^{-1}$ 为单位表示 $\\lambda_{\\max}$ 的最终数值答案。无需四舍五入；请给出所提供参数所蕴含的精确值。",
            "solution": "该问题要求对一个由常微分方程组 (ODEs) 描述的双基因合成反馈网络进行稳定性分析。该过程包括三个步骤：找到对称平衡点，计算该点的雅可比矩阵，然后确定特征值以评估稳定性并找到谱横坐标。\n\n系统动力学由以下方程给出：\n$$\n\\dot{x} = f(x,y) = \\frac{\\alpha}{1 + y/K} - \\gamma x\n$$\n$$\n\\dot{y} = g(x,y) = \\frac{\\alpha}{1 + x/K} - \\gamma y\n$$\n提供的特定参数为 $\\alpha = 2$、$K = 1$ 和 $\\gamma = 1$。\n\n**步骤 1：确定对称平衡点 $(x^{*}, y^{*})$**\n\n系统的平衡点 $(x, y)$ 是变化率为零的点，即 $\\dot{x} = 0$ 和 $\\dot{y} = 0$。这给出了以下代数方程组：\n$$\n\\frac{\\alpha}{1 + y/K} - \\gamma x = 0\n$$\n$$\n\\frac{\\alpha}{1 + x/K} - \\gamma y = 0\n$$\n我们正在寻找一个对称平衡点，它由条件 $x = y$ 定义。我们用 $x^*$ 表示这个共同的值，因此 $(x^*, y^*) = (x^*, x^*)$。将 $y=x$ 代入第一个方程（或由于对称性，代入第二个方程）可得：\n$$\n\\frac{\\alpha}{1 + x/K} - \\gamma x = 0\n$$\n现在，我们代入给定的参数值 $\\alpha = 2$、$K = 1$ 和 $\\gamma = 1$：\n$$\n\\frac{2}{1 + x/1} - 1 \\cdot x = 0\n$$\n$$\n\\frac{2}{1 + x} = x\n$$\n假设 $x \\neq -1$，这在物理上是必需的，因为浓度不能为负，我们可以将两边同乘以 $(1 + x)$：\n$$\n2 = x(1 + x)\n$$\n$$\n2 = x + x^2\n$$\n将其重新整理成标准二次方程形式，得到：\n$$\nx^2 + x - 2 = 0\n$$\n这个方程可以因式分解为：\n$$\n(x+2)(x-1) = 0\n$$\n两个数学解是 $x = 1$ 和 $x = -2$。由于 $x$ 代表无量纲浓度，它必须是一个非负量。因此，唯一具有物理意义的解是 $x = 1$。\n唯一的对称平衡点是 $(x^{*}, y^{*}) = (1, 1)$。\n\n**步骤 2：计算雅可比矩阵 $J(x^{*},y^{*})$**\n\n这个二维系统的雅可比矩阵 $J(x,y)$ 定义为：\n$$\nJ(x,y) = \n\\begin{pmatrix}\n\\frac{\\partial f}{\\partial x}  \\frac{\\partial f}{\\partial y} \\\\\n\\frac{\\partial g}{\\partial x}  \\frac{\\partial g}{\\partial y}\n\\end{pmatrix}\n$$\n我们计算 $f(x,y) = \\frac{\\alpha}{1 + y/K} - \\gamma x$ 和 $g(x,y) = \\frac{\\alpha}{1 + x/K} - \\gamma y$ 的四个偏导数：\n$$\n\\frac{\\partial f}{\\partial x} = -\\gamma\n$$\n$$\n\\frac{\\partial f}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\alpha(1 + y/K)^{-1} \\right) = \\alpha \\cdot (-1)(1 + y/K)^{-2} \\cdot (1/K) = -\\frac{\\alpha/K}{(1+y/K)^2} = -\\frac{\\alpha K}{(K+y)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\alpha(1 + x/K)^{-1} \\right) = \\alpha \\cdot (-1)(1 + x/K)^{-2} \\cdot (1/K) = -\\frac{\\alpha/K}{(1+x/K)^2} = -\\frac{\\alpha K}{(K+x)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial y} = -\\gamma\n$$\n因此，在一般点 $(x,y)$ 处的雅可比矩阵是：\n$$\nJ(x,y) = \n\\begin{pmatrix}\n-\\gamma  -\\frac{\\alpha K}{(K+y)^2} \\\\\n-\\frac{\\alpha K}{(K+x)^2}  -\\gamma\n\\end{pmatrix}\n$$\n现在我们使用参数 $\\alpha = 2$、$K = 1$ 和 $\\gamma = 1$，在平衡点 $(x^{*}, y^{*}) = (1, 1)$ 处计算该矩阵的值：\n$$\nJ(1,1) = \n\\begin{pmatrix}\n-1  -\\frac{2 \\cdot 1}{(1+1)^2} \\\\\n-\\frac{2 \\cdot 1}{(1+1)^2}  -1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-1  -\\frac{2}{4} \\\\\n-\\frac{2}{4}  -1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-1  -\\frac{1}{2} \\\\\n-\\frac{1}{2}  -1\n\\end{pmatrix}\n$$\n\n**步骤 3：评估稳定性并计算谱横坐标 $\\lambda_{\\max}$**\n\n平衡点的局部稳定性由雅可比矩阵 $J(1,1)$ 的特征值决定。特征值 $\\lambda$ 是特征方程 $\\det(J - \\lambda I) = 0$ 的根，其中 $I$ 是单位矩阵。这个方程可以写成：\n$$\n\\lambda^2 - \\text{tr}(J)\\lambda + \\det(J) = 0\n$$\n首先，我们计算 $J(1,1)$ 的迹和行列式：\n$$\n\\text{tr}(J) = -1 + (-1) = -2\n$$\n$$\n\\det(J) = (-1)(-1) - (-\\frac{1}{2})(-\\frac{1}{2}) = 1 - \\frac{1}{4} = \\frac{3}{4}\n$$\n因此，特征方程为：\n$$\n\\lambda^2 - (-2)\\lambda + \\frac{3}{4} = 0\n$$\n$$\n\\lambda^2 + 2\\lambda + \\frac{3}{4} = 0\n$$\n我们使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 求解这个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = \\frac{-2 \\pm \\sqrt{2^2 - 4(1)(\\frac{3}{4})}}{2(1)} = \\frac{-2 \\pm \\sqrt{4 - 3}}{2} = \\frac{-2 \\pm \\sqrt{1}}{2} = \\frac{-2 \\pm 1}{2}\n$$\n两个特征值是：\n$$\n\\lambda_1 = \\frac{-2 + 1}{2} = -\\frac{1}{2}\n$$\n$$\n\\lambda_2 = \\frac{-2 - 1}{2} = -\\frac{3}{2}\n$$\n对于局部稳定性，所有特征值都必须有负实部。在这里，两个特征值都是实数且为负（$\\lambda_1 = -1/2  0$ 和 $\\lambda_2 = -3/2  0$）。因此，平衡点 $(1,1)$ 是局部稳定的。具体来说，由于特征值是实数且不相等，它是一个稳定节点。\n\n谱横坐标 $\\lambda_{\\max}$ 定义为雅可比矩阵特征值中的最大实部。\n$$\n\\lambda_{\\max} = \\max(\\text{Re}(\\lambda_1), \\text{Re}(\\lambda_2))\n$$\n由于两个特征值都是实数，我们只需取这两个值的最大值：\n$$\n\\lambda_{\\max} = \\max(-\\frac{1}{2}, -\\frac{3}{2}) = -\\frac{1}{2}\n$$\n参数 $\\alpha$ 和 $\\gamma$ 的单位通常分别是浓度/时间和 1/时间。由于浓度是无量纲的，雅可比矩阵的特征值单位是时间的倒数，符合题目要求。",
            "answer": "$$\\boxed{-\\frac{1}{2}}$$"
        },
        {
            "introduction": "真实生物过程充满随机性，确定性模型往往不足以完全描述其行为。此项高级实践将带领你进入随机建模的世界，分析一个为实现稳健适应性而设计的“对偶积分反馈控制器”（antithetic integral feedback controller） 。你将运用矩封闭近似（moment-closure approximation）和线性噪声近似（Linear Noise Approximation, LNA）等关键理论，通过编程计算来评估该随机系统在噪声环境下的平均表现和波动性。",
            "id": "3913082",
            "problem": "要求您实现并验证一个基于矩封闭的分析方法，该方法用于一个调控单一分子种类的典型随机反向积分反馈控制器。该控制器被建模为一个在有限分子种类集合上的充分混合、连续时间的马尔可夫跳跃过程，其反应遵循质量作用动力学。您的任务是从第一性原理出发，推导平均场动力学和二阶噪声近似，然后实现一个程序，为一组指定的参数测试套件计算受调控物种的稳态均值和方差。\n\n从化学主方程 (CME) 开始，它给出了分子数量概率分布的时间演化。将状态向量表示为 $x = [x_{X}, x_{Z_{1}}, x_{Z_{2}}]^{\\top}$，其中 $x_{X}$ 是受调控物种 $X$ 的数量，$x_{Z_{1}}$ 和 $x_{Z_{2}}$ 是两种反向控制器物种 $Z_{1}$ 和 $Z_{2}$ 的数量。反应网络如下：\n- $X$ 的生成：$\\varnothing \\xrightarrow{k x_{Z_{1}}} X$，倾向性为 $a_{1}(x) = k x_{Z_{1}}$。\n- $X$ 的降解：$X \\xrightarrow{\\delta x_{X}} \\varnothing$，倾向性为 $a_{2}(x) = \\delta x_{X}$。\n- $Z_{1}$ 的参考输入：$\\varnothing \\xrightarrow{\\mu} Z_{1}$，倾向性为 $a_{3}(x) = \\mu$。\n- $Z_{2}$ 的测量输入：$\\varnothing \\xrightarrow{\\theta x_{X}} Z_{2}$，倾向性为 $a_{4}(x) = \\theta x_{X}$。\n- 反向湮灭：$Z_{1} + Z_{2} \\xrightarrow{\\eta x_{Z_{1}} x_{Z_{2}}} \\varnothing$，倾向性为 $a_{5}(x) = \\eta x_{Z_{1}} x_{Z_{2}}$。\n\n设化学计量矩阵为 $S \\in \\mathbb{R}^{3 \\times 5}$，其列是反应 1 到 5（按上述顺序）的状态改变向量。CME 通过 $ \\frac{d}{dt} \\mathbb{E}[x] = S \\, \\mathbb{E}[a(x)] $ 导出精确的矩演化，其中 $a(x) = [a_{1}(x), a_{2}(x), a_{3}(x), a_{4}(x), a_{5}(x)]^{\\top}$。由于 $a_{5}(x)$ 在 $x_{Z_{1}}$ 和 $x_{Z_{2}}$ 中是双线性的，因此若无近似，平均动力学是不封闭的。\n\n通过近似 $\\mathbb{E}[a(x)] \\approx a(\\mathbb{E}[x])$ 来实现平均场封闭。在此封闭下，您将得到均值 $m = \\mathbb{E}[x]$ 的确定性漂移 $f(m) = S \\, a(m)$，这为 $m(t)$ 导出一个封闭的常微分方程：\n- 根据上述基本定律，显式地推导出以 $m_{X}(t)$、$m_{Z_{1}}(t)$ 和 $m_{Z_{2}}(t)$ 表示的这些平均场动力学，不要预先假设任何目标公式。\n- 通过求解 $f(m^{\\star}) = 0$ 来推导稳态均值 $m^{\\star}$。\n\n为了评估平均场稳态周围的噪声，请使用线性噪声近似 (LNA)，这是一种从 van Kampen 系统大小展开中推导出的二阶近似。设 $A$ 是 $f(m)$ 在 $m^{\\star}$ 处求值的雅可比矩阵（偏导数矩阵），$D$ 是由 $D = S \\, \\mathrm{diag}(a(m^{\\star})) \\, S^{\\top}$ 给出的扩散矩阵。在线性噪声近似下，稳态协方差 $\\Sigma$ 近似满足连续时间李雅普诺夫方程 $A \\, \\Sigma + \\Sigma \\, A^{\\top} + D = 0$。请从基本定义推导 $A$ 和 $D$。\n\n您的程序必须：\n- 对每组参数，在平均场封闭下计算稳态均值 $m^{\\star}$。\n- 通过求解 LNA 下的李雅普诺夫方程计算稳态协方差矩阵 $\\Sigma$；将 $X$ 的方差报告为 $\\Sigma_{XX}$。\n- 对每个测试用例，汇总成对的 $[m^{\\star}_{X}, \\Sigma_{XX}]$，其中两个条目都必须是实数。\n\n使用以下参数值的测试套件，其中每个元组为 $(\\mu, \\theta, \\eta, k, \\delta)$:\n- 情况 1（一般情况）：$(20.0, 2.0, 0.5, 1.0, 0.1)$。\n- 情况 2（弱封存）：$(20.0, 2.0, 0.01, 1.0, 0.1)$。\n- 情况 3（强驱动）：$(20.0, 2.0, 0.5, 10.0, 0.1)$。\n- 情况 4（低测量增益）：$(20.0, 0.05, 0.5, 1.0, 0.1)$。\n- 情况 5（低参考值）：$(0.2, 2.0, 0.5, 1.0, 0.1)$。\n\n科学真实性与自洽性要求：\n- 所有参数 $\\mu, \\theta, \\eta, k, \\delta$ 均为严格正实数，代表在质量作用动力学下充分混合体积中的反应速率常数。没有额外的隐藏参数。\n- 除了从化学主方程 (CME)、化学计量学和质量作用倾向性出发，结合平均场封闭和线性噪声近似 (LNA) 推导出的公式外，不允许使用任何特设公式。\n\n最终输出格式：\n- 对于每个测试用例，输出 $[m^{\\star}_{X}, \\Sigma_{XX}]$ 对，两个值都四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，包含一个逗号分隔的列表，其中包含这些结果对，并用方括号括起来，例如：$[[v_{1},w_{1}],[v_{2},w_{2}],\\dots]$，其中每个 $v_{i}$ 和 $w_{i}$ 都是四舍五入到 $6$ 位小数的浮点数。\n- 不应打印任何附加文本。\n\n角度单位：无。物理单位：无。百分比：无。答案必须是无单位的实数，并四舍五入到 $6$ 位小数。",
            "solution": "该问题具有科学依据，提法恰当且内容自洽，为推导和计算所要求的量提供了所有必要信息。其建模框架基于化学主方程 (CME)、平均场封闭和线性噪声近似 (LNA)，是随机生物化学动力学和合成生物学领域的标准方法。因此，该问题是有效的。\n\n解决方案首先推导平均场动力学和 LNA 各组成部分的解析表达式，然后针对指定的测试用例进行数值计算。\n\n系统的状态是分子数量向量 $x = [x_{X}, x_{Z_{1}}, x_{Z_{2}}]^\\top$。反应及其质量作用倾向性 $a_i(x)$ 如下：\n$1$. $X$ 的生成：$\\varnothing \\xrightarrow{k x_{Z_{1}}} X$，倾向性为 $a_{1}(x) = k x_{Z_{1}}$。\n$2$. $X$ 的降解：$X \\xrightarrow{\\delta x_{X}} \\varnothing$，倾向性为 $a_{2}(x) = \\delta x_{X}$。\n$3$. $Z_{1}$ 的生成：$\\varnothing \\xrightarrow{\\mu} Z_{1}$，倾向性为 $a_{3}(x) = \\mu$。\n$4$. $Z_{2}$ 的生成：$\\varnothing \\xrightarrow{\\theta x_{X}} Z_{2}$，倾向性为 $a_{4}(x) = \\theta x_{X}$。\n$5$. 湮灭：$Z_{1} + Z_{2} \\xrightarrow{\\eta x_{Z_{1}} x_{Z_{2}}} \\varnothing$，倾向性为 $a_{5}(x) = \\eta x_{Z_{1}} x_{Z_{2}}$。\n倾向性向量为 $a(x) = [k x_{Z_{1}}, \\delta x_{X}, \\mu, \\theta x_{X}, \\eta x_{Z_{1}} x_{Z_{2}}]^\\top$。\n\n这 $5$ 个反应的状态改变向量分别为：\n$\\Delta x_1 = [1, 0, 0]^\\top$\n$\\Delta x_2 = [-1, 0, 0]^\\top$\n$\\Delta x_3 = [0, 1, 0]^\\top$\n$\\Delta x_4 = [0, 0, 1]^\\top$\n$\\Delta x_5 = [0, -1, -1]^\\top$\n这些向量构成了化学计量矩阵 $S \\in \\mathbb{R}^{3 \\times 5}$ 的列：\n$$\nS = \\begin{pmatrix}\n1  -1  0  0  0 \\\\\n0  0  1  0  -1 \\\\\n0  0  0  1  -1\n\\end{pmatrix}\n$$\n平均物种数量 $m(t) = \\mathbb{E}[x(t)]$ 的演化由 $\\frac{d}{dt}m = S \\mathbb{E}[a(x)]$ 控制。我们应用平均场封闭，该方法将倾向性的期望近似为期望的倾向性：$\\mathbb{E}[a(x)] \\approx a(\\mathbb{E}[x]) = a(m)$。这为均值提供了一个封闭的常微分方程 (ODEs) 系统，$\\frac{d}{dt}m = f(m) = S a(m)$。设 $m = [m_X, m_{Z_1}, m_{Z_2}]^\\top$。\n$$\n\\frac{d}{dt}m = \\begin{pmatrix}\n1  -1  0  0  0 \\\\\n0  0  1  0  -1 \\\\\n0  0  0  1  -1\n\\end{pmatrix}\n\\begin{pmatrix}\nk m_{Z_1} \\\\\n\\delta m_X \\\\\n\\mu \\\\\n\\theta m_X \\\\\n\\eta m_{Z_1} m_{Z_2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nk m_{Z_1} - \\delta m_X \\\\\n\\mu - \\eta m_{Z_1} m_{Z_2} \\\\\n\\theta m_X - \\eta m_{Z_1} m_{Z_2}\n\\end{pmatrix}\n$$\n平均浓度的显式 ODEs 为：\n$$\n\\begin{align*}\n\\frac{dm_X}{dt} = k m_{Z_1} - \\delta m_X \\\\\n\\frac{dm_{Z_1}}{dt} = \\mu - \\eta m_{Z_1} m_{Z_2} \\\\\n\\frac{dm_{Z_2}}{dt} = \\theta m_X - \\eta m_{Z_1} m_{Z_2}\n\\end{align*}\n$$\n为了找到稳态均值 $m^{\\star} = [m_X^\\star, m_{Z_1}^\\star, m_{Z_2}^\\star]^\\top$，我们将时间导数设为零：\n$k m_{Z_1}^\\star - \\delta m_X^\\star = 0$\n$\\mu - \\eta m_{Z_1}^\\star m_{Z_2}^\\star = 0$\n$\\theta m_X^\\star - \\eta m_{Z_1}^\\star m_{Z_2}^\\star = 0$\n从第二个和第三个方程，我们发现 $\\mu = \\theta m_X^\\star$，这给出了受调控物种 $X$ 的稳态均值：\n$$\nm_X^\\star = \\frac{\\mu}{\\theta}\n$$\n将此代入第一个方程得到 $k m_{Z_1}^\\star - \\delta (\\mu/\\theta) = 0$，解出 $m_{Z_1}^\\star$：\n$$\nm_{Z_1}^\\star = \\frac{\\delta \\mu}{k \\theta}\n$$\n将 $m_{Z_1}^\\star$ 代入第二个方程得到 $\\mu - \\eta (\\frac{\\delta \\mu}{k \\theta}) m_{Z_2}^\\star = 0$，解出 $m_{Z_2}^\\star$：\n$$\nm_{Z_2}^\\star = \\frac{\\mu k \\theta}{\\eta \\delta \\mu} = \\frac{k \\theta}{\\eta \\delta}\n$$\n接下来，我们使用线性噪声近似 (LNA) 来找到稳态协方差矩阵 $\\Sigma = \\mathbb{E}[(x - m^\\star)(x - m^\\star)^\\top]$。LNA 表明 $\\Sigma$ 满足连续时间李雅普诺夫方程：\n$$\nA \\Sigma + \\Sigma A^\\top + D = 0\n$$\n其中 $A$ 是漂移 $f(m)$ 的雅可比矩阵，$D$ 是扩散矩阵，两者都在稳态 $m^\\star$ 下求值。\n\n雅可比矩阵 $A$ 是 $A_{ij} = \\frac{\\partial f_i}{\\partial m_j} \\big|_{m=m^\\star}$。\n$$\nA = \\frac{\\partial}{\\partial m} \\begin{pmatrix} k m_{Z_1} - \\delta m_X \\\\ \\mu - \\eta m_{Z_1} m_{Z_2} \\\\ \\theta m_X - \\eta m_{Z_1} m_{Z_2} \\end{pmatrix} \\Bigg|_{m^\\star}\n= \\begin{pmatrix} -\\delta  k  0 \\\\ 0  -\\eta m_{Z_2}  -\\eta m_{Z_1} \\\\ \\theta  -\\eta m_{Z_2}  -\\eta m_{Z_1} \\end{pmatrix} \\Bigg|_{m^\\star}\n$$\n代入稳态均值：\n$$\nA = \\begin{pmatrix}\n-\\delta  k  0 \\\\\n0  -\\eta \\left(\\frac{k \\theta}{\\eta \\delta}\\right)  -\\eta \\left(\\frac{\\delta \\mu}{k \\theta}\\right) \\\\\n\\theta  -\\eta \\left(\\frac{k \\theta}{\\eta \\delta}\\right)  -\\eta \\left(\\frac{\\delta \\mu}{k \\theta}\\right)\n\\end{pmatrix}\n= \\begin{pmatrix}\n-\\delta  k  0 \\\\\n0  -\\frac{k\\theta}{\\delta}  -\\frac{\\eta\\delta\\mu}{k\\theta} \\\\\n\\theta  -\\frac{k\\theta}{\\delta}  -\\frac{\\eta\\delta\\mu}{k\\theta}\n\\end{pmatrix}\n$$\n扩散矩阵 $D$ 由 $D = S \\, \\text{diag}(a(m^\\star)) \\, S^\\top$ 给出。首先，我们在稳态下计算倾向性：\n$a_1(m^\\star) = k m_{Z_1}^\\star = \\frac{\\delta\\mu}{\\theta}$\n$a_2(m^\\star) = \\delta m_X^\\star = \\frac{\\delta\\mu}{\\theta}$\n$a_3(m^\\star) = \\mu$\n$a_4(m^\\star) = \\theta m_X^\\star = \\mu$\n$a_5(m^\\star) = \\eta m_{Z_1}^\\star m_{Z_2}^\\star = \\mu$\n设 $W = \\text{diag}(a(m^\\star)) = \\text{diag}(\\frac{\\delta\\mu}{\\theta}, \\frac{\\delta\\mu}{\\theta}, \\mu, \\mu, \\mu)$。\n$$\nD = S W S^\\top = \\begin{pmatrix} 1  -1  0  0  0 \\\\ 0  0  1  0  -1 \\\\ 0  0  0  1  -1 \\end{pmatrix}\n\\begin{pmatrix} \\frac{\\delta\\mu}{\\theta}  0  0  0  0 \\\\ 0  \\frac{\\delta\\mu}{\\theta}  0  0  0 \\\\ 0  0  \\mu  0  0 \\\\ 0  0  0  \\mu  0 \\\\ 0  0  0  0  \\mu \\end{pmatrix}\n\\begin{pmatrix} 1  0  0 \\\\ -1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\\\ 0  -1  -1 \\end{pmatrix}\n$$\n执行矩阵乘法得到：\n$$\nD = \\begin{pmatrix}\na_1(m^\\star) + a_2(m^\\star)  0  0 \\\\\n0  a_3(m^\\star) + a_5(m^\\star)  a_5(m^\\star) \\\\\n0  a_5(m^\\star)  a_4(m^\\star) + a_5(m^\\star)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2\\frac{\\delta\\mu}{\\theta}  0  0 \\\\\n0  2\\mu  \\mu \\\\\n0  \\mu  2\\mu\n\\end{pmatrix}\n$$\n最后，对于测试套件中提供的每组参数，我们使用推导出的公式数值构建矩阵 $A$ 和 $D$。然后使用标准的数值线性代数程序求解李雅普诺夫方程 $A\\Sigma + \\Sigma A^\\top = -D$，得到唯一的对称正定矩阵 $\\Sigma$。我们感兴趣的量是物种 $X$ 的稳态均值 $m_X^\\star$ 及其方差 $\\Sigma_{XX} = \\Sigma_{11}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_lyapunov\n\ndef compute_metrics(params):\n    \"\"\"\n    Computes the steady-state mean and variance for the antithetic controller.\n\n    Args:\n        params (tuple): A tuple of parameters (mu, theta, eta, k, delta).\n\n    Returns:\n        list: A list containing [m_X_star, Sigma_XX].\n    \"\"\"\n    mu, theta, eta, k, delta = params\n\n    # 1. Calculate the steady-state mean m_star = [m_X, m_Z1, m_Z2]\n    # All parameters are strictly positive, so division is safe.\n    m_X_star = mu / theta\n    m_Z1_star = (delta * mu) / (k * theta)\n    m_Z2_star = (k * theta) / (eta * delta)\n\n    # 2. Construct the Jacobian matrix A at m_star\n    A = np.zeros((3, 3), dtype=float)\n    A[0, 0] = -delta\n    A[0, 1] = k\n    # A[0, 2] = 0 is default\n    # A[1, 0] = 0 is default\n    A[1, 1] = -eta * m_Z2_star\n    A[1, 2] = -eta * m_Z1_star\n    A[2, 0] = theta\n    A[2, 1] = -eta * m_Z2_star\n    A[2, 2] = -eta * m_Z1_star\n\n    # 3. Construct the Diffusion matrix D at m_star\n    D = np.zeros((3, 3), dtype=float)\n    D[0, 0] = 2 * delta * mu / theta\n    D[1, 1] = 2 * mu\n    D[2, 2] = 2 * mu\n    D[1, 2] = mu\n    D[2, 1] = mu\n    \n    # 4. Solve the continuous-time Lyapunov equation: A*Sigma + Sigma*A.T = -D\n    # The solver expects A*X + X*A.T = Q, so we pass Q = -D.\n    Sigma = solve_lyapunov(A, -D)\n\n    # 5. Extract the variance of the regulated species X, which is the (0,0) element of Sigma.\n    Sigma_XX = Sigma[0, 0]\n\n    return [m_X_star, Sigma_XX]\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (mu, theta, eta, k, delta)\n    test_cases = [\n        (20.0, 2.0, 0.5, 1.0, 0.1),\n        (20.0, 2.0, 0.01, 1.0, 0.1),\n        (20.0, 2.0, 0.5, 10.0, 0.1),\n        (20.0, 0.05, 0.5, 1.0, 0.1),\n        (0.2, 2.0, 0.5, 1.0, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        result_pair = compute_metrics(case)\n        results.append(result_pair)\n\n    # Final print statement in the exact required format.\n    # e.g., [[v1,w1],[v2,w2],...] with 6 decimal places for each float.\n    formatted_pairs = [f\"[{pair[0]:.6f},{pair[1]:.6f}]\" for pair in results]\n    output_string = \"[\" + \",\".join(formatted_pairs) + \"]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}