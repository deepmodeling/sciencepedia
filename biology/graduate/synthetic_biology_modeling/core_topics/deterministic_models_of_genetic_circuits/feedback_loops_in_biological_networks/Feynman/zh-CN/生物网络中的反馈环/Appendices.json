{
    "hands_on_practices": [
        {
            "introduction": "负自动调节是生物网络中最基本和普遍的控制基序之一，它在稳定基因表达和加速响应方面起着至关重要的作用。通过分析一个单基因负反馈回路的稳态行为，你将练习如何将生物学情景转化为数学模型，并求解其平衡点。这项练习  为理解更复杂的网络动力学奠定了坚实的数学基础。",
            "id": "3913123",
            "problem": "在一个实现负自动调节的合成基因回路中，蛋白质浓度 $x$ 根据常微分方程（ODE）进行确定性演化\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1 + (x/K)^{n}} \\;-\\; \\beta\\,x,\n$$\n其中 $\\alpha0$ 是最大合成速率，$\\beta0$ 是一阶有效损失速率， $K0$ 是设定抑制阈值的解离常数，而 $n\\geq 1$ 是表征结合协同性的希尔系数。假设条件混合均匀，且只有一个有效的调控步骤，因此上述ODE能够捕捉负反馈下蛋白质表达的粗粒度动力学。\n\n从稳态满足 $\\dot{x}=0$ 的基本建模原理和转录控制的标准希尔抑制形式出发，推导定义平衡表达水平 $x^{*}$ 的稳态条件，并使用第一性原理（单调性和连续性）来论证对于 $\\alpha0$, $\\beta0$, $K0$, 和 $n\\geq 1$ 是否存在唯一的正稳态。然后，特化到非协同情况 $n=1$，并以参数 $\\alpha$、$\\beta$ 和 $K$ 的函数形式，求解 $x^{*}$ 的精确闭合形式解。最后，说明 $x^{*}$ 如何依赖于参数 $(\\alpha,\\beta,K,n)$，明确在非协同情况 $n=1$ 下哪些是递增或递减依赖关系，并阐明 $n$ 的作用。\n\n提供非协同情况 $n=1$ 的最终显式表达式。不要四舍五入；将答案保留为精确的解析形式。最终答案不需要单位。",
            "solution": "用户想要分析具有负自动调节功能的合成基因回路的稳态特性。\n\n### 步骤1：提取已知条件\n该问题描述了蛋白质浓度 $x$ 的动力学，其常微分方程（ODE）如下：\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1 + (x/K)^{n}} \\;-\\; \\beta\\,x\n$$\n参数定义如下：\n- $\\alpha  0$：最大合成速率。\n- $\\beta  0$：一阶有效损失速率。\n- $K  0$：解离常数（抑制阈值）。\n- $n \\geq 1$：希尔系数。\n\n任务是：\n1.  推导平衡表达水平 $x^{*}$ 的稳态条件。\n2.  论证在给定参数约束下正稳态的存在性和唯一性。\n3.  求解在 $n=1$ 特殊情况下的 $x^{*}$ 的精确闭合表达式。\n4.  描述 $x^{*}$ 对参数的依赖关系，特别是在 $n=1$ 的情况下。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n\n- **科学基础：** 所提供的ODE是系统生物学和合成生物学中描述负自动调节的经典模型。使用希尔函数进行转录调控和使用一阶项表示降解/稀释是一种标准且成熟的方法。该模型牢固地建立在生物化学动力学的基本原理之上。\n- **适定性：** 问题陈述清晰。它要求进行推导、唯一性证明以及一个特殊情况下的具体解。这些是对动力学系统的标准数学分析，问题的结构能够导出一个唯一且有意义的解。\n- **客观性：** 该问题使用精确、客观和标准的科学术语进行表述。没有主观或含糊的陈述。\n- **完整性与一致性：** 该问题提供了进行所需分析的所有必要信息（ODE和参数约束）。没有缺失的定义或矛盾之处。\n\n该问题没有验证清单中列出的任何缺陷。它是定量生物学领域中一个有效、适定且标准的问题。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整的解决方案。\n\n### 解题推导\n\n分析首先建立稳态的一般条件，然后证明正稳态的存在性和唯一性，最后在专门的非协同情况下求解该稳态。\n\n动力学系统的稳态是指系统变量不随时间变化的状态。对于给定的系统，稳态浓度（表示为 $x^{*}$）是变化率 $\\dot{x}$ 为零时的 $x$ 值。\n$$\n\\dot{x} = 0\n$$\n代入给定的ODE，稳态条件为：\n$$\n\\frac{\\alpha}{1 + (x^{*}/K)^{n}} - \\beta x^{*} = 0\n$$\n该方程隐式地定义了稳态浓度 $x^{*}$。通过将蛋白质合成速率与蛋白质损失速率相等，可以将其改写为：\n$$\n\\frac{\\alpha}{1 + (x^{*}/K)^{n}} = \\beta x^{*}\n$$\n\n为了确定是否存在唯一的正稳态，我们分析 $x  0$ 时两个函数 $x$ 的交点：生产速率函数 $P(x) = \\frac{\\alpha}{1 + (x/K)^{n}}$ 和降解速率函数 $D(x) = \\beta x$。稳态 $x^{*}$ 对应于 $P(x^{*}) = D(x^{*})$ 的点。\n\n我们分析这两个函数在 $x \\geq 0$ 时的性质：\n\n1.  **生产速率, $P(x)$：**\n    -   在 $x=0$ 时，生产速率达到最大值：$P(0) = \\frac{\\alpha}{1 + 0} = \\alpha$。由于 $\\alpha  0$，因此 $P(0)  0$。\n    -   $P(x)$ 对于所有 $x \\geq 0$ 都是一个连续函数。\n    -   对于 $x  0$，$P(x)$ 是一个严格单调递减的函数。随着 $x$ 的增加，项 $(x/K)^{n}$ 增加（因为 $K0, n \\geq 1$），这使得分母 $1+(x/K)^n$ 增加。因此，分数 $P(x)$ 减小。\n    -   在极限情况下，当 $x \\to \\infty$ 时，分母无界增长，所以生产速率趋近于零：$\\lim_{x \\to \\infty} P(x) = 0$。\n\n2.  **降解速率, $D(x)$：**\n    -   在 $x=0$ 时，降解速率为零：$D(0) = \\beta \\cdot 0 = 0$。\n    -   $D(x)$ 对于所有 $x \\geq 0$ 都是一个连续函数。\n    -   对于 $x  0$，$D(x)$ 是一个严格单调递增的函数。它代表一条穿过原点且斜率为正值 $\\beta$ 的直线。\n\n通过比较这两个函数：\n-   在 $x=0$ 时，我们有 $P(0) = \\alpha$ 和 $D(0) = 0$。由于 $\\alpha  0$，我们有 $P(0)  D(0)$。\n-   当 $x \\to \\infty$ 时，我们有 $P(x) \\to 0$ 和 $D(x) \\to \\infty$。因此，对于一个足够大的 $x$ 值，我们必然有 $D(x)  P(x)$。\n\n由于 $P(x)$ 和 $D(x)$ 都是连续函数，并且函数 $f(x) = P(x) - D(x)$ 在 $x=0$ 时为正，而在 $x$ 很大时为负，根据介值定理，必然存在至少一个根 $x^{*}  0$，使得 $f(x^{*}) = 0$，即 $P(x^{*}) = D(x^{*})$。\n\n为了证明唯一性，我们观察到对于 $x  0$，$P(x)$ 是严格递减的，而 $D(x)$ 是严格递增的。一个严格递减的函数和一个严格递增的函数在 $x  0$ 的区间内最多只能相交一次。因此，正稳态 $x^{*}$ 是唯一的。这对所有 $\\alpha0$、$\\beta0$、 $K0$ 和 $n\\geq 1$ 都成立。\n\n接下来，我们特化到非协同情况，即希尔系数 $n=1$。稳态方程变为：\n$$\n\\frac{\\alpha}{1 + x^{*}/K} - \\beta x^{*} = 0\n$$\n为了求解 $x^{*}$，我们重新整理方程：\n$$\n\\alpha = \\beta x^{*} \\left(1 + \\frac{x^{*}}{K}\\right)\n$$\n$$\n\\alpha = \\beta x^{*} + \\frac{\\beta}{K} (x^{*})^{2}\n$$\n这是一个关于变量 $x^{*}$ 的二次方程：\n$$\n\\frac{\\beta}{K} (x^{*})^{2} + \\beta x^{*} - \\alpha = 0\n$$\n我们使用二次公式 $x^{*} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中 $a = \\frac{\\beta}{K}$，$b = \\beta$，以及 $c = -\\alpha$。\n$$\nx^{*} = \\frac{-\\beta \\pm \\sqrt{\\beta^2 - 4\\left(\\frac{\\beta}{K}\\right)(-\\alpha)}}{2\\left(\\frac{\\beta}{K}\\right)}\n$$\n$$\nx^{*} = \\frac{-\\beta \\pm \\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}}{\\frac{2\\beta}{K}}\n$$\n由于蛋白质浓度 $x^{*}$ 必须是一个正的物理量，我们必须选择正根（‘-’号会产生一个负值）。\n$$\nx^{*} = \\frac{-\\beta + \\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}}{\\frac{2\\beta}{K}}\n$$\n我们可以通过从平方根项中提出因子 $\\beta$ 来简化这个表达式：\n$$\nx^{*} = \\frac{-\\beta + \\sqrt{\\beta^2 \\left(1 + \\frac{4\\alpha}{\\beta K}\\right)}}{\\frac{2\\beta}{K}} = \\frac{-\\beta + \\beta\\sqrt{1 + \\frac{4\\alpha}{\\beta K}}}{\\frac{2\\beta}{K}}\n$$\n将分子和分母同时除以 $\\beta$（因为 $\\beta  0$）：\n$$\nx^{*} = \\frac{-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}}{\\frac{2}{K}}\n$$\n乘以 $\\frac{K}{2}$ 得到当 $n=1$ 时 $x^{*}$ 的最终显式表达式：\n$$\nx^{*} = \\frac{K}{2} \\left(-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)\n$$\n\n最后，我们分析稳态 $x^{*}$ 对参数的依赖性。\n在一般情况下，从图形分析中我们可以推断：\n- 增加 $\\alpha$（最大生产速率）会使 $P(x)$ 曲线向上移动，从而增加交点 $x^{*}$。所以 $x^{*}$ 是 $\\alpha$ 的递增函数。\n- 增加 $\\beta$（损失速率）会增加 $D(x)$ 直线的斜率，从而减小交点 $x^{*}$。所以 $x^{*}$ 是 $\\beta$ 的递减函数。\n- 增加 $K$（抑制阈值）会对于给定的 $x$ 削弱抑制作用，这意味着对于任何 $x0$，$P(x)$ 都会增加。这会使 $P(x)$ 曲线向上移动，从而增加交点 $x^{*}$。所以 $x^{*}$ 是 $K$ 的递增函数。\n- 希尔系数 $n$ 控制抑制的陡峭程度。增加 $n$ 会使反馈更具开关特性。对于 $x  K$，增加 $n$ 会提高生产曲线 $P(x)$；而对于 $x  K$，则会降低它。因此，它对 $x^*$ 的影响取决于其他参数。\n\n对于非协同情况 $n=1$，我们可以从显式解中验证这些依赖关系：\n$$\nx^{*} = \\frac{K}{2} \\left(-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)\n$$\n- 随着 $\\alpha$ 的增加，平方根下的项增加，所以 $x^{*}$ 增加。\n- 随着 $\\beta$ 的增加，平方根下的项减小，所以 $x^{*}$ 减小。\n- 随着 $K$ 的增加，依赖关系更为复杂。令 $f(K) = x^{*}$。如在准备思路中所示，导数 $\\frac{df}{dK} = \\frac{(\\sqrt{1+4\\alpha/(\\beta K)}-1)^2}{4\\sqrt{1+4\\alpha/(\\beta K)}}$ 对于正参数总是为正，所以 $x^{*}$ 是 $K$ 的递增函数。\n这些对于 $n=1$ 的显式依赖关系证实了从一般图形分析得出的结论。",
            "answer": "$$\n\\boxed{\\frac{K}{2} \\left(-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)}\n$$"
        },
        {
            "introduction": "设计具有特定功能的鲁棒生物回路是合成生物学的核心目标。要实现这一点，我们必须能够比较不同网络结构的性能，例如它们抵抗扰动的能力。本练习  引导你通过量化分析，对比非相干前馈环 (incoherent feedforward loop, IFFL) 和积分反馈这两种经典控制策略在实现适应性方面的差异，从而深入理解鲁棒生物系统背后的设计原理。",
            "id": "3913185",
            "problem": "一个合成生物学团队正在评估用于基因表达模块中稳健适应的两种经典控制基序：非相干前馈环（IFFL）和积分反馈控制器。输出是一种单一蛋白质，其浓度由 $y(t)$ 表示。\n\n为实现生物学真实性，假设以下基本依据和建模假定：\n- 每个物种的生成和降解遵循可从分子生物学中心法则推导的质量作用动力学，其中线性降解由一级速率常数表征。\n- 稳态通过将时间导数设为零来定义。\n\n电路 A（非相干前馈环）：一个外部输入信号 $U$ 驱动两个作用于输出的中间物种，一个激活剂 $X$ 和一个阻遏剂 $Z$。其动力学方程为\n$$\n\\frac{dX}{dt} = \\alpha_{x} U - \\beta_{x} X,\\quad\n\\frac{dZ}{dt} = \\alpha_{z} U - \\beta_{z} Z,\\quad\n\\frac{dy}{dt} = r_{0} + k_{x} X - k_{z} Z - \\gamma y.\n$$\n该电路在标称参数下经过调整，以表现出 $y$ 对恒定 $U$ 的完美适应（即 $U$ 的变化不改变 $y$ 的稳态），这与约束条件 $k_{x}\\alpha_{x}/\\beta_{x} = k_{z}\\alpha_{z}/\\beta_{z}$ 一致。基础生产强度发生参数漂移，建模为 $r_{0} \\to r_{0}(1+\\delta)$，其中 $\\delta$ 是一个小的恒定漂移参数。在整个实验过程中，$U$ 保持恒定。将标称设定点 $y_{\\mathrm{ref}}$ 定义为 $\\delta=0$ 时的稳态输出。\n\n电路 B（带泄漏的积分反馈控制器）：一个控制器变量 $I(t)$ 对输出误差进行积分，并带有一个小的泄漏。其动力学方程为\n$$\n\\frac{dy}{dt} = r_{0}(1+\\delta) + k\\,I - \\gamma y,\\quad\n\\frac{dI}{dt} = \\mu\\,(y_{\\mathrm{ref}} - y) - \\lambda\\,I,\n$$\n其中 $\\mu$ 是积分增益，$\\lambda$ 是泄漏率，$k$ 是执行器增益。该电路的构造使得在 $\\delta=0$ 时，稳态满足 $y=y_{\\mathrm{ref}}$。\n\n仅使用所述的基本依据和假定，推导电路 A 的稳态误差 $e_{\\mathrm{IFFL}}$ 和电路 B 的稳态误差 $e_{\\mathrm{INT}}$，其中 $e \\equiv y - y_{\\mathrm{ref}}$，然后计算比率 $R = e_{\\mathrm{IFFL}}/e_{\\mathrm{INT}}$，以符号参数表示的闭式解析表达式。将 $R$ 的最终答案表示为一个无量纲的解析表达式。不需要四舍五入，该比率也不需要单位。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的、客观的和完整的。它提出了一个合成生物电路建模中的标准问题，比较了两种经典控制基序的扰动抑制特性。所有定义都清晰明了，所需的参数均以符号形式提供。因此，我们可以进行推导。\n\n目标是计算比率 $R = e_{\\mathrm{IFFL}}/e_{\\mathrm{INT}}$，其中 $e_{\\mathrm{IFFL}}$ 和 $e_{\\mathrm{INT}}$ 分别是非相干前馈环（电路 A）和带泄漏的积分反馈控制器（电路 B）在基础生产率 $r_{0}$ 发生扰动时的稳态误差。误差定义为 $e \\equiv y - y_{\\mathrm{ref}}$，其中 $y_{\\mathrm{ref}}$ 是标称稳态输出。\n\n首先，我们分析电路 A (IFFL)。其动力学方程由下式给出：\n$$\n\\frac{dX}{dt} = \\alpha_{x} U - \\beta_{x} X\n$$\n$$\n\\frac{dZ}{dt} = \\alpha_{z} U - \\beta_{z} Z\n$$\n$$\n\\frac{dy}{dt} = r_{0}(1+\\delta) + k_{x} X - k_{z} Z - \\gamma y\n$$\n在稳态下，时间导数为零。从前两个方程，我们求得 $X$ 和 $Z$ 的稳态浓度：\n$$\nX_{ss} = \\frac{\\alpha_{x}}{\\beta_{x}} U\n$$\n$$\nZ_{ss} = \\frac{\\alpha_{z}}{\\beta_{z}} U\n$$\n将这些代入 $y$ 的稳态方程中：\n$$\n0 = r_{0}(1+\\delta) + k_{x} X_{ss} - k_{z} Z_{ss} - \\gamma y_{ss}\n$$\n$$\n\\gamma y_{ss} = r_{0}(1+\\delta) + k_{x} \\left(\\frac{\\alpha_{x}}{\\beta_{x}} U\\right) - k_{z} \\left(\\frac{\\alpha_{z}}{\\beta_{z}} U\\right)\n$$\n$$\ny_{ss} = \\frac{1}{\\gamma} \\left( r_{0}(1+\\delta) + U \\left( \\frac{k_{x}\\alpha_{x}}{\\beta_{x}} - \\frac{k_{z}\\alpha_{z}}{\\beta_{z}} \\right) \\right)\n$$\n问题陈述指出，该电路经过调整以实现对输入 $U$ 的完美适应，这意味着存在约束条件 $\\frac{k_{x}\\alpha_{x}}{\\beta_{x}} = \\frac{k_{z}\\alpha_{z}}{\\beta_{z}}$。应用此约束条件可以简化稳态输出 $y_{ss,A}$ 的表达式：\n$$\ny_{ss,A} = \\frac{1}{\\gamma} \\left( r_{0}(1+\\delta) \\right) = \\frac{r_{0}(1+\\delta)}{\\gamma}\n$$\n标称设定点 $y_{\\mathrm{ref}}$ 是漂移参数 $\\delta=0$ 时的稳态输出。\n$$\ny_{\\mathrm{ref}} = \\frac{r_{0}(1+0)}{\\gamma} = \\frac{r_{0}}{\\gamma}\n$$\nIFFL 的稳态误差 $e_{\\mathrm{IFFL}}$ 是受扰动后的稳态输出与标称设定点之间的差值：\n$$\ne_{\\mathrm{IFFL}} = y_{ss,A} - y_{\\mathrm{ref}} = \\frac{r_{0}(1+\\delta)}{\\gamma} - \\frac{r_{0}}{\\gamma} = \\frac{r_{0} + r_{0}\\delta - r_{0}}{\\gamma} = \\frac{r_{0}\\delta}{\\gamma}\n$$\n\n接下来，我们分析电路 B（带泄漏的积分反馈）。其动力学方程为：\n$$\n\\frac{dy}{dt} = r_{0}(1+\\delta) + k\\,I - \\gamma y\n$$\n$$\n\\frac{dI}{dt} = \\mu\\,(y_{\\mathrm{ref}} - y) - \\lambda\\,I\n$$\n我们通过将时间导数设为零来求解稳态：\n$$\n0 = r_{0}(1+\\delta) + k\\,I_{ss} - \\gamma y_{ss} \\quad (1)\n$$\n$$\n0 = \\mu\\,(y_{\\mathrm{ref}} - y_{ss}) - \\lambda\\,I_{ss} \\quad (2)\n$$\n首先让我们确认问题陈述的一致性。在 $\\delta=0$ 时，问题陈述指出 $y_{ss} = y_{\\mathrm{ref}}$。将此代入方程 (2) 得到 $0 = \\mu(y_{\\mathrm{ref}}-y_{\\mathrm{ref}}) - \\lambda I_{ss}$，这意味着 $\\lambda I_{ss} = 0$。由于 $\\lambda$ 是一个物理泄漏率，我们假设 $\\lambda \\neq 0$，因此 $I_{ss}=0$。将 $y_{ss}=y_{\\mathrm{ref}}$、$I_{ss}=0$ 和 $\\delta=0$ 代入方程 (1) 得到 $0 = r_0 + k(0) - \\gamma y_{\\mathrm{ref}}$，从而得出 $y_{\\mathrm{ref}} = r_0/\\gamma$。这与从电路 A 推导出的值一致。\n\n现在，我们求解对于一般 $\\delta$ 的稳态误差 $e_{\\mathrm{INT}} = y_{ss} - y_{\\mathrm{ref}}$。我们可以将 $y_{ss}$ 表示为 $y_{ss} = e_{\\mathrm{INT}} + y_{\\mathrm{ref}}$。将此代入稳态方程：\n从方程 (2) 得：\n$$\n0 = \\mu\\,(y_{\\mathrm{ref}} - (e_{\\mathrm{INT}} + y_{\\mathrm{ref}})) - \\lambda\\,I_{ss}\n$$\n$$\n0 = -\\mu\\,e_{\\mathrm{INT}} - \\lambda\\,I_{ss} \\implies I_{ss} = -\\frac{\\mu}{\\lambda} e_{\\mathrm{INT}}\n$$\n现在将 $I_{ss}$ 的这个表达式和 $y_{ss} = e_{\\mathrm{INT}} + y_{\\mathrm{ref}}$ 代入方程 (1)：\n$$\n0 = r_{0}(1+\\delta) + k\\left(-\\frac{\\mu}{\\lambda} e_{\\mathrm{INT}}\\right) - \\gamma(e_{\\mathrm{INT}} + y_{\\mathrm{ref}})\n$$\n$$\n0 = r_{0} + r_{0}\\delta - \\frac{k\\mu}{\\lambda}e_{\\mathrm{INT}} - \\gamma e_{\\mathrm{INT}} - \\gamma y_{\\mathrm{ref}}\n$$\n代入 $y_{\\mathrm{ref}} = r_0/\\gamma$：\n$$\n0 = r_{0} + r_{0}\\delta - \\frac{k\\mu}{\\lambda}e_{\\mathrm{INT}} - \\gamma e_{\\mathrm{INT}} - \\gamma \\left(\\frac{r_{0}}{\\gamma}\\right)\n$$\n$$\n0 = r_{0} + r_{0}\\delta - \\frac{k\\mu}{\\lambda}e_{\\mathrm{INT}} - \\gamma e_{\\mathrm{INT}} - r_{0}\n$$\n$r_0$ 项相互抵消，剩下：\n$$\n0 = r_{0}\\delta - e_{\\mathrm{INT}}\\left(\\frac{k\\mu}{\\lambda} + \\gamma\\right)\n$$\n求解 $e_{\\mathrm{INT}}$：\n$$\ne_{\\mathrm{INT}}\\left(\\gamma + \\frac{k\\mu}{\\lambda}\\right) = r_{0}\\delta\n$$\n$$\ne_{\\mathrm{INT}}\\left(\\frac{\\gamma\\lambda + k\\mu}{\\lambda}\\right) = r_{0}\\delta\n$$\n$$\ne_{\\mathrm{INT}} = \\frac{r_{0}\\delta\\lambda}{\\gamma\\lambda + k\\mu}\n$$\n\n最后，我们计算比率 $R = e_{\\mathrm{IFFL}}/e_{\\mathrm{INT}}$。\n$$\nR = \\frac{e_{\\mathrm{IFFL}}}{e_{\\mathrm{INT}}} = \\frac{\\frac{r_{0}\\delta}{\\gamma}}{\\frac{r_{0}\\delta\\lambda}{\\gamma\\lambda + k\\mu}}\n$$\n假设存在非平凡扰动（$\\delta \\neq 0$ 且 $r_0 \\neq 0$），我们可以简化表达式：\n$$\nR = \\frac{r_{0}\\delta}{\\gamma} \\cdot \\frac{\\gamma\\lambda + k\\mu}{r_{0}\\delta\\lambda}\n$$\n$$\nR = \\frac{\\gamma\\lambda + k\\mu}{\\gamma\\lambda}\n$$\n$$\nR = \\frac{\\gamma\\lambda}{\\gamma\\lambda} + \\frac{k\\mu}{\\gamma\\lambda} = 1 + \\frac{k\\mu}{\\gamma\\lambda}\n$$\n这就是稳态误差比率的最终无量纲表达式。",
            "answer": "$$\n\\boxed{1 + \\frac{k\\mu}{\\gamma\\lambda}}\n$$"
        },
        {
            "introduction": "确定性模型是理解生物系统的有力工具，但细胞过程本质上是随机的。本练习  将我们从确定性框架带入随机领域，专注于分析一种强大的合成回路——对冲积分反馈控制器 (antithetic integral feedback controller)，它能够在噪声存在的情况下实现近乎完美的适应性。通过应用矩封闭近似 (moment-closure approximation) 和线性噪声近似 (Linear Noise Approximation, LNA) 等高等技术，你将量化该控制器在随机环境下的均值和涨落，体验前沿的系统生物学建模方法。",
            "id": "3913082",
            "problem": "您需要实现并验证一个基于矩封闭的分析方法，该方法用于分析一个典型的随机反向积分反馈控制器，此控制器调控单一分子种类。该控制器被建模为一个充分混合的、连续时间的、在有限分子种类集合上的马尔可夫跳跃过程，其反应遵循质量作用动力学。您的任务是基于第一性原理推导平均场动力学和一个二阶噪声近似，然后实现一个程序，该程序为一组指定的测试参数计算受调控种类的稳态均值和方差。\n\n从化学主方程 (CME) 开始，它给出了分子数量概率分布随时间的演化。将状态向量表示为 $x = [x_{X}, x_{Z_{1}}, x_{Z_{2}}]^{\\top}$，其中 $x_{X}$ 是受调控种类 $X$ 的数量，而 $x_{Z_{1}}$ 和 $x_{Z_{2}}$ 是两种反向控制器种类 $Z_{1}$ 和 $Z_{2}$ 的数量。反应网络如下：\n- $X$ 的生成：$\\varnothing \\xrightarrow{k x_{Z_{1}}} X$，倾向函数为 $a_{1}(x) = k x_{Z_{1}}$。\n- $X$ 的降解：$X \\xrightarrow{\\delta x_{X}} \\varnothing$，倾向函数为 $a_{2}(x) = \\delta x_{X}$。\n- 到 $Z_{1}$ 的参考输入：$\\varnothing \\xrightarrow{\\mu} Z_{1}$，倾向函数为 $a_{3}(x) = \\mu$。\n- 到 $Z_{2}$ 的测量：$\\varnothing \\xrightarrow{\\theta x_{X}} Z_{2}$，倾向函数为 $a_{4}(x) = \\theta x_{X}$。\n- 反向湮灭：$Z_{1} + Z_{2} \\xrightarrow{\\eta x_{Z_{1}} x_{Z_{2}}} \\varnothing$，倾向函数为 $a_{5}(x) = \\eta x_{Z_{1}} x_{Z_{2}}$。\n\n设化学计量矩阵为 $S \\in \\mathbb{R}^{3 \\times 5}$，其列是反应 $1$ 到 $5$（按上述顺序排列）的状态改变向量。CME 蕴含了通过 $ \\frac{d}{dt} \\mathbb{E}[x] = S \\, \\mathbb{E}[a(x)] $ 的精确矩演化，其中 $a(x) = [a_{1}(x), a_{2}(x), a_{3}(x), a_{4}(x), a_{5}(x)]^{\\top}$。因为 $a_{5}(x)$ 在 $x_{Z_{1}}$ 和 $x_{Z_{2}}$ 中是双线性的，所以在没有近似的情况下，均值动力学是不封闭的。\n\n通过近似 $\\mathbb{E}[a(x)] \\approx a(\\mathbb{E}[x])$ 来实现平均场封闭。在此封闭下，您会得到均值 $m = \\mathbb{E}[x]$ 的确定性漂移 $f(m) = S \\, a(m)$，这为 $m(t)$ 产生了一个封闭的常微分方程：\n- 从上述基本定律出发，明确地以 $m_{X}(t)$、$m_{Z_{1}}(t)$ 和 $m_{Z_{2}}(t)$ 的形式推导这些平均场动力学，而不要预先假设任何目标公式。\n- 通过求解 $f(m^{\\star}) = 0$ 来推导稳态均值 $m^{\\star}$。\n\n为了评估平均场稳态周围的噪声，使用线性噪声近似 (LNA)，这是一种从 van Kampen 系统大小展开推导出的二阶近似。设 $A$ 是 $f(m)$ 在 $m^{\\star}$ 处求值的雅可比矩阵（偏导数矩阵），设 $D$ 是由 $D = S \\, \\mathrm{diag}(a(m^{\\star})) \\, S^{\\top}$ 给出的扩散矩阵。在线性噪声近似下，稳态协方差 $\\Sigma$ 近似满足连续时间李雅普诺夫方程 $A \\, \\Sigma + \\Sigma \\, A^{\\top} + D = 0$。从基本定义推导 $A$ 和 $D$。\n\n您的程序必须：\n- 为每个参数集计算在平均场封闭下的稳态均值 $m^{\\star}$。\n- 通过求解线性噪声近似下的李雅普诺夫方程来计算稳态协方差矩阵 $\\Sigma$；将 $X$ 的方差报告为 $\\Sigma_{XX}$。\n- 对每个测试案例，汇总对 $[m^{\\star}_{X}, \\Sigma_{XX}]$，其中两个条目都必须是实数。\n\n使用以下参数值测试套件，其中每个元组为 $(\\mu, \\theta, \\eta, k, \\delta)$:\n- 案例 $1$ (一般情况): $(20.0, 2.0, 0.5, 1.0, 0.1)$。\n- 案例 $2$ (弱螯合): $(20.0, 2.0, 0.01, 1.0, 0.1)$。\n- 案例 $3$ (强驱动): $(20.0, 2.0, 0.5, 10.0, 0.1)$。\n- 案例 $4$ (低测量增益): $(20.0, 0.05, 0.5, 1.0, 0.1)$。\n- 案例 $5$ (低参考值): $(0.2, 2.0, 0.5, 1.0, 0.1)$。\n\n科学真实性和自洽性要求：\n- 所有参数 $\\mu, \\theta, \\eta, k, \\delta$ 均为严格正实数，并代表充分混合体积中质量作用动力学下的反应速率常数。没有额外的隐藏参数。\n- 除了从化学主方程 (CME)、化学计量学和质量作用倾向函数推导出的公式，结合平均场封闭和线性噪声近似 (LNA) 之外，不允许使用任何特设公式。\n\n最终输出格式：\n- 对于每个测试案例，输出对 $[m^{\\star}_{X}, \\Sigma_{XX}]$，两个值均四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，包含一个逗号分隔的这些对的列表，并用方括号括起来，例如：$[[v_{1},w_{1}],[v_{2},w_{2}],\\dots]$，其中每个 $v_{i}$ 和 $w_{i}$ 都是四舍五入到 $6$ 位小数的浮点数。\n- 不应打印任何额外文本。\n\n角度单位：无。物理单位：无。百分比：无。答案必须是四舍五入到 $6$ 位小数的无单位实数。",
            "solution": "该问题具有科学依据，提法明确且自洽，为推导和计算所要求的量提供了所有必要的信息。该建模框架基于化学主方程 (CME)、平均场封闭和线性噪声近似 (LNA)，是随机生物化学动力学和合成生物学领域的标准方法。因此，该问题是有效的。\n\n解决方案首先推导平均场动力学和 LNA 各组成部分的解析表达式，然后对指定的测试案例进行数值计算。\n\n系统的状态是分子数量向量 $x = [x_{X}, x_{Z_{1}}, x_{Z_{2}}]^\\top$。反应及其质量作用倾向函数 $a_i(x)$ 如下：\n$1$. $X$ 的生成：$\\varnothing \\xrightarrow{k x_{Z_{1}}} X$，倾向函数为 $a_{1}(x) = k x_{Z_{1}}$。\n$2$. $X$ 的降解：$X \\xrightarrow{\\delta x_{X}} \\varnothing$，倾向函数为 $a_{2}(x) = \\delta x_{X}$。\n$3$. $Z_{1}$ 的生成：$\\varnothing \\xrightarrow{\\mu} Z_{1}$，倾向函数为 $a_{3}(x) = \\mu$。\n$4$. $Z_{2}$ 的生成：$\\varnothing \\xrightarrow{\\theta x_{X}} Z_{2}$，倾向函数为 $a_{4}(x) = \\theta x_{X}$。\n$5$. 湮灭：$Z_{1} + Z_{2} \\xrightarrow{\\eta x_{Z_{1}} x_{Z_{2}}} \\varnothing$，倾向函数为 $a_{5}(x) = \\eta x_{Z_{1}} x_{Z_{2}}$。\n倾向函数向量为 $a(x) = [k x_{Z_{1}}, \\delta x_{X}, \\mu, \\theta x_{X}, \\eta x_{Z_{1}} x_{Z_{2}}]^\\top$。\n\n这 $5$ 个反应的状态改变向量分别为：\n$\\Delta x_1 = [1, 0, 0]^\\top$\n$\\Delta x_2 = [-1, 0, 0]^\\top$\n$\\Delta x_3 = [0, 1, 0]^\\top$\n$\\Delta x_4 = [0, 0, 1]^\\top$\n$\\Delta x_5 = [0, -1, -1]^\\top$\n这些向量构成了化学计量矩阵 $S \\in \\mathbb{R}^{3 \\times 5}$ 的列：\n$$\nS = \\begin{pmatrix}\n1  -1  0  0  0 \\\\\n0  0  1  0  -1 \\\\\n0  0  0  1  -1\n\\end{pmatrix}\n$$\n平均物种数量 $m(t) = \\mathbb{E}[x(t)]$ 的演化由 $\\frac{d}{dt}m = S \\mathbb{E}[a(x)]$ 控制。我们应用平均场封闭，它通过倾向函数的期望值的倾向函数来近似倾向函数的期望值：$\\mathbb{E}[a(x)] \\approx a(\\mathbb{E}[x]) = a(m)$。这为均值提供了一个封闭的常微分方程 (ODEs) 系统，$\\frac{d}{dt}m = f(m) = S a(m)$。设 $m = [m_X, m_{Z_1}, m_{Z_2}]^\\top$。\n$$\n\\frac{d}{dt}m = \\begin{pmatrix}\n1  -1  0  0  0 \\\\\n0  0  1  0  -1 \\\\\n0  0  0  1  -1\n\\end{pmatrix}\n\\begin{pmatrix}\nk m_{Z_1} \\\\\n\\delta m_X \\\\\n\\mu \\\\\n\\theta m_X \\\\\n\\eta m_{Z_1} m_{Z_2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nk m_{Z_1} - \\delta m_X \\\\\n\\mu - \\eta m_{Z_1} m_{Z_2} \\\\\n\\theta m_X - \\eta m_{Z_1} m_{Z_2}\n\\end{pmatrix}\n$$\n平均浓度的显式 ODEs 为：\n$$\n\\begin{align*}\n\\frac{dm_X}{dt} = k m_{Z_1} - \\delta m_X \\\\\n\\frac{dm_{Z_1}}{dt} = \\mu - \\eta m_{Z_1} m_{Z_2} \\\\\n\\frac{dm_{Z_2}}{dt} = \\theta m_X - \\eta m_{Z_1} m_{Z_2}\n\\end{align*}\n$$\n为了找到稳态均值 $m^{\\star} = [m_X^\\star, m_{Z_1}^\\star, m_{Z_2}^\\star]^\\top$，我们将时间导数设为零：\n$k m_{Z_1}^\\star - \\delta m_X^\\star = 0$\n$\\mu - \\eta m_{Z_1}^\\star m_{Z_2}^\\star = 0$\n$\\theta m_X^\\star - \\eta m_{Z_1}^\\star m_{Z_2}^\\star = 0$\n从第二个和第三个方程，我们得到 $\\mu = \\theta m_X^\\star$，这给出了受调控物种 $X$ 的稳态均值：\n$$\nm_X^\\star = \\frac{\\mu}{\\theta}\n$$\n将此代入第一个方程得到 $k m_{Z_1}^\\star - \\delta (\\mu/\\theta) = 0$，解出 $m_{Z_1}^\\star$：\n$$\nm_{Z_1}^\\star = \\frac{\\delta \\mu}{k \\theta}\n$$\n将 $m_{Z_1}^\\star$ 代入第二个方程得到 $\\mu - \\eta (\\frac{\\delta \\mu}{k \\theta}) m_{Z_2}^\\star = 0$，解出 $m_{Z_2}^\\star$：\n$$\nm_{Z_2}^\\star = \\frac{\\mu k \\theta}{\\eta \\delta \\mu} = \\frac{k \\theta}{\\eta \\delta}\n$$\n接下来，我们使用线性噪声近似 (LNA) 来找到稳态协方差矩阵 $\\Sigma = \\mathbb{E}[(x - m^\\star)(x - m^\\star)^\\top]$。LNA 表明 $\\Sigma$ 满足连续时间李雅普诺夫方程：\n$$\nA \\Sigma + \\Sigma A^\\top + D = 0\n$$\n其中 $A$ 是漂移 $f(m)$ 的雅可比矩阵， $D$ 是扩散矩阵，两者都在稳态 $m^\\star$ 处进行评估。\n\n雅可比矩阵 $A$ 为 $A_{ij} = \\frac{\\partial f_i}{\\partial m_j} \\big|_{m=m^\\star}$。\n$$\nA = \\frac{\\partial}{\\partial m} \\begin{pmatrix} k m_{Z_1} - \\delta m_X \\\\ \\mu - \\eta m_{Z_1} m_{Z_2} \\\\ \\theta m_X - \\eta m_{Z_1} m_{Z_2} \\end{pmatrix} \\Bigg|_{m^\\star}\n= \\begin{pmatrix} -\\delta  k  0 \\\\ 0  -\\eta m_{Z_2}  -\\eta m_{Z_1} \\\\ \\theta  -\\eta m_{Z_2}  -\\eta m_{Z_1} \\end{pmatrix} \\Bigg|_{m^\\star}\n$$\n代入稳态均值：\n$$\nA = \\begin{pmatrix}\n-\\delta  k  0 \\\\\n0  -\\eta \\left(\\frac{k \\theta}{\\eta \\delta}\\right)  -\\eta \\left(\\frac{\\delta \\mu}{k \\theta}\\right) \\\\\n\\theta  -\\eta \\left(\\frac{k \\theta}{\\eta \\delta}\\right)  -\\eta \\left(\\frac{\\delta \\mu}{k \\theta}\\right)\n\\end{pmatrix}\n= \\begin{pmatrix}\n-\\delta  k  0 \\\\\n0  -\\frac{k\\theta}{\\delta}  -\\frac{\\eta\\delta\\mu}{k\\theta} \\\\\n\\theta  -\\frac{k\\theta}{\\delta}  -\\frac{\\eta\\delta\\mu}{k\\theta}\n\\end{pmatrix}\n$$\n扩散矩阵 $D$ 由 $D = S \\, \\text{diag}(a(m^\\star)) \\, S^\\top$ 给出。首先，我们在稳态下评估倾向函数：\n$a_1(m^\\star) = k m_{Z_1}^\\star = \\frac{\\delta\\mu}{\\theta}$\n$a_2(m^\\star) = \\delta m_X^\\star = \\frac{\\delta\\mu}{\\theta}$\n$a_3(m^\\star) = \\mu$\n$a_4(m^\\star) = \\theta m_X^\\star = \\mu$\n$a_5(m^\\star) = \\eta m_{Z_1}^\\star m_{Z_2}^\\star = \\mu$\n设 $W = \\text{diag}(a(m^\\star)) = \\text{diag}(\\frac{\\delta\\mu}{\\theta}, \\frac{\\delta\\mu}{\\theta}, \\mu, \\mu, \\mu)$。\n$$\nD = S W S^\\top = \\begin{pmatrix} 1  -1  0  0  0 \\\\ 0  0  1  0  -1 \\\\ 0  0  0  1  -1 \\end{pmatrix}\n\\begin{pmatrix} \\frac{\\delta\\mu}{\\theta}  0  0  0  0 \\\\ 0  \\frac{\\delta\\mu}{\\theta}  0  0  0 \\\\ 0  0  \\mu  0  0 \\\\ 0  0  0  \\mu  0 \\\\ 0  0  0  0  \\mu \\end{pmatrix}\n\\begin{pmatrix} 1  0  0 \\\\ -1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\\\ 0  -1  -1 \\end{pmatrix}\n$$\n执行矩阵乘法得到：\n$$\nD = \\begin{pmatrix}\na_1(m^\\star) + a_2(m^\\star)  0  0 \\\\\n0  a_3(m^\\star) + a_5(m^\\star)  a_5(m^\\star) \\\\\n0  a_5(m^\\star)  a_4(m^\\star) + a_5(m^\\star)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2\\frac{\\delta\\mu}{\\theta}  0  0 \\\\\n0  2\\mu  \\mu \\\\\n0  \\mu  2\\mu\n\\end{pmatrix}\n$$\n最后，对于测试套件中提供的每个参数集，我们使用推导出的公式数值构建矩阵 $A$ 和 $D$。然后使用标准的数值线性代数例程求解李雅普诺夫方程 $A\\Sigma + \\Sigma A^\\top = -D$，以获得唯一的对称正定矩阵 $\\Sigma$。感兴趣的量是物种 $X$ 的稳态均值 $m_X^\\star$ 及其方差 $\\Sigma_{XX} = \\Sigma_{11}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_lyapunov\n\ndef compute_metrics(params):\n    \"\"\"\n    Computes the steady-state mean and variance for the antithetic controller.\n\n    Args:\n        params (tuple): A tuple of parameters (mu, theta, eta, k, delta).\n\n    Returns:\n        list: A list containing [m_X_star, Sigma_XX].\n    \"\"\"\n    mu, theta, eta, k, delta = params\n\n    # 1. Calculate the steady-state mean m_star = [m_X, m_Z1, m_Z2]\n    # All parameters are strictly positive, so division is safe.\n    m_X_star = mu / theta\n    m_Z1_star = (delta * mu) / (k * theta)\n    m_Z2_star = (k * theta) / (eta * delta)\n\n    # 2. Construct the Jacobian matrix A at m_star\n    A = np.zeros((3, 3), dtype=float)\n    A[0, 0] = -delta\n    A[0, 1] = k\n    # A[0, 2] = 0 is default\n    # A[1, 0] = 0 is default\n    A[1, 1] = -eta * m_Z2_star\n    A[1, 2] = -eta * m_Z1_star\n    A[2, 0] = theta\n    A[2, 1] = -eta * m_Z2_star\n    A[2, 2] = -eta * m_Z1_star\n\n    # 3. Construct the Diffusion matrix D at m_star\n    D = np.zeros((3, 3), dtype=float)\n    D[0, 0] = 2 * delta * mu / theta\n    D[1, 1] = 2 * mu\n    D[2, 2] = 2 * mu\n    D[1, 2] = mu\n    D[2, 1] = mu\n    \n    # 4. Solve the continuous-time Lyapunov equation: A*Sigma + Sigma*A.T = -D\n    # The solver expects A*X + X*A.T = Q, so we pass Q = -D.\n    Sigma = solve_lyapunov(A, -D)\n\n    # 5. Extract the variance of the regulated species X, which is the (0,0) element of Sigma.\n    Sigma_XX = Sigma[0, 0]\n\n    return [m_X_star, Sigma_XX]\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (mu, theta, eta, k, delta)\n    test_cases = [\n        (20.0, 2.0, 0.5, 1.0, 0.1),\n        (20.0, 2.0, 0.01, 1.0, 0.1),\n        (20.0, 2.0, 0.5, 10.0, 0.1),\n        (20.0, 0.05, 0.5, 1.0, 0.1),\n        (0.2, 2.0, 0.5, 1.0, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        result_pair = compute_metrics(case)\n        results.append(result_pair)\n\n    # Final print statement in the exact required format.\n    # e.g., [[v1,w1],[v2,w2],...] with 6 decimal places for each float.\n    formatted_pairs = [f\"[{pair[0]:.6f},{pair[1]:.6f}]\" for pair in results]\n    output_string = \"[\" + \",\".join(formatted_pairs) + \"]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}