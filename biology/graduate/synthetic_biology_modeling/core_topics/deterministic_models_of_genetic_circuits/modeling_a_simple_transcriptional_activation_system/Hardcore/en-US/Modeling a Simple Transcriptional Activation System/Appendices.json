{
    "hands_on_practices": [
        {
            "introduction": "Before we can understand complex dynamics or noise, we must first master the system's behavior at steady state. This foundational exercise guides you through deriving the fundamental input-output relationship for a gene expression cassette, linking promoter activity to the eventual steady-state protein concentration . By treating transcription, translation, and degradation as a series of production and loss steps, you will construct a core quantitative model that serves as the backbone for analyzing more complex genetic circuits.",
            "id": "3919427",
            "problem": "Consider a minimal transcriptional activation system in a single, exponentially growing cell at constant volume, where a transcription factor $X$ with constant concentration $[X]$ activates a promoter controlling expression of a protein $P$. The following mechanistic assumptions define the model:\n\n- The promoter alternates between an inactive and an active state due to binding of $X$; the fraction of time it is active is the promoter activity function $f([X])$, which satisfies $0 \\leq f([X]) \\leq 1$. The functional form of $f([X])$ arises from an equilibrium binding model but is not specified here.\n- When the promoter is active, transcription initiates with rate constant $k_{\\mathrm{tx}}$ per gene copy, producing messenger ribonucleic acid (mRNA). Assume a single gene copy.\n- mRNA concentration, denoted $m(t)$, decays by first-order processes with rate constant $\\gamma_{m}$ and is diluted by cell growth at rate $\\mu$, so the total loss rate for mRNA is $\\gamma_{m} + \\mu$.\n- Protein concentration, denoted $p(t)$, is produced by translation with rate constant $k_{\\mathrm{tl}}$ per mRNA and decays by first-order processes with rate constant $\\gamma_{p}$ and is diluted by cell growth at rate $\\mu$, so the total loss rate for protein is $\\gamma_{p} + \\mu$.\n- The system is well-mixed, and $[X]$ is constant over time and unaffected by the dynamics of $m(t)$ and $p(t)$.\n\nStarting only from the Central Dogma of Molecular Biology (deoxyribonucleic acid to ribonucleic acid to protein) and mass-action kinetics in a well-mixed reactor, formulate ordinary differential equations (ODEs) for $m(t)$ and $p(t)$ that are consistent with the assumptions above, and use these ODEs to derive the exact steady-state protein level $p^{*}$ as a function of $[X]$ and the model parameters $k_{\\mathrm{tx}}$, $k_{\\mathrm{tl}}$, $\\gamma_{m}$, $\\gamma_{p}$, and $\\mu$. Identify explicitly how the promoter activity $f([X])$ scales the steady-state output. Express your final answer as a single closed-form analytic expression for $p^{*}$.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It represents a standard, canonical model in systems and synthetic biology for gene expression, based on the Central Dogma and mass-action kinetics. All parameters are clearly defined, and the system is not under- or over-constrained. The problem is therefore deemed valid.\n\nThe task is to formulate a mathematical model for the concentrations of messenger RNA (mRNA), $m(t)$, and protein, $p(t)$, and then to solve for the steady-state protein concentration, $p^{*}$. The model is constructed based on the principles of mass-action kinetics for a well-mixed system.\n\nFirst, we formulate the ordinary differential equation (ODE) for the mRNA concentration, $m(t)$. The rate of change of $m(t)$, denoted $\\frac{dm}{dt}$, is the difference between its rate of production and its rate of loss.\n\nThe production of mRNA is governed by transcription. The problem states that transcription initiates from a single gene copy (a concentration of $1$ gene per cell volume) with a rate constant $k_{\\mathrm{tx}}$ only when the promoter is in its active state. The fraction of time the promoter is active is given by the promoter activity function, $f([X])$. Therefore, the effective rate of transcription is the maximum rate multiplied by this fractional activity. The production term is thus $k_{\\mathrm{tx}} \\cdot 1 \\cdot f([X]) = k_{\\mathrm{tx}} f([X])$.\n\nThe loss of mRNA occurs through two first-order processes: intrinsic degradation with rate constant $\\gamma_{m}$ and dilution due to cell growth with rate $\\mu$. The problem specifies the total loss rate constant is the sum of these, $\\gamma_{m} + \\mu$. As this is a first-order process, the total loss rate is proportional to the current concentration $m(t)$. The loss term is therefore $(\\gamma_{m} + \\mu)m(t)$.\n\nCombining the production and loss terms, the ODE for $m(t)$ is:\n$$\n\\frac{dm}{dt} = k_{\\mathrm{tx}} f([X]) - (\\gamma_{m} + \\mu)m\n$$\n\nNext, we formulate the ODE for the protein concentration, $p(t)$. The rate of change $\\frac{dp}{dt}$ is similarly the difference between its production and loss rates.\n\nThe production of protein is governed by translation from mRNA. The problem states that translation occurs with a rate constant $k_{\\mathrm{tl}}$ per mRNA molecule. This is a first-order process with respect to the mRNA concentration, $m(t)$. The production term for the protein is thus $k_{\\mathrm{tl}} m(t)$.\n\nThe loss of protein, like mRNA, occurs through intrinsic degradation with rate constant $\\gamma_{p}$ and dilution due to cell growth at rate $\\mu$. The total loss rate constant is $\\gamma_{p} + \\mu$. This first-order loss process contributes a term $(\\gamma_{p} + \\mu)p(t)$.\n\nCombining the production and loss terms, the ODE for $p(t)$ is:\n$$\n\\frac{dp}{dt} = k_{\\mathrm{tl}} m - (\\gamma_{p} + \\mu)p\n$$\n\nTo find the steady-state protein level, denoted $p^{*}$, we must find the state of the system where the concentrations of both mRNA and protein are no longer changing with time. This condition, known as steady state, is defined by setting the time derivatives to zero: $\\frac{dm}{dt} = 0$ and $\\frac{dp}{dt} = 0$.\n\nLet $m^{*}$ and $p^{*}$ be the steady-state concentrations of mRNA and protein, respectively.\nFrom the mRNA ODE at steady state:\n$$\n0 = k_{\\mathrm{tx}} f([X]) - (\\gamma_{m} + \\mu)m^{*}\n$$\nSolving for $m^{*}$ gives:\n$$\n(\\gamma_{m} + \\mu)m^{*} = k_{\\mathrm{tx}} f([X])\n$$\n$$\nm^{*} = \\frac{k_{\\mathrm{tx}} f([X])}{\\gamma_{m} + \\mu}\n$$\nThis expression shows that the steady-state mRNA level is directly proportional to the promoter activity $f([X])$.\n\nNow, we use the protein ODE at steady state, substituting the steady-state mRNA concentration $m^{*}$:\n$$\n0 = k_{\\mathrm{tl}} m^{*} - (\\gamma_{p} + \\mu)p^{*}\n$$\nSolving for $p^{*}$ gives:\n$$\n(\\gamma_{p} + \\mu)p^{*} = k_{\\mathrm{tl}} m^{*}\n$$\n$$\np^{*} = \\frac{k_{\\mathrm{tl}}}{\\gamma_{p} + \\mu} m^{*}\n$$\nFinally, we substitute the expression for $m^{*}$ into the equation for $p^{*}$ to obtain the final expression for the steady-state protein concentration as a function of the input $[X]$ and the system parameters:\n$$\np^{*} = \\frac{k_{\\mathrm{tl}}}{\\gamma_{p} + \\mu} \\left( \\frac{k_{\\mathrm{tx}} f([X])}{\\gamma_{m} + \\mu} \\right)\n$$\nRearranging the terms yields the final closed-form analytic expression:\n$$\np^{*} = \\frac{k_{\\mathrm{tx}} k_{\\mathrm{tl}}}{(\\gamma_{m} + \\mu)(\\gamma_{p} + \\mu)} f([X])\n$$\nThis result explicitly shows how the promoter activity $f([X])$ scales the steady-state protein output, $p^{*}$. The protein level is directly proportional to the promoter activity. The constant of proportionality, $\\frac{k_{\\mathrm{tx}} k_{\\mathrm{tl}}}{(\\gamma_{m} + \\mu)(\\gamma_{p} + \\mu)}$, is a composite parameter that encapsulates the efficiencies of all the intermediate processes: transcription, translation, and the effective lifetimes of the mRNA and protein molecules.",
            "answer": "$$\n\\boxed{p^* = \\frac{k_{\\mathrm{tx}} k_{\\mathrm{tl}}}{(\\gamma_{m} + \\mu)(\\gamma_{p} + \\mu)} f([X])}\n$$"
        },
        {
            "introduction": "Biological systems constantly adapt to changing environments, making their dynamic responses as important as their steady-state behaviors. This practice challenges you to move from static analysis to dynamic simulation by modeling the system's response to a step-change in activator levels . This computational exercise not only builds practical skills in solving ordinary differential equations (ODEs) but also reveals fundamental principles about how network topology, such as a simple cascade, governs transient behaviors like overshoot.",
            "id": "3919410",
            "problem": "Consider a standard transcriptional activation module in synthetic biology where a promoter is activated by an upstream transcription factor at concentration $A(t)$, and transcription and translation follow mass-action kinetics. The gene expression pathway produces messenger ribonucleic acid (mRNA) and protein. Let $m(t)$ denote the mRNA concentration and $p(t)$ denote the protein concentration. The transcription factor activates transcription via a Hill function $H(A)$ with half-activation constant $K$ and Hill coefficient $n$. The governing ordinary differential equations (ODE, ordinary differential equation) for the mRNA and protein concentrations are:\n$$\\frac{d m}{d t} = \\alpha \\, H\\!\\left(A(t)\\right) - \\gamma_m \\, m,$$\n$$\\frac{d p}{d t} = \\beta \\, m - \\gamma_p \\, p,$$\nwith the Hill function\n$$H(A) = \\frac{A^n}{K^n + A^n},$$\nwhere $\\alpha$ is the transcription rate coefficient in arbitrary concentration units per second, $\\beta$ is the translation rate coefficient in per second, $\\gamma_m$ and $\\gamma_p$ are the first-order degradation rate coefficients for mRNA and protein (each in per second), respectively, $K$ is in the same concentration units as $A$, and $n$ is dimensionless.\n\nAssume a step input in the activator concentration: $A(t) = A_0$ for $t  0$ and $A(t) = A_1$ for $t \\ge 0$. The system is at the pre-step steady state at $t=0^{-}$. Therefore, the initial conditions at $t=0$ are the steady-state values corresponding to $A_0$:\n$$m(0) = \\frac{\\alpha \\, H(A_0)}{\\gamma_m}, \\quad p(0) = \\frac{\\beta \\, m(0)}{\\gamma_p}.$$\nLet the post-step steady state for $t \\to \\infty$ be\n$$m_{\\infty} = \\frac{\\alpha \\, H(A_1)}{\\gamma_m}, \\quad p_{\\infty} = \\frac{\\beta \\, m_{\\infty}}{\\gamma_p} = \\frac{\\alpha \\, \\beta \\, H(A_1)}{\\gamma_m \\, \\gamma_p}.$$\n\nDefine the transient overshoot magnitude as a dimensionless fraction relative to the post-step steady-state protein, measured in the direction away from $p_{\\infty}$. Specifically, for a step up ($p_{\\infty} \\ge p(0)$) define\n$$\\text{overshoot} = \\max\\!\\left(0, \\frac{\\max_{t \\ge 0} p(t) - p_{\\infty}}{p_{\\infty}}\\right),$$\nand for a step down ($p_{\\infty}  p(0)$) define\n$$\\text{overshoot} = \\max\\!\\left(0, \\frac{p_{\\infty} - \\min_{t \\ge 0} p(t)}{p_{\\infty}}\\right).$$\nYou must compute this overshoot fraction as a decimal (no percentage sign) for each test case. Time must be handled in seconds, and concentrations in arbitrary units. For numerical integration, integrate from $t=0$ to $t = T$ with\n$$T = \\frac{10}{\\min(\\gamma_m, \\gamma_p)}.$$\nThis integration horizon ensures proximity to the steady state across diverse timescales.\n\nYour program must implement the ODE system for $t \\ge 0$ with $A(t) = A_1$ (the post-step value), initialize $m(0)$ and $p(0)$ at the pre-step steady-state values determined by $A_0$, and then numerically evaluate $p(t)$ over the interval $[0, T]$ to compute the overshoot fraction according to the definitions above. All outputs must be returned as decimal fractions.\n\nUse the following test suite of parameter sets, each specified as $(\\alpha,\\beta,\\gamma_m,\\gamma_p,K,n,A_0,A_1)$ with the units as described above:\n- Test $1$: $(5.0, 2.0, 0.2, 0.05, 50.0, 2.0, 10.0, 200.0)$.\n- Test $2$: $(3.0, 1.2, 0.1, 0.1, 100.0, 1.0, 80.0, 120.0)$.\n- Test $3$: $(4.5, 2.5, 1.0, 0.01, 40.0, 2.0, 5.0, 150.0)$.\n- Test $4$: $(4.0, 1.5, 0.1, 0.1, 30.0, 3.0, 120.0, 20.0)$.\n- Test $5$: $(3.0, 1.0, 0.3, 0.03, 100.0, 4.0, 0.0, 100.0)$.\n\nYour program should produce a single line of output containing the overshoot results for Tests $1$ through $5$ as a comma-separated list enclosed in square brackets (for example, $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5\\right]$). Each $\\text{result}_i$ must be a float in decimal form. No other text should be printed.",
            "solution": "The user wants to solve a problem about a simple transcriptional activation system in synthetic biology.\n\n### 1. Problem Validation\n\nThe first step is to meticulously validate the problem statement.\n\n#### Step 1: Extract Givens\n\n- **Governing ODEs:** The dynamics of the mRNA concentration, $m(t)$, and protein concentration, $p(t)$, are given by the following system of ordinary differential equations (ODEs):\n  $$\n  \\frac{d m}{d t} = \\alpha \\, H\\!\\left(A(t)\\right) - \\gamma_m \\, m\n  $$\n  $$\n  \\frac{d p}{d t} = \\beta \\, m - \\gamma_p \\, p\n  $$\n- **Hill Function:** The activation of transcription by the transcription factor $A$ is modeled by a Hill function:\n  $$\n  H(A) = \\frac{A^n}{K^n + A^n}\n  $$\n- **Parameters:** The model includes the parameters $\\alpha$ (transcription rate coeff.), $\\beta$ (translation rate coeff.), $\\gamma_m$ (mRNA degradation rate coeff.), $\\gamma_p$ (protein degradation rate coeff.), $K$ (half-activation constant), and $n$ (Hill coefficient).\n- **Input Signal:** The concentration of the activator $A(t)$ is a step function: $A(t) = A_0$ for $t  0$ and $A(t) = A_1$ for $t \\ge 0$.\n- **Initial Conditions:** The system is at steady state for $A=A_0$ at $t=0$. The initial conditions are:\n  $$\n  m(0) = \\frac{\\alpha \\, H(A_0)}{\\gamma_m}, \\quad p(0) = \\frac{\\beta \\, m(0)}{\\gamma_p}\n  $$\n- **Post-Step Steady State:** For $t \\to \\infty$, the system approaches a new steady state corresponding to $A=A_1$:\n  $$\n  p_{\\infty} = \\frac{\\alpha \\, \\beta \\, H(A_1)}{\\gamma_m \\, \\gamma_p}\n  $$\n- **Overshoot Definition:** The transient overshoot is defined as a dimensionless fraction.\n  - For a step up ($p_{\\infty} \\ge p(0)$):\n    $$\n    \\text{overshoot} = \\max\\!\\left(0, \\frac{\\max_{t \\ge 0} p(t) - p_{\\infty}}{p_{\\infty}}\\right)\n    $$\n  - For a step down ($p_{\\infty}  p(0)$):\n    $$\n    \\text{overshoot} = \\max\\!\\left(0, \\frac{p_{\\infty} - \\min_{t \\ge 0} p(t)}{p_{\\infty}}\\right)\n    $$\n- **Numerical Integration:** The ODE system must be integrated from $t=0$ to an end time $T$ defined as:\n  $$\n  T = \\frac{10}{\\min(\\gamma_m, \\gamma_p)}\n  $$\n- **Test Cases:** Five parameter sets $(\\alpha, \\beta, \\gamma_m, \\gamma_p, K, n, A_0, A_1)$ are provided for testing.\n  1. $(5.0, 2.0, 0.2, 0.05, 50.0, 2.0, 10.0, 200.0)$\n  2. $(3.0, 1.2, 0.1, 0.1, 100.0, 1.0, 80.0, 120.0)$\n  3. $(4.5, 2.5, 1.0, 0.01, 40.0, 2.0, 5.0, 150.0)$\n  4. $(4.0, 1.5, 0.1, 0.1, 30.0, 3.0, 120.0, 20.0)$\n  5. $(3.0, 1.0, 0.3, 0.03, 100.0, 4.0, 0.0, 100.0)$\n\n#### Step 2: Validate Using Extracted Givens\n\n- **Scientific Grounding:** The model is a canonical representation of a simple gene expression cascade, a fundamental motif in systems biology. The equations represent standard mass-action and cooperative binding kinetics. The model is scientifically sound.\n- **Well-Posedness:** The problem is well-posed. The ODEs are linear with constant coefficients for $t \\ge 0$, and the initial conditions are clearly specified. This guarantees a unique, stable solution exists. The objective of calculating the overshoot is also unambiguously defined.\n- **Objectivity:** The problem is formulated in purely mathematical terms. All parameters and objectives are quantitative and free from subjectivity.\n- **Completeness and Consistency:** All necessary information (equations, definitions, parameters, initial conditions, test cases) is provided. There are no apparent contradictions in the problem setup.\n- **Feasibility:** The parameter values are within plausible ranges for biological processes (time in seconds, concentrations in arbitrary units). The computational task is a standard numerical integration, which is entirely feasible.\n- **Structure:** The problem is clearly structured, guiding the user from model definition to numerical implementation and final calculation.\n\n#### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is a well-defined, scientifically grounded problem in computational systems biology. I will proceed with the solution.\n\n### 2. Solution Design\n\nThe core of the problem is to simulate the time evolution of the protein concentration $p(t)$ and measure its transient overshoot. This requires numerical integration of the given ODE system.\n\n#### Theoretical Analysis of System Behavior\n\nBefore implementing the numerical solution, it is instructive to analyze the system's dynamics. The system is a two-stage cascade: $A$ activates the production of $m$, and $m$ activates the production of $p$. This is a type of coherent feed-forward loop where both paths from the input to the output have a positive effect. Such a network topology does not produce a transient overshoot or undershoot in its response to a step input.\n\nLet's verify this by examining the derivatives at $t=0^+$. The system is in steady state at $t=0^-$, so $p(0) = \\frac{\\beta m(0)}{\\gamma_p}$.\nThe derivative of the protein concentration at $t=0^+$ is:\n$$\n\\left.\\frac{dp}{dt}\\right|_{t=0^+} = \\beta m(0) - \\gamma_p p(0) = \\beta m(0) - \\gamma_p \\left(\\frac{\\beta m(0)}{\\gamma_p}\\right) = 0\n$$\nThe response of $p(t)$ begins with a zero slope. The second derivative at $t=0^+$ is:\n$$\n\\left.\\frac{d^2p}{dt^2}\\right|_{t=0^+} = \\beta \\left.\\frac{dm}{dt}\\right|_{t=0^+} - \\gamma_p \\left.\\frac{dp}{dt}\\right|_{t=0^+} = \\beta (\\alpha H(A_1) - \\gamma_m m(0)) - 0 = \\beta \\gamma_m (m_\\infty - m(0))\n$$\n- For a **step up** ($A_1  A_0$), we have $m_\\infty  m(0)$, which implies $\\frac{d^2p}{dt^2}|_{t=0^+}  0$. Since the slope is zero and the curvature is positive, $p(t)$ starts to increase from a local minimum at $t=0$.\n- For a **step down** ($A_1  A_0$), we have $m_\\infty  m(0)$, which implies $\\frac{d^2p}{dt^2}|_{t=0^+}  0$. Since the slope is zero and the curvature is negative, $p(t)$ starts to decrease from a local maximum at $t=0$.\n\nIn the step-up case, $p(t)$ increases monotonically towards $p_\\infty$. An overshoot would require $p(t)$ a maximum for some $t  0$, where $p(t)  p_\\infty$. This would mean $dp/dt=0$ and $d^2p/dt^2  0$. The condition $dp/dt=0$ implies $\\beta m(t) = \\gamma_p p(t)$. For $p(t)p_\\infty$, we would need $m(t)m_\\infty$. However, for a step-up, $m(t)$ increases monotonically from $m(0)$ to $m_\\infty$ and never exceeds $m_\\infty$. Thus, no overshoot is possible. The maximum value of $p(t)$ on $t\\ge0$ is $p_\\infty$.\n\nIn the step-down case, $p(t)$ decreases monotonically towards $p_\\infty$. An undershoot would require a minimum for some $t  0$, where $p(t)  p_\\infty$. This would imply $m(t)m_\\infty$. However, for a step-down, $m(t)$ decreases monotonically from $m(0)$ to $m_\\infty$ and never drops below $m_\\infty$. Thus, no undershoot is possible. The minimum value of $p(t)$ on $t \\ge 0$ is $p_\\infty$.\n\nTherefore, for both step-up and step-down scenarios, the extremum value of $p(t)$ relevant to the overshoot/undershoot calculation over the time course is simply $p_\\infty$. Plugging this into the provided definitions:\n- Step up: $\\text{overshoot} = \\max(0, \\frac{p_\\infty - p_\\infty}{p_\\infty}) = 0$.\n- Step down: $\\text{overshoot} = \\max(0, \\frac{p_\\infty - p_\\infty}{p_\\infty}) = 0$.\n\nThe analytical result for the overshoot is always $0$ for this system. The numerical simulation should confirm this, yielding values that are zero or very close to zero due to numerical precision limits.\n\n#### Numerical Implementation Plan\n\nThe plan is to implement a Python function that performs the following steps for each test case:\n1.  **Define Parameters:** Unpack the parameters $(\\alpha, \\beta, \\gamma_m, \\gamma_p, K, n, A_0, A_1)$.\n2.  **Calculate States:** Compute the initial concentrations $m(0), p(0)$ and the final steady-state protein concentration $p_\\infty$ using the provided formulas.\n3.  **Define ODE System:** Create a function `ode_system(t, y)` where `y = [m, p]` that returns the derivatives `[dm/dt, dp/dt]` evaluated with the post-step input $A_1$. The term $\\alpha H(A_1)$ is a constant for $t\\ge0$.\n4.  **Integrate:** Use `scipy.integrate.solve_ivp` to solve the ODE system from $t=0$ to $T = 10 / \\min(\\gamma_m, \\gamma_p)$. We will use the `dense_output=True` argument to obtain a continuous solution, which allows for accurate determination of the maximum or minimum.\n5.  **Find Extremum:** Generate a fine-grained time vector and evaluate the solution for $p(t)$ at these points. Find the maximum or minimum value of this numerical solution.\n6.  **Calculate Overshoot:** Apply the appropriate formula for overshoot based on whether $p_\\infty \\ge p(0)$. The `max(0, ...)` part of the definition will handle any small negative values that might arise from numerical error, correctly clamping them to $0.0$.\n7.  **Return Result:** The function will return the computed overshoot fraction.\n\nThe main script will iterate through the list of test cases, call this function for each, and format the results into the required string output.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the transcriptional activation problem for the given test cases.\n    \"\"\"\n\n    # Test cases: (alpha, beta, gamma_m, gamma_p, K, n, A_0, A_1)\n    test_cases = [\n        (5.0, 2.0, 0.2, 0.05, 50.0, 2.0, 10.0, 200.0),\n        (3.0, 1.2, 0.1, 0.1, 100.0, 1.0, 80.0, 120.0),\n        (4.5, 2.5, 1.0, 0.01, 40.0, 2.0, 5.0, 150.0),\n        (4.0, 1.5, 0.1, 0.1, 30.0, 3.0, 120.0, 20.0),\n        (3.0, 1.0, 0.3, 0.03, 100.0, 4.0, 0.0, 100.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        overshoot = calculate_overshoot(params)\n        # It's good practice to round near-zero results to zero to handle floating point noise\n        if np.isclose(overshoot, 0.0):\n            overshoot = 0.0\n        results.append(overshoot)\n    \n    # Format the output as a comma-separated list in brackets.\n    # The map(str, ...) ensures float representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_overshoot(params):\n    \"\"\"\n    Calculates the overshoot for a single set of parameters.\n    \"\"\"\n    alpha, beta, gamma_m, gamma_p, K, n, A0, A1 = params\n\n    def hill_function(A, K, n):\n        \"\"\"Computes the Hill function value.\"\"\"\n        if A == 0:\n            return 0.0\n        if K == 0: # Avoid division by zero if K is 0 and A is not\n            return 1.0\n        # Use np.power for safe exponentiation, especially with large n\n        A_n = np.power(A, n)\n        K_n = np.power(K, n)\n        return A_n / (K_n + A_n)\n\n    # Calculate pre-step steady state (initial conditions for t=0)\n    H_A0 = hill_function(A0, K, n)\n    m0 = (alpha * H_A0) / gamma_m\n    p0 = (beta * m0) / gamma_p\n\n    # Calculate post-step steady state\n    H_A1 = hill_function(A1, K, n)\n    m_inf = (alpha * H_A1) / gamma_m\n    p_inf = (beta * m_inf) / gamma_p\n\n    # Define the ODE system for t = 0\n    # The term alpha * H(A1) is constant.\n    const_prod_m = alpha * H_A1\n    def ode_system(t, y):\n        m, p = y\n        dmdt = const_prod_m - gamma_m * m\n        dpdt = beta * m - gamma_p * p\n        return [dmdt, dpdt]\n\n    # Set up the integration\n    y0 = [m0, p0]\n    T_final = 10.0 / min(gamma_m, gamma_p)\n    # Use dense_output to get an accurate extremum\n    sol = solve_ivp(ode_system, [0, T_final], y0, dense_output=True, rtol=1e-8, atol=1e-10)\n\n    # Evaluate the solution on a fine grid to find the max/min\n    t_eval = np.linspace(0, T_final, 2000)\n    p_t = sol.sol(t_eval)[1]\n\n    # Handle the p_inf = 0 case to avoid division by zero, although not\n    # present in these test cases as A1  0.\n    if p_inf == 0:\n        # If p_inf is 0, overshoot is only meaningful if max(p)  0.\n        # However, if p starts at 0 and the new steady state is 0, it won't rise.\n        # The definition becomes ill-defined. We return 0 as there can be no overshoot.\n        return 0.0\n\n    # Calculate overshoot based on the problem's definition\n    if p_inf = p0:  # Step up\n        p_max = np.max(p_t)\n        overshoot = max(0, (p_max - p_inf) / p_inf)\n    else:  # Step down\n        p_min = np.min(p_t)\n        overshoot = max(0, (p_inf - p_min) / p_inf)\n\n    return overshoot\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "Deterministic models excel at describing the average behavior of cell populations, but gene expression in individual cells is fundamentally a stochastic process. This advanced practice delves into the origins of this 'noise' by modeling the promoter as a randomly switching two-state system . You will use the framework of the Chemical Master Equation to derive an analytical expression for the Fano factor, quantifying how the discrete, burst-like nature of transcription leads to cell-to-cell variabilityâ€”a key phenomenon in biology.",
            "id": "3919370",
            "problem": "Consider a single-gene transcriptional activation system where promoter activity is controlled by binding of a transcriptional activator. Model the promoter state by a binary variable $S(t) \\in \\{0,1\\}$, where $S(t)=1$ denotes the transcriptionally active state and $S(t)=0$ denotes the inactive state. The promoter switches from inactive to active at rate $k_{on}$ and from active to inactive at rate $k_{off}$. When the promoter is active, messenger ribonucleic acid (mRNA) molecules are synthesized at rate $r$; each mRNA molecule is degraded independently at rate $\\gamma$. Assume the system is well-described by the Chemical Master Equation (CME) at steady state, and let $M$ denote the mRNA copy number at steady state.\n\nStarting from the definitions and laws of stochastic birth-death processes and the CME, derive the steady-state mean and variance of $M$ for two cases:\n- A baseline birth-death (BD) model with a constant synthesis rate equal to the time-averaged transcriptional rate.\n- A two-state promoter switching model as described above.\n\nUse these derivations to compute the Fano factor $F \\equiv \\mathrm{Var}(M)/\\mathbb{E}[M]$ for each case. Then, quantify the excess overdispersion introduced by promoter switching relative to the BD baseline by forming $F-1$ for the promoter switching model. Provide your final result as a single closed-form analytic expression in terms of $r$, $k_{on}$, $k_{off}$, and $\\gamma$. Express the answer as a dimensionless analytic expression. No numerical rounding is required.",
            "solution": "The problem requires the derivation of the mean and variance of messenger ribonucleic acid (mRNA) copy number, $M$, at steady state for two models of gene expression: a baseline birth-death (BD) model and a two-state promoter switching model. From these, we are to compute the Fano factor, $F \\equiv \\mathrm{Var}(M)/\\mathbb{E}[M]$, for each case and then determine the excess overdispersion, $F-1$, for the two-state model. The entire derivation will be based on the Chemical Master Equation (CME).\n\nFirst, let us analyze the baseline birth-death (BD) model. This model assumes a constant synthesis rate equal to the time-averaged transcriptional rate of the two-state system. In the two-state model, the promoter is active with probability $p_{on}$ and inactive with probability $p_{off}$. At steady state, the flow between states must balance:\n$$p_{off} k_{on} = p_{on} k_{off}$$\nGiven that $p_{on} + p_{off} = 1$, we can solve for $p_{on}$:\n$$ (1-p_{on}) k_{on} = p_{on} k_{off} \\implies k_{on} = p_{on}(k_{on} + k_{off}) \\implies p_{on} = \\frac{k_{on}}{k_{on} + k_{off}} $$\nThe time-averaged synthesis rate, $\\bar{r}$, is the synthesis rate during the active state, $r$, multiplied by the probability of being in the active state:\n$$ \\bar{r} = r \\cdot p_{on} = r \\frac{k_{on}}{k_{on} + k_{off}} $$\nThe BD model thus describes the dynamics of mRNA count $M$ via the reactions:\n$$ \\emptyset \\xrightarrow{\\bar{r}} M \\quad \\text{and} \\quad M \\xrightarrow{\\gamma} \\emptyset $$\nThis is a classic birth-death process. The steady-state probability distribution $P(m)$ for having $m$ molecules is a Poisson distribution. The evolution of the mean, $\\mathbb{E}[M]$, is given by:\n$$ \\frac{d\\mathbb{E}[M]}{dt} = \\bar{r} - \\gamma \\mathbb{E}[M] $$\nAt steady state, $\\frac{d\\mathbb{E}[M]}{dt}=0$, which gives the mean mRNA number:\n$$ \\mathbb{E}[M]_{BD} = \\frac{\\bar{r}}{\\gamma} = \\frac{r}{\\gamma} \\frac{k_{on}}{k_{on} + k_{off}} $$\nFor a Poisson process, the variance is equal to the mean:\n$$ \\mathrm{Var}(M)_{BD} = \\mathbb{E}[M]_{BD} = \\frac{r}{\\gamma} \\frac{k_{on}}{k_{on} + k_{off}} $$\nTherefore, the Fano factor for the baseline BD model is:\n$$ F_{BD} = \\frac{\\mathrm{Var}(M)_{BD}}{\\mathbb{E}[M]_{BD}} = 1 $$\n\nNext, we analyze the full two-state promoter switching model. The state of the system is described by the pair $(s, m)$, where $s \\in \\{0, 1\\}$ is the promoter state and $m$ is the mRNA count. Let $P(s,m)$ be the steady-state probability of being in state $(s,m)$. The CMEs for this system at steady state are:\n$$ 0 = k_{off}P(1,m) - k_{on}P(0,m) + \\gamma(m+1)P(0,m+1) - \\gamma m P(0,m) $$\n$$ 0 = k_{on}P(0,m) - k_{off}P(1,m) + r P(1,m-1) - r P(1,m) + \\gamma(m+1)P(1,m+1) - \\gamma m P(1,m) $$\nTo find the moments, we define moment generating functions for each promoter state: $G_s(z) = \\sum_{m=0}^\\infty z^m P(s,m)$. Multiplying the CMEs by $z^m$ and summing over $m$ yields a system of ordinary differential equations for $G_0(z)$ and $G_1(z)$:\n$$ 0 = k_{off} G_1(z) - k_{on} G_0(z) + \\gamma(1-z) \\frac{dG_0(z)}{dz} $$\n$$ 0 = k_{on} G_0(z) - (k_{off} + r(1-z)) G_1(z) + \\gamma(1-z) \\frac{dG_1(z)}{dz} $$\nThe total mean is $\\mathbb{E}[M] = \\frac{d}{dz}(G_0(z)+G_1(z))|_{z=1} = \\langle M_0 \\rangle + \\langle M_1 \\rangle$. Differentiating the system with respect to $z$ and setting $z=1$ yields equations for the conditional means $\\langle M_s \\rangle = \\frac{dG_s}{dz}|_{z=1}$:\n$$ 0 = k_{off} \\langle M_1 \\rangle - k_{on} \\langle M_0 \\rangle - \\gamma \\langle M_0 \\rangle $$\n$$ 0 = k_{on} \\langle M_0 \\rangle - k_{off} \\langle M_1 \\rangle + r p_1 - \\gamma \\langle M_1 \\rangle $$\nwhere $p_1 = G_1(1) = k_{on}/(k_{on}+k_{off})$. Solving this linear system gives $\\mathbb{E}[M] = \\langle M_0 \\rangle + \\langle M_1 \\rangle = \\frac{r p_1}{\\gamma}$. This is identical to the mean of the baseline model, as expected:\n$$ \\mathbb{E}[M]_{TS} = \\frac{r}{\\gamma} \\frac{k_{on}}{k_{on} + k_{off}} $$\nTo find the variance, we need the second factorial moments, $S_s = \\frac{d^2G_s}{dz^2}|_{z=1} = \\langle M_s(M_s-1) \\rangle$. Differentiating the ODE system for $G_s(z)$ twice with respect to $z$ and setting $z=1$ gives a linear system for $S_0$ and $S_1$:\n$$ 0 = k_{off} S_1 - (k_{on} + 2\\gamma) S_0 $$\n$$ 0 = k_{on} S_0 - (k_{off} + 2\\gamma) S_1 + 2r \\langle M_1 \\rangle $$\nFrom the first equation, $S_0 = \\frac{k_{off}}{k_{on}+2\\gamma}S_1$. Substituting into the second:\n$$ \\left( k_{on}\\frac{k_{off}}{k_{on}+2\\gamma} - (k_{off} + 2\\gamma) \\right) S_1 + 2r \\langle M_1 \\rangle = 0 $$\n$$ \\left( \\frac{k_{on}k_{off} - (k_{off}+2\\gamma)(k_{on}+2\\gamma)}{k_{on}+2\\gamma} \\right) S_1 = -2r \\langle M_1 \\rangle $$\n$$ \\frac{-2\\gamma(k_{on}+k_{off}+2\\gamma)}{k_{on}+2\\gamma} S_1 = -2r \\langle M_1 \\rangle $$\n$$ S_1 = \\frac{r \\langle M_1 \\rangle (k_{on}+2\\gamma)}{\\gamma(k_{on}+k_{off}+2\\gamma)} $$\nThe total second factorial moment is $S = S_0 + S_1 = (\\frac{k_{off}}{k_{on}+2\\gamma}+1)S_1 = \\frac{k_{on}+k_{off}+2\\gamma}{k_{on}+2\\gamma}S_1$.\n$$ S = \\langle M(M-1) \\rangle = \\frac{r \\langle M_1 \\rangle}{\\gamma} $$\nNow, we find an expression for $\\langle M_1 \\rangle$ from the first moment equations: $\\langle M_1 \\rangle = \\frac{r p_1 (k_{on}+\\gamma)}{\\gamma(k_{on}+k_{off}+\\gamma)}$.\nSubstituting this into the expression for $S$:\n$$ S = \\frac{r}{\\gamma} \\left( \\frac{r p_1 (k_{on}+\\gamma)}{\\gamma(k_{on}+k_{off}+\\gamma)} \\right) = \\frac{r^2 p_1 (k_{on}+\\gamma)}{\\gamma^2(k_{on}+k_{off}+\\gamma)} $$\nThe variance is given by $\\mathrm{Var}(M) = \\langle M(M-1) \\rangle + \\mathbb{E}[M] - (\\mathbb{E}[M])^2 = S + \\mathbb{E}[M] - (\\mathbb{E}[M])^2$.\n$$ \\mathrm{Var}(M)_{TS} = \\frac{r^2 p_1 (k_{on}+\\gamma)}{\\gamma^2(k_{on}+k_{off}+\\gamma)} + \\frac{r p_1}{\\gamma} - \\left(\\frac{r p_1}{\\gamma}\\right)^2 $$\n$$ = \\mathbb{E}[M]_{TS} + \\frac{r^2 p_1}{\\gamma^2} \\left[ \\frac{k_{on}+\\gamma}{k_{on}+k_{off}+\\gamma} - p_1 \\right] $$\nThe term in the square brackets simplifies to:\n$$ \\frac{(k_{on}+\\gamma)(k_{on}+k_{off}) - k_{on}(k_{on}+k_{off}+\\gamma)}{(k_{on}+k_{off}+\\gamma)(k_{on}+k_{off})} = \\frac{k_{on}^2+k_{on}k_{off}+\\gamma k_{on}+\\gamma k_{off} - k_{on}^2 - k_{on}k_{off} - \\gamma k_{on}}{(k_{on}+k_{off}+\\gamma)(k_{on}+k_{off})} = \\frac{\\gamma k_{off}}{(k_{on}+k_{off}+\\gamma)(k_{on}+k_{off})} $$\nSubstituting this back into the variance expression:\n$$ \\mathrm{Var}(M)_{TS} = \\mathbb{E}[M]_{TS} + \\frac{r^2}{\\gamma^2} \\frac{k_{on}}{k_{on}+k_{off}} \\frac{\\gamma k_{off}}{(k_{on}+k_{off}+\\gamma)(k_{on}+k_{off})} $$\n$$ \\mathrm{Var}(M)_{TS} = \\mathbb{E}[M]_{TS} + \\frac{r}{\\gamma} \\frac{k_{on}}{k_{on}+k_{off}} \\frac{r k_{off}}{\\gamma(k_{on}+k_{off}+\\gamma)} $$\nBy substituting $\\mathbb{E}[M]_{TS} = \\frac{r}{\\gamma} \\frac{k_{on}}{k_{on}+k_{off}}$, we can express the variance in terms of the mean:\n$$ \\mathrm{Var}(M)_{TS} = \\mathbb{E}[M]_{TS} \\left( 1 + \\frac{r k_{off}}{\\gamma(k_{on}+k_{off}+\\gamma)} \\right) $$\nThe Fano factor for the two-state model is therefore:\n$$ F_{TS} = \\frac{\\mathrm{Var}(M)_{TS}}{\\mathbb{E}[M]_{TS}} = 1 + \\frac{r k_{off}}{\\gamma(k_{on}+k_{off}+\\gamma)} $$\nThis is not quite the final form. The derivation has a small error. Let's re-examine `Var(M) = E[M] + E[M] * (r k_off / ( (k_on+k_off) * (k_on+k_off+gamma)))`.\nAh, wait. Let's re-evaluate the simplification from `Var(M) = E[M] + (r^2/gamma^2) * p_on * [simplified_term]`.\n`Var(M) = E[M] + (r^2/gamma^2) * (k_on/(k_on+k_off)) * (gamma*k_off / ((k_on+k_off+gamma)*(k_on+k_off)))`\n`Var(M) = E[M] + (r/gamma)*(k_on/(k_on+k_off)) * (r*k_off / (gamma*(k_on+k_off+gamma)))` -> No, this is also wrong.\nLet's try again. `Var(M) = E[M] + (r*k_on/gamma) * (r*k_off / (gamma*(k_on+k_off)*(k_on+k_off+gamma)))` -> No.\n`Var(M) = E[M] + (r^2*k_on*k_off) / (gamma * (k_on+k_off)^2 * (k_on+k_off+gamma))`\n`F - 1 = Var/E - 1 = (Var-E)/E = [ (r^2*k_on*k_off) / (gamma * (k_on+k_off)^2 * (k_on+k_off+gamma)) ] / [ r*k_on / (gamma*(k_on+k_off)) ]`\n`F - 1 = [ (r*k_off) / ((k_on+k_off)*(k_on+k_off+gamma)) ]`. The final expression is correct. My check of the intermediate steps was getting confused. The final result in the text is correct.\nThe excess overdispersion introduced by promoter switching is the quantity $F-1$. For the two-state model, this is:\n$$ F_{TS} - 1 = \\frac{r k_{off}}{(k_{on} + k_{off})(k_{on} + k_{off} + \\gamma)} $$\nThis term quantifies the additional noise (variance relative to the mean) that arises from the stochastic switching of the promoter between its active and inactive states, compared to a baseline Poisson process with the same mean production rate. All rates ($r, k_{on}, k_{off}, \\gamma$) have units of inverse time, so the expression is dimensionless as required.",
            "answer": "$$\\boxed{\\frac{r k_{off}}{(k_{on} + k_{off})(k_{on} + k_{off} + \\gamma)}}$$"
        }
    ]
}