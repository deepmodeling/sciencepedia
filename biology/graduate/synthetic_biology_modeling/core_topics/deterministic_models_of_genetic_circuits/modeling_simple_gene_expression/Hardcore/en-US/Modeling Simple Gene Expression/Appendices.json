{
    "hands_on_practices": [
        {
            "introduction": "We begin with the foundational deterministic model of gene expression, which describes the average concentrations of molecular species in a large population of cells. This practice challenges you to construct and solve a system of ordinary differential equations (ODEs) based on the Central Dogma and mass-action kinetics . By analyzing the system's response to a finite pulse of promoter activity, you will develop essential skills for predicting the transient, time-dependent behavior of synthetic gene circuits.",
            "id": "3920599",
            "problem": "A single-gene expression cassette is placed under an inducible promoter in a well-mixed cell-free reaction. The promoter is switched on at time $t=0$ and remains on until time $t=\\tau$, after which it is switched off for all subsequent times. When the promoter is on, transcription occurs at a constant rate proportional to the number of active promoters, and when the promoter is off, transcription ceases. Messenger ribonucleic acid (mRNA) and protein degrade via first-order kinetics. Translation occurs at a rate proportional to mRNA abundance. Assume a single copy of the promoter, negligible resource depletion, and constant volume so that concentrations are well-defined.\n\nUsing the Central Dogma and mass-action kinetics as the only modeling assumptions, set up a deterministic ordinary differential equation (ODE) model for the mRNA concentration $M(t)$ and protein concentration $P(t)$ subject to the following constraints:\n- Transcription rate when the promoter is on is $k_{\\mathrm{tx}}$.\n- Translation rate per mRNA is $k_{\\mathrm{tl}}$.\n- mRNA degradation rate is $d_m$.\n- Protein degradation rate is $d_p$.\n- All parameters $k_{\\mathrm{tx}}$, $k_{\\mathrm{tl}}$, $d_m$, $d_p$ are positive real numbers, with $d_m \\neq d_p$.\n- Initial conditions are $M(0)=0$ and $P(0)=0$.\n- The promoter activation is a binary input that is $1$ for $0 \\le t \\le \\tau$ and $0$ for $t > \\tau$.\n\nStarting from these base principles, derive and solve the model to obtain a closed-form expression for the protein concentration $P(t)$ at a general final time $t=T_f$ with $T_f > \\tau$. Then compute the dimensionless ratio $R$ of the protein concentration at time $T_f$ to the steady-state protein concentration under sustained promoter activation (i.e., when the promoter is held on indefinitely). Provide $R$ as a single, simplified analytic expression in terms of $\\tau$, $T_f$, $k_{\\mathrm{tx}}$, $k_{\\mathrm{tl}}$, $d_m$, and $d_p$. Do not insert numerical values and do not round; the final answer should be exact and dimensionless.",
            "solution": "The user wants me to solve a problem in synthetic biology modeling. I will first perform a validation of the problem statement as per the required protocol.\n\n### Step 1: Extract Givens\n- **System**: A single-gene expression cassette.\n- **Components**: Messenger ribonucleic acid (mRNA) concentration $M(t)$, protein concentration $P(t)$.\n- **Process**: Gene expression modeled by the Central Dogma using mass-action kinetics.\n- **Input (Promoter Activity)**: A binary input that is $1$ for $0 \\le t \\le \\tau$ and $0$ for $t > \\tau$.\n- **Parameters**:\n  - Transcription rate when promoter is on: $k_{\\mathrm{tx}} > 0$.\n  - Translation rate per mRNA: $k_{\\mathrm{tl}} > 0$.\n  - mRNA degradation rate: $d_m > 0$.\n  - Protein degradation rate: $d_p > 0$.\n- **Constraints**: $d_m \\neq d_p$. All parameters are positive real numbers.\n- **Initial Conditions**: $M(0) = 0$, $P(0) = 0$.\n- **Objective**:\n  1. Derive a closed-form expression for the protein concentration $P(t)$ at a general final time $t=T_f$ with $T_f > \\tau$.\n  2. Compute the dimensionless ratio $R$ of $P(T_f)$ to the steady-state protein concentration $P_{ss}$ under sustained promoter activation.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on the standard deterministic model of simple gene expression using ordinary differential equations (ODEs) and mass-action kinetics. This is a fundamental and well-established approach in systems and synthetic biology. The assumptions (first-order degradation, constant rates, well-mixed system) are common and valid simplifications for creating a tractable model. The problem does not violate any scientific principles.\n2.  **Well-Posed**: The problem describes a system of linear, first-order ODEs with piecewise-constant forcing. Given the initial conditions, a unique and stable solution is guaranteed to exist. The condition $d_m \\neq d_p$ is explicitly stated, which prevents singularities in the solution, ensuring it is well-defined.\n3.  **Objective**: The problem is stated in precise, quantitative, and unbiased language. All terms are clearly defined.\n4.  **Complete and Consistent**: All necessary parameters ($k_{\\mathrm{tx}}$, $k_{\\mathrm{tl}}$, $d_m$, $d_p$), initial conditions ($M(0)=0, P(0)=0$), and the functional form of the input (promoter activity over time $\\tau$) are provided. The setup is self-contained and free of contradictions.\n5.  **Realistic and Feasible**: The model is a simplification but represents a scientifically plausible scenario. The parameters are defined as positive real numbers, which is physically consistent.\n6.  **No other flaws**: The problem is not trivial, metaphorical, or tautological. It requires a standard but multi-step derivation and solution of a system of ODEs, which is a substantive reasoning challenge.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the solution.\n\nThe modeling process begins by setting up the system of ordinary differential equations (ODEs) based on the principles of mass-action kinetics. Let $u(t)$ be a function representing the promoter activity, where $u(t)=1$ for $0 \\le t \\le \\tau$ and $u(t)=0$ for $t > \\tau$.\n\nThe rate of change of mRNA concentration, $M(t)$, is the rate of its synthesis (transcription) minus the rate of its degradation.\n$$ \\frac{dM}{dt} = k_{\\mathrm{tx}} u(t) - d_m M(t) $$\nThe rate of change of protein concentration, $P(t)$, is the rate of its synthesis (translation) minus the rate of its degradation.\n$$ \\frac{dP}{dt} = k_{\\mathrm{tl}} M(t) - d_p P(t) $$\nThe initial conditions are $M(0) = 0$ and $P(0) = 0$.\n\nThe solution must be found in two parts, corresponding to the two phases of promoter activity.\n\n**Phase 1: Promoter is ON ($0 \\le t \\le \\tau$)**\n\nDuring this interval, $u(t) = 1$. The system of ODEs is:\n$$ \\frac{dM}{dt} = k_{\\mathrm{tx}} - d_m M(t) $$\n$$ \\frac{dP}{dt} = k_{\\mathrm{tl}} M(t) - d_p P(t) $$\nWe first solve the equation for $M(t)$. This is a first-order linear ODE with the initial condition $M(0)=0$. The solution is:\n$$ M(t) = \\frac{k_{\\mathrm{tx}}}{d_m} (1 - \\exp(-d_m t)) $$\nNext, we substitute this expression for $M(t)$ into the equation for $P(t)$:\n$$ \\frac{dP}{dt} + d_p P(t) = k_{\\mathrm{tl}} \\frac{k_{\\mathrm{tx}}}{d_m} (1 - \\exp(-d_m t)) $$\nThis is another first-order linear ODE. With the initial condition $P(0)=0$ and the constraint $d_m \\neq d_p$, the solution is found using an integrating factor or by other standard methods:\n$$ P(t) = \\frac{k_{\\mathrm{tl}}k_{\\mathrm{tx}}}{d_md_p} \\left[ 1 - \\frac{d_p}{d_p - d_m} \\exp(-d_m t) + \\frac{d_m}{d_p - d_m} \\exp(-d_p t) \\right] $$\nThese expressions for $M(t)$ and $P(t)$ are valid for $0 \\le t \\le \\tau$.\n\n**State at time $t=\\tau$**\n\nTo solve for the next phase, we need the concentrations at the switching time $t=\\tau$. These serve as initial conditions for the second phase.\n$$ M(\\tau) = \\frac{k_{\\mathrm{tx}}}{d_m} (1 - \\exp(-d_m \\tau)) $$\n$$ P(\\tau) = \\frac{k_{\\mathrm{tl}}k_{\\mathrm{tx}}}{d_md_p} \\left[ 1 - \\frac{d_p}{d_p - d_m} \\exp(-d_m \\tau) + \\frac{d_m}{d_p - d_m} \\exp(-d_p \\tau) \\right] $$\n\n**Phase 2: Promoter is OFF ($t > \\tau$)**\n\nFor $t > \\tau$, we have $u(t) = 0$. The system of ODEs becomes:\n$$ \\frac{dM}{dt} = - d_m M(t) $$\n$$ \\frac{dP}{dt} = k_{\\mathrm{tl}} M(t) - d_p P(t) $$\nWe solve for $M(t)$ with the initial condition $M(\\tau)$ at time $t=\\tau$.\n$$ M(t) = M(\\tau) \\exp(-d_m (t-\\tau)) \\quad \\text{for } t > \\tau $$\nSubstituting the expression for $M(\\tau)$, we get:\n$$ M(t) = \\frac{k_{\\mathrm{tx}}}{d_m} (1 - \\exp(-d_m \\tau)) \\exp(-d_m (t-\\tau)) $$\nNow we solve for $P(t)$ for $t > \\tau$ using the initial condition $P(\\tau)$. The equation is:\n$$ \\frac{dP}{dt} + d_p P(t) = k_{\\mathrm{tl}} M(t) = k_{\\mathrm{tl}} M(\\tau) \\exp(-d_m(t-\\tau)) $$\nThe general solution for $P(t)$ in this phase is the sum of the homogeneous solution and a particular solution. The full solution satisfying the condition at $t=\\tau$ is:\n$$ P(t) = P(\\tau)\\exp(-d_p(t-\\tau)) + \\frac{k_{\\mathrm{tl}}M(\\tau)}{d_p - d_m} \\left( \\exp(-d_m(t-\\tau)) - \\exp(-d_p(t-\\tau)) \\right) $$\nTo obtain the closed-form expression for $P(T_f)$, we substitute $t=T_f$ and the expressions for $M(\\tau)$ and $P(\\tau)$ into this equation. After significant algebraic simplification, grouping terms with $\\exp(-d_m T_f)$ and $\\exp(-d_p T_f)$, we arrive at a compact form. The final expression for $P(t)$ for $t>\\tau$ is:\n$$ P(t) = \\frac{k_{\\mathrm{tl}}k_{\\mathrm{tx}}}{d_p - d_m} \\left[ \\frac{\\exp(d_m \\tau) - 1}{d_m} \\exp(-d_m t) - \\frac{\\exp(d_p \\tau) - 1}{d_p} \\exp(-d_p t) \\right] $$\nEvaluating at $t = T_f$:\n$$ P(T_f) = \\frac{k_{\\mathrm{tl}}k_{\\mathrm{tx}}}{d_p - d_m} \\left[ \\frac{\\exp(d_m \\tau) - 1}{d_m} \\exp(-d_m T_f) - \\frac{\\exp(d_p \\tau) - 1}{d_p} \\exp(-d_p T_f) \\right] $$\n\n**Steady-State Concentration**\n\nThe steady-state concentration under sustained promoter activation corresponds to the limit $t \\to \\infty$ with $u(t)=1$ for all time. We set the derivatives to zero:\n$$ \\frac{dM}{dt} = k_{\\mathrm{tx}} - d_m M_{ss} = 0 \\implies M_{ss} = \\frac{k_{\\mathrm{tx}}}{d_m} $$\n$$ \\frac{dP}{dt} = k_{\\mathrm{tl}} M_{ss} - d_p P_{ss} = 0 \\implies P_{ss} = \\frac{k_{\\mathrm{tl}} M_{ss}}{d_p} = \\frac{k_{\\mathrm{tl}} k_{\\mathrm{tx}}}{d_m d_p} $$\n\n**Ratio Calculation**\n\nFinally, we compute the dimensionless ratio $R = \\frac{P(T_f)}{P_{ss}}$.\n$$ R = \\frac{P(T_f)}{P_{ss}} = \\frac{\\frac{k_{\\mathrm{tl}}k_{\\mathrm{tx}}}{d_p - d_m} \\left[ \\frac{\\exp(d_m \\tau) - 1}{d_m} \\exp(-d_m T_f) - \\frac{\\exp(d_p \\tau) - 1}{d_p} \\exp(-d_p T_f) \\right]}{\\frac{k_{\\mathrm{tl}} k_{\\mathrm{tx}}}{d_m d_p}} $$\n$$ R = \\frac{d_m d_p}{d_p - d_m} \\left[ \\frac{\\exp(d_m \\tau) - 1}{d_m} \\exp(-d_m T_f) - \\frac{\\exp(d_p \\tau) - 1}{d_p} \\exp(-d_p T_f) \\right] $$\nSimplifying by distributing $d_m d_p$ into the bracket:\n$$ R = \\frac{1}{d_p - d_m} \\left[ d_p (\\exp(d_m \\tau) - 1) \\exp(-d_m T_f) - d_m (\\exp(d_p \\tau) - 1) \\exp(-d_p T_f) \\right] $$\nThis is the final simplified analytic expression for the ratio $R$.",
            "answer": "$$\\boxed{\\frac{1}{d_p - d_m} \\left[ d_p \\left( \\exp(d_m \\tau) - 1 \\right) \\exp(-d_m T_f) - d_m \\left( \\exp(d_p \\tau) - 1 \\right) \\exp(-d_p T_f) \\right]}$$"
        },
        {
            "introduction": "While deterministic models capture average behavior, gene expression at the single-cell level is fundamentally a stochastic process governed by random molecular events. This practice moves beyond average concentrations to explore the full probability distribution of messenger ribonucleic acid (mRNA) copy numbers . You will derive the Chemical Master Equation (CME) for a simple birth-death process, which allows you to quantify not just the mean but also the intrinsic noise, or variance, inherent in gene expression.",
            "id": "3920598",
            "problem": "Consider messenger ribonucleic acid (mRNA) copy number dynamics for a single gene in a homogeneous cell, where transcriptional initiation events occur as a memoryless arrival process and degradation of individual mRNA molecules follows mass-action kinetics. Let $N(t)$ denote the integer-valued random variable representing the mRNA copy number at time $t$. Assume the following physically realistic and widely used modeling primitives: (i) transcriptional initiation is modeled as a time-homogeneous Poisson process with constant rate $k_s$ (units: molecules per minute), which is independent of $N(t)$, and (ii) each mRNA molecule degrades independently with a constant per-molecule rate $d_m$ (units: per minute). This defines a Continuous-Time Markov Chain (CTMC) and induces a Chemical Master Equation (CME) for the probability mass function $P(n,t) = \\mathbb{P}\\{N(t) = n\\}$.\n\nYour tasks are as follows, grounded in these fundamental bases:\n\n- Using the definition of a continuous-time Markov chain and the Kolmogorov forward equation for birth and death reactions, derive the CME governing $P(n,t)$ for the described immigration-death process. Your derivation must begin from the propensity function definitions implied by the Poisson transcriptional initiation and mass-action degradation assumptions, and explicitly account for transitions between copy number states.\n- From the CME, derive ordinary differential equations for the first and second moments, and solve them to obtain explicit expressions for the mean $\\mathbb{E}[N(t)]$ and variance $\\mathrm{Var}(N(t))$ under a deterministic initial condition $N(0) = n_0$.\n- Using first principles, derive an explicit, computationally usable expression for the probability mass function at time $t$ under the deterministic initial condition $N(0) = n_0$, without appealing to pre-tabulated formulas. Your expression should be valid for general $k_s \\ge 0$, $d_m \\ge 0$, $t \\ge 0$, and integer $n_0 \\ge 0$. You must analyze and correctly treat the boundary cases $d_m = 0$ (no degradation), $k_s = 0$ (no transcription), and $t = 0$ (initial time).\n- Implement a complete, runnable program that, for each test case provided below, computes three quantities: the mean $\\mathbb{E}[N(t)]$, the variance $\\mathrm{Var}(N(t))$, and the probability $\\mathbb{P}\\{N(t) = m\\}$ at the specified time. Use $t$ in minutes, $k_s$ in molecules per minute, $d_m$ in per minute, and express $n_0$ and $m$ as molecule counts without units. The final outputs are dimensionless real numbers (floats). Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a list of three floats in the order $[\\mathbb{E}[N(t)], \\mathrm{Var}(N(t)), \\mathbb{P}\\{N(t) = m\\}]$. For example, the overall output should have the form $[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]$ with no additional text.\n\nYou must use only the specified runtime environment and libraries. Your algorithm must compute the exact analytic quantities implied by your derivations and must be numerically stable for all test cases.\n\nTest suite with parameter values covering typical behavior and edge cases:\n\n- Case $1$ (happy path): $k_s = 5.0$ molecules/minute, $d_m = 0.2$ per minute, $n_0 = 3$ molecules, $t = 10.0$ minutes, query $m = 7$ molecules.\n- Case $2$ (pure degradation boundary): $k_s = 0.0$ molecules/minute, $d_m = 0.5$ per minute, $n_0 = 10$ molecules, $t = 3.0$ minutes, query $m = 4$ molecules.\n- Case $3$ (pure transcription boundary): $k_s = 2.5$ molecules/minute, $d_m = 0.0$ per minute, $n_0 = 1$ molecule, $t = 20.0$ minutes, query $m = 15$ molecules.\n- Case $4$ (initial-time boundary): $k_s = 3.0$ molecules/minute, $d_m = 0.1$ per minute, $n_0 = 8$ molecules, $t = 0.0$ minutes, query $m = 8$ molecules.\n- Case $5$ (large-rate stability): $k_s = 1000.0$ molecules/minute, $d_m = 5.0$ per minute, $n_0 = 0$ molecules, $t = 1.5$ minutes, query $m = 200$ molecules.\n\nYour program should produce a single line of output containing the results for the five cases in the exact format $[[\\mathbb{E}[N(t)],\\mathrm{Var}(N(t)),\\mathbb{P}\\{N(t) = m\\}],\\dots]$ for the cases in the order they are listed above.",
            "solution": "The problem statement describes a fundamental stochastic model for gene expression, specifically an immigration-death process for messenger RNA (mRNA) copy numbers. This is a standard and well-characterized model in quantitative and systems biology. The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a full derivation and solution. Therefore, it is deemed valid. We proceed with the solution.\n\nThe system is defined by two elementary reactions:\n1.  mRNA Transcription (Immigration/Birth): $\\emptyset \\xrightarrow{k_s} \\text{mRNA}$. New mRNA molecules are synthesized at a constant rate $k_s$. The propensity function for this reaction is independent of the current copy number $n$, so $w_+(n) = k_s$.\n2.  mRNA Degradation (Death): $\\text{mRNA} \\xrightarrow{d_m} \\emptyset$. Each existing mRNA molecule has a constant probability per unit time of being degraded, given by the rate $d_m$. For a system with $n$ molecules, the total degradation rate follows mass-action kinetics: $w_-(n) = d_m n$.\n\nLet $N(t)$ be the random variable for the number of mRNA molecules at time $t$, and let $P(n,t) = \\mathbb{P}\\{N(t) = n\\}$ be its probability mass function.\n\n### Derivation of the Chemical Master Equation (CME)\n\nThe CME is a set of coupled ordinary differential equations describing the time evolution of $P(n,t)$. It is derived from the Kolmogorov forward equation for the Continuous-Time Markov Chain (CTMC) defined by the reactions above. The rate of change of the probability of being in state $n$, $\\frac{d P(n,t)}{dt}$, is the total rate of transitions into state $n$ minus the total rate of transitions out of state $n$.\n\nA transition into state $n$ can occur from state $n-1$ via transcription (rate $k_s$) or from state $n+1$ via degradation (rate $d_m(n+1)$).\nA transition out of state $n$ can occur to state $n+1$ via transcription (rate $k_s$) or to state $n-1$ via degradation (rate $d_m n$).\n\nThus, for any integer state $n \\ge 1$:\n$$\n\\frac{d P(n,t)}{dt} = \\underbrace{k_s P(n-1,t)}_{\\text{Transcription into } n} + \\underbrace{d_m(n+1)P(n+1,t)}_{\\text{Degradation into } n} - \\underbrace{k_s P(n,t)}_{\\text{Transcription out of } n} - \\underbrace{d_m n P(n,t)}_{\\text{Degradation out of } n}\n$$\nThis can be written as:\n$$\n\\frac{d P(n,t)}{dt} = k_s P(n-1, t) + d_m (n+1) P(n+1, t) - (k_s + d_m n) P(n, t)\n$$\nFor the boundary state $n=0$, no degradation can occur (the copy number cannot become negative). The transitions are:\n$$\n\\frac{d P(0,t)}{dt} = \\underbrace{d_m(1)P(1,t)}_{\\text{Degradation from } n=1} - \\underbrace{k_s P(0,t)}_{\\text{Transcription from } n=0}\n$$\nThis boundary condition is consistent with the general equation for $n \\ge 1$ if we define $P(n,t)=0$ for $n  0$.\n\n### Derivation of Moment Dynamics\n\nWe use the CME to derive ordinary differential equations (ODEs) for the moments of $N(t)$.\n\n**Mean $\\mathbb{E}[N(t)] = \\langle n(t) \\rangle$**:\nThe definition of the mean is $\\langle n(t) \\rangle = \\sum_{n=0}^{\\infty} n P(n,t)$. Its time derivative is:\n$$\n\\frac{d \\langle n \\rangle}{dt} = \\sum_{n=0}^{\\infty} n \\frac{d P(n,t)}{dt} = \\sum_{n=1}^{\\infty} n \\left[ k_s P(n-1, t) + d_m (n+1) P(n+1, t) - (k_s + d_m n) P(n, t) \\right]\n$$\nWe analyze each term in the sum by re-indexing:\n1.  $\\sum_{n=1}^{\\infty} n k_s P(n-1, t) = \\sum_{m=0}^{\\infty} (m+1) k_s P(m, t) = k_s (\\langle n \\rangle + 1)$\n2.  $\\sum_{n=1}^{\\infty} n d_m (n+1) P(n+1, t) = \\sum_{m=2}^{\\infty} (m-1) d_m m P(m, t) = d_m (\\langle n^2 \\rangle - \\langle n \\rangle)$\n3.  $-\\sum_{n=1}^{\\infty} n (k_s + d_m n) P(n, t) = -k_s \\langle n \\rangle - d_m \\langle n^2 \\rangle$\n\nCombining these terms yields:\n$$\n\\frac{d \\langle n \\rangle}{dt} = (k_s \\langle n \\rangle + k_s) + (d_m \\langle n^2 \\rangle - d_m \\langle n \\rangle) - (k_s \\langle n \\rangle + d_m \\langle n^2 \\rangle) = k_s - d_m \\langle n \\rangle\n$$\nThis is a linear first-order ODE for the mean $\\mu(t) = \\langle n(t) \\rangle$. With the initial condition $N(0) = n_0$, so $\\mu(0) = n_0$, the solution is:\n$$\n\\mathbb{E}[N(t)] = \\mu(t) = n_0 e^{-d_m t} + \\frac{k_s}{d_m} (1 - e^{-d_m t})\n$$\nIn the special case $d_m=0$, the ODE becomes $\\frac{d\\mu}{dt} = k_s$, which solves to $\\mu(t) = k_s t + n_0$. This result is consistent with the limit of the general solution as $d_m \\to 0$.\n\n**Variance $\\mathrm{Var}(N(t))$**:\nThe variance is $\\mathrm{Var}(N(t)) = \\langle n^2 \\rangle - \\langle n \\rangle^2$. We first find the ODE for the second moment, $\\langle n^2 \\rangle = \\sum_{n=0}^{\\infty} n^2 P(n,t)$.\n$$\n\\frac{d \\langle n^2 \\rangle}{dt} = \\sum_{n=1}^{\\infty} n^2 \\frac{d P(n,t)}{dt} = \\sum_{n=1}^{\\infty} n^2 \\left[ k_s P(n-1, t) + d_m (n+1) P(n+1, t) - (k_s + d_m n) P(n, t) \\right]\n$$\nFollowing a similar procedure:\n1.  $\\sum_{n=1}^{\\infty} n^2 k_s P(n-1, t) = \\sum_{m=0}^{\\infty} (m+1)^2 k_s P(m,t) = k_s (\\langle n^2 \\rangle + 2\\langle n \\rangle + 1)$\n2.  $\\sum_{n=1}^{\\infty} n^2 d_m (n+1) P(n+1, t) = \\sum_{m=2}^{\\infty} (m-1)^2 d_m m P(m,t) = d_m (\\langle n^3 \\rangle - 2\\langle n^2 \\rangle + \\langle n \\rangle)$\n3.  $-\\sum_{n=1}^{\\infty} n^2 (k_s + d_m n) P(n,t) = -k_s \\langle n^2 \\rangle - d_m \\langle n^3 \\rangle$\n\nSumming these gives:\n$$\n\\frac{d \\langle n^2 \\rangle}{dt} = k_s (2\\langle n \\rangle + 1) + d_m \\langle n \\rangle - 2d_m \\langle n^2 \\rangle\n$$\nNow, we find the derivative of the variance $V(t) = \\mathrm{Var}(N(t))$:\n$$\n\\frac{d V}{dt} = \\frac{d \\langle n^2 \\rangle}{dt} - 2\\langle n \\rangle \\frac{d\\langle n \\rangle}{dt}\n$$\nSubstituting the derived ODEs:\n$$\n\\frac{d V}{dt} = [k_s (2\\langle n \\rangle + 1) + d_m \\langle n \\rangle - 2d_m \\langle n^2 \\rangle] - 2\\langle n \\rangle (k_s - d_m \\langle n \\rangle)\n$$\n$$\n\\frac{d V}{dt} = 2k_s\\langle n \\rangle + k_s + d_m\\langle n \\rangle - 2d_m\\langle n^2 \\rangle - 2k_s\\langle n \\rangle + 2d_m\\langle n \\rangle^2 = k_s + d_m \\langle n \\rangle - 2d_m (\\langle n^2 \\rangle - \\langle n \\rangle^2)\n$$\n$$\n\\frac{d V}{dt} = k_s + d_m \\mu(t) - 2d_m V(t)\n$$\nThis is a linear first-order ODE for the variance $V(t)$. The initial condition is $N(0)=n_0$, which is a deterministic value, so $V(0) = \\mathrm{Var}(n_0) = 0$. Solving this ODE with the known solution for $\\mu(t)$ gives:\n$$\n\\mathrm{Var}(N(t)) = V(t) = \\frac{k_s}{d_m}(1-e^{-d_m t}) + n_0(e^{-d_m t} - e^{-2d_m t})\n$$\nIn the special case $d_m=0$, the ODE becomes $\\frac{dV}{dt} = k_s$, which solves to $V(t) = k_s t$. This is consistent with the limit of the general solution as $d_m \\to 0$.\n\n### Derivation of the Full Probability Distribution\n\nThe total number of molecules $N(t)$ can be represented as the sum of two independent random variables:\n1.  $N_S(t)$: The number of molecules from the initial population $n_0$ that survive until time $t$.\n2.  $N_B(t)$: The number of molecules newly synthesized between time $0$ and $t$ that are still present at time $t$.\n\n**Distribution of Survivors $N_S(t)$**:\nEach of the $n_0$ initial molecules degrades independently with rate $d_m$. The probability that a single molecule survives for a duration $t$ is $p_S(t) = e^{-d_m t}$. The number of survivors $N_S(t)$ from the initial set of $n_0$ molecules therefore follows a binomial distribution:\n$$\nN_S(t) \\sim \\text{Binomial}(n_0, p_S(t)) \\quad \\text{where} \\quad p_S(t) = e^{-d_m t}\n$$\nThe probability mass function is $\\mathbb{P}\\{N_S(t)=k\\} = \\binom{n_0}{k} (e^{-d_m t})^k (1-e^{-d_m t})^{n_0-k}$ for $k \\in \\{0, 1, \\dots, n_0\\}$.\n\n**Distribution of New Molecules $N_B(t)$**:\nNew molecules are synthesized according to a homogeneous Poisson process with rate $k_s$. A molecule synthesized at time $\\tau \\in [0, t]$ will survive until time $t$ with probability $e^{-d_m(t-\\tau)}$. By the property of thinning a Poisson process, the process of births that survive until time $t$ is a non-homogeneous Poisson process with an effective rate $\\lambda(\\tau) = k_s e^{-d_m(t-\\tau)}$. The total number of such molecules, $N_B(t)$, follows a Poisson distribution with a mean $\\lambda_B(t)$ equal to the integral of this rate from $0$ to $t$:\n$$\n\\lambda_B(t) = \\int_0^t k_s e^{-d_m(t-\\tau)} d\\tau = k_s e^{-d_m t} \\left[ \\frac{e^{d_m \\tau}}{d_m} \\right]_0^t = \\frac{k_s}{d_m}(1 - e^{-d_m t})\n$$\nThus, the distribution of newly synthesized molecules is:\n$$\nN_B(t) \\sim \\text{Poisson}(\\lambda_B(t))\n$$\n\n**Full Distribution $P(n,t)$**:\nSince $N_S(t)$ and $N_B(t)$ are independent, the probability distribution for their sum $N(t) = N_S(t) + N_B(t)$ is the convolution of their individual distributions:\n$$\nP(n, t | n_0, 0) = \\mathbb{P}\\{N(t) = n\\} = \\sum_{k=0}^{n} \\mathbb{P}\\{N_S(t)=k\\} \\cdot \\mathbb{P}\\{N_B(t)=n-k\\}\n$$\nSince $\\mathbb{P}\\{N_S(t)=k\\}$ is only non-zero for $k \\le n_0$, the sum is limited to $k \\le \\min(n, n_0)$:\n$$\nP(n, t | n_0, 0) = \\sum_{k=0}^{\\min(n, n_0)} \\left[ \\binom{n_0}{k} (e^{-d_m t})^k (1-e^{-d_m t})^{n_0-k} \\right] \\left[ \\frac{(\\lambda_B(t))^{n-k} e^{-\\lambda_B(t)}}{(n-k)!} \\right]\n$$\nwith $\\lambda_B(t) = \\frac{k_s}{d_m}(1 - e^{-d_m t})$.\n\n**Boundary Cases Analysis**:\n-   If $d_m=0$, then $p_S(t)=1$ and $\\lambda_B(t)=k_s t$. The binomial distribution for $N_S(t)$ collapses to a point mass at $n_0$. $N(t) = n_0 + N_B(t)$, where $N_B(t) \\sim \\text{Poisson}(k_s t)$. This is a shifted Poisson distribution.\n-   If $k_s=0$, then $\\lambda_B(t)=0$. The Poisson distribution for $N_B(t)$ collapses to a point mass at $0$. $N(t) = N_S(t) \\sim \\text{Binomial}(n_0, e^{-d_m t})$. This is a pure death process.\n-   If $t=0$, then $p_S(t)=1$ and $\\lambda_B(t)=0$. Both distributions collapse to point masses at $n_0$ and $0$ respectively, so $N(0)=n_0$, which is consistent with the initial condition.\n\n### Computational Implementation\nThe derived analytical expressions will be implemented in Python. For the probability calculation, which involves a sum over terms with factorials and powers, direct computation can lead to numerical overflow or underflow for large copy numbers. To ensure stability, computations will be performed in log-space. The natural logarithm of the binomial and Poisson PMFs will be calculated using `scipy.special.gammaln` for log-factorials. The final probability is obtained by summing the terms using a log-sum-exp stabilization technique. Specific boundary cases ($t=0$ and $d_m=0$) will be handled explicitly to avoid numerical issues like division by zero.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammaln, xlogy\n\ndef solve():\n    \"\"\"\n    Solves the gene expression model for given test cases.\n\n    This function calculates the mean, variance, and a specific probability\n    for the mRNA copy number N(t) based on the analytical solutions derived\n    from the Chemical Master Equation for an immigration-death process.\n    \"\"\"\n    \n    # Test suite with parameter values covering typical behavior and edge cases.\n    test_cases = [\n        # Case 1 (happy path)\n        {'ks': 5.0, 'd_m': 0.2, 'n0': 3, 't': 10.0, 'm': 7},\n        # Case 2 (pure degradation boundary)\n        {'ks': 0.0, 'd_m': 0.5, 'n0': 10, 't': 3.0, 'm': 4},\n        # Case 3 (pure transcription boundary)\n        {'ks': 2.5, 'd_m': 0.0, 'n0': 1, 't': 20.0, 'm': 15},\n        # Case 4 (initial-time boundary)\n        {'ks': 3.0, 'd_m': 0.1, 'n0': 8, 't': 0.0, 'm': 8},\n        # Case 5 (large-rate stability test)\n        {'ks': 1000.0, 'd_m': 5.0, 'n0': 0, 't': 1.5, 'm': 200},\n    ]\n\n    results = []\n    \n    # Epsilon for floating point comparison with zero\n    dm_threshold = 1e-12\n\n    for case in test_cases:\n        ks, d_m, n0, t, m = case['ks'], case['d_m'], case['n0'], case['t'], case['m']\n\n        # Handle the initial time boundary case (t=0)\n        if t == 0.0:\n            mean = float(n0)\n            variance = 0.0\n            prob = 1.0 if m == n0 else 0.0\n            results.append([mean, variance, prob])\n            continue\n\n        # Handle the no-degradation boundary case (d_m=0)\n        if abs(d_m)  dm_threshold:\n            mean = n0 + ks * t\n            variance = ks * t\n            \n            # Probability is a shifted Poisson distribution\n            lambda_b = ks * t\n            if m  n0:\n                prob = 0.0\n            else:\n                j = m - n0\n                if lambda_b == 0.0: # If ks=0 or t=0\n                     prob = 1.0 if j == 0 else 0.0\n                else:\n                    log_prob = xlogy(j, lambda_b) - lambda_b - gammaln(j + 1)\n                    prob = np.exp(log_prob)\n\n            results.append([mean, variance, prob])\n            continue\n\n        # General case (d_m > 0)\n        p_survival = np.exp(-d_m * t)\n        \n        # Mean\n        lambda_b = (ks / d_m) * (1.0 - p_survival)\n        mean = n0 * p_survival + lambda_b\n        \n        # Variance\n        variance = n0 * p_survival * (1.0 - p_survival) + lambda_b\n        \n        # Probability calculation via convolution, using log-space for numerical stability.\n        # P(N(t)=m) = sum_{k=0 to min(m,n0)} P(N_S=k) * P(N_B=m-k)\n        # N_S ~ Binomial(n0, p_survival), N_B ~ Poisson(lambda_b)\n        \n        if m  0:\n            prob = 0.0\n        else:\n            log_terms = []\n            # Sum over k, the number of survivors from the initial n0 molecules.\n            for k in range(min(m, n0) + 1):\n                j = m - k # Number of molecules from new births.\n                \n                # Log-probability of k survivors from n0 (Binomial)\n                # handle log(1-p_survival) carefully when p_survival is near 1\n                if p_survival == 1.0: # should not happen due to t>0 and d_m>0\n                    log_p_one_minus = -np.inf if (n0-k) > 0 else 0.0\n                else:\n                    log_p_one_minus = (n0 - k) * np.log1p(-p_survival)\n\n                log_p_survival_k = (gammaln(n0 + 1) - gammaln(k + 1) - gammaln(n0 - k + 1) + \n                                    xlogy(k, p_survival) + log_p_one_minus)\n                \n                # Log-probability of j new molecules (Poisson)\n                if lambda_b == 0.0: # if ks=0\n                    log_p_birth_j = 0.0 if j == 0 else -np.inf\n                else:\n                    log_p_birth_j = xlogy(j, lambda_b) - lambda_b - gammaln(j + 1)\n                \n                log_terms.append(log_p_survival_k + log_p_birth_j)\n\n            # Log-sum-exp trick to compute sum of probabilities from log-probabilities\n            if not log_terms:\n                prob = 0.0\n            else:\n                max_log_term = np.max(log_terms)\n                if max_log_term == -np.inf:\n                    prob = 0.0\n                else:\n                    sum_exp = np.sum(np.exp(np.array(log_terms) - max_log_term))\n                    final_log_prob = max_log_term + np.log(sum_exp)\n                    prob = np.exp(final_log_prob)\n\n        results.append([mean, variance, prob])\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        },
        {
            "introduction": "Experimental evidence shows that transcription often occurs in discrete, multi-molecule \"bursts,\" leading to higher-than-expected cellular variability. This practice refines our stochastic model to account for this critical biological phenomenon . Using the powerful method of Probability Generating Functions (PGFs), you will derive the stationary distribution of mRNA levels and discover how transcriptional bursting leads to super-Poissonian noise, a key feature of gene expression in many organisms.",
            "id": "3920609",
            "problem": "Consider a simple stochastic model of messenger RNA (mRNA) production in transcriptional bursts for a single gene. The biological basis follows the Central Dogma of Molecular Biology: DNA is transcribed to mRNA, and mRNA is degraded. We model the production of mRNA as a bursty process where bursts arrive according to a time-homogeneous Poisson process with rate $\\lambda$ (in $\\mathrm{s^{-1}}$), and the burst size (the number of mRNA molecules produced in a single burst) is an independent and identically distributed random variable with a geometric distribution supported on $\\{0,1,2,\\dots\\}$ with success probability $q \\in (0,1)$, so that the expected burst size is $\\mathbb{E}[B] = \\frac{1-q}{q}$. Each mRNA molecule degrades independently with a first-order rate constant $d_m$ (in $\\mathrm{s^{-1}}$). All stochastic events are assumed to be independent.\n\nStarting from the Chemical Master Equation (CME) for this immigration-death process with batch arrivals and using the Probability Generating Function (PGF) method, derive the stationary distribution of the mRNA copy number. Show that the stationary PGF $G(z) = \\sum_{n=0}^{\\infty} P(N=n) z^{n}$ satisfies a first-order linear differential equation derived from balancing burst arrivals and linear degradation, and solve this equation to identify the parametric family of the stationary distribution. From this stationary distribution, derive closed-form expressions for the mean $\\mu$, variance $\\sigma^{2}$, and Fano factor $F = \\sigma^{2}/\\mu$, in terms of the parameters $\\lambda$, $q$, and $d_m$. Express all algebraic quantities using symbols and fundamental constants only.\n\nAlgorithmic task: Implement a program that, for given $(\\lambda, q, d_m)$ and two integers $(n^{\\ast}, n_{0})$, computes the following outputs at stationarity:\n- The mean $\\mu$ (in molecules; dimensionless count).\n- The variance $\\sigma^{2}$ (in molecules squared; dimensionless).\n- The Fano factor $F$ (dimensionless).\n- The stationary probability mass $P(N = n^{\\ast})$ (dimensionless decimal).\n- The upper-tail probability $P(N \\ge n_{0})$ (dimensionless decimal), using the exact cumulative distribution function implied by the derived stationary distribution.\n\nYou must ensure scientific realism by using parameters such that $q \\in (0,1)$, $\\lambda \\ge 0$, and $d_m > 0$. All outputs must be real-valued decimals. No angles are involved; no physical units are required for the outputs because they are dimensionless counts or probabilities. Use double-precision arithmetic.\n\nTest suite:\n- Case A (happy path): $\\lambda = 0.5$ $\\mathrm{s^{-1}}$, $q = 0.6$, $d_m = 0.2$ $\\mathrm{s^{-1}}$, $n^{\\ast} = 3$, $n_{0} = 5$.\n- Case B (near-Poisson regime): $\\lambda = 1.0$ $\\mathrm{s^{-1}}$, $q = 0.95$, $d_m = 0.1$ $\\mathrm{s^{-1}}$, $n^{\\ast} = 0$, $n_{0} = 1$.\n- Case C (large bursts): $\\lambda = 0.2$ $\\mathrm{s^{-1}}$, $q = 0.1$, $d_m = 0.05$ $\\mathrm{s^{-1}}$, $n^{\\ast} = 30$, $n_{0} = 50$.\n- Case D (low effective arrival): $\\lambda = 0.07$ $\\mathrm{s^{-1}}$, $q = 0.7$, $d_m = 0.7$ $\\mathrm{s^{-1}}$, $n^{\\ast} = 1$, $n_{0} = 2$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of five decimals in the order $[\\mu,\\sigma^{2},F,P(N=n^{\\ast}),P(N\\ge n_{0})]$. For example, the output should look like:\n$[[\\mu_{A},\\sigma^{2}_{A},F_{A},P_{A},T_{A}],[\\mu_{B},\\sigma^{2}_{B},F_{B},P_{B},T_{B}],[\\mu_{C},\\sigma^{2}_{C},F_{C},P_{C},T_{C}],[\\mu_{D},\\sigma^{2}_{D},F_{D},P_{D},T_{D}]]$.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It describes a standard and solvable model of stochastic gene expression. All necessary parameters and definitions are provided, and no contradictions are present. The task is to derive the stationary statistics of mRNA copy number and implement an algorithm to compute these statistics for given parameter sets. The problem is valid.\n\nThe derivation proceeds in three main stages: first, formulating the Chemical Master Equation (CME) for the process; second, using the Probability Generating Function (PGF) to solve for the stationary distribution; and third, deriving the statistical moments and probabilities from the identified distribution.\n\nLet $N(t)$ be the random variable representing the number of mRNA molecules at time $t$, and let $P(n, t) = \\mathrm{Prob}(N(t)=n)$ be the probability of having $n$ molecules at time $t$. The process is governed by two types of events:\n1.  **mRNA production**: Bursts of mRNA synthesis occur as a Poisson process with rate $\\lambda$ (units of $\\mathrm{s^{-1}}$). The number of molecules produced in a single burst, $B$, is a random variable following a geometric distribution on the set $\\{0, 1, 2, \\dots\\}$ with success probability $q$, i.e., $P(B=k) = q(1-q)^k$ for $k \\in \\{0, 1, 2, \\dots\\}$.\n2.  **mRNA degradation**: Each mRNA molecule degrades independently with a first-order rate constant $d_m$ (units of $\\mathrm{s^{-1}}$). For a state with $n$ molecules, the total degradation rate is $d_m n$.\n\nThe Chemical Master Equation (CME) describes the time evolution of $P(n,t)$ by balancing the probability flow into and out of state $n$:\n$$ \\frac{dP(n,t)}{dt} = \\underbrace{d_m (n+1) P(n+1,t)}_{\\text{Degradation from } n+1} - \\underbrace{d_m n P(n,t)}_{\\text{Degradation from } n} + \\underbrace{\\lambda \\sum_{k=0}^{n} P(B=k) P(n-k,t)}_{\\text{Production to } n} - \\underbrace{\\lambda P(n,t)}_{\\text{Production from } n} $$\nAt stationarity, $\\frac{dP(n,t)}{dt} = 0$. Let $P_n = P(N=n)$ denote the stationary probability. The CME becomes:\n$$ 0 = d_m(n+1)P_{n+1} - d_m n P_n + \\lambda \\sum_{k=0}^{n} P(B=k) P_{n-k} - \\lambda P_n $$\nTo solve this system of equations, we use the Probability Generating Function (PGF) method. The stationary PGF is defined as $G(z) = \\sum_{n=0}^{\\infty} P_n z^n$. We multiply the stationary CME by $z^n$ and sum over all $n \\ge 0$. We transform each term as follows:\n- $\\sum_{n=0}^{\\infty} d_m (n+1) P_{n+1} z^n = d_m \\sum_{j=1}^{\\infty} j P_j z^{j-1} = d_m \\frac{dG(z)}{dz} = d_m G'(z)$\n- $\\sum_{n=0}^{\\infty} -d_m n P_n z^n = -d_m z \\sum_{n=1}^{\\infty} n P_n z^{n-1} = -d_m z G'(z)$\n- $\\sum_{n=0}^{\\infty} \\left(\\lambda \\sum_{k=0}^{n} P(B=k) P_{n-k}\\right) z^n = \\lambda \\left(\\sum_{k=0}^{\\infty} P(B=k) z^k\\right) \\left(\\sum_{j=0}^{\\infty} P_j z^j\\right) = \\lambda G_B(z) G(z)$, where $G_B(z)$ is the PGF of the burst size distribution.\n- $\\sum_{n=0}^{\\infty} -\\lambda P_n z^n = -\\lambda G(z)$\n\nThe PGF of the geometric burst size distribution $P(B=k) = q(1-q)^k$ is:\n$$ G_B(z) = \\sum_{k=0}^\\infty q(1-q)^k z^k = q \\sum_{k=0}^\\infty ((1-q)z)^k = \\frac{q}{1-(1-q)z} $$\nCombining the transformed terms yields a first-order ordinary differential equation for $G(z)$:\n$$ 0 = d_m G'(z) - d_m z G'(z) + \\lambda G_B(z) G(z) - \\lambda G(z) $$\n$$ d_m(1-z) G'(z) = \\lambda (1 - G_B(z)) G(z) $$\nSubstituting the expression for $G_B(z)$:\n$$ d_m(1-z) G'(z) = \\lambda \\left(1 - \\frac{q}{1-(1-q)z}\\right) G(z) = \\lambda \\left(\\frac{1-(1-q)z - q}{1-(1-q)z}\\right) G(z) = \\lambda \\frac{(1-q)(1-z)}{1-(1-q)z} G(z) $$\nFor $z \\neq 1$, we can simplify to:\n$$ \\frac{G'(z)}{G(z)} = \\frac{\\lambda(1-q)}{d_m(1-(1-q)z)} $$\nIntegrating with respect to $z$:\n$$ \\ln G(z) = \\int \\frac{\\lambda(1-q)}{d_m(1-(1-q)z)} dz = \\frac{\\lambda(1-q)}{d_m} \\left(-\\frac{1}{1-q}\\ln(1-(1-q)z)\\right) + C = -\\frac{\\lambda}{d_m} \\ln(1-(1-q)z) + C $$\nExponentiating gives $G(z) = e^C (1-(1-q)z)^{-\\lambda/d_m}$. The constant $e^C$ is determined by the condition $G(0)=P_0$, so $e^C=P_0$. The property $G(1)=1$ gives $1 = P_0 (1-(1-q))^{-\\lambda/d_m} = P_0 q^{-\\lambda/d_m}$, which implies $P_0 = q^{\\lambda/d_m}$.\nThus, the stationary PGF is:\n$$ G(z) = q^{\\lambda/d_m} (1-(1-q)z)^{-\\lambda/d_m} = \\left(\\frac{q}{1-(1-q)z}\\right)^{\\lambda/d_m} $$\nThis is the PGF of a Negative Binomial distribution, $N \\sim \\mathrm{NB}(r, p)$, with parameters:\n- Number of successes, $r = \\frac{\\lambda}{d_m}$\n- Probability of success, $p = q$\n\nThe probability mass function (PMF) is given by $P(N=n) = \\binom{n+r-1}{n} p^r (1-p)^n$ for $n \\in \\{0, 1, 2, \\dots\\}$. For non-integer $r$, the binomial coefficient is expressed using the Gamma function $\\Gamma(x)$:\n$$ P(N=n) = \\frac{\\Gamma(n+r)}{\\Gamma(n+1)\\Gamma(r)} p^r (1-p)^n = \\frac{\\Gamma(n+\\lambda/d_m)}{\\Gamma(n+1)\\Gamma(\\lambda/d_m)} q^{\\lambda/d_m} (1-q)^n $$\nFrom the properties of the Negative Binomial distribution, we can derive the required statistical measures:\n- The mean $\\mu = \\mathbb{E}[N]$:\n$$ \\mu = \\frac{r(1-p)}{p} = \\frac{(\\lambda/d_m)(1-q)}{q} = \\frac{\\lambda(1-q)}{d_m q} $$\nThis can be interpreted as (burst frequency $\\lambda$) $\\times$ (mean mRNA lifetime $1/d_m$) $\\times$ (mean burst size $(1-q)/q$).\n\n- The variance $\\sigma^2 = \\mathrm{Var}(N)$:\n$$ \\sigma^2 = \\frac{r(1-p)}{p^2} = \\frac{(\\lambda/d_m)(1-q)}{q^2} = \\frac{\\lambda(1-q)}{d_m q^2} $$\n\n- The Fano factor $F = \\sigma^2/\\mu$:\n$$ F = \\frac{\\sigma^2}{\\mu} = \\frac{\\lambda(1-q)/(d_m q^2)}{\\lambda(1-q)/(d_m q)} = \\frac{1}{q} $$\nThe Fano factor is a measure of noise, and for this model, it is determined solely by the success probability $q$ of the geometric burst size distribution. As $q \\to 1$, bursts become smaller (approaching a single molecule), and $F \\to 1$, which is the Fano factor of a Poisson process. As $q \\to 0$, bursts become larger and more variable, leading to $F \\to \\infty$.\n\nFor the algorithmic task, the required quantities are computed as follows:\n- Mean $\\mu$, variance $\\sigma^2$, and Fano factor $F$ are computed using the derived closed-form expressions.\n- The stationary probability $P(N=n^{\\ast})$ is computed using the PMF of the $\\mathrm{NB}(r=\\lambda/d_m, p=q)$ distribution at $n=n^{\\ast}$.\n- The upper-tail probability $P(N \\ge n_0)$ is computed as $1 - P(N  n_0) = 1 - P(N \\le n_0-1)$. This is the survival function (SF) evaluated at $n_0-1$. For a discrete distribution, $P(N \\ge n_0) = \\sum_{k=n_0}^{\\infty} P(N=k)$. This can be efficiently computed using the cumulative distribution function (CDF), as $1 - \\mathrm{CDF}(n_0-1)$.\n\nThe calculations will use the identified Negative Binomial distribution with parameters $r = \\lambda/d_m$ and $p = q$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import nbinom\n\ndef solve():\n    \"\"\"\n    Computes stationary statistics for a stochastic gene expression model.\n\n    The model considers bursty mRNA production and first-order degradation.\n    The stationary distribution of mRNA copy number is a Negative Binomial\n    distribution. This function calculates its mean, variance, Fano factor,\n    a specific PMF value, and an upper-tail probability for given parameter sets.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    # Each case is a tuple: (lambda, q, d_m, n_star, n_0)\n    test_cases = [\n        (0.5, 0.6, 0.2, 3, 5),   # Case A\n        (1.0, 0.95, 0.1, 0, 1),  # Case B\n        (0.2, 0.1, 0.05, 30, 50), # Case C\n        (0.07, 0.7, 0.7, 1, 2)    # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        lambda_, q, d_m, n_star, n0 = case\n\n        # The stationary distribution is Negative Binomial NB(r, p)\n        # with parameters r and p derived from the model parameters.\n        r = lambda_ / d_m\n        p = q\n\n        # 1. Mean (mu)\n        # Formula: mu = r * (1-p) / p\n        mu = r * (1 - p) / p\n\n        # 2. Variance (sigma^2)\n        # Formula: sigma^2 = r * (1-p) / p^2 = mu / p\n        sigma_sq = mu / p\n        \n        # 3. Fano factor (F)\n        # Formula: F = sigma^2 / mu = 1 / p\n        fano_factor = 1 / p\n\n        # 4. Stationary probability P(N = n*)\n        # Computed using the PMF of the Negative Binomial distribution.\n        # pmf(k, r, p) = C(k+r-1, k) * p^r * (1-p)^k\n        prob_n_star = nbinom.pmf(n_star, r, p)\n\n        # 5. Upper-tail probability P(N >= n0)\n        # This is 1 - CDF(n0 - 1), which is the survival function sf(n0 - 1).\n        # sf(k) gives P(X > k), so we need sf(n0 - 1) for P(X >= n0).\n        tail_prob = nbinom.sf(n0 - 1, r, p)\n        \n        # Collect results for the current test case.\n        case_results = [mu, sigma_sq, fano_factor, prob_n_star, tail_prob]\n        results.append(case_results)\n\n    # Format the output string as specified in the problem statement.\n    # e.g., [[res1_A,res2_A,...],[res1_B,res2_B,...],...]\n    sublists_str = [f\"[{','.join(map(str, res))}]\" for res in results]\n    final_output = f\"[{','.join(sublists_str)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}