{
    "hands_on_practices": [
        {
            "introduction": "非相干前馈环（I1-FFL）的一个标志性功能是在响应持续输入信号时产生短暂的输出脉冲。这种脉冲生成能力对于需要瞬时响应而非持续响应的生物过程至关重要。通过一个简化的确定性模型，本练习将引导你解析地推导出这个脉冲的高度，从而从数学上揭示快速激活路径和延迟抑制路径之间动态相互作用的内在机制。",
            "id": "3908941",
            "problem": "考虑一个非相干前馈环，其中上游转录因子 $X$ 转录激活中间调节子 $Y$ 和输出基因 $Z$，而 $Y$ 抑制 $Z$。假设一个具有 Hill 型调控动力学和线性降解的确定性常微分方程（ODE）模型，这与合成生物学建模的标准实践一致。\n\n在时间 $t=0$ 时，$X$ 经历一次从 $0$ 到 $x_{0}$ 的阶跃增加，$x_{0}$ 的值相对于其激活解离常数 $K_{x}$ 足够大，以至于激活 Hill 函数 $H_{\\mathrm{act}}(X)$ 饱和，即对于所有 $t \\ge 0$，$H_{\\mathrm{act}}(x(t)) \\approx 1$。$Y$ 和 $Z$ 的动力学模型如下\n$$\n\\frac{dy}{dt} = \\alpha_{y} H_{\\mathrm{act}}(x(t)) - \\beta_{y} y, \\quad y(0)=0,\n$$\n$$\n\\frac{dz}{dt} = \\alpha_{z} H_{\\mathrm{act}}(x(t)) \\, H_{\\mathrm{rep}}(y(t)) - \\beta_{z} z, \\quad z(0)=0,\n$$\n其中 $H_{\\mathrm{act}}(x) = \\frac{x^{n_{a}}}{K_{x}^{n_{a}} + x^{n_{a}}}$ 且 $H_{\\mathrm{rep}}(y) = \\frac{1}{1 + \\left(\\frac{y}{K}\\right)^{n}}$。假设 $n_{a}$ 足够大，使得对于 $t \\ge 0$，$H_{\\mathrm{act}}(x(t)) \\approx 1$。并假设抑制子 $Y$ 高度协同，其 Hill 系数 $n \\to \\infty$，因此 $H_{\\mathrm{rep}}(y)$ 趋近于一个理想开关：当 $y  K$ 时，$H_{\\mathrm{rep}}(y) = 1$；当 $y  K$ 时，$H_{\\mathrm{rep}}(y) = 0$。假设 $\\alpha_{y}  \\beta_{y} K$，使得阈值 $K$ 在有限时间内被跨越。\n\n从上述定义和 ODE 出发，并仅使用极限 $n \\to \\infty$ 将 $H_{\\mathrm{rep}}(y)$ 近似为关于 $y$ 的 Heaviside 阶跃开关，推导 $z(t)$ 的瞬时峰值（即 $z(t)$ 在 $t \\ge 0$ 上的最大值）关于生化参数 $\\alpha_{y}$、$\\beta_{y}$、$\\alpha_{z}$、$\\beta_{z}$ 和 $K$ 的显式闭式解析表达式。\n\n以 $\\alpha_{y}$、$\\beta_{y}$、$\\alpha_{z}$、$\\beta_{z}$ 和 $K$ 的单个闭式表达式形式提供您的最终答案。最终表达式中不要包含单位。不需要进行数值计算或舍入。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据、是良定的且客观的。它提出了合成生物学建模中的一个标准问题，该问题是自洽的，并允许一个唯一且有意义的解。\n\n该问题描述了一个非相干前馈环（IFFL），其中转录因子 $X$ 激活抑制子 $Y$ 和输出基因 $Z$，而 $Y$ 反过来抑制 $Z$。我们的任务是找到蛋白质 $Z$ 的峰值浓度。\n\n系统的动力学由一组常微分方程（ODE）给出。根据问题的假设，我们可以简化这些方程。输入 $X$ 是一个大的阶跃式信号的假设意味着激活 Hill 函数 $H_{\\mathrm{act}}(x(t))$ 在所有时间 $t \\ge 0$ 内都可以近似为 $1$。抑制子 $Y$ 高度协同（$n \\to \\infty$）的假设意味着抑制 Hill 函数 $H_{\\mathrm{rep}}(y(t))$ 表现为一个理想开关，当 $y  K$ 时等于 $1$，当 $y  K$ 时等于 $0$。\n\n经过这些简化，ODE 系统变为：\n$$\n\\frac{dy}{dt} = \\alpha_{y} - \\beta_{y} y, \\quad y(0)=0\n$$\n$$\n\\frac{dz}{dt} = \\alpha_{z} H_{\\mathrm{rep}}(y(t)) - \\beta_{z} z, \\quad z(0)=0\n$$\n其中 $H_{\\mathrm{rep}}(y(t))$ 是一个阶跃函数：\n$$\nH_{\\mathrm{rep}}(y(t)) = \\begin{cases} 1  \\text{if } y(t)  K \\\\ 0  \\text{if } y(t)  K \\end{cases}\n$$\n\n首先，我们求解关于 $y(t)$ 的线性一阶 ODE：\n方程 $\\frac{dy}{dt} + \\beta_{y} y = \\alpha_{y}$ 在初始条件 $y(0)=0$ 下的解为：\n$$\ny(t) = \\frac{\\alpha_{y}}{\\beta_{y}} (1 - \\exp(-\\beta_{y} t))\n$$\n这个解表明 $y(t)$ 从 $0$ 开始单调增加，趋向于稳态值 $y_{ss} = \\frac{\\alpha_{y}}{\\beta_{y}}$。问题陈述了 $\\alpha_{y}  \\beta_{y} K$，这意味着 $y_{ss}  K$。因此，$Y$ 的浓度将在某个有限时间跨越阈值 $K$，我们将其记为 $t^*$。\n\n我们通过令 $y(t^*) = K$ 来求 $t^*$：\n$$\nK = \\frac{\\alpha_{y}}{\\beta_{y}} (1 - \\exp(-\\beta_{y} t^*))\n$$\n整理各项以求解 $t^*$：\n$$\n\\frac{\\beta_{y} K}{\\alpha_{y}} = 1 - \\exp(-\\beta_{y} t^*)\n$$\n$$\n\\exp(-\\beta_{y} t^*) = 1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\n$$\n对两边取自然对数：\n$$\n-\\beta_{y} t^* = \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)\n$$\n$$\nt^* = -\\frac{1}{\\beta_{y}} \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right) = \\frac{1}{\\beta_{y}} \\ln\\left(\\frac{\\alpha_{y}}{\\alpha_{y} - \\beta_{y} K}\\right)\n$$\n\n现在我们分析 $z(t)$ 的动力学。$z(t)$ 的行为在 $t=t^*$ 时发生变化。\n对于 $0 \\le t  t^*$，我们有 $y(t)  K$，因此 $H_{\\mathrm{rep}}(y(t)) = 1$。$z(t)$ 的 ODE 是：\n$$\n\\frac{dz}{dt} = \\alpha_{z} - \\beta_{z} z, \\quad z(0)=0\n$$\n这个 ODE 的解是：\n$$\nz(t) = \\frac{\\alpha_{z}}{\\beta_{z}} (1 - \\exp(-\\beta_{z} t))\n$$\n在此时间间隔内，导数 $\\frac{dz}{dt} = \\alpha_{z} - \\beta_{z} z(t) = \\alpha_{z} \\exp(-\\beta_{z} t)$ 恒为正，所以 $z(t)$ 是严格递增的。\n\n对于 $t  t^*$，我们有 $y(t)  K$，因此 $H_{\\mathrm{rep}}(y(t)) = 0$。$z(t)$ 的 ODE 变为：\n$$\n\\frac{dz}{dt} = - \\beta_{z} z\n$$\n解为 $z(t) = z(t^*) \\exp(-\\beta_{z} (t-t^*))$。由于 $z(t^*)  0$，对于所有 $t  t^*$，导数 $\\frac{dz}{dt}$ 为负，意味着 $z(t)$ 在此区间内是严格递减的。\n\n由于 $z(t)$ 在 $t  t^*$ 时递增，在 $t  t^*$ 时递减，因此 $z(t)$ 的最大值，我们记为 $z_{peak}$，恰好在 $t = t^*$ 时出现。为求得 $z_{peak}$，我们在 $t=t^*$ 处计算第一阶段 $z(t)$ 的解：\n$$\nz_{peak} = z(t^*) = \\frac{\\alpha_{z}}{\\beta_{z}} (1 - \\exp(-\\beta_{z} t^*))\n$$\n我们现在将 $t^*$ 的表达式代入此方程。从 $t^*$ 的推导中，我们有 $\\exp(-\\beta_{y} t^*) = 1 - \\frac{\\beta_{y} K}{\\alpha_{y}}$。我们需要求出 $\\exp(-\\beta_{z} t^*)$：\n$$\n\\exp(-\\beta_{z} t^*) = \\exp\\left(-\\beta_{z} \\left(-\\frac{1}{\\beta_{y}} \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)\\right)\\right)\n$$\n$$\n\\exp(-\\beta_{z} t^*) = \\exp\\left(\\frac{\\beta_{z}}{\\beta_{y}} \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)\\right)\n$$\n使用恒等式 $\\exp(c \\ln a) = a^c$：\n$$\n\\exp(-\\beta_{z} t^*) = \\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)^{\\frac{\\beta_{z}}{\\beta_{y}}}\n$$\n将此结果代入 $z_{peak}$ 的表达式中：\n$$\nz_{peak} = \\frac{\\alpha_{z}}{\\beta_{z}} \\left[ 1 - \\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)^{\\frac{\\beta_{z}}{\\beta_{y}}} \\right]\n$$\n这就是 $z(t)$ 的瞬时峰值作为给定生化参数函数的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\alpha_{z}}{\\beta_{z}} \\left( 1 - \\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)^{\\frac{\\beta_{z}}{\\beta_{y}}} \\right)}\n$$"
        },
        {
            "introduction": "在分析了瞬态动力学之后，我们将注意力转向基因回路的稳态行为，这对于理解其如何处理不同强度的持续信号至关重要。本练习是一个计算实践，你将编写程序来绘制相干和非相干前馈环的剂量响应曲线，从而直观地揭示它们作为信号处理器的不同功能：C1-FFL作为“持续性检测器”，而I1-FFL则充当“带通滤波器”。",
            "id": "3908933",
            "problem": "考虑合成生物学中的两种基因调控基序：相干1型前馈环（C1-FFL）和非相干1型前馈环（I1-FFL）。在这两种基序中，一个外部输入 $S$（一个无量纲的诱导剂浓度）调控一个中间转录因子 $Y$，并且 $S$ 和 $Y$ 共同调控输出基因产物 $Z$。使用带有 Hill 型调控的常微分方程，在以下科学标准假设下对这些基序进行建模：(i) 产生和降解与浓度呈线性关系，(ii) 激活遵循 Hill 函数，以及 (iii) 抑制遵循标准递减形式的 Hill 函数。所有量均为无量纲。\n\n定义：\n- 激活 Hill 函数：$H_{\\mathrm{act}}(x;K,n) = \\dfrac{x^n}{K^n + x^n}$。\n- 抑制 Hill 函数：$H_{\\mathrm{rep}}(y;K,n) = \\dfrac{K^n}{K^n + y^n}$。\n- $Y$ 的动力学：$\\dfrac{dY}{dt} = k_y \\, H_{\\mathrm{act}}(S;K_y,n_y) - \\gamma_y Y$。\n- C1-FFL 中 $Z$ 的动力学：$\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{act}}(Y;K_{zY},n_{zY}) - \\gamma_z Z$。\n- I1-FFL 中 $Z$ 的动力学：$\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{rep}}(Y;K_{zY},n_{zY}) - \\gamma_z Z$。\n\n在稳态下，$Y^\\ast(S) = \\dfrac{k_y}{\\gamma_y} \\, H_{\\mathrm{act}}(S;K_y,n_y)$ 且 $Z^\\ast(S)$ 等于 $\\dfrac{k_z}{\\gamma_z}$ 乘以该基序上方定义的相应 Hill 项的乘积。该基序的剂量响应是当 $S$ 在指定范围内变化时的函数 $Z^\\ast(S)$。当一个参数变化时，$Z^\\ast(S)$ 形状的结构性变化（例如，从先前的单调曲线上出现一个内部最大值）是本问题中分岔分析的焦点。\n\n您的任务是编写一个完整的程序，该程序：\n1. 使用上述定义，为两种基序实现稳态剂量响应 $Z^\\ast(S)$。\n2. 通过分析在对数间隔的 $S$ 值网格上计算出的 $Z^\\ast(S)$，检测给定参数下 $Z^\\ast(S)$ 是否具有内部极值（特别是在严格位于范围内的某个 $S$ 处的局部最大值）。\n3. 对 I1-FFL 的抑制阈值 $K_{zY}$ 进行参数扫描，以估计剂量响应 $Z^\\ast(S)$ 获得内部最大值（解释为带通形状的起始）的最小 $K_{zY}$，这构成了所要求的关于 $K_{zY}$ 的分岔起始点。\n\n除非在特定测试中有所变化，否则请统一使用以下参数值：\n- $k_y/\\gamma_y = 1.0$,\n- $k_z/\\gamma_z = 1.0$,\n- $K_y = 1.0$, $n_y = 2$,\n- $K_{zS} = 1.0$, $n_{zS} = 2$,\n- 对于 $K_{zY}$ 和 $n_{zY}$，其值在下文每个测试中指定。\n\n使用一个在 $S \\in [10^{-3}, 10^{3}]$ 范围内的对数间隔网格，包含 $N = 1000$ 个点。所有量均为无量纲。应仅从离散的 $Z^\\ast(S)$ 序列中检测是否存在内部最大值，方法是识别至少一个索引 $i$（其中 $1 \\le i \\le N-2$）满足 $Z^\\ast(S_i)  Z^\\ast(S_{i-1})$ 且 $Z^\\ast(S_i) \\ge Z^\\ast(S_{i+1})$。\n\n测试套件：\n- 测试 1 (I1-FFL 分岔起始)：在集合 $\\{0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0\\}$ 上扫描 $K_{zY}$，其中 $n_{zY} = 4$。对于每个 $K_{zY}$，评估是否存在内部最大值。返回检测到最大值时的最小 $K_{zY}$。如果集合中任何 $K_{zY}$ 都未检测到最大值，则返回 $-1.0$。\n- 测试 2 (C1-FFL 单调性检查)：在 $K_{zY} = 1.0$ 和 $n_{zY} = 2$ 的条件下，评估 C1-FFL 剂量响应是否具有内部最大值。返回一个布尔值，指示是否存在此类最大值（存在为 $\\mathrm{True}$，不存在为 $\\mathrm{False}$）。\n- 测试 3 (I1-FFL 固定参数下的形状)：在 $K_{zY} = 0.2$ 和 $n_{zY} = 4$ 的条件下，评估 I1-FFL 剂量响应是否具有内部最大值。返回一个布尔值。\n- 测试 4 (I1-FFL 峰值位置)：在 $K_{zY} = 0.05$ 和 $n_{zY} = 4$ 的条件下，计算在指定网格上 $Z^\\ast(S)$ 达到其最大值时的 $S$ 值。以浮点数形式返回此 $S$ 值。\n\n最终输出格式：\n您的程序应生成单行输出，其中按顺序包含测试 1 到 4 的结果，格式为用方括号括起来的逗号分隔列表（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$）。每个结果必须是以下基本类型之一：布尔值或浮点数。不应打印任何其他文本。",
            "solution": "我们从标准的基因调控建模假设开始，其中调节子通过 Hill 型激活或抑制来调节基因表达，并且降解与浓度呈线性关系。Hill 函数捕捉了协同结合和饱和效应，这在转录调控的生物物理模型中是公认的。\n\n激活 Hill 函数是 $H_{\\mathrm{act}}(x;K,n) = \\dfrac{x^n}{K^n + x^n}$，它关于 $x$ 单调递增，界于 0 和 1 之间，并具有有效阈值 $K$。抑制 Hill 函数是 $H_{\\mathrm{rep}}(y;K,n) = \\dfrac{K^n}{K^n + y^n}$，它关于 $y$ 单调递减，同样界于 0 和 1 之间，并具有有效阈值 $K$。\n\n设 $S$ 为输入。中间产物 $Y$ 遵循 $\\dfrac{dY}{dt} = k_y H_{\\mathrm{act}}(S;K_y,n_y) - \\gamma_y Y$，这会产生一个唯一的稳态 $Y^\\ast(S) = \\dfrac{k_y}{\\gamma_y} H_{\\mathrm{act}}(S;K_y,n_y)$，因为方程右侧关于 $Y$ 是线性的，且带有一个非负有界的源项。\n\n对于输出 $Z$，相干1型前馈环（C1-FFL）使用两个激活项的乘积，一个针对 $S$，一个针对 $Y$：\n$$\n\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{act}}(Y;K_{zY},n_{zY}) - \\gamma_z Z.\n$$\n在稳态下，因为 $Z$ 的动力学是线性的且带有一个非负源项，我们有\n$$\nZ^\\ast_{\\mathrm{coh}}(S) = \\dfrac{k_z}{\\gamma_z} \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{act}}(Y^\\ast(S);K_{zY},n_{zY}).\n$$\n由于 $H_{\\mathrm{act}}(S;\\cdot)$ 和 $H_{\\mathrm{act}}(Y^\\ast(S);\\cdot)$ 都是关于 $S$ 的单调递增函数，且递增函数的乘积也是递增的，因此 $Z^\\ast_{\\mathrm{coh}}(S)$ 关于 $S$ 是单调递增的，没有内部最大值。在数值上，这意味着在一个离散网格中，除非在平台区出现数值伪影，否则没有内部索引 $i$ 会满足 $Z_i  Z_{i-1}$ 和 $Z_i \\ge Z_{i+1}$。\n\n对于非相干1型前馈环（I1-FFL），源项是一个激活项和一个抑制项的乘积：\n$$\n\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{rep}}(Y;K_{zY},n_{zY}) - \\gamma_z Z.\n$$\n稳态输出为\n$$\nZ^\\ast_{\\mathrm{incoh}}(S) = \\dfrac{k_z}{\\gamma_z} \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{rep}}(Y^\\ast(S);K_{zY},n_{zY}).\n$$\n在这里，$H_{\\mathrm{act}}(S;\\cdot)$ 随 $S$ 增加而增加，但 $H_{\\mathrm{rep}}(Y^\\ast(S);\\cdot)$ 随 $S$ 增加而减少，因为 $Y^\\ast(S)$ 本身是随 $S$ 增加而增加的。一个递增函数和一个递减函数的乘积可以是非单调的，当抑制分支足够强且具有协同性时，通常会产生一个带有内部最大值的带通剂量响应。\n\n在此背景下，分岔分析被定义为当抑制阈值 $K_{zY}$ 变化时，稳态剂量响应曲线的结构性变化。对于大的 $K_{zY}$，在 $Y^\\ast(S)$ 的取值范围内抑制作用很弱，因此 $Z^\\ast_{\\mathrm{incoh}}(S)$ 趋向于单调递增（没有内部最大值）。随着 $K_{zY}$ 减小，抑制作用在 $S$ 范围内变得有效，其乘积可能会出现一个内部最大值。我们通过扫描一组离散的 $K_{zY}$ 值并检查离散的剂量响应序列 $Z^\\ast(S_i)$ 是否具有内部最大值，来操作化地检测这种结构性变化，即是否存在一个索引 $i$（其中 $1 \\le i \\le N-2$）满足 $Z_i  Z_{i-1}$ 且 $Z_i \\ge Z_{i+1}$。\n\n程序中实现的算法步骤：\n1. 构建 $S$ 网格：在 $[10^{-3},10^{3}]$ 范围内取 1000 个对数间隔的点。\n2. 对于给定的参数，通过 $Y^\\ast(S) = \\dfrac{k_y}{\\gamma_y} H_{\\mathrm{act}}(S;K_y,n_y)$ 计算 $Y^\\ast(S)$。\n3. 通过将相应的 Hill 项相乘并乘以比例因子 $\\dfrac{k_z}{\\gamma_z}$，计算目标基序的 $Z^\\ast(S)$。\n4. 通过扫描离散序列 $Z^\\ast(S)$ 并检查内部索引是否满足局部最大值条件来检测内部最大值。\n5. 对于分岔起始（测试 1），在指定集合上迭代 $K_{zY}$，并返回产生内部最大值的最小 $K_{zY}$；如果没有，则返回 $-1.0$。\n6. 对于测试 2，对 C1-FFL 应用相同的检测方法；它应该返回 $\\mathrm{False}$。\n7. 对于测试 3，对固定的 I1-FFL 参数集应用该检测方法并返回布尔值。\n8. 对于测试 4，通过在网格上找到最大 $Z^\\ast(S)$ 的索引来定位 $Z^\\ast(S)$ 取最大值时的 $S$；返回该 $S$ 值。\n\n这些步骤与前馈环的定义和逻辑直接相关。相干基序的剂量响应由于是递增函数的复合而呈单调性，而非相干基序则可以随着抑制作用变得有效和协同而从单调响应过渡到带通响应。对 $K_{zY}$ 进行的参数扫描是观察稳态输入输出曲线发生质变起始点的一种系统性方法，该起始点可作为剂量响应形状的一个类分岔指标。通过将四个结果收集到一个打印在单行上的、由方括号括起来的逗号分隔列表中，来满足输出格式要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Hill activation function\ndef hill_act(x, K, n):\n    # Avoid division by zero for K=0 by enforcing positive K in tests\n    x = np.asarray(x)\n    return (x**n) / (K**n + x**n)\n\n# Hill repression function\ndef hill_rep(y, K, n):\n    y = np.asarray(y)\n    return (K**n) / (K**n + y**n)\n\ndef steady_state_Y(S, ky_over_gamma, Ky, ny):\n    return ky_over_gamma * hill_act(S, Ky, ny)\n\ndef steady_state_Z_coh(S, Ystar, kz_over_gamma, KzS, nzS, KzY, nzY):\n    return kz_over_gamma * hill_act(S, KzS, nzS) * hill_act(Ystar, KzY, nzY)\n\ndef steady_state_Z_incoh(S, Ystar, kz_over_gamma, KzS, nzS, KzY, nzY):\n    return kz_over_gamma * hill_act(S, KzS, nzS) * hill_rep(Ystar, KzY, nzY)\n\ndef has_internal_maximum(Z):\n    # Detect internal maximum: exists i (1..N-2) such that Z[i] > Z[i-1] and Z[i] >= Z[i+1]\n    # To reduce sensitivity to tiny numerical noise, add a small epsilon tolerance\n    eps = 1e-12\n    for i in range(1, len(Z) - 1):\n        if Z[i] > Z[i - 1] + eps and Z[i] >= Z[i + 1] - eps:\n            return True\n    return False\n\ndef find_S_of_max(Z, S):\n    idx = int(np.argmax(Z))\n    return float(S[idx])\n\ndef test_bifurcation_onset_I1FFL(S_grid, ky_over_gamma, kz_over_gamma, Ky, ny, KzS, nzS, nzY, KzY_values):\n    # Return the smallest KzY in KzY_values that yields an internal maximum; else -1.0\n    Ystar = steady_state_Y(S_grid, ky_over_gamma, Ky, ny)\n    for KzY in KzY_values:\n        Z = steady_state_Z_incoh(S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY, nzY)\n        if has_internal_maximum(Z):\n            return float(KzY)\n    return -1.0\n\ndef solve():\n    # Common parameters\n    ky_over_gamma = 1.0\n    kz_over_gamma = 1.0\n    Ky = 1.0\n    ny = 2\n    KzS = 1.0\n    nzS = 2\n\n    # S grid\n    S_grid = np.logspace(-3, 3, 1000)\n\n    results = []\n\n    # Test 1: I1-FFL bifurcation onset over KzY sweep\n    KzY_values = [0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0]\n    nzY_bif = 4\n    onset_KzY = test_bifurcation_onset_I1FFL(\n        S_grid, ky_over_gamma, kz_over_gamma, Ky, ny, KzS, nzS, nzY_bif, KzY_values\n    )\n    results.append(onset_KzY)\n\n    # Precompute Y* for remaining tests\n    Ystar = steady_state_Y(S_grid, ky_over_gamma, Ky, ny)\n\n    # Test 2: C1-FFL monotonicity check\n    KzY_coh = 1.0\n    nzY_coh = 2\n    Z_coh = steady_state_Z_coh(S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY_coh, nzY_coh)\n    results.append(has_internal_maximum(Z_coh))\n\n    # Test 3: I1-FFL fixed-parameter shape (has internal maximum?)\n    KzY_incoh_fixed = 0.2\n    nzY_incoh_fixed = 4\n    Z_incoh_fixed = steady_state_Z_incoh(\n        S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY_incoh_fixed, nzY_incoh_fixed\n    )\n    results.append(has_internal_maximum(Z_incoh_fixed))\n\n    # Test 4: I1-FFL peak location at strong repression\n    KzY_peak = 0.05\n    nzY_peak = 4\n    Z_incoh_peak = steady_state_Z_incoh(\n        S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY_peak, nzY_peak\n    )\n    S_at_peak = find_S_of_max(Z_incoh_peak, S_grid)\n    results.append(S_at_peak)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在真实的生物系统中，我们通常面对的是“黑箱”：我们观察动态行为，但底层的调控网络结构是未知的。一个核心挑战是仅通过测量输出来推断网络拓扑。本练习提出了一个经典的辨识问题：如何区分非相干前馈环（I-FFL）和负反馈环（NFL）？通过设计动态输入和基因敲低扰动实验，你将学会如何利用系统的动态特征来揭示其内部的接线图。",
            "id": "2722223",
            "problem": "考虑两个由外部诱导物 $X$ 驱动的三节点基因调控基序。在 $t=0$ 时刻，该诱导物从一个基础水平 $x_0$ 阶跃到一个更高的恒定水平 $x_1$。第一个基序是一个非相干前馈环 (I-FFL)：$X$ 转录激活中间抑制子 $Y$ 和输出 $Z$，而 $Y$ 抑制 $Z$。第二个基序是一个负反馈环 (NFL)：$X$ 转录激活 $Z$，$Z$ 转录激活 $Y$，而 $Y$ 抑制 $Z$。假设采用标准的基因表达动力学：合成受希尔型调控控制，降解（加上稀释）为一级反应。设动力学方程为\n对于 I-FFL：\n$$\n\\frac{dy}{dt}=\\alpha_y\\,a_X(x)-\\delta_y\\,y,\\qquad \\frac{dz}{dt}=\\alpha_z\\,a_X(x)\\,r_Y(y)-\\delta_z\\,z,\n$$\n对于 NFL：\n$$\n\\frac{dy}{dt}=\\beta_y\\,a_Z(z)-\\delta_y\\,y,\\qquad \\frac{dz}{dt}=\\alpha_z\\,a_X(x)\\,r_Y(y)-\\delta_z\\,z.\n$$\n这里 $a_X(\\cdot)$ 和 $a_Z(\\cdot)$ 是单调递增的希尔激活函数，满足 $0\\le a_\\bullet(\\cdot)\\le 1$，$r_Y(\\cdot)$ 是单调递减的希尔抑制函数，满足 $0  r_Y(\\cdot) \\le 1$。参数 $\\alpha_y,\\beta_y,\\alpha_z,\\delta_y,\\delta_z0$。阶跃输入为：当 $t0$ 时，$x(t)=x_0$；当 $t\\ge 0$ 时，$x(t)=x_1$，其中 $x_1x_0\\ge 0$。假设存在基因回路中常见的时间尺度分离：$Z$ 的响应比 $Y$ 快，即 $\\delta_z\\delta_y$，并且相对于 $Y$ 的积累，$Z$ 的有效合成对 $X$ 的响应没有延迟。\n\n你被告知，必须根据上述方程以及以下基本事实来推断短期和稳态行为：(i) 在 $t=0^+$ 时，依赖于 $Y$ 的变量最初经历的 $Y$ 值接近其阶跃前的水平，因为 $Y$ 尚未积累；(ii) 在恒定输入下的稳态解满足 $\\frac{dy}{dt}=\\frac{dz}{dt}=0$；(iii) 在负反馈中，如果没有积分控制，稳态输出通常随输入增加而增加；(iv) 在 I-FFL 中，直接激活路径和延迟抑制路径在长时间后可能相互抵消。\n\n现在考虑一个扰动实验，该实验将 $Y$ 的产生减少一个乘法因子 $s\\in(0,1)$，模拟部分敲低（例如，通过 RNA 干扰 (RNAi) 或 CRISPR 干扰 (CRISPRi)）。在 I-FFL 中实现为 $\\alpha_y\\mapsto s\\,\\alpha_y$，在 NFL 中实现为 $\\beta_y\\mapsto s\\,\\beta_y$，所有其他参数保持不变。\n\n哪个选项最佳地比较了 I-FFL 和 NFL 对 $X$ 阶跃输入的动态特征，并提出了一个使用 $Y$ 敲低来仅通过测量 $Z(t)$ 来区分这两种基序的实验？\n\nA. 在 I-FFL 中，阶跃 $x_0\\to x_1$ 产生 $z(t)$ 的快速瞬时增加，随后由于 $Y$ 的积累并抑制 $Z$， $z(t)$ 会回到接近阶跃前的水平（近似适应）；$Y$ 敲低 ($s1$) 会消除适应现象，并产生一个持续升高的 $z$ 稳态。在 NFL 中，阶跃产生一个新的稳态 $z$ 值，该值高于基线但没有精确适应；$Y$ 敲低会增加这个稳态水平并减慢响应速度。因此，在有和没有 $Y$ 敲低的情况下施加 $X$ 的阶跃：如果只有非敲低条件显示出近似适应，而敲低消除了它，那么该回路是 I-FFL；如果两种情况都不适应，那么该回路是 NFL。\n\nB. I-FFL 和 NFL 在阶跃后都表现出 $z$ 回到基线的完美适应，因为两者都包含一个抑制子；$Y$ 敲低将仅在 NFL 中诱发持续振荡，从而提供一个诊断特征。\n\nC. 在 I-FFL 中，对于任何希尔函数，稳态 $z$ 都随 $x$ 单调增加，因此不可能发生适应；在 NFL 中，负反馈确保了在稳定性的前提下精确适应到阶跃前的水平；$Y$ 敲低会降低两种基序中 $z$ 的峰值振幅，从而可以通过峰值大小进行区分。\n\nD. I-FFL 和 NFL 无法通过 $z(t)$ 的阶跃响应来区分，因为两者都可以根据参数产生脉冲或单调响应；只有频率响应测量才能将它们分开；如果 $x_1  x_0$，$Y$ 敲低不影响 I-FFL 的稳态 $z$ 值。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、问题明确且内容完整的。可以进行分析。\n\n任务是比较非相干前馈环 (I-FFL) 和负反馈环 (NFL) 的动态特征，并设计一个基于中间组分 $Y$ 敲低的实验，通过观察输出 $Z(t)$ 来区分它们。\n\n我们首先分析每个基序在 $t=0$ 时刻对诱导物 $X$ 从水平 $x_0$ 阶跃增加到 $x_1$ 的响应行为。在 $t0$ 时，系统的初始状态是对应于输入 $x_0$ 的稳态 $(y_0, z_0)$。\n\n**1. 非相干前馈环 (I-FFL) 分析**\n\n其动力学由以下方程给出：\n$$ \\frac{dy}{dt}=\\alpha_y\\,a_X(x)-\\delta_y\\,y $$\n$$ \\frac{dz}{dt}=\\alpha_z\\,a_X(x)\\,r_Y(y)-\\delta_z\\,z $$\n\n在 $t=0$ 时，输入 $x$ 从 $x_0$ 阶跃到 $x_1$。\n- **初始响应 ($t=0^+$):** 抑制子 $Y$ 的浓度尚未改变，因此 $y(0^+) = y_0$。诱导物浓度现在是 $x_1$。$Z$ 的变化率是 $\\frac{dz}{dt}|_{t=0^+} = \\alpha_z a_X(x_1) r_Y(y_0) - \\delta_z z_0$。根据阶跃前的稳态，我们有 $\\delta_z z_0 = \\alpha_z a_X(x_0) r_Y(y_0)$。代入此式可得 $\\frac{dz}{dt}|_{t=0^+} = \\alpha_z r_Y(y_0) [a_X(x_1) - a_X(x_0)]$。由于 $x_1  x_0$ 且 $a_X(\\cdot)$ 是一个增函数，所以 $a_X(x_1)  a_X(x_0)$，这意味着 $\\frac{dz}{dt}|_{t=0^+}  0$。因此，$z(t)$ 立即开始增加。\n\n- **中期和长期响应：** 变量 $Y$ 开始向其新的、更高的稳态 $y_1 = (\\alpha_y/\\delta_y) a_X(x_1)$ 积累，特征时间为 $\\tau_y = 1/\\delta_y$。随着 $y(t)$ 的增加，抑制函数 $r_Y(y(t))$ 减小，从而降低了 $Z$ 的合成速率。问题陈述了时间尺度分离 $\\delta_z  \\delta_y$，意味着 $Z$ 的动力学 ($\\tau_z = 1/\\delta_z$) 比 $Y$ 的动力学 ($\\tau_y = 1/\\delta_y$) 快。这种时间尺度的分离至关重要：$Z$ 对 $X$ 的激活作出快速响应，导致初始上升。随后，缓慢积累的 $Y$ 开始抑制 $Z$，导致 $z(t)$ 下降。这种快速激活和延迟抑制的组合在 $z(t)$ 中产生一个脉冲。输出 $z(t)$ 上升到一个峰值，然后下降到一个新的稳态 $z_1$。\n\n- **稳态行为：** $Z$ 的新稳态是 $z_1 = \\frac{\\alpha_z}{\\delta_z} a_X(x_1) r_Y\\left(\\frac{\\alpha_y}{\\delta_y} a_X(x_1)\\right)$。稳态输出 $z_{ss}(x)$ 是一个关于 $x$ 的增函数（通过 $a_X(x)$）和一个关于 $x$ 的减函数（通过 $r_Y(\\cdot)$ 和 $a_X(x)$）的乘积。这意味着 $z_{ss}(x)$ 不一定是单调的。对于脉冲生成，参数通常被设置为使得新稳态 $z_1$ 接近旧稳态 $z_0$，这种现象被称为近似适应。\n\n- **$Y$ 敲低的效果 ($\\alpha_y \\to s \\alpha_y$ for $s \\in (0,1)$):** $Y$ 的产生减少了。\n    - $Y$ 的新稳态是 $y_1^{(s)} = s (\\alpha_y/\\delta_y) a_X(x_1)$，低于非敲低时的值。\n    - $Z$ 的新稳态是 $z_1^{(s)} = \\frac{\\alpha_z}{\\delta_z} a_X(x_1) r_Y(y_1^{(s)})$。由于 $y_1^{(s)}  y_1$ 且 $r_Y(\\cdot)$ 是递减的，因此 $r_Y(y_1^{(s)})  r_Y(y_1)$。所以，$z_1^{(s)}  z_1$。敲低增加了 $Z$ 的稳态水平。\n    - 从动力学角度看，I-FFL 的抑制臂被削弱了。延迟抑制的效果变差，这阻止了 $z(t)$ 浓度在初始上升后下降。脉冲行为减弱或完全消失，导致 $z(t)$ 持续处于高水平。\n\n**2. 负反馈环 (NFL) 分析**\n\n其动力学由以下方程给出：\n$$ \\frac{dy}{dt}=\\beta_y\\,a_Z(z)-\\delta_y\\,y $$\n$$ \\frac{dz}{dt}=\\alpha_z\\,a_X(x)\\,r_Y(y)-\\delta_z\\,z $$\n\n- **对阶跃输入的响应：** 与 I-FFL 类似，$z(t)$ 最初会上升，因为 $\\frac{dz}{dt}|_{t=0^+}  0$。随着 $z(t)$ 的增加，它会激活 $Y$ 的产生。随后 $Y$ 的积累会抑制 $Z$，形成一个负反馈环 ($Z \\to Y \\dashv Z$)。这种反馈抵消了 $Z$ 的初始上升。\n\n- **稳态行为：** 新的稳态 $(y_1, z_1)$ 由方程 $z_1 = \\frac{\\alpha_z}{\\delta_z} a_X(x_1) r_Y\\left(\\frac{\\beta_y}{\\delta_y} a_Z(z_1)\\right)$ 的解给出。右边是 $z_1$ 的减函数，但是输入 $x_1$ 的增函数。$x_1$ 的增加会使这条曲线向上移动，导致与直线 $g(z)=z$ 在一个更高的 $z_1$ 值处有新的交点。因此，$z_1  z_0$。这种比例负反馈不会产生完美或近似适应，这一点在问题陈述中也已给出。系统会稳定在一个新的、更高的稳态。\n\n- **$Y$ 敲低的效果 ($\\beta_y \\to s \\beta_y$ for $s \\in (0,1)$):** 敲低削弱了负反馈环，因为响应于 $Z$ 时 $Y$ 的产生效率降低了。\n    - 新的稳态 $z_1^{(s)}$ 由 $z_1^{(s)} = \\frac{\\alpha_z}{\\delta_z} a_X(x_1) r_Y\\left(s \\frac{\\beta_y}{\\delta_y} a_Z(z_1^{(s)})\\right)$ 给出。随着 $s$ 的减小，$r_Y$ 的自变量减小，因此 $r_Y$ 增大。这导致 $Z$ 的稳态值更高，即 $z_1^{(s)}  z_1$。\n    - 从动力学角度看，削弱负反馈会减小其对 $Z$ 上升的制动作用。对此类反馈系统的标准分析表明，减小环路增益通常会使系统响应*更快*（即，减少稳定时间或上升时间）。\n\n**区分实验**\n\n本质区别在于，I-FFL 在适当的参数化下表现出带有近似适应的脉冲状响应，而 NFL 不会适应。此外，I-FFL 的这种适应行为关键地依赖于通过 $Y$ 的抑制路径的强度。因此，敲低 $Y$ 应该会消除这种适应。在 NFL 中，敲低也会改变响应（例如，更高的稳态），但它不会引入或消除适应，因为该回路本来就不会适应。这提供了一个清晰的实验特征。\n\n**选项评估**\n\n**A. 在 I-FFL 中，阶跃 $x_0\\to x_1$ 产生 $z(t)$ 的快速瞬时增加，随后由于 $Y$ 的积累并抑制 $Z$， $z(t)$ 会回到接近阶跃前的水平（近似适应）；$Y$ 敲低 ($s1$) 会消除适应现象，并产生一个持续升高的 $z$ 稳态。在 NFL 中，阶跃产生一个新的稳态 $z$ 值，该值高于基线但没有精确适应；$Y$ 敲低会增加这个稳态水平并减慢响应速度。因此，在有和没有 $Y$ 敲低的情况下施加 $X$ 的阶跃：如果只有非敲低条件显示出近似适应，而敲低消除了它，那么该回路是 I-FFL；如果两种情况都不适应，那么该回路是 NFL。**\n\n该选项正确描述了 I-FFL 的脉冲/适应行为及其在 $Y$ 敲低后被消除的现象。它正确地指出 NFL 不会适应，并且其稳态在敲低后会增加。所提出的实验利用了这一关键差异，是区分这两种基序的有效策略。其中有一个不准确之处：声称 $Y$ 敲低会“减慢”NFL 的响应。我的分析表明响应应该变得更快。然而，与其他选项相比，这是一个次要细节上的小错误。关于适应的主要逻辑是正确的。鉴于要求选择*最佳*选项，这个选项是最有力的候选。\n**结论：正确**\n\n**B. I-FFL 和 NFL 在阶跃后都表现出 $z$ 回到基线的完美适应，因为两者都包含一个抑制子；$Y$ 敲低将仅在 NFL 中诱发持续振荡，从而提供一个诊断特征。**\n\n这个陈述有根本性的错误。首先，所呈现的 NFL 模型不表现出完美或近似的适应。其稳态输出随输入增加而增加。其次，I-FFL 通常表现出近似适应，而非完美适应。第三，削弱负反馈环（通过敲低）会使其*更不容易*发生振荡，而不是更容易。持续振荡需要强反馈和足够的延迟，而敲低会使系统朝相反的方向发展。\n**结论：错误**\n\n**C. 在 I-FFL 中，对于任何希尔函数，稳态 $z$ 都随 $x$ 单调增加，因此不可能发生适应；在 NFL 中，负反馈确保了在稳定性的前提下精确适应到阶跃前的水平；$Y$ 敲低会降低两种基序中 $z$ 的峰值振幅，从而可以通过峰值大小进行区分。**\n\n这个选项包含多个错误。I-FFL 的稳态响应 $z_{ss}(x)$ 通常是非单调的，这正是它可以表现出适应行为的原因，即 $z_{ss}(x_1) \\approx z_{ss}(x_0)$。声称 NFL 能确保精确适应也是错误的；这需要积分控制，而本模型中不存在。最后，$Y$ 的敲低削弱了抑制/负反馈，这应导致*更高*的输出水平，而不是降低峰值振幅。\n**结论：错误**\n\n**D. I-FFL 和 NFL 无法通过 $z(t)$ 的阶跃响应来区分，因为两者都可以根据参数产生脉冲或单调响应；只有频率响应测量才能将它们分开；如果 $x_1  x_0$，$Y$ 敲低不影响 I-FFL 的稳态 $z$ 值。**\n\n这个陈述是错误的。虽然参数调整可以改变响应，但适应能力的根本差异为使用阶跃响应进行区分提供了明确的基础，特别是当结合 A 中提出的敲低实验时。声称频率响应是*唯一*的方法是夸大其词。最严重的是，声称 $Y$ 敲低不影响 I-FFL 的稳态是明显错误的；削弱抑制子路径必然会增加稳态输出 $Z$。\n**结论：错误**\n\n总之，选项 A 提供了对电路行为最准确的描述，并为其区分提出了一个逻辑上合理的实验设计，尽管在 NFL 响应速度方面存在一个微小的不准确之处。在给定的选项中，它无疑是最佳选择。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}