{
    "hands_on_practices": [
        {
            "introduction": "非相干前馈环（I1-FFL）的一个标志性功能是响应持续输入信号时产生短暂的输出脉冲。这个练习提供了一个绝佳的动手机会，通过一个简化的确定性模型，你将亲手推导出这个脉冲的峰值表达式。通过这个过程，你将深刻理解生产/降解速率和抑制阈值等关键参数是如何共同塑造系统的瞬态动力学响应的。",
            "id": "3908941",
            "problem": "考虑一个非相干前馈环，其中上游转录因子 $X$ 转录激活中间调节子 $Y$ 和输出基因 $Z$，而 $Y$ 则阻遏 $Z$。假设一个具有希尔型调控动力学和线性降解的确定性常微分方程 (ODE) 模型，这与合成生物学建模中的标准实践一致。\n\n在时间 $t=0$ 时，$X$ 经历一个从 $0$ 到 $x_{0}$ 的阶跃增加，$x_{0}$ 相对于其激活解离常数 $K_{x}$ 足够大，以至于激活希尔函数 $H_{\\mathrm{act}}(X)$ 达到饱和，即对于所有 $t \\ge 0$，$H_{\\mathrm{act}}(x(t)) \\approx 1$。$Y$ 和 $Z$ 的动力学模型为\n$$\n\\frac{dy}{dt} = \\alpha_{y} H_{\\mathrm{act}}(x(t)) - \\beta_{y} y, \\quad y(0)=0,\n$$\n$$\n\\frac{dz}{dt} = \\alpha_{z} H_{\\mathrm{act}}(x(t)) \\, H_{\\mathrm{rep}}(y(t)) - \\beta_{z} z, \\quad z(0)=0,\n$$\n其中 $H_{\\mathrm{act}}(x) = \\frac{x^{n_{a}}}{K_{x}^{n_{a}} + x^{n_{a}}}$ 且 $H_{\\mathrm{rep}}(y) = \\frac{1}{1 + \\left(\\frac{y}{K}\\right)^{n}}$。假设 $n_{a}$ 足够大，使得对于 $t \\ge 0$，$H_{\\mathrm{act}}(x(t)) \\approx 1$。并假设一个高度协同的阻遏蛋白 $Y$，其希尔系数 $n \\to \\infty$，因此 $H_{\\mathrm{rep}}(y)$ 趋近于一个理想开关：如果 $y  K$，则 $H_{\\mathrm{rep}}(y) = 1$；如果 $y > K$，则 $H_{\\mathrm{rep}}(y) = 0$。假设 $\\alpha_{y} > \\beta_{y} K$，以使阈值 $K$ 在有限时间内被跨越。\n\n从以上定义和常微分方程出发，并仅使用极限 $n \\to \\infty$ 将 $H_{\\mathrm{rep}}(y)$ 近似为关于 $y$ 的亥维赛德开关，推导 $z(t)$ 的瞬时峰值（即 $z(t)$ 在 $t \\ge 0$ 上的最大值）作为生化参数 $\\alpha_{y}$、$\\beta_{y}$、$\\alpha_{z}$、$\\beta_{z}$ 和 $K$ 的函数的显式闭式解析表达式。\n\n以 $\\alpha_{y}$、$\\beta_{y}$、$\\alpha_{z}$、$\\beta_{z}$ 和 $K$ 的单个闭式表达式形式提供最终答案。最终表达式中不要包含单位。不需要进行数值计算或四舍五入。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据、良定且客观。它提出了一个合成生物学建模中的标准问题，该问题是自洽的，并允许一个唯一且有意义的解。\n\n问题描述了一个非相干前馈环 (IFFL)，其中转录因子 $X$ 同时激活阻遏蛋白 $Y$ 和输出基因 $Z$，而 $Y$ 反过来阻遏 $Z$。我们的任务是求出蛋白 $Z$ 的峰值浓度。\n\n系统的动力学由一组常微分方程 (ODE) 给出。根据问题的假设，我们可以简化这些方程。假设输入 $X$ 是一个大的阶跃信号，这意味着激活希尔函数 $H_{\\mathrm{act}}(x(t))$ 在所有时间 $t \\ge 0$ 上都可以近似为 $1$。假设阻遏蛋白 $Y$ 是高度协同的 ($n \\to \\infty$)，这意味着阻遏希尔函数 $H_{\\mathrm{rep}}(y(t))$ 作为一个理想开关，当 $y  K$ 时等于 $1$，当 $y > K$ 时等于 $0$。\n\n经过这些简化，常微分方程组变为：\n$$\n\\frac{dy}{dt} = \\alpha_{y} - \\beta_{y} y, \\quad y(0)=0\n$$\n$$\n\\frac{dz}{dt} = \\alpha_{z} H_{\\mathrm{rep}}(y(t)) - \\beta_{z} z, \\quad z(0)=0\n$$\n其中 $H_{\\mathrm{rep}}(y(t))$ 是一个阶跃函数：\n$$\nH_{\\mathrm{rep}}(y(t)) = \\begin{cases} 1  \\text{if } y(t)  K \\\\ 0  \\text{if } y(t) > K \\end{cases}\n$$\n\n首先，我们求解 $y(t)$ 的线性一阶常微分方程：\n方程 $\\frac{dy}{dt} + \\beta_{y} y = \\alpha_{y}$ 在初始条件 $y(0)=0$ 下的解为：\n$$\ny(t) = \\frac{\\alpha_{y}}{\\beta_{y}} (1 - \\exp(-\\beta_{y} t))\n$$\n这个解表明 $y(t)$ 从 $0$ 单调增加，趋向于稳态值 $y_{ss} = \\frac{\\alpha_{y}}{\\beta_{y}}$。问题陈述中指出 $\\alpha_{y} > \\beta_{y} K$，这意味着 $y_{ss} > K$。因此，$Y$ 的浓度将在某个有限时间跨越阈值 $K$，我们将其记为 $t^*$。\n\n我们通过令 $y(t^*) = K$ 来求 $t^*$：\n$$\nK = \\frac{\\alpha_{y}}{\\beta_{y}} (1 - \\exp(-\\beta_{y} t^*))\n$$\n重新整理各项以求解 $t^*$：\n$$\n\\frac{\\beta_{y} K}{\\alpha_{y}} = 1 - \\exp(-\\beta_{y} t^*)\n$$\n$$\n\\exp(-\\beta_{y} t^*) = 1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\n$$\n对两边取自然对数：\n$$\n-\\beta_{y} t^* = \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)\n$$\n$$\nt^* = -\\frac{1}{\\beta_{y}} \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right) = \\frac{1}{\\beta_{y}} \\ln\\left(\\frac{\\alpha_{y}}{\\alpha_{y} - \\beta_{y} K}\\right)\n$$\n\n现在我们分析 $z(t)$ 的动力学。$z(t)$ 的行为在 $t=t^*$ 时发生变化。\n对于 $0 \\le t  t^*$，我们有 $y(t)  K$，所以 $H_{\\mathrm{rep}}(y(t)) = 1$。$z(t)$ 的常微分方程为：\n$$\n\\frac{dz}{dt} = \\alpha_{z} - \\beta_{z} z, \\quad z(0)=0\n$$\n该常微分方程的解是：\n$$\nz(t) = \\frac{\\alpha_{z}}{\\beta_{z}} (1 - \\exp(-\\beta_{z} t))\n$$\n在这个时间间隔内，导数 $\\frac{dz}{dt} = \\alpha_{z} - \\beta_{z} z(t) = \\alpha_{z} \\exp(-\\beta_{z} t)$ 恒为正，所以 $z(t)$ 是严格单调递增的。\n\n对于 $t > t^*$，我们有 $y(t) > K$，所以 $H_{\\mathrm{rep}}(y(t)) = 0$。$z(t)$ 的常微分方程变为：\n$$\n\\frac{dz}{dt} = - \\beta_{z} z\n$$\n解为 $z(t) = z(t^*) \\exp(-\\beta_{z} (t-t^*))$。由于 $z(t^*) > 0$，对于所有 $t > t^*$，导数 $\\frac{dz}{dt}$ 为负，意味着 $z(t)$ 在此区间内是严格单调递减的。\n\n由于 $z(t)$ 在 $t  t^*$ 时递增，在 $t > t^*$ 时递减，因此 $z(t)$ 的最大值（我们记为 $z_{peak}$）恰好在 $t = t^*$ 时出现。为了求得 $z_{peak}$，我们在 $t=t^*$ 处计算第一阶段中 $z(t)$ 的解：\n$$\nz_{peak} = z(t^*) = \\frac{\\alpha_{z}}{\\beta_{z}} (1 - \\exp(-\\beta_{z} t^*))\n$$\n现在我们将 $t^*$ 的表达式代入此方程。从 $t^*$ 的推导中，我们有 $\\exp(-\\beta_{y} t^*) = 1 - \\frac{\\beta_{y} K}{\\alpha_{y}}$。我们需要求出 $\\exp(-\\beta_{z} t^*)$：\n$$\n\\exp(-\\beta_{z} t^*) = \\exp\\left(-\\beta_{z} \\left(-\\frac{1}{\\beta_{y}} \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)\\right)\\right)\n$$\n$$\n\\exp(-\\beta_{z} t^*) = \\exp\\left(\\frac{\\beta_{z}}{\\beta_{y}} \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)\\right)\n$$\n使用恒等式 $\\exp(c \\ln a) = a^c$：\n$$\n\\exp(-\\beta_{z} t^*) = \\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)^{\\frac{\\beta_{z}}{\\beta_{y}}}\n$$\n将此结果代入 $z_{peak}$ 的表达式中：\n$$\nz_{peak} = \\frac{\\alpha_{z}}{\\beta_{z}} \\left[ 1 - \\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)^{\\frac{\\beta_{z}}{\\beta_{y}}} \\right]\n$$\n这就是 $z(t)$ 的瞬时峰值作为给定生化参数的函数的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\alpha_{z}}{\\beta_{z}} \\left( 1 - \\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)^{\\frac{\\beta_{z}}{\\beta_{y}}} \\right)}\n$$"
        },
        {
            "introduction": "除了瞬态动力学，前馈环在塑造系统稳态行为方面也扮演着关键角色，特别是输入-输出的剂量响应曲线。这个计算练习将引导你探索I1-FFL如何充当“带通滤波器”，仅对中等强度的输入信号产生响应，这与C1-FFL的单调响应形成鲜明对比。通过编程实践，你将学会如何分析剂量响应曲线的形状，并初步接触到参数变化如何引起系统行为发生质变（即分岔）的概念。",
            "id": "3908933",
            "problem": "考虑合成生物学中的两种基因调控基序：1型相干前馈环（C1-FFL）和1型非相干前馈环（I1-FFL）。在这两种基序中，一个外部输入 $S$（无量纲的诱导物浓度）调控一个中间转录因子 $Y$，而 $S$ 和 $Y$ 共同调控输出基因产物 $Z$。请在以下科学标准假设下，使用带有Hill型调控的常微分方程对这些基序进行建模：（i）生成和降解与浓度呈线性关系，（ii）激活遵循Hill函数，（iii）抑制遵循标准的递减形式Hill函数。所有量均为无量纲。\n\n定义：\n- 激活Hill函数：$H_{\\mathrm{act}}(x;K,n) = \\dfrac{x^n}{K^n + x^n}$。\n- 抑制Hill函数：$H_{\\mathrm{rep}}(y;K,n) = \\dfrac{K^n}{K^n + y^n}$。\n- $Y$的动力学：$\\dfrac{dY}{dt} = k_y \\, H_{\\mathrm{act}}(S;K_y,n_y) - \\gamma_y Y$。\n- C1-FFL中$Z$的动力学：$\\dfracdZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{act}}(Y;K_{zY},n_{zY}) - \\gamma_z Z$。\n- I1-FFL中$Z$的动力学：$\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{rep}}(Y;K_{zY},n_{zY}) - \\gamma_z Z$。\n\n在稳态下，$Y^\\ast(S) = \\dfrac{k_y}{\\gamma_y} \\, H_{\\mathrm{act}}(S;K_y,n_y)$ 且 $Z^\\ast(S)$ 等于 $\\dfrac{k_z}{\\gamma_z}$ 乘以该基序上方定义的相应Hill项的乘积。该基序的剂量响应是指当 $S$ 在指定范围内变化时函数 $Z^\\ast(S)$ 的表现。当一个参数变化时（例如，先前单调的曲线出现内部最大值），$Z^\\ast(S)$ 形状的结构性变化是本问题中分岔分析的重点。\n\n你的任务是编写一个完整的程序，该程序：\n1. 使用上述定义，为两种基序实现稳态剂量响应 $Z^\\ast(S)$。\n2. 通过分析在对数间隔的 $S$ 值网格上计算出的 $Z^\\ast(S)$，检测对于给定参数，$Z^\\ast(S)$ 是否具有内部极值（特别是在严格位于范围内的某个 $S$ 处的局部最大值）。\n3. 对I1-FFL的抑制阈值 $K_{zY}$ 进行参数扫描，以估计剂量响应 $Z^\\ast(S)$ 获得内部最大值（被解释为带通滤波器形状的起始点）时的最小 $K_{zY}$，这构成了所要求的关于 $K_{zY}$ 的分岔起点。\n\n除非在特定测试中有所变化，否则请一致使用以下参数值：\n- $k_y/\\gamma_y = 1.0$，\n- $k_z/\\gamma_z = 1.0$，\n- $K_y = 1.0$, $n_y = 2$，\n- $K_{zS} = 1.0$, $n_{zS} = 2$，\n- 对于 $K_{zY}$ 和 $n_{zY}$，其值在下面的每个测试中指定。\n\n使用一个在 $S \\in [10^{-3}, 10^{3}]$ 范围内具有 $N = 1000$ 个点的对数间隔网格。所有量均为无量纲。内部最大值的存在应仅从离散的 $Z^\\ast(S)$ 序列中检测，方法是识别至少一个索引 $i$（$1 \\le i \\le N-2$），使得 $Z^\\ast(S_i) > Z^\\ast(S_{i-1})$ 且 $Z^\\ast(S_i) \\ge Z^\\ast(S_{i+1})$。\n\n测试套件：\n- 测试1（I1-FFL分岔起点）：在集合 $\\{0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0\\}$ 上扫描 $K_{zY}$，其中 $n_{zY} = 4$。对于每个 $K_{zY}$，评估是否存在内部最大值。返回检测到最大值时的最小 $K_{zY}$。如果集合中没有任何 $K_{zY}$ 检测到最大值，则返回 $-1.0$。\n- 测试2（C1-FFL单调性检查）：在 $K_{zY} = 1.0$ 和 $n_{zY} = 2$ 的情况下，评估C1-FFL剂量响应是否具有内部最大值。返回一个布尔值，表示该最大值的存在（$\\mathrm{True}$）或不存在（$\\mathrm{False}$）。\n- 测试3（I1-FFL固定参数形状）：在 $K_{zY} = 0.2$ 和 $n_{zY} = 4$ 的情况下，评估I1-FFL剂量响应是否具有内部最大值。返回一个布尔值。\n- 测试4（I1-FFL峰值位置）：在 $K_{zY} = 0.05$ 和 $n_{zY} = 4$ 的情况下，计算在指定网格上 $Z^\\ast(S)$ 达到其最大值时的 $S$ 值。将此 $S$ 值作为浮点数返回。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含按顺序排列的测试1到测试4的结果，形式为方括号括起来的逗号分隔列表（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$）。每个结果必须是以下基本类型之一：布尔值或浮点数。不应打印任何其他文本。",
            "solution": "我们从标准的基因调控建模假设开始，其中调控子通过Hill型激活或抑制来调节基因表达，而降解与浓度呈线性关系。Hill函数捕捉了协同结合和饱和效应，这在转录调控的生物物理模型中是公认的。\n\n激活Hill函数是 $H_{\\mathrm{act}}(x;K,n) = \\dfrac{x^n}{K^n + x^n}$，它关于 $x$ 是单调递增的，界于0和1之间，并有一个有效阈值 $K$。抑制Hill函数是 $H_{\\mathrm{rep}}(y;K,n) = \\dfrac{K^n}{K^n + y^n}$，它关于 $y$ 是单调递减的，同样界于0和1之间，并有一个有效阈值 $K$。\n\n设 $S$ 为输入。中间产物 $Y$ 遵循 $\\dfrac{dY}{dt} = k_y H_{\\mathrm{act}}(S;K_y,n_y) - \\gamma_y Y$，这会产生一个唯一的稳态 $Y^\\ast(S) = \\dfrac{k_y}{\\gamma_y} H_{\\mathrm{act}}(S;K_y,n_y)$，因为方程右侧对于 $Y$ 是线性的，且带有一个非负、有界的源项。\n\n对于输出 $Z$，1型相干前馈环（C1-FFL）使用两个激活项的乘积，一个用于 $S$，另一个用于 $Y$：\n$$\n\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{act}}(Y;K_{zY},n_{zY}) - \\gamma_z Z.\n$$\n在稳态下，因为 $Z$ 的动力学是线性的，且源项为非负，我们有\n$$\nZ^\\ast_{\\mathrm{coh}}(S) = \\dfrac{k_z}{\\gamma_z} \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{act}}(Y^\\ast(S);K_{zY},n_{zY}).\n$$\n由于 $H_{\\mathrm{act}}(S;\\cdot)$ 和 $H_{\\mathrm{act}}(Y^\\ast(S);\\cdot)$ 都是关于 $S$ 的单调递增函数，且增函数的乘积也是增函数，所以 $Z^\\ast_{\\mathrm{coh}}(S)$ 关于 $S$ 是单调递增的，没有内部最大值。在数值上，这意味着在一个离散网格中，除非在平台区出现数值伪影，否则没有内部索引 $i$ 应满足 $Z_i > Z_{i-1}$ 且 $Z_i \\ge Z_{i+1}$。\n\n对于1型非相干前馈环（I1-FFL），源项是一个激活项和一个抑制项的乘积：\n$$\n\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{rep}}(Y;K_{zY},n_{zY}) - \\gamma_z Z.\n$$\n稳态输出为\n$$\nZ^\\ast_{\\mathrm{incoh}}(S) = \\dfrac{k_z}{\\gamma_z} \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{rep}}(Y^\\ast(S);K_{zY},n_{zY}).\n$$\n在这里，$H_{\\mathrm{act}}(S;\\cdot)$ 随 $S$ 增加而增加，但 $H_{\\mathrm{rep}}(Y^\\ast(S);\\cdot)$ 随 $S$ 增加而减少，因为 $Y^\\ast(S)$ 本身随 $S$ 增加而增加。一个增函数和一个减函数的乘积可以是非单调的，当抑制分支足够强且具有协同性时，通常会产生一个具有内部最大值的带通剂量响应。\n\n在这种背景下，分岔分析被定义为当抑制阈值 $K_{zY}$ 变化时，稳态剂量响应曲线发生的结构性变化。对于大的 $K_{zY}$，在 $Y^\\ast(S)$ 的范围内抑制作用很弱，因此 $Z^\\ast_{\\mathrm{incoh}}(S)$ 趋向于单调递增（没有内部最大值）。随着 $K_{zY}$ 减小，抑制作用在 $S$ 范围内变得有效，其乘积可能会出现一个内部最大值。我们通过扫描一组离散的 $K_{zY}$ 值，并检查离散的剂量响应序列 $Z^\\ast(S_i)$ 是否具有内部最大值，来将这种结构性变化的检测操作化，即是否存在一个索引 $i$（$1 \\le i \\le N-2$）使得 $Z_i > Z_{i-1}$ 且 $Z_i \\ge Z_{i+1}$。\n\n程序中实现的算法步骤：\n1. 构建 $S$ 网格：在 $[10^{-3},10^{3}]$ 范围内以对数间隔取 $N = 1000$ 个点。\n2. 对于给定的参数，通过 $Y^\\ast(S) = \\dfrac{k_y}{\\gamma_y} H_{\\mathrm{act}}(S;K_y,n_y)$ 计算 $Y^\\ast(S)$。\n3. 通过乘以相应的Hill项并按 $\\dfrac{k_z}{\\gamma_z}$ 缩放，为目标基序计算 $Z^\\ast(S)$。\n4. 通过扫描离散序列 $Z^\\ast(S)$ 并检查内部索引是否满足局部最大值条件来检测内部最大值。\n5. 对于分岔起点（测试1），在指定集合上迭代 $K_{zY}$，并返回产生内部最大值的最小 $K_{zY}$；如果没有，则返回 $-1.0$。\n6. 对于测试2，对C1-FFL应用相同的检测；它应返回 $\\mathrm{False}$。\n7. 对于测试3，将检测应用于一个固定的I1-FFL参数集，并返回布尔值。\n8. 对于测试4，通过找到网格上最大 $Z^\\ast(S)$ 的索引，来定位 $Z^\\ast(S)$ 达到最大值时的 $S$ 值；返回该 $S$ 值。\n\n这些步骤与前馈环的定义和逻辑直接相关。相干基序的剂量响应由于增函数的复合而是单调的，而非相干基序则可以在抑制变得有效和协同的情况下从单调过渡到带通。对 $K_{zY}$ 进行参数扫描是一种有原则的方法，用以观察稳态输入-输出曲线的定性变化起点，这可作为剂量响应形状的类分岔指标。通过将四个结果收集到一个单行打印的、用方括号括起来的逗号分隔列表中，满足了输出格式要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Hill activation function\ndef hill_act(x, K, n):\n    # Avoid division by zero for K=0 by enforcing positive K in tests\n    x = np.asarray(x)\n    return (x**n) / (K**n + x**n)\n\n# Hill repression function\ndef hill_rep(y, K, n):\n    y = np.asarray(y)\n    return (K**n) / (K**n + y**n)\n\ndef steady_state_Y(S, ky_over_gamma, Ky, ny):\n    return ky_over_gamma * hill_act(S, Ky, ny)\n\ndef steady_state_Z_coh(S, Ystar, kz_over_gamma, KzS, nzS, KzY, nzY):\n    return kz_over_gamma * hill_act(S, KzS, nzS) * hill_act(Ystar, KzY, nzY)\n\ndef steady_state_Z_incoh(S, Ystar, kz_over_gamma, KzS, nzS, KzY, nzY):\n    return kz_over_gamma * hill_act(S, KzS, nzS) * hill_rep(Ystar, KzY, nzY)\n\ndef has_internal_maximum(Z):\n    # Detect internal maximum: exists i (1..N-2) such that Z[i]  Z[i-1] and Z[i] = Z[i+1]\n    # To reduce sensitivity to tiny numerical noise, add a small epsilon tolerance\n    eps = 1e-12\n    for i in range(1, len(Z) - 1):\n        if Z[i]  Z[i - 1] + eps and Z[i] = Z[i + 1] - eps:\n            return True\n    return False\n\ndef find_S_of_max(Z, S):\n    idx = int(np.argmax(Z))\n    return float(S[idx])\n\ndef test_bifurcation_onset_I1FFL(S_grid, ky_over_gamma, kz_over_gamma, Ky, ny, KzS, nzS, nzY, KzY_values):\n    # Return the smallest KzY in KzY_values that yields an internal maximum; else -1.0\n    Ystar = steady_state_Y(S_grid, ky_over_gamma, Ky, ny)\n    for KzY in KzY_values:\n        Z = steady_state_Z_incoh(S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY, nzY)\n        if has_internal_maximum(Z):\n            return float(KzY)\n    return -1.0\n\ndef solve():\n    # Common parameters\n    ky_over_gamma = 1.0\n    kz_over_gamma = 1.0\n    Ky = 1.0\n    ny = 2\n    KzS = 1.0\n    nzS = 2\n\n    # S grid\n    S_grid = np.logspace(-3, 3, 1000)\n\n    results = []\n\n    # Test 1: I1-FFL bifurcation onset over KzY sweep\n    KzY_values = [0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0]\n    nzY_bif = 4\n    onset_KzY = test_bifurcation_onset_I1FFL(\n        S_grid, ky_over_gamma, kz_over_gamma, Ky, ny, KzS, nzS, nzY_bif, KzY_values\n    )\n    results.append(onset_KzY)\n\n    # Precompute Y* for remaining tests\n    Ystar = steady_state_Y(S_grid, ky_over_gamma, Ky, ny)\n\n    # Test 2: C1-FFL monotonicity check\n    KzY_coh = 1.0\n    nzY_coh = 2\n    Z_coh = steady_state_Z_coh(S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY_coh, nzY_coh)\n    results.append(has_internal_maximum(Z_coh))\n\n    # Test 3: I1-FFL fixed-parameter shape (has internal maximum?)\n    KzY_incoh_fixed = 0.2\n    nzY_incoh_fixed = 4\n    Z_incoh_fixed = steady_state_Z_incoh(\n        S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY_incoh_fixed, nzY_incoh_fixed\n    )\n    results.append(has_internal_maximum(Z_incoh_fixed))\n\n    # Test 4: I1-FFL peak location at strong repression\n    KzY_peak = 0.05\n    nzY_peak = 4\n    Z_incoh_peak = steady_state_Z_incoh(\n        S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY_peak, nzY_peak\n    )\n    S_at_peak = find_S_of_max(Z_incoh_peak, S_grid)\n    results.append(S_at_peak)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在系统生物学中，区分具有相似输出表型的不同网络拓扑是一个常见的挑战。这个练习将促使你像实验科学家一样思考：如何区分一个I1-FFL和一个负反馈环（NFL）？。此问题聚焦于分析它们各自独特的动力学特征（如适应性），并探讨如何利用基因敲低（knockdown）等靶向扰动实验来揭示潜在的网络结构。",
            "id": "2722223",
            "problem": "考虑两个由外部诱导剂 $X$ 驱动的三节点基因调控基序。在时间 $t=0$ 时，诱导剂 $X$ 的水平从基准水平 $x_0$ 阶跃到一个更高的恒定水平 $x_1$。第一个基序是非相干前馈环 (incoherent feed-forward loop, I-FFL)：$X$ 转录激活中间抑制子 $Y$ 和输出 $Z$，而 $Y$ 抑制 $Z$。第二个基序是负反馈环 (negative feedback loop, NFL)：$X$ 转录激活 $Z$，$Z$ 转录激活 $Y$，$Y$ 抑制 $Z$。假设采用标准基因表达动力学：合成由希尔型调控控制，降解（加上稀释）为一阶反应。其动力学模型为\n对于 I-FFL：\n$$\n\\frac{dy}{dt}=\\alpha_y\\,a_X(x)-\\delta_y\\,y,\\qquad \\frac{dz}{dt}=\\alpha_z\\,a_X(x)\\,r_Y(y)-\\delta_z\\,z,\n$$\n对于 NFL：\n$$\n\\frac{dy}{dt}=\\beta_y\\,a_Z(z)-\\delta_y\\,y,\\qquad \\frac{dz}{dt}=\\alpha_z\\,a_X(x)\\,r_Y(y)-\\delta_z\\,z.\n$$\n此处，$a_X(\\cdot)$ 和 $a_Z(\\cdot)$ 是单调递增的希尔激活函数，满足 $0\\le a_\\bullet(\\cdot)\\le 1$；$r_Y(\\cdot)$ 是单调递减的希尔抑制函数，满足 $0 r_Y(\\cdot)\\le 1$。参数 $\\alpha_y,\\beta_y,\\alpha_z,\\delta_y,\\delta_z>0$。阶跃输入为：当 $t0$ 时，$x(t)=x_0$；当 $t\\ge 0$ 时，$x(t)=x_1$，其中 $x_1>x_0\\ge 0$。假设存在基因回路中常见的时间尺度分离：$Z$ 的响应比 $Y$ 快，即 $\\delta_z>\\delta_y$，且相对于 $Y$ 的积累，$Z$ 的有效合成对 $X$ 的响应无延迟。\n\n题目告知，短时行为和稳态行为必须根据以上方程和以下基本事实进行推理：(i) 在 $t=0^+$ 时，依赖于 $Y$ 的变量最初感受到的是接近阶跃前水平的 $Y$ 值，因为 $Y$ 尚未积累；(ii) 在恒定输入下的稳态解满足 $\\frac{dy}{dt}=\\frac{dz}{dt}=0$；(iii) 在负反馈中，若无积分控制，稳态输出通常随输入增加而增加；(iv) 在 I-FFL 中，直接激活路径和延迟抑制路径在长时间后会相互抵消。\n\n现在考虑一个扰动实验，通过一个乘法因子 $s \\in (0,1)$ 来减少 $Y$ 的产生，以模拟部分敲低（例如，通过RNA干扰(RNAi)或CRISPR干扰(CRISPRi)）。在 I-FFL 中，此操作实现为 $\\alpha_y\\mapsto s\\,\\alpha_y$；在 NFL 中，实现为 $\\beta_y\\mapsto s\\,\\beta_y$，同时保持所有其他参数不变。\n\n哪个选项最佳地比较了 I-FFL 和 NFL 对 $X$ 阶跃输入的动态特征，并提出了一个利用 $Y$ 敲低来仅通过测量 $Z(t)$ 就能区分这两种基序的实验？\n\nA. 在 I-FFL 中，阶跃 $x_0\\to x_1$ 会使 $z(t)$ 产生一个快速的瞬时增加，随后由于 $Y$ 的积累并抑制 $Z$，$z(t)$ 会回到接近阶跃前的水平（近似适应）；$Y$ 敲低 ($s1$) 会消除这种适应性，并产生一个持续升高的 $z$ 稳态。在 NFL 中，阶跃会产生一个新的、高于基线的 $z$ 稳态，但没有精确适应；$Y$ 敲低会提高这个稳态水平并减慢响应速度。因此，在有和没有 $Y$ 敲低的情况下分别施加 $X$ 的阶跃输入：如果只有非敲低条件显示出近似适应，而敲低消除了这种适应，那么该回路是 I-FFL；如果两种条件都不适应，那么该回路是 NFL。\n\nB. I-FFL 和 NFL 在阶跃后都表现出 $z$ 回到基线的完全适应，因为两者都含有抑制子；$Y$ 敲低只会在 NFL 中诱发持续振荡，从而提供一个诊断性特征。\n\nC. 在 I-FFL 中，对于任何希尔函数，稳态 $z$ 都随 $x$ 单调增加，因此不可能发生适应；在 NFL 中，负反馈在稳定的前提下确保了精确适应到阶跃前水平；$Y$ 敲低会降低两种基序中 $z$ 的峰值，从而可以通过峰值大小来区分它们。\n\nD. I-FFL 和 NFL 无法通过 $z(t)$ 的阶跃响应来区分，因为根据参数的不同，两者都可以产生脉冲或单调响应；只有频率响应测量才能将它们分开；如果 $x_1 > x_0$，$Y$ 敲低不会影响 I-FFL 的 $z$ 稳态。",
            "solution": "问题陈述经检验在科学上是合理的、提法是适定的且内容是自洽的。可以开始分析。\n\n任务是比较非相 coherent前馈环 (I-FFL) 和负反馈环 (NFL) 的动态特征，并设计一个基于中间组分 $Y$ 敲低的实验，通过观察输出 $Z(t)$ 来区分它们。\n\n让我们首先分析每个基序在时间 $t=0$ 时对诱导剂 $X$ 从水平 $x_0$ 阶跃增加到 $x_1$ 的响应行为。在 $t0$ 时，系统的初始状态是对应于输入 $x_0$ 的稳态 $(y_0, z_0)$。\n\n**1. 非相干前馈环 (I-FFL) 分析**\n\n动力学方程为：\n$$ \\frac{dy}{dt}=\\alpha_y\\,a_X(x)-\\delta_y\\,y $$\n$$ \\frac{dz}{dt}=\\alpha_z\\,a_X(x)\\,r_Y(y)-\\delta_z\\,z $$\n\n在 $t=0$ 时，输入 $x$ 从 $x_0$ 阶跃到 $x_1$。\n- **初始响应 ($t=0^+$):** 抑制子 $Y$ 的浓度尚未改变，因此 $y(0^+) = y_0$。诱导剂浓度现在是 $x_1$。$Z$ 的变化率是 $\\frac{dz}{dt}|_{t=0^+} = \\alpha_z a_X(x_1) r_Y(y_0) - \\delta_z z_0$。根据阶跃前的稳态，我们有 $\\delta_z z_0 = \\alpha_z a_X(x_0) r_Y(y_0)$。将此代入可得 $\\frac{dz}{dt}|_{t=0^+} = \\alpha_z r_Y(y_0) [a_X(x_1) - a_X(x_0)]$。由于 $x_1 > x_0$ 且 $a_X(\\cdot)$ 是一个增函数，所以 $a_X(x_1) > a_X(x_0)$，这意味着 $\\frac{dz}{dt}|_{t=0^+} > 0$。因此，$z(t)$ 立即开始增加。\n\n- **中期和长期响应:** 变量 $Y$ 开始向其新的、更高的稳态 $y_1 = (\\alpha_y/\\delta_y) a_X(x_1)$ 积累，其特征时间为 $\\tau_y = 1/\\delta_y$。随着 $y(t)$ 的增加，抑制函数 $r_Y(y(t))$ 减小，从而降低了 $Z$ 的合成速率。问题陈述了时间尺度分离 $\\delta_z > \\delta_y$，意味着 $Z$ 的动力学（$\\tau_z = 1/\\delta_z$）比 $Y$ 的动力学（$\\tau_y = 1/\\delta_y$）快。这种时间尺度的分离至关重要：$Z$ 对 $X$ 的激活快速响应，导致初始上升。随后，缓慢积累的 $Y$ 开始抑制 $Z$，导致 $z(t)$ 下降。这种快速激活和延迟抑制的组合在 $z(t)$ 中产生一个脉冲。输出 $z(t)$ 上升到一个峰值，然后下降到一个新的稳态 $z_1$。\n\n- **稳态行为:** $Z$ 的新稳态是 $z_1 = \\frac{\\alpha_z}{\\delta_z} a_X(x_1) r_Y\\left(\\frac{\\alpha_y}{\\delta_y} a_X(x_1)\\right)$。稳态输出 $z_{ss}(x)$ 是一个关于 $x$ 的增函数（通过 $a_X(x)$）和一个关于 $x$ 的减函数（通过 $r_Y(\\cdot)$ 和 $a_X(x)$）的乘积。这意味着 $z_{ss}(x)$ 不一定是单调的。对于脉冲产生，参数通常被设置为使得新稳态 $z_1$ 接近旧稳态 $z_0$，这种现象被称为近似适应。\n\n- **$Y$ 敲低的效果 ($\\alpha_y \\to s \\alpha_y$ for $s \\in (0,1)$):** $Y$ 的产生减少了。\n    - $Y$ 的新稳态是 $y_1^{(s)} = s (\\alpha_y/\\delta_y) a_X(x_1)$，该值低于非敲低情况下的值。\n    - $Z$ 的新稳态是 $z_1^{(s)} = \\frac{\\alpha_z}{\\delta_z} a_X(x_1) r_Y(y_1^{(s)})$。由于 $y_1^{(s)}  y_1$ 且 $r_Y(\\cdot)$ 是递减的，所以 $r_Y(y_1^{(s)}) > r_Y(y_1)$。因此，$z_1^{(s)} > z_1$。敲低提高了 $Z$ 的稳态水平。\n    - 从动力学角度看，I-FFL 的抑制臂被削弱。延迟抑制的效果变差，这阻止了 $z(t)$ 浓度在初始上升后下降。脉冲行为被减弱或完全消除，导致 $z(t)$ 维持在一个持续的高水平。\n\n**2. 负反馈环 (NFL) 分析**\n\n动力学方程为：\n$$ \\frac{dy}{dt}=\\beta_y\\,a_Z(z)-\\delta_y\\,y $$\n$$ \\frac{dz}{dt}=\\alpha_z\\,a_X(x)\\,r_Y(y)-\\delta_z\\,z $$\n\n- **对阶跃输入的响应:** 与 I-FFL 类似，$z(t)$ 最初会上升，因为 $\\frac{dz}{dt}|_{t=0^+} > 0$。随着 $z(t)$ 的增加，它会激活 $Y$ 的产生。随后 $Y$ 的积累会抑制 $Z$，形成一个负反馈环 ($Z \\to Y \\dashv Z$)。这种反馈抵消了 $Z$ 的初始上升。\n\n- **稳态行为:** 新的稳态 $(y_1, z_1)$ 由方程 $z_1 = \\frac{\\alpha_z}{\\delta_z} a_X(x_1) r_Y\\left(\\frac{\\beta_y}{\\delta_y} a_Z(z_1)\\right)$ 的解给出。方程右边是 $z_1$ 的减函数，但是输入 $x_1$ 的增函数。$x_1$ 的增加会使该曲线向上移动，导致其与直线 $g(z)=z$ 在一个更高的 $z_1$ 值处产生新的交点。因此，$z_1 > z_0$。这种类型的比例负反馈不会产生完全或近似适应，这一点在问题陈述中也已给出。系统会稳定在一个新的、更高的稳态。\n\n- **$Y$ 敲低的效果 ($\\beta_y \\to s \\beta_y$ for $s \\in (0,1)$):** 敲低削弱了负反馈环，因为响应于 $Z$ 而产生的 $Y$ 效率降低了。\n    - 新稳态 $z_1^{(s)}$ 由 $z_1^{(s)} = \\frac{\\alpha_z}{\\delta_z} a_X(x_1) r_Y\\left(s \\frac{\\beta_y}{\\delta_y} a_Z(z_1^{(s)})\\right)$ 给出。随着 $s$ 减小，$r_Y$ 的自变量减小，因此 $r_Y$ 增加。这导致 $Z$ 的稳态值更高，即 $z_1^{(s)} > z_1$。\n    - 从动力学角度看，削弱负反馈会减弱其对 $Z$ 上升的制动效应。对此类反馈系统的标准分析表明，减小环路增益通常会使系统响应得*更快*（即减少稳定时间或上升时间）。\n\n**区分实验**\n\n本质区别在于，在适当的参数化下，I-FFL 表现出带有近似适应的脉冲状响应，而 NFL 不会适应。此外，I-FFL 的这种适应行为关键地依赖于通过 $Y$ 的抑制路径的强度。因此，敲低 $Y$ 应该会消除这种适应性。在 NFL 中，敲低也会改变响应（例如，更高的稳态），但它不会引入或消除适应性，因为该回路本来就不会适应。这提供了一个清晰的实验特征。\n\n**选项评估**\n\n**A. 在 I-FFL 中，阶跃 $x_0\\to x_1$ 会使 $z(t)$ 产生一个快速的瞬时增加，随后由于 $Y$ 的积累并抑制 $Z$，$z(t)$ 会回到接近阶跃前的水平（近似适应）；$Y$ 敲低 ($s1$) 会消除这种适应性，并产生一个持续升高的 $z$ 稳态。在 NFL 中，阶跃会产生一个新的、高于基线的 $z$ 稳态，但没有精确适应；$Y$ 敲低会提高这个稳态水平并减慢响应速度。因此，在有和没有 $Y$ 敲低的情况下分别施加 $X$ 的阶跃输入：如果只有非敲低条件显示出近似适应，而敲低消除了这种适应，那么该回路是 I-FFL；如果两种条件都不适应，那么该回路是 NFL。**\n\n该选项正确地描述了 I-FFL 的脉冲/适应行为以及通过 $Y$ 敲低消除该行为的现象。它正确地指出 NFL 不会适应，并且其稳态在敲低后会增加。所提出的实验利用了这一关键差异，是区分这两种基序的有效策略。其中有一处不准确：声称 $Y$ 敲低会“减慢” NFL 的响应。我的分析表明响应应该变得更快。然而，与其他选项相比，这是一个次要细节上的小错误。关于适应性的主要逻辑是合理的。鉴于指令是选择*最佳*选项，这个选项是最有力的候选者。\n**结论：正确**\n\n**B. I-FFL 和 NFL 在阶跃后都表现出 $z$ 回到基线的完全适应，因为两者都含有抑制子；$Y$ 敲低只会在 NFL 中诱发持续振荡，从而提供一个诊断性特征。**\n\n这个说法存在根本性缺陷。首先，所给出的 NFL 模型不表现出完全或近似的适应性。其稳态输出随输入增加而增加。其次，I-FFL 通常显示的是近似适应，而非完全适应。第三，削弱负反馈环（通过敲低）会使其*更不容易*发生振荡，而不是更容易。持续振荡需要强反馈和足够的延迟，而敲低会使系统朝相反的方向发展。\n**结论：不正确**\n\n**C. 在 I-FFL 中，对于任何希尔函数，稳态 $z$ 都随 $x$ 单调增加，因此不可能发生适应；在 NFL 中，负反馈在稳定的前提下确保了精确适应到阶跃前水平；$Y$ 敲低会降低两种基序中 $z$ 的峰值，从而可以通过峰值大小来区分它们。**\n\n这个选项包含多处错误。I-FFL 的稳态响应 $z_{ss}(x)$ 通常是非单调的，这正是它可以表现出适应性行为（即 $z_{ss}(x_1) \\approx z_{ss}(x_0)$）的原因。关于 NFL 确保精确适应的说法也是错误的；这需要积分控制，而该模型中没有积分控制。最后，$Y$ 的敲低削弱了抑制/负反馈，这应该导致*更高*的输出水平，而不是降低的峰值。\n**结论：不正确**\n\n**D. I-FFL 和 NFL 无法通过 $z(t)$ 的阶跃响应来区分，因为根据参数的不同，两者都可以产生脉冲或单调响应；只有频率响应测量才能将它们分开；如果 $x_1 > x_0$，$Y$ 敲低不会影响 I-FFL 的 $z$ 稳态。**\n\n这个说法是不正确的。尽管调整参数可以改变响应，但适应能力的根本差异为使用阶跃响应进行区分提供了清晰的依据，特别是当与 A 中提出的敲低实验相结合时。声称频率响应是*唯一*的方法是夸大其词。最严重的是，声称 $Y$ 敲低不影响 I-FFL 稳态的说法是明显错误的；削弱抑制路径必然会增加稳态输出 $Z$。\n**结论：不正确**\n\n总而言之，选项 A 对两种回路的行为提供了最准确的描述，并为其区分提出了一个逻辑上合理的实验设计，尽管在 NFL 响应速度方面存在微小的不准确之处。在给定的选项中，它毫无疑问是最佳选择。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}