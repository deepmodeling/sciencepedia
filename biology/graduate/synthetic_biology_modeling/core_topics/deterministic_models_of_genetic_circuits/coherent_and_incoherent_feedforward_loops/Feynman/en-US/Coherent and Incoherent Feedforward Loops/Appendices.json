{
    "hands_on_practices": [
        {
            "introduction": "One of the most celebrated dynamic functions of the incoherent feedforward loop (I-FFL) is its ability to generate a transient pulse of output in response to a sustained input signal. This exercise provides a foundational, hands-on derivation of this behavior by solving a deterministic ordinary differential equation (ODE) model under idealized, yet insightful, assumptions . By working through this problem, you will gain a first-principles understanding of how the interplay between a fast activation pathway and a delayed repression pathway gives rise to this distinct dynamic signature.",
            "id": "3908941",
            "problem": "Consider an incoherent feed-forward loop in which an upstream transcription factor $X$ transcriptionally activates both an intermediate regulator $Y$ and an output gene $Z$, while $Y$ represses $Z$. Assume a deterministic ordinary differential equation (ODE) model with Hill-type regulatory kinetics and linear degradation, consistent with standard practice in synthetic biology modeling.\n\nAt time $t=0$, $X$ experiences a step increase from $0$ to a value $x_{0}$ that is sufficiently large relative to its activation dissociation constant $K_{x}$ that the activation Hill function $H_{\\mathrm{act}}(X)$ saturates, i.e., $H_{\\mathrm{act}}(x(t)) \\approx 1$ for all $t \\ge 0$. The dynamics for $Y$ and $Z$ are modeled as\n$$\n\\frac{dy}{dt} = \\alpha_{y} H_{\\mathrm{act}}(x(t)) - \\beta_{y} y, \\quad y(0)=0,\n$$\n$$\n\\frac{dz}{dt} = \\alpha_{z} H_{\\mathrm{act}}(x(t)) \\, H_{\\mathrm{rep}}(y(t)) - \\beta_{z} z, \\quad z(0)=0,\n$$\nwith $H_{\\mathrm{act}}(x) = \\frac{x^{n_{a}}}{K_{x}^{n_{a}} + x^{n_{a}}}$ and $H_{\\mathrm{rep}}(y) = \\frac{1}{1 + \\left(\\frac{y}{K}\\right)^{n}}$. Assume $n_{a}$ is large enough that $H_{\\mathrm{act}}(x(t)) \\approx 1$ for $t \\ge 0$, and assume a highly cooperative repressor $Y$ with Hill coefficient $n \\to \\infty$ so that $H_{\\mathrm{rep}}(y)$ approaches an idealized switch: $H_{\\mathrm{rep}}(y) = 1$ if $y  K$ and $H_{\\mathrm{rep}}(y) = 0$ if $y  K$. Assume $\\alpha_{y}  \\beta_{y} K$ so that the threshold $K$ is crossed at a finite time.\n\nStarting from these definitions and the ODEs above, and using only the limit $n \\to \\infty$ to approximate $H_{\\mathrm{rep}}(y)$ as a Heaviside switch in $y$, derive an explicit closed-form analytical expression for the transient peak value of $z(t)$ (i.e., the maximum of $z(t)$ over $t \\ge 0$) as a function of the biochemical parameters $\\alpha_{y}$, $\\beta_{y}$, $\\alpha_{z}$, $\\beta_{z}$, and $K$.\n\nProvide your final answer as a single closed-form expression in terms of $\\alpha_{y}$, $\\beta_{y}$, $\\alpha_{z}$, $\\beta_{z}$, and $K$. Do not include units in your final expression. No numerical evaluation or rounding is required.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, and objective. It presents a standard problem in synthetic biology modeling that is self-contained and allows for a unique, meaningful solution.\n\nThe problem describes an incoherent feed-forward loop (IFFL) where a transcription factor $X$ activates both a repressor $Y$ and an output gene $Z$, and $Y$ in turn represses $Z$. We are tasked with finding the peak concentration of the protein $Z$.\n\nThe dynamics of the system are given by a set of ordinary differential equations (ODEs). Based on the problem's assumptions, we can simplify these equations. The assumption that the input $X$ is a large step-like signal means the activation Hill function $H_{\\mathrm{act}}(x(t))$ can be approximated as $1$ for all times $t \\ge 0$. The assumption that the repressor $Y$ is highly cooperative ($n \\to \\infty$) means the repression Hill function $H_{\\mathrm{rep}}(y(t))$ acts as an ideal switch, equal to $1$ when $y  K$ and $0$ when $y  K$.\n\nWith these simplifications, the system of ODEs becomes:\n$$\n\\frac{dy}{dt} = \\alpha_{y} - \\beta_{y} y, \\quad y(0)=0\n$$\n$$\n\\frac{dz}{dt} = \\alpha_{z} H_{\\mathrm{rep}}(y(t)) - \\beta_{z} z, \\quad z(0)=0\n$$\nwhere $H_{\\mathrm{rep}}(y(t))$ is a step function:\n$$\nH_{\\mathrm{rep}}(y(t)) = \\begin{cases} 1  \\text{if } y(t)  K \\\\ 0  \\text{if } y(t)  K \\end{cases}\n$$\n\nFirst, we solve the linear first-order ODE for $y(t)$:\nThe equation $\\frac{dy}{dt} + \\beta_{y} y = \\alpha_{y}$ with the initial condition $y(0)=0$ has the solution:\n$$\ny(t) = \\frac{\\alpha_{y}}{\\beta_{y}} (1 - \\exp(-\\beta_{y} t))\n$$\nThis solution shows that $y(t)$ increases monotonically from $0$ towards a steady-state value of $y_{ss} = \\frac{\\alpha_{y}}{\\beta_{y}}$. The problem states that $\\alpha_{y}  \\beta_{y} K$, which implies $y_{ss}  K$. Therefore, the concentration of $Y$ will cross the threshold $K$ at some finite time, which we denote as $t^*$.\n\nWe find $t^*$ by setting $y(t^*) = K$:\n$$\nK = \\frac{\\alpha_{y}}{\\beta_{y}} (1 - \\exp(-\\beta_{y} t^*))\n$$\nRearranging the terms to solve for $t^*$:\n$$\n\\frac{\\beta_{y} K}{\\alpha_{y}} = 1 - \\exp(-\\beta_{y} t^*)\n$$\n$$\n\\exp(-\\beta_{y} t^*) = 1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\beta_{y} t^* = \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)\n$$\n$$\nt^* = -\\frac{1}{\\beta_{y}} \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right) = \\frac{1}{\\beta_{y}} \\ln\\left(\\frac{\\alpha_{y}}{\\alpha_{y} - \\beta_{y} K}\\right)\n$$\n\nNow we analyze the dynamics of $z(t)$. The behavior of $z(t)$ changes at $t=t^*$.\nFor $0 \\le t  t^*$, we have $y(t)  K$, so $H_{\\mathrm{rep}}(y(t)) = 1$. The ODE for $z(t)$ is:\n$$\n\\frac{dz}{dt} = \\alpha_{z} - \\beta_{z} z, \\quad z(0)=0\n$$\nThe solution to this ODE is:\n$$\nz(t) = \\frac{\\alpha_{z}}{\\beta_{z}} (1 - \\exp(-\\beta_{z} t))\n$$\nIn this time interval, the derivative $\\frac{dz}{dt} = \\alpha_{z} - \\beta_{z} z(t) = \\alpha_{z} \\exp(-\\beta_{z} t)$ is always positive, so $z(t)$ is strictly increasing.\n\nFor $t  t^*$, we have $y(t)  K$, so $H_{\\mathrm{rep}}(y(t)) = 0$. The ODE for $z(t)$ becomes:\n$$\n\\frac{dz}{dt} = - \\beta_{z} z\n$$\nThe solution is $z(t) = z(t^*) \\exp(-\\beta_{z} (t-t^*))$. Since $z(t^*)  0$, the derivative $\\frac{dz}{dt}$ is negative for all $t  t^*$, meaning $z(t)$ is strictly decreasing in this interval.\n\nSince $z(t)$ is increasing for $t  t^*$ and decreasing for $t  t^*$, the maximum value of $z(t)$, which we denote $z_{peak}$, occurs exactly at $t = t^*$. To find $z_{peak}$, we evaluate the solution for $z(t)$ from the first phase at $t=t^*$:\n$$\nz_{peak} = z(t^*) = \\frac{\\alpha_{z}}{\\beta_{z}} (1 - \\exp(-\\beta_{z} t^*))\n$$\nWe now substitute the expression for $t^*$ into this equation. From the derivation of $t^*$, we have $\\exp(-\\beta_{y} t^*) = 1 - \\frac{\\beta_{y} K}{\\alpha_{y}}$. We need to find $\\exp(-\\beta_{z} t^*)$:\n$$\n\\exp(-\\beta_{z} t^*) = \\exp\\left(-\\beta_{z} \\left(-\\frac{1}{\\beta_{y}} \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)\\right)\\right)\n$$\n$$\n\\exp(-\\beta_{z} t^*) = \\exp\\left(\\frac{\\beta_{z}}{\\beta_{y}} \\ln\\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)\\right)\n$$\nUsing the identity $\\exp(c \\ln a) = a^c$:\n$$\n\\exp(-\\beta_{z} t^*) = \\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)^{\\frac{\\beta_{z}}{\\beta_{y}}}\n$$\nSubstituting this result into the expression for $z_{peak}$:\n$$\nz_{peak} = \\frac{\\alpha_{z}}{\\beta_{z}} \\left[ 1 - \\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)^{\\frac{\\beta_{z}}{\\beta_{y}}} \\right]\n$$\nThis is the final closed-form analytical expression for the transient peak value of $z(t)$ as a function of the given biochemical parameters.",
            "answer": "$$\n\\boxed{\\frac{\\alpha_{z}}{\\beta_{z}} \\left( 1 - \\left(1 - \\frac{\\beta_{y} K}{\\alpha_{y}}\\right)^{\\frac{\\beta_{z}}{\\beta_{y}}} \\right)}\n$$"
        },
        {
            "introduction": "Beyond its transient dynamics, the I-FFL also exhibits rich behavior at steady state, most notably acting as a band-pass filter that responds maximally to an intermediate range of input signals. This computational practice challenges you to explore the steady-state dose-response characteristics of both coherent and incoherent FFLs . You will implement the models numerically and perform a parameter sweep to identify the bifurcation point where the I-FFL's response curve transitions from monotonic to non-monotonic, a key skill in analyzing the design principles of regulatory motifs.",
            "id": "3908933",
            "problem": "Consider two gene-regulatory motifs from synthetic biology: the coherent type-1 feedforward loop (C1-FFL) and the incoherent type-1 feedforward loop (I1-FFL). In both motifs, an external input $S$ (a dimensionless inducer concentration) regulates an intermediate transcription factor $Y$, and both $S$ and $Y$ regulate the output gene product $Z$. Use ordinary differential equations with Hill-type regulation to model these motifs under the following scientifically standard assumptions: (i) production and degradation are linear in the concentrations, (ii) activation follows a Hill function, and (iii) repression follows a Hill function of the canonical decreasing form. All quantities are dimensionless.\n\nDefinitions:\n- Activation Hill function: $H_{\\mathrm{act}}(x;K,n) = \\dfrac{x^n}{K^n + x^n}$.\n- Repression Hill function: $H_{\\mathrm{rep}}(y;K,n) = \\dfrac{K^n}{K^n + y^n}$.\n- Dynamics of $Y$: $\\dfrac{dY}{dt} = k_y \\, H_{\\mathrm{act}}(S;K_y,n_y) - \\gamma_y Y$.\n- Dynamics of $Z$ in C1-FFL: $\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{act}}(Y;K_{zY},n_{zY}) - \\gamma_z Z$.\n- Dynamics of $Z$ in I1-FFL: $\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{rep}}(Y;K_{zY},n_{zY}) - \\gamma_z Z$.\n\nAt steady state, $Y^\\ast(S) = \\dfrac{k_y}{\\gamma_y} \\, H_{\\mathrm{act}}(S;K_y,n_y)$ and $Z^\\ast(S)$ equals $\\dfrac{k_z}{\\gamma_z}$ times the appropriate product of Hill terms defined above for the motif. The dose-response of the motif is the function $Z^\\ast(S)$ as $S$ varies across a specified range. A structural change in the shape of $Z^\\ast(S)$ as a parameter varies (for example, the emergence of an internal maximum from a previously monotonic curve) is the focus of the bifurcation analysis in this problem.\n\nYour task is to write a complete program that:\n1. Implements the steady-state dose-response $Z^\\ast(S)$ for both motifs using the definitions above.\n2. Detects whether $Z^\\ast(S)$ has an internal extremum (specifically, a local maximum at some $S$ strictly inside the range) for given parameters by analyzing $Z^\\ast(S)$ computed on a logarithmically spaced grid of $S$ values.\n3. Performs a parameter sweep for the I1-FFL over the repression threshold $K_{zY}$ to estimate the smallest $K_{zY}$ at which the dose-response $Z^\\ast(S)$ acquires an internal maximum (interpreted as the onset of a band-pass shape), which constitutes the requested bifurcation onset with respect to $K_{zY}$.\n\nUse the following parameter values consistently unless varied in a specific test:\n- $k_y/\\gamma_y = 1.0$,\n- $k_z/\\gamma_z = 1.0$,\n- $K_y = 1.0$, $n_y = 2$,\n- $K_{zS} = 1.0$, $n_{zS} = 2$,\n- For $K_{zY}$ and $n_{zY}$, values are specified per test below.\n\nUse a logarithmically spaced grid of $S$ with $N = 1000$ points over $S \\in [10^{-3}, 10^{3}]$. All quantities are dimensionless. The presence of an internal maximum should be detected purely from the discrete $Z^\\ast(S)$ sequence by identifying at least one index $i$ with $1 \\le i \\le N-2$ such that $Z^\\ast(S_i)  Z^\\ast(S_{i-1})$ and $Z^\\ast(S_i) \\ge Z^\\ast(S_{i+1})$.\n\nTest suite:\n- Test $1$ (I1-FFL bifurcation onset): Sweep $K_{zY}$ over the set $\\{0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0\\}$ with $n_{zY} = 4$. For each $K_{zY}$, evaluate whether an internal maximum exists. Return the smallest $K_{zY}$ at which a maximum is detected. If no maximum is detected for any $K_{zY}$ in the set, return $-1.0$.\n- Test $2$ (C1-FFL monotonicity check): With $K_{zY} = 1.0$ and $n_{zY} = 2$, evaluate whether the C1-FFL dose-response has an internal maximum. Return a boolean indicating the presence ($\\mathrm{True}$) or absence ($\\mathrm{False}$) of such a maximum.\n- Test $3$ (I1-FFL fixed-parameter shape): With $K_{zY} = 0.2$ and $n_{zY} = 4$, evaluate whether the I1-FFL dose-response has an internal maximum. Return a boolean.\n- Test $4$ (I1-FFL peak location): With $K_{zY} = 0.05$ and $n_{zY} = 4$, compute the value of $S$ at which $Z^\\ast(S)$ attains its maximum on the specified grid. Return this $S$ value as a float.\n\nFinal output format:\nYour program should produce a single line of output containing the results of Tests $1$ through $4$ in order, as a comma-separated list enclosed in square brackets (for example, $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$). Each result must be one of the following fundamental types: boolean or float. No other text should be printed.",
            "solution": "We begin with the standard gene regulation modeling assumptions, where a regulator modulates gene expression via Hill-type activation or repression, and degradation is linear in concentration. The Hill functions capture cooperative binding and saturation, which is well-established in biophysical models of transcriptional regulation.\n\nThe activation Hill function is $H_{\\mathrm{act}}(x;K,n) = \\dfrac{x^n}{K^n + x^n}$, which is monotonically increasing in $x$, bounded between $0$ and $1$, and has an effective threshold $K$. The repression Hill function is $H_{\\mathrm{rep}}(y;K,n) = \\dfrac{K^n}{K^n + y^n}$, which is monotonically decreasing in $y$, also bounded between $0$ and $1$, and has an effective threshold $K$.\n\nLet $S$ be the input. The intermediate $Y$ follows $\\dfrac{dY}{dt} = k_y H_{\\mathrm{act}}(S;K_y,n_y) - \\gamma_y Y$, which yields a unique steady state $Y^\\ast(S) = \\dfrac{k_y}{\\gamma_y} H_{\\mathrm{act}}(S;K_y,n_y)$ because the right-hand side is linear in $Y$ with a nonnegative, bounded source term.\n\nFor the output $Z$, the coherent type-1 feedforward loop (C1-FFL) uses the product of two activation terms, one for $S$ and one for $Y$:\n$$\n\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{act}}(Y;K_{zY},n_{zY}) - \\gamma_z Z.\n$$\nAt steady state, because the dynamics in $Z$ are linear with a nonnegative source term, we have\n$$\nZ^\\ast_{\\mathrm{coh}}(S) = \\dfrac{k_z}{\\gamma_z} \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{act}}(Y^\\ast(S);K_{zY},n_{zY}).\n$$\nSince both $H_{\\mathrm{act}}(S;\\cdot)$ and $H_{\\mathrm{act}}(Y^\\ast(S);\\cdot)$ are monotonically increasing functions of $S$, and the product of increasing functions is increasing, $Z^\\ast_{\\mathrm{coh}}(S)$ is monotonically increasing in $S$ with no internal maxima. Numerically, this implies that in a discrete grid, no interior index $i$ should satisfy $Z_i  Z_{i-1}$ and $Z_i \\ge Z_{i+1}$ unless numerical artifacts occur at plateaus.\n\nFor the incoherent type-1 feedforward loop (I1-FFL), the source term is the product of an activation term and a repression term:\n$$\n\\dfrac{dZ}{dt} = k_z \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{rep}}(Y;K_{zY},n_{zY}) - \\gamma_z Z.\n$$\nThe steady-state output is\n$$\nZ^\\ast_{\\mathrm{incoh}}(S) = \\dfrac{k_z}{\\gamma_z} \\, H_{\\mathrm{act}}(S;K_{zS},n_{zS}) \\, H_{\\mathrm{rep}}(Y^\\ast(S);K_{zY},n_{zY}).\n$$\nHere, $H_{\\mathrm{act}}(S;\\cdot)$ increases with $S$, but $H_{\\mathrm{rep}}(Y^\\ast(S);\\cdot)$ decreases with $S$ because $Y^\\ast(S)$ itself increases with $S$. The product of an increasing and a decreasing function can be non-monotonic, often generating a band-pass dose-response with an internal maximum when the repression branch is sufficiently strong and cooperative.\n\nBifurcation analysis in this context is framed as a structural change in the steady-state dose-response curve as the repression threshold $K_{zY}$ varies. For large $K_{zY}$, repression is weak over the range of $Y^\\ast(S)$, so $Z^\\ast_{\\mathrm{incoh}}(S)$ tends to be monotonically increasing (no internal maximum). As $K_{zY}$ decreases, repression becomes effective within the $S$ range, and the product may develop an internal maximum. We operationalize the detection of this structural change by scanning over a discrete set of $K_{zY}$ values and checking whether the discrete dose-response sequence $Z^\\ast(S_i)$ has an internal maximum, i.e., there exists an index $i$ with $1 \\le i \\le N-2$ such that $Z_i  Z_{i-1}$ and $Z_i \\ge Z_{i+1}$.\n\nAlgorithmic steps implemented in the program:\n1. Construct the $S$ grid: $N = 1000$ points logarithmically spaced over $[10^{-3},10^{3}]$.\n2. For given parameters, compute $Y^\\ast(S)$ via $Y^\\ast(S) = \\dfrac{k_y}{\\gamma_y} H_{\\mathrm{act}}(S;K_y,n_y)$.\n3. Compute $Z^\\ast(S)$ for the motif of interest by multiplying the appropriate Hill terms and scaling by $\\dfrac{k_z}{\\gamma_z}$.\n4. Detect an internal maximum by scanning the discrete sequence $Z^\\ast(S)$ and checking the interior indices for the local-maximum conditions.\n5. For the bifurcation onset (Test $1$), iterate $K_{zY}$ over the specified set and return the smallest $K_{zY}$ that yields an internal maximum; if none do, return $-1.0$.\n6. For Test $2$, apply the same detection to the C1-FFL; it should return $\\mathrm{False}$.\n7. For Test $3$, apply the detection to a fixed I1-FFL parameter set and return the boolean.\n8. For Test $4$, locate the $S$ at which $Z^\\ast(S)$ is maximal by finding the index of the largest $Z^\\ast(S)$ on the grid; return that $S$ value.\n\nThese steps tie directly to the definitions and logic of feedforward loops. The coherent motifâ€™s dose-response is monotonic due to the composition of increasing functions, whereas the incoherent motif can transition from monotonic to band-pass as repression becomes effective and cooperative. The parameter sweep over $K_{zY}$ is a principled way to observe the onset of a qualitative change in the steady-state input-output curve, which serves as a bifurcation-like indicator for the dose-response shape. The output formatting requirement is satisfied by collecting the four results into a single bracketed, comma-separated list printed on one line.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Hill activation function\ndef hill_act(x, K, n):\n    # Avoid division by zero for K=0 by enforcing positive K in tests\n    x = np.asarray(x)\n    return (x**n) / (K**n + x**n)\n\n# Hill repression function\ndef hill_rep(y, K, n):\n    y = np.asarray(y)\n    return (K**n) / (K**n + y**n)\n\ndef steady_state_Y(S, ky_over_gamma, Ky, ny):\n    return ky_over_gamma * hill_act(S, Ky, ny)\n\ndef steady_state_Z_coh(S, Ystar, kz_over_gamma, KzS, nzS, KzY, nzY):\n    return kz_over_gamma * hill_act(S, KzS, nzS) * hill_act(Ystar, KzY, nzY)\n\ndef steady_state_Z_incoh(S, Ystar, kz_over_gamma, KzS, nzS, KzY, nzY):\n    return kz_over_gamma * hill_act(S, KzS, nzS) * hill_rep(Ystar, KzY, nzY)\n\ndef has_internal_maximum(Z):\n    # Detect internal maximum: exists i (1..N-2) such that Z[i]  Z[i-1] and Z[i] = Z[i+1]\n    # To reduce sensitivity to tiny numerical noise, add a small epsilon tolerance\n    eps = 1e-12\n    for i in range(1, len(Z) - 1):\n        if Z[i]  Z[i - 1] + eps and Z[i] = Z[i + 1] - eps:\n            return True\n    return False\n\ndef find_S_of_max(Z, S):\n    idx = int(np.argmax(Z))\n    return float(S[idx])\n\ndef test_bifurcation_onset_I1FFL(S_grid, ky_over_gamma, kz_over_gamma, Ky, ny, KzS, nzS, nzY, KzY_values):\n    # Return the smallest KzY in KzY_values that yields an internal maximum; else -1.0\n    Ystar = steady_state_Y(S_grid, ky_over_gamma, Ky, ny)\n    for KzY in KzY_values:\n        Z = steady_state_Z_incoh(S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY, nzY)\n        if has_internal_maximum(Z):\n            return float(KzY)\n    return -1.0\n\ndef solve():\n    # Common parameters\n    ky_over_gamma = 1.0\n    kz_over_gamma = 1.0\n    Ky = 1.0\n    ny = 2\n    KzS = 1.0\n    nzS = 2\n\n    # S grid\n    S_grid = np.logspace(-3, 3, 1000)\n\n    results = []\n\n    # Test 1: I1-FFL bifurcation onset over KzY sweep\n    KzY_values = [0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0]\n    nzY_bif = 4\n    onset_KzY = test_bifurcation_onset_I1FFL(\n        S_grid, ky_over_gamma, kz_over_gamma, Ky, ny, KzS, nzS, nzY_bif, KzY_values\n    )\n    results.append(onset_KzY)\n\n    # Precompute Y* for remaining tests\n    Ystar = steady_state_Y(S_grid, ky_over_gamma, Ky, ny)\n\n    # Test 2: C1-FFL monotonicity check\n    KzY_coh = 1.0\n    nzY_coh = 2\n    Z_coh = steady_state_Z_coh(S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY_coh, nzY_coh)\n    results.append(has_internal_maximum(Z_coh))\n\n    # Test 3: I1-FFL fixed-parameter shape (has internal maximum?)\n    KzY_incoh_fixed = 0.2\n    nzY_incoh_fixed = 4\n    Z_incoh_fixed = steady_state_Z_incoh(\n        S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY_incoh_fixed, nzY_incoh_fixed\n    )\n    results.append(has_internal_maximum(Z_incoh_fixed))\n\n    # Test 4: I1-FFL peak location at strong repression\n    KzY_peak = 0.05\n    nzY_peak = 4\n    Z_incoh_peak = steady_state_Z_incoh(\n        S_grid, Ystar, kz_over_gamma, KzS, nzS, KzY_peak, nzY_peak\n    )\n    S_at_peak = find_S_of_max(Z_incoh_peak, S_grid)\n    results.append(S_at_peak)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While deterministic models provide crucial insights into average behavior, gene expression in real biological systems is an inherently stochastic process. This advanced practice moves beyond mean-field descriptions to explore the effects of intrinsic noise within an I-FFL framework . By formulating a Chemical Master Equation (CME) and applying the Linear Noise Approximation (LNA), you will derive how fluctuations in the repressor protein propagate to the output, a critical analysis for understanding the reliability and robustness of both natural and synthetic gene circuits.",
            "id": "2722191",
            "problem": "Consider a synthetic Incoherent type-1 Feed-Forward Loop (I1-FFL) in which an upstream transcription factor $X$ activates both $Y$ and $Z$, while $Y$ represses $Z$. Include transcription, translation, and degradation for both $Y$ and $Z$. The species are $Y_{m}$ (messenger RNA of $Y$), $Y$ (protein), $Z_{m}$ (messenger RNA of $Z$), and $Z$ (protein). Assume $X$ is held at a constant copy number $x_{0}$ by an external input. The reactions are:\n- Transcription of $Y$: $\\varnothing \\to Y_{m}$ with propensity $s_{y} x_{0}$.\n- Degradation of $Y_{m}$: $Y_{m} \\to \\varnothing$ with propensity $d_{my} Y_{m}$.\n- Translation of $Y$: $Y_{m} \\to Y_{m} + Y$ with propensity $k_{y} Y_{m}$.\n- Degradation of $Y$: $Y \\to \\varnothing$ with propensity $d_{y} Y$.\n- Transcription of $Z$: $\\varnothing \\to Z_{m}$ with propensity $s_{z} x_{0} R(Y)$, where the repression function is the Hill form $R(Y) = \\left(1 + \\left(\\frac{Y}{K}\\right)^{n}\\right)^{-1}$ with $K0$, $n \\geq 1$.\n- Degradation of $Z_{m}$: $Z_{m} \\to \\varnothing$ with propensity $d_{mz} Z_{m}$.\n- Translation of $Z$: $Z_{m} \\to Z_{m} + Z$ with propensity $k_{z} Z_{m}$.\n- Degradation of $Z$: $Z \\to \\varnothing$ with propensity $d_{z} Z$.\n\nTasks:\n1) Let $P(n_{ym}, n_{y}, n_{zm}, n_{z}, t)$ be the joint probability of having $n_{ym}$ copies of $Y_{m}$, $n_{y}$ copies of $Y$, $n_{zm}$ copies of $Z_{m}$, and $n_{z}$ copies of $Z$ at time $t$. Using the definition of the Chemical Master Equation (CME), write the CME explicitly in terms of step operators acting on $P$.\n2) Assume small fluctuations around a stable steady state and linearize the repression around the steady-state of $Y$, replacing $R(Y)$ by an affine function $R(Y) \\approx r_{0} - r_{1} Y$ with $r_{0}  0$ and $r_{1}  0$ treated as constants (local intercept and slope). Impose the fast messenger RNA limit $d_{my} \\gg d_{y}$ and $d_{mz} \\gg d_{z}$, and use standard adiabatic elimination to define effective translation burst sizes $b_{y} = k_{y}/d_{my}$ and $b_{z} = k_{z}/d_{mz}$ for $Y$ and $Z$, respectively. Under the Linear Noise Approximation (LNA), derive a closed-form expression for the steady-state Fano factor of $Z$, $F_{Z} = \\mathrm{Var}(Z)/\\mathbb{E}[Z]$, in terms of $s_{y}$, $s_{z}$, $x_{0}$, $r_{0}$, $r_{1}$, $b_{y}$, $b_{z}$, $d_{y}$, and $d_{z}$. Assume parameters are such that the steady-state mean of $Z$ is positive. Provide the final expression for $F_{Z}$ as your answer. Your final answer must be a single closed-form analytic expression. Do not include units.",
            "solution": "The user has provided a problem statement describing an Incoherent type-1 Feed-Forward Loop (I1-FFL) and has asked for two tasks: first, to write the Chemical Master Equation (CME) for the full system, and second, to derive the steady-state Fano factor for the protein $Z$ under a set of approximations.\n\nFirst, I must validate the problem statement.\n\n**Step 1: Extract Givens**\n- **System**: An I1-FFL where a transcription factor $X$ at constant copy number $x_{0}$ activates both $Y$ and $Z$, and protein $Y$ represses protein $Z$.\n- **Species**: $Y_{m}$ (mRNA of $Y$), $Y$ (protein), $Z_{m}$ (mRNA of $Z$), $Z$ (protein). Their copy numbers are denoted by $n_{ym}$, $n_{y}$, $n_{zm}$, and $n_{z}$, respectively.\n- **Reactions and Propensities**:\n    1. Transcription of $Y$: $\\varnothing \\to Y_{m}$ with propensity $a_1 = s_{y} x_{0}$.\n    2. Degradation of $Y_{m}$: $Y_{m} \\to \\varnothing$ with propensity $a_2 = d_{my} n_{ym}$.\n    3. Translation of $Y$: $Y_{m} \\to Y_{m} + Y$ with propensity $a_3 = k_{y} n_{ym}$.\n    4. Degradation of $Y$: $Y \\to \\varnothing$ with propensity $a_4 = d_{y} n_{y}$.\n    5. Transcription of $Z$: $\\varnothing \\to Z_{m}$ with propensity $a_5 = s_{z} x_{0} R(n_y)$, where $R(n_y) = \\left(1 + \\left(\\frac{n_y}{K}\\right)^{n}\\right)^{-1}$.\n    6. Degradation of $Z_{m}$: $Z_{m} \\to \\varnothing$ with propensity $a_6 = d_{mz} n_{zm}$.\n    7. Translation of $Z$: $Z_{m} \\to Z_{m} + Z$ with propensity $a_7 = k_{z} n_{zm}$.\n    8. Degradation of $Z$: $Z \\to \\varnothing$ with propensity $a_8 = d_{z} n_{z}$.\n- **Approximations for Task 2**:\n    - Linearization of the repression function: $R(Y) \\approx r_{0} - r_{1} Y$, with $r_{0}  0$ and $r_{1}  0$.\n    - Fast mRNA limit: $d_{my} \\gg d_{y}$ and $d_{mz} \\gg d_{z}$.\n    - Adiabatic elimination leading to effective burst sizes: $b_{y} = k_{y}/d_{my}$ and $b_{z} = k_{z}/d_{mz}$.\n    - Application of the Linear Noise Approximation (LNA).\n    - The steady-state mean of $Z$ is positive.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a canonical network motif in systems biology using standard mathematical formalisms (chemical kinetics, CME, LNA). All necessary parameters and conditions are provided, and there are no internal contradictions. The linearization of a propensity can lead to non-physical negative values for large fluctuations, but this is a standard and accepted simplification within the context of the LNA, which assumes small fluctuations around a positive mean. The problem is a non-trivial but solvable exercise in stochastic modeling.\n\n**Verdict**: The problem is valid. I will now proceed to the solution.\n\n**Task 1: Chemical Master Equation**\n\nLet the state of the system be described by the vector of copy numbers $\\mathbf{n} = (n_{ym}, n_{y}, n_{zm}, n_{z})$. Let $P(\\mathbf{n}, t)$ be the probability of being in state $\\mathbf{n}$ at time $t$. The CME describes the time evolution of $P(\\mathbf{n}, t)$. We use step operators $E_i$ and $E_i^{-1}$ which act on a function of $n_i$ as $E_i f(n_i) = f(n_i+1)$ and $E_i^{-1} f(n_i) = f(n_i-1)$. The CME for a set of reactions is given by $\\frac{\\partial P(\\mathbf{n}, t)}{\\partial t} = \\sum_{j} (E^{-\\mathbf{v}_j} - 1) [a_j(\\mathbf{n}) P(\\mathbf{n}, t)]$, where $\\mathbf{v}_j$ is the stoichiometric vector and $a_j(\\mathbf{n})$ is the propensity for reaction $j$.\n\nThe reactions and their effect on the state are:\n1. $\\varnothing \\to Y_m$: $\\mathbf{v}_1 = (1, 0, 0, 0)$, $a_1 = s_y x_0$.\n2. $Y_m \\to \\varnothing$: $\\mathbf{v}_2 = (-1, 0, 0, 0)$, $a_2 = d_{my} n_{ym}$.\n3. $Y_m \\to Y_m + Y$: $\\mathbf{v}_3 = (0, 1, 0, 0)$, $a_3 = k_y n_{ym}$.\n4. $Y \\to \\varnothing$: $\\mathbf{v}_4 = (0, -1, 0, 0)$, $a_4 = d_y n_y$.\n5. $\\varnothing \\to Z_m$: $\\mathbf{v}_5 = (0, 0, 1, 0)$, $a_5 = s_z x_0 R(n_y)$.\n6. $Z_m \\to \\varnothing$: $\\mathbf{v}_6 = (0, 0, -1, 0)$, $a_6 = d_{mz} n_{zm}$.\n7. $Z_m \\to Z_m + Z$: $\\mathbf{v}_7 = (0, 0, 0, 1)$, $a_7 = k_z n_{zm}$.\n8. $Z \\to \\varnothing$: $\\mathbf{v}_8 = (0, 0, 0, -1)$, $a_8 = d_z n_z$.\n\nLet $E_{ym}, E_y, E_{zm}, E_z$ be the step operators for the corresponding species. The CME is:\n$$\n\\frac{\\partial P}{\\partial t} = (E_{ym}^{-1} - 1) [s_y x_0 P] + (E_{ym} - 1) [d_{my} n_{ym} P] \\\\\n+ (E_y^{-1} - 1) [k_y n_{ym} P] + (E_y - 1) [d_y n_y P] \\\\\n+ (E_{zm}^{-1} - 1) [s_z x_0 R(n_y) P] + (E_{zm} - 1) [d_{mz} n_{zm} P] \\\\\n+ (E_z^{-1} - 1) [k_z n_{zm} P] + (E_z - 1) [d_z n_z P]\n$$\nwhere $P \\equiv P(n_{ym}, n_y, n_{zm}, n_z, t)$ and $R(n_y) = \\left(1 + \\left(\\frac{n_y}{K}\\right)^{n}\\right)^{-1}$.\n\n**Task 2: Fano Factor of Z**\n\nWe follow the prescribed approximations. First, we linearize the repression function $R(Y)$ to $R(Y) \\approx r_0 - r_1 Y$. Then, we apply adiabatic elimination for the mRNA species. In the limit of fast mRNA turnover ($d_{my} \\gg d_y$, $d_{mz} \\gg d_z$), transcription and subsequent translation events can be coarse-grained into effective \"bursty\" protein production reactions.\nEach transcription of $Y_m$ (rate $s_y x_0$) leads to a burst of $Y$ proteins. The number of proteins in a burst, $B_y$, is a random variable following a geometric distribution with mean $\\mathbb{E}[B_y] = b_y = k_y/d_{my}$.\nSimilarly, each transcription of $Z_m$ (rate $s_z x_0 (r_0 - r_1 Y)$) leads to a burst of $Z$ proteins, with burst size $B_z$ having mean $\\mathbb{E}[B_z] = b_z = k_z/d_{mz}$.\n\nThe effective system for the protein copy numbers $(Y, Z)$ is:\n1. Production of $Y$: $\\varnothing \\xrightarrow{s_y x_0} B_y Y$\n2. Degradation of $Y$: $Y \\xrightarrow{d_y} \\varnothing$\n3. Production of $Z$: $\\varnothing \\xrightarrow{s_z x_0 (r_0 - r_1 Y)} B_z Z$\n4. Degradation of $Z$: $Z \\xrightarrow{d_z} \\varnothing$\n\nThe mean-field rate equations for the average protein numbers, $\\bar{y} = \\mathbb{E}[Y]$ and $\\bar{z} = \\mathbb{E}[Z]$, are:\n$$\n\\frac{d\\bar{y}}{dt} = s_y x_0 b_y - d_y \\bar{y}\n$$\n$$\n\\frac{d\\bar{z}}{dt} = s_z x_0 b_z (r_0 - r_1 \\bar{y}) - d_z \\bar{z}\n$$\nAt steady state ($\\frac{d}{dt}=0$):\n$$\n\\bar{y}_{ss} = \\frac{s_y x_0 b_y}{d_y}\n$$\n$$\n\\bar{z}_{ss} = \\frac{s_z x_0 b_z}{d_z}(r_0 - r_1 \\bar{y}_{ss}) = \\frac{s_z x_0 b_z}{d_z}\\left(r_0 - \\frac{r_1 s_y x_0 b_y}{d_y}\\right)\n$$\nThe problem states that $\\bar{z}_{ss}  0$, which implies $r_0  r_1 s_y x_0 b_y / d_y$.\n\nWe now apply the LNA to find the covariance matrix $C$ of the fluctuations around this steady state. The covariance matrix satisfies the Lyapunov equation $JC + CJ^T + D = 0$, where $J$ is the Jacobian of the rate equations and $D$ is the diffusion matrix.\n\nThe drift vector is $F(y,z) = \\begin{pmatrix} s_y x_0 b_y - d_y y \\\\ s_z x_0 b_z (r_0 - r_1 y) - d_z z \\end{pmatrix}$.\nThe Jacobian at steady state is:\n$$\nJ = \\left.\\begin{pmatrix} \\frac{\\partial F_y}{\\partial y}  \\frac{\\partial F_y}{\\partial z} \\\\ \\frac{\\partial F_z}{\\partial y}  \\frac{\\partial F_z}{\\partial z} \\end{pmatrix}\\right|_{ss} = \\begin{pmatrix} -d_y  0 \\\\ -s_z x_0 b_z r_1  -d_z \\end{pmatrix}\n$$\nThe diffusion matrix elements are $D_{ij} = \\sum_k \\mathbb{E}[(\\Delta n_i)_k (\\Delta n_j)_k] \\langle a_k \\rangle$, where the sum is over reactions. For bursty production from $\\varnothing$, the term is $\\mathbb{E}[B^2] \\times (\\text{rate})$. For first-order decay, it is $1^2 \\times (\\text{rate})$.\nThe second moment of the geometric burst size distribution is $\\mathbb{E}[B^2] = b(2b+1)$.\n$$\nD_{yy} = \\mathbb{E}[B_y^2] (s_y x_0) + d_y \\bar{y}_{ss} = b_y(2b_y+1) s_y x_0 + d_y \\bar{y}_{ss}\n$$\nUsing $s_y x_0 = d_y \\bar{y}_{ss}/b_y$, we get $D_{yy} = (2b_y+1)d_y \\bar{y}_{ss} + d_y \\bar{y}_{ss} = 2(b_y+1)d_y \\bar{y}_{ss}$.\n$$\nD_{zz} = \\mathbb{E}[B_z^2] (s_z x_0 (r_0 - r_1 \\bar{y}_{ss})) + d_z \\bar{z}_{ss} = b_z(2b_z+1) \\frac{d_z \\bar{z}_{ss}}{b_z} + d_z \\bar{z}_{ss} = 2(b_z+1)d_z \\bar{z}_{ss}\n$$\nNo reaction simultaneously changes $Y$ and $Z$, so $D_{yz} = 0$. The diffusion matrix is:\n$$\nD = \\begin{pmatrix} 2(b_y+1)d_y \\bar{y}_{ss}  0 \\\\ 0  2(b_z+1)d_z \\bar{z}_{ss} \\end{pmatrix}\n$$\nSolving $JC + CJ^T = -D$ for $C = \\begin{pmatrix} C_{yy}  C_{yz} \\\\ C_{yz}  C_{zz} \\end{pmatrix}$:\n1. $-2d_y C_{yy} = -D_{yy} \\implies C_{yy} = \\frac{D_{yy}}{2d_y} = (b_y+1)\\bar{y}_{ss}$.\n2. $-(d_y+d_z)C_{yz} - (s_z x_0 b_z r_1)C_{yy} = 0 \\implies C_{yz} = -\\frac{s_z x_0 b_z r_1}{d_y+d_z}C_{yy}$.\n3. $-2(s_z x_0 b_z r_1)C_{yz} - 2d_z C_{zz} = -D_{zz}$.\n$$\nC_{zz} = \\frac{D_{zz}}{2d_z} - \\frac{s_z x_0 b_z r_1}{d_z} C_{yz} = (b_z+1)\\bar{z}_{ss} - \\frac{s_z x_0 b_z r_1}{d_z} \\left( -\\frac{s_z x_0 b_z r_1}{d_y+d_z}C_{yy} \\right)\n$$\n$$\nC_{zz} = (b_z+1)\\bar{z}_{ss} + \\frac{(s_z x_0 b_z r_1)^2}{(d_y+d_z)d_z} C_{yy}\n$$\nThe Fano factor for Z is $F_Z = C_{zz}/\\bar{z}_{ss}$.\n$$\nF_Z = b_z+1 + \\frac{(s_z x_0 b_z r_1)^2}{(d_y+d_z)d_z \\bar{z}_{ss}} C_{yy} = b_z+1 + \\frac{(s_z x_0 b_z r_1)^2 (b_y+1)\\bar{y}_{ss}}{(d_y+d_z)d_z \\bar{z}_{ss}}\n$$\nWe substitute the steady-state expressions for $\\bar{y}_{ss}$ and $\\bar{z}_{ss}$ to express $F_Z$ in terms of the base parameters.\n$$\n\\frac{\\bar{y}_{ss}}{\\bar{z}_{ss}} = \\frac{s_y x_0 b_y / d_y}{\\frac{s_z x_0 b_z}{d_z}(r_0 - r_1 \\frac{s_y x_0 b_y}{d_y})} = \\frac{s_y b_y d_z}{d_y s_z b_z (r_0 - \\frac{r_1 s_y x_0 b_y}{d_y})}\n$$\nSubstituting this into the expression for $F_Z$:\n$$\nF_Z = b_z+1 + \\frac{(s_z x_0 b_z r_1)^2 (b_y+1)}{(d_y+d_z)d_z} \\frac{s_y b_y d_z}{d_y s_z b_z (r_0 - \\frac{r_1 s_y x_0 b_y}{d_y})}\n$$\n$$\nF_Z = b_z+1 + \\frac{s_z s_y x_0^2 b_z b_y r_1^2 (b_y+1)}{(d_y+d_z)d_y(r_0 - \\frac{r_1 s_y x_0 b_y}{d_y})} = b_z+1 + \\frac{s_y s_z x_0^2 b_y b_z r_1^2 (b_y+1)}{(d_y+d_z)(d_y r_0 - r_1 s_y x_0 b_y)}\n$$\nThis is the final expression for the Fano factor of $Z$. The first term, $b_z+1$, represents the intrinsic noise in $Z$ production, while the second term represents the noise propagated from the fluctuations in the repressor $Y$.",
            "answer": "$$\\boxed{b_{z}+1 + \\frac{s_{y} s_{z} b_{y} b_{z} r_{1}^{2} x_{0}^{2} (b_{y}+1)}{(d_{y}+d_{z})(d_{y} r_{0} - r_{1} s_{y} x_{0} b_{y})}}$$"
        }
    ]
}