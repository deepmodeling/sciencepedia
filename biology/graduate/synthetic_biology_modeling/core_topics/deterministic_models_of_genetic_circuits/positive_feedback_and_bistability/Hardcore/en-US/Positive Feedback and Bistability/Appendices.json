{
    "hands_on_practices": [
        {
            "introduction": "To understand how a positive feedback loop can act as a switch, we must first master the local behavior of the system around its steady states. This exercise  provides foundational practice in linear stability analysis, a cornerstone of dynamical systems theory. By deriving the stability criterion for a canonical auto-activation model, you will learn to connect the mathematical properties of the system's production and loss rates to the concrete behavior of whether a small perturbation will grow or decay, thus determining if a steady state is stable or unstable.",
            "id": "3927215",
            "problem": "A single-gene positive autoregulatory module is modeled at the population-averaged, well-mixed level by the ordinary differential equation (ODE) $\\frac{dx}{dt} = f(x)$, where $x$ denotes the concentration of the gene product. Assume transcriptional self-activation is described by a Hill-type activation term and linear first-order loss, yielding\n$$\nf(x) \\;=\\; \\alpha \\;+\\; \\beta\\,\\frac{x^{n}}{K^{n} + x^{n}} \\;-\\; \\gamma\\,x,\n$$\nwith $\\alpha>0$ the basal production rate, $\\beta>0$ the regulated maximal inducible production increment, $K>0$ the half-activation concentration, $n \\ge 1$ the Hill coefficient, and $\\gamma>0$ the effective first-order loss rate (dilution plus degradation). Work in the deterministic, mean-field limit and assume parameters are constant in time and that $x \\ge 0$.\n\nStarting from the standard linearization principle for one-dimensional ODEs and the definition of the Hill function, perform the following:\n\n- Derive the general closed-form expression for $f'(x)$ by differentiating the right-hand side with respect to $x$.\n- Using linearization around a steady state $x^*$ satisfying $f(x^*) = 0$, state the local asymptotic stability criterion in terms of the derivative of the Hill term evaluated at $x^*$ relative to $\\gamma$. Express your result in words and in symbolic form.\n\nProvide as your final answer the single closed-form symbolic expression for $f'(x)$. No numerical evaluation is required, and no rounding is necessary. Express your final answer without units.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n**Step 1: Extract Givens**\nThe governing ordinary differential equation (ODE) for the concentration $x$ of a gene product is given as $\\frac{dx}{dt} = f(x)$, where the function $f(x)$ is defined as:\n$$\nf(x) \\;=\\; \\alpha \\;+\\; \\beta\\,\\frac{x^{n}}{K^{n} + x^{n}} \\;-\\; \\gamma\\,x\n$$\nThe parameters are defined with the following constraints:\n- Basal production rate: $\\alpha>0$\n- Regulated maximal inducible production increment: $\\beta>0$\n- Half-activation concentration: $K>0$\n- Hill coefficient: $n\\geq 1$\n- Effective first-order loss rate: $\\gamma>0$\nThe domain for the state variable is $x \\ge 0$. The analysis is to be performed in the deterministic, mean-field limit. The tasks are to derive the expression for $f'(x)$ and to state the local asymptotic stability criterion for a steady state $x^{\\ast}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. The provided ODE is a canonical model for a single-gene positive feedback loop, widely used in systems and synthetic biology to study phenomena such as bistability and biological switches. The functional form, employing a Hill function for cooperative activation and a linear term for degradation/dilution, represents a standard and well-accepted formulation. The parameters are physically meaningful and correctly defined. The problem is well-posed, providing all necessary information to perform the requested calculus and stability analysis. It is objective, using precise mathematical language, and self-contained. The problem does not violate any principles of scientific or mathematical logic, nor does it contain any of the listed flaws that would render it invalid.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe system dynamics are described by the function $f(x)$. The first task is to find the derivative of this function with respect to $x$, denoted as $f'(x) = \\frac{d}{dx}f(x)$. The function is:\n$$\nf(x) = \\alpha + \\beta \\frac{x^n}{K^n + x^n} - \\gamma x\n$$\nWe differentiate $f(x)$ term by term. The derivative of the constant basal production term $\\alpha$ is $0$. The derivative of the linear loss term $-\\gamma x$ is $-\\gamma$. The main task is to differentiate the Hill activation term, which we will denote as $h_{act}(x) = \\beta \\frac{x^n}{K^n + x^n}$.\n\nUsing the quotient rule for differentiation, which states that for $g(x) = \\frac{u(x)}{v(x)}$, the derivative is $g'(x) = \\frac{u'(x)v(x) - u(x)v'(x)}{[v(x)]^2}$, we set:\n- $u(x) = x^n$\n- $v(x) = K^n + x^n$\n\nThe derivatives of $u(x)$ and $v(x)$ with respect to $x$ are:\n- $u'(x) = \\frac{d}{dx}(x^n) = n x^{n-1}$\n- $v'(x) = \\frac{d}{dx}(K^n + x^n) = n x^{n-1}$ (since $K^n$ is a constant)\n\nNow we apply the quotient rule to find the derivative of $\\frac{x^n}{K^n + x^n}$:\n$$\n\\frac{d}{dx}\\left(\\frac{x^n}{K^n + x^n}\\right) = \\frac{(n x^{n-1})(K^n + x^n) - (x^n)(n x^{n-1})}{(K^n + x^n)^2}\n$$\nWe expand the numerator:\n$$\n(n x^{n-1})(K^n) + (n x^{n-1})(x^n) - (x^n)(n x^{n-1}) = n K^n x^{n-1} + n x^{2n-1} - n x^{2n-1} = n K^n x^{n-1}\n$$\nSo, the derivative of the Hill activation term is:\n$$\n\\frac{d}{dx}\\left(\\beta \\frac{x^n}{K^n + x^n}\\right) = \\beta \\frac{n K^n x^{n-1}}{(K^n + x^n)^2}\n$$\nCombining all the differentiated terms, we obtain the complete expression for $f'(x)$:\n$$\nf'(x) = 0 + \\beta \\frac{n K^n x^{n-1}}{(K^n + x^n)^2} - \\gamma\n$$\n$$\nf'(x) = \\beta \\frac{n K^n x^{n-1}}{(K^n + x^n)^2} - \\gamma\n$$\nThis is the general closed-form expression for $f'(x)$.\n\nThe second task is to state the local asymptotic stability criterion for a steady state $x^{\\ast}$. A steady state, or fixed point, $x^{\\ast}$ is a concentration where the net rate of change is zero, meaning $f(x^{\\ast})=0$. For a one-dimensional autonomous ODE $\\frac{dx}{dt} = f(x)$, a steady state $x^{\\ast}$ is locally asymptotically stable if and only if $f'(x^{\\ast})  0$.\n\nSubstituting our derived expression for $f'(x)$ into this inequality, the stability criterion becomes:\n$$\n\\beta \\frac{n K^n (x^{\\ast})^{n-1}}{(K^n + (x^{\\ast})^n)^2} - \\gamma  0\n$$\nThis can be rewritten as:\n$$\n\\beta \\frac{n K^n (x^{\\ast})^{n-1}}{(K^n + (x^{\\ast})^n)^2}  \\gamma\n$$\nThe term on the left-hand side is the derivative of the Hill activation term, $\\beta \\frac{x^n}{K^n+x^n}$, evaluated at the steady state $x^{\\ast}$. In words, the stability criterion is as follows:\n\nA steady state $x^{\\ast}$ is locally asymptotically stable if the slope of the regulated production rate function (the Hill term), evaluated at the steady-state concentration $x^{\\ast}$, is less than the effective first-order loss rate constant $\\gamma$. This means that for a small perturbation away from the steady state, the feedback response of the production machinery is weaker than the passive removal of the protein, ensuring that the system returns to the steady state.",
            "answer": "$$\n\\boxed{\\beta \\frac{n K^n x^{n-1}}{(K^n + x^n)^2} - \\gamma}\n$$"
        },
        {
            "introduction": "A common pitfall in interpreting experimental data from gene circuits is confusing the observation of a bimodal population distribution with proof of underlying deterministic bistability. This conceptual problem  challenges you to disentangle these two ideas by considering the roles of intrinsic noise, extrinsic parameter fluctuations, and measurement error. Correctly distinguishing between bimodality and bistability is critical for accurately inferring the mechanism of a biological switch from single-cell data.",
            "id": "3927189",
            "problem": "Consider a single-gene auto-activation circuit with positive feedback. Let the concentration of the protein be denoted by $x$, and suppose the deterministic dynamics are given by the ordinary differential equation (ODE) $\\dot{x} = f(x)$, where $f(x) = \\alpha \\dfrac{x^{n}}{K^{n} + x^{n}} - \\beta x$, with $\\alpha  0$, $\\beta  0$, $K  0$, and Hill coefficient $n \\ge 1$. The system is observed through a fluorescence readout $y$ related to $x$ by a linear measurement model $y = s x + \\eta$, where $s  0$ and $\\eta$ is an additive measurement noise. Assume that the intrinsic biochemical noise can be modeled as weak stochastic perturbations of the dynamics around deterministic fixed points, and that the measurement noise $\\eta$ is zero-mean Gaussian with variance $\\sigma_{m}^{2}$ that can be large.\n\nDefine bistability as the existence of multiple attracting fixed points of the deterministic dynamics (that is, multiple $x^{*}$ such that $f(x^{*}) = 0$ and $f'(x^{*})  0$, separated by at least one repelling fixed point where $f'(x^{*})  0$). Define bimodality as the presence of multiple peaks in a stationary distribution of observed values.\n\nSelect all statements that are correct and that best differentiate bistability in the underlying dynamics from bimodality in observed stationary distributions:\n\nA. In a monostable regime (one attracting fixed point), the stationary distribution of the true state $x$ under weak intrinsic noise is unimodal; under the linear measurement model with additive Gaussian noise, the stationary distribution of the observed readout $y$ remains unimodal, with larger $\\sigma_{m}$ increasing the width but not inducing multiple peaks.\n\nB. True bistability in the underlying dynamics requires at least two attracting fixed points separated by a repelling fixed point; in the small intrinsic noise limit, the stationary distribution of the true state $x$ becomes bimodal with peaks localized near the attracting fixed points.\n\nC. Observing a bimodal stationary distribution of the fluorescence readout $y$ necessarily implies that the underlying deterministic dynamics of $x$ are bistable.\n\nD. Even when the deterministic dynamics are monostable, slow extrinsic fluctuations that induce a mixture of distinct operating regimes across cells or over time can generate an apparently bimodal stationary distribution of the observed readout $y$.\n\nE. A pair of peaks in the time-averaged stationary distribution of the observed readout $y$ always indicates two stable fixed points in the underlying deterministic dynamics, regardless of the noise sources or their timescales.",
            "solution": "The problem asks for an evaluation of statements distinguishing between bistability, a property of deterministic dynamical systems, and bimodality, a property of probability distributions of observed states.\n\nFirst, let us formalize the concepts based on the provided problem statement.\n\nThe system's dynamics are described by the ordinary differential equation (ODE):\n$$ \\dot{x} = f(x) = \\alpha \\frac{x^n}{K^n + x^n} - \\beta x $$\nwhere $x$ is the protein concentration, and $\\alpha, \\beta, K  0$, $n \\ge 1$.\n\nThe fixed points, $x^*$, of the system are the solutions to $\\dot{x} = 0$, which means $f(x^*) = 0$. This can be written as:\n$$ \\alpha \\frac{(x^*)^n}{K^n + (x^*)^n} = \\beta x^* $$\nThis equation corresponds to finding the intersections of the sigmoidal production rate function, $P(x) = \\alpha \\frac{x^n}{K^n + x^n}$, and the linear degradation rate function, $D(x) = \\beta x$.\n\n**Bistability**, as defined, requires the existence of multiple attracting (stable) fixed points. A fixed point $x^*$ is attracting (stable) if $f'(x^*)  0$ and repelling (unstable) if $f'(x^*)  0$. For this system, bistability occurs when the equation $f(x) = 0$ has three positive solutions, which form a sequence of stable, unstable, stable fixed points. This typically requires a sufficiently large Hill coefficient ($n  1$) and appropriate parameter values for $\\alpha$, $\\beta$, and $K$ such that the sigmoid $P(x)$ is steep enough to intersect the line $D(x)$ three times.\n\n**Bimodality** is defined as the presence of multiple peaks in a stationary probability distribution.\nThe observed readout is $y = s x + \\eta$, where $\\eta \\sim \\mathcal{N}(0, \\sigma_m^2)$. The distribution of $y$, let's call it $p_Y(y)$, is related to the distribution of the true state $x$, $p_X(x)$, through a scaling and a convolution. If $z=sx$, then $p_Z(z) = \\frac{1}{s}p_X(z/s)$. The distribution of $y$ is the convolution of the distribution of $z$ with the Gaussian distribution of the noise $\\eta$:\n$$ p_Y(y) = (p_Z * p_\\eta)(y) = \\int_{-\\infty}^{\\infty} p_Z(z) p_\\eta(y-z) dz $$\nwhere $p_\\eta$ is a Gaussian PDF.\n\nWith these principles established, we can evaluate each statement.\n\n**A. In a monostable regime (one attracting fixed point), the stationary distribution of the true state $x$ under weak intrinsic noise is unimodal; under the linear measurement model with additive Gaussian noise, the stationary distribution of the observed readout $y$ remains unimodal, with larger $\\sigma_{m}$ increasing the width but not inducing multiple peaks.**\n\n- **Analysis:** In a monostable regime, there is a single stable fixed point, $x^*$. Weak intrinsic noise will cause the system state $x$ to fluctuate around this fixed point. In the context of a potential landscape analogy where $f(x) = -dU/dx$, a single stable fixed point corresponds to a single potential well. Small perturbations will cause the state to explore this well, leading to a unimodal stationary distribution $p_X(x)$ peaked at (or near) $x^*$. The linear transformation $z = sx$ simply rescales the axis, so the distribution of $z$, $p_Z(z)$, is also unimodal. The final observed distribution, $p_Y(y)$, is the convolution of this unimodal distribution $p_Z(z)$ with a Gaussian distribution (which is itself unimodal). A fundamental mathematical result states that the convolution of a unimodal distribution with a Gaussian distribution is always unimodal. Therefore, adding Gaussian measurement noise cannot create new peaks from a unimodal distribution. Increasing the noise variance $\\sigma_m^2$ will increase the width of the convolving Gaussian, which further smooths and widens the resulting distribution $p_Y(y)$.\n\n- **Verdict:** **Correct**.\n\n**B. True bistability in the underlying dynamics requires at least two attracting fixed points separated by a repelling fixed point; in the small intrinsic noise limit, the stationary distribution of the true state $x$ becomes bimodal with peaks localized near the attracting fixed points.**\n\n- **Analysis:** The first part of the statement is the definition of bistability as provided in the problem setup and is consistent with standard use in dynamical systems. In a bistable system (e.g., two stable fixed points $x_1^*$ and $x_3^*$, separated by an unstable fixed point $x_2^*$), the corresponding potential landscape $U(x)$ has two wells at $x_1^*$ and $x_3^*$ separated by a barrier at $x_2^*$. Under weak intrinsic noise, the system will spend the vast majority of its time fluctuating within these two wells. Transitions between the wells are rare events. Consequently, the stationary probability distribution of the state, $p_X(x)$, will exhibit two distinct peaks centered near the stable fixed points $x_1^*$ and $x_3^*$. This is the definition of a bimodal distribution.\n\n- **Verdict:** **Correct**.\n\n**C. Observing a bimodal stationary distribution of the fluorescence readout $y$ necessarily implies that the underlying deterministic dynamics of $x$ are bistable.**\n\n- **Analysis:** This statement posits that bimodality is a sufficient condition for bistability. To falsify this, we need to find a scenario where the dynamics are monostable, yet the observed distribution is bimodal. Such scenarios exist. One prominent example, detailed in statement D, involves extrinsic noise. If the cell population is heterogeneous, or if system parameters fluctuate slowly over time, the observed population can be a mixture of distinct monostable states. For instance, half the cells might exist in a low-expression monostable state and the other half in a high-expression monostable state due to differences in a parameter like the transcription rate $\\alpha$. A histogram of the entire population would show two peaks, resulting in a bimodal distribution, even though no single cell is bistable. Because a plausible alternative mechanism for bimodality exists, one cannot conclude with necessity that the underlying dynamics must be bistable.\n\n- **Verdict:** **Incorrect**.\n\n**D. Even when the deterministic dynamics are monostable, slow extrinsic fluctuations that induce a mixture of distinct operating regimes across cells or over time can generate an apparently bimodal stationary distribution of the observed readout $y$.**\n\n- **Analysis:** This statement provides the primary counterexample to statement C. \"Extrinsic fluctuations\" refer to variations in parameters of the system (e.g., $\\alpha, \\beta$) that are external to the specific reaction of gene expression being modeled. If these fluctuations are \"slow\" (i.e., the parameters remain constant long enough for $x$ to reach its steady-state distribution before the parameter changes again), the overall time-averaged or population-averaged distribution is a mixture (a weighted sum) of the stationary distributions corresponding to different parameter values. Let's say a parameter $\\theta$ can take two values, $\\theta_1$ and $\\theta_2$. If the system is monostable for both $\\theta_1$ (with stable state $x_1^*$) and $\\theta_2$ (with stable state $x_2^*$), the overall distribution of $x$ will be $p_X(x) = w_1 p_{X|\\theta_1}(x) + w_2 p_{X|\\theta_2}(x)$. If the corresponding mean readouts $y_1=sx_1^*$ and $y_2=sx_2^*$ are sufficiently separated relative to the widths of the individual distributions, the resulting mixture distribution for $y$ will be bimodal. This is a well-established mechanism for generating bimodality in biological systems without requiring deterministic bistability.\n\n- **Verdict:** **Correct**.\n\n**E. A pair of peaks in the time-averaged stationary distribution of the observed readout $y$ always indicates two stable fixed points in the underlying deterministic dynamics, regardless of the noise sources or their timescales.**\n\n- **Analysis:** This statement is an even stronger and more absolute version of statement C. The use of \"always\" and \"regardless of the noise sources or their timescales\" makes it highly susceptible to falsification. As established in the analysis of statement D, slow extrinsic noise is a specific type of noise source with a specific timescale that can produce bimodality from a monostable system. This directly contradicts the claim. Therefore, a pair of peaks does not \"always\" indicate two stable fixed points.\n\n- **Verdict:** **Incorrect**.\n\nIn summary, statements A, B, and D are correct. They work together to differentiate bistability from bimodality by showing: (A) when a simple system remains unimodal, (B) how bistability causes bimodality, and (D) how bimodality can arise without bistability.",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "Beyond simply determining if a system *can* be bistable, a central goal of synthetic biology is to design circuits that are *robustly* bistable, meaning their switching behavior is reliable despite inherent variations in cellular parameters. This computational problem  moves from local analysis to a global, quantitative view of robustness by asking you to calculate the volume of the bistable region in a multi-dimensional parameter space. By implementing a numerical solution to find an optimal design, you will engage with the principles of model-guided design for creating functional and reliable synthetic devices.",
            "id": "3927191",
            "problem": "Consider a canonical single-gene positive feedback system used in synthetic biology modeling, where the dimensionless concentration $x$ of an auto-activating transcription factor evolves according to an Ordinary Differential Equation (ODE) with Hill-type activation and linear degradation. The deterministic model is\n$$\n\\frac{dx}{dt} = \\tilde{\\alpha}\\,\\frac{x^n}{1 + x^n} - \\tilde{\\beta}\\,x,\n$$\nwhere $\\tilde{\\alpha}  0$ is the dimensionless maximal production rate, $\\tilde{\\beta}  0$ is the dimensionless first-order degradation rate, and $n  0$ is the Hill coefficient of activation. Positive feedback and ultrasensitivity can generate multistability; the bistable regime (two distinct stable fixed points, separated by an unstable fixed point) occurs if and only if the ratio $r = \\tilde{\\alpha}/\\tilde{\\beta}$ exceeds a critical threshold $r_{\\mathrm{c}}(n)$ that depends on $n$ and arises from the geometry of the nullcline intersections. For $n \\le 1$, no bistability occurs. For $n  1$, the critical threshold $r_{\\mathrm{c}}(n)$ is defined by the condition that the maximum of the function $g(x;n) = x^{n-1}/(1+x^n)$ equals $1/r$. The maximum of $g$ occurs at $x^\\star = (n-1)^{1/n}$ and has value $g(x^\\star;n) = (n-1)^{(n-1)/n}/n$. Therefore, bistability occurs precisely when $r  r_{\\mathrm{c}}(n)$ with\n$$\nr_{\\mathrm{c}}(n) = \\frac{n}{(n-1)^{(n-1)/n}},\\quad n1.\n$$\n\nYour task is to analyze robustness to parameter variation by computing the volume of the bistable region within a bounded parameter box in $(\\tilde{\\alpha},\\tilde{\\beta},n)$-space, and to optimize the placement of a fixed-size design sub-box to maximize this bistable volume. Specifically:\n\n1. For a given parameter box defined by intervals $\\tilde{\\alpha} \\in [A_{\\min}, A_{\\max}]$, $\\tilde{\\beta} \\in [B_{\\min}, B_{\\max}]$, and $n \\in [N_{\\min}, N_{\\max}]$, compute the volume $V$ of the subset of $(\\tilde{\\alpha},\\tilde{\\beta},n)$ in this box that yields bistability, measured in the standard Lebesgue measure on $\\mathbb{R}^3$. Equivalently,\n$$\nV = \\int_{N_{\\min}}^{N_{\\max}} \\text{Area}\\Big(\\left\\{(\\tilde{\\alpha},\\tilde{\\beta}) \\in [A_{\\min},A_{\\max}] \\times [B_{\\min},B_{\\max}] : \\frac{\\tilde{\\alpha}}{\\tilde{\\beta}}  r_{\\mathrm{c}}(n)\\right\\}\\Big)\\,dn.\n$$\nFor $n \\le 1$, the integrand must be defined as zero.\n\n2. Given a feasible superset box $[A_{\\mathrm{lo}},A_{\\mathrm{hi}}] \\times [B_{\\mathrm{lo}},B_{\\mathrm{hi}}] \\times [N_{\\mathrm{lo}},N_{\\mathrm{hi}}]$ and fixed design widths $w_\\alpha$, $w_\\beta$, and $w_n$ such that $0  w_\\alpha \\le A_{\\mathrm{hi}}-A_{\\mathrm{lo}}$, $0  w_\\beta \\le B_{\\mathrm{hi}}-B_{\\mathrm{lo}}$, and $0  w_n \\le N_{\\mathrm{hi}}-N_{\\mathrm{lo}}$, choose a sub-box $[A_{\\min},A_{\\max}] \\times [B_{\\min},B_{\\max}] \\times [N_{\\min},N_{\\max}]$ of these exact widths (i.e., $A_{\\max}-A_{\\min}=w_\\alpha$, $B_{\\max}-B_{\\min}=w_\\beta$, $N_{\\max}-N_{\\min}=w_n$) and contained within the feasible superset, to maximize the bistable volume $V$. Compute the maximal volume $V_{\\mathrm{opt}}$ and report only its numerical value. The optimization must be performed over all placements of the sub-box within the superset, and you must base the algorithmic strategy on first principles derived from the bistability condition.\n\nTo implement the computation of the $\\tilde{\\alpha}$-$\\tilde{\\beta}$ cross-sectional area for a fixed $n$, note that the condition $\\tilde{\\alpha}/\\tilde{\\beta}  c$ with $c = r_{\\mathrm{c}}(n)$ defines the region above the line $\\tilde{\\alpha} = c \\tilde{\\beta}$ in the rectangle $[A_{\\min},A_{\\max}] \\times [B_{\\min},B_{\\max}]$. The area is given by integrating, for each $\\tilde{\\beta}$, the length of $\\tilde{\\alpha}$ values satisfying $\\tilde{\\alpha}  c \\tilde{\\beta}$ with $\\tilde{\\alpha} \\in [A_{\\min},A_{\\max}]$. This produces the piecewise-analytic area formula in terms of $\\beta_0 = A_{\\min}/c$ and $\\beta_1 = A_{\\max}/c$:\n- For $\\tilde{\\beta} \\in [B_{\\min}, \\min(B_{\\max}, \\beta_0)]$, the length is $A_{\\max} - A_{\\min}$.\n- For $\\tilde{\\beta} \\in [\\max(B_{\\min}, \\beta_0), \\min(B_{\\max}, \\beta_1)]$, the length is $A_{\\max} - c \\tilde{\\beta}$.\n- Outside these intervals, the length is zero.\n\nTherefore, the area is\n$$\n\\text{Area}(n) = (A_{\\max}-A_{\\min})\\cdot\\max\\big(0,\\min(B_{\\max},\\beta_0)-B_{\\min}\\big) + \\Big[A_{\\max}(\\beta_u - \\beta_l) - \\frac{c}{2}(\\beta_u^2 - \\beta_l^2)\\Big]_+,\n$$\nwhere $c=r_{\\mathrm{c}}(n)$, $\\beta_l=\\max(B_{\\min},\\beta_0)$, $\\beta_u=\\min(B_{\\max},\\beta_1)$, and $[\\,\\cdot\\,]_+$ denotes inclusion only when $\\beta_u\\beta_l$ (otherwise zero). The volume is then $V=\\int_{N_{\\min}}^{N_{\\max}} \\text{Area}(n)\\,dn$.\n\nYou must implement a program that computes $V$ using numerical integration over $n$ and evaluates $\\text{Area}(n)$ using the above piecewise formula. For the optimization, you must justify and implement the optimal placement strategy based on the monotonicity of the bistability condition with respect to $\\tilde{\\alpha}$, $\\tilde{\\beta}$, and $n$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots]$). Each result must be a real number (float). For each test case, output two numbers: first the volume $V$ of the full given box, and second the maximal volume $V_{\\mathrm{opt}}$ for the optimally placed sub-box of fixed widths inside the given feasible superset. Aggregate all test cases in order into a single flat list.\n\nTest Suite:\n- Test Case $1$ (happy path):\n  - Full box: $\\tilde{\\alpha} \\in [0.5, 10.0]$, $\\tilde{\\beta} \\in [0.2, 5.0]$, $n \\in [1.2, 5.0]$.\n  - Feasible superset and widths for optimization: $[A_{\\mathrm{lo}},A_{\\mathrm{hi}}]=[0.5, 10.0]$, $[B_{\\mathrm{lo}},B_{\\mathrm{hi}}]=[0.2, 5.0]$, $[N_{\\mathrm{lo}},N_{\\mathrm{hi}}]=[1.2, 5.0]$, with $w_\\alpha=3.0$, $w_\\beta=1.0$, $w_n=2.0$.\n- Test Case $2$ (boundary-dominated narrow box):\n  - Full box: $\\tilde{\\alpha} \\in [1.0, 2.0]$, $\\tilde{\\beta} \\in [0.5, 1.0]$, $n \\in [1.0, 2.0]$.\n  - Feasible superset and widths for optimization: $[A_{\\mathrm{lo}},A_{\\mathrm{hi}}]=[1.0, 2.0]$, $[B_{\\mathrm{lo}},B_{\\mathrm{hi}}]=[0.5, 1.0]$, $[N_{\\mathrm{lo}},N_{\\mathrm{hi}}]=[1.0, 2.0]$, with $w_\\alpha=1.0$, $w_\\beta=0.5$, $w_n=1.0$.\n- Test Case $3$ (edge case crossing $n=1$ threshold):\n  - Full box: $\\tilde{\\alpha} \\in [0.1, 3.0]$, $\\tilde{\\beta} \\in [0.2, 1.5]$, $n \\in [0.8, 1.4]$.\n  - Feasible superset and widths for optimization: $[A_{\\mathrm{lo}},A_{\\mathrm{hi}}]=[0.1, 3.0]$, $[B_{\\mathrm{lo}},B_{\\mathrm{hi}}]=[0.2, 1.5]$, $[N_{\\mathrm{lo}},N_{\\mathrm{hi}}]=[0.8, 1.4]$, with $w_\\alpha=1.0$, $w_\\beta=0.5$, $w_n=0.4$.\n\nFinal Output Format:\n- Your program should produce a single line containing a comma-separated list enclosed in square brackets of $6$ numbers: $[V_1,V_{\\mathrm{opt},1},V_2,V_{\\mathrm{opt},2},V_3,V_{\\mathrm{opt},3}]$, where $V_i$ is the volume of the bistable region in the given full box for test case $i$, and $V_{\\mathrm{opt},i}$ is the maximal bistable volume achievable by optimally placing a sub-box of the given widths within the feasible superset for test case $i$.\n\nNo physical units are involved; all quantities are dimensionless. Express all numerical results as real numbers (floats). Angles are not involved. Percentages are not involved.",
            "solution": "The user has provided a problem statement that requires validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation:** The dimensionless concentration $x$ of an auto-activating transcription factor follows the ODE:\n$$\n\\frac{dx}{dt} = \\tilde{\\alpha}\\,\\frac{x^n}{1 + x^n} - \\tilde{\\beta}\\,x\n$$\n- **Parameters:** $\\tilde{\\alpha}  0$ (maximal production rate), $\\tilde{\\beta}  0$ (degradation rate), $n  0$ (Hill coefficient).\n- **Bistability Condition:** Bistability occurs if and only if $n  1$ and the ratio $r = \\tilde{\\alpha}/\\tilde{\\beta}$ is greater than a critical threshold $r_{\\mathrm{c}}(n)$.\n- **Critical Threshold:**\n$$\nr_{\\mathrm{c}}(n) = \\frac{n}{(n-1)^{(n-1)/n}},\\quad n1.\n$$\n- **Task 1 (Volume Calculation):** For a parameter box defined by $\\tilde{\\alpha} \\in [A_{\\min}, A_{\\max}]$, $\\tilde{\\beta} \\in [B_{\\min}, B_{\\max}]$, and $n \\in [N_{\\min}, N_{\\max}]$, compute the volume $V$ of the bistable region:\n$$\nV = \\int_{N_{\\min}}^{N_{\\max}} \\text{Area}\\Big(\\left\\{(\\tilde{\\alpha},\\tilde{\\beta}) \\in [A_{\\min},A_{\\max}] \\times [B_{\\min},B_{\\max}] : \\frac{\\tilde{\\alpha}}{\\tilde{\\beta}}  r_{\\mathrm{c}}(n)\\right\\}\\Big)\\,dn,\n$$\nwhere the integrand is zero for $n \\le 1$.\n- **Area Formula:** The cross-sectional area for a fixed $n$ is given by:\n$$\n\\text{Area}(n) = (A_{\\max}-A_{\\min})\\cdot\\max\\big(0,\\min(B_{\\max},\\beta_0)-B_{\\min}\\big) + \\Big[A_{\\max}(\\beta_u - \\beta_l) - \\frac{c}{2}(\\beta_u^2 - \\beta_l^2)\\Big]_+,\n$$\nwhere $c=r_{\\mathrm{c}}(n)$, $\\beta_0=A_{\\min}/c$, $\\beta_1=A_{\\max}/c$, $\\beta_l=\\max(B_{\\min},\\beta_0)$, $\\beta_u=\\min(B_{\\max},\\beta_1)$, and $[\\,\\cdot\\,]_+$ denotes inclusion only if $\\beta_u  \\beta_l$.\n- **Task 2 (Optimization):** Given a feasible superset box $[A_{\\mathrm{lo}},A_{\\mathrm{hi}}] \\times [B_{\\mathrm{lo}},B_{\\mathrm{hi}}] \\times [N_{\\mathrm{lo}},N_{\\mathrm{hi}}]$ and fixed widths $w_\\alpha$, $w_\\beta$, $w_n$, find a sub-box of these widths contained within the superset that maximizes the bistable volume $V$. The result is the maximal volume $V_{\\mathrm{opt}}$.\n- **Test Suite:** Three test cases are provided with specific numerical values for the box boundaries and widths.\n- **Output Format:** A single line with a comma-separated list of $6$ float values: $[V_1,V_{\\mathrm{opt},1},V_2,V_{\\mathrm{opt},2},V_3,V_{\\mathrm{opt},3}]$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is based on a standard, well-established mathematical model for a single-gene positive-feedback loop (a genetic toggle switch) in systems and synthetic biology. The use of a Hill function for activation and the derivation of the bistability criterion are canonical. The mathematical formulation is correct.\n2.  **Well-Posed:**\n    - The volume calculation involves integrating a piecewise-analytic, non-negative function over a finite interval. The integral is well-defined and can be computed numerically.\n    - The optimization problem requires maximizing this integral. The dependence of the integrand on the parameters $(\\tilde{\\alpha}, \\tilde{\\beta}, n)$ is analyzable, allowing for a principled optimization strategy rather than a brute-force search. A unique, stable solution for the optimal placement and volume exists.\n3.  **Objective:** The problem is stated using precise, unambiguous mathematical language. There are no subjective or opinion-based components.\n4.  **Completeness and Consistency:** All necessary definitions, formulas, and data are provided. The constraints on the parameters and box widths are consistent and sufficient for solving the problem. The provided formula for `Area(n)` is correct and derivable from first principles.\n5.  **Triviality:** The problem is not trivial. It requires numerical integration and an analytical step to devise the optimization strategy, which depends on a non-monotonic function $r_c(n)$.\n\nThe problem statement is valid across all criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A reasoned solution and implementation will be provided.\n\nThe solution is developed in two parts, corresponding to the two tasks. First, a method for computing the volume $V$ is established. Second, a strategy for finding the optimal sub-box and its volume $V_{\\mathrm{opt}}$ is derived from first principles.\n\n**Part 1: Bistable Volume Calculation**\n\nThe primary objective is to compute the volume $V$ of the parameter set $(\\tilde{\\alpha}, \\tilde{\\beta}, n)$ that results in bistability within a given box $[A_{\\min}, A_{\\max}] \\times [B_{\\min}, B_{\\max}] \\times [N_{\\min}, N_{\\max}]$. This volume is given by the integral:\n$$\nV = \\int_{N_{\\min}}^{N_{\\max}} \\text{Area}(n) \\, dn\n$$\nThe integrand, $\\text{Area}(n)$, represents the area of the region in the $(\\tilde{\\alpha}, \\tilde{\\beta})$-plane where the system is bistable for a specific value of $n$. The condition for bistability is $\\tilde{\\alpha}/\\tilde{\\beta}  r_{\\mathrm{c}}(n)$ for $n  1$, and no bistability exists for $n \\le 1$. Thus, $\\text{Area}(n) = 0$ for $n \\le 1$.\n\nFor $n  1$, we define $c = r_c(n) = n / (n-1)^{(n-1)/n}$. The area is that of the set $\\{(\\tilde{\\alpha}, \\tilde{\\beta}) \\mid \\tilde{\\alpha}  c \\tilde{\\beta}\\}$ intersected with the rectangle $[A_{\\min}, A_{\\max}] \\times [B_{\\min}, B_{\\max}]$. The problem provides a correct, explicit formula for this area, which is derived by integrating the valid length of the $\\tilde{\\alpha}$ interval for each $\\tilde{\\beta}$ from $B_{\\min}$ to $B_{\\max}$. This formula is implemented directly. The final volume $V$ is then computed by numerically integrating $\\text{Area}(n)$ with respect to $n$ over the interval $[N_{\\min}, N_{\\max}]$ using numerical quadrature, for which the `scipy.integrate.quad` function is suitable.\n\n**Part 2: Optimal Sub-box Placement**\n\nThe second task is to maximize the bistable volume $V$ by selecting a sub-box of fixed dimensions $(w_\\alpha, w_\\beta, w_n)$ within a larger feasible superset $[A_{\\mathrm{lo}}, A_{\\mathrm{hi}}] \\times [B_{\\mathrm{lo}}, B_{\\mathrm{hi}}] \\times [N_{\\mathrm{lo}}, N_{\\mathrm{hi}}]$. The optimal placement is determined by analyzing how the integrand $\\text{Area}(n)$ depends on the box boundaries.\n\n*   **Dependence on $\\tilde{\\alpha}$ and $\\tilde{\\beta}$:** The condition for bistability, $\\tilde{\\alpha}  c(n) \\tilde{\\beta}$, is favored by large values of $\\tilde{\\alpha}$ and small values of $\\tilde{\\beta}$. Consequently, to maximize the area of the bistable region for any given $n$, the integration rectangle for $(\\tilde{\\alpha}, \\tilde{\\beta})$ should be positioned to include the largest possible $\\tilde{\\alpha}$ values and smallest possible $\\tilde{\\beta}$ values. This places the optimal sub-box at the \"top-left\" corner of the feasible space in the $(\\tilde{\\alpha}, \\tilde{\\beta})$-plane. The optimal intervals are therefore $[A_{\\min}, A_{\\max}] = [A_{\\mathrm{hi}} - w_\\alpha, A_{\\mathrm{hi}}]$ and $[B_{\\min}, B_{\\max}] = [B_{\\mathrm{lo}}, B_{\\mathrm{lo}} + w_\\beta]$.\n\n*   **Dependence on $n$:** The dependence on $n$ is mediated by the critical threshold $c(n) = r_{\\mathrm{c}}(n)$. The area of the bistable region is a monotonically decreasing function of $c(n)$: a smaller threshold $c(n)$ makes bistability easier to achieve and thus yields a larger area. A mathematical analysis of $c(n)$ for $n1$ reveals that:\n    -   $\\lim_{n\\to 1^+} c(n) = 1$.\n    -   $c(n)$ increases for $n \\in (1, 2]$, reaching a global maximum of $c(2) = 2$.\n    -   $c(n)$ decreases for $n  2$, with $\\lim_{n\\to\\infty} c(n) = 1$.\n\n    This non-monotonic behavior of $c(n)$ implies that its inverse, and by extension $\\text{Area}(n)$, has a global minimum around $n=2$ and increases as $n$ moves away from $2$ (either towards $1$ or towards $\\infty$). To maximize the total volume $\\int \\text{Area}(n)\\,dn$ over an interval of fixed width $w_n$, the interval $[N_{\\min}, N_{\\max}]$ should be placed where $\\text{Area}(n)$ is largest. Given the shape of $\\text{Area}(n)$ (a \"valley\" at $n=2$), the optimal placement must be at one of the extremities of the feasible range $[N_{\\mathrm{lo}}, N_{\\mathrm{hi}}]$.\n\n*   **Optimal Strategy:** The optimal placement of the sub-box is determined as follows:\n    1.  The $\\tilde{\\alpha}$ and $\\tilde{\\beta}$ intervals are fixed to $[A_{\\mathrm{hi}}-w_\\alpha, A_{\\mathrm{hi}}]$ and $[B_{\\mathrm{lo}}, B_{\\mathrm{lo}}+w_\\beta]$, respectively.\n    2.  Two candidate placements for the $n$ interval are considered: the lower-end placement $[N_{\\mathrm{lo}}, N_{\\mathrm{lo}}+w_n]$ and the upper-end placement $[N_{\\mathrm{hi}}-w_n, N_{\\mathrm{hi}}]$.\n    3.  The bistable volume is calculated for both candidate sub-boxes.\n    4.  The maximum of these two volumes is the final optimal volume, $V_{\\mathrm{opt}}$.\n\nThis principled strategy is implemented in the provided Python code.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef r_c(n):\n    \"\"\"\n    Calculates the critical threshold r_c for a given Hill coefficient n.\n    \"\"\"\n    if n = 1.0:\n        return np.inf\n    # To avoid potential numerical issues as n approaches 1, we can handle it\n    # explicitly, although np.power is generally robust.\n    if np.isclose(n, 1.0):\n        return np.inf\n    \n    # Formula: r_c(n) = n / (n-1)^((n-1)/n) for n  1\n    base = n - 1.0\n    exponent = (n - 1.0) / n\n    denominator = np.power(base, exponent)\n    \n    if denominator == 0:\n        return np.inf\n\n    return n / denominator\n\ndef area_integrand(n, A_min, A_max, B_min, B_max):\n    \"\"\"\n    Calculates the cross-sectional area of the bistable region in the\n    (alpha, beta) plane for a fixed n. This is the integrand for the volume calculation.\n    \"\"\"\n    if n = 1.0:\n        return 0.0\n\n    c = r_c(n)\n    \n    if np.isinf(c) or c = 0:\n        return 0.0\n\n    beta_0 = A_min / c\n    beta_1 = A_max / c\n\n    # Term 1: Area of the rectangular region where all alpha values satisfy the condition.\n    # This corresponds to beta  beta_0.\n    term1_width = np.max([0.0, np.min([B_max, beta_0]) - B_min])\n    area1 = (A_max - A_min) * term1_width\n\n    # Term 2: Area of the trapezoidal region.\n    # This corresponds to beta_0 = beta = beta_1.\n    beta_l = np.max([B_min, beta_0])\n    beta_u = np.min([B_max, beta_1])\n\n    area2 = 0.0\n    if beta_u  beta_l:\n        # Integral of (A_max - c*beta) from beta_l to beta_u\n        integral_val = A_max * (beta_u - beta_l) - (c / 2.0) * (beta_u**2 - beta_l**2)\n        # The problem statement's [...]+ notation implies taking max(0, integral_val),\n        # though the geometry ensures it should be non-negative if beta_u  beta_l.\n        area2 = integral_val\n        \n    return area1 + area2\n\ndef calculate_volume(box_params):\n    \"\"\"\n    Computes the bistable volume for a given parameter box.\n    \"\"\"\n    A_min, A_max, B_min, B_max, N_min, N_max = box_params\n    \n    # Use scipy.integrate.quad for numerical integration over n.\n    # The area_integrand function handles the case n = 1 by returning 0.\n    volume, _ = integrate.quad(\n        area_integrand,\n        N_min,\n        N_max,\n        args=(A_min, A_max, B_min, B_max),\n        epsabs=1.49e-08, # standard tolerance\n        epsrel=1.49e-08,\n        limit=100\n    )\n    return volume\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Test Case 1\n        {\n            \"full_box\": (0.5, 10.0, 0.2, 5.0, 1.2, 5.0),\n            \"opt_setup\": {\n                \"super_box\": (0.5, 10.0, 0.2, 5.0, 1.2, 5.0),\n                \"widths\": (3.0, 1.0, 2.0)\n            }\n        },\n        # Test Case 2\n        {\n            \"full_box\": (1.0, 2.0, 0.5, 1.0, 1.0, 2.0),\n            \"opt_setup\": {\n                \"super_box\": (1.0, 2.0, 0.5, 1.0, 1.0, 2.0),\n                \"widths\": (1.0, 0.5, 1.0)\n            }\n        },\n        # Test Case 3\n        {\n             \"full_box\": (0.1, 3.0, 0.2, 1.5, 0.8, 1.4),\n             \"opt_setup\": {\n                 \"super_box\": (0.1, 3.0, 0.2, 1.5, 0.8, 1.4),\n                 \"widths\": (1.0, 0.5, 0.4)\n             }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Part 1: Volume of the full given box\n        V = calculate_volume(case[\"full_box\"])\n        results.append(V)\n\n        # Part 2: Maximal volume for the optimally placed sub-box\n        A_lo, A_hi, B_lo, B_hi, N_lo, N_hi = case[\"opt_setup\"][\"super_box\"]\n        w_alpha, w_beta, w_n = case[\"opt_setup\"][\"widths\"]\n        \n        # Optimal placement for alpha (high end) and beta (low end)\n        A_min_opt = A_hi - w_alpha\n        A_max_opt = A_hi\n        B_min_opt = B_lo\n        B_max_opt = B_lo + w_beta\n        \n        # Candidate 1 for n-box placement (lower end of feasible range)\n        N_min_1 = N_lo\n        N_max_1 = N_lo + w_n\n        opt_box_1 = (A_min_opt, A_max_opt, B_min_opt, B_max_opt, N_min_1, N_max_1)\n        V_opt_1 = calculate_volume(opt_box_1)\n        \n        # Candidate 2 for n-box placement (upper end of feasible range)\n        N_min_2 = N_hi - w_n\n        N_max_2 = N_hi\n        opt_box_2 = (A_min_opt, A_max_opt, B_min_opt, B_max_opt, N_min_2, N_max_2)\n        V_opt_2 = calculate_volume(opt_box_2)\n        \n        V_opt = max(V_opt_1, V_opt_2)\n        results.append(V_opt)\n\n    # Format the final output as a single line\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}