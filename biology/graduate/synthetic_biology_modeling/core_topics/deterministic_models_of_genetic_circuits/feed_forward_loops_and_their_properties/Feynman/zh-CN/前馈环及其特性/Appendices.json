{
    "hands_on_practices": [
        {
            "introduction": "在分析任何基因回路的功能之前，首要步骤是理解其稳态行为，即在持续的输入信号下系统最终会达到何种状态。本练习将通过推导一个典型的相干前馈环（coherent FFL）在常数输入下的稳态解，来揭示其基本的输入-输出响应特性。通过这个实践，你将从数学上证明相干前馈环的一个标志性特征：其输出响应是单调的，为后续更复杂的动力学分析奠定基础。",
            "id": "3912698",
            "problem": "考虑一个合成基因线路中的一致性前馈环路 (FFL)，其中上游转录因子 $X$ 正向调控中间转录因子 $Y$ 和下游基因 $Z$，同时 $Y$ 也正向调控 $Z$。假设浓度 $Y(t)$ 和 $Z(t)$ 的常微分方程 (ODE) 模型如下，其中 $X$ 保持为一个非负常数值：\n$$\n\\frac{dY}{dt} \\;=\\; k_Y\\,F_{XY}(X)\\;-\\;\\gamma_Y\\,Y,\n\\qquad\n\\frac{dZ}{dt} \\;=\\; k_Z\\,G_{XZ}(X)\\,H_{YZ}(Y)\\;-\\;\\gamma_Z\\,Z,\n$$\n其中 $k_Y>0$ 和 $k_Z>0$ 是最大生产速率，$\\gamma_Y>0$ 和 $\\gamma_Z>0$ 是一阶降解/稀释速率，调控函数是如下定义的 Hill 型激活函数：\n$$\nF_{XY}(X)\\;=\\;\\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}},\\qquad\nG_{XZ}(X)\\;=\\;\\frac{X^{n_{XZ}}}{K_{XZ}^{\\,n_{XZ}}+X^{n_{XZ}}},\\qquad\nH_{YZ}(Y)\\;=\\;\\frac{Y^{n_{YZ}}}{K_{YZ}^{\\,n_{YZ}}+Y^{n_{YZ}}},\n$$\n其中解离常数 $K_{XY},K_{XZ},K_{YZ}>0$，Hill 系数 $n_{XY},n_{XZ},n_{YZ}\\ge 1$。$Z$ 的下游启动子对输入 $X$ 和 $Y$ 实现逻辑与 (AND) 操作（即两个激活信号的乘法整合）。该设置模拟了一个一致性激活-激活 FFL。\n\n从合成和一阶损失（质量作用降解/稀释）以及单调 Hill 型激活函数这些基本建模假设出发，完成以下任务：\n\n1. 将稳态 $(Y^\\ast,Z^\\ast)$ 推导为恒定输入 $X$ 和各参数的显式函数。\n\n2. 使用微积分和链式法则，推导 $\\frac{dZ^\\ast}{dX}$ 作为 $X$ 和参数的函数的符号，并就此具有与逻辑的一致性 FFL，判断 $Z^\\ast$ 是否是 $X$ 的单调函数。你的推理过程必须从上述定义出发，不得预设结论。\n\n将最终答案表示为 $Z^\\ast(X)$ 关于 $X$ 和各参数的单个闭式解析表达式。不需要进行数值计算，也不需要单位。",
            "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   物种浓度 $Y(t)$ 和 $Z(t)$ 的常微分方程 (ODE)：\n    $$\n    \\frac{dY}{dt} \\;=\\; k_Y\\,F_{XY}(X)\\;-\\;\\gamma_Y\\,Y\n    $$\n    $$\n    \\frac{dZ}{dt} \\;=\\; k_Z\\,G_{XZ}(X)\\,H_{YZ}(Y)\\;-\\;\\gamma_Z\\,Z\n    $$\n-   输入信号：$X$ 是一个恒定的非负值 ($X \\ge 0$)。\n-   动力学参数：$k_Y>0$、$k_Z>0$ (最大生产速率)；$\\gamma_Y>0$、$\\gamma_Z>0$ (降解/稀释速率)。\n-   调控函数 (Hill 型激活)：\n    $$\n    F_{XY}(X)\\;=\\;\\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}}\n    $$\n    $$\n    G_{XZ}(X)\\;=\\;\\frac{X^{n_{XZ}}}{K_{XZ}^{\\,n_{XZ}}+X^{n_{XZ}}}\n    $$\n    $$\n    H_{YZ}(Y)\\;=\\;\\frac{Y^{n_{YZ}}}{K_{YZ}^{\\,n_{YZ}}+Y^{n_{YZ}}}\n    $$\n-   Hill 参数：$K_{XY}, K_{XZ}, K_{YZ}>0$ (解离常数)；$n_{XY}, n_{XZ}, n_{YZ}\\ge 1$ (Hill 系数)。\n-   网络拓扑和逻辑：一致性前馈环路 (FFL)，具有正调控路径 $X \\to Y$、$X \\to Z$ 和 $Y \\to Z$。$X$ 和 $Y$ 对 $Z$ 的调控通过调控函数 $G_{XZ}(X)$ 和 $H_{YZ}(Y)$ 的乘法相互作用实现逻辑与 (AND)。\n-   任务：\n    1. 将稳态 $(Y^\\ast,Z^\\ast)$ 推导为 $X$ 的显式函数。\n    2. 推导 $\\frac{dZ^\\ast}{dX}$ 的符号并确定 $Z^\\ast$ 是否是 $X$ 的单调函数。\n    3. 提供 $Z^\\ast(X)$ 的最终闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n评估问题的有效性。\n-   **科学依据充分：** 该模型是系统生物学和合成生物学中 1 型一致性前馈环路 (C1-FFL) 的标准表示。ODE 基于蛋白质合成和一阶降解的基本质量作用原理。Hill 函数是广为接受的转录调控唯象模型。该问题在科学上是合理的。\n-   **问题适定：** 该问题是适定的。对于恒定的输入 $X$，$Y$ 的 ODE 是线性的，并有唯一、稳定的稳态。随后，$Z$ 的 ODE 也变成一个线性方程（一旦 $Y$ 达到稳态，其驱动项就与时间无关），从而导致 $Z$ 也有一个唯一、稳定的稳态。问题是自洽的，并提供了寻找唯一解所需的所有信息。\n-   **目标明确：** 问题使用精确的数学语言陈述，没有主观或模糊的术语。\n\n### 步骤 3：结论与行动\n该问题被判定为 **有效**。现在开始求解过程。\n\n### 解题推导\n\n**1. 稳态分析**\n\n为求稳态浓度（记为 $Y^\\ast$ 和 $Z^\\ast$），我们将浓度的时间导数设为零。\n\n对于浓度 $Y$，我们有：\n$$\n\\frac{dY}{dt} = 0 \\implies k_Y\\,F_{XY}(X)\\;-\\;\\gamma_Y\\,Y^\\ast = 0\n$$\n将 $Y^\\ast$ 解出为输入 $X$ 和系统参数的函数，得到：\n$$\nY^\\ast(X) = \\frac{k_Y}{\\gamma_Y}\\,F_{XY}(X) = \\frac{k_Y}{\\gamma_Y} \\left( \\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}} \\right)\n$$\n该方程给出了中间转录因子 $Y$ 的显式稳态浓度，作为上游输入 $X$ 的函数。\n\n对于浓度 $Z$，我们将其时间导数设为零，并在 $Y$ 的稳态（即 $Y^\\ast$）下进行计算：\n$$\n\\frac{dZ}{dt} = 0 \\implies k_Z\\,G_{XZ}(X)\\,H_{YZ}(Y^\\ast)\\;-\\;\\gamma_Z\\,Z^\\ast = 0\n$$\n将 $Z^\\ast$ 解出为 $X$ 和 $Y^\\ast$ 的函数，得到：\n$$\nZ^\\ast(X) = \\frac{k_Z}{\\gamma_Z}\\,G_{XZ}(X)\\,H_{YZ}(Y^\\ast(X))\n$$\n为获得仅依赖于 $X$ 和参数的 $Z^\\ast$ 的显式函数，我们代入 $G_{XZ}(X)$、$H_{YZ}(Y^\\ast)$ 和 $Y^\\ast(X)$ 的表达式：\n$$\nZ^\\ast(X) = \\frac{k_Z}{\\gamma_Z} \\left( \\frac{X^{n_{XZ}}}{K_{XZ}^{\\,n_{XZ}}+X^{n_{XZ}}} \\right) \\left( \\frac{(Y^\\ast(X))^{n_{YZ}}}{K_{YZ}^{\\,n_{YZ}}+(Y^\\ast(X))^{n_{YZ}}} \\right)\n$$\n代入 $Y^\\ast(X)$ 的完整表达式，得到 $Z^\\ast(X)$ 的最终解析形式：\n$$\nZ^\\ast(X) = \\frac{k_Z}{\\gamma_Z} \\left( \\frac{X^{n_{XZ}}}{K_{XZ}^{\\,n_{XZ}}+X^{n_{XZ}}} \\right) \\left( \\frac{\\left(\\frac{k_Y}{\\gamma_Y} \\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}}\\right)^{n_{YZ}}}{K_{YZ}^{\\,n_{YZ}} + \\left(\\frac{k_Y}{\\gamma_Y} \\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}}\\right)^{n_{YZ}}} \\right)\n$$\n这就完成了任务的第一部分。\n\n**2. 单调性分析**\n\n为确定 $Z^\\ast$ 是否为 $X$ 的单调函数，我们必须求其导数 $\\frac{dZ^\\ast}{dX}$ 的符号。我们从表达式 $Z^\\ast(X) = \\frac{k_Z}{\\gamma_Z}\\,G_{XZ}(X)\\,H_{YZ}(Y^\\ast(X))$ 开始。\n\n使用乘法法则和链式法则对 $X$ 求导：\n$$\n\\frac{dZ^\\ast}{dX} = \\frac{k_Z}{\\gamma_Z} \\left[ \\frac{dG_{XZ}(X)}{dX} H_{YZ}(Y^\\ast(X)) + G_{XZ}(X) \\frac{d}{dX} \\left( H_{YZ}(Y^\\ast(X)) \\right) \\right]\n$$\n$$\n\\frac{dZ^\\ast}{dX} = \\frac{k_Z}{\\gamma_Z} \\left[ \\frac{dG_{XZ}}{dX} H_{YZ}(Y^\\ast) + G_{XZ}(X) \\frac{dH_{YZ}}{dY^\\ast} \\frac{dY^\\ast}{dX} \\right]\n$$\n\n现在，我们分析当 $X \\ge 0$ 时，该表达式中每一项的符号：\n-   参数：$k_Z > 0$ 且 $\\gamma_Z > 0$，所以它们的比值 $\\frac{k_Z}{\\gamma_Z}$ 是正数。\n-   Hill 函数：对于非负输入，Hill 函数 $G_{XZ}(X)$ 和 $H_{YZ}(Y^\\ast)$ 的值始终为非负。因此，$G_{XZ}(X) \\ge 0$ 且 $H_{YZ}(Y^\\ast) \\ge 0$。\n-   Hill 函数的导数：设 $f(u) = \\frac{u^n}{K^n + u^n}$ 是一个通用的 Hill 激活函数，其中 $n \\ge 1$，$K > 0$ 且 $u \\ge 0$。其导数为：\n    $$\n    \\frac{df}{du} = \\frac{n u^{n-1} (K^n + u^n) - u^n (n u^{n-1})}{(K^n + u^n)^2} = \\frac{n K^n u^{n-1}}{(K^n + u^n)^2}\n    $$\n    因为 $n \\ge 1$，$K > 0$ 且 $u \\ge 0$，导数 $\\frac{df}{du}$ 始终为非负 ($\\ge 0$)。因此，所有 Hill 激活函数都是单调不减的。\n-   将此结论应用于我们的函数：\n    -   $\\frac{dG_{XZ}}{dX} \\ge 0$\n    -   $\\frac{dH_{YZ}}{dY^\\ast} \\ge 0$\n-   $Y^\\ast(X)$ 的导数：稳态 $Y^\\ast$ 由 $Y^\\ast(X) = \\frac{k_Y}{\\gamma_Y} F_{XY}(X)$ 给出。我们对其关于 $X$ 求导：\n    $$\n    \\frac{dY^\\ast}{dX} = \\frac{k_Y}{\\gamma_Y} \\frac{dF_{XY}}{dX}\n    $$\n    由于 $\\frac{k_Y}{\\gamma_Y} > 0$ 且 $F_{XY}(X)$ 是一个 Hill 激活函数，其导数 $\\frac{dF_{XY}}{dX} \\ge 0$。因此，$\\frac{dY^\\ast}{dX} \\ge 0$。\n\n综合这些结果，$\\frac{dZ^\\ast}{dX}$ 的表达式由非负项乘积之和组成，所有项再乘以一个正常数：\n$$\n\\frac{dZ^\\ast}{dX} = \\underbrace{\\left(\\frac{k_Z}{\\gamma_Z}\\right)}_{>0} \\bigg[ \\underbrace{\\frac{dG_{XZ}}{dX}}_{\\ge 0} \\underbrace{H_{YZ}(Y^\\ast)}_{\\ge 0} + \\underbrace{G_{XZ}(X)}_{\\ge 0} \\underbrace{\\frac{dH_{YZ}}{dY^\\ast}}_{\\ge 0} \\underbrace{\\frac{dY^\\ast}{dX}}_{\\ge 0} \\bigg] \\ge 0\n$$\n对于所有 $X \\ge 0$，导数 $\\frac{dZ^\\ast}{dX}$ 均为非负。\n\n**关于单调性的结论：**\n由于对于所有非负的 $X$，$\\frac{dZ^\\ast}{dX} \\ge 0$，因此输出蛋白的稳态浓度 $Z^\\ast$ 是输入信号 $X$ 的一个单调不减函数。这种行为是所有调控相互作用均为激活型的一致性前馈环路的一个标志性特征。由乘法启动子函数实现的与门逻辑不会引入非单调性；它仅仅要求直接路径 ($X \\to Z$) 和间接路径 ($X \\to Y \\to Z$) 都被充分激活才能产生强烈的输出响应，但总体的输入-输出特性仍然保持单调。",
            "answer": "$$\n\\boxed{\\frac{k_Z}{\\gamma_Z} \\left( \\frac{X^{n_{XZ}}}{K_{XZ}^{\\,n_{XZ}}+X^{n_{XZ}}} \\right) \\left( \\frac{\\left(\\frac{k_Y}{\\gamma_Y} \\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}}\\right)^{n_{YZ}}}{K_{YZ}^{\\,n_{YZ}} + \\left(\\frac{k_Y}{\\gamma_Y} \\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}}\\right)^{n_{YZ}}} \\right)}\n$$"
        },
        {
            "introduction": "除了稳态特性，基因回路的动态响应——即它如何随时间对变化的输入做出反应——对其生物学功能至关重要。本练习聚焦于相干前馈环（C1-FFL）与AND逻辑相结合时表现出的一个关键动力学特性：符号敏感延迟（sign-sensitive delay）。通过使用阶跃函数近似来简化希尔函数，你将能够解析地推导出系统的开启和关闭时间，从而深入理解网络结构是如何决定其对信号激活和撤销的不同响应速度的。",
            "id": "3912734",
            "problem": "考虑一个合成基因调控网络中的相干1型前馈环（FFL），其中上游转录因子 $X$ 直接激活靶标 $Z$，同时也激活一个中间转录因子 $Y$，而 $Y$ 再激活 $Z$。$Z$ 启动子处的整合是一个“与”门：$Z$ 的激活需要 $X$ 和 $Y$ 都达到足够高的水平。使用分子生物学的中心法则（DNA转录为RNA并翻译为蛋白质）和蛋白质浓度动态的标准质量作用型常微分方程（ODE），以及希尔型调控函数，作为建模基础。\n\n设 $u(t)$ 为一个控制 $X$ 生产的二元输入，在诱导期间，当 $t  0$ 时 $u(t)=0$，当 $t \\ge 0$ 时 $u(t)=1$；在去诱导期间，当 $t  0$ 时 $u(t)=1$，当 $t \\ge 0$ 时 $u(t)=0$。分别用 $\\alpha_X$ 和 $\\gamma_X$ 表示 $X$ 的合成速率和一级降解速率，用 $\\alpha_Y$ 和 $\\gamma_Y$ 表示 $Y$ 的相应速率。$X$ 和 $Y$ 的动态由以下方程建模：\n$$\n\\frac{dX}{dt} = \\alpha_X\\,u(t) - \\gamma_X\\,X,\n$$\n$$\n\\frac{dY}{dt} = \\alpha_Y\\,H_X(X) - \\gamma_Y\\,Y.\n$$\n此处 $H_X(X)$ 是 $X$ 对 $Y$ 的希尔激活函数。设 $K_{XY}$ 为 $X$ 对 $Y$ 的激活阈值，$K_{ZX}$ 和 $K_{ZY}$ 分别为 $X$ 和 $Y$ 对 $Z$ 的激活阈值。假设所有调控相互作用都具有强协同性，因此希尔函数可以近似为亥维赛德阶跃函数，例如 $H_X(X)\\approx \\Theta(X-K_{XY})$，$Z$ 处的“与”门可以近似为两个亥维赛德函数的乘积，即只有当 $\\Theta(X-K_{ZX})\\,\\Theta(Y-K_{ZY})=1$ 时，$Z$ 才被产生。亥维赛德阶跃函数 $\\Theta(\\cdot)$ 定义为：当 $s \\ge 0$ 时 $\\Theta(s)=1$，当 $s  0$ 时 $\\Theta(s)=0$。\n\n假设在切换输入之前，系统已达到稳态：对于诱导（在 $t=0$ 时 $u$ 从 $0\\to 1$ 切换），初始条件为 $X(0)=0$ 和 $Y(0)=0$；对于去诱导（在 $t=0$ 时 $u$ 从 $1\\to 0$ 切换），在 $t=0^{-}$ 时的初始条件为 $X(0^{-})=\\alpha_X/\\gamma_X$ 和 $Y(0^{-})=\\alpha_Y/\\gamma_Y$。定义 $X_{\\infty}=\\alpha_X/\\gamma_X$ 和 $Y_{\\infty}=\\alpha_Y/\\gamma_Y$。\n\n为实现相干1型前馈环在“与”门整合下典型的符号敏感延迟，施加以下参数体系：\n- $\\gamma_X \\gg \\gamma_Y$（$X$ 分支比 $Y$ 分支响应更快），\n- $0  K_{XY} \\le K_{ZX}  X_{\\infty}$ 和 $K_{ZY}  Y_{\\infty}$。\n\n推导 $Z$ 生产的开启时间 $t_{\\text{on}}$ 与关闭时间 $t_{\\text{off}}$ 的比率 $R = t_{\\text{on}}/t_{\\text{off}}$ 的闭式符号表达式。你的答案应表示为给定参数的函数。不需要进行数值计算，也不需要单位。",
            "solution": "问题要求计算在一个具有“与”门逻辑的相干1型前馈环（C1-FFL）中，蛋白质 $Z$ 的开启时间（$t_{\\text{on}}$）与关闭时间（$t_{\\text{off}}$）的比率。我们将首先分别推导 $t_{\\text{on}}$ 和 $t_{\\text{off}}$ 的表达式，然后计算它们的比率。该分析依赖于在希尔函数表现为亥维赛德阶跃函数的简化假设下，求解给定的常微分方程（ODE）。\n\n### 第1部分：开启时间 $t_{\\text{on}}$ 的推导（诱导）\n\n对于诱导情景，输入 $u(t)$ 在 $t=0$ 时从 $0$ 切换到 $1$。初始条件为 $X(0)=0$ 和 $Y(0)=0$。\n\n转录因子 $X$ 的动态由以下方程控制：\n$$\n\\frac{dX}{dt} = \\alpha_X - \\gamma_X X, \\quad X(0)=0\n$$\n这是一个一阶线性常微分方程。其解为：\n$$\nX(t) = \\frac{\\alpha_X}{\\gamma_X}(1 - \\exp(-\\gamma_X t)) = X_{\\infty}(1 - \\exp(-\\gamma_X t))\n$$\n其中 $X_{\\infty} = \\alpha_X/\\gamma_X$ 是 $X$ 的稳态浓度。\n\n中间因子 $Y$ 的动态由下式给出：\n$$\n\\frac{dY}{dt} = \\alpha_Y H_X(X) - \\gamma_Y Y, \\quad Y(0)=0\n$$\n使用阶跃函数近似 $H_X(X) \\approx \\Theta(X - K_{XY})$，$Y$ 的产生仅在 $X$ 的浓度超过阈值 $K_{XY}$ 时启动。我们来求这个事件发生的时间 $t_{XY}$：\n$$\nX(t_{XY}) = K_{XY} \\implies K_{XY} = X_{\\infty}(1 - \\exp(-\\gamma_X t_{XY}))\n$$\n求解 $t_{XY}$：\n$$\n\\exp(-\\gamma_X t_{XY}) = 1 - \\frac{K_{XY}}{X_{\\infty}} = \\frac{X_{\\infty}-K_{XY}}{X_{\\infty}}\n$$\n$$\nt_{XY} = -\\frac{1}{\\gamma_X}\\ln\\left(1 - \\frac{K_{XY}}{X_{\\infty}}\\right) = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right)\n$$\n对于 $0 \\le t  t_{XY}$，$X(t)  K_{XY}$，所以 $\\Theta(X(t)-K_{XY})=0$。$Y$ 的常微分方程变为 $\\frac{dY}{dt} = -\\gamma_Y Y$。由于 $Y(0)=0$，此区间内的解为 $Y(t)=0$。\n\n对于 $t \\ge t_{XY}$，$X(t) \\ge K_{XY}$，所以 $\\Theta(X(t)-K_{XY})=1$。$Y$ 的常微分方程变为：\n$$\n\\frac{dY}{dt} = \\alpha_Y - \\gamma_Y Y\n$$\n我们用初始条件 $Y(t_{XY})=0$ 来解这个常微分方程。解是：\n$$\nY(t) = \\frac{\\alpha_Y}{\\gamma_Y}(1 - \\exp(-\\gamma_Y (t - t_{XY}))) = Y_{\\infty}(1 - \\exp(-\\gamma_Y (t - t_{XY})))\n$$\n\n当 $X(t) \\ge K_{ZX}$ 和 $Y(t) \\ge K_{ZY}$ 同时满足时，$Z$ 的生产被开启。开启时间 $t_{\\text{on}}$ 是两个条件都满足的第一个时间 $t \\ge 0$。设 $t_{ZX}$ 是 $X(t) = K_{ZX}$ 的时间，$t_{ZY}$ 是 $Y(t) = K_{ZY}$ 的时间。\n$$\nt_{\\text{on}} = \\max(t_{ZX}, t_{ZY})\n$$\n求解 $t_{ZX}$：\n$$\nX(t_{ZX}) = K_{ZX} \\implies K_{ZX} = X_{\\infty}(1 - \\exp(-\\gamma_X t_{ZX}))\n$$\n$$\nt_{ZX} = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{ZX}}\\right)\n$$\n求解 $t_{ZY}$：\n$$\nY(t_{ZY}) = K_{ZY} \\implies K_{ZY} = Y_{\\infty}(1 - \\exp(-\\gamma_Y (t_{ZY} - t_{XY})))\n$$\n$$\nt_{ZY} - t_{XY} = \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)\n$$\n$$\nt_{ZY} = t_{XY} + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right) = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right) + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)\n$$\n问题陈述中提到 $\\gamma_X \\gg \\gamma_Y$，这意味着 $X$ 动态的特征时间尺度（$1/\\gamma_X$）远小于 $Y$ 动态的特征时间尺度（$1/\\gamma_Y$）。这表明 $t_{ZY}$ 表达式中的第二项占主导地位，使得 $t_{ZY}$ 显著大于 $t_{ZX}$。因此，开启过程受较慢的 $Y$ 通路限制。所以，$t_{\\text{on}} = t_{ZY}$。\n$$\nt_{\\text{on}} = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right) + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)\n$$\n\n### 第2部分：关闭时间 $t_{\\text{off}}$ 的推导（去诱导）\n\n对于去诱导情景，输入 $u(t)$ 在 $t=0$ 时从 $1$ 切换到 $0$。初始条件是 ON 状态下的稳态值：$X(0)=X_{\\infty}$ 和 $Y(0)=Y_{\\infty}$。\n\n对于 $t \\ge 0$，$X$ 的动态由以下方程控制：\n$$\n\\frac{dX}{dt} = -\\gamma_X X, \\quad X(0)=X_{\\infty}\n$$\n解是一个指数衰减：\n$$\nX(t) = X_{\\infty}\\exp(-\\gamma_X t)\n$$\n$Y$ 的动态仍由 $\\frac{dY}{dt} = \\alpha_Y \\Theta(X - K_{XY}) - \\gamma_Y Y$ 描述。在 $t=0$ 时，$X(0)=X_{\\infty}  K_{XY}$，所以 $Y$ 仍在生产。这种情况一直持续到 $X(t)$ 下降到 $K_{XY}$ 以下。设 $t'_{XY}$ 为这种情况发生的时间：\n$$\nX(t'_{XY}) = K_{XY} \\implies K_{XY} = X_{\\infty}\\exp(-\\gamma_X t'_{XY})\n$$\n$$\nt'_{XY} = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{XY}}\\right)\n$$\n对于 $0 \\le t  t'_{XY}$，$\\frac{dY}{dt} = \\alpha_Y - \\gamma_Y Y$。由于初始条件是 $Y(0)=Y_{\\infty}=\\alpha_Y/\\gamma_Y$，我们有 $\\frac{dY}{dt}=0$，因此在此区间内 $Y(t)=Y_{\\infty}$。\n\n对于 $t \\ge t'_{XY}$，$X(t)  K_{XY}$，所以 $Y$ 的生产停止。常微分方程变为：\n$$\n\\frac{dY}{dt} = -\\gamma_Y Y\n$$\n我们用初始条件 $Y(t'_{XY})=Y_{\\infty}$ 来解这个方程。解是：\n$$\nY(t) = Y_{\\infty}\\exp(-\\gamma_Y (t - t'_{XY}))\n$$\n当 $X(t)  K_{ZX}$ 或 $Y(t)  K_{ZY}$ 时，$Z$ 的生产停止。关闭时间 $t_{\\text{off}}$ 是这些条件中至少有一个满足的第一个时间 $t \\ge 0$。设 $t'_{ZX}$ 是 $X(t) = K_{ZX}$ 的时间，$t'_{ZY}$ 是 $Y(t) = K_{ZY}$ 的时间。\n$$\nt_{\\text{off}} = \\min(t'_{ZX}, t'_{ZY})\n$$\n求解 $t'_{ZX}$：\n$$\nX(t'_{ZX}) = K_{ZX} \\implies K_{ZX} = X_{\\infty}\\exp(-\\gamma_X t'_{ZX})\n$$\n$$\nt'_{ZX} = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)\n$$\n求解 $t'_{ZY}$：\n$$\nY(t'_{ZY}) = K_{ZY} \\implies K_{ZY} = Y_{\\infty}\\exp(-\\gamma_Y (t'_{ZY} - t'_{XY}))\n$$\n$$\nt'_{ZY} - t'_{XY} = \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{K_{ZY}}\\right)\n$$\n$$\nt'_{ZY} = t'_{XY} + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{K_{ZY}}\\right) = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{XY}}\\right) + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{K_{ZY}}\\right)\n$$\n为了找到 $t_{\\text{off}}$，我们比较 $t'_{ZX}$ 和 $t'_{ZY}$。根据给定条件，$K_{XY} \\le K_{ZX}$。这意味着 $\\frac{X_{\\infty}}{K_{XY}} \\ge \\frac{X_{\\infty}}{K_{ZX}}$，因此 $\\ln\\left(\\frac{X_{\\infty}}{K_{XY}}\\right) \\ge \\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)$。\n那么，$t'_{ZY}$ 的第一项大于或等于 $t'_{ZX}$：\n$$\n\\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{XY}}\\right) \\ge \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right) = t'_{ZX}\n$$\n由于 $t'_{ZY}$ 中的第二项是正的（因为 $K_{ZY}  Y_\\infty$），所以可以肯定 $t'_{ZY}  t'_{ZX}$。因此，这两个时间中的最小值是 $t'_{ZX}$。关闭过程由快速的直接通路 $X \\to Z$ 决定。\n$$\nt_{\\text{off}} = t'_{ZX} = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)\n$$\n\n### 第3部分：比率 $R$ 的计算\n\n比率 $R$ 定义为 $t_{\\text{on}}/t_{\\text{off}}$。代入推导出的表达式：\n$$\nR = \\frac{t_{\\text{on}}}{t_{\\text{off}}} = \\frac{\\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right) + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)}{\\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)}\n$$\n分子和分母同乘以 $\\gamma_X$：\n$$\nR = \\frac{\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right) + \\frac{\\gamma_X}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)}{\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)}\n$$\n这就是比率 $R$ 的最终闭式符号表达式。",
            "answer": "$$\n\\boxed{\\frac{\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right) + \\frac{\\gamma_X}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)}{\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)}}\n$$"
        },
        {
            "introduction": "真实的生物过程，尤其是基因表达，本质上是随机的，这意味着确定性模型（如常微分方程）只能描述系统平均行为。为了更全面地理解基因回路，我们必须考虑噪声的影响。本练习将引导你从确定性描述过渡到随机模型，使用化学主方程（CME）和线性噪声近似（LNA）来分析前馈环中的噪声传播。通过计算输出蛋白 $Z$ 的法诺因子（Fano factor），你将量化其表达的波动性，并探究网络拓扑如何塑造输出噪声的特性。",
            "id": "3912657",
            "problem": "考虑一个转录前馈环路，其中上游转录因子 $X$ 保持恒定，两个下游物种 $Y$ 和 $Z$ 受化学主方程 (CME) 控制，其生灭反应的倾向函数是标准的希尔函数。物种 $Y$ 直接受 $X$ 调控，而物种 $Z$ 通过一个乘法门同时受 $X$ 和 $Y$ 的调控。该系统由以下反应和倾向函数定义：\n- $Y$ 的生成：$Y \\to Y + 1$，倾向函数为 $a_1(Y;X) = k_Y \\, h_X(X)$。\n- $Y$ 的降解：$Y \\to Y - 1$，倾向函数为 $a_2(Y) = \\gamma_Y \\, Y$。\n- $Z$ 的生成：$Z \\to Z + 1$，倾向函数为 $a_3(Y,Z;X) = k_Z \\, h_X(X) \\, h_Y(Y)$。\n- $Z$ 的降解：$Z \\to Z - 1$，倾向函数为 $a_4(Z) = \\gamma_Z \\, Z$。\n\n此处 $k_Y$ 和 $k_Z$ 是生成速率常数，单位为分子/单位时间；$\\gamma_Y$ 和 $\\gamma_Z$ 是降解速率常数，单位为时间的倒数。上游的 $X$ 是一个恒定的分子数。希尔函数代表调控作用：\n- $X$ 的激活作用：$h_X(X) = \\dfrac{X^{n_X}}{K_X^{n_X} + X^{n_X}}$，其中 $K_X  0$ 且 $n_X \\ge 1$。\n- $Y$ 的调控作用可以是激活或抑制：\n  - 激活：$h_Y(Y) = \\dfrac{Y^{n_Y}}{K_Y^{n_Y} + Y^{n_Y}}$，其中 $K_Y  0$ 且 $n_Y \\ge 1$。\n  - 抑制：$h_Y(Y) = \\dfrac{K_Y^{n_Y}}{K_Y^{n_Y} + Y^{n_Y}}$，其中 $K_Y  0$ 且 $n_Y \\ge 1$。\n\n从 CME 出发，仅使用随机化学动力学中经过充分检验的基础近似方法，推导并计算在 $X$ 恒定的稳态条件下 $Z$ 的稳态 Fano 因子，其定义为 $F_Z = \\dfrac{\\mathrm{Var}(Z)}{\\mathbb{E}[Z]}$。你的推导必须从 CME 开始，通过一个合适的近似方法得到围绕确定性不动点的涨落的线性方程，然后获得一个依赖于不动点值和倾向函数局部灵敏度的 $F_Z$ 的闭式表达式。不要模拟轨迹；请根据所选近似方法的第一性原理，解析地计算 $F_Z$。\n\n你的程序必须实现推导出的表达式，并对以下参数集测试套件计算 $F_Z$。在每种情况下，$X$ 都是恒定的，门 $h_Y$ 如指定的那样，是激活或抑制。所有参数都是标量，希尔指数是整数。\n\n测试套件（每种情况以 $(k_Y,\\gamma_Y,k_Z,\\gamma_Z,K_X,n_X,K_Y,n_Y,X,\\text{门类型})$ 列出）：\n- 情况 1（相干，中等激活）：$(50.0, 1.0, 40.0, 1.5, 100.0, 2, 50.0, 2, 80.0, \\text{激活})$。\n- 情况 2（相干，$Y \\to Z$ 环节接近饱和）：$(500.0, 1.0, 300.0, 2.0, 10.0, 2, 1.0, 2, 100.0, \\text{激活})$。\n- 情况 3（相干，弱表达边缘情况）：$(5.0, 1.0, 1.0, 2.0, 10.0, 3, 20.0, 2, 2.0, \\text{激活})$。\n- 情况 4（非相干，$Y$ 抑制 $Z$）：$(80.0, 1.2, 60.0, 1.0, 50.0, 2, 30.0, 2, 70.0, \\text{抑制})$。\n\n对于每种情况，计算稳态 Fano 因子 $F_Z$ 并以浮点数表示。你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个浮点数必须四舍五入到六位小数。例如，包含三个结果的输出应形如 $[\\text{r}_1,\\text{r}_2,\\text{r}_3]$，其中每个 $\\text{r}_i$ 是一个小数点后有六位数字的十进制数。最终输出是无量纲的；输出中不需要物理单位。",
            "solution": "该问题要求在特定的前馈环路网络拓扑中，推导并计算物种 $Z$ 的稳态 Fano 因子 $F_Z = \\mathrm{Var}(Z)/\\mathbb{E}[Z]$。该系统受化学主方程 (CME) 控制，其倾向函数由希尔型调控定义。推导必须从 CME 开始，并使用一种成熟的近似方法来分析围绕确定性稳态的涨落。完成此任务最合适且最严谨的方法是线性噪声近似 (LNA)。LNA 通过在宏观确定性稳态附近对系统动力学进行线性化，提供了一种系统性计算物种浓度均值和协方差的方法。\n\n首先，我们通过将分子数 $Y$ 和 $Z$ 视为连续变量来建立宏观速率方程。它们的期望值 $\\langle Y \\rangle$ 和 $\\langle Z \\rangle$ 的时间演化由以下常微分方程 (ODE) 系统近似：\n$$\n\\frac{d\\langle Y \\rangle}{dt} = k_Y \\, h_X(X) - \\gamma_Y \\langle Y \\rangle\n$$\n$$\n\\frac{d\\langle Z \\rangle}{dt} = k_Z \\, h_X(X) \\, h_Y(\\langle Y \\rangle) - \\gamma_Z \\langle Z \\rangle\n$$\n由于上游转录因子 $X$ 保持恒定，对于任何给定的参数集，$h_X(X)$ 项都是一个常数值。在稳态下，时间导数为零。设稳态分子数为 $\\bar{Y}$ 和 $\\bar{Z}$。它们可以通过求解以下代数方程得到：\n$$\n0 = k_Y \\, h_X(X) - \\gamma_Y \\bar{Y} \\implies \\bar{Y} = \\frac{k_Y}{\\gamma_Y} h_X(X)\n$$\n$$\n0 = k_Z \\, h_X(X) \\, h_Y(\\bar{Y}) - \\gamma_Z \\bar{Z} \\implies \\bar{Z} = \\frac{k_Z}{\\gamma_Z} h_X(X) h_Y(\\bar{Y})\n$$\n量 $\\bar{Y}$ 和 $\\bar{Z}$ 分别是稳态均值 $\\mathbb{E}[Y]$ 和 $\\mathbb{E}[Z]$ 的 LNA 近似。希尔函数 $h_X(X)$ 由 $h_X(X) = \\frac{X^{n_X}}{K_X^{n_X} + X^{n_X}}$ 给出。函数 $h_Y(\\bar{Y})$ 取决于调控类型：激活时为 $h_Y(\\bar{Y}) = \\frac{\\bar{Y}^{n_Y}}{K_Y^{n_Y} + \\bar{Y}^{n_Y}}$，抑制时为 $h_Y(\\bar{Y}) = \\frac{K_Y^{n_Y}}{K_Y^{n_Y} + \\bar{Y}^{n_Y}}$。\n\n接下来，我们分析围绕该稳态的涨落。LNA 断言，对于大系统尺寸，涨落的协方差矩阵 $\\mathbf{C} = \\mathrm{Cov}(Y,Z)$ 在稳态时满足连续李雅普诺夫方程 (continuous Lyapunov equation)：\n$$\n\\mathbf{J} \\mathbf{C} + \\mathbf{C} \\mathbf{J}^T + \\mathbf{D} = 0\n$$\n此处，$\\mathbf{J}$ 是宏观速率方程的雅可比矩阵，$\\mathbf{D}$ 是扩散矩阵，两者都在稳态 $(\\bar{Y}, \\bar{Z})$ 处求值。\n\n雅可比矩阵 $\\mathbf{J}$ 定义为：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial}{\\partial Y}(k_Y h_X(X) - \\gamma_Y Y)  \\frac{\\partial}{\\partial Z}(k_Y h_X(X) - \\gamma_Y Y) \\\\ \\frac{\\partial}{\\partial Y}(k_Z h_X(X) h_Y(Y) - \\gamma_Z Z)  \\frac{\\partial}{\\partial Z}(k_Z h_X(X) h_Y(Y) - \\gamma_Z Z) \\end{pmatrix}_{(\\bar{Y}, \\bar{Z})}\n$$\n计算偏导数并在稳态处求值，得到：\n$$\n\\mathbf{J} = \\begin{pmatrix} -\\gamma_Y  0 \\\\ k_Z h_X(X) \\left. \\frac{dh_Y}{dY} \\right|_{Y=\\bar{Y}}  -\\gamma_Z \\end{pmatrix}\n$$\n我们将 $Y \\to Z$ 相互作用的弹性定义为 $\\epsilon_Y = \\left. \\frac{Y}{h_Y(Y)} \\frac{dh_Y}{dY} \\right|_{Y=\\bar{Y}}$。对于给定的希尔函数，该弹性可表示为 $\\epsilon_Y = \\sigma n_Y (1 - h_Y(\\bar{Y}))$，其中激活时 $\\sigma=+1$，抑制时 $\\sigma=-1$。\n雅可比矩阵的 $(2,1)$ 分量 $J_{21}$ 可以使用 $\\epsilon_Y$ 和稳态关系 $\\bar{Z} = \\frac{k_Z}{\\gamma_Z} h_X(X) h_Y(\\bar{Y})$ 重写为：\n$$\nJ_{21} = k_Z h_X(X) \\frac{h_Y(\\bar{Y})}{\\bar{Y}} \\epsilon_Y = \\frac{\\gamma_Z \\bar{Z}}{\\bar{Y}} \\epsilon_Y\n$$\n因此雅可比矩阵为：\n$$\n\\mathbf{J} = \\begin{pmatrix} -\\gamma_Y  0 \\\\ \\frac{\\gamma_Z \\bar{Z}}{\\bar{Y}} \\epsilon_Y  -\\gamma_Z \\end{pmatrix}\n$$\n\n扩散矩阵 $\\mathbf{D}$ 由 $\\mathbf{D} = \\mathbf{S} \\, \\text{diag}(\\mathbf{a}(\\bar{Y}, \\bar{Z})) \\, \\mathbf{S}^T$ 给出，其中 $\\mathbf{S}$ 是化学计量矩阵，$\\mathbf{a}$ 是倾向函数向量。\n化学计量矩阵为 $\\mathbf{S} = \\begin{pmatrix} 1  -1  0  0 \\\\ 0  0  1  -1 \\end{pmatrix}$。在稳态处求值的倾向函数为 $a_1 = a_2 = \\gamma_Y \\bar{Y}$ 和 $a_3 = a_4 = \\gamma_Z \\bar{Z}$。\n$$\n\\mathbf{D} = \\begin{pmatrix} a_1+a_2  0 \\\\ 0  a_3+a_4 \\end{pmatrix} = \\begin{pmatrix} 2\\gamma_Y \\bar{Y}  0 \\\\ 0  2\\gamma_Z \\bar{Z} \\end{pmatrix}\n$$\n协方差矩阵是对称的，$\\mathbf{C} = \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{12}  C_{22} \\end{pmatrix}$，其中 $C_{11} = \\mathrm{Var}(Y)$，$C_{22} = \\mathrm{Var}(Z)$，且 $C_{12} = \\mathrm{Cov}(Y, Z)$。展开李雅普诺夫方程 $\\mathbf{J}\\mathbf{C} + \\mathbf{C}\\mathbf{J}^T = -\\mathbf{D}$ 得到关于 $\\mathbf{C}$ 各分量的线性方程组：\n1. $(1,1)$ 分量：$-2\\gamma_Y C_{11} = -D_{11} = -2\\gamma_Y \\bar{Y} \\implies C_{11} = \\bar{Y}$。这正确地表明 $Y$ 的 Fano 因子为 1，这对于一个简单的生灭过程是符合预期的。\n2. $(1,2)$ 分量：$-\\gamma_Y C_{12} + J_{21}C_{11} - \\gamma_Z C_{12} = 0 \\implies C_{12}(\\gamma_Y + \\gamma_Z) = J_{21} C_{11}$。\n$$\nC_{12} = \\frac{J_{21} C_{11}}{\\gamma_Y + \\gamma_Z} = \\frac{J_{21} \\bar{Y}}{\\gamma_Y + \\gamma_Z} = \\frac{(\\frac{\\gamma_Z \\bar{Z}}{\\bar{Y}} \\epsilon_Y) \\bar{Y}}{\\gamma_Y + \\gamma_Z} = \\frac{\\gamma_Z \\bar{Z} \\epsilon_Y}{\\gamma_Y + \\gamma_Z}\n$$\n3. $(2,2)$ 分量：$2J_{21} C_{12} - 2\\gamma_Z C_{22} = -D_{22} = -2\\gamma_Z \\bar{Z} \\implies \\gamma_Z C_{22} = J_{21} C_{12} + \\gamma_Z \\bar{Z}$。\n$$\nC_{22} = \\bar{Z} + \\frac{J_{21} C_{12}}{\\gamma_Z}\n$$\n代入 $J_{21}$ 和 $C_{12}$ 的表达式：\n$$\nC_{22} = \\bar{Z} + \\frac{1}{\\gamma_Z} \\left(\\frac{\\gamma_Z \\bar{Z}}{\\bar{Y}} \\epsilon_Y\\right) \\left(\\frac{\\gamma_Z \\bar{Z} \\epsilon_Y}{\\gamma_Y + \\gamma_Z}\\right) = \\bar{Z} + \\frac{\\gamma_Z \\bar{Z}^2 \\epsilon_Y^2}{\\bar{Y}(\\gamma_Y + \\gamma_Z)}\n$$\n这就是 $Z$ 的方差的 LNA 表达式。\n\n最后，$Z$ 的 Fano 因子 $F_Z$ 是方差除以均值：\n$$\nF_Z = \\frac{C_{22}}{\\bar{Z}} = \\frac{\\bar{Z} + \\frac{\\gamma_Z \\bar{Z}^2 \\epsilon_Y^2}{\\bar{Y}(\\gamma_Y + \\gamma_Z)}}{\\bar{Z}}\n$$\n$$\nF_Z = 1 + \\frac{\\gamma_Z \\bar{Z} \\epsilon_Y^2}{\\bar{Y}(\\gamma_Y + \\gamma_Z)}\n$$\n这个最终的闭式表达式将被用于实现计算每个测试用例的 Fano 因子。总体算法如下：对于给定的参数集，首先计算稳态均值 $\\bar{Y}$ 和 $\\bar{Z}$，然后计算弹性 $\\epsilon_Y$，最后将这些值代入推导出的 $F_Z$ 公式中。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the stationary Fano factor of Z for a series of test cases\n    based on the Linear Noise Approximation of a feed-forward loop model.\n    \"\"\"\n    test_cases = [\n        # (k_Y, gamma_Y, k_Z, gamma_Z, K_X, n_X, K_Y, n_Y, X, gate)\n        (50.0, 1.0, 40.0, 1.5, 100.0, 2, 50.0, 2, 80.0, 'activation'),\n        (500.0, 1.0, 300.0, 2.0, 10.0, 2, 1.0, 2, 100.0, 'activation'),\n        (5.0, 1.0, 1.0, 2.0, 10.0, 3, 20.0, 2, 2.0, 'activation'),\n        (80.0, 1.2, 60.0, 1.0, 50.0, 2, 30.0, 2, 70.0, 'repression'),\n    ]\n\n    results = []\n    for case in test_cases:\n        k_Y, gamma_Y, k_Z, gamma_Z, K_X, n_X, K_Y, n_Y, X, gate_type = case\n        \n        # Step 1: Calculate h_X(X)\n        h_X_val = (X**n_X) / (K_X**n_X + X**n_X)\n        \n        # Step 2: Calculate the steady-state mean of Y\n        Y_bar = (k_Y / gamma_Y) * h_X_val\n        \n        # Step 3: Calculate h_Y(Y_bar) based on gate type\n        if gate_type == 'activation':\n            sigma = 1.0\n            h_Y_val = (Y_bar**n_Y) / (K_Y**n_Y + Y_bar**n_Y)\n        elif gate_type == 'repression':\n            sigma = -1.0\n            h_Y_val = (K_Y**n_Y) / (K_Y**n_Y + Y_bar**n_Y)\n        else:\n            raise ValueError(\"Invalid gate type specified.\")\n            \n        # Step 4: Calculate the steady-state mean of Z\n        # Handle potential underflow if h_Y_val is extremely small\n        if Y_bar == 0 and h_X_val == 0:\n            Z_bar = 0.0\n        else:\n            Z_bar = (k_Z / gamma_Z) * h_X_val * h_Y_val\n\n        # Step 5: Calculate the elasticity epsilon_Y\n        # For repression, 1 - h_Y is Y^n / (K^n + Y^n), which is used in the elasticity formula.\n        # The expression sigma * n_Y * (1-h_Y) works for both cases.\n        if Y_bar > 0:\n             # This is the derived expression for elasticity\n             epsilon_Y = sigma * n_Y * (1.0 - h_Y_val)\n        else:\n             # Handle the edge case of Y_bar = 0.\n             # For activation, h_Y(0) = 0, so ε_Y limit is n_Y.\n             # For repression, h_Y(0) = 1, so ε_Y is 0.\n             if gate_type == 'activation':\n                 epsilon_Y = n_Y\n             else: # repression\n                 epsilon_Y = 0.0\n\n        # Step 6: Calculate the Fano factor of Z\n        # If Y_bar is 0, noise from Y cannot propagate. F_Z should be 1.\n        if Y_bar == 0 or Z_bar == 0:\n            F_Z = 1.0\n        else:\n            noise_propagation_term = (gamma_Z * Z_bar * epsilon_Y**2) / (Y_bar * (gamma_Y + gamma_Z))\n            F_Z = 1.0 + noise_propagation_term\n            \n        results.append(f\"{F_Z:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}