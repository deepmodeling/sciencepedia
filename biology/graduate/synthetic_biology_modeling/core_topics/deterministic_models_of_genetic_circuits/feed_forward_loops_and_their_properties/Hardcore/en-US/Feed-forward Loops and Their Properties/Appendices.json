{
    "hands_on_practices": [
        {
            "introduction": "This first practice focuses on the fundamental steady-state behavior of a coherent feed-forward loop (FFL). Before analyzing complex dynamics, it is crucial to understand the circuit's basic input-output characteristic. This exercise  will guide you through deriving the steady-state response of a type-1 coherent FFL (C1-FFL) with AND-gate logic, demonstrating its inherent monotonic nature, which forms the foundation for its more complex behaviors.",
            "id": "3912698",
            "problem": "Consider a coherent feed-forward loop (FFL) in a synthetic gene circuit in which an upstream transcription factor $X$ positively regulates an intermediate transcription factor $Y$ and a downstream gene $Z$, and $Y$ also positively regulates $Z$. Assume the ordinary differential equation (ODE) model for the concentrations $Y(t)$ and $Z(t)$, where $X$ is held constant at a nonnegative value, is given by\n$$\n\\frac{dY}{dt} \\;=\\; k_Y\\,F_{XY}(X)\\;-\\;\\gamma_Y\\,Y,\n\\qquad\n\\frac{dZ}{dt} \\;=\\; k_Z\\,G_{XZ}(X)\\,H_{YZ}(Y)\\;-\\;\\gamma_Z\\,Z,\n$$\nwhere $k_Y>0$ and $k_Z>0$ are maximal production rates, $\\gamma_Y>0$ and $\\gamma_Z>0$ are first-order degradation/dilution rates, and the regulatory functions are Hill-type activations defined by\n$$\nF_{XY}(X)\\;=\\;\\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}},\\qquad\nG_{XZ}(X)\\;=\\;\\frac{X^{n_{XZ}}}{K_{XZ}^{\\,n_{XZ}}+X^{n_{XZ}}},\\qquad\nH_{YZ}(Y)\\;=\\;\\frac{Y^{n_{YZ}}}{K_{YZ}^{\\,n_{YZ}}+Y^{n_{YZ}}},\n$$\nwith dissociation constants $K_{XY},K_{XZ},K_{YZ}>0$ and Hill coefficients $n_{XY},n_{XZ},n_{YZ}\\ge 1$. The downstream promoter for $Z$ implements logical AND between $X$ and $Y$ inputs (multiplicative integration of the two activation signals). This setup models a coherent activation-activation FFL.\n\nStarting from the fundamental modeling assumptions of synthesis and first-order loss (mass-action degradation/dilution) and monotone Hill-type activation functions, do the following:\n\n1. Derive the steady states $(Y^\\ast,Z^\\ast)$ as explicit functions of the constant input $X$ and the parameters.\n\n2. Using calculus and the chain rule, derive the sign of $\\frac{dZ^\\ast}{dX}$ as a function of $X$ and parameters, and conclude whether $Z^\\ast$ is monotone in $X$ for this coherent FFL with AND logic. Your reasoning must start from the definitions above and should not assume the result.\n\nExpress your final answer as a single closed-form analytic expression for $Z^\\ast(X)$ in terms of $X$ and the parameters. No numerical evaluation is required, and no units are needed.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n-   Ordinary differential equations (ODEs) for species concentrations $Y(t)$ and $Z(t)$:\n    $$\n    \\frac{dY}{dt} \\;=\\; k_Y\\,F_{XY}(X)\\;-\\;\\gamma_Y\\,Y\n    $$\n    $$\n    \\frac{dZ}{dt} \\;=\\; k_Z\\,G_{XZ}(X)\\,H_{YZ}(Y)\\;-\\;\\gamma_Z\\,Z\n    $$\n-   Input signal: $X$ is a constant, non-negative value ($X \\ge 0$).\n-   Kinetic parameters: $k_Y>0$, $k_Z>0$ (maximal production rates); $\\gamma_Y>0$, $\\gamma_Z>0$ (degradation/dilution rates).\n-   Regulatory functions (Hill-type activations):\n    $$\n    F_{XY}(X)\\;=\\;\\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}}\n    $$\n    $$\n    G_{XZ}(X)\\;=\\;\\frac{X^{n_{XZ}}}{K_{XZ}^{\\,n_{XZ}}+X^{n_{XZ}}}\n    $$\n    $$\n    H_{YZ}(Y)\\;=\\;\\frac{Y^{n_{YZ}}}{K_{YZ}^{\\,n_{YZ}}+Y^{n_{YZ}}}\n    $$\n-   Hill parameters: $K_{XY}, K_{XZ}, K_{YZ}>0$ (dissociation constants); $n_{XY}, n_{XZ}, n_{YZ}\\ge 1$ (Hill coefficients).\n-   Network topology and logic: Coherent feed-forward loop (FFL) with positive regulation paths $X \\to Y$, $X \\to Z$, and $Y \\to Z$. The regulation of $Z$ by $X$ and $Y$ implements logical AND via multiplicative interaction of the regulatory functions $G_{XZ}(X)$ and $H_{YZ}(Y)$.\n-   Tasks:\n    1.  Derive the steady states $(Y^\\ast,Z^\\ast)$ as explicit functions of $X$.\n    2.  Derive the sign of $\\frac{dZ^\\ast}{dX}$ and determine if $Z^\\ast$ is monotone in $X$.\n    3.  Provide the final closed-form expression for $Z^\\ast(X)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n-   **Scientifically Grounded:** The model is a standard representation of a coherent type-1 feed-forward loop (C1-FFL) in systems and synthetic biology. The ODEs are based on fundamental mass-action principles for protein synthesis and first-order degradation. The Hill functions are a widely accepted phenomenological model for transcriptional regulation. The problem is scientifically sound.\n-   **Well-Posed:** The problem is well-posed. For a constant input $X$, the ODE for $Y$ is linear and has a unique, stable steady state. Subsequently, the ODE for $Z$ also becomes a linear equation (with a time-independent forcing term once $Y$ reaches its steady state), leading to a unique, stable steady state for $Z$. The problem is self-contained and provides all necessary information to find a unique solution.\n-   **Objective:** The problem is stated using precise mathematical language, free from subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. The solution process will now proceed.\n\n### Solution Derivation\n\n**1. Steady-State Analysis**\n\nTo find the steady-state concentrations, denoted by $Y^\\ast$ and $Z^\\ast$, we set the time derivatives of the concentrations to zero.\n\nFor the concentration of $Y$, we have:\n$$\n\\frac{dY}{dt} = 0 \\implies k_Y\\,F_{XY}(X)\\;-\\;\\gamma_Y\\,Y^\\ast = 0\n$$\nSolving for $Y^\\ast$ as a function of the input $X$ and the system parameters gives:\n$$\nY^\\ast(X) = \\frac{k_Y}{\\gamma_Y}\\,F_{XY}(X) = \\frac{k_Y}{\\gamma_Y} \\left( \\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}} \\right)\n$$\nThis equation provides the explicit steady-state concentration of the intermediate transcription factor $Y$ as a function of the upstream input $X$.\n\nFor the concentration of $Z$, we set its time derivative to zero and evaluate it at the steady state of $Y$, which is $Y^\\ast$:\n$$\n\\frac{dZ}{dt} = 0 \\implies k_Z\\,G_{XZ}(X)\\,H_{YZ}(Y^\\ast)\\;-\\;\\gamma_Z\\,Z^\\ast = 0\n$$\nSolving for $Z^\\ast$ as a function of $X$ and $Y^\\ast$ yields:\n$$\nZ^\\ast(X) = \\frac{k_Z}{\\gamma_Z}\\,G_{XZ}(X)\\,H_{YZ}(Y^\\ast(X))\n$$\nTo obtain $Z^\\ast$ as an explicit function of only $X$ and the parameters, we substitute the expressions for $G_{XZ}(X)$, $H_{YZ}(Y^\\ast)$, and $Y^\\ast(X)$:\n$$\nZ^\\ast(X) = \\frac{k_Z}{\\gamma_Z} \\left( \\frac{X^{n_{XZ}}}{K_{XZ}^{\\,n_{XZ}}+X^{n_{XZ}}} \\right) \\left( \\frac{(Y^\\ast(X))^{n_{YZ}}}{K_{YZ}^{\\,n_{YZ}}+(Y^\\ast(X))^{n_{YZ}}} \\right)\n$$\nSubstituting the full expression for $Y^\\ast(X)$ results in the final analytical form for $Z^\\ast(X)$:\n$$\nZ^\\ast(X) = \\frac{k_Z}{\\gamma_Z} \\left( \\frac{X^{n_{XZ}}}{K_{XZ}^{\\,n_{XZ}}+X^{n_{XZ}}} \\right) \\left( \\frac{\\left(\\frac{k_Y}{\\gamma_Y} \\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}}\\right)^{n_{YZ}}}{K_{YZ}^{\\,n_{YZ}} + \\left(\\frac{k_Y}{\\gamma_Y} \\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}}\\right)^{n_{YZ}}} \\right)\n$$\nThis completes the first part of the task.\n\n**2. Monotonicity Analysis**\n\nTo determine if $Z^\\ast$ is a monotone function of $X$, we must find the sign of its derivative, $\\frac{dZ^\\ast}{dX}$. We start from the expression $Z^\\ast(X) = \\frac{k_Z}{\\gamma_Z}\\,G_{XZ}(X)\\,H_{YZ}(Y^\\ast(X))$.\n\nUsing the product rule and chain rule for differentiation with respect to $X$:\n$$\n\\frac{dZ^\\ast}{dX} = \\frac{k_Z}{\\gamma_Z} \\left[ \\frac{dG_{XZ}(X)}{dX} H_{YZ}(Y^\\ast(X)) + G_{XZ}(X) \\frac{d}{dX} \\left( H_{YZ}(Y^\\ast(X)) \\right) \\right]\n$$\n$$\n\\frac{dZ^\\ast}{dX} = \\frac{k_Z}{\\gamma_Z} \\left[ \\frac{dG_{XZ}}{dX} H_{YZ}(Y^\\ast) + G_{XZ}(X) \\frac{dH_{YZ}}{dY^\\ast} \\frac{dY^\\ast}{dX} \\right]\n$$\n\nNow, we analyze the sign of each term in this expression for $X \\ge 0$:\n-   Parameters: $k_Z > 0$ and $\\gamma_Z > 0$, so their ratio $\\frac{k_Z}{\\gamma_Z}$ is positive.\n-   Hill functions: The values of the Hill functions $G_{XZ}(X)$ and $H_{YZ}(Y^\\ast)$ are always non-negative for non-negative inputs. So, $G_{XZ}(X) \\ge 0$ and $H_{YZ}(Y^\\ast) \\ge 0$.\n-   Derivatives of Hill functions: Let $f(u) = \\frac{u^n}{K^n + u^n}$ be a generic Hill activation function with $n \\ge 1$, $K > 0$, and $u \\ge 0$. Its derivative is:\n    $$\n    \\frac{df}{du} = \\frac{n u^{n-1} (K^n + u^n) - u^n (n u^{n-1})}{(K^n + u^n)^2} = \\frac{n K^n u^{n-1}}{(K^n + u^n)^2}\n    $$\n    Since $n \\ge 1$, $K > 0$, and $u \\ge 0$, the derivative $\\frac{df}{du}$ is always non-negative ($\\ge 0$). Thus, all Hill activation functions are monotonically non-decreasing.\n-   Applying this to our functions:\n    -   $\\frac{dG_{XZ}}{dX} \\ge 0$\n    -   $\\frac{dH_{YZ}}{dY^\\ast} \\ge 0$\n-   Derivative of $Y^\\ast(X)$: The steady state $Y^\\ast$ is given by $Y^\\ast(X) = \\frac{k_Y}{\\gamma_Y} F_{XY}(X)$. We differentiate it with respect to $X$:\n    $$\n    \\frac{dY^\\ast}{dX} = \\frac{k_Y}{\\gamma_Y} \\frac{dF_{XY}}{dX}\n    $$\n    Since $\\frac{k_Y}{\\gamma_Y} > 0$ and $F_{XY}(X)$ is a Hill activation function, its derivative $\\frac{dF_{XY}}{dX} \\ge 0$. Therefore, $\\frac{dY^\\ast}{dX} \\ge 0$.\n\nCombining these results, the expression for $\\frac{dZ^\\ast}{dX}$ consists of a sum of products of non-negative terms, all multiplied by a positive constant:\n$$\n\\frac{dZ^\\ast}{dX} = \\underbrace{\\left(\\frac{k_Z}{\\gamma_Z}\\right)}_{>0} \\bigg[ \\underbrace{\\frac{dG_{XZ}}{dX}}_{\\ge 0} \\underbrace{H_{YZ}(Y^\\ast)}_{\\ge 0} + \\underbrace{G_{XZ}(X)}_{\\ge 0} \\underbrace{\\frac{dH_{YZ}}{dY^\\ast}}_{\\ge 0} \\underbrace{\\frac{dY^\\ast}{dX}}_{\\ge 0} \\bigg] \\ge 0\n$$\nThe derivative $\\frac{dZ^\\ast}{dX}$ is non-negative for all $X \\ge 0$.\n\n**Conclusion on Monotonicity:**\nSince $\\frac{dZ^\\ast}{dX} \\ge 0$ for all non-negative $X$, the steady-state concentration of the output protein, $Z^\\ast$, is a monotonically non-decreasing function of the input signal $X$. This behavior is a signature of coherent feed-forward loops where all regulatory interactions are activatory. The AND-gate logic, implemented by the multiplicative promoter function, does not introduce non-monotonicities; it simply requires both the direct pathway ($X \\to Z$) and the indirect pathway ($X \\to Y \\to Z$) to be sufficiently activated for a strong output response, but the overall input-output characteristic remains monotonic.",
            "answer": "$$\n\\boxed{\\frac{k_Z}{\\gamma_Z} \\left( \\frac{X^{n_{XZ}}}{K_{XZ}^{\\,n_{XZ}}+X^{n_{XZ}}} \\right) \\left( \\frac{\\left(\\frac{k_Y}{\\gamma_Y} \\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}}\\right)^{n_{YZ}}}{K_{YZ}^{\\,n_{YZ}} + \\left(\\frac{k_Y}{\\gamma_Y} \\frac{X^{n_{XY}}}{K_{XY}^{\\,n_{XY}}+X^{n_{XY}}}\\right)^{n_{YZ}}} \\right)}\n$$"
        },
        {
            "introduction": "Moving from static properties to dynamics, we now explore one of the most celebrated functions of the C1-FFL: sign-sensitive delay. This property, where the circuit's turn-on response is slower than its turn-off response, allows it to filter out transient noise while reacting quickly to the end of a sustained signal. In this problem , you will use analytical approximations to quantify these response times, revealing the mechanistic basis for this important filtering behavior.",
            "id": "3912734",
            "problem": "Consider a coherent type-1 feed-forward loop (FFL) in synthetic gene regulatory networks where an upstream transcription factor $X$ directly activates a target $Z$ and also activates an intermediate transcription factor $Y$, which in turn activates $Z$. The integration at the promoter of $Z$ is an AND gate: activation of $Z$ requires both $X$ and $Y$ to be sufficiently high. Use the Central Dogma of molecular biology (DNA transcribed to RNA and translated to protein) and standard mass-action style ordinary differential equations (ODEs) for protein concentration dynamics, together with Hill-type regulatory functions, as the modeling foundation.\n\nLet $u(t)$ be a binary input that controls the production of $X$, with $u(t)=0$ for $t<0$ and $u(t)=1$ for $t\\geq 0$ during induction, and $u(t)=1$ for $t<0$ and $u(t)=0$ for $t\\geq 0$ during de-induction. Denote by $\\alpha_X$ and $\\gamma_X$ the synthesis and first-order degradation rates of $X$, respectively, and by $\\alpha_Y$ and $\\gamma_Y$ those of $Y$, respectively. The dynamics of $X$ and $Y$ are modeled by\n$$\n\\frac{dX}{dt} = \\alpha_X\\,u(t) - \\gamma_X\\,X,\n$$\n$$\n\\frac{dY}{dt} = \\alpha_Y\\,H_X(X) - \\gamma_Y\\,Y.\n$$\nHere $H_X(X)$ is the Hill activation function of $Y$ by $X$. Let $K_{XY}$ be the activation threshold of $X$ on $Y$, $K_{ZX}$ and $K_{ZY}$ be the activation thresholds of $X$ and $Y$ on $Z$, respectively. Assume strong cooperativity for all regulatory interactions such that the Hill functions can be approximated by Heaviside step functions, for example $H_X(X)\\approx \\Theta(X-K_{XY})$, and the AND gate at $Z$ can be approximated by the product of two Heaviside functions, i.e., $Z$ is produced only when $\\Theta(X-K_{ZX})\\,\\Theta(Y-K_{ZY})=1$. The Heaviside step function $\\Theta(\\cdot)$ is defined by $\\Theta(s)=1$ for $s\\geq 0$ and $\\Theta(s)=0$ for $s<0$.\n\nAssume the system is allowed to reach steady state prior to switching the input: for induction ($u$ switches $0\\to 1$ at $t=0$), the initial conditions are $X(0)=0$ and $Y(0)=0$; for de-induction ($u$ switches $1\\to 0$ at $t=0$), the initial conditions at $t=0^{-}$ are $X(0^{-})=\\alpha_X/\\gamma_X$ and $Y(0^{-})=\\alpha_Y/\\gamma_Y$. Define $X_{\\infty}=\\alpha_X/\\gamma_X$ and $Y_{\\infty}=\\alpha_Y/\\gamma_Y$.\n\nImpose the following parameter regime to realize sign-sensitive delay typical of coherent type-1 feed-forward loops under AND integration:\n- $\\gamma_X \\gg \\gamma_Y$ (the $X$ branch responds faster than the $Y$ branch),\n- $0<K_{XY}\\leq K_{ZX}<X_{\\infty}$ and $0<K_{ZY}<Y_{\\infty}$ (thresholds are below steady-state levels, and the direct threshold to $Z$ for $X$ is at least as high as the threshold for $X$ to activate $Y$).\n\nUnder these assumptions and the step-function approximations, derive closed-form expressions for the approximate response times $t_{\\text{on}}$ and $t_{\\text{off}}$ of $Z$ for induction (the earliest time $t\\geq 0$ at which $Z$ begins to be produced) and de-induction (the earliest time $t\\geq 0$ at which $Z$ ceases to be produced), respectively. Then, compute the ratio\n$$\nR \\;=\\; \\frac{t_{\\text{on}}}{t_{\\text{off}}}.\n$$\n\nExpress your final answer for $R$ as a single closed-form symbolic expression in terms of $\\gamma_X$, $\\gamma_Y$, $X_{\\infty}$, $Y_{\\infty}$, $K_{XY}$, $K_{ZX}$, and $K_{ZY}$. Report $R$ as a dimensionless quantity. No numerical evaluation or rounding is required.",
            "solution": "The problem asks for the ratio of the turn-on time ($t_{\\text{on}}$) to the turn-off time ($t_{\\text{off}}$) for the protein $Z$ in a coherent type-1 feed-forward loop (C1-FFL) with AND-gate logic. We will first derive the expressions for $t_{\\text{on}}$ and $t_{\\text{off}}$ separately and then compute their ratio. The analysis relies on solving the given ordinary differential equations (ODEs) under the simplifying assumption that Hill functions behave as Heaviside step functions.\n\n### Part 1: Derivation of the turn-on time, $t_{\\text{on}}$ (Induction)\n\nFor the induction scenario, the input $u(t)$ switches from $0$ to $1$ at $t=0$. The initial conditions are $X(0)=0$ and $Y(0)=0$.\n\nThe dynamics of the transcription factor $X$ are governed by:\n$$\n\\frac{dX}{dt} = \\alpha_X - \\gamma_X X, \\quad X(0)=0\n$$\nThis is a first-order linear ODE. The solution is:\n$$\nX(t) = \\frac{\\alpha_X}{\\gamma_X}(1 - \\exp(-\\gamma_X t)) = X_{\\infty}(1 - \\exp(-\\gamma_X t))\n$$\nwhere $X_{\\infty} = \\alpha_X/\\gamma_X$ is the steady-state concentration of $X$.\n\nThe dynamics of the intermediate factor $Y$ are given by:\n$$\n\\frac{dY}{dt} = \\alpha_Y H_X(X) - \\gamma_Y Y, \\quad Y(0)=0\n$$\nUsing the step-function approximation, $H_X(X) \\approx \\Theta(X - K_{XY})$, the production of $Y$ initiates only when the concentration of $X$ crosses the threshold $K_{XY}$. Let's find the time $t_{XY}$ at which this occurs:\n$$\nX(t_{XY}) = K_{XY} \\implies K_{XY} = X_{\\infty}(1 - \\exp(-\\gamma_X t_{XY}))\n$$\nSolving for $t_{XY}$:\n$$\n\\exp(-\\gamma_X t_{XY}) = 1 - \\frac{K_{XY}}{X_{\\infty}} = \\frac{X_{\\infty}-K_{XY}}{X_{\\infty}}\n$$\n$$\nt_{XY} = -\\frac{1}{\\gamma_X}\\ln\\left(1 - \\frac{K_{XY}}{X_{\\infty}}\\right) = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right)\n$$\nFor $0 \\le t < t_{XY}$, $X(t) < K_{XY}$, so $\\Theta(X(t)-K_{XY})=0$. The ODE for $Y$ becomes $\\frac{dY}{dt} = -\\gamma_Y Y$. With $Y(0)=0$, the solution is $Y(t)=0$ in this interval.\n\nFor $t \\ge t_{XY}$, $X(t) \\ge K_{XY}$, so $\\Theta(X(t)-K_{XY})=1$. The ODE for $Y$ becomes:\n$$\n\\frac{dY}{dt} = \\alpha_Y - \\gamma_Y Y\n$$\nWe solve this ODE with the initial condition $Y(t_{XY})=0$. The solution is:\n$$\nY(t) = \\frac{\\alpha_Y}{\\gamma_Y}(1 - \\exp(-\\gamma_Y (t - t_{XY}))) = Y_{\\infty}(1 - \\exp(-\\gamma_Y (t - t_{XY})))\n$$\n\nThe production of $Z$ is turned on when both $X(t) \\ge K_{ZX}$ and $Y(t) \\ge K_{ZY}$. The turn-on time $t_{\\text{on}}$ is the first time $t \\ge 0$ when both conditions are met. Let $t_{ZX}$ be the time when $X(t) = K_{ZX}$ and $t_{ZY}$ be the time when $Y(t) = K_{ZY}$.\n$$\nt_{\\text{on}} = \\max(t_{ZX}, t_{ZY})\n$$\nSolving for $t_{ZX}$:\n$$\nX(t_{ZX}) = K_{ZX} \\implies K_{ZX} = X_{\\infty}(1 - \\exp(-\\gamma_X t_{ZX}))\n$$\n$$\nt_{ZX} = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{ZX}}\\right)\n$$\nSolving for $t_{ZY}$:\n$$\nY(t_{ZY}) = K_{ZY} \\implies K_{ZY} = Y_{\\infty}(1 - \\exp(-\\gamma_Y (t_{ZY} - t_{XY})))\n$$\n$$\nt_{ZY} - t_{XY} = \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)\n$$\n$$\nt_{ZY} = t_{XY} + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right) = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right) + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)\n$$\nThe problem states $\\gamma_X \\gg \\gamma_Y$, which implies that the characteristic time scale of $X$ dynamics ($1/\\gamma_X$) is much shorter than that of $Y$ dynamics ($1/\\gamma_Y$). This suggests that the second term in the expression for $t_{ZY}$ is dominant, making $t_{ZY}$ significantly larger than $t_{ZX}$. Therefore, the turn-on is limited by the slower $Y$ pathway. Thus, $t_{\\text{on}} = t_{ZY}$.\n$$\nt_{\\text{on}} = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right) + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)\n$$\n\n### Part 2: Derivation of the turn-off time, $t_{\\text{off}}$ (De-induction)\n\nFor the de-induction scenario, the input $u(t)$ switches from $1$ to $0$ at $t=0$. The initial conditions are the steady-state values from the ON state: $X(0)=X_{\\infty}$ and $Y(0)=Y_{\\infty}$.\n\nThe dynamics of $X$ for $t \\ge 0$ are governed by:\n$$\n\\frac{dX}{dt} = -\\gamma_X X, \\quad X(0)=X_{\\infty}\n$$\nThe solution is an exponential decay:\n$$\nX(t) = X_{\\infty}\\exp(-\\gamma_X t)\n$$\nThe dynamics of $Y$ are still described by $\\frac{dY}{dt} = \\alpha_Y \\Theta(X - K_{XY}) - \\gamma_Y Y$. At $t=0$, $X(0)=X_{\\infty} > K_{XY}$, so $Y$ is still being produced. This continues until $X(t)$ drops below $K_{XY}$. Let $t'_{XY}$ be the time when this happens:\n$$\nX(t'_{XY}) = K_{XY} \\implies K_{XY} = X_{\\infty}\\exp(-\\gamma_X t'_{XY})\n$$\n$$\nt'_{XY} = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{XY}}\\right)\n$$\nFor $0 \\le t < t'_{XY}$, $\\frac{dY}{dt} = \\alpha_Y - \\gamma_Y Y$. Since the initial condition is $Y(0)=Y_{\\infty}=\\alpha_Y/\\gamma_Y$, we have $\\frac{dY}{dt}=0$, so $Y(t)=Y_{\\infty}$ during this interval.\n\nFor $t \\ge t'_{XY}$, $X(t) < K_{XY}$, so production of $Y$ stops. The ODE becomes:\n$$\n\\frac{dY}{dt} = -\\gamma_Y Y\n$$\nWe solve this with the initial condition $Y(t'_{XY})=Y_{\\infty}$. The solution is:\n$$\nY(t) = Y_{\\infty}\\exp(-\\gamma_Y (t - t'_{XY}))\n$$\nThe production of $Z$ stops when either $X(t) < K_{ZX}$ or $Y(t) < K_{ZY}$. The turn-off time $t_{\\text{off}}$ is the first time $t \\ge 0$ when at least one of these conditions is met. Let $t'_{ZX}$ be the time when $X(t) = K_{ZX}$ and $t'_{ZY}$ be the time when $Y(t) = K_{ZY}$.\n$$\nt_{\\text{off}} = \\min(t'_{ZX}, t'_{ZY})\n$$\nSolving for $t'_{ZX}$:\n$$\nX(t'_{ZX}) = K_{ZX} \\implies K_{ZX} = X_{\\infty}\\exp(-\\gamma_X t'_{ZX})\n$$\n$$\nt'_{ZX} = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)\n$$\nSolving for $t'_{ZY}$:\n$$\nY(t'_{ZY}) = K_{ZY} \\implies K_{ZY} = Y_{\\infty}\\exp(-\\gamma_Y (t'_{ZY} - t'_{XY}))\n$$\n$$\nt'_{ZY} - t'_{XY} = \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{K_{ZY}}\\right)\n$$\n$$\nt'_{ZY} = t'_{XY} + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{K_{ZY}}\\right) = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{XY}}\\right) + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{K_{ZY}}\\right)\n$$\nTo find $t_{\\text{off}}$, we compare $t'_{ZX}$ and $t'_{ZY}$. From the given conditions, $K_{XY} \\le K_{ZX}$. This implies $\\frac{X_{\\infty}}{K_{XY}} \\ge \\frac{X_{\\infty}}{K_{ZX}}$, and therefore $\\ln\\left(\\frac{X_{\\infty}}{K_{XY}}\\right) \\ge \\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)$.\nThen, the first term of $t'_{ZY}$ is greater than or equal to $t'_{ZX}$:\n$$\n\\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{XY}}\\right) \\ge \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right) = t'_{ZX}\n$$\nSince the second term in $t'_{ZY}$ is positive (as $K_{ZY} < Y_\\infty$), it is certain that $t'_{ZY} > t'_{ZX}$. The minimum of the two times is therefore $t'_{ZX}$. The turn-off is determined by the fast direct pathway $X \\to Z$.\n$$\nt_{\\text{off}} = t'_{ZX} = \\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)\n$$\n\n### Part 3: Calculation of the Ratio $R$\n\nThe ratio $R$ is defined as $t_{\\text{on}}/t_{\\text{off}}$. Substituting the derived expressions:\n$$\nR = \\frac{t_{\\text{on}}}{t_{\\text{off}}} = \\frac{\\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right) + \\frac{1}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)}{\\frac{1}{\\gamma_X}\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)}\n$$\nMultiplying the numerator and denominator by $\\gamma_X$:\n$$\nR = \\frac{\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right) + \\frac{\\gamma_X}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)}{\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)}\n$$\nThis is the final closed-form symbolic expression for the ratio $R$.",
            "answer": "$$\n\\boxed{\\frac{\\ln\\left(\\frac{X_{\\infty}}{X_{\\infty}-K_{XY}}\\right) + \\frac{\\gamma_X}{\\gamma_Y}\\ln\\left(\\frac{Y_{\\infty}}{Y_{\\infty}-K_{ZY}}\\right)}{\\ln\\left(\\frac{X_{\\infty}}{K_{ZX}}\\right)}}\n$$"
        },
        {
            "introduction": "A theoretical property is only useful for engineering if it is robust to the inherent variability of biological systems. This final exercise bridges theory and practice by investigating the robustness of the sign-sensitive delay. Through computational modeling and global sensitivity analysis , you will assess how parameter fluctuations affect the circuit's function, a critical consideration for designing reliable synthetic devices that perform as expected in a cellular context.",
            "id": "3912725",
            "problem": "Consider a coherent type-1 feed-forward loop in synthetic biology in which an upstream transcription factor activates an intermediate transcription factor and also directly activates a downstream gene. The downstream gene is expressed only when both transcription factors are active, implementing a logical conjunction (AND gate). Model the dynamics using Ordinary Differential Equations (ODEs) with Hill-type activation functions and first-order degradation. Let the external input be a unit step function that switches between OFF and ON states. Use nondimensionalization to express the system in terms of dimensionless state variables and dimensionless parameter groups, and perform a global sensitivity analysis based on these groups.\n\nStart from the following well-tested modeling assumptions: production rates are saturating Hill functions of the active transcription factor concentrations, and degradation is first-order. Define a dimensionless time variable $t$ by scaling physical time by the degradation rate of the intermediate transcription factor. Let $x(t)$, $y(t)$, and $z(t)$ denote the dimensionless activity levels of the upstream transcription factor, intermediate transcription factor, and downstream gene product, respectively. Let $u(t)$ be a dimensionless step input that takes the value $0$ in the OFF state and $1$ in the ON state. The coherent feed-forward loop with an AND gate is modeled as\n$$\n\\frac{dx}{dt} = r_x\\left(a_x\\,u(t) - x\\right),\n$$\n$$\n\\frac{dy}{dt} = a_y\\,\\frac{x^{n_y}}{\\left(k_{xy}\\,a_x\\right)^{n_y} + x^{n_y}} - y,\n$$\n$$\n\\frac{dz}{dt} = r_z\\left[a_z\\,\\frac{x^{n_z}}{\\left(k_{xz}\\,a_x\\right)^{n_z} + x^{n_z}}\\,\\frac{y^{n_{zy}}}{\\left(k_{yz}\\,a_y\\right)^{n_{zy}} + y^{n_{zy}}} - z\\right].\n$$\nHere, $r_x$ and $r_z$ are dimensionless timescale ratios relative to the intermediate transcription factorâ€™s degradation, $a_x$, $a_y$, and $a_z$ are dimensionless maximal production amplitudes, $k_{xy}$, $k_{xz}$, and $k_{yz}$ are dimensionless threshold parameters expressed relative to $a_x$ and $a_y$, and $n_y$, $n_z$, $n_{zy}$ are Hill exponents. The Hill activation function is defined for a general input $q$ and threshold $K$ as $q^n/(K^n + q^n)$ with $n > 0$.\n\nDefine the steady state under a sustained ON input $u(t)=1$ by setting $dx/dt=0$, $dy/dt=0$, and $dz/dt=0$, which yields $x_{\\mathrm{ss}}^{\\mathrm{on}} = a_x$, $y_{\\mathrm{ss}}^{\\mathrm{on}} = a_y\\,\\dfrac{\\left(a_x\\right)^{n_y}}{\\left(k_{xy}\\,a_x\\right)^{n_y} + \\left(a_x\\right)^{n_y}}$, and $z_{\\mathrm{ss}}^{\\mathrm{on}} = a_z\\,\\dfrac{\\left(a_x\\right)^{n_z}}{\\left(k_{xz}\\,a_x\\right)^{n_z} + \\left(a_x\\right)^{n_z}}\\,\\dfrac{\\left(y_{\\mathrm{ss}}^{\\mathrm{on}}\\right)^{n_{zy}}}{\\left(k_{yz}\\,a_y\\right)^{n_{zy}} + \\left(y_{\\mathrm{ss}}^{\\mathrm{on}}\\right)^{n_{zy}}}$.\n\nConsider two experiments:\n- An ON step: $u(t)$ changes from $0$ to $1$ at $t=0$, with initial conditions $x(0)=0$, $y(0)=0$, and $z(0)=0$.\n- An OFF step: $u(t)$ changes from $1$ to $0$ at $t=0$, with initial conditions $x(0)=x_{\\mathrm{ss}}^{\\mathrm{on}}$, $y(0)=y_{\\mathrm{ss}}^{\\mathrm{on}}$, and $z(0)=z_{\\mathrm{ss}}^{\\mathrm{on}}$.\n\nFor both experiments, define a detection threshold that is half the ON steady state level, $\\theta = f\\,z_{\\mathrm{ss}}^{\\mathrm{on}}$ with $f=0.5$. Define the ON crossing time $t_{\\mathrm{on}}$ as the earliest $t \\ge 0$ such that $z(t) = \\theta$ when starting from the ON step initial condition. Define the OFF crossing time $t_{\\mathrm{off}}$ as the earliest $t \\ge 0$ such that $z(t) = \\theta$ when starting from the OFF step initial condition. If no crossing occurs within a finite simulation horizon, set the corresponding crossing time to $+\\infty$.\n\nDefine sign-sensitive delay as the property $t_{\\mathrm{on}} > t_{\\mathrm{off}}$, which indicates delayed response to activation and faster response to deactivation. A regime is called robust if the sign-sensitive delay property holds for at least $0.95$ of random samples when each dimensionless parameter is varied independently within $\\pm 20\\%$ of its base value.\n\nImplement a complete program that:\n- Computes $t_{\\mathrm{on}}$ and $t_{\\mathrm{off}}$ by numerically integrating the ODEs for both step experiments using dimensionless time units, with a finite maximum simulation time window $t_{\\max}$, and event detection to find threshold crossings.\n- Performs a global sensitivity analysis by sampling each dimensionless parameter uniformly from the interval $[0.8\\,p_0,\\,1.2\\,p_0]$, where $p_0$ is its base value, and evaluating whether $t_{\\mathrm{on}} > t_{\\mathrm{off}}$ for each sample.\n- For each test case below, returns a boolean indicating whether the fraction of samples satisfying $t_{\\mathrm{on}} > t_{\\mathrm{off}}$ is at least $0.95$.\n\nUse the following test suite of base dimensionless parameter sets, which cover different dynamical regimes:\n- Test case $1$ (happy path): $r_x=5.0$, $r_z=1.0$, $a_x=1.0$, $a_y=1.0$, $a_z=1.0$, $k_{xy}=0.5$, $k_{xz}=0.5$, $k_{yz}=0.5$, $n_y=2.0$, $n_z=2.0$, $n_{zy}=2.0$.\n- Test case $2$ (slow downstream decay, potential failure of sign-sensitive delay): $r_x=5.0$, $r_z=0.2$, $a_x=1.0$, $a_y=1.0$, $a_z=1.0$, $k_{xy}=0.5$, $k_{xz}=0.5$, $k_{yz}=0.5$, $n_y=2.0$, $n_z=2.0$, $n_{zy}=2.0$.\n- Test case $3$ (weak AND gate due to a low downstream threshold for the intermediate transcription factor): $r_x=5.0$, $r_z=1.0$, $a_x=1.0$, $a_y=1.0$, $a_z=1.0$, $k_{xy}=0.5$, $k_{xz}=0.5$, $k_{yz}=0.1$, $n_y=2.0$, $n_z=2.0$, $n_{zy}=2.0$.\n- Test case $4$ (sharp cooperative AND gate for the intermediate transcription factor): $r_x=5.0$, $r_z=1.0$, $a_x=1.0$, $a_y=1.0$, $a_z=1.0$, $k_{xy}=0.5$, $k_{xz}=0.5$, $k_{yz}=0.5$, $n_y=2.0$, $n_z=2.0$, $n_{zy}=4.0$.\n\nYour program must use a maximum simulation time of $t_{\\max}=100$ in dimensionless time units for each integration, and perform $N=200$ random samples per test case for the global sensitivity analysis.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[true,false,true,false]$, but with Python boolean literals. That is, the output must be exactly like $[True,False,True,False]$ in a single line. No physical units are required since all variables are dimensionless. Angles are not used. Percentages are represented as decimal fractions and not with a percentage sign.",
            "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the principles of systems biology, specifically the modeling of genetic circuits. The problem is well-posed, with a complete set of non-contradictory definitions, equations, and parameters, allowing for a unique computational solution. The language is objective and precise, and the task is a non-trivial computational analysis of a standard model.\n\nThe problem requires a global sensitivity analysis of the sign-sensitive delay property in a coherent type-1 feed-forward loop (C1-FFL) with an AND gate. This property, defined as the ON-response time being longer than the OFF-response time ($t_{\\mathrm{on}} > t_{\\mathrm{off}}$), is a key functional characteristic of this network motif, enabling it to filter out short, spurious input pulses while responding quickly to the termination of a sustained signal. The analysis will determine the robustness of this property by evaluating whether it holds for at least $95\\%$ of parameter sets where each parameter is perturbed by up to $\\pm 20\\%$ from a given base value.\n\nThe core of the solution is the numerical integration of the provided system of Ordinary Differential Equations (ODEs) to determine the crossing times $t_{\\mathrm{on}}$ and $t_{\\mathrm{off}}$. The system is given by:\n$$\n\\frac{dx}{dt} = r_x\\left(a_x\\,u(t) - x\\right)\n$$\n$$\n\\frac{dy}{dt} = a_y\\,\\frac{x^{n_y}}{\\left(k_{xy}\\,a_x\\right)^{n_y} + x^{n_y}} - y\n$$\n$$\n\\frac{dz}{dt} = r_z\\left[a_z\\,\\frac{x^{n_z}}{\\left(k_{xz}\\,a_x\\right)^{n_z} + x^{n_z}}\\,\\frac{y^{n_{zy}}}{\\left(k_{yz}\\,a_y\\right)^{n_{zy}} + y^{n_{zy}}} - z\\right]\n$$\nwhere $x(t)$, $y(t)$, and $z(t)$ are the dimensionless concentrations of the three species, and $u(t)$ is the dimensionless input signal.\n\nThe procedure is as follows for a given set of parameters $\\{r_x, r_z, a_x, a_y, a_z, k_{xy}, k_{xz}, k_{yz}, n_y, n_z, n_{zy}\\}$:\n\n1.  **Calculate Steady-State and Threshold:** First, we determine the steady-state concentration of the output, $z_{\\mathrm{ss}}^{\\mathrm{on}}$, under a sustained ON input ($u(t)=1$). This is achieved by setting the time derivatives to $0$, yielding:\n    $$\n    x_{\\mathrm{ss}}^{\\mathrm{on}} = a_x\n    $$\n    $$\n    y_{\\mathrm{ss}}^{\\mathrm{on}} = a_y\\,\\frac{(a_x)^{n_y}}{(k_{xy}\\,a_x)^{n_y} + (a_x)^{n_y}} = \\frac{a_y}{k_{xy}^{n_y} + 1}\n    $$\n    $$\n    z_{\\mathrm{ss}}^{\\mathrm{on}} = a_z\\,\\left(\\frac{(a_x)^{n_z}}{(k_{xz}\\,a_x)^{n_z} + (a_x)^{n_z}}\\right)\\,\\left(\\frac{(y_{\\mathrm{ss}}^{\\mathrm{on}})^{n_{zy}}}{(k_{yz}\\,a_y)^{n_{zy}} + (y_{\\mathrm{ss}}^{\\mathrm{on}})^{n_{zy}}}\\right)\n    $$\n    The detection threshold, $\\theta$, is then defined as half of this steady-state value: $\\theta = f \\cdot z_{\\mathrm{ss}}^{\\mathrm{on}}$ with $f=0.5$.\n\n2.  **Simulate ON Response to find $t_{\\mathrm{on}}$:** The system of ODEs is integrated numerically over the time interval $[0, t_{\\max}]$, where $t_{\\max}=100$.\n    -   The input is set to $u(t)=1$.\n    -   The initial conditions are $x(0)=0$, $y(0)=0$, and $z(0)=0$.\n    -   We must find the earliest time $t_{\\mathrm{on}} \\ge 0$ at which $z(t)$ crosses $\\theta$ from below. This is an event-finding problem. We define an event function $E_{\\mathrm{on}}(t, \\mathbf{S}) = z(t) - \\theta$, where $\\mathbf{S} = [x(t), y(t), z(t)]$, and seek a root where the function is increasing. If no such crossing occurs before $t_{\\max}$, $t_{\\mathrm{on}}$ is set to $+\\infty$.\n\n3.  **Simulate OFF Response to find $t_{\\mathrm{off}}$:** The ODEs are integrated again over $[0, t_{\\max}]$.\n    -   The input is set to $u(t)=0$.\n    -   The initial conditions are the steady-state values: $x(0)=x_{\\mathrm{ss}}^{\\mathrm{on}}$, $y(0)=y_{\\mathrm{ss}}^{\\mathrm{on}}$, and $z(0)=z_{\\mathrm{ss}}^{\\mathrm{on}}$.\n    -   We must find the earliest time $t_{\\mathrm{off}} \\ge 0$ at which $z(t)$ crosses $\\theta$ from above. The event function is $E_{\\mathrm{off}}(t, \\mathbf{S}) = z(t) - \\theta$, but now we seek a root where the function is decreasing. If no crossing occurs, $t_{\\mathrm{off}}$ is set to $+\\infty$.\n\n4.  **Perform Global Sensitivity Analysis:** For each test case defined by a base parameter set $\\{p_{0,i}\\}$, this entire procedure is repeated $N=200$ times. In each repetition, a new parameter set $\\{p_i\\}$ is generated by independently sampling each parameter from a uniform distribution: $p_i \\sim U(0.8 \\cdot p_{0,i}, 1.2 \\cdot p_{0,i})$.\n    -   A counter tracks the number of samples for which the sign-sensitive delay property, $t_{\\mathrm{on}} > t_{\\mathrm{off}}$, holds.\n    -   After $N=200$ samples, the fraction of valid samples is calculated. If this fraction is at least $0.95$, the system is considered robust for that base parameter set, and the result is `True`. Otherwise, it is `False`.\n\nThis analysis is performed for each of the four specified test cases. The numerical integration and event detection will be implemented using `scipy.integrate.solve_ivp`, which is well-suited for this task due to its robust numerical methods and built-in event handling capabilities. The final output will be a list of booleans corresponding to the robustness check for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run the sensitivity analysis for all test cases.\n    \"\"\"\n    \n    # Test cases: base dimensionless parameter sets\n    test_cases = [\n        # Case 1: Happy path\n        {'r_x': 5.0, 'r_z': 1.0, 'a_x': 1.0, 'a_y': 1.0, 'a_z': 1.0, 'k_xy': 0.5, 'k_xz': 0.5, 'k_yz': 0.5, 'n_y': 2.0, 'n_z': 2.0, 'n_zy': 2.0},\n        # Case 2: Slow downstream decay\n        {'r_x': 5.0, 'r_z': 0.2, 'a_x': 1.0, 'a_y': 1.0, 'a_z': 1.0, 'k_xy': 0.5, 'k_xz': 0.5, 'k_yz': 0.5, 'n_y': 2.0, 'n_z': 2.0, 'n_zy': 2.0},\n        # Case 3: Weak AND gate (low k_yz)\n        {'r_x': 5.0, 'r_z': 1.0, 'a_x': 1.0, 'a_y': 1.0, 'a_z': 1.0, 'k_xy': 0.5, 'k_xz': 0.5, 'k_yz': 0.1, 'n_y': 2.0, 'n_z': 2.0, 'n_zy': 2.0},\n        # Case 4: Sharp cooperative AND gate (high n_zy)\n        {'r_x': 5.0, 'r_z': 1.0, 'a_x': 1.0, 'a_y': 1.0, 'a_z': 1.0, 'k_xy': 0.5, 'k_xz': 0.5, 'k_yz': 0.5, 'n_y': 2.0, 'n_z': 2.0, 'n_zy': 4.0},\n    ]\n\n    # Analysis settings\n    N_SAMPLES = 200\n    T_MAX = 100.0\n    ROBUSTNESS_THRESHOLD = 0.95\n    \n    results = []\n    \n    for base_params in test_cases:\n        ssd_count = 0\n        param_keys = base_params.keys()\n        \n        for _ in range(N_SAMPLES):\n            # Sample parameters from Uniform(0.8*p0, 1.2*p0)\n            sampled_params = {key: np.random.uniform(0.8 * val, 1.2 * val) for key, val in base_params.items()}\n            \n            # Run one simulation pair (ON/OFF) and check for sign-sensitive delay\n            is_ssd = check_sign_sensitive_delay(sampled_params, T_MAX)\n            if is_ssd:\n                ssd_count += 1\n        \n        # Check for robustness\n        fraction = ssd_count / N_SAMPLES\n        results.append(fraction >= ROBUSTNESS_THRESHOLD)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef odes(t, S, u, p):\n    \"\"\"\n    Defines the system of Ordinary Differential Equations for the C1-FFL.\n    S: state vector [x, y, z]\n    u: input signal (0 or 1)\n    p: dictionary of parameters\n    \"\"\"\n    x, y, z = S\n    \n    # Hill function for y activation by x\n    hill_y = x**p['n_y'] / ((p['k_xy'] * p['a_x'])**p['n_y'] + x**p['n_y'])\n    \n    # Hill functions for z activation by x and y\n    hill_z_x = x**p['n_z'] / ((p['k_xz'] * p['a_x'])**p['n_z'] + x**p['n_z'])\n    hill_z_y = y**p['n_zy'] / ((p['k_yz'] * p['a_y'])**p['n_zy'] + y**p['n_zy'])\n    \n    # ODEs\n    dx_dt = p['r_x'] * (p['a_x'] * u - x)\n    dy_dt = p['a_y'] * hill_y - y\n    dz_dt = p['r_z'] * (p['a_z'] * hill_z_x * hill_z_y - z)\n    \n    return [dx_dt, dy_dt, dz_dt]\n\n\ndef check_sign_sensitive_delay(params, t_max):\n    \"\"\"\n    Computes t_on and t_off for a given parameter set and checks if t_on > t_off.\n    \"\"\"\n    \n    # 1. Calculate ON steady state and threshold\n    x_ss_on = params['a_x']\n    \n    y_ss_on_num = x_ss_on**params['n_y']\n    y_ss_on_den = (params['k_xy'] * params['a_x'])**params['n_y'] + y_ss_on_num\n    y_ss_on = params['a_y'] * y_ss_on_num / y_ss_on_den\n    \n    z_ss_on_hx_num = x_ss_on**params['n_z']\n    z_ss_on_hx_den = (params['k_xz'] * params['a_x'])**params['n_z'] + z_ss_on_hx_num\n    h_x_ss = z_ss_on_hx_num / z_ss_on_hx_den\n    \n    z_ss_on_hy_num = y_ss_on**params['n_zy']\n    z_ss_on_hy_den = (params['k_yz'] * params['a_y'])**params['n_zy'] + z_ss_on_hy_num\n    h_y_ss = z_ss_on_hy_num / z_ss_on_hy_den\n    \n    z_ss_on = params['a_z'] * h_x_ss * h_y_ss\n    \n    # Avoid issues with zero steady state, though unlikely with given params\n    if z_ss_on <= 1e-9:\n        return False\n\n    threshold = 0.5 * z_ss_on\n    \n    # Define event functions\n    # Event: z(t) - threshold = 0\n    def event_z_cross(t, S, u, p):\n        return S[2] - threshold\n    \n    # For ON step, we are looking for an upward crossing\n    event_z_cross_on = lambda t, S, u, p: event_z_cross(t, S, u, p)\n    event_z_cross_on.direction = 1  # Event triggers on S[2] increasing through threshold\n    event_z_cross_on.terminal = True # Stop integration at first event\n\n    # For OFF step, we are looking for a downward crossing\n    event_z_cross_off = lambda t, S, u, p: event_z_cross(t, S, u, p)\n    event_z_cross_off.direction = -1 # Event triggers on S[2] decreasing through threshold\n    event_z_cross_off.terminal = True\n\n    # 2. Simulate ON step to find t_on\n    S0_on = [0.0, 0.0, 0.0]\n    u_on = 1.0\n    sol_on = solve_ivp(\n        fun=odes, \n        t_span=[0, t_max], \n        y0=S0_on, \n        args=(u_on, params), \n        events=event_z_cross_on,\n        dense_output=True\n    )\n    \n    t_on = sol_on.t_events[0][0] if len(sol_on.t_events[0]) > 0 else np.inf\n\n    # 3. Simulate OFF step to find t_off\n    S0_off = [x_ss_on, y_ss_on, z_ss_on]\n    u_off = 0.0\n    sol_off = solve_ivp(\n        fun=odes, \n        t_span=[0, t_max], \n        y0=S0_off, \n        args=(u_off, params), \n        events=event_z_cross_off,\n        dense_output=True\n    )\n    \n    t_off = sol_off.t_events[0][0] if len(sol_off.t_events[0]) > 0 else np.inf\n    \n    # 4. Check for sign-sensitive delay\n    return t_on > t_off\n\n# Execute the main function when the script is run\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}