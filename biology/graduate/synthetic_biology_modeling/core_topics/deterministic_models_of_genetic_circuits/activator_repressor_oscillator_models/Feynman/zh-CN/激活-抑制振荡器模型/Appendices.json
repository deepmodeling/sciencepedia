{
    "hands_on_practices": [
        {
            "introduction": "在分析复杂的生物动力学系统时，一个关键的初始步骤是简化模型。练习  引导我们运用无量纲化这一强大的数学技术。通过重新缩放变量和参数，我们可以将模型中众多的参数合并为少数几个控制系统行为本质的无量纲参数组，从而揭示系统动力学的核心机制。",
            "id": "3905062",
            "problem": "考虑一个由常微分方程（ODE）建模的最小纯蛋白质激活-阻遏基因振荡器，该方程描述了激活蛋白 $A(t)$ 和抑制蛋白 $R(t)$ 的浓度。在该系统中，激活剂 $A$ 激活 $R$ 的产生，而抑制剂 $R$ 抑制 $A$ 的产生。假设蛋白质的产生遵循具有饱和性和协同性的 Hill 型调控函数，并且蛋白质的移除是一阶稀释-降解。有量纲的常微分方程组为\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{\\alpha_A}{1 + \\left(\\frac{R}{K_R}\\right)^{n_r}} \\;-\\; \\delta_A\\, A,\n\\qquad\n\\frac{dR}{dt} \\;=\\; \\frac{\\alpha_R \\left(\\frac{A}{K_A}\\right)^{n_a}}{1 + \\left(\\frac{A}{K_A}\\right)^{n_a}} \\;-\\; \\delta_R\\, R,\n$$\n其中 $t$ 是时间，$\\alpha_A$ 和 $\\alpha_R$ 是最大蛋白质合成速率，$\\delta_A$ 和 $\\delta_R$ 是有效的一阶移除速率，$K_A$ 和 $K_R$ 是激活和抑制阈值，$n_a$ 和 $n_r$ 是代表协同性的 Hill 系数。所有参数均为正常数。\n\n通过引入换算关系 $A \\leftarrow A/K_A$、$R \\leftarrow R/K_R$ 和 $t \\leftarrow \\delta_A\\, t$ 对该系统进行无量纲化。推导所得的无量纲常微分方程，并确定控制其动力学的完整独立无量纲参数集。用原始的有量纲参数和 Hill 系数明确表示这些参数。你的最终答案应为包含这些无量纲参数的行矩阵，顺序为 $\\left(\\sigma_A, \\sigma_R, \\beta, n_a, n_r\\right)$，其中 $\\sigma_A$、$\\sigma_R$ 和 $\\beta$ 是你确定的相应无量纲群。最终答案必须是单一的解析表达式。最终答案中不要包含单位。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n给定的有量纲常微分方程（ODE）系统是：\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{\\alpha_A}{1 + \\left(\\frac{R}{K_R}\\right)^{n_r}} \\;-\\; \\delta_A\\, A\n$$\n$$\n\\frac{dR}{dt} \\;=\\; \\frac{\\alpha_R \\left(\\frac{A}{K_A}\\right)^{n_a}}{1 + \\left(\\frac{A}{K_A}\\right)^{n_a}} \\;-\\; \\delta_R\\, R\n$$\n变量是激活蛋白浓度 $A(t)$ 和抑制蛋白浓度 $R(t)$。参数是最大合成速率 $\\alpha_A$ 和 $\\alpha_R$，有效一阶移除速率 $\\delta_A$ 和 $\\delta_R$，激活和抑制阈值 $K_A$ 和 $K_R$，以及 Hill 系数 $n_a$ 和 $n_r$。所有参数均为正常数。指定的无量纲化换算关系是：$A \\leftarrow A/K_A$、$R \\leftarrow R/K_R$ 和 $t \\leftarrow \\delta_A\\, t$。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，采用的是带有 Hill 动力学的标准激活-阻遏模型，这是系统生物学和合成生物学中的一个典型例子。这些方程在为此类遗传回路建模方面已广为接受。该问题是适定的，因为无量纲化是一个标准且明确的数学过程。它是客观、完整的，不包含任何矛盾或不科学的前提。因此，该问题被认为是有效的。\n\n### 第 3 步：求解推导\n我们按照指定引入无量纲变量和无量纲时间：\n设 $a$ 为激活剂的无量纲浓度，$r$ 为抑制剂的无量纲浓度，$\\tau$ 为无量纲时间。\n$$\na(\\tau) = \\frac{A(t)}{K_A} \\quad \\implies \\quad A(t) = K_A \\, a(\\tau)\n$$\n$$\nr(\\tau) = \\frac{R(t)}{K_R} \\quad \\implies \\quad R(t) = K_R \\, r(\\tau)\n$$\n$$\n\\tau = \\delta_A \\, t \\quad \\implies \\quad t = \\frac{\\tau}{\\delta_A}\n$$\n为了将关于 $t$ 的导数转换为关于 $\\tau$ 的导数，我们使用链式法则。首先，对于激活剂浓度 $A$：\n$$\n\\frac{dA}{dt} = \\frac{d}{dt} (K_A \\, a(\\tau)) = K_A \\, \\frac{da}{d\\tau} \\, \\frac{d\\tau}{dt}\n$$\n由于 $\\tau = \\delta_A \\, t$，我们有 $\\frac{d\\tau}{dt} = \\delta_A$。代入此式可得：\n$$\n\\frac{dA}{dt} = K_A \\, \\delta_A \\, \\frac{da}{d\\tau}\n$$\n类似地，对于抑制剂浓度 $R$：\n$$\n\\frac{dR}{dt} = \\frac{d}{dt} (K_R \\, r(\\tau)) = K_R \\, \\frac{dr}{d\\tau} \\, \\frac{d\\tau}{dt} = K_R \\, \\delta_A \\, \\frac{dr}{d\\tau}\n$$\n现在，我们将这些表达式和换算后的变量代入原始的常微分方程中。\n\n对于第一个常微分方程（$A$ 的动力学）：\n$$\nK_A \\, \\delta_A \\, \\frac{da}{d\\tau} = \\frac{\\alpha_A}{1 + \\left(\\frac{K_R \\, r}{K_R}\\right)^{n_r}} - \\delta_A \\, (K_A \\, a)\n$$\n$$\nK_A \\, \\delta_A \\, \\frac{da}{d\\tau} = \\frac{\\alpha_A}{1 + r^{n_r}} - \\delta_A \\, K_A \\, a\n$$\n为了分离出 $\\frac{da}{d\\tau}$，我们将整个方程除以 $K_A \\, \\delta_A$：\n$$\n\\frac{da}{d\\tau} = \\frac{\\alpha_A}{K_A \\, \\delta_A \\, (1 + r^{n_r})} - a\n$$\n我们将无量纲参数 $\\sigma_A$ 定义为产生项的系数：\n$$\n\\sigma_A = \\frac{\\alpha_A}{K_A \\, \\delta_A}\n$$\n因此，第一个无量纲常微分方程是：\n$$\n\\frac{da}{d\\tau} = \\frac{\\sigma_A}{1 + r^{n_r}} - a\n$$\n对于第二个常微分方程（$R$ 的动力学）：\n$$\nK_R \\, \\delta_A \\, \\frac{dr}{d\\tau} = \\frac{\\alpha_R \\left(\\frac{K_A \\, a}{K_A}\\right)^{n_a}}{1 + \\left(\\frac{K_A \\, a}{K_A}\\right)^{n_a}} - \\delta_R \\, (K_R \\, r)\n$$\n$$\nK_R \\, \\delta_A \\, \\frac{dr}{d\\tau} = \\frac{\\alpha_R \\, a^{n_a}}{1 + a^{n_a}} - \\delta_R \\, K_R \\, r\n$$\n为了分离出 $\\frac{dr}{d\\tau}$，我们将整个方程除以 $K_R \\, \\delta_A$：\n$$\n\\frac{dr}{d\\tau} = \\frac{\\alpha_R \\, a^{n_a}}{K_R \\, \\delta_A \\, (1 + a^{n_a})} - \\frac{\\delta_R \\, K_R \\, r}{K_R \\, \\delta_A}\n$$\n$$\n\\frac{dr}{d\\tau} = \\left(\\frac{\\alpha_R}{K_R \\, \\delta_A}\\right) \\frac{a^{n_a}}{1 + a^{n_a}} - \\left(\\frac{\\delta_R}{\\delta_A}\\right) r\n$$\n我们从系数中确定两个新的无量纲参数。遵循问题的符号表示：\n$$\n\\sigma_R = \\frac{\\alpha_R}{K_R \\, \\delta_A}\n$$\n$$\n\\beta = \\frac{\\delta_R}{\\delta_A}\n$$\n因此，第二个无量纲常微分方程是：\n$$\n\\frac{dr}{d\\tau} = \\sigma_R \\frac{a^{n_a}}{1 + a^{n_a}} - \\beta \\, r\n$$\n完整的无量纲系统是：\n$$\n\\frac{da}{d\\tau} = \\frac{\\sigma_A}{1 + r^{n_r}} - a\n$$\n$$\n\\frac{dr}{d\\tau} = \\sigma_R \\frac{a^{n_a}}{1 + a^{n_a}} - \\beta \\, r\n$$\n该系统的动力学由出现在这些方程中的独立无量纲参数集控制。这些参数是我们推导出的三个无量纲群 $\\sigma_A$、$\\sigma_R$ 和 $\\beta$，以及本身就是无量纲的 Hill 系数 $n_a$ 和 $n_r$。\n\n因此，完整的无量纲参数集是 $(\\sigma_A, \\sigma_R, \\beta, n_a, n_r)$，其中：\n- $\\sigma_A = \\frac{\\alpha_A}{K_A \\, \\delta_A}$（$A$ 的无量纲最大合成速率）\n- $\\sigma_R = \\frac{\\alpha_R}{K_R \\, \\delta_A}$（$R$ 的无量纲最大合成速率，按 $A$ 的移除速率缩放）\n- $\\beta = \\frac{\\delta_R}{\\delta_A}$（移除速率之比）\n- $n_a$（激活剂协同性）\n- $n_r$（抑制剂协同性）\n\n最终答案是包含这些参数并按指定顺序排列的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha_A}{K_A \\delta_A}  \\frac{\\alpha_R}{K_R \\delta_A}  \\frac{\\delta_R}{\\delta_A}  n_a  n_r\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "振荡行为的出现通常源于系统稳态的失稳。练习  深入探讨了线性稳定性分析，这是预测振荡产生的核心理论工具。通过计算系统的雅可比（Jacobian）矩阵及其特征值，我们可以精确定位导致霍普夫（Hopf）分岔的关键参数条件，从而从数学上理解极限环振荡是如何“诞生”的。",
            "id": "3905049",
            "problem": "考虑一个由常微分方程（ODE）描述的最小双基因激活-阻遏振荡器，该模型基于源自分子生物学中心法则（DNA到RNA到蛋白质）的希尔型（Hill-type）转录调控和标准的质量作用降解。令 $A(t)$ 表示激活蛋白的浓度，$R(t)$ 表示抑制蛋白的浓度。该模型为\n$$\n\\frac{dA}{dt} \\;=\\; \\alpha_A\\,g(R) \\;+\\; \\gamma_A\\,f(A) \\;-\\; \\delta_A\\,A,\n\\qquad\n\\frac{dR}{dt} \\;=\\; \\alpha_R\\,f(A) \\;-\\; \\delta_R\\,R,\n$$\n其中 $f(A)$ 和 $g(R)$ 分别是激活和抑制的希尔函数，\n$$\nf(A) \\;=\\; \\frac{A^{n_A}}{K_A^{n_A} + A^{n_A}},\n\\qquad\ng(R) \\;=\\; \\frac{1}{1 + \\left(\\frac{R}{K_R}\\right)^{n_R}}.\n$$\n所有参数均为正值，并具有生物学可解释性：$\\alpha_A$ 和 $\\alpha_R$ 是最大产出系数（单位为浓度/单位时间），$\\gamma_A$ 是乘以自激活项的激活增益（单位为浓度/单位时间），$\\delta_A$ 和 $\\delta_R$ 是一阶降解/稀释速率（单位为时间倒数），$K_A$ 和 $K_R$ 是半饱和常数（单位为浓度），$n_A$ 和 $n_R$ 是希尔协同指数。\n\n对于给定的参数集\n$$\nn_A = 6,\\quad n_R = 2,\\quad K_A = 50\\,\\text{nM},\\quad K_R = 40\\,\\text{nM},\\quad \\delta_A = 0.3\\,\\text{h}^{-1},\\quad \\delta_R = 0.1\\,\\text{h}^{-1},\n$$\n假设通过选择\n$$\n\\alpha_R = 2\\,\\delta_R\\,K_R,\\qquad \\alpha_A = 2\\,\\delta_A\\,K_A - \\gamma_A,\n$$\n对于$\\gamma_A$的所有值，操作点都保持在半饱和浓度 $A^{\\ast} = K_A$ 和 $R^{\\ast} = K_R$，使得稳态条件 $\\frac{dA}{dt} = 0$ 和 $\\frac{dR}{dt} = 0$ 在 $A^{\\ast} = K_A$, $R^{\\ast} = K_R$ 处得到满足。\n\n任务：\n1. 推导常微分方程在平衡点 $(A^{\\ast},R^{\\ast}) = (K_A,K_R)$ 附近的线性化的雅可比矩阵。\n2. 对于给定的参数集，计算雅可比矩阵的特征值 $\\lambda_{\\pm}(\\gamma_A)$ 作为 $\\gamma_A$ 的函数。\n3. 确定临界激活增益 $\\gamma_A^{\\ast}$，在该值处特征值穿过虚轴（即实部为零），并验证在 $\\gamma_A^{\\ast}$ 处雅可比矩阵的行列式为正，从而确认该穿越是复共轭对的霍普夫型（Hopf-type）不稳定性。\n4. 计算在 $\\gamma_A = 12\\,\\text{nM}\\,\\text{h}^{-1}$ 和 $\\gamma_A = 15\\,\\text{nM}\\,\\text{h}^{-1}$ 处 $\\lambda_{\\pm}(\\gamma_A)$ 的实部，以确认当 $\\gamma_A$ 穿过 $\\gamma_A^{\\ast}$ 增加时，实部发生符号变化。\n\n以 $\\text{nM}\\,\\text{h}^{-1}$ 为单位表示临界激活增益 $\\gamma_A^{\\ast}$ 的最终数值，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求对一个双基因激活-阻遏振荡器模型进行分析。该过程包括围绕一个指定的平衡点对系统进行线性化，分析所得雅可比矩阵的特征值，并确定霍普夫（Hopf）分岔的临界参数值。\n\n该常微分方程（ODE）系统由以下公式给出：\n$$\n\\frac{dA}{dt} = F(A, R) = \\alpha_A\\,g(R) + \\gamma_A\\,f(A) - \\delta_A\\,A\n$$\n$$\n\\frac{dR}{dt} = G(A, R) = \\alpha_R\\,f(A) - \\delta_R\\,R\n$$\n其中希尔函数为\n$$\nf(A) = \\frac{A^{n_A}}{K_A^{n_A} + A^{n_A}} \\quad \\text{和} \\quad g(R) = \\frac{1}{1 + \\left(\\frac{R}{K_R}\\right)^{n_R}} = \\frac{K_R^{n_R}}{K_R^{n_R} + R^{n_R}}\n$$\n所有参数均为正值。分析在平衡点 $(A^{\\ast}, R^{\\ast}) = (K_A, K_R)$ 进行。\n\n**任务1：推导雅可比矩阵。**\n系统的雅可比矩阵 $J$ 由下式给出：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial F}{\\partial A}  \\frac{\\partial F}{\\partial R} \\\\ \\frac{\\partial G}{\\partial A}  \\frac{\\partial G}{\\partial R} \\end{pmatrix}\n$$\n偏导数是：\n$$\n\\frac{\\partial F}{\\partial A} = \\gamma_A f'(A) - \\delta_A\n$$\n$$\n\\frac{\\partial F}{\\partial R} = \\alpha_A g'(R)\n$$\n$$\n\\frac{\\partial G}{\\partial A} = \\alpha_R f'(A)\n$$\n$$\n\\frac{\\partial G}{\\partial R} = -\\delta_R\n$$\n我们需要计算希尔函数 $f'(A)$ 和 $g'(R)$ 的导数：\n$$\nf'(A) = \\frac{d}{dA}\\left(\\frac{A^{n_A}}{K_A^{n_A} + A^{n_A}}\\right) = \\frac{n_A A^{n_A-1}(K_A^{n_A} + A^{n_A}) - A^{n_A}(n_A A^{n_A-1})}{(K_A^{n_A} + A^{n_A})^2} = \\frac{n_A K_A^{n_A} A^{n_A-1}}{(K_A^{n_A} + A^{n_A})^2}\n$$\n$$\ng'(R) = \\frac{d}{dR}\\left(\\frac{K_R^{n_R}}{K_R^{n_R} + R^{n_R}}\\right) = \\frac{-K_R^{n_R}(n_R R^{n_R-1})}{(K_R^{n_R} + R^{n_R})^2} = -\\frac{n_R K_R^{n_R} R^{n_R-1}}{(K_R^{n_R} + R^{n_R})^2}\n$$\n现在，我们在平衡点 $(A^{\\ast}, R^{\\ast}) = (K_A, K_R)$ 处计算这些导数：\n$$\nf'(A^{\\ast}) = f'(K_A) = \\frac{n_A K_A^{n_A} K_A^{n_A-1}}{(K_A^{n_A} + K_A^{n_A})^2} = \\frac{n_A K_A^{2n_A-1}}{(2K_A^{n_A})^2} = \\frac{n_A}{4K_A}\n$$\n$$\ng'(R^{\\ast}) = g'(K_R) = -\\frac{n_R K_R^{n_R} K_R^{n_R-1}}{(K_R^{n_R} + K_R^{n_R})^2} = -\\frac{n_R K_R^{2n_R-1}}{(2K_R^{n_R})^2} = -\\frac{n_R}{4K_R}\n$$\n在平衡点处计算的雅可比矩阵 $J^{\\ast}$ 具有以下元素：\n$$\nJ^{\\ast}_{11} = \\gamma_A f'(A^{\\ast}) - \\delta_A = \\gamma_A \\frac{n_A}{4K_A} - \\delta_A\n$$\n$$\nJ^{\\ast}_{12} = \\alpha_A g'(R^{\\ast}) = \\alpha_A \\left(-\\frac{n_R}{4K_R}\\right)\n$$\n$$\nJ^{\\ast}_{21} = \\alpha_R f'(A^{\\ast}) = \\alpha_R \\frac{n_A}{4K_A}\n$$\n$$\nJ^{\\ast}_{22} = -\\delta_R\n$$\n问题指明 $\\alpha_R = 2\\delta_R K_R$ 和 $\\alpha_A = 2\\delta_A K_A - \\gamma_A$。将这些代入雅可比矩阵的元素中：\n$$\nJ^{\\ast}_{12} = (2\\delta_A K_A - \\gamma_A) \\left(-\\frac{n_R}{4K_R}\\right)\n$$\n$$\nJ^{\\ast}_{21} = (2\\delta_R K_R) \\frac{n_A}{4K_A} = \\frac{n_A \\delta_R K_R}{2K_A}\n$$\n因此，在平衡点 $(K_A, K_R)$ 处的雅可比矩阵为：\n$$\nJ^{\\ast} = \\begin{pmatrix} \\gamma_A \\frac{n_A}{4K_A} - \\delta_A  (2\\delta_A K_A - \\gamma_A) \\left(-\\frac{n_R}{4K_R}\\right) \\\\ \\frac{n_A \\delta_R K_R}{2K_A}  -\\delta_R \\end{pmatrix}\n$$\n\n**任务2：计算特征值 $\\lambda_{\\pm}(\\gamma_A)$。**\n首先，我们将给定的参数值代入雅可比矩阵的各分量中：\n$n_A = 6$，$n_R = 2$，$K_A = 50\\,\\text{nM}$，$K_R = 40\\,\\text{nM}$，$\\delta_A = 0.3\\,\\text{h}^{-1}$，$\\delta_R = 0.1\\,\\text{h}^{-1}$。\n$$\nJ^{\\ast}_{11} = \\gamma_A \\frac{6}{4(50)} - 0.3 = \\gamma_A \\frac{6}{200} - 0.3 = 0.03\\,\\gamma_A - 0.3\n$$\n$$\nJ^{\\ast}_{12} = (2(0.3)(50) - \\gamma_A) \\left(-\\frac{2}{4(40)}\\right) = (30 - \\gamma_A) \\left(-\\frac{2}{160}\\right) = (30 - \\gamma_A) \\left(-\\frac{1}{80}\\right) = \\frac{\\gamma_A}{80} - \\frac{30}{80} = 0.0125\\,\\gamma_A - 0.375\n$$\n$$\nJ^{\\ast}_{21} = \\frac{6(0.1)(40)}{2(50)} = \\frac{24}{100} = 0.24\n$$\n$$\nJ^{\\ast}_{22} = -0.1\n$$\n雅可比矩阵为：\n$$\nJ^{\\ast} = \\begin{pmatrix} 0.03\\,\\gamma_A - 0.3  0.0125\\,\\gamma_A - 0.375 \\\\ 0.24  -0.1 \\end{pmatrix}\n$$\n特征值 $\\lambda$ 是特征多项式 $\\det(J^{\\ast} - \\lambda I) = 0$ 的根，即 $\\lambda^2 - \\text{Tr}(J^{\\ast})\\lambda + \\det(J^{\\ast}) = 0$。\n雅可比矩阵的迹是：\n$$\n\\text{Tr}(J^{\\ast}) = J^{\\ast}_{11} + J^{\\ast}_{22} = (0.03\\,\\gamma_A - 0.3) + (-0.1) = 0.03\\,\\gamma_A - 0.4\n$$\n雅可比矩阵的行列式是：\n$$\n\\det(J^{\\ast}) = J^{\\ast}_{11} J^{\\ast}_{22} - J^{\\ast}_{12} J^{\\ast}_{21} = (0.03\\,\\gamma_A - 0.3)(-0.1) - (0.0125\\,\\gamma_A - 0.375)(0.24)\n$$\n$$\n\\det(J^{\\ast}) = -0.003\\,\\gamma_A + 0.03 - (0.003\\,\\gamma_A - 0.09) = -0.006\\,\\gamma_A + 0.12\n$$\n特征值由二次公式给出：\n$$\n\\lambda_{\\pm}(\\gamma_A) = \\frac{\\text{Tr}(J^{\\ast}) \\pm \\sqrt{\\text{Tr}(J^{\\ast})^2 - 4\\det(J^{\\ast})}}{2}\n$$\n$$\n\\lambda_{\\pm}(\\gamma_A) = \\frac{1}{2}\\left( (0.03\\,\\gamma_A - 0.4) \\pm \\sqrt{(0.03\\,\\gamma_A - 0.4)^2 - 4(-0.006\\,\\gamma_A + 0.12)} \\right)\n$$\n\n**任务3：确定临界激活增益 $\\gamma_A^{\\ast}$。**\n当一对复共轭特征值穿过虚轴时，发生霍普夫分岔。这要求特征值的实部为零，虚部不为零。特征值的实部为 $\\text{Re}(\\lambda_{\\pm}) = \\text{Tr}(J^{\\ast})/2$。\n当 $\\text{Tr}(J^{\\ast}) = 0$ 时发生穿越。\n$$\n0.03\\,\\gamma_A^{\\ast} - 0.4 = 0\n$$\n$$\n\\gamma_A^{\\ast} = \\frac{0.4}{0.03} = \\frac{40}{3} \\approx 13.333...\n$$\n$\\gamma_A^{\\ast}$ 的单位是 $\\text{nM}\\,\\text{h}^{-1}$。\n对于霍普夫分岔，我们还必须验证此时的特征值确实是复数，这要求判别式 $\\text{Tr}(J^{\\ast})^2 - 4\\det(J^{\\ast})$ 为负。由于在 $\\gamma_A^{\\ast}$ 处 $\\text{Tr}(J^{\\ast}) = 0$，该条件简化为 $-4\\det(J^{\\ast})  0$，即 $\\det(J^{\\ast})  0$。\n我们在 $\\gamma_A^{\\ast} = 40/3$ 处计算行列式：\n$$\n\\det(J^{\\ast})|_{\\gamma_A^{\\ast}} = -0.006\\left(\\frac{40}{3}\\right) + 0.12 = -0.002(40) + 0.12 = -0.08 + 0.12 = 0.04\n$$\n由于 $\\det(J^{\\ast})|_{\\gamma_A^{\\ast}} = 0.04  0$，一对复共轭特征值在 $\\gamma_A^{\\ast} = 40/3$ 处穿过虚轴，这是一个霍普夫分岔。此点的特征值为 $\\lambda_{\\pm} = \\pm i\\sqrt{\\det(J^{\\ast})} = \\pm i\\sqrt{0.04} = \\pm 0.2i$。\n\n**任务4：在特定值处计算 $\\lambda_{\\pm}(\\gamma_A)$ 的实部。**\n特征值的实部是 $\\text{Re}(\\lambda_{\\pm}) = \\frac{1}{2}\\text{Tr}(J^{\\ast}) = \\frac{1}{2}(0.03\\,\\gamma_A - 0.4) = 0.015\\,\\gamma_A - 0.2$。\n对于 $\\gamma_A = 12\\,\\text{nM}\\,\\text{h}^{-1}$（低于临界值 $\\gamma_A^{\\ast} \\approx 13.33$）：\n$$\n\\text{Re}(\\lambda_{\\pm}) = 0.015(12) - 0.2 = 0.18 - 0.2 = -0.02\n$$\n实部为负，表明平衡点是稳定的。\n\n对于 $\\gamma_A = 15\\,\\text{nM}\\,\\text{h}^{-1}$（高于临界值 $\\gamma_A^{\\ast} \\approx 13.33$）：\n$$\n\\text{Re}(\\lambda_{\\pm}) = 0.015(15) - 0.2 = 0.225 - 0.2 = 0.025\n$$\n实部为正，表明平衡点是不稳定的。这证实了当 $\\gamma_A$ 穿过临界值 $\\gamma_A^{\\ast}$ 增加时，特征值的实部从负变正，这与导致振荡的霍普夫分岔一致。\n\n问题要求临界激活增益 $\\gamma_A^{\\ast}$ 的数值，并四舍五入到四位有效数字。\n$$\n\\gamma_A^{\\ast} = \\frac{40}{3} \\approx 13.3333...\n$$\n四舍五入到四位有效数字得到 $13.33$。",
            "answer": "$$\\boxed{13.33}$$"
        },
        {
            "introduction": "理论分析（如霍普夫分岔）得出的预测，需要通过数值方法进行验证，尤其是在处理复杂的非线性系统时。练习  介绍了一种精妙的计算工具——庞加莱（Poincaré）映射，它能将高维连续轨道的动力学行为简化为低维的离散映射。通过编程实现这一方法，我们可以从数值上严格地验证极限环的存在性与稳定性，从而架起理论分析与计算模拟之间的桥梁。",
            "id": "3905017",
            "problem": "您的任务是形式化并实现一个数值程序，以使用庞加莱截面及其回归映射来检测和验证激活-阻遏振荡器中的稳定极限环。待分析的系统是一个无量纲的三变量Goodwin型激活-阻遏振荡器，其基础是分子生物学的中心法则（脱氧核糖核酸到核糖核酸到蛋白质）和饱和Hill型调控，这些在合成生物学建模中被广泛使用并得到经验支持。状态变量为 $x_1$（激活剂信使核糖核酸）、$x_2$（激活蛋白）和 $x_3$（抑制蛋白）。控制常微分方程（ODE）如下：\n$$\n\\frac{dx_1}{dt} = \\frac{\\alpha}{1 + \\left(\\frac{x_3}{K}\\right)^p} - \\beta x_1,\\quad\n\\frac{dx_2}{dt} = k\\,(x_1 - x_2),\\quad\n\\frac{dx_3}{dt} = k\\,(x_2 - x_3).\n$$\n此处，$\\alpha$ 是最大转录速率，$\\beta$ 是mRNA降解速率，$k$ 是设定蛋白质时间尺度的集总翻译/降解速率，$K$ 是抑制作用的半饱和常数，$p$ 是表示抑制作用中协同性的Hill系数。这些选择与合成基因回路中经过充分测试的转录调控和降解公式一致。\n\n定义庞加莱截面为平面 $x_2 = s$，向上穿越条件为 $\\dot{x}_2  0$，并按如下方式在截面穿越处的抑制剂水平序列上定义回归映射 $\\mathcal{P}$。设 $r_n$ 为第 $n$ 次以 $\\dot{x}_2  0$ 穿越截面 $x_2 = s$ 时 $x_3$ 的值。回归映射为 $\\mathcal{P}(r_n) = r_{n+1}$。如果回归映射存在一个不动点 $r^\\star$ 满足 $\\mathcal{P}(r^\\star) = r^\\star$，并且该不动点处的导数满足 $|\\mathcal{P}'(r^\\star)|  1$，则存在一个稳定极限环。在数值上，这可以通过对ODE进行足够长时间的仿真以收集许多穿越点，构建点对 $\\{(r_n, r_{n+1})\\}$，从后期穿越点估计一个不动点 $r^\\star$，并通过对局限于暂态已衰减的后期区域的 $\\{(r_n, r_{n+1})\\}$ 进行局部线性拟合来估计回归映射在 $r^\\star$ 附近的局部斜率来验证。\n\n实现一个完整的程序以：\n- 从指定的初始条件将ODE积分到指定的最终时间，以收集 $x_2 = s$ 且 $\\dot{x}_2  0$ 的庞加莱截面穿越点。\n- 从序列 $\\{r_n\\}$ 构建回归映射。\n- 通过检查以下数值标准来检测稳定极限环的存在：\n  1. 已收集到足够数量的穿越点（至少达到一个最小计数以确保可靠的统计数据）。\n  2. 后期穿越点 $\\{r_n\\}$ 近似恒定（例如，最后一段的标准差很小）。\n  3. 回归映射在后期值附近的估计局部斜率的绝对值小于 $1$。\n\n本问题中的所有量均为无量纲。\n\n使用以下测试参数集和一个共用的截面水平：\n- 测试用例1（预计表现出稳定极限环）：$\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终仿真时间 $T = 400$。\n- 测试用例2（预计为非振荡性）：$\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 4$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终仿真时间 $T = 400$。\n- 测试用例3（由于驱动力较低，预计为非振荡性）：$\\alpha = 0.8$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终仿真时间 $T = 400$。\n\n您的程序应生成单行输出，包含一个方括号括起来的逗号分隔列表形式的结果。每个结果应为一个布尔值，指示在相应的测试用例中是否通过上述数值标准检测到稳定极限环，顺序与列表一致。例如，输出必须为 $[b_1,b_2,b_3]$ 的形式，其中每个 $b_i$ 为 $True$ 或 $False$。",
            "solution": "### 第1步：提取已知信息\n问题提供了以下信息：\n- **系统**：一个三变量激活-阻遏振荡器模型。\n- **状态变量**：$x_1$（激活剂mRNA）、$x_2$（激活蛋白）、$x_3$（抑制蛋白）。\n- **控制常微分方程 (ODE)**：\n$$\n\\frac{dx_1}{dt} = \\frac{\\alpha}{1 + \\left(\\frac{x_3}{K}\\right)^p} - \\beta x_1\n$$\n$$\n\\frac{dx_2}{dt} = k\\,(x_1 - x_2)\n$$\n$$\n\\frac{dx_3}{dt} = k\\,(x_2 - x_3)\n$$\n- **参数**：$\\alpha$（最大转录速率）、$\\beta$（mRNA降解速率）、$k$（集总蛋白质翻译/降解速率）、$K$（半饱和常数）、$p$（Hill系数）。\n- **庞加莱截面**：平面 $x_2 = s$，向上穿越条件为 $\\dot{x}_2  0$。\n- **回归映射**：$\\mathcal{P}(r_n) = r_{n+1}$，其中 $r_n$ 是第 $n$ 次向上穿越庞加莱截面时 $x_3$ 的值。\n- **稳定性条件**：如果存在一个不动点 $r^\\star$ 使得 $\\mathcal{P}(r^\\star) = r^\\star$ 并且 $|\\mathcal{P}'(r^\\star)|  1$，则存在一个稳定极限环。\n- **数值检测标准**：如果满足以下条件，则检测到稳定极限环：\n    1. 收集到足够数量的穿越点。\n    2. 后期穿越点 $\\{r_n\\}$ 的标准差很小。\n    3. 回归映射在后期值附近的估计局部斜率的绝对值小于 $1$。\n- **测试用例**：\n    - **测试用例1**：$\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终时间 $T = 400$。\n    - **测试用例2**：$\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 4$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终时间 $T = 400$。\n    - **测试用例3**：$\\alpha = 0.8$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终时间 $T = 400$。\n- **输出格式**：单行 `[b_1,b_2,b_3]`，其中 $b_i$ 为 `True` 或 `False`。\n\n### 第2步：使用提取的已知信息进行验证\n1.  **科学依据**：该问题基于带有Hill动力学的Goodwin振荡器模型，这是数学生物学和合成电路设计的基石。使用庞加莱截面和回归映射是动力系统理论中分析周期轨道的标准、严谨的技术。所有方面都具有科学合理性。\n2.  **适定性**：该问题是适定的。它提供了一套完整的ODE、参数和初始条件用于数值积分。目标明确定义：实现一个基于一组逻辑标准的特定数值程序来检测极限环。虽然某些数值阈值（如“最小计数”）没有明确给出，但定义它们是形式化数值算法的标准部分，不构成缺陷。\n3.  **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n4.  **其他缺陷**：对照检查清单复核后确认没有缺陷。模型是物理的，参数是无量纲且一致的，任务是可形式化的，并且该问题是动力系统中数值方法的非平凡应用。\n\n### 第3步：结论与行动\n问题是**有效的**。将提供解决方案。\n\n### 基于原理的解决方案设计\n核心任务是数值验证给定系统稳定极限环的存在性。解决方案遵循问题陈述中规定的方法论，这是计算动力学中的标准程序。\n\n**1. 系统积分与庞加莱截面穿越**\n使用高保真度求解器在时间区间 $[0, T]$ 上对常微分方程（ODE）系统进行数值积分。我们使用 `scipy.integrate.solve_ivp`，一个鲁棒的自适应步长ODE求解器。该求解器的一个关键特性是其检测事件的能力，这对于实现庞加莱截面是理想的。\n\n庞加莱截面定义为平面 $x_2 = s$。我们关心的是“向上”穿越，即轨迹以 $\\dot{x}_2  0$ 的方式穿过该平面。这通过一个事件函数 $g(t, \\mathbf{x}) = x_2(t) - s$ 实现，当 $g=0$ 时触发。求解器的 `direction=1` 选项确保仅当 $g$ 增加时才记录事件，这对应于 $\\dot{g} = \\dot{x}_2  0$。求解器配置为 `dense_output=True` 以便在每次穿越的精确时刻准确确定状态向量 $(x_1, x_2, x_3)$。\n\n**2. 回归映射的构建与分析**\n从每次穿越事件中，我们记录抑制蛋白状态变量 $x_3$ 的值，形成一个序列 $\\{r_n\\}_{n=1,2,\\dots}$。这个序列表示投影到庞加莱截面上的系统状态。回归映射 $\\mathcal{P}$ 关联了连续的穿越：$\\mathcal{P}(r_n) = r_{n+1}$。在完整的三维空间中的稳定极限环表现为这个一维回归映射的稳定不动点。不动点 $r^\\star$ 满足 $r^\\star = \\mathcal{P}(r^\\star)$，其稳定性要求映射在该不动点处的导数绝对值小于1：$|\\mathcal{P}'(r^\\star)|  1$。\n\n**3. 数值验证标准**\n我们将理论条件转化为一组具体的数值检查：\n\n- **标准1：足够的穿越次数。** 一个趋于稳定不动点的系统可能会穿越庞加莱截面几次或根本不穿越。相比之下，持续的振荡（如极限环）会产生大量的穿越。我们设定一个最小阈值 `MIN_CROSSINGS = 20`，以区分振荡行为和暂态穿越。如果在长时间仿真 $T=400$ 内检测到的穿越次数少于20次，我们断定不存在稳定的振荡。\n\n- **标准2：收敛到不动点。** 对于一个稳定的极限环，回归映射值序列 $\\{r_n\\}$ 必须收敛到不动点 $r^\\star$。我们通过检查收集到的序列的后半部分来评估这种收敛性，假设任何初始暂态都已衰减。我们计算这些后期点的标准差。如果该偏差超过一个小的阈值 `STD_DEV_THRESHOLD = 0.01`，则表明序列没有稳定下来，我们将其归类为不具有稳定极限环。\n\n- **标准3：不动点的稳定性 ($|\\mathcal{P}'(r^\\star)|  1$)。** 导数 $\\mathcal{P}'(r^\\star)$ 是回归映射在不动点处的局部斜率。我们通过对后期回归映射数据进行线性回归来估计此斜率，即对点 $(r_n, r_{n+1})$ 进行线性拟合。这条线的斜率提供了对 $\\mathcal{P}'(r^\\star)$ 的估计。根据稳定性理论，此斜率的绝对值必须严格小于 $1$。$|\\text{slope}| = 1$ 的情况代表边际稳定性，我们予以排除。因此，我们测试 `abs(slope)  1.0`。为确保拟合的鲁棒性，我们要求至少有 `MIN_FIT_PAIRS = 5` 个数据对。\n\n一个测试用例当且仅当所有三个数值标准都满足时，才被归类为具有稳定极限环。实现将系统地将此分析应用于测试套件中提供的每个参数集。",
            "answer": "[True,False,False]"
        }
    ]
}