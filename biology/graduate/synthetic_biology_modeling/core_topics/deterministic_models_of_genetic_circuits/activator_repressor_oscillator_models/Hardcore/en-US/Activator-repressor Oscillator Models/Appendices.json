{
    "hands_on_practices": [
        {
            "introduction": "Biological models often contain numerous parameters, obscuring the core principles at play. The technique of non-dimensionalization is a powerful way to simplify these models by rescaling variables to reveal the essential dimensionless groups that govern system behavior. This exercise  provides hands-on practice with this foundational technique, allowing you to identify the key parameter combinations controlling the activator-repressor circuit.",
            "id": "3905062",
            "problem": "Consider a minimal protein-only activator-repressor genetic oscillator modeled by ordinary differential equations (ODEs) for the concentrations of activator protein $A(t)$ and repressor protein $R(t)$. In this system, the activator $A$ activates production of $R$, and the repressor $R$ represses production of $A$. Assume production follows Hill-type regulatory functions with saturation and cooperativity, and that protein removal is first-order dilution-degradation. The dimensional ODEs are\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{\\alpha_A}{1 + \\left(\\frac{R}{K_R}\\right)^{n_r}} \\;-\\; \\delta_A\\, A,\n\\qquad\n\\frac{dR}{dt} \\;=\\; \\frac{\\alpha_R \\left(\\frac{A}{K_A}\\right)^{n_a}}{1 + \\left(\\frac{A}{K_A}\\right)^{n_a}} \\;-\\; \\delta_R\\, R,\n$$\nwhere $t$ is time, $\\alpha_A$ and $\\alpha_R$ are maximal protein synthesis rates, $\\delta_A$ and $\\delta_R$ are effective first-order removal rates, $K_A$ and $K_R$ are activation and repression thresholds, and $n_a$ and $n_r$ are Hill coefficients representing cooperativity. All parameters are positive constants.\n\nNon-dimensionalize the system by introducing the rescalings $A \\leftarrow A/K_A$, $R \\leftarrow R/K_R$, and $t \\leftarrow \\delta_A\\, t$. Derive the resulting dimensionless ODEs and identify the complete set of independent dimensionless parameters that control the dynamics. Express these parameters explicitly in terms of the original dimensional parameters and Hill coefficients. Provide, as your final answer, the row matrix consisting of these dimensionless parameters in the order $\\left(\\sigma_A, \\sigma_R, \\beta, n_a, n_r\\right)$, where $\\sigma_A$, $\\sigma_R$, and $\\beta$ are the appropriate dimensionless groups you identify. The final answer must be a single analytical expression. Do not include units in your final answer.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\nThe given dimensional system of ordinary differential equations (ODEs) is:\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{\\alpha_A}{1 + \\left(\\frac{R}{K_R}\\right)^{n_r}} \\;-\\; \\delta_A\\, A\n$$\n$$\n\\frac{dR}{dt} \\;=\\; \\frac{\\alpha_R \\left(\\frac{A}{K_A}\\right)^{n_a}}{1 + \\left(\\frac{A}{K_A}\\right)^{n_a}} \\;-\\; \\delta_R\\, R\n$$\nThe variables are the concentrations of activator protein, $A(t)$, and repressor protein, $R(t)$. The parameters are the maximal synthesis rates $\\alpha_A$ and $\\alpha_R$, the effective first-order removal rates $\\delta_A$ and $\\delta_R$, the activation and repression thresholds $K_A$ and $K_R$, and the Hill coefficients $n_a$ and $n_r$. All parameters are positive constants. The prescribed non-dimensionalizing rescalings are: $A \\leftarrow A/K_A$, $R \\leftarrow R/K_R$, and $t \\leftarrow \\delta_A\\, t$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing a standard activator-repressor model with Hill kinetics, which is a canonical example in systems and synthetic biology. The equations are well-established for modeling such genetic circuits. The problem is well-posed, as non-dimensionalization is a standard and unambiguous mathematical procedure. It is objective, complete, and contains no contradictions or scientifically unsound premises. Therefore, the problem is deemed valid.\n\n### Step 3: Derivation of the Solution\nWe introduce the dimensionless variables and dimensionless time as specified:\nLet $a$ be the dimensionless concentration of the activator, $r$ be the dimensionless concentration of the repressor, and $\\tau$ be dimensionless time.\n$$\na(\\tau) = \\frac{A(t)}{K_A} \\quad \\implies \\quad A(t) = K_A \\, a(\\tau)\n$$\n$$\nr(\\tau) = \\frac{R(t)}{K_R} \\quad \\implies \\quad R(t) = K_R \\, r(\\tau)\n$$\n$$\n\\tau = \\delta_A \\, t \\quad \\implies \\quad t = \\frac{\\tau}{\\delta_A}\n$$\nTo transform the derivatives with respect to $t$ into derivatives with respect to $\\tau$, we use the chain rule. First, for the activator concentration $A$:\n$$\n\\frac{dA}{dt} = \\frac{d}{dt} (K_A \\, a(\\tau)) = K_A \\, \\frac{da}{d\\tau} \\, \\frac{d\\tau}{dt}\n$$\nSince $\\tau = \\delta_A \\, t$, we have $\\frac{d\\tau}{dt} = \\delta_A$. Substituting this yields:\n$$\n\\frac{dA}{dt} = K_A \\, \\delta_A \\, \\frac{da}{d\\tau}\n$$\nSimilarly, for the repressor concentration $R$:\n$$\n\\frac{dR}{dt} = \\frac{d}{dt} (K_R \\, r(\\tau)) = K_R \\, \\frac{dr}{d\\tau} \\, \\frac{d\\tau}{dt} = K_R \\, \\delta_A \\, \\frac{dr}{d\\tau}\n$$\nNow, we substitute these expressions and the rescaled variables into the original ODEs.\n\nFor the first ODE (dynamics of $A$):\n$$\nK_A \\, \\delta_A \\, \\frac{da}{d\\tau} = \\frac{\\alpha_A}{1 + \\left(\\frac{K_R \\, r}{K_R}\\right)^{n_r}} - \\delta_A \\, (K_A \\, a)\n$$\n$$\nK_A \\, \\delta_A \\, \\frac{da}{d\\tau} = \\frac{\\alpha_A}{1 + r^{n_r}} - \\delta_A \\, K_A \\, a\n$$\nTo isolate $\\frac{da}{d\\tau}$, we divide the entire equation by $K_A \\, \\delta_A$:\n$$\n\\frac{da}{d\\tau} = \\frac{\\alpha_A}{K_A \\, \\delta_A \\, (1 + r^{n_r})} - a\n$$\nWe define the dimensionless parameter $\\sigma_A$ as the coefficient of the production term:\n$$\n\\sigma_A = \\frac{\\alpha_A}{K_A \\, \\delta_A}\n$$\nThe first dimensionless ODE is thus:\n$$\n\\frac{da}{d\\tau} = \\frac{\\sigma_A}{1 + r^{n_r}} - a\n$$\nFor the second ODE (dynamics of $R$):\n$$\nK_R \\, \\delta_A \\, \\frac{dr}{d\\tau} = \\frac{\\alpha_R \\left(\\frac{K_A \\, a}{K_A}\\right)^{n_a}}{1 + \\left(\\frac{K_A \\, a}{K_A}\\right)^{n_a}} - \\delta_R \\, (K_R \\, r)\n$$\n$$\nK_R \\, \\delta_A \\, \\frac{dr}{d\\tau} = \\frac{\\alpha_R \\, a^{n_a}}{1 + a^{n_a}} - \\delta_R \\, K_R \\, r\n$$\nTo isolate $\\frac{dr}{d\\tau}$, we divide the entire equation by $K_R \\, \\delta_A$:\n$$\n\\frac{dr}{d\\tau} = \\frac{\\alpha_R \\, a^{n_a}}{K_R \\, \\delta_A \\, (1 + a^{n_a})} - \\frac{\\delta_R \\, K_R \\, r}{K_R \\, \\delta_A}\n$$\n$$\n\\frac{dr}{d\\tau} = \\left(\\frac{\\alpha_R}{K_R \\, \\delta_A}\\right) \\frac{a^{n_a}}{1 + a^{n_a}} - \\left(\\frac{\\delta_R}{\\delta_A}\\right) r\n$$\nWe identify two new dimensionless parameters from the coefficients. Following the problem's notation:\n$$\n\\sigma_R = \\frac{\\alpha_R}{K_R \\, \\delta_A}\n$$\n$$\n\\beta = \\frac{\\delta_R}{\\delta_A}\n$$\nThe second dimensionless ODE is thus:\n$$\n\\frac{dr}{d\\tau} = \\sigma_R \\frac{a^{n_a}}{1 + a^{n_a}} - \\beta \\, r\n$$\nThe complete dimensionless system is:\n$$\n\\frac{da}{d\\tau} = \\frac{\\sigma_A}{1 + r^{n_r}} - a\n$$\n$$\n\\frac{dr}{d\\tau} = \\sigma_R \\frac{a^{n_a}}{1 + a^{n_a}} - \\beta \\, r\n$$\nThe dynamics of this system are controlled by the set of independent dimensionless parameters appearing in these equations. These are the three dimensionless groups we derived, $\\sigma_A$, $\\sigma_R$, and $\\beta$, as well as the Hill coefficients, $n_a$ and $n_r$, which are inherently dimensionless.\n\nThe complete set of dimensionless parameters is therefore $(\\sigma_A, \\sigma_R, \\beta, n_a, n_r)$, where:\n- $\\sigma_A = \\frac{\\alpha_A}{K_A \\, \\delta_A}$ (dimensionless max synthesis rate of $A$)\n- $\\sigma_R = \\frac{\\alpha_R}{K_R \\, \\delta_A}$ (dimensionless max synthesis rate of $R$, scaled by $A$'s removal rate)\n- $\\beta = \\frac{\\delta_R}{\\delta_A}$ (ratio of removal rates)\n- $n_a$ (activator cooperativity)\n- $n_r$ (repressor cooperativity)\n\nThe final answer is the row matrix containing these parameters in the specified order.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha_A}{K_A \\delta_A}  \\frac{\\alpha_R}{K_R \\delta_A}  \\frac{\\delta_R}{\\delta_A}  n_a  n_r\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Oscillations in gene circuits typically arise when a stable steady state becomes unstable. This exercise  guides you through linear stability analysis, a cornerstone of dynamical systems theory, to understand this transition. You will use the Jacobian matrix and its eigenvalues to pinpoint the exact parameter threshold for a Hopf bifurcation, the mathematical event that signals the birth of sustained oscillations.",
            "id": "3905049",
            "problem": "Consider a minimal two-gene activator–repressor oscillator described by ordinary differential equations (ODEs) based on Hill-type transcriptional regulation derived from the Central Dogma of Molecular Biology (DNA to RNA to protein) and standard mass-action degradation. Let $A(t)$ denote the concentration of the activator protein and $R(t)$ denote the concentration of the repressor protein. The model is\n$$\n\\frac{dA}{dt} \\;=\\; \\alpha_A\\,g(R) \\;+\\; \\gamma_A\\,f(A) \\;-\\; \\delta_A\\,A,\n\\qquad\n\\frac{dR}{dt} \\;=\\; \\alpha_R\\,f(A) \\;-\\; \\delta_R\\,R,\n$$\nwhere $f(A)$ and $g(R)$ are Hill functions for activation and repression, respectively,\n$$\nf(A) \\;=\\; \\frac{A^{n_A}}{K_A^{n_A} + A^{n_A}},\n\\qquad\ng(R) \\;=\\; \\frac{1}{1 + \\left(\\frac{R}{K_R}\\right)^{n_R}}.\n$$\nAll parameters are positive and biologically interpretable: $\\alpha_A$ and $\\alpha_R$ are maximal production coefficients (with units of concentration per unit time), $\\gamma_A$ is the activator gain (with units of concentration per unit time) multiplying the self-activation term, $\\delta_A$ and $\\delta_R$ are first-order degradation/dilution rates (with units of inverse time), $K_A$ and $K_R$ are half-saturation constants (with units of concentration), and $n_A$ and $n_R$ are Hill cooperativity exponents.\n\nFor the specific parameter set\n$$\nn_A = 6,\\quad n_R = 2,\\quad K_A = 50\\,\\text{nM},\\quad K_R = 40\\,\\text{nM},\\quad \\delta_A = 0.3\\,\\text{h}^{-1},\\quad \\delta_R = 0.1\\,\\text{h}^{-1},\n$$\nassume the operating point is held at the half-saturation concentrations $A^{\\ast} = K_A$ and $R^{\\ast} = K_R$ for all values of $\\gamma_A$ by choosing\n$$\n\\alpha_R = 2\\,\\delta_R\\,K_R,\\qquad \\alpha_A = 2\\,\\delta_A\\,K_A - \\gamma_A,\n$$\nso that the steady-state conditions $\\frac{dA}{dt} = 0$ and $\\frac{dR}{dt} = 0$ are satisfied at $A^{\\ast} = K_A$, $R^{\\ast} = K_R$.\n\nTasks:\n1. Derive the Jacobian matrix of the linearization of the ODEs about the equilibrium $(A^{\\ast},R^{\\ast}) = (K_A,K_R)$.\n2. Compute the eigenvalues $\\lambda_{\\pm}(\\gamma_A)$ of the Jacobian as a function of $\\gamma_A$ for the given parameter set.\n3. Determine the critical activator gain $\\gamma_A^{\\ast}$ at which the eigenvalues cross the imaginary axis (i.e., the real part is zero), and verify that the determinant of the Jacobian is positive at $\\gamma_A^{\\ast}$ so the crossing is a Hopf-type instability of a complex-conjugate pair.\n4. Evaluate the real parts of $\\lambda_{\\pm}(\\gamma_A)$ at $\\gamma_A = 12\\,\\text{nM}\\,\\text{h}^{-1}$ and $\\gamma_A = 15\\,\\text{nM}\\,\\text{h}^{-1}$ to confirm that the real parts change sign as $\\gamma_A$ increases through $\\gamma_A^{\\ast}$.\n\nExpress the final numerical value of the critical activator gain $\\gamma_A^{\\ast}$ in $\\text{nM}\\,\\text{h}^{-1}$ and round your answer to four significant figures.",
            "solution": "The problem asks for an analysis of a two-gene activator-repressor oscillator model. The process involves linearizing the system around a specified equilibrium point, analyzing the eigenvalues of the resulting Jacobian matrix, and determining the critical parameter value for a Hopf bifurcation.\n\nThe system of ordinary differential equations (ODEs) is given by:\n$$\n\\frac{dA}{dt} = F(A, R) = \\alpha_A\\,g(R) + \\gamma_A\\,f(A) - \\delta_A\\,A\n$$\n$$\n\\frac{dR}{dt} = G(A, R) = \\alpha_R\\,f(A) - \\delta_R\\,R\n$$\nwhere the Hill functions are\n$$\nf(A) = \\frac{A^{n_A}}{K_A^{n_A} + A^{n_A}} \\quad \\text{and} \\quad g(R) = \\frac{1}{1 + \\left(\\frac{R}{K_R}\\right)^{n_R}} = \\frac{K_R^{n_R}}{K_R^{n_R} + R^{n_R}}\n$$\nAll parameters are positive. The analysis is performed at the equilibrium point $(A^{\\ast}, R^{\\ast}) = (K_A, K_R)$.\n\n**Task 1: Derive the Jacobian matrix.**\nThe Jacobian matrix $J$ of the system is given by:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial F}{\\partial A}  \\frac{\\partial F}{\\partial R} \\\\ \\frac{\\partial G}{\\partial A}  \\frac{\\partial G}{\\partial R} \\end{pmatrix}\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial F}{\\partial A} = \\gamma_A f'(A) - \\delta_A\n$$\n$$\n\\frac{\\partial F}{\\partial R} = \\alpha_A g'(R)\n$$\n$$\n\\frac{\\partial G}{\\partial A} = \\alpha_R f'(A)\n$$\n$$\n\\frac{\\partial G}{\\partial R} = -\\delta_R\n$$\nWe need to evaluate the derivatives of the Hill functions, $f'(A)$ and $g'(R)$:\n$$\nf'(A) = \\frac{d}{dA}\\left(\\frac{A^{n_A}}{K_A^{n_A} + A^{n_A}}\\right) = \\frac{n_A K_A^{n_A} A^{n_A-1}}{(K_A^{n_A} + A^{n_A})^2}\n$$\n$$\ng'(R) = \\frac{d}{dR}\\left(\\frac{K_R^{n_R}}{K_R^{n_R} + R^{n_R}}\\right) = -\\frac{n_R K_R^{n_R} R^{n_R-1}}{(K_R^{n_R} + R^{n_R})^2}\n$$\nNow, we evaluate these derivatives at the equilibrium point $(A^{\\ast}, R^{\\ast}) = (K_A, K_R)$:\n$$\nf'(A^{\\ast}) = f'(K_A) = \\frac{n_A K_A^{n_A} K_A^{n_A-1}}{(K_A^{n_A} + K_A^{n_A})^2} = \\frac{n_A K_A^{2n_A-1}}{(2K_A^{n_A})^2} = \\frac{n_A}{4K_A}\n$$\n$$\ng'(R^{\\ast}) = g'(K_R) = -\\frac{n_R K_R^{n_R} K_R^{n_R-1}}{(K_R^{n_R} + K_R^{n_R})^2} = -\\frac{n_R K_R^{2n_R-1}}{(2K_R^{n_R})^2} = -\\frac{n_R}{4K_R}\n$$\nThe Jacobian matrix evaluated at the equilibrium, $J^{\\ast}$, has the following elements:\n$$\nJ^{\\ast}_{11} = \\gamma_A f'(A^{\\ast}) - \\delta_A = \\gamma_A \\frac{n_A}{4K_A} - \\delta_A\n$$\n$$\nJ^{\\ast}_{12} = \\alpha_A g'(R^{\\ast}) = \\alpha_A \\left(-\\frac{n_R}{4K_R}\\right)\n$$\n$$\nJ^{\\ast}_{21} = \\alpha_R f'(A^{\\ast}) = \\alpha_R \\frac{n_A}{4K_A}\n$$\n$$\nJ^{\\ast}_{22} = -\\delta_R\n$$\nThe problem specifies that $\\alpha_R = 2\\delta_R K_R$ and $\\alpha_A = 2\\delta_A K_A - \\gamma_A$. Substituting these into the Jacobian elements:\n$$\nJ^{\\ast}_{12} = (2\\delta_A K_A - \\gamma_A) \\left(-\\frac{n_R}{4K_R}\\right)\n$$\n$$\nJ^{\\ast}_{21} = (2\\delta_R K_R) \\frac{n_A}{4K_A} = \\frac{n_A \\delta_R K_R}{2K_A}\n$$\nSo, the Jacobian matrix at the equilibrium $(K_A, K_R)$ is:\n$$\nJ^{\\ast} = \\begin{pmatrix} \\gamma_A \\frac{n_A}{4K_A} - \\delta_A  (2\\delta_A K_A - \\gamma_A) \\left(-\\frac{n_R}{4K_R}\\right) \\\\ \\frac{n_A \\delta_R K_R}{2K_A}  -\\delta_R \\end{pmatrix}\n$$\n\n**Task 2: Compute the eigenvalues $\\lambda_{\\pm}(\\gamma_A)$.**\nFirst, we substitute the given parameter values into the Jacobian matrix components:\n$n_A = 6$, $n_R = 2$, $K_A = 50\\,\\text{nM}$, $K_R = 40\\,\\text{nM}$, $\\delta_A = 0.3\\,\\text{h}^{-1}$, $\\delta_R = 0.1\\,\\text{h}^{-1}$.\n$$\nJ^{\\ast}_{11} = \\gamma_A \\frac{6}{4(50)} - 0.3 = \\gamma_A \\frac{6}{200} - 0.3 = 0.03\\,\\gamma_A - 0.3\n$$\n$$\nJ^{\\ast}_{12} = (2(0.3)(50) - \\gamma_A) \\left(-\\frac{2}{4(40)}\\right) = (30 - \\gamma_A) \\left(-\\frac{2}{160}\\right) = (30 - \\gamma_A) \\left(-\\frac{1}{80}\\right) = \\frac{\\gamma_A}{80} - \\frac{30}{80} = 0.0125\\,\\gamma_A - 0.375\n$$\n$$\nJ^{\\ast}_{21} = \\frac{6(0.1)(40)}{2(50)} = \\frac{24}{100} = 0.24\n$$\n$$\nJ^{\\ast}_{22} = -0.1\n$$\nThe Jacobian matrix is:\n$$\nJ^{\\ast} = \\begin{pmatrix} 0.03\\,\\gamma_A - 0.3  0.0125\\,\\gamma_A - 0.375 \\\\ 0.24  -0.1 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ are the roots of the characteristic polynomial $\\det(J^{\\ast} - \\lambda I) = 0$, which is $\\lambda^2 - \\text{Tr}(J^{\\ast})\\lambda + \\det(J^{\\ast}) = 0$.\nThe trace of the Jacobian is:\n$$\n\\text{Tr}(J^{\\ast}) = J^{\\ast}_{11} + J^{\\ast}_{22} = (0.03\\,\\gamma_A - 0.3) + (-0.1) = 0.03\\,\\gamma_A - 0.4\n$$\nThe determinant of the Jacobian is:\n$$\n\\det(J^{\\ast}) = J^{\\ast}_{11} J^{\\ast}_{22} - J^{\\ast}_{12} J^{\\ast}_{21} = (0.03\\,\\gamma_A - 0.3)(-0.1) - (0.0125\\,\\gamma_A - 0.375)(0.24)\n$$\n$$\n\\det(J^{\\ast}) = -0.003\\,\\gamma_A + 0.03 - (0.003\\,\\gamma_A - 0.09) = -0.006\\,\\gamma_A + 0.12\n$$\nThe eigenvalues are given by the quadratic formula:\n$$\n\\lambda_{\\pm}(\\gamma_A) = \\frac{\\text{Tr}(J^{\\ast}) \\pm \\sqrt{\\text{Tr}(J^{\\ast})^2 - 4\\det(J^{\\ast})}}{2}\n$$\n$$\n\\lambda_{\\pm}(\\gamma_A) = \\frac{1}{2}\\left( (0.03\\,\\gamma_A - 0.4) \\pm \\sqrt{(0.03\\,\\gamma_A - 0.4)^2 - 4(-0.006\\,\\gamma_A + 0.12)} \\right)\n$$\n\n**Task 3: Determine the critical activator gain $\\gamma_A^{\\ast}$.**\nA Hopf bifurcation occurs when a pair of complex conjugate eigenvalues crosses the imaginary axis. This requires the real part of the eigenvalues to be zero, and the imaginary part to be non-zero. The real part of the eigenvalues is $\\text{Re}(\\lambda_{\\pm}) = \\text{Tr}(J^{\\ast})/2$.\nThe crossing occurs when $\\text{Tr}(J^{\\ast}) = 0$.\n$$\n0.03\\,\\gamma_A^{\\ast} - 0.4 = 0\n$$\n$$\n\\gamma_A^{\\ast} = \\frac{0.4}{0.03} = \\frac{40}{3} \\approx 13.333...\n$$\nThe units of $\\gamma_A^{\\ast}$ are $\\text{nM}\\,\\text{h}^{-1}$.\nFor a Hopf bifurcation, we must also verify that the eigenvalues are indeed complex at this point, which requires the discriminant $\\text{Tr}(J^{\\ast})^2 - 4\\det(J^{\\ast})$ to be negative. Since $\\text{Tr}(J^{\\ast}) = 0$ at $\\gamma_A^{\\ast}$, this condition simplifies to $-4\\det(J^{\\ast})  0$, or $\\det(J^{\\ast}) > 0$.\nLet's evaluate the determinant at $\\gamma_A^{\\ast} = 40/3$:\n$$\n\\det(J^{\\ast})|_{\\gamma_A^{\\ast}} = -0.006\\left(\\frac{40}{3}\\right) + 0.12 = -0.002(40) + 0.12 = -0.08 + 0.12 = 0.04\n$$\nSince $\\det(J^{\\ast})|_{\\gamma_A^{\\ast}} = 0.04 > 0$, a pair of complex conjugate eigenvalues crosses the imaginary axis at $\\gamma_A^{\\ast} = 40/3$, which is a Hopf bifurcation. The eigenvalues at this point are $\\lambda_{\\pm} = \\pm i\\sqrt{\\det(J^{\\ast})} = \\pm i\\sqrt{0.04} = \\pm 0.2i$.\n\n**Task 4: Evaluate the real parts of $\\lambda_{\\pm}(\\gamma_A)$ at specific values.**\nThe real part of the eigenvalues is $\\text{Re}(\\lambda_{\\pm}) = \\frac{1}{2}\\text{Tr}(J^{\\ast}) = \\frac{1}{2}(0.03\\,\\gamma_A - 0.4) = 0.015\\,\\gamma_A - 0.2$.\nFor $\\gamma_A = 12\\,\\text{nM}\\,\\text{h}^{-1}$ (below the critical value $\\gamma_A^{\\ast} \\approx 13.33$):\n$$\n\\text{Re}(\\lambda_{\\pm}) = 0.015(12) - 0.2 = 0.18 - 0.2 = -0.02\n$$\nThe real part is negative, indicating the equilibrium is stable.\n\nFor $\\gamma_A = 15\\,\\text{nM}\\,\\text{h}^{-1}$ (above the critical value $\\gamma_A^{\\ast} \\approx 13.33$):\n$$\n\\text{Re}(\\lambda_{\\pm}) = 0.015(15) - 0.2 = 0.225 - 0.2 = 0.025\n$$\nThe real part is positive, indicating the equilibrium is unstable. This confirms that the real parts of the eigenvalues change sign from negative to positive as $\\gamma_A$ increases through the critical value $\\gamma_A^{\\ast}$, consistent with a Hopf bifurcation leading to oscillations.\n\nThe question asks for the numerical value of the critical activator gain $\\gamma_A^{\\ast}$ rounded to four significant figures.\n$$\n\\gamma_A^{\\ast} = \\frac{40}{3} \\approx 13.3333...\n$$\nRounding to four significant figures gives $13.33$.",
            "answer": "$$\\boxed{13.33}$$"
        },
        {
            "introduction": "While analytical methods are powerful, many nonlinear systems are too complex to solve with pen and paper, requiring computational verification. This practice  introduces the Poincaré map, a fundamental tool for analyzing periodic orbits in state space. You will implement a numerical algorithm to find a limit cycle and test its stability, bridging the gap between theoretical prediction and computational proof.",
            "id": "3905017",
            "problem": "You are asked to formalize and implement a numerical procedure to detect and validate a stable limit cycle in an activator–repressor oscillator using a Poincaré section and its return map. The system to be analyzed is a dimensionless, three-variable Goodwin-type activator–repressor oscillator grounded in the Central Dogma of molecular biology (deoxyribonucleic acid to ribonucleic acid to protein) and saturating Hill-type regulation, which are widely used and empirically supported in synthetic biology modeling. The state variables are $x_1$ (activator messenger ribonucleic acid), $x_2$ (activator protein), and $x_3$ (repressor protein). The governing ordinary differential equations (ODEs) are:\n$$\n\\frac{dx_1}{dt} = \\frac{\\alpha}{1 + \\left(\\frac{x_3}{K}\\right)^p} - \\beta x_1,\\quad\n\\frac{dx_2}{dt} = k\\,(x_1 - x_2),\\quad\n\\frac{dx_3}{dt} = k\\,(x_2 - x_3).\n$$\nHere, $\\alpha$ is the maximal transcription rate, $\\beta$ is the mRNA degradation rate, $k$ is a lumped translation/degradation rate setting protein timescale, $K$ is the half-saturation constant of repression, and $p$ is the Hill coefficient representing cooperativity in repression. These choices are consistent with well-tested formulations of transcriptional regulation and degradation in synthetic gene circuits.\n\nDefine a Poincaré section as the plane $x_2 = s$ with an upward crossing condition $\\dot{x}_2  0$, and define the return map $\\mathcal{P}$ on the sequence of repressor levels at section crossings as follows. Let $r_n$ denote the value of $x_3$ at the $n$-th crossing of the section $x_2 = s$ with $\\dot{x}_2  0$. The return map is $\\mathcal{P}(r_n) = r_{n+1}$. A stable limit cycle exists if the return map has a fixed point $r^\\star$ satisfying $\\mathcal{P}(r^\\star) = r^\\star$ and the derivative at the fixed point satisfies $\\left|\\mathcal{P}'(r^\\star)\\right|  1$. Numerically, this can be verified by simulating the ODE long enough to collect many crossings, constructing the pairs $\\{(r_n, r_{n+1})\\}$, estimating a fixed point $r^\\star$ from late-time crossings, and estimating the local slope of the return map near $r^\\star$ via a local linear fit to $\\{(r_n, r_{n+1})\\}$ restricted to the late-time region where transients have decayed.\n\nImplement a complete program to:\n- Integrate the ODE from a specified initial condition to a specified final time to collect Poincaré section crossings with $x_2 = s$ and $\\dot{x}_2  0$.\n- Construct the return map from the sequence $\\{r_n\\}$.\n- Detect the presence of a stable limit cycle by checking the following numerical criteria:\n  1. A sufficient number of crossings have been collected (at least a minimum count to ensure reliable statistics).\n  2. The late-time crossings $\\{r_n\\}$ are approximately constant (for example, a small standard deviation over the final segment).\n  3. The estimated local slope of the return map near the late-time value has magnitude less than $1$.\n\nAll quantities in this problem are dimensionless.\n\nUse the following test suite of parameter sets and a single, shared section level:\n- Test case $1$ (expected to exhibit a stable limit cycle): $\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$, initial condition $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$, final simulation time $T = 400$.\n- Test case $2$ (expected to be non-oscillatory): $\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 4$, $s = 0.9$, initial condition $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$, final simulation time $T = 400$.\n- Test case $3$ (expected to be non-oscillatory due to lower drive): $\\alpha = 0.8$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$, initial condition $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$, final simulation time $T = 400$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each result should be a boolean indicating whether a stable limit cycle has been detected by the above numerical criteria in the corresponding test case, in the order listed. For example, the output must be of the form $[b_1,b_2,b_3]$ where each $b_i$ is either $True$ or $False$.",
            "solution": "### Step 1: Extract Givens\nThe problem provides the following information:\n- **System**: A three-variable activator–repressor oscillator model.\n- **State Variables**: $x_1$ (activator mRNA), $x_2$ (activator protein), $x_3$ (repressor protein).\n- **Governing ODEs**:\n$$\n\\frac{dx_1}{dt} = \\frac{\\alpha}{1 + \\left(\\frac{x_3}{K}\\right)^p} - \\beta x_1\n$$\n$$\n\\frac{dx_2}{dt} = k\\,(x_1 - x_2)\n$$\n$$\n\\frac{dx_3}{dt} = k\\,(x_2 - x_3)\n$$\n- **Parameters**: $\\alpha$ (maximal transcription rate), $\\beta$ (mRNA degradation rate), $k$ (lumped protein translation/degradation rate), $K$ (half-saturation constant), $p$ (Hill coefficient).\n- **Poincaré Section**: The plane $x_2 = s$ with an upward crossing condition $\\dot{x}_2 > 0$.\n- **Return Map**: $\\mathcal{P}(r_n) = r_{n+1}$, where $r_n$ is the value of $x_3$ at the $n$-th upward crossing of the Poincaré section.\n- **Stability Condition**: A stable limit cycle exists if there is a fixed point $r^\\star$ such that $\\mathcal{P}(r^\\star) = r^\\star$ and $|\\mathcal{P}'(r^\\star)|  1$.\n- **Numerical Detection Criteria**: A stable limit cycle is detected if:\n    1. A sufficient number of crossings are collected.\n    2. The standard deviation of late-time crossings $\\{r_n\\}$ is small.\n    3. The estimated local slope of the return map near the late-time value has a magnitude less than $1$.\n- **Test Cases**:\n    - **Test Case 1**: $\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$, initial condition $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$, final time $T = 400$.\n    - **Test Case 2**: $\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 4$, $s = 0.9$, initial condition $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$, final time $T = 400$.\n    - **Test Case 3**: $\\alpha = 0.8$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$, initial condition $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$, final time $T = 400$.\n- **Output Format**: A single line `[b_1,b_2,b_3]` where $b_i$ is `True` or `False`.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is built upon the Goodwin oscillator model with Hill kinetics, a cornerstone of mathematical biology and synthetic circuit design. The use of a Poincaré section and return map is a standard, rigorous technique from dynamical systems theory for analyzing periodic orbits. All aspects are scientifically sound.\n2.  **Well-Posed**: The problem is well-posed. It provides a complete set of ODEs, parameters, and initial conditions for numerical integration. The objective is clearly defined: to implement a specific numerical procedure for detecting limit cycles based on a set of logical criteria. While some numerical thresholds are not explicitly given (e.g., \"minimum count\"), defining them is a standard part of formalizing a numerical algorithm and does not constitute a flaw.\n3.  **Objective**: The problem is stated in precise and objective mathematical language, free from ambiguity or subjective claims.\n4.  **Other Flaws**: A review against the checklist confirms no flaws. The model is physical, the parameters are dimensionless and consistent, the task is formalizable, and the problem is a non-trivial application of numerical methods in dynamical systems.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Principle-Based Design of the Solution\nThe core task is to numerically verify the existence of a stable limit cycle for the given system. The solution follows the methodology prescribed in the problem statement, which is a standard procedure in computational dynamics.\n\n**1. System Integration and Poincaré Section Crossings**\nThe system of ordinary differential equations (ODEs) is numerically integrated over the time interval $[0, T]$ using a high-fidelity solver. We use `scipy.integrate.solve_ivp`, a robust adaptive step-size ODE solver. A key feature of this solver is its ability to detect events, which is ideal for implementing a Poincaré section.\n\nThe Poincaré section is defined as the plane $x_2 = s$. We are interested in \"upward\" crossings, where the trajectory passes through this plane with $\\dot{x}_2 > 0$. This is implemented using an event function, $g(t, \\mathbf{x}) = x_2(t) - s$, which triggers when $g=0$. The solver's `direction=1` option ensures that events are recorded only when $g$ is increasing, which corresponds to $\\dot{g} = \\dot{x}_2 > 0$. The solver is configured with `dense_output=True` to accurately determine the state vector $(x_1, x_2, x_3)$ at the precise moment of each crossing.\n\n**2. Return Map Construction and Analysis**\nFrom each crossing event, we record the value of the repressor protein state variable, $x_3$, to form a sequence $\\{r_n\\}_{n=1,2,\\dots}$. This sequence represents the system's state projected onto the Poincaré section. The return map $\\mathcal{P}$ relates consecutive crossings: $\\mathcal{P}(r_n) = r_{n+1}$. A stable limit cycle in the full $3$-dimensional space manifests as a stable fixed point of this $1$-dimensional return map. A fixed point $r^\\star$ satisfies $r^\\star = \\mathcal{P}(r^\\star)$, and its stability requires the magnitude of the map's derivative at the fixed point to be less than one: $|\\mathcal{P}'(r^\\star)|  1$.\n\n**3. Numerical Verification Criteria**\nWe translate the theoretical conditions into a set of concrete numerical checks:\n\n- **Criterion 1: Sufficient Crossings.** A system settling to a stable fixed point might cross the Poincaré section a few times or not at all. In contrast, a persistent oscillation (like a limit cycle) will generate a large number of crossings. We establish a minimum threshold, `MIN_CROSSINGS = 20`, to distinguish oscillatory behavior from transient crossings. If fewer than $20$ crossings are detected over the long simulation time $T=400$, we conclude that no stable oscillation exists.\n\n- **Criterion 2: Convergence to a Fixed Point.** For a stable limit cycle, the sequence of return map values $\\{r_n\\}$ must converge to the fixed point $r^\\star$. We assess this convergence by examining the latter half of the collected sequence, assuming that any initial transients have decayed. We calculate the standard deviation of these late-time points. If this deviation exceeds a small threshold, `STD_DEV_THRESHOLD = 0.01`, it indicates that the sequence has not settled, and we classify the system as not having a stable limit cycle.\n\n- **Criterion 3: Stability of the Fixed Point ($|\\mathcal{P}'(r^\\star)|  1$).** The derivative $\\mathcal{P}'(r^\\star)$ is the local slope of the return map at the fixed point. We estimate this slope by performing a linear regression on the late-time return map data, i.e., fitting a line to the points $(r_n, r_{n+1})$. The slope of this line provides an estimate for $\\mathcal{P}'(r^\\star)$. According to stability theory, the magnitude of this slope must be strictly less than $1$. The case $|\\text{slope}| = 1$ represents marginal stability, which we exclude. Therefore, we test if `abs(slope)  1.0`. To ensure a robust fit, we require a minimum number of data pairs, `MIN_FIT_PAIRS = 5`.\n\nA test case is classified as having a stable limit cycle if and only if all three numerical criteria are satisfied. The implementation will systematically apply this analysis to each parameter set provided in the test suite.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef analyze_system(case):\n    \"\"\"\n    Analyzes a single test case of the activator-repressor oscillator model to\n    detect a stable limit cycle using a Poincaré section analysis.\n\n    Args:\n        case (tuple): A tuple containing the model parameters and simulation settings:\n            (alpha, beta, k, K, p, s, x0_tuple, T).\n\n    Returns:\n        bool: True if a stable limit cycle is detected, False otherwise.\n    \"\"\"\n    alpha, beta, k, K, p, s, x0_tuple, T = case\n    x0 = np.array(x0_tuple)\n\n    # Define numerical thresholds for detection criteria.\n    MIN_CROSSINGS = 20\n    STD_DEV_THRESHOLD = 0.01\n    STABILITY_SLOPE_MAG_MAX = 1.0 # Stability requires |slope|  1\n    MIN_FIT_PAIRS = 5 # Minimum pairs (r_n, r_{n+1}) for a reliable fit\n    ILL_CONDITION_STD_THRESH = 1e-9 # Threshold to detect ill-conditioned fit\n\n    # 1. Define the ODE system for the model.\n    def model(t, y, alpha, beta, k, K, p):\n        x1, x2, x3 = y\n        dx1_dt = alpha / (1.0 + (x3 / K)**p) - beta * x1\n        dx2_dt = k * (x1 - x2)\n        dx3_dt = k * (x2 - x3)\n        return [dx1_dt, dx2_dt, dx3_dt]\n\n    # 2. Define the event function for the Poincaré section.\n    # The event is triggered when x2(t) - s = 0.\n    def poincare_event(t, y, s_level):\n        return y[1] - s_level\n\n    # Set event properties:\n    # direction=1 detects upward crossings (function goes from negative to positive).\n    # This corresponds to d/dt(y[1]-s)  0, which means dy[1]/dt  0.\n    poincare_event.direction = 1\n    # Do not terminate integration upon event detection.\n    poincare_event.terminal = False\n\n    # 3. Integrate the ODE system.\n    sol = solve_ivp(\n        fun=lambda t, y: model(t, y, alpha, beta, k, K, p),\n        t_span=[0, T],\n        y0=x0,\n        events=lambda t, y: poincare_event(t, y, s),\n        dense_output=True,\n        rtol=1e-8,\n        atol=1e-10\n    )\n\n    # --- Apply numerical detection criteria ---\n\n    # Criterion 1: Check for a sufficient number of crossings.\n    # sol.t_events is a list, one per event function. We have one.\n    if not sol.t_events or len(sol.t_events[0])  MIN_CROSSINGS:\n        return False\n    \n    # sol.y_events is a list of arrays. We need the first one.\n    # It has shape (n_events, n_vars).\n    crossings_y = sol.y_events[0]\n    # The return map is defined on r_n = x_3 at the crossings.\n    r_sequence = crossings_y[:, 2]\n\n    # Analyze the latter half of the crossings to ensure transients have decayed.\n    num_crossings = len(r_sequence)\n    analysis_start_index = num_crossings // 2\n    late_r_sequence = r_sequence[analysis_start_index:]\n\n    # Criterion 2: Check for convergence of the return map fixed point.\n    # A stable limit cycle implies r_n converges to a fixed point r*.\n    # Test this by checking if the standard deviation of late-time r_n is small.\n    if np.std(late_r_sequence) = STD_DEV_THRESHOLD:\n        return False\n        \n    # Criterion 3: Estimate slope of the return map and check for stability.\n    # The return map is P(r_n) = r_{n+1}. Stability requires |P'(r*)|  1.\n    # We approximate this by a linear fit to (r_n, r_{n+1}) for late n.\n    map_domain = late_r_sequence[:-1]\n    map_codomain = late_r_sequence[1:]\n\n    # We need at least a few pairs for a meaningful fit.\n    if len(map_domain)  MIN_FIT_PAIRS:\n        return False\n        \n    # Handle ill-conditioned cases where all x-values are the same.\n    # This would imply perfect convergence to a fixed point, where the\n    # theoretical slope is 1 (marginal stability), failing the |slope|1 test.\n    if np.std(map_domain)  ILL_CONDITION_STD_THRESH:\n        return False\n\n    # Perform linear regression: y = m*x + c\n    slope, _ = np.polyfit(map_domain, map_codomain, 1)\n\n    # np.polyfit can return nan on ill-conditioned data.\n    if np.isnan(slope) or abs(slope) = STABILITY_SLOPE_MAG_MAX:\n        return False\n\n    # If all criteria are met, we conclude a stable limit cycle exists.\n    return True\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis on all predefined test cases and\n    print the results in the specified format.\n    \"\"\"\n    # Test case parameters: (alpha, beta, k, K, p, s, initial_condition, T)\n    test_cases = [\n        # Case 1: Expected to exhibit a stable limit cycle\n        (1.2, 1.0, 1.0, 1.0, 12, 0.9, (0.1, 0.1, 0.1), 400),\n        # Case 2: Expected to be non-oscillatory (stable fixed point)\n        (1.2, 1.0, 1.0, 1.0, 4, 0.9, (0.1, 0.1, 0.1), 400),\n        # Case 3: Expected to be non-oscillatory (lower drive)\n        (0.8, 1.0, 1.0, 1.0, 12, 0.9, (0.1, 0.1, 0.1), 400),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_system(case)\n        results.append(result)\n\n    # The final print statement must follow the exact specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}