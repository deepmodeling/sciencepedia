{
    "hands_on_practices": [
        {
            "introduction": "在分析复杂的生物系统时，大量的参数往往会使问题变得棘手。无量纲化是一种强大的数学技术，它通过将变量和参数重新缩放，将模型的参数数量减少为一组核心的无量纲组合。这项练习将指导您对一个经典的激活子-抑制子振荡器模型进行无量纲化，从而揭示出真正控制系统动态的关键参数比率，为后续的分析奠定基础 。",
            "id": "3905062",
            "problem": "考虑一个最小的纯蛋白质激活子-阻遏子基因振荡器，该振荡器由描述激活蛋白 $A(t)$ 和阻遏蛋白 $R(t)$ 浓度的常微分方程（ODE）建模。在此系统中，激活子 $A$ 激活 $R$ 的产生，而阻遏子 $R$ 阻遏 $A$ 的产生。假设蛋白质的产生遵循具有饱和性和协同性的希尔型调控函数，且蛋白质的移除为一级稀释-降解。有量纲的常微分方程为\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{\\alpha_A}{1 + \\left(\\frac{R}{K_R}\\right)^{n_r}} \\;-\\; \\delta_A\\, A,\n\\qquad\n\\frac{dR}{dt} \\;=\\; \\frac{\\alpha_R \\left(\\frac{A}{K_A}\\right)^{n_a}}{1 + \\left(\\frac{A}{K_A}\\right)^{n_a}} \\;-\\; \\delta_R\\, R,\n$$\n其中 $t$ 是时间，$\\alpha_A$ 和 $\\alpha_R$ 是最大蛋白质合成速率，$\\delta_A$ 和 $\\delta_R$ 是有效的一级移除速率，$K_A$ 和 $K_R$ 是激活和阻遏阈值，而 $n_a$ 和 $n_r$ 是代表协同性的希尔系数。所有参数均为正常数。\n\n通过引入换元 $A \\leftarrow A/K_A$，$R \\leftarrow R/K_R$ 和 $t \\leftarrow \\delta_A\\, t$ 对系统进行无量纲化。推导所得的无量纲常微分方程，并确定控制该动力学系统的所有独立无量纲参数。用原始的有量纲参数和希尔系数明确表示这些参数。将这些无量纲参数按 $\\left(\\sigma_A, \\sigma_R, \\beta, n_a, n_r\\right)$ 的顺序组成一个行矩阵作为最终答案，其中 $\\sigma_A$、$\\sigma_R$ 和 $\\beta$ 是您确定的相应无量纲数组。最终答案必须是单一的解析表达式。最终答案中不要包含单位。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n给定的有量纲常微分方程（ODE）系统为：\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{\\alpha_A}{1 + \\left(\\frac{R}{K_R}\\right)^{n_r}} \\;-\\; \\delta_A\\, A\n$$\n$$\n\\frac{dR}{dt} \\;=\\; \\frac{\\alpha_R \\left(\\frac{A}{K_A}\\right)^{n_a}}{1 + \\left(\\frac{A}{K_A}\\right)^{n_a}} \\;-\\; \\delta_R\\, R\n$$\n变量是激活蛋白 $A(t)$ 和阻遏蛋白 $R(t)$ 的浓度。参数是最大合成速率 $\\alpha_A$ 和 $\\alpha_R$，有效一级移除速率 $\\delta_A$ 和 $\\delta_R$，激活和阻遏阈值 $K_A$ 和 $K_R$，以及希尔系数 $n_a$ 和 $n_r$。所有参数均为正常数。指定的无量纲化换元为：$A \\leftarrow A/K_A$，$R \\leftarrow R/K_R$ 和 $t \\leftarrow \\delta_A\\, t$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，采用带有希尔动力学的标准激活子-阻遏子模型，这是系统生物学和合成生物学中的一个典型例子。这些方程在为此类基因回路建模方面已经非常成熟。该问题提法恰当，因为无量纲化是一个标准且明确的数学过程。该问题是客观、完整的，不包含任何矛盾或不科学的前提。因此，该问题被认为是有效的。\n\n### 步骤 3：推导解答\n我们按规定引入无量纲变量和无量纲时间：\n设 $a$ 为激活子的无量纲浓度，$r$ 为阻遏子的无量纲浓度，$\\tau$ 为无量纲时间。\n$$\na(\\tau) = \\frac{A(t)}{K_A} \\quad \\implies \\quad A(t) = K_A \\, a(\\tau)\n$$\n$$\nr(\\tau) = \\frac{R(t)}{K_R} \\quad \\implies \\quad R(t) = K_R \\, r(\\tau)\n$$\n$$\n\\tau = \\delta_A \\, t \\quad \\implies \\quad t = \\frac{\\tau}{\\delta_A}\n$$\n为了将关于 $t$ 的导数转换为关于 $\\tau$ 的导数，我们使用链式法则。首先，对于激活子浓度 $A$：\n$$\n\\frac{dA}{dt} = \\frac{d}{dt} (K_A \\, a(\\tau)) = K_A \\, \\frac{da}{d\\tau} \\, \\frac{d\\tau}{dt}\n$$\n由于 $\\tau = \\delta_A \\, t$，我们有 $\\frac{d\\tau}{dt} = \\delta_A$。代入此式可得：\n$$\n\\frac{dA}{dt} = K_A \\, \\delta_A \\, \\frac{da}{d\\tau}\n$$\n类似地，对于阻遏子浓度 $R$：\n$$\n\\frac{dR}{dt} = \\frac{d}{dt} (K_R \\, r(\\tau)) = K_R \\, \\frac{dr}{d\\tau} \\, \\frac{d\\tau}{dt} = K_R \\, \\delta_A \\, \\frac{dr}{d\\tau}\n$$\n现在，我们将这些表达式和换元后的变量代入原始的常微分方程。\n\n对于第一个常微分方程（$A$ 的动力学）：\n$$\nK_A \\, \\delta_A \\, \\frac{da}{d\\tau} = \\frac{\\alpha_A}{1 + \\left(\\frac{K_R \\, r}{K_R}\\right)^{n_r}} - \\delta_A \\, (K_A \\, a)\n$$\n$$\nK_A \\, \\delta_A \\, \\frac{da}{d\\tau} = \\frac{\\alpha_A}{1 + r^{n_r}} - \\delta_A \\, K_A \\, a\n$$\n为了分离出 $\\frac{da}{d\\tau}$，我们将整个方程除以 $K_A \\, \\delta_A$：\n$$\n\\frac{da}{d\\tau} = \\frac{\\alpha_A}{K_A \\, \\delta_A \\, (1 + r^{n_r})} - a\n$$\n我们将无量纲参数 $\\sigma_A$ 定义为产生项的系数：\n$$\n\\sigma_A = \\frac{\\alpha_A}{K_A \\, \\delta_A}\n$$\n因此，第一个无量纲常微分方程为：\n$$\n\\frac{da}{d\\tau} = \\frac{\\sigma_A}{1 + r^{n_r}} - a\n$$\n对于第二个常微分方程（$R$ 的动力学）：\n$$\nK_R \\, \\delta_A \\, \\frac{dr}{d\\tau} = \\frac{\\alpha_R \\left(\\frac{K_A \\, a}{K_A}\\right)^{n_a}}{1 + \\left(\\frac{K_A \\, a}{K_A}\\right)^{n_a}} - \\delta_R \\, (K_R \\, r)\n$$\n$$\nK_R \\, \\delta_A \\, \\frac{dr}{d\\tau} = \\frac{\\alpha_R \\, a^{n_a}}{1 + a^{n_a}} - \\delta_R \\, K_R \\, r\n$$\n为了分离出 $\\frac{dr}{d\\tau}$，我们将整个方程除以 $K_R \\, \\delta_A$：\n$$\n\\frac{dr}{d\\tau} = \\frac{\\alpha_R \\, a^{n_a}}{K_R \\, \\delta_A \\, (1 + a^{n_a})} - \\frac{\\delta_R \\, K_R \\, r}{K_R \\, \\delta_A}\n$$\n$$\n\\frac{dr}{d\\tau} = \\left(\\frac{\\alpha_R}{K_R \\, \\delta_A}\\right) \\frac{a^{n_a}}{1 + a^{n_a}} - \\left(\\frac{\\delta_R}{\\delta_A}\\right) r\n$$\n我们从系数中确定两个新的无量纲参数。根据问题的符号表示：\n$$\n\\sigma_R = \\frac{\\alpha_R}{K_R \\, \\delta_A}\n$$\n$$\n\\beta = \\frac{\\delta_R}{\\delta_A}\n$$\n因此，第二个无量纲常微分方程为：\n$$\n\\frac{dr}{d\\tau} = \\sigma_R \\frac{a^{n_a}}{1 + a^{n_a}} - \\beta \\, r\n$$\n完整的无量纲系统为：\n$$\n\\frac{da}{d\\tau} = \\frac{\\sigma_A}{1 + r^{n_r}} - a\n$$\n$$\n\\frac{dr}{d\\tau} = \\sigma_R \\frac{a^{n_a}}{1 + a^{n_a}} - \\beta \\, r\n$$\n该系统的动力学由这些方程中出现的一组独立无量纲参数控制。这些参数是我们推导出的三个无量纲数组 $\\sigma_A$、$\\sigma_R$ 和 $\\beta$，以及本身就是无量纲的希尔系数 $n_a$ 和 $n_r$。\n\n因此，完整的无量纲参数集为 $(\\sigma_A, \\sigma_R, \\beta, n_a, n_r)$，其中：\n- $\\sigma_A = \\frac{\\alpha_A}{K_A \\, \\delta_A}$（$A$ 的无量纲最大合成速率）\n- $\\sigma_R = \\frac{\\alpha_R}{K_R \\, \\delta_A}$（$R$ 的无量纲最大合成速率，由 $A$ 的移除速率进行缩放）\n- $\\beta = \\frac{\\delta_R}{\\delta_A}$（移除速率之比）\n- $n_a$（激活子协同性）\n- $n_r$（阻遏子协同性）\n\n最终答案是包含这些参数并按指定顺序排列的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha_A}{K_A \\delta_A}  \\frac{\\alpha_R}{K_R \\delta_A}  \\frac{\\delta_R}{\\delta_A}  n_a  n_r\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在简化模型之后，下一个关键步骤是预测其行为，特别是振荡的出现。本练习将带您深入探讨线性稳定性分析，这是一种确定系统对微小扰动响应的核心方法。您将学习如何推导雅可比矩阵并计算其特征值，从而精确地找到系统从稳定平衡点转变为持续振荡的临界条件，即霍普夫分岔点 。",
            "id": "3905049",
            "problem": "考虑一个由常微分方程（ODE）描述的最小双基因激活-抑制振荡器，该振荡器基于希尔型转录调控，源自于分子生物学的中心法则（DNA到RNA到蛋白质）和标准质量作用降解。令 $A(t)$ 表示激活蛋白的浓度，$R(t)$ 表示抑制蛋白的浓度。该模型为\n$$\n\\frac{dA}{dt} \\;=\\; \\alpha_A\\,g(R) \\;+\\; \\gamma_A\\,f(A) \\;-\\; \\delta_A\\,A,\n\\qquad\n\\frac{dR}{dt} \\;=\\; \\alpha_R\\,f(A) \\;-\\; \\delta_R\\,R,\n$$\n其中 $f(A)$ 和 $g(R)$ 分别是激活和抑制的希尔函数，\n$$\nf(A) \\;=\\; \\frac{A^{n_A}}{K_A^{n_A} + A^{n_A}},\n\\qquad\ng(R) \\;=\\; \\frac{1}{1 + \\left(\\frac{R}{K_R}\\right)^{n_R}}.\n$$\n所有参数均为正数且具有生物学可解释性：$\\alpha_A$ 和 $\\alpha_R$ 是最大生产系数（单位为浓度/单位时间），$\\gamma_A$ 是乘以自激活项的激活增益（单位为浓度/单位时间），$\\delta_A$ 和 $\\delta_R$ 是一级降解/稀释率（单位为时间倒数），$K_A$ 和 $K_R$ 是半饱和常数（单位为浓度），$n_A$ 和 $n_R$ 是希尔协同指数。\n\n对于特定的参数集\n$$\nn_A = 6,\\quad n_R = 2,\\quad K_A = 50\\,\\text{nM},\\quad K_R = 40\\,\\text{nM},\\quad \\delta_A = 0.3\\,\\text{h}^{-1},\\quad \\delta_R = 0.1\\,\\text{h}^{-1},\n$$\n假设通过选择\n$$\n\\alpha_R = 2\\,\\delta_R\\,K_R,\\qquad \\alpha_A = 2\\,\\delta_A\\,K_A - \\gamma_A,\n$$\n使得对于所有 $\\gamma_A$ 的值，工作点都保持在半饱和浓度 $A^{\\ast} = K_A$ 和 $R^{\\ast} = K_R$，从而在 $A^{\\ast} = K_A$，$R^{\\ast} = K_R$ 时，稳态条件 $\\frac{dA}{dt} = 0$ 和 $\\frac{dR}{dt} = 0$ 得以满足。\n\n任务：\n1. 推导常微分方程在平衡点 $(A^{\\ast},R^{\\ast}) = (K_A,K_R)$ 附近线性化后的雅可比矩阵。\n2. 对于给定的参数集，计算雅可比矩阵的特征值 $\\lambda_{\\pm}(\\gamma_A)$ 作为 $\\gamma_A$ 的函数。\n3. 确定特征值穿过虚轴（即实部为零）时的临界激活增益 $\\gamma_A^{\\ast}$，并验证在 $\\gamma_A^{\\ast}$ 处雅可比矩阵的行列式为正，从而确认该穿越是复共轭对的霍普夫型不稳定性。\n4. 计算在 $\\gamma_A = 12\\,\\text{nM}\\,\\text{h}^{-1}$ 和 $\\gamma_A = 15\\,\\text{nM}\\,\\text{h}^{-1}$ 时 $\\lambda_{\\pm}(\\gamma_A)$ 的实部，以确认当 $\\gamma_A$ 穿过 $\\gamma_A^{\\ast}$ 增加时，实部会改变符号。\n\n将临界激活增益 $\\gamma_A^{\\ast}$ 的最终数值以 $\\text{nM}\\,\\text{h}^{-1}$ 为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求分析一个双基因激活-抑制振荡器模型。该过程包括在指定的平衡点周围对系统进行线性化，分析所得雅可比矩阵的特征值，并确定霍普夫分岔的临界参数值。\n\n常微分方程（ODE）系统由以下公式给出：\n$$\n\\frac{dA}{dt} = F(A, R) = \\alpha_A\\,g(R) + \\gamma_A\\,f(A) - \\delta_A\\,A\n$$\n$$\n\\frac{dR}{dt} = G(A, R) = \\alpha_R\\,f(A) - \\delta_R\\,R\n$$\n其中希尔函数为\n$$\nf(A) = \\frac{A^{n_A}}{K_A^{n_A} + A^{n_A}} \\quad \\text{和} \\quad g(R) = \\frac{1}{1 + \\left(\\frac{R}{K_R}\\right)^{n_R}} = \\frac{K_R^{n_R}}{K_R^{n_R} + R^{n_R}}\n$$\n所有参数均为正数。分析在平衡点 $(A^{\\ast}, R^{\\ast}) = (K_A, K_R)$ 进行。\n\n**任务1：推导雅可比矩阵。**\n系统的雅可比矩阵 $J$ 由以下公式给出：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial F}{\\partial A}  \\frac{\\partial F}{\\partial R} \\\\ \\frac{\\partial G}{\\partial A}  \\frac{\\partial G}{\\partial R} \\end{pmatrix}\n$$\n偏导数是：\n$$\n\\frac{\\partial F}{\\partial A} = \\gamma_A f'(A) - \\delta_A\n$$\n$$\n\\frac{\\partial F}{\\partial R} = \\alpha_A g'(R)\n$$\n$$\n\\frac{\\partial G}{\\partial A} = \\alpha_R f'(A)\n$$\n$$\n\\frac{\\partial G}{\\partial R} = -\\delta_R\n$$\n我们需要计算希尔函数 $f'(A)$ 和 $g'(R)$ 的导数：\n$$\nf'(A) = \\frac{d}{dA}\\left(\\frac{A^{n_A}}{K_A^{n_A} + A^{n_A}}\\right) = \\frac{n_A A^{n_A-1}(K_A^{n_A} + A^{n_A}) - A^{n_A}(n_A A^{n_A-1})}{(K_A^{n_A} + A^{n_A})^2} = \\frac{n_A K_A^{n_A} A^{n_A-1}}{(K_A^{n_A} + A^{n_A})^2}\n$$\n$$\ng'(R) = \\frac{d}{dR}\\left(\\frac{K_R^{n_R}}{K_R^{n_R} + R^{n_R}}\\right) = \\frac{-K_R^{n_R}(n_R R^{n_R-1})}{(K_R^{n_R} + R^{n_R})^2} = -\\frac{n_R K_R^{n_R} R^{n_R-1}}{(K_R^{n_R} + R^{n_R})^2}\n$$\n现在，我们在平衡点 $(A^{\\ast}, R^{\\ast}) = (K_A, K_R)$ 处计算这些导数：\n$$\nf'(A^{\\ast}) = f'(K_A) = \\frac{n_A K_A^{n_A} K_A^{n_A-1}}{(K_A^{n_A} + K_A^{n_A})^2} = \\frac{n_A K_A^{2n_A-1}}{(2K_A^{n_A})^2} = \\frac{n_A}{4K_A}\n$$\n$$\ng'(R^{\\ast}) = g'(K_R) = -\\frac{n_R K_R^{n_R} K_R^{n_R-1}}{(K_R^{n_R} + K_R^{n_R})^2} = -\\frac{n_R K_R^{2n_R-1}}{(2K_R^{n_R})^2} = -\\frac{n_R}{4K_R}\n$$\n在平衡点处计算的雅可比矩阵 $J^{\\ast}$ 具有以下元素：\n$$\nJ^{\\ast}_{11} = \\gamma_A f'(A^{\\ast}) - \\delta_A = \\gamma_A \\frac{n_A}{4K_A} - \\delta_A\n$$\n$$\nJ^{\\ast}_{12} = \\alpha_A g'(R^{\\ast}) = \\alpha_A \\left(-\\frac{n_R}{4K_R}\\right)\n$$\n$$\nJ^{\\ast}_{21} = \\alpha_R f'(A^{\\ast}) = \\alpha_R \\frac{n_A}{4K_A}\n$$\n$$\nJ^{\\ast}_{22} = -\\delta_R\n$$\n问题指明 $\\alpha_R = 2\\delta_R K_R$ 和 $\\alpha_A = 2\\delta_A K_A - \\gamma_A$。将这些代入雅可比矩阵的元素中：\n$$\nJ^{\\ast}_{12} = (2\\delta_A K_A - \\gamma_A) \\left(-\\frac{n_R}{4K_R}\\right)\n$$\n$$\nJ^{\\ast}_{21} = (2\\delta_R K_R) \\frac{n_A}{4K_A} = \\frac{n_A \\delta_R K_R}{2K_A}\n$$\n因此，在平衡点 $(K_A, K_R)$ 处的雅可比矩阵为：\n$$\nJ^{\\ast} = \\begin{pmatrix} \\gamma_A \\frac{n_A}{4K_A} - \\delta_A  (2\\delta_A K_A - \\gamma_A) \\left(-\\frac{n_R}{4K_R}\\right) \\\\ \\frac{n_A \\delta_R K_R}{2K_A}  -\\delta_R \\end{pmatrix}\n$$\n\n**任务2：计算特征值 $\\lambda_{\\pm}(\\gamma_A)$。**\n首先，我们将给定的参数值代入雅可比矩阵的各分量中：\n$n_A = 6$, $n_R = 2$, $K_A = 50\\,\\text{nM}$, $K_R = 40\\,\\text{nM}$, $\\delta_A = 0.3\\,\\text{h}^{-1}$, $\\delta_R = 0.1\\,\\text{h}^{-1}$。\n$$\nJ^{\\ast}_{11} = \\gamma_A \\frac{6}{4(50)} - 0.3 = \\gamma_A \\frac{6}{200} - 0.3 = 0.03\\,\\gamma_A - 0.3\n$$\n$$\nJ^{\\ast}_{12} = (2(0.3)(50) - \\gamma_A) \\left(-\\frac{2}{4(40)}\\right) = (30 - \\gamma_A) \\left(-\\frac{2}{160}\\right) = (30 - \\gamma_A) \\left(-\\frac{1}{80}\\right) = \\frac{\\gamma_A}{80} - \\frac{30}{80} = 0.0125\\,\\gamma_A - 0.375\n$$\n$$\nJ^{\\ast}_{21} = \\frac{6(0.1)(40)}{2(50)} = \\frac{24}{100} = 0.24\n$$\n$$\nJ^{\\ast}_{22} = -0.1\n$$\n雅可比矩阵为：\n$$\nJ^{\\ast} = \\begin{pmatrix} 0.03\\,\\gamma_A - 0.3  0.0125\\,\\gamma_A - 0.375 \\\\ 0.24  -0.1 \\end{pmatrix}\n$$\n特征值 $\\lambda$ 是特征多项式 $\\det(J^{\\ast} - \\lambda I) = 0$ 的根，即 $\\lambda^2 - \\text{Tr}(J^{\\ast})\\lambda + \\det(J^{\\ast}) = 0$。\n雅可比矩阵的迹为：\n$$\n\\text{Tr}(J^{\\ast}) = J^{\\ast}_{11} + J^{\\ast}_{22} = (0.03\\,\\gamma_A - 0.3) + (-0.1) = 0.03\\,\\gamma_A - 0.4\n$$\n雅可比矩阵的行列式为：\n$$\n\\det(J^{\\ast}) = J^{\\ast}_{11} J^{\\ast}_{22} - J^{\\ast}_{12} J^{\\ast}_{21} = (0.03\\,\\gamma_A - 0.3)(-0.1) - (0.0125\\,\\gamma_A - 0.375)(0.24)\n$$\n$$\n\\det(J^{\\ast}) = -0.003\\,\\gamma_A + 0.03 - (0.003\\,\\gamma_A - 0.09) = -0.006\\,\\gamma_A + 0.12\n$$\n特征值由二次公式给出：\n$$\n\\lambda_{\\pm}(\\gamma_A) = \\frac{\\text{Tr}(J^{\\ast}) \\pm \\sqrt{\\text{Tr}(J^{\\ast})^2 - 4\\det(J^{\\ast})}}{2}\n$$\n$$\n\\lambda_{\\pm}(\\gamma_A) = \\frac{1}{2}\\left( (0.03\\,\\gamma_A - 0.4) \\pm \\sqrt{(0.03\\,\\gamma_A - 0.4)^2 - 4(-0.006\\,\\gamma_A + 0.12)} \\right)\n$$\n\n**任务3：确定临界激活增益 $\\gamma_A^{\\ast}$。**\n当一对复共轭特征值穿过虚轴时，发生霍普夫分岔。这要求特征值的实部为零，虚部不为零。特征值的实部为 $\\text{Re}(\\lambda_{\\pm}) = \\text{Tr}(J^{\\ast})/2$。\n穿越发生在 $\\text{Tr}(J^{\\ast}) = 0$ 时。\n$$\n0.03\\,\\gamma_A^{\\ast} - 0.4 = 0\n$$\n$$\n\\gamma_A^{\\ast} = \\frac{0.4}{0.03} = \\frac{40}{3} \\approx 13.333...\n$$\n$\\gamma_A^{\\ast}$ 的单位是 $\\text{nM}\\,\\text{h}^{-1}$。\n对于霍普夫分岔，我们还必须验证此时的特征值确实是复数，这要求判别式 $\\text{Tr}(J^{\\ast})^2 - 4\\det(J^{\\ast})$ 为负。由于在 $\\gamma_A^{\\ast}$ 处 $\\text{Tr}(J^{\\ast}) = 0$，此条件简化为 $-4\\det(J^{\\ast})  0$，即 $\\det(J^{\\ast})  0$。\n让我们在 $\\gamma_A^{\\ast} = 40/3$ 处计算行列式：\n$$\n\\det(J^{\\ast})|_{\\gamma_A^{\\ast}} = -0.006\\left(\\frac{40}{3}\\right) + 0.12 = -0.002(40) + 0.12 = -0.08 + 0.12 = 0.04\n$$\n由于 $\\det(J^{\\ast})|_{\\gamma_A^{\\ast}} = 0.04  0$，一对复共轭特征值在 $\\gamma_A^{\\ast} = 40/3$ 处穿过虚轴，这是一个霍普夫分岔。此时的特征值为 $\\lambda_{\\pm} = \\pm i\\sqrt{\\det(J^{\\ast})} = \\pm i\\sqrt{0.04} = \\pm 0.2i$。\n\n**任务4：在特定值处计算 $\\lambda_{\\pm}(\\gamma_A)$ 的实部。**\n特征值的实部为 $\\text{Re}(\\lambda_{\\pm}) = \\frac{1}{2}\\text{Tr}(J^{\\ast}) = \\frac{1}{2}(0.03\\,\\gamma_A - 0.4) = 0.015\\,\\gamma_A - 0.2$。\n对于 $\\gamma_A = 12\\,\\text{nM}\\,\\text{h}^{-1}$（低于临界值 $\\gamma_A^{\\ast} \\approx 13.33$）：\n$$\n\\text{Re}(\\lambda_{\\pm}) = 0.015(12) - 0.2 = 0.18 - 0.2 = -0.02\n$$\n实部为负，表明平衡点是稳定的。\n\n对于 $\\gamma_A = 15\\,\\text{nM}\\,\\text{h}^{-1}$（高于临界值 $\\gamma_A^{\\ast} \\approx 13.33$）：\n$$\n\\text{Re}(\\lambda_{\\pm}) = 0.015(15) - 0.2 = 0.225 - 0.2 = 0.025\n$$\n实部为正，表明平衡点是不稳定的。这证实了当 $\\gamma_A$ 穿过临界值 $\\gamma_A^{\\ast}$ 增加时，特征值的实部从负变正，这与导致振荡的霍普夫分岔一致。\n\n问题要求临界激活增益 $\\gamma_A^{\\ast}$ 的数值，并四舍五入到四位有效数字。\n$$\n\\gamma_A^{\\ast} = \\frac{40}{3} \\approx 13.3333...\n$$\n四舍五入到四位有效数字得到 $13.33$。",
            "answer": "$$\\boxed{13.33}$$"
        },
        {
            "introduction": "虽然像霍普夫分岔这样的解析方法可以预测振荡的“诞生”，但它们并不能完全保证一个全局稳定极限环的存在。本练习将理论与计算相结合，向您介绍庞加莱映射这一强大的工具，用于在数值上验证和分析周期性轨道。您将通过编写程序来模拟振荡器，并利用其庞加莱回归映射来最终确认稳定极限环的存在性，这是现代系统生物学研究中不可或缺的技能 。",
            "id": "3905017",
            "problem": "要求您形式化并实现一个数值程序，使用庞加莱截面及其返回映射来检测和验证激活子-阻遏子振荡器中的稳定极限环。待分析的系统是一个无量纲的三变量Goodwin型激活子-阻遏子振荡器，其基础是分子生物学的中心法则（脱氧核糖核酸到核糖核酸到蛋白质）和饱和Hill型调控，这些在合成生物学建模中被广泛使用并得到经验支持。状态变量为 $x_1$（激活子信使核糖核酸）、$x_2$（激活子蛋白）和 $x_3$（阻遏子蛋白）。其控制常微分方程（ODE）为：\n$$\n\\frac{dx_1}{dt} = \\frac{\\alpha}{1 + \\left(\\frac{x_3}{K}\\right)^p} - \\beta x_1,\\quad\n\\frac{dx_2}{dt} = k\\,(x_1 - x_2),\\quad\n\\frac{dx_3}{dt} = k\\,(x_2 - x_3).\n$$\n其中，$\\alpha$ 是最大转录速率，$\\beta$ 是 mRNA 降解速率， $k$ 是设定蛋白质时间尺度的集总翻译/降解速率， $K$ 是抑制作用的半饱和常数， $p$ 是代表抑制作用中协同性的Hill系数。这些选择与合成基因回路中经过充分测试的转录调控和降解公式相一致。\n\n定义庞加莱截面为平面 $x_2 = s$，并满足向上穿越条件 $\\dot{x}_2  0$。在截面穿越点的阻遏子水平序列上定义返回映射 $\\mathcal{P}$ 如下。设 $r_n$ 为在满足 $\\dot{x}_2  0$ 的条件下，第 $n$ 次穿越截面 $x_2 = s$ 时 $x_3$ 的值。返回映射为 $\\mathcal{P}(r_n) = r_{n+1}$。如果返回映射存在一个不动点 $r^\\star$ 满足 $\\mathcal{P}(r^\\star) = r^\\star$，并且在该不动点处的导数满足 $|\\mathcal{P}'(r^\\star)|  1$，则存在一个稳定极限环。在数值上，这可以通过对ODE进行足够长时间的仿真以收集大量穿越点来验证，构建数据对 $\\{(r_n, r_{n+1})\\}$，从晚期穿越点估计不动点 $r^\\star$，并通过对限制在瞬态已衰减的晚期区域的 $\\{(r_n, r_{n+1})\\}$ 进行局部线性拟合来估计返回映射在 $r^\\star$ 附近的局部斜率。\n\n实现一个完整的程序以完成以下任务：\n- 从指定的初始条件积分ODE至指定的最终时间，以收集满足 $x_2 = s$ 和 $\\dot{x}_2  0$ 的庞加莱截面穿越点。\n- 从序列 $\\{r_n\\}$ 构建返回映射。\n- 通过检查以下数值标准来检测稳定极限环的存在：\n  1. 已收集到足够数量的穿越点（至少达到一个最小计数以确保可靠的统计数据）。\n  2. 晚期穿越点 $\\{r_n\\}$ 近似恒定（例如，在最后一段上的标准差很小）。\n  3. 在晚期值附近，返回映射的估计局部斜率的绝对值小于 $1$。\n\n本问题中所有量均为无量纲。\n\n使用以下参数集测试套件和一个单一、共享的截面水平：\n- 测试用例1（预期表现出稳定极限环）：$\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终仿真时间 $T = 400$。\n- 测试用例2（预期为非振荡）：$\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 4$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终仿真时间 $T = 400$。\n- 测试用例3（由于驱动力较低，预期为非振荡）：$\\alpha = 0.8$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终仿真时间 $T = 400$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。每个结果都应是一个布尔值，按所列顺序指示在相应测试用例中是否通过上述数值标准检测到稳定极限环。例如，输出必须是 $[b_1,b_2,b_3]$ 的形式，其中每个 $b_i$ 为 $True$ 或 $False$。",
            "solution": "### 步骤1：提取已知信息\n问题提供了以下信息：\n- **系统**：一个三变量激活子-阻遏子振荡器模型。\n- **状态变量**：$x_1$（激活子mRNA），$x_2$（激活子蛋白），$x_3$（阻遏子蛋白）。\n- **控制常微分方程**：\n$$\n\\frac{dx_1}{dt} = \\frac{\\alpha}{1 + \\left(\\frac{x_3}{K}\\right)^p} - \\beta x_1\n$$\n$$\n\\frac{dx_2}{dt} = k\\,(x_1 - x_2)\n$$\n$$\n\\frac{dx_3}{dt} = k\\,(x_2 - x_3)\n$$\n- **参数**：$\\alpha$（最大转录速率），$\\beta$（mRNA降解速率），$k$（集总蛋白质翻译/降解速率），$K$（半饱和常数），$p$（Hill系数）。\n- **庞加莱截面**：平面 $x_2 = s$，向上穿越条件为 $\\dot{x}_2  0$。\n- **返回映射**：$\\mathcal{P}(r_n) = r_{n+1}$，其中 $r_n$ 是第 $n$ 次向上穿越庞加莱截面时 $x_3$ 的值。\n- **稳定性条件**：如果存在不动点 $r^\\star$ 满足 $\\mathcal{P}(r^\\star) = r^\\star$ 且 $|\\mathcal{P}'(r^\\star)|  1$，则存在稳定极限环。\n- **数值检测标准**：在以下情况下检测到稳定极限环：\n    1. 收集到足够数量的穿越点。\n    2. 晚期穿越点 $\\{r_n\\}$ 的标准差很小。\n    3. 靠近晚期值的返回映射的估计局部斜率的绝对值小于 $1$。\n- **测试用例**：\n    - **测试用例1**：$\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终时间 $T = 400$。\n    - **测试用例2**：$\\alpha = 1.2$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 4$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终时间 $T = 400$。\n    - **测试用例3**：$\\alpha = 0.8$, $\\beta = 1.0$, $k = 1.0$, $K = 1.0$, $p = 12$, $s = 0.9$，初始条件 $(x_1(0),x_2(0),x_3(0)) = (0.1,0.1,0.1)$，最终时间 $T = 400$。\n- **输出格式**：单行 `[b_1,b_2,b_3]`，其中 $b_i$ 是 `True` 或 `False`。\n\n### 步骤2：使用提取的已知信息进行验证\n1.  **科学基础**：该问题建立在带有Hill动力学的Goodwin振荡器模型之上，这是数学生物学和合成电路设计的基石。使用庞加莱截面和返回映射是动力系统理论中分析周期轨道的标准、严谨的技术。所有方面都具有科学合理性。\n2.  **适定性**：该问题是适定的。它为数值积分提供了一整套常微分方程、参数和初始条件。目标定义明确：实现一个基于一组逻辑标准的特定数值程序来检测极限环。虽然某些数值阈值没有明确给出（例如，“最小计数”），但定义它们是形式化数值算法的标准部分，不构成缺陷。\n3.  **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n4.  **其他缺陷**：对照检查清单进行的审查确认没有缺陷。该模型是物理的，参数是无量纲且一致的，任务是可形式化的，并且该问题是动力系统中数值方法的非平凡应用。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供一个解决方案。\n\n### 基于原则的解决方案设计\n核心任务是数值验证给定系统是否存在稳定极限环。解决方案遵循问题陈述中规定的方法，这是计算动力学中的一个标准程序。\n\n**1. 系统积分与庞加莱截面穿越**\n使用高保真求解器在时间区间 $[0, T]$ 上对常微分方程组（ODE）进行数值积分。我们使用 `scipy.integrate.solve_ivp`，这是一个稳健的自适应步长ODE求解器。该求解器的一个关键特性是其事件检测能力，这对于实现庞加莱截面非常理想。\n\n庞加莱截面定义为平面 $x_2 = s$。我们关心的是“向上”穿越，即轨迹以 $\\dot{x}_2  0$ 的方式穿过该平面。这通过使用一个事件函数 $g(t, \\mathbf{x}) = x_2(t) - s$ 来实现，当 $g=0$ 时触发该事件。求解器的 `direction=1` 选项确保仅在 $g$ 增加时记录事件，这对应于 $\\dot{g} = \\dot{x}_2  0$。求解器配置为 `dense_output=True` 以在每次穿越的精确时刻准确确定状态向量 $(x_1, x_2, x_3)$。\n\n**2. 返回映射的构建与分析**\n对于每个穿越事件，我们记录阻遏子蛋白状态变量 $x_3$ 的值，以形成序列 $\\{r_n\\}_{n=1,2,\\dots}$。该序列代表投影到庞加莱截面上的系统状态。返回映射 $\\mathcal{P}$ 关联连续的穿越点：$\\mathcal{P}(r_n) = r_{n+1}$。在完整的三维空间中的稳定极限环表现为这个一维返回映射的一个稳定不动点。不动点 $r^\\star$ 满足 $r^\\star = \\mathcal{P}(r^\\star)$，其稳定性要求该映射在不动点处的导数绝对值小于1：$|\\mathcal{P}'(r^\\star)|  1$。\n\n**3. 数值验证标准**\n我们将理论条件转化为一组具体的数值检验：\n\n- **标准1：足够的穿越点。** 一个趋于稳定不动点的系统可能会穿越庞加莱截面几次或根本不穿越。相反，持续的振荡（如极限环）将产生大量的穿越点。我们设定一个最小阈值 `MIN_CROSSINGS = 20`，以区分振荡行为和瞬态穿越。如果在长达 $T=400$ 的仿真时间内检测到的穿越点少于20个，我们断定不存在稳定振荡。\n\n- **标准2：收敛到不动点。** 对于稳定极限环，返回映射值序列 $\\{r_n\\}$ 必须收敛到不动点 $r^\\star$。我们通过检查收集到的序列的后半部分来评估这种收敛性，假设任何初始瞬态都已衰减。我们计算这些晚期点的标准差。如果该偏差超过一个小的阈值 `STD_DEV_THRESHOLD = 0.01`，则表明序列尚未稳定下来，我们将该系统归类为不具有稳定极限环。\n\n- **标准3：不动点的稳定性 ($|\\mathcal{P}'(r^\\star)|  1$)。** 导数 $\\mathcal{P}'(r^\\star)$ 是返回映射在不动点处的局部斜率。我们通过对晚期返回映射数据进行线性回归来估计该斜率，即对点 $(r_n, r_{n+1})$ 拟合一条直线。该直线的斜率提供了对 $\\mathcal{P}'(r^\\star)$ 的估计。根据稳定性理论，该斜率的绝对值必须严格小于 $1$。$|\\text{斜率}| = 1$ 的情况代表临界稳定，我们将其排除。因此，我们测试 `abs(slope)  1.0` 是否成立。为确保拟合的稳健性，我们要求最少有 `MIN_FIT_PAIRS = 5` 个数据对。\n\n当且仅当所有三个数值标准都满足时，一个测试用例才被归类为具有稳定极限环。该实现将系统地将此分析应用于测试套件中提供的每个参数集。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef analyze_system(case):\n    \"\"\"\n    Analyzes a single test case of the activator-repressor oscillator model to\n    detect a stable limit cycle using a Poincaré section analysis.\n\n    Args:\n        case (tuple): A tuple containing the model parameters and simulation settings:\n            (alpha, beta, k, K, p, s, x0_tuple, T).\n\n    Returns:\n        bool: True if a stable limit cycle is detected, False otherwise.\n    \"\"\"\n    alpha, beta, k, K, p, s, x0_tuple, T = case\n    x0 = np.array(x0_tuple)\n\n    # Define numerical thresholds for detection criteria.\n    MIN_CROSSINGS = 20\n    STD_DEV_THRESHOLD = 0.01\n    STABILITY_SLOPE_MAG_MAX = 1.0 # Stability requires |slope|  1\n    MIN_FIT_PAIRS = 5 # Minimum pairs (r_n, r_{n+1}) for a reliable fit\n    ILL_CONDITION_STD_THRESH = 1e-9 # Threshold to detect ill-conditioned fit\n\n    # 1. Define the ODE system for the model.\n    def model(t, y, alpha, beta, k, K, p):\n        x1, x2, x3 = y\n        dx1_dt = alpha / (1.0 + (x3 / K)**p) - beta * x1\n        dx2_dt = k * (x1 - x2)\n        dx3_dt = k * (x2 - x3)\n        return [dx1_dt, dx2_dt, dx3_dt]\n\n    # 2. Define the event function for the Poincaré section.\n    # The event is triggered when x2(t) - s = 0.\n    def poincare_event(t, y, s_level):\n        return y[1] - s_level\n\n    # Set event properties:\n    # direction=1 detects upward crossings (function goes from negative to positive).\n    # This corresponds to d/dt(y[1]-s) > 0, which means dy[1]/dt > 0.\n    poincare_event.direction = 1\n    # Do not terminate integration upon event detection.\n    poincare_event.terminal = False\n\n    # 3. Integrate the ODE system.\n    sol = solve_ivp(\n        fun=lambda t, y: model(t, y, alpha, beta, k, K, p),\n        t_span=[0, T],\n        y0=x0,\n        events=lambda t, y: poincare_event(t, y, s),\n        dense_output=True,\n        rtol=1e-8,\n        atol=1e-10\n    )\n\n    # --- Apply numerical detection criteria ---\n\n    # Criterion 1: Check for a sufficient number of crossings.\n    # sol.t_events is a list, one per event function. We have one.\n    if not sol.t_events or len(sol.t_events[0])  MIN_CROSSINGS:\n        return False\n    \n    # sol.y_events is a list of arrays. We need the first one.\n    # It has shape (n_events, n_vars).\n    crossings_y = sol.y_events[0]\n    # The return map is defined on r_n = x_3 at the crossings.\n    r_sequence = crossings_y[:, 2]\n\n    # Analyze the latter half of the crossings to ensure transients have decayed.\n    num_crossings = len(r_sequence)\n    analysis_start_index = num_crossings // 2\n    late_r_sequence = r_sequence[analysis_start_index:]\n\n    # Criterion 2: Check for convergence of the return map fixed point.\n    # A stable limit cycle implies r_n converges to a fixed point r*.\n    # Test this by checking if the standard deviation of late-time r_n is small.\n    if np.std(late_r_sequence) >= STD_DEV_THRESHOLD:\n        return False\n        \n    # Criterion 3: Estimate slope of the return map and check for stability.\n    # The return map is P(r_n) = r_{n+1}. Stability requires |P'(r*)|  1.\n    # We approximate this by a linear fit to (r_n, r_{n+1}) for late n.\n    map_domain = late_r_sequence[:-1]\n    map_codomain = late_r_sequence[1:]\n\n    # We need at least a few pairs for a meaningful fit.\n    if len(map_domain)  MIN_FIT_PAIRS:\n        return False\n        \n    # Handle ill-conditioned cases where all x-values are the same.\n    # This would imply perfect convergence to a fixed point, where the\n    # theoretical slope is 1 (marginal stability), failing the |slope|1 test.\n    if np.std(map_domain)  ILL_CONDITION_STD_THRESH:\n        return False\n\n    # Perform linear regression: y = m*x + c\n    slope, _ = np.polyfit(map_domain, map_codomain, 1)\n\n    # np.polyfit can return nan on ill-conditioned data.\n    if np.isnan(slope) or abs(slope) >= STABILITY_SLOPE_MAG_MAX:\n        return False\n\n    # If all criteria are met, we conclude a stable limit cycle exists.\n    return True\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis on all predefined test cases and\n    print the results in the specified format.\n    \"\"\"\n    # Test case parameters: (alpha, beta, k, K, p, s, initial_condition, T)\n    test_cases = [\n        # Case 1: Expected to exhibit a stable limit cycle\n        (1.2, 1.0, 1.0, 1.0, 12, 0.9, (0.1, 0.1, 0.1), 400),\n        # Case 2: Expected to be non-oscillatory (stable fixed point)\n        (1.2, 1.0, 1.0, 1.0, 4, 0.9, (0.1, 0.1, 0.1), 400),\n        # Case 3: Expected to be non-oscillatory (lower drive)\n        (0.8, 1.0, 1.0, 1.0, 12, 0.9, (0.1, 0.1, 0.1), 400),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_system(case)\n        results.append(result)\n\n    # The final print statement must follow the exact specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}